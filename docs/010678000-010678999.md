# StackOverflow 问答 10678000-10678999

# python - Django ~ WSGIRequest 带有通过 get_context_data 方法添加的表单

> ID：10678002
> 
> 赞同：1
> 
> 时间：2012-05-20T23:13:56.830
> 
> 标签：python, django, django-forms

当我访问我的页面时出现此错误：

> 渲染时捕获 AttributeError：“WSGIRequest”对象没有属性“get”

错误出现在我的 html 的“17”行，这是输出 form.as_p 的行

html 看起来像这样：

```
{% extends "base.htm" %}

{% block content %}
{% if story_list %}
    {% for story in story_list %}
        <div class="Story">
            <a href="#">{{  story.title }}</a>
        </div>
    {% endfor %}
{% else %}
    <p>No stories are present - enter one below</p>
{% endif %}
<h3>Create a new story</h3>
<form action="/addStory" method="post">
    {%  csrf_token %}
    {{  form.as_p }} ***THIS IS LINE 17***
    <input type="submit" value="Submit"/>
</form>
{% endblock %} 
```

问题是我有一个视图可以做*两*件事，并且从 django 教程中覆盖了 get_context_data 方法以将第二项添加到 django 上下文中。因为，嗯，这就是我的意思，riiiiiiiiight？

```
#for showing of the stories!
class StoryShowView(ListView):
    model = StoryForm

    def get_queryset(self):
        return getStoryItemsForUser(self.request)

    def get_context_data(self, **kwargs):
        context = super(StoryShowView,self).get_context_data(**kwargs)
        context['form'] = createNewStoryForm(self.request)
        return context 
```

好吧，createNewStoryForm 方法就是这样做的：

```
def createNewStoryForm(request):
    return StoryForm(request) 
```

StoryForm 就是这样：

```
class StoryForm(ModelForm):
    class Meta:
        model = Story
        ordering = ['create_date'] 
```

Story 模型是一个普通模型，这可能不是问题的一部分，但是，嘿，我是一个剪切和粘贴，所以来了！

```
class Story(models.Model):
    user = models.ForeignKey(User)
    post = models.ForeignKey(Post)
    title =  models.CharField(max_length=100)
    is_closed = models.BooleanField()
    is_random = models.BooleanField() # for uncategorised stories. Only one of these.
    result = models.CharField(max_length=20) #how did the relo work out?
    create_date = models.DateTimeField('date created')
    def __unicode__(self):
        return self.title 
```

任何想法我做错了什么？

更新：啊，这是行::

```
return StoryForm(request) 
```

我认为我可以传入“request.POST”或什么都不传入，是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:06:04.297

我可以看到两个问题。最简单的是您可以简单地替换这一行：

```
context['form'] = createNewStoryForm(self.request) 
```

和

```
context['form'] = StoryForm(request.POST, request.FILES) 
```

最后不应该这样：

```
class StoryShowView(ListView):
    model = StoryForm 
```

是：

```
class StoryShowView(ListView):
    model = Story 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T07:50:10.090

可能你是对的，你传递`request`而不是`request.POST`，`reqest.GET`或者传递`request.REQUEST`给你的表单的构造函数。请参阅有关[如何使用表单](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#using-a-form-in-a-view)的文档：

```
def contact(request):
    if request.method == 'POST': # If the form has been submitted...
        form = ContactForm(request.POST) # A form bound to the POST data
        if form.is_valid(): # All validation rules pass
            # Process the data in form.cleaned_data
            # ...
            return HttpResponseRedirect('/thanks/') # Redirect after POST
    else:
        form = ContactForm() # An unbound form

    return render_to_response('contact.html', {
        'form': form,
    }) 
```

# c - C中的通用指针和内存分配

> ID：10678005
> 
> 赞同：0
> 
> 时间：2012-05-20T23:14:18.507
> 
> 标签：c, void-pointers

机器如何知道为通用指针分配多少空间？它仅在转换为类型时才分配吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T23:20:34.360

我不确定您所说的“通用指针”是什么意思，但如果您的意思是“指向 void 的指针”，它只是一种能够表示任何其他*指针值*的类型。这并不意味着它必须任意大。实际上，它（定义为）与“指向字符的指针”相同的大小和表示形式，也可以指向任何类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:16:44.737

在大多数平台上，指针通常具有固定大小，具体取决于您正在编译的系统的内存架构。就这一点而言，他们的类型是无关紧要的。一个`int`点的大小与一个复杂点的大小相同`struct`。它的事实`void`并没有改变这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T23:16:59.797

所有指针的大小都是编译器在编译时已知的；指向的项目的大小可能不同。您将所需的大小传递给`malloc`/`calloc`自己，因此编译器在分配方面没有问题。

**编辑（回应评论）**有些情况下不同指针的大小不同。例如，在为哈佛架构编译的代码中，数据指针必须包含一个额外的存储空间，用于区分存储在程序存储器中的数据和存储在数据存储器中的数据，而函数指针不需要额外的存储空间。但是，编译器知道这一点，因此它通过查看指针的类型就知道所需的分配大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T23:18:54.237

无论指针指向什么，指针的大小都相同，只是它们指向的东西大小可以不同。

# iphone - 使用存储在应用程序中的数据预填充 Web 表单

> ID：10678012
> 
> 赞同：1
> 
> 时间：2012-05-20T23:15:31.887
> 
> 标签：iphone, ios5, uiwebview

使用 iPhone `UiWebView`，可以使用存储在应用程序数据文件夹中的用户名和其他帐户详细信息预先填写 html 表单。使用 iOS 5.1 sdk 所以我需要读取存储了客户信息的文件，然后从`UIWebView`. 我需要知道这是否可以做到，如果可以，任何教程如何做到这一点都会很有用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:13:20.160

您可以从应用程序包中读取数据，然后运行一个 JavaScript 函数，该函数将数据作为参数并使用它来预填充表单。

您可以使用该方法在 UIWebView 中执行 Javascript

```
stringByEvaluatingJavaScriptFromString: 
```

我不是 JavaScript 专家，所以我不想评论编写 JavaScript 函数以预填充表单的最佳方法，但我知道它是可能的。

# java - 如何在 Java 中自动裁剪图像白色边框？

> ID：10678015
> 
> 赞同：9
> 
> 时间：2012-05-20T23:16:39.030
> 
> 标签：java, image-processing

在java中从图像中自动裁剪白色边框的最简单方法是什么？提前致谢...

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-28T18:57:58.933

这是一种裁剪所有 4 个边的方法，使用左上角像素的颜色作为基线，并允许颜色变化的容差，这样图像中的噪声不会使裁剪无用

```
public BufferedImage getCroppedImage(BufferedImage source, double tolerance) {
   // Get our top-left pixel color as our "baseline" for cropping
   int baseColor = source.getRGB(0, 0);

   int width = source.getWidth();
   int height = source.getHeight();

   int topY = Integer.MAX_VALUE, topX = Integer.MAX_VALUE;
   int bottomY = -1, bottomX = -1;
   for(int y=0; y<height; y++) {
      for(int x=0; x<width; x++) {
         if (colorWithinTolerance(baseColor, source.getRGB(x, y), tolerance)) {
            if (x < topX) topX = x;
            if (y < topY) topY = y;
            if (x > bottomX) bottomX = x;
            if (y > bottomY) bottomY = y;
         }
      }
   }

   BufferedImage destination = new BufferedImage( (bottomX-topX+1), 
                 (bottomY-topY+1), BufferedImage.TYPE_INT_ARGB);

   destination.getGraphics().drawImage(source, 0, 0, 
               destination.getWidth(), destination.getHeight(), 
               topX, topY, bottomX, bottomY, null);

   return destination;
}

private boolean colorWithinTolerance(int a, int b, double tolerance) {
    int aAlpha  = (int)((a & 0xFF000000) >>> 24);   // Alpha level
    int aRed    = (int)((a & 0x00FF0000) >>> 16);   // Red level
    int aGreen  = (int)((a & 0x0000FF00) >>> 8);    // Green level
    int aBlue   = (int)(a & 0x000000FF);            // Blue level

    int bAlpha  = (int)((b & 0xFF000000) >>> 24);   // Alpha level
    int bRed    = (int)((b & 0x00FF0000) >>> 16);   // Red level
    int bGreen  = (int)((b & 0x0000FF00) >>> 8);    // Green level
    int bBlue   = (int)(b & 0x000000FF);            // Blue level

    double distance = Math.sqrt((aAlpha-bAlpha)*(aAlpha-bAlpha) +
                                (aRed-bRed)*(aRed-bRed) +
                                (aGreen-bGreen)*(aGreen-bGreen) +
                                (aBlue-bBlue)*(aBlue-bBlue));

    // 510.0 is the maximum distance between two colors 
    // (0,0,0,0 -> 255,255,255,255)
    double percentAway = distance / 510.0d;     

    return (percentAway > tolerance);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T03:40:10.320

如果您希望白色部分不可见，最好的方法是使用图像过滤器并使白色像素透明， @PhiLho[在此处讨论](https://stackoverflow.com/questions/665406/how-to-make-a-color-transparent-in-a-bufferedimage-and-save-as-png)了一些很好的示例，如果您想调整图像大小使其边框不会有白色颜色，你可以用四个简单的循环来完成，我为你写的这个小方法可以解决问题，注意它只是裁剪图像的上半部分，你可以写剩下的，

```
 private Image getCroppedImage(String address) throws IOException{
    BufferedImage source = ImageIO.read(new File(address)) ;

    boolean flag = false ;
    int upperBorder = -1 ; 
    do{
        upperBorder ++ ;
        for (int c1 =0 ; c1 < source.getWidth() ; c1++){
            if(source.getRGB(c1, upperBorder) != Color.white.getRGB() ){
                flag = true;
                break ;
            }
        }

        if (upperBorder >= source.getHeight())
            flag = true ;
    }while(!flag) ;

    BufferedImage destination = new BufferedImage(source.getWidth(), source.getHeight() - upperBorder, BufferedImage.TYPE_INT_ARGB) ;
    destination.getGraphics().drawImage(source, 0, upperBorder*-1, null) ;

    return destination ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-28T19:30:31.587

这里只是另一个例子

```
private static BufferedImage autoCrop(BufferedImage sourceImage) {
    int left = 0;
    int right = 0;
    int top = 0;
    int bottom = 0;
    boolean firstFind = true;
    for (int x = 0; x < sourceImage.getWidth(); x++) {
        for (int y = 0; y < sourceImage.getWidth(); y++) {
            // pixel is not empty
            if (sourceImage.getRGB(x, y) != 0) {

                // we walk from left to right, thus x can be applied as left on first finding
                if (firstFind) {
                    left = x;
                }

                // update right on each finding, because x can grow only
                right = x;

                // on first find apply y as top
                if (firstFind) {
                    top = y;
                } else {
                    // on each further find apply y to top only if a lower has been found
                    top = Math.min(top, y);
                }

                // on first find apply y as bottom
                if (bottom == 0) {
                    bottom = y;
                } else {
                    // on each further find apply y to bottom only if a higher has been found
                    bottom = Math.max(bottom, y);
                }
                firstFind = false;
            }
        }
    }

    return sourceImage.getSubimage(left, top, right - left, bottom - top);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-04-21T16:57:39.633

img is original image source BufferedImage subImg = img.getSubimage(0, 0, img.getWidth() - 1, img.getHeight() - 1);

# objective-c - 从 SQL 数据库下载数据以在 iPhone 应用程序中使用

> ID：10678020
> 
> 赞同：-1
> 
> 时间：2012-05-20T23:17:31.900
> 
> 标签：objective-c, sql, ios4, nsdata, nsbundle

有人可以向我指出一个教程或一些资源，它们将向我展示如何从 Web 服务器下载或使用 sql 数据库并在应用程序中使用该内容。我想动态控制应用程序中的内容，这样每次启动应用程序时，它都会从数据库中加载内容并使用它来填充应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:25:16.577

有很多方法可以回答这个问题，但基本上您应该使用您选择的语言创建一个`REST`服务 ( [http://www.ibm.com/developerworks/java/tutorials/j-rest/](http://www.ibm.com/developerworks/java/tutorials/j-rest/) )。

这将连接到 SQL Server 数据库。

`REST`然后你在你的程序中创建一个客户端（[在 iOS 5 中使用 restful web 服务](https://stackoverflow.com/questions/9359975/consuming-restful-web-service-in-ios-5)），然后你就可以与数据库进行交互了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:24:36.230

[RestKit](http://Restkit.org)是一个优秀的库，用于构建 iOS 端的 rest 驱动系统。也非常积极地支持。对核心数据也有很好的搭配。

# php - 使用 jQuery 的图像幻灯片（也许使用 PHP）

> ID：10678022
> 
> 赞同：0
> 
> 时间：2012-05-20T23:17:40.360
> 
> 标签：php, jquery, html

好的，所以我在这里有我的 div 标签，它的 css 样式“背景”设置为默认值。

例如

```
<div id="slideimage" style="background:url(01.jpg);width:xxpx;height:xxpx;"></div> 
```

我有我的下一个按钮

```
<a href="#" onClick="nextPhoto()">Next</a> 
```

所以我想当我点击下一步按钮时，#slideimage 的背景样式将变为 02.jpg。我尝试用谷歌搜索，但它似乎无法正常运行。

就这样。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:37:17.070

## *[jsBin 演示](http://jsbin.com/uvohal/2/edit)*

```
var images = [
  '01.jpg',
  '02.jpg',
  '03.jpg'
];

var iN = images.length;
var i = 0;

function changeImage(){
  $('#slideimage').css({background: 'url('+images[++i % iN]+')'});
}

$('#next').click( changeImage ); 
```

创建一个图像数组，一个 var 'index counter' ( `i`) 并获取数组中的图像数 ( `iN`)

比您可以使用 Modulo 轻松切换图像进行此数学运算：`++i % iN`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:26:59.257

你试过这个javascript：

```
function nextImage() {
  $('#slideimage').css("background", "url(02.jpg)");
} 
```

这是一个更强大的演示：http: [//jsfiddle.net/gQQBL/](http://jsfiddle.net/gQQBL/)

# javascript - 谷歌浏览器堆快照（闭包），（数组），（系统），（编译代码）在程序员控制下？

> ID：10678024
> 
> 赞同：18
> 
> 时间：2012-05-20T23:18:11.030
> 
> 标签：javascript, memory, google-chrome-devtools

我注意到我在标题中提到的属性在我的页面中显着上升（尤其是“（关闭）”）。

此操作系统和/或浏览器是否受控制？我能做些什么吗？

（闭包）、（数组）、（编译代码）、（系统）等到底是*什么？*

另外，（数组）和“数组”有什么区别？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-17T11:39:05.897

关于你的问题：

> **问：****(closure)**、**(array)**、**(compiled code)**、**(system)**等到底是什么？

[Addy Osmani 的文章中的](http://addyosmani.com/blog/taming-the-unicorn-easing-javascript-memory-profiling-in-devtools/)这段片段可能会有所帮助：

> *   **（全局属性）** – 全局对象（如“窗口”）与其引用的对象之间的中间对象。如果一个对象是使用构造函数 Person 创建的并且由一个全局对象持有，则保留路径看起来像 [global] > (global property) > Person。这与对象直接相互引用的规范形成对比。出于性能原因，我们有中间对象。全局对象会定期修改，属性访问优化对非全局对象做得很好，但不适用于全局对象。
>     
>     
> *   **(roots)** – 保留树视图中的根条目是具有对选定对象的引用的实体。这些也可以是引擎为其自身目的创建的引用。引擎缓存了哪些引用对象，但所有这些引用都是弱引用，并且不会阻止对象被收集，因为没有真正的强引用。
>     
>     
> *   **(closure)** – 通过函数闭包对一组对象的引用计数
>     
>     
> *   **(array, string, number, regexp)** – 对象类型列表，其属性引用 Array、String、Number 或正则表达式
>     
>     
> *   **（编译代码）** ——简单地说，与编译代码相关的一切。脚本类似于函数，但对应于主体。SharedFunctionInfos (SFI) 是位于函数和编译代码之间的对象。函数通常有上下文，而 SFI 没有。
>     
>     
> *   **HTMLDivElement、HTMLAnchorElement、DocumentFragment**等——对代码引用的特定类型的元素或文档对象的引用。

整篇文章还有许多其他有价值的关于堆分析的信息：http: [//addyosmani.com/blog/taming-the-unicorn-easing-javascript-memory-profiling-in-devtools](http://addyosmani.com/blog/taming-the-unicorn-easing-javascript-memory-profiling-in-devtools)

还有你的另一个问题：

> **问：**另外，（数组）和“数组”有什么区别？

根据 Addy 的描述，我的解释是这样的：（**数组）**是对象（任何类型）的集合，这些对象具有引用实际数组的属性。相反，**Array**是实际 Array 对象的列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T23:51:14.890

闭包是一个能够引用在其直接范围之外声明的数据的函数。

这是一个例子：

```
var closure = (function() {
   var a = "some data";
   var b = "something else...";
   return function Closure() {
      // this function retains references to a and b.
   }
})(); 
```

在 Web 开发中，您最终使用闭包的最常见方式是将事件侦听器附加到 dom 节点。

前任：

```
$.ready(function() {
   var $elems = $("selector");
   var tools = new Tools();
   $elems.mousedown(function() { // <-- this has created a closure
      // We can refer to $elems and tools in here
      // and so as long as this function is held on to so are those variables to which
      // it has access
   });
}); 
```

如果您验证这一点并实际看到（关闭）计数上升

1.  弹出打开铬
2.  进行堆转储
3.  跑： `function DistinctName() {}` `function DistinctName2() {}`

    在 javascript 控制台中

4.  再做一个堆转储

5.  从最底部的堆转储选项中选择“比较”。

您会看到它`DistinctName`并在该类别`DistinctName2`下显示为新的闭包。`(closure)`

v8 有一个“JIT”编译器，所以我假设（编译）是指 JIT 编译源。

我只能猜测（数组）和（系统）。

# objective-c - 在 Objective C 中访问数据的最快方法

> ID：10678030
> 
> 赞同：0
> 
> 时间：2012-05-20T23:19:01.117
> 
> 标签：objective-c, xcode4

我有一个 xml 文件，其中包含 10k 缩写及其完整术语的列表。我想在加载时将此 xml 存储到一个结构中。然后会有一页缩写词，这些缩写词会不断地击中该结构以转换为完整术语。换句话说，在加载时创建一个并进行许多查找。我不确定在速度和可靠性方面我可以使用的最佳结构是什么？例如，我应该使用 CoreData 还是 NSDictionary，或者其他一些哈希表？我应该让解析器为每个术语查找解析 NSXML 吗？

谢谢，罗斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T03:31:18.287

在此处的任何人都可以推荐任何类型的性能提升之前，您需要分享两个**至关重要**的信息：

1.  您当前实施的细节是什么？

2.  您要解决的具体 [一组] 性能瓶颈是什么？

没有这一点，任何随后的讨论都不会比超级碗期间的扶手椅四分卫更好。一种有点有趣的浪费时间的方法。

# html - 如何内联显示消息

> ID：10678036
> 
> 赞同：0
> 
> 时间：2012-05-20T23:20:36.343
> 
> 标签：html, css

我有一个显示加号的图像，并且在图像旁边显示一条小消息。代码如下：

```
<table id="plus" align="center">
<tr>
<th>
<input type="image" src="Images/plussign.jpg" name="plussign" width="30" height="30" id="plusimage"><span id="plussignmsg">(Click Plus Sign to look <br/> up Previous Questions)</span>
</th>
</tr>
</table> 
```

我遇到的问题是消息并没有真正显示在图像旁边。图像高 30 像素，但消息从底部 10 像素高处开始显示。如何让图像旁边的消息正确显示在图像中。

下面是css：

```
#plusimage{
    clear:right;    
}        

#plussignmsg{
    font-size:10px; 
    display:inline;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:17:44.250

尝试这个：

```
#plusimage{
    float:left;   
}        

#plussignmsg{
    font-size:10px; 
    display: block; float:left;
} 
```

最近我发现将容器显示为表格，内容作为表格单元格也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:22:39.523

试试`float`图片

```
#plusimage{
    float: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T04:27:20.357

```
Use this. I have added css class for align image to vertical middle.

<style type="text/css">
    #plusimage
    {
        vertical-align:middle;
    }
   </style>
   <table id="plus" style="width:100%; text-align:center;">
        <tr>
            <th>
                <input type="image" src="Images/add_user.png" name="plussign" id="plusimage"><span id="plussignmsg">(Click Plus Sign to look up Previous Questions)</span>
            </th>
        </tr>
    </table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T23:31:06.363

尝试

```
#plusimage{
    display:inline;   
} 
```

# bash - 使用具有各种引号级别和空格的变量构建命令字符串

> ID：10678039
> 
> 赞同：3
> 
> 时间：2012-05-20T23:21:18.043
> 
> 标签：bash, variables, quotes, spaces

我有一个运行的脚本`curl`。`-H`如果字符串不为空，我希望能够有选择地添加参数。复杂的是引用和空格的级别。

```
caption="Test Caption"

if [ "${caption}" != "" ]; then 
    CAPT=-H "X-Caption: ${caption}"
fi

curl -A "$UA" -H "Content-MD5: $MD5" -H "X-SessionID: $SID" -H "X-Version: 1"  $CAPT http://upload.example.com/$FN 
```

这个想法是 CAPT 变量要么是空的，要么包含所需的 -H 标头，其形式与其他标头相同，例如，`-H "X-Caption: Test Caption"`

问题是在运行时，它将分配解释为要执行的命令：

```
$bash -x -v test.sh
+ '[' 'Test caption' '!=' '' ']'
+ CAPT=-H
+ 'X-Caption: Test caption'
./test.sh: line 273: X-Caption: Test caption: command not found 
```

我曾尝试在代码之前重置 IFS，但这并没有什么不同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T01:26:52.510

完成这项工作的关键是使用数组。

```
caption="Test Caption"

if [[ $caption ]]; then 
    CAPT=(-H "X-Caption: $caption")
fi

curl -A "$UA" -H "Content-MD5: $MD5" -H "X-SessionID: $SID" -H "X-Version: 1"  "${CAPT[@]}" "http://upload.example.com/$FN" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T04:31:25.490

如果您只需要知道标题是否存在，则可以在需要时对其进行插值。

```
caption="Test Caption"
NOCAPT="yeah, sort of, that would be nice"

if [ "${caption}" != "" ]; then 
    unset NOCAPT
fi

curl ${NOCAPT--H "X-Caption: ${caption}"} -A "$UA" ... 
```

回顾一下，语法`${var-value}`产生`value`if `var`is unset。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-22T01:17:06.690

我终于让它工作了。部分问题是特定于`curl`的，因为在使用设置自定义标头的选项时，当 之后的所有内容（即自定义标头名称和值）都受单引号保护`-H`时，它似乎效果最好。`-H`然后，我需要传递构造的字符串`eval`以使其工作。

为了便于阅读，我将单引号存储在名为`TICK`.

例子：

```
TICK=\'
#
HDRS=""
HDRS+=" -H ${TICK}Content-MD5: ${MD5}${TICK}"
HDRS+=" -H ${TICK}X-SessionID: ${SID}${TICK}"
HDRS+=" -H ${TICK}X-Version: 1.1.1${TICK}"
HDRS+=" -H ${TICK}X-ResponseType: REST${TICK}"
HDRS+=" -H ${TICK}X-ID: ${ID}${TICK}"

if [ "${IPTC[1]}" != "" ]; then
    HDRS+=" -H ${TICK}X-Caption: ${IPTC[1]}${TICK}"
fi
if [ "${IPTC[2]}" != "" ]; then
    HDRS+=" -H ${TICK}X-Keywords: ${IPTC[2]}${TICK}"
fi

#
# Set curl flags
#
CURLFLAGS=""
CURLFLAGS+=" --cookie $COOKIES --cookie-jar $COOKIES"
CURLFLAGS+=" -A \"$UA\" -T ${TICK}${the_file}${TICK} "

eval curl $CURLFLAGS $HDRS -o $OUT http://upload.example.com/$FN 
```

# mysql - JSP、JDBC、servlet和forms中必须调用构造函数的超级错误

> ID：10678042
> 
> 赞同：0
> 
> 时间：2012-05-20T23:22:02.307
> 
> 标签：mysql, jsp, servlets, jdbc, registration

我正在为我的 Web 应用程序创建一个注册表单，当我尝试访问注册新用户时出现以下错误：

```
java.lang.VerifyError: (class: eBooks/Data/UserDB, method: <init> signature: ()V) Constructor must call super() or this() java.lang.VerifyError: (class: eBooks/Data/UserDB, method: <init> signature: ()V) Constructor must call super() or this()
at eBooks.controller.RegisterUserServlet.doPost(RegisterUserServlet.java:62) 
```

这是 UserDB 类：

```
package eBooks.Data;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import eBooks.business.User;
import eBooks.util.DBUtil;

public class UserDB {

    public static int insert(User user)
    {

        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;

         String query = 
                "INSERT INTO User (fName, lName, email_address, password, dataOfBirth, phone,"
                + " address, city,  state,  country,  zipcode, accountType)"
                + "VALUES (?,?,?,?,?,?,?,?,?,?,?)";

         try
         {
             ps = connection.prepareStatement(query);
             ps.setString(1, user.getfName());
             ps.setString(2, user.getlName());
             ps.setString(3, user.getEmailAddress());
             ps.setString(4, user.getPassword());
             ps.setString(5, user.getDateOfBirth());
             ps.setString(5, user.getPhone());
             ps.setString(6, user.getAddress());
             ps.setString(7, user.getCity());
             ps.setString(8, user.getCountry());
             ps.setString(9, user.getState());
             ps.setString(10, user.getZipcode());
             //ps.setString(11, user.getAccountType()); -- Ask Jassin 

             return ps.executeUpdate();

         }
         catch(SQLException e)
         {
             e.printStackTrace();
             return 0;
         }
         finally
         {
             DBUtil.closePreparedStatement(ps);
             pool.freeConnection(connection);
         }

    }

    public static int update(User user)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;

        String query = "UPDATE User SET" 
                        + "fName = ?"
                        + "lName = ?"
                        + "password = ?"
                        + "dateOfBirth = ?"
                        + "phone = ?"
                        + "address = ?"
                        + "city = ?"
                        + "state_or_Region = ?"
                        + "country = ?"
                        + "zip = ?"
                        + ""
                        + "WHERE email_address= ?";   

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, user.getfName());
            ps.setString(2, user.getlName());
            ps.setString(3, user.getEmailAddress());
            ps.setString(4, user.getPassword());
            ps.setString(5, user.getDateOfBirth());
            ps.setString(5, user.getPhone());
            ps.setString(6, user.getAddress());
            ps.setString(7, user.getCity());
            ps.setString(8, user.getCountry());
            ps.setString(9, user.getState());
            ps.setString(10, user.getZipcode());
             //ps.setString(11, user.getAccountType()); -- Ask Jassin 

            return ps.executeUpdate();
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return 0;
        }
        finally
        {
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }

    }

    public static int delete(User user)
    {
       ConnectionPool pool = ConnectionPool.getInstance();
       Connection connection = pool.getConnection();
       PreparedStatement ps = null;

       String query = "DELETE FROM User" +
                      "WHERE email_address = ?";
       try
       {
           ps = connection.prepareStatement(query);
           ps.setString(1, user.getEmailAddress());

           return ps.executeUpdate();

       }
       catch(SQLException e)
       {
           e.printStackTrace();
           return 0;
       }
       finally
       {
           DBUtil.closePreparedStatement(ps);
           pool.freeConnection(connection);
       }
    }

    public static boolean emailExists(String emailAddress)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;
        ResultSet rs = null;

        String query = "SELECT email_address FROM User"+
                       "WHERE email_address = ?";

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, emailAddress);
            rs = ps.executeQuery();
            return rs.next();
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return false;            
        }
        finally
        {
            DBUtil.closeResultSet(rs);
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }
    }

    public static User selectUser(String emailAddress)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;
        ResultSet rs = null;

        String query = "SELECT * FROM  User"+
                       "WHERE email_address = ?";

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, emailAddress);
            rs = ps.executeQuery();

            User user = null;
            if (rs.next())
            {
                user = new User();
                user.setfName(rs.getString("fName"));
                user.setlName(rs.getString("lName"));
                user.setEmailAddress(rs.getString("emailAddress"));
                user.setPassword(rs.getString("password"));
                user.setPhone(rs.getString("phone"));
                user.setDateOfBirth(rs.getString("dateOfBirth"));
                user.setAddress(rs.getString("address"));
                user.setCity(rs.getString("city"));
                user.setCountry(rs.getString("country"));
                user.setState(rs.getString("state"));
                user.setZipcode(rs.getString("zip"));
                // user.setAccountType(rs.getString("accountType")); -- Ask Jassin
            }
            return user;            
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return null;
        }
        finally
        {
            DBUtil.closeResultSet(rs);
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }

    }

} 
```

这是 RegisterUserServlet：

```
package eBooks.controller;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.RequestDispatcher;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import javax.servlet.http.Cookie;

import eBooks.business.User;
import eBooks.business.Account;
import eBooks.Data.UserDB;

public class RegisterUserServlet extends HttpServlet
{

    public void doPost(HttpServletRequest request,
                       HttpServletResponse response)
                       throws IOException, ServletException
    {
        HttpSession session = request.getSession();

        String fName = request.getParameter("fName");
        String lName = request.getParameter("lName");
        String emailAddress = request.getParameter("emailAddress");
        String password = request.getParameter("password");
        String dateOfBirth = request.getParameter("dateOfBirth");
        String phone = request.getParameter("phohe");
        String address = request.getParameter("address");
        String city = request.getParameter("city");
        String country = request.getParameter("country");
        String state = request.getParameter("country");
        String accountType = request.getParameter("accountType");
        //TO DO: Account acctTypeList = request.getParameter("acctTypeList");  add this an object first

        User user = new User();

        user.setfName(fName);
        user.setlName(lName);
        user.setEmailAddress(emailAddress);
        user.setPassword(password);
        user.setDateOfBirth(dateOfBirth);
        user.setAddress(address);
        user.setCity(city);
        user.setCountry(country);
        user.setState(state);
        user.setZipcode(phone);

        //TODO: user.setAccountType(accTypeList); -- Ask Jassin

        // Add information to the database

        if(UserDB.emailExists(emailAddress))
            UserDB.update(user);
        else
            UserDB.update(user);

        session.setAttribute("User", user);

        Cookie emailCookie = new Cookie("emailCookie", emailAddress);
        emailCookie.setMaxAge(60*60*24*365*2);
        emailCookie.setPath("/");
        response.addCookie(emailCookie);

        String url = "WEB-INF/view/registration_confirmation.jsp";
        RequestDispatcher dispatcher = getServletContext().getRequestDispatcher(url);
        dispatcher.forward(request, response);

    }

} 
```

我是 Web 开发的新手，我只需要朝着正确的方向努力来解决这个问题。

我正在使用 glassfish 和 mysql。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T02:57:57.973

刚刚解决了这个问题——将所有文件移动到一个新项目并手动创建了 web.xml，它现在工作正常。谢谢@ErnestFriedman-Hill

# javascript - Javascript 代码在 IE9 上运行不佳

> ID：10678046
> 
> 赞同：-2
> 
> 时间：2012-05-20T23:23:32.703
> 
> 标签：javascript, html

我有应该显示广告 10 秒的代码，然后加载嵌入代码。它在 Firefox 上运行良好，但在 IE9 上它在后台同时运行广告和嵌入代码。

```
<script type="text/javascript">
    var nbsec = 10;
    var c = 0;
    var t;
    var timer_is_on = 0;
    var sum = 0;

    function timedCount()
    {
        c = c + 1;
        t = setTimeout("timedCount()", 1000);
        sum = nbsec - c;
        document.getElementById('chrono').innerHTML = "<br>Loading .. Please wait " + sum + "secondes";

        if(c == nbsec) {
            stopCount();
            document.getElementById('mypub').style.visibility = 'hidden';
            document.getElementById('mygame').style.visibility = 'visible';
            document.getElementById('mygame').style.display = 'block';
            document.getElementById('mygame').style.height = 'auto';
            document.getElementById('mypub').style.height = '0px';
            document.getElementById('mypub').style.padding = '0px';
            document.getElementById('mypub').innerHTML = "";
        }
    }

    function stopCount()
    {
        clearTimeout(t);
        timer_is_on = 0;
    }
</script>

<table border="2" align="center" color="F2FC7E">
    <tr>
        <td>
            <div id="mypub" style="visibility: visible; text-align:center; padding:20px;"> 

                <script>
                    ..............
                </script>

                <div id="chrono" style="color:#FFF;"></div>
            </div>
            <div id="mygame" style="visibility: hidden;display:none; height:0px">
                <param name="initial_focus" value="true">
                <applet>
                    ........................
                </applet>   
            </div>
        </td>
    </tr>
</table>

<script type="text/javascript">
    timedCount();
</script> 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:53:44.317

```
<script type="text/javascript">
var nbsec = 10;
function timedCount() {
    document.getElementById('chrono').innerHTML = "<br>Loading .. Please wait " + nbsec + "secondes";
    if( nbsec ){ // if sum != 0, wait call again
        setTimeout( timedCount, 1000 ); 
        nbsec--; // counter
    } else { // do after 10 sec
        document.getElementById('mygame').style.cssText = "visibility:visible;display:block;height:auto;";
        document.getElementById('mypub').style.cssText="visibility:hidden;height:0px;padding:0px;";
        document.getElementById('mypub').innerHTML = "";
    }
}
// stopCount is not needed
// start counter
timedCount();
</script> 
```

那是关于逻辑的

# c# - 星期几的 SQL Server 2008 数据类型

> ID：10678048
> 
> 赞同：1
> 
> 时间：2012-05-20T23:23:51.723
> 
> 标签：c#, sql, sql-server-2008

> **可能重复：**
> [SQL Server 2008 中的枚举类型？](https://stackoverflow.com/questions/2373421/enumerated-types-in-sql-server-2008)

我正在使用 SQL Server 2008，我需要一列作为星期几，有没有办法使列成为枚举，所以不能输入错误的数据？

# iphone - iPhone：NSTimer 不会响应 invalidate 并且 XCode 坚持该变量未声明

> ID：10678058
> 
> 赞同：1
> 
> 时间：2012-05-20T23:26:23.840
> 
> 标签：iphone, xcode, nstimer

我有一个简单的程序，它使用 NSTimer 每秒播放一个声音。我已经声明了 NSTimer 变量，但 XCode 认为它没有被使用。除此之外，计时器不会响应无效命令，甚至不会释放它或将其设置为 nil。我已经尝试摆脱该行的可变部分，只使用“[NSTimer ...]”部分，但后来我无法使其无效。

这是.h文件：

```
#import <UIKit/UIKit.h>

@interface timer_workingViewController : UIViewController {
    NSTimer *timer1;
}
@property (nonatomic, retain) NSTimer *timer1;
- (IBAction)startButtonPressed:(id)sender;
- (IBAction)stopButtonPressed:(id)sender;
- (void)timerFunction:(id)sender;
@end 
```

这是 .m 文件：

```
#import "timer_workingViewController.h"
#import <AudioToolbox/AudioToolbox.h>
@implementation timer_workingViewController
@synthesize timer1;

- (IBAction)startButtonPressed:(id)sender {
    NSTimer *timer1 = [NSTimer scheduledTimerWithTimeInterval: 1.0 target:self selector:@selector(timerFunction:) userInfo:nil repeats: YES];
}

- (IBAction)stopButtonPressed:(id)sender {
    [timer1 invalidate];
    [timer1 release];
    timer1 = nil;
}

- (void)timerFunction:(id)sender {
    NSString *path = [[NSBundle mainBundle] pathForResource:@"bell" ofType:@"wav"];
    SystemSoundID soundID;
    AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath:path], &soundID);
    AudioServicesPlaySystemSound(soundID);
}

- (void)viewDidLoad {
    [super viewDidLoad];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
    self.timer1 = nil;
}

- (void)dealloc {
    [timer1 invalidate];
    [super dealloc];
}

@end 
```

nib 文件由一个开始按钮和一个停止按钮组成。按下开始按钮会导致计时器启动并且文件可以正常播放，但是一旦启动就无法停止。

这里有什么明显的错误吗？在线搜索一无所获，我尝试的任何方法都不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T23:30:17.807

您通过在 startButtonPressed 中声明一个同名的局部变量来隐藏 timer1 的成员声明：

删除 NSTimer* 声明，以便将新计时器分配给成员变量。您还需要进行保留，以便您的成员变量保留引用。

```
- (IBAction)startButtonPressed:(id)sender {
    timer1 = [[NSTimer     scheduledTimerWithTimeInterval: 1.0 target:self     selector:@selector(timerFunction:) userInfo:nil     repeats: YES] retain];
} 
```

完成后，请务必释放 timer1 并将其设置为 nil。

# asp.net - 单声道是 asp.net 的可行替代方案吗？

> ID：10678063
> 
> 赞同：5
> 
> 时间：2012-05-20T23:26:59.493
> 
> 标签：asp.net, .net, mono, web-hosting

我正在研究我将用于我的项目的平台。其中一部分是一个非常简单的 .NET 网站。我想为它获得一个 Amazon EC2 主机，我确实看到 lunux 主机的成本比 windows 低两倍。我还觉得使用 Linux 可以比使用 Windows 更有效地利用硬件。所以，我的想法是，如果我让我的网站在 Mono 下运行，我将能够更便宜地托管它。我现在的问题是：

*   Mono 平台是否足够稳定来托管网站？我所说的稳定是指：错误、崩溃、安全问题。换句话说，托管生产网站是否足够好？

*   什么网络服务器适合我的网络？我总是听到“apache”，但它是一个臃肿的平台，专为重型网络而设计。我的模型是 - 一台 EC2 主机 = 一个网站。这不是矫枉过正吗？是否有其他替代品，既轻便又稳定？

*   有在 Mono 上运行的成功网站的例子吗？他们的设置到底是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:42:33.063

您的第一个问题是无效的恕我直言。对生产使用的要求不仅仅是使用的技术，因为它还涉及与服务提供商 (Amazon)、框架供应商 (Xamarin)、应用程序供应商（您的开发团队或第三方）的支持合同。

即使您选择 .NET/IIS/Windows，您也会面临同样的情况。

Mono 支持 FastCGI，因此 Apache 只是您的 Web 服务器选项之一。[http://www.mono-project.com/FastCGI](http://www.mono-project.com/FastCGI)

Mono 的展示案例可以从以下链接中找到，

[http://tirania.org/blog/archive/2010/Jun-16-1.html](http://tirania.org/blog/archive/2010/Jun-16-1.html)

[http://mono.1490590.n4.nabble.com/Showcase-of-mono-projects-td2300715.html](http://mono.1490590.n4.nabble.com/Showcase-of-mono-projects-td2300715.html)

还有更多，发布在[http://mono-project.com/Companies_Using_Mono](http://mono-project.com/Companies_Using_Mono)

如果您也想进行更多查询，我建议您与 Xamarin 交谈，

[http://support.xamarin.com/](http://support.xamarin.com/)

# c++ - 线程同时读/写

> ID：10678065
> 
> 赞同：2
> 
> 时间：2012-05-20T23:27:41.720
> 
> 标签：c++, multithreading

如果我不在乎变化是否`Thread1`同时`Flag1`变化`Thread2`，`Flag1`除了逻辑错误还有什么需要担心的吗？如果出现以下情况，是否会导致崩溃等：

1.  `Thread1`并同时`Thread2`阅读`Flag1`？
2.  `Thread1`是在读`Flag1`的同时写吗？`Thread2``Flag1`

在这些示例中，`Flag1`是`bool`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T00:04:28.210

根据C++11内存模型的规则：

1.  *Thread1 和 Thread2 同时读取 Flag1？*这总是安全的。
2.  *Thread1 正在写入 Flag1，而 Thread2 正在读取 flag1？*这是一场数据竞赛。

数据竞争是未定义的行为。虽然它不太可能在任何健全的硬件上崩溃，但它是未定义的行为，所以任何事情都可能发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T23:36:04.340

据我所知，2个线程不能在完全相同的时间访问相同的内存。

即使在并行计算中，这些假设也会由处理器自动处理。 [http://en.wikipedia.org/wiki/Parallel_Random_Access_Machine](http://en.wikipedia.org/wiki/Parallel_Random_Access_Machine)

所以答案是没有崩溃。您当然会遇到逻辑错误，但因为您不在乎：p。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-20T23:32:51.813

该标志应标记为`volatile`。这将确保您的编译器不会以不一致的方式优化读/写。

我相信对 bool 的读/写是原子的——所以如果你不关心访问顺序，我认为你不会有任何其他问题。

# iphone - 如何知道 iPhone 相机是否准备好拍照？

> ID：10678067
> 
> 赞同：27
> 
> 时间：2012-05-20T23:28:05.227
> 
> 标签：iphone, uiimagepickercontroller

在`[camera takePicture]`相机准备好之前调用时，它会输出以下消息：

`UIImagePickerController: ignoring request to take picture; camera is not yet ready.`

我怎么知道什么时候可以拍照？

`[camera isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]`总是返回 true，即使它显然还没有准备好。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-26T17:05:46.090

正如@djromero 所说，有一个解决方案是使用`AVFoundation`（但**不是** *代替*.`UIImagePickerController`你只是`AVFoundation`用来获取通知）。

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(cameraIsReady:)
                                             name:AVCaptureSessionDidStartRunningNotification object:nil]; 
```

然后，一旦相机准备好，您就会收到通知：

```
- (void)cameraIsReady:(NSNotification *)notification
{   
    NSLog(@"Camera is ready...");
    // Whatever
} 
```

我刚刚通过`takePicture`在`UIImagePickerController`演示后调用（我收到“相机未准备好”消息）并在我的通知回调中调用它来测试它，它就像一个魅力。

**旁注**：

`[camera isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]`总是返回`Yes`，因为它只检查是否有可用的相机设备。事实上，Apple 建议您在尝试初始化和呈现控制器之前，始终必须检查 this 是否返回`Yes`，并且您有一个非 nil 委托（通过标准接口为选取器提供一种方式）。`dismiss`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:42:53.310

老实说，我还没有尝试过，文档有些模棱两可，但是呢`[UIImagePickerController isCameraDeviceAvailable:...]`？

编辑：正如我刚刚了解到的，这不是您问题的解决方案。对不起，我认为这可能值得一试......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T16:54:32.883

@Alladinian 说的是最有帮助的，这个答案是对此的补充。我建议使用他的 AVCaptureSessionDidStartRunningNotification 技术，因为它会告诉您相机最初何时准备好（但这只会调用一次。）我还关心设备是否也准备好拍摄后续照片。我还没有找到最好的解决方案，因为我没有看到任何不涉及相机会话的设备的回调。但是这个回调函数似乎已经足够好了：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info 
```

请注意，在调用该回调之前，相机很可能已准备好，您可以塞入一两张照片，但似乎在调用回调时相机肯定已准备好。这应该可以防止您在多个相机拍摄之间出现以下错误。

```
UIImagePickerController: ignoring request to take picture; image is already being captured or camera not yet ready. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-05T04:53:50.487

这是一个 Swift 版本：

```
NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(self.cameraIsReady), name: AVCaptureSessionDidStartRunningNotification, object: nil)

func cameraIsReady(notification :NSNotification ) {
     print("Camera is ready...")
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-16T21:50:51.813

根据 UIImagePickerController 的文档。takePicture() 方法再次准备好

```
func imagePickerController(picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : AnyObject]) { 
```

叫做。如果您有兴趣在此期间阻止图片，只需禁用按钮界面 (button.userInterfaceEnabled = false)，直到调用返回媒体。我使用 imagePickerController 解决了这个问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-10-12T20:58:56.400

这样可以确保在相机准备好后立即开始捕获视频

```
imgpicker = [[UIImagePickerController alloc] init];  
[self presentViewController:imgpicker animated:YES completion:^(void){       
while(![imgpicker startVideoCapture]);
}]; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-26T12:13:09.273

如果您使用的是 UIImagePickerController，以下是视频代码，类似的代码也适用于图像。

```
UIImagePickerController *picker;
BOOL cameraIsOn; 
```

然后检查可用的相机设备

```
if ([UIImagePickerController isCameraDeviceAvailable:[picker cameraDevice]]) {
            if (cameraIsOn) {
                NSLog(@"stop camera");
                [picker stopVideoCapture];
                cameraIsOn = FALSE;
            }
            else {
                NSLog(@"start camera");
                [picker startVideoCapture];
                self.videoTimer =  [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(changeValue) userInfo:nil repeats:YES];
                cameraIsOn = TRUE;
            }
        } 
```

# jquery - jquery if 语句隐藏元素

> ID：10678069
> 
> 赞同：3
> 
> 时间：2012-05-20T23:28:42.917
> 
> 标签：jquery

我似乎无法弄清楚**当我在第一个 div 上时如何简单地隐藏“prev”按钮，而在最后一个 div 上时如何隐藏“next”按钮**。

希望有专业人士愿意帮助新手。这是我的代码：

```
<!DOCTYPE html>
<html>
<head>
  <style>
      div { width:40px; height:40px; margin:10px; float:left; border:2px blue solid; padding:2px; }
      span { font-size:14px; }
      p { clear:left; margin:10px; }
  </style>
  <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <div></div>
  <div></div>
  <div></div>
  <div id="start"></div>
  <div></div>
  <p><button id="prev">Prev</button></p>
  <p><button id="next">Next</button></p>
    <script type="text/javascript">
        var $curr = $("#start");
        $curr.css("background", "#f99");
        $("#prev").click(function () {
            $curr = $curr.prev();
            $("div").css("background", "");
            $curr.css("background", "#f99");
        });
        var $curr = $("#start");
        $curr.css("background", "#f99");
        $("#next").click(function () {
            $curr = $curr.next();
            $("div").css("background", "");
            $curr.css("background", "#f99");
        });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:50:53.037

我对您的标记做了一些修改，它反映了解决此类问题的传统方法。

```
<div class="boxes">
    <div>F</div>
    <div>E</div>
    <div>W</div>
    <div class="active">L</div>
    <div>X</div>
</div>
<p><button id="prev">Prev</button></p>
<p><button id="next">Next</button></p>​ 
```

注意我们所有元素`.boxes`周围的容器。`div`此外，请注意，我们不再使用`id`，而是使用类 ( `.active`) 来跟踪我们当前的位置。

```
// When the #prev or #next buttons within a p are clicked
$("p").on("click", "#prev, #next", function(e){
    // Find reference to current active element, and remove class
    var active = $(".active").removeClass("active");
    // If we have an active element
    active.length
        // Determine direction of action 
        ? $(this).prop("id") === "prev"
              // If the #prev button was clicked, move back a sibling
              ? active.prev().addClass("active")
              // If the #next button was clicked, move forward a sibling
              : active.next().addClass("active")
        // No active element? Set the first child as active
        : $(".boxes :first-child").addClass("active");  
    // Show or hide #prev and #next based on active element location
    $("#prev").toggle( !$(".active").is(":first-child") );
    $("#next").toggle( !$(".active").is(":last-child") );
// Trigger this on load to setup active element if not already present
}).find("#prev").trigger("click"); 
```

小提琴：http: [//jsfiddle.net/txpj2/2/](http://jsfiddle.net/txpj2/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:37:36.440

```
var $curr = $("#start");
$curr.css("background", "#f99");
$("#prev").click(function () {
    $("#next").show();
    $curr = $curr.prev('div');
    $("div").css("background", "");
    $curr.css("background", "#f99");
    if (!$curr.prev('div').length) $(this).hide();
 });
 $("#next").click(function () {
    $("#prev").show();
    $curr = $curr.next('div');
    $("div").css("background", "");
    $curr.css("background", "#f99");
    if (!$curr.next('div').length) $(this).hide();
 }); 
```

[小提琴](http://jsfiddle.net/v6Zxv/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T23:30:56.460

要使用 jQuery 隐藏元素，请使用以下语法：

```
$("#prev").hide(); 
```

这将隐藏**Prev**按钮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T23:46:25.997

我建议在第一个 div 和最后一个 div 中添加一个 ID，以防您的索引号因添加或删除 div 而发生变化

看到变化

```
 <div id="first"></div>
  <div></div>
  <div></div>
  <div id="start"></div>
  <div id="last"></div> 
```

这是整个工作

```
<!DOCTYPE html>
<html>
<head>
  <style>
      div { width:40px; height:40px; margin:10px; float:left; border:2px blue solid; padding:2px; }
      span { font-size:14px; }
      p { clear:left; margin:10px; }
  </style>
  <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
  <div id="first"></div>
  <div></div>
  <div></div>
  <div id="start"></div>
  <div id="last"></div>
  <p><button id="prev">Prev</button></p>
  <p><button id="next">Next</button></p>
    <script type="text/javascript">
        var $curr = $("#start");
        $curr.css("background", "#f99");
        $("#prev").click(function () {
                $("#next").show();
                $curr = $curr.prev();
                $("div").css("background", "");
                $curr.css("background", "#f99");
            if ($curr.attr("id")) == "first") {
                $(this).hide();
            }
        });
        $("#next").click(function () {
            $("#prev").show();
            $curr = $curr.next();
            $("div").css("background", "");
            $curr.css("background", "#f99");
            if ($curr.attr("id") == "last") {
                $(this).hide();
            }

        });
    </script>
</body>
</html>​​​​​​​​​​​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-20T23:41:32.087

请参阅下面的 jsfiddle 和代码以及正确答案，其他答案并不完整。此版本将确保无论容器中有多少 div，prev / next 按钮都将正确隐藏。

```
var updateButtons = function() {
    var $curr = $(".current");

    if ($curr.prev().length > 0)
        $("#prev").show();
    else
        $("#prev").hide();

    if ($curr.next().length > 0)
        $("#next").show();
    else
        $("#next").hide();
};

var $curr = $("#start");
$curr.css("background", "#f99");
$("#prev").click(function () {
    $curr.removeClass("current");
    $curr = $curr.prev();
    $("div").css("background", "");
    $curr.css("background", "#f99");
    $curr.addClass("current");
    updateButtons();
});
var $curr = $("#start");
$curr.css("background", "#f99");
$("#next").click(function () {
    $curr.removeClass("current");
    $curr = $curr.next();
    $("div").css("background", "");
    $curr.css("background", "#f99");
    $curr.addClass("current");
    updateButtons();
});

updateButtons(); 
```

[http://jsfiddle.net/rFs7Q/1/](http://jsfiddle.net/rFs7Q/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-20T23:54:27.560

## *[jsBin 演示](http://jsbin.com/ukacuq/7/edit#javascript,html,live)*

```
var curr = 3;  // SET DESIRED START N (Remember: zero based)
var divN = $('div').length;

function doit(){
  $('div').eq(curr % divN).css("background", "#f99").siblings('div').css("background", "#fff");
}doit();

$("#prev, #next").click(function (e) {
 var set = this.id === 'prev' ? curr-- : curr++ ;
  doit();
}); 
```

# c - 从视频文件中提取帧作为 rgb 数组

> ID：10678071
> 
> 赞同：3
> 
> 时间：2012-05-20T23:29:22.607
> 
> 标签：c, video, ffmpeg

有没有一种方法可以从视频文件中逐帧提取。我需要内存中的原始 rgb 数据，以便计算对象的位置。我尝试在 linux 中使用 ffmpeg 这样做，但我遇到了很多问题，例如当我使用函数时，`av_register_all()`我得到全屏错误。[该教程](http://dranger.com/ffmpeg/tutorial01.html)几乎描述了我需要的东西，但它已经过时了，我无法用新版本的 ffmpeg 编译它。有人可以帮助我就如何更新/编辑此代码或不同的编译方法提供一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T06:40:44.417

也许您可以尝试[mencoder](http://en.wikibooks.org/wiki/Mplayer#Mencoder)从视频中提取 jpg 格式的图像，然后转换为 rgb。

```
mplayer input.avi -vo jpeg:outdir=dirname:quality=80 
```

使用 ffmpeg，这是一个很棒的[教程](https://web.archive.org/web/20120626095415/http://linuxers.org/tutorial/how-extract-images-video-using-ffmpeg)

# asp.net-mvc-3 - MVC3 - 从不同的动作将 int[] 传递给 RedicrectToAction 上的控制器动作时遇到问题

> ID：10678077
> 
> 赞同：4
> 
> 时间：2012-05-20T23:30:34.497
> 
> 标签：asp.net-mvc-3

我在同一个控制器中有 2 个动作。

```
public ActionResult Index(string filter, int[] checkedRecords) 
```

和

```
public ActionResult ExportChkedCSV(string filter, int[] checkedRecords) 
```

第二个操作 (ExportChkedCSV) 包含此重定向：

```
if (reject != 0)
        {
            return RedirectToAction("Index", new { filter, checkedRecords });
        } 
```

当我逐步完成时，在 RedirectToAction 语句中正确填充了参数 checkedRecords，但是当它从那里点击 Index ActionResult 时，checkedRecords 为空。我尝试过 filter =、checkedRecords = 等。从 View 到 Controller，我对此没有任何问题。如果我将数组类型更改为其他类型，我可以获取该值 - 如何将 int[] 从一个动作传递到另一个动作？我究竟做错了什么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T01:09:27.317

您不能在 MVC 中将复杂类型作为重定向参数发送，只能发送像数字和字符串这样的原始类型

使用 TempData 传递数组

```
...
if (reject != 0) {
    TempData["CheckedRecords"] = yourArray;
    return RedirectToAction("Index", new { filter = filterValue });
}
...

public ActionResult Index(string filter) {
    int[] newArrayVariable;
    if(TempData["CheckedRecords"] != null) {
        newArrayVariable = (int[])TempData["CheckedRecords"];
    }
    //rest of your code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:45:31.167

您正在发送两个空值。当您使用 new {} 时，您正在创建一个新对象。您不仅要定义索引名称，还要定义值。

```
return RedirectToAction("Index", new { filter = filter, checkedRecords = checkedRecords }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T00:35:24.083

我不确定 ASP.Net 是否知道如何使用您传递的 int 数组构建 URL。如果 int 数组唯一标识一个资源，那么您可以尝试将数组转换为连字符分隔（或类似）的字符串，然后在 Index 方法中解析该字符串。

如果您只是想在请求之间保留数据，请使用 TempData：

[http://msdn.microsoft.com/en-us/library/system.web.mvc.controllerbase.tempdata.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.controllerbase.tempdata.aspx)

# css - 标签中的CSS圆角小问题

> ID：10678082
> 
> 赞同：0
> 
> 时间：2012-05-20T23:31:12.000
> 
> 标签：css, rounded-corners

我有这个代码[http://jsfiddle.net/Kbzgd/](http://jsfiddle.net/Kbzgd/)我想做的是在右上角它也有圆角效果......

但是，如果我删除边框底部并将该边框添加到边框顶部等内容中，则活动选项卡会在底部获得该边框，我不想要那个 =\

我想要这样，但右上角有圆角，可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:40:35.877

试穿`border-top-right-radius: 5px`_`.tab_content_container`

经过更多的摆弄后，我添加了这个：

```
border-top-right-radius: 6px;
border-top: 1px solid #CCC;
position: relative;
top: -1px;
z-index: -10; 
```

所以右边的角落看起来更好一点。另一种方法是使用`box-shadow: 0 -1px 0 0 #CCC`(div 上方的阴影) 而不是`border-top`and`top`值。

编辑：经过更多的编辑，我摆脱了一点点突出（你会看到如果你仔细看上面的几个例子）。

您所要做的就是删除 ul 上的边框（div 的边框/阴影可以正常工作，只要您将其设置`z-index`在 ul 后面）。请注意，当您移动边框时，它会移动一点，因此您可以`position: relative; top: 1px;`重新设置 ul。

我提供了多种选择，因为我不知道是否会与您的其余代码发生冲突。

这是我的最终 CSS：

```
ul.tabs {
    border-bottom: 1px solid rgba(0, 0, 0, 0); /*this is an alternative which sets the border to be transparent*/
    float: left; 
    height: 29px; 
    list-style: none; 
    margin: 0; 
    padding: 0; 
    width: 100%;
}

.tab_content_container {
    background: #fff;
    border-radius: 0 0 5px 5px;
    border: 1px solid #ccc; border-top: none;
    clear: both; 
    float: left; 
    width: 100%; 
    border-top-right-radius: 6px;
    /*border-top: 1px solid #CCC;
    /*top: -1px; again some alternatives*/
    position: relative;
    z-index: -10;
    box-shadow: 0 -1px 0 0 #CCC
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:53:29.837

这里： http: [//jsfiddle.net/2CVNj/](http://jsfiddle.net/2CVNj/) 在标签周围添加了一个新的 div 以使用[`overflow: auto`解决方案](http://www.quirksmode.org/css/clearing.html)来清除浮动，然后将边框移到内容顶部并摆弄一些 z-index。效果很好。

# forms - 我可以验证以确保 Symfony2 选择表单字段中发布的数据在其选择列表中吗？

> ID：10678083
> 
> 赞同：0
> 
> 时间：2012-05-20T23:31:13.873
> 
> 标签：forms, validation, select, symfony, choice

我正在创建一个 Symfony2 表单。

我可以验证以确保选择字段中发布的数据在其选择列表中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:54:14.993

In choice field ,there is a property named `strict` set to `true` By default its value is `false`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:18:02.513

是的，您可以使用选择验证约束。

[http://symfony.com/doc/current/reference/constraints/Choice.html](http://symfony.com/doc/current/reference/constraints/Choice.html)

# javascript - 鼠标位置分页

> ID：10678084
> 
> 赞同：3
> 
> 时间：2012-05-20T23:31:16.573
> 
> 标签：javascript, jquery, html

我正在寻找执行以下操作的脚本。如果您访问此网站[http://wearehunted.com/](http://wearehunted.com/)

如果您将鼠标移到右侧，则会显示更多数据。根据鼠标左或右的位置，显示更多数据。我试过拉网站的来源，我想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:34:36.867

你可以使用这个：

```
window.onmousemove = function(e){
    var e = e || event;
    var x = e.screenX;
    var y = e.screenY;
    //Do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:43:06.300

它不是[分页](http://en.wikipedia.org/wiki/Pagination)脚本，只是一个简单的滑块。如果您将鼠标移动到左侧/右侧的区域，它会朝该方向滚动。

[您可以在http://media2.wearehunted.com/media/js/jquery.draggrid.js?v=21824](http://media2.wearehunted.com/media/js/jquery.draggrid.js?v=21824)找到 jQuery 插件源

# java - Java正则表达式解释

> ID：10678086
> 
> 赞同：-2
> 
> 时间：2012-05-20T23:31:36.057
> 
> 标签：java, regex

```
import java.util.regex.*;

public class Splitter {
    public static void main(String[] args) throws Exception {
        Pattern p = Pattern.compile("[,\\s]+");
        String[] results = p.split("one,two, three   four ,  five");
        for (String result : results) {
            System.out.println(result);
        }
    }
} 
```

分隔符可以是逗号或空格，也可以是任意数量的组合。我认为它的正则表达式应该是`[,\s]+`. 为什么示例中有一个额外的反斜杠？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T23:34:58.863

额外`\`的是逃避下一个反斜杠。在任何 Java 字符串`"\\"`中意味着`"\"`.

这是因为`'\'`是一个特殊字符。您一定已经看到`"\n"`用于表示换行符吧？因此，要将文字`\`放入您使用的字符串中`"\\"`。

例如尝试`System.out.println("Here\'s a backslash : \\")`。

这将打印： `Here's a backslash : \`

# javascript - 使用 onclick 函数将 $(this) 从 iframe 元素传递到父页面

> ID：10678097
> 
> 赞同：-1
> 
> 时间：2012-05-20T23:34:15.567
> 
> 标签：javascript, jquery, iframe, onclick

我有一个 iframe，其中包含

```
<div title="hello" onclick="window.top.iframeclick()"></div> 
```

在父页面上，是 jquery：

```
 function iframeclick() {
                title = $(this).attr('title');
                alert(title);} 
```

警报正在执行，但是，它不会更新`title`在父页面中设置的变量。

`title`有人可以帮助解释为什么当我单击 iframe 时它可能不会重置变量`<div>`，而是使用不同的元素作为 $(this)？

**问：如何将 iframe 的 div 中的 $(this) 传递给在父页面中设置的函数中使用？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:36:57.957

看起来像是变量范围的问题，请检查 iframeclick 函数中的 title 变量是否可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:59:31.047

您是否尝试设置`title`为父文档的标题或 div 上的标题？

如果在 div 上，IMO 最好的方法是在函数调用中传递值：

```
<div title="hello" onclick="window.top.iframeclick('hello')"></div>

function iframeclick(myTitle) {
                title = myTitle;
                alert(title);} 
```

# .htaccess - HTML5 样板构建脚本、基于 VCS 的部署和重复内容

> ID：10678099
> 
> 赞同：2
> 
> 时间：2012-05-20T23:34:39.643
> 
> 标签：.htaccess, html5boilerplate, build-script

我在刚刚部署到暂存环境的新项目中使用 HTML5 Boilerplate 构建脚本。脚本就像一个魅力；它有据可查，因此很容易配置以在我的应用程序中使用。

在阅读完文档后，我决定使用 Paul Irish 的基于 VCS 的部署方法来指向 /publish 目录，并在我的 .htaccess 文件中使用他的文档中的这段代码：

```
RewriteEngine On
RewriteCond $1 !^publish/
RewriteRule ^(.*)$ publish/$1 [L] 
```

我已经为我的特定设置进行了这样的配置，并且所有内容都指向缩小和连接的文件，就像它应该的那样。这很好，但也可以通过访问 http://[mysite.com]/publish/ 直接浏览 /publish 目录

这似乎有点像一根松散的线，让人悬空。我想知道这里是否有人遇到过这个问题并提出了一个好的解决方案。我不希望用户在 URL 之后输入 /publish/，但我不希望它肯定是可抓取的，而且这样离开它似乎有点草率。

有任何想法吗？

提前致谢

**更新：**在得到 Gerben 非常感谢的帮助之后，我最终改变了我的想法 - 无需将用户从 /publish 重定向到根 URL，因为用户不会输入 /publish，并且会有永远不要链接到 [site.com]/publish。相反，我在 /publish 目录中的 .htaccess 文件中添加了以下规则。对于发布子目录的任何请求，这都会产生 403 错误（禁止）：[http ://httpd.apache.org/docs/current/rewrite/flags.html#flag_f](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_f)

```
RewriteCond %{THE_REQUEST} publish
RewriteRule .? - [F] 
```

此外，我已将发布目录添加到 robots.txt，以确保搜索机器人不会索引包含相同数据的两组文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:44:26.983

所以我最终得到的解决方案是在用户碰巧偶然发现 [site.com]/publish 时向用户抛出 403（禁止）错误。我是这样做的：

在根目录的 .htaccess 文件中，我保留了 h5bp 文档中的这条规则：

```
RewriteCond $1 !^publish/
RewriteRule ^(.*)$ publish/$1 [L] 
```

在 /publish 目录的 .htaccess 文件中，我添加了这条规则，带有 F 标志（禁止）：

```
RewriteCond %{THE_REQUEST} publish
RewriteRule .? - [F] 
```

我希望这对遇到此问题的其他人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T17:33:46.217

似乎我误读了你的问题。我认为以下内容会将任何内容重定向回根文件夹。

```
RewriteCond %{THE_REQUEST} " /publish/"
RewriteRule ^publish/(.*) /$1 [R=302,L] 
```

可以肯定的是，我可能还会将 /public 添加到我的 robots.txt 中，以防万一您不小心删除了 htaccess 或其他东西。

**解释**：RewriteRule 检查请求的 url 是否以 开头，`publish/___`并将这些 url 重定向到`/___`. 但是要区分直接请求`/publish`和重写的 url，`/publish`您需要检查最初请求的 url。实现这一目标的唯一方法是通过 THE_REQUEST 变量。该变量应该包含类似`GET /publish/___ HTTP/1.1`直接请求的内容。所以 RewriteCond 检查是否存在`<space>/publish/`

**编辑：** 最后的尝试：

```
RewriteBase /
RewriteCond %{ENV:REDIRECT_STATUS} ^$
RewriteRule ^publish/(.*) /$1 [R=302,L] 
```

# python - Django ORM 能否以可靠的与后端无关的方式存储无符号 64 位整数（又名 ulong64 或 uint64）？

> ID：10678102
> 
> 赞同：38
> 
> 时间：2012-05-20T23:34:54.450
> 
> 标签：python, django, orm, django-models, unsigned-long-long-int

我看到的所有文档都暗示您*可能*能够做到这一点，但是没有任何官方 w/r/t ulong64/uint64 字段。有一些现成的选项在这个领域看起来很有希望：

*   `BigIntegerField`...几乎，但已签名；
*   `PositiveIntegerField`... 可疑的 32 位外观；和
*   `DecimalField``decimal`...根据[文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#decimalfield)，用 python 类型表示的固定指针——它可能会变成一个类似的迂腐和缓慢的数据库字段，当被删除时，á la DECIMAL 或 NUMERIC PostgreSQL 类型。

...所有这些*看起来*都*可能*存储这样的数字。除了没有人会承诺，就像休格兰特描绘的每一个浪漫喜剧角色一样。

我的主要标准是它与 Django 支持的后端一起工作，没有任何`if postgresql (...) elif mysql (...)`类型的特殊情况废话。之后，需要速度——这是视觉数据库应用程序中的模型字段，它将索引图像派生数据（例如感知散列和提取的关键点特征），允许按这些图像的内容进行排序和分组.

那么：是否有一个好的 Django 扩展或应用程序可以提供某种`PositiveBigIntegerField`适合我的目的？

而且，除此之外：如果有一种简单可靠的方法可以使用 Django 的库存 ORM 来存储无符号的 64 位整数，我想知道。看，我不是二进制高手；我必须在纸上做二进制补码——所以如果你的这个方法涉及一些位移技巧，不要犹豫解释它是什么，即使它让你觉得很明显。提前致谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-20T23:47:19.413

虽然我没有测试它，但你不妨只是子类化`BigIntegerField`. 原来的`BigIntegerField`样子（[来源在这里](https://github.com/django/django/blob/ce3351b9508896afdf87d11bd64fd6b5ad928228/django/db/models/fields/__init__.py#L1831)）：

```
class BigIntegerField(IntegerField):
    empty_strings_allowed = False
    description = _("Big (8 byte) integer")
    MAX_BIGINT = 9223372036854775807

    def get_internal_type(self):
        return "BigIntegerField"

    def formfield(self, **kwargs):
        defaults = {'min_value': -BigIntegerField.MAX_BIGINT - 1,
                    'max_value': BigIntegerField.MAX_BIGINT}
        defaults.update(kwargs)
        return super(BigIntegerField, self).formfield(**defaults) 
```

派生`PositiveBigIntegerField`可能如下所示：

```
class PositiveBigIntegerField(BigIntegerField):
    empty_strings_allowed = False
    description = _("Big (8 byte) positive integer")

    def db_type(self, connection):
        """
        Returns MySQL-specific column data type. Make additional checks
        to support other backends.
        """
        return 'bigint UNSIGNED'

    def formfield(self, **kwargs):
        defaults = {'min_value': 0,
                    'max_value': BigIntegerField.MAX_BIGINT * 2 - 1}
        defaults.update(kwargs)
        return super(PositiveBigIntegerField, self).formfield(**defaults) 
```

尽管您应该在使用它之前对其进行彻底测试。如果你这样做，请分享结果:)

**编辑**：

我错过了一件事——内部数据库表示。这基于返回的值，`get_internal_type()`并且列类型的定义被存储，例如。[这里](https://github.com/django/django/blob/master/django/db/backends/mysql/creation.py#L20)是 MySQL 后端的情况，并[在此处](https://github.com/django/django/blob/master/django/db/models/fields/__init__.py#L208)确定。看起来覆盖`db_type()`可以让您控制该字段在数据库中的表示方式。但是，您需要找到一种`db_type()`通过检查`connection`参数来返回特定于 DBMS 的值的方法。

# objective-c - 在 cellForRowAtIndexPath 的 uitableview 中调用的函数使滚动变慢

> ID：10678103
> 
> 赞同：1
> 
> 时间：2012-05-20T23:34:56.213
> 
> 标签：objective-c, uitableview, uiimage

我有一个图像，每次用户滚动 uitableview 时都会返回。这段代码在里面：

```
- (UITableViewCell *)tableView:(UITableView *)aTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

正在调用的代码如下，并为指定的图像创建阴影：

```
-(UIImage*)imageWithShadowForImageRight:(UIImage *)initialImage {

    CGColorSpaceRef colourSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef shadowContext = CGBitmapContextCreate(NULL, initialImage.size.width + 10, initialImage.size.height + 10, CGImageGetBitsPerComponent(initialImage.CGImage), 0, colourSpace, kCGImageAlphaPremultipliedLast);
    CGColorSpaceRelease(colourSpace);

    CGContextSetShadowWithColor(shadowContext, CGSizeMake(5,-5), 10, [UIColor blackColor].CGColor);
    CGContextDrawImage(shadowContext, CGRectMake(0, 10, initialImage.size.width, initialImage.size.height), initialImage.CGImage);

    CGImageRef shadowedCGImage = CGBitmapContextCreateImage(shadowContext);
    CGContextRelease(shadowContext);

    UIImage * shadowedImage = [UIImage imageWithCGImage:shadowedCGImage];
    CGImageRelease(shadowedCGImage);

    return shadowedImage;
} 
```

上面的代码使滚动缓慢且不流畅。有没有办法通过更改代码来解决这个问题，以便它可以更快地加载图像？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:42:37.137

你是对的，这*是*平滑滚动的成败功能。您需要通过避免尽​​可能多的计算来使其尽可能快。

例如，您可以为您的`imageWithShadowForImageRight:`方法处理的图像添加缓存：设置一个实例[`NSCache`](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/NSCache_Class/Reference/Reference.html)来存储处理后的图像；以索引路径为key，避免在滚动过程中多次请求同一张图片时重新计算。

```
-(UIImage*)imageWithShadowForImageRight:(UIImage *)initialImage atIndexPath:(NSIndexPath*) indexPath {
    UIImage *res = [cache objectForKey:indexPath];
    if (!res) {
        // get the shadowed image
        res = shadowedImage;
        [cache setObject:res forKey:indexPath];
    }
    return res;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:41:41.030

可以使用静态阴影图像，还是需要为每个图像独立渲染？动态阴影是一项昂贵的操作，尤其是与滚动相结合。

另外，您可以为 viewDidLoad 中的所有图像调用此方法吗？这样，您不必渲染阴影，同时也将计算时间用于绘制滚动视图和填充表格单元格。

# java - 生成一组唯一数字java

> ID：10678107
> 
> 赞同：-3
> 
> 时间：2012-05-20T23:36:00.780
> 
> 标签：java, android, random

> **可能重复：**
> [在 Java 中生成唯一的随机数](https://stackoverflow.com/questions/9423523/generate-unique-random-numbers-in-java)

我正在为 android 创建一个彩票应用程序，它将生成一组 1 到 49 之间的 6 个数字。我遇到的问题是如何使这些数字独一无二。

```
Random r = new Random();
int n1=r.nextInt(48) + 1;
ball1.setText(String.valueOf(n1));
int n2=r.nextInt(48) + 1;
ball2.setText(String.valueOf(n2));
int n3=r.nextInt(48) + 1;
ball3.setText(String.valueOf(n3));
int n4=r.nextInt(48) + 1;
ball4.setText(String.valueOf(n4));
int n5=r.nextInt(48) + 1;
ball5.setText(String.valueOf(n5));
int n6=r.nextInt(48) + 1;
ball6.setText(String.valueOf(n6)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T23:38:41.050

这是一个经典的任务。取 [1..49] 值的数组，生成 6 个随机排列，然后取排列数组的 6 个第一项。

这称为洗牌（[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:38:08.647

这是一个非常简单的解决方案。您创建了一个 for 循环来生成新数字，如果它是您创建的第一个数字，则将其添加到临时数组中。然后，每次生成一个新数字时，都要检查现有数字的数组，如果它不是唯一的，则将 1 添加到 for 循环的计数器。

这将继续进行，直到您拥有所有唯一编号。希望这是有道理的。

# html - 当前的文件支持是什么 ?

> ID：10678112
> 
> 赞同：2
> 
> 时间：2012-05-20T23:36:49.753
> 
> 标签：html, audio, browser

我试图找出哪些音频文件与所有浏览器中的 <audio> 标签兼容。我看到一些网站声明有些使用.mp3，有些使用.ogg，但在其他地方我看到所有支持.wav。但是那些网站已经过时了。

*是否有关于所有平台上**所有*浏览器当前对 <audio> 的支持的最新信息？

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T11:59:32.227

@animusion 错了，Internet Explorer 9*确实*支持音频标签！

您现在只需要两种格式即可涵盖所有浏览器：

**Ogg Vorbis**（通常为 .ogg）：涵盖除 IE 和 Safari 之外的所有浏览器，大概是因为它们讨厌互联网并且不想支持免费格式。

**AAC**（通常为 .m4a）：涵盖 Internet Explorer 和 Safari。

[你不应该*使用*MP3。](http://www.scirra.com/blog/64/why-you-shouldnt-use-mp3-in-your-html5-games)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:44:32.353

该资源是最新的：[http](http://www.scirra.com/blog/44/on-html5-audio-formats-aac-and-ogg) ://www.scirra.com/blog/44/on-html5-audio-formats-aac-and-ogg 。甚至 MS 也有一篇关于媒体标签的新文章， http: [//msdn.microsoft.com/en-us/magazine/hh781023.aspx](http://msdn.microsoft.com/en-us/magazine/hh781023.aspx)*

# .htaccess - 找不到目录时添加目录？

> ID：10678114
> 
> 赞同：1
> 
> 时间：2012-05-20T23:37:06.227
> 
> 标签：.htaccess

它应该首先检查第一个 /$1/ 是否是一个目录，如果不是，则在它之前添加一个目录。

EG：每个网址：

```
pizza
pizza/olives
pasta
pasta/lasagna 
```

应该去：

```
menu/pizza
menu/pizza/olives
menu/pasta
menu/pasta/lasagna 
```

因此。这是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:49:11.613

尝试：

```
RewriteRule ^(pizza(/olives)?|pasta(/lasagna)?)  menu/$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T13:09:38.583

比 Sp4cecat 更通用的版本

```
RewriteCond %{DOCUMENT_ROOT}/$1 -d
RewriteRule ^([^/.]+)/(.*)$ /menu/$0 [R=302,L] 
```

# ruby-on-rails-3 - Twitter Bootstrap 图标不适用于 Amazon S3 和 Heroku（使用asset_sync gem）

> ID：10678115
> 
> 赞同：2
> 
> 时间：2012-05-20T23:37:15.957
> 
> 标签：ruby-on-rails-3, heroku, amazon-s3, icons, twitter-bootstrap

我开始使用[asset_sync gem 以将Amazon S3 用作CDN 资产主机](http://devcenter.heroku.com/articles/cdn-asset-host-rails31)（我使用的是Heroku 和RoR）。我的所有资产都正确加载，除了我通过 Twitter Bootstrap 使用的图标（图标应该在的地方只有一个空白）。

我尝试使用 Heroku 的多资产预处理器支持：

*应用程序/资产/样式表/custom.css.scss.erb*

```
background-image: url(<%= asset_path "../img/glyphicons-halflings.png"%>); 
```

我还尝试将 glyphicons-halflings.png 直接移动到图像文件夹中并在那里引用它：

*应用程序/资产/样式表/custom.css.scss.erb*

```
background-image: url(<%= asset_path "/assets/glyphicons-halflings.png"%>); 
```

*应用程序/资产/样式表/custom.css.scss*

```
background-image: url("/assets/glyphicons-halflings.png"); 
```

但是，我还没有找到使它工作的方法。任何关于如何让 Twitter Bootstrap 图标成功地与 S3/Heroku 一起工作的建议将不胜感激。

**编辑：**我正在使用：`gem 'bootstrap-sass', '~> 2.0.2'`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T02:35:07.067

如果您正在使用`gem 'bootstrap-sass'`，以下是对我有用的解决方案。

首先，从[bootstrap 网站](http://twitter.github.com/bootstrap/)下载 bootstrap 。提取两个图标 .png 文件（glyphicons-halflings.png 和 glyphicons-halflings-white.png）并将它们复制到您的应用程序图像目录（app/images）中。

在您的 custom.css.scss 文件中（这可能是不同的名称，具体取决于您的应用程序）在样式表顶部（在导入引导程序之前）输入以下内容以覆盖图标图像路径：

```
 $iconSpritePath: url('/assets/glyphicons-halflings.png');
 $iconWhiteSpritePath: url('/assets/glyphicons-halflings-white.png');

 @import "bootstrap"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T21:29:19.117

例如，使用 Rails 图像助手：

```
background-image: image-url("glyphicons-halflings.png"); 
```

您还可以在 Rails 控制台中检查您的搜索路径：

```
Rails.application.config.assets.paths 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-06T14:25:32.360

对于不使用 bootstrap-sass gem 的任何人，我最终通过将默认 bootstrap css 文件扩展名更改为 scss 并编辑以下代码以使用 rails`asset_url`方法来工作。只需在代码中搜索 @font-face 并尝试一下。

```
@font-face {
 font-family: 'Glyphicons Halflings';

 src: asset_url('glyphicons-halflings-regular.eot');
 src: asset_url('glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), asset_url('glyphicons-halflings-regular.woff') format('woff'), asset_url('glyphicons-halflings-regular.ttf') format('truetype'), asset_url('glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
} 
```

提交并推送到heroku。为我工作。希望这可以帮助某人

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T07:57:45.320

您是否检查了实际使用的背景图像 URL？当我尝试在我的开发环境中测试 CDN 时，我有同样的行为。事实证明，在 application.css 中以某种方式使用了错误的存储桶

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-21T08:41:27.037

您是否设置了资产主机？

[https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration](https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration)

# sql-server-2008 - 跨流数据更改 - EDW

> ID：10678121
> 
> 赞同：0
> 
> 时间：2012-05-20T23:38:34.930
> 
> 标签：sql-server-2008, triggers, data-warehouse

我遇到了一个场景，其中数据流 B 依赖于数据流 A。每当数据流 A 发生变化时，都需要重新处理流 B。因此，需要一个通用过程来识别跨数据流的变化并触发重新处理处理任务。除了触发器之外，还有什么好方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:21:21.613

您的问题相当不清楚，我认为任何答案在很大程度上取决于您的数据是什么样子、如何加载它、如何识别更改、是否需要向用户显示一个事实或维度值的多个版本等。

以下是我们如何处理它的简短描述，它可能对您有帮助，也可能对您没有帮助：

1.  我们每天以增量方式加载原始数据，即我们在源系统中加载过去 24 小时内生成的所有数据（我在掩饰时间问题，但它们在这里并不重要）
2.  我们将原始数据插入到加载表中；该表已经包含我们之前从同一源加载的所有数据
3.  如果行是全新的（即原始数据中的 PK 值是新的），它们会被正常处理
4.  如果我们在表中找到我们已经有 PK 的行，我们知道它是我们已经处理过的数据的更新版本
5.  在我们找到更新数据的地方，我们将其标记为特殊处理并根据它重新生成任何数据（这一切都在存储过程中完成）

我认为您在问如何执行第 5 步，但这取决于更改的数据以及您的用户期望发生的情况。例如，如果订单中的一件商品发生变化，我们会重新处理整个订单，以确保订单级别的值正确无误。如果客户地址发生变化，我们必须将他重新分配到新的销售区域。

没有通用的方法来识别和处理数据变化，因为每个人的数据和需求都不同，每个人都有不同的工具集和不同的约束等等。

如果您可以使您的问题更具体，那么也许您会得到更好的答案，例如，如果您已经有了基于触发器的有效解决方案，那么您为什么要更改？你有什么问题让你寻找替代品？

# c - MinGW GCC：“未知转换类型字符'h'”（snprintf）

> ID：10678124
> 
> 赞同：15
> 
> 时间：2012-05-20T23:39:05.310
> 
> 标签：c, gcc, mingw, printf

好的，我在 Windows 7 上使用 MinGW (GCC 4.6.2) 编译 C 文件时遇到了一个奇怪的问题。有问题的文件包含以下 C 代码：

```
#include <stdio.h>

int main(int argc, char *argv[]) {
    printf("%2hhX\n", 250);
    char c[80];
    snprintf(c, sizeof(c), "%2hhX", 250);
    printf("%s\n", c);
    return 0;
} 
```

编译结果是这样的：

```
$ gcc.exe -std=c99 -pedantic -Wall test.c
test.c: In function 'main':
test.c:6:2: warning: unknown conversion type character 'h' in format [-Wformat]
test.c:6:2: warning: too many arguments for format [-Wformat-extra-args] 
```

现在，对我来说奇怪的是它抱怨`snprintf`第 6 行的呼叫，而不是第`printf`4 行的呼叫。我错过了什么还是警告不正确？此外，格式字符串是否有更好的等价物`"%2hhX"`？（我正在尝试将 char 变量打印为十六进制值。）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-21T06:49:54.583

从历史上看，MinGW 一直处于一种奇怪的境地，尤其是在 C99 支持方面。MinGW 主要依赖于随 Windows 分发的 msvcrt.dll 运行时，并且该运行时不支持 C99。

因此，对于旧版本的 MinGW，在使用特定于 C99 的格式说明符时，您可能会在 C99 模式下遇到问题。同样从历史上看，GCC 没有为 msvcrt.dll 缺乏对 C99 说明符的支持做出任何特殊调整。因此，您会遇到`-Wformat`不会警告格式不起作用的情况。

双方的情况都在改善——当与 MS 运行时一起使用时，GCC 对 -Wformat 有特定的支持，例如：

*   `-Wpedantic-ms-format`这样 GCC 就不会抱怨`"I32"`并且`"I64"`（即使它已记录在案，我仍然会抱怨它即使在 4.7.0 中也无法识别 - 也许它是全新的）
*   `ms_printf`选项_`__attribute__((__format__))`

另一方面，MinGW 已经提供了自己`snprintf()`的一段时间，因为 MSVC 的变体`_snprintf()`, 行为完全不同。然而，MinGW 长期依赖`printf()`于 msvcrt.dll，因此 C99 格式说明符`printf()`不起作用。在某个时候，MinGW 开始提供它自己的版本`printf()`和朋友，以便您可以获得适当的 C99（和 GNU？）支持。然而，从保守的角度来看，这些最初并没有取代 msvcrt.dll 版本。他们有像`__mingw_printf()`.

看起来在 4.6.1 和 4.7.0 之间的某个时间点，MinGW 标头开始使用 MinGW 提供的版本作为 msvcrt.dll 函数的替代品（至少如果您指定了 C99）。

但是，对于较新的版本，GCC 和 MinGW 似乎仍然有点不同步。和以前一样，GCC 不会警告那些实际上不能在 MinGW 上工作的说明符，而不是抱怨那些会起作用的说明符。

您可能想尝试以下代码片段，以查看您的 MinGW 版本支持的程度`"hhX"`：

```
printf("%hhX\n", 0x11223344);
__mingw_printf("%hhX\n", 0x11223344); 
```

我不确定建议什么来解决您遇到的问题 - 我认为您可以修补 MinGW`stdio.h`标头，以便它`__attribute__((__format__ (gnu_printf, ...)))`在 printf 函数上具有属性（它们不在较新的函数中`stdio.h`，所以 GCC 将使用它默认的格式支持的想法）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-05T21:35:22.277

除了其他答案之外，这里还有一些关于 GCC 中 printf 格式检查的更多信息：

当您说`__attribute__((__format__ (FORMAT, ...)))`时， 的值`FORMAT`可以是（就 printf 而言）以下之一：`printf`, `gnu_printf`, `ms_printf`.

`ms_printf`使 GCC 假定该函数采用用于 Microsoft Visual Studio CRT printf 系列函数的格式字符串。这意味着 GCC 会抱怨`z`,`hh`和`ll`, 但会`I64`毫无警告地通过。

`gnu_printf`让 GCC 在下面假设 GNU libc printf 实现（或者可能只是一个 POSIX/C99 兼容的 printf 实现，我不确定）。因此 GCC 会抱怨`I64`和其他微软扩展，但会接受`z`,`hh`和`ll`.

`printf`是`ms_printf`编译 Windows 时的别名，`gnu_printf`否则是别名。

请注意，此检查与正在使用的实际 printf 实现完全正交。如果您编写自己的类似 printf 的函数并`__attribute__((__format__ (FORMAT, ...)))`使用它，这很容易看出 - GCC 会根据`FORMAT`.

我知道的可用 printf 实现：

*   MinGW.org 和 MinGW-w64 工具链中的MinGW ANSI STDIO（用 编译`-D__USE_MINGW_ANSI_STDIO=1`）。符合`ms_printf`（完全？）和`gnu_printf`格式（部分 - 不支持位置参数）。
*   MSVCRT（不带 编译`-D__USE_MINGW_ANSI_STDIO=1`）。符合`ms_printf`（duh ...），符合性`gnu_printf`非常低，并且取决于运行时版本（旧版本不支持`ll`，新版本支持；到目前为止，任何版本都不支持；GCC 很幸运地没有意识到这些发展，`z`并且`hh`假设最坏的情况，似乎是 VC 6.0 时代的 msvcrt）。
*   gnulib。符合`ms_printf`并`gnu_printf`完全（或接近完全）。

MinGW.org 中的`stdio.h`标头不使用`attribute format`.

`stdio.h`MinGW-w64 中的标头`attribute format gnu_printf`用于 MinGW ANSI STDIO 实现，但不用于 MSVCRT 实现。**已修复：**在较新版本的 MinGW-w64 标头中，`stdio.h`将`attribute format ms_printf`用于 MSVCRT 实现。

`printf`gnulib 完全了解and之间的区别`gnu_printf`，并且会根据一些复杂的宏来选择一个或另一个（大概伴随着一个支持格式所说的内容的正确实现）。

已知（目前）存在 GCC 格式检查问题的软件：

*   glib - 使用`printf`格式，但实现来自 gnulib；将其更改为有一个突出的错误`gnu_printf`
*   CPython - 代码`z`格式丰富，但官方二进制文件是针对 MSVCRT 构建的；它还`printf`在其扩展标头中使用格式，即使扩展也经常`z`使用

# scripting - 迭代lua表不起作用

> ID：10678126
> 
> 赞同：1
> 
> 时间：2012-05-20T23:39:43.957
> 
> 标签：scripting, lua, luagl

我有以下 lua 表：

> t = {name="sandy", age="22", major="computerScience"}

我想迭代它，下面的两种方法都不起作用

方法一

> function printAssociateTable(t) print("before the loop") for i,v in ipairs(t) do print(v) end end

方法二

> function printAssociateTable2(t) print("before the loop") for k in ipairs(t) do print("before the loop") print(k.. " is " ..tk) end end

当我调用任何一种方法时，它们都会打印“循环前”。所以问题是程序没有进入循环！

我试图手动访问表，如果我这样做：

> return t.name => 给桑迪
> 
> return t[name] => 给出**nil**
> 
> return t["name"] => 给了桑迪！

我怎样才能遍历我的表？请注意，这两种方法都适用于像这样的简单数组

> a={"a","b","c","d"}

但我希望它在我的关联数组上工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T23:50:44.877

*迭代器仅选择具有整数*键的`ipairs`数组元素。要遍历您需要的所有键，如下所示：*`pairs`*

 *```
function printAssociateTable(t)
  print("before the loop")
  for i,v in pairs(t) do
    print(v)
  end
end 
```*

# c - 是否有一种简单的方法可以在 ANSI C 中编写适合 11 英寸 MacBook Air 屏幕的策略（或其他）设计模式？

> ID：10678127
> 
> 赞同：1
> 
> 时间：2012-05-20T23:39:48.390
> 
> 标签：c, oop, design-patterns

似乎 ANSI C 中的 OO 不是当今流行的 OO 方法。有谁知道使用严格的 ANSI C 编写简单设计模式的方法，以便我可以向朋友证明这是可能的？（Axel-Tobias Schreiners 的书让我继续这样做！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T07:19:17.543

[使用 C 的 OO 确实可以使用函数指针来实现，正如这个 SO question](https://stackoverflow.com/q/840501/1158895)中很好解释的那样。

使用该帖子中的信息，这是我将如何使用基本继承在 C 中实现策略模式的方法。

让我们使用以下 C++ 作为指南：

```
class StrategyBase
{
    ...
    StrategyBase();
    virtual void strategyMethod() = 0;
    ...
};

class StrategyDerived
{
    ...
    StrategyDerived();
    void strategyMethod();
    ...
}; 
```

这是相应的C代码：

```
typedef struct StrategyBase_t StrategyBase;
struct StrategyBase_t
{
    StrategyBase *base; /* must be first memeber */
    void (*strategyMethod)(const void *self);
};
StrategyBase *newStrategyBase();
void strategyMethod(const void *self);  /* the abstract method */

struct StrategyDerived
{
    StrategyBase *base; /* must be first memeber */
    void (*strategyMethod)(const void *self);
    /* more derived attributes here */
};
typedef struct StrategyDerived_t StrategyDerived;
StrategyDerived *newStrategyDerived(); 
```

以下是功能实现：

```
void strategyMethod(const void *self)
{
    /* If called with just a StrategyBase, strategyMethod will be NULL, *
     * so perhaps some sort of protection should be added here first    */
    ((StrategyBase*) self)->base->strategyMethod();
}

void strategyMethodDerived(const void *self)
{
    /* Put your implementation here */
}

/* StrategyBase constructor */
StrategyBase *newStrategyBase()
{
    StrategyBase *self = (StrategyBase*) malloc(sizeof(StrategyBase));
    self->base = self; /* See comment below about virtual table */
    self->strategyMethod = NULL; /* StrategyBase is abstract, right? */
    return self;
}

/* StrategyDerived constructor */
StrategyDerived *newStrategyDerived()
{
    StrategyDerived *self = (StrategyDerived*) malloc(sizeof(StrategyDerived));
    self->base = newStrategyBase();
    self->strategyMethod = self->base->strategyMethod = strategyMethodDerived;
    return self;
} 
```

虚拟表实现是**非常**基本的，但应该可以工作。理想情况下，应该实现一些更强大的东西。

然后你只需要在需要策略的 Struct 中使用指向 StrategyBase 的指针，并且你有一个用 C 实现的策略模式。我没有尝试编译它，但这应该是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:44:05.080

没什么。而不是 class `Foo`，使用 a `struct foo`; 而不是构造函数`Foo::Foo(...)`，有一个函数`struct foo *foo_new(...)`。

有关真实示例，请参阅古老的[GObject 库](http://en.wikipedia.org/wiki/GObject)。

# jquery - 一个事件 YUI ，每两秒

> ID：10678128
> 
> 赞同：0
> 
> 时间：2012-05-20T23:40:03.743
> 
> 标签：jquery, yui

我想用 YUI 创建一个事件，每两秒刷新一次页面。

```
var companymain = {
init: function() {
  companymain.form = document.getElementById('companymain');
  //I need a event or something and repet this function.
  YAHOO.util.Event.addListener(companymain.form, 'EVENTNEED', companymain.submit_func);},

  submit_func: function(e) { //stuff refresh page} 
```

想法？问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:29:46.843

您似乎想要做的并不是真正的事件之类的事情。下面显示了您需要实现的总体思路：

```
function repeatedRefresh(delay) {
   // Ajax code goes here

   setTimeout(repeatedRefresh, 2000);
}    
setTimeout(repeatedRefresh, 2000); 
```

这声明了一个`repeatedRefresh()`函数并在 2000 毫秒后调用它。该函数本身将执行 Ajax 调用以更新页面，然后`setTimeout()`在 2000 毫秒后将另一个调用排队。我建议将`setTimeout()`Ajax 完成/成功回调放在内部，以便后续调用在前一个完成后 2000 毫秒发生。

我已经把实际的 Ajax 代码放在上面了，因为我不熟悉 YUI（除了非常一般的方式），但是由于你已经用 jQuery 标记了你的问题，这是用 jQuery 完成的一种方法：

```
function repeatedRefresh(delay) {
   $.ajax({
      url : "yourURLhere",
      data : "optionalDataHere",
      // other ajax params here as needed,
      success : function(result) {
         // do something with result (display it on your page somehow),
         // then queue up the next refresh
         setTimeout(repeatedRefresh, 2000);
      }
   });       
}    
setTimeout(repeatedRefresh, 2000); 
```

或者，如果您的服务器端代码返回 HTML，您可以通过使用该[`.load()`方法](http://api.jquery.com/load/)将返回的 HTML 自动加载到特定元素（例如 div）中来简化事情：

```
function repeatedRefresh() {
   $('#elementToUpdate').load('yourURLhere', function() {
      setTimeout(repeatedRefresh, 2000);
   });
}
setTimeout(repeatedRefresh, 2000); 
```

最后，尝试使用您现有的`companymain`结构：

```
var companymain = {
   init: function() {
      setTimeout(companymain.submit_func, 2000);
   },
   submit_func : function() {
      // YUI or jQuery (or other) Ajax code here

      setTimeout(companymain.submit_func, 2000);
   }
};    
companymain.init(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T13:00:19.343

当然 setTimeout 没什么问题，但是 YUI 2 有 YAHOO.lang.later (http://developer.yahoo.com/yui/docs/YAHOO.lang.html#method_later) 而 YUI 3 有 YUI.later (http:// yuilibrary.com/yui/docs/api/classes/YUI.html#method_later）两者都可以选择定期调用函数而不是一次（因此无需在代码中定义两次硬编码延迟；））

# r - 来自文件的数据组合并在 r 软件中绘图

> ID：10678139
> 
> 赞同：-2
> 
> 时间：2012-05-20T23:42:22.307
> 
> 标签：r, combinations

我有 102 个文本文件，每个文件都包含相同类型的数据。假设数据存储在文件 f1 的变量 d1 中。

在 R 中：我想在两个文件中的数据之间进行绘图。说 d1 vs d2 或 d45 vs d85

我需要为所有组合（ 102C2 组合）做这些

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:09:17.497

这有点像外面的要求，因为你无法理解这么多的情节。例如：

```
ncol(combn(1:102,2)) 
```

为 102 组数据之间的唯一组合提供总共***5151***个图。如果你的教授想手动搜索所有这些图，他最好给自己倒一大杯咖啡。我会认真重新考虑您试图从这些数据中找出什么，并可能重新定义您的调查范围。

话虽如此，考虑到具体情况，这里有一些潜在的代码可能是好的建议，也可能不是好的建议。事实上，我什至建议不要对所有文件运行以下代码，以免计算机爆炸。

```
# This is how you would read text files into a list,
# courtesy of this question (http://stackoverflow.com/q/9110110/496803):
# raw <- list.files(pattern="*.txt")
# listy <- lapply(raw, read.table)

# set up some mock data instead
listy <- list(1:3,4:6,7:9)

# get every possible combination
combos <- combn(1:length(listy),2)

# define a function to plot each combination of data  
multiplot <- function(x) {
    dev.new()
    plot(listy[[(x[1])]],listy[[x[2]]])
}

# Generate the plots separately.
# This will probably kill your R session with
# the number of plots you are generating.

apply(combos,2,multiplot) 
```

# ios5 - TableView 不可选

> ID：10678142
> 
> 赞同：0
> 
> 时间：2012-05-20T23:42:51.223
> 
> 标签：ios5, uitableview

单击单元格时，我的 TableView 没有将单元格着色为蓝色。InterfaceBuild 有

```
Selection: Single Selection
Show Selection on Touch : YES 
```

当我点击表格时，我的表格视图控制器中的代码就会运行

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // code
} 
```

## 编辑

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *cellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
    }
    NSString *item = (NSString *)[songList objectAtIndex:indexPath.row];
    cell.textLabel.text = item;
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:25:28.660

意识到我的问题是我的 cellForRowIndexPath 函数中的以下行

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

# ruby-on-rails - Webrick 死于非法指令 4

> ID：10678147
> 
> 赞同：3
> 
> 时间：2012-05-20T23:44:16.173
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, webrick

自从切换到基于 Mac 的 RoR 开发后，我偶尔会看到 Webrick 在简单地打印“非法指令 4”后就死了。

OSX 10.7.2、10.7.3 和现在的 10.7.4

红宝石 1.9.2p290

rails 3.2.2，以及从 3.1 开始的各种其他版本

到目前为止，它还算无伤大雅，我只是按了向上箭头键，按回车键，然后重新启动服务器，一切都很好。

我注意到在向开发环境添加新文件后立即几乎总是会导致这种情况。但是当我最近没有添加新文件时发生了这种情况。但它几乎总是在某些文件更改后立即发生。换句话说，当我只是测试东西时，我认为它从未发生过，似乎需要某种文件系统更改来触发它。

刚才，它发生了，但这一次似乎以某种方式卡住了Webrick，重新启动Webrick后，它没有响应，我不得不重新启动以清除条件。所以这开始看起来不那么无害了，更像是一个迫在眉睫的开发生产力问题。

其他 Mac 开发人员看到这个了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T04:34:25.803

在我的一个模型上实现范围后，我遇到了这个问题

```
scope :list_only, lambda { show_on_list } 
```

（`show_on_list`实例方法在哪里）。将方法改写为

```
scope :list_only, where("SomeSQLHere") 
```

（我在其中使用 SQL `SomeSQLHere`）它工作得很好。我意识到这并没有解决“非法指令 4”的含义，但问题可能源于一些糟糕的范围？

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-05-21T00:11:28.533

您在使用非 webrick 应用服务器时是否有类似的问题？我鼓励使用与您部署相同的应用服务器进行开发，在这种情况下，它看起来是Passenger。

# c++ - Mac OS Lion 上使用 pkg-config 包含目录的反斜杠

> ID：10678148
> 
> 赞同：0
> 
> 时间：2012-05-20T23:44:29.870
> 
> 标签：c++, macos, compilation, openssl, pkg-config

晚上好大家，

我几乎没有使用 pkg-config 的经验，但似乎我必须在使用 openssl 时使用它。我在 Mac 上，这可能很重要。

问题是：

*   我编译我的测试程序

    ```
    cc test.cc `pkg-config --libs --cflags openssl` -o test 
    ```

*   我已经编译了 openssl 并将其安装在 ~/openssl 中，然后将 ~/openssl/lib/pkgconfig 添加到 PKG_CONFIG_PATH
*   因为我想使用最新版本而不是预装的版本，所以我在每次编译时都指定了选项
*   运行的结果`pkg-config --libs`or`pkg-config --cflags openssl`是`-L\~/openssl/lib -lssl -lcrypto`

这向我提出了一个问题，为什么会有一个反斜杠以及我的编译版本是使用还是预装的，如果是第一个，我怎么可能解决这个问题......

任何形式的帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:06:22.467

`~`仅在某些情况下才会扩展到您的主目录。基本上，是外壳在做这件事。如果程序或文件 API 看到波浪号，则将其解释为文字；它没有扩展。

`$HOME`改为在设置时使用`PKG_CONFIG_PATH`，如`$HOME/openssl`.

# linq - 我可以按索引引用 LINQ 结果集中的项目吗？

> ID：10678154
> 
> 赞同：0
> 
> 时间：2012-05-20T23:45:32.317
> 
> 标签：linq, html-agility-pack

我正在尝试使用通过 html 敏捷包检索到的 4 个表的 LINQ 结果集。我想通过为每个变量设置一个变量（下面的 switch 语句），然后处理表中的行来稍微不同地处理每个变量。理想情况下，该变量将是集合中每个表的索引`0`to `3`，并将在 switch 语句中使用并选择行。我无法找到 index 属性，但我看到它在诸如`SelectChildNode`.

我的问题是我可以按索引引用 LINQ 结果集中的项目吗？我的“理想场景”是最后一条被注释掉的行。提前致谢。

```
var ratingsChgs = from table in htmlDoc.DocumentNode
                  .SelectNodes("//table[@class='calendar-table']")
                  .Cast<HtmlNode>()
                  select table;    
String rtgChgType;

for (int ratingsChgTbl = 0; ratingsChgTbl < 4; ratingsChgTbl++)
{
    switch (ratingsChgTbl)
    {
        case 0:
            rtgChgType = "Upgrades";
            break;
        case 1:
            rtgChgType = "Downgrades";
            break;
        case 2:
            rtgChgType = "Coverage Initiated";
            break;
        case 3:
            rtgChgType = "Coverage Reit/ Price Tgt Changed";
            break;

    //This is what I'd like to do.
    var tblRowsByChgType = from row in ratingsChgs[ratingsChgTbl]
                           .SelectNodes("tr")
                           select row;
    //Processing of returned rows.
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:48:38.360

[ElementAt 可以满足](http://msdn.microsoft.com/en-us/library/bb299233.aspx "IEnumerable.ElementAt")您的要求。不过，我不建议在您的示例中使用它，因为[每次调用它时，都会执行初始 LINQ 查询](http://blogs.msdn.com/b/charlie/archive/2007/12/09/deferred-execution.aspx)。简单的解决方法是让 ratingChgs 成为列表或数组。

您还可以重构 switch 语句。当您只需要遍历项目列表时，这是矫枉过正的。这是一个可能的解决方案：

```
var ratingsChgs = from table in htmlDoc.DocumentNode
                  .SelectNodes("//table[@class='calendar-table']")
                  .Cast<HtmlNode>()
                  select table;
var rtgChgTypeNames = new List
                      {
                          "Upgrades",
                          "Downgrades",
                          "Coverage Initiated",
                          "Coverage Reit/ Price Tgt Changed"
                      };
var changeTypes = ratingsChgs.Zip(rtgChgTypeNames, (changeType, name) => new 
                                  { 
                                      Name = name,
                                      Rows = changeType.SelectNodes("tr")
                                  });
foreach( var changeType in changeTypes)
{
    var name = changeType.Name;
    var rows = changeType.Rows;
    //Processing of returned rows.
} 
```

另外，为什么不将您的评分更改类型存储在 HTML 文档中？在业务逻辑中定义表信息似乎很奇怪。

# node.js - Node.js + mongoose [RangeError: 超出最大调用堆栈大小]

> ID：10678156
> 
> 赞同：19
> 
> 时间：2012-05-20T23:45:45.627
> 
> 标签：node.js, mongodb, mongoose, express

我是 Node.js 的新手，我遇到了一个错误：

> RangeError：超出最大调用堆栈大小

我无法解决这个问题，因为其他有关 Node.js 的 stackoverflow 问题中的大多数堆栈问题都涉及数百个回调，但我这里只有 3 个。

首先是 fetch ( `findById`)，然后是更新，然后是保存操作！

我的代码是：

```
app.post('/poker/tables/:id/join', function(req, res) {
    var id = req.params.id;

    models.Table.findById(id, function(err, table) {
        if (err) {
            console.log(err);
            res.send({
                message: 'error'
            });
            return;
        }

        if (table.players.length >= table.maxPlayers) {
            res.send({
                message: "error: Can't join ! the Table is full"
            });
            return;
        }
        console.log('Table isnt Full');

        var BuyIn = table.minBuyIn;
        if (req.user.money < table.maxPlayers) {
            res.send({
                message: "error: Can't join ! Tou have not enough money"
            });
            return;
        }
        console.log('User has enought money');

        models.User.update({
            _id: req.user._id
        }, {
            $inc: {
                money: -BuyIn
            }
        }, function(err, numAffected) {
            if (err) {
                console.log(err);
                res.send({
                    message: 'error: Cant update your account'
                });
                return;
            }
            console.log('User money updated');

            table.players.push({
                userId: req.user._id,
                username: req.user.username,
                chips: BuyIn,
                cards: {}
            });

            table.save(function(err) {
                if (err) {
                    console.log(err);
                    res.send({
                        message: 'error'
                    });
                    return;
                }

                console.log('Table Successfully saved with new player!');
                res.send({
                    message: 'success',
                    table: table
                });

            });
        });

    });
}); 
```

错误发生在最后保存操作的过程中！

我将 MongoDb 与 mongoose 一起使用，`Table`并且`User`是我的数据库集合。

这是我第一个使用 Node.js、Express.js 和 MongoDB 的项目，所以我可能在异步代码中犯了很大的错误 :(

**编辑**：我试图用更新替换保存：

```
models.Table.update({
    _id: table._id
}, {
    '$push': {
        players: {
            userId: req.user._id,
            username: req.user.username,
            chips: BuyIn,
            cards: {}
        }
    }
}, function(err, numAffected) {

    if (err) {
        console.log(err);
        res.send({
            message: 'error'
        });
        return;
    }

    console.log('Table Successfully saved with new player!');
    res.send({
        message: 'success',
        table: table
    });

}); 
```

但这无济于事，错误仍然存​​在，我不知道如何调试它：/

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-22T02:05:01.583

I've been passing for this problem too. Basically, when you have a property with a `ref`, and you want to use it in a find, for example, you **can't** pass the whole document.

For example:

```
Model.find().where( "property", OtherModelInstance ); 
```

this will trigger that error.

However, you have 2 ways to fix this for now:

```
Model.find().where( "property", OtherModelInstance._id );
// or
Model.find().where( "property", OtherModelInstance.toObject() ); 
```

This may stop your problems for now.

There is a issue in their GitHub repo where I reported this, however it's without fix for now. [See the issue here](https://github.com/LearnBoost/mongoose/issues/1024#issuecomment-11722415).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-30T02:07:53.310

我一直收到这个错误，终于弄明白了。由于错误中没有提供真实信息，因此很难调试。

原来我试图将一个对象保存到一个字段中。只保存对象的特定属性，或者将它的 JSON 字符串化，就像一个魅力。

如果驱动程序给出更具体的错误似乎会很好，但是哦，好吧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-10-08T16:12:29.820

`MyModel.collection.insert`原因：

> [RangeError: 超出最大调用堆栈大小]

当您传递实例数组`MyModel`而不是仅传递具有该对象值的数组时。

范围错误：

```
let myArray = [];

myArray.push( new MyModel({ prop1: true, prop2: false }) );

MyModel.collection.insert(myArray, callback); 
```

没有错误：

```
let myArray = [];

myArray.push( { prop1: true, prop2: false } );

MyModel.collection.insert(myArray, callback); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-30T01:35:40.603

有几种方法可以调试 nodejs 应用程序

## 内置调试器

Node.js 调试器记录在这里：[http ://nodejs.org/api/debugger.html](http://nodejs.org/api/debugger.html)

要放置断点，只需放置`debugger;`在要中断的位置即可。正如您所说的`table.save`回调给您带来麻烦，您可以在该函数中放置一个断点。

然后在启用调试器的情况下运行节点：

```
node debug myscript.js 
```

你会得到更多有用的输出。

## 调查堆栈

`console.trace`如果您对遇到问题的时间/地点有一个很好的了解，并且想弄清楚您是如何到达那里的，您还可以使用它来打印堆栈跟踪。

祝你好运，我希望这会有所帮助！

# list - 在 Prolog 中合并两个列表中的备用元素

> ID：10678158
> 
> 赞同：-4
> 
> 时间：2012-05-20T23:46:08.827
> 
> 标签：list, prolog

`mergealt(X,Y,Z)`如果列表 Z 是列表 X 和 Y 中替代元素的合并，我需要编写一个成功的 Prolog 谓词。

输入和输出如下所示：

```
?- mergealt([1,2,3,4],[6,7,8],Z).
Z = [1, 7, 3] .
?- mergealt([1,2,3,4],[6,7,8,9],Z).
Z = [1, 7, 3, 9] .
?- mergealt([1,2,3,4],[6,7,8,9,10],Z).
Z = [1, 7, 3, 9] . 
```

我真的不明白递归。我怎样才能开始解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T08:54:50.050

Prolog 可以被认为是声明性语言的“旗手”。所以试着描述你的问题，自上而下：

```
mergealt(X, Y, Z) :-
  'take first element from X and put it in Z',
  'discard first element from Y',
  'mergealt rest-of-X and rest-of-Y, but exchange them'. 
```

如果 X 中没有元素，则无法完成第一步。这一事实突出了递归终止的情况。最初，Prolog 没有使用`if then else`，而是将替代品声明为不同的规则：

```
mergealt([], _Y, []). 
```

在这里您可以看到，`pattern matching`在第一个参数中，它是区分备选方案的关键，并且在上下文中，Z 被*绑定*到一个空列表。Y 是未使用的，所以它被标记为*匿名*占位符，只是为了避免警告。

那么这个更简单的案例表明我们应该使用模式匹配来完成那些冗长的描述。看看您是否可以按照以下准则完成该过程：

```
mergealt([X|Xs], Y, [X|Zs]) :-
  % take first element from X and put it in Z : done in the head
  % discard first element from Y : see below
  % mergealt rest-of-X and rest-of-Y, but exchange them'. : make your recursive call

discard_first_element([_|Rest], Rest).
% why is this necessary? do you see where it fails if we don't specify this case?
discard_first_element([], []). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T00:02:23.827

*   请注意，结果总是从第一个列表的第一个元素开始。
*   这意味着，如果第一个列表为空，您马上就知道答案。
*   还要注意，如果它不为空，我们已经知道结果的第一项，所以我们需要使用 mergealt 来计算其余的。但是“其余”将第二个列表的第二项作为结果的第一项，正如我们上面所说，这意味着调用 mergealt 来计算它必须是第一项列表（是的，这是棘手的部分）。

# google-app-engine - 通过基于谷歌应用引擎的未付费实例调用 Open Graph Action POST 失败

> ID：10678163
> 
> 赞同：1
> 
> 时间：2012-05-20T23:46:49.663
> 
> 标签：google-app-engine, python-2.7, urllib2, facebook-opengraph

urlopen 在发布 Open Graph 操作时失败，并显示来自 Facebook 的 500 代码和 '{"error_code":1,"error_msg":"An unknown error occurred"}' 错误。我可以让代码与其他帖子一起使用（例如，使用图形 API 对状态发表评论效果很好）。我也可以使用 curl 让这个动作帖子工作。因此，在发布带有 URL 作为值之一的表单数据时，这似乎是一个 urllib2.urlopen 问题。

与 curl 一起使用的图形 api 帖子：

 `````
curl -F 'access_token=nnnnnn' -F 'object=https://abc.com/123' \
'https://graph.facebook.com/me/namespace:action' -k 
```` 

 `通过 urllib2 发布相同的 Graph api，它给出了错误：`

 ``````
from urllib2 import urlopen, Request, URLError

request = Request (url='http://graph.facebook.com/me/namespace:action';, 
                   data = urllib.urlencode(
                            {'object':'https://abc.com/123',
                             'access_token':'nnnnnnnn'
                            }, 
                   headers = {'Content-Type': 'application/x-www-form-urlencoded'}
          ) 
response = urlopen (request) 
````  `我可能做错了什么？（我是 urllib2.urlopen 的新手。顺便说一句，我最初通过 urlfetch python 模块尝试了 urlfetch.fetch。那也不起作用）。我正在使用这个通过 goole 应用程序引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T18:51:33.007

经过大量的挖掘/试错后，终于设法解决了这个问题。

这不是 urllib urlopen 的问题，而是更多的是 Google App Engine 的细微差别，当调用打开的 Graph URL 上的操作帖子时 - 它会导致 Facebook 触发对象 URL 上的“获取”（同步）。

所以本质上是在应用引擎应用程序上调用 get，而活动实例已经在调用 FB 图 URL。我目前正在使用一个**未付费的实例**，这会导致意外行为，例如 FB 无法通过 OG 帖子（我看到日志中的获取成功通过，而活动帖子，所以不确定是什么导致 FB 失败 - 任何有一个见解，请分享）。

我通过 'taskqueue'ing urlopen/OG-action-post 解决了这个问题 - 当第二次调用它时（FB 显然第一次缓存了对象）它成功了。

如果有人需要更多详细信息，请联系我们，非常乐意为您节省我已经经历的所有时间和痛苦。````

# javascript - JavaScript SetInterval() 点击后不起作用

> ID：10678164
> 
> 赞同：0
> 
> 时间：2012-05-20T23:46:51.193
> 
> 标签：javascript, setinterval

嗨，我已经编写了这段代码，它假设在单击对象后每 3000 毫秒移动一次对象，但是有些时间它不起作用，谁能告诉我我做错了什么，我只是在学习 javascript；非常感谢你

```
function move1() {
    var im1 = document.images[0];
    im1.onclick = function() {
        im1.style.left = parseInt(im1.style.left) + 1 + "px";
    }
}

function move2() {
    var im2 = document.images[1];
    im2.onclick = function() {
        im2.style.left = parseInt(im2.style.left) + 10 + "px";
    }
}

window.onload = function() {
    setInterval(move1, 100);
    setInterval(move2, 3000);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:03:38.117

你反其道而行之。每 3000 毫秒，您可以在单击图像时将图像移动 1 像素。

```
function move(el, ms, px) {
/* moves the el every ms by px
returns the interval id to clear the movement */
    return setInterval(function() {
        el.style.left = parseInt(el.style.left) + px + "px";
    }, ms);
}
window.onload = function() {
    var im0 = document.images[0];
    var im1 = document.images[1];
    im0.onclick = function() {
        move(im0, 100, 1);
    };
    im1.onclick = function() {
        move(im1, 3000, 10);
    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:56:36.853

您的移动功能会在点击时注册图像，但在用户点击之前实际上不会进行任何移动。你想要的更像是这样的：

```
function move1() {
    var im1 = document.images[0];
    im1.style.left = parseInt(im1.style.left) + 1 + "px";
}

function move2() {
    var im2 = document.images[1];
    im2.style.left = parseInt(im2.style.left) + 10 + "px";
}

window.onload = function() {
    var im2 = document.images[1];
    im2.onclick = function() {
        setInterval(move2, 3000);
    }

    im1.onclick = function() {
        setInterval(move1, 100);
    }
} 
```

# c++ - 我的 park_car 功能有什么问题？

> ID：10678165
> 
> 赞同：1
> 
> 时间：2012-05-20T23:46:52.027
> 
> 标签：c++, multidimensional-array, heap-memory

我再次为学校做任务，我正在慢慢实现它，我不知道为什么我的`park_car`功能不起作用，我只是想做一个测试并且程序崩溃了......这是我的代码。

PS：我无法更改，`***p2parkboxes`因为它像大多数其他变量一样在启动文件中给出。我只想将第 0 层的第一个元素视为：HH-AB 1234。非常感谢您的帮助。PS2：我不能使用 std::string 以及它不允许用于该任务。

```
#include <iostream>
#include <cstring>
using namespace std;

#define EMPTY "----------"
class Parkbox{
    char *license_plate; // car's license plate
    public:
    Parkbox(char *s = EMPTY); // CTOR
    ~Parkbox(); // DTOR
    char *get_plate(){return license_plate;}
};
class ParkingGarage{
    Parkbox ***p2parkboxes;
    //int dimensions_of_parkhouse[3]; // better with rows,columns,floors
    int rows,columns,floors; // dimensions of park house
    int total_num_of_cars_currently_parked;
    int next_free_parking_position[3];
    // PRIVATE MEMBER FUNCTION
    void find_next_free_parking_position();
    public:
    ParkingGarage(int row, int col, int flr);// CTOR,[rows][columns][floors]
    ~ParkingGarage(); // DTOR
    bool park_car(char*); // park car with license plate
    bool fetch_car(char*); // fetch car with license plate
    void show(); // show content of garage floor
    // by floor
};

Parkbox::Parkbox(char *s ) { // CTOR
    license_plate = new char[strlen(s)+1];
    strcpy(license_plate, s);
    //cout << "ParkBox CTOR" << endl;
}
Parkbox::~Parkbox() { // DTOR
    delete [] license_plate;
    //cout << "ParkBox DTOR" << endl;
}

ParkingGarage::ParkingGarage(int row, int col, int flr){
    rows = row; columns = col; floors = flr;
    p2parkboxes = new Parkbox**[row];
    for (int i = 0; i < row; ++i) {
        p2parkboxes[i] = new Parkbox*[col];

        for (int j = 0; j < col; ++j)
            p2parkboxes[i][j] = new Parkbox[flr];
    }

}

ParkingGarage::~ParkingGarage(){

    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < columns; ++j)
            delete [] p2parkboxes[i][j];

        delete [] p2parkboxes[i];
    }
    delete [] p2parkboxes;
}

void ParkingGarage::show(){
    int i,j,k;
    for (i = 0 ; i < floors; i++){
        cout << "Floor" << i << endl;
        for (j=0;j<rows;j++){
            for (k=0;k<columns;k++){
                cout << p2parkboxes[j][k][i].get_plate() << "  ";
            }
            cout << endl;
        }
    }
}

bool ParkingGarage::park_car(char*s){

    p2parkboxes[0][0][0] = Parkbox(s); //test
    //p2parkboxes[0][0][0] = s; //test

    return true;
}

int main(void) {
    // a parking garage with 2 rows, 3 columns and 4 floors
    ParkingGarage pg1(2, 3, 4);
    pg1.park_car("HH-AB 1234");
    /*pg1.park_car("HH-CD 5678");
      pg1.park_car("HH-EF 1010");
      pg1.park_car("HH-GH 1235");
      pg1.park_car("HH-IJ 5676");
      pg1.park_car("HH-LM 1017");
      pg1.park_car("HH-MN 1111"); */
    pg1.show();
    /*pg1.fetch_car("HH-CD 5678");
      pg1.show();
      pg1.fetch_car("HH-IJ 5676");
      pg1.show();
      pg1.park_car("HH-SK 1087");
      pg1.show();
      pg1.park_car("SE-AB 1000");
      pg1.show();
      pg1.park_car("PI-XY 9999");
      pg1.show(); */
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T23:53:31.523

您没有为 Parkbox 类声明复制构造函数。所以，线

```
p2parboxes[0][0][0] = Parkbox(s) 
```

在堆栈上创建一些东西（带有 char* 指针的 Parkbox 实例）（并几乎立即将其删除）。要纠正这个问题，您可以定义

```
Parkbox& operator = Parkbox(const Parkbox& other)
{
    license_plate = new char[strlen(other.get_plate())+1];
    strcpy(license_plate, other.get_plate());
    return *this;
} 
```

让我们看看工作流程

```
p2parboxes[0][0][0] = Parkbox(s) 
```

线。

1.  首先，调用构造函数并在堆栈上创建一个 Parkbox 的实例（我们称之为 tmp_Parkbox）。
2.  在此构造函数中分配了 license_plate ，假设它指向 0xDEADBEEF 位置。
3.  复制发生（这很明显，因为*这*是用代码编写的东西）并且 p2parboxes[0][0][0] 现在包含 tmp_Parkbox 的精确副本。
4.  tmp_Parkbox 的作用域现在结束并调用 tmp_Parkbox 的析构函数，其中 tmp_Parkbox.license_plate (0xDEADBEEF ptr) 被释放。
5.  p2parboxes[0][0][0] 仍然包含 Parkbox 的“有效”实例，并且 p2parboxes[0][0][0].license_plate 仍然是 0xDEADBEEF ，如果在您调用之前发生任何分配，则会导致未定义的行为这

    cout << p2parboxes[0][0][0].license_plate;

底线：行本身没有问题，问题隐藏在'='运算符的实现细节中。

在这一点上，你最好将 std::string 用于字符串，而不是使用带有隐式 C++ 复制/构造语义的锋利、棘手和显式的 C 风格直接内存管理。如果您将 std::vector 用于动态数组，代码也会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T00:21:44.707

这里的问题是您没有深拷贝分配语义。当您将临时 Parkbox 分配给停车场中的 Parkbox 时，编译器生成的赋值运算符会制作指针 license_plate 的浅表副本，使两个 Parkbox 都指向相同的内存位置。然后临时 Parkbox 超出范围并删除 license_plate。由于另一个 Parkbox 指向同一个位置，它的 license_plate 也被删除。

有几个解决方案。解决该问题的一种方法是定义提供适当语义的赋值运算符和复制构造函数，即执行车牌字符串的深拷贝。更好的选择，也是更好地利用 C++ 的选择，是使用 std::strings 而不是手动分配的 C-strings。我强烈建议第二种方法，尽管通过第一种方法可能具有指导意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T12:49:17.693

从OP：

我解决了这个问题：

```
void Parkbox::change_plate(char *s){
delete [] license_plate;
license_plate = new char[strlen(s)+1];
strcpy(license_plate, s);
} 
```

# jquery - 如何将错误定向到组的第一个字段

> ID：10678169
> 
> 赞同：0
> 
> 时间：2012-05-20T23:47:56.843
> 
> 标签：jquery, validation, jquery-validation-engine

我正在使用 jQuery Validation Engine（特别感谢他们的开发人员）。好的，问题如下：我需要设置一组必填字段，前提是至少填写其中一个。

我在`_validateField`函数中添加了以下代码：

```
case "ifOneAllGroupRequired":  
// Check is its the first of group, if not, reload validation with first field
// AND continue normal validation on present field
var classGroup = "["+options.validateAttribute+"*=" +rules[i + 1] +"]";

errorMsg = methods._ifOneAllGroupRequired(field, rules, i, options);
if(errorMsg) { required = true; }
options.showArrow = false;
break; 
```

并制作了下一个功能：

```
_ifOneAllGroupRequired: function(field, rules, i, options) {
var classGroup = "["+options.validateAttribute+"*=" +rules[i + 1] +"]";
var isValid = 0 , getTotal = 0;

// Check all fields from the group
field.closest("form").find(classGroup).each(function(){
    getTotal++;     // count all the fields
    if(! methods._required($(this), rules, i, options) ){
        isValid++;  // count the fields filled
    }
});

// if at least 1 is filled and the other arent launch error
if( isValid != getTotal && isValid != 0 ) return options.allrules[rules[i]].alertText;
// if they are, clean all errors
else field.closest("form").find(classGroup).validationEngine('hide');
}, 
```

我得到了这个工作，问题是错误出现在每个字段之上，而不是像“groupRequired”选项（默认在validationEngine上）

我没有头绪，只好转身。有任何想法吗？

# php - 将json中的每个“li”设为自己的链接？

> ID：10678170
> 
> 赞同：1
> 
> 时间：2012-05-20T23:47:59.913
> 
> 标签：php, javascript, jquery

有谁知道如何使出现在以下“li”中的文本既是链接又可以通过 CSS 自定义？我无法删除文本装饰、更改字体样式、颜色等。我尝试更改“树”ID 的样式，但只能更改字体大小。

虽然两者都很重要，但链接至关重要。返回的每个“li”都需要是它自己的动态生成的链接。我现在已经尝试了大约 10 种不同的方法，但我似乎无法让它发挥作用。

```
 <script>

function to_ul(id) {

    var ul = document.createElement("ul");

  for (var i=0, n=id.length; i<n; i++) {

      var branch = id[i];

      var li = document.createElement("li");

        var text = document.createTextNode(branch.trackName);

        li.appendChild(text);

        ul.appendChild(li);

    }

    return ul;

}

function renderTree() {

  var treeEl = document.getElementById("tree");
        var treeObj = {"root":[{"id":"1","trackName":"Whippin Post"},{"id":"2","trackName":"Sweet Caroline"},{"id":"3","trackName":"Tears in Heaven"},{"id":"4","trackName":"Ain't She Sweet"},{"id":"5","trackName":"Octopus' Garden"},{"id":"6","trackName":"Teen Spirit"},{"id":"7","trackName":"Knockin on Heaven's Door"}]};

    treeEl.appendChild(to_ul(treeObj.root));

}

</script>

</head>

<body onload="renderTree()">

<div id="tree"></div>

</body>

</html> 
```

*更新*

```
<script>
function to_ul(id) {
    var ul = document.createElement("ul");

  for (var i=0, n=id.length; i<n; i++) {

    var branch = id[i];

    var li = document.createElement("li");
    li.innerHTML = "<a href=" + "'#'" + "class='listAnchor'" + "onclick='changeText()'" + ">" + branch.trackName + "</a>"
    ul.appendChild(li);

    function changeText(){
    document.getElementById('player-digital-title').innerHTML = branch.trackFile;
    }
    }

    return ul;  
}

function renderTree() {
  var treeEl = document.getElementById("player-handwriting-title");

        var treeObj = {"root":[{"id":"1","trackName":"Whippin Post","trackFile":"test1.wma"},{"id":"2","trackName":"Sweet Caroline","trackFile":"test2.wma"},{"id":"3","trackName":"Tears in Heaven","trackFile":"test3.wma"},{"id":"4","trackName":"Ain't She Sweet","trackFile":"test4.wma"},{"id":"5","trackName":"Octopus' Garden","trackFile":"test5.wma"},{"id":"6","trackName":"Teen Spirit","trackFile":"test6.wma"},{"id":"7","trackName":"Knockin on Heaven's Door","trackFile":"test7.wma"}]};

    treeEl.appendChild(to_ul(treeObj.root));

    treeEl.appendChild(to_ul(treeObj.root));
}
</script>
</head>
<body>
<a href="#" class="genre" onclick="renderTree()">Click here</a>
<br/>
<br/>
<a href="#" id="player-handwriting-title"></a>
<br/>
<br/>
<div id="player-digital-title"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:55:47.230

首先在js中创建链接：

```
function to_ul(id) {

  var ul = document.createElement("ul");

  for (var i=0, n=id.length; i<n; i++) {

    var branch = id[i];
    var li = document.createElement("li");
    li.innerHTML = "<a href='wherever' class='listAnchor'>" + branch.trackName + "</a>"
    ul.appendChild(li);

  }
  return ul;
} 
```

然后在css中设置样式：

```
<style>
  .listAnchor {
    text-decoration: none;
  }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:56:30.720

`a`要在元素中创建`li`元素，只需应用与代码中演示的相同的技术即可：

功能 to_ul(id) {

```
var ul = document.createElement("ul");

for (var i = 0, n = id.length; i < n; i++) {

    var branch = id[i];

    var li = document.createElement("li"),
        a = document.createElement('a'); // create the `a`
    a.href = "http://example.com/"; // set the `href`

    var text = document.createTextNode(branch.trackName);
    a.appendChild(text); // append text to the a
    li.appendChild(a); // append the a to the li

    ul.appendChild(li);

}

return ul; 
```

}

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BZ7RX/)。

要设置该链接的样式，您可以在文档中或外部样式表中使用 CSS（与任何其他 CSS 一样）：

```
li a:link,
li a:visited {
    /* style the link's 'default' state */
}

li a:hover,
li a:active,
li a:focus {
    /* style the 'interactive' states of the links */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BZ7RX/1/)。

当然，您可以直接在创建所述元素的 JavaScript 中应用样式，尽管这样做的代价是不必要的：

```
/* all the other stuff removed, for brevity */
    var li = document.createElement("li"),
        a = document.createElement('a'); // create the `a`
    a.href = "http://example.com/"; // set the `href`
    a.style.color = '#000';
    a.style.textDecoration = 'none';
    /* ...and other stuff... */ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/BZ7RX/2/)。

这种方法除了昂贵之外，还缺乏对、`:hover`和样式进行样式设置的能力。`:active``:visited``:focus`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T00:06:37.507

要建立一个“链接”，您可能需要在每个 li 元素内都有一个锚元素，并且对于 a 元素，您希望`href`拥有您的数据中似乎没有的属性。但是作为示例，假设您想使用`id`as ，`href`您可以这样做：

```
$(document).ready(function(){

  var treeObj = {"root":[{"id":"1","trackName":"Whippin Post"},{"id":"2","trackName":"Sweet Caroline"},{"id":"3","trackName":"Tears in Heaven"},{"id":"4","trackName":"Ain't She Sweet"},{"id":"5","trackName":"Octopus' Garden"},{"id":"6","trackName":"Teen Spirit"},{"id":"7","trackName":"Knockin on Heaven's Door"}]};

  var $ul = $("<ul></ul>");       
  $.each(treeObj.root,function(i,v) {
    $ul.append($("<li></li>").append(
                              $("<a></a>").attr("href",v.id).html(v.trackName)));
  });
  $("#tree").append($ul);
}); 
```

您的问题被标记为“jQuery”，所以我继续使用 jQuery 创建列表（每个 li 内都有锚点）。“`$.each()`循环”遍历数组中的每个元素，使用and`treeObj.root`创建一个元素，将其附加到新的 li 元素，并将其附加到 ul 元素。完成后，新的 ul 将附加到您的树 div 中。`id``trackName``.each()`

至于链接的样式，这取决于你做你想要的 CSS，但既然你提到删除文本装饰，你可能想从这样的事情开始：

```
#tree a { text-decoration : none; } 
```

工作演示：http: [//jsfiddle.net/B2Zsv/](http://jsfiddle.net/B2Zsv/)

（如果小提琴中显示的代码和输出不是您正在寻找的那种东西，我建议您更新您的问题以显示您想要生成的所需输出 html。）

**更新**

我的原始代码的以下变体将轨道名称存储为创建的锚的属性，然后在单击时检索它们。

```
$(document).ready(function(){

    var treeObj = {"root":[{"id":"1","trackName":"Whippin Post","trackFile":"test1.wma"},{"id":"2","trackName":"Sweet Caroline","trackFile":"test2.wma"},{"id":"3","trackName":"Tears in Heaven","trackFile":"test3.wma"},{"id":"4","trackName":"Ain't She Sweet","trackFile":"test4.wma"},{"id":"5","trackName":"Octopus' Garden","trackFile":"test5.wma"},{"id":"6","trackName":"Teen Spirit","trackFile":"test6.wma"},{"id":"7","trackName":"Knockin on Heaven's Door","trackFile":"test7.wma"}]};

    var $ul = $("<ul></ul>");       
    $.each(treeObj.root,function(i,v) {
        $ul.append(
            $("<li></li>").append( $("<a></a>").attr({
                "href":v.id,"data-file":v.trackFile}).html(v.trackName) )
        );
    });
    $("#tree").append($ul);

    $("#tree a").click(function() {
      var trackname = $(this).html(),
          filename = $(this).attr("data-file");

      // here add your code to do something with filename and/or trackname

      return false;
    });
}); 
```

如您所见，我的单击处理程序在获取文件名后实际上并没有对文件名做任何事情（我更新的演示[http://jsfiddle.net/B2Zsv/3/](http://jsfiddle.net/B2Zsv/3/)显示它），但这向您展示了如何获得正确的文件名所以从那里你可以弄清楚如何玩它......

# php - PHP数组检查现有索引

> ID：10678171
> 
> 赞同：0
> 
> 时间：2012-05-20T23:48:23.550
> 
> 标签：php, arrays, json, indexing

PHP 不是很强大，所以这是我的问题：

我正在构建一个简单的数组以作为 json 返回，并用另一个数组中的数据填充它。$eventarray 可能有索引gas，也可能没有，所以我需要检查现有的gas索引，如果存在，如果没有填充默认值，则获取该值。

我将如何以最佳方式做到这一点？

再次在 PHP 中不那么强大。

这是数组：

```
 $somearr = array(
       "actiontaken"=>sprintf("%s", $eventarray['desc']),
        "actionname" =>sprintf("%s", $eventarray['name']),
        "type" =>sprintf("%s", $eventarray['type']),
        "subtype" =>sprintf("%s", $eventarray['name']),
        "min" =>sprintf("%s", $eventarray['min']),
        "gas" =>sprintf("%s", $eventarray['gas']),
        "playerId"=>$value['p'],
        "name" =>$value2['name'],
        "race" =>$value2['race']
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T23:51:52.023

您可以使用[`isset()`](http://php.net/isset)来检查元素是否存在（并且不存在`null`）：

```
isset($eventarray['gas']) ? $eventarray['gas'] : 'defaultvalue' 
```

注意：`null`如果您不希望使用默认值的可能值，则不能使用`isset`但必须[`array_key_exists($eventarray, 'gas')`](http://php.net/array_key_exists)改用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:52:32.537

您可以使用三元运算符来检查它的存在，并设置一个默认值。

它的工作方式是：（条件）？[如果为真]：[如果为假]

```
...
"gas" => (isset($eventarray['gas'])) ? $eventarray['gas'] : 'default', 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T23:52:11.567

用这个

```
array_key_exists('gas', $somearr); 
```

[http://www.php.net/manual/en/function.array-key-exists.php](http://www.php.net/manual/en/function.array-key-exists.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T23:53:30.960

首先使用默认值初始化您的 $somearr 数组：

```
$somearr = array(
  'actiontaken' => 'default action',
  'actionname' => 'default action name',
  etc.. ); 
```

然后循环$eventarray：

```
foreach( $eventarray as $event => $eventval ) {
  $somearr[$event] = $eventval;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-20T23:57:36.170

使用[三元运算符](http://php.net/manual/en/language.operators.comparison.php)：

```
"actiontaken"=>sprintf("%s", (isset($eventarray['desc']) && !empty($eventarray['desc'])) ?$eventarray['desc'] : 'Default Value'), 
```

# php - 如果用户未登录，重定向的奇怪行为

> ID：10678175
> 
> 赞同：-3
> 
> 时间：2012-05-20T23:49:11.537
> 
> 标签：php, javascript

我有两个`setInterval(myFunction,40000)`， `setInterval(myFunction2,50000)` myFunction 和 myFunction2 正在发出 ajax 请求，如果用户没有登录

```
echo '<meta http-equiv="refresh" content="0;url='.$home.'" />';
echo '<script type="text/javascript"> self.location = "'.$home.'"; </script>';
exit(); 
```

在ajax响应中有：

```
<meta http-equiv="refresh" content="0;url=http://site.com/login" />
<script type="text/javascript"> self.location = "http://site.com/login"; </script> 
```

但是页面没有改变，并且在 6 个请求之后发生了变化。

阿贾克斯

```
$.ajax({
type:"POST",
url:"http://site.com/thing.php",
data:submitData,
dataType:"html",
success:function(data){someDiv.html(data);}
}); 
```

在thing.php中

```
<?php

if(is_logged()){
-- the code
} 

else {
 -- the redirect code
}
?> 
```

?>

并且代码正在运行，但在 6 请求之后

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:28:30.837

meta 元素不会做任何事情，因为 meta 元素只允许在 head 中，而不是在 body 的任何 div 中。

该脚本应在插入文档后立即执行并将您重定向到 $home。我不能告诉你为什么它只有在第六个请求之后才会起作用。你为什么要发送其中的 6 个？您的控制台中是否出现任何错误？您确定脚本正在正确执行吗？

# android - Android Camera Byte[] 数据，它如何存储 32 位像素？

> ID：10678177
> 
> 赞同：1
> 
> 时间：2012-05-20T23:49:59.167
> 
> 标签：android, image-processing

据我了解，每个像素由 4 个字节（a，r，g，b）表示。如何将其存储在 byte[] 数组中，其中大小是图像中的像素数。

以下代码按预期工作（旋转图像）

```
rotatedData = new byte[data.length];
for (int y = 0; y < height; y++) {
    for (int x = 0; x < width; x++)
        rotatedData[x * height + height - y - 1] = data[x + y * width];
}
data = rotatedData;
int tmp = width; // Here we are swapping, that's the difference to #11
width = height;
height = tmp; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T11:37:27.593

如果您正在讨论解码相机预览图像的“NV21”表示，它由一个包含每个像素一个字节的亮度数据的块组成，然后是另一个包含颜色数据的块，每个 2×2 像素块有一个样本。颜色数据的分辨率低于亮度，因为人眼对颜色细节不太敏感。

有关将此格式解码为常规 Android 位图格式 ARGB 像素的示例代码，请参阅[此处](https://github.com/ldo/3D-Compass/blob/master/src/CameraUseful.java)`DecodeNV21`的例程。

# php - 使用 wget 的多个 cron 作业

> ID：10678179
> 
> 赞同：0
> 
> 时间：2012-05-20T23:50:30.837
> 
> 标签：php, linux, web-services, ubuntu

我正在使用 Ubuntu 服务器，并且我想在一周中的每一天为不同的文件执行 wget cron 工作。

我已经让它只为一项任务工作，但每当我尝试做更多事情时，它会自动覆盖旧的。我知道如何设置时间和格式等；但我不知道如何做多个 wget cron 工作。

这就是我到目前为止只做一个的方式：

```
 echo "*/10 * * * 5 wget http://XXX.XXX.XXX/files/thursday.php" | crontab - 
```

谁能帮我？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:11:31.310

最好使用命令行 crontab 功能来维护 cron 作业

```
crontab -e 
```

将调出编辑器。

大多数 *nix 系统的默认值是 vi，这对新手不友好，但您可以将其更改为 nano 或 pico

```
export EDITOR=nano 
```

如果您在像我这样的系统上，您的登录用户可能不是运行 cron 作业的最佳用户；因此您可能必须`su`在编辑 crontab 文件之前使用切换用户。

看看你指定做什么，除非你真的需要通过appache，你可以像这样调用php文件“php file.php”，不需要wget。

```
*/10 * * * 5 php FULL_PATH/files/thursday.php  > /dev/null 2>&1 
```

# javascript - 使用 JQuery 进行服务器端验证，然后将用户发送到另一个站点

> ID：10678195
> 
> 赞同：0
> 
> 时间：2012-05-20T23:53:37.083
> 
> 标签：javascript, jquery, html

我想“推迟”（停止表单的默认行为）将用户发送到“http://www.othersite.com”，直到在 check.php 上完成服务器端验证

完成后，将用户发送到“http://www.othersite.com”。我可以发送到验证页面没问题，但我需要验证然后发送到另一个网站。说我有这样的表格

```
$(document).ready(function(){
$('#sendbutton').click(function(){
$('#error').empty();
$('#send').ajaxForm(function (data, textStatus) {
$('#error').append(data);
});
});
});

<form id="send" name="send" method="post" action="http://www.othersite.com/index.htm">
<input type="text" id="fname" name="fname" />
<input type="text" id="lname" name="lname" />
<input type="text" id="address" name="address" />
<input type="text" id="city" name="city" />
<input type="text" id="state" name="state" />
<button id="sendbutton">Submit</button>
</form>
<div id="error"></div> 
```

并且服务器端验证发生在 check.php

```
check field inputs here on check.php
if not correct
echo error message

if successful echo "validation_ok" 
```

如果返回的数据是“validation_ok”，则发送用户在“http://www.othersite.com”上完成表单提交

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:00:15.107

```
$(document).ready(function() {
    $('#send').submit(function() {
        $('#error').empty();
        // Post the form to your validation page
        $.post('/check.php', $(this).serialize(), function (data) {
            // If validation failed, stop submission
            if (data != 'validation_ok') {
                $('#error').append(data);
                // Prevent submission.
                return false;
            }
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:13:28.343

听起来像是 AJAX 的绝佳机会（正如 @nachito 所暗示的那样）。否则，您还可以：

1.  最初`check.php`呈现表单并进行客户端验证。
2.  使表单的操作`check.php`（有效地回发到自身）。
3.  成功验证后，将表单的操作设置为`www.othersite.com`并回显一个标记“自动提交”的 javascript 文字值（或隐藏输入，如果您愿意的话）。
    *   您还可以使用 jQuery 来更改表单的操作，而不是将其翻转为`check.php`.
4.  检测到标志后，提交有关`document.ready`事件的表单。

如果做不到这一点，如果服务器端验证已通过使用（并且没有，只需谷歌“[来自 PHP 的 HTTP POST，没有 cURL](https://www.google.com/search?q=HTTP%20POST%20from%20PHP,%20without%20cURL) ”），您也可以`check.php`发布到。`www.othersite.com``cURL`

# jquery - 具有多个输入的 JQuery 字符计数器

> ID：10678196
> 
> 赞同：2
> 
> 时间：2012-05-20T23:53:41.610
> 
> 标签：jquery, count, char

我在下面找到了一个简单的文本框字符计数器（如 Twitter）的解决方案。

我一直在尝试修改代码以适应多个文本输入，而不是使用单个文本框，但没有成功。

原因是我想在将 URL 和文本作为同一条推文发送之前验证它们。

谁能指出我正确的方向？

```
<span class="counter"></span>
<input type="text" name="field1" id="field1" class="word_count" />
<input type="text" name="field2" id="field2" class="word_count" /> 
```

**js：**

```
$(document).ready(function () {
    $('.word_count').each(function () {
        var $this = $(this);
        var counter = $this.parent().find('.counter');
        var maxlength = $this.attr('maxlength');

        counter.text('Only ' + maxlength + ' characters allowed');

        $this.bind('input keyup keydown', function () {
            var value = $this.val();

            if (value.length > 0) {
                counter.text((maxlength - $this.val().length) + ' characters left');
            } else {
                counter.text('Only ' + maxlength + ' characters allowed');
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T00:16:24.423

首先这里是小提琴。[http://jsfiddle.net/bczengel/tsbfU/](http://jsfiddle.net/bczengel/tsbfU/)

这是问题所在。

1.  该代码正在寻找不存在的输入字段上的 maxLength 属性。因此 NaN 消息。
2.  如果您使用最新版本的 jQuery，您应该使用 .on() 方法。它有一些其他的功能，但基本上它是较新的方法。
3.  您不需要遍历所有输入。jQuery 会将您的事件绑定到它在结果集中找到的所有元素。基本上，当只需要一个输入时，您正在为每个输入创建一个新函数。
4.  我将焦点添加到事件列表中，以便在您输入输入时更新计数器。您可能希望添加一个单独的模糊事件处理程序以在没有输入焦点时隐藏计数器。

# java - Java - 绘制动态形状轮廓

> ID：10678197
> 
> 赞同：0
> 
> 时间：2012-05-20T23:54:05.593
> 
> 标签：java, swing, graphics, shape, graphics2d

`Shape`我希望通过将对象（具有绘图功能）添加到屏幕上沿形状周边的适当位置来为（AWT）创建动态轮廓。我希望每个对象之间的距离大致均匀。（同样效果的替代方法也可以。）

我如何获取这些对象的位置？我知道形状有一个路径迭代器，但我不知道如何使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:07:38.333

您可能会查看一个库，例如[*A Shape Diagram Editor*](http://www.eclipse.org/articles/Article-GEF-diagram-editor/shape.html)中描述的库。

如果你想尝试，[`GraphPanel`](https://sites.google.com/site/drjohnbmatthews/graphpanel)这是一个简单的对象绘图程序，它具有可移动、可调整大小、由边缘连接的彩色节点。如果节点更小一点，它们将是 a 上的可移动点`Shape`，可以迭代，如此处[所示](https://stackoverflow.com/a/5878090/230513)。`Polygon`

附录：*我希望每个对象之间的距离大致均匀。*

`class Node`公开了许多在`List<Node>`诸如`selected`. 例如，现有实现用于将多个选择作为一个单元进行转换或调整大小。`Align`和的功能`Distribute`可以类似地实现。我会`LayoutManger`以后者为例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T06:00:19.100

用于`FlatteningPathIterator`获取`Shape's`路径点。

你也可以使用`BasicStroke's`方法

```
public Shape createStrokedShape(Shape s) 
```

获得`Shape's`具有所需宽度的轮廓。

# c# - 与弱数据集合并后保留类型化数据集

> ID：10678198
> 
> 赞同：0
> 
> 时间：2012-05-20T23:54:08.723
> 
> 标签：c#, .net, datatable, dataset, strongly-typed-dataset

我有两个数据集，第一个是通用的，第二个是类型的。我正在尝试更新一行并将其保存到数据库中，但一直失败。这是我正在尝试做的事情：

将数据加载到通用 DS

将类型化的 DS 与通用的合并。

更新键入的 DS 中的行。

在泛型上调用 AcceptChanges 以将其持久化到数据库中

```
//Generic DS
    DataSet ds = GetData();

//Typed Ds
    var gradeTeamConfigDataSet = new GradeTeamConfigDataSet();

//Merge    
    gradeTeamConfigDataSet.tblGradeTeamConfig.Merge(ds.Tables["default"], true, MissingSchemaAction.Ignore);

      //Update
      if (gradeTeamConfigDataSet.tblGradeTeamConfig != null)
             {

                    gradeTeamConfigDataSet.tblGradeTeamConfig.Rows[0].BeginEdit();

                    //Update row

                    gradeTeamConfigDataSet.tblGradeTeamConfig.Rows[0].EndEdit();
             }
    //Persist        
    gradeTeamConfigDataSet.AcceptChanges(); 
```

但是当再次检查数据库时它没有更新任何东西！有谁能发现问题，请给我一个解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:31:29.143

你看过[这个帖子吗](http://social.msdn.microsoft.com/Forums/en/adodotnetdataset/thread/71a3d1e1-2588-499d-b603-c5c643f6fe50)

> AcceptChanges 仅更新（内存中）数据集中的行，即将它们标记为“实际数据库更新不需要”。如果要将行更新到数据库，请调用 tableadapter 的 Update 方法。

# iphone - 在单个设备上跨应用共享应用内购买

> ID：10678202
> 
> 赞同：3
> 
> 时间：2012-05-20T23:54:41.267
> 
> 标签：iphone, ios, in-app-purchase

我正在考虑构建一系列 iOS 应用程序。每个应用程序都将单独购买，但我希望任何应用程序中的应用程序内购买都是通用的。即，在该系列的一个应用程序中付费，它也可以在安装的任何其他应用程序中使用。在不强制用户创建任何类型的帐户的情况下，这是否可行？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:29:28.333

答案是否定的，原因是您的所有 IAP 都由捆绑标识符标识，并且对于每个应用程序都是唯一的，因为所有 IAP 都特定于捆绑标识符，您无法共享它们。

还有另一种方法可以实现您的要求，我不知道您的所有要求，我仍然不会遵循此解决方案，但我仍在写信以了解一些选择。

您可以跨应用程序共享钥匙串并跟踪跨应用程序的购买。

1.  删除应用程序时不会删除钥匙串数据

2.  如果用户重置/恢复手机钥匙串数据可能会被删除并且您将陷入死胡同，因为用户必须从您的第一个应用程序中恢复内容才能在第二个应用程序中使用......（是的，令人困惑......对吗？）

我现在可能还缺少其他一些并发症……祝你好运

# php - php 命令行 exec() 多个执行和目录？

> ID：10678205
> 
> 赞同：1
> 
> 时间：2012-05-20T23:55:31.520
> 
> 标签：php, shell, cmd, exec, shell-exec

我正在尝试使用 exec() 和 shell_exec 在 php 中执行多个命令，但我得到了一个我不应该返回的空值，并且没有任何事情发生（如果我在命令行中复制并粘贴下面的字符串，它将工作正常并完成所需的工作）这是我正在使用的命令：

```
$command = "cd /../Desktop/FolderName;";
$command .= 'export PATH=$PATH:`pwd`;';
$command .= 'Here i execute a compiler;'; 
```

然后我使用 escapeshellcmd()

```
$escaped_command = escapeshellcmd($command); 
```

然后

```
shell_exec($escaped_command); 
```

任何想法我做错了什么，我也尝试了 escapeshellarg() 而不是 escapeshellcmd()？

**解决方案：问题是其他所有者的执行编译器的权限是非的，这就是问题所在。因为当您`exec()`在 php 中使用函数时，文件的所有者将是 www-data，因此您需要从 ubuntu 的 ACL 或任何基于 linux 的操作系统中授予 www-data 的权限（您可以通过这样做来了解所有者`exec('whoami')`)，或通过您需要执行的文件。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:04:35.887

（对不起，我的英语不好）在 Linux 上，您可以在 Shell 脚本中添加命令。

你可以把它放在任何文件中：

```
#!/bin/bash
cd /../Desktop/FolderName
export PATH=$PATH:`pwd`
EXECUTE COMPILER 
```

并将其保存为 fille.sh

然后，添加执行权限：chmod +x path/to/file.sh

在 PHP 中，您可以调用此脚本执行：shell_exec('sh path/to/file.sh');

希望这可以帮助！

# ios - 创建图像的 .Zip 文件

> ID：10678208
> 
> 赞同：1
> 
> 时间：2012-05-20T23:56:02.567
> 
> 标签：ios, mfmailcomposer

我想知道如何创建一个包含图像的 .zip 文件。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:30:26.153

你可以通过调用- 如果你已经有 zip 文件`addAttachmentData:mimeType:fileName:`来做到这一点。`MFMailComposeViewController`

如果您的问题包括创建 zip 文件，不幸的是，这在 iOS 中通过一些方法调用是不可能的。您需要为此使用第三方库，例如[objective-zip](https://github.com/flyingdolphinstudio/Objective-Zip)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:19:43.460

是的，有可能去这里找出：

[类参考](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html)

寻找添加附件方法。

# css - 背景：url（repeat_bg.png）repeat-y，url（repeat_bg_right_side.png）右上角repeat-y；在ie8？

> ID：10678209
> 
> 赞同：0
> 
> 时间：2012-05-20T23:56:13.330
> 
> 标签：css, internet-explorer, repeat

```
body{

background:url(repeat_bg.png) repeat-y, url(repeat_bg_right_side.png) top right repeat-y;
} 
```

有没有办法可以在 ie8 中完成这项工作？还是ie8不支持这个（我是新手）。谢谢你的时间 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:58:21.097

IE8 不支持多背景。最好的办法是创建一个外部容器`div`，并将一个背景放在 body 上，一个放在容器 div 上：

```
<body>
    <div id="container">
        ...
    </div>
</body> 
```

使用 CSS：

```
body {
    background: url(repeat_bg.png) top left repeat-y;
    padding: 0;
}

#container {
    background: url(repeat_bg_right_side.png) top right repeat-y;
} 
```

（您需要，`padding: 0`因为某些浏览器`body`默认设置填充，这会导致两个图像不对齐。）

# c# - 如何正确使用依赖注入？

> ID：10678210
> 
> 赞同：3
> 
> 时间：2012-05-20T23:56:21.653
> 
> 标签：c#, oop, dependency-injection, ninject

简单案例：我有一个用于记录消息的接口，如下所示：

```
public interface ILogger
{
   void Log(string message);
} 
```

也许三个不同的类实现了这个接口。

现在，我可以在一个地方写下 DI 行，例如：

```
kernel.Bind<ILogger>().To<ConsoleLogger>(); 
```

我的问题是，如何在许多类中使用该接口，但不通过构造函数注入每个人。因为我们可以有很多我们想要使用的不同接口，并且在该类构造函数上的声明可能会很混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T00:46:07.357

在构造函数中注入过多的项目是一种代码异味。这通常意味着您的班级正在扮演多个角色。[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)说每个类应该只有一个目的，它完全封装在类中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T00:11:28.037

在依赖注入中，在遗留场景之外使用属性注入被认为是糟糕的形式。通过属性注入一个值表明它是可选的，因此并不是真正的依赖。

如果您的类型具有大量构造函数依赖项，则可能表明您需要进行一些重构。也许某些类型可以一起使用，并且可以重构为它们自己的组件。无论哪种方式，如果您使用的是 IoC 框架（例如 Ninject），那么一个类型需要多少个构造函数参数真的很重要吗？无论如何，容器将为您进行注射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T07:03:38.573

虽然@LukeMcGregor 所说的一般来说是正确的，但 Logger 看起来像是一个横切关注点，如果您不想用 ILogger 污染每个构造函数，也可以通过[AOP解决。](http://en.wikipedia.org/wiki/Aspect-oriented_programming)Ninject 似乎通过[ninject.extensions.interception](https://github.com/ninject/ninject.extensions.interception)支持 AOP 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T00:03:38.577

您可以`ILogger Logger { get; set;}`在类中实现属性并使用大多数 IoC 容器支持的属性注入功能。

# iphone - UINavigationItem 生命周期

> ID：10678213
> 
> 赞同：1
> 
> 时间：2012-05-20T23:56:50.710
> 
> 标签：iphone, ios, uiviewcontroller, uinavigationcontroller, uinavigationitem

据我了解 SDK 文档 UIViewController 的 navigationItem 生命周期绑定到控制器本身而不是控制器的视图。即在默认实现中，它是按需创建的，并与视图控制器一起销毁 - 具有所有内容，如按钮项和标题视图。鉴于按钮项和 titleView 都可以由 UIView 实例表示 - 这是否意味着一旦创建这些视图将保留在内存中，直到控制器被销毁并经历所有内存警告？

这个设计决策背后的意义是什么？对内存使用的影响是否被认为太小而无法打扰？对于到处使用自定义导航栏按钮/标题的应用程序来说，它真的很小吗？

很容易将一些 navigationItem 属性显式绑定到控制器的视图生命周期——比如在 -viewDidLoad 中设置 titleView 并将其放入 -viewDidUnload ( `self.navigationItem.titleView = nil`)。但 navigationItem 属性文档[建议避免这种模式](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UIViewController/navigationItem)。除了给定的带有后退按钮的示例之外，还有其他潜在问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:37:55.277

添加了一个类别 (snippet2) 来跟踪保留计数和导航项的破坏，随意做同样的事情:) 似乎它没有被内存警告释放。一个解释来自于视图控制器不必与导航控制器一起使用的常识：这应该是为什么导航项添加了一个单独的类别（snippet1）并且它的生命周期必须用导航管理控制器，而不是视图控制器实例本身。

如果自定义导航项太重以至于您需要尽可能释放它，我将保留默认实现，添加自定义导航项类别并根据需要手动管理这些项目（再次通过覆盖所需的`UINavigationController`方法，如导航-控制器`didReceiveMemoryWarning`, `pushViewController:animated:`, `popViewControllerAnimated:animated:`)。但是，我无法想象真正需要这种情况的情况。

片段 1

```
@interface UIViewController (UINavigationControllerItem)

@property(nonatomic,readonly,retain) UINavigationItem *navigationItem; // Created on-demand so that a view controller may customize its navigation appearance.
@property(nonatomic) BOOL hidesBottomBarWhenPushed; // If YES, then when this view controller is pushed into a controller hierarchy with a bottom bar (like a tab bar), the bottom bar will slide out. Default is NO.
@property(nonatomic,readonly,retain) UINavigationController *navigationController; // If this view controller has been pushed onto a navigation controller, return it.

@end 
```

片段 2

```
@implementation UINavigationItem (Logs)

- (id)init
{
    NSLog(@"I'm initialized (%@)", [self description]);
    self = [super init];
    return self;
}

-(void) release
{
    NSLog(@"I'm released [%d](%@)", [self retainCount], [self description]);
    [super release];
}

-(void) dealloc
{
    NSLog(@"I'm deallocated [%d](%@)", [self retainCount], [self description]);
    [super dealloc];
}

@end 
```

# interface-builder - Xcode 4.3 中 Interface Builder 的可访问性

> ID：10678214
> 
> 赞同：3
> 
> 时间：2012-05-20T23:56:59.980
> 
> 标签：interface-builder, xcode4.3

我想知道是否有人知道 Xcode 4.3 中的可访问性视图在哪里？

![在此处输入图像描述](../Images/9cd782a1b60aeeac5694de07e7910d84.png)

这就是我在 IB 中看到的；没有可访问性选项卡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:00:29.293

编辑：

`UITableView`没有可访问性下拉菜单，因为其中的项目（单元格，或者实际上是标签和按钮以及您*放入*自定义表格视图单元格的任何其他内容）将是用户正在寻找的可访问性项目。

原答案：

可访问性标签可用于许多不同的`UIView`子类对象（例如按钮等控件）。

如果您在 XCode 4 的 XIB / Interface Builder 编辑器中查看任何对象的详细信息，您将看到如下所示的下拉字段：

![在此处输入图像描述](../Images/b1f461fef28f45158077669f44671ec8.png)

# graph - 沿路径的最小边权重

> ID：10678221
> 
> 赞同：0
> 
> 时间：2012-05-20T23:59:26.010
> 
> 标签：graph, graph-theory, edges, vertices, floyd-warshall

如何沿着任意顶点之间的所有可能路径找到一组最小边权重的最大值`(u,v)`？

我在考虑修改 Floyd-Warshall？

```
i.e. Path 1: s - a - b - c - d - t with weights 1 - 5 - 6 - 10 - 9 
```

最小边权重为 1

```
Path 2: s - x - y - z - w - t with weights 3 - 9 - 8 - 6 - 7 
```

最小边权重为 3

因此结果是`max(1, 3) = 3`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T09:55:24.670

是的，对 Floyd-Warshall 的修改会起作用 - 您将跟踪最大路径“宽度”，而不是最短路径长度。

如果您只对两个顶点感兴趣，您可以采取更简单的方法：从一个空图开始，然后添加按其权重排序的边（从高到低）。当有问题的节点连接时，添加的最后一条边会为您提供最大的“宽度”。正确完成（即使用不相交集来检查连通性），这将比 Floyd-Warshall 更快。

*注意：我只考虑正权重。*

# ruby-on-rails - Rails 的 Coffeescript 导入和组织

> ID：10678224
> 
> 赞同：0
> 
> 时间：2012-05-21T00:00:24.103
> 
> 标签：ruby-on-rails, coffeescript, asset-pipeline

我正在构建一个几乎完全是 CoffeeScript 前期的 Rails 应用程序。用户永远不会等待页面重定向，因为实际上一切都发生在首页（如 Twitter）。

现在我不得不将我所有的 CoffeeScript 放到一个文件中，因为我的 jQuery onLoad 很复杂，并且在生产中它会被编译到一个 JS 文件中，而在测试中情况并非如此。

我如何从开发中的其他文件导入 CoffeeScript 或组织我的 CoffeeScript，这样我就不会将 500 行堆积到一个文件中（当这 500 行包含 5/6 个不同的域时）？

我已经`import`在 SCSS 中为我​​的样式表做同样的事情，但 CS 被证明有点棘手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:10:08.893

资产管道允许您将不同的文件放入一个文件中，这样可以在开发中将它们分开，并在生产中将它们编译到一个文件中。查看[清单文件和指令的说明](http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives)

另外，您是否研究过[RequireJS](http://requirejs.org/)？它可以在 Rails 内部或外部工作，并且可能是您需要的那种东西。

# python - Python - 为什么extend（）和append（）返回None（void）？

> ID：10678226
> 
> 赞同：17
> 
> 时间：2012-05-21T00:00:36.203
> 
> 标签：python, arrays, immutability

> **可能重复：**
> [为什么 python 的 list.append 评估为 false？](https://stackoverflow.com/questions/1682567/why-does-pythons-list-append-evaluate-to-false)

在我看来，我认为`list1.extend(list2)`并且`list1.append(num)`应该返回变异列表而不是`None`（void）。以及具有破坏性地改变原始列表的副作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T00:12:30.873

我相信其目的是促进可读代码和减少错误。这个决定是很久以前做出的，但是您可以通过查看 python/python-dev 邮件列表的档案找到更多信息。

Python3 本来是改变这种行为的机会，但正如你所见，它仍然存在，因此开发团队不认为是设计错误

# java - 原点、宽度、高度

> ID：10678227
> 
> 赞同：0
> 
> 时间：2012-05-21T00:00:41.923
> 
> 标签：java, height, width, jframe, rectangles

左矩形 = new Rectangle(0,0,WIDTH/9,HEIGHT); 在这段代码中，如果我增加宽度，为什么它看起来像在 JFrame 的左侧延伸得更远？如果我减少它，为什么它会向右延伸？这不像坐标平原那样工作吗？身高对我来说更有意义。如果高度增加，它会向上延伸，如果它降低，它会向下延伸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:19:13.943

Swing 以 0,0 为左上角绘制，正 X 向右延伸，正 Y 向下延伸。这可能会令人困惑，因为有些人期望 0,0 是左下角。

如果您无法确定事物的位置而不是您认为的位置，我建议您只绘制形状的点，然后玩弄它，而不是先尝试绘制矩形等。

# python - 如何选择性地转义 Python 字符串中的百分比 (%)？

> ID：10678229
> 
> 赞同：422
> 
> 时间：2012-05-21T00:01:44.083
> 
> 标签：python, escaping, python-2.7

我有以下代码

```
test = "have it break."
selectiveEscape = "Print percent % in sentence and not %s" % test

print(selectiveEscape) 
```

我想得到输出：

```
Print percent % in sentence and not have it break. 
```

实际发生的情况：

```
 selectiveEscape = "Use percent % in sentence and not %s" % test
TypeError: %d format: a number is required, not str 
```

* * *

## 回答 #1

> 赞同：711
> 
> 时间：2012-05-21T00:03:43.890

```
>>> test = "have it break."
>>> selectiveEscape = "Print percent %% in sentence and not %s" % test
>>> print selectiveEscape
Print percent % in sentence and not have it break. 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-05-21T00:12:34.227

或者，从 Python 2.6 开始，您可以使用新的字符串格式（在[PEP 3101](http://www.python.org/dev/peps/pep-3101/)中描述）：

```
'Print percent % in sentence and not {0}'.format(test) 
```

当您的字符串变得更加复杂时，这特别方便。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2012-05-21T07:46:33.257

尝试使用`%%`打印 % 符号。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-11-27T12:24:06.463

您不能有选择地 escape `%`，因为`%`根据以下字符始终具有特殊含义。

在Python的[文档中，在该部分第二个表的底部，它指出：](https://docs.python.org/2/library/stdtypes.html#string-formatting-operations)

```
'%'        No argument is converted, results in a '%' character in the result. 
```

因此，您应该使用：

```
selectiveEscape = "Print percent %% in sentence and not %s" % (test, ) 
```

（请注意显式更改为元组作为参数`%`）

在不了解上述情况的情况下，我会这样做：

```
selectiveEscape = "Print percent %s in sentence and not %s" % ('%', test) 
```

有了你显然已经拥有的知识。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-01-17T11:42:48.240

如果您使用的是**Python 3.6**或更高版本，则可以使用[f-string](https://www.python.org/dev/peps/pep-0498/)：

```
>>> test = "have it break."
>>> selectiveEscape = f"Print percent % in sentence and not {test}"
>>> print(selectiveEscape)
... Print percent % in sentence and not have it break. 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-22T07:27:15.160

如果格式模板是从文件中读取的，并且您不能确保内容将百分号加倍，那么您可能必须检测百分号并以编程方式确定它是否是占位符的开头。然后解析器还应该识别像`%d`（和其他可以使用的字母）这样的序列，还有`%(xxx)s`等等。

使用新格式可以观察到类似的问题——文本可以包含花括号。

# c - 使用 select 和 recv 通过套接字从 Web 服务器获取文件

> ID：10678230
> 
> 赞同：1
> 
> 时间：2012-05-21T00:02:01.873
> 
> 标签：c, sockets

我无法使用 C 套接字从 Web 服务器接收“大”文件；即当这些文件（或者我怀疑）大于我用来接收它们的缓冲区的大小时。如果我尝试（通过 GET 请求）询问`index.html`不大于几个字节的简单内容，我会很好，但其他任何事情都会失败。我假设我缺乏知识`select()`或者`recv()`是什么让我失望。看这里：

```
fd_set read_fd_set;
FD_ZERO(&read_fd_set);
FD_SET((unsigned int)socketId, &read_fd_set);

/* Initialize the timeout data structure. */
struct timeval timeout;
timeout.tv_sec = 2;
timeout.tv_usec = 0;

// Receives reply from the server
int headerReceived = 0;
do {
    select(socketId+1, &read_fd_set, NULL, NULL, &timeout);

    if (!(FD_ISSET(socketId, &read_fd_set))) {
       break;
    }

    byteSize = recv(socketId, buffer, sizeof buffer, 0);

    if (byteSize == 0 || (byteSize < BUFFER_SIZE && headerReceived)) {
       break;
    }

    headerReceived = 1;

} while(1); 
```

没错，在将 GET 请求发送到 Web 服务器之后，我很确定服务器运行良好，并且来自任何其他客户端（如任何 Web 浏览器）的 GET 请求都按预期工作。

在此先感谢，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:19:46.487

```
if (byteSize == 0 || (byteSize < BUFFER_SIZE && headerReceived))
{
    break;
} 
```

`headerReceived`在第一次读取后设置为 true。这是完全可能的，并且后续的 s*可能*`recv()`会小于`BUFFER_SIZE`。那时您已退出读取循环。 `Recv()`将返回要读取的字节数，不一定是您请求的字节数。

也要么坚持`BUFFER_SIZE`要么`sizeof(buffer)`。混合和匹配只是在路上的某个地方寻找一个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:08:48.470

您没有说您使用的是什么操作系统，但根据[POSIX 规范](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pselect.html#tag_16_400_03)：

> 成功完成后，*select () 函数可能会修改**timeout*参数指向的对象。

（例如，我相信 Linux 正是这样做的。）

因此，以后对循环的调用很可能会将超时设置为零，这将导致`select`立即返回而没有准备好描述符。

`select`我建议在每次通过循环调用之前立即重新初始化超时结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T00:27:42.717

我发现的一件事是您没有在循环期间重新初始化选择。这可能就是您成功获取小文件的原因；一次性收到它们，并且不必重复循环。

我建议你把：

```
FD_ZERO(&read_fd_set);
FD_SET((unsigned int)socketId, &read_fd_set);
timeout.tv_sec = 2;
timeout.tv_usec = 0; 
```

在循环内（在你调用之前`select`），它可能只是工作。

# svn - 颠覆权限

> ID：10678231
> 
> 赞同：0
> 
> 时间：2012-05-21T00:02:02.693
> 
> 标签：svn, permissions

我有一个在 Ubuntu 服务器上运行的颠覆服务器，但我确实有一些权限问题。我的主 svn 文件夹及其所有子文件夹和文件对组颠覆和属于该组的每个人都具有读/写权限。

我使用 svn 协议连接到我的 svn，例如：

```
svn co svn://192.168.1.2/config 
```

现在我的问题是，当我使用计算机连接到 SVN 服务器时，我没有写/读权限。如果我设置 o+r 和 o+w 那么我可以读写，但除非设置了“其他”权限，否则 svn 会给我权限错误。

我应该如何在 svn sever 上设置权限，这样它才能理解我正在使用远程机器连接并给我组权限。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T04:06:30.300

如果您使用该`svn://`协议，则读/写权限必须针对运行该`svnserve`进程的用户。事实上，这正是为什么`file://`当您有多个用户时不应该使用该协议的原因......

当您`svn://`用作协议时，您要求`svnserve`进程对您的 Subversion 存储库进行读取和写入。因此，您作为用户不需要实际的读/写权限。

事实上，您不希望`svnserve`进程以外的任何人能够直接访问您的存储库文件。标准设置是让您的 Subversion 存储库中的文件只能由运行您的 Subversion 服务器进程的用户访问：无论`httpd`是`svnserve`.

要解决您的问题，请确保运行`svnserve`命令的用户拥有您的 Subversion 存储库目录树中的文件。确保所有文件和目录都设置为`rwx------`或`rwxr-xr-x`。这样，除了`svnserve`进程之外，没有人可以接触文件。

那么，如何指定安全性？在 Subversion 存储库目录中，有一个名为`conf`. 最简单的方法是配置一个`svnserve.conf`在这个目录下调用的文件。您对以下三个部分感兴趣：

*   关于第 11 行，有两行`# anon-access = read`和`# auth-access = read-write`. 您可以删除`#`行首的 以启用这两个参数。`anon-access`设置您未登录时的访问权限类型。默认为*read*。您可能希望将其更改为*none*。另一个是您登录时拥有的访问权限类型。您希望保留默认设置，即*read-write*。

*   在`conf/svnserve.conf`文件的第 20 行左右，有一行`# password-db = passed`. 在第 11 行中，您指定了登录用户的访问权限。现在，您正在指定包含登录名和密码的文件。从该行的开头删除`#`以指定该 `conf/passwd`文件具有您的用户名和密码。该目录中有一个示例`passwd`文件。**注意**：确保此文件`rw-------`对其具有权限。您不希望任何人能够打开它并看到密码！

*   通常，这就是您感兴趣的全部内容。大多数网站都表示，任何可以登录的人都应该能够进行更改。毕竟，如果有人把事情弄得一团糟，你总是可以撤消它。但是，如果您想更严格地限制谁可以更改哪些文件，则需要查看`conf/svnserve.conf`文件中的第 27 行。这看起来像`# authz-db = authz`。再次`#`从头开始删除。在`conf`目录中，有一个示例`authz`该文件向您展示如何设置谁对存储库的特定部分具有读取或读写访问权限。我强烈建议您在这样做之前三思而后行。否则，您将为自己创造大量工作，并使所有开发人员都讨厌您。将开发人员从一个项目拉到另一个项目并不罕见。如果您已严格锁定项目，以便只有某些开发人员可以写入某些项目，那么每次开发人员切换项目时，您都会更改此文件，并且开发人员必须等待您才能完成工作。轻触。轻触。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-15T14:10:46.353

在花了几天时间阅读无意义的答案后，我终于通过简单地使用 sudo 运行 svnserve 解决了这个问题。

```
svnserve -d -r /svn/repository/ 
```

...引发权限错误

```
sudo svnserve -d -r /svn/repository 
```

...没有权限错误。

# javascript - 使用没有 jQuery 的 Ajax 更新页面部分

> ID：10678232
> 
> 赞同：1
> 
> 时间：2012-05-21T00:02:06.713
> 
> 标签：javascript, ajax

该页面主要使用 PHP，并且仅少量使用任何 JavaScript，因此我不希望在没有它的情况下使用 jQuery。我想更新页面的一部分，但我对 Ajax 不是很有经验。jQuery 的方法是在页面的 URL 后面加上“#sectionid”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:23:49.883

您需要了解的所有信息都在这里：

[https://developer.mozilla.org/en/XMLHttpRequest](https://developer.mozilla.org/en/XMLHttpRequest)

您将对文档的、`send`、`open`和`response`部分感兴趣。`readyState``onreadystatechange`

`onreadystatechange`每当您的请求的 readyState 更改时都会触发。更改`readyState`为后，`done`您可以检查收到的回复。

确保在打开时以异步模式打开。您不想通过发出同步 http 请求来冻结您的页面。

如果您需要它在旧版本的 IE 上运行，维基百科有一些很好的信息： [http ://en.wikipedia.org/wiki/XMLHttpRequest#Support_in_Internet_Explorer_versions_5.2C_5.5_and_6](http://en.wikipedia.org/wiki/XMLHttpRequest#Support_in_Internet_Explorer_versions_5.2C_5.5_and_6)

我假设您知道如何使用`document.getElementById`和`element.innerHTML`设置元素的内容。

* * *

**编辑** 继续并添加了一个基本实现：

```
if (window.XMLHttpRequest) {// IE7+, Firefox, Webkit, Opera
  window.xmlhttp = new XMLHttpRequest();
} else {// IE6, 5
  window.xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}

xmlhttp.onreadystatechange = function() {
  if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
     document.getElementById("someId").innerHTML = xmlhttp.responseText;
  }
}

xmlhttp.open("GET", "pageUrl", true);
xmlhttp.send(); 
```

# php - 发送电子邮件类型

> ID：10678236
> 
> 赞同：-1
> 
> 时间：2012-05-21T00:02:46.260
> 
> 标签：php, html, codeigniter

这是我发送电子邮件的发送电子邮件功能，但是我有两种不同类型的电子邮件（txt、html）。问题是，当它发送到我的雅虎地址时，它发送的 html 很好，但它显示的是 html 代码而不是渲染它。我该如何解决。

```
/**
* Send email message of given type (activate, forgot_password, etc.)
*
* @param       string
* @param       string
* @param       array
* @return      void
*/
function sendEmail($template, $type, $subject, $userData)
{
    $this->ci->load->library('email');
    $this->ci->email->from('kowmanagement@kansasoutlawwrestling.com', 'Kansas Outlaw Wrestling');
    $this->ci->email->reply_to('kowmanagement@kansasoutlawwrestling.com', 'Kansas Outlaw Wrestling');
    $this->ci->email->to($userData['email']);
    $this->ci->email->subject($subject);
    $this->ci->email->message($this->ci->load->view($template .'/email/'.$type.'-html', $userData, TRUE));
    $this->ci->email->set_alt_message($this->ci->load->view($template .'/email/'.$type.'-txt', $userData, TRUE));
    $this->ci->email->send();
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T01:30:33.817

试试**PHPMailer**，它功能强大且完整。

# mongodb - MongoDB share-nothing slaves

> ID：10678241
> 
> 赞同：2
> 
> 时间：2012-05-21T00:03:58.303
> 
> 标签：mongodb, caching, amazon-ec2, distributed, database

我想使用 mongodb 将缓存数据库分发到一些分布式工作节点，我将在 EC2 中按需启动。当一个节点启动时，mongo 的本地副本应该连接到数据库的主副本（例如 mongomaster.mycompany.com）并下载数据库的新副本。它应该继续从主节点复制更改，直到节点关闭并从池中释放。

要求是主节点不需要知道每个单独的从节点被启动，从节点也不应该知道主节点之外的其他节点（mongomaster.mycompany.com）。

从站应该是只读的，主站将是唯一接受写入的节点（并且永远不会来自这些 ec2 节点之一）。

我研究了副本集，这似乎是不可能的。我以前用主/从设置做过类似的事情，但它不可靠。主/从复制容易发生突然的灾难性故障。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:26:01.850

关于副本集：虽然我不认为您可以拥有一个对主节点（和其他节点）不可见的集合成员，但由于需要复制，您*可以*定制一个特定节点以非常接近您想要的：

*   将新启动的节点设置为优先级 0（意味着它不能成为主节点）
*   将新启动的节点设置为“隐藏”

以下是有关[优先级 0](http://docs.mongodb.org/manual/administration/replica-sets/#replica-set-node-priority-configuration)和[隐藏](http://docs.mongodb.org/manual/administration/replica-sets/#replica-set-hidden-configuration)节点的更多信息的链接。

# c# - 开发抽象语法树

> ID：10678242
> 
> 赞同：15
> 
> 时间：2012-05-21T00:04:01.307
> 
> 标签：c#, abstract-syntax-tree

我在互联网上搜索了一些关于开发 C# 抽象语法树的新手信息，但我只能找到已经“知道”的人的信息。我是一名业务线应用程序开发人员，所以像这样的主题有点过头了，但这是为了我自己的教育，所以我愿意花时间学习任何必要的概念。

通常，我想了解从代码字符串开发代码的抽象表示背后的技术。更具体地说，我希望能够使用这个 AST 来做 C# 语法高亮。（我意识到语法高亮不需要 AST，但这似乎是学习一些“编译器”级技术的好机会。）

如果这个问题有点宽泛，我深表歉意，但我不知道还能问什么。

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-21T01:21:19.017

首先你需要了解什么是解析，什么是抽象语法树。为此，您可以先查阅[有关抽象语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)的维基百科。

您确实需要花一些时间阅读编译器教科书，以了解抽象语法树如何与解析相关，并且可以在解析时构建；经典参考是 Aho/Ullman/Sethi 的“编译器”一书（很容易在网上找到）。[您可能会找到关于是否有任何“有趣”的方式来学习语言、语法、解析和编译器](https://stackoverflow.com/q/5739133/120163)的答案？有指导意义。

一旦您了解了如何为简单语法构建 AST，您就可以将注意力转向 C# 之类的东西。这里的问题是规模庞大。玩一种有 20 条语法规则的玩具语言是一回事。使用数百或一千条规则的语法是另一回事。经验会让小人物更容易理解大人物是如何组合在一起的，以及如何与他们相处。

您可能不想构建自己的 C# 语法（或实现 C# 标准的语法）；它的工作量很大。您可以获得可用的工具来为您提供 C# AST（Roslyn 已经被提及；ANTLR 有一个 C# 解析器，还有更多）。

确实，您可能会使用 AST 来突出显示语法（尽管这可能会用大锤杀死一个小虫子）。大多数人并没有考虑太多（但编译器书籍强调），是在您拥有 AST 之后会发生什么；大多数情况下，它们本身并没有用。你实际上需要更多的机器来做任何有趣的事情。与其一遍又一遍地重复这一点（我一直看到同样的问题），你可以查看我[在解析后的生活](http://www.semanticdesigns.com/Products/DMS/LifeAfterParsing.html)中的讨论以获取更多详细信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-13T14:37:34.187

你可能应该看看 Phil Trelford 的这个演讲：

[24小时编写自己的编译器](https://www.youtube.com/watch?v=iOEHgBL_GmA "在 24 小时内编写您自己的编译器")

这个人是个天才，会让你兴奋地学习编译器。他从字面上简单地解释了它，足以让一个五岁的孩子理解。有问题的五岁是他的儿子，所以可能有不公平的优势，但五岁就是五岁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T00:07:48.343

看看罗斯林。我认为这可能是您正在寻找的东西。它使您可以访问编译器 AST，以及许多其他令人惊奇的东西！

[http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx)

除此之外，我建议一本关于编译器的教科书。

# pycharm - pycharm ctrl pageup/pagedown 在打开的文件之间切换

> ID：10678245
> 
> 赞同：2
> 
> 时间：2012-05-21T00:04:46.503
> 
> 标签：pycharm

我正在尝试使用 ctrl+pageup 或 ctrl+pagedown 在 pycharm 中打开的文件之间跳转。

我试图在 pycharm 中做到这一点 - 没有骰子。这*可能*是因为我切换到“eclipse 键”。有什么想法可以说服 pycharm 让我这样做吗？目前它什么都不做

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T06:51:28.307

打开**设置 | 键盘映射**部分，创建所选键盘映射的副本（如果它是预定义的）并重新分配“选择下一个选项卡”和“选择上一个选项卡”操作。

希望能帮助到你。

# java - 以下简单查询未完成。准备好的声明

> ID：10678246
> 
> 赞同：1
> 
> 时间：2012-05-21T00:04:52.217
> 
> 标签：java, sql-server, jdbc, prepared-statement

我有以下查询：

```
String updatequery = "UPDATE tbl_page SET linkCount = ?, pageProcessed = 1 WHERE pageUrl =?";
PreparedStatement updatestmt = kon.prepareStatement(updatequery);
updatestmt.clearParameters();
//updatestmt.setQueryTimeout(10);
updatestmt.setInt(1, linkCount);
updatestmt.setString(2, urlLink);
updatestmt.executeUpdate(); 
```

当我将查询超时设置为 10 秒时，它将捕获查询超时的异常。但是当我不这样做时，它会继续等待。查询有什么问题？`pageUrl`列是主键`varchar(900)`

我知道准备好的语句可能有问题，因为当我在 MS SQl Server Management Studio 中运行此查询（“？”替换为它的值）时，它工作正常。

我是否缺少 Java 或 MSSQL 中的某些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T08:48:36.223

由于代码看起来很好，这可能是数据库方面的问题。可能是其他人通过更新它而不是执行提交/回滚来阻止该行（很可能来自您的 MS-SQL Server 管理工作室！）。您可以为同一记录查找其他进程拥有的锁，以便确定这不是数据库问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:17:05.703

在 pageUrl 上创建索引：

```
create index tbl_page_pageUrl_index on tbl_page(pageUrl); 
```

这将允许快速访问您要更新的行。

如果没有此索引，数据库必须进行全表扫描，并且当与`update`命令结合使用时，是否可能导致锁争用甚至死锁，具体取决于您的锁定选项。

# android - 如何在android中加速缩放

> ID：10678247
> 
> 赞同：2
> 
> 时间：2012-05-21T00:05:17.540
> 
> 标签：android, scaling, android-canvas

嘿，我需要在我的应用程序中缩放位图，但是缩放工作太慢，有时我会在相反的方向上得到这些随机缩放事件。这是我的ondraw方法：

```
public void onDraw(Canvas canvas) {
        mBitmap = BitmapFactory.decodeResource(getResources(),
            R.drawable.ucsbmap);
        canvas.drawBitmap(mBitmap, matrix, mPaint);    
} 
```

和我的 onScale 方法（处理我的位图缩放的 SimpleOnScaleGestureListener 的一部分）

```
 public boolean onScale(ScaleGestureDetector detector) {      
          float scaleFactor = detector.getScaleFactor();
          float x = detector.getFocusX();
          float y = detector.getFocusY();
          matrix.setScale(scaleFactor, scaleFactor, x, y);
          repaint();
          return true;
     } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:31:12.600

这个问题在缩放中并不实际。您在方法中访问磁盘 ( `BitmapFactory.decodeResource`) `onDraw`- 这真的很慢。

将以下代码移至构造函数：

```
mBitmap = BitmapFactory.decodeResource(getResources(),
            R.drawable.ucsbmap); 
```

# php - 将用户 ID 值插入消息表中，其中用户部门 = Division.divisionid

> ID：10678248
> 
> 赞同：0
> 
> 时间：2012-05-21T00:05:24.463
> 
> 标签：php, mysql, insert, while-loop

如何在我的消息表中为 users.MM_Division = Division.divisionid 的每个 user.ID 插入表条目

我想在 messages.messagesuserid 中插入用户 ID 值

我想我需要一个while循环，但我不确定在处理插入查询时如何实现它。

目前，只有 1 条消息行被插入到消息表中的消息用户 ID 值帖子为 NULL

谢谢

这是我的代码：

```
session_start();

$colname_division = "-1";
if ((isset($_GET['divisionid'])) && ($_GET['divisionid'] != "")) {
      $colname_division = $_GET['divisionid'];

mysql_select_db($database_connect, $connect);
$query_users = sprintf("SELECT users.*, division.* FROM users INNER JOIN division ON division.divisionid = users.MM_Division WHERE divisionid = %s", GetSQLValueString($colname_users, "int"));
$users = mysql_query($query_users, $connect) or die(mysql_error());
$row_users = mysql_fetch_assoc($users);
$totalRows_users = mysql_num_rows($users);

// MESSAGE USERS DIVISION ARCHIVED
    $messageinsertSQL = sprintf("INSERT INTO messages (message, messageuserid) VALUES ('The division " . $row_division['division'] . " has been archived by " . $_SESSION['MM_Username'] . " please select a new division', '" . $row_users['ID'] . "')",GetSQLValueString($_GET['divisionid'], "int")); 
    mysql_select_db($database_connect, $connect);
    $Result4 = mysql_query($messageinsertSQL, $connect) or die(mysql_error());

// REDIRECT
    $updateGoTo = "../divisions.php";
        if (isset($_SERVER['QUERY_STRING'])) {
            $updateGoTo .= (strpos($updateGoTo, '?')) ? "&" : "?";
            $updateGoTo .= $_SERVER['QUERY_STRING'];
        }
    header(sprintf("Location: %s", $updateGoTo));

    mysql_free_result($division);
    exit;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T13:24:07.200

用以下内容包裹该`message users division archived`部分：

```
while (($row_users = mysql_fetch_assoc($users)) !== false) {
 $messageInsert = ...
 [...]
} 
```

然后你需要删除`$row_users = mysql_fetch_assoc($users)`之前使用的。

顺便说一句，如果某些列具有相同的名称（来自用户和部门），我不确定它们是否不会被覆盖`$query_users =`。`$colname_users`此外，该行在函数中有错误的参数`GetSQLValueString()`（不应该是`$colname_division`？或者你在其他地方声明它？）。

# python - 使用相同的 django 表单编辑/添加对象

> ID：10678249
> 
> 赞同：3
> 
> 时间：2012-05-21T00:05:39.887
> 
> 标签：python, django

我已经使用了[这个问题](https://stackoverflow.com/questions/1854237/django-edit-form-based-on-add-form)的答案，但由于某种原因，我没有得到好的结果。

我正在尝试为我的编辑表单和我的添加表单使用相同的模板。这是我的`urls.py`：

```
url(r'^app/student/new/$', 'edit_student', {}, 'student_new'),
url(r'^app/student/edit/(?P<id>\d+)/$', 'edit_student', {}, 'student_edit'), 
```

我的`views.py`：

```
def edit_student(request, id=None, template_name='student_edit_template.html'):
if id:
    t = "Edit"
    student = get_object_or_404(Student, pk=id)
    if student.teacher != request.user:
        raise HttpResponseForbidden()
else:
    t = "Add"
    student = Student(teacher=request.user)

if request.POST:
    form = StudentForm(request.POST, instance=student)
    if form.is_valid():
        form.save()

        # If the save was successful, redirect to another page
        redirect_url = reverse(student_save_success)
        return HttpResponseRedirect(redirect_url)

else:
    form = StudentForm(instance=student)

return render_to_response(template_name, {
    'form': form,
    't': t,
}, context_instance=RequestContext(request)) 
```

我的`forms.py`：

```
class StudentForm(ModelForm):
class Meta:
    model = Student
    exclude = ('teacher',) 
```

最后是我的模板`student_edit_template.html`：

```
<h1>{{ t }} Student</h1>
<form action="/app/student/edit/{{ student.id }}" method="post"> {% csrf_token %}
{{ form.as_p }}
<input type="submit" value="Submit" />
</form> 
```

出于某种原因，这是抛出 404：

```
Page not found (404)
Request Method: POST
Request URL:    http://192.168.1.3:5678/app/student/edit/ 
```

我可能在这里遗漏了一些简单的东西，但在这一点上，我至少需要另一双眼睛。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:38:15.430

您获得 404 是因为`/student/edit/`在尾部需要一个 id，否则没有路线，并且当您来自时，`/student/new/`您还没有 id。`/student/edit/`为在 POST 上创建记录时创建路由和视图并将逻辑放入其中以处理这种情况。

# c - 一项任务要求我收集一个带有 2 个 scanf 的名称

> ID：10678252
> 
> 赞同：1
> 
> 时间：2012-05-21T00:06:12.810
> 
> 标签：c, scanf, strcat, do-loops

所以这是我的第一个 C 语言超初学者计算机编程问题。

我需要进行设置，以便有人可以在输入中输入他们的全名。这是规格的一部分-

> “你需要做一些思考才能弄清楚如何让打印的名称与所有其他列对齐。第一个提示是它涉及将字符串连接在一起，称为连接。试一试，如果你想不通，看看这个文件夹中的下一个文档；它包含额外的提示。这个作业的部分目的是隐含地教你连接。不要使用制表符 (\t) 并确保你的 C/C++编辑器不产生制表符。
> 
> 不要在这个程序中使用gets()。使用 scanf() 输入交互信息。如果您尝试使用gets()，您可能会非常沮丧。
> 
> 本质上，报告中出现的所有数字都应右对齐和小数对齐。摘要中出现的所有数字都应不带前导空格（通常将数字与前一个单词分开的空格除外）。小时工资金额可以小于 10.00，因此请务必小心格式化。示例输出可能看起来正确，但如果事情与 10.00 美元以下的小时工资不相符，您仍然可能会被扣半分。” 其他提示：
> 
> *   您可以假设员工姓名始终是两个名字，一个名字和一个姓氏，用空格分隔。还假设在名字或姓氏中从来没有任何空格。这允许您使用两个 scanf() 调用而不是一个 gets() 调用。gets() 会引入一些奇怪的东西，使事情在以后无法正常工作。
>     
>     
> *   您还可以假设两个名称的长度都不超过 10 个字符。
>     
>     
> *   来自流程另一个员工的输入？question应该是单个字符。假设 N 或 n 将停止循环，但任何其他字符将继续循环。

有人知道怎么做吗？当我使用gets（他说不要这样做）时，循环会在第二次出现问题，它会在一行中询问姓名和薪水。如果我尝试使用 2 个 scanf 语句，我会崩溃或只有 1 个名称输入。

我在想唯一的方法是将名称输出到文本文件，然后再次读取它们。但是还有其他方法吗？我不允许单独询问姓名。正如规范中所说，用户可能会键入带有一个空格的全名。

这是我到目前为止编写的代码。我还需要所有总时间、加班时间和正常时间的总计。

```
//stupid program

#include <stdio.h>
#include <strings.h>
#include <math.h>

//global variables

FILE *reportfile;   //output file
char department[21];
int count;
char name[21];
float hoursworked;
float hourlywage;
float overtimehoursworked;
float overtimehourlywage;
float gross;
char again;
char firstname;
char lastname;
float tothoursworked;
float totovertimehoursworked;
float totgross;

const float overtimerate = 1.5;
const float overtimethreshold = 40; //hours needed to get overtime

//function prototypes

void GetInfo(void);
void Finalreport(void);

//main

int main(void)
{

   reportfile = fopen("c:\\class\\kpaul-pay.txt","w");  //open output file

    //////////////////////////////////////////////////
     //        initialize accumulating variables
     /////////////////////////////////////////////////

     count = 0;
     tothoursworked = 0;
     totovertimehoursworked = 0;
     totgross = 0;

   GetInfo();

   fclose(reportfile);         //close output file

return 0;

}

void GetInfo (void)
{
    printf("Mountain Pacific Corporation\n");
    printf("Department Salary Program\n\n");
    printf("Please enter the name of the department: ");
    gets(department);
    fprintf(reportfile, "Mountain Pacific Corporation\n");
    fprintf(reportfile, "Department Salary Program\n\n");
    fprintf(reportfile, "%s\n\n", department);
    fprintf(reportfile, "Employee                Reg Hrs        Overtime Hrs                      Gross\n");
    fprintf(reportfile, "-----------------------------------------------------------------\n");

    do {

   printf("\nEnter employee #1: ");
   gets(name);

   printf("Enter the hourly wage of %s", name);
   scanf("%f", &hourlywage);

   printf("\nEnter total number of hours: ");
   scanf("%f", &hoursworked);

   if (hoursworked<=overtimethreshold)
    overtimehoursworked = 0;

   else if (hoursworked > overtimethreshold)
   overtimehoursworked = hoursworked - overtimethreshold;

   gross = (hoursworked*hourlywage) + (overtimehoursworked*overtimehourlywage);

       fprintf(reportfile, "%s%16.2f(%4.2f)%12.2f(%4.2f)    $%7.2f", name, hoursworked,     hourlywage, overtimehoursworked, hourlywage * overtimerate, gross);

       tothoursworked = tothoursworked + hoursworked;
       totovertimehoursworked = totovertimehoursworked +overtimehoursworked;
       totgross = totgross + gross;

      printf("\n");
      printf("Would you like another conversion? ");
      scanf ("%s", &again);

      printf("\n\n");

   } while (again!='N' && again!='n');

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:24:55.440

需要小心使用`scanf`格式字符串。`%s`表示由空格分隔的字符串，用非技术术语来说，`scanf`将读取字符，直到找到空格字符，例如制表符或空格。

这给读取多个单词带来了问题，这可以通过`%s`在格式字符串中使用 multiple 来解决，您必须在格式字符串之后为每个单词提供一个单独的数组作为参数，例如

```
scanf("%s%s%s", string1, string2, string3) 
```

此`scanf`调用需要来自用户的三个单词，其中每个单词由空格分隔。确保为每个数组分配了内存，否则您将写入程序通常不拥有的内存，从而导致程序崩溃。可以通过在格式字符串中`scanf`多次使用单个来实现与上述代码完全相同的效果。`%s`

如果您需要将所有内容作为一个字符串，则可以使用相同的数组`strcat`，它将两个字符串连接在一起。该函数使用简单，但再次确保在调用之前为您的参数分配数组，`strcat`否则可能会导致崩溃或意外行为。

以下是对这两个函数的引用：

`scanf`- [http://www.cplusplus.com/reference/clibrary/cstdio/scanf/](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)

`strcat`- [http://www.cplusplus.com/reference/clibrary/cstring/strcat/](http://www.cplusplus.com/reference/clibrary/cstring/strcat/)

希望这会有所帮助=]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:17:49.653

`scanf`with 格式`%s`将接受以空格分隔的字符串。

崩溃很可能是由于输入字符串溢出（或未能为输入字符串保留空间）引起的。

# php - 使用 PHP 添加 Facebook Open Graph Read Action

> ID：10678259
> 
> 赞同：0
> 
> 时间：2012-05-21T00:07:31.893
> 
> 标签：php, facebook, facebook-graph-api, curl

我正在尝试让 Facebook 使用 PHP 发布读取操作。我的编码完全错误，需要一点帮助：

```
<?php    
function curPageURL() {
 $pageURL = 'http';
 if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
 $pageURL .= "://";
 if ($_SERVER["SERVER_PORT"] != "80") {
  $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
 } else {
  $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
 }
 return $pageURL;
}
?>

<?php

curl -F 'access_token=MY ACCESS TOKEN' \
     -F 'article=echo 'echo curPageURL();' \
        'https://graph.facebook.com/me/news.reads'

?> 
```

第二部分是我无法正确翻译成 PHP 的那一点。我不知道从哪里开始，因为我是 PHP 新手，只是学习 Open Graph API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:30:40.457

看看 PHP 中的 cURL 函数。

[http://us3.php.net/manual/en/ref.curl.php](http://us3.php.net/manual/en/ref.curl.php)

那应该有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:29:40.137

我建议您使用 Facebook PHP SDK [https://developers.facebook.com/docs/reference/php/](https://developers.facebook.com/docs/reference/php/)，它是由 Facebook 开发的，用于提供对其 API 的访问，并为您管理 cURL 连接。

# node.js - 你可以使用 Lua 脚本来让 Redis 抛出事件吗？

> ID：10678263
> 
> 赞同：0
> 
> 时间：2012-05-21T00:07:59.943
> 
> 标签：node.js, lua, redis, node-redis

我正在尝试创建一个抽象，我可以在其中侦听 redis 集合的更改事件并将键、值传递给回调。我想知道是否可以在新版本上使用 Lua 脚本来执行此操作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T23:33:54.030

You can certainly publish events from Lua scripts, and you could certainly poll. The right way to solve your problem would be to publish to a pubsub channel every time you change the set.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:57:50.933

不，你不能。

由于 Redis 是单线程的，因此您的 lua 脚本必须快速返回。监听事件的变化需要一个长时间运行的过程，而 lua 脚本并不是为该用例设计的。

看看我对你其他问题的回答——[听听redis的变化](https://stackoverflow.com/a/10679002/242940)

# java - 将方法添加到 Android 复制/粘贴全局上下文菜单中？

> ID：10678264
> 
> 赞同：5
> 
> 时间：2012-05-21T00:08:20.080
> 
> 标签：java, android

在 Android 的文本框上，onLongClick 显示一个包含复制/粘贴方法的上下文菜单。有没有办法添加另一个选项（例如，“复制到 [在此处插入应用程序]”）？

在我的应用程序的上下文菜单中执行此操作很简单，因为我可以覆盖 onLongClick。但是，我的“复制到 [在此处插入应用程序]”方法只能在我的应用程序的上下文菜单中使用；例如，不在默认消息的文本选择上下文菜单中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:17:16.663

不，您不能添加到其他应用程序的上下文菜单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:20:28.103

不，这是不可能的。有关详细信息，请参阅有关[复制和粘贴](http://developer.android.com/guide/topics/clipboard/copy-paste.html)的文章。

# wpf - 获取文本框值

> ID：10678270
> 
> 赞同：0
> 
> 时间：2012-05-21T00:09:29.030
> 
> 标签：wpf

如果我开始我的表单，在我的文本框中写一些东西，然后尝试获取文本框的值，那么我会得到空值。如何获取文本框值？如果我添加一个按钮并尝试获取值，那么它就可以工作。但我试图在没有按钮的情况下做到这一点。我正在使用 WPF 表单。这是我的代码：

```
public partial class _2band : Page
{
    public _2band()
    {
        InitializeComponent();
        UpdateLayout();
        RFIDI();
        vardasBox1.Text = "";
        dispatcherTimer = new System.Windows.Threading.DispatcherTimer();
        dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick);
        dispatcherTimer.Interval = new TimeSpan(0, 0, 1);
        dispatcherTimer.Start();

    }
    // MainWondow mainas = new MainWondow();
    DB db = new DB();

    string pavad;
    string vardas;

    int status;
    string s = "";
    string s0 = "";

    RfidApi Api = new RfidApi();
    private System.Windows.Threading.DispatcherTimer dispatcherTimer;
    private void dispatcherTimer_Tick(object sender, EventArgs e)
    {
        Api.nuskaitymas(out s0);
        if (s0 != null)
        {
            s = s0;
            vardas = vardasBox1.Text;
        }
    } 
```

# javascript - 如何访问 Wikipedia API 返回的 JSON 中的嵌套对象

> ID：10678274
> 
> 赞同：0
> 
> 时间：2012-05-21T00:09:40.483
> 
> 标签：javascript, jquery, json

从这个查询到 Wikipedia API：

`http://en.wikipedia.org/w/api.php?action=query&prop=links&format=json&plnamespace=0& pllimit=10&titles=List%20of%20television%20programs%20by%20name`

我得到一个 JSON 结构，例如：

```
var data = {
  "query": {
    "pages": {
      "1536715": {
        "pageid": 1536715,
        "ns": 0,
        "title": "List of television programs by name",
        "links": [
          {
            "ns": 0,
            "title": "$1.98 Beauty Show"
          },
          {
            "ns": 0,
            "title": "''Dance Academy''"
          }
        ]
      }
    }
  },
  "query-continue": {
    "links": {
      "plcontinue": "1536715|0|15\/Love"
    }
  }
} 
```

我想使用`"links"`数组的元素。但是，基于 element 的存在`"pageid": 1536715`，我怀疑嵌套对象的名称`"1536715"`是一个动态值，可能会发生变化。我不愿意使用此名称来访问“链接”数组，例如`query.pages.1536715.links`.

有没有办法“跨过”这个对象，即使用通配符`query.pages.*.links`？如果做不到这一点，我可以迭代 的孩子`pages`来获得这个对象吗？我在这个项目中使用 jQuery 1.7.2，以防你可以从那里提出任何有用的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:12:22.993

这应该能让你到达那里......

```
var links, i, pageID;

for (pageID in query.pages) {
    links = query.pages[pageID].links;
    for (i=0; i<links.length; i++) {
        link = links[i];
        link.ns; link.title // handle link obj here.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:15:52.027

是的，您需要遍历它。另请参阅非常类似的问题[parse json string from wikimedia using jquery](https://stackoverflow.com/q/10196222/1048572)。[`indexpageids`您还可以使用参数](http://www.mediawiki.org/wiki/API:Query#Getting_a_list_of_page_IDs)接收结果 pageid 列表。

```
if (data && data.query && data.query.pages)
    var pages = data.query.pages;
else
    // error: No pages returned / other problems!
for (var id in pages) { // in your case a loop over one property
    var links = pages[id].links
    if (links)
        for (i=0; i<links.length; i++) {
            // do what you want with links[i]
        }
    else
        // error: No links array returned for whatever reasons!
} 
```

# php - 我可以使用继承的方法递归地调用从子到父的方法吗？

> ID：10678280
> 
> 赞同：2
> 
> 时间：2012-05-21T00:10:57.987
> 
> 标签：php

有很多子类调用重写父方法的示例，最常见的是`parent::__construct()`. 然而，在这些情况下，您实际上是从子进程本身的具体方法调用父进程。

有没有一种方法可以使用继承的方法递归地从孩子调用一个方法到第一个祖先？

如果我`parent::methodName()`在我的抽象父类中使用它会导致一个致命错误说“当当前类范围没有父级时无法访问父级::”。大概这是因为“父”是相对于抽象类本身而不是当前类上下文进行评估的。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:20:40.500

我不太确定您要做什么，但是：

1.  `parent`关键字是相对于它出现的类进行评估的。如果你使用关键字的类没有`parent`父类，它显然不起作用。
2.  如果您希望孩子使用父母的方法，只需不要在孩子中覆盖该方法。在父级中定义一个强制子级调用父级方法的方法是没有意义的，而您需要做的只是不覆盖子级中的方法。
3.  您可以通过设置方法来强制父方法成为“最后一句话” `final`，孩子将无法覆盖它。
4.  一个孩子不能调用“祖父母”的方法，因为孩子不知道，或者至少不能保证，它的父母依次有一个父母。

实际上，这意味着：

1.  如果您正在编写一个没有`extend`另一个类的类，那么在其中的任何地方使用都是没有意义的`parent`。
2.  如果您正在`extend`创建一个类并且没有覆盖方法，则将自动使用父方法（它是*继承*的）。
3.  如果您正在`extend`编写一个类并覆盖一个方法，您可以`parent`从该覆盖的方法调用 ' 方法，而后者又*可以*调用其`parent`' 方法等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:45:21.067

也许是这样的？（未经测试）

```
foreach (get_class_parents($this) as $className) {
    (new ReflectionMethod($className, __METHOD__))->invoke($this, $args...);
} 
```

当我在代码中看到这种垃圾时，我讨厌。

# iphone - 我可以使用 UIViews 来管理大量动画精灵吗？还是坚持使用 CALayers 更好？

> ID：10678289
> 
> 赞同：1
> 
> 时间：2012-05-21T00:12:48.953
> 
> 标签：iphone, ios, performance, uiview, calayer

这是我在 Stack Overflow 上的第一个问题。我正在为 iPhone 制作一个以专栏为灵感的游戏，这是我在 iPhone 上的第一个严肃项目。我选择使用 CALayers 来实现它，它看起来是个不错的选择，图层很简单，并且没有 UIviews 的不必要的（为此目的）小工具。

遗憾的是，我最近才发现 CALayers 还不支持过滤器和混合选项，至少官方不支持。我已经阅读了许多关于 UIViews 和 CALayers 之间性能差异的问题，但似乎我找不到明确的答案。

在我的游戏中，它可能碰巧有多达 140 个非透明精灵（70 个静态精灵，每个都有动画覆盖）在某些条件下在屏幕上移动，并带有碰撞和一些物理特性。CALayers 的性能非常好，大量移动精灵似乎对性能的影响很小，在最坏的情况下我设法达到了 30 fps，瓶颈是物理。

我唯一觉得缺乏的是混合效果。

在这一点上，OpenGL 对我来说几乎不是一个选择。据我所知，我会使用 UIViews 混合效果，我担心的是性能，我读过 UIViews 不应该与大量精灵一起使用，尤其是在我的情况下频繁更新的情况下。

值得一试吗？有什么建议可以在图层上添加效果吗？

# java - N路归并排序一个2G的字符串文件

> ID：10678302
> 
> 赞同：9
> 
> 时间：2012-05-21T00:15:10.840
> 
> 标签：java, algorithm, sorting

这是破解编码面试中的另一个问题，我看完后仍然有些疑问。

```
9.4 If you have a 2 GB file with one string per line, which sorting algorithm 
    would you use to sort the file and why? 
```

解决方案

当面试官给出 2GB 的大小限制时，它应该告诉你一些事情——在这种情况下，它表明他们不希望你将所有数据都带入内存。那么我们该怎么办？我们只将部分数据带入内存。算法：

我们有多少内存可用？假设我们有 X MB 可用内存。

1.  将文件分成 K 个块，其中 X * K = 2 GB。将每个块放入内存并像往常一样使用任何 O(n log n) 算法对行进行排序。将这些行保存回文件。

2.  现在将下一个块放入内存并排序。

3.  完成后，将它们一一合并。

上述算法也称为外部排序。第 3 步称为 N 路合并 使用外部排序的基本原理是数据的大小。由于数据太大，我们无法将其全部放入内存，因此我们需要使用基于磁盘的排序算法。

怀疑：

在第 3 步进行归并排序时，在比较 2 个数组时，每次比较是否需要 2*X 空间？限制是 X MB。我们应该把块做成 (X/2)*2K = 2GB 吗？这样每个块将是 X/2 MB 并且将有 2K 块。或者我只是理解合并排序错误？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T00:52:26.893

[http://en.wikipedia.org/wiki/External_sorting](http://en.wikipedia.org/wiki/External_sorting)

快速浏览一下 Wikipedia 告诉我，在合并过程中，您永远不会在内存中保存一整块。所以基本上，如果你有 K 个块，你将有 K 个打开的文件指针，但在任何给定时间你只会在内存中的每个文件中保留一行。您将比较内存中的行，然后将最小的行（例如，块 5）输出到排序文件（也是打开的文件指针，不在内存中），然后用该文件中的下一行覆盖该行（在我们的示例中，将文件 5) 放入内存并重复，直到到达所有块的末尾。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T00:50:54.600

首先，第 3 步本身不是归并排序，整件事*是*归并排序。第 3 步只是一个合并，根本不涉及排序。

至于所需的存储空间，有两种可能。

第一种是将排序后的数据以两个为一组进行合并。假设您有三组：

```
A: 1 3 5 7 9
B: 0 2 4 6 8
C: 2 3 5 7 
```

使用该方法，您将合并`A`并`B`进入一个组`Y`，然后合并`Y`并`C`进入最终结果`Z`：

```
Y: 0 1 2 3 4 5 6 7 8 9         (from merging A and B).
Z: 0 1 2 2 3 3 4 5 5 6 7 7 8 9 (from merging Y and C). 
```

这具有非常小的恒定内存需求的优点，因为您只需要存储两个列表中的每一个中的“下一个”元素，但是，当然，您需要执行多个合并操作。

第二种方式是“适当的”N 向合并，您可以从*任何*组中选择下一个元素。这样，您将检查每个列表中的最低值，以查看下一个：

```
Z: 0 1 2 2 3 3 4 5 5 6 7 7 8 9 (from merging A, B and C). 
```

这仅涉及一次合并操作，但需要更多存储空间，基本上每个列表一个元素。

您选择哪一个取决于可用内存和元素大小。

例如，如果您有 100M 可用内存并且元素大小为 100K，则可以使用后者。这是因为，对于一个 2G 文件，排序阶段需要 20 个组（每个 100M），这意味着适当的 N 路合并将需要 100K x 20，或大约 2M，这远远低于您的内存可用性。

或者，假设您只有 1M 可用。这将是大约 2000 (2G / 1M) 组，将其乘以 100K 得到 200M，远远超出您的容量。

所以你必须在多遍中进行合并。请记住，它不一定是合并*两个*列表的多次传递。

您可以找到一个中间地带，例如，每个通道合并十个列表。十组 100K 只是一个兆，因此将适合您的内存限制，这将导致更少的合并通过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T00:49:31.483

合并过程比这简单得多。您会将它们输出到一个新文件，但基本上您只需要*恒定*内存：您只需一次从两个输入文件中的每一个中读取一个元素。

# python - pywin32 TOKEN_PRIVILEGES

> ID：10678308
> 
> 赞同：1
> 
> 时间：2012-05-21T00:16:07.533
> 
> 标签：python, service, pywin32, winlogon

所以这就是问题所在：我正在尝试创建一个服务来启动另一个 exe 以在 Windows 的登录屏幕上显示 GUI。顶部的樱桃：我希望在 python 中实现它。经过一番谷歌搜索，我发现了这个：[在 Windows 7 欢迎屏幕上运行一个进程](https://stackoverflow.com/questions/3070152/running-a-process-at-the-windows-7-welcome-screen)。所以我继续使用 pywin32 几乎完全转换它，但有一个问题：我无法制作 PyTOKEN_PRIVILEGES 对象。与其他对象不同，有一个实例化它的函数，但这个似乎没有任何 ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T13:53:58.200

win32security.AdjustTokenPrivileges 将接受 TOKEN_PRIVILEGES 参数的 2 元组序列。有关示例，请参见 win32\Demos\security\set_file_audit.py。这也记录在 Pywin32 附带的帮助文件中。

# javascript - Javascript 绑定函数到 Ajax 加载事件

> ID：10678309
> 
> 赞同：2
> 
> 时间：2012-05-21T00:16:12.243
> 
> 标签：javascript, jquery, ajax, twitter

我正在尝试编写一个与 Twitter 页面交互的 chrome 扩展，但是当 twitter 流准备好时我很难启动该功能，因为它是在文档准备好后动态加载的。

如何将函数绑定到正在加载的元素或元素的某种通用 ajax 成功响应。

当前代码。 [https://github.com/billpull/Twitter-Ticker](https://github.com/billpull/Twitter-Ticker)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:23:32.803

您可以查看[`.ajaxSuccess`](http://api.jquery.com/ajaxSuccess/)，它是一个全局处理程序，在 ajax 调用成功时执行（假设 ajax 调用是通过 完成的`.ajax`）。

# c# - 如何使用 OpenXml SDK 2.0“从文件中插入文本”

> ID：10678310
> 
> 赞同：1
> 
> 时间：2012-05-21T00:16:20.217
> 
> 标签：c#, openxml, openxml-sdk

使用 Word 2010 GUI，有一个“从文件中插入文本...”选项，这正是这样做的：它将文档主要部分中的文本插入到文档中的当前位置。

我想使用 C# 和 OpenXml SDK 2.0 做同样的事情

```
using (var mainDocument = WordprocessingDocument.Open("MainFile.docx", true);
{
    var mainPart = mainDocument.MainDocumentPart;
    var bookmarkStart = mainPart
                        .Document
                        .Body
                        .Descendants<BookmarkStart>()
                        .SingleOrDefault(b => b.Name == "ExtraContentBookmark");
    var extraContent = GetTextFromFile("ExtraFile.docx");

    bookmarkStart.InsertAfterSelf(extraContent);
} 
```

我尝试过使用普通 Xml (XElement)、使用 OpenXmlElement (MainDocumentPart.Document.Body.Descendants) 和使用 AltChunk。到目前为止，每个替代方案都产生了不符合要求的 docx 文件。

该方法应该是什么`GetTextFromFile`样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T09:41:19.600

这就是我实现它的方式。解决方案是[使用 Eric White 所描述的 AltChunk](http://blogs.msdn.com/b/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx)。我已经尝试过了，但正如布拉德利在回答中所说，书签可能位于文档中的任何位置，而我的位于段落中。一旦我在包含段落之前插入文本，一切正常。

这是（简化的）代码：

```
using (var mainDocument = WordprocessingDocument.Open("MainFile.docx", true);
{
    var mainPart = mainDocument.MainDocumentPart;
    var bookmarkStart = mainPart
                        .Document
                        .Body
                        .Descendants<BookmarkStart>()
                        .SingleOrDefault(b => b.Name == "ExtraContentBookmark");
    var altChunk = GetAltChunkFromFile("ExtraFile.docx", mainPart);

    var containingParagraph = element.Ancestors<Paragraph>().FirstOrDefault();
    containingParagraph.InsertBeforeSelf(altChunk);
}

...

private AltChunk GetAltChunk(string filename, MainDocumentPart mainDocumentPart)
{
    var altChunkId = "AltChunkId1";
    var chunk = mainDocumentPart.AddAlternativeFormatImportPart(
        AlternativeFormatImportPartType.WordprocessingML, altChunkId);
    chunk.FeedData(File.Open(filename, FileMode.Open));
    var altChunk = new AltChunk { Id = altChunkId };
    return altChunk;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:03:59.663

它不像在书签位置插入文档正文标签的后代那么简单。一些原因：

*   两个文档可能使用不同的样式；您必须跨依赖样式进行复制，或更新引用以使用目标文档中的样式。
*   标签几乎可以出现在文档中的`<bookmarkStart>`任何位置，包括段落、运行、表格单元格等。由于您不能嵌套段落或运行，您必须确定书签的位置，然后升序/降序 XML 树直到找到合适的位置插入内容。

使用 OpenXml SDK 时，您尝试做的事情变得相当复杂。它需要对格式及其架构有深入的了解。

我几乎建议改用 VSTO/OLE 自动化，因为它使您能够使用 Word 中内置的功能。

# c# - 在 wpf 页面加载之前获取 sql 值

> ID：10678318
> 
> 赞同：1
> 
> 时间：2012-05-21T00:17:11.273
> 
> 标签：c#, wpf

我有一个 wpf 应用程序，它从数据库中获取信息。当我第一次在默认窗口上加载应用程序时，我有需要由数据填充的文本框，但文本框不会被填充，所以我想知道，我将如何在页面加载之前获取值，然后设置数据的文本框文本属性。我在 try and catch 块中有我的 LINQ to SQL 代码，如下所示：

```
try
{
   MY LINQ TO SQL CODE HERE:
}
catch
{

} 
```

我真的必须这样做，因为如果我不这样做并且只输入 SQL 代码，我会收到超时错误。所以因为我需要这样做，所以我的 sql 代码在页面加载之前没有运行，而是在它加载之后运行。我怎样才能让它在加载窗口之前运行我的代码，这样我就可以设置我的文本框值？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:43:16.810

您可以考虑为此使用[异步绑定](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.isasync.aspx)。它甚至内置于 XAML 语法中，如下所示：

```
<TextBox Text="{Binding Path=MyBinding,IsAsync=True,FallbackValue=Loading...}" /> 
```

现在假设*MyBinding*属性运行您的 SQL：

```
string _myBinding = null;
public string MyBinding {
    get {
        if (_myBinding == null)
        {
            // get value from SQL operation
        }
        return _myBinding;
    }
} 
```

现在您的 TextBox 将显示回退值（“正在加载...”），并且 UI 不会阻塞，而是会在您的 SQL 操作完成时加载。

采用这种方法可能比在 SQL 操作运行时阻塞 UI 更好（用户可能认为您的应用程序被冻结、感到沮丧等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:31:24.400

将查询代码放在实例化窗口时调用的构造函数中。

```
public class myWindow : Window
{
    public myWindow()
    {
         //code here
         InitializeComponent();
    }
} 
```

我建议您在执行查询时显示加载屏幕或类似的东西，如果查询失败，则显示失败屏幕/消息。

# ios - 使用 UIApplication 启动 Safari：OpenURL 不起作用

> ID：10678321
> 
> 赞同：0
> 
> 时间：2012-05-21T00:17:45.177
> 
> 标签：ios

我在这里阅读了几篇关于如何从应用程序中启动 Safari 的文章，这些文章都说要使用 UIApplication:OpenURL: 但这对我不起作用。

我有一个已下载并存储在我的应用程序沙箱中的 .html 页面。我可以在 UIWebView 中启动此页面，但无法启动它，使用以下代码没有任何反应。

```
 NSURLRequest *requestObj = [NSURLRequest requestWithURL:firstPageFullPath];
 [[UIApplication sharedApplication] openURL:[requestObj URL]]; 
```

路径格式为 file://..../page1.html，正如我所提到的，如果我将 requestObj 传递给 UIWebView，它将成功加载。

任何想法为什么它不起作用，Safari只能从具有非本地文件的应用程序启动吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T03:34:43.120

我猜想这意味着文件 URL 会发生这种情况。如果您使用`UIWebView`，该浏览器实例将使用您的应用程序的沙箱（例如，该浏览器实例可用的 cookie 与 Safari 应用程序的 cookie 无关）。如果您使用 Safari，那么您就脱离了沙盒，如果 Apple 允许它像文件浏览器一样使用，Bad Things™ 可能会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T03:45:54.150

Safari 的行为与您自己的沙盒应用程序非常相似——即它无法访问其自己的沙盒之外的文件。因此它无法访问您使用文件 URL 引用的文件，因为该文件位于您的应用程序的沙箱中，而不是 Safari 的沙箱中。您应该将远程 URL 传递给 Safari - 通过将您的 html 放在某处的 Web 服务器上。如果这对您的应用程序来说是不可能/不实用的，那么您将需要继续`UIWebView`在您的应用程序内部使用 - 因为您已经发现它能够访问本地 html 文件。实现您需要的任何其他控件（前进、后退等）以模仿 Safari 的行为。

# php - 找不到类“COM”

> ID：10678325
> 
> 赞同：40
> 
> 时间：2012-05-21T00:18:06.110
> 
> 标签：php, xampp

我一直在尝试在我的脚本中打开一个 word 文档，但我收到了同样的错误。

```
 Fatal error: Class 'COM' not found in /Applications/XAMPP/xamppfiles/htdocs/**/**.php on line 3 
```

我的代码：

```
<?php

$word = new COM("word.application") or die("Unable to instantiate Word"); 

$word->Visible = 1; 

$word->Documents->Open("wordfile.docx");
$temp = $word->Dialogs->Item(228); // returns wdDialogToolsWordCount dialog object
$temp->Execute();   //updates the word count
$numwords = $temp->Words(); //gets the words out of it

echo 'Word count = '.$numwords;

$word->Quit(); 

?> 
```

我试图更改`php.ini`和删除`COM`部分中的分号。

```
[com]
path to a file containing GUIDs, IIDs or filenames of files with TypeLibs
com.typelib_file = 
allow Distributed-COM calls
com.allow_dcom = true
autoregister constants of a components typlib on com_load()
com.autoregister_typelib = true
register constants casesensitive
com.autoregister_casesensitive = false
show warnings on duplicate constat registrations
com.autoregister_verbose = true 
```

并且仍然得到同样的错误。

我正在使用一个`XAMMP`on mac 和一个基于 linux 的网络托管。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-08-21T07:43:53.457

从 PHP 5.4.5 开始，COM 和 DOTNET 不再内置在 php 核心中。您必须在 php.ini 中添加 COM 支持：

```
[COM_DOT_NET]
extension=php_com_dotnet.dll 
```

否则，您将在错误日志中看到：致命错误：找不到类“COM”

该扩展包含在适用于 Windows 的 php 5.4.5 中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T00:21:01.727

请参阅[COM 要求](http://www.php.net/manual/en/com.requirements.php)：

> COM 函数仅适用于 Windows 版本的 PHP。
> 
> .Net 支持需要 PHP 5 和 .Net 运行时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-24T18:58:30.613

I'm using PHP version 5.6.14 for one of my projects, the php_com_dotnet.dll file is included in the ext/ directory but the same is not added in the php.ini file. So, you need to add the "extension=php_com_dotnet.dll" line in the php.ini file. Check phpinfo() in the browser to make sure that it is enabled. Hope, this might help someone.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-04-09T10:09:01.697

Using Windows Server2019, Apache 32Bit (C:\Apache24), PHP 32Bit (C:\PHP)

As jross wrote: Full path to php_com_dotnet.dll was the solution for me (extension=C:\PHP\ext\php_com_dotnet.dll).

# linq-to-sql - 计数和跳过时可能对 IEnumerable 进行多次枚举

> ID：10678334
> 
> 赞同：1
> 
> 时间：2012-05-21T00:19:58.073
> 
> 标签：linq-to-sql, c#-4.0, count, ienumerable, skip-take

我正在为 Linq2Sql 中的数据表准备数据

此代码突出显示为“IEnumerable 的可能多重枚举”（在 Resharper 中）

```
// filtered is an IEnumerable or an IQueryable

var total = filtered.Count();

var displayed = filtered
                .Skip(param.iDisplayStart)
                .Take(param.iDisplayLength).ToList(); 
```

我 100% 确定 Resharper 是对的。

我如何重写它以避免警告

为了澄清，我知道我可以在过滤的末尾放置一个 ToList，只对数据库进行一次查询，例如。

```
 var filteredAndRun = filtered.ToList();

 var total = filteredAndRun.Count();

 var displayed = filteredAndRun
                .Skip(param.iDisplayStart)
                .Take(param.iDisplayLength).ToList(); 
```

但这会带回比我想通过网络传输的数据多得多的数据。

我期待着我不能吃蛋糕也不能吃。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:26:58.387

听起来您更关心的`IQueryable<T>`而不是`IEnumerable<T>`.

但是，在您的情况下，这并不重要。

该`Count`调用应转换为简单且非常快速的 SQL 计数查询。只有第二个查询实际上带回了任何记录。

如果是，`IEnumerable<T>`那么数据在内存中，无论如何它都会非常快。

我会保持你的代码完全一样，当你发现你有一个重大的性能问题时才担心性能调整。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T17:30:20.473

你也可以做类似的事情

```
count = 0;
displayed = new List();
iDisplayStop = param.iDisplayStart + param.iDisplayLength;
foreach (element in filteredAndRun) {
    ++count;
    if ((count < param.iDisplayStart) || (count > iDisplayStop))
          continue;
    displayed.Add(element);
} 
```

显然，这是伪代码，我可能在边缘条件下不一，但该算法仅通过一次迭代即可为您提供计数，并且您仅在最后获得显示项目的列表。

# node.js - 使用 node.js 推送到 C2DM

> ID：10678335
> 
> 赞同：1
> 
> 时间：2012-05-21T00:20:01.070
> 
> 标签：node.js, android-c2dm

我正在尝试使用 node.js 向 C2DM 服务器推送通知，但我什么也没得到。尝试端口 80 会产生 404，而尝试端口 143 不会产生任何结果。

我已经成功运行了这个 curl 命令：

```
curl --header "Authorization: GoogleLogin auth=[auth cookie]" "https://android.apis.google.com/c2dm/send" -d registration_id=[reg id] -d "data.payload=payload" -d collapse_key=0 
```

但是，虽然看起来很相似，但我无法让 node.js 对应工作。有任何想法吗？

```
var querystring = require('querystring');
var http = require('http');

var post_domain = 'https://android.apis.google.com';
var post_port = 143;
var post_path = '/c2dm/send';

var post_data = querystring.stringify({
  'registration_id' : '[reg id]',
  'collapse_key': '0' ,
  'data.payload' : 'Hello!'
});

var post_options = {
  host: post_domain,
  port: post_port,
  path: post_path,
  method: 'POST',
  headers: {
  'Authorization: GoogleLogin auth': '[auth cookie]'
  }
};

var post_req = http.request(post_options, function(res) {
  res.setEncoding('utf8');
  res.on('data', function (chunk) {
    console.log('Response: ' + chunk);
  });
});

// write parameters to post body
post_req.write(post_data);
post_req.end(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:48:06.347

您应该查看 Instagram 的库，用于将消息推送到 C2DM：[https ://github.com/Instagram/node2dm](https://github.com/Instagram/node2dm)

# asp.net - 在母版页、内容页和用户控件中管理 CSS？

> ID：10678344
> 
> 赞同：1
> 
> 时间：2012-05-21T00:21:27.907
> 
> 标签：asp.net, .net, css

在网络中，我使用内容页面、母版页和用户控件。请指导我为所有这些编写 css 的最佳实践。应该在页面中吗？在单独的文件中。每个（内容、主控和用户控制）都有一个单独的文件？还是一个单独的文件？

考虑到易于更改和可扩展性，在专业环境中编写的方式是什么。

我正在编写嵌套 CSS 代码。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:27:32.827

您应该编写单独的 css 文件，从母版页链接。有多少文件取决于您的应用程序的复杂性。

将 css 直接放在页面中会导致不必要的额外带宽使用，而单独的文件可能会被缓存。与 Javascript 相同，顺便说一句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:32:59.210

不要对这样的事情教条主义。根据经验，将整个站点使用的样式放在单独的样式表中。

如果你有一个只适用于一个页面或控件的一次性样式，不要因为将它粘贴在页面本身而感到难过。但是，您这样做的次数越多，修改整个站点的外观就越困难。有取舍。

# excel - VSTO Excel 工作簿加载项未通过 1 台计算机上的 Visual Studio 调试器加载

> ID：10678348
> 
> 赞同：9
> 
> 时间：2012-05-21T00:22:22.980
> 
> 标签：excel, vsto, ms-office

我有一个 VSTO Excel 工作簿项目，可以在我的笔记本电脑上正常调试。该项目解决方案还访问了另一台计算机上的一些特殊硬件，并且该项目昨天在 VS2010 中调试得很好。今天，它停止在这台计算机上调试时挂接到 Excel。F5 启动 Excel，但加载项不会在 Workbook 启动事件等中加载断点...来自版本控制的相同项目在我的笔记本电脑上调试正常，因此这台计算机上的 Excel 或 VS 出现了问题。我似乎有一些关于 VSTO 日志记录和重置 Excel 的相关注释/帖子，但是有没有人对此表示反对？

更新：这个解决方案对我不起作用。当我打字时，我发现了这个相似且有希望的标题... [在 Visual Studio 2010 的调试模式下运行时，Excel 不会打开/启动 VSTO 插件](https://stackoverflow.com/questions/10287007/excel-wont-open-launch-vsto-addin-when-running-in-debug-mode-of-visual-studio-2)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-08-18T02:15:44.053

我的问题是由于安装了应用程序的发布版本并尝试运行调试版本而发生的。然后必须卸载发布版本，清理然后构建，然后重新运行插件。

诡异的！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-11T05:39:34.033

只需检查加载项是否已禁用。

Office 菜单 > {Word/Excel/PowerPoint} 选项 > 在“管理”下选择“禁用项目”，然后单击执行。

有关更多信息，请阅读[http://blogs.msdn.com/b/vsod/archive/2008/04/22/troubleshooting-com-add-in-load-failures.aspx](http://blogs.msdn.com/b/vsod/archive/2008/04/22/troubleshooting-com-add-in-load-failures.aspx)

/阿尔莎·维金德拉

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T18:09:45.263

您可能需要完全清除以前安装的 VSTO 版本的所有痕迹。尝试这个：

1.  从**HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\Excel\AddIns**中删除 VSTO 的注册表项。如果您在 64 位计算机上使用 Office 32 位，请查看**HKEY_CURRENT_USER\SOFTWARE\WOW6432Node\Microsoft\Office\Excel\AddIns**。

2.  删除文件夹 C:\Users\ {username} \AppData\Local\Apps\2.0 （您可能需要先重新启动机器才能解除对该文件夹结构内文件的锁定。）

3.  打开 Excel。转到文件 > 选项 > 加载项 > 管理 COM 加载项并删除您的 VSTO（如果它已列出）。

4.  通过在命令提示符下键入以下内容来清除 ClickOnce 缓存：**rundll32 dfshim CleanOnlineAppCache**

如果这仍然不起作用，那么还尝试从注册表中删除所有引用您的 VSTO 及其相关程序集的键/值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-02T15:32:46.880

当我在 Visual Studio 中点击“开始”进行调试时，我的 Excel 加载项无法加载，我最终要解决的问题就是“重建”我的解决方案。

# android - Android SQLite 空指针异常

> ID：10678351
> 
> 赞同：14
> 
> 时间：2012-05-21T00:23:03.310
> 
> 标签：android, sqlite, nullpointerexception

我在 LogCat 中得到这个：

```
05-20 17:16:34.721: E/AndroidRuntime(30461): FATAL EXCEPTION: main
05-20 17:16:34.721: E/AndroidRuntime(30461): java.lang.NullPointerException
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.database.sqlite.SQLiteStatement.releaseAndUnlock(SQLiteStatement.java:290)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.database.sqlite.SQLiteStatement.executeUpdateDelete(SQLiteStatement.java:96)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.database.sqlite.SQLiteDatabase.updateWithOnConflict(SQLiteDatabase.java:1810)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.database.sqlite.SQLiteDatabase.update(SQLiteDatabase.java:1761)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at com.kickinglettuce.debtplannerpro.DebtDataSource.updateDebt(DebtDataSource.java:130)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at com.kickinglettuce.debtplannerpro.manageDebts$4.onClick(manageDebts.java:184)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.view.View.performClick(View.java:3511)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.view.View$PerformClick.run(View.java:14105)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.os.Handler.handleCallback(Handler.java:605)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.os.Handler.dispatchMessage(Handler.java:92)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.os.Looper.loop(Looper.java:137)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at android.app.ActivityThread.main(ActivityThread.java:4447)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at java.lang.reflect.Method.invokeNative(Native Method)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at java.lang.reflect.Method.invoke(Method.java:511)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-20 17:16:34.721: E/AndroidRuntime(30461):    at dalvik.system.NativeStart.main(Native Method) 
```

这是与之相关的代码：

```
protected void onListItemClick(ListView l, View v, int position, long id) {

    List<Debt> values = datasource.getAllDebt();
            datasource.open();

    Debt item = values.get(position);
    final long boxId = item.getId();
    // final String BoxId = String.valueOf(boxId);
    final String BoxName = item.getName();
    final String BoxBalance = item.getBalance();
    final String BoxApr = item.getApr();
    final String BoxPayment = item.getPayment();

    // set up dialog
    final Dialog dialog = new Dialog(manageDebts.this);
    dialog.setContentView(R.layout.custom_dialog);
    dialog.setTitle("Edit Debt Details");
    dialog.setCancelable(true);

    // set up text
    TextView tv1 = (TextView) dialog.findViewById(R.id.textView1);
    TextView tv2 = (TextView) dialog.findViewById(R.id.textView2);
    TextView tv3 = (TextView) dialog.findViewById(R.id.textView3);
    TextView tv4 = (TextView) dialog.findViewById(R.id.textView4);
    EditText et1 = (EditText) dialog.findViewById(R.id.editText1);
    EditText et2 = (EditText) dialog.findViewById(R.id.editText2);
    EditText et3 = (EditText) dialog.findViewById(R.id.editText3);
    EditText et4 = (EditText) dialog.findViewById(R.id.editText4);

    tv1.setText("Debt Description");
    tv2.setText("Balance");
    tv3.setText("APR");
    tv4.setText("Monthly Payment");

    et1.setText(BoxName);
    et2.setText(BoxBalance);
    et3.setText(BoxApr);
    et4.setText(BoxPayment);

    // set up button
    Button button = (Button) dialog.findViewById(R.id.button1);
    button.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {

            datasource.updateDebt(Long.valueOf(boxId), BoxName, BoxBalance, BoxApr,
                    BoxPayment);
            dialog.dismiss();

        }
    });

    datasource.close();

    dialog.show();
} 
```

我的数据库类中的更新方法：

```
public boolean updateDebt(long updateId, String debtName, String debtTotal,
        String debtApr, String paymentGoal) {

     ContentValues values = new ContentValues();
     values.put(MySQLiteHelper.COLUMN_DEBT_NAME, debtName);
     values.put(MySQLiteHelper.COLUMN_DEBT_TOTAL, debtTotal);
     values.put(MySQLiteHelper.COLUMN_APR, debtApr);
     values.put(MySQLiteHelper.COLUMN_PAYMENT, paymentGoal);
     String whereClause = MySQLiteHelper.COLUMN_ID + " = ?";
     String[] whereArgs = new String[]{ String.valueOf(updateId) };
     return database.update(MySQLiteHelper.TABLE_DEBT,
             values, whereClause, whereArgs) > 0;
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T01:05:07.573

看起来您在关闭数据库时尝试访问它。也许将 datasource.open() 放在 onCreate 的开头，将 datasource.close() 放在 onCreate() 的末尾，并在你的类中只调用它们一次就可以解决你的问题。

如果您正在编辑、创建和删除活动中需要多次调用数据库的项目，请考虑在访问数据库的方法的开头调用 datasource.open()，然后在该方法的结尾调用 close()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T07:51:39.173

最好的方法是使用 SQLiteOpenHelper 类，它负责提供 SQLiteDatabase 的实例，它是单例模式：

参见[Android: java.lang.IllegalStateException: database xxx.db (conn# 0) already closed](https://stackoverflow.com/questions/13137184/android-java-lang-illegalstateexception-database-xxx-db-conn-0-already-clos)

# css - jQuery Mobile 为主题加载一组特定的图标？

> ID：10678352
> 
> 赞同：1
> 
> 时间：2012-05-21T00:23:03.813
> 
> 标签：css, jquery-mobile

有没有办法为主题加载一组特定的图标？我尝试使用`data-theme=c`但没有用

CSS

```
[data-theme=c].ui-icon,
[data-theme=c].ui-icon-searchfield:after {
    background-image: url(../images/icons-18-black.png) /*{global-icon-set}*/;
    background-repeat: no-repeat;
    -moz-border-radius:                 9px;
    -webkit-border-radius:              9px;
    border-radius:                      9px;
} 
```

html

```
<ul data-role="listview" data-divider-theme="b" data-inset="true">
                    <li data-theme="c">
                        <a href="#page4" data-transition="slide">
                            Items
                        </a>
                    </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:12:10.610

在 [data-theme=c] 和 .ui-icon 之间放置一个空格。

```
[data-theme=c] .ui-icon,
[data-theme=c] .ui-icon-searchfield:after {
    background-image: url(../images/icons-18-black.png);
} 
```

如果这不起作用，您的路径也是错误的，请尝试使用完整的 url 进行测试。

```
background-image: url(http://code.jquery.com/mobile/1.1.0/images/icons-18-black.png); 
```

这是一个示例[http://jsfiddle.net/codaniel/CDUth/4/](http://jsfiddle.net/codaniel/CDUth/4/)

# java - 从 EL 执行和对象的方法

> ID：10678353
> 
> 赞同：8
> 
> 时间：2012-05-21T00:23:15.653
> 
> 标签：java, jsp, el

如何从 EL 调用对象的方法？

给对象：

```
public class TestObj {
   public testObj() { };

   public String test() { return "foo"; }
   public String someOtherMethod(String param) { return param + "_bar"; } 
} 
```

并且 obj 被添加到 pageContext

```
pageContext.setAttribute("t", new TestObj()); 
```

我将如何执行相当于：

```
<%= t.test() %>
<%= t.someOtherMethod("foo") %> 
```

使用EL？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T04:35:35.130

自 2009 年 12 月 10 日推出的 EL 2.2 起就支持它（已经超过 2.5 年了！）。EL 2.2 与 Servlet 3.0 齐头并进，因此，如果您以 Servlet 3.0 容器（[Tomcat 7](http://tomcat.apache.org)、[Glassfish 3](http://glassfish.java.net)等）为目标并兼容 Servlet 3.0 `web.xml`，如下所示

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <!-- Config here. -->

</web-app> 
```

那么您将能够以下列形式在 EL 中调用带或不带参数的方法：

```
${t.test()}
${t.someOtherMethod('foo')} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T01:06:09.967

据此，表达式语言[中的 EL](https://stackoverflow.com/questions/692615/method-calls-in-el)方法调用中的方法调用当前处于 JSR 状态，尚未实现。我使用的是用于 JavaBean 组件的 JST 工具来执行一些调用。例如，如果您将`test`方法签名修改为：

```
public class TestObj {
    public TestObj() { };

    public String getTest() { return "foo"; }
} 
```

`getTest()`您可以使用以下语法调用方法：

```
${t.test} 
```

现在，如果您需要更精细的东西（例如参数传递），您可以使用 EL 提供的自定义方法功能。这需要在公共类中声明的公共静态方法以及 TLD 文件。一个很好的教程可以在[这里](http://www.roseindia.net/jstl/jstl-el.shtml)找到。

**更新：**

正如@BalusC 所说，后来的规范现在支持方法调用。如果您要部署到与 Java EE 6 兼容的容器，[此 Oracle 站点](http://docs.oracle.com/javaee/6/tutorial/doc/bnahu.html)将展示如何正确使用该功能。

# java - 查找 FileStore 的目录

> ID：10678363
> 
> 赞同：13
> 
> 时间：2012-05-21T00:25:22.717
> 
> 标签：java, nio2

我正在尝试找到一种方法来检测闪存驱动器何时插入我的计算机。到目前为止，我找到的解决方案是轮询[`FileSystem#getFileStores`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileSystem.html#getFileStores%28%29)更改。这确实告诉我闪存驱动器何时插入，但据我所知，没有办法检索它的位置。[`FileStore#type`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileStore.html#type%28%29)并且[`FileStore#name`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileStore.html#name%28%29)两者似乎都非常不可靠，因为它们的返回值是特定于实现的，但它们似乎是唯一可能返回任何相关信息的方法，这些信息可能有助于找到`FileStore`.

考虑到这一点，下面的代码：

```
public class Test {
    public static void main(String[] args) throws IOException {
        for (FileStore store : FileSystems.getDefault().getFileStores()) {
            System.out.println(store);
            System.out.println("\t" + store.name());
            System.out.println("\t" + store.type());
            System.out.println();
        }
    }
} 
```

给了我这个输出：

```
/ (/dev/sda5)
    /dev/sda5
    ext4

/* snip */

/media/TI103426W0D (/dev/sda2)
    /dev/sda2
    fuseblk

/media/flashdrive (/dev/sdb1)
    /dev/sdb1
    vfat 
```

事实证明，`FileStore#type`返回驱动器的格式并`FileStore#name`返回驱动器的设备文件的位置。据我所知，唯一具有驱动器位置的方法就是`toString`方法，但是从中提取路径名似乎很危险，因为我不确定该特定解决方案在其他操作系统上的支持程度如何，并且Java 的未来版本。

有什么我在这里遗漏的，还是纯粹用 Java 根本不可能？

系统信息：

```
$ java -version
java version "1.7.0_03"
OpenJDK Runtime Environment (IcedTea7 2.1.1pre) (7~u3-2.1.1~pre1-1ubuntu2)
OpenJDK Client VM (build 22.0-b10, mixed mode, sharing)

$ uname -a
Linux jeffrey-pc 3.2.0-24-generic-pae #37-Ubuntu SMP Wed Apr 25 10:47:59 UTC 2012 i686 athlon i386 GNU/Linux 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T20:19:53.843

这是一个临时解决方法，直到找到更好的解决方案：

```
public Path getRootPath(FileStore fs) throws IOException {
    Path media = Paths.get("/media");
    if (media.isAbsolute() && Files.exists(media)) { // Linux
        try (DirectoryStream<Path> stream = Files.newDirectoryStream(media)) {
            for (Path p : stream) {
                if (Files.getFileStore(p).equals(fs)) {
                    return p;
                }
            }
        }
    } else { // Windows
        IOException ex = null;
        for (Path p : FileSystems.getDefault().getRootDirectories()) {
            try {
                if (Files.getFileStore(p).equals(fs)) {
                    return p;
                }
            } catch (IOException e) {
                ex = e;
            }
        }
        if (ex != null) {
            throw ex;
        }
    }
    return null;
} 
```

据我所知，这个解决方案只适用于 Windows 和 Linux 系统。

您必须`IOException`在 Windows 循环中捕获 ，因为如果 CD 驱动器中没有 CD，则在您尝试检索`FileStore`它时会引发异常。这可能发生在您遍历每个根之前。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-09T05:15:20.740

这就是我最终所做的。这仅限于 Windows + UNIX，但避免使用外部工具或额外的库调用。它窃取 Java 已经在`FileStore`对象中拥有的信息

`LinuxFileStore`肯定 extends `UnixFileStore`，所以它会工作。Solaris 也一样。由于 Mac OS X 是 UNIX，它可能在那里工作，但我不确定，因为我在任何地方都看不到它的子类。

```
public class FileStoreHacks {
    /**
     * Stores the known hacks.
     */
    private static final Map<Class<? extends FileStore>, Hacks> hacksMap;
    static {
        ImmutableMap.Builder<Class<? extends FileStore>, Hacks> builder =
            ImmutableMap.builder();

        try {
            Class<? extends FileStore> fileStoreClass =
                Class.forName("sun.nio.fs.WindowsFileStore")
                    .asSubclass(FileStore.class);
            builder.put(fileStoreClass, new WindowsFileStoreHacks(fileStoreClass));
        } catch (ClassNotFoundException e) {
            // Probably not running on Windows.
        }

        try {
            Class<? extends FileStore> fileStoreClass =
                Class.forName("sun.nio.fs.UnixFileStore")
                    .asSubclass(FileStore.class);
            builder.put(fileStoreClass, new UnixFileStoreHacks(fileStoreClass));
        } catch (ClassNotFoundException e) {
            // Probably not running on UNIX.
        }

        hacksMap = builder.build();
    }

    private FileStoreHacks() {
    }

    /**
     * Gets the path from a file store. For some reason, NIO2 only has a method
     * to go in the other direction.
     *
     * @param store the file store.
     * @return the path.
     */
    public static Path getPath(FileStore store) {
        Hacks hacks = hacksMap.get(store.getClass());
        if (hacks == null) {
            return null;
        } else {
            return hacks.getPath(store);
        }
    }

    private static interface Hacks {
        Path getPath(FileStore store);
    }

    private static class WindowsFileStoreHacks implements Hacks {
        private final Field field;

        public WindowsFileStoreHacks(Class<?> fileStoreClass) {
            try {
                field = fileStoreClass.getDeclaredField("root");
                field.setAccessible(true);
            } catch (NoSuchFieldException e) {
                throw new IllegalStateException("file field not found", e);
            }
        }

        @Override
        public Path getPath(FileStore store) {
            try {
                String root = (String) field.get(store);
                return FileSystems.getDefault().getPath(root);
            } catch (IllegalAccessException e) {
                throw new IllegalStateException("Denied access", e);
            }
        }
    }

    private static class UnixFileStoreHacks implements Hacks {
        private final Field field;

        private UnixFileStoreHacks(Class<?> fileStoreClass) {
            try {
                field = fileStoreClass.getDeclaredField("file");
                field.setAccessible(true);
            } catch (NoSuchFieldException e) {
                throw new IllegalStateException("file field not found", e);
            }
        }

        @Override
        public Path getPath(FileStore store) {
            try {
                return (Path) field.get(store);
            } catch (IllegalAccessException e) {
                throw new IllegalStateException("Denied access", e);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T00:48:15.687

我还没有真正探索过java的这个领域，但是我发现[了this](https://stackoverflow.com/questions/6547762/how-to-detect-a-usb-drive-in-java)，这似乎是相关的。它用`File.listRoots()`

那里似乎也有一些相关的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-23T13:34:52.397

这适用于 Windows：

```
 public Path getFileStoreRootPath(FileStore fs) throws Exception {
    for (Path root : FileSystems.getDefault().getRootDirectories()) {
        if (Files.isDirectory(root) && Files.getFileStore(root).equals(fs)) {
            return root;
        }
    }

    throw new RuntimeException("Root directory for filestore " + fs + " not found");
} 
```

基本上，通过按条件过滤，`Files.isDirectory(root)`我们排除了所有在未插入光盘时会抛出 IOException 的 CD/DVD 驱动器。

# scala - 从scala中的类型名称获取类型

> ID：10678367
> 
> 赞同：1
> 
> 时间：2012-05-21T00:25:37.623
> 
> 标签：scala, reflection, types

在对 scala 进行了一番摆弄之后，我找到了从给定类型创建新对象的解决方案

```
object Entity {

  def get[T <: Entity: ClassManifest]: T = {

      val entity = implicitly[ClassManifest[T]].erasure.getConstructors()(0).newInstance().asInstanceOf[T]

      /** some stuff **/

      entity

  }

}

abstract class Entity {

}

class Implementation extends Entity {

} 
```

然后用法：

```
var e = Entity.get[Implementation] 
```

我的问题

1.  可以吗，还是有一些不同的方法（我现在使用的是 scala 2.9.2）？

2.  有没有像 Class.forName 这样的东西允许从它的名字中获取类型？（或更一般地说，我可以使用类型作为变量吗？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T00:41:04.417

因此，StackOverflow 的问题之一是没有人会因为我说“哇，这太聪明了。看在上帝的份上，永远不要这样做或类似的事情”而给我积分。尽管如此，作为一名高级架构师，这似乎是我的大部分工作。

如果您在外部或库中使用反射，或者作为与库交互的原因，那么您做错了。所以停止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:34:14.140

或者，您可以通过`Class[T]`：

```
object Entity {
  def get[T <: Entity](e: Class[T]): T = {
    val entity = e.getConstructors()(0).newInstance().asInstanceOf[T]
    /** some stuff **/
    entity
  }
}

var e1 = Entity.get(classOf[Implementation]) 
```

您可以使用`Class.forName`，但您会失去类型安全性（因为字符串 className 可以是任何东西，而不仅仅是 Entity 子类），我认为您的返回类型必须是`Entity`.

# java - 如何让 Jbutton 显示菜单项列表？

> ID：10678370
> 
> 赞同：0
> 
> 时间：2012-05-21T00:26:44.120
> 
> 标签：java, swing, jframe, jbutton, jmenubar

当您单击 Jbutton 时，有没有办法显示菜单项列表？例如，如果我单击标有 的 Jbutton `wrench`，它会显示一个带有 2 个选项的菜单项列表，就像[这个示例](http://www.java2s.com/Tutorial/JavaImages/JMenuItemKeyStroke.PNG)一样。这是我的代码（强调的文本`**`是我想要在单击时显示菜单项列表的按钮）：

```
appletFrame = new JFrame(Settings.serverName);
        Loader.webclient = false;
        appletFrame.setLayout(new BorderLayout());
        appletFrame.setDefaultCloseOperation(3);
        JPanel appletPanel = new JPanel(new BorderLayout()); 
        appletFrame.setIconImage(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/icon.png")));
        appletPanel.add(this);
        appletPanel.setPreferredSize(new Dimension(767, 655));
        appletFrame.getContentPane().add(appletPanel, BorderLayout.CENTER);
        appletFrame.pack();
        appletFrame.setLocationRelativeTo(null);
        appletFrame.setVisible(true);
        JMenuBar jmenubar = new JMenuBar();
        appletPanel.add(jmenubar, BorderLayout.PAGE_START); 
        layout = new FlowLayout();
        **ImageIcon wrench = new ImageIcon(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/wrench.png")));**
        ImageIcon key = new ImageIcon(Toolkit.getDefaultToolkit().getImage(this.getClass().getResource("/resources/key.png")));
        JButton button1 = new JButton("Vote");
        JButton button2 = new JButton("Item List");
        JButton button3 = new JButton("Screenshot");
        **JButton button4 = new JButton(wrench);**
        JButton button5 = new JButton(key);
        **button4.setBorder(null);
        **button4.setBorderPainted(false);**
        **button4.setContentAreaFilled(false);**
        button5.setBorder(null);
        button5.setBorderPainted(false);
        button5.setContentAreaFilled(false);
        jmenubar.setLayout(layout);
        jmenubar.add(button1);
        jmenubar.add(button2);
        jmenubar.add(button3);
        **jmenubar.add(button4);**
        jmenubar.add(button5);
        button1.addActionListener(this);
        button2.addActionListener(this);
        button3.addActionListener(this);
        **button4.addActionListener(this);**
        button5.addActionListener(this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:53:58.953

你需要一个SplitButton吗？然后是一些已实现的包（包括 Netbeans UI 组件），您可能会喜欢它们。

如果您需要一个小包，请查看以下链接： [http ://code.google.com/p/jsplitbutton/](http://code.google.com/p/jsplitbutton/)

# jquery-mobile - 我正在开发我的第一个移动应用程序，但无法使用正确的导航栏按钮

> ID：10678379
> 
> 赞同：0
> 
> 时间：2012-05-21T00:28:20.897
> 
> 标签：jquery-mobile, navbar, dreamweaver

我正在使用 Dreamweaver CS6，并附上了下面的代码。我将所有 jquery 文件更新为最新版本。当我进入实时视图时，我可以单击前两个按钮，但第三个按钮在任一页面上都不起作用，并且右侧没有干净的边缘。css或代码本身是否有问题。谢谢

我正在使用 Dreamweaver CS6，并附上了下面的代码。我将所有 jquery 文件更新为最新版本。当我进入实时视图时，我可以单击前两个按钮，但第三个按钮在任一页面上都不起作用，并且右侧没有干净的边缘。css或代码本身是否有问题。谢谢

```
<!--Safety Home Page Starts Here -->
<div data-role="page" id="safety_home" data-theme="c">
  <div data-role="header" data-theme="c">
    <h1>GGM Mobile</h1>
    <div data-role="navbar" data-theme="c"><ul>
      <li><a href="#safety_home" class="ui-btn-active">Home</a></li>
      <li><a href="#safety_topic">Topics</a></li>
      <li><a href="#safety_report">Report</a></li>
    </ul></div>
  </div>
  <div data-role="content" data-theme="c">
    <p>Home</p>
  </div>
  <div data-role="footer" data-theme="c">
    <h4>Gothic Grounds Management, Inc. &copy; 2012</h4>
  </div>
</div>
    <!--Safety Home Page Ends Here -->
    <!--Safety Topic Page Starts Here -->
<div data-role="page" id="safety_topic" data-theme="c">
  <div data-role="header" data-theme="c">
    <h1>GGM Mobile</h1>
    <div data-role="navbar" data-theme="c"><ul>
      <li><a href="#safety_home">Home</a></li>
      <li><a href="#safety_topic" class="ui-btn-active">Topic</a></li>
      <li><a href="#safety_report">Report</a></li>
    </ul>
    </div>
  </div>
  <div data-role="content" data-theme="c">
    <p>Topics</p>
  </div>
  <div data-role="footer" data-theme="c">
    <h4>Gothic Grounds Management, Inc. &copy; 2012</h4>
  </div>
    <!--Safety Topics Page Ends Here -->
    <!--Safety Incidents Page Starts Here -->
<div data-role="page" id="safety_report" data-theme="c">
  <div data-role="header" data-theme="c">
    <h1>GGM Mobile</h1>
    <div data-role="navbar" data-theme="c"><ul>
      <li><a href="#safety_home">Home</a></li>
      <li><a href="#safety_topic">Topics</a></li>
      <li><a href="#safety_report" class="ui-btn-active">Report</a></li>
    </ul>
    </div>
  </div>
  <div data-role="content" data-theme="c">
    <p>Topics</p>
  </div>
  <div data-role="footer" data-theme="c">
    <h4>Gothic Grounds Management, Inc. &copy; 2012</h4>
  </div>
    <!--Safety Incident Page Ends Here --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:38:16.743

是的，您的第二页和第三页没有结束`</div>`标签。您可能想尝试使用验证器来帮助发现此类问题。这是您通过验证器运行代码时看到的类型。

第 38 行，第 56 列：未闭合元素 div。

`<div data-role="page" id="safety_report" data-theme="c">`

第 20 行，第 55 列：未闭合元素 div。

`<div data-role="page" id="safety_topic" data-theme="c">`

**HTML5 验证器**

1.  [http://validator.w3.org/](http://validator.w3.org/)
2.  [http://html5.validator.nu/](http://html5.validator.nu/)

我希望这有帮助。

# c# - 一个程序在我的计算机上运行良好，但是当我将它发送到另一个使用荷兰语 Windows 的程序时，它的 DateTimePicker 出现问题

> ID：10678386
> 
> 赞同：1
> 
> 时间：2012-05-21T00:29:31.143
> 
> 标签：c#, sql-server

该程序使用 C# WinForms 和 SQL Server 2008。当我想输入包含来自 DateTimePicker 的值的数据时，我可以看到措辞是荷兰语，然后我收到关于转换值的错误。有没有办法预先编程来解决这个问题？我发现了错误，就在这里。

![错误](../Images/23f87d7cbc224cfe8f1e39b152f6beae.png)

```
 try
        {
            SqlConnection connect = new SqlConnection("Data Source=Localhost\\SQLExpress;Initial Catalog=DataBase;Integrated Security=True");
            SqlDataAdapter da = new SqlDataAdapter();

            /******************** Inserting ********************/
            string query = "INSERT INTO spending VALUES (";
            query += "'" + date_dateTimePicker.Value + "', "; // Date
            query += "'" + Convert.ToDecimal(amount_spent_textBox.Text) + "', "; // Amount spent
            query += "'" + spent_on_textBox.Text + "')"; // Spent on
            connect.Open();
            da.InsertCommand = new SqlCommand(query, connect);
            da.InsertCommand.ExecuteNonQuery();

            connect.Close();
        }

        catch (Exception error)
        {
            MessageBox.Show(error.ToString());
        } 
```

事情变得越来越复杂。我在尝试将 dateTimePicker 值插入数据库时​​遇到了这个错误，就像我对上面的代码所做的那样。它在我的电脑上运行得很好，但在这里不行。有人可以解释吗？这是错误：

![错误](../Images/b35f1a937124db79ef85c9c0a7670c0c.png)

使用的代码：

```
string update = "UPDATE table SET the_date = '" + the_date_dateTimePicker.Value + "' WHERE instance_ID = 1";
        connect.Open();
        da.InsertCommand = new SqlCommand(update, connect);
        da.InsertCommand.ExecuteNonQuery();
        connect.Close(); 
```

好的，这是我现在正在处理的表单的完整代码，即显示[此错误](https://i.imgur.com/6n7Xu.jpg)的代码。大多数表格的结构都是这样的，所以如果我把这个做对了，其余的应该不会有任何问题。我正在我的电脑上测试它，所以如果它在这里工作，它也应该在那里工作。

看看，我不知道该怎么办了。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace TheNamespace
{
public partial class submit_spending : Form
{
    public submit_spending()
    {
        InitializeComponent();
    }

    private void submit_button_Click(object sender, EventArgs e)
    {
        try
        {
            SqlConnection connect = new SqlConnection("Data Source=Localhost\\SQLExpress;Initial Catalog=TheDataBase;Integrated Security=True");
            SqlDataAdapter da = new SqlDataAdapter();

            /******************** Inserting ********************/
            string query = "INSERT INTO spending VALUES (@date, @amount_spent, @spent_on)";
            SqlCommand command = new SqlCommand(query);
            command.Parameters.AddWithValue("date", date_dateTimePicker.Value);
            command.Parameters.AddWithValue("amount_spent", Convert.ToDecimal(amount_spent_textBox.Text));
            command.Parameters.AddWithValue("spent_on", spent_on_textBox.Text);

            connect.Open();
            da.InsertCommand = new SqlCommand(query, connect);
            da.InsertCommand.ExecuteNonQuery();
            connect.Close();

            if (MessageBox.Show("Submitted.", "Spending submitted", MessageBoxButtons.OK) == DialogResult.OK)
            {
                this.Close();
            }
        }
        catch (Exception error)
        {
            MessageBox.Show(error.ToString());
        }
    }

    private void cancel_button_Click(object sender, EventArgs e)
    {
        this.Close();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T08:56:15.167

您应该使用该`Parameters.AddWithValue()`方法。我希望它能够`DateTime`正确格式化。

```
string cmdText = "UPDATE table SET colX = @value WHERE id = @currId";
var cmd = new SqlCommand(cmdText, conn);
cmd.Parameters.AddWithValue("value", dateTimePicker1.Value);
cmd.Parameters.AddWithValue("currId", id); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:31:46.903

可能您的日期时间格式有问题，可以通过将系统日期时间格式更改为与它正在工作的计算机相同的格式来解决，或者您可以在代码中做一些额外的工作。对于自定义日期时间格式看看这里：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T08:38:46.657

理想情况下，您应该使用 T-SQL 语句中的参数编写应用程序`datetime`，这样转换就不会出现。

您可以使用的另一种方法是[`SET DATEFORMAT`](http://msdn.microsoft.com/en-us/library/ms189491.aspx)在您的应用程序使用的连接上添加一个。因此，您可以将格式更改为您的应用程序期望/使用的格式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T02:12:29.760

我认为您需要在 command.Parameters 中将值分配给日期时指定 SqlDBType 。请交叉检查您在 insert 语句中指定的参数名称与参数中指定的参数。添加

```
string sql = "INSERT INTO spending VALUES (@date, @amount_spent, @spent_on)";
 using (var cn = new SqlConnection("..connection string.."))
 using (var cmd = new SqlCommand(sql, cn))
   {
cmd.Parameters.Add("@date", SqlDbType.DateTime).Value = date_dateTimePicker.Value;
command.Parameters.AddWithValue("@amount_spent",Convert.ToDecimal(amount_spent_textBox.Text));
        command.Parameters.AddWithValue("@spent_on", spent_on_textBox.Text);

        connect.Open(); 
```

有时最好使用不变的文化来存储数据库中的日期/时间之类的东西。你可以试试 CultureInfo.Invariantculture

```
DateTime date = date_dateTimePicker.Value.Date;
string sDate = date.ToString("dd-MM-yy",    System.Globalization.CultureInfo.InvariantCulture);
DateTime dateInsert = Convert.ToDateTime(sDate); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T16:12:31.120

您可能可以使用具有文化不变格式的显式 ToString 来确保它适用于任何语言环境。这有点骇人听闻，但替换了这一行：

```
command.Parameters.AddWithValue("date", date_dateTimePicker.Value); 
```

这应该可以工作：

```
command.Parameters.AddWithValue("date", date_dateTimePicker.Value.ToString("s")); 
```

这将为您提供 ISO 8601 格式的日期时间字符串，这是一个具有明确规范的国际标准。此外，此格式不受 SQL Server 实例上的 SET DATEFORMAT 或 SET LANGUAGE 设置的影响。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-21T07:17:44.723

只需使用`dateTime.ToString("s")`，无论计算机的文化设置如何，它都会以通用格式提供您的日期时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-29T14:53:21.547

```
"UPDATE table SET the_date = '" + the_date_dateTimePicker.Value + "' WHERE instance_ID = 1"; 
```

此处使用默认 CultureInfo 转换为字符串。根据工作站上选择的区域设置，日期时间可以转换为“29/05/2012”和“05/29/2012”。但是 Sql Server 可能配置为其他区域设置，因此您遇到问题（sql server 无法解析传递的 DateTime 字符串表示形式）

如果您不想稍后再遇到与 CultureInfo 相关的问题，则必须使用参数化查询。

# python - Apache 运行静态内容和烧瓶应用程序

> ID：10678394
> 
> 赞同：3
> 
> 时间：2012-05-21T00:30:43.097
> 
> 标签：python, apache, mod-rewrite, wsgi

我有一个 Flask 应用程序通过`wsgi`.

为了教训我的应用程序的负载，它加载了很多东西，我想通过 apache 提供我的主页或根 url，但是我在尝试通过 apache 发送“/”静态索引文件时遇到冲突，并且然后其他一切`wsgi`：

```
<VirtualHost *:80>
    ServerName www.yada.com

    Alias /static /home/ubuntu/yada/static
    <Location /static>
        SetHandler None
    </Location>

    WSGIDaemonProcess yada
    WSGIScriptAliasMatch /.+ /home/ubuntu/yada/wsgi.py

    <Directory /home/ubuntu/yada>

        RewriteEngine On
        RewriteRule ^/$ /static/html/index.html [L]

        WSGIProcessGroup postwire
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
    </Directory>
</VirtualHost> 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T08:39:54.760

请参阅部分末​​尾的 AddHandler/mod_rewrite 解决方案：

[http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#The_Apache_Alias_Directive](http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#The_Apache_Alias_Directive)

# mysql - 我应该使用连接而不是循环

> ID：10678395
> 
> 赞同：0
> 
> 时间：2012-05-21T00:31:06.620
> 
> 标签：mysql, sql

我有两张桌子。

`User`表有 user_id 和 order_num

`Orders`表有 order_num、*dd*、*mm*、*yyyy*、order_detail。

当用户想要查看某个月份的所有订单时，我通常从 user_id 与 cookie 匹配的用户表中选择 order_num，然后在循环和循环内对匹配 order_num 的订单表进行选择，并显示月份是否与所选月份匹配。

有没有更有效的方法来做到这一点？加入某种形式？相当基本的sql知识但热衷于扩展

所以，我目前这样做（我知道它的代码不好，但逻辑 sql 这个问题最重要的部分，我知道如何正确编码）

```
select order_num from user where user_id = $cookie

while (results) {

    select order_detail, mm, dd, yyyy where mm = $month

    echo order_detail mm dd yyyy

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:38:04.607

当然，您可以执行以下操作：

```
SELECT * FROM users u
JOIN orders o ON u.order_num = o.order_num AND o.mm = ###
WHERE u.user_id = ### 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:36:08.850

最简单的加入形式，让您开始：

```
SELECT u.order_num, o.order_detail, o.mm, o.dd, o.yyyy
FROM user AS u, order AS o
WHERE u.order_num = o.order_num AND o.mm = $month 
```

# css - 如何让 CSS 兼容所有浏览器？

> ID：10678397
> 
> 赞同：0
> 
> 时间：2012-05-21T00:31:25.700
> 
> 标签：css, webkit, mozilla

基本上我的意思是哪些 CSS 字段需要在它们前面加上“-moz-”和“-webkit”才能工作？我知道“border-radius”和“box-shadow”可以，但谁能告诉我所有这些？非常感谢先进。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:36:58.240

其实还有很多，很多都跟动画效果有关。我的猜测是您可能只会使用一些（边框、半径、不透明度等），但这里是 webkit 属性的完整列表：http: [//css-infos.net/properties/webkit](http://css-infos.net/properties/webkit)。

# web-services - 域对象构建责任：我应该在服务层接口中使用域对象吗？

> ID：10678410
> 
> 赞同：2
> 
> 时间：2012-05-21T00:36:03.290
> 
> 标签：web-services, jakarta-ee, architecture, ejb

在设计服务层时，我应该在接口契约中使用我的领域对象吗？例如：

> 公共无效注册用户（字符串用户名，字符串实名）

VS

> 公共无效注册用户（用户用户）

域对象应该在客户端代码中还是在服务外观之后构建？

我正在使用 EJB，我的客户端将是本地部署的 Web 应用程序、RMI 客户端，也可能是 Web 服务客户端。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T01:23:15.090

从技术上讲，使用一个或另一个没有问题：通过 XSD 的 Web 服务能够支持像字符串这样的原始类型和像用户类这样的复杂对象。

现在，如果你的`User`类有 20 个属性，而你只需要`username`和`realName`注册一个用户怎么办？在这种特殊情况下，最好使用您的第一种方法，因为如果您不强迫您的客户端构建不需要的大型 XML 文档，则需要更少的带宽。

其他情况是您的 User 类根据 JAXB 规则生成复杂且高度嵌套的 XML 文档。这可以为您的客户和复杂的客户实现产生复杂的消息。如果是这种情况，您可以使用域类的更简单版本（可能具有一两个嵌套级别）作为 DTO 来简化消息交换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T13:23:13.887

在我看来，服务层一般不应该使用域对象。域是处理业务逻辑、规则和工作流的东西，而服务提供了一个接口。

设计服务层时最简单的原则是“服务方法实现单个用例”。（用例是一个输入和输出都定义得很好的场景）。

在您的示例中 - `registerUser(String username, String realName)`- 看起来非常好。服务将实例化所有需要的域对象并启动业务操作 - 同时，服务客户端不知道业务逻辑内部（例如，可能有一些特定的用户对象构造等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T09:29:49.407

在您的所有服务中传递 User 对象似乎没有什么害处。根据 DDD（域驱动设计[http://en.wikipedia.org/wiki/Domain-driven_design](http://en.wikipedia.org/wiki/Domain-driven_design)），这是一个非常好的做法，您的所有域对象都应该在项目的所有层中可用。从长远来看，它将使您的代码更加面向对象，这通常在典型的 Java EE 项目（又名贫血域模型）中被视为缺乏，但唯一的额外建议是您尝试将业务逻辑保留在 User 类中，而**不是**在您的服务中.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T11:23:12.567

将域对象作为**服务**层的一部分传递是一种更简单且更面向对象的方式。使用用户输入值并构造相关的域对象 - 是**控制器**层的职责

此外，服务层描述了最终客户端使用的[API](http://en.wikipedia.org/wiki/Application_programming_interface)。如果服务层开始使用泛型类型（如字符串、地图等）公开 API，那么麻烦就开始了。

而不是 DTO，它是一种[反模式](https://stackoverflow.com/questions/1440952/why-are-data-transfer-objects-an-anti-pattern)，域对象可以更好地从控制器层传递到服务层。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-10T10:53:13.870

在我看来，从门面层暴露领域对象是不合适的。使用该服务的客户端不应依赖于域对象。最好设计一个数据合约并将它们从外观层公开。它们将仅用于传输数据，即 DTO。考虑到域对象不仅仅是 DTO，它们可以提供一些无功能的东西。此外，外观层中的服务暴露了系统的使用，它可能包括多个领域对象的某些部分的协作，有时可能在外观层中的方法的需求和可用的领域对象之间没有合适的映射。此外，出于网络性能的原因，DTO 及其结构可能需要考虑一些因素。而这些考虑在设计领域对象时通常没有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-23T15:46:37.223

> 域对象应该在客户端代码中还是在服务外观之后构建？

**域对象应该在服务端创建。**客户端仅传递创建对象所需的所有参数。

对象构造的一般算法是：

1.  获取参数
2.  验证参数
3.  将有效参数传递给对象构造函数以获取有效对象
4.  在存储库中注册一个有效的构造对象以进行持久性（如有必要）

如果在客户端创建一个对象并传递给服务，那么会出现几个问题：

1.  来自客户端的对象可能处于不正确的状态（客户端数据不可信）
2.  必须验证对象状态
3.  对现有对象的验证意味着验证逻辑的可能重复，在验证私有字段值时可能会丢失封装，或者有时违反单一责任原则
4.  有时服务必须使用传递的对象属性值作为参数来重建对象

# java - java.security.AccessControlException：访问被拒绝（java.lang.RuntimePermission modifyThread）

> ID：10678413
> 
> 赞同：1
> 
> 时间：2012-05-21T00:36:52.907
> 
> 标签：java, executorservice, threadpool, securitymanager

我有我的批处理应用程序，我在批处理应用程序中使用 ThreadPoolExecutor。所以一旦它击中-

```
executorService.shutdown(); 
```

在我的批处理应用程序中，我总是在批处理应用程序中收到以下错误。而且我无法关闭我自己的执行器服务。谁能建议我应该如何克服这个错误。

```
Batch Execution Failed!
TaskResponse[exitCode=
   <ExitCode 
       type="User"
       code="30"
       msg="Unexpected error encounted"/>,
    causedByException=java.security.AccessControlException : Access denied (java.lang.RuntimePermission modifyThread)
]

java.security.AccessControlException: Access denied (java.lang.RuntimePermission modifyThread)
   at java.security.AccessController.checkPermission(AccessController.java:108)
   at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
   at java.util.concurrent.ThreadPoolExecutor.shutdown(ThreadPoolExecutor.java:1104)
   at com.host.task.Testing.CommandExecutor.runNextCommand(CommandExecutor.java:185)
   at com.host.task.Testing.PDSBatchTask.execute(PDSBatchTask.java:66)
   at com.host.nel.batch.runtime.Task.start(Task.java:234)
   at com.host.nel.batch.runtime.rt.TaskManager.__executeTask(TaskManager.java:138)
   at com.host.nel.batch.runtime.rt.TaskManager.executeTask(TaskManager.java:73)
   at com.host.nel.batch.runtime.rt.BatchManager.__executeTask(BatchManager.java:302)
   at com.host.nel.batch.runtime.rt.BatchManager.executeBatchApplication(BatchManager.java:126)
   at com.host.nel.batch.driver.BatchMain.main(BatchMain.java:95)
   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
   at java.lang.reflect.Method.invoke(Method.java:599)
   at com.host.nel.batch.testutils.TestBatchMain$1.run(TestBatchMain.java:50)
   at java.security.AccessController.doPrivileged(AccessController.java:251)
   at com.host.nel.batch.testutils.TestBatchMain.driver(TestBatchMain.java:37)
   at com.host.nel.batch.testutils.TestBatchMain.driver(TestBatchMain.java:21)
   at test.com.host.task.Testing.Driver.main(Driver.java:21) 
```

**更新-** 我尝试过这样做，但仍然没有运气-

```
// create thread pool with given size
            final ExecutorService service = Executors.newFixedThreadPool(10); 

            // queue some tasks
            for(int i = 0; i < 3 * 10; i++) {
                service.submit(new ThreadTask(i));
            }

            AccessController.doPrivileged(new PrivilegedAction() {
                public Object run() {
                    // privileged code goes here, for example:
                    service.shutdown();
                    try {
                        if (!service.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS)) {
                            service.shutdownNow();
                        }
                    } catch (final InterruptedException pCaught) {
                        service.shutdownNow();
                        Thread.currentThread().interrupt();
                    }

                    return null; // nothing to return
                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:22:18.787

不要使用 SecurityManager 运行您的批处理测试代码。或者，授予您的代码 modifyThread RuntimePermission。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T08:17:07.543

您可以尝试在一个`doPriviledged`块中关闭您的 Executor

```
AccessController.doPrivileged(new PrivilegedAction() {
            public Object run() {
                // privileged code goes here, for example:
                executorService.shutdown();
                return null; // nothing to return
            }
        }); 
```

# iphone - 在 UITableView 中显示 JSON 数据

> ID：10678414
> 
> 赞同：0
> 
> 时间：2012-05-21T00:36:57.260
> 
> 标签：iphone, ios, xcode, json, uitableview

我的应用程序正在加载一些 JSON 数据，一切正常，但是当我尝试在 UITableView 单元格中显示这些数据时，什么也没有发生。我的代码如下：

获取数据（JSON）：

```
-(void)fetchedData:(NSData *)responseData {

    NSError* error;
    NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];
    NSArray* latestLoans = [json objectForKey:@"loans"];

    testeDictionary = [latestLoans objectAtIndex:0];

    testeLabel.text = [NSString stringWithFormat:@"%@",[testeDictionary objectForKey:@"id"]];

    testeString = [testeDictionary objectForKey:@"username"];
    [miArray addObject:[NSDictionary dictionaryWithObjectsAndKeys:testeString,@"username",nil]];

} 
```

界面视图：

```
-(UITableViewCell *)tableView:(UITableView *)myTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

    UITableViewCell *cell = (UITableViewCell *)[self.settingsTableView dequeueReusableCellWithIdentifier:@"CellD"];
    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CellD" owner:self options:nil];
        cell = (UITableViewCell *)[nib objectAtIndex:0];
    }

    if ([indexPath row] == 0) {

        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CellA" owner:self options:nil];
        cell = (UITableViewCell *)[nib objectAtIndex:0];

        NSDictionary *itemAtIndex = (NSDictionary *)[miArray objectAtIndex:indexPath.row];

        UILabel *usernameString = (UILabel *)[cell viewWithTag:1];
        usernameString.text = [itemAtIndex objectForKey:@"id"]; <== MUST DISPLAY JSON VALUE

    }

    return cell;

} 
```

更清楚我需要`[testeDictionary objectForKey:@"id"]`在`usernameString.text`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:39:10.633

您没有存储 id

```
[miArray addObject:[NSDictionary dictionaryWithObjectsAndKeys:testeString,@"username",nil]]; 
```

我想你想做的是这样的

```
NSString *idString = [NSString stringWithFormat:@"%@", [testeDictionary objectForKey:@"id"]];
[miArray addObject:[NSDictionary dictionaryWithObjectsAndKeys:
                                          testeString, @"username",
                                          idString, @"id", 
                                          nil]]; 
```

**编辑（解释）**

在您的方法`fetchedData:`中，您提取 id 并将某些标签的文本设置为 id。

```
testeLabel.text = [NSString stringWithFormat:@"%@",[testeDictionary objectForKey:@"id"]]; 
```

之后你忘记了id。然后，您继续提取用户名并创建一个**仅**包含用户名的字典，并将该字典添加到名为`miArray`.

```
[miArray addObject:[NSDictionary dictionaryWithObjectsAndKeys:testeString,@"username",nil]]; 
```

**请注意，您没有指定任何名为“id”的键。**

稍后，您从`miArray`. 这个字典是你用一个键创建的，即“用户名”。您告诉它为键“id”获取一个对象，但由于您从未指定该键，因此您会得到一个`nil`值。

底线，试试我的解决方案。

# c++ - C++ 2011：基于范围的循环展开？

> ID：10678419
> 
> 赞同：2
> 
> 时间：2012-05-21T00:37:13.017
> 
> 标签：c++, loops, compiler-construction, c++11

我想知道 C++ 编译器是否会像当前对“正常”循环一样展开基于范围的循环以最大限度地提高性能，或者在某些情况下基于范围的循环会比正常循环慢？

非常感谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T01:16:25.000

基于范围的循环相当于：

```
{
  auto && __range = ( /expression/ );
  for (auto __begin = begin(__range),
            __end   = end(__range);
       __begin != __end;
       ++__begin) {
    /declaration/ = *__begin;
    /statement/
  }
} 
```

如果编译器知道迭代次数并且它可以解决循环依赖关系或循环是独立的，那么编译器可以自由展开。

一般来说，循环展开只会提高较小循环的性能。因此，IMO，是否展开基于范围的循环并不重要。您当然可以使用`-O3`and`-funroll-loops`和相关选项进行基准测试，以查看两者之间是否确实存在任何差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T01:16:28.703

编译器很有可能将基于范围的 for 循环转换为它们的常规循环对应物，所以我希望它们是等价的。

# search - Solr 合并结果

> ID：10678420
> 
> 赞同：0
> 
> 时间：2012-05-21T00:37:20.447
> 
> 标签：search, solr, merge, distributed

我在我们的网站上使用 Solr 进行产品过滤，

例如，您可以有一个产品过滤器，您可以在其中按尺寸、价格、公司等过滤电视数据库。我发现 Solr+FilterQuery 对于此类功能非常有效。我有一个单独的核心，其中包含我们数据库中所有电视的产品信息。

我有另一个核心用于产品评论。评论可以针对特定的产品类型或公司。所以有人可以在三星电视或三星客户服务上写评论。所以当有人搜索一个文本（例如“三星电视评论”或“三星客户服务”）时，我搜索这个核心。

现在我想合并上述核心的结果。因此，当有人搜索“三星 46 lcd 对比度评论”时，我基本上想按公司（三星）过滤电视，然后按尺寸（46 英寸），然后找到带有“对比度评论”文字的评论。我没有线索如何做到这一点基本上我想按文档ID合并结果并将结果2的附加列添加到结果1中。

我已经看到了扁平化数据的建议，但我想在许多其他过滤器上使用评论索引。所以我不确定这是否是个好主意。此外，如果新评论开始出现，我不想重新索引产品的所有核心（即使增量重新索引也会触及很多产品）。

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:19:19.120

如果我的问题正确，那么您正在寻找的是 JOIN 功能。

[http://www.slideshare.net/lucenerevolution/grouping-and-joining-in-lucenesolr](http://www.slideshare.net/lucenerevolution/grouping-and-joining-in-lucenesolr)

[http://wiki.apache.org/solr/加入](http://wiki.apache.org/solr/Join)

# mysql - 转义 SQL 语句传递给 initWithFormat / stringWithFormat

> ID：10678421
> 
> 赞同：0
> 
> 时间：2012-05-21T00:37:30.633
> 
> 标签：mysql, objective-c, variadic-functions

我正在编写一个 SQL 语句类，它允许用户创建格式正确的 SQL 语句字符串。这个类将有一个方法 -(id)initWithFormat:(NSString *)format, ... 需要像 NSString 可变参数方法一样工作。然而，我想要改变的一件事是任何作为参数传递的 NSString 必须由 initWithFormat 自动转义。

例如，在初始化这样的语句之后（注意字符串参数有一个需要转义的“'”）：

```
MyStatement *statement = [[MyStatement alloc] initWithFormat:@"UPDATE myTable SET myField = %@ WHERE myID = %lu", @"David's Room", 1234]; 
```

结果语句字符串应为：

```
@"UPDATE myTable SET myField = "David\'s Room WHERE myID = 1234" 
```

编写函数来转义字符串很容易，但我不知道如何将它包含在 initWithFormat 方法中。谁能告诉我如何做到这一点？我曾考虑通过遍历格式字符串的每个字符来模拟 NSString initWithFormat 功能，找到以 % 开头的任何字符，并以某种方式使用 switch 语句将正确的类型附加到 NSMutableString 但这似乎过于复杂（即某些格式说明符是超过 1 个字符，例如有符号 16 位整数 %hi，并且该函数应考虑位置说明符，例如 %1$@ 等）。

我见过的所有可变参数教程都集中在以 nil 结尾的列表上，并没有展示如何有效地模拟 initWithFormat （包括来自 Apple 的技术问答，其标题为[“我如何编写一个采用可变数量参数的方法，例如NSString 的 +stringWithFormat:?"](http://developer.apple.com/library/mac/#qa/qa1405/_index.html) )。

提前致谢。

# ruby - Gem::LoadError 在 macbook 雪豹中安装 ruby 1.9.2

> ID：10678423
> 
> 赞同：1
> 
> 时间：2012-05-21T00:38:11.453
> 
> 标签：ruby, rubygems, rvm

我一直在尝试使用 Ruby 1.9.2-p290 在我的 macbook Snow Leoppard 10.6.8 中安装和运行 ruby​​onrails。

当我写`bundle install`我遇到这个问题时，不仅使用 Postgres，还使用 ​​SQLite 和 MySQL。

> 安装 pg (0.11.0) `/Users/felipevelasquez/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:585`:in `initialize': Permission denied -`/Users/felipevelasquez/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.11.0/Rakefile` (Errno::EACCES)

当我写`sudo bundle install`我有这个：

> /Users/felipevelasquez/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247：在`to_specs'中：找不到捆绑程序（> = 0）在 [mime-types-1.16、minitest-1.6.0、rack-1.3.2、rake-0.8.7、rdoc-2.5.8、rest-client-1.6.7、sequel-3.20.0、sinatra-1.0、 sqlite3-1.3.4, sqlite3-ruby-1.3.3, taps-0.3.23] (Gem::LoadError)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T06:55:15.893

这个问题的原因是：这可能是一个rvm错误，我经历过太早了。

要写入的目录没有权限，当您升级权限时，gem env 和 PATH 信息不会传递给它。

您可以尝试安装 rvm 和 ruby​​。或使用 sudo 命令导出您的环境和路径。例如：

```
sudo export GEM_HOME = /path/to/gem_home && bundle install 
```

# ipad - Apple Match - O 链接器 (Id) 错误

> ID：10678428
> 
> 赞同：0
> 
> 时间：2012-05-21T00:38:33.593
> 
> 标签：ipad, web-applications

我不知道这个错误在说什么。retrievePatients 方法与 WSDL 文件交互。究竟是什么错误？我要搜索什么来修复它？谢谢！

```
Ld /Users/chibb9/Library/Developer/Xcode/DerivedData/AllRelatedMethodsDemo-cixcxshgvqywvcgbqxcivzvomzuf/Build/Products/Debug-iphonesimulator/AllRelatedMethodsDemo.app/AllRelatedMethodsDemo normal i386
    cd "/Users/chibb9/MEDiSN Research/AllRelatedMethodsDemo"
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/clang
-arch i386 -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk
-L/Users/chibb9/Library/Developer/Xcode/DerivedData/AllRelatedMethodsDemo-cixcxshgvqywvcgbqxcivzvomzuf/Build/Products/Debug-iphonesimulator
-F/Users/chibb9/Library/Developer/Xcode/DerivedData/AllRelatedMethodsDemo-cixcxshgvqywvcgbqxcivzvomzuf/Build/Products/Debug-iphonesimulator
-filelist /Users/chibb9/Library/Developer/Xcode/DerivedData/AllRelatedMethodsDemo-cixcxshgvqywvcgbqxcivzvomzuf/Build/Intermediates/AllRelatedMethodsDemo.build/Debug-iphonesimulator/AllRelatedMethodsDemo.build/Objects-normal/i386/AllRelatedMethodsDemo.LinkFileList
-mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -lxml2 -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=50000 -framework SystemConfiguration -framework UIKit -framework Foundation -framework CoreGraphics -o /Users/chibb9/Library/Developer/Xcode/DerivedData/AllRelatedMethodsDemo-cixcxshgvqywvcgbqxcivzvomzuf/Build/Products/Debug-iphonesimulator/AllRelatedMethodsDemo.app/AllRelatedMethodsDemo

Undefined symbols for architecture i386:   "_retrievePatients", referenced from:
      -[MEDiSN20AidnWebServiceRunner run] in MEDiSN20AidnWebServiceRunner.o   "_OBJC_METACLASS_$_NSManagedObject", referenced from:
      _OBJC_METACLASS_$_Download in Download.o   "_OBJC_CLASS_$_NSManagedObject", referenced from:
      _OBJC_CLASS_$_Download in Download.o ld: symbol(s) not found for architecture i386 clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T04:00:34.227

在 Download.h 或 .m 中，链接到和`#import <CoreData/CoreData.h>`

# php - Facebook Opengraph 读取操作

> ID：10678430
> 
> 赞同：0
> 
> 时间：2012-05-21T00:40:07.450
> 
> 标签：php, facebook, facebook-opengraph

是的，我问了一个类似的问题，但没有连贯地表达出来，所以就这样吧。

我正在尝试使用 Facebook opengraph 来使用 php 代码对我网站上的文章发起阅读操作。

我想使用 opengraph 发布当前 url 的读取操作。到目前为止我已经尝试过了，但没有任何乐趣

```
 <?php
function curPageURL() {
 $pageURL = 'http';
 if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
 $pageURL .= "://";
 if ($_SERVER["SERVER_PORT"] != "80") {
  $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
 } else {
  $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
 }
 return $pageURL;
}
?>

<?php

$facebook->api('https://graph.facebook.com/me/:read?  
                article='echo curPageURL();'','POST')

?> 
```

正如许多聪明的木鞋指出的那样，我是新手，这是我最好的尝试，所以请耐心等待

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T08:46:20.410

API 调用看起来不正确。如果您正在使用内置的“读取”操作，请尝试以下操作：

```
$facebook->api('/me/news.reads?article=' . curPageURL(),'POST'); 
```

您无需在 API 调用中使用完整的图形 URL。确保您也有权为用户发布操作，否则 API 调用将失败。如果调用成功，您将返回已发布操作的 ID。

# javascript - setinterval 方法不起作用

> ID：10678432
> 
> 赞同：2
> 
> 时间：2012-05-21T00:40:26.000
> 
> 标签：javascript, jquery

我有一个按钮，每 1 秒触发一次设置间隔内的功能。按钮的值变为停止。当我点击停止时，我调用 clearinterval 方法。由于某种原因，清除间隔方法不起作用。

这是我的输入

```
<input id="trigger" type="button" value="start"/> 
```

我的js函数

```
$(function() {
    $('#trigger').click(function() {
        var timerId = 0;
        var trigger = $('#trigger').val();

        if(trigger == 'start') {
            timerId = setInterval(function() {
                $('#trigger').val('stop');
                main();
            }, 1000);
        } else if(trigger == 'stop') {
                clearInterval(timerId);
                $('#trigger').val('start');                
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T00:42:31.937

您将 timerId 定义为 click() 范围的本地，因此当您第二次运行它时（在停止事件中），它将再次为 0。试试这个

```
var timerId = 0;
$(function() {
    $('#trigger').click(function() {
        var trigger = $('#trigger').val();

        if(trigger == 'start') {
            timerId = setInterval(function() {
                $('#trigger').val('stop');
                main();
            }, 1000);
        } else if(trigger == 'stop') {
                clearInterval(timerId);
                $('#trigger').val('start');                
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:42:56.310

每次单击 #trigger 时，您都会重新初始化 timerId。移动 `var timerId = 0;`外点击功能

# linux - 使用 ncftp 从远程 ftp 删除超过 7 天的备份

> ID：10678435
> 
> 赞同：1
> 
> 时间：2012-05-21T00:41:52.323
> 
> 标签：linux, shell, ftp

我目前正在使用来自cyberciti的这个脚本

```
#!/bin/sh
# System + MySQL backup script
# Full backup day - Sun (rest of the day do incremental backup)
# Copyright (c) 2005-2006 nixCraft <http://www.cyberciti.biz/fb/>
# This script is licensed under GNU GPL version 2.0 or above
# Automatically generated by http://bash.cyberciti.biz/backup/wizard-ftp-script.php
# ---------------------------------------------------------------------
### System Setup ###
DIRS="/home /etc /var/www"
BACKUP=/tmp/backup.$$
NOW=$(date +"%d-%m-%Y")
INCFILE="/root/tar-inc-backup.dat"
DAY=$(date +"%a")
FULLBACKUP="Sun"
### MySQL Setup ###
MUSER="admin"
MPASS="mysqladminpassword"
MHOST="localhost"
MYSQL="$(which mysql)"
MYSQLDUMP="$(which mysqldump)"
GZIP="$(which gzip)"
### FTP server Setup ###
FTPD="/home/vivek/incremental"
FTPU="vivek"
FTPP="ftppassword"
FTPS="208.111.11.2"
NCFTP="$(which ncftpput)"
### Other stuff ###
EMAILID="admin@theos.in"
### Start Backup for file system ###
[ ! -d $BACKUP ] && mkdir -p $BACKUP || :
### See if we want to make a full backup ###
if [ "$DAY" == "$FULLBACKUP" ]; then
  FTPD="/home/vivek/full"
  FILE="fs-full-$NOW.tar.gz"
  tar -zcvf $BACKUP/$FILE $DIRS
else
  i=$(date +"%Hh%Mm%Ss")
  FILE="fs-i-$NOW-$i.tar.gz"
  tar -g $INCFILE -zcvf $BACKUP/$FILE $DIRS
fi
### Start MySQL Backup ###
# Get all databases name
DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
for db in $DBS
do
 FILE=$BACKUP/mysql-$db.$NOW-$(date +"%T").gz
 $MYSQLDUMP -u $MUSER -h $MHOST -p$MPASS $db | $GZIP -9 > $FILE
done
### Dump backup using FTP ###
#Start FTP backup using ncftp
ncftp -u"$FTPU" -p"$FTPP" $FTPS<<EOF
mkdir $FTPD
mkdir $FTPD/$NOW
cd $FTPD/$NOW
lcd $BACKUP
mput *
quit
EOF
### Find out if ftp backup failed or not ###
if [ "$?" == "0" ]; then
 rm -f $BACKUP/*
else
 T=/tmp/backup.fail
 echo "Date: $(date)">$T
 echo "Hostname: $(hostname)" >>$T
 echo "Backup failed" >>$T
 mail  -s "BACKUP FAILED" "$EMAILID" <$T
 rm -f $T
fi 
```

它工作得很好，但是我的备份在远程服务器上占用了太多空间，所以我想修改这个脚本，以便删除 7 天之前的那些。有人可以告诉我要编辑什么吗？不过，我对 shell 脚本或 ncftp 命令一无所知。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T23:52:22.177

我没有一个实用的方法来尝试我在下面输入的内容 - 我怀疑这可行，但如果不是，它至少会显示正确的想法。请不要在没有经过彻底测试的情况下使用这些模组——如果我填满了它可能会删除你的数据，但这里是：

在下面的行：NOW=$(date +"%d-%m-%Y")
添加：

```
DELDATE=$(date -d "-7 days" +"%d-%m-%Y")

```

行后： ncftp -u"$FTPU" -p"$FTPP" $FTPS<<EOF
添加：

```
cd $FTPD/$DELDATE
rm *
光盘 $FTPD
rmdir $DELDATE

```

这些变化背后的理论如下：
第一个加法计算的是 7 天前的日期。
第二个添加尝试删除旧信息。

# javascript - JQuery - 如何识别先前选择的按钮

> ID：10678436
> 
> 赞同：0
> 
> 时间：2012-05-21T00:42:27.657
> 
> 标签：javascript, jquery

设想：

存在一个简单的 html 页面，页面顶部（例如，日、周）和底部（过滤器 1 和过滤器 2）和中心的图形有几个按钮。

该图显示基于选定过滤器的数据。

问题：

当用户选择 filter2 时，我需要知道用户之前在 TOP 按钮上选择了什么，以便相应地显示数据。

我正在使用全局变量来跟踪最后选择的按钮。这意味着很多 switch 语句。我想知道这是否是解决这个问题的最优雅的方法，或者有什么魔力。Jquery 上存在函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:52:19.573

我认为最简单的方法是使用`data`元素本身。

```
<button id="day" class="graph-button" data-state="off">Day</button>
<button id="week" class="graph-button" data-state="off">Week</button>
<!-- graph here -->
<button id="filter1" class="graph-button" data-state="off">Filter 1</button>
<button id="filter2" class="graph-button" data-state="off">Filter 2</button> 
```

然后你可以有一些像这样的jQuery：

```
$(function(){
    $('.graph-button').click(function(ev){
        ev.preventDefault();

        var state = $(this).data('state'),
            newState = state == 'off' ? 'on' : 'off',
            onButtons = [];

        $(this).data('state', newState);

        $('.graph-button[data-state="on"]').each(function(i, el){
            onButtons.push(this.id);
        });

        // updateGraphWith(onButtons);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T01:07:11.050

假设顶部按钮有`class="topButton"`，过滤器按钮有`class="filterButton"`，所有按钮都有唯一的 id，那么 jQuery 看起来像这样：

```
$(function(){
    var topButtons = $(".topButton").on('click', function() {
        var $this = $(this);
            id = $this.attr('id');
        if($this.hasClass('selected')) { return; }
        topButtons.removeClass('selected');
        $this.addClass('selected');
        //perform click action here
    });

    $('.filterButton').on('click', function() {
        var $this = $(this);
            id = $this.attr('id'),
            selectedTopButtonId = $('.topButton').filter('.selected').attr('id');
        //perform filter action here
    });
}); 
```

在这两种情况下，变量都会`id`让您知道单击了哪个按钮。

通过设置`class="selected"`选定的顶部按钮，您可以设置按钮样式并进行测试，而无需求助于全局变量。

# java - 在 Java 中将 TextBox 的字符串文本转换为数字

> ID：10678438
> 
> 赞同：1
> 
> 时间：2012-05-21T00:42:34.650
> 
> 标签：java, eclipse, jform-designer

好的，所以我有一个文本框。这个文本框写有 BLAHH 字样。我不明白的部分是如何将 TextBox 中的文本更改为 Int？我试过把 Int 变成字符串形式。我不是想把字符串放回 Int 形式。我试图让字符串更改显示 int 编号的文本...

```
 //---- Money ----
    String str = Integer.toString(money); 
    Money.setText(str);
    add(Money, CC.xy(21, 1)); 
```

Ps 我正在为 Eclipse 使用 JFormDesigner 插件！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:45:09.783

如果您有一个字符串“str”，则可以使用以下方法将其转换为 int：

```
String str = Money.getText();
try {
int number = Integer.parseInt(str);
}
catch (NumberFormatException e) {
//What to do if Money did not hold an int?
} 
```

# javascript - 访问 js 函数中的变量

> ID：10678439
> 
> 赞同：1
> 
> 时间：2012-05-21T00:42:37.737
> 
> 标签：javascript

所以我有一个伪类，里面有函数和变量。例如：

```
function MyClass()
{
    this.a = 0;
    this.b = function(c)
    {
        this.a += c;
    }
} 
```

然后，当我以后去使用它时，我会这样做：

```
var myObject = new MyClass();
myObject.b(3);
myObject.b(5); 
```

但是当我这样做时：

```
console.log("A: " + myObject.a); 
```

我得到：

```
A: 0 
```

我究竟做错了什么？

这是我的实际代码。它被分成多个文件，但我会提出相关的文件：

```
function SongDatabase() {

    this.songs = new Array();

    this.loadSongs = function () {

    };

    this.saveSongs = function () {

    };

    var _Constructor_ = function () {
            var mySong = new Song();
            this.songs = new Array(mySong);
        };
    _Constructor_();
}

function LyriX() {
    var songDatabase = new SongDatabase();
    //var playlistDatabase = new PlaylistDatabase();
    songDatabase.loadSongs();
    var sourceList = new ScrollableList();
    sourceList.setElement($S.getElement("sourceList"));
    var accessoryList = new ScrollableList();
    accessoryList.setElement($S.getElement("accessoryList"));

    var sourceListClick = function (index) {
            $S.log("source click: " + index);
            if (index == 0) {
                displaySongs();
            }
        };
    sourceList.setClickListener(sourceListClick);

    var displaySongs = function () {
            $S.log("display songs");
            // STACK OVERFLOW LOOK HERE!!! thanks :)
            // in debug in chrome songDatabase.songs is a zero length array
            accessoryList.loadArray(songDatabase.songs);
        };
}

$S.addOnLoadListener(function () {
    new LyriX();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:28:59.853

一题：

```
> var _Constructor_ = function () {
>    var mySong = new Song();
>    this.songs = new Array(mySong);
> };
> _Constructor_(); 
```

在上面，当`_Constructor_`作为函数调用时，您没有设置它的`this`值，因此它默认为全局对象（在非严格模式下，或在严格模式下未定义）。所以`songs`成为全局变量或在严格模式下抛出错误。

无论如何，这似乎是相当无用的功能，请考虑：

```
this.songs = [ new mySong() ]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:45:14.210

```
function MyClass()
{
    this.a = 0;
    this.b = function(c)
    {
        this.a += c;
    }
} 
```

变成`a+=c`_`this.a+=c;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T03:25:38.697

我看到有人从字面上理解 JavaScript 中的“Java”。:)

关于 JavaScript，你应该知道的几件事：

1.  在 JavaScript 中，数组不像在其他语言中那样工作。它们更像是字典，而不是你在 C 或 Java 中称为数组的东西。它们并没有显着提高内存效率或速度；没有进行预分配；在低级实现中没有偏移等。JavaScript 数组只不过是一种方便（但很有用！）的结构，用于保存命令式数据。

2.  可以使用`new Array(length)`表达式或简单的文字表达式创建数组`[]`。通常，您需要使用数组字面量`[]`.

3.  使用`new Array(length)`并没有真正做任何有用的事情。它设置了数组的初始`length`属性，但基本上就是这样。所有元素都保留`undefined`。没有额外的约束或边界检查。您可以`a[100] = 'whatever'`对通过调用创建的数组进行操作`var a = new Array(5)` ，并且解释器不会眨眼。

4.  JavaScript 使用原型继承，这与 C++ 和 Java 等语言中使用的经典继承模型有很大不同。

考虑到这些要点，让我们检查以下代码块：

```
function SongDatabase() {
    this.songs = new Array();
    this.loadSongs = function () {
        // etc.
    };

    this.saveSongs = function () {
        // etc.
    };

    var _Constructor_ = function () {
        var mySong = new Song();
        this.songs = new Array(mySong);
    };
    _Constructor_();
} 
```

这段代码可能没有做你认为它正在做的事情。

1.  通过初始化函数`SongDatabase`内部的方法，`SongDatabase()`您正在为每个`songDatabase`. 当您处理几十个实例时，这可能没什么大不了的，但如果您要处理*数百个*实例，则所需的额外内存可能会成为问题。您将希望在`prototype`此处使用该模式（见下文）。
2.  你的`_Constructor_`功能没有做任何事情。 `var mySong = new Song()`创建函数`mySong`本地的新对象，`_Constructor_`并且*在其外部不可访问*。当`_Constructor_`调用返回时，它的`mySong`变量被垃圾收集（就像任何其他局部变量一样）。
3.  `_Constructor_`是私有函数而**不是方法**；我不完全确定`this`在这种情况下会参考什么。您最终可能会在全局对象上创建一个歌曲属性（但我想对此进行测试以确定）。
4.  正如我之前提到的，当您`Array()`使用`new`运算符调用时，它需要一个可选参数来设置数组的初始`length`值。在这种情况下，解释器将尝试强制`mySong`转换为一个数字（`mySong`不添加到数组中！）**；**当失败时，它将简单地返回一个带有`length = 0`.

相反，你最好`SongDatabase()`这样写：

```
function SongDatabase() {
    this.songs = [];
    // etc.
}

SongDatabase.prototype.loadSongs = function () {
    // load songs into `this.songs`
};

SongDatabase.prototype.saveSongs = function () {
    // save songs loaded into `this.songs`
}; 
```

The prototypal pattern may look strange, but its probably the best way to handle your use case. You'll still have direct access to then `songs` array (which may or may not be important), and by attaching the `loadSongs` and `saveSongs` functions to `SongDatabase`'s prototype you ensure that those functions are shared.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T00:48:10.403

变量不像其他语言那样绑定到“类”。将其视为具有属性的对象。一个单一的`a`只是引用一个变量“a”（没有`var`在函数中声明，所以在这里甚至是全局的）。您想更新对象的*属性*“a”，请改用（[点运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Member_Operators)访问该属性）。您可能还想阅读[使用对象](https://developer.mozilla.org/en/JavaScript/Guide/Working_with_Objects)。`this``this.a`

* * *

编辑后（你说你一直在使用`this.a`），它对我有用：http: [//jsfiddle.net/WKuZe/](http://jsfiddle.net/WKuZe/)

* * *

在您向我们提供您的真实代码后，我注意到了这个奇怪的结构：

```
function SongDatabase() {
    this.songs = new Array();
    // some methods
    var _Constructor_ = function () {
        var mySong = new Song();
        this.songs = new Array(mySong);
    };
    _Constructor_();
} 
```

构造函数 like `SongDatabase`is （使用`new`关键字）使用新实例调用 as `this`。一个普通的函数通常被什么都调用，即非严格模式下的`this`is或全局对象。`undefined`请参阅[MDN 上](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)[的关键字文档`this`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)。

`songs`在这里，您首先使用一个空数组初始化 songDatabases 的属性。然后，在`_Constructor_`函数中，您使用一首歌曲创建另一个数组，但将其分配给`window.songs`，因为未在 songDatabase 实例上[调用该函数。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)`loadSongs()`您的方法中可能会出现同样的问题。除了调用和[绑定](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)为实例对象提供“静态”引用的常用方法之外，还有一个作用域变量：

```
function SongDatabase() {
    var that = this; // <== always points to the instance
    // some methods
    function _Constructor_ () {
        var mySong = new Song();
        that.songs = new Array(mySong);
    //  ^^^^
    };
    _Constructor_();
} 
```

如果您`_Constructor_`不是本地函数，而可能是添加接口的全局函数，您可以提供实例 ( `this`) 作为参数或使用`_Constructor_.call(this)`，它允许将`this`关键字用作`_Constructor_`“类”。

# c - 在 OSX（Boehm 的垃圾收集器）上安装 libgc

> ID：10678440
> 
> 赞同：2
> 
> 时间：2012-05-21T00:42:40.483
> 
> 标签：c, macos, garbage-collection, shared-libraries

我开始在我正在制作的库中使用引用计数。这是一个相当不错的解决方案，增量和减量不会像某些人错误地认为的那样浪费很多资源。此外，用于引用计数的额外内存也可以忽略不计。

但显然跟踪垃圾收集是如此之好，以至于它比使用 malloc/free 更好。我不确定这是否属实，所以我想尝试一下（通过一次释放多个对象来进行后端优化？）。GC 也会使我的库更易于使用，因为不需要调用保留/释放函数。

编辑：问题是 gc/gc.h 无限地包含自己。这没有意义...

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-15T15:21:50.843

这个问题比较模糊。您想知道一般如何使用 libgc 还是想知道如何让它在 mac OS X 上运行？如果以后是这种情况，那么我建议使用 Homebrew。它有一个相当不错的 libgc 公式。只需使用命令：

```
brew install libgc 
```

`/usr/local/Cellar/libgc/7.6.0`这将根据 HomeBrew 公式中可用的最新版本安装库。

您对 gc.h 不定式指代自己的困惑实际上是不正确的。因为在第一个 gc.h 包含的 gc 子文件夹中还有另一个 gc.h。我不知道他们为什么要这样设计它！

# python - 翻转列表Python中的布尔值

> ID：10678441
> 
> 赞同：78
> 
> 时间：2012-05-21T00:42:44.500
> 
> 标签：python

我在 Python 中有一个布尔列表

```
mylist  = [True , True, False,...] 
```

我想将其更改为逻辑上的对立面`[False, False, True , ...]` 是否有一种内置的方法可以在 Python 中执行此操作（类似于 call `not(mylist)`），而无需手写循环来反转元素？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-05-21T00:43:52.057

列表理解很容易：

```
mylist  = [True , True, False]

[not elem for elem in mylist] 
```

产量

```
[False, False, True] 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2014-10-03T21:22:28.013

一元波浪号运算符 (~) 将为 numpy.ndarray 执行此操作。所以：

```
>>> import numpy
>>> mylist = [True, True, False]
>>> ~numpy.array(mylist)
array([False, False, True], dtype=bool)
>>> list(~numpy.array(mylist))
[False, False, True] 
```

请注意，翻转列表的元素将是 numpy.bool_ 而不是 bool 类型。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-21T00:48:36.643

```
>>> import operator
>>> mylist  = [True , True, False]
>>> map(operator.not_, mylist)
[False, False, True] 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-02-01T09:47:56.663

Numpy 明确地包含了这个功能。函数“numpy.logical_not(x[, out])”按元素计算 NOT x 的真值。

```
import numpy
numpy.logical_not(mylist) 
```

[http://docs.scipy.org/doc/numpy-1.10.0/reference/generated/numpy.logical_not.html](http://docs.scipy.org/doc/numpy-1.10.0/reference/generated/numpy.logical_not.html)（有相同的例子）

例子：

```
import numpy
mylist  = [True , True, False]
print (mylist) 
```

返回 [真，真，假]

```
mylist=numpy.logical_not(mylist)
print (mylist) 
```

返回 [假假真]

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-01-19T13:09:09.830

numpy.invert 是另一个不错的选择：

```
x = [False, True, True] 
not_x = np.invert(x) # [True, False, False] 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-05-21T00:44:06.457

为什么不只使用简单的列表推导？

```
mylist[:] = [not x for x in mylist] 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-05-21T00:49:24.257

我会按照其他人所说的方式来做，但是为了记录替代方案，您也可以这样做

```
import operator
myList = map(operator.not_, myList) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-07-30T08:16:34.223

下面的呢

```
>>> import numpy
>>> list(numpy.asarray(mylist)==False) 
```

# c++ - 如何使用语义操作中的查找（boost::spirit）将解析的字符串更改为 int？

> ID：10678445
> 
> 赞同：1
> 
> 时间：2012-05-21T00:43:39.357
> 
> 标签：c++, boost, boost-spirit

在`boost::spirit`，我怎样才能读入一个，立即在数据库中`string`查找它的值并将值分配给一个？因此，即使它被解析为字符串，规则的属性也会是。`int``boost::spirit``int``int`

例如，这个输入

```
myCoolKey 3.4 
```

可以解析为一对：(87, 3.4)，其中字符串“myCoolKey”通过（伯克利）数据库查找`(int,double)`映射到。`87`

我想要这样的代码：

```
typedef std::pair<int, double> Entry;
qi::rule<Iterator, Entry(), Skipper> entry;
entry %= +qi::char_[qi::_val = mylookup(qi::_1)]
         >> qi::double_; 
```

这是一个完整的代码示例。我将如何调用查找已解析字符串的函数，并将`boost::spirit`查找到的值分配给`int`?

```
#include <iostream>
#include <boost/foreach.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/support_istream_iterator.hpp>
#include <boost/fusion/include/std_pair.hpp>
namespace qi = boost::spirit::qi;

typedef std::pair<int, double> Entry;

struct Lookup {
  MyDB db;
  int lookup(std::string const& str) {
    return db.lookup(str);
  }
};

template <typename Iterator, typename Skipper>
struct MyGrammar : qi::grammar<Iterator, std::vector<Entry>(), Skipper> {
  MyGrammar() : MyGrammar::base_type(entries) {
    entry %= +qi::char_[qi::_val = myLookup.lookup(qi::_1)]
        >> qi::double_;
    entries = +entry;
  }
  Lookup myLookup;
  qi::rule<Iterator, Entry(), Skipper> entry;
  qi::rule<Iterator, std::vector<Entry>(), Skipper> entries;
};

int main() {
  typedef boost::spirit::istream_iterator It;
  std::cin.unsetf(std::ios::skipws);
  It it(std::cin), end;

  MyGrammar<It, qi::space_type> entry_grammar;
  std::vector<Entry> entries;
  if (qi::phrase_parse(it, end, entry_grammar, qi::space, entries)
      && it == end) {
    BOOST_FOREACH(Entry const& entry, entries) {
      std::cout << entry.first << " and " << entry.second << std::endl;
    }
  }
  else {
    std::cerr << "FAIL" << std::endl;
    exit(1);
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:10:35.000

最快的方法是使用phoenix bind

```
qi::_val = phx::bind(&Lookup::lookup, myLookup, qi::_1) 
```

使用融合函数或“多态可调用对象”有更优雅的解决方案，但我现在参考文档：

*   [http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html](http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html)
*   [http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html#spirit.qi.tutorials.semantic_actions.examples_of_semantic_actions](http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html#spirit.qi.tutorials.semantic_actions.examples_of_semantic_actions)

**编辑**我发现您的其余代码无法编译（由于其他原因）。这是一个编译示例（带有存根查找功能）：

```
#include <boost/spirit/include/phoenix.hpp>
namespace phx = boost::phoenix;
//  ...

template <typename Iterator, typename Skipper>
struct MyGrammar : qi::grammar<Iterator, std::vector<Entry>(), Skipper>
{
    MyGrammar() : MyGrammar::base_type(entries)
    {
        using namespace qi;
        intpart = as_string [+char_] 
                 [ _val = phx::bind(&Lookup::lookup, myLookup, _1) ];
        entry = intpart >> double_;
        entries = +entry;
    }
  private:
    Lookup myLookup;
    qi::rule<Iterator, int(), Skipper> intpart;
    qi::rule<Iterator, Entry(), Skipper> entry;
    qi::rule<Iterator, std::vector<Entry>(), Skipper> entries;
}; 
```

`intpart`你可以通过做事`qi::as<>`或魔法来绕过额外的规则`qi::attr_cast<>`，但坦率地说，这种方式更具可读性。

# android - 捆绑包无法解析为类型

> ID：10678446
> 
> 赞同：2
> 
> 时间：2012-05-21T00:43:46.180
> 
> 标签：android

我正在尝试完成第一节 Android 课程，但我遇到的一个错误是“Bundle cannot be resolve to a type”

这是代码：

```
package com.example.myapp;

import android.app.Activity;

public class DisplayMessageActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }
} 
```

当我查看项目属性时，它具有平台 2.1 和 API 级别 7 的“Android 开源项目”的“Android 2.1”。这被选中作为项目构建目标。

我使用了错误的项目构建目标？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T00:46:24.940

您需要添加：

`import android.os.Bundle;`

到您的进口清单。

# java - 有人可以帮我帮我的电脑找到java中的主类吗？

> ID：10678451
> 
> 赞同：-2
> 
> 时间：2012-05-21T00:44:19.487
> 
> 标签：java, class

> **可能重复：**
> [如何创建实际运行的 .jar 文件？](https://stackoverflow.com/questions/10670767/how-to-create-a-jar-file-that-actually-runs)

当我把我的类变成一个jar文件时，计算机找不到主类。我可以从命令行运行它，但不能双击它！当我双击它时，它说找不到主课：robert.Start（开始是我的主课！）有人可以帮我吗？我有一个清单文件和所有内容，这是里面写的

```
Manifest-Version: 1.0
Class-Path: .
Main-Class: robert.Start 
```

我的目录是这样的：

在 Interest.jar 里面有：

元信息

罗伯特

罗伯特里面是我的课

有人能帮助我吗？即使我不手动创建清单文件，它仍然无法运行！

我正在使用 Windows 7。

我解决了这个问题。当我用 jre7 运行程序时它不起作用。但是使用 jre6 可以正常工作！我想知道为什么 ：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T00:47:09.470

你没有`robert.Start`正确包装。

打开 JAR 并查找`Start.class`. 当你找到它时，确保路径是`robert`. 如果不是，你有你的答案。

CLASSPATH 也可能是一个问题。如果您在运行时不使用 -cp 选项，则还必须在清单中设置 Class-Path。

# artificial-intelligence - 在简单的爬山中添加模拟退火

> ID：10678452
> 
> 赞同：2
> 
> 时间：2012-05-21T00:44:37.827
> 
> 标签：artificial-intelligence, simulated-annealing, hill-climbing

我创建了一个爬山算法，它随机生成一个解决方案，然后复制该解决方案并对其进行一些变异，看看它是否最终得到一个更好的解决方案。如果是这样，它会保留新的解决方案并丢弃旧的解决方案。

如果我想在该算法中添加模拟退火，我是否可以从更高的突变率开始，并在每次创建新解决方案时稍微降低突变率？

我假设突变率将作为模拟退火算法的温度，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T17:30:51.710

突变率将作为退火的温度，但*每次*仅选择更好的解决方案不会是完美的模拟退火。

您需要根据*它*的好坏程度和*突变率*来选择更好的选择。（即 deltaE 和温度），以便您允许模拟退火摆脱局部最优。如果您继续选择最佳选择，您可能会陷入局部最优。

# sql-server - Http post SQL Server 2000 存储过程

> ID：10678454
> 
> 赞同：0
> 
> 时间：2012-05-21T00:44:55.850
> 
> 标签：sql-server, stored-procedures, sql-server-2000, http-post, url-encoding

我们在通过 SQL Server 2000 上的存储过程发送 http post 时遇到问题。SQL 是我们必须发送 http post 的唯一方法。

我们显然没有发送 [fin , ack] 并且连接没有足够快地关闭。谁能告诉我问题是什么？

```
CREATE procedure HTTP_POST( @sUrl varchar(200), @response varchar(8000) out)
As

Declare
@obj int
,@hr int
,@status int
,@msg varchar(255)

exec @hr = sp_OACreate 'MSXML2.ServerXMLHttp', @obj OUT

exec @hr = sp_OAMethod @obj, 'open', NULL, 'POST', @sUrl, false
if @hr <>0 begin set @msg = 'sp_OAMethod Open failed' goto eh end

exec @hr = sp_OAMethod @obj, 'setRequestHeader', NULL, 'Content-Type',
'application/x-www-form-urlencoded'
if @hr <>0 begin set @msg = 'sp_OAMethod setRequestHeader failed' goto
eh end

exec @hr = sp_OAMethod @obj, send, NULL, ''
if @hr <>0 begin set @msg = 'sp_OAMethod Send failed' goto eh end

exec @hr = sp_OAGetProperty @obj, 'status', @status OUT
if @hr <>0 begin set @msg = 'sp_OAMethod read status failed' goto
eh
end

if @status <> 200 begin set @msg = 'sp_OAMethod http status ' +
str(@status) goto eh end

exec @hr = sp_OAGetProperty @obj, 'responseText', @response OUT
if @hr <>0 begin set @msg = 'sp_OAMethod read response failed' goto
eh end

exec @hr = sp_OADestroy @obj
return
eh:

exec @hr = sp_OADestroy @obj
return
GO 
```

我这样调用存储过程

```
exec HTTP_POST 'http://123.123.123.123/example.webservice?time=201205021000000' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T06:40:13.967

我猜问题出在底层操作系统（Windows）上；处理连接后，很可能会长时间保持 TCP 连接打开。

要验证，请`netstat -a -p tcp`在执行存储过程之前和之后检查；寻找一个连接，看看它什么时候死掉。我猜想在你的 sproc 完成执行后，连接就会消失，处于一个`TIME_WAIT`状态。Windows 将保持连接活动 2-4 分钟 IIRC。一种可能解决此问题的方法是添加自定义 HTTP 标头 ( `Connection: Close`)，以便远程服务器在执行后关闭连接。一些“常规”代码如下所示，您只需将其调整为您的 SQL 函数： `serverXMLHTTP.setRequestHeader("Connection","Close");`

如果这些都不起作用，我会使用 Wireshark 来跟踪连接以及何时发送哪些数据包以帮助隔离问题。祝你好运

# php - 解析 RSS 以用作源

> ID：10678455
> 
> 赞同：0
> 
> 时间：2012-05-21T00:45:06.653
> 
> 标签：php, javascript, jquery, html

好的，所以我试图拥有一个每 30 秒旋转一次的网页，现在我拥有了我需要的东西，而不是像我现在看到的那样使用数组，请参见下面的代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Rotating Page</title>
<style type="text/css">
* {
    margin:0;
    padding:0;
    border:0;
}
html, body, iframe {
    height:100%;
    width:100%;
    overflow:hidden;
}    
</style>
<script type="text/javascript">
var pages = new Array(); // this will hold your pages
pages[0] = 'MY-LINK-HERE';
pages[1] = 'MY-LINK-HERE';
pages[2] = 'MY-LINK-HERE';
pages[3] = 'MY-LINK-HERE';
pages[4] = 'MY-LINK-HERE';
pages[5] = 'MY-LINK-HERE';

var time = 30; // set this to the time you want it to rotate in seconds

// do not edit
var i = 1;
function setPage()
{
    if(i == pages.length)
    {
        i = 0;  
    }
    document.getElementById('holder').setAttribute('src',pages[i]);
    i++;
}    
setInterval("setPage()",time * 1000);
// do not edit
</script>
</head>

<body>
<iframe id="holder" src="MY-SPLASH-PAGE-HERE" frameborder="0" scrolling="no"></iframe>
</body>
</html> 
```

在 MY-LINK-HERE 中的 pages 数组中我想使用我的 rss 链接并获取链接列表并将它们添加到 pages 数组或类似的东西

我的 rss 链接是[http://directitpros.com/cbm/wp/?feedpages](http://directitpros.com/cbm/wp/?feedpages)

所以我只想在 pages 变量中加载文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T03:11:15.700

我花了一些时间，但我得到了它（测试和工作）

*   此示例使用 jQuery 和 jGFeed。
*   jGFeed 是一个 jQuery 插件，可以用 RSS 提要做任何你想做的事情。
*   在 HTML 源代码中，您可以获取插件的 URL 以保存它。

**观察：**

**1.**您的RSS链接不正常，请检查！（[http://directitpros.com/cbm/wp/?feedpages](http://directitpros.com/cbm/wp/?feedpages)）

使用您的链接时，我从浏览器控制台中使用的插件收到此错误：

```
"Uncaught TypeError: Cannot read property 'feed' of null" 
```

**2.**确保您要在 iframe 中使用的链接能够通过 iframe 浏览：

**例子：**

如果 URL 无法通过 iframe 浏览，您将在浏览器控制台中收到此消息，并且您的 iframe 将为空：

```
"Refused to display document because display forbidden by X-Frame-Options." 
```

**3.**如果您发现一个有效的 RSS url 和其中的链接符合上述要求，请使用我制作的这个实时示例进行测试：

[http://jsfiddle.net/oscarj24/qWdqc/](http://jsfiddle.net/oscarj24/qWdqc/)

（检查浏览器控制台并检查将出现的消息）

* * *

让我们使用代码:-)

**HTML：**

```
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script> 
<script src="http://dl.dropbox.com/u/15208254/stackoverflow/jquery.jgfeed.js" type="text/javascript"></script>
<iframe id="holder" src="" frameborder="0" scrolling="no"></iframe>​ 
```

**CSS：**

```
html, body, iframe {
    height:100%;
    width:100%;
    overflow:hidden;
}​ 
```

**JS：**

```
// Array containing pages
var pages = new Array();

// Time in seconds to rotate pages
var time = 30;

// Variable for loop purpose
var i = 1;

$(function(){

    $.jGFeed('http://working-rss-url',
      function(feeds){

        // Check for feeds
        if(!feeds){
          // There was an error, remote url not ok or no feeds
          return false;
        }

        // Do whatever you want with feeds here
        for(var i=0; i<feeds.entries.length; i++){
          var entry = feeds.entries[i];
          // Fill array with RSS entries
          pages.push(entry);
        }

        // If array contains urls
        if(pages.length != 0){
            // Rotate pages every 'x' seconds
            setInterval(function() {
                if(i == pages.length){
                   i = 0;  
                }
                // Replace iframe scr with RSS entry link every 'x' seconds
                $('#holder').attr('src', pages[i].link);
                i++;
            }, time * 1000);
        }

    }, 5); // Number of feeds you want to recover

}); 
```

希望这可以帮助。

# mongodb - 在 Mongo 中使用复合索引作为分片键有什么要求？

> ID：10678458
> 
> 赞同：1
> 
> 时间：2012-05-21T00:45:23.247
> 
> 标签：mongodb, sharding, compound-key

在MongoDB（特别是2.0.4）中使用复合索引作为shard key有什么要求。我在某处读到关键组件必须是唯一的，是这样吗？在设计复合分片键时还应该考虑哪些其他事情？关键组件的顺序重要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:51:04.500

这个主题通常在很多地方都有涉及：

*   [http://www.mongodb.org/display/DOCS/Configuring+Sharding](http://www.mongodb.org/display/DOCS/Configuring+Sharding)
*   [http://www.mongodb.org/display/DOCS/Choosing+a+Shard+Key](http://www.mongodb.org/display/DOCS/Choosing+a+Shard+Key)
*   [http://www.mongodb.org/display/DOCS/Sharding+Introduction](http://www.mongodb.org/display/DOCS/Sharding+Introduction)
*   [http://www.snailinaturtleneck.com/blog/2011/01/04/how-to-choose-a-shard-key-the-card-game/](http://www.snailinaturtleneck.com/blog/2011/01/04/how-to-choose-a-shard-key-the-card-game/)
*   [https://groups.google.com/forum/?fromgroups#!topic/mongodb-user/yolfc6B3JL8](https://groups.google.com/forum/?fromgroups#!topic/mongodb-user/yolfc6B3JL8)

至于您的具体问题，分片键不必是唯一的，尽管人们经常这样配置它。您可能指的是分片键是不可变的这一事实（也在上面讨论过）。

您还应该考虑所有（非多重）更新、更新和插入必须包含分片键，因此从这个角度来看，顺序可能很重要，特别是从性能角度来看 - 基于您的查询模式的更有效的顺序通常会是个好主意。这对于数据分发也可能是一个好主意，但实际上你的问题有点含糊。

稍微阅读一下上面的链接，看看这个主题的其他线程，然后问更具体的问题——如果你有建议的模式和数据使用描述，那就更好了。

# jquery - jQuery - CSS 下拉多级菜单动画

> ID：10678461
> 
> 赞同：3
> 
> 时间：2012-05-21T00:46:28.607
> 
> 标签：jquery, css, jquery-animate, easing

我有像这样的标准多级菜单：

```
<ul id="nav">
    <li><a href="#">Home</a></li>
    <li><a href="#">Dropdown</a>
       <ul class="sub-menu">
           <li><a href="#">Link #1</a></li> 
           <li><a href="#">Link #2</a></li>  
           <li><a href="#">Link #3</a></li>            
       </ul>
    </li>    
</ul> 
```

来源：http: [//jsfiddle.net/Dg2Cb/](http://jsfiddle.net/Dg2Cb/)

我想在此页面上设置子菜单高度的动画（看起来像 jswing 效果）：[http ://themes.truethemes.net/Karma/](http://themes.truethemes.net/Karma/)

是否有任何简单的（不像上面的例子那样混乱）的方法来实现这一点？

这是我设法创建的最佳效果（但它仍然看起来很糟糕，因为它也呈现宽度）：http: [//jsfiddle.net/Dg2Cb/1/](http://jsfiddle.net/Dg2Cb/1/)

我可以使用 jQuery 缓动插件，但很想在没有任何插件的情况下这样做。我知道如何为元素的高度设置动画，但棘手的部分是我必须同时更改它的可见性并为其设置动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:50:59.733

您可以尝试使用`.slideDown()`不为元素宽度设置动画的替代方法。[http://api.jquery.com/slideDown/](http://api.jquery.com/slideDown/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:54:20.353

试试这个：

```
jQuery("#nav li").hover(function() {
    jQuery(this).children('ul').slideDown();
},function(){
     jQuery(this).children('ul').slideUp();
}); 
```

[http://jsfiddle.net/Dg2Cb/3/](http://jsfiddle.net/Dg2Cb/3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T00:59:36.873

同时为高度和不透明度设置动画：

```
$("#nav > li").on("mouseenter mouseleave", function(e){
  e.type === "mouseenter" 
    ? $(".sub-menu", this).stop().animate({ height:'toggle', opacity:1 }, 250)
    : $(".sub-menu", this).stop().animate({ height:'toggle', opacity:0 }, 250) ;
});​ 
```

此外，不要设置`.sub-menu`为`visibility:hidden`- 而是设置为`display:none`.

小提琴：http: [//jsfiddle.net/Dg2Cb/6/](http://jsfiddle.net/Dg2Cb/6/)

# django - 使用 UserProfile 限制视图中的访问

> ID：10678462
> 
> 赞同：0
> 
> 时间：2012-05-21T00:46:46.000
> 
> 标签：django, django-views

我有一个在 html 发布页面上显示客户端资产的应用程序。每个被授权使用系统的客户都被分配了一个配置文件：

```
class UserProfile(models.Model):  
    user = models.ForeignKey(User, unique=True)
    fullname = models.CharField(max_length=64, unique=False)
    company = models.CharField(max_length=50, choices=CLIENT_CHOICES)
    position = models.CharField(max_length=64, unique=False, blank=True, null=True)
    ...

    User.profile = property(lambda u: UserProfile.objects.get_or_create(user=u)[0])

    def __unicode__(self):
        return u'%s' % self.fullname

    class Meta:
        ordering = ['fullname']

    class Admin: 
        pass 
```

并且有一个帖子页面的模型：

```
class PostPage(models.Model):
    client = models.CharField(max_length=50, choices=CLIENT_CHOICES)
    job_number = models.CharField(max_length=30, unique=True, blank=False, null=False)
    job_name = models.CharField(max_length=64, unique=False, blank=False, null=False)
    page_type = models.CharField(max_length=50, default='POST')
    create_date = models.DateField(("Date"), default=datetime.date.today)
    contact = models.ForeignKey(UserProfile)
    contact2 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)
    contact3 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)
    contact4 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)

    def __unicode__ (self):
            return u'%s %s %s' % (self.client, self.job_number, self.job_name)

    class Admin: 
            pass 
```

最后，一个非常简单的视图函数来显示页面：

```
def display_postings(request, job_number):
        records = PostPage.objects.filter(job_number=job_number)
        tpl = 'post_page.html'
        return render_to_response(tpl, { 'records': records }) 
```

问题是，如果您为“ACME”公司工作并访问系统，则视图中没有任何逻辑可以阻止您查看除您自己之外的“BETAMAX”公司的记录。如何修改我的视图，以便如果说 user.profile.company = "ACME" ，但请求返回 PostPage.client = "BETAMAX" 的记录，则拒绝访问该记录？另外，我可以有一个公司组，比如 user.profile.company = "MY_COMPANY" 可以访问所有记录吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:54:18.157

编写一个[装饰器](https://docs.djangoproject.com/en/dev/topics/http/decorators/)来检查`request.user`视图的公司。代码看起来像这样：

```
def belongs_to_company(func):

    def decorator(request, *args, **kwargs):
        has_permissions = False
        # get current company
        ...

        # get user's list of company
        ...

        # if company not in user's list of company

        if not has_permissions:
            url = reverse('no_perms')
            return redirect(url)

        return func(request, *args, **kwargs)
    return decorator 
```

更好的长期解决方案是查看[基于角色的访问控制](http://en.wikipedia.org/wiki/Role-based_access_control)库，例如[django-guardian](https://github.com/lukaszb/django-guardian)

# php - 将所有 null mysql 值显示为 N/A

> ID：10678468
> 
> 赞同：1
> 
> 时间：2012-05-21T00:47:33.977
> 
> 标签：php, mysql, null

我在一个客户网站上工作，他们希望为他们的过夜员工提供一个简单的签到页面。每个员工最多可以在一张表格上填写 6 个客户姓名。表格上输入的数据然后存储在数据库中。然后将数据显示在管理页面上，以便检查它以确保每个员工都签到。我遇到的问题是我希望所有空值都显示为 N/A 或 --，我还没有决定. 我知道我必须有一个循环，但我不确定如何读取空值。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T00:49:14.040

你可以在你的`select`声明中，做`ISNULL`：

```
SELECT ISNULL(field, 'N/A') FROM Table 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T00:57:01.347

如果您希望数据库数据保持完整并且仅修改数据以进行输出，您还没有完全提到。

如果您只想修改输出，您可以这样做：-

```
SELECT field1, field2, COALESCE(field3,'N/A')
FROM tableName; 
```

在此示例中，如果 field3 为 null，它将在返回的数据中将其替换为 N/A，否则将保持原样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T01:00:16.363

使用[COALESCE](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_coalesce)或[ISNULL](http://www.w3schools.com/sql/sql_isnull.asp)

```
SELECT COALESCE(FieldName, 'N/A') 
```

或者

```
SELECT  ISNULL(FieldName, 'N/A') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T01:04:30.770

我建议在表单提交的数据库中存储 N/A。如果使用 php

```
If (Isset($var)!=true){
$var="N/a";

}

Insert $var into database 
```

# django - DjangoCMS：应用程序集成并在非 cms（应用程序）页面上使用 CMS 内容？

> ID：10678469
> 
> 赞同：0
> 
> 时间：2012-05-21T00:47:44.430
> 
> 标签：django, django-cms

我正在将 DjangoCMS 用于网站，并且正在尝试添加注册应用程序。把它放在一切都很好，目前硬编码到 urls conf 中，但是，我想使用 CMS 在注册流程中的某些页面上设置内容..

例如，在注册应用程序在其流程中使用的几个页面上，如“注册”、“激活”、“激活过期”等我想将 CMS 内容用于相对静态的文本、预告片等......使用文本和其他插件等

（我尝试在 django-cms 中设置与注册页面相同的页面结构的页面（例如，由于我的注册页面位于 /account/register 下，我创建了一个带有子页面注册的*帐户*页面......并添加了模板注册表格到 CMS 模板...）。这适用于某些 CMS，但不适用于 djano-cms... :-(.. django-cms 从注册应用程序接管视图的那一刻不要参与不再，所以表格不起作用，等等......）

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T05:22:40.817

我记得，您可以使用[show_placeholder](https://github.com/divio/django-cms/blob/develop/cms/templatetags/cms_tags.py#L368)标签来显示来自任何页面的任何占位符的信息。因此，将您的注册网址放在django-cms**之前**，并在您的页面中放置一些引用您的特殊 CMS 页面的标签（该页面现在应该显示在菜单中，当然）。

# android - 行动项目溢出但有足够的空间

> ID：10678478
> 
> 赞同：1
> 
> 时间：2012-05-21T00:49:49.430
> 
> 标签：android, actionbarsherlock, android-actionbar

我刚刚开始使用 ActionBarSherlock，只是想知道是否有足够的空间来显示操作项图标，为什么它会溢出？

我的应用程序适用于手机和平板电脑。功能在平板电脑上非常完美，但在手机上显示操作项目图标有困难，即使纵向模式有足够的空间，它也总是溢出。顺便说一句，在横向模式下工作正常。

我有一个 SherlockFragmentActivity，在选项菜单中有 1 个操作项。它在横向中按预期显示，但在纵向时会溢出。我曾尝试使用“showAsAction=always”，但这也不起作用。任何建议将不胜感激。

我正在测试 DroidX And​​roid 版本 2.2.1

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
  <item android:id="@+id/ic_tv"
    android:icon="@drawable/image_tv"
    android:showAsAction="always"/>
</menu> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:49:57.630

正如我提到的，我刚刚开始在我的应用程序中实现 ActionBar。因此，在经历了很多挫折之后，我确实设法找到了解决方案。我将以下内容添加到我的 AndroidManifest 中。

```
android:uiOptions="none" 
```

这是默认值。出于我的目的，这很好用，因为该应用程序现在只有 1 个操作项。我希望这可以帮助遇到相同情况的任何人。

# shell - 根据一列查找文件中的公共行

> ID：10678486
> 
> 赞同：1
> 
> 时间：2012-05-21T00:52:47.547
> 
> 标签：shell, unix, awk

我有 15 个文件，例如

> 文件 1.csv

```
a,cg2,0,0,0,21,0
a,cq1,10,0,0,0,0
a,cm2,0,19,0,0,0
...
a,ad10,0,0,0,37,0 
```

> 文件2.csv

```
d,cm1,0,3,0,0,0
d,cs2,0,32,0,0,0
d,cg2,0,0,9,0,0
...
d,az2,0,0,0,21,0 
```

. . . .

> 文件 15.csv

```
s,sd1,0,23,0,0,0
s,cw1,0,0,7,0,0
s,c23,0,0,90,0,0
...
s,cg2,0,45,0,0,0 
```

我在每个文件中有不同的行数，我想比较所有 15 个文件的第二个字段并提取所有 15 个文件的第二个字段共有的行。

在上述情况下

输出是：

CG2

（对所有 15 个文件的第二个字段来说是通用的）

我对unix和shell脚本有点陌生，请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:10:11.677

您是否想要字段 2 出现在所有 15 个文件中的 15 个文件中的每个文件的完整行？或者您是否只需要出现在所有 15 个文件中的字段 2 值的列表。

前者：

```
a,cg2,0,0,0,21,0
d,cg2,0,0,9,0,0
. . .
s,cg2,0,45,0,0,0
. . . 
```

后者：

```
cg2
. . . 
```

如果是后者，那么这应该有效

```
awk -F, '{arr[$2]++; if (FILENAME != prevfile) {c++; prevfile = FILENAME}} END {for (i in arr) {if (arr[i] == c) {print i}}}' file*.csv 
```

分成多行：

```
awk -F, '{
             arr[$2]++; 
             if (FILENAME != prevfile) {
                 c++; 
                 prevfile = FILENAME
             }
         }
         END {
             for (i in arr) {
                 if (arr[i] >= c) {
                     print i
                 }
             }
         }' file*.csv 
```

解释：

*   增加字段 2 值出现的次数
*   如果文件名更改，则增加文件计数（第一个文件从空字符串更改为其文件名，并且计数从 0 增加到 1）
*   保存当前文件名
*   完成所有计数后，通过其键迭代数组
*   如果数组中包含的计数大于或等于文件数，则字段 2 值出现在所有文件中（通过检查`>=`而不是`==`这将起作用，以防一个值在单个文件中出现多次）
*   所以打印密钥（这是一个字段 2 值）
*   glob 用于获取所有文件，但您可以明确列出它们

**编辑：**

这是一种使用两遍技术打印完整匹配行的方法。这是对上面版本的修改。确保列出文件两次。

```
awk -F, '
         FILENAME == first && flag {
             exit
         }
         ! first {
             first = FILENAME
         }
         FILENAME != first {
             flag = 1
         }
         {
             arr[$2]++; 
             if (FILENAME != prevfile) {
                 c++; 
                 prevfile = FILENAME
             }
         }
         END {
             # print the matching lines
             do {
                 if ($2 in arr) {
                     print;
                 }
             } while (getline);
             # print the list of words
             for (i in arr) {
                 if (arr[i] >= c) {
                     print i
                 }
             }
         }' file*.csv file*.csv 
```

它取决于第一组中的第一个文件与第二组中的第一个文件同名。使用与我所展示的类似的通配符将满足该要求。

它打印匹配的行（虽然没有分组），然后打印单词列表。如果您只需要其中一个，请注释掉或删除您不想要的循环（`do/while`或`for`）。

如果只打印整行，则可以将输出通过管道传输到：

```
sort -t , -k2,2 
```

让他们分组。

仅将单词列表传递到：

```
sort 
```

将它们按相同的顺序排列以便于比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:02:43.547

有趣的问题。

一种完全在 Bash 中的方法如下。

您需要调用的一件事是`join -t ',' -1 2 -2 2 file1 file2`加入两个文件的第二列。但是，在您加入之前，您必须对第二列进行排序。

在 for 循环中进行连续连接，因为`join`只接受两个文件作为参数。

*附录*

这是一个显示连续连接的小记录。我认为你可以很容易地适应它。

```
$ cat 1.csv
a,b,c,d
e,f,g,h
i,j,k,l
$ cat 2.csv
7,5,4,3
3,b,s,e
2,f,5,5
$ cat 3.csv
4,5,6,7
0,0,0,0
1,b,4,4
$ join -t ',' -1 2 -2 2 1.csv 2.csv | cut -f 1 -d ',' > temp
$ cat temp
b
f
$ join -t ',' -2 2 temp 3.csv | cut -f 1 -d ','
b 
```

第一个连接（在前两个文件上）在结果的第一列中产生连接值。因此，当您加入 file3、file4、file5 等时。您将使用生成的结果的第一列，这就是您只需要 -2 选项的原因。为了使事情保持高效，每次进行联接时，请始终删除除第一列之外的所有内容。

# git - 由于 `git fetch` 在哪里可以找到更改

> ID：10678495
> 
> 赞同：72
> 
> 时间：2012-05-21T00:56:04.503
> 
> 标签：git, pull, git-fetch

我不想在 a 之后丢失一些信息`git pull`，所以我做了 a `git fetch`before。我在哪里可以阅读 a 之后的新修改`git fetch`？我去了`FETCH_HEAD`档案，但只有一个大数字。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-05-21T12:57:29.293

`git fetch origin`默认情况下，从名为“origin”的远程获取所有内容并更新（或创建）该远程的所谓“远程跟踪分支”。比如说，对于包含名为“master”和“feature”的分支的名为“origin”的远程，运行`git fetch remote`将导致名为“origin/master”和“origin/feature”的远程跟踪分支被更新（或创建，如果它们'不存在）。`git branch -a`您可以在（注意“-a”）的输出中看到它们。

现在，通常的 Git 设置是（某些）本地分支遵循某些远程分支（通常同名）。也就是说，您的本地“master”分支遵循“origin/master”等。

因此，在获取之后，要查看远程“master”与本地“master”的比较，您要求 Git 准确地向您展示：

```
git log origin/master ^master 
```

这意味着«所有可从“origin/master”访问的提交，不包括可从“master”访问的提交»，或者，

```
git log master..origin/master 
```

这具有相同的含义。有关更多信息，请参阅[“gitrevisions”手册页](http://schacon.github.com/git/gitrevisions.html)，尤其是“指定范围”部分。[另请参阅git-log 手册页](http://schacon.github.com/git/git-log.html)中的示例

您可以自由定制`git log`您认为合适的输出，因为它支持很多影响它的选项。

请注意，您的本地分支也可能有匹配的远程分支不包含的提交（还）。要获得对它们的概述，您必须`git log`出于（希望）明显的原因反转传递给的修订。

像往常一样，在开始使用工具之前，[教育](http://git-scm.com/book/en/Git-Basics-Working-with-Remotes) [自己理解基本概念是很重要的。](http://git-scm.com/book/en/Git-Branching-Remote-Branches)请做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-21T06:28:02.053

尝试

```
git log --oneline --decorate origin/master 
```

这将为您提供远程`master`头部的更改日志`origin`（您可以根据需要替换任何其他远程分支）。你会得到一个有点像这样的输出：

```
234121 (origin/master) Commit message 5
872373 Commit message 4
623748 Commit message 3
235090 (master) Commit message 2
192399 Commit message 1 
```

标记的提交`(master)`是您本地`master`分支的负责人。标记的提交是远程分支`(origin/master)`的头部。`master`

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-08-07T12:48:13.443

如果您只想查看执行 GIT PULL 会修改哪些文件，请执行以下操作：

```
git fetch && git diff HEAD @{u} --name-only 
```

如果您想查看当前版本和传入版本之间的所有差异，包括未提交的本地修改，请输入：

```
git fetch && git diff @{u} --name-only 
```

# python - 使用日期作为索引创建列表

> ID：10678496
> 
> 赞同：3
> 
> 时间：2012-05-21T00:56:41.773
> 
> 标签：python

我制作了一个使用日期列表作为索引的列表，如下所示：

```
>>> import datedlist
>>> import datetime
>>> dates = [datetime.date(2012,1,x) for x in range(2,6)]
>>> values = range(4,8)
>>> dates
[datetime.date(2012, 1, 2), datetime.date(2012, 1, 3), datetime.date(2012, 1, 4), datetime.date(2012, 1, 5)]
>>> dl = datedlist.DatedList(values, dates)
>>> dl
[4, 5, 6, 7]
>>> dl[datetime.date(2012,1,3)]
5 
```

到目前为止一切都很好，但我也希望能够使用切片（不是扩展切片），就像这样（以下不起作用**-**这是我想要的结果）：

```
>>> datedlist[datetime.date(2012,1,3):datetime.date(2012,1,4)]
[5, 6] 
```

这是我的尝试（显然不起作用）：

```
class DatedList(list):

    def __init__(self, values, dates):
        self.dates = dates
        list.__init__(self, values)

    def __getitem__(self, date):
        if isinstance(date, slice):
            start = self.dates.index(slice[0])
            end = self.dates.index(slice[1])
            return [list.__getitem__(self, index) for index in range(start, end)]
        elif isinstance( date, datetime.date ) :
            index = self.dates.index(date)
            return list.__getitem__(self, index)
        elif isinstance(date, int):
            if date < 0:
                date += len(self)
            if date >= len(self):
                raise IndexError, "index out of range {}".format(date)
            return list.__getitem__(self, date)
        else:
            raise TypeError, "Invalid argument type." 
```

slice[0] 和 slice[1] 只是为了解释我的意图。isinstance(date, int) 仅用于调试 - 将被删除以用于生产代码。

**问题是**：如何实现使用 datetime.date 对象作为索引的切片？

编辑（在 gnibblers 的第二条评论之后）：我也尝试过 getslice（即使文档说 getslice 已经过时了）。然后该类看起来像这样（isinstance-slice 位由于语法而被注释掉）：

```
class DatedList(list):

    def __init__(self, values, dates):
        self.dates = dates
        list.__init__(self, values)

    def __contains__(self, date):
        return date in self.dates

    def __getslice__(self, fromdate, todate):
        i_from = self.get_index(fromdate)
        i_to = self.get_index(todate)
        print i_from, i_to
        return [list.__getitem__(self, i) for i in range(i_from, i_to)]

    def __getitem__(self, date):
        if isinstance(date, slice):
            pass
#            start = self.dates.index(slice[0])
#            end = self.dates.index(slice[1])
#            return [list.__getitem__(self, i) for i in range(start, end)]
        elif isinstance(date, datetime.date):
            index = self.get_index(date)
            return list.__getitem__(self, index)
        elif isinstance(date, int):
            if date < 0:
                date += len(self)
            if date >= len(self):
                raise IndexError, "index out of range {}".format(date)
            return list.__getitem__(self, date)
        else:
            raise TypeError, "Invalid argument type."

    def get_index(self, date):
        if date in self.dates:
            index = self.dates.index(date)
        elif date < self.dates[0]:
            index = 0
        elif date > self.dates[-1]:
            index = len(self.dates) - 1
        return index 
```

结果是：

```
>>> print dl[datetime.date(2012,1,3):datetime.date(2012,1,5)]
>>> None 
```

显然，getslice 根本没有被使用，因为打印没有被执行。似乎 getitem 在请求切片时执行，但我似乎无法在切片中使用 datetime.date 。/编辑

注意：显然子类列表不是一个好主意，但到目前为止我尝试过的任何替代方案似乎都没有更好的效果（或根本没有）：

*   从头开始构建一个类：我无法使用 [] 符号：

    > ```
    > dl = DatedList(values, dates)
    > value = dl[some_date]       # I want this to work
    > value = dl.value(same_date) # I don't want this 
    > ```

*   我考虑过使用字典，但我的列表需要排序，我也需要使用切片。

*   我还尝试对 collections.Sequence 进行子类化，但这导致：

    > TypeError：描述符“ **init** ”需要一个“list”对象但收到一个“DatedList”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T01:11:49.863

您可能不想重新实现它，而是想查看一些现有的时间序列实现。[Pandas和](http://pandas.pydata.org/pandas-docs/stable/timeseries.html)[scikits.timeseries](http://pytseries.sourceforge.net/)都有一个不错的选择。

以 Pandas 为例：

```
In [1]: from pandas import Series, DateRange

In [2]: import datetime

In [3]: ts = Series(range(12), index=DateRange('1/1/2000', periods=12, freq='T'))

In [4]: ts
Out[4]: 
2000-01-03     0
2000-01-04     1
2000-01-05     2
2000-01-06     3
2000-01-07     4
2000-01-10     5
2000-01-11     6
2000-01-12     7
2000-01-13     8
2000-01-14     9
2000-01-17    10
2000-01-18    11

In [5]: ts[datetime.datetime(2000,1,10):]
Out[5]: 
2000-01-10     5
2000-01-11     6
2000-01-12     7
2000-01-13     8
2000-01-14     9
2000-01-17    10
2000-01-18    11 
```

或者，您可以在那里调查源代码并针对您的特定案例重新实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T04:34:30.857

这是一个非常简单的示例，基本上您将参数传递给`__getitem__`并通过映射传递它们，以便您可以利用构建列表行为。

正如你所提到的，`__getslice__`已经过时了，`__getitem__`只需要注意它已经通过 a`slice`并适当地处理它。

```
import datetime
class DatedList(list):

    def __init__(self, values, dates):
        list.__init__(self, values)
        self.dates = dates
        self._dt_to_idx = {k:v for v,k in enumerate(dates)}

    def __getitem__(self, arg):
        if isinstance(arg, slice):
            start = self._dt_to_idx[arg.start]
            stop = self._dt_to_idx[arg.stop]
            return list.__getitem__(self, slice(start, stop, arg.step))
        else:
            return list.__getitem__(self, self._dt_to_idx[arg])    

dates = [datetime.date(2012,1,x) for x in range(2,6)]
dl = DatedList([1,2,3,4], dates)
print dl[dates[2]]
print dl[dates[1]:dates[3]] 
```

如果您需要更复杂的映射 - 处理跳过的日期等，只需定义一个方法来进行映射并在您使用的任何地方调用它`self._dt_to_idx[...]`

# mongodb - 语言数据库的 MongoDB Schema 设计

> ID：10678500
> 
> 赞同：1
> 
> 时间：2012-05-21T00:57:12.320
> 
> 标签：mongodb, database-design, mongoid, nosql

我需要一些关于自然语言数据库的 MongoDB 模式设计的建议。

我需要为每种语言存储文本和单词，例如：

```
lang: {
    _id: "English",
    texts : [
        {   text : "This is a first text", 
            date : Date("2011-09-19T04:00:10.112Z"),
            tag : "test1"
        },
        {   text : "Second One", 
            date : Date("2011-09-19T04:00:10.112Z"),
            tag : "test2"
        }
    ],
    words : [
        {   
            word : "This",
        },
        {   
            word : "is",
        },
        {   
            word : "a",
        },
        {   
            word : "first",
        },
        {   
            word : "text",
        },
        {   
            word : "second",
        },
        {   
            word : "one",
        }

    ]

} 
```

然后我需要知道用户关联的每个单词和文本。单词/文本的数量往往很大，我需要列出一种语言的所有单词以及用户与该语言相关联的所有单词。

从我的角度来看，我认为将与给定单词相关联的 user_ids 存储在该单词的数组中可能是一种好方法，例如：

```
lang: {
    _id: "English",
    texts : [
                ...
    ],
    words : [
        {   
            word : "This",
            users: [user1,user2,user3]
        },
        {   
            word : "is",
                users: [user1,user2]
                },
                ...
    ]
} 
```

请记住，一个单词可以与数十万用户相关联，并且文档限制（如我所读）为 4MB，我需要：

1.  列出给定用户和语言的所有单词

这是一个好方法吗？或者你能想到一个更好的吗？

希望这个问题足够清楚，并且有人可以帮我解决这个问题；）

谢谢你们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T01:14:27.583

我认为这不是一个好方法，只是因为您提到的原因：文档大小限制。看起来你的方法，你肯定会遇到极限。我会采用更扁平的方法（这也应该使您的收藏更容易查询）。像这样的东西：

```
[
    {
        user: "user1",
        word: "This",
        lang: "en"
    },
    {
        user: "user1",
        word: "is",
        lang: "en"
    },
    // et cetera...
] 
```

换句话说，通过添加文档来垂直增长，而不是通过向一个文档中添加更多数据来水平增长。*您可以使用db.find( { user: "user1", lang: "en" });*查询给定用户的单词。.

当然，这种方法不是“规范化”的，因此如果您担心空间问题，那么您可能希望为用户、单词和语言创建一个单独的集合，并通过 ID 在主集合中引用它们。但是由于 MongoDB 中没有*连接*查询，因此您必须权衡查询性能和空间效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T11:33:21.247

dbaseman 是正确的（并且赞成），但还有其他几点：

首先，在撰写本文时，文档限制现在为 16MB（[最大文档大小](http://www.mongodb.org/display/DOCS/Documents#Documents-MaximumDocumentSize)），假设您运行的是最新版本的 MongoDB。

其次，在 MongoDB 中，无限制增长通常是一个坏主意，这种类型的文档大小扩展会导致 MongoDB 如果超过当前分配给它的空间，则必须移动文档。[您可以在文档的Padding Factor](http://www.mongodb.org/display/DOCS/Padding+Factor)部分阅读更多相关信息。

这些类型的移动相对昂贵，特别是如果它们经常发生。因此，如果您确实采用这种类型的设计，会限制您的主集合（最近的 X、最流行的 X 等）中等效评论的大小（基本上限制增长），甚至可能预先填充该文档字段（基本上手动填充）超出平均大小将减少导致添加/更改的移动。

这就是 O'Reilly 的 MongoDB 开发人员提示和技巧书中提示 #6 的原因：

提示 #6：不要嵌入具有无限增长的字段

# zend-framework - 有没有办法在 ZendFramework 中定义通配符路由以将整个模块路由到另一个？

> ID：10678501
> 
> 赞同：1
> 
> 时间：2012-05-21T00:57:31.120
> 
> 标签：zend-framework, zend-route

有没有办法在 ZendFramework 中定义通配符路由以将整个模块路由到另一个？

例如我想要

[http://website.com/people/controller/action/](http://website.com/) 被**路由**到**_** _ **_**

 **[http://website.com/](http://website.com/) **朋友**/**控制器**/**动作**/

我可以通过 .htaccess 做到这一点，但是除了以下 3 个句子之外，还有其他方法可以在路由中做到这一点吗？

```
$router->addRoute('friend',new Zend_Controller_Router_Route('people/:controller/:action',
                array("module"=>'friend')));

$router->addRoute('friend2',new Zend_Controller_Router_Route('people/:controller',
                array("module"=>'friend',"action"=>"index")));      

$router->addRoute('friend3',new Zend_Controller_Router_Route('people/',
                array("module"=>'friend',"action"=>"index","controller"=>"index"))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:53:58.787

你可以通过创建插件来做你想做的事

```
class My_Routing extends Zend_Controller_Plugin_Abstract
{
    public function routeShutdown($request)
    {
       $m = $this->_request->getModuleName();
       if($m == 'people') 
       {
         $this->_request->setModuleName('friends');
       }    
    }
} 
```**

# multithreading - 在数据库连接（可能需要很长时间）运行时显示启动屏幕

> ID：10678503
> 
> 赞同：5
> 
> 时间：2012-05-21T00:58:56.197
> 
> 标签：multithreading, delphi, ado

我正在尝试显示启动屏幕，而不是在应用程序连接到数据库时冻结它。正常连接（通过 ADO 到 MSSQL）大约需要 300 毫秒，这不会导致主线程在 Windows 上显示“无响应”。

但是，在 (a) 网络错误或 (b) 配置错误（无效的 SQL 服务器主机名/实例）的情况下，超时需要 60 秒。这不仅使应用程序无响应，而且在冻结时几乎不可能显示任何错误或消息。我可以在开始连接之前弹出一条消息，但是当主线程阻塞 60 秒时确实没有解决方案。

解决方案似乎是将连接移动到后台线程。这导致以下代码：

1.  建立后台连接的 TThread 类和一些 SyncObj，例如用于将信号发送回主线程的 TEvent。

2.  使用以下代码在主线程中循环：

    ```
    BackgroundThread.StartConnecting;
    while not BackgroundThread.IsEventSignalled do begin
       Application.ProcessMessages; // keep message pump alive.
    end;
    // continue startup (reports error if db connection failed) 
    ```

这是正确的方法吗？我的犹豫涉及上述解决方案的以下要素：

A. 我会调用 Application.ProcessMessages，我认为这是一种极端的代码气味。（这可能是该规则的允许例外）

B. 我在应用程序的启动中引入线程，我担心引入错误。

如果有人有一个已知没有竞争条件的参考实现，它可以与 ADO 进行后台连接，并且已知是一种安全的方法，那将非常有帮助。否则一般提示或部分示例都很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T08:44:12.343

由于每个线程必须使用它自己的 ADO 连接的已知限制（即您不能使用在其他线程中创建的连接对象），我能想到的唯一选择是创建一个将与数据库建立连接的线程，然后建立连接或达到超时，向主线程发出有关事件的信号并关闭/销毁连接。主线程可以同时显示启动或进度，等待来自该线程的消息。因此，您消除了密码错误或主机无法访问的情况。有一个合理的假设，即如果第二个线程可以连接，那么主线程将能够立即连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T06:25:49.587

线程间通信有多种方法。我通常使用 Window 的消息。首先，我在表单中定义客户消息和消息处理程序。然后当我需要从自定义线程通知主线程时，我使用 PostMessage 函数发送通知。

小教程[在这里](http://www.cryer.co.uk/brian/delphi/howto_send_custom_window_message.htm)。

您还可以使用库进行线程处理，例如[OmniThreadLibrary](http://otl.17slon.com/)。

# html - CSS：悬停在 div 外

> ID：10678509
> 
> 赞同：4
> 
> 时间：2012-05-21T01:01:06.433
> 
> 标签：html, css

所以我有这个代码的导航

```
<ul>
    <li><a href="#" class="home">Home</a></li>
    <li><a href="#" class="about">About</a></li>
    <li><a href="#" class="portfolio">Portfolio</a></li>
    <li><a href="#" class="photos">Photos</a></li>
    <li><a href="#" class="contact">Contact</a></li>
</ul>
<div id="arrow">

</div> 
```

每当我 :hover any a with class 时，我希望我的#arrow 移动。

有没有办法做到这一点？先感谢您。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T01:04:22.533

单独使用 CSS 是不可能的。您将需要一些动态脚本来完成此操作。使用`:hover`，您可以操作悬停元素及其子/孙元素的属性。`#arrow`但是，它没有嵌套在您的任何列表项中，因此它们的`:hover`状态不能指定箭头元素的样式 - 至少不是直接的。

如前所述，您*可以*使用一些动态脚本来完成此操作。例如，以下 jQuery 将完成您所追求的效果：

```
$("ul").on("mouseenter mouseleave", "li", function(e){
   e.type === "mouseenter"
       ? $("#arrow").stop().animate({ 
           left:    $(this).offset().left, 
           width:   $(this).outerWidth(),
           opacity: 1           
       }, 500 )
       : $("#arrow").stop().animate({ 
           left:    0, 
           width:   $("ul li:first").outerWidth(),
           opacity: 0
       }, 750 );       
});​ 
```

小提琴：http: [//jsfiddle.net/ZvqPZ/2/](http://jsfiddle.net/ZvqPZ/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T01:16:02.317

如前所述，您不能使用 CSS 执行此操作。您可以使用 jQuery，例如使用 css 类来指定位置并在使用 jquery 悬停时更改类之间的位置。

**jQuery** :

```
$("li a").hover(    
  function () {    /* on hover over*/
    $("#arrow").addClass("moved-pos");
  },
  function () {    /* on hover out*/
    $("#arrow").removeClass("moved-pos");
  }
}); 
```

**CSS：**

```
#arrow{ /*set original position for arrow */ }
#arrow.moved-pos{ /*set new position here */ } 
```

（注意此代码未经测试）

# scala - 使用 while 循环 + 堆栈对递归树创建进行编码

> ID：10678510
> 
> 赞同：7
> 
> 时间：2012-05-21T01:01:28.977
> 
> 标签：scala

我有点不好意思承认这一点，但我似乎被一个简单的编程问题难住了。我正在构建一个决策树实现，并且一直在使用递归来获取标记样本的列表，递归地将列表分成两半，然后将其变成一棵树。

不幸的是，对于深树，我遇到了堆栈溢出错误（哈！），所以我的第一个想法是使用延续将其变成尾递归。不幸的是，Scala 不支持这种 TCO，因此唯一的解决方案是使用蹦床。蹦床似乎有点低效，我希望有一些简单的基于堆栈的命令式解决方案来解决这个问题，但我很难找到它。

递归版本看起来有点像（简化）：

```
private def trainTree(samples: Seq[Sample], usedFeatures: Set[Int]): DTree = {
  if (shouldStop(samples)) {
    DTLeaf(makeProportions(samples))
  } else {
    val featureIdx = getSplittingFeature(samples, usedFeatures)
    val (statsWithFeature, statsWithoutFeature) = samples.partition(hasFeature(featureIdx, _))
    DTBranch(
      trainTree(statsWithFeature, usedFeatures + featureIdx), 
      trainTree(statsWithoutFeature, usedFeatures + featureIdx),
      featureIdx)
  }
} 
```

所以基本上我会根据数据的某些特征将列表递归地细分为两部分，并传递一个已使用特征的列表，所以我不会重复——这一切都在“getSplittingFeature”函数中处理，所以我们可以忽略它。代码真的很简单！尽管如此，我仍然无法找出一个基于堆栈的解决方案，它不仅使用闭包而且有效地成为蹦床。我知道我们至少必须在堆栈中保留小的“框架”参数，但我想避免闭包调用。

我知道我应该在递归解决方案中显式地写出调用堆栈和程序计数器为我处理的内容，但是如果没有继续，我很难做到这一点。在这一点上，它甚至与效率无关，我只是好奇。所以请不要提醒我，过早的优化是万恶之源，基于蹦床的解决方案可能会工作得很好。我知道它可能会——这基本上是一个谜。

谁能告诉我这种事情的规范的基于 while-loop-and-stack 的解决方案是什么？

更新：基于 Thipor Kong 的优秀解决方案，我编写了一个基于 while-loops/stacks/hashtable 的算法实现，它应该是递归版本的直接翻译。这正是我一直在寻找的：

最后更新：我使用了顺序整数索引，以及将所有内容放回数组而不是映射以提高性能，添加了 maxDepth 支持，最后有了一个与递归版本具有相同性能的解决方案（不确定内存使用情况，但我会少猜）：

```
private def trainTreeNoMaxDepth(startingSamples: Seq[Sample], startingMaxDepth: Int): DTree = {
  // Use arraybuffer as dense mutable int-indexed map - no IndexOutOfBoundsException, just expand to fit
  type DenseIntMap[T] = ArrayBuffer[T]
  def updateIntMap[@specialized T](ab: DenseIntMap[T], idx: Int, item: T, dfault: T = null.asInstanceOf[T]) = {
    if (ab.length <= idx) {ab.insertAll(ab.length, Iterable.fill(idx - ab.length + 1)(dfault)) }
    ab.update(idx, item)
  }
  var currentChildId = 0 // get childIdx or create one if it's not there already
  def child(childMap: DenseIntMap[Int], heapIdx: Int) =
    if (childMap.length > heapIdx && childMap(heapIdx) != -1) childMap(heapIdx)
    else {currentChildId += 1; updateIntMap(childMap, heapIdx, currentChildId, -1); currentChildId }
  // go down
  val leftChildren, rightChildren = new DenseIntMap[Int]() // heapIdx -> childHeapIdx
  val todo = Stack((startingSamples, Set.empty[Int], startingMaxDepth, 0)) // samples, usedFeatures, maxDepth, heapIdx
  val branches = new Stack[(Int, Int)]() // heapIdx, featureIdx
  val nodes = new DenseIntMap[DTree]() // heapIdx -> node
  while (!todo.isEmpty) {
    val (samples, usedFeatures, maxDepth, heapIdx) = todo.pop()
    if (shouldStop(samples) || maxDepth == 0) {
      updateIntMap(nodes, heapIdx, DTLeaf(makeProportions(samples)))
    } else {
      val featureIdx = getSplittingFeature(samples, usedFeatures)
      val (statsWithFeature, statsWithoutFeature) = samples.partition(hasFeature(featureIdx, _))
      todo.push((statsWithFeature, usedFeatures + featureIdx, maxDepth - 1, child(leftChildren, heapIdx)))
      todo.push((statsWithoutFeature, usedFeatures + featureIdx, maxDepth - 1, child(rightChildren, heapIdx)))
      branches.push((heapIdx, featureIdx))
    }
  }
  // go up
  while (!branches.isEmpty) {
    val (heapIdx, featureIdx) = branches.pop()
    updateIntMap(nodes, heapIdx, DTBranch(nodes(child(leftChildren, heapIdx)), nodes(child(rightChildren, heapIdx)), featureIdx))
  }
  nodes(0)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T11:37:34.340

只需将二叉树存储在数组中，如[Wikipedia](http://en.wikipedia.org/wiki/Binary_tree#Methods_for_storing_binary_trees)上所述：对于 node `i`，左孩子进入`2*i+1`，右孩子进入 to `2*i+2`。在执行“向下”操作时，您保留了一系列待办事项，但仍必须将其拆分才能到达叶子。一旦你只有叶子，向上（在数组中从右到左）构建决策节点：

**更新：**一个清理后的版本，它还支持存储在分支中的特性（类型参数 B），并且功能更强大/完全纯粹，并且支持 ron 建议的带有地图的稀疏树。

**更新 2-3：**经济地使用节点 ID 的名称空间和抽象类型的 ID 以允许大树。从 Stream 中获取节点 ID。

```
sealed trait DTree[A, B]
case class DTLeaf[A, B](a: A, b: B) extends DTree[A, B]
case class DTBranch[A, B](left: DTree[A, B], right: DTree[A, B], b: B) extends DTree[A, B]

def mktree[A, B, Id](a: A, b: B, split: (A, B) => Option[(A, A, B)], ids: Stream[Id]) = {
  @tailrec
  def goDown(todo: Seq[(A, B, Id)], branches: Seq[(Id, B, Id, Id)], leafs: Map[Id, DTree[A, B]], ids: Stream[Id]): (Seq[(Id, B, Id, Id)], Map[Id, DTree[A, B]]) =
    todo match {
      case Nil => (branches, leafs)
      case (a, b, id) :: rest =>
        split(a, b) match {
          case None =>
            goDown(rest, branches, leafs + (id -> DTLeaf(a, b)), ids)
          case Some((left, right, b2)) =>
            val leftId #:: rightId #:: idRest = ids
            goDown((right, b2, rightId) +: (left, b2, leftId) +: rest, (id, b2, leftId, rightId) +: branches, leafs, idRest)
        }
    }

  @tailrec
  def goUp[A, B](branches: Seq[(Id, B, Id, Id)], nodes: Map[Id, DTree[A, B]]): Map[Id, DTree[A, B]] =
    branches match {
      case Nil => nodes
      case (id, b, leftId, rightId) :: rest =>
        goUp(rest, nodes + (id -> DTBranch(nodes(leftId), nodes(rightId), b)))
    }

  val rootId #:: restIds = ids
  val (branches, leafs) = goDown(Seq((a, b, rootId)), Seq(), Map(), restIds)
  goUp(branches, leafs)(rootId)
}

// try it out

def split(xs: Seq[Int], b: Int) =
  if (xs.size > 1) {
    val (left, right) = xs.splitAt(xs.size / 2)
    Some((left, right, b + 1))
  } else {
    None
  }

val tree = mktree(0 to 1000, 0, split _, Stream.from(0))
println(tree) 
```

# cocoa-touch - 内容未添加到 UIPopoverController？

> ID：10678511
> 
> 赞同：0
> 
> 时间：2012-05-21T01:02:18.367
> 
> 标签：cocoa-touch, ipad, storyboard, automatic-ref-counting, uipopovercontroller

我是 iOS 开发的新手，所以请放慢我的脚步。我正在尝试学习如何使用 UIPopoverCotroller 并且遇到了问题。弹出框显示正确，但没有添加任何内容，只是黑色。我正在使用这行代码尝试向弹出框添加内容：

```
self.photosPopover = [[UIPopoverController alloc]initWithContentViewController:self.photosPopoverViewController]; 
```

继承人一些更多的代码来帮助：

```
-(void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController{
    self.photosPopover=nil;
}

-(IBAction)photosPopoverButtonPressed:(id)sender{
    if([self.photosPopover isPopoverVisible]){
        [self.photosPopover dismissPopoverAnimated:YES];
        self.photosPopover=nil;
        return;
    }

    self.photosPopoverViewController = [[PhotosPopoverViewController alloc]init];
    self.photosPopover = [[UIPopoverController alloc]initWithContentViewController:self.photosPopoverViewController];
    [self.photosPopover setDelegate:self];
    [self.photosPopover presentPopoverFromBarButtonItem:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
    [self.photosPopover setPopoverContentSize:CGSizeMake(320, 480)];
} 
```

我正在使用 Xcode 4.3、ARC 和情节提要。

谢谢你的帮助！

-碎纸机2794

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T11:58:29.247

您需要从情节提要中实例化您的视图。对不起，我没有早点看到这个……

```
self.photosPopoverViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"photosViewController"]; 
```

![在此处输入图像描述](../Images/2195c3cffade112cd8c88396bd7dc0e3.png)

这就是您将 customViewController 连接到 Storyboard 中的 viewController 对象的方式。您构建您的 PhotosPopoverViewController.h 和 PhotosPopoverViewController.m 然后您单击情节提要中的 viewController 对象并找到自定义类标识符。开始输入您的班级名称，它将自动填充它。

![这就是您将 customViewController 连接到 Storyboard 中的 viewController 对象的方式。](../Images/6cd58ba6ee8398236ac3963bd084b875.png)

# asp.net-mvc-3 - 有没有更好的方法来为我的搜索实现“任何”或“全部”

> ID：10678514
> 
> 赞同：1
> 
> 时间：2012-05-21T01:02:58.167
> 
> 标签：asp.net-mvc-3, search

我有以下操作方法，它构建了一个下拉列表，用于搜索具有特定国家/地区的记录。除了显示所有国家的列表之外，我还添加了一个名为 -Any- 的静态值，它将返回所有记录而不考虑其国家/地区，如下所示：

```
public PartialViewResult ManageVisitSearch()
        {   var CountryList = repository.FindAllCountry().ToList();
            CountryList.Insert(0, new Country { Description = "--Any--", CountryID = 0 });
//code goes here
        ViewBag.CountryID = new SelectList(CountryList, "CountryID", "Description", 0);
        return PartialView("_ManageVisitSearch"); } 
```

在将执行搜索的存储库方法上，我执行以下操作以返回所有记录，以防从下拉列表中选择 -Any-：

```
 public IEnumerable<VisitSearch> visitsearch(DateTime? datefrom, DateTime? dateto, int countryid, int genderid)
            {
 var vs = (from v in entities.Visits  where 
(v.Patient.NationalityID == countryid || countryid == 0) 

//code goes here 
```

上述方法对我来说效果很好，但我认为它可能不是最好的方法。是否有更合理的方法可以将 -Any- 添加到我的搜索下拉列表中，或者我的方法听起来不错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:41:51.220

```
 public IEnumerable<VisitSearch> visitsearch(DateTime? datefrom, DateTime? dateto, int? countryid, int genderid)
 {
     var vs = entities.Visits;

     if(countryid.HasValue)
         vs = vs.Where(v.Patient.NationalityID == countryid.Value);

     return vs;
 } 
```

您可以通过根据某些条件添加 where 子句来构建查询。

# javascript - 无法在 IE 中访问 iframe 内容

> ID：10678516
> 
> 赞同：1
> 
> 时间：2012-05-21T01:03:50.253
> 
> 标签：javascript, internet-explorer, iframe

我正在构建一个 CMS 应用程序，我现在正在为 IE 调试它。但事情发生了，我无法理解。

首先，我有一个包含页面内容的 div。我提取 div 的内容并使用 javascript 创建一个 iFrame 并将其附加到 div。这是为了制作所见即所得的编辑器。然后，当我想将内容添加到 iFrame 时，问题就开始了。由于某种原因，IE 无法访问 iFrame 的正文。我可以提醒 iFrame 的文档，它给了我 [object Document] 或 [object HTMLDocument]，但是当我提醒正文时，我得到了 null。

我使用此函数将文档作为 javascript 对象的一部分：

```
iframedoc: function(aID) {
    if (document.getElementById(aID).contentDocument){
        return document.getElementById(aID).contentDocument;
    } else {
        var iFrame = document.getElementById(aID);
        return iFrame.contentWindow.document;
    }
}, 
```

这是我第一次称之为：

```
tas[i].innerHTML = "";
tas[i].appendChild(ta_edit_functions);
tas[i].appendChild(ta_edit);
tas[i].appendChild(ta_result);
alert(ta.iframedoc(ta_edit_id));
ta.iframedoc(ta_edit_id).body.innerHTML = ta_edit_content;
ta.iframedoc(ta_edit_id).designMode = 'on'; 
```

在这里，我清空 div，附加一个包含所见即所得函数、iFrame 和 textarea 的 div，以便最终提交表单。

我正在 IE 8 和 9 中进行测试。最奇怪的是，当我在 IE 8 中第一次调用 iframedoc 之前发出警报时，我突然得到了正文。

如果有人至少能指出我正确的方向，我将不胜感激。我真的不知道发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T01:06:46.397

> 我正在 IE 8 和 9 中进行测试。最奇怪的是，当我在 IE 8 中第一次调用 iframedoc 之前发出警报时，我突然得到了正文。

这听起来好像你对浏览器来说太快了——当你试图弄乱它时，iframe 可能还没有完全加载，所以添加一个警报会给它额外的时间。`onload`尝试使用iframe 元素上的事件来推迟您的一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:59:53.917

最终我的解决方案是使用间隔函数检查 iFrame 的主体是否可用。

但是随着这些错误的消失，我发现在 IE8 中打开 iFrame 的设计模式会删除它的所有内容。所以我最终只使用了一个 contenteditable div ..

# android - 带有自定义 ArrayAdapter 的微调器，用于不显示所选项目的对象

> ID：10678521
> 
> 赞同：5
> 
> 时间：2012-05-21T01:04:31.357
> 
> 标签：android, view, spinner, android-arrayadapter, selected

我有一个自定义 ArrayAdapter 来表示微调器控件上的对象，我可以加载我的项目列表并显示它以供选择，但是当实际选择发生时微调器什么也不显示。

活动代码：

```
public MetroData metroData;
private Spinner spinner;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    metroData = new MetroData();
    spinner = (Spinner) findViewById(R.id.spinner1);
    StopArrayAdapter dAdapter = new StopArrayAdapter(this, metroData.Stops);

    spinner.setAdapter(dAdapter);
} 
```

停止阵列适配器：

```
public class StopArrayAdapter extends ArrayAdapter<MetroStop> {

private List<MetroStop> items;
private Activity activity;

public StopArrayAdapter(Activity activity, List<MetroStop> items) {
    super(activity, android.R.layout.simple_list_item_1, items);
    this.items = items;
    this.activity = activity;
}

@Override
public View getDropDownView(int position, View convertView, ViewGroup parent) {
    TextView v = (TextView) super.getView(position, convertView, parent);

    if (v == null) {
        v = new TextView(activity);
    }
    v.setTextColor(Color.BLACK);
    v.setText(items.get(position).getName());
    return v;
}

@Override
public MetroStop getItem(int position) {
    return items.get(position);
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;

    if (v == null) {
        LayoutInflater inflater = activity.getLayoutInflater();
        v = inflater.inflate(R.layout.view_spinner_item, null);
    }
    TextView lbl = (TextView) v.findViewById(R.id.text1);
    lbl.setTextColor(Color.BLACK);
    lbl.setText(items.get(position).getName());
    return convertView;
}
} 
```

微调器视图项目模板：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/text1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:textColor="#222"/> 
```

关于为什么所选项目视图不起作用的任何想法？顺便说一句，我也用普通的 ArrayAdapter 尝试过，结果相同。

**更新**似乎生成了视图，但在查看层次结构查看器时，视图没有被渲染，Measured/Layout/Draw = n/a。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T02:00:50.580

我发现了问题所在。由于我是`spinner`从互联网上获取数据的，我需要触发 a `notifyDataSetChanged()`，即使没有这个，`spinner`更新的内容也是如此。似乎选中的项目视图没有得到通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-17T14:09:03.463

在 getView `return convertView;`=>`return v;`

# c - 如何获取此 readdir 代码示例以搜索其他目录

> ID：10678522
> 
> 赞同：2
> 
> 时间：2012-05-21T01:04:32.137
> 
> 标签：c, file-io, glob

我目前正在使用一个代码示例，该示例最初旨在获取一个参数，然后在当前目录中搜索该参数，我试图通过替换 ". " 使用“/dev/shm”，但是当我搜索某些东西时，代码什么也没有出现*（注意通配符）。通配符搜索在当前目录中工作正常，所以我认为问题不是通配符，如果有人可以帮助我，我将非常感激，谢谢！

```
#include <dirent.h>
#include <errno.h>
#include <stdio.h>
#include <string.h>

static void lookup(const char *arg)
{
    DIR *dirp;
    struct dirent *dp;

    if ((dirp = opendir(".")) == NULL) {
        perror("couldn't open '.'");
        return;
    }

    do {
        errno = 0;
        if ((dp = readdir(dirp)) != NULL) {
            if (strcmp(dp->d_name, arg) != 0)
                continue;

            (void) printf("found %s\n", arg);
            (void) closedir(dirp);
                return;

        }
    } while (dp != NULL);

    if (errno != 0)
        perror("error reading directory");
    else
        (void) printf("failed to find %s\n", arg);
    (void) closedir(dirp);
    return;
}

int main(int argc, char *argv[])
{
    int i;
    for (i = 1; i < argc; i++)
        lookup(argv[i]);
    return (0);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T01:59:05.257

`opendir`不处理通配符。它需要一个真实的目录路径。我不确定你说的是什么意思

> 通配符搜索适用于当前目录

如果你的意思是它可以在你的 shell 中工作，那是可以预料的。shell 将首先扩展通配符，然后执行您键入的命令。

那么如何解决这个问题呢？`glob`在调用之前自己扩展通配符`opendir`。

* * *

编辑：对不起，我以为你试图匹配目录名称中的通配符。看起来您想使用通配符匹配目录内容。在这种情况下，只需更换

```
if (strcmp(dp->d_name, arg) != 0) 
```

和

```
if (fnmatch(arg, dp->d_name, 0) != 0) 
```

* * *

你也可以用`glob`这个。它实际上将替换调用`opendir`和循环。这是一个使用示例`glob`：

```
#include <glob.h>
#include <stdio.h>

static void lookup(const char *root, const char *arg)
{
    size_t n;
    glob_t res;
    char **p;

    chdir(root);
    glob(arg, 0, 0, &res);

    n = res.gl_pathc;
    if (n < 1) {
        printf("failed to find %s\n", arg);
    } else {
        for (p = res.gl_pathv; n; p++, n--) {
            printf("found %s\n", *p);
        }
    }
    globfree(&res);
}

int main(int argc, char *argv[])
{
    int i;
    for (i = 2; i < argc; i++)
        lookup(argv[1], argv[i]);
    return (0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:42:43.093

我不确定你在期待什么。如果您的程序被调用`lookup`，那么如果您在“当前目录”中调用它，该目录包含文件 something.1、something.2 和 something.3，如下所示：

```
lookup something* 
```

外壳会将其扩展为

```
lookup  something.1 something.2 something.3 
```

并且您的程序将看到三个命令行参数，并且能够在 readdir 循环中找到匹配项。

如果您将 opendir 调用更改为 "/dev/shm" 并从原始目录（具有某些内容的目录。[1-3]）调用它，那么 shell 将再次扩展通配符`in the current directory`。但是除非文件something.1、something.2 和something.3 也存在于/dev/shm 中，否则readdir 循环将看不到它们。

请注意，您的查找功能有点奇怪。我希望它更像这样：

```
 static int lookup(const char * dir, const char *arg)
    {
        DIR *dirp;
        struct dirent *dp;

        if ((dirp = opendir(dir)) == NULL) {
            perror(dir);
            return -1;
        }

        while ((dp = readdir(dirp)) != NULL) {
            if (!strcmp(dp->d_name, arg)) {
                break;
            }
        }
        (void) closedir(dirp);

        printf("%s %s\n", dp ? "found" : "failed to find", arg);
        return 0;
    } 
```

# java - Spring 3.1 缓存 - 如何在 SpEL 中使用返回值

> ID：10678524
> 
> 赞同：3
> 
> 时间：2012-05-21T01:05:19.407
> 
> 标签：java, spring, caching, spring-el

我正在尝试驱逐 Spring 管理的缓存（Spring 3.1 抽象）中的条目。

我需要参考注解中“key”属性的SpEL中方法的返回值：

```
 /* (How to refer to the 'T' returned value in the "KEY_ID"?) */
@Caching(evict = { @CacheEvict(value = CACHE_BY_ID, key = KEY_ID) })
public T delete(AppID appID, UserID userID) throws UserNotFoundException {
    return inner.delete(appID, userID);
} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:56:26.253

似乎没有任何方法可以引用返回的对象：

[http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/cache.html#cache-spel-context](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/cache.html#cache-spel-context)

但是为什么你需要这样做呢？您可以参考@CacheEvict "key" 值中的参数，例如：

```
@CacheEvict(value = CACHE_BY_ID, key = "#userID")
public T delete(AppID appID, UserID userID) throws UserNotFoundException {
...
} 
```

更多示例代码响应以下关于必须使用 User 对象的多个属性从多个缓存中逐出的响应：

```
@Caching(evict = {
    @CacheEvict(value = CACHE_BY_ID, key = "#user.userID"),
    @CacheEvict(value = CACHE_BY_LOGIN_NAME, key = "#user.loginName")
    // etc.
})
public T delete(AppID appID, User user) throws UserNotFoundException {
...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-05T17:46:12.540

尝试在你的 SpEL 中使用#result

# ios5 - perpareForSegue - 传递图像名称 - 一开始是空白

> ID：10678525
> 
> 赞同：0
> 
> 时间：2012-05-21T01:05:25.373
> 
> 标签：ios5

我有一个带有两个缩略图的缩略图视图控制器。每个都有一个 IBAction 设置图像名称。下一个视图应显示完整图像。

第一次选择按钮时，新视图打开但完全空白。我回到上一个屏幕（导航控制器）并再次选择按钮，全图屏幕显示正确的全图。

退出，选择第二个按钮并显示第一个按钮的完整图像。

看起来整个图像被一次迭代关闭了。

下面是一些代码片段。

thumbnailViewController.M

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    fullImageViewController *targetVC = (fullImageViewController*)segue.destinationViewController;
targetVC.fullImageName = _imageName;
}

- (IBAction)running1 {
_imageName = @"img_running1.png";
}

- (IBAction)running2 {
_imageName = @"img_running2.png";
} 
```

fullImageViewController.m

```
- (void)viewDidLoad
{
[super viewDidLoad];
_fullImage.image = [UIImage imageNamed: _fullImageName];
} 
```

有什么建议么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:24:10.987

我猜你的按钮上连接了 IBAction 和 Segue？如果是这样，这是你的问题。segue 发生在 IBAction 之前。解决方案不是让按钮连接到 segue，而是让 IBAction 执行它。

```
- (IBAction)running1 {
    _imageName = @"img_running1.png";
    [self performSegueWithIdentifier:@"yourSegue" sender:self];
} 
```

这将通过让您控制来纠正订单。否则我相信它的segue然后行动。

# zend-framework - 自定义路由逻辑和提供静态内容，同时将文档根放在公共目录的父目录中？

> ID：10678527
> 
> 赞同：0
> 
> 时间：2012-05-21T01:05:48.057
> 
> 标签：zend-framework, url-routing

我`Zend_Controller_Router_Route_Abstract`在 Zend Framework 中进行扩展以向我的应用程序添加自定义路由。如果它确定请求路径不是它必须处理的路径之一，我的`match`方法会返回。`false`因此，对于路径，如静态资源路径，我的自定义路由类返回`false`和默认模块路由器负责。

我的问题是，只要我的站点的文档根目录指向我的公共目录，一切正常。当我将文档根目录更改为 wwitch 公用文件夹中的目录时（父目录），尝试请求像[http://mysite.com/css/global.css](http://mysite.com/css/global.css)这样的静态资源时出现以下错误：

> 发生错误 Page not found 异常信息：
> 
> 消息：指定的控制器无效（css）堆栈跟踪：堆栈跟踪：....
> 
> 请求参数：
> 
> ```
>  array (   'controller' => 'css',   'action' => 'global.css',   'module' => 'default', ) 
> ```

这只是信息的一部分，另一部分无关紧要。

我的问题是，我该如何解决这个问题？如何在公共目录的父目录中拥有文档根目录的同时拥有我的自定义路由逻辑和提供静态内容？

这是我在文档根目录未指向公共目录时使用的 .htaccess ：

> 重写引擎开启
> 
> 重写规则 ^.htaccess$ - [F]
> 
> RewriteCond %{REQUEST_URI} ="/" RewriteRule ^.*$ /public/index.php [NC,L]
> 
> RewriteCond %{REQUEST_URI} !^/public/. *$ RewriteRule ^(.* )$ /public/$1
> 
> RewriteCond %{REQUEST_FILENAME} -f RewriteRule ^.*$ - [NC,L]
> 
> RewriteRule ^/public/.*$ /public/index.php [NC,L]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:08:01.720

您不应该从 PHP 提供静态文件。这意味着您应该使用：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

# asp.net - Juice UI - Height、MaxHeight 属性没有影响

> ID：10678532
> 
> 赞同：0
> 
> 时间：2012-05-21T01:06:24.413
> 
> 标签：asp.net, juice-ui

对 Juice UI 进行自我教育，并且对 juice:Dialog 控件的某些属性有疑问，希望这是一个菜鸟。

Iam 根据需要使用 VS 2010、.net 4.0，创建了新的 ASP.net 空 Web 应用程序以保持简单。

我已经使用 NuGet 安装了 Juice UI，安装没有问题。

我的 aspx 页面在下面，后面的代码没有添加任何内容。

我可以使用按钮成功打开对话框，因此下一步是尝试使用不同的对话框属性。

在 Juice:Dialog 控件中，我添加了属性**Height="300px"**。据我了解，这应该打开高度为 300 像素的对话框。对话框实际上打开'折叠'，即我根本看不到文本，并且对话框的大小就像您使用调整大小手柄将其调整到它的最小高度一样。

我在这里想念什么？

**编辑：好吧，如果我把**

```
$("#dialog").dialog({ height: 500 }); 
```

**在单击事件中，我可以设置单击按钮时的大小。所以这一定意味着对话框控件的属性只有在 AutoOpen=True 时才相关，即对话框在初始页面加载时打开。我接近了吗？**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Employees.aspx.cs" Inherits="JuiceSkeleton.Employees" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

</head>
<body>
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<div>
    <button id="accept" runat="server" class="open-dialog" type="button">
        Accept</button>
    <juice:Button ID="acceptButton" runat="server" TargetControlID="accept" />
</div>
<div id="dialog" class="basic-dialog" runat="server">
    <p>
        Default Dialog says No!
    </p>
</div>
<juice:Dialog Draggable="True" ID="dialogButton" Height="300px" runat="server" TargetControlID="dialog"
    AutoOpen="False" />
</form>
</body>
<script type="text/javascript">
 // Respond to the click 
 $(".open-dialog").click(function (e) {
     e.preventDefault();
     // Open the dialog 
     $(".basic-dialog").dialog("open");
 }); 
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T13:25:09.697

问题是该属性只接受一个数值。然而，因为 jQuery UI Dialog 接受“auto”作为值，我们必须使属性类型动态以接受数字和“auto”。删除“px”单位声明。从你的价值会给你正确的输出。

但是，由于内部代码的问题，这将在当前版本中引发异常。

该问题已在此处跟踪，[https://github.com/appendto/juiceui/issues/23](https://github.com/appendto/juiceui/issues/23)，并且已提交修复。下一个维护版本将包含此修复程序。目前，您使用 javascript 的解决方法可以正常工作。当下一个版本发布时，您将能够像往常一样使用该属性。

# android - 多次加载多个位图的最佳实践

> ID：10678533
> 
> 赞同：0
> 
> 时间：2012-05-21T01:06:43.640
> 
> 标签：android, caching, bitmap, android-bitmap

我正在创建一个类似于[Bubble Pop](https://play.google.com/store/apps/details?id=sp.app.bubblePop)的 Android 棋盘游戏，我需要多次使用多个位图。

我有一个石头列表（10x10），其中每个石头都是一个对象，其中包含其位图和一些其他值。很多位图（石头颜色）是相同的。

现在我对列表中的每块石头都使用这样的东西：

```
public class Stone extends Point{

  private Bitmap mImg;

  public Stone (int x, int y, Resources res, Stones mStone) {
    ...
    mImg = BitmapFactory.decodeResource(mRes, mStone.getId());
  }

  protected void changeColor(Stones newD){
      mStone = newD;
      mImg = BitmapFactory.decodeResource(mRes, mStone.getId());
    }
  } 
```

我发现了几个类似的问题，但都是关于大位图的。我还找到了一些[关于缓存图像的 Android 文档](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)，但我不确定它是否能解决我的问题以及如何在我所有的石头之间共享这个缓存。

获得良好性能并避免 OutofMemoryError 的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:27:49.180

您可能不需要缓存。由于您应该拥有有限数量的石头颜色（因此是位图），您可以考虑将这些图形资源保存在一个类中（可能是`static`全局类或通过[单例模式](https://stackoverflow.com/questions/10595470/how-to-maintain-single-instance-of-mediaplayer-android/10595596#10595596)。

在您的`Stone`课程中，您只需要持有石头的颜色 ID 并`drawable`从您的资产类别中获取。（您可以保存位图，但 drawable 效率更高，您可以轻松更改它以允许稍后制作一些动画）

例如：

```
// Singleton - look at the link for the suggested pattern
public class GraphicAssets {
    private Context mContext;
    private Hashtable<Integer, Drawable> assets;

    public Drawable getStone(int id){
        if (assets.containsKey(id)) return assets.get(id);

        // Create stone if not already load - lazy loading, you may load everything in constructor
        Drawable d = new BitmapDrawable(BitmapFactory.decodeResource(mContext.getResources(), id));
        assets.put(id, d);
        return d;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:46:48.907

你可以使位图变量静态或静态最终

# php - 获取实例化类的文件名

> ID：10678539
> 
> 赞同：4
> 
> 时间：2012-05-21T01:07:47.947
> 
> 标签：php, class, abstract-class

假设我`get_class($this)`在一个抽象类方法中得到了类名。

我怎样才能得到定义这个类的文件名？（完整路径）

我知道我可以将它作为参数传递给我的子类并创建一个可在父类中访问的属性，但我想知道 PHP 是否有内置的东西

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T01:19:09.160

您需要的是`ReflectionObject`类及其方法，`ReflectionClass::getFileName`.

```
$reflection_class = new ReflectionClass(get_class($this));
echo $reflection_class->getFileName(); 
```

[在此处](http://www.php.net/manual/en/reflectionclass.getfilename.php)查看函数手册。

# php - 用 PHP 覆盖 LessPHP 变量

> ID：10678540
> 
> 赞同：1
> 
> 时间：2012-05-21T01:08:12.043
> 
> 标签：php, less

我使用[LessPHP](http://leafo.net/lessphp/) (v0.3.4-2)，阅读文档并围绕这个 -basic- 问题进行搜索，但仍然没有找到正确和直接的答案。

这是我的 .less 文件：

```
@bgcolor :#ccc; 
.color(@color:#222) { color:@color; }

body {
  margin:10px auto;
 .color(@color);
 background:@bgcolor;
} 
```

我的PHP代码：

```
<?php
include 'lessc.inc.php';

$style_setting = array (
  'color'       => '#f00',
  'bgcolor'    => '#fee'
);

$cssFile    = "stylesheet.css";
$lessFile    = new lessc("less/stylesheet.less");
file_put_contents($cssFile, $lessFile->parse(null, $style_setting));
?> 
```

样式表结果：

```
body {
  margin:10px auto;
  color:#ff0000;
  background:#cccccc;
} 
```

正如您在上面的示例中看到的，LesPHP 参数 ( *.color(@color:#222)* ) 被覆盖，但*@bgcolor*变量没有。

只是想知道 LessPHP 的工作方式是否正确，还是我在这里错过了什么？为什么 LessPHP 变量没有被覆盖？

任何答案或提示表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T09:53:00.100

为什么没有与`@bgcolor`as相同的实现`.color`？

如果以下适用于`@color`：

```
.color(@color:#222) { color:@color; } 
```

那么以下应该适用于`@bgcolor`：

```
.bgcolor(@bgcolor:#ccc) { background:@bgcolor; } 
```

**更新，对正在发生的事情的解释：**

假设这一切都是用 PHP 编写的，这是一个`.color` *函数*的样子：

```
function color($color = null) {
    if(!$color) {
        return 'color: #222;';
    }
    return 'color: $color;';
}
echo color(); //outputs "color: #222222;"
echo color('#f00'); //outputs "color: #ff0000;"
echo color(); //outputs "color: #222222;" 
```

它采用传递的颜色值或输出默认值。现在，这就是`@bgcolor` *变量*发生的情况：

```
$bgcolor = '#fee';
$bgcolor = '#ccc';
echo 'color: '.$bgcolor.';'; //outputs "background: #cccccc;" 
```

它们的主要区别在于它`.color`是一个可以取值的函数并且`@bgcolor`是一个变量。

你已经有效地定义了你想要的东西，立即覆盖它，然后调用变量。使它动态化的唯一方法是把它变成一个“功能”，就像你在`color`.

# php - php5-fpm 子项和请求

> ID：10678542
> 
> 赞同：4
> 
> 时间：2012-05-21T01:08:29.970
> 
> 标签：php

我有个问题。我拥有一个 128mb vps 的简单博客，每天只有 100 次点击。我安装了 nginx + php5-fpm。考虑到低访问量和内存，我决定将 fpm 设置为静态并运行 1 个服务器。当我进行随机测试（例如通过 http 运行 php 脚本持续 30 多分钟）时，我尝试在同一台机器上打开博客，发现该站点基本上无法访问。所以我去配置并阅读：

```
 The number of child processes to be created when pm is set to 'static' and the
; maximum number of child processes to be created when pm is set to 'dynamic'.
; **This value sets the limit on the number of simultaneous requests that will be
; served** 
```

最让我震惊的是***我不知道***，因为我一直认为一个 php 子进程会像 http 服务器一样同时处理数百个请求！做对了吗？例如，如果我同时启动 2 个 php-fpm 子进程并启动 2 个“长脚本”，那么所有使用相同 php 后端的站点都将无法访问？？这个怎么用？你可能会想：-duh！一个 php 脚本（网页）通常在 100 毫秒内处理-...毫无疑问，但是如果您的页面每个可以运行大约 10 秒，并且我有 10 个使用 php-fpm 的访问者和 5 个服务器所以只接受每次5个请求同时？他们都将排队或​​将经历超时？

老实说，我习惯于在 Windows 中使用 Apache 和 mod_php 运行站点，我从未遇到过这些问题，因为显然这些限制不适用于使用 PHP 的不同方式。

这也提出了另一个问题。如果我有带有 sleep(20) 的 file_1.php 和带有 echo 的 file_2.php，如果我使用 fastcgi 机器运行 file_1 然后 file_2 第二个文件将请求创建另一个服务器来处理使用 4MB RAM 更多的 php 请求. 如果我对 apache/mod_php 做同样的事情，第二个文件将只使用 30KB 以上的 RAM（在 apache 服务器中）。考虑到这一点，如果使用的 ram 实际上更少，为什么 mod_php 会考虑“坏人”……我知道我在这里错过了大局。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-21T01:54:56.643

你基本上是对的。你配置了一个静态的工人数量（这个数字是“一个”）——这正是你得到的。

但是您不太了解事情通常是如何工作的，因为您说：

> 我一直认为 php 子进程会像 http 服务器一样同时处理数百个请求！

我对 nginx 不是很熟悉，但考虑一下 apache 中典型的 mod_php 设置。如果您使用的是 mod_php，那么您使用的是 prefork mpm for apache。因此，每个并发的 http 请求都由不同的 httpd 进程（无线程）处理。如果您正在为低内存调整 apache/mod_php 服务器，您将不得不调整 apache 设置以限制它将产生的进程数（特别是 MaxClients）。

未能调整这些东西意味着当您遇到大量流量峰值时，apache 开始产生大量繁重的进程（请记住，它是 mod_php，因此您在每个 httpd 进程中嵌入了整个 PHP 解释器），并且您的内存不足，然后一切都开始交换，您的服务器开始冒烟。

调整得当（意思是：调整得让你忽略请求，而不是为更多进程分配你没有的内存），客户端会超时，但是当流量减少时，事情就会恢复正常。

将其与 fpm 以及更智能的 Web 服务器架构（如 apache-worker 或 nginx）进行比较。现在你有一些更大的线程池（仍然是可配置的！）来处理 http 请求，以及一个单独的 php-fpm 进程池来处理需要 PHP 的请求。基本上是一样的，如果你不限制可以创建多少个进程/线程，你就是在自找麻烦。但是，如果您进行了调优，您就会领先一步，因为您的请求中只有一小部分使用 PHP。因此，从本质上讲，每个 http 请求所需的平均内存量较低——因此您可以使用相同的内存量处理更多请求。

但是将数字设置为“1”太极端了。在“1”处，您选择静态还是动态都没有关系，因为无论哪种方式，您都只有一个 php-fpm 进程。

因此，要尝试对特定问题给出明确的答案：

> 你可能会想：-duh！一个 php 脚本（网页）通常在 100 毫秒内处理-...毫无疑问，但是如果您的页面每个可以运行大约 10 秒，而我有 10 个使用 php-fpm 的访问者和 5 个服务器，所以只接受每次5个请求同时？他们都将排队或​​将经历超时？

是的，他们都会排队，最终超时。但是，您经常需要 10 秒才能运行脚本这一事实是真正的罪魁祸首。有很多方法可以解决这个问题（缓存、工作队列等），但正确的解决方案完全取决于你想要做什么。

> 老实说，我习惯于使用 Apache 和 mod_php 在 Windows 中运行站点我从未遇到过这些问题，因为显然这些限制不适用于使用 PHP 的不同方式。

他们确实适用。您可以像使用 nginx/php-fpm 一样设置 apache/mod_php 服务器——只需将 apache 的 MaxClients 设置为 1！

> 这也提出了另一个问题。如果我有带有 sleep(20) 的 file_1.php 和只有 echo 的 file_2.php，如果我使用 fastcgi 机器运行 file_1 然后 file_2 第二个文件将请求创建另一个服务器来处理使用 4MB RAM 以上的 php 请求. 如果我对 apache/mod_php 做同样的事情，第二个文件将只使用 30KB 以上的 RAM（在 apache 服务器中）。考虑到这一点，如果使用的 ram 实际上更少，为什么 mod_php 会考虑“坏人”……我知道我在这里错过了大局。

尤其是在 linux 上，许多报告内存使用情况的东西可能会非常具有误导性。但是这样想：30kb 可以忽略不计。那是因为当一些 httpd 进程启动时，大部分 PHP 的内存已经被分配了。

128MB VPS 相当紧张，但应该能够处理多个 php 进程。

如果要优化，请执行以下操作：

对于 PHP：

```
pm = static
pm.max_children=4 
```

对于 nginx，弄清楚如何控制进程和线程数（无论是 apache 的 MaxClients、StartServers、MinSpareServers、MaxSpareServers 的等价物）

然后弄清楚如何生成一些真实的负载（apachebench、siege、jmeter 等）。使用`vmstat`、`free`和`top`来查看您的内存使用情况。将 pm.max_children 和 nginx 的东西调整到尽可能高而不引起任何重大交换（根据`vmstat`）

# .net - 并行运行任务，同时保留取消任务并在一切完成后执行某些操作的选项

> ID：10678544
> 
> 赞同：0
> 
> 时间：2012-05-21T01:08:46.620
> 
> 标签：.net, windows-8, async-await, c#-5.0

我调用了一个异步方法，该方法又调用需要启动几个异步操作。

一旦所有异步操作完成，我需要通知调用者操作是完成还是取消。代码如下所示。它似乎一直有效，直到它因 FatalExecutionEngineError 而崩溃。我不打任何 P/invoke 或不安全的电话。

```
 public class Fetcher
    {
        private List<ItemsBoundToUI> uiItems;
        public async Task<bool> Fetch()
        {
            List<Task> currentlyRunningTasks = new List<Task>();

                var src = new CancellationTokenSource();

                foreach (var channel in this.uiItems)
                {
                    var task = FetchForItem(channel, src.Token);
                    currentlyRunningTasks.Add(task);
                }

            bool wasCancelled = await Task.Factory.ContinueWhenAll(currentlyRunningTasks.ToArray(),
                                                                    (s) =>
                                                                    {
                                                                        bool wasC = s.Any(ss => ss.IsCanceled);

                                                                        return wasC;
                                                                    }
                                                                    );

           return !wasCancelled;
        }

        private async Task FetchForItem(ItemsBoundToUI channel, CancellationToken src)
        {
            var subitems = await dataRepository.GetSubItemsAsync(channel.ID);

            if (src.IsCancellationRequested)
                return;
            channel.SubItems = subitems;
        }
    } 
```

错误消息说

> 运行时遇到致命错误。错误地址位于线程 0xd94 上的 0x6c108144。错误代码为 0xc0000005。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。

怎么可能等到所有任务都完成，或者直到它们被取消，然后返回一个值来指示它们是完成还是被取消？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:10:15.243

`FatalExecutionEngineError`听起来像一个CLR错误。请开发一个最小的复制并通过[Microsoft Connect](http://connect.microsoft.com/VisualStudio)向 Microsoft 报告。

最好让取消按照设计的方式工作（通过例外）。对于`await`多个任务，请使用`Task.WhenAll`.

```
public class Fetcher
{
  private List<ItemsBoundToUI> uiItems;
  public async Task<bool> Fetch()
  {
    List<Task> currentlyRunningTasks = new List<Task>();
    var src = new CancellationTokenSource();
    foreach (var channel in this.uiItems)
    {
      var task = FetchForItem(channel, src.Token);
      currentlyRunningTasks.Add(task);
    }

    try
    {
      await Task.WhenAll(currentlyRunningTasks);
      return true;
    }
    catch (OperationCanceledException)
    {
      return false;
    }
  }

  private async Task FetchForItem(ItemsBoundToUI channel, CancellationToken src)
  {
    var subitems = await dataRepository.GetSubItemsAsync(channel.ID);
    src.ThrowIfCancellationRequested();
    channel.SubItems = subitems;
  }
} 
```

# linq-to-sql - linq to dictionary 上的错误消息-“已添加相同键值的项目”

> ID：10678545
> 
> 赞同：0
> 
> 时间：2012-05-21T01:08:48.207
> 
> 标签：linq-to-sql

我正在尝试使用基于 ID（GUID）的 linq 进行集合。使用字典时出现错误“已添加具有相同键的项目”有什么建议吗？

```
 foreach (Guid i in ar) 
                          { 

               var prod = (from r in datacontext.item_tables's where r.itemID == i select r); 
        Dictionary<Guid, item_tables> tempdata =prod.ToDictionary(s => s.itemID); 
         Facet[] ftemp = new Facet[tempdata.Count]; 
               string s1 = ""; 

               ftemp[0] = new Facet("descriptiob", FacetType.Text, tempdata[i].Description); 

               ftemp[1] = new Facet("date", FacetType.Text, tempdata[i].uploaddate); 

               for (int iv = 0; iv < tempdata.Count; iv++) 
               { 

                   s1 += tempdata[i].ProductName + " \n";  
               } 

               ftemp[2] = new Facet("ProductName", FacetType.Text, s1); 

           } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:30:06.920

您基本上是在使用以下代码构建字典：

```
datacontext
    .item_tables
    .Where(r => r.itemID == i)
    .ToDictionary(s => s.itemID); 
```

一次将`Where`结果过滤到`itemID`特定`i`( `Guid`) 的位置，但可以返回零个、一个或多个结果。显然，您收到的错误表明，对于您中的至少一个值，`i`您收到的记录不止一条。

这意味着您的数据库未正确规范化或代码中存在逻辑错误的问题。

对我来说，这听起来像是后者。

在您的代码中进一步向下，您有这个循环：

```
 for (int iv = 0; iv < tempdata.Count; iv++) 
    { 
        s1 += tempdata[i].ProductName + " \n";  
    } 
```

这对我说，您希望`tempdata`字典具有多个值 - 但是您正在使用`itemID`作为键来构建字典，并且这应该只根据您的查询在字典中放置一个值。所以你的逻辑有问题。

你能更详细地描述你想要做什么吗？

* * *

根据您在下面的评论（没有我的评论中的澄清），这似乎是您想要的：

```
var query =
    from r in datacontext.item_tables
    group r.ProductName by new
    {
        r.itemID,
        r.Description,
        r.uploaddate,
        r.ItemName,
    };

foreach (var items in query.ToArray())
{
    var f0 = new Facet("descriptiob", FacetType.Text, items.Key.Description);
    var f1 = new Facet("date", FacetType.Text, items.Key.uploaddate);
    var f2 = new Facet("ProductName", FacetType.Text, String.Join("\n", items));
    collection.AddItem(items.Key.ItemName, null, null, f0, f1, f2); 
} 
```

# python - 在 scipy 中创建新的发行版

> ID：10678546
> 
> 赞同：11
> 
> 时间：2012-05-21T01:08:59.750
> 
> 标签：python, numpy, scipy

我正在尝试根据我拥有的一些数据创建一个分布，然后从该分布中随机抽取。这是我所拥有的：

```
from scipy import stats
import numpy

def getDistribution(data):
    kernel = stats.gaussian_kde(data)
    class rv(stats.rv_continuous):
        def _cdf(self, x):
            return kernel.integrate_box_1d(-numpy.Inf, x)
    return rv()

if __name__ == "__main__":
    # pretend this is real data
    data = numpy.concatenate((numpy.random.normal(2,5,100), numpy.random.normal(25,5,100)))
    d = getDistribution(data)

    print d.rvs(size=100) # this usually fails 
```

我认为这是在做我想做的事，但是当我尝试这样做时，我经常会遇到错误（见下文）`d.rvs()`，并且`d.rvs(100)`永远不会工作。难道我做错了什么？有没有更简单或更好的方法来做到这一点？如果它是 scipy 中的一个错误，有没有办法绕过它？

最后，是否有更多关于在某处创建自定义发行版的文档？我发现的最好的文档是 scipy.stats.rv_continuous 文档，它非常简陋，不包含任何有用的示例。

追溯：

> 回溯（最后一次调用）：文件“testDistributions.py”，第 19 行，打印 d.rvs(size=100) 文件“/usr/local/lib/python2.6/dist-packages/scipy-0.10.0 -py2.6-linux-x86_64.egg/scipy/stats/distributions.py”，第 696 行，在 rvs vals = self._rvs(*args) 文件中“/usr/local/lib/python2.6/dist-packages /scipy-0.10.0-py2.6-linux-x86_64.egg/scipy/stats/distributions.py”，第 1193 行，在 _rvs Y = self._ppf(U,*args) 文件“/usr/local/lib /python2.6/dist-packages/scipy-0.10.0-py2.6-linux-x86_64.egg/scipy/stats/distributions.py”，第 1212 行，在 _ppf 返回 self.vecfunc(q,*args) 文件“/usr/local/lib/python2.6/dist-packages/numpy-1.6.1-py2.6-linux-x86_64.egg/numpy/lib/function_base.py”，第 1862 行，**调用中** theout = self.thefunc(*newargs) 文件“/usr/local/lib/python2.6/dist-packages/scipy-0.10.0-py2.6-linux-x86_64.egg/scipy/stats/distributions.py” ，第 1158 行，在 _ppf_single_call 返回 optimize.brentq(self._ppf_to_solve, self.xa, self.xb, args=(q,)+args, xtol=self.xtol) 文件“/usr/local/lib/python2.6 /dist-packages/scipy-0.10.0-py2.6-linux-x86_64.egg/scipy/optimize/zeros.py"，第 366 行，在 brentq 中 r = _zeros._brentq(f,a,b,xtol,maxiter ,args,full_output,disp) ValueError: f(a) 和 f(b) 必须有不同的符号

**编辑**

对于那些好奇的人，请按照以下答案中的建议，以下是有效的代码：

```
from scipy import stats
import numpy

def getDistribution(data):
    kernel = stats.gaussian_kde(data)
    class rv(stats.rv_continuous):
        def _rvs(self, *x, **y):
            # don't ask me why it's using self._size 
            # nor why I have to cast to int
            return kernel.resample(int(self._size)) 
        def _cdf(self, x):
            return kernel.integrate_box_1d(-numpy.Inf, x)
        def _pdf(self, x):
            return kernel.evaluate(x)
    return rv(name='kdedist', xa=-200, xb=200) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T04:10:40.723

特别是您的回溯：

rvs 使用 cdf 的倒数 ppf 创建随机数。由于您没有指定 ppf，因此它是通过寻根算法计算的，`brentq`. `brentq`使用下限和上限来搜索函数为零的值（找到 x 使得 cdf(x)=q, q 是分位数）。

在您的示例中，限制的默认值`xa`和`xb`太小。以下适用于我的 scipy 0.9.0, `xa`，`xb`可以在创建函数实例时设置

```
def getDistribution(data):
    kernel = stats.gaussian_kde(data)
    class rv(stats.rv_continuous):
        def _cdf(self, x):
            return kernel.integrate_box_1d(-numpy.Inf, x)
    return rv(name='kdedist', xa=-200, xb=200) 
```

目前有一个 scipy 的拉取请求来改进这一点，因此在下一个版本中`xa`，`xb`将自动扩展以避免`f(a) and f(b) must have different signs`异常。

这方面的文档不多，最简单的方法是遵循一些示例（并在邮件列表中询问）。

编辑：补充

**pdf**：由于您也有 gaussian_kde 给出的密度函数，我将添加该`_pdf`方法，这将使一些计算更有效。

编辑2：添加

**rvs**：如果您对生成随机数感兴趣，那么 gaussian_kde 有一个 resample 方法。可以通过从数据中采样并添加高斯噪声来生成随机样本。因此，这将比使用 ppf 方法的通用 rvs 更快。我会写一个 ._rvs 方法，它只调用 gaussian_kde 的 resample 方法。

**预计算 ppf**：我不知道预计算 ppf 的任何一般方法。但是，我想到的方法（但到目前为止从未尝试过）是在许多点上预先计算 ppf，然后使用线性插值来近似 ppf 函数。

edit3：即将`_rvs`在评论中回答 Srivatsan 的问题

`_rvs`是由公共方法调用的特定于分发的方法`rvs`。`rvs`是一个通用方法，它进行一些参数检查，添加位置和比例，并设置属性`self._size`是所请求的随机变量数组的大小，然后调用分布特定方法`._rvs`或其通用对应方法。中的额外参数`._rvs`是形状参数，但因为在这种情况下没有，`*x`并且`**y`是多余且未使用的。

我不知道`size`该方法的 or 形状`.rvs`在多变量情况下的效果如何。这些分布是为单变量分布设计的，可能无法完全适用于多变量情况，或者可能需要一些重塑。

# assembly - x86 程序集 - masm32：将变量推送到堆栈时出现问题

> ID：10678551
> 
> 赞同：1
> 
> 时间：2012-05-21T01:12:02.547
> 
> 标签：assembly, input, x86, masm, masm32

我正在尝试制作一个程序，它获取两个输入数字，将它们相乘（将结果存储在一个变量中），将它们相除（将结果存储在另一个变量中）并打印结果。

我遇到的问题是第一行代码`push num1`返回`invalid instruction operands`：

```
.data
        num1 db "Enter a number:"
        num2 db "Enter another number:"
.data?
        buffer1 dd 100 dup(?) ; this is where I store input for num1
        buffer2 dd 100 dup(?) ; " " num2
.code
start:
        push num1 ; here is where it returns the error
        call StdOut ;I want to print num1 but it doesn't get that far.
                    ; later on in my code it does multiplication and division.
        push buffer1 ; I push buffer1
        call StdIn  ; so that I can use it for StdIn
                    ; I repeat this for num2
        ; I then use those 2 numbers for multiplication and division. 
```

为什么会导致此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:29:00.600

```
start:
    push    offset num1
    call    Stdout    
    ; or 
    lea     eax, num1
    call    StdOut

    ;this:
    push    num1 
    ; is pushing the letter 'E' I believe.
    ; here is where it returns the error
    call    StdOut 

    ; this is wrong also:
    push    buffer1 ; I push buffer1 <<<  no, you are trying to push the val of buffer1
    call    StdIn  ; so that I can use it for StdIn

    ; you need to pass an address of the label (variable)
    ; so either
    lea     eax, buffer1
    push    eax
    call    StdIn

    ; or
    push    offset buffer1
    call    StdIn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:18:32.917

错误信息很清楚，操作数无效。你不能这样做：

```
push num1 
```

操作码“推送”是有效的，但是在 x86 指令集中，只能推送某些寄存器，不能推送字节序列（字符串）。你的 num1 是一个字节序列。

例如：

```
push ax 
```

是有效指令和有效操作数。

您可以推送的有效寄存器示例：AH、AL、BH、BL、CH、CL、DH、DL、AX、BX、CX、DX 等。

# visual-c++ - Visual C++（Windows 窗体应用程序）中的“主”函数等价物是什么？

> ID：10678554
> 
> 赞同：1
> 
> 时间：2012-05-21T01:13:23.480
> 
> 标签：visual-c++, cursor

我有在 Visual C++（Windows 窗体应用程序）中获取光标位置的代码。但是我如何显示它？我使用了标签，但它并没有给我一个不断变化的光标位置。我的主要问题是在普通的 c++ 程序中，我在“main”函数中编写了无限 while 循环代码。我在哪里用 Visual C++（Windows 窗体应用程序）代码编写它？

```
if (!GetCursorPos(&point)) {
    this->label4->Text = "An error occurred: ";
    //cout << GetLastError();
} else {
    x = point.x;
    y = point.y;
}
Sleep(1000);
//system("cls");
this->label3->Text = Convert::ToString(x);
this->label4-> Text=Convert::ToString(y); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T10:43:33.447

表单提供了一个事件系统，而不是无限循环来获取光标位置和更新标签。因此，您可以计算出光标位置并每次更新标签，鼠标通过鼠标移动事件在您的应用程序中移动。

有关文档和一些示例，请参阅[Control::MouseMove 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousemove.aspx)。

# javascript - 循环通过从 API 接收到的 json

> ID：10678555
> 
> 赞同：2
> 
> 时间：2012-05-21T01:13:38.373
> 
> 标签：javascript, jquery, json, parsing

我似乎只得到了姓氏的最后一个条目。我已经花了一整天的时间，想知道是否有人能看到我缺少的东西。谢谢

```
<!doctype html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Untitled Document</title>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $.ajax({
                    url: "http://testsite.legisconnect.com/list.php",
                    dataType: "json",
                    success: function (data) {
                        $.each(data.response.legislators, function (i, item) {
                            $('#here').html(item.legislator.lastname);
                        });
                    }
                });
            });
        </script>
    </head>

    <body>
        <div id="here"></div>
    </body>

</html> 
```

JSON

```
{
    "response": {
        "legislators": [{
            "legislator": {
                "website": "http://ackerman.house.gov/",
                "fax": "202-225-1589",
                "govtrack_id": "400003",
                "firstname": "Gary",
                "chamber": "house",
                "middlename": "L.",
                "lastname": "Ackerman",
                "congress_office": "2111 Rayburn House Office Building",
                "eventful_id": "",
                "phone": "202-225-2601",
                "webform": "http://www.house.gov/writerep",
                "youtube_url": "http://www.youtube.com/RepAckerman",
                "nickname": "",
                "gender": "M",
                "district": "5",
                "title": "Rep",
                "congresspedia_url": "http://www.opencongress.org/wiki/Gary_Ackerman",
                "in_office": true,
                "senate_class": "",
                "name_suffix": "",
                "twitter_id": "repgaryackerman",
                "birthdate": "1942-11-19",
                "bioguide_id": "A000022",
                "fec_id": "H4NY07011",
                "state": "NY",
                "crp_id": "N00001143",
                "official_rss": "",
                "facebook_id": "RepAcherman",
                "party": "D",
                "email": "",
                "votesmart_id": "26970"
            }
        }, {
            "legislator": {
                "website": "http://adams.house.gov/",
                "fax": "202-226-6299",
                "govtrack_id": "412414",
                "firstname": "Sandra",
                "chamber": "house",
                "middlename": "",
                "lastname": "Adams",
                "congress_office": "216 Cannon House Office Building",
                "eventful_id": "",
                "phone": "202-225-2706",
                "webform": "",
                "youtube_url": "http://www.youtube.com/RepSandyAdams",
                "nickname": "",
                "gender": "F",
                "district": "24",
                "title": "Rep",
                "congresspedia_url": "http://www.opencongress.org/wiki/Sandy_Adams",
                "in_office": true,
                "senate_class": "",
                "name_suffix": "",
                "twitter_id": "RepSandyAdams",
                "birthdate": "1956-12-14",
                "bioguide_id": "A000366",
                "fec_id": "H0FL24049",
                "state": "FL",
                "crp_id": "N00030926",
                "official_rss": "",
                "facebook_id": "",
                "party": "R",
                "email": "",
                "votesmart_id": "31041"
            }
        }, {
            "legislator": {
                "website": "http://aderholt.house.gov/",
                "fax": "202-225-5587",
                "govtrack_id": "400004",
                "firstname": "Robert",
                "chamber": "house",
                "middlename": "B.",
                "lastname": "Aderholt",
                "congress_office": "2264 Rayburn House Office Building",
                "eventful_id": "",
                "phone": "202-225-4876",
                "webform": "http://aderholt.house.gov/?sectionid=195&sectiontree=195",
                "youtube_url": "http://www.youtube.com/RobertAderholt",
                "nickname": "",
                "gender": "M",
                "district": "4",
                "title": "Rep",
                "congresspedia_url": "http://www.opencongress.org/wiki/Robert_Aderholt",
                "in_office": true,
                "senate_class": "",
                "name_suffix": "",
                "twitter_id": "Robert_Aderholt",
                "birthdate": "1965-07-22",
                "bioguide_id": "A000055",
                "fec_id": "H6AL04098",
                "state": "AL",
                "crp_id": "N00003028",
                "official_rss": "",
                "facebook_id": "RobertAderholt",
                "party": "R",
                "email": "",
                "votesmart_id": "441"
            }
        }]
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T01:16:56.850

通过[`.html()`](http://api.jquery.com/html/)与每次迭代一起使用，您将覆盖您的结果。因此，仅显示最后一个条目。尝试使用[`.append()`](http://api.jquery.com/append/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T01:17:13.567

在您的成功处理程序中，您将遍历集合并每次都将 innerHTML 替换为新条目。

```
 success: function (data) {
                    $.each(data.response.legislators, function (i, item) {
                        $('#here').html(item.legislator.lastname);
                    });
                } 
```

因此，当您到达循环末尾时，仅插入最近的姓氏，因为所有其他姓氏都已被重复替换。

您的意思是附加，如下例所示？或者也许每次都在不同的元素中插入名称？

```
 success: function (data) {
                    $.each(data.response.legislators, function (i, item) {
                        $('#here').append('<span>' + item.legislator.lastname + '</span>');
                    });
                } 
```

# c++ - 我的初始化列表中的小错字会导致无法形容的痛苦

> ID：10678559
> 
> 赞同：11
> 
> 时间：2012-05-21T01:15:03.317
> 
> 标签：c++, gcc, g++, compiler-warnings

所以，我刚刚完成了一个大型服务器应用程序的耗时数小时的艰苦调试会话。该错误最终归结为构造函数中几乎不明显的错字。基本上，它是这样的：

```
template <class T>
class request_handler
{
    public:

    request_handler(T& request, Log& error_log) 
      : m_request(m_request), m_error_log(error_log)
     { 
       /*... some code ... */
     }

    ...
}; 
```

看到错误了吗？好吧，我没有。问题是初始化列表中的一个小错字：`m_request(m_request)`正在为自己分配一个未初始化的引用。显然，它应该读取`m_request(request)`.

现在，成员变量`m_request`的类型为`T&`。那么 - 编译器是否有某种原因没有警告我我在这里使用了未初始化的变量？

使用带有`-Wall`标志的 GCC 4.6，如果我说：

```
int x;
x = x; 
```

...它会发出警告：`warning: ‘x’ is used uninitialized in this function [-Wuninitialized]`

那么，为什么当我分配`m_request`给自己时编译器没有警告我：本质上是给自己分配一个未初始化的引用？它会为我节省数小时的烦恼。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T01:34:12.660

令人讨厌的错误要追踪。事实证明，您甚至不需要模板就可以在此模板上静默失败。这可以解决问题：

```
class C {
        int a, b;
public:
        C(int t, int z) : a(a), b(z) { };
}; 
```

Clang 用`-Wuninitialized`.

*对 gcc 人来说是个好消息*：根据 gnu 的 bugzilla，[gcc 4.7.0 已经修复了这个问题](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=18016)。

**更新**

在 gcc 4.7.0 上，添加`-Wself-init`以获取此警告（由[sbellef](https://stackoverflow.com/users/155231/sbellef)验证）：

> tst.cc：在构造函数'C::C(int, int)'中：tst.cc:4:9：警告：'C::a'用自身初始化[-Wuninitialized]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T01:42:28.303

我喜欢使用与构造函数参数相同的成员名称的技巧。

```
template <class T>
request_handler(T& request, Log& error_log) 
 : request(request), error_log(error_log)
{ 
  /*... some code ... */
} 
```

这将始终防止错误。您必须小心，因为函数体`request`中指的是参数，而不是成员。这对于引用等简单类型当然无关紧要，但我不建议将它用于类。

# parsing - 在 C++ 中解析命令行参数。我有一个奇怪的错误

> ID：10678561
> 
> 赞同：1
> 
> 时间：2012-05-21T01:15:08.957
> 
> 标签：parsing, command-line, parameters, argv

当我尝试解析命令行参数时，我遇到了一个奇怪的错误。为什么我说它很奇怪？嗯，那是因为我之前已经对 C++ 中的命令行解析做了很多研究，而且没有人的测试代码可以在我的 Visual Studio 2010 IDE 上运行。当我使用调试器时，我发现当我尝试检查参数时总是返回 FALSE。在下面的示例中，当我执行 if (argv[1] == "-in") 时。我尝试在监视窗口中以几种不同的方式对其进行测试。我试着先把它传递给一个字符串。或者使用单引号。然后我在互联网上搜索并使用了其他人的代码，据说这些代码可以正常工作。我究竟做错了什么？这是我在 Visual Studio 环境中设置错误的设置吗？

这是我最初的

```
#include <iostream>
#include <stdlib.h>
#include <sstream>
#include <fstream>

using namespace std;

int main(int argc, char * argv []) //Usage FileSplitter -in [filename] -sz [chunk size]
{

if (argc==5)
    {
    string strTest = argv[1];
    if ((argv[1] == "-in") && (argv[3] == "-sz"))
                 {
                        //Code here
                 }
    }
} 
```

无论如何，那是我的原始代码。我已经尝试对其进行多次调整，并尝试使用以下网站的代码...

[http://www.cplusplus.com/forum/articles/13355/](http://www.cplusplus.com/forum/articles/13355/) 他有一些比较 argv[1] 和字符串的例子......他说它有效。

[http://www.cplusplus.com/forum/unices/26858/](http://www.cplusplus.com/forum/unices/26858/) 还有一个人在这里发布了一些关于比较的代码。在 Ryan Caywood 的帖子下。

当我尝试进行比较时，它们对我不起作用。我正在考虑只做一个合法的 strcmp，但我想知道为什么我的 Visual Studio 环境没有像在其他人的系统上那样编译？

另外，在调试过程中，我在项目属性的调试部分输入命令行参数。我不知道这是否会影响任何事情。我也尝试构建和运行该项目，但可惜，一切都无济于事。提前感谢任何能给我一些好的建议的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:43:33.370

参数是通过 c 字符串传递的，所以如果我没记错的话，使用 == 比较它们只会比较指向它们的指针。尝试使用 strcmp() 比较两个 c 字符串，或者将两者都转换为 c++ 字符串并以这种方式进行比较，如果必须的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T12:47:33.490

您正在错误地进行字符串比较。

要么使用 C 风格，`strcmp()`要么（如您提到的链接中建议的那样），`string`首先转换为 C++ 风格。

```
if (string(argv[i]) == "stuff") { ... } 
```

# networking - DNS 请求丢失

> ID：10678576
> 
> 赞同：1
> 
> 时间：2012-05-21T01:17:38.313
> 
> 标签：networking

UDP 包就像一去不复返，你永远不知道它是否被接收。所以不是保证会收到天气包。我了解到大多数 DNS 使用 UDP 包来发送请求。如何处理使用 UDP 请求的 DNS 丢失？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:23:26.550

如果在一定时间内没有收到响应包，则重新发送请求。[Dan Bernstein 建议大多数客户最多会重试四次。](http://cr.yp.to/djbdns/notes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T19:23:33.767

有两种方法可以确定 UDP 数据报已丢失。两者都不是完全可靠的。

*   最常见的是超时。您发送消息并等待响应。如果您在一段时间后没有收到响应，则您*认为*消息或响应已丢失。到时候你可以再试一次，或者放弃。消息或响应也可能需要很长时间才能通过网络，因此您必须考虑重复。请注意，包括 TCP 在内的所有分组交换通信都以这种方式工作。TCP 只是为您隐藏详细信息。

*   另一种方法是查找告诉您数据包已被丢弃的 ICMP 消息。例如，`ICMP_UNREACH_PORT`、`ICMP_UNREACH_HOST`或`ICMP_UNREACH_HOST_PROHIB`。但是，这些消息不仅很少发送并且本身会丢失，而且有时即使消息确实成功通过，您也可以收到它们。充其量，如果您收到 ICMP 消息，您可以将其视为可能发生的事情的建议。

大多数 DNS 实现都使用短超时，因为重复没什么大不了的。在对一台 DNS 服务器重复几次之后，它会尝试另一台（假设有多个服务器可用）。大多数实现还将缓存有关哪些服务器正在响应和哪些没有响应的信息。

# objective-c - 从文本字段中获取值以传递给 CLGeocoder

> ID：10678577
> 
> 赞同：0
> 
> 时间：2012-05-21T01:17:40.867
> 
> 标签：objective-c, ios, uitextfield

我正在尝试显示用户在某些文本字段中输入的地址的纬度和经度值。理想情况下，我希望用户输入地址，然后单击一个按钮，该按钮将找到纬度/经度并将这些值输入到同一视图中的两个文本字段中。我只是不确定如何在代码中调用这些文本字段的地址值。

这是我到目前为止所拥有的

```
-(IBAction)getLatLon:(id)sender{

CLGeocoder *geocoder = [[CLGeocoder alloc] init]; 
NSString *addressString = @"%@address, city, county, county, postcode";
[geocoder geocodeAddressString:addressString inRegion:nil completionHandler:^(NSArray* placemarks, NSError* error)
 {
     for (CLPlacemark * aPlacemark in placemarks)
     {                    // Process the placemark.
         NSLog(@"Got Placemark : %@", aPlacemark);     

     }
 }]; 
```

}

例如，当我对您的值进行硬编码时，它会起作用

```
NSString *addressString = @"Belfast"; 
```

我知道我可能试图完全错误地调用这些值，但在这个阶段我的脑袋完全炸了！

我的文本字段是这样命名的

```
addressText.text
cityText.text
countyText.text
countryText.text
postcodeText.text 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:27:54.733

您需要使用[stringWithFormat:](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithFormat%3a)方法。*在您的字符串 (%@) 中为您要使用的每个字符串*添加占位符，然后列出后面的参数（您熟悉`printf`吗？）

# c++ - GetAsyncKeyState() CPU 很重？我是否正确使用它？

> ID：10678583
> 
> 赞同：1
> 
> 时间：2012-05-21T01:19:10.280
> 
> 标签：c++, winapi, loops

我在我的一个简单的乒乓球游戏中使用 GetAsyncKeyState() 来检查用户是否按下了箭头键。我在网上读到您需要以某种方式使用此功能，但我发现它非常占用 CPU（使用了我的 CPU 的 50%！）。这是相当令人不安的，然而，在玩了一些之后，我发现如果我添加了一个，`sleep(1);`那么 CPU 使用率就会下降到 0% 并且一切仍然正常。必须有更好的方法来使用此功能，或者至少有更好的方法来降低 CPU 使用率。

在这里的任何帮助将不胜感激！

我的代码：

```
while(true)
{
    for(i = 8; i < 191; ++i)
    {
        if(GetAsyncKeyState(i) == -32767)
        {
            if(i == VK_LEFT)
                 // do stuff
            else if(i == VK_RIGHT)
                 // do stuff
            else if(i == VK_UP)
                 // do stuff
            else if(i == VK_DOWN)
                 // do stuff
        }
    }
    Sleep(1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:39:45.427

这不是`GetAsyncKeyState`CPU 密集型的。就是你一直在尽可能快地调用它。这相当于说`i++`当您在无限循环中运行它时会占用大量 CPU。

您应该使用`GetMessage`等待直到您真正有输入，或者如果这还不够好（因为您可能还想在不等待消息的情况下更新一些动画），那么您应该选择一些轮询间隔并使用类似的东西[`MsgWaitForMultipleObjects`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684242.aspx)（或经常创建带有 ) 的重复计时器消息[`SetTimer`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644906.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T03:05:24.987

任何你的程序在没有某种消息机制、用户输入或阻止程序执行的情况下无限重复的任何事情，默认情况下都会导致程序耗尽所有可用的 CPU 资源。

您最初的键盘输入处理实现非常低效。通过阻止执行流程，`Sleep`你已经设法克服了这个问题，但是以准确性为代价——如果用户设法在不到 1 毫秒的时间内按下一个键，你的程序将简单地忽略它。

您可以使用设置键盘挂钩并直接拦截和直接处理击键，而不是使用`GetAsyncKeyState`用于不断检查按键的按键。[这些](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644959%28v=vs.85%29.aspx)[应该](http://www.codeproject.com/Articles/1264/KeyBoard-Hooks)会有所帮助。`SetWindowsHookEx`

其他选项是使用 DirectInput、外部输入处理库或包装器。

# navigation - CSS：“选定”选项卡和重叠框阴影

> ID：10678584
> 
> 赞同：2
> 
> 时间：2012-05-21T01:19:31.373
> 
> 标签：navigation, css

在导航菜单中，我试图让选定的导航项显示一个与显示附加到选定导航项的 div 共享的阴影。

我见过一些人完成了类似的事情，但没有完全做到，模仿他们的想法并没有让我到达那里。我尝试过依赖 z-index 和定位，以及溢出和填充，但我只是没有看到如何实现这一点。

这是我正在尝试做的事情：

![](../Images/fe037765b4842c432b13a03aa4fc70a7.png)

我需要选项卡和依赖 div 出现以共享框阴影。相反，发生的是：

[http://jsfiddle.net/dilettante/ctHBe/](http://jsfiddle.net/dilettante/ctHBe/)

有什么答案吗？希望这是我忽略的简单事情......非常感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:13:39.873

添加另一个带有白色背景的元素来覆盖阴影怎么样？讨厌但应该工作...... [http://jsfiddle.net/ctHBe/3/](http://jsfiddle.net/ctHBe/3/)

# php - 在 Symfony 中，仅为服务制作捆绑包是一种好的编程习惯吗？

> ID：10678585
> 
> 赞同：1
> 
> 时间：2012-05-21T01:20:54.263
> 
> 标签：php, model-view-controller, symfony

我有一个提供基于 REST 的服务的 symfony 应用程序。我有一个模块负责用户登录/注销/注册操作，称为 UserBundle。

一旦用户登录（并提供了令牌哈希），我还有其他捆绑包提供资源。

现在，对于请求的每个资源，客户端都会发回需要验证的令牌。我究竟在哪里放置这个身份验证功能？我的意思是我知道它需要是一个可以注入多个包的服务，但这是否意味着我最好创建它自己的包？我将来可能需要的其他服务呢？如果我为每个包创建一个包，那么我的代码组织会很快变得丑陋。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:50:36.113

我会将服务放在 UserBundle 中，因为 UserBundle 处理身份验证。

一般来说，我喜欢将服务放入与它们最相关的包中。我通常还有一个“默认”包，我将*有限*数量的真正通用的服务、实体、控制器等聚合到其中。理论上，默认的任何东西都可以在另一个项目中通用，并且几乎总是超过另一捆。有时，我在 Default 中的一些零碎的东西已经成熟到一个点，它们在更具体但仍然通用的捆绑包中更有意义（类似于你的 UserBundle.. 我认为它可能可以放入多个项目中） ); 这些被重构并相应地命名。

曾几何时，我曾经为任何我认为是“模块”的东西拆分新的捆绑包。但是，这些天来，我尝试限制应用程序中的捆绑包数量。我发现这可以使代码更清晰，更易于管理；特别是因为我对任何给定模块的“边界”的想法都是错误的，我最终会四处移动代码。再加上主要在一个核心包中工作，使得代码导航更加简单。

# .net - HTML5：如何使用 Javascript 使用 .NET Web 服务？（HTTP 发布）

> ID：10678588
> 
> 赞同：1
> 
> 时间：2012-05-21T01:22:07.180
> 
> 标签：.net, web-services, html

请帮我解决一下这个。我在网站上使用 HTML5，.NET 服务（.asmx）。我有一个方法 getText() 它返回一个文本字符串。如何调用它并将其显示在我的 html5 网页上？

.NET 网络服务

```
getText(){
    return "Hello";
    }
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:54:55.987

Dave Ward 写了一篇非常有帮助的文章，它应该会引导您通过代码来完成这个确切的场景。

[使用 jQuery 使用 ASP.NET JSON Web 服务](http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/)

这是一个基本示例，它将简单地将来自服务器的响应输出到`<div>`标签中。

```
<div id="output"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
  $(function() {
    $.ajax({
      type: "POST",
      url: "PATH-TO-WEB-SERVICE.asmx/WEB-SERVICE-METHOD-NAME",
      data: "{}",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function(response) {
        $('#output').html(response);
      }
    });
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T05:27:09.237

首先包括最新的 jquery 库。以下是从 asmx Web 服务获取数据的简单 ajax 调用。我使用的数据类型是 json。当您的服务响应成功时，它会调用“SuccessFunc”函数，否则会调用“FailedFunc”。

```
function GetText() {
                try {
                    $.ajax({
                        type: "POST",
                        url: "http://localhost/YourService/YourService.asmx/GetText",
                        data: "{''}",
                        contentType: "application/json; charset=utf-8",
                        success: SucceedFunc,
                        dataType: "json",
                        failure: FailedFunc
                    });
                }
                catch (e) {
                    alert('failed to call web service. Error: ' + e);
                }
            } 
```

失败的功能

```
function FailedFunc(error) {
     alert('error: ' + error);    
        } 
```

成功函数

```
function SuccessFunc(responce) {
           alert(eval(responce.d));
        } 
```

# assembly - 仅使用位移和加法将两个字节相乘的更好方法是什么？

> ID：10678590
> 
> 赞同：6
> 
> 时间：2012-05-21T01:22:20.403
> 
> 标签：assembly, bit-manipulation, pic, multiplication

## 最初的问题：

我们中的一群人（电子工程专业的学生——英国）最近在我们自己的时代开始着手对 PIC16F84A 微控制器进行编程。需要将两个 8 位数字相乘，每个数字都没有已知的最小值/最大值。一位同学提出了以下想法。

```
multiply_numbers:
; Takes numbers in Num1 and Num2, and returns product in OutH:OutL
    clrf    OutH            ; clear all non-input variables
    clrf    OutL
mult_loop
    bcf     STATUS,c        ; clear carry bit
    movfw   Num2
    addwf   OutL            ; add Num2 to OutL
    btfsc   STATUS,c        ; check carry bit
    incf    OutH            ; if set, increment OutH
    decfsz  Num1            ; decrement Num1
    goto    mult_loop       ; if Num1 is not zero, repeat loop
    return                  ; else return 
```

我觉得这虽然在代码行方面很短，但对于较大的数字可能需要相对较长的时间来执行。我自己做了一些思考，开始沿着一条路线将一个数字向右移动，另一个向左移动，并在此过程中将左移的数字添加到输出中一定次数以到达最终答案。我做得不太对，但后来在 SO 上偶然发现了[这个问题](https://stackoverflow.com/questions/2776211/how-can-i-multiply-and-divide-with-only-using-bit-shifting-and-adding?answertab=votes#tab-top "如何仅使用位移和加法进行乘法和除法？")，这让我想到了将输入数字之一表示为：

N = a_0 + a_1*2 + a_2*2^2 + a_3*2^3 + ... + a_7*2^7

从那个出发点，我想出了这种方法，将两个 8 位数字相乘以获得 16 位输出（存储在两个 8 位寄存器中）。

```
multiply_numbers:
; Takes numbers in Num1 and Num2L, and returns product in OutH:OutL
    clrf    Num2H           ; clear all non-input variables
    clrf    OutL
    clrf    OutH
mult_loop
    btfsc   Num1,0          ; test LSB of Num1
    call    add_num16       ; if set, add Num2H:Num2L to OutH:OutL
    call    shift_left      ; shift Num2H:Num2L left (multiply by 2)
    rrf     Num1,f          ; shift Num1 right
    clrw                    ; clear working register (0x00)
    bcf     STATUS,z        ; clear zero bit (3) of the STATUS register
    addwf   Num1,w          ; add 0x00 to Num1
    btfss   STATUS,z        ; if Num1 is zero, then exit loop
    goto    mult_loop       ; else, continue with another iteration
    return
add_num16
    movfw   Num2H
    addwf   OutH,f          ; add Num2H to OutH
    bcf     STATUS,c        ; clear carry bit (0) of the STATUS register
    movfw   Num2L
    addwf   OutL,f          ; add Num2L to OutL
    btfsc   STATUS,c        ; check carry bit
    incf    OutH,f          ; increment OutH if set (OutL overflowed)
    return
shift_left
    bcf     STATUS,c        ; clear carry bit
    rlf     Num2L,f         ; rotate Num2L left (carry -> LSB, MSB -> carry)
    rlf     Num2H,f         ; rotate Num2H left, using carry bit from Num2L
    return 
```

我认为第二个示例在大多数情况下更快，仅仅是因为循环最多只能重复 8 次，而不是最多 256 次。

我对它们的相对速度/效率的假设是否正确？第二个代码块是否真的按照我的意图运行（是否有任何我错过的潜在问题）？最后，是否可以使用尚未采用的技术进一步优化这种乘法？

先感谢您。

*PS 所有变量/寄存器都已正确定义了它们自己的地址。大量的代码注释是因为我们正在尝试编译一组例程，我们可以在将来引用这些例程，并且仍然一眼就知道发生了什么以及为什么。*

*PPS 这个问题与编程这张照片的个人/爱好兴趣有关，与任何当前的课程作业等无关。只是为了减轻你可能有的任何怀疑！*

* * *

微控制器：PIC16F84A
开发环境：MPLABX IDE v1.10
编译器：mpasm (v5.43)

* * *

## 编辑＃1：

*   不是测试 Num1 的 LSB 并将左移的 Num2H:Num2L 添加到 OutH:OutL，而是测试 Num1 的 MSB 并将 Num2 添加到左移的 OutH:OutL。
*   使 'shift_left' 内联而不是调用的子函数。
*   展开“mult_loop”以优化第 8 次迭代。

方法2改进：

```
multiply_numbers:
; Takes numbers in Num1 and Num2, and returns product in OutH:OutL
    clrf    OutL            ; clear all non-input variables
    clrf    OutH
; 1st iteration
    btfsc   Num1,7          ; test MSB of Num1
    call    add_num8        ; if set, add Num2 to OutH:OutL
    bcf     STATUS,c        ; clear carry bit
    rlf     OutL,f          ; rotate OutL left (carry -> LSB, MSB -> carry)
    rlf     OutH,f          ; rotate OutH left, using carry bit from OutL
    rlf     Num1,f          ; shift Num1 left
; 2nd iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 3rd iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 4th iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 5th iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 6th iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 7th iteration
    btfsc   Num1,7
    call    add_num8
    bcf     STATUS,c
    rlf     OutL,f
    rlf     OutH,f
    rlf     Num1,f
; 8th iteration
    btfss   Num1,7          ; test MSB of Num1
    return                  ; if not set, then return. else...
add_num8
    bcf     STATUS,c        ; clear carry bit (0) of the STATUS register
    movfw   Num2
    addwf   OutL,f          ; add Num2L to OutL
    btfsc   STATUS,c        ; check carry bit
    incf    OutH,f          ; increment OutH if set (OutL overflowed)
    return 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T01:37:53.657

是的，但你可能会做得更好。有很多经典的“技巧”可以做到这一点。

首先，知道乘数可以解释为 2 的幂的和，当被乘数位非零时，您可以巧妙地将被乘数加到乘数上。

其次，增加的价值只是被乘数的大小。虽然您需要 16（部分和）最终产品，但您不必进行 16 位添加；您可以进行 8 位加法并传播任何进位。这通常在汇编程序中很容易做到。

为了节省时间，您不想在循环中间调用和添加例程。内联代码以节省调用、返回和优化任何寄存器改组所花费的时间。最后，你只循环了 8 次；值得将这样的循环展开 8 次以避免计数器的开销，并降低因不得不摆弄计数器而导致的“注册压力”，从而为您提供更多优化的自由。

请注意，我对 PIC 控制器只字未提，实际上我不知道它的指令集。但我所说的与任何实现 8 位乘法的人有关。（有 16、32 和 64 位乘法的等效技巧）。所以就可以抽象的写出如下代码：

```
 mul16: // computes M1 * M2 --> P where M1 and M2 are 8 bit values, P is 16 bits
        // P is represent by Plow and Phigh 8 bit values.
        // reset the (partial) product
        Plow=0; Phigh=0; // all 16 bits 
       // First iteration:          
       if msb(M1)==1 then { Plow+=M2; if carry then Phigh++; /* propagate carry */ }
       shift M1 left bit;
       shift (Phigh,Plow) left one bit
       // Second iteration
            <same as first>
       <3rd ..7th iteration, same as first>
       // 8th iteration
        if msb(M1)==1 then { Plow+=M2; if carry then Phigh++ }
       // dont bother: shift M1 left bit;
       // dont bother: shift (Phigh,Plow) left one bit   
       <done> 
```

您可能会巧妙地注意到，“如果 msb(M1)...”和“将 M1 左移一位”通常很容易用汇编语言“左移”指令实现，或者在绝望中为自身添加一个值： -} 类似地，“if carry ... add one”通常用“add carry”指令实现。

我留给你为 PIC 重新编码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T02:27:26.280

天啊。我已经有 30 年没有用汇编程序编写乘法代码了。这让人回想起在 6502 汇编器中为 Apple II 编写代码的日子。

你是绝对正确的，第二种方法要快得多。8 次加法和 8 次移动比多达 256 次加法快得多。

但是，我认为你有它落后。

您想从 num1 的 MSB 开始，如果该位为 1，则将 num2 添加到结果中。在除 num1 的 LSB 之外的每一位之后，将结果左移 1。

# objective-c - 防止自定义工作表抢焦点

> ID：10678592
> 
> 赞同：1
> 
> 时间：2012-05-21T01:23:16.503
> 
> 标签：objective-c, cocoa, cocoa-sheet

我正在使用 Cocoa 编写一个多文档应用程序。用户在打开文档时必须输入密码。在文档上没有任何活动的一段时间后，用户再次需要输入密码。

现在我正在使用`NSAplication`'s`beginSheet:modalForWindow:modalDelegate:didEndSelector:contextInfo:`在自定义工作表中显示密码提示。虽然它有效，但不幸的是，即使当时正在处理另一个文档，窗口也会被带到前面并获得焦点。仅当我的应用程序在前面时才有问题。

如果父窗口不活动，有没有办法防止打开工作表抢夺焦点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:30:50.840

没有简单的方法。hacky 方法是为文档窗口*和*工作表窗口创建一个 NSWindow 的子类，并在该类中覆盖 orderFront: 和 makeKeyWindow，在调用 beginSheet 期间不执行任何操作。例如，

在 NSWindow 子类中：

```
-(void)awakeFromNib
{
    hack = NO;
}

-(void)hackOnHackOff:(BOOL)foo
{
    hack = foo;
}

- (void)orderFront:(id)sender
{
    if (!hack)
        [super orderFront:sender];
}

- (void)makeKeyWindow
{
    if (!hack)
        [super makeKeyWindow];
} 
```

然后您的 beginSheet 调用将如下所示：

```
-(void)sheet
{
    SpecialSheetWindow* documentWindow = [self windowForSheet];
    [documentWindow hackOnHackOff:YES];
    [sheetWindow hackOnHackOff:YES];
    [[NSApplication sharedApplication] beginSheet:sheetWindow
                       modalForWindow:documentWindow 
                       modalDelegate:self  didEndSelector:@selector(sheetDidEnd:returnCode:contextInfo:) contextInfo:nil];
    [documentWindow hackOnHackOff:NO];
    [sheetWindow hackOnHackOff:NO];
} 
```

# javascript - 显示动态增长的列表

> ID：10678594
> 
> 赞同：1
> 
> 时间：2012-05-21T01:23:31.500
> 
> 标签：javascript, jquery, css

**UPDATE1：更新了 JS fiddle 链接抱歉设置间隔没有按我想要的那样工作**

我有一个动态增长的数组（每 1 秒添加一次）。我必须拆分此列表并将其显示在列中，**实际上我在显示 ul 和 li 中的列表时遇到问题（是的，只有 ul 和 li 没有表）**。用户可以指定最大列数（一旦有这么多就停止添加列）和最小列高（没有添加的列可能包含少于这么多项目）。此外，任何添加的列中的项目数必须与前一列相同或少 1。最大列 =3 和最小列高 =3 的输出

![在此处输入图像描述](../Images/321ced1f5187ced340b9a6dd2c80d1c5.png)

到目前为止我能做的是：

1.  使用设置间隔每 1 秒添加一次数字

2.  将传入的数字放入数组中，例如`[1] , [1,2] ... [1,2,3,4]`4 秒后。这个数组称为**范围**

3.  将主数组（范围）拆分为子数组（**new_range**），例如，如果主数组

    (范围) = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    new_range（第一个循环后）= [1, 2, 3, 4]

    new_range（第二次循环后）= [5, 6, 7]

    new_range（第三次循环后）= [8, 9, 10]

4.  所以现在我需要使用 ul 和 li 垂直显示每个新范围，所以我尝试做类似`$('ul').append('<li>' + new_range[j] + '</li>');`j 是 new_range 数组索引的事情

**我在显示 li 项目时遇到问题，就像使用 CSS 的示例输出一样，如果有人能告诉我如何在每次迭代后显示 li 项目，那就太好了**

[**JS小提琴链接**](http://jsfiddle.net/C2G9B/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:20:01.907

我发现你的小提琴太混乱了，所以我从头开始。

以下函数接受一个值数组 、`data`最大列数`cols`和每列的最大大小`size`。如果`data`有多个`cols * size`值，则不显示剩余部分。它将列创建为单独的 ul 元素，每个元素都附加到一个假定存在 id 为“container”的容器（该函数所做的第一件事就是清空该容器）。

```
function createList(data, cols, size){
    var $ul,
        $container = $("#container").empty();

    $.each(data, function(i,v){
        if (i >= cols * size)
            return false;
        if (i%size === 0)
            $ul = $("<ul/>").appendTo($container);

        $ul.append($("<li/>").html(v));
    });
} 
```

ul 元素可以用这个 CSS 并排显示（即，作为列）：

```
ul { float : left; } 
```

使用以下方法向数组添加值的工作演示：http `setInterval()`: [//jsfiddle.net/VXAHy/1/](http://jsfiddle.net/VXAHy/1/)

我没有`setInterval()`在我的答案中显示任何或数组填充代码，因为这都是无关紧要的：上面的函数总是根据传入的数组重绘所有列。（我确实在我的演示小提琴中显示了间隔的东西.)

# ruby-on-rails - 错误：在创建方法中呈现新动作

> ID：10678595
> 
> 赞同：0
> 
> 时间：2012-05-21T01:23:55.627
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的应用程序有两个关联模型：杂志和文章：

```
class Magazine < ActiveRecord::Base
  has_one :article
end

class Article < ActiveRecord::Base
  belongs_to :magazine
  validation_presence_of :title
end 
```

从杂志展示页面我可以创建一个新文章，所以我的 routes.rb 配置如下：

```
resources :magazines, :shallow => true do
  resources :articles
end 
```

在杂志展示页面中，我有“新文章”链接，例如：

```
<%= link_to 'New article', new_magazine_article_path(@article) 
```

以及将正确参数传递给 form_for 的文章助手：

```
module ArticlesHelper
  def form_for_params
    if action_name == 'edit'
      [@article]
    elsif action_name == 'new'
      [@magazine, @article]
    end
  end
end 
```

所以我可以使用 Article form_for 之类的：

```
<%= simple_form_for(form_for_params) do |f| %> ... 
```

用于 new 和 create 的 ArticlesController 方法是：

```
respond_to :html, :xml, :js

def new
  @magazine = Magazine.find(params[:magazine_id])
  @article = Article.new
end

def create
  @magazine = Magazine.find(params[:magazine_id])
  @article = @magazine.build_article(params[:article])        
  if @article.save
    respond_with @magazine # redirect to Magazine show page
  else
    flash[:notice] = "Warning! Correct the title field."
    render :action => :new
  end
end 
```

当 title 属性存在验证错误并呈现操作 new 时，会出现此问题。此刻我收到消息：form_for 第一行中**NilClass:Class 的未定义方法“model_name” 。**我认为这是因为**@magazine**参数在帮助程序中传递。

如果不使用 redirect_to 我怎么能解决这个问题？（我想保留表单中填写的其他属性。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:31:12.633

您的`form_for_params`方法正在返回`nil`，因为`action_name`设置为“创建”，而不是“新”或“编辑”。

试试这个：

```
elseif action_name == 'new' or action_name == 'create'
  [@magazine, @article] 
```

# javascript - 如何在 JS 函数中添加弹跳效果

> ID：10678598
> 
> 赞同：0
> 
> 时间：2012-05-21T01:24:44.327
> 
> 标签：javascript

我如何为这个滑入功能添加“弹跳”效果；

```
$(window).load(function(){

$('.show').hover(function() {
$('.tool_hover').animate({
    'left':'190px'},
                        'slow');
},function() {
$('.tool_hover').animate({
    'left':'3000px'},
                        'slow');
});

}); 
```

因此，当“tool_hover”完成滑入 190 像素时，它会从左到右弹跳，然后完全停止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:28:16.230

添加 jQuery 缓动插件：

[http://gsgd.co.uk/sandbox/jquery/easing/](http://gsgd.co.uk/sandbox/jquery/easing/)

然后将“easeInOutBack”添加到您的动画语法中。它看起来像这样：

```
$('.show').hover(function() {
    $('.tool_hover').animate({'left':'190px'}, {left:'easeOutBack'}, 'slow');
},function() {
    $('.tool_hover')$('.tool_hover').animate({'left':'3000px'}, {left:'easeOutBack'}, 'slow');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T01:33:14.953

jQuery UI 有弹跳效果。

[UI/效果/反弹](http://docs.jquery.com/UI/Effects/Bounce)

# java - 整数数组中出现次数的峰值

> ID：10678600
> 
> 赞同：2
> 
> 时间：2012-05-21T01:25:06.707
> 
> 标签：java, performance, algorithm, histogram

在Java中，我需要一个算法来找到最大值。整数集合中出现的次数。例如，如果我的集合是`[2,4,3,2,2,1,4,2,2]`，则算法需要输出 5，因为 2 是出现次数最多的整数，它出现了 5 次。把它想象成找到一组整数的直方图的峰值。

挑战是，我必须对多组许多整数一一进行，因此它需要高效。另外，我不知道哪个元素将主要出现在集合中。这是完全随机的。

我考虑过将集合的这些值放入一个数组中，对其进行排序，然后遍历数组，计算数字的连续出现并确定计数的最大值，但我猜这将花费大量时间。是否有任何库或算法可以帮助我有效地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:40:28.490

我将使用以下逻辑循环插入到 Map 数据结构中的集合：

*   如果整数尚未插入映射，则插入 key=integer, value=1。
*   如果键存在，则增加值。

您可以使用 Java 中的两个 Map - HashMap 和 TreeMap - 它们在下面进行比较：

**HashMap 与 TreeMap**

如果您愿意，您可以跳过详细说明直接跳转到摘要。

HashMap 是一种将键值对存储在数组中的 Map。用于键 k 的索引是：

*   h.hashCode() % map.size()

有时，两个完全不同的键最终会出现在同一个索引处。为了解决这个问题，数组中的每个位置实际上都是一个链表，这意味着每次查找都必须遍历链表并使用 k.equals(other) 方法检查是否相等。最坏的情况是，所有的键都存储在同一个位置，HashMap 变成了一个未索引的列表。

随着 HashMap 获得更多条目，这些冲突的可能性增加，并且结构的效率降低。为了解决这个问题，当条目数达到临界点（由构造函数中的 loadFactor 参数确定）时，会调整结构的大小：

*   分配一个新数组，大约是当前大小的两倍
*   在所有现有键上运行一个循环
    *   为新数组重新计算密钥的位置
    *   键值对插入到新结构中

如您所见，如果有很多调整大小，这可能会变得相对昂贵。

如果您可以在开始之前以适当的大小预先分配 HashMap，则可以克服此问题，例如 map = new HashMap(input.size()*1.5)。对于大型数据集，这可以显着减少内存流失。

因为键在 HashMap 中基本上是随机定位的，所以键迭代器将以随机顺序遍历它们。Java 确实提供了 LinkedHashMap，它将按照插入键的顺序进行迭代。

HashMap 的性能：

*   给定正确的大小和良好的散列分布，查找是恒定时间的。
*   如果分布不好，性能下降到（在最坏的情况下）线性搜索 - O(n)。
*   如果初始大小不好，性能就会变成重新散列的性能。我不能简单地计算这个，但这并不好。

OTOH TreeMap 将条目存储在平衡树中 - 一种动态结构，随着键值对的添加而逐渐建立。插入取决于树的深度 (log(tree.size())，但可以预测 - 与 HashMap 不同，没有中断，也没有性能下降的边缘条件。

给定分布良好的 HashMap，每次插入和查找的成本都更高。

此外，为了在树中插入键，每个键都必须与其他所有键可比较，这需要 Comparable 接口中的 k.compare(other) 方法。显然，鉴于问题是关于整数的，这不是问题。

TreeMap 的性能：

*   插入 n 个元素是 O(n log n)
*   查找是 O(log n)

**概括**

第一个想法：数据集大小：

*   如果很小（即使在 1000 和 10,000 中），在任何现代硬件上都无关紧要
*   如果大到导致机器内存不足的地步，那么 TreeMap 可能是唯一的选择
*   否则，大小可能不是决定因素

在这种特定情况下，一个关键因素是与整体数据集大小相比，唯一整数的预期数量是大还是小？

*   如果很小，那么整体时间将由**小集合**中的**键查找**主导，因此优化无关紧要（您可以在这里停止）。
***   如果很大，那么总时间将由**insert**控制，并且决定取决于更多因素：
    *   数据集大小已知？
        *   如果是：可以预先分配 HashMap，从而消除内存流失。如果 hashCode() 方法很昂贵（在我们的例子中不是），这一点尤其重要
        *   如果否：TreeMap 提供更可预测的性能，可能是更好的选择
    *   是否需要无需大停顿的可预测性能，例如在实时系统中或在 GUI 的事件线程上？
        *   如果是：TreeMap 提供了更好的可预测性，没有停顿
        *   如果否：HashMap 可能为整个计算提供更好的整体性能**

 **最后一点，如果上面没有压倒性的一点：

*   是一个排序的值键列表吗？
    *   如果是（例如打印直方图）：TreeMap 已经对键进行了排序，因此很*方便*

但是，如果性能很重要，那么唯一的决定方法是实现 Map 接口，然后**分析**HashMap 和 TreeMap 以查看在您的情况下哪个实际上更好。[过早的优化](http://en.wikipedia.org/wiki/Program_optimization#When_to_optimize)是万恶之源 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T01:37:35.857

排序有什么问题？那是*O(n log n)*，一点也不差。任何更好的解决方案要么需要有关输入集的更多信息（可能是所涉及数字的上限），要么涉及 a`Map<Integer, Integer>`或等效的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T01:38:02.497

1.  基本方法是对集合进行排序，然后简单地运行排序后的集合。（这将在 O(nLog(n) + n) 中完成，即 O(nLog(n))）。

2.  如果数字是有界的（例如，-10000,10000）并且集合包含很多整数，您可以使用查找表并计算每个元素。这将花费 O(n + l)（O(n) 进行计数，O(l) 找到最大元素）其中 l 是范围长度（在这种情况下为 20001）。正如你所看到的，如果 n >> l 那么这将变成 O(n) ，它比 1 更好，但是如果 n << l 那么它是 O(l) ，它是恒定的，但足够大以至于无法使用。

3.  前面的另一个变体是使用 HashTable 而不是查找表。这会将复杂度提高到 O(n)，但不能保证在 n>>l 时比 2 快。好消息是这些值不必有界。

我不是一个java，但如果你需要帮助编码这些，让我知道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T04:39:54.240

由于它是整数的集合，因此可以使用

1.  基数排序对集合进行排序，它采用 O(nb) 其中 b 是用于表示整数的位数（32 或 64，如果您使用 java 的原始整数数据类型），或者
2.  基于比较的排序（快速排序、合并排序等），需要 O(n log n)。

笔记：

*   n 越大，基数排序就越有可能比基于比较的排序更快。对于较小的 n，您可能最好使用基于比较的排序。
*   如果您知道集合中值的界限，则 b 将甚至小于 32（或 64），从而使基数排序更可取。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T04:03:39.980

这是您的程序的示例实现。它返回频率最高的否，如果找到两个出现次数最多的否，则返回较大的否。如果您想返回频率，请将代码的最后一行更改为“返回 mf”。

```
{public int mode(int[]a,int n)
   {int i,j,f,mf=0,mv=a[0];
    for(i=0;i<n;i++)
       {f=0;
        for(j=0;j<n;j++)
           {if(a[i]==a[j])
               {f++;
               }
           }
        if(f>mf||f==mf && a[i]>mv)
           {mf=f;
            mv=a[i];
           }
       }
    return mv;        
   } 
```

}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-21T04:12:05.433

这只小狗工作（编辑返回频率而不是数字）：

```
public static int mostFrequent(int[] numbers) {
    Map<Integer, AtomicInteger> map = new HashMap<Integer, AtomicInteger>() {
        public AtomicInteger get(Object key) {
            AtomicInteger value = super.get(key);
            if (value == null) {
                value = new AtomicInteger();
                super.put((Integer) key, value);
            }
            return value;
        }

    };

    for (int number : numbers)
        map.get(number).incrementAndGet();

    List<Entry<Integer, AtomicInteger>> entries = new ArrayList<Map.Entry<Integer, AtomicInteger>>(map.entrySet());
    Collections.sort(entries, new Comparator<Entry<Integer, AtomicInteger>>() {
        @Override
        public int compare(Entry<Integer, AtomicInteger> o1, Entry<Integer, AtomicInteger> o2) {
            return o2.getValue().get() - o1.getValue().get();
        }
    });

    return entries.get(0).getValue().get(); // return the largest *frequency*

    // Use this next line instead to return the most frequent *number*
    // return entries.get(0).getKey(); 
} 
```

选择 AtomicInteger 是为了避免在每次增量时创建新对象，并且代码读起来更简洁。

匿名地图类用于集中“if null”代码

这是一个测试：

```
public static void main(String[] args) {
    System.out.println(mostFrequent(new int[] { 2, 4, 3, 2, 2, 1, 4, 2, 2 }));
} 
```

输出：

```
5 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-29T12:29:38.603

**使用哈希映射：**

```
 import java.util.HashMap;
public class NumberCounter {

   static    HashMap<Integer,Integer> map;
   static int[] arr = {1, 2, 1, 23, 4, 5, 4, 1, 2, 3, 12, 23};
   static int max=0;

   public NumberCounter(){

         map=new HashMap<Integer, Integer>();

    }

    public static void main (String[] args)
    {
        Integer newValue=1;
        NumberCounter c=new NumberCounter();

        for(int i=0;i<arr.length;i++){
            if(map.get(arr[i])!=null) {
                newValue = map.get(arr[i]);
                newValue += 1;
                map.put(arr[i], newValue);
            }
            else
                map.put(arr[i],1);

        }

        max=map.get(arr[0]);
        for(int i=0;i<map.size();i++){
         if(max<map.get(arr[i]))
             max=map.get(arr[i]);
        }
        System.out.print(max);

    }

} 
```**

# jquery - getJSON 返回“未定义”值

> ID：10678601
> 
> 赞同：2
> 
> 时间：2012-05-21T01:26:08.120
> 
> 标签：jquery, json, api

我正在尝试学习如何使用 JSON 进行 API 调用，但我得到了“未定义”的结果。该 API 用于发票网络应用程序 ( [www.curdbee.com](http://www.curdbee.com) )，我希望结果是每个客户名称的列表。现在，我得到一个列表，但每个结果都是“未定义的”。到目前为止，这是我的 jQuery 代码：

```
$(function () {
    $.getJSON('https://nspirelab.curdbee.com/clients.json?api_token=', function (data) {
        $.each(data, function (index, item) {
            $('#results').append('<div class="invoice">' + item.name + '</div>');
        });
    });
}); 
```

此外，在实际脚本中，我的 api 令牌也包含在内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:49:01.997

根据 的 API 文档[`/clients`](http://curdbee.com/api/clients/)，您缺少属性查找 -`client`的`item.client.name`.

```
$(function () {
    $.getJSON('https://nspirelab.curdbee.com/clients.json?api_token=', function (data) {
        $.each(data, function (index, item) {
            $('#results').append('<div class="invoice">' + item.client.name + '</div>');
        });
    });
}); 
```

这是检索内部对象的值所必需的：

```
[                                  // == data
    {                                  // == item
        "client": {                        // == item.client
            "id": 6364,                        // == item.client.id
            "name": "7Seven7 Insurance Inc",   // == item.client.name
            ...
        }
    },
    ...
] 
```

# ruby-on-rails - 使用 WireShark 捕获 Rails API 请求/响应

> ID：10678602
> 
> 赞同：1
> 
> 时间：2012-05-21T01:26:09.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, http, request, wireshark

我正在使用 HTTMultiParty 处理 API，并且在进行 POST 时无法捕获传出的 HTTP 请求。我在wireshark中根本看不到它们。我正在无线适配器上捕获（我没有其他互联网连接）并过滤

> http.host 包含“docusign”

但我看不到任何东西。即使只有一个 HTTP 过滤器，当我看到请求和响应时，我也看不到任何新的捕获。为什么wireshark 无法查看我的rails 应用程序的流量？注意：我可以看到我的浏览器向 rails 应用程序发出的请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T19:08:08.833

由于它是 https 流量，假设您知道正在与之通信的服务器的 IP 地址，请使用过滤器`ip.addr == x.x.x.x`，您应该会看到离开客户端的 TLS 流量。

我在上述评论中假设您的意思是“ip.dst”，因为据我所知，没有“tcp.dest”之类的东西。

有点旧，但[这里有一个完整的过滤器列表](http://packetlife.net/media/library/13/Wireshark_Display_Filters.pdf)。

# jquery - jQTouch Tabbar在点击时滑开

> ID：10678603
> 
> 赞同：1
> 
> 时间：2012-05-21T01:26:24.967
> 
> 标签：jquery, jqtouch

我正在使用 jQTouch beta 4（最新来自[http://www.jqtouch.com/](http://www.jqtouch.com/)）和来自 DataZombies（https://github.com/DataZombies/jQTouch）的 jqt.bars 扩展。它似乎运行良好，除了当我单击选项卡栏中的一个项目时，选项卡栏本身滑开（向左）。恢复它的唯一方法是刷新页面。它也确实导航到正确的页面，顺便说一句。

有没有人遇到过同样的问题，或者有没有人知道如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T05:28:17.533

啊...通过拖网代码弄清楚了。我需要添加`class="keep_tabbar"`到我的每个页面`<div/>`元素。

# c++ - 在 C++ 中跨文件行并行化函数的惯用方法

> ID：10678605
> 
> 赞同：6
> 
> 时间：2012-05-21T01:26:32.177
> 
> 标签：c++, multithreading, openmp

我发现自己经常编写以下形式的 C++ 代码：

```
while (getline(strm, line)) {
    cout << computationally_intensive_function(line) << endl;
} 
```

我想并行化这段代码。到目前为止，我提出的最佳解决方案是构建字符串向量以容纳大量（10000-100000）行，然后在该向量上并行化

```
#pragma omp parallel for 
```

然后清空向量并在剩余线条时重复。但是，这种方法需要大量内存，并且在主进程正在缓冲字符串时，其他内核处于空闲状态。有没有更好的办法？像 Python`multiprocessing.Pool.map`或 Hadoop 之类的东西？（不过，我想避免使用 Hadoop 的 C++ API，因为 Hadoop 相当重量级，可能不会安装在我的代码运行的任何地方。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T05:49:39.743

**OpenMP 3.0 tasks**存在一个不为人知的功能，这是非常不幸的，因为它们是专门为涵盖此类情况而创建的。如果您的编译器支持该标准版本，那么您绝对应该使用 OpenMP 任务。但请记住，从多个线程写入`stdout`（或`std::cout`）通常会严重混合它们的输出，您很可能希望对其进行同步：

```
#pragma omp parallel
{
    #pragma omp master
    while (getline(strm, line))
    #pragma omp task
    {
        result_type result = computationally_intensive_function(line);
        #pragma omp critical
        {
            cout << result << endl;
            cout.flush();
        }
    }
    #pragma omp taskwait
} 
```

我让你来决定应该是什么变量`shared`以及应该是什么`private`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T10:47:27.243

您应该将计算与从文件中读取行重叠。一种好方法是使用 Threading Building Blocks 管道算法。您所做的是指定三个（基于您在伪代码示例中显示的内容）过滤器，两个串行一个和一个并行。串行过滤器是输入和输出过滤器。第一个从文件中逐行读取数据并将每一行传递给第二个过滤器，该过滤器是并行的，并以多线程模式运行您的计算/处理功能。最后一级/过滤器也是串行的，它确实输出。我正在复制粘贴 TBB 教程中的示例，这似乎正是您想要实现的目标：

```
// Holds a slice of text.
/** Instances *must* be allocated/freed using methods herein, because the
C++ declaration
represents only the header of a much larger object in memory. */
class TextSlice {
    // Pointer to one past last character in sequence
    char* logical_end;
    // Pointer to one past last available byte in sequence.
    char* physical_end;
public:
    // Allocate a TextSlice object that can hold up to max_size characters.
    static TextSlice* allocate( size_t max_size ) {
        // +1 leaves room for a terminating null character.
        TextSlice* t = (TextSlice*)tbb::tbb_allocator<char>().allocate(sizeof(TextSlice)+max_size+1 );
        t->logical_end = t->begin();
        t->physical_end = t->begin()+max_size;
        return t;
    }
    // Free this TextSlice object
    void free() {
        tbb::tbb_allocator<char>().deallocate((char*)this,
        sizeof(TextSlice)+(physical_end-begin())+1);
    }
    // Pointer to beginning of sequence
    char* begin() {return (char*)(this+1);}
    // Pointer to one past last character in sequence
    char* end() {return logical_end;}
    // Length of sequence
    size_t size() const {return logical_end-(char*)(this+1);}
    // Maximum number of characters that can be appended to sequence
    size_t avail() const {return physical_end-logical_end;}
    // Append sequence [first,last) to this sequence.
    void append( char* first, char* last ) {
        memcpy( logical_end, first, last-first );
        logical_end += last-first;
    }
    // Set end() to given value.
    void set_end( char* p ) {logical_end=p;}
}; 
```

让它运行的功能是：

```
void RunPipeline( int ntoken, FILE* input_file, FILE* output_file ) {
    tbb::parallel_pipeline(
    ntoken,
    tbb::make_filter<void,TextSlice*>(
    tbb::filter::serial_in_order, MyInputFunc(input_file) )
    &
    tbb::make_filter<TextSlice*,TextSlice*>(
    tbb::filter::parallel, MyTransformFunc() )
    &
    tbb::make_filter<TextSlice*,void>(
    tbb::filter::serial_in_order, MyOutputFunc(output_file) ) );
} 
```

# c - 可以通过调用函数来初始化静态变量

> ID：10678607
> 
> 赞同：5
> 
> 时间：2012-05-21T01:27:03.580
> 
> 标签：c

这可能吗？

```
static bool initialize()
{
  TRC_SCOPE_INIT(...); 
  ...
}

static bool initialized = initialize(); 
```

长话短说，我需要尽早调用一系列宏（初始化调试消息）（在线程 X 启动之前，我无法知道线程 X 何时启动）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T01:39:02.080

当我最初查看这个问题时，它被标记为 C 和 C++。代码可以是 C 或 C++，因为`bool`它是 C99 和 C11 中的一种类型，就像在 C++ 中一样（几乎；在 C 中，您需要`<stdbool.h>`标头来获取名称`bool`）。

两个标签的答案是：

*   在 C++ 中，是的。

*   在 C 中，没有。

它们不是同一种语言。如果您需要演示，这是一个很好的例子。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T01:50:31.977

如果您使用的是 GCC（或 clang），您可以使用`__attribute__((constructor))`：

```
static bool initialized = false;

__attribute__((constructor))
static void initialize(void) {
    initialized = true;
    // do some other initialization
}

int main(int argc, char **argv) {
    // initialize will have been run before main started
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T01:42:36.943

如果您正在初始化的“东西”与初始化它的函数的调用在同一个翻译单元中定义，这应该没问题。此外，它必须在调用站点之上定义。否则，由于使用未初始化的值，您将面临未定义行为的风险。

解决此问题的一种方法是改用指针。静态初始化的指针被编译到可执行映像中，因此如果它被其他翻译单元中定义的静态变量使用，则不会出现未定义行为的风险。在您的静态初始化函数中，您动态分配“东西”并将指针设置为指向它，以便您以后可以访问它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-21T03:44:16.760

（由于您提到了线程，我假设您可以使用 POSIX 线程函数。）

该`pthread_once`功能的存在正是为了这个目的。任何你需要确定`initialize`已经被调用的地方，写下：

```
pthread_once(&init_once, initialize); 
```

where`init_once`用静态存储持续时间定义，如果需要，还可以用外部链接定义，如`pthread_once_t init_once`.

# sql - Where 子句影响 Count() 但不影响返回的结果数

> ID：10678609
> 
> 赞同：0
> 
> 时间：2012-05-21T01:27:12.223
> 
> 标签：sql, sql-server

假设我有两张桌子：

成员

```
------------------------
| user_id | first_name |
------------------------ 
```

留言

```
--------------------------------------------------
| sender_id | recipient_id | message_type | body |
-------------------------------------------------- 
```

我想创建一个返回的查询：

```
---------------------------------------------
| user_id | first_name | number_of_messages |
--------------------------------------------- 
```

`number_of_messages`应该只计算某种类型的消息，`message_type = 0`但是我仍然想在结果集中包含没有发送任何该类型消息的成员。

这是我目前所拥有的：

```
SELECT [user_id], [first_name], COUNT(sender_id) as number_of_messages
FROM [Member]
    FULL OUTER JOIN [Message] ON user_id = sender_id
where message_type = 0
GROUP BY [Member].[user_id], [first_name]
ORDER BY number_of_messages DESC 
```

此查询的问题是任何未发送类型 0 消息的成员都不会包含在结果集中。所以我有点想使用该`message_type = 0`子句来减少`number_of_messages`，但是我不希望它影响返回的结果数量。

如果您看到我可以对我的查询进行任何其他优化，也请随时发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:32:45.860

使用外连接：

```
 SELECT [user_id], [first_name], COUNT(m.sender_id) as number_of_messages
     FROM [Member]
LEFT JOIN [Message] m ON user_id = m.sender_id
                     AND m.message_type = 0
 GROUP BY [Member].[user_id], [first_name]
 ORDER BY number_of_messages DESC 
```

请注意，我的查询`message_type`在 JOIN 条件中包含过滤器——而不是在 WHERE 子句中。放置对于 OUTER 连接语法很重要——在 JOIN 子句中应用 JOIN 之前的条件。WHERE 标准在 JOIN 之后应用，并且可以给出不同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T01:46:59.420

如果您也想包含没有此类消息的成员，您只需删除 m.message_type = 0，我没有看到其他方法。选择所有人并稍后使用 IF 子句根据您的需要过滤结果。

另一种解决方案可能是您为每个类型为 0 的用户创建一个虚拟条目，并在使用它们时过滤掉这些消息。

# javascript - JavaScript 中的 UTC 时间

> ID：10678610
> 
> 赞同：9
> 
> 时间：2012-05-21T01:27:36.657
> 
> 标签：javascript

我正在尝试将当前的 UTC 日期存储在我的数据库中。我的当地时间是晚上 9 点 11 分，这相当于世界标准时间上午 1 点 11 分。当我查看我的数据库时，我注意到正在写入 1:11 pm。我很困惑。为了在 JavaScript 中获取 UTC 时间，我使用以下代码：

```
var currentDate = new Date();
var utcDate = Date.UTC(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), currentDate.getHours(), currentDate.getMinutes(), currentDate.getSeconds(), currentDate.getMilliseconds());
var result = new Date(utcDate); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:31:25.813

一点搜索结果你可以这样做：

```
var now = new Date(),
    utcDate = new Date(
        now.getUTCFullYear(),
        now.getUTCMonth(),
        now.getUTCDate(),
        now.getUTCHours(),
        now.getUTCMinutes(), 
        now.getUTCSeconds()
    ); 
```

更短：

```
var utcDate = new Date(new Date().toUTCString().substr(0, 25)); 
```

[如何将 JavaScript 日期转换为 UTC？](https://stackoverflow.com/questions/948532/how-do-you-convert-a-javascript-date-to-utc)

这是一种常用的方法，而不是创建 ISO8601 字符串，而是获取 UTC 的日期和时间。因为如果您使用字符串，那么您将无法使用 的每个本地方法`Date()`，并且有些人可能会为此使用正则表达式，这比本地方法要慢。

但是，如果您将其存储在某种数据库中，例如`localstorage`，建议使用 ISO8601 字符串，因为它还可以保存时区偏移量，但在您的情况下，每个`date`都转换为 UTC，所以时区真的无关紧要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T02:41:23.563

如果您想要本地日期对象的 UTC 时间，请使用 UTC 方法来获取它。所有 javascript 日期对象都是本地日期。

```
var date = new Date(); // date object in local timezone 
```

如果您想要UTC时间，您可以尝试实现依赖`toUTCString`方法：

```
var UTCstring = date.toUTCString(); 
```

但我不会相信这一点。如果您想要 UTC 时间的 ISO8601 字符串（大多数数据库想要），那么：

```
var isoDate = date.getUTCFullYear() + '-' +
              addZ((date.getUTCMonth()) + 1) + '-' +
              addZ(date.getUTCDate()) + 'T' +
              addZ(date.getUTCHours()) + ':' +
              addZ(date.getUTCMinutes()) + ':' +
              addZ(date.getUTCSeconds()) + 'Z'; 
```

`addZ`函数是：

```
function addZ(n) {
  return (n<10? '0' : '') + n;
} 
```

修改以适应。

### 编辑

要调整本地日期对象以显示与 UTC 相同的时间，只需添加时区偏移量：

```
function adjustToUTC(d) {
  d.setMinutes(d.getMinutes() + d.getTimezoneOffset()); 
  return d;
}

alert(adjustToUTC(new Date())); // shows UTC time but will display local offset 
```

请注意上述事项。如果您说 UTC+5hrs，那么它将提前 5 小时返回一个日期对象，但仍显示“UTC+5”

将 UTC ISO8601 字符串转换为本地日期对象的函数：

```
function fromUTCISOString(s) {
  var b = s.split(/[-T:\.Z]/i);
  var n= new Date(Date.UTC(b[0],b[1]-1,b[2],b[3],b[4],b[5]));
  return n;
}

alert(fromUTCISOString('2012-05-21T14:32:12Z'));  // local time displayed 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-28T15:12:11.043

```
var now = new Date();
var utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000); 
```

# workflow-foundation-4 - windows 工作流书签

> ID：10678615
> 
> 赞同：0
> 
> 时间：2012-05-21T01:28:30.193
> 
> 标签：workflow-foundation-4, workflow-foundation, workflow-activity

我用书签做这个工作流程

```
namespace wwwfff
{

    public sealed class CodeActivity3 : NativeActivity
    {
        public InArgument<string> EventName1

        { get; set; }

        public OutArgument<string> Data1

        { get; set; }

        protected override void Execute(NativeActivityContext context)
        {

            context.CreateBookmark(EventName1.Get(context), new BookmarkCallback(HandleEvent));
            Console.WriteLine("Pppppppppppp");
        }

        private void HandleEvent(NativeActivityContext context, Bookmark bookmark, object obj)
        {

            if (obj != null)
            {

                Data1.Set(context, obj.ToString());

            }

        }
    }
} 
```

*我写在程序中*

```
class Program
    {
        static void Main(string[] args)
        {
            WorkflowApplication wf = new WorkflowApplication(new Workflow1());
            wf.Run();
           wf.ResumeBookmark("C1", "Hello word");

        }
    } 
```

但它没有输入“ppppppp”工作流程只是开始`->CodeActivity3->writline()` 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:46:00.370

您可能需要覆盖 CodeActivity3 类中的属性

```
protected override bool CanInduceIdle { get { return true; } } 
```

# php - 如何使用 php5-fpm + nginx timeout php.ini 处理超时

> ID：10678617
> 
> 赞同：3
> 
> 时间：2012-05-21T01:28:37.247
> 
> 标签：php, timeout, fastcgi

如何在 php5-fpm + ngnix 配置中使用 PHP 处理超时？

我试图制作一个简单的脚本

```
sleep(60); 
```

php.ini

```
max_execution_time = 30 
```

fast_cgi

```
fastcgi_connect_timeout 60;
fastcgi_send_timeout 50;
fastcgi_read_timeout 50; 
```

脚本在 50 秒后停止，因为后端超时。我该怎么做才能

1.  在 php.ini 中启用 max_execution_time

2.  在脚本中启用ini_set直接将执行时间改为0

为什么 fast_cgi 可以控制一切而不是 php 本身的超时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T12:14:24.753

这基本上是这样一个事实，在 Linux 上，超时仅适用于实际的“php 工作”，而不适用于所有流函数时间，而且不是因为`sleep`这就是我从未达到限制并且 fastgci 超时总是启动的原因。相反，在 Windows 上，实际的“人类”经过的时间很重要。

来自 PHP 文档：

> set_time_limit() 函数和配置指令 max_execution_time 只影响脚本本身的执行时间。在确定脚本运行的最长时间时，不包括在脚本执行之外发生的任何活动所花费的时间，例如使用 system() 的系统调用、流操作、数据库查询等。在测量时间是真实的 Windows 上，情况并非如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T14:02:44.210

尝试在您的 PHP 代码中使用[set_time_limit 。](http://php.net/manual/en/function.set-time-limit.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-19T11:26:46.997

使用`php-cgi(php-fpm)` php.ini`max_execution_time`时不会生效，但 fpm 配置项`request_terminate_timeout`会处理脚本执行时间。

在 php-fpm.conf 中设置此项如下：

```
request_terminate_timeout = 60s 
```

# java - 使用 JDBC 的 SQL 错误

> ID：10678618
> 
> 赞同：0
> 
> 时间：2012-05-21T01:28:50.497
> 
> 标签：java, database, jsp, servlets, jdbc

我正在尝试获取将信息写入 MySQL 数据库的表单。servlet 正在连接到确认 jsp，但数据库没有记录信息。我收到以下错误消息：

```
SEVERE: java.sql.SQLException: No value specified for parameter 11
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1075)
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989)
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:984)
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:929)
at com.mysql.jdbc.PreparedStatement.checkAllParametersSet(PreparedStatement.java:2560)
at com.mysql.jdbc.PreparedStatement.fillSendPacket(PreparedStatement.java:2536)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2383)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2327)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2312)
at com.sun.gjc.spi.base.PreparedStatementWrapper.executeUpdate(PreparedStatementWrapper.java:125)
at eBooks.data.UserDB.update(UserDB.java:100)
at eBooks.controller.RegisterUserServlet.doPost(RegisterUserServlet.java:65)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)

SEVERE:     at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1075)
SEVERE:     at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989)
SEVERE:     at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:984)
SEVERE:     at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:929)
SEVERE:     at com.mysql.jdbc.PreparedStatement.checkAllParametersSet(PreparedStatement.java:2560)
SEVERE:     at com.mysql.jdbc.PreparedStatement.fillSendPacket(PreparedStatement.java:2536)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2383)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2327)
SEVERE:     at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2312)
SEVERE:     at com.sun.gjc.spi.base.PreparedStatementWrapper.executeUpdate(PreparedStatementWrapper.java:125)
SEVERE:     at eBooks.data.UserDB.update(UserDB.java:100)
SEVERE:     at eBooks.controller.RegisterUserServlet.doPost(RegisterUserServlet.java:65)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) 
```

这是我的 UserDB 类的代码：

```
package eBooks.data;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import eBooks.business.User;
import eBooks.util.DBUtil;

/**
 * @author L10
 */

public class UserDB {

    public static int insert(User user)
    {

        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;

         String query = 
                "INSERT INTO User (fName, lName, email_address, password, dataOfBirth, phone,"
                + " address, city,  state,  country,  zipcode, accountType)"
                + "VALUES (?,?,?,?,?,?,?,?,?,?,?)";

         try
         {
             ps = connection.prepareStatement(query);
             ps.setString(1, user.getfName());
             ps.setString(2, user.getlName());
             ps.setString(3, user.getEmailAddress());
             ps.setString(4, user.getPassword());
             ps.setString(5, user.getDateOfBirth());
             ps.setString(5, user.getPhone());
             ps.setString(6, user.getAddress());
             ps.setString(7, user.getCity());
             ps.setString(8, user.getCountry());
             ps.setString(9, user.getState());
             ps.setString(10, user.getZipcode());
             //ps.setString(11, user.getAccountType()); 

             return ps.executeUpdate();

         }
         catch(SQLException e)
         {
             e.printStackTrace();
             return 0;
         }
         finally
         {
             DBUtil.closePreparedStatement(ps);
             pool.freeConnection(connection);
         }

    }

    public static int update(User user)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;

        String query = "UPDATE User SET" 
                        + "fName = ?"
                        + "lName = ?"
                        + "password = ?"
                        + "dateOfBirth = ?"
                        + "phone = ?"
                        + "address = ?"
                        + "city = ?"
                        + "state_or_Region = ?"
                        + "country = ?"
                        + "zip = ?"
                        + ""
                        + "WHERE email_address= ?";   

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, user.getfName());
            ps.setString(2, user.getlName());
            ps.setString(3, user.getEmailAddress());
            ps.setString(4, user.getPassword());
            ps.setString(5, user.getDateOfBirth());
            ps.setString(5, user.getPhone());
            ps.setString(6, user.getAddress());
            ps.setString(7, user.getCity());
            ps.setString(8, user.getCountry());
            ps.setString(9, user.getState());
            ps.setString(10, user.getZipcode());
             //ps.setString(11, user.getAccountType()); 

            return ps.executeUpdate();
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return 0;
        }
        finally
        {
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }

    }

    public static int delete(User user)
    {
       ConnectionPool pool = ConnectionPool.getInstance();
       Connection connection = pool.getConnection();
       PreparedStatement ps = null;

       String query = "DELETE FROM User" +
                      "WHERE email_address = ?";
       try
       {
           ps = connection.prepareStatement(query);
           ps.setString(1, user.getEmailAddress());

           return ps.executeUpdate();

       }
       catch(SQLException e)
       {
           e.printStackTrace();
           return 0;
       }
       finally
       {
           DBUtil.closePreparedStatement(ps);
           pool.freeConnection(connection);
       }
    }

    public static boolean emailExists(String emailAddress)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;
        ResultSet rs = null;

        String query = "SELECT email_address FROM User"+
                       "WHERE email_address = ?";

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, emailAddress);
            rs = ps.executeQuery();
            return rs.next();
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return false;            
        }
        finally
        {
            DBUtil.closeResultSet(rs);
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }
    }

    public static User selectUser(String emailAddress)
    {
        ConnectionPool pool = ConnectionPool.getInstance();
        Connection connection = pool.getConnection();
        PreparedStatement ps = null;
        ResultSet rs = null;

        String query = "SELECT * FROM  User"+
                       "WHERE email_address = ?";

        try
        {
            ps = connection.prepareStatement(query);
            ps.setString(1, emailAddress);
            rs = ps.executeQuery();

            User user = null;
            if (rs.next())
            {
                user = new User();
                user.setfName(rs.getString("fName"));
                user.setlName(rs.getString("lName"));
                user.setEmailAddress(rs.getString("emailAddress"));
                user.setPassword(rs.getString("password"));
                user.setPhone(rs.getString("phone"));
                user.setDateOfBirth(rs.getString("dateOfBirth"));
                user.setAddress(rs.getString("address"));
                user.setCity(rs.getString("city"));
                user.setCountry(rs.getString("country"));
                user.setState(rs.getString("state"));
                user.setZipcode(rs.getString("zip"));
                // user.setAccountType(rs.getString("accountType")); -- Ask Jassin
            }
            return user;            
        }
        catch(SQLException e)
        {
            e.printStackTrace();
            return null;
        }
        finally
        {
            DBUtil.closeResultSet(rs);
            DBUtil.closePreparedStatement(ps);
            pool.freeConnection(connection);
        }

    }

} 
```

我需要朝着正确的方向前进，如果有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:38:23.780

基于查询

```
String query = 
            "INSERT INTO User (fName, lName, email_address, password, dataOfBirth, phone,"
            + " address, city,  state,  country,  zipcode, accountType)"
            + "VALUES (?,?,?,?,?,?,?,?,?,?,?)"; 
```

您应该改用以下查询，其中参数实际上是 12，而不是 11。

```
 String query = 
            "INSERT INTO User (fName, lName, email_address, password, dataOfBirth, phone,"
            + " address, city,  state,  country,  zipcode, accountType)"
            + "VALUES (?,?,?,?,?,?,?,?,?,?,?,?)"; 
```

而对于设置参数，

```
 ps = connection.prepareStatement(query);
         ps.setString(1, user.getfName());
         ps.setString(2, user.getlName());
         ps.setString(3, user.getEmailAddress());
         ps.setString(4, user.getPassword());
         // ps.setString(5, user.getDateOfBirth());
         // ps.setString(5, user.getPhone());
         ps.setString(5, user.getDateOfBirth());
         ps.setString(6, user.getPhone());
         ps.setString(7, user.getAddress());
         ps.setString(8, user.getCity());
         ps.setString(9, user.getState());
         ps.setString(10, user.getCountry());
         ps.setString(11, user.getZipcode());
         ps.setString(12, user.getAccountType()); 
```

对于更新查询

```
 String query = "UPDATE User SET" 
                    + "fName = ?"
                    + "lName = ?"
                    + "password = ?"
                    + "dateOfBirth = ?"
                    + "phone = ?"
                    + "address = ?"
                    + "city = ?"
                    + "state_or_Region = ?"
                    + "country = ?"
                    + "zip = ?"
                    + ""
                    + "WHERE email_address= ?"; 
```

你也缺少一个参数

```
 ps.setString(1, user.getfName());
         ps.setString(2, user.getlName());
         ps.setString(3, user.getPassword());
         ps.setString(4, user.getDateOfBirth());
         ps.setString(5, user.getPhone());
         ps.setString(6, user.getAddress());
         ps.setString(7, user.getCity());
         ps.setString(8, user.getState());
         ps.setString(9, user.getCountry());
         ps.setString(10, user.getZipcode());
         ps.setString(11, user.getEmailAddress()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T01:33:34.063

你为什么注释掉这一行

```
//ps.setString(11, user.getAccountType()); 
```

您的插入字符串有 11 个占位符参数，您只需为其输入 10 个。这会导致错误。所以重用那条线就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T01:36:35.263

```
 "INSERT INTO User (fName, lName, email_address, password, dataOfBirth, phone,"
                + " address, city,  state,  country,  zipcode, accountType)"
                + "VALUES (?,?,?,?,?,?,?,?,?,?,?)"; 
```

您缺少 accountType。您可以提供额外的吗？在值和取消注释`//ps.setString(11, user.getAccountType());`

# php - 如何在 php 中使用 openssl 以正确格式提取公钥？

> ID：10678622
> 
> 赞同：2
> 
> 时间：2012-05-21T01:29:00.993
> 
> 标签：php, openssl, ssl-certificate, public-key

我已经使用不同的方式进行了很多尝试，在 php 中使用 openssl 提取可显示格式的公钥。例如

> print_r(openssl_pkey_get_details(openssl_csr_get_public_key(\csr的路径)));

```
var_dump(openssl_get_publickey(file_get_contents('\\path to cert'))); 
```

还有很多。但我能得到的只是这样的：

-----BEGIN PUBLIC KEY----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQClNami19DpcxlYAaZNxHV27r2V gDQbkZhiayaDfcwjYStRaU8Hk1yg76gfhgayssIa6Y7Cek4uH5fV PE6Nj/s9QAkcvpzZDJasdYmj8BGyVwVbRelToMNvXTc eNaH93Dm+OA4TE9yoQIDAQAB

-----结束公钥-----

如何以下面给出的格式提取它：

95 ae 9a 4e db f1 6d 15 55 9f 86 52 28 54 21 3f 88 1b 21 81 2a 01 e3 35 dd 21 51 44 f4 18 bf 85 fb f0 6a 9a 9c 15 7f 46 83 b8 1e 05 b5d 8d f9 0b fa 45 01 f2 3b 3b bc 1b f6 a3 20 7b 96 3e f7 5d d6 c2 a7 56 29 02 94 ba 0c 29 da 51

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T04:00:26.000

浏览器列出的公钥只是模数的十六进制编码。在`openssl_pkey_get_details`this 返回的数据结构中，用 表示`n`。（如果您好奇为什么，请查看[RSA](http://en.wikipedia.org/wiki/RSA_%28algorithm%29)算法。）要在 PHP 中获取它，只需执行以下操作：

```
$pkey_details = openssl_pkey_get_details(openssl_pkey_get_public(file_get_contents("test.pem")));
echo bin2hex($pkey_details["rsa"]["n"]); 
```

# titanium - Titanium 桌面发生了什么？启动需要哪些包？

> ID：10678629
> 
> 赞同：8
> 
> 时间：2012-05-21T01:30:34.567
> 
> 标签：titanium, tidesdk

基于对网络的一些研究，我选择了 Appcelerator Titanium Desktop 来开发我的第一个跨平台应用程序。问题是[Appcelerator 停止支持它，](http://developer.appcelerator.com/blog/2012/01/the-future-of-titanium-desktop.html)而是将它作为开源发布给社区，现在你只能靠自己了。似乎有很多人在继续这个项目。我不确定是否需要下载 Titanium Studio、Titanium Developer 或 Titanium Desktop SDK。每个包裹的用途是什么，我需要哪一个？网站上的文档不够清楚。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-04T18:10:07.320

Titanium Desktop 已被接管并重命名为[TideSDK](http://tidesdk.org)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-24T02:02:00.870

好的，我想通了：

*   Titanium Developer 是管理您的项目、编译/打包它的应用程序。您在自己的文本编辑器/IDE 上编码。
*   Titanium Studio 是完整的基于 Eclipse 的 IDE。它还像 Titanium Developer 一样管理/打包您的项目，但您可以在其中使用编码提示进行编码。
*   Titanium Desktop SDK（已停产）是编写桌面应用程序所需的 SDK。
*   Titanium Mobile SDK（或 Titanium Desktop SDK 停产后的 Titanium SDK）是编写移动应用程序所需的 SDK。

我下载了 Titanium Studio，当我尝试创建一个新的桌面项目时，我发现它说桌面 SDK 丢失了。自从 Appcelerator 将其发布到社区并停止其开发以来，很难找到 Desktop SDK。[[博客文章]](http://developer.appcelerator.com/blog/2012/01/the-future-of-titanium-desktop.html)我可以找到[1.1 版本的链接](http://developer.appcelerator.com/question/129786/could-not-locate-a-titanium-desktop-sdk-at-the-given-path)。如果您想自己编译，有 1.2 RC6的[Appcelerator GitHub 存储库。](https://github.com/appcelerator/titanium_desktop)我不想编译，所以我按照[这个说明](https://wiki.appcelerator.org/display/tis/Downloading+Titanium+SDKs+in+Titanium+Studio#DownloadingTitaniumSDKsinTitaniumStudio-ManuallydownloadingTitaniumSDKsfromaURL)安装了链接。

有些人似乎将桌面 SDK 项目作为[TideSDK](http://tidesdk.org/)继续下去。他们有一个用于新开发的[GitHub 存储库](https://github.com/TideSDK/titanium_desktop)（尽管目前它似乎只是 Appcelerator 存储库的克隆，带有 1.2 RC6，没有进一步开发）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T13:24:25.577

正如他们所说，他们将从 Studio 中删除钛桌面支持，我建议您像我一样使用 Titanium Developer。我正在使用 Titanium Developer 工具进行移动和桌面开发。

# javascript - 如何重用 JSON 对象

> ID：10678632
> 
> 赞同：5
> 
> 时间：2012-05-21T01:31:47.977
> 
> 标签：javascript, jquery, json

**设想：**

MVC 网页获取包含大量数据的 JSON 对象。单击按钮后（有许多按钮），我想重用这个 JSON 对象并选择所需的 JSON 属性（不向服务器发出请求）。

它**不是 HTML5**，所以不能使用浏览器本地存储。目前，我将 JSON 对象存储在 GLOBAL 变量上并重用它。

是否有任何优雅的选项可用于在客户端存储和重用返回的 JSON 对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:19:03.840

只是缓存数据。无需将 JSON 存储在全局变量中，我相信您会在 MVC 应用程序中找到一个位置来确定局部变量的范围。您将使用回调实现数据的 getter 函数。使用缓存，它看起来像这样：

```
var getData = (function(){
    var cache;
    var loading = false;
    var callbacks = [];
    return function(callback) {
        if (typeof cache != "undefined")
            callback(cache);
        else {
            callbacks.push(callback);
            if (!loading) {
                loading = true;
                doSingleHeavyAjaxCall(options, function success(data) {
                    cache = data;
                    for (var cb; cb = callbacks.shift();)
                        cb(cache);
                });
            }
        }
     };
 })(); 
```

然后`getData(function callback(data){...})`随心所欲地使用，它只会触发一个ajax请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T01:59:49.403

Jakubs 回答的另一个选项是创建一个全局变量，您可以在页面上随意更新和检索该变量。

[全局变量附加到窗口对象](http://snook.ca/archives/javascript/global_variable)，所以只需在您的`<head>`部分中写下它。

```
<script type="text/javascript">
   window.jsonData = {};
</script> 
```

然后无论您在何处检索数据，只需更新该对象即可。

```
<script type="text/javascript">
    $.ajax(..., function(data) {
        window.jsonData = data;
    });
</script> 
```

然后，您可以在该页面上的代码中的任何位置使用它。

```
<script type="text/javascript">
    console.dir(jsonData);
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T01:37:34.797

您可以将对象存储在某些元素的 data- 属性中 - 最好是代表您的数据（表格、网格）的页面部分的容器：

```
var json = {};

$('#mygrid').data('mydata', json); 
```

您可以稍后检索它

```
var json = $('#mygrid').data('mydata') 
```

jQuery data() 方法文档：[http ://api.jquery.com/data/](http://api.jquery.com/data/)

# ios - 为 iOS 交叉编译 fontconfig

> ID：10678638
> 
> 赞同：0
> 
> 时间：2012-05-21T01:32:48.197
> 
> 标签：ios, cross-compiling, fontconfig

如何为 iOS 的 fontconfig 交叉编译。
[http://freedesktop.org/software/fontconfig/release](http://freedesktop.org/software/fontconfig/release)

我试试这个：

```
./configure
CC="/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang"
CFLAGS="-isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk -arch armv7"
--sysconfdir=/Users/bluefish625/Desktop/fontconfig/sysconfdir/
--prefix=/Users/bluefish625/Desktop/fontconfig/prefix/
--mandir=/Users/bluefish625/Desktop/fontconfig/mandir
--disable-shared
--host=armv7-apple-darwin
--with-freetype-config=$PREFIX/bin/freetype-config 
```

错误信息是：

```
configure: error: in `/Users/bluefish625/Downloads/fontconfig-2.9.0':
configure: error: The pkg-config script could not be found or is too old.
Make sure it is in your PATH or set the PKG_CONFIG environment variable to the full path to pkg-config.

Alternatively, you may set the environment variables LIBXML2_CFLAGS
and LIBXML2_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details.

To get pkg-config, see <http://pkg-config.freedesktop.org/>.
See `config.log' for more details 
```

而且，我不知道这是什么`--with-freetype-config`意思？
有人可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:11:15.353

试试这个：

```
export IOS_PLATFORMDIR="/Developer/Platforms/iPhoneOS.platform"
export IOS_SYSROOT="$IOS_PLATFORMDIR/Developer/SDKs/iPhoneOS5.0.sdk"
export IOS_GCC="$IOS_PLATFORMDIR/Developer/usr/bin/arm-apple-darwin10-llvm-gcc-4.2"
export IOS_CFLAGS="-march=armv6 -mcpu=arm1176jzf-s -mfpu=vfp"

./configure --host arm-apple-darwin10 --disable-docs --enable-shared=no \
           --with-expat="/Users/meox/PODOFO/expat" \
           --with-expat-includes="/Users/meox/PODOFO/expat/include" \
           --with-expat-lib="/Users/meox/PODOFO/expat" \
CC="$IOS_GCC" LD="$IOS_GCC" \
CFLAGS="-mfloat-abi=softfp -isysroot $IOS_SYSROOT -O3 $IOS_CFLAGS" \
LDFLAGS="-mfloat-abi=softfp -isysroot $IOS_SYSROOT $IOS_CFLAGS
-L/Users/meox/PODOFO/freetype2 -L/Users/meox/PODOFO/expat
-L/Users/meox/PODOFO/zlib -L/Users/meox/PODOFO/libiconv
-L/Users/meox/PODOFO/bzip2" \
CPPFLAGS="-I/Users/meox/PODOFO/freetype2/include
-I/Users/meox/PODOFO/zlib/include -I/Users/meox/PODOFO/expat/include" 
```

您必须设置正确的路径。

# ios - 查询的核心数据和查询结果

> ID：10678645
> 
> 赞同：1
> 
> 时间：2012-05-21T01:34:07.763
> 
> 标签：ios, core-data, predicate

我的模型中有两个实体，`A`并且`B`. `A`与 具有一对多关系`B`，并且它的逆是与 的一对一关系`A`。我想`B`使用`A`如下方式获取实体的结果：

1.  `A`使用某些谓词对实体执行获取请求。
2.  在此请求返回的结果上，钻取到所有相关`B`的 s 并通过第二个谓词过滤这些过滤器。
3.  返回 entity 的所有有效结果`B`。

当然，我可以做 (1)，然后`B`使用第二个谓词过滤一个 s 数组。但是我知道这是次优的。

即使使用单个提取和谓词，我怎样才能最有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T05:00:10.520

如果您已经持有 A 的实例，只需通过 A 的访问器访问相关的 B 实例。

如果您需要直接获取与特定 A 相关的所有 B（在这种情况下不需要），您将为 B 实体构建一个获取请求，其谓词基于 Bs 与 A 的（反向）关系. （具体语法将取决于逆关系名称，以及该逆关系是一对一还是一对多。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:52:33.493

不幸的是，我不确定你在问什么。如果您提供更多详细信息，那肯定会有所帮助。

所以，我只需要猜测......请记住，获取请求只能返回一种类型的实体。所以，如果你想要关系中多方面的东西，那就去拿它。

你可以在你的谓词中使用'点'符号......我也可能会向后搜索......

```
NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"Employee"];
fetchRequest.predicate = [NSPredicate predicateWithFormat:@"department.name like 'Support'"]; 
```

从部门到员工是一对多的关系。上面抓取了属于名称中带有“支持”的部门的所有员工。

# c# - 在 Windows 窗体 DataGridView 单元格中托管 TreeView

> ID：10678649
> 
> 赞同：3
> 
> 时间：2012-05-21T01:34:41.303
> 
> 标签：c#, .net, winforms, datagridview

我想为 DataGridView 创建一个 TreeView 列。我已经按照[此处](http://msdn.microsoft.com/en-us/library/7tas5c80%28v=vs.100%29.aspx)的示例扩展了 TreeView，如下所示。

```
public class TreeViewEditingControl : TreeView, IDataGridViewEditingControl

public class TreeViewCell : DataGridViewComboBoxCell // Not sure whether this should be DataGridViewTextBoxCell 
```

这是我的问题。我可以在单元格中看到 Treeview，但我不知道当用户单击单元格时如何增加 Cell/TreeView 的高度（当 ComboBox 展开时）。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:59:27.487

我会生成一个新的无边框表单，里面有一个 TreeCtrl Docked，我用 CalendarControl 完成了这个，效果很好。如果您将表单的左上角设置为正在编辑的单元格的左上角，用户将不会知道其中的区别。希望这是您正在寻找的。

**编辑：**

这是我为文件选择单元所做的实现。它有一个浏览按钮，当您单击它进行编辑时，它会出现在单元格中，并打开一个 FileOpenDialog。代码很长，但我认为你可以挑选出你需要实现的部分。

```
public class DataGridViewFileColumn : DataGridViewColumn
{
    public DataGridViewFileColumn() : base(new DataGridViewFileCell())
    {
        BrowseLabel = "...";
        SaveFullPath = false;
    }

    public override DataGridViewCell CellTemplate
    {
        get
        {
            return base.CellTemplate;
        }
        set
        {
            // Ensure that the cell used for the template is a DataGridViewFileCell.
            if (value != null &&
                !value.GetType().IsAssignableFrom(typeof(DataGridViewFileCell)))
            {
                throw new InvalidCastException("Must be a DataGridViewFileCell");
            }
            base.CellTemplate = value;
        }
    }

    [Description("Label to place on Browse button"),Category("Appearance")]
    [DefaultValue("...")]
    public string BrowseLabel 
    {
        get; 
        set; 
    }

    [Description("Save full path name"), Category("Behavior")]
    [DefaultValue(true)]
    public bool SaveFullPath
    {
        get;
        set;
    }
}

public class DataGridViewFileCell : DataGridViewTextBoxCell
{
    public DataGridViewFileCell() : base()
    {
    }

    public override void InitializeEditingControl(int rowIndex, object
            initialFormattedValue, DataGridViewCellStyle dataGridViewCellStyle)
    {
        // Set the value of the editing control to the current cell value.
        base.InitializeEditingControl(rowIndex, initialFormattedValue,
            dataGridViewCellStyle);
        FileEditingControl ctl = (FileEditingControl)DataGridView.EditingControl;
        // Use the default row value when Value property is null.
        if (this.Value == null)
        {
            ctl.Filename = this.DefaultNewRowValue.ToString();
        }
        else
        {
            ctl.Filename = this.Value.ToString();
        }
    }

    public override Type EditType
    {
        get
        {
            // Return the type of the editing control that DataGridViewFileCell uses.
            return typeof(FileEditingControl);
        }
    }

    public override Type ValueType
    {
        get
        {
            // Return the type of the value that DataGridViewFileCell contains.
            return typeof(string);
        }
    }
}

class FileEditingControl : FileTextBox, IDataGridViewEditingControl
{
    DataGridView dataGridView;
    private bool valueChanged = false;
    int rowIndex;

    public FileEditingControl()
    {
    }

    #region IDataGridViewEditingControl implementations
    public object EditingControlFormattedValue
    {
        get
        {
            return Filename;
        }
        set
        {
            if (value is String)
            {
                try
                {
                    Filename = (String)value;
                }
                catch
                {
                    Filename = value.ToString();
                }
            }
        }
    }

    public object GetEditingControlFormattedValue(
        DataGridViewDataErrorContexts context)
    {
        return EditingControlFormattedValue;
    }

    public void ApplyCellStyleToEditingControl(
        DataGridViewCellStyle dataGridViewCellStyle)
    {
        this.Font = dataGridViewCellStyle.Font;
    }

    public int EditingControlRowIndex
    {
        get
        {
            return rowIndex;
        }
        set
        {
            rowIndex = value;
        }
    }

    public bool EditingControlWantsInputKey(
        Keys key, bool dataGridViewWantsInputKey)
    {
        switch (key & Keys.KeyCode)
        {
            case Keys.Left:
            case Keys.Up:
            case Keys.Down:
            case Keys.Right:
            case Keys.Home:
            case Keys.End:
            case Keys.PageDown:
            case Keys.PageUp:
                return true;
            default:
                return !dataGridViewWantsInputKey;
        }
    }

    public void PrepareEditingControlForEdit(bool selectAll)
    {
    }

    public bool RepositionEditingControlOnValueChange
    {
        get
        {
            return false;
        }
    }

    public DataGridView EditingControlDataGridView
    {
        get
        {
            return dataGridView;
        }
        set
        {
            dataGridView = value;
        }
    }

    public bool EditingControlValueChanged
    {
        get
        {
            return valueChanged;
        }
        set
        {
            valueChanged = value;
        }
    }

    public Cursor EditingPanelCursor
    {
        get
        {
            return base.Cursor;
        }
    }
    #endregion

    protected override void OnValueChanged(FileEventArgs eventargs)
    {
        // Notify the DataGridView that the contents of the cell
        // have changed.
        valueChanged = true;
        this.EditingControlDataGridView.NotifyCurrentCellDirty(true);
        base.OnValueChanged(eventargs);
    }
}

public partial class FileTextBox : UserControl
{

    #region Constructors
    public FileTextBox()
    {
        InitializeComponent();
        Tooltip = new ToolTip();

        SaveFullPath = false;
        AllowMultipleFiles = false;
        BrowseLabel = "...";
    }
    #endregion Constructors

    #region Properties
    /// <summary>
    /// Tooltip object used to show full path name
    /// </summary>
    private ToolTip Tooltip;

    /// <summary>
    /// Return the full path or just the filename?
    /// </summary>
    [Description("Save Full Path"), Category("Behavior")]
    [DefaultValue(false)]
    public bool SaveFullPath
    {
        get;
        set;
    }

    /// <summary>
    /// String representing the filename for this control
    /// </summary>
    public override string Text
    {
        get 
        { 
            return base.Text; 
        }
        set 
        {
            if (base.Text != value)
            {
                base.Text = value;
                Tooltip.SetToolTip(this, base.Text);
                Invalidate();
                OnValueChanged(new FileEventArgs(base.Text));
            }
        }
    }

    [Description("Browse Label"), Category("Appearance")]
    [DefaultValue("...")]
    public string BrowseLabel
    {
        get
        {
            return Browse.Text;
        }
        set
        {
            Browse.Text = value;
            Browse.Width = TextRenderer.MeasureText(Browse.Text, Browse.Font).Width + 8;
            Browse.Location = new Point(this.Width - Browse.Width, Browse.Location.Y);
        }
    }

    [Description("Allow Multiple Files"), Category("Behavior")]
    [DefaultValue(false)]
    public bool AllowMultipleFiles
    {
        get;
        set;
    }

    /// <summary>
    /// Selected filename (same as Text property)
    /// </summary>
    [Description("Filename"), Category("Data")]
    public string Filename
    {
        get { return Text; }
        set { Text = value; }
    }
    #endregion Properties

    #region Event Handlers
    /// <summary>
    /// Event raised when 
    /// </summary>
    public event EventHandler ValueChanged;
    protected virtual void OnValueChanged(FileEventArgs eventargs)
    {
        eventargs.Filename = Filename;
        if (this.ValueChanged != null)
            this.ValueChanged(this, eventargs);
    }

    private void Browse_Click(object sender, EventArgs e)
    {
        OpenFileDialog dlg = new OpenFileDialog();
        dlg.FileName = Text;

        dlg.Multiselect = AllowMultipleFiles;
        if (dlg.ShowDialog() == DialogResult.OK)
        {
            if (SaveFullPath)
                Text = dlg.FileName;
            else
                Text = dlg.SafeFileName;
        }
    } 

    protected override void OnPaint(PaintEventArgs e)
    {
        // Draw the client window
        Rectangle r = new Rectangle(new Point(0, 0), new Size(Size.Width-1, Size.Height-1));
        Graphics g = e.Graphics;
        g.FillRectangle(new SolidBrush(SystemColors.Window), r);
        g.DrawRectangle(new Pen(VisualStyleInformation.TextControlBorder), r);
        r.Y += Margin.Top;
        r.Width -= Browse.Width;

        // Fill with Text
        TextRenderer.DrawText(g, Text, Font, r, ForeColor, TextFormatFlags.PathEllipsis);

        base.OnPaint(e);
    }

    private void FileTextBox_DragDrop(object sender, DragEventArgs e)
    {
        DataObject data = (DataObject)e.Data;
        StringCollection filenames = data.GetFileDropList();

        if ( filenames.Count == 1)
            Text = filenames[0];
    }

    private void FileTextBox_DragEnter(object sender, DragEventArgs e)
    {
        DataObject data = (DataObject)e.Data;
        StringCollection filenames = data.GetFileDropList();

        if (/*!AllowMultipleFiles &&*/ filenames.Count == 1)
            e.Effect = DragDropEffects.Link;
    }
    #endregion Event Handlers

}

public class FileEventArgs : EventArgs
{
    public FileEventArgs(string Text)
    {
        Filename = Text;
    }

    /// <summary>
    /// Name of the file in the control
    /// </summary>
    public String Filename { get; set; }
} 
```

# python - QSettings setpath ini 格式仍在 Windows 上使用注册表

> ID：10678651
> 
> 赞同：2
> 
> 时间：2012-05-21T01:34:54.533
> 
> 标签：python, qt, pyqt, qsettings

我正在尝试使用 QSettings::setPath 和 defaulFormat 设置路径以存储我的应用程序的一些自定义设置，但是当我尝试使用设置文件时，两者似乎都被忽略了。

```
>>> QSettings.setDefaultFormat(QSettings.IniFormat)
>>> QSettings.setPath(QSettings.IniFormat, QSettings.UserScope, "C:\\")
>>> settings3 = QSettings("Balh", "MyApp")
>>> settings3.fileName()
PyQt4.QtCore.QString(u'\\HKEY_CURRENT_USER\\Software\\Balh\\MyApp') 
```

如果可以，我想继续使用`settings = QSettings()`而无需提供`QSettings::IniFormat`它，因为它是一个跨平台应用程序，如果未设置自定义路径，则应使用本机格式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T11:43:24.367

QSettings 文档误导性地暗示代码

```
QSettings settings("Moose Soft", "Facturo-Pro"); 
```

相当于

```
QCoreApplication::setOrganizationName("Moose Soft");
QCoreApplication::setApplicationName("Facturo-Pro");
QSettings settings; 
```

但是这是错误的。试试这个

```
from PySide import QtCore
QtCore.QSettings.setDefaultFormat(QtCore.QSettings.IniFormat)

settings = QtCore.QSettings("Moose Soft", "Facturo-Pro")
print settings.format()

QtCore.QCoreApplication.setOrganizationName("MooseSoft")
QtCore.QCoreApplication.setApplicationName("Facturo-Pro")
settings = QtCore.QSettings()
print settings.format() 
```

你会看到只有第二个构造函数使用默认格式。如果您查看 QSettings 构造函数文档，您将看到这一点得到确认：

> 例子：
> 
> ```
> QSettings settings("Moose Tech", "Facturo-Pro"); 
> ```
> 
> 范围设置为QSettings::UserScope，格式设置为QSettings.NativeFormat（即在调用此构造函数之前调用setDefaultFormat()没有效果）。

只有一些 QSettings 构造函数支持默认格式，而您选择了不支持的格式。

# php - 查询错误，资源 id #9 是什么？

> ID：10678657
> 
> 赞同：0
> 
> 时间：2012-05-21T01:36:51.623
> 
> 标签：php

我有以下代码..

```
$query = "SELECT quote, author FROM quotes ORDER BY id DESC";
$resut = mysql_query($query, $connection) or die(mysql_error());

echo $result; //for debuggin purpose

while($result_set =  mysql_fetch_array($result)) {      
    echo '<div class="pullquote">';
    echo $result_set['quote'];
    echo ' - ';
    echo $result_set['author'];
    echo '</div>';
} 
```

这不起作用！该表不是空的仅供参考，我在输出中看到的是：

> 资源 ID #9

我无法弄清楚这`Resource id #9`意味着什么。正如我`SELECT quote, author FROM quotes ORDER BY id DESC`在 phpmyadmin 中测试的那样，它可以正常工作并产生所需的结果，但不是在这里。我想知道代码有什么问题吗？

如果我跟随，

```
$array = mysql_fetch_assoc($result);
var_dump ($array); 
```

它返回，`bool(false)`。这是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:39:20.100

### 什么是“资源”？

没有什么*问题*（`Resource id #9`这只是意味着你有资源）。请注意有关此主题[的文档：](http://php.net/manual/en/function.mysql-query.php)

> 对于返回`SELECT`、`SHOW`、和其他语句`DESCRIBE`，成功或错误时返回 a 。`EXPLAIN``resultset``mysql_query()``resource``FALSE`

因此，如果您有“资源”，则意味着您的查询没有失败。

### 注意错别字

此外，您正在设置`$resut`并尝试访问`$result`. 注意缺少的“l”。

# vb.net - 在新的 Visual Studio Express (C++ prefrred) 项目中使用旧版 (VB6) DLL

> ID：10678668
> 
> 赞同：2
> 
> 时间：2012-05-21T01:38:22.297
> 
> 标签：vb.net, dll, visual-studio-express, vb6-migration, visual-c++-2008

我有一个旧的遗留应用程序，用于通过串行端口与嵌入式控制器通信总线进行通信。别人开发的。

该应用程序是用 VB6 编写的，结构为两个项目 - 一个用于处理连接和通信逻辑的 DLL，以及一个应用程序 GUI 项目。

我希望能够编写一个新的应用程序 GUI（理想情况下在 C++ 中）以按原样使用现有的 DLL，但是我在解决如何导入它时遇到了很多问题。

所以我想知道，是否可以将这个旧 DLL 原样使用到 C++ 项目中？或者是否可以导入到 C# 项目中？还是 VB.NET 项目？（宁愿不使用 VB，但如果必须，可以）

我现在在哪里：

我有现有的已编译可执行文件和 DLL，它们在我的系统上运行。

我也有项目文件，它们都可以在 notepad++ 中读取，但我没有 VB6，并且将项目导入 Visual Studio VB.NET 2008 Express 一点也不简单。尤其是没有一个工作示例可以先挖掘和使用（DLL 项目可能是可导入的，但在升级报告中有 50 多个需要更改的内容。它似乎也忽略了三个对我来说非常重要的 .cls 文件不是特别精通 VB6 的眼睛......应用程序项目在升级报告中有一条关于“缺少设计时许可证”的消息，并且实际上似乎进入项目资源管理器的导入项目的唯一项目文件是项目文件本身，以及程序集信息文件。）

大多数如何将 DLL 导入 VS C++ 的示例都假设您有一个解决方案，该 DLL 项目与您的项目一起很好地编译，将使用它。或者至少是一个 .DLL 和 .lib 和 .h 文件...我与代码的原始开发人员交谈（在另一个城市，我们不直接工作）并得到一个 .lib 来匹配我的 .dll，但仍然没有 .h 文件。

我通常可以通过一些新的东西来抨击，但是即使在我可以理解的 VB6 中也没有该项目的基线工作示例，这使得这非常困难。此外，谷歌可以在网上找到类似的问题，这让我想知道这是否是我应该尝试的事情。

我正在努力获得 Visual Studio 的非快递副本，如果这会产生任何影响（到目前为止，快递对一切都很好，所以我再也不需要任何东西了），但这很可能需要数周时间。

任何建议将不胜感激。

谢谢阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:12:06.323

**我不得不否认这一点，因为我没有这样做的经验，但只是发现通过阅读有关该主题的文档应该是可能的。**

如果有很多低级的事情发生，我不确定你是否会在 VB 到 .NET 的导入/转换过程中获得成功。现有的 dll 很可能是一个 COM 对象，不是吗？

似乎有一些 MSDN 文档可以让您使用 COM 对象 dll 从 C++ 开始 - 并且该`#import`指令看起来也会生成一些 .h（头文件）文件。

[http://msdn.microsoft.com/en-us/library/8etzzkb6.aspx](http://msdn.microsoft.com/en-us/library/8etzzkb6.aspx)

所以我会尝试简单地`#import`为它添加一个指令。

`#import "somelibrary.dll"`

并查看 Visual Studio 生成的内容。

看看下面的例子，（从另一个论坛无耻地复制）

```
 #import "F:\proj\VB6\ActiveXDLL\VBTestDLL.dll"
 using namespace VBTestLib;

void CDialogTestDlg::OnButton1() 
{

 HRESULT hresult;
 CLSID clsid;
 _CTest *t; // a pointer to the CTest object
 _bstr_t bstrA = L"hello";
 _bstr_t bstrB = L" world"; 
 _bstr_t bstrR;
 ::CoInitialize(NULL);
  hresult=CLSIDFromProgID(OLESTR("VBTestLib.CTest"), &clsid);
  hresult= CoCreateInstance(clsid,NULL,CLSCTX_INPROC_SERVER,
                               __uuidof(_CTest),(LPVOID*) &t);
  if(hresult == S_OK)
  {
     bstrR  = t->vbConcat(bstrA , bstrB);
     AfxMessageBox((char*)bstrR);
   }
 } 
```

# php - Netbeans中的PHP：是否有生成标签的快捷方式

> ID：10678670
> 
> 赞同：10
> 
> 时间：2012-05-21T01:38:54.217
> 
> 标签：php, netbeans

我刚刚开始使用 Netbeans（7.1.2，php 版本）来处理 PHP 项目。Netbeans 非常适合编辑较长的 PHP 代码。

*但是*在我的视图文件中，HTML 与短的 PHP 混合在一起，我真的厌倦了手动输入：

```
<?php  ?> 
```

在 Dreamweaver 中，您只需按一个按钮即可创建这些标签，但在 Netbeans 中，我找不到任何类似键盘快捷键的东西。当然必须有一个。有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-21T02:15:44.743

在 Netbeans 中，我转到了**工具 -> 选项 -> 编辑器 -> 代码模板**并查看了**PHP**语言的所有缩写。PHP 有很多很多的缩写。但是`<?php ?>`标签不在那里。

在输入我的问题后，我想到这样的缩写将用于**HTML**语言而不是 PHP。我看了看，根本没有任何代码模板。但是添加我自己的一个很简单（缩写：'p'，扩展文本' `<?php ?>`'）。

现在，当光标位于某些 HTML 的中间时，我输入`p[TAB]`并显示我的标签！

**更新**
感谢上面评论中@chris 的链接，我可以将扩展文本更改为`<?php echo ${cursor} ?>`，光标最终到达我想要的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:50:48.283

浏览了指南，没有看到任何内容

[http://netbeans.org/project_downloads/www/shortcuts.pdf](http://netbeans.org/project_downloads/www/shortcuts.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T01:55:17.250

我不认为有，但你可以创建一个宏来自己做:)

您只需单击**Edit -> Start Macro Recording**然后您必须输入，`<?php ?>`然后单击**Edit -> Stop Macro Recording**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T02:53:42.887

默认没有一个。最接近的是键入`<?`并按`ctrl`+`space`这将建议您`<?php...`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-31T12:53:04.810

只需键入**php + TAB**`<?php ?>`或**phpe +** TAB即可`<?php echo ?>`

它适用于具有默认 PHP 包的 Netbeans 8

如果需要，可以在**Tools -> Options -> Editor -> Code Templates**上更改该快捷方式；在语言的选择框中选择**HTML 。**

# jquery - 用于 iPad 的 jQuery scrollTo 的替代品

> ID：10678671
> 
> 赞同：2
> 
> 时间：2012-05-21T01:38:54.610
> 
> 标签：jquery, ios, ipad, jquery-animate, scrollto

我敢肯定，我们之前都读过[iPad Flicker on auto scroll using JQuery and Scrollto plugin](https://stackoverflow.com/questions/4125805/ipad-flicker-on-auto-scroll-using-jquery-and-scrollto-plugin)。一年半过去了，我还没有找到一个优雅的解决方案。

我正在使用[scrollTo](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)和[localScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)为一组导航锚设置动画，这在 iPad 上很糟糕。经过一些简化后，我发现问题是由在 X 轴和 Y 轴上滚动引起的。如果我将它们垂直堆叠，我会跳过 iPad 吓坏了。

不幸的是，我无权进行这样的设计改动，我觉得是时候我们大家聚在一起，战胜这头野兽了。

那么，最新的是什么？有人制作模块化、XY 兼容、哈希滚动、缓动算法冠军吗？

# c# - 命名空间不能直接包含成员... + 类型或命名空间定义，或文件结尾预期错误

> ID：10678672
> 
> 赞同：3
> 
> 时间：2012-05-21T01:38:56.617
> 
> 标签：c#, windows-phone

我正在尝试为 Windows Phone 的 Sync Framework 4.0 编译示例代码，但是我在几个文件中遇到了错误。这些文件之一是：

```
#if SERVER
namespace Microsoft.Synchronization.Services
#elif CLIENT
namespace Microsoft.Synchronization.ClientServices
#endif
{
    /// <summary>
    /// Represents the base interface that all offline cacheable object should derive from.
    /// </summary>
    public interface IOfflineEntity
    {
        /// <summary>
        /// Represents the sync and OData metadata used for the entity
        /// </summary>
        OfflineEntityMetadata ServiceMetadata { get; set; }
    }
} 
```

有两个错误：

*   命名空间不能直接包含字段或方法等成员——对于第一个括号
*   最后一个括号的类型或命名空间定义，或预期的文件结尾

我已经通过谷歌搜索了这两个错误，并且我找到了很多此类错误的答案 - 但是这些都不能应用于我的案例（afaik 没有缺少括号）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:13:49.367

您收到此错误是因为您既没有定义 SERVER 也没有定义 CLIENT[条件符号](http://msdn.microsoft.com/en-us/library/aa691095%28v=VS.71%29.aspx)。在预处理阶段消除[#if](http://msdn.microsoft.com/en-us/library/4y6tbswk) ... [#endif](http://msdn.microsoft.com/en-us/library/hyx43has)指令中的文本后，编译器只看到以下代码：

```
{
    /// <summary>
    /// Represents the base interface that all offline cacheable object should derive from.
    /// </summary>
    public interface IOfflineEntity
    {
        /// <summary>
        /// Represents the sync and OData metadata used for the entity
        /// </summary>
        OfflineEntityMetadata ServiceMetadata { get; set; }
    }
} 
```

这不是有效的 C# 代码（因为在打开大括号之前缺少“命名空间 xyz”）。

在 Visual Studio 中，转到项目属性并在*Build页面上将**条件编译符号*设置为 SERVER 或 CLIENT（名称区分大小写）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T16:18:57.160

我收到此错误是因为我的 .TT 文件中有 UNIX 样式的换行符，大概是因为换行符是由 git 转换的。将 .tt 文件复制到文本编辑器中，将其保存为 PC 格式，然后复制回 Visual Studio 为我解决了这个问题。

# php - PHP 表单提交到 CSV 文件

> ID：10678674
> 
> 赞同：0
> 
> 时间：2012-05-21T01:39:06.663
> 
> 标签：php, forms, csv, processor

我想提交一个表格并将信息写入 CSV 文件并存储在主机中。每个新表单都应该在 csv 中添加一个新行。另外，假设我有几个用户可以加入的组 - A、b、c、d、e。如果用户选择加入 2 个或三个组（1,2 和 3rd 组），我该如何做到这一点，它将将此信息作为 123 存储在同一个单元格中。以下是我的 HTML 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Reg</title>
</head>

<body>
<form id="form1" name="form1" method="post" action="post.php">
<table width="597" class="formatTblClass">
<tr>
<th colspan="4"></th>
</tr>
<tr>
<td width="99"><span>First Name</span></td>
<td width="217"><input class="" type="text" name="fn" id="fn" /></td>
<td width="99"><span>Last Name</span></td>
<td width="211"><input class="" name="ln" type="text" id="ln" /></td>
</tr>
<tr>
  <td>Phone</td>
  <td><input class="" type="text" name="phone" id="phone" /></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
<tr>
  <td colspan="4">Check groups that you would like to receive updates about</td>
  </tr>
<tr>
  <td><input name="1" type="checkbox" id="1" value="a" /></td>
  <td>A</td>
  <td><input name="4" type="checkbox" id="4" value="b" /></td>
  <td>B</td>
</tr>
<tr>
  <td><input name="2" type="checkbox" id="2" value="c" /></td>
  <td>C</td>
  <td><input name="5" type="checkbox" id="5" value="d" /></td>
  <td>D</td>
</tr>
<tr>
  <td><input name="3" type="checkbox" id="3" value="e" /></td>
  <td>E</td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
<tr>
  <td colspan="4">
  <div align="center">
  <input type="submit" name="Submit" id="Submit" value="Submit" />
  <input type="reset" name="Reset" id="button" value="Reset" />
  </div></td>
</tr>
</table>
</form>
</body>
</html> 
```

这是我的 post.php 文件：

```
<?php
$fn = $_POST['fn'];
$ln = $_POST['ln'];
$phone = $_POST['phone'];
$1 = (isset($_POST['1'])) ? $_POST['1'] : 'No';
$2 = (isset($_POST['2'])) ? $_POST['2'] : 'No';
$3 = (isset($_POST['3'])) ? $_POST['3'] : 'No';
$4 = (isset($_POST['4'])) ? $_POST['4'] : 'No';
$5 = (isset($_POST['5'])) ? $_POST['5'] : 'No';

//validate

if(empty($fn) || empty($ln) || empty($phone)){//show the form
$message = 'Fill in areas in red!';
$aClass = 'errorClass';

//this is where the creating of the csv takes place
$cvsData = $phone . "," . $fn . "," . $ln . "," . $phone . "," . $1 ."\n";

$fp = fopen("formTest.csv","a"); // $fp is now the file pointer to file $filename

if($fp){
fwrite($fp,$cvsData); // Write information to the file
fclose($fp); // Close the file
?> 
```

当我提交表单时，我得到一个空白页。怎么了？index.html、post.php 和 testForm.csv 都在同一个文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:43:51.347

你缺少一个右括号

`if($fp){`和`if(empty($fn) || empty($ln) || empty($phone)){`

你应该启用`error_reporting(E_ALL)`它会显示错误和使用

```
$fn = $_POST['fn'];
$ln = $_POST['ln'];
$phone = $_POST['phone']; 
```

如果表格未发布，则为未定义。

# java - Java - 铸造一个集合

> ID：10678677
> 
> 赞同：1
> 
> 时间：2012-05-21T01:39:52.767
> 
> 标签：java, casting

有人可以告诉我以下代码有什么问题吗？

```
 Set<String> cmds = *a method call that returns a Set<String>*
    String[] cmdarr = (String[]) cmds.toArray();
    int i;
    for(i=0; i<cmdarr.length;i++){
        System.out.println(cmdarr[i]); 
```

它给出了以下错误：

```
Exception in thread "main" java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [Ljava.lang.String;
at a.jim.Test.main(Test.java:79) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T01:43:50.540

`Set`本身在运行时没有关于其元素的任何类型信息；类型参数`<String>`在编译期间被擦除。因此，该`toArray()`方法总是创建一个类型为 的数组`Object[]`。

您可以将数组传递给方法并将集合的内容复制到其中：

```
String[] cmdarr = cmd.toArray(new String[cmd.size()]); 
```

您传入的数组太小，将使用反射创建具有相同组件类型的新数组，但这不如传入正确大小的数组有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:43:22.743

尝试传递[类型](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html#toArray%28T%5B%5D%29)引用。

```
String[] cmdarr = cmds.toArray(new String[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:26:09.667

借鉴@erickson 所说的，其中的参数化类型`Set`只是编译时安全检查。代码编译后，`Set<String>`实际上变成`Set`了`Objects`.

强制转换是一种在运行时实现更高特异性的方法。正如上一段所述，由于泛型类型在编译时会发生所谓的“类型擦除”，但您会收到编译时错误。您的`cmdarr`引用实际上只是类型对象的占位符`String[]`。这个占位符永远不能指向 a`Object[]`就像`Set<List>`占位符永远不能指向 a一样`Set<ArrayList>`。

查看 Java 教程中有关泛型的演练。在使用 Collections 包时，您需要花费很多精力，但非常宝贵。

[Java 教程：课程泛型](http://docs.oracle.com/javase/tutorial/java/generics/index.html)

# c++ - 在 find 上需要 std::set 元素的位置/索引

> ID：10678678
> 
> 赞同：0
> 
> 时间：2012-05-21T01:39:56.947
> 
> 标签：c++

我使用 std::set 对无序重复值的向量进行排序。每次在我的集合中找到一个元素时，我也需要知道该元素的位置（索引）。我的集合中有很多元素（数十万个），使用 std::distance() 给我带来了糟糕的表现。

std::distance 是唯一的出路吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-21T01:49:37.347

您可以使用 std::sort() 算法对元素进行适当的排序。然后，当您使用 binary_search() 在向量中找到一个元素时，只需从指向该元素的迭代器中减去对 begin() 的调用结果。

如果您不想覆盖原始向量，另一种选择是使用 std::partial_sort_copy() 。只需排序到另一个向量中，您就可以执行我上面描述的相同操作。

# python - 为什么 pygame.sndarray.make_sound 似乎将声音持续时间增加了四倍？

> ID：10678682
> 
> 赞同：2
> 
> 时间：2012-05-21T01:41:48.053
> 
> 标签：python, numpy, pygame, audio

以下代码：

```
import pygame, numpy
pygame.mixer.pre_init(frequency=96000,size=-16,channels=1)
pygame.init()
a = numpy.random.randn(96000)
sound = pygame.sndarray.make_sound(a)
print sound.get_length() 
```

产生 4.0 的打印输出，这表明在 96000kHz 采样率下的 96000 个样本的指定持续时间不知何故在此过程中增加了四倍。知道我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:50:47.953

进入 make_sound 的数据不是 16 位整数，（正如您的 pre_init() 建议的那样）。在调用 make_sound() 之前尝试...

```
a = a.astype(numpy.int16) 
```

您可能还想确保使用一种生成随机数的方法，使它们落入 16 位整数的范围内。数组中的值应介于 -32768 到 32767 之间（这些边界表示最大音量）。

# lua - 如何将参数传递和读取到 lua 程序？

> ID：10678687
> 
> 赞同：8
> 
> 时间：2012-05-21T01:42:13.760
> 
> 标签：lua

相当于`main(int argc, char*argv[])`C 的。例如：`./foo.lua -a -b`我如何读取`-a`和`-b`从`foo.lua`程序中读取？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T02:37:03.440

命令行参数在全局表中`arg`。有关详细信息，请参见[此处](http://torch5.sourceforge.net/manual/LuaManual-6.html)。由于没有 argparse/optparse 库，您需要自己处理短开关和长开关的逻辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T10:23:11.697

命令行参数也可用作脚本的真实参数，即可变参数函数。所以你可以这样做：

```
local x,y,z = ... 
```

如果您需要遍历命令行参数，请使用该`arg`表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-22T09:57:27.670

您可以使用出色的[argparse](https://github.com/mpeterv/argparse)库。文档在这里：[http ://argparse.readthedocs.io/en/stable/](http://argparse.readthedocs.io/en/stable/)

# c# - 返回 JSON 时的 C# 递归限制

> ID：10678691
> 
> 赞同：9
> 
> 时间：2012-05-21T01:42:33.030
> 
> 标签：c#, asp.net-mvc-3

我最近遇到了一个烦人的问题。我将在这里简化我的数据模型，但原理是一样的。我有一个类“用户”。在那个类中，我有一个属性，它是用户拥有的对象列表。我也有这个类“对象”。因为每个“对象”都有一个所有者，所以它有一个“用户”类型的属性，它链接到它的所有者。现在，我想做的基本上就是这个

```
return Json(myUser,JsonRequestBehavior.AllowGet); 
```

当我加载页面时，大约需要 30 秒，然后我收到错误“超出 RecursionLimit”。

我想这是因为这些对象相互链接。现在我的问题是，我怎样才能告诉“Json”它不应该深入到 1 级对象以避免这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T01:46:23.670

`myUser`可能是EntityFramework生成的类型。

当您返回 Json 时，框架将准备好每个属性本质上触发 SQL 命令以延迟加载所有数据。

相反，您应该准备一个具有未附加到 EntityFramework 的具体属性的 ViewModel 类，并准备该对象的深度，使其达到您想要的深度。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-21T01:58:58.683

当您的对象具有自身的某些属性时，可能会发生这种情况。例如。

```
public object Employee()
{
    string ID {get; set;}
    string Name {get; set;}
    int Age {get; set;}
    Employee Boss{get; set;} //<-- here
}

var employee = new Employee();
return Json(employee,JsonRequestBehavior.AllowGet); //The Boss property will cause "RecursionLimit exceeded". 
```

为了避免这种情况。你可以这样做：

```
var employee = new Employee();
var prepareForJson = new {
    ID = employee.ID,
    Name = employee.Name,
    Age = employee.Age,
    Boss = employee.Boss.ID
};
return Json(prepareForJson , JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-21T01:46:50.500

您可以通过 web.config 配置递归深度

[http://msdn.microsoft.com/en-us/library/bb763183.aspx](http://msdn.microsoft.com/en-us/library/bb763183.aspx)

但你可能只想整理你的模型*而不是*首先进行递归。想想在您当前的情况下需要多少数据并返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-14T08:04:25.783

我认为这`Edison Chuang`是绝大多数情况的答案（将数据模型映射到一些不具有那些肯定会在序列化过程中导致循环的导航属性的服务模型）。

但是，由于大多数服务模型将共享数据模型（EF 模型）的许多属性，因此可以使用[AutoMapper ，从而大大简化代码，尤其是对于具有许多属性的对象。](https://automapper.org/)例如：

```
// set up map
cfg.CreateMap<Employee, EmployeeSm>();

// use the map
var sm = Mapper.Map<EmployeeSm>(employee);
// this can be also set up during mapping configuration phase
sm.Boss = employee.Boss.ID; 
```

对于序列化深度超过默认 100 的极少数情况，您可以增加此限制或[使用 Json.NET](https://www.newtonsoft.com/json/help/html/MaxDepth.htm)序列化对象。

# objective-c - uitableview 上垂直 uiscrollbar 的奇怪行为

> ID：10678693
> 
> 赞同：0
> 
> 时间：2012-05-21T01:42:43.123
> 
> 标签：objective-c, uitableview, scrollbar, vertical-scrolling

在从服务器检索更多数据后，我正在使用下面的代码设置 uitableview 的内容偏移量。

```
[tablefollow setContentOffset:CGPointMake(0, tablefollow.contentSize.height- self.tablefollow.bounds.size.height-5+ (numLines*(25/numLines))) animated:NO]; 
```

出于某种原因，当我用手指快速向下滚动时，我注意到垂直滚动条到达末尾并消失，但随后又重新出现几行一秒钟，然后又消失了！当我用手指快速滚动到 uitableview 的底部时，就会发生这种情况。当我慢慢滚动到 uitableview 的底部时，不会发生这种情况。以前有人遇到过这个问题吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:10:02.343

问题是我提到的代码即使在用户滚动 uitableview 时也会被调用。它与滚动的速度无关。我只是在 scrollviewdidbegindragging 中添加了一个值并将其设置为 TRUE，然后当 scrollviewdidenddragging 发生时我将其设置为 FALSE。我已将此代码放入我的函数中

```
If (!scrollingvalue)
{
//execute code
} 
```

当值为 FALSE 时（这意味着 uitableview 未被用户拖动），则执行代码，否则不执行代码。希望它可以帮助某人。

# python - 在 Python 3.2 中，我可以使用 http.client 打开和读取 HTTPS 网页，但 urllib.request 无法打开同一页面

> ID：10678695
> 
> 赞同：7
> 
> 时间：2012-05-21T01:43:20.073
> 
> 标签：python, ssl, https, urllib

我想打开并阅读[https://yande.re/](https://yande.re/)，`urllib.request`但出现 SSL 错误。`http.client`我可以使用以下代码很好地打开和阅读页面：

```
import http.client

conn = http.client.HTTPSConnection('www.yande.re')
conn.request('GET', 'https://yande.re/')
resp = conn.getresponse()
data = resp.read() 
```

但是，以下代码使用`urllib.request`失败：

```
import urllib.request

opener = urllib.request.build_opener()
resp = opener.open('https://yande.re/')
data = resp.read() 
```

它给了我以下错误：`ssl.SSLError: [Errno 1] _ssl.c:392: error:1411809D:SSL routines:SSL_CHECK_SERVERHELLO_TLSEXT:tls invalid ecpointformat list`。为什么我可以使用 HTTPSConnection 打开页面，但不能使用 opener.open？

**编辑：**这是我的 OpenSSL 版本和尝试打开[https://yande.re/的回溯](https://yande.re/)

```
>>> import ssl; ssl.OPENSSL_VERSION
'OpenSSL 1.0.0a 1 Jun 2010'
>>> import urllib.request
>>> urllib.request.urlopen('https://yande.re/')
Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    urllib.request.urlopen('https://yande.re/')
  File "C:\Python32\lib\urllib\request.py", line 138, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Python32\lib\urllib\request.py", line 369, in open
    response = self._open(req, data)
  File "C:\Python32\lib\urllib\request.py", line 387, in _open
    '_open', req)
  File "C:\Python32\lib\urllib\request.py", line 347, in _call_chain
    result = func(*args)
  File "C:\Python32\lib\urllib\request.py", line 1171, in https_open
    context=self._context, check_hostname=self._check_hostname)
  File "C:\Python32\lib\urllib\request.py", line 1138, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [Errno 1] _ssl.c:392: error:1411809D:SSL routines:SSL_CHECK_SERVERHELLO_TLSEXT:tls invalid ecpointformat list>
>>> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:30:29.263

这是由于[椭圆曲线加密的早期 1.x OpenSSL 实现中的一个错误](https://rt.openssl.org/Ticket/Display.html?id=2240&user=guest&pass=guest)。仔细看看异常的相关部分：

```
_ssl.c:392: error:1411809D:SSL routines:SSL_CHECK_SERVERHELLO_TLSEXT:tls invalid ecpointformat list 
```

这是来自底层 OpenSSL 库代码的错误，它是错误处理 EC 点格式 TLS 扩展的结果。一种解决方法是使用 SSLv3 而不是 SSLv23 方法，另一种解决方法是使用禁用所有 ECC 密码套件的密码套件规范（我在`ALL:-ECDH`,`openssl ciphers`用于测试时得到了很好的结果）。修复是更新 OpenSSL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T05:25:57.940

多么巧合！我和你有同样的问题，还有一个复杂的问题：我在代理后面。我发现了这个关于 https-not-working-with-urllib 的[错误报告。](http://bugs.python.org/issue11220)幸运的是，他们发布了一个解决方法。

```
import urllib.request
import ssl

##uncomment this code if you're behind a proxy
##https port is 443 but it doesn't work for me, used port 80 instead

##proxy_auth = '{0}://{1}:{2}@{3}'.format('https', 'username', 'password', 
##             'proxy:80')
##proxies = { 'https' : proxy_auth }
##proxy = urllib.request.ProxyHandler(proxies)
##proxy_auth_handler = urllib.request.HTTPBasicAuthHandler()
##opener = urllib.request.build_opener(proxy, proxy_auth_handler, 
##                                     https_sslv3_handler)

https_sslv3_handler = 
         urllib.request.HTTPSHandler(context=ssl.SSLContext(ssl.PROTOCOL_SSLv3))
opener = urllib.request.build_opener(https_sslv3_handler)
urllib.request.install_opener(opener)
resp = opener.open('https://yande.re/')
data = resp.read().decode('utf-8')
print(data) 
```

顺便说一句，感谢您展示如何使用`http.client`. 我不知道还有另一个图书馆可以用来连接到互联网。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T18:47:31.240

问题是由于您在两个示例中给出的主机名：

```
import http.client
conn = http.client.HTTPSConnection('www.yande.re')
conn.request('GET', 'https://yande.re/') 
```

和...

```
import urllib.request
urllib.request.urlopen('https://yande.re/') 
```

请注意，在第一个示例中，您要求客户端与主机建立连接：www.yande.re，在第二个示例中，urllib 将首先解析 url 'https://yande.re'，然后尝试向主机 yande.re 提出请求

虽然 www.yande.re 和 yande.re 可能解析到相同的 IP 地址，但从 Web 服务器的角度来看，它们是不同的虚拟主机。我的猜测是您的 Web 服务器端存在[SNI](http://en.wikipedia.org/wiki/Server_Name_Indication)配置问题。看到最初的问题是在 5 月 21 日发布的，而 yande.re 的当前证书从 5 月 28 日开始，我认为您已经解决了这个问题？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-22T15:15:55.530

尝试这个：

```
import connection #imports connection
import url 

url = 'http://www.google.com/'    
webpage = url.open(url)

try:
    connection.receive(webpage)
except:
    webpage = url.text('This webpage is not available!')
    connection.receive(webpage) 
```

# performance - 在二维空间中查找矩形

> ID：10678700
> 
> 赞同：4
> 
> 时间：2012-05-21T01:43:53.747
> 
> 标签：performance, algorithm, geometry, spatial-index

我在二维空间中有一组不同大小的矩形。矩形的数量可以从 10 到 100 000 动态变化，它们的位置以及它们的大小经常更新。

你会推荐哪种空间结构在给定点 (x,y) 找到矩形？假设搜索操作也经常执行（例如鼠标移动）。如果您可以参考各种空间索引算法比较或在这里比较它们的搜索/构建/更新性能 - 那会很可爱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T07:00:50.773

我建议[R-Tree](http://en.wikipedia.org/wiki/R-tree)。它主要设计用于矩形（或 N 维轴对齐的立方体）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T06:56:46.733

使用四叉树 ( [http://en.wikipedia.org/wiki/Quadtree](http://en.wikipedia.org/wiki/Quadtree) )。

确定矩形开始和结束的所有可能的 X 和 Y 值。然后在这些值上构建一个四叉树。在四叉树的每个叶子中，存储哪些矩形与叶子的坐标范围重叠。找到哪些矩形重叠只是找到包含坐标的叶子的问题。

# java - 如何使用onClick for android从按钮生成随机类结果？

> ID：10678703
> 
> 赞同：0
> 
> 时间：2012-05-21T01:44:06.583
> 
> 标签：java, android, random, android-intent

如果你有三个班级；红、蓝、绿。如果您要单击主类活动中的一个按钮，您将如何让 onClick 随机选择一个类作为新活动？

例如：

```
Button random;
random = (Button)findViewById(R.id.random);
random.setOnClickListener(phaseHandler);
View.OnClickListener phaseHandler = new View.OnClickListener(){
public void onClick(View v) {
    if(random.getId() == ((Button)v).getId()){
        Intent i = new Intent(context, (Select one class randomly from classes Blue,     Red, Green);
        startActivity(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:46:39.203

您可以使用 java.util.Random。例如，将类放在集合中，从 Random 中获取 nextInt() 并让它从集合中返回要传递给您的方法的类。

这个问题和你的很相似，看看： [How to generate random events in android?](https://stackoverflow.com/questions/3654130/how-to-generate-random-events-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T01:48:53.823

```
Random rand = new Random(); 
int pickedNumber = rand.nextInt(3);
if(pickedNumber==0){//Class Red}
else if(pickedNumber==1){//Class Blue}
else{//Class Green} 
```

# java - 更改 JAX-WS 默认 XML 命名空间前缀

> ID：10678723
> 
> 赞同：1
> 
> 时间：2012-05-21T01:50:02.617
> 
> 标签：java, jax-ws

我已经使用 JAX-WS 2.1.7 为旧的 Web 服务生成了源代码。当我调用此服务时，生成的肥皂消息是这样的：

```
<env:Envelope xmlns:env='http://schemas.xmlsoap.org/soap/envelope/'>
  <env:Header>
  </env:Header>
  <env:Body>
      ...
  </env:Body>
</env:Envelope> 
```

但是旧的 Web 服务只接受这种格式：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    ...
  </soap:Body>
</soap:Envelope> 
```

如您所见，前缀是“soap”而不是“env”，并且没有标题，所以我收到一个错误，抱怨“soap:Body”是必需的。我无法更改旧的网络服务，需要发送兼容的肥皂信息。如何将前缀更改为“soap”并删除“Header”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T01:36:21.800

You need to create a class that implements `SOAPHandler<SOAPMessageContext>` and that includes something like this:

```
 public boolean handleMessage(final SOAPMessageContext context)
  {
    final Boolean isSoapResponse = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);
    if (!isSoapResponse)
    {
      try
      {
        final SOAPMessage soapMsg = context.getMessage();
        soapMsg.getSOAPPart().getEnvelope().setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:soap", "http://schemas.xmlsoap.org/soap/envelope/");
        soapMsg.getSOAPPart().getEnvelope().removeAttributeNS("http://schemas.xmlsoap.org/soap/envelope/", "env");
        soapMsg.getSOAPPart().getEnvelope().removeAttribute("xmlns:env");
        soapMsg.getSOAPPart().getEnvelope().setPrefix("soap");
        soapMsg.getSOAPBody().setPrefix("soap");
        soapMsg.getSOAPPart().getEnvelope().getHeader().detachNode();
      }
      catch (SOAPException e)
      {
        e.printStackTrace();
      }
    }
    return true;
  } 
```

Then create a handler.xml file:

```
<?xml version="1.0" encoding="UTF-8"?>
<handler-chains xmlns="http://java.sun.com/xml/ns/javaee">
  <handler-chain>
    <handler>
      <handler-name>test.MySoapHandler</handler-name>
      <handler-class>test.MySoapHandler</handler-class>
    </handler>
  </handler-chain>
</handler-chains> 
```

And add an annotation to your web service:

`@HandlerChain(file = "handler.xml")`

# asp.net-mvc-3 - 如何创建条件 ValidationAttribute 错误消息？

> ID：10678730
> 
> 赞同：1
> 
> 时间：2012-05-21T01:51:21.200
> 
> 标签：asp.net-mvc-3, validationattribute

我的 ASP.NET MVC3 项目中有一个自定义 ValidationAttribute，它有两个需要满足的条件。它工作得很好，但我想让用户现在通过返回自定义错误消息来破坏哪个验证规则。

使用我正在使用的方法（从基类继承错误消息）我知道在初始化后我无法更改 _defaultError 常量的值，所以....

如何根据未满足的条件返回不同的错误消息？

这是我的 ValidationAttribute 代码：

```
public class DateValidationAttribute :ValidationAttribute
{
    public DateValidationAttribute() 
        : base(_defaultError)
    {

    }

    private const string _defaultError = "{0} [here is my generic error message]";

    public override bool IsValid(object value)
    {
        DateTime val = (DateTime)value;

        if (val > Convert.ToDateTime("13:30:00 PM"))
        {
            //This is where I'd like to set the error message
            //_defaultError = "{0} can not be after 1:30pm";
            return false;
        }
        else if (DateTime.Now.AddHours(1).Ticks > val.Ticks)
        {
            //This is where I'd like to set the error message
            //_defaultError = "{0} must be at least 1 hour from now";
           return false;
        }
        else
        {
            return true;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:57:14.647

我可以建议您创建两个不同的 DateValidator 类实现，每个都有不同的消息。这也符合 SRP，因为您只需将每个验证器中的相关验证信息分开。

```
public class AfternoonDateValidationAttribute : ValidationAttribute
{
   // Your validation logic and message here
}

public class TimeValidationAttribute : ValidationAttribute
{
   // Your validation logic and message here
} 
```

# database - Haskell 可以伪装成数据库吗？如果可以，怎么做？

> ID：10678732
> 
> 赞同：1
> 
> 时间：2012-05-21T01:51:32.773
> 
> 标签：database, sqlite, haskell, acid

我意识到这可能是一个愚蠢的问题，但是有没有办法让 Haskell（或使用一些带有 Haskell 的库）让它像 SQL 数据库一样工作？如果是这样，怎么做？

像 SQLite 这样的东西，但没有持久性？

这个想法是我可以创建 Haskell“表”和 Haskell“索引”（存储在内存中），并且外部应用程序可以查询它们。

如果它不能处理连接也没关系。

原因是外部应用程序需要查询数据库，但我想将我的数据保持在[acid-state](http://hackage.haskell.org/package/acid-state)，并且不想一直做将东西转储到数据库的中间步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T04:29:10.123

[http://hackage.haskell.org/packages/archive/ixset/1.0.3/doc/html/Data-IxSet.html](http://hackage.haskell.org/packages/archive/ixset/1.0.3/doc/html/Data-IxSet.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T05:05:51.027

> 这个想法是我可以创建 Haskell“表”和 Haskell“索引”（存储在内存中），并且外部应用程序可以查询它们。

当然，无论您使用哪种编程语言，在您的应用程序中，您都可以公开一个接口（可能通过套接字等）来构造和查询数据。

# mysql - PHPMYADMIN 用户访问

> ID：10678733
> 
> 赞同：0
> 
> 时间：2012-05-21T01:51:53.400
> 
> 标签：mysql, phpmyadmin, cpanel

好的，所以我有一台 linux(centos) 专用服务器。我付钱请人照看我的服务器。现在我记得为了安全起见，我要求他禁用所有用户 exvept root 对 PHPMYADMIN 的访问。现在我只想为一个用户启用对 phpmyadmin 的访问。

我该怎么做，以便特定用户可以通过 cpanel/whm 访问 phpmyadmin ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:08:52.733

为什么不简单地在 phpmyadmin 中创建一个新用户？然后你有root和可以连接到数据库的新用户。除非您的意思是限制在服务器端（服务器用户），否则这是一个完全不同的故事。

# sql-server - 使用 Windows Azure Connect 的 SQL Server 安全连接

> ID：10678734
> 
> 赞同：2
> 
> 时间：2012-05-21T01:52:52.787
> 
> 标签：sql-server, security, azure, azure-connect

我正在设置一个在 Azure 上运行但需要访问本地 SQL Server 的系统。我已按照[本文](http://wely-lau.net/category/windows-azure-platform/windows-azure/windows-azure-connect/)中的详细说明对其进行了构建。这要求我向世界开放 1433 端口，这看起来像是一个严重的安全问题。有什么方法可以打开该端口并使其保持安全（我知道我可以拥有复杂的用户 ID 和密码以及所有内容，但是有更好的方法来保护 SQL Server）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:28:58.640

默认情况下，本地数据库和 Windows Azure Connect 之间的连接通过 IPSEC 协议是安全的

> “Windows Azure Connect 使用行业标准的端到端 IPSEC 协议在本地机器和云中的角色之间建立安全连接。与在网关级别建立安全连接的传统虚拟专用网络 (VPN) 不同，Windows Azure Connect 通过在机器和角色级别建立安全连接来提供更精细的控制。”

[http://blogs.msdn.com/b/usisvde/archive/2012/03/14/windows-azure-security-best-practices-part-6-how-azure-services-extends-your-app-security。 aspx](http://blogs.msdn.com/b/usisvde/archive/2012/03/14/windows-azure-security-best-practices-part-6-how-azure-services-extends-your-app-security.aspx)

您的数据库不会公开可用，只有 Azure Connect 上的 VM 才能看到它。

您的传统防火墙和本地安全策略和程序仍会将您的数据库隐藏在您的企业环境中，您所做的只是让 Windows Azure VM（角色）能够看到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T03:27:39.340

我在@user728584 的关于打开端口1433 的回答上看到了评论讨论。端口1433 与Azure Connect 无关，Azure Connect 本质上是本地机器和Windows Azure 角色实例集合之间的VPN 隧道。Azure Connect 需要在要添加到连接组的任何本地服务器上安装代理，并且不需要打开入站端口。在您的情况下，您需要将代理添加到您的 SQL Server 框中，然后该代理将成为连接组的一部分，并且可以直接从您的 Windows Azure 角色实例（对于您添加到该组的角色）进行访问。Connect Agent 然后建立隧道。

Connect Agent 内置了一个为您生成的特殊密钥，使其独一无二。但是，即使有人以某种方式获得了您特定 Connect Agent 的安装程序，它也无济于事，因为您仍然需要将该节点添加到 Connect Group。所以，这是一个安全的设置。

# jquery - 快速jQuery幻灯片，通用事件

> ID：10678739
> 
> 赞同：1
> 
> 时间：2012-05-21T01:53:07.700
> 
> 标签：jquery

所以我必须想出一些类似这样的迷你脚本，

单击一个句子或一个问题，答案就会下降（向下滑动）。再次单击它，它会向上滑动等。

够简单的......

现在我是一个菜鸟，例如，如果我有 1 个问题，那么我当然会写这样的东西：

CSS：

```
.answer { display:none } 
```

js/jq:

```
var question = $('.question');
var answer = $('.answer');

question.click( function(){
    answer.slideToggle(500);    
}); 
```

等等，但是现在如果我说 5 个问题，那么我必须再创建 5 个变量（或直接用 jq 调用 em）等等等等……长话短说，它将成为**每个**问题/答案集的代码**笨重的快速**

我试图写一些更聪明的东西（更少的代码）所以为了测试我的逻辑我试试这个：

```
question.click( function(){
    if($(this).parent().hasClass('open')){
        $(this).parent().removeClass('open');
        alert("its open");  
    } else {
        alert("its not open");
        $(this).parent().addClass('open');

    }
}); 
```

现在当我尝试这个时，它可以工作。当它打开时，它会提醒打开并删除打开的类，因此在下次单击时，它没有打开并提醒我......如此小的测试工作。

所以很自然，这意味着我应该能够添加某种动画/幻灯片代码来让我滚动并且它应该可以工作，但要么 A，它不起作用，要么 B，它同时打开所有答案。

我试过了

```
question.click( function(){
    if($(this).parent().hasClass('open')){
        $(this).parent().removeClass('open');
        //alert("its open");
        answer.slideUp(500);    
    } else {
        //alert("its not open");
        $(this).parent().addClass('open');

        answer.slideDown(500);
    }
}); 
```

无论我点击什么问题，这个都会同时打开所有答案。

我想，让我在答案行中添加一个“this”来本地化事件......也许是这样的。

```
$(this).answer.slideDown(500); 
```

但这显然是行不通的。

我也尝试过类似的东西`$(this).find('answer').slideUp(500);`

我知道我很接近哈哈。任何提示/链接、解释等都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:57:33.760

[http://jsfiddle.net/7eHzz/](http://jsfiddle.net/7eHzz/)

```
<div class="question">
   q1
    <div class="answer">
      a1
    </div>
</div>

var question = $('.question');
var answer = $('.answer');

question.click( function(){
    $(".answer",$(this)).slideToggle(500);    
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:31:18.607

在我看来，使用元素 id 来解决您的 Qs 和 As 将使生活更轻松：

[http://jsfiddle.net/qaMwJ/3/](http://jsfiddle.net/qaMwJ/3/)

```
 <style type="text/css">
      .answer { display: none }
    </style>

    // local copy
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
      $(document).ready( function () {
        $(".question").click(function (event) {
          // discard the "q" from id of question clicked
          var qnumber = event.target.id.slice(1);
          $("#a" + qnumber).slideToggle(500);
        });
      });
    </script>

  <body>
    <div id="q1" class="question">Q. 1</div>
    <div id="a1" class="answer">A. 1</div>
    <br><br>
    <div id="q2" class="question">Q. 2</div>
    <div id="a2" class="answer">A. 2</div>
    <br><br>
    <div id="q3" class="question">Q. 3</div>
    <div id="a3" class="answer">A. 3</div>
    <br><br>
    <div id="q40" class="question">Q. 40</div>
    <div id="a40" class="answer">A. 40</div>
  </body> 
```

# java - Javabean bean 类文件放在哪里？

> ID：10678740
> 
> 赞同：0
> 
> 时间：2012-05-21T01:53:14.160
> 
> 标签：java

我有一个 javabean 文件，用于从 Web 表单中收集用户数据。（用户数据.java）

这个文件被编译并放在一个名为的包下`user` （我把这个类放在下面`webapps\ROOT\WEB-INF\classes\user`）

然后在一个特定的 html 页面中，我允许用户输入他们的姓名、电子邮件等。当用户单击提交按钮时，他们将转到“/process.jsp”，其中前两个语句是：

```
<jsp:useBean id="user" class="user.UserData" scope="session" />
<jsp:setProperty name="user" property="*" /> 
```

但它抛出：

```
org.apache.jasper.JasperException: /process.jsp(1,1) The value for the useBean class attribute user.UserData is invalid. 
```

请注意，我的 UserData 是一个公共类，getter 和 setter 方法是正确的。

有人可以帮忙吗？？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:21:53.340

几点：

1.  您的 UserData 应该有一个无参数构造函数，尽管默认情况下它存在，但如果提供参数化构造函数，则必须显式提供它。
2.  包装完全一样

    包用户；公共类用户数据 {

    }

并不是

```
package User;
public class UserData {

} 
```

3\. 你的类已经正确编译，不包含任何编译错误。

# database - 如何有效地将大学和部门存储在数据库中？

> ID：10678741
> 
> 赞同：0
> 
> 时间：2012-05-21T01:53:17.560
> 
> 标签：database, database-design

我想创建一个关于大学的网站。我的问题是试图找到一种将部门和大学存储在表格中的有效方法。例如，Koc 大学设有计算机工程、工商管理、经济学等系。但萨班哲大学的系里也有计算机工程和经济学。我在想有一张有大学 ID 和部门 ID 的表，但我不确定这是不是最好的主意。你有什么想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:05:46.930

您很有可能想要区分每所大学的部门。例如，Koc 的经济部门与 Sabanci 的经济部门不同。为此，您需要两个表：

```
+--------------------
| University        |
+-------------------+
| UniversityId      |
| Name              |
+-------------------+

+-------------------+
| Department        |
+-------------------+
| DepartmentId      |
| Name              |
| UniversityId      |
+-------------------+ 
```

如果你只需要参考每所大学的部门类型而不需要任何关于部门的额外数据，即你只想知道Sabanci和Koc都有经济部门而没有其他，你仍然可以使用上面的或者你可以使用这个结构：

```
+--------------------
| University        |
+-------------------+
| UniversityId      |
| Name              |
+-------------------+

+-------------------+
| Department        |
+-------------------+
| DepartmentId      |
| Name              |
+-------------------+

+-------------------+
| UniDept           |
+-------------------+
| UniversityId      |
| DepartmentId      |
+-------------------+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:04:23.170

如果同一个部门可以与不同的大学链接，我会这样做：
Table Universities, Middle table UniID, DeptID, Table Departments

但是，如果一个部门只特定于一所大学，则删除中间表并将 UniID 添加到部门。

# java - Java Sudoku：通用数组创建

> ID：10678742
> 
> 赞同：-4
> 
> 时间：2012-05-21T01:53:20.803
> 
> 标签：java, arrays, generics, creation, sudoku

> **可能重复：**
> [Java 如何：创建](https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation)
> [通用数组 通用数组创建错误](https://stackoverflow.com/questions/7131652/generic-array-creation-error)

```
private ArrayList<Integer>[][] potentialList = new ArrayList<Integer>[9][9]; 
```

有人，请向我解释为什么这个陈述给了我一个：

```
--------------------Configuration: <Default>--------------------  
SolveSudoku.java:31: error: generic array creation  
private ArrayList<Integer>[][] potentialList = new ArrayList<Integer>[9][9];  
//The error is on the "n" of new ArrayList.

Process completed. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:05:29.463

我们不知道你想做什么，也许：

```
private ArrayList<Integer[][]> potentialList = new ArrayList<Integer[][]> (); 
```

这将是 2dim-Integer-Arrays 的列表。

# jquery - Flash 到 jQuery 使用动画

> ID：10678745
> 
> 赞同：0
> 
> 时间：2012-05-21T01:53:48.000
> 
> 标签：jquery, flash, jquery-ui

我正在将[Flash 设计](http://9amresourceagency.com/Flash/index.html)转换为 javascript。它的球在屏幕上移动并成为地球。我正在使用`animate()`它的功能，但它会在一个新功能出现的一小段时间内停止，`animate()`因此它与 Flash 动画不相似。有什么更好的想法吗？

这是我在屏幕上旋转它的方式：

```
 .animate({ opacity: 1 },"fast")
.animate({top:'230px', left:'175px'}, {duration:0})
.animate({top:'310px', left:'215px'}, {duration:500})
.animate({top:'360px', left:'237px'}, {duration:500})
.animate({top:'400px', left:'350px'}, {duration:500}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:20:28.770

我已经这样做了，当谈到流畅的动画时，浏览器仍然缺乏这种鲁棒性。无论如何，您是否尝试过对动画序列进行排队？这样，至少浏览器不会不堪重负，您会看到更好的结果吗？这是一个很好的阅读：

[http://www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup](http://www.learningjquery.com/2009/01/quick-tip-prevent-animation-queue-buildup)

谢谢

# php - 如何将图像从 sql 数据库发送到 android 客户端？

> ID：10678753
> 
> 赞同：1
> 
> 时间：2012-05-21T01:55:50.900
> 
> 标签：php, android, sql, image

我正在尝试将图像从 sql 数据库发送到 android 客户端。我通过 php 中间人来做这件事。由于下面的方法返回空值，代码停止工作。我的php代码（可以很好地将图像编码为base64（解码编码并且可以正常工作））：

```
<?php
    //get image
    function ob_base64_encode($c) {
    $a=base64_encode($c);
    $arr = array('base64' => $a);
      return json_encode($arr);
    }
    $image=resize(48,80,$image);
    // And pass its name as a string
    ob_start('ob_base64_encode');
    imagepng($image);
    ob_end_flush();
?> 
```

我的安卓代码：

```
public static Bitmap getIm(String IP, int height, int width)
{
    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
//Network queries and gets response(works)
    String result = Network.getResponse(IP, nameValuePairs);
//manually decode string since for some reason JSON decode won't work(also works)
String r=result.split(":\"")[1];
r=r.split("\"")[0];
//decode string
    byte[] decodedString = Base64.decode(r, Base64.DEFAULT);
    Bitmap decodedByte = BitmapFactory.decodeByteArray(decodedString, 0, decodedString.length); 
    return decodedByte;
//returns null
    } 
```

# jquery - 使用 JQuery 将 mailto 链接添加到静态电子邮件

> ID：10678756
> 
> 赞同：2
> 
> 时间：2012-05-21T01:56:21.767
> 
> 标签：jquery

我正在尝试使用 JQuery 将 mailto 链接添加到在数据库结果列表中找到的静态电子邮件地址。我能够在网上找到以下摘录，它适用于第一个结果，但它不适用于第一个结果之后的任何电子邮件地址。

我很好奇为什么会这样......以及如何让它将 mailto: 属性应用于结果中找到的每个电子邮件地址。:-)

当前代码：

```
<script type="text/javascript">
$(document).ready(function(){
    var regEx = /(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/;
    $("table td").filter(function() {
        return $(this).html().match(regEx);
    }).each(function() {
        $(this).html($(this).html().replace(regEx, "<a href=\"mailto:$1\">$1</a>"));
    });
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-24T09:10:00.410

可能它对您不再有用，但可能对某人有用：您必须在正则表达式的末尾添加一个“g”：

```
$(document).ready(function() {
var regEx = /(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/g;
$("table td").filter(function() {
    return this.innerHTML.match(regEx);
}).html(function(index, old) {
    return old.replace(regEx, "<a href=\"mailto:$1\">$1</a>");
}); 
```

});​</p>

来自[W3C 学校网站](http://www.w3schools.com/jsref/jsref_match.asp)：

> Note: If the regular expression does not include the g modifier (to perform a global search), the match() method will return only the first match in the string.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T02:03:02.410

我不知道为什么它只适用于第一场比赛，但你可以改进你的代码：

```
$(document).ready(function() {
    var regEx = /(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/;
    $("table td").filter(function() {
        return this.innerHTML.match(regEx);
    }).html(function(index, old) {
        return old.replace(regEx, "<a href=\"mailto:$1\">$1</a>");
    });
});​ 
```

# string - 在R中拆分一个字符串

> ID：10678758
> 
> 赞同：1
> 
> 时间：2012-05-21T01:56:46.033
> 
> 标签：string, r

我有以下字符串：

```
> position_string
[1] "35.132  46.524  94.997" 
```

如何获得 35.132、46.524、94.997 作为列表？在 python 中，我会做 string.split() 就是这样，但我似乎无法开始`strsplit`工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T02:08:50.960

怎么样

```
position_string <- "35.132     46.524   94.997"
lapply(unlist(strsplit(position_string," +")),as.numeric) 
```

? 正则表达式`" +"`处理多个空格。（我假设您想将块转换为数字，但也许您不想......）

PS你真的想要输出作为一个列表，还是实际上作为一个向量？

# neo4j - 在哪里使用 WITH？

> ID：10678761
> 
> 赞同：1
> 
> 时间：2012-05-21T01:57:23.080
> 
> 标签：neo4j

在这个查询中，我有一个：

```
 START root = node(*)
        MATCH root-[:HAS_DEPARTMENTS]->()<-[:IS_DEPARTMENT]-department-[relationship1:HAS_CATEGORY_SUGGESTION]->categorySuggestion-[relationship2:IS_CATEGORY_SUGGESTION]->()<-[:HAS_CATEGORY_SUGGESTIONS]-root
        WHERE root.name = "Store" and department.name = "foo" and categorySuggestion.name = "bar"
        DELETE relationship1, relationship2

        WITH root, department, categorySuggestion
        MATCH root-[:HAS_CATEGORIES]->categories
        CREATE department-[:HAS_CATEGORY]->categorySuggestion
        CREATE categories<-[:IS_CATEGORY]-categorySuggestion 
```

我有一个 WITH 子句分隔两个部分。

如果我将 DELETE 移到 WITH 下方，我会收到错误消息。

我只是想知道，我怎么知道应该在哪里使用 WITH。

有一些黄金法则吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T07:55:43.747

WITH 子句分隔密码查询的不同管道语句。在 WITH 之后，以下部分仅对 WITH 子句中命名的变量可见。除非您在 WITH 中声明它们，否则您的 DELETE 将因此失败。

# c++ - 为什么 VC++ 2010 Express 在这个程序中不需要 stdio.h 而 gcc++ 需要？

> ID：10678769
> 
> 赞同：0
> 
> 时间：2012-05-21T01:59:48.370
> 
> 标签：c++

我有以下代码

```
#include <iostream>

using namespace std;

void WaitForEnter()
{
    while(1)
    {
        if('\n' == getchar()) 
        {
            break;
        }
    }
    return;
}

int main()
{
    cout<< "Press Enter to Exit... ";
    WaitForEnter();
} 
```

这在 Microsoft Visual C++ 2010 Express 上编译并符合我的预期。在使用 code::blocks 和 gcc++ 4.7 的 Ubuntu 上，构建失败并显示以下内容`error: 'getchar' was not declared in this scope.` 如果我添加该行`#include "stdio.h"`，程序将编译并以预期的行为运行。为什么这个程序`stdio.h`在 Ubuntu 上使用 MVC++ 2010 Express 编译，但没有使用 gcc++ 4.7 的 code::blocks。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:13:29.753

使用 MSVC，`<stdio.h>`作为包含`<iostream>`. 查看预处理的输出，或按照 MSVC 文件中的 #include 路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T02:21:46.537

最简单的答案是该标准允许任何标准标头包含任何其他标头。另一方面，如果你想编写可移植的代码，你不应该依赖它，并且应该包含翻译单元所需的所有标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:09:45.997

在 Visual Studio 中，当您创建一个新项目时，它会为您包含 stdafx.h。在这个文件中，它包括：

```
#include "targetver.h"

#include <stdio.h>
#include <tchar.h> 
```

# javascript - HTML5 和分贝计

> ID：10678771
> 
> 赞同：4
> 
> 时间：2012-05-21T02:00:17.530
> 
> 标签：javascript, html, mobile, cordova

无论如何使用 HTML5 和 Javascript 来捕获音频并获得它的实时分贝值？这可以在使用 PhoneGap 的移动设备上完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:12:32.440

除非您使用 Flash 之类的东西，否则您无法通过浏览器本身收听音频。因此，PhoneGap 可能适用于 iPhone 以外的设备（不支持 Flash）。

尽管 PhoneGap**确实**提供了一个[媒体 API](http://docs.phonegap.com/en/1.0.0/phonegap_media_media.md.html)，但您不能只听麦克风输入，而是会启动音频捕获设备并为您提供访问录制音频的方法。

但是，您可以编写自己的[PhoneGap 插件](http://wiki.phonegap.com/w/page/36752779/PhoneGap%20Plugins)来为您提供此功能。

**看**

*   [http://mobileorchard.com/tutorial-detecting-when-a-user-blows-into-the-mic/](http://mobileorchard.com/tutorial-detecting-when-a-user-blows-into-the-mic/) (XCode)
*   [安卓分贝计](https://stackoverflow.com/questions/8288813/android-decibel-meter)（安卓）

正如我上面提到的，您需要[编写自己的 PhoneGap 插件](http://wiki.phonegap.com/w/page/36752779/PhoneGap%20Plugins)才能使用这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-17T19:22:45.427

DecibelMeter：使用 HTML5 音频 API 监控 dB 级别 [https://github.com/jasonpecor/DecibelMeter](https://github.com/jasonpecor/DecibelMeter)

# java - 解析双精度字符串的困难

> ID：10678772
> 
> 赞同：1
> 
> 时间：2012-05-21T02:00:46.267
> 
> 标签：java, string, parsing, double

感谢您花时间回答我的问题。

我有一个`double`值（比如说 22.35）。我需要将其解析为 a`String`并得到 2235。以下代码无法正常工作。

```
double totalPrice = 22.35;
DecimalFormat df = new DecimalFormat("#.##");
String[] temp = df.format(totalPrice).split(".");
String amount = temp[0] + temp[1]; 
```

我不断收到异常`ArrayIndexOutOfBounds`。还有什么方法可以做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:08:03.440

如果您的值不超过，乘以 100 MAX_INT 后，将它们相乘：

```
double totalPrice = 22.35;
int iPrice = (int) (totalPrice * 100);
String sPrice = "" + iPrice; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T13:04:56.297

无论您尝试将其应用于多高的数字，这都会起作用：

```
double num = 22.35;
String concatenate = "" + num;
String parsedNum = concatenate.replace(".", ""); 
```

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:15:21.857

关于什么：

```
double totalPrice = 22.35;
DecimalFormat df = new DecimalFormat("#.##");
String price = df.format(totalPrice).replace(".", ""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T02:51:59.907

也许您可以这样做：只需更改正则表达式“。” 至 ” \。”！

```
String[] temp = df.format(totalPrice).split("\\."); 
```

# ios - UIPickerView 中组件的高度和宽度的默认值

> ID：10678773
> 
> 赞同：3
> 
> 时间：2012-05-21T02:01:34.457
> 
> 标签：ios, uipickerview

UIPickerView中组件的高度和宽度的默认值是多少？即，如果应用程序没有实现这些方法，iOS 用作以下高度和宽度的值是多少？

```
pickerView:widthForComponent:
pickerView:rowHeightForComponent: 
```

我尝试了线程的建议： [UIPickerView 组件的默认宽度是多少？](https://stackoverflow.com/questions/3443306/what-is-the-default-width-of-a-uipickerview-component) 但这会给出一个数组超出范围的异常：

```
Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[NSMutableArray objectAtIndex:]: index 0 beyond bounds for empty array' 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T03:11:04.237

宽度取决于选取器中组件的数量。它是自动计算的（据我所知）。高度似乎在 44 左右。不要担心让它与 Apple 的默认值完全一致。我的意思是无论如何你都在硬编码它，所以如果苹果决定改变它，你的应用程序将会偏离几个像素。我建议只是通过反复试验选择一个高度，从 44 左右开始，然后根据您显示的数据查看“感觉”最好的高度。

# mysql - 一列中有两个外键。怎么拆分？

> ID：10678777
> 
> 赞同：0
> 
> 时间：2012-05-21T02:02:48.503
> 
> 标签：mysql

我有以下情况。

组合表：
`Combination ID | Option ID's`

选项表：
`Option ID | Option Name | Option Value`

当引用与组合关联的两个选项时，组合表中的“选项 ID”列读取为“2345,3421”（在一列中）。

是否可以生成一个列表，列出所有可能的组合和每个组合的值？

IE。`combination1 | option1 | name:size | value:Small | option2 | name:color | value:Blue`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T06:47:13.443

您可以尝试这样的查询 -

```
SELECT
  c.Combination_ID, GROUP_CONCAT(CONCAT(o.Option_Name, '=', o.Option_Value))
FROM
  combinations c
LEFT JOIN options o
  ON find_in_set(o.Option_ID, c.Option_IDs)
GROUP BY
  c.Combination_ID 
```

同意 Ian McLaird 关于表格标准化的观点。

* * *

```
SELECT
  c.Combination_ID,
  GROUP_CONCAT(o.Option_Name),
  GROUP_CONCAT(o.Option_Value)
FROM
  combinations c
LEFT JOIN options o
  ON find_in_set(o.Option_ID, c.Option_IDs)
GROUP BY
  c.Combination_ID 
```

# ruby-on-rails - 使用 Passenger 和 Apache 调试 Rails

> ID：10678779
> 
> 赞同：1
> 
> 时间：2012-05-21T02:03:29.083
> 
> 标签：ruby-on-rails, apache, ubuntu, passenger

我关注的一些线程似乎很旧，所以也许我正在尝试做的事情已经被其他东西取代了——如果是这样，请告诉我！

我刚刚在新服务器上重新安装了 Rails 应用程序，但这次我使用的是 Apache 和Passenger。Ubuntu 12.04 服务器上的 Rails 版本 1.8.7、Apache2 和Passenger。我还想有一个调试器，所以我尝试关注这个线程：

[http://chrisadams.me.uk/2009/04/28/how-to-set-up-a-debugger-with-mod_railspassenger](http://chrisadams.me.uk/2009/04/28/how-to-set-up-a-debugger-with-mod_railspassenger) [http://duckpunching.com/passenger-mod_rails-for-development-now-with -debugger](http://duckpunching.com/passenger-mod_rails-for-development-now-with-debugger) （原文）

我很确定我完全遵循了这一点，并且我的文件是正确的。但我得到了两个差异。首先，当我刷新我的网页时，我的网站没有挂起（如duckpunching 页面所述）......其次，当我输入：

```
rdebug -c 
```

我收到以下错误：

```
/usr/lib/ruby/gems/1.8/gems/ruby-debug-0.10.4/cli/ruby-debug.rb:109:in `initialize': Connection refused - connect(2) (Errno::ECONNREFUSED)
    from /usr/lib/ruby/gems/1.8/gems/ruby-debug-0.10.4/cli/ruby-debug.rb:109:in `new'
    from /usr/lib/ruby/gems/1.8/gems/ruby-debug-0.10.4/cli/ruby-debug.rb:109:in `start_client'
    from /usr/lib/ruby/gems/1.8/gems/ruby-debug-0.10.4/bin/rdebug:336
    from /usr/bin/rdebug:23:in `load'
    from /usr/bin/rdebug:23 
```

所以我觉得我的终端没有以某种方式自动连接？正如我所说，我真的无法在网上找到有关此问题的更新信息，因此无论是使这项工作（Apache / Passenger 的控制台类型调试，就像我对 WEBrick 所做的那样）或当前的最佳实践，我们都非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T08:28:37.760

检查是否

```
File.join('~/www/glp','tmp','debug.txt') 
```

指正确的路径，因为它被评估为 config.ru 的所有者。

# java - 调试通过 perl 脚本调用的 Java 项目

> ID：10678780
> 
> 赞同：4
> 
> 时间：2012-05-21T02:03:40.967
> 
> 标签：java, eclipse, perl, debugging

我正在开发一个在 Eclipse 上的大型 Java 项目。要使用该程序，我们需要在终端中使用参数调用 perl 脚本，然后该脚本将调用该程序。在这种情况下，如何在 Eclipse 中调试程序？

总结：perl程序调用java程序，我需要在eclipse中调试java程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:18:17.880

也许您可以[在 Eclipse 中使用 java 远程调试来](http://javarevisited.blogspot.com/2011/02/how-to-setup-remote-debugging-in.html)做到这一点。

例如，您的 perl 脚本必须启动带有选项以在 JVM 中启用远程调试的 java 应用程序

```
-Xdebug -Xrunjdwp:transport=dt_socket,address=8001,server=y,suspend=y 
```

然后，您通过指定正确主机/端口的“远程 Java 应用程序”调试配置来告诉 Eclipse 连接到该 JVM。

# objective-c - UIButton 的保存属性

> ID：10678782
> 
> 赞同：0
> 
> 时间：2012-05-21T02:04:11.300
> 
> 标签：objective-c, xcode4, attributes, switch-statement

我的代码需要一些帮助。我有一个 UIAlert 会在您第一次打开应用程序时弹出，在该弹出窗口中我有两个按钮，用户将选择其中一个。我希望应用程序记住用户选择哪个按钮来执行某些代码或其他。问题是我在这里有这段代码：

```
-(void)changeLabel{

        progressView.progress += 0.25;
    scan.hidden = YES;

        if (progressView.progress == 1 ) {
            label.hidden = YES;

            progressView.hidden = YES;

            [timer invalidate];

            imagesText.hidden = NO;

            int randomNumber = arc4random() % 4;

            switch (randomNumber) {
                case 0:

                    imagesText.image = [UIImage imageNamed:@"image1.png"];

                    break;

                case 1:

                    imagesText.image = [UIImage imageNamed:@"image2.png"];

                    break;

                case 2:

                    imagesText.image = [UIImage imageNamed:@"image3.png"];

                    break;
                case 3:

                    imagesText.image = [UIImage imageNamed:@"image4.png"];

                default:
                    break;

        }
    }
} 
```

所以我想以某种方式做到这一点，如果用户选择了第一个按钮，应用程序将在案例 0,1 和 2 之间进行切换，如果他选择了第二个按钮，它将在 3 和其他按钮之间进行切换。但我希望代码的开头在两种情况下都相同。我尝试了一些东西，但它并没有按照我想要的方式工作。谢谢您的帮助！

更新：我修复了错误。所以现在我有这个：

```
- (void)viewDidLoad
{

    if (![@"1" isEqualToString:[[NSUserDefaults standardUserDefaults] objectForKey:@"alert"] ]) {
        [[NSUserDefaults standardUserDefaults] setValue:@"1" forKey:@"alert"];
        [[NSUserDefaults standardUserDefaults] synchronize];
        UIAlertView *alerta = [[UIAlertView alloc]initWithTitle:@"Welcome!" message:@"Select your language" delegate:self cancelButtonTitle:@"Button1" otherButtonTitles:@"Button2", nil];

        [alerta show];
        [alerta release];

    }

    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{

    NSString *buttonTitle = [alertView buttonTitleAtIndex:buttonIndex];

   progressView.progress += 0.25;
    scan.hidden = YES;

    if (progressView.progress == 1 ) {
        label.hidden = YES;

        progressView.hidden = YES;

        [timer invalidate];

        imagesText.hidden = NO;

        int randomNumber;

        if ([buttonTitle isEqualToString:@"Button1"]) {

             randomNumber = arc4random() % 3;

        }else if ([buttonTitle isEqualToString:@"Button2"]) {

             randomNumber = arc4random() % 3 + 3;

        }

        switch (randomNumber) {
           //CODE
        }
    }
} 
```

问题是所有代码都应该从以下位置调用：

```
 - (IBAction)scan:(id)sender {

    label.hidden = NO;
    imagesText.hidden = YES;
    progressView.hidden = NO;

    progressView.progress = 0;

    timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(alertView) userInfo:nil repeats:YES];

} 
```

所以我将@selector 更改为alertView 之一，现在当我按下执行所有代码的按钮时，它给了我SIGABRT 错误。任何想法为什么？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T03:18:22.173

当用户选择一个按钮时，您需要使用该按钮的一些唯一值填充属性，例如其标题或标签。一旦你有了它，你可以在你的 randomNumber 定义之前放置一个 if 语句——像这样：

```
if (buttonTitle isEqualToString:@"First Button") {
        int randomNumber = arc4random() % 3; // Gives choices of 0,1, or 2
    }else if (buttonTitle isEqualToString:@"Second Button"){
        int randomNumber = arc4random() % 3 + 3; // Gives choices of 3,4, or 5
    }

     switch (randomNumber) .... (rest of your code) 
```

在 else-if 语句中，+3 将确保 switch 语句中的选择以 3 开头并从那里向上（我不知道您还有多少其他选择）。

# php - Javascript 表单不会提交

> ID：10678784
> 
> 赞同：0
> 
> 时间：2012-05-21T02:04:24.447
> 
> 标签：php, javascript, wordpress

我一直在使用[http://www.hoppinger.com/blog/2010/05/28/file-upload-progress-bar-with-phpapc-and-javascript/](http://www.hoppinger.com/blog/2010/05/28/file-upload-progress-bar-with-phpapc-and-javascript/)提供的上传器，并已将其应用于[一个我的表格](http://test.elitetradersgroup.com.au/broker-tools/amazon-upload/) 和进度表工作时，提交功能不会在成功上传时触发。

我正在使用的完整代码如下：

[JS](http://pastebin.com/VmR64YsT)
[get_progress.php](http://pastebin.com/TegqnGg3)
[上传器.php](http://pastebin.com/SQf9kmXG)

据我所知，以我有限的经验，这是处理提交的函数：

```
postUpload : function(o_data)
{
    // Loop through every input and set json response in hidden input
    this.a_inputs.each((function(o_input)
        {
            var s_name = o_input.get('name');
            var s_value = '';

            if(o_file = o_data.files[s_name])
            {
                s_value = JSON.encode(o_file);
            }

            var o_jsonInput = new Element('input',{'type': 'hidden','name':o_input.origName,'value':s_value}).replaces(o_input);

        }).bind(this));

    // Make form "original" again by purging elements and resetting attributes
    this.revertSubmit();
    this.o_form.submit();
}, 
```

我注意到提交是`this.o_form.submit();`而不是`this.form.submit();`检查它并且他已经`o_form : {}`在类的顶部声明，所以我认为他的语法是正确的，但我没有真正的想法。

在我实施这个进度跟踪器之前，表单运行良好，所以这让我很沮丧。

本质上出了什么问题，我只能假设它就像丢失`;`或类似的错误一样简单。

如果您`404`在提交时得到一个，则表示它有效。我已暂时取消阻止该页面以进行故障排除。

由于可能相关，我的网站使用 WordPress。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T00:50:53.293

事实证明，javascript没有将`APC_UPLOAD_PROGRESS`标签添加到表单中，所以我`jQuery`在初始化后添加了以下内容：

```
<script type="text/javascript">
    jQuery(document).ready(function(){

        var id = jQuery("form").attr('id');

        jQuery("form").submit(function(){

            jQuery(this).append("<input type=\"hidden\" name=\"APC_UPLOAD_PROGRESS\" value=\""+id+"\" />");

        });

    });

</script> 
```

现在一切都很好。

# jquery - li 和 jquery 导航不起作用

> ID：10678787
> 
> 赞同：0
> 
> 时间：2012-05-21T02:04:42.787
> 
> 标签：jquery, html, css

我有以下代码：

**HTML**

```
<ul id="navigation">
<li class="quickHelp"><a href="" title="Ayuda Rápida"></a>
    <div>
        Sed lacus. Donec lectus. Nullam pretium nibh ut turpis. Nam bibendum. In nulla tortor, elementum vel, tempor at, varius non, purus. Mauris vitae nisl nec metus placerat consectetuer. Donec ipsum. Proin imperdiet est. Phasellus dapibus semper urna. Pellentesque ornare, orci in consectetuer hendrerit, urna elit eleifend nunc, ut consectetuer nisl felis ac diam. Etiam non felis. Donec ut ante. In id eros. Suspendisse lacus turpis, cursus egestas at sem. Mauris quam enim, molestie in, rhoncus ut, lobortis a, est.
    </div>
</li>
</ul> 
```

**CSS**

```
ul#navigation {
    position: fixed;
    margin: 0px;
    padding: 0px;
    top: 10px;
    left: 0px;
    list-style: none;
    z-index:9999;
}
ul#navigation li {
    width: 100px;
}
ul#navigation li a {
    display: block;
    margin-left: -2px;
    width: 300px;
    height: 350px;    
    background-color:#CCC;
    background-repeat:no-repeat;
    background-position:center center;
    border:1px solid #AFAFAF;
    -moz-border-radius:0px 10px 10px 0px;
    -webkit-border-bottom-right-radius: 10px;
    -webkit-border-top-right-radius: 10px;
    -khtml-border-bottom-right-radius: 10px;
    -khtml-border-top-right-radius: 10px;
    /*-moz-box-shadow: 0px 4px 3px #000;
    -webkit-box-shadow: 0px 4px 3px #000;    
    opacity: 0.6;*/
    filter:progid:DXImageTransform.Microsoft.Alpha(opacity=60);
}
ul#navigation .quickHelp a{
    background-image: url(../Content/images/info/leftBanner.png);
    background-position: right;
}

ul#navigation div{
    position: absolute;
}​ 
```

**JS**

```
$('#navigation a').stop().animate({ 'marginLeft': '-275px' }, 1000);

$('#navigation > li').hover(
    function () {
        $('a', $(this)).stop().animate({ 'marginLeft': '-2px' }, 200);
    },
    function () {
        $('a', $(this)).stop().animate({ 'marginLeft': '-275px' }, 200);
    }
); 
```

我想要实现的是我希望将内容`<div>`显示在下面而`<li>`不是下面......

[这](http://jsfiddle.net/luissanchezm86/j9ny8/)是一个活生生的例子......

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:09:39.553

您不需要`div`，并且您需要将文本放在锚点内`a`，因为这就是您用作滑出的内容。

请参阅[更新的 JsFiddle](http://jsfiddle.net/j9ny8/13/)。

# php - 在 foreach 中解析 foreach

> ID：10678789
> 
> 赞同：0
> 
> 时间：2012-05-21T02:05:12.210
> 
> 标签：php

我有一些问题，我需要指导。我试图解析 3 个 csv 文件并将它们放在一个 foreach 循环中，但它发生了可怕的错误。字符串 $stockClose 不会改变它在整个循环中保持不变，$nas_stock 每 20 个循环改变一次，并且假设每个循环都会改变，唯一似乎工作正常的是 $sp500_stock，我不知道为什么

```
 $currentMonth = date('n');
    $currentMonth = $currentMonth - 1;
    $prevcurrentMonth = date('n');
    $prevcurrentMonth = $prevcurrentMonth - 2;
    $currentDay = date('j');
    $lastDay = $currentDay - 6;
    $currentYear = date('Y');

    $filedow = file_get_contents("http://ichart.finance.yahoo.com/table.csv?s=%5EDJI&a=$prevcurrentMonth&b=$lastDay&c=$currentYear&d=$currentMonth&e=$currentDay&f=$currentYear&g=d&ignore=.csv");

    $filenas = file_get_contents("http://ichart.finance.yahoo.com/table.csv?s=%5EIXIC&a=$prevcurrentMonth&b=$lastDay&c=$currentYear&d=$currentMonth&e=$currentDay&f=$currentYear&g=d&ignore=.csv");

    $filesp500 = file_get_contents("http://ichart.finance.yahoo.com/table.csv?s=%5EGSPC&a=$prevcurrentMonth&b=$lastDay&c=$currentYear&d=$currentMonth&e=$currentDay&f=$currentYear&g=d&ignore=.csv");

    $stockcontent = str_replace('Date,Open,High,Low,Close,Volume,Adj Close', '',  $filedow);
    $stockcontent = trim($stockcontent);

$stockcontentex = str_getcsv($stockcontent, "\n");

    $stocknas = str_replace('Date,Open,High,Low,Close,Volume,Adj Close', '',  $filenas);
    $stocknas = trim($stocknas);
$stocknasex = str_getcsv($stocknas, "\n");

    $stocksp500 = str_replace('Date,Open,High,Low,Close,Volume,Adj Close', '',  $filesp500);
    $stocksp500 = trim($stocksp500);
$stocksp500ex = str_getcsv($stocksp500, "\n");

    $i = 0;
    $j = 0;

    $_str = '';  
    $_str .= "<script type='text/javascript'>
   google.load('visualization', '1', {packages: ['annotatedtimeline']});
function drawVisualization() {
  var data = new google.visualization.DataTable();
    data.addColumn('date', 'Date');
    data.addColumn('number', 'Dow Jones');
    data.addColumn('number', 'Nasdaq');
    data.addColumn('number', 'S&P 500');
    data.addRows([";
    $tstr = "";
        $_str = '';  
$_str .= "<script type='text/javascript'>
   google.load('visualization', '1', {packages: ['annotatedtimeline']});
function drawVisualization() {
  var data = new google.visualization.DataTable();
    data.addColumn('date', 'Date');
    data.addColumn('number', 'Dow Jones');
    data.addColumn('number', 'Nasdaq');
    data.addColumn('number', 'S&P 500');
    data.addRows([";
    $tstr = "";
        foreach($stocknasex as $nas){
            $nasex = explode(',',$nas);
                $nas_stock = $nasex[4];
        }

        foreach($stocksp500ex as $sp500){
            $sp500ex = explode(',',$sp500);
                $sp500_stock = $sp500ex[4];
        }
        foreach($stockcontentex as $stockexplode){
        $stockex = explode(',',$stockexplode);
        $stockexdate = explode('-', $stockex[0]);
        $stockYear = $stockexdate[0];
        $stockMonth = $stockexdate[1] - 1 ;
        $stockDay = $stockexdate[2];
        $stockHigh = $stockex[2];
        $stockLow = $stockex[3];
        $stockClose = $stockex[4];

    }

     for($i=0; $i<=30; $i++){
     $tstr = '[new Date('.$stockYear.', '.$stockMonth.', '.$stockDay.'), '.$stockClose.', '.$nas_stock.', '.$sp500_stock.'],'. "\n".$tstr;
     }
     $_str = $_str.$tstr;
     $_str .= "]); 
    var annotatedtimeline = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
          annotatedtimeline.draw(data, {
                            //'allValuesSuffix': '%', // A suffix that is added to all values
                            'colors': ['#12577F', '#769422', '#999999'], // The colors to be used
                            'displayAnnotations': true,
                            'displayExactValues': true, // Do not truncate values (i.e. using K suffix)
                            'displayRangeSelector' : false, // Do not sow the range selector
                            'displayZoomButtons': true, // DO not display the zoom buttons
                            'legendPosition': 'newRow', // Can be sameRow
                            //'max': 600, // Override the automatic default
                            //'min':  500, // Override the automatic default
                            'scaleColumns': [0, 1], // Have two scales, by the first and second lines
                            'scaleType': 'allmaximized', // See docs...
                            'thickness': 2, // Make the lines thicker
                                });
  }
          google.setOnLoadCallback(drawVisualization);

</script><div style='float:left; border:1px solid #ccc;'>
<div id='chart_div' style='width: 500px; height: 230px;'></div></div>";

    return $_str;
    break;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:59:04.693

你想做什么？你有*嵌套*循环。整个`$sp500`循环都在循环体内部`$nas`，这意味着它`$nas`不会重复，直到一直`$sp500`到`$stocksp500ex`. `$nas`反过来，循环完全包含在循环体中，`$stockexplode`这意味着`$stockexplode`直到`$nas`完全通过`$stocknasex`.

它们就像计数器中的数字。最里面的循环是最右边的数字，直到最里面的那个翻过来，下一个循环才会点击。

**编辑**：如果您尝试并行迭代所有三个数组，您应该使用一个循环而不是三个嵌套循环。也许是这样的？

```
 $nasex_count = count($stocknasex);
  $sp500_count = count($stocksp500ex);
  $content_count = count($stockcontentex);
  $max = max($nasex_count, $sp500_count, $content_count);

  for ($i = 0; $i < $max; ++$i) {
    if ($i < $nasex_count) {
        ... do something with $stocknasex[$i] ...
    }

    if ($i < $sp500_count) {
        ... do something with $stocksp500ex[$i] ...
    }

    if ($i < $content_count) {
        ... do something with $stockcontentex[$i] ...
    }
  } 
```

当然，如果您知道所有三个数组的大小相同，则可以跳过`max()`and 条件。

# variables - x86 程序集 - masm32：如何创建一个空字符串变量以将输入传输到并打印

> ID：10678791
> 
> 赞同：0
> 
> 时间：2012-05-21T02:05:28.963
> 
> 标签：variables, assembly, x86, masm, masm32

我想创建一个接受输入并打印出结果的程序，但我无法创建一个可以接受字符串输入的空变量。这就是我的意思：

```
.data 
        emptyvar db ???? ; I don't know what to do here
.data? 
        buffer dd 100 dup(?)
.code
start:
        lea eax, buffer
        push eax
        call StdIn ; get input
        ; NOW HERE IS WHAT I DON'T KNOW WHAT TO DO:
        ; I know have input, what I want to do is print that result. But where 
        ; do I store the input and how do I print the result? 
```

我知道我可以将一个整数存储在一个空变量中，并且可以打印它，但是如何创建一个空字符串变量呢？

任何帮助将不胜感激，

问候，

程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:17:38.037

```
.386
.model flat,stdcall
option casemap:none

include     \masm32\include\windows.inc
include     \masm32\include\kernel32.inc
include     \masm32\include\masm32.inc
includelib  \masm32\lib\kernel32.lib
includelib  \masm32\lib\masm32.lib

.data
msg1 db 'Please type your name',13,10,0
msg2 db 'Nice to see you ',0

.data?
buffer db 100 dup(?)
.code

start:
invoke StdOut,ADDR msg1
invoke StdIn,ADDR buffer,100 ; receive text input
invoke StdOut,ADDR msg2
invoke StdOut,ADDR buffer
invoke ExitProcess,0
END start 
```

# java - 如何使用 Apache Commons Net 通过 IMAP 获取电子邮件？

> ID：10678794
> 
> 赞同：1
> 
> 时间：2012-05-21T02:06:20.320
> 
> 标签：java, imap, apache-commons-net

我已成功连接并登录到 IMAP 服务器，可以使用 IMAP fetch 命令检索电子邮件列表。但是，当我尝试检索一封带有完整标题的电子邮件时，我最终遇到了问题。

这是我得到的堆栈跟踪：

```
Exception in thread "main" org.apache.commons.net.MalformedServerReplyException: Received unexpected IMAP protocol response from server: 'Return-Path: <[removed]>'.
at org.apache.commons.net.imap.IMAPReply.getReplyCode(IMAPReply.java:128)
at org.apache.commons.net.imap.IMAPReply.getReplyCode(IMAPReply.java:93)
at org.apache.commons.net.imap.IMAP.__getReply(IMAP.java:120)
at org.apache.commons.net.imap.IMAP.__getReply(IMAP.java:90)
at org.apache.commons.net.imap.IMAP.sendCommandWithID(IMAP.java:225)
at org.apache.commons.net.imap.IMAP.sendCommand(IMAP.java:238)
at org.apache.commons.net.imap.IMAP.sendCommand(IMAP.java:263)
at org.apache.commons.net.imap.IMAP.doCommand(IMAP.java:276)
at org.apache.commons.net.imap.IMAPClient.fetch(IMAPClient.java:339) 
```

我生成上述堆栈跟踪的代码是：

```
public static void main(String[] args) throws Exception {
    IMAPClient client = new IMAPClient();
    client.connect(SERVER);
    client.login(USERNAME, PASSWORD);
    client.select("INBOX");
    client.fetch("1", "body[header]");
} 
```

我正在使用 commons-net-3.1

当我通过 telnet 连接到 IMAP 服务器并发出相同的命令时，我最终得到这样的结果（我用下划线省略了一些数据）：

```
08 fetch 1 body[header]
* 1 FETCH (BODY[HEADER] {608}
Return-Path: <____@____.com>
X-Original-To: ____@____.com
Delivered-To: ____@____.com
Received: from ____.____.com (unknown [____])
    by ____.____.____ (Postfix) with ESMTP id 1926514D20
    for <____@____.com>; Mon,  1 Feb 2010 16:52:36 +1100 (EST)
Date: Mon, 1 Feb 2010 16:52:35 +1100 (EST)
From: ____@____.com
To: ____@____.com
Message-ID: <__________________________@_____>
Subject: ____
MIME-Version: 1.0
Content-Type: multipart/mixed; 
    boundary="----=_Part_13575_1460176524.1265003555921"

)
* 79690 EXISTS
* 13 RECENT
08 OK Fetch completed. 
```

我是否使用正确的方法（获取）来查看电子邮件？关于我哪里出错的任何线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:43:20.897

这是 fetch 的正确用法（根据邮件列表）。这是commons-net中的一个错误。

[https://issues.apache.org/jira/browse/NET-467](https://issues.apache.org/jira/browse/NET-467)

# android - Android：无法通过 GPRS/3G 在 android 设备上通过 jdbc 连接到 postgresql 服务器，但通过 Wi-Fi 可以

> ID：10678795
> 
> 赞同：1
> 
> 时间：2012-05-21T02:06:45.680
> 
> 标签：android, jdbc, wifi, 3g, gprs

大家。我有一个问题，不知道为什么会这样。我真的需要帮助。

问题是我无法通过我的android设备上的GPRS通过jdbc连接到postgresql服务器，而通过Wi-Fi一切正常。我使用了这个 - “https://play.google.com/store/apps/details?id=com.alexd.portscanner”，它表明服务器的 IP 无法通过 GPRS 访问，但可以通过 Wi-Fi 访问。但是 GPRS 在浏览器中运行良好。

可能问题与 jdbc 无关，因此欢迎提出任何建议。我是新手，所以请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:20:41.470

IP 地址可能可以访问，但 Postgres 正在侦听的端口可能无法访问（它可能被阻止）。如果在您的服务器上没有使用这些端口（即，像 Apache 这样的 Web 服务器），您可以尝试将 Posgres 侦听的端口更改为 80 或 443，然后在 JDBC 连接字符串中指定它。这可能会起作用，但通过移动连接使用 JDBC 可能不是最好的主意。为您的数据构建一个简单的 Web 前端，并使用 HTTP 从/向您的应用程序发送接收数据。

# java - 授予权限 java.lang.RuntimePermission 修改线程

> ID：10678796
> 
> 赞同：2
> 
> 时间：2012-05-21T02:06:49.987
> 
> 标签：java, multithreading, security

如何授予权限`java.lang.RuntimePermission "modifyThread";`

我尝试在中进行编辑`C:\ede-5.1.1\java6-ibm-sr4ifx3-2009-06-22\jre\lib\security` `under java.policy`但是当我在编辑后启动我的应用程序时，我仍然遇到与以前相同的错误。修改 java.policy 后我还有什么需要做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:36:38.047

通常选择使用 SecurityManager 执行的程序使用自定义策略文件。这通常在命令行中指定。如果是这样，那么您应该正在编辑该文件。

另外，您说您编辑了文件，但没有说明您如何修改它。

# clojure - 定义约简元偏函数

> ID：10678798
> 
> 赞同：8
> 
> 时间：2012-05-21T02:07:38.247
> 
> 标签：clojure, functional-programming, lisp

我有时发现在 Clojure 中定义返回部分函数的简化的 arity 版本的函数很方便，例如

```
(defn prefix 
  ([pre string] 
    (str pre ":" string))

  ([pre] 
    (fn [string]
      (prefix pre string)))) 
```

这意味着您可以执行以下任一操作：

```
(prefix "foo" 78979)
=> "foo:78979"

((prefix "foo") 78979)
=> "foo:78979" 
```

这看起来很像 Haskell 并且避免了`partial`创建部分函数的需要。

但它是否被认为是 Lisp 中良好的编码风格/API 设计？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T04:04:02.963

用于创建柯里`partial`化函数基于**Explicit 的概念更好**（在大多数情况下:)）。而且我发现这个概念在动态类型语言（如 Clojure、Python 等）中更适用/使用，可能是因为缺少类型签名/静态类型，让事情变得明确更有意义。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-21T08:45:06.113

在默认情况下对函数进行柯里化的语言中，函数调用也会被柯里化。当一个人写作 `(f a b c)`时，语言将其解释为`(((f a) b) c)`. 在 Clojure 中并非如此。

我相信在默认情况下调用不进行柯里化的环境中制作柯里化函数会产生概念上的不匹配——这种结构可能会导致读者混淆（我的意思是人类读者的代码。）

如果你的函数有超过 2 个参数，定义很快就会变得丑陋。假设一个函数有 4 个参数。要完全模拟柯里化调用，您需要处理一些情况，例如`((f a b) c d)`有人先传递 2 个参数，然后传递其余两个参数。在这种情况下，双参数函数的重载版本需要返回一个重载函数，该函数的行为取决于它是获取 1 个参数还是 2 个参数。我想有可能用宏来自动化，但仍然如此。

此外，您消除了定义默认参数和`& rest`构造的可能性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-21T02:28:05.397

嗯......就个人而言，我宁愿看到`partial`，因为这清楚地说明了发生了什么。

我不知道它是“好”还是“坏”的编码风格，但我以前从未在现有的 Clojure 代码中看到过这种风格，我可以想象使用 API 的人会期望两者`(prefix "foo" 78979)`并`(prefix "foo")`返回相同类型的对象.

为了使两个功能之间的区别清晰，您可以执行以下操作：

```
(defn prefix [pre string]
  (str pre ":" string))

(defn prefix-fn [pre]
  (fn [string]
    (prefix pre string)))

(prefix "foo" 78979)      ; => "foo:78979"
((prefix-fn "foo") 78979) ; => "foo:78979" 
```

# asp.net - 我们可以创建带有方向的静态谷歌地图吗

> ID：10678801
> 
> 赞同：0
> 
> 时间：2012-05-21T02:08:12.793
> 
> 标签：asp.net, google-maps

我想问一下我们是否可以创建带有方向的静态谷歌地图，并在邮件正文中发送带有该图像的电子邮件以及方向步骤。谢谢你。

更多信息：这将在 asp.net 中编码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T08:45:29.873

用您想要的值替换`origin`和`destination`值，渲染

```
<!DOCTYPE html>
<html> 
<head> 
   <meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
   <title>Google Maps API v3 Directions Example</title> 
   <script type="text/javascript" 
           src="http://maps.google.com/maps/api/js?sensor=false&language=de"></script>
</head> 
<body style="font-family: Arial; font-size: 12px;"> 
   <div style="width: 600px;">
     <div id="map" style="width: 400px; height: 400px; float: left;"></div> 
     <div id="panel" style="width: 400px; float: left;"></div> 
   </div>

   <script type="text/javascript"> 

     var directionsService = new google.maps.DirectionsService();
     var directionsDisplay = new google.maps.DirectionsRenderer();

     var map = new google.maps.Map(document.getElementById('map'), {
       zoom:7,
       mapTypeId: google.maps.MapTypeId.ROADMAP
     });

     directionsDisplay.setMap(map);
     directionsDisplay.setPanel(document.getElementById('panel'));

     var request = {
       origin: 'Im Soll 43d, Hamburg', 
       destination: 'Albada 13, Cala Llombards, Mallorca',
       travelMode: google.maps.DirectionsTravelMode.DRIVING
     };

     directionsService.route(request, function(response, status) {
       if (status == google.maps.DirectionsStatus.OK) {
         directionsDisplay.setDirections(response);
       }
     });
   </script> 
</body> 
</html> 
```

在后台，从渲染的画布制作 PDF，邮寄 PDF。

# javascript - 防止多个 JQuery 脚本破坏代码

> ID：10678809
> 
> 赞同：0
> 
> 时间：2012-05-21T02:09:47.277
> 
> 标签：javascript, jquery

这两个脚本都需要使用 jQuery 库，但它们相互覆盖。如何让 2 个或多个使用同一库的 jQuery/Javascript 代码同时运行？我正在尝试让 script.js 和 youtube js 都能正常工作。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/redmond/jquery-ui.css"
rel="stylesheet" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery.youtubepopup.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("a.youtube").YouTubePopup({
            autoplay: 1,
            draggable: true,
            hideTitleBar: true
        });
    });
</script> 
```

我试过插入 noConflict，但这会破坏两者。

```
<script type="text/javascript">
    $.noConflict();
    jQuery(function () {
        jQuery("a.youtube").YouTubePopup({
            autoplay: 1,
            draggable: true,
            hideTitleBar: true
        });
    });
</script> 
```

我是一名设计师，通过反复试验找出 javascript，所以希望有人能解释我做错了什么。谢谢！

编辑：这是 script.js 文件

```
$(function () {
    function filterPath(string) {
        return string.replace(/^\//, '').replace(/(index|default).[a-zA-Z]{3,4}$/, '').replace(/\/$/, '');
    }
    var locationPath = filterPath(location.pathname);
    var scrollElem = scrollableElement('html', 'body');
    // Any links with hash tags in them (can't do ^= because of fully qualified URL potential)
    $('a[href*=#]').each(function () {
        // Ensure it's a same-page link
        var thisPath = filterPath(this.pathname) || locationPath;
        if (locationPath == thisPath && (location.hostname == this.hostname || !this.hostname) && this.hash.replace(/#/, '')) {
            // Ensure target exists
            var $target = $(this.hash),
                target = this.hash;
            if (target) {
                // Find location of target
                var targetOffset = $target.offset().top;
                $(this).click(function (event) {
                    // Prevent jump-down
                    event.preventDefault();
                    // Animate to target
                    $(scrollElem).animate({
                        scrollTop: targetOffset
                    }, 400, function () {
                        // Set hash in URL after animation successful
                        location.hash = target;
                    });
                });
            }
        }
    });
    // Use the first element that is "scrollable"  (cross-browser fix?)
    function scrollableElement(els) {
        for (var i = 0, argLength = arguments.length; i < argLength; i++) {
            var el = arguments[i],
                $scrollElement = $(el);
            if ($scrollElement.scrollTop() > 0) {
                return el;
            } else {
                $scrollElement.scrollTop(1);
                var isScrollable = $scrollElement.scrollTop() > 0;
                $scrollElement.scrollTop(0);
                if (isScrollable) {
                    return el;
                }
            }
        }
        return [];
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:18:32.920

据我所知，除非您在页面中有另一个您没有告诉我们的库（如 dojo 或 mootools），否则 noConflict 无济于事。订单肯定有问题。在你的脚本和 css 中总是有这个顺序：

*   外部风格
*   页内样式
*   脚本库
*   脚本插件
*   外部用户脚本
*   页内用户脚本

所以（为清楚起见缩短了网址）：

```
<link rel="stylesheet" type="text/css" href="jquery-ui.css" />
<script src="jquery.min.js"></script>
<script src="jquery-ui.min.js"></script>
<script src="jquery.youtubepopup.min.js"></script>
<script src="script.js"></script>
<script>
    $(function () {
        $("a.youtube").YouTubePopup({
            autoplay: 1,
            draggable: true,
            hideTitleBar: true
        });
    });
</script> 
```

或者，必须有一些东西阻止在`script.js`. [尝试使用JSLint](http://www.jslint.com/)验证脚本以检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:18:04.887

如果您确定另一个库也将使用 jQuery 的`$`符号，这样做可能会有所帮助：

```
<!--jQuery-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<!--jQuery UI-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
<!--A jQuery plugin-->
<script type="text/javascript" src="js/jquery.youtubepopup.min.js"></script>
<script type="text/javascript">
    $.noConflict();    //Relinquish $
</script>
<!--Another library-->
<script type="text/javascript" src="js/script.js"></script>

<!--Do stuff here-->
<script type="text/javascript">
    jQuery(function() {
        jQuery("a.youtube").YouTubePopup({
            autoplay: 1,
            draggable: true,
            hideTitleBar: true
        });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T00:09:54.463

解决了！

按照 Joseph 的指示，我将 script.js 移到了页内用户脚本下方，因此 youtube 工作所需的 2 个脚本组合在一起。

```
<link rel="stylesheet" type="text/css" href="jquery-ui.css" />
<script src="jquery.min.js"></script>
<script src="jquery-ui.min.js"></script>
<script src="jquery.youtubepopup.min.js"></script>
<script>
$(function () {
    $("a.youtube").YouTubePopup({
        autoplay: 1,
        draggable: true,
        hideTitleBar: true
    });
});
<script src="script.js"></script>
</script> 
```

感谢大家！

# android - Phonegap 在第二次启动时以某种方式破坏了应用程序

> ID：10678810
> 
> 赞同：0
> 
> 时间：2012-05-21T02:09:57.710
> 
> 标签：android, cordova

我有 android Phonegap 应用程序，简单的列表视图。当我第一次启动它时，用户界面似乎还可以，图像已加载。但是当我退出并再次启动它时 - 用户界面一团糟，图像不会被加载。所以我需要重新启动设备来修复它。我的问题是 - 如果 Phonegap 缓存应用程序数据，有没有办法禁用此缓存并在退出时清除加载的数据？

UPD：我使用 Cordova 1.7.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T09:43:56.420

您是否使用 Javascript 设置尺寸？如果是这样，尺寸并不总是在通过标题部分加载的 javascript 上设置 - 它们在某些 Android 版本上有所延迟。您可能需要限制初始化应用程序尺寸。

# qt - CMake 重新编译

> ID：10678815
> 
> 赞同：1
> 
> 时间：2012-05-21T02:11:00.100
> 
> 标签：qt, cmake, qt-creator

如果我更改了源文件目录的名称，cmake 是否会重新编译整个项目源代码？

PS我试过了，不幸的是QtCreator重新编译了整个源代码，它是QtCreator特有的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:42:38.920

Qtcreator 创建一个名称相对于您的项目或文件夹本身的构建目录作为目标构建目录。因此，如果您重命名文件夹名称并使用 Qtcreator 打开它，它将构建到相对于您的文件夹名称的新构建目录，前提是您已经清理了旧源。否则它将占用先前生成的 moc 文件和 .o 文件。

# c# - Nunit 可以测试 Stylecop 自定义规则吗？

> ID：10678816
> 
> 赞同：2
> 
> 时间：2012-05-21T02:11:19.690
> 
> 标签：c#, nunit, stylecop

Nunit V2.6 可以测试 Stylecop 自定义规则吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:11:18.087

如果您谈论的是您自己创建的规则，我会说您不能，因为自定义 StyleCop 规则依赖于外部资源：XML 配置文件。如果[测试依赖于文件系统，那么它就不再是单元测试](http://artofunittesting.com/definition-of-a-unit-test/)了。但是，使用[此链接](http://blog.drorhelper.com/2010/07/unit-testing-custom-stylecop-rules.html)，您应该能够使用 MS 测试而不是 NUnit 来接近单元测试的内容。但我宁愿推荐这种开发的集成测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T03:28:40.983

*我的答案依赖于 MS 测试而不是 NUnit。如果您有 TFS，那么转换非常简单，否则 Guillaume 的回答似乎是合理的。*

**我的一个朋友（一个 ASP.Net MVP）在这方面做了一些了不起的工作（我将总结互联网历史的代码，但必须将荣誉归功于 Tatham Oddie）： [VS2010 中的自定义代码分析规则（以及如何使它们在FxCop 和 VS2008 也是）](http://blog.tatham.oddie.com.au/2010/01/06/custom-code-analysis-rules-in-vs2010-and-how-to-make-them-run-in-fxcop-and-vs2008-too/)**

**最好阅读这篇文章，有很多漂亮的图片可以帮助您跟进。**如果文章不可用并且不再在互联网缓存中，请使用以下方法：

1.  从一个新的类库项目开始。确保选择以“.NET Framework 4”为目标</p>

2.  添加对 FxCopSdk.dll、Microsoft.Cci.dll 和 Microsoft.VisualStudio.CodeAnalysis.dll 的引用。您通常会在 C:\Program Files (x86)\Microsoft Visual Studio 10.0\Team Tools\Static Analysis Tools\FxCop 中找到这些

3.  将一个名为 Rules.xml 的新 XML 文件添加到您的项目中。这将是一个描述我们每个单独规则的清单文件。为了让我们开始，请粘贴以下内容：

* * *

```
<?xml version="1.0" encoding="utf-8" ?>
<Rules FriendlyName="My Custom Rules">
  <Rule TypeName="AllTypeNamesShouldEndInFoo" Category="CustomRules.Naming" CheckId="CR1000">
    <Name>All type names should end in 'Foo'</Name>
    <Description>I like all of my types to end in 'Foo' so that I know they're a type.</Description>
    <Url>http://foobar.com</Url>
    <Resolution>The name of type {0} does not end with the suffix 'Foo'. Add the suffix to the type name.</Resolution>
    <MessageLevel Certainty="95">Warning</MessageLevel>
    <FixCategories>Breaking</FixCategories>
    <Email />
    <Owner />
  </Rule>
</Rules> 
```

* * *

1.  转到 XML 文件的属性并将 Build Action 更改为 EmbeddedResource，以便将其编译到我们的 DLL 中。

2.  创建一个名为 BaseRule 的类并粘贴以下代码：

* * *

```
using Microsoft.FxCop.Sdk;

public abstract class BaseRule : BaseIntrospectionRule
{
    protected BaseRule(string name)
        : base(

            // The name of the rule (must match exactly to an entry
            // in the manifest XML)
            name,

            // The name of the manifest XML file, qualified with the
            // namespace and missing the extension
            typeof(BaseRule).Assembly.GetName().Name + ".Rules",

            // The assembly to find the manifest XML in
            typeof(BaseRule).Assembly)
    {
    }
} 
```

* * *

1.  创建一个名为 AllTypeNamesShouldEndInFoo 的类并粘贴以下存根代码：

* * *

```
public override ProblemCollection Check(TypeNode type)
{
    if (!type.Name.Name.EndsWith("Foo", StringComparison.Ordinal))
    {
        var resolution = GetResolution(type.Name.Name);
        var problem = new Problem(resolution, type)
                          {
                              Certainty = 100,
                              FixCategory = FixCategories.Breaking,
                              MessageLevel = MessageLevel.Warning
                          };
        Problems.Add(problem);
    }

    return Problems;
} 
```

1.  在您的解决方案中创建另一个名为 TestLibrary 的类库。我们不会在这里放任何真正的代码——我们只是将它用作库来执行我们的规则。

2.  将新的代码分析规则集文件添加到项目中

3.  当文件在设计器中打开时，您将看到所有内置规则的列表。因为还没有真正支持自定义规则，所以没有很好的方法将我们自己的规则添加到这个列表中。

4.  在解决方案资源管理器中，右键单击 .ruleset 文件，选择打开方式并从选项中选择 XML 编辑器。这将向您显示文件的原始内容，这目前很无聊。要将 Visual Studio 指向自定义规则的方向，然后添加一系列提示路径。

这是规则集 XML 的样子：

```
<?xml version="1.0" encoding="utf-8"?>
<RuleSet Name="New Rule Set" Description="" ToolsVersion="10.0">
  <RuleHintPaths>
    <Path>C:\Temp\CARules\BlogDemo\BlogDemo.CodeAnalysisRules\bin\Debug</Path>
  </RuleHintPaths>
</RuleSet> 
```

1.  确保您已编译规则项目，然后返回解决方案资源管理器，右键单击 .ruleset 文件，选择打开方式并选择代码分析规则集编辑器。

2.  现在，您应该会看到您的自定义规则已加载到列表中。

# php - 关于xdebug的idekey和xdebug_session

> ID：10678817
> 
> 赞同：1
> 
> 时间：2012-05-21T02:11:31.707
> 
> 标签：php, xdebug

xdebug 有两个参数：idekey 和 xdebug_session。我想知道这两者有什么区别？

看来两者是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T08:10:08.023

XDEBUG_SESSION cookie 的值根据 idekey 的设置进行设置。当调试会话未启用时，XDEBUG_SESSION 不存在，因为 idekey 应该始终存在。

# php - 在 PHP 中使用 $_POST 提交值

> ID：10678818
> 
> 赞同：0
> 
> 时间：2012-05-21T02:11:33.793
> 
> 标签：php

我有一个表单，其中包含通过循环动态生成的字段。这是一对字段：姓名/电子邮件。循环为每个值生成两个输入字段。总是有一封电子邮件，而名称有时可能是空白的。

```
<div>
    <input type="text" name="name['.$i.']" value="'.$output['0'].'">
    <input type="text" name="email['.$i.']" value="'.$output['1'].'"> 
</div> 
```

我知道 $_POST 会生成一个数组，如下所示：

```
Array ( [name] => Array ( [1] => Fname Lname [2] => ) [email] => Array ( [1] => abc@email.com [2] => abc@gmail.com ) ) 
```

提交此表单后，如何将值放入我的数据库表中？很难用两个字段来可视化这个循环......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:20:05.770

> 很难用两个字段来可视化这个循环

您必须选择其中一个字段作为循环的参考：

```
$names = $_POST['name'];
foreach($names as $key=>$name) {
    // $name is already defined. Define further fields based on $key
    $email = $_POST['email'][$key];
    // DB logic goes here. Do not forget to sanitize your inputs!
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:18:06.743

```
<?php
foreach($_POST as $key => $val)
{
    ...
}
?> 
```

# ruby-on-rails - Omniauth 与 facebook 令牌

> ID：10678819
> 
> 赞同：0
> 
> 时间：2012-05-21T02:11:50.937
> 
> 标签：ruby-on-rails, facebook, omniauth, access-token

我有一个问题，我使用omniauth 向Facebook 验证我的用户。我通过 gem 'omniauth-facebook' 获取他们的访问令牌并将其保存在数据库中，我想问我请求的访问令牌是否始终有效？因为目前我没有遇到任何令牌过期，对此有什么解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:21:54.930

现在你会没事的，但[在 7 月 5 日之后](https://developers.facebook.com/roadmap/offline-access-removal/)，你将不得不处理即将到期的代币。这可能意味着处理 FB 发回的过期令牌错误，并中断您网站上的用户体验以让他们重新批准新令牌。

# ruby - 两个字符串的正则表达式格式

> ID：10678823
> 
> 赞同：2
> 
> 时间：2012-05-21T02:12:14.103
> 
> 标签：ruby, regex

我想要一个正则表达式来提取快乐和好这两个词，既不贪婪又不区分大小写。

```
@a = [" I am very HAppy!!", "sad today..", "happy. to hear about this..", "the day is good", "sad one", "sad story"] 
```

看起来这与一个词一起工作：

```
@z = @a.join.scan(/\bhappy\b/i) 
```

但是当我添加好的时候，它并没有像我预期的那样工作。

```
@z = @a.join.scan(/\bhappy|good\b/i) 
```

期望（快乐 2x 和好 1x）：

```
@z.size => 3 
```

它给我的结果：

```
@z.size => 2 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T02:32:17.373

您应该在您的交替周围添加括号，以便`\b`s 将适用于其中一个`happy`或`good`作为一个单位：

```
\b(happy|good)\b 
```

然后，您可能想要扫描`@a`数组的每个元素，而不是[`@a.join`](https://ruby-doc.org/core/Array.html#method-i-join)这样 a[`map`](https://ruby-doc.org/core/Array.html#method-i-map)并被[`flatten`](https://ruby-doc.org/core/Array.html#method-i-flatten)要求：

```
@a.map { |s| s.scan(/\b(happy|good)\b/i) }.flatten
# ["HAppy", "happy", "good"] 
```

您还可以使用非捕获组：

```
\b(?:happy|good)\b 
```

但在这种情况下不会有任何区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:31:28.280

我假设你的意思是它匹配两个快乐，但不好。这是因为您正在查看单词边界，并且当您加入字符串时，它变成了goodsad。

删除单词边界条件，它应该符合预期。

# php - 用于在括号前获取单词的正则表达式

> ID：10678824
> 
> 赞同：1
> 
> 时间：2012-05-21T02:12:18.307
> 
> 标签：php, regex

我有各种包含不同信息的字符串，但它们都有一个共同特征：它们包含请求者的用户名，后面有括号。类似的东西：`"... paul [55] ..."`我正在尝试编写一个正则表达式，它能够在我之前提取单词`[dd]`

这是我到目前为止所拥有的：`"/(?P<user>\w+)\s\[\d\d\]/"`但这仅在字符串以用户开头时才有效，例如`"paul [55] has logged in"`但它在案例，`"user paul [55] has logged off"`

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:19:51.003

尝试使用[*积极的前瞻断言*](http://php-regex.blogspot.com/)：

```
(\w+)(?=\s?\[\d\d\]) 
```

仅当此表达式后跟可选空格和方括号中的两位十进制数时，此表达式才匹配一个或多个单词字符。

# javascript - jQuery返回所有数组

> ID：10678840
> 
> 赞同：-3
> 
> 时间：2012-05-21T02:17:14.543
> 
> 标签：javascript, jquery, arrays

如何在函数之外获取数组的所有内容？

```
 $.each(Basepath.Templates, function(i){
     templateArray = new Array({title: Basepath.Templates[i].Template.name, src: 'view/'+Basepath.Templates[i].Template.id, description: Basepath.Templates[i].Template.name});
});

console.log(templateArray); //contains only one array; 
```

**编辑：**

这是我想要的输出

```
templateArray[
    {
        title: "one",
        src: "view/1",
        description: "Descrption 1"
    },
    {
        title: "two",
        src: "view/2",
        description: "Descrption 2"
    },
    {
        title: "one",
        src: "view/3",
        description: "Descrption 3"
    }
] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:19:39.970

尝试在调用之前为数组设置变量，`.each()`并在每次迭代时添加到数组中。

```
var templateArray = [];
$.each(Basepath.Templates, function(i){
    templateArray.push({title: Basepath.Templates[i].Template.name, src: 'view/'+Basepath.Templates[i].Template.id, description: Basepath.Templates[i].Template.name});
});

console.log(templateArray); //should work 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T02:32:33.367

您`templateArray`在每次迭代中都覆盖。尝试[`.map()`](http://api.jquery.com/jQuery.map/)代替`each()`：

```
var templateArray = $.map(Basepath.Templates, function(tpl, i){
    return {
        title: tpl.Template.name,
        src: 'view/'+tpl.Template.id,
        description: tpl.Template.name
    };
});
console.log(templateArray); // now is only one array, containing template objects; 
```

# python - 从值数组评估 sympy 表达式

> ID：10678843
> 
> 赞同：38
> 
> 时间：2012-05-21T02:17:47.033
> 
> 标签：python, scipy, sympy

我正在尝试 sympy，但遇到了一个我无法解决的问题。

使用 scipy，我可以编写一个表达式并为 x 值数组评估它，如下所示：

```
import scipy
xvals = scipy.arange(-100,100,0.1)
f = lambda x: x**2
f(xvals) 
```

使用 sympy 我可以编写如下相同的表达式：

```
import sympy
x = sympy.symbols('x')
g = x**2 
```

我可以通过执行以下操作来评估此表达式的单个值：

```
g.evalf(subs={x:10}) 
```

但是我不知道如何评估它的 x 值数组，就像我对 scipy 所做的那样。我该怎么做？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-21T10:55:21.380

首先，目前 SymPy 不保证支持 numpy 数组，这是您在这种情况下想要的。检查此错误报告[http://code.google.com/p/sympy/issues/detail?id=537](http://code.google.com/p/sympy/issues/detail?id=537)

其次，如果您想对*许多*值进行数值评估，SymPy 不是最佳选择（毕竟它是一个符号库）。使用 numpy 和 scipy。

但是，以数字方式评估某事物的一个正当理由是推导要评估的表达式很困难，因此您在 SymPy 中推导它，然后在 NumPy/SciPy/C/Fortran 中对其进行评估。要将表达式转换为 numpy，只需使用

```
from sympy.utilities.lambdify import lambdify
func = lambdify(x, big_expression_containing_x,'numpy') # returns a numpy-ready function
numpy_array_of_results = func(numpy_array_of_arguments) 
```

查看 lambdify 的文档字符串以获取更多详细信息。请注意，lambdify 仍然存在一些问题，可能需要重写。

**顺便说**一句，如果您想多次评估表达式，您可以使用 sympy 中的 codegen/autowrap 模块来创建包装和可从 python 调用的 fortran 或 C 代码。

编辑：可以在 wiki [https://github.com/sympy/sympy/wiki/Philosophy-of-Numerics-and-Code-Generation-in-SymPy上找到在 SymPy 中执行数字的方法的更新列表](https://github.com/sympy/sympy/wiki/Philosophy-of-Numerics-and-Code-Generation-in-SymPy)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-10T07:43:51.580

虽然[接受的答案](https://stackoverflow.com/a/10683911/321973)清楚地表明 OP 正在寻找*数值*评估，但我仍然要指出，人们也可以通过使用进行*符号*评估`symarray`：

```
import sympy
xs = sympy.symarray('x', 10)
f = lambda x: x**2
f(xs) 
```

产量

```
array([x_0**2, x_1**2, x_2**2, x_3**2, x_4**2, x_5**2, x_6**2, x_7**2,
       x_8**2, x_9**2], dtype=object) 
```

请注意，这也在`numpy`内部使用了一个数组，但其中充满了`sympy.Expr`essions。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-10T15:13:58.463

或者你可以通过 numpy.vectorize 来实现。我正在使用`x`,`g`和`xvals`来自问题主体。

```
scalar_func = lambda xx: float(g.evalf(subs={x: xx}))
vector_func = numpy.vectorize(scalar_func)
vector_func(xvals) # returns a numpy array [10000.0, 9980.01, 9960.04, ...] 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-05-21T05:26:51.443

尝试

```
import sympy
x = sympy.symbols('x')
f = lambda x: x**2
print [f(k) for k in range(4)] 
```

或者你也可以试试

```
g = x**2
print [g.subs(x,k) for k in range(4)] 
```

# php - 用外键填充表

> ID：10678844
> 
> 赞同：0
> 
> 时间：2012-05-21T02:17:59.283
> 
> 标签：php, mysql

我有这样的架构

```
CREATE TABLE TrainManager(
    train_name    VARCHAR(5) REFERENCES Train(name),
    station_id      INT REFERENCES Station(station_id)
); 
```

这两个参考表具有间接关系。

> 控制（ctrl_id，train_name）；
> 
> controlremote (ctrl_id, station_id);

如您所见，为了得到`train name`and ，除了比较 train_name 和 station_id 之外`station id`，我们还需要进入其他两个表进行比较。`ctrl_id`

```
$query = "INSERT INTO `train` (train_name, station_id)
    SELECT t.train_name, st.station_id
    FROM train, station
    WHERE t.train_name = ( SELECT c.train_name FROM control c
                           WHERE c.train_name = t.train_name)
            AND
          st.station_id = ( SELECT cr.station_id FROM controlremote cr
                            WHERE cr.station_id = st.station_id)
            AND 
```

但我想不出一个合适的 SQL 语法来比较 ctrl_id ...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:31:07.637

```
INSERT INTO `train` (train_name, station_id)
SELECT control.train_name, controlremote.station_id
FROM control
LEFT JOIN controlremote ON control.ctrl_id = controlremote.ctrl_id 
```

一路走来的东西。只需加入两个表`ctrl_id`。我希望我理解正确。

# java - 河内塔比 O(2^n) 更好？

> ID：10678850
> 
> 赞同：8
> 
> 时间：2012-05-21T02:18:14.917
> 
> 标签：java, algorithm, towers-of-hanoi

是否有运行时间小于 O(2 ^(*n*) ) 的河内塔的解决方案，其中*n*是要移动的磁盘数量？我的解决方案需要 O(2 ^(*n*) ) 时间。

此外，以下解决方案是递归的。我们可以使用带有记忆概念的动态编程在更短的时间内解决这个问题吗？

```
public void towersOfHanoi(
        int num, 
        MyStack<Integer> from,
        MyStack<Integer> to, 
        MyStack<Integer> spare
) {
    if (num == 1) {
        int i = from.pop();
        to.push(i);
        System.out.println("Move "+i+" from "+from.getName()+" to " + to.getName());
        return;
    }
    towersOfHanoi(num - 1, from, spare, to);
    towersOfHanoi(1, from, to, spare);
    towersOfHanoi(num - 1, spare, to, from);
} 
```

`MyStack``Stack`是Java中类的扩展版本，它添加了`name`字段和访问器。

另外，同一个问题是否有任何变化？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-21T02:19:28.113

鉴于求解河内塔总是需要 2^n - 1 步......不，你不会找到更快的算法，因为打印出步骤需要 O(2^n)，更不用说计算它们了.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-21T04:54:11.067

我不会证明（如斯蒂芬所做的那样），但我会尝试直观地解释 2^n-1 是最小值：在每个状态下，磁盘只有三种可能的移动。让我们将当前状态表示为有序 seq (1, 1, .. , 1)，这样第一个数字表示较大的磁盘在哪里，最后一个数字表示最小的磁盘在哪里。(1, 1, .., 1) 表示所有磁盘都在位置 1 上。同样从 (1, 1, ..1) 开始只有两种下降状态：(1, 1, ... 2) 和 ( 1, 1, .... 3)。从 (1, 1, ... 2) 有三个下降状态：

1.  返回 (1, 1, .. 1)
2.  转到 (1, 1, ..., 3)
3.  转到 (1, 1,...3, 2)

如果继续，您将获得节点是可能状态且边（转换）是“磁盘移动”的图形。

您将获得如下所示的图像（如果继续，它将看起来像三角形，顶点将是 (1, 1, ...1), (2, 2, ..2), (3, 3, . ..3))。步数实际上就是图中的路径。

如果沿着三角形的边走，2^n-1的步数。所有其他路径的长度相同或更长。

![在此处输入图像描述](../Images/80fddd3354e7cd3b248402e8e185eec4.png)

如果使用策略：将除最大的磁盘之外的所有磁盘移动到位置 3，然后将大的磁盘移动到位置 2，最后将所有表格 3 移动到 2，公式可以设计如下：

f(n) =
f(n -1) // 将除了最大的从 1 移到 3
+ 1 // 将最大的从 1 移到 2
+ f(n -1) // 将所有从 3 移到 2
->
f( n) = 1+ 2 * f(n-1)

该循环方程的解为您提供该策略所需的步数（恰好是最小步数）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-12T18:37:29.030

河内塔的解决方案不可避免地是 2 ^n。然而，在动态规划解决方案中，每个子问题只计算一次，然后通过组合第一个子问题解决方案、当前磁盘移动和第二个子问题解决方案来解决问题。

因此，生成每个解决方案有两个组件：为当前解决方案分配内存，然后填充该内存。内存分配大约与分配的内存大小无关，并且是昂贵的组件。内存复制与复制的内存大小呈线性关系，虽然速度很快，但作为 Towers 的解决方案，它在 n 中呈指数增长。

时间 = c [1] *n + c [2] *2 ^n，其中 c [1] >> c [2]。即，它以线性开始并以指数方式结束。

[*链接到出现在 ACM 的 SIGCSE **Inroads**杂志（2012 年 9 月）中的文章*](http://doi.acm.org/10.1145/2339055.2339070)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-25T21:46:52.137

标准的河内塔问题涉及 3 个钉子。

但是，如果我们有 k-pegs，时间复杂度将是 O(2^(n/(k-2)))。

我已经用 4 个钉子和 5 个钉子解决了这个问题，结果的时间复杂度分别为 O(2^(n/2)) 和 O(2^(n/3))

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-11-17T21:53:42.933

这个比递归的快大约 7%。它将移动存储在列表中，以便您可以在之后使用它，如果您愿意，可以打印并移除容器。

```
```
unsigned long i;  
static const int MAXNUMBEROFDISKS = 32;
vector<int> pow2Vec;
uint_fast32_t mPinFrom    = 0;
uint_fast32_t mNumDisk    = 0;
unsigned long numDiskLong = 0;
uint_fast32_t mOffset[MAXNUMBEROFDISKS];
uint_fast32_t mDir[MAXNUMBEROFDISKS]          = { 0 };
uint_fast32_t mPositionDisk[MAXNUMBEROFDISKS] = { 0 };
const uint_fast32_t mRedirectArr[5] = { 2, 0, 1, 2, 0 };

Algos::Algos()
{ 
  for (int i = 0; i < MAXNUMBEROFDISKS; ++i)
  {
    pow2Vec.push_back(pow(2, i));
    mOffset[i] = 1;
  }

  for (int i = 1; i < MAXNUMBEROFDISKS; i += 2)
  {
    mDir[i] = 2;
  }

  mOffset[0] = 0;
}

void Algos::calculListBinExperiment(vector<tuple<int, int, int>>& listeFinale, int nbDisk)
{
  listeFinale.resize(pow2Vec[nbDisk] - 1);
  _BitScanForward(&i, nbDisk);
  for (int noCoup = 1; noCoup < pow2Vec[nbDisk] ; ++noCoup)
  {
    _BitScanForward(&numDiskLong, noCoup);
    mNumDisk = numDiskLong;
    mPinFrom = mPositionDisk[mNumDisk];
    mPositionDisk[mNumDisk] = mRedirectArr[mPositionDisk[mNumDisk] + mDir[mNumDisk + 
    mOffset[i]]];
    listeFinale[noCoup - 1] = make_tuple(mNumDisk, mPinFrom, mPositionDisk[mNumDisk]);
  }
}
``` 
```

# delphi - 项目中文件的设计类属性是什么？

> ID：10678853
> 
> 赞同：5
> 
> 时间：2012-05-21T02:18:38.053
> 
> 标签：delphi, delphi-xe2

在 Delphi XE2 中，如果我在项目管理器中选择一个文件，对象检查器会显示该文件的属性。什么是“设计类”属性以及如何使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:46:38.193

“设计类”是只读属性。它显示派生对象的类名。我只在 TFrame 上看到过这个属性。

# javascript - 具有匹配输入的骨干形式插件错误

> ID：10678855
> 
> 赞同：0
> 
> 时间：2012-05-21T02:19:18.160
> 
> 标签：javascript, backbone.js

我正在尝试验证表格。当我指定默认数据来填充不匹配的表单时，而不是通过验证`commit`，我预计会记录一个错误（这是正确的）：

```
Errors: {"confirmedUsername":{"type":"match","message":"Usernames must match!"}} 
```

JsFiddle：http: [//jsfiddle.net/franklovecchio/FkNwG/173/](http://jsfiddle.net/franklovecchio/FkNwG/173/)

当我指定匹配的默认数据，然后通过验证`commit`，我得到一个实际的控制台错误：

```
Uncaught TypeError: Cannot call method 'set' of undefined 
```

JsFiddle：http: [//jsfiddle.net/franklovecchio/FkNwG/172/](http://jsfiddle.net/franklovecchio/FkNwG/172/)。

是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T05:30:27.163

从文档中弗兰克看来，你做错了。

### JSFiddle（工作）

[http://jsfiddle.net/FkNwG/176/](http://jsfiddle.net/FkNwG/176/)

### 原因

您可以在不将其绑定到模型的情况下创建表单。例如，为一个简单的数据对象创建一个表单：

```
var form = new Backbone.Form({
    data: { id: 123, name: 'Rod Kimble', password: 'cool beans' }, //Data to populate the form with
    schema: {
        id:         { type: 'Number' },
        name:       {},
        password:   { type: 'Password' }
    }
}).render(); 
```

然后代替 form.commit()，执行以下操作：

```
var data = form.getValue(); //Returns object with new form values 
```

`commit`我刚改成`getvalue()`

# javascript - 输入框中的地理编码位置

> ID：10678860
> 
> 赞同：3
> 
> 时间：2012-05-21T02:20:27.723
> 
> 标签：javascript, google-maps, geocode

我是谷歌地图的新手，只是想掌握它。我希望能够输入一个城市或地址，然后让地图加载它并放置一个标记。

现在，我的地图最初加载良好，但是当我输入城市或地址时，什么也没有发生。知道这里发生了什么吗？

```
<script type="text/javascript">
var geocoder;
var map;
  function initialize() {
    geocoder = new google.maps.Geocoder();
    var latlang = new google.maps.LatLng(42, -84);
    var myOptions = {
        center: latlang, zoom: 5, mapTypeId: google.maps.MapTypeId.SATELLITE,
        navigationControlOptions: {
            style: google.maps.NavigationControlStyle.SMALL
        }
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
  }

  function codeAddress() { 
    var sAddress = document.getElementById("newLocation").value;
    geocoder.geocode( { 'address': sAddress}, function(results, status) { 
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
                });
            }
            else{
            alert("Geocode was not successful for the following reason: " + status);
            }
        });
  }
</script>
</head>
  <body onload="initialize()">
    Address: <input type="text" id="newLocation" style=" width:200px" title="Address to Geocode" />     
    <input type="button" onclick="codeAddress()" id="inputButtonGeocode" style="width:150px" title="Click to Geocode" value="Geocode" />
    <div id="map_canvas" style="width:100%; height:100%"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:44:48.897

在行

`var map = new google.maps.Map(document.getElementById("map_canvas")...`

删除这个词`var`。因为它`map`在功能本地范围内创建，并且地理编码功能只看到先前（空）`map`变量。通过删除它，全局`map`变量将更新为这个新的谷歌地图。

# batch-file - 需要使用 Swift 处理数百个文本到 wav 的转换

> ID：10678867
> 
> 赞同：1
> 
> 时间：2012-05-21T02:21:37.140
> 
> 标签：batch-file

我拥有 Swiftalker 的许可副本，可在 cepstral.com 上获得。它是一个可以大声朗读文本的应用程序，并且可以导出为 wav。虽然它是迄今为止我在语音方面发现的最好的，但它的导出选项是有限的。

我正在做的是使用 Swiftalker 将文本转换为 wav 来学习我的建筑师执照考试。我有数百个小的单行文本文件，它们是要记住的术语。我想使用 Swiftalker 命令一次自动导出整个文件夹，而不是输入数百次代码。

Cepstral 确实提供了一个具有以下语法的命令行实用程序：

swift -n 艾莉森 -f bdcs002.txt -o bdcs002.wav

（Allison 是我购买的声音。） txt 文件是我所拥有的，Cepstral 引擎创建 wav。

该命令不接受输入 txt 文件或输出 wav 文件的通配符。它只接受确切的文件名。所以我想我需要某种 for-next 循环来重复执行上述命令，使用文件名变量？

使用该站点上的资源，我开发了下面的批处理文件，以从名为“txt”的目录中提取所需的文件名并将它们存储在文本文件中。但是我不知道如何使用上面的倒谱命令编写一个 for-next 循环来从 txt 文件创建 wav 文件。

文件提取批处理文件：

```
cd\L:\_ARE\PrepMaterials\__AudioConversionArea

set search=
setlocal enabledelayedexpansion
for /r L:\_ARE\PrepMaterials\__AudioConversionArea\txt %%g in (*) do (
if not defined search (set search=%%~nxg) else set search=!search!,%%~nxg
)
echo !search!>>FilenamesAndExensions.txt

set search2=
setlocal enabledelayedexpansion
for /r L:\_ARE\PrepMaterials\__AudioConversionArea\txt %%g in (*) do (
if not defined search (set search2=%%~ng) else set search2=!search2!,%%~ng
)
echo !search2!>>FilenamesWithoutExtensions.txt

PAUSE 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T15:37:17.293

不只是：

```
FOR /R L:\_ARE\PrepMaterials\__AudioConversionArea\txt %F IN (*.txt) DO swift -n Allison -f "%~F" -o "L:\_ARE\PrepMaterials\__AudioConversionArea\wav\%~nF.wav" 
```

?

# python - 相当于R中的python dict

> ID：10678872
> 
> 赞同：94
> 
> 时间：2012-05-21T02:22:28.457
> 
> 标签：python, r, dictionary

我想在R中制作相当于python dict的东西。基本上在python中，我有：

```
visited = {}

if atom_count not in visited:
  Do stuff
  visited[atom_count] = 1 
```

这个想法是，如果我看到具体的 atom_count，我有`visited[atom_count] = 1`. 因此，如果我再次看到那个 atom_count，那么我就不会“做事”。`Atom_Count`是一个整数。

谢谢！

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-05-21T04:21:26.590

R中最接近python dict的东西就是一个列表。像大多数 R 数据类型一样，列表可以有一个 names 属性，它可以允许列表像一组名称-值对一样工作：

```
> l <- list(a = 1,b = "foo",c = 1:5)
> l
$a
[1] 1

$b
[1] "foo"

$c
[1] 1 2 3 4 5

> l[['c']]
[1] 1 2 3 4 5
> l[['b']]
[1] "foo" 
```

现在对于通常的免责声明：它们并不*完全相同*；会有差异。因此，尝试完全按照在 python 中使用 dict 的方式使用列表，你会感到失望。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-06-05T13:23:43.107

如果像您的情况一样，您只希望“字典”存储相同类型的值，则可以简单地使用向量并命名每个元素。

```
> l <- c(a = 1, b = 7, f = 2)
> l
a b f 
1 7 2 
```

如果要访问“密钥”，请使用`names`.

```
> names(l)
[1] "a" "b" "f" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-21T05:45:06.427

我相信使用哈希表（创建新环境）可能会解决您的问题。我会输入如何执行此操作，但我昨天在talkstats.com 上才这样做。

如果您的字典很大并且只有两列，那么这可能是要走的路。这是带有示例 R 代码的 talkstats 线程的链接：

[哈希表链接](http://www.talkstats.com/showthread.php/25761-Evidence-that-data.table-isn-t-always-fastest?p=84805&viewfull=1#post84805)

# android - Android 屏幕无法关闭

> ID：10678873
> 
> 赞同：0
> 
> 时间：2012-05-21T02:22:57.350
> 
> 标签：android, android-activity, flags, android-windowmanager

我正在使用此代码在收到短信时触发。一切正常，但是当我从 AlertDialog 中单击“回复”或“关闭”时，屏幕永远不会超时，只会一直显示。我需要做些什么来让屏幕在一定时间内打开吗？

```
package package.name.here;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.ContactsContract.PhoneLookup;
import android.view.LayoutInflater;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.view.inputmethod.InputMethodManager;
import android.widget.TextView;

public class ReceivingSMSActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        this.getWindow().setFlags(
                WindowManager.LayoutParams.FLAG_FULLSCREEN |
                WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED | 
                WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON,
                WindowManager.LayoutParams.FLAG_FULLSCREEN |
                WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED |
                WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON
                );

        Intent in = this.getIntent();
        String sender = getIntent().getStringExtra("sender");
        String body = getIntent().getStringExtra("body");
        long timestamp = getIntent().getLongExtra("timestamp", 0L);
        SMSMessage msg = (SMSMessage) in.getSerializableExtra("msg");

        if (msg == null) {
            msg = new SMSMessage();
            msg.setPhone("0123456789");
            msg.setTimestamp(System.currentTimeMillis());
            msg.setBody("Sample Text Message");
        } else {
            msg = new SMSMessage();
            msg.setPhone(sender);
            msg.setTimestamp(timestamp);
            msg.setBody(body);
        }

        showDialog(msg);

    }

    private void showDialog(SMSMessage msg) {

        final String sender = msg.getPhone();
        final String body = msg.getBody();

        LayoutInflater factory = LayoutInflater.from(this);            
        final View alertView = factory.inflate(R.layout.main, null);

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setView(alertView)
        .setTitle(getContactName(sender))
        .setCancelable(false)
        .setNegativeButton("Close", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int id) {
                goHome();               
            }
        })
        .setPositiveButton("Reply", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int id) {
                smsReply(sender);               
            }
        });

        AlertDialog alert = builder.create();

        TextView t = (TextView) alertView.findViewById(R.id.alertDialog); 
        t.setText(body);

        alert.show();

    }

    private void smsReply(String sender) {

        Intent sendIntent = new Intent(Intent.ACTION_VIEW);
        sendIntent.putExtra("address", sender);
        sendIntent.setType("vnd.android-dir/mms-sms");
        startActivity(sendIntent);

        InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.toggleSoftInput(0, 0);

        this.finish();

    }

    private void goHome() {
        this.finish();
    }

    private String getContactName(String number) {

        Cursor managedCursor = managedQuery(Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number)),
                new String[]{PhoneLookup.DISPLAY_NAME},
                null, null, null);

        if (managedCursor.moveToFirst()) {
                //Log.d("SmsReceiver", "From: " + managedCursor.getString(managedCursor.getColumnIndex(PhoneLookup.DISPLAY_NAME)));
            return managedCursor.getString(managedCursor.getColumnIndex(PhoneLookup.DISPLAY_NAME)) + "\n";
        }
        return number + "\n";

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-25T06:48:38.193

I think you can use `WakeLock` for turning on and `DevicePolicyManager` for turning off the screen... I used it in my application... (Wakelock is deprecated but working like a charm).

To turn off the screen use `DevicePolicyManager`. Call `dpm.lockNow();` when you want to turn the screen off. To turn on the scren use `WakeLock.acquire();`

```
private static final String desc = "Some Description About Your Admin";
private static final int ADMIN_INTENT = 15;
private DevicePolicyManager dpm;
private ComponentName cname;
dpm = (DevicePolicyManager)getSystemService(DEVICE_POLICY_SERVICE);
cname = new ComponentName(getApplicationContext(),Receiver.class); /* Receiver Class Extends Device Admin Receiver*/

Intent intent = new Intent(DevicePolicyManager.ACTION_ADD_DEVICE_ADMIN);
intent.putExtra(DevicePolicyManager.EXTRA_DEVICE_ADMIN, cname);
intent.putExtra(DevicePolicyManager.EXTRA_ADD_EXPLANATION,desc);
startActivityForResult(intent, ADMIN_INTENT);    

PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE); 
WakeLock wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK
                                                     | PowerManager.ACQUIRE_CAUSES_WAKEUP
                                                     | PowerManager.ON_AFTER_RELEASE, "MyWakeLock");
wakeLock.acquire(); 
```

# ruby-on-rails-3 - Rails + jQuery-tokeninput + Draper 装饰器方法

> ID：10678874
> 
> 赞同：0
> 
> 时间：2012-05-21T02:23:41.467
> 
> 标签：ruby-on-rails-3, jquery-tokeninput, draper

我正在使用 Rails + jQuery-tokeninput 执行预输入搜索并填充“belongs_to”关系。这是模型：

```
class Performance < ActiveRecord::Base
  attr_accessible  :composition_tokens
  belongs_to :composition
    ...
  attr_reader :composition_tokens

  def composition_tokens=(ids) # comma-separated
      self.composition_tokens = ids.split(',')
  end
end 
```

我们在这个项目中使用[Draper](https://github.com/jcasimir/draper)为我们的模型提供装饰器。

我们的 CompositionDecorator 有以下方法：

```
class CompositionDecorator < ApplicationDecorator
  decorates :composition

  def full_title
    model.title + ' by ' + model.composer.canonical_name
  end 
```

我已经设置了 tokeninput 支持来使用装饰器，如下所示：

```
jQuery ->
  $('#performance_composition_tokens').tokenInput '/admin/compositions.json'
     theme: 'facebook'
     prePopulate:$('#performance_composition_tokens').data('load')
     propertyToSearch: 'full_title' 
```

控制器索引方法调用装饰器，如下所示：

```
class Admin::CompositionsController < Admin::BaseController
def index
    @compositions = Composition.includes(:composer).paginate(:page => params[:page]||1)
    respond_to do |format|
      format.html
      format.json { render :json => 
        CompositionDecorator.decorate(@compositions.where("title like ?",
            "%#{params[:q]}%")) }
    end
end 
```

当我不使用装饰器时，这一切似乎都可以正常工作，但是添加装饰器会导致问题。“full_title”属性未包含在控制器生成的 json 中，因此“未定义”显示在所选值中，搜索结果列表中不显示任何内容。javascript 控制台中还显示以下错误：

TypeError：“未定义”不是对象（评估“value.replace”）

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:37:34.783

问题是 to_json 不知道对象上的方法，因此您必须通过 :methods 参数明确告诉它。我以前没有使用过 Draper，但看起来您可以在 CompositionDecorator 中添加自己的自定义 to_json。所以，这样的事情可能会起作用：

```
class CompositionDecorator

  def to_json
    composition.to_json(:methods => [:full_title])
  end

end 
```

也可以看看：

*   [https://github.com/jcasimir/draper#2-view-layer-data-filtering](https://github.com/jcasimir/draper#2-view-layer-data-filtering)
*   [http://apidock.com/rails/ActiveRecord/Serialization/to_json](http://apidock.com/rails/ActiveRecord/Serialization/to_json)

# javascript - Javascript Rotating Image Width 需要符合window

> ID：10678875
> 
> 赞同：0
> 
> 时间：2012-05-21T02:23:49.263
> 
> 标签：javascript, html, css, background, width

网站：[http ://www.elsolstudio.com/demo/avoya/index.html](http://www.elsolstudio.com/demo/avoya/index.html)

现在，当我缩小窗口时，右下角的白色背景变得混乱。我需要 javascript 旋转图像以符合窗口的大小，而不是使窗口的宽度变大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:27:15.223

只需将旋转元件放入`overflow:hidden`容器中即可。

# git - 在 Eclipse PDT 中的项目之间共享代码同时保留 Web 服务器的测试能力的最佳实践是什么？

> ID：10678876
> 
> 赞同：0
> 
> 时间：2012-05-21T02:23:51.187
> 
> 标签：git, wamp, egit, eclipse-pdt, include-path

我在 Eclipse PDT 中有许多项目，它们都是网站。所有这些网站都使用我开发的内容管理系统。我将 CMS 的代码移到了一个单独的项目中，可以共享。

到目前为止，我有一个类似于此的项目/文件结构：

```
CMS [CMS master]
  -CMSlib
Website1
  -scripts
    -CMSlib
Website2
  -scripts
    -CMSlib 
```

该`CMS\CMSlib`文件夹包含共享代码，并且 CMS 项目本身与本地 Git 存储库连接并代表最新版本。我不确定我应该如何在项目之间共享此代码。如果我要共享此代码，我必须能够保留以下工作流功能：

*   我必须能够在 Web 服务器上测试网站。我为此目的安装了 WAMP。在 Eclipse中将项目添加`CMS`到每个网站项目的包含路径是不好的，因为 Web 服务器不了解 Eclipse。所以我需要将文件放在本地（最好在`scripts\CMSlib`每个网站项目的文件夹中）。
*   CMS 的代码必须易于为所有网站更新。因此，如果我在项目中添加一个功能，`CMS`应该很容易为每个网站项目更新 CMS 代码。

那么，当需要这些要求时，最佳实践是什么？是否有某种方法可以使用 EGit 将文件从存储库中提取到其他项目中（顺便说一下，我是 Git 初学者）？或者我是否缺少其他一些允许使用包含路径完成此操作的设置？

**注意：**复制并粘贴`CMS\CMSlib`到网站项目的文件夹中会出现一个选项框，如果该文件夹已存在，`scripts`则强制我跳过该操作。`scripts\CMSlib`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T08:41:16.877

由于您使用的是 Git，因此您可以使用“子模块”功能： http: [//git-scm.com/book/en/Git-Tools-Submodules](http://git-scm.com/book/en/Git-Tools-Submodules)。

使用子模块功能，您可以将所有网站保存在一个项目目录下；但是，如果您希望每个网站使用不同版本的公共代码（作为子模块引入），您只需将公共项目单独子模块到每个网站中。

您也可以在没有子模块的情况下执行此操作。您可以简单地“要求”（或自动加载）每个网站的公共代码。我见过的每一个 IDE 都允许你引入额外的库或包。我不使用 PDT；但是，我确定它就在那里。

**编辑**：实际上，一个快速的谷歌产生了：[“配置项目的 PHP 包含路径”](http://files.zend.com/help/PDT/adding_elements_to_a_project_s_include_path.htm)。

# c++ - 如何通过地址传递 char 指针以被 char** 接受？

> ID：10678877
> 
> 赞同：0
> 
> 时间：2012-05-21T02:25:16.377
> 
> 标签：c++, string, pointers, pass-by-reference

我有一个名为 Shader 的结构，它包含以下信息：

```
struct Shader {
    enum ValueType{ VT_Attribute, VT_Uniform, VT_Varying };
    GLuint Memory;
    GLenum Type;
    char* Source;
    char* Name;
    std::map< Shader::ValueType, float* > Values;
}; 
```

但是，如果我这样做：

`glShaderSource( shaderMem, 1, &shader.Source, NULL );`

我收到以下错误：

`error: invalid conversion from 'char* const*' to 'const char**'`

为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:28:40.293

它发生是因为`shader`在`const`那个时候。假设`glShaderSource`不会尝试写入其第三个参数的内容，那么您可以`const_cast`离开`const`：

```
glShaderSource( shaderMem, 1, const_cast< char** >( &shader.Source ), NULL ); 
```

# ajax - 将参数从 jqgrid 传递给 spring 控制器？

> ID：10678881
> 
> 赞同：0
> 
> 时间：2012-05-21T02:26:14.627
> 
> 标签：ajax, spring-mvc

我有这个 ajax 代码。我还尝试了 onselectrow，格式化程序，我想如何获取行对象并将其发送到控制器，以便我的下一页可以显示行对象发送的所有详细信息。

var jq = jQuery.noConflict();

```
jq(document).ready(function() {
    var grid = jq("#grid");
    grid.jqGrid({
        url:'${pageContext.request.contextPath}/getRegisteredClassesData.html',
        datatype: 'json',
        mtype: 'POST', 
        colNames:['Course Name'],
        colModel:[{name:'courseName',index:'courseName', width:55, 
                formatter: function (cellvalue, options, rowObject) {
                var cellPrefix = '';
                return cellPrefix + '<a href= ${pageContext.request.contextPath}/registeredClassesDetail.phone?regNo='+ rowObject.regNo +'&courseId='+ rowObject.courseId +'">' + cellvalue + '</a>';
            }
        },],
        rowNum:5,
        height: 130,
        autowidth: true,
        pager: '#pager',
        hidegrid:false,
        viewrecord: true,
        emptyrecords: "Empty records",
        loadComplete: function() {},
        jsonReader : {
            root: "rows",
            page: "page",
            total: "total",
            records: "records",
            cell: "cell",
            repeatitems: false,
            id: "id"
        }
    });

    grid.jqGrid('navGrid','#pager',
        {add:false, edit:false, del:false, search:false}
    );
}); 
```

从控制器，我想获取我发送的参数，即 courseId 和 regNo。但是当我在控制器中调试时，两者都是空的。我想使用这 2 个参数在域中搜索，以便显示正确的数据。请帮我。谢谢是提前。

这是页面中将显示详细信息的 ajax 代码。它几乎相同。但最重要的是我想检索数据，以便我可以以任何形式显示。

```
 var jq = jQuery.noConflict();

 jq(document).ready(function() {
var grid = jq("#grid");
var regNo = '<%=request.getSession().getAttribute("regNo")%>';
var courseId = '<%=request.getSession().getAttribute("courseId")%>';

grid.jqGrid({
    url:'${pageContext.request.contextPath}/getRegisteredClassesDetails.html',
    datatype: 'json',
    mtype: 'POST',
    /* postData: {
        courseId: function() { return jQuery("#courseId option:selected").val(); },
        regNo: function() { return jQuery("#regNo option:selected").val(); }
    }, */
    postData:{regNo:regNo,
        courseId:courseId},  
   colNames:['Registration #', 'Status', 
    'Course Name', 'Location', 
    'Start Date', 'Registered Person'],

    colModel:[
        {name:'regNo',index:'regNo', width:20},
        {name:'regStatus',index:'regStatus', width:20},
        {name:'courseName',index:'courseName', width:150},
        {name:'courseLoc',index:'courseLoc', width:30},
        {name:'startDate',index:'startDate', width:25},
        {name:'fullName',index:'fullName', width:30,sortable:false}],
    rowNum:5,
    rowList:[5,10,20],
    height: 200,
    autowidth: true,
    pager: '#pager',
    sortname: 'startDate',
    hidegrid:false, //disable the collapse/expand function
    viewrecord: true,
    caption:"Course Details",
    emptyrecords: "Empty records",
    //multiselect:true,
    loadComplete: function() {

    },
    jsonReader : {
        root: "rows",
        page: "page",
        total: "total",
        records: "records",
        cell: "cell",
        repeatitems: false,
        id: "id"
    }
});

grid.jqGrid('navGrid','#pager',
    {add:false, edit:false, del:false, search:false}
); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T10:37:25.200

`添加如下内容

```
postData: {
        courseId: function() { return jQuery('#courseId').val(); },
        regNo: function() { return jQuery('#regNo').val(); }
    },` 
```

# android - Android中的CountDownLatch问题

> ID：10678882
> 
> 赞同：1
> 
> 时间：2012-05-21T02:26:20.840
> 
> 标签：android, countdownlatch

我正在使用 countdownlatch，如下例所示。在这里，BackgroundDataPopulator 创建了一个 AyncTask，它反过来调用 PackagePopulator 中的 displayData。但它永远不会发生并且活动卡住了。我在这里做错了什么。

```
public class PackagePopulator implements ServerDataProcessor {

    private CountDownLatch counter=new CountDownLatch(1);
    String[]  packages;

    public void getPagesFromServer() {
        new BackgroundDataPopulator(IMgrApplication.getAppContext().getString(R.string.list),new PData(),this).execute();

    }

    public String[] getPages() {
        try {

            counter.await();
        } catch (InterruptedException e) {
            packages=new String[0];
        }
        return packages;
    }

    @Override
    public void displayData(ServerOutput output) {

        Page[] pgArray = new Page[((PageData)output).getPages().size()];
        pages=new String[pgArray.length];
        pgArray = ((PageData)output).getPages().toArray(pgArray);
        for(int i=0;i<pgArray.length;i++){
            pages[i]=pgArray[i].getName();
        }
        counter.countDown();

    }

}

public class BackgroundDataPopulator extends AsyncTask<Void, String, ServerOutput> {
    // connector=new JSONConnector();
    Connector connector;
    String curUrl;
    ServerOutput curServerOutput;
    ServerDataProcessor processor;

    public BackgroundDataPopulator(String url, ServerOutput serverOutput,ServerDataProcessor curProcessor) {
        //connector = new UnitTestConnector();
        connector = new JSONConnector();
        curUrl = url;
        curServerOutput = serverOutput;
        processor=curProcessor;
    }

    @Override
    protected ServerOutput doInBackground(Void... params) {

        return connector.getData(URLUtils.getFormattedUrl(curUrl),curServerOutput);
    }

    @Override
    protected void onPostExecute(ServerOutput output) {
        processor.displayData(output);
        //Toast.makeText(BaseFragmentActivity.this, "Done!",Toast.LENGTH_SHORT).show();
    }
}

protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    pagePopulator=new PagePopulator();
    pagePopulator.getPagesFromServer();
    super.onCreate(savedInstanceState);

}

public ArrayAdapter<CharSequence> getSpinnerDataArray(String item) {
    return new ArrayAdapter<CharSequence>(this,android.R.layout.simple_spinner_item,pagePopulator.getPages());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:02:55.073

目前尚不清楚您到底在做什么以及 AscynTask 的启动位置。看起来您正在调用`await()`并且`countDown()`在同一个线程上，这就是您被阻止的原因。发布更多详细信息和/或调试您的代码。

# mysql - 如何将数据从mysql移动到redis

> ID：10678886
> 
> 赞同：4
> 
> 时间：2012-05-21T02:27:31.397
> 
> 标签：mysql, redis

我尝试将一些常用数据从 mysql 放入 redis 服务器。所以 redis 就像一个读取服务器，我需要将数据从 mysql 移动到 redis。有人可以推荐一个好的方法吗？我已经阅读了一些主题并有一些想法分享

1、通过mysql trigger记录适当的数据，通过定时app将数据移动到redis 2、读取mysql日志，分析后放到redis中。

顺便说一句：在我的应用程序中存储在 redis 中的数据不需要实时，有点延迟是可以的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-15T14:59:20.327

我认为mysql udf 插件（[https://github.com/Ideonella-sakaiensis/lib_mysqludf_redis](https://github.com/Ideonella-sakaiensis/lib_mysqludf_redis)）可以帮助您将数据从Mysql 同步到Redis。

例子：

```
DELIMITER $$
CREATE TABLE `my_table` (
  id    varchar(16) PRIMARY KEY,
  text  varchar(32)
); 
```

为表设置触发器并通过mysql udf调用redis命令

```
DELIMITER $$
CREATE TRIGGER `after_insert_my_table`
AFTER INSERT ON `my_table` FOR EACH ROW
BEGIN
  DO `redis`('redis://@127.0.0.1/0/', 'SET', new.`id`, new.`text`);
END $$
DELIMITER ; 
```

然后你可以通过*my_table* *id获得价值*

```
mysql>  SELECT `redis`('redis://@127.0.0.1/0/', 'GET', <my_table id>)\G
*************************** 1\. row ***************************
`redis`('redis://@127.0.0.1/0/', 'GET', <my_table id>): {
        "out":  <my_table text>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T00:04:37.823

使用 redis-cli 的批量插入模式。

看看这个 - [http://dcw.ca/blog/2013/01/02/mysql-to-redis-in-one-step/](http://dcw.ca/blog/2013/01/02/mysql-to-redis-in-one-step/)

# django - django 虚拟主机

> ID：10678890
> 
> 赞同：0
> 
> 时间：2012-05-21T02:28:09.163
> 
> 标签：django, mamp, virtualhost

我是 django 新手，来自 MAMP 和 PHP 世界。如何在 django 中为站点设置虚拟主机？比如你运行服务器的时候，不是去127.0.0.1:8000，而是想去本地的mysite.dev？我一直在阅读有关 Apache 的 wsgi 的信息，但不确定这是否是最简单的方法。

基本上，你如何为 django 设置虚拟主机？任何链接或代码表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T05:10:46.767

请记住，*与*PHP 不同，您不需要 Apache 和虚拟主机来开发和测试 django 应用程序，因为 django 带有[内置的开发服务器](https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-runserver)。

当您准备好部署应用程序时，您只需要 Apache，并且要设置它，您应该阅读[如何使用 wsgi 进行部署](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T08:18:37.353

我不确定你为什么要在开发中这样做。开发服务器不管理类似的东西，它只是监听你告诉它的端口并运行 Django 代码作为响应。这意味着您可以破解您的`hosts`文件以告诉它`mysite.dev`映射到本地主机。不过，您仍然需要访问端口 8000 - 除非您告诉 runserver 绑定到端口 80，否则您需要使用`sudo`.

或者，正如您所说，您可以使用 mod_wsgi 设置 Apache，就好像它是生产服务器一样 - 但是您将失去自动重新加载代码的功能，并且在每次更改 Python 代码后都必须重新启动 Apache（尽管有一些方法可以解决这个，请参阅 mod_wsgi 文档）。

似乎很麻烦，几乎没有收获。

# jquery-mobile - jQuery Mobile 在旧 ipod 上的速度慢得让人无法忍受？

> ID：10678892
> 
> 赞同：0
> 
> 时间：2012-05-21T02:28:32.243
> 
> 标签：jquery-mobile, cordova, ipod-touch

我在 xcode 中编写了一个非常简单的 jquery mobile / phonegap 应用程序。在模拟器中，它就像一个魅力。但我必须测试的唯一设备是 2008 年的第二代 ipod touch，当我在设备上测试时，它的速度慢得*令人难以置信*，页面转换有时需要 25 秒。

我没有写过任何过多或需要资源的东西；事实上那里几乎什么都没有。只是几个 div 和一些文本，但是当我单击一个链接转到下一页时，做任何事情都需要很长的时间。与此同时，它几乎被冻结了。

这仅仅是因为我使用的是这么旧的设备吗？当然，这不是我的代码或框架的问题。（我知道那句话的第一部分很可笑，但我的代码确实是准系统——只有一点基本的 html 和一些同样基本的 javascript。）

在包含 jquery mobile 之前，这一切都加载得相当快，最多在 1-2 秒内。修改后；好吧，你已经是问题了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:53:00.783

我认为不支持浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T13:12:40.270

CSS 效果需要大量资源。只需在加载 jQuery Mobile 库之前添加：

```
$(document).bind("mobileinit", function(){
  $.mobile.defaultPageTransition="none"
}); 
```

远离旧设备上的过渡；-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-16T16:06:46.957

**一个原因**
*根据[谷歌](https://developers.google.com/mobile/articles/fast_buttons)：*
...从您点击按钮触发点击事件开始，移动浏览器将等待大约 300 毫秒。这样做的原因是浏览器正在等待查看您是否真的在执行双击。

**一些解决方案**
1\. 使用 fastclick.js 摆脱这 300 毫秒的延迟
[https://github.com/ftlabs/fastclick](https://github.com/ftlabs/fastclick)
2\. 使用应用程序缓存加速加载
[https://developer.mozilla.org/en-US/ docs/Web/HTML/Using_the_application_cache](https://developer.mozilla.org/en-US/docs/Web/HTML/Using_the_application_cache)

# javascript - 如何使html文本框默认小写

> ID：10678894
> 
> 赞同：0
> 
> 时间：2012-05-21T02:28:43.503
> 
> 标签：javascript, html

我有这个登录表单：

```
<div id="loginform">
    <div>
        <img id="loginLogo" runat="server" />
    </div>
    <div class="row">
        <label>Email</label>
        <input name="UserNameBox" type="text" id="tbEmail" style="outline-style:none;"
        tabindex="1" runat="server" onkeydown="if (event.keyCode == 13) validateExample()"
        />
    </div>
    <div class="row">
        <label>Password</label>
        <input name="PasswordBox" type="password" id="tbPassword"
        tabindex="2" style="outline-style:none" runat="server" onkeydown="if (event.keyCode == 13) validateExample()"
        />
    </div>
    <div id="validationError" class="validationError" runat="server"></div>
    <div style="margin-top: 15px; margin-left: 15px;" tabindex="3">
        <input type="checkbox" id="cbRememberMe" name="rememberMe" runat="server"
        tabindex="4" />remember me</div>
    <center>
        <input type="button" class="rounded-corners" onclick="validateExample()"
        value="Login" tabindex="5" />
    </center>
</div> 
```

在我的设备中，用户名文本框的第一个字母的默认大小写为大写。我如何默认将其设为小写，但如果用户名以大写字母开头，用户仍然可以将其设为大写。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:46:14.170

在验证期间而不是在键入期间进行小写转换会更好。您可以[`toLowerCase`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/toLowerCase)在验证时使用。

如果您坚持进行实时转换，请转身`CAPSLOCK ON`，[这是一个示例](http://jsfiddle.net/JAyt2/)：

```
document.getElementById('tbEmail').onkeyup = function() {
    this.value = this.value.toLowerCase();
}​ 
```

此外，您不希望阻止用户使用大写字母。用户可能会认为有问题（通常用户认为某事不正常时有问题）

# php - 通过 PHP 与 Amazon EC2 实例建立 SSH 连接

> ID：10678896
> 
> 赞同：3
> 
> 时间：2012-05-21T02:29:56.877
> 
> 标签：php, ssh, amazon-ec2, phpseclib

尝试使用 .pem 文件、PHP 和 phpseclib 连接到 Amazon EC2 实例。

我已经尝试过这篇文章中提到的内容： [ssh access to ec2 from php](https://stackoverflow.com/questions/8658933/ssh-access-to-ec2-from-php)

但是，我不断收到“错误 111。连接被拒绝...”

当我使用 ssh 和相同的 .pem 文件从我自己的机器连接时，没有错误。

这是我正在使用的原始帖子中的代码：

```
include('Net/SSH2.php');
include('Crypt/RSA.php');

$key = new Crypt_RSA();

$key->loadKey(file_get_contents('/pathtokey.pem'));

$ssh = new Net_SSH2('ec2-xxx-xxx-xxx-xxx.compute-1.amazonaws.com');
if (!$ssh->login('user', $key)) {
    exit('Login Failed');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T08:35:37.970

我刚刚测试了提供的示例代码，它适用于我的 Amazon EC2 Ubuntu 实例。

您必须检查建议的明显内容：

*   主机名
*   用户名
*   PEM 文件路径

他们是正确的吗？您确定您使用的与从您自己的机器连接时使用的相同吗？

如果它们相同，您是否在同一台机器上测试代码？如果没有，您运行代码的主机是否为出站连接打开了端口 22？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:46:36.290

显而易见的检查，端口是否开放并允许您的用户使用？

试着做：

```
wget ec2-xxx-xxx-xxx-xxx.compute-1.amazonaws.com:22 
```

从给您带来麻烦的机器上，看看您是否可以打开插座。

我猜您可能需要使用 shell_exec() 通过 PHP 运行该命令，以确保它被相同的用户/安全设置调用。

# .net - 两个接口的 F# 显式接口方法

> ID：10678904
> 
> 赞同：2
> 
> 时间：2012-05-21T02:31:55.407
> 
> 标签：.net, interface, f#, explicit-interface

处理这种情况的正确方法是什么。我的 F# 类 DogTree 中有一个方法应该满足为两个接口实现 Bark() 方法的要求。

```
type ITree =
    interface
        abstract Bark : unit -> unit
        abstract Grow : unit -> unit
    end

type IDog =
    interface
        abstract Bark : unit -> unit
        abstract ChaseCar : unit -> unit
    end

type TreeDog = 
   // so the "and" syntax below doesn't work - what is the correct way to handle?
   interface IDog and ITree with
      member this.Bark() = printfn "Bark" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T02:46:02.543

您可以委托给一个常见的实现：

```
type TreeDog = 
  interface IDog with
    member this.Bark() = printfn "Bark" 
  interface ITree with
    member this.Bark() = (this :> IDog).Bark() 
```

或者，更恰当地说：

```
type TreeDog = 
  member this.Bark() = printfn "Bark"
  interface IDog with
    member this.Bark() = this.Bark() 
  interface ITree with
    member this.Bark() = this.Bark() 
```

（请注意，这在名为 的类中定义了一个额外的方法，`Bark`用作两个接口的实现。）

如果你在你的类中声明一个主构造函数，你可以使用它来代替：

```
type TreeDog() = // primary constructor
  let bark() = printfn "Bark" // this member is private
  interface IDog with
    member this.Bark() = bark()
  interface ITree with
    member this.Bark() = bark() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T03:03:23.847

这是相当优雅的

```
type TreeDog() = 
  let bark() = printfn "Bark" 
  interface IDog with
    member this.Bark() = bark()
  interface ITree with
    member this.Bark() = bark() 
```

# gwt - 如何在生产模式下使用谷歌应用引擎应用程序运行 GWT 不需要部署到 App Engine

> ID：10678905
> 
> 赞同：0
> 
> 时间：2012-05-21T02:32:11.367
> 
> 标签：gwt

我可以在我的计算机上以生产模式运行我的应用程序（带有谷歌应用程序引擎的 GWT）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:42:27.750

编译您的项目，然后启动 DevMode，但不要将`?gwt.codesvr=127.0.0.1:9997`位放在 URL 中。

# performance - Opengl Es 2.0 着色器管理器

> ID：10678912
> 
> 赞同：1
> 
> 时间：2012-05-21T02:33:31.787
> 
> 标签：performance, opengl-es, opengl-es-2.0

我有一个简单的问题，从内存中检查整数值或要求 opengl 做一些简单的事情，比如使用程序或绑定纹理是否更快？我正在编写着色器管理器类，只是想知道是否有任何差异，从我的角度来看，检查整数以避免不需要的调用看起来更便宜。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T07:40:14.697

避免不必要的管道状态更改总是一件好事，我可以想象检查整数值将比进行 glUseProgram 调用便宜。渲染时只需要“程序连贯”，所以大多数时候你不要同时做（检查和glUseProgram）。我还建议您阅读本指南[http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1) . 它将帮助您进行优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T11:32:42.667

优化代码的最佳方法之一是避免尽可能多的 OpenGL/DX 函数调用。因此，在大多数情况下，只检查一个局部变量应该比使用 OpenGL 代码更好。

有时 OpenGL 会与 CPU 同步以执行一些代码：如 glGetTexImage、getPixels 等……这会极大地损害性能。

当谈到“使用程序”或“绑定纹理”时，我不知道确切的成本是多少。这取决于规格和设备实现。

# jquery - 背景滑块问题

> ID：10678913
> 
> 赞同：0
> 
> 时间：2012-05-21T02:33:32.163
> 
> 标签：jquery, image, background, slider

我试图在 这里实现这个[http://jsfiddle.net/aVUxD/3/](http://jsfiddle.net/aVUxD/3/) [http://22twenty.com/wallspace/](http://22twenty.com/wallspace/)

这是在此处创建[的一种在加载时淡入背景的方法？](https://stackoverflow.com/questions/1055414/a-way-to-fade-in-the-background-on-load) html:

```
<!DOCTYPE html>
<html lang="en">
<!--To Do: -->
<!-- list menu logo size  -->
<!--all other pages -_- -->
  <head>
    <meta charset="utf-8">
    <title>Wall Space Gallery And Framing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
  <link rel="stylesheet" href="css/style.css">
<!--[if !IE 7]>
    <style type="text/css">
        #wrap {display:table;height:100%}
    </style>
<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
     <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>

<![endif]-->
  </head>
  <body>

<header>
                <div id="wrap">
<img src="http://elegantthemes.com/preview/InStyle/wp-content/uploads/2008/11/s-1.jpg" />
<img src="http://elegantthemes.com/preview/InStyle/wp-content/uploads/2008/11/s-5.jpg" />
<img src="http://elegantthemes.com/preview/InStyle/wp-content/uploads/2008/11/s-3.jpg" />
</div>
​
                    <div class="logo">
                                        <a id="single_image" href="index.html"><img src="img/logo.png" alt=""/></a>
                    </div> 

                    <ul id="navigation">
                        <li id="active"><a href="index.html" alt="home" >Home</a></li>
                        <li><a href="exhibitions.html" alt="Exhibitions"> Exhibitions</a></li>
                        <li><a href="artists.html" alt="Artists"> Artists</a></li>
                        <li><a href="contact.html" alt="Contact"> Contact</a></li>
                    </ul>

</header>

                <div id="content">

                </div>

<footer>
    <div id="copyright">
        <p>Copyright &copy Wall Space Gallery And Framing 2012</p>
    </div>

    <div id="twenty">
        <p>Website By <a href="http://www.22twenty.com">22Twenty</a> Web Solutions</p>
    </div>    
</footer>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="js/jquery.easing.1.3.min.js"></script>
<script>
$(document).ready(function(){
    $('img').hide();

function anim() {
    $("#wrap img").first().appendTo('#wrap').fadeOut(2000);
    $("#wrap img").first().fadeIn(2000);
    setTimeout(anim, 4000);
}
anim();​

)};
</script>
</body>
</html> 
```

css 很长，但你可以在这里查看源代码：http: [//22twenty.com/wallspace/](http://22twenty.com/wallspace/)

应该在 chrome 上工作 不确定其他浏览器

希望有人能帮忙！

谢谢

丹佛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T07:15:10.580

背景淡入淡出似乎不适用，因为您在`#wrap`.

根据我对您想要什么的理解，我在[这里](http://jsfiddle.net/BpjR8/2/)得到了一些工作。

The css in the fiddle is lower in the cascade than that in your stylesheet, therefore takes precedence. Adjust header height to suit your images. #wrap's `overflow:hidden` should not be necessary if all images are the same size - those from the example are not.

# android - 我无法将互联网模拟器与 android 4.0 连接

> ID：10678914
> 
> 赞同：1
> 
> 时间：2012-05-21T02:33:47.107
> 
> 标签：android, sql-server, android-emulator

我无法使用 android 4.0 在模拟器 (api14) 上连接到互联网。但在android2.2模拟器我可以。

如何在 android 4.0 模拟器上连接到互联网？

我的程序使用 2.2 模拟器连接到 sqlserver，但他无法使用 4.0 连接。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.bangkok.kohfood"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="14" />
<uses-permission android:name="android.permission.INTERNET" />
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".KohFoodActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
   </application>
</manifest>

Connection conn = null;
String url = "jdbc:jtds:sqlserver://192.168.1.11:1433/";
String dbName = "koh;Instance=MSSQLSERVER;";
String userName = "bit"; 
String password = "1234";
String driver = "net.sourceforge.jtds.jdbc.Driver";
  Class.forName(driver).newInstance();
  conn = DriverManager.getConnection(url+dbName,userName,password); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T06:01:57.390

从 Android 4 开始，不再允许应用在主 (=UI) 线程中进行网络通信。没有看到你的代码我不能肯定地说，但这可能是你的问题吗？

要对此进行测试，您应该将网络通信移至后台线程并查看它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:49:30.903

您是否在屏幕顶部看到 Internet 指示器图标？如果不是，请转到设置并确保将 Wi-Fi 设置为开启。

# c++ - pc格式化后不渲染精灵

> ID：10678915
> 
> 赞同：0
> 
> 时间：2012-05-21T02:33:48.023
> 
> 标签：c++, opengl, sdl

我的项目有一个奇怪的问题。

我最近格式化了我的电脑，刚刚设置了我的项目的备份，安装了所有需要的东西并重新构建了它。我已经设置了库、DLL，所以项目运行没有任何问题，而且确实如此。唯一的问题是我的精灵不再渲染！没有错误，音乐播放的资产在正确的位置，我已经调试并加载了图像，发送了正确的信息进行渲染，但图像只是没有出现在屏幕上。我没有更改任何源文件或任何东西，并且检查了所有内容两次，甚至开始了一个新项目来重新构建它，但似乎没有任何效果。

我正在使用 SDL 并使用 OpenGL 进行渲染。在格式化我的电脑之前，一切都可以正常工作。

你有过这样的问题吗？我能错过什么？

编辑：这是我运行应用程序时的日志：

“二进制文件未使用调试信息构建”是什么意思？我不记得它是否曾经在它工作时发生过。

```
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\SDLSkeleton.exe', Symbols loaded.
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\ntdll.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\kernel32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\KernelBase.dll'
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\SDL.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\advapi32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\msvcrt.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\sechost.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\rpcrt4.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\gdi32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\user32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\lpk.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\usp10.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\winmm.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\opengl32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\glu32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\ddraw.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\dciman32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\setupapi.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\cfgmgr32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\oleaut32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\ole32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\devobj.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\dwmapi.dll'
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\SDL_image.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\SDL_ttf.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\libfreetype-6.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\zlib1.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\SDL_mixer.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\Windows\winsxs\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.6161_none_50934f2ebcb7eb57\msvcp90.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\winsxs\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.6161_none_50934f2ebcb7eb57\msvcr90.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\apphelp.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\AppPatch\AcLayers.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\sspicli.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\shell32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\shlwapi.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\userenv.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\profapi.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\winspool.drv'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\mpr.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\imm32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\msctf.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\KBDUS.DLL'
'SDLSkeleton.exe': Unloaded 'C:\Windows\System32\KBDUS.DLL'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\KBDBR.DLL'
'SDLSkeleton.exe': Unloaded 'C:\Windows\System32\KBDBR.DLL'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\dsound.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\powrprof.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\cryptbase.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\clbcatq.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\MMDevAPI.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\propsys.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\AudioSes.dll'
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\mikmod.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\wdmaud.drv'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\ksuser.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\avrt.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\msacm32.drv'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\msacm32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\midimap.dll'
The thread 'Win32 Thread' (0x1724) has exited with code 0 (0x0).
The thread 'Win32 Thread' (0x1190) has exited with code 0 (0x0).
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\smpeg.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\nvoglv32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\version.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\wintrust.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\crypt32.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\msasn1.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\ntmarta.dll'
'SDLSkeleton.exe': Loaded 'C:\Windows\System32\Wldap32.dll'
The thread 'Win32 Thread' (0x85c) has exited with code 0 (0x0).
The thread 'Win32 Thread' (0xdfc) has exited with code 0 (0x0).
The thread 'Win32 Thread' (0x10dc) has exited with code 0 (0x0).
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\libpng12-0.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Unloaded 'C:\DevProjects\SDLSkeleton\Debug\libpng12-0.dll'
'SDLSkeleton.exe': Loaded 'C:\DevProjects\SDLSkeleton\Debug\libpng12-0.dll', Binary was not built with debug information.
'SDLSkeleton.exe': Unloaded 'C:\DevProjects\SDLSkeleton\Debug\libpng12-0.dll' 
```

# python - 为什么这个正则表达式找不到结果

> ID：10678916
> 
> 赞同：2
> 
> 时间：2012-05-21T02:33:48.030
> 
> 标签：python, regex

我有一个如下的python代码：我的问题是为什么匹配的变量是['']？（我在 regexpal.com 中使用了正则表达式，它可以找到正确的结果 |Name=A. Johnson | 那里）

```
import re
a = 
'{{Infobox U.S. Cabinet |align=left |clear=yes |Name=A. Johnson |President=Andrew Johnson |President start=1865 |President end=1869 |Vice President=None |Vice President start=1865 |Vice President end=1869 |State=[[William H. Seward]] |State start=1865 |State end=1869 |War=[[Edwin M. Stanton]] |War start=1865 |War end=1868 |War 2=[[John Schofield|John M. Schofield]] |War start 2=1868 |War end 2=1869 |Treasury=[[Hugh McCulloch]] |Treasury start=1865 |Treasury end=1869 |Justice=[[James Speed]] |Justice start=1865 |Justice end=1866 |Justice 2=[[Henry Stanberry]] |Justice start 2=1866 |Justice end 2=1868 |Justice 3=[[William M. Evarts]] |Justice start 3=1868 |Justice end 3=1869 |Post=[[William Dennison (Ohio governor)|William Dennison]] |Post start=1865 |Post end=1866 |Post 2=[[Alexander Randall|Alexander W. Randall]] |Post start 2=1866 |Post end 2=1869 |Navy=[[Gideon Welles]] |Navy start=1865 |Navy end=1869 |Interior=[[John P. Usher]] |Interior date=1865 |Interior 2=[[James Harlan (senator)|James Harlan]] |Interior start 2=1865 |Interior end 2=1866 |Interior 3=[[Orville H. Browning]] |Interior start 3=1866 |Interior end 3=1869 }}'
matched = re.findall("\|?\s*name\s*=(.)*?\|",a,re.I) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T02:44:21.790

你会想要`(.*?)`，而不是`(.)*?`——后者（你所拥有的）只会捕获一个字符，即使它*消耗*多个字符。即使组本身有重复，一个捕获组也只会返回一次；`(.)`因此，尽管重复，后者仍会捕获单个字符。

如果您使用 将重复移动到捕获组中`(.*?)`，您将在返回中获得多个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:48:51.433

看起来是它如何处理分组。作为一个更简单的示例，请查看以下代码行的输出之间的差异：

```
re.findall("c(a)*t", "hi caaat hi")
re.findall("c(a*)t", "hi caaat hi") 
```

看起来您想要的代码更像：

```
re.findall("\|\s*name\s*=([^\|\}]*)", a, re.I) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:53:21.463

```
matched = re.findall("\|?\s*[nN]ame\s*=([a-zA-Z\.\s]+)\|?",a,re.I)
print matched 
```

输出：

```
['A. Johnson '] 
```

# c# - 将 XML 中的特定变量转换为字符串 C#

> ID：10678917
> 
> 赞同：1
> 
> 时间：2012-05-21T02:33:54.280
> 
> 标签：c#, xml, string

我需要将 XML 文件的特定部分转换为字符串，其中的数据会有所不同。例如。

我有一个包含此部分的 xml 文件： `-<root>-<Data><1>data</1>`

我只想将该行转换为字符串，而不是整个文件。这个，我知道怎么做。我的问题是“1”中的数据会根据情况而变化，我仍然希望能够使用相同的程序来转换它，而不管“1”中的数据读取什么。

在没有数据的情况下读取“1”行，我知道我可以使用：

```
 var xml = "<root><Data><1>data</1></Data></root>";   
var xmlString = XElement.Parse(xml).Descendants("1").FirstOrDefault().Value; 
```

但我不知道如何改变“1”的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:33:50.700

```
var xml = "<root><Data><One>data</One></Data></root>";

var xmlString = (from data in XElement.Parse(xml).Descendants("Data")
                 where data.Descendants().Any()
                 select data.Descendants().First().Value).FirstOrDefault(); 
```

旁注：有一个名称以数字开头的 XML 元素被认为是无效的 XML，因此，XElement 将无法解析它。

# php - 我可以拥有多个具有相同键、不同值的 $_GET 吗？

> ID：10678918
> 
> 赞同：8
> 
> 时间：2012-05-21T02:34:20.363
> 
> 标签：php, get

是否可以从相同 $_GET 具有不同值的 url 中检索参数？

如`www.domain.com/?user=1&user=2`

目前这只显示第二个列出的内容，所以如果 I `echo $_GET['user']`，它将输出`2`

我似乎在 SO 上找不到这个，所以如果我错过了，请告诉我。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T02:38:03.080

是的，使用 user[] 作为键。应该管用。[PHP 将所有 $_POST[] 变量访问到一个数组中？](https://stackoverflow.com/questions/5345859/php-access-all-post-variables-into-an-array)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T02:39:06.323

查询字符串被解析到关联数组`$_GET`中，因此当有重复的键时，地图上只存在该值的最后一个版本。但是，您可以访问原始数据`$_SERVER['QUERY_STRING']`并自行解析它。

如果可能，我们最好将您的代码修改为不重复键。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T02:45:23.107

快速回答是否定的。

```
http://localhost/?user=1&user=2 
```

让你：

```
array
    'user' => string '2' (length=1) 
```

但是，通过在查询中包含括号，如下所示：

```
http://localhost/?user[]=1&user[]=2 
```

您可以检索 $_GET['user'] 并返回：

```
array
    'user' => 
        array
            0 => string '1' (length=1)
            1 => string '2' (length=1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T02:39:35.110

您可以为每个 $_GET 使用 foreach 循环，然后将所有“用户”变量分组到一个数组中，然后访问您需要的任何键值。0 是第一个，1 是第二个，依此类推……

# php - 修改预定义的程序结构

> ID：10678919
> 
> 赞同：0
> 
> 时间：2012-05-21T02:34:47.060
> 
> 标签：php, mysql, cakephp

我有一段使用 cakephp 编写的代码，如下所示，

```
if($this->Session->read($this->_username)){
       if(!empty($this->data)){       
          $data = array(                
                    'fullname' => $this->data['Table']['fullname'],                 
                    'lastname' => $this->data['Table']['lastname'],
                    'title' => $this->data['Table']['title'],                       
                    'language' => $this->data['Table']['language']                              
                );

                if ($this->Table->save($data)) {                            
                    $this->redirect('okpage');
                }
            }
        } 
```

内置的保存功能会将数据数组保存到数据库表 X 中。现在我想添加另一个元素employeeid，它要保存到表 Y 中，例如。所以上面的代码就变成了

```
if($this->Session->read($this->_username)){
       if(!empty($this->data)){          
          $data = array(               
                    'fullname' => $this->data['Model']['fullname'],                    
                    'lastname' => $this->data['Model']['lastname'],
                    'title' => $this->data['Model']['title'],                      
                    'employeeid' => $this->data['Model']['employeeid'],
                    'language' => $this->data['Model']['language']                             
                );

                if ($this->Model->save($data)) {                          
                    $this->redirect('okpage');
                }
            }
        } 
```

我很困惑我应该在 if 语句的表达式中更改什么以保存数据？因为保存数据数组的原始代码用于将数据保存到表 X 中，所以现在我的插入搞砸了，这也搞砸了我的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:49:22.450

如果您在 X 和 Y 表之间建立关系，CakePHP 可以帮助您自动执行此类操作。

您的问题中没有足够的信息来猜测这种关系应该是什么，但是您可以让 X 属于 Y，或者 Y 有很多 X，或者......

阅读 CakePHP 书籍中的这一部分：http: [//book.cakephp.org/1.3/en/view/1039/Associations-Linking-Models-Together](http://book.cakephp.org/1.3/en/view/1039/Associations-Linking-Models-Together)以获得介绍。

# assembly - x86 程序集 - masm32：等待响应的问题

> ID：10678923
> 
> 赞同：0
> 
> 时间：2012-05-21T02:36:12.710
> 
> 标签：assembly, input, x86, masm, masm32

我创建了这个程序，它接受两个输入并将它们打印出来（很简单，是的，但它是为了练习）。它编译并运行良好，但它没有达到我的预期。这是我的代码：

```
.386 
.model flat, stdcall 
option casemap :none 
include \masm32\include\windows.inc 
include \masm32\include\kernel32.inc 
include \masm32\include\masm32.inc 
includelib \masm32\lib\kernel32.lib 
includelib \masm32\lib\masm32.lib
.data 
   num1 db "Enter a number:", 0 
   num2 db "Enter another number:", 0
.data? 
       buffer1 dd 100 dup(?)
   buffer2 dd 100 dup(?)
.code 
start:
   lea eax, num1
   push eax
   call StdOut
   lea ebx, buffer1
   push ebx
   call StdIn
   hlt
   lea eax, num2
   push eax
   call StdOut
   lea edx, buffer2
   push edx
   call StdIn
   xor eax, eax
   xor ebx, ebx
   xor edx, edx
   lea eax, buffer1
   push eax
   call StdOut
   lea ebx, buffer2
   push ebx
   call StdOut
   push 0 
   call ExitProcess
end start 
```

它显示此输出：

```
Enter a number: Enter another number: 
```

它应该这样做：

```
Enter a number:
; wait for input.
Enter another number:
; wait for input.
; continue with program. 
```

为什么打印在一行？我尝试`halt`在那里停止该过程，但 Windows 停止该程序运行，并说`the program is not responding`.

编辑：

这是我说要编辑的代码：

```
xor eax, eax
xor ebx, ebx
xor edx, edx
lea eax, buffer1
push eax
call StdOut
lea ebx, buffer2
push ebx
call StdOut 
```

当我使用前面的代码运行它时，它会说`"This program is not responding."`为什么会这样？

任何帮助，将不胜感激。

问候，

程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T03:17:12.097

显然，hlt 将停止执行。它只能用于等待下一个硬件中断，并且只能由操作系统使用。

StdIn 对您不起作用，因为您没有提供缓冲区的长度。所以 StdIn 失败并执行下一个 StdOut。

不要使用hlt，并推送缓冲区的长度，然后将地址推送到缓冲区。

```
.386 
.model flat, stdcall 
option casemap :none 

include \masm32\include\windows.inc 
include \masm32\include\kernel32.inc 
include \masm32\include\masm32.inc 
include \masm32\include\msvcrt.inc 
include \MASM32\INCLUDE\user32.inc

includelib \masm32\lib\kernel32.lib 
includelib \masm32\lib\masm32.lib
includelib \masm32\lib\msvcrt.lib
includelib \MASM32\LIB\user32.lib

atoi PROTO C strptr:DWORD

.data 
   num1 db "Enter a number:", 0 
   num2 db "Enter another number:", 0
   formatStr db "%s+%s=%d", 0

.data? 
   buffer1 dw 100 dup(?)
   buffer2 dw 100 dup(?)
   buffer3 dw 100 dup(?)
.code 
start:
   lea eax, num1
   push eax
   call StdOut

   mov eax,100
   push eax
   lea eax, buffer1
   push eax
   call StdIn

   lea eax, num2
   push eax
   call StdOut

   mov eax,100
   push eax
   lea eax, buffer2
   push eax
   call StdIn

   lea eax, buffer1
   push eax
   call atoi
   mov ebx,eax

   lea eax, buffer2
   push eax
   call atoi 
   add eax,ebx

   push eax
   lea eax,buffer2
   push eax
   lea eax,buffer1
   push eax
   lea eax,formatStr
   push eax
   lea eax,buffer3
   push eax
   call wsprintf

   lea eax,buffer3
   push eax
   call StdOut

   push 0 
   call ExitProcess

end start 
```

输出： ![输出](../Images/b5fae2016a4a1f71e55810a13daa3d71.png)

stdcall 指示您从右向左推送参数。此外，您可能会从查看 StdIn 和 StdOut 的代码中受益：

```
StdIn proc lpszBuffer:DWORD,bLen:DWORD

   LOCAL hInput :DWORD
   LOCAL bRead  :DWORD

   invoke GetStdHandle,STD_INPUT_HANDLE
   mov hInput, eax

   invoke SetConsoleMode,hInput,ENABLE_LINE_INPUT or \
                                ENABLE_ECHO_INPUT or \
                                ENABLE_PROCESSED_INPUT

   invoke ReadFile,hInput,lpszBuffer,bLen,ADDR bRead,NULL

   mov eax, bRead

   ret

StdIn endp

StdOut proc lpszText:DWORD

    LOCAL hOutPut  :DWORD
    LOCAL bWritten :DWORD
    LOCAL sl       :DWORD

    invoke GetStdHandle,STD_OUTPUT_HANDLE
    mov hOutPut, eax

    invoke StrLen,lpszText
    mov sl, eax

    invoke WriteFile,hOutPut,lpszText,sl,ADDR bWritten,NULL

    mov eax, bWritten
    ret

StdOut endp 
```

# bits - 计算机科学的点点滴滴

> ID：10678926
> 
> 赞同：0
> 
> 时间：2012-05-21T02:36:58.960
> 
> 标签：bits

1位可以存储多少个不同的值？不是1和0吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:40:29.597

那是对的。[http://en.wikipedia.org/wiki/Bit](http://en.wikipedia.org/wiki/Bit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:42:32.597

正确的。该位表示只有两个值的电流状态 - 开和关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T02:47:03.467

位是二进制数字的缩写。它在计算机科学中只存储 0 或 1。
1 字节=8 位
1KB=1024Byte=8*1024bit
1MB=1024KB
1GB=1024MB
1TB=1024GB

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T02:41:25.653

您可以存储两个值，一个 0 或一个 1。

# nginx - 如何配置 NGinx 以将通配符样式的 url 指向相同的文件系统路径

> ID：10678928
> 
> 赞同：1
> 
> 时间：2012-05-21T02:37:15.823
> 
> 标签：nginx

我想使用 url 的一部分来帮助缓存清除和跟踪我的应用程序中使用的资源版本

也就是说，我有一个网络应用程序，它的资源保持独立并由 nginx 提供服务。资源保存在文件夹中：

```
app_name/img/sprites.png
app_name/css/compressed.css
app_name/scripts/mini.app.js 
```

然后我想用以下形式的 uris 来引用这些：

```
/app_name/#{version}/img/sprites.png 
```

也许

```
/#{version}/app_name/img/sprites.png 
```

其中 #{version} 是要加载的资源的版本。

然后，我希望始终将资源保留在文件系统中的同一位置，并使用 nginx 始终指向相同的文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T12:58:51.013

假设您只想要这三个子目录，如果找不到资源则返回 404，您可以使用[正则表达式位置](http://wiki.nginx.org/HttpCoreModule#location)和[try_files](http://wiki.nginx.org/HttpCoreModule#try_files)来执行此操作：

```
# /app_name/#{version}/img/sprites.png urls:
location ~ ^/app_name/[^/]+(?<resource>/(img|css|scripts)/.+) {
  try_files /app_name$resource =404;
}

# /#{version}/app_name/img/sprites.png urls:
location ~ ^/[^/]+(?<resource>/app_name/(img|css|scripts)/.+) {
  try_files $resource =404;
} 
```

如果您希望位置匹配任何目录而不是仅列出三个目录，您可以将 (img|css|scripts) 替换为 [^/]+。

# email - 切换主要 Gmail 帐户

> ID：10678938
> 
> 赞同：0
> 
> 时间：2012-05-21T02:40:05.730
> 
> 标签：email, gmail

我目前使用 Gmail 帐户作为我的主要电子邮件地址 (myemail@gmail.com)。我有一个与我的网站 (andrew@mydomain.com) 链接的电子邮件地址，该地址当前转发到我现有的 Gmail 帐户。我想将 andrew@mydomain.com 作为我的主要电子邮件地址。我相信我需要采取的步骤如下：

1.  将 andrew@mydomain.com 添加为 Gmail 电子邮件地址
2.  将 andrew@mydomain.com 添加到我的 Mac 邮件帐户
3.  将所有过去在 myemail@gmail.com 的电子邮件转发到 andrew@mydomain.com（我想是通过 Gmail）
4.  设置 myemail@gmail.com 转发到 andrew@mydomain.com

这可能是一个非常简单的更改，但在我开始考虑零停机时间对电子邮件的重要性之前，我想确保我做得正确。如果你对这个过程有任何想法或任何建议，我很想听听他们的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:49:18.733

您*应该*可以通过 POP/IMAP 访问 andrew@mydomain.com 查看您在 myemail@gmail.com 的所有电子邮件，方法是转到 Settings->Accounts and Import。我之前尝试过前向路由，但它并没有像我预期的那样工作，但 POP/IMAP 对我来说就像一个梦想。

奖励信息：如果您确实使用该方法，我强烈建议您为 Chrome 和/或 FF 安装此插件，以比“每当 Google 喜欢它时”更频繁地检查您的 POP/IMAP 帐户[http://www.danielslaughter.com/projects /gmail-pop3-checker-for-greasemonkey/](http://www.danielslaughter.com/projects/gmail-pop3-checker-for-greasemonkey/)

# php - 一张大桌子还是多张桌子？

> ID：10678942
> 
> 赞同：0
> 
> 时间：2012-05-21T02:40:45.650
> 
> 标签：php, database, database-design, datatable

我正在尝试建立一个与 Facebook 群组工作方式类似的网站。用户将能够加入群组，然后在这些群组中发帖。但是，我在创建关于组和帖子的数据库模式时遇到了麻烦。到目前为止，这是我的表模式：

```
Table 1: Users
Table 2: Groups
Table 3: Posts 
```

每次用户在组中发帖时，posts 表都会创建一行。post 表中的该行将具有该帖子所在组的唯一 ID 以及创建该帖子的用户的唯一 ID。我担心 post 表会变得庞大，与 Groups 和 Users 表相比尤其庞大。

考虑到每个组会有很多帖子（数百到数千个），我应该为每个组创建一个新表吗？

非常感谢您对此事的任何和所有意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:44:10.483

一句话，NO。您不应该创建多个表。一组表是合适的。适当地索引它应该没问题。成百上千的帖子对于数据库来说实际上是微不足道的，数据库的设计目的是能够通过适当的索引管理数百万行。表的一列应标识组所有权，但不应将其拆分为不同的表。

在最坏的情况下，您可以在表变得难以管理以适合您的磁盘空间时对其进行分区。但是，它增长到那么大的可能性非常小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:44:42.297

除非你的帖子数以千万计，或者帖子可能非常大，或者你的硬件非常有限，否则你应该可以使用单个 MySQL 表，只要你在 group ID 上有一个索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:45:04.400

除非我们说的是百万以上的行，否则只要您正确索引表（按两个 ID 索引），您将完全没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T10:52:05.403

简而言之，如果数据项之间存在任何类型的依赖关系，则应创建一个新表。您可以在这里更准确地查找它：[http ://en.wiktionary.org/wiki/first_normal_form](http://en.wiktionary.org/wiki/first_normal_form)

虽然它没有说明每次表变得太大时都应该创建一个新表。对于数据库管理员来说，这将是一件事情。在您的示例中，最近的帖子将比 5 个月前的帖子阅读频率更高。为了正确索引并避免数据行中的重复，您可以使用如下结构：

![在此处输入图像描述](../Images/092b1295c55d0b6f34ed3a77079f64ee.png)

*注）这张图说明了；i) 一个用户将发布到一个或多个组，ii) 一个组将有一个或多个用户，iii) 一个帖子将被一个组中的一个或多个用户查看。所有 3 种关系都是一对多的，用户和组之间的基数是多对多的。*

此外，您可以将您的帖子（可能会随着时间的推移而增长的表格）“分组/构建”为数年、数月甚至数周。因此，您将能够说出哪个时间段，从而您也可以将此时间因素设置为您的帖子表中的日期字段，而不是单独的表。

![在此处输入图像描述](../Images/9ac5ecd52314065f5dc09299ec6108fd.png)

# sockets - 发送 DHCP OFFER 数据包的问题

> ID：10678943
> 
> 赞同：-2
> 
> 时间：2012-05-21T02:41:00.980
> 
> 标签：sockets, dhcp

试图实现一个定制的 DHCP 服务器，它只在 BOOTP/DHCP 数据包中发送一个 IP 地址。接收到的DISCOVER数据包解析完成。填充结构后；我无法通过 sendto 功能发送 OFFER 数据包。提供数据包似乎是一个单播数据包，其中目标地址是我们要提供给客户端机器的 IP。

有点困惑；如何使用普通 DGRAM 套接字为不存在的 IP 地址抛出 DHCP OFFER 数据包？还; 扔数据包时是否需要启用 SO_BROADCAST 标志？

任何帮助都非常感谢！

-Thnx，DDPS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T05:31:47.517

我认为使用普通 DGRAM（SOCK_DGRM，IPPROTO_UDP）发送是不行的。因为操作系统会先发出一个 ARP 来定位目的地。您必须使用原始套接字（SOCK_RAW，IPPROTO_RAW），甚至（SOCK_RAW，htons（ETH_P_ALL））。和 setsockopt 与 IPHDRINCL。这意味着您将自己填写IP头。因此，操作系统不会为您检查它并按构造发送。

# javascript - IE9 是否按文档顺序加载 SVG dom？

> ID：10678948
> 
> 赞同：1
> 
> 时间：2012-05-21T02:41:52.567
> 
> 标签：javascript, html, dom, internet-explorer-9, metatag

在 Firefox 中，当服务器向浏览器发出纯 SVG 文档，并且在附加了 onload= 事件的 SVG 元素之前发出 Javascript 脚本元素时，可以确保在下一个 SVG 元素之前已经加载了较早的 SVG 元素一。因此，脚本可以假定它存在于 DOM 中，并且在脚本尝试访问它时可以访问。

但是，在 IE9 中，DOM 元素的加载方式似乎没有保证或顺序。

有没有办法强制纯 SVG 文档（没有 DOCTYPE html5 或 meta xua 标签）在 IE9 中按文档顺序加载？

否则，您在 Javascript 中有很多猴子业务来简单地确保将元素加载到 DOM 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:35:33.383

我在 SVG 或 DOM 规范中找不到任何要求元素按文档顺序加载的内容（只是它们按该顺序绘制）。如果这不是要求，那么您将永远无法保证您期望的行为。我认为你毕竟需要依靠那个“猴子生意”。

一种可能性是在调用元素中添加一个子元素，该子元素是指向目标元素中后代的链接。这**可能会**延迟源元素上的加载事件，直到加载链接。

另一个是`externalResourcesRequired="true"`容器元素上的设置将具有禁用该容器内容的渐进显示的效果，如果该容器包含引用外部资源的元素。换句话说，通过链接到另一个文档并设置该属性，您可以禁用 SVG 的流式传输行为，这可能会在加载事件触发时强制一个完整的 DOM。

# android - Android：在 ViewPager 中更改文本

> ID：10678950
> 
> 赞同：3
> 
> 时间：2012-05-21T02:42:25.700
> 
> 标签：android, textview, imageview, android-viewpager

**背景**

我正在编写一个使用 ViewPager 的应用程序，并且运行良好。我需要能够定位其中一种布局（xml 文件）并更新其上的 textviews 和 imageviews。我尝试使用“v.findViewById”来扩大视图和定位，这似乎是我研究的解决方案，但也许我把它放在正确的位置，需要更好地向我解释。

**我的代码**（不尝试定位）

```
private ImageView circle;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    circle = (ImageView) findViewById(R.id.circles);

    MyPagerAdapter adapter = new MyPagerAdapter();
    ViewPager myPager = (ViewPager) findViewById(R.id.myViewPager);
    myPager.setAdapter(adapter);
    myPager.setCurrentItem(1);
    myPager.setOnPageChangeListener(new MyPageChangeListener()); 
}

private int focusedPage = 0;
private class MyPageChangeListener extends ViewPager.SimpleOnPageChangeListener {
    @Override
    public void onPageSelected(int position) {
        focusedPage = position;

        switch (focusedPage) {
            case 0: circle.setImageResource(R.drawable.circles1); break;
            case 1: circle.setImageResource(R.drawable.circles2); break;
            case 2: circle.setImageResource(R.drawable.circles3); break;
            case 3: circle.setImageResource(R.drawable.circles4); break;
        }
    }
}

private class MyPagerAdapter extends PagerAdapter {

    public int getCount() {
        return 4;
    }

    public Object instantiateItem(View collection, int position) {

        LayoutInflater inflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        int resId = 0;
        switch (position) {
            case 0:
                resId = R.layout.zip;
                break;
            case 1:
                resId = R.layout.forecast;
                break;
            case 2:
                resId = R.layout.settings;
                break;
            case 3:
                resId = R.layout.about;
                break;
        }

        View view = inflater.inflate(resId, null);

        ((ViewPager) collection).addView(view, 0);

        return view;
    }

    @Override
    public void destroyItem(View arg0, int arg1, Object arg2) {
        ((ViewPager) arg0).removeView((View) arg2);
    }

    @Override
    public boolean isViewFromObject(View arg0, Object arg1) {
        return arg0 == ((View) arg1);

    }

    @Override
    public Parcelable saveState() {
        return null;
    }
} 
```

仅供参考：ImageView“cicle”是屏幕底部的 4 个圆圈的图像，在页面更改时更新以显示您所在的屏幕。工作正常，只是想解释一下。

**目标**

在名为“forecast”的布局上更新名为“city”的文本视图。

提前感谢您的帮助！经过这个小障碍，应该很容易航行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T03:07:57.637

好吧，我不保证这行得通，但是我在 ViewPager 使用兼容性包时遇到了类似的问题，我使用以下方法解决了这个问题：

在您的`instatiateItem`函数视图中，使用您的 resId 执行 setTag：

```
view.setTag(resId); 
```

然后，当您需要更改“城市”时，请执行以下操作：

```
View baseLayout = myPager.findViewWithTag(R.layout.forecast);
TextView city = (TextView) baseLayout.findViewById(R.id.city_id); 
```

`R.id.city_id`你的 TextView 的 id在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T16:28:02.027

作为上述建议的一个小补充：

1.  当标签是字符串时，出于某种奇怪的原因，它从未将标签分配给视图，并且总是为 findViewWithTag 返回 null。使用布局ID虽然有效。

2.  确保您检索 onCreate() 之外的视图，最好是在您打算更改文本视图的文本的方法中。尝试在 onCreate 中访问它们会返回 null。我之前的理解是，只要你调用 MyPageAdapter，它就会调用 instantiateItem，所以应该很快就能找到视图。但事实并非如此。

我只是在上面两个问题上烧了一整天，因为在任何地方都没有真正提到它。希望它对未来的人们有所帮助。

# python - 荷兰国旗排序

> ID：10678955
> 
> 赞同：2
> 
> 时间：2012-05-21T02:43:48.207
> 
> 标签：python, sorting

我正在尝试使用[荷兰国旗算法编写一个快速排序算法](http://en.wikipedia.org/wiki/Dutch_national_flag_problem)。我已经尽我所能来完成这项工作，但我真的很沮丧。你能看一下并帮助我找到错误吗？

```
import random

a = []
for i in range(100):
    a.append(random.randint(1, 100))

print(a)
def partion(array, left, right, lPiv, rPiv):
        high = len(array) -1
        p = left
        i = left
        while i < high:
                if array[i] < lPiv and array[i] < rPiv:
                        array[i],array[p]=array[p],array[i]
                        p = p+1
                        i = i+1
                elif array[i] > lPiv and array[i] > rPiv:
                        array[i],array[high]=array[high],array[i]
                        high = high-1
                else:
                        i = i+1

        return [p, high]

def piv(array, left, right):
    aMin = array[left]
    aMax = array[left]

    for i in array:
      if i < aMin:
          aMin = i
      if i > aMax:
          aMax = i
    return [aMin + ((aMax - aMin) /3), aMin + ((aMax-aMin)/3)*2]

def sort(array, left, right, depth):
    apiv = piv(array, left, right)
    part = partion(array, left, right, apiv[0], apiv[1])
    if right-left >= 3:
        piv1 = piv(array, left, part[0])
        part1 = partion(array, left, part[0], piv1[0], piv1[1])
        sort(array, left, part1[0], depth+1)

        piv2 = piv(array, part[0], part[1])
        part2 = partion(array, part[0], part[1], piv2[0], piv2[1])
        sort(array, part[0], part[1])

        piv3 = piv(array, part[1], right)
        part3 = partion(array, part[1], right, piv3[0], piv3[1] )
        sort(array, part[1], right)

    elif right-left < 3:
        if array[right] < array[left]:
            array[right],array[left] = array[left], array[right]
        else:
            return

sort(a, 0, len(a), 1)
print(a) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T05:09:36.440

您的代码中的一些错误

1.  sort() 需要 4 个参数，因此 sort(array, part[0], part[1]) 失败。顺便说一句，深度不是必需的。
2.  `if array[right] < array[left]:`和`sort(a, 0, len(a), 1)`。当它是数组的长度时，Right 超出了数组的索引范围。
3.  piv 应该处理分区而不是整个数组
4.  如果分区中的数字都相同，`aMin + ((aMax - aMin) /3)`并且`aMin + ((aMax-aMin)/3)*2`是相同的索引
5.  因为分区只处理一个分区而不是整个数组，`high = len(array) -1`所以应该是`high = right -1`
6.  `part1 = partion(array, left, part[0], piv1[0], piv1[1])`是错的。Sort() 在开始时对数组进行分区，不要在同一递归中进行两次分区。只需调用排序（数组，...）。
7.  您的分区分区算法错误，我找不到简单的解决方法

* * *

这是我的实现。

```
import random
from itertools import islice
a = []
for i in range(100):
    a.append(random.randint(1, 100))

def partition(array, left, right, lPiv, rPiv):
        q = right -1
        p = left
        r = left
        while p<=q:
            if array[p]<=lPiv:
                array[p], array[r] = array[r], array[p]
                p = p+1
                r = r+1
            elif lPiv<array[p]<=rPiv:
                p = p+1
            else:
                array[p], array[q] = array[q], array[p]
                q=q-1

        return (p, q+1)

def piv(array, left, right):
    aMin = min(islice(a,left,right))
    aMax = max(islice(a,left,right))
    return (aMin + ((aMax - aMin) /3.0), aMin + ((aMax-aMin)/3.0)*2)

def sort(array, left, right):
    if right-left >= 3:
        piv_left, piv_right = piv(array, left, right)
        if piv_left == piv_right:
            return
        pt_left, pt_right = partition(array, left, right, piv_left, piv_right)
        sort(array, left, pt_left)
        sort(array, pt_left, pt_right)
        sort(array, pt_right, right)
    elif right-left <3:
        if left<right and array[right-1] < array[left]:
            array[right-1],array[left] = array[left], array[right-1]

sort(a, 0, len(a))
print a

#test
assert( a==sorted(a) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T04:43:22.240

piv 似乎总是返回相同的值，是吗？也许 for 循环应该在 array[left:right] 上而不是在整个数组上？

# iis - IIS URL重写规则重定向与掩码？

> ID：10678956
> 
> 赞同：2
> 
> 时间：2012-05-21T02:43:54.780
> 
> 标签：iis, url-rewriting, rewrite

我有一个这样的网址：

[http://www.example.com/erf4d](http://www.example.com/erf4d)

（其中 erf4d 可以是任何 5 个字符的字符串）

我想将用户重定向到：

[http://www.example.com/viewentry.aspx?ID=erf4d](http://www.example.com/viewentry.aspx?ID=erf4d)

我已经使用 web.config 中的重写规则完成了这项工作，但是我希望 [http://www.example.com/erf4d](http://www.example.com/erf4d)保留在 URL 栏中，这样用户就不会看到“丑陋”的 viewentry.aspx？ ID=erf4d 一种重定向掩码，如果你愿意的话。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T09:27:18.127

根据我的经验，URL 重写是反过来使用的。所以页面实际上是 viewentry.aspx?ID=123 并且重定向会将其重定向到 /123。

我想你可能做错了？如果您使用 IIS 7 中的向导为 SEO 友好的 URL 设置 URL 重写并使用 viewentry.aspx?ID=erf4d 作为基础，它应该可以帮助您到达您需要的地方。

重定向/重写工作，因此如果您转到 test.com/123，它将起作用，但如果您转到 test.com/view.aspx?ID=123，它会将您发送到 test.com/123。我认为你追求的是哪个？

干杯

编辑：这是我使用的一个例子。它将读取 news.aspx?page=1 并重写为 news/1/。但由于规则，news/1/ 实际上也有效，因此如果需要，可以在锚点中以这种方式引用。

```
 <rule name="Redirect - /news.aspx?page=a to /news/a/" enabled="true" stopProcessing="true">
                <match url="^news\.aspx$" />
                <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                    <add input="{REQUEST_METHOD}" pattern="^POST$" negate="true" />
                    <add input="{QUERY_STRING}" pattern="^page=([0-9]{1,3})$" />
                </conditions>
                <action type="Redirect" url="news/{C:1}" appendQueryString="false" />
            </rule>
            <rule name="Rewrite - /news/a/ to page=a" enabled="true" stopProcessing="true">
                <match url="^news/([^/]+)/?$" />
                <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                    <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                </conditions>
                <action type="Rewrite" url="news.aspx?page={R:1}" />
            </rule> 
```

# javascript - 将 for 循环的索引传递给不同的函数

> ID：10678963
> 
> 赞同：0
> 
> 时间：2012-05-21T02:44:22.670
> 
> 标签：javascript, jquery, for-loop

将 for 循环的“i”传递给不同函数的方法是什么？
我需要一个单击函数来更改 <ul> 的左侧位置，但是在每次单击时，它必须根据其索引位置使用存储在数组中的值。

```
var currentPosition = new Array();

// store some values in an array
function slide() {
  for (j = 0; j < 5; j++) {
    var positions = 100 * j;
    currentPosition.push(positions);
    function moveIt(j);
  }
}

function moveIt(j) {
  $(document).on('click','#left', function() {
    $('ul').animate({'left': currentPosition[j]  + 'px'});
  })   
}

slide(); 
```

[http://jsfiddle.net/cadence96/gTQ3M/1/](http://jsfiddle.net/cadence96/gTQ3M/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:49:11.927

只需删除`function`循环最后一行中的关键字

```
var positions = 100 * j; 
currentPosition.push(positions); 
function moveIt(j); 
```

像这样

```
var positions = 100 * j; 
currentPosition.push(positions); 
moveIt(j); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T02:47:01.767

```
function slide() {
  for (var j = 0; j < 5; j++) {
    var positions = 100 * j;
    currentPosition.push(positions);
    //function moveIt(j); <=================== delete this.
        moveIt(j); //<======================== Change to this.
  }
} 
```

[**你更新的小提琴**](http://jsfiddle.net/gTQ3M/4/)

# php - php preg_match 问题

> ID：10678964
> 
> 赞同：0
> 
> 时间：2012-05-21T02:44:24.903
> 
> 标签：php

使用以下 php preg_match 如果有人在 textarea 表单中输入除 az 或 0-9 之外的任何值，我将尝试显示错误消息。只有用户可以键入字符串和数值。不是，<? >任何 php、javascript 标签等。

```
if(preg_match("/^[a-zA-Z0-9]+/ ", $wall) != 1)
$err[] = "Wrong value"; 
```

因此，如果我将**php 标签**放在表单的开头，那么它会显示错误消息，但如果我输入“一些文本然后键入**php 标签**和另一个值”，那么它不会显示任何错误消息。

对不起我的英语不好。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:56:45.303

您可以检查是否有任何您不想要的字符。

```
if(preg_match("/[^a-zA-Z0-9]/ ", $wall)) {
  $err[] = "Wrong value";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:58:41.740

```
if( preg_match("/^[a-zA-Z0-9]+$/ ", $wall) ) {
    $err[] = "Wrong value";
} 
```

您必须锚定开头和结尾，否则他们可以键入`a#$@#$@#$#`.

此外，最后不需要`!= 1`。没有它，它更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:48:12.150

因为您已将表达式设置为检查字符串开头的字母数字字符，使用`^`

如果你把它改成这个，这将检查它是否在字符串的任何地方都有一个 < 或 >：

```
if(preg_match("/[<|>]+/ ", $wall))
$err[] = "Wrong value"; 
```

# struts2 - struts 2 和 Jasper 图表

> ID：10678965
> 
> 赞同：2
> 
> 时间：2012-05-21T02:44:28.837
> 
> 标签：struts2, jasper-reports, ireport, jfreechart

我正在使用 struts 2 并想用 jasper 创建图表。我已经创建了要传递给 jasper 的数据源。我已经使用 ireport 设计了图表（只是拖动图表没有制作图表样式）。

使用空数据源，然后我将字段名称设置为与我传递的属性相同，但它仍然会生成一个空图表。在报告中它有效，但在图表中它没有。当我使用数据构建图表时必须应用一些技巧？谁能帮我？这与构建图表中的数据集有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T12:26:59.410

您的数据源不应该只是一个对象列表。JasperReport 字段需要实现一些方法才能有效地使用内存。所以jasper可以一一获取海量数据。因此您的对象类必须实现

> JR数据源

或者你可以简单地使用

> JRBeanCollectionDataSource

反而。

我个人更喜欢后一种选择：

[http://jasperreports.sourceforge.net/api/net/sf/jasperreports/engine/data/JRBeanCollectionDataSource.html](http://jasperreports.sourceforge.net/api/net/sf/jasperreports/engine/data/JRBeanCollectionDataSource.html)

# c - 不成功的malloc？

> ID：10678967
> 
> 赞同：0
> 
> 时间：2012-05-21T02:44:36.733
> 
> 标签：c, malloc, windows-7-x64

我正在尝试用文件中的数据填充结构数组并使用`malloc()`. 数组大小约为 500，每次迭代分配的内存为 2 到 6 个字节。它在 Windows XP 上完美运行，但是当我在 Windows 7 x64 上运行它时，`malloc`总是在迭代 109 中返回 null。我不能用完 RAM，因为我有 8Gb。知道它可能是什么或如何解决它吗？

编辑：这是代码

```
typedef struct
{
    char mnemo[5];
    char *op1;
    char *op2;
    int tam;
    int codigo;
}instruction; 
```

...

```
 while(!feof(archivo))
{

    fscanf(archivo,"%s",Tabla[i].mnemo);
    fscanf(archivo,"%s",ops);
    if(strchr(ops,',')==NULL){
        Tabla[i].op1=(char *)malloc(strlen(ops)+1);
        strcpy(Tabla[i].op1,ops);
        Tabla[i].op2=NULL;
    }
    else{
        Tabla[i].op1=(char *)malloc(strchr(ops,',')-ops+1);
        strncpy(Tabla[i].op1,ops,strchr(ops,',')-ops);
        Tabla[i].op1[strchr(ops,',')-ops]=0;
        ops=strchr(ops,',')+1;
        Tabla[i].op2=(char *)malloc(strlen(ops)+1);
        strcpy(Tabla[i].op2,ops);
    }
    fscanf(archivo,"%s",codigo);
    Tabla[i].codigo=(int)strtol(codigo,NULL,2);
    fscanf(archivo,"%d",&Tabla[i].tam);
    //printf("\n%s %s %s %x %d",Tabla[i].mnemo,Tabla[i].op1,Tabla[i].op2,Tabla[i].codigo,Tabla[i].tam);
    i++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T12:16:57.037

看看这个声明：

```
ops=strchr(ops,',')+1; 
```

由于内存和指针布局，这可能无法跨平台工作。你可以试试

```
ops=strchr(ops,','); ops++; 
```

祝你好运

# javascript - 按钮 Onclick 事件和backbone.js 视图

> ID：10678968
> 
> 赞同：3
> 
> 时间：2012-05-21T02:44:37.093
> 
> 标签：javascript, backbone.js, backbone-views, backbone-events

我目前有一个包含以下内容的 html 文件：

```
<div class="button1">

    <button class="first" id="up" onclick="tranistionUp">
       Go Up
    </button>

    <button class="last" id="down" onclick="tranistionDown">
       Go Down
    </button>
</div> 
```

我在一个主干.js 视图文件中有以下内容：

```
var BlahView = BackBone.View.extend({
  initialize:function(){},
  blah...
  blah...
 transitionUp: function(){
    blah...
 },
 tranistionDown: function(){
},
render:function (){
    blah....
}; 
}); 
```

当我单击按钮时，我看到两个函数的未定义函数错误，我是新来的主干任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-21T04:17:28.887

您应该在`Backbone.View`.

HTML（添加`id="myButtons"`到容器`div`）

```
<div class="button1" id="myButtons">
  <button class="first" class="button-up">Go Up</button>
  <button class="last" class="button-down">Go Down</button>
</div> 
```

JavaScript（添加`events`）

```
var BlahView = Backbone.View.extend({

  events: {
    "click .button-up": "transitionUp",
    "click .button-down": "tranistionDown",
  },

  transitionUp: function() {
    console.log("Transition up");
  },

  tranistionDown: function() {
    console.log("Transition down")
  }

});

var blahView = new BlahView({ el: $('#myButtons') }); 
```

通过指定属性，您的浏览器`onclick`期望在全局范围内调用函数。您的方法在对象中定义。通常不鼓励使用 HTML 属性绑定事件处理程序，尤其是在您使用 Backbone 时（因为您无法轻松地将事件绑定到视图的特定实例）。`transitionUp``transitionDown`

# java - 读取文件内容

> ID：10678972
> 
> 赞同：1
> 
> 时间：2012-05-21T02:44:51.220
> 
> 标签：java, io

我写了一个程序来读取文件的内容。

```
import java.io.*;

public class FileLineReader {
  public static void main(String args[]) {
    try {
      FileReader reader =
          new FileReader("C:\\Users\\sriram\\Documents\\Java Programs\\" +
                         args[0]);
      BufferedReader buffer = new BufferedReader(reader); 
      String fileContent;
      while ((fileContent = buffer.readLine()) != null) {
        System.out.println(fileContent);
      }
    } catch(Exception e) {
      e.printStackTrace();
    }
  }
} 
```

所以基本上它从特定文件夹中读取内容。如果我输入`FileLineReader.class`哪个是 Java 程序的 .class 文件，程序会输出字节码，但会发出哔哔声。对于所有其他文件，它会正确提供输出。

谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:49:29.217

`FileLineReader.class`很可能是一个二进制（已编译的 Java）文件，它恰好包含一个值为 7 的字节，这是响铃字符的 ASCII 码。当显示 ASCII 7 时，许多终端会发出蜂鸣声。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-21T02:48:56.100

如果您正在阅读二进制文件，它们可以包含代表随机声音的字节序列。当您将这样的序列发送到标准输出时，操作系统将播放声音。

# javascript - 我可以在没有鼠标或键盘的情况下触发 js 函数吗

> ID：10678977
> 
> 赞同：-4
> 
> 时间：2012-05-21T02:45:15.357
> 
> 标签：javascript, javascript-events

使用href调用我知道上面不是一个好习惯（在href中调用javascript函数），但是很多网页使用href调用js函数，所以我需要知道如何在不执行鼠标或键盘的情况下触发js myfunction ，我该怎么办？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:54:53.490

在 body 标签内使用 onLoad 事件怎么样？

# java - 如何使用由不同类创建的类的实例？

> ID：10678981
> 
> 赞同：0
> 
> 时间：2012-05-21T02:45:46.417
> 
> 标签：java

**登录.java**

```
PortalHandler portalHandler = new PortalHandler(dataString);
...
public PortalHandler getPortalHandler(){
        return portalHandler;
    } 
```

**PortalHandler.java**

```
public String getName()
{
return name;
} 
```

**ThirdClass.java**我想获取由 login.java 创建的实例中的名称，但以下给出了空指针错误

```
Login login;
PortalHandler portalHandler = login.getPortalHandler(); 
```

如何做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T02:49:22.637

您需要`login`像这样初始化： `Login login = new Login()`.

这当然是假设它`Login`有一个不带参数的构造函数。

* * *

^(编辑以回应OP的评论)

我认为你正在寻找做这样的事情：

```
Login login = new Login();
login.doLoginStuff();
PortalHandler portalHandler = login.getPortalHandler();
// Do nothing with login from here on out 
```

然后，您可以做任何您需要做的事情`portalHandler`并忘记`login`. 但是您*必须*`login`先使用`new Login()`（或 的构造函数之一）进行初始化，`Login`然后才能使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T02:53:48.360

我的猜测很大，但我想知道您的问题是否是您有多个登录变量，一个不为空并显示，一个未显示为空，并且您正在尝试调用一个方法。您需要对显示的那个的引用。

回答这个问题：您是否已经显示了登录对象？

如果是这样，那么您需要*对该*登录对象的引用才能调用该`getPortalHandler()`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T02:54:39.543

您的答案在您的问题之内 - “我如何使用由不同类创建的类的**实例？”**

为了使用实例，您首先必须创建它。您有以下行...

```
Login login; 
```

这不会创建实例，它只是将变量声明为*能够*保存 type 的对象`Login`。当您编写此行时，它只是指向 a 的指针`null`，直到您调用其中任何一个...

```
login = new Login();
Login login = new Login(); 
```

这将创建该类的一个新实例，然后允许您访问其中的方法，例如`login.getPortalHandler();`

如果`PortalHandler`在完成对象后需要保留以供使用，则需要在清理对象之前`Login`获取对的引用。`PortalHandler``Login`

例如...

```
PortalHandler portalHandler;

public void doLogin(){
    Login login = new Login();
    login.performLogin();
    portalHandler = login.getPortalHandler();
} 
```

在此示例中，Login 实例仅在`doLogin()`方法的长度内存在，在此之后它不再是有效对象。但是，您在完成之前已经引用了该`PortalHandler`对象，并将其存储为全局变量，因此您可以随时继续使用`PortalHandler`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T04:34:56.067

伙计们，我认为问题可能是 user521180 已经`login`在他的代码中的其他地方创建了一个实例，该实例进一步创建了一个实例，`PortalHandler`他现在想`name`从该`PortalHandler`对象访问。

您的解决方案让他做的是创建另一个`login`对象并`name`通过这个新创建的对象进行访问，该对象**可能**具有完全不同的值，`name`因为它将是`name`由不同的`PortalHandler`.

@ user521180：如果是这种情况，那么您还需要在该代码中有一个方法（或全局变量），它创建一个`login`对象，该对象以某种方式返回`PortalHandler`. 因为在堆中检索其引用丢失或无法访问的对象的引用是不可能的（有些人可能不同意它的不可能部分）。

# wordpress - 将博客实施到预先存在的页面的最快方法是什么？

> ID：10678982
> 
> 赞同：0
> 
> 时间：2012-05-21T02:46:02.083
> 
> 标签：wordpress, blogs

例如，将最近的博客条目内嵌到主页中，然后将博客存档放在可以单击的单独页面上。

目前没有博客，我对如何实现它非常不知道。这将只是我自己写的，评论会很好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:17:03.987

```
 <iframe src="http://your.wordpress.org/blog/url/here"></iframe> 
```

是我能想到的最直接的方式。

# javascript - 仅在 IE9 上存在的 ajax 调用中的访问被拒绝

> ID：10678985
> 
> 赞同：3
> 
> 时间：2012-05-21T02:46:14.460
> 
> 标签：javascript, ajax, internet-explorer, xmlhttprequest

我在使用 Xmlhttprequest 进行 ajax 调用时遇到了这个问题。我在 Firefox、Chrome、Safari 上测试了代码，它们都运行良好。只有IE上存在的问题，我用的版本是9。有人说我应该启用跨域支持。实际上，我将 Access-Control-Allow-Origin: * 添加到 http 响应标头中。有任何想法吗？谢谢。

我的代码是：

```
var xhr = new XMLHttpRequest();
var query = queryString.pageName.abbr + "="
        + encodeURIComponent(queryString.pageName.value) + "&"
        + queryString.pageURL.abbr + "="
        + encodeURIComponent(queryString.pageURL.value);
var getURL = "http://localhost:10001/test?" + query;

xhr.open('GET', getURL, false);
var result;
xhr.onreadystatechange = function() {
    var responseBody;
    if (xhr.readyState == 2) { // headers and status received
        alert(xhr.status);
    } else if (xhr.readyState == 4) { // full body received
        result = xhr.responseText;
    }
};
xhr.send(null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T21:46:40.850

这里有人有同样的问题：[http](http://css-tricks.com/forums/discussion/17449/xmlhttprequest-not-working-in-ie9/p1) ://css-tricks.com/forums/discussion/17449/xmlhttprequest-not-working-in-ie9/p1 。也许这会有所帮助：http: [//msdn.microsoft.com/en-us/library/cc288060](http://msdn.microsoft.com/en-us/library/cc288060)。和其他人一样，我也建议使用 jQuery。他们考虑这些问题：[http ://bugs.jquery.com/ticket/8283](http://bugs.jquery.com/ticket/8283)

# php - 如何在 Windows 7 中运行 PHP 邮件脚本？

> ID：10678993
> 
> 赞同：0
> 
> 时间：2012-05-21T02:47:21.577
> 
> 标签：php, forms, email, xampp

我正在尝试使用 xampp 在我的本地计算机（Windows 7）中运行 PHP 邮件脚本。我可以成功运行 PHP 邮件表单，但是在发送电子邮件时它会显示此消息-

```
**Warning: mail() [function.mail]: SMTP server response: 553 We do not relay non-local mail, sorry. in C:\xampp\htdocs\mail\sendeail.php on line 146** 
```

如何解决这个问题，或者是否可以使用 xampp 以任何其他方式从我的本地计算机发送电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-18T08:24:30.320

在观看了这么多 YouTube 视频和博客之后，这对我有用：

1.  确保您的 SMTP 服务状态显示为 ACTIVATED --> 转到[此 URL](http://iaji.net/how-to-send-email-within-xampp.html)以获得一个不错的演示。

2.  转到[此 URL](http://www.google.com/settings/security)，使用您将用于测试 php 电子邮件的 gmail 帐户登录，然后在“安全”选项卡中，找到“访问安全性较低的应用程序”，然后单击“启用”（您始终可以在 php 电子邮件后再次禁用它测试）。

3.  从一个全新的`php.ini`文件开始（希望您制作了原始文件的副本`php.ini`）。这样做的原因是您将拥有一个`php.ini`未被篡改的文件。中的以下这些行`php.ini`必须被注释（有前导`;`）或未注释（没有前导`;`），这是至关重要的）：

    ```
    [mail function]
    ; XAMPP: Comment out this if you want to work with an SMTP Server like Mercury
    ;SMTP = localhost
    ;smtp_port = 25

    sendmail_path = "\"C:\xampp\sendmail\sendmail.exe\" -t"

    ;sendmail_path="C:\xampp\mailtodisk\mailtodisk.exe"

    extension=php_openssl.dll 
    ```

    你别管了`php.ini`。

    **所以让我们仔细检查这些行是否被注释（有一个前导`;`）：**

    ```
    ;SMTP= local host 
    ;smtp_port = 25
    ;sendmail_path="C:\xampp\mailtodisk\mailtodisk.exe" 
    ```

4.  然后`sendmail.ini`必须如下 - 我基本上在这里复制了整个东西。上面写着`your.email.gmail`输入您自己的 gmail 地址，与密码相同：

    ```
    [sendmail]
    ; you must change mail.mydomain.com to your smtp server,
    ; or to IIS's "pickup" directory.  (generally C:\Inetpub\mailroot\Pickup)
    ; emails delivered via IIS's pickup directory cause sendmail to
    ; run quicker, but you won't get error messages back to the calling
    ; application.

    smtp_server=smtp.gmail.com

    ; smtp port (normally 25)

    smtp_port=465

    ; SMTPS (SSL) support
    ;   auto = use SSL for port 465, otherwise try to use TLS
    ;   ssl  = alway use SSL
    ;   tls  = always use TLS
    ;   none = never try to use SSL

    smtp_ssl=auto

    ; the default domain for this server will be read from the registry
    ; this will be appended to email addresses when one isn't provided
    ; if you want to override the value in the registry, uncomment and modify

    ;default_domain=mydomain.com

    ; log smtp errors to error.log (defaults to same directory as sendmail.exe)
    ; uncomment to enable logging

    error_logfile=error.log

    ; create debug log as debug.log (defaults to same directory as sendmail.exe)
    ; uncomment to enable debugging

    ;debug_logfile=debug.log

    ; if your smtp server requires authentication, modify the following two lines

    auth_username=your.email@gmail.com
    auth_password=your email password

    ; if your smtp server uses pop3 before smtp authentication, modify the 
    ; following three lines.  do not enable unless it is required.

    pop3_server=
    pop3_username=
    pop3_password=

    ; force the sender to always be the following email address
    ; this will only affect the "MAIL FROM" command, it won't modify 
    ; the "From: " header of the message content

    force_sender=

    ; force the sender to always be the following email address
    ; this will only affect the "RCTP TO" command, it won't modify 
    ; the "To: " header of the message content

    force_recipient=

    ; sendmail will use your hostname and your default_domain in the ehlo/helo
    ; smtp greeting.  you can manually set the ehlo/helo name if required

    hostname= 
    ```

# vb.net - 如何在 vb .net 中获取任何已连接打印机的型号

> ID：10678996
> 
> 赞同：4
> 
> 时间：2012-05-21T02:48:03.657
> 
> 标签：vb.net, printers

正如问题所述，我需要使用 vb dotNet 找到打印机的型号。

目前一直在使用 EnumPrinters API 并检查驱动程序名称，但是某些打印机由同名驱动程序支持（即驱动程序支持一系列打印机），这不允许我区分它们。

我需要输出为`<manufacturer> <model> <codes>`.

这可能与 vb.net/任何其他语言

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-27T17:50:01.920

不会为您编写整个代码，但请查看 DriverName 属性。在调试模式下运行整个事情以查看您可以使用的其他属性。您需要添加对 System.Drawing 和 System.Management 的引用。

```
Imports System.Drawing.Printing
Imports System.Management

Module Module1

    Sub Main()
        Dim printers = PrinterSettings.InstalledPrinters

        For Each printerName As String In printers
            Dim query As String = String.Format("SELECT * from Win32_Printer WHERE Name LIKE '%{0}'", printerName)
            Dim searcher As ManagementObjectSearcher = New ManagementObjectSearcher(query)
            Dim collection As ManagementObjectCollection = searcher.Get()

            For Each printer As ManagementObject In collection
                For Each propData As PropertyData In printer.Properties
                    Debug.WriteLine(String.Format("{0}: {1}", propData.Name, propData.Value))
                Next
            Next
        Next
    End Sub

End Module 
```

# sql - SQL server 2005 group by 具有相同的列但不同的日期和时间？

> ID：10678997
> 
> 赞同：4
> 
> 时间：2012-05-21T02:48:11.480
> 
> 标签：sql, sql-server, sql-server-2005, grouping

大家...目前我有一张如下表..

```
DATE               BATCHNO     PRODCODE
----------------------------------------------
31/12/2009 23.53    10859       2003P
01/01/2010 00.04    10860       2003P
01/01/2010 00.06    10861       2003P
01/01/2010 00.13    10862       2003P
01/01/2010 00.30    10863       1259
01/01/2010 03.02    10864       639B
01/01/2010 03.13    10865       639B
01/01/2010 03.20    10866       639B
01/01/2010 04.13    10867       2003P
01/01/2010 04.20    10868       2003P
01/01/2010 04.30    10863       2003P 
```

以上是我现在拥有的表格的示例。每当有新的 BATCHNO 并且 BATCHNO 增加 1 时，都会生成 DATE 。PRODCODE 是机器制造产品的产品代码，假设产品 2003P 完成制造，它会自动转到其他产品，例如 1259...

我想将这些数据计算成以下期望的结果：

```
DATE               PRODCODE
----------------------------------------------
31/12/2009 23.53     2003P
01/01/2010 00.13     2003P
01/01/2010 00.30     1259
01/01/2010 00.30     1259
01/01/2010 03.02     639B
01/01/2010 03.20     639B  
01/01/2010 04.13     2003P
01/01/2010 04.30     2003P 
```

这意味着 31/12/2009 23.53 是产品 2003P 的开始时间，而 01/01/2012 00.13 是产品 2003P 的停止时间.. 产品 1259 是特殊的，因为 01/01/2010 00.30 之前只生产 1 个产品移至其他产品..基本上我不能使用分组，因为它将按所有相同代码的产品分组..问题是检测特定产品代码的开始时间和停止时间。. 如何做到这一点？这是针对 SQL SERVER 2005 ...

谢谢大家 ..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T05:32:55.510

```
select U.[DATE], U.PRODCODE
from
  (
    select min(T.[DATE]) as StartDate,
           max(T.[DATE]) as EndDate,
           T.PRODCODE
    from 
      (
        select [DATE],
               PRODCODE,
               row_number() over(order by [DATE]) as rn1,
               row_number() over(order by PRODCODE, [DATE]) as rn2
        from YourTable
      ) T
    group by T.PRODCODE, T.rn2-T.rn1
  ) T
unpivot
  (
    [DATE] for D in (StartDate, EndDate)
  ) U
order by U.[DATE] 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/70711/sql-server-2005-group-by-with-same-column-but-different-date-and-time)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T03:06:19.613

思路：加一列获取下一个DIFFERENT片开始时间的id，去掉查询填充。然后创建另一列，但这次保存之前的不同片结束时间。此类任务的代码将是子查询

```
update table set 
    prev=(select top 1 batchno from table x where x.prodcode!=table.prodcode  and x.date<table.date order by x.date DESC)+1, 
    next=(select top 1 batchno from table x where x.prodcode!=table.prodcode and x.date>table.date order by x.date ASC)-1 
```

这样你就有了每个产品的界限。从现在开始你只是

```
select prodcode, prev, next from table group by prodcode, prev, next 
```

`prev=prodcode`最后在and上的最后一个查询中加入表中的日期`next=prodcode`。

祝你好运 ：）