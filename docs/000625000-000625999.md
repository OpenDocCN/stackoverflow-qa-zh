# StackOverflow 问答 000625000-000625999

# c - 将 char** 转换为 char* 或 char

> ID：625010
> 
> 赞同：1
> 
> 时间：2009-03-09T04:27:10.443
> 
> 标签：c, pointers, char, c-strings

我有一个旧程序，其中使用了一些库函数，但我没有那个库。

所以我正在使用 c++ 库编写该程序。在那个旧代码中，有一些函数是这样调用的

*string = newstrdup("这里有一些字符串");

字符串变量被声明为 char **string；

他可能在那个名为“newstrdup”的函数中做什么？我尝试了很多东西，但我不知道他在做什么......谁能帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T04:36:53.290

该函数用于制作 c 字符串的副本。这通常是获取字符串文字的可写版本所必需的。它们（字符串文字）本身是不可写的，因此这样的函数将它们复制到分配的可写缓冲区中。然后，您可以将它们传递给修改给定参数的函数，例如`strtok`写入它必须标记的字符串。

我认为你可以想出这样的东西，因为它被称为***new*** *strdup*：

```
char * newstrdup(char const* str) {
    char *c = new char[std::strlen(str) + 1];
    std::strcpy(c, str);
    return c;
} 
```

使用字符串完成后，您应该释放它

```
delete[] *string; 
```

另一种编写方式是使用`malloc`. 如果库是旧的，它可能使用了 C++ 从 C 继承的那个：

```
char * newstrdup(char const* str) {
    char *c = (char*) malloc(std::strlen(str) + 1);
    if(c != NULL) {
        std::strcpy(c, str);
    }
    return c;
} 
```

现在，您应该`free`在完成后使用释放字符串：

```
free(*string); 
```

如果您使用 C++ 编写，则更喜欢第一个版本。但如果现有代码`free`再次用于释放内存，请使用第二个版本。请注意，`NULL`如果没有内存可用于复制字符串，则第二个版本会返回，而在这种情况下，第一个版本会引发异常。当您将`NULL`参数传递给您的`newstrdup`. 取决于您的图书馆，可能允许或不允许。因此，如有必要，请在上述函数中插入适当的检查。`strdup`在 POSIX 系统中有一个名为 available 的函数，但该函数既`NULL`不允许参数，也不允许使用`C++`operator new 来分配内存。

无论如何，我已经用谷歌代码搜索`newstrdup`功能找到了很多。也许您的图书馆是其中的结果：

[谷歌代码搜索，newstrdup](http://www.google.com/codesearch?hl=en&start=10&sa=N&q=newstrdup)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T04:59:37.747

他们编写了一个“新”版本的 strdup 肯定是有原因的。所以必须有一个角落案例，它以不同的方式处理。就像一个空字符串可能会返回一个空字符串。

litb 的答案是[strdup](http://linux.die.net/man/3/strdup)的替代品，但我认为他们这样做是有原因的。

如果要直接使用 strdup，请使用定义来重命名它，而不是编写新代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-27T13:50:18.713

这条线`*string = newstrdup("Some string goes here");`没有表现出任何奇怪`newstrdup`。如果`string`有类型`char **`，则`newstrdup`只是`char *`按预期返回。大概`string`已经设置为指向`char *`要放置结果的类型的变量。否则代码正在通过未初始化的指针写入..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T04:33:27.277

newstrdup 可能正在创建一个与传递的字符串重复的新字符串；它返回一个指向字符串的指针（它本身就是一个指向字符的指针）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T04:35:16.027

看起来他编写了一个 strdup() 函数来操作现有指针，可能会将其重新分配到新的大小，然后填充其内容。很可能，他这样做是为了在循环中重复使用相同的指针，其中 *string 将频繁更改，同时防止每次后续调用 strdup() 时发生泄漏。

我可能会像 string = redup(&string, "new contents") .. 那样实现它，但这只是我。

**编辑**：

这是我的“redup”功能的一个片段，它可能正在做一些类似于你发布的事情，只是以不同的方式：

```
int redup(char **s1, const char *s2)
{
    size_t len, size;

    if (s2 == NULL)
        return -1;

    len = strlen(s2);
    size = len + 1;

    *s1 = realloc(*s1, size);

    if (*s1 == NULL)
        return -1;

    memset(*s1, 0, size);
    memcpy(*s1, s2, len);

    return len;
} 
```

当然，如果 realloc() 失败，我可能应该保存 *s1 的副本并恢复它，但我不需要那么偏执。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T04:57:50.557

我认为您需要查看代码中的“字符串”变量发生了什么，因为 newstrdup() 函数的原型似乎与库 strdup() 版本相同。

代码中是否有任何 free(*string) 调用？

这似乎是一件奇怪的事情，除非它在内部保留重复字符串的副本并再次返回指向同一字符串的指针。

再次，我会问为什么？

# java - 如何使用 Wrapper.exe 传递系统属性

> ID：625011
> 
> 赞同：7
> 
> 时间：2009-03-09T04:27:28.337
> 
> 标签：java, windows-services, wrapper

如何将属性传递给使用 Wrapper.exe 作为 Windows 服务启动的 Java 进程？

目标代码调用：

```
System.getProperty("ADMIN_USERNAME"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T04:39:38.900

[http://wrapper.tanukisoftware.org/doc/english/prop-java-additional-n.html](http://wrapper.tanukisoftware.org/doc/english/prop-java-additional-n.html)

您可以设置将转到 JVM（而不是您的主类）的“附加参数”，并且 -DADMIN_USERNAME=gandalf 应该在那里工作。

```
wrapper.java.additional.1=-Xrs
wrapper.java.additional.2=-Dprop=TRUE
wrapper.java.additional.3=-DADMIN_USERNAME=gandalf 
```

**更新：**您必须从*additional.1*开始并且不加间隔地进行计数（这是将列表硬塞到Java 属性语法中的约定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T04:35:43.170

您可以在包装配置文件中设置某些属性，请参阅此链接：

[http://wrapper.tanukisoftware.org/doc/english/properties.html](http://wrapper.tanukisoftware.org/doc/english/properties.html)

我相信您还可以将包装器配置为启动 java 并使用 java "-Dproperty=value" 语法传递其他属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T05:07:58.100

这是在黑暗中拍摄的，但是您是否考虑过使用 JMX 与服务进行通信？或者这是你需要的过度杀伤力？

尤瓦尔=8-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-04T11:01:51.427

@Thilo 的回答是正确的，但我觉得我必须补充一点，您必须注意**JAVA_OPTS**环境变量。许多人/服务器倾向于使用它（例如：远程调试），因为您放入 JAVA_OPTS 的任何内容都会作为 JVM 参数传递给任何新的 JVM。如果您设置了此环境变量，那么任何`wrapper.java.additional.<n>` **都将被忽略**。我在艰难的路上发现了这一点：）

# unicode - 如果我们有代理对，为什么要使用 UTF-32 而不是 UTF-16？

> ID：625018
> 
> 赞同：14
> 
> 时间：2009-03-09T04:31:34.070
> 
> 标签：unicode, surrogate-pairs

如果我理解正确的话，UTF-32 可以处理宇宙中的每一个字符。通过使用代理对，UTF-16 也可以。那么使用 UTF-32 而不是 UTF-16 有什么好的理由吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T04:38:58.137

在 UTF-32 中，一个 unicode 字符总是由 4 个字节表示，因此解析代码比 UTF-16 字符串更容易编写，因为在 UTF-16 中，一个字符由不同数量的字节表示。不利的一面是，UTF-32字符**总是**需要 4 个字节，如果您主要使用英文字符，这可能会很浪费。因此，它的设计选择取决于您的要求是使用 UTF-16 还是 UTF-32。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T06:10:19.573

有人可能更喜欢处理 UTF-32 而不是 UTF-16，因为处理代理对几乎总是处理“特殊情况”，而必须处理这些特殊情况意味着您有可能因为您处理而出现错误的区域错误地处理它们（或者更有可能根本忘记处理它们）。

如果 UTF-32 增加的内存使用不是问题，那么降低复杂性可能足以成为选择它的优势。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-19T12:47:15.427

这也是来自 The Unicode Consortium 的一个很好的文档。

[UTF-32、UTF-16、UTF-8的优势比较](http://www.unicode.org/versions/Unicode5.2.0/ch02.pdf#G11178)

> 版权所有 © 1991–2009 Unicode, Inc. Unicode 标准，版本 5.2
> 
> 从表面上看，UTF-32 似乎是用于内部处理代码的 Unicode 编码形式的明显选择，因为它是一种固定宽度的编码形式。它可以与 C 和 C++ 一致地绑定`wchar_t`，这意味着这些编程语言可以提供内置支持和现成的字符串 API，程序员可以利用这些 API。但是，UTF-16 具有许多抵消优势，可能导致实施者选择它作为内部处理代码。虽然所有三种编码形式每个字符最多需要 4 个字节（或 32 位）的数据，但实际上 UTF-32 在几乎所有实际数据集的情况下占用的存储空间是 UTF-16 所需的两倍。因此，一个常见的策略是让内部字符串存储使用 UTF-16 或 UTF-8，但在处理单个字符时使用 UTF-32。
> 
> **UTF-32 与 UTF-16。**平均而言，超过 99% 的 UTF-16 数据使用单个代码单元表示。这几乎包括软件需要通过对文本进行特殊操作来处理的所有典型字符，例如格式控制字符。因此，大多数文本扫描操作根本不需要解压缩 UTF-16 代理对，而是可以安全地将它们视为字符串的不透明部分。对于很多操作来说，UTF-16 和 UTF-32 一样容易处理，而 UTF-16 作为处理代码的性能往往相当不错。UTF-16 是大多数支持 Unicode 的实现选择的内部处理代码。除了 Unix 平台，UTF-16 提供了紧凑大小与处理 BMP 之外的偶尔字符的能力的正确组合。在软件编码设计和维护的简单性方面，UTF-32 具有一定的优势。因为字符处理是固定宽度的，UTF-32处理不需要在软件中维护分支来测试和处理UTF-16补充字符所需的双码单元元素。相反，大表中的 32 位索引并不是特别有效的内存。为了避免此类索引的大量内存损失，Unicode 表通常作为多级表处理（请参阅第 5.1 节，转码到其他标准中的“多级表”）。在这种情况下，32 位代码点值被分割成更小的范围，以允许对表进行分段访问。即使在典型的 UTF-32 实现中也是如此。UTF-32 作为处理代码的性能实际上可能比 UTF-16 对相同数据的性能更差，因为额外的内存开销意味着将更频繁地超出缓存限制并且内存分页将更频繁地发生。对于具有对 16 位对齐访问施加惩罚但具有非常大的内存的处理器设计的系统，这种影响可能不太明显。无论如何，Unicode 代码点不一定符合用户对“字符”的期望。例如，以下不是由单个代码点表示的：组合字符序列，例如 ; 用于韩语的联合 jamo 序列；或梵文连词“ksha”。因为某些 Unicode 文本处理必须知道并处理这样的字符序列作为文本元素，UTF-32 的固定宽度编码形式的优势在某种程度上被处理文本元素的固有可变宽度特性所抵消。请参阅 Unicode 技术标准 #18，“Unicode 正则表达式”，了解由于用户对“字符”身份的期望，通常实现的流程处理固有可变宽度文本元素的示例。UTF-8。就使用的字节数而言，UTF-8 相当紧凑。当用于东亚实现（例如中文、日文和韩文）时，它实际上只是在大小上处于显着劣势，这些实现使用需要 UTF-8 中的三字节代码单元序列的韩语表意文字或韩文音节。UTF-8 在处理方面的效率也明显低于其他编码形式。二进制排序。UTF-8 字符串的二进制排序与 Unicode 代码点的二进制排序相同。这显然与二进制排序的 UTF-32 字符串的顺序相同。
> 
> **一般结构**
> 
> 当只处理 BMP 字符（在 U+0000..U+FFFF 范围内）时，所有三种编码形式对于二进制字符串比较或字符串排序给出相同的结果。但是，在处理补充字符时（在 U+10000..U+10FFFF 范围内），UTF-16 二进制顺序与 Unicode 代码点顺序不匹配。当尝试与二进制排序列表进行互操作时，这可能会导致复杂化——例如，在 UTF-16 系统和 UTF-8 或 UTF-32 系统之间。但是，对于根据特定语言或区域设置而不是使用二进制顺序排序的数据，无论编码形式如何，数据都将按相同的顺序排序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T04:35:34.213

简短的回答：没有。

更长的答案：是的，为了与其他没有得到备忘录的东西兼容。

不那么讽刺的回答：当您更关心索引速度而不是空间使用时，或者作为某种中间格式，或者在对齐问题比缓存问题更重要的机器上，或者......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T05:09:41.310

UTF-8 也可以表示任何 unicode 字符！

如果你的文本*主要是*英文，你可以通过使用 utf-8 节省大量空间，但索引字符不是 O(1)，因为有些字符占用不止一个字节。

如果空间对您的情况不像速度那么重要，utf-32 会更适合您，因为索引是 O(1)

对于非英语文本，UTF-16 可能比 utf-8 更好，因为在 utf-8 中，有些字符占用 3 个字节，而在 utf16 中它们只占用两个字节。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-09T08:56:46.723

可能有几个很好的理由，但一个是加快索引/搜索，即在数据库等中。

使用 UTF-32，您知道每个字符是 4 个字节。使用 UTF-16，您不知道任何特定字符的长度。

例如，您有一个返回字符串的第 n 个字符的函数：

```
char getChar(int index, String s ); 
```

如果您正在使用具有直接内存访问权限的语言（例如 C）进行编码，那么在 UTF-32 中，此函数可能就像一些指针算术 ( `s+(4*index)`) 一样简单，其数量为 O(1)。

但是，如果您使用的是 UTF-16，则必须遍历字符串，边进行解码，这将是 O(n)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-19T12:58:23.033

通常，您只需使用底层平台的字符串数据类型/编码，通常是（Windows、Java、Cocoa...）UTF-16，有时是 UTF-8 或 UTF-32。这主要是出于历史原因；三种 Unicode 编码之间几乎没有区别：这三种都定义明确、快速且健壮，并且它们都可以编码每个 Unicode 代码点序列。UTF-32 的独特之处在于它是一种固定宽度编码（意味着每个代码点都由一个代码单元表示）在实践中几乎没有用处：您的内存管理层需要了解代码的数量和宽度单位，用户对抽象字符和字素感兴趣。正如 Unicode 标准所提到的，Unicode 应用程序必须处理组合字符、连字等以及代理对的处理，

如果我要重塑世界，我可能会选择 UTF-32，因为它只是最简单的编码，但就目前而言，差异太小而无法引起实际关注。

# c++ - C++ 类最佳实践

> ID：625023
> 
> 赞同：4
> 
> 时间：2009-03-09T04:34:34.763
> 
> 标签：c++, class

我想知道设计 c++ 类时的一些最佳实践。

为了把它放在上下文中，我有一个名为 Vec3 的 c++ 类。

```
class Vec3{
private:
    float elements[3];
public:
    Vec3(Vec3 v1){...}
    Vec3(int x, int y, int z){...}
    Vec3 add(Vec3 v1){...}
    Vec3 add(int x, int y, int z){...}
    ...
    Vec3 multiply(Vec3 v1){...}
    ...
    int dotProduct(Vec3 v1){...}
    Vec3 normalize(){...}
    ....
    int operator[](int pos){...}
}; 
```

所以，我有这个类可以计算大小为 3 的向量。我想知道什么更好。是否使用指针。

我是否应该返回指针并将我的参数作为指针。

Vec3 add(Vec3 v1) 或 Vec3* add(Vec3 v1) 或 Vec3* add(Vec3* v1) 或 ....

现在我很困惑，我不知道我是否应该在课堂上使用指针。我想总有一种方法可以将我的参数发送给不处理指针的函数......

```
Vec3* v2 = new Vec3(1,1,1);
Vec3 sum = v1.add(*v2); 
```

并且有一个解决方案可能是我能想到的最好的解决方案......同时具有这两种功能

```
Vec3 add(Vec3 v2){...}
Vec3* add(Vec3* v2){...} 
```

但我担心这会导致重复代码并且可能是开销。

谢谢您的回答...顺便说一句，我可以使用模板来更改 Vector 的大小，但我更喜欢单独保留我的 Vec3 类并创建一个 Vec4 类或将其命名为四元数。

***编辑*** 这是我带来的解决方案。随意评论或修改或重用代码。一件事。我只想提一下，就我而言，此类应该是透明的。就像我们添加数字一样。

```
int i = 10;
int j = 15;
int k = i + k; 
```

如果添加重载修改在这种情况下调用函数的对象 i。我最终会认为 ak 是对 i 的引用，并且 i 等于 25。但是我们在这里真正想要的是 ak 等于 25 并且 i,k 不变。

我的课就是这样工作的。Vec3 k = i + k 不会修改 i 或 k，因为我们正在从这些值创建一个新数字。我返回引用的唯一情况是 +=、-=、++、--...、set([XYZ])？并正常化。

做类似 myvec.setX(10).normalize().scale(10) 这样的事情可能会很有趣

注意：比例应该返回一个参考。我没有看到它，但我想这样应该会更好。

```
Vec3 t = myvec.normalize().scale(100).copy(); 
```

[http://pastebin.com/f413b7ffb](http://pastebin.com/f413b7ffb)

谢谢大家，我现在将学习 Matrix 课程。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T04:45:37.920

这些是我通常坚持的规则。请注意“通常”，有时会有不同的做事方式......

对于我不打算修改的参数，如果它们不是太大，我会按值传递，因为它们将被复制。如果它们有点大或不可复制，您可以使用 const 引用或指针（我更喜欢 const 引用）。

对于我确实打算修改的参数，我使用参考。

对于返回值，我将尽可能返回一个副本。有时返回引用很方便（这适用于获取/设置的单个函数，在获取或设置项目时不需要进行任何特殊处理）。

在我看来，指针真正闪耀的地方是例如我想要控制何时构造或破坏它的变量。

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T04:44:55.597

由于 int 是原语，所以保持原样。对于任何带有 vec3 的使用参考。

例如。

```
Vec3 add(const Vec3 &v1){...} 
```

在 C 中，您会使用指针，但在 C++ 中，引用通常更适合对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T06:36:52.067

向量具有已知的语义（为您和您的类的用户所知），因此我会考虑重载运算符（+、-、+=、-=）这样做，我会使用常规定义而不是更改它们：

```
// instead of add:
class Vec3 {
public:
   Vec3& operator+=( Vec3 const & rhs );
};
// implemented as free function:
Vec3 operator+( Vec3 const &lhs, Vec3 const & rhs); 
```

我会避免使用指针。引用更自然，只有极少数情况下您确实需要它们而不是引用/值。避免重复您的函数（带/不带指针），因为这会使您的代码不必要地更加复杂，正如您已经在问题中发布的那样，您始终可以取消引用指针以检索引用。

提供常量和非常量运算符[]：

```
class Vec3 {
public:
   float operator[]( size_t pos ) const; // returns copy, data does not change
   float& operator[]( size_t pos );  // returns a reference and allows changing the contents
}; 
```

编辑：我忘了提及 size_t 细节：更喜欢使用 unsigned / size_t 作为索引参数而不是有符号整数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T04:46:21.817

如果你实现像`operator+=()`and这样的操作符`operator*=()`，你会希望它返回`*this`as `Vec3&`。

```
Vec3& operator+=(const Vec3& v2) {
    // add op
    return *this;
} 
```

对于像你这样的其他基本运算符`operator+()`，您`add()`将需要返回一个**副本**：

```
Vec3 operator+(const Vec3& v2) {
    Vec3 ret;
    // add
    return ret;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T05:41:33.340

在这种情况下，您几乎肯定不希望参数成为指针。考虑这个例子，了解原因：

```
// Error: not possible to take the address of the temporary
//        return value. 
v2.add(&someFunctionReturningVec3()); 
```

对于常量的引用是没有问题的。您甚至可以轻松嵌套操作：

```
// declaration: Vec3 add(Vec3 const& v);
v2.add(v1.add(v3)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T05:12:24.360

在这种情况下，不需要将参数作为指针，而且你真的不应该为所有这样的运算符返回一个新对象。
在 OO 编程中，想法是对实际对象进行操作，例如

```
无效添加（Vec3 v1）；
无效乘法（Vec3 v1）；

```

我还要说您应该坚持将 Vec3 对象作为参数（而不是 x、y、z）。如果你只有 x,y,z，你可以调用 add(Vec3(x,y,z))。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T05:19:24.360

此页面包含有关此主题的非常好的讨论：[http ://www.cs.caltech.edu/courses/cs11/material/cpp/donnie/cpp-ops.html](http://www.cs.caltech.edu/courses/cs11/material/cpp/donnie/cpp-ops.html)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-03-09T05:08:24.200

正如 grayfade 提到的，您应该关注复制语义。在这种情况下，您还应该添加这些方法：

```
class Vec3 {
public:
  Vec3(const Vec3& rhs) {
    copy(rhs);
  }

  Vec3 operator=(const Vec3& rhs) {
    copy(rhs);
    return *this;
  }

private:
  void copy(const Vec3& rhs) {
    // copy state from rhs
  }
}; 
```

# css - CSS 菜单不会通过 IE7 中的嵌套 Div 显示

> ID：625025
> 
> 赞同：0
> 
> 时间：2009-03-09T04:35:30.940
> 
> 标签：css, html, menu, nested, drop-down-menu

如果您查看此站点的菜单：[http ://writershore.com/ltlaw/](http://writershore.com/ltlaw/)

该菜单在 Firefox、Chrome 等中看起来很棒，但在 IE7 中，菜单下拉菜单不会突破嵌套的 DIV。

这是溢出问题吗？z-index 问题？我已经尝试了两者的变体，但没有修复 IE 中的结果。

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T05:35:18.597

HTML 代码已损坏。对于初学者，您有两个`<html>`标签。这将使页面以 quirks 模式呈现，这对 IE 产生了巨大的影响。

修复html中明显的错误，然后[验证](http://validator.w3.org/)页面，看看代码是否还有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T13:39:42.517

如果表单元素或框显示在 DIV 之上，例如日历弹出窗口，这不是 javascript 中的错误 - 这是浏览器的错误/功能。看到这个[解释](http://www.webreference.com/dhtml/diner/seethru/ "解释")

# sqlite - 如何从 sqlite 存储和检索 blob？

> ID：625029
> 
> 赞同：71
> 
> 时间：2009-03-09T04:35:49.363
> 
> 标签：sqlite, blob

我在 c++、python 和现在（也许）在 C# 中使用了 sqlite。在所有这些中，我不知道如何将 blob 插入表中。如何在 sqlite 中存储和检索 blob？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-09T09:01:05.123

这是在 C# 中执行此操作的方法：

```
class Program
{
    static void Main(string[] args)
    {
        if (File.Exists("test.db3"))
        {
            File.Delete("test.db3");
        }
        using (var connection = new SQLiteConnection("Data Source=test.db3;Version=3"))
        using (var command = new SQLiteCommand("CREATE TABLE PHOTOS(ID INTEGER PRIMARY KEY AUTOINCREMENT, PHOTO BLOB)", connection))
        {
            connection.Open();
            command.ExecuteNonQuery();

            byte[] photo = new byte[] { 1, 2, 3, 4, 5 };

            command.CommandText = "INSERT INTO PHOTOS (PHOTO) VALUES (@photo)";
            command.Parameters.Add("@photo", DbType.Binary, 20).Value = photo;
            command.ExecuteNonQuery();

            command.CommandText = "SELECT PHOTO FROM PHOTOS WHERE ID = 1";
            using (var reader = command.ExecuteReader())
            {
                while (reader.Read())
                {
                    byte[] buffer = GetBytes(reader);
                }
            }

        }
    }

    static byte[] GetBytes(SQLiteDataReader reader)
    {
        const int CHUNK_SIZE = 2 * 1024;
        byte[] buffer = new byte[CHUNK_SIZE];
        long bytesRead;
        long fieldOffset = 0;
        using (MemoryStream stream = new MemoryStream())
        {
            while ((bytesRead = reader.GetBytes(0, fieldOffset, buffer, 0, buffer.Length)) > 0)
            {
                stream.Write(buffer, 0, (int)bytesRead);
                fieldOffset += bytesRead;
            }
            return stream.ToArray();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-01-14T17:13:30.257

这对我来说很好（C#）：

```
byte[] iconBytes = null;
using (var dbConnection = new SQLiteConnection(DataSource))
{
    dbConnection.Open();
    using (var transaction = dbConnection.BeginTransaction())
    {
        using (var command = new SQLiteCommand(dbConnection))
        {
            command.CommandText = "SELECT icon FROM my_table";

            using (var reader = command.ExecuteReader())
            {
                while (reader.Read())
                {
                    if (reader["icon"] != null && !Convert.IsDBNull(reader["icon"]))
                    {
                        iconBytes = (byte[]) reader["icon"];
                    }
                }
            }
        }
        transaction.Commit();
    }
} 
```

不需要分块。只需转换为字节数组。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-17T15:50:15.460

我最终使用了这种插入 blob 的方法：

```
 protected Boolean updateByteArrayInTable(String table, String value, byte[] byteArray, String expr)
   {
      try
      {
         SQLiteCommand mycommand = new SQLiteCommand(connection);
         mycommand.CommandText = "update " + table + " set " + value + "=@image" + " where " + expr;
         SQLiteParameter parameter = new SQLiteParameter("@image", System.Data.DbType.Binary);
         parameter.Value = byteArray;
         mycommand.Parameters.Add(parameter);

         int rowsUpdated = mycommand.ExecuteNonQuery();
         return (rowsUpdated>0);
      }
      catch (Exception)
      {
         return false;
      }
   } 
```

读取它的代码是：

```
 protected DataTable executeQuery(String command)
   {
      DataTable dt = new DataTable();
      try
      {
         SQLiteCommand mycommand = new SQLiteCommand(connection);
         mycommand.CommandText = command;
         SQLiteDataReader reader = mycommand.ExecuteReader();
         dt.Load(reader);
         reader.Close();
         return dt;
      }
      catch (Exception)
      {
         return null;
      }
   }

   protected DataTable getAllWhere(String table, String sort, String expr)
   {
      String cmd = "select * from " + table;
      if (sort != null)
         cmd += " order by " + sort;
      if (expr != null)
         cmd += " where " + expr;
      DataTable dt = executeQuery(cmd);
      return dt;
   }

   public DataRow getImage(long rowId) {
      String where = KEY_ROWID_IMAGE + " = " + Convert.ToString(rowId);
      DataTable dt = getAllWhere(DATABASE_TABLE_IMAGES, null, where);
      DataRow dr = null;
      if (dt.Rows.Count > 0) // should be just 1 row
         dr = dt.Rows[0];
      return dr;
   }

   public byte[] getImage(DataRow dr) {
      try
      {
         object image = dr[KEY_IMAGE];
         if (!Convert.IsDBNull(image))
            return (byte[])image;
         else
            return null;
      } catch(Exception) {
         return null;
      }
   }

   DataRow dri = getImage(rowId);
   byte[] image = getImage(dri); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-09T06:22:31.557

您需要使用 sqlite 的预处理语句接口。基本上，这个想法是您为您的 blob 准备一个带有占位符的语句，然后使用其中一个绑定调用来“绑定”您的数据......

[SQLite 准备好的语句](http://www.sqlite.org/c3ref/prepare.html)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-03-02T14:15:09.263

由于尚无完整的 C++ 示例，因此您可以通过以下方式插入和检索浮点数据的数组/向量，而无需进行错误检查：

```
#include <sqlite3.h>

#include <iostream>
#include <vector>

int main()
{
    // open sqlite3 database connection
    sqlite3* db;
    sqlite3_open("path/to/database.db", &db);

    // insert blob
    {
        sqlite3_stmt* stmtInsert = nullptr;
        sqlite3_prepare_v2(db, "INSERT INTO table_name (vector_blob) VALUES (?)", -1, &stmtInsert, nullptr);

        std::vector<float> blobData(128); // your data
        sqlite3_bind_blob(stmtInsertFace, 1, blobData.data(), static_cast<int>(blobData.size() * sizeof(float)), SQLITE_STATIC);

        if (sqlite3_step(stmtInsert) == SQLITE_DONE)
            std::cout << "Insert successful" << std::endl;
        else
            std::cout << "Insert failed" << std::endl;

        sqlite3_finalize(stmtInsert);
    }

    // retrieve blob
    {
        sqlite3_stmt* stmtRetrieve = nullptr;
        sqlite3_prepare_v2(db, "SELECT vector_blob FROM table_name WHERE id = ?", -1, &stmtRetrieve, nullptr);

        int id = 1; // your id
        sqlite3_bind_int(stmtRetrieve, 1, id);

        std::vector<float> blobData;
        if (sqlite3_step(stmtRetrieve) == SQLITE_ROW)
        {
            // retrieve blob data
            const float* pdata = reinterpret_cast<const float*>(sqlite3_column_blob(stmtRetrieve, 0));
            // query blob data size
            blobData.resize(sqlite3_column_bytes(stmtRetrieve, 0) / static_cast<int>(sizeof(float)));
            // copy to data vector
            std::copy(pdata, pdata + static_cast<int>(blobData.size()), blobData.data());
        }

        sqlite3_finalize(stmtRetrieve);
    }

    sqlite3_close(db);

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-12-10T21:45:36.303

In C++ (without error checking):

```
std::string blob = ...; // assume blob is in the string

std::string query = "INSERT INTO foo (blob_column) VALUES (?);";

sqlite3_stmt *stmt;
sqlite3_prepare_v2(db, query, query.size(), &stmt, nullptr);
sqlite3_bind_blob(stmt, 1, blob.data(), blob.size(), 
                  SQLITE_TRANSIENT); 
```

That can be `SQLITE_STATIC` [if the query will be executed before `blob` gets destructed](https://stackoverflow.com/a/1229265/15055).

# refactoring - 重构乐趣：处理复杂状态

> ID：625030
> 
> 赞同：0
> 
> 时间：2009-03-09T04:35:51.373
> 
> 标签：refactoring

假设我们有一个 Web 应用程序，它应该让用户填写表格，然后它在后端工作流引擎中创建一个工单。此表单将继续作为客户查看正在发生的事情的门户。有些表格直接用于创建工单；其他人在生成票证之前必须得到其他人的批准，他们也可以被拒绝。这个东西发送电子邮件，跟踪表单问题的答案，跟踪任何上传的附件，并在进行各种操作以更改表单状态时记录“更新”。

决定在首次提交或保存表单时要做什么的业务逻辑开始变得棘手，我正在寻找重构它的方法。我已经开始研究状态/策略模式，但似乎所有逻辑最终都需要集中在一个地方。另外，由于对答案/附件/日志条目的所有依赖，将模拟注入其中变得很复杂，因为它有太多需要跟踪的内容。

这是表单对象的“保存”功能的伪代码布局，简化了......它开始变得令人讨厌，我正在尝试看看我是否可以以某种方式使其更清洁。

```
if(this.isvalid)
{
    if(isNewForm && !this.needsApproval) //just created, so start up a ticket
    {
        CreateTicket();
    }

    if(!isNewForm && justApproved) //pulled from the DB earlier, and was just approved
    {
        CreateTicket();
    }

    if(!isNewForm && justDenied) //pulled from the DB earlier, and was just denied
    {
        this.needsApproval = false;
        this.closed = true;
    }

    if(isNewForm)
    {
        SendNewFormEmail();
        if(this.NeedsApproval)
        {
            SendNeedsApprovalEmail();
        }

        this.CommentEntries.Add("Request submitted.");
    }
    else if(justApproved)
    {
        SendApprovalEmail();
        this.CommentEntries.Add("Request approved.");
    }
    else if(justDenied)
    {
        SendDenialEmail();
        this.CommentEntries.Add("Request denied.");
    }   

    this.Save();

    this.Answers.Save();
    this.Attachments.Save();
    this.CommentEntries.Save();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T04:52:30.383

我最近一直在考虑状态机，我发现以下提议非常有希望。我希望我能告诉你它真的很棒，但我还没有走到那一步。我可以告诉你，它看起来比我迄今为止尝试过的任何解决方案都要好。这是链接..[分层状态机](http://www.eventhelix.com/RealtimeMantra/HierarchicalStateMachine.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T04:54:50.347

```
if (isNewForm) {

   if (JustDenied) {
      ...
   }

   if (JustApproved) {
      ....
   }

} else {
   ... not a new form ...
} 
```

我不确定您如何处理 JustDenied，但也许：

```
switch (FormState) {
case JustApproved:
   ....
case JustDenied:
   ....
} 
```

它的伪代码，很难说这是否可行。但是，是的，我同意你发布的内容开始类似于意大利面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T01:01:50.063

我认为这是 Workflow Foundation 的优秀候选人。

问题不是编写复杂的状态机，而是处理业务的动态（有时也可能看起来像意大利面；））。规则改变，代码需要改变，当你自己发现这一点时，可维护性在这里很容易成为一场噩梦......

# python - Google App Engine 应用程序到 Python 3.x 的升级路径是什么？

> ID：625042
> 
> 赞同：9
> 
> 时间：2009-03-09T04:43:51.497
> 
> 标签：python, google-app-engine

为 Google App Engine 过渡到 Python 3.x 需要什么？

我知道 Google App Engine 至少需要使用 Python 2.5。是否可以在 Google App Engine 上使用 Python 3.0？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T05:30:17.750

目前无法在 Google App Engine 上使用 Python 3.x 应用程序。它根本不受支持，我希望在 Python 3.x 之前看到对 Java（或 Perl 或 PHP）的支持。

也就是说，在 App Engine 上从 Python 2.5 到 Python 3.x 的升级路径可能非常简单。如果/当添加该功能时，只要您对应用程序进行编码以预测[Python 本身的变化](http://docs.python.org/dev/3.0/whatsnew/3.0.html)，它就应该非常简单。繁重的工作必须由 Google 工程师完成。毫无疑问，在 Python 3.0 可用后，您的应用程序可以在很长一段时间内保持 Python 2.5 的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T10:04:23.223

app.yaml 语法已经支持多种语言和多个 API 版本，但目前仅支持其中一种（Python，API 版本 1）。据推测，其中一种扩展机制将用于指定您想要 Python 3，并且由您决定将您的应用程序移植到 Python 3 中工作，然后更改该设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T05:37:58.900

至少目前，Guido 与正在构建 AppEngine 的 Google 团队密切合作。当此选项可用时，您必须**编辑您的主 XAML 文件**。

我同意 Chris B. 的观点，即 Python 3.0 支持可能不会很快出现，但我不确定我是否同意它会比 Perl 或 PHP 更早出现。在去年的 Google I/O 大会上，他们对 AppEngine 将支持哪些未来语言保持沉默，但他们非常清楚他们正在积极探索如何安全地允许其他代码运行这一事实。他们选择支持 Python 的主要原因之一是，由于其动态编译的性质，他们可以支持 3rd 方库扩展，而所有附加组件必须是纯 Python 的最小限制。

如果 Python 3.0 支持比新语言更早引入，我不会感到惊讶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-15T07:03:40.723

由于谷歌似乎不会很快将应用引擎更新到 python 3，因此可能值得关注[Jython](http://wiki.python.org/jython/RoadMap)。到目前为止，他们仍然在 2.6 上工作，但这已经比 2.5 好。

# sql - 在mysql中创建表

> ID：625046
> 
> 赞同：0
> 
> 时间：2009-03-09T04:48:47.147
> 
> 标签：sql, mysql

是否可以使用单个 create table 语句一次创建多个表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T07:54:22.897

对于 MySQL，您可以使用[多查询](http://dev.mysql.com/doc/refman/5.1/en/c-api-multiple-queries.html)在一次调用中执行多个 SQL 语句。您将发出两个`CREATE TABLE`用分号分隔的语句。

但是每个`CREATE TABLE`语句单独只能创建一个表。MySQL 支持的语法不允许同时创建多个表。

@bsdfish 建议使用事务，但 DDL 语句之类的`CREATE TABLE`会导致隐式事务提交。在 MySQL 中，没有办法`CREATE TABLE`在单个事务中执行多个语句。

* * *

我也很好奇为什么你需要同时创建两个表。我能想到的唯一想法是这两个表是否具有循环依赖关系，即它们使用外键相互引用。解决方案是创建没有该外键的第一个表，然后创建第二个表，然后将外键添加到第一个表中`ALTER TABLE ADD CONSTRAINT`。删除任一表都需要相反的类似过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T04:53:04.330

不适用于 MS SQL Server。不确定mysql。

你能提供更多关于你为什么要这样做的信息吗？也许有另一种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T05:04:40.230

我不知道，但我认为你做不到。你为什么要这样做？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T06:20:53.930

不在标准 SQL 中仅使用“CREATE TABLE”语句。但是，您可以在 CREATE SCHEMA 语句中编写多个语句，其中一些语句可以是 CREATE TABLE 语句。下一个问题 - 您的 DBMS 是否支持 CREATE SCHEMA？它有任何不良的副作用吗？

从 MySQL 手册页来看，它确实支持 CREATE SCHEMA 作为 CREATE DATABASE 的同义词。这将是我所指的“不良副作用”之一的一个例子。

（您知道标准 SQL 不提供“CREATE DATABASE”语句吗？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T06:29:01.617

我认为使用“CREATE TABLE”命令创建多个表是不可能的。一切真的取决于你想做什么。如果您希望创建是原子的，那么事务可能是要走的路。如果您在事务中创建所有表，则从事务外部发生的任何事情的角度来看，它将充当单个创建语句。

# django - Django新手：“找不到反向”

> ID：625047
> 
> 赞同：28
> 
> 时间：2009-03-09T04:49:25.600
> 
> 标签：django, django-templates

我在 Django 表单中有一行：

```
{% for aa in my_array %} 
```

这似乎触发了这个错误：

> 模板错误
> 
> 渲染时遇到异常：“dev_env.profiles.views.viewPlan”的反向参数“（”，）”和关键字参数“{}”未找到。

此错误消息的真正含义是什么？

我怀疑这行是正确的，但错误消息是错误的。或者错误是真实的，但这条线是红鲱鱼。

我到底应该寻找什么？

更新：保罗对此进行了排序，如下。

事实上，我还有`{% url viewPlan planId %}`几行（所以报告的错误行是错误的），但是由于planId在这种情况下为空而触发了错误。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-09T04:55:16.290

您是否有一个名为的视图`viewPlan`，您可以在模板中使用它执行以下操作：

```
{% url viewPlan %} 
```

或类似的视图：

```
reverse('viewPlan') 
```

如果您这样做并且没有如下所示的行：

```
url(r'^whatever/url/$', 'dev_env.profiles.views.viewPlan', name="viewPlan"), 
```

...在您的 url 配置中，我想这就是您遇到的错误。或者，更有可能的是，您可能在 viewPlan URL 中捕获了一个值（可能是 id 或其他东西），但在反转 url 时没有传递参数。因此，如果您在正则表达式中捕获任何值，如下所示：

```
url(r'^plans/(\d+)$', 'dev_env.profiles.views.viewPlan', name="viewPlan"), 
```

你需要这样称呼它：

```
{% url viewPlan 15 %} 
```

或者像这样：

```
reverse('viewPlan', args=[15]); 
```

`15`显然捕获的值在哪里。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-07-31T23:56:41.300

有时需要在名称参数中包含 app_label

就像`app_name='core'`在你的 core.urls 中定义一样

然后反转`viewPlan`路径将是：

```
reverse('core:viewPlan', args=[15]); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-01-29T05:05:13.160

我遇到过同样的问题。就我而言，我忘记在主 urls.py 文件中添加子应用程序的 url：

```
urlpatterns = [
    re_path("admin/", admin.site.urls),
    re_path(r"^core/", include("core.urls")),
    re_path(r"^$", welcome, name="welcome")
] 
```

# windows-xp - 有没有办法让应用程序休眠？

> ID：625052
> 
> 赞同：1
> 
> 时间：2009-03-09T04:54:03.220
> 
> 标签：windows-xp

（我不是在谈论 Hibernate 或 NHibernate ORM）

Windows 操作系统（和一些 linux 版本）具有“休眠”选项来保存状态并关闭机器。稍后当我们重新启动时，我们可以从以前存储的状态恢复。

有没有办法单独休眠应用程序？我的意思是我想通过保存它的状态来关闭应用程序，然后当我启动应用程序时，它应该从以前存储的状态恢复。

是否有可用的第三方工具，或者我可以使用第三方库将功能添加到我的应用程序中吗？

编辑：我有一个带有选项卡式界面和 50 多个输入控件的 .Net WinForm 应用程序。我需要一个解决方案来关闭应用程序，然后在文本框中使用相同的值重新启动。我可以编写一个例程来存储和恢复所有文本框值。但我正在寻找一些适用于任何应用程序的通用方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T05:04:39.120

您可以将您的应用程序与其操作系统捆绑为“设备”，并使用 VMWare 之类的东西来休眠整个虚拟机。

或者你可以使用 Smalltalk。

（这两种方法都不是您可以轻松插入现有应用程序的方法，但是，您所要求的似乎确实需要“平台级支持”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-27T14:55:24.917

Microsoft MED-V 应用程序虚拟化可能能够做这样的事情，将来在操作系统本身中拥有更多应用程序虚拟化功能会很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T04:57:11.730

包含您拥有的内存的对象并不太难。问题来自操作系统拥有的资源（窗口、线程、信号量等）。您可以编写一些东西来保存/恢复这些操作系统拥有的资源的状态，但您仍然需要销毁/重新创建它们。

你这样做的目标是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T08:48:54.060

没有一个框架。正如您所建议的，实现此目的的最简单方法是将数据存储在可序列化对象中并将它们序列化到文件中，然后再将它们序列化回。

这并不难，并且可以帮助您完成大部分工作。它也相当通用——您只需要编写几行代码就可以将任意数量的可序列化数据序列化进出。

对于更复杂的事情，例如光标之前所在的位置等状态，应在用户尝试关闭应用程序时推送到可序列化对象中，并在加载应用程序时手动推回。

...但是您的用户很可能不会关心这样的事情，他们可能只关心那里的数据恢复到原来的样子。

# sql - 子查询返回每个父 ID 的最新条目

> ID：625055
> 
> 赞同：3
> 
> 时间：2009-03-09T04:54:55.790
> 
> 标签：sql, db2

我有一个包含文档条目的父表，并且我有一个历史表，每次用户访问其中一个文档时都会记录一个审计条目。

我正在编写一个搜索查询以返回具有最新用户 ID 的文档列表（按各种条件过滤），以访问结果集中返回的每个文档。

因此对于

```
 DOCUMENTS
    ID | NAME
    1  | Document 1
    2  | Document 2
    3  | Document 3
    4  | Document 4
    5  | Document 5

    HISTORY
    DOC_ID | USER_ID | TIMESTAMP
    1      | 12345   | TODAY
    1      | 11111   | IN THE PAST
    1      | 11111   | IN THE PAST
    1      | 12345   | IN THE PAST
    2      | 11111   | TODAY
    2      | 12345   | IN THE PAST
    3      | 12345   | IN THE PAST 
```

我希望从我的搜索中获得回报，比如

```
 ID | NAME       | LAST_USER_ID
    1  | Document 1 | 12345
    2  | Document 2 | 11111
    3  | Document 3 | 12345
    4  | Document 4 | 
    5  | Document 5 | 
```

我可以通过一个 SQL 查询和两个表之间的连接轻松地做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T05:29:44.693

我无法让“HAVING MAX(TIMESTAMP)”在 SQL Server 中运行 - 我想需要一个布尔表达式，如“有 max(TIMESTAMP) > 2009-03-05”或其他东西，这不适用于此案子。（我可能做错了什么......）

这似乎可行 - 请注意连接有 2 个条件（不确定这是否好用）：

```
select
    d.ID,
    d.NAME,
    h."USER_ID" as "LAST_USER_ID"
from Documents d
left join History h
    on d.ID = h.DOC_ID
    and h."TIMESTAMP" =
    (
        select max("TIMESTAMP")
        from "HISTORY"
        where "DOC_ID" = d.ID
    ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T06:07:40.373

修改 Andy White 生成的内容，并将方括号（MS SQL Server 表示法）替换为 DB2（和 ISO 标准 SQL）“分隔标识符”：

```
SELECT d.id, d.name, h.last_user_id
    FROM Documents d LEFT JOIN
         (SELECT r.doc_id AS id, user_id AS last_user_id
              FROM History r JOIN
                   (SELECT doc_id, MAX("timestamp") AS "timestamp"
                        FROM History
                        GROUP BY doc_id
                   ) AS l
                   ON  r."timestamp" = l."timestamp"
                   AND r.doc_id      = l.doc_id
         ) AS h
         ON d.id = h.id 
```

我不确定“timestamp”或“TIMESTAMP”是否正确——可能是后者。

这样做的好处是它用更简单的非相关子查询替换了 Andy 版本中的内部相关子查询，这有可能（从根本上？）更有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T05:34:20.267

这不使用连接，但对于像这样的一些查询，我喜欢内联该字段的选择。如果你想捕捉没有用户访问的情况，你可以用 NVL() 包装它。

```
select a.ID, a.NAME,
(select x.user_id
 from HISTORY x
 where x.doc_id = a.id
   and x.timestamp = (select max(x1.timestamp)
                      from HISTORY x1
                      where x1.doc_id = x.doc_id)) as LAST_USER_ID
from DOCUMENTS a
where <your criteria here> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T05:10:09.967

我认为应该是这样的：

```
SELECT ID, Name,  b.USER_ID as LAST_USER_ID
FROM DOCUMENTS a LEFT JOIN
    ( SELECT DOC_ID, USER_ID 
          FROM HISTORY
              GROUP BY DOC_ID, USER_ID
              HAVING MAX( TIMESTAMP )) as b
    ON a.ID = b.DOC_ID 
```

这也可能有效：

```
SELECT ID, Name,  b.USER_ID as LAST_USER_ID
FROM DOCUMENTS a 
  LEFT JOIN HISTORY b ON a.ID = b.DOC_ID
GROUP BY DOC_ID, USER_ID
HAVING MAX( TIMESTAMP ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T20:55:33.970

```
Select ID, Name, User_ID
From Documents Left Outer Join
History a on ID = DOC_ID
Where ( TimeStamp = ( Select Max(TimeStamp)
                      From History b
                      Where a.DOC_ID = b.DOC_ID ) OR
        TimeStamp Is NULL )  /* this accomodates the Left */ 
```

# asp.net - 中继器控件中的嵌套 Gridview

> ID：625059
> 
> 赞同：1
> 
> 时间：2009-03-09T04:57:39.357
> 
> 标签：asp.net, gridview, nested, repeater

我有一个嵌套在转发器控件中的 gridview 控件。

* * *

转发器控件在页面加载时是数据绑定的，并且在 itemdatabound 事件中我寻找 gridview 控件

If e.Item.ItemType = ListItemType.Item Then Dim gvw As GridView = DirectCast(e.Item.Controls(3), GridView) gvw.DataSource = GetData() gvw.DataBind() End If

在这一切发生之后，我的页面正在显示中继器控件数据和网格视图中的数据，但问题是只有备用网格视图有数据，即中继器控件中的第 1、3、5 行...... 6...不显示数据

标记是 - 只是一个例子

`<repeater>`
`<itemtemplate>`
`<table>`
`<tr>`
`<td>`
`<gridview />`
`</td>`
`</tr>`
`<tr>`
`<td>`
`<label Text='<%# Eval("some_data") %>'`
`</td>`
`</tr>`
`</table>`
`</itemtemplate>`
`</repeater>`

再次，上面的标记只是一个例子，它是完整的

我想我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T05:00:07.777

在您的代码中

```
If e.Item.ItemType = ListItemType.Item Then Dim gvw As GridView = DirectCast(e.Item.Controls(3), GridView) gvw.DataSource = GetData() gvw.DataBind() End If 
```

您应该添加一个“OR”子句来检查 ItemType 是否也是 AlternateItem

```
If e.Item.ItemType = ListItemType.Item OR e.Item.ItemType = ListItemType.AlternateItem Then Dim gvw As GridView = DirectCast(e.Item.Controls(3), GridView) gvw.DataSource = GetData() gvw.DataBind() End If 
```

# powershell - Powershell 和 logparser 参数

> ID：625067
> 
> 赞同：7
> 
> 时间：2009-03-09T05:02:04.790
> 
> 标签：powershell, arguments, logparser

我试图从powershell运行一些logparser命令，但我在正确传递参数时遇到问题，这是我脚本中的excert；

d:\scripting\smtplogs\logparser\logparser.exe "SELECT TOP 50 Receiver, COUNT( *) INTO %TMPOutput%\TopReceiversNDRALL.gif FROM %TempDir%\PostAll.log WHERE Sender LIKE '<>' AND Receiver NOT LIKE '% %go-fmtopper%%' GROUP BY Receiver ORDER BY COUNT(* ) DESC" -i:TSV -iSeparator:space -headerRow:OFF -iHeaderFile:"header3.tsv" -lineFilter:"+10." -o:CHART -chartType:ColumnClustered -config:MyScript.js -chartTitle:"NULL 消息的接收者 ALL for %DateGraph%"

我已经阅读了有关封装参数的大量内容，但似乎无法弄清楚如何使这项工作！

你们可以提供的任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T12:43:10.907

对于复杂的字符串参数，尝试使用 powershell [here-strings](http://www.microsoft.com/technet/scriptcenter/resources/pstips/jun07/pstip0629.mspx)传递参数，这样您就不必担心转义单/双引号

***UPDATE1***：我无法让格式正常工作，所以这里是屏幕截图。 ![替代文字](https://farm4.static.flickr.com/3371/3341399098_1e895e1fb2_o.png)

***UPDATE2***：我终于可以格式化代码了。

```
d:\scripting\smtplogs\logparser\logparser.exe @"
选择 TOP 50 接收者，COUNT()
INTO %TMPOutput%\TopReceiversNDRALL.gif
FROM %TempDir%\PostAll.log
WHERE 发件人喜欢 ''
      AND Receiver NOT LIKE '%%go-fmtopper%%'
按接收方分组
ORDER BY COUNT() DESC"
-i:TSV
-i分隔符：空格
-headerRow：关闭
-iHeaderFile：“header3.tsv”
-lineFilter：“+10。”
-o：图表
-chartType:ColumnClustered
-config:MyScript.js
-chartTitle:"%DateGraph% 的 NULL 消息的接收者
“@

```

确保在此处的字符串名字对象**@"**和**"@**之间添加一个新行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T07:03:15.623

仅供参考，如果您不需要任何 PowerShell 变量扩展，那么您最好在此处使用单引号字符串。例如，下面的双引号字符串可能会让你有些悲伤：

```
@"
$(get-process <some_core_os_process> | stop-process)
"@ 
```

以下是无害的：

```
@'
$(get-process <some_core_os_process> | stop-process)
'@ 
```

您的此处字符串不太可能包含如此明显的内容，但简单的 $f 将解决任何问题，即它将从原始字符串中消失。当然，除非 $f 被定义并设置为 null 或空以外的值。

# jtable - JTable中的单元格编辑

> ID：625070
> 
> 赞同：2
> 
> 时间：2009-03-09T05:03:11.107
> 
> 标签：jtable, cells

我正在使用 JTable 做一个项目，我想让我的表格单元格可编辑。我用了，

```
public boolean isCellEditable(int row, int column)
 {               
 return true;         
 } 
```

我的问题是，单元格是可编辑的，但是一旦在一个单元格中输入数据并移动到下一个单元格后，以前的数据就会被删除......请任何人帮助我......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T05:43:08.797

也覆盖 setValueAt(Object value, int row, int col) 方法。它应该存储输入的数据，因此 getValueAt(int row, int col) 方法可以返回新值。像这样的东西：

```
private String[][] data;
public Object getValueAt(int row, int col) {
    return data[row][col];
}
public void setValueAt(Object value, int row, int col) {
    data[row][col] = value;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:40:18.600

```
public void setValueAt(Object value, int row, int col) {
    datum[row][col]=value;
    fireTableCellUpdated(row, col);
} 
```

# command-line - 运行，命令行和那个路径变量

> ID：625071
> 
> 赞同：0
> 
> 时间：2009-03-09T05:03:32.727
> 
> 标签：command-line, ant, path

我在命令行和运行 Ant 时遇到了一个非常奇怪的问题。我将路径变量指向我的 Ant bin 目录 (C:\Ant\bin) 的位置，当我进入命令窗口并键入 PATH 时，它会显示其中的位置。但是当我通过键入“ant”来运行 Ant 时，它什么也不做，并声明它无法识别。但是当我进入运行窗口（Windows+R）并输入“ant”时，它会运行它。

我已重新启动 Windows 两次，但问题仍然存在。我正在运行安装了 SP1 的 Windows Vista Ultimate。我试过“以管理员身份运行”，没有任何区别。

有没有人经历过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T05:12:00.260

有时你可以设置一个系统范围的（甚至只是个人的）环境变量，它会治愈它，而不是仅仅在你的 shell 中设置它。

转到控制面板，然后是系统，然后是高级，然后在环境变量上查找按钮。从那里，你可以跟随你的鼻子。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T05:13:04.250

Ant 还依赖于 Java 走上这条道路。你有吗？

我还会检查以确保在控制台中正确设置了环境变量 ANT_HOME 和 JAVA_HOME。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T05:14:14.153

您尝试在其中运行 Ant 的命令窗口是否有可能与您设置并验证其在路径中的 cmd windwo 不同的窗口？如果 PATH 在 cmd 窗口已经打开后更新，它将不会重新识别更改。不清楚这是否是你的问题。

如果您在目录 C:\Ant\bin 中并键入“ant”，它会识别它吗？

# web - 为什么同一个网址打开不同的网页？

> ID：625074
> 
> 赞同：0
> 
> 时间：2009-03-09T05:05:12.053
> 
> 标签：web, ip-address, geo

当我打开一些 URL 时，我遇到了一件奇怪的事情。网址是[(www.jobserve.com)](http://www.jobserve.com)

当我从家里打开这个 URL 时，它会打开一些网页。如果我从我的办公室网络打开相同的 URL，我会得到一个完全不同的 URL，这正是我想要的。

我的家和办公室都在印度的同一个城市（相距 3 公里！），但不知何故，从我的家庭网络，我得到了一个完全不同的页面，这不是我想要打开的。（在办公室一是想要的。办公室网络有代理/防火墙，可以屏蔽IP地址以向外界开放！）。

我的问题是为什么会这样，因为这两种访问都来自同一个国家/城市（但是不同的 ISP！），所以不能有一个国家/IP 特定的主机/内容与同一服务器的全球内容不同。

那么这里会发生什么？

这在我脑海中提出了另一个问题（当我尝试使用 nslookup 和返回错误的域名查找服务器的 IP 时 - “找不到 www.jobserve.com/：不存在的域”）：- 我怎么能找到使用 nslookup 以外的域名的 Web 服务器的 IP 地址不适用于此特定域/url？

我记得有一些网站可以找到服务器的地理位置并以图形方式显示，但我无法回忆起那个网址？有人知道吗？

谢谢，

-广告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T05:08:30.750

一些站点会查看传入的 IP 地址，查找它的来源，然后采取他们认为与您相关的各种操作 - 通常会将您重定向到更本地的站点。

当然，如果许多网站认为他们“以前见过你”，他们就会做出反应。例如，可能会有 cookie 告诉他们一些关于您的信息。或者，他们可能会对您的浏览器做出反应。

有时，组织会查看源 IP 地址，如果它来自企业，他们的响应可能与来自非企业（“家庭”）IP 的不同。

而且，有时公司会拦截 IP 流量并以各种方式对其进行编辑。这通常不会对网页进行，但如果您的雇主对您在工作中观看色情片不满意（-smile-），他们可能会对此采取措施！...中国以进行这种拦截而闻名...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T05:19:04.237

我在一家英国公司工作，我所有的区域设置都是基于英国的。此外，互联网本身来自英国，所以所有网站都表现得好像我来自英国一样。

Google.com 去 google.co.uk 处女，T 移动广告无处不在

这是否可以说明您为什么在办公室使用不同的网站？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T05:21:40.017

查找 IP 地址：不要使用斜杠。只是

```
nslookup www.jobserve.com 
```

或者，您可以使用[http://www.domaintools.com/](http://www.domaintools.com/)之类的网站（还有很多其他网站，这只是我想到的第一个）。

# java - 哪些 Java IDE 可以很好地与现有的 GUI 配合使用并且可能有助于转换？

> ID：625076
> 
> 赞同：4
> 
> 时间：2009-03-09T05:06:22.470
> 
> 标签：java, user-interface, ide

我有一个大约 85 个“框架”的应用程序，它最初是用 JBuilder 5 编写的——一个早期的 IDE。该应用程序是纯 Java 的，我认为主要是 Swing 和 AWT。所以，核心问题是：哪些 IDE 可以帮助我维护现有应用程序，可能将其从独立应用程序转换为 JSP，并希望还可以通过 GUI 界面帮助进行新开发？

去年夏天（08 年），我下载了 Eclipse，它确实胜过 JBuilder，除了缺少可视化 GUI 所见即所得编辑器——即使在那时，可视化编辑器也已经死了。我喜欢 Ganymede（当前版本）标准工具集，但我担心缺少可视化编辑器。（而且，我在将它集成到现有开发环境中时遇到了很多麻烦。）虽然它允许您使用现有代码，但它甚至没有（当前）GUI 编辑器，所以使用我的旧代码是旧的 -老式的方式（“盲目”）。

在做功课时，我发现一家公司制作/制作了基于 Eclipse 的当前版本的 IDE，该 IDE 有一个成熟的 GUI 环境，他们声称可以轻松开发一个 GUI，然后将其部署为独立的（纯 Java）应用程序，或将其部署为网页（使用 JSP 等）。而且，他们建议，它可以让你使用现有的应用程序，这是我迄今为止发现的其他系统所不具备的。IIRC，许可证约为 250 美元。

对我来说不幸的是，生活事件在那一刻阻止了行动——长话短说，我失去了到他们网站的链接。本以为再找他们就没有问题了，但是“插件”和合作伙伴的数量已经爆炸了！他们现在有近 1200 个插件和大约 60 个 GUI！尤泽！

我来到这里，并从关于“Java 的最佳 IDE”的几个问题之一中得到了 NetBeans 6.5 值得一看的想法。我尝试过这个。*即使在具有 3G 内存等的3ghz*机器上，它也非常慢。但是，它更快地集成到环境中，我喜欢它的部署细节。*然后*我发现它的 GUI 环境只适用于新代码，SO 上的一些人建议它有点脆弱，如果你不得不大量修改它（我需要这样做！）那么它可能会破坏能力的 GUI 以继续在 IDE 中可编辑...

我花了无数个小时做这方面的功课，尤其是在 SO 和他们经常指向的网页上查看这里。很多关于 Java IDE GUI 的文章现在已经很老了，但我还是读过它们，并且学到了很多...

理想情况下，我想找到一种工具：

1.  作为具有良好 GUI 的现代 Java IDE 可以胜任且无需过多麻烦
2.  可以帮助在应用程序类型之间进行转换 - 独立与 JSP（移动？）
3.  可以使用现有的应用程序（不是使用该工具集编写的）。
4.  不会将代码挂接到专有库中。

如果不是在一个工具中，作为多个工具，拥有所有这些能力仍然很好！

**我*不需要*“免费！”**

您的意见表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T07:17:40.580

我建议您再次查看 Visual Editor，因为如果此代码不太复杂（就业务逻辑与 gui 代码混合而言），它应该能够与现有代码一起使用。

否则，您的时间可能会花在将 GUI 代码重构到 Visual Editor 可以处理的状态上。我还没有看到其他可以与现有代码一起使用的免费 IDE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T07:26:17.673

[**NetBeans**](http://www.netbeans.org)是用于 Java 的强大 IDE，并且具有良好的 GUI 构建器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T19:30:13.767

如果您已经拥有 Eclipse，我建议您尝试[MyEclipse](http://www.myeclipseide.org/module-htmlpages-display-pid-1.html)。[它有一个名为Matisse4MyEclipse](http://www.myeclipseide.org/htmlpages-func-display-pid-5.html)的插件，它是一个不错的 GUI 构建器。

# pdf - 如何从 pdf 文档中提取矢量图形？

> ID：625077
> 
> 赞同：4
> 
> 时间：2009-03-09T05:06:58.820
> 
> 标签：pdf

我想制作一个工具，在人类的帮助下从 pdf 文件中提取矢量图形。例如，某人使用该工具打开 pdf 文档，然后选择他想要保存为矢量图的对象。是否有任何工具已经在执行此操作或任何可用于编写我自己的工具的库。库的语言可以是（按优先顺序递减）c#、VB.net、python 或 c/c++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T07:44:22.840

也许这是一种乏味的方式，但是如果您使用 XPS Document Writer 打印它，那么您可以使用 WPF XAML 中的矢量图形。输出文档只是一个包含不同文档元素的 zip 存档

# php - PHP 新手问题 - CMS / 模板

> ID：625081
> 
> 赞同：2
> 
> 时间：2009-03-09T05:09:07.347
> 
> 标签：php, templates, content-management-system

我们计划为学生团体建立一个网站——大部分内容是相当静态的，但某些部分，如活动和成员，会从数据库中出现。我从来没有经常使用 PHP，并且想知道像 Drupal 或 PHP Nuke 这样的 CMS 系统是否适合这种工作？

还有什么可以让我创建模板然后在整个网站上重复使用它的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T05:44:29.290

[Drupal](http://drupal.org/)将是一个非常好的选择。它有它的学习曲线，你选择的任何东西都会。但最终灯泡会熄灭，你会看到它的组织方式和扩展的灵活性。

并且有大量资源可帮助您快速上手。涉及 Drupal 如何工作的各个角度的教程和视频。还有数不胜数的主题，数百个各式各样的附加模块。

在核心发行版中添加了一些额外的模块（当然，cck，也可能是视图和分类），您基本上可以配置所有内容，而无需触及一行 PHP 代码。

安装和开始使用*非常*简单。我在 lil MSI 上网本上的 xampplite 下运行了 Drupal 5 和 6！.. 下载并在 15 分钟内启动并运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T05:31:29.977

您可以试用所有可用的 CMS @http: [//php.opensourcecms.com](http://php.opensourcecms.com)。我以前从未使用过 PHP Nuke，但 Drupal 可以轻松完成这项工作。

查看 Drupal 中的[日历模块](http://drupal.org/project/calendar)以了解事件功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T01:56:20.597

试试 Joomla！不仅在内容管理方面效果最好，而且还有一些扩展，您可以使用这些扩展来允许用户预订会议和安排活动。简单易行。

试试[+Joomla！](http://www.plusjoomla.com)安装和托管，只是担心内容！他们将以超便宜的价格为您服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T22:54:55.063

我推荐 Joomla 1.5。它易于使用，并且在网络上有大量资源。很适合新手。

# python - __init__ 和 self 在 Python 中做了什么？

> ID：625083
> 
> 赞同：922
> 
> 时间：2009-03-09T05:09:51.217
> 
> 标签：python, oop, self

我正在学习 Python 编程语言，但遇到了一些我不完全理解的东西。

在这样的方法中：

```
def method(self, blah):
    def __init__(?):
        ....
    .... 
```

做什么`self`？它是什么意思？它是强制性的吗？

该`__init__`方法有什么作用？为什么有必要？（ETC。）

我认为它们可能是 OOP 构造，但我不太了解。

* * *

## 回答 #1

> 赞同：670
> 
> 时间：2009-03-09T05:18:46.950

在这段代码中：

```
class A(object):
    def __init__(self):
        self.x = 'Hello'

    def method_a(self, foo):
        print self.x + ' ' + foo 
```

...`self`变量表示对象本身的实例。大多数面向对象的语言将此作为隐藏参数传递给定义在对象上的方法。Python 没有。您必须明确声明它。当您创建`A`类的实例并调用其方法时，它将自动传递，如...

```
a = A()               # We do not pass any argument to the __init__ method
a.method_a('Sailor!') # We only pass a single argument 
```

该`__init__`方法大致代表 Python 中的构造函数。当您调用`A()`Python 时，会为您创建一个对象，并将其作为第一个参数传递给该`__init__`方法。任何额外的参数（例如，`A(24, 'Hello')`）也将作为参数传递——在这种情况下会引发异常，因为构造函数并不期望它们。

* * *

## 回答 #2

> 赞同：287
> 
> 时间：2009-03-09T05:18:21.693

是的，你是对的，这些是 oop 结构。

`__init__`是类的构造函数。`self`参数指的是对象的实例（如在`this`C++ 中）。

```
class Point:
    def __init__(self, x, y):
        self._x = x
        self._y = y 
```

`__init__`在为对象分配内存后调用该方法：

```
x = Point(1,2) 
```

`self`如果要将值与对象一起保存，则在对象的方法中使用参数很重要。例如，如果您实现这样的`__init__`方法：

```
class Point:
    def __init__(self, x, y):
        _x = x
        _y = y 
```

您的`x`和`y`参数将存储在堆栈上的变量中，当 init 方法超出范围时将被丢弃。将这些变量设置为`self._x`并将`self._y`这些变量设置为对象的成员（在`Point`对象的生命周期内可访问）。

*注意在此答案中对“构造函数”一词的使用进行了一些澄清。从技术上讲，“构造函数”的职责在 Python 中分为两种方法。这些方法是`__new__`（负责分配内存）和`__init__`（如这里所讨论的，负责初始化新创建的实例）。*

* * *

## 回答 #3

> 赞同：264
> 
> 时间：2013-06-23T12:15:34.777

## 一个简短的说明性示例

希望它可能会有所帮助，这里有一个简单的例子，我用来理解在类中声明的变量和在`__init__`函数中声明的变量之间的区别：

```
class MyClass(object):
    i = 123
    def __init__(self):
        self.i = 345

a = MyClass()
print(a.i)
print(MyClass.i) 
```

输出：

```
345
123 
```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-03-09T05:41:21.327

简而言之：

1.  `self`正如它所暗示的，指的是它*自己*——调用该方法的对象。也就是说，如果您有 N 个对象调用该方法，那么`self.a`将为 N 个对象中的每一个引用一个单独的变量实例。`a`想象一下每个对象的变量的 N 个副本
2.  `__init__`在其他 OOP 语言（如 C++/Java）中称为构造函数。基本思想是它是一个*特殊*的方法，在创建该类的对象时自动调用

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2018-05-01T08:17:20.117

## **类对象**支持两种操作：**属性引用和实例化**

***属性引用***使用 Python 中所有属性引用的标准语法：obj.name。有效的属性名称是创建类对象时类名称空间中的所有名称。因此，如果类定义如下所示：

```
class MyClass:
    """A simple example class"""
    i = 12345

    def f(self):
        return 'hello world' 
```

then`MyClass.i`和`MyClass.f`是有效的属性引用，分别返回一个整数和一个函数对象。类属性也可以赋值，所以可以`MyClass.i`通过赋值来改变值。`__doc__`也是一个有效属性，返回属于该类的文档字符串：“A simple example class”。

***类实例化***使用函数表示法。假设类对象是一个返回类的新实例的无参数函数。例如：

```
x = MyClass() 
```

**实例化**操作（“调用”类对象）创建一个空对象。许多类喜欢创建具有针对特定初始状态定制的实例的对象。因此，一个类可以定义一个名为 的特殊方法`__init__()`，如下所示：

```
def __init__(self):
    self.data = [] 
```

当一个类定义一个`__init__()`方法时，类实例化会自动为新创建的类实例调用`__init__()`。所以在这个例子中，一个新的、初始化的实例可以通过以下方式获得：

```
x = MyClass() 
```

当然，该`__init__()`方法可能具有更大灵活性的论据。在这种情况下，给类实例化运算符的参数将传递给`__init__()`. 例如，

```
class Complex:
    def __init__(self, realpart, imagpart):
        self.r = realpart
        self.i = imagpart

x = Complex(3.0, -4.5)
x.r, x.i 
```

取自最终对我帮助最大的官方[文档](https://docs.python.org/3/tutorial/classes.html)。

* * *

## 这是我的例子

```
class Bill():
    def __init__(self,apples,figs,dates):
        self.apples = apples
        self.figs = figs
        self.dates = dates
        self.bill = apples + figs + dates
        print ("Buy",self.apples,"apples", self.figs,"figs 
                and",self.dates,"dates. 
                Total fruitty bill is",self.bill," pieces of fruit :)") 
```

当您创建 Bill 类的实例时：

```
purchase = Bill(5,6,7) 
```

你得到：

```
> Buy 5 apples 6 figs and 7 dates. Total fruitty bill is 18  pieces of
> fruit :) 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2009-03-09T05:18:20.947

`__init__`确实像一个构造函数。如果您希望它们表现为非静态方法，则需要将“self”作为第一个参数传递给任何类函数。“self”是你的类的实例变量。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2013-05-10T03:03:13.847

试试这个代码。希望它能帮助很多像我这样的 C 程序员学习 Py。

```
#! /usr/bin/python2

class Person:

    '''Doc - Inside Class '''

    def __init__(self, name):
        '''Doc - __init__ Constructor'''
        self.n_name = name        

    def show(self, n1, n2):
        '''Doc - Inside Show'''
        print self.n_name
        print 'Sum = ', (n1 + n2)

    def __del__(self):
        print 'Destructor Deleting object - ', self.n_name

p=Person('Jay')
p.show(2, 3)
print p.__doc__
print p.__init__.__doc__
print p.show.__doc__ 
```

输出：

`Jay`

`Sum = 5`

`Doc - Inside Class`

`Doc - __init__ Constructor`

`Doc - Inside Show`

`Destructor Deleting object - Jay`

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2014-01-09T22:39:09.330

我自己很难理解这一点。即使在阅读了这里的答案之后。

要正确理解`__init__`方法，您需要了解自我。

**自我参数**

该`__init__`方法接受的参数是：

```
def __init__(self, arg1, arg2): 
```

但我们实际上只传递了两个参数：

```
instance = OurClass('arg1', 'arg2') 
```

额外的论点从何而来？

当我们访问对象的属性时，我们通过名称（或通过引用）来访问。这里的实例是对我们的新对象的引用。我们使用 instance.printargs 访问实例对象的 printargs 方法。

为了从`__init__`方法中访问对象属性，我们需要对该对象的引用。

***每当调用方法时，都会将对主对象的引用作为第一个参数传递。***按照惯例，您总是将第一个参数称为您的方法 self。

这意味着在`__init__`我们可以做的方法中：

```
self.arg1 = arg1
self.arg2 = arg2 
```

***这里我们在对象上设置属性。***您可以通过执行以下操作来验证这一点：

```
instance = OurClass('arg1', 'arg2')
print instance.arg1
arg1 
```

像这样的值被称为对象属性。***这里`__init__`方法设置实例的 arg1 和 arg2 属性。***

来源：[http ://www.voidspace.org.uk/python/articles/OOP.shtml#the-init-method](http://www.voidspace.org.uk/python/articles/OOP.shtml#the-init-method)

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2009-03-09T12:50:30.907

请注意，`self`这实际上可能是任何有效的 python 标识符。例如，我们可以从 Chris B 的示例中轻松编写：

```
class A(object):
    def __init__(foo):
        foo.x = 'Hello'

    def method_a(bar, foo):
        print bar.x + ' ' + foo 
```

它的工作原理完全相同。但是建议使用 self ，因为其他 pythoner 会更容易识别它。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2017-10-21T10:01:19.347

> **自我**做什么？它是什么**意思**？是**强制性**的吗？

每个类方法（包括 init）的第一个参数始终是**对当前类实例的引用**。按照惯例，这个参数总是被命名为`self`. 在init方法中，`self`指的是新创建的对象；在其他类方法中，它指的是调用其方法的实例。

Python**不会强迫你使用**“ **self** ”。你可以给它任何你想要的名字。但请记住*，方法定义中的第一个参数是对对象的引用*。Python为您将`self`参数添加到列表中；调用方法时不需要包含它。如果你没有在 init 方法中提供 self 那么你会得到一个错误

```
TypeError: __init___() takes no arguments (1 given) 
```

> **init**方法有什么作用？为什么有必要？（ETC。）

`init`是初始化的缩写。它是一个构造函数，当您创建类的实例时会调用它，**但它不是必需**的。但通常我们的习惯是编写初始化方法来设置对象的默认状态。如果您最初不愿意设置对象的任何状态，则不需要编写此方法。

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2015-09-03T22:19:24.633

1.  **`__init__`**基本上是一个函数，一旦创建并匹配到相应的类，它将**“初始化”** / **“激活”**特定对象的类属性。
2.  **`self`**表示将继承这些属性的对象。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2012-09-23T12:02:55.517

基本上，在同一个类的多个函数中使用变量时，您需要使用“self”关键字。至于**init**，它用于设置默认值，以防该类中没有其他函数被调用。

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2018-04-19T02:50:44.783

只是这个问题的演示。

```
class MyClass:

    def __init__(self):
        print('__init__ is the constructor for a class')

    def __del__(self):
        print('__del__ is the destructor for a class')

    def __enter__(self):
        print('__enter__ is for context manager')
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        print('__exit__ is for context manager')

    def greeting(self):
        print('hello python')

if __name__ == '__main__':
    with MyClass() as mycls:
        mycls.greeting() 
```

* * *

```
$ python3 class.objects_instantiation.py
__init__ is the constructor for a class
__enter__ is for context manager
hello python
__exit__ is for context manager
__del__ is the destructor for a class 
```

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2009-03-09T06:09:20.840

'self' 是对类实例的引用

```
class foo:
    def bar(self):
            print "hi" 
```

现在我们可以创建一个 foo 的实例并调用它的方法，在这种情况下 Python 添加了 self 参数：

```
f = foo()
f.bar() 
```

但是如果方法调用不在类实例的上下文中，它也可以传入，下面的代码做同样的事情

```
f = foo()
foo.bar(f) 
```

有趣的是，变量名“self”只是一个约定。下面的定义将完全一样。虽然说这是**一个非常严格的约定**，应该**始终**遵循，但它确实说明了语言的灵活性

```
class foo:
    def bar(s):
            print "hi" 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2015-08-25T22:02:29.363

在这段代码中：

```
class Cat:
    def __init__(self, name):
        self.name = name
    def info(self):
        print 'I am a cat and I am called', self.name 
```

这里`__init__`作为类的构造函数，当一个对象被实例化时，这个函数被调用。`self`表示实例化对象。

```
c = Cat('Kitty')
c.info() 
```

上述语句的结果如下：

```
I am a cat and I am called Kitty 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2016-07-02T04:15:17.837

```
# Source: Class and Instance Variables
# https://docs.python.org/2/tutorial/classes.html#class-and-instance-variables

class MyClass(object):
    # class variable
    my_CLS_var = 10

    # sets "init'ial" state to objects/instances, use self argument
    def __init__(self):
        # self usage => instance variable (per object)
        self.my_OBJ_var = 15

        # also possible, class name is used => init class variable
        MyClass.my_CLS_var = 20

def run_example_func():
    # PRINTS    10    (class variable)
    print MyClass.my_CLS_var

    # executes __init__ for obj1 instance
    # NOTE: __init__ changes class variable above
    obj1 = MyClass()

    # PRINTS    15    (instance variable)
    print obj1.my_OBJ_var

    # PRINTS    20    (class variable, changed value)
    print MyClass.my_CLS_var

run_example_func() 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2015-08-13T12:22:15.480

在这里，这家伙写得很好很简单：[https ://www.jeffknupp.com/blog/2014/06/18/improve-your-python-python-classes-and-object-oriented-programming/](https://www.jeffknupp.com/blog/2014/06/18/improve-your-python-python-classes-and-object-oriented-programming/)

阅读上面的链接作为对此的参考：

> `self`? 那么所有 Customer 方法的 self 参数是什么？它是什么？为什么，当然是实例！换句话说，像withdraw 这样的方法定义了从某个抽象客户的帐户中提取资金的指令。调用 jeff.withdraw(100.0) 会将这些指令用于 jeff 实例。
> 
> 所以当我们说 defwithdraw(self, amount): 时，我们是在说，“这就是你如何从一个 Customer 对象（我们称之为 self）和一个美元数字（我们称之为 amount）中提取资金。self是正在调用退出的客户的实例。这也不是我在做类比。jeff.withdraw(100.0) 只是 Customer.withdraw(jeff, 100.0) 的简写，这是完全有效的（如果不经常看到的话）代码。
> 
> **init** self 可能对其他方法有意义，但是**init**呢？当我们调用**init**时，我们正在创建一个对象，那么怎么可能已经有一个 self 呢？Python 允许我们将 self 模式扩展到构造对象时，即使它并不完全适合。想象一下 jeff = Customer('Jeff Knupp', 1000.0) 与调用 jeff = Customer(jeff, 'Jeff Knupp', 1000.0); 是一样的。传入的 jeff 也是结果。
> 
> 这就是为什么当我们调用**init**时，我们通过说 self.name = name 来初始化对象。请记住，由于 self 是实例，这相当于说 jeff.name = name，这与 jeff.name = 'Jeff Knupp 相同。同样，self.balance = balance 与 jeff.balance = 1000.0 相同。在这两行之后，我们认为 Customer 对象“已初始化”并可以使用。
> 
> **小心你的`__init__`**
> 
> 在**init**完成后，调用者可以正确地假设该对象已准备好使用。即在 jeff = Customer('Jeff Knupp', 1000.0) 之后，我们可以开始对 jeff 进行存款和取款调用；jeff 是一个完全初始化的对象。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2017-10-25T20:21:54.373

> ## Python`__init__`和`self`它们是做什么的？
> 
> 做什么`self`？它是什么意思？它是强制性的吗？
> 
> 该`__init__`方法有什么作用？为什么有必要？（ETC。）

给出的示例不正确，所以让我根据它创建一个正确的示例：

```
class SomeObject(object):

    def __init__(self, blah):
        self.blah = blah

    def method(self):
        return self.blah 
```

当我们创建对象的实例时，会在对象`__init__`创建后调用 来自定义对象。也就是说，当我们`SomeObject`用`'blah'`下面（可以是任何东西）调用时，它会`__init__`作为参数传递给函数，`blah`：

```
an_object = SomeObject('blah') 
```

`self`参数是`SomeObject`将分配给的实例`an_object`。

稍后，我们可能想要调用这个对象的方法：

```
an_object.method() 
```

进行点分查找，即`an_object.method`，将实例绑定到函数的实例，并且方法（如上所述）现在是“绑定”方法 - 这意味着我们不需要显式地将实例传递给方法调用.

方法调用获取实例，因为它绑定在点分查找上，并且在被调用时，然后执行它被编程执行的任何代码。

隐式传递的`self`参数`self`按约定调用。我们可以使用任何其他合法的 Python 名称，但如果您将其更改为其他名称，您可能会被其他 Python 程序员涂上焦油和羽化。

`__init__`是一种特殊方法，[记录在 Python 数据模型文档](https://docs.python.org/3/reference/datamodel.html#object.__init__)中。在创建实例后立即调用它（通常通过`__new__`- 尽管`__new__`不是必需的，除非您将子类化为不可变数据类型）。

# c# - 如何让 XmlSerializer 将布尔值编码为是/否？

> ID：625091
> 
> 赞同：17
> 
> 时间：2009-03-09T05:14:30.267
> 
> 标签：c#, xml-serialization, boolean

我正在将 xml 发送到另一个程序，该程序期望布尔标志为“是”或“否”，而不是“真”或“假”。

我有一个定义如下的类：

```
[XmlRoot()]
public class Foo {
    public bool Bar { get; set; }
} 
```

当我序列化它时，我的输出如下所示：

```
<Foo><Bar>true</Bar></Foo> 
```

但我希望它是这样的：

```
<Foo><Bar>yes</Bar></Foo> 
```

我可以在序列化时这样做吗？我宁愿不必诉诸于此：

```
[XmlRoot()]
public class Foo {
    [XmlIgnore()]
    public bool Bar { get; set; }

    [XmlElement("Bar")]
    public string BarXml { get { return (Bar) ? "yes" : "no"; } }
} 
```

请注意，我还希望能够再次*反序列*化此数据。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-09T08:51:16.457

好的，我一直在研究这个。这是我想出的：

```
// use this instead of a bool, and it will serialize to "yes" or "no"
// minimal example, not very robust
public struct YesNo : IXmlSerializable {

    // we're just wrapping a bool
    private bool Value;

    // allow implicit casts to/from bool
    public static implicit operator bool(YesNo yn) {
        return yn.Value;
    }
    public static implicit operator YesNo(bool b) {
        return new YesNo() {Value = b};
    }

    // implement IXmlSerializable
    public XmlSchema GetSchema() { return null; }
    public void ReadXml(XmlReader reader) {
        Value = (reader.ReadElementContentAsString() == "yes");
    }
    public void WriteXml(XmlWriter writer) {
        writer.WriteString((Value) ? "yes" : "no");
    }
} 
```

然后我将我的 Foo 类更改为：

```
[XmlRoot()]
public class Foo {      
    public YesNo Bar { get; set; }
} 
```

请注意，因为`YesNo`是隐式可转换为`bool`（反之亦然），您仍然可以这样做：

```
Foo foo = new Foo() { Bar = true; };
if ( foo.Bar ) {
   // ... etc 
```

换句话说，您可以将其视为布尔值。

和w00t！它序列化为：

```
<Foo><Bar>yes</Bar></Foo> 
```

它还可以正确反序列化。

可能有某种方法可以让我的 XmlSerializer 自动将`bool`它遇到的任何 s 转换为`YesNo`s - 但我还没有找到它。任何人？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T05:37:28.917

非常简单。使用代理属性。对实际属性应用 XmlIgnore。代理项是一个字符串，并且必须使用采用元素名称覆盖的 XmlElement 属性。在覆盖中指定*实际属性的名称。*代理属性根据实际属性的值进行不同的序列化。您还必须为 Surrogate 提供一个 setter，并且 setter 应该为它序列化的任何值适当地设置实际属性。换句话说，它需要双向。

剪辑：

```
 public class SomeType 
    {

        [XmlElement]
        public int IntValue;

        [XmlIgnore]
        public bool Value;

        [XmlElement("Value")]
        public string Value_Surrogate {
            get { return (Value)? "Yes, definitely!":"Absolutely NOT!"; }
            set { Value= (value=="Yes, definitely!"); }
        }

    } 
```

单击此处获取[完整的可编译源示例](http://cheeso.members.winisp.net/srcview.aspx?dir=xml-serialization&file=Surrogate.cs)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T05:18:50.913

将 bool 值序列化为“yes”或“no”会完全改变数据类型而不是 boolean。相反，您是否可以添加一个单独的属性来评估布尔值并根据其数据类型返回“是”或“否”？也许您甚至可以通过将返回类型设置为仅指定这些值的枚举来强制“是”或“否”。

```
public YesOrNo DoYouLoveIt
{
    get { return boolToEvaluate ? YesOrNo.Yes : YesOrNo.No; }
} 
```

这可能有点矫枉过正，但可能会满足您的需求。我为这样一个简单的值提出一个枚举的唯一原因是你会限制这些值而不是允许任何字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-30T00:19:53.430

我使用属性方法，但不是检查字符串是否等于是或否，我更喜欢检查字符串是否以（不区分大小写）“YT1”开头。这允许文件包含 true、True、t、T、y、Y、yes、Yes、1 等，所有这些都将评估为 true。虽然我可以指定 false 为 false、False、f、F、n、N、no、No、0 等，但任何与 true 不匹配的内容仍会评估为 false。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T05:38:10.413

您的财产示例可能是您可以做到的最简单的方法。如果有帮助，我相信您不需要将其设为公共属性，因为该属性在您背后的类上实现 ISerializable。要启用反序列化，您应该能够实现`set { Bar = value == "yes"; }`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-26T08:44:41.523

@Blorgbeard：如果您在对象类中有多个 YesNo 类，请确保阅读整个元素。

```
public void ReadXml(XmlReader reader)
{
    string element = reader.ReadOuterXml();
    int startIndex = element.IndexOf('>') + 1;
    int length = element.LastIndexOf('<') - startIndex;

    string text = (element.Substring(startIndex, length).ToLowerInvariant();

    Value = (text == "yes");
} 
```

否则这可能会导致问题。

> ReadXml 方法必须使用由 WriteXml 方法写入的信息来重构您的对象。
> 
> 调用此方法时，读取器位于包装您的类型信息的元素的开头。也就是说，就在表示序列化对象开始的开始标记之前。当此方法返回时，它必须从头到尾读取整个元素，包括其所有内容。与 WriteXml 方法不同，框架不会自动处理包装元素。您的实施必须这样做。未能遵守这些定位规则可能会导致代码生成意外的运行时异常或损坏的数据。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-09T05:23:20.170

你需要做的听起来更像是一个显示问题。如果您的应用程序允许，最好将数据类型保留为布尔值并在用户界面中显示是/否。

# c# - C# 中的开源 SIP 拨号器

> ID：625092
> 
> 赞同：1
> 
> 时间：2009-03-09T05:15:43.620
> 
> 标签：c#, sip

是否有任何开源代码可用于用 C# 或任何其他语言制作 SIP 拨号器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T11:54:54.560

PjSIP 和 Sofiasip 是用于开发您选择的拨号器的两个顶级 SIP 通信库，但是已经开发了许多拨号器。

请检查以下通过 PJSIP sip 堆栈开发的拨号器[列表](http://trac.pjsip.org/repos/wiki/Projects_Using_PJSIP)，列表中的某个人可能满足您的所有要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T07:23:21.300

是的，看看[PJSIP](http://www.pjsip.org/)。它是用非常可移植的 C 语言实现的。但它也有许多其他语言的包装器，例如[.NET 包装器](http://sipekphone.googlepages.com/pjsipwrapper)。

PJSIP，或者说它的 UA（SIP 拨号器）接口 PJSUA 非常容易处理，并且为您处理信令和媒体。哦，它是在 GPL 许可下的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T07:52:53.123

MySIPSwitch 使用 C# SIP 堆栈[mss 源](http://mysipswitch.codeplex.com/)。该堆栈中的媒体支持不完整，但 SIP 堆栈非常好。该堆栈用于运行同名的服务[mss service](http://www.mysipswitch.com)。

# asp.net-mvc - 将视图文件与控制器文件一起分组

> ID：625093
> 
> 赞同：1
> 
> 时间：2009-03-09T05:16:15.443
> 
> 标签：asp.net-mvc

在 WinForm 和 WebForm 应用程序中，Visual Studio 将“View”文件和“Contorller”文件组合在一起。我发现以这种方式管理文件非常容易。

现在在 ASP.Net Mvc 中，我发现很难分别在完全不同的文件夹中管理视图。

有没有办法在 VS 解决方案资源管理器中对视图和控制器文件进行分组，就像我们以前在 WinForm 和 WebForm Application 中所做的那样？

[![替代文字](https://i.stack.imgur.com/MvrD7.jpg)](https://i.stack.imgur.com/MvrD7.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T05:53:01.237

我认为他们是故意这样做的——视图应该独立于控制器。可以这样想：您应该能够将控制器放入完全不同的程序集中，并且仍然可以让您的应用程序正常工作。您的控制器还应该能够使用完全不同的视图集。

该框架还设置为转到视图文件夹以获取适当的文件。如果您决定移动视图，则必须自己更改该行为。可能不值得麻烦。

最后，如果您真的想这样做，您可能应该查看您的项目文件。有一个 DependsUpon 元素，您可以使用它来使一个文件位于另一个文件的下方：

```
<Compile Include="Form1.Designer.cs">
  <DependentUpon>Form1.cs</DependentUpon>
</Compile> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-11T13:42:39.613

您可以使用[VSCommands](http://visualstudiogallery.msdn.microsoft.com/en-us/d491911d-97f3-4cf6-87b0-6a2882120acf)直接从 Visual Studio 对文件进行分组/取消分组

# c# - 公开/传递要在私有列表上使用的 LINQ 表达式

> ID：625102
> 
> 赞同：0
> 
> 时间：2009-03-09T05:19:50.350
> 
> 标签：c#, linq

我有一个私有列表，我想公开查询列表并返回包含新克隆项目的新列表的能力。我可以传入代表进行过滤和排序，这很好，但是能够使用 Linq 表达式会更加优雅。

我添加了一个我正在尝试做的简化示例，这可能会有所帮助，因为我认为我没有很好地解释我想做的事情。

```
public class Repository
{
    private List<SomeModel> _models;
    private object _lock;

    public List<SomeModel> GetModels(Func<SomeModel, bool> predicate)
    {
        List<SomeModel> models;
        lock (_lock)
        {
            models = _models.Where(m => predicate(m))
                            .Select(m => new SomeModel(m))
                            .ToList();
        }
        return models;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T05:25:22.503

为什么您的代码涉及锁定？假设您的“SomeModel”类具有您的示例所建议的复制构造函数，这应该可以工作：

```
public List<SomeModel> GetModels(Predicate<SomeModel> predicate)
{
    return _models.Where(m => predicate(m))
                  .Select(m => new SomeModel(m))
                  .ToList();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:02:14.397

您可以通过执行以下操作将私有集合公开为迭代器块：

```
public IEnumerable<Model> Models
{
    get
    {
        foreach (Model mod in this._models)
            yield return new Model(mod);

        // equivalent to:
        // return _models.Select(m => new Model(m));
        // as per Jon's comment
    }
} 
```

这将使您能够像任何其他 IEnumerable 数据源一样编写针对它的查询。

# c++ - 提取部分字符串的紧凑方法（FASTA 标头）

> ID：625105
> 
> 赞同：0
> 
> 时间：2009-03-09T05:21:58.533
> 
> 标签：c++, string, sequence

给定以下字符串：

```
string Header =">day11:1:356617"; 
```

您如何提取除“>”之外的所有内容，仅产生：

```
day11:1:356617 
```

我可以对字符串字符进行标准循环，并且只保留“>”以外的内容。

```
string nStr ="";
for (int i=0; i < Header.size(); i++) {
    if (Header[i] != ">") {
       nStr = nStr + Header[i];
     }
} 
```

但是这种方法似乎太笨拙和缓慢，特别是我需要对数百万行进行这样的提取。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T05:26:18.163

```
if (Header[0] == '>') Header = Header.substr(1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T05:45:15.187

...您没有说***任何***有关入站字符串的“域”或您要咀嚼的内容。如果它只是您提供的形式的字符串，这将是最快的：

```
Header.substring(1); 
```

# javascript - JQuery 脚本加载时间

> ID：625109
> 
> 赞同：6
> 
> 时间：2009-03-09T05:24:49.027
> 
> 标签：javascript, jquery

如果我有一个触发 jquery 脚本的按钮，是否有办法确保该按钮在脚本完成之前处于非活动状态？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-09T05:35:52.633

这是我喜欢扩展 jQuery 的一个领域：

```
$.fn.disable = function() {
    return this.each(function() {
        if (typeof this.disabled != "undefined") this.disabled = true;
    });
}

$.fn.enable = function() {
    return this.each(function() {
        if (typeof this.disabled != "undefined") this.disabled = false;
    });
} 
```

然后你可以这样做：

```
$("#button").disable();
$("#button").enable(); 
```

我发现自己经常禁用/启用控件。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-09T05:28:35.540

在脚本开头的某处（可能在按钮的单击事件上），将按钮的 disabled 属性设置为 true：

```
$("#mybutton").attr("disabled", true); 
```

然后，完成后，删除该属性：

```
$("#mybutton").removeAttr("disabled"); 
```

编辑：

如果您想（稍微）花哨，请在工作时更改按钮的文本。如果是图片按钮，您可以将 src 更改为友好的“请稍候”消息。这是按钮文本版本的示例：

```
$("#mybutton").click(function() {
  var origVal = $(this).attr("value");

  $(this).attr("value", "Please wait...");
  $(this).attr("disabled", true);

  //Do your processing.

  $(this).removeAttr("disabled");
  $(this).attr("value", origVal);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-08T05:18:18.913

感谢 cletus 提供的功能。我已经使用了您的功能并创建了自己的功能来切换禁用的元素。

```
$.fn.toggleDisable = function() {
    return this.each(function() {
        if (typeof this.disabled != "undefined"){
                if(this.disabled){
                    this.disabled = false;
                }else{
                    this.disabled = true;
                }
        }
    });
} 
```

# sql - 方法“布尔包含（System.String）”不支持对 SQL 的转换

> ID：625123
> 
> 赞同：14
> 
> 时间：2009-03-09T05:34:42.870
> 
> 标签：sql, linq-to-sql

“方法 'Boolean Contains(System.String)' 不支持对 SQL 的转换。”

查询是 IsQueryable 但这停止工作：

```
foreach (string s in collection1)
{
       if (s.Length > 0)
                {
                    query = query.Where(m => m.collection2.Contains(s));

                }
} 
```

更新：当我进行查询“ienumerable”而不是 iqueryable 时，它​​可以工作。使用 linq 而不是通过循环迭代获得相同结果的方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-10-26T14:01:38.947

尝试这个：

```
query = query.Where(m => m.collection2.ToList().Contains(s));
                                       ^^^^^^^^ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T06:03:49.340

看看来自stackoverflow的这个[答案。](https://stackoverflow.com/questions/332670/simple-linq-to-sql-has-no-supported-translation-to-sql)

看起来生成的查询需要访问数据库无法访问的内容，因为信息在内存中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-03T18:26:47.283

由于 m.collection2 在数据库中，所以不要使用 Contains。使用任何

```
m.collection2.Any(x => x == s) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T05:43:42.303

看起来您看到的错误来自集合集合 2。您是否尝试将 m.collection2 包装在另一个返回 true 或 false 的函数中？这是 LINQ 语法吗？

# dynamics-crm - Microsoft Dynamics CRM 4 自定义实体表单加载事件未触发

> ID：625132
> 
> 赞同：1
> 
> 时间：2009-03-09T05:39:21.597
> 
> 标签：dynamics-crm, dynamics-crm-4

对于未触发的自定义实体，我们遇到了表单的 onload 事件问题。该表格在一段时间内确实可以正常工作，但最近已停止工作。现在，当打开表单时，事件中的任何代码都不会执行 - 无论是在创建实体的新实例时还是在打开现有实例时。然而，当预览表单时，代码会被执行。

出于测试目的，原始代码已被删除，并且 onload 事件目前只有以下内容：

```
crmForm.all.ownerid_c.style.display = 'none';
crmForm.all.ownerid_d.style.display = 'none';
alert("OnLoad event fired"); 
```

在预览中，所有者属性被隐藏并显示警报。正常运行表单时，该属性没有隐藏，也没有警报（也没有报告 Java 错误）。

完整的 CRM 版本是 4.0.7333.1219。该实体最初是在不同的 CRM 安装上创建的，该安装最初是版本 3。在我们执行导出 - 导入过程以将其迁移到当前环境之前，该环境已升级到版本 4。该表格在新环境中正常工作了一段时间，但在某个阶段停止了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T21:52:25.360

我使用 Microsoft Crm 诊断工具 4 启用了平台跟踪，现在执行了 onload 事件。再次禁用跟踪时它仍然有效。

上帝，我喜欢在这种环境中发展。

# html - thead/tbody 跨越多页打印的 HTML，但不在第一页上

> ID：625135
> 
> 赞同：0
> 
> 时间：2009-03-09T05:41:57.567
> 
> 标签：html, css

是否有这样做的css方法。使用“运行”或其他 css。我想打印一个 HTML 文档并让 thead/tbody 跨越多个页面。但我不想在第一页上显示标题。

我用来google css thead tbody page print的关键字

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T05:51:55.187

我不确定是否真的有可行的方法来做到这一点。HTML/css 本质上是无页面的：它们对页面没有任何知识或支持。

或者....话又说回来，也许有一些支持。您可以指定[分页符](http://www.javascriptkit.com/dhtmltutors/pagebreak.shtml)。这是[w3schools 参考资料](http://www.w3schools.com/CSS/css_ref_print.asp)。

# c - 结构 calloc c

> ID：625138
> 
> 赞同：0
> 
> 时间：2009-03-09T05:43:21.790
> 
> 标签：c, struct, calloc

C99 海合会

我不断收到此错误。我在 main 外面有一个结构。在 main 内部，我尝试使用 calloc 在堆栈上进行分配。我似乎无法找出问题所在。

感谢您的任何建议，

错误：')' 标记之前的预期表达式

```
/* global */
struct port_data_t                                                                      
{                                                                                       
    size_t task_id;                                                                     
    pthread_t *thread_id;                                                               
    size_t start_port;                                                                  
    size_t number_ports;                                                                
} *port_data;                                                                           

/* main function */
struct port_data_t *port_data = (struct task_data_t*) calloc(4, sizeof(port_data*)); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T05:48:03.293

应该是`calloc(4, sizeof(*port_data))`：注意 *在*e* var 名称之前。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T05:47:20.250

应该是 sizeof(port_data_t) 而不是 sizeof(port_data*)。前者是 port_data_t 结构的大小。后者没有任何意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T05:51:56.607

尝试改变这个：

```
struct port_data_t *port_data = (struct task_data_t*) calloc(4, sizeof(port_data*)); 
```

对此：

```
port_data = (struct port_data_t*) calloc(4, sizeof(*port_data)); 
```

可能会好一点。如果您已声明`port_data`为全局结构，则无需将其重新声明为`struct port_data_t`. GCC 应该已经知道了。当然，我会怎么做是这样的：

```
port_data = (struct port_data_t*) calloc(4, sizeof(struct port_data_t)); 
```

但我不喜欢将变量放入`sizeof()`. 我试着坚持把类型放在那里，只是出于习惯。此外，它还解决了关于指针究竟需要如何被取消引用的任何歧义，这在这种情况下会让您感到困惑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T05:55:37.657

```
#include <malloc.h>
#include <pthread.h>

typedef struct port_data_t {
    size_t task_id;
    pthread_t *thread_id;
    size_t start_port;
    size_t number_ports;
} port_data_t;

port_data_t* f() {
    port_data_t* ports = (port_data_t*)calloc(4, sizeof(port_data_t));
    return ports;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T05:50:48.170

正如 Jeffamaphone 所指出的，task_data_t 与上下文无关。Crashworks 还指出，如果您希望将结构数组放入 port_data，请尝试 sizeof (port_data_t)。

使用 sizeof (port_data*) 将使其将 sizeof 指针分配给 port_data_t 的指针，这在大多数情况下仅在大多数情况下才有用。

# javascript - 根据您滚动页面的距离更改 div

> ID：625143
> 
> 赞同：4
> 
> 时间：2009-03-09T05:46:20.893
> 
> 标签：javascript, jquery, scroll

我正在尝试根据您滚动页面的距离来更改 div 内的文本。我一直在修改 jQuery 的 scrollTop 和文档高度，但到目前为止未能产生预期的结果。

一旦滚动到该元素位置，我将如何获取页面上元素的位置，然后让 jQuery 执行某些操作？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T05:51:35.560

Stackoverflow 上有一个问题，问了类似的问题，我举了一个小例子来说明如何实现这一点。我现在找不到问题，但这 [是示例](http://www.rootspot.com/stackoverflow/scrollintoview.html)。在此示例中，会显示一个 div，直到您滚动到页面中的某个元素，此时该 div 被隐藏。你可以改变它来实现你想要的，因为想法是一样的。这是根据您的需要修改的代码：

```
$(document).ready(function() {
    function isScrolledIntoView(elem) {
        var docViewTop = $(window).scrollTop();
        var docViewBottom = docViewTop + $(window).height();

        var elemTop = $(elem).offset().top;
        var elemBottom = elemTop + $(elem).height();

        return ((elemBottom >= docViewTop) && (elemTop <= docViewBottom));
    }

    var myelement = $('#formcontainer'); // the element to act on if viewable
    $(window).scroll(function() {
        if(isScrolledIntoView(myelement)) {
            // do something when element is scrolled to and viewable
        } else {
            // do something when element is not viewable
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T05:54:50.063

来自 quirksmode.org 的好旧[ppk](http://www.quirksmode.org/js/findpos.html)可以向您展示如何找到元素的位置：“此脚本找到实际位置，因此如果您调整页面大小并再次运行脚本，它会指向元素的正确新位置。 "

# memcached - 基于 Memcache 的消息队列？

> ID：625146
> 
> 赞同：10
> 
> 时间：2009-03-09T05:48:07.347
> 
> 标签：memcached, message-queue

我正在开发一个多人游戏，它需要一个消息队列（即，消息输入、消息输出、没有重复或删除的消息，假设没有意外的缓存驱逐）。以下是我知道的基于内存缓存的队列：

*   MemcacheQ： http: [//memcachedb.org/memcacheq/](http://memcachedb.org/memcacheq/)
*   八哥：[http ://rubyforge.org/projects/starling/](http://rubyforge.org/projects/starling/)
*   已缓存：http : [//www.marcworrell.com/article-2287-en.html](http://www.marcworrell.com/article-2287-en.html)
*   麻雀：[http ://code.google.com/p/sparrow/](http://code.google.com/p/sparrow/)

我从[这篇博](http://broddlit.wordpress.com/2008/04/09/memcached-as-simple-message-queue/)文中了解了 memcache 队列的概念：

*所有消息都以整数作为键保存。有一个键具有下一个键，另一个键具有队列中最旧消息的键。要访问这些，增量/减量方法用作其原子，因此有两个充当锁的键。它们递增，如果返回值为 1，则进程拥有锁，否则它继续递增。一旦该过程完成，它会将值设置回 0。简单但有效。一个警告是整数会溢出，因此一旦我们接近该限制，就有一些逻辑将使用的键设置为 1。由于增量操作是原子的，因此只有在使用两个或更多内存缓存（用于冗余）时才需要锁定，以保持它们同步。*

我的问题是，是否有可以在 App Engine 上运行的基于 memcache 的消息队列服务？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T07:21:59.010

我会非常小心地以这种方式使用 Google App Engine Memcache。您担心“意外的缓存驱逐”是正确的。

Google 希望您使用 memcache 来*缓存*数据而不是*存储*它。他们不保证将数据保存在缓存中。来自[GAE 文档](http://code.google.com/appengine/docs/python/memcache/functions.html)：

> 默认情况下，项目永远不会过期，尽管项目可能会由于内存压力而被驱逐。

**编辑：**总是有[亚马逊的简单排队服务](http://aws.amazon.com/sqs/)。但是，这可能不符合价格/性能水平，因为：

1.  从谷歌到亚马逊服务器的调用会有延迟。
2.  你最终会为所有的数据流量支付两倍的费用——支付它离开谷歌的费用，然后再次支付它进入亚马逊的费用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T08:04:31.800

我已经启动了一个简单的 Python Memcached 队列，它可能很有用：http: [//bitbucket.org/epoz/python-memcache-queue/](http://bitbucket.org/epoz/python-memcache-queue/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T10:06:45.307

如果您对丢失数据的可能性感到满意，请务必继续。但是请记住，尽管 memcache 通常比数据存储具有更低的延迟，但与其他任何东西一样，如果您想要在单个元素上执行高速率的原子操作，它就会受到影响。这不是数据存储问题 - 它只是一个必须序列化访问的问题。

如果做不到这一点，亚马逊的 SQS 似乎是一个可行的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T16:13:50.490

为什么不使用任务队列：
[https ://developers.google.com/appengine/docs/python/taskqueue/](https://developers.google.com/appengine/docs/python/taskqueue/)
[https://developers.google.com/appengine/docs/java/taskqueue/](https://developers.google.com/appengine/docs/java/taskqueue/)

它似乎解决了这个问题，而不会丢失基于 Memcached 的队列中的消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T07:32:23.120

在 Google 实施适当的作业队列之前，为什么不使用数据存储呢？正如其他人所说，memcache 只是一个缓存，可能会丢失队列项目（这将是..坏的）

数据存储应该足够快以满足您的需要 - 您只需一个简单的 Job 模型，它比 memcache 更灵活，因为您不限于键/值对

# python - 通过 poplib 单独从收件箱中选择邮件

> ID：625148
> 
> 赞同：2
> 
> 时间：2009-03-09T05:49:32.960
> 
> 标签：python, gmail, pop3, poplib

我只需要使用 poplib 从 gmail 收件箱下载电子邮件。不幸的是，我没有看到任何单独选择收件箱的选项，并且 poplib 也为我提供了来自已发送项目的电子邮件。

如何仅从收件箱中选择电子邮件？

我不想使用任何 gmail 特定的库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T06:09:32.663

POP3 没有“文件夹”的概念。如果 gmail 向您显示“已发送”和“已接收”邮件，那么您真的别无选择，只能接收所有这些电子邮件。

也许您最好使用 IMAP4 而不是 POP3。Python 具有可与 gmail 的 IMAP4 服务器一起使用的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T18:09:55.630

我假设您已启用对您的 GMail 帐户的 POP3/IMAP 访问。

这是示例代码：

```
import imaplib
conn= imaplib.IMAP4_SSL('imap.googlemail.com')
conn.login('yourusername', 'yourpassword')
code, dummy= conn.select('INBOX')
if code != 'OK':
    raise RuntimeError, "Failed to select inbox"

code, data= self.conn.search(None, ALL)
if code == 'OK':
    msgid_list= data[0].split()
else:
    raise RuntimeError, "Failed to get message IDs"

for msgid in msgid_list:
    code, data= conn.fetch(msgid, '(RFC822)')
    # you can also use '(RFC822.HEADER)' only for headers
    if code == 'OK':
        pass # your code here
    else:
        raise RuntimeError, "could not retrieve msgid %r" % msgid

conn.close()
conn.logout() 
```

或类似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T06:18:44.483

此 Java 代码建议您可以选择特定的“文件夹”进行下载，即使使用 POP3 也是如此。同样，这是使用 Java，而不是 Python，所以 YMMV。

[如何使用 Java 从 GMail 下载消息（博客文章讨论将内容推送到本地 Lucene 搜索引擎）](http://blog.prolificprogrammer.com/2008/04/04/how-to-search-gmail-from-the-comfort-of-your-command-line)

# sql - 仅当外部查询的行数等于内部子查询时才列出

> ID：625159
> 
> 赞同：0
> 
> 时间：2009-03-09T05:58:31.863
> 
> 标签：sql, sql-server, sql-server-2005

在使用 sql server 2005 进行查询时需要帮助

我有两张桌子

代码

```
chargecode
chargeid
orgid 
```

入口

```
chargeid
itemNo
rate 
```

如果条目表中包含多个具有不同chargeids 的条目，这些条目在具有相同收费代码的代码表中列出，我需要在条目表中列出所有的chargeids。

**数据 ：**

代码

```
100,1,100
100,2,100
100,3,100
101,11,100
101,12,100 
```

入口

```
1,x1,1
1,x2,2
2,x3,2
11,x4,1
11,x5,1 
```

使用上面的数据，它查询应该列出chargeids 1和2而不是11。

我有办法知道条目中有多少行满足条件，但我没有得到chargeids

```
select count (distinct chargeId)
from entry where chargeid in (select chargeid from code where chargecode = (SELECT A.chargecode
from code as A join code as B
ON A.chargecode = B.chargeCode and A.chargetype = B.chargetype and A.orgId = B.orgId AND A.CHARGEID = b.CHARGEid
group by A.chargecode,A.orgid
having count(A.chargecode) > 1)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T06:04:15.563

首先：我为我完全不准确的原始答案道歉。

您的问题的解决方案是自加入。当您想从同一个表中选择多行时，使用自联接。在我们的例子中，我们要选择两个具有相同收费代码的收费 ID：

```
SELECT DISTINCT c1.chargeid, c2.chargeid FROM code c1
JOIN code c2 ON c1.chargeid != c2.chargeid AND c1.chargecode = c2.chargecode
JOIN entry e1 ON e1.chargeid = c1.chargeid
JOIN entry e2 ON e2.chargeid = c2.chargeid
WHERE c1.chargeid < c2.chargeid 
```

对此的解释：

首先，我们从“代码”中选择任意两个收费 ID。DISTINCT 避免重复。我们确保它们是两个*不同的*ID，并且它们映射到相同的费用代码。

然后我们加入'entry'（两次）以确保它们都出现在入口表中。

这种方法（对于您的示例）给出了对（1,2）和（2,1）。所以我们也坚持下单；正如您所描述的，这会将结果集缩减为（1,2）。

# iphone - 应用程序构建未加载到设备上

> ID：625160
> 
> 赞同：1
> 
> 时间：2009-03-09T05:58:49.287
> 
> 标签：iphone

当我尝试在设备上上传构建时，它会出现以下错误。您的移动设备遇到意外错误`(0xE8000001)`

我无法解决这个问题。谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T07:41:39.027

每当我遇到意外错误时，我都会通过按住主页和锁定按钮硬重启我的设备，直到出现苹果标志。不知道是什么原因造成的，但重启通常会修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:33:08.113

这基本上发生在 Xcode 和 iPhone 之间存在通信错误时，这让 Xcode 对 iPhone 所处的状态感到困惑。（实际上，有时您可以通过在安装构建过程中拔掉手机来实现它。）作为错误*消息*文字表明，关闭并重新打开 iPhone 通常会清除错误。您有时可能需要重新启动 Xcode 甚至整个 Mac，但并不经常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T11:31:06.383

问题得到解决。当我设置设备的配置文件时。有用。感谢您的帮助和指导。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T06:33:57.673

这似乎是一个让许多用户感到困惑的错误。不知道错误实际上是什么，但在[这个论坛上](http://www.iphonedevsdk.com/forum/iphone-sdk-development/1994-error-0xe8000001.html)人们声称：

> 此错误将要求您通过 Xcode 的 Organizer 窗口或 iTunes 恢复您的 iPhone/touch。没有办法解决它”。

# .net - 在 GDI+ 中使用“DrawString”的小型大写字母/多种字体和粗体

> ID：625161
> 
> 赞同：1
> 
> 时间：2009-03-09T05:59:18.117
> 
> 标签：.net, asp.net, gdi+, system.drawing, drawstring

[我想用小型大写](http://en.wikipedia.org/wiki/Small_caps)字母结合不同字体的不同单词写出一些文本。

为了澄清，我可能希望将消息“欢迎来到我们的新网站”生成为页面标题的 PNG 文件。

*   文本将是[小型](http://en.wikipedia.org/wiki/Small_caps)大写字母——所有内容都大写，但“W”、“N”和“W”稍大。
*   “新网站”将采用与文本其余部分不同的字体。

有没有办法我可以做到这一点而无需完全手动完成？

做这样的事情在概念上是我想做的：

```
 graphics.DrawString("<font size=2>W</font>ELCOME TO OUR <b><font size=2>N</font>" +
                     "EW <font size=2>W</font>EBSITE</b>"); 
```

到目前为止我能找到的最好的方法[是here](http://blogs.vbcity.com/xtab/archive/2005/11/02/5669.aspx)，但我担心我会不厌其烦地手动执行此操作并最终导致一些可怕的[字距调整或跟踪](http://en.wikipedia.org/wiki/Kerning) 问题。

**编辑：**我应该提到这是在 ASP.NET 中完成的，因此它需要尽可能快速和精简。我希望它是自动化的，这样我就可以轻松地进行本地化，而不必创建大量的小图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T06:35:40.260

看来您真的应该在这里使用 RichTextBox ... 有一种方法可以从 RichTextBox 中提取位图，然后您可以将其作为位图渲染到图形上下文中。当然，您需要在这里进行托管 C++ 调用，我不知道您是否能够在您的项目中这样做。

否则，我认为您将需要使用 DrawString 和 MeasureString 手动完成，这很痛苦。

# cuda - CUDA 与 Direct X 10 用于并行数学。你有什么想法吗？

> ID：625162
> 
> 赞同：0
> 
> 时间：2009-03-09T06:01:37.270
> 
> 标签：cuda

CUDA 与 Direct X 10 用于并行数学。你有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T17:15:41.290

如果您知道您的目标架构使用的是 nVidia 芯片，那么 CUDA 可能是一个更好的选择。您可以完全控制数据传输、指令路径和操作顺序。当您在较低级别上工作时，您还可以使用更少的 __syncthreads 调用。

我认为 DirectX 10 会更容易与接口交互，但如果你真的想推动速度优化，你必须绕过额外的层。DirectX 10 也不知道何时使用纹理内存、常量内存和共享内存，这取决于您的特定算法。

如果您可以使用 Tesla C1060 或类似设备，那么 CUDA 无疑是更好的选择。如果你知道你的 GPGPU 的细节，你真的可以加快速度——我已经看到特斯拉和我的台式机上的一种特定算法的速度提高了 188 倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:14:43.960

我觉得 CUDA 很尴尬。它不是 C，而是它的一个子集。它本身不支持双精度浮点并且是模拟的。不过对于单精度来说没关系。这取决于你扔给它的任务类型。您必须花费更多的时间进行并行计算，而不是花费在传递数据上才能使其值得使用。但这个问题并不是 CUDA 独有的。

我会等待 Apple 的 OpenCL，它似乎将成为并行计算的行业标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T06:12:45.027

好吧，CUDA 是便携式的……如果你问我，那是一个很大的胜利……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:28:02.437

CUDA 与支持双精度浮点运算无关。这取决于可用的硬件。9、100、200 和 Tesla 系列支持双精度浮点运算[tesla](http://www.nvidia.com/object/tesla_supercomputer_features.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-23T18:29:08.940

在它们之间做出决定应该很容易。

如果您的应用程序可以容忍特定于 Windows，您仍然可以考虑 DirectX 计算。否则，请使用 CUDA 或 OpenCL。

如果您的应用不能容忍 NVIDIA 上的供应商锁定，则不能使用 CUDA，您必须使用 OpenCL 或 DirectX Compute。

如果您的应用程序正在执行 DirectX 互操作，请考虑 CUDA/OpenCL 在执行图形 API 互操作时会产生上下文切换开销，而 DirectX Compute 不会。

除非其中一项或多项标准影响您的应用程序，否则请使用大规模并行工具链的曾祖父：CUDA。

# linux - Linux 下 IPv6 流量的透明代理

> ID：625166
> 
> 赞同：9
> 
> 时间：2009-03-09T06:04:06.857
> 
> 标签：linux, ipv6, nat

在维护网络时，运行透明代理通常是一种权宜之计。透明代理是指“劫持”传出连接并通过本地服务运行它们的代理。具体来说，我运行一个配置了 squid 的 linux 防火墙，以便端口 80 上的所有 tcp/ip 连接都由 squid 代理。

这是使用 iptables 'nat' 表，使用 IPv4 实现的。

但是 IPv6 的 iptables 没有“nat”表，所以我不能使用相同的实现。我可以使用什么技术来透明地代理 IPv6 连接的流量？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-09-09T04:10:05.693

一种可行的方法是使用 iptables 中的 TPROXY 规则，文档可在此处获得：

*   [http://wiki.squid-cache.org/Features/Tproxy4#IPv6_Support](http://wiki.squid-cache.org/Features/Tproxy4#IPv6_Support)
*   [http://www.mjmwired.net/kernel/Documentation/networking/tproxy.txt](http://www.mjmwired.net/kernel/Documentation/networking/tproxy.txt)

这应该支持 Squid（>= 版本 3.2）。使用`--enable-linux-netfilter`和`iptables -t mangle -j TPROXY`规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T06:38:53.357

iptables 有一个 QUEUE 目标，您可以使用它来将数据包传送到用户空间。我不确定，但也许可以在那里实现一些东西。

除此之外，您可以尝试向内核添加一些内容以进行重定向。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T11:35:16.910

你不能。引用[squid-cache.org](http://wiki.squid-cache.org/Features/IPv6)：

> IPv6 中根本不存在 NAT。按设计。
> 
> 鉴于透明/拦截实际上是通过秘密地将 NAT 路由内外扭曲而获得的功能。没有 NAT 的协议无法以这种方式进行透明和拦截，这是很合乎逻辑的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-24T21:06:34.533

这是一个实现：

[http://www.suse.de/~krahmer/ip6nat/](http://www.suse.de/~krahmer/ip6nat/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T18:00:28.687

另一种丑陋的黑客：

*   用 iptables 标记所有流量（似乎，IPv6 有 CONNMARK 目标）
*   将所有标记的流量路由到 tun 设备
*   在监听 tun 设备的守护进程中执行用户空间 NAT
*   ...

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-25T12:04:23.813

在 IPv6 堆栈中编写您自己的 NAT 实现。

# .net - 现在可以为 .NET 编写新应用了吗？

> ID：625169
> 
> 赞同：8
> 
> 时间：2009-03-09T06:05:57.600
> 
> 标签：.net, deployment

我即将启动一个新的 Windows 应用程序。它将是一个用 C++ 编写的音频处理工具。它将需要所有常用的 GUI 东西，如菜单、工具栏等。它还将有一个嵌入式 Web 浏览器。

我正在考虑在 .NET 上构建它，但我想听听大家关于 .NET 是否仍然难以部署的问题。有多少百分比的普通用户已经拥有 .NET 运行时？我不想给我的用户带来任何痛苦，比如为了启动我的应用程序而不得不下载 100MB 运行时。

你觉得堆栈溢出者是什么？我应该使用 .NET 还是应该坚持使用普通的“ol Win32 API”？或者甚至是像 QT 或 wxWidgets 这样的 3rd 方系统？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-09T06:11:15.310

您可以将您的用户指向[.Net 引导程序](http://www.microsoft.com/downloads/details.aspx?FamilyId=BF253CFD-1EFC-4FC5-BA7E-6A6F21403495&displaylang=en)，这是一个 100kb 的下载，将检测他们当前拥有的 .Net 框架的哪些位，并将下载任何缺少的内容。

还有来自@shanselman 的[http://smallestdotnet.com/](http://smallestdotnet.com/)倡议

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-09T06:09:04.240

我不知道确切的数字，但 Vista 内置了 .NET，其他版本的 Windows 可以很容易地从 Microsoft Update 中获取它。您还可以随应用程序重新分发 .NET 运行时。

我不会太担心您的用户是否安装了 .NET。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-09T06:26:09.783

**微软正在大力**推动 .NET 框架。我相信如果您的计算机上没有安装 .NET 框架，您甚至无法安装 Microsoft Office 2007。因此，如果 Microsoft 要求其最新的 Office 程序使用 .NET，您可以放心地假设您的基于 Microsoft 的客户将安装必备的 .NET 基础库。当然，这在很大程度上取决于您正在构建的应用程序类型。我还听说一些视频游戏开发人员将他们的游戏捆绑包与 .NET 的开源 Mono 版本一起发布。信不信由你，实际上有一个非常强大且稳定的用于 Microsoft Windows 的 Mono。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T06:11:53.670

.Net Framework 下载/安装不是*那么*繁琐。但我建议从另一个角度看待你的问题。

如果您知道您的所有用户都安装了框架，您会选择 C++ 还是使用 .Net？由于您的 GUI 要求，我猜您正在使用 .Net 来获得它带来的所有细节。

您列出的其他选项可能是可以接受的，但在支持这些客户端组件方面很难击败 .Net 框架。

考虑到所有因素，单次下载与您将获得的更好的应用程序支持之间的权衡似乎是一个不错的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T06:12:21.253

.NET 就像 Java - 您需要确保存在适当的运行时。d/l 不是 100mb！哈！这是196mb。但是有一个“客户端配置文件”将其减少到 26mb，所以我听到了。

.NET 运行时的部署是一个缺点，但对我来说，开发人员的生产力在 C# 中比 C++ 提高了很多。我很乐意让我的用户忍受 45 秒的下载时间，以便提高一个数量级的生产力。但这只是我。（ps：安装程序可以自动下载所需的运行时）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T08:32:31.417

[.NET Framework 2.0 运行时](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5)只有 22MB，它是一个很好的目标框架，尤其是当您不需要 WPF 或 WCF 时。Vista 用户将至少安装 3.0，所以他们不需要做任何事情，而且很多其他应用程序已经针对 2.0，所以他们已经安装了它。

此外，您在 .NET 中的应用程序将比您在 C++ 中编写的应用程序小得多。就其本身而言，可执行文件要小得多，并且在 VS 中构建安装项目所产生的 MSI 文件比我见过的任何其他文件都要小。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-09T12:35:20.317

我们为不同行业的客户部署了多个应用程序，目前 .NET Framework 2.0 根本不是问题。（无论如何，它只有 22 MB 的下载空间。）您仍然可以使用 Visual Studio 2008 和 C#，但是您必须选择 .NET 2.0 作为目标框架，并且您必须使用 Windows 窗体而不是 WPF 作为 GUI（可能是根据你的经验，

.NET Framework 3.0 和 3.5（以及 3.5 SP1 等）至少在企业网络中似乎不是主流；它明显更大，在安装过程中有更多潜在的陷阱，并且不再支持 Windows 2000 和 Windows 98（.NET 2.0 仍然支持）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T06:28:31.900

您正在构建什么样的应用程序？这真的很重要。如果您担心您的用户，那么：

*   如果您控制您的用户，那么就没有问题 - 您控制他们的机器，您可以确保已经安装了 .NET
*   如果您谈论的是（对您的组织而言）外部的用户，那么我会推荐 ASP.NET 或 Silverlight 应用程序

自己决定。我可能会选择 Silverlight，因为它最接近桌面应用程序（我认为您指的是），而且下载量仍然非常小（我猜大概是 2MB）。看看[http://silverlight.net](http://silverlight.net/)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T12:59:55.970

对于我读过的 Mono（.NET 的自由软件实现）附带一个链接器 - 您可以使用 Mono 编译您的应用程序，链接到它所有需要的组件。

好的部分是您将获得一个独立的软件包：最终用户无需安装特定的 .NET 框架（如果他们还没有安装的话）。缺点是：根据您使用的 .NET 库的数量，您的可执行文件可能最终会变得**很大**，从而抵消了好处。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T06:18:13.797

不是关于 .Net 的建议，但如果您出于某种原因决定不使用 .Net，我强烈建议您使用 QT 而不是 Win32 API。我发现 Win32 API 真的很乱，而且比 QT 更难使用，在我看来，QT 非常好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T06:47:48.733

与原生 C++ 和 Windows API 甚至 QT 相比，.Net 将使您的生活更轻松。但如果 GUI 不复杂，最好使用 QT，因为 .Net 框架尺寸比较大

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-09T13:50:04.240

[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx) API 也值得研究。您可以使用它在 Internet 上分发您的应用程序，并且该应用程序可以调用 home 自动获取更新（如果需要）。

我现在在工作中使用它，它使分发和更新桌面软件变得轻而易举。

# c# - 在 windows 窗体中按 enter 提交

> ID：625173
> 
> 赞同：7
> 
> 时间：2009-03-09T06:09:14.177
> 
> 标签：c#, winforms

为了将文本从一个文本框传输到另一个文本框，我创建了一个提交按钮。但是，最好使用“输入”键的功能。

我不确定，但我认为 ascii 代码是 13。无论如何我该如何处理手头的这项任务？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-09T06:11:43.873

看`Form.AcceptButton`楼盘。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T18:08:27.793

您可以订阅文本框的 KeyUp 事件。

```
using System.Windows.Forms;

private void txtInput_KeyUp(object sender, KeyEventArgs e)
{
    if(e.KeyCode == Keys.Enter)
        DoSomething();
} 
```

# vb.net - 派生 System.Data 类

> ID：625176
> 
> 赞同：0
> 
> 时间：2009-03-09T06:10:18.357
> 
> 标签：vb.net, .net-3.5, multiple-inheritance, .net

我想利用继承 System.Data 命名空间的类。

具体来说，我希望分别从 DataColumn、DataTable 和 Dataset 派生类 CarColumn、CarTable 和 CarSet。

我希望能够为每个类添加额外的属性。例如，这就是我想在类中引用项目的方式：

> CarSet.CarTable(0).Columns(0).foo
> 
> CarSet.CarTable(0).bar

我知道 VB.Net 不能进行多重继承。实现这一目标的最佳方法是什么？

谢谢，保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T06:24:48.943

我不相信你能以一种简单的方式实现你想要的。我相信你必须单独继承 CarColumn、CarDataRow、CarTable 和 CarDataSet（可能还有某个地方的 CarDataView/CarDataRowView）。

您是否有机会使用另一种设计，也许是 LINQ？

# javascript - 窗口中的 (X) 按钮有问题

> ID：625178
> 
> 赞同：1
> 
> 时间：2009-03-09T06:11:08.010
> 
> 标签：javascript, javascript-events

如何禁用窗口中的 (X) 按钮。

我尝试在 window.open 中使用一些属性，例如 titlebar=no/0 ，但它不能正常工作。任何人都可以帮我解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T06:22:55.407

请参阅[此页面](http://en.allexperts.com/q/Javascript-1520/Prevent-Closing-Page.htm)和[此页面](http://msdn.microsoft.com/en-us/library/ms536973(VS.85).aspx)。您可以处理该`onunload`事件，但您无法阻止窗口关闭；如果他们想“离开页面”，你可以做的最好的提示用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:27:14.587

你不能禁用关闭按钮，因为 wj32 说你能做的最好的事情就是在他们关闭窗口时显示警告。

# asp.net-mvc - 如何在视图中访问控制器返回的匿名类型？

> ID：625188
> 
> 赞同：2
> 
> 时间：2009-03-09T06:17:04.097
> 
> 标签：asp.net-mvc

在 MVC RC2 中，我返回了一个匿名对象类型，我想在强类型视图中访问它。假设在控制器中，我查询数据库并获取**var**类型的值，并且我想将其传递给强类型视图。我如何在该视图中访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T06:26:29.737

好吧，你不能。匿名类型，不能通过名称访问。这就是重点。您不能传递类型，类型存在于内部，您只能将类型公开为 System.Object。

您始终可以使用反射来挖掘属性并以这种方式访问​​它们，但除此之外，没有其他办法。

```
var q = new { MyProperty = "Hello World" };
var t = q.GetType();
var hello = t.GetProperty("MyProperty").GetValue(q, null) as string;
Console.WriteLine(hello); 
```

如果您需要访问该类型，您应该创建一个用户定义的对象/类型，它可以通过名称来识别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:45:48.300

您不能将其传递给强类型视图，但您可以将其转换为字典并以这种方式访问​​属性。

作为 System.Web.Routing 的一部分，有一个名为“RouteValueDictionary”的新对象，它可以将匿名对象作为其构造函数。

MVC 团队在他们的许多助手中使用了这一点。

例子：

```
IDictionary<string, object> myDict = new RouteValueDictionary(anonymousObject); 
```

# tfs - 强制 TFS 使用相对路径或更新位置

> ID：625200
> 
> 赞同：0
> 
> 时间：2009-03-09T06:25:00.410
> 
> 标签：tfs

不久前我安装了 TFS 2008 Workgroup Edition，一切运行良好。

最近我尝试向几个朋友开放 TFS，以便我们可以在一个项目上进行协作。源代码管理部分工作正常，但 Documents 和 Reports 文件夹不可用（它们上面有红叉）。

当我查看属性时，我注意到 URL 使用的是我的内部机器名称，而不是外部地址（例如`http://INTERNALNAME/Sites/MyProject`，而不是`http://www.EXTERNAL-NAME.com/Sites/MyProject`）。

我的偏好是以某种方式使用相对路径，因此如果我决定停止将 TFS 暴露在外部，我不必做任何事情。

我意识到这可能是不可能的，因为 TFS 无法假设 Reporting Services 和 Share Point 在同一台机器上......那么至少有一种简单的方法来分配新的服务器名称吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:40:00.480

是的，由于 TFS 的工作方式，无法使用相对路径——它将完整的 URL 发送回 Sharepoint 和 Reporting Services 服务器到客户端计算机。

要更新用于共享点和报告服务的 URL 以匹配您想要使用 TFSAdminUtil 的完全限定域名。远程桌面到 TFS 服务器，打开命令提示符窗口，并将目录更改为 %ProgramFiles%\Microsoft Visual Studio 2008 Team Foundation Server\Tools。

在命令提示符处，键入以下命令（全部在一行上）：

```
 TfsAdminUtil ConfigureConnections /SharepointUri:BaseSiteURL
        /SharepointSitesUri:SharePointSite
        /SharepointAdminUri:SharePointAdministration
        /ReportsUri:ReportsUri
        /ReportServerUri:ReportServer 
```

替换以下字符串

*   **SharePointSite**是 SharePoint 产品和技术网站集的新 URI。
*   **SharePointAdministration**是 SharePoint 管理中心网站的新 URI（用于创建新的团队项目）
*   **ReportsUri**是 SQL Server Reporting Services 的新 URI。
*   **ReportServer**是 ReportsService.asmx Web 服务的新 URI。

顺便说一句 - 如果您为 Visual Studio Team System 2008 Team Foundation Server 安装了 SP1，则**ReportServer**参数将无法正常工作，您必须在最后粘贴 /ReportService.asmx。有关此问题及其解决方法的详细信息，请参阅此 KB：[Team Foundation Server 2008 SP1 TfsAdminUtil.exe 'ConfigureConnections' 无法正确设置 ReportServerUri](http://go.microsoft.com/fwlink/?LinkID=131656)。

例如，以下命令适用于 TFS 2008 SP1：

```
TfsAdminUtil ConfigureConnections /SharepointUri:http://tfs.external-name.com /SharepointSitesUri:http://tfs.external-name.com/Sites /SharepointAdminUri:http://tfs.external-name.com:17483 /ReportsUri:http://tfs.external-name.com/Reports /ReportServerUri:http://tfs.external-name.com/ReportServer/ReportService.asmx 
```

最后要注意的一件事是，如果您从外部访问 TFS 服务器，那么建议您使用 HTTPS 来加密 TFS 流量。有关此配置的详细信息，请参阅 MSDN 站点上的帖子：[演练：使用安全套接字层 (SSL) 和 ISAPI 筛选器设置 Team Foundation Server](http://msdn.microsoft.com/en-us/library/aa833872.aspx)

# asp.net-mvc - 偏离 ASP.NET MVC 的 {controller}/{action}/{id} REST URL 格式的陷阱？

> ID：625213
> 
> 赞同：0
> 
> 时间：2009-03-09T06:32:31.390
> 
> 标签：asp.net-mvc, rest

我将很快推出一个新网站。该网站的一个部分包含产品。

我目前正在尝试在 ASP.NET 路由的不同 URL 之间做出决定：

**产品： **

```
 /products/1001
 /products/sku/1001
 /products/product/1001
 /products/view/1001 
```

**类别：**

```
 /products/category/cats
 /products/category/clothing

 /products/cats         - this is pretty nasty
 /products/clothing 
```

我主要是想决定我应该采用以下哪一项。我目前正在做第一个。

```
 routes.MapRoute(
    "product-route-short",
    "products/{sku}",
    new { controller = "Products", action = "ViewProduct", sku = "1001"}
  ); 
```

或者

```
 routes.MapRoute(
    "product-route-short",
    "products/sku/{sku}",
    new { controller = "Products", action = "ViewProduct", sku = "1001"}
  ); 
```

或以下之一

```
 * call the action 'sku' , 'details' , 'item'
 * use an [ActionName] attribute and leave the action method name as 'ViewProduct' 
```

我真的很喜欢它的简单性，`/products/1001`因此用户可以看到并更改它 - 但如果我不小心，它很快就会与其他操作发生冲突。我还必须确保`'product-route-short'`在创建我的 URLS 时使用，这是一个非常小的痛苦。

有人怎么想？您发现最佳实践是什么？这个例子非常简单，但我当然希望在整个网站上保持一致，并且不想在 Google 已经为我索引所有内容后对所有内容进行改造。

如果有任何关于该主题（一般或特定于 ASP.NET）的特别好的播客或文章，我会很感激它们的链接。我找到了一个很好的播客，他们特别说的一件事是“这个播客不是关于如何创建良好的 REST 链接”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T09:04:59.030

我会根据这些目标调整我的网址......

1）可用性。如果您可以通过查看 URL 来判断您将获得什么样的页面，那真是太好了。如果它足够短，可以输入和/或猜测，那就更好了。

2) 搜索引擎。您确实希望将关键字放入这些 URL。我知道您想使用 ID 来查找产品，但人类和搜索引擎希望在那里看到产品名称。此外，关键字越靠近 URL 的开头，它的重要性就越大。

这真的只是一个略读。如果您想要最好的 URL，您需要确保类别和产品名称是唯一的，以便您可以查找它们，而不是在地址中使用 ID。

我建议的约定是...

/产品/

/产品/服装/

/产品/服装/蓝色麂皮鞋/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:55:53.723

请注意，SO 本身在 stackoverflow.com/questions/625213 上列出了这个问题（之后的 / 被忽略）。所以你至少有先例:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T07:07:53.787

我认为您制作的较短的网址很好。asp.net mvc 路由引擎的美妙之处在于，假设您在视图中正确创建了链接，您可以在开发时更改路由。因此，您可以随意玩耍。

要记住的另一件事是 MapRoute 方法中的约束参数。你总是可以尝试这样的事情：

```
routes.MapRoute( 
"product-route-short", 
"products/{sku}", 
new { controller = "Products", action = "ViewProduct", sku = "1001" } , 
new { sku = @"[0-9]" } 
);

routes.MapRoute( 
"product-route-other", 
"products/{action}/id", 
new { controller = "Products", action = "ViewProduct" } 
); 
```

该过滤器将使只有 0-9 之间的 skus 可以工作。显然，您希望使用正则表达式来适应您的特定场景，但这将帮助您避免与操作发生冲突。在这种情况下，如果 sku 的值不在 0-9 之间，那么路由引擎将转到下一个路由并尝试匹配该路由。它将执行此操作，直到找到匹配项。

结合路由和约束，您应该能够拥有对用户有意义的非常干净的 url。

# iphone - 监听 iPhone 麦克风

> ID：625225
> 
> 赞同：0
> 
> 时间：2009-03-09T06:37:35.747
> 
> 标签：iphone

我正在使用[SCListener](http://github.com/stephencelis/sc_listener)获取 iPhone 的音量，但我想在音量上放置一个观察者。因此，当它发生变化时，我可以更新屏幕上的音量计。但是做类似的事情：

```
SCListener *listener = [SCListener sharedListener];
[listener addObserver:self 
           forKeyPath:@"peakPower" 
              options:NSKeyValueObservingOptionOld 
              context:NULL]; 
```

不能解决问题，因为 peakPower 不是变量。我如何在函数上放置一个观察者？或者如何创建一个我可以停止并开始跟踪我可以放置观察者的变量中的峰值功率的监听器？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T07:46:12.430

SCListener 不符合 Key Value Observer。AFAIK，您必须轮询这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-11T14:24:25.480

只需设置一个重复计时器，并在每次计时器触发时读取级别。

# jquery - JQuery 信用卡验证器

> ID：625227
> 
> 赞同：0
> 
> 时间：2009-03-09T06:39:16.070
> 
> 标签：jquery, jquery-plugins, jquery-validate

嗨，当我尝试验证信用卡时出现以下错误，这似乎是一个直截了当的错误，问题是即使包含 jquery.validate.js 也会发生。

由于某种原因，它无法找到该功能，并破坏了我的代码。

有没有人遇到过类似的问题？

(jQuery.validator.methods.creditcard(element.value, element)) 未定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T06:45:10.177

双重三重四重检查是否包含 javascript。并向我们​​提供出错页面的来源，以便我们帮助您调试它。

# iphone - 从 SMS 消息启动应用程序

> ID：625232
> 
> 赞同：4
> 
> 时间：2009-03-09T06:44:42.050
> 
> 标签：iphone, sms

我是`iphone`应用程序开发的新手。

我有一个需要从**SMS 消息**启动的示例应用程序。我不知道该怎么做。请帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-10T02:28:01.550

请注意，如果 SMS 以与 iPhone 上的 Mail 相同的方式运行，则需要将自定义 URL 括在括号中，以使其启动响应该方案的应用程序。例如，

```
<yourapp://yoururl> 
```

会工作，但是

```
yourapp://yoururl 
```

将不会。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T06:54:19.590

允许您的应用程序响应某个 url（例如： myapp://launch ）并在 SMS 中包含该 url，当用户启动该 URL 时，您的应用程序将启动。

我确定这不是最直接的方式（因为 SMS 需要包含您的自定义 URL），但我不知道是否可以使用任意 SMS 启动任意应用程序

在 iphone URL 方案上做一个谷歌，你会发现很多关于如何实现这个的细节

这是一个[例子](http://inchoo.net/iphone-development/launching-application-via-url-scheme/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-19T07:15:42.973

下面的 appdelegate 方法告诉用于打开您的应用程序的完整 url

```
 -(BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url
{
  //you could parse the url and take action according to that
} 
```

下面的应用程序委托方法告诉哪个应用程序导致打开您的应用程序

```
- (BOOL)application:(UIApplication *)application openURL: (NSURL *)url sourceApplication:(NSString *)sourceApplication
     annotation:(id)annotation
{
 //you could capture the refered app custom url and open back from your app
return YES; 
```

}

使用以下代码段，您可以打开打开您的应用程序的应用程序

```
 NSURL *urlObj = [NSURL URLWithString:url];
[[UIApplication sharedApplication] openURL:urlObj]; 
```

传递自定义应用程序 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T11:13:54.810

它工作正常。谢谢哈菲兹！

我编写了一条 URL 格式为“myapp://”的短信。它没有用。然后我尝试了“”，然后它起作用了。谢谢布拉德！

# php - VBulletin 无法连接到 MySQL 数据库

> ID：625236
> 
> 赞同：0
> 
> 时间：2009-03-09T06:47:39.217
> 
> 标签：php, mysql, database, vbulletin

我刚刚将一个论坛从 BradPPresents.com 移至 BradP.com。可能不是SFW。

它位于[forum.bradp.com](http://forum.bradp.com)。

尽管我完全确定数据库的用户名和密码，但我收到了数据库连接错误。

这是 VBulletin 配置文件，用户名和密码被屏蔽。

```
 <?php
    /*======================================================================*\
    || #################################################################### ||
    || # vBulletin 3.6.8 Patch Level 2 - Licence Number VBF7177F80
    || # ---------------------------------------------------------------- # ||
    || # All PHP code in this file is ©2000-2008 Jelsoft Enterprises Ltd. # ||
    || # This file may not be redistributed in whole or significant part. # ||
    || # ---------------- VBULLETIN IS NOT FREE SOFTWARE ---------------- # ||
    || # http://www.vbulletin.com | http://www.vbulletin.com/license.html # ||
    || #################################################################### ||
    \*======================================================================*/

    /*-------------------------------------------------------*\
    | ****** NOTE REGARDING THE VARIABLES IN THIS FILE ****** |
    +---------------------------------------------------------+
    | If you get any errors while attempting to connect to    |
    | MySQL, you will need to email your webhost because we   |
    | cannot tell you the correct values for the variables    |
    | in this file.                                           |
    \*-------------------------------------------------------*/

        //  ****** DATABASE TYPE ******
        //  This is the type of the database server on which your vBulletin database will be located.
        //  Valid options are mysql and mysqli, for slave support add _slave.  Try to use mysqli if you are using PHP 5 and MySQL 4.1+
        // for slave options just append _slave to your preferred database type.
    $config['Database']['dbtype'] = 'mysql';

        //  ****** DATABASE NAME ******
        //  This is the name of the database where your vBulletin will be located.
        //  This must be created by your webhost.
    $config['Database']['dbname'] = 'db28587_bradp_forum';

        //  ****** TABLE PREFIX ******
        //  Prefix that your vBulletin tables have in the database.
    $config['Database']['tableprefix'] = '';

        //  ****** TECHNICAL EMAIL ADDRESS ******
        //  If any database errors occur, they will be emailed to the address specified here.
        //  Leave this blank to not send any emails when there is a database error.
    $config['Database']['technicalemail'] = 'admin@bradp.com';

        //  ****** FORCE EMPTY SQL MODE ******
        // New versions of MySQL (4.1+) have introduced some behaviors that are
        // incompatible with vBulletin. Setting this value to "true" disables those
        // behaviors. You only need to modify this value if vBulletin recommends it.
    $config['Database']['force_sql_mode'] = false;

        //  ****** MASTER DATABASE SERVER NAME AND PORT ******
        //  This is the hostname or IP address and port of the database server.
        //  If you are unsure of what to put here, leave the default values.
    $config['MasterServer']['servername'] = 'localhost';
    $config['MasterServer']['port'] = 3306;

        //  ****** MASTER DATABASE USERNAME & PASSWORD ******
        //  This is the username and password you use to access MySQL.
        //  These must be obtained through your webhost.
    $config['MasterServer']['username'] = 'Masked, verified correct';
    $config['MasterServer']['password'] = 'Masked, verified correct';

        //  ****** MASTER DATABASE PERSISTENT CONNECTIONS ******
        //  This option allows you to turn persistent connections to MySQL on or off.
        //  The difference in performance is negligible for all but the largest boards.
        //  If you are unsure what this should be, leave it off. (0 = off; 1 = on)
    $config['MasterServer']['usepconnect'] = 0;

        //  ****** SLAVE DATABASE CONFIGURATION ******
        //  If you have multiple database backends, this is the information for your slave
        //  server. If you are not 100% sure you need to fill in this information,
        //  do not change any of the values here.
    $config['SlaveServer']['servername'] = '';
    $config['SlaveServer']['port'] = 3306;
    $config['SlaveServer']['username'] = '';
    $config['SlaveServer']['password'] = '';
    $config['SlaveServer']['usepconnect'] = 0;

        //  ****** PATH TO ADMIN & MODERATOR CONTROL PANELS ******
        //  This setting allows you to change the name of the folders that the admin and
        //  moderator control panels reside in. You may wish to do this for security purposes.
        //  Please note that if you change the name of the directory here, you will still need
        //  to manually change the name of the directory on the server.
    $config['Misc']['admincpdir'] = 'admincp';
    $config['Misc']['modcpdir'] = 'modcp';

        //  Prefix that all vBulletin cookies will have
        //  Keep this short and only use numbers and letters, i.e. 1-9 and a-Z
    $config['Misc']['cookieprefix'] = 'bb';

        //  ******** FULL PATH TO FORUMS DIRECTORY ******
        //  On a few systems it may be necessary to input the full path to your forums directory
        //  for vBulletin to function normally. You can ignore this setting unless vBulletin
        //  tells you to fill this in. Do not include a trailing slash!
        //  Example Unix:
        //    $config['Misc']['forumpath'] = '/home/users/public_html/forums';
        //  Example Win32:
        //    $config['Misc']['forumpath'] = 'c:\program files\apache group\apache\htdocs\vb3';
    $config['Misc']['forumpath'] = '';

        //  ****** USERS WITH ADMIN LOG VIEWING PERMISSIONS ******
        //  The users specified here will be allowed to view the admin log in the control panel.
        //  Users must be specified by *ID number* here. To obtain a user's ID number,
        //  view their profile via the control panel. If this is a new installation, leave
        //  the first user created will have a user ID of 1\. Seperate each userid with a comma.
    $config['SpecialUsers']['canviewadminlog'] = '1';

        //  ****** USERS WITH ADMIN LOG PRUNING PERMISSIONS ******
        //  The users specified here will be allowed to remove ("prune") entries from the admin
        //  log. See the above entry for more information on the format.
    $config['SpecialUsers']['canpruneadminlog'] = '1';

        //  ****** USERS WITH QUERY RUNNING PERMISSIONS ******
        //  The users specified here will be allowed to run queries from the control panel.
        //  See the above entries for more information on the format.
        //  Please note that the ability to run queries is quite powerful. You may wish
        //  to remove all user IDs from this list for security reasons.
    $config['SpecialUsers']['canrunqueries'] = '';

        //  ****** UNDELETABLE / UNALTERABLE USERS ******
        //  The users specified here will not be deletable or alterable from the control panel by any users.
        //  To specify more than one user, separate userids with commas.
    $config['SpecialUsers']['undeletableusers'] = '';

        //  ****** SUPER ADMINISTRATORS ******
        //  The users specified below will have permission to access the administrator permissions
        //  page, which controls the permissions of other administrators
    $config['SpecialUsers']['superadministrators'] = '1,4,2';

        // ****** DATASTORE CACHE CONFIGURATION *****
        // Here you can configure different methods for caching datastore items.
        // vB_Datastore_Filecache  - for using a cache file
    // $config['Datastore']['class'] = 'vB_Datastore_Filecache';
        // vB_Datastore_Memcached - for using a Memcache server
        // It is also necessary to specify the hostname or IP address and the port the server is listening on
    /*
    $config['Datastore']['class'] = 'vB_Datastore_Memcached';
    $i = 0;
    // First Server
    $i++;
    $config['Misc']['memcacheserver'][$i]       = '127.0.0.1';
    $config['Misc']['memcacheport'][$i]         = 11211;
    $config['Misc']['memcachepersistent'][$i]   = true;
    $config['Misc']['memcacheweight'][$i]       = 1;
    $config['Misc']['memcachetimeout'][$i]      = 1;
    $config['Misc']['memcacheretry_interval'][$i] = 15;
    */
    // ****** The following options are only needed in special cases ******

        //  ****** MySQLI OPTIONS *****
        // When using MySQL 4.1+, MySQLi should be used to connect to the database.
        // If you need to set the default connection charset because your database
        // is using a charset other than latin1, you can set the charset here.
        // If you don't set the charset to be the same as your database, you
        // may receive collation errors.  Ignore this setting unless you
        // are sure you need to use it.
    // $config['Mysqli']['charset'] = 'utf8';

        //  Optionally, PHP can be instructed to set connection parameters by reading from the
        //  file named in 'ini_file'. Please use a full path to the file.
        //  Example:
        //  $config['Mysqli']['ini_file'] = 'c:\program files\MySQL\MySQL Server 4.1\my.ini';
$config['Mysqli']['ini_file'] = '';

    // Image Processing Options
        // Images that exceed either dimension below will not be resized by vBulletin. If you need to resize larger images, alter these settings.
    $config['Misc']['maxwidth'] = 2592;
    $config['Misc']['maxheight'] = 1944;

    /*======================================================================*\
    || ####################################################################
    || # Downloaded: 00:16, Wed Mar 19th 2008
    || # CVS: $RCSfile$ - $Revision: 16258 $
    || ####################################################################
    \*======================================================================*/ 
```

谁能给我一些想法？非常感谢，尼克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T18:47:32.123

错误“MySQL Error : Table 'db28587_bradp_forum.datastore' doesn't exist”表示您已成功连接到数据库，但无法找到数据存储表。

这可能意味着您的数据库导入不成功。如果您对数据库具有命令行访问权限（类似 phpMyAdmin 之类的东西也应该可以解决问题），您应该首先检查数据库本身是否存在，然后检查应该存在的各种表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T07:29:50.707

这个错误信息基本上什么也没说。
您能否提供更详细的错误消息（例如 Apache 日志）？
您可以尝试一件事：将“ `localhost`”替换为“ `127.0.0.1`”（是的，这对 mysql 有影响）

# java - 如何在服务器模式下将 OpenOffice 用作多线程服务？

> ID：625241
> 
> 赞同：23
> 
> 时间：2009-03-09T06:53:22.777
> 
> 标签：java, multithreading, openoffice.org

在服务器模式下使用[OpenOffice](http://en.wikipedia.org/wiki/OpenOffice.org)是什么体验？我知道 OpenOffice 不是多线程的，现在我需要在我们的服务器中使用它的服务。
我能做些什么来克服这个问题？

我正在使用 Java。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-11-08T17:39:28.457

使用当前版本的[JODConverter](http://code.google.com/p/jodconverter/) (3.0-SNAPSHOT)，在无头模式下处理 OOo 的多个线程非常容易，因为该库现在支持启动多个实例并将它们保存在池中，只需提供几个端口号或命名构建 OfficeManager 实例时的管道：

```
final OfficeManager om = new DefaultOfficeManagerConfiguration()
  .setOfficeHome("/usr/lib/openoffice")
  .setPortNumbers(8100, 8101, 8102, 8103)
  .buildOfficeManager();

om.start(); 
```

然后，您可以使用该库来转换文档，而无需在后台处理 OOo 实例池：

```
OfficeDocumentConverter converter = new OfficeDocumentConverter(om);
converter.convert(new File("src/test/resources/test.odt"), new File("target/test.pdf")); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T21:14:02.787

是的，我使用 OpenOffice 作为文档转换服务器。

不幸的是，您的问题的解决方案是生成一个 OpenOffice 进程池。

JODConverter的[commons-pool](http://jodconverter.svn.sourceforge.net/viewvc/jodconverter/branches/3.0.x-200801-commons-pool/)分支（在移至 之前`code.google.com`）为您实现了这个开箱即用的功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-06-14T11:28:55.913

谢谢巴斯蒂安。[_](https://stackoverflow.com/a/4126405/1746258) 根据巴斯蒂安的回答，我找到了另一种方法。打开几个端口，它提供了创建多线程的访问权限。但是如果没有很多端口（足够几个），我们可以通过增加`task queue timeout` [这里的文档](https://docs.exoplatform.org/public/index.jsp?topic=%2FPLF41%2FPLFAdminGuide.Configuration.JODConverter.html)来提高性能。还有一件事，我们决定不进行`start`每个`stop` `officeManager`转换过程。最后，我通过这种方法解决了这个任务：

```
public class JODConverter {

    private static volatile OfficeManager officeManager;
    private static volatile OfficeDocumentConverter converter;

    public static void startOfficeManager(){
        try {

            officeManager = new DefaultOfficeManagerConfiguration()
                    .setOfficeHome(new File('libre office home path'))
                    .setPortNumbers(8100, 8101, 8102, 8103, 8104 )  
                    .setTaskExecutionTimeout(600000L)    // for big files
                    .setTaskQueueTimeout(200000L)        // wait if all port were busy
                    .buildOfficeManager();
            officeManager.start();

            // 2) Create JODConverter converter
            converter = new OfficeDocumentConverter(officeManager);

        } catch (Throwable e){
            e.printStackTrace();
        }
    }

    public static void convertPDF(File inputFile, File outputFile) throws Throwable {

        converter.convert(inputFile, outputFile);
    }

    public static void stopOfficeManager(){
        officeManager.stop();
    }

} 
```

我在需要转换时调用`JODConverter`'s `convertPDF`。它只会在应用程序关闭时停止。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-05T20:18:52.570

OpenOffice 可以在无头模式下使用，但它还不能在压力很大的生产环境中处理大量请求。

在无头模式下使用 OpenOffice 有几个问题：

*   该进程可能会终止/变得不可用。
*   有几个内存泄漏问题。
*   打开几个 OpenOffice “worker”并没有像预期的那样扩展，并且需要一些调整才能真正拥有不同的打开过程（有几个 OpenOffice 副本、多个服务、在不同的用户下运行。）

如建议的那样，jodconverter 可用于访问 OpenOffice 进程。

[http://code.google.com/p/jodconverter/wiki/GettingStarted](http://code.google.com/p/jodconverter/wiki/GettingStarted)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-26T07:46:50.030

你可以试试这个：

[http://www.jopendocument.org/](http://www.jopendocument.org/)

它是一个基于 Java 的开源库，允许您在没有打开办公室的情况下处理打开的办公室文档，从而消除了对 OOserver 的需要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-14T18:14:02.753

Vlad 关于必须在不同端口上运行多个 OpenOffice 实例是正确的。

我只想补充一点，OpenOffice 似乎不稳定。我们在生产环境中运行它的 10 个实例，并将代码设置为在第一次尝试失败时重试另一个实例。这样，当其中一台 OpenOffice 服务器崩溃（或不崩溃但也不响应）时，生产不会受到影响。由于每天重启服务器很痛苦，我们正在慢慢地将所有文档转换为[JasperReports](http://en.wikipedia.org/wiki/JasperReports)（有关详细信息，请参阅 iReport）。我不确定您是如何使用 OpenOffice 服务器的；我们用它来合并邮件（为客户填写表格）。如果您需要将内容转换为 PDF，我推荐[iText](http://en.wikipedia.org/wiki/IText)。

# visual-studio - Visual Studio：是否对整个解决方案进行增量搜索？

> ID：625244
> 
> 赞同：9
> 
> 时间：2009-03-09T06:55:40.587
> 
> 标签：visual-studio, search

我非常喜欢 Visual Studio 中内置的键盘快捷键。我最喜欢的一个是**Ctrl+i**，它会触发**增量搜索**。当我填写搜索词时，它会跳过当前文档中的文本。输入所需的搜索词后，我使用**F3**跳过匹配项。

它工作正常，除了仅限于在**当前文档**中搜索。此外，触发增量搜索，会自动将对话框中的`Look In`选项更改为**Current Document**。`Find And Replace`

 **是否对整个解决方案进行增量搜索？它有键盘快捷键吗？或者至少有一种方法可以防止增量搜索的使用更改“查找”选项？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T06:59:35.163

我使用`Ctrl`- `Shift`-`F`在文件中查找。一旦我得到一个结果列表，你可以点击`F8`和`Shift`-`F8`循环浏览它们。`Ctrl`-`I`不影响此搜索的范围。

此外，在您找到与`Ctrl`-的第一场比赛后`I`，您不必点击，`F3`只需点击`Ctrl`-`I`和`Ctrl`-即可循环比赛。`Shift``I`

此外，跳转到特定文件或类的一种快速方法是使用[SonicFileFinder 之类的东西](http://www.jens-schaller.de/sonic-tools/sonicfilefinder/overview/overview.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:16:28.850

ReSharper 有一些非常好的[导航和搜索](http://www.jetbrains.com/resharper/features/navigation_search.html)功能，包括在整个解决方案中工作的增量[Go To Type搜索。](http://www.jetbrains.com/resharper/features/navigation_search.html#Go_to_Type)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-24T08:57:03.580

[Visual Sidekick](http://www.visualsidekick.com/Syntaxia/HomePage.php)对整个解决方案执行增量搜索。您也可以搜索文件名和符号名。该工具为我们进行的 C++ 开发节省了大量时间。可笑的是，Visual Sidekick 比 Visual Studio 自己的 IntelliSense 工作得更好。它虽然有一段时间没有更新，但还不支持 Visual Studio 2010。ReSharper 似乎不支持 C++。

[Visual Assist X](http://www.wholetomato.com/)支持多种语言（C++、C#、VB、ASP/ASP.NET、HTML、XML、JavaScript、VBScript、XAML），但它提供了许多通常不适用于 C++ 的重构工具（例如 Find References）因为 C++ 很难解析（宏、模板等）。

# c++ - 如何从 C++ 文件中读入一个单词？

> ID：625247
> 
> 赞同：2
> 
> 时间：2009-03-09T06:56:20.587
> 
> 标签：c++, file, input

所以我觉得无聊，决定做一个刽子手游戏。当我第一次学习 C++ 时，我在高中时做过这样的作业。但这是在我还没有学过几何之前，所以不幸的是我在它的任何形状或形式上都做得不好，学期结束后我一怒之下把所有东西都扔掉了。

我正在寻找一个 txt 文档，然后输入一大堆单词（即：测试爱饥饿的混乱混乱的馅饼尴尬你明白了）

所以这是我的问题：如何让 C++ 从文档中读取随机单词？

我有一种感觉`#include<ctime>`是需要的，以及`srand(time(0));`获得某种伪随机选择......但我对如何从文件中取出一个随机单词并没有最迷茫......有什么建议吗？

提前谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T07:07:58.030

这是一个粗略的草图，假设单词由空格（空格、制表符、换行符等）分隔：

```
vector<string> words;
ifstream in("words.txt");
while(in) {
  string word;
  in >> word;
  words.push_back(word);
}

string r=words[rand()%words.size()]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T07:37:48.910

字符串上使用的运算符 >> 将从流中读取 1 个（空白）空格分隔的单词。

所以问题是你想在每次选择一个单词时读取文件还是要将文件加载到内存中然后从内存结构中取出单词。没有更多信息，我只能猜测。

从文件中选择一个单词：

```
// Note a an ifstream is also an istream. 
std::string pickWordFromAStream(std::istream& s,std::size_t pos)
{
    std::istream_iterator<std::string> iter(s);
    for(;pos;--pos)
    {    ++iter;
    }

    // This code assumes that pos is smaller or equal to
    // the number of words in the file
    return *iter;
} 
```

将文件加载到内存中：

```
void loadStreamIntoVector(std::istream& s,std::vector<std::string> words)
{
    std::copy(std::istream_iterator<std::string>(s),
              std::istream_iterator<std::string>(),
              std::back_inserter(words)
             );
} 
```

生成随机数应该很容易。假设你只想要psudo-random。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T07:00:50.013

我建议在记事本中创建一个纯文本文件 (.txt) 并使用标准 C 文件 API（[fopen()](http://www.cplusplus.com/reference/clibrary/cstdio/fopen.html)和[fread()](http://www.cplusplus.com/reference/clibrary/cstdio/fread.html)）从中读取。您可以使用[fgets()](http://www.cplusplus.com/reference/clibrary/cstdio/fgets.html)一次读取每一行。

一旦你有了纯文本文件，只需将每一行读入一个数组，然后使用上面建议的方法随机选择数组中的一个条目。

# .net - WebMethod 响应格式

> ID：625250
> 
> 赞同：3
> 
> 时间：2009-03-09T06:58:18.413
> 
> 标签：.net, web-services, json, asmx

我最近看到一个 jQuery 示例，其中对“Default.aspx/Test”进行了 POST，其中 Test 是 Default.aspx 中的 WebMethod，请求的内容类型是“application/json”。

WebMethod 的回复是 JSON 格式的。我一直认为 WebMethods 返回 SOAP 响应，但如果我正确地解释了这段代码，就像我说的，WebMethod 返回 JSON。

它是否正确？WebMethods 是否以请求内容类型的格式返回响应？从什么时候开始可以做到这一点？总是？或者这是因为我安装了 ASP.NET AJAX？如果是这样，我可以反汇编哪些名称空间以查看其工作原理？

我只将 WebMethods 用于 .NET 到 .NET 的通信，它一直在 SOAP 中，并且始终编写自定义代码以根据指定所需的请求查询字符串参数以正确的格式（SOAP、JSON 或 XML）响应格式。我一直认为这种元格式功能需要 WCF。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T07:06:17.567

它是 的一部分`ASP.NET AJAX`。例如，请参阅[在 ASP.NET AJAX 中使用 Web 服务](http://msdn.microsoft.com/en-us/library/bb515101.aspx)。AJAX 客户端架构的一部分如下所示：

> 使用 HTTP POST 动词调用 Web 服务。POST 请求的主体包含浏览器发送到服务器的数据。它没有大小限制。因此，当数据大小超过 GET 请求的固有大小限制时，您可以使用 POST 请求。客户端将请求序列化为**JSON**格式，并将其作为 POST 数据发送到服务器。服务器将**JSON**数据反序列化为 .NET Framework 类型并进行实际的 Web 服务调用。在响应过程中，服务器将返回值序列化并将它们传递回客户端，客户端将它们反序列化为 JavaScript 对象进行处理。

# django - 如何在开发下一个版本的同时运行一个版本的 Web 应用程序？

> ID：625256
> 
> 赞同：5
> 
> 时间：2009-03-09T07:03:11.410
> 
> 标签：django, version-control

我刚刚完成了一个 Django 应用程序，我想获得一些外部用户的反馈。我想发布一个版本，然后分叉一个私人版本，这样我就可以合并反馈并添加更多功能。我计划对这个过程做很多小迭代。我是网络开发的新手；网站通常如何做到这一点？是否只是将我的 Django 项目文件夹复制到另一个目录，在那里启动服务器，然后在原始目录中继续我的开发工作？还是我想改用版本控制系统？我的直觉是后者，但如果是这样，它似乎是一个具有多种用途的巨大主题（例如协作，这不适用于这里），我真的不知道从哪里开始。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T07:53:16.017

**1) 单独的 URL** www.yoursite.com 与 test.yoursite.com。你也可以做 www.yoursite.com 和 www.yoursite.com/development 等等。你也可以创建一个 /beta 或 /staging..

**2) 保持独立的数据库，一个用于生产，一个用于开发。**编写一个脚本，将您的实时数据库复制到开发数据库中。为您创建的每种类型的网站保留一个数据库。（您可能想为您的测试人员创建一个 beta 或 staging 数据库）.. 在 dev 数据库中做您自己的工作。如果您更改数据库结构，请将更改保存为 .sql 文件，当您启用这些更改时，该文件可以加载并在实时站点数据库上运行。

**3）通过版本控制将功能合并到您的不同站点中。** 我目前正在为具有我的稳定（主干）、一个用于暂存和一个用于开发的 Web 应用程序进行颠覆设置。开发标签+分支合并到暂存中，然后暂存标签/分支合并到稳定中。版本控制可以让你以任何你想要的方式管理你的源代码。您必须找到适合您的方法并使用它。

**4) 考虑构建自动化。** 它会自动为您发布您的网站。看看[http://ant.apache.org/](http://ant.apache.org/)。它可以驱动大量自动检查您的代码并根据您的需要将其上传到每个特定站点。

**5) 本月玩具：**有一个名为[cUrl](http://curl.haxx.se/)的实用程序，您可能会发现它很有价值。它从命令行做了很多。如果您不想使用全部或任何 Ant，您可能可以这样做。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T07:05:58.330

您通常会使用版本控制，并且有两个域：your-site.com 和 test.your-site.com。然后 your-site.com 将始终更新到trunk，这是当前最新的发货版本。您将在主干的一个分支中进行开发，并且 test.your-site.com 将更新到该分支。然后定期将开发分支的更改合并到主干。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T11:15:58.700

如果您从开发的角度提出这个问题，Jas Panesar 肯定会给出最好的答案。也就是说，如果您只是询问如何轻松地将您的新开发项目与已经运行的站点分开。但是，如果您的问题实际上是询问如何同时运行两个版本，那么这是我的两分钱。

您的设置与此有很大关系，但我始终建议首先运行基于进程的 Web 服务器。也就是说，不使用线程服务器（与这个问题不太相关）并且不嵌入到 Web 服务器中（即不使用 mod_python，这是这里的相关部分）。因此，您有一个或多个进程从您的 Web 服务器（Apache、Nginx、Lighttpd 等）获取 HTTP 请求。现在，当您想在不影响正常运行的站点的情况下实时尝试某些东西时，您可以启动一个服务请求的进程，该进程永远不会像其他人那样将常规请求代理到它。也就是说，普通用户看不到它。

您可以设置一个指向该子域的子域，并且可以安装将“特殊”用户重定向到 beta 版本的中间件。这使您可以向某些用户展开新功能，但不能向其他用户展开。

现在，最大的问题来自数据库更改。模式迁移是一件大事，我们大多数人从未关注过。我认为并行运行很棒，因为它迫使您正确地进行模式迁移。也就是说，您不能在重新启动之前关闭所有内容并运行冗长的模式更改。您永远不会看到任何远程重要的站点这样做。

关键是那些小步骤。您需要始终让两个版本的代码能够访问同一个数据库，因此您对新代码所做的更改不会破坏旧代码。这分为几个步骤，您可以随时进行：

*   您可以添加具有默认值的列，或者这是可选的。新代码可以使用，旧代码可以忽略。
*   您可以使用知道使用新列的代码更新实时版本，此时您可以将其设为必需。
*   您可以让新版本忽略一列，当它成为主版本时，您可以删除该列。

您可以通过这些小步骤在任何模式之间进行迁移。您可以迭代地添加一个替换旧列的新列，推出新代码并删除旧列，所有这些都不会中断服务。

也就是说，它是您的第一个网络应用程序？你可能可以打破它。您可能很少有用户 :-) 但是，您甚至会问这个问题真是太棒了。许多“专业人士”公平地问过它，甚至更少回答它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T07:16:15.747

我所做的是导出我的 SVN 存储库的副本并将文件放在实时生产服务器上，然后保留具有开发工作副本的虚拟机，并在完成后将更改提交到存储库。

# java - 如何使用java的linkedlist库打印插入到链表中的数据

> ID：625259
> 
> 赞同：0
> 
> 时间：2009-03-09T07:07:03.227
> 
> 标签：java

```
class Collection 
{ 
    int sNo; 
    String sessionID; 
    int noOfDependency; 
    int noOfRejection; 
    int totalValue;

    Collection(int sNo, String sessionID, int noOfDependency, int noOfRejection, int totalValue)
    {
        this.sNo = sNo;
        this.sessionID = sessionID;
        this.noOfDependency = noOfDependency;
        this.noOfRejection = noOfRejection;
        this.totalValue = totalValue;
    }
}

public class DependencyStack {

    /** Creates a new instance of DependencyStack */

    public DependencyStack() 
    {
        LinkedList lList = new LinkedList();
        lList.add(new Collection(1,"a",0,0,0);
        lList.add(new Collection(2,"b",0,0,0));

        for(int i=0;i<lList.size();i++);
            System.out.println(lList.getFirst());
    } 
```

我无法查看个人数据。例如，如果我想查看所有 sno “序列号”，我该怎么做.. 我尝试了很多选项，请帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T07:55:13.017

使用标准 API 库作为上帝，嗯，我的意思是 Gosling 的意图。

说真的，这些已经被调整、优化和修正了一百次——你不太可能做得更好。

事实上，java.util.LinkedList 已经有一个大小计数器。但 ArrayList 在大多数情况下更好（例外：如果您在遍历时经常需要删除元素）。

顺便说一句，500-1000 个元素是零钱。没什么。你问这个问题所浪费的时间比你的程序运行 O(n) 实现一百万次还要多。

**编辑：**要在一个节点或列表槽中存储多条数据，请编写一个将您的数据作为字段的类（私有并通过 set 和 get 方法公开，如果您希望它特别“干净”）并放置该类进入列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:20:41.110

```
System.out.println(lList.getFirst()); 
```

lList.getFirst() 返回一个 Collection 类型的对象（顺便说一句，您应该使用更好的名称）。

因此，您必须例如访问 lList.getFirst().getSerialNumber() （并且您还必须在 Collection 类中编写方法 getSerialNumber() ......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T07:11:23.093

您是否有不想使用内置类（如 List）的原因？

这些类为您处理所有实现细节。看看[java.util.List](http://java.sun.com/j2se/1.4.2/docs/api/java/util/List.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T08:29:50.923

Java 的 LinkedList 类会在您添加/删除元素时跟踪大小。获取大小是免费的，您无需遍历列表。不要担心节点中的多条信息，只需将所有信息放在一个对象中即可。

我知道这是家庭作业，但你真的不应该看起来那么苛刻，并考虑发布一些说明你问题的代码。我们不是让你为你工作。

# c# - 在 C# 中以编程方式从 app.config 访问 system.net 设置

> ID：625262
> 
> 赞同：14
> 
> 时间：2009-03-09T07:08:56.733
> 
> 标签：c#, system.net

我正在尝试以编程方式访问 Windows 应用程序 app.config 文件。特别是，我正在尝试访问“system.net/mailSettings”以下代码

```
Configuration config = ConfigurationManager.OpenExeConfiguration(configFileName);

MailSettingsSectionGroup settings = 
    (MailSettingsSectionGroup)config.GetSectionGroup(@"system.net/mailSettings");

Console.WriteLine(settings.Smtp.DeliveryMethod.ToString());

Console.WriteLine("host: " + settings.Smtp.Network.Host + "");
Console.WriteLine("port: " + settings.Smtp.Network.Port + "");
Console.WriteLine("Username: " + settings.Smtp.Network.UserName + "");
Console.WriteLine("Password: " + settings.Smtp.Network.Password + "");
Console.WriteLine("from: " + settings.Smtp.From + ""); 
```

未能给主机，从。它只获取端口号。其余为空；

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T08:01:19.133

这对我来说似乎没问题：

```
MailSettingsSectionGroup mailSettings =
    config.GetSectionGroup("system.net/mailSettings")
    as MailSettingsSectionGroup;

if (mailSettings != null)
{
    string smtpServer = mailSettings.Smtp.Network.Host;
} 
```

这是我的 app.config 文件：

```
<configuration>
  <system.net>
    <mailSettings>
      <smtp>
        <network host="mail.mydomain.com" />
      </smtp>
    </mailSettings>
  </system.net>
</configuration> 
```

但是，正如 Nathan 所说，您可以使用应用程序或机器配置文件来指定所有[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)对象的默认主机、端口和凭据值。有关详细信息，请参阅MDSN 上的[<mailSettings> 元素](http://msdn.microsoft.com/en-us/library/w355a94k.aspx)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-09T07:24:54.823

不确定这是否有帮助，但如果您尝试创建 SmtpClient，如果您使用默认构造函数，它将自动使用配置文件中的值。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-29T03:12:01.010

我使用以下内容访问mailSettings：

```
var config = ConfigurationManager.OpenExeConfiguration(
    ConfigurationUserLevel.None);

var mailSettings = config.GetSectionGroup("system.net/mailSettings") 
    as MailSettingsSectionGroup; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-12T12:16:33.243

```
private void button1_Click(object sender, EventArgs e)
{
    try
    {
        var config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);

        var mailSettings = config.GetSectionGroup("system.net/mailSettings")
            as MailSettingsSectionGroup;
        MailMessage msg = new MailMessage();
        msg.Subject = "Hi Raju";
        msg.To.Add("raju@hasten.in");
        msg.From = new MailAddress("hasten.c@hasten.in");
        msg.Body = "Hello Raju here everything is fine.";
        //MailSettingsSectionGroup msetting = null;
        string mMailHost = mailSettings.Smtp.Network.Host;

        SmtpClient mailClient = new SmtpClient(mMailHost);
        mailClient.Send(msg);
        MessageBox.Show("Mail Sent Succesfully...");
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.ToString());
    }
} 
```

# c - malloc() 是否分配连续的内存块？

> ID：625270
> 
> 赞同：39
> 
> 时间：2009-03-09T07:16:13.890
> 
> 标签：c, coding-style, malloc

我有一段由一位非常老派的程序员编写的代码:-)。它是这样的

```
typedef struct ts_request
{ 
  ts_request_buffer_header_def header; 
  char                         package[1]; 
} ts_request_def; 

ts_request_def* request_buffer = 
malloc(sizeof(ts_request_def) + (2 * 1024 * 1024)); 
```

程序员基本上正在研究缓冲区溢出概念。我知道代码看起来很狡猾。所以我的问题是：

1.  malloc 是否总是分配连续的内存块？因为在这段代码中，如果块不连续，代码将大量失败

2.  这样做`free(request_buffer)`，它会释放 malloc ie 分配的所有字节`sizeof(ts_request_def) + (2 * 1024 * 1024)`，还是只释放结构大小的字节`sizeof(ts_request_def)`

3.  您是否看到这种方法有任何明显的问题，我需要与我的老板讨论这个问题，并希望指出这种方法的任何漏洞

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-09T08:40:27.480

回答你的编号点。

1.  是的。
2.  所有字节。Malloc/free 不知道也不关心对象的类型，只关心大小。
3.  严格来说，这是未定义的行为，但是许多实现都支持的常见技巧。有关其他替代方案，请参见下文。

最新的 C 标准 ISO/IEC 9899:1999（非正式地 C99）允许[灵活的数组成员](http://www.comeaucomputing.com/techtalk/c99/#flexiblearrays)。

这方面的一个例子是：

```
int main(void)
{       
    struct { size_t x; char a[]; } *p;
    p = malloc(sizeof *p + 100);
    if (p)
    {
        /* You can now access up to p->a[99] safely */
    }
} 
```

这个现在标准化的功能允许您避免使用您在问题中描述的常见但非标准的实现扩展。严格来说，使用非灵活的数组成员并超出其边界访问是未定义的行为，但许多实现记录并鼓励它。

此外，[gcc](http://gcc.gnu.org/)允许[零长度数组](http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html)作为扩展。零长度数组在标准 C 中是非法的，但是 gcc 在 C99 给我们灵活的数组成员之前就引入了这个特性。

在回复评论时，我将解释为什么下面的代码片段在技术上是未定义的行为。我引用的章节编号参考 C99 (ISO/IEC 9899:1999)

```
struct {
    char arr[1];
} *x;
x = malloc(sizeof *x + 1024);
x->arr[23] = 42; 
```

首先，6.5.2.1#2 表明 a[i] 等同于 (*((a)+(i)))，因此 x->arr[23] 等同于 (*((x->arr)+( 23)))。现在，6.5.6#8（关于添加指针和整数）说：

> “如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则评估不应产生溢出；否则，**行为未定义**。”

由于这个原因，因为 x->arr[23] 不在数组中，所以行为是未定义的。您可能仍然认为这没关系，因为 malloc() 意味着数组现在已扩展，但严格来说并非如此。资料性附录 J.2（列出了未定义行为的示例）通过示例提供了进一步的说明：

> 数组下标超出范围，即使一个对象显然可以使用给定的下标访问（如在给定声明 int a[4][5] 的左值表达式 a[1][7] 中）（6.5.6）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-09T07:41:12.380

3 - 这是在结构末尾分配动态数组的一个非常常见的 C 技巧。另一种方法是将指针放入结构中，然后单独分配数组，并且不要忘记释放它。不过，大小固定为 2mb 似乎有点不寻常。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T08:23:16.820

这是一个标准的 C 技巧，并不比任何其他缓冲区更危险。

如果你想向你的老板证明你比“非常老派的程序员”更聪明，那么这段代码不适合你。老学校不一定坏。似乎“老派”家伙对内存管理足够了解；）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-09T07:23:22.050

1）是的，如果没有足够大的连续块可用，malloc 将失败。（malloc 失败将返回一个 NULL 指针）

2）是的，它会的。内部内存分配将跟踪使用该指针值分配的内存量并释放所有内存。

3）这有点像一种语言黑客，而且对它的使用有点怀疑。它仍然会受到缓冲区溢出的影响，只是攻击者可能需要稍长的时间才能找到导致它的有效负载。“保护”的成本也相当高（你真的需要每个请求缓冲区> 2mb吗？）。这也很丑陋，虽然你的老板可能不喜欢这个论点:)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-10T23:19:47.547

我认为现有的答案并没有完全触及这个问题的本质。你说老派程序员正在做这样的事情；

```
typedef struct ts_request
{ 
  ts_request_buffer_header_def header; 
  char                         package[1]; 
} ts_request_def;

ts_request_buffer_def* request_buffer = 
malloc(sizeof(ts_request_def) + (2 * 1024 * 1024)); 
```

我认为他不太可能完全那样做，因为如果这是他想做的，他可以使用不需要任何技巧的简化等效代码来做到这一点；

```
typedef struct ts_request
{ 
  ts_request_buffer_header_def header; 
  char                         package[2*1024*1024 + 1]; 
} ts_request_def;

ts_request_buffer_def* request_buffer = 
malloc(sizeof(ts_request_def)); 
```

我敢打赌，他真正在做的是这样的事情；

```
typedef struct ts_request
{ 
  ts_request_buffer_header_def header; 
  char                         package[1]; // effectively package[x]
} ts_request_def;

ts_request_buffer_def* request_buffer = 
malloc( sizeof(ts_request_def) + x ); 
```

他想要实现的是分配具有可变包大小 x 的请求。用变量声明数组的大小当然是非法的，所以他用一个技巧来解决这个问题。看起来他好像知道他在对我做什么，这个技巧很好地接近了 C 诡计规模的可敬和实用的目的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-11T00:47:23.607

是的。malloc 只返回一个指针——它怎么可能告诉请求者它已经分配了多个不连续的块来满足请求？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T07:28:08.903

至于＃3，没有更多代码很难回答。我看不出有什么问题，除非它发生了很多。我的意思是，你不想一直分配 2mb 的内存块。您也不想不必要地这样做，例如，如果您只使用 2k。

由于某种原因你不喜欢它的事实不足以反对它，或者证明完全重写它是合理的。我会仔细查看用法，尝试了解原始程序员的想法，仔细查看使用此内存的代码中的缓冲区溢出（如 workmad3 所指出的）。

您可能会发现很多常见错误。例如，代码是否检查以确保 malloc() 成功？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-09T07:37:39.440

漏洞利用（问题 3）实际上取决于您的这种结构的接口。在上下文中，这种分配可能是有意义的，如果没有进一步的信息，就不可能说它是否安全。
但是，如果您的意思是分配比结构更大的内存的问题，这绝不是一个糟糕的 C 设计（我什至不会说它是那么老派......；））
这里只是最后一点 - 有一个要点char[1] 是终止 NULL 将始终在声明的结构中，这意味着缓冲区中可以有 2 * 1024 * 1024 个字符，并且您不必通过“+1”来解释 NULL。可能看起来像一个小壮举，但我只是想指出。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-09T08:29:48.847

我经常看到并使用这种模式。

它的好处是简化内存管理，从而避免内存泄漏的风险。只需释放 malloc 的块。使用辅助缓冲区，您将需要两个免费缓冲区。但是，应该定义并使用析构函数来封装此操作，以便您始终可以更改其行为，例如切换到辅助缓冲区或在删除结构时添加要执行的其他操作。

访问数组元素的效率也稍高一些，但对于现代计算机来说，这一点越来越不重要了。

如果内存对齐在不同编译器的结构中发生变化，代码也将正确工作，因为它非常频繁。

我看到的唯一潜在问题是编译器是否改变了成员变量的存储顺序，因为这个技巧要求包字段在存储中保持在最后。我不知道 C 标准是否禁止排列。

另请注意，分配的缓冲区的大小很可能比所需的大，至少一个字节，如果有的话，还有额外的填充字节。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-13T07:31:54.167

回答你的第三个问题。

`free`总是一次性释放所有分配的内存。

```
int* i = (int*) malloc(1024*2);

free(i+1024); // gives error because the pointer 'i' is offset

free(i); // releases all the 2KB memory 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-13T07:37:43.107

这个常见的 C 技巧也在[这个 StackOverflow 问题中进行了解释（有人可以解释这个在 solaris 中定义的 dirent 结构吗？）](https://stackoverflow.com/questions/563045/can-someone-explain-this-definition-of-the-dirent-struct-in-solaris)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-09T08:38:42.773

想补充一点，这并不常见，但我也可以将其称为标准做法，因为 Windows API 充满了这种用途。

例如，检查非常常见的 BITMAP 标头结构。

[http://msdn.microsoft.com/en-us/library/aa921550.aspx](http://msdn.microsoft.com/en-us/library/aa921550.aspx)

最后一个 RBG quad 是一个大小为 1 的数组，这完全取决于这种技术。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-09T07:22:48.307

问题 1 和 2 的答案是肯定的

关于丑陋（即问题3）程序员试图用分配的内存做什么？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-09-05T21:46:25.043

这里要意识到的是，`malloc`没有看到在此进行的计算

```
malloc(sizeof(ts_request_def) + (2 * 1024 * 1024)); 
```

它与

```
 int sz = sizeof(ts_request_def) + (2 * 1024 * 1024);
   malloc(sz); 
```

您可能会认为它分配了 2 块内存，并且在您的脑海中它们是“结构”、“一些缓冲区”。但是 malloc 根本看不到这一点。

# string - Firebird判断一个字符串是否全是数字

> ID：625286
> 
> 赞同：1
> 
> 时间：2009-03-09T07:27:09.090
> 
> 标签：string, sorting, numbers, firebird, casting

我在 Firebird 2.0 表中有一个可以包含字母数字字符的 VARCHAR 字段。我需要对该字段的数据进行排序，将所有仅包含数字的值排序为数字，并将所有其他值排序为​​ 0。

例如，如果我有四个值，

```
"1", "2", "10", "string", 
```

我需要将其排序为

```
"string", "1", "2", "10". 
```

字符串排序的默认排序为

```
"1", "10", "2", "string". 
```

我正在考虑将值转换为 INTEGER，但我在字符串上遇到转换错误，这当然是正确的。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:59:22.280

您可以使用内置函数 LPAD：

```
SELECT
  ...
  <number_field>,
  ...
FROM
  ...
ORDER BY
  LPAD(<numer_field>, 10) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T08:19:54.427

使用您的应用程序创建额外的列来存储可排序的值。然后根据该列进行排序。如果您希望您的数字位于末尾，请在数字前面插入“ZZZ”（或“ÜÜÜ”或您的语言中的最后一个字符）。像 Format("ZZZ%012d", my_num);

# python - 集成 CherryPy Web 框架、SQLAlchemy 会话和 lighttpd 以提供高负载 Web 服务的最佳实践

> ID：625288
> 
> 赞同：6
> 
> 时间：2009-03-09T07:28:24.143
> 
> 标签：python, sqlalchemy, lighttpd, cherrypy

我正在使用以下设置在 lighttpd 后面开发一个 CherryPy FastCGI 服务器，以启用在 CherryPy 控制器中使用 ORM SQLAlchemy 会话。但是，当我对大约 500 个循环的 14 个并发请求运行压力测试时，它开始出现类似`AttributeError: '_ThreadData' object has no attribute 'scoped_session_class'`in`open_dbsession()`或`AttributeError: 'Request' object has no attribute 'scoped_session_class'`in`close_dbsession()`一段时间后的错误。错误率总共约为 50%。

仅当我在 lighttpd 后面运行服务器时才会发生这种情况，而不是直接通过`cherrypy.engine.start()`. 已确认`connect()`不会引发异常。

`scoped_session`我还尝试分配to的返回值`GlobalSession`（就像它在[此处](http://code.google.com/p/webpyte/source/browse/trunk/webpyte/sqlalchemy_tool.py)所做的那样），但随后它给出了诸如`UnboundExceptionError`和其他 SA 级错误之类的错误。（并发：10，循环：1000，错误率：16%。即使直接运行也会发生。）

有一些可能的原因，但我缺乏足够的知识来选择一个。
1\. `start_thread`FastCGI环境下订阅不可靠吗？似乎`open_dbsession()`是在 2 之前调用的`connect()`
。是否`cherrypy.thread_data`由于某种原因被清除？

### 服务器代码

```
import sqlalchemy as sa  
from sqlalchemy.orm import session_maker, scoped_session

engine = sa.create_engine(dburi, strategy="threadlocal")  
GlobalSession = session_maker(bind=engine, transactional=False)

def connect(thread_index):  
    cherrypy.thread_data.scoped_session_class = scoped_session(GlobalSession)

def open_dbsession():  
    cherrypy.request.scoped_session_class = cherrypy.thread_data.scoped_session_class

def close_dbsession():  
    cherrypy.request.scoped_session_class.remove()

cherrypy.tools.dbsession_open = cherrypy.Tool('on_start_resource', open_dbsession)  
cherrypy.tools.dbsession_close = cherrypy.Tool('on_end_resource', close_dbsession)  
cherrypy.engine.subscribe('start_thread', connect) 
```

### lighttpd fastcgi 配置

```
...
var.server_name = "test"
var.server_root = "/path/to/root"
var.svc_env = "test"
fastcgi.server = (
  "/" => (
    "cherry.fcgi" => (
      "bin-path" => server_root + "/fcgi_" + server_name + ".fcgi",
      "bin-environment" => (
        "SVC_ENV" => svc_env
      ),
      "bin-copy-environment" => ("PATH", "LC_CTYPE"),
      "socket" => "/tmp/cherry_" + server_name + "." + svc_env + ".sock",
      "check-local" => "disable",
      "disable-time"    => 1,
      "min-procs"       => 1,
      "max-procs"       => 4,
    ),
  ),
) 
```

### 编辑

*   从原始源代码中恢复了代码示例中缺少的`thread_index`参数（感谢注释）
*   澄清错误不会立即发生
*   将条件缩小到 lighttpd

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T17:55:32.450

如果你看`plugins.ThreadManager.acquire_thread`，你会看到 line `self.bus.publish('start_thread', i)`，这里`i`是所见线程的数组索引。订阅`start_thread`频道的任何侦听器都需要接受该`i`值作为位置参数。所以重写你的连接函数来读取：`def connect(i):`

我猜它以某种方式默默地失败了；我会看看我是否可以追踪、测试和修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T03:13:21.860

> 我还尝试将 scoped_session 的返回值分配给 GlobalSession（就像这里所做的那样），但随后它给出了 UnboundExceptionError 和其他 SA 级错误之类的错误。（并发：10，循环：1000，错误率：16%）

如果我没有显式实例化 scoped_session 类，则不会发生此错误。

IE

```
GlobalSession = scoped_session(session_maker(bind=engine, transactional=False))

def connect(thread_index):  
    cherrypy.thread_data.scoped_session_class = GlobalSession

def open_dbsession():  
    cherrypy.request.scoped_session_class = cherrypy.thread_data.scoped_session_class

def close_dbsession():  
    cherrypy.request.scoped_session_class.remove() 
```

# asp.net - 如何将 GridView 单元格值存储到会话变量中？

> ID：625290
> 
> 赞同：1
> 
> 时间：2009-03-09T07:31:13.590
> 
> 标签：asp.net, gridview

如何将 GridView 的选定行的值存储到会话变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T07:38:34.760

从代码隐藏文件中，您将需要使用类似的东西来访问所选行中的基础数据项 (MyDataItem)。

```
MyDataItem item = (MyDataItem)GridView1.Rows[GridView1.SelectedIndex].DataItem;
Session["myItem"] = item; 
```

但请记住，gridview 已经为您存储了这些数据，因此您可能只想在需要时直接从 GridView 访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:02:03.297

附带说明：我可以强烈建议您**不要**使用会话状态。

除非您将它用作为当前用户缓存数据的存储，否则您可以**随时**从例如数据库中检索这些数据。

如果没有，“会话”会回来*咬*你。在某些时候，会有一个用户打开浏览器的时间比您的会话寿命更长（例如，他们接到一个电话，匆忙出去吃午饭，匆忙参加会议......）。当他们回来时，他们希望完成他们正在做的事情。而且，如果您当时无法恢复所有会话数据，您将不得不重新引导您的用户重新开始（这对您的用户来说非常烦人），或者您将丢失一些信息（非常尴尬），或者最糟糕的情况情况，最常见的情况：您的应用程序将不再工作并崩溃（很简单：非常糟糕）。

定义存储状态（查询参数、选定项等）的小型可序列化对象并使用 ASP.NET Viewstate 跨页面请求存储该状态是一种更好的方法。请注意，大多数 ASP.NET 控件已经使用视图状态来存储它们的数据。然后禁用页面中网格的视图状态，以大大减少视图状态中的数据量，并在每次请求时请求数据（这里可以安全地使用会话或 ASP.NET 缓存来提高应用程序的性能） . 您将拥有一个更健壮、更具可扩展性的应用程序。

这是更多的工作，但它会很快得到回报，而且会翻很多倍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T03:55:04.113

ViewState 仅作用于一页内。它对回发问题很有用，但对跨页问题没有用。Session 可以同时处理这两种情况，但它有一些安全性、寿命、传输时间的限制……取决于特定情况，您可以选择正确的选择。

# vb6 - vb6中的面向对象|好的设计有什么好的参考吗？

> ID：625292
> 
> 赞同：2
> 
> 时间：2009-03-09T07:31:51.060
> 
> 标签：vb6, oop, reference

我目前正在修改旧版编辑器应用程序，我需要添加一些数据结构，这些数据结构我已经制作成它自己的类，稍后我将其添加到集合对象中。但到目前为止，我对将与该对象相关的所有功能放在哪里有点模糊。我在想也许 OO 喜欢设计，但我不太确定如何在 vb6 中做到这一点。否则所有功能当前都在模块 mdl 文件中。设置为公共功能。

有没有什么好的参考书、书籍或任何我可以了解更多关于如何正确设计 vb6 应用程序的东西？我想对于当前的工作和未来的工作。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T08:29:04.013

你熟悉洛奇洛特卡的作品吗？我建议阅读 Visual Basic 6 Business Objects。

> *Visual Basic 6 Business Objects*全面介绍了如何使用对象来模拟现实世界的业务问题。

您也可以访问[www.lhotka.net](http://www.lhotka.net/)

编辑 ：

我知道这听起来很麻烦，但我真的建议您花时间阅读 Rocky 的书。他谈到了模拟 OOP 原则，例如。就像在 vb6 等中模拟继承一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T09:07:11.660

另一个很好的信息来源是[Deborah Kurata](https://rads.stackoverflow.com/amzn/click/com/1562765779)，她写了一系列关于 VB OO 编码的书籍。不如 Rocky Lhotka（他非常出色）出名，并且更多地关注纯 OO，而不是他所做的 ORM/DB 层。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T12:19:37.500

到目前为止引用的所有参考资料都很好。然而，四人组的设计模式可用于 Visual Basic 6。要记住，设计模式中讨论的大多数模式都依赖于实现 VB6 可以很好地完成的接口。事实上，您会发现大多数设计模式都涉及实现接口。

这是因为大多数设计模式都专注于设置各种对象的交互方式，而不是重用行为。所以界面变得更加重要。

GoF 的[设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)[Martin Fowler](http://www.martinfowler.com/eaaDev/) 的模式 各种 GUI 和演示模式在我看来是最适用的。

我自己的应用程序完全由一系列设计模式构成。例如，我对表示层使用被动视图。各种视图称为命令对象，它们对模型进行实际修改。我使用工厂来检索报告、文件类型和形状我的软件支持的列表。全部使用 GoF 的设计模式书在 VB6 中完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T23:09:43.817

在深入了解这些书籍所涵盖的 OOP 的神学方面之前，您可以从简单地阅读 VB6 文档开始。特别是关于组件设计的部分。

# linux - 从 linux 服务器发送短信的最简单系统是什么？

> ID：625295
> 
> 赞同：12
> 
> 时间：2009-03-09T07:33:35.270
> 
> 标签：linux, sms, debian, sysadmin

从 linux 服务器发送短信的最简单系统是什么？它是一个 Debian 系统。不会有太多的短信。使用什么硬件和软件？也许使用一些短信发送服务？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T15:36:12.847

是的，我认为最简单的方法是使用串行 GSM 调制解调器，或具有串行连接的 GSM 电话和 SIM 卡。一些 USB 可以工作，但最好获得一个串行的并保持安全。

串行调制解调器不需要任何驱动程序，您只需要通过串行端口（/dev/tty ...）连接并在那里转储命令...

此外，如果您想要更轻松，您可以安装 Linux 上可用的 SMS 工具。它们在 Ubuntu、Debian 和其他发行版中以简单的名称“smstools”打包。

最后一个版本是 3 号，你可以在这个网站上获得一些信息：http: [//smstools3.kekekasvi.com/](http://smstools3.kekekasvi.com/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T07:55:28.493

如果您喜欢自己动手并使用旧手机，试试[这个](http://www.x11.net/wiki/index.php/Setting_up_an_SMS_Gateway)食谱 :-)

与使用某些电子邮件 SMS 服务相比，这种方法有一个真正的优势：计算机网络问题不会影响本地硬件。如果您使用 SMS 来监控您的服务器，这一点尤其重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T07:42:43.093

每个手机公司都提供电子邮件地址以向手机发送短信。例如，verizon 使用类似 55512345678@vtext.com 的方式发送消息。您需要做的就是找到每个提供商的电子邮件域列表，然后找出您的用户订阅的服务。之后，只需像普通电子邮件一样发送短信。大多数软件都是这样做的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T07:48:05.547

由于您可能正在寻找立陶宛服务（从您的名字来看），请查看[www.gsms.lt](https://www.gsms.lt/lit/Detalus_aprasymas/178)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T07:42:16.573

也许[这个](https://stackoverflow.com/questions/4269/programmatic-sms)问题可以帮助你。否则看看[Kannel](http://www.kannel.org)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-28T14:57:12.267

还有另一个选项 perl 独立执行。直接下载运行。无需现代。全球短信支持和免费试用。

你可以参考[http://www.sms4mail.com/smsmail/smscmd.htm](http://www.sms4mail.com/smsmail/smscmd.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T09:15:23.703

最简单的方法是使用 GPRS 调制解调器或调制解调器池。更高级 - 在蜂窝网络运营商处购买网关服务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-06T09:45:19.157

使用连接到串行端口的调制解调器。并使用 gnokii。

# java - 这个 .jar 文件有什么问题？

> ID：625302
> 
> 赞同：0
> 
> 时间：2009-03-09T07:37:58.427
> 
> 标签：java, opengl, jar, jogl

我正在尝试将我的 JoGL 项目变成一个`jar`文件。我究竟做错了什么？

```
Exception in thread "main" java.lang.NoClassDefFoundError: javax/media/opengl/GL
EventListener
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.access$000(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClassInternal(Unknown Source)
Caused by: java.lang.ClassNotFoundException: javax.media.opengl.GLEventListener
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClassInternal(Unknown Source)
        ... 12 more
Could not find the main class: chartest.  Program will exit. 
```

JAR 文件的内容：

```
META-INF\MANIFEST.MF
gluegen-rt.jar
jogl.jar
chartest$1.class
chartest.class
gluegen-rt.dll
jogl.dll
jogl_awt.dll
jogl_cg.dll
test.png 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T07:55:05.797

您可以检查您的类路径。它应该至少包括

*   包含您编写的类的 jar 文件
*   支持带有 javax.media.opengl (jogl.jar?) 等类的 jar

尝试将所有这些 jars 放在你的类路径中并运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T08:09:16.777

Jogle jar 文件在你的类路径中吗？

我看到您已将罐子本身包含在您的罐子中……不幸的是，这不能开箱即用。

要么把罐子拿出来，然后放在你的类路径中（这也可以是你清单的一部分），或者编写你自己的类加载器......

[http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)

这就是为什么它适用于威廉而不是你......他从其他地方得到了jogl并且没有使用你罐子里的那个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-05T20:18:12.267

切换到 Netbeans 以构建您的 jar 文件。我发现在我的项目中使用其他库，包括 dll 文件，最好使用 Netbeans 之类的东西，或者只是用 maven 打包它。

```
mvn clean package 
```

如果你想使用 maven 来打包你所有的 jar 文件，你需要精通 xml。

# python - 从 GAE SDK 控制台转储内存缓存密钥？

> ID：625314
> 
> 赞同：1
> 
> 时间：2009-03-09T07:49:02.470
> 
> 标签：python, google-app-engine, memcached

在“Memcache Viewer”中，有没有办法转储现有密钥的列表？当然，仅用于调试，不用于任何脚本！

我问是因为 GAE SDK 似乎没有使用“真正的”memcache 服务器，所以我猜它是用 Python 模拟的（为简单起见，因为它只是一个开发服务器）。这意味着有一个 dict有键/值的地方..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T14:56:16.423

人们经常在 memcached 列表上要求这个，有时会带有相同类型的“以防万一我想环顾四周以调试某些东西”的情绪。

处理这个问题的最好方法是知道你是如何生成你的密钥的，当你想知道为给定值存储了什么时，就去查找资料。

如果您在调试会话范围内使用 memcached 做的事情太多，那么请开始记录访问。

但请记住——memcached 速度很快，因为它通常不允许这样的事情。社区服务器确实具有有限的功能来获取给定平板类中可用的密钥子集，但这可能不是您真正想要的，希望谷歌不会在他们的中实现它。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T08:02:17.243

不，我也没有在 memcached 中找到这样的功能。

考虑到这个问题，我发现这个限制是可以理解的——它需要保留一个包含所有相关问题的密钥注册表，例如密钥过期、失效，当然还有锁定。这样的系统不会像 memcache 预期的那样快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:29:07.720

Memcache 的设计目的是快速，并且此功能没有令人信服的用例，这将证明与 memcached 的其余部分如此不一致的命令所需的开销是合理的。

GAE SDK 正在模拟 memcached，因此它也不提供此功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T23:12:49.827

我能想到的最简单的方法是在已知 ID 处维护一个 memcache 密钥，然后在每次插入新密钥时附加到它。这样，您只需查询单个键即可获取现有键的列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-02T18:36:18.947

这是一个可能的解决方法。我不熟悉 Google App Engine，但在常规的内存缓存服务器上，您可以通过 telnet 列出所有密钥，如下所示：

```
telnet 127.0.0.1 11211
stats items
STAT items:7:number 5
STAT items:7:age 88779
STAT items:7:evicted 0
STAT items:7:evicted_time 0
STAT items:7:outofmemory 0
STAT items:7:tailrepairs 0
... etc
END
stats cachedump 7 100
ITEM __builtin__.str_is_browser_supported·user_agent_hash=5706b885fdad3f7049dfb39455dfa7ab10086d97 [269 b; 1298926467 s]
END 
```

感谢[Graham King 的博客文章](http://www.darkcoding.net/software/memcached-list-all-keys/)，提供了这个不错的小食谱。

# javascript - 如何检查是否在弹出窗口中单击了（X）按钮

> ID：625315
> 
> 赞同：1
> 
> 时间：2009-03-09T07:49:56.853
> 
> 标签：javascript, html

我正在尝试从子窗口将值设置为父窗口中的隐藏字段，并且仅在弹出窗口关闭时才将值设置为父窗口。

当我使用按钮关闭窗口时，这工作正常。

按钮的脚本是：onclick="javascript:window.close();"

但是当我单击标题栏中的 (X) 按钮时，同样的情况会失败。谁能帮我解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T07:57:05.667

使用 onBeforeUnload。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-06T02:18:10.907

```
<html>
<script type="text/javascript">
    function ConfirmClose()
    {
       if ((event.clientY < 0) ||(event.altKey) ||(event.ctrlKey)||((event.clientY < 129) && (event.clientY>107)))
        {
//event.altKey When press Alt +F4
//event.ctrlKey When press Ctrl +F4
//event.clientY 107 or 129 is  Alt F4 postion on window screen it may change base on screen resolution
alert('window closing');
        }
    }
</script>

<body topmargin='0'  onbeforeunload="ConfirmClose()">
</body>
 </html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T08:15:53.327

最好的方法是使用 window.onunload 但是当你按下 ctrl+r 时也会触发这个事件（即刷新时），所以只需检查一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T08:44:43.460

我发现[jQuery 对话框](http://docs.jquery.com/UI/Dialog)很容易创建弹出窗口。这可以防止浏览器阻止“真实”弹出窗口以及您在此处描述的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-23T05:48:31.173

为您准备的文档：[http ://www.openjs.com/scripts/events/keyboard_shortcuts/](http://www.openjs.com/scripts/events/keyboard_shortcuts/)

```
shortcut.add("Ctrl+Shift+X",function() {
    alert("Hi there!");
}); 
```

下载：[http ://www.openjs.com/scripts/events/keyboard_shortcuts/shortcut.js](http://www.openjs.com/scripts/events/keyboard_shortcuts/shortcut.js)

# asp.net - 从 Asp.Net 的代码隐藏控制灯箱（模态）

> ID：625326
> 
> 赞同：0
> 
> 时间：2009-03-09T07:58:08.503
> 
> 标签：asp.net, javascript, jquery, lightbox

在与 Ajax 和 Jquery 会面之前，在我的项目中，我有一个如下所示的功能。

```
Public Sub Raise_Alarm(ByVal p_Page As Page, ByVal p_Message As String, Optional ByVal p_IsError As Boolean = True)

strScript = "<script language= ""javascript""> alert('" & p_Message.Replace("'", "") & "')</script>"
    Dim t As Type = p_Page.GetType()
    p_Page.ClientScript.RegisterStartupScript(t, "alert", strScript)
    Dim mylabel As Label

end sub 
```

现在我想要一个函数而不是上面的函数，它将消息显示为灯箱（模态框）。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T08:06:31.663

尝试使用优秀的 jQuery 插件之一来显示模态窗口，例如[jqModal](http://dev.iceburg.net/jquery/jqModal/)。文档解释了如何配置和启动模态窗口，并包含一些很好的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:32:39.293

如果您想按照上面 cxfx (+1;) 的建议使用 jqModal，这应该有效：

```
strScript = "$('<div>" & p_Message.Replace("'", "\'") & "</div>').jqm();";
ClientScriptManager.RegisterStartupScript(p_Page.GetType(), "alert", strScript, true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T08:45:25.377

如果您使用的是“thickbox”，它只能在模式窗口中显示一个 noraml aspx 页面。然后，您可以正常使用后面的代码。

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />

<link href="/themes/ui.all.css" rel="stylesheet" type="text/css" />       
<link runat="server" href="/styles/thickbox.css" rel="stylesheet" type="text/css" />       
<!-- jQuery -->
<script type="text/javascript" src="/scripts/jquery-1.3.2.js"></script>
<script type="text/javascript" src="/scripts/ui.core.js"></script>
<script type="text/javascript" src="/scripts/thickbox.js"></script>      

</head>
<body>
       <a class="thickbox" href="mylink.aspx?KeepThis=true&TB_iframe=true&height=300&width=850">modal thick box link</a>
</body>
</html> 
```

希望这可以帮助。

# symfony1 - 将用户会话数据存储到自定义数据库中

> ID：625327
> 
> 赞同：1
> 
> 时间：2009-03-09T07:59:27.500
> 
> 标签：symfony1

可以通过更改 factory.yml 中的设置[将用户会话存储](http://www.symfony-project.org/book/1_2/06-Inside-the-Controller-Layer)在数据库中：

```
all:
  storage:
    class: sfMySQLSessionStorage
    param:
      db_table:    session              # Name of the table storing the sessions
      database:    propel               # Name of the database connection to use
      # Optional parameters
      db_id_col:   sess_id              # Name of the column storing the session id
      db_data_col: sess_data            # Name of the column storing the session data
      db_time_col: sess_time            # Name of the column storing the session timestamp 
```

从给出的示例中，似乎表中的列仅限于几个预定义的列。这意味着无法存储 Symfony 未预料到的其他信息，例如 ip 地址。

是否可以扩展数据库架构以包含更多自定义列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-06T17:22:29.933

您可以像这样创建自己的会话类

```
class myPDOSessionStorage extends sfPDOSessionStorage {
    /**
    * Extending session write function
    *
    * @param string $id Session identifier  
    * @param mixed $data Session's data
    */
    public function sessionWrite($id, $data){
        /*
          Handle your specific data, e.g. :
        */
        $mySession = new MySession();
        $mySession->setIp($_SERVER['REMOTE_IP']);
        // connect with org. session
        $mySession->setSessionId($id);
        // Save extended session - you for sure need to add logic in finding existing one's
        $mySession->save();

        // IMPORTANT Call Parent function to update original session data
        parent::sessionWrite($id, $data);
    }
} 
```

在 factory.yml 中：

```
all:
  storage:
    class: myPDOSessionStorage
    db_table:    my_session # Name of the table storing the sessions
    database:    my_session # Database connection to use 
```

这是一个基本示例，因此您可以在此处找到更多信息：

*   [http://www.symfony-project.org/reference/1_4/en/05-Factories#chapter_05_storage](http://www.symfony-project.org/reference/1_4/en/05-Factories#chapter_05_storage)
*   [http://www.designdisclosure.com/2009/11/symfony-doctrine-database-session-storage/](http://www.designdisclosure.com/2009/11/symfony-doctrine-database-session-storage/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T16:24:43.183

不直接；*会话的结构非常有限，尽管您可以在*会话中存储相当多的数据。Symfony 只是将会话数据作为 blob 存储在数据库中。如果您确实需要，可以尝试修改 sfMySQLSessionStorage 类以将 $_SERVER['REMOTE_IP'] 包含在会话表中。

# language-agnostic - 是否需要使用目录分隔符常量？

> ID：625332
> 
> 赞同：39
> 
> 时间：2009-03-09T08:03:32.063
> 
> 标签：language-agnostic

我正在使用 PHP，但我*想*这个问题可能与语言无关。

在 PHP 中，PHP 定义了一个常量，称为`DIRECTORY_SEPARATOR`. 我在 Joomla 看到过这个

```
define('DS', DIRECTORY_SEPARATOR); 
```

我认为这看起来是个好主意，所以我将它合并到我的一些网站中。现在我问自己为什么。我只有在 Windows 和 OS X 上的经验，据我所知，Microsoft、Linux 和 Apple 都使用正斜杠作为目录分隔符。

不需要使用这个常量吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-08-11T21:16:15.210

就 PHP 而言，在构建路径时可能不需要它，但它对于从操作系统获得的任何东西都很重要。

从[http://alanhogan.com/tips/php/directory-separator-not-necessary](http://alanhogan.com/tips/php/directory-separator-not-necessary)：

> 在尝试编写跨平台、可移植的 PHP 代码时，我使用 PHP 的 DIRECTORY_SEPARATOR 常量来编写路径字符串，例如`"..".DIRECTORY_SEPARATOR."foo"`，因为在 Windows 上执行此操作的“正确”方式是`"..\foo"`在其他所有程序（Linux、UNIX、Mac OS X）上执行此操作会的`"../foo"`。
> 
> 好吧，正如[php.net](http://us2.php.net/manual/en/ref.filesystem.php#73954)上的 Christian指出的那样，Web Design Forums 的人也证实了这一点，这完全没有必要。只要您使用正斜杠“/”，就可以了。Windows 不介意，它最适合 *nix 操作系统。
> 
> （请注意，这对于诸如*系统*给您的路径之`DIRECTORY_SEPARATOR`类的事情仍然有用。感谢 Shadowfiend 指出这一点。）`explode`

 ** * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-09T08:06:13.180

例如，Mac OS Classic 使用“:”。有关详细信息，请参阅[维基百科](http://en.wikipedia.org/wiki/Path_(computing))。它也被认为是避免“[幻数](http://en.wikipedia.org/wiki/Magic_number_(programming)#Unnamed_numerical_constant)”或类似结构的好风格。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-09T08:07:35.750

Windows 实际上使用反斜杠作为目录分隔符，尽管某些具有 Windows 版本的环境会自动在正斜杠和反斜杠之间进行转换（我想到了 Python）。

# c++ - 如何限制 C++ 中依赖于实现的语言特性的影响？

> ID：625333
> 
> 赞同：7
> 
> 时间：2009-03-09T08:03:47.083
> 
> 标签：c++

以下是 Bjarne Stroustrup 的著作 The C++ Programming Language 的节选：

第 4.6 节：

> C++ 基本类型的某些方面，例如 int 的大小，是实现定义的（§C.2）。我指出了这些依赖关系，并经常建议避免它们或采取措施尽量减少它们的影响。为什么要打扰？在各种系统上编程或使用各种编译器的人非常关心，因为如果他们不这样做，他们将被迫浪费时间寻找和修复晦涩难懂的错误。声称他们不关心可移植性的人通常这样做是因为他们只使用一个单一的系统，并且觉得他们可以承受“语言是我的编译器实现的”的态度。这是一种狭隘和短视的观点。如果你的程序是成功的，它很可能会被移植，因此必须有人找到并修复与实现相关的特性相关的问题。此外，程序通常需要与同一系统的其他编译器一起编译，即使您喜欢的编译器的未来版本可能会做一些与当前版本不同的事情。在编写程序时，了解和限制实现依赖的影响要比事后试图解开混乱要容易得多。
> 
> 限制依赖于实现的语言特性的影响相对容易。

我的问题是：如何限制依赖于实现的语言特性的影响？请提及依赖于实现的语言特性，然后展示如何限制它们的影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T08:09:50.860

好吧，其中提到的可变大小是一个众所周知的问题，常见的解决方法是提供具有明确定义的大小的基本类型的 typedefed 版本（通常在 typedef 名称中宣传）。这是使用预处理器宏在不同平台上提供不同的代码可见性来完成的。例如：

```
#ifdef __WIN32__
typedef int int32;
typedef char char8;
//etc
#endif
#ifdef __MACOSX__
//different typedefs to produce same results
#endif 
```

其他问题通常也以相同的方式解决（即使用预处理器标记执行条件编译）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T08:43:41.247

几个想法：

*   不幸的是，您将不得不使用宏来避免某些特定于平台或特定于编译器的问题。您可以查看 Boost 库的标头，以发现它很容易变得很麻烦，例如查看文件：

    *   [升压/配置/编译器/gcc.hpp](http://www.boost.org/doc/libs/1_38_0/boost/config/compiler/gcc.hpp)
    *   [升压/配置/编译器/intel.hpp](http://www.boost.org/doc/libs/1_38_0/boost/config/compiler/intel.hpp)
    *   [升压/配置/平台/linux.hpp](http://www.boost.org/doc/libs/1_38_0/boost/config/platform/linux.hpp)
    *   等等
*   整数类型在不同平台之间往往很混乱，您必须定义自己的 typedef 或使用类似[Boost cstdint.hpp](http://www.boost.org/doc/libs/1_38_0/libs/integer/cstdint.htm)

*   如果您决定使用任何库，请检查该库是否在给定平台上受支持

*   使用具有良好支持和明确记录的平台支持的库（例如 Boost）

*   您可以通过严重依赖 Qt 之类的库来将自己从一些 C++ 实现特定问题中抽象出来，这些库在类型和算法方面提供了“替代方案”。他们还试图使 C++ 中的编码更加可移植。它有效吗？我不知道。

*   不是所有的事情都可以用宏来完成。您的构建系统必须能够检测平台和某些库的存在。许多人会建议`autotools`项目配置，另一方面我推荐`CMake`（相当不错的语言，不再`M4`）

*   `reinterpret_cast`如果您进行一些低级别的干预（即和~~朋友~~类似的事情（朋友在 C++ 上下文中是一个坏词）），字节顺序和对齐可能是一个问题。

*   为编译器添加很多警告标志，对于 gcc，我建议至少`-Wall -Wextra`. 但是还有更多，请参阅编译器的文档或这个[问题](https://stackoverflow.com/questions/399850/best-compiler-warning-level-for-c-c-compilers)。

*   您必须注意实现定义和实现相关的所有内容。如果你想要真相，只有真相，只有真相，那就去 ISO 标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T08:17:59.640

最明显的实现依赖是整数类型的大小。有很多方法可以处理这个问题。最明显的方法是使用 typedefs 创建各种大小的整数：

```
 typedef signed   short  int16_t;
 typedef unsigned short  uint16_t; 
```

这里的诀窍是选择一个约定并坚持下去。哪个约定是困难的部分：INT16、int16、int16_t、t_int16、Int16 等。C99 具有使用 int16_t 样式的 stdint.h 文件。如果您的编译器有此文件，请使用它。

同样，您应该对使用其他标准定义（例如 size_t、time_t 等）持迂腐态度。

另一个技巧是知道何时不使用这些 typedef。用于索引数组的循环控制变量应该只采用原始 int 类型，以便编译将为您的处理器生成最佳代码。for (int32_t i = 0; i < x; ++i) 可能会在 64 位处理器上生成大量不必要的代码，就像在 32 位处理器上使用 int16_t 一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T08:15:14.857

一个好的解决方案是使用必要的定义 typedeff'ed 类型的通用标题。

例如，包含 sys/types.h 是一种很好的处理方式，就像使用可移植库一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T09:02:13.480

有两种方法：

*   使用已知大小定义您自己的类型并使用它们而不是内置类型（例如 typedef int int32 #if-ed 用于各种平台）
*   使用不依赖于字体大小的技术

第一个非常流行，但是如果可能的话，第二个通常会产生更清晰的代码。这包括：

*   不要假设指针可以转换为 int
*   不要假设您知道各个类型的字节大小，请始终使用 sizeof 来检查它
*   将数据保存到文件或通过网络传输时，使用可在不断变化的数据大小中移植的技术（如保存/加载文本文件）

最近的一个例子是编写可以为 x86 和 x64 平台编译的代码。这里危险的部分是指针和 size_t 大小 - 准备好它可以是 4 或 8，具体取决于平台，当转换或差分指针时，永远不要转换为 int，而是使用 intptr_t 和类似的 typedef-ed 类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T08:23:53.667

避免依赖于特定数据大小的关键方法之一是将持久数据作为文本而不是二进制来读写。如果必须使用二进制数据，那么所有读/写操作必须集中在一些方法和方法中，比如这里已经描述的 typedef。

您可以做的第二件事是启用所有编译器警告。例如，在 g++ 中使用**-pedantic**标志会警告您许多潜在的可移植性问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T08:24:05.850

如果您担心可移植性，可以毫不费力地确定和处理诸如 int 大小之类的事情。许多 C++ 编译器还支持 C99 特性，如 int 类型：`int8_t`、`uint8_t`、`int16_t`、`uint32_t`等。如果你的编译器本身不支持它们，你总是可以包含`<cstdint>`or `<sys/types.h>`，它通常有那些`typedef`ed。`<limits.h>`对所有基本类型都有这些定义。

该标准仅保证类型的最小大小，您始终可以依赖：`sizeof(char) < sizeof(short) <= sizeof(int) <= sizeof(long)`. `char`必须至少为 8 位。`short`并且`int`必须至少为 16 位。`long`必须至少为 32 位。

可能由实现定义的其他内容包括 ABI 和名称修改方案（`export "C++"`具体的行为），但除非您使用多个编译器，否则这通常不是问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-19T15:38:44.950

以下也是 Bjarne Stroustrup 的书 The C++ Programming Language 的节选：

第 10.4.9 节：

> 对于不同编译单元中非本地对象的构造顺序，没有做出与实现无关的保证。例如：
> 
> ```
> // file1.c:
>     Table tbl1;
> // file2.c:
>     Table tbl2; 
> ```
> 
> *tbl1*是在 tbl2 之前构造*还是*相反，取决于实现。甚至不能保证在每个特定的实现中顺序都是固定的。动态链接，甚至是编译过程中的一个小改动，都可以改变顺序。销毁的顺序同样取决于实现。
> 
> 程序员可以通过实现通常用于本地静态对象的策略来确保正确的初始化：第一次切换。例如：
> 
> ```
> class Zlib {
>     static bool initialized;
>     static void initialize() { /* initialize */ initialized = true; }
> public:
>     // no constructor
> 
>     void f()
>     {
>         if (initialized == false) initialize();
>         // ...
>     }
>     // ...
> }; 
> ```
> 
> 如果有很多功能需要测试第一次切换，这可能会很乏味，但通常是可以管理的。这种技术依赖于这样一个事实，即没有构造函数的静态分配对象被初始化为*0*。真正困难的情况是第一个操作可能是时间关键的，因此测试的开销和可能的初始化可能很严重。在这种情况下，需要进一步的诡计（第 21.5.2 节）。
> 
> 简单对象的另一种方法是将其呈现为函数（第 9.4.1 节）：
> 
> ```
> int& obj() { static int x = 0; return x; } // initialized upon first use 
> ```
> 
> 首次切换无法处理所有可能的情况。例如，可以创建在构造过程中相互引用的对象。最好避免这样的例子。如果需要这些对象，则必须分阶段小心地构建它们。

# multithreading - boost线程中的虚假解除阻塞

> ID：625340
> 
> 赞同：10
> 
> 时间：2009-03-09T08:08:02.457
> 
> 标签：multithreading, boost, wait, conditional-statements

[我今天在Boost 线程文档](http://www.boost.org/doc/libs/1_38_0/doc/html/thread/synchronization.html#thread.synchronization.condvar_ref)中遇到了这个有趣的段落：

```
void wait(boost::unique_lock<boost::mutex>& lock) 
```

...

> 效果：原子调用 lock.unlock() 并阻塞当前线程。当调用 this->notify_one() 或 this->notify_all() 或**spuriously**时，线程将解除阻塞。当线程被解除阻塞时（无论出于何种原因），在调用等待返回之前调用 lock.lock() 重新获取锁。如果函数因异常退出，还可以通过调用 lock.lock() 重新获取锁。

所以我感兴趣的是“spuriously”这个词的含义。为什么线程会因为虚假原因而被解除阻塞？可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T08:14:43.830

[Anthony Williams 的这篇文章](http://www.justsoftwaresolutions.co.uk/threading/condition-variable-spurious-wakes.html)特别详细。

> 无法预测虚假尾流：从用户的角度来看，它们基本上是随机的。但是，当线程库无法可靠地确保等待线程不会错过通知时，它们通常会发生。由于错过的通知会使条件变量变得无用，线程库将线程从等待中唤醒，而不是冒险。

他还指出，您不应该使用`timed_wait`需要持续时间的重载，您通常应该使用带有谓词的版本

> 这是初学者的错误，并且可以通过一个简单的规则轻松克服：在等待条件变量时始终在循环中检查谓词。更隐蔽的错误来自 timed_wait()。

[Vladimir Prus 的这篇文章](http://vladimir_prus.blogspot.com/2005/07/spurious-wakeups.html)也很有趣。

> 但是为什么我们需要while循环，我们不能写：

```
if (!something_happened)
  c.wait(m); 
```

> 我们不能。杀手的原因是“等待”可以在没有任何“通知”调用的情况下返回。这称为虚假唤醒，POSIX 明确允许。本质上，从“等待”返回仅表示共享数据可能已更改，因此必须再次评估数据。
> 
> 好的，那为什么还没有修复呢？第一个原因是没有人愿意修复它。由于其他几个原因，非常希望在循环中包装对“等待”的调用。但是这些原因需要解释，而虚假唤醒是一把锤子，可以毫无疑问地适用于任何一年级学生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T08:14:04.330

[这篇博](http://vladimir_prus.blogspot.com/2005/07/spurious-wakeups.html)文给出了使用 Linux 的原因，即`futex`当信号传递到进程时系统调用返回。不幸的是，它没有解释任何其他内容（实际上是在要求更多信息）。

关于虚假唤醒的[维基百科条目](http://en.wikipedia.org/wiki/Spurious_wakeup)（这似乎是一个 posix 范围的概念，顺便说一句，不限于提升）可能你也感兴趣。

# c++ - 从备用键值输入创建映射

> ID：625353
> 
> 赞同：0
> 
> 时间：2009-03-09T08:15:51.940
> 
> 标签：c++, algorithm, data-structures, loops

我有一个看起来像这样的数据：

```
>day11:1:356617
ACTTCTGATTCTGACAGACTCAGGAAGAAACCAT
>day11:2:283282
CTCAGCCCGTAGCCCGTCGGTTCCGGAGTAAGTT
>day11:3:205058
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
>day11:4:202520
AGTTCGATCGGTAGCGGGAGCGGAGAGCGGACCC
>day11:5:107099
AGGCATTCAGGCAGCGAGAGCAGAGCAGCGTAGA
>day11:6:106715
CTCTTTGCCCCATCTACTGCGAGGATGAAGACCA 
```

我想要做的是创建一个地图，以“>”开头的行作为键，以 ACGT 作为值。

但是，我的这个构造不起作用？地图似乎未能如我预期的那样捕捉价值。

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <map>
int main() {

     ifstream myfile ("mydata.txt");

    map <string,string>FastaMap;

    cerr << "Read Fasta File to Map" << endl;

    if (myfile.is_open())
    {
        while (getline(myfile,line) )
        {
            stringstream ss(line);
            string Fasta;
            string Header = "";
            string Tag = "";

            ss >> Fasta; // read first column

            if ( Fasta[0] == '>') {
                 // get header only 
                 Header = Fasta.substr(1);
                 //cerr << Header << endl;
            }
            else {
                Tag = Fasta;
            }

            if (Header != "" || Tag != "") {
                FastaMap[Header] = Tag;
                //cout << "TAG: " << Tag << endl;
                //cout << "Head: " << Header << endl;
                // FastaMap.insert(make_pair(Header,Tag));
           }
        }
        myfile.close();
    }
    else  {
        cout << "Unable to open file";
    }

    // This doesn't print the second value, only prints the first

    for (map<string,string>::iterator it = FastaMap.begin(); it!=
            FastaMap.end(); it++) {
         cout << "Head: " << (*it).first << ", End: " << (*it).second << endl;
    }

} 
```

预期的输出是：

```
Head: day11:1:356617, End: ACTTCTGATTCTGACAGACTCAGGAAGAAACCAT
Head: day11:2:283282, End: CTCAGCCCGTAGCCCGTCGGTTCCGGAGTAAGTT
...etc... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T08:34:19.897

你在打扫，`Fasta`每个循环。你要做的是：`Header``Tag`

1.  在 while 之外（就在它之前）声明这些变量
2.  将行更改`if (Header != "" || Tag != "")`为使用`&&`而不是`||`（那里存在逻辑错误）
3.  将 Tag 和 Header 变量添加到地图时重置它们。

正确的代码如下：

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <map>
using namespace std;
int main() {
        string line;
        ifstream myfile ("test");

        map <string,string> FastaMap;

        cerr << "Read Fasta File to Map" << endl;

        if (myfile.is_open())
        {
                string Fasta;
                string Header = "";
                string Tag = "";
                while (getline(myfile,line) )
                {

                        stringstream ss(line);

                        ss >> Fasta; // read first column

                        if ( Fasta[0] == '>') {
                                // get header only
                                Header = Fasta.substr(1);
                                //cerr << Header << endl;
                        }
                        else {
                                Tag = Fasta;
                        }

                        if (Header != "" && Tag != "") {
                                FastaMap[Header] = Tag;
                                cout << "TAG: " << Tag << endl;
                                cout << "Head: " << Header << endl;
                                Header = "";
                                Tag = "";
                                // FastaMap.insert(make_pair(Header,Tag));
                        }
                }
                myfile.close();
        }
        else  {
                cout << "Unable to open file";
        }

        // This doesn't print the second value, only prints the first

        for (map<string,string>::iterator it = FastaMap.begin(); it!=
                     FastaMap.end(); it++) {
                cout << "Head: " << (*it).first << ", End: " << (*it).second << endl;
        }

} 
```

请注意，代码还有其他可能的增强功能，但现在可以使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:33:59.663

if (Header != "" || Tag != "") 中的错误应该是： if (Header != "" **&&** Tag != "")

更：

```
if (Header != "" && Tag != "") {
                    FastaMap[Header] = Tag;
                    Header = "";
                    Tag = "";
} 
```

# silverlight - 从 UserControl 抽象子类继承

> ID：625358
> 
> 赞同：2
> 
> 时间：2009-03-09T08:16:51.093
> 
> 标签：silverlight, inheritance, user-controls, expression-blend, auto-generate

我有一组需要具有一些类似属性的用户控件。因此，我定义了 UserControl 的抽象子类，它定义了这些属性，并更新了 .xaml.cs 和 .g.cs 文件以从这个基类继承。一切编译良好，运行良好。伟大的！但是.... .g.cs 文件已生成并将重新生成，那么我如何告诉 Blend 或 Visual Studio 继续从我的基类而不是 UserControl 继承？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T08:45:24.503

您需要稍微更改 XAML 以在 UserControl 声明前加上命名空间：

```
<local:MyBaseControl x:Class="MyNameSpace.MyControl"
    xmlns:local="clr-namespace:MyNameSpace"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Content -->
</local:MyBaseControl> 
```

其中 MyNameSpace 是您的命名空间（呃！），MyBaseControl 是您的基类，MyControl 是您从 MyBaseControl 继承的控件。x:Class 部分不需要在同一个命名空间中，我只是在示例中保持相同。

更多信息[在这里](http://geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx)和[这里](http://wildermuth.com/2008/08/21/Base_Classes_for_User_Controls)。

# c# - 使用 C# 以编程方式更新 MS Access 数据库中的链接表

> ID：625360
> 
> 赞同：4
> 
> 时间：2009-03-09T08:18:02.743
> 
> 标签：c#, .net, ms-access, ado.net, dao

我有两个 Access 2003 数据库（`fooDb`和`barDb`）。中有四个表`fooDb`链接到 中的表`barDb`。

两个问题：

*   如何更新表格内容（中的链接表格`fooDb`应与中的表格内容同步`barDb`）
*   如何将表重新链接到不同的`barDb`使用`ADO.NET`

我用谷歌搜索但没有得到任何有用的结果。我发现如何在 VB(6) 和 DAO 中实现这一点，但我需要 C# 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-12-06T16:10:38.897

这是我使用 C# 重新链接 DAO 表的解决方案。

我的应用程序使用一个中央 MS Access 数据库和 8 个链接的实际数据库。中央数据库本地存储到我的 C# 应用程序，但该应用程序允许 8 个数据数据库位于其他位置。启动时，我的 C# 应用程序根据 app.config 设置重新链接中央数据库中的 DAO 表。

顺便说一句，这个数据库结构是我的应用程序最初是我移植到 VB6 的 MS Access 应用程序的结果。我目前正在将我的应用程序转换为 C#。我本可以在 VB6 或 C# 中移除 MS Access，但它是一个非常易于使用的桌面数据库解决方案。

在中央数据库中，我创建了一个名为linkedtables 的表，其中包含三列TableName、LinkedTableName 和DatabaseName。

在 App 启动时，我调用此例程

```
 Common.RelinkDAOTables(Properties.Settings.Default.DRC_Data
                              , Properties.Settings.Default.DRC_LinkedTables
                              , "SELECT * FROM LinkedTables"); 
```

Default.DRC_Data - 中央访问数据库的当前文件夹 Default.DRC_LinkedTables - 8 个数据数据库的当前文件夹

这是在 C# 中实际重新链接 DAO 表的代码

```
 public static void RelinkDAOTables(string MDBfile, string filepath, string sql)
    {
        DataTable linkedTables = TableFromMDB(MDBfile, sql);

        dao.DBEngine DBE = new dao.DBEngine();
        dao.Database DB = DBE.OpenDatabase(MDBfile, false, false, "");
        foreach (DataRow row in linkedTables.Rows)
        {
            dao.TableDef table = DB.TableDefs[row["Name"].ToString()];
            table.Connect = string.Format(";DATABASE={0}{1} ;TABLE={2}", filepath, row["database"], row["LinkedName"]);
            table.RefreshLink();
        }

    } 
```

为从访问数据库获取数据并将其作为 DataTable 返回而编写的附加代码

```
 public static DataTable TableFromOleDB(string Connectstring, string Sql)
    {
        try
        {
            OleDbConnection conn = new OleDbConnection(Connectstring);
            conn.Open();
            OleDbCommand cmd = new OleDbCommand(Sql, conn);
            OleDbDataAdapter adapter = new OleDbDataAdapter(cmd);
            DataTable table = new DataTable();
            adapter.Fill(table);

            return table;
        }
        catch (OleDbException)
        {
            return null;
        }
    }
    public static DataTable TableFromMDB(string MDBfile, string Sql)
    {
        return TableFromOleDB(string.Format(sConnectionString, MDBfile), Sql);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T00:04:58.583

如果您使用 C# 进行编码，则不涉及 Access，仅涉及 Jet。因此，您可以使用任何您想访问数据的方法，然后编写更新代码。

我已经在 Access 中多次编写过这种东西，我对每个表的处理方法是：

1.  运行从 fooDB 中删除的查询，该查询在 barDB 中不再存在。

2.  运行一个查询，该查询插入到 barDB 中的 fooDB 记录中，但 fooDB 中尚不存在。

3.  我总是使用编写动态 SQL 的代码来使用来自 barDB 的数据更新 fooDB 表。

第三个是硬的。我遍历 DBA 中的字段集合并动态编写 SQL，如下所示：

```
UPDATE table2 INNER JOIN table1 ON table2.ID = table1.ID
SET table2.field1=table1.field1
WHERE (table2.field1 & "") <> (table1.field1 & "") 
```

对于数字字段，您必须使用可用的 SQL 方言函数将 Null 转换为零。运行 Jet SQL，我当然会使用 Nz()，但这不能通过 ODBC 工作。不过，不确定它是否适用于 OLEDB。

无论如何，关键是要发出一堆逐列的 SQL 更新，而不是尝试逐行进行，这样效率会低得多。

# wix - 如何提供 UI 以允许用户使用 WiX 指定安装路径？

> ID：625365
> 
> 赞同：2
> 
> 时间：2009-03-09T08:20:14.783
> 
> 标签：wix, windows-installer

我需要有关上述问题的帮助。另外，如何确保为所有使用机器的用户安装应用程序？我以前没有真正使用过WiX。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T08:30:24.743

你将不得不阅读[教程](http://www.tramontana.co.hu/wix/)。只是没有办法解决它。它应该回答你所有的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T09:04:16.767

好的，我得到了解决方案。我添加了 WixUIExtension dll 作为参考，然后在项目结束标记之前使用了以下内容：

```
<Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" ></Property>
<UIRef Id="WixUI_InstallDir"/> 
```

它完美地工作。

# postgresql - 学习 PostgreSQL 存储过程的最佳方法？

> ID：625367
> 
> 赞同：31
> 
> 时间：2009-03-09T08:20:42.147
> 
> 标签：postgresql, stored-procedures

是否有一个很好的教程或类似的东西来学习如何编写存储过程（对于 PostgreSQL 数据库）。在编写存储过程时，我绝对是个新手，所以解释得越清楚越简单越好……

提前致谢...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-09T15:10:17.620

你几乎拥有它，但最好从这里开始[plpgsql](http://www.postgresql.org/docs/current/static/plpgsql.html)

有些人会指出这`PL/pgSQL`不是为 PostgreSQL 编写存储过程的唯一方法，他们是正确的（这是 Postgres 的优点之一），但另一方面`PL/pgSQL`很好，而且相对容易上手。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T08:23:24.463

请注意，显然，这是一个很好的起点：[sql-createfunction](http://www.postgresql.org/docs/current/static/sql-createfunction.html)

# sql-server - 每种对象的表，或具有多列的单个表：哪个最快？

> ID：625368
> 
> 赞同：1
> 
> 时间：2009-03-09T08:21:12.817
> 
> 标签：sql-server, database-design

我必须在数据库上存储四种对象。这些对象具有相同的属性：

*   名称 (varchar2)。
*   说明 (varchar2)。
*   文件（二进制 blob）。

也许我可以使用一个表来存储这些对象，添加一个列来识别对象的种类，但我需要存储很多对象（> 1,000,000 或更多）。

我的问题是哪种方案更能提高性能？存储所有对象的表或每种对象的表。

我将使用 SQL Server 2005 或 2008。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T08:33:15.843

纯卷并不是将相似对象拆分为不同表的好理由，还有其他更好的方法来提高性能、索引、表分区。

向表中添加类型列，维护和查询将更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T08:28:41.113

如果您只有四种不同类型的对象并且它们的大小和数量都大致相同，那么打破桌子不会做太多。您可以将表扫描的成本降低四倍，但无论如何您都不想进行全扫描。你会经过一个索引，然后就没有关系了。

如果这四种类型在大小、数量或访问频率上完全不同，则将它们分开可能会使较小、较少的人受益。更频繁地查询的。但这需要很大的偏差才能在使用索引时对性能产生影响。

如果您确实决定拆分表，则跨多种类型进行查询或稍后添加新类型会变得更加困难。

另一方面，如果您从不需要跨多个类型进行查询（并且名称在所有对象类型中不是唯一的），则无需将它们保存在单个表中。

我注意到您没有“类型”列。如果您需要区分这四种类型，您可能应该拥有一个。或者这可以通过查看名称来完成吗？

名称是主键吗？表大小对主键查找的性能影响很小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T10:47:16.473

这些对象是真正等同的还是只是巧合相似？通过将它们混为一谈，您可能会做出不合理的假设。稍后，当您决定其中一种对象类型需要其他对象不需要的附加属性时，您可能最终会遇到相当大的重构任务或最终会得到稀疏填充的行。

还要怀疑任何称为“描述”的字段，这是一种难闻的气味，表明建模不足。它往往被用作缺失属性的全部捕获。我不提倡建模，但很多有用的结构可以这样被埋没。例如，我曾经不得不向产品数据库添加一些功能，该数据库基于“区域批准”进行了一些处理。但是没有领地认可属性？？？在与用户交谈后，很明显他们使用他们设计的特殊代码系统将领土数据存储在描述字段中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T08:36:30.627

为不同类型的对象创建一个具有名称和 ID 的主查找表。然后使用 id 而不是 name 创建依赖表。您可以拥有一个表并根据对象类型 (id) 对其进行水平分区。

使用整数 id 而不是名称的好处是您可以在其上创建索引，这将大大加快您的查询速度（特别是您提到的表大小）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-09T08:48:16.103

你的问题是关于性能，而不是方便。因此，最好为每个单独的表；这减少了每个索引中的记录数，您实际上是通过选择正确的表自己进行过滤。

# perl - 如何在 Perl 中修改接收到的套接字消息？

> ID：625376
> 
> 赞同：2
> 
> 时间：2009-03-09T08:23:21.593
> 
> 标签：perl, sockets

我正在编写一个 Perl 程序，它从两个套接字发送和接收消息，并充当开关。我必须修改从一个套接字接收到的消息，将 3 个字节添加到数据中，最后将修改后的消息发送到另一个套接字。我采用 select()...sysread()...syswrite() 机制来轮询套接字之间的消息。接收到的消息在修改期间存储在 $buffer 中。

现在我可以使用以下方式获取收到的消息：

```
my $hexmsg = unpack("H*", $buffer);
my @msg = ( $hexmsg =~ m/../g ); 
```

然后我可以向@msg 插入 3 个字节。但是，我不知道如何将@msg 中的消息打包成一个标量（例如$buffer）并通过syswrite() 将其发送到另一个套接字。有谁能够帮助我？先感谢您！

顺便说一句，$buffer 中的消息是二进制文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T10:36:47.530

是的，$buffer 中的消息是二进制的（如果我猜对了你的意思）。如果您将其解压缩到 @msg 的唯一原因是插入字节，请不要这样做。改用[substr](http://perldoc.perl.org/functions/substr.html)，只需写出更改的 $buffer。例如：

```
substr( $buffer, 0, 0, "\x01\x02\x03" ); # insert 3 bytes at beginning. 
```

如果您正在使用@msg 做其他事情，您可以继续使用它以及在写出之前执行 substr 插入，或者您可以使用 substr 或 pack 或 split 或 vec 或正则表达式来解析出您需要的部分。您需要描述您正在做什么以获得更具体的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:28:45.620

如果您曾经`unpack`从 中获取数据`$buffer`，您是否尝试过[`pack`](http://perldoc.perl.org/functions/pack.html)将数据放回那里？

# excel - 如何将具有中文名称的文件夹名称列表获取到Excel工作表中？

> ID：625379
> 
> 赞同：2
> 
> 时间：2009-03-09T08:23:29.237
> 
> 标签：excel, unicode, cjk

我知道我可以在命令行中列出文件夹并将其复制到电子表格中，但如果文件夹名称是中文，则名称显示不正确。我猜命令提示符不支持Unicode？我使用的是英文版 Windows XP 操作系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T08:26:11.213

不通过控制台窗口直接重定向到文件怎么样？

就像是：

```
dir /b path/to/china > folders.txt 
```

然后在 Excel 中打开生成的文本文件？这*应该*会为您提供一个文件名采用 Windows 文件名编码的文本文件。

# database-design - 可视化映射 mysql 数据库模式

> ID：625387
> 
> 赞同：9
> 
> 时间：2009-03-09T08:26:26.953
> 
> 标签：database-design

我需要直观地了解开源 erp 软件（Dolibarr）的数据库模式，因为它找到了一个基于 java 的工具 dbschemaviewer，它利用 eclipse 和 GEF 来映射现有数据库。我让它在一夜之间完成这个过程但没有结果

我需要一些其他软件，可以直观地映射现有数据库模式并显示连接，并且一旦我研究了它的连接，我也可以对其进行编辑

我目前正在使用已安装 erp 软件的 wampserver 2

我可以用来映射架构的任何解决方案、想法或软件？

请帮忙，

蕾妮

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T08:31:57.267

你可以试试 MySQL 的[MySQLWorkbench](http://dev.mysql.com/workbench/)工具。它只是一段时间的 Windows，但现在有适用于 Linux 和 MacOS 的 Alpha 版本。我没有使用过这些 Alpha 版本，所以我不知道它们的稳定性如何。

有[免费版和付费版](http://dev.mysql.com/workbench/?page_id=11)，但免费版允许您[从 SQL 脚本创建 ERD](http://dev.mysql.com/doc/workbench/en/wb-reverse-engineer-create-script.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T12:40:46.390

好的，我已经查看了一些软件和 java 扩展，mysql Workbench 似乎是一个不错的程序，并且按照 dave 和 trailblazer 的建议，它具有易于使用的界面，但如果表格数量较多，它会以非常复杂的布局显示它们理解和查看很复杂，另一件事是它不直接连接到您的数据库，但您需要生成数据库的 .sql 文件，然后将其导入逆向工程，然后您可以创建该数据库的图表视图

我发现了另一个在[这个 SO 帖子](https://stackoverflow.com/questions/433071/good-tool-to-visualise-database-schema)中建议的程序， 它叫做[SchemaSpy](http://schemaspy.sourceforge.net/)，它是开源的，它分析数据库中模式的元数据并生成它的可视化表示。

它使用命令行操作，并使用[Graphviz](http://www.graphviz.org/About.php)创建表，但是有一个名为[SchemaSpyGUI](http://www.joachim-uhl.de/projekte/schemaspygui/#needed)的 gui，它非常容易安装，因为您必须安装 Graphviz 并解压缩 graphviz 的 bin 文件夹中的其他程序的内容。你还需要[mysqlconnector/J](http://dev.mysql.com/downloads/#drivers-connectors)，这是它的 安装[过程](http://www.stardeveloper.com/articles/display.html?article=2003090201&page=4)

它非常全面地显示表、关系（可视模式）、实用程序表、约束、异常和列，并以比工作台更清晰的格式显示表，尽管它只是使用哪种软件进行可视化的偏好问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T08:35:00.020

我使用[DBVisualizer](http://www.minq.se/products/dbvis/ "DBVisualizer")以图形方式查看我的 Oracle 和 Sybase 数据库。它的整体性能非常好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T08:34:36.183

您可以尝试使用 Microsoft Visio 对数据库进行[逆向工程](http://maniish.wordpress.com/2007/11/24/reverse-engineer-mysql-in-visio-2007/)并生成数据库模型图。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T09:24:37.093

我会接受@dave Webb 的建议来使用 MySQL Workbench。您可以从 SQL 管理员创建 SQL 脚本并备份数据库。它将生成 .sql 文件。可以使用 MySQL Workbench 打开此 sql 文件以对数据库进行逆向工程。

或者，您可以查看[DB Design 4（fabFORCE.net 的 OSS 项目）](http://www.fabforce.net/dbdesigner4/downloads.php)

您还可以尝试使用Oracle 的[SQL Developer](http://htmldb.oracle.com/pls/otn/f?p=42626:16:1920771376273782)来连接和查看数据库架构和设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T09:27:57.460

看看这个：[http ://mkweb.bcgsc.ca/schemaball/?about](http://mkweb.bcgsc.ca/schemaball/?about)

另请查看另一个 SO 讨论：[可视化数据库模式的好工具？](https://stackoverflow.com/questions/433071/good-tool-to-visualise-database-schema)

# jsf - jsf 的日期+时间选择器

> ID：625398
> 
> 赞同：5
> 
> 时间：2009-03-09T08:30:03.183
> 
> 标签：jsf, date, time, components, picker

是否有任何现成的 JSF 组件允许选择事件的日期 + 时间？我知道的所有组件都只允许日期。手动添加时间很繁琐。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T08:39:04.473

[RichFaces 日历](http://livedemo.exadel.com/richfaces-demo/richfaces/calendar.jsf)组件允许您选择日期和时间。

你可以[在这里](http://livedemo.exadel.com/richfaces-demo/richfaces/calendar.jsf)测试它。选择日期后，您可以选择时间。是你要找的吗？

# php - 如何在php中获取视频和pdf文件的缩略图快照

> ID：625399
> 
> 赞同：7
> 
> 时间：2009-03-09T08:30:22.123
> 
> 标签：php, video-capture

谁能帮我看看如何将视频和 pdf 文件显示为缩略图？谢谢..............

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T08:39:10.277

对于 PDF，您可以使用 Imagick。

[它是如何完成的在这里非常详细](http://valokuva.org/?p=7=1)

对于视频快照，您可以使用[FFMPEG](http://www.ffmpeg.org/)。这是一个示例代码。

```
// this will create many images
$thumb = exec("ffmpeg -i video.mpg image%d.jpg"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T08:53:40.880

使用[ImageMagick 的 PHP](http://www.php.net/imagick)类。支持[视频和PDF。](http://www.imagemagick.org/script/formats.php)

# bash - 如何将已经运行的进程置于 nohup 下？

> ID：625409
> 
> 赞同：1035
> 
> 时间：2009-03-09T08:33:37.543
> 
> 标签：bash, shell, job-scheduling, nohup, interruption

我有一个已经运行了很长时间并且不想结束它的进程。

如何将其置于 nohup 下（即，即使我关闭终端，如何使其继续运行？）

* * *

## 回答 #1

> 赞同：1477
> 
> 时间：2009-03-09T08:41:58.320

使用 bash 的[Job Control](http://web.mit.edu/gnu/doc/html/features_5.html)将进程发送到后台：

1.  `Ctrl`+`Z`停止（暂停）程序并返回 shell。
2.  `bg`在后台运行它。
3.  `disown -h [job-spec]`其中 [job-spec] 是作业编号（例如`%1`第一个正在运行的作业；使用命令查找您的编号`jobs`），以便在终端关闭时不会终止作业。

* * *

## 回答 #2

> 赞同：209
> 
> 时间：2012-04-23T08:01:00.143

假设由于某种原因`Ctrl`+`Z`也不起作用，转到另一个终端，找到进程 ID（使用`ps`）并运行：

```
kill -SIGSTOP PID 
kill -SIGCONT PID 
```

`SIGSTOP`将暂停进程并`SIGCONT`在后台恢复进程。所以现在，关闭你的两个终端不会停止你的进程。

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2009-03-09T08:38:41.417

将正在运行的作业与 shell 分开的命令（= 使其成为 nohup）是`disown`一个基本的 shell 命令。

从 bash 手册页（man bash）：

> 拒绝 [-ar] [-h] [jobspec ...]
> 
> 如果没有选项，每个作业规范都会从活动作业表中删除。如果给出 -h 选项，则不会从表中删除每个作业规范，但会进行标记，以便在 shell 接收到 SIGHUP 时不会将 SIGHUP 发送到作业。如果不存在作业规范，并且既没有提供 -a 也没有提供 -r 选项，则使用当前作业。如果没有提供作业规范，-a 选项表示删除或标记所有作业；不带 jobspec 参数的 -r 选项将操作限制为正在运行的作业。除非作业规范未指定有效作业，否则返回值为 0。

这意味着，一个简单的

```
disown -a 
```

将从作业表中删除所有作业并使其成为 nohup

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2009-11-19T15:48:01.557

上面这些都是很好的答案，我只是想澄清一下：

你不能`disown`是 pid 或进程，你不能`disown`是工作，这是一个重要的区别。

作业是附加到外壳的进程的概念，因此您必须将作业扔到后台（而不是挂起它），然后再拒绝它。

问题：

```
%  jobs
[1]  running java 
[2]  suspended vi
%  disown %1 
```

有关 Unix 作业控制的更详细讨论，请参见[http://www.quantprinciple.com/invest/index.php/docs/tipsandtricks/unix/jobcontrol/](http://www.quantprinciple.com/invest/index.php/docs/tipsandtricks/unix/jobcontrol/) 。

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2013-03-16T23:49:15.940

不幸`disown`的是，它特定于 bash，并非在所有 shell 中都可用。

某些风格的 Unix（例如 AIX 和 Solaris）在`nohup`命令本身上有一个选项，可以应用于正在运行的进程：

```
nohup -p pid 
```

见[http://en.wikipedia.org/wiki/Nohup](http://en.wikipedia.org/wiki/Nohup)

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2014-10-10T09:35:14.927

Node 的回答真的很棒，但它留下了一个问题，即如何重定向 stdout 和 stderr。我在[Unix & Linux](https://unix.stackexchange.com/questions/31824/how-to-attach-terminal-to-detached-process/31830#31830)上找到了一个解决方案，但它也不完整。我想合并这两个解决方案。这里是：

在我的测试中，我制作了一个名为 loop.sh 的小型 bash 脚本，它在无限循环中打印自己的 pid，并带有一分钟的睡眠。

```
$./loop.sh 
```

现在以某种方式获取此进程的 PID。通常`ps -C loop.sh`已经足够好了，但它是在我的情况下打印的。

现在我们可以切换到另一个终端（或按 ^Z 并在同一个终端中）。现在`gdb`应该附加到这个过程中。

```
$ gdb -p <PID> 
```

这将停止脚本（如果正在运行）。可以通过 来检查其状态`ps -f <PID>`，其中`STAT`字段为 'T+'（或在 ^Z 'T' 的情况下），这意味着 (man ps(1))

```
 T Stopped, either by a job control signal or because it is being traced
    + is in the foreground process group

(gdb) call close(1)
$1 = 0 
```

Close(1) 成功时返回零。

```
(gdb) call open("loop.out", 01102, 0600)
$6 = 1 
```

如果成功，Open(1) 返回新的文件描述符。

这个开等于`open(path, O_TRUNC|O_CREAT|O_RDWR, S_IRUSR|S_IWUSR)`。而不是`O_RDWR` `O_WRONLY`可以应用，但`/usr/sbin/lsof`对所有 std* 文件处理程序（列）都说 'u' `FD`，即`O_RDWR`.

我检查了 /usr/include/bits/fcntl.h 头文件中的值。

可以使用 来打开输出文件`O_APPEND`，就像这样做一样，但由于可能存在 NFS 问题，因此`nohup`不建议这样做。`man open(2)`

如果我们得到 -1 作为返回值，则`call perror("")`打印错误消息。如果我们需要 errno，请使用`p errno`gdb 命令。

现在我们可以检查新重定向的文件。`/usr/sbin/lsof -p <PID>`印刷：

```
loop.sh <PID> truey    1u   REG   0,26        0 15008411 /home/truey/loop.out 
```

如果我们愿意，我们可以将 stderr 重定向到另一个文件，如果我们想使用`call close(2)`并`call open(...)`再次使用不同的文件名。

`bash`现在必须释放附件，我们可以退出`gdb`：

```
(gdb) detach
Detaching from program: /bin/bash, process <PID>
(gdb) q 
```

如果脚本被`gdb`其他终端停止，它会继续运行。我们可以切换回loop.sh的终端。现在它不会向屏幕写入任何内容，而是运行并写入文件。我们必须把它放到后台。所以按`^Z`。

```
^Z
[1]+  Stopped                 ./loop.sh 
```

`^Z`（现在我们处于与刚开始按下时相同的状态。）

现在我们可以检查作业的状态：

```
$ ps -f 24522
UID        PID  PPID  C STIME TTY      STAT   TIME CMD
<UID>    <PID><PPID>  0 11:16 pts/36   S      0:00 /bin/bash ./loop.sh
$ jobs
[1]+  Stopped                 ./loop.sh 
```

所以进程应该在后台运行并与终端分离。`jobs`方括号中的命令输出中的数字标识 内的作业`bash`。我们可以在以下内置`bash`命令中使用在作业编号前应用“%”符号：

```
$ bg %1
[1]+ ./loop.sh &
$ disown -h %1
$ ps -f <PID>
UID        PID  PPID  C STIME TTY      STAT   TIME CMD
<UID>    <PID><PPID>  0 11:16 pts/36   S      0:00 /bin/bash ./loop.sh 
```

现在我们可以退出调用 bash。该进程继续在后台运行。如果我们退出它的 PPID 变为 1（init(1) 进程）并且控制终端变得未知。

```
$ ps -f <PID>
UID        PID  PPID  C STIME TTY      STAT   TIME CMD
<UID>    <PID>     1  0 11:16 ?        S      0:00 /bin/bash ./loop.sh
$ /usr/bin/lsof -p <PID>
...
loop.sh <PID> truey    0u   CHR 136,36                38 /dev/pts/36 (deleted)
loop.sh <PID> truey    1u   REG   0,26     1127 15008411 /home/truey/loop.out
loop.sh <PID> truey    2u   CHR 136,36                38 /dev/pts/36 (deleted) 
```

**评论**

gdb 的东西可以自动创建一个包含命令和运行的文件（例如 loop.gdb）`gdb -q -x loop.gdb -p <PID>`。我的 loop.gdb 看起来像这样：

```
call close(1)
call open("loop.out", 01102, 0600)
# call close(2)
# call open("loop.err", 01102, 0600)
detach
quit 
```

或者可以使用以下一种衬垫代替：

```
gdb -q -ex 'call close(1)' -ex 'call open("loop.out", 01102, 0600)' -ex detach -ex quit -p <PID> 
```

我希望这是对解决方案的相当完整的描述。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2020-08-26T18:18:41.070

简单和最简单的步骤

1.  `Ctrl + Z`---------->*暂停进程*
2.  `bg` -------------->*恢复并运行后台*
3.  `disown %1`------------->*仅当您需要从终端分离时才需要*

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-09-27T06:48:57.817

将运行进程发送到 nohup ( [http://en.wikipedia.org/wiki/Nohup](http://en.wikipedia.org/wiki/Nohup) )

`nohup -p pid`，它对我不起作用

然后我尝试了以下命令，它工作得很好

1.  运行一些命令，比如说`/usr/bin/python /vol/scripts/python_scripts/retention_all_properties.py 1`。

2.  `Ctrl`+`Z`停止（暂停）程序并返回 shell。

3.  `bg`在后台运行它。

4.  `disown -h`以便在终端关闭时不会终止该进程。

5.  键入`exit`以退出 shell，因为现在您可以开始了，因为该操作将在其自己的进程中在后台运行，因此它不依赖于 shell。

这个过程相当于运行`nohup SOMECOMMAND`。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-03-24T17:06:33.297

1.  `ctrl`+ `z` - 这将暂停工作（不会取消！）
2.  `bg`- 这会将作业置于后台并在运行过程中返回
3.  `disown -a`- 这将切断所有带有作业的附件（因此您可以关闭终端，它仍然会运行）

这些简单的步骤将允许您在保持进程运行的同时关闭终端。

它不会戴上`nohup`（根据我对您问题的理解，您在这里不需要它）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-03-03T16:16:52.543

在我的 AIX 系统上，我尝试过

```
nohup -p  processid> 
```

这运作良好。即使在关闭终端窗口后，它也会继续运行我的进程。我们将 ksh 作为默认 shell，因此`bg`and`disown`命令不起作用。

# c++ - 你可以在 C++ 中设置调用堆栈的大小吗？(vs2008)

> ID：625416
> 
> 赞同：1
> 
> 时间：2009-03-09T08:35:57.193
> 
> 标签：c++, callstack

我正在使用分配相对较大的本地数组的示例代码。（准确地说是 32768）当我尝试相同的操作时，我得到的行为似乎是堆栈溢出。现在我想知道我的示例是否可能将堆栈设置为比我的应用程序更大。这可能吗？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T08:37:36.100

使用 Microsoft 编译器，您可以使用[/F](https://docs.microsoft.com/en-us/cpp/build/reference/f-set-stack-size?view=msvc-160)设置堆栈大小，但似乎您应该只在堆上分配对象。您应该有一个理由将其分配在堆栈而不是堆上。

编辑：[这个页面](http://www.cs.nyu.edu/exact/core/doc/stackOverflow.txt)提供了一个很好的跨平台细分，尽管它可能已经过时了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T08:57:46.223

您可以使用 /F 编译器标志设置默认堆栈大小，或将其指定为[CreateThread](http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx)函数的第二个参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T08:39:21.243

与其弄乱堆栈大小，不如简单地使用 std::vector 甚至自己动态分配一个数组？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-14T19:29:44.873

您可以为这项工作创建一个新线程。创建线程的时候一般可以指定栈的大小，当然用vs2008的`CreateThread()`函数

# wpf - 带有滚动条的 WPF 内的 VB6 ActiveX 控件

> ID：625418
> 
> 赞同：1
> 
> 时间：2009-03-09T08:37:01.733
> 
> 标签：wpf, vb6, activex

我有一些旧版 VB6，我托管在我的 WPF 应用程序中的 ActiveX 控件中。

尽管将控件放在 DockPanel 内部，它位于 ScrollViewer 内部，但 VB6 显示在两者的边界之外，位于应用程序的其余部分之上。

有谁知道我怎样才能将 VB6 保留在 ScrollViewer 中而不会溢出到应用程序的其余部分？

ScrollViewer - 展开以填充一个区域

有一个子元素...

DockPanel - 固定为 VB6 窗体的高度和宽度

有一个子元素...

VB6

任何帮助或指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T08:57:49.060

我不认为你能做到这一点，ActiveX 控件只会位于你包装它的任何 XAML 之上。作为一种解决方法，你可以尝试在 WinForms 中创建一个包含 ActiveX 控件并处理滚动的控件，然后将其嵌入 WPF 应用程序中。这有点hacky，如果您需要调整大小可能会很痛苦，但它应该可以工作:-)

# java - 将大量小文件读入内存的最快方法是什么？

> ID：625420
> 
> 赞同：21
> 
> 时间：2009-03-09T08:37:28.377
> 
> 标签：java, performance, file, types, io

我需要在每个服务器启动时读取约 50 个文件，并将每个文本文件的表示形式放入内存中。每个文本文件都有自己的字符串（字符串持有者最好使用哪种类型？）。

将文件读入内存的最快方法是什么，保存文本以便我可以在内存中操作它（主要是搜索和替换）的最佳数据结构/类型是什么？

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-09T11:00:58.407

内存映射文件将是最快的......像这样：

```
 final File             file;
    final FileChannel      channel;
    final MappedByteBuffer buffer;

    file    = new File(fileName);
    fin     = new FileInputStream(file);
    channel = fin.getChannel();
    buffer  = channel.map(MapMode.READ_ONLY, 0, file.length()); 
```

然后继续从字节缓冲区中读取。

这将比`FileInputStream`或快得多`FileReader`。

编辑：

经过一番调查，事实证明，根据您的操作系统，您最好使用新的`BufferedInputStream(new FileInputStream(file))`。但是，一次将整个内容全部读入 char[] 文件的大小听起来像是最糟糕的方式。

所以`BufferedInputStream`应该在所有平台上提供大致一致的性能，而内存映射文件可能会慢或快，具体取决于底层操作系统。与对性能至关重要的所有内容一样，您应该测试您的代码并查看最有效的方法。

编辑：

好的，这里有一些测试（第一个测试做了两次以将文件放入磁盘缓存）。

我在 rt.jar 类文件上运行它，解压到硬盘，这是在 Windows 7 beta x64 下。即 16784 个文件，总共 94,706,637 个字节。

首先结果...

（记住第一个重复获取磁盘缓存设置）

*   阵列测试

    *   时间 = 83016
    *   字节 = 118641472
*   阵列测试

    *   时间 = 46570
    *   字节 = 118641472
*   DataInputByteAtATime

    *   时间 = 74735
    *   字节 = 118641472
*   DataInputReadFully

    *   时间 = 8953
    *   字节 = 118641472
*   内存映射

    *   时间 = 2320
    *   字节 = 118641472

这是代码...

```
import java.io.BufferedInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.channels.FileChannel.MapMode;
import java.util.HashSet;
import java.util.Set;

public class Main
{
    public static void main(final String[] argv)
    {
        ArrayTest.main(argv);
        ArrayTest.main(argv);
        DataInputByteAtATime.main(argv);
        DataInputReadFully.main(argv);
        MemoryMapped.main(argv);
    }
}

abstract class Test
{
    public final void run(final File root)
    {
        final Set<File> files;
        final long      size;
        final long      start;
        final long      end;
        final long      total;

        files = new HashSet<File>();
        getFiles(root, files);

        start = System.currentTimeMillis();

        size = readFiles(files);

        end = System.currentTimeMillis();
        total = end - start;

        System.out.println(getClass().getName());
        System.out.println("time  = " + total);
        System.out.println("bytes = " + size);
    }

    private void getFiles(final File      dir,
                          final Set<File> files)
    {
        final File[] childeren;

        childeren = dir.listFiles();

        for(final File child : childeren)
        {
            if(child.isFile())
            {
                files.add(child);
            }
            else
            {
                getFiles(child, files);
            }
        }
    }

    private long readFiles(final Set<File> files)
    {
        long size;

        size = 0;

        for(final File file : files)
        {
            size += readFile(file);
        }

        return (size);
    }

    protected abstract long readFile(File file);
}

class ArrayTest
    extends Test
{
    public static void main(final String[] argv)
    {
        final Test test;

        test = new ArrayTest();
        test.run(new File(argv[0]));
    }

    protected long readFile(final File file)
    {
        InputStream stream;

        stream = null;

        try
        {
            final byte[] data;
            int          soFar;
            int          sum;

            stream = new BufferedInputStream(new FileInputStream(file));
            data   = new byte[(int)file.length()];
            soFar  = 0;

            do
            {
                soFar += stream.read(data, soFar, data.length - soFar);
            }
            while(soFar != data.length);

            sum = 0;

            for(final byte b : data)
            {
                sum += b;
            }

            return (sum);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(stream != null)
            {
                try
                {
                    stream.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }

        return (0);
    }
}

class DataInputByteAtATime
    extends Test
{
    public static void main(final String[] argv)
    {
        final Test test;

        test = new DataInputByteAtATime();
        test.run(new File(argv[0]));
    }

    protected long readFile(final File file)
    {
        DataInputStream stream;

        stream = null;

        try
        {
            final int fileSize;
            int       sum;

            stream   = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            fileSize = (int)file.length();
            sum      = 0;

            for(int i = 0; i < fileSize; i++)
            {
                sum += stream.readByte();
            }

            return (sum);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(stream != null)
            {
                try
                {
                    stream.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }

        return (0);
    }
}

class DataInputReadFully
    extends Test
{
    public static void main(final String[] argv)
    {
        final Test test;

        test = new DataInputReadFully();
        test.run(new File(argv[0]));
    }

    protected long readFile(final File file)
    {
        DataInputStream stream;

        stream = null;

        try
        {
            final byte[] data;
            int          sum;

            stream = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            data   = new byte[(int)file.length()];
            stream.readFully(data);

            sum = 0;

            for(final byte b : data)
            {
                sum += b;
            }

            return (sum);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(stream != null)
            {
                try
                {
                    stream.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }

        return (0);
    }
}

class DataInputReadInChunks
    extends Test
{
    public static void main(final String[] argv)
    {
        final Test test;

        test = new DataInputReadInChunks();
        test.run(new File(argv[0]));
    }

    protected long readFile(final File file)
    {
        DataInputStream stream;

        stream = null;

        try
        {
            final byte[] data;
            int          size;
            final int    fileSize;
            int          sum;

            stream   = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            fileSize = (int)file.length();
            data     = new byte[512];
            size     = 0;
            sum      = 0;

            do
            {
                size += stream.read(data);

                sum = 0;

                for(int i = 0; i < size; i++)
                {
                    sum += data[i];
                }
            }
            while(size != fileSize);

            return (sum);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(stream != null)
            {
                try
                {
                    stream.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }

        return (0);
    }
}
class MemoryMapped
    extends Test
{
    public static void main(final String[] argv)
    {
        final Test test;

        test = new MemoryMapped();
        test.run(new File(argv[0]));
    }

    protected long readFile(final File file)
    {
        FileInputStream stream;

        stream = null;

        try
        {
            final FileChannel      channel;
            final MappedByteBuffer buffer;
            final int              fileSize;
            int                    sum;

            stream   = new FileInputStream(file);
            channel  = stream.getChannel();
            buffer   = channel.map(MapMode.READ_ONLY, 0, file.length());
            fileSize = (int)file.length();
            sum      = 0;

            for(int i = 0; i < fileSize; i++)
            {
                sum += buffer.get();
            }

            return (sum);
        }
        catch(final IOException ex)
        {
            ex.printStackTrace();
        }
        finally
        {
            if(stream != null)
            {
                try
                {
                    stream.close();
                }
                catch(final IOException ex)
                {
                    ex.printStackTrace();
                }
            }
        }

        return (0);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T09:12:48.790

最有效的方法是：

*   确定文件长度 ( `File.length()`)
*   创建一个大小相同（或稍大）的字符缓冲区
*   确定文件的*编码*
*   用于`new InputStreamReader (new FileInputStream(file), encoding)`阅读
*   通过一次调用 read() 将 while 文件读入缓冲区。请注意， read() 可能会提前返回（没有读取整个文件）。在这种情况下，使用偏移量再次调用它以读取下一批。
*   创建字符串：`new String(buffer)`

如果您需要在启动时搜索和替换一次，请使用 String.replaceAll()。

如果需要反复做，可以考虑使用StringBuilder。它没有 replaceAll()，但您可以使用它来操作字符数组（-> 不分配内存）。

那说：

1.  使您的代码尽可能简短。
2.  衡量绩效
3.  太慢了，修一下

如果只需要 0.1 秒的执行时间，就没有理由浪费大量时间让这段代码快速运行。

如果您仍然有性能问题，请考虑将所有文本文件放入 JAR 中，将其添加到类路径中并使用 Class.getResourceAsStream() 来读取文件。从 Java 类路径加载东西是高度优化的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T08:50:04.837

这在很大程度上取决于文本文件的内部结构以及您打算如何处理它们。

文件是键值字典（即“属性”文件）吗？XML？JSON？你有这些的标准结构。

如果它们具有正式的结构，您还可以使用 JavaCC 来构建文件的对象表示。

否则，如果它们只是数据块，那么读取文件并将它们放入字符串中。

**编辑：**关于 search&replace-juste 使用[String 的 replaceAll 函数](http://java.sun.com/javase/6/docs/api/java/lang/String.html#replaceAll(java.lang.String,%20java.lang.String))。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T01:21:33.687

在谷歌上搜索现有的 Java IO 速度测试后，我必须说 TofuBear 的测试用例让我大开眼界。你必须在你自己的平台上运行他的测试，看看什么对你来说是最快的。

在运行他的测试并添加一些我自己的测试之后（感谢 TofuBear 发布他的原始代码），使用自己的自定义缓冲区与使用 BufferedInputStream 相比，您似乎可以获得更快的速度。

令我沮丧的是，NIO ByteBuffer 表现不佳。

注意：静态 byte[] 缓冲区缩短了几毫秒，但静态 ByteBuffers 实际上增加了处理时间！ *代码有什么问题吗？？*

我添加了一些测试：

1.  ArrayTest_CustomBuffering（直接将数据读入我自己的缓冲区）

2.  ArrayTest_CustomBuffering_StaticBuffer（将数据读入静态缓冲区，一开始只创建一次）

3.  FileChannelArrayByteBuffer（使用 NIO ByteBuffer 并包装您自己的 byte[] 数组）

4.  FileChannelAllocateByteBuffer（将 NIO ByteBuffer 与 .allocate 一起使用）

5.  FileChannelAllocateByteBuffer_StaticBuffer（与 4 相同，但带有静态缓冲区）

6.  FileChannelAllocateDirectByteBuffer（将 NIO ByteBuffer 与 .allocateDirect 一起使用）

7.  FileChannelAllocateDirectByteBuffer_StaticBuffer（与 6 相同，但带有静态缓冲区）

这是我的结果：在提取的 rt.jar 上使用 Windows Vista 和 jdk1.6.0_13： ArrayTest
时间 = 2075
字节 = 2120336424
ArrayTest
时间 = 2044
字节 = 2120336424
ArrayTest_CustomBuffering
时间 = 1903
字节 = 2120336424
ArrayTest_CustomBuffering_StaticBuffer
时间 = 13672
字节 = 2124 字节
DataInputAtTime
时间 = 2668
字节 = 2120336424
DataInputReadFully
时间 = 2028
字节 = 2120336424 内存映射
时间
= 2901
字节 = 2120336424
FileChannelArrayByteBuffer
时间 = 2371
字节 = 2120336424
FileChannelAllocateByteBuffer
时间 = 2356
字节 = 2120336424
FileChannelAllocateByteBuffer_StaticBuffer
时间 = 2668
字节 = 2120336424
FileChannelAllocateDirectByteBuffer
时间 = 2512
字节 = 2120336424
FileChannelAllocateDirectByteBuffer_StaticBuffer
时间 = 2590
字节 = 2120336424

我的 TofuBear 代码的破解版本：

```
import java.io.BufferedInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.nio.MappedByteBuffer;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.channels.FileChannel.MapMode;
import java.util.HashSet;
import java.util.Set;
public class Main { 
    public static void main(final String[] argv)     { 
        ArrayTest.mainx(argv);
        ArrayTest.mainx(argv);
        ArrayTest_CustomBuffering.mainx(argv);
        ArrayTest_CustomBuffering_StaticBuffer.mainx(argv);
        DataInputByteAtATime.mainx(argv);
        DataInputReadFully.mainx(argv);
        MemoryMapped.mainx(argv);
        FileChannelArrayByteBuffer.mainx(argv);
        FileChannelAllocateByteBuffer.mainx(argv);
        FileChannelAllocateByteBuffer_StaticBuffer.mainx(argv);
        FileChannelAllocateDirectByteBuffer.mainx(argv);
        FileChannelAllocateDirectByteBuffer_StaticBuffer.mainx(argv);
     } 
 } 
abstract class Test { 
    static final int BUFF_SIZE = 20971520;
    static final byte[] StaticData = new byte[BUFF_SIZE];
    static final ByteBuffer StaticBuffer =ByteBuffer.allocate(BUFF_SIZE);
    static final ByteBuffer StaticDirectBuffer = ByteBuffer.allocateDirect(BUFF_SIZE);
    public final void run(final File root)     { 
        final Set<File> files;
        final long      size;
        final long      start;
        final long      end;
        final long      total;
        files = new HashSet<File>();
        getFiles(root, files);
        start = System.currentTimeMillis();
        size = readFiles(files);
        end = System.currentTimeMillis();
        total = end - start;
        System.out.println(getClass().getName());
        System.out.println("time  = " + total);
        System.out.println("bytes = " + size);
     } 
    private void getFiles(final File dir,final Set<File> files)     { 
        final File[] childeren;
        childeren = dir.listFiles();
        for(final File child : childeren)         { 
            if(child.isFile())             { 
                files.add(child);
             } 
            else             { 
                getFiles(child, files);
             } 
         } 
     } 
    private long readFiles(final Set<File> files)     { 
        long size;
        size = 0;
        for(final File file : files)         { 
            size += readFile(file);
         } 
        return (size);
     } 
    protected abstract long readFile(File file);
 } 
class ArrayTest    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new ArrayTest();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        InputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            int          soFar;
            int          sum;
            stream = new BufferedInputStream(new FileInputStream(file));
            data   = new byte[(int)file.length()];
            soFar  = 0;
            do             { 
                soFar += stream.read(data, soFar, data.length - soFar);
             } 
            while(soFar != data.length);
            sum = 0;
            for(final byte b : data)             { 
                sum += b;
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 

 class ArrayTest_CustomBuffering    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new ArrayTest_CustomBuffering();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        InputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            int          soFar;
            int          sum;
            stream = new FileInputStream(file);
            data   = new byte[(int)file.length()];
            soFar  = 0;
            do             { 
                soFar += stream.read(data, soFar, data.length - soFar);
             } 
            while(soFar != data.length);
            sum = 0;
            for(final byte b : data)             { 
                sum += b;
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 }

 class ArrayTest_CustomBuffering_StaticBuffer    extends Test { 

    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new ArrayTest_CustomBuffering_StaticBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        InputStream stream;
        stream = null;
        try         { 
            int          soFar;
            int          sum;
            final int    fileSize;
            stream = new FileInputStream(file);
            fileSize = (int)file.length();
            soFar  = 0;
            do             { 
                soFar += stream.read(StaticData, soFar, fileSize - soFar);
             } 
            while(soFar != fileSize);
            sum = 0;
            for(int i=0;i<fileSize;i++)             { 
                sum += StaticData[i];
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 }

class DataInputByteAtATime    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new DataInputByteAtATime();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        DataInputStream stream;
        stream = null;
        try         { 
            final int fileSize;
            int       sum;
            stream   = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            fileSize = (int)file.length();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += stream.readByte();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 
class DataInputReadFully    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new DataInputReadFully();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        DataInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            int          sum;
            stream = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            data   = new byte[(int)file.length()];
            stream.readFully(data);
            sum = 0;
            for(final byte b : data)             { 
                sum += b;
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 
class DataInputReadInChunks    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new DataInputReadInChunks();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        DataInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            int          size;
            final int    fileSize;
            int          sum;
            stream   = new DataInputStream(new BufferedInputStream(new FileInputStream(file)));
            fileSize = (int)file.length();
            data     = new byte[512];
            size     = 0;
            sum      = 0;
            do             { 
                size += stream.read(data);
                sum = 0;
                for(int i = 0;
 i < size;
 i++)                 { 
                    sum += data[i];
                 } 
             } 
            while(size != fileSize);
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 
class MemoryMapped    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new MemoryMapped();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final FileChannel      channel;
            final MappedByteBuffer buffer;
            final int              fileSize;
            int                    sum;
            stream   = new FileInputStream(file);
            channel  = stream.getChannel();
            buffer   = channel.map(MapMode.READ_ONLY, 0, file.length());
            fileSize = (int)file.length();
            sum      = 0;

            for(int i = 0; i < fileSize; i++)             { 
                sum += buffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 

 class FileChannelArrayByteBuffer    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new FileChannelArrayByteBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            final FileChannel      channel;
            final ByteBuffer       buffer;
            int                    nRead=0;
            final int              fileSize;
            int                    sum;
            stream = new  FileInputStream(file);
            data   = new byte[(int)file.length()];
            buffer = ByteBuffer.wrap(data);

            channel  = stream.getChannel();
            fileSize = (int)file.length();
            nRead += channel.read(buffer);

            buffer.rewind();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += buffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 

 class FileChannelAllocateByteBuffer    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new FileChannelAllocateByteBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            final FileChannel      channel;
            final ByteBuffer       buffer;
            int                    nRead=0;
            final int              fileSize;
            int                    sum;
            stream = new  FileInputStream(file);
            //data   = new byte[(int)file.length()];
            buffer = ByteBuffer.allocate((int)file.length());

            channel  = stream.getChannel();
            fileSize = (int)file.length();
            nRead += channel.read(buffer);

            buffer.rewind();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += buffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 

 class FileChannelAllocateDirectByteBuffer    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new FileChannelAllocateDirectByteBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            final FileChannel      channel;
            final ByteBuffer       buffer;
            int                    nRead=0;
            final int              fileSize;
            int                    sum;
            stream = new  FileInputStream(file);
            //data   = new byte[(int)file.length()];
            buffer = ByteBuffer.allocateDirect((int)file.length());

            channel  = stream.getChannel();
            fileSize = (int)file.length();
            nRead += channel.read(buffer);

            buffer.rewind();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += buffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 }

 class FileChannelAllocateByteBuffer_StaticBuffer    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new FileChannelAllocateByteBuffer_StaticBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            final FileChannel      channel;
            int                    nRead=0;
            final int              fileSize;
            int                    sum;
            stream = new  FileInputStream(file);
            //data   = new byte[(int)file.length()];
            StaticBuffer.clear();
            StaticBuffer.limit((int)file.length());
            channel  = stream.getChannel();
            fileSize = (int)file.length();
            nRead += channel.read(StaticBuffer);

            StaticBuffer.rewind();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += StaticBuffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 }

 class FileChannelAllocateDirectByteBuffer_StaticBuffer    extends Test { 
    public static void mainx(final String[] argv)     { 
        final Test test;
        test = new FileChannelAllocateDirectByteBuffer_StaticBuffer();
        test.run(new File(argv[0]));
     } 
    protected long readFile(final File file)     { 
        FileInputStream stream;
        stream = null;
        try         { 
            final byte[] data;
            final FileChannel      channel;
            int                    nRead=0;
            final int              fileSize;
            int                    sum;
            stream = new  FileInputStream(file);
            //data   = new byte[(int)file.length()];
            StaticDirectBuffer.clear();
            StaticDirectBuffer.limit((int)file.length());
            channel  = stream.getChannel();
            fileSize = (int)file.length();
            nRead += channel.read(StaticDirectBuffer);

            StaticDirectBuffer.rewind();
            sum      = 0;
            for(int i = 0; i < fileSize; i++)             { 
                sum += StaticDirectBuffer.get();
             } 
            return (sum);
         } 
        catch(final IOException ex)         { 
            ex.printStackTrace();
         } 
        finally         { 
            if(stream != null)             { 
                try                 { 
                    stream.close();
                 } 
                catch(final IOException ex)                 { 
                    ex.printStackTrace();
                 } 
             } 
         } 
        return (0);
     } 
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T17:24:38.127

任何传统方法都会在速度上受到限制。我不确定您是否会看到从一种方法到另一种方法的很大差异。

我会专注于可以使整个操作更快的商业技巧。

例如，如果您读取所有文件并将它们与每个原始文件的时间戳一起存储在一个文件中，那么您可以检查是否有任何文件已更改而无需实际打开它们。（换句话说，一个简单的缓存）。

如果您的问题是快速启动 GUI，您可能会找到一种在显示第一个屏幕后在后台线程中打开文件的方法。

操作系统可以很好地处理文件，如果这是批处理过程的一部分（没有用户 I/O），您可以从一个批处理文件开始，在启动 java 之前将所有文件附加到一个大文件中，使用如下内容：

```
echo "file1" > file.all
type "file1" >> file.all
echo "file2" >> file.all
type "file2" >> file.all 
```

然后打开 file.all （我不确定这会快多少，但这可能是我刚才所说的条件下最快的方法）

我想我只是说，通常情况下，速度问题的解决方案通常需要稍微扩展您的观点并使用新参数完全重新考虑解决方案。对现有算法的修改通常只会以牺牲可读性为代价来提高速度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T21:18:11.137

您应该能够使用 Commons IO FileUtils.readFileToString(File) 等标准工具在一秒钟内读取所有文件

您也可以使用 writeStringToFile(File, String) 来保存修改后的文件。

[http://commons.apache.org/io/api-release/index.html?org/apache/commons/io/FileUtils.html](http://commons.apache.org/io/api-release/index.html?org/apache/commons/io/FileUtils.html)

BTW：50 不是很多文件。一台典型的 PC 可以有 100K 或更多的文件。

# c# - 使网站上的自动完成功能更具响应性的技术

> ID：625432
> 
> 赞同：1
> 
> 时间：2009-03-09T08:41:03.907
> 
> 标签：c#, javascript, autocomplete

在我网站的高级搜索屏幕中，大约有 15 个字段需要自动完成字段。
它们的内容都取决于彼此的值（因此如果填写一个，则另一个的内容将根据第一个的值而变化）。
大多数字段都有大量的可能性（至少有 1000 个条目）。

如果用户停止输入半秒钟，则当前进行 ajax 调用。这个 ajax 调用快速调用我的 Lucene 索引并返回一堆 JSon 对象。方法本身确实很快，但是数据的连接和传输太慢了。

如果我查看其他网站（比如 facebook），它们的自动完成功能是即时的。我认为他们将可能的值放在 HTML 中，因此他们不必进行往返。但我担心我正在处理的数据量很大，这不是一个选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T09:12:51.367

1.  仅返回前 x 个结果。
2.  获取一些关于用户选择的趋势，并根据这些趋势进行订购，最好是自动订购。
3.  缓存每个 URL 和击键组合的结果，这样如果您之前已经获取过结果，就不必往返。
4.  与使用相同 URL 和击键组合的所有自动完成共享此缓存。
5.  当然，为 JSON 启用 gzip 压缩，并确保将缓存标头设置为缓存一段时间。时间取决于您自动完成响应的变化率。
6.  优化 JSON 以发送最低限度。不要发送任何你不需要的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T08:45:54.770

您是返回所有结果的可能性还是只返回前 10 个作为 json 对象。

我注意到很多人将大量结果发送回屏幕，但只显示前几个。通过发回少量结果，您可以减少数据传输。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T08:54:35.293

返回顶部的“X”结果，而不是整个列表，以减少选项的数量？您可能还想尝试添加一些趋势来跟踪用户从列表中选择的内容，以便您可以尝试使顶部的“X”成为最常用/最相关的。您总是可以先返回您最相关的列表，然后如果他们仍在苦苦挣扎，则返回完整列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T09:09:52.947

除了将结果集限制为顶部 X 集之外，还可以考虑对 AJAX 请求的响应启用缓存（这意味着使用 GET 并保持 URL 简单）。

令人惊讶的是，用户经常退格然后最终重新输入完​​全相同的内容。此外，通过允许公共和服务器端缓存，您可以加快整体往返时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T09:16:46.440

*   在 System.Web.Cache 中缓存结果
*   使用 Lucene 缓存
*   使用 GET 而不是 POST，因为 IE 缓存了这个
*   只获取结果的一个子集（人们建议的 10 个）
*   尝试像[YUI这样的体面的 3rd 方自动完成小部件](http://developer.yahoo.com/yui/autocomplete/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T09:09:55.227

返回前 N 个条目是一个好方法。但是，如果您想要/必须返回*所有*数据，我会尝试限制正在发送的数据和 JSON 对象本身。

例如：

“This Here Company With a Long Name”变为“This Here Company...”（您将点放在客户端名称中——再次；传输最少的数据）。

就 JSON 对象而言：

```
{n: "This Here Company", v: "1"} 
```

...其中“n”是名称，“v”是值。

# java - 如何在 Java 中将毫秒转换为“X 分钟，x 秒”？

> ID：625433
> 
> 赞同：613
> 
> 时间：2009-03-09T08:41:06.200
> 
> 标签：java, time

我想记录`System.currentTimeMillis()`用户在我的程序中开始某事的时间。`System.currentTimeMillis()`当他完成时，我将从变量中减去当前时间`start`，并且我想使用人类可读的格式向他们显示经过的时间，例如“XX 小时，XX 分钟，XX 秒”甚至“XX 分钟，XX 秒”，因为它不太可能花一个小时。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1301
> 
> 时间：2009-03-09T10:01:19.360

使用[`java.util.concurrent.TimeUnit`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html#toMinutes(long))类：

```
String.format("%d min, %d sec", 
    TimeUnit.MILLISECONDS.toMinutes(millis),
    TimeUnit.MILLISECONDS.toSeconds(millis) - 
    TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(millis))
); 
```

注意：`TimeUnit`是 Java 1.5 规范的一部分，但从`toMinutes`Java 1.6 开始添加。

要为值 0-9 添加前导零，只需执行以下操作：

```
String.format("%02d min, %02d sec", 
    TimeUnit.MILLISECONDS.toMinutes(millis),
    TimeUnit.MILLISECONDS.toSeconds(millis) - 
    TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(millis))
); 
```

如果`TimeUnit`或`toMinutes`不受支持（例如在 API 版本 9 之前的 Android 上），请使用以下公式：

```
int seconds = (int) (milliseconds / 1000) % 60 ;
int minutes = (int) ((milliseconds / (1000*60)) % 60);
int hours   = (int) ((milliseconds / (1000*60*60)) % 24);
//etc... 
```

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2011-10-05T15:41:27.570

基于@siddhadev 的回答，我编写了一个函数，将毫秒转换为格式化字符串：

```
 /**
     * Convert a millisecond duration to a string format
     * 
     * @param millis A duration to convert to a string form
     * @return A string of the form "X Days Y Hours Z Minutes A Seconds".
     */
    public static String getDurationBreakdown(long millis) {
        if(millis < 0) {
            throw new IllegalArgumentException("Duration must be greater than zero!");
        }

        long days = TimeUnit.MILLISECONDS.toDays(millis);
        millis -= TimeUnit.DAYS.toMillis(days);
        long hours = TimeUnit.MILLISECONDS.toHours(millis);
        millis -= TimeUnit.HOURS.toMillis(hours);
        long minutes = TimeUnit.MILLISECONDS.toMinutes(millis);
        millis -= TimeUnit.MINUTES.toMillis(minutes);
        long seconds = TimeUnit.MILLISECONDS.toSeconds(millis);

        StringBuilder sb = new StringBuilder(64);
        sb.append(days);
        sb.append(" Days ");
        sb.append(hours);
        sb.append(" Hours ");
        sb.append(minutes);
        sb.append(" Minutes ");
        sb.append(seconds);
        sb.append(" Seconds");

        return(sb.toString());
    } 
```

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2012-02-16T12:14:37.033

```
long time = 1536259;

return (new SimpleDateFormat("mm:ss:SSS")).format(new Date(time)); 
```

印刷：

> 25:36:259

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-03-09T08:42:52.013

嗯……一秒是多少毫秒？在一分钟内？分工没那么难。

```
int seconds = (int) ((milliseconds / 1000) % 60);
int minutes = (int) ((milliseconds / 1000) / 60); 
```

像这样持续数小时、数天、数周、数月、数年、数十年等等。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2014-04-19T23:09:57.520

在 Java 8 中使用[java.time 包：](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)

```
Instant start = Instant.now();
Thread.sleep(63553);
Instant end = Instant.now();
System.out.println(Duration.between(start, end)); 
```

输出采用[ISO 8601 持续时间格式](https://en.wikipedia.org/wiki/ISO_8601#Durations)：`PT1M3.553S`（1 分 3.553 秒）。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2009-03-09T08:48:45.200

我不会仅仅为此而引入额外的依赖（毕竟除法并不难），但如果你使用的是 Commons Lang，那么有[DurationFormatUtils](http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/time/DurationFormatUtils.html)。

示例用法（改编自[此处](https://www.programcreek.com/java-api-examples/?code=ibissource/iaf/iaf-master/core/src/main/java/nl/nn/adapterframework/util/Misc.java)）：

```
import org.apache.commons.lang3.time.DurationFormatUtils

public String getAge(long value) {
    long currentTime = System.currentTimeMillis();
    long age = currentTime - value;
    String ageString = DurationFormatUtils.formatDuration(age, "d") + "d";
    if ("0d".equals(ageString)) {
        ageString = DurationFormatUtils.formatDuration(age, "H") + "h";
        if ("0h".equals(ageString)) {
            ageString = DurationFormatUtils.formatDuration(age, "m") + "m";
            if ("0m".equals(ageString)) {
                ageString = DurationFormatUtils.formatDuration(age, "s") + "s";
                if ("0s".equals(ageString)) {
                    ageString = age + "ms";
                }
            }
        }
    }
    return ageString;
} 
```

例子：

```
long lastTime = System.currentTimeMillis() - 2000;
System.out.println("Elapsed time: " + getAge(lastTime)); 

//Output: 2s 
```

**注意**：要从两个 LocalDateTime 对象中获取毫秒，您可以使用：

```
long age = ChronoUnit.MILLIS.between(initTime, LocalDateTime.now()) 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-03-09T08:45:22.710

要么手工划分，要么使用[SimpleDateFormat API](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)。

```
long start = System.currentTimeMillis();
// do your work...
long elapsed = System.currentTimeMillis() - start;
DateFormat df = new SimpleDateFormat("HH 'hours', mm 'mins,' ss 'seconds'");
df.setTimeZone(TimeZone.getTimeZone("GMT+0"));
System.out.println(df.format(new Date(elapsed))); 
```

**由[Bombe](https://stackoverflow.com/users/43582/bombe)**编辑：评论中显示这种方法仅适用于较短的持续时间（即少于一天）。

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2011-05-25T16:52:49.470

如果您想像以下格式一样添加更多信息：HH:mm:ss

0 <= HH <= 无限

0 <= 毫米 < 60

0 <= ss < 60

用这个：

```
int h = (int) ((startTimeInMillis / 1000) / 3600);
int m = (int) (((startTimeInMillis / 1000) / 60) % 60);
int s = (int) ((startTimeInMillis / 1000) % 60); 
```

我现在才遇到这个问题并想通了

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2014-07-17T09:34:10.503

**最短的解决方案：**

这可能是最短的也涉及时区。

```
System.out.printf("%tT", millis-TimeZone.getDefault().getRawOffset()); 
```

例如哪个输出：

```
00:18:32 
```

**解释：**

`%tT`是格式为 24 小时制的时间`%tH:%tM:%tS`。

`%tT`也接受 long 作为输入，因此无需创建`Date`. `printf()`将简单地打印以毫秒为单位的时间，但在当前时区中，因此我们必须减去当前时区的原始偏移量，这样 0 毫秒将是 0 小时，而不是当前时区的时间偏移值。

**注意＃1：**如果您需要结果作为`String`，您可以像这样得到它：

```
String t = String.format("%tT", millis-TimeZone.getDefault().getRawOffset()); 
```

**注意#2：**这仅在`millis`少于一天的情况下给出正确的结果，因为输出中不包括一天部分。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2011-04-05T15:04:00.377

我认为最好的方法是：

```
String.format("%d min, %d sec", 
    TimeUnit.MILLISECONDS.toSeconds(length)/60,
    TimeUnit.MILLISECONDS.toSeconds(length) % 60 ); 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2013-11-13T14:24:57.447

# 乔达时间

使用[乔达时间](http://www.joda.org/joda-time/)：

```
DateTime startTime = new DateTime();

// do something

DateTime endTime = new DateTime();
Duration duration = new Duration(startTime, endTime);
Period period = duration.toPeriod().normalizedStandard(PeriodType.time());
System.out.println(PeriodFormat.getDefault().print(period)); 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2016-08-13T09:48:00.617

重温@brent-nash 的贡献，我们可以使用模函数而不是减法，并对结果字符串使用 String.format 方法：

```
 /**
   * Convert a millisecond duration to a string format
   * 
   * @param millis A duration to convert to a string form
   * @return A string of the form "X Days Y Hours Z Minutes A Seconds B Milliseconds".
   */
   public static String getDurationBreakdown(long millis) {
       if (millis < 0) {
          throw new IllegalArgumentException("Duration must be greater than zero!");
       }

       long days = TimeUnit.MILLISECONDS.toDays(millis);
       long hours = TimeUnit.MILLISECONDS.toHours(millis) % 24;
       long minutes = TimeUnit.MILLISECONDS.toMinutes(millis) % 60;
       long seconds = TimeUnit.MILLISECONDS.toSeconds(millis) % 60;
       long milliseconds = millis % 1000;

       return String.format("%d Days %d Hours %d Minutes %d Seconds %d Milliseconds",
                            days, hours, minutes, seconds, milliseconds);
   } 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2021-01-05T11:26:33.163

对于那些寻找 Kotlin 代码的人：

```
fun converter(millis: Long): String =
        String.format(
            "%02d : %02d : %02d",
            TimeUnit.MILLISECONDS.toHours(millis),
            TimeUnit.MILLISECONDS.toMinutes(millis) - TimeUnit.HOURS.toMinutes(
                TimeUnit.MILLISECONDS.toHours(millis)
            ),
            TimeUnit.MILLISECONDS.toSeconds(millis) - TimeUnit.MINUTES.toSeconds(
                TimeUnit.MILLISECONDS.toMinutes(millis)
            )
        ) 
```

样本输出：`09 : 10 : 26`

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-07-06T06:39:06.497

适用于 API 9 以下的 Android

```
(String.format("%d hr %d min, %d sec", millis/(1000*60*60), (millis%(1000*60*60))/(1000*60), ((millis%(1000*60*60))%(1000*60))/1000)) 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-01-10T07:16:55.203

我的简单计算：

```
String millisecToTime(int millisec) {
    int sec = millisec/1000;
    int second = sec % 60;
    int minute = sec / 60;
    if (minute >= 60) {
        int hour = minute / 60;
        minute %= 60;
        return hour + ":" + (minute < 10 ? "0" + minute : minute) + ":" + (second < 10 ? "0" + second : second);
    }
    return minute + ":" + (second < 10 ? "0" + second : second);
} 
```

快乐编码:)

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2019-09-13T15:17:23.993

首先，`System.currentTimeMillis()`不`Instant.now()`适合计时。它们都报告挂钟时间，计算机不能准确知道，并且可能会不规律地移动，包括如果例如 NTP 守护程序更正系统时间，则*向后移动。*如果您的时间发生在单台机器上，那么您应该改用[System.nanoTime()](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/System.html#nanoTime())。

其次，从 Java 8 开始，[java.time.Duration](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Duration.html)是表示持续时间的最佳方式：

```
long start = System.nanoTime();
// do things...
long end = System.nanoTime();
Duration duration = Duration.ofNanos(end - start);
System.out.println(duration); // Prints "PT18M19.511627776S"
System.out.printf("%d Hours %d Minutes %d Seconds%n",
        duration.toHours(), duration.toMinutes() % 60, duration.getSeconds() % 60);
// prints "0 Hours 18 Minutes 19 Seconds" 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2011-04-05T15:49:34.417

对于不到一个小时的小时间，我更喜欢：

```
long millis = ...

System.out.printf("%1$TM:%1$TS", millis);
// or
String str = String.format("%1$TM:%1$TS", millis); 
```

对于更长的间隔：

```
private static final long HOUR = TimeUnit.HOURS.toMillis(1);
...
if (millis < HOUR) {
    System.out.printf("%1$TM:%1$TS%n", millis);
} else {
    System.out.printf("%d:%2$TM:%2$TS%n", millis / HOUR, millis % HOUR);
} 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2012-04-19T08:14:54.273

```
 long startTime = System.currentTimeMillis();
    // do your work...
    long endTime=System.currentTimeMillis();
    long diff=endTime-startTime;       
    long hours=TimeUnit.MILLISECONDS.toHours(diff);
    diff=diff-(hours*60*60*1000);
    long min=TimeUnit.MILLISECONDS.toMinutes(diff);
    diff=diff-(min*60*1000);
    long seconds=TimeUnit.MILLISECONDS.toSeconds(diff);
    //hour, min and seconds variables contains the time elapsed on your work 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2013-06-25T15:12:09.210

这是基于布伦特纳什答案的答案，希望有帮助！

```
public static String getDurationBreakdown(long millis)
{
    String[] units = {" Days ", " Hours ", " Minutes ", " Seconds "};
    Long[] values = new Long[units.length];
    if(millis < 0)
    {
        throw new IllegalArgumentException("Duration must be greater than zero!");
    }

    values[0] = TimeUnit.MILLISECONDS.toDays(millis);
    millis -= TimeUnit.DAYS.toMillis(values[0]);
    values[1] = TimeUnit.MILLISECONDS.toHours(millis);
    millis -= TimeUnit.HOURS.toMillis(values[1]);
    values[2] = TimeUnit.MILLISECONDS.toMinutes(millis);
    millis -= TimeUnit.MINUTES.toMillis(values[2]);
    values[3] = TimeUnit.MILLISECONDS.toSeconds(millis);

    StringBuilder sb = new StringBuilder(64);
    boolean startPrinting = false;
    for(int i = 0; i < units.length; i++){
        if( !startPrinting && values[i] != 0)
            startPrinting = true;
        if(startPrinting){
            sb.append(values[i]);
            sb.append(units[i]);
        }
    }

    return(sb.toString());
} 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2012-02-08T15:57:16.927

对于正确的字符串（“1小时，3秒”，“3分钟”，但不是“0小时，0分钟，3秒”）我写了这个代码：

```
int seconds = (int)(millis / 1000) % 60 ;
int minutes = (int)((millis / (1000*60)) % 60);
int hours = (int)((millis / (1000*60*60)) % 24);
int days = (int)((millis / (1000*60*60*24)) % 365);
int years = (int)(millis / 1000*60*60*24*365);

ArrayList<String> timeArray = new ArrayList<String>();

if(years > 0)   
    timeArray.add(String.valueOf(years)   + "y");

if(days > 0)    
    timeArray.add(String.valueOf(days) + "d");

if(hours>0)   
    timeArray.add(String.valueOf(hours) + "h");

if(minutes>0) 
    timeArray.add(String.valueOf(minutes) + "min");

if(seconds>0) 
    timeArray.add(String.valueOf(seconds) + "sec");

String time = "";
for (int i = 0; i < timeArray.size(); i++) 
{
    time = time + timeArray.get(i);
    if (i != timeArray.size() - 1)
        time = time + ", ";
}

if (time == "")
  time = "0 sec"; 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2014-09-22T11:34:29.850

如果您知道时差会小于一个小时，那么您可以使用以下代码：

```
 Calendar c1 = Calendar.getInstance();
    Calendar c2 = Calendar.getInstance();

    c2.add(Calendar.MINUTE, 51);

    long diff = c2.getTimeInMillis() - c1.getTimeInMillis();

    c2.set(Calendar.MINUTE, 0);
    c2.set(Calendar.HOUR, 0);
    c2.set(Calendar.SECOND, 0);

    DateFormat df = new SimpleDateFormat("mm:ss");
    long diff1 = c2.getTimeInMillis() + diff;
    System.out.println(df.format(new Date(diff1))); 
```

结果是：51:00

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2015-03-18T04:20:09.940

这个答案类似于上面的一些答案。但是，我觉得这将是有益的，因为与其他答案不同，这将删除任何额外的逗号或空格并处理缩写。

```
/**
 * Converts milliseconds to "x days, x hours, x mins, x secs"
 * 
 * @param millis
 *            The milliseconds
 * @param longFormat
 *            {@code true} to use "seconds" and "minutes" instead of "secs" and "mins"
 * @return A string representing how long in days/hours/minutes/seconds millis is.
 */
public static String millisToString(long millis, boolean longFormat) {
    if (millis < 1000) {
        return String.format("0 %s", longFormat ? "seconds" : "secs");
    }
    String[] units = {
            "day", "hour", longFormat ? "minute" : "min", longFormat ? "second" : "sec"
    };
    long[] times = new long[4];
    times[0] = TimeUnit.DAYS.convert(millis, TimeUnit.MILLISECONDS);
    millis -= TimeUnit.MILLISECONDS.convert(times[0], TimeUnit.DAYS);
    times[1] = TimeUnit.HOURS.convert(millis, TimeUnit.MILLISECONDS);
    millis -= TimeUnit.MILLISECONDS.convert(times[1], TimeUnit.HOURS);
    times[2] = TimeUnit.MINUTES.convert(millis, TimeUnit.MILLISECONDS);
    millis -= TimeUnit.MILLISECONDS.convert(times[2], TimeUnit.MINUTES);
    times[3] = TimeUnit.SECONDS.convert(millis, TimeUnit.MILLISECONDS);
    StringBuilder s = new StringBuilder();
    for (int i = 0; i < 4; i++) {
        if (times[i] > 0) {
            s.append(String.format("%d %s%s, ", times[i], units[i], times[i] == 1 ? "" : "s"));
        }
    }
    return s.toString().substring(0, s.length() - 2);
}

/**
 * Converts milliseconds to "x days, x hours, x mins, x secs"
 * 
 * @param millis
 *            The milliseconds
 * @return A string representing how long in days/hours/mins/secs millis is.
 */
public static String millisToString(long millis) {
    return millisToString(millis, false);
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2018-09-23T14:06:18.287

有一个问题。当毫秒为 59999 时，实际上是 1 分钟，但它会被计算为 59 秒，因此会丢失 999 毫秒。

这里是根据之前的答案修改的版本，可以解决这个损失：

```
public static String formatTime(long millis) {
    long seconds = Math.round((double) millis / 1000);
    long hours = TimeUnit.SECONDS.toHours(seconds);
    if (hours > 0)
        seconds -= TimeUnit.HOURS.toSeconds(hours);
    long minutes = seconds > 0 ? TimeUnit.SECONDS.toMinutes(seconds) : 0;
    if (minutes > 0)
        seconds -= TimeUnit.MINUTES.toSeconds(minutes);
    return hours > 0 ? String.format("%02d:%02d:%02d", hours, minutes, seconds) : String.format("%02d:%02d", minutes, seconds);
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2016-01-29T10:23:36.247

[我在另一个答案](https://stackoverflow.com/a/10650881/82609)中对此进行了介绍，但您可以这样做：

```
public static Map<TimeUnit,Long> computeDiff(Date date1, Date date2) {
    long diffInMillies = date2.getTime() - date1.getTime();
    List<TimeUnit> units = new ArrayList<TimeUnit>(EnumSet.allOf(TimeUnit.class));
    Collections.reverse(units);
    Map<TimeUnit,Long> result = new LinkedHashMap<TimeUnit,Long>();
    long milliesRest = diffInMillies;
    for ( TimeUnit unit : units ) {
        long diff = unit.convert(milliesRest,TimeUnit.MILLISECONDS);
        long diffInMilliesForUnit = unit.toMillis(diff);
        milliesRest = milliesRest - diffInMilliesForUnit;
        result.put(unit,diff);
    }
    return result;
} 
```

输出类似于`Map:{DAYS=1, HOURS=3, MINUTES=46, SECONDS=40, MILLISECONDS=0, MICROSECONDS=0, NANOSECONDS=0}`，单位是有序的。

您可以根据目标语言环境确定如何国际化这些数据。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2017-11-14T15:59:21.823

这在 Java 9 中更容易：

```
 Duration elapsedTime = Duration.ofMillis(millisDiff );
    String humanReadableElapsedTime = String.format(
            "%d hours, %d mins, %d seconds",
            elapsedTime.toHours(),
            elapsedTime.toMinutesPart(),
            elapsedTime.toSecondsPart()); 
```

这会产生一个字符串，如`0 hours, 39 mins, 9 seconds`.

如果您想在格式化前四舍五入到整秒：

```
 elapsedTime = elapsedTime.plusMillis(500).truncatedTo(ChronoUnit.SECONDS); 
```

如果小时数为 0，则省略：

```
 long hours = elapsedTime.toHours();
    String humanReadableElapsedTime;
    if (hours == 0) {
        humanReadableElapsedTime = String.format(
                "%d mins, %d seconds",
                elapsedTime.toMinutesPart(),
                elapsedTime.toSecondsPart());

    } else {
        humanReadableElapsedTime = String.format(
                "%d hours, %d mins, %d seconds",
                hours,
                elapsedTime.toMinutesPart(),
                elapsedTime.toSecondsPart());
    } 
```

现在我们可以有例如`39 mins, 9 seconds`.

要打印带前导零的分钟和秒以使它们始终为两位数，只需插入`02`相关的格式说明符，因此：

```
 String humanReadableElapsedTime = String.format(
            "%d hours, %02d mins, %02d seconds",
            elapsedTime.toHours(),
            elapsedTime.toMinutesPart(),
            elapsedTime.toSecondsPart()); 
```

现在我们可以有例如`0 hours, 39 mins, 09 seconds`.

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2019-05-15T07:42:01.057

[DurationFormatUtils.formatDurationHMS(long)](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/time/DurationFormatUtils.html#formatDurationHMS-long-)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-07-13T18:40:27.507

我修改了@MyKuLLSKI 的答案并添加了复数支持。我花了几秒钟，因为我不需要它们，但如果你需要，可以随时重新添加。

```
public static String intervalToHumanReadableTime(int intervalMins) {

    if(intervalMins <= 0) {
        return "0";
    } else {

        long intervalMs = intervalMins * 60 * 1000;

        long days = TimeUnit.MILLISECONDS.toDays(intervalMs);
        intervalMs -= TimeUnit.DAYS.toMillis(days);
        long hours = TimeUnit.MILLISECONDS.toHours(intervalMs);
        intervalMs -= TimeUnit.HOURS.toMillis(hours);
        long minutes = TimeUnit.MILLISECONDS.toMinutes(intervalMs);

        StringBuilder sb = new StringBuilder(12);

        if (days >= 1) {
            sb.append(days).append(" day").append(pluralize(days)).append(", ");
        }

        if (hours >= 1) {
            sb.append(hours).append(" hour").append(pluralize(hours)).append(", ");
        }

        if (minutes >= 1) {
            sb.append(minutes).append(" minute").append(pluralize(minutes));
        } else {
            sb.delete(sb.length()-2, sb.length()-1);
        }

        return(sb.toString());          

    }

}

public static String pluralize(long val) {
    return (Math.round(val) > 1 ? "s" : "");
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-06-04T08:59:04.553

使用 java.util.concurrent.TimeUnit，并使用这个简单的方法：

```
private static long timeDiff(Date date, Date date2, TimeUnit unit) {
    long milliDiff=date2.getTime()-date.getTime();
    long unitDiff = unit.convert(milliDiff, TimeUnit.MILLISECONDS);
    return unitDiff; 
} 
```

例如：

```
SimpleDateFormat sdf = new SimpleDateFormat("yy/MM/dd HH:mm:ss");  
Date firstDate = sdf.parse("06/24/2017 04:30:00");
Date secondDate = sdf.parse("07/24/2017 05:00:15");
Date thirdDate = sdf.parse("06/24/2017 06:00:15");

System.out.println("days difference: "+timeDiff(firstDate,secondDate,TimeUnit.DAYS));
System.out.println("hours difference: "+timeDiff(firstDate,thirdDate,TimeUnit.HOURS));
System.out.println("minutes difference: "+timeDiff(firstDate,thirdDate,TimeUnit.MINUTES));
System.out.println("seconds difference: "+timeDiff(firstDate,thirdDate,TimeUnit.SECONDS)); 
```

# sql-server-2008 - 逆向工程 SQL2008 数据库到图表

> ID：625441
> 
> 赞同：1
> 
> 时间：2009-03-09T08:44:33.663
> 
> 标签：sql-server-2008, reverse-engineering, diagram

Visio 2007 支持对 MSSQL 数据库进行逆向工程。但是，不支持 SQL2008（[链接](https://stackoverflow.com/questions/92811/reverse-engineering-for-database-diagramming-in-visio-with-sql-server-2008/583227)）。

是否有其他（免费？）工具可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T09:37:05.597

SQL Server Management Studio 工具可以做到这一点。

1.  附加数据库
2.  展开其节点
3.  右键单击数据库图 -> 新建数据库图

注意：您需要以 dbo 身份登录并安装数据库图表组件（如果没有，Management Studio 会告诉您）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-11T09:13:42.813

[DeZign for Databases](http://www.datanamic.com/dezign/index.html)可以导入 SQL2008 数据库（你可以使用 2005 驱动，可以）

# wpf - 将一条线绑定到椭圆的边缘

> ID：625449
> 
> 赞同：0
> 
> 时间：2009-03-09T08:46:03.193
> 
> 标签：wpf, data-binding, canvas

在画布上，我有一个由 RotateTransform 通过动画旋转的椭圆。我希望添加一条线，其一端连接到椭圆上的一个点。我可以以某种方式绑定到椭圆上的一个点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T19:11:46.853

您可以同时为椭圆和直线设置动画，如下所示：

```
<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Canvas.Resources>
        <PathGeometry x:Key="lineEndPath">
            <PathFigure StartPoint="25,50">
                <ArcSegment IsLargeArc="True" Point="100,50" Size="25,25" SweepDirection="Clockwise"/>
                <ArcSegment IsLargeArc="True" Point="25,50" Size="25,25" SweepDirection="Clockwise"/>
            </PathFigure>
        </PathGeometry>
    </Canvas.Resources>
    <Canvas.Triggers>
        <EventTrigger RoutedEvent="Canvas.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Duration="0:0:5" From="0" RepeatBehavior="Forever" Storyboard.TargetName="rotTF" Storyboard.TargetProperty="Angle" To="360"/>
                    <PointAnimationUsingPath Duration="0:0:5" PathGeometry="{StaticResource lineEndPath}" RepeatBehavior="Forever" Storyboard.TargetName="lineEndPoint" Storyboard.TargetProperty="Point"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Canvas.Triggers>
    <Ellipse Width="75" Height="50" Canvas.Left="25" Canvas.Top="25" Stroke="Black">
        <Ellipse.RenderTransform>
            <RotateTransform x:Name="rotTF" CenterX="37.5" CenterY="25"/>
        </Ellipse.RenderTransform>
    </Ellipse>
    <Path Stroke="Black" StrokeThickness="1.0">
        <Path.Data>
            <PathGeometry>
                <PathFigure StartPoint="0,0">
                    <LineSegment x:Name="lineEndPoint"/>
                </PathFigure>
            </PathGeometry>
        </Path.Data>
    </Path>
    <Path Data="{StaticResource lineEndPath}" Stroke="Black" StrokeDashArray="2,0,0" StrokeThickness="1.0"/>
</Canvas> 
```

我们使用[PointAnimationUsingPath为](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.pointanimationusingpath.aspx)[LineSegment](http://msdn.microsoft.com/en-us/library/system.windows.media.linesegment.aspx)的一端设置动画，并将路径设置为圆形（如虚线所示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T08:50:57.143

我不确定问题是什么。您可以将另一个元素添加到正确排列的画布中，并将变换应用于将旋转两个元素的画布？

如果您问是否有任何方式可以在线上说“与此一致”，那么没有，就我现在而言，您不能这样做。对于像这样的复杂布局，您可以使用 KaXaml/Bland 反复试验，或者使用 Illustrator 对其进行布局，然后导出到 XAML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:16:12.463

假设我理解正确，您将不得不计算数学来更改您的线路的终点。抱歉，不知道公式，但您基本上会在椭圆上找到您的点，然后根据旋转角度计算出它的位置，然后使用该信息更改直线的终点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-15T13:37:40.927

为了通过线连接两个元素的边缘，我使用边界框方法，如 [通过线连接两个 WPF 画布元素中所述，不使用锚点？](https://stackoverflow.com/questions/1737509/connecting-two-wpf-canvas-elements-by-a-line-without-using-anchors/1737536#1737536).

# vb.net - 仅在最后一页假脱机后开始打印

> ID：625454
> 
> 赞同：0
> 
> 时间：2009-03-09T08:48:25.403
> 
> 标签：vb.net, printing, spool

我在 VB.net 中打印时遇到问题，我选择的任何网络打印机都在等待打印开始前的最后一页假脱机。但是我希望它在第一页之后开始打印。打印机设置为“立即开始打印”，这给我带来了很大的问题，因为我们正在尝试打印可能是 75 ~ 100 页长的双面文档。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T15:36:37.027

您可以粘贴一些您用于打印的代码示例吗？首先，我会查看队列本身并确保将打印处理器之类的设置设置为 RAW，并确认其他应用程序（例如 Word）对于此设备“立即启动”没有问题。

为什么会有这么大的问题？您的应用程序是否需要很长时间才能生成导致问题的数据？您应该能够快速生成打印输出（假设它不是一堆高分辨率图像或其他东西）并将其快速放入队列中。假设您有一台最新的打印机，它的速度为 30-40ppm，整个过程应该只需要几分钟。

# ruby-on-rails - rake gems:refresh_specs 解压 gems 错误

> ID：625464
> 
> 赞同：22
> 
> 时间：2009-03-09T08:51:18.360
> 
> 标签：ruby-on-rails, rubygems, rake

听从 Chris Wanstrath 的建议，我决定卖掉[一切](http://errtheblog.com/posts/50-vendor-everything)。

但是，现在每当我运行 rake 任务时，我都会收到每个未打包的 gem 的错误说明

> config.gem：vendor/gems 中未打包的 gem gemname 没有规范文件。运行 'rake gems:refresh_specs' 来解决这个问题。

我已经这样做了，但没有骰子。有人有同样的问题吗？如果是这样，我该如何解决？

TIA

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-09T09:39:41.253

我通常会经过以下步骤：

1.  `cd vendor/gems/gemname`
2.  `gem specification gemname > .specification`

希望能帮助到你。

# c# - 如何查看给定 .NET 应用程序中的内存分配？

> ID：625465
> 
> 赞同：4
> 
> 时间：2009-03-09T08:51:23.053
> 
> 标签：c#, .net, memory-management, heap-memory

我需要检查堆中分配了多少内存。有没有办法用 C# 以编程方式获取这个值？

我知道，`System.Runtime.InteropServices.Marshal.SizeOf(...)`但这只能告诉我一个对象的大小。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T09:07:11.783

使用[PerformanceCounter](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)，您可以从您自己的进程甚至其他进程中查询“# Bytes in all Heaps”。

使用“.Net CLR 内存”类别查看大量可用的计数器。

您必须查看由 Jon Skeet 提出的 PerformanceCounter 和 GC.GetTotalMemory 之间的系统负载差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T08:56:23.620

做[`GC.GetTotalMemory`](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx)你需要的一切吗？

（请注意，这也`SizeOf`只会告诉您*编组*后的大小 - 不一定是内存中的大小。）

# rsync - rsync 输出中的数字是什么意思？

> ID：625467
> 
> 赞同：42
> 
> 时间：2009-03-09T08:52:15.173
> 
> 标签：rsync

当我`rsync`使用`--progress`标志运行时，我会获得以下有关转移的信息。

```
path/to/file
          16 100%    0.01kB/s    0:00:01 (xfer#10857, to-check=427700/441502) 
```

第二行的数字是什么意思？我知道其中一些是什么，但其他是什么意思（下面标有???）？

> 16 ？？？
> 
> 此文件中已完成 100% 的传输量
> 
> 当前文件传输速度0.0.1kB/s
> 
> 0:00:01：当前文件传输经过的时间
> 
> 10857 传输的文件计数
> 
> 427700 ？？？
> 
> 441502 ？？？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-09T08:56:17.160

> 文件传输完成后，rsync 将进度行替换为如下所示的摘要行：
> 
> ```
>  1238099 100%  146.38kB/s    0:00:08  (xfer#5, to-check=169/396) 
> ```
> 
> 在此示例中，文件总长度为 1238099 字节，整个文件的平均传输速率为 8 秒内每秒 146.38 KB，这是当前 rsync 期间常规文件的第 5 次传输会话，并且在文件列表中的 396 个总文件中还有 169 个文件供接收者检查（以查看它们是否是最新的）。

来自--progress 开关下的[http://samba.anu.edu.au/ftp/rsync/rsync.html](http://samba.anu.edu.au/ftp/rsync/rsync.html)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-05-11T15:13:58.013

路径/到/文件 16 100% 0.01kB/s 0:00:01 (xfer#10857, to-check=427700/441502)

16 是到目前为止传输的此文件中的字节数。100% 列出了传输文件的百分比：在这种情况下为 100%。对于非常短的文件，kb/sec 数字通常有点奇怪：小的测量误差会导致计算出的整体速度有很大差异。然后是总时间。然后是转帐号码。在给出的示例中，到目前为止检查的 427700 个文件中，只有 10857 个需要传输。根据修改时间，rsync 决定其他一些不需要传输。接下来是要检查的文件数和总数。现代 rsync 实现将动态创建计入“总数”的列表：仅当未检查的数字低于 1000 时才添加到列表中。

# c# - 单元测试依赖方法

> ID：625477
> 
> 赞同：10
> 
> 时间：2009-03-09T08:57:41.963
> 
> 标签：c#, unit-testing

我想在我创建的类上对一个方法进行单元测试，但是这个方法需要先调用另一个方法。例子：

```
// This would work
MyClass myClass1 = new MyClass(mockDevice);
myClass1.Run(myDatastructure);
myClass1.Stop();

// This would throw an InvalidOperationException
MyClass myClass2 = new MyClass(mockDevice);
myClass2.Stop(); 
```

`Run`正在启动硬件设备上的操作，`Stop`当然会尝试停止该操作（发送重置命令并启动超时计时器）。

无论如何，我想测试调用的各种后置条件`Stop`，但我不想调用`Run`，因为我正在测试`Stop`- 不是`Run`！我想要这样的东西：

```
MyClass myClass = new MyClass(mockDevice);
myClass.Stop();
Assert.IsTrue(mockDevice.ResetCalled); 
```

到目前为止，我只看到了一种可能的解决方案，那就是创建一个`TestableMyClass`继承自 的`MyClass`，这样就可以`MyClass`在调用之前设置实例的正确内部状态`Stop`。这个解决方案的问题是我必须更改我的`MyClass`-implementation 以拥有受保护的成员而不是私有成员，而且我*不*喜欢为了测试它而必须更改实现的想法！

我应该使用这个解决方案，我的设计是否有错误，或者有更聪明的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T09:04:49.340

据我所知，您已经在测试`Stop`可以使用它的两种方式（有和没有运行操作）。只要它在`mockDevice`做它的工作，在我看来你正在合理地测试它。理想情况下，您应该能够验证发送到设备等的命令（大多数模拟框架会使其变得简单）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T09:15:33.433

在这种情况下，就个人而言，我将对此进行两项测试：

1.  在不首先调用 Run() 的情况下进行测试。我会测试它是否真的抛出异常。我还将测试后置条件是否符合我的预期。
2.  首先调用 Run() 进行测试。我只会测试我期望的后置条件。

这些是该方法仅有的两个具有不同行为的重要用途——因此我将对它们进行测试。

编辑：我明白，为什么你不想在停止之前调用运行 - 你认为如果运行失败，那么应该只测试停止方法的测试很可能也会失败。

但是，我假设您也对 run 方法进行了测试。这意味着，当测试运行方法的行为通过时，停止方法测试也必须通过。如果 run 方法测试失败，则 run 方法测试的结果是未定义的——它们可能会或可能不会失败。

所以，我想说，不要害怕在测试中调用其他依赖方法，但要确保在单独的测试中测试这些依赖方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T09:27:01.067

它不会帮助您解决眼前的问题，但我倾向于将状态映射到类型，而不是使用具有不同模式的对象。

```
IdleDevice idle = new IdleDevice(mockDevice);
RunningDevice running = idle.Run(myDatastructure);
running.Stop();

// This would not compile, as IdleDevice has no Stop method
IdleDevice idle = new IdleDevice(mockDevice);
idle.Stop(); 
```

如果你不能编译不可能的情况，你就不需要测试它们。

# c# - 在 ListView 中突出显示一个选项

> ID：625483
> 
> 赞同：1
> 
> 时间：2009-03-09T08:59:28.823
> 
> 标签：c#

我以编程方式创建了一个 ListView。我将 FullRowSelect 选项设置为 true。将元素添加到 ListView 后，如果我开始选择项目，当前选择的行将以蓝色突出显示。如何禁用突出显示？我想停止突出显示其选择的项目，但希望 FullRowSelect 为真。

此外，如果我选择一个项目，我想更改项目的颜色，以便任何人都可以轻松识别选择了哪个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T14:23:50.453

真正控制列表中项目显示的唯一方法是使用 ownerdraw。此方法未在 .NET 中公开，因此将意味着覆盖列表的创建和 WinProc（至少）。

另一个选择可能是 WPF，控件的大部分样式都是可覆盖的。

# c# - 取消以编程方式启动的 SQL Server Express 安装

> ID：625484
> 
> 赞同：1
> 
> 时间：2009-03-09T08:59:56.013
> 
> 标签：c#, .net, sql-server, installation, process

在我的应用程序设置过程中，如果用户出于某种原因不想在其网络中使用现有的 SQL Server 2005，他们可以选择在本地计算机上安装新的 SQL Server Express 2005 实例。

由于 SQL Server 安装是可选的，因此我没有将其作为安装程序的先决条件。相反，我只是将安装程序捆绑`sqlexpr32.exe`在我的安装媒体中，并使用适当的命令行参数以编程方式启动它，以便执行自动安装。（注意：我使用 /qb 命令行标志，所以安装不是静默的，**它显示用户界面，但不要求任何用户输入**）。如果有人想知道，我正在关注[这篇](http://technet.microsoft.com/en-us/library/bb264562(SQL.90).aspx#)关于如何启动 SQL Server Express 设置的 Microsoft 文章。

这就是我在自定义安装操作中所做的：

```
// All this runs on a background thread so the user
// can cancel my app's setup at any time

// Launch the installer
Process setupProcess = new Process();
setupProcess.StartInfo.FileName = "sqlexpr32.exe";
setupProcess.StartInfo.Arguments = " a bunch of command line args here";
setupProcess.StartInfo.UseShellExecute = false; // to avoid a shell window
setupProcess.Start();

// At this point the SQL Server installer is running

// Monitor the process on 2-second intervals:
while (!setupProcess.WaitForExit(2000))
{
    if(WasCancelled) // flag that is set when the user cancels my app's setup
    {
        // This following line is my problem. Sending CloseMainWindow does not 
        // seem to work. The SQL Server installer just keeps running.
        setupProcess.CloseMainWindow();
        setupProcess.WaitForExit();
        break;
    }
} 

// After this point I build a results report for the user. 
// My app's installer does not yet quit even if it was canceled. 
```

所以我的问题是：**我如何“通知”SQL Server 安装程序进程取消并退出？**

这条线似乎没有做任何事情：

```
setupProcess.CloseMainWindow(); 
```

这也不起作用：

```
setupProcess.Close(); // This closes my handle. Not the target process. 
```

而且我显然不想仅仅终止该进程，因为我可能会让用户的机器处于不太理想的状态，最好的情况是有很多垃圾文件，或者更糟糕的是，安装损坏。

有任何想法吗？发送键或模拟用户点击？或者希望有一些不那么老套的东西？

**编辑：**

我想我已经找到了为什么`CloseMainWindow`不起作用：

*   我启动*的*`sqlexpr32.exe`进程（所以这个问题变得更加棘手。=( *`setup.exe`*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T00:12:22.820

如果您等到安装程序完成，然后-如果用户取消了主进程-您*立即**卸载*它怎么办？

 *我知道这是一个更耗时的过程，但它清晰易懂。

# linux - 在linux中阻止用户访问网络服务

> ID：625486
> 
> 赞同：1
> 
> 时间：2009-03-09T09:01:52.750
> 
> 标签：linux, permissions

是否可以在阻止用户访问网络服务的同时在 linux 机器上为用户提供一个帐户（例如，不要让他打开到 Internet 上端口 80 的 tcp 连接）。

我知道防火墙可以做到这一点，但我想要 unix philosohpy 中的一些东西（一切都是文件）。也许某处有一个文件代表端口 80 或类似的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T09:07:35.870

不，这个特定场景需要本地机器上的数据包过滤器（即[iptables](http://www.netfilter.org/projects/iptables/index.html)`--uid-owner` ），使用or`--gid-owner`条件。

未经测试：

```
iptables -t filter -A OUTPUT --uid-owner 100 --dport 80 -j REJECT 
```

# python - python条件锁

> ID：625491
> 
> 赞同：1
> 
> 时间：2009-03-09T09:03:54.350
> 
> 标签：python, multithreading

如何在线程应用程序中实现条件锁定，例如，我有 30 个线程正在调用函数，并且在大多数情况下，所有线程都可以同时访问，但是根据函数输入，可能会出现只有一个线程可以执行的条件事物。（如果输入值重复并且某些线程仍在工作，那么我需要锁定。）

我现在有了 Rlock() 的模块线程，但我现在不知道如何以我在第一部分中描述的方式使用它。

**编辑**：问题实际上是关于如何防止任何两个线程同时使用相同的参数运行相同的函数。（感谢大卫帮助我提出我的问题:)）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T09:07:58.757

试试这个：在你的函数所在的模块中有一个锁，如果函数的输入需要锁定，则在函数内部获取锁。否则不要。

```
l = threading.RLock()

def fn(arg):
    if arg == arg_that_needs_lock:
        l.acquire()
        try:
            # do stuff
        finally:
            l.release()
    else:
        # do other stuff 
```

* * *

*编辑*：

据我现在所知，问题实际上是关于如何防止任何两个线程同时使用相同的参数运行相同的函数。不过，两个线程同时运行具有不同参数的同一个函数是没有问题的。如果函数的所有有效参数都可以是字典键，那么执行此操作的简单方法是创建锁参数字典：

```
import threading

dict_lock = threading.RLock()
locks = {}

def fn_dict(arg):
    dict_lock.acquire()
    try:
        if arg not in dict:
            locks[arg] = threading.RLock()
        l = locks[arg]
    finally:
        dict_lock.release()
    l.acquire()
    try:
        # do stuff
    finally:
        l.release() 
```

但是，如果可以使用许多不同的参数调用您的函数，则这相当于很多锁。可能更好的方法是拥有一组函数当前正在执行的所有参数，并让该组的内容受锁保护。我认为这应该有效：

```
set_condition = threading.Condition()
current_args = set()

def fn_set(arg):
    set_condition.acquire()
    try:
        while arg in current_args:
            set_condition.wait()
        current_args.add(arg)
    finally:
        set_condition.release()
    # do stuff
    set_condition.acquire()
    try:
        current_args.remove(arg)
        set_condition.notifyAll()
    finally:
        set_condition.release() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T09:31:39.760

听起来您想要类似于[Readers-Writer lock](http://en.wikipedia.org/wiki/Readers-writer_lock)的东西。

这可能不是您想要的，但可能是一个线索：

```
from __future__ import with_statement
import threading

def RWLock(readers = 1, writers = 1):
    m = _Monitor(readers, writers)
    return (_RWLock(m.r_increment, m.r_decrement), _RWLock(m.w_increment, m.w_decrement))

class _RWLock(object):
    def __init__(self, inc, dec):
        self.inc = inc
        self.dec = dec

    def acquire(self):
        self.inc()
    def release(self):
        self.dec()
    def __enter__(self):
        self.inc()
    def __exit__(self):
        self.dec()

class _Monitor(object):
    def __init__(self, max_readers, max_writers):
        self.max_readers = max_readers
        self.max_writers = max_writers
        self.readers = 0
        self.writers = 0
        self.monitor = threading.Condition()

    def r_increment(self):
        with self.monitor:
            while self.writers > 0 and self.readers < self.max_readers:
                self.monitor.wait()
            self.readers += 1
            self.monitor.notify()

    def r_decrement(self):
        with self.monitor:
            while self.writers > 0:
                self.monitor.wait()
            assert(self.readers > 0)
            self.readers -= 1
            self.monitor.notify()

    def w_increment(self):
        with self.monitor:
            while self.readers > 0 and self.writers < self.max_writers:
                self.monitor.wait()
            self.writers += 1
            self.monitor.notify()

    def w_decrement(self):
        with self.monitor:
            assert(self.writers > 0)
            self.writers -= 1
            self.monitor.notify()

if __name__ == '__main__':

    rl, wl = RWLock()
    wl.acquire()
    wl.release()
    rl.acquire()
    rl.release() 
```

（遗憾的是没有测试）

# response.write - HttpResponse 用下划线替换文件名中的空格

> ID：625503
> 
> 赞同：7
> 
> 时间：2009-03-09T09:11:35.470
> 
> 标签：response.write

下载带有 Response.Write 的文件时，文件名中的空格被替换为下划线，并且当关联的应用程序打开时，会附加方括号中的数字：

```
Response.AppendHeader("Content-disposition", "attachment; filename=this is the file.xml");
Response.Write(dr["InfopathDoc"]); 
```

这会在关联的应用程序中生成此文件名：

这个`_is`_`_`文件[1].xml

我怎样才能摆脱下划线，为什么我会得到 [1] ？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-22T15:25:30.210

在这里找到了这个问题的解决方案

[http://dotnetslackers.com/Community/blogs/kaushalparik/archive/2009/05/06/file-download-problem-filename-with-spaces-truncated-in-ff-and-replaced-by-underscore-in-即.aspx](http://dotnetslackers.com/Community/blogs/kaushalparik/archive/2009/05/06/file-download-problem-filename-with-spaces-truncated-in-ff-and-replaced-by-underscore-in-ie.aspx)

要解决 FF 的问题，请在文件名周围添加引号作为

> Response.AddHeader("Content-Disposition", "attachment; filename=\"" + filename + "\"");

对于 IE，用 '%20' 替换空格

> 文件名 = toDownload.Name.Replace(" ", "%20");

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-14T14:18:27.613

如果有人仍然感兴趣：

这种文件名重写仅由浏览器完成，您可以在使用适当的工具检查接收到的 HTTP 响应时看到，而与使用的浏览器无关。IE 首先将请求的文件下载到其“Temporary Internet Files”文件夹系统（这不仅仅是一个，但这是另一个主题），为此文件接收一个新名称，与“Content-Disposition”最匹配来自 HTTP 响应的建议。*但是，如果实际*中已经存在同名文件*“Temporary Internet Files”文件夹实际用于该文件，其名称由括号中的序号扩展，如“[2]”。因为每个新的 HTTP 请求都会导致 IE 缓存机制重新计算实际的缓存文件夹，并且选择的下一个缓存文件夹可能还没有包含具有该名称的文件，所以该数字可能会在下一次下载文件或资源时消失同名。*

 *如果下载的文件存储在某处，则通常会再次使用最初建议的文件名，具体取决于 IE 版本。某些版本和补丁级别似乎使用缓存文件夹文件名 :-(

当浏览器将下载的文件分发给选定或自动选定的应用程序时，问题开始变得烦人。在这种情况下，调用应用程序直接从缓存中打开文件，这至少有两个原因是不好的：

(1) 文件名将是缓存文件夹中文件的名称，而不是建议的名称。这甚至可能会剥离扩展名，这会使某些应用程序感到困惑，即使它们已被选择用于正确处理文件。

(2) 如果互联网新手用户下载并打开一个文件进行编辑，然后简单地按应用程序的“保存”按钮，该文件只是简单地保存到 IE 缓存文件夹中，这种用户永远不会找到该文件再次。这些事情会让人们非常愤怒和绝望......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-14T15:13:35.783

网上有一些针对此类问题的解决方案。并非所有解决方案都适用于所有浏览器，但某些解决方案至少可以保证“保存结果”，尽管它们不能为所有客户端保留最初的“建议”文件名：

第一眼：

内容处置：附件；文件名=我的新文档.pdf;

FF36：显示下载文件“My” :-( IE6：显示“My New Document.pdf”，但打开时可能显示为“My New Document[1].pdf”。IE8：显示“My_New_Document.pdf” , 但也可以附加“[1]”作为 IE6。 ATTN：保存文档时，IE 会保留显示的名称，无论它在直接打开时向所选应用程序提供什么！

第一个改进：

内容处置：附件；filename="我的新文档.pdf";

FF36：按预期工作，即呈现“My New Document.pdf”。IE6+IE8：没有变化，和以前一样。

第二个变化：

内容处置：附件；文件名="我的%20New%20Document.pdf";

（用 %20 替换空格，就像在 URL 编码中一样，并保留双引号。）

FF36：显示发回的内容，即“My%20New%20Document.pdf”。不太好。IE6+IE8：显示“My New Document.pdf”，但分发“My%20New%20Document.pdf”。

第三变体：

内容处置：附件；文件名=我的%20New%20Document.pdf；

（删除双引号，但保留 %20。）

FF36：如上所述——不好。IE6+IE8：同上——也不是很好。

结论：

似乎至少所提出的方法并不能永远解决问题：它们既没有涵盖 1 个浏览器的所有情况，也没有涵盖任何相同选定情况的所有浏览器。

对我来说，最好的结果似乎是用双引号括起来：对于 FF36 和 IE6 有效，对于 IE8（可能对于 IE7），它至少与下划线稳定，即下载和保存渲染相同的文件名下载并打开，除了我们无法阻止的“[1]”。

最后的评论

有人说圣埃克苏佩里的小国王“小王子”说，当一个皇帝要求根本不可能的事情时，他不能真的期望他的人民跟随，导致他命令太阳升起和落下。自然而然地会这样做。就像本王在他的小行星越来越加速旋转时遇到麻烦一样，这些人已经放弃了，只是在服务器端添加了下划线。:-)

但是关于这个主题的 RFC 以及浏览器实现者提供的内容有时很难克服。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T09:16:19.483

您是否尝试像在 url 中那样用“%20”（没有双引号）替换空格？

但是您应该考虑[避免文件名中的空格](http://www.codinghorror.com/blog/archives/000574.html)（在 url 中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T09:21:35.837

在对输出进行 HTMLEncoding 之后，您不应该使用 Response.Output.Write() 吗？：

```
Response.Output.Write(Server.HtmlEncode(Convert.ToString(dr["InfopathDoc"]))); 
```

**编辑：**文件名后面的下划线和 [1] 表明它是从 Internet 临时文件夹中加载的。没有足够的信息来推断为什么会发生这种情况，但也许这些信息会为您提供线索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T10:11:50.413

显然这是 IE7 的问题，需要修补程序：http: [//support.microsoft.com/kb/952730/en-us](http://support.microsoft.com/kb/952730/en-us)

仍然不知道附加的数字 - 我想可能是因为 IE 临时下载文件夹中已经存在同名文件，但事实并非如此。

# c++ - 事件可以跨进程吗？

> ID：625504
> 
> 赞同：7
> 
> 时间：2009-03-09T09:12:17.623
> 
> 标签：c++, windows, events, ipc

我在一个进程中创建了一个事件并进行测试，通过管道将事件句柄发送到一个完全独立的进程（不是子线程）

当我第一次触发事件时，WaitForSingleObject 没有检测到事件，所以我猜答案是否定的，除非我错过了[SECURITY_ATTRIBUTES 结构中的一些技巧？](http://msdn.microsoft.com/en-us/library/ms682396(VS.85).aspx)

或者我可能需要使用命名事件并调用 OpenEvent()？

在这种情况下，我无法使用窗口消息，因为我试图向 Windows 服务发出信号。我可以使用管道，但是会有很多这样的应用程序，如果可能的话，我想找到一个“低成本”的解决方案。

像内存映射文件这样的其他选项比管道有更多的开销？

你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T09:17:38.437

您需要创建一个命名事件并在两个进程中打开它。如果您有多个进程在监听，您可以考虑使用[semaphore](http://msdn.microsoft.com/en-us/library/ms686946(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T09:40:18.553

是的，这有效：

```
 #COMPILE EXE "NamedEvent.exe"

  #INCLUDE "win32api.inc" 

  %EVENT_ALL_ACCESS = &h0001F0003

  FUNCTION PBMAIN() AS LONG  

    LOCAL lRet AS LONG, lError AS LONG, lEventName AS ASCIIZ * %MAX_PATH
    lEventName = "TestEvent"
    lRet   = CreateEvent (BYVAL %NULL, %False, %False, lEventName)
    lError = GetLastError ()
    IF ISFALSE lRet THEN
      MSGBOX "Unable to create Event, error:" + STR$(lError),,"CreateEvent error"
    ELSE
      IF lError = %ERROR_ALREADY_EXISTS THEN
        lRet = OpenEvent(BYVAL %EVENT_ALL_ACCESS, %False, lEventName)
        lError = GetLastError()
        IF lRet THEN
          MSGBOX "Opened existing Event, handle:" + STR$(lRet),,"OpenEvent:"
        ELSE
          MSGBOX "Unable to open Event, error:" + STR$(lError),,"OpenEvent error" : EXIT FUNCTION
        END IF
      ELSE
        MSGBOX "Created new Event, handle:" + STR$(lRet),,"CreateEvent:"
      END IF
    END IF    

  END FUNCTION 
```

一般来说，什么具有较低的开销：

管道（假设指定小尺寸）

内存映射文件

活动

# c++ - 静态与成员变量

> ID：625507
> 
> 赞同：4
> 
> 时间：2009-03-09T09:14:37.633
> 
> 标签：c++, debugging, static, variables

为了调试，我想在我的类中添加一些计数器变量。但是如果不更改标头会导致大量重新编译，那就太好了。

如果我正确理解了关键字，那么以下两个片段将完全相同。当然，假设只有一个实例。

```
class FooA
{
public:
    FooA() : count(0) {}
    ~FooA() {}

    void update()
    {
        ++count;
    }

private:
    int count;
}; 
```

对比

```
class FooB
{
public:
    FooB() {}
    ~FooB() {}

    void update()
    {
        static int count = 0;
        ++count;
    }
}; 
```

在**FooA**中，可以在类中的任何位置访问 count ，并且还会使标题膨胀，因为不再需要时*应该删除该变量。*

在**FooB**中，该变量仅在它存在的一个函数中可见。以后容易删除。我能想到的唯一缺点是 FooB 的计数在类的所有实例之间共享，但这在我的情况下不是问题。

*   这是正确使用关键字吗？我假设一旦在**FooB中创建****count**，它就会保持创建状态，并且不会在每次调用更新时重新初始化为零。
***   还有其他我应该注意的警告或提示吗？**

 ****编辑：**在被告知这会在多线程环境中导致问题后，我澄清说我的代码库是单线程的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T09:19:18.650

您对静态函数变量的假设是正确的。如果您从多个线程访问它，它可能不正确。考虑使用 InterlockedIncrement()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:43:44.280

对于您的长期 C++ 工具箱，您真正想要的是一个线程安全的通用调试计数器类，它允许您将它放在任何地方并使用它，并且可以从其他任何地方访问以打印它。如果您的代码对性能敏感，您可能希望它在非调试版本中自动不执行任何操作。

这样一个类的接口可能看起来像：

```
class Counters {
public:
  // Counters singleton request pattern.
  // Counters::get()["my-counter"]++;
  static Counters& get() {
    if (!_counters) _counters = new Counters();
  }

  // Bad idea if you want to deal with multithreaded things.
  // If you do, either provide an Increment(int inc_by); function instead of this,
  // or return some sort of atomic counter instead of an int.
  int& operator[](const string& key) {
    if (__DEBUG__) {
      return _counter_map.operator[](key);
    } else {
      return _bogus;
    }
  }

  // you have to deal with exposing iteration support.

private:
  Counters() {}

  // Kill copy and operator=
  void Counters(const Counters&);
  Counters& operator=(const Counters&);

  // Singleton member.
  static Counters* _counters;

  // Map to store the counters.
  std::map<string, int> _counter_map;

  // Bogus counter for opt builds.
  int _bogus;
}; 
```

一旦你有了这个，你可以通过调用将它随意放入 .cpp 文件中的任何位置：

```
void Foo::update() {
  // Leave this in permanently, it will automatically get killed in OPT.
  Counters::get()["update-counter"]++;
} 
```

在你的主要，如果你有内置的迭代支持，你这样做：

```
int main(...) {
  ...
  for (Counters::const_iterator i = Counters::get().begin(); i != Countes::get().end(); ++i) {
    cout << i.first << ": " << i.second;
  }
  ...
} 
```

创建 counters 类有点重，但是如果你正在做一堆 cpp 编码，你可能会发现编写一次然后能够将它作为任何 lib 的一部分链接起来很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T09:18:17.420

静态变量与多线程一起使用时会出现主要问题。如果您的应用程序是单线程的，那么您正在做的事情是非常正确的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T12:14:57.527

在这种情况下，我通常做的是将 count 放入类的源文件中的匿名命名空间中。这意味着您可以随意添加/删除变量，它可以在文件中的任何位置使用，并且不会发生名称冲突。它确实有一个缺点，它只能用于源文件中的函数，而不是头文件中的内联函数，但我认为这就是你想要的。

在文件 FooC.cpp

```
namespace {
int count=0;
}

void FooC::update()
{
    ++count;
} 
```

# php - 将一些 Web 目录设置为受限目录

> ID：625512
> 
> 赞同：0
> 
> 时间：2009-03-09T09:16:57.987
> 
> 标签：php, apache

我正在使用 Apache 做 PHP Web 应用程序。

有一些配置文件（如 App.yml）在任何情况下我都不想向用户公开其内容。无论如何，我可以调整我的 Apache 设置，以便当敌对用户查询这些文件时这些文件不可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T09:22:38.457

最好的选择是将文件放在文档根目录之外。如果这不可能，您可以在 apache .conf 文件（或 .htaccess 文件）中拒绝对它们的访问

```
<Directory /path/to/dir>
    Deny from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T09:20:54.340

您可以在该目录中创建一个`.htaccess`文件并将其放入

```
order deny,allow
deny from all 
```

如果您只想阻止一个文件，也可以这样做。

```
<Files filenamehere>
order deny,allow
deny from all
</Files> 
```

# c# - 发送 POST 请求：System.Net.WebException

> ID：625513
> 
> 赞同：1
> 
> 时间：2009-03-09T09:17:04.053
> 
> 标签：c#, .net, post, https, httpwebrequest

这不是我第一次使用这种方法发送 POST 请求，而且我从来没有遇到任何问题：

```
 public static Stream SendPostRequest(Uri uri, byte[] postData)
    {
        var request = WebRequest.Create(uri);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        request.ContentLength = postData.Length;
        Stream requestStream = request.GetRequestStream();
        requestStream.Write(postData, 0, postData.Length);
        requestStream.Close();
        return request.GetResponse().GetResponseStream();
    } 
```

在 request.GetRequestStream() 我收到 System.Net.WebException：底层连接已关闭：发送时发生意外错误。
更有趣的是，它在某些机器上运行良好，但不能在我的机器（Windows 7 Beta）和生产服务器（Windows Server 2008）上运行。更多信息：

工作 - Windows Xp - .NET 2.0
工作 - Windows Xp - .NET 3.5
工作 - Windows Server 2003 - .NET 3.0
不起作用 - Windows Vista - .NET 3.5
不起作用 - Windows Server 2008 - .NET 3.5
不起作用t 工作 - Windows 7 测试版 - .NET 3.5 SP1

试过：

*   一堆东​​西从[这里](http://blogs.msdn.com/engelsr/articles/497902.aspx)，没有任何帮助。
*   使用[WebClient](https://stackoverflow.com/questions/625513/sending-a-post-request-system-net-webexception/625558#625558)，没有任何改变。
*   调整这些[选项](https://stackoverflow.com/questions/625513/sending-a-post-request-system-net-webexception/626030#626030)，但没有发现任何显着差异。
*   试过[WireShark](http://www.wireshark.org/)。一个非常好的工具。

**[解决了。有点]**
我忘了提，但 Uri 是 https ......我尝试了 http 并且它有效。不敢相信，我没有早点尝试……
不过，如果有人能对整个情况有所了解，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T09:24:01.480

我的第一个攻击计划是使用[WireShark](http://wireshark.org)来查看每种情况下网络级别发生的情况。查看每台机器发送的内容。

此外，您注意到操作系统之间的差异，但它们是否都安装了完全相同版本的 .NET（下至 SP）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T09:33:15.357

GET 有效吗？也许这是一个代理配置问题（`proxycfg`等）。

另外 - 为了简化事情（减少未知数），考虑使用`WebClient`来做帖子：

```
using (WebClient client = new WebClient())
{
    client.Headers.Add("content-type","application/x-www-form-urlencoded");
    client.UploadData(address, data);
    // or more simply
    client.UploadValues(address, nameValuePairs);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T12:29:26.260

尝试调整以下一个或多个选项：

*   发送卡住
*   允许自动重定向
*   传输编码

还要尝试注意它们与您的各种配置之间的差异。

# objective-c - 更改单元测试的常量

> ID：625515
> 
> 赞同：1
> 
> 时间：2009-03-09T09:17:51.557
> 
> 标签：objective-c, unit-testing, constants

我正在为数据驱动的应用程序在可可中编写一些单元测试。

我有一个常量头文件，它定义了一大堆变量，包括数据库的路径等。

我想知道是否可以让所有类使用一组不同的常量，这些常量将链接到数据库的测试版本等。

我试过重新定义常量，但它不会全局生效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T18:52:20.177

相反，您可以拥有一个包含所有使用的常量的结构，并将其传递给对象的构造函数。通常，该结构将是运行所需的任何值，但是当您进行测试时，您将传递一个结构，其中的字段已初始化为测试参数

我对目标 C 一无所知，所以我不确定这对你来说是否可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T03:20:45.617

您可以将所有常量放入一个具有常量只读属性的单例对象中。然后您可以模拟常量对象并更改常量。

# java - Java 对继承方法的反射在 Windows 和 Linux 中是否不同？

> ID：625516
> 
> 赞同：2
> 
> 时间：2009-03-09T09:18:03.723
> 
> 标签：java, windows, linux, reflection

在设置 Hudson 以进行持续集成测试（在 JeOS 服务器上）时，我遇到了一些奇怪的行为，我希望 SO 的优秀人员可以向我解释。

我们的单元测试在很大程度上依赖于域对象的使用，必须设置许多属性（由于数据库中的空约束）。为了让我们的测试保持可读性，我们创建了一个类 InstantiationUtils，它可以实例化一个对象并通过反射设置一系列属性：

```
public static <T> T newInstance(final Class<T> type, final KeyValuePair<?>... propertyValues) {

    return ReflectionUtils.reflectionOperation(new ReflectionOperation<T>() {

        @Override
        public T perform() throws Exception {

            T object = type.newInstance();
            for (KeyValuePair<?> propertyValue : propertyValues) {

                String propertyName = propertyValue.getKey();
                Object value = propertyValue.getValue();
                String setterName = "set" + StringUtils.capitalize(propertyName);
                ReflectionUtils.invoke(object, setterName, value);
            }
            return object;
        }
    });
}

public static void invoke(final Object target, final String methodName, final Object... params) {

    List<Class<?>> parameterTypes = ListUtils.map(asList(params), "class");
    Class<?> targetClass = target.getClass();
    Method method = MethodUtils.getMatchingAccessibleMethod(targetClass, methodName,
        parameterTypes.toArray(new Class<?>[] {}));
    invoke(target, method, params);
}

public class Foo {
    private String foo;

    public void setFoo(final String foo) {
        this.foo = foo;
    }
}

public class Bar extends Foo {
    private String bar;

    public void setBar(final String bar) {
       this.bar = bar;
    }
} 
```

不幸的是，编写此代码的人不再为我们工作，但据我所知，它没有任何问题。对于 Windows 也是如此 - 我们在整个单元测试中使用 InstantiationUtils 没有任何问题。

然而，Linux 是不同的。事实证明，在 Linux 中，newInstance() 方法仅适用于我们要实例化的类的直接（即非继承）成员。

InstantiationUtils.newInstance(Bar.class, "bar", "12345"); 将工作，而 InstantiationUtils.newInstance(Bar.class, "foo", "98765"); 在 Linux 上会失败，但有以下例外：

> xxx.xxx.xxx.ReflectionUtils$ReflectionException: java.lang.NoSuchMethodException: 属性 'foo' 没有设置方法

在 Windows 上，这两个调用都可以工作（我知道 newInstance 签名不匹配；我们有几个重载的 newInstance() 方法可以将参数转换为 KeyValuePairs）。

我很难接受继承的公共方法被区别对待，所以我用我能想到的所有方式对此进行了测试。而且最后总是得出这样的结论，在Linux下，至少在上面使用反射的情况下，我们无法访问公共继承方法。

在 Windows 上，我使用 Sun 的 JRE 1.6.0.11，在 Linux 上也是 Sun，但版本是 1.6.0.7。

谁能确认这是否正确？或者反射的使用是否存在某种缺陷？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T09:57:55.827

您正在使用 MethodUtils，它有一些[限制](http://commons.apache.org/beanutils/apidocs/org/apache/commons/beanutils/MethodUtils.html)：

> 已知限制
> 
> 在默认访问超类中访问公共方法
> 
> 调用默认访问超类中包含的公共方法时存在问题。反射可以很好地定位这些方法并正确地将它们分配为公共的。但是，如果调用该方法，则会引发 IllegalAccessException。

要检查的另一件事是 setFoo() 方法是否重载，这也可能导致问题...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T09:28:19.567

会不会是[`SecurityManager`](http://www.javaworld.com/javaworld/jw-11-1997/jw-11-hood.html)不同 Java 运行时的设置不同？

当然，我怀疑这是一个*平台*问题——几乎可以肯定这与两个环境之间的 JRE 版本/设置有关

您确实需要将源代码发布到**`MethodUtils.getMatchingAccessibleMethod`**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T11:05:41.173

有几件事要尝试...

在 Linux 上，尝试在没有对 getFoo() 的反射调用的情况下编译代码 - 如果它不能编译，那么反射就没有工作的希望（它确实取决于你在运行时如何设置 CLASSAPTH ......）

尝试添加下面的代码并在 Linux 和 Windows 上运行它。

```
final Properties properties;

properties = System.getProperties();

for(final Entry<Object, Object> entry : properties.entrySet())
{
    System.out.println(entry.getKey() + " " + entry.getValue());
} 
```

检查输出以确保您使用的是 smae JDK/JRE。还要检查以确保类路径正确，以便您实际加载您认为正在加载的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T11:22:38.417

谜团部分解决：

MethodUtils.getMatchingAccessibleMethod() 在 Linux 和 Windows 上的工作方式显然不同。

通过使用 MethodUtils.getAccessibleMethod() 代替，它可以工作。为什么，我不知道，但我猜测 MethodUtils 在确定 Method 应该具有的签名时会以某种方式误解参数列表。

我想花更多时间对此进行调查，但与往常一样，有事情要做，有项目要交付，所以我只需要接受 getAccessibleMethod 有效，然后继续 :-)

感谢大家的意见！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T09:30:02.337

你在 Linux、Sun、GCJ 等上使用哪个 JVM？如果您使用的不是 Sun 的 JVM，您可以尝试安装它，看看是否有什么不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T09:43:51.213

你有不同的地区吗？`StringUtils.capitalize(propertyName)`可能会产生不同的输出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T10:04:15.830

你检查过你的`CLASSPATH`吗？您是否根据您所在的平台选择不同版本的要实例化的类？（例如旧代码库等？）

# asp.net - 如何提交文件的原始路径和文件名而不在 ASP.NET 中提交文件本身？

> ID：625524
> 
> 赞同：0
> 
> 时间：2009-03-09T09:19:44.873
> 
> 标签：asp.net, file, submit

如何在 ASP.NET 表单上拥有一个控件，该控件像`FileUpload`控件一样浏览文件，但不是提交整个文件，而是仅提交从女巫找到文件的路径（使用原始文件名）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T09:27:19.927

这是我按照以下论坛帖子的说明制作的解决方法：[http ://forums.asp.net/p/1189182/2040139.aspx#2040048](http://forums.asp.net/p/1189182/2040139.aspx#2040048)

```
<asp:FileUpload ID="File1" runat="server" onchange="GetFileName();"/> 
<asp:Button ID="Submit" runat="server" Text="Submit" OnClientClick="DisableFileSelector();" />
<asp:HiddenField id="txtFileName" runat="server" />

<script language="javascript" type="text/javascript">
    function GetFileName()
    {
        document.getElementById('<%=txtFileName.ClientID %>').value = document.getElementById('<%=File1.ClientID %>').value;
    }
    function DisableFileSelector() {
        document.getElementById('<%=File1.ClientID %>').disabled = true;
    }
</script> 
```

当然，这只有在启用 JavaScript 时才有效。如果 JavaScript 被禁用，表单将提交文件，但您仍然可以通过在第一次使用之前添加以下代码来保持站点的功能`txtFileName`。

```
if (File1.HasFile)
{
    txtFileName.Value = File1.PostedFile.FileName;
} 
```

# asp.net - 最佳搜索方式

> ID：625525
> 
> 赞同：1
> 
> 时间：2009-03-09T09:20:08.447
> 
> 标签：asp.net, database, vb.net, search

我正在建立一个房地产网站。我有一个属性表（即“房屋”），一个图片表，一个功能表等。所以每个属性的数据来​​自三个，而不仅仅是一个表。

我需要提供一个函数来根据搜索条件检索请求的属性数据，例如：

1.  本周财产
2.  特色物业
3.  提供的物业
4.  简单的搜索

我有多个下拉列表用于选择国家、地区、区域、卧室、价格范围、类型等。

我已经构建了许多函数，每个函数都处理上述一种情况，但我想知道，是否有任何其他方法可以构建一种灵活的机制，以一种智能的方式检索你想要的任何内容，我的意思是一种适用于所有情况的函数?

我知道我的问题有点模糊而且太宽泛，但请耐心等待。

提前致谢。

PS：我正在使用 ASP.NET 3.5、VB.NET、Visual Web Developer 2008 Express、SQL Server 2005 Express

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T09:27:32.780

我认为您正在寻找与提供的默认/简单搜索集成的高级搜索功能。

为什么不通过指定未传递参数的默认值来构建单个存储过程来封装所有可能的搜索类型。

以这种方式，简单搜索将使用所有参数默认值。每当提供任何标准来缩小搜索范围时，存储过程将使用传递的参数值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:16:03.303

Lucene 是一种选择吗？Lucene.net 是一种为您的站点提供快速灵活的搜索引擎的好方法。当您使用 Lucene 时，您还有许多其他优势，例如模糊搜索等...

[http://www.codeproject.com/KB/library/IntroducingLucene.aspx](http://www.codeproject.com/KB/library/IntroducingLucene.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:58:25.433

问题是双重的：

1.  *您能否在逻辑上将*“本周房产”的搜索和“该特定区域的房产，成本在 100,000 或更少”的搜索合并到一个数据库搜索中？
2.  *它有没有*让你想到/创造一些可以做 1.) 的东西？（特别是当你已经有了一些有用的东西时。）

如果您用“是”回答这两个问题，那么我会说您必须扩展简单搜索。我想您已经为每个特殊情况（“本周房产”、“待售房产”等）设置了一个标志。只需在您的简单搜索功能中添加对这些标志的支持。

为搜索条件提供合理的默认值，您可以对您描述的所有案例使用简单搜索。

# .net - 使用不兼容的 Visual Studio 进行调试，但使用 .pdb

> ID：625530
> 
> 赞同：2
> 
> 时间：2009-03-09T09:21:35.010
> 
> 标签：.net, visual-studio, debugging

好的，奇怪的情况：我需要调试 VSTO Office 插件。这是用 Visual Studio 2008 Professional 编写的，调试通常通过加载项目、附加到 Outlook.exe 和设置断点来完成 - 工作正常。

但我给出了一种情况，它在一台机器上无法按预期工作，但我在该机器上没有 VS2008 Pro（只有 Express 有帮助，但 Express 不会加载项目，因为项目类型不受支持），并且没有有机会使用远程调试器。

我只是想知道是否仍然可以在不加载项目的情况下对其进行调试，因为我已经“武装”了用于此目的的 .pdb 文件、源代码和 .dll 。

编辑：只是为了澄清，这不是一个例外，它是一个 if/else 块，即使它不应该进入 else 块。我需要设置断点并检查一些 .net 变量，甚至可能修改它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T09:31:34.317

WinDbg 将能够做到这一点，但它并不完全是用户友好的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T10:02:59.950

另一个简单的技巧：将跟踪消息添加到您的代码 ( `System.Diagnostics.Trace`)。您将能够使用来自 Sysinternals/MS 的[**DbgView监视所有跟踪消息。**](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)

可能无法提供单步执行代码的能力，但在分析目标系统上没有调试器（例如在客户站点）上的问题时，这非常方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T09:40:59.067

如果您使用调用堆栈记录异常，那么您将拥有一个行号和源文件。如果您可以在机器上部署新代码，请在代码中添加一些额外的日志记录/跟踪。

如果这不起作用，请使用 WinDbg 检查内存转储，并使用[SOS Debugging Extension](http://msdn.microsoft.com/en-us/library/bb190764(VS.80).aspx)。

编辑：[Hawkeye.Net](http://www.codeplex.com/hawkeye)也可能对您的情况有所帮助。

# wordpress - 将图像与 WordPress 中的帖子相关联

> ID：625532
> 
> 赞同：2
> 
> 时间：2009-03-09T09:22:09.440
> 
> 标签：wordpress, image

将图像与 WordPress 中的帖子相关联的最佳方式是什么？

我的意思是当每个帖子都有一个不在帖子正文中的“标题”图像时。当每个帖子列在某处时，您很可能会使用它在每个帖子旁边显示一个小图像。

我知道您可以在帖子中使用自定义字段，但是有没有更好的方法呢？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:43:45.950

如果您使用自定义字段路由 - 在您的模板代码中，您可以将自定义字段的值保存到变量中，然后将其回显到您的图像中。

```
<?php $post_image = get_post_meta($post->ID, post_image, true); ?>
<?php if( $post_image != "" && isset($post_image) ) : ?>
   <p><img src="<?php echo $post_image; ?>" alt="<?php echo $post_image; ?>" /></p>
<?php endif; ?>
<?php the_content('read more...'); ?> 
```

the_content() 函数可能是也可能不是您最终将使用的函数 - 为了获得更多控制，您可以尝试设置一个新的 WP_Query() 然后修改循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T23:59:44.570

如果您希望每个帖子使用不同的图像，请按照之前的建议使用自定义字段 - 唯一的问题是自定义字段是文本字段，因此您必须上传您的图像，然后将文件名粘贴到您的自定义字段中。您可以在主帖子输入表单中使用普通的添加图像工具，但这会破坏您的工作流程，因为您必须：在主帖子表单中上传图像，从表单的 HTML 复制图像 url，从表单中删除图像，将 URL 粘贴到自定义字段中。

有点痛！

如果您想按类别使用图像。比如说，你有一个新闻项目的缩略图和一个教程的缩略图等等。您可以编辑您的 WP 主题模板，检查[The Loop](http://codex.wordpress.org/The_Loop)中的类别并从那里显示相关图像。

第一个选项有点麻烦，第二个选项需要一些 PHP 编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T16:09:53.220

没有比自定义字段更好的方法，尽管您总是可以在容器 div 上写出包含帖子 ID 的唯一类名，并在每次添加帖子时通过 CSS 添加图像。你会以一个可能很大的 CSS 文件结束，所以我自己会去自定义字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T10:11:21.190

将图像与帖子关联的一种好方法是在模板文件中调用附加到该帖子的第一张图像。

我在这个线程中详细阐述了一点：

[您如何建议在 WordPress 中将图像添加为自定义字段？](https://stackoverflow.com/questions/682926/how-would-you-recommend-adding-an-image-as-a-custom-field-in-wordpress)

# wpf - IValueConverter 上的数据绑定

> ID：625535
> 
> 赞同：7
> 
> 时间：2009-03-09T09:22:37.987
> 
> 标签：wpf, data-binding, ivalueconverter, dependencyobject

有谁知道是否可以对基于 IValueConverter 的类进行数据绑定？

我有以下转换器：

```
[ValueConversion(typeof(int), typeof(Article))]
public class LookupArticleConverter : FrameworkElement, IValueConverter {
    public static readonly DependencyProperty ArticlesProperty = DependencyProperty.Register("Articles", typeof(IEnumerable<Article>), typeof(LookupArticleConverter)); 

    public IEnumerable<Article> Articles
    {
        get { return (IEnumerable<Article>)GetValue(ArticlesProperty); }
        set { SetValue(ArticlesProperty, value); }
    }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture) {
        ...
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) {
        ...
    }
} 
```

其目的是通过其 Id 在列表中查找文章，并返回该文章。

但是，我想通过将集合数据绑定到它来填充 Articles 属性，如下所示：

```
<local:LookupArticleConverter Articles="{Binding Articles}" x:Key="LookupArticle"/> 
```

但这似乎不起作用。永远不会调用 setter 方法。source 属性包含一个实际的非空集合，所以这不是问题。

输出日志中也没有关于绑定的错误消息。

有什么线索吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-12-18T04:22:36.503

所以，问题在于资源不是可视化树的一部分。要完成这项工作，您必须：

## 1.让你的ValueConverter继承Freezable

```
 public class CustomConverter : Freezable, IValueConverter
 {

    public static readonly DependencyProperty LookupItemsProperty =
        DependencyProperty.Register("LookupItems", typeof(IEnumerable<LookupItem>), typeof(CustomConverter), new PropertyMetadata(default(IEnumerable<LookupItem>)));

    public IEnumerable<LookupItem> LookupItems
    {
        get { return (IEnumerable<LookupItem>)GetValue(LookupItemsProperty); }
        set { SetValue(LookupItemsProperty, value); }
    }

    #region Overrides of Freezable

    /// <summary>
    /// When implemented in a derived class, creates a new instance of the <see cref="T:System.Windows.Freezable"/> derived class.
    /// </summary>
    /// <returns>
    /// The new instance.
    /// </returns>
    protected override Freezable CreateInstanceCore()
    {
        return new CustomConverter();
    }

    #endregion Overrides of Freezable

    // ... Usual IValueConverter stuff ...

} 
```

## 2\. 使用 Binding ElementName 绑定到可视化树

```
<UserControl (...) x:Name=myUserControl> 
<UserControl.Resources>
<CustomConverter x:Key="customConverter"
                    LookupItems="{Binding ElementName=myUserControl, Path=DataContext.LookupItems}"/>
</UserControl.Resources> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T09:31:49.510

WPF 本质上并不真正支持这一点。但是，有一些技术可以让您做到这一点，包括 Josh Smith 的[虚拟分支方法](http://www.codeproject.com/KB/WPF/AttachingVirtualBranches.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-05T03:37:46.677

我已将 RelativeSource 方法添加到绑定语句中。这解决了我在 Control.Resources.ResourceDictionary 树下定义了 IValueConverter 的问题，并且我试图从 Control.DataContext 获取 DataContext

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/Resources/Text.xaml"/>
            <ResourceDictionary Source="/Resources/Layout.xaml"/>
            <ResourceDictionary Source="/Resources/Colours.xaml"/>
            <ResourceDictionary Source="/Resources/Icons.xaml"/>
        </ResourceDictionary.MergedDictionaries>

        <conv:OrientationConverter x:Key="OerientationConverter" IsOrientationRuleEnabled="{Binding Path=DataContext.IsSiteLayoutPhysical, RelativeSource={RelativeSource AncestorType={x:Type UserControl}, Mode=FindAncestor}}"/>
....
<ListView x:Name="operationsListView" ItemsSource="{Binding .}" DataContext="{Binding GroupedPlantItems}" ItemsPanel="{DynamicResource ItemsPanelTemplate1}" Panel.ZIndex="-10">
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.Panel >
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="{Binding Name, Converter={StaticResource OerientationConverter}}"/>
                        </ItemsPanelTemplate>
                    </GroupStyle.Panel>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="{x:Type GroupItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type GroupItem}">
                                        <GroupBox Header="{Binding Name}">
                                            <ItemsPresenter/>
                                        </GroupBox>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                </GroupStyle>
            </ListView.GroupStyle>
        </ListView> 
```

我在这里很棘手，并根据 IValueConverter 中定义的一些规则来改变 StackPanel 定位其内容的方式。我使用转换器上的绑定来禁用或启用 ViewModel 中的规则。我也可以通过这种方法设置规则，或者传递一个 lambda 表达式进行验证。请原谅我的错别字。

# hash - 哈希和盐碰撞

> ID：625542
> 
> 赞同：5
> 
> 时间：2009-03-09T09:27:03.313
> 
> 标签：hash, collision

我记得一个人告诉我，如果我让他更改 4 个字节，他可以使文件具有他想要的任何校验和（[CRC-32](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)）。

我听说过给哈希加盐。我想知道是否有人让他的文件与我的文件匹配，是否会加盐 MD5 或 SHA-1 哈希会改变结果，因此两个文件不再冲突？还是仅更改结束哈希值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T09:41:05.557

您正在混淆哈希值的两种不同用途：

*   用于防止随机（非恶意）错误的校验和。

*   计算用于存储密码、签名消息、证书的加密消息摘要......

CRC 是第一个应用程序的不错选择，但完全不适合第二个应用程序，因为它很容易计算冲突（用数学语言来说：CRC 是线性的）。这就是你的朋友本质上告诉你的。

MD5 和 SHA1 是用于第二种应用程序的加密哈希。但是，MD5 已经被破解，SHA1 现在被认为是弱的。尽管如此，即使 MD5 可以被破解，也需要很长时间才能找到 MD5 碰撞（几天到几周）。

至于盐，它通过混合一些随机的非秘密值来使加密哈希的计算本地化，这个值称为*盐*。这可以防止计算全局表，这使得从散列值计算可能的值（例如密码）变得容易。表格的计算非常昂贵，但如果没有加盐，成本将分摊到许多破解密码上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T09:41:53.247

如果您使用的哈希不是 CRC-32，则攻击（针对 CRC-32）是无关紧要的 - [MD5](http://en.wikipedia.org/wiki/MD5)和[SHA-1](http://en.wikipedia.org/wiki/SHA-1)不容易受到这种攻击（目前）。

当前针对 MD5 的攻击是攻击者创建两个具有相同哈希的文档。

盐用于密码验证——它们防止攻击者对密码数据库执行离线攻击——每个用户的密码在散列之前都有一个附加到纯文本的盐——然后是一个预先计算的明文彩虹表<->散列文本没用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T09:33:15.450

如果摘要函数已被破坏，则向哈希函数添加盐实际上并没有任何作用，因为必须将盐公开才能使用，并且攻击者也可以调整他们的文件以将其考虑在内。

这个问题的解决方案是使用安全散列函数。MD5 已证明容易受到哈希冲突的影响，但我相信 SHA-1 没有（到目前为止）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T09:34:45.603

加盐通常用于密码哈希以避免字典攻击。有很多基于 Web 的反向哈希字典，您可以在其中输入哈希（例如：1a79a4d60de6718e8e5b326e338ae533）并返回文本：“示例”。有了盐，这几乎是不可能的。如果您在密码前添加随机盐，字典攻击会变得更加困难。

至于冲突，我认为您不必担心整个文件具有相同的 md5 或 sha1 哈希。这并不重要。哈希的重要用途是证明您收到的文件与文件权威人士批准的文件相同。如果向文件中添加盐，则需要发送盐，以便用户可以验证哈希。

这实际上使攻击者*更容易*欺骗您的文件，因为他可以在虚假文件中提供虚假盐。用户通常可以判断该文件是否是伪造的，因为它不再发挥应有的作用。但是用户应该如何知道正确的盐和攻击者的盐之间的区别呢？

# windows-mobile - MS SQL REPLICATION 的替代选项

> ID：625548
> 
> 赞同：2
> 
> 时间：2009-03-09T09:28:34.557
> 
> 标签：windows-mobile, replication, windows-ce

我想问是否有任何替代 ms sql 复制的选项（这是我现在正在使用的）来复制数据。

创建用于复制的自定义架构是个好主意吗？

PS。替代选项必须支持在 Windows CE/Mobile 上运行的移动数据库

编辑：应用程序应该能够离线工作一段时间，然后根据用户的要求通过向服务器发送/接收所有新的/更新的数据来与服务器数据库同步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T09:36:09.233

根据您的要求，您有几个选择。

1) 日志传送，将中央数据库中的日志定期复制到其他服务器，并将该日志应用于数据库。这种方法只有在你有一个中央发布数据库和许多订阅数据库时才有效

2) 使用 SSIS 或 DTS 在数据库之间定期复制数据，这可以是双向的，只要您的密钥是唯一的，使用 GUID 或 ID 范围

3）分离中央数据库，将底层文件（数据和日志）复制到目标服务器。这具有使中央数据库离线的缺点，尽管是短暂的。

我认为为复制创建自定义架构是一个非常糟糕的主意，但是如果不知道您的要求是什么，就很难提出一个完整的解决方案。

# tfs - 免费在线 Team Foundation Server

> ID：625552
> 
> 赞同：51
> 
> 时间：2009-03-09T09:31:11.510
> 
> 标签：tfs, azure-devops, tfsbuild

任何人都可以推荐一个好的免费在线 Team Foundation Server 存储库吗？

我找到了[CodePlex](http://www.codeplex.com/)，但它仅适用于开源项目。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-05T21:01:10.837

最多五名团队成员是免费的。试试看 ：）

[http://tfs.visualstudio.com/](http://tfs.visualstudio.com/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-10-23T10:01:43.447

免费是托管在 Windows Azure 上的 TFS：http: [//tfspreview.com/](http://tfspreview.com/)

如果您需要有关 TFSPreview 的更多信息，请阅读 Brian Harry 的 MSDN 博客文章：http: [//blogs.msdn.com/b/bharry/archive/2011/09/14/team-foundation-server-on-windows-azure。 aspx](http://blogs.msdn.com/b/bharry/archive/2011/09/14/team-foundation-server-on-windows-azure.aspx)

要获得激活码，只需在此处注册或联系 MS ALM 团队的人员。

**更新：** *TFS Preview在此处作为***Visual Studio Online**上线并稳定运行：http : [//www.visualstudio.com](http://www.visualstudio.com)仍然对 5 名团队成员免费并构建服务器计算时间。另一个不错的功能自动构建和部署（每日或持续集成）到 Azure。更多信息：[http ://azure.microsoft.com/en-us/documentation/articles/cloud-services-continuous-delivery-use-vso/](http://azure.microsoft.com/en-us/documentation/articles/cloud-services-continuous-delivery-use-vso/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T09:55:01.873

Readify 曾经运行他们的 TFSNow 托管 TFS 服务，但我认为它不会再继续了。除了 CodePlex 之外，我听说过的唯一其他人不是免费的：

*   [阶段2](http://www.phase2.com/hosted_team_foundation_server_overview2.aspx)
*   [团队开发中心](http://www.teamdevcentral.com/overview.html)
*   [SaaS 变得简单](http://www.saasmadeeasy.com/tf_server.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-05-05T15:05:54.943

我知道这个帖子很旧，但由于谷歌搜索把我带到了这里，它也会对其他可能觉得这很有用的人有用。

微软最近推出了**Visual Studio Online**，对最多 5 个用户的项目免费：

[http://www.visualstudio.com/en-us/products/visual-studio-online-overview-vs.aspx](http://www.visualstudio.com/en-us/products/visual-studio-online-overview-vs.aspx)

我已经使用了一段时间，它与 Visual Studio 2013 完全集成。它也声称与其他 IDE 集成。除了 TFS，Git 也可以和它一起使用。

我知道这个帖子很旧，但是因为谷歌搜索把我带到了这里

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-25T09:45:12.453

VSO 现在是 Azure DevOps [https://visualstudio.microsoft.com/vso](https://visualstudio.microsoft.com/vso)

最近 Microsoft Visual Studio Online (VSO) 现在是 Azure DevOps

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-09T07:06:07.517

您可以免费使用[Visual Studio Team Services](https://www.visualstudio.com/vso/)。您还可以将 TFS 存储库导入此云空间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-06T07:34:52.870

[tfs.visualstudio.com](http://tfs.visualstudio.com)

这就是你想要的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T09:46:28.150

最近的[TFS Rocks](http://www.radiotfs.com/)播客之一提到了这样一个组织，可能是第 16 号。

# iphone - iPhone模拟器运行隐形

> ID：625557
> 
> 赞同：6
> 
> 时间：2009-03-09T09:32:34.470
> 
> 标签：iphone

iPhone 模拟器正在我的 Mac 上运行，但没有显示模拟器。两天前，我安装了 Mac OS X 10.5.6 更新。Xcode 正在模拟器中启动应用程序，并且它正在运行，因为我可以在 gdb 控制台窗口上看到输出。但是没有显示模拟器。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T12:45:03.600

尝试删除`~/Library/Preferences/com.apple.iphonesimulator.plist`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T02:31:57.933

有同样的问题。模拟器在屏幕外*的某个地方运行。*可以使用expose看到它，但无法移动它。

我没有使用对我不起作用的“检测显示器”，而是更改了屏幕分辨率并将其弹回原位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T12:19:17.097

您以前是否连接过外接显示器？也许 Mac OS X 上次运行时将模拟器窗口保存在屏幕外？

在 System Preferences 中，选择 Displays 并在模拟器运行时单击“Detect Displays”按钮。这应该会强制模拟器窗口出现在屏幕上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-30T16:31:53.383

除了这个古老的 IT 笑话之外，没有任何效果，**将其关闭并再次打开**！（完全重新启动整台机器对我有用）。

# c# - 任何真正的 Silverlight 项目？

> ID：625561
> 
> 赞同：6
> 
> 时间：2009-03-09T09:34:31.547
> 
> 标签：c#, .net, silverlight

来自 MS 本身资助/推动的项目的 Appart，是否有任何选择 Silverlight 的项目的真实示例？

你的经历是什么？学习曲线？好处？资源？陷阱？牺牲？

--EDIT--
我对开发中（团队）的故事最感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T09:41:34.743

上周我参加了一次会议，许多非 MS 人员讲述了他们将 Silverlight 用于业务线应用程序的经验。一般来说，这似乎是积极的。优势似乎是您可以从 Silverlight 版本开始，然后如果您（以后）需要更多的客户端控制，*通常*只需将 xaml 和应用程序代码复制到 WPF 中。**最**重要的是，因为目前存在一些故障。但是从 WPF 开始并移植到 Silverlight 要困难得多；-p

牺牲？对客户没有那么大的权力。有限的框架等 陷阱？不太兼容的 xaml。不同的IO等

我不能引用具体的项目，因为我根本没有把它们写下来；-p 此外，它们可能是公司私有的。知道它们的存在并不违反保密协议；-p

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T01:33:31.790

我刚刚回顾了[英国的 Silverlight 展示，这](http://silverlight.net/showcase/?appid=983&country=GB)是一个我非常了解的 IT 市场，有 31 个特色应用，细分看起来像这样

8 x 游戏 = 26%，6 x 实验和乐趣 = 19% - 例如圣诞贺卡和 Xaml XEyes，6 x 演示 = 19% - 例如 Deepzoom 图片，11 x 合理的网站 = 36%

实际上，整个英国的 31 个应用程序（其中只有大约三分之一是真实的）只是少量的开发。这可能表明几件事，

1) 英国没有发生严重的 Silverlight 开发，但可能在其他地方

2) 做严肃的 Silverlight 开发的公司不想使用微软的展示

3) 还没有发生太多严重的 Silverlight 开发

我的直觉是，Silverlight 需要一段时间才能成为主流，它是一项出色的技术，但用户不购买技术或功能，他们购买的是利益……我们需要几个杀手级 Silverlight 应用程序，然后它就会起飞就像 Ajax 所做的那样，一旦谷歌（和其他人）展示了方式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T09:45:33.300

查看[Microsoft Silverlight 展示](http://silverlight.net/showcase/)。似乎有相当多的 Silverlight 应用程序在野外。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T12:25:32.730

[Retouch Genie Ltd - 在线照片修饰和修复](http://www.retouchgenie.com)网站使用 Silverlight 作为其画廊和主要客户区。它有一个非常有趣的照片显示控件，非常好。这是前后图库的链接，可让您查看原始状态的照片以及[图像增强](http://www.retouchgenie.com/Content/Gallery.aspx)后的照片。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T12:47:07.640

我们正在开发一个与客户进行实时通信的 Silverlight 系统。我们遇到的问题是由于缺乏真实世界的示例以及从 VB 到 C# 的变化，因为 VB 中几乎没有文档。除此之外，它的开发非常好。考虑到它是一项全新的技术，一切都运行良好，开发时间非常快。我们期待下一个版本，它增强了视频处理能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-29T00:20:45.777

结帐 Silverlight 案例研究以了解开发人员故事：业务应用程序 - [http://www.microsoft.com/casestudies/Case_Study_Detail.aspx?casestudyid=4000004876](http://www.microsoft.com/casestudies/Case_Study_Detail.aspx?casestudyid=4000004876)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-08-18T00:01:43.760

我什至用 Silverlight 和 Java 混合开发了一个 Android 应用程序。如果没有 SL，那将是非常无聊，并且可能无法实现我想要实现的目标，请查看：[https ://market.android.com/details?id=uk.co.aloneguid.todash&feature=search_result](https://market.android.com/details?id=uk.co.aloneguid.todash&feature=search_result)

# linux - 在具有相同扩展名的文件集上应用 AWK

> ID：625563
> 
> 赞同：0
> 
> 时间：2009-03-09T09:34:48.787
> 
> 标签：linux, bash, unix, awk, file-globs

我想对扩展名为“*.txt”的文件应用以下“awk”命令

```
awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' 
```

但是为什么这个命令不起作用：

```
for i in *.txt do echo awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' $i; done 
```

一般，

```
awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' file1.txt 
```

会工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T09:47:21.080

删除回声后，它应该可以工作：

```
for i in *.txt do awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' $i; done 
```

如果有任何带有空格的文本文件，它将失败，你可以试试这个：

```
find . -name '*.txt' -print0 | xargs --null -n 1 awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' 
```

打印名称的替代方法：

```
find . -name '*.txt' -print -exec awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' {} \; 
```

（基本上 make find 直接执行 awk ，所以也打印出文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T10:06:01.753

```
for i in *.txt; do echo "$i"; awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' "$i"; done 
```

这将打印已处理文件的名称以及`awk`命令的输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T11:09:46.640

试试这个（在*Solaris上使用**nawk*或*/usr/xpg4/bin/awk*）：

 *```
awk 'END {
  printf "%s: %.2f\n", fn, sum
  }
FNR == 1 {
  if (fn) printf "%s: %.2f\n", fn, sum
  fn = FILENAME
  sum = 0
  }
$4 ~ /NM/ { 
  sum += $2 
  }' *.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T14:29:38.607

您需要添加一个';' ：

```
for i in *.txt; do ... 
```

代替

```
for i in *.txt do ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T09:46:24.763

不需要回声。

尝试

对于 *.txt 中的 i；做; awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' $i; 完毕

或者

对于 *.txt 中的 i；执行 awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' $i; 完毕

应该管用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T09:43:50.840

不知道你是复制粘贴还是打错了。

for i in *.txt do **echo** awk '$4 ~ /NM/{ sum += $2 } END{ print sum }' $i; 完毕

纠正回声后，上面的命令将回显您的 awk 脚本和文件名，但不会运行它。

# jboss - 使用嵌入式 Jboss 运行 JUnit 测试

> ID：625564
> 
> 赞同：1
> 
> 时间：2009-03-09T09:35:02.373
> 
> 标签：jboss, junit, embedded-jboss

我需要为使用 ejb3 bean 的类运行 junit 测试。在我们的例子中，仅仅为此目的设置 jboss 不是一种选择，因此我们需要一种替代方法来模拟 ejb 通信。我读过 Embedded Jboss 的 EJB3StandaloneBootstrapper 应该可以做到这一点，但问题是我无法让它正常工作。

我想知道你们中是否有人知道解释所有细节的好教程，包括如何配置各种文件（embedded-jboss-beans.xml、ejb3-interceptor-aop.xml 等）。嵌入式 jboss 包附带了一个带有示例代码的 junit 教程，但是其中的构建脚本失败了。如果您不知道教程，您至少知道在哪里可以找到嵌入式 jboss + junit 的工作示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:56:17.963

我做了一个[关于使用嵌入式 JBoss 的演示，](http://www.innovationontherun.com/presentation-files/ete2007-dimarco-java-ee-unit-testing.pdf)并下载了[示例代码](http://www.innovationontherun.com/presentation-files/ete2007-dimarco-staying-cutting-edge.pdf)。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-10T14:53:47.060

我相信[Jakarta Cactus](http://jakarta.apache.org/cactus "雅加达仙人掌")是运行此类测试的合适框架。

# .net - Web 服务返回类型意外更改

> ID：625565
> 
> 赞同：0
> 
> 时间：2009-03-09T09:35:40.077
> 
> 标签：.net, asp.net, web-services

我集成了一个返回多个数据表的 Web 服务。

当我更新 web 服务引用时，有时某些方法的返回类型会从 DataTable 更改为一个看起来像 2 项数组的类（一个用于模式，另一个用于数据表）。

在浏览器中，我们查看参考数据表如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <NormalMethodResponse xmlns="http://abc.com">
      <NormalMethodResult>
        <xsd:schema>schema</xsd:schema>xml</NormalMethodResult>
    </NormalMethodResponse>
  </soap:Body>
</soap:Envelope> 
```

但有问题的方法看起来像：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <ProblemmaticMethodResponse xmlns="http://abs.com">
      <ProblemmaticMethodResult>xmlxml</ProblemmaticMethodResult>
    </ProblemmaticMethodResponse>
  </soap:Body>
</soap:Envelope> 
```

通常这种有问题的方法会返回一个数据表，并且在 Web 参考更新之间不会更改。

任何人都知道为什么会这样？

**编辑：**我在另一台机器上更新 Web 参考后解决了这个问题。方法现在返回 DataTable。但仍然不知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:22:47.760

首先，返回 DataTable 或 DataSet 不是最佳实践，因为这些类型特定于 .NET。

其次，听起来 DataTable 所属的 DataSet 已更改为将其模式设置为包含模式。您可以尝试将 DataTable 显式创建为 DataSet 的一部分，并将 SchemaSerializationMode 设置为 ExcludeSchema。

# java - .Net vs Java 用于移动开发。你怎么看？

> ID：625567
> 
> 赞同：5
> 
> 时间：2009-03-09T09:36:17.643
> 
> 标签：java, .net, mobile

我在 .NET 中开发移动应用程序有一段时间了，我一直想知道另一边的草是否更绿（Java）。

因此，我想询问您对您的移动应用程序更喜欢哪一个的意见，为什么会这样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T10:33:24.540

使用 Java 的主要优势是更广泛的安装基础。如果您使用 Java，您将获得比使用 .NET 更多数量级的手机。

据我所知，.NET 只适用于 Windows Mobile 手机。

另一方面，Mobile .NET 比 Java（恕我直言）更容易，这部分是因为 Visual Studio IDE 比 Java World 上的任何其他开发环境都简单得多。例如，在 .NET 移动设备中执行基于表单的应用程序非常简单明了。

因此，答案基本上取决于您要完成的工作：

*   尝试覆盖最多的移动设备：使用 Java
*   尝试为 Windows Mobile 设备开发应用程序：使用 .NET
*   尝试开发一个仅在受控环境（单一业务）上运行的应用程序，您可以在该环境中决定它将运行的设备：决定您要使用的设备，然后选择开发环境。

请记住，如果您谈论的是用于 Android 或 Blackberry 开发的 Java，您将面临同样的问题，即无法像 .NET 那样获得庞大的安装基础。如果您想要庞大的安装基础，请使用纯 Java 移动版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:21:48.017

我只能代表 Windows 移动开发留在 .net 上。

Sun 甚至没有为 Windows 移动设备发布 JVM，我使用 java 为 Windows 设备开发，并使用[http://www2s.biglobe.ne.jp/~dat/java/project/jvm/index_en.html](http://www2s.biglobe.ne.jp/~dat/java/project/jvm/index_en.html)作为我的 JVM非常好作者甚至回应了我提出的功能要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T11:06:30.373

确实，如果您要为 WindowsMo​​bile 开发，J2ME 不是一个很好的选择。您选择的设备很可能不会附带 JVM，如果有，它会出现问题并且速度很慢。此外，忘记尝试与操作系统集成，而不仅仅是基本级别。

只是为了补充其他人所说的，Sun 已经提供了[phoneME](https://phoneme.dev.java.net/)，如果您想走这条路并将您的 MIDlet 和 VM 一起部署，那当然是可能的。在这一点上，这只是很多工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-14T18:07:56.520

对于 .NET 家伙 - 有一个**[Ubiq Mobile](http://ubiqmobile.com)框架**。Ubiq 移动应用程序适用于 Android、iOS、Windows Phone**和基于 Java 的手机和平板电脑**。这是使用 .NET 和基于云的架构的快速跨平台开发。入门文章：[如何](http://ubiqmobile.com/create-simple-ubiqmobile-application/)使用[视频](http://www.youtube.com/watch?v=VydBF3Th1RY)创建简单的 UbiqMobile 应用程序。

# apache-flex - 在flex的视频中嵌入动态文本

> ID：625568
> 
> 赞同：0
> 
> 时间：2009-03-09T09:36:18.547
> 
> 标签：apache-flex, video

我正在开发一个 flex 应用程序，其中一个人填写表单，文本动态添加到它旁边的视频预览中。

谁能告诉如何将表单中的文本动态添加到视频中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T09:45:23.800

您可以编写一个 JavaScript 方法，从表单中的不同字段返回值。然后，您可以通过 ActionScript 在页面上调用此 JavaScript 函数：

这是 Adob​​e 站点上文档的链接： [Calling JavaScript methods from Flex applications](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001009.html)

<mx:脚本>

```
import flash.external.*;

public function getFormValue(fieldName:String):String {
    var f:String = "jsGetFormValue";
    var m:String = ExternalInterface.call(f,fieldName);
    trace(m); 
} 
```

</mx:脚本>

页面上有以下 JavaScript 函数：

```
function jsGetFormValue(fieldName) {
  // note, this only handles form fields with a value property, the jQuery
  // interface for getting form value is short and more elegant
  return document.getElementById(fieldName);
} 
```

# command-line - 如何将命令的输出重定向到两个文件

> ID：625571
> 
> 赞同：20
> 
> 时间：2009-03-09T09:37:20.667
> 
> 标签：command-line, redirect

我需要将命令的输出重定向到两个文件，比如 file1 和 file2 file1 是一个新文件，而 file2 已经是现有文件，我需要在其中附加我尝试过的输出

这没有给出预期的结果：

```
command > file1 > file2 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-09T09:40:04.153

您正在寻找[`tee`](http://explainshell.com/explain?cmd=tee)命令。

```
$ echo existing >file2
$ date | tee file1 >> file2
$ cat file2
existing
Mon Mar  9 10:40:01 CET 2009
$ cat file1
Mon Mar  9 10:40:01 CET 2009
$ 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-09T09:39:48.320

对于 Windows (cmd.exe)：

```
command > file1 & type file1 >> file2 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T09:40:14.420

假设您使用的是类似 Linux 的系统，请尝试

```
command | tee file1 >> file2 
```

`tee`拆分输出流并将其发送到两个目的地。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T09:42:45.910

在 PowerShell 中使用`tee-object`（或其`tee`别名）

```
command | tee first-file | out-file second-file 
```

也可以发球到一个变量（例如，用于进一步处理）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-06-27T17:10:32.753

可以使用以下命令。命令 | tee -a 文件 1 文件 2

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T09:41:43.357

在 Linux 中，您可以这样做

`command | tee file1 >> file2`

# javascript - 如何仅在客户端从灵活的 xml 生成 html 中的树视图

> ID：625600
> 
> 赞同：4
> 
> 时间：2009-03-09T09:48:37.020
> 
> 标签：javascript, html, xml, xslt

谁能给我一个例子？我找到了很多，但它们不符合我的要求。

树视图必须有展开和折叠，xml是灵活的，这意味着我应该测试一个节点是否存在，并且有很多可能多次出现并且内容不同。另外，我需要它只在客户端工作，与服务器或网络无关。我想知道是否可以在左框架中显示树视图，在右框架中显示内容。

事实上，我需要这些文件，可能有 xslt、js、css 等要发送给用户，然后他们可以点击 xml 或 html 来查看他们的 owen xmls 的树视图（它们都有相同的 DTD）

十分感谢

艾伦

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T10:05:38.947

您要求提供示例...我可以提供在线示例的链接：

1.  [树形菜单](http://treemenu.net)
2.  [d树](http://destroydrop.com/javascripts/tree)
3.  [BlueShoes JS 树](http://blueshoes.org/en/javascript/tree)
4.  [Morten 的 JS 树](http://treemenu.org)
5.  [CodeThat 树](http://codethat.com/javascript-tree.html)- XML 支持。

如果您已将树加载到页面中，则可以使用左框架来加载该特定页面。

# edit - ResourceWriter 数据格式化

> ID：625605
> 
> 赞同：0
> 
> 时间：2009-03-09T09:52:13.003
> 
> 标签：edit, resx

我有一个`.resx`文件来更新一些数据。我可以通过`ResXResourceSet`对象从文件中读取数据，但是当我想将数据保存回来时，保存的数据格式无法识别。如何编辑`.resx`文件？谢谢。

```
 ResXResourceSet st = new ResXResourceSet(@"thepath");
  entries=new List<DictionaryEntry>();    
  DictionaryEntry curEntry ;

  foreach (DictionaryEntry ent in st)
  {

      if (ent.Key.ToString() == "Page.Title")
      {
          curEntry = ent;
          curEntry.Value = "change this one"
          entries.Add(curEntry);
      }
      else
      {
          entries.Add(ent);  
      }       
  }

  st.Close();
  System.Resources.ResourceWriter wr = new ResourceWriter(@"thepath");

  foreach (DictionaryEntry entry in entries)
  {
      wr.AddResource(entry.Key.ToString(), entry.Value.ToString());
  }

  wr.Close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T14:55:52.677

嗨，我再次搜索并发现..

ResourceWriter 将数据写入二进制类型 ResourceReader 将数据读取为二进制类型

ResXResourceWriter 以 xml 格式写入数据 ResXResourceReader 以 xml 格式读取数据

所以上面的例子使用 ResXResourceWriter,ResXResourceReader 而不是 ResourceReader ,ResourceWriter 将资源作为 xml 类型操作

# javascript - Javascript 图像库

> ID：625606
> 
> 赞同：0
> 
> 时间：2009-03-09T09:52:47.213
> 
> 标签：javascript

我正在寻找一个基于动态生成图像数组的javascript函数。目前我有一个预览窗口。

单击此按钮时，我希望它隐藏预览窗口并加载数组中的第一个图像。我希望能够浏览数组中的剩余图像。

如果有人能指出我正确的方向，或者如果你知道如何把它放在一起，那将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T10:12:23.577

您可以动态创建一个图像元素并继续使用它，像这样？（这是使用 jQuery）。

```
<button id='nextImage'>Load nect image</button>
<div id='imageContainer'><div id='previewWindow'>Preview</div></div>

//Javascript frome here (JQuery)
var images = Array();
images.push('url/to/image.jpg');
window.lastImage=-1;
$('#previewWindow').click( function() { ('#nextImage').click(); });
$('#nextImage').click( function() {
 window.lastImage += 1;
 if(typeof(images[window.lastImage]) == 'undefined') { return; } //if endof array
 $('#previewWindow').remove(); //better is to only do this once
 $('#image').remove(); //Only creating an image once is even better
 $('<img />')
  .attr('id', 'image')
  .attr('src', images[window.lastImage])
  .appendTo('#imageContainer');
}); 
```

**编辑**
刚刚阅读您希望能够单击预览窗口，补充说。

# c# - 如何返回通用抽象类？

> ID：625611
> 
> 赞同：1
> 
> 时间：2009-03-09T09:55:25.333
> 
> 标签：c#

我有这样的事情：

```
abstract class BaseClass<T>
{
    protected BaseClass(){}
}

class Class1 : BaseClass<Class1>
{
    public static Class1 Instance = new Class1();
    private Class1(){}          
}

class Class2 : BaseClass<Class2>
{
    public static Class2 Instance = new Class2();
    private Class2(){}      
}

...
public BaseClass<T> Method<T>(int z) where T: BaseClass<T>
{
    switch(z)
    {
        case 1: 
            return Class1.Instance;
        case 2:
            return Class2.Instance;
    }
} 
```

这是非常重要的，因为这些类不能被实例化，因为它们的委托人是私有的，所以我们不能这样做

`public BaseClass<T> Method<T>(int z) where T: BaseClass<T>,` **新的（）**

如何使用抽象类作为返回类型？我只是无法解决这个问题。在这里提供任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:11:18.417

在我看来，你真的不能让方法是通用的。例如，如果我打电话会发生什么：

```
BaseClass<Class1> foo = Method<Class1>(2); 
```

您需要一个单一的事实 - 类型参数或普通参数。您可以通过使用非泛型基类（通过使现有基类成为非泛型，或向其引入非泛型基类）来使其成为方法参数。将返回类型更改`Method`为此非泛型基类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:01:10.063

```
abstract class BaseClass<T>
{
    public abstract T Instance { get; }

    protected BaseClass(){}
} 
```

也许？我相信你不能继承静态的东西......

* * *

仔细一看……我认为你想要做的事情是不可能的……你到底想要做什么？

* * *

类型约束是类型约束。您正在尝试更改方法种类中的类型约束。这显然不起作用，也不应该起作用。我认为你需要考虑一种不同的方式来解决你的问题。不管是什么...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:04:42.690

看看[工厂模式](http://en.wikipedia.org/wiki/Factory_Pattern)。你的工厂可以有一个方法来获取实例。第一次调用它时，它会创建实例。在随后的调用中，它可以返回已经创建的实例。

# php - 如何在对象中搜索值？

> ID：625612
> 
> 赞同：1
> 
> 时间：2009-03-09T09:56:48.217
> 
> 标签：php, xml, search, object

我有一个通过 XML 文件的 PHP 脚本，但我希望能够在对象中搜索值，就像我可以在数组中搜索值一样。

根据 PHP.net 上的评论，array_search() 支持 PHP5 中的对象，但我无法让它工作。

XML 文件是公共汽车站的列表，我希望能够在匹配的公共汽车站之后搜索对象。

当前代码如下所示，仅列出停靠点：

```
$xml = new SimpleXMLElement(file_get_contents("StopPointList.xml"));

foreach ($xml->StopPoint as $stop)
{
    echo $stop->StopName.'<br />';
} 
```

作为参考，公交车站 XML 文件如下所示：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<StopPointList NetworkVersion="20080828">
    <StopPoint>
        <DISID>3012086:2</DISID>
        <PositionNumber>2</PositionNumber>
        <StopPointName>2</StopPointName>
        <StopName>Sinsenveien</StopName>
    </StopPoint>
    <StopPoint>
        <DISID>2160364:2</DISID>
        <PositionNumber>2</PositionNumber>
        <StopPointName>2</StopPointName>
        <StopName>Rogneskjær</StopName>
    </StopPoint>
</StopPointList> 
```

我希望能够像这样进行类似 MySQL 的搜索：%search%

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:03:47.250

我想说这就是 XPath（[规范](http://www.w3.org/TR/xpath)/[教程](http://www.w3schools.com/XPath/default.asp)）的用途。

例如：要查找名称包含 的所有停止点`"Sinsen"`，这将是要使用的 XPath 表达式：

```
//StopPoint[contains(StopName, 'Sinsen')]

```

在 PHP 中，您可以使用[SimpleXML ( `SimpleXMLElement::xpath`)](http://uk3.php.net/manual/en/function.simplexml-element-xpath.php)来完成。

# scripting - 如何编写批处理文件以按时间删除文件夹和文件？

> ID：625613
> 
> 赞同：2
> 
> 时间：2009-03-09T09:57:06.593
> 
> 标签：scripting, batch-file

### 精确重复：

*   [如何编写批处理文件以从文件夹中删除 5 天或更早的文件？](https://stackoverflow.com/questions/661447/)
*   [编写批处理文件以从文件夹中删除 6 天前的文件](https://stackoverflow.com/questions/662607/)
*   [编写一个批处理文件以从文件夹中删除 5 天的旧文件](https://stackoverflow.com/questions/659770/)
*   [如何创建将按计划删除文件夹的批处理脚本？](https://stackoverflow.com/questions/615008/)
*   [编写一个批处理文件以按日期和时间删除文件夹。](https://stackoverflow.com/questions/613803/)
*   [编写脚本从文件夹中删除比当前日期早 5 天的文件](https://stackoverflow.com/questions/658717/)

我想写一个批处理文件来按时删除文件夹、子文件夹和临时文件。

条件是这样的：

*   我需要在当前运行时间前一小时从文件夹中删除文件。
*   我想从系统中获取当前时间并删除文件前一小时
*   文件格式是这样的：`<file name> <date>`
*   时间格式是`dd-mm-yyyy-hh-mm`或`dd-mm-yy-hh-mm`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:00:42.763

Batch 可能非常强大，但我认为您想要的那种日期操作并不实用。

您可以使用`FOR`将日期拆分为元素，然后用于`SET /A`进行减法运算，但是您将需要大量的`IF`and`GOTO`语句来处理例如从 1 月 1 日午夜半点减去一个小时的情况。

我认为您最好调查[VBS](http://www.mhuffman.com/notes/language/vbs_intro.htm)或[Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-31T15:37:59.500

您可能想尝试使用此脚本从文件夹中删除超过 1 小时的文件。

```
# Script Delete1Hour.txt
var str folder, list, file
cd $folder
lf -n "*" $folder ($ftype=="f") AND ( $fmtime < addtime(diff("-10000")) ) > $list
while ($list <> "")
do
    lex "1" $list > $file
    system del ("\""+$file+"\"")
done 
```

这是双标。重要的命令是

```
lf -n "*" $folder ($ftype=="f") AND ( $fmtime < addtime(diff("-10000")) ) 
```

这告诉 biterscripting - 给我文件夹 $folder 中的所有条目，其名称与文件类型为“f”（平面文件，而不是目录）的模式“*”匹配，并且其文件修改时间 ($fmtime) 早于 1 小时. [请参阅http://www.biterscripting.com/helppages/lf.html](http://www.biterscripting.com/helppages/lf.html)上的 lf 命令文档。

将脚本保存在文件 C:/Scripts/Delete1Hour.txt 中，运行为

```
script  "C:/Scripts/Delete1Hour.txt" folder("C:/testfolder") 
```

它将删除 C:/testfolder 中所有超过 1 小时的文件。

# iis - 有没有办法在 web.config 中配置应用程序池的“空闲超时”？

> ID：625614
> 
> 赞同：15
> 
> 时间：2009-03-09T09:57:36.500
> 
> 标签：iis, web-config, application-pool, python-idle

我知道可以设置会话超时。但是，如果应用程序本身在给定的时间段内没有收到任何请求，IIS 将关闭应用程序。

此行为可在 IIS 管理控制台中配置，我知道如何执行此操作。不过，我想知道是否可以在 web.config 中进行配置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T19:51:00.240

不在 IIS 6 中。在 IIS 6 中，应用程序池由工作进程控制，工作进程映射到由 HTTP.sys 处理的请求队列。HTTP.sys 处理与 WWW 服务器的通信以确定何时启动和停止工作进程。

由于 IIS 6 是在 .Net 之前创建的，因此 .Net 和低级 http 处理程序之间没有通信挂钩。

ASP.net 被实现为 ISAPI 过滤器，由工作进程本身加载。如果您正在查看控制工作进程的 web.config，则会遇到先有鸡的问题。这主要是为什么 MS 对 IIS 7 进行了重大重写，它在整个请求生命周期中集成了 .Net，而不仅仅是 ISAPI 过滤器部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T18:53:50.500

您可以编辑这些设置，但不能在 web.config 中编辑。如果您有 IIS7，则设置在 applicationHost.config 中，关键属性是**shutdownTimeLimit**。
你可以谷歌一下，了解如何使用 appcmd 和其他工具来设置或更改它。

[例子](http://www.iis.net/ConfigReference/system.applicationHost/applicationPools/add/processModel)

您也可以通过编辑\inetsrv\config 目录中的applicationHost.config 文件直接修改shutdownTimeLimit。

applicationHost.config 文件的架构位于 \inetsrv\config\schema\IIS_schema.xml 文件中。
所以在你最喜欢的模式感知 XML 编辑器中打开它，你会得到智能感知等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T07:14:17.843

您可以通过设置 IdleTimeout 来做到这一点。 **但是**，对 processModel 元素的更改仅在重新启动工作进程时才会生效，而不是在设置更改后立即生效，就像其他配置元素一样。你可以在这里看到它： [processModel 元素](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)

您还必须更改 machene.config 才能从其他存档编辑机器配置。

# c++ - 模板中的模板默认参数

> ID：625616
> 
> 赞同：0
> 
> 时间：2009-03-09T09:58:00.460
> 
> 标签：c++, templates

我正在尝试编译这个：

```
template <class T, class U = myDefaultUClass<T> >
class myClass{
 ...
}; 
```

尽管对我来说这似乎很直观，但它不适用于我的编译器，但有人知道该怎么做吗？

**编辑：**好的，问题实际上不是来自于此，而是来自残余尝试......对此感到抱歉，无论如何感谢您的回答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T10:05:06.933

以下适用于我使用 g++。请发布更多代码、您收到的错误消息和编译器版本。

```
class A {};

template <class T> class T1 {};

template <class T, class U = T1<T> > class T2 {
};

T2 <A> t2; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T10:02:53.523

[用Comeau](http://www.comeaucomputing.com/tryitout/)编译得很好......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:08:47.190

这适用于 MSVC 9.0：

```
template < class T >
class UClass
{
private:
    T m_data;
};

template < class T, class U = UClass< T > >
class MyClass 
{
public:
    const U& data() const { return m_data; }
private:

    U m_data;
};

int main()
{
    MyClass< int > test;

    const UClass<int>& u = test.data();

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T10:09:48.500

要么你的编译器不是标准的抱怨，要么你犯了以下错误之一：

1.  myDefaultUClass 不是模板
2.  myDefaultUClass 未定义

因为以下在 G++ 中可以正常工作：

```
class myDefaultUClass{};

template <class T, class U = myDefaultUClass >
class myClass{
 //...
}; 
```

# .net - .NET 的字典（名称、项目等单词）库？

> ID：625617
> 
> 赞同：2
> 
> 时间：2009-03-09T09:58:41.240
> 
> 标签：.net, random

我正在寻找一个可以在 .NET 中用于检索随机名称字符串（约翰、彼得）、项目（表、瓶）、对象等的库

我想在数据库填充操作中使用它，并且要求数据应该看起来真实。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:15:00.343

如果您使用的是 SQL Server，也许可以尝试使用 AdventureWorks 等示例数据库之一，例如

```
select top 10 FirstName, LastName
from AdventureWorks.Person.Contact order by newid() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:05:12.177

这不是一个 .NET 库，但您可以尝试 Red Gate 的[SQL 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:14:47.753

您的要求足够具体，因此很明显没有内置库可以完成这项工作。但是，您可以从 Internet 下载姓名列表（名字/姓氏）并将其提供给您的数据库。

一个这样的名单可以在[这里](http://www.census.gov/genealogy/names/)找到。此外，[Namepedia](http://www.namepedia.org/en/firstname/)和[Randomnames.com](http://www.randomnames.com/allnames.asp?g=m)等网站可能会有所帮助。

# sql-server-express - SQL Server 端口

> ID：625618
> 
> 赞同：1
> 
> 时间：2009-03-09T09:59:50.473
> 
> 标签：sql-server-express, firewall

我们最近在我们的网络上安装了声波防火墙。我们有一个配置为侦听动态端口的 SQL 2005 express 服务器。在其配置管理器中，动态端口号设置为 1067，其默认端口仍为 1433。

据我了解，我们需要打开以下端口才能使其工作：

> TCP 1433
> 
> TCP 1067
> 
> UDP 1434

问题是我们仍然无法从外部连接到服务器。当我们关闭/断开防火墙时，我们可以访问服务器。

这告诉我 SQL 服务器的设置很好，问题一定是我们在防火墙上缺少的某个端口。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T10:19:36.057

从 MS-DOS 命令发出 netstat -an 并尝试查找在文章中给出的所有打开的端口

[http://support.microsoft.com/kb/287932](http://support.microsoft.com/kb/287932)

并配置 SQL 2005 以允许在

[http://support.microsoft.com/kb/914277](http://support.microsoft.com/kb/914277)

根据这些文章，这些可能会有所帮助：

防火墙上的客户端-服务器通信 设置客户端以通过防火墙与 SQL Server 通信是一个简单的三步过程：

使 SQL Server 侦听 TCP（默认为 1433）或 RPC（默认为大于 1023 的随机端口）上的特定端口。您必须在此更改后循环服务器。配置您的防火墙服务器以允许特定 .

使客户端（在防火墙的另一端）使用适当的连接字符串与服务器上的会话。您还可以使用客户端配置实用程序添加带有相应网络库和连接字符串的“高级”条目。

# c# - 在 .Net 中与 IIS SMTP 服务器进行有意义的交互

> ID：625619
> 
> 赞同：4
> 
> 时间：2009-03-09T09:59:51.580
> 
> 标签：c#, iis, smtp

我们的企业每周都会向大量订阅者发送新闻通讯。当公司还很年轻时，在我加入之前，他们使用了一些群发邮件的“免费”版本，需要六个小时才能发送 5000 封邮件，并且违反了互联网上的每一次反向 DNS 检查。

我将其升级为一个定制的 .Net 小部件，该小部件在正确的服务器上运行，并且可以在半小时内发送多达 2 万封邮件，并且完全符合 DNS 要求。不幸的是（或者幸运的是，取决于你的观点）我们的邮件列表现在已经超出了这个简单的工具。特别是它缺乏足够的节流，它可以发出比服务器一次轻松发送的邮件更多的邮件。我需要实际监控 IIS SMTP 服务器的可用外发邮件存储分配的满载情况，并相应地限制负载。

不幸的是，我找不到有关邮件对象何时（或即使）变成邮件的信息。如果我有地方可以观看，我可以实现一个文件系统观察器，目前我没有。如果没有创建实际的邮件文件，我想我将不得不创建一个来实现该功能，但我需要知道将它放在哪里。允许系统以某种方式确认发送也会更让人放心，但我不知道如何从系统中检索表明邮件已发送的数据。

广泛的谷歌搜索在这些方面被证明是模糊的；所以我想知道这里是否有人知道我可以从哪里获得这些问题的指南，或者可以指出我正确的方向。

非常感谢。

编辑：最后我放弃了尝试测量 IIS SMTP 服务器上的吞吐量作为一项糟糕的工作。只是好像不想玩。我现在在一个单独的位置进行登录，然后将其分流到 SMTP 服务器。我仍然不知道有谁真正费心试图密切关注 IIS SMTP 服务器的行为，所以在撰写本文时这个问题没有得到解答。

那好吧...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-27T11:08:56.730

好的，所以我已经为这个项目工作了很长时间，我想我可以与全世界分享我的发现。

**IIS SMTP 服务器**

首先，使用 IIS SMTP 服务器创建的所有邮件都会发送到 Pickup Directory。如果您要发送一封邮件，那么您将不得不在 Matrix 时间操作才能真正看到它，因为它可能会马上消失。

在单独的邮件出门时，它会通过 IIS 中的队列文件夹。

如果您想查看性能计数器来监控此过程，您可以查看“远程队列长度”。（原因是“本地队列长度”监视网络内“本地”发送的邮件。在这种情况下，“远程”指的是“外部世界”。“本地”的具体定义在我们发送时我忽略了没有本地邮件，但我想这意味着排队进入服务器上特定安装的 IIS 或其任何本地分组中包含的邮​​箱。）

从 Exchange 的角度来看，它似乎相当于在 Exchange 域内发送的邮件以及从该域发送到更广阔世界的邮件。

无论如何。远程队列长度并不能说明全部情况。您还必须查看远程重试队列、当前出站连接数，以及队列目录中的实际文件数。

原因如下：

*   远程队列：所有尚未发送的消息，无论尝试过多少次。当前分配给任何打开的连接的邮件数量不计算在内，因为它们处于“正在尝试”状态。
*   远程重试队列：所有尚未发送的消息，在过去的某个时间点，已分配给打开的连接以进行传递。显然，传递一定是失败了，否则消息就会被传递。当前分配给打开连接以进行重试的任何消息均不计算在内。
*   当前出站连接：显示当服务器尝试发送排队的邮件时，可以将多条消息分配给出站连接。如此分配的消息不计入远程队列或远程重试队列。身体的
*   队列目录中的文件：这显示仍在队列目录中的邮件数。随着邮件成功投递，这将减少。

*示例：*如果队列目录中有 0 个出站连接和 50 封邮件，则远程队列、重试队列和物理文件都将读取为 50。当引发重试标志（这是 IIS 中的设置）时，连接数会增加并且队列中的邮件数量减少。在发送邮件之前，物理文件的数量保持不变。但是，由于当前连接可以发送多个邮件，因此 1 个连接可能会导致远程队列和重试队列长度为 47 或更低。如果在重试事件期间，任何邮件都已成功投递，则 Queue 目录中的物理文件数量将会减少。当连接关闭时，队列计数器应该再次稳定下来。

**日志记录**

.Net 的邮件库可以指定与 IIS 默认值分开的分拣目录。在这里，您可以将邮件排队并获得定制服务，以偶尔将邮件移动到 IIS 服务将接管并发送排队邮件的 IIS 目录。

为此，您将寻找 SmtpClient 对象的“DeliveryMethod”属性，该属性应设置为 SmtpDeliveryMethod.SpecifiedPickupDirectory。

要实际设置 SpecifiedPickupDirectory，您应该设置 SmtpClient 的 PickupDirectoryLocation 属性。

当邮件被传送到这个位置时，它们被存储为 .eml 文件。文件名是一个 GUID。这意味着多封电子邮件将以基本上随机的顺序发送。理论上，如果需要，您可以编写代码来解决这种情况。.eml 文件遵循标准格式，可以通过在记事本中打开 .eml 来读取。解析这将允许您提取日志信息。

我希望这篇关于 IIS 中 SMTP 服务器工作方式的高级概述对与我在三月份所处的位置相似的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T10:28:44.507

我会使用[PerformanceCounter](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx)组件来读取 SMTP 服务的**本地队列长度**计数器。这应该让你控制住:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:29:06.423

如果您的 .net 小部件是定制的，为什么不将其输出限制为某些（可定义的）吞吐量？

作为替代方案，您也许可以修改 SMTP 服务器的一些注册表设置。

[http://blog.rednael.com/CommentView,guid,dc20366c-3629-490a-a8ee-7e8f496ef58b.aspx](http://blog.rednael.com/CommentView,guid,dc20366c-3629-490a-a8ee-7e8f496ef58b.aspx)

显然还有一些 WMI 计数器（SMTP Server\Remote Queue Length 和 SMTP Server\Remote Retry Queue Length）可以为您提供有用的信息。

[http://www.tech-archive.net/Archive/Internet-Server/microsoft.public.inetserver.iis.smtp_nntp/2008-02/msg00011.html](http://www.tech-archive.net/Archive/Internet-Server/microsoft.public.inetserver.iis.smtp_nntp/2008-02/msg00011.html)

# iphone - 访问 iPhone 音乐库

> ID：625625
> 
> 赞同：8
> 
> 时间：2009-03-09T10:01:22.060
> 
> 标签：iphone

我正计划开发一种从音乐库加载音乐的 DJ 应用程序。当然，它会在应用商店出售。

所以问题是，它可以在 AppStore 中分发吗？

我发现它至少在大约 6 个月前是被禁止的……但我希望现在有可能……

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T10:20:15.087

在 iPhone OS 2.x 中，您无法访问通过 iTunes 传输到手机的音乐。您只能访问由您自己的应用程序创建的数据。

即将发布的 3.0 版确实具有此功能。[发行说明](http://developer.apple.com/iphone/prerelease/library/releasenotes/General/WhatsNewIniPhoneOS/Articles/iPhoneOSv3.html#//apple_ref/doc/uid/TP40008245-SW4)包括此

> **iPod 库访问**
> 
> 媒体播放器框架 (MediaPlayer.framework) 中添加了几个新的类和协议，以允许访问用户的音频库。您可以使用这些类来执行以下任务：
> 
> *   播放用户库中的音频项目。这种支持让您可以播放 iPod 应用程序支持的所有音频类型。
> *   构建要播放的音频项目队列。
> *   搜索用户的音频库。
> *   访问用户的播放列表（包括智能播放列表、移动播放列表和天才播放列表）。
> 
> 有关媒体播放器框架类的更多信息，请参阅 [媒体播放器框架参考](http://developer.apple.com/iphone/prerelease/library/documentation/MediaPlayer/Reference/MediaPlayer_Framework/index.html#//apple_ref/doc/uid/TP40006952)。

*（抱歉，链接可能仅适用于注册的 Apple 开发人员）。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T13:39:46.350

在 iPhone SDK 3.0 版中，您现在可以访问音乐库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T07:51:25.500

SDK 3.0 的媒体库框架只允许您对音乐进行最基本的 iPod 控制。您甚至无法输出 .mp3 并自己处理（使用 OpenAL 等）。

所以基本上，它的控制能力只能和 iPod 一样强大，这对于任何 DJ 应用来说都太有限了。

否则，我会梦想制作出唱盘史上最令人惊叹的便携式 DJ 设备。希望我们能在 SDK 3.1 中看到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-28T21:45:12.173

只是把它放在那里：

如果你想使用 PrivateFrameworks 并为它制作一个应用程序，那么有一个名为 MusicLibrary 的私有框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T11:38:51.270

要创建 DJ 应用程序，您是否不需要一次加载多首歌曲然后相互叠加播放的能力？

据我所知，SDK 一次只允许您加载 1 首曲目。

# vim - vim 输入带有制表符的新行

> ID：625636
> 
> 赞同：0
> 
> 时间：2009-03-09T10:05:26.293
> 
> 标签：vim, newline, editing

可以说我有这段文字

```
public function __construct() {
    parent::__construct();
} 
```

我想在同一级别的 parrent::construct 上方插入一个新行。像：

```
public function __construct() {
    // this is the new line. 
    parent::__construct();
} 
```

我怎样才能做到这一点。我尝试在命令模式下执行`Ctrl`+ `Enter`，但这也会将 { 向下移动。我设法通过将光标移到父级的开头并执行`Ctrl`+来做到这一点`Enter`。当光标位于第一行的末尾时，没有办法吗？还是快速跳到父母的捷径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T10:10:23.833

尝试`O`并`o`在正常模式下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T10:07:56.833

也许你应该启用自动缩进？这可能会解决你的问题。

在您的 .vimrc 文件中：

```
:set autoindent 
```

# hash - 什么哈希是常见的哈希？在网络和其他程序上使用？

> ID：625640
> 
> 赞同：11
> 
> 时间：2009-03-09T10:06:48.757
> 
> 标签：hash

我在网上看到了 MD5 和 SHA1 哈希来验证文件。网络和其他程序上使用的常见哈希是什么？这是为了验证文件不散列密码。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-09T11:02:54.470

我以前使用过以下站点的一些哈希函数 - 它们通常很快，并且在网站上给出了完整的代码，并描述了每个函数及其优势/劣势：

[http://www.partow.net/programming/hashfunctions](http://www.partow.net/programming/hashfunctions/ "http://www.partow.net/programming/hashfunctions")

给出的哈希示例是 - Kernighan 和 Ritchie（来自“C 编程语言”）和 Knuth 哈希（来自“计算机编程艺术卷 3”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T10:10:33.863

要验证文件，您可以使用[循环冗余检查](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)，例如 CRC32，据我所知，如果您想查看除 MD5/SHA 之外的其他内容，那么它在 IT 中长期以来一直是散列文件的事实标准.

有关检查文件的更多方法，另请参阅此[校验和算法列表。](http://en.wikipedia.org/wiki/List_of_hash_functions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:09:09.687

我从来没有用过MD5以外的任何东西。如果您将其用于密码，请添加盐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T10:13:42.623

维基百科有一个[散列函数列表，](http://en.wikipedia.org/wiki/List_of_hash_functions)分为不同类型（校验和、非加密、加密等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T10:19:03.810

Apache 基金会（以及其他）使用[PGP 签名](http://en.wikipedia.org/wiki/Pretty_Good_Privacy#Digital_signatures)。

# amazon-ec2 - 如何从 ec2 实例中获取实例 ID？

> ID：625644
> 
> 赞同：421
> 
> 时间：2009-03-09T10:08:06.367
> 
> 标签：amazon-ec2, amazon-web-services

如何`instance id`从 ec2 实例中找出 ec2 实例？

* * *

## 回答 #1

> 赞同：582
> 
> 时间：2009-03-09T21:04:30.233

请参阅[有关该主题的 EC2 文档](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)。

跑：

```
wget -q -O - http://169.254.169.254/latest/meta-data/instance-id 
```

如果您需要从脚本中以编程方式访问实例 ID，

```
die() { status=$1; shift; echo "FATAL: $*"; exit $status; }
EC2_INSTANCE_ID="`wget -q -O - http://169.254.169.254/latest/meta-data/instance-id || die \"wget instance-id has failed: $?\"`" 
```

下面是一个更高级的使用示例（检索实例 ID 以及可用区和区域等）：

```
EC2_INSTANCE_ID="`wget -q -O - http://169.254.169.254/latest/meta-data/instance-id || die \"wget instance-id has failed: $?\"`"
test -n "$EC2_INSTANCE_ID" || die 'cannot obtain instance-id'
EC2_AVAIL_ZONE="`wget -q -O - http://169.254.169.254/latest/meta-data/placement/availability-zone || die \"wget availability-zone has failed: $?\"`"
test -n "$EC2_AVAIL_ZONE" || die 'cannot obtain availability-zone'
EC2_REGION="`echo \"$EC2_AVAIL_ZONE\" | sed -e 's:\([0-9][0-9]*\)[a-z]*\$:\\1:'`" 
```

您也可以使用`curl`代替`wget`，具体取决于您的平台上安装的内容。

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2013-05-13T17:35:47.320

在 Amazon Linux AMI 上，您可以执行以下操作：

```
$ ec2-metadata -i
instance-id: i-1234567890abcdef0 
```

或者，在 Ubuntu 和其他一些 linux 风格上，`ec2metadata --instance-id`（在 ubuntu 上默认情况下可能不会安装此命令，但您可以添加它`sudo apt-get install cloud-utils`）

顾名思义，您也可以使用该命令获取其他有用的元数据。

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2012-05-15T12:26:16.913

在 Ubuntu 上，您可以：

```
sudo apt-get install cloud-utils 
```

然后你可以：

```
EC2_INSTANCE_ID=$(ec2metadata --instance-id) 
```

您可以通过以下方式获取与实例关联的大部分元数据：

```
ec2metadata --帮助
语法：/usr/bin/ec2metadata [选项]

查询和显示 EC2 元数据。

如果没有提供选项，将显示所有选项

选项：
    -h --help 显示此帮助

    --kernel-id 显示内核ID
    --ramdisk-id 显示 ramdisk id
    --reservation-id 显示预订ID

    --ami-id 显示ami id
    --ami-launch-index 显示 ami 启动索引
    --ami-manifest-path 显示 ami 清单路径
    --ancestor-ami-ids 显示 ami 祖先 id
    --product-codes 显示 ami 关联的产品代码
    --availability-zone 显示 ami 放置区域

    --instance-id 显示实例id
    --instance-type 显示实例类型

    --local-hostname 显示本地主机名
    --public-hostname 显示公共主机名

    --local-ipv4 显示本地ipv4 ip地址
    --public-ipv4 显示公共 ipv4 ip 地址

    --block-device-mapping 显示块设备ID
    --security-groups 显示安全组

    --mac 显示实例mac地址
    --profile 显示实例配置文件
    --instance-action 显示实例操作

    --public-keys 显示 openssh 公钥
    --user-data 显示用户数据（实际上不是元数据）

```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2014-02-21T20:09:24.717

`/dynamic/instance-identity/document`如果您还需要查询的不仅仅是您的实例 ID，请使用URL。

`wget -q -O - http://169.254.169.254/latest/dynamic/instance-identity/document`

这将为您提供这样的**JSON**数据 - 只需一个**请求**。

```
{
    "devpayProductCodes" : null,
    "privateIp" : "10.1.2.3",
    "region" : "us-east-1",
    "kernelId" : "aki-12345678",
    "ramdiskId" : null,
    "availabilityZone" : "us-east-1a",
    "accountId" : "123456789abc",
    "version" : "2010-08-31",
    "instanceId" : "i-12345678",
    "billingProducts" : null,
    "architecture" : "x86_64",
    "imageId" : "ami-12345678",
    "pendingTime" : "2014-01-23T45:01:23Z",
    "instanceType" : "m1.small"
} 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2013-11-11T18:02:07.123

在 AWS Linux 上：

`ec2-metadata --instance-id | cut -d " " -f 2`

输出：

`i-33400429`

在变量中使用：

```
ec2InstanceId=$(ec2-metadata --instance-id | cut -d " " -f 2);
ls "log/${ec2InstanceId}/"; 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2017-11-01T09:52:39.493

对于所有 ec2 机器，可以在文件中找到实例 ID：

```
 /var/lib/cloud/data/instance-id 
```

您还可以通过运行以下命令获取实例 ID：

```
 ec2metadata --instance-id 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2012-03-10T16:52:52.247

对于`.NET`人：

```
string instanceId = new StreamReader(
      HttpWebRequest.Create("http://169.254.169.254/latest/meta-data/instance-id")
      .GetResponse().GetResponseStream())
    .ReadToEnd(); 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2012-07-13T15:36:30.457

对于 powershell 人：

```
(New-Object System.Net.WebClient).DownloadString("http://169.254.169.254/latest/meta-data/instance-id") 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2013-06-20T03:48:02.670

对于 Python：

```
import boto.utils
region=boto.utils.get_instance_metadata()['local-hostname'].split('.')[1] 
```

归结为单线：

```
python -c "import boto.utils; print boto.utils.get_instance_metadata()['local-hostname'].split('.')[1]" 
```

除了 local_hostname，您还可以使用 public_hostname，或者：

```
boto.utils.get_instance_metadata()['placement']['availability-zone'][:-1] 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2009-03-09T21:04:19.673

请参阅[这篇文章](http://www.cloudiquity.com/2009/02/finding-information-about-an-amazon-ec2-instance/)- 请注意，给定 URL 中的 IP 地址是恒定的（起初让我感到困惑），但返回的数据特定于您的实例。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2015-10-21T10:32:43.040

只需键入：

```
ec2metadata --instance-id 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2013-02-14T23:40:18.330

对于红宝石：

```
require 'rubygems'
require 'aws-sdk'
require 'net/http'

metadata_endpoint = 'http://169.254.169.254/latest/meta-data/'
instance_id = Net::HTTP.get( URI.parse( metadata_endpoint + 'instance-id' ) )

ec2 = AWS::EC2.new()
instance = ec2.instances[instance_id] 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2014-08-26T22:23:36.540

更现代的解决方案。

已经从 Amazon Linux 安装了 ec2-metadata 命令。

从航站楼

```
ec2-metadata -help 
```

将为您提供可用的选项

```
ec2-metadata -i 
```

将返回

```
instance-id: yourid 
```

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2016-06-01T18:01:14.937

最新的 Java SDK 具有`EC2MetadataUtils`：

在 Java 中：

```
import com.amazonaws.util.EC2MetadataUtils;
String myId = EC2MetadataUtils.getInstanceId(); 
```

在斯卡拉：

```
import com.amazonaws.util.EC2MetadataUtils
val myid = EC2MetadataUtils.getInstanceId 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2011-08-11T16:24:16.990

你可以试试这个：

```
#!/bin/bash
aws_instance=$(wget -q -O- http://169.254.169.254/latest/meta-data/instance-id)
aws_region=$(wget -q -O- http://169.254.169.254/latest/meta-data/hostname)
aws_region=${aws_region#*.}
aws_region=${aws_region%%.*}
aws_zone=`ec2-describe-instances $aws_instance --region $aws_region`
aws_zone=`expr match "$aws_zone" ".*\($aws_region[a-z]\)"` 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2013-12-04T03:07:08.763

我为来自 http api 的 EC2 元数据编写的 c# .net 类。我将根据需要使用功能构建它。如果你喜欢，你可以带着它跑。

```
using Amazon;
using System.Net;

namespace AT.AWS
{
    public static class HttpMetaDataAPI
    {
        public static bool TryGetPublicIP(out string publicIP)
        {
            return TryGetMetaData("public-ipv4", out publicIP);
        }
        public static bool TryGetPrivateIP(out string privateIP)
        {
            return TryGetMetaData("local-ipv4", out privateIP);
        }
        public static bool TryGetAvailabilityZone(out string availabilityZone)
        {
            return TryGetMetaData("placement/availability-zone", out availabilityZone);
        }

        /// <summary>
        /// Gets the url of a given AWS service, according to the name of the required service and the AWS Region that this machine is in
        /// </summary>
        /// <param name="serviceName">The service we are seeking (such as ec2, rds etc)</param>
        /// <remarks>Each AWS service has a different endpoint url for each region</remarks>
        /// <returns>True if the operation was succesful, otherwise false</returns>
        public static bool TryGetServiceEndpointUrl(string serviceName, out string serviceEndpointStringUrl)
        {
            // start by figuring out what region this instance is in.
            RegionEndpoint endpoint;
            if (TryGetRegionEndpoint(out endpoint))
            {
                // now that we know the region, we can get details about the requested service in that region
                var details = endpoint.GetEndpointForService(serviceName);
                serviceEndpointStringUrl = (details.HTTPS ? "https://" : "http://") + details.Hostname;
                return true;
            }
            // satisfy the compiler by assigning a value to serviceEndpointStringUrl
            serviceEndpointStringUrl = null;
            return false;
        }
        public static bool TryGetRegionEndpoint(out RegionEndpoint endpoint)
        {
            // we can get figure out the region end point from the availability zone
            // that this instance is in, so we start by getting the availability zone:
            string availabilityZone;
            if (TryGetAvailabilityZone(out availabilityZone))
            {
                // name of the availability zone is <nameOfRegionEndpoint>[a|b|c etc]
                // so just take the name of the availability zone and chop off the last letter
                var nameOfRegionEndpoint = availabilityZone.Substring(0, availabilityZone.Length - 1);
                endpoint = RegionEndpoint.GetBySystemName(nameOfRegionEndpoint);
                return true;
            }
            // satisfy the compiler by assigning a value to endpoint
            endpoint = RegionEndpoint.USWest2;
            return false;
        }
        /// <summary>
        /// Downloads instance metadata
        /// </summary>
        /// <returns>True if the operation was successful, false otherwise</returns>
        /// <remarks>The operation will be unsuccessful if the machine running this code is not an AWS EC2 machine.</remarks>
        static bool TryGetMetaData(string name, out string result)
        {
            result = null;
            try { result = new WebClient().DownloadString("http://169.254.169.254/latest/meta-data/" + name); return true; }
            catch { return false; }
        }

/************************************************************
 * MetaData keys.
 *   Use these keys to write more functions as you need them
 * **********************************************************
ami-id
ami-launch-index
ami-manifest-path
block-device-mapping/
hostname
instance-action
instance-id
instance-type
local-hostname
local-ipv4
mac
metrics/
network/
placement/
profile
public-hostname
public-ipv4
public-keys/
reservation-id
security-groups
*************************************************************/
    }
} 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2014-09-03T19:13:24.933

**对于 C++**（使用 cURL）：

```
 #include <curl/curl.h>

    //// cURL to string
    size_t curl_to_str(void *contents, size_t size, size_t nmemb, void *userp) {
        ((std::string*)userp)->append((char*)contents, size * nmemb);
        return size * nmemb;
    };

    //// Read Instance-id 
    curl_global_init(CURL_GLOBAL_ALL); // Initialize cURL
    CURL *curl; // cURL handler
    CURLcode res_code; // Result
    string response;
    curl = curl_easy_init(); // Initialize handler
    curl_easy_setopt(curl, CURLOPT_URL, "http://169.254.169.254/latest/meta-data/instance-id");
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, curl_to_str);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &response);
    res_code = curl_easy_perform(curl); // Perform cURL
    if (res_code != CURLE_OK) { }; // Error
    curl_easy_cleanup(curl); // Cleanup handler
    curl_global_cleanup(); // Cleanup cURL 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2017-03-09T15:50:10.037

只需检查`var/lib/cloud/instance`符号链接，它应该指向您的实例 ID`/var/lib/cloud/instances/{instance-id}`所在的位置。`{instance_id}`

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2018-03-15T07:11:34.477

如果您希望在 python 中获取所有实例 id 列表，则代码如下：

```
import boto3

ec2=boto3.client('ec2')
instance_information = ec2.describe_instances()

for reservation in instance_information['Reservations']:
   for instance in reservation['Instances']:
      print(instance['InstanceId']) 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2013-07-29T22:15:05.173

FWIW 我编写了一个 FUSE 文件系统来提供对 EC2 元数据服务的访问：[https](https://github.com/xdgc/ec2mdfs) ://github.com/xdgc/ec2mdfs 。我在所有自定义 AMI 上运行它；它允许我使用这个成语：cat /ec2/meta-data/ami-id

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2013-12-23T22:29:15.140

在 Go 中，您可以使用[goamz 包](http://godoc.org/github.com/mitchellh/goamz/aws#GetMetaData)。

```
import (
    "github.com/mitchellh/goamz/aws"
    "log"
)

func getId() (id string) {
    idBytes, err := aws.GetMetaData("instance-id")
    if err != nil {
        log.Fatalf("Error getting instance-id: %v.", err)
    }

    id = string(idBytes)

    return id
} 
```

[这是](https://github.com/mitchellh/goamz/blob/master/aws/aws.go#L180)GetMetaData 源。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-12-24T06:28:40.640

您可以通过传递元数据参数来发出 HTTP 请求以获取任何元数据。

```
curl http://169.254.169.254/latest/meta-data/instance-id 
```

或者

```
wget -q -O - http://169.254.169.254/latest/meta-data/instance-id 
```

您无需为获取元数据和用户数据的 HTTP 请求付费。

别的

您可以使用 EC2 实例元数据查询工具，它是一个简单的 bash 脚本，它使用 curl 从正在运行的 EC2 实例中查询 EC2 实例元数据，如文档中所述。

下载工具：

```
$ wget http://s3.amazonaws.com/ec2metadata/ec2-metadata 
```

现在运行命令以获取所需的数据。

```
$ec2metadata -i 
```

参考：

[http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)

[https://aws.amazon.com/items/1825?externalID=1825](https://aws.amazon.com/items/1825?externalID=1825)

很高兴能帮助你.. ：）

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2017-07-16T09:45:07.820

在您提到用户为 root 的问题中，我应该提到的一件事是实例 ID 不依赖于用户。

对于**Node**开发人员，

```
var meta  = new AWS.MetadataService();

meta.request("/latest/meta-data/instance-id", function(err, data){
    console.log(data);
}); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-12-28T06:48:00.833

要获取实例元数据，请使用

```
wget -q -O - http://169.254.169.254/latest/meta-data/instance-id 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-06-22T09:34:17.557

**动机**：用户想要检索 aws 实例元数据。

**解决方案：** IP 地址`169.254.169.254`是链接本地地址（仅对实例有效）aws 为我们提供了与专用 Restful API 的链接，**用于检索我们正在运行的实例的元数据**（请注意，您无需为用于检索实例元数据的 HTTP 请求付费和用户数据）。[附加](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html)文件

**示例**：

```
//Request:
curl http://169.254.169.254/latest/meta-data/instance-id

//Response
ami-123abc 
```

您可以使用此链接获取实例的其他元数据标签，`http://169.254.169.254/latest/meta-data/<metadata-field>`只需选择正确的标签：

1.  酰胺
2.  ami-launch-index
3.  ami-manifest-path
4.  块设备
5.  映射
6.  事件
7.  冬眠
8.  主机名
9.  我是
10.  身份凭证
11.  实例动作
12.  实例 ID
13.  实例类型
14.  本地主机名
15.  本地 IPv4
16.  苹果电脑
17.  指标
18.  网络
19.  放置
20.  轮廓
21.  预订编号
22.  安全组
23.  服务

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-01-25T20:38:52.183

对于 PHP：

```
$instance = json_decode(file_get_contents('http://169.254.169.254/latest/dynamic/instance-identity/document));
$id = $instance['instanceId']; 
```

根据@John 编辑

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-12-06T01:44:53.363

**PHP的替代方法：**

```
$instance = json_decode(file_get_contents('http://169.254.169.254/latest/dynamic/instance-identity/document'),true);
$id = $instance['instanceId'];
print_r($instance); 
```

这将提供有关实例的大量数据，所有数据都很好地打包在一个数组中，没有外部依赖项。因为这是一个从未失败或延迟的请求，所以这样做应该是安全的，否则我会选择 curl()

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-12-18T11:46:45.520

运行这个：

```
curl http://169.254.169.254/latest/meta-data/ 
```

您将能够看到 aws 提供的不同类型的属性。

[使用此链接查看更多](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-01-31T10:51:08.263

EC2 实例本身可以在执行以下命令的帮助下访问与 EC2 资源相关的所有元数据：

卷曲：

```
http://169.254.169.254/<api-version>/meta-data/<metadata-requested> 
```

对于您的情况：“ **metadata-requested** ”应该是**instance-id**，“ **api-version** ”通常是可以使用的**最新版本。**

附加说明：您还可以使用上述命令获取与以下 EC2 属性相关的信息。

ami-id、ami-launch-index、ami-manifest-path、block-device-mapping/、主机名、iam/、instance-action、instance-id、instance-type、local-hostname、local-ipv4、mac、指标/，网络/，放置/，配置文件，公共主机名，公共ipv4，公共密钥/，预留ID，安全组，服务/，

有关更多详细信息，请点击此链接：[https ://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-05-29T07:54:04.237

对于 Windows 实例：

```
(wget http://169.254.169.254/latest/meta-data/instance-id).Content 
```

或者

```
(ConvertFrom-Json (wget http://169.254.169.254/latest/dynamic/instance-identity/document).Content).instanceId 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-06-01T18:20:02.760

对于 AWS 弹性 beanstalk eb cli 运行`eb tags --list`

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2019-01-04T10:27:25.580

您还可以安装**awscli**并使用它来获取您想要的所有信息：

```
AWS_DEFAULT_REGION=your-region aws ec2 describe-instances 
```

您将获得大量输出，因此请务必使用 ip 等标识符进行 grep 并打印更多行：

```
AWS_DEFAULT_REGION=your-region aws ec2 describe-instances | grep your-ip -A 10 | grep InstanceId 
```

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2021-08-11T10:01:57.150

For .NET code it is very simple: `var instanceId=Amazon.Util.EC2InstanceMetadata.InstanceId`

# visual-studio-2008 - 我可以在 vista Ultimate 32 位上安装和运行 Visual Studio 2008 吗？

> ID：625649
> 
> 赞同：0
> 
> 时间：2009-03-09T10:10:29.463
> 
> 标签：visual-studio-2008, windows-vista

我是 vista 的新手，我只想在 vista Ultimate 32 位上安装 Visual Studio 2008，所以任何人都可以告诉我 Visual Studio 2008 将在 Vista Ultimate 32 位上正常工作吗？事实上，我想用 c sharp 在 asp.net 上工作，所以有人告诉我 IIS 在 vi​​sta 上不能正常工作，所以我想确认它是否正常工作？

请尽快给我建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T10:11:10.837

是的，它会工作得很好。IIS 在 Vista 上也能正常工作。为什么你会有其他想法？您有具体的担忧吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T10:17:51.710

[Windows Vista 上的 Visual Studio](http://msdn.microsoft.com/en-gb/vstudio/aa948853.aspx)实际上并没有具体涵盖 VS 2008，但我相信可以假设如果支持 VS 2005，那么 VS 2008 就会支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T11:05:47.973

它可能会在 64 位版本的 vista 上出现问题，但 32 位 vista 通常适用于许多适用于 XP 的程序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:56:19.937

实际上，我认为 Vista 32 位上的 Visual Studio 2008 是最受支持的配置。Vista 是 VS2008 的发布平台，它本身是一个 32 位应用程序。它在 64 位窗口上的 WOW 仿真下运行。

# inheritance - 为什么例如 Object inheritsFrom: fooobaar 在 Smalltalk 中返回 true？

> ID：625658
> 
> 赞同：1
> 
> 时间：2009-03-09T10:13:14.823
> 
> 标签：inheritance, gnu, smalltalk

似乎 GNU Smalltalk 中的 inheritsFrom: 方法对于作为参数发送给它的每个未定义的类名都返回 true。恕我直言，这可能会使程序非常难以调试。查看 Behavior 类中的代码，它看起来像这样：

```
inheritsFrom: aClass [
"Returns true if aClass is a superclass of the receiver"

<category: 'testing the class hierarchy'>
| sc |
aClass isNil ifTrue: [^true].

sc := self.
[sc := sc superclass.
sc isNil] whileFalse: [sc == aClass ifTrue: [^true]].
^false
] 
```

aClass isNil ifTrue: [^true] 行是罪魁祸首，但我正在寻找一个理智的理由来说明它是以这种方式编码的。（顺便说一下，我是 Smalltalk 世界的新手，并且正在努力学习。）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T16:35:12.280

这与异常无关，而是与未定义的变量有关。在 GNU Smalltalk 的 REPL 中，或者在图形环境的 Transcript 或 Workspace 中，未定义的变量都是 nil ——例如，这在 Ruby 中并没有太大的不同。

所以你实际上是在做“对象继承自：nil”，这是真的。我不知道 Squeak 是假的。实际上，这将背离蓝皮书。

在一个方法中，您会得到一个“variable fooobaar undefined”编译时错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T10:26:40.470

我想想法是所有类引用都必须暗示某种类，因此 nil 引用暗示 Object，它是所有事物的超类。

[Squeak](http://www.squeak.org/)更符合您的预期：

```
inheritsFrom: aClass 

|aSuperclass |
aSuperclass := superclass.
[aSuperclass == nil]
    whileFalse: [aSuperclass == aClass
            ifTrue: [^ true].
        aSuperclass := aSuperclass superclass].
^ false 
```

[链接文本](http://www.squeak.org/)

# c - 如何在 C 中获取我的非环回网络 IP 地址？

> ID：625663
> 
> 赞同：3
> 
> 时间：2009-03-09T10:14:43.043
> 
> 标签：c, networking, network-programming, communication

对于两台主机之间的通信，我需要将我的主机的 IP 地址发送到另一个站点。问题是，如果我请求我的 IP 地址，可能是我取回了本地环回 IP 地址 (127.xxx) ，而不是网络（以太网）IP 地址。

我使用以下代码：

```
char myhostname[32];

gethostname(myhostname, 32);
hp = gethostbyname(myhostname);
unsigned my_ip = *(unsigned*)(hp->h_addr);

if( (my_ip % 256) == 127) {
  /* Wrong IP adress as it's 127.x.x.x */
  printf("Error, local IP address!");
  return;
} 
```

解决它的唯一方法是确保我在 /etc/hosts 中的主机名位于真实网络地址后面，而不是本地环回（例如 Ubuntu 的默认值）。

有没有办法在不依赖 /etc/hosts 的内容的情况下解决这个问题？

**编辑：**我改变了上面的代码，所以它使用了 getaddrinfo，但我仍然得到回环设备的号码（127.0,0,1）而不是真实的 IP 地址：

```
struct addrinfo hint = {0};
struct addrinfo *aip = NULL;
unsigned ip = 0;
struct sockaddr_in *sinp = NULL;

hint.ai_family = AF_INET; /* IPv4 */
hint.ai_socktype = SOCK_STREAM;

if(getaddrinfo(hostname, NULL, &hint, &aip) != 0) {
    return 0;
}
sinp = (struct sockaddr_in *) aip->ai_addr;
ip   = *(unsigned *) &sinp->sin_addr; 
```

（我曾经用三个 SOCK_STREAM、SOCK_DGRAM 和 SOCK_RAW 取回 3 个 addrinfo 的列表，但提示阻止了这一点）

所以我的问题仍然存在......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T10:36:30.837

有 POSIX 函数`getaddrinfo()`可以返回给定主机名的地址链接列表，因此您只需要遍历该列表并找到非环回地址。

见`man getaddrinfo`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T10:22:25.003

不是一个答案，而是一个相关的评论：请注意，一旦您开始在数据包的内容中发送地址信息，您就会冒着使您的应用程序无法跨[NAT：ing](http://sv.wikipedia.org/wiki/Network_Address_Translation)路由器和/或防火墙工作的风险。

这些技术依靠 IP 数据包标头中的信息来跟踪流量，如果应用程序在数据包内交换地址信息，而这些信息在此检查中仍然不可见，则它们可能会中断。

当然，这可能与您的应用程序完全无关，但我认为在这种情况下值得指出。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T10:27:02.730

原始地址将包含在发送的数据包中……无需复制此信息。它是在接受来自远程主机的通信时获得的（请参阅 beej 的网络指南，特别是有关[accept()](http://beej.us/guide/bgnet/output/html/multipage/syscalls.html#accept)的部分）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-08T22:08:08.217

我刚刚遇到了这样一种情况，当只有 /etc/hosts 中有信息时，当我使用 getaddrinfo 获取 IP 地址列表时，它每次都返回 127.0.0.1。事实证明，主机名是 localhost 的别名……这通常很容易被忽略。这是发生的事情：

/etc/hosts 文件：
127.0.0.1 localhost.localdomain localhost foo
::1 localhost6.localdomain6 localhost6
172.16.1.248 foo
172.16.1.249 bie
172.16.1.250 bletch

因此，现在，当您使用 host="foo" 调用 getaddrinfo 时，它会返回 127.0.0.1 3 次。这里的错误是 foo 出现在“127.0.0.1”和“172.16.1.248”的行上。一旦我从带有“127.0.0.1”的行中删除了 foo ，一切正常。

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T10:19:04.577

看看这个：以 [编程方式发现公共 IP](https://stackoverflow.com/questions/613471/discovering-public-ip-programatically)

请注意，在某些情况下，一台计算机可以有多个非环回 IP 地址，在这种情况下，该问题的答案会告诉您如何获取暴露于 Internet 的 IP 地址。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T10:22:57.530

即使计算机只有一个物理网络接口（这个假设可能成立也可能不成立，即使上网本也有两个 - 以太网和 WLAN），VPN 可以添加更多的 IP 地址。无论如何，另一端的主机应该能够确定您的主机用来联系它的 IP。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T10:27:01.750

采用[`getaddrinfo()`](http://en.wikipedia.org/wiki/Getaddrinfo)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T14:04:56.030

您快到了。我不确定你是如何`my_ip`从`hp`.

`gethostbyname()`返回指向`hostent`具有`h_addr_list`字段的结构的指针。

该`h_addr_list`字段是绑定到该主机的所有 IP 地址的以空字符结尾的列表。

我认为您获得了环回地址，因为它是`h_addr_list`.

编辑：它应该像这样工作：

```
gethostname(myhostname, 32);
hp = gethostbyname(myhostname);
unsigned my_ip = *(unsigned*)(hp->h_addr);

for (int i = 0; hp->h_addr_list[i] != 0; ++i) {
  if (hp->h_addr_list[i] != INADDR_LOOPBACK) {
    // hp->addr_list[i] is a non-loopback address
  }
}
// no address found 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T15:01:13.137

如果 /etc/hosts 仍然存在并且仍然相同，则查找 h_addr_list 的所有条目将无济于事。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T21:37:33.717

您的新代码硬连线了 IPv4 的使用（在hint.ai_family 字段中），这是一个糟糕的主意。

除此之外，您已经很接近了，您只需要遍历 getaddrinfo 的结果。您的代码只是获取第一个 IP 地址，但后面还有一个 aip->ai_next 字段...

```
struct addrinfo {
       ...
       struct addrinfo *ai_next;       /* next structure in linked list */
}; 
```

# c# - 自定义编写 OleDbCommand 命令

> ID：625668
> 
> 赞同：0
> 
> 时间：2009-03-09T10:15:48.500
> 
> 标签：c#, sql, oledb, oledbcommand

我有（另一个）关于编写 OleDbCommand 的问题。我有一个复杂的选择命令（包括几个左连接）并且 OleDbCommandBuilder 无法为我生成更新命令。

我似乎无法掌握编写更新命令背后的魔力。我知道 SQL 更新语句的结构，但是我对它如何与 OleDbDataAdapter 一起工作感到有点困惑。我知道当我调用 adapter.Update() 时，它只会更新 DataTable 的必要行，但是我不知道如何编写更新命令，因此它能够知道*表*中的哪些字段需要更新。

如果有人能向我解释这个过程并为我指明正确的方向，我将不胜感激。

**编辑**：由于没有人回答，我将发布有关我的问题的更多详细信息：

我有一个这种形式的选择语句：

```
select field1, field2, fieldn from table1 left join table2 on condition left join table3 on condition where condition1 and condition2 
```

一个让我困惑的是我应该如何写一个更新语句，因为我不能这样写：

```
update table1, table2 set field1 = newvalue where condition1 and condition2 
```

所以我不明白怎么做，因为 update 语句只接受一个表参数。甚至可以在这种 DataTables 上调用 OleDbDataAdapter.Update 方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T12:47:23.127

你想这样做吗？

```
update table1 set table1.field1 = table2.field2
from table1 left join table2 on condition1
where condition2 and condition3 
```

我很确定您一次不能更新多个表。因此，您必须为每个表发出一个更新语句。如果你想减少到服务器的往返次数，你可以用“;”分隔语句，或者调用一个存储过程来执行 n 次更新

**仍然检查[INSTEAD OF 触发器](http://technet.microsoft.com/en-us/library/ms175521.aspx)，这可能是您正在寻找的**

# visual-studio-2008 - 具有代码生成功能的 Visual Studio 2008 专业版的优秀 UML 设计器

> ID：625673
> 
> 赞同：1
> 
> 时间：2009-03-09T10:16:18.857
> 
> 标签：visual-studio-2008, code-generation, uml

什么是我可以购买的最便宜的工具，以允许具有代码生成能力的可视化 UML 设计，记住它目前是 Visual Studio Professional，而不是 Team Studio。

我正在尝试在新开发中实现可视化创建命名空间、类、主要参数和函数的能力，以便我可以向老板解释展示类布局，然后将生成的 vb.net snubs 发送给开发团队“填空”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:37:58.177

[Visual Studio 的 SDE](http://www.visual-paradigm.com/product/sde/vs/)怎么样？

您提到了成本：这是 Visual Studio 的缺点。你不会得到很多免费的。Resharper要花钱。地狱，即使是 Visual SVN 也要花钱（与标准的 Java IDE 相比）。

我认为最大的问题是，如果我没看错，你想从 C# 源代码进行往返工程吗？如果是这样，您将为此付出代价。即使在 Java 世界中，您也需要为此付费。

我不相信这些东西真的有那么大的价值。需要有选择地使用 UML 来解释关键的抽象、概念和体系结构。这不是代码生成器可以做到的。同样对于高级类图，如果您开始放入所有属性和方法，您会很快耗尽空间。

如果你只是想绘制一些没有往返工程的 UML 图，我已经尝试了其中的一些，而[JUDE 社区](http://jude.change-vision.com/jude-web/product/community.html)是我发现的免费的最好的。我听说最新版本的[ArgoUML](http://argouml.tigris.org/)也不差劲。只是快速浏览了一下，它肯定比我一两年前尝试它时要好得多。

所以这一切都归结为你想要实现的目标？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:31:54.390

Visual Studio 2008 有一个内置的类设计器。它不像成熟的 UML 工具那样健壮，但如果您只是在寻找具有代码生成的类图表功能，那么它工作得很好。它不需要额外的费用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-15T16:23:21.413

微软确实缺乏对此的 UML 支持，尽管我对 StarUML 有一些很好的经验，[http: //staruml.sourceforge.net/en/](http://staruml.sourceforge.net/en/)

# windows - 如何在 Windows 上获得可重复的受 CPU 限制的基准测试运行时？

> ID：625680
> 
> 赞同：1
> 
> 时间：2009-03-09T10:18:50.410
> 
> 标签：windows, benchmarking

我们有时必须在我们想要测量运行时间的地方运行一些 CPU 密集型测试。测试持续大约一分钟。问题在于，从运行到运行运行时变化很大（+/- 5%）。我们怀疑这种变化是由系统上其他应用程序/服务的活动引起的，例如：

*   在空闲时间做家务的应用程序（例如 Visual Studio 更新 IntelliSense）
*   文件系统索引器
*   ETC..

**有什么技巧可以让我们的基准测试时间更稳定？**

目前我们最小化所有其他应用程序，以“高于正常”优先级运行测试，并且在运行测试时不触摸机器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T10:41:31.527

首先，如果只是对应用程序本身进行基准测试，您应该使用 CPU 时间，而不是挂钟时间作为衡量标准。然后（几乎）不受其他进程或系统所做工作的影响。其次，正如[迪肯里德所指出的](https://stackoverflow.com/questions/625680/how-do-i-get-repeatable-cpu-bound-benchmark-runtimes-on-windows/625731#625731)，更多的重复可以增加信心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T10:32:20.143

通常的方法是执行大量重复，然后丢弃异常值。因此，如果像磁盘索引器这样的干扰仅每隔一小时左右出现一次，并且您在 24 小时内重复运行 5 分钟，那么您将获得大量结果而没有任何阻碍。绘制概率密度函数以确保您了解正在发生的事情是一个好主意。此外，如果您对启动效果（例如将所有内容放入处理器缓存）不感兴趣，请确保实验运行足够长的时间以使它们变得微不足道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T14:02:49.583

引用 VC++ 团队博客，他们如何进行[性能测试](http://blogs.msdn.com/vcblog/archive/2009/03/16/performance-tests.aspx)：

> 为了降低基准测试机器上的噪音，我们采取了几个步骤：
> 
> 1.  停止尽可能多的服务和进程。
> 2.  禁用网络驱动程序：这将关闭由>广播数据包引起的网卡中断。
> 3.  将测试的处理器关联设置为仅在一个处理器/内核上运行。
> 4.  将运行设置为高优先级，这将减少上下文切换的数量。
> 5.  运行几次迭代的测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T10:43:48.277

我执行以下操作：

1.  调用方法x次并测量时间
    *   这样做 n 次并计算这些测量值的平均值和标准偏差

尝试使 x 达到每次测量 > 1 秒的点。这将减少一点噪音。

平均值将告诉您测试的平均性能，标准偏差将告诉您测试/测量的稳定性。

我还将我的应用程序设置为非常高的优先级，并且当我测试单线程算法时，我将它与一个 cpu 核心相关联，以确保没有调度开销。

此代码演示了如何在 .NET 中执行此操作：

```
Thread.CurrentThread.Priority = ThreadPriority.Highest;
Process.GetCurrentProcess().PriorityClass = ProcessPriorityClass.RealTime;
if (Environment.ProcessorCount > 1)
{
   Process.GetCurrentProcess().ProcessorAffinity = 
      new IntPtr(1 << (Environment.ProcessorCount - 1));
} 
```

# c++ - linux内核模块链接器警告：“***警告： [ ] 未定义！” - 有什么办法可以摆脱它们？

> ID：625685
> 
> 赞同：23
> 
> 时间：2009-03-09T10:19:47.803
> 
> 标签：c++, linux, kernel-module, compiler-errors

在编译相互依赖的 Linux 内核模块时，链接器会给出未定义的符号警告，例如

```
 Building modules, stage 2.
 MODPOST
*** Warning: "function_name1" [module_name] undefined!
*** Warning: "function_name2" [module_name] undefined!
*** Warning: "function_name3" [module_name] undefined! 
```

一旦使用 insmod 或 modprobe 将模块插入内核，未解析的符号就会被解析。不过，有什么办法可以摆脱链接器警告吗？

我已经阅读了关于这个问题的 3 个 Google SERP - 似乎没有人知道答案。当您构建内核模块时，这些链接器警告是否应该是这种方式？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-02-26T14:42:50.523

使用 KBUILD_EXTRA_SYMBOLS 如下： KBUILD_EXTRA_SYMBOLS='你的模块路径'/Module.symvers

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T18:06:31.177

最后我得到了它。感谢 shodanex 让我走上正轨。

***更新：***将此修复应用于旧版本内核的构建时要非常小心，因为在旧版本内核中的**Makefile.modpost文件中存在一个错误，当您指定****KBUILD_EXTMOD**选项时，这会使您的构建行为不端并构建错误的目标

**您必须在KBUILD_EXTMOD** make 参数中指定您依赖的模块源的路径。

比如说，你有一个模块**foo**依赖于模块**bar**中的符号。

**foo**的源文件在**foo/module/**和 bar 的源文件在**bar/module/**

**Makefile** for **foo**中的 make 命令可能看起来像

```
make ARCH=$$ARCH CROSS_COMPILE=$$CROSS_COMPILE -C $$LINUX_DIR \
    M=`pwd`/module \
    modules 
```

（您的项目中的确切行可能会有所不同）。

将其更改为

```
make ARCH=$$ARCH CROSS_COMPILE=$$CROSS_COMPILE -C $$LINUX_DIR \
    M=`pwd`/module \
    KBUILD_EXTMOD=`pwd`/../bar/module \
    modules 
```

（我们添加了 KBUILD_EXTMOD= `pwd`/../bar/module \ 行，其中`pwd`/../bar/module 是我们所依赖的内核模块源的路径。

人们会期望**KBUILD_EXTRA_SYMBOLS**参数以这种方式工作，但它是**KBUILD_EXTMOD**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T10:53:22.153

不，他们不是。无论您在树内还是在树外构建代码，都不应显示此消息。我认为您应该修复您的 Makefile。这是一个示例生成文件。不完美，但曾经可以工作（直到 2.6.26，从那以后没有尝试过）：

```
ifneq ($(KERNELRELEASE),)
# We were called by kbuild

obj-m += mymodule.o 
mymodule-objs := mymodule_usb.o a.o b.o c.o

else  # We were called from command line

KDIR := /lib/modules/$(shell uname -r)/build
PWD  := $(shell pwd)

default:
    @echo '    Building FOO drivers for 2.6 kernel.'
    @echo '    PLEASE IGNORE THE "Overriding SUBDIRS" WARNING'
    $(MAKE) -C $(KDIR) SUBDIRS=$(PWD) modules

install:
    ./do_install.sh *.ko

endif  # End kbuild check

clean:
    rm -f -r *.o *.ko .*cmd .tmp* core *.i 
```

[如需进一步的文档，您可以查看内核树，记录](http://lxr.linux.no/linux+v2.6.28.7/Documentation/kbuild/modules.txt)了 kbuild 过程

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-31T19:18:54.663

与上述使用 KBUILD_EXTMOD 的技术相关，以及它在哪些内核版本下工作的问题：

*   andycjw 表示它在 2.6.12 中对他不起作用
*   它在 2.6.15 中对我不起作用（破坏了我的模块构建）
*   查看内核提交，我看到 Makefile.modpost 的许多更改似乎与 2.6.26 和 2.6.28 相关，所以我希望其中之一是限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T21:39:46.277

我需要为你的树量身定做。在我们的源代码中，我们创建了一个 SYMBOLSDIR，它是所有模块的路径

SYMBOLSDIR = '一些路径'

制作（与上例相同）$(KERNELDIR) MODVERDIR=$(SYMBOLSDIR) 模块

# java - getClassLoader().getResource() 返回 null

> ID：625687
> 
> 赞同：17
> 
> 时间：2009-03-09T10:20:20.673
> 
> 标签：java, applet

我有这个测试应用程序：

```
import java.applet.*;
import java.awt.*;
import java.net.URL;
public class Test extends Applet
{

    public void init()
    {
        URL some=Test.class.getClass().getClassLoader().getResource("/assets/pacman.png");
        System.out.println(some.toString());
        System.out.println(some.getFile());
        System.out.println(some.getPath());

    }
} 
```

当我从 Eclipse 运行它时，出现错误：

```
java.lang.NullPointerException
    at Test.init(Test.java:9)
    at sun.applet.AppletPanel.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

类路径（来自 .CLASSPATH 文件）

```
<classpathentry kind="src" path="src"/> 
```

在我的 c:\project\src 文件夹中，我只有 Test.java 文件和包含 pacman.png 的“assets”目录。

我做错了什么以及如何解决？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-09T10:26:39.393

从 a 获取资源时，您不需要在开头使用斜线`ClassLoader`，因为不知道要从“相对”部分开始。只有当您`Class`从类的包级别的相对路径获取资源时才需要它。

此外，您不希望`Test.class.getClass()`获得 Test.class 的类*，*这将是`Class<Class>`.

换句话说，尝试以下任一行：

```
URL viaClass=Test.class.getResource("/assets/pacman.png");
URL viaLoader=Test.class.getClassLoader().getResource("assets/pacman.png"); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T10:34:01.827

我会这样做：

```
final InputStream stream;

stream = Test.class.getResourceAsStream("assets/pacman.png");
System.out.println("Stream = " + stream); 
```

“/assets/pacman.png”是一个绝对位置，而“assets/pacman.png”是一个相对位置。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-11-29T00:51:40.547

*   当您使用`.getClass().getResource(fileName)`它时，认为 fileName 的位置与调用类的位置相同。
*   当您使用`.getClass().getClassLoader().getResource(fileName)`它时，文件名的位置是根目录 - 换句话说就是 bin 文件夹

`NullPointerException`如果文件实际上不存在，它会命中。

来源：

```
package Sound;
public class ResourceTest {
    public static void main(String[] args) {
        String fileName = "Kalimba.mp3";
        System.out.println(fileName);
        System.out.println(new ResourceTest().getClass().getResource(fileName));
        System.out.println(new ResourceTest().getClass().getClassLoader().getResource(fileName)); 
```

输出：

```
Kalimba.mp3
file:/C:/Users/User/Workspaces/MyEclipse%208.5/JMplayer/bin/Sound/Kalimba.mp3
file:/C:/Users/User/Workspaces/MyEclipse%208.5/JMplayer/bin/Kalimba.mp3
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-26T03:04:48.920

这对我有用：

> URL viaClass=Test.class.getResource("assets/test.html");

哪些资产与 Test.class 输出文件位于同一文件夹中（经过痛苦的检查和调试）

# ruby-on-rails - Rails 最佳实践 - 您如何处理可能具有相同记录的唯一用户？

> ID：625688
> 
> 赞同：1
> 
> 时间：2009-03-09T10:20:33.870
> 
> 标签：ruby-on-rails, database-design, user-interface

如何处理实名冲突？是否存在用于消除此类记录歧义的既定最佳实践或 UI 设计模式？如果作者可以拥有多篇文章，但不止一位作者可能有相同的姓名，您将如何让用户在创建文章时选择他们真正想要的作者？

我不能规定作者姓名是唯一的。作者可能有一些其他信息可以使他们个性化（他们的文章或其他可选字段）。

为了更清楚地说明这一点 - 用户不是作者。用户是输入有关作者和文章的信息的人。对于作者来说，唯一有保证的信息是作者的姓名。其他细节是可选的。

因此，如果用户正在为一篇文章创建新记录，他们将不得不为作者和文章之间的多对多关系选择或创建作者。

使用明确的 Rails 示例，例如博客文章类别下拉列表，就像 ryan bates 在他的 railscasts 中使用的那样，它很容易创建或更新。如果存在，则将博客文章链接到它，如果不存在，则创建并将博客文章链接到它。

我的案子要混乱得多。如果它存在就没那么有意义，但我不想为作者所做的每篇文章创建单独的作者条目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:18:46.320

假设您有一个密钥，这意味着您知道哪个用户创作了哪些记录，因此归结为您如何最好地为您的用户消除它们的歧义。

也许您需要在他们的个人资料中向您的作者询问他们自己的简短摘要，您可以使用它来消除他们对他们的条款的歧义。或者，根据文章的类型，您可能会选择用地理（“John Biggs, Florida”、“John Biggs, California”）或他们选择撰写的主题领域来描述它们：“John Biggs，Java 专家》、《印度尼西亚专家约翰·比格斯》等。

你甚至可以只有“John Biggs (1)”、“John Biggs (2)”等等。我似乎记得这对 IMDB 来说很好，这是一个必须对这个问题进行排序的网站的一个很好的例子。

与这些类型的事物有关的可用性中的重要一点是*一致性*- 您需要始终以相同的方式识别您的作者，这样您就没有“John Biggs, Florida”和“John Biggs (2)”，您需要确保您提供给作者的身份在设置后不会更改，因此“John Biggs (2)”永远不会变成“John Biggs (5)”，并且您的用户可以在看到已消除歧义的名称时识别他们为以前有这个名字的同一个人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T17:03:17.007

在过去的项目中对我有用的一件事是有一个文本框，用户可以在其中输入作者的姓名。当他们键入时，我会用可能的匹配项更新一个 div - 类似于您在忽略或有趣的框中键入标签时的 Stack Overflow。

用户可以单击 div 中的姓名，这会在新窗口中打开记录 - 新窗口有一个按钮，“选择此作者”，它会将您带回到原始页面，该作者在文本字段中作为作者姓名 (id) .

如果他们提交的表单名称不明确，我们有一个额外的步骤来显示匹配项，他们会选择他们所指的那个。

如果这是一个数据输入类型的应用程序，我想你会想要一些更精简的东西，但是在那个项目中添加作者是一种不常见的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:22:15.340

需要考虑的几件事：您可以先按主题过滤吗？例如，如果 John Jones (1) 撰写有关遗传学的文章，而 John Jones (2) 撰写有关计算机网络的文章，但让用户先选择一般主题，您可能能够过滤掉许多不太适用的可能重复名称. （但是我会有一个按钮来查看未过滤的列表，因为有时人们会在新主题中写文章）。如果您不想限制选择，也许按主题或位置排序可以更容易找到合适的选择。

当您显示可能的重复名称列表时，请显示有关作者的一般信息，包括地址和大学附属机构，可能还有一篇文章的名称。有一个按钮可以单击以显示其中任何一篇的现有文章。这样，如果您知道您想要的约翰琼斯位于佛罗里达州，您只需查看佛罗里达州的三个文章，而不是所有 37 篇撰写遗传学文章的约翰琼斯。

请注意，用户通常很懒惰，他们宁愿只插入一个新名称，也不愿从一长串现有名称中进行选择。因此，插入一个新名称比选择一个更难。他们必须先完成挑选过程，然后才能输入新名称。我们有一个应用程序，在您完成搜索之前，它甚至不会显示添加新人的按钮。由于名称可能有变化，请考虑是否要使用模糊逻辑进行搜索。您可能希望在选择结果中显示 J. Jones、Johnny Jones 和 Jon Jones 以及 John Jones。

现在，这在很大程度上取决于您的用户提前对作者有多少了解。如果他们除了名字之外一无所知，他们就没有根据您在数据库中的 37 个 John Jones 之间进行判断。在这种情况下，最好只接受重复项并根据关键字过滤或您存储的有关文章的任何内容返回结果。如果您真的对作者除了他的名字一无所知，是否真的有必要确保这些文章归于正确的约翰琼斯？您是否更关心文章的主题和名称，或者拥有来自 UVA 的政治学教授 John Jones 撰写的所有文章的列表？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:05:07.593

你没有！正如您所发现的那样，名称是一种不好的识别方法。你有很多方法可以解决这个问题：

为普通用户添加某种形式的唯一标识符，这将是用于检查唯一性的用户名。在您的情况下，如果您确实没有除名称以外的其他信息，则上述方法 name(1) 可能必须这样做。

另一种方法是使用多个属性来制作复合键（例如 name + dob）

# c# - C#：PointF() 数组初始化器

> ID：625690
> 
> 赞同：3
> 
> 时间：2009-03-09T10:20:43.527
> 
> 标签：c#, arrays, array-initialize

我需要在我的 C# 程序中对一组点进行硬编码。C 风格的初始化程序不起作用。

```
PointF[] points = new PointF{
    /* what goes here? */
}; 
```

它是如何完成的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T10:24:18.697

像这样：

```
PointF[] points = new PointF[]{
    new PointF(0,0), new PointF(1,1)
}; 
```

在 c# 3.0 中，你可以写得更短：

```
PointF[] points = {
    new PointF(0,0), new PointF(1,1)
}; 
```

**更新**Guffa 指出我对`var points`, 确实不可能“使用数组初始值设定项进行隐式类型变量”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T10:23:02.930

您需要用 new 实例化每个 PointF。

就像是

Pointf[] points = { new PointF(0,0), new PointF(1,1) 等...

这里的语法可能不是 100%……我回到了几年前我最后一次不得不这样做的时候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T10:26:18.367

```
PointF[] points = new PointF[]
{
    new PointF( 1.0f, 1.0f),
    new PointF( 5.0f, 5.0f)
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T10:26:45.977

对于 C# 3：

```
PointF[] points = {
   new PointF(1f, 1f),
   new PointF(2f, 2f)
}; 
```

对于 C# 2（和 1）：

```
PointF[] points = new PointF[] {
   new PointF(1f, 1f),
   new PointF(2f, 2f)
}; 
```

# windows-mobile - 如何确定 Windows Mobile 设备的类型？

> ID：625694
> 
> 赞同：0
> 
> 时间：2009-03-09T10:21:49.640
> 
> 标签：windows-mobile, compact-framework

我们有一个 Windows Mobile 应用程序，目前正在 Symbol（现在的 Motorola）设备上运行。我们使用制造商的 SDK 来执行注册条形码扫描等操作。

我们现在需要让软件与 Intermec 设备一起工作。

我已经在接口后面抽象了扫描代码，所以我需要做的就是将 Intermec API 包装在该接口后面，然后为正在使用的设备加载正确的版本。

但是，我在确定软件正在运行哪种类型的设备时遇到了一些困难。我可以尝试加载符号代码，然后在失败时尝试 Intermec 代码，但这很垃圾。

有谁知道我如何以编程方式计算出设备的类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T10:28:39.593

请参阅此[链接](https://blogs.msdn.com/netcfteam/archive/2006/09/15/756755.aspx)。它将帮助您获取设备的 OEM 信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-10T18:18:51.927

来自[http://www.christec.co.nz/blog/archives/77](http://www.christec.co.nz/blog/archives/77)

使用下面的代码并调用`NativeMethods.GetOEMInfo()`

```
private static class NativeMethods
{
  [DllImport("coredll.dll")]
  private static extern int SystemParametersInfo(uint uiAction, uint uiParam, StringBuilder pvParam, uint fWiniIni);

  private const uint SPI_GETPLATFORMTYPE = 257;
  private const uint SPI_GETOEMINFO = 258;

  private static string GetSystemParameter(uint uiParam)
  {
    StringBuilder sb = new StringBuilder(128);
    if (SystemParametersInfo(uiParam, (uint)sb.Capacity, sb, 0) == 0)
      throw new ApplicationException("Failed to get system parameter");
    return sb.ToString();
  }

  public static string GetOEMInfo()
  {
    return GetSystemParameter(SPI_GETOEMINFO);
  }

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-01T15:57:56.567

这是本机代码，但它适用于我。

```
TCHAR buf[255];
SystemParametersInfo(SPI_GETOEMINFO, 255, &buf, NULL); 
```

然后只需解析缓冲区以找出它是哪个设备。

# java - 使用向量编辑 JTable

> ID：625698
> 
> 赞同：1
> 
> 时间：2009-03-09T10:22:35.863
> 
> 标签：java, swing, jtable, edit

我正在做一个迷你项目`JTable`.

我将`Vector`类型用于行值。例如，`public Vector textData = new Vector();`。问题是当我编辑 中的单元格时`JTable`，它是可编辑的，但不保留更改后的值。也就是说，当我在 1 个单元格中输入数据并移动到下一个单元格时，之前的数据不会更新。

声明为时是否可以编辑单元格`Vector`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T14:03:33.137

您使用的模型类型并不重要。您需要做的基本上是通知您的模型编辑后数据已更改。查看[如何使用表格](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)以获取一些示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T11:23:50.630

覆盖`setValueAt(Object value, int row, int col)`方法也是如此。它应该存储输入的数据，因此`getValueAt(int row, int col)`方法可以返回新值。像这样的东西：

```
private String[][] data;
public Object getValueAt(int row, int col) {
    return data[row][col];
}
public void setValueAt(Object value, int row, int col) {
    data[row][col] = value;
} 
```

# c# - 在使用 LINQ 的对面到内部联接查询方面需要帮助

> ID：625701
> 
> 赞同：7
> 
> 时间：2009-03-09T10:23:37.887
> 
> 标签：c#, linq-to-xml, outer-join

我在 XML 数据集中有两个表。T1，T2。每个表都有一个 ID 列。

T1 有一个客户列表 T2 有一个订单列表

我想构建一个 LINQ 查询，它只返回没有订单的客户的 ID。换句话说，T2 表中不存在的客户 ID。

哦，是的，我正在使用 C#

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T11:22:30.273

这需要外部连接和对 null 的检查。

```
var result = from c in Customers
             join d in Details on d.CustomerID equals c.ID into g
             where !g.Any()
             select c; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T10:41:24.773

我认为这会起作用（请适应您的数据集）：

```
var query = from c in T1
            where !(from o in T2 select o.CustomerID)
            .Contains(c.CustomerID)
            select c; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T10:40:50.717

您只需要给我们一个 where 子句和所有内容：

```
T1.Where( item1 => T2.All( item2 => item1.ID != item2.ID ) ); 
```

# comments - if-then-else 结构中的注释应该放在哪里？

> ID：625708
> 
> 赞同：37
> 
> 时间：2009-03-09T10:24:43.017
> 
> 标签：comments, if-statement

我从来没有决定什么是最好的评论方式`if-then-else`结构的最佳方式，所以我从来没有标准化一致的方式来评论它们。我很欣赏任何见解。

一些选项：

一个）

```
if (blabla) { 
   // this comment explains what happens in the IF case
   dothis();
} else { 
  // this comment explains what happens in the ELSE case
   dosomethingelse();
} 
```

缺点：在多个 dothis() 语句的情况下，我喜欢对主要块进行注释，在这种情况下，IF 注释是属于第一个 dothis() 块还是属于整个 IF 情况并不总是很清楚

或 b)

```
if (blabla) { // this comment explains what happens in the IF case
   dothis();
} else { // this comment explains what happens in the ELSE case
   dosomethingelse();
} 
```

缺点：只适用于简短的评论。如果代码中没有直接明确 IF 和 ELSE 的情况，我通常会注释 IF-THEN-ELSE 结构，这通常需要超过一行的注释。

或 c)

```
// if the following happens
if (blabla) { // then do this
   dothis();
} else { // or else do this
   dosomethingelse();
} 
```

PS：我知道“代码应该是自我解释的”，但情况并非总是如此......

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-09T10:31:14.860

对我来说，上面的评论`IF`解释了`IF`声明本身。例如，如果正在测试的条件特别复杂。

`IF`或下方块中的注释`ELSE`描述了评估条件并做出选择后会发生什么。

所以像这样：

```
//Is this a favoured customer and do we have a promotion?
if customer.special() and monthly.hasOffer() {
  //Add discount
  invoice.addDiscount();
} 
else {
  //Add note about favoured customer scheme
  invoice.addNotes(JOIN_OUR_DISCOUNT_SCHEME);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T11:02:54.703

我从来没有考虑过。我个人并在需要时将评论置于 IF 和 ELSE 语句之上。这让我很好地将关于分支语句的注释和关于代码的注释分开。

```
// comment about the if statement
if (expression)
{
    // comment about the code
    doSomething();
}
// comment about the else statement
else
{
    // comment about the code
    doSomethingElse();
} 
```

我还注意到，到目前为止，我是使用“开放花括号样式”的唯一答案，这可能是对我 Pascal 时代的一种回归，尽管我确实更喜欢代码块开始和结束的视觉理由，所以我的评论风格可能不适用于“封闭的花括号样式社区。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T10:31:56.200

我会做案例 a) 但有一点空格：

```
if (blabla) {
   // This explains the whole if case

   // Can comment here for specific block comments
   doThis();
} else {
   // This explains the else case

   // Same again
   doSomethingElse();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T11:45:47.877

就个人而言，我发现编写不需要少量注释的代码会更好，例如“about do do x”，然后是“DoX()”。如果有必要，我宁愿写一个名为“DoXBecauseOfY”的方法，而不是写一个评论说“do x because of y”。如果稍后的重构删除了“BecauseOfY”部分，那么在*if*语句之前添加注释仍然更有意义，以记录整体逻辑。

当然，您需要将每个分支中的代码量减少到可以一次读取整个*if*语句的程度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T10:32:34.560

使用对你有意义的东西，我猜（除非你在一个指定评论风格的编码标准下工作）。我个人不使用 (c) ，因为它在第一个和后续案例之间不一致。我偶尔会在简短的评论中使用（b），但通常我更喜欢（a）。如果我在 if 块中注释几个子块，我可能会在 case 注释之后留下一个空行：

```
if (blabla) {
    // here's a comment about this case

    // comment about this bit of code
    bit_of_code();
    // comment about this other bit of code
    other_bit_of_code();
} 
```

等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-16T06:31:26.553

```
// Not very much sure, but here is a snippet of my code

// tweak URL as per query params and hash index positions
if (hasQueryParams && hashPos > -1) {
    // both query params and hash available
    ...
    ...
} else if (hasQueryParams) {
    // only query params available
    ...
    ...
} else if (hashPos > -1) {
    // only hash available
    ...
    ...
} else {
    // neither query params nor hash available
    ...
    ...
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-27T09:40:39.010

来自 oracle java [docs](http://www.oracle.com/technetwork/java/codeconventions-150003.pdf)的代码约定

**if-else 的**单行注释：****

 **```
if (condition) {
 /* Here is a single line comment. */
 ...
} 
```

**if-else 的**单行非常简短的注释：****

 **```
if (a == 2) {
   return TRUE; /* special case */
} else {
 return isprime(a); /* works only for odd a */
} 
```

**if-else 的多行**注释：

```
if (condition) {
 /*
  * Here is a block comment.
  */
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-24T18:42:51.280

这个怎么样？**在 if 关键字之后进行注释**。像自然语言一样可读，只为那些真正感兴趣的人留下可能复杂的条件代码。

```
 if /* user is logged in */ (user && user.loggedin()) {
        ...
    } else if /* user was logged in before */ (cookies.user && sizeof(cookies.user)>0 && cookies.user.value=="foobar" && some_other_things_in_a_long_condition) {
        ...
    } else /* apparently there's no user */ {
        ...
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-05T02:17:35.477

这种风格怎么样？ **对整个 if-else 语句描述****使用注释，对内部描述使用注释。`//``/* */`**我使用`/* */`注释是为了不与 if-else 语句的内部注释混淆。

```
 // Process1
    if (cond1-1) {
        /* Process1 > Process1-1 */
        Process1-1();
        // Process1-1 description...
        Process1-1();
        Process1-1();
        ... 

    } else if (cond1-2) {
        /* Process1 > Process1-2 */
        // Process1-2 description...
        Process1-2();
        Process1-2();
        Process1-2();
        ... 

        // Process1-2
        if (cond1-2-1) {
            /* Process1 > Process1-2 > Process1-2-1 */
            Process1-2-1();
            Process1-2-1();
            Process1-2-1();
            ...

        } else if (cond1-2-2) {
            /* Process1 > Process1-2 > Process1-2-2 */
            Process1-2-2();
            // Process1-2-2 description...
            Process1-2-2();
            // Process1-2-2 description...
            Process1-2-2();
            ...

        } else {
            /* Process1 > Process1-2 > Process1-2-else */
            Process1-2-else();
            Process1-2-else();
            Process1-2-else();
            ...
        }

    } else {
        /* Process1 > Process1-else */
        Process1-else();
        Process1-else();
        Process1-else();
        ...
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-15T08:16:36.850

只是为 else 的注释位置添加缺少的答案，我认为这是代码可读性的最佳位置，原因如下：

*   如果注释放在 else 之上，它会破坏 if-else 的连续性
*   如果放在里面，它可以与 else 中第一个语句的注释混合

```
// match jth arc
if (j < Count)
{
     // arc matched
     if (arcs[j].IsBlue) List.Add(arcs[j])
}
else // all arcs were matched
{
     // check if there more arcs
     if (arcs[j + 1] != null) continue;
} 
```

如果你折叠块看起来真的很好

```
// match jth arc
if (j < Count)|...|
else // all arcs were matched|...| 
```

# sql-server-2005 - 如何从 SQL Server 2005 备份登录名和作业？

> ID：625710
> 
> 赞同：1
> 
> 时间：2009-03-09T10:26:10.020
> 
> 标签：sql-server-2005, tsql

sqlserver2005 中是否有脚本或函数可以从主数据库备份服务器的作业和登录详细信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T10:30:02.817

作业存储在[MSDB](http://msdn.microsoft.com/en-us/library/ms187112.aspx)数据库中，登录信息存储在[Master](http://msdn.microsoft.com/en-us/library/ms187837.aspx)数据库中。

您可以像备份任何其他用户数据库一样备份这些系统数据库。使用 Management Studio GUI 或通过[“备份数据库..”TSQL 语法](http://msdn.microsoft.com/en-us/library/ms186865.aspx)。

请参阅这篇关于[备份系统数据库的](http://msdn.microsoft.com/en-us/library/ms190190.aspx)文章。[备份主](http://msdn.microsoft.com/en-us/library/ms191488.aspx)服务器和[备份 MSDB](http://msdn.microsoft.com/en-us/library/ms188274.aspx)的具体注意事项。

# python - wxpython auinotebook 关闭标签事件

> ID：625714
> 
> 赞同：7
> 
> 时间：2009-03-09T10:26:40.797
> 
> 标签：python, wxpython, wxwidgets

当我关闭 auinotebook 中的选项卡时使用什么事件？我用 EVT_AUINOTEBOOK_PAGE_CLOSE(D) 进行了测试。它没有用。

我还想右键单击选项卡本身的事件。

我在哪里可以找到可以与 aui 管理器/笔记本一起使用的所有事件？可能只是我的搜索技巧很差，但我找不到任何存在的不同事件的列表，也不是鼠标/窗口事件。有一个完整的清单真的很方便。

```
#!/usr/bin/python

#12_aui_notebook1.py

import wx
import wx.lib.inspection

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        wx.Frame.__init__(self, *args, **kwds)

        self.nb = wx.aui.AuiNotebook(self)

        self.new_panel('Page 1')
        self.new_panel('Page 2')
        self.new_panel('Page 3')

        self.nb.Bind(wx.EVT_AUINOTEBOOK_PAGE_CLOSED, self.close)

    def new_panel(self, nm):
        pnl = wx.Panel(self)
        pnl.identifierTag = nm
        self.nb.AddPage(pnl, nm)
        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.nb, 1, wx.EXPAND)
        self.SetSizer(self.sizer)

    def close(self, event):
        print 'closed'

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, '12_aui_notebook1.py')
        frame.Show()
        self.SetTopWindow(frame)
        return 1

if __name__ == "__main__":
    app = MyApp(0)
#    wx.lib.inspection.InspectionTool().Show()
    app.MainLoop() 
```

欧尔扬·彼得森

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T11:17:31.457

这是您想要的绑定命令：

```
self.Bind(wx.aui.EVT_AUINOTEBOOK_PAGE_CLOSED, self.close, self.nb) 
```

要检测选项卡上的右键单击（例如，显示自定义上下文菜单）：

```
self.Bind(wx.aui.EVT_AUINOTEBOOK_TAB_RIGHT_DOWN, self.right, self.nb) 
```

这是 aui 笔记本事件的列表：

```
EVT_AUINOTEBOOK_PAGE_CLOSE
EVT_AUINOTEBOOK_PAGE_CLOSED
EVT_AUINOTEBOOK_PAGE_CHANGED
EVT_AUINOTEBOOK_PAGE_CHANGING
EVT_AUINOTEBOOK_BUTTON
EVT_AUINOTEBOOK_BEGIN_DRAG
EVT_AUINOTEBOOK_END_DRAG
EVT_AUINOTEBOOK_DRAG_MOTION
EVT_AUINOTEBOOK_ALLOW_DND
EVT_AUINOTEBOOK_DRAG_DONE
EVT_AUINOTEBOOK_BG_DCLICK
EVT_AUINOTEBOOK_TAB_MIDDLE_DOWN
EVT_AUINOTEBOOK_TAB_MIDDLE_UP
EVT_AUINOTEBOOK_TAB_RIGHT_DOWN
EVT_AUINOTEBOOK_TAB_RIGHT_UP 
```

来自：{python 文件夹}/Lib/site-packages/{wxpython 文件夹}/wx/aui.py

# c# - ASP.NET MVC 中的应用程序助手

> ID：625719
> 
> 赞同：1
> 
> 时间：2009-03-09T10:27:46.613
> 
> 标签：c#, asp.net-mvc, helpers

我正在寻找一种制作应用程序助手的方法，它允许您定义可以在所有控制器视图中调用的方法。在 Rails 中，您可以免费获得它，但我如何在 ASP.NET MVC 中使用 c# 完成此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T11:18:36.290

通常的方法是通过编写扩展方法来`HtmlHelper`- 例如：

```
public static string Script(this HtmlHelper html, string path)
{
    var filePath = VirtualPathUtility.ToAbsolute(path);
    return "<script type=\"text/javascript\" src=\"" + filePath
        + "\"></script>";
} 
```

现在在视图中您可以使用`Html.Script("foo");`etc（因为标准视图有一个`HtmlHelper`名为 的成员`Html`）。您也可以在基本视图中编写方法，但扩展方法方法似乎是最常见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T11:22:26.950

我建议在基本控制器类中添加一个扩展方法。

```
public static class ControllerExtensions
{
    public static string Summin(this Controller c)
    {
        return string.Empty;
    }
} 
```

您可以访问控制器中的辅助函数：

```
 public class MyController : Controller
    {
        public ActionResult Index()
        {
            this.Summin();
            return View();
        }
    } 
```

# security - 厚客户端渗透测试的最佳工具

> ID：625720
> 
> 赞同：0
> 
> 时间：2009-03-09T10:27:48.970
> 
> 标签：security, thickbox

我正在寻找胖客户端应用程序的应用程序安全测试（渗透测试）。我知道 Echo Mirage 和 ITR 是测试这些应用程序的好工具。

有谁知道这样做的任何其他工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T13:23:26.457

Echo Mirage 在胖客户端上是一个更好的入门者。由编写它的（聪明的）家伙介绍了这一点。它适用于 dll 注入。

上下文是什么？

它在胖客户端上变得非常有用，它泄露了它不应该泄露的信息（并且使用了客户端内置的逻辑）。然后用它来拥有一个数据库/应用程序。

# c# - 具有相同方法的 C# 子类

> ID：625721
> 
> 赞同：3
> 
> 时间：2009-03-09T10:28:00.840
> 
> 标签：c#, methods, subclass

我有一个有两个子类的超类。这两个子类都有一个检查章节是否有内容的方法。对于子类 1，此方法是 HasContent(int chapterID)，对于子类 2，此方法是 HasContent(int chapterID, int authority)。如您所见，子类 2 有一个额外的参数。两种方法的目的是相同的。

我正在考虑将 HasContent 方法放在超类中。你认为我需要这样做吗？如果是这样，我应该如何实施？还是将这两种方法放在自己的子类中更明智？

编辑：

HasDocuments 的主体如下所示： Subclass1：

```
Database DB = new Database();
int res = DB.ExecuteSpRetVal(chapterID, mInstitutionID);

if (res > 0)
    return true;
else
    return false; 
```

子类2：

```
Database DB = new Database();
int res = DB.ExecuteSpRetVal(chapterID);

if (res > 0)
    return true;
else
    return false; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T10:35:26.190

**编辑：**根据问题更新更新。

由于您显然在两种方法中具有几乎相同的逻辑，因此我将对其进行重构：

```
abstract class SuperClass
{
    protected bool HasContentImpl(int chapterID, int institution)
    {
        Database db = new Database();
        int result;

        if (institution >= 0) // assuming negative numbers are out of range
            result = db.ExecuteSpRetVal(chapterID, institution);
        else
            result = db.ExecuteSpRetVal(chapterID);

        return result > 0;
    }
}

class SubClass1 : SuperClass
{
    public bool HasContent(int chapterID)
    {
        return base.HasContentImpl(chapterID, -1);
    }
}

class SubClass2 : SuperClass
{
    public bool HasContent(int chapterID, int institution)
    {
        return base.HasContentImpl(chapterID, institution);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-08T00:48:24.263

通过将两个具有不同参数的同名方法放入超类中来使用方法重载。当您调用 HasContent 时，它将使用与您提供的参数的数量和类型匹配的任何一个。因为它在超类中，所以如果您以后决定创建一个也使用此方法的新子类，您现在不必再制作它的另一个副本。请参阅下面的示例代码；

```
protected bool HasContent(int chapterID, int institution)
{
    Database db = new Database();
    int result;

    result = db.ExecuteSpRetVal(chapterID, institution);

    return result > 0;
}

protected bool HasContent(int chapterID)
{
    Database db = new Database();
    int result;

    result = db.ExecuteSpRetVal(chapterID);

    return result > 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T10:33:38.613

你说：

> 两种方法的目的是一样的

所以是的，听起来你有一个可以放在超类中的通用方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T12:34:21.757

由于 HasContent() 采用不同的增强，我不会将其移至基类，两个方法被称为相同的事实并不意味着它们做同样的事情。

我不知道您的代码库或您正在使用的系统是做什么的，但是鉴于我所掌握的信息很少，您的设计有些东西*感觉*不对。过去我发现，当我遇到这种设计问题时，通常是由于数据模型的其他问题。抱歉，如果您无法更改系统的其余部分，则无法匹配帮助...。

# java - 如何暂时禁用消息侦听器

> ID：625725
> 
> 赞同：18
> 
> 时间：2009-03-09T10:29:08.187
> 
> 标签：java, jms

什么是暂时禁用消息侦听器的好方法？我要解决的问题是：

*   消息侦听器接收到 JMS 消息
*   尝试处理消息时出现错误。
*   我等待我的系统再次准备好能够处理消息。
*   在我的系统准备好之前，我不想再收到任何消息，所以...
*   ...我想禁用消息侦听器。
*   我的系统已准备好再次处理。
*   失败的消息得到处理，JMS 消息得到确认。
*   再次启用消息侦听器。

现在，我正在使用 Sun App Server。我通过在 MessageConsumer 中将其设置为 null 来禁用消息侦听器，并使用 setMessageListener(myOldMessageListener) 再次启用它，但在此之后我不再收到任何消息。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T22:49:38.563

`onMessage()`如果您在系统准备好再次处理消息之前不从侦听器方法返回，该怎么办？这将阻止 JMS 向该消费者传递另一条消息。

`receive()`这是在同步情况下不调用的异步等价物。

给定的 JMS 会话没有多线程，因此消息管道一直保持到`onMessage()`方法返回。

我不熟悉动态调用的含义`setMessageListener()`。javadoc 说，如果在“现有侦听器或同步消费者正在使用消息时”调用，则会[出现未定义的行为。](http://java.sun.com/j2ee/1.4/docs/api/javax/jms/MessageConsumer.html#setMessageListener(javax.jms.MessageListener))如果您从 inside 调用`onMessage()`，听起来您遇到了未定义的情况。

连接级别有[启动](http://java.sun.com/j2ee/1.4/docs/api/javax/jms/Connection.html#start())/[停止](http://java.sun.com/j2ee/1.4/docs/api/javax/jms/Connection.html#stop())方法，如果这对您来说不是太粗粒度的话。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T20:39:02.993

通过用 receive() 循环替换消息侦听器的解决方法解决了问题，但我仍然对如何禁用消息侦听器并很快再次启用它感兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T11:56:06.247

在我看来，消息正在传递，但它们没有发生任何事情，因为您没有附加侦听器。自从我用 JMS 做任何事情以来已经有一段时间了，但是您不希望在修复系统时将消息发送到死信队列或其他东西，然后在您完成后将消息移回原始队列准备好再次处理了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:11:30.120

在 WebLogic 上，您可以设置最大重试次数、用于处理超过最大重试限制的消息的错误队列以及其他参数。我不确定我的头，但你也可以指定一个等待期。所有这些都可以在管理控制台中使用。我会查看您拥有的 JMS 提供程序的管理员，看看它是否可以做类似的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-14T18:01:52.113

在 JBoss 中，以下代码可以解决问题：

```
 MBeanServer mbeanServer = MBeanServerLocator.locateJBoss();
    ObjectName objName = new ObjectName("jboss.j2ee:ear=MessageGateway.ear,jar=MessageGateway-EJB.jar,name=MessageSenderMDB,service=EJB3");
    JMSContainerInvokerMBean invoker = (JMSContainerInvokerMBean) MBeanProxy.get(JMSContainerInvokerMBean.class, objName, mbeanServer);

    invoker.stop(); //Stop MDB
    invoker.start(); //Start MDB 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-06T09:37:33.667

我想你可以打电话

```
messageConsumer.setMessageListener(null); 
```

在 MessageListener 实现中并安排重建任务（例如在 ScheduledExecutorService 中）。这个任务应该调用

```
connection.stop();
messageConsumer.setMessageListener(YOUR_NEW_LISTENER);
connection.start(); 
```

它会起作用的。start() 和 stop() 方法用于重新启动传递结构（不是 TCP 连接）。

阅读 Javadoc [https://docs.oracle.com/javaee/7/api/javax/jms/Connection.html#stop--](https://docs.oracle.com/javaee/7/api/javax/jms/Connection.html#stop--)

> 暂时停止连接传递传入消息。可以使用连接的启动方法重新启动交付。当连接停止时，将禁止向所有连接的消息消费者传递：同步接收阻塞，并且消息不会传递给消息侦听器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-01T14:07:12.113

要暂时停止连接传递传入消息，您需要使用接口中的`stop()`方法： [https ://docs.oracle.com/javaee/7/api/javax/jms/Connection.html#stop--](https://docs.oracle.com/javaee/7/api/javax/jms/Connection.html#stop--)`Connection`

只是不要调用`connection.stop()`，`MessageListener`因为根据 JMS 规范。你会遇到死锁或异常。相反，您可以`connection.stop()`从不同的线程调用，您只需要同步`MessageListener`和线程将挂起与函数的连接`connection.stop()`

# java - Java：超类中的同步方法获得与子类中相同的锁，对吗？

> ID：625726
> 
> 赞同：23
> 
> 时间：2009-03-09T10:29:56.047
> 
> 标签：java, concurrency

```
class A {
    public synchronized void myOneMethod() {
        // ...
    }
}

class B extends A {
    public synchronized void myOtherMethod() {
        // ...
    }
}

// ...

B myObject;

// ...

myObject.myOneMethod(); // acquires lock
myObject.myOtherMethod(); // same lock? 
```

我如何理解同步模型，我会说是的，它确实如此，因为锁/监视器与实例 myObject 相关联，并且在哪里定义方法并不重要。但我说得对吗？如果不是，为什么？如果是，为什么你确定，而我不是？:-)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T10:33:53.697

是的，你是对的，你也得到了正确的解释。没什么可补充的。

请注意，如果方法是*静态*的，那么它们将在不同的对象上同步，即它们各自的类（A 和 B）。

*编辑*：为什么我确定？我不知道，你为什么不确定？;-)`myObject`只是一个对象 -`myObject`来自 A 类的属性和来自 B 类的属性之间没有任何区别。（嗯，从技术上讲，您可能可以使用反射来找出哪些是哪些，所以必须有*有一些*区别，但暂时忘记反射。对于对象的常见操作没有区别。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T10:33:52.043

是的，同步等同于同步（this）。

更[准确地说](http://java.sun.com/docs/books/jls/second_edition/html/classes.doc.html#260369)：

> 对于类（静态）方法，使用与方法类的 Class 对象关联的锁。对于实例方法，使用与 this（调用该方法的对象）关联的锁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T19:43:17.980

如果您想更明确地了解您的锁定，您可以执行以下操作：

```
class A {

    protected final Object  mutex = new Object();
    public void myOneMethod() {
        synchronized (mutex) {
            // ...
        }
    }
}

class B extends A {
    public  void myOtherMethod() {
        synchronized (mutex) {
            // ...
        }
    }
} 
```

事实上，这种模式是 Brian Goetz 在*Java Concurrency in Practice*中推荐的，第 4.2.1 节“Java 监视器模式”。这样你就知道你的显示器来自哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T10:34:29.593

是的。Java 使用“监视器”来实现同步，同步方法使用它们被调用的对象实例作为监视器，这在本例中显然是相同的。

请注意，这不适用于静态方法！在那里，（我认为）声明类的类实例被使用，这不会是同一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T10:35:23.867

是的，你是对的

当一个线程正在为一个对象执行同步方法时，所有其他为同一对象调用同步方法的线程都会阻塞（暂停执行），直到第一个线程处理完该对象。在这种情况下，对象是 B

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-12T12:36:28.327

对于可能对未来感兴趣的人来说，只是一个小小的补充。

另外请记住，Java 中的锁是可重入的。如果它们不是您的此代码将导致死锁，因为正如您所指出的，这两个操作都需要相同的锁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-15T06:40:11.597

`synchonized`从概念的角度来看，如果类的方法`A`只保护`A`子类上下文中的数据，则某些继承场景的互斥完整性将被破坏`B`。毕竟，并不是所有`A`的数据都必须是`private`。

想象一下，您想稍微扩展一种方法的功能，同时保留包括互斥保护在内`A`的其余功能。`A`如果`A`只是保护自己，您最终将不得不覆盖*所有*的方法以将原始同步机制提升到新的子类`A`。`synchronized`不是很有吸引力，也不是很有效。

# .net - WinForms 音量滑块/轨迹栏用户控件

> ID：625728
> 
> 赞同：5
> 
> 时间：2009-03-09T10:30:28.700
> 
> 标签：.net, winforms, slider, volume, trackbar

我正在寻找在我的 .NET 2.0 WinForms 应用程序中使用的类似轨迹栏的用户/自定义控件。

注意：我不是在问如何控制 WinForms 应用程序中的音量。

任何人都知道可以在我的应用程序中使用的漂亮的自定义绘制滑块/轨迹栏控件来让用户设置音量？（例如多媒体应用程序中使用的那些）

理想情况下，它应该支持垂直方向。

TIA,

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T17:00:39.103

CodeGuru 上有一个关于如何创建自己的自定义轨迹栏的优秀 C# 教程：

[http://www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c12101](http://www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c12101)

结果看起来非常令人印象深刻，并且因为您正在创建自己的控件，所以您不必担心许可 3rd 方控件。只需确保也遵循示例代码的许可。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-04T09:36:16.983

有一个 TrackBar 控件，只是有点难找，因为它在工具栏上没有分类。打开“所有 Windows 窗体”。根据[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.trackbar.aspx)，它自 .NET 1.0 以来一直存在

# ruby - Ruby 为行读取读取不同的文件大小

> ID：625733
> 
> 赞同：0
> 
> 时间：2009-03-09T10:32:30.380
> 
> 标签：ruby, file-read

我需要做一些文件大小至关重要的事情。这产生了奇怪的结果

```
filename = "testThis.txt"
total_chars = 0
file = File.new(filename, "r")
file_for_writing = nil
while (line = file.gets)
  total_chars += line.length
end
puts "original size #{File.size(filename)}"
puts "Totals #{total_chars}" 
```

像这样

```
original size 20121
Totals 20061 
```

为什么第二个短了？

编辑：回答者的预感是正确的：测试文件中有 60 行。如果我改变这条线

```
 total_chars += line.length + 1 
```

它完美地工作。但是在 *nix 上，这种变化会不会出错？

**编辑：**跟进现在[在这里](https://stackoverflow.com/questions/628096)。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T10:47:00.733

文件中存储了用于描述行的特殊字符：

*   CR LF (0x0D 0x0A) (\r\n) 在 Windows/DOS 和
*   UNIX 系统上的 0x0A (\n)。

Ruby`gets`使用 UNIX 方法。因此，如果您读取 Windows 文件，您将在读取的每一行中丢失 1 个字节，因为 \r\n 字节被转换为 \n。

也不`String.length`是衡量字符串大小（以字节为单位）的好方法。如果字符串不是 ASCII，则一个字符可能由多个字节 (Unicode) 表示。也就是说，它返回字符串中的字符数，而不是字节数。

要获取文件的大小，请使用`File.size(file_name)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T10:43:57.153

我的猜测是您在 Windows 上，并且您的“testThis.txt”文件有 \r\n 行结尾。当文件以文本模式打开时，每一行结尾都将转换为单个 \n 字符。因此，您每行将丢失 1 个字符。

你的测试文件有 60 行吗？这与这个解释是一致的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T10:54:56.517

行尾问题是最有可能的罪魁祸首。

还值得注意的是，如果文本文件的字符编码不是 ASCII，那么两者之间也会有差异。如果文件是 UTF-8，这将适用于仅使用标准 ASCII 字母符号的英语和一些欧洲语言。除此之外，文件大小和字符数可能会有很大差异（与字符数相比，文件大小最多是文件大小的 4 倍甚至 6 倍）。

依赖“1 个字符 = 1 个字节”只是自找麻烦，因为它几乎肯定会在某个时候失败。

# oracle - 在存储过程中截断表

> ID：625743
> 
> 赞同：58
> 
> 时间：2009-03-09T10:34:28.797
> 
> 标签：oracle, stored-procedures, plsql, ddl

当我在 Oracle shell 中运行以下命令时，它工作正常

```
truncate table table_name 
```

但是当我尝试将其放入存储过程中时

```
CREATE OR REPLACE PROCEDURE test IS
BEGIN
    truncate table table_name;
END test;
/ 
```

它失败了

```
ERROR line 3, col 14, ending_line 3, ending_col 18, Found 'table', Expecting:  @   ROW  or   (   or   .   or   ;   := 
```

为什么？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-03-09T11:00:38.377

Oracle PL/SQL 中的所有 DDL 语句都应该在语句之前使用 Execute Immediate。因此，您应该使用：

```
execute immediate 'truncate table schema.tablename'; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-09T12:07:00.103

除了立即执行，您还可以使用

`DBMS_UTILITY.EXEC_DDL_STATEMENT('TRUNCATE TABLE tablename;');`

该语句失败，因为存储过程正在执行 DDL，并且某些 DDL 实例可能会使存储过程无效。通过使用立即执行或 exec_ddl 方法，DDL 是通过未解析的代码实现的。

执行此操作时，您需要注意 DDL 在执行之前和之后都会发出隐式提交这一事实。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-09T10:38:44.013

试试下面的代码

```
execute immediate 'truncate table tablename' ; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-02-15T18:46:20.587

您应该知道，不可能像从 PL/SQL 块中对 DML 那样直接运行 DDL 语句，因为 PL/SQL 不直接支持后期绑定，它只支持对 DML 很好的编译时绑定。因此，为了克服此类问题，oracle 提供了一种动态 SQL 方法，可用于执行 DDL 语句。动态 sql 方法是关于在运行时解析和绑定 sql 字符串。此外，您应该记住 DDL 语句默认是自动提交的，因此您应该小心使用动态 SQL 方法的任何 DDL 语句，以防在执行 DDL 之前有一些 DML（需要使用 TCL 显式提交）存储过程/函数。

您可以使用以下任何动态 sql 方法从 pl/sql 块执行 DDL 语句。

1) 立即执行

2) DBMS_SQL 包

3) DBMS_UTILITY.EXEC_DDL_STATEMENT (parse_string IN VARCHAR2);

希望这能用解释回答你的问题。

# c# - Linq2Sql：HasValue 和 != null 是否对可空类型起作用？

> ID：625754
> 
> 赞同：6
> 
> 时间：2009-03-09T10:37:17.793
> 
> 标签：c#, linq-to-sql

有什么理由我应该选择其中一个而不是另一个？还是真的不重要？

```
var a = data.Cars.Where(ø => ø.LicensePlate != null);

var b = data.Cars.Where(ø => ø.LicensePlate.HasValue); 
```

我以前用过`!= null`，但开始认为我应该换掉，因为 HasValue 读起来更好。你们有什么感想？有什么区别吗？除了一个字符之外？任何性能差异？sql的区别？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T10:39:13.310

不，这两种说法都是一样的，你应该选择你觉得更易读的那一种。

值得注意的是，编译器会将`null`a 上的比较替换`Nullable<T>`为对`HasValue`. 换句话说：

```
class Program
{
    static void Main()
    {
        int? i = 0;

        Console.WriteLine(i != null);
        Console.WriteLine(i.HasValue);
    }
} 
```

被编译成这样：

```
private static void Main()
{
    int? i = 0;
    Console.WriteLine(i.HasValue);
    Console.WriteLine(i.HasValue);
} 
```

# c# - 如何在 .NET GUI 标签中显示上标字符？

> ID：625759
> 
> 赞同：7
> 
> 时间：2009-03-09T10:39:32.640
> 
> 标签：c#, string

是否可以在 GUI 中构建字符串或修复标签，以便我向用户获取平方米信息。这样输出看起来像 21 m2，但 2 被提高了。

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T10:41:22.387

使用“²”字符：21 m²

unicode 码位是 U+00B2，UTF-8 十六进制是 c2 b2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T10:44:40.473

使用具有 ² 字符的字体。

例如 MS 无衬线字体：0xB2

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T10:45:05.183

在标签中，使用 HTML 字符引用“ `&sup2;`”作为 m² 的上标。

# wpf - WPF 列表框和键盘导航

> ID：625761
> 
> 赞同：8
> 
> 时间：2009-03-09T10:41:00.217
> 
> 标签：wpf, listbox, keyboard

我有一个带有 ItemTemplate 的数据绑定 ListBox，我想在其上启用键盘导航。

如果我没有使用项目模板而只使用了 DisplayMemberPath，那么该列表将可以使用键盘导航。例如，按“G”会将所选项目设置为以 G 开头的第一个列表项。使用项目模板显然会使这变得更加困难，因为模板中有零个或多个用于此类导航的文本候选。

我的问题是如何将元素标记为导航源或使用其他方法模拟此效果？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T10:48:41.993

如果您有要导航的文本属性，这是可能的：

```
<ListBox TextSearch.TextPath="Name" ... /> 
```

将 TextSearch.TextPath 指向要启用键盘查找的属性（本例中为“名称”）。

# asp.net - 确定 ASP.NET 客户端 ID

> ID：625765
> 
> 赞同：0
> 
> 时间：2009-03-09T10:41:39.437
> 
> 标签：asp.net, javascript

这个问题类似于[Forcing client ids in ASP.NET](https://stackoverflow.com/questions/546392/forcing-client-ids-in-asp-net)但不完全一样。

ASP.NET 根据自己的内部机制生成 clientid。我想在后台运行一个 xmlhttprequest 查询来进行更新并有选择地重新加载一些控件。我的计划是在后台运行查询并重新生成页面，但只选择性地呈现我想要更新的控件 - 然后只需将这些控件的 html 替换为新控件。

我的问题是，我是否可以期望客户端 ID 相同（因为我正在生成相同的页面），如果我想通过 javascript 更新 asp.net 生成的 html，还有什么需要注意的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T20:36:31.673

I use the following trick to get the ClientID of an ASP.NET control:

```
<script type="text/javascript">
//textBox will contain the DOM element rendered for the <asp:TextBox /> control
var textBox = document.getElementById("<%= nameTextBox.ClientID %>");
</script>
<asp:TextBox runat="server" ID="TextBox1" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T10:57:03.173

ASP.NET 根据控件在页面层次结构中的位置生成控件名称和 ID。

如果此层次结构不会在连续的页面重新生成之间发生变化，那么您可以确定生成的控件 ID 不会有所不同。另一个值得注意的点是，当您使用片段缓存时，控制 ID 在每个请求上都有随机名称。

另一个想法是将 ClientID（可用的服务器端）存储到隐藏字段中，然后通过脚本检索此信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T11:02:30.493

*虽然系统是可预测的，但不建议在*生成这些名称时建立对这些名称的依赖关系，并且它会造成难以维护的负担，并且当您的页面发生更改时，可能会出现一些细微的错误，*它们会*。

这都是使用 asp.net 的问题的一部分，我建议你找到一种更可靠的方法来定位节点，比如定位非 asp 包装器节点，然后查看子节点，或者定位类名。

# javascript - 检测当前 Internet Explorer 安全区域

> ID：625768
> 
> 赞同：9
> 
> 时间：2009-03-09T10:43:09.917
> 
> 标签：javascript, html, security, internet-explorer, xmlhttprequest

是否有任何以编程方式确定 Internet Explorer 当前安全区域设置的方法？

我想知道我的站点何时会因为 IE 安全策略而阻止 XMLHttpRequest ActiveX 控件，但在站点实际尝试创建它并因此导致黄色条出现在顶部之前（说“帮助保护您的安全, Internet Explorer 已限制此网页运行可访问您计算机的脚本或 ActiveX 控件。")

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-01-11T14:21:58.363

在 IE7 中，您可以使用以下 JavaScript 来了解您的网站是否受信任：

```
window.status = "test";
if (window.status == "test")
  alert("Trusted, or local intranet");
else
  alert("Not trusted, or internet"); 
```

这是基于在 IE7 及更高版本中，脚本无法再通过 Internet 和受限区域中的 window.status 方法设置状态栏文本。请参阅[Internet Explorer 7 的发行说明](http://msdn.microsoft.com/en-us/ie/aa740486)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-14T18:28:49.343

安全区域无关紧要，因为 Windows 用户可以自己确定哪些协议由哪个区域处理。例如，我将整个 http 和整个 https 区域添加到受信任的站点区域（区域 2）。这是通过密钥完成的

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet     Settings\ZoneMap\ProtocolDefaults 
```

您可以通过 javascript 检查 document.protocol，但这对您有什么帮助？

```
if (document.protocol == "HTTP (HyperText Transfer-Protokoll)") 
```

您假设它是互联网区域，但在我的计算机上，它是受信任区域，具有自己的个人安全设置。很遗憾 jscript 不允许您为每个区域获取单独的安全设置值。

可以在没有那个愚蠢的黄色条的情况下执行 activex 对象，但是您需要将 com 对象 guid 添加到安全 com 对象列表中。这是通过注册表完成的。对于大多数对象，默认值是不安全的，除了一些愚蠢的无用垃圾对象，如 flash activex、wmp activex 和其他东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:52:04.630

> 我想知道我的网站什么时候会因为 IE 安全策略而阻止 XMLHttpRequest ActiveX 控件

即使您确实知道您所在的区域，您也无法读取，因为您无法读取每个区域的设置，并且从 IE6SP2 开始，还有更多影响 ActiveX 的设置无法在每个区域的基础上进行配置。（IE7 具有更多特定于控件的设置。）

我不知道如何推测性地创建一个 XMLHttpRequest 并避免黄色条，只使用本机的“新 XMLHttpRequest()”对象，这会使您与 IE6 不兼容。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-09T11:06:39.733

**注意**：我无法删除已接受的答案，但您可能会发现[此答案很有用](https://stackoverflow.com/a/8820863/75525)。

原答案：

JavaScript 中没有句柄来检测 IE 正在使用的安全区域。

为了做你需要做的事情，你可以检查 document.location 并从中确定安全区域。

# c# - 在 Excel 中以编程方式设置页面设 置选项

> ID：625781
> 
> 赞同：2
> 
> 时间：2009-03-09T10:49:16.000
> 
> 标签：c#, asp.net

我有一个 ASP.NET Web 应用程序，它通过创建 HTML 表并复制内容来将报告复制到 Excel 工作表。我想在触发打印选项之前将 excel 报告放入 1 页。这需要在我生成 Excel 工作簿时以编程方式完成。请尽快提供解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:02:52.863

以下是我用来打开 Excel 工作簿并使用自定义打印机设置打印它的代码：

```
Dim xl As New Excel.Application
    xl.DisplayAlerts = False
    xl.Workbooks.Open("<FilePath>", Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, _
    Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing)
    Dim sheet As Excel.Worksheet

    Dim ws
    Try
        For Each ws In xl.ActiveWorkbook.Worksheets
            ws.Select(Type.Missing)
            With ws.PageSetup
                .PaperSize = Excel.XlPaperSize.xlPaperA4
                .Orientation = Excel.XlPageOrientation.xlLandscape
                .Zoom = 80
                .BottomMargin = 0.25
                .LeftMargin = 0.25
                .RightMargin = 0.25
                .TopMargin = 0.25
                .FitToPagesWide = 1
            End With
            ws.PrintOut(Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing)
        Next

    Catch exp As Exception
        MsgBox("Unable to setup printing properties for the sheet." & Chr(13) & "Check if you have printer installed on your machine.", MsgBoxStyle.OKOnly)

    Finally
        xl.Workbooks.Close()
        xl.Quit()
        While (System.Runtime.InteropServices.Marshal.ReleaseComObject(xl) > 0)
            ''do nothing
        End While
        xl = Nothing
    End Try 
```

# asp.net - 如果访问 SessionID，是否会重置 ASP.Net Inproc 会话超时？

> ID：625782
> 
> 赞同：0
> 
> 时间：2009-03-09T10:49:33.020
> 
> 标签：asp.net, session-state

我[在这里](http://msdn.microsoft.com/en-us/library/aa479041.aspx)读到，每次访问（读取或写入）时，inproc asp.net 会话都会重置它的超时。我的问题是，如果我只读取 sessionID，是否也会重置超时？

示例：会话超时设置为 20 分钟。15分钟后。我加载一个页面并读取 Session.SessionID。再过 10 分钟，会话还会存在吗？

还有一个问题：页面是直接加载还是通过 AJAX 访问有关系吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T11:21:43.957

在我看来，您混淆了两种不同的事物：从 Session 状态（在代码中）读取值与将 SessionState 的实例附加到当前请求不同。

除非我大错特错，否则每当您访问 Session 对象（再次，在代码中）时，都不会刷新超时，而是在提供新请求时刷新。发生这种情况是因为 SessionState 项本身已添加到缓存中（并且设置了过期策略）

所以，回答你的问题：超时不会被重置。

详细说明您给出的示例：超时将在页面*加载*时重置，而不是在您读取代码中的 SessionID 时重置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T11:21:38.730

访问 SessionID 不会影响会话超时。如果您看一下 Reflector，SessionID 属性（在 HttpSessionStateContainer 中实现）如下所示：

```
public string SessionID
{
    get
    {
        if (this._id == null)
        {
            this._id = this._stateModule.DelayedGetSessionId();
        }
        return this._id;
    }
} 
```

这不会触及底层存储项目。

此外，在那个级别上，请求来自哪里（ajax/normal）并不重要。

# c - 如何编写通用 C 函数来调用 Win32 函数？

> ID：625784
> 
> 赞同：6
> 
> 时间：2009-03-09T10:50:35.327
> 
> 标签：c, winapi, interop, libffi, rubydl

为了允许从脚本语言（用 C 编写）访问 Win32 API，我想编写如下函数：

```
void Call(LPCSTR DllName, LPCSTR FunctionName, 
  LPSTR ReturnValue, USHORT ArgumentCount, LPSTR Arguments[]) 
```

通常，它将调用任何 Win32 API 函数。

（LPSTR 参数本质上被用作字节数组 - 假设它们的大小已经正确，可以在函数外部采用正确的数据类型。另外我相信需要一些额外的复杂性来区分指针和非指针参数，但我出于这个问题的目的，我忽略了这一点）。

我遇到的问题是将参数传递给 Win32 API 函数。因为这些是标准调用，我不能使用可变参数，所以“调用”的实现必须提前知道参数的数量，因此它不能是通用的......

我想我可以用汇编代码来做到这一点（通过循环参数，将每个参数推入堆栈），但这在纯 C 中可能吗？

**更新：**我现在已将“不，不可能”的答案标记为已接受。如果基于 C 的解决方案出现，我当然会改变这一点。

**更新：** [ruby/dl](http://www.jbrowse.com/text/rdl_en.html)看起来可以使用合适的机制来实现。对此的任何细节将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T11:11:09.147

首先要做的事情是：您不能在 C 中将类型作为参数传递。您剩下的唯一选择是宏。

如果您正在`LoadLibrary/GetProcAddress`调用 Win32 函数，则此方案只需稍作修改（参数为 void * 的数组）即可工作。否则有一个函数名字符串是没有用的。在 C 中，调用函数的唯一方法是通过它的名称（标识符），在大多数情况下，它会衰减为指向函数的指针。您还必须注意转换返回值。

我最好的选择：

```
// define a function type to be passed on to the next macro
#define Declare(ret, cc, fn_t, ...) typedef ret (cc *fn_t)(__VA_ARGS__)

// for the time being doesn't work with UNICODE turned on
#define Call(dll, fn, fn_t, ...) do {\
    HMODULE lib = LoadLibraryA(dll); \
    if (lib) { \
        fn_t pfn = (fn_t)GetProcAddress(lib, fn); \
        if (pfn) { \
            (pfn)(__VA_ARGS__); \
        } \
        FreeLibrary(lib); \
    } \
    } while(0)

int main() {
    Declare(int, __stdcall, MessageBoxProc, HWND, LPCSTR, LPCSTR, UINT);

    Call("user32.dll", "MessageBoxA", MessageBoxProc, 
          NULL, ((LPCSTR)"?"), ((LPCSTR)"Details"), 
          (MB_ICONWARNING | MB_CANCELTRYCONTINUE | MB_DEFBUTTON2));

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T11:09:38.933

不，我认为不编写一些程序集是不可能的。原因是您需要在调用目标函数之前精确控制堆栈上的内容，而在纯 C 中没有真正的方法可以做到这一点。当然，在汇编中很简单。

此外，您将 PCSTR 用于所有这些参数，这实际上只是`const char *`. 但是由于所有这些 args 都不是字符串，因此您实际上想要用于返回值和 Arguments[] 的是`void *`or `LPVOID`。当您不知道参数的真实类型时，您应该使用这种类型，而不是将它们强制转换为`char *`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T06:49:28.897

其他帖子几乎肯定需要汇编或其他非标准技巧来实际进行调用，更不用说实际调用约定的所有细节了。

Windows DLL 使用至少两种不同的函数调用约定：`stdcall`和`cdecl`. 您需要同时处理这两种情况，甚至可能需要弄清楚使用哪个。

解决这个问题的一种方法是使用现有的库来封装许多细节。令人惊讶的是，有一个：[libffi](http://sourceware.org/libffi/)。它在脚本环境中使用的一个例子是 Lua [Alien](http://alien.luaforge.net/)的实现，这是一个 Lua 模块，它允许在除了 Alien 本身之外的纯 Lua 中创建任意 DLL 的接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T10:29:16.977

许多 Win32 API 采用指向具有特定布局的结构的指针。其中，一个大子集遵循一个通用模式，其中第一个 DWORD 必须在调用之前初始化为具有结构的大小。有时他们需要传递一块内存，他们将向其中写入一个结构，并且内存块的大小必须通过首先使用 NULL 指针调用相同的 API 并读取返回值以发现正确的尺寸。一些 API 分配一个结构并返回一个指向它的指针，因此必须在第二次调用时释放该指针。

如果可以一次有效地调用的 API 集（可以从简单的字符串表示形式转换的单个参数）非常小，我不会感到惊讶。

为了使这个想法普遍适用，我们必须走极端：

```
typedef void DynamicFunction(size_t argumentCount, const wchar_t *arguments[],
                             size_t maxReturnValueSize, wchar_t *returnValue);

DynamicFunction *GenerateDynamicFunction(const wchar_t *code); 
```

您可以将一个简单的代码片段传递给 GenerateDynamicFunction，它会将该代码包装在一些标准样板文件中，然后调用 C 编译器/链接器以从中生成一个包含该函数的 DLL（有很多免费选项可用）。然后它会`LoadLibrary`使用那个 DLL`GetProcAddress`来查找函数，然后返回它。这会很昂贵，但您会执行一次并缓存生成的 DynamicFunctionPtr 以供重复使用。您可以通过将指针保存在哈希表中来动态地执行此操作，并由代码片段本身键入。

样板文件可能是：

```
#include <windows.h> 
// and anything else that might be handy

void DynamicFunctionWrapper(size_t argumentCount, const wchar_t *arguments[],
                             size_t maxReturnValueSize, wchar_t *returnValue)
{
    // --- insert code snipped here
} 
```

因此，该系统的示例用法是：

```
DynamicFunction *getUserName = GenerateDynamicFunction(
    "GetUserNameW(returnValue, (LPDWORD)(&maxReturnValueSize))");

wchar_t userName[100];
getUserName(0, NULL, sizeof(userName) / sizeof(wchar_t), userName); 
```

您可以通过`GenerateDynamicFunction`接受参数计数来增强这一点，因此它可以在包装器的开头生成检查是否已传递正确数量的参数。如果你在其中放置一个哈希表来缓存每个遇到的代码片段的函数，你可以接近你的原始示例。Call 函数将采用代码片段而不仅仅是 API 名称，但在其他方面是相同的。它会在哈希表中查找代码片段，如果不存在，它将调用 GenerateDynamicFunction 并将结果存储在哈希表中以备下次使用。然后它将执行对该函数的调用。示例用法：

```
wchar_t userName[100];

Call("GetUserNameW(returnValue, (LPDWORD)(&maxReturnValueSize))",
     0, NULL, sizeof(userName) / sizeof(wchar_t), userName); 
```

当然，除非这个想法是为了打开某种一般的安全漏洞，否则这样做没有多大意义。例如作为网络服务公开`Call`。您最初的想法存在安全隐患，但不太明显，因为您建议的原始方法不会那么有效。我们制造的功能越强大，安全问题就越大。

**根据评论更新：**

.NET 框架有一个称为 p/invoke 的功能，它的存在正是为了解决您的问题。因此，如果您将其作为一个学习项目的项目，您可以查看 p/invoke 以了解它的复杂程度。您可以使用您的脚本语言来定位 .NET 框架 - 您可以将它们编译为 IL，而不是实时解释脚本或将它们编译为您自己的字节码。或者，您可以托管 .NET 上已有的许多现有脚本语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-01T09:36:31.473

您可以尝试这样的事情 - 它适用于 win32 API 函数：

```
int CallFunction(int functionPtr, int* stack, int size)
{
    if(!stack && size > 0)
        return 0;
    for(int i = 0; i < size; i++) {
        int v = *stack;
        __asm {
            push v
        }
        stack++;
    }
    int r;
    FARPROC fp = (FARPROC) functionPtr;
    __asm {
        call fp
        mov dword ptr[r], eax
    }
    return r;
} 
```

“stack”参数中的参数应该是相反的顺序（因为这是它们被压入堆栈的顺序）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T17:34:38.117

拥有这样的功能听起来是个坏主意，但你可以试试这个：

```
int Call(LPCSTR DllName, LPCSTR FunctionName, 
  USHORT ArgumentCount, int args[])
{
   void STDCALL (*foobar)()=lookupDLL(...);

   switch(ArgumentCount) {
        /* Note: If these give some compiler errors, you need to cast
           each one to a func ptr type with suitable number of arguments. */
      case 0: return foobar();
      case 1: return foobar(args[0]);
      ...
   }
} 
```

在 32 位系统上，几乎所有值都适合 32 位字，较短的值作为函数调用参数的 32 位字被推入堆栈，因此您应该能够以这种方式调用几乎所有 Win32 API 函数，只需将参数转换为 int 并将返回值从 int 转换为适当的类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T17:44:46.550

我不确定它是否会引起您的兴趣，但可以选择使用 RunDll32.exe 并让它为您执行函数调用。RunDll32 有一些限制，我不相信您可以访问返回值，但是如果您正确地形成命令行参数，它将调用该函数。

这是一个[链接](http://support.microsoft.com/kb/164787)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T20:25:24.463

首先，您应该将每个参数的大小添加为额外参数。否则，您需要预测每个函数的每个参数的大小以推入堆栈，这对于 WinXX 函数是可能的，因为它们必须与它们记录的参数兼容，但很乏味。

其次，除了 varargs 函数之外，没有“纯 C”方法可以在不知道参数的情况下调用函数，并且对 .DLL 中的函数使用的调用约定没有任何限制。

实际上，第二部分比第一部分更重要。

理论上，您可以设置一个预处理器宏/#include 结构来生成参数类型的所有组合，例如最多 11 个参数，但这意味着您提前知道哪些类型将通过您的函数传递`Call`。如果你问我，这有点疯狂。

虽然，如果您真的想不安全地执行此操作，您可以传递 C++ 错位名称并使用它`UnDecorateSymbolName`来提取参数的类型。但是，这不适用于使用 C 链接导出的函数。

# python - 如何将所有参数传递给装饰器？

> ID：625786
> 
> 赞同：2
> 
> 时间：2009-03-09T10:51:18.570
> 
> 标签：python, decorator

我尝试使用装饰器跟踪某些方法的执行。这是装饰器代码：

```
def trace(func):
    def ofunc(*args):
        func_name = func.__name__       
        xargs = args        
        print "entering %s with args %s" % (func_name,xargs)
        ret_val = func(args)
        print "return value %s" % ret_val
        print "exiting %s" % (func_name)
    return ofunc 
```

问题是，如果我尝试将此装饰器应用于方法，则不会发送 self 参数。你能告诉我为什么，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T10:58:51.673

此行不正确：

```
ret_val = func(args) 
```

当您传递参数列表时，您忘记扩展参数列表。它应该是：

```
ret_val = func(*args) 
```

进行此修改后的示例输出：

```
>>> class Test2:
...     @trace
...     def test3(self, a, b):
...        pass
... 
>>> t = Test2()
>>> t.test3(1,2)
entering test3 with args (<__main__.Test2 instance at 0x7ff2b42c>, 1, 2)
return value None
exiting test3
>>> 
```

如果你曾经扩展你的装饰器来接受关键字参数，你还需要在传递它们时适当地扩展它们，使用`**`.

# visual-studio-2008 - Visual Studio 2008 宏问题

> ID：625793
> 
> 赞同：0
> 
> 时间：2009-03-09T10:56:08.950
> 
> 标签：visual-studio-2008, visual-studio-macros

我一直在尝试在 Visual Studio 中编写一个简短的宏来激活 FindSymbolResults (Constants.vsWindowKindFindSymbolResults)，然后移动到列表中的下一项（如果有的话）并在其上调用 Edit.GotoReference。第一部分和最后一部分 - 显示窗口并调用 Edit.GoToReference - 已经完成，但我正在努力移动到窗口中的下一个项目。有没有人可以分享这样做或类似的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-04T01:00:12.250

我知道在 VS F8 中通常会导航到下一个结果。考虑到这一点，我录制了一个临时宏来查看它可能会产生什么。有了这些结果，我编写了这个快速的小宏，它将执行并打开查找符号搜索的前 10 个结果。

```
Sub OpenAllFindSymbols()
    DTE.ExecuteCommand("Edit.FindSymbol")
    DTE.Windows.Item("{CF2DDC32-8CAD-11D2-9302-005345000000}").Close()
    For i = 1 To 10
        DTE.ExecuteCommand("Edit.GoToNextLocation")
    Next
End Sub 
```

,我想你可能最感兴趣的一点是

```
 DTE.ExecuteCommand("Edit.GoToNextLocation") 
```

# c++ - 解决由于类之间的循环依赖而导致的构建错误

> ID：625799
> 
> 赞同：433
> 
> 时间：2009-03-09T10:57:28.867
> 
> 标签：c++, compiler-errors, circular-dependency, c++-faq

我经常发现自己在一个 C++ 项目中面临多个编译/链接器错误，这是由于一些糟糕的设计决策（由其他人做出的 :)）导致不同头文件中的 C++ 类之间的循环依赖关系*（也可能发生）在同一个文件中）*。但幸运的是（？）这种情况发生的频率并不高，让我在下次再次发生时记住这个问题的解决方案。

因此，为了便于将来回忆，我将发布一个具有代表性的问题和解决方案。当然欢迎更好的解决方案。

* * *

*   `A.h`

    ```
    class B;
    class A
    {
        int _val;
        B *_b;
    public:

        A(int val)
            :_val(val)
        {
        }

        void SetB(B *b)
        {
            _b = b;
            _b->Print(); // COMPILER ERROR: C2027: use of undefined type 'B'
        }

        void Print()
        {
            cout<<"Type:A val="<<_val<<endl;
        }
    }; 
    ```

* * *

*   `B.h`

    ```
    #include "A.h"
    class B
    {
        double _val;
        A* _a;
    public:

        B(double val)
            :_val(val)
        {
        }

        void SetA(A *a)
        {
            _a = a;
            _a->Print();
        }

        void Print()
        {
            cout<<"Type:B val="<<_val<<endl;
        }
    }; 
    ```

* * *

*   `main.cpp`

    ```
    #include "B.h"
    #include <iostream>

    int main(int argc, char* argv[])
    {
        A a(10);
        B b(3.14);
        a.Print();
        a.SetB(&b);
        b.Print();
        b.SetA(&a);
        return 0;
    } 
    ```

* * *

## 回答 #1

> 赞同：350
> 
> 时间：2009-03-09T21:15:24.577

思考这个问题的方法是“像编译器一样思考”。

想象一下你正在编写一个编译器。你会看到这样的代码。

```
// file: A.h
class A {
  B _b;
};

// file: B.h
class B {
  A _a;
};

// file main.cc
#include "A.h"
#include "B.h"
int main(...) {
  A a;
} 
```

当你在编译**.cc**文件时（记住**.cc**而不是**.h**是编译的单位），你需要为 object 分配空间`A`。那么，那么，有多少空间呢？够收纳`B`！那它的大小是`B`多少？够收纳`A`！哎呀。

显然是一个你必须打破的循环引用。

您可以通过允许编译器保留尽可能多的空间来打破它，例如，指针和引用将始终为 32 位或 64 位（取决于体系结构），因此如果您替换（其中一个）为一个指针或参考，事情会很棒。假设我们替换 in `A`：

```
// file: A.h
class A {
  // both these are fine, so are various const versions of the same.
  B& _b_ref;
  B* _b_ptr;
}; 
```

现在情况好多了。有些。`main()`仍然说：

```
// file: main.cc
#include "A.h"  // <-- Houston, we have a problem 
```

`#include`，对于所有范围和目的（如果您取出预处理器）只需将文件复制到**.cc**中。真的，**.cc**看起来像：

```
// file: partially_pre_processed_main.cc
class A {
  B& _b_ref;
  B* _b_ptr;
};
#include "B.h"
int main (...) {
  A a;
} 
```

你可以看到为什么编译器不能处理这个 - 它不知道是什么`B`- 它甚至从未见过这个符号。

所以让我们告诉编译器关于`B`. 这称为[前向声明](http://en.cppreference.com/w/cpp/language/class)，并在[此答案](https://stackoverflow.com/a/4757718/391161)中进一步讨论。

```
// main.cc
class B;
#include "A.h"
#include "B.h"
int main (...) {
  A a;
} 
```

这*行得通*。这不是*很好*。但是此时您应该了解循环引用问题以及我们为“修复”它所做的工作，尽管修复很糟糕。

这个修复不好的原因是因为下一个人必须在使用它之前`#include "A.h"`声明`B`，并且会得到一个可怕的`#include`错误。所以让我们把声明移到**Ah**本身。

```
// file: A.h
class B;
class A {
  B* _b; // or any of the other variants.
}; 
```

而在**Bh**中，此时，您可以`#include "A.h"`直接。

```
// file: B.h
#include "A.h"
class B {
  // note that this is cool because the compiler knows by this time
  // how much space A will need.
  A _a; 
} 
```

HTH。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-03-09T10:57:46.980

如果从头文件中删除方法定义并让类仅包含方法声明和变量声明/定义，则可以避免编译错误。方法定义应该放在一个 .cpp 文件中（就像最佳实践指南所说的那样）。

以下解决方案的缺点是（假设您已将方法放在头文件中以内联它们）编译器不再内联方法并且尝试使用 inline 关键字会产生链接器错误。

```
//A.h
#ifndef A_H
#define A_H
class B;
class A
{
    int _val;
    B* _b;
public:

    A(int val);
    void SetB(B *b);
    void Print();
};
#endif

//B.h
#ifndef B_H
#define B_H
class A;
class B
{
    double _val;
    A* _a;
public:

    B(double val);
    void SetA(A *a);
    void Print();
};
#endif

//A.cpp
#include "A.h"
#include "B.h"

#include <iostream>

using namespace std;

A::A(int val)
:_val(val)
{
}

void A::SetB(B *b)
{
    _b = b;
    cout<<"Inside SetB()"<<endl;
    _b->Print();
}

void A::Print()
{
    cout<<"Type:A val="<<_val<<endl;
}

//B.cpp
#include "B.h"
#include "A.h"
#include <iostream>

using namespace std;

B::B(double val)
:_val(val)
{
}

void B::SetA(A *a)
{
    _a = a;
    cout<<"Inside SetA()"<<endl;
    _a->Print();
}

void B::Print()
{
    cout<<"Type:B val="<<_val<<endl;
}

//main.cpp
#include "A.h"
#include "B.h"

int main(int argc, char* argv[])
{
    A a(10);
    B b(3.14);
    a.Print();
    a.SetB(&b);
    b.Print();
    b.SetA(&a);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2015-03-23T11:53:12.730

*我迟到了回答这个问题，但到目前为止还没有一个合理的答案，尽管它是一个受欢迎的问题，答案非常受欢迎......*

## 最佳实践：前向声明标头

正如标准库的`<iosfwd>`标题所示，为其他人提供前向声明的正确方法是使用***前向声明标题***。例如：

a.fwd.h：

```
#pragma once
class A; 
```

啊：

```
#pragma once
#include "a.fwd.h"
#include "b.fwd.h"

class A
{
  public:
    void f(B*);
}; 
```

b.fwd.h：

```
#pragma once
class B; 
```

:

```
#pragma once
#include "b.fwd.h"
#include "a.fwd.h"

class B
{
  public:
    void f(A*);
}; 
```

`A`和库的维护者`B`应该各自负责保持他们的前向声明头与他们的头和实现文件同步，所以 - 例如 - 如果“B”的维护者出现并将代码重写为......

b.fwd.h：

```
template <typename T> class Basic_B;
typedef Basic_B<char> B; 
```

:

```
template <typename T>
class Basic_B
{
    ...class definition...
};
typedef Basic_B<char> B; 
```

...然后重新编译“A”的代码将由对包含的更改触发，`b.fwd.h`并且应该干净地完成。

* * *

## 糟糕但常见的做法：前向声明其他库中的内容

说 - 而不是使用前面解释的前向声明标题 - 代码中`a.h`或`a.cc`改为前向声明`class B;`自身：

*   如果`a.h`或`a.cc`确实包括`b.h`以后：
    *   A 的编译将在到达冲突的声明/定义时终止`B`（即上述对 B 的更改破坏了 A 和任何其他滥用前向声明的客户端，而不是透明地工作）。
*   否则（如果 A 最终没有包含`b.h`- 如果 A 只是通过指针和/或引用存储/传递 Bs 则可能）
    *   依赖于`#include`分析和更改文件时间戳的构建工具在更改为 B 后不会重建`A`（及其进一步依赖的代码），从而导致链接时或运行时出错。如果 B 作为运行时加载的 DLL 分发，“A”中的代码可能无法在运行时找到不同损坏的符号，这可能会或可能不会被处理得足够好以触发有序关闭或可接受地减少功能。

如果 A 的代码具有 old 的模板特化/“特征” `B`，它们将不会生效。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-03-09T11:07:12.400

要记住的事情：

*   `class A`如果有一个对象作为成员，这将不起作用，`class B`反之亦然。
*   前向声明是要走的路。
*   声明顺序很重要（这就是您要移出定义的原因）。
    *   如果两个类都调用另一个类的函数，则必须将定义移出。

阅读常见问题解答：

*   [如何创建两个相互了解的类？](https://isocpp.org/wiki/faq/misc-technical-issues#forward-decl)
*   [前向声明与成员对象一起使用时需要哪些特殊注意事项？](https://isocpp.org/wiki/faq/misc-technical-issues#forward-decl-members)
*   [前向声明与内联函数一起使用时需要哪些特殊注意事项？](https://isocpp.org/wiki/faq/misc-technical-issues#forward-decl-inline)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-03-09T21:25:01.637

我曾经通过在类定义之后移动所有内*联*并将其他类放在头文件中的内*联*`#include`之前解决了这类问题。这样可以确保在解析内联之前设置所有定义+内联。

 *这样做可以使两个（或多个）头文件中仍然有一堆内联。但是必须*包含警卫*。

像这样

```
// File: A.h
#ifndef __A_H__
#define __A_H__
class B;
class A
{
    int _val;
    B *_b;
public:
    A(int val);
    void SetB(B *b);
    void Print();
};

// Including class B for inline usage here 
#include "B.h"

inline A::A(int val) : _val(val)
{
}

inline void A::SetB(B *b)
{
    _b = b;
    _b->Print();
}

inline void A::Print()
{
    cout<<"Type:A val="<<_val<<endl;
}

#endif /* __A_H__ */ 
```

...并在`B.h`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-12-15T18:12:47.900

我曾经写过一篇关于这个的帖子：[Resolving circular dependencies in c++](https://ewirch.github.io/2013/12/resolving-circular-dependencies.html)

基本技术是使用接口解耦类。所以在你的情况下：

```
//Printer.h
class Printer {
public:
    virtual Print() = 0;
}

//A.h
#include "Printer.h"
class A: public Printer
{
    int _val;
    Printer *_b;
public:

    A(int val)
        :_val(val)
    {
    }

    void SetB(Printer *b)
    {
        _b = b;
        _b->Print();
    }

    void Print()
    {
        cout<<"Type:A val="<<_val<<endl;
    }
};

//B.h
#include "Printer.h"
class B: public Printer
{
    double _val;
    Printer* _a;
public:

    B(double val)
        :_val(val)
    {
    }

    void SetA(Printer *a)
    {
        _a = a;
        _a->Print();
    }

    void Print()
    {
        cout<<"Type:B val="<<_val<<endl;
    }
};

//main.cpp
#include <iostream>
#include "A.h"
#include "B.h"

int main(int argc, char* argv[])
{
    A a(10);
    B b(3.14);
    a.Print();
    a.SetB(&b);
    b.Print();
    b.SetA(&a);
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-10-09T21:21:42.160

这是模板的解决方案：[如何使用模板处理循环依赖项](https://studiofreya.com/cpp/how-to-handle-circular-dependencies-with-templates-in-c/)

解决这个问题的线索是在提供定义（实现）之前声明这两个类。无法将声明和定义拆分为单独的文件，但您可以将它们构造为就像它们位于单独的文件中一样。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-12-10T16:48:17.100

Wikipedia 上提供的简单示例对我有用。（您可以在[http://en.wikipedia.org/wiki/Circular_dependency#Example_of_circular_dependencies_in_C.2B.2B](http://en.wikipedia.org/wiki/Circular_dependency#Example_of_circular_dependencies_in_C.2B.2B)阅读完整的描述）

文件'''啊'''：

```
#ifndef A_H
#define A_H

class B;    //forward declaration

class A {
public:
    B* b;
};
#endif //A_H 
```

文件'''bh'''：

```
#ifndef B_H
#define B_H

class A;    //forward declaration

class B {
public:
    A* a;
};
#endif //B_H 
```

文件'''main.cpp'''：

```
#include "a.h"
#include "b.h"

int main() {
    A a;
    B b;
    a.b = &b;
    b.a = &a;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-07-05T07:02:16.567

不幸的是，所有以前的答案都缺少一些细节。正确的解决方案有点麻烦，但这是正确执行此操作的唯一方法。它可以轻松扩展，也可以处理更复杂的依赖关系。

以下是您如何做到这一点，完全保留所有细节和可用性：

*   该解决方案与最初的预期完全相同
*   内联函数仍然是内联的
*   的用户`A`并且`B`可以按任意顺序包括 Ah 和 Bh

创建两个文件，A_def.h，B_def.h。这些将仅包含`A`' 和`B`' 的定义：

```
// A_def.h
#ifndef A_DEF_H
#define A_DEF_H

class B;
class A
{
    int _val;
    B *_b;

public:
    A(int val);
    void SetB(B *b);
    void Print();
};
#endif

// B_def.h
#ifndef B_DEF_H
#define B_DEF_H

class A;
class B
{
    double _val;
    A* _a;

public:
    B(double val);
    void SetA(A *a);
    void Print();
};
#endif 
```

然后， Ah 和 Bh 将包含以下内容：

```
// A.h
#ifndef A_H
#define A_H

#include "A_def.h"
#include "B_def.h"

inline A::A(int val) :_val(val)
{
}

inline void A::SetB(B *b)
{
    _b = b;
    _b->Print();
}

inline void A::Print()
{
    cout<<"Type:A val="<<_val<<endl;
}

#endif

// B.h
#ifndef B_H
#define B_H

#include "A_def.h"
#include "B_def.h"

inline B::B(double val) :_val(val)
{
}

inline void B::SetA(A *a)
{
    _a = a;
    _a->Print();
}

inline void B::Print()
{
    cout<<"Type:B val="<<_val<<endl;
}

#endif 
```

请注意，A_def.h 和 B_def.h 是“私有”标头，用户`A`不应`B`使用它们。公共标头是 Ah 和 Bh

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-30T22:00:10.927

在某些情况下，可以在类 A 的头文件中*定义*类 B 的方法或构造函数，以解决涉及定义的循环依赖。通过这种方式，您可以避免将定义放入`.cc`文件中，例如，如果您想实现一个仅标头库。

```
// file: a.h
#include "b.h"
struct A {
  A(const B& b) : _b(b) { }
  B get() { return _b; }
  B _b;
};

// note that the get method of class B is defined in a.h
A B::get() {
  return A(*this);
}

// file: b.h
class A;
struct B {
  // here the get method is only declared
  A get();
};

// file: main.cc
#include "a.h"
int main(...) {
  B b;
  A a = b.get();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-24T22:09:02.917

不幸的是，我无法评论 geza 的答案。

他不仅仅是说“将声明提交到单独的标题中”。他说你必须将类定义头和内联函数定义溢出到不同的头文件中，以允许“延迟依赖”。

但他的插图并不是很好。因为两个类（A 和 B）只需要彼此的不完整类型（指针字段/参数）。

为了更好地理解它，想象类 A 有一个类型为 B 而不是 B* 的字段。此外，A 类和 B 类想要定义一个带有其他类型参数的内联函数：

这个简单的代码不起作用：

```
// A.h
#pragme once
#include "B.h"

class A{
  B b;
  inline void Do(B b);
}

inline void A::Do(B b){
  //do something with B
}

// B.h
#pragme once
class A;

class B{
  A* b;
  inline void Do(A a);
}

#include "A.h"

inline void B::Do(A a){
  //do something with A
}

//main.cpp
#include "A.h"
#include "B.h" 
```

这将导致以下代码：

```
//main.cpp
//#include "A.h"

class A;

class B{
  A* b;
  inline void Do(A a);
}

inline void B::Do(A a){
  //do something with A
}

class A{
  B b;
  inline void Do(B b);
}

inline void A::Do(B b){
  //do something with B
}
//#include "B.h" 
```

此代码无法编译，因为 B::Do 需要稍后定义的完整类型 A。

为了确保它编译源代码应该是这样的：

```
//main.cpp
class A;

class B{
  A* b;
  inline void Do(A a);
}

class A{
  B b;
  inline void Do(B b);
}

inline void B::Do(A a){
  //do something with A
}

inline void A::Do(B b){
  //do something with B
} 
```

这对于需要定义内联函数的每个类的这两个头文件是完全可能的。唯一的问题是循环类不能只包含“公共标头”。

为了解决这个问题，我想建议一个预处理器扩展：`#pragma process_pending_includes`

该指令应该推迟当前文件的处理并完成所有待处理的包含。

# django-forms - Django 表单预览 - 保存前将用户添加到表单

> ID：625800
> 
> 赞同：7
> 
> 时间：2009-03-09T10:57:38.383
> 
> 标签：django-forms

```
class RegistrationFormPreview(FormPreview):
    preview_template    = 'workshops/workshop_register_preview.html'
    form_template       = 'workshops/workshop_register_form.html'

    def done(self, request, cleaned_data):
        # Do something with the cleaned_data, then redirect
        # to a "success" page. 
        # data = request.POST.copy()
        # data['user_id'] = u'%s' % (request.user.id)
        # cleaned_data['user'] = u'%s' % (request.user.id)
        #f = self.form(cleaned_data)
        #f = self.form(data)
        #f.user = request.user

        f = self.form(request.POST)
        f.save()

        pdb.set_trace()
        return HttpResponseRedirect('/register/success') 
```

如您所见，我尝试了几种方法，并且已被注释掉。任务显然很简单：在保存之前将用户从请求添加到表单，然后保存。

这里接受的工作方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T11:06:32.323

如果无法修改用户，我会说它甚至不应该首先包含在表单中。

无论哪种方式，[使用`commit`参数](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method)来防止立即保存生成的对象应该可以工作（假设`FormPreview`使用`ModelForm`）：

```
obj = form.save(commit=False)
obj.user = request.user
obj.save() 
```

# visual-studio-2008 - VS2008 和 ClearCase：打开解决方案无缘无故请求结帐

> ID：625812
> 
> 赞同：5
> 
> 时间：2009-03-09T11:02:17.750
> 
> 标签：visual-studio-2008, clearcase

我有一个小问题导致我的自动构建失败。

当我们通过 ClearCase 请求打开最近从 VS2005 转换为 VS2008 VS 的解决方案时，我们检查解决方案文件。

如果我们允许它，那么它无论如何都不做任何更改，并且默认情况下，ClearCase 不喜欢没有更改的签入。所以我们撤消了结帐——从那时起 VS 很高兴，它能够写入 .suo 文件。

如果我们取消读取保护解决方案文件，启动 VS2008 它会创建 .suo 文件，如果我们然后取消劫持 .sln 文件（无论如何都没有更改，因此 VS2008 不会注意到）并再次启动 VS2008 就可以了 -不要求结帐。

在我的构建脚本中，我从视图中删除所有视图私有文件，然后通过强制取消劫持受控文件进行更新。然后我们构建部署项目（以及所有依赖项），并且随着 .suo 文件被删除，它每次都落入检出 .sln 文件的行为中。

在构建服务器上，周围没有人看到要求结帐的对话框，构建挂起。

我可以更改（又名 bodge）构建脚本以不删除 .suo 文件，但我宁愿不这样做。

编辑：澄清 - .suo 文件未检入 ClearClase - 它是由 VS2008 创建的视图私有文件，但是要创建此文件，它想签出 .sln 文件，但并非真正原因。

进一步编辑：

我已经找到了解决方案 - 根据我在此线程上的后续帖子，我已禁用集成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T11:41:34.330

好的，我找到了问题的解决方案，实际上很简单。

我在构建服务器上禁用了 Visual Studio ClearCase 集成。

由于我们需要构建部署项目，因此正在使用 VS，因此我们调用 devenv 为我们执行此操作。然而，我们只是将它用作构建引擎，构建引擎永远不需要知道如何修改源项目，因为它们都刚刚来自 ClearCase。我们允许构建服务器修改的唯一项目是 AssemblyInfo 文件中的程序集文件版本号属性，但我们在 NAnt 中而不是在 Visual Studio 中这样做。

因此，禁用该功能，问题就会消失。可能不是每个人的解决方案，但在构建服务器上它是前进的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-23T15:06:54.503

[这个](http://www-01.ibm.com/support/docview.wss?ratlid=cctocbody&rs=984&uid=swg21281866)故障排除项目让我找到了[这个](http://www-01.ibm.com/support/docview.wss?rs=984&uid=swg24018298)修复包，它解决了我们开发环境中的问题。我们仍在使用 VS2005，但我希望这与 VS2008 中出现的问题相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T11:22:28.417

这对于 VS2008 来说似乎是正常的，它在打开解决方案时会检查 .sln 文件。我也不喜欢。

但是，您的问题是 .suo 文件也已签入。此文件不应置于源代码管理之下。它就像 proj.user 文件。我怀疑 suo 代表解决方案用户选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T11:28:23.193

你可以：

*   更新您的脚本，以便在您的“ `cleartool update -force -overwrite`”之后劫持快照视图中的 sln 文件。
*   或者，为了避免签出 sln，您可以尝试保持[.suo 文件](http://msdn.microsoft.com/en-us/library/bb165909(VS.80).aspx)签入，

如果上述建议有效，那么以下是人们希望将此文件置于版本控制之下的几个原因：

*   由于[.suo 文件是一次性](https://stackoverflow.com/questions/54052/tool-to-view-the-contents-of-the-solution-user-options-file-suo)的（如果不存在，VS2008 只会创建一个新文件），在源代码控制下可能被视为一种避免创建的方法（因此避免 ClearCase 插件检测到它并尝试“添加到源代码”控制”它或检查它）。

*   将 .suo 文件置于版本控制之下（但不通过任何进一步的签出/签入进行更新）的另一个优点是[，当您将](https://stackoverflow.com/questions/452135/how-to-stop-visual-studio-from-automatically-creating-solution-files)签出的项目与在其他地方下载的同一项目的另一个签出版本进行比较时：该文件将始终相同，因为反对系统不同（因为如果是二进制文件，并且二进制文件的任何新版本都会将自己注册为不同的）

# c# - 网页上的富文本编辑器

> ID：625818
> 
> 赞同：4
> 
> 时间：2009-03-09T11:03:05.517
> 
> 标签：c#, asp.net, rich-text-editor

我正在尝试在我的网页中添加一个富文本编辑器，用户可以在其中撰写评论并格式化他们所写的内容...类似于我们在此网站上撰写帖子的编辑器...任何人都可以指出我关于这个的正确方向......任何可以帮助我构建这样一个组件的教程......我也想要一个免费的产品......（忘了前面提到......）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T11:16:39.040

也许是[TinyMCE](http://tinymce.moxiecode.com/)或[FCKeditor](http://www.fckeditor.net/)之类的东西。

它们非常完整，可定制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T11:05:54.480

Stack Overflow 上使用的编辑器是[WMD Editor](http://wmd-editor.com/)。

Jeff Attwood 和其他站点用户已经更新了站点上使用的当前版本，您可以[在此处阅读](https://blog.stackoverflow.com/2009/01/updated-wmd-editor/)并获取您自己站点[的代码副本。](https://blog.stackoverflow.com/2009/01/wmd-editor-reverse-engineered/)

我认为您最好使用（并且可能修改）现有组件，而不是从头开始编写自己的组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T11:12:54.930

我一直在使用[Telerik rad Editor](http://www.telerik.com/products/aspnet-ajax/editor.aspx)，并且对它非常满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T05:06:00.243

经过大量研究，这就是我所做的......

我需要一个免费且易于使用的控件..我使用的所有编辑器都带有许可证，所以我决定制作自己的控件！！！！

好吧..我自己做不到，所以我使用了一些网站的帮助....

[javascript 富文本编辑器](https://stackoverflow.com/questions/299577/javascript-rich-text-editors)

[http://aspalliance.com/1092_Rich_Text_Editor_Part_I](http://aspalliance.com/1092_Rich_Text_Editor_Part_I)

[http://ws.aspalliance.com/1092_Rich_Text_Editor_Part_II](http://ws.aspalliance.com/1092_Rich_Text_Editor_Part_II)和其他一些...

所以对我来说最好的选择是构建我自己的控件，以便我可以根据我的需要对其进行自定义....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T11:55:42.190

[http://freetextbox.com/](http://freetextbox.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T12:47:31.410

这是另一个：[NicEdit](http://nicedit.com/)

# c# - C#中的列表视图

> ID：625821
> 
> 赞同：1
> 
> 时间：2009-03-09T11:05:41.483
> 
> 标签：c#, asp.net, .net-1.1

我在 VS.NET 2003 中使用带有 C# 的列表视图。我想选择一个单元格（不仅仅是第一列中的单元格）。我想要一个无单元格的选择，它也突出显示单元格中的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T11:16:04.360

对于自由选择，我希望（在 1.1 中）[`DataGrid`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagrid(VS.71).aspx)是您的最佳选择。在 2.0 中，这在很大程度上被替换`DataGridView`为更加通用的。

我还建议您考虑迁移到更高级的数据框架版本；我意识到这并不总是可能的，但你会被 1.1 束缚住。

# django - 样式化表单和 django 表单值

> ID：625831
> 
> 赞同：2
> 
> 时间：2009-03-09T11:08:34.893
> 
> 标签：django, django-forms

我正在尝试使用 CSS 设置表单样式。首先，除了官方文档之外，我还没有看到完整的示例，因此我将不胜感激任何博客条目或文章。

现在在我的表单上，一个典型的 Charfield 被翻译成这样的 html：

```
<input type="text" name="artists" id="id_artists" /> 
```

如果我的表单在某些字段上包含错误，则之前的 Charfield 会记住该值并执行以下操作：

```
<input type="text" name="artists" value="Pink Floyd" id="id_artists"  /> 
```

如何`value="Pink Floyd"`以 django 形式获取此值（）？假设我的字段是`{{form.artists}}`，我可以`{{form.artists}}`用作字段、`{{form.artists.label}}`标签`{{form.artists.errors}}`和`{{form.artists.help_text}}`，但是这个值呢？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:24:47.787

专门创建输入字段，而不是依赖 django 自动创建它。

就像是：

```
<input type="text" name="artists" id="id_artists" value="{{form.artists.title}}" /> 
```

应该管用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T15:20:35.147

`data`您可以从属性中获取该字段的当前值：

```
{{ form.artists.data }} 
```

我看不到提到这一点的 Django 文档，但它可以工作......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-06T05:45:33.263

您还可以向表单类添加额外的验证以对表单数据进行处理。来自[djangobook.com](http://www.djangobook.com/en/2.0/chapter07/)：

```
from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField(max_length=100)
    email = forms.EmailField(required=False)
    message = forms.CharField(widget=forms.Textarea)

    def clean_message(self):
        message = self.cleaned_data['message']
        num_words = len(message.split())
        if num_words < 4:
            raise forms.ValidationError("Not enough words!")
        return message 
```

在方法内部，您可以使用字典`clean_message`访问给定字段。`self.cleaned_data`该词典适用于任何经过验证的表格。

一定要返回字段，在这种情况下`message`，否则`None`返回。

# hibernate - 使用休眠实现零停机

> ID：625836
> 
> 赞同：3
> 
> 时间：2009-03-09T11:10:26.170
> 
> 标签：hibernate, high-availability

Hibernate 对数据库（在这种情况下为 MySQL）有哪些变化（数据、模式、...）？

我问这个是因为 Hibernate 的停机时间为零。

更改数据库，将应用服务器拆分为两个集群，在其中一个集群上重新部署应用程序并切换应用程序。

谢谢斯蒂芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:45:33.613

我将根据个人经验而不是对休眠的任何特殊见解来回答这个问题。所以把这个和一粒盐一起吃。似乎还有一个模糊的问题，请在适当的地方添加评论。:)

首先，更改/添加/删除未在 hibernate 中映射的模式的内容永远不会导致任何问题。hibernate 真正做的就是生成查询，因为它将很多东西转换为 SQL，只要这些查询继续工作，你的应用程序就会继续工作。这意味着向表中添加列或添加表不是问题，删除未映射的列也不是问题等等。

更成问题的是对映射内容的更改。假设您将数字（10,0）更改为数字（11,0），这通常会起作用。如果您开始做一些事情，比如将 CHAR(1) 字段更改为 BIT 字段或类似的东西，您将需要在您的休眠映射中进行某些更改，这将使现有部署失败。这是常识。如果您确实必须进行这样的更改，那么在常规数据库服务器上执行 ALTER TABLE 可能无论如何都会锁定表，因此重新启动应用程序不是您最大的问题。

在高可用性下处理主要的模式变化并不是 hibernate 直接处理的事情。Hibernate 假设一个传统的关系数据库，其中模式更改通常非常昂贵。

您提到的其他三个问题：

*   更改数据源：可能需要重新启动应用程序
*   拆分应用服务器：如果您的意思是我认为的意思，您可以简单地部署在不同的应用服务器上。如果需要切换，请在您的 Web 应用程序和客户之间使用一些东西来处理它们，即 IP 级负载平衡器或类似的东西。
*   更改数据：事务数据库和多个写入器的正常问题适用。Hibernate 可能以不一致的数据库视图结束。它可能会覆盖其他用户的更改，并且在某些情况下，这可能会产生一些异常，但您应该可以预测和处理这些 AFAICT 之类的情况。

# java - （Java）将二进制数转换为字符串时指定位数（长度）？

> ID：625838
> 
> 赞同：7
> 
> 时间：2009-03-09T11:11:19.787
> 
> 标签：java, binary

我正在尝试将数字作为二进制字符串存储在数组中，但我需要指定将其存储为多少位。

例如，如果我需要用两位存储 0，我需要一个字符串“00”。或者 1010 有 6 位所以“001010”。

任何人都可以帮忙吗？

编辑：谢谢大家，因为我在数学/编程方面很垃圾，所以我选择了最简单的解决方案，即大卫的解决方案。就像是：

```
binaryString.append(Integer.toBinaryString(binaryNumber));
for(int n=binaryString.length(); n<numberOfBits; n++) {
                        binaryString.insert(0, "0");
} 
```

它似乎工作正常，所以除非它非常低效，否则我会使用它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T11:16:46.137

然后使用`Integer.toBinaryString()`检查字符串长度并在其前面添加尽可能多的零，以达到所需的长度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T11:16:36.280

忘记自制的解决方案。请改用标准[BigInteger](http://java.sun.com/j2se/1.4.2/docs/api/java/math/BigInteger.html)。您可以指定位数，然后使用 toString(int radix) 方法来恢复您需要的内容（我假设您需要 radix=2）。

**编辑：**我会将位控制权留给 BigInteger。该对象将在内部调整其位缓冲区的大小以适应新的数字维度。此外，可以通过此对象执行算术运算（您不必实现二进制加法器/乘法器等）。这是一个基本示例：

```
package test;

import java.math.BigInteger;

public class TestBigInteger
{
    public static void main(String[] args)
    {
        String value = "1010";
        BigInteger bi = new BigInteger(value,2);
        // Arithmetic operations
        System.out.println("Output: " + bi.toString(2));
        bi = bi.add(bi); // 10 + 10
        System.out.println("Output: " + bi.toString(2));
        bi = bi.multiply(bi); // 20 * 20
        System.out.println("Output: " + bi.toString(2));

        /*
         * Padded to the next event number of bits
         */
        System.out.println("Padded Output: " + pad(bi.toString(2), bi.bitLength() + bi.bitLength() % 2));
    }

    static String pad(String s, int numDigits)
    {
        StringBuffer sb = new StringBuffer(s);
        int numZeros = numDigits - s.length();
        while(numZeros-- > 0) { 
            sb.insert(0, "0");
        }
        return sb.toString();
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T11:20:13.773

这是一个常见的家庭作业问题。您可以编写一个很酷的循环来计算 2 >= 您的目标数*n*的最小幂。

由于它是 2 的幂，因此以 2 为底的对数是位数。但是 Java`math`库只提供自然对数。

```
math.log( n ) / math.log(2.0) 
```

是位数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-21T11:35:06.470

更简单：

```
String binAddr = Integer.toBinaryString(Integer.parseInt(hexAddr, 16));  
String.format("%032", new BigInteger(binAddr)); 
```

这里的想法是暂时将字符串解析为十进制数（恰好由所有 1 和 0 组成），然后使用 String.format()。

请注意，您基本上必须使用 BigInteger，因为如果您尝试使用`Integer.fromString()`或，二进制字符串会迅速溢出 Integer 和 Long 导致 NumberFormatExceptions `Long.fromString()`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-22T23:14:45.893

试试这个：

```
String binaryString = String.format("%"+Integer.toString(size)+"s",Integer.toBinaryString(19)).replace(" ","0"); 
```

其中 size 可以是用户想要的任何数字

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T12:01:36.110

```
import java.util.BitSet;

public class StringifyByte {

    public static void main(String[] args) {
        byte myByte = (byte) 0x00;
        int length = 2;
        System.out.println("myByte: 0x" + String.valueOf(myByte));
        System.out.println("bitString: " + stringifyByte(myByte, length));

        myByte = (byte) 0x0a;
        length = 6;
        System.out.println("myByte: 0x" + String.valueOf(myByte));
        System.out.println("bitString: " + stringifyByte(myByte, length));
    }

    public static String stringifyByte(byte b, int len) {
        StringBuffer bitStr = new StringBuffer(len);
        BitSet bits = new BitSet(len);
        for (int i = 0; i < len; i++)
        {
           bits.set (i, (b & 1) == 1);
           if (bits.get(i)) bitStr.append("1"); else bitStr.append("0");
           b >>= 1;
        }
        return reverseIt(bitStr.toString());
    }

    public static String reverseIt(String source) {
        int i, len = source.length();
        StringBuffer dest = new StringBuffer(len);

        for (i = (len - 1); i >= 0; i--)
           dest.append(source.charAt(i));
        return dest.toString();
    }
} 
```

输出：

```
myByte: 0x0
bitString: 00
myByte: 0x10
bitString: 001010 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T13:06:33.627

这是值的简单解决方案`int`；应该很明显如何将其扩展到例如字节等。

```
public static String bitString(int i, int len) {
    len = Math.min(32, Math.max(len, 1));
    char[] cs = new char[len];
    for (int j = len - 1, b = 1; 0 <= j; --j, b <<= 1) {
        cs[j] = ((i & b) == 0) ? '0' : '1';
    }
    return new String(cs);
} 
```

以下是一组示例测试用例的输出：

```
 0   1                                0                                0
  0  -1                                0                                0
  0  40 00000000000000000000000000000000 00000000000000000000000000000000
 13   1                                1                                1
 13   2                               01                               01
 13   3                              101                              101
 13   4                             1101                             1101
 13   5                            01101                            01101
-13   1                                1                                1
-13   2                               11                               11
-13   3                              011                              011
-13   4                             0011                             0011
-13   5                            10011                            10011
-13  -1                                1                                1
-13  40 11111111111111111111111111110011 11111111111111111111111111110011 
```

当然，您需要自己使长度参数足以代表整个值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-01T18:38:48.083

所以在这里你可以写你想要的长度而不是 8，它会相应地附加零。如果您提到的整数的长度超过了提到的数字，那么它将不会附加任何零

`String.format("%08d",1111);`

> 输出：00001111

```
String.format("%02d",1111); 
```

> 输出：1111

# c++ - 为什么仅添加 cout 行后输出无法显示变量的内容？

> ID：625849
> 
> 赞同：1
> 
> 时间：2009-03-09T11:16:45.327
> 
> 标签：c++

```
#include <iostream>

using namespace std;

class Marks
{
public:
    char* name();
};

char* Marks::name()
{
    char temp[30];
    cout<<"Enter a name:"<<endl;
    cin.getline(temp,30);
    return temp;
}

int main ()
{
    char *name;
    Marks test1;
    name=test1.name();

    //cout<<"name:"; //uncomment this line to see the problem
    cout<<name<<endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T11:24:10.677

您正在返回一个局部变量的地址：

```
char temp[30];
// ...
return temp; 
```

这在 C 或 C++ 中是一个严格的禁忌。从变量中出来的那一刻，`Marks::name()`BOOM `temp`！您不能再访问它——这样做会调用未定义的行为。试试这个，

```
#include <string> // somewhere at the top
// ...
std::string Marks::name()
{
   std::string line;
   cout<<"Enter a name:"<<endl;
   std::getline(cout, line);
   return line;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T11:23:07.120

问题是因为 name 指向的值已被破坏。您正在从 中返回局部变量的地址`Marks::name()`。最有可能的第一个副作用`cout`是导致内容`name`被破坏。`cout`当第一个被注释掉时，您可能只是幸运。

执行此操作的正确方法是分配一些内存，将其返回，然后在完成后将其销毁：

```
char* Marks::name()
{
    char* temp = new char[30];
    cout<<"Enter a name:"<<endl;
    cin.getline(temp,30);
    return temp;
}

int main ()
{
    char *name;
    Marks test1;
    name=test1.name();

    cout<<"name:";
    cout<<name<<endl;

    delete[] name;

    return 0;
} 
```

不要忘记使用`delete[]`，而不仅仅是`delete`，否则只会释放第一个字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T11:22:59.057

您将返回一个基于堆栈的指针（驻留在被调用进程的堆栈中的指针），该指针将在`Marks::name()`方法结束时释放。

这是基本的 C/C++ 内存管理问题，因此我鼓励您阅读一些有关该主题的书籍。

有几种方法可以正确地做到这一点。例如，为调用函数中的字符串保留内存并将 this 指针传递给函数：

在`main()`方法中：

```
char name[30];
Marks test1;
test1.name(name); 
```

（这里`name`有正确的值）用相应的方法：

```
char* Marks::name(char* temp)
{
    cout<<"Enter a name:"<<endl;
    cin.getline(temp,30);
    return temp;
} 
```

但是还有其他方法可以管理字符串的静态和动态内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T11:23:09.273

好吧，您在 Marks::name() 中有一个非常讨厌的错误，您在其中返回指向临时变量的指针。temp 将在函数退出时被销毁，因为它超出了范围，因此您将返回一个指向不再存在的变量的指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T11:40:25.830

Marks::name() 返回一个指向局部变量的指针。当函数退出时，该内存将被释放。

只要您在对 Marks::name 和 cout::operator << 的调用之间不调用任何函数，您仍然可以获得正确输出的原因是没有其他分配声称该内存区域。

如果您打算按值返回非静态字符串，则可以使用 std::string 而不是 char*。

或者，您可以将 char 缓冲区作为 char* 传递给 name 函数，并传递缓冲区的大小并让 Marks::name 填充该缓冲区（例如，使用 strncpy 或 strncpy_s）

```
void Marks::name( char* buffer, int length )
{
  cout<<"Enter a name:"<<endl;
  cin.getline(buffer,length);
}

void main()
{
  char buffer[30];
  Marks::name( buffer, 30 );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T11:34:06.113

到目前为止所有的答案都是正确的，但一些实现这一点的方法可能会更好。我知道它是一个非常简单的测试应用程序，但请考虑以下几点：

```
char* Marks::name()
{
    char* temp = new char[30];
    cout<<"Enter a name:"<<endl;
    cin.getline(temp,30);
    return temp;
}

int main ()
{
    char *name;
    Marks test1;
    name=test1.name();

    cout<<"name:";
    cout<<name<<endl;

    delete[] name;

    return 0;
} 
```

在这里，是函数 name() 分配内存，但不是删除它。这是一种不一致的情况，可能会导致问题，尤其是在更复杂的场景中。这样做可能会更好（假设您提前知道要给人们多少空间来写...）

```
//this time, pass in some ALREADY allocated memory, and a length count.
void Marks::name(char *buf, int len)
{
    cout<<"Enter a name (max " << len <<" letters):"<<endl;
    cin.getline(buf,len); //read into the memory provided
}

int main ()
{
    //preallocate your memory so that the same code that allocates...
    char *name = new char[30];
    Marks test1;
    test1.name(name, 30);

    cout<<"name:";
    cout<<name<<endl;

    //... also deallocates it. This is perhaps cleaner in terms of responcibility.
    delete[] name;

    return 0;
} 
```

实际上，做这种事情没有对错之分。有时一个函数必须分配内存以使用并返回它以供其他应用程序使用，这只是一个示例，您应该考虑谁是新的，并在删除时尝试使其保持一致。

# c# - 部分读取从 c# 应用程序创建的另一个进程的标准输出

> ID：625856
> 
> 赞同：1
> 
> 时间：2009-03-09T11:19:00.843
> 
> 标签：c#, process, redirect, standards

我有一个 GUI 应用程序，我在其中使用 Process 类生成一个控制台应用程序。

```
Process p1 = new Process();
p1.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
p1.StartInfo.CreateNoWindow = true;
p1.StartInfo.UseShellExecute = false;
p1.StartInfo.FileName = Path.Combine(basepath, "abc.exe");
p1.StartInfo.Arguments = "/pn abc.exe /f \"temp1.txt\"";
p1.StartInfo.RedirectStandardError = true;
p1.StartInfo.RedirectStandardInput = true;
p1.StartInfo.RedirectStandardOutput = true;
p1.OutputDataReceived += new DataReceivedEventHandler(outputreceived);
p1.ErrorDataReceived += new DataReceivedEventHandler(errorreceived);
p1.Start();
tocmd = p1.StandardInput;
p1.BeginOutputReadLine();
p1.BeginErrorReadLine(); 
```

现在我有一个问题，虽然它异步读取控制台输出，但它似乎只有在内部缓冲区充满一定量时才会触发事件。我希望它显示数据。如果缓冲区中有 10 个字节，则让它显示这 10 个字节。我的程序在内部实现了 sleep() 调用，所以我需要打印数据直到它进入睡眠状态。

我该怎么做？

==============

如前所述，输出是行缓冲的，我在代码中尝试了以下更改

```
p1.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
p1.StartInfo.CreateNoWindow = true;
p1.StartInfo.UseShellExecute = false;
p1.StartInfo.FileName = Path.Combine(basepath, "abc.exe");
p1.StartInfo.Arguments = pnswitch + " /f \"temp1.txt\"";
p1.StartInfo.RedirectStandardError = false;
p1.StartInfo.RedirectStandardInput = true;
p1.StartInfo.RedirectStandardOutput = true;
p1.Start();
tocmd = p1.StandardInput;
MethodInvoker mi = new MethodInvoker(readout);
mi.BeginInvoke(null, p1); 
```

我在里面写了

```
void readout()
    {
        string str;
        while ((str = p1.StandardOutput.ReadLine()) != null)
        {
            richTextBox1.Invoke(new UpdateOutputCallback(this.updateoutput), new object[] { str });
            p1.StandardOutput.BaseStream.Flush();
        }
    } 
```

所以我认为它现在监控每一行何时被写入并打印它对吗？这也没有用。那里有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T11:25:08.600

接收到的输出和错误数据是行缓冲的，只有在添加换行时才会触发。

最好的办法是使用自己的阅读器，它可以逐字节读取输入。显然，这必须是非阻塞的:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T11:44:14.480

为了实现这一点，您必须对重定向的流使用同步读取操作。您的代码将如下所示（MSDN 示例）：

```
// Start the child process.
Process p = new Process();
// Redirect the output stream of the child process.
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "Write500Lines.exe";
p.Start();
// Do not wait for the child process to exit before
// reading to the end of its redirected stream.
// p.WaitForExit();
// Read the output stream first and then wait.
**string output = p.StandardOutput.ReadToEnd();**
p.WaitForExit(); 
```

为了实现异步行为，您必须使用一些线程。

MSDN 文章[在这里](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)

# windows-installer - 文件更改时是否可以进行 Windows Installer 次要升级

> ID：625874
> 
> 赞同：3
> 
> 时间：2009-03-09T11:25:34.447
> 
> 标签：windows-installer, upgrade

如果其中一个文件自上次安装后发生更改，是否必须使用 Windows Installer 触发重大升级？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T02:50:50.293

不，您可以通过小幅升级侥幸逃脱。有关详细信息，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/aa370037(VS.85).aspx)。

> 次要升级可用于添加新功能和组件，但不能重新组织功能组件树。较小的升级提供了产品差异化，而无需实际定义不同的产品。典型的次要升级包括将以前的小更新中的所有修复组合成一个补丁。次要升级通常也称为服务包 (SP) 更新。

基本上您可以毫无问题地更新文件。

# .net - .net 紧凑框架“目标框架”

> ID：625877
> 
> 赞同：9
> 
> 时间：2009-03-09T11:27:23.290
> 
> 标签：.net, compact-framework

使用属性窗口中的普通 .net 应用程序，您可以将应用程序的 .net 框架从 3.5 更改为 2.0。

我正在为袖珍电脑应用程序寻找类似的东西，因为我的袖珍电脑上出现错误，我的应用程序需要更新版本的 .net。我在属性的任何地方都找不到它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T13:42:56.613

不幸的是，它不在属性中。由于某些（非常愚蠢的）原因，您可以通过右键单击鼠标将 2.0 项目升级到 3.5，但在 IDE 中无法返回。幸运的是，这仍然很容易。在任何文本编辑器（包括 Studio，如果您安装了加速器）中打开项目并将 Target Framework 节点更改回 2.0。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T13:12:53.940

首先 - 您可能需要检查“设备”选项卡 (VS2008)，然后选中“部署最新版本...”框（如果可以选择，将 3.5 推送到设备上）。

您完全有可能需要重新创建项目文件以将目标更改为 2.0（即创建一个新项目，在第一个屏幕上选择 2.0 **）**。复制 .cs 文件等通常不是一件大事......

如果项目很大，您可能会考虑手动编辑 csproj，但我不确定我是否会打扰......可能只需重新添加代码就可以减少工作量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T08:53:16.757

在文本编辑器中编辑 cs/vbproj 文件，最好是 Xml 编辑器：

改变

```
<TargetFrameworkVersion>v3.5</TargetFrameworkVersion> 
```

到

```
<TargetFrameworkVersion>v2.0</TargetFrameworkVersion> 
```

或相反亦然

此外，3.5 项目默认有以下额外引用

```
<Reference Include="System.Core" />
<Reference Include="System.Xml.Linq" />
<Reference Include="System.Data.DataSetExtensions" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T15:35:27.857

另一种解决方案可能是在您的设备上安装较新版本的 .NET CF： [http ://www.google.com/search?q=compact+framework+redistributable](http://www.google.com/search?q=compact+framework+redistributable)

问候，坦伯格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T06:56:21.947

如果您在 Visual Studio 2008 中创建 CF 2.0 项目，然后如果您需要升级到 CF 3.5，只需右键单击该项目并选择“升级项目”。对于设备端，请务必选中 Marc Gravell 提到的复选框，以便在部署项目时安装 CF 3.5。

# sql-server - Integration Services 中已清理数据的临时存储

> ID：625878
> 
> 赞同：1
> 
> 时间：2009-03-09T11:27:23.897
> 
> 标签：sql-server

我有一个 Excel 文件，我需要在集成服务中处理 3 次，一次用于项目，一次用于人员，一次用于时间跟踪数据。

在每个步骤中，我都有 excel 源代码，并且确实需要进行一些数据清理和类型转换（在所有三个步骤中都相同）。

有没有一种简单的方法可以创建一个可以完成所有这些操作并允许我将输出用作其他“真实”步骤的输入的步骤？

我开始考虑将它导入到临时表中的 SQL Server 中，这绝对没问题，但如果我能跳过这一步就好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:53:18.437

这实际上可以使用单个数据流来实现。

您可以读取 Excel 数据源一次，然后使用多播转换在内存中创建数据集的副本。然后，您可以相应地处理三个数据流分支中的每一个，还可以使用并行处理！

有关详细信息，请参阅以下参考：

[http://msdn.microsoft.com/en-us/library/ms137701(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms137701(SQL.90).aspx)

我希望我所详述的内容清晰易懂，但如果您需要进一步的指导，请随时直接与我联系。

干杯，约翰

[针对评论添加]

With regard to your further question, you can specify the precedence/flow control of your package using more than one flow. So for example, you could use the multicast task to create three data flows however and then subsequently define your precedence flow control so that all transformation tasks in flow 1 must be completed before the transformations in flow two can begin.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T11:32:56.833

您可以首先将三个单独的数据流任务与文件操作任务一起使用。文件操作是将原始 Excel 文件复制到临时区域。三个数据流任务中的每一个都将从临时文件开始并写入临时文件（我认为他们可能需要写入副本）。

这样做的一个问题是，这会使数据流按顺序运行。这对于您的 Excel 文件可能不是问题，但对于处理大量行会是一个问题。在这种情况下，最好将三个“步骤”并行处理，并在最后阶段加入结果。

# c# - 异步加载域模型

> ID：625893
> 
> 赞同：0
> 
> 时间：2009-03-09T11:35:01.897
> 
> 标签：c#, inversion-of-control, domain-driven-design

我已经开始了一个小项目来正确地自学一些事情：领域驱动的开发和控制反转是适用于这种情况的。

我决定编写一个可以加载和可视化来自体育赛事的计时数据的应用程序（我可以访问很多此类数据）。

一个要求是我希望能够从许多不同的数据源中进行选择，其中一些是事件的完整详细信息（事件后生成的 CSV），其中一些是实时数据源。

我在设计将此数据加载到域中的过程时遇到问题，以便它可以轻松地用于同步和异步加载。

我猜我需要一个所有数据源都派生自的抽象类。这个类需要能够设置自己（获取数据文件的路径，或者实时数据源服务器的地址），我猜它需要看起来像这样：

```
protected abstract void Setup();
protected abstract void LoadData(Race race);

public Race Load()
{
    Race race = new Race();
    Thread t = new Thread(new ParameterizedThreadStart(LoadData));
    t.Start(race);
    return race;
} 
```

然后每个数据源都可以实现自己的设置方法，但这感觉很麻烦，我不喜欢数据源类显示对话框或其他东西的想法，因为它只是感觉不对。

他们还可以实现自己的填充域的 LoadData 方法，在实时源的情况下，这将运行很长时间，并且会在它们发生时输入单圈时间，完整的数据源将尽可能快地填充模型.

但是前端可以立即访问比赛对象，并且可以绑定到它的事件。将竞赛对象传递给 load 方法是否更好，以便可以预先设置事件？

我只是想知道这个设计看起来是否还可以。我觉得它有点奇怪，我不确定是不是因为它是新的。我也可能在想整件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T11:56:30.973

我想我会通过编写几个“派生”类来编程，但不用担心基类。然后我会重构以删除重复项。这样，在我使用派生类之前，我就不会猜测基类。

除其他事项外，我会确保我拥有所有这些类的消费者的工作代码，以确保消费者需要了解多少关于正在消费的数据。例如，消费者是否需要知道加载是否完成？他们是否需要找到一个“好点”来显示可能仍在加载的数据？如果消费者最终不需要任何这些信息，那么加载过程就变成了“派生”类的实现细节，而不是他们需要公开的东西。

# asp.net - 为什么我的会话变量在 ASP.NET 中显示为空？

> ID：625894
> 
> 赞同：-2
> 
> 时间：2009-03-09T11:35:55.280
> 
> 标签：asp.net, multithreading, session

我在 ASP.NET 网页上有用户控件，其中包含一个 GridView 和一个单选按钮选择器。

在底层中间层我有一个线程去数据库然后引发一个事件说“我有一些数据”我的用户控件处理这个事件并设置一个会话变量。

这有效，我可以看到正在处理的事件并且 Session 变量获取新数据。

但是，当我在单选按钮选择器的选定索引更改会话变量报告为“无”时使用此会话变量时

我已确保明显的（即拼写、会话已打开等）是正确的。

GridView 和单选按钮选择器封装在同一个更新面板中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T11:43:31.860

检查您的 UpdatePanel - updatemode 是否设置为“有条件”？也 Child 作为触发器？我会首先停止您的页面加载，看看从那里发生了什么。搜索您填充该会话变量的所有位置并停止。您可能会感到惊讶，我经常发现页面生命周期变得令人困惑，即使我认为我理解它。Alt - 发布一些代码，我们可以逐步完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:27:13.923

是的，听起来几乎像是操作顺序的问题，或者在页面加载时不检查回发之类的？

就像 JamesM 建议的那样，在调试模式下运行您的网站确实有助于识别问题。您可以打开监视窗口并将其设置为您要查找的 Session 变量，然后设置断点并检查每个停止处的值以分治代码。

# html - 让列在 3 列 CSS 布局中扩展到相同的高度？

> ID：625902
> 
> 赞同：2
> 
> 时间：2009-03-09T11:43:03.780
> 
> 标签：html, css

有谁知道可以对这些元素应用什么 CSS 以使侧边栏扩展到中间 div 的高度？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

<title>This is my page</title>
<style type="text/css">

body
{
    background-color:#aaaaaa;
}

#container
{
    width:900px;
    margin-left:auto;
    margin-right:auto;
}

#leftborder
{
    float:left;
    width:10px;
    background-color:#ff0000;
}

#rightborder
{
    margin:0; padding:0;

    float:right;
    width:10px;
    background-color:#ff0000;
}

#middlecontainer{
    margin:0 10px;
}
</style>

</head>
<body>

<div id="container">
<div id="leftborder">
a
</div>
<div id="rightborder">
a
</div>

<div id="middlecontainer">
This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content This is is content 
</div>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T11:58:11.937

只要您的页面具有固定宽度，您就可以应用[Faux Columns](http://www.alistapart.com/articles/fauxcolumns/)技术。

短版：在“wrapper-div”中重复一个图像作为背景图像，以使其看起来像整个页面正在拉伸，即使里面的内容 div 只有几行长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T11:54:37.170

看看[A list](http://www.alistapart.com/)中的示例，看看如何在视觉上实现这一点。另一种选择是使用表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:48:49.000

背景图像或中心 div 的简单边框（使用宽边框并在其上显示浮动）似乎是最简单的解决方案。

您还可以将侧边栏绝对放置在中心 div 内，使它们非常长并应用**溢出：隐藏**到中心 div。我还没有尝试过，但这应该也可以。

# .net - Visual Studio 中的源文件编码（VS2005 但可以适用于其他版本）

> ID：625907
> 
> 赞同：3
> 
> 时间：2009-03-09T11:45:45.147
> 
> 标签：.net, visual-studio, encoding

是否有一个选项可以轻松查看当前文件的编码（utf-8、utf-8 w/out BOM、ascii、western 等）？

我主要在 Web 应用程序上工作，所以这对我来说至关重要。

除了“另存为”对话框之外，我在任何地方都找不到这个...当您在 Visual Studio 中保存文件时，您可以选择“将 MyClass.cs 保存为”，然后单击向下箭头并选择“保存方式”编码……”。然后您可以选择查看和更改当前选择的编码和行尾选项。但这是 4-5 次点击，对于这么简单的信息来说工作量太大了！？

有一个“View.ChooseEncoding”命令，但运行它没有运气，我得到的只是“命令“View.ChooseEncoding”不可用。”

我试图用我自己的插件在状态栏中显示它，但没有运气，在自动化 API 的任何地方都找不到编码信息。我使用 EnvDTE.Document 在打开/保存时访问当前文件信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T11:40:41.807

博卡，

你到底想做*什么*？据我所知，Visual Studio（至少 2005 年）只会将本地代码页用于您正在使用的操作系统。如果您是说英语的人，那可能是 Latin1、ISO-8859-1、Extended-ASCII 等等。如果您没有重音/欧洲字符，它们都是“几乎”相同的表示。

我们看到了一些工作行为，其中 64 位操作系统（例如 Vista64）上的 Visual Studio 2005 默认保存为 Unicode（带有 BOM 的 UTF8）；上面的评论者建议 Visual Studio 2008 的行为方式相同。

这让我回到了这个问题——你想做什么？您是否正在考虑使用 web.config[全球化部分](http://msdn.microsoft.com/en-us/library/hy4kkhe0(VS.80).aspx)？它有一个选项来指定 fileEncoding 以及请求和响应。

```
 <system.web>
      <globalization 
         fileEncoding="iso-8859-1"
         requestEncoding="utf-8"
         responseEncoding="utf-8" />
   </system.web> 
```

对于您收到的任何特定字节流，很难“知道”使用了什么编码（除非它是带有 BOM 的 UTF-8，在这种情况下很容易检查前几个字节）或者它是在您的 PC 上创建的（其中如果它使用您的默认代码页）。

很久以前，我写了[NCharDet](http://www.conceptdevelopment.net/Localization/NCharDet/)，它试图确定编码（主要针对不同的亚洲语言），但我不确定这也是你需要的（除此之外它有点过时）。**MLang**使用了微软为此类东西提供的主要“API”。

对不起，我无法提供真正的答案...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T07:33:36.290

看这个：[如何确定文本文件编码](http://codesnipers.com/?q=node/68) 但这仅适用于使用签名保存的 Unicode 文件。

# c# - C# 中的 Excel 报表设置页面设 置选项

> ID：625910
> 
> 赞同：0
> 
> 时间：2009-03-09T11:46:11.403
> 
> 标签：c#, asp.net

我正在使用以下方法在我的 ASP.NET 应用程序中从 HTML 创建动态 Excel 报告。

在创建 excel 报告时，我想设置页面设​​置选项，使报告适合一页。

这是我用来创建 Excel 报告的方法...请告诉我如何将此报告调整到一页或放大报告？

```
 string sContentType = "application/vnd.excel";
    string sFileName = "Detail Qutation.xls";
    Hashtable oData = new Hashtable();
    oData.Add("Content-Disposition", "attachment;filename=" + sFileName);           
    oData.Add("Charset", "");
    oData.Add("ContentType", sContentType);
    oData.Add("Content", sTable.ToString());
    oData.Add("IsBinaryContent", false);
    this.StoreObject("Document", oData); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T12:09:36.760

您可能需要使用 htmltextwriter 进行渲染，如

[http://forums.asp.net/p/1063850/1538066.aspx#1538066](http://forums.asp.net/p/1063850/1538066.aspx#1538066)

并采取概念来获得解决方案。

# ruby - 用 Ruby 编写 TextMate。TextMate.go_to 的问题

> ID：625912
> 
> 赞同：3
> 
> 时间：2009-03-09T11:46:53.273
> 
> 标签：ruby, textmate, textmatebundles

即使我是 Ruby 的初学者，我也在修改一个 TextMate 包。我要解决的问题是在命令输出后将插入符号移动到某个位置的问题。

基本上发生的事情是这样的：我点击了一个组合键，它触发了一个命令来过滤文档并在相关位置插入文本，然后用新的过滤文本替换文档退出。

我接下来*想要*发生的事情是让插入符号移回原来的位置。当我找到 TextMate.go_to 函数时，我很高兴，但我只能让它部分工作。功能：

```
位置Y = ENV['TM_LINE_NUMBER']
位置X = ENV['TM_LINE_INDEX']
...
TextMate.go_to :line => positionY, :column => positionX; #column 无效
```

我可以将插入符号移到正确的行，但 column 参数不起作用。我试过改变它们，甚至只用列参数来做这个功能，但没有运气。我也尝试使用硬编码整数，但 positionX 参数打印正确的行索引，所以我怀疑那里有什么。

[这](http://www.mail-archive.com/textmate-dev@lists.macromates.com/msg02107.html)是我在此方法上找到的唯一文档，但我查看了 textmate.rb 并且在我未经训练的眼睛看来，我正在正确使用它。

我知道这可以通过宏来实现，但我想尽可能避免这种情况。我也知道，如果您选择“插入为片段”，则可以使用标记，但是我必须先清除文档，而且我还没有真正弄清楚如何在不使用“替换文档”选项的情况下执行此操作。任何人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:56:12.783

让我们看一下绑定的源代码：

```
def go_to(options = {})
  default_line = options.has_key?(:file) ? 1 : ENV['TM_LINE_NUMBER']
  options = {:file => ENV['TM_FILEPATH'], :line => default_line, :column => 1}.merge(options)
  if options[:file]
    `open "txmt://open?url=file://#{e_url options[:file]}&line=#{options[:line]}&column=#{options[:column]}"`
  else
    `open "txmt://open?line=#{options[:line]}&column=#{options[:column]}"`
  end
end 
```

相当骇人听闻的是，绑定设置了一个 txmt:// URL 并在 shell 中调用 open 。

所以要做的第一件事是构建一个开放的 URL 并将其输入终端/您的浏览器，以查看 TextMate 是否尊重列参数。如果这样可行，那么您的版本的 Textmate.go_to 实现中可能存在错误。

# eclipse - Eclipse 中的 XMLSpy

> ID：625914
> 
> 赞同：1
> 
> 时间：2009-03-09T11:48:24.440
> 
> 标签：eclipse, qtp, xmlspy

我需要在 Eclipse 中测试 XMLSpy 功能。在我将 Eclipse 切换到 XMLSpy Perspective 并且 QTP 运行（记录或运行模式）后，它不起作用。你可以帮帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T12:34:53.627

[**Altova**支持](https://www.altova.com/search?q=%22quick%20test%22)似乎没有任何参考，包括“Quik Test Pro”问题。

但是，检查其他插件（XmlSpy 除外）：
[已知类似的工具无法与 TPTP 交互](https://web.archive.org/web/20061118185053/http://dev.eclipse.org:80/mhonarc/lists/tptp-testing-tools-dev/msg00329.html)。

还要检查您的错误日志视图，并使用记录时显示的错误消息完成您的问题。

[![](https://i.stack.imgur.com/23Qrr.png)](https://i.stack.imgur.com/23Qrr.png)
[（来源：[eclipse.org](http://help.eclipse.org/help32/topic/org.eclipse.pde.doc.user/guide/images/views/error_log.png)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T13:21:45.097

更多信息会有所帮助。“它不起作用”非常模糊。什么不起作用？你的意思是QTP根本不记录任何东西吗？你的意思是QTP记录了一些东西，但它是不正确的？它是否记录了您的一些测试，但错过了一个特定的控件，例如网格？您是否启用了正确的 QTP 插件/插件来支持 Eclipse 的自动化？

# vba - 动态解析 VBA 文件的问题

> ID：625916
> 
> 赞同：0
> 
> 时间：2009-03-09T11:49:10.617
> 
> 标签：vba, excel, c#, parsing

我有一个带有宏的 MS Office 2003 excel 文件。我必须使用 c# 解析宏中的 VBA 代码。在解析时，我必须确定关键字是方法名称还是属性。

还有一个来自微软的组件可以使用 c# 中的反射动态访问所有 VBA 函数吗？

有没有办法做到这一点？如果是这样，请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T12:08:00.180

因为读取属性和调用不带参数的子/函数的语法可能相同，您必须解析所有符号并检查它们的定义以查看符号是属性还是子/函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T12:08:53.860

最简单的方法是跟踪对象名称之前是“Function”还是“Sub”，因为这将指示方法名称而不是属性

# git - 如何忽略已经提交的文件？

> ID：625919
> 
> 赞同：28
> 
> 时间：2009-03-09T11:52:15.647
> 
> 标签：git, gitignore

以前，以下是我的`.gitignore`文件：

```
...
config/database.yml
.DS_Store 
```

后来我`app_config.yml`在 config 目录中创建了一个文件并提交了它。

现在，我意识到我不需要`app_config.yml`git 存储库中的文件。我修改了我的`.gitignore`文件：

```
...
config/app_config.yml
config/database.yml
.DS_Store 
```

现在，当我提交时，该`app_config.yml`文件仍在我的仓库中。我想从我的仓库中删除该文件。我该怎么做？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-09T12:04:01.907

正如“[忽略不会删除文件](http://gitready.com/beginner/2009/03/06/ignoring-doesnt-remove-a-file.html)”中提到的
（以下引用**Nick Quaranto**的精彩文章，
在他的博客[**git ready**](http://gitready.com/) “一次学习 git 一次提交”）：

> **当你告诉 Git 忽略文件时，它只会停止监视该文件的更改，而不是其他任何东西。
> 这意味着历史仍然会记住该文件并拥有它**。
> 
> 如果要从存储库中删除文件，但将其保留在工作目录中，只需使用：

```
git rm --cached <file> 
```

> 但是，这仍会将文件保留在历史记录中。
> 
> 如果你真的想从历史中删除它，你真的有两个选择：
> 
> *   重写存储库的提交，或
> *   重来。
> 
> 这两种选择都很糟糕，这是有充分理由的：Git 努力不丢失您的数据。
> 就像变基一样，Git 迫使您考虑这些选项，因为它们是破坏性操作。
> 
> 如果您确实想从历史记录中删除文件，**`git filter-branch`**那么您正在寻找的是钢锯。
> 在使用它之前一定要阅读它的**[手册页](http://git-scm.com/docs/git-filter-branch)**，因为它会从字面上重写你的项目的提交。这实际上是用于某些操作的好工具，并且可以执行各种操作，例如完全删除作者的提交以移动项目根文件夹。从所有修订中删除文件的命令是：

```
git filter-branch --index-filter 'git rm --cached <file>' HEAD 
```

> 当您需要清除可能已放置在存储库中的敏感或机密信息时，此操作绝对有用

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-02-26T03:51:44.833

当您想开始忽略已提交的文件并希望将其保留在项目中时，这无济于事...因为**git rm --cached**会从 git repo 中删除它...

我发现这个[如何阻止 Git 跟踪从此提交向前对文件的任何更改？](https://stackoverflow.com/questions/18276951/how-do-i-stop-git-from-tracking-any-changes-to-a-file-from-this-commit-forward/18277622)这就是我要找的..

希望它对其他人也有用......

# javascript - jQuery 弹出气泡/工具提示

> ID：625920
> 
> 赞同：99
> 
> 时间：2009-03-09T11:52:44.133
> 
> 标签：javascript, jquery, html, css

我正在尝试制作一个“气泡”，它可以在`onmouseover`事件触发时弹出，并且只要鼠标悬停在引发`onmouseover`事件的项目上或鼠标移动到气泡中，它就会保持打开状态。我的气泡需要有各种 HTML 和样式，包括超链接、图像等。

我基本上是通过编写大约 200 行丑陋的 JavaScript 来实现的，但我真的很想找到一个 jQuery 插件或其他一些方法来清理它。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2010-02-10T03:32:11.017

[Qtip 是我见过的最好的。](http://craigsworks.com/projects/qtip2/)它是 MIT 许可的，漂亮，具有您需要的所有配置。

我最喜欢的轻量级选项是[醉醺醺](https://github.com/jaz303/tipsy)的。还获得了麻省理工学院的许可。它启发了[Bootstrap 的工具提示插件](http://getbootstrap.com/javascript/#tooltips)。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-03-09T14:37:01.337

这也可以通过 mouseover 事件轻松完成。我已经完成了，它根本不需要 200 行。从触发事件开始，然后使用将创建工具提示的函数。

```
$('span.clickme').mouseover(function(event) {
    createTooltip(event);               
}).mouseout(function(){
    // create a hidefunction on the callback if you want
    //hideTooltip(); 
});

function createTooltip(event){          
    $('<div class="tooltip">test</div>').appendTo('body');
    positionTooltip(event);        
}; 
```

然后创建一个函数，将工具提示定位到触发 mouseover 事件的 DOM 元素的偏移位置，这可以通过 css 实现。

```
function positionTooltip(event){
    var tPosX = event.pageX - 10;
    var tPosY = event.pageY - 100;
    $('div.tooltip').css({'position': 'absolute', 'top': tPosY, 'left': tPosX});
}; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-10-03T21:07:27.740

虽然 qTip（公认的答案）很好，但我开始使用它，但它缺少一些我需要的功能。

然后我偶然发现了[PoshyTip——](http://vadikom.com/demos/poshytip/)它非常灵活，而且非常易于使用。（我可以做我需要的）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T21:42:03.420

好的，经过一些工作，我能够在所有正确的时间弹出一个“泡沫”并消失。还有很多样式需要进行，但这基本上是我使用的代码。

```
<script type="text/javascript">
    //--indicates the mouse is currently over a div
    var onDiv = false;
    //--indicates the mouse is currently over a link
    var onLink = false;
    //--indicates that the bubble currently exists
    var bubbleExists = false;
    //--this is the ID of the timeout that will close the window if the user mouseouts the link
    var timeoutID;

    function addBubbleMouseovers(mouseoverClass) {
        $("."+mouseoverClass).mouseover(function(event) {
            if (onDiv || onLink) {
                return false;
            }

            onLink = true;

            showBubble.call(this, event);
        });

        $("." + mouseoverClass).mouseout(function() {
            onLink = false;
            timeoutID = setTimeout(hideBubble, 150);
        });
    }

    function hideBubble() {
        clearTimeout(timeoutID);
        //--if the mouse isn't on the div then hide the bubble
        if (bubbleExists && !onDiv) {
             $("#bubbleID").remove();

             bubbleExists = false;
        }
    }

    function showBubble(event) {
        if (bubbleExists) {
            hideBubble();
        }

        var tPosX = event.pageX + 15;
        var tPosY = event.pageY - 60;
        $('<div ID="bubbleID" style="top:' + tPosY + '; left:' + tPosX + '; position: absolute; display: inline; border: 2px; width: 200px; height: 150px; background-color: Red;">TESTING!!!!!!!!!!!!</div>').mouseover(keepBubbleOpen).mouseout(letBubbleClose).appendTo('body');

        bubbleExists = true;
    }

    function keepBubbleOpen() {
        onDiv = true;
    }

    function letBubbleClose() {
        onDiv = false;

        hideBubble();
    }

    //--TESTING!!!!!
    $("document").ready(function() {
        addBubbleMouseovers("temp1");
    });
</script> 
```

以下是与之相关的 html 片段：

```
<a href="" class="temp1">Mouseover this for a terribly ugly red bubble!</a> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-02-10T03:15:42.860

我编写了一个有用的 jQuery 插件，只需 jQuery 中的一行代码即可轻松创建智能气泡弹出窗口！

您可以做什么： - 将弹出窗口附加到任何 DOM 元素！- mouseover/mouseout 事件自动管理！- 设置自定义弹出事件！- 创建智能阴影弹出窗口！（在 IE 中也是如此！） - 在运行时选择弹出窗口的样式模板！- 在弹出窗口中插入 HTML 消息！- 设置许多选项：距离、速度、延迟、颜色……</p>

Internet Explorer 6+、Firefox、Opera 9+、Safari 完全支持 Popup 的阴影和彩色模板

[您可以从http://plugins.jquery.com/project/jqBubblePopup](http://plugins.jquery.com/project/jqBubblePopup)下载源代码

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-03-24T00:16:15.717

QTip 有 jQuery 1.4.2 的错误。我不得不切换到 jQuery Bubble Pop up [http://www.vegabit.com/jquery_bubble_popup_v2/#examples](http://www.vegabit.com/jquery_bubble_popup_v2/#examples)并且效果很好！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T11:56:24.827

在我看来，您不希望鼠标悬停在事件上：您需要 jQuery hover() 事件。

你似乎想要的是一个“丰富”的工具提示，在这种情况下，我建议使用[jQuery tooltip](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)。使用 bodyHandler 选项，您可以放入任意 HTML。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-02-21T01:24:50.007

> 我正在尝试制作一个“气泡”，当 onmouseover 事件被触发时它会弹出，并且只要鼠标悬停在引发 onmouseover 事件的项目上或者如果鼠标移入气泡中，它就会保持打开状态。我的气泡需要有各种方式的 html 和样式，包括超链接、图像等。

所有这些事件都由这个插件完全管理......

[http://plugins.jquery.com/project/jqBubblePopup](http://plugins.jquery.com/project/jqBubblePopup)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-17T12:40:55.187

[ColorTip](http://demo.tutorialzine.com/2010/07/colortips-jquery-tooltip-plugin/colortips.html)是我见过的最漂亮的

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-10T15:48:32.920

jQuery Bubble Popup 插件的新版本 3.0 支持 jQuery v.1.7.2，这是目前最著名的 javascript 库的最新稳定版本。

3.0 版本最有趣的功能是您可以将 jQuery & Bubble Popup 插件与任何其他库和 JavaScript 框架（如 Script.aculo.us、Mootols 或 Prototype）一起使用，因为插件完全封装以防止不兼容问题；

jQuery Bubble Popup 经过测试并支持许多已知和“未知”的浏览器；有关完整列表，请参阅文档。

与之前的版本一样，jQuery Bubble Popup 插件继续在 MIT 许可下发布；只要版权标题保持不变，您就可以在商业或个人项目中自由使用 jQuery Bubble Popup。

下载最新版本或访问 [http://www.maxvergelli.com/jquery-bubble-popup/上的现场演示和教程](http://www.maxvergelli.com/jquery-bubble-popup/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-30T15:29:21.513

自动调整简单弹出气泡的大小

索引.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <link href="bubble.css" type="text/css" rel="stylesheet" />
  <script language="javascript" type="text/javascript" src="jquery.js"></script>
  <script language="javascript" type="text/javascript" src="bubble.js"></script>
</head>
<body>
  <br/><br/>
  <div class="bubbleInfo">
      <div class="bubble" title="Text 1">Set cursor</div>
  </div>
  <br/><br/><br/><br/>
  <div class="bubbleInfo">
      <div class="bubble" title="Text 2">Set cursor</div>
  </div>
</body>
</html> 
```

泡泡.js

```
$(function () {     
  var i = 0;
  var z=1;
  do{
    title = $('.bubble:eq('+i+')').attr('title');
    if(!title){
      z=0;
    } else {
       $('.bubble:eq('+i+')').after('<table style="opacity: 0; top: -50px; left: -33px; display: none;" id="dpop" class="popup"><tbody><tr><td id="topleft" class="corner"></td><td class="top"></td><td id="topright" class="corner"></td></tr><tr><td class="left"></td><td>'+title+'</td><td class="right"></td></tr><tr><td class="corner" id="bottomleft"></td><td class="bottom"><img src="bubble/bubble-tail.png" height="25px" width="30px" /></td><td id="bottomright" class="corner"></td></tr></tbody></table>');
       $('.bubble:eq('+i+')').removeAttr('title');
    }
    i++;
  }while(z>0)

  $('.bubbleInfo').each(function () {
    var distance = 10;
    var time = 250;
    var hideDelay = 500;        
    var hideDelayTimer = null;       
    var beingShown = false;
    var shown = false;
    var trigger = $('.bubble', this);
    var info = $('.popup', this).css('opacity', 0);        

    $([trigger.get(0), info.get(0)]).mouseover(function () {
      if (hideDelayTimer) clearTimeout(hideDelayTimer);
      if (beingShown || shown) {
        // don't trigger the animation again
        return;
      } else {
        // reset position of info box
        beingShown = true;

        info.css({
        top: -40,
        left: 10,
        display: 'block'
        }).animate({
        top: '-=' + distance + 'px',
        opacity: 1
        }, time, 'swing', function() {
          beingShown = false;
          shown = true;
        });
      }          
      return false;
    }).mouseout(function () {
      if (hideDelayTimer) clearTimeout(hideDelayTimer);
      hideDelayTimer = setTimeout(function () {
        hideDelayTimer = null;
        info.animate({
          top: '-=' + distance + 'px',
          opacity: 0
        }, time, 'swing', function () {
          shown = false;
          info.css('display', 'none');
        });
      }, hideDelay);
      return false;
    });
  }); 
}); 
```

气泡.css

```
/* Booble */
.bubbleInfo {
    position: relative;
    width: 500px;
}
.bubble {       
}
.popup {
    position: absolute;
    display: none;
    z-index: 50;
    border-collapse: collapse;
    font-size: .8em;
}
.popup td.corner {
    height: 13px;
    width: 15px;
}
.popup td#topleft { 
    background-image: url(bubble/bubble-1.png); 
} 
.popup td.top { 
    background-image: url(bubble/bubble-2.png); 
}
.popup td#topright { 
    background-image: url(bubble/bubble-3.png); 
}
.popup td.left { 
    background-image: url(bubble/bubble-4.png); 
}
.popup td.right { 
    background-image: url(bubble/bubble-5.png); 
}
.popup td#bottomleft { 
    background-image: url(bubble/bubble-6.png); 
}
.popup td.bottom { 
    background-image: url(bubble/bubble-7.png); 
    text-align: center;
}
.popup td.bottom img { 
    display: block; 
    margin: 0 auto; 
}
.popup td#bottomright { 
    background-image: url(bubble/bubble-8.png); 
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-04-16T19:04:19.313

[Tiptip](http://code.drewwilson.com/entry/tiptip-jquery-plugin)也是一个不错的库。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-29T18:52:49.063

您可以为此使用 qTip；但是，您必须编写一些代码才能在鼠标悬停事件上启动它；如果您想在文本字段上添加默认水印，则必须使用水印插件...

我意识到这会导致大量重复代码；所以我在 qTip 之上编写了一个插件，它可以很容易地将信息弹出窗口附加到表单字段。你可以在这里查看：[https ://bitbucket.org/gautamtandon/jquery.attachinfo](https://bitbucket.org/gautamtandon/jquery.attachinfo)

希望这可以帮助。

# unit-testing - 中等复杂度方法的 TDD

> ID：625925
> 
> 赞同：2
> 
> 时间：2009-03-09T11:54:49.963
> 
> 标签：unit-testing, tdd

我已经有一段时间没有接触TDD了，而且很生疏。我很感激一些关于如何对下面描述的方法进行 TDD 的建议。

该方法必须在用户提供的应用程序目录中找到一个 web.config 文件。然后它必须从该配置文件中提取并返回一个连接字符串。

如果由于某种原因找不到连接字符串，无论是路径错误、没有 web.config 还是 web.config 中没有连接字符串，它都会返回 null。

我最初的想法是使用 setup 编写一个测试，该测试创建一个目录并编写一个带有连接字符串的 web.config 文件。然后测试将使用创建的路径调用我的方法并期望返回一个非空值，并且我的初始测试运行将失败，因为我的方法存根始终返回空值。

然后，实现该方法，并运行期望通过的测试。然后，作为预测试（我忘记了术语），删除创建的目录，并调用期望空值的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T12:05:33.977

首先，我不会让方法既找到文件又提取连接字符串。如果您的框架还没有确定文件是否存在于给定目录中的方法，请编写一个方法来执行此操作，一旦您有了文件，请编写一个方法来从打开的流中提取连接字符串。那么，对于测试，您可以提供内存流，而不必实际创建目录和文件。

其次，如果您不将失败的编译作为您的第一个失败测试，​​那么请编写您对抛出 NotImplementedException 的方法的第一次尝试。这是一小步，但是当您编写第一个测试时，至少它会失败。当然，空流的第一个测试会期望它返回 null 并且您编写的第一个代码将是`return null`，但这没关系。你的下一个测试将迫使你改变它。从那里继续，直到你完成了方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T12:06:46.143

您似乎有几个带有几个不同设置装置的测试用例。

1.  FoundDirectory 测试用例。设置创建预期的有效文件。

    这可以有几个子类。

    1.  未找到连接字符串 TestCase。设置创建预期但无效的文件。

    2.  一个糟糕的路径TestCase。设置创建预期但无效的文件。

    3.  一个没有 web.config 的测试用例。设置创建预期但无效的文件。

    4.  web.config TestCase 中没有连接字符串。设置创建预期但无效的文件。

2.  DidtFindDirectory 测试用例。setUp 确保该目录不存在。

3.  DidtFindFile 测试用例。设置创建目录但没有文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T12:04:53.853

使持有您的方法（或方法本身）的对象依赖于`IConfigLoader`某种您可以模拟的对象：

```
public interface IConfigLoader
{
    XmlReader LoadAppConfigFrom(string path);
} 
```

从您的方法中使用它来获取要解析的 XML 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:16:09.783

我建议您问题中的故事混合了几个问题：

1.  查找并打开文件，
2.  将数据加载到“配置”（无论如何表示）
3.  试图从“配置”中获取特定参数

第 3 点现在是关于配置如何表现的问题，并且可以以 TDD 方式开发。

第 2 点现在是关于如何构造配置的问题（例如，通过 ConfigurationLoader），并且可以以 TDD 方式开发（例如，针对 StringReader）。

第 1 点现在是您是否可以为指定文件路径打开 Reader 的问题。完成第2点后很容易添加。

# c# - 在 .NET 中序列化对象时忽略所有 xsi 和 xsd 命名空间？

> ID：625927
> 
> 赞同：151
> 
> 时间：2009-03-09T11:55:52.317
> 
> 标签：c#, .net, xml-serialization

代码如下所示：

```
StringBuilder builder = new StringBuilder();
XmlWriterSettings settings = new XmlWriterSettings();
settings.OmitXmlDeclaration = true;
using (XmlWriter xmlWriter = XmlWriter.Create(builder, settings))
{
    XmlSerializer s = new XmlSerializer(objectToSerialize.GetType());
    s.Serialize(xmlWriter, objectToSerialize);
} 
```

生成的序列化文档包括命名空间，如下所示：

```
<message xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" 
    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" 
    xmlns="urn:something">
 ...
</message> 
```

要删除 xsi 和 xsd 命名空间，我可以按照[How to serialize an object to XML without getting xmlns="..."?](https://stackoverflow.com/questions/258960) .

我希望我的消息标签为`<message>`（没有任何命名空间属性）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：253
> 
> 时间：2009-06-01T17:05:39.640

```
...
XmlSerializer s = new XmlSerializer(objectToSerialize.GetType());
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
ns.Add("","");
s.Serialize(xmlWriter, objectToSerialize, ns); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-17T10:42:23.747

这是两个答案中的第二个。

如果您只想在序列化期间从文档中任意剥离所有命名空间，您可以通过实现自己的 XmlWriter 来做到这一点。

最简单的方法是从 XmlTextWriter 派生并覆盖发出命名空间的 StartElement 方法。StartElement 方法由 XmlSerializer 在发出任何元素（包括根）时调用。通过覆盖每个元素的命名空间并将其替换为空字符串，您已经从输出中剥离了命名空间。

```
public class NoNamespaceXmlWriter : XmlTextWriter
{
    //Provide as many contructors as you need
    public NoNamespaceXmlWriter(System.IO.TextWriter output)
        : base(output) { Formatting= System.Xml.Formatting.Indented;}

    public override void WriteStartDocument () { }

    public override void WriteStartElement(string prefix, string localName, string ns)
    {
        base.WriteStartElement("", localName, "");
    }
} 
```

假设这是类型：

```
// explicitly specify a namespace for this type,
// to be used during XML serialization.
[XmlRoot(Namespace="urn:Abracadabra")]
public class MyTypeWithNamespaces
{
    // private fields backing the properties
    private int _Epoch;
    private string _Label;

    // explicitly define a distinct namespace for this element
    [XmlElement(Namespace="urn:Whoohoo")]
    public string Label
    {
        set {  _Label= value; } 
        get { return _Label; } 
    }

    // this property will be implicitly serialized to XML using the
    // member name for the element name, and inheriting the namespace from
    // the type.
    public int Epoch
    {
        set {  _Epoch= value; } 
        get { return _Epoch; } 
    }
} 
```

以下是在序列化过程中如何使用这样的东西：

```
 var o2= new MyTypeWithNamespaces { ..intializers.. };
        var builder = new System.Text.StringBuilder();
        using ( XmlWriter writer = new NoNamespaceXmlWriter(new System.IO.StringWriter(builder)))
        {
            s2.Serialize(writer, o2, ns2);
        }            
        Console.WriteLine("{0}",builder.ToString()); 
```

不过，XmlTextWriter 有点坏了。根据[参考文档](http://msdn.microsoft.com/en-us/library/system.xml.xmltextwriter.aspx)，当它写入时，它不会检查以下内容：

> *   属性和元素名称中的字符无效。
>     
>     
> *   不符合指定编码的 Unicode 字符。如果 Unicode 字符不符合指定的编码，则 XmlTextWriter 不会将 Unicode 字符转义为字符实体。
>     
>     
> *   重复属性。
>     
>     
> *   DOCTYPE 公共标识符或系统标识符中的字符。

XmlTextWriter 的这些问题自 .NET Framework 的 v1.1 以来一直存在，并且为了向后兼容，它们将继续存在。如果您不担心这些问题，那么请务必使用 XmlTextWriter。但大多数人想要更多的可靠性。

为此，在序列化期间仍然抑制命名空间，而不是从 XmlTextWriter 派生，定义抽象[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)及其 24 个方法的具体实现。

这里有一个例子：

```
public class XmlWriterWrapper : XmlWriter
{
    protected XmlWriter writer;

    public XmlWriterWrapper(XmlWriter baseWriter)
    {
        this.Writer = baseWriter;
    }

    public override void Close()
    {
        this.writer.Close();
    }

    protected override void Dispose(bool disposing)
    {
        ((IDisposable) this.writer).Dispose();
    }

    public override void Flush()
    {
        this.writer.Flush();
    }

    public override string LookupPrefix(string ns)
    {
        return this.writer.LookupPrefix(ns);
    }

    public override void WriteBase64(byte[] buffer, int index, int count)
    {
        this.writer.WriteBase64(buffer, index, count);
    }

    public override void WriteCData(string text)
    {
        this.writer.WriteCData(text);
    }

    public override void WriteCharEntity(char ch)
    {
        this.writer.WriteCharEntity(ch);
    }

    public override void WriteChars(char[] buffer, int index, int count)
    {
        this.writer.WriteChars(buffer, index, count);
    }

    public override void WriteComment(string text)
    {
        this.writer.WriteComment(text);
    }

    public override void WriteDocType(string name, string pubid, string sysid, string subset)
    {
        this.writer.WriteDocType(name, pubid, sysid, subset);
    }

    public override void WriteEndAttribute()
    {
        this.writer.WriteEndAttribute();
    }

    public override void WriteEndDocument()
    {
        this.writer.WriteEndDocument();
    }

    public override void WriteEndElement()
    {
        this.writer.WriteEndElement();
    }

    public override void WriteEntityRef(string name)
    {
        this.writer.WriteEntityRef(name);
    }

    public override void WriteFullEndElement()
    {
        this.writer.WriteFullEndElement();
    }

    public override void WriteProcessingInstruction(string name, string text)
    {
        this.writer.WriteProcessingInstruction(name, text);
    }

    public override void WriteRaw(string data)
    {
        this.writer.WriteRaw(data);
    }

    public override void WriteRaw(char[] buffer, int index, int count)
    {
        this.writer.WriteRaw(buffer, index, count);
    }

    public override void WriteStartAttribute(string prefix, string localName, string ns)
    {
        this.writer.WriteStartAttribute(prefix, localName, ns);
    }

    public override void WriteStartDocument()
    {
        this.writer.WriteStartDocument();
    }

    public override void WriteStartDocument(bool standalone)
    {
        this.writer.WriteStartDocument(standalone);
    }

    public override void WriteStartElement(string prefix, string localName, string ns)
    {
        this.writer.WriteStartElement(prefix, localName, ns);
    }

    public override void WriteString(string text)
    {
        this.writer.WriteString(text);
    }

    public override void WriteSurrogateCharEntity(char lowChar, char highChar)
    {
        this.writer.WriteSurrogateCharEntity(lowChar, highChar);
    }

    public override void WriteValue(bool value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(DateTime value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(decimal value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(double value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(int value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(long value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(object value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(float value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteValue(string value)
    {
        this.writer.WriteValue(value);
    }

    public override void WriteWhitespace(string ws)
    {
        this.writer.WriteWhitespace(ws);
    }

    public override XmlWriterSettings Settings
    {
        get
        {
            return this.writer.Settings;
        }
    }

    protected XmlWriter Writer
    {
        get
        {
            return this.writer;
        }
        set
        {
            this.writer = value;
        }
    }

    public override System.Xml.WriteState WriteState
    {
        get
        {
            return this.writer.WriteState;
        }
    }

    public override string XmlLang
    {
        get
        {
            return this.writer.XmlLang;
        }
    }

    public override System.Xml.XmlSpace XmlSpace
    {
        get
        {
            return this.writer.XmlSpace;
        }
    }        
} 
```

然后，提供一个覆盖 StartElement 方法的派生类，如前所述：

```
public class NamespaceSupressingXmlWriter : XmlWriterWrapper
{
    //Provide as many contructors as you need
    public NamespaceSupressingXmlWriter(System.IO.TextWriter output)
        : base(XmlWriter.Create(output)) { }

    public NamespaceSupressingXmlWriter(XmlWriter output)
        : base(XmlWriter.Create(output)) { }

    public override void WriteStartElement(string prefix, string localName, string ns)
    {
        base.WriteStartElement("", localName, "");
    }
} 
```

然后像这样使用这个作家：

```
 var o2= new MyTypeWithNamespaces { ..intializers.. };
        var builder = new System.Text.StringBuilder();
        var settings = new XmlWriterSettings { OmitXmlDeclaration = true, Indent= true };
        using ( XmlWriter innerWriter = XmlWriter.Create(builder, settings))
            using ( XmlWriter writer = new NamespaceSupressingXmlWriter(innerWriter))
            {
                s2.Serialize(writer, o2, ns2);
            }            
        Console.WriteLine("{0}",builder.ToString()); 
```

这要[归功于 Oleg Tkachenko](http://www.tkachenko.com/blog/archives/000584.html)。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-06-20T23:44:25.047

在网上阅读了微软的文档和几个解决方案后，我发现了这个问题的解决方案。它适用于内置`XmlSerializer`和自定义 XML 序列化（通过`IXmlSerialiazble`.

也就是说，我将使用`MyTypeWithNamespaces`迄今为止在此问题的答案中使用的相同 XML 示例。

```
[XmlRoot("MyTypeWithNamespaces", Namespace="urn:Abracadabra", IsNullable=false)]
public class MyTypeWithNamespaces
{
    // As noted below, per Microsoft's documentation, if the class exposes a public
    // member of type XmlSerializerNamespaces decorated with the 
    // XmlNamespacesDeclarationAttribute, then the XmlSerializer will utilize those
    // namespaces during serialization.
    public MyTypeWithNamespaces( )
    {
        this._namespaces = new XmlSerializerNamespaces(new XmlQualifiedName[] {
            // Don't do this!! Microsoft's documentation explicitly says it's not supported.
            // It doesn't throw any exceptions, but in my testing, it didn't always work.

            // new XmlQualifiedName(string.Empty, string.Empty),  // And don't do this:
            // new XmlQualifiedName("", "")

            // DO THIS:
            new XmlQualifiedName(string.Empty, "urn:Abracadabra") // Default Namespace
            // Add any other namespaces, with prefixes, here.
        });
    }

    // If you have other constructors, make sure to call the default constructor.
    public MyTypeWithNamespaces(string label, int epoch) : this( )
    {
        this._label = label;
        this._epoch = epoch;
    }

    // An element with a declared namespace different than the namespace
    // of the enclosing type.
    [XmlElement(Namespace="urn:Whoohoo")]
    public string Label
    {
        get { return this._label; }
        set { this._label = value; }
    }
    private string _label;

    // An element whose tag will be the same name as the property name.
    // Also, this element will inherit the namespace of the enclosing type.
    public int Epoch
    {
        get { return this._epoch; }
        set { this._epoch = value; }
    }
    private int _epoch;

    // Per Microsoft's documentation, you can add some public member that
    // returns a XmlSerializerNamespaces object. They use a public field,
    // but that's sloppy. So I'll use a private backed-field with a public
    // getter property. Also, per the documentation, for this to work with
    // the XmlSerializer, decorate it with the XmlNamespaceDeclarations
    // attribute.
    [XmlNamespaceDeclarations]
    public XmlSerializerNamespaces Namespaces
    {
        get { return this._namespaces; }
    }
    private XmlSerializerNamespaces _namespaces;
} 
```

这就是这堂课的全部内容。现在，有些人反对`XmlSerializerNamespaces`在他们的类中的某个地方有一个对象。但正如您所看到的，我巧妙地将其隐藏在默认构造函数中，并公开了一个公共属性以返回命名空间。

现在，当需要序列化类时，您将使用以下代码：

```
MyTypeWithNamespaces myType = new MyTypeWithNamespaces("myLabel", 42);

/******
   OK, I just figured I could do this to make the code shorter, so I commented out the
   below and replaced it with what follows:

// You have to use this constructor in order for the root element to have the right namespaces.
// If you need to do custom serialization of inner objects, you can use a shortened constructor.
XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces), new XmlAttributeOverrides(),
    new Type[]{}, new XmlRootAttribute("MyTypeWithNamespaces"), "urn:Abracadabra");

******/
XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces),
    new XmlRootAttribute("MyTypeWithNamespaces") { Namespace="urn:Abracadabra" });

// I'll use a MemoryStream as my backing store.
MemoryStream ms = new MemoryStream();

// This is extra! If you want to change the settings for the XmlSerializer, you have to create
// a separate XmlWriterSettings object and use the XmlTextWriter.Create(...) factory method.
// So, in this case, I want to omit the XML declaration.
XmlWriterSettings xws = new XmlWriterSettings();
xws.OmitXmlDeclaration = true;
xws.Encoding = Encoding.UTF8; // This is probably the default
// You could use the XmlWriterSetting to set indenting and new line options, but the
// XmlTextWriter class has a much easier method to accomplish that.

// The factory method returns a XmlWriter, not a XmlTextWriter, so cast it.
XmlTextWriter xtw = (XmlTextWriter)XmlTextWriter.Create(ms, xws);
// Then we can set our indenting options (this is, of course, optional).
xtw.Formatting = Formatting.Indented;

// Now serialize our object.
xs.Serialize(xtw, myType, myType.Namespaces); 
```

完成此操作后，您应该得到以下输出：

```
<MyTypeWithNamespaces>
    <Label xmlns="urn:Whoohoo">myLabel</Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

我在最近的一个项目中成功地使用了这种方法，其中包含一系列被序列化为 XML 以用于 Web 服务调用的类。Microsoft 的文档并不清楚`XmlSerializerNamespaces`一旦创建了可公开访问的成员后如何处理它，因此许多人认为它没有用。但是通过遵循他们的文档并以上面显示的方式使用它，您可以自定义 XmlSerializer 如何为您的类生成 XML，而无需诉诸不受支持的行为或通过实现`IXmlSerializable`.

我希望这个答案能够一劳永逸地解决如何`xsi`摆脱`xsd`由`XmlSerializer`.

更新：我只是想确保我回答了 OP 关于删除所有命名空间的问题。我上面的代码将为此工作；让我来告诉你怎么做。现在，在上面的示例中，您确实无法摆脱所有名称空间（因为有两个名称空间在使用中）。在您的 XML 文档的某个地方，您将需要有类似`xmlns="urn:Abracadabra" xmlns:w="urn:Whoohoo`. 如果示例中的类是较大文档的一部分，则必须在命名空间上方的某处为 和 之一（或两者）`Abracadbra`声明`Whoohoo`。如果没有，那么一个或两个命名空间中的元素必须用某种前缀修饰（你不能有两个默认命名空间，对吧？）。所以，对于这个例子，`Abracadabra`是默认命名空间。我可以在我的`MyTypeWithNamespaces`类中为命名空间添加一个命名空间前缀，`Whoohoo`如下所示：

```
public MyTypeWithNamespaces
{
    this._namespaces = new XmlSerializerNamespaces(new XmlQualifiedName[] {
        new XmlQualifiedName(string.Empty, "urn:Abracadabra"), // Default Namespace
        new XmlQualifiedName("w", "urn:Whoohoo")
    });
} 
```

现在，在我的类定义中，我指出该`<Label/>`元素在 namespace`"urn:Whoohoo"`中，所以我不需要做任何进一步的事情。当我现在使用上面的序列化代码序列化类时，输出如下：

```
<MyTypeWithNamespaces xmlns:w="urn:Whoohoo">
    <w:Label>myLabel</w:Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

因为`<Label>`它与文档的其余部分位于不同的命名空间中，所以它必须以某种方式用命名空间“装饰”。请注意，仍然没有`xsi`和`xsd`命名空间。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-04-13T07:27:16.887

```
XmlSerializer sr = new XmlSerializer(objectToSerialize.GetType());
TextWriter xmlWriter = new StreamWriter(filename);
XmlSerializerNamespaces namespaces = new XmlSerializerNamespaces();
namespaces.Add(string.Empty, string.Empty);
sr.Serialize(xmlWriter, objectToSerialize, namespaces); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-17T09:37:38.957

这是我对这个问题的两个答案中的第一个。

如果您想对命名空间进行精细控制——例如，如果您想省略其中的一些而不是其他的，或者如果您想用另一个命名空间替换一个命名空间，您可以使用[XmlAttributeOverrides](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeoverrides.aspx)来做到这一点。

假设你有这个类型定义：

```
// explicitly specify a namespace for this type,
// to be used during XML serialization.
[XmlRoot(Namespace="urn:Abracadabra")]
public class MyTypeWithNamespaces
{
    // private fields backing the properties
    private int _Epoch;
    private string _Label;

    // explicitly define a distinct namespace for this element
    [XmlElement(Namespace="urn:Whoohoo")]
    public string Label
    {
        set {  _Label= value; } 
        get { return _Label; } 
    }

    // this property will be implicitly serialized to XML using the
    // member name for the element name, and inheriting the namespace from
    // the type.
    public int Epoch
    {
        set {  _Epoch= value; } 
        get { return _Epoch; } 
    }
} 
```

而这个序列化伪代码：

```
 var o2= new MyTypeWithNamespaces() { ..initializers...};
        ns.Add( "", "urn:Abracadabra" );
        XmlSerializer s2 = new XmlSerializer(typeof(MyTypeWithNamespaces));
        s2.Serialize(System.Console.Out, o2, ns); 
```

你会得到类似这样的 XML：

```
<MyTypeWithNamespaces xmlns="urn:Abracadabra">
  <Label xmlns="urn:Whoohoo">Cimsswybclaeqjh</Label>
  <Epoch>97</Epoch>
</MyTypeWithNamespaces> 
```

请注意，根元素上有一个默认命名空间，“标签”元素上也有一个不同的命名空间。在上面的代码中，这些命名空间由装饰类型的属性决定。

.NET 中的 Xml 序列化框架包括显式*覆盖*修饰实际代码的属性的可能性。您可以使用 XmlAttributesOverrides 类和朋友来执行此操作。假设我有相同的类型，并以这种方式序列化它：

```
 // instantiate the container for all attribute overrides
        XmlAttributeOverrides xOver = new XmlAttributeOverrides();

        // define a set of XML attributes to apply to the root element
        XmlAttributes xAttrs1 = new XmlAttributes();

        // define an XmlRoot element (as if [XmlRoot] had decorated the type)
        // The namespace in the attribute override is the empty string. 
        XmlRootAttribute xRoot = new XmlRootAttribute() { Namespace = ""};

        // add that XmlRoot element to the container of attributes
        xAttrs1.XmlRoot= xRoot;

        // add that bunch of attributes to the container holding all overrides
        xOver.Add(typeof(MyTypeWithNamespaces), xAttrs1);

        // create another set of XML Attributes
        XmlAttributes xAttrs2 = new XmlAttributes();

        // define an XmlElement attribute, for a type of "String", with no namespace
        var xElt = new XmlElementAttribute(typeof(String)) { Namespace = ""};

        // add that XmlElement attribute to the 2nd bunch of attributes
        xAttrs2.XmlElements.Add(xElt);

        // add that bunch of attributes to the container for the type, and
        // specifically apply that bunch to the "Label" property on the type.
        xOver.Add(typeof(MyTypeWithNamespaces), "Label", xAttrs2);

        // instantiate a serializer with the overrides 
        XmlSerializer s3 = new XmlSerializer(typeof(MyTypeWithNamespaces), xOver);

        // serialize
        s3.Serialize(System.Console.Out, o2, ns2); 
```

结果如下所示；

```
<MyTypeWithNamespaces>
  <Label>Cimsswybclaeqjh</Label>
  <Epoch>97</Epoch>
</MyTypeWithNamespaces> 
```

您已经剥离了命名空间。

一个合乎逻辑的问题是，*您能否在序列化过程中从任意类型中剥离所有命名空间，而无需通过显式覆盖？* 答案是肯定的，如何做在我的下一个回复中。

# java - 用什么替换这个java代码？

> ID：625928
> 
> 赞同：2
> 
> 时间：2009-03-09T11:55:55.187
> 
> 标签：java, applet, audio

以下代码用于在我的 java 小程序中播放声音文件：

```
public synchronized void play() {
   try {
          //Here filename is a URL retreived through
          //getClassLoader().getResource()
            InputStream in = new FileInputStream(filename.getFile());
            AudioStream as = new AudioStream(in);
            AudioPlayer.player.start(as); 

    } catch (IOException e) {
            e.printStackTrace();
    } 
```

当我使用 Eclipse 在本地运行小程序时，它可以工作，但如果我尝试将其打包在 .jar 中并在 Web 浏览器中作为小程序运行，它就不起作用。注释掉这段代码使小程序工作。

我应该用什么替换上面的代码，以便它可以在小程序中工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:58:47.847

尝试在 ClassLoader 上使用 getResourceAsStream() 而不是 new FileInputStream()。这将返回一个 InputStream，您可以将其传递给 AudioStream。所以像：

```
InputStream in = getClassLoader().getResourceAsStream(getClassLoader().getResource());
AudioStream as = new AudioStream(in) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T12:06:42.553

使用[ClassLoader.getResourceAsStream](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream(java.lang.String))或[URL.openStream](http://java.sun.com/javase/6/docs/api/java/net/URL.html#openStream())。请记住关闭您的流以避免资源泄漏。

或者，检查[AudioClip](http://java.sun.com/javase/6/docs/api/java/applet/AudioClip.html)类是否满足您的需求：

```
 private AudioClip sound = null;

  private AudioClip getSound() {
    if (sound == null) {
      ClassLoader classLoader = TestApplet.class
          .getClassLoader();
      URL url = classLoader.getResource("assets/sound.wav");
      sound = JApplet.newAudioClip(url);
    }
    return sound;
  } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T11:58:12.403

使用`getClassLoader().getResourceAsStream()`而不是`new FileInputStream(...)`. 这里没有涉及本地文件（可能，例如使用 jar 文件时）。基本上，您想要获取声音数据的流，并且当您从类路径中获取资源时，这`getResourceAsStream()`是最简单的方法。

（如果需要，您可以使用`getResource()`其次`openStream()`，但没有多大意义。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T11:58:57.177

看看类中的[getResourceAsStream()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassLoader.html#getResourceAsStream(java.lang.String))方法`java.lang.ClassLoader`。

即使您没有 JAR，只要相关文件在您的`CLASSPATH`.

# mysql - 版本 5 及更高版本中 MySQL 数据库的最大大小是多少？

> ID：625930
> 
> 赞同：5
> 
> 时间：2009-03-09T11:56:02.753
> 
> 标签：mysql

版本 5 及更高版本中 MySQL 数据库的最大大小是多少？

我不是指行或表的最大大小，而是整个数据库的最大大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T11:58:48.673

20 亿 (2'000'000'000) 个表和 InnoDB 的最大总量为 64TB。MyISAM 表是文件，因此它是底层操作系统文件限制。

检查这个答案：[https ://forums.mysql.com/read.php?79,158,165](https://forums.mysql.com/read.php?79,158,165)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T12:01:36.170

这取决于您的操作系统。即在 Windows 上，它取决于最大文件夹大小。

[此文档条目](http://dev.mysql.com/doc/refman/5.0/en/full-table.html)对此非常有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T12:03:37.837

MySQL 数据库的最大大小取决于操作系统对表文件大小的限制，而不是 MySQL 内部限制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-29T11:37:28.470

这一切都取决于操作系统

```
操作系统文件大小限制
Win32 带 FAT/FAT32 2GB/4GB
Win32 w/ NTFS 2TB（可能更大）
Linux 2.2-Intel 32 位 2GB (LFS: 4GB)
Linux 2.4+（使用ext3文件系统）4TB
Solaris 9/10 16TB
MacOS X 带 HFS+ 2TB

```

# jquery - 如何将 DOM 元素转换为 jQuery 元素？

> ID：625936
> 
> 赞同：305
> 
> 时间：2009-03-09T11:56:52.827
> 
> 标签：jquery

我正在使用 document.createElement() 创建一个元素。现在如何将它传递给只接受 Jquery 对象的函数？

```
$("#id") 
```

我不能使用它，因为该元素尚未在页面中呈现。

* * *

## 回答 #1

> 赞同：495
> 
> 时间：2009-03-09T11:58:19.737

```
var elm = document.createElement("div");
var jelm = $(elm);//convert to jQuery Element
var htmlElm = jelm[0];//convert to HTML Element 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-09T12:11:43.400

使用 jQuery 构造元素怎么样？例如

```
$("<div></div>") 
```

创建一个新的 div 元素，准备添加到页面中。可以进一步缩短为

```
$("<div>") 
```

然后您可以链接您需要的命令，设置事件处理程序并将其附加到 DOM。例如

```
$('<div id="myid">Div Content</div>')
    .bind('click', function(e) { /* event handler here */ })
    .appendTo('#myOtherDiv'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-08-30T10:56:40.237

到目前为止，我做出的最佳解决方案：

```
function convertHtmlToJQueryObject(html){
    var htmlDOMObject = new DOMParser().parseFromString(html, "text/html");
    return $(htmlDOMObject.documentElement);
} 
```

# c# - 如何将对象/结构转换为arraylist？

> ID：625945
> 
> 赞同：1
> 
> 时间：2009-03-09T11:59:41.667
> 
> 标签：c#, .net

我在 C#.net 中有一个结构。我已经创建了该结构的对象。我需要将这个结构对象转换为 ArrayList。我在用 ：

```
OrderMessageStructure.OrderMessage orderToModify = new OrderMessageStructure.OrderMessage();

object neworderobject = (object)orderToModify;
ArrayList arr = new ArrayList();
arr = (ArrayList)neworderobject; 
```

但我收到错误“无法将'OrderMessage'类型的对象转换为'System.Collections.ArrayList'。”

如何将对象/结构转换为 ArrayList？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T12:02:27.557

在 C# 中，您不能只将任何对象转换为另一个对象。它是一种类型安全的语言。

您需要为其创建一个`ArrayList`和`Add()`您的结构。

更好的是，创建一个`List<StructType>()`并将您的结构添加到其中。

[CLR 通过 C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)。阅读。

* * *

```
OrderMessageStructure.OrderMessage orderToModify = 
  new OrderMessageStructure.OrderMessage();

ArrayList arr = new ArrayList();
arr.Add(orderToModify); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T12:08:42.113

您的问题没有足够的信息来给出肯定的答案。

如果要创建 OrderMessage 对象的 ArrayList，则需要先创建 arraylist，然后添加 OrderMessage 实例。

如果您想要 OrderMessage 的强类型 ArrayList，请使用通用命名空间中的 List 并将 OrderMessage 的实例添加到其中。

如果您的 OrderMessage 中有一个数组结构，那么您将需要向它添加一个返回数组列表的方法。您必须编写将 OrderMessage 转换为 ArrayList 的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T12:03:18.710

您无法转换这两个对象，因为它们具有完全不相关的类型。为了使转换成功，OrderMessage 必须从 ArrayList 继承，这几乎肯定不是您想要的。您更有可能希望将 OrderMessage 添加到 ArrayList 中，可以这样做。

```
ArrayList arr = new ArrayList();
arr.Add(orderToModify); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T12:05:33.337

无需投射物体。只需将它们添加到您的数组列表中：

```
ArrayList list = new ArrayList();
list.Add(myObject); 
```

但更好的选择是使用通用列表：

```
List<MyObject> list = new List<MyOjbect>();
list.Add(MyObject); 
```

泛型列表的优点是它是强类型的，因此在将对象从列表中拉出时，您不必将其转换回您的类型。

# oop - OCaml 对象中的递归函数

> ID：625946
> 
> 赞同：3
> 
> 时间：2009-03-09T12:00:04.007
> 
> 标签：oop, recursion, methods, ocaml

我试图在对象方法的上下文中找出 OCaml 的递归。我尝试了以下代码，但似乎无法编译。

```
class foo =
object (self)
 method loopTest =
  let rec doIt x =
   Printf.printf "%d\n" x;
   if x>1 then doIt (x+1)
end;; 
```

如何在方法中创建此类递归函数？

修改后的代码：

```
class foo =
object (self)
 method loopTest =
  let rec doIt x =
   Printf.printf "%d\n" x;
   if x<10 then doIt (x+1) in doIt 0
end;; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T13:28:48.957

您仍然需要在 loopTest 方法中调用 doIt。`let`只定义doIt，就像`method`只定义一个方法，不调用它。编译器检测到这一点是因为它不知道从 loopTest 返回什么（例如没有返回类型 void，但在 C# 或 Java 中没有实现的方法）。

此外，您正在使用此代码进行无限循环，也许`if x>1 then doIt (x-1)`接下来`doIt 100`是一个更好的主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T13:19:12.023

我的 OCaml 生锈了，但我不认为 let 评估它绑定的内容。如果您希望 testLoop 调用 doIt，请添加一个 in doIt 或类似内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T14:57:08.523

同一代码中有两个无限循环；），我猜你应该了解迭代器；）

# c# - 什么是 C# 中 Hashtable 实现的示例？

> ID：625947
> 
> 赞同：37
> 
> 时间：2009-03-09T12:01:02.910
> 
> 标签：c#, .net, hashtable

我意识到 C# 和 .NET 通常已经有了 Hashtable 和 Dictionary 类。

任何人都可以在 C# 中演示 Hashtable 的实现吗？

**更新：**澄清一下，我不一定要寻找完整的实现，只是哈希表核心功能的一个示例（即添加、删除、按键查找）。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2010-01-20T12:34:21.800

问题被问了很久之后，所以我不希望获得太多的代表。但是，我认为编写自己的非常基本的示例（不到 90 行代码）会很有趣：

```
 public struct KeyValue<K, V>
    {
        public K Key { get; set; }
        public V Value { get; set; }
    }

    public class FixedSizeGenericHashTable<K,V>
    {
        private readonly int size;
        private readonly LinkedList<KeyValue<K,V>>[] items;

        public FixedSizeGenericHashTable(int size)
        {
            this.size = size;
            items = new LinkedList<KeyValue<K,V>>[size];
        }

        protected int GetArrayPosition(K key)
        {
            int position = key.GetHashCode() % size;
            return Math.Abs(position);
        }

        public V Find(K key)
        {
            int position = GetArrayPosition(key);
            LinkedList<KeyValue<K, V>> linkedList = GetLinkedList(position);
            foreach (KeyValue<K,V> item in linkedList)
            {
                if (item.Key.Equals(key))
                {
                    return item.Value;
                }
            }

            return default(V);
        }

        public void Add(K key, V value)
        {
            int position = GetArrayPosition(key);
            LinkedList<KeyValue<K, V>> linkedList = GetLinkedList(position);
            KeyValue<K, V> item = new KeyValue<K, V>() { Key = key, Value = value };
            linkedList.AddLast(item);
        }

        public void Remove(K key)
        {
            int position = GetArrayPosition(key);
            LinkedList<KeyValue<K, V>> linkedList = GetLinkedList(position);
            bool itemFound = false;
            KeyValue<K, V> foundItem = default(KeyValue<K, V>);
            foreach (KeyValue<K,V> item in linkedList)
            {
                if (item.Key.Equals(key))
                {
                    itemFound = true;
                    foundItem = item;
                }
            }

            if (itemFound)
            {
                linkedList.Remove(foundItem);
            }
        }

        protected LinkedList<KeyValue<K, V>> GetLinkedList(int position)
        {
            LinkedList<KeyValue<K, V>> linkedList = items[position];
            if (linkedList == null)
            {
                linkedList = new LinkedList<KeyValue<K, V>>();
                items[position] = linkedList;
            }

            return linkedList;
        }
    } 
```

这是一个小测试应用程序：

```
 static void Main(string[] args)
        {
            FixedSizeGenericHashTable<string, string> hash = new FixedSizeGenericHashTable<string, string>(20);

            hash.Add("1", "item 1");
            hash.Add("2", "item 2");
            hash.Add("dsfdsdsd", "sadsadsadsad");

            string one = hash.Find("1");
            string two = hash.Find("2");
            string dsfdsdsd = hash.Find("dsfdsdsd");
            hash.Remove("1");
            Console.ReadLine();
        } 
```

这不是最好的实现，但它适用于添加、删除和查找。它使用[链接](http://en.wikipedia.org/wiki/Hash_table#Separate_chaining)和简单的模算法来找到合适的桶。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T12:04:12.157

你看过[C5系列](http://www.itu.dk/research/c5/)吗？您可以[下载](http://www.itu.dk/research/c5/Release1.1/C5.src.zip)包含哈希表的源代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T12:08:44.907

您可以看到如何使用反射器实现 .NET 哈希表（例如在 C# 中）

[http://www.red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-09T12:24:49.360

当然还有 Mono 版本的类库：

*   [System.Collections.Hashtable](https://github.com/mono/mono/tree/mono-3.0.3/mcs/class/corlib/System.Collections/Hashtable.cs?view=markup)

*   [System.Collections.Generic.Dictionary](https://github.com/mono/mono/tree/mono-3.0.3/mcs/class/corlib/System.Collections.Generic/Dictionary.cs?view=markup)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T12:23:39.143

[您还可以在此处查看Mono](http://www.go-mono.com)的 Hashtable 实现：

[http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/corlib/System.Collections/Hashtable.cs?revision=111788&view=markup](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/corlib/System.Collections/Hashtable.cs?revision=111788&view=markup)

# wpf - 用拇指拖动wpf窗口：可以透明吗？

> ID：625952
> 
> 赞同：3
> 
> 时间：2009-03-09T12:03:00.787
> 
> 标签：wpf, slider, drag

我一直在测试[Blu](http://www.thirteen23.com/experiences/desktop/blu/)，我注意到我可以拖动窗口。这个窗口是透明的。我试图用拇指做同样的事情，但我不知道如何让它透明。窗口的其余部分是透明的，但拇指不是。

有没有办法让拇指透明，或者我应该使用另一种技术？

我使用这个事件：

```
 private void DragThumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e)
    {
        Canvas.SetLeft(this, Canvas.GetLeft(this) + e.HorizontalChange);
        Canvas.SetTop(this, Canvas.GetTop(this) + e.VerticalChange);
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-10T15:26:02.457

您可以使用不透明度属性使拇指控件不可见。

不透明度 =“1”（完全可见）

或者

不透明度 =“0”（不可见）

我的应用程序示例

```
 <Thumb Name="myThumb"
               Width="10"
               Height="10"
               DragDelta="onDragDelta"
               DragStarted="onDragStarted"
               DragCompleted="onDragCompleted"
               Margin="5"
               HorizontalAlignment="Right"
               Opacity="1">

        </Thumb> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T12:09:52.547

不确定我是否正确理解了您的问题，但是要拖动 wpf 窗口，您需要在表单（或表单本身）上输入组件的单击事件处理程序是：

```
this.DragMove(); 
```

无需自己实现拖动功能。

* * *

更新：小例子：创建一个窗口，在其中放置一个按钮。将窗口的 MouseDown 和按钮的 Click 连接为：

```
 private void Window_MouseDown(object sender, MouseButtonEventArgs e)
{
    this.DragMove();
}
private void button1_Click(object sender, RoutedEventArgs e)
{
    MessageBox.Show("hey");
} 
```

完美运行，可以拖动窗口，按钮继续工作...

# wcf - 持久化属性 - 异步

> ID：625953
> 
> 赞同：0
> 
> 时间：2009-03-09T12:03:17.680
> 
> 标签：wcf, silverlight, asynchronous

在经典的 ASP.NET 中，我将从 web 服务中提取的数据保存在基类属性中，如下所示：

```
 private string m_stringData;
   public string _stringData
    {  get {
            if (m_stringData==null)
                {
                    //fetch data from my web service
                    m_stringData = ws.FetchData()
                }
            return m_stringData;
       }
   } 
```

这样我就可以简单地引用**_stringData**并知道我总是会得到我想要的数据（也许有时我会使用 Session state 作为存储而不是私有成员变量）。

在带有 WCF 的 Silverlight 中，我可能会选择使用独立存储作为我的持久性机制，但服务调用不能这样完成，因为必须异步调用 WCF 服务。

**如何在一种方法中同时调用服务调用和检索响应？**

谢谢，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T12:18:56.737

在您的方法中，异步调用服务调用并注册一个设置标志的回调。调用该方法后，进入一个繁忙/等待循环，定期检查标志，直到标志设置为指示数据已返回。回调应该为您的方法设置支持字段，并且您应该能够在检测到已设置指示成功的标志后立即返回它。您还需要担心失败。如果可以从不同的线程多次调用您的方法，您还需要使用一些锁定来使您的代码线程安全。

**编辑**

实际上，如果 Web 服务支持 BeginGetData/EndGetData 语义，那么忙/等待循环可能不是要走的路。我查看了一些我做类似事情的代码，我使用 WaitOne 来简单地等待异步结果，然后检索它。如果您的网络服务不支持这一点，那么在您的等待循环中抛出一个 Thread.Sleep（例如 50-100 毫秒），以便为其他进程执行提供时间。

我的代码示例：

```
IAsyncResult asyncResult = null;
try
{
    asyncResult = _webService.BeginGetData( searchCriteria, null, null );
    if (asyncResult.AsyncWaitHandle.WaitOne( _timeOut, false ))
    {
        result = _webService.EndGetData( asyncResult );
    }
}
catch (WebException e)
{
    ...log the error, clean up...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T09:23:53.670

感谢您的帮助 tvanfosson。我遵循了您的代码，还找到了一个使用 lambda 表达式完全满足我需求的伪类似解决方案：

```
private string m_stringData;
public string _stringData{    
get
    {
   //if we don't have a list of departments, fetch from WCF
        if (m_stringData == null)
        {
            StringServiceClient client = new StringServiceClient();
            client.GetStringCompleted +=
                (sender, e) =>
                {
                    m_stringData = e.Result;
                };
            client.GetStringAsync();
        }
        return m_stringData;
    }
} 
```

**编辑**

糟糕...实际上这也不起作用:-(我最终异步进行调用并更改了我的编程逻辑以使用 MVVM 模式和更多绑定。

# silverlight - 跨域策略不生效

> ID：625959
> 
> 赞同：2
> 
> 时间：2009-03-09T12:04:03.480
> 
> 标签：silverlight, web-services, configuration, cross-domain

我创建了一个如下所示的 ClientAccessPolicy.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from>
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

并将其放在 C:\Inetpub\wwwroot\wss\VirtualDirectories\intranet-80 中，然后运行 ​​iisreset。尽管如此，当我通过 Silverlight 访问 Web 服务时，我得到一个 CommunicationException ，说没有正确的跨域策略。我还需要做什么才能访问我的网络服务？我无法从其他主机访问它，也无法从生成的文件 E:\Development\MySLProject\MySLProject\bin\Debug\Default.html?

干杯

尼克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-11-18T16:29:57.123

告诉您*如何*解决此问题比告诉您必须将文件放在*哪里更容易：*

*   第 1 步：安装并启动[Fiddler](http://www.fiddler2)
*   第 2 步：打开您的 silverlight 客户端
*   第 3 步：在 Fiddler 中查看您的客户端请求 clientAccessPolicy.xml 的位置（这是一个简单的 http GET 请求，例如下载图像或其他）
*   第 4 步：将您的 clientAccessPolicy 文件放在正确的位置（直接用浏览器下载进行测试）

我敢打赌你会在不到 10 分钟的时间内解决问题（去过那里，做到了:-)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T16:27:33.800

您必须将此文件放在**服务器根目录**中，而不是放在您的虚拟目录根目录中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-08T12:05:39.000

在 Silverlight 中：在 ServiceReferences.ClientConfig 文件中使用相对路径

```
<client>
<endpoint address="../Service1.svc" 
```

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T05:09:07.960

解决问题花了 4 个小时。最初，我将“clientaccesspolicy.xml”和跨域放入 Web 服务根目录。一旦我将这些文件放入服务器根目录 C:\Inetpub\wwwroot" 我的应用程序就开始工作了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T11:18:53.057

过去，我在 clientaccesspolicy.xml 文件中遇到过类似的问题，我对该文件所做的任何事情都不会让我的 Silverlight 应用程序接受它并继续调用 Web 服务。我正在使用[ProxyTrace](http://www.pocketsoap.com/tcptrace/pt.aspx)来确保 Silverlight 正在请求该文件并正确返回它。

最终出于绝望，我删除了 clientaccesspolicy.xml 文件并尝试了替代 crossdomain.xml 文件，该文件旨在让 Silverlight 与 Flash 目标网站一起工作，并且可以立即工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-18T13:47:47.333

**最好的解决方案是>>找出您站点的根物理路径>>将文件“ClientAccessPolicy.xml”复制到其中>>现在尝试访问。**

# python - Store Django form.cleaned_data in null model field?

> ID：625977
> 
> 赞同：2
> 
> 时间：2009-03-09T12:08:52.707
> 
> 标签：python, django

I have a django model, which has a int field (with null=True, blank=True). Now when I get a form submit from the user, I assign it like so:

```
my_model.width= form.cleaned_data['width'] 
```

However sometimes I get an error:

```
ValueError: invalid literal for int() with base 10: '' 
```

I was wandering if it's the blank ('') string value that gets assigned to the field? Because my understanding was the model will treat blank string as null/blank?

Any help would be appreciated in this matter. Thanks.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T13:03:09.703

No, it doesn't. If you want to assign NULL, use Python's `None`. Otherwise Django will try to parse a number from the string and that fails for the empty string.

You can use the `or` construct to achieve this:

```
my_model.width = form.cleaned_data['width'] or None 
```

# php - 如何使用 XPath 执行不区分大小写的搜索并支持非英文字符？

> ID：625986
> 
> 赞同：7
> 
> 时间：2009-03-09T12:12:42.633
> 
> 标签：php, xml, xpath

我正在使用以下代码在 XML 文件中执行搜索：

```
$result = $xml->xpath("//StopPoint[contains(StopName, '$query')]"); 
```

其中 $query 是搜索查询，StopName 是公交车站的名称。问题是，它区分大小写。

不仅如此，我还可以使用诸如 ÆØÅæøå 之类的非英语字符进行搜索，以返回挪威名称。

这怎么可能？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T12:57:33.103

在 XPath 1.0 中（我相信，这是 PHP SimpleXML 可以得到的最好的版本），您必须使用该`translate()`函数从混合大小写的输入中生成全小写的输出。

为方便起见，我会将它包装在这样的函数中：

```
function findStopPointByName($xml, $query) {
  $upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZÆØÅ"; // add any characters...
  $lower = "abcdefghijklmnopqrstuvwxyzæøå"; // ...that are missing

  $arg_stopname = "translate(StopName, '$upper', '$lower')";
  $arg_query    = "translate('$query', '$upper', '$lower')";

  return $xml->xpath("//StopPoint[contains($arg_stopname, $arg_query)");
} 
```

作为一种清理措施，我将完全禁止或转义 中的单引号`$query`，因为如果它们被忽略，它们会破坏您的 XPath 字符串。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-09T12:28:39.240

在 XPath 2.0 中，您可以使用[`lower-case()`](http://www.w3.org/TR/xpath-functions/#func-lower-case)支持 unicode 的函数，因此它可以很好地处理非 ASCII 字符。

```
contains(lower-case(StopName), lower-case('$query')) 
```

要访问 XPath 2.0，您需要 XSLT 2.0 解析器。例如[撒克逊](http://saxon.sourceforge.net/)。您可以通过 JavaBridge[从 PHP访问它。](http://saxon.wiki.sourceforge.net/Saxon-from-PHP)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T12:27:39.807

非英文名称应该不是问题。只需将它们添加到您的 XPath。（XML 被定义为使用 Unicode）。

至于不区分大小写，...

XPath 1.0 包括以下[语句](http://www.w3.org/TR/1999/REC-xpath-19991116#booleans)：

> 两个字符串相等当且仅当它们由相同的 UCS 字符序列组成。

因此，即使在本地名称上使用显式谓词也无济于事。

XPath 2 包括映射大小写的函数。例如[fn:大写](http://www.w3.org/TR/2007/REC-xpath-functions-20070123/#func-upper-case)

* * *

附加：使用 XPath 的翻译功能应该允许在 XPath 1 中伪造大小写映射，但输入需要包含您和您的用户将需要的每个大小写代码点：

```
"test" = translate($inputString, "abcdefghijklmnopqrstuvwxyz", "ABCDEFGHIJKLMNOPQRSTUVWXYZ") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:19:23.010

此外：

> $xml->xpath("//StopPoint[contains(StopName, '$query')]");

您需要从 $query 中删除任何撇号字符以避免破坏您的表达式。

在 XPath 2.0 中，您可以将分隔符中使用的引号加倍以将该引号放入字符串文字中，但在 XPath 1.0 中，不可能在字符串中包含分隔符。

# c++ - 有什么理由不使用 Visual Studio 6 for C++？

> ID：625990
> 
> 赞同：3
> 
> 时间：2009-03-09T12:14:57.590
> 
> 标签：c++, visual-c++-6

为什么我不应该使用 Visual Studio 6 进行 C++ 开发？

*   我在哪里可以找到一些资源，为什么这会或不会是一个好主意？
*   有没有我会遇到的问题清单？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-09T12:19:33.087

我不会说 Visual Studio 6 应该“永远”用于 C++ 开发。我想说它应该“不再”用于 C++ 开发。原因：

1.  微软后来的编译器（尤其是 Visual Studio 2008）更符合 C++ 规范。
2.  微软后来的编译器添加了更好的警告和错误。这些在查找代码的潜在安全问题时很有用。
3.  它不再受支持。较新版本的 Windows SDK 不适用于 Visual C++ 6，因此如果没有额外的工作，您将无法在 Windows 中使用较新的功能。

总结一下：停止使用 Visual C++ 6。如果必须使用 Microsoft C++ 编译器，请使用 Visual Studio 2008。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-09T13:37:26.347

1.  `std::string`运行时中的多核/proc 问题，re: [KB813810](http://support.microsoft.com/kb/813810)
2.  STL 支持不佳
3.  更差的标准 C++ 支持

不要这样做。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-09T12:20:20.290

如果您想要一个带有良好调试器的快速、轻量级环境，Visual Studio 6 就很好。问题是它附带的 C++ 编译器，非常过时。作为一个快乐的 VC++ 6 用户多年后，我现在切换到[Code::Blocks](http://www.codeblocks.org/)，它为您提供了一个类似的 IDE，但允许您使用最新的 g++ 编译器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T12:19:49.137

我认为 Visual Studio 在 C++ 开发中失宠的主要原因是它的时代。从那时起，编译器也得到了显着改进。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T12:48:21.440

如果您相信 MS 炒作，[Visual Studio 2010](http://blogs.msdn.com/somasegar/archive/2008/11/21/c-enhancements-in-vs-2010.aspx)将大大增强 C++ 开发，并包括在以后的版本中丢失的大部分 Visual Studio 6 功能。我个人认为 Visual Studio 6 是一个非常高效的 C++ 开发工具，以至于我仍然在我的大部分开发中使用它，并在 VS2008 下进行最终编译和测试。我这样做的原因在前面的问题中[给出](https://stackoverflow.com/questions/147777/ms-vc-6-class-wizard)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T14:41:39.047

我在中学时在 MSVC++ 6 上自学了 C++。令我惊恐的是，我发现我现在的公司仍在使用它。我给我们带来了无尽的痛苦，主要是关于模板无法编译。我们得到了很大的内部编译器错误。哦，mutable 关键字似乎不起作用。还有大量的标准合规问题，其中一些非常严重，比如我最喜欢的：

```
for (int i = 0; i < 10; ++i)
{
     // do some stuff here
}

cout << i; // THIS COMPILES AND WORKS!  i is in the function scope, not the loop scope. 
```

前段时间，我在 MSVC++ 中发现了一个相当不错的错误和错误列表，试图说服我的老板离开……[这里是链接](http://www.medini.org/software/msviscxx/msviscxx.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T14:22:44.240

当前的 VS6 用户在这里。今年我们正在过渡，但我今天仍在使用它。

我非常同意我在这里看到的内容。糟透了。

我在这里看到暗示但没有明确说明的一件事是，STL 的一些更有趣的特性在 VS6 中几乎无法使用。据我所知，这主要是因为编译器在找出隐含的模板参数时遇到了很多麻烦。例如，std::algorithm 中的几乎所有内容要么完全不可用，要么需要大量显式实例化，以至于手工编写代码会更容易、更简洁。

Boost 可以对此有所帮助，但您也无法使用大量 Boost。:-(

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-31T19:57:11.003

好的，vs2005 及更高版本提供了符合标准的 c++ 和更好的 IDE（例如，我发现智能感知的错误少一些）。

也就是说，如果标准合规性不打扰您，您只开发托管代码并且您的项目非常面向 UI，您可能更喜欢 VC6（vs2008 上的类向导很糟糕）。

就个人而言，尽管类向导很差，但我仍然会选择后来的 IDE。更好的源代码控制集成、使用第三方插件等的好处仍然大于缺点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T12:22:39.553

不使用 Visual Studio 6 的另一个原因是许多开源库（例如 ACE 框架）不再支持它。此外，如果您使用 Visual Studio 6，您应该应用所有补丁，因为某些代码在没有这些补丁的情况下无法编译。模板支持不是很好。

作为结论：我建议使用现代/更新的 C++ 编译器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T12:24:29.237

主要原因：vc++ 6 对标准的支持很差。结果，该编译器无法编译某些库。当您决定使用其他编译器进行编译时，您的项目将会出现问题。

# c# - .NET Winforms：防止启用“AcceptButton”的表单上的多行文本框的按钮单击触发器？

> ID：625993
> 
> 赞同：7
> 
> 时间：2009-03-09T12:16:53.717
> 
> 标签：c#, .net, winforms, dialog

好吧，我的问题是这样的：我在表单上设置了 AcceptButton，这给了我很好的效果，它触发了按钮 Click 事件，但是如果我在 MultiLine 文本框上，我不希望这种情况发生。然后我只希望它在其中输入一个输入。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T12:19:13.320

将文本框的“AcceptsReturn”属性设置为 true。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T12:20:05.190

控件上有一个属性`TextBox`：

```
textbox1.AcceptsReturn = true; 
```

[MSDN 文档](https://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.acceptsreturn(v=vs.110).aspx)

# prism - 在 Prism（复合应用程序指南）中，如何将视图动态加载到 TabControl 中？

> ID：625994
> 
> 赞同：8
> 
> 时间：2009-03-09T12:17:03.980
> 
> 标签：prism, composite-application-gu

在 Prism v2 应用程序中，我定义了两个区域，每个区域都是 tabcontrol 中的一个 tabitem：

```
<UniformGrid Margin="10">
    <TabControl>
        <TabItem Header="First" Name="MainRegion" cal:RegionManager.RegionName="MainRegion"/>
        <TabItem Header="Second" Name="SecondRegion" cal:RegionManager.RegionName="SecondRegion"/>
    </TabControl>
</UniformGrid> 
```

在引导程序中加载了两个模块，每个模块都将一个视图注入到每个 tabitems 中：

```
protected override IModuleCatalog GetModuleCatalog()
{
    ModuleCatalog catalog = new ModuleCatalog();
    catalog.AddModule(typeof(SecondModule.SecondModule));
    catalog.AddModule(typeof(HelloWorldModule.HelloWorldModule));
    return catalog;
} 
```

现在，当然，我想执行我一直在阅读的解耦魔术并取消注释其中一个模块，并看到它的选项卡项根本没有出现。而是相反，还是有两个TabItem，一个是空的。这告诉我，我的应用程序仍然像以前糟糕的 WinForm 时代一样紧密耦合数据和 UI。

那么我需要在这里做什么才能使这个动态化，以便 UI 根据加载的模块动态更改，即我可以在我的引导程序中加载 10 个模块/视图，并且 TabControl 中会自动有 10 个 TabItems？

## 中间答案：

如果我只在 TabControl 中创建一个区域：

```
<TabControl Name="MainRegion" cal:RegionManager.RegionName="MainRegion"/> 
```

然后将两个控件加载到 MainRegion 中：

```
 public void Initialize()
        {
            regionManager.RegisterViewWithRegion("MainRegion", typeof(Views.SecondView));
        }
...
        public void Initialize()
        {
            regionManager.RegisterViewWithRegion("MainRegion", typeof(Views.HelloWorldView));
        } 
```

然后我得到一个带有两个选项卡的 TabControl，每个选项卡都有一个视图，这就是我想要的。

但未定义 TabItem 标头。如何动态定义标头（例如不在 XAML 中，而是在 View 类中动态定义）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-24T00:36:33.517

这也有效：

```
public class View : UserControl
{

    public string ViewName { get; set; }

} 
```

然后在外壳中：

```
<Window.Resources>        
       <Style TargetType="{x:Type TabItem}" x:Key="TabItemRegionStyle">
                <Setter Property="Header" Value="{Binding RelativeSource={RelativeSource Self}, Path=Content.ViewName}" />
       </Style>
</Window.Resources>
    ...
<TabControl cal:RegionManager.RegionName="RightRegion" Width="Auto" Height="Auto" HorizontalAlignment="Stretch" Grid.Column="2" 
                x:Name="RightRegion" ItemContainerStyle="{StaticResource TabItemRegionStyle}" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T13:39:13.400

好的。

您可以删除视图上的 ViwewName 属性并将 TabItem 值上的绑定更改为 Value="{Binding DataContext.HeaderInfo}" ... 其中 HeaderInfo 是您的 DataContext 对象的属性 - 即选项卡项的业务对象代表。这更优雅一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:46:56.927

您的修改走在了正确的轨道上。

我通常实现标题的方式是向区域添加一个对象而不是控件，并使用控件对其进行数据模板化。

该对象定义了一个属性（假设是 MyHeaderProperty），然后我使用 TabControl 上的 ItemContainerStyle 将其绑定到。

我不知道是否有办法在不使用那种技巧（中间对象和 DataTemplate）的情况下实现这一目标。

# web-services - 无法使用 Sharepoint Web 服务中的 GetListItems 获取列表的所有字段

> ID：625995
> 
> 赞同：4
> 
> 时间：2009-03-09T12:18:21.043
> 
> 标签：web-services, sharepoint, field

我想从列表中的每个元素中检索所有字段。我发现的唯一方法是创建一个包含每个字段的视图。但我不想创建一个新视图。我试过了，但似乎没有兑现。如果它有效，我可以使用 GetList 获取所有字段并基于此填充 ViewFields。

是否有视图可以覆盖 xml 请求中的默认视图？我当前的 XML 如下。

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:s0="http://schemas.microsoft.com/sharepoint/soap/" soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
  <soap:Body>
    <s0:GetListItems>
      <s0:listName xsi:type="s:string">{GUID}</s0:listName>
      <s0:QueryOptions>
        <s0:ViewAttributes Scope="Recursive"></s0:ViewAttributes>
        <s0:IncludeMandatoryColumns>TRUE</s0:IncludeMandatoryColumns>
      </s0:QueryOptions>
      <s0:Query></s0:Query>
      <s0:ViewFields>
        <s0:FieldRef xsi:type="s:string" Name="ID"></s0:FieldRef>
        <s0:FieldRef xsi:type="s:string" Name="CellPhone"></s0:FieldRef>
        <s0:FieldRef xsi:type="s:string" Name="FirstName"></s0:FieldRef>
      </s0:ViewFields>
    </s0:GetListItems>
  </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T20:44:11.517

我想到了。出于某种原因，您必须在正确的soap 命名空间中有一个viewFields 标记。在其中有一个 ViewFields 标签（大小写很重要）。

```
<s0:viewFields>
<ViewFields>
<s0:FieldRef ...>
</ViewFields>
</s0:viewFields> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T22:57:22.927

"For some reason"? An element is identified by the combination of local name *and* namespace. With a diffrerent namespace, it's a different element, even if it has the same local name.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:20:41.350

您的 ViewFields 应该包含您要返回的所有字段。您的查询应返回 CAML 查询。CAML 查询将确定过滤器和排序。

U2U CAML Query Builder 是一个帮助 ViewFields 和 CAML 查询的好工具。我目前无法找到适用于此的链接，因此您可能必须自己搜索一些链接或求助于其他人的 CAML 查询工具。

柯克**************