# StackOverflow 问答 000213000-000213999

# reporting-services - 从 Reporting Services 中的组总计计算总计

> ID：213002
> 
> 赞同：3
> 
> 时间：2008-10-17T17:11:30.783
> 
> 标签：reporting-services, ssrs-grouping

我有一些数据按特定标准分组在一个表中，并且对于每个组，它都计算了属于该组的每个详细信息行的值的平均值——嗯，实际情况有点棘手。该平均值显示在每组页脚行中。让我们看看这个简单的例子：

![报告表](https://farm4.static.flickr.com/3008/2958165686_088405e1ef_o.jpg)

**我现在想要的是在表格页脚上**显示总计。总计应通过*添加*每个组的平均值来计算（例如，在此示例中，总计应为 20 + 15 = 35）。但是，我不能嵌套聚合函数。我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T15:46:16.493

您只需要在表尾添加 SUM() 函数，这是两个组的外部范围，并将它们加在一起。如果你对一个条件求和，你可能还需要把它放在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T15:54:28.427

Reporting Services（2005 年，也可能是 2008 年）不直接支持聚合的聚合。

使用允许您自己聚合值的自定义报告程序集、代码引用和命名对象（报告属性、引用）。

您的代码可能如下所示：

```
Public Sub New()

    m_valueTable = New DataTable(tableName:="DoubleValueList")

    'Type reference to System.Double
    Dim doubleType = Type.GetType(typeName:="System.Double")

    ' Add a single Double column to hold values
    m_valueTable.Columns.Add(columnName:="Value", type:=doubleType)

    ' Add aggregation column
    m_sumColumn = m_valueTable.Columns.Add(columnName:="Sum", type:=doubleType, expression:="Sum(Value)")
End Sub
Public Function Aggregate(ByVal value As Double) As Double

    ' Appends a row using a 1-element object array. 
    ' If there will be more than 1 column, more values need to be supplied respectively.
    m_valueTable.Rows.Add(value)

    Aggregate = value
End Function
Public ReadOnly Property Sum() As Double
    Get

        If 0 = m_valueTable.Rows.Count Then
            Sum = 0
        Else
            Sum = CDbl(m_valueTable.Rows(0)(m_sumColumn))
        End If
    End Get
End Property 
```

您引用的名称，例如 DoubleAggregator。然后将组表达式替换为“Code.DoubleAggregator.Aggregate(Avg(Fields!Column2.Value))”，将 Total 的表达式替换为“Code.DoubleAggregator.Sum()”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T02:09:18.437

不幸的是，我目前不在我的报告开发框中，但它要么是：
=(sum(Fields!Column1 + sum(Fields!Column2))
要么
=SUM(sum(Fields!Column1) + sum(Fields!Column2))

我很确定这是2中的第一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-05T13:35:43.080

你不能，但你可以欺骗它。我在这里提出了一个解决方案：http: [//dataqueen.unlimitedviz.com/2011/05/ssrs-aggregate-last-ytd-or-last-child-value-in-an-ssas-query/](http://dataqueen.unlimitedviz.com/2011/05/ssrs-aggregate-last-ytd-or-last-child-value-in-an-ssas-query/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-18T05:01:58.757

您可以简单地执行以下操作： Sum(CInt(Fields!TestValue.Value)) 或 Sum(CInt(Fields!DollarAmountOfCheck.Value),"DataSet1") 有时当数据通过 WCF 时，它不接受 Sum() 函数. 但在这种情况下这很好用。

# video - 如何从我的家庭电影文件中获取原始捕获时间戳:: AVI 和 MPG4？

> ID：213015
> 
> 赞同：7
> 
> 时间：2008-10-17T17:15:42.977
> 
> 标签：video, codec, file-rename

我有超过 TB 的家庭电影文件名很糟糕。找到你想要的东西是不可能的。我想将所有文件重命名为它们最初记录的时间（而不是它们放在我电脑上的文件时间）。一些应用程序（如 Ulead Video Studio）可以访问此信息，我相信这些信息嵌入在 CODEC 中。

我很想知道如何编写一个 .Net 应用程序来提取此信息以重命名我的文件，以便我可以轻松地组织它们或找到一个可以为我执行此操作的应用程序。非常感谢您。

附加信息:: 家庭电影是在 miniDV 和 DVD 摄像机上拍摄的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-05-18T20:23:57.727

这是一个基于 mplayer 的 hacky howto，它至少适用于我的相机生成的 MOV 文件：

```
mplayer -vo null -ao null -frames 0 -identify myfile.MOV 2>/dev/null|grep creation_time: 
```

我用它来批量重命名它们：

```
for m in MVI*.MOV; do
    t=$(mplayer -vo null -ao null -frames 0 -identify $m 2>/dev/null|grep creation_time:|sed 's/.*creation_time: *//;s/[-:]//g;s/ /-/')
    mv ${m} ${t}_${m}
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-29T13:00:05.660

我不能谈论 DVD，但[数字视频 (DV)](http://en.wikipedia.org/wiki/DV)编解码器确实会在每一帧上存储时间和日期（在相机中设置）！

对于 Linux，像`dvgrab`处理这些时间戳这样的程序，对于 Windows，我相信一个名为 dvdate.exe 的工具可以做到。

DV 视频可以存储在 AVI 容器 (.avi)、原始 (.dv 或 .dif) 和 QuickTime (.mov) 中。但并非所有 AVI 都是 DV。60分钟的DV视频大约是13GB。– 如果您的文件较小，它们可能已经转换为其他编解码器并且时间戳会丢失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T00:56:27.117

除非原始捕获使用绝对时间戳，否则您很有可能不走运。根据我的经验，大多数捕获应用程序在第一帧使用时间 0，而不是通用时间。要检查这一点，请获取[GraphStudio](http://blog.monogram.sk/janos/tools/monogram-graphstudio/)，在其中加载文件，然后在属性中查看第一个输出引脚的开始时间。

您可能会考虑使用[GSpot](http://www.headbands.com/gspot/) 来查看您要查找的元数据是否甚至存在于文件中。对于您的 AVI 文件，您还可以在其十六进制编辑器中查看[VirtualDub](http://virtualdub.org)的 RIFF 功能。除非您的捕获应用程序对您很好，否则可能永远不会记录该数据。

假设原始时间戳以某种方式可用，我建议查看帮助您找到它的任何应用程序的来源。

对于我的视频，我已经开始在捕获时获取元数据，将其存储在 XML 文件中，并让我的转码/后处理应用程序将最后修改的时间戳固定为原始时间戳。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T17:27:21.157

这是我不久前发现的一些代码，可以帮助您入门。

[http://www.developerfusion.com/code/3435/a-convenient-wrapper-class-to-get-file-info/](http://www.developerfusion.com/code/3435/a-convenient-wrapper-class-to-get-file-info/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-18T01:01:34.297

你应该看看 exiftool。它是一个非 GUI 实用程序，可让您访问许多媒体文件元数据中的此类信息

[http://www.sno.phy.queensu.ca/~phil/exiftool/#supported](http://www.sno.phy.queensu.ca/~phil/exiftool/#supported)

您可能可以提取 exiftool 输出来制作一个漂亮的 GUI，以便以您想要的任何语言重命名。我有我自己的 python 脚本。

# c++ - 简单的 C++ 函数——这段代码“好”吗？

> ID：213027
> 
> 赞同：6
> 
> 时间：2008-10-17T17:20:00.563
> 
> 标签：c++

以下代码是由为我的团队工作的顾问生成的。我不是 C++ 开发人员（尽管使用过多种语言），但我想对以下代码发表一些独立的意见。这是在 Visual Studio C++ 6.0 中。我有一个直觉反应（显然不是一个好的反应），但我想要一些经验丰富（甚至不是那么不成熟）C++ 开发人员的“直觉反应”。提前致谢！

```
// Example call
strColHeader = insert_escape(strColHeader, ',', '\\'); //Get rid of the commas and make it an escape character 
```

……剪……

```
CString insert_escape ( CString originalString, char charFind, char charInsert ) {
    bool continueLoop = true;   
    int currentInd   = 0;

    do {
        int occurenceInd = originalString.Find(charFind, currentInd);

        if(occurenceInd>0) {
            originalString.Insert(occurenceInd, charInsert);
            currentInd = occurenceInd + 2; 
        }
        else {
            continueLoop = false;   
        }
    } while(continueLoop);
    return(originalString);
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-17T17:24:11.837

唔。我认为

```
CString strColHeader;
strColHeader.Replace(",", "\\,") 
```

也会这样做。

我不喜欢代码，我倾向于从 while 循环中中断，而不是使用不必要的 bool 'continue' 标志。`while (occurenceInd != 0)`当他可以将其用作循环控制变量而不是布尔值时，这会翻倍。

增加计数器还依赖于“+2”，这似乎无法立即理解（不是一眼就能理解），最后（也是最重要的）他似乎没有发表评论。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-17T18:51:50.240

中间有一个错误：看看如果第一个字符是逗号会发生什么：“，abc，def，ghi”：我假设所需的输出是“\， abc\,def\,ghi"，但你得到的是原始字符串：

```
int occurenceInd = originalString.Find(charFind, currentInd); 
```

OccurrenceInd 返回 0，因为它在第一个字符处找到了 charFind。

```
if(occurenceInd>0) 
```

0 不大于 0，所以取 else 分支并返回原始字符串。 [CString::Find](http://msdn.microsoft.com/en-us/library/aa314323(VS.60).aspx)在找不到东西时返回 -1，所以至少比较应该是：

```
if(occurrenceInd >= 0) 
```

最好的方法是使用 Replace 函数，但如果您想手动完成，更好的实现可能如下所示：

```
CString insert_escape ( const CString &originalString, char charFind, char charInsert ) {
    std::string escaped;
    // Reserve enough space for each character to be escaped
    escaped.reserve(originalString.GetLength() * 2); 
    for (int iOriginal = 0; iOriginal < originalString.GetLength(); ++iOriginal) {
        if (originalString[iOriginal] == charFind)
            escaped += charInsert;
        escaped += originalString[iOriginal];
    }
    return CString(escaped.c_str());
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T20:06:38.857

错误已经提到过。但是它们让我印象深刻，因为任何人都可能会遇到未经适当测试的快速冲破代码，特别是如果他们不熟悉 CString。

我会更担心文体方面的事情，因为它们暗示了对 C++ 不满意的人。bool continueLoop 的使用只是普通的糟糕 C++。它代表了函数代码的三分之一，可以通过使用简单的 if...break 构造来消除，从而使代码在此过程中更易于遵循。

此外，变量名称“originalString”非常具有误导性。因为它们是按值传递的，所以它不是原始字符串，而是它的副本！然后他们无论如何都会修改字符串，因此它不再是与原始对象相同的对象或相同的文本字符串。这种双重谎言暗示了混乱的思维模式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T19:24:22.560

我的直觉反应是：**WTF**。最初是通过代码的格式化方式（有很多我不喜欢格式化的地方），然后通过检查代码实际在做什么。

这位开发人员对 C++ 中的对象复制的理解存在严重问题。这个例子本身就是一个 WTF（如果函数的开发者真的像这样使用他/她自己的函数）：

```
// Example call
strColHeader = insert_escape(strColHeader, ',', '\\'); //Get rid of the commas and make it an escape character

CString insert_escape ( CString originalString, char charFind, char charInsert ) 
```

1.  传递as的**副本**（注意没有）`strColHeader``originalString``&`
2.  函数修改了这个副本（很好）
3.  该函数返回**副本**的副本，该副本又**替换**原始`strColHeader`. 编译器可能会将其优化为单个副本，但仍然像这样传递对象副本不适用于 C++。人们应该知道参考。

经验丰富的开发人员会将此功能设计为：

```
void insert_escape(CString &originalString, char charFind, char charInsert) 
```

或者：

```
CString insert_escape(const CString &originalString, char charFind, char charInsert) 
```

（并且可能会以不同的方式命名参数）

正如许多人所指出的那样，开发人员本可以做的明智的事情是检查 API 文档以查看是否`CString`已经有`Replace`方法......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T17:23:37.640

CString 有一个 Replace() 方法...（这是我的第一反应）

我见过很多糟糕的代码，而且比这更糟糕。但是，当没有明显的充分理由不使用内置功能时，不使用内置功能是……很差。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-19T23:36:45.093

我不会提供替代代码，因为它只会添加到已经提供的代码中。

但是，我的直觉是代码有问题。

为了证明这一点，我将列举原始函数中的一些要点，表明其开发人员不是经验丰富的 C++ 开发人员，如果您需要一个干净的实现，您应该调查这些要点：

*   **复制**：参数作为复制而不是 const-reference 传递。在考虑对象时，这在 C++ 中是一个很大的 NO NO。
*   **错误**我猜“if(occurenceInd>0)”部分有错误。通过阅读 MSDN 上 CString 的文档，CString::Find 方法在查找失败时返回 -1，而不是 0。这段代码告诉我如果逗号是第一个字符，它不会被转义，这可能不是函数的重点
*   **不需要的变量**：不需要“continueLoop”。将代码“continueLoop = false”替换为“continue”，将“while(continueLoop)”行替换为“while(true)”就足够了。请注意，继续此推理使编码器能够更改内部功能（将 do...while 替换为简单的 while）
*   **更改返回类型**：可能会选择细节，但我会提供一个替代函数，它不会返回结果字符串，而是接受作为参考（返回时少一个副本），原始函数被内联并调用替代。
*   **尽可能**再次添加 const，仔细挑选：两个“char”参数应该是 const，如果只是为了避免意外修改它们。
*   **可能的多次重新分配**该函数依赖于 CString 数据的潜在多次重新分配。Josh 使用 std::string 的储备的解决方案是一个很好的解决方案。
*   **使用完全 CString API**：但与 Josh 不同，因为您似乎使用 CString，我会避免使用 std::string 并使用 CString::GetBufferSetLength 和 CString::ReleaseBuffer，这使我能够拥有相同的代码，而对象分配更少.
*   **神秘的插入方法？**是我，或者没有 CString::Insert ??? （参见[http://msdn.microsoft.com/en-us/library/aa252634(VS.60).aspx](http://msdn.microsoft.com/en-us/library/aa252634(VS.60).aspx)）。事实上，我什至没能在 Visual C++ 2008 和 2005 的同一个 MSDN 中找到 CString ......这可能是因为我*真的*应该去睡觉了，但我想这仍然值得研究

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T18:21:07.087

如果您想要评估这位开发人员的 C++ 技能水平，我想说这表明了中级的低端。

该代码完成了工作，并且不包含任何明显的“咆哮”，但正如其他人所写的那样，有更好的方法来做到这一点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-02T02:20:01.207

这个顾问是按代码行支付的吗？有几个人指出`CString`该类已经提供了这个功能，所以即使你不是程序员，你也知道：

*   该功能是不必要的。它增加了程序的复杂性、大小和可能的执行时间。
*   该`CString`功能可能有效并且可能有效；这个可能是也可能不是。
*   该`CString`功能已记录在案，因此是可支持的。
*   顾问要么不熟悉标准`CString`函数，要么认为他/她可以通过编写一个新函数来做得更好。
    *   人们可能会得出这样的结论：顾问不熟悉其他标准功能和最佳实践。
    *   选择为基本功能编写新代码而不考虑可能存在标准版本是一种公认​​的坏习惯。

也许是最大的、最危险的标志：你的直觉促使你从 StackOverflow 社区获得意见。

相信你的直觉。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T18:17:34.193

> 这是在 Visual Studio C++ 6.0 中。

肠道反应：*漂白*。严重地！众所周知，VC++ 6 附带的 C++ 编译器存在缺陷，而且性能通常很差，而且已经使用了 10 年。

@Downvoters：考虑一下！我是认真的。VC6只是比较低效，*不应该再使用了*！特别是因为微软停止了对该软件的支持。在某些情况下，这是无法避免的，但很少见。在大多数情况下，代码库的升级可以节省资金。VC++ 6 只是不允许利用 C++ 的潜力，这在客观上是一个劣质工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-17T18:18:47.920

看起来人们已经为您解决了此代码的一些功能方面，但我建议您远离您在这里使用的变量命名。

除了 UI 控件，通常不赞成使用匈牙利符号。这对数字更重要......例如：

我声明：

浮动 fMyNumber = 0.00;

然后我在整个应用程序中使用它。但是后来，我将其更改为双精度，因为我意识到我需要更高的精度。我现在有：

双倍 fMyNumber = 0.00;

的确，大多数优秀的重构工具都可以为您解决这个问题，但最好不要附加这些前缀。它们在某些语言中比其他语言更常见，但从一般风格的角度来看，您应该尽量避免使用它们。除非您使用记事本，否则您可能拥有类似于 Intellisense 的东西，因此您实际上不需要查看变量名称来确定它是什么类型。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T17:37:16.473

看起来不错，如果有一点，我不知道，hack。最好使用该库，但我不会去重写这个例程。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-17T18:20:33.720

总是有更好的实现。如果您使用该功能作为顾问不是很好的示例，您可能还需要考虑，虽然他们不知道已经存在的功能，但他们可能对项目建设有经验和理解。

软件开发不仅仅关乎功能的完美，还关乎整个事物的架构有多好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-17T18:46:25.087

当我看到 do .. while 循环时，我总是担心；IMO 他们总是更难理解。

# delphi - 为什么谷歌不索引页面上的一些词？

> ID：213033
> 
> 赞同：2
> 
> 时间：2008-10-17T17:20:34.557
> 
> 标签：delphi, api, search

我在 Delphi 中创建了一个程序，它使用 Google 的 AJAX 搜索 API 来评估特定网站上的搜索短语出现，包括我的网站。令我惊讶的是，谷歌似乎没有为我的页面上的某些词编制索引，或者我通过 API 错误地形成了我的搜索查询。例如搜索

site:www.delphi.org -“delphi编程”，通过API使用搜索字符串*site%3Awww.delphi.org+-“delphi+programming”*

MarkDown 不喜欢我嵌入这些链接：

> [http://www.google.com/search?&q=site%3Awww.delphi.org+-](http://www.google.com/search?&q=site%3Awww.delphi.org+-) "delphi+programming"

清楚地表明所有返回的页面在标题或正文中都有短语“Delphi Programming”。

它是一个不同的集合，然后由搜索返回

site:www.delphi.org +"delphi programming"通过API使用搜索字符串*site%3Awww.delphi.org+%2B"delphi+programming"*

MarkDown 不喜欢我嵌入这些链接：

> [http://www.google.com/search?&q=site%3Awww.delphi.org+%2B](http://www.google.com/search?&q=site%3Awww.delphi.org+%2B) "delphi+programming"

也许问题出在WordPress中。它是否以不同的方式查看页面？我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T19:31:16.180

不知道如何使用 API，但如果你用你的 2 个句子做一个简单的谷歌搜索，你会得到比使用 [site:www.delphi.org +"delphi programming"] 更多的点击 (97)。 delphi.org -"delphi programming"] 只得到 75。
后者，**使用 - 符号应该返回没有上下文中这些词的命中**（根据谷歌搜索帮助）。似乎在这种情况下，它会返回页面中没有“Delphi Programming”的所有页面（除了在标题中，因为它无法避免它）。而且在结果页面中，“Delphi 编程”也没有突出显示。在前面的“+”号搜索中，所有出现的“Delphi Programming”在结果页面中都以粗体显示。
所以我猜 [site:www.delphi.org -“delphi 编程”] 作为搜索有点矛盾......;-)

# c - 你如何在C中进行幂运算？

> ID：213042
> 
> 赞同：64
> 
> 时间：2008-10-17T17:24:23.613
> 
> 标签：c

我试过“x = y ** e”，但没用。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-17T17:25:23.533

使用该`pow`功能（尽管需要`float`s/ `double`s）。

`man pow`：

```
 #include <math.h>

   double pow(double x, double y);
   float powf(float x, float y);
   long double powl(long double x, long double y); 
```

**编辑**：对于 的正整数幂的特殊情况`2`，您可以使用位移：`(1 << x)`将等于`2`幂`x`。这有一些潜在的问题，但一般来说，这是正确的。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-10-17T17:29:54.727

补充一下[Evan](https://stackoverflow.com/questions/213042/how-do-you-do-exponentiation-in-c#213043)所说的：C 没有内置的求幂运算符，因为它不是大多数 CPU 的原始运算。因此，它被实现为库函数。

此外，为了计算函数 e^x，您可以使用`exp(double)`、`expf(float)`和`expl(long double)`函数。

请注意，您**不想**使用`^`运算符，它是*按位异或*运算符。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-17T18:35:11.833

`pow`仅适用于浮点数（`double`实际上是 s）。如果你想取整数的幂，并且底数不知道是 的指数`2`，你必须自己滚动。

通常愚蠢的方式就足够了。

```
int power(int base, unsigned int exp) {
    int i, result = 1;
    for (i = 0; i < exp; i++)
        result *= base;
    return result;
 } 
```

这是一个递归解决方案，它需要`O(log n)`空间和时间而不是简单的`O(1)`空间`O(n)`时间：

```
int power(int base, int exp) {
    if (exp == 0)
        return 1;
    else if (exp % 2)
        return base * power(base, exp - 1);
    else {
        int temp = power(base, exp / 2);
        return temp * temp;
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-19T02:04:36.683

与较早的答案类似，这将很好地处理 double 的正负整数幂。

```
double intpow(double a, int b)
{
  double r = 1.0;
  if (b < 0)
  {
    a = 1.0 / a;
    b = -b;
  }
  while (b)
  {
    if (b & 1)
      r *= a;
    a *= a;
    b >>= 1;
  }
  return r;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-17T21:19:45.930

该函数的非递归版本并不太难 - 这里是整数：

```
long powi(long x, unsigned n)
{
    long p = x;
    long r = 1;

    while (n > 0)
    {
        if (n % 2 == 1)
            r *= p;
        p *= p;
        n /= 2;
    }

    return(r);
} 
```

（例如，将双精度值提高到整数幂的代码被破解 - 必须删除处理倒数的代码。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T18:21:28.833

或者你可以只写幂函数，递归作为额外的奖励

```
int power(int x, int y){
      if(y == 0)
        return 1;
     return (x * power(x,y-1) );
    } 
```

是的，是的，我知道这是不太有效的空间和时间复杂度，但递归更有趣！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-01-09T20:30:28.217

```
int power(int x,int y){
 int r=1;
 do{
  r*=r;
  if(y%2)
   r*=x;
 }while(y>>=1);
 return r;
}; 
```

（迭代）

```
int power(int x,int y){
 return y?(y%2?x:1)*power(x*x,y>>1):1;
}; 
```

（如果它必须是递归的）

imo，算法绝对应该是 O(logn)

# c# - 如何在 VB 代码中调用 C# 扩展方法

> ID：213045
> 
> 赞同：10
> 
> 时间：2008-10-17T17:25:32.723
> 
> 标签：c#, vb.net, extension-methods, class-library

我有一个类库，其中包含一些用 C# 编写的扩展方法和一个用 VB 编写的旧网站。

我想从 VB 代码中调用我的扩展方法，但它们没有出现在 intelisense 中，并且当我访问该站点时出现编译错误。

我已经获得了所有必需的*Import*，因为相同命名空间中包含的其他类在 Intelisense 中看起来很好。

有什么建议么

**编辑：**更多信息以帮助发表一些评论。

我的实现看起来像这样

```
//C# code compiled as DLL
namespace x.y {
    public static class z {
        public static string q (this string s){
             return s + " " + s;
        }

    }
} 
```

和我这样的用法

```
Imports x.y

'...'
Dim r as string = "greg"
Dim s as string = r.q() ' does not show in intelisense
                        ' and throws error : Compiler Error Message: BC30203: Identifier expected. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T19:03:28.267

它对我有用，尽管有一些怪癖。首先，我创建了一个面向 .NET 3.5 的 C# 类库。这是项目中唯一的代码：

```
using System;

namespace ExtensionLibrary
{
  public static class Extensions
  {
    public static string CustomExtension(this string text)
    {
      char[] chars = text.ToCharArray();
      Array.Reverse(chars);
      return new string(chars);
    }
  }
} 
```

然后我创建了一个面向 .NET 3.5 的 VB 控制台应用程序，并添加了对我的 C# 项目的引用。我将 Module1.vb 重命名为 Test.vb，代码如下：

```
Imports ExtensionLibrary

Module Test

    Sub Main()
        Console.WriteLine("Hello".CustomExtension())
    End Sub

End Module 
```

这将编译并运行。（我会调用方法 Reverse() 但我不确定 VB 是否已经在某个地方神奇地具有反向能力 - 我不是 VB 专家。）

最初，我没有提供 ExtensionLibrary 作为 Intellisense 的导入。即使在构建之后，“Imports ExtensionLibrary”也是灰色的，并且灯泡提供了删除所谓冗余导入的机会。（这样做会破坏项目。）请注意，这可能是 ReSharper 而不是 Visual Studio。

所以长话短说，它是可以做到的，它应该工作得很好。我不认为问题在于您使用的是旧版本的 VB，或者您的项目不是针对 .NET 3.5？

如评论中所述：还有一个额外的怪癖，即[当目标的编译时类型为`Object`](https://stackoverflow.com/questions/3227888).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:30:38.733

扩展方法只是静态方法的语法糖。所以

```
public static string MyExtMethod(this string s) 
```

可以在 VB.NET 和 C# 中调用

```
MyExtMethod("myArgument") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T18:46:19.453

好的。根据错误消息，您肯定*没有*使用最新的 VB 版本（VB 9！），或者该错误根本与此问题无关，因为如果找不到该方法，您将收到另一个错误：

> 错误 1 ​​'q' 不是 'String' 的成员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T18:40:25.240

```
Imports x.y

'...'
Dim r As String = "greg"
Dim s As String = r.q() 'same as z.q(r) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-31T08:08:38.663

我想我[遇到过类似的问题](https://stackoverflow.com/questions/10829615)：VB.Net 很乐意通过扩展方法进行编译，如果`Option Strict`关闭，则让它们在运行时进行推断。

然而，VB.Net 似乎真的不喜欢基本类型的扩展方法。如果您这样做，您将无法扩展`Object`，也无法解决它：

C＃

```
namespace NS
...

public static class Utility {

    public static void Something(this object input) { ...

    public static void Something(this string input) { ...

}

// Works fine, resolves to 2nd method
"test".Something();

// At compile time C# converts the above to:
Utility.Something("test"); 
```

然而这在 VB.Net 中出错了：

```
Option Infer On
Option Explicit On
Option Strict Off
Imports NS
...

    Dim r as String = "test" 
    r.Something() 
```

编译没有错误，但在运行时失败，因为`Something`它不是一种方法`String`- 编译器未能用静态调用替换扩展方法的语法糖`Utility.Something`。

问题是为什么？与 C# 不同，*VB.Net 无法处理对`Object`*!的任何扩展。C# 中的有效扩展方法使 VB.Net 编译器感到困惑。

作为一般的 VB.Net 规则，我会避免将扩展方法与任何基本的 .Net 类型（`Object`、`String`、`Integer`等）一起使用。您还必须小心，`Option Infer`因为它在 Visual Studio 中默认打开，在命令行编译时默认关闭`VBCodeProvider`，并且可能在网站中（取决于您的 web.config）。当它关闭时，VB.Net 中的所有内容都被认为是一个`Object`，并且所有扩展方法都将保留到运行时（因此会失败）。

我认为微软在向 VB.Net 添加扩展方法时真的丢了球，我认为尝试（并失败）使其与 C# 一致是事后的想法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T17:31:37.030

我不知道您是否可以像在 C# 中那样以点表示法调用它们，但我认为静态扩展方法将显示为静态函数，第一个参数作为扩展类型。所以你应该能够在 VB 中调用实际的类：

```
StaticClass.ExtensionMethod(theString, arg1, ..., argN) 
```

您刚刚在 C# 中的哪个位置编写：

```
theString.ExtensionMethod(arg1, ..., argN); 
```

StaticClass 是您在其中定义扩展方法的静态类的名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T18:33:14.847

> …还有一个用 VB 编写的旧网站。

这里的“旧”是否意味着您在这里也使用旧版本的 VB？无论如何，由于扩展方法只是用属性修饰的普通静态（“<code>Shared”）方法，因此您*应该*能够在任何情况下调用它们。

如果这不可能，您要么尝试在旧版本的 VB 中将它们称为“扩展样式”，要么您引用了错误版本的 C# 程序集。

编辑：你确定你是`Import`在*整个*命名空间，`x.y`而不是只是`x`？VB 能够比 C# 更容易地访问嵌套的命名空间，因此您可以使用`x.y`VB 中的以下代码来使用命名空间中的类。但是，要使扩展方法起作用，必须编辑*完整路径。*`Import`

```
Imports x
Dim x As New y.SomeClass() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T19:21:19.383

要检查的两件事：

1.  您的目标是 .Net 3.5
2.  您正在引用 DLL

某些工具可能会错误地为不支持它们的项目建议扩展方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-18T14:39:05.110

我遇到了同样的问题，可能不小心偶然发现了解决方案。如果我用

```
x.y.r.q() 
```

，它也给我带来了同样的错误。但是如果我导入 xy，它就起作用了，所以：

```
using x.y;
...
r.q() 
```

很好。

所以显然你必须在声明中导入它才能使其工作。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-07T15:42:13.793

这是很久以前的事了，我真的不知道如何解决它，但不用说，这是用户错误。我可能重新启动了我的计算机，然后它就消失了。

# tfs - 有没有办法使 TFS 可链接？

> ID：213068
> 
> 赞同：12
> 
> 时间：2008-10-17T17:31:12.350
> 
> 标签：tfs

我是 TFS 的忠实粉丝，但不幸的是，他们似乎忽略了任何链接到单个项目的方法（无论是工作项目、文档还是版本控制下的文件）。 [这篇博客文章](http://blogs.msdn.com/buckh/archive/2007/11/30/team-system-web-access-2008-power-tool-is-now-available.aspx)讨论了使用 TSWA Power Tools 直接链接到事物（这对于构建链接通知电子邮件很有用），但这还不够，因为我需要*任何*用户都能够轻松复制/粘贴链接以发送给其他人. 除了 TSWA 之外，还有其他提供良好链接能力的前端吗？

您如何“获取” Team Foundation Server 上的内容，无论是需要审查的文档、需要输入的工作项，还是使用 TFS 进行源代码控制的文件？当然，每个人都不会传递 5-6 位数的 ID 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-28T07:39:22.720

我们目前使用 Team System Web Access (TSWA)、Visual Studio 2008 Team System (VS2008) 和 sharepoint 项目门户来访问我们的工作项、代码、报告等。通常，开发人员主要使用 VS2008，而测试人员、业务分析师、项目经理、企业主等使用 TSWA。

当您说您需要“任何用户都能够轻松复制/粘贴链接以发送给其他人”时，我通常会说这在 TSWA 中更容易做到。TSWA 是免费的，不需要安装客户端。您只需为每个用户支付 TFS 客户端许可证。

话虽如此，您可以通过执行以下操作使用 Visual Studio 获取工作项的 URL：

1）在 VS.Net 中打开工作项（我使用的是 VS.Net 2008）

2) 该错误在 VS.Net 工作区的新选项卡中打开。右键单击选项卡名称。

3) 单击“复制完整路径”。

4) 结果是一个如下所示的 URL：

```
 http://teamfoundation:8080/WorkItemTracking/WorkItem.aspx?artifactMoniker=9999 
```

您还可以在构建中使用“复制完整路径”，其 URL 如下所示：

```
 http://teamfoundation:8080/Build/Build.aspx?artifactMoniker=9999 
```

有趣的是，团队查询有一个“复制完整路径”联系菜单，但它给我的 URL 不起作用。我不知道这是否只是我们的 TFS 实例的设置问题。

您可以获得变更集的 URL。您无法使用“复制完整路径”上下文菜单，因为您无法在其自己的选项卡中打开变更集。我通过按照上述说明打开工作项 URL 并单击关联的变更集来找到此 URL。网址如下所示：

```
 http://teamfoundation:8080/VersionControl/Changeset.aspx?artifactMoniker=97418 
```

我不知道对版本控制下的文件执行此操作的方法。您可以直接链接到报告和文档的门户。

# vb.net - VB代码合并两个文件，一切似乎都很好，为什么它不起作用？

> ID：213078
> 
> 赞同：0
> 
> 时间：2008-10-17T17:33:34.953
> 
> 标签：vb.net, binders

好吧，所以我本质上是在尝试编写一些将在 VB 中将两个文件组合在一起并输出一个文件的东西，该文件在运行时会同时运行它们。我已经从网上的几个地方获取了这个来源，我只是想让它发挥作用。我们有将它们与 GUI 结合起来的主程序

```
Const FileSplit = "@<>#<>#<>@"

Private Sub cmdAdd_Click()
    With Dlg
        .Filter = "All Files(*.*) | *.*"
        .DialogTitle = "Please Select a File..."
        .ShowOpen
    End With

    lsFiles.AddItem (Dlg.FileName)

End Sub

Private Sub cmdBuild_Click()

Dim sStub As String, sFiles As String, i As Integer
Open App.Path & "\stub.exe" For Binary As #1
sStub = Space(LOF(1))

Get #1, , sStub
Close #1

Open App.Path & "\boundfile.exe" For Binary As #1
Put #1, , sStub & FileSplit
For i = 0 To lsFiles.ListCount - 1

Open lsFiles.List(i) For Binary As #2
sFiles = Space(LOF(2))
Get #2, , sFiles
Close #2

Put #1, , sFiles & FileSplit

Next i

Close #1

MsgBox "Files Successfully Combined"

End Sub 
```

然后我们有第二个应用程序充当存根

```
Const FileSplit = "@<>#<>#<>@"
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long

Private Sub Form_Load()
Dim sStub As String, sFiles() As String, i As Integer

Open App.Path & "\" & App.EXEName & ".exe" For Binary As #1
sStub = Input(LOF(1), 1)
Get #1, , stub
Close #1

sFiles = Split(sStub, FileSplit)
For i = 1 To UBound(sFiles())
Open Environ("tmp") & "\tmp" & i & ".exe" For Binary As #1
Put #1, , sFiles(i)
Close #1
Call ShellExecute(0, vbNullString, Environ("tmp") & "\tmp" & i & ".exe", vbNullString, vbNullString, vbNormalFocus)

 Next i 
 End
End Sub 
```

但是，当文件合并并运行时，我得到的只是一个 dosbox 打开和关闭。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T23:09:55.537

一个主要问题是您使用的字符串变量在第一个空字符（ASCII 代码 0）处终止

由于可执行文件是二进制文件，因此它们极有可能没有被完整地复制到文件中（或复制出）。

因此，我建议将文件读入 Byte 数组并使用仅产生可打印字符的算法（例如 Base64）对它们进行编码。或者，您可以设计一些搜索字节数组的方案以找到 EOF 分隔符。

我要收藏这个项目，因为这似乎是在可执行文件中嵌入文件的一种有趣方式的开始。通过足够的编码，您还可以嵌入原始文件名和扩展名，并指定扩展后要执行的行为。加上一些压缩，你就有了一个非常漂亮的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T23:23:41.907

当使用 Open...As Binary 和 Put 时，一些关于字符串的数据被添加到输出中，把事情搞砸了。而是使用 Open...For 输出和打印。并以分号结束打印行，以免换行。此外，您的存根有点奇怪，更改了我上面提到的内容以及代码中的内容，如下所示：

```
Const FileSplit = "@<>#<>#<>@"

Private Sub cmdAdd_Click()
    With Dlg
        .Filter = "All Files(*.*) | *.*"
        .DialogTitle = "Please Select a File..."
        .ShowOpen
    End With
    lsFiles.AddItem (Dlg.FileName)
End Sub

Private Sub cmdBuild_Click()
    Dim sStub As String, sFiles As String, i As Integer
    Open App.Path & "\stub.exe" For Binary As #1
    sStub = Space(LOF(1))
    Get #1, , sStub
    Close #1
    Open App.Path & "\boundfile.exe" For Output As #1
    Print #1, sStub & FileSplit;
    For i = 0 To lsFiles.ListCount - 1
        Open lsFiles.List(i) For Binary As #2
        sFiles = Space(LOF(2))
        Get #2, , sFiles
        Close #2
        Print #1, sFiles & FileSplit;
    Next i
    Close #1
    MsgBox "Files Successfully Combined"
End Sub 
```

和

```
Const FileSplit = "@<>#<>#<>@"
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long

Private Sub Form_Load()
    Dim sStub As String, sFiles() As String, i As Integer
    Open App.Path & "\" & App.EXEName & ".exe" For Binary As #1
    sStub = Space(LOF(1))
    Get #1, , sStub
    Close #1
    sFiles = Split(sStub, FileSplit)
    For i = 1 To UBound(sFiles())
        Open Environ("tmp") & "\tmp" & i & ".exe" For Output As #1
        Print #1, sFiles(i);
        Close #1
        Call ShellExecute(0, vbNullString, Environ("tmp") & "\tmp" & i & ".exe", vbNullString, vbNullString, vbNormalFocus)
    Next i 
    End
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:15:30.857

我将从比较临时文件开始，您是否成功地重写了与源文件完全匹配的文件？

# delphi - IntraWeb 的 SSL 问题 - Delphi 2007

> ID：213084
> 
> 赞同：4
> 
> 时间：2008-10-17T17:35:17.197
> 
> 标签：delphi, ssl, delphi-2007, intraweb

最近一段时间，我一直在尝试使用 SSL 在我的 IW 程序上工作，并且一直遇到“无法加载 SSL 库”。我已经听从了我能找到的关于这个主题的每一条建议，但仍然没有快乐。我已经在本地目录和 system32 中尝试了建议的 DLL。

有人对我应该使用什么 OpenSSL DLL 有明确的答案吗？它们的构造是什么？还是有其他想法？

Indy：昨天更新到最新快照 IntraWeb：已安装股票 D2007

这是在 Vista 机器上运行的，如果这有什么不同的话。

TIA,

特雷弗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T22:40:00.387

**解决了：**

看起来问题是我的机器上漂浮的 bpl。

以下是我采取的步骤，以防其他人难以让独立服务器与 D2007 和预安装的库一起运行：

1.  从您的机器中删除所有 Indy 痕迹 - Indy 网站上的某处有一个操作指南；
2.  从 subversion 存储库下载 Indy 10 主干
3.  按照说明安装 Indy；
4.  从 atozed 下载最新的 IW9 - 您需要一个密钥；
5.  安装它——让它破坏你当前的安装；

现在，对于 OpenSSL DLL：

6.  从这里获取它们：[http ://www.slproweb.com/download/Win32OpenSSL_Light-0_9_8i.exe](http://www.slproweb.com/download/Win32OpenSSL_Light-0_9_8i.exe)
    *   这些对我来说效果很好；
7.  确保您的防火墙允许端口 443 通过（或您选择的任何内容）；

此时，我能够编译并运行演示和我的应用程序。

感谢所有的帮助。

特雷弗

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T05:34:52.593

您需要 OpenSSL dll（0.9.8i 为我工作，但我没有使用 Vista），您可以[在此处](http://www.slproweb.com/products/Win32OpenSSL.html)下载（正如我认为您所建议的那样，Indy dll 不适用于 IW9，这是该版本与 D2007 捆绑在一起）。

安装后，将 ssleay32.dll 和 libeay32.dll 从 system32 复制到您的应用程序目录。

如果它仍然不起作用：

*   您的服务器控制器的 ssl 端口是否设置为 443？
*   您的证书密码是否与您的服务器控制器的 ssl 证书密码匹配？
*   servercontroller.sslversion 是否设置为 sslv23？
*   您是否尝试过为 SSL（独立）编译/运行 AtoZed 演示应用程序？

希望这可以帮助。

编辑：一旦你得到这个工作，你会想要将 sslversion 更改为 sslv3，并让用户关闭 v2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T04:02:05.587

在今天对 Embarcadero 新闻组内部论坛上的同一问题的回应中，Chad Z.“Kudzu”Hower 发布了[这个链接](http://www.atozed.com/intraweb/download/files/ssl.en.aspx)（没有任何解释 - 只是链接）。

该页面提供[了指向](ftp://ftp.fulgan.com/SSL/openssl-0.9.8h-i386-win32-Indy-IntraWebEdition.zip)SSL 库的特殊构建的链接。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-17T18:59:24.403

我是构建上述 IntraWeb SSL dll 的特殊版本的人。为了完成上面的答案，让我解释一下为什么需要特殊构建：

以前的 Indy 和 IntraWeb 版本使用稍微修改过的 OpenSSL 版本。修改包括与时区计算相关的几个功能，这些功能当时在 Delphi 或 Indy 中不可用。

因此，当有人将一组未修改的 OpenSSL dll（不是 Indy OpenSSL dll）与旧的 Indy 或 IntraWeb 版本一起使用时，由于缺少导出，他将收到“无法加载 SSL 库”错误。

由于我们在 Delphi 2009 中使用 Indy 版本，因此不再需要这些更改。这就是为什么当前的 Indy 版本——来自 SVN 甚至是 Delphi 2007——与 IntraWeb 一起也可以与来自 slproweb 的 dll 一起使用（不包括这些修改）。

但请注意，slproweb dll**确实需要 MS VC++ 运行时 dll**。

为了避免这种情况，我经常为 Indy 创建一组自己的 dll：ftp: [//ftp.fulgan.com/SSL/](ftp://ftp.fulgan.com/SSL/)

截至今天，您应该可以使用此版本： ftp: [//ftp.fulgan.com/SSL/openssl-1.0.0d-i386-win32-rev2.zip](ftp://ftp.fulgan.com/SSL/openssl-1.0.0d-i386-win32-rev2.zip)

我的 dll 集不需要安装 MC VC 运行时。

所以可以肯定地说，任何比 Delphi 2009 更新的 Indy 版本和/或相应的 SVN 版本都可以安全地与 slproweb（具有 VC 依赖项）或我们自己的（来自 fulgan 镜像）dll 一起使用。

# php - SQL - 查找查询中某行的位置

> ID：213085
> 
> 赞同：3
> 
> 时间：2008-10-17T17:35:51.437
> 
> 标签：php, sql

我正在开发一个论坛系统。我试图让用户看到他们发布的帖子。为了使此链接正常工作，我需要跳转到他们发布的包含他们帖子的特定主题的**页面**，以便书签可以工作等。由于这是旧论坛上的一项新功能，我我想对其进行编码，以便论坛系统不必跟踪每个帖子，而可以简单地自动填充此列表。

我知道如何填充列表，但我需要这样做：

给定一个查询，查询中的 X 行（通过某种标识符组合保证是唯一的）将出现在哪里？如，我必须偏移多少行才能到达它？这将在排序查询中。

理想情况下，我想用 SQL 而不是 PHP 来做到这一点，但如果不能在 SQL 中完成，我想这也是一个答案。^_^

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T18:05:18.883

嗯，这个解决方案做了一些假设，但我认为如果我理解正确，它应该适用于你正在尝试做的事情：

```
SELECT count(post_id) FROM posts
  WHERE thread_id = '{$thread_id}' AND date_posted <= '{$date_posted}' 
```

这将为您提供特定线程（我假设您已经预先计算）中等于或早于发布日期（有问题的特定用户帖子）的行数。

根据此信息（例如该线程中的第 15 个帖子），您可以根据论坛分页值计算结果将在哪个页面上。IE

```
// dig around forum code for number of items per page
$itemsPerPage = 10; // let's say
$ourCount = getQueryResultFromAbove(); 

// this is the page that post will be on
$page = ceil($ourCount / $itemsPerPage);

// for example
$link = '/thread.php?thread_id='.$thread_id.'&page='.$page; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:45:04.243

如果您使用的是 MSSQL，则可以使用[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)函数为查询中的每一行添加一个自动递增的数字。

我不知道这对你有什么好处。但它会按照您的要求执行 - 为给定查询的结果集中的行位置分配一个数字。

但是，如果这是用 ph 编写的，那么您可能正在使用 mySQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T17:39:02.587

数据库的问题在于它们没有真正的“顺序”。您可以使用 SCOPE_IDENTITY 运算符返回插入记录的唯一 ID，然后编写某种函数进行分页，直到找到该记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:06:46.163

扩展特洛伊的建议，基本上，您需要一个子查询，

```
 select row_number() OVER(ORDER BY MessageDate DESC) 
 AS 'RowNum', * from MESSAGES 
```

然后放一个外部选择来做真正的工作：

```
 select RowNum, Title, Body, Author from (
  select row_number() OVER(ORDER BY MessageDate DESC) 
  AS 'RowNum', * from MESSAGES)
  where AuthorID = @User 
```

使用 rownum 计算页码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T18:08:58.937

我同意特洛伊的观点，你可能错误地解决了这个问题，要修复它，我们必须了解更多细节，但无论如何在 MySQL 中你都可以这样做

```
SET @i=0;
SELECT number FROM (SELECT *,@i:=@i+1 as number FROM Posts 
ORDER BY <order_clause>) as a WHERE <unique_condition_over_a> 
```

在 PostgreSQL 中，您可以使用临时序列：

```
CREATE TEMPORARY SEQUENCE counter;
SELECT number FROM (SELECT *,nextval('sequence') as number FROM Posts 
ORDER BY <order_clause>) as a WHERE <unique_condition_over_a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T18:12:45.107

我想你的意思是这样的（MySQL）？

```
START TRANSACTION;

SET @rows_count = 0;
SET @user_id = ...;
SET @page_size = ...;

SELECT 
     @rows_count := @rows_count + 1 AS RowNumber
    ,CEIL( @rows_count / @page_size ) AS PageNumber
FROM ForumPost P
WHERE 
    P.PosterId = @user_id;

ROLLBACK; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T18:32:32.087

大多数 SQL 平台都有 IDENTITY 列或序列的专有扩展，这些扩展随表中的每个项目而增加。大多数还有临时表。

```
CREATE TABLE OF QUERY RESULTS WITH IDENTITY COLUMN

INSERT INTO TABLE  
QUERY  
ORDER BY something 
```

那么标识列是查询中的数字，它告诉您在它之前/之后有多少条目。

重要的是按东西订购。否则，您可能会在每次查询中得到不同的订单，在这种情况下，您的号码毫无意义......

# winapi - 如何使用 MFC 在 CWinApp 中接收计时器事件？

> ID：213118
> 
> 赞同：2
> 
> 时间：2008-10-17T17:43:01.813
> 
> 标签：winapi, mfc

在 MFC 中，我试图设置一个空处理程序计时器（即没有窗口）。但我无法处理 CWinApp MESSAGE_MAP 中的 WM_TIMER 事件。这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-17T20:42:07.210

正如 MSDN 所说，有两种操作模式[`SetTimer()`](http://msdn.microsoft.com/en-us/library/ms644906.aspx)：一种将定时器与窗口相关联，另一种将定时器与线程的消息队列相关联。当你有一个窗口时，你可以使用前者；否则，您必须使用后者。而且`CWinApp` *不是*窗户。

### 在线程队列中捕获定时器消息

```
UINT_PTR uTimerId = SetTimer(NULL, 0, 2000, NULL);
TRACE(_T("Timer created - ID=%x\n"), uTimerId); 
```

这将创建一个新的计时器，设置为每两秒触发一次，仅与当前线程的消息队列相关联。当您没有将计时器 ID 与窗口关联时，您无法指定计时器 ID，因此请将返回的 ID 保存在类成员或其他东西中 -[如果您忘记了，稍后您将很难杀死计时器](http://blogs.msdn.com/oldnewthing/archive/2008/10/16/9001218.aspx)。然后，您可以在`CWinApp::PreTranslateMessage()`覆盖中处理它：

```
BOOL CMyFunkyApp::PreTranslateMessage(MSG* pMsg)
{
   if (pMsg->message == WM_TIMER)
   {
      TRACE(_T("Timer fired - ID=%x\n"), pMsg->wParam);
   }

   return CWinApp::PreTranslateMessage(pMsg);
} 
```

请注意，像这样连接到线程的消息循环是处理以这种方式设置的计时器的*唯一*方法 - 正如我们所讨论的，没有窗口，尽管 MFC 确实为您提供了消息映射工具，`CWinApp`但您不能使用`ON_WM_*()`宏，因为。 ..好吧，因为*它不是一个窗口*。然而，还有另一种*稍微*不那么混乱的方式：回调。

### 使用回调处理计时器消息

```
void CALLBACK TimerCallback(HWND, UINT, UINT_PTR id, DWORD dwTime)
{
   TRACE(_T("Timer fired - ID=%x\n"), id);
}

//...

UINT_PTR uTimerId = SetTimer(NULL, 0, 2000, &TimerCallback);
TRACE(_T("Timer created - ID=%x\n"), uTimerId); 
```

这与第一个示例*几乎完全相同*：一个新的计时器被配置为每两秒触发一次，与当前线程的消息队列相关联......但是*这个*有一个与之相关联的回调地址。并且默认消息处理程序知道在处理此类计时器消息时调用回调，因此您不必费心挂钩到消息循环中。

所以你去。使用定时器的两种方式`CWinApp`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:54:21.383

我通过制作一个不可见的窗口并在其上设置一个计时器来做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:45:31.400

查看 Raymond Chen 的这篇文章。有一些有趣的掘金可以说明你的工作可能会让你摆脱麻烦。

[为什么你的线程花费所有时间处理无意义的线程计时器](http://blogs.msdn.com/oldnewthing/archive/2008/10/16/9001218.aspx)

# c++ - 对模板参数使用“类”或“类型名”？

> ID：213121
> 
> 赞同：602
> 
> 时间：2008-10-17T17:43:59.173
> 
> 标签：c++, templates

> **可能重复：**
> [模板中关键字“typename”和“class”的 C++ 差异](https://stackoverflow.com/questions/2023977/c-difference-of-keywords-typename-and-class-in-templates)

在 C++ 中定义函数模板或类模板时，可以这样写：

```
template <class T> ... 
```

或者可以这样写：

```
template <typename T> ... 
```

有充分的理由偏爱其中一个吗？

* * *

我接受了最受欢迎（和有趣）的答案，但真正的答案似乎是“不，没有充分的理由偏爱其中一个。”

*   它们是等价的（除非如下所述）。
*   有些人有理由总是使用`typename`.
*   有些人有理由总是使用`class`.
*   有些人有理由同时使用两者。
*   有些人不在乎他们使用哪一个。

但是请注意，在 C++17 之前，对于*模板模板*参数，需要使用 of`class`代替`typename`。请参阅下面[的 user1428839 的答案](https://stackoverflow.com/a/11311432/3964522)。（但这种特殊情况不是偏好问题，而是语言的要求。）

* * *

## 回答 #1

> 赞同：433
> 
> 时间：2008-10-17T17:47:57.013

[Stan Lippman在这里](https://docs.microsoft.com/archive/blogs/slippman/why-c-supports-both-class-and-typename-for-type-parameters)谈到了这一点。我觉得这很有趣。

*摘要*： Stroustrup 最初用于`class`在模板中指定类型以避免引入新关键字。委员会中的一些人担心这种关键字的重载会导致混乱。后来，委员会引入了一个新的关键字`typename`来解决语法歧义，并决定让它也用于指定模板类型以减少混淆，但为了向后兼容，`class`保留其重载含义。

* * *

## 回答 #2

> 赞同：319
> 
> 时间：2008-10-17T17:52:13.447

根据 Scott Myers，Effective C++（第 3 版）第 42 条（当然，它必须是最终答案）的说法——区别是“什么都没有”。

如果预期 T 将始终是一个类，建议使用“class”，如果可能预期其他类型（int、char* 等等），则使用“typename”。将其视为使用提示。

* * *

## 回答 #3

> 赞同：157
> 
> 时间：2012-07-03T12:57:07.270

作为上述所有帖子的补充，在处理*模板模板参数**时*`class`，强制使用关键字（直到并包括 C++14） ，例如：

 **```
template <template <typename, typename> class Container, typename Type>
class MyContainer: public Container<Type, std::allocator<Type>>
{ /*...*/ }; 
```

在此示例中，`typename Container`会生成编译器错误，如下所示：

```
error: expected 'class' before 'Container' 
```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2008-10-17T17:52:29.470

我更喜欢使用 typename 因为我不喜欢重载关键字（天哪 -`static`对于各种不同的上下文有多少不同的含义？）。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2012-07-23T15:50:24.110

### 有*区别*，您应该更`class`喜欢`typename`.

### 但为什么？

`typename`对于模板模板参数是非法的，因此为了保持一致，您应该使用`class`：

```
template<template<class> typename MyTemplate, class Bar> class Foo { };    //  :(
template<template<class>    class MyTemplate, class Bar> class Foo { };    //  :) 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-17T20:21:02.867

作为对[Mike B](https://stackoverflow.com/questions/213121/c-use-class-or-typename-for-template-parameters#213149)的回应，我更喜欢使用 'class'，因为在模板中，'typename' 具有重载的含义，但 'class' 没有。以这个检查过的整数类型为例：

```
template <class IntegerType>
class smart_integer {
public: 
    typedef integer_traits<Integer> traits;
    IntegerType operator+=(IntegerType value){
        typedef typename traits::larger_integer_t larger_t;
        larger_t interm = larger_t(myValue) + larger_t(value); 
        if(interm > traits::max() || interm < traits::min())
            throw overflow();
        myValue = IntegerType(interm);
    }
} 
```

`larger_integer_t`是一个从属名称，因此它需要在它之前加上“typename”，以便解析器可以识别出它`larger_integer_t`是一种类型。 **另一方面， class**没有这种重载的含义。

那……或者我只是内心懒惰。我键入 'class' 的频率远高于 'typename'，因此发现它更容易键入。或者这可能表明我写了太多的 OO 代码。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-04-01T08:03:22.097

只是纯粹的历史。[引用斯坦·李普曼的话](https://docs.microsoft.com/en-us/archive/blogs/slippman/why-c-supports-both-class-and-typename-for-type-parameters)：

> 这两个关键字的原因是历史性的。在最初的模板规范中，Stroustrup 重用了现有的 class 关键字来指定类型参数，而不是引入一个可能会破坏现有程序的新关键字。并不是没有考虑一个新的关键字——只是考虑到它的潜在破坏性，它没有被认为是必要的。直到 ISO-C++ 标准，这是声明类型参数的唯一方法。

但是应该使用**typename**而不是**class**！有关更多信息，请参阅链接，但请考虑以下代码：

```
template <class T>
class Demonstration { 
public:
void method() {
   T::A *aObj; // oops ...
}; 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-10-17T19:26:10.560

一点都不重要，但是 class 使它看起来 T 只能是一个类，而它当然可以是任何类型。所以 typename 更准确。另一方面，大多数人使用类，所以一般来说可能更容易阅读。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T17:47:35.953

据我所知，使用哪一个并不重要。它们在编译器眼中是等价的。使用您喜欢的任何一个。我通常使用类。

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2009-10-28T12:37:56.870

扩展DarenW的评论。

一旦 typename 和 class 不被认为是非常不同的，那么严格使用它们可能仍然有效。只有当它确实是一个类时才使用 class，当它是基本类型时使用 typename，例如**char**。

这些类型确实也被接受而不是**typename**

> 模板< **char** *myc* = '/' >

在这种情况下，它甚至优于 typename 或 class。

想想其他人的“暗示”或可理解性。并且实际上考虑到第 3 方软件/脚本可能会尝试使用代码/信息来猜测模板发生了什么（考虑 swig）。

# css - 你如何在 CSS 中指定字体大小，以便它们匹配模型并允许调整大小？

> ID：213128
> 
> 赞同：2
> 
> 时间：2008-10-17T17:46:09.153
> 
> 标签：css, browser, fonts

我们遇到了如何指定字体大小的问题。如果我们使用 pt 指定字体大小，它们在浏览器/平台上看起来并不总是相同的。如果我们使用 px 指定字体大小，IE6 用户无法调整文本大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T18:52:45.743

[A List Apart 上的一篇文章](http://www.alistapart.com/articles/howtosizetextincss/)（2007 年 11 月）在各种浏览器中深入探讨了这一点，并得出结论：

> 以 em 为单位调整文本大小和行高，并在正文中指定百分比（以及 Safari 2 的一个可选警告），可在当今常用的所有浏览器中提供准确、可调整大小的文本。这是一种您可以放入工具包中的技术，并将其用作在 CSS 中调整文本大小的最佳实践，以满足设计人员和读者的需求。

他们提供了该技术在大多数流行浏览器中的外观的[屏幕截图](http://www.alistapart.com/d/howtosizetextincss/ss-test-6.html)。这是他们使用的代码：

```
<style type="text/css">`
body {
    font-size:100%;
    line-height:1.125em;
}

.bodytext p {
    font-size:0.875em;
}

.sidenote {
    font-size:0.75em;
}
</style>

<!--[if !IE]>-->

<style type="text/css">
body {
    font-size:16px;
}
</style>

<!--<[endif]--> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T08:41:48.537

与其他人的回答相反，您永远不应该使用像素作为字体大小。internet explorer 6 仍然在浏览器市场占有一席之地，它绝对不会调整以像素大小指定的文本大小（如问题中所述）。您应该始终努力使用“em”。

我使用与其他人在这里建议的技术类似的技术，即我“重置”全面的 css 样式，以消除浏览器与字体大小和定位的任何不一致。我喜欢[eric meyer 的重置重装](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)样式作为基础。如果您想深入了解整个库，也可以使用[yahoo reset css方法。](http://developer.yahoo.com/yui/reset/)

接下来，我使用[owen briggs 的 sane css 排版模板](http://www.thenoodleincident.com/tutorials/typography/)。您可能会注意到它自 2003 年以来一直没有更新，但在当今的浏览器中仍然绝对可靠。

一旦你得到了这个基础，改变`<body>`标签上的字体百分比就很简单了，这将很容易地以相同的方式缩放你网站上的所有字体。

对于不耐烦的人，这里是 eric meyer 的重置 css 和 owen briggs 的排版 css 混合在一起（通过[这个优秀的 css 格式化程序](http://floele.flyspray.org/csstidy//css_optimiser.php)解析）：

```
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-weight:inherit;font-style:inherit;font-size:100%;font-family:inherit;vertical-align:baseline;margin:0;padding:0;}
:focus{outline:0;}
body{line-height:1;font-family:verdana, arial, helvetica, sans-serif;font-size:76%;}
ol,ul{list-style:none;}
table{border-collapse:separate;border-spacing:0;}
caption,th,td{text-align:left;font-weight:400;}
blockquote:before,blockquote:after,q:before,q:after{content:"";}
blockquote,q{quotes:"" "";}
a{text-decoration:none;font-weight:700;color:#000;}
a:hover{text-decoration:underline;}
h1{font-size:2em;font-weight:400;margin-top:0;margin-bottom:0;}
h2{font-size:1.7em;font-weight:400;margin:1.2em 0;}
h3{font-size:1.4em;font-weight:400;margin:1.2em 0;}
h4{font-size:1.2em;font-weight:700;margin:1.2em 0;}
h5{font-size:1em;font-weight:700;margin:1.2em 0;}
h6{font-size:.8em;font-weight:700;margin:1.2em 0;}
img{border:0;}
ol,ul,li{font-size:1em;line-height:1.8em;margin-top:.2em;margin-bottom:.1em;}
p{font-size:1em;line-height:1.8em;margin:1.2em 0;}
li > p{margin-top:.2em;}
pre{font-family:monospace;font-size:1em;}
strong,b{font-weight:700;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T17:48:34.563

您应该始终使用相对单位来表示字体大小，例如 em。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T17:50:10.473

[http://developer.yahoo.com/yui/fonts/#fontsize](http://developer.yahoo.com/yui/fonts/#fontsize)（编辑：我相信这是假设他们的基本 CSS，但它假设基本大小为 13px；我相信即使 IE 也会正确调整百分比大小的文本，其中百分比是根据 px 大小来衡量的。）

也就是说，您永远不会获得像素完美的字体大小，**特别是**如果您尝试匹配图形模型，但即使只是浏览器到浏览器，文本渲染也会有所不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T22:52:31.627

除非你使用 px，否则你总是很难匹配模型。 [http://www.456bereastreet.com/archive/200602/setting_font_size_in_pixels/](http://www.456bereastreet.com/archive/200602/setting_font_size_in_pixels/)
我不觉得在你的网页上使用 px 有什么特别的问题。特别是因为几乎所有现代浏览器——除了 webkit——默认使用缩放而不是文本调整大小。

我仍然可能会坚持 Nathan 的建议，因为它可以让您更灵活地设计，因为您可以通过仅更改其中一个来快速缩放整个网站的字体大小。但是，如果您很懒惰或希望它真正到位，那么您不必害怕 px。

# sql-server - 引用另一个数据库的视图和进程如何导致日志增长？

> ID：213134
> 
> 赞同：0
> 
> 时间：2008-10-17T17:47:40.040
> 
> 标签：sql-server, sql-server-2000

我在一台服务器上有 2 个数据库；我们称它们为 db A 和 B。数据库 A 大约 11 GB，数据库 B 非常小（155mb）。数据库 B 有一些视图和过程，它们不断访问和更新数据库 A 中的数据。

有趣的是，数据库 B 的日志迅速增长到巨大的大小，我认为它在一周内增长到大约 12 GB。数据库 A 并没有增长得那么快。

什么可能导致我的日志增长这么多？当您从另一个数据库中选择数据时，是否发生了一些事情，这会导致我的日志像那样增长？

我知道当你对不同服务器上的数据库执行类似操作时，数据在加入和选择之前全部移动到调用数据库......我可以看到这导致日志增长，同一台服务器上是否会发生同样的事情?

SQL2000 SP4 STD 版
完全恢复模型

在此先感谢，约翰

顺便说一句-我意识到将我的恢复模式更改为简单可能会有所帮助，但我想知道为什么会首先发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-19T02:21:58.953

我无法想象为什么一个简单的 SELECT 语句会在事务日志中添加任何内容，但我对链接服务器没有太多经验，所以我不能确定幕后可能发生什么。

但是，您说“数据库 B 有一些视图和过程，它们不断访问和更新数据库 A 中的数据。”，所以即使数据库 A 上存在基础数据，因为您的新应用程序连接到数据库 B 并使用它的对象，它将这些操作记录在 B 的 tran 日志中似乎是合理的。

但这只是我的猜测。为什么不直接检查事务日志，看看它包含的内容是否合理？RedGate 有一个可与 SQL 2000 配合使用的免费日志浏览器（参见[http://www.red-gate.com/products/SQL_Log_Rescue/index.htm](http://www.red-gate.com/products/SQL_Log_Rescue/index.htm)）；我以前只用过一次，但它似乎运作良好，在那个特定的情况下它真的救了我的培根。

我承认我对细节很好奇，但在你的情况下，我很想压制我的好奇心，只处理日志文件。毕竟，这只是暂时的，如果日志增长是链接服务器的产物，它应该在您完成新应用程序并停用数据库 A 后自行修复。

此外，Godeke 对备份提出了一个很好的观点。如果您的日志文件变得太大，请更频繁地备份它。备份它会截断日志，但仅限于内部；即使用的日志文件的百分比将缩小，但磁盘上文件的实际大小不会改变，直到您使用 DBCC SHRINKFILE 来这样做。

# graphics - 没有强烈失真的纹理球体

> ID：213147
> 
> 赞同：6
> 
> 时间：2008-10-17T17:52:20.937
> 
> 标签：graphics, textures, raytracing

我在几场比赛中看到了纹理良好的球、行星和其他球形物体，最后一次是在 UFO：后果中。如果您只是将纹理飞溅到纬度/经度中，作为 u 和 w 坐标，您会在极点上得到很多难看的纹理失真。

我可以认为自己是实现具有最小失真的球形贴图的一种方法。通过映射三角形而不是正方形。但我不知道任何算法。如何为这些球体生成顶点和纹理坐标？

另外，我看不到从简单的平面方形地图生成完整球形地图的方法。有没有一些直观的方法可以在没有真正麻烦的情况下绘制这样的地图？

但是，是否有其他算法可以在没有失真或失真最小的情况下渲染球体？

光线追踪和光栅化算法都很有趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T20:03:55.443

毛[球定理](http://en.wikipedia.org/wiki/Hairy_ball_theorem)指出，在没有任何扭曲纹理的极点的情况下，不可能在球体上定义连续的纹理坐标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T13:34:00.427

纬度/经度“球体”根据定义扭曲。如果您正在编程，请从 [四面体]( [http://en.wikipedia.org/wiki/Tetrahedron](http://en.wikipedia.org/wiki/Tetrahedron) Tetrahedron) 开始，并根据需要进行细分，将每个三角形[细分](http://en.wikipedia.org/wiki/Surface_subdivision)为 4 个三角形并在给定半径处重新定位中点从中心。

如果您喜欢建模，GeoSphere（如前所述）或任何类似产品都可以解决您的问题。

关键是三角形将具有与纬度无关的恒定变形量。

另请注意，（封闭的）曲面细分将使您能够相当轻松地拥有[（C）LOD 。](http://www.google.com/search?q=clod+continuous+level+of+detail)

[纹理](http://en.wikipedia.org/wiki/Net_(polyhedron))是另一回事，但是一旦你有了一个好的球体，你的问题就会减少。

希望这能激发你的想象力:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T17:57:21.113

您可以使用在两极附近增加纵向模糊的矩形地图（从赤道无到北纬 60 度）。结合 mip-maps 这应该消除您提到的一些效果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T18:04:10.943

Drew Olbrich 想出了一个巧妙的方法[来镶嵌一个球体以产生一个九面体](http://traipse.com/nine/)。如果你增加顶点的数量，你会得到一个相当不错的球形镶嵌。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T18:46:49.267

或者您可以使用立方体贴图。这通常是进行环境映射的首选方式，这基本上就是您所描述的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T18:46:53.150

不要按经度和纬度分割球体。而是使用 3Ds Max 中的 GeoSphere。（实际上是一个多面体，[测地球](http://en.wikipedia.org/wiki/Geodesic_dome#Chord_factors)。）

# c# - 在asp.net c#中对gridview的列进行排序

> ID：213148
> 
> 赞同：7
> 
> 时间：2008-10-17T17:52:23.417
> 
> 标签：c#, asp.net, linq

谁能告诉函数在 c#asp.net 中对 gridview 的列进行排序。

绑定到 gridview 的数据来自使用 linq 创建的数据上下文。我想单击列的标题对数据进行排序。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-10T19:27:24.870

There are 2 things you need to do to get this right.

1.  Keep the sorting state is viewstate(SortDirection and SortExpression)
2.  You generate the correct linq expression based on the current sorting state.

Manually handle the **Sorting** event in the grid and use this helper I wrote to sort by SortExpression and SortDirection:

```
public static IQueryable<T> SortBy<T>(IQueryable<T> source, string sortExpression, SortDirection direction) {
    if (source == null) {
        throw new ArgumentNullException("source");
    }

    string methodName = "OrderBy";
    if (direction == SortDirection.Descending) {
        methodName += "Descending";
    }

    var paramExp = Expression.Parameter(typeof(T), String.Empty);
    var propExp = Expression.PropertyOrField(paramExp, sortExpression);

    // p => p.sortExpression
    var sortLambda = Expression.Lambda(propExp, paramExp);

    var methodCallExp = Expression.Call(
                                typeof(Queryable),
                                methodName,
                                new[] { typeof(T), propExp.Type },
                                source.Expression,
                                Expression.Quote(sortLambda)
                            );

    return (IQueryable<T>)source.Provider.CreateQuery(methodCallExp);
} 
```

db.Products.SortBy(e.SortExpression, e.SortDirection)

Check out [my blog post](http://weblogs.asp.net/davidfowler/archive/2008/10/21/datacontrols-101-part-2-why-you-should-love-datasource-controls.aspx) on how to do this:

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:54:16.737

[http://msdn.microsoft.com/en-us/library/ms745786.aspx](http://msdn.microsoft.com/en-us/library/ms745786.aspx)

[http://aspnet.4guysfromrolla.com/articles/012308-1.aspx](http://aspnet.4guysfromrolla.com/articles/012308-1.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T13:40:28.683

SQL 查询的半伪代码

```
string Query= string.Empty;
string SortExpression = string.Empty;

// HDFSort is an HiddenField !!!

protected void SortCommand_OnClick(object sender, GridViewSortEventArgs e)
{
   SortExpression = e.SortExpression; 
   Query = YourQuery + " ORDER BY "+SortExpression +" "+ HDFSort.Value ;
   HDFSort.Value = HDFSort.Value== "ASC" ? "DESC" : "ASC";
   RefreshGridView();
}

protected void RefreshGridView()
{
   GridView1.DataSource = DBObject.GetData(Query);
   GridView1.DataBind();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:30:48.597

添加：

```
 AllowSorting="true" 
```

到`<asp:GridView />`标签，应该这样做

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T17:55:16.297

可以在此处找到有关在 gridview 中排序的更多信息：[MSDN Gridview 排序](http://msdn.microsoft.com/en-us/library/hwf94875.aspx)用于获取数据的方法应该无关紧要，您可以使用相同的排序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T12:40:08.257

在属性面板中双击排序条目。将创建一个新函数。在此函数中编写代码以填充 Gridview。唯一的区别是根据 GridViewSortEventArgs e 更改查询

e.SortExpression 和
e.SortDirection 总是升序:-(

我希望这个非常简短的答案会有所帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T19:28:08.543

> 当我单独这样做时，它会给出一个错误“未处理的 GridView 'GridView1' 触发事件排序。

我以前也发生过这种情况……我刚刚创建了一个一次性处理程序，然后一切似乎都开始工作了。不是最漂亮的解决方案，但它对我有用。

也就是说，我没有在您的 GridView 代码中看到对数据源的任何引用。你需要这样的东西：

```
<asp:LinqDataSource ID="dsMyDataSource" runat="server"
DataContextTypeName="MyDataContext"
TableName="MyTable"
AllowSort="true" /> 
```

然后在你的 GridView 中：

```
<asp:GridView ID="gvMyGridView" runat="server" DataSourceID="dsMyDataSource" ... /> 
```

# oracle - Oracle 高级队列 - 队列传播

> ID：213151
> 
> 赞同：5
> 
> 时间：2008-10-17T17:53:06.037
> 
> 标签：oracle, advanced-queuing

编辑：这似乎与将两个队列放在同一个模式中有关。

我正在尝试尝试队列传播，但在目标队列中没有看到记录。但这很可能是因为我没有准备好所有的部分。

有人有可以发布的测试用例吗？我将在下面包含我尝试过的内容。我发现文档中的故障排除有点轻，传播是如此的黑匣子，很难知道为什么它没有移动。

这就是我所拥有的；没有笑。

* * *

```
CREATE OR REPLACE TYPE test_payload AS OBJECT(
   test_id   NUMBER,
   test_dt   DATE);

DECLARE
   subscriber   SYS.aq$_agent;
BEGIN
--- Create Originating Queue and start it

   DBMS_AQADM.create_queue_table( queue_table => 'Test_MQT', queue_payload_type => 'Test_Payload',
                                  multiple_consumers => TRUE ); --- multiple subscriber 

   DBMS_AQADM.create_queue( 'Test_Q', 'Test_MQT' );
   DBMS_AQADM.start_queue( queue_name => 'Test_Q' );

--- Create Destination Queue and start it

   DBMS_AQADM.create_queue_table( queue_table => 'Dest_MQT', queue_payload_type => 'Test_Payload',
                                  multiple_consumers => TRUE );
   DBMS_AQADM.create_queue( 'Dest_Q', 'Dest_MQT' );
   DBMS_AQADM.start_queue( queue_name => 'Dest_Q' );

--- Add Subscriber and schedule propagation

   subscriber := SYS.aq$_agent( 'test_local_sub', 'Dest_Q', NULL );
   DBMS_AQADM.add_subscriber( queue_name => 'Test_Q', subscriber => subscriber );
   DBMS_AQADM.schedule_propagation( queue_name => 'Test_Q', destination_queue => 'Dest_Q' );
END;

DECLARE
   enqueue_options      DBMS_AQ.enqueue_options_t;
   message_properties   DBMS_AQ.message_properties_t;
   message_handle       RAW( 16 );
   MESSAGE              test_payload;
BEGIN
   MESSAGE := test_payload( 2, SYSDATE );
   DBMS_AQ.enqueue( queue_name => 'Test_Q', enqueue_options => enqueue_options,
                    message_properties => message_properties, payload => MESSAGE, msgid => message_handle );
   COMMIT;
END;

DECLARE
   dequeue_options      DBMS_AQ.dequeue_options_t;
   message_properties   DBMS_AQ.message_properties_t;
   message_handle       RAW( 16 );
   MESSAGE              test_payload;
BEGIN
   dequeue_options.navigation := DBMS_AQ.first_message;
   DBMS_AQ.dequeue( queue_name => 'Dest_Q', dequeue_options => dequeue_options,
                    message_properties => message_properties, payload => MESSAGE, msgid => message_handle );
   DBMS_OUTPUT.put_line( 'Test_ID: ' || MESSAGE.test_id );
   DBMS_OUTPUT.put_line( 'Test_Date: ' || MESSAGE.test_dt );
   COMMIT;
END; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T14:20:24.607

也许您需要启用它？

```
DBMS_AQADM.ENABLE_PROPAGATION_SCHEDULE(queue_name => 'Test_Q'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T02:57:21.927

您可能想通过 AQ 上的 Tom Kyte 线程阅读：

[http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:8760267539329#tom1246632800346467977](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:8760267539329#tom1246632800346467977)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T16:56:40.893

您需要有一个默认订阅者到传播的目标队列。需要有一些东西来倾听

# internet-explorer - 是否有 IIS 设置来消除请求的 URL 中多余的“/”字符？

> ID：213153
> 
> 赞同：1
> 
> 时间：2008-10-17T17:53:57.733
> 
> 标签：internet-explorer, iis, caching, url-rewriting

一般问题：

我们的 IIS Web 服务器的 URL 格式如下：

> **[http://www.server.com/page.aspx](http://www.server.com/page.aspx)**

我们也看到像这样的网址进来了：

> **[http://www.server.com//page.aspx](http://www.server.com//page.aspx)**

我们想去掉那个额外的路径字符，因为当用户代理是 Internet Explorer 时，这会解析为 2 个不同的页面，因此，当内容应该从缓存中解析时，它会下载两次。

我不确定这是否是一个需要通过 url 重写模块之类的东西来解决的问题，或者是否有配置设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T19:15:34.560

我认为问题出在 IE 而不是 IIS 上。

Url Rewriting通常是指将URL从服务器映射`http://example/shoes/clarkes`到`http://example/shoes.aspx?maker=clarkes`服务器的过程，以便浏览器不知道它。

您需要做的是将浏览器从重定向`http://www.server.com//page.aspx`到`http://www.server.com/page.aspx`使用[301 Http 响应代码](http://www.webconfs.com/how-to-redirect-a-webpage.php "301的详细信息")。

# 理论上：

由于您似乎正在使用 ASP.NET，因此最透明的方法是编写一个[HttpModule](http://msdn.microsoft.com/en-us/library/ms227673%28VS.80%29.aspx "创建自定义 HttpModule")来检查请求的 URI 中的双斜杠并进行重定向。

最简单的方法是在 Global.ascx.(cs|vb) 中放入一些代码来检查[BeginRequest](http://msdn.microsoft.com/en-us/librarsystem.web.httpapplication.beginrequest(VS.80).aspx)上请求的 URI 。

无论哪种方式，进行检查的代码都是相同的。

# 在实践中：

可能是 IIS 或 ASP.NET 在您有机会看到它之前就吞下了双“/”。如果是 IIS，那么您可能必须在 IIS 前使用代理。如果它是 ASP.NET，那么您可能会找到一个[ISAPI 扩展](http://www.google.co.uk/search?q=ISAPI_REWRITE+lite "反正我不隶属于这个工具")来为您完成这项工作。

# 其他选项

你也可以

*   拆分页面，以便可以将大部分单独的资源与 html 内容分开缓存
*   教育用户他们不需要添加额外的斜线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-24T01:18:31.150

# 修复您的链接！

您看到双斜线的可能性很大，因为您自己的网站上有错误的链接，无论是硬编码的还是脚本生成的。`http://example.com/`在连接+的脚本中很容易错误地执行此操作`/page.aspx`。密切注意这些类型的连接！

IIS 清除了多余的斜线，因此无法使用任何 ASP.NET 代码或 HttpModule 来解决此问题。额外的斜杠甚至不会进入 IIS 日志文件。我使用 IIS7 和 telnet 进行了测试，无法在日志或 ASP.NET 中添加额外的斜线。

我不确定为什么最初的问题似乎只涉及 IE。IE 和 FF 都允许在 URL 中使用额外的斜杠，并且似乎可以传输它们，尽管我没有使用数据包嗅探来验证。

# solaris - 如何在 Solaris 9 中将 iostat 的输出作为图形获取

> ID：213164
> 
> 赞同：0
> 
> 时间：2008-10-17T17:57:52.143
> 
> 标签：solaris, iostat

是否有可用的内置/自定义脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-21T17:04:27.940

实际上与编程无关。无论如何，根据我的经验，[munin](http://opencsw.wikidot.com/munin-package)可以生成非常漂亮的图表，由 rrdtool 提供支持。您还可以在不同的机器上托管一个 munin 主节点，并从许多 munin 节点收集数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T08:25:55.293

[dim_STAT](http://dimitrik.free.fr/)真的很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:18:31.303

尽管它可能与编程无关，但您可以尝试[Orca](http://www.orcaware.com/orca/)。

# algorithm - DSP/FPGA相位累加器如何工作？

> ID：213167
> 
> 赞同：3
> 
> 时间：2008-10-17T17:58:55.307
> 
> 标签：algorithm, embedded, signal-processing

我正在查看相位累加器的代码，我一定是个傻瓜，因为我不明白。代码很简单：

```
  每个时钟滴答做：
    累加 = 累加 + NCO_param；
    返回累积；

```

accum 是一个 32 位的寄存器。显然，在某些时候它会翻转。

我的问题真的是：这与灵态有何关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T18:47:34.350

[这篇文章](http://en.wikipedia.org/wiki/Direct_digital_synthesis)可能会有所帮助。

在运行步骤中，计数器（适当地称为相位累加器）被指示在频率参考的每个脉冲上按一定的增量前进。相位累加器（相位）的输出用于依次选择数据表中的每一项。最后，DAC 将此数据序列转换为模拟波形。

> 在运行步骤中，计数器（适当地称为相位累加器）被指示在频率参考的每个脉冲上按一定的增量前进。相位累加器（相位）的输出用于依次选择数据表中的每一项。最后，DAC 将此数据序列转换为模拟波形。为了生成周期性波形，电路被设置为通过表格所花费的时间等于波形的周期。例如，如果参考频率为 1 MHz，表格包含 1000 个条目，则以 1 的相位增量完整通过表格将需要 1000 / 1 MHz = 1 ms，因此输出波形的频率将为1/(1 毫秒) = 1 kHz。
> 
> 该系统可以简单地通过增加相位增量来产生更高的输出频率，以便计数器更快地通过表格。在上面的示例中，相位增量等于 1，因此通过将增量设置为 2 来获得下一个可能的频率，从而使输出频率增加一倍。为了获得比这更精细的频率控制，可以将标准相位增量设置为例如 10。这样就允许稍高或稍低的输出频率。例如，将增量增加到 11 将使输出频率增加 10%，将其减少到 9 将按相同比例降低输出频率。频率所需的精度越高，计数器中需要的位就越多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T02:59:13.140

在回答我自己的问题时，我在[网上](http://www.automotivedesignline.com/showArticle.jhtml?articleID=205921175)找到了另一篇有趣的文章，描述了用于频率合成的相位累加器。

以下是我对相位累加器工作原理的理解：
累加器寄存器实际上代表 360 度。因此，值 0 表示 0 度，值 2^32 表示 360 度。

相位累加器在每个时钟节拍加一个值 (M)。这表示围绕圆移动 (M/2^32) 度的角度。当寄存器溢出时，我们只是循环了一个完整的 360 度并重新开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-02T19:18:49.787

公式是这样的：

使用具有波形 (x) 周期 = x(0-1) 而不是 x(0-2Pi) 周期的振荡器的示例

每个音频流有一个变量，称为 acc/accumulator，

每个样本，通过 accadd 累加：

```
 var accadd = 1.0/( sampleRate / p2freq( note ) ) ;
    acc+= accadd;
    acc = acc%1.0;// not sure to do this as accurately using if statement. can reset acc every noteOn 
```

如果您使用 2pi 周期的经典 Sin，请使用 2pi 而不是 1.0

像这样，波形将以每秒 p2freq(note) 周期从 0-1 运行。

# wcf - 查看 WCF SOAP 消息的工具

> ID：213168
> 
> 赞同：3
> 
> 时间：2008-10-17T17:59:03.620
> 
> 标签：wcf, soap

我知道有一个工具可以让我查看在我的 WCF 应用程序中实际发送/接收的内容，即让我看到实际的 SOAP 消息通过网络传递。问题是我不记得那个工具叫什么，而且我的谷歌技能也没有多大帮助。任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T18:00:29.220

只要您使用 HTTP 或 HTTPS，[Fiddler2 就可以工作。](http://www.fiddler2.com/fiddler2/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T18:04:25.840

我相信您正在寻找服务跟踪查看器。 [http://msdn.microsoft.com/en-us/library/ms732023.aspx](http://msdn.microsoft.com/en-us/library/ms732023.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T18:02:39.370

我会使用[Wireskark](http://www.wireshark.org/)，它会捕获几乎所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T18:03:44.173

这里有一些信息

[来自 Web 服务调用的 XML](https://stackoverflow.com/questions/205546/xml-from-a-web-service-call)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-07T07:41:45.140

使用 WCFTestClient。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T18:07:28.753

我为服务启用了跟踪并使用 Microsoft Service Trace Viewer 来查看它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T18:51:47.587

我不是 WCF 专家，但我使用[Charles](http://www.charlesproxy.com/)来完成所有 HTTP 嗅探任务

# jquery - 更改类不会导致在 IE6 中应用新类的规则？

> ID：213173
> 
> 赞同：3
> 
> 时间：2008-10-17T18:00:18.113
> 
> 标签：jquery, html, css, internet-explorer-6, cross-browser

我有一张包含 9 种不同状态的图像，并将适当的背景位置规则设置为类以显示不同的状态。我不能使用 :hover 伪选择器，因为正在更改的背景图像与悬停在上面的元素不同。我以这种方式定义了类：

```
#chooser_nav {width:580px; height:38px; background:transparent url(/assets/images/chooser-tabs.jpg) 0 0 no-repeat; margin-left:34px;}
#chooser_nav.feat {background-position:0 0;}
#chooser_nav.inv {background-position:0 -114px;}
#chooser_nav.bts {background-position:0 -228px;}
#chooser_nav.featinv {background-position:0 -38px;}
#chooser_nav.featbts {background-position:0 -76px;}
#chooser_nav.invfeat {background-position:0 -152px;}
#chooser_nav.invbts {background-position:0 -190px;}
#chooser_nav.btsfeat {background-position:0 -266px;}
#chooser_nav.btsinv {background-position:0 -304px;} 
```

然后，使用 jQuery，我有一系列基于先前单击事件的悬停规则（此处未声明的“cur”变量在其他地方正确声明）：

```
 $("#featured_races a").hover(function(){
    cur == "feat" ? $("#chooser_nav").attr("class", cur) : $("#chooser_nav").attr("class", cur+"feat");
  }, function(){
    $("#chooser_nav").attr("class", cur);
  });

  $("#invitational_races a").hover(function(){
    cur == "inv" ? $("#chooser_nav").attr("class", cur) : $("#chooser_nav").attr("class", cur+"inv");
  }, function(){
    $("#chooser_nav").attr("class", cur);
  });

  $("#behind_the_scenes a").hover(function(){
    cur == "bts" ? $("#chooser_nav").attr("class", cur) : $("#chooser_nav").attr("class", cur+"bts");
  }, function(){
    $("#chooser_nav").attr("class", cur);
  }); 
```

因此，在 Moz 和 WebKit 浏览器中，这可以正常工作。应用类并且背景图像相应地改变。也适用于 IE7。但是，在 IE6 中，背景图像永远不会改变。这些类得到了适当的应用，我用 MS 的 web 开发工具中的 DOM 查看器验证了这一点。所以，jQuery 正在工作。该课程正在应用，但没有明显发生任何变化。

我有点难住了……帮帮我，Crackoverflow……你是我唯一的希望……

编辑：就 className 与 setAttribute 而言......该类正在发生变化。attr("class", cur) 正在工作。但是，一旦更改了类，生成的规则就不会在视觉上应用……但是类的更改正在发生。

编辑 2： 至于 jQuery 的特定于类的方法：我最初将它们放在代码中，结果是一样的。同样，问题不在于没有将类应用于元素......这已被证实正在发生。这是一旦类在元素上，由于某种原因，元素不遵循为该类设置的 CSS 规则......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T15:19:10.027

猜想一：渲染bug 1

确保您已在元素上触发 hasLayout。你可以通过给它们一个高度来做到这一点，或者，如果这不是一个可能性，那么 position = relative & z-index = 1，也会触发 hasLayout。试试这些元素+可疑的父元素。

```
/* fix hasLayout bug for IE */
div#id {
  _height : 0;
  min-height : 0;
} 
```

猜想二：渲染bug 2

有时，可能需要强制执行比浏览器决定的更多的渲染计算。你可以通过触摸 body 类来给 DOM 一个很好的踢：

```
document.body.className += ''; 
```

猜想三：选择器问题

IE6 不支持多个类选择器，可能 ID+Class 除外，某些情况除外。

```
div.class1.class2 {
  border : 1px solid red; /* this will normally not work in IE6 */
} 
```

我目前没有要测试的 IE，并且不记得天气 #id.class 应该可以工作（我觉得应该可以），但我通常会避免 IE6 的任何此类事情。您可能需要更改选择器。

您需要设置一个测试来查看您的选择器是否正常工作。

可能有效的变体：

```
.inv#chooser_nav { background-position : 0 -114px; } 
```

或者您可能需要由父级单独选择元素：

```
#someparent .inv { background-position : 0 -114px; } 
```

IE6 也有悬停问题，所以这也可能是一个因素。

希望这可以帮助。很抱歉，我不能更确定，但要克服 IE6 的怪癖，很大程度上是通过反复试验、蛮力、猜测和慷慨的耐心帮助的旧方法来完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T13:52:51.967

IE6 在您使用的“双”css 规则方面存在问题。

```
#chooser_nav.bts {background-position:0 -228px;} 
```

您正在选择具有 ID`chooser_nav` *和*class的元素`bts`。这个（非常有用的）构造在 IE6 中并不可靠。如果您可以删除 ID 说明符，或者改为定位父元素，那应该可以解决您的问题：

```
.bts {background-position:0 -228px;} 
```

或者

```
#chooser_nav_parent .bts {background-position:0 -228px;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:11:39.103

使用`className`DOM 属性。`setAttribute()`在 IE < 8 中完全崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T13:48:11.307

我遇到了类似的问题；应用了类名，文本 colot 按预期更改，但是背景图像没有立即更新。在我将鼠标悬停在实际元素上或之外后，背景会更新。

原来是与 DD_belatedPNG 库发生冲突。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-22T07:20:03.000

我在ie7中遇到了这个问题。

基本上我正在更改父元素上的一个类以隐藏一些元素并显示其他元素。类发生了变化，加载页面时显示的元素隐藏并显示正常，但加载页面时未显示的元素从未显示。

我注意到这只发生在某些情况下（上帝只知道预测它）。

我的解决方案是仅在使用 javascript 加载页面后隐藏元素。

# asp.net - 如何在没有代码隐藏文件的 VB.NET aspx 页面中打开 Option Strict / Infer？

> ID：213181
> 
> 赞同：4
> 
> 时间：2008-10-17T18:03:48.837
> 
> 标签：asp.net, vb.net, option-infer

嗯，我猜我的问题在标题中：

如何在没有代码隐藏文件的 VB.NET aspx 页面中打开 Option Strict / Infer？

```
<%@ Page Language="VB" %>
<script runat="server">
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)

    End Sub
</script> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-17T18:07:20.437

```
<%@ Page Language="VB" Strict="true" %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T18:08:40.700

将第一行更改为

```
<%@ Page Language="VB" strict="True" %> 
```

# visual-studio-2008 - 我是否可以安全地安装 .Net Framework 3.5 SP1 而无需我的客户升级他们的 .Net Framework 可分发包？（当前运行 3.5）

> ID：213183
> 
> 赞同：2
> 
> 时间：2008-10-17T18:04:24.390
> 
> 标签：visual-studio-2008, .net-3.5

我可以安全地下载和安装 .Net Framework 3.5 SP1，而无需我的客户升级他们的 .Net Framework 可分发包吗？

编辑：并且不改变我的构建脚本

编辑：我目前正在运行 3.5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T18:09:16.800

可以，只要您的项目针对的是较早的框架版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T18:26:03.550

[来自汉塞尔曼](http://www.hanselman.com/blog/VS2008AndNet35SP1BetaShouldYouFearThisRelease.aspx)，

在 .NET 3.5 方面，因为这是一个 SP（服务包），是的，有些东西会进入您的 GAC 并被更改。然而，这些变化是完全相加的。这意味着如果 API 的方法签名发生了变化，那就是我们需要修复的错误。这将是一个完全兼容的服务包版本。它不应该破坏您现有的任何代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T11:38:50.280

不，不安全。您不能将 Visual Studio (2008) 配置为面向 3.5SP1，只有 3.5。尽管 API 在 3.5 和 3.5SP1 之间几乎相同，但在 SP1 中还有一些新函数和构造函数。MSDN 没有提供任何帮助说明何时引入该功能，因此在 VS 中无法判断您的新构建是否可以在没有 SP1 的情况下工作。

如果您在没有 SP1 的 3.5 中运行该代码，您的应用程序将在运行实际代码时崩溃，而不是在程序集加载时崩溃。

解决方案是要么坚持不带 SP1 的 3.5，要么在不带 SP1 的机器上正确测试所有代码。

就个人而言，我有一台 VM 机器要测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:24:25.833

对，但是

*   确保您在没有 SP1 的情况下针对 3.5 进行测试（虚拟机对于这样的东西非常宝贵）
*   不要使用 3.5 SP1 引入的任何新功能（如 ASP.NET 动态数据）

可能有可能在您的项目中部署所有依赖项（即使是通常在 GAC 中的那些）——我已经看到使用 System.Core 使用这种技术的 .Net 2.0 SP1 项目——但再次确保你在 .Net 中彻底测试3.5无SP1环境。

# c# - 是否有任何优雅的方法可以根据调用者使用反射或其他方式执行特定代码？

> ID：213192
> 
> 赞同：1
> 
> 时间：2008-10-17T18:07:48.160
> 
> 标签：c#

在我的理想世界中，我正在寻找的东西会以这样的方式存在：

```
public string UserDefinedField
{
    get { return _userDefinedField; }
    internal set { _userDefinedField = value; }        
    set { _userDefinedField = value; ChangedFields.Add(Fields.UserDefinedField); }
} 
```

无论访问修饰符如何，都会执行一条语句，如果从外部程序集或类调用另一条语句，则会执行另一条语句。

我确信我可以通过使用反射和检查当前调用堆栈来编写代码，看看调用者是否在同一个程序集中，但我想看看是否有比这更优雅的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T18:10:30.103

```
public string UserDefinedField
{
    get { return _userDefinedField; }
    set { SetField(value); ChangedFields.Add(Fields.UserDefinedField); }
}

// Call this from internal methods and use the public property for other cases
internal string SetField(string userValue)
{
    _userDefinedField = userValue;
} 
```

您**可以通过**[检查调用堆栈](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)来获取调用者信息，但这非常慢（与上面相比），我不推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T18:28:49.083

重新定义 Isak 的答案

```
public string UserDefinedField
{
    get { return InternalUserDefinedField; }
    set { InternalUserDefinedField = value; ChangedFields.Add(Fields.UserDefinedField); }
}

internal string InternalUserDefinedField 
{
    get { return _userDefinedField; }
    set { _userDefinedField= value;  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:11:27.200

这不是您要问的，但在这种情况下，我会使用内部方法直接设置值。

```
...
internal void SetUserDefinedField(string val) {
  _userDefinedField = val;
}
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T14:31:33.320

如果有人对反射路线感兴趣，这段代码看起来可以工作，但我会犹豫是否使用它而不是迄今为止发布的其他建议：

```
// assumes callers know where they're located at in the current stack trace.
private Boolean IsExternallyCalled(int methodDepth)
{
    System.Diagnostics.StackTrace trace = new System.Diagnostics.StackTrace();

    System.Type callingType = trace.GetFrame(methodDepth).GetMethod().ReflectedType;
    System.Reflection.Assembly a = System.Reflection.Assembly.GetAssembly(callingType);

    return !(a.Equals(System.Reflection.Assembly.GetCallingAssembly()));
} 
```

到目前为止发布的其他示例的问题是，即使在同一个程序集中，其他类也需要有关该特定类如何操作的内部知识才能调用“正确”设置器。如果我对外部程序集施加相同的约束，这闻起来并不像，但我宁愿将我的关注点分开一点。

# authentication - OpenID 认证错误

> ID：213195
> 
> 赞同：0
> 
> 时间：2008-10-17T18:08:04.557
> 
> 标签：authentication, openid

当我尝试使用我的 yahoo openid 登录此站点时，它会将我带到 yahoo 站点，我单击“继续”，这意味着我*想*将我的身份验证详细信息发送到 stackoverflow.com，而 stackoverflow.com 在下面给出以下错误登录文本字段：

无法使用您的 OpenID 提供商登录：

验证失败，返回失败。请确保您的标识符正确，然后重试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T18:09:51.103

我以前也遇到过这个问题，清除缓存和cookie，然后再试一次，它应该会自行解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T18:10:57.590

您可以访问[http://openid.yahoo.com/](http://openid.yahoo.com/)并在那里登录。然后它将为您提供一个 URL，您可以将其剪切并粘贴到 stackoverflow 的登录名中，该 URL 应该每次都可以使用。

# css - 是否可以有一个带有水平滚动条但没有垂直滚动条的底部页脚？

> ID：213208
> 
> 赞同：3
> 
> 时间：2008-10-17T18:10:31.180
> 
> 标签：css, internet-explorer

我有一个使用最小宽度的布局并且效果很好。所以我来添加一个我想贴在底部的页脚。Firefox 将在使用 IE 时完美显示所有内容，当 min-width 生效并且垂直滚动条启动时，即使我的内容甚至不需要它，水平滚动条也会出现。

我已经尝试了所有我能找到的关于底部页脚的解决方案，它们似乎都是这样的。

这个问题有解决方案吗，还是我必须再次意识到 IE 不太好？;)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T18:13:06.230

您是否尝试过使用溢出：隐藏；？

*编辑*：您可能还想尝试溢出：自动；您的边距设置为边距：0；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T18:14:31.127

你可以试试 overflow-y: hidden;

注意：不验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T22:43:35.840

我知道 jquery ui 有一个可以复制功能的滑块插件。这是一个执行类似操作的演示。 [http://ui.jquery.com/repository/real-world/product-slider/](http://ui.jquery.com/repository/real-world/product-slider/) 对您的应用程序来说可能有点重，但值得一看。

# delphi - 管理项目 - 您如何看待 AxoSoft OnTime？

> ID：213212
> 
> 赞同：0
> 
> 时间：2008-10-17T18:11:35.983
> 
> 标签：delphi, project-management, ontime

我想知道如果您曾经使用过 AxoSoft OnTime 问题跟踪和项目管理解决方案（优点和缺点），您有什么经验...

干杯，B.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T10:07:02.233

The. Client. Is. Bloody. Slow!

But yes, we use it. And it is powerful. And configurable.

But hell is the client slow!

Use the http(s) if at all possible.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T10:12:17.400

same bugbears as everyone else is having with it. We use it for internal bug tracking and logging our time.

It seems very capable, and can handle what you throw at it, but I find the UI sucks, tabs flitting about the place and creating a new incident seems a case of fill in what it asks for, OK, then it'll error at you saying you need to fill in extra fields - some of which aren't on the tab it shows you. /whinge

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:34:18.060

和 Schmoopy 一样，我们在团队中专门使用它来跟踪错误。就我个人对它的印象而言，它的工作做得很好。客户端应用程序可以在界面中使用一些可用性改进，但它很好地涵盖了我们所有的基础。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:14:52.497

我们使用它，它有很多不错的功能 - 定义了一些怪癖，但自从我们实现了它 - 它让我们所有人都在同一个页面上。它也有一些不错的 Visual Studio 集成插件。

我会说它值得一试。

抱歉，只是想补充一下：我们仅将其用于问题跟踪

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T18:19:15.593

我们为一小部分开发人员使用它，并且非常满意。最好的功能之一是可让您将其集成到应用程序中的 SDK。我们使用它在我们的错误处理程序中自动提交缺陷报告，以及帮助菜单上的请求新功能选项。

# agile - Scrum 燃尽模式

> ID：213214
> 
> 赞同：6
> 
> 时间：2008-10-17T18:11:50.350
> 
> 标签：agile, scrum

我在一个 10 人的团队中，正在处理一个不太理想的产品所有者的大型遗留代码库。我们的积压工作非常糟糕，大型史诗经常打破我们的冲刺。该团队还为完成的定义而苦苦挣扎——一些成员虔诚地编写单元测试，而另一些成员则没有，有时取决于可用的时间。

所以，我看到了一些有趣的燃尽模式，我想知道其他人看到了哪些模式以及它们的含义。

模式一：

```
#
# # 
# # #  
# # # #     
# # # # #   
# # # # # #
# # # # # # # 
```

*   正面解释：“一切都好。”
*   负面解释：“好得令人难以置信。到底发生了**什么**？”

模式二：

```
#
#
# #
# #     
# # #   # 
# # #   # #
# # # # # # # 
```

*   正面解释：“这比我们想象的要容易得多，让我们引入更多故事。”
*   否定解释：??

模式3：

```
#
# # # #
# # # #  
# # # #     
# # # # #   
# # # # # #
# # # # # # # 
```

*   正面解释：“起初不确定这项工作，后来发现比我们想象的要容易。”
*   负面解释：“进展不够，我们停止编写单元测试以按时‘完成’。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T18:27:10.913

这在我们办公室周围被认为是“啊，废话！我忘了那个。” 烧掉：

```
 # # #
    # # # #
    # # # # #
    # # # # # #
#   # # # # # #
# # # # # # # #
# # # # # # # # 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T18:30:54.133

消极方面的模式 2 是“没有很好地估计”。

这是我用过的一些燃尽图。忽略背景图片——它们只是为了娱乐与我一起工作的人，否则与我们的工作无关。 [替代文字 http://www.atalasoft.com/cs/photos/techtalkgallery/images/16157/425x285.aspx](http://www.atalasoft.com/cs/photos/techtalkgallery/images/16157/425x285.aspx)

我喜欢这张图表。这是一个非常典型的好图表，当我们摆脱其他任务时，我们开始慢慢地开始工作，投入工作，被其他事情打断并努力完成。

[替代文字 http://www.atalasoft.com/cs/photos/techtalkgallery/images/16155/425x262.aspx](http://www.atalasoft.com/cs/photos/techtalkgallery/images/16155/425x262.aspx)

在这张图表中，我们开始非常稳定，然后起飞实际上提前完成。

[替代文字 http://www.atalasoft.com/cs/photos/techtalkgallery/images/16156/425x264.aspx](http://www.atalasoft.com/cs/photos/techtalkgallery/images/16156/425x264.aspx)

在这张图表中，您可以看到我们开始时非常典型，然后看起来很容易的任务却变得异常困难。我认为我们最终停止了这个冲刺并建立一个新的冲刺。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-19T01:12:59.140

燃尽图的一个问题是范围的变化与针对范围的进展混合在一起。

在您的示例 2 中，一个可能的解释是……天哪，我可能不应该等到迭代结束才开始这个冒险的故事/任务……这比我预期的要努力得多！

在示例 3 中，您可能已经提前增加了范围或发现工作比预期的更努力（例如，任务估计为一天 4 小时，然后在工作 8 小时后下一次估计为 4 小时，并且发现任务要困难得多）。

出于这个原因，我更喜欢燃尽图而不是燃尽图……它将范围更改与进度分离为两条线——一条范围和一条剩余工作，因此您可以更清楚地看到范围更改的影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T15:33:16.707

我的观点是不要太认真地对待燃尽图。它们是一个指标。最后是关于你是否完成了一个故事。

您是否在冲刺结束时进行了有效的回顾？

是否跟进追溯行动？

如果您发现人们不认真地编写单元测试，请让他们这样做（如果这是您的团队标准）。同意完成的共同定义并坚持下去。见[完成的定义](https://stackoverflow.com/questions/170009/your-scrum-definition-of-done#170181)

拥有像 SCRUM 这样的敏捷流程需要不断的检查和调整。

在我看来，似乎存在问题，但您的团队并未解决这些问题。如果产品负责人不够理想，与此相关的问题应该在你的回顾中出现，这样你就可以在下一个 sprint 中避免它。

如果你有史诗，你总是可以分解它们，重新确定优先级并重新计划它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T14:42:06.623

这里经常是这样的：

```
#####
#######
########
#########
#########
#########
########## 
```

正面：准时交货。

负面：积压项目太大或从一开始同时开始的积压项目太多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T20:38:28.290

这是我还没有在这里看到的一个。它发生在我们的最后一个 sprint 中。

```
#
##
###
#####
#############
##################
###################
#################### 
```

这是“我们在第一个任务上取得了比预期更好的进展，然后我们认为领先，然后懈怠，然后不得不在最后努力追赶或冒着滑倒功能的风险。”

经验教训：燃尽图非常适合跟踪过去的努力，但不一定代表您未来的进步。

# visual-studio - 创建 Visual Studio 工具栏命令以执行批处理文件

> ID：213236
> 
> 赞同：12
> 
> 时间：2008-10-17T18:15:57.723
> 
> 标签：visual-studio

在开发某个项目时，我需要经常运行一些批处理文件。我想创建一个名为“MyProject”的 Visual Studio 工具栏，并在下面有命令来执行这些批处理文件。实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-17T18:24:25.020

在*工具...*菜单中，选择*外部工具...*并添加对批处理文件的引用。然后右键单击工具栏，选择*Customize...*，转到*Toolbars*选项卡，单击*New...*，命名您的新工具栏，单击*OK*，转到*Commands*选项卡，选择*Tools*类别并拖放适当的*外部命令*命令到您的自定义工具栏。

如果您需要运行总是在构建之前或之后运行的批处理文件，您最好使用[构建事件](http://msdn.microsoft.com/en-us/library/e2s2128d.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-09T16:00:38.487

1.  如何在 Visual Studio 中安装图标以运行批处理文件。
2.  在菜单上转到工具 > 外部工具
3.  单击添加并填写以下内容：
    1.  标题：为图标名称显示的名称。
    2.  命令：浏览到文件名并单击确定或将文件路径和文件名放在这里。
    3.  如果要在 Visual Studio 中查看批处理文件输出，请选中使用输出窗口。
    4.  单击确定。
4.  记下您刚刚添加的菜单内容的位置 # 从顶部的位置 1 开始。稍后您将使用它作为外部命令#。
5.  转到工具 > 自定义或右键单击工具栏区域并单击自定义。
6.  转到工具栏选项卡单击新建，命名工具栏名称，然后单击确定。
7.  转到命令选项卡，选择工具栏单选按钮，在右侧的下拉列表中选择您的工具栏名称。
8.  单击添加命令按钮。在类别中选择工具，然后在右侧的命令中从上方选择外部命令#，然后单击确定。它将出现在工具栏中，现在可以使用了。

# python - 在 Django 中，如何使用 Django 的 update_object 通用视图来编辑继承模型的形式？

> ID：213237
> 
> 赞同：0
> 
> 时间：2008-10-17T18:16:07.533
> 
> 标签：python, django, forms, inheritance, decorator

*在 Django 中，给出了应用程序动物*的摘录，如下所示：

带有以下内容的*动物/模型.py*：

```
from django.db import models
from django.contrib.contenttypes.models import ContentType

class Animal(models.Model):
  content_type = models.ForeignKey(ContentType,editable=False,null=True)
  name = models.CharField()

class Dog(Animal):
  is_lucky = models.BooleanField()

class Cat(Animal):
  lives_left = models.IntegerField() 
```

还有一个*动物/urls.py*：

```
from django.conf.urls.default import *

from animals.models import Animal, Dog, Cat

dict = { 'model' : Animal }

urlpatterns = (
  url(r'^edit/(?P<object_id>\d+)$', 'create_update.update_object', dict),
) 
```

如何使用通用视图来编辑 Dog 和/或 Cat 使用相同的表单？

即传递给*animals/animal_form.html的**表单*对象将是Animal，因此不会包含派生类Dog 和Cat 的任何细节。我怎么能让 Django 自动将子类的表单传递给*animal/animals_form.html*？

 **顺便说一句，我使用[Djangosnippets #1031](http://www.djangosnippets.org/snippets/1031/)进行 ContentType 管理，因此 Animal 将有一个名为*as_leaf_class*的方法，该方法返回派生类。

显然，可以为每个派生类创建表单，但这是很多不必要的重复（因为模板都是通用的——本质上是 {{ form.as_p }}）。

顺便说一句，最好假设 Animal 可能是具有相同问题的几个不相关的基类之一，因此理想的解决方案将是通用的。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T19:40:12.103

好吧，这就是我所做的，它似乎有效并且是一个明智的设计（尽管我会被纠正！）。

在核心库（例如 mysite.core.views.create_update）中，我编写了一个装饰器：

```
from django.contrib.contenttypes.models import ContentType
from django.views.generic import create_update

def update_object_as_child(parent_model_class):
   """
   Given a base models.Model class, decorate a function to return  
   create_update.update_object, on the child class.

   e.g.
   @update_object(Animal)
   def update_object(request, object_id):
      pass

  kwargs should have an object_id defined.
  """

  def decorator(function):
      def wrapper(request, **kwargs):
          # may raise KeyError
          id = kwargs['object_id']

          parent_obj = parent_model_class.objects.get( pk=id )

          # following http://www.djangosnippets.org/snippets/1031/
          child_class = parent_obj.content_type.model_class()

          kwargs['model'] = child_class

          # rely on the generic code for testing/validation/404
          return create_update.update_object(request, **kwargs)
      return wrapper

  return decorator 
```

在animals/views.py中，我有：

```
from mysite.core.views.create_update import update_object_as_child

@update_object_as_child(Animal)
def edit_animal(request, object_id):
  pass 
```

在动物/urls.py 中，我有：

```
urlpatterns += patterns('animals.views',
  url(r'^edit/(?P<object_id>\d+)$', 'edit_animal', name="edit_animal"),
) 
```

现在我只需要为每个基类创建一个唯一的编辑函数，使用装饰器创建它是微不足道的。

希望有人觉得这很有帮助，我很高兴得到反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T18:51:06.433

AFAICT，猫和狗在不同的数据库表上，也许没有动物表。但是您对所有人都使用一种 URL 模式。您需要在每个位置之间进行选择。

我会为猫和狗使用不同的 URL 模式，两者都会调用`'create_update.update_object'`; 但对每个使用不同`dict`的。一个与`'model':Dog`另一个与`'model':Cat`

或者您可能想要一个表，其中每条记录都可以是猫或狗？我认为您不能为此使用继承的模型。

# visual-studio-2008 - Silverlight 日历控件在哪里？

> ID：213238
> 
> 赞同：5
> 
> 时间：2008-10-17T18:16:08.517
> 
> 标签：visual-studio-2008, silverlight, xaml

只是在玩现在发布的 Silverlight 2.0。我正在尝试将一个简单的日历放入控件中。但是该项目似乎不知道我在说什么：-

```
<UserControl x:Class="MyFirstSL2.Test"
 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
>
  <Grid Background="#FF5C7590">
    <Calendar />
  </Grid>
</UserControl> 
```

Visual Studio 2008 只是在日历下放了蓝线，表示找不到日历类型。我需要添加一个程序集吗？哪一个？我是否需要向 Xaml 添加另一个命名空间？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T19:46:40.207

日历控件是程序集 System.Windows.Controls 命名空间中的 SDK 控件 - 查看 %program files%\Microsoft SDKs\Silverlight\v2.0\Libraries\Client 将命名空间添加到您的 xaml（添加引用后） ：

```
xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls" 
```

然后使用：

```
<basics:Calendar /> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-09T15:00:09.060

添加参考

C:\Program Files\Microsoft SDKs\Silverlight\v2.0\Libraries\Client

system.windows.controls.dll

使用 Expressions Blend 或 VS2008 SP1 将控件添加到 UI

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:30:00.267

我很确定 Silverlight 中没有类似于 ASP.Net 控件或 Windows 窗体控件的日历控件。我很确定没有像 WPF 这样的预打包控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-28T19:23:45.680

我没有试图弄清楚该工具包如何允许嵌入日历控件，而是在[http://slcalendarcontrol.codeplex.com/](http://slcalendarcontrol.codeplex.com/)此处创建了一个自定义控件，请查看。

# php - 解析文件中的嵌套标签

> ID：213249
> 
> 赞同：1
> 
> 时间：2008-10-17T18:18:49.027
> 
> 标签：php, parsing, recursion, templates, nested

我想知道-解析以下内容的最有效方法是什么：

```
{{HEADER}}

Hello my name is {{NAME}}

{{#CONTENT}}
    This is the content ...

    {{#PERSONS}}

        <p>My name is {{NAME}}.</p>

    {{/PERSONS}}

{{/CONTENT}}

{{FOOTER}} 
```

当然，这最终是为了成为一个模板系统，所以我的计划是创建一个哈希图来“覆盖”模板，就像这样

```
$hash = array(
    'HEADER' => 'This is a header',
    'NAME' => 'David',
    'CONTENT' => array('PERSONS' => array(array('NAME' => 'Heino'), array('NAME' => 'Sebastian')),
    'FOOTER' => 'This is the footer'
    ); 
```

值得注意的是，“部分”（以#开头的标签）可以重复多次，我认为这就是让我绊倒的原因......

此外，任何部分都可以包含任意数量的其他部分，以及常规标签......

所以..你是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T18:42:27.560

是这样的预期输出：

这是一个标题

你好，我的名字是大卫

```
This is the content ...

My name is Heino.

My name is Sebastian. 
```

这是页脚

* * *

您如何管理哈希映射中的嵌套数组与模板中可重复部分的关系？模板的实际行为应该是什么？如果为非节元素提供了一个数组，它会做什么？如果为一个部分元素提供了一个值，它是否会被视为只有一个元素的数组（我假设是这样）？

无论如何，关于模板的解析器（不管你最终对数据的映射做了什么）......我要做的是为每种类型的令牌创建一个类，包括一个用于非令牌内容的通用类. 这些将从具有可重写 Parse、Render 和 Map 方法的公共令牌基类继承。

绘制您的状态图并找出每个状态的入口和出口点，然后将其编码到令牌之间的调用结构中。最后，您希望生成描述模板的可枚举标记集合。

一旦您以抽象形式获得它，您可以遍历集合调用 Map 上的标记以将数据从 hashmap 分配给标记，然后调用 Render 将模板呈现为最终形式。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:43:31.097

最有效的方法是将模板**编译**为 php 代码。并且只**包括**编译后的版本。

[Smarty 模板引擎](http://www.smarty.net)做了类似的事情。您还可以查看 smarty 源代码并检查它们如何解析标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T18:22:47.567

您最好使用 XML 或 JSON 之类的现有解析器，这样您就不必编写自己的解析器，这样其他人就可以轻松地为您的解析器编写文档，而无需专门的工具。但是，如果您想编写自己的解析器，您可能需要考虑使用[Lex](http://en.wikipedia.org/wiki/Lex_programming_tool)和[Yacc](http://en.wikipedia.org/wiki/Yacc)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:42:04.970

我会使用第三方解析器，因为我喜欢更聪明而不是更努力地工作，但如果你这样做是为了练习，或者你真的想构建自己的模板引擎（我假设在 PHP 中是因为标签），我将从审查设计模式开始，特别是[复合设计模式](http://en.wikipedia.org/wiki/Composite_pattern)。

复合模式在 Java 框架中被大量使用，包括 XML 解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T19:43:44.847

我会在 .php 单独的文件中使用这样的东西：

```
<?php echo $HEADER ?>

Hello my name is <?php echo $NAME?>

<div id="CONTENT">
    This is the content ...

    <?php foreach ($PERSONS as $PERSON) : ?>

        <p>My name is <?php echo $PERSON['NAME']?>.</p>

    <?php endforeach ?>

</div>

<?php echo $FOOTER ?> 
```

只需将上述文件包含在填充引用变量的文件中即可。

信不信由你，PHP 已经提供了模板系统声称要实现的所有功能。无需在 PHP 之上添加另一层抽象（和复杂性）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T20:08:11.333

我为此使用[PHP 的 DOM](http://php.net/dom)。我的模板语言只是带有 ID 和类属性的 HTML。但是，如果你想坚持你的计划，我会使用[preg_replace_callback](http://php.net/preg_replace_callback)与一个匹配你的语法的模式和一个在你的哈希中找到适当替换的回调函数，在容器元素上递归地调用自己。

# flash - 有人可以发布格式良好的 crossdomain.xml 示例吗？

> ID：213251
> 
> 赞同：80
> 
> 时间：2008-10-17T18:19:28.463
> 
> 标签：flash, crossdomain.xml

我一直在阅读 Adob​​e 在 Flash 9-10 中使 crossdomain.xml 更加严格，我想知道有人可以向我粘贴他们知道有效的副本。在 Adob​​e 的网站上查找最近的示例时遇到了一些麻烦。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-17T18:23:37.690

这是我一直用于开发的：

```
<?xml version="1.0" ?>
<cross-domain-policy>
<allow-access-from domain="*" />
</cross-domain-policy> 
```

这是一种非常自由的方法，但对我的应用程序来说很好。

**正如其他人在下面指出的那样，请注意这种风险。**

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-18T18:00:40.167

如果您使用 Web 服务，您还需要 'allow-http-request-headers-from' 元素。这是我们的默认开发，“允许一切”政策。

```
<?xml version="1.0" ?>
<cross-domain-policy>
  <site-control permitted-cross-domain-policies="master-only"/>
  <allow-access-from domain="*"/>
  <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2011-03-29T12:21:51.173

看看推特的：

[http://twitter.com/crossdomain.xml](http://twitter.com/crossdomain.xml)

```
<?xml version="1.0" encoding="UTF-8"?>
<cross-domain-policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.adobe.com/xml/schemas/PolicyFile.xsd">
    <allow-access-from domain="twitter.com" />
    <allow-access-from domain="api.twitter.com" />
    <allow-access-from domain="search.twitter.com" />
    <allow-access-from domain="static.twitter.com" />
    <site-control permitted-cross-domain-policies="master-only"/>
    <allow-http-request-headers-from domain="*.twitter.com" headers="*" secure="true"/>
</cross-domain-policy> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-21T13:41:35.147

在生产现场，这似乎很合适：

```
<?xml version="1.0"?>
<cross-domain-policy>
<allow-access-from domain="www.mysite.com" />
<allow-access-from domain="mysite.com" />
</cross-domain-policy> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-07-18T05:52:47.090

A version of **crossdomain.xml** used to be packaged with the [HTML5 Boilerplate](https://html5boilerplate.com/) which is *the product of many years of iterative development and combined community knowledge.* However, it has since been deleted from the repository. I've copied it verbatim here, and included a link to the commit where it was deleted below.

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <!-- Read this: https://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html -->

  <!-- Most restrictive policy: -->
  <site-control permitted-cross-domain-policies="none"/>

  <!-- Least restrictive policy: -->
  <!--
  <site-control permitted-cross-domain-policies="all"/>
  <allow-access-from domain="*" to-ports="*" secure="false"/>
  <allow-http-request-headers-from domain="*" headers="*" secure="false"/>
  -->
</cross-domain-policy> 
```

Deleted in #1881
[https://github.com/h5bp/html5-boilerplate/commit/58a2ba81d250301e7b5e3da28ae4c1b42d91b2c2](https://github.com/h5bp/html5-boilerplate/commit/58a2ba81d250301e7b5e3da28ae4c1b42d91b2c2)

# c# - 如何确定 Windows 应用程序是否在屏幕外？

> ID：213256
> 
> 赞同：5
> 
> 时间：2008-10-17T18:20:37.103
> 
> 标签：c#, .net, c++, windows, winapi

我正在尝试为安装了[LogMeIn](https://secure.logmein.com/home.asp)的用户调试一个奇怪的问题。几天后，我的应用打开的一些对话框可能会在屏幕外结束。如果我能可靠地检测到这一点，我可以以编程方式将对话框移回它们再次可见的位置。

注意：这必须适用于多台显示器并使用 win32 API。但是，如果您知道如何从 .NET 执行此操作，我可能可以从那里推断...

**更新：**出于好奇，上面提到的错误与 wxWidgets 有关。如果你运行一个 wxWidgets 应用程序，然后走开，让你的屏幕保护程序消失，然后使用 LogMeIn 远程登录，然后尝试从你的应用程序打开一个对话框，如果你使用 wxDisplay::GetFromPoint(pos) 或 wxWindowBase，你会遇到麻烦::Center() 定位对话框。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T19:20:02.927

Simply use MonitorFromWindow with the MONITOR_DEFAULTTONULL flag. If the return value is null, your window is not visible. You can subsequently pass MONITOR_DEFAULTTONEAREST to be able to reposition your window on the nearest monitor.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T19:11:01.167

1997 年 6 月 Microsoft Systems Journal 中有关多显示器支持的所有基础知识：

*   [http://www.microsoft.com/msj/0697/monitor/monitor.aspx](http://www.microsoft.com/msj/0697/monitor/monitor.aspx)

Positioning Objects on a Multiple Display Setup:

*   [http://msdn.microsoft.com/en-us/library/ms534817(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms534817(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T18:53:36.773

在 .NET 中，您使用 Screen.PrimaryScreen.WorkingArea 结构来获取主屏幕的边界（我认为其他监视器的 Screen.Screens[x].WorkingArea），然后使用窗口的 Left 和 Top 属性找出窗口在哪里（如果它不在屏幕上，Top 和 Left 将大于 [Screen].Width 和 .Height。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T18:57:23.037

在 .NET 中，我会在 Screen.AllScreen 中的每个 Screen 上进行迭代，然后调用 screen.Bounds.Contains()，如果你想确保所有窗口都在 bounds(*) 内，则传递你的表单的矩形，或者调用 screen.Bounds.Contains()。 Bounds.IntersectsWith() 如果您只想确保表单的至少一部分是可见的。

(*) 不完全在一个屏幕范围内并不意味着它不在总屏幕范围内。您还可以在每个屏幕边界上调用 Rectangle.Union 来创建一个矩形来测试表单的矩形，但是您必须注意屏幕边界的大小是否不同，因为 englobing 矩形也不是完全可见的。

那是更长的答案。较短的是：我知道没有简单的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T19:58:01.807

Whatever you do, please account for multiple monitors which may have coordinates thousands of pixels away from (0,0) in any direction. I hate it when an app forces itself back into another screen, frequently messing up any full-screen games I may be in at the time.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-28T03:37:25.543

See also [How can I get the active screen dimensions?](https://stackoverflow.com/questions/254197/how-can-i-get-the-active-screen-dimensions)

This is the code I used in the form constructor it's a quickie to move the form to a visible screen after you undock your laptop or whatever it is you did to make some screen real estate go away. Refine for your own consumption.

```
if (!Screen.FromControl(this).Bounds.Contains(this.Location))
            {
                this.DesktopLocation = new Point(100,100);
            } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T19:02:45.850

看起来[GetMonitorInfo()](http://msdn.microsoft.com/en-us/library/ms534599(VS.85).aspx)是 Danny 建议的 Win32 等价物。我不确定您将如何为系统上的所有监视器获取 HMONITOR，但看起来文档中链接的示例有一些方法可以做到这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-04T09:47:01.027

This is a long time ago now, but Marin Plante's answer got me what I needed, so I wrote a simple extension method:

```
public static class WindowLocation
{
    public static Boolean VisibleOnScreen(this Form form)
    {
        foreach (Screen screen in Screen.AllScreens)
        {
            if (screen.Bounds.Contains(form.Bounds)) return true;
        }

        return false;
    }
} 
```

May help someone else!

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-17T18:37:00.033

唔。这可能没有帮助，但是当我做 VB 时，你可以做 screen.width 和 screen.height，然后是 window.x 和 window.y...

当然，我不知道多显示器如何工作。

# .net - 在 HttpBinding 中进行 HTTP 身份验证之前在 WCF 中操作 HTTP 标头

> ID：213259
> 
> 赞同：3
> 
> 时间：2008-10-17T18:21:08.430
> 
> 标签：.net, wcf, http-headers, wcf-binding

这与[这个问题有关](https://stackoverflow.com/questions/209795)

我在自定义服务主机中托管此 WCF 服务。IIS 不是一个选项。

**有没有办法在请求过程的早期在服务器堆栈**中注入 HTTP“Authenticate”标头（如果它丢失） - 这样可以将默认用户传递到我为匿名请求设置的身份验证/授权过程中?

我需要服务器在接收端注入这个 - 在进一步的 WCF 处理之前......

我很确定我可以使用自定义 BindingElement 或通过扩展 WebHttpBinding 来做到这一点，但任何示例或指导将不胜感激。我在 WCF 中找不到任何早期标头操作（预身份验证）的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T20:42:51.340

通过实现 IDispatchMessageInspector，您可以插入管道服务器端；和操纵消息。

在 AfterReceiveRequest 方法中，您可以非常愉快地添加到 Request.Headers 中。

用行为属性包装它并将其应用于您的服务。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-21T11:53:41.110

我会输入这个，但它很多。所以这里有一个很好的参考。

Avner Kashtan 的博客文章概述了我“认为”您正在寻找的内容。希望这会有所帮助！

[向每个 WCF 调用添加自定义标头](http://weblogs.asp.net/avnerk/archive/2006/04/26/Adding-custom-headers-to-every-WCF-call-_2D00_-a-solution.aspx)

# java - 如何在屏幕上居中 JDialog？

> ID：213266
> 
> 赞同：86
> 
> 时间：2008-10-17T18:22:21.873
> 
> 标签：java, swing

如何将 JDialog 定位在屏幕中央？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2008-10-17T18:27:27.573

在 Java 1.4+ 中，您可以执行以下操作：

```
final JDialog d = new JDialog();
d.setSize(200,200);
d.setLocationRelativeTo(null);
d.setVisible(true); 
```

或者也许（1.4 之前）：

```
final JDialog d = new JDialog();
d.setSize(200, 200);
final Toolkit toolkit = Toolkit.getDefaultToolkit();
final Dimension screenSize = toolkit.getScreenSize();
final int x = (screenSize.width - d.getWidth()) / 2;
final int y = (screenSize.height - d.getHeight()) / 2;
d.setLocation(x, y);
d.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-10T13:06:41.587

在方法之后使用这一行`pack()`：

```
setLocation((Toolkit.getDefaultToolkit().getScreenSize().width)/2 - getWidth()/2, (Toolkit.getDefaultToolkit().getScreenSize().height)/2 - getHeight()/2); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-03-06T04:30:27.853

用于在屏幕或父对象内居中的两个助手。

```
// Center on screen ( absolute true/false (exact center or 25% upper left) )
public void centerOnScreen(final Component c, final boolean absolute) {
    final int width = c.getWidth();
    final int height = c.getHeight();
    final Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    int x = (screenSize.width / 2) - (width / 2);
    int y = (screenSize.height / 2) - (height / 2);
    if (!absolute) {
        x /= 2;
        y /= 2;
    }
    c.setLocation(x, y);
}

// Center on parent ( absolute true/false (exact center or 25% upper left) )
public void centerOnParent(final Window child, final boolean absolute) {
    child.pack();
    boolean useChildsOwner = child.getOwner() != null ? ((child.getOwner() instanceof JFrame) || (child.getOwner() instanceof JDialog)) : false;
    final Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    final Dimension parentSize = useChildsOwner ? child.getOwner().getSize() : screenSize ;
    final Point parentLocationOnScreen = useChildsOwner ? child.getOwner().getLocationOnScreen() : new Point(0,0) ;
    final Dimension childSize = child.getSize();
    childSize.width = Math.min(childSize.width, screenSize.width);
    childSize.height = Math.min(childSize.height, screenSize.height);
    child.setSize(childSize);        
    int x;
    int y;
    if ((child.getOwner() != null) && child.getOwner().isShowing()) {
        x = (parentSize.width - childSize.width) / 2;
        y = (parentSize.height - childSize.height) / 2;
        x += parentLocationOnScreen.x;
        y += parentLocationOnScreen.y;
    } else {
        x = (screenSize.width - childSize.width) / 2;
        y = (screenSize.height - childSize.height) / 2;
    }
    if (!absolute) {
        x /= 2;
        y /= 2;
    }
    child.setLocation(x, y);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T16:03:25.450

这是我用多个显示器检索屏幕尺寸的解决方案。

```
import java.awt.*;
import javax.swing.JFrame;

/**
 * Méthodes statiques pour récupérer les informations d'un écran.
 *
 * @author Jean-Claude Stritt
 * @version 1.0 / 24.2.2009
 */
public class ScreenInfo {

  /**
   * Permet de récupérer le numéro de l'écran par rapport à la fenêtre affichée.
   * @return le numéro 1, 2, ... (ID) de l'écran
   */
  public static int getScreenID( JFrame jf ) {
    int scrID = 1;
    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    GraphicsDevice[] gd = ge.getScreenDevices();
    for (int i = 0; i < gd.length; i++) {
      GraphicsConfiguration gc = gd[i].getDefaultConfiguration();
      Rectangle r = gc.getBounds();
      if (r.contains(jf.getLocation())) {
        scrID = i+1;
      }
    }
    return scrID;
  }

  /**
   * Permet de récupérer la dimension (largeur, hauteur) en px d'un écran spécifié.
   * @param scrID --> le n° d'écran
   * @return la dimension (largeur, hauteur) en pixels de l'écran spécifié
   */
  public static Dimension getScreenDimension( int scrID ) {
    Dimension d = new Dimension(0, 0);
    if (scrID > 0) {
      GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
      DisplayMode mode = ge.getScreenDevices()[scrID - 1].getDisplayMode();
      d.setSize(mode.getWidth(), mode.getHeight());
    }
    return d;
  }

  /**
   * Permet de récupérer la largeur en pixels d'un écran spécifié.
   * @param scrID --> le n° d'écran
   * @return la largeur en px de l'écran spécifié
   */
  public static int getScreenWidth( int scrID ) {
    Dimension d = getScreenDimension(scrID);
    return d.width;
  }

  /**
   * Permet de récupérer la hauteur en pixels d'un écran spécifié.
   * @param scrID --> le n° d'écran
   * @return la hauteur en px de l'écran spécifié
   */
  public static int getScreenHeight( int scrID ) {
    Dimension d = getScreenDimension(scrID);
    return d.height;
  }

} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-18T22:02:59.647

AFAIK 您可以将 GraphicEnvironment 传递给每个 JDialog/JFrame/JWindow 构造函数。此对象描述要使用的监视器。

# emacs - 如何将函数作为参数传递给 elisp？

> ID：213267
> 
> 赞同：21
> 
> 时间：2008-10-17T18:22:27.710
> 
> 标签：emacs, elisp

我试图在 elisp 中将一种方法传递给另一种方法，然后让该方法执行它。这是一个例子：

```
(defun t1 ()
  "t1")

(defun t2 ()
  "t1")

(defun call-t (t)
  ; how do I execute "t"?
  (t))

; How do I pass in method reference?
(call-t 't1) 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-17T19:21:06.920

首先，我不确定命名你的函数`t`是否有帮助，因为 't' 被用作 lisp 中的[真值](http://www.mcs.vuw.ac.nz/cgi-bin/info2www?(elisp)nil+and+t)。

也就是说，以下代码对我有用：

```
(defun test-func-1 ()  "test-func-1"
   (interactive "*")
   (insert-string "testing callers"))

(defun func-caller (callee)
  "Execute callee"
  (funcall callee))

(func-caller 'test-func-1) 
```

请注意“funcall”的使用，它会触发实际的函数调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T17:25:54.670

[Emacs Lisp 手册中“](https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html#SEC_Contents) [§13.7 Anonymous Functions](https://www.gnu.org/software/emacs/manual/html_node/elisp/Anonymous-Functions.html#index-_0023_0027-syntax) ”末尾的注释说，您可以引用函数而不是向字节编译器发出符号始终命名函数的信号。`#'``'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-03T10:29:20.767

Above answers are okey, but you can do something more interesting with defmacro, wich evaluates functions later for some reason:

```
(defun n1 ()
  "n1")

(defmacro call-n (n)
  (apply n))

(call-n (n1)) 
```

A practical example with a for loop that takes any amount of functions and their arguments:

```
(defmacro for (i &optional i++ &rest body)
  "c-like for-loop"
  (unless (numberp i++) (push i++ body) (setq i++ 1))

  (while (/= i 0)
    (let ((args 0))
      (while (nth args body)
    (apply (car (nth args body))
           (cdr (nth args body)))
    (setq args (1+ args))))
    (setq i (- i i++))
    )
  ) 
```

# javascript - window.ScrollMaxY 或 X - 如何在 FireFox 3 中设置？

> ID：213271
> 
> 赞同：0
> 
> 时间：2008-10-17T18:23:26.317
> 
> 标签：javascript, firefox

window.scrollMaxY 可以在 IE 和旧版本的 Firefox 中通过该属性进行设置，但在 FF3 中尝试时会显示“无法设置此属性，因为它只有一个 getter”。

我的替代方案是什么？

编辑：

我问的原因是我正在修复一些由其他人编写的非常糟糕的 JS，它具有在滚动时将 div 保持在页面中心的功能，并且具有以下行：

```
// Fixes Firefox incrementing page height while scrolling
window.scrollMaxY = scrollMaxY 
```

显然这不起作用，但主要问题是当页面滚动时，它的长度会增长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:19:24.687

听起来您正在寻找的是不同的 CSS。与其试图弯曲浏览器以适应 HTML，不如为实际问题找到更好的解决方案会更容易；保持 div 就位。

要相对于窗口定位元素，请使用`position: fixed;`

我的猜测是，您正在查看的代码最初是缺乏[对固定定位支持](http://www.quirksmode.org/css/contents.html#t117)的解决方法（IE6 不支持它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T18:31:33.853

> window.scrollMaxY 可以在 IE 和旧版本的 Firefox 中通过该属性进行设置

我认为这在 IE 中根本不存在。

*如果我在读取它的值之前*尝试在 FF3 中修改它，那么我可以这样做，尽管改变它没有明显的效果。

如果我在访问它的值之前为其分配一个值，我就可以这样做。一旦我成功地为它分配了一个值，我就可以查询和修改它的值，尽管浏览器将不再更新它以反映窗口的实际滚动限制——这种行为似乎是为了兼容性而存在的使用可能在其他浏览器中使用此变量名称的代码，而不期望它是预定义的。

你希望修改它做什么？

（在 IE6 / FF3 中测试，答案已修改为注意查询前与查询后的行为）

# c# - 如何从 ArrayList 创建逗号分隔的字符串？

> ID：213295
> 
> 赞同：85
> 
> 时间：2008-10-17T18:28:38.757
> 
> 标签：c#, vb.net, parsing

我将 Id 的 ArrayList 存储在处理脚本中，我想将其作为逗号分隔列表吐出，以输出到调试日志。有没有一种方法可以让我轻松获得这个而无需循环访问？

编辑：感谢 Joel 指出 .net 2.0 及更高版本中可用的 List(Of T)。如果你有它，这会让事情变得更容易。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-10-17T18:30:26.290

是的，我正在回答我自己的问题，但我还没有在这里找到它，并认为这是一件相当巧妙的事情：

...在 VB.NET 中：

```
String.Join(",", CType(TargetArrayList.ToArray(Type.GetType("System.String")), String())) 
```

...在 C# 中

```
string.Join(",", (string[])TargetArrayList.ToArray(Type.GetType("System.String"))) 
```

唯一的“问题”是，如果您使用 Option Strict 来确保正确进行转换，则 ArrayList 必须将项目存储为字符串。

编辑：如果您使用的是 .net 2.0 或更高版本，只需创建一个 List(Of String) 类型的对象，您就可以获得所需的内容。非常感谢乔尔提出这个问题！

```
String.Join(",", TargetList.ToArray()) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-17T19:03:14.193

到目前为止的解决方案都相当复杂。惯用的解决方案无疑应该是：

```
String.Join(",", x.Cast(Of String)().ToArray()) 
```

在新的框架版本中不需要花哨的杂技。假设一个不那么现代的版本，以下将是最简单的：

```
Console.WriteLine(String.Join(",", CType(x.ToArray(GetType(String)), String()))) 
```

mspmsp 的第二个解决方案也是一个不错的方法，但它不起作用，因为它错过了`AddressOf`关键字。此外，`Convert.ToString`效率相当低（许多不必要的内部评估），并且`Convert`该类通常设计得不是很干净。我倾向于避免它，特别是因为它完全是多余的。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-17T18:33:45.580

就像是：

```
String.Join(",", myArrayList.toArray(string.GetType()) ); 
```

这基本上是循环你知道的......

**编辑**

怎么样：

```
string.Join(",", Array.ConvertAll<object, string>(a.ToArray(), Convert.ToString)); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-02-04T10:19:15.680

`string.Join(" ,", myArrayList.ToArray());` 这将适用于 .net 框架 4.5

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T18:47:22.603

```
foo.ToArray().Aggregate((a, b) => (a + "," + b)).ToString() 
```

或者

```
string.Concat(foo.ToArray().Select(a => a += ",").ToArray()) 
```

更新，因为这是非常旧的。当然，您现在应该使用 string.Join。在撰写本文时，它不作为一种选择存在。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-17T13:04:04.763

这是一个简单的示例，演示了使用 String.Join() 从字符串列表中创建逗号分隔的字符串：

```
List<string> histList = new List<string>();
histList.Add(dt.ToString("MM/dd/yyyy::HH:mm:ss.ffff"));
histList.Add(Index.ToString());
/*arValue is array of Singles */
foreach (Single s in arValue)
{
     histList.Add(s.ToString());
}
String HistLine = String.Join(",", histList.ToArray()); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-09T06:33:56.793

到目前为止，我发现这是一个很好且快速的解决方案

```
//CPID[] is the array
string cps = "";
if (CPID.Length > 0)
{   
    foreach (var item in CPID)
    {
        cps += item.Trim() + ",";
    }
}
//Use the string cps 
```

# asp.net - .NET AJAX 1.0 Aysc 回调在使用 Server.Transfer 时修改表单操作

> ID：213297
> 
> 赞同：0
> 
> 时间：2008-10-17T18:28:51.330
> 
> 标签：asp.net, asp.net-ajax

我有一个 Web 表单，我试图在使用 .NET AJAX 1.0 扩展时实现动态下拉列表。我已经成功实现了所需的位，但有一个有趣的怪癖。

当我从我的第一个下拉列表中选择一个值时，我的回调就会发生并且我的页面会正确更新。我选择的下一个值，我收到以下错误：

> Sys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误。返回的状态码是：404

不管我首先使用什么控件，第一个请求有效，第二个无效。查看我的 IIS 日志，我看到以下几行：

> 2008-10-17 14:52:14 W3SVC1 127.0.0.1 POST /Aware/Xtend/mParticipant/NewPlannedService.aspx WIN=Participant_1224255079212&Title=Participant 80 - 127.0.0.1 200 0 0
> 
> 2008-10-17 14:52:20 W3SVC1 127.0.0.1 POST /Aware/mParticipant/NewPlannedService.aspx WIN=Participant_1224255079212&Title=参与者 80 - 127.0.0.1 404 0 0

如您所见，我的帖子 URL 已完全更改。使用 Fiddler 观察请求/响应，我可以在服务器的响应中看到这一点：

> |formAction||NewPlannedService.aspx|

这只是正在执行的页面的名称，相对路径和查询字符串已被删除。

我可以通过将以下内容添加到异步回调方法的末尾来解决此问题：

```
this.Form1.Action = Request.Url.PathAndQuery 
```

但这对我来说似乎非常蹩脚，闻起来有点像发霉的奶酪。任何人都可以指出我正确的方向吗？

**更新：**经过进一步检查，我发现 NewPlannedService.aspx 不是原来的执行页面。Page1.aspx 正在执行，然后调用 Server.Transfer("/folder/NewPlannedService.aspx")。所以浏览器中的 URI 是[http://whatever.com/Page1.aspx](http://whatever.com/Page1.aspx)，但实际执行的页面是[http://whatever.com/folder/NewPlannedService.aspx](http://whatever.com/folder/NewPlannedService.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T00:43:56.067

为了解决这个问题，我使用以下代码创建了一个名为 Ajax.Server.Transfer.Fixer.js 的 javascript 文件：

```
var orginalFormAction = null;

//capture the current form action value
function BeginRequestHandler() {
  orginalFormAction = theForm.action;
}

//set the form action value back to the
//correct value
function EndRequestHandler() {
  theForm.action = orginalFormAction;
  theForm._initialAction = orginalFormAction;
}

function RegisterRequestHandlers() {

  if (typeof (Sys) != "undefined") {

    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);
    Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);
    Sys.Application.notifyScriptLoaded();

  }
}

//register request handlers after the application 
//has successfully loaded.
Sys.Application.add_load(RegisterRequestHandlers); 
```

然后将以下行添加到我的 Page_Load 事件中：

```
protected void Page_Load(object sender, EventArgs e)
    {
      PageScriptManager.Scripts.Add(
        new ScriptReference("~/Script/Ajax.Server.Transfer.Fixer.js")
        );
    } 
```

# tcp - MMORPG 客户端/服务器编码

> ID：213298
> 
> 赞同：13
> 
> 时间：2008-10-17T18:28:55.637
> 
> 标签：tcp, udp, client

MMORPG 客户端/服务器通信中如何使用 UDP 和 TCP 协议？

例如：

客户端是否通过 UDP 向服务器广播（玩家位置等）？或相反亦然？

还是更像是在客户端请求服务器移动播放器时使用 TCP。服务器接收到请求，移动播放器并向客户端返回播放器现在位于 xyz 位置？

聊天频道必须使用 TCP 实现吗？

有没有这方面的好文章/书籍？我找到了零碎的东西，但似乎真正的肉和土豆是从经验中获得的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T18:44:28.913

许多游戏使用 UDP 进行与运动相关的活动——因此，例如，当你走路时，很可能会发送一堆 UDP 请求。服务器仍然最终控制这是否有效，但您不必关心每个数据包是否到达服务器。这就是为什么很多游戏客户端也使用某种预测机制的原因。

就您的第二次提及而言，是的，所有控件都由服务器管理是很常见的。您不希望客户端向服务器广播任何内容；您应该在服务器端进行错误和输入处理，以防止人们被黑客入侵。您还可以限制每秒输入。

无论如何，UDP 和 TCP 的组合是合适的——你只需要问自己，“我想要可靠性还是速度？”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T18:45:03.683

有许多不同的可能实现，但在大多数情况下，它们看起来像这样。这种模式在游戏世界中几乎所有动作都会重复出现。

1.  客户端与玩家想要移动的服务器进行通信。
2.  客户端根据它认为应该发生的情况显示玩家移动。
3.  鉴于玩家的位置，服务器会验证移动是否可能发生。
4.  就服务器而言，服务器向客户端更新玩家所在的位置。
5.  客户端更新玩家位置以反映服务器的世界状态。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T18:45:36.600

您不能依赖客户传递真实信息。有人会破解协议并作弊。加密数据不会阻止这一点——只是让它更难做。

客户端应该只发送移动请求等，服务器需要对请求进行健全性检查，以确保它们不违反游戏规则。服务器应该只发回客户端绝对需要的数据——你不能依赖客户端来获取大量的世界数据，而只是过滤掉玩家当前无法观察到的所有内容。有人会掌握额外的信息并加以利用。

如果游戏需要“实时”，那么客户端需要假设服务器将允许移动请求并相应地更新显示 - 如果服务器稍后更正它，则回滚移动。在大多数情况下，客户端和服务器会达成一致，一切都会顺利进行。当客户试图作弊时（无论如何这是他们的错），他们不会同意 - 或者客户由于连接不良而严重滞后（您对此无能为力）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T18:39:04.400

您的一半问题（使用的传输层协议）可以通过安装wireshark 并查看流量来回答。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T18:45:33.933

您可能对[Project Darkstar](http://projectdarkstar.com/)感兴趣。这是一个开源的 MMO 框架。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T18:58:26.717

我认为您可以从阅读其他人如何实现这些类型的系统中学**到很多东西。**徒劳无功，我可以向您指出蒂姆·斯威尼（*Tim Sweeney）*和槌球联盟（ *The Croquet Consortium ）的工作*

1.  [虚幻网络架构](http://unreal.epicgames.com/Network.htm)
2.  [槌球项目](http://en.wikipedia.org/wiki/Croquet_Project)

Tim Sweeney 的论文改变了我对编程的看法。我不能推荐他们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T18:39:47.800

除了作为玩家的观察之外，我不知道任何细节，但大多数游戏绝对不会等待服务器回复来移动角色，除非它是基于回合制的，否则会扼杀用户体验。看起来发生的事情是移动在客户端完成并发送到服务器，然后服务器将这些消息发送给其他玩家。至少在《魔兽世界》中，如果玩家落后，您可能会看到他们仍在向前移动，然后稍后神奇地出现在另一个位置，这对我来说意味着客户端收到的不仅仅是位置数据，还有他们正在移动以及他们移动的方向然后在没有进一步数据的情况下推断运动。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T18:44:06.590

你最好的选择可能是看看 Planeshift 的网络代码，它是一个开源的 MMO。我相信它是现场最发达的（最后我检查过）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T18:46:00.267

我认为这个问题没有一个简短的单一答案，它的范围相当广泛。尽管如此，还是有几点：

*   没有必要仅仅因为您使用 UDP 而“广播”。根据我的经验，UDP 大部分时间都是点对点的。
*   完全可以通过 UDP 进行自己的“安全”通信，而不必使用 TCP。这并不神奇，只是……聪明而复杂。:) 但在大多数情况下，正如您所暗示的那样，TCP 不适合游戏中的实时通信。
*   有一些方法可以使 TCP 更适合，例如搜索“Nagle 算法”。
*   如果您已经在其上推出了自己的无损传输协议，则可以通过 UDP 进行聊天。很多游戏都这样。

Gamasutra 有关于网络的文章，但我现在没有任何方便的链接。不确定它们是否仍然公开可用，抱歉。

# .net - ASP.NET 2.0 回调在 Firefox 中无法正常工作

> ID：213299
> 
> 赞同：2
> 
> 时间：2008-10-17T18:29:13.903
> 
> 标签：.net, ajax, firefox, callback

我已经实现了一个 .NET Web 控件，它使用在 ASP.Net 2.0 中实现的回调结构。它是一个自动下拉控件，在 IE 6.0/7.0 和 Google Chrome 中可以正常工作。这是相关的回调函数：

```
function ReceiveServerData(args, context)
{
document.getElementById(context).style.zIndex = 300;
document.getElementById(context).style.visibility = 'visible';
document.getElementById(context).innerHTML = args;
fixHover(context);
} 
```

在 Firefox 中，“args”始终是相同的数据，因此`<div>`作为我的下拉菜单显示的 innerHTML 始终显示相同的项目。我已经仔细检查了我的客户端代码，并且正确的信息被发送到客户端->服务器并返回服务器->客户端。

值得注意的是，在 .NET 框架创建的“WebForm_DoCallback”函数中，调用了以下代码片段：

```
if (setRequestHeaderMethodExists) {
xmlRequest.onreadystatechange = WebForm_CallbackComplete;
callback.xmlRequest = xmlRequest;
xmlRequest.open("POST", theForm.action, true);
xmlRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
xmlRequest.send(postData);
return;
} 
```

`xmlRequest.open("POST", theForm.action, true);`并且回调函数 ReceiveServerData 在和上都被调用`xmlRequest.send(postData);`。我想知道这是否会导致错误，但我的调试技能已经结束。

编辑添加——第一次使用下拉菜单时，ReceiveServerData 没有被调用两次——事实上，下拉菜单在第一次击键时就可以正常工作。在第一次击键后，它停止工作，并使用旧的返回数据使回调加倍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T18:46:07.273

值得一提的是，MS AJAX Function.createCallback() 在 FireFox 中似乎无法正常工作。在这里看到这篇文章，带有复制代码：

[Function.createCallback 未在 FireFox 中正确传递上下文](https://stackoverflow.com/questions/969326/function-createcallback-doesnt-pass-context-correctly-in-firefox/969362#969362)

似乎上下文变量在传递给回调函数时会丢失其状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T21:54:27.670

我不确定这是否会有所帮助，但我已经像这样（缩小代码）修补了 ASP.NET 2.0 回调：

```
function WebForm_CallbackComplete()
{
    for(var i=0; i< __pendingCallbacks.length;i++)
    {
        var _f3=__pendingCallbacks[i];
        if(_f3 && _f3.xmlRequest && (_f3.xmlRequest.readyState==4))
        {
            __pendingCallbacks[i]=null;
            WebForm_ExecuteCallback(_f3);
            if(!_f3.async)
            {
                __synchronousCallBackIndex=-1;
            }
            var _f4="__CALLBACKFRAME"+i;
            var _f5=document.getElementById(_f4);
            if(_f5)
            {
                _f5.parentNode.removeChild(_f5);
            }
        }
    }
} 
```

如果您检查 WebForm_CallbackComplete 的实际实现，您会发现一些问题。您可以尝试将该 JavaScript 粘贴到您的表单标记中，看看它是否会有所作为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T03:46:12.623

我认为您需要提供更多信息，这个问题可能不太可能是因为 asp.net 的内置 js。如何设置事件以捕获击键，您是否意外添加了事件？它是如何调用脚本服务的？只需仔细检查所有基础知识，以确保它不是那种疯狂和简单的事情。

# flash - Flash 开发人员：你用什么版本的 Flash 来测试你的东西？

> ID：213302
> 
> 赞同：1
> 
> 时间：2008-10-17T18:29:28.677
> 
> 标签：flash, gnash

我很好奇用什么版本的 Flash 测试。你如何在不同的浏览器上管理它？

我想用 swfdec 和 gnash 测试东西，希望也许有一些我不知道的方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T01:03:06.870

我运行的所有测试都是通过 IE 7、Firefox 2 和 3、Safari、Google Chrome 和独立播放器进行的。我使用的 Flash Player 版本是 9（始终是最后一个版本），现在我使用 Flash Player 10。有时我会返回 9 版本，但您总是可以要求更新 Flash Player 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T01:24:56.093

I am not doing much Flash development yet, but I've decided to target Flash 7, which means testing on 7, 8, 9, and 10\. You can [download previous versions of Flash for testing](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14266&sliceId=1).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T17:57:50.517

我们以版本 8 为目标，并使用虚拟机在 8 和 9（现在是 10）中进行测试，以避免一遍又一遍地卸载和重新安装 Flash。

随着更多限制性的默认跨域策略即将到来，最好使用播放器的调试器版本进行测试，它比标准版本更早地实施了这些限制性更强的策略，因此您会知道您将为未来做好准备。 [http://www.adobe.com/devnet/flashplayer/articles/fplayer9_security.html](http://www.adobe.com/devnet/flashplayer/articles/fplayer9_security.html) [http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T01:09:17.823

当我在我以前的兼职软件质量团队工作时，我们通常会测试所有可能的版本，以保证不会出现一些旧的遗留问题。

如果你想做一些严肃的测试，那么我建议你测试：

*   IE 6 和 7
*   火狐 2 和 3
*   苹果浏览器
*   在所有这些上轮换 Flash 版本以保证可持续性。

我不知道任何自动化工具：x

# language-agnostic - 软件需求分析

> ID：213303
> 
> 赞同：7
> 
> 时间：2008-10-17T18:29:30.377
> 
> 标签：language-agnostic, requirements, requirements-management

有很多工具可以用来编写和管理需求，但是有没有好的工具可以用来审查它们？

我不是在谈论***管理***评论，而是寻找常见需求错误的自动化工具（例如使用负面需求，或者以使测试变得困难的方式措辞）。
更多的是一种筛选工具，编写需求的人可以在分发给一组审阅者之前使用它来筛选他们的文档，这样审阅过程就不会因为每个人都对相同的容易识别的问题发表评论而减慢。

我很好奇过去是否有人使用过这样的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T19:04:03.257

我正在开发一个控制台应用程序，它采用这样的 xml 配置文件：

```
<?xml version="1.0" encoding="utf-8"?>
<ReqCheck>
  <Categories name="Reconsider wording">
    <Keyword>may</Keyword>
    <Keyword>should</Keyword>
  </Categories>
  <Categories name="Potential logic problem" format="{0}: consider both then and else conditions.">
    <Keyword>not</Keyword>
  </Categories>
</ReqCheck> 
```

该应用程序采用 MS-Word 文档并向文档添加“气球式”注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T11:37:57.067

您可能想看看[Ravenflow 产品](http://www.ravenflow.com/)。我自己还没有尝试过，但是它们的功能似乎与您正在寻找的非常接近...

**注意：**对于小型甚至中型团队/公司来说，Ravenflow 产品可能过于昂贵......

# css - 内联 CSS IE hack

> ID：213309
> 
> 赞同：6
> 
> 时间：2008-10-17T18:31:23.510
> 
> 标签：css

例如，是否可以在使用内联 CSS 时创建盒子模型 hack？

例如：

`<div id="blah" style="padding: 5px; margin: 5px; width: 30px; /*IE5-6 Equivalent here*/">`

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T19:53:15.530

您也可以在内联样式中使用“前缀”hack：

```
<div style="*background:red"></div> 
```

只需确保将 IE hacks 放在样式属性的末尾即可。但是，我赞同应尽可能避免使用内联样式的观点。Internet Explorer 的条件注释和单独的 CSS 文件似乎是处理此类问题的最佳方式。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T19:06:32.690

我会去外面 - 在那个元素上打一个类，或者使用你拥有的 ID，并在外部处理样式。

我也同意我之前的条件评论答案。

就是说：作为**绝对**的最后手段，您可以使用以下样式技巧来定位 <= IE6，甚至 IE7。当/如果他们修复 IE8 来打败你的黑客时，麻烦就来了。

```
.foo {
padding: 5px;
^padding: 4px; /* this targets all IE, including 7\. It must go first, or it overrides the following hack */
_padding: 3px; /* this targets >= IE6 */
width: 30px;
} 
```

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T18:44:29.600

无需争论或反对 CSS hack，就个人而言，如果我需要做类似的事情，我更愿意使用条件注释：

```
<!--[if lt IE 7]>
<style>
#blah {
padding: 5px;
margin: 5px;
width: 30px;
}
</style>
<![endif]--> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:42:03.723

最合适的答案是**不要**。（编辑：要清楚，我的意思是不要内联，我不是说不要使用 CSS hack。）

编辑：这不起作用，IE 忽略条件注释。在这里留下答案不是混蛋。

下一个最合适的答案是条件注释：

```
<div id="blah" style="padding: 5px; margin: 5px; width: 30px; <!--[if lte IE 6]> ... <![endif]-->"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-24T18:59:08.477

最好的解决方案是在标准模式而不是怪癖模式下工作......这将立即消除对大多数盒子模型黑客的需要。

除此之外，带有特定于 IE 的样式表的条件注释更清晰，更易于维护。在过去的几年里，这种方法对于大多数顶级设计师来说已经足够好了......除非你的网站有一些特定的东西需要全部内联我建议退后一步，看看根本问题而不是如何您可以在这些小症状出现时修补它们。[替代文字 http://sonicloft.net/im/52](http://sonicloft.net/im/52)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T20:10:52.310

请记住，IE 6 需要*在 quirks 模式*中而不是*在标准模式*中的 box 模型 hack 。IE 5 和 IE 5.5 一直都需要 BMH。

因此，如果您处于标准模式，则需要使用类似于[原始`voice-family`hack](http://tantek.com/CSS/Examples/boxmodelhack.html)的东西（针对 IE 5.X 而*不是*IE 6）。如果您处于 quirks 模式，任何旧的 IE <= 6 hack 都可以。

（您的问题内容向我表明您的页面以怪癖模式呈现。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T22:27:35.640

是的，就像上面的每个人一样，如果你能避免内联这样做！但是如果你真的需要内联，那么解析器过滤器可能是你最好的选择，这些是你可以在属性上使用的某些字符，例如 ie6 中的下划线 hack

```
print("code sample");

 style="position:relative;padding:5px; _position:absolute; _padding:10px;" 
```

ie6 仍然会得到下划线样式，其他人会忽略它们！

还有使用 !important 代替下划线。

玩一玩，看看会发生什么，但再次像上面一样，尽量避免像瘟疫一样:)

# ruby - Ruby 真的可以用作函数式语言吗？

> ID：213312
> 
> 赞同：10
> 
> 时间：2008-10-17T18:31:47.470
> 
> 标签：ruby, functional-programming

Ruby 真的可以用作函数式语言吗？有哪些好的教程可以教授这门语言？注意：我真的很想使用并坚持使用 Ruby 作为我的主要语言，所以我现在对转换为 YAFL（另一种函数式语言）不感兴趣。我对 Ruby 的功能方面在标准功能语言基线上的表现非常感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T18:39:50.280

是的……有点。Ruby 缺乏一个合理的构造来强制执行不变性。（`Object#freeze`不算）不变性确实是函数式语言的基石。此外，Ruby 的核心库高度面向命令式设计。它`Array`和`Hash`类本质上都是可变的，甚至`String`具有使不可变的方法（例如`gsub!`）。具有讽刺意味的是，Java 在这方面比 Ruby 更“实用”。

话虽如此，可以在 Ruby 中进行类似函数式的编程。任何时候你使用 block/proc/lambda，你都在使用来自函数式编程的特性。同样，收集方法和类似`map`的`zip`也是高阶结构，它们起源于 Lisp、ML 和 Haskell 等语言。

如果你真的想做函数式编程，你会想要使用更适合该类型的语言。一些建议：

*   [**Clojure**](http://clojure.org) - 既然你用 Ruby 来表达这个问题，我猜你是动态类型的说服力。Clojure 就像一个在 JVM 上运行的严格功能的 Lisp。
*   [**F#**](http://research.microsoft.com/fsharp/fsharp.aspx) - 基本上是 CLR 上的 OCaml。很好很干净
*   [**Scala**](http://www.scala-lang.org) - 不是一种*严格*的函数式语言，但比 Ruby 更好
*   [**Haskell**](http://www.haskell.org/) - 每个人的最爱！

您会注意到这四种语言中的三种是静态类型的。事实上，就 Scala 和 Haskell 而言，它们是*非常*静态类型的语言（比 Java 更强大的类型系统）。我不确定为什么这是函数式语言的趋势，但是你有它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T18:37:59.470

这取决于您所说的“函数式编程”是什么意思。在我看来，最重要的是函数是[一等值](http://en.wikipedia.org/wiki/First-class_object)，在这方面 Ruby 是一门函数式语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T18:40:49.527

它有一套相当全面的列表推导 - 请参阅[Martin Fowler 的文章](http://martinfowler.com/bliki/CollectionClosureMethod.html)。但是，它的类型系统不如 Haskell 之类的强大。此外，它的重点不在于不变性，这是函数式语言的典型特征。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T18:41:21.757

对于大多数用途，是的。有（尽管有点有限）进行柯里化、一等函数和递归的能力。但是由于对象创建和方法分派的高成本，深度递归会让你很快陷入困境！

Ruby 有足够的能力融入各种编程“模型”，但它在大多数情况下肯定不是最佳的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T01:12:20.847

如果您使用任何类型的递归算法，您也会很快遇到问题。Ruby 不支持尾递归，所以如果你不能可靠地使用递归作为一种迭代技术，就像你用一种更实用的语言做事的自然方式一样。就像是：

```
def foo(n)
  puts n
  foo(n + 1)
end

foo(1) 
```

会给你

```
SystemStackError: stack level too deep
    from (irb):2:in `puts'
    from (irb):2:in `foo'
    from (irb):3:in `foo'
    from (irb):5 
```

经过几千次迭代（取决于您的系统）

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-10-17T18:51:47.290

看看[Haskell](http://www.haskell.org/)。它是一种在语法上与 Ruby 非常相似的函数式语言。

# sharepoint - 如何快速使用 Windows Mobile 5.0 离线填写 Sharepoint List 编辑表单？

> ID：213330
> 
> 赞同：1
> 
> 时间：2008-10-17T18:38:39.033
> 
> 标签：sharepoint, windows-mobile, windows-mobile-5.0

我需要一种方法让用户使用从关机状态运行 windows Mobile 5.0 的手持式 Symbol MC9090 扫描仪快速输入信息

目前，用户从关机状态将数据输入共享点列表大约需要 1 分钟。我需要把时间缩短到几秒钟。手持设备建立无线连接大约需要 30 秒，用户连接服务器大约需要 30 秒

目前我们有运行 windows Mobile 5.0 的 Symbol MC9090 扫描仪。用户必须使用终端服务连接到服务器，然后输入信息。我们使用终端服务是因为移动互联网浏览器不能很好地与我们正在使用的共享点表单一起使用并且速度很慢。

我还没有找到一种简单的方法来为共享点列表创建自定义移动表单。

是否可以创建一个应用程序来收集移动设备上的数据，并在无线连接处于活动状态时将本地数据与服务器同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T22:27:03.317

您的延迟与网络连接和启动终端服务有关。

您可以为您的移动设备编写一个程序来输入和存储信息，然后通过其 Web 服务与 SharePoint 同步。

这给出了如何使用 Web 服务的示例

*   [http://www.developer.com/tech/article.php/3104621](http://www.developer.com/tech/article.php/3104621)

这是 Web 服务的官方文档

*   [http://msdn.microsoft.com/en-us/library/ms479390.aspx](http://msdn.microsoft.com/en-us/library/ms479390.aspx)

如何开始使用 Windows Mobile

*   [http://msdn.microsoft.com/en-us/windowsmobile/default.aspx](http://msdn.microsoft.com/en-us/windowsmobile/default.aspx)

# c# - 在泛型类型的构造函数中使用 C# params 关键字

> ID：213333
> 
> 赞同：9
> 
> 时间：2008-10-17T18:39:33.213
> 
> 标签：c#, .net, c#-3.0

我在 C# 中有一个带有 2 个构造函数的泛型类：

```
public Houses(params T[] InitialiseElements)
{}
public Houses(int Num, T DefaultValue)
{} 
```

使用 int 作为泛型类型构造一个对象并传入两个 int 作为参数会导致调用“不正确”的构造函数（从我的角度来看）。

例如`Houses<int> houses = new Houses<int>(1,2)`- 调用第二个构造函数。将任何其他数量的整数传递给构造函数将调用第一个构造函数。

除了删除 params 关键字并在使用第一个构造函数时强制用户传递一个 T 数组之外，还有什么方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T18:52:10.597

一个更清晰的解决方案是拥有两个静态工厂方法。如果将它们放入非泛型类中，您还可以从类型推断中受益：

```
public static class Houses
{
    public static Houses<T> CreateFromElements<T>(params T[] initialElements)
    {
        return new Houses<T>(initialElements);
    }

    public Houses<T> CreateFromDefault<T>(int count, T defaultValue)
    {
        return new Houses<T>(count, defaultValue);
    }
} 
```

调用示例：

```
Houses<string> x = Houses.CreateFromDefault(10, "hi");
Houses<int> y = Houses.CreateFromElements(20, 30, 40); 
```

那么你的泛型类型的构造函数就不需要“params”位，也就不会混淆了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T18:45:24.590

也许您可以传入 IEnumerable 而不是 Params

```
public Houses(IEnumerable<T> InitialiseElements){} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T18:45:31.297

第二个构造函数是更*精确的*匹配，这是用于评估哪个构造函数正确的标准。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T20:50:15.460

鉴于以下内容，因为原版没有太多关于类等的信息。

编译器将决定 new House(1,2) 与第二个构造函数完全匹配并使用它，请注意我以最多票接受了答案，但它不起作用。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace GenericTest
{
    public class House<T>
    {
        public House(params T[] values)
        {
            System.Console.WriteLine("Params T[]");
        }
        public House(int num, T defaultVal)
        {
            System.Console.WriteLine("int, T");
        }

        public static House<T> CreateFromDefault<T>(int count, T defaultVal)
        {
            return new House<T>(count, defaultVal);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            House<int> test = new House<int>(1, 2);                         // prints int, t
            House<int> test1 = new House<int>(new int[] {1, 2});            // prints parms
            House<string> test2 = new House<string>(1, "string");           // print int, t
            House<string> test3 = new House<string>("string", "string");    // print parms
            House<int> test4 = House<int>.CreateFromDefault<int>(1, 2);     // print int, t
        }
    }
} 
```

# concurrency - 如何让已经编写好的并发程序在 GPU 阵列上运行？

> ID：213337
> 
> 赞同：22
> 
> 时间：2008-10-17T18:40:00.717
> 
> 标签：concurrency, erlang, cuda, parallel-processing, gpu

我有一个用 Erlang 编写的神经网络，我刚买了一张带有 240 核 GPU 的 GeForce GTX 260 卡。使用[CUDA](http://en.wikipedia.org/wiki/CUDA)作为胶水在显卡上运行它是微不足道的吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-17T18:52:42.157

不，使用 CUDA 并非小事。

CUDA 编程模型基本上使用 C（有一些添加），但为了充分利用 GPGPU 的功能，您必须确保您的算法遵循 CUDA 指南。（请参阅[NVidia CUDA 编程指南](http://developer.download.nvidia.com/compute/cuda/1_1/NVIDIA_CUDA_Programming_Guide_1.1.pdf)）

例如，为了获得最佳的内存性能（大约 70Gbps），您需要在流模式下通过合并访问内存，分支在 GPU 上的成本也非常高，因此您应该尽可能避免使用条件语句。查看 SDK 提供的指南和示例，它们将提供一个很好的起点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T19:04:07.360

我希望我能告诉你如何使用 Erlang 来做到这一点... ;-)，但至少，MS Research 的 Satnam Singh 用 Haskell (Lava) 和 F# 做了一些非常有趣的工作。也许这篇论文可以让您对如何做到这一点有一些*直觉*：

[http://research.microsoft.com/en-us/people/satnams/](http://research.microsoft.com/en-us/people/satnams/)

# java - Eclipse 中的插件间通信

> ID：213349
> 
> 赞同：4
> 
> 时间：2008-10-17T18:44:19.333
> 
> 标签：java, eclipse, ipc

是否可以创建自动发现彼此的 Eclipse 插件？

我正在开发一组需要在两种主要情况下运行的插件：

*   单独
*   相互配合。

当单独运行时，插件应该“正常工作”，但是当它们协同运行时，它们将共享一些相同的模型内容，并且其中一个插件应该向用户提供其他插件的列表以与之共享内容。例如：

> Foo Plugin 检测到以下可以与其共享本体的插件：
> 
> [ ] 栏插件
> 
> [] Baz 插件
> 
> [ ] 不要分享

Eclipse 是否提供任何内部发布/检测方法来促进对其他插件的这种自动检测？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T19:23:54.713

答案应该是通过[声明式服务](http://www.infoq.com/news/2008/01/eclipse-osgi-comparison)，它结合了 eclipse xml 扩展和 osgi POJO 服务的优点。像 osgi 服务这样隐式动态的东西，但像 eclipse 扩展一样“按需”加载。

eclipse3.3 于 2006 年推出，您将在[本演示文稿](http://www.eclipse.org/equinox/documents/eclipsecon2006/Best%20Practices%20for%20Programming%20Eclipse%20and%20OSGi.pdf)中找到这些概念。

> 声明式服务提供了定义对其他服务的引用的选项。也可以指定引用的基数。基数使用两个数字指定，第一个数字 0 或 1 表示可选性，第二个数字 1 或 n 表示多重性。

在实践中，那些[DS（声明式服务）](http://wiki.eclipse.org/PDE/Incubator/DS)并不容易使用，因为您必须访问 BundleContext，这意味着跟踪 BundleActivator，[这并不总是那么容易](http://dev.eclipse.org/newslists/news.eclipse.technology.equinox/msg04756.html)......

如果您需要定义某种面向服务的组件模型，那么[本演示文稿](http://wiki.jonas.objectweb.org/xwiki/bin/download/Main/Cooperation/Service%20Oriented%20Component%20Model.ppt)应该为您提供当今存在的不同替代方案，并详细说明那些“声明式服务”

* * *

发布 rcreswick 发现的与 DS 相关的内容：

*   OSGi 入门：[介绍声明式服务](http://www.eclipsezone.com/eclipse/forums/t96740.html)
*   OSGi 入门：[声明式服务和依赖项](http://www.eclipsezone.com/eclipse/forums/t97690.rhtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T19:48:31.607

好吧，OSGI 服务注册中心可以在运行时完成基于 pojo 的服务的共享，而不是插件本身。有几个选项可以促进这一点，例如直接编码到 OSGI API、声明式服务、Spring DM 和 iPojo（我相信还有其他的）。

您可能想查看白板模式作为完成动态观察者/可观察样式解决方案的一种方式。

# flash - 电影剪辑未从字典中删除

> ID：213360
> 
> 赞同：2
> 
> 时间：2008-10-17T18:46:18.877
> 
> 标签：flash, actionscript-3, garbage-collection, weak-references

我有一个字典，其中保存了movieclips 的数据，如果我停止使用movieclips，我希望数据被垃圾收集。我正在使用弱键参数，它与其他数据完美配合，但是我遇到了问题。

这段代码很好用：

```
var mc = new MovieClip();
var dic = new Dictionary(true);
dic[mc] = 12;
mc = null;
System.gc();
System.gc();
for (var obj in dic)
   trace(obj);    //this doesn't execute 
```

但是当我实际使用影片剪辑时，它停止工作：

```
var mc = new MovieClip();
var dic = new Dictionary(true);
dic[mc] = 12;
addChild(mc);
removeChild(mc);
mc = null;
System.gc();
System.gc();
for (var obj in dic)
   trace(obj);    //this prints [object Movieclip] 
```

为什么会这样？是我做错了什么吗？有解决方法吗？

编辑：我知道对于这个特定的例子我可以使用`delete dic[mc]`，但当然这是一个简化的例子。一般来说，我不想手动从字典中删除影片剪辑，但是当我在应用程序的其余部分不再引用它时，它应该是自动的。

Edit2：我尝试测试 Aaron 所说的话，并想出了一些奇怪的东西......只是迭代字典（不做任何事情）改变了行为：

```
var mc = new MovieClip();
var dic = new Dictionary(true);
dic[mc] = 12;
addChild(mc);
removeChild(mc);
mc = null;

for (var objeto in dic) {}    // <-- try commenting out this line

addEventListener('enterFrame', f);  // I print the contents every frame, to see if
                                    // it gets removed after awhile

function f(evento)
{
    System.gc();
    System.gc();

    for (var objeto in dic)
        trace(objeto);
} 
```

这会保持每帧打印 [object Movieclip]，除非我注释掉指示的行，它不会打印任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T19:21:32.770

我相信问题是时间问题之一。我认为当您调用 remove child 时，引用计数直到“框架”的后期才会更新。（我认为这就是正在发生的事情。）

下面的代码说明了为什么我认为这是真的。（我正在使用 flex，但它似乎重现了您的问题。）

下面的代码输出：

```
[object MovieClip]
here 
```

如果你在 somefoo() 的末尾直接调用 otherfoo，你会得到：

```
[object MovieClip]
here
[object MovieClip] 
```

* * *

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" mouseDown="somefoo()">
<mx:Script>
    <![CDATA[
        import mx.core.UIComponent;
        private var dic:Dictionary = new Dictionary(true);
        private var ui:UIComponent = new UIComponent();
        private var mc:MovieClip = new MovieClip();

        private function somefoo():void {
            this.addChild(ui);

            dic[mc] = 12;
            ui.addChild(mc);
            ui.removeChild(mc);
            for (var obj:Object in dic)
               trace(obj);    //this prints [MovieClip]

            this.removeChild(ui);

                            // callLater causes the function to be called in the _next_ frame.
            callLater(otherfoo);
        }

        private function otherfoo():void
        {
            trace("here");
            mc = null;
            System.gc();
            System.gc();

            for (var obj:Object in dic)
               trace(obj);    //this prints [MovieClip]

        }
    ]]>
</mx:Script>
</mx:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T20:10:22.733

在您的示例代码中，您永远不会将电影剪辑添加到字典中，而是将 int 12 添加到字典中？可能是笔误。

If you want the dictionary to have a list of what's currently on the stage, why not have i as a util class instead that listens to Event.ADDED_TO_STAGE and Event.REMOVED_FROM_STAGE and modify the dictionary accordingly? A dictionary doesn't automatically delete references if they get removed from the stage. Also gc in this case has nothing to do with this.

# ruby - 如何可靠地发现 Ruby 可执行文件的完整路径？

> ID：213368
> 
> 赞同：8
> 
> 时间：2008-10-17T18:47:22.713
> 
> 标签：ruby, scripting

我想写一个脚本，打包成一个gem，它将修改它的参数，然后用修改后的参数`exec`创建一个新的ruby进程。换句话说，类似于修改其参数然后执行`exec $SHELL $*`. 为了做到这一点，我需要一种强大的方法来发现正在执行当前脚本的 ruby​​ 可执行文件的路径。我还需要获取传递给当前进程的完整参数——Ruby 参数和脚本参数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T19:25:29.383

Rake 源代码是这样的：

```
 RUBY = File.join(Config::CONFIG['bindir'], Config::CONFIG['ruby_install_name']).
    sub(/.*\s.*/m, '"\&"') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-19T10:11:26.963

如果你想在 linux 上检查：读取文件：

*   /proc/PID/exe
*   /proc/PID/cmdline

其他有用的信息可以在 /proc/PID 目录中找到

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-21T12:30:20.953

对于脚本参数，当然，使用`ARGV`.

# devexpress - 如何在 XtraCharts 中编辑 showInPanes 属性

> ID：213371
> 
> 赞同：0
> 
> 时间：2008-10-17T18:47:34.320
> 
> 标签：devexpress, pane

我在 Windows 窗体应用程序的代码中将系列和窗格添加到开发人员的快速图表控件中。我只想显示第一个窗格的 x 轴标签。showInPanes 属性告诉我它是只读的。如何在代码中设置此属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T05:34:21.560

```
Dim XyDiagram1 As XYDiagram = CType(chart.Diagram, XYDiagram)

Dim XyDiagramPane1 As XYDiagramPane = New XYDiagramPane
XyDiagramPane1.Name = "Pane 1"
XyDiagram1.Panes.Add(XyDiagramPane1)

XyDiagram1.AxisX.SetVisibilityInPanes(False, XyDiagramPane1) 
```

# resharper - 如何调试 Resharper 4.0 加载项？

> ID：213374
> 
> 赞同：0
> 
> 时间：2008-10-17T18:48:02.633
> 
> 标签：resharper

好吧，我喜欢 Resharper 和它的插件，但即使是最好的 fanbois 也不得不承认它的 API 文档不是最理想的。我想自己构建一个插件（基于[Agent Johnson](http://code.google.com/p/agentjohnsonplugin/)插件）。谢天谢地，该插件在 4.0 中工作，所以我可以将它作为我自己工作的起点。

我的问题：如何运行和调试应用程序？resharper 插件位于 \v4.1\Bin\Plugins\ 目录中——我是否将输出目录设置为该文件夹，运行它，然后启动另一个 Visual Studio 实例？还是我应该尝试其他一些黑客/解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T07:50:28.873

您应该调试 devenv.exe 并使用命令行加载插件，请参见[此处](http://www.jetbrains.net/confluence/display/ReSharper/Building,+running+and+debugging+plugin)

# excel - 以编程方式实例化 Excel 时加载插件

> ID：213375
> 
> 赞同：16
> 
> 时间：2008-10-17T18:48:21.947
> 
> 标签：excel, vba, excel-addins

我正在尝试使用 VBA 创建一个新的 Excel 实例：

```
Set XlApp = New Excel.Application 
```

问题是这个新的 Excel 实例不会加载我正常打开 Excel 时加载的所有插件...... Excel 应用程序对象中是否有任何内容用于加载所有用户指定的插件？

我不是要加载特定的加载项，而是让新的 Excel 应用程序的行为就像用户自己打开它一样，所以我真的在寻找通常加载的所有用户选择的加载项的列表打开 Excel 时。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-30T12:45:53.180

我再次查看了这个问题，Application.Addins 集合似乎在“工具”->“插件”菜单中列出了所有插件，并带有一个布尔值，说明是否安装了插件。所以现在似乎对我有用的是循环遍历所有插件，如果 .Installed = true 然后我将 .Installed 设置为 False 并返回 True，这似乎可以正确加载我的插件。

```
Function ReloadXLAddins(TheXLApp As Excel.Application) As Boolean

    Dim CurrAddin As Excel.AddIn

    For Each CurrAddin In TheXLApp.AddIns
        If CurrAddin.Installed Then
            CurrAddin.Installed = False
            CurrAddin.Installed = True
        End If
    Next CurrAddin

End Function 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T22:10:04.380

不幸的是， using`CreateObject("Excel.Application")`的结果与 using 相同。`New Excel.Application`

`Application.Addins.Add(string fileName)`您必须使用该方法通过文件路径和名称单独加载您需要的插件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-06T18:43:14.020

我将把这个答案留给其他遇到这个问题但使用 JavaScript 的人。

一点背景知识... 在我的公司，我们有一个使用 JavaScript 启动 Excel 并动态生成电子表格的 3rd 方网络应用程序。我们还有一个 Excel 加载项，它覆盖了“保存”按钮的行为。该插件让您可以选择将文件保存在本地或我们的在线文档管理系统中。

After we upgraded to Windows 7 and Office 2010, we noticed a problem with our spreadsheet-generating web app. When JavaScript generated a spreadsheet in Excel, suddenly the Save button no longer worked. You would click save and nothing happened.

Using the other answers here I was able to construct a solution in JavaScript. Essentially we would create the Excel Application object in memory, then reload a specific add-in to get our save button behavior back. Here's a simplified version of our fix:

```
function GenerateSpreadsheet()
{
    var ExcelApp = getExcel();
    if (ExcelApp == null){ return; }

    reloadAddIn(ExcelApp);

    ExcelApp.WorkBooks.Add;
    ExcelApp.Visible = true;
    sheet = ExcelApp.ActiveSheet;

    var now = new Date();
    ExcelApp.Cells(1,1).value = 'This is an auto-generated spreadsheet, created using Javascript and ActiveX in Internet Explorer';

    ExcelApp.ActiveSheet.Columns("A:IV").EntireColumn.AutoFit; 
    ExcelApp.ActiveSheet.Rows("1:65536").EntireRow.AutoFit;
    ExcelApp.ActiveSheet.Range("A1").Select;

    ExcelApp = null;
}

function getExcel() {
   try {
       return new ActiveXObject("Excel.Application");
   } catch(e) {
       alert("Unable to open Excel. Please check your security settings.");
       return null;
   }
}

function reloadAddIn(ExcelApp) {
    // Fixes problem with save button not working in Excel,
    // by reloading the add-in responsible for the custom save button behavior
    try {
        ExcelApp.AddIns2.Item("AddInName").Installed = false;
        ExcelApp.AddIns2.Item("AddInName").Installed = true;
    } catch (e) { }
} 
```

# java - Swing 组件的开源改进或替换

> ID：213378
> 
> 赞同：10
> 
> 时间：2008-10-17T18:48:34.893
> 
> 标签：java, swing, components

我使用 Swing 开发了许多桌面 Java 应用程序，虽然 Swing 非常强大（一旦你掌握了它的窍门），仍然有很多情况我希望一些高级组件开箱即用。

例如，我真的很想看到易于使用的组件（不用自己编写，只要有足够的时间我就可以做到），例如：

*   多行标签
*   类似于 Windows 文件资源管理器的图标或缩略图视图
*   下拉按钮（类似于 Firefox 的旧后退按钮）
*   5 星评级小部件
*   具有自动历史记录的组合框（如 Google 上的文本字段）
*   Outlook 风格的手风琴风格的酒吧
*   等等

我知道一些免费的 Swing 组件的来源，例如[SwingLabs](http://swinglabs.org)、JXTable 的主页、JXDatePicker 和其他一些。

**除了 Java 本身包含的 Swing 组件之外，您还去哪里寻找 Swing 组件？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T18:53:27.193

以下值得一看：

*   [摇摆X](https://swingx.dev.java.net/)
*   [釉面清单](http://publicobject.com/glazedlists/)
*   [物质外观](https://substance.dev.java.net/)
*   [火烈鸟组件](https://flamingo.dev.java.net/)
*   [Ken Orr 的 Mac 小工具](http://code.google.com/p/macwidgets/)
*   [极德的开源组件](http://www.jidesoft.com/products/oss.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T19:45:35.530

至于：“Windows File Explorer-like Icons or Thumbnails view”

它们内置在秋千上。

当 L&F 当然是 Windows 时，文件资源管理器图标通过 FileSystemView 类（由 JFileChooser 使用）访问。

```
FileSystemView.getFileSystemView();
Icon driveIcon = fsv.getSystemIcon( new File("C:\\")); 
```

并且可以使用 Sun 不鼓励的 sun.com 类检索缩略图图标

```
sun.awt.shell.ShellFolder getIcon( boolean largeIcon ) 
```

但这有时可能表现不佳（我认为由于本机资源处理）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-07T12:10:02.617

I know you can get an awesome wrapping labe and an accordion from [javaswingcomponents](http://www.javaswingcomponents.com/products), however they are not open source implementations.

Otherwise Jide and SwingX are great choices.

# security - 为哈希隐藏盐的必要性

> ID：213380
> 
> 赞同：105
> 
> 时间：2008-10-17T18:49:38.747
> 
> 标签：security, encryption, hash, brute-force

在工作中，我们有两种相互竞争的盐理论。我工作的产品使用用户名或电话号码之类的东西来加盐。本质上，对于每个用户来说都是不同的，但我们很容易获得。另一款产品为每个用户随机生成一个salt，并在用户每次更改密码时更改。然后在数据库中加密盐。

我的问题是第二种方法是否真的有必要？我可以从纯理论的角度理解它比第一种方法更安全，但从实用性的角度来看呢。现在要对用户进行身份验证，salt 必须未加密并应用于登录信息。

在考虑之后，我只是没有看到这种方法真正的安全收益。将盐从一个帐户更改为另一个帐户，即使攻击者知道如何快速确定每个帐户的值，仍然使某人尝试暴力破解散列算法非常困难。这是在假设密码足够强的情况下进行的。（显然，找到一组密码的正确哈希值，其中它们都是两位数字，比找到正确的 8 位密码哈希值要容易得多）。我的逻辑是不正确的，还是我遗漏了什么？

**编辑：**好的，这就是为什么我认为加密盐真的没有实际意义的原因。（让我知道我是否走在正确的轨道上）。

对于下面的解释，我们假设密码总是 8 个字符，salt 是 5，所有密码都由小写字母组成（这只是为了让数学更容易）。

每个条目使用不同的盐意味着我不能使用相同的彩虹表（实际上，如果我有一个足够大的大小，我可以使用，但我们暂时忽略它）。据我了解，这是真正的关键，因为要破解每个帐户，我必须重新发明轮子，可以说每个帐户。现在，如果我知道如何将正确的盐应用于密码以生成散列，我会这样做，因为盐实际上只是扩展了散列短语的长度/复杂性。所以我会减少我需要生成的可能组合的数量，以“知道”我的密码+盐从 13^26 到 8^26，因为我知道盐是什么。现在这使它变得更容易，但仍然非常困难。

因此，对盐进行加密。如果我知道盐是加密的，我不会先尝试解密（假设我知道它有足够的加密级别）。我会忽略它。而不是试图弄清楚如何解密它，回到前面的例子，我只生成一个更大的彩虹表，其中包含 13^26 的所有密钥。不知道盐肯定会减慢我的速度，但我认为它不会增加尝试首先破解盐加密的艰巨任务。这就是为什么我认为这不值得。想法？

这是一个链接，描述了密码在蛮力攻击下可以保存多长时间： [http ://www.lockdown.co.uk/?pg=combi](http://www.lockdown.co.uk/?pg=combi)

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-18T15:28:19.650

Hiding a salt is unnecessary.

A different salt should be used for every hash. In practice, this is easy to achieve by getting 8 or more bytes from cryptographic quality random number generator.

From a [previous answer of mine](https://stackoverflow.com/questions/55862/how-to-implement-password-protection-for-individual-files#55904):

> Salt helps to thwart pre-computed dictionary attacks.
> 
> Suppose an attacker has a list of likely passwords. He can hash each and compare it to the hash of his victim's password, and see if it matches. If the list is large, this could take a long time. He doesn't want spend that much time on his next target, so he records the result in a "dictionary" where a hash points to its corresponding input. If the list of passwords is very, very long, he can use techniques like a Rainbow Table to save some space.
> 
> However, suppose his next target salted their password. Even if the attacker knows what the salt is, his precomputed table is worthless—the salt changes the hash resulting from each password. He has to re-hash all of the passwords in his list, affixing the target's salt to the input. Every different salt requires a different dictionary, and if enough salts are used, the attacker won't have room to store dictionaries for them all. Trading space to save time is no longer an option; the attacker must fall back to hashing each password in his list for each target he wants to attack.
> 
> So, it's not necessary to keep the salt secret. Ensuring that the attacker doesn't have a pre-computed dictionary corresponding to that particular salt is sufficient.

* * *

After thinking about this a bit more, I've realized that fooling yourself into thinking the salt can be hidden is dangerous. It's much better to assume the salt cannot be hidden, and design the system to be safe in spite of that. I provide a more detailed explanation [in another answer.](https://stackoverflow.com/questions/4807677/why-does-php-crypt-prepend-the-salt-to-the-hash/4808616#4808616)

* * *

However, recent recommendations from NIST encourage the use of an *additional,* secret "salt" (I've seen others call this additional secret "pepper"). One additional iteration of the key derivation can be performed using this secret as a salt. Rather than increasing strength against a pre-computed lookup attack, this round protects against password guessing, much like the large number of iterations in a good key derivation function. This secret serves no purpose if stored with the hashed password; it must be managed as a secret, and that could be difficult in a large user database.

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-17T19:03:00.123

The answer here is to ask yourself what you're really trying to protect from? If someone has access to your database, then they have access to the encrypted salts, and they probably have access to your code as well. With all that could they decrypt the encrypted salts? If so then the encryption is pretty much useless anyway. The salt really is there to make it so it isn't possible to form a rainbow table to crack your entire password database in one go if it gets broken into. From that point of view, so long as each salt is unique there is no difference, a brute force attack would be required with your salts or the encrypted salts for each password individually.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-10T21:16:34.810

A hidden salt is no longer salt. It's pepper. It has its use. It's different from salt.

Pepper is a secret key added to the password + salt which makes the hash into an HMAC (Hash Based Message Authentication Code). A hacker with access to the hash output and the salt can theoretically brute force guess an input which will generate the hash (and therefore pass validation in the password textbox). By adding pepper you increase the problem space in a cryptographically random way, rendering the problem intractable without serious hardware.

For more information on pepper, check [here](https://security.stackexchange.com/questions/3272/password-hashing-add-salt-pepper-or-is-salt-enough).

See also [hmac](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T18:57:24.033

My understanding of "salt" is that it makes cracking more difficult, but it doesn't try to hide the extra data. If you are trying to get more security by making the salt "secret", then you really just want more bits in your encryption keys.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T19:05:39.103

The second approach is only slightly more secure. Salts protect users from dictionary attacks and rainbow table attacks. They make it harder for an ambitious attacker to compromise your entire system, but are still vulnerable to attacks that are focused on one user of your system. If you use information that's publicly available, like a telephone number, *and the attacker becomes aware of this*, then you've saved them a step in their attack. Of course the question is moot if the attacker gets your whole database, salts and all.

**EDIT:** After re-reading over this answer and some of the comments, it occurs to me that some of the confusion may be due to the fact that I'm only comparing the two very specific cases presented in the question: random salt vs. non-random salt. The question of *using a telephone number as a salt* is moot if the attacker gets your whole database, **not** the question of using a salt at all.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-15T03:04:56.663

> ... something like a user name or phone number to salt the hash. ...
> 
> My question is if the second approach is really necessary? I can understand from a purely theoretical perspective that it is more secure than the first approach, but **what about from a practicality point of view?**

From a practical point of view, a salt is an implementation detail. If you ever change how user info is collected or maintained – and both user names and phone numbers sometimes change, to use your exact examples – then you may have compromised your security. Do you want such an outward-facing change to have much deeper security concerns?

Does stopping the requirement that each account have a phone number need to involve a complete security review to make sure you haven't opened up those accounts to a security compromise?

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T19:14:50.817

Here is a simple example showing why it is bad to have the same salt for each hash

Consider the following table

```
UserId  UserName,   Password
     1  Fred       Hash1 =  Sha(Salt1+Password1)    
     2  Ted        Hash2 =  Sha(Salt2+Password2) 
```

**Case 1 when salt 1 is the same as salt2** If Hash2 is replaced with Hash1 then user 2 could logon with user 1 password

**Case 2 when salt 1 not the same salt2** If Hash2 is replaced with Hash1 then user2 can not logon with users 1 password.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T18:58:55.857

There are two techniques, with different goals:

*   The "salt" is used to make two otherwise equal passwords encrypt differently. This way, an intruder can't efficiently use a dictionary attack against a whole list of encrypted passwords.

*   The (shared) "secret" is added before hashing a message, so that an intruder can't create his own messages and have them accepted.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-04T22:17:25.743

I tend to hide the salt. I use 10 bits of salt by prepending a random number from 1 to 1024 to the beginning of the password before hashing it. When comparing the password the user entered with the hash, I loop from 1 to 1024 and try every possible value of salt until I find the match. This takes less than 1/10 of a second. I got the idea to do it this way from the PHP [password_hash](http://us3.php.net/manual/en/function.password-hash.php) and [password_verify](http://us3.php.net/manual/en/function.password-verify.php). In my example, the "cost" is 10 for 10 bits of salt. Or from what another user said, hidden "salt" is called "pepper". The salt is not encrypted in the database. It's brute forced out. It would make the rainbow table necessary to reverse the hash 1000 times larger. I use sha256 because it's fast, but still considered secure.

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-17T19:16:43.137

Really, it depends on from what type of attack you're trying to protect your data.

The purpose of a unique salt for each password is to prevent a dictionary attack against the entire password database.

Encrypting the unique salt for each password would make it more difficult to crack an individual password, yes, but you must weigh whether there's really much of a benefit. If the attacker, by brute force, finds that this string:

```
Marianne2ae85fb5d 
```

hashes to a hash stored in the DB, is it really that hard to figure out what which part is the pass and which part is the salt?

# iis - 当它说将 crossdomain.xml 放在根目录中时，它会在 IIS 上的什么位置？

> ID：213389
> 
> 赞同：5
> 
> 时间：2008-10-17T18:50:37.870
> 
> 标签：iis, flash, crossdomain.xml

是 wwwroot、C、托管资产的根虚拟目录，还是资产所在的同一个文件夹？

这意味着如果我有一个虚拟目录 'virdir' 和一个子目录 'swf'，它真的很像 C:\somedir\assets\swf\，crossdomain.xml 需要去哪里，以便我的 swf 应用程序在不同的服务器上可以访问swfs吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T18:53:19.113

您需要能够以[http://yoursite.com/crossdomain.xml](http://yoursite.com/crossdomain.xml)的形式访问它，那么您会将它放在哪里呢？

根据经验，我将它放在我的 index.html 网站旁边。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T19:02:24.337

wwwroot 可能会为您工作。

# winapi - 用于删除文件夹的 Win32 API 函数是什么？

> ID：213392
> 
> 赞同：25
> 
> 时间：2008-10-17T18:51:00.333
> 
> 标签：winapi

用于以编程方式删除文件和文件夹的 Win32 API 是什么？

**编辑**

[DeleteFile](http://msdn.microsoft.com/en-us/library/aa363915(VS.85).aspx)和[RemoveDirectory](http://msdn.microsoft.com/en-us/library/aa365488(VS.85).aspx)是我正在寻找的。但是，对于这个项目，我最终使用了[SHFileOperation](http://msdn.microsoft.com/en-us/library/bb762164(VS.85).aspx)。我发现CodeGuru的[示例代码很有帮助。](http://www.codeguru.com/forum/showthread.php?t=239271)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-20T14:29:48.910

有两种方法可以解决这个问题。一种是通过[文件服务](http://msdn.microsoft.com/en-us/library/aa163259.aspx)（使用[DeleteFile](http://msdn.microsoft.com/en-us/library/aa363915(VS.85).aspx)和[RemoveDirectory](http://msdn.microsoft.com/en-us/library/aa365488(VS.85).aspx)等命令），另一种是通过[Windows Shell](http://msdn.microsoft.com/en-us/library/bb773177(VS.85).aspx)（使用[SHFileOperation](http://msdn.microsoft.com/en-us/library/bb762164(VS.85).aspx)）。如果您想删除非空目录或需要资源管理器样式反馈（例如，带有飞行文件的进度对话框），建议使用后者。最快的方法是创建一个[SHFILEOPSTRUCT](http://msdn.microsoft.com/en-us/library/bb759795(VS.85).aspx)，初始化它并调用[SHFileOperation](http://msdn.microsoft.com/en-us/library/bb762164(VS.85).aspx)，因此：

```
void silently_remove_directory(LPCTSTR dir) // Fully qualified name of the directory being deleted, without trailing backslash
{
    SHFILEOPSTRUCT file_op = {
        NULL,
        FO_DELETE,
        dir,
        "",
        FOF_NOCONFIRMATION |
        FOF_NOERRORUI |
        FOF_SILENT,
        false,
        0,
        "" };
    SHFileOperation(&file_op);
} 
```

这会静默删除整个目录。您可以通过改变 SHFILEOPSTRUCT 初始化来添加反馈和提示 - 请阅读它。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-17T18:57:21.833

我想你想要[DeleteFile](http://msdn.microsoft.com/en-us/library/aa363915(VS.85).aspx)和[RemoveDirectory](http://msdn.microsoft.com/en-us/library/aa365488(VS.85).aspx)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-09-26T22:46:36.840

请参阅上面 uvgroovy 的评论。'dir' 字段的末尾需要 2 个空值。

```
int silently_remove_directory(LPCTSTR dir) // Fully qualified name of the directory being   deleted,   without trailing backslash
{
  int len = strlen(dir) + 2; // required to set 2 nulls at end of argument to SHFileOperation.
  char* tempdir = (char*) malloc(len);
  memset(tempdir,0,len);
  strcpy(tempdir,dir);

  SHFILEOPSTRUCT file_op = {
    NULL,
    FO_DELETE,
    tempdir,
    NULL,
    FOF_NOCONFIRMATION |
    FOF_NOERRORUI |
    FOF_SILENT,
    false,
    0,
    "" };
  int ret = SHFileOperation(&file_op);
  free(tempdir);
  return ret; // returns 0 on success, non zero on failure.
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-18T11:11:28.310

我相信`DeleteFile`不会将文件发送到回收站。此外，`RemoveDirectory`仅删除空目录。[SHFileOperation](http://msdn.microsoft.com/en-us/library/bb762164(VS.85).aspx)可以让您最大程度地控制删除的内容和方式，并在需要时显示标准的 Windows UI 对话框（例如“准备删除等）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-08T11:04:39.863

```
 /* function used to send files and folder to recycle bin in win32 */
            int fn_Send_Item_To_RecycleBin(TCHAR newpath[]) 
            {          
            _tcscat_s(newpath, MAX_PATH,_T("|"));
            TCHAR* Lastptr = _tcsrchr(newpath, _T('|'));
            *Lastptr = _T('\0');                                         // Replace last pointer with Null for double null termination
            SHFILEOPSTRUCT shFileStruct; 
            ZeroMemory(&shFileStruct,sizeof(shFileStruct)); 
            shFileStruct.hwnd=NULL; 
            shFileStruct.wFunc= FO_DELETE; 
            shFileStruct.pFrom= newpath;
            shFileStruct.fFlags = FOF_ALLOWUNDO | FOF_NOCONFIRMATION | FOF_NOERRORUI | FOF_SILENT;
            return SHFileOperation(&shFileStruct);
            } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-01T16:42:02.507

对于 C++ 编程，如果你愿意使用第三方库， [boost::filesystem::remove_all(yourPath)](http://www.boost.org/doc/libs/1_48_0/libs/filesystem/v3/doc/reference.html#remove_all) 比 SHFileOperation 简单得多。

# ssis - 如何使用 SSIS 导出具有不同行的平面文件？

> ID：213411
> 
> 赞同：1
> 
> 时间：2008-10-17T18:54:41.467
> 
> 标签：ssis

我有标准关系的树表、客户、发票和发票行。

这些我必须导出到一个固定字段长度的文件中，每行的前两个字符标识行类型。行类型有不同的规格。

我可能可以在脚本块中使用嵌套循环来做到这一点，但这是我的第一个 SSIS 包，这个解决方案感觉不对。

编辑：

输出必须具有：

```
Customer  
Invoice  
Rows  
Customer  
Invoice  
Rows  
and so on 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T04:38:11.397

您对使用 Script Destination 组件执行此操作的直觉是正确的。不幸的是，这种情况与 SSIS 不符。我不认为这是一个初学者包。如果您必须使用 SSIS，那么我将从内部连接所有数据开始，以便每个 InvoiceRow 有一行，其中包含所有三个表所需的数据。

CustomerCols、InvoiceCols、RowCols

然后，在脚本目标组件中，您需要跟踪客户和发票值，因为它们会发生变化，您需要将额外的行写入输出。

有关脚本目标的更多信息，请参阅[使用脚本组件创建目标。](http://msdn.microsoft.com/en-us/library/ms135939.aspx)

我的经验表明，脚本目标可以具有良好的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T05:54:48.900

我会避免编写 Script Destination，而只使用 Script Transform + Flat File Destination。这样，您可以专注于逻辑输出（数据字符串），同时允许 SSIS 对文件进行实际写入（它可能更高效，而且您专注于您的业务，而不是写入文件）。

首先，您需要获取非规范化数据。您可以在 DBMS 中进行连接和排序，但如果您不想对 DBMS 施加太大压力 - 只需从中获取排序数据并使用两个 SSIS Merge Join 转换将其合并。

然后执行脚本：保持当前客户和发票的运行值，当它们改变时输出它们，在每个输入上输出 InvoiceRow。像这样的东西：

```
if (this.CustomerID != InputBuffer.CustomerID) {
  this.CustomerID = InputBuffer.CustomerID;
  OutputBuffer.AddRow();
  OutputBuffer.OutputColumn = "Customer: " + InputBuffer.CustomerID + " " + InputBuffer.CustomerName;
}
// repeat the same code for Invoice

OutputBuffer.AddRow();
OutputBuffer.OutputColumn = "InvoiceRow: " + InputBuffer.InvoiceRowPrice; 
```

最后，添加一个带有单列的平面文件目标（由脚本创建的输出列）以将其写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T19:00:52.077

处理您的三个表，以便输出都适合您的输出文件（包括行类型指示符）。您必须在数据流中的三个单独的流路径中执行此操作，然后将这些行放在一个 Union All 数据流元素中。从那里，根据需要处理它们以创建输出文件。

# .net - 如何通过互操作用户控件中的事件将字符串数组传递给 vb6

> ID：213413
> 
> 赞同：1
> 
> 时间：2008-10-17T18:55:03.960
> 
> 标签：.net, vb.net, vb6, interop

我有一个有事件的 VB.net 控件：

```
Public Event PassNames(ByVal names() as String) 
```

当事件在 VB6 中触发时，我收到以下错误：

*“函数或接口标记为受限，或函数使用 Visual Basic 不支持的自动化类型”*

这是VB6中的事件：

```
Private Sub IteropControl1_PassNames(ByVal names() As String)
      MsgBox "I don't work"
End Sub 
```

**有没有办法将数组与互操作用户控件一起使用？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T19:14:24.703

我弄清楚我做错了什么。

在我的 VB.net 控件中，我的事件应该是

```
Public Event PassNames(ByRef names() as String) 
```

代替

```
Public Event PassNames(ByVal names() as String) 
```

# dependency-injection - 在方法或构造函数中注入依赖项？

> ID：213421
> 
> 赞同：25
> 
> 时间：2008-10-17T18:57:55.547
> 
> 标签：dependency-injection

依赖注入似乎是件好事。一般来说，依赖关系应该注入到需要它们的方法中，还是应该注入到类的构造函数中？

请参阅下面的示例以演示注入相同依赖项的两种方法。

```
//Inject the dependency into the methods that require ImportantClass
Class Something {

    public Something()
    {
         //empty
    }

    public void A() 
    {
         //do something without x
    }

    public void B(ImportantClass x)
    {
         //do something with x
    }

    public void C(ImportantClass x)
    {
         //do something with x
    }
}

//Inject the dependency into the constructor once
Class Something {
    private ImportantClass _x
    public Something(ImportantClass x)
    {
         this._x = x;
    }

    public void A() 
    {
         //do something without x
    }

    public void B()
    {
         //do something with this._x
    }

    public void C()
    {
         //do something with this._x
    }

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-17T18:59:05.700

构造函数注入的主要好处是它允许将您的字段标记为最终字段。例如：

```
class Foo {
    private final Bar _bar;

    Foo(Bar bar) {
        _bar=bar;
    }
} 
```

以下页面列出了优缺点：[Guice 最佳实践](http://code.google.com/p/google-guice/wiki/MinimizeMutability)：

**方法注入**

*   + 不是现场注入
*   + 唯一适用于一些奇怪的边缘情况的东西

**构造函数注入**

*   + 字段可以是最终的！
*   + 注射不可能被跳过
*   + 一目了然的依赖关系
*   + 这就是建筑理念的全部意义所在
*   - 没有可选的注射
*   - 当 DI 库不能自己实例化时无用
*   - 子类需要“了解”其超类所需的注入
*   - 对于只“关心”其中一个参数的测试不太方便

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T19:02:02.543

通过不在每个方法中注入依赖项，您可以强制每个调用者知道或检索依赖项。

同样从工具的角度来看，有许多可用的框架（至少在 .NET 中）可以启用或使构造函数注入更容易执行。这不应影响决定，但会使其更具吸引力。

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-26T23:14:31.353

如果您在方法期间注入，那么您不会将行为抽象与具体依赖项区分开来。这是一个很大的禁忌:)。您希望依赖抽象，因此您不会与类依赖项的依赖项耦合。. .

由于您的构造函数不会存在于您的具体类支持的任何接口中，而不是您没有耦合到该依赖项。但是方法调用会有这个问题。

这是一篇关于这个主题的好文章：

[http://chrisdonnan.com/blog/2007/05/20/conquest-through-extreme-composition-glue-part-2/](http://chrisdonnan.com/blog/2007/05/20/conquest-through-extreme-composition-glue-part-2/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T19:25:35.523

另一种方法是使用依赖项的设置器。有时这与构造函数注入结合使用。如果您想更改稍后使用的实现而不需要重新创建实例，这将很有用。

```
public interface IFoo
{
   void Do();
}

public class DefaultFoo : IFoo
{
   public void Do()
   {
   }
}

public class UsesFoo
{
   private IFoo foo;
   public IFoo Foo
   {
       set { this.foo = value; }
   }

   public UsesFoo()
   {
      this.Foo = new DefaultFoo();
   }

   public UsesFoo( IFoo foo )
   {
      this.Foo = foo;
   }

   public void DoFoo()
   {
      this.Foo.Do();
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T19:02:05.803

[Crazy Bob Lee](http://crazybob.org)说尽可能使用构造函数注入。仅当您无法控制实例化（例如在 servlet 中）时才使用方法注入。

# c# - 将 C# 代码翻译成 AST？

> ID：213427
> 
> 赞同：17
> 
> 时间：2008-10-17T19:00:16.867
> 
> 标签：c#, compiler-construction, abstract-syntax-tree

目前是否可以将 C# 代码转换为抽象语法树？

编辑：一些澄清；我不一定希望编译器为我生成 AST - 解析器会很好，尽管我想使用“官方”的东西。不幸的是，Lambda 表达式是不够的，因为它们不允许我使用我正在寻找的语句体。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-10-27T17:32:37.017

The [Roslyn](http://msdn.microsoft.com/en-us/roslyn) project is in Visual Studio 2010 and gives you programmatic access to the [Syntax Tree](http://msdn.microsoft.com/en-us/hh543916), among other things.

```
SyntaxTree tree = SyntaxTree.ParseCompilationUnit(
    @" C# code here ");
var root = (CompilationUnitSyntax)tree.Root; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-17T19:20:53.440

> 目前是否可以将 C# 代码转换为抽象语法树？

是的，在特殊情况下微不足道（= 使用新的[表达式框架](http://msdn.microsoft.com/en-us/library/bb397951.aspx)）：

```
// Requires 'using System.Linq.Expressions;'
Expression<Func<int, int>> f = x => x * 2; 
```

This creates an expression tree for the lambda, i.e. a function taking an `int` and returning the double. You can modify the expression tree by using the Expressions framework (= the classes from in that namespace) and then compile it at run-time:

```
var newBody = Expression.Add(f.Body, Expression.Constant(1));
f = Expression.Lambda<Func<int, int>>(newBody, f.Parameters);
var compiled = f.Compile();
Console.WriteLine(compiled(5)); // Result: 11 
```

Notice that all expressions are immutable so they have to be built anew by composition. In this case, I've prepended an addition of 1.

Notice that these expression trees only work on real expressions i.e. content found in a C# function. You can't get syntax trees for higher constructs such as classes this way. Use the CodeDom framework for these.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T19:13:28.807

查看 .NET [CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)支持。有一篇关于[C# CodeDOM 解析器](http://www.codeproject.com/KB/recipes/codedomparser.aspx)的代码项目的旧文章，但它不支持新的语言功能。

根据此贴文，#develop 中也应该支持从 C# 源代码生成 CodeDom[树](http://geekswithblogs.net/willemf/archive/2006/07/24/86075.aspx)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-03-08T09:19:24.753

There is much powerful than R# project. Nemerle.Peg:

[https://code.google.com/p/nemerle/source/browse/nemerle/trunk/snippets/peg-parser/](https://code.google.com/p/nemerle/source/browse/nemerle/trunk/snippets/peg-parser/)

And it has C# Parser which parsers all C# code and translates it to AST !

[https://code.google.com/p/nemerle/source/browse/nemerle/trunk/snippets/csharp-parser/](https://code.google.com/p/nemerle/source/browse/nemerle/trunk/snippets/csharp-parser/)

You can download installer here: [https://code.google.com/p/nemerle/](https://code.google.com/p/nemerle/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-06T21:31:11.013

Personally, I would use [NRefactory](http://wiki.sharpdevelop.net/NRefactory.ashx), which is free, open source and gains popularity.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T18:12:35.047

It looks like this sort of functionality will be included with whatever comes after C# 4, according to [Anders Hejlsberg's 'Future of C#' PDC video](http://channel9.msdn.com/pdc2008/TL16/).

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-25T21:49:52.547

The [ANTLR Parser Generator](http://antlr.org/) has a grammar for C# 3.0 which covers everything except for LINQ syntax.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-04T06:47:40.377

ANTLR is not very useful. LINQ is not what you want.

Try Mono.Cecil! [http://www.mono-project.com/Cecil](http://www.mono-project.com/Cecil)

It is used in many projects, including NDepend! [http://www.ndepend.com/](http://www.ndepend.com/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-17T08:51:30.063

Our [C# front end for DMS](http://www.semanticdesigns.com/Products/FrontEnds/CSharpFrontEnd.html) parses full C# 3.0 including LINQ and produces ASTs. DMS in fact is an ecosystem for analyzing/transforming source code using ASTs for front-end provided langauges.

EDIT 3/10/2010: ... Now handles full C# 4.0

EDIT: 6/27/2014: Handles C# 5.0 since quite awhile.

EDIT: 6/15/2016: Handles C# 6.0\. See [https://stackoverflow.com/a/37847714/120163](https://stackoverflow.com/a/37847714/120163) for a sample AST.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-06T21:37:19.500

I've just answered on another thread here at StackOverflow a solution where I implemented an API to [create and manipulate AST from C# Source Code](https://stackoverflow.com/questions/81406/parser-for-c/2214810#2214810)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T19:13:54.970

请参阅 R# 项目（抱歉文档是俄语的，但有一些代码示例）。它允许对 C# 代码进行 AST 操作。

[http://www.rsdn.ru/projects/rsharp/article/rsharp_mag.xml](http://www.rsdn.ru/projects/rsharp/article/rsharp_mag.xml)

项目的 SVN 在[这里](http://svn.rsdn.ru/svn/RSharp/)：（URL 已更新，谢谢，[derigel](https://stackoverflow.com/users/12045/derigel)）

另请参阅[Nemerle](http://nemerle.org/Main_Page)语言。它是一种.Net 语言，对元编程有很强的支持。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-08T09:25:32.087

It is strange that nobody suggested hacking the existing Mono C# compiler.

# c# - 以编程方式在 UpdatePanel 中添加用户控件

> ID：213429
> 
> 赞同：13
> 
> 时间：2008-10-17T19:00:36.773
> 
> 标签：c#, asp.net, asp.net-ajax

我在带有部分回发的更新面板中动态添加控件时遇到问题。我已经阅读了许多关于动态控件的文章，并且我了解如何使用回发添加和维护它们，但大多数信息并不适用，并且不适用于部分回发。我找不到任何有关使用 UpdatePanels 添加和维护它们的有用信息。如果可能的话，我想在不创建 Web 服务的情况下执行此操作。有没有人对一些有用的信息有任何想法或参考？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T10:18:30.807

我认为，对于 asp.net 程序员来说，这是常见的陷阱之一，但是当你知道发生了什么时，实际上并不难做到（永远记住你的视图状态！）。

下面的一段代码解释了如何做。这是一个简单的页面，用户可以在其中单击菜单，该菜单将触发将用户控件添加到更新面板内的页面的操作。
（这段代码是[从这里](http://geekswithblogs.net/rashid/archive/2007/08/11/Loading-UserControl-Dynamically-in-UpdatePanel.aspx)借来的，并且有更多关于这个主题的信息）

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="SampleMenu1.aspx.cs" Inherits="SampleMenuPage1" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Sample Menu</title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:Menu ID="Menu1" runat="server" OnMenuItemClick="Menu1_MenuItemClick">
            <Items>
                <asp:MenuItem Text="File">
                    <asp:MenuItem Text="Load Control1"></asp:MenuItem>
                    <asp:MenuItem Text="Load Control2"></asp:MenuItem>
                    <asp:MenuItem Text="Load Control3"></asp:MenuItem>
                </asp:MenuItem>
            </Items>
        </asp:Menu>
        <br />
        <br />
        <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
        <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
            <ContentTemplate>
                <asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder>
            </ContentTemplate>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="Menu1" />
            </Triggers>
        </asp:UpdatePanel>
    </form>
</body>
</html> 
```

和

```
using System;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class PlainSampleMenuPage : System.Web.UI.Page
{
    private const string BASE_PATH = "~/DynamicControlLoading/";

    private string LastLoadedControl
    {
        get
        {
            return ViewState["LastLoaded"] as string;
        }
        set
        {
            ViewState["LastLoaded"] = value;
        }
    }

    private void LoadUserControl()
    {
        string controlPath = LastLoadedControl;

        if (!string.IsNullOrEmpty(controlPath))
        {
            PlaceHolder1.Controls.Clear();
            UserControl uc = (UserControl)LoadControl(controlPath);
            PlaceHolder1.Controls.Add(uc);
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        LoadUserControl();
    }

    protected void Menu1_MenuItemClick(object sender, MenuEventArgs e)
    {
        MenuItem menu = e.Item;

        string controlPath = string.Empty;

        switch (menu.Text)
        {
            case "Load Control2":
                controlPath = BASE_PATH + "SampleControl2.ascx";
                break;
            case "Load Control3":
                controlPath = BASE_PATH + "SampleControl3.ascx";
                break;
            default:
                controlPath = BASE_PATH + "SampleControl1.ascx";
                break;
        }

        LastLoadedControl = controlPath;
        LoadUserControl();
    }
} 
```

对于后面的代码。

基本上就是这样。您可以清楚地看到，当用户单击菜单项时，控件本身被动态添加到页面（在 updatePanel 内（实际上是在 updatePanel 内的 placeHolder 内），视图状态与*LastLoadedControl*一起保存，这将发送异步回发到服务器。

更多信息也可以在这里找到：

*   [http://aspnet.4guysfromrolla.com/articles/081402-1.aspx](http://aspnet.4guysfromrolla.com/articles/081402-1.aspx)
*   [http://aspnet.4guysfromrolla.com/articles/082102-1.aspx](http://aspnet.4guysfromrolla.com/articles/082102-1.aspx)

and of course on [the website that holds the example code](http://geekswithblogs.net/rashid/archive/2007/08/11/Loading-UserControl-Dynamically-in-UpdatePanel.aspx) I used here.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T08:46:56.680

I encountered the problem that using the method mentioned above, LoadUserControl() is called twice when handling an event. I've read through some other articles and would like to show you my modification:

1) Use LoadViewstate instead of Page_Load to load the user control:

```
protected override void LoadViewState(object savedState)
{
    base.LoadViewState(savedState);

    if (!string.IsNullOrEmpty(CurrentUserControl))
        LoadDataTypeEditorControl(CurrentUserControl, panelFVE);
} 
```

2) Don't forget to set the control id when loading the usercontrol:

```
private void LoadDataTypeEditorControl(string userControlName, Control containerControl)
{
    using (UserControl myControl = (UserControl) LoadControl(userControlName))
    {
        containerControl.Controls.Clear();

        string userControlID = userControlName.Split('.')[0];
        myControl.ID = userControlID.Replace("/", "").Replace("~", "");
        containerControl.Controls.Add(myControl);
    }
    this.CurrentUserControl = userControlName;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T08:56:09.583

Try this:

```
Literal literal = new Literal();
literal.Text = "<script type='text/javascript' src='http://www.googleadservices.com/pagead/conversion.js'>";
UpdatePanel1.ContentTemplateContainer.Controls.Add(literal); 
```

You can replace the content of literal with any HTML content you want...

# ruby-on-rails - Selenium RC：自动在多个浏览器中运行测试

> ID：213430
> 
> 赞同：8
> 
> 时间：2008-10-17T19:00:43.310
> 
> 标签：ruby-on-rails, ruby, unit-testing, selenium, automated-tests

因此，我开始创建一些 Ruby 单元测试，使用[Selenium RC](http://selenium-rc.openqa.org/)直接在浏览器中测试我的 Web 应用程序。我正在将[Selenum-Client](http://github.com/ph7/selenium-client/tree/master)用于红宝石。我为所有其他硒测试创建了一个基类来继承。

这会创建许多 SeleniumDriver 实例，并且在每个实例上调用所有缺少的方法。这实质上是并行运行测试。

**其他人是如何实现自动化的？**

这是我的实现：

```
class SeleniumTest < Test::Unit::TestCase
  def setup
    @seleniums = %w(*firefox *iexplore).map do |browser|
      puts 'creating browser ' + browser
      Selenium::SeleniumDriver.new("localhost", 4444, browser, "http://localhost:3003", 10000)
    end

    start
    open start_address
  end

  def teardown
      stop
  end

  #sub-classes should override this if they want to change it
  def start_address
    "http://localhost:3003/"
  end

  # Overrides standard "open" method
  def open(addr)
    method_missing 'open', addr
  end

  # Overrides standard "type" method
  def type(inputLocator, value)
    method_missing 'type', inputLocator, value
  end

  # Overrides standard "select" method
  def select(inputLocator, optionLocator)
    method_missing 'select', inputLocator, optionLocator
  end

  def method_missing(method_name, *args)
    @seleniums.each do |selenium_driver|
      if args.empty?
        selenium_driver.send method_name
      else
        selenium_driver.send method_name, *args
      end

    end
  end
end 
```

这可行，但如果一个浏览器失败，整个测试就会失败，并且无法知道它在哪个浏览器上失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-19T20:20:46.893

Did you try [Selenium Grid](http://selenium-grid.openqa.org/how_it_works.html)? I think it creates pretty good summary report which shows details you need. I may be wrong, as I didn't use it for quite a while.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T08:00:41.923

I ended up modifying Selenium's protocol.rb to raise an **`AssertionFailedError` with both the `@browser_string` and the message returned** from the Selenium RC if the response didn't start with "OK". I also modified the `http_post` method to return the whole response body and the `method_missing` to return an array of return values for issuing get_X commands to the Selenium RC.

**Add this code to the code in the question** and you should be able to see which assertions fail on which browsers.

```
# Overrides a few Driver methods to make assertions return the
# browser string if they fail
module Selenium
  module Client
    class Driver
      def remote_control_command(verb, args=[])
        timeout(default_timeout_in_seconds) do
          status, response = http_post(http_request_for(verb, args))
          raise Test::Unit::AssertionFailedError.new("Browser:#{@browser_string} result:#{response}") if status != 'OK'
          return response[3..-1]
        end
      end

      def http_post(data)
        http = Net::HTTP.new(@server_host, @server_port)
        response = http.post('/selenium-server/driver/', data, HTTP_HEADERS)
        #return the first 2 characters and the entire response body
        [ response.body[0..1], response.body ]
      end
    end
  end
end

#Modify your method_missing to use seleniums.map to return the
#results of all the function calls as an array
class SeleniumTest < Test::Unit::TestCase
  def method_missing(method_name, *args)
    self.class.seleniums.map do |selenium_driver|
      selenium_driver.send(method_name, *args)
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-19T14:17:46.750

*免责声明：不是硒专家。*

Do you just want to know which browser failed, or do you want to run the test across all browsers and then report the total failures when it's done?

The former is pretty simple if you store the drivers by hash in your setup. (I'm sure there's a fancy-pants way to do this with Hash.inject, but I'm lazy.)

```
@seleniums = {}
%w(*firefox *iexplore).each do |browser|
  puts 'creating browser ' + browser
  @seleniums[browser] = Selenium::SeleniumDriver.new("localhost", 4444, browser, "http://localhost:3003", 10000)
end 
```

Then change your core function to modify exceptions to include the name of the driver being used, something like:

```
@seleniums.each do |name, driver|
  begin
    driver.send method_name, *args
  rescue Exception => ex
    raise ex.exception(ex.message + " (in #{name})")
  end
end 
```

Should get you close.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-17T16:28:33.350

you need to treat every test independently. So if one test fails it will carry on testing other tests. Check out [phpunit and selenium rc](http://www.phpunit.de/manual/3.4/en/selenium.html)

# actionscript - 您是否需要在代码中添加一些内容才能访问 crossdomain.xml 允许的资产？

> ID：213443
> 
> 赞同：0
> 
> 时间：2008-10-17T19:02:28.300
> 
> 标签：actionscript, flash, crossdomain.xml

想知道我是否需要在我的 swf 中做一些事情才能访问不同服务器上的资产，这不仅仅是指定资产的 url。flash 是否会在幕后处理“获取 crossdomain.xml 并验证所有内容”，或者我是否需要包含一些特殊代码，而不仅仅是请求 swf 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T16:47:18.507

> flash 是否会在幕后处理“获取 crossdomain.xml 并验证所有内容”，或者我是否需要包含一些特殊代码，而不仅仅是请求 swf 文件？

如果有任何跨域请求，Flash 将在域的根目录中查找 crossdomain.xml 文件。例如，如果您从以下位置请求 XML 文件： `http://mysubdomain.mydomain.com/fu/bar/`

Flash 将检查 crossdomain.xml 文件是否存在于：`http://mysubdomin.mydomain.com/crossdomain.xml`

如果您需要从其他位置加载 crossdomain.xml 文件，您可以通过[Security.loadPolicyFile](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/system/Security.html#loadPolicyFile())来完成。请记住，此跨域的位置对您拥有的安全访问有任何影响。

您可能还想了解[Flash Player 10 中的安全更改](http://www.adobe.com/devnet/flashplayer/articles/fplayer9-10_security.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T19:09:29.330

如果您只是想访问另一个 swf，添加 crossdomain.xml 将为您完成所有工作，因为 Flash 将为您完成所有工作

# winforms - 在 Windows 窗体应用程序中写入跟踪信息

> ID：213451
> 
> 赞同：1
> 
> 时间：2008-10-17T19:03:36.220
> 
> 标签：winforms, debugging, trace

我知道如何编写可以在 webforms 环境中查看的跟踪语句，但是如何在 windows forms 应用程序中执行此操作？

我在一个静态方法中，我想显示它正在生成的 sql 查询。

我无权访问 messagebox.show，我有什么选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T19:09:46.863

最简单的方法是使用`System.Diagnostics.Debug.WriteLine`或`System.Diagnostics.Trace.WriteLine`。如果您附加了调试器，则消息将显示在输出窗口中，否则运行[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)以查看消息（您需要进行一些过滤以排除噪音）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T19:14:57.523

您可以使用[Log4Net](http://logging.apache.org/log4net/index.html)。

> Log4Net 完全是 Xml 配置驱动的，并提供了非常高的可扩展性（只需实现新的 Appenders、Filters 或 Layouts）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T19:08:44.060

您需要在表格中显示它吗？如果没有，您可以只 Trace.WriteLine() 查询并使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)来查看它。如果这没有帮助，我想我需要更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T19:09:24.073

System.Diagnostics.Trace 类将写入跟踪侦听器。

默认侦听器在调试时写入输出窗口。您可以在应用程序配置文件中指定其他侦听器，这些侦听器可以将跟踪输出重定向到文件、事件日志等。

或者使用 Log4Net 等日志框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T19:07:37.947

您可以使用全局日志记录对象：

```
enum LogLevel
{
    Info,
    Warning,
    Error
}

delegate void OnLog (string msg, LogLevel level);

interface ILogger
{
    void Log(string msg, LogLevel level);
    event OnLog;
} 
```

然后使用您使用 Program 类中的公共静态方法获取的类扩展 ILogger。

在您的主窗体中，将您自己附加到 OnLog 事件并使用它来为自己打印消息。然后，您所要做的就是使用 SQL 查询在静态方法中调用 Log 方法。

:)

# python - python线程安全对象缓存

> ID：213455
> 
> 赞同：15
> 
> 时间：2008-10-17T19:05:20.633
> 
> 标签：python, multithreading, caching

我已经实现了一个 python 网络服务器。每个 http 请求都会产生一个新线程。我需要在内存中缓存对象，并且由于它是一个网络服务器，我希望缓存是线程安全的。python中是否有线程安全对象缓存的标准实现？我发现了以下

[http://freshmeat.net/projects/lrucache/](http://freshmeat.net/projects/lrucache/)

这看起来不是线程安全的。任何人都可以指出我在 python 中很好地实现线程安全缓存吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T17:48:05.263

Python 中的很多操作默认情况下都是线程安全的，所以标准字典应该没问题（至少在某些方面）。这主要是由于 GIL，它有助于避免一些更严重的线程问题。

这里有一个列表： [http](http://coreygoldberg.blogspot.com/2008/09/python-thread-synchronization-and.html) ://coreygoldberg.blogspot.com/2008/09/python-thread-synchronization-and.html可能有用。

尽管这些操作的原子性质只是意味着如果您有两个线程同时访问字典，您将不会有完全不一致的状态。所以你不会有一个损坏的值。但是，您将（与大多数多线程编程一样）无法依赖这些原子操作的特定顺序。

所以长话短说……

如果您有相当简单的要求并且不关心写入缓存的顺序，那么您可以使用字典并知道您将始终获得一致/未损坏的值（它可能会超出日期）。

如果您想确保在读写方面更加一致，那么您可能需要查看 Django 的本地内存缓存：

[http://code.djangoproject.com/browser/django/trunk/django/core/cache/backends/locmem.py](http://code.djangoproject.com/browser/django/trunk/django/core/cache/backends/locmem.py)

它使用读/写锁进行锁定。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T20:39:48.493

每个请求的线程通常是一个坏主意。如果您的服务器遇到巨大的负载峰值，它将使机器瘫痪。考虑使用可以在高峰使用期间增长到有限大小并在负载较轻时缩小到较小大小的线程池。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:18:25.120

您可能想改用 memcached。它非常快、非常稳定、非常流行，有很好的 python 库，如果你需要，它可以让你成长为分布式缓存：

[http://www.danga.com/memcached/](http://www.danga.com/memcached/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-26T14:54:05.333

**第 1 点。** GIL 在这里对您没有帮助，一个名为“存根”的（非线程安全）缓存的示例是

```
stubs = {}

def maybe_new_stub(host):
    """ returns stub from cache and populates the stubs cache if new is created """
    if host not in stubs:
        stub = create_new_stub_for_host(host)
        stubs[host] = stub
    return stubs[host] 
```

可能发生的情况是线程 1 调用`maybe_new_stub('localhost')`，它发现我们在缓存中还没有那个键。现在我们切换到线程 2，它调用了相同的`maybe_new_stub('localhost')`，并且它还知道密钥不存在。因此，两个线程都调用`create_new_stub_for_host`并将其放入缓存中。

映射本身受 GIL 保护，因此我们不能通过并发访问来破坏它。然而，缓存的逻辑并没有受到保护，因此我们最终可能会创建两个或更多存根，并将除一个之外的所有存根都丢弃在地板上。

**第 2 点。**根据程序的性质，您可能不需要全局缓存。这种共享缓存会强制所有线程之间进行同步。出于性能原因，最好使线程尽可能独立。我相信我确实需要它，你可能实际上不需要。

**第 3 点。**您可以使用简单的锁。我从[https://codereview.stackexchange.com/questions/160277/implementing-a-thread-safe-lrucache](https://codereview.stackexchange.com/questions/160277/implementing-a-thread-safe-lrucache)中获得灵感，并提出了以下内容，我认为可以安全地用于我的目的

```
import threading

stubs = {}
lock = threading.Lock()

def maybe_new_stub(host):
    """ returns stub from cache and populates the stubs cache if new is created """
    with lock:
        if host not in stubs:
            channel = grpc.insecure_channel('%s:6666' % host)
            stub = cli_pb2_grpc.BrkStub(channel)
            stubs[host] = stub
        return stubs[host] 
```

**第 4 点**。最好使用现有的库。我还没有找到任何我准备担保的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-02T19:09:51.410

对于线程安全对象，您需要 threading.local：

```
from threading import local

safe = local()

safe.cache = {} 
```

`safe.cache`然后，您可以在线程安全的情况下放入和检索对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-19T20:46:46.850

我不确定这些答案是否符合您的要求。

我有一个类似的问题，我正在使用一个名为[cachetools](https://cachetools.readthedocs.io/en/stable/)的 lrucache 替代品，它允许您传递一个锁以使其更安全。

# c - 像 C 中的库一样提升

> ID：213460
> 
> 赞同：33
> 
> 时间：2008-10-17T19:06:53.970
> 
> 标签：c, boost

你能推荐我可以在 C 环境中使用的同行评审库（比如 Boost for C++）吗？提供散列、线程、进程间通信、列表、智能内存管理的东西……

环境是嵌入式系统，不是很小的系统，也不是PC！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T19:18:04.790

[我也为GLib](http://library.gnome.org/devel/glib/stable/) +1 。另外，它也有自己的[线程 API](http://library.gnome.org/devel/glib/stable/glib-Threads.html)，所以如果你不想学习 pthreads，你不必学习。

不确定C中是否存在“智能内存管理”之类的东西，当你没有析构函数的安全网和对操作符的控制时，这并不容易。但是，同样，GLib 有大量面向内存的数据结构和真正让生活更轻松的东西。

不，我不在 GLib 团队，但我真的很喜欢它。:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-07-28T19:37:26.863

查看[Apache Portable Runtime (APR)](http://apr.apache.org/)项目。

它的一些特点：

*   内存管理 API
*   线程，互斥体
*   文件输入/输出
*   原子操作
*   哈希表、数组
*   网络套接字和协议
*   共享内存，mmap

更不用说它的*便携性*了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T19:09:57.660

我不确定你是否会找到一个涵盖所有这些的单一库......但你可以查看[glib](http://library.gnome.org/devel/glib/)和[pthreads](https://computing.llnl.gov/tutorials/pthreads/)来涵盖其中的大部分内容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T19:30:55.713

看看[Boehm GC](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)，它是一种广泛使用的 C（或 C++）保守垃圾收集器，就智能内存管理而言，它可能满足您的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T19:19:07.860

我也会加入 GLib 的潮流。请记住，C 没有为复杂的数据结构提供任何语法糖，因此 GLib 中有很多强制转换和长函数名，但它确实做得很好而且很有效，只是增加了一点冗长！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T19:47:44.900

关于 Glib 的使用。

您可能可以获取所需的内容并进行交叉编译。因此，如果您只需要线程包 - 只需编译它，不要拿走所有东西。

我正在用 Python VM 做同样的事情。PyMite 适合微控制器，并不使用所有功能。

# asp.net - window.returnValue 属性允许的最大长度是多少？(JavaScript)

> ID：213461
> 
> 赞同：1
> 
> 时间：2008-10-17T19:07:05.700
> 
> 标签：asp.net, javascript, vb.net

在模态中使用 window.returnValue （变体）时是否有最大长度？

我正在使用 showModalDialog() 调用模式窗口并返回逗号分隔的字符串。选择一组用户后，我将它们放入字符串构建器中以文字形式显示。

```
Dim strReturn As New StringBuilder
strReturn.Append("<script type=""text/javascript"">window.returnValue='")
Dim strUsers As New StringBuilder
For Each dtRow As DataRow In GetSelectedUserTable.Rows
    If strUsers.ToString.Length > 0 Then
        strUsers.Append(",")
    End If
    strUsers.Append(dtRow("UserID"))
Next
strReturn.Append(strUsers.ToString)
strReturn.Append("';window.close();</script>")
litReturnJavascript.Text = strReturn.ToString 
```

那么window.returnValue中可以添加多少个字符会有限制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T19:45:38.803

首先，您在哪个浏览器中遇到问题？`window.returnValue`Firefox 甚至不支持，甚至其他浏览器也不支持。

其次，您是否`strUsers`在构建它以确保该字符串中没有单引号或双引号后查看了它的值？

我猜想该属性的最大大小/长度将更多地取决于您的系统内存而不是其他任何东西。

* * *

编辑：也许你应该看看使用`window.open()`打开一个新窗口并`window.opener`在父表单上设置值 - 它受到更多浏览器的支持。只是一个建议...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T19:59:44.300

我的用户必须使用 IE6（不是我的电话），并且模式已经为 IE 连接，所以这就是我使用 showModalDialog 的原因。

strUsers 将始终是逗号分隔的整数列表

```
E.G.: 384834,583882,343993,391823,302103 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T11:41:59.093

JasonBunting 有一个很好的建议。您可以在关闭它之前让模态对话框更新父级。这样，您可以在窗口之间来回传递对象，而不必担心返回值的限制。例如，您可以在使用返回值更新的父项上有一个隐藏字段。

# javascript - 使用 MVC 以可重用的方式将客户端逻辑与服务器端逻辑分离

> ID：213465
> 
> 赞同：8
> 
> 时间：2008-10-17T19:07:40.957
> 
> 标签：javascript, asp.net-mvc, model-view-controller

在你回答之前，这个问题很复杂：

1.  我们正在 asp.net / asp.net mvc / jQuery 中开发，但我对使用任何框架的任何平台上的解决方案持开放态度
2.  我认为排序/隐藏列/重新排列列/验证（有意义的地方）之类的逻辑应该在客户端
3.  我认为像搜索/更新数据库/运行工作流这样的逻辑应该在服务器端（只是因为安全/调试原因）

我们要做的**不是**通过编写一堆 JavaScript 来处理不同上下文中的相同功能，从而在我们的 UI 中造成混乱。我知道我可以使用 JavaScript 文件 + 面向对象的 JavaScript，我正在寻找使这一切变得更容易的模式。

提出的一种解决方案是在客户端和服务器端都有一个 MVC 模型，我们可以在客户端控制器中封装 JavaScript 功能，然后在站点的不同部分使用它们。但是，这意味着我们有 2 个 MVC 实现！

这是矫枉过正吗？您将如何扩展此解决方案？还有哪些其他解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T11:51:23.427

我只是在谷歌上搜索了这个，所以把它带上一粒盐。 [JavascriptMVC](http://javascriptmvc.com/)声称是一个 MVC 框架。同样，我没有这方面的经验，但它可能值得一看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:26:53.487

把事情简单化。构建您的应用程序以在 MVC ASP.Net 框架中完全发挥作用。在这个测试阶段不需要 JavaScript。

现在，通过在您的 site.master（Google 链接）中链接 jQuery 并在需要 Web 2.0 体验的视图底部添加好东西，链接到适当的 JS 文件，以不显眼地添加功能。关闭 JS，您的应用会降级到上一步。

例如，除了服务器端之外，您还想添加客户端验证。JS 文件会将事件处理程序附加到 onsubmit 表单。然后，处理程序将使用由服务器生成的对象（用于服务器验证的同一对象），该对象最好作为 JSON 对象，因为它与 JS 和 ASP.NET 兼容。该对象的成员将是要检查的规则和要在您选择服务器端错误的同一位置写入 DOM 的错误消息。您的处理程序返回 false 直到所有内容都有效并且正确时返回 true。

您想要一个漂亮的花哨功能，例如图片的灯箱视图。为您的视图添加插件，修改标记`<ul id="lightup">`...，添加代码：

```
$（函数（）{
   $(#lightup).showit(400); // 或类似的东西
});

```

和你的好去。

尝试将共享功能从您的服务器代码中分离到 Web 服务或页面中，以便客户端通过 XHR 和服务器可以共享相同的功能/数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T19:22:37.540

两个；您应该始终进行服务器端验证和客户端验证

三；如果您能找到一种在客户端操作数据库的方法，那将是令人印象深刻的；）

我不知道 ASP.net 是如何工作的，所以我只是从我的 PHP 经验中说。

我会编写由服务器和客户端代码配对的控件。每个控件都需要一个表单、客户端逻辑和服务器端逻辑。表单由模板引擎写出，客户端逻辑附加到表单并用 JS 编写，服务器端逻辑是操纵模型的控制器/动作对。显然，您不想将客户端逻辑耦合到特定的操作/控制器，因此请务必定义一个可用于与您的控件对话的接口......

然后对于每个表单，我会在 javascript 中编写一个类来实例化您的控件。例如; 你可能有一个控制：

```
{include file = "list_view.php" id = "ListView1" data = $Data.List} 
```

这会将您的表格打印出来。然后在您的页面控制器类中：

```
this.ListView1 = new ListViewController({id : "ListView1", serverCtrl : "Users"}); 
```

现在您可以使用“this.ListView1”来操作列表视图。如果用户按下下一页按钮，列表视图控制器会执行诸如对新页面进行 AJAX 查询的操作 - 并且还处理列和排序（这也将委托给服务器）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-19T22:57:50.163

如果您使用的是 MVC，那么我假设您的视图使用模板引擎。每个页面都与一个模板相关联，每个模板通常包含对一个或多个脚本的引用。问题是，您的脚本是如何在模板中引用的？它们是静态的，还是动态的？在您的控制器中，您应该可以选择在用于页面的视图中包含任何脚本，而不管模板如何。我经常建议这种“在需要时包含它”的方法，因为模拟 MVC 客户端正是您所说的意思——您现在有两个 MVC 框架需要维护。不仅如此——对于大多数客户端模型，它们可以直接访问您的服务器端模型，这违背了您的服务器端 MVC 的目的。您现在完全绕过了控制器。

当涉及到 JavaScript 时，最好的办法就是保持它非常简单。使用 jQuery，您有更好的机会实现这一目标。每个页面都有核心，在同一个文件夹中还有几个其他的 JavaScript 文件，每个都是映射到非常特定功能的 jQuery 对象的插件或扩展。如果开发人员想知道功能是否已经存在，您只需检查 JavaScript 文件所在的文件系统。如果插件存在，请将其包含在您的控制器中以在页面中使用。通过这种方式，您可以在位于客户端应用程序和任何现有控制器之间的服务器端构建助手。帮助程序特定于该功能和插件，并且您不会从客户端打开对模型的全面访问。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-11T15:42:12.013

不要将 json/xml 返回到视图并在客户端使用 jquery dom 生成来构建它们。在体面的机器上性能不错，但我犯了这个错误，当我试图用我的 iphone 查看网站时，加载需要 60 秒......而且我是网站上唯一的人！:-)

所以此时我只是使用 jquery dom 注入来进行 ajaxy 更新，而不是渲染整个页面。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-17T19:24:54.977

... 这取决于...

实际上最好的事情是使用 css / javascript / html 为样式 / 行为 / 结构 + 数据开发 UI，现在人们想要 ajax 交互（他们到处都能看到很酷的东西，所以他们期望他们不必每次重新加载整个页面）所以我认为你应该考虑到这一点。BTW MVC 在您的内容被提供时结束，并且它*不必是*HTML 内容，您可以在视图中提供 xml 或 json。

ASP.NET MVC 允许返回 Content("TEXT") 以便您可以使用 MVC 和 javascript 中的用户交互/行为来组织后端，例如，当向服务器发送 ajax 调用时，您正在调用应用程序的控制器部分，因此您可以调用一个 Ajax 操作来切换到呈现为 JSON 并返回到 UI 的 JS 部分（行为部分）的 ajax 模型。

由于行为部分是在您的视图部分中定义的（初始视图由 CSS / HTML JS 组成），所以只要是表示部分*，我认为*您没有破坏 MVC 模式。

PS。我忘了说显然数据库操作保留在您的模型中（您可以将模型视为数据访问层 + 业务对象层所在的位置）

# sql - 在 SQL 中“透视”表（即交叉表/交叉表）

> ID：213476
> 
> 赞同：4
> 
> 时间：2008-10-17T19:11:01.323
> 
> 标签：sql, database, oracle, pivot

我正在尝试从几个数据库表中生成报告。简化版是这样的

```
Campaign
----------
CampaignID

Source
-----------------------
Source_ID | Campaign_ID

Content
---------------------------------------------------------
Content_ID | Campaign_ID | Content_Row_ID | Content_Value 
```

报告需要这样写：

```
CampaignID - SourceID - ContentRowID(Value(A)) - ContentRowID(Value(B)) 
```

其中 ContentRowID(Value(A)) 表示“查找具有给定 CampaignID 且 ContentRowId 为“A”的行，然后获取该行的 ContentValue”

本质上，我必须将行“透视”（我认为这是正确的术语）成列......

这是一个Oracle 10g 数据库...

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T01:32:39.790

比尔卡尔文提到了这一点，但我认为这值得非常清楚地指出：

**SQL 不能满足您的要求，因此您获得的任何“解决方案”都将是一个杂项。**

如果您肯定*知道*它总是会在 Oracle 10 上运行，那么可以肯定的是，Walter Mitty 的交叉制表可能会做到这一点。正确的方法是在查询和应用程序代码中使用最简单的排序顺序组合来正确布局。

*   它适用于其他数据库系统，
*   它不会冒任何其他层崩溃的风险（例如，我记得 MySQL 有 >255 列的问题。你确定你的*接口库*和数据库本身一样吗？）
*   它（通常）没有那么难。

如果需要，您可以`Content_Row_ID`先询问 s，然后询问您需要的任何行，按 , 排序`CampaignID`，`ContentRowID`这将为您提供从左到右、逐行顺序的每个（填充的）单元格。

* * *

附言。

现代人认为SQL应该拥有/做的很多东西只是不存在。这是一个，生成的范围是另一个，递归闭包、参数化`ORDER BY`、标准化编程语言……不胜枚举。（虽然，诚然，有一个技巧`ORDER BY`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T19:39:32.170

这是我第一次尝试它。一旦我对 Content 表的内容有了更多了解，就会进行细化。

首先，您需要一个临时表：

```
CREATE TABLE pivot (count integer);
INSERT INTO pivot VALUES (1);
INSERT INTO pivot VALUES (2); 
```

现在我们准备好查询了。

```
SELECT campaignid, sourceid, a.contentvalue, b.contentvalue
FROM content a, content b, pivot, source
WHERE source.campaignid = content.campaignid
AND pivot = 1 AND a.contentrowid = 'A'
AND pivot = 2 AND b.contentrowid = 'B' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T20:35:07.707

如果您没有动态数量的列并且您的数据集不是太大，您可以这样做......

```
SELECT CampaignID, SourceID, 
   (SELECT Content_Value FROM Content c 
      WHERE c.Campaign_ID=s.Campaign_ID 
      AND Content_Row_ID = 39100 
      AND rownum<=1) AS Value39100,
   (SELECT Content_Value FROM Content c 
      WHERE c.Campaign_ID=s.Campaign_ID 
      AND Content_Row_ID = 39200 
      AND rownum<=1) AS Value39200
FROM Source s; 
```

对每个附加的 Content_Row_ID 重复子查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T20:35:29.280

要在标准 SQL 中执行此操作，您确实需要知道 Content_Row_ID 的所有不同值，并对每个不同值进行连接。然后，您需要为 Content_Row_ID 的每个不同值创建一列。

```
SELECT CA.Campaign_ID, 
  C1.Content_Value AS "39100",
  C2.Content_Value AS "39200",
  C3.Content_Value AS "39300"
FROM Campaign CA
  LEFT OUTER JOIN Content C1 ON (CA.Campaign_ID = C1.Campaign_ID 
    AND C1.Content_Row_ID = 39100)
  LEFT OUTER JOIN Content C2 ON (CA.Campaign_ID = C2.Campaign_ID 
    AND C2.Content_Row_ID = 39200)
  LEFT OUTER JOIN Content C3 ON (CA.Campaign_ID = C3.Campaign_ID 
    AND C3.Content_Row_ID = 39300); 
```

随着不同值的数量越来越大，此查询变得过于昂贵而无法有效运行。更简单地获取数据并在 PL/SQL 或应用程序代码中重新格式化它可能更容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T02:12:53.907

Bill Karwin 和 Anders Eurenius 是正确的，没有直接的解决方案，当预先不知道结果列值的数量时，也根本没有任何解决方案。Oracle 11g 确实使用[PIVOT 运算符对其进行了一定程度的](http://www.oracle.com/technology/pub/articles/oracle-database-11g-top-features/11g-pivot.html)简化，但列仍然必须提前知道，这不符合您问题的 10g 标准。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T20:09:30.863

如果您需要动态数量的列，我不相信这可以在标准 SQL 中完成，唉，这超出了我的知识范围。但是 Oracle 的某些功能可以做到这一点。我找到了一些资源：

[http://www.sqlsnippets.com/en/topic-12200.html](http://www.sqlsnippets.com/en/topic-12200.html)

[http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:124812348063#41097616566309](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:124812348063#41097616566309)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T20:23:05.453

如果您有“Oracle, the Complete Reference”，请查找标题为“Turning a Table on Its Side”的部分。这给出了执行枢轴的详细示例和说明，尽管我拥有的版本并未将其称为枢轴。

“透视表”的另一个术语是交叉制表。

用于执行交叉制表的最简单工具之一是 MS Access。如果您有 MS Access，并且可以建立从 Access 数据库到源表的表链接，那么您已经完成了一半。

此时，您可以启动“查询向导”，并要求它为您构建交叉表查询。这真的就像回答向导问你的问题一样简单。这个解决方案的不幸的一面是，如果在 SQL 视图中查看生成的查询，您会看到一些 SQL 的 Access 方言特有的 SQL，通常不能跨其他平台使用。

您还可以从 Oracle 网站下载一些简单的分析工具，并使用其中一种工具为您执行交叉制表。

再一次，如果您真的想在 SQL 中执行此操作，“Oracle，完整参考”应该可以帮助您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-03T12:58:46.890

如果您不知道前面的列数，只需带回一个普通的 sql 查询并使用我在此处列出的服务器端代码：[Filling Datagrid And Sql Query](https://stackoverflow.com/questions/333181/a-question-about-datagrid-and-sql-query)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-07T17:28:18.113

我用这个 SQL 做了一个解决方案。我需要行是类的数量，列是每个类按月的总和，所以，第一列是行的总和，每个其他列是每个月的总和，最后一行是总和逐月完成列。

祝你好运

```
Select DS.Cla,
Sum(case
when (Extract(year from DS.Data) =:intYear) then DS.PRE
else 0
end) as ToTal,
Sum(case
when (Extract(month from DS.Data) =1) then DS.PRE
else 0
end) as Jan,
Sum(case
when (Extract(month from DS.Data) =2) then DS.PRE
else 0
end) as FEV,
Sum(case
when (Extract(month from DS.Data) =3) then DS.PRE
else 0
end) as MAR,
Sum(case
when (Extract(month from DS.Data) =4) then DS.PRE
else 0
end) as ABR,
Sum(case
when (Extract(month from DS.Data) =5) then DS.PRE
else 0
end) as MAI,
Sum(case
when (Extract(month from DS.Data) =6) then DS.PRE
else 0
end) as JUN,
Sum(case
when (Extract(month from DS.Data) =7) then DS.PRE
else 0
end) as JUL,
Sum(case
when (Extract(month from DS.Data) =8) then DS.PRE
else 0
end) as AGO,
Sum(case
when (Extract(month from DS.Data) =9) then DS.PRE
else 0
end) as SETE,
Sum(case
when (Extract(month from DS.Data) =10) then DS.PRE
else 0
end) as OUT,
Sum(case
when (Extract(month from DS.Data) =11) then DS.PRE
else 0
end) as NOV,
Sum(case
when (Extract(month from DS.Data) =12) then DS.PRE
else 0
end) as DEZ
from Dados DS
Where DS.Cla > 0
And Extract(Year from DS.Data) = :intYear
group by DS.CLA

Union All

Select 0*count(DS.cla),  0*count(DS.cla),
Sum(case
when (Extract(month from DS.Data) =1) then DS.PRE
else 0
end) as JAN,
Sum(case
when (Extract(month from DS.Data) =2) then DS.PRE
else 0
end) as FEV,
Sum(case
when (Extract(month from DS.Data) =3) then DS.PRE
else 0
end) as MAR,
Sum(case
when (Extract(month from DS.Data) =4) then DS.PRE
else 0
end) as ABR,
Sum(case
when (Extract(month from DS.Data) =5) then DS.PRE
else 0
end) as MAI,
Sum(case
when (Extract(month from DS.Data) =6) then DS.PRE
else 0
end) as JUN,
Sum(case
when (Extract(month from DS.Data) =7) then DS.PRE
else 0
end) as JUL,
Sum(case
when (Extract(month from DS.Data) =8) then DS.PRE
else 0
end) as AGO,
Sum(case
when (Extract(month from DS.Data) =9) then DS.PRE
else 0
end) as SETE,
Sum(case
when (Extract(month from DS.Data) =10) then DS.PRE
else 0
end) as OUT,
Sum(case
when (Extract(month from DS.Data) =11) then DS.PRE
else 0
end) as NOV,
Sum(case
when (Extract(month from DS.Data) =12) then DS.PRE
else 0
end) as DEZ
from Dados DS
Where DS.Cla > 0
And Extract(Year from DS.Data) = :intYear 
```

# c# - 在 C# 中将控制台窗口置于前面

> ID：213480
> 
> 赞同：12
> 
> 时间：2008-10-17T19:11:35.393
> 
> 标签：c#, console, window

如何在 C# 中将控制台应用程序窗口置于前面（尤其是在运行 Visual Studio 调试器时）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-17T19:40:48.173

这很hacky，很可怕，但它对我有用（感谢[pinvoke.net](http://pinvoke.net/)！）：

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Threading;

public class Test 
{

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("user32.dll", EntryPoint="FindWindow", SetLastError = true)]
    static extern IntPtr FindWindowByCaption(IntPtr zeroOnly, string lpWindowName);

    public static void Main()
    {
        string originalTitle = Console.Title;
        string uniqueTitle = Guid.NewGuid().ToString();
        Console.Title = uniqueTitle;
        Thread.Sleep(50);
        IntPtr handle = FindWindowByCaption(IntPtr.Zero, uniqueTitle);

        if (handle == IntPtr.Zero)
        {
            Console.WriteLine("Oops, cant find main window.");
            return;
        }
        Console.Title = originalTitle;

        while (true)
        {
            Thread.Sleep(3000);
            Console.WriteLine(SetForegroundWindow(handle));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-22T04:36:51.757

这就是我会做的。

```
[DllImport("kernel32.dll", ExactSpelling = true)]
public static extern IntPtr GetConsoleWindow();

[DllImport("user32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
public static extern bool SetForegroundWindow(IntPtr hWnd);

public void BringConsoleToFront()
{
    SetForegroundWindow(GetConsoleWindow()); 
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-10-17T20:01:31.987

获取两个监视器（至少）并在辅助监视器中打开 VisualStudio。当您从 VisualStudio 中运行您的应用程序时，它将默认在主监视器上启动。由于它是最后一个打开的应用程序，它从顶部开始，切换到 VisualStudio 不会影响它。无论如何对我有用。

如果您还没有第二台显示器，恕我直言，您应该这样做。

# python - 一个好的多线程 python 网络服务器？

> ID：213483
> 
> 赞同：13
> 
> 时间：2008-10-17T19:12:38.590
> 
> 标签：python, apache, webserver, mod-python

我正在寻找一个多线程而不是多进程的python网络服务器（例如mod_python for apache）。我希望它是多线程的，因为我想要一个内存对象缓存，供各种 http 线程使用。我的网络服务器做了很多昂贵的事情并计算了一些需要缓存在内存中以备将来使用以避免重新计算的大型数组。这在多进程 Web 服务器环境中是不可能的。将这些信息存储在 memcache 中也不是一个好主意，因为数组很大，并且将它们存储在 memcache 中会导致来自 memcache 的数据的反序列化，除了 IPC 的额外开销。

我使用 BaseHttpServer 实现了一个简单的网络服务器，它提供了良好的性能，但几个小时后就卡住了。我需要一些更成熟的网络服务器。是否可以将 apache 配置为在线程模型下使用 mod_python 以便我可以进行一些对象缓存？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-17T19:33:25.227

[樱桃派](http://cherrypy.org/)。网站上列出的功能：

*   一个快速的、符合 HTTP/1.1 的、WSGI 线程池网络服务器。通常，CherryPy 本身每页只需要 1-2 毫秒！
*   Support for any other WSGI-enabled webserver or adapter, including Apache, IIS, lighttpd, mod_python, FastCGI, SCGI, and mod_wsgi
*   Easy to run multiple HTTP servers (e.g. on multiple ports) at once
*   A powerful configuration system for developers and deployers alike
*   A flexible plugin system
*   Built-in tools for caching, encoding, sessions, authorization, static content, and many more
*   A native mod_python adapter
*   A complete test suite
*   Swappable and customizable...everything.
*   Built-in profiling, coverage, and testing support.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-17T19:35:04.240

Consider reconsidering your design. Maintaining that much state in your webserver is probably a bad idea. Multi-process is a much better way to go for stability.

Is there another way to share state between separate processes? What about a service? Database? Index?

It seems unlikely that maintaining a huge array of data in memory and relying on a single multi-threaded process to serve all your requests is the best design or architecture for your app.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-18T03:32:42.917

[Twisted](http://twistedmatrix.com/) can serve as such a web server. While not multithreaded itself, there is a (not yet released) multithreaded WSGI container present in the current trunk. You can check out the SVN repository and then run:

```
twistd web --wsgi=your.wsgi.application 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T20:34:06.773

Its hard to give a definitive answer without knowing what kind of site you are working on and what kind of load you are expecting. Sub second performance may be a serious requirement or it may not. If you really need to save that last millisecond then you absolutely need to keep your arrays in memory. However as others have suggested it is more than likely that you don't and could get by with something else. Your usage pattern of the data in the array may affect what kinds of choices you make. You probably don't need access to the entire set of data from the array all at once so you could break your data up into smaller chunks and put those chunks in the cache instead of the one big lump. Depending on how often your array data needs to get updated you might make a choice between memcached, local db (berkley, sqlite, small mysql installation, etc) or a remote db. I'd say memcached for fairly frequent updates. A local db for something in the frequency of hourly and remote for the frequency of daily. One thing to consider also is what happens after a cache miss. If 50 clients all of a sudden get a cache miss and all of them at the same time decide to start regenerating those expensive arrays your box(es) will quickly be reduced to 8086's. So you have to take in to consideration how you will handle that. Many articles out there cover how to recover from cache misses. Hope this is helpful.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T19:22:28.320

不是多线程的，但[扭曲](http://twistedmatrix.com/trac/)的可能会满足您的需求。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T19:27:36.050

也许您在 Python 中使用`BaseHttpServer`. 它没有理由“卡住”，并且使用并且实现一个简单的线程服务器`BaseHttpServer`应该`threading`不难。

另外，请参阅[http://pymotw.com/2/BaseHTTPServer/index.html#module-BaseHTTPServer](http://pymotw.com/2/BaseHTTPServer/index.html#module-BaseHTTPServer)关于实现一个简单的多线程服务器`HTTPServer`和`ThreadingMixIn`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T19:31:15.980

您可以改为使用可从每个进程访问的分布式缓存，[memcached](http://www.danga.com/memcached/)就是您想到的示例。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-18T17:12:17.050

web.py has made me happy in the past. Consider checking it out.

But it does sound like an architectural redesign might be the proper, though more expensive, solution.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T19:30:57.803

我个人和专业都使用 CherryPy，对此我感到非常满意。我什至做了你描述的那种事情，比如拥有全局对象缓存，在后台运行其他线程等等。它与 Apache 集成得很好；只需将 CherryPy 作为绑定到 localhost 的独立服务器运行，然后使用 Apache`mod_proxy`并`mod_rewrite`让 Apache 透明地将您的请求转发给 CherryPy。

CherryPy 网站是[http://cherrypy.org/](http://cherrypy.org/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-18T17:04:14.523

I actually had the same issue recently. Namely: we wrote a simple server using BaseHTTPServer and found that the fact that it's not multi-threaded was a big drawback.

My solution was to port the server to Pylons ([http://pylonshq.com/](http://pylonshq.com/)). The port was fairly easy and one benefit was it's very easy to create a GUI using Pylons so I was able to throw a status page on top of what's basically a daemon process.

I would summarize Pylons this way:

*   it's similar to Ruby on Rails in that it aims to be very easy to deploy web apps
*   it's default templating language, Mako, is very nice to work with
*   it uses a system of routing urls that's very convenient
*   for us performance is not an issue, so I can't guarantee that Pylons would perform adequately for your needs
*   you can use it with Apache & Lighthttpd, though I've not tried this

We also run an app with Twisted and are happy with it. Twisted has good performance, but I find Twisted's single-threaded/defer-to-thread programming model fairly complicated. It has lots of advantages, but would not be my choice for a simple app.

Good luck.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T20:31:57.823

Just to point out something different from the usual suspects...

Some years ago while I was using [Zope](http://zope.org/) 2.x I read about [Medusa](http://www.nightmare.com/medusa/medusa.html) as it was the web server used for the platform. They advertised it to work well under heavy load and it can provide you with the functionality you asked.

# vmware - VMWARE ESXi PANIC：找不到 HD 引导分区

> ID：213486
> 
> 赞同：-8
> 
> 时间：2008-10-17T19:14:03.580
> 
> 标签：vmware, esxi

我在安装 VMWARE ESXi 服务器时遇到问题。安装完成，没有任何错误消息，并提示我重新启动。按 Enter 后系统重新启动。通过黄色加载屏幕启动时，它会切换到黑色并显示以下错误消息：

PANIC: 找不到 HD 启动分区

所有模块均已加载，没有任何错误。在控制台中输入 unsupported 后，busybox 会出现。我查看了 /dev/disks 目录，但没有列出与安装过程不同的磁盘设备。显示了在 MPC51 控制器上安装两个 sata 磁盘期间切换到系统控制台。控制器名为 vmhba0 和 vmhba32。

有谁知道如何解决这个问题？！

硬件是 Fujitsu-Siemens 的 ESPRIMO P5615 (nForce4)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T01:20:41.727

我发现的唯一解决方案是从拇指驱动器运行服务器并使用嵌入式硬盘驱动器来存储您的虚拟服务器。这个解决方案对我有用。

要以这种方式实现这一点，您将需要：

*   一个 1GB 或更大的 USB 拇指驱动器
*   一台活动的 Linux 机器（或者，使用 PowerEdge 上的 liveCD 选项，例如 Knoppix 或 Gentoo LiveCD）

挂载 ESXi ISO：

```
mount -t iso9660 -o loop VMware-VMvisor-InstallerCD-3.5.0_Update_2-110271.i386.iso /mnt/esx 
```

将安装程序文件写入 U 盘：

```
tar xvzf /mnt/esx/install.tgz usr/lib/vmware/installer/VMware-VMvisor-big-3.5.0_Update_2-110271.i386.dd.bz2 -O | bzip2 -d -c | dd of=/dev/sdb 
```

此处的假设（根据您的设置进行调整）：

*   `/dev/sdb`是您的拇指驱动器所在的位置
*   `VMware-VMvisor-InstallerCD-3.5.0_Update_2-110271.i386.iso`是您的 ISO 文件的名称
*   `usr/lib/vmware/installer/VMware-VMvisor-big-3.5.0_Update_2-110271.i386.dd.bz2`是你iso中dd文件的名字（运行`tar ztf /mnt/esx/install.tgz`看看你的确切文件名是什么，应该是相似的，比较明显）

It will take a few minutes to write, and when it's done simply boot off of this thumb drive. The PowerEdge servers have an internal USB (at least mine does) if aesthetics are important to you.

Source: [http://cyborgworkshop.org/2008/08/30/install-vmware-esxi-onto-a-usb-thumbdrive/](http://cyborgworkshop.org/2008/08/30/install-vmware-esxi-onto-a-usb-thumbdrive/)

EDIT 12/19/2009: ESXi 4.0.0 uses image.tgz instead of install.tgz to store it's dd file

# sharepoint - 不错的文件管理软件

> ID：213493
> 
> 赞同：2
> 
> 时间：2008-10-17T19:15:29.647
> 
> 标签：sharepoint, filesystems, file-management

目前，我们所有的文件都存储在 Windows 网络驱动器上，并且有 15 名员工和 3 名外部工作人员，文件控制开始变得有点像噩梦。即使我们制定了政策，人们似乎仍然将文件保存到他们的 PC、进行更改并在不通知任何人的情况下将其复制回来，通过电子邮件而不是其位置发送文件，并创建仅对他们有意义的文件夹/结构.

因此，在最近的一个项目中，我们发现 3 名员工正在使用同一文档的不同版本，而当这 3 个人是编辑和校对者时，您可能可以想象到最后会出现的问题。

所以我们正在寻找一些不错的简单文件管理应用程序。已经提到了 MS Sharepoint，但我们希望摆脱与 Windows 机器的绑定，而且设置成本等似乎很昂贵，特别是对于一家非营利性公司而言。此外，对于我们的需求，Sharepoint 似乎有点过分了。

我们所需要的只是能够满足以下条件的东西：

*   可用于存储和控制文件
*   允许不同的用户访问
*   提供基本版本控制
*   希望可以通过网络浏览器访问，以便我们的远程工作人员可以访问它

我们不热衷于 SAAS 解决方案，因为我们的机密性，也因为我们每天整天都在使用这些文件，而且互联网连接确实不时中断。我们希望能够在内部安装。

理想情况下，解决方案是 FOSS，但如果软件满足我们的需求，我们会考虑购买。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T20:19:32.713

您可能需要问的第一个问题是，为什么现有的 Windows 文件共享不起作用，而人们仍在将文件保存到自己的计算机上。

例如，如果他们经常在办公室外工作并且无法访问文件共享或者他们需要维护工作副本，那么这些问题可以通过 SharePoint 或其他版本控制/文件管理软件来解决。

但是，如果他们只是不遵守政策，那么您放置什么软件就无关紧要了。弄清楚用户遇到的问题将帮助您选择正确的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T22:04:52.737

不确定这是解决此类问题的最佳地点（这是一个没有写/错误答案的讨论），但无论如何

谷歌企业应用？

[http://www.google.com/apps/intl/en/business/index.html](http://www.google.com/apps/intl/en/business/index.html)

完全简单，TOC 低（OSS 在时间意义上不是免费的）。

您可以与外部人员共享文档（读/写或只读），或者只是进行老式的复制/将详细信息粘贴到 OpenOffice/Word/iLife 中，然后将副本发送给他们

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T12:13:01.010

你可以试试[露天](http://www.alfresco.com/)：

> Alfresco 是企业内容管理 (ECM) 的开源替代方案，由 Documentum 创始人 John Newton 和 Business Objects 前首席运营官 John Powell 领导，并得到 Accel Partners、Mayfield Fund 和 SAP Ventures 的支持。

[这里](http://element14.wordpress.com/2007/07/05/howto-install-alfresco-on-linux-sharepoint-alternative/)有一个很好的如何在 linux 上安装它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T19:21:50.927

源代码控制系统之类的东西不会有用吗？[以SVN](http://subversion.tigris.org/)为例？诚然，二进制文件在这里是个问题，但如果您使用的是基本格式，则可以转换为 rtf 或 Office 2007\OpenOffice 使用的新文档标准。

值得注意的是，SharePoint 和其他变体被广泛使用是有原因的。他们做你需要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T20:43:13.197

您是要完全避免使用 Windows Server，还是只是避免购买 Microsoft SharePoint Server？

如果您愿意购买 Windows Server 许可证，您将获得一个基本版本的 SharePoint Server，称为 SharePoint Services，作为该软件包的一部分。SharPoint Services 让您拥有强大的文档管理和协作系统，而无需购买额外的软件包。它确实包含一个版本控制系统，您可以将其与其他应用程序集成。您可以在此处找到更多信息：[Windows SharePoint Services 2.0 概述](http://technet.microsoft.com/en-us/windowsserver/sharepoint/bb267377.aspx)。

MS 提供的另一个可以处理文件管理和版本控制的解决方案是 Microsoft Groove。您可以在此处找到更多信息：[Microsoft Groove](http://office.microsoft.com/en-us/groove/default.aspx)。Groove 的一个重要特性是它可以充当 Sharepoint（很可能是 SharePoint Services）的前端，以允许用户更轻松地与文件存储机制进行交互。

第三种选择，但功能较弱，是使用现有的网络文件共享（通过 Windows 或 Samba），将共享映射到本地驱动器和/或重新配置其“我的文档”以指向网络，然后打开离线存储。这将允许用户与他们的文档进行交互，就像他们是本地文件一样，即使他们处于离线状态。您将在此路线上遇到一些小问题，但这会使您不必使用纯 Microsoft 解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T12:02:54.590

在回答上面的一些问题。

它不起作用的主要原因是因为。一个人将从共享驱动器中打开一个文档并将副本保存到他们的电脑上，然后他们就可以使用它了。然后他们所做的更改不在共享驱动器上，当他们将其复制回来时，每个人所做的更改都会覆盖其他任何人所做的更改，他们也不会通知任何人，因此如果有人正在使用该文档，他们现在正在工作在旧文件上。这是一个让用户进入更好心态的案例！但我们认为软件可能会有所帮助，而且我们的外部员工目前无法访问内部驱动器。

我们有许多服务器，只有一个是 windows，所以我们想摆脱使用那个 windows 服务器并拥有所有 linux 服务器以便于管理。任何 MS 产品都需要我们运行专用的 MS 机器！！

映射的本地驱动器并不是一个很好的选择，因为许多人在办公室外工作，因此不会在网络上做出贡献，而且文件结构可能不允许这样做。

似乎 MS 解决方案可能是唯一的解决方案，我只是希望有一些好的替代方案可用，它们也更简单一些。

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T19:30:38.787

一个标准的共享点文档库，打开版本控制，需要签入/签出，将满足您的需求。与之前发布的一样，WSS 随 Windows Server 一起免费提供。

# database - facebook 对他们的数据库进行了多少非规范化以通过网络分解事物，从而缩小表并加快系统速度？

> ID：213505
> 
> 赞同：1
> 
> 时间：2008-10-17T19:19:32.353
> 
> 标签：database, facebook

任何一点信息都会在这里有所帮助。或者其他人也在这里做一些有趣的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T19:24:18.147

您可能想阅读[Database Sharding](http://www.codefutures.com/database-sharding/) aka [Shared-Nothing Architecture](http://en.wikipedia.org/wiki/Shared_nothing_architecture)

# java - java.net.URLEncoder.encode(String) 已弃用，我应该改用什么？

> ID：213506
> 
> 赞同：213
> 
> 时间：2008-10-17T19:19:39.590
> 
> 标签：java, url, network-programming, deprecated

使用时收到以下警告`java.net.URLEncoder.encode`：

```
警告：[弃用] 编码（java.lang.String）
         在 java.net.URLEncoder 已被弃用
```

我应该改用什么？

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2008-10-17T19:22:59.070

[使用URLEncoder](http://docs.oracle.com/javase/8/docs/api/java/net/URLEncoder.html#encode-java.lang.String-java.lang.String-)中的其他`encode`方法：

```
URLEncoder.encode(String, String) 
```

第一个参数是要编码的文本；第二个是要使用的字符编码的名称（例如，`UTF-8`）。例如：

```
System.out.println(
  URLEncoder.encode(
    "urlParameterString",
    java.nio.charset.StandardCharsets.UTF_8.toString()
  )
); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-11-28T05:54:57.037

你应该使用：

```
URLEncoder.encode("NAME", "UTF-8"); 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-09-04T15:18:59.243

使用类[**URLEncoder**](http://docs.oracle.com/javase/6/docs/api/java/net/URLEncoder.html)：

```
URLEncoder.encode(String s, String enc) 
```

在哪里 ：

> **s** - 要翻译的字符串。
> 
> **enc** - 支持的[**字符编码**](http://docs.oracle.com/javase/6/docs/api/java/lang/package-summary.html#charenc)的名称。

**标准字符集：**

> **US-ASCII** 七位 ASCII，又名 ISO646-US，又名 Unicode 字符集 ISO-8859-1 的基本拉丁语块 ISO Latin Alphabet No. 1，又名 ISO-LATIN-1
> 
> **UTF-8**八位 UCS 转换格式
> 
> **UTF-16BE** 十六位 UCS 转换格式，大端字节序
> 
> **UTF-16LE** 十六位 UCS 转换格式，little-endian 字节顺序
> 
> **UTF-16**十六位 UCS 转换格式，由可选字节顺序标记标识的字节顺序

**例子：**

```
import java.net.URLEncoder;

String stringEncoded = URLEncoder.encode(
    "This text must be encoded! aeiou áéíóú ñ, peace!", "UTF-8"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-01T04:56:44.667

第一个参数是要编码的字符串；第二个是要使用的字符编码的名称（例如，UTF-8）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-23T23:23:36.263

的使用`org.apache.commons.httpclient.URI`并不是严格的问题；问题是您针对错误的构造函数，该构造函数*已*折旧。

只使用

```
new URI( [string] ); 
```

确实会将其标记为折旧。需要的是至少提供一个额外的参数（第一个，下面），理想情况下是两个：

1.  `escaped`: 如果 URI 字符序列是转义形式，则为 true。否则为假。
2.  `charset`: 进行转义编码的字符集字符串，如果需要的话

这将针对该类中的非折旧构造函数。所以一个理想的用法是这样的：

```
new URI( [string], true, StandardCharsets.UTF_8.toString() ); 
```

在游戏后期有点疯狂（11 年后的头发 - *egad！*），但我希望这对其他人有帮助，特别是如果远端的方法*仍然*需要一个 URI，例如`org.apache.commons.httpclient.setURI()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-30T01:10:39.790

作为其他响应的附加参考，您可以使用以下命令，而不是使用**“UTF-8” ：**

`HTTP.UTF_8`

它从 Java 4 开始作为 org.apache.http.protocol 库的一部分包含在内，自 Android API 1 起也包含在内。

# project-management - 为什么个人软件项目会失败？（即以产生全职收入为目标的项目）

> ID：213508
> 
> 赞同：16
> 
> 时间：2008-10-17T19:20:04.893
> 
> 标签：project-management, misv

个人项目（软件应用程序等）永远无法与您的薪水竞争的主要原因是什么？

对我来说，一个大问题是“即时”功能扩展，有了这个问题，结局只会越来越远！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-17T19:25:16.397

对我来说，这很简单：我已经每天工作 8 小时。我每天多花几个小时保持最新状态。我有~~一个女朋友，~~一些当地的家庭和一个体面的朋友圈。我有（喘不过气来）非计算机相关的兴趣和爱好。换句话说，我有生活。

所以……**时间。**时间不在我这边。会不会是……如果每天只有两个小时，我的博客可能会更新一点。:)

（最初由[约翰鲁迪](https://stackoverflow.com/users/14048/john-rudy)发布。）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-17T19:46:48.663

如果你想让你的爱好成为你的工作，你必须掌握所有其他你需要的技能。归根结底，您的宠物项目必须在现实世界中站稳脚跟。同时，您正在享受为自己制定具体计划以将活动商业化所需的编码。

由于以下两个原因之一，大多数业余爱好项目未能取得成功：

1.  这个想法在商业上不可行
2.  缺少将想法商业化所需的纪律

仅仅因为你是一个伟大的技术专家并不意味着你会成为一个伟大的商人。你可能是，但这两者不一定是联系在一起的。考虑与没有技术技能但有良好网络和一些成熟的商业头脑的人合作并不是弱点。很多时候，像这样的人也在寻找技术人员，所以你可能会找到一个很好的合作伙伴。如果功能蠕变正在使您的完成倒退，那么该人可以提供您可能缺乏的结构和商业纪律。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-17T19:27:02.353

我认为主要原因是大多数开发人员都经历过简单的工作超负荷。大多数个人项目发生在晚上和周末，尽管我们大多数人对个人项目的想法感到兴奋，但在 40 小时（或更多）的带薪编程之后，“更多的工作”很难与观看比赛竞争在喝啤酒或与家人共度美好时光的同时。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-17T19:32:07.803

与开发软件相比，启动和维护业务需要不同的技能组合。创业技能是可以学习的，但并不是每个人都具备实现创业技能的能力。很多时候，开始和起步所需的技能与完成和完善它所需的技能不同。对我来说，我知道我有创造力来制作软件并找到解决问题的方法，但我对为企业寻找资金和营销产品或服务没有兴趣。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-17T19:59:57.030

假设您是一名开发人员，这很可能是因为您不知道何时或无法停止开发并专注于其他事情，例如营销和销售。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-17T19:35:23.863

我不确定我是否理解你的问题，但这里有几个答案：

*   添加“即时”功能不一定是坏事。事实上，它是 Web 2.0 和 Web 3.0 项目的预期模型。关键是要保持它们非常简单，只有在经过测试后才推出它们，并听取用户的意见。如果您尝试在第一个版本中将厨房水槽倾倒，它很可能会变得丑陋、混乱和有问题。

*   成为一名优秀的程序员只是其中的一部分。您需要商业技能、市场营销、了解用户需求以及如何满足这些需求、艺术/设计技能，以及大量的运气。

*   很多人都有很棒的想法。通常不同的人有相同的想法。大多数从未得到实施。在那些这样做的人中，很少有人成功。在某些情况下，革命性的产品需要数年时间才能让买家和用户相信他们甚至想要该产品。通常，前几次迭代背后的人或公司惨败，然后第三或第四个人或公司最终在正确的时间以正确的产品进入市场。顺便说一句，Apple 在这两个方面都很出色——他们不仅进行创新（第一台 Mac、Newton 等），而且他们还等到市场需求增长并且他们感觉到有一个地方可以突袭并利用它（ iPod、Mac 与 Windows 问题等）

这些要点中的大多数适用于软件，就像它们适用于小部件和服务一样。软件的一大优势是较低的启动成本。就像那句话“在互联网上，没有人知道你是条狗”——“在看一个网络应用时，用户不知道你是一家价值数十亿美元的公司，还是一个穿着内衣的单身汉在你父母的地下室。” 如果你的软件*很好*，那就是...

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-17T19:28:03.740

**时间**和失去兴趣，总是有一种新的工具或技术可以让你的注意力从完成项目上移开。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-17T19:26:26.253

我想说的一个重要原因是，从本质上讲，个人项目并没有像你的工作那样受到关注。

我有大量的个人/副业项目正在从事，但我对它们的关注远不如我的“真正”工作所做的，因为现在，这就是支付账单的原因。

如果我要休一个月假，*只做*我个人的事情，那可能会很酷/物有所值。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-10T19:55:16.707

1.  开发人员经常为自己而不是为他们的客户设计
2.  开发人员倾向于推迟发布产品，直到事情“完美”——而且他们永远不会

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-18T14:24:53.833

*   思想和精神的软弱。尽早围绕您的产品建立团队。
*   范围蠕变。专注于销售你已经拥有的东西：*“客户可以拥有任何他想要的颜色，只要它是黑色的”。亨利·福特*
*   小功能集。通过市场上已有的产品来利用您产品的功能。
*   每天花费的时间不够。通常，实现某件事可能只取决于简单的例行公事，投入时间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-18T14:48:46.827

*   渴望打造理想产品
    *   例如：有多种方法（算法）可以完成特定任务。但是，人们等待发现一种理想的解决方案。即使已经有针对同一问题的多种解决方案。永远找不到理想的解决方案。
*   拖延

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-18T14:54:14.523

在内心深处，我认为这是对项目缺乏信心。如果我相信我正在做的事情，我就不会停止完成这个项目。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-19T01:07:27.013

出于一个原因，您的个人软件项目不会与您的薪水竞争。

你为你的薪水**做什么？**无论那是什么——无论你多么喜欢或不喜欢它——它都比你的软件产品*更*有价值。

“但我的日常工作涉及很多愚蠢的浪费时间的会议。” 所以？显然，有人会因为在会议上浪费你的时间而不是你的软件产品而付给你更多的钱。

“但我的日常工作迫使我将几个月的时间浪费在无用的分析和设计文档以及测试计划上，这些文档甚至从未被使用过。” 所以？显然，有人认为这项活动比编写软件更重要。

“会议或无用的文件怎么能比软件更有价值？” 我不知道，但看看你的经验。公司喜欢向程序员支付相对大量的钱来闲逛和浪费时间。

公司不喜欢为软件付费。

你的个人项目不会与你的薪水竞争，因为你的时间比你的产品更有价值。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-10-17T20:16:49.163

最大的原因？因为如果您可以自己编写并且人们喜欢它，那么其他人可以制作一个开源版本，其支持比您单独提供的支持要好得多。为什么不跳过中间人并自己将其作为开源发布呢？当然，您错过了直接利润，但在招聘时间看起来非常好。

# c# - 是否可以将 web.config 中的 App 设置传递给 Common C# 类

> ID：213509
> 
> 赞同：3
> 
> 时间：2008-10-17T19:20:15.253
> 
> 标签：c#, asp.net, web-config

是否可以将 web.config 中的 App 设置“字符串”传递给 Common C# 类？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-17T19:22:29.430

在任何类中，您都可以使用`ConfigurationManager.AppSettings["KeyToSetting"]`访问 web.config（或 app.config）元素中的任何值

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T19:23:18.583

当然这是可能的——但要记住的是，一个设计合理的类（除非它是为 ASP.NET 明确设计的）不应该知道或关心信息的来源。您应该使用应用程序本身的字符串值设置一个属性（或方法，但属性是更多的“.NET 方式”），而不是让类直接从 web.config 获取信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T19:50:42.710

如果您有在许多地方使用的配置值，请考虑开发一个配置类来抽象配置项的实际加载并提供强类型值和转换，以及可能的默认值。

这种技术本地化了对配置文件的访问，使得以后切换实现变得容易（比如存储在注册表中），并使得只需从文件中读取一次值——尽管，我希望配置管理器是也以这种方式实现，并在第一次使用它时读取所有值，并在后续访问时从内部存储中提供它们。我认为，真正的好处是强类型和一次性转换。

```
public static class ApplicationConfiguration
{
    private static DateTime myEpoch;
    public static DateTime Epoch
    {
       get
       {
          if (myEpoch == null)
          {
              string startEpoch = ConfigurationManager.AppSettings["Epoch"];
              if (string.IsNullOrEmpty(startEpoch))
              {
                 myEpoch = new DateTime(1970,1,1);
              }
              else
              {
                 myEpoch = DateTime.Parse(startEpoch);
              }
          }
          return myEpoch;   
       }
    }
} 
```

# docking - 动态拆分器窗格

> ID：213524
> 
> 赞同：0
> 
> 时间：2008-10-17T19:23:54.900
> 
> 标签：docking, splitter, panes

我将如何在类似于 Visual Studio 的 vb.net 应用程序中实现动态/停靠拆分器窗格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:19:16.277

查看 ZettaCube 上的以下演示，他们的 WebDock 组件似乎具有接近 VS.NET 的功能，尤其是停靠和自动隐藏。

[http://www.zettacube.com/](http://www.zettacube.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:22:52.900

[DockPanel](http://sourceforge.net/projects/dockpanelsuite)是一种轻松的开源方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:37:59.350

DockPanel 仅适用于 WinForms。似乎上面 zettacube 的 WebDock 是目前唯一的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T19:59:34.783

简短的回答并不容易。

一个高级的想法是使用 div 或表格定义一些区域，并使用您选择的 js 框架使这些元素可调整大小。这让你的分离器方面。

停靠必须使用可以拖放的绝对定位元素，如果您当前位于停靠元素上方，请将要停靠的元素重新定位到停靠元素内部并将其位置更改回正常。当你想把它拖出来时，你会把它的定位改回绝对

此外，这并不容易做到，并且需要很长时间并且可能仍然无法正常工作。很抱歉听起来很悲观。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T23:37:44.357

我会说使用一些已经可用的控件。

我使用 Janus Controls 的控件库，但有几十个可供选择。

[http://www.janusys.com/controls/](http://www.janusys.com/controls/)

同意尼克，这不是你自己拼凑的东西。

# c - 在 C 中的字符串中搜索的最节省内存的方法

> ID：213527
> 
> 赞同：1
> 
> 时间：2008-10-17T19:24:43.450
> 
> 标签：c, performance, algorithm

在 ANSI C 中的字符串中搜索最节省内存的方法是什么？（把代码放上来）

需要这样做的一个例子是在可用内存非常短但现在具有合理时钟周期的嵌入式设备中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T19:30:33.047

这取决于您要查找的内容...但是 strchr() 或 strstr() 通常是合适的。而且这些内存效率极高，因为它们不使用额外的内存。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T19:55:21.453

一次前进一个字符是 Θ((n-m+1) m)。查看[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm)和[Knuth-Morris-Pratt](http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm)算法，以获得更有效的子串搜索方法——两者都低至 O(n)。你方便的算法教科书应该讨论它们。标准 C 库 strstr 函数实现了一个或两个，所以使用它而不是自己滚动。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T19:32:51.030

我想这取决于您要搜索的内容，但是线性搜索/比较使用的内存不超过两个字符串（“主机”和“令牌”）。例如：

```
char host[] = "this is my string to search";
char token[] = "y st";
int k = 0;
while(host[k] != '\0'){
  for(int t=0; (token[t]!='\0' && host[k+t]!='\0');){
    if(host[k] == token[t]){
      t++;  // we matched the first char of token, so advance
    }
    else{   // no match yet, reset the token counter and move along the host string
      k++;
      t = 0;
    }
  }
  k++;
} 
```

（我在实现上可能略有偏差，但希望你能明白我的想法。）

像 strstr 这样的库函数也应该值得一看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T19:32:10.953

如果您正在寻找子字符串，那么 strstr 非常节省内存。对于 char，strchr 也非常节省内存。两者都不需要额外的存储空间。

我不确定您是否还在寻找更多内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T07:48:46.947

Karp Rabin 只使用四个整数并且具有线性平均时间。它只是计算搜索字符串的哈希值，并使用一些数学技巧来快速获取下一个子字符串的哈希值，给定它之前的子字符串的哈希值。

标准版本遇到了麻烦，因为大多数语言不做真正的数学模，但 Gonnet 和 Baeza-Yate 的*数据结构和算法手册*有一个使用字长作为隐式模的[版本（它也更快）。](http://www.dcc.uchile.cl/~rbaeza/handbook/algs/7/715.srch.c.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T19:49:29.713

根据搜索类型和边界条件，有大量不同的算法用于搜索字符串中的子字符串。此处提供大量收藏：http **:** [//www-igm.univ-mlv.fr/~lecroq/string/index.html](http://www-igm.univ-mlv.fr/~lecroq/string/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-31T08:23:24.727

我最近遇到了这个问题，只是想分享我的想法。

正如我所解释的那样，“内存效率”是在仅给定 N 可用内存量（M > N）的情况下搜索大小为 M 的长字符串的能力。这是对要搜索的字符串中每个可用字符有效使用内存的替代方法。而且我觉得可能与原始发布者的嵌入式环境（可能有很大的存储空间）更相关。

无论您使用哪种算法进行比较（当然效率越高越好），我会选择使用循环缓冲区（它应该大于您要搜索的字符串，至少可能是 2X？）并且连续在搜索算法前进时将字符流加载到缓冲区。搜索算法必须能够知道如何环绕循环缓冲区（或添加一个间接级别以对搜索算法隐藏循环缓冲区）。

# lisp - 在 common lisp 中居中文本

> ID：213538
> 
> 赞同：7
> 
> 时间：2008-10-17T19:27:24.020
> 
> 标签：lisp, printing, common-lisp, center

我有一个要打印的字符串。打印时可以居中吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T19:33:35.023

使用 ~< 格式化指令。这将返回以 70 列为中心的“你好”。

```
(format nil "~70:@<~A~>" "hello there") 
```

# mysql - 如何检查特定表的 MySQL 引擎类型？

> ID：213543
> 
> 赞同：448
> 
> 时间：2008-10-17T19:28:38.230
> 
> 标签：mysql, innodb, myisam

我的 MySQL 数据库包含几个使用不同存储引擎（特别是 myisam 和 innodb）的表。如何找出哪些表正在使用哪个引擎？

* * *

## 回答 #1

> 赞同：576
> 
> 时间：2008-10-17T19:30:09.303

`SHOW TABLE STATUS WHERE Name = 'xxx'`

这将为您（除其他外）提供一个`Engine`列，这就是您想要的。

* * *

## 回答 #2

> 赞同：277
> 
> 时间：2010-11-19T13:51:33.217

要显示数据库中所有表及其引擎的列表，请使用以下 SQL 查询：

```
SELECT TABLE_NAME,
       ENGINE
FROM   information_schema.TABLES
WHERE  TABLE_SCHEMA = 'dbname'; 
```

替换`dbname`为您的数据库名称。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2008-10-17T19:33:10.017

```
SHOW CREATE TABLE <tablename>; 
```

比 . 更难解析但更易读`SHOW TABLE STATUS`。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-08-19T04:29:20.227

要不就

`show table status;`

只是这将列出您数据库中的所有表。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2011-08-12T16:31:17.837

对 Jocker 的回应稍作调整（我会发表评论，但我还没有足够的业力）：

```
SELECT TABLE_NAME, ENGINE
  FROM information_schema.TABLES
 WHERE TABLE_SCHEMA = 'database' AND ENGINE IS NOT NULL; 
```

这从列表中排除了没有引擎的 MySQL 视图。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-01-13T18:18:32.807

```
SHOW CREATE TABLE <tablename>\G 
```

与输出相比，它的格式会更好

```
SHOW CREATE TABLE <tablename>; 
```

该`\G`技巧对于许多其他查询/命令也很有用。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2019-02-10T19:36:31.283

> 从 database_name 显示表状态；

它将列出上述数据库中的所有表。
**示例输出**

[![mysql db的示例输出](https://i.stack.imgur.com/8yVDn.png)](https://i.stack.imgur.com/8yVDn.png)

> 显示表状态，其中 name=your_desired_table_name；

它将显示上述表使用的存储引擎。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-04-11T13:19:41.817

```
mysqlshow -i <database_name> 
```

将显示特定数据库的所有表的信息。

```
mysqlshow -i <database_name> <table_name> 
```

将只针对特定表执行此操作。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-09-24T07:58:55.573

如果您使用的是[MySQL Workbench](https://www.mysql.com/products/workbench/)，请右键单击表并选择`alter table`.

在该窗口中，您可以看到您的表引擎并对其进行更改。

![](https://i.stack.imgur.com/zc2Nx.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-01-04T07:12:46.607

还有另一种方式，也许是获得单个或匹配的一组表状态的最短时间：

```
SHOW TABLE STATUS LIKE 'table'; 
```

然后，您可以使用 LIKE 运算符，例如：

```
SHOW TABLE STATUS LIKE 'field_data_%'; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-13T13:52:16.400

如果你是 linux 用户：

要显示 mysql 服务器上所有数据库的所有表的引擎，不包括表`information_schema`, `mysql`, `performance_schema`：

```
less < <({ for i in $(mysql -e "show databases;" | cat | grep -v -e Database-e information_schema -e mysql -e performance_schema); do echo "--------------------$i--------------------";  mysql -e "use $i; show table status;"; done } | column -t) 
```

至少，如果您使用的是 linux，您可能会喜欢这个。

将打开 中所有表格的所有信息`less`，按下`-S`可截断过长的行。

示例输出：

```
--------------------information_schema--------------------
Name                                                        Engine              Version  Row_format  Rows   Avg_row_length  Data_length  Max_data_length     Index_length  Data_free  Auto_increment  Create_time  Update_time  Check_time  C
CHARACTER_SETS                                              MEMORY              10       Fixed       NULL   384             0            16434816            0             0          NULL            2015-07-13   15:48:45     NULL        N
COLLATIONS                                                  MEMORY              10       Fixed       NULL   231             0            16704765            0             0          NULL            2015-07-13   15:48:45     NULL        N
COLLATION_CHARACTER_SET_APPLICABILITY                       MEMORY              10       Fixed       NULL   195             0            16357770            0             0          NULL            2015-07-13   15:48:45     NULL        N
COLUMNS                                                     MyISAM              10       Dynamic     NULL   0               0            281474976710655     1024          0          NULL            2015-07-13   15:48:45     2015-07-13  1
COLUMN_PRIVILEGES                                           MEMORY              10       Fixed       NULL   2565            0            16757145            0             0          NULL            2015-07-13   15:48:45     NULL        N
ENGINES                                                     MEMORY              10       Fixed       NULL   490             0            16574250            0             0          NULL            2015-07-13   15:48:45     NULL        N
EVENTS                                                      MyISAM              10       Dynamic     NULL   0               0            281474976710655     1024          0          NULL            2015-07-13   15:48:45     2015-07-13  1
FILES                                                       MEMORY              10       Fixed       NULL   2677            0            16758020            0             0          NULL            2015-07-13   15:48:45     NULL        N
GLOBAL_STATUS                                               MEMORY              10       Fixed       NULL   3268            0            16755036            0             0          NULL            2015-07-13   15:48:45     NULL        N
GLOBAL_VARIABLES                                            MEMORY              10       Fixed       NULL   3268            0            16755036            0             0          NULL            2015-07-13   15:48:45     NULL        N
KEY_COLUMN_USAGE                                            MEMORY              10       Fixed       NULL   4637            0            16762755            0 

.
.
. 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-08-01T08:28:44.007

转到 information_schema 数据库，您会找到“tables”表，然后选择它；

mysql>使用信息架构；mysql> select table_name,engine from tables;

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-02-14T11:06:36.520

如果您是**GUI**人并且只想在**PhpMyAdmin**中找到它，那么选择您选择的表并转到`Operations`选项卡 >> `Table options`>> `Storage Engine`。您甚至可以使用下拉选项列表从那里更改它。

PS：本指南基于 PhpMyAdmin 4.8 版。不能保证非常旧版本的路径相同。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-23T06:15:08.000

除了前面条目中显示的示例外，您还可以使用标准查询从 information_schema db 中获取，如下所示：

```
use information_schema;

select NAME from INNODB_TABLES where NAME like "db_name%"; 
```

# unit-testing - 你在编写单元测试时最常犯的错误是什么？

> ID：213544
> 
> 赞同：18
> 
> 时间：2008-10-17T19:28:54.393
> 
> 标签：unit-testing, language-agnostic

您在编写单元测试时最常犯的错误是什么？耦合？缺乏凝聚力？尝试一次测试太多功能？没有测试足够的功能？

如果您有该错误的示例，请发布一些示例代码

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T19:56:28.533

根本不写。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T19:33:33.197

在一次测试中测试太多。我的单元测试通常通过不将自己限制在被测方法上而具有更多集成测试的特征。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-17T19:56:08.567

测试存在的代码，而不是*应该**存在*的代码。

我倾向于测试编写单元测试时出现的代码。也就是说，我将编写一系列覆盖率极高的测试，并测试存在的大部分代码，但会遗漏代码未涵盖的基本错误条件。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-17T19:31:53.043

编写与他们正在测试的代码过于耦合的测试。在我依赖语义耦合和我假设为类工作的东西的情况下尤其如此。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T19:31:58.240

依赖于一些不属于测试功能的实现细节，这些细节可能会在以后的开发中发生变化。
有时，这些假设太难以考虑，或者太难以考虑并且是可变的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-17T19:32:11.437

缺乏覆盖——我很少在第一次通过时测试所有我应该测试的案例。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T19:51:28.840

在双重比较中忘记输入舍入误差可能是我最大和最烦人的错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-18T02:55:54.723

Writing tests that are neither unit tests( testing only the specific method) nor acceptance tests( testing from user's perspective).

I find that tests that testing 3-4 layers of code in one test that is not grounded at concepts that biz people understand, usually lead to tests that are a burden to maintain and make people get disappointed and turned off by automated testing.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T19:41:58.907

仅使用一些随机值进行测试，而不包括使用等价划分和边界值分析进行测试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T20:01:09.133

不先写它们（即不走测试驱动路线）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-17T20:02:26.557

通过不使用模拟对象或框架使两个集成点紧密耦合。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-17T20:42:00.250

没有让测试装置足够整洁——所以编写测试比应该的要难。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-17T19:40:16.133

好吧，我有时会错过发布 [Test] C# 属性，并且测试甚至没有运行 :)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-17T19:33:34.447

省略一些小细节（例如，单元测试中没有任何字母的十六进制到 dec 函数......）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-17T20:13:58.483

[http://msdn.microsoft.com/en-us/magazine/cc163665.aspx](http://msdn.microsoft.com/en-us/magazine/cc163665.aspx)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-22T05:30:06.890

只有部分代码覆盖的单元测试。

测试成功了，所以我感觉很好。事情正在奏效。我继续做别的事情。原来有一个未经测试的角落案例。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-22T06:23:46.113

取决于您碰巧使用的操作系统的怪癖或先前测试的无意副作用的测试。

# c# - 如何将 SSL 证书从 PEM 转换为 DER 并保留私钥？

> ID：213568
> 
> 赞同：0
> 
> 时间：2008-10-17T19:34:02.463
> 
> 标签：c#, .net, ssl, certificate, x509

背景故事：我有一个带有对称密码（密码）的 PKCS#12 (p12) 证书，我使用 OpenSSL 将其转换为 PEM；打开它作为文本，我看到它包含一个`BEGIN/END CERTIFICATE`部分以及`BEGIN/END RSA PRIVATE KEY`. .NET Framework`X509Certificate`类仅支持“ASN.1 DER”格式，因此我使用 OpenSSL 将 PEM 转换为 DER。不幸的是，这样做似乎不包括我与`SslStream`&建立 SSL 连接所需的私钥`TcpClient`。

```
X509CertificateCollection certsFromFile = new X509CertificateCollection();
X509Certificate2 cert = new X509Certificate2("my.der.crt");
if (!cert.HasPrivateKey)
    throw new Exception("No private key");
certsFromFile.Add(cert);

TcpClient tcpclient = new TcpClient(hostname, port);
SslStream sslstream = new SslStream(tcpclient.GetStream(), false,
    null, null);
sslstream.AuthenticateAsClient(hostname, certsFromFile,
    SslProtocols.Ssl3, false);
sslstream.Close();
tcpclient.Close(); 
```

如何获取此 PEM 文件并将其转换为 DER，同时保留私钥信息，以便我可以在 .NET 中使用它进行签名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T19:48:47.190

哎呀，我落后于时代了！看起来`X509Certificate2`可以读取 PKCS#12 文件，因此无需进行任何转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T19:39:42.530

证书和密钥通常分开存储。将 PEM 文件切割成两个文件，一个带有证书，一个带有密钥。然后，您可以使用 openssl 工具包将每个文件分别转换为 DER 文件。

# ruby-on-rails - 哪个更适合 Rails 站点？/{login} 或 /user/{login}

> ID：213576
> 
> 赞同：5
> 
> 时间：2008-10-17T19:36:18.107
> 
> 标签：ruby-on-rails, url, namespaces, friendly-url

哪个更好（对于用户，对于长寿，对于性能，无论什么）：

http://{site}/{login} 例如[http://wildobs.com/adam_jack](http://wildobs.com/adam_jack)

或者

http://{site}/user/{login}

前者的优点：

*   用户感觉更特别。
*   URL 更短。

前者的缺点：

*   不能让用户登录匹配关键字，并且关键字可能会随着时间的推移而增长。

显然，这对于正确（或错误并坚持）很重要，因为所有用户定义的 URL 都基于它。改变它似乎是网站自杀。

缺点（尤其是随着时间的推移）是否超过优点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T19:43:12.647

我会说利大于弊，所以选择 /user/login 而不是 /login。考虑一下 stackoverflow，因为它也是 MVC：我认为知道 /user/blah 中的所有内容将始终引用用户会更容易编程，而如果您不这样做，则必须考虑所有可能性。

例如，在 site/foo 中，foo 可以是用户名、管理页面或其他关键字。如果您正确地将所有内容全部分割出来，那么处理起来会容易得多，这样您就知道如果您看到 site/user/foo 它始终是一个名为 foo 的用户。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T19:56:09.610

您可以考虑第三种选择：

使用单个字符而不是目录来分隔用户，就像在 unix 中那样。

[http://site/~用户名](http://site/~username)

如果这样更方便的话，这甚至可以导致对 /user/username 的 modrewrite。

然后你的名字很短，很容易处理，而且你的常规页面都不会使用那个特殊字符。

-亚当

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:10:59.067

允许用户在网络服务器根目录中创建任意名称存在一个非常重要的问题（如果您使用 /{login} 而不是 /user/{login}，他们可以通过选择自己的登录名）：一些名称具有特殊的魔法含义，*并且这些含义是由第三方定义的*。例如：

*   [robots.txt](http://en.wikipedia.org/wiki/robots.txt)，也被称为“机器人排除标准”，所有表现良好的搜索引擎都紧随其后。
*   [favicon.ico](http://en.wikipedia.org/wiki/favicon.ico)，它最初是 Internet Explorer 标准，后来被其他几个浏览器采用。
*   一些网站（至少是谷歌和 IIRC 雅虎）使用您可以在网络服务器根目录中创建一个特殊命名的文件这一事实来证明您是该网站的网站管理员，从而​​允许您访问一些额外的功能（如谷歌网站管理员工具）。

还有其他几个；我听说过允许额外跨域访问的站点地图和文件，但我（或其他任何人）无法知道所有这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T19:43:05.643

我个人会选择 /user/{login}

使用 /{login} 感觉太像弄乱全局命名空间了，而且我们都知道全局变量很糟糕；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:32:38.787

在 RESTful MVC 中，我最后一次检查来自 Restful Authentication 插件的示例是会话创建模式。因此，您不是登录用户，而是为用户创建会话。在这种情况下，如果身份验证成功，将`GET http://{site}/session/new`显示登录屏幕并`POST http://{site}/session`使用正确的参数登录用户。

然后，如果您愿意，可以创建一个新路由，`http://{site}/login`该路由将重定向到`http://{site}/session/new`. 同样`DELETE http://{site}/session`会将您注销。

# vba - Excel VBA中的相对而不是绝对路径

> ID：213584
> 
> 赞同：47
> 
> 时间：2008-10-17T19:42:28.890
> 
> 标签：vba, excel, absolute-path

我编写了一个 Excel VBA 宏，它在对数据执行计算之前从 HTML 文件（本地存储）导入数据。

目前 HTML 文件是用绝对路径引用的：

```
Workbooks.Open FileName:="C:\Documents and Settings\Senior Caterer\My Documents\Endurance Calculation\TRICATEndurance Summary.html" 
```

但是，我想使用相对路径而不是绝对路径来引用它（这是因为我想将电子表格分发给可能不使用相同文件夹结构的同事）。由于 html 文件和 excel 电子表格位于同一个文件夹中，我不会认为这会很困难，但是我完全无法做到。我在网上搜索过，建议的解决方案都显得非常复杂。

我在工作中使用 Excel 2000 和 2002，但是当我计划分发它时，我希望它可以与尽可能多的 Excel 版本一起使用。

任何建议都非常感激。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-18T01:15:12.040

只是为了澄清 yalestar 所说的，这将为您提供相对路径：

```
Workbooks.Open FileName:= ThisWorkbook.Path & "\TRICATEndurance Summary.html" 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-17T19:50:36.127

您可以将其中之一用于相对路径根：

```
ActiveWorkbook.Path
ThisWorkbook.Path
App.Path 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:53:59.290

我认为问题是只有在正确设置“当前目录”的情况下才能打开没有路径的文件。

尝试在即时窗口中键入“Debug.Print CurDir” - 这应该会显示在工具...选项中设置的默认文件的位置。

我不确定我对它是否完全满意，也许是因为它有点像一个遗留的 VB 命令，但你可以这样做：

```
ChDir ThisWorkbook.Path 
```

我想我更喜欢使用 ThisWorkbook.Path 来构造 HTML 文件的路径。我是 Scripting Runtime 中 FileSystemObject 的忠实粉丝（它似乎总是被安装），所以我会更乐意做这样的事情（在设置对 Microsoft Scripting Runtime 的引用之后）：

```
Const HTML_FILE_NAME As String = "my_input.html"

With New FileSystemObject
    With .OpenTextFile(.BuildPath(ThisWorkbook.Path, HTML_FILE_NAME), ForReading)
        ' Now we have a TextStream object that we can use to read the file
    End With
End With 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-01T14:16:07.217

如果操作系统的当前目录是您正在使用的工作簿的路径，`Workbooks.Open FileName:= "TRICATEndurance Summary.html"`就足够了。如果您正在使用路径进行计算，您可以参考当前目录`.`，然后`\`告诉文件在该目录中，如果您必须将操作系统的当前目录更改为工作簿的路径，您可以使用`ChDrive`并`ChDir`这样做.

```
ChDrive ThisWorkbook.Path
ChDir ThisWorkbook.Path
Workbooks.Open FileName:= ".\TRICATEndurance Summary.html" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-13T19:27:00.840

您可以通过向用户提供**浏览器按钮**来为用户提供更多灵活性

```
Private Sub btn_browser_file_Click()
Dim xRow As Long
Dim sh1 As Worksheet
Dim xl_app As Excel.Application
Dim xl_wk As Excel.Workbook
Dim WS As Workbook
Dim xDirect$, xFname$, InitialFoldr$
InitialFoldr$ = "C:\"
With Application.FileDialog(msoFileDialogFolderPicker)
    .InitialFileName = Application.DefaultFilePath & "\"
    .Title = "Please select a folder to list Files from"
    .InitialFileName = InitialFoldr$
    .Show
    Range("H13").Activate
    If .SelectedItems.Count <> 0 Then
        xDirect$ = .SelectedItems(1) & "\"
         Range("h12").Value = xDirect$
        xFname$ = Dir(xDirect$, 7)
        Do While xFname$ <> ""
         If (Format(FileDateTime(xDirect$ & "\" & xFname$), "MM/DD/YYYY") > Format(Range("H10").Value, "MM/DD/YYYY")) Then
            ActiveCell.Offset(xRow) = xFname$
            xRow = xRow + 1
            xFname$ = Dir
            Else
            xFname$ = Dir
            xRow = xRow
        End If
        Loop
    End If
End With 
```

使用这段代码，您可以轻松实现这一目标。**测试代码**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-16T08:14:25.900

这是我从相对路径获取绝对路径的快速简单的函数。

与接受的答案不同的是，此函数可以处理向上移动到父文件夹的相对路径。

例子：

```
Workbooks.Open FileName:=GetAbsolutePath("..\..\TRICATEndurance Summary.html") 
```

代码：

```
' Gets an absolute path from a relative path in the active workbook
Public Function GetAbsolutePath(relativePath As String) As String

    Dim absPath As String
    Dim pos As Integer

    absPath = ActiveWorkbook.Path

    ' Make sure paths are in correct format
    relativePath = Replace(relativePath, "/", "\")
    absPath = Replace(absPath, "/", "\")

    Do While Left$(relativePath, 3) = "..\"

        ' Remove level from relative path
        relativePath = Mid$(relativePath, 4)

        ' Remove level from absolute path
        pos = InStrRev(absPath, "\")
        absPath = Left$(absPath, pos - 1)

    Loop

    GetAbsolutePath = PathCombine(absPath, relativePath)

End Function 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-08-30T15:37:29.137

我认为这可能会有所帮助。下面的宏检查文件夹是否存在，如果不存在则创建文件夹并以 xls 和 pdf 格式保存在该文件夹中。碰巧该文件夹与相关人员共享，因此每个人都得到了更新。

```
Sub PDF_laudo_e_Prod_SP_Sem_Ajuste_Preco()
'
' PDF_laudo_e_Prod_SP_Sem_Ajuste_Preco Macro
'

'

Dim MyFolder As String
Dim LaudoName As String
Dim NF1Name As String
Dim OrigFolder As String

MyFolder = ThisWorkbook.path & "\" & Sheets("Laudo").Range("C9")
LaudoName = Sheets("Laudo").Range("K27")
NF1Name = Sheets("PROD SP sem ajuste").Range("Q3")
OrigFolder = ThisWorkbook.path

Sheets("Laudo").Select
Columns("D:P").Select
Selection.EntireColumn.Hidden = True

If Dir(MyFolder, vbDirectory) <> "" Then
Sheets("Laudo").ExportAsFixedFormat Type:=xlTypePDF, filename:=MyFolder & "\" & LaudoName & ".pdf", Quality:=xlQualityMinimum, _
IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
False

Sheets("PROD SP sem ajuste").ExportAsFixedFormat Type:=xlTypePDF, filename:=MyFolder & "\" & NF1Name & ".pdf", Quality:=xlQualityMinimum, _
IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
False

ThisWorkbook.SaveAs filename:=MyFolder & "\" & LaudoName

Application.DisplayAlerts = False

ThisWorkbook.SaveAs filename:=OrigFolder & "\" & "Entregas e Instrucao Barter 2015 - beta"

Application.DisplayAlerts = True

Else
MkDir MyFolder
Sheets("Laudo").ExportAsFixedFormat Type:=xlTypePDF, filename:=MyFolder & "\" & LaudoName & ".pdf", Quality:=xlQualityMinimum, _
IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
False

Sheets("PROD SP sem ajuste").ExportAsFixedFormat Type:=xlTypePDF, filename:=MyFolder & "\" & NF1Name & ".pdf", Quality:=xlQualityMinimum, _
IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
False

ThisWorkbook.SaveAs filename:=MyFolder & "\" & LaudoName

Application.DisplayAlerts = False

ThisWorkbook.SaveAs filename:=OrigFolder & "\" & "Entregas e Instrucao Barter 2015 - beta"

Application.DisplayAlerts = True

End If

Sheets("Laudo").Select
Columns("C:Q").Select
Selection.EntireColumn.Hidden = False
Range("A1").Select

End Sub 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2020-10-09T20:25:12.680

这可能不是最好的方法。但是我发现获得绝对路径的唯一方法是计算语法 .. 在字符串中出现了多少次，然后使用函数 gotoparent 与语法出现在超链接地址中的次数一样多。（在我的情况下，我的字段是一个超链接地址。ps：此代码需要引用microsoft scripting runtime

```
Function AbsolutePath(strRelativePath As String, strCurrentFileName As String) As String
Dim fso As Object
Dim strCurrentProjectpath As String
Dim strGoToParentFolder As String
Dim strOrigineFolder As String
Dim strPath As String
Dim lngParentFolder As Long

''Pour retrouver le répertoire parent
Set fso = CreateObject("Scripting.FileSystemObject")

'' détermine le répertire du projet actif
strCurrentProjectpath = CurrentProject.Path

'' détermine le nom du répertoire dans lequel le fichier d'origine se trouve
strOrigineFolder = Replace(Replace(Replace(strRelativePath, strCurrentFileName, ""), "..", ""), "\", "")

''Extraction du chemin relatif (ex. ..\..\..)
strGoToParentFolder = Replace(Replace(strRelativePath, strOrigineFolder, ""), strCurrentFileName, "")

''retourne le nombre de fois qu'il faut remonter au répertoire parent
lngParentsFolder = Len(Replace(strGoToParentFolder, "\", "")) / 2

''détermine la valeur d'origine du répertoire du début
strPath = strCurrentProjectpath

Vérifie s 'il faut aller au répertoire parent
If lngParentsFolder < 1 Then
    'si non, alors répertoire parent et répertoire d'origine du fichier
    strPath = strCurrentProjectpath & "\" & strOrigineFolder
Else
    ''si oui, nous faisons la boucle pour retourner au répertoire d'origine
    For i = 1 To lngParentsFolder
        strPath = fso.GetParentFolderName(strPath)
    Next i
End If

''retournons le répertoire parent du fichier et son répertoire d'origine [le OUTPUT]
AbsolutePath = strPath & strOrigineFolder & "\"

End Function 
```

# entity - 在 MS CRM 4.0 中检索实体的属性名称

> ID：213593
> 
> 赞同：2
> 
> 时间：2008-10-17T19:46:43.543
> 
> 标签：entity, dynamics-crm, dynamics-crm-4

我正在尝试检索实体中存在的属性名称和类型，准确地说是动态实体。我有以下代码。

```
DynamicEntity contactEntity = new DynamicEntity();
contactEntity.Name = EntityName.contact.ToString();

Property t = null;
foreach (Property prop_Test in contactEntity.Properties)
{
    Response.Write("<br/>Name : " + prop_Test.Name.ToString());   
} 
```

我将属性计为 0。

我是否必须将 id 传递给联系人实体。因为我试图将实体中的属性映射到我从 excel 文件中获得的属性。最终用户自己将进行映射，所以我只需要属性名称和类型即可。例如在 SQL 中，我们有查询

```
SELECT * FROM TABLE_NAME WHERE 1 <> 1 
```

这个查询基本上返回一个只有字段名的空结果集。这就是我在这里寻找的。甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T05:53:03.850

在上面的示例中，动态实体没有设置任何属性。动态实体是 MS CRM 中的一种特殊类型，当您在运行时才知道 CRM 类型时使用它。如果您将属性添加到动态实体并运行您的示例，无论返回多少您定义的属性，您都会得到。

为了获取联系人属性，您需要按照[SDK](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=82E632A7-FAF9-41E0-8EC1-A2662AAE9DFB&displaylang=en)中的说明引用 CRM 元数据服务。

在 HowTo 部分的此下载中有一个示例，显示了如何获取实体和属性元数据。

# ruby - Ruby 中的缓冲多部分表单帖子

> ID：213613
> 
> 赞同：1
> 
> 时间：2008-10-17T19:53:23.970
> 
> 标签：ruby, http, forms, networking, multipartform-data

我目前正在使用`Net::HTTP`Ruby 脚本通过多部分表单发布将文件发布到网站。它适用于小文件，但我经常必须使用此脚本发送非常大的文件，并且`HTTP#post`似乎只接受发布数据作为`String`对象，这意味着我发送的文件必须先读入内存，然后才能读取发送。该脚本在繁忙的生产服务器上运行，因此仅仅为了发送文件而吞噬数百兆字节的 RAM 是不可接受的。

理想情况下，会有一种方法可以给定缓冲区大小和`IO`对象，并发送缓冲区大小的数据块，`IO`仅在需要时从对象中读取。实现这一目标的最佳方法是什么？我错过了一些相关的东西`Net::HTTP`吗？

**更新**：`Net::HTTP#body_stream(input)`看起来不错，尽管文档相当...稀疏。任何人都可以为我指出一个很好的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-25T15:34:39.433

实际上，我设法使用 body_stream 上传了一个文件。完整的源代码在这里： [http ://stanislavvitvitskiy.blogspot.com/2008/12/multipart-post-in-ruby.html](http://stanislavvitvitskiy.blogspot.com/2008/12/multipart-post-in-ruby.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-19T10:06:05.773

使用 Net::HTTP#body_stream(input)

[没有流式传输](http://trac-git.assembla.com/breakout/browser/lib/trac2assembla.rb#L517)的多部分帖子示例：

# vb.net - 最好的方法是让一个exe只能运行一次

> ID：213625
> 
> 赞同：6
> 
> 时间：2008-10-17T19:57:53.460
> 
> 标签：vb.net, vb6

我有一个 Visual Basic 应用程序，如果安装运行不止一次，它往往会严重混乱。似乎偶尔客户端会在稍后将安装程序误认为是它的快捷方式，再次运行安装程序并将所有内容都搞砸了。我一生都无法弄清楚为什么，所以我决定最简单的方法是制作它，这样 exe 只能在机器上运行一次，否则它就会结束。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T18:18:06.130

您为什么不修复安装程序或正在发生的任何问题，而不是尝试进行一些黑客攻击来避免它...

只是我的 $.02

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T19:59:32.943

让您的安装程序在应用程序文件夹中放置一个文件。

再次运行时，检查该文件，如果存在，显示“已安装”弹出窗口并退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T16:34:45.770

假设这是一个 VB6 问题，您可以使用内置的 App.PrevInstance。

文档： http: [//msdn.microsoft.com/en-us/library/aa268085 (VS.60).aspx](http://msdn.microsoft.com/en-us/library/aa268085(VS.60).aspx)

如果您的应用程序已经在运行，App.Previnstance 返回 True。

在您的启动表单的加载事件或您的 Sub Main 中：

```
Private Sub Form_Load()
    If App.PrevInstance = True Then
        MsgBox "Already running"
        'Do whatever you need to do before closing
    End If
End Sub 
```

如果您想更进一步，将前一个实例置于前台，您可以查看以下文章：

[http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=21131&lngWId=1](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=21131&lngWId=1)

[http://support.microsoft.com/kb/185730](http://support.microsoft.com/kb/185730)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T15:21:55.487

如果您使用的是 .net，那么 Mutex 就是您的朋友。

永远不要使用 Process.GetProcessesByName 方法。您以后只会讨厌自己使用需要管理员权限的东西

```
private bool CanIStart
{

        try
            {
                MyAppMutex= new Mutex(false, "myAppMutex", out createdNew);
                if(MyAppMutex.WaitOne(0,false))
                {
                    return true;
                }
                else
                {
                    MyAppMutex = null;
                    return false;
                }

            }
            catch(ApplicationException ex)
            {
                // we couldn't create the mutex. // log the error if you care
                return false;               
            }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T15:23:36.137

让安装程序创建一个注册表项。如果注册表项已经存在，则拒绝（再次）安装。

究竟如何实现这一点将取决于您使用的安装程序技术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T20:10:25.760

您可以让安装程序 EXE 文件自行删除，而不是在它运行时直接删除，而是在运行完成后将调用传递给另一个服务以将其删除。

我觉得这很有趣，所以我用谷歌搜索了一下，这篇文章似乎有一些很好的信息：

[http://www.autohotkey.com/forum/topic1572.html](http://www.autohotkey.com/forum/topic1572.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T12:48:29.983

在安装程序应用程序上

```
' Test eventual mark, settings in the registry.
if GetSetting("MyInstallerApp","Startup","BeenHere",0) = 1 then
    MsgBox "This installer was ran once already... first run the un-installer."
    End ' or some other code to properly exit the installer
EndIf
Call SaveSetting ("MyInstallerApp","Startup", "BeenHere", 1) 'leave a mark for future 
```

在卸载程序应用程序上（或安装程序的“卸载”选项）

```
' Allow future Installer to run again
Call DeleteSetting("MyInstallerApp", "Startup") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T17:11:22.733

如果您将 VB.NET 与 Visual Studio 2005 或 2008 一起使用，您可以在项目设置的“应用程序”选项卡的“Windows 应用程序框架”部分中选中“制作单实例应用程序”选项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-18T11:22:06.153

您可以检查并查看已安装的应用程序文件是否已存在。假设是，您知道应用程序的安装位置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T15:18:38.380

也许检查机器上正在运行的进程以告诉您是否存在另一个实例会有所帮助？有关更多信息，请参阅[此线程](https://stackoverflow.com/questions/187915/detecting-a-process-is-already-running-in-windows-using-c-net)...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-12T21:20:57.077

让我感到震惊的是，留下一个不应该多次运行的应用程序就像在某人的办公桌某处留下一个红色的大按钮，当按下时会炸毁桌子。不酷。

大多数安装程序具有不提供重复安装的功能。首先检查一下——这似乎是最好、最明显的解决方案。

什么情况严重？从您的应用程序的角度来看，第二次运行安装程序与第一次运行安装程序有何不同？这也应该在您的代码中得到解决。

# c# - 可以通过使用 AfxFreeLibrary 卸载非托管库来减少托管应用程序的工作集吗？

> ID：213627
> 
> 赞同：0
> 
> 时间：2008-10-17T19:58:02.960
> 
> 标签：c#, .net, unmanaged, managed

我有一个托管的 Windows 应用程序，它加载一个托管的 C++ 组件，该组件使用 AfxLoadLibrary 来加载第三方组件（如果存在于客户端计算机上）。一旦检测到，我将使用 AfxFreeLibrary 卸载组件，以尝试降低托管父应用程序的工作集。

对 AfxFreeLibrary 的调用成功（使用 Process Explorer 验证），但没有释放内存。这是由于托管应用程序的性质，还是有办法释放这个进程空间？

我一般不会寻找解决这个问题的替代方法，因为代码已经在生产中，而是我想知道卸载的方法是否值得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T21:03:19.833

应该可以，您可以通过编写纯原生应用程序并查看工作集来证明这一点。但是，工作集是运行应用程序所需的内存大小，因此如果 dll 使用的代码可以换出，那么工作集不会减少 - Windows 不会将其视为工作集的一部分.

如果 dll 有分配给进程的私有内存，则不能交换，那么这确实很重要，并且会减少工作集。

所以答案是视情况而定。它不能保证有任何区别，如果不使用 dll，那么它将被换出并且不是当前工作集的一部分。除非您喜欢保持整洁，否则您最好不要费心卸载它。

减少工作集的唯一方法是让您的应用程序使用更少的内存。作为一个 .NET 应用程序，您可能根本无法控制它（因为 GC 会自行决定工作集中需要多少内存是“活动的”）

# python - 当字符串中有非ASCII字符时，如何将C字符串（char数组）转换为Python字符串？

> ID：213628
> 
> 赞同：7
> 
> 时间：2008-10-17T19:58:07.767
> 
> 标签：python, c, character-encoding, embedding

我在 C 程序中嵌入了一个 Python 解释器。假设 C 程序从一个文件中读取一些字节到一个 char 数组中，并且（不知何故）得知这些字节表示具有某种编码（例如，ISO 8859-1、Windows-1252 或 UTF-8）的文本。如何将此 char 数组的内容解码为 Python 字符串？

Python 字符串通常应该是类型`unicode`——例如，`0x93`Windows-1252 编码输入中的 a 变成`u'\u0201c'`.

我尝试使用`PyString_Decode`，但是当字符串中有非 ASCII 字符时它总是失败。这是一个失败的例子：

```
#include <Python.h>
#include <stdio.h>

int main(int argc, char *argv[])
{
     char c_string[] = { (char)0x93, 0 };
     PyObject *py_string;

     Py_Initialize();

     py_string = PyString_Decode(c_string, 1, "windows_1252", "replace");
     if (!py_string) {
          PyErr_Print();
          return 1;
     }
     return 0;
} 
```

错误消息是`UnicodeEncodeError: 'ascii' codec can't encode character u'\u201c' in position 0: ordinal not in range(128)`，这表明`ascii`即使我们`windows_1252`在对 的调用中指定了编码也被使用`PyString_Decode`。

以下代码通过使用`PyString_FromString`创建未解码字节的 Python 字符串，然后调用其`decode`方法来解决此问题：

```
#include <Python.h>
#include <stdio.h>

int main(int argc, char *argv[])
{
     char c_string[] = { (char)0x93, 0 };
     PyObject *raw, *decoded;

     Py_Initialize();

     raw = PyString_FromString(c_string);
     printf("Undecoded: ");
     PyObject_Print(raw, stdout, 0);
     printf("\n");
     decoded = PyObject_CallMethod(raw, "decode", "s", "windows_1252");
     Py_DECREF(raw);
     printf("Decoded: ");
     PyObject_Print(decoded, stdout, 0);
     printf("\n");
     return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T19:59:25.153

PyString_Decode 这样做：

```
PyObject *PyString_Decode(const char *s,
              Py_ssize_t size,
              const char *encoding,
              const char *errors)
{
    PyObject *v, *str;

    str = PyString_FromStringAndSize(s, size);
    if (str == NULL)
    return NULL;
    v = PyString_AsDecodedString(str, encoding, errors);
    Py_DECREF(str);
    return v;
} 
```

IOW，它基本上完成了您在第二个示例中所做的事情 - 转换为字符串，然后解码字符串。这里的问题来自 PyString_AsDecodedString，而不是 PyString_AsDecodedObject。PyString_AsDecodedString 执行 PyString_AsDecodedObject，但随后尝试将生成的 unicode 对象转换为具有默认编码的字符串对象（对您而言，看起来像是 ASCII）。那就是它失败的地方。

我相信您需要进行两次调用 - 但您可以使用 PyString_AsDecodedObject 而不是调用 python“解码”方法。就像是：

```
#include <Python.h>
#include <stdio.h>

int main(int argc, char *argv[])
{
     char c_string[] = { (char)0x93, 0 };
     PyObject *py_string, *py_unicode;

     Py_Initialize();

     py_string = PyString_FromStringAndSize(c_string, 1);
     if (!py_string) {
          PyErr_Print();
          return 1;
     }
     py_unicode = PyString_AsDecodedObject(py_string, "windows_1252", "replace");
     Py_DECREF(py_string);

     return 0;
} 
```

我不完全确定 PyString_Decode 以这种方式工作的原因是什么。python-dev 上的一个[非常古老的线程](http://mail.python.org/pipermail/python-dev/2001-May/014547.html)似乎表明它与链接输出有关，但由于 Python 方法不这样做，我不确定这是否仍然相关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T20:00:47.527

您不想将字符串解码为 Unicode 表示，您只想将其视为字节数组，对吗？

只需使用`PyString_FromString`：

```
char *cstring;
PyObject *pystring = PyString_FromString(cstring); 
```

就这样。现在你有了一个 Python`str()`对象。在此处查看文档：[https ://docs.python.org/2/c-api/string.html](https://docs.python.org/2/c-api/string.html)

我对如何指定“str”或“unicode”有点困惑。如果你有非 ASCII 字符，它们就完全不同了。如果您想解码 C 字符串**并且**您确切地知道它所在的字符集，那么是的，`PyString_DecodeString`这是一个很好的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:47:20.787

尝试调用[`PyErr_Print()`](https://docs.python.org/c-api/exceptions.html)“ `if (!py_string)`”子句。也许python异常会给你一些更多的信息。

# wcf - 我在哪里插入 WCF 以在消息到达时收到通知？

> ID：213630
> 
> 赞同：0
> 
> 时间：2008-10-17T19:59:03.053
> 
> 标签：wcf, extensibility, behavior

我正在编写一个示例控制台服务主机，我想插入 WCF 堆栈以便能够在新消息到达时将消息打印到控制台，即使它目前不会被服务处理（因为服务正在工作以前的电话）。这是基于我的假设，即到达的消息由 WCF 排队，对吗？

此外，如果这很重要，我正在使用 netTcpBinding。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T20:11:34.570

您可能必须为此编写一个自定义频道。查看[WCF 频道迷你书](http://wcf.netfx3.com/files/folders/product_team/entry3550.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T20:14:16.640

您可以编写自定义频道并将其插入到频道堆栈中的任何位置。排队发生在 ChannelListeners 中，它位于每个通道之间：

ChannelListener_1 -> Channel_1 -> ChannelListener_2 -> Channel_2 -> 等等。

因此，如果您要插入自己的频道侦听器/频道，您可以挂接到您需要的任何流程部分。但是请注意，消息内容可能无法读取，直到它深入堆栈并被解密。

# enums - 查找枚举类型的最佳位置在哪里？

> ID：213637
> 
> 赞同：43
> 
> 时间：2008-10-17T20:00:27.450
> 
> 标签：enums

我发现通常有一个单一类型或命名空间将任何特定枚举作为参数，因此我总是在那里定义这些枚举。不过最近，我让一位同事大谈特谈这是一件多么愚蠢的事情，并且您应该始终在项目的根目录中有一个枚举命名空间，您可以在其中定义每个枚举类型。

查找枚举类型的最佳位置在哪里？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-17T20:23:16.060

为什么将枚举与其他类型区别对待？将它们保存在可能被使用的相同命名空间中 - 并假设它们将被其他类使用，在它们自己的文件中使它们成为顶级类型。

*我*通常聚集在一起的唯一类型是委托 - 我有时有一个 Delegates.cs 文件，其中包含一堆委托。请注意，.NET 3.5 和 Func/Action 就不那么重要了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-17T20:03:27.287

此外，名称空间用于分离逻辑上属于一起的事物。并非所有类都属于同一个命名空间，只是因为它们是类。同样，并非所有枚举都属于同一个命名空间，因为它们是枚举。将它们与逻辑上属于它们的代码放在一起。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T20:09:45.637

我通常会尝试将所有不同的类型（类、接口和枚举）放在它们自己的文件中，不管它们有多小。它只是使查找和管理它们所在的文件变得更加容易，尤其是如果您碰巧不在 Visual Studio 中并且没有可用的“转到定义”功能。我发现几乎每次我在另一个类中放置一个这样的“简单”类型时，我最终要么稍后添加它，要么以一种不再有意义的方式重用它有自己的文件。

至于哪个命名空间，它真的取决于你正在开发的任何东西的设计。通常，我尝试模仿 .NET 框架的约定。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T20:26:21.907

我尝试将与类相关的所有内容都放在类中。这不仅包括枚举，还包括常量。我不想去别处搜索包含枚举的文件或类。在具有大量类和文件夹的大型应用程序中，将枚举文件放在哪里并不总是很明显，因此很容易找到。

如果枚举在几个密切相关的类中使用，您可以创建一个基类，以便在那里共享枚举等常见类型。

当然，如果枚举真的是通用的并且被广泛使用，您可能希望为它们创建一个单独的类，以及其他通用实用程序。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-07-14T16:44:53.010

我认为您将枚举和常量放在使用它们或使用它们来控制代码决策最多的类中，并且您使用代码完成来找到它们。这样你就不必记住它们在哪里，它们与类相关联。因此，例如，如果我有一个 ColoredBox 类，那么我不必考虑它们在哪里。它们将成为 ColoredBox 的一部分。ColoredBox.Colors.Red、ColoredBox.Colors.Blue 等。我认为枚举和常量是该类的属性或描述。如果它被多个类使用，并且没有一个类是至高无上的，那么有一个枚举类或常量类是合适的。这遵循封装规则。从不同的类中隔离属性。如果您决定更改 Cirle 对象中红色的 RGB 但您不这样做怎么办？不想更改 ColoredBox 对象的红色？封装它们的属性可以实现这一点。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-19T19:14:11.403

我为此使用嵌套的命名空间。我更喜欢它们而不是将枚举放在一个类中，因为在类之外，您必须使用完整的 MyClass::MyEnum 用法，即使 MyEnum 不会与范围内的任何其他内容发生冲突。

通过使用嵌套命名空间，您可以使用“使用”语法。此外，我会将与给定子系统相关的枚举放在它们自己的文件中，这样你就不会遇到必须包含世界才能使用它们的依赖问题。

所以在枚举头文件中你得到：

```
// MyEnumHeader.h
// Consolidated enum header file for this dll,lib,subsystem whatever.
namespace MyApp
{
  namespace MyEnums
  {
    enum SomeEnum { EnumVal0, EnumVal1, EnumVal2 };
  };
}; 
```

然后在类头文件中你得到：

```
// MyInterfaceHeader.h
// Class interfaces for the subsystem with all the expected dependencies.

#include "MyEnumHeader.h"

namespace MyApp
{
  class MyInterface
  {
  public:
    virtual void DoSomethingWithEnumParam (MyEnums::SomeEnum enumParam) = 0;
  };
}; 
```

或者使用尽可能多的枚举头文件。我喜欢将它们与类头分开，这样枚举就可以是系统中其他地方的参数，而不需要类头。然后，如果您想在其他地方使用它们，则不必像在类中声明枚举那样具有封装类定义。

如前所述，在外部代码中，您可以使用以下内容：

```
using namespace MyApp::MyEnums; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T20:01:58.507

什么环境？

在 .NET 中，我通常创建一个空的类文件，将其重命名为 MyEnum 或其他任何内容以表明它包含我的枚举，然后在其中声明它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-17T20:02:56.243

如果我的枚举有任何机会在我打算使用它的类之外使用，我会为枚举创建一个单独的源文件。否则，我会将它放在我打算使用它的类中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-17T20:06:42.007

通常我发现枚举以单个类为中心——作为 MyClassOptions 类型的东西。

在这种情况下，我将枚举放在与 MyClass 相同的文件中，但在命名空间内但在类外。

```
namespace mynamespace
{
  public partial class MyClass
  {
  }
  enum MyClassOptions
  {
  }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T20:04:06.037

我倾向于定义它们，它们的用途是显而易见的。如果我有一个结构的 typedef 出于某种原因使用它...

```
typedef enum {
  HI,
  GOODBYE
} msg_type;

typdef struct {
 msg_type type;
 union {
   int hivar;
   float goodbyevar;
  }
} msg; 
```

# c# - C# 事件如何在幕后工作？

> ID：213638
> 
> 赞同：41
> 
> 时间：2008-10-17T20:00:32.817
> 
> 标签：c#, events, .net-3.5, delegates

我正在使用 C#、.NET 3.5。我了解如何利用事件，如何在我的班级中声明它们，如何从其他地方挂钩它们等等。一个人为的例子：

```
public class MyList
{
    private List<string> m_Strings = new List<string>();
    public EventHandler<EventArgs> ElementAddedEvent;

    public void Add(string value)
    {
        m_Strings.Add(value);
        if (ElementAddedEvent != null)
            ElementAddedEvent(value, EventArgs.Empty);
    }
}

[TestClass]
public class TestMyList
{
    private bool m_Fired = false;

    [TestMethod]
    public void TestEvents()
    {
        MyList tmp = new MyList();
        tmp.ElementAddedEvent += new EventHandler<EventArgs>(Fired);
        tmp.Add("test");
        Assert.IsTrue(m_Fired);
    }

    private void Fired(object sender, EventArgs args)
    {
        m_Fired = true;
    }
} 
```

但是，我*不*明白的是，当一个人声明一个事件处理程序时

```
public EventHandler<EventArgs> ElementAddedEvent; 
```

它从未被初始化——那么 ElementAddedEvent 到底是什么？它指向什么？以下将不起作用，因为 EventHandler 从未初始化：

```
[TestClass]
public class TestMyList
{
    private bool m_Fired = false;

    [TestMethod]
    public void TestEvents()
    {
        EventHandler<EventArgs> somethingHappend;
        somethingHappend += new EventHandler<EventArgs>(Fired);
        somethingHappend(this, EventArgs.Empty);
        Assert.IsTrue(m_Fired);
    }

    private void Fired(object sender, EventArgs args)
    {
        m_Fired = true;
    }
} 
```

我注意到有一个 EventHandler.CreateDelegate(...)，但所有方法签名都表明这仅用于通过典型的 ElementAddedEvent += new EventHandler(MyMethod) 将委托附加到已经存在的 EventHandler。

I'm not sure if *what* I am trying to do will help... but ultimately I'd like to come up with an abstract parent DataContext in LINQ whose children can register which table Types they want "observed" so I can have events such as BeforeUpdate and AfterUpdate, but specific to types. Something like this:

```
public class BaseDataContext : DataContext
{
    private static Dictionary<Type, Dictionary<ChangeAction, EventHandler>> m_ObservedTypes = new Dictionary<Type, Dictionary<ChangeAction, EventHandler>>();

    public static void Observe(Type type)
    {
        if (m_ObservedTypes.ContainsKey(type) == false)
        {
            m_ObservedTypes.Add(type, new Dictionary<ChangeAction, EventHandler>());

            EventHandler eventHandler = EventHandler.CreateDelegate(typeof(EventHandler), null, null) as EventHandler;
            m_ObservedTypes[type].Add(ChangeAction.Insert, eventHandler);

            eventHandler = EventHandler.CreateDelegate(typeof(EventHandler), null, null) as EventHandler;
            m_ObservedTypes[type].Add(ChangeAction.Update, eventHandler);

            eventHandler = EventHandler.CreateDelegate(typeof(EventHandler), null, null) as EventHandler;
            m_ObservedTypes[type].Add(ChangeAction.Delete, eventHandler);
        }
    }

    public static Dictionary<Type, Dictionary<ChangeAction, EventHandler>> Events
    {
        get { return m_ObservedTypes; }
    }
}

public class MyClass
{
    public MyClass()
    {
        BaseDataContext.Events[typeof(User)][ChangeAction.Update] += new EventHandler(OnUserUpdate);
    }

    public void OnUserUpdated(object sender, EventArgs args)
    {
        // do something
    }
} 
```

Thinking about this made me realize I don't really understand what's happening under the hod with events - and I would like to understand :)

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-17T20:05:03.570

I've written this up in a fair amount of detail in [an article](http://pobox.com/~skeet/csharp/events.html), but here's the summary, assuming you're reasonably happy with [delegates](http://msdn.microsoft.com/en-us/library/ms173171.aspx) themselves:

*   An event is just an "add" method and a "remove" method, in the same way that a property is really just a "get" method and a "set" method. (In fact, the CLI allows a "raise/fire" method as well, but C# never generates this.) Metadata describes the event with references to the methods.
*   When you declare a *[field-like event](http://msdn.microsoft.com/en-us/library/aa664455.aspx)* (like your ElementAddedEvent) the compiler generates the methods *and a private field* (of the same type as the delegate). Within the class, when you refer to ElementAddedEvent you're referring to the field. Outside the class, you're referring to the field.
*   When anyone subscribes to an event (with the += operator) that calls the add method. When they unsubscribe (with the -= operator) that calls the remove.
*   For field-like events, there's some synchronization but otherwise the add/remove just call Delegate.[Combine](http://msdn.microsoft.com/en-us/library/system.delegate.combine.aspx)/[Remove](http://msdn.microsoft.com/en-us/library/system.delegate.remove.aspx) to change the value of the auto-generated field. Both of these operations assign to the backing field - remember that delegates are immutable. In other words, the autogenerated code is very much like this:

    ```
    // Backing field
    // The underscores just make it simpler to see what's going on here.
    // In the rest of your source code for this class, if you refer to
    // ElementAddedEvent, you're really referring to this field.
    private EventHandler<EventArgs> __ElementAddedEvent;

    // Actual event
    public EventHandler<EventArgs> ElementAddedEvent
    {
        add
        {
            lock(this)
            {
                // Equivalent to __ElementAddedEvent += value;
                __ElementAddedEvent = Delegate.Combine(__ElementAddedEvent, value);
            }
        }
        remove
        {
            lock(this)
            {
                // Equivalent to __ElementAddedEvent -= value;
                __ElementAddedEvent = Delegate.Remove(__ElementAddedEvent, value);
            }
        }
    } 
    ```

*   The initial value of the generated field in your case is `null` - and it will always become `null` again if all subscribers are removed, as that is the behaviour of Delegate.Remove.

*   If you want a "no-op" handler to subscribe to your event, so as to avoid the nullity check, you can do:

    ```
    public EventHandler<EventArgs> ElementAddedEvent = delegate {}; 
    ```

    The `delegate {}` is just an anonymous method which doesn't care about its parameters and does nothing.

If there's anything that's still unclear, please ask and I'll try to help!

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2008-10-17T20:06:48.387

Under the hood, events are just delegates with special calling conventions. (For example, you don't have to check for nullity before raising an event.)

In pseudocode, Event.Invoke() breaks down like this:

If Event Has Listeners Call each listener synchronously on this thread in arbitrary order.

Since events are multicast, they will have zero or more listeners, held in a collection. The CLR will loop through them, calling each in an arbitrary order.

One big caveat to remember is that event handlers execute in the same thread as the event is raised in. It's a common mental error to think of them as spawning a new thread. They do not.

# asp.net - 解密 YSOD，混乱的技术

> ID：213644
> 
> 赞同：4
> 
> 时间：2008-10-17T20:01:59.317
> 
> 标签：asp.net, debugging

有多少人能做到这一点？

> # /应用程序中的服务器错误
> 
> * * *
> 
> ## *对象引用未设置为对象*
> 
> **说明：**对象引用未设置为对象。
> 
> **异常详细信息:** `System.NullReferenceException` : 对象引用未设置为对象。
> 
> **源错误：**
> 
> ```
> Line 56:    posts.Add(post); 
> ```

更严肃地说，当你看到黄色的死亡屏幕时，你首先要寻找的是什么？调试跟踪的一半时间实际上并没有告诉你问题是什么（我猜是可以理解的）。

我必须承认，我仍然`Response.Write`比我应该使用的更多。我只是懒得通过调试器。您使用什么技术来调试问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T20:09:56.820

如果我无法使用页面显示给我的错误消息来识别/解决问题，我通常会尝试使用 Windows 事件查看器来帮助我确定导致问题的原因。

例如，SharePoint 错误有时远不如描述性错误。因此，我将把我在 YSOD 上看到的内容与来自事件查看器的错误消息结合起来，以帮助我缩小原因。

我会尽力询问我认为可能有一些经验可能会有所帮助的同事或其他同事。如果我仍然无法确定原因，我将求助于拥有所有信息的谷歌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T20:14:46.280

以下是我尝试减少 YSOD 数量的方法。在开始开发应用程序时，我做的第一件事就是创建一个自定义异常类。

*   添加属性，例如正在运行的 SQL 语句。两个显示消息文本字段，一个用于显示给用户，一个用于显示给开发人员（在调试模式下） 谁是登录用户。获取所有表单变量，以便您知道他们试图输入的内容。

*   在某处记录错误（事件日志很好，如果您可以访问 Web 服务器；当如此多的异常无法访问数据库时，记录到数据库的成功率较低）。

*   在 MasterPage 或网页基类 Page Error 事件和 Application Error 事件中创建代码以进行日志记录。

*   创建自定义错误页面。在调试模式下，自定义错误页面会显示所有内容。未处于调试模式（生产）时，仅显示自定义异常的选定属性。

预先花时间来做这件事可以为你节省很多小时的痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T20:11:22.950

我通常使用 Cassini Web 服务器（VS 2005/2008 附带）在本地机器上进行调试。如果我在我的 QA 上看到异常，或者，天堂禁止，我的生产箱，这通常是因为我忘记更新我的连接字符串，以便它们指向 QA/生产数据库而不是我的本地机器。

在其他情况下，我发现堆栈跟踪对于确定在何处提供断点非常有帮助，因此我在调试器中单步执行它并在运行时检查数据。我在页面上编写任何调试信息的唯一一次是试图找到一些我无法在我的开发人员实例上复制的性能问题。在这种情况下，我编写了一些隐藏字段，其中包含有关渲染过程各个部分的时间信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:13:11.480

假设您处于调试模式，提供的错误信息将为您提供有关实际发生错误的行的信息，以及导致错误的代码行。此信息应该为您定义在何处设置调试断点提供了一个良好的开端。

很多个月前我曾经站在你的立场上，使用 response.write 进行调试。一旦您开始按预期使用 IDE 和调试器，您会发现自己减少了很多麻烦并更快地找到解决方案。

此外，在调试时打开即时窗口会让你的生活更加快乐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:26:38.893

使用不错的日志框架，例如[log4net](http://logging.apache.org/log4net/index.html)，并在使用 DEBUG 级别的日志时保持自由。

它本质上是您的 Response.Write 方法的一个更简洁的版本，它可以留在您的生产代码中，并在需要时“打开”。

# unit-testing - 在测试 API 的包装器时，我的单元测试是否应该直接接触 API？

> ID：213646
> 
> 赞同：8
> 
> 时间：2008-10-17T20:02:52.233
> 
> 标签：unit-testing, tdd

我编写了一些单元测试来***测试围绕 FTP 服务器 API 的包装器*。**

单元测试和 FTP 服务器都在同一台机器上。

包装器 API 被部署到我们的平台并用于远程处理和 Web 服务场景。包装 API 本质上采用 XML 消息来执行任务，例如添加/删除/更新用户、更改密码、修改权限……诸如此类。

在单元测试中，假设将用户添加到虚拟域，我创建 XML 消息以发送到 API。API 完成它的工作并返回一个响应，其中包含有关操作是成功还是失败的状态信息（错误代码、验证失败等）。

为了验证 API 包装器代码是否确实做了正确的事情（如果响应指示成功），我调用 FTP 服务器的 COM API 并直接查询其存储以查看，例如，在创建用户帐户时，用户帐户是否真的做了被创建。

这气味难闻吗？

**更新 1：** @Jeremy/Nick：包装器是测试的重点，FTP 服务器及其 COM API 是第 3 方产品，可能经过良好测试且稳定。包装 API 必须解析 XML 消息，然后调用 FTP 服务器的 API。我将如何验证包装器正确设置了用户帐户的特定属性，这可能是一个愚蠢的情况。例如，由于包装代码中的拼写错误，设置了错误的 FTP 帐户的属性或属性。一个很好的例子是设置上传和下载速度限制，这些可能会在包装代码中转置。

**更新2：**感谢大家的回答。对于建议使用模拟的人，我已经想到了，但是那里的灯还没有打开，我仍在努力思考如何让我的包装器与 FTP 服务器的模拟一起工作. 模拟将驻留在哪里，我是否将所述模拟的实例传递给包装器 API 以使用而不是调用 COM API？我知道嘲弄但很难理解它，主要是因为我发现大多数示例和教程都非常抽象并且（我很惭愧地说）接近于难以理解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T20:23:18.510

您似乎在混合单元和组件测试问题。

*   如果您正在对包装器进行单元测试，您应该使用模拟 FTP 服务器并且不涉及实际服务器。好的一面是，您通常可以像这样实现 100% 的自动化。
*   如果您正在对整个事物进行组件测试（包装器 + FTP 服务器一起工作），请尝试在与您的测试相同的级别上验证您的结果，即通过您的包装器 API。例如，如果您发出上传文件的命令，接下来，发出删除/下载该文件的命令，以确保文件已正确上传。对于测试结果并非易事的更复杂的操作，请考虑使用您提到的 COM API“后门”，或者可能涉及一些手动验证（您的所有测试都需要自动化吗？）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T20:27:51.823

> 为了验证 API 包装器代码是否确实做了正确的事情（如果响应指示成功），我调用了 FTP 服务器的 COM API

停在那儿。您应该模拟 FTP 服务器，并且包装器应该对模拟进行操作。

如果您的测试同时运行包装器和 FTP 服务器，则您不是单元测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T03:35:29.070

要使用模拟对象测试您的包装器，您可以执行以下操作：

*   编写一个与 FTP 服务器的 COM API 具有相同接口的 COM 对象。这将是您的模拟对象。您应该能够通过依赖注入将任何一个的接口指针传递给您的包装器来交换真实的 FTP 服务器和您的模拟对象。
*   您的模拟对象应该基于在其接口上调用的方法（模仿 FTP 服务器 API）以及使用的参数值来实现硬编码行为：
*   例如，如果您有一个`UploadFile`方法，您可以盲目地返回成功结果，并且可能将传入的文件名存储在字符串数组中。
*   当您遇到包含“错误”的文件名时，您可以模拟上传错误。
*   当您遇到包含“慢”的文件名时，您可以模拟延迟/超时。
*   稍后，该`DownloadFile`方法可以检查内部字符串数组以查看具有该名称的文件是否已经“上传”。

一些测试用例的伪代码是：

```
//RealServer theRealServer;
//FtpServerIntf ftpServerIntf = theRealServer.getInterface();

// Let's test with our mock instead
MockServer myMockServer;
FtpServerIntf ftpServerIntf = myMockServer.getInterface();

FtpWrapper myWrapper(ftpServerIntf);

FtpResponse resp = myWrapper.uploadFile("Testing123");
assertEquals(FtpResponse::OK, resp);

resp = myWrapper.downloadFile("Testing123");
assertEquals(FtpResponse::OK, resp);

resp = myWrapper.downloadFile("Testing456");
assertEquals(FtpResponse::NOT_FOUND, resp);

resp = myWrapper.downloadFile("SimulateError");
assertEquals(FtpResponse::ERROR, resp); 
```

我希望这有帮助...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T20:13:33.773

我同意 Nick 和 Jeremy 关于不接触 API 的观点。我会考虑模拟 API。

[http://en.wikipedia.org/wiki/Mock_object](http://en.wikipedia.org/wiki/Mock_object)

如果是 .NET，您可以使用：起订量
：[http](http://code.google.com/p/moq/)

://code.google.com/p/moq/ 以及一堆其他模拟库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:05:53.007

您在测试包装器或 API。API 应该按原样工作，所以我认为您不需要对其进行测试。将您的测试工作集中在包装器上，并假装 API 不存在，当我编写一个执行文件访问的类时，我不会在 streamreader 中对构建进行单元测试......我专注于我的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T20:08:50.880

我会说你的 API 在测试时应该像数据库或网络连接一样对待。不要测试它，它不在你的控制之下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T20:20:13.383

听起来您不是在问“我应该*测试*API 吗？” ——你在问“我应该使用 API 来验证我的包装器是否在做正确的事情吗？”

我说是。您的单元测试应该断言您的包装器会传递 API 报告的信息。例如，在您给出的示例中，我不知道您将如何避免接触 API。所以我不认为它闻起来很臭。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T21:07:23.757

如果更高级别的 API 是只写的，那么我唯一能想到的可能是深入到较低级别的 API 以验证结果。例如，如果您可以使用高级 API 创建用户，那么也应该有一个高级 API 来获取用户帐户。用那个。

其他人建议模拟较低级别的 API。那很好，如果你能做到的话。如果较低级别的组件被模拟，检查模拟以确保设置正确的状态应该没问题。

# flash - 如何在 actionscript 中为 crossdomain.xml 指定自定义位置？

> ID：213655
> 
> 赞同：3
> 
> 时间：2008-10-17T20:06:19.293
> 
> 标签：flash, actionscript, crossdomain.xml

我们在媒体托管服务器上托管 swf 资产，无法将文件放到根目录，有人知道为 crossdomain.xml 指定自定义位置的代码是什么样的吗？如果你有示例代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T20:57:21.827

我不想回答我自己的问题，但我找到了代码，所以我想我会在这里发布以增加这个问题的参考价值：

> 来自：[http ://www.voiceoftech.com/swhitley/?p=117](http://www.voiceoftech.com/swhitley/?p=117)
> 
> 在 SSL 服务器上设置 crossdomain.xml 文件的问题是我无权访问服务器。它只是指向我服务器上的虚拟根目录，而我无权访问 SSL 服务器的 Web 根目录。
> 
> flash.system.Security.loadPolicyFile("{Url to my crossdomain.xml file on the SSL virtual root}");
> 
> 通过这些更改，我可以轻松地将 Google 帐户与我的 Flash 应用程序集成。

# asp-classic - 如何在 VBScript 中逐行读取 CSV 文件

> ID：213657
> 
> 赞同：9
> 
> 时间：2008-10-17T20:06:34.847
> 
> 标签：asp-classic, vbscript, csv

我正在使用一个 ASP 页面，我必须在其中读取一个 CSV 文件并将其插入到数据库表“Employee”中。我正在创建一个 TestReader 对象。如何编写一个循环来执行最多正在读取的 CSV 文件的行/记录数？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T20:33:07.820

不要试图自己解析文件，你只会让自己头疼。除了在换行符和逗号上拆分之外，还有很多其他内容。

您可以使用 OLEDB 在记录集中打开文件并像读取 db 表一样读取它。像这样的东西：

```
Dim strConn, conn, rs

strConn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & _
Server.MapPath("path to folder") & ";Extended Properties='text;HDR=Yes;FMT-Delimited';"

Set conn = Server.CreateObject("ADODB.Connection")
conn.Open strConn

Set rs = Server.CreateObject("ADODB.recordset")
rs.open "SELECT * FROM myfile.csv", conn

while not rs.eof
    ...
    rs.movenext
wend 
```

我的 vbscript 生锈了，所以请验证语法。

**编辑：** harpo 的评论提出了一个关于字段定义的好观点。定义 schema.ini 文件允许您定义预期字段的数量和数据类型。请参阅：您可以通过定义 schema.ini 文件来处理此问题。请参阅：http: [//msdn.microsoft.com/en-us/library/ms709353.aspx](http://msdn.microsoft.com/en-us/library/ms709353.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T20:38:03.113

为什么不直接插入 CSV？例如：

```
SELECT * INTO MyTable FROM OPENDATASOURCE('Microsoft.JET.OLEDB.4.0', 
'Data Source=F:\MyDirectory;Extended Properties="text;HDR=No"')...
[MyCsvFile#csv] 
```

来自： [http ://coding.derkeiler.com/Archive/Delphi/borland.public.delphi.database.ado/2007-05/msg00057.html](http://coding.derkeiler.com/Archive/Delphi/borland.public.delphi.database.ado/2007-05/msg00057.html)

# c# - 我可以使用 hwnd / NativeWindow 设置我的 WinForms 表单所有者的行为吗？

> ID：213661
> 
> 赞同：6
> 
> 时间：2008-10-17T20:07:34.423
> 
> 标签：c#, winforms, hwnd

我的应用程序是一个 vb6 可执行文件，但系统中一些较新的形式是用 C# 编写的。我希望能够使用主应用程序窗口的句柄设置 C# 表单的 Owner 属性，以便在我的应用程序和其他应用程序之间来回切换时对话框保持在顶部。

我可以得到主应用程序窗口的 hwnd。我不确定我能从那里做什么？

* * *

**2008 年 10 月 20 日 17:06 更新：**

斯科特，

感谢您的回复。我忽略了 Show/ShowDialog 方法参数不是 Form 类型 - 我只查看 Owner 属性。

我从上面稍微修改了我正在使用的代码 - 我们有一个组件通常加载我们的表单并调用 ShowDialog。我的代码如下所示：

```
Form launchTarget = FormFactory.GetForm(xxx);  // psuedo-code for generic form loader
launchTarget.StartPosition = FormStartPosition.CenterParent;
IWin32Window parentWindow = GetWindowFromHwnd(hwnd);

launchTarget.ShowDialog(parentWindow); 
```

`GetWindowFromHwnd`是您的代码的方法包装版本：

```
private IWin32Window GetWindowFromHost(int hwnd)
{
    IWin32Window window = null;
    IntPtr handle = new IntPtr(hwnd);

    try
    {
        NativeWindow nativeWindow = new NativeWindow();
        nativeWindow.AssignHandle(handle);
        window = nativeWindow;
    }
    finally
    {
        handle = IntPtr.Zero;
    }

    return window;
} 
```

不幸的是，这并没有达到我的预期。该表单确实以模态方式显示，但是当我离开并返回父窗口时，它没有显示在正确的位置，也没有显示在顶部。我们的模态不会在任务栏中显示任务，因此窗口看似“消失”（尽管它仍然存在于 alt-tab 窗口列表中）。这对我来说表明我可能没有正确的 hwnd。如果您有任何其他建议，请回复。再次感谢。

* * *

**更新 2008 年 11 月 10 日 16:25**

一个后续评论 - 如果您将其分解为 try/finally 中的方法调用，如 Scott 的第二篇文章中那样，finally 块中的调用应该是：

```
parentWindow.ReleaseHandle(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T20:36:13.303

因此，您正在从 VB6 调用 C# Windows Form 类，这意味着您可能正在使用`Show()`or `ShowDialog()`，对吗？这两种方法都采用 IWin32Window 参数，该参数简单地定义了一个返回名为 Handle 的 IntPtr 属性的对象。

所以...您需要为您的 Windows 窗体类添加一个重载的构造函数（或 ShowDialog 方法），该类将 a`long`作为参数，以便您可以将 VB6 hwnd 传递给窗体。一旦进入 C# 代码，您需要从 hwnd 创建一个 IntPtr 并将其分配给一个`NativeWindow`对象，然后将其作为所有者传递。

像这样的东西**应该可以**工作，尽管它未经测试：

```
public DialogResult ShowDialog(long hwnd)
{
   IntPtr handle = new IntPtr(hwnd);
   try
   {
      NativeWindow nativeWindow = new NativeWindow();

      nativeWindow.AssignHandle(handle);
      return this.ShowDialog(nativeWindow);
   }
   finally
   {
      handle = IntPtr.Zero;
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T17:27:56.617

这太长了，不能作为评论发布......

我认为您遇到的问题是您包装我在 ShowDialog 重载中提供的代码的方式。如果您遵循您的`GetWindowFromHost`代码正在执行的操作，则会执行以下步骤：

1.  从给定的 hwnd 创建一个新的 IntPtr。
2.  创建一个新的 NativeWindow 对象并将其句柄分配为 IntPtr。
3.  将 IntPtr（在 finally 块中）设置为 IntPtr.Zero。

我认为正是这个 finally 块给你带来了问题。在我的代码中，finally 块将在调用`this.ShowDialog(nativeWindow)`完成后运行。此时不再使用句柄 (IntPtr)。在您的代码中，您将返回一个`IWin32Window`仍应持有对该 IntPtr 的引用，在您调用该 IntPtr 时它`launchTarget.ShowDialog(parentWindow)`是 IntPtr.Zero。

尝试将您的代码更改为如下所示：

```
private NativeWindow GetWindowFromHost(int hwnd)
{
   IntPtr handle = new IntPtr(hwnd);
   NativeWindow nativeWindow = new NativeWindow();
   nativeWindow.AssignHandle(handle);
   return window;
} 
```

然后将您的调用代码更改为如下所示：

```
Form launchTarget = FormFactory.GetForm(xxx);  // psuedo-code for generic form 
loaderlaunchTarget.StartPosition = FormStartPosition.CenterParent;
NativeWindow parentWindow = GetWindowFromHwnd(hwnd);

try
{
   launchTarget.ShowDialog(parentWindow);
}
finally
{
   parentWindow.DestroyHandle();
} 
```

这些更改应该有效，但同样未经测试。

# svn - 将遗留项目（过时的文件夹系列）导入 Subversion

> ID：213671
> 
> 赞同：3
> 
> 时间：2008-10-17T20:10:34.013
> 
> 标签：svn, version-control, import, repository

有谁知道将遗留项目（其“版本控制系统”是一系列过时的文件夹）导入SVN的简单方法，以便保留修订历史？

我继承的项目不受版本控制，并且有数百个文件夹，每个文件夹的日期如下：2006-11-26、2006-11-27 等...谢天谢地，他们在努力创建文件夹，即使（数周）没有任何改变。

我喜欢的是一个脚本/工具，它将使用最旧的文件夹创建一个新的存储库，然后按顺序自动应用所有 subversion 命令以将每个以后的文件夹转换为新的修订版。

我希望这是有道理的。我的旧 shell 脚本编写者很想自己解决这个问题，但是 a) 我确信这比我最初想象的要多，b) 这不是我时间的最佳利用（我不是这方面的专家）编写 shell 脚本）和 c）我敢打赌有人已经这样做了。

额外积分：让脚本/工具也根据文件夹名称修改时间戳属性，以便颠覆中的历史更接近现实。

我希望一切都说得通。

非常感谢您的帮助。

PS我宁愿在Linux下做这一切，但如果有一个（喘气！）Windows解决方案，乞丐不能选择，可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T20:37:05.270

我认为shell脚本解决方案不会太难。像这样的东西：

```
for d in 200*
do
    cp -a $d/* svndir/
    cd svndir
    svn add *
    svn commit
    cd ..
done 
```

我知道相当幼稚的代码，但我认为有点像这样的东西可以完成这项工作（前提是已经有一个存储库签入到 svndir）。可能 svn commit 有一个参数跳过了输入注释的要求，否则这将非常乏味。

cp -a 将保留时间戳，但当然 svn 历史记录将显示当前日期提交的所有内容。或许您可以在每次复制和提交时使用“日期”命令根据目录名称（$d 的值）实际设置服务器日期。然而，这可能有点过头了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T15:12:50.523

对于这个用例，创建了[**load-dirs.pl**](http://svn.collab.net/repos/svn/trunk/contrib/client-side/svn_load_dirs/)，它获取您的目录并将它们导入 Subversion，还可以维护版本历史记录以进行重命名和删除。subversion 存储库中提供了一个很好的文档（上面的链接）

# javascript - 带有 jcarousel 的多行

> ID：213680
> 
> 赞同：6
> 
> 时间：2008-10-17T20:12:31.607
> 
> 标签：javascript, jquery, jcarousel

我正在尝试使用 jcarousel 构建一个具有多行的容器，我尝试了一些事情但没有运气。任何人都可以就如何创建它提出任何建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-08-08T22:36:25.653

这是根据@Sike 和我的一些额外的.js 代码替换，高度不是动态设置的，现在是。

```
var defaults = {
        vertical: false,
        rtl: false,
        start: 1,
        offset: 1,
        size: null,
        scroll: 3,
        visible: null,
        animation: 'normal',
        easing: 'swing',
        auto: 0,
        wrap: null,
        initCallback: null,
        setupCallback: null,
        reloadCallback: null,
        itemLoadCallback: null,
        itemFirstInCallback: null,
        itemFirstOutCallback: null,
        itemLastInCallback: null,
        itemLastOutCallback: null,
        itemVisibleInCallback: null,
        itemVisibleOutCallback: null,
        animationStepCallback: null,
        buttonNextHTML: '<div></div>',
        buttonPrevHTML: '<div></div>',
        buttonNextEvent: 'click',
        buttonPrevEvent: 'click',
        buttonNextCallback: null,
        buttonPrevCallback: null,
        moduleWidth: null,
        rows: null,
        itemFallbackDimension: null
    }, windowLoaded = false;

    this.clip.addClass(this.className('jcarousel-clip')).css({
        position: 'relative',
        height: this.options.rows * this.options.moduleWidth
    });

    this.container.addClass(this.className('jcarousel-container')).css({
            position: 'relative',
            height: this.options.rows * this.options.moduleWidth
        });

    if (li.size() > 0) {
            var moduleCount = li.size();
            var wh = 0, j = this.options.offset;
            wh = this.options.moduleWidth * Math.ceil(moduleCount / this.options.rows);
            wh = wh + this.options.moduleWidth;

            li.each(function() {
                self.format(this, j++);
                //wh += self.dimension(this, di);
            });

            this.list.css(this.wh, wh + 'px');

            // Only set if not explicitly passed as option
            if (!o || o.size === undefined) {
                this.options.size = Math.ceil(li.size() / this.options.rows);
            }
        } 
```

这是使用 jscarousel 下载中代码包的 static_sample.html 的调用：

```
<script type="text/javascript">

jQuery(document).ready(function() {
    jQuery('#mycarousel').jcarousel( {
        scroll: 1,
        moduleWidth: 75,
        rows:2,        
        animation: 'slow'
    });
});

</script> 
```

如果您需要更改轮播的内容并重新加载轮播，您需要执行以下操作：

```
// Destroy contents of wrapper
$('.wrapper *').remove();
// Create UL list
$('.wrapper').append('<ul id="carousellist"></ul>')
// Load your items into the carousellist
for (var i = 0; i < 10; i++)
{
$('#carouselist').append('<li>Item ' + i + '</li>');
}
// Now apply carousel to list
jQuery('#carousellist').jcarousel({ // your config }); 
```

carousel html 定义需要是这样的：

```
<div class="wrapper">
    <ul id="mycarousel0" class="jcarousel-skin-tango">
     ...<li></li>
     </ul>
</div> 
```

感谢[Webcidentes](http://www.cabezabomba.com/webcidentes/?p=308)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-28T10:52:06.857

我们不得不进行类似的修改。我们通过扩展默认选项来做到这一点，包括行值和每个项目的宽度（我们称之为模块），然后将宽度除以行数。

添加到 jCarousel 函数的代码...

添加到默认选项：

```
moduleWidth: null,
rows:null, 
```

然后在创建jCarousel时设置：

```
$('.columns2.rows2 .mycarousel').jcarousel( {
        scroll: 1,
        moduleWidth: 290,
        rows:2,
        itemLoadCallback: tonyTest,
        animation: 'slow'
    }); 
```

查找并编辑以下行：

```
$.jcarousel = function(e, o) { 

if (li.size() > 0) {
...
moduleCount = li.size();
wh = this.options.moduleWidth * Math.ceil( moduleCount / this.options.rows );
wh = wh + this.options.moduleWidth;

this.list.css(this.wh, wh + 'px');

// Only set if not explicitly passed as option
if (!o || o.size === undefined)
   this.options.size = Math.ceil( li.size() / this.options.rows ); 
```

希望这可以帮助，

托尼狄龙

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T04:10:45.750

您可能想查看[serialScroll](http://flesler.blogspot.com/2008/02/jqueryserialscroll.html)或[localScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)而不是 jcarousel。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-19T21:38:04.567

我在 Google Groups 上发现了这篇文章，它有一个适用于多行的工作版本。我用过这个，效果很好。[http://groups.google.com/group/jquery-en/browse_thread/thread/2c7c4a86d19cadf9](http://groups.google.com/group/jquery-en/browse_thread/thread/2c7c4a86d19cadf9)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-27T11:57:42.533

我尝试了上述解决方案，发现更改原始 jCarousel 代码很麻烦 - 它为我引入了错误的行为，因为它与 jCarousel 的某些功能（例如连续循环等）不兼容。

我使用了另一种效果很好的方法，我认为其他人也可以从中受益。这是我用来创建 li 项目以支持 jCarousel 的 JS 代码，该 jCarousel 具有多行和优雅的项目流，即水平填充，然后垂直填充，然后滚动页面：

123 | 789
456 | 0AB

它将（var carouselRows 的值）项目添加到单个 li，因此允许 jCarousel 支持多行，而无需修改原始 jCarousel 代码。

```
// Populate Album photos with support for multiple rows filling first columns, then rows, then pages
var carouselRows=3; // number of rows in the carousel
var carouselColumns=5 // number of columns per carousel page
var numItems=25; // the total number of items to display in jcarousel

for (var indexpage=0; indexpage<Math.ceil(numItems/(carouselRows*carouselColumns)); indexpage++) // for each carousel page
{
    for (var indexcolumn = 0; indexcolumn<carouselColumns; indexcolumn++) // for each column on that carousel page
    {
        // handle cases with less columns than value of carouselColumns
        if (indexcolumn<numItems-(indexpage*carouselRows*carouselColumns))
        {
            var li = document.createElement('li');

            for (var indexrow = 0; indexrow < carouselRows; indexrow++) // for each row in that column
            {
                var indexitem = (indexpage*carouselRows*carouselColumns)+(indexrow*carouselColumns)+indexcolumn;

                // handle cases where there is no item for the row below
                if (indexitem<numItems) 
                {
                    var div = document.createElement('div'), img = document.createElement('img');
                    img.src = imagesArray[indexitem]; // replace this by your images source
                    div.appendChild(img);
                    li.appendChild(div);
                }
            }
            $ul.append(li); // append to ul in the DOM
        }
    }
} 
```

在这段代码用 li 项填充 ul 之后，应该调用 jCarousel。

希望这可以帮助某人。

乔纳森

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-17T09:00:29.147

如果您需要一个固定或一次性需求的快速解决方案，绝对不涉及更改可能会不时更新的核心库代码，以下可能适合。要将以下六项在轮播中变成两行：

```
<div class="item">contents</div>
<div class="item">contents</div>
<div class="item">contents</div>
<div class="item">contents</div>
<div class="item">contents</div>
<div class="item">contents</div> 
```

您可以使用一点 JS 将 div 包装成 LI 组，每组两个，然后初始化轮播。您的方案可能允许您在服务器上进行分组并不总是可能的。显然，您可以将其扩展到所需的行数。

```
var $pArr = $('div.item');
var pArrLen = $pArr.length;
for (var i = 0;i < pArrLen;i+=2){
      $pArr.filter(':eq('+i+'),:eq('+(i+1)+')').wrapAll('<li />');
}; 
```

# php - base64_encode 奇怪的行为

> ID：213683
> 
> 赞同：1
> 
> 时间：2008-10-17T20:13:16.533
> 
> 标签：php, base64

我正在做类似以下的事情：

```
SELECT * FROM table WHERE user='$user';
$myrow = fetchRow() // previously I inserted a pass to the db using base64_encode ex: WRM2gt3R=

$somepass = base64_encode($_POST['password']);

if($myrow[1] != $somepass) echo 'error';
else echo 'welcome'; 
```

我总是出错，我什至回显 $somepass 和 $myrow[1] 它们是相同的，但仍然是错误。我究竟做错了什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T20:18:29.813

尝试使用`var_dump`代替 echo - 也许其中一个在开始/结束处有空格或换行符。

编辑：

您必须将其存储为 CHAR(40)：`A fixed-length string that is always right-padded with spaces to the specified length when stored`

使用 VARCHAR 或`trim()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T20:20:31.637

如果 $myrow[1] 实际上是 base64 编码中的正确密码，我看不到任何错误。

最后试试这个：

```
echo "<br />$myrow[1] != $somepass"; 
```

它说什么？

顺便说一句：我看不出有任何理由对密码进行 base64 编码。你想达到什么目的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T20:30:19.587

我想如果我做一个 var_dump() 我会得到：

字符串（40）“YWRraM2=”字符串（8）“YWRraM2=”

如果我使用控制台将数据插入数据库，它似乎会以某种方式向 pass 字段添加额外的空间。

myplacedk：有什么理由我不应该这样做吗？我认为它会增加额外的安全性？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:38:39.197

这种编码做了两件事：

1.  它添加代码，使其更复杂，更容易出错
2.  如果您在屏幕上查看您的数据库，并且有人在您的肩膀上看着，那么密码可能会更难记住。

所以不，它并没有真正增加任何安全性。它只是一种编码，很容易解码。

也许你把它误认为是 md5-hashing 或类似的东西。

到处玩是很棒的，但是说到安全性，我真的建议不要使用你不理解的东西。从长远来看，它弊大于利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:42:52.573

一些问题：

*   根据您在其他地方的评论，我猜当前代码的问题在于您的数据库字段是 CHAR(40)。CHAR 字段始终具有固定大小。尝试将数据库字段类型更改为 VARCHAR 而不是 CHAR。

*   在存储到数据库之前使用 base64_encode 远非安全。好的做法是在数据库中只存储密码的单向哈希——通常是 md5 或（更好的）sha1。然后，当用户想要登录时，对提供的密码使用相同的哈希函数，然后比较两个哈希值。
    这还具有使用超过 40 个字符的密码的额外好处。
    sha1 或 md5-hash 总是占用固定数量的空间，所以如果你走这条路，你不必将你的数据库列切换到 VARCHAR :)

# c# - 无法访问名为“ParkingWindow”的已处置对象

> ID：213691
> 
> 赞同：1
> 
> 时间：2008-10-17T20:15:54.390
> 
> 标签：c#, .net, winforms, .net-1.1

我在我的 .NET 1.1 C# Windows Forms 应用程序中间歇性地出错了。有人指出这是由于 1.1 框架中的一个错误，并建议将以下代码放入任何自定义控件中。

```
protected override void OnParentChanged(EventArgs e)
{
  if (this.Parent != null)
  {
    this.CreateParams.Parent = this.Parent.Handle;
    this.RecreateHandle();
  }
  base.OnParentChanged(e);
} 
```

有没有其他人发现这解决了他们的问题？任何人都可以提供一种方法来一致地重现错误，以便我可以在应用更改后验证它是否已修复？

如果有替代解决方案，我也对此持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T21:12:51.670

从标题看来，您的代码正试图访问一个已经处置的对象。如果您尝试访问托管引用字段，这可能会在终结器中发生。CLR 完成托管对象的顺序是不确定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T20:33:21.313

嘿，我不确定您的问题，因为我已经很久没有使用过 .NET 1.1，而且我不想说出显而易见的事实……但是是什么阻止了您迁移到 .NET 2.0 甚至 3.5？（请不要感到被冒犯，我其实很想知道）。

我可以理解 .NET 3.5 在某些情况下可能会更早，但 .NET 2.0 应该是一个安全的赌注，因为大多数用户要么通过 Windows 更新拥有它，要么如果他们使用的是 Vista，他们默认拥有它。

# sql - SQL Server 2005 以未知列数为中心

> ID：213702
> 
> 赞同：23
> 
> 时间：2008-10-17T20:19:56.817
> 
> 标签：sql, sql-server, pivot

我正在处理一组如下所示的数据。

> ```
> StudentName  | AssignmentName |  Grade
> ---------------------------------------
> StudentA     | Assignment 1   | 100
> StudentA     | Assignment 2   | 80
> StudentA     | Total          | 180
> StudentB     | Assignment 1   | 100
> StudentB     | Assignment 2   | 80
> StudentB     | Assignment 3   | 100
> StudentB     | Total          | 280 
> ```

分配的名称和数量是动态的，我需要得到与以下类似的结果。

> ```
> Student      | Assignment 1  | Assignment 2  | Assignment 3  | Total
> --------------------------------------------------------------------
> Student A    | 100           | 80            | null          | 180
> Student B    | 100           | 80            | 100           | 280 
> ```

现在理想情况下，我想根据可以包含/关联到每个作业的“到期日期”对列进行排序。如果可能，总数应该放在最后（如果可能，可以计算并从查询中删除。）

我知道如何使用 pivot 简单地命名列来完成 3 个作业，它试图以我还没有找到好的解决方案的动态方式来做。我正在尝试在 SQL Server 2005 上执行此操作

**编辑**

理想情况下，我想在不使用动态 SQL 的情况下实现这一点，因为这违反了政策。如果不可能……那么使用动态 SQL 的工作示例将起作用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T21:05:10.877

我知道你说没有动态`SQL`，但我看不出有什么办法可以直接做到这一点`SQL`。

[如果您在 sql 2005 中的Pivot Table and Concatenate Columns](https://stackoverflow.com/questions/159456/pivot-table-and-concatenate-columns-sql-problem#159803)和[PIVOT](https://stackoverflow.com/questions/198716/pivot-in-sql-2005#199763)查看我对类似问题的回答

那里的动态`SQL`不容易被注入，也没有充分的理由禁止它。另一种可能性（如果数据很少更改）是进行代码生成 - 而不是动态`SQL`，`SQL`定期生成到存储过程。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-21T14:33:10.840

对于`PIVOT`使用动态 sql 的数据，您可以在 SQL Server 2005+ 中使用以下代码：

**创建表：**

```
CREATE TABLE yourtable
    ([StudentName] varchar(8), [AssignmentName] varchar(12), [Grade] int)
;

INSERT INTO yourtable
    ([StudentName], [AssignmentName], [Grade])
VALUES
    ('StudentA', 'Assignment 1', 100),
    ('StudentA', 'Assignment 2', 80),
    ('StudentA', 'Total', 180),
    ('StudentB', 'Assignment 1', 100),
    ('StudentB', 'Assignment 2', 80),
    ('StudentB', 'Assignment 3', 100),
    ('StudentB', 'Total', 280)
; 
```

**动态枢轴：**

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(AssignmentName) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT StudentName, ' + @cols + ' from 
             (
                select StudentName, AssignmentName, grade
                from yourtable
            ) x
            pivot 
            (
                min(grade)
                for assignmentname in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/42b01/2)

结果是：

```
| STUDENTNAME | ASSIGNMENT 1 | ASSIGNMENT 2 | ASSIGNMENT 3 | TOTAL |
--------------------------------------------------------------------
|    StudentA |          100 |           80 |       (null) |   180 |
|    StudentB |          100 |           80 |          100 |   280 | 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T20:24:38.587

我发现这样做的唯一方法是使用动态 SQL 并将列标签放入变量中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:24:59.507

您可以查询 information_schema 以获取列名和类型，然后在构建结果集时将结果用作子查询。请注意，您可能需要稍微更改登录的访问权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T23:23:19.537

[这与sql 2005 中的 PIVOT](https://stackoverflow.com/questions/198716/pivot-in-sql-2005#198879)相同

如果此数据用于报告中的消费，您可以使用 SSRS 矩阵。它将从结果集中动态生成列。我已经用过很多次了——它对于动态交叉表报告非常有效。

这是一个带有动态 sql 的好例子。 [http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx](http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-25T11:07:25.777

```
SELECT TrnType
INTO #Temp1
FROM
(
    SELECT '[' + CAST(TransactionType AS VARCHAR(4)) + ']' AS TrnType FROM tblPaymentTransactionTypes
) AS tbl1

SELECT * FROM #Temp1

SELECT * FROM
(
    SELECT FirstName + ' ' + LastName AS Patient, TransactionType, ISNULL(PostedAmount, 0) AS PostedAmount
    FROM tblPaymentTransactions
            INNER JOIN emr_PatientDetails ON tblPaymentTransactions.PracticeID = emr_PatientDetails.PracticeId
            INNER JOIN tblPaymentTransactionDetails ON emr_PatientDetails.PatientId = tblPaymentTransactionDetails.PatientID
                        AND tblPaymentTransactions.TransactionID = tblPaymentTransactionDetails.TransactionID
    WHERE emr_PatientDetails.PracticeID = 152
) tbl
PIVOT (SUM(PostedAmount) FOR [TransactionType] IN (SELECT * FROM #Temp1)
) AS tbl4 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2010-02-05T13:55:31.060

```
select studentname,[Assign1],[Assign2],[Assign3],[Total] 
from 
(
 select studentname, assignname, grade from student
)s
pivot(sum(Grade) for assignname IN([Assign1],[Assign2],[Assign3],[Total])) as pvt 
```

# visual-studio - Visual Studio 2008 是否支持 Windows 98？

> ID：213711
> 
> 赞同：17
> 
> 时间：2008-10-17T20:23:18.417
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, windows-98

我们正在考虑从 Visual Studio 2005 升级到 Visual Studio 2008。我发现了以下令人不安的评论：

[http://msdn.microsoft.com/en-us/library/6sehtctf.aspx](http://msdn.microsoft.com/en-us/library/6sehtctf.aspx)

“从 Visual C++ 2008 开始，Visual C++ 不支持面向 Windows 95、Windows 98、Windows ME 或 Windows NT。”

这是否意味着如果我们用 Visual C++ 2008 重建我们的产品，它们将停止在 Windows 98 机器上工作？听起来很像，但我很难相信他们会做出如此大的改变。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T20:30:19.167

这不仅仅是关于 .NET 3.5。它是关于由 WINVER 中的强制版本碰撞引入的 Windows SDK 头文件宏和定义。所以是的，Colen，Visual C++ 2008 二进制文件将只针对 Windows NT API，虽然它们有时可能在 98 上工作，但您应该假设您不能使用 Visual Studio 2008 来针对 Win9x。您必须使用 VS2005 或更早版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T06:43:01.257

是的，这确实意味着：2000 年之前的 Windows NT 和所有 Windows（95,98 AND ME）上的 Windows CreateProcess 和 LoadLibrary API 将不会加载由 VS9 生成的 DLL 或 EXE 文件，因为文件中的 PE 标头具有所需的操作系统版本字段设置为 5。

尝试加载 VS9 生成的 exe 文件时的错误消息（是一个非常不友好的模式错误对话框）实际上会说“您需要升级操作系统才能运行此程序”。

我尝试将字段编辑为 4 - 将加载二进制文件，但任何使用 VS9 c-runtime 都会挂起或使进程崩溃。有一些方法可以让 VS9 项目不使用它们的原生 c 运行时，但如果大量使用 c++ 特性对您很重要，那么这种方法不会扩展到小型应用程序。

VS8 / VS2005 具有 VS9 的大部分功能，但仍然针对早期的操作系统版本，这就是为什么在我的商店我们暂时坚持使用它的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T20:45:18.870

他们的新产品不支持旧版本的操作系统是很自然的。这将使他们花费更多（不仅是金钱成本，而且使提供一些更新的有用功能变得更加困难或不可能）以使事情在旧系统的限制（通常是错误）下工作。这种情况一直在发生，而且发生在每个人身上；新版本的 gcc 放弃了对较旧的不太流行的架构的支持；glibc 的新版本需要更新的最低内核版本；等等。

这些操作系统早已退役；从微软的角度来看，没有人应该再使用它们了。如果您仍想为他们开发，您可以使用相同年份的旧工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T20:27:21.387

根据以下链接，.NET 3.5 不支持 Windows 98，所以我想这就是他们的意思。您仍然可以进行 .NET 2.0 及更低版本的开发，但如果您使用 3.5 库，则不支持 Windows 98。

[.NET 3.5 信息](http://www.microsoft.com/downloads/details.aspx?FamilyId=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T20:27:52.480

此时，3.5 Framework 甚至不会安装在 Windows 2000 Server 上。所以我不相信他们会在 95、98 或 NT 上。Microsoft 不想再承担支持这些退役操作系统的责任。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T21:01:55.670

我建议您以此为**契机**停止支持 Windows 9x。这是一个很好的理由。而且，至少如果您正在为 Win32 API 编写 C/C++ 代码，如果您可以假设目标操作系统是 Windows 2000 或更高版本，那么生活会容易**得多。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T23:52:43.173

虽然我同意 JesperE，但 Windows 98 的用户比例如此之小，以他们为目标毫无意义，除非您当然知道您的大部分客户实际上正在使用 Windows98。

无论如何，您实际上可以在 Visual Studio 2008 中以 Windows 98 为目标（您不能在 Windows 98 上进行开发）。但是，您的项目必须仅针对 .NET 2.0，不能使用任何 3.0 或 3.5 功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-18T20:40:09.457

据我[了解](https://www.vogons.org/viewtopic.php?t=58393#p648616)，使用最新的[KernelEx](https://msfn.org/board/topic/175276-kernelex-unified-topics-links-index-thread/) ，所有针对 XP 的 MSVC 版本都可能正常工作（结果取决于您将决定使用多少“最新”功能/特性）

至于 2008 年的答案可能是什么，当时甚至有相当多的[补丁库](https://www.htasoft.com/w98se_post_usp4/vc_r_9x.txt)（如果它们被破坏，请检查[Wayback Machine上的链接）。](https://web.archive.org/)

# visual-studio - 如何在与 Web 项目相同的目录中创建 Visual Studio 解决方案文件 (.sln)？

> ID：213719
> 
> 赞同：18
> 
> 时间：2008-10-17T20:26:15.913
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005, projects-and-solutions

我正在使用 VisualSVN 客户端和服务器，Web 项目按预期工作的要求之一是将 .sln 与其他文件放在同一目录（根目录）中。

我认为这就像删除所有额外的父路径 ../ 和其他相对路径并保存它一样简单。但是，当我尝试打开它时，它只会锁定 Visual Studio。

是否有创建此类解决方案文件的标准方法或解决方案文件工具来帮助确保其有效？还是我只是错过了一些非常明显的东西？

```
/
/MyWebsite.org.sln
/Images
/App_Data
/default.aspx
/default.aspx.cs 
```

显然，至少我正在寻找的诀窍是您必须使用 ..\MyWebsite.org 或任何包含网站文件的文件夹。

[编辑] 我学到的东西和我为这个特定项目的最终 .sln 文件：

这是允许我打开网站并将 .sln 放在 web 文件夹的根目录中的最终解决方案文件。

```
Project("{E24C65DC-7377-472B-9ABA-BCSG3B73C61A}") = "MyWebsite.org", "\", "{F8F4E96F-40BF-4374-B8BA-968D0SGG4A9E}"
    ProjectSection(WebsiteProperties) = preProject
        TargetFramework = "3.5"
        Debug.AspNetCompiler.VirtualPath = "/MyWebsite.org"
        Debug.AspNetCompiler.PhysicalPath = "..\MyWebsite.org\"
        Debug.AspNetCompiler.TargetPath = "PrecompiledWeb\MyWebsite.org\"
        Debug.AspNetCompiler.Updateable = "true"
        Debug.AspNetCompiler.ForceOverwrite = "true"
        Debug.AspNetCompiler.FixedNames = "false"
        Debug.AspNetCompiler.Debug = "True"
        Release.AspNetCompiler.VirtualPath = "/MyWebsite.org"
        Release.AspNetCompiler.PhysicalPath = "..\MyWebsite.org\"
        Release.AspNetCompiler.TargetPath = "PrecompiledWeb\MyWebsite.org\"
        Release.AspNetCompiler.Updateable = "true"
        Release.AspNetCompiler.ForceOverwrite = "true"
        Release.AspNetCompiler.FixedNames = "false"
        Release.AspNetCompiler.Debug = "False"
        VWDPort = "1603"
        VWDDynamicPort = "false"
        VWDVirtualPath = "/"
    EndProjectSection
EndProject 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-17T20:34:57.847

通常我所做的是从一个空白解决方案开始，它位于“新项目”对话框中的“其他项目类型 - > Visual Studio 解决方案”下。然后，将网站和您需要的任何其他项目添加到解决方案中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-17T20:35:25.287

另一个选项是当您创建项目时，只需取消选中“为解决方案创建目录”的默认框

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-17T20:33:39.410

以下步骤应该有效。

1.  做一个空白的解决方案，里面什么都没有。
2.  将解决方案移动到您希望 Web 项目所在的位置。
3.  打开解决方案。
4.  在所需区域创建 Web 项目。

我经常做这种移动，以便项目可以很好地放在 svn 中。不要忘记 svn:ignore *.suo 文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-13T19:19:05.080

转到工具->选项->项目和解决方案，然后检查始终显示解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T20:42:48.220

创建解决方案，关闭它，将文件放在您想要的位置，然后编辑 sln.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-16T19:55:39.720

我找不到我的项目的解决方案文件。我能够在项目中没有 .sln 的机器上运行该项目。它在我创建它的机器上工作的原因是我将我的 VS 项目保存在 C:\Dev\Projects 下，但 Visual Studio 保留了它的 .sln 文件 c:\users\xyz\documents\VisualStudio2015\projects 目录。当我将文件移动到新计算机时，.sln 不在同一目录中。我刚刚在 c:\users\xyz\documents\VisualStudio2015\projects 目录中的旧计算机中找到了该项目，并将其移至我的新计算机。我相信我可以通过更改工具->选项->项目和解决方案部分来避免这种情况

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-24T09:48:12.737

从 asp.net 中的现有文件重新创建项目

将现有文件复制到某个位置，例如。F:\Copy_webSite

打开 Visual Studio > 文件 > 新网站。

[在此处输入图像描述][1] 选择您复制文件的文件夹 [在此处输入图像描述][2]

会提示“网站已存在”选择“打开现有网站”</p>

系统将在文件夹 C:\Users\user\Documents\Visual Studio 2005\Projects\WebSite [在此处输入图像描述][3] 中创建 .sln 文件

系统将打开当前项目。您还可以将 .sln 文件复制到当前项目的同一文件夹中。它将在文件夹中打开项目

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-26T23:06:58.197

在错误的操作系统安装导致分区损坏并不得不恢复数据后，只需要这样做。几个月后，我需要更改代码，但 .sln 文件不见了。

使用 Visual Studio 2015 转到新建 -> 网站 -> 选择需要新 .sln 文件的网站的根目录 -> 下一步 -> 它将要求在目录中创建新站点或在目录中打开网站，显然选择后者。打开零错误没有问题，而且做起来甚至很快->保存项目，你很高兴。

奥卡姆剃刀！

# vim - 是否有一个插件——omnicomplete 或其他——会建议导入 python 模块？

> ID：213729
> 
> 赞同：1
> 
> 时间：2008-10-17T20:28:38.657
> 
> 标签：vim, omnicomplete

例如：

```
from datetime import <c-x><c-o>{list of modules inside datetime package} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T20:38:31.333

我认为现在唯一声称支持它的插件是[pysmell](http://orestis.gr/blog/2008/10/13/pysmell-v06-released/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T22:19:52.563

我使用[pydiction](http://www.vim.org/scripts/script.php?script_id=850)对 python 模块进行全补全。

# java - 在数据库中存储数组

> ID：213735
> 
> 赞同：11
> 
> 时间：2008-10-17T20:31:54.920
> 
> 标签：java, database, hsqldb

在数据库中存储大型数组（10000x100）的最有效方法是什么，比如 hsqldb？我需要为我用 java 编写的某个数学程序执行此操作。请帮忙。将经常检索和存储整个数组（而不是单独的元素）。此外，需要存储有关数组的一些元数据。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T20:38:33.800

好问题。

除非您想将数组转换为一组规范化表（听起来您不想这样做），否则您可能需要考虑序列化。

序列化是一个花哨的词，用于将对象转换为可以保存到磁盘或数据库的某种格式。序列化的两种主要格式是二进制和 XML，我敢打赌 Java 对它有一些支持。

根据您使用的数据类型，您应该能够将数组转换为 XML 或二进制，然后将其保存到数据库中的单个字段中。您可以通过查看[http://java.sun.com/developer/technicalArticles/Programming/serialization/](http://java.sun.com/developer/technicalArticles/Programming/serialization/)在 Java 中开始使用这种技术。我知道它内置于 .NET 中。

希望这会有所帮助。让我知道我是否可以给你更多的方向。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T20:47:22.657

如何将数据存储为 BLOB 并使用 Java 将 BLOB 解码为实际的 Java 数组？在一次 gulp 中存储和检索整个数组会更有效，但对于摆弄单个元素来说会很糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T20:50:20.983

提出一种内部表示形式——无论是 XML、JSON、您自己提出的一些二进制文件，还是任何其他形式的序列化。

使用“blob”数据类型将其存储在表中。将与矩阵关联的任何元数据存储在附加列中。

我强烈不同意这样做的方法是创建一个与矩阵具有相同行数和列数的表——这是为你不使用的功能付出的高昂代价。

事先准备好你的插入/选择语句，并使用绑定变量来改变你正在使用的矩阵——不要让数据库重新解析每个请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T22:05:19.163

如果它只有 1 个数组，为什么不使用二进制文件？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T22:51:52.843

正如已经建议的那样：如果您不需要这些功能，请不要使用 RDBMS。尽管您可能想要考虑像[JDBM](http://jdbm.sourceforge.net/)这样的低级 API，而不是序列化，它提供了一些类似数据库的功能，例如管理磁盘索引。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-18T04:02:17.257

如果您的数据密集（值直方图接近平线），您最好的选择是使用 Object[Output/Input]Stream 进行 blob 和序列化。

否则，您可能会发现使用稀疏数组和实体-属性-值模式的变体更有效。这是一个例子：

```
 Name | IndexKey  | Value
------+-----------+-------
 foo  | 'default' | 39        
 foo  | 0:0:0     | 23
 foo  | 0:0:1     | 34
 foo  | 1:5:0     | 12
 ...
 bar  | 1:3:8     | 20
 bar  | 1:3:8     | 23
 bar  | 1:1:1     | 24
 bar  | 3:0:6     | 54
 ... 
```

这还允许您快速更新表的某些部分并使用 SQL 'like' 运算符选择切片。

如果您的维数是固定的，将键列分解为每个维的 int 列，以提高索引效率并具有更灵活的选择标准（您可以将第一个索引“null”用于元数据，如默认值） .

在任何情况下，最好在 Name,IndexKey 列上创建聚集索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T20:35:10.653

使用您的数组保存的数据定义一个表，并将数组值插入到表中。

这是非常简单的数据访问/存储。你的数组尺寸总是一样的吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T20:36:18.670

*   在一个大的显式事务中执行它。不要强制数据库系统为每个插入创建一个新的隐式事务。
*   使用准备好的语句。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T20:48:29.177

PostgreSQL 内置了对数组的支持。

[http://www.postgresql.org/docs/8.0/interactive/arrays.html](http://www.postgresql.org/docs/8.0/interactive/arrays.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-18T06:35:15.763

Java 序列化到存储为 BLOB 的字节数组将是您最好的选择。Java 将非常有效地序列化一个大数组。将其余的行列用于您有兴趣查询或轻松显示的任何内容。如果您大量查询和报告非 BLOB 数据，将 BLOB 保存在自己的表中并让“常规”行指向“BLOB”行也是一个好主意（尽管这可能因数据库实现而异）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-03T12:45:28.710

HSQLDB 2.0 支持将一维数组存储为表的列。所以表格的每一行将对应二维数组的一行。

但是如果你想检索一个整体的二维数组，BLOB 是最好的解决方案。

# html - Internet Explorer 中的渐变颜色

> ID：213750
> 
> 赞同：49
> 
> 时间：2008-10-17T20:35:35.723
> 
> 标签：html, css, internet-explorer, background, gradient

我知道 Internet Explorer 有一些专有扩展，因此您可以执行诸如创建具有渐变背景的 div 之类的操作。我不记得元素名称或它的用法。有没有人有一些例子或链接？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2010-06-18T13:09:21.927

我用于所有浏览器渐变的代码：

```
background: #0A284B;
background: -webkit-gradient(linear, left top, left bottom, from(#0A284B), to(#135887));
background: -webkit-linear-gradient(#0A284B, #135887);
background: -moz-linear-gradient(top, #0A284B, #135887);
background: -ms-linear-gradient(#0A284B, #135887);
background: -o-linear-gradient(#0A284B, #135887);
background: linear-gradient(#0A284B, #135887);
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#0A284B', endColorstr='#135887');
zoom: 1; 
```

您需要指定一个高度或`zoom: 1`应用`hasLayout`到该元素才能在 IE 中工作。

* * *

**更新：**

这是一个 LESS Mixin (CSS) 版本，供所有 LESS 用户使用：

```
.gradient(@start, @end) {
    background: mix(@start, @end, 50%);
    filter: ~"progid:DXImageTransform.Microsoft.gradient(startColorStr="@start~", EndColorStr="@end~")";
    background: -webkit-gradient(linear, left top, left bottom, from(@start), to(@end));
    background: -webkit-linear-gradient(@start, @end);
    background: -moz-linear-gradient(top, @start, @end);
    background: -ms-linear-gradient(@start, @end);
    background: -o-linear-gradient(@start, @end);
    background: linear-gradient(@start, @end);
    zoom: 1;
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-17T20:37:26.500

看看 IE 可以处理的自定义 CSS 过滤器 [http://msdn.microsoft.com/en-us/library/ms532847.aspx](http://msdn.microsoft.com/en-us/library/ms532847.aspx)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-28T02:26:07.843

该`filter`样式应该适用于 IE8 和 IE9。

```
.gradientClass
{
  filter:  progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#e6e6e6', endColorstr='#CCCCCC');       
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-12-20T01:01:12.210

当谈到 IE 中的渐变时，一个重要的问题是虽然你可以使用微软的过滤器......

```
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FCCA6D', endColorstr='#FEFEFE');
zoom:1; 
```

...他们杀死渐变覆盖的任何文本上的**清晰类型。**考虑到渐变的目的通常是让 UI 看起来更好，这对我来说是一个阻碍。

所以对于 IE，我使用重复的背景图像。如果背景图像 css 与其他浏览器的渐变 CSS 结合使用（根据 Blowsie 的回答），其他浏览器将忽略背景图像而支持渐变 css，因此它最终只会应用于 IE。

```
background-image: url('/Content/Images/button-gradient.png'); 
```

有很多网站可以用来快速生成渐变背景；我用[这个](http://tools.dynamicdrive.com/gradient/)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-27T13:28:07.113

来自 Microsoft 的出色工具，可让您实时检查颜色并为所有浏览器生成 CSS：http: [//ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html](http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html)

```
/* IE10 */ 
background-image: -ms-linear-gradient(top, #FFFFFF 0%, #B7B8BD 300%);

/* Mozilla Firefox */ 
background-image: -moz-linear-gradient(top, #FFFFFF 0%, #B7B8BD 300%);

/* Opera */ 
background-image: -o-linear-gradient(top, #FFFFFF 0%, #B7B8BD 300%);

/* Webkit (Safari/Chrome 10) */ 
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #FFFFFF), color-stop(3, #B7B8BD));

/* Webkit (Chrome 11+) */ 
background-image: -webkit-linear-gradient(top, #FFFFFF 0%, #B7B8BD 300%);

/* Proposed W3C Markup */ 
background-image: linear-gradient(top, #FFFFFF 0%, #B7B8BD 300%); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-03-23T11:04:13.310

只是想我会添加这个有用的链接： [http ://css3please.com/](http://css3please.com/)

展示如何让渐变在所有浏览器中工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-07-15T16:50:35.830

请注意，IE10 将支持如下渐变：

```
background: -ms-linear-gradient(#017ac1, #00bcdf); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-17T20:40:19.117

来自 ScriptFX.com[文章](http://www.scriptfx.com/transitions/gradient/gradient_filter.htm)：

```
<body bgcolor="#000000" topmargin="0" leftmargin="0">

    <div style="width:100%;height:100%; filter: progid:
        DXImageTransform.Microsoft.Gradient (GradientType=1,
        StartColorStr='#FF006600', EndColorStr='#ff456789')">

Your page content goes in here ...... at the end of all the page content, you must close the <div> tag, immediately before the closing <body> tag.... as below

    </div>
</body> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-06-30T15:57:00.153

试试这个：

```
.red {
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#e02a42', endColorstr='#a91903', GradientType=0); /* IE6-9 */
    height: 0; /* gain layout IE5+ */   
    zoom: 1; /* gain layout IE7+ */
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-06T15:45:26.733

我在与 IE 9 渐变作斗争时发现了两件事。

1.  对`-ms-filter`我不起作用。我不得不简单地使用`filter`.
2.  我必须将`height: 100%`IE 添加到我的班级才能使用渐变。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-13T14:48:43.027

就我而言，我将其插入标题部分

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

然后在样式部分插入它

```
filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#49708f', endColorstr='#293f50');
zoom: 1; 
```

# c++ - 模板模板参数有哪些用途？

> ID：213761
> 
> 赞同：285
> 
> 时间：2008-10-17T20:38:57.573
> 
> 标签：c++, templates, template-templates

我见过一些使用模板模板参数（即以模板作为参数的模板）进行基于策略的类设计的 C++ 示例。这种技术还有什么其他用途？

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2008-10-17T20:51:02.213

我认为您需要使用模板模板语法来传递一个参数，其类型是一个依赖于另一个模板的模板，如下所示：

```
template <template<class> class H, class S>
void f(const H<S> &value) {
} 
```

这里，`H`是一个模板，但我希望这个函数能够处理`H`.

**注意**：我已经编写 c++ 多年，并且只需要一次。我发现这是一个很少需要的功能（当你需要它时当然很方便！）。

我一直在努力想出好的例子，老实说，大多数时候这不是必需的，但让我们设计一个例子。让我们假设`std::vector` *没有*`typedef value_type`.

那么如何编写一个函数来为向量元素创建正确类型的变量呢？这会奏效。

```
template <template<class, class> class V, class T, class A>
void f(V<T, A> &v) {
    // This can be "typename V<T, A>::value_type",
    // but we are pretending we don't have it

    T temp = v.back();
    v.pop_back();
    // Do some work on temp

    std::cout << temp << std::endl;
} 
```

**注意**：`std::vector`有两个模板参数，类型和分配器，所以我们必须接受它们。幸运的是，由于类型推导，我们不需要显式写出确切的类型。

您可以像这样使用它：

```
f<std::vector, int>(v); // v is of type std::vector<int> using any allocator 
```

或者更好的是，我们可以使用：

```
f(v); // everything is deduced, f can deal with a vector of any type! 
```

**更新**：即使是这个人为的例子，虽然是说明性的，但由于 c++11 引入了`auto`. 现在同样的函数可以写成：

```
template <class Cont>
void f(Cont &v) {

    auto temp = v.back();
    v.pop_back();
    // Do some work on temp

    std::cout << temp << std::endl;
} 
```

这就是我更喜欢编写这种类型的代码的方式。

* * *

## 回答 #2

> 赞同：179
> 
> 时间：2013-01-14T02:44:19.563

实际上，模板模板参数的用例是相当明显的。一旦您了解到 C++ stdlib 存在未为标准容器类型定义流输出运算符的巨大漏洞，您将继续编写如下内容：

```
template<typename T>
static inline std::ostream& operator<<(std::ostream& out, std::list<T> const& v)
{
    out << '[';
    if (!v.empty()) {
        for (typename std::list<T>::const_iterator i = v.begin(); ;) {
            out << *i;
            if (++i == v.end())
                break;
            out << ", ";
        }
    }
    out << ']';
    return out;
} 
```

然后你会发现 vector 的代码是一样的，因为 forward_list 是一样的，实际上，即使对于多种地图类型，它仍然是一样的。这些模板类除了元接口/协议之外没有任何共同点，并且使用模板模板参数可以捕获所有它们的共性。不过，在继续编写模板之前，有必要检查参考以回忆序列容器接受 2 个模板参数 - 用于值类型和分配器。虽然分配器是默认的，但我们仍然应该在模板操作符<< 中说明它的存在：

```
template<template <typename, typename> class Container, class V, class A>
std::ostream& operator<<(std::ostream& out, Container<V, A> const& v)
... 
```

瞧，这将自动适用于所有当前和未来遵循标准协议的序列容器。要将地图添加到组合中，需要查看参考以注意它们接受 4 个模板参数，因此我们需要另一个版本的 operator<< 上面带有 4-arg 模板模板参数。我们还会看到 std:pair 尝试使用 2-arg operator<< 来呈现我们之前定义的序列类型，因此我们将为 std::pair 提供专门化。

顺便说一句，使用允许可变参数模板的 C+11（因此应该允许可变参数模板模板参数），可以使用单个 operator<< 来统治它们。例如：

```
#include <iostream>
#include <vector>
#include <deque>
#include <list>

template<typename T, template<class,class...> class C, class... Args>
std::ostream& operator <<(std::ostream& os, const C<T,Args...>& objs)
{
    os << __PRETTY_FUNCTION__ << '\n';
    for (auto const& obj : objs)
        os << obj << ' ';
    return os;
}

int main()
{
    std::vector<float> vf { 1.1, 2.2, 3.3, 4.4 };
    std::cout << vf << '\n';

    std::list<char> lc { 'a', 'b', 'c', 'd' };
    std::cout << lc << '\n';

    std::deque<int> di { 1, 2, 3, 4 };
    std::cout << di << '\n';

    return 0;
} 
```

**输出**

```
std::ostream &operator<<(std::ostream &, const C<T, Args...> &) [T = float, C = vector, Args = <std::__1::allocator<float>>]
1.1 2.2 3.3 4.4 
std::ostream &operator<<(std::ostream &, const C<T, Args...> &) [T = char, C = list, Args = <std::__1::allocator<char>>]
a b c d 
std::ostream &operator<<(std::ostream &, const C<T, Args...> &) [T = int, C = deque, Args = <std::__1::allocator<int>>]
1 2 3 4 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2008-10-18T11:03:51.510

下面是取自Andrei Alexandrescu[的“现代 C++ 设计 - 应用的通用编程和设计模式”的一个简单示例：](https://rads.stackoverflow.com/amzn/click/com/0201704315)

他使用带有模板模板参数的类来实现策略模式：

```
// Library code
template <template <class> class CreationPolicy>
class WidgetManager : public CreationPolicy<Widget>
{
   ...
}; 
```

他解释说： *通常，主机类已经知道或可以轻松推断出策略类的模板参数。在上面的例子中，WidgetManager 总是管理 Widget 类型的对象，因此要求用户在 CreationPolicy 的实例化中再次指定 Widget 是多余的，并且有潜在的危险。在这种情况下，库代码可以使用模板模板参数来指定策略。*

效果是客户端代码可以以更优雅的方式使用“WidgetManager”：

```
typedef WidgetManager<MyCreationPolicy> MyWidgetMgr; 
```

而不是缺少模板模板参数的定义需要的更麻烦且容易出错的方式：

```
typedef WidgetManager< MyCreationPolicy<Widget> > MyWidgetMgr; 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-07-17T19:13:15.827

[这是我的CUDA 卷积神经网络库](https://github.com/sirotenko/cudacnn)中的另一个实际示例。我有以下类模板：

```
template <class T> class Tensor 
```

这实际上是实现 n 维矩阵操作。还有一个子类模板：

```
template <class T> class TensorGPU : public Tensor<T> 
```

它实现了相同的功能，但在 GPU 中。这两个模板都可以使用所有基本类型，例如 float、double、int 等。我还有一个类模板（简化版）：

```
template <template <class> class TT, class T> class CLayerT: public Layer<TT<T> >
{
    TT<T> weights;
    TT<T> inputs;
    TT<int> connection_matrix;
} 
```

这里有模板模板语法的原因是因为我可以声明类的实现

```
class CLayerCuda: public CLayerT<TensorGPU, float> 
```

它将在 GPU 上同时具有浮点类型的权重和输入，但 connection_matrix 将始终为 int，无论是在 CPU 上（通过指定 TT = Tensor）还是在 GPU 上（通过指定 TT=TensorGPU）。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-10-09T18:47:52.477

假设您正在使用 CRTP 为一组子模板提供“接口”；并且父母和孩子在其他模板参数中都是参数化的：

```
template <typename DERIVED, typename VALUE> class interface {
    void do_something(VALUE v) {
        static_cast<DERIVED*>(this)->do_something(v);
    }
};

template <typename VALUE> class derived : public interface<derived, VALUE> {
    void do_something(VALUE v) { ... }
};

typedef interface<derived<int>, int> derived_t; 
```

注意'int'的重复，它实际上是为两个模板指定的相同类型参数。您可以使用 DERIVED 的模板模板来避免这种重复：

```
template <template <typename> class DERIVED, typename VALUE> class interface {
    void do_something(VALUE v) {
        static_cast<DERIVED<VALUE>*>(this)->do_something(v);
    }
};

template <typename VALUE> class derived : public interface<derived, VALUE> {
    void do_something(VALUE v) { ... }
};

typedef interface<derived, int> derived_t; 
```

请注意，您正在消除直接向*派生*模板提供其他模板参数；“接口”仍然接收它们。

这还允许您在“接口”中构建依赖于类型参数的 typedef，这些参数可以从派生模板中访问。

上面的 typedef 不起作用，因为您不能 typedef 到未指定的模板。但是，这可行（并且 C++11 对模板类型定义具有本机支持）：

```
template <typename VALUE>
struct derived_interface_type {
    typedef typename interface<derived, VALUE> type;
};

typedef typename derived_interface_type<int>::type derived_t; 
```

不幸的是，对于派生模板的每个实例化，您都需要一个 derived_interface_type，除非我还没有学到另一个技巧。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-05-29T10:17:45.507

这就是我遇到的：

```
template<class A>
class B
{
  A& a;
};

template<class B>
class A
{
  B b;
};

class AInstance : A<B<A<B<A<B<A<B<... (oh oh)>>>>>>>>
{

}; 
```

可解决为：

```
template<class A>
class B
{
  A& a;
};

template< template<class> class B>
class A
{
  B<A> b;
};

class AInstance : A<B> //happy
{

}; 
```

或（工作代码）：

```
template<class A>
class B
{
public:
    A* a;
    int GetInt() { return a->dummy; }
};

template< template<class> class B>
class A
{
public:
    A() : dummy(3) { b.a = this; }
    B<A> b;
    int dummy;
};

class AInstance : public A<B> //happy
{
public:
    void Print() { std::cout << b.GetInt(); }
};

int main()
{
    std::cout << "hello";
    AInstance test;
    test.Print();
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-05-19T23:13:57.500

这是我刚刚使用的东西的概括。我发布它是因为它是一个*非常*简单的示例，它演示了一个实际用例以及默认参数：

```
#include <vector>

template <class T> class Alloc final { /*...*/ };

template <template <class T> class allocator=Alloc> class MyClass final {
  public:
    std::vector<short,allocator<short>> field0;
    std::vector<float,allocator<float>> field1;
}; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-02-19T01:52:44.753

在 pfalcon 提供的具有可变参数模板的解决方案中，由于可变参数专业化的贪婪特性，我发现实际上很难将 ostream 运算符专门用于 std::map。这是一个对我有用的轻微修改：

```
#include <iostream>
#include <vector>
#include <deque>
#include <list>
#include <map>

namespace containerdisplay
{
  template<typename T, template<class,class...> class C, class... Args>
  std::ostream& operator <<(std::ostream& os, const C<T,Args...>& objs)
  {
    std::cout << __PRETTY_FUNCTION__ << '\n';
    for (auto const& obj : objs)
      os << obj << ' ';
    return os;
  }  
}

template< typename K, typename V>
std::ostream& operator << ( std::ostream& os, 
                const std::map< K, V > & objs )
{  

  std::cout << __PRETTY_FUNCTION__ << '\n';
  for( auto& obj : objs )
  {    
    os << obj.first << ": " << obj.second << std::endl;
  }

  return os;
}

int main()
{

  {
    using namespace containerdisplay;
    std::vector<float> vf { 1.1, 2.2, 3.3, 4.4 };
    std::cout << vf << '\n';

    std::list<char> lc { 'a', 'b', 'c', 'd' };
    std::cout << lc << '\n';

    std::deque<int> di { 1, 2, 3, 4 };
    std::cout << di << '\n';
  }

  std::map< std::string, std::string > m1 
  {
      { "foo", "bar" },
      { "baz", "boo" }
  };

  std::cout << m1 << std::endl;

    return 0;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-08-30T18:35:21.500

它提高了代码的可读性，提供了额外的类型安全性并节省了一些编译器工作。

假设你想打印一个容器的每个元素，你可以使用下面的代码没有模板模板参数

```
template <typename T> void print_container(const T& c)
{
    for (const auto& v : c)
    {
        std::cout << v << ' ';
    }
    std::cout << '\n';
} 
```

或使用模板模板参数

```
template< template<typename, typename> class ContainerType, typename ValueType, typename AllocType>
void print_container(const ContainerType<ValueType, AllocType>& c)
{
    for (const auto& v : c)
    {
        std::cout << v << ' ';
    }
    std::cout << '\n';
} 
```

假设你传入一个整数 say `print_container(3)`。对于前一种情况，模板将由编译器实例化，编译器会抱怨`c`在 for 循环中的使用，后者根本不会实例化模板，因为找不到匹配的类型。

一般来说，如果你的模板类/函数是设计用来处理模板类作为模板参数的，最好说清楚。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-09-29T17:27:04.700

我将它用于版本化类型。

如果您有一个通过模板版本化的类型，例如`MyType<version>`，您可以编写一个函数来捕获版本号：

```
template<template<uint8_t> T, uint8_t Version>
Foo(const T<Version>& obj)
{
    assert(Version > 2 && "Versions older than 2 are no longer handled");
    ...
    switch (Version)
    {
    ...
    }
} 
```

因此，您可以根据传入的类型的版本做不同的事情，而不是为每种类型都重载。您还可以具有以通用方式接收`MyType<Version>`和返回的转换函数`MyType<Version+1>`，甚至递归它们以具有`ToNewest()`从任何旧版本返回类型的最新版本的函数（对于可能已经存储一段时间的日志非常有用但需要用今天最新的工具处理）。

# asp.net-mvc - ASP.NET MVC 运行 IIS7 部署问题

> ID：213774
> 
> 赞同：6
> 
> 时间：2008-10-17T20:41:51.500
> 
> 标签：asp.net-mvc, iis-7

我在将 ASP.NET MVC 应用程序部署到 IIS7 时遇到问题。

我有一个使用 ASP.NET MVC Beta 1 创建的 MVC 项目。它只包含未修改的默认模板。

该应用程序在 VS2008 中运行良好，但是当我将其发布到本地 IIS7 网站 ( [http://localhost](http://localhost) ) 时，出现以下服务器错误：

> 传入的请求不匹配任何路由

我也尝试访问[http://localhost/Home/About](http://localhost/Home/About)（到模板中特定页面的路由），但未成功。这将返回 404 错误。

我已经在 IIS 中重新创建了几次网站，并确保管道模式设置为集成。我的 IIS7 服务器在我的 Vista Home Premium 机器上运行。

我假设这是一个 IIS 配置问题，任何有关 ASP.NET MVC 应用程序配置问题的建议都将不胜感激。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T10:28:14.073

[http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)

这解决了我所有的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-19T17:23:14.473

Does IIS run ok with the default IIS7 site?

Are you receiving any Event Viewer messages?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T09:02:16.717

IIS 是否处于集成模式？如果不是，您必须进行一些设置或将其更改为集成模式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T04:57:09.683

您需要安装这些软件要求：

*   AspNetMVC3ToolsUpdateSetup
*   wpilauncher_3_10（选择：应用程序请求路由 2.5）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-05T10:04:27.933

请确保您在 IIS 7.0 集成模式下运行。如果您需要在 IIS 7.0 经典模式下运行它，您需要执行几个操作以使路由工作。请参考以下博客文章；

[http://www.tugberkugurlu.com/archive/running-asp-net-mvc-under-iis-6-0-and-iis-7-0-classic-mode---solution-to-routing-problem](http://www.tugberkugurlu.com/47)

[http://www.tugberkugurlu.com/archive/deployment-of-asp-net-mvc-3-rc-2-application-on-a-shared-hosting-environment-without-begging-the-hosting-company](http://www.tugberkugurlu.com/39)

# asp.net - 在我的代码隐藏类中，如何检索授权角色？

> ID：213784
> 
> 赞同：6
> 
> 时间：2008-10-17T20:44:00.077
> 
> 标签：asp.net, web-config, roles

我的 web.config 中有以下内容：

```
<location path="RestrictedPage.aspx">
    <system.web>
        <authorization>
            <allow roles="Group1Admin, Group3Admin, Group7Admin"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location> 
```

在 RestrictedPage.aspx.cs 中，如何检索包含 Group1Admin、Group3Admin 和 Group7Admin 的允许角色集合？

这就是我问的原因：

web.config 正在处理对页面的授权。这很好用。但我将有几个这样的页面（比如 RestrictedPage.aspx、RestrictedPage2.aspx、RestrictedPage3.aspx）。这些页面中的每一个都将有我的自定义 web 控件。这些页面中的每一个都将具有不同的允许角色。我的 webcontrol 有一个下拉列表。下拉列表中的选择取决于用户角色和页面允许角色的交集。

如下所述，使用 XPath 搜索 web.config 可能会起作用。我只是希望有更多的框架-y。有点像站点地图。当我将角色放入我的 web.sitemap 时，我可以使用 SiteMap.CurrentNode.Roles 来获取它们（我的网站使用 Windows 身份验证，所以我不能使用 web.sitemap 进行安全调整，我宁愿只保留一个角色文件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T00:27:24.850

```
// set the configuration path to your config file
string configPath = "??";

Configuration config = WebConfigurationManager.OpenWebConfiguration(configPath);

// Get the object related to the <identity> section.
AuthorizationSection section = (AuthorizationSection)config.GetSection("system.web/authorization"); 
```

从 section 对象获取 AuthorizationRuleCollection 对象，然后您可以在其中提取角色。

注意：您可能需要稍微修改该部分的路径，因为您从“location path="RestrictedPage.aspx"" 开始，我没有尝试这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T20:53:05.563

```
if {User.IsInRole("Group1Admin"){//do stuff} 
```

那是你问的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T20:57:31.733

我不确定，但我原以为会在您的页面被处理之前进行检查，因此如果用户不是某个角色，他们将永远无法访问您的页面。这最终会使页面中这种冗余的可见性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T21:05:28.487

我相信有更好的方法来读取这些信息，但这里有一种方法可以让您从 web.config 文件中读取允许值。

```
XmlDocument webConfigReader = new XmlDocument(); 
webConfigReader.Load(Server.MapPath("web.config")); 

XmlNodeList root = webConfigReader.SelectNodes("//location[@path="RestrictedPage.aspx"]//allow//@roles"); 

foreach (XmlNode node in root) 
{ 
     Response.Write(node.Value); 
} 
```

当然，ASP.NET 角色提供程序会为您处理此问题，因此只有当您计划在授权用户旁边的代码隐藏中对它们进行某些操作时，读取这些值才真正相关，您可能正在这样做。

希望这会有所帮助——您可能必须使用 , 字符来拆分结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:58:06.447

通常会发生这种情况...

当用户点击您的页面时，如果身份验证/授权处于活动状态，则会引发 Application_Authentication 事件。除非您针对 Active Directory 之类的东西使用 Windows 身份验证，否则您将无法使用 IPrincipal 和 Identity 对象，因此您无法访问 User.IsInRole() 方法。但是，您可以通过将以下代码添加到 Global.asax 文件中来做到这一点：

```
Sub Application_AuthenticateRequest(ByVal sender As Object, ByVal e As EventArgs)

      Dim formsAuthTicket As FormsAuthenticationTicket
      Dim httpCook As HttpCookie
      Dim objGenericIdentity As GenericIdentity
      Dim objMyAppPrincipal As CustomPrincipal
      Dim strRoles As String()

      Log.Info("Starting Application AuthenticateRequest Method...")

      httpCook = Context.Request.Cookies.Get("authCookieEAF")
      formsAuthTicket = FormsAuthentication.Decrypt(httpCook.Value)
      objGenericIdentity = New GenericIdentity(formsAuthTicket.Name)
      strRoles = formsAuthTicket.UserData.Split("|"c)
      objMyAppPrincipal = New CustomPrincipal(objGenericIdentity, strRoles)
      HttpContext.Current.User = objMyAppPrincipal

      Log.Info("Application AuthenticateRequest Method Complete.")

End Sub 
```

这将使用您可以在 Web 应用程序中访问的正确用户和角色凭据将 cookie 放入浏览器会话中。

理想情况下，您的用户只会在应用程序中担任一个角色，因此我相信这就是您可以使用角色检查方法的原因。为您编写一个辅助方法来遍历应用程序中的角色列表并测试以查看它们的角色是很容易的。

# svn - SVN：处理“死”文件

> ID：213790
> 
> 赞同：1
> 
> 时间：2008-10-17T20:45:39.353
> 
> 标签：svn, maintenance

我有一个 SVN 存储库。随着时间的推移，当我编辑、修改、更改等时，一些文件变得多余/不需要。

最佳实践是什么：从 SVN 中删除文件，或者只是将文件归零？还是我缺少第三种选择？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T20:47:06.840

如果您从 Subversion 中删除不需要的文件，它们在历史记录中仍然可用。它们不会永远消失。所以我会“svn rm”他们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T20:47:19.740

删除文件：

```
svn remove <file> 
```

这些文件不会从存储库中永久删除，只是从 HEAD 修订版中删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T21:01:54.737

提交一个空文件仍然会让文件惹恼你，只是减去任何内容。 `svn rm`是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T21:02:25.047

随着新版本的推出，您可能想要执行完整的存储库导出（而不是备份或热拷贝）。安装新版本，然后执行完整的存储库导入。

这将重新开始您的修订号，并且您将丢失该导出之前的所有历史记录。

# python - Python 会很好地替代 Windows 命令行/批处理脚本吗？

> ID：213798
> 
> 赞同：29
> 
> 时间：2008-10-17T20:48:26.307
> 
> 标签：python, command-line, scripting

我有一些使用[Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)的经验，我不介意，但现在我正在做大量的 Windows 开发，我需要使用 Windows 命令行语言做一些基本的事情/编写基本的脚本。出于某种原因，这种语言真的让我很恼火，所以我正在考虑学习 Python 并改用它。

Python 适合这样的事情吗？移动文件，创建脚本来执行诸如解压缩备份和恢复 SQL 数据库等操作。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-17T20:50:57.910

Python 非常适合这些任务，我猜想开发和调试比 Windows 批处理文件要容易得多。

我认为，问题是确保运行这些脚本的所有计算机都安装了 Python 是多么容易和轻松。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-19T11:14:49.597

## 概括

**Windows**：无需思考，使用 Python。 **Unix**：快速或一次性运行脚本适用于 Bash，严重和/或长寿命脚本适用于 Python。

## 大话

在 Windows 环境下，Python 绝对是最佳选择，因为[cmd](http://en.wikipedia.org/wiki/Command_Prompt)很糟糕，PowerShell 还没有真正安定下来。更重要的是，Python 可以在多个平台上运行，因此这是一项更好的投资。最后，Python 有一个庞大的库集，所以你几乎永远不会碰到“上帝我做不到”的墙。这不适用于 cmd 和 PowerShell。

在 Linux 环境中，这有点不同。许多单行代码在纯 Bash 中更短、更快、更高效并且通常更具可读性。但是，如果您知道您的快速而肮脏的脚本会保留一段时间或需要改进，请选择 Python，因为它更容易维护和扩展，并且[您将能够完成大部分可以完成的任务带有标准库的 GNU 工具](http://www.google.fr/url?sa=t&source=web&ct=res&cd=2&url=http%3A%2F%2Fwww.dabeaz.com%2Fgenerators%2FGenerators.pdf&ei=yRn7SJDYCIbS0QXFvq2JDw&usg=AFQjCNE6b1w4feELQFUppm2-GFCzYyd2UQ&sig2=nUjS8CM2Pd77W_HXUq4tRw)。如果不能，您仍然可以从 Python 脚本调用命令行。

当然，您可以使用 -c 选项从 shell 调用 Python：

```
python -c  "for line in open('/etc/fstab') : print line" 
```

更多关于 Python 用于系统管理任务的文献：

*   [IBM 实验室的观点](http://www.ibm.com/developerworks/aix/library/au-python/)。

*   [比较 bash 和 python 到脚本报告的一个很好的例子](http://www.unixreview.com/documents/s=9083/sam0401d/)。

*   [基础知识](http://www.samag.com/documents/s=8964/sam0312a/0312a.htm)。

*   [必备的书](https://rads.stackoverflow.com/amzn/click/com/0596515820)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-17T20:54:39.633

当然，对于这些任务，python 是一个不错的选择（我相信很多人会推荐 PowerShell）。

从这个角度来看，这是一个很好的介绍：

[http://www.redhatmagazine.com/2008/02/07/python-for-bash-scripters-a-well-kept-secret/](http://www.redhatmagazine.com/2008/02/07/python-for-bash-scripters-a-well-kept-secret/)

编辑：关于 gnud 的关注：[http ://www.portablepython.com/](http://www.portablepython.com/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-17T20:51:13.243

你知道[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)吗？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-17T20:59:11.120

任何东西都可以很好地替代 Windows 中的批处理文件系统。Perl、Python、Powershell 都是不错的选择。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-18T00:45:15.720

@BKB 肯定有一个合理的担忧。如果遇到标准库无法解决的任何问题，请查看以下几个链接：

*   [Pywin32](http://sourceforge.net/projects/pywin32/)是一个用于处理低级 win32 API（高级文件系统修改、COM 接口等）的包
*   [Tim Golden 的 Python 页面](http://timgolden.me.uk/python/)：他维护了一个基于 Pywin32 构建的 WMI 包装程序包，但请务必查看他的[“Win32 How Do I”](http://timgolden.me.uk/python/win32_how_do_i.html)页面以了解有关如何在 Python 中完成典型 Windows 任务的详细信息。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-17T20:57:23.247

Python当然非常适合。如果您要走这条路，您可能还想研究[SCons](http://scons.org)，它是一个使用 Python 构建的构建系统。很酷的是构建脚本本身就是成熟的 Python 脚本，所以你可以在构建脚本中做任何你可以在 Python 中做的事情。相比之下，它`make`看起来很贫血。

重读您的问题后，我应该注意到 SCons 更适合构建软件项目，而不是编写系统维护脚本。但无论如何我都会毫不犹豫地向你推荐 Python。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-30T19:52:36.150

作为后续，经过一些实验，我发现 Python 最有用的是任何涉及文本操作（yourStringHere.replace()，正则表达式用于更复杂的东西）或非常快速地测试一些基本概念的情况，它非常适合.

对于 SQL DB 恢复脚本之类的东西，我发现我仍然通常只使用批处理文件，因为它通常要么足够短，以至于实际上需要更多 Python 代码来进行适当的系统调用，要么我可以重用其他人的代码片段，从而减少写足够的时间来调整现有代码以满足我的需求。

作为附录，我强烈推荐[IPython](http://ipython.scipy.org/)作为一个出色的交互式 shell，它具有选项卡完成和简单的文档字符串访问。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-18T01:14:20.840

Python 与[Pywin32](http://sourceforge.net/projects/pywin32/)一起适用于 Windows 自动化。但是，与 Windows Scripting Host 一起使用的 VBScript 或 JScript 也可以正常工作，并且不需要安装任何额外的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-18T02:27:51.660

我已经在 Linux/Unix 和 Windows 环境、Python、Perl、批处理文件、Bash 等中编写了大量脚本。我的建议是，如果可能的话，安装 Cygwin 并使用 Bash（从你的描述中听起来像安装脚本语言或环境不是问题？）。你会更舒服，因为过渡是最小的。

如果这不是一个选择，那么这就是我的看法。批处理文件非常笨拙且有限，但对于“复制一些文件”或“重新启动此服务”等简单任务很有意义。Python 将更简洁、更易于维护且功能更强大。然而，不利的一面是，您最终会使用 subprocess、popen 或类似方法从 Python 调用外部应用程序。否则，您最终会编写更多代码来执行批处理文件中相对简单的事情，例如复制一个装满文件的文件夹。这在很大程度上取决于您的脚本在做什么。例如，Python 中的文本/字符串处理将变得更加简洁。

最后，它可能不是一个有吸引力的替代方案，但您也可以考虑将 VBScript 作为替代方案。我个人不喜欢将它作为一种语言使用，但如果可移植性是任何一种问题，那么它会因为在任何 Windows 副本中开箱即用而胜出。因此，我发现自己在 VBScript 中编写了作为批处理文件的笨拙脚本，因为我通常不能依赖 Windows 上可用的 Python、Perl 或 Bash。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-18T00:47:48.057

我最近一直在使用很多[Windows 脚本文件](http://msdn.microsoft.com/en-us/library/15x4407c.aspx)。比批处理脚本更强大，并且由于它使用 Windows 脚本，因此无需安装。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2008-10-18T02:12:40.863

尽管我很喜欢 python，但我认为它不是替换基本 Windows 批处理脚本的好选择。

我看不到有人必须导入 sys、os 或 getopt 之类的模块来执行您可以使用 shell 执行的基本操作，例如调用程序、检查环境变量或参数。

此外，根据我的经验，对于大多数系统管理员来说，goto 比函数调用更容易理解。

# sql - SharePoint 2007 - 用于在网站集中查找文档列表的 SQL 查询

> ID：213801
> 
> 赞同：4
> 
> 时间：2008-10-17T20:48:35.807
> 
> 标签：sql, sharepoint

我需要获取网站集中所有文档的列表，我相信我可以使用 alldocs 表或 alluserdata 表 (MOSS 2007 SP1) 来完成，但看不到如何获取文档的作者信息。我不需要文档的内容（例如 AllDocStreams 内容）

**像这样的东西：**

```
SELECT     tp_DirName, tp_LeafName, tp_Version, tp_Modified, tp_Created
FROM         AllUserData
WHERE     (tp_ContentType = 'Document') 
AND (tp_LeafName NOT LIKE '%.css') 
AND (tp_LeafName NOT LIKE '%.jpg') 
AND (tp_LeafName NOT LIKE '%.png') 
AND (tp_LeafName NOT LIKE '%.wmf') 
AND (tp_LeafName NOT LIKE '%.gif') 
AND (tp_DirName NOT LIKE '%Template%') 
AND (tp_IsCurrentVersion = 1) 
AND (tp_LeafName NOT LIKE '%.xsl')
ORDER BY tp_SiteId, tp_ListId, tp_DirName, tp_LeafName, tp_IsCurrentVersion DESC 
```

**有没有更好的方法来解决这个问题？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T14:37:51.227

声称由于不受支持而无法查询 SharePoint 数据库的人是错误的。通过阅读文档，只要使用“With(NoLock)”子句就可以查询数据库。显然不支持更新、删除或插入记录。

支持以下查询：

```
Select * 
From your_content_database.dbo.AllDocs With (NoLock) 
```

我将发布一个查询，在几分钟内提供所需的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T23:48:28.813

永远不要直接查询 SharePoint 数据库。这是完全不受支持的，并且可能会给您带来麻烦（例如，如果服务包或修补程序修改了架构，那么您的应用程序就会损坏）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-19T18:47:58.577

为什么不使用共享点对象模型而不是使用原始数据库方法？我知道对象模型方法与数据库相比确实有性能损失，但 MS 可以使用下一条路径更改 db 模式。另一方面，MS 破坏自己的对象模型的可能性要小得多，据我所知，推荐的方法是使用对象模型或 Web 服务。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-07T16:52:23.603

下面将返回在过去 24 小时内添加到内容数据库的前 100 个最大文档。

```
Select Top 100 
       W.FullUrl, 
       W.Title, 
       L.tp_Title as ListTitle, 
       A.tp_DirName, 
       A.tp_LeafName, 
       A.tp_id , 
       DS.Content , 
       DS.Size, 
       D.DocLibRowID, 
       D.TimeCreated, 
       D.Size, 
       D.MetaInfoTimeLastModified, 
       D.ExtensionForFile 
From your_content_database.dbo.AllLists L With (NoLock) 
join your_content_database.dbo.AllUserData A With (NoLock) 
  On L.tp_ID=tp_ListId 
join your_content_database.dbo.AllDocs D With (NoLock) 
  On A.tp_ListID=D.ListID 
 And A.tp_SiteID=D.SiteID 
 And A.tp_DirName=D.DirName 
 And A.tp_LeafName=D.LeafName 
join your_content_database.dbo.AllDocStreams DS With (NoLock) 
  On DS.SiteID=A.tp_SiteID 
 And DS.ParentID=D.ParentID 
 And DS.ID=D.ID 
join your_content_database.dbo.Webs W With (NoLock) 
  On W.ID=D.WebID 
 And W.ID=L.Tp_WebID 
 And W.SiteID=A.tp_SiteID 
Where DS.DeleteTransactionID=0x 
  And D.DeleteTransactionID=0x 
  And D.IsCurrentVersion=1 
  And A.tp_DeleteTransactionID=0x 
  And A.tp_IsCurrentVersion=1 
  And D.HasStream=1 
  And L.tp_DeleteTransactionId=0x 
  And ExtensionForFile not in('webpart','dwp','aspx','xsn','master','rules','xoml') 
  And D.MetaInfoTimeLastModified>DateAdd(d,-1,GetDate()) 
Order by DS.Size desc 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-01T15:15:08.077

我建议您查看 Camelot .NET 连接器，它允许您使用标准 SQL 查询来查询 SharePoint 2007/2010。它是一个 ADO.NET 驱动程序，也可以通过简单的 WCF 服务公开，也可以通过任何编程语言提供的服务公开。假设有人想从“共享文档”中进行选择，您可以编写如下内容：

```
select * from `shared documents` 
```

或某些列：

```
select id, title, filetype, filesize, created, createdby from `shared documents` 
```

或使用 where 语句：

```
select id, title, filetype, filesize, created, createdby from `shared documents` where filetype = '.gif' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-26T02:34:32.833

*   为什么不使用[内容查询 Web 部件](http://msdn.microsoft.com/en-us/library/bb850574.aspx)？
*   为什么不使用[搜索对象](http://msdn.microsoft.com/en-us/library/bb626127.aspx)来查询相同的内容？这将是我的首选解决方案。搜索已经拥有大多数属性，如果需要，您可以添加更多属性。搜索可能比查询内容数据库快很多。

无论是否支持，直接查询内容数据库仍然是一种不好的形式，任何建议将此作为解决方案的开发人员都应该接受讲座；）。例如，如果管理员为您的 webapp 创建第二个内容数据库会发生什么？如果您查询跨网站集，它不会返回所需的结果，直到您在代码中提供此内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T21:04:33.653

MOSS 提供了许多开箱即用的[Web服务，让生活更轻松。](http://www.infoq.com/articles/swanson-moss-web-services)它们总是值得探索。

对于这个特定的实例，我认为[*使用 SharePoint Web 服务从 MOSS 文档库中获取文件列表*](http://sqlblogcasts.com/blogs/drjohn/archive/2007/11/02/Getting-a-list-of-files-from-a-moss-document-library-using-a-SharePoint-web-service.aspx)的文章会有所帮助。如果这不是您的确切情况，它将使您走上正确的轨道。

如果文档服务不能帮助您，我相信搜索服务会帮助您。检查文档以了解使用情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T22:40:21.307

您可以通过将 AllUserData.tp_Author 加入到 UserInfo.tp_ID 来从 UserInfo 表中获取一些信息，但不建议在这些表中乱搞，而且可能非常脆弱，而且在应用任何补丁或服务包到 SharePoint。我会使用 Web 服务或 SharePoint 对象模型来访问数据。

# c# - 存储对 AD 组的引用的最佳方式是什么？

> ID：213814
> 
> 赞同：1
> 
> 时间：2008-10-17T20:52:57.670
> 
> 标签：c#, asp.net, active-directory

我正在为客户端编写一个 Intranet 应用程序，我想让他们能够通过管理界面进行配置，用户和用户组可以访问某些区域。我想知道的是存储对分配给 Intranet 区域的用户或组的引用的最佳方式。

我应该使用**域\用户名**和**域**\组名字符串，还是应该使用完全限定的广告名称，即**ou=computer room;cn=blah**等？

我将把引用存储在 SQL 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-17T21:03:09.070

就个人而言，我认为“域\用户名”格式具有足够的可读性。

此外，如果您直接编辑 SQL 表，您可以很容易地为用户插入一条记录以进行测试或调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T20:15:30.083

如果您想绝对确保您拥有正确的用户/组，您可以使用 SID（可分配权限的活动目录中任何对象上存在的安全标识符，以及它的 GUID）

我不确定应用程序的上下文是什么，但也许可以考虑使用 Active Directory 安全性来阻止用户去不应该去的地方，或者如果它不是一个高容量站点，其中一些可能可以完成具有集成身份验证，并在 sql 上进行安全验证。

我对 LDAP 查询和 AD 感到沮丧，因为不同的域控制器有时会给出不同的答案，甚至找不到对象，或者要求您在查询 AD 之前登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-19T02:32:08.917

如果组被移动或删除/重新创建，我会使用 domain\group。面对 OU 结构的变化，使用 CN 很脆弱。SID 不是人类可读的，如果对象被删除/重新创建，SID 就会中断。

# regex - 带有标点符号的重复单词的正则表达式

> ID：213816
> 
> 赞同：2
> 
> 时间：2008-10-17T20:53:15.877
> 
> 标签：regex

我想检查相邻的重复单词，但即使中间有标点符号。

例如：

```
Vivamus Vivamus diam, diam, Vivamus Vivamus diam, diam Vivamus 
```

这里应该有四个不同的命中。

我不知道为什么这不起作用。为什么？正确的代码应该是什么？

```
(\w*(?:[ ,\.])*?)\1 
```

* * *

*PS：这* ***不一定*** *适用于 Perl 引擎。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-17T20:57:01.080

这`(?:`是一个非捕获括号，这意味着它不会存储匹配项。您将需要使用捕获括号。

```
(\w+)\W+\1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-13T23:42:57.667

`[[\w|\W]+ ]+`为我工作。分解：

`\w`: 单词字符

`\W`: 非单词字符

`[\w|\W]+`：每个字符可以是单词或非单词字符，并且重复一次或多次

`[[\w|\W]+ ]+`: ...在某个时间点附加一个空格，全部发生一次或多次

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T21:31:27.703

原始表达式不会为标点创建单独的捕获，但会在第一次捕获中包含捕获的标点。这意味着它会发现以下内容：

```
diam, diam, really, really, twice. 
```

但是您对标点符号并不真正感兴趣，因此[TJ L 的解决方案](https://stackoverflow.com/a/213824/63550)可以正常工作，即使 '(?: ) 是非捕获括号' 的解释有点......不完整？引用的评论是准确的，但这不是整个正则表达式失败的原因。

# php - 在 Linux 上安装哪个 Eclipse 版本进行 PHP 开发

> ID：213833
> 
> 赞同：3
> 
> 时间：2008-10-17T21:00:24.583
> 
> 标签：php, linux, eclipse, slackware

我有 Slackware 12.1 并希望试用 Eclipse 进行 PHP/HTML/JavaScript 开发。但是，似乎我面临着无数可能的选择，我不想错过最好的东西并放弃 Eclipse（我目前正在使用[Geany](http://www.geany.org)，但我缺少一些东西，例如，自动完成用于 JavaScript）

我目前正在考虑从这里安装多合一 PDT 软件包版本 1.0.3：

[http://www.eclipse.org/pdt/downloads/](http://www.eclipse.org/pdt/downloads/)

但是，这似乎是 Eclipse 3.3。这里还有 3.4 的 Slackware 包：

[http://repository.slacky.eu/slackware-12.1/development/eclipse/3.4/](http://repository.slacky.eu/slackware-12.1/development/eclipse/3.4/)

但它说它是“经典”版本。我不确定为其添加 PHP、HTML、JavaScript 支持有多难。

注意：我不打算通过 Eclipse 的集成 Web 服务器或类似的东西来运行 PHP。我只想要一个强大的编辑器。

PS 另外，也欢迎推荐比 Eclipse 更好的 Linux 和免费软件。我已经用过 Kate、SciTE、Geany、Emacs、Vi 和 Bluefish，所以这些都不有趣。

**重要提示：**无论您推荐什么，请说明原因。不要急于成为西部最快的枪，因为我会否决只说“使用这个”的答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T21:45:15.210

我全心全意地支持 Aptana。由于它非常接近 Eclipse，因此如果您决定编写 Aptana 不会涉及的编码，您仍然习惯于 Eclipse 的通用界面。

我不想说它被削减了，因为它不是。它只是具有您将使用它的语言和技术所需的东西。您仍然可以为 SVN、CVS 等添加其他插件。界面也没有那么拥挤。

我没有做大量的 javascript 编码，但是伙计，这就是从人群中脱颖而出的地方。它在 Javascript 方面做得非常出色。

此外，您不必使用 Aptana 内置的 Jetty 服务器来运行 PHP；你可以告诉它你的本地 Apache 服务器在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T21:38:59.217

我建议将 Eclipse 3.3 与 PHP 开发工具一起使用。多[合一](http://www.eclipse.org/downloads/download.php?file=/tools/pdt/downloads/drops/1.0.3/R200806030000/pdt-all-in-one-1.0.3-linux-gtk.tar.gz)包应该可以正常工作。将 Eclipse 用作 PHP IDE 的好处是您可以很好地集成 Zend Debugger/XDebug，并且您也可以为 PHP 使用常见的 Eclipse 扩展，如[Mylyn](http://www.eclipse.org/mylyn/)或[Subclipse](http://subclipse.tigris.org/)。

Eclipse 3.4 目前对 PHP 开发没有用处，因为 PDT 2.0 的最终版本被[推迟](http://www.maxhorvath.com/2008/08/eclipse-pdt-20-release-postponed.html)了。

您还可以查看[Aptana](http://www.aptana.com/studio/download/1.1)或当前的[Netbeans 6.5 Milestone](http://www.netbeans.org/kb/trails/php.html)，它们都支持 PHP。在 PDT 2.0 之前，它们都提供比当前基于 Eclipse 3.3 的 PDT 更好的 JavaScript 支持。Aptana 也是基于 Eclipse。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T21:51:27.677

我仍在使用 Eclipse 3.3.2 和 PDT 1.0.3，我对此非常满意。我尝试使用 PDT 2.0 的一些最新版本升级到 Eclipse 3.4，但它有问题。在某些情况下（比如我在 PHP 编辑器中复制文本时）它会挂起很长时间。每次我重新启动 Eclipse 时，它​​都会重新解析我的所有代码，这需要很长时间。这些问题最终可能会得到解决，但我会坚持下去，除非你真的想要 Eclipse 3.4。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T09:05:43.243

如果你想要 JavaScript 的自动完成，那么你应该使用一些 Eclipse 的插件，比如 Aptana Studio，但是 Aptana 不仅仅是 javascript 的自动竞争工具，它包含了很多你不需要的东西不需要定期开发。我在 Eclipse 中为 JavaScript 找到正确的解决方案时遇到同样的问题，Aptana 还可以，但我讨厌 Aptana 包含的附加功能，我没有找到任何可以添加到 Eclipse 中的好工具，用于 JavaScript :( 对于脚本JSP、Eclipse之类的语言就像一首歌……好听、甜美、流畅……；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:02:49.523

[Aptana](http://aptana.com/)是一个不错的选择，专门用于 Web 开发的 Eclipse 克隆。

我个人使用 Krusader 的编辑器，它是 Kate (KWrite) 的残缺版本。快速、漂亮的代码高亮和许多有用的快捷方式（例如`Ctrl`+`D`以明智地选择注释）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-20T13:53:02.773

带有 PDT Eclipse 的 Javascript 和插件 jseclipse 让你所有的问题都消失了！:) 使用 jseclipse，常规的“使用 F3 键盘按下 Goto 功能”可以正常工作。

# python - 如何提高 Trac 的性能

> ID：213838
> 
> 赞同：3
> 
> 时间：2008-10-17T21:02:43.407
> 
> 标签：python, performance, trac

我注意到我的特定 Trac 实例运行不快并且有很大的滞后。这是一个项目的开始，所以在 Trac 中没有多少（除了插件和加载到 SVN 中的代码）。

**设置信息：**这是通过 WebFaction 托管的 SELinux 系统。它在 Apache 之后，并且通过 SSL 进行连接。目前 .htpasswd 文件是我用来控制访问的文件。

有什么推荐的方法来提高 Trac 的性能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T23:19:49.573

如果不了解更多关于您的设置，很难说，但一个简单的胜利是确保 Trac 在类似`mod_python`. 否则，每个 HTTP 请求都会导致 Python 运行，导入所有模块，然后最终处理请求。使用`mod_python`（或您喜欢的 FastCGI）将消除加载并直接跳到好东西。

此外，随着 Trac 数据库的增长以及使用该站点的人越来越多，您可能会超出默认的 SQLite 数据库。此时，您应该考虑将数据库迁移到 PostgreSQL 或 MySQL，因为它们将能够更快地处理并发请求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T14:13:36.820

我们在 FastCGI 上遇到了最好的运气。另一个关键因素是仅`https`用于身份验证，但`http`用于所有其他流量——我真的很惊讶这有多大的不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T10:13:03.283

我注意到如果

```
select disctinct name from wiki 
```

花费超过 5 秒（例如，由于此表中有一百万行 - 这是一个真实的故事（我们有一个脚本来填充它）），浏览 wiki 页面变得非常缓慢并接管，执行时间在`2*t*n`哪里`t`引用的查询（当然 > 5s），并且`n`是查看页面上存在的许多 tracwiki 链接。这是由于 trac 对此查询有一个（硬编码的）5s 缓存过期。trac 使用它来告诉链接应该是什么颜色。我们将值重新硬编码为 30 秒（我们需要那么多页面，所以每 30 秒有人必须等待 6-7 秒）。

这可能不是导致您的问题的原因，但可能是。祝你好运加速你的 Trac 实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T19:48:30.150

使用和 expires-header 静态提供 chrome 文件也可以提供帮助。[请参阅本页](http://bannister.us/weblog/2007/07/23/example-of-configuring-trac-and-subversion-on-ubuntu/)末尾。

# plugins - Word 文档的优秀代码片段工具或插件？

> ID：213840
> 
> 赞同：1
> 
> 时间：2008-10-17T21:02:51.317
> 
> 标签：plugins, ms-word, openoffice.org, code-snippets, openoffice-writer

有谁知道一个好的工具或插件可以让 Microsoft Word 或 OpenOffice Writer 以干净的方式将代码片段添加到文档中？

我不确定这样的插件是否存在，因此将我重定向到可以帮助我的任何其他工具将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T21:16:43.537

我只需在 Visual Studio 中输入代码段，然后将其复制粘贴到 word 中。它保留了所有代码格式。

我唯一要做的是将字体更改为 Consolas。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T02:44:34.280

我喜欢 VS 的 codekeep .. 但它只适用于 VS

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T13:50:27.033

Snip-It Pro 是一个独立的代码片段工具，适用于 word 或 open office。它停靠在屏幕的一侧，并且可以将片段拖放到任何应用程序中。它也有语法高亮。

免责声明：这是我的产品 :)

# javascript - Javascript 在不应该删除空格的情况下删除空格？

> ID：213845
> 
> 赞同：7
> 
> 时间：2008-10-17T21:03:36.417
> 
> 标签：javascript, dom, whitespace, innerhtml

我有一个 HTML 文件，其代码类似于以下内容。

```
<table>
    <tr>
    <td id="MyCell">Hello  World</td>
    </tr>
</table> 
```

我正在使用如下的javascript来获取值

```
document.getElementById(cell2.Element.id).innerText 
```

这将返回文本“Hello World”，在 hello 和 world 之间只有 1 个空格。我必须保持相同数量的空间，有什么办法可以做到吗？

我试过使用 innerHTML、outerHTML 和类似的项目，但我没有运气。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-17T21:05:31.170

HTML 对空格不敏感，这意味着您的 DOM 也是如此。将您的“Hello World”包装在**预**块中工作吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T21:07:08.687

在 HTML 中，任何大于 1 的空格都会被忽略，无论是显示文本还是通过 DOM 检索文本。保持空格的唯一保证方法是使用不间断空格`&nbsp;`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T21:09:46.717

提示一下，innerText 仅适用于 Internet Explorer，而 innerHTML 适用于所有浏览器……所以，请使用 innerHTML 而不是 innerText

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T21:40:58.870

您的 CSS 中的`pre`标签或标签`white-space: pre`会将所有空格视为有意义的。但是，这也会将换行符变成换行符，所以要小心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:07:44.520

刚刚检查了一下，看起来应该用**pre标签包装。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T21:42:32.063

编辑：我错了，别理我。

您可以获得文本节点的 nodeValue，它应该正确地表示其空白。

这是一个递归获取给定元素中文本的函数（它是库安全的，如果您使用修改 Array.prototype 或其他的东西，它不会失败）：

```
var textValue = function(element) {
    if(!element.hasOwnProperty('childNodes')) {
        return '';
    }
    var childNodes = element.childNodes, text = '', childNode;
    for(var i in childNodes) {
        if(childNodes.hasOwnProperty(i)) {
            childNode = childNodes[i];
            if(childNode.nodeType == 3) {
                text += childNode.nodeValue;
            } else {
                text += textValue(childNode);
            }
        }
    }
    return text;
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T18:45:45.240

这里只是一个意见，而不是规范的建议，但是如果您尝试通过 Javascript 使用内部/外部 HTML/TEXT 属性从 DOM中提取**准确的文本值，那么您将走向世界或受到伤害。**根据浏览器“查看”内部文档的方式，不同的浏览器将返回略有不同的值。

如果可以的话，我会更改您正在呈现的 HTML 以包含隐藏的输入，例如

```
<table>
    <tr>
    <td id="MyCell">Hello  World<input id="MyCell_VALUE" type="hidden" value="Hello  World" /></td>
    </tr>
</table> 
```

然后在 javascript 中获取您的价值，例如

```
document.getElementById(cell2.Element.id+'_VALUE').value 
```

输入标签旨在保存值，您将不太可能遇到保真度问题。

此外，听起来您正在使用某种 .NET 控件。可能值得查看文档 (ha) 或询问稍微不同的问题，以查看控件是否提供某种官方客户端 API。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T19:17:00.823

这有点hacky，但它适用于我的IE。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <title></title>
</head>
<body>
<div id="a">a  b</div>
<script>
var a = document.getElementById("a");
a.style.whiteSpace = "pre"
window.onload = function() {
    alert(a.firstChild.nodeValue.length) // should show 4
}
</script>
</body>
</html> 
```

一些注意事项：

*   你必须有一个文档类型。
*   在 window.onload 触发之前，您无法查询 DOM 元素
*   您应该使用 element.nodeValue 而不是 innerHTML 等，以避免当文本包含 < > & " 之类的内容时出现错误
*   由于我认为这是一个丑陋的错误，一旦 IE 完成渲染页面，您就无法重置 whiteSpace

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-13T21:57:18.850

以下技巧在 IE 中保留了 innerText 中的空白

```
var cloned = element.cloneNode(true);
var pre = document.createElement("pre");
pre.appendChild(cloned);
var textContent = pre.textContent
  ? pre.textContent
  : pre.innerText;
delete pre;
delete cloned; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-13T22:00:23.307

如果有人可以正确格式化我的最后一篇文章，它看起来会更具可读性。对不起，我把那个搞砸了。基本上，诀窍是创建一个一次性的 pre 元素，然后将节点的副本附加到该元素。然后您可以根据浏览器获取 innerText 或 textContent 。

除了 IE 之外的所有浏览器基本上都正确地完成了显而易见的事情。IE 需要这种 hack，因为它只在 pre 元素中保留空白，并且只有当您访问 innerText 时。

# sql - SQL 查询 - 在 UNION 中使用 Order By

> ID：213851
> 
> 赞同：84
> 
> 时间：2008-10-17T21:05:16.053
> 
> 标签：sql, ms-access, sorting, sql-order-by, union

从两个表中提取数据时，如何以编程方式对联合查询进行排序？例如，

```
SELECT table1.field1 FROM table1 ORDER BY table1.field1
UNION
SELECT table2.field1 FROM table2 ORDER BY table2.field1 
```

抛出异常

注意：这是在 MS Access Jet 数据库引擎上尝试的

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2010-08-03T07:35:38.403

有时您需要`ORDER BY`在需要与`UNION`.

在这种情况下

```
SELECT * FROM 
(
  SELECT table1.field1 FROM table1 ORDER BY table1.field1
) DUMMY_ALIAS1

UNION ALL

SELECT * FROM
( 
  SELECT table2.field1 FROM table2 ORDER BY table2.field1
) DUMMY_ALIAS2 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-10-17T21:10:46.993

```
SELECT field1 FROM table1
UNION
SELECT field1 FROM table2
ORDER BY field1 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-10-17T21:18:06.887

我认为这很好地解释了。

以下是使用 ORDER BY 子句的 UNION 查询：

```
select supplier_id, supplier_name
from suppliers
where supplier_id > 2000
UNION
select company_id, company_name
from companies
where company_id > 1000
ORDER BY 2; 
```

由于两个“选择”语句之间的列名不同，因此在 ORDER BY 子句中通过列在结果集中的位置来引用它们会更有利。

在此示例中，我们按`supplier_name`/`company_name`升序对结果进行了排序，如“ORDER BY 2”所示。

`supplier_name`/`company_name`字段在结果集中的位置 #2 。

取自这里：[http ://www.techonthenet.com/sql/union.php](http://www.techonthenet.com/sql/union.php)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2011-09-16T13:45:40.710

使用一个具体的例子：

```
SELECT name FROM Folders ORDER BY name
UNION
SELECT name FROM Files ORDER BY name 
```

**文件：**

```
name
=============================
RTS.exe
thiny1.etl
thing2.elt
f.txt
tcpdump_trial_license (1).zip 
```

**文件夹：**

```
name
============================
Contacts
Desktop
Downloads
Links
Favorites
My Documents 
```

**期望的输出：（**首先选择的结果，即文件夹优先）

```
Contacts
Desktop
Downloads
Favorites
Links
My Documents
f.txt
RTMS.exe
tcpdump_trial_license (1).zip
thiny1.etl
thing2.elt 
```

SQL达到预期的效果：

```
SELECT name 
FROM (
    SELECT 1 AS rank, name FROM Folders
    UNION 
    SELECT 2 AS rank, name FROM Files) dt
ORDER BY rank, name 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-17T21:16:09.213

以下是 Northwind 2007 的示例：

```
SELECT [Product ID], [Order Date], [Company Name], [Transaction], [Quantity]
FROM [Product Orders]
UNION SELECT [Product ID], [Creation Date], [Company Name], [Transaction], [Quantity]
FROM [Product Purchases]
ORDER BY [Order Date] DESC; 
```

在您完成所有联合之后，ORDER BY 子句只需要成为最后一条语句。您可以将多个集合合并在一起，然后在最后一个集合之后放置一个 ORDER BY 子句。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-17T21:11:07.947

```
(SELECT table1.field1 FROM table1 
UNION
SELECT table2.field1 FROM table2) ORDER BY field1 
```

工作？记住思考集。使用联合获取您想要的集合，然后对其执行操作。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-17T21:31:03.477

```
SELECT table1Column1 as col1,table1Column2 as col2
    FROM table1
UNION
(    SELECT table2Column1 as col1, table1Column2 as col2
         FROM table2
)
ORDER BY col1 ASC 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-06-12T03:10:12.850

```
SELECT field1
FROM ( SELECT field1 FROM table1
       UNION
       SELECT field1 FROM table2
     ) AS TBL
ORDER BY TBL.field1 
```

（使用别名）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-11-09T21:52:15.833

这是我见过的最愚蠢的事情，但它确实有效，而且你不能与结果争论。

```
SELECT *
FROM (
    SELECT table1.field1 FROM table1 ORDER BY table1.field1
    UNION
    SELECT table2.field1 FROM table2 ORDER BY table2.field1
) derivedTable 
```

派生表的内部不会自行执行，但作为派生表工作得很好。我已经在 SS 2000、SS 2005、SS 2008 R2 和所有三个工作上尝试过这个。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-08T22:07:40.697

这就是它的完成方式

```
select * from 
    (select top 100 percent pointx, pointy from point
     where pointtype = 1
     order by pointy) A
union all
select * from 
    (select top 100 percent pointx, pointy from point
     where pointtype = 2
     order by pointy desc) B 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-22T20:55:37.847

浏览这个评论部分，我遇到了两种不同的模式来回答这个问题。可悲的是，对于 SQL 2012，第二种模式不起作用，所以这是我的“解决方法”

* * *

## 在公共列上排序

这是您可以遇到的最简单的情况。就像许多用户指出的那样，您真正需要做的就是`Order By`在查询末尾添加一个

```
SELECT a FROM table1
UNION
SELECT a FROM table2
ORDER BY field1 
```

或者

```
SELECT a FROM table1 ORDER BY field1
UNION
SELECT a FROM table2 ORDER BY field1 
```

* * *

## 按不同列排序

这就是它实际上变得棘手的地方。使用 SQL 2012，我尝试了顶帖，但它不起作用。

```
SELECT * FROM 
(
  SELECT table1.field1 FROM table1 ORDER BY table1.field1
) DUMMY_ALIAS1

UNION ALL

SELECT * FROM
( 
  SELECT table2.field1 FROM table2 ORDER BY table2.field1
) DUMMY_ALIAS2 
```

按照评论中的建议，我尝试了这个

```
SELECT * FROM 
(
  SELECT TOP 100 PERCENT table1.field1 FROM table1 ORDER BY table1.field1
) DUMMY_ALIAS1

UNION ALL

SELECT * FROM
( 
  SELECT TOP 100 PERCENT table2.field1 FROM table2 ORDER BY table2.field1
) DUMMY_ALIAS2 
```

这段代码确实编译了，但是`DUMMY_ALIAS1`并`DUMMY_ALIAS2`覆盖`Order By`了语句中建立的代码`Select`，这使得它无法使用。

我能想到的唯一对我有用的解决方案是不使用联合，而是让查询单独运行然后处理它们。`Union`所以基本上，当你想要的时候不要使用`Order By`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-24T17:07:32.137

通过单独使用顺序，每个子集都会获得顺序，但不是整个集合，这就是您想要合并两个表的结果。

你应该使用这样的东西来拥有**一个**有序的集合：

```
SELECT TOP (100) PERCENT field1, field2, field3, field4, field5 FROM 
(SELECT table1.field1, table1.field2, table1.field3, table1.field4, table1.field5 FROM table1
UNION ALL 
SELECT table2.field1, table2.field2, table2.field3, table2.field4, table2.field5 FROM  table2) 
AS unitedTables ORDER BY field5 DESC 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-17T21:07:56.080

第二个表不能在`ORDER BY`子句中包含表名。

所以...

```
SELECT table1.field1 FROM table1 ORDER BY table1.field1
UNION
SELECT table2.field1 FROM table2 ORDER BY field1 
```

不抛出异常

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-13T15:01:23.943

如果需要保持内部排序：

```
SELECT 1 as type, field1 FROM table1 
UNION 
SELECT 2 as type, field1 FROM table2 
ORDER BY type, field1 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-07-14T18:20:01.983

```
(SELECT FIELD1 AS NEWFIELD FROM TABLE1 ORDER BY FIELD1)
UNION
(SELECT FIELD2 FROM TABLE2 ORDER BY FIELD2)
UNION
(SELECT FIELD3 FROM TABLE3 ORDER BY FIELD3) ORDER BY NEWFIELD 
```

试试这个。它对我有用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-05-23T09:07:18.817

**对于 Sql Server 2014/2012/Others（未选中）：**

```
SELECT * FROM 
(
  SELECT table1.field1 FROM table1 ORDER BY table1.field1
) 
as DUMMY_ALIAS1

UNION ALL

SELECT * FROM
( 
  SELECT table2.field1 FROM table2 ORDER BY table2.field1
) 
as DUMMY_ALIAS2 
```

# bash - 如何从管道分隔的文件中打印字段？

> ID：213855
> 
> 赞同：11
> 
> 时间：2008-10-17T21:06:50.217
> 
> 标签：bash, unix, shell, awk, ksh

我有一个由管道字符分隔的字段的文件，我只想打印第二个字段。此尝试失败：

```
$ cat file | awk -F| '{print $2}'
awk: syntax error near line 1
awk: bailing out near line 1
bash: {print $2}: command not found 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-17T21:13:31.047

或者只使用一个命令：

```
cut -d '|' -f FIELDNUMBER 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T21:29:55.787

这里的关键点是管道字符 ( `|`) 必须转义到 shell。使用 " `\|`" 或 " `'|'`" 来保护它免受 shell 的干扰，并允许它`awk`在命令行上传递。

* * *

阅读评论我看到原始海报提出了原始问题的简化版本，其中涉及`file`在选择和打印字段之前进行过滤。使用了通过`grep`，并将结果通过管道传输到 awk 以进行字段选择。这解释了问题中出现的完全不必要`cat file`的内容（它取代了`grep <pattern> file`）。

好吧，那会奏效的。但是，awk 本身在很大程度上是一个模式匹配工具，可以信任它来查找和处理匹配的行，而无需调用`grep`. 使用类似的东西：

```
awk -F\| '/<pattern>/{print $2;}{next;}' file 
```

该`/<pattern>/`位告诉`awk`在匹配的行上执行以下操作`<pattern>`。

lost-looking`{next;}`是跳到输入中的下一行的默认操作。好像没必要，不过我早就有这个习惯了……

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T21:06:56.800

管道字符需要转义，以便 shell 不会解释它。一个简单的解决方案：

```
$ awk -F\| '{print $2}' file 
```

另一种选择是引用字符：

```
$ awk -F'|' '{print $2}' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-06T00:46:50.257

使用 awk 的另一种方法

```
awk 'BEGIN { FS = "|" } ; { print $2 }' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:23:28.857

并且“文件”不包含管道符号，因此它什么也不打印。您应该使用“cat 文件”或简单地在 awk 程序之后列出该文件。

# java - AIX：IBM Java：java.net.SocketException：连接超时：可能是由于地址无效

> ID：213857
> 
> 赞同：4
> 
> 时间：2008-10-17T21:07:01.760
> 
> 标签：java, ssl, aix, apache-commons-httpclient

在尝试与我们的服务器建立 SSL 连接时，我们在 IBM AIX 上经常看到以下异常：

```
java.net.SocketException: Socket closed
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.a(DashoA6275(Compiled Code))
at com.sun.net.ssl.internal.ssl.AppOutputStream.write(DashoA6275(Compiled Code))
at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java(Inlined Compiled Code))
at java.io.BufferedOutputStream.flush(BufferedOutputStream.java(Compiled Code))
at java.io.FilterOutputStream.flush(FilterOutputStream.java(Compiled Code))
at org.apache.commons.httpclient.methods.EntityEnclosingMethod.writeRequestBody(EntityEnclosingMethod.java(Compiled Code))
at org.apache.commons.httpclient.HttpMethodBase.writeRequest(HttpMethodBase.java(Compiled Code))
at org.apache.commons.httpclient.HttpMethodBase.execute(HttpMethodBase.java(Compiled Code))
at org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java(Compiled Code))
at org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java(Compiled Code))
at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java(Compiled Code))
at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java(Inlined Compiled Code))
at com.eximtechnologies.httptransport.client.ClientTransport.receiveMessages(ClientTransport.java(Compiled Code))
at com.eximtechnologies.httptransport.client.ClientTransport.receiveMessages(ClientTransport.java(Inlined Compiled Code))
at com.eximtechnologies.ecserver.connection.XMSHTTPConnection.checkForNewMessages(XMSHTTPConnection.java(Compiled Code))
at com.eximtechnologies.ecserver.connection.XMSHTTPConnection.timeoutExpired(XMSHTTPConnection.java(Compiled Code))
at com.eximtechnologies.xmd.timer.TimerEvent$1.run(TimerEvent.java(Compiled Code)) 
```

从错误中，您可能会认为这只是网络问题，但客户在大约 2 个月前从未遇到过此问题，并且 AFAIK，网络布局没有任何变化。

我们也经常收到这个：

```
java.net.SocketException: Connection timed out:could be due to invalid address
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:336)
at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:201)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:188)
at java.net.Socket.connect(Socket.java:478)
at java.net.Socket.connect(Socket.java:428)
at java.net.Socket.<init>(Socket.java:335)
at java.net.Socket.<init>(Socket.java:210)
at javax.net.ssl.SSLSocket.<init>(Unknown Source) 
```

我怀疑这是 AIX 问题，但我想这可能是防火墙问题？我还在 google 搜索中看到有人暗示 commons http 存在问题，但我看不出这有什么关系。

这是其他人最近在 AIX 上看到的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T22:53:54.353

“java.net.SocketException: Socket closed”表示你这边关闭了socket。您说当您尝试与服务器建立 SSL 连接时会发生这种情况。但是，堆栈跟踪表明当 HTTPClient 尝试通过已建立的连接编写 HTTP 请求时会发生这种情况。

例如，如果您以某种方式设法使 HTTPClient 通过先前由 HTTPClient 关闭的连接发送请求，或者更有可能由您身边的其他代码关闭，则可能会发生这种情况。检查您是否正在某处访问底层套接字。或者可能是 SSL/TLS 协议关闭了套接字（如果我没记错的话，SSL/TLS 有自己的更高级别的协议来关闭底层连接），但是 HTTPClient 不知何故设法没有注意到这一点（不要'不知道这是否可能，但是，比如说，远程端关闭了 SSL 连接，但使用的是 HTTP/1.1 持久连接并且没有设置 Connection: close 响应）。

您可以通过使用 tcpdump/Wireshark 分析 TCP 流量来解决这些问题。你也可以在一台机器上启动一个到服务器 HTTPS 端口的通道，然后让你的代码通过这个通道通过普通的 HTTP 与服务器通信。这应该使您能够以明文形式查看 HTTP 流量。

“java.net.SocketException: Connection timed out”表示由于超时无法建立TCP连接。可能是数据包被防火墙丢弃了。例如，您可能需要使用 HTTP 代理来发出 HTTPS 请求。也可能是服务器机器真的很忙或网络真的很忙。再次，我建议您尝试 tcpdump/Wireshark 以查看 TCP 级别发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-25T05:16:20.107

如果它不起作用，我不会感到惊讶！

指定的超时是从指定的连接管理器获取连接的超时，而不是需要不同设置的实际套接字或服务器超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T21:28:37.600

我遇到了通过使用多线程连接更正的 http 客户端问题。我们通过从以下第一个配置移动到第二个配置来修复它：

```
<bean id="httpClient" class="org.springframework.remoting.httpinvoker.CommonsHttpInvokerRequestExecutor">
    <property name="httpClient">
        <bean class="org.apache.commons.httpclient.HttpClient">
            <property name="connectionTimeout"><value>1000</value></property>
            <property name="timeout"><value>3000</value></property>
        </bean>
    </property>
</bean>

<bean id="httpClient" class="org.springframework.remoting.httpinvoker.CommonsHttpInvokerRequestExecutor">
    <property name="httpClient">
        <bean class="org.apache.commons.httpclient.HttpClient">
            <property name="connectionTimeout"><value>1000</value></property>
            <property name="timeout"><value>3000</value></property>
            <property name="httpConnectionManager">
              <bean class="org.apache.commons.httpclient.MultiThreadedHttpConnectionManager" destroy-method="shutdown">
                <property name="params">
                  <bean class="org.apache.commons.httpclient.params.HttpConnectionManagerParams">
                    <property name="defaultMaxConnectionsPerHost" value="20" />
                  </bean>
                </property>
              </bean>
            </property>
        </bean>
    </property>
</bean> 
```

# java - 学习Java EE、jboss等

> ID：213863
> 
> 赞同：9
> 
> 时间：2008-10-17T21:08:08.497
> 
> 标签：java, jakarta-ee, jboss

10 年来，我一直在使用 Swing 和 JDBC 进行“普通的旧 Java 对象”编程，我认为自己非常擅长。但是我在两周后开始了一份新工作，他们使用 JBoss，我想在开始之前开始学习所有这些东西。什么是好的资源？在线教程、书籍、电子书，任何你可以建议的东西，尤其是那些不尝试先教你纯 Java 基础知识的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T18:35:25.510

为了快速上手，您确实需要掌握 EJB 和 JSP/Servlet。这些是 Java EE 技术的基础。关于 EJB 和 JSP/Servlet 的 Head First 系列对于通常是一个令人费解的复杂框架来说是一个良好的开端。请注意，最近的 Head First 版本已转向教授更简单的基于注释的 Java EE 1.5 框架。虽然较新版本的 Java EE 更简单更好，但您可能需要了解以前的版本（Java EE 1.4 = EJB 2.1 和 Servlets 2.4）。

此时，您只是将脚浸入水中。在接下来的一年里，我将花费大量时间阅读 Java EE 技术以及更广泛的客户端-服务器企业应用程序开发。

a）您绝对必须了解数据建模和数据库。我见过的最好的是 Chris Date、Steve Feuerstein（如果您使用 Oracle）和 Joe Celko。更好的 Java EE 开发人员可以在有关数据库的技术讨论中跟上他们的 DBA。

b) 你确实需要了解 JDBC 是如何工作的，以及为什么会出现像 iBatis、Hibernate 和 Toplink 这样的 ORM 工具。假设您知道如何编写 JDBC DAO，那么请务必了解 Hibernate 的工作原理。

c) 您应该了解 Java EE 应用程序的分层架构。*核心 Java EE 设计模式*已经规定了典型实践，您即将进行的项目很可能会坚持这些模式。也就是说，您还应该了解有关架构的其他观点。我发现 Martin Fowler 的*企业应用程序架构模式*和 Rod Johnson 的*专家一对一 Java EE 设计和开发*很有价值。后者中的想法成为了 Spring 框架，并已成为许多 J2EE 开发人员更喜欢开发他们的应用程序的主流。

d) 然后学习一些围绕 Java EEE 生态系统萌芽的框架。虽然这是一个哲学问题，为什么会有这么多框架，以及哪个更好，但关注您的雇主专门使用的框架就绰绰有余了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T21:22:41.743

我想到了几个答案：

*   如果您习惯使用“plain old java”，那么您可能需要一个plain old j2EE 的基础，而不是JBOSS 特定的东西。我将从[sun 教程](http://java.sun.com/javaee/5/docs/tutorial/doc/)开始，但熟悉 servlet 的一般结构，即 servlet api，是基础。

*   随着应用程序服务器的发展，JBoss（仅我的偏见）非常庞大和复杂。想想“发射航天飞机”，你就不会太远了。百万服务。它特别值得注意的是具有不寻常的类加载器结构（尽管自从我上次使用它以来这可能已经改变，大约 1 -2 年前）等等。它也有很多不错的服务，比如 JMX 基础（管理配置 bean），尽管文档可能参差不齐，因为支持是一项付费服务​​。

最佳建议 - 熟悉 J2EE 库。接下来是在 JBOSS 中运行一个基本站点。您可能想要做的更具体的事情可能非常具体到他们的安装（例如，那里有一个可用的 JMS 实现，但他们可能没有使用它），因为我看到人们只使用它作为一个 servlet 容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T21:25:39.913

我建议在工作中读一本像 Jboss 这样的书 [http://oreilly.com/catalog/9780596007348/](http://oreilly.com/catalog/9780596007348/)

我们在工作中也使用 jboss.. 我读了这本书，发现它很有用..

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T21:36:37.583

听起来像我（虽然绝对不是 10 年的经验）。我从 servlet/jsps 的 Head first 系列开始。我已经知道它们的用途。如果你对设计模式和 OOPS 有很好的掌握，Ejbs 和其他资源将是小菜一碟，专心研究它们的原因，如何以及做什么可以等待。应用程序服务器是另一种野兽，但是，通过管理手册有助于澄清很多事情。SSL/证书存储/集群可以排在列表的最后。您还想了解诸如 Hibernet 之类的 ORM 工具；替代视图技术，如 Wicket、Tapestry 等；像 Spring 这样的容器和像 struts 这样的库都是可以慢慢学习的。在互联网上发布的最佳实践和评论肯定会有所帮助。

选择要遵循的顺序应该不是那么困难，因为大多数时候工作场所决定了技术。请记住，J2EE 是一堆规范和框架，本质上是针对特定群体的支持库。掌握关键的是设计师/开发人员

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T21:26:06.683

学习企业 Java Bean

# database - 数据库自动提交 - 它直接进入磁盘吗？

> ID：213869
> 
> 赞同：1
> 
> 时间：2008-10-17T21:10:21.863
> 
> 标签：database, transactions, commit

所以我知道自动提交会提交每个 sql 语句，但是对数据库的更新是直接进入磁盘还是保留在缓存中直到刷新？

我意识到它依赖于数据库实现。

自动提交是否意味着a）每个语句都是一个完整的事务，它直接进入磁盘或b）每个语句都是一个完整的事务，它可能会进入缓存，稍后将被刷新，或者它可能会直接进入磁盘

澄清会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T21:15:41.323

自动提交只是意味着每个语句都在其自己的事务中，该事务立即提交。这与“正常”模式形成对比，在“正常”模式下，您必须显式地`BEGIN`进行事务，然后`COMMIT`一旦完成（通常在几个语句之后）。

短语“自动提交”与磁盘访问或缓存无关。作为一个实现细节，大多数数据库将在提交时写入磁盘以避免数据丢失，但这在规范中不是强制性的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T00:43:11.997

提交不保证某些内容已写入磁盘，仅保证您的事务已完成并且更改现在对其他用户可见。

永久并不一定意味着写入磁盘（即持久）......即使“提交”等待事务完成，也可以配置一些数据库。

例如，Oracle 10gR2 有[几种提交模式](http://www.orafaq.com/node/93)，包括 IMMEDIATE、WAIT、BATCH、NOWAIT。BATCH 将对缓冲区的更改进行排队，写入器将在将来的某个时间将更改写入磁盘。NOWAIT 将立即返回而不考虑 I/O。

commmit 的确切行为是非常特定于数据库的，并且通常可以根据您对数据丢失的容忍度进行配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T21:16:34.597

对于基于 ARIES 的协议，提交事务涉及*记录*在该事务中所做的所有修改。更改会立即刷新到*logfile*，但不一定会刷新到 datafile （取决于实现）。这足以确保在发生故障时可以恢复更改。所以，(b)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T21:35:06.447

这取决于您使用的 DBMS。例如，[Firebird](http://www.firebirdsql.org)将其作为配置文件中的一个选项。如果打开*强制写入*，更改将直接写入磁盘。否则它们被提交到文件系统，实际写入时间取决于操作系统缓存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T07:08:16.993

如果数据库事务声称是 ACID，则 D（持久性）要求提交的事务应在成功提交后立即在崩溃中幸存下来。对于单服务器数据库，这意味着它在磁盘上（磁盘提交）。对于一些现代的多服务器数据库，它也可以意味着事务被发送到一个或多个服务器（网络提交，通常比磁盘快得多），假设多个服务器同时崩溃的概率是小多了。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-17T21:19:04.670

不可能保证提交是原子的，因此现代数据库使用两阶段或三阶段提交策略。请参阅[原子提交](http://en.wikipedia.org/wiki/Atomic_commit)

# checkin - 通过 C# 强制对文件进行 TFS 签入

> ID：213873
> 
> 赞同：3
> 
> 时间：2008-10-17T21:11:04.467
> 
> 标签：checkin

如何指定我总是希望本地文件替换服务器副本，即使 TFS 副本较新？

```
 if (pendingChanges.GetUpperBound(0)>-1)
   ChangeSetNumber = workspace.CheckIn(pendingChanges, filename); 
```

我可以从智能感知中看到，我可以将**checkinoptions**指定为 CheckIn 方法的参数，但我只是找不到我需要输入的内容以使其始终签入并忽略我可能提出的任何冲突。

提前致谢。
**编辑：我找到了一个命令 TF RESOLVE "item" /auto:AcceptYours /recursive 所以我想我修改后的问题是有没有相当于 /auto:AcceptYours 开关的编程？**
NecroEDIT：在签入之前处理冲突

```
Conflict[] 冲突 = workspace.QueryConflicts(new string[] { TFSProject }, true);

foreach（冲突中的冲突）
{
    冲突.Resolution = Resolution.AcceptTheirs;
    工作区.ResolveConflict（冲突）；
}

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T15:09:47.540

签入是原子的——要么全部成功，要么全部失败。 **如果在签入前有任何冲突需要解决，签入操作会抛出异常。**（文档）

您必须评估签入是否存在冲突，然后通过 Workspace.ResolveConflict 方法解决 CheckinConflicts。ResolveConflict 需要 CheckinConflict，而 EvaluateCheckin 的结果（即 CheckinEvaluationResult）包括 CheckinConflicts。

[此页面](http://blogs.msdn.com/buckh/archive/2006/03/20/evaluate-checkin.aspx)可能会有所帮助。

注意： checkinoptions 与您的要求无关。

希望这可以帮助。

# c++ - vswprintf 崩溃

> ID：213875
> 
> 赞同：0
> 
> 时间：2008-10-17T21:11:22.283
> 
> 标签：c++, symbian, posix

使用 10 月 2 日发布的 Symbian S60 第 5 版 SDK，我正在编译/运行（在 sim 上）以下代码片段：

```
void test(wchar_t *dest, int size, const wchar_t *fmt, ...) {
    va_list vl;
    va_start(vl, fmt);
    vswprintf(dest, size, fmt, vl);
    va_end(vl);
}

...

wchar_t str[1024];

// this crashes (2nd string 123 characters (+ \0) equals 248 bytes)
test(str, 1024, L"msg: %S", L"this is a test messagethis is a test messagethis is a test messagethis is a test messagethis is a test messagethis is a tes");

// this works (2nd string 122 characters (+ \0) equals 246 bytes)
test(str, 1024, L"msg: %S", L"this is a test messagethis is a test messagethis is a test messagethis is a test messagethis is a test messagethis is a te"); 
```

对我来说没有任何明显的原因（即使在阅读了[vswprintf](http://www.forum.nokia.com/document/CDL_Extension_S60_3rd_Ed_FP2/GUID-719955DA-415B-420E-9F9B-F6DB37615EC5/html/wprintf.html)手册页一百次之后）我能否弄清楚为什么在 vswprintf 调用长字符串时这段代码会在我身上崩溃:-( 完全相同的代码在 Linux 机器上运行良好. 为 str 分配了足够的内存，加上 vswprintf 无论如何都在检查缓冲区溢出。不幸的是 ... S60 调试器在这次崩溃时没有中断，所以我没有详细信息:-(

有人有什么想法吗？

假设 Symbian 的 vswprintf 例程中存在错误，那么使用 POSIX 兼容代码可能的替代函数是什么？（这应该是一个跨平台的库）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-19T16:05:22.057

我碰巧在 vswprintf 的实现中发现一个内部缓冲区被硬编码为 128 字节。这很可能会在长字符串上导致这样的崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T21:59:52.247

对我来说，这看起来像是介入`vswprintf()`电话会议的工作。`str[]`即使您只能进行汇编级调试，也应该通过密切关注内存中的内容来清楚或多或少地发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-19T06:56:42.817

我现在通过使用 Symbian 函数来“解决”这个问题来执行这个任务：

```
void test(wchar_t *dest, int size, const wchar_t *fmt, ...) {
    VA_LIST args;
    VA_START(args, fmt);

    TPtrC16 fmtPtr((const TUint16*)fmt, wcslen(fmt) + 1);  
    TPtr16  targetPtr((TUint16*)dest, size);

    targetPtr.FormatList(fmtPtr, args);
    targetPtr.ZeroTerminate();

    VA_END(args);
} 
```

（在这种情况下，您实际上必须[使用 %s](http://www.symbian.com/Developer/techlib/v9.1docs/doc_source/guide/Base-subsystem-guide/N10086/BuffersAndStrings/Descriptors/DescriptorsGuide3/FormatStringSyntax.guide.html)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T00:04:21.763

您可以尝试不调用 test() 而是使用 swprintf ——以防错误与 VARARGS 处理有关？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:48:12.537

将 %S 更改为 %s - 将大写变为小写。

在基于 MS 的 printfs 中，%S 表示 unicode 字符，所以这就是 123 字符串失败的原因，它期望每个字符 2 个字节。（注意 %S 不是标准的一部分，所以 Symbian 在这里可能会有所不同）

实际上，我认为这仍然适用于[Symbian](http://www.symbian.com/developer/techlib/v70sdocs/doc_source/reference/cpp/Descriptors/FormatStringSyntax.guide.html#Descriptors.Format-string-syntax)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T22:06:52.840

您可以尝试将`%S`格式说明符更改为`%ls`. 正如我之前的评论中提到的，它们应该是等效的，但是实现中可能存在错误。请注意，该`vswprintf`函数是在 C99 标准中定义的，并且由于还没有任何完全符合 C99 的编译器（我相信），任何给定的实现很可能`vswprintf`不完全符合规范，或者它包含错误（前者比后者更有可能）。

# sharepoint - AllowUnsafeUpdates 的最佳模式

> ID：213882
> 
> 赞同：14
> 
> 时间：2008-10-17T21:14:32.760
> 
> 标签：sharepoint, spweb, spsite

到目前为止，在我的研究中，我发现在 GET 请求操作上设置 AllowUnsafeUpdates 以避免跨站点脚本是不明智的。但是，如果需要允许这样做，那么处理这种情况以减轻任何暴露的正确方法是什么？

如果您绝对需要在 GET 请求上允许网站或站点更新，这是我对可靠模式的最佳初步猜测。

最佳实践？

```
protected override void OnLoad(System.EventArgs e)
{
    if(Request.HttpMethod == "POST")
    {
        SPUtility.ValidateFormDigest();
        // will automatically set AllowSafeUpdates to true
    }

    // If not a POST then AllowUnsafeUpdates should be used only
    // at the point of update and reset immediately after finished

    // NOTE: Is this true? How is cross-site scripting used on GET
    // and what mitigates the vulnerability?
}

// Point of item update

    using(SPSite site = new SPSite(SPContext.Current.Site.Url, SPContext.Current.Site.SystemAccount.UserToken))
    {
        using (SPWeb web = site.RootWeb)
        {
            bool allowUpdates = web.AllowUnsafeUpdates; //store original value
            web.AllowUnsafeUpdates = true;

            //... Do something and call Update() ...

            web.AllowUnsafeUpdates = allowUpdates; //restore original value

        }
    } 
```

对最佳模式的反馈表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-18T22:59:18.187

如果您正在执行任何修改某些内容的操作，那么任何可以说服用户单击链接的人都可以执行该操作。例如，假设您有一个对页面的 GET 请求，该页面允许用户将管理员添加到站点，并且用户单击指向执行 Response.Redirect(" [http://yourserver/_layouts/ admin.aspx?operation=addAdministrator&username=attackerNameHere](http://yourserver/_layouts/admin.aspx?operation=addAdministrator&username=attackerNameHere) ")。

虽然通常 POST 不会对此提供太多保护（没有什么可以阻止某人拥有 <form method="post" action="http://yourserver/_layouts/admin.aspx">），但 SharePoint 有一个表单的概念摘要，其中包含有关生成回发的先前请求的信息（包括用户名）。这大大减少了这种攻击的足迹。

GET 上的 AllowUnsafeUpdates 唯一不是安全问题的情况是，如果您没有接受用户的输入。例如，如果您有一个 Web 部件也记录对列表的访问，那么就不会暴露安全漏洞。

**编辑**：如果您要使用 AllowUnsafeUpdates，则无需将其重置为之前的值。它不会被持久化。这只是在从 GET（或其他情况）执行更新之前需要在 SPWeb 对象上设置的东西

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T18:40:44.643

我会稍微修改特伦特的代表以接受网络更新：

```
public static void DoUnsafeUpdate(this SPWeb web, Action<SPWeb> action)
{
    try
    {
        web.AllowUnsafeUpdates = true;
        action(web);
    }
    finally
    {
        web.AllowUnsafeUpdates = false;
    }
} 
```

[然后扩展 HttpContext 以封装表单摘要的验证，并可选择使用此处描述的技术](http://solutionizing.net/2009/01/06/elegant-spsite-elevation/)进行提升：

```
public static void DoUnsafeUpdate(this HttpContext context, Action<SPWeb> action, bool elevated)
{
    SPWeb web = SPControl.GetContextWeb(context);
    if (!context.Request.HttpMethod.Equals("POST", StringComparison.Ordinal)
        || web.ValidateFormDigest())
        throw new SPException("Error validating postback digest");

    if (elevated)
        web.RunAsSystem(w => w.DoUnsafeUpdate(action));
    else
        web.DoUnsafeUpdate(action);
} 
```

用法：

```
protected override void OnLoad(System.EventArgs e)
{
    Context.DoUnsafeUpdate(web =>
    {
        // Update elevated web
    }, true);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T17:01:03.427

另一种干净的实现方式是使用扩展方法和匿名委托的组合，如下所示：

```
public static void DoUnsafeUpdate(this SPWeb web, Action action)
{
    bool allowUnsafeUpdates = web.AllowUnsafeUpdates;
    web.AllowUnsafeUpdates = true;
    action();
    web.AllowUnsafeUpdates = allowUnsafeUpdates;
} 
```

使用上述扩展方法，您可以执行“不安全更新”操作，如下所示：

```
var web = SPContext.Current.Web;
web.DoUnsafeUpdate(delegate()
{
    // Put your "unsafe update" code here
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-27T05:33:23.103

对于 AllowUnsafeUpdates，我遵循以下流程：

```
if( HttpContext.Current is null )
{
  Do nothing, no need to set AllowUnsafeUpdates to true nor
  to call ValidateFormDigest() because update will be carried out
}
else // HttpContext.Current is NOT null
{
  if( SPContext.Current is null )
  {
    Need to set AllowUnsafeUpdates to true
  }
  else // SPContext.Current is NOT null
  {
    Call ValidateFormDigest()
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T22:35:21.940

不太确定是否值得记住允许不安全更新的先前值。

我想将调用包装在尽可能少的代码中，这样就不会发生对它的嵌套调用。

然后你可以在之后把它变成假的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T12:19:43.447

我使用包装类来处理大多数 SPWeb 对象的操作。这有助于我记住关闭网络，并缓解 unsafeupdates 设置的问题。它有点臃肿，因为我已经修补了新的构造函数和成员。但话又说回来; SPWeb 类也是如此。

用法：

```
using (WebWrapper wrapper = new WebWrapper("http://localhost"))
            {
                wrapper.AllowUnsafeUpdates();

                //Do work on wrapper.
            } 
```

类定义：

```
using System;
using System.Collections.Specialized;
using System.Data;
using System.Diagnostics;
using System.Globalization;
using System.Runtime.Serialization;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Administration;

namespace Skaar.SharePoint.Customization
{
    /// <summary>
    /// A wrapper for a <see cref="SPWeb"/> object.
    /// <remarks>Closes web object on Dispose if applicable.</remarks>
    /// </summary>
    [Serializable]
    [DebuggerDisplay("{Uri} Unsafe:{AllowUnsafeUpdatesSetting} Update:{UpdatePending}")]
    public sealed class WebWrapper : IDisposable, IDeserializationCallback, IEquatable<WebWrapper>
    {
        [NonSerialized] private bool unsafeUpdatesSetting;

        [NonSerialized] private SPWeb web;

        /// <summary>
        /// Determines if the inner web object should be closed.
        /// </summary>
        [NonSerialized] private bool webShouldBeClosed;

        /// <summary>
        /// This value is used in serialization to restore <see cref="Web"/>.
        /// </summary>
        private string webUrl;

        /// <summary>
        /// Creates a new wrapper object.
        /// </summary>
        /// <param name="web">A web that should be closed/disposed when done.</param>
        public WebWrapper(SPWeb web) : this(web, true)
        {
        }

        /// <summary>
        /// Creates a new wrapper object.
        /// </summary>
        /// <param name="web">An inner web object</param>
        /// <param name="webShouldBeClosed">If true, the web object is closed in the <see cref="Dispose()"/> method.</param>
        public WebWrapper(SPWeb web, bool webShouldBeClosed)
        {
            setWeb(web, webShouldBeClosed);
        }

        /// <summary>
        /// Creates a new wrapper object.
        /// </summary>
        /// <param name="webAddress">The address to a web.</param>
        public WebWrapper(Uri webAddress)
        {
            using (SPSite site = new SPSite(webAddress.ToString()))
            {
                string relativeUrl = renderWebRootRelativeUrl(webAddress);
                if (relativeUrl == null)
                {
                    setWeb(site.OpenWeb(), true);
                }
                else
                {
                    setWeb(site.OpenWeb(relativeUrl), true);
                }
            }
        }

        private string renderWebRootRelativeUrl(Uri address)
        {
            for (int i = 0; i < address.Segments.Length; i++)
            {
                string segment = address.Segments[i];
                if (string.Equals(segment, "_layouts/"))
                {
                    string newUrl=string.Join(null, address.Segments, 0, i).Trim('/');
                    return newUrl;
                }
            }
            return null;
        }

        /// <summary>
        /// If true, <see cref="SPWeb.Update"/> will be called in <see cref="Dispose()"/>.
        /// </summary>
        public bool UpdatePending { get; private set; }

        /// <summary>
        /// The setting of the inner web (<see cref="SPWeb.AllowUnsafeUpdates"/>)
        /// </summary>
        public bool AllowUnsafeUpdatesSetting
        {
            get { return Web.AllowUnsafeUpdates; }
        }

        /// <summary>
        /// The inner object.
        /// </summary>
        /// <exception cref="ObjectDisposedException">Exception is thrown if <see cref="IsDisposed"/> is true.</exception>
        public SPWeb Web
        {
            get
            {
                if(IsDisposed)
                {
                    throw new ObjectDisposedException("Web wrapper is disposed.");
                }
                return web;
            }
        }

        /// <summary>
        /// The address of the <see cref="Web"/> wrapped as a <see cref="Uri"/> object.
        /// </summary>
        public Uri Uri
        {
            get { return new Uri(Web.Url); }
        }

        /// <summary>
        /// The address of the <see cref="Web"/> wrapped as a <see cref="Uri"/> object.
        /// </summary>
        public Uri GetUri(SPUrlZone zone)
        {
            return Site.WebApplication.GetResponseUri(zone, Uri.AbsolutePath);
        }

        /// <summary>
        /// Creates a wrapper around the context web.
        /// <remarks>The web will not be closed when wrapper is disposed. Returns null if context is unavailable.</remarks>
        /// </summary>
        public static WebWrapper Context
        {
            get
            {
                return SPContext.Current==null?null:new WebWrapper(SPContext.Current.Web, false);
            }
        }

        /// <summary>
        /// This is a static property wrapping of
        /// the <see cref="CloneOf(SPWeb)"/> method, using
        /// the <see cref="SPContext"/> current web as
        /// parameter.
        /// <remarks>Returns null if context is unavailable.</remarks>
        /// </summary>
        public static WebWrapper CloneOfContext
        {
            get
            {
                if (SPContext.Current != null)
                {
                    SPWeb contextWeb = SPContext.Current.Web;
                    return CloneOf(contextWeb);
                }
                return null;
            }
        }

        /// <summary>
        /// Returns the <see cref="SPWeb.Exists"/> property of the <see cref="Web"/> object.
        /// </summary>
        public bool Exists
        {
            get { return Web != null && Web.Exists; }
        }

        /// <summary>
        /// Gets the <see cref="SPSite"/> object of <see cref="Web"/>.
        /// </summary>
        /// <remarks>This object should not be closed by user code.</remarks>
        public SPSite Site
        {
            get { return web.Site; }
        }

        /// <summary>
        /// Gets the owner defined in <see cref="SPSite.Owner"/>.
        /// </summary>
        public SPUser Owner
        {
            get
            {
                return Site.Owner;
            }
        }

        /// <summary>
        /// Returns a context of the inner <see cref="Web"/>.
        /// </summary>
        public SPContext ContextOfWeb
        {
            get { return SPContext.GetContext(web); }
        }

        /// <summary>
        /// Gets the language of <see cref="Web"/>.
        /// </summary>
        public CultureInfo Locale
        {
            get { return Web.Locale; }
        }

        /// <summary>
        /// Gets the language of the root web.
        /// </summary>
        public CultureInfo LocaleOfRoot
        {
            get
            {
                using (WebWrapper root = Root)
                {
                    return root.Locale;
                }
            }
        }

        /// <summary>
        /// Returns a new <see cref="WebWrapper"/> wrapping the root <see cref="SPWeb"/> of this.
        /// </summary>
        public WebWrapper Root
        {
            get
            {
                if (webShouldBeClosed)
                    using (SPSite site = Site)
                    {
                        return new WebWrapper(site.RootWeb);
                    }
                return new WebWrapper(Site.RootWeb);
            }
        }

        /// <summary>
        /// A wrapper for <see cref="SPWeb.Title"/>.
        /// </summary>
        public string Title
        {
            get { return Web.Title; }
            set { Web.Title = value; }
        }

        /// <summary>
        /// A wrapper for <see cref="SPWeb.ID"/>.
        /// </summary>
        public Guid ID
        {
            get { return Web.ID; }
        }

        #region Web Properties

        [NonSerialized] private bool updatePropertiesPending;

        /// <summary>
        /// A wrapper method to <see cref="Web"/> object's <see cref="SPWeb.Properties"/> indexer.
        /// </summary>
        /// <param name="key">The key to use when fetching property value.</param>
        /// <returns>A string containing the value.</returns>
        public string GetProperty(string key)
        {
            return Web.Properties[key];
        }

        /// <summary>
        /// Sets the value in the <see cref="Web"/> object's <see cref="SPWeb.Properties"/>. Creates a new key, or updates an existing as needed.
        /// </summary>
        /// <param name="key">The key to use when storing the property value.</param>
        /// <param name="value">The value to set in the key.</param>
        /// <remarks>The property <see cref="UpdatePending"/> is set to true.</remarks>
        public void SetProperty(string key, string value)
        {
            if (!Web.Properties.ContainsKey(key))
            {
                Web.Properties.Add(key, value);
            }
            else
            {
                Web.Properties[key] = value;
            }
            updatePropertiesPending = true;
        }

        #endregion

        #region IDeserializationCallback Members

        ///<summary>
        ///Runs when the entire object graph has been deserialized.
        ///</summary>
        ///
        ///<param name="sender">The object that initiated the callback. The functionality for this parameter is not currently implemented. </param>
        public void OnDeserialization(object sender)
        {
            using (SPSite site = new SPSite(webUrl))
            {
                setWeb(site.OpenWeb(), true);
            }
        }

        #endregion

        #region IDisposable Members

        ///<summary>
        ///Closes inner web object if appropriate.
        ///</summary>
        ///<filterpriority>2</filterpriority>
        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        public void Dispose(bool isDisposing)
        {
            if (IsDisposed) return;
            if (isDisposing)
            {
                doDisposeOfWeb();
                IsDisposed = true;
            }
        }

        #endregion

        /// <summary>
        /// Value is true if <see cref="Dispose()"/> method has been called. Object is not in a usable state.
        /// </summary>
        internal bool IsDisposed
        {
            get; private set;
        }

        #region IEquatable<WebWrapper> Members

        /// <summary>
        /// This tests whether the two objects wraps the same web. It may however be two different instances of the same web.
        /// </summary>
        /// <param name="other">Another wrapper object.</param>
        /// <returns>True if <see cref="Uri"/> equals, false otherwise.</returns>
        public bool Equals(WebWrapper other)
        {
            if (other == null)
            {
                return false;
            }
            return Uri.Equals(other.Uri);
        }

        #endregion

        /// <summary>
        /// Reopens the inner <see cref="SPWeb"/> object. May be used when web object needs to be rereferenced in a new security context.
        /// </summary>
        public void ReOpen()
        {
            bool unsafeSetting = AllowUnsafeUpdatesSetting;
            using (SPSite site = new SPSite(Web.Url))
            {
                SPWeb newWeb = site.OpenWeb();
                doDisposeOfWeb();
                web = newWeb;
                web.AllowUnsafeUpdates = unsafeSetting;
                unsafeUpdatesSetting = false;
                webShouldBeClosed = true;
            }
        }

        private void doDisposeOfWeb()
        {
            if (Web == null) return;
            Update(true);
            if (webShouldBeClosed)
            {
                Web.Close();
            }
            else if (Web.Exists)
            {
                Web.AllowUnsafeUpdates = unsafeUpdatesSetting;
            }
            web = null;
        }

        /// <summary>
        /// Calls <see cref="SPWeb.Update"/> on the <see cref="Web"/> object.
        /// </summary>
        public void Update()
        {
            Update(false);
        }

        /// <summary>
        /// Sets <see cref="UpdatePending"/> to <c>true</c>.
        /// </summary>
        public void SetUpdatePending()
        {
            UpdatePending = true;
        }

        /// <summary>
        /// Calls <see cref="SPWeb.Update"/> on the <see cref="Web"/> object.
        /// <param name="onlyIfPending">If true, update will depend on state of the <see cref="UpdatePending"/> property.</param>
        /// </summary>
        public void Update(bool onlyIfPending)
        {
            if (onlyIfPending)
            {
                if (updatePropertiesPending)
                {
                    Web.Properties.Update();
                    updatePropertiesPending = false;
                }
                if (UpdatePending)
                {
                    Web.Update();
                    UpdatePending = false;
                }
            }
            else
            {
                Web.Update();
                UpdatePending = false;
            }
        }

        /// <summary>
        /// Returns the list from <see cref="Web"/> with <see cref="SPList.Title"/> equal to <see cref="title"/>.
        /// </summary>
        /// <param name="title">The <see cref="SPList.Title"/> of an existing list.</param>
        /// <returns>The first list found with the given title, or null, if no list is found.</returns>
        public SPList GetList(string title)
        {
            foreach (SPList list in Web.Lists)
            {
                if (list.Title == title)
                {
                    return list;
                }
            }
            return null;
        }
        /// <summary>
        /// A wrapper method to the <see cref="Web"/> object's <see cref="SPWeb.Lists"/> indexer. 
        /// </summary>
        /// <param name="id">The id of the list to return.</param>
        /// <returns>The list with the supplied id.</returns>
        public SPList GetList(Guid id)
        {
            return Web.Lists[id];
        }

        private void setWeb(SPWeb innerWeb, bool shouldBeClosed)
        {
            if (innerWeb == null || !innerWeb.Exists)
            {
                throw new ArgumentException("Web does not exist", "innerWeb");
            }
            web = innerWeb;
            webShouldBeClosed = shouldBeClosed;
            unsafeUpdatesSetting = innerWeb.AllowUnsafeUpdates;
            AllowUnsafeUpdates();
            webUrl = web.Url;
        }

        /// <summary>
        /// Creates a new <see cref="SPWeb"/> object using the
        /// url of the <see cref="web"/> parameter and wraps it
        /// in a new wrapper object. The web will be
        /// closed when the wrapper is disposed.
        /// The cloning is done using the <see cref="SPWeb.Url"/>, thus no security context is transferred to the new web.
        /// </summary>
        /// <remarks>Use this to create a clone of the context web.</remarks>
        /// <param name="web">The web to clone.</param>
        /// <returns>A new wrapper object.</returns>
        public static WebWrapper CloneOf(SPWeb web)
        {
            using (SPSite site = new SPSite(web.Url))
            {
                return new WebWrapper(site.OpenWeb());
            }
        }

        /// <summary>
        /// Creates a new <see cref="SPWeb"/> object using the
        /// <see cref="Web"/> of the <see cref="web"/> parameter and wraps it
        /// in a new wrapper object. The web will be
        /// closed when the wrapper is disposed.
        /// </summary>
        /// <remarks>Use this to create a clone of the context web.</remarks>
        /// <param name="web">The wrapper to clone.</param>
        /// <returns>A new wrapper object.</returns>
        public static WebWrapper CloneOf(WebWrapper web)
        {
            return CloneOf(web.Web);
        }

        /// <summary>
        /// Sets the AllowUnsafeUpdates property to true on the
        /// wrapped web object.
        /// <remarks>
        /// The setting is resat back in the dispose method, unless the
        /// web itself is closed.
        /// </remarks>
        /// </summary>
        public void AllowUnsafeUpdates()
        {
            Web.AllowUnsafeUpdates = true;
        }

        /// <summary>
        /// Returns the url of the inner web.
        /// </summary>
        /// <returns>A value that equals <see cref="Web"/> <see cref="SPWeb.Url"/> property.</returns>
        public override string ToString()
        {
            return webUrl;
        }

        /// <summary>
        /// Returns a new <see cref="WebWrapper"/> object wrapping a new copy of the inner <see cref="Web"/> object.
        /// The cloning is done using the <see cref="SPWeb.Url"/>, thus no security context is transferred to the new web.
        /// </summary>
        /// <remarks>The static method <see cref="CloneOf(SPWeb)"/> is used on the <see cref="Web"/> property.</remarks>
        /// <returns>A new wrapper.</returns>
        public WebWrapper Clone()
        {
            return CloneOf(Web);
        }

        /// <summary>
        /// Implicitly wraps the web object in a <see cref="WebWrapper"/> object.
        /// </summary>
        /// <param name="web">The web to wrap.</param>
        /// <returns>A new wrapper object. The original web may be accessed through the <see cref="Web"/> property.</returns>
        public static implicit operator WebWrapper(SPWeb web)
        {
            return new WebWrapper(web, false);
        }

        /// <summary>
        /// Explicitly extracts the <see cref="Web"/> value from the <see cref="wrapper"/>.
        /// </summary>
        /// <param name="wrapper">The object wrapping the <see cref="SPWeb"/> to extract.</param>
        /// <returns>The inner <see cref="Web"/> of <see cref="wrapper"/>.</returns>
        /// <remarks>The returned <see cref="SPWeb"/> object should be properly disposed after use.</remarks>
        public static explicit operator SPWeb(WebWrapper wrapper)
        {
            wrapper.DoNotDisposeInnerWeb();
            return wrapper.Web;
        }

        /// <summary>
        /// Wrapper method for <see cref="SPWeb.GetList"/> on <see cref="Web"/> object.
        /// </summary>
        /// <param name="uri">A site relative uri to the list.</param>
        /// <returns>A list if found.</returns>
        public SPList GetList(Uri uri)
        {
            return web.GetList(uri.ToString());
        }

        /// <summary>
        /// Wrapper method for <see cref="SPWeb.GetSiteData"/> on <see cref="Web"/> object.
        /// </summary>
        /// <returns>The results of the query,</returns>
        public DataTable GetSiteData(SPSiteDataQuery query)
        {
            return Web.GetSiteData(query);
        }

        /// <summary>
        /// Creates a new <see cref="SPWeb"/> as a sub web to this.
        /// </summary>
        /// <param name="url">The proposed local url of the new web. The nearest available is selected.</param>
        /// <param name="name">The title of the new web.</param>
        /// <param name="description">The description of the new web.</param>
        /// <param name="language">The language of the new web. <remarks>If the language is not supported, the language of this is used.</remarks></param>
        /// <param name="template">The site template to use.</param>
        /// <returns>The new web wrapped in a new <see cref="WebWrapper"/> object.</returns>
        [DebuggerStepThrough]
        //debugger step through is to prevent this method to break when debugging, as it throws exceptions by [poor] design.
        public WebWrapper CreateSubWeb(string url, string name, string description, uint language,
                                       string template)
        {
            SPWeb newWeb;
            try
            {
                newWeb = Web.Webs.Add(findSuitableWebUrl(url), name, description, language, template, true, false);
            }
            catch (SPException err)
            {
                if (err.ErrorCode == -2130575266)
                {
                    //language not supported. Fallback to parent web language
                    newWeb = Web.Webs.Add(findSuitableWebUrl(url), name, description, Web.Language, template, true,
                                          false);
                }
                else
                    throw;
            }
            return new WebWrapper(newWeb);
        }

        private string findSuitableWebUrl(string proposedName)
        {
            StringCollection names = new StringCollection();
            names.AddRange(Web.Webs.Names);
            int suffixIndex = 0;
            const int maxIterations = 100000;
            string name = proposedName;
            while (names.Contains(name) && suffixIndex < maxIterations)
            {
                name = string.Format("{0}_{1}", proposedName, suffixIndex++);
            }
            return name;
        }

        /// <summary>
        /// Calling this method will inhibit the default behaviour of closing the web on disposal.
        /// </summary>
        /// <remarks>Use with caution.</remarks>
        internal void DoNotDisposeInnerWeb()
        {
            webShouldBeClosed = false;
        }

    }
} 
```

# jquery - 在 jQuery 中将变量传递给 .load(html)

> ID：213898
> 
> 赞同：1
> 
> 时间：2008-10-17T21:20:08.397
> 
> 标签：jquery

假设我有这样的 jquery 代码：

```
html += '<div class="index">' + item.index + '</div>';

// many more similar html += statements

// load items
$('div').append(html); 
```

这个 html 太难以管理了，所以我想把它移到一个外部文件中。在我加载它时将变量传递给 HTML 的最佳方法是什么？我只需要加载它然后将 jquery 命令放在第一个 JS 文件中吗？看起来就是这样，但我宁愿使用更像模板的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T21:55:15.627

将 HTML 放在它所属的位置，在 HTML 文件中。然后使用 jQuery 上的模板插件来扩展它。

一些模板插件：

*   [js中继器](http://plugins.jquery.com/project/jsrepeater)
*   [j模板](http://plugins.jquery.com/project/jTemplates)
*   [无模板](http://plugins.jquery.com/project/noTemplate)

# perl - 在 Perl 中，如何在输入到达后立即处理，而不是等待换行符？

> ID：213901
> 
> 赞同：6
> 
> 时间：2008-10-17T21:22:29.030
> 
> 标签：perl

我想从 Perl 运行一个子命令（或将其通过管道传输到 Perl 脚本中）并让脚本立即处理命令的输出，而不是等待超时、换行符或一定数量的块。例如，假设我想用方括号将每个输入块括起来。当我像这样运行脚本时：

```
$ ( echo -n foo ; sleep 5 ; echo -n bar ; sleep 5; echo baz) | my_script.pl 
```

我希望输出是这样的，每一行在前一行之后出现五秒：

```
[foo]
[bar]
[baz] 
```

我怎么做？

这有效，但真的很难看：

```
#! /usr/bin/perl -w

use strict;
use Fcntl;

my $flags = '';
fcntl(STDIN, F_GETFL, $flags);
$flags |= O_NONBLOCK;
fcntl(STDIN, F_SETFL, $flags);

my $rin = '';
vec($rin,fileno(STDIN),1) = 1;
my $rout;

while (1) {
  select($rout=$rin, undef, undef, undef);
  last if eof();

  my $buffer = '';

  while (my $c = getc()) {
    $buffer .= $c;
  }

  print "[$buffer]\n";
} 
```

有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T22:09:35.910

来自 perlfaq5：[如何从文件中读取单个字符？从键盘？](http://perldoc.perl.org/perlfaq5.html#How-can-I-read-a-single-character-from-a-file%3f--From-the-keyboard%3f). 您可能还想阅读[如何判断文件句柄上是否有字符等待？](http://perldoc.perl.org/perlfaq5.html#How-can-I-tell-whether-there's-a-character-waiting-on-a-filehandle%3f). 轮询文件句柄。如果那里有一个字符，读取它并重置一个计时器。如果那里没有字符，请再试一次。如果您已重试并经过了一段时间，请处理输入。

阅读角色后，由您决定如何处理它们。读取单个字符的所有灵活性带来了处理它们的额外工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-18T21:35:43.337

[Term::ReadKey](http://search.cpan.org/perldoc?Term::ReadKey)可以为您做到这一点。特别是设置 ReadKey() 模式为您进行轮询。

```
use Term::ReadKey;

$| = 1;
while( my $key = ReadKey(10) ) {
    print $key;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T21:45:33.117

如果每个字符之间有时间，您可能能够检测到停顿。

Perl 也进行行输入——如果你不使用 getc，你应该能够在 foo、bar 等的末尾添加换行符，perl 会给你每一行。

如果您不能添加换行符，并且不能依赖暂停，那么您究竟希望系统做什么来告诉 perl 它启动了一个新命令？就 perl 而言，有一个标准输入管道，它正在从中获取数据，当您执行新命令时，标准输入管道中没有任何内容可以告诉您。

您可能会考虑以下内容：

```
$ echo "( echo -n foo ; sleep 5 ; echo -n bar ; sleep 5; echo baz)" | my_script.pl 
```

或者

```
$ my_script.pl$ "echo -n foo ; sleep 5 ; echo -n bar ; sleep 5; echo baz" 
```

并修改您的 perl 程序以解析输入“命令行”并执行每个任务，根据需要使用标准输出。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T21:31:44.580

您没有提到如何在 Perl 脚本中读取输入，但您可能想查看该[`getc`](http://perldoc.perl.org/functions/getc.html)函数：

```
$|++; # set autoflush on output
while ($c = getc(STDIN)) {
    print $c;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T21:34:52.953

请参阅[如何更改 Open2 输入缓冲](http://perlmonks.org/?node_id=300044)。（基本上，您必须让其他程序认为它正在与 tty 对话。）

# macos - 修改 Spotlight 导入器外部文件的 Spotlight 元数据？

> ID：213906
> 
> 赞同：2
> 
> 时间：2008-10-17T21:25:16.373
> 
> 标签：macos, cocoa, spotlight

我想在我的应用程序中修改文件的 Spotlight 元数据属性（即不在 Spotlight 导入器中），但我找不到任何 API 可以这样做。是否可以？指向相关文档的指针是理想的。

如果它有帮助，这是我的用例：

> 我想在核心数据存储中存储对文件系统路径的引用。理想情况下，即使移动了文件，我也应该能够找到文件，可能跨越已安装的卷。我的理解是归档的 FSRef 或 AliasRecord 不会起到作用，因为它们对于跨已安装卷的移动并不是不变的。所以我的计划是存储一个 URL 并将一个 UUID（也存储在数据存储中）添加到文件的 Spotlight 元数据中，这样如果应用程序时 URL 不再指向文件，我就可以对该 UUID 执行 Spotlight 查询回去寻找文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T21:06:15.457

经过进一步研究，使用 Spotlight 并不是该用例的最佳解决方案。AliasRecord 是更好的文件持久存储。它会自动跟踪移动/重命名/等。[您可以在此处](http://developer.apple.com/documentation/Carbon/Reference/Alias_Manager/Reference/reference.html)阅读有关 AliasRecords的更多信息。Chris Hansen 为 AliasRecords 编写了一个 Objective-C 包装器，`BDAlias`. 它目前可从[rentzsch.com](http://rentzsch.com/svn/trunk/cocoa/BDAlias/) SVN 获得。

# c++ - "std::endl" 与 "\n"

> ID：213907
> 
> 赞同：635
> 
> 时间：2008-10-17T21:25:17.107
> 
> 标签：c++, coding-style, iostream, c++-faq

许多 C++ 书籍都包含这样的示例代码......

```
std::cout << "Test line" << std::endl; 
```

...所以我也一直这样做。但是我已经看到很多这样的工作开发人员的代码：

```
std::cout << "Test line\n"; 
```

是否有技术上的理由比另一个更喜欢一个，或者这只是编码风格的问题？

* * *

## 回答 #1

> 赞同：528
> 
> 时间：2008-10-17T21:56:50.490

假设文件以文本模式打开，则不同的行尾字符无关紧要，除非您要求二进制文件，否则您会得到这样的结果。编译后的程序将为编译的系统写出正确的东西。

唯一的区别是[`std::endl`](http://en.cppreference.com/w/cpp/io/manip/endl)刷新输出缓冲区，而`'\n'`不是。如果您不想频繁刷新缓冲区，请使用`'\n'`. 如果你这样做（例如，如果你想获得所有输出，并且程序不稳定），请使用`std::endl`.

* * *

## 回答 #2

> 赞同：280
> 
> 时间：2008-10-17T22:43:44.513

可以通过以下方式说明差异：

```
std::cout << std::endl; 
```

相当于

```
std::cout << '\n' << std::flush; 
```

所以，

*   如果`std::endl`要强制立即刷新到输出，请使用。
*   如果`\n`您担心性能（如果您使用`<<`运算符，则可能不是这种情况），请使用。

我`\n`在大多数线路上使用。
然后`std::endl`在段落末尾使用（但这只是一种习惯，通常不需要）。

与其他声明相反，`\n`仅当流将转到文件（`std::cin`并且`std::cout`是特殊但仍然是文件（或类似文件））时，字符才会映射到正确的平台行尾序列。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2008-10-17T21:28:21.297

可能存在性能问题，`std::endl`强制刷新输出流。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-11-17T22:29:29.693

如果您要使用，那里隐含另一个函数调用`std::endl`

```
a) std::cout << "Hello\n";
b) std::cout << "Hello" << std::endl; 
```

a) 呼叫操作员`<<`一次。
b) 呼叫接线员`<<`两次。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2014-08-29T13:58:14.080

我记得在标准中读过这个，所以这里是：

请参阅 C11 标准，该标准定义了标准流的行为方式，因为 C++ 程序与 CRT 接口，C11 标准应在此处管理刷新策略。

> ISO/IEC 9899:201x
> 
> 7.21.3 §7
> 
> 在程序启动时，三个文本流是预定义的，不需要显式打开——标准输入（用于读取常规输入）、标准输出（用于写入常规输出）和标准错误（用于写入诊断输出）。最初打开时，标准错误流没有完全缓冲；当且仅当可以确定流不引用交互式设备时，标准输入和标准输出流才被完全缓冲。
> 
> 7.21.3 §3
> 
> 当流未缓冲时，字符应尽快从源或目标出现。否则，字符可能会作为一个块累积并传输到主机环境或从主机环境传输。当一个流被完全缓冲时，当缓冲区被填满时，字符将作为一个块传输到主机环境或从主机环境传输。当流被行缓冲时，当遇到换行符时，字符将作为块传输到主机环境或从主机环境传输。此外，当缓冲区被填满时，当在非缓冲流上请求输入时，或者当在需要从主机环境传输字符的行缓冲流上请求输入时，字符将作为块传输到主机环境.

这意味着当`std::cout`且**仅当**它们引用非交互式设备时，它们才会`std::cin`被完全缓冲。换句话说，如果标准输出连接到终端，那么行为没有区别。

 **但是，如果`std::cout.sync_with_stdio(false)`被调用，则`'\n'`即使对交互式设备也不会造成刷新。否则`'\n'`等效于`std::endl`除非管道到文件：[c++ ref on std::endl](http://en.cppreference.com/w/cpp/io/manip/endl)。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-10-17T21:33:32.207

他们都将写入适当的行尾字符。除此之外， endl 将导致缓冲区被提交。在进行文件 I/O 时通常不想使用 endl，因为不必要的提交会影响性能。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-02-22T01:57:21.803

没什么大不了的，但是endl在[boost::lambda中](http://www.boost.org/doc/html/lambda.html)[不起作用](http://www.crystalclearsoftware.com/cgi-bin/boost_wiki/wiki.pl?Suggestions_-_Lambda_Library)。

```
(cout<<_1<<endl)(3); //error

(cout<<_1<<"\n")(3); //OK , prints 3 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2010-02-17T01:21:12.987

如果您使用 Qt 和`endl`，您可能会意外地使用不正确的`endl`结果，这会给您带来非常令人惊讶的结果。请参阅以下代码片段：

```
#include <iostream>
#include <QtCore/QtCore> 
#include <QtGui/QtGui>

// notice that there is no "using namespace std;"
int main(int argc, char** argv)
{
    QApplication qapp(argc,argv);
    QMainWindow mw;
    mw.show();
    std::cout << "Finished Execution!" << endl;
    // This prints something similar to: "Finished Execution!67006AB4"
    return qapp.exec();
} 
```

请注意，我写`endl`的不是`std::endl`（这本来是正确的），并且显然在*qtextstream.h*`endl`中定义了一个函数（它是 QtCore 的一部分）。

 *使用`"\n"`而不是`endl`完全回避任何潜在的命名空间问题。这也是一个很好的例子，为什么将符号放入全局命名空间（就像 Qt 默认情况下所做的那样）是一个坏主意。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-05-24T11:12:32.720

机械手`std::endl`相当于 。`'\n'`但`std::endl`总是刷新流。

```
std::cout << "Test line" << std::endl; // with flush
std::cout << "Test line\n"; // no flush 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2021-08-07T12:47:42.093

我从未见过有人说`'\n'`受 cout 格式影响的事情：

```
#include <iostream>
#include <iomanip>

int main() {
    std::cout << "\\n:\n" <<  std::setw(2) << std::setfill('0') << '\n';
    std::cout << "std::endl:\n" << std::setw(2) << std::setfill('0') << std::endl;
} 
```

输出：

```
\n:
0
std::endl: 
```

请注意，由于`'\n'`是一个字符且填充宽度设置为 2，因此之前只打印了 1 个零`'\n'`。

我在任何地方都找不到任何关于它的信息，但它可以用 clang、gcc 和 msvc 重现。

当我第一次看到它时，我非常困惑。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-17T21:53:29.717

我一直有只使用 std::endl 的习惯，因为它很容易让我看到。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-10-27T23:32:02.223

如果您打算在您自己的笔记本电脑以外的任何其他设备上运行您的程序，请永远不要使用该`endl`语句。特别是如果您要编写很多短行，或者我经常在文件中看到单个字符。使用`endl`is known to kill 像 NFS 这样的网络文件系统。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-03-27T11:58:16.470

[参考](http://en.cppreference.com/w/cpp/io/manip/endl)这是一个**仅输出 I/O 操纵器**。

**`std::endl`**在输出序列 os 中插入一个换行符并刷新它，就好像通过调用`os.put(os.widen('\n'))`后跟`os.flush()`.

**何时使用：**

这个机械手可以用来立即产生一行**输出**，

**例如**

> 当显示来自长时间运行的进程的输出时，记录多个线程的活动或记录可能意外崩溃的程序的活动。

**还**

> 如果生成的进程执行任何屏幕 I/O，则在调用 std::system 之前还需要显式刷新 std::cout。在大多数其他常见的交互式 I/O 场景中，std::endl 与 std::cout 一起使用时是多余的，因为来自 std::cin 的任何输入、到 std::cerr 的输出或程序终止都会强制调用 std::cout .flush()。某些来源鼓励使用 std::endl 代替 '\n' 可能会显着降低输出性能。

# c# - 时间：2019-05-10 标签：c#queryms access against sql server

> ID：213908
> 
> 赞同：1
> 
> 时间：2008-10-17T21:25:24.453
> 
> 标签：c#, sql-server, database, linq, ms-access

我被要求为一所大学设置课程传单系统。无论过去出于何种原因，他们当前的系统未链接到他们的实际课程文件，他们希望关闭此链接，以便课程传单与实际课程代码相关。不幸的是，他们的课程文件是一个链接到他们许多现有系统的 ms 访问数据库（不能轻易升级/移动）。由于课程传单正在网络上发布，因此他们的托管要求使用 sql server 数据库。

这意味着我需要在内部在两者之间进行查询，这样他们就可以在没有传单的情况下计算出他们有哪些课程，我不想将临时查询添加到访问数据库来执行此操作。

在 C# 中执行此操作的最佳方法是什么，我认为 LINQ 可以做到但还没有学会，我应该为这个项目学习它还是有更简单的方法？

我想过一个链接服务器到 ms 访问数据库，但这需要将数据库移动到 sql 服务器。据我所知，另一个困难的任务是数据库链接是硬编码的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T21:43:58.097

课程文件多久更改一次？一天五十次？每月一次？

在 SQL Server 数据库中创建适当的表怎么样？然后每隔一段时间（尽可能频繁地保持合理的最新状态），清除这些表并从 Access 数据库中重新填充它们。您可以将其设置为每天早上 3 点或其他时间运行。或者，您可以在表格发生重大变化时定期执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T21:34:24.560

为什么需要 SQL 服务器的访问文件来创建链接服务器？只需将其放在具有适当安全性的网络共享上，然后像这样创建您的链接服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T21:35:21.377

补充一点，LINQ 与 SQL 或 Access 或其他任何东西无关，它用于在内存对象集合中进行查询。一些 linq 提供程序允许您使用它来访问有问题的数据库，但我认为在这种情况下它们不会有太大帮助。

# actionscript - Actionscript 中内联闭包/函数委托的使用

> ID：213912
> 
> 赞同：5
> 
> 时间：2008-10-17T21:26:56.027
> 
> 标签：actionscript, inline-method

为什么在 Actionscript 中很少使用内联闭包？它们非常强大，我认为非常具有可读性。我几乎看不到有人使用它们，所以也许我只是在看错误的代码。Google 在他们的 Google Maps API for Flash 示例中使用它们，但我认为那是我见过它们的唯一地方。

我喜欢它们，因为您可以访问定义它们的范围内的局部变量，并且您将逻辑保留在一种方法中，并且最终不会产生许多您必须为其命名的函数。

使用它们有什么注意事项吗？它们的工作方式与 C# 中的工作方式几乎相同吗？

实际上我才刚刚发现 AS3 支持它们，我很生气，因为我以为我读到它们在 AS# 中已被弃用。所以我又开始使用它们了！

```
private function showPanel(index:int):void {    

_timer = new Timer(1000, 1);        
_timer.addEventListener(TimerEvent.TIMER, function(event:Event):void 
{
    //  show the next panel
    showPanel(index++);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T21:34:41.313

需要注意的最大问题是内联闭包中通常没有定义“this”。有时您可以设置一个“this”，但并不总是可以设置正确的“this”，这取决于您使用它们的方式。

但我要说的是，我处理过的大多数 Flex 代码在整个代码中都有大量的内联闭包——因为回调是完成工作的唯一方法，而且通常你不需要带出一个完整的单独函数.

有时当嵌套的函数太多时，我会用函数中的函数变量稍微打破它；这有助于我通过为函数提供标签但保留内联闭包的一些特征（例如访问局部变量）来组织一点。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T22:30:23.127

另一个问题是，当涉及到闭包时，垃圾收集被破坏了（至少在 Flash 9 中）。给定闭包的第一个实例（从词法的角度来看）永远不会被垃圾收集 - 以及范围链中闭包引用的任何其他内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T21:43:33.060

我找到了最初让我不想这样做的原因，但我忘记了细节：

[http://livedocs.adobe.com/flex/3/html/16_Event_handling_6.html#119539](http://livedocs.adobe.com/flex/3/html/16_Event_handling_6.html#119539)

（这就是米奇提到的——就“this”关键字超出范围而言）

这就是 Adob​​e 的答案，但是我更可能需要引用局部变量而不是“this”。

其他人如何解读 Adob​​e 的建议？

# javascript - Grails 中的 Javascript 回发

> ID：213939
> 
> 赞同：2
> 
> 时间：2008-10-17T21:39:16.127
> 
> 标签：javascript, grails

有谁知道如何使用 javascript 在 Grails 应用程序中发起 POST 请求。具体来说，我希望能够在更改下拉框中的选定项目时发布。

我试过使用 jQuery 和 $.post() 方法。它成功调用了我的控制器操作，但我不确定如何让页面刷新响应内容。画面未更新。有任何想法吗？这不需要是异步的。

我不依赖于使用 jQuery，我只是想弄清楚如何从 javascript 进行 POST。

安德鲁

我的客户端 javascript

```
<script type="text/javascript" language="javascript">
  $(document).ready( function() {
     $("#ownerId").change(function() {
       $.post("/holidayCards/clientContact/ownerSelected", {ownerId: this.value});
      });
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T21:40:43.783

在 DOM 中找到您要查找的表单对象，然后在其上调用 .submit()。您的页面上是否有多个表格或多个表格？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T17:22:37.813

您提到它正在调用您的控制器操作，因此它将信息返回到问题所在的页面，对吗？

尝试这样的事情：

```
 def ajaxRandom = {
        def randomQuote = quoteService.getRandomQuote()
        response.outputStream << "<q>${randomQuote.content}</q>" 
    } 
```

您所有的 gsp 页面需要是：

```
<q>${quote.content}</q> 
```

# visual-studio-2008 - how to change silverlight hosting from "test page" to "web project"?

> ID：213941
> 
> 赞同：0
> 
> 时间：2008-10-17T21:40:33.957
> 
> 标签：visual-studio-2008, silverlight

I have a project with two silverlight apps (foo1 and foo2) and an ASP.NET web service (foo.web). When I created foo1, I configured it to be hosted in my web app by selecting "Link this Silverlight control into an existing web site" and then choosing foo.web as the site. However when I created foo2, I chose "Automatically generate a test page to host Silverlight at build time instead".

I originally did this because I was not using the ASP.NET functionality for anything except hosting the page, and I thought I could save some mess. However after doing a bit of development, I learn that I will get a security error if I try to use a WebClient when my application is hosted on a plain HTML page. So it turns out I must host it through the ASP.NET application after all.

When I look at the projects' property pages, I don't see any difference that corresponds to my hosting choice. I thought it would be under the "Silverlight" or "Debug" tabs, but those look the same in both projects.

What do need to change in project foo2 so that it will be hosted by an ASP.NET page in the web application (foo.web) instead of being hosted on a generated HTML page?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T22:19:29.150

The change is on the web project. Go to the Silverlight section and choose which Silverlight applications you'll be hosting in the web project. It will also generate test pages for you if you want.

# c - “错误：‘struct udphdr’没有名为‘source’的成员”……嗯？

> ID：213950
> 
> 赞同：0
> 
> 时间：2008-10-17T21:45:29.717
> 
> 标签：c, linux, unix, ngrep

我正在尝试编译一个名为 ngrep 的程序，当我运行 configure 时，事情似乎进展顺利，但是当我运行 make 时，我得到：

```
ngrep.c: In function ‘process’:
ngrep.c:544: error: ‘struct udphdr’ has no member named ‘source’
ngrep.c:545: error: ‘struct udphdr’ has no member named ‘dest’
make: *** [ngrep.o] Error 1 
```

这是什么意思，我该如何解决？没有早期的警告或错误提示问题的根源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T22:16:11.497

发现问题：

```
#ifdef HAVE_DUMB_UDPHDR
                printf("%s:%d -", inet_ntoa(ip_packet->ip_src), ntohs(udp->source));
                printf("> %s:%d", inet_ntoa(ip_packet->ip_dst), ntohs(udp->dest));
#else
                printf("%s:%d -", inet_ntoa(ip_packet->ip_src), ntohs(udp->uh_sport));
                printf("> %s:%d", inet_ntoa(ip_packet->ip_dst), ntohs(udp->uh_dport));
#endif 
```

Apparently, configure has a bug in this test, and it thinks my system has the "dumb" udphdr, even though it doesn't. Changing the first line to "#if 0" fixes the problem.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T21:59:46.740

好吧，有一个名为 udphdr 的结构（可能是 udp header 的缩写）。并且程序的某些部分假定结构具有它没有的成员 source 和 dest。

查看文件 ngrep.c 的第 544 和 545 行以找到有问题的行。

可能的原因：

*   类型名称类型错误。
*   struct 没有完全定义。
*   使用错误的结构。

编辑：可能相关的问题：[http ://ubuntuforums.org/showthread.php?t=371871](http://ubuntuforums.org/showthread.php?t=371871)

# c++ - 链接到 MFC 项目的没有 mfc 的 c++ 静态库是否会抛出 bad_alloc 或 CMemoryException*？

> ID：213952
> 
> 赞同：5
> 
> 时间：2008-10-17T21:45:59.170
> 
> 标签：c++, exception, mfc

我正在为 MFC 应用程序开发一个大型、老化的代码库。随着时间的推移，许多开发人员已经对代码进行了研究，因此，我们在整个代码中使用了三种不同的方式来处理 new 分配失败的可能性。

第一种方法是在 new 的结果上测试 NULL。我们不使用 nothrownew.obj 所以这显然是一个需要清理的错误。

第二个是捕获CMemoryException*（是的，编译器中启用了C++异常）。据我了解，MFC 覆盖了标准运算符 new，而是抛出了这个东西。我相当肯定第二种方法在 MFC 应用程序本身中是正确的。MFC 用其奇怪的 CMemoryException 抛出版本覆盖了新的。

最后一个来自我们的基础，他们擅长 C++，但不一定是 MFC 程序员。他们正在捕获 const std::bad_alloc&。

我真正不知道的是链接到应用程序的静态库会发生什么。这是使用 bad_alloc 生命的绝大多数代码。假设这些库不是用 MFC 或 ATL 编译的，并且只用标准 C++ 编写，他们能期望捕获 bad_alloc 吗？或者，它们链接的应用程序中是否存在 MFC 会用全局 new 运算符感染它们，并使它们的尝试完全失败，因为分配不当？

如果您有答案，您能否解释一下这是如何工作的，或者指出正确的参考资料来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T22:51:24.687

这将取决于要链接到应用程序的静态库的编译选项。

如果使用配置编译库以使用**静态**标准 C++ 运行时，那么我希望`operator new`从标准 C++ 运行时调用。

**如果使用标准 C++ 运行时DLL**的配置编译库，则这些函数的解析将延迟到程序加载，并且*应该*解析为 MFC 替换`operator new`.

我还提供了一个指向这篇 Herb Sutter[文章](http://www.gotw.ca/publications/mill16.htm)的链接，该文章关于句柄分配错误，您可能会发现它很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:02:20.307

恭喜——你似乎难倒了我们所有人。:-)

理论上，如果 MFC 为全局函数提供了重载，那么程序中的*所有*代码`new`都应该使用它。但由于静态库是在不知道这一点的情况下编译的，我不能肯定地说它会。

 *我能建议的最好的方法是编写一些测试代码来找出答案。（在接下来的几个小时内我将无法访问我的 Windows 系统，或者我会自己这样做并给你一个答案。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-09T15:41:28.213

我做了一些 MFC 代码研究（在 VC2010 中）。以下是一些事实。

1.  MFC 抛出一个指向名为“_simpleMemoryException”的全局 CMemoryException 实例的指针（另请参见 AfxThrowMemoryException()）
2.  它是一个 m_bAutoDelete 为假的 CException。

想法：如果可以更改 c++-only-static-libraries，您可以将声明`class CException;`和/或转发`class CMemoryException;`到根命名空间。

`catch (CMemoryException* pEx) {...}`在块所在的每个位置和/或`catch (CException* pEx) {...}`处添加一个 catch-block `std::bad_alloc-catch`。由于捕获的指针是指向全局对象的指针，因此不需要调用`pEx->Delete();`.

这样，c++-only-static-libraries 不需要包含`afx.h`或/和链接到 MFC。我已经在**VC2010**中尝试过，它工作正常。（仅当启用 RTTI，并且仅当没有人将 MFC-NewHandler 与 AfxSetNewHandler 更改为 default-MFC-NewHandler 以外的其他内容时`AfxNewHandler`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-09T15:02:24.083

您可以更改 MFC 的抛出行为`AfxSetNewHandler(_PNH pfnNewHandler)`并提供指向您自己的`NewHandler`函数的指针。然后这个函数应该抛出一个`std::bad_alloc`异常。但是现在 MFC-program-parts 遇到了捕获`std::bad_alloc`.

# c++ - Boost phoenix 或 lambda 库问题：从 std::vector 中删除元素

> ID：213953
> 
> 赞同：4
> 
> 时间：2008-10-17T21:48:05.127
> 
> 标签：c++, boost-lambda, boost-phoenix

我最近遇到了一个问题，我认为 boost::lambda 或 boost::phoenix 可以帮助解决，但我无法正确使用语法，所以我用了另一种方式。我想要做的是删除“字符串”中小于一定长度而不是另一个容器中的所有元素。

这是我的第一次尝试：

```
std::vector<std::string> strings = getstrings();
std::set<std::string> others = getothers();
strings.erase(std::remove_if(strings.begin(), strings.end(), (_1.length() < 24 &&  others.find(_1) == others.end())), strings.end()); 
```

我最终是如何做到的：

```
struct Discard
{
    bool operator()(std::set<std::string> &cont, const std::string &s)
    {
        return cont.find(s) == cont.end() && s.length() < 24;
    }
};

lines.erase(std::remove_if( lines.begin(), lines.end(), boost::bind<bool>(Discard(), old_samples, _1)), lines.end()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T23:57:49.280

您需要 boost::labmda::bind 来进行 lambda-ify 函数调用，例如 length < 24 部分变为：

```
bind(&string::length, _1) < 24 
```

编辑

请参阅“Head Geek”的帖子了解为什么 set::find 很棘手。他得到它来解决正确的 set::find 重载（所以我复制了那部分），但他错过了一个重要的 boost::ref() ——这就是为什么与 end() 的比较总是失败（容器被复制） .

```
int main()
{
  vector<string> strings = getstrings();
  set<string> others = getothers();
  set<string>::const_iterator (set<string>::*findFn)(const std::string&) const = &set<string>::find;
  strings.erase(
    remove_if(strings.begin(), strings.end(),
        bind(&string::length, _1) < 24 &&
        bind(findFn, boost::ref(others), _1) == others.end()
      ), strings.end());
  copy(strings.begin(), strings.end(), ostream_iterator<string>(cout, ", "));
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T00:37:14.737

主要问题，除了`bind`调用（亚当米茨在那部分是正确的），`std::set<std::string>::find`是一个重载的函数，所以你不能直接在`bind`调用中指定它。您需要告诉编译器使用*哪个* `find`，如下所示：

```
using namespace boost::lambda;
typedef std::vector<std::string> T1;
typedef std::set<std::string> T2;

T1 strings = getstrings();
T2 others = getothers();

T2::const_iterator (T2::*findFn)(const std::string&) const=&T2::find;
T2::const_iterator othersEnd=others.end();

strings.erase(std::remove_if(strings.begin(), strings.end(),
    (bind(&std::string::length, _1) < 24
        && bind(findFn, boost::ref(others), _1) == othersEnd)),
    strings.end()); 
```

这可以编译，但它不能正常工作，原因我还没有弄清楚......`find`函数永远不会返回`others.end()`，所以它永远不会删除任何东西。还在做那部分。

编辑：更正，`find`函数*正在*返回`others.end()`，但比较无法识别它。我不知道为什么。

后期编辑：感谢亚当的评论，我知道出了什么问题，并纠正了问题。它现在按预期工作。

（如果您想查看我的完整测试程序，请查看编辑历史记录。）

# c++ - ClickOnce：在用户机器上获取 MSVCRT C++ DLL

> ID：213957
> 
> 赞同：1
> 
> 时间：2008-10-17T21:49:29.803
> 
> 标签：c++, dll, clickonce, msvcrt

我一直在拼命地尝试让我的应用程序（15 个 C# dll 和 1 个具有 C++ 运行时 DLL 依赖项的 C++/CLI dll）使用 ClickOnce 进行部署。我通过[复制 Release 文件夹](http://msdn.microsoft.com/en-us/library/ms235291(VS.80).aspx)让它工作，但 ClickOnce 拒绝复制文件（msvcm80.dll、msvcp80.dll 和 msvcr80.dll）并将它们部署在这个文件夹中。

我做了这个疯狂的解决方法（提供 msvcm80.dll、msvcp80.dll 和 msvcr80.dll 作为 Content/Copy If Newer，然后在启动时创建 Microsoft.VC80.CRT 文件夹，复制这些 DLL，然后创建 Microsoft.VC80.CRT。 manifest) 这似乎有效，但这一切对我来说都是错误的。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T21:55:30.463

我很愚蠢：我刚刚发现了这个：

在我的启动项目的属性页面的发布选项卡上：单击先决条件...按钮>选中 Visual C++ 运行时库，单选按钮设置：从组件供应商的网站下载先决条件。

它似乎按照人们期望的方式工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T21:59:25.057

应该有一个来自微软的 msi 为您部署这些。我用了....

[指示](http://msdn.microsoft.com/en-us/library/ms235299(VS.80).aspx)

并下载 vcredist_x86.exe[下载](http://www.microsoft.com/downloads/details.aspx?FamilyId=32BC1BEE-A3F9-4C13-9C99-220B62A191EE&displaylang=en)

# java-7 - Java 7 中的新特性

> ID：213958
> 
> 赞同：96
> 
> 时间：2008-10-17T21:50:55.150
> 
> 标签：java-7, java

java 7 中将实现哪些新功能？他们现在在做什么？

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2011-07-10T08:28:23.740

## JDK 7 发行说明中的​​ Java SE 7[功能和增强功能](http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html)

这是来自[OpenJDK 7 功能页面](http://openjdk.java.net/projects/jdk7/features/)的 Java 7 新功能摘要：

> ```
> vm JSR 292：支持动态类型语言 (InvokeDynamic)
>         严格的类文件检查
> lang JSR 334：小语言增强（Project Coin）
> 核心升级类加载器架构
>         关闭 URLClassLoader 的方法
>         并发和集合更新 (jsr166y)
> i18n Unicode 6.0
>         语言环境增强
>         单独的用户语言环境和用户界面语言环境
> ionet JSR 203：Java 平台的更多新 I/O API (NIO.2)
>         用于 zip/jar 档案的 NIO.2 文件系统提供程序
>         SCTP（流控制传输协议）
>         SDP（套接字直接协议）
>         使用 Windows Vista IPv6 堆栈
>         TLS 1.2
> sec 椭圆曲线密码学 (ECC)
> JDBC 4.1
> Java 2D 的客户端 XRender 管道
>         为 6u10 图形功能创建新的平台 API
>         Swing 的 Nimbus 外观
>         Swing JLayer 组件
>         Gervill 声音合成器 [新]
> web 更新 XML 堆栈
> mgmt 增强型 MBean [更新]
> 
> ```

## Java 1.7 中新特性的代码示例

### Try-with-resources 语句

这个：

```
BufferedReader br = new BufferedReader(new FileReader(path));
try {
   return br.readLine();
} finally {
   br.close();
} 
```

变成：

```
try (BufferedReader br = new BufferedReader(new FileReader(path)) {
   return br.readLine();
} 
```

您可以声明多个要关闭的资源：

```
try (
   InputStream in = new FileInputStream(src);
   OutputStream out = new FileOutputStream(dest))
{
 // code
} 
```

### 数字文字中的下划线

```
int one_million = 1_000_000; 
```

### 开关中的字符串

```
String s = ...
switch(s) {
 case "quux":
    processQuux(s);
    // fall-through

  case "foo":
  case "bar":
    processFooOrBar(s);
    break;

  case "baz":
     processBaz(s);
    // fall-through

  default:
    processDefault(s);
    break;
} 
```

### 二进制文字

```
int binary = 0b1001_1001; 
```

### 改进了通用实例创建的类型推断

```
Map<String, List<String>> anagrams = new HashMap<String, List<String>>(); 
```

变成：

```
Map<String, List<String>> anagrams = new HashMap<>(); 
```

### 多个异常捕获

这个：

```
} catch (FirstException ex) {
     logger.error(ex);
     throw ex;
} catch (SecondException ex) {
     logger.error(ex);
     throw ex;
} 
```

变成：

```
} catch (FirstException | SecondException ex) {
     logger.error(ex);
    throw ex;
} 
```

### 安全变量

这个：

```
@SuppressWarnings({"unchecked", "varargs"})
public static void printAll(List<String>... lists){
    for(List<String> list : lists){
        System.out.println(list);
    }
} 
```

变成：

```
@SafeVarargs
public static void printAll(List<String>... lists){
    for(List<String> list : lists){
        System.out.println(list);
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-12-10T11:13:11.033

## Java 标准版 (JSE 7) 的新特性

1.  **使用 JLayer 类装饰组件：**

    JLayer 类是一个灵活而强大的 Swing 组件装饰器。Java SE 7 中的 JLayer 类在本质上类似于 java.net 上的 JxLayer 项目项目。JLayer 类最初是基于 JXLayer 项目，但它的 API 是单独发展的。

2.  **switch 语句中的字符串**：

    在 JDK 7 中，我们可以在 switch 语句的表达式中使用 String 对象。Java 编译器从使用 String 对象的 switch 语句生成的字节码通常比从链式 if-then-else 语句生成的字节码更有效。

3.  **通用实例的类型推断：**

    只要编译器可以从上下文中推断类型参数，我们就可以用一组空类型参数 (<>) 替换调用泛型类的构造函数所需的类型参数。这对尖括号被非正式地称为菱形。Java SE 7 支持有限类型推断来创建通用实例；如果构造函数的参数化类型从上下文中显而易见，则只能使用类型推断。例如，以下示例无法编译：

    ```
    List<String> l = new ArrayList<>();
    l.add("A");
    l.addAll(new ArrayList<>()); 
    ```

    相比之下，以下示例编译：

    ```
    List<? extends String> list2 = new ArrayList<>();
    l.addAll(list2); 
    ```

4.  **通过改进的类型检查捕获多种异常类型并重新抛出异常：**

    在 Java SE 7 及更高版本中，单个 catch 块可以处理多种类型的异常。此功能可以减少代码重复。考虑下面的代码，它在每个 catch 块中都包含重复的代码：

    ```
    catch (IOException e) {
        logger.log(e);
        throw e;
    }
    catch (SQLException e) {
        logger.log(e);
        throw e;
    } 
    ```

    在 Java SE 7 之前的版本中，很难创建通用方法来消除重复代码，因为变量 e 具有不同的类型。以下示例在 Java SE 7 及更高版本中有效，消除了重复代码：

    ```
    catch (IOException|SQLException e) {
        logger.log(e);
        throw e;
    } 
    ```

    catch 子句指定块可以处理的异常类型，每种异常类型用竖线 (|) 分隔。

5.  **java.nio.file 包**

    该`java.nio.file`包及其相关包 java.nio.file.attribute 为文件 I/O 和访问文件系统提供全面的支持。JDK 7 中还提供了一个 zip 文件系统提供程序。

来源： http: [//ohmjavaclasses.blogspot.com/](http://ohmjavaclasses.blogspot.com/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-03-25T12:10:39.497

[**Java 编程语言增强 @ Java7**](http://docs.oracle.com/javase/7/docs/technotes/guides/language/enhancements.html)

1.  [二进制字面量](https://stackoverflow.com/a/10961101/1697099)
2.  [switch 语句中的字符串](https://stackoverflow.com/a/10240598/1697099)
3.  [尝试使用资源](https://stackoverflow.com/a/17739460/1697099)（[如何工作](https://stackoverflow.com/a/26366568/1697099)）或 ARM（[自动资源管理](http://javarevisited.blogspot.sg/2011/09/arm-automatic-resource-management-in.html)）
4.  [多重异常处理](https://stackoverflow.com/a/3495968/1697099)
5.  [被抑制的异常](https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)
6.  [文字中的下划线](https://stackoverflow.com/a/6212642/1697099)
7.  [使用 Diamond 语法创建通用实例的类型推断](https://stackoverflow.com/q/14909875/1697099)
8.  [改进了将不可具体化的形式参数与 Varargs 方法一起使用时的编译器警告和错误](http://docs.oracle.com/javase/7/docs/technotes/guides/language/non-reifiable-varargs.html)

[官方参考](http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html)
[官方参考与java8](http://docs.oracle.com/javase/8/docs/technotes/guides/language/enhancements.html)
[wiki参考](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_7_.28July_28.2C_2011.29)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-17T22:00:35.100

除了 John Skeet 所说的，这里是[Java 7 项目的概述](http://openjdk.java.net/projects/jdk7/features/)。它包括功能列表和描述。

注意：JDK 7 于 2011 年 7 月 28 日发布，因此您现在应该访问官方[java SE 站点](http://www.oracle.com/technetwork/java/javase/downloads/index.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-30T10:06:38.427

**语言变化**：

```
-Project Coin (small changes)
-switch on Strings
-try-with-resources
-diamond operator 
```

**图书馆变化**：

```
-new abstracted file-system API (NIO.2) (with support for virtual filesystems)
-improved concurrency libraries
-elliptic curve encryption
-more incremental upgrades 
```

**平台变化**：

```
-support for dynamic languages 
```

下面是解释 JAVA 7 新增功能的链接，解释很清楚，每个功能都有可能的小例子：

[http://radar.oreilly.com/2011/09/java7-features.html](http://radar.oreilly.com/2011/09/java7-features.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-15T18:05:04.093

> 使用 Diamond(<>) 运算符创建通用实例

```
Map<String, List<Trade>> trades = new TreeMap <> (); 
```

> 在 switch 语句中使用字符串

```
String status=  “something”;
   switch(statue){
     case1: 
     case2: 
     default:
    } 
```

> 数字文字中的下划线

国际价值 12_15; 长电话号码 = 01917_999_720L；

> 使用“|”使用单个 catch 语句引发多个异常 操作员

```
catch(IOException | NullPointerException ex){
          ex.printStackTrace();   
    } 
```

> 无需 close() 资源，因为 Java 7 提供了 try-with-resources 语句

```
try(FileOutputStream fos = new FileOutputStream("movies.txt");
      DataOutputStream dos = new DataOutputStream(fos)) {
              dos.writeUTF("Java 7 Block Buster");
  } catch(IOException e) {
        // log the exception
  } 
```

> 前缀为“0b”或“0B”的二进制字面量</p>

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-28T17:53:42.850

我认为 **ForkJoinPool**和对 Executor Framework 的相关增强是 Java 7 中的一个重要补充。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-11-16T07:18:43.153

以下列表包含指向 Java SE 7 中的增强页面的链接。

```
Swing
IO and New IO
Networking
Security
Concurrency Utilities
Rich Internet Applications (RIA)/Deployment
    Requesting and Customizing Applet Decoration in Dragg able Applets
    Embedding JNLP File in Applet Tag
    Deploying without Codebase
    Handling Applet Initialization Status with Event Handlers
Java 2D
Java XML – JAXP, JAXB, and JAX-WS
Internationalization
java.lang Package
    Multithreaded Custom Class Loaders in Java SE 7
Java Programming Language
    Binary Literals
    Strings in switch Statements
    The try-with-resources Statement
    Catching Multiple Exception Types and Rethrowing Exceptions with Improved Type Checking
    Underscores in Numeric Literals
    Type Inference for Generic Instance Creation
    Improved Compiler Warnings and Errors When Using Non-Reifiable Formal Parameters with Varargs Methods
Java Virtual Machine (JVM)
    Java Virtual Machine Support for Non-Java Languages
    Garbage-First Collector
    Java HotSpot Virtual Machine Performance Enhancements
JDBC 
```

[参考 1](http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html) [参考 2](http://www.imrantariq.com/blog/?tag=java-7)

# .net - VS 2008 单元测试的 WCF 安全错误

> ID：213978
> 
> 赞同：3
> 
> 时间：2008-10-17T21:58:04.903
> 
> 标签：.net, wcf, unit-testing, authentication

我正在使用 WCF 服务运行我的第一个 Visual Studio 2008 单元测试，但收到以下错误：

> 测试方法 UnitTest.ServiceUnitTest.TestMyService 抛出异常：System.ServiceModel.Security.MessageSecurityException：HTTP 请求未经客户端身份验证方案“匿名”授权。从服务器收到的身份验证标头是“协商，NTLM”。---> System.Net.WebException: 远程服务器返回错误: (401) Unauthorized..

我还在安全日志中收到以下失败的审核：

> 登录失败：原因：用户未在此计算机上获得请求的登录类型
> 用户名：（Internet 访客帐户）
> 域：
> 登录类型：3
> 登录过程：IIS
> 身份验证包：
> MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
> 工作站名称：

我在 Windows XP SP3 机器上的 IIS 6.0 中托管 WCF 服务。我为 WCF 服务虚拟目录检查了“匿名访问”和“集成 Windows 身份验证”。

这是我的服务配置文件：

```
<system.serviceModel>
    <services>
        <bindings>
            <basicHttpBinding>
                <binding name="MyBinding">
               <security mode="None" />
           </binding>
            </basicHttpBinding>
            <customBinding>
                <binding name="MyBinding">
               <transactionFlow />
                    <textMessageEncoding />
                    <httpsTransport authenticationScheme="Ntlm"/>
                </binding>
            </customBinding>
            <wsHttpBinding>
                <binding name="MyBinding">
                   <security mode="None" />
               </binding>
            </wsHttpBinding>
        </bindings>
        <service 
            behaviorConfiguration="Service1Behavior"
            name="Service1"
        >
            <endpoint 
                address="" 
                binding="wsHttpBinding"
                bindingConfiguration="MyBinding"
                contract="IService1"
            >
                <identity>
                    <dns value="localhost" />
                   </identity>
            </endpoint>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="Service1Behavior">
                <serviceMetadata httpGetEnabled="true" />
                   <serviceDebug includeExceptionDetailInFaults="false" />
               </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T20:02:37.863

我不得不更改以下 IIS 和 WCF 服务配置以通过“协商，NTLM”异常。

IIS 配置：

> -- 取消选中“匿名访问”复选框并选中 WCF 服务虚拟目录的目录安全设置中的“集成 Windows 身份验证”复选框。

WCF 服务：

> -- 实现 basicHttpBinding 并将 basicSettingBinding 安全设置配置为“TransportCredentialsOnly”模式，将 TransportClientCredentialType 配置为“Windows”

这是我更新的 wcf 服务配置：

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="windowsBasicHttpBinding">
                <security mode="TransportCredentialOnly">
                    <transport clientCredentialType="Windows" />
                </security>
            </binding>
       </basicHttpBinding>
    </bindings>
    <services>
        <service    
      behaviorConfiguration="CityOfMesa.ApprovalRouting.WCFService.RoutingServiceBehavior"
           name="CityOfMesa.ApprovalRouting.WCFService.RoutingService"
        >
            <endpoint 
                binding="basicHttpBinding" bindingConfiguration="windowsBasicHttpBinding"
                name="basicEndPoint"    
                contract="CityOfMesa.ApprovalRouting.WCFService.IRoutingService" 
            />
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior 
                name="CityOfMesa.ApprovalRouting.WCFService.RoutingServiceBehavior"
            >
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="true" />
           </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T01:05:49.500

当您的绑定中有 securityMode="None" 时，您应该关闭集成身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T22:02:36.483

默认身份验证是 windows（或 NTLM），因此您需要在配置文件中指定您不希望进行身份验证。

```
<system.serviceModel>
  <bindings>
    <wsHttpBinding>
      <binding name="myBinding">
        <security mode="None" />
      </binding>
  </bindings>
</system.serviceModel> 
```

还要将此属性添加到端点

```
bindingConfiguration="myBinding" 
```

binding 元素指定对 wsHttpBinding 标准行为的修改。

然后端点上的“bindingConfiguration="myBinding" 属性表示该端点应该使用我们指定的修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T20:09:39.703

作为旁注.....有一个 GPO 设置“NTLM 身份验证级别”控制身份验证，导致单元测试生成“协商，NTLM”异常。

# java - 制作一个空字符串常量值得吗？

> ID：213985
> 
> 赞同：31
> 
> 时间：2008-10-17T22:00:53.510
> 
> 标签：java, string

我有一个同事发誓

```
//in a singleton "Constants" class
public static final String EMPTY_STRING = ""; 
```

在整个项目中可用的常量类中。这样，我们可以写类似

```
if (Constants.EMPTY_STRING.equals(otherString)) {
    ...
} 
```

代替

```
if ("".equals(otherString)) {
    ...
} 
```

我说是

1.  不值得——它不会在堆/堆栈/字符串池中节省任何空间，
2.  丑陋
3.  滥用常量类。

谁是这里的白痴？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-10-17T22:05:52.343

默认情况下，字符串字面量是实习的，所以无论你在代码中引用多少次**“”**，都只会有一个空的 String 对象。我认为声明 EMPTY_STRING 没有任何好处。否则，您不妨为整数文字声明一、二、三、四等。

当然，如果你以后想改变 EMPTY_STRING 的值，把它放在一个地方很方便；）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-17T22:07:07.023

为什么你想要在 Java 中使用全局变量？詹姆斯·高斯林真的试图摆脱他们；请不要把它们带回来。

任何一个

```
0 == possiblyEmptyString.length() 
```

或者

```
possiblyEmptyString.isEmpty() // Java 6 only 
```

一样清楚。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-17T22:02:58.340

我更喜欢看到 EMPTY_STRING。

它使它成为英语。"".equals '读取'与 EMPTY_STRING.equals 不同。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-17T22:10:47.903

具有讽刺意味的是，常量的全部意义在于使它们易于更改。因此，除非您的同事计划将 EMPTY_STRING 重新定义为空字符串以外的其他内容 - 这将是一件非常愚蠢的事情 - 将真正的固定构造（例如“”）转换为常量是一件坏事。

正如 Dan Dyer 所说，这就像将常数 ONE 定义为 1：如果有人重新定义它，它完全没有意义，而且会完全令人困惑 - 可能存在风险。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-20T12:46:31.067

好吧，我也能猜到，但我做了一个快速测试......几乎就像作弊......

使用各种方法检查任意字符串。（多次迭代）

结果表明 isEmpty() 速度更快，并且确实更具可读性；如果 isEmpty() 不可用，length() 是一个不错的选择。

使用常量可能不值得。

```
"".equals(someString()) :24735 毫秒
t != null && t.equals("") :23363 毫秒
t != null && t.equals(EMPTY) :22561 毫秒
EMPTY.equals(someString()) :22159 毫秒
t != null && t.length() == 0 :18388 毫秒
t != null && t.isEmpty() :18375 毫秒
someString().length() == 0 :18171 毫秒

```

在这种情况下；

```
"IAmNotHardCoded".equals(someString())

```

我建议在相关的地方定义一个常量，因为所有常量的全局类真的很糟糕。如果没有相关的地方，你可能做错了什么......

```
Customer.FIELD_SHOE_SIZE //“SHOE_SIZE”

```

可能被认为是相关的地方；

```
CommonConstants.I__AM__A__LAZY__PROGRAMMER // true

```

不是。

对于 BigIntegers 和类似的东西，我倾向于最终在本地定义一个最终的静态；像：

```
私有最终静态 BigDecimal ZERO = new BigDecimal(0);
私有最终静态 BigDecimal B100 = new BigDecimal("100.00");

```

这让我很烦恼，给 BigInts 和 BigDecimals 加点糖不是很好吗......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-17T22:46:18.520

我和你的同事在一起。虽然空字符串很难打错，但您可能会不小心在其中放置一个空格，并且在扫描代码时可能很难注意到。更重要的是，对在多个地方使用的所有字符串常量执行此操作是一种好习惯——尽管，我倾向于在类级别而不是作为全局常量执行此操作。

FWIW，C# 有一个静态属性 string.Empty 就是为了这个目的，我发现它极大地提高了代码的可读性。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-10-19T14:30:49.847

作为问题的切线，我通常建议在您真正检查的是“没有用价值”而不是特别是空字符串时使用实用程序函数。一般来说，我倾向于使用：

```
import org.apache.commons.lang.StringUtils;

// Check if a String is whitespace, empty ("") or null.
StringUtils.isBlank(mystr); 
// Check if a String is empty ("") or null.
StringUtils.isEmpty(mystr); 
```

概念是以上两个：

*   检查其他各种情况，包括 null 安全，以及（更重要的是）
*   传达您要测试的内容，而不是如何测试它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-12-05T09:18:36.953

大卫·阿诺说：-

> 具有讽刺意味的是，常量的全部意义在于使它们易于更改

这是不正确的。常量的全部意义在于重复使用相同的值并提高可读性。

常量值被更改是非常罕见的（因此得名）。更常见的是配置值被更改，但作为数据保存在某处（如配置文件或注册表项）

自早期编程以来，常量已被用于将诸如 0xff6d8da412 之类的神秘十六进制值转换为人类可读的东西，而无需**更改**这些值。

```
const int MODE_READ       = 0x000000FF;
const int MODE_EXECUTE    = 0x00FF0000;
const int MODE_WRITE      = 0x0000FF00;
const int MODE_READ_WRITE = 0x0000FFFF; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-17T22:05:39.193

我不喜欢任何一个选择。为什么不`if (otherString.length() == 0)`

编辑：我实际上总是编码

```
if (otherString == null || otherString.length() == 0) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-17T22:03:40.977

1.  是的——它没有任何好处。
2.  取决于你习惯什么，我敢肯定。
3.  不，这只是一个常数——而不是滥用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-17T22:11:34.110

.NET 中不时出现相同的论点（其中已经有一个只读静态字段 string.Empty）。这是一个品味问题——但我个人觉得“”不那么突兀。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-18T03:41:19.420

具有空字符串值的常量确实有意义的一种情况是，当您的名称捕获值的语义时。例如：

```
if (Constants.FORM_FIELD_NOT_SET.equals(form.getField("foobar"))) {
    ...
} 
```

这使得代码更加自我记录（除了更好的设计是添加检查字段是否设置为表单本身的方法的论点）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-22T00:51:27.577

呵呵，有趣的是：一旦编译，你不会看到“静态最终”事物和字符串文字之间的区别（在字节码中），因为 Java 编译器总是将“静态最终字符串”内联到目标类中. 只需将您的空字符串更改为可识别的内容（如 LGPL 文本），然后查看生成的 *.class 引用该常量的代码文件。您会发现您的文本已复制到该类文件中。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-17T22:40:40.200

对于这样的情况，我们只需执行以下操作：

```
public class StaticUtils
{
    public static boolean empty(CharSequence cs)
    {
        return cs == null || cs.length() == 0;
    }

    public static boolean has(CharSequence cs)
    {
        return !empty(cs);
    }
} 
```

然后就`import static StaticUtils.*`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-17T22:29:02.860

嗯，规则是正确的，但在不同的意义上被理解了！让我们看看原因，首先java中的所有对象引用都由equals（）检查。早些时候，在某些语言中，它是使用 '==' 运算符完成的，如果有人不小心将 '=' 用于 '=='，那就是一场灾难。现在是幻数/常数的问题，对于计算机，所有常数/数字都是相似的。可以肯定地使用 1 而不是 'int ONE=1'，但是对于双 PI = 3.141 是否适用...？如果有人稍后尝试更改精度会发生什么。

如果我们要提出一个检查清单，那么该规则将解决一般准则，不是吗？我想说的是，规则应该是有帮助的，只有当我们非常了解规则时，我们才能肯定地改变规则。常识占上风。正如我的一个朋友所建议的，像 0/1 这样表示退出条件的程序常量可以硬编码，因此幻数原则不适用。但是对于那些参与逻辑检查/规则的人，最好将它们保留为可配置的常量。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-12-05T08:52:15.587

为什么最好在 C# 中使用 String.Empty 并因此在其他语言中使用公共常量，因为常量是静态的，因此只占用内存中的一个实例。

每次你做这样的事情： -

```
stringVariable = ""; 
```

您正在创建一个空字符串的新实例，并使用 stringVariable 指向它。

所以每次你将“”赋值给一个变量（指针）时，那个“”空字符串就是一个新的字符串实例，直到它不再有任何指针赋值。

通过将字符串全部指向同一个常量来初始化字符串，意味着只创建一个“”，并且每个初始化的变量都指向同一个空字符串。

这可能听起来微不足道，但创建和销毁字符串比创建指针（变量）并将它们指向现有字符串要占用更多资源。

由于字符串初始化很常见，因此最好的做法是：-

```
const String EMPTY_STRING = "";
String variable1 = EMPTY_STRING;
String variable2 = EMPTY_STRING;
String variable3 = EMPTY_STRING;
String variable4 = EMPTY_STRING;
String variable5 = EMPTY_STRING; 
```

您创建了 5 个字符串指针，但只有 1 个字符串

而不是： -

```
String variable1 = "";
String variable2 = "";
String variable3 = "";
String variable4 = "";
String variable5 = ""; 
```

您已经创建了 5 个字符串指针和 5 个单独的空字符串。

在这种情况下不是主要问题，但在几十个类的数千行代码中，不必要的内存浪费和处理器使用，创建另一个空字符串变量，当它们都可以指向同一个时，使应用程序更有效率.

**当然，编译器应该足够聪明地确定几个静态字符串并重用重复项，但为什么要假设呢？**

此外，它不太容易引入错误，因为 "" 和 " " 都会编译，但您可能会错过意外添加的空间，这可能会产生虚假的运行时错误，例如条件逻辑，例如：-

```
myvariable = " ";
While (myVariable == ""){
 ...
} 
```

while 块内的代码无法访问，因为 myVariable 在第一次迭代时将不满足条件。用“”而不是“”初始化的错误很容易被忽略，而：-

```
myvariable = EMPTY_STRING;
While (myVariable == EMPTY_STRING){
 ...
} 
```

... 不太可能导致运行时错误，尤其是拼写错误的 EMPTY_STRING 会产生编译错误，而不必在运行时捕获错误。

最干净的解决方案是创建一个静态类，其中包含您需要的各种字符串常量的成员，如果您需要的不仅仅是一个空字符串。

```
public static class StringConstants{
    public static String Empty = "";
    public static String EMail = "mailto:%s";
    public static String http = "http://%s";
    public static String https = "https://%s";
    public static String LogEntry = "TimeStamp:%tYmdHMSL | LogLevel:%s| Type:%s | Message: '%s'";

}

String myVariable = StringConstants.Empty; 
```

您甚至可以扩展本机 String 对象，具体取决于您的语言。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-03-28T12:10:47.563

如果您每个人都希望在 oracle 的可为空字符串列中存储“空”字符串，则必须将 EMPTY_STRING 的定义更改为“”之外的其他内容！（我记得上次我被迫使用 Oracle，它不知道空字符串和空字符串之间的区别）。

但是，这应该在您的数据访问层中完成，以便应用程序的其余部分不知道它，和/或整理您的数据模型，这样您就不需要在同一列中存储空字符串和空字符串。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-10-15T09:12:55.023

或者只是将其作为 string.IsNullOrEmpty(otherString)********