# StackOverflow 问答 000574000-000574999

# python - CPython 实现的内部文档

> ID：574004
> 
> 赞同：8
> 
> 时间：2009-02-22T00:16:52.247
> 
> 标签：python, cpython

我目前正在制作 CPython 3.0 Python 解释器的嵌入式系统端口，我对任何提供有关 Release 3.0 甚至任何 2\. x 发布。

到目前为止，我发现的一个有用的文档是这个关于实现的[信息性 PEP——](http://www.python.org/dev/peps/pep-0339/)这是一个很好的概述——但仍然是相当高的水平。希望遇到一些能够提供[更多]更多关于更多模块的细节的东西，或者甚至可能涵盖一些关于移植注意事项的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-22T05:14:50.627

有 C API 的文档，它本质上是 Python 内部的 API。不过，它不会涵盖移植细节。代码本身有很好的文档记录。您可以尝试在需要修改的区域内和周围阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T15:12:04.373

大多数文档都存储在各个核心开发人员的脑海中。:) freenode 上的#python-dev IRC 频道对您来说是一个很好的资源，其中许多人都在那里闲逛。

[Python wiki](http://wiki.python.org/moin/)上也有一些零散的信息。

# algorithm - 处理板上形状的选择

> ID：574017
> 
> 赞同：2
> 
> 时间：2009-02-22T00:26:40.227
> 
> 标签：algorithm, events, graphics, shapes

我有一块板作为画布，上面绘制了几个形状，其中一些是三角形、圆形、矩形，但都包含在它们自己的边界分隔矩形内。

“圆圈将在一个矩形内”

我将两个圆圈 A、B 放在 A 位于 B 上方并且有一些区域发生碰撞的棋盘上。如果我单击与容器框相对应的 A 区域，但不是实际的 A 圆形区域，我不会选择 A 圆圈，但是这会阻止我选择 B，因为我的 A 容器重叠并且在 B 之上。

在事件基础框架中，我猜子事件将去父而不是兄弟。

所以我的选择是检查所有形状容器，这些容器在点 x 处有一些区域，按 z 索引排序。然后为每个容器检查其内部的形状是否发生碰撞。

它似乎不是超级有效，但还有其他方法吗？

```
---------
|    --------  
|    |      |
-----|      |
     -------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T00:29:48.940

您正在处理它，并且可以处理它 - 窗口系统通常遵循 Z 顺序（层）。

无论如何，从长远来看，这会更好，特别是如果您希望能够通过在它们周围绘制一个选择框来选择多个项目。

有一些算法可以通过将矩形转换为 x 和 y 轴上的 2d 表示来查找矩形是否重叠。您可以做同样的事情，然后比较您的点以查看您的点与哪些对象重叠：

[检测两个矩形相交的算法？](https://stackoverflow.com/questions/115426/algorithm-to-detect-intersection-of-two-rectangles)

只需将您的点选择（或矩形选择，如果您绘制一个边界框以选择多个项目）作为另一个要比较的矩形与其他矩形重叠。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T18:09:23.220

如果您真的需要速度，可以玩一些技巧。例如：

*   如果您使用的是深托盘，则可以使用颜色的低位来标记对象。然后偷看像素会为您提供对象，或者至少以免您快速大幅剔除列表。
*   即使在低位深度下，如果对象都是单色的，您也可以使用整个颜色
*   如果您的分辨率足够低，您可以保留一个数组，说明哪个对象拥有哪个像素。
*   在更高的分辨率下，您可以做同样的事情，但使用 RLE 来减小尺寸（也可以查看四叉树）
*   等等……

如果它只是您所追求的简单实现，一个快速技巧是记录 X 和 Y，重新绘制屏幕，​​并注意哪个对象绘制了该像素。

——马库斯

# c# - 将对象设置为 null vs Dispose()

> ID：574019
> 
> 赞同：111
> 
> 时间：2009-02-22T00:26:57.540
> 
> 标签：c#, .net, disposable

我对 CLR 和 GC 的工作方式很着迷（我正在努力通过 C# 阅读 CLR、Jon Skeet 的书籍/帖子等来扩展我的知识）。

无论如何，说：

```
MyClass myclass = new MyClass();
myclass = null; 
```

或者，通过让 MyClass 实现 IDisposable 和析构函数并调用 Dispose()？

另外，如果我有一个带有 using 语句的代码块（例如下面），如果我单步执行代码并退出 using 块，那么对象是在那时被处置还是在发生垃圾回收时被处置？如果我在 using 块中调用 Dispose() 会发生什么？

```
using (MyDisposableObj mydispobj = new MyDisposableObj())
{

} 
```

流类（例如 BinaryWriter）有 Finalize 方法吗？我为什么要使用它？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-02-22T09:47:51.360

将处理与垃圾收集分开很重要。它们是完全不同的东西，有一个共同点，我稍后会谈到。

**`Dispose`, 垃圾收集和终结**

当您编写`using`语句时，它只是 try/finally 块的语法糖，因此`Dispose`即使`using`语句主体中的代码抛出异常也会调用它。这*并不*意味着该对象在块的末尾被垃圾收集。

处置是关于*非托管资源*（非内存资源）。这些可能是 UI 句柄、网络连接、文件句柄等。这些资源有限，因此您通常希望尽快释放它们。您应该`IDisposable`在您的类型“拥有”非托管资源时直接（通常通过 a `IntPtr`）或间接（例如通过 a `Stream`、 a`SqlConnection`等）实现。

垃圾收集本身只与内存有关 - 有一点点扭曲。垃圾收集器能够找到不再被引用的对象，并释放它们。但它并不总是寻找垃圾——只有当它检测到它需要时（例如，如果堆的“一代”内存不足）。

转折是*定稿*。垃圾收集器保留一个不再可访问的对象列表，但这些对象有一个终结器（用`~Foo()`C# 编写，有点令人困惑——它们与 C++ 析构函数完全不同）。它在这些对象上运行终结器，以防它们需要在释放内存之前进行额外的清理。

终结器几乎总是用于在该类型的用户忘记有序处置资源的情况下清理资源。所以如果你打开 a`FileStream`但忘记调用`Dispose`or `Close`，终结器*最终*会为你释放底层文件句柄。在我看来，在一个编写良好的程序中，终结器几乎不应该触发。

**将变量设置为`null`**

关于将变量设置为的一小点`null`- 为了垃圾收集，这几乎不需要。如果它是成员变量，您有时可能想要这样做，尽管根据我的经验，不再需要对象的“部分”很少见。当它是一个局部变量时，JIT 通常足够聪明（在发布模式下）知道什么时候你不会再次使用引用。例如：

```
StringBuilder sb = new StringBuilder();
sb.Append("Foo");
string x = sb.ToString();

// The string and StringBuilder are already eligible
// for garbage collection here!
int y = 10;
DoSomething(y);

// These aren't helping at all!
x = null;
sb = null;

// Assume that x and sb aren't used here 
```

*可能*值得设置局部变量的一次是`null`当您处于循环中时，并且循环的某些分支需要使用该变量，但您知道您已经达到了不需要的点。例如：

```
SomeObject foo = new SomeObject();

for (int i=0; i < 100000; i++)
{
    if (i == 5)
    {
        foo.DoSomething();
        // We're not going to need it again, but the JIT
        // wouldn't spot that
        foo = null;
    }
    else
    {
        // Some other code 
    }
} 
```

**实现 IDisposable/终结器**

那么，你自己的类型应该实现终结器吗？几乎可以肯定不是。如果您只是*间接*持有非托管资源（例如，您将 a`FileStream`作为成员变量），那么添加您自己的终结器将无济于事：当您的对象存在时，流几乎肯定有资格进行垃圾收集，因此您可以依赖`FileStream`有一个终结器（如果有必要 - 它可能指的是别的东西，等等）。如果你想“几乎”直接持有一个非托管资源，[`SafeHandle`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.safehandle.aspx)是你的朋友 - 这需要一些时间来开始，但这意味着你[几乎](http://joeduffyblog.com/2008/02/17/idisposable-finalization-and-concurrency/) [不需要再次编写终结器](http://joeduffyblog.com/2005/12/27/never-write-a-finalizer-again-well-almost-never/)。如果您对资源 (an `IntPtr`) 有真正的直接句柄，您通常只需要一个终结器，并且您应该寻求移动到`SafeHandle`你尽快做。（那里有两个链接 - 最好都阅读。）

Joe Duffy 有[很长的一套关于终结器和 IDisposable](http://joeduffyblog.com/2005/04/08/dg-update-dispose-finalization-and-resource-management/)（与许多聪明人共同编写）的指南，值得一读。值得注意的是，如果你密封你的类，它会让生活变得更容易：重写`Dispose`调用新的虚拟`Dispose(bool)`方法等的模式只有在你的类是为继承而设计时才相关。

这有点杂乱无章，但请要求澄清您想要的地方:)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-22T00:31:53.833

释放对象时，资源将被释放。当您将 null 分配给变量时，您只是在更改引用。

```
myclass = null; 
```

执行此操作后，myclass 所指的对象仍然存在，并将继续存在，直到 GC 开始清理它。如果 Dispose 被显式调用，或者它在 using 块中，则将尽快释放任何资源。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-22T00:58:02.677

这两个操作彼此没有太大关系。当您设置对 null 的引用时，它只是这样做。它本身并不影响被引用的类。您的变量不再指向它曾经指向的对象，但对象本身并没有改变。

当您调用 Dispose() 时，它是对对象本身的方法调用。无论 Dispose 方法做什么，现在都在对象上完成。但这不会影响您对该对象的引用。

唯一重叠的地方是，*当*不再引用一个对象时，它*最终*会被垃圾回收。如果该类实现了 IDisposable 接口，则在对象被垃圾收集之前将调用 Dispose()。

但是，在您将引用设置为 null 后，这不会立即发生，原因有两个。首先，其他引用可能存在，所以它根本不会被垃圾收集，其次，即使那是最后一个引用，所以它现在已经准备好被垃圾收集了，在垃圾收集器决定删除之前什么都不会发生物体。

在对象上调用 Dispose() 不会以任何方式“杀死”该对象。它通常用于清理，以便之后可以安全地删除对象*，*但归根结底，Dispose 并没有什么神奇之处，它只是一个类方法。

# java - 使用 UseConcMarkSweepGC 减少 JVM 暂停时间 > 1 秒

> ID：574021
> 
> 赞同：10
> 
> 时间：2009-02-22T00:29:45.867
> 
> 标签：java, performance, garbage-collection, jvm, jvm-arguments

我在具有 16Gb RAM、8 核处理器和 Java 1.6 的机器上运行内存密集型应用程序，所有这些都在 CentOS 版本 5.2（最终版）上运行。确切的 JVM 详细信息是：

```
java version "1.6.0_10"
Java(TM) SE Runtime Environment (build 1.6.0_10-b33)
Java HotSpot(TM) 64-Bit Server VM (build 11.0-b15, mixed mode) 
```

我正在使用以下命令行选项启动应用程序：

```
java -XX:+UseConcMarkSweepGC -verbose:gc -server -Xmx10g -Xms10g ... 
```

我的应用程序公开了一个 JSON-RPC API，我的目标是在 25 毫秒内响应请求。不幸的是，我看到延迟达到并超过 1 秒，这似乎是由垃圾收集引起的。以下是一些较长的示例：

```
[GC 4592788K->4462162K(10468736K), 1.3606660 secs]
[GC 5881547K->5768559K(10468736K), 1.2559860 secs]
[GC 6045823K->5914115K(10468736K), 1.3250050 secs] 
```

这些垃圾收集事件中的每一个都伴随着延迟的 API 响应，其持续时间与所示垃圾收集的长度非常相似（在几毫秒内）。

以下是一些典型的例子（这些都是在几秒钟内产生的）：

```
[GC 3373764K->3336654K(10468736K), 0.6677560 secs]
[GC 3472974K->3427592K(10468736K), 0.5059650 secs]
[GC 3563912K->3517273K(10468736K), 0.6844440 secs]
[GC 3622292K->3589011K(10468736K), 0.4528480 secs] 
```

问题是我认为 UseConcMarkSweepGC 会避免这种情况，或者至少让它变得非常罕见。相反，超过 100 毫秒的延迟几乎每分钟发生一次或更多（尽管超过 1 秒的延迟相当罕见，可能每 10 或 15 分钟一次）。

另一件事是，我认为只有 FULL GC 会导致线程暂停，但这些似乎不是 full GC。

可能需要注意的是，大部分内存都被使用软引用的 LRU 内存缓存占用。

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-22T01:59:06.540

首先，如果您还没有这样做，请查看[Java SE 6 HotSpot[tm] Virtual Machine Garbage Collection Tuning文档。](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)该文档说：

> 并发收集器在应用程序线程仍在运行的情况下完成大部分跟踪和清扫工作，因此应用程序线程只会看到短暂的暂停。但是，如果并发收集器无法在年老代填满之前完成对不可达对象的回收，或者如果在年老代中的可用空闲空间块无法满足分配，则应用程序将暂停并完成收集所有应用程序线程都停止了。无法同时完成收集称为并发模式故障，表示需要调整并发收集器参数。

稍后...

> 并发收集器在并发收集周期中暂停应用程序两次。

我注意到那些 GC 似乎并没有释放太多内存。也许你的许多物品都是长寿的？您可能希望调整生成大小和其他 GC 参数。从许多标准来看， 10 Gig 是一个*巨大*的堆，我天真地期望 GC 需要更长的时间来处理如此巨大的堆。尽管如此，1 秒是一个很长的停顿时间，它表明要么有问题（你的程序正在生成大量不需要的对象，要么正在生成难以回收的对象，或者其他什么），要么你只需要调整 GC。

通常，我会告诉某人，如果他们必须调整 GC，那么他们还有其他问题需要先解决。但是对于这种规模的应用程序，我认为你落入了“需要比普通程序员更了解 GC”的境地。

正如其他人所说，您需要分析您的应用程序以查看瓶颈所在。您的 PermGen 对于分配给它的空间是否太大？您是否在创建不必要的对象？jconsole 至少可以显示有关 VM 的最少信息。这是一个起点。然而，正如其他人所指出的，您很可能需要比这更高级的工具。

祝你好运。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-22T03:14:01.213

既然您提到了缓存的愿望，我猜您的大部分巨大堆都被该缓存占用了。您可能希望限制缓存的大小，以确保它永远不会尝试增长到足以填满终身代。不要依靠`SoftReference`单独来限制大小。当老一代被软引用填充时，旧的引用将被清除并成为垃圾。将创建新的引用（可能是相同的信息），但会很快清除，因为可用空间不足。最终，永久空间充满了垃圾，需要清理。

也考虑调整`-XX:NewRatio`设置。默认为 1:2，意味着三分之一的堆分配给新生代。对于一个大堆来说，这几乎总是太多了。您可能想尝试类似 9 的方法，它可以为老一代保留 10 Gb 堆中的 9 Gb。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-06T23:39:18.843

结果发现堆的一部分被换出到磁盘，因此垃圾收集必须将一堆数据从磁盘拉回内存。

我通过将 Linux 的“swappiness”参数设置为 0 来解决这个问题（这样它就不会将数据交换到磁盘上）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T03:10:38.490

以下是我发现的一些可能很重要的事情。

*   JSON-RPC 可以生成很多对象。没有 XML-RPC 那么多，但仍然值得关注。在任何情况下，您确实似乎每秒生成 100 MB 的对象，这意味着您的 GC 运行的时间比例很高，并且可能会增加您的随机延迟。即使 GC 是并发的，您的硬件/操作系统也很可能在负载下表现出非理想的随机延迟。
*   看看你的记忆库架构。在 Linux 上，命令是 numactl --hardware。如果您的 VM 被拆分到多个内存库中，这将显着增加您的 GC 时间。（它也会减慢您的应用程序，因为这些访问的效率可能会大大降低）您对内存子系统的工作越努力，操作系统就越有可能不得不移动内存（通常是大量），结果您会出现剧烈的停顿（ 100 毫秒并不奇怪）。不要忘记您的操作系统不仅仅是运行您的应用程序。
*   考虑压缩/减少缓存的内存消耗。如果您正在使用多 GB 的缓存，则值得研究比现有方法进一步减少内存消耗的方法。
*   我建议您同时使用内存分配跟踪和 cpu 采样来分析您的应用程序。这可能会产生非常不同的结果，并且通常会指出这些问题的原因。

使用这些方法，可以将 RPC 调用的延迟降低到**200 微秒以下**，并将 GC 时间降低到 1-3 毫秒，影响不到 1/300 的调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T00:47:01.207

一些开始寻找的地方：

*   [https://visualvm.dev.java.net/](https://visualvm.dev.java.net/)
*   [http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstat.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstat.html)
*   [http://www.javaperformancetuning.com/tools/gcviewer/index.shtml](http://www.javaperformancetuning.com/tools/gcviewer/index.shtml)

此外，我会通过探查器运行代码。我喜欢 NetBeans 中的代码，但也有其他代码。您可以实时查看 gc 行为。Visual VM 也可以做到这一点......但我还没有运行它（一直在寻找一个理由......但还没有时间或需要）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T00:53:23.983

我还建议[使用 GCViewer](http://www.tagtraum.com/gcviewer.html)和分析器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-17T09:07:01.587

我个人没有使用过这么大的堆，但我在使用 Oracle/Sun Java 1.6.x 的以下开关时通常经历了非常低的延迟：

```
-Xincgc -XX:+UseConcMarkSweepGC -XX:CMSIncrementalSafetyFactor=50
-XX:+UseParNewGC
-XX:+CMSConcurrentMTEnabled -XX:ConcGCThreads=2 -XX:ParallelGCThreads=2
-XX:CMSIncrementalDutyCycleMin=0 -XX:CMSIncrementalDutyCycle=5
-XX:GCTimeRatio=90 -XX:MaxGCPauseMillis=20 -XX:GCPauseIntervalMillis=1000 
```

在我看来，重要的部分是在老年代使用 CMS，在年轻一代中使用 ParNewGC。此外，这为 CMS 增加了一个相当大的安全系数（默认为 10% 而不是 50%）并要求较短的暂停时间。由于您的目标是 25 毫秒响应时间，我会尝试设置`-XX:MaxGCPauseMillis`为更小的值。您甚至可以尝试使用两个以上的内核进行并发 GC，但我*猜*这不值得 CPU 使用。

您可能还应该查看[HotSpot JVM GC 备忘单](http://blog.ragozin.info/2011/09/hotspot-jvm-garbage-collection-options.html)。

# iphone - 指针/内存管理的 Cocoa 策略

> ID：574029
> 
> 赞同：4
> 
> 时间：2009-02-22T00:33:27.683
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我看到很多代码，尤其是在 Apple 示例代码中，类似于以下内容：

```
 EditingViewController *controller = [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil];
    self.editingViewController = controller;
    [controller release]; 
```

是否有任何理由特别证明上述方法对以下方面有益：

```
self.editingViewController = [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil]; 
```

试图了解是否有上述策略。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-22T01:24:42.660

乍一看，您的示例似乎可以工作，但实际上它会造成内存泄漏。

按照 Cocoa 和 Cocoa-touch 中的约定，使用`[[SomeClass alloc] initX]`或`[SomeClass newX]`使用保留计数创建的任何对象。您有责任`[someClassInstance release]`在完成新实例后调用，通常是在您的`dealloc`方法中。

当您将新对象分配给属性而不是实例变量时，这会变得棘手。大多数属性被定义为`retain`or `copy`，这意味着它们要么在设置时增加对象的保留计数，要么制作对象的副本，而原始对象保持不变。

在您的示例中，您的`.h`文件中可能包含以下内容：

```
@property (retain) EditingViewController *editingViewController; 
```

所以在你的第一个例子中：

```
EditingViewController *controller = 
    [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil];
// (1) new object created with retain count of 1

self.editingViewController = controller;
// (2) equivalent to [self setEditingViewController: controller];
// increments retain count to 2

[controller release];
// (3) decrements retain count to 1 
```

但是对于您的第二个示例：

```
// (2) property setter increments retain count to 2
self.editingViewController = 

    // (1) new object created with retain count of 1
    [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil];

// oops! retain count is now 2 
```

通过在将新对象传递给 setter 之前调用`autorelease`新对象上的方法，您要求自动释放池获取对象的所有权并在未来某个时间释放它，因此有一段时间该对象有两个所有者来匹配它的保留计数和一切都很好。

```
// (3) property setter increments retain count to 2
self.editingViewController = 

    // (1) new object created with retain count of 1
    [[[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil]

        // (2) give ownership to autorelease pool 
        autorelease];

// okay, retain count is 2 with 2 owners (self and autorelease pool) 
```

另一种选择是将新对象直接分配给实例变量而不是属性设置器。假设您的代码命名为基础实例变量`editingViewController`：

```
// (2) assignment to an instance variable doesn't change retain count
editingViewController = 

    // (1) new object created with retain count of 1
    [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil];

// yay! retain count is 1 
```

这是代码中一个微妙但关键的区别。在这些示例中，`self.editingViewController = x`是语法糖，`[self setEditingViewController: x]`但`editingViewController`它是一个普通的旧实例变量，没有编译器生成的任何保留或复制代码。

另请参阅[为什么这会造成内存泄漏 (iPhone)？](https://stackoverflow.com/questions/612986/why-does-this-create-a-memory-leak-iphone)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T00:38:08.950

你可以写：

```
self.editingViewController = [[[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil] autorelease]; 
```

我经常在非速度关键领域做。问题是该属性很可能是一个“保留”属性，这意味着如果您不释放它，该对象将被泄露。

应该注意的是，自动发布比发布更昂贵，但我也更喜欢简洁的代码以提高可读性而不是纯粹的速度。

# asp.net - IE7：查看页面上所有 html 的技巧/插件？

> ID：574032
> 
> 赞同：-1
> 
> 时间：2009-02-22T00:34:48.990
> 
> 标签：asp.net, html, internet-explorer-7

我正在开发一个应用程序，它有点像新旧技术 (ASP/ASP.NET) 的混蛋。这一切都在IE7中运行。我希望能够右键单击，查看源代码并实际看到我用眼睛看到的所有 html。例如，我在表格的页面中间有一些文本。我直接右键单击该文本和“查看源代码”，文本不在我正在查看的 HTML 中。没有换行符或特殊字符。它是一段文本，如 ABC123。然而 ABC123 不在我查看源代码时看到的 HTML 中。

这只是我坚持的事情吗？如果没有，我怎样才能得到我想要的 HTML？该应用程序不会在 FF 中运行，因此 Firebug 是不可能的。我已经为 IE 尝试了一些开发人员工具栏，但发现它们充其量是有缺陷的，最坏的情况是无法正常工作。这非常令人沮丧；我想对 TD 的风格做一点改变，我必须做太多的工作才能看看我是否喜欢它（因为生成 HTML 的方式很复杂）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T00:39:37.510

在 IE 中开发时，我使用 IE 开发人员工具栏：

[http://www.microsoft.com/en-us/download/details.aspx?id=18359](http://www.microsoft.com/en-us/download/details.aspx?id=18359)

它将允许您在页面上查看呈现的 HTML，并允许您向下钻取并选择要查看的特定元素。有各种突出显示功能，您可以将样式追溯到其来源。

它不是开发人员工具栏的全部和全部，但在那些时候我不能使用 Firefox / Firebug，它比我尝试过的其他解决方案更胜一筹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T00:48:21.267

[IE7 Pro](http://www.ie7pro.com/)提供了一个右键单击和“查看生成的源”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T00:41:25.853

一些想法：

*   [萤火虫精简版](http://getfirebug.com/lite.html)
*   在兼容模式下使用 IE8（及其开发者工具）。
*   MS 为 IE7 创建了一个开发工具栏（有点像 Web Developer FF 扩展）：[http ://www.microsoft.com/downloadS/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038&displaylang=en)
*   临时添加一个带有 onclick 处理程序的链接，以将 document.outerHtml 转储到`<pre>`

# sql-server - 如何处理用户界面中的 db 约束违规？

> ID：574035
> 
> 赞同：13
> 
> 时间：2009-02-22T00:37:50.183
> 
> 标签：sql-server, web-services, error-handling

我们使用存储过程在数据库中实现大部分业务规则。

我永远无法决定如何最好地将数据约束违规错误从数据库传递回用户界面。我正在谈论的约束更多地与业务规则相关，而不是数据完整性。

例如，“无法插入重复键行”之类的 db 错误与业务规则“您不能拥有多个同名 Foo”相同。但是我们已经在最常见的位置“实现”了它：作为一个独特的约束，当违反规则时抛出异常。

其他规则，例如“您每天只允许 100 Foos”不会导致错误，因为它们由自定义代码优雅地处理，例如`return empty dataset`应用程序代码检查并传递回 ui 层。

这就是问题所在。我们的 ui 代码如下所示（这是 AJAX.NET webservices 代码，但任何 ajax 框架都可以）：

```
WebService.AddFoo("foo", onComplete, onError); // ajax call to web service

function onComplete(newFooId) {
    if(!newFooId) {
        alert('You reached your max number of Foos for the day')
        return
    }
    // update ui as normal here
}

function onError(e) {
    if(e.get_message().indexOf('duplicate key')) {
        alert('A Foo with that name already exists');
        return;
    }
    // REAL error handling code here
} 
```

（附带说明：我注意到当您提交评论过快时，stackoverflow 会这样做：服务器生成`HTTP 500`响应并且 ui 捕获它。）

所以你看，我们在这里在两个地方处理业务规则违规，其中一个（即唯一的约束错误）被处理为应该处理*真正*错误（不是业务规则违规）的代码的特殊情况，因为.NET 将异常一直传播到`onError()`处理程序。

这感觉不对。我认为我的选择是：

1.  在应用服务器级别捕获“重复密钥违规”异常并将其*转换*为 ui 期望的任何“违反业务规则”标志，
2.  *抢占*错误（例如，使用 a `"select name from Foo where name = @Name"`）并返回应用服务器期望的任何内容作为“违反业务规则”标志，
3.  与 2) 相同：利用 db 层中内置的唯一约束并盲目地`insert into Foo`捕获任何异常并将其转换为应用程序服务器期望的任何内容作为“违反业务规则”标志
4.  盲目地`insert into Foo`（如 3）并让该异常传播到 ui，*并*让应用服务器将业务规则违规视为真实`Exceptions`（而不是 1）。这样所有错误都在 ui 层的`onError()`（或类似的）代码中处理。

我喜欢 2) 和 3) 的地方在于，违反业务规则的行为是*在它们实施的地方*“抛出”的：在存储过程中。我不喜欢 1) 和 3) 是我*认为*它们涉及愚蠢的检查`"if error.IndexOf('duplicate key')"`，就像目前在 ui 层中的一样。

**编辑**：我喜欢 4)，但大多数人说只在*特殊*`Exception`情况下使用s 。

 ***那么，你们如何优雅地处理将违反业务规则的行为传播到用户界面？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T15:43:45.293

我们不在数据库中执行我们的业务逻辑，但我们确实有我们所有的验证服务器端，低级别的 DB CRUD 操作与更高级别的业务逻辑和控制器代码分开。

我们在内部尝试做的是传递一个带有类似`Validation.addError(message,[fieldname])`. 各个应用层将它们的验证结果附加到该对象上，然后我们调用`Validation.toJson()`以生成如下所示的结果：

```
{
    success:false,
    general_message:"You have reached your max number of Foos for the day",
    errors:{
        last_name:"This field is required",
        mrn:"Either SSN or MRN must be entered",
        zipcode:"996852 is not in Bernalillo county. Only Bernalillo residents are eligible"
    }
} 
```

这可以很容易地在客户端处理以显示与单个字段相关的消息以及一般消息。

关于约束违规，我们使用#2，即我们在插入/更新之前检查潜在的违规并将错误附加到验证对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T07:57:49.580

问题实际上是系统架构的限制之一。通过将所有逻辑推入数据库，您需要在两个地方处理它（而不是构建一层将 UI 与数据库联系起来的业务逻辑。再说一次，一旦您拥有一层业务逻辑，您就会失去所有在存储过程中具有逻辑的好处。不提倡一种或另一种。两者都一样糟糕。或者不糟糕。取决于你如何看待它。

我在哪里？对。

我认为2和3的组合可能是要走的路。

通过先发制人的错误，您可以创建一组过程，可以从面向 UI 的代码中调用这些过程，以向用户提供特定于实现的详细反馈。您不一定需要在逐个字段的基础上使用 ajax 执行此操作，但您可以。

然后数据库中的唯一约束和其他规则成为所有数据的最终完整性检查，并且可以在发送之前假设数据是好的，并且理所当然地抛出异常（前提是这些过程应该始终用有效数据调用，因此无效数据是例外情况）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T08:51:26.097

为了捍卫#4，SQL Server 有一个非常有序的预定义错误严重级别的层次结构。正如您指出的那样，处理逻辑所在的错误很好，我倾向于按照 SP 和 UI 抽象之间的约定来处理这个问题，而不是添加一堆额外的耦合。特别是因为您可以同时使用值和字符串引发错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T00:51:47.013

我见过很多基于 Ajax 的应用程序在用户离开编辑框后立即对用户名等字段进行实时检查（以查看它是否已经存在）。在我看来，这似乎比留给数据库根据 db 约束引发异常更好的方法 - 它更主动，因为你有一个真实的过程：获取值，检查它是否有效，如果不是则显示错误，如果没有错误允许继续。所以看来选项2是一个不错的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T22:49:34.367

存储过程可以使用 RAISERROR 语句将错误信息返回给调用者。这可以用于允许用户界面决定错误将如何出现，同时允许存储过程提供错误的详细信息。

RAISERROR 可以使用*msg_id*、严重性和状态以及一组错误参数调用。以这种方式使用时，具有给定*msg_id*的消息必须已使用 sp_addmessage 系统存储过程输入到数据库中。此*msg_id*可以作为 SqlException 中的 ErrorNumber 属性检索，该属性将在调用存储过程的 .NET 代码中引发。然后，用户界面可以决定要显示什么类型的消息或其他指示。

错误参数被替换到生成的错误消息中，类似于*printf*语句在 C 中的工作方式。但是，如果您只想将参数传递回 UI 以便 UI 可以决定如何使用它们，只需制作错误消息没有文本，只有参数的占位符。一条消息可能是 '"%s"|%d' 以传回一个字符串参数（用引号括起来）和一个数字参数。.NET 代码可以将它们分开并在用户界面中随意使用它们。

RAISERROR 也可以用在存储过程的 TRY CATCH 块中。这将允许您捕获重复键错误，并将其替换为您自己的错误号，这意味着“插入时重复键”到您的代码中，并且它可以包含实际的键值。您的 UI 可以使用它来显示“订单号已存在”，其中“x”是提供的键值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T23:20:13.123

这就是我做事的方式，尽管它可能不适合你：

我通常会选择先发制人的模型，尽管它在很大程度上取决于您的应用程序架构。

对我（在我的环境中）来说，检查中间（业务对象）层中的大多数错误是有意义的。这是所有其他特定于业务的逻辑发生的地方，所以我也尽量保留我的其余逻辑。我认为数据库是保存我的对象的地方。

当涉及到验证时，最简单的错误可能会被困在 javascript 中（格式、字段长度等），尽管您当然永远不会假设这些错误检查发生了。这些错误也会在更安全、更可控的服务器端代码世界中得到检查。

在业务对象层的服务器端代码中检查业务规则（例如“您每天只能拥有这么多 foo”）。

仅在数据库中检查数据规则（参照完整性、唯一字段约束等）。我们也在中间层预先检查所有这些，以避免不必要地访问数据库。

因此，我的数据库只保护自己免受它能够处理的简单的、以数据为中心的规则的影响；更多变数的、面向业务的规则存在于对象领域，而不是记录领域。

# java - 为什么这个小程序有一个destroy方法？

> ID：574056
> 
> 赞同：2
> 
> 时间：2009-02-22T00:53:16.933
> 
> 标签：java, applet

[我一直试图通过研究“Welcome to HotJava”](http://java.sun.com/j2se/1.4.2/docs/guide/misc/applet.html)小程序的代码来了解小程序。我使用 Windows 版本的[Jad](http://www.kpdus.com/jad.html)反编译了 *.class 文件，我看到以下代码行

```
public void init() {
    // Skip some lines...
    addMouseListener(this);
}

public void destroy()
{
    removeMouseListener(this);
} 
```

这里真的需要destroy方法吗？如果小程序即将结束，为什么小程序需要将自己作为鼠标侦听器移除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T01:05:33.533

如果您想留下您的小程序曾经运行过的任何“证据”，那么 destroy() 至关重要......

例如，您可以将所有状态信息发送到文件或服务器以供后续使用，或者让服务器知道您正在断开连接。

想象一下，你有一个聊天应用程序......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T01:17:42.460

该`destroy()`方法清理资源，以便可以释放它们。当整个 JVM 将关闭时，在关闭之前释放所有资源并不那么重要，但即使不是绝对必要，做正确的事情总是一个好主意。

根据线程模型，如果您将自己作为鼠标侦听器，那么如果发生鼠标事件，您仍然会收到通知。如果在同一个 JVM 中有多个 Applet 并且只有一个 Applet 正在结束，那么如果您留下一个不会对其采取任何操作的侦听器，那么您可以让线程处于一种有趣的状态。这样做可能会锁定其他 Applet。

编辑：

对于处于有趣状态的线程，我的意思是（例如）如果 Applet 线程已停止的侦听器正在将消息排队到没有人读取的队列中，那么最终队列将填满并且调度线程将阻塞。（更详细地说，假设侦听器只对消息进行排队，并且 Applet 中有一个线程——现在已停止——从这个队列中读取。一旦队列填满，它将阻塞！）

具体来说，使用鼠标侦听器可能是安全的，假设当 Applet 退出时它不再可见并且不能再接收鼠标事件。但是，如果使用不同类型的听众，您可能会遇到麻烦。总是做正确的事，即使它不是真正必要的，也会让你养成习惯，这样你就不会忘记在真正关键的时候做正确的事。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T01:27:49.313

它在释放存在于小程序上下文之外的资源时很有用。假设您从外部服务器端应用程序中获取了资源，例如许可证。或者您可能需要通知某些服务器端资源应用程序已关闭以进行统计或其他原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T05:05:07.530

好吧，不是在这种*特殊*情况下。但是，最好在 java 中删除鼠标（和其他）侦听器 - 不这样做可能会导致不幸的内存泄漏。

即使没有必要，`destroy()`清理所有所做的事情也是一个好习惯。`init()`

# c++ - 声明结构 C 的元素向量，元素个数为 i（int 类型的输入）

> ID：574060
> 
> 赞同：-2
> 
> 时间：2009-02-22T00:54:25.713
> 
> 标签：c++, stl, stdvector

请看这段代码（并原谅缺乏知识）。它输出我无法解决的错误。我需要声明结构 C 的元素向量，但我需要元素的数量为 i（int 类型的输入）。

我也尝试了其他方法，但在所有这些方法中我都收到了一个错误（无法将 C 转换为 int 等）。我怎样才能做到这一点？

```
# include < iostream >
using std::cout;
using std::cin;
using std::endl;

# include < vector >
using std::vector;

struct C{
    int cor;
    vector<int>cores;

    };

    void LerVector( vector< C> &array ) ;

int main ()
{
     int n;
    bool done=false;
        bool don=false;
    vector<C>cidade;
    int i;

    while(!done){
    cout<<"Entre o número de cidades "<<endl;
    cin>>n;
    if(n>500)
    {
        cout<<endl;
        cout<<"O número máximo é 500"<<endl;
}
else
done=true;
}
n--;
while(!don){
cout<<"Entre o número de confederações"<<endl;
cin>>i;
if(i>100){
cout<<endl;
cout<<"Número máximo de 100 cidades"<<endl;

}
else {

 LerVector(  cidade) ;

don=true;
}
}

    cin.get();
    return 0;
}
//resolve...
 void LerVector( vector< C> &array ) 
  { 
    for ( size_t i = 0; i < array.size(); i++ ) 
      cin>>array[i];

  } // end function inputVector 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T01:07:09.300

让我们尝试解释一下:)

```
cin >> array[i]; 
```

它试图从`cin`struct C 的对象中提取出来。嗯，所以它需要一个 operator>> 来实际工作：

```
istream & operator>>(istream &is, C &c) {
    is >> c.cor; // or into whatever member 
    return is;
} 
```

此外，正如另一个提到的，您必须首先将元素实际添加到向量中：

```
while(!don){
    cout<<"Entre o número de confederações"<<endl;
    ....
} else {
    cidade.resize(i); // resize to i elements
    LerVector(cidade);
    don = true;
} 
```

下次请格式化文本（正确缩进）。我很难通过它:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T01:02:06.163

您的代码产生了哪些错误？

我也不确定你的代码应该做什么。在 main() 中，您创建了一个 C 向量。但 C 还包含一个 int 向量。这是故意的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T01:02:06.443

我不太清楚你想做什么。

但是，我已经可以在我们的代码中看到一个潜在的错误：

在 LerVector 中，您输入的是对当前没有任何项目的向量的引用，因此其大小为 0。

您要做的是，只要 i 小于大小，您就会更新数组中的该项目。但是，当您开始时大小为 0，所以我认为您甚至不会进入输入循环。

现在，即使你这样做了，由于向量没有用任何大小初始化，你可能会得到一个错误，你会越界。您必须调整阵列的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T01:01:10.860

如果我猜你想做什么，应该是这样的：

```
// First create an empty vector of C's
vector<C> cidade;

// cidade has zero elements now
// Read i from user
cin >> i;

// Resize vector to contain i elements
cidade.resize(i);

// Then go on and fill them.
int n;
for (n = 0; n < i; i++) {
  cin >> cores;
  cidade[n].cores.resize(cores);
  // now cidade[n].cores has 'cores' elements, but they are uninitialized
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T01:03:07.347

其中一个`std::vector<T>`构造函数将采用初始大小，如果在该数字之后声明，则可以将其传递给构造函数。

```
cin >> n;
std::vector<C> cidade(n); 
```

或者您可以使用 resize 方法来更改矢量的大小。

或者您可以使用 add 方法来扩展向量（无需明确给出大小）。

但总的来说，使用完整版本的代码和更多关于代码试图做什么的细节提供帮助可能会更容易。

# python - 你如何部署你的 WSGI 应用程序？（以及为什么这是最好的方法）

> ID：574068
> 
> 赞同：42
> 
> 时间：2009-02-22T00:58:37.450
> 
> 标签：python, deployment, wsgi

部署 WSGI 应用程序。有很多方法可以给这只猫剥皮。我目前正在使用 apache2 和 mod-wsgi，但我可以看到一些潜在的问题。

那么怎么做呢？

1.  Apache Mod-wsgi（其他 mod-wsgi 似乎不值得）
2.  纯 Python Web 服务器，例如 paste、cherrypy、Spawning、Twisted.web
3.  作为 2，但使用来自 nginx、apache2 等的反向代理，具有良好的静态文件处理能力
4.  通过桥接器（例如 Flup）转换为其他协议（例如 FCGI）并在常规 Web 服务器中运行。

更多的？

我想知道你是怎么做的，为什么这是最好的方法。我绝对**希望**您能详细介绍有关内容和原因、应用程序特定内容等的详细信息。我会支持任何非疯狂的答案。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-22T01:39:56.040

一如既往：这取决于;-)

当我不需要任何 apache 功能时，我将使用纯 python 网络服务器，例如 paste 等。我猜哪一个完全取决于您的应用程序，可以通过做一些基准测试来决定。我一直想做一些，但从来没有想过。我猜 Spawning 在使用开箱即用的非阻塞 IO 方面可能有一些优势，但我有时会因为它正在做的修补而遇到问题。

当然，您也可以随时在前面放上清漆。

如果需要 Apache，我通常会使用解决方案 3，以便将进程分开。您还可以更轻松地将进程移动到其他服务器等。我只是喜欢将事情分开。

对于静态文件，我现在正在使用一个单独的服务器，用于仅提供静态图像/css/js 的项目。我正在使用 lighttpd 作为具有出色性能的网络服务器（在这种情况下，我前面不再有清漆了）。

另一个有用的工具是[supervisord](http://supervisord.org/)，用于控制和监视这些服务。

我还使用[buildout](http://pypi.python.org/pypi/zc.buildout)来管理我的部署和开发沙箱（与[virtualenv](http://pypi.python.org/pypi/virtualenv)一起）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-22T20:36:33.920

最容易部署的是 CherryPy。您的 Web 应用程序也可以成为独立的 Web 服务器。CherryPy 也是一个相当快的服务器，因为它是用纯 Python 编写的。话虽如此，它不是 Apache。因此，我发现 CherryPy 是低容量 webapps 的不错选择。

除此之外，我认为这个问题没有任何正确或错误的答案。许多大容量网站都是建立在您所谈论的技术之上的，我认为您在这些方式中的任何一种都不会出错（尽管我会说我同意 mod-wsgi 并不是每非 Apache 服务器）。

另外，我一直在使用[isapi_wsgi](http://code.google.com/p/isapi-wsgi/)在 IIS 下部署 python 应用程序。这是一个不太理想的设置，但它很有效，当您生活在以 Windows 为中心的世界中时，您并不总是可以选择其他方式。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-07T22:15:27.943

> 我绝对希望您能详细介绍有关内容和原因、应用程序特定内容等的详细信息

何。好吧，你要求它！

和 Daniel 一样，我个人将 Apache 与 mod_wsgi 一起使用。它仍然很新，在某些环境中部署它可能会很困难，但如果你自己编译所有东西，那很容易。我发现它非常可靠，即使是早期版本。支持格雷厄姆·邓普顿（Graham Dumpleton）几乎独自控制它。

但是对我来说，WSGI 应用程序必须在所有可能的服务器上工作。目前在这个领域有一点漏洞：你有 WSGI 标准告诉你 WSGI 可调用（应用程序）做什么，但是没有标准化的部署；没有一种方法可以告诉 Web 服务器在哪里可以找到应用程序。当您更新应用程序时，也没有标准化的方法可以让服务器重新加载应用程序。

我采用的方法是：

*   模块/包中的所有应用程序逻辑，最好在类中

*   通过子类化主应用程序和覆盖成员来完成所有特定于网站的定制

*   所有特定于服务器的部署设置（例如数据库连接工厂、邮件中继设置）作为类 __init__() 参数

*   一个顶级的“application.py”脚本，它使用当前服务器的正确部署设置初始化应用程序类，然后以可以部署为 CGI 脚本、mod_wsgi WSGIScriptAlias（或Passenger，显然工作方式相同），或者可以从命令行进行交互

*   一个帮助模块，负责处理上述部署问题，并允许在应用程序依赖的模块发生更改时重新加载应用程序

所以 application.py 最终的样子是这样的：

```
#!/usr/bin/env python

import os.path
basedir= os.path.dirname(__file__)

import MySQLdb
def dbfactory():
    return MySQLdb.connect(db= 'myappdb', unix_socket= '/var/mysql/socket', user= 'u', passwd= 'p')

def appfactory():
    import myapplication
    return myapplication.Application(basedir, dbfactory, debug= False)

import wsgiwrap
ismain= __name__=='__main__'
libdir= os.path.join(basedir, 'system', 'lib')
application= wsgiwrap.Wrapper(appfactory, libdir, 10, ismain) 
```

wsgiwrap.Wrapper 每 10 秒检查一次以查看 libdir 中的任何应用程序模块是否已更新，如果更新了，则一些讨厌的 sys.modules 魔术会可靠地卸载它们。然后 appfactory() 将被再次调用以获取更新应用程序的新实例。

（您也可以使用命令行工具，例如

```
./application.py setup
./application.py daemon 
```

运行应用程序可调用提供的任何设置和后台任务挂钩 - 有点像 distutils 的工作方式。它还像初始化脚本一样响应启动/停止/重启。）

我使用的另一个技巧是将多个服务器（开发/测试/生产）的部署设置放在同一个 application.py 脚本中，然后嗅探“socket.gethostname()”来决定使用哪个服务器特定的设置。

在某些时候，我可能会将 wsgiwrap 打包并正确发布（可能使用不同的名称）。同时，如果您有兴趣，可以在[http://www.doxdesk.com/file/software/py/v/wsgiwrap-0.5.py](http://www.doxdesk.com/file/software/py/v/wsgiwrap-0.5.py)看到 dogfood-development 版本。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-11T18:06:50.380

Nginx 反向代理和静态文件共享 + XSendfile + uploadprogress_module。没有什么比它更好的了。

在 WSGI 方面，Apache + mod_wsgi 或cherrypy 服务器。我喜欢将cherrypy wsgi 服务器用于内存较少且请求较少的服务器上的应用程序。

推理：

我已经为不同的流行解决方案使用不同的工具进行了基准测试。

与 Web 开发相比，我在较低级别的 TCP/IP 方面有更多经验，尤其是 http 实现。我更有信心识别一个好的 http 服务器，而不是识别一个好的 web 框架。

我比 Django 或 Pylons 更了解 Twisted。Twisted 中的 http 堆栈还没有达到这个要求，但它会在那里。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T12:47:38.523

我正在将 Google App Engine 用于我正在开发的应用程序。它运行 WSGI 应用程序。 [这里有一些关于它的信息。](http://code.google.com/appengine/docs/python/gettingstarted/usingwebapp.html)

这是我真正开发过的第一个网络应用程序，所以我没有比较的基础，但如果你是谷歌的粉丝，你可能想研究一下。使用它作为我的学习框架，我获得了很多乐趣。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-10T07:08:23.823

## 涡轮齿轮 (2.0)

[TurboGears 2.0](http://turbogears.org/2.0/docs/index.html)将在下个月内离开*Beta 版（已经使用了很长时间）。*2.0 在 1.0 系列的基础上进行了改进，并尝试为您提供同类最佳的 WSGI 堆栈，因此如果您想要最少的麻烦，它会为您提供一些默认选择。

它具有`tg*`1.x 系列中用于测试和部署的工具，但现在已转换为`paster`2.0 系列中的等效工具，如果您已经体验过`pylons`.

```
tg-admin 快速入门 —> 粘贴快速入门
tg-admin 信息 —> 粘贴 tginfo
tg-admin 工具箱 -> 粘贴工具箱
tg-admin 外壳 –> 粘贴外壳
tg-admin sql create –> paste setup-app development.ini

```

## 塔架

如果您希望在您的 WSGI 堆栈中更加灵活（ORM 的选择、模​​板程序的选择、形成的选择），Pylons 正在成为统一的选择。这将是*我推荐的选择*，因为它提供了出色的文档并允许您尝试不同的组件。

因此，很高兴使用它，并且可以在 Apache（生产部署）或独立（有助于测试和实验阶段）下工作。

因此，您可以同时使用 Pylons：

*   # 2 测试阶段选项（`python`独立）

*   # 4 用于可扩展的生产目的（`FastCGI`假设您选择的数据库可以跟上）

Pylons 管理界面与 TurboGears 非常相似。*这是一个独立*的玩具示例：

```
$ paster create -t​​ pylons helloworld
$ cd helloworld
$ paster serve --reload development.ini
```

对于生产级部署，您可以参考[此处](http://wiki.pylonshq.com/display/pylonscookbook/Production+Deployment+Using+Apache,+FastCGI+and+mod_rewrite)`Apache + FastCGI + mod_rewrite`提供的设置指南。这将扩大到大多数需求。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T21:53:23.327

Apache httpd + mod_fcgid 使用 web.py（这是一个 wsgi 应用程序）。

奇迹般有效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-04T21:48:27.207

我们将纯粘贴用于我们的一些网络服务。它很容易部署（使用我们的内部部署机制；我们不使用 Paste Deploy 或类似的东西），并且可以最大限度地减少生产系统与开发人员工作站上运行的系统之间的差异。警告：由于我们请求的重量级性质，我们不期望 Paste 本身的低延迟。在我们做的一些粗略的基准测试中，我们并没有得到*很好*的结果。由于我们典型的请求处理程序的开销，它最终变得没有意义。到目前为止，它运行良好。

静态数据由完全独立的（并且在某种程度上“有机地”增长的）堆栈处理，包括以各种方式使用 S3、Akamai、Apache 和 IIS。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-05T21:34:32.553

阿帕奇+mod_wsgi，

简单，干净。（只有四行网络服务器配置），其他系统管理员很容易掌握。

# multithreading - 螺纹的实际用途

> ID：574072
> 
> 赞同：3
> 
> 时间：2009-02-22T01:01:05.557
> 
> 标签：multithreading

在您的工作中，您使用线程的具体用途是什么？

（请描述应用程序以及线程如何帮助/增强应用程序。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T01:03:31.620

线程对于大多数 UI 工作至关重要。否则，任何时候你想进行计算或任何需要一段时间的事情，你都会冻结 UI。

因此，大多数 GUI 框架都有处理事件循环（和一些绘图活动）的 UI 线程，但大多数用户代码发生在另一个线程中。

线程对于偶尔检查事物或对系统状态进行间歇性更改也很有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T01:09:55.130

（不太严肃的回答）我喜欢在任何我希望系统以有趣且不明显的方式陷入困境的情况下使用线程，同时仍然可以合理地否认我如何让问题溜走。

或者，用 Rasmus Lerdorf 的话来说，“人们不够聪明，无法编写线程安全的代码”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T01:06:09.053

在服务器中处理并发客户端请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T01:22:09.670

线程是大多数 I/O 绑定应用程序和任何相当复杂的服务器端应用程序的基础。考虑一个应用程序，它充当具有多个数据源的信息交换。您需要能够在独立线程中处理此信息，特别是如果对此数据的操作存在延迟或需要大量时间才能完成。

在大多数情况下，线程通常有助于解耦应用程序中的各种关注点。在绝大多数情况下，将事件分派给相关方的单线程无法很好地扩展。

除了最简单的应用程序之外，所有应用程序都在某种程度上需要线程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T01:03:09.250

最常见的用途是响应式 UI，例如为长时间运行的后台任务显示进度条。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T01:05:38.680

后台任务：

*   处理网络连接和协议。
*   在多媒体应用程序的后台运行声音合成。
*   在多媒体应用程序的后台进行文件加载（CD 流）

其他用途：

*   通过在两个不同的线程中运行相同代码的两个实例来加速某些算法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-22T01:13:50.720

我知道大多数时候我使用线程，我真正想做的是启动一些异步工作块——即我希望在神话的“背景”中发生一些事情。不幸的是，考虑线程并不是“启动一些工作”的正确抽象级别，因为您没有将某些东西放入后台。使用线程 API，您正在创建另一个地方来运行作为进程原始线程的兄弟的东西，并且需要担心它们之间共享哪些信息，以及如何共享等等。这就是为什么我喜欢更新的 API，比如 Cocoa`NSOperation`和`NSOperationQueue`. 在该 API 的情况下，启动一些工作只是一行代码，库负责是否应该启动新线程或重用旧线程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T01:38:52.423

我构建 Web 应用程序，因此我编写的所有代码都在多个线程中执行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-22T01:55:11.743

我们的应用程序是一个 Web 服务，因此我们为每个请求生成一个线程。从技术上讲，JNI 产生线程，但无论如何代码都必须是线程安全的。我们在 Hibernate 和我们基于 ESB 的基础架构中遇到了一些有趣的 (FSVO) 问题，但在大多数情况下，将内容保存在 ThreadLocals 中并在子系统入口点上进行同步工作得很好。我们还没有尝试超过几十个同时请求，所以很可能有一些我们尚未确定的竞争条件，但总的来说我们表现出色并给出了正确的答案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-22T02:07:31.077

我编写了一个函数，它会生成一个线程，该线程会定期发出哔哔声（来自扬声器），以提醒测试操作员需要注意一些事情。模态对话框响应后，线程被杀死。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-22T02:11:53.030

与就业无关，但我正在为[Netflix Prize](http://netflixprize.com/)做一些兼职工作。我的电脑有 8 个内核和 20 GB 的 RAM ... 只运行 1 个线程将是完全浪费，所以我通常启动 16 个线程左右。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-22T01:02:50.967

扫描目录以查找更改的文件。每个子目录生成一个线程然后在单个线程中执行要快得多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-22T01:05:56.950

我们一直在为几个应用程序使用线程，其中主屏幕由为当前登录用户量身定制的工作流组成。

获取工作流程可能会耗费大量时间。工作流的各个部分由不同的线程加载。对于我们的主应用程序 BP/GeNA，大约有 11 个线程被触发，每个线程都运行一个数据库查询。

问候，
利文

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-22T01:07:35.120

当我想用一堆我知道需要很长时间的资源做某事时，我最常使用线程，当处理元素的工作之间没有相互依赖关系时，特别是如果瓶颈不是本地资源（比如磁盘的 CPU）。例如，如果我有一堆要检索的 URL，每个 URL 都会进入一个单独的线程。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-22T01:21:27.490

这是一个非常普遍的问题。我已经使用“线程”将潜在的阻塞工作从 UI 线程中移除，无论该工作是本地还是网络 I/O，或者该工作是计算密集型任务，这些任务往往会“阻塞”，具体取决于运行它的硬件.

我认为询问有助于缓解它的特定问题或模式以及线程的适用性更有趣，即：

*   线程如何与模型视图控制器相关？
*   我应该如何或为什么要从 UI 线程中取出工作以确保 UI 甚至不会考虑阻塞？
*   线程池如何像其他人提到的那样对递归（网络）目录遍历有用？
*   我应该为计算密集型任务的协作调度关联线程，还是应该使用 ThreadPool 并让操作系统在它认为合适的时候抢先调度线程。

这是一个相当广阔的空间，更清晰可能会有所帮助。

# asp.net-mvc - 使用 ASP.NET MVC 创建 API - 全部在一个项目中，还是在两个项目中？

> ID：574082
> 
> 赞同：4
> 
> 时间：2009-02-22T01:04:19.963
> 
> 标签：asp.net-mvc, api

所以我已经记录了。创建 API 以访问我们的应用程序的要求。并非所有控制器操作都包含在 API 中（可能是 50%）。

我想我可以使用同一个项目，检查每个请求的 http 标头，并根据需要使用 xml、JSON 或 html 响应（很像 rails）。

或者

创建一个新的 ASP.NET MVC 应用程序，部署 @api.myapp.com 并将其专门用于 API 访问。

我假设我可以为第一个选项编写一个基本控制器来处理 99% 的工作。第一个选项的问题是我们不需要（或不想要）至少 1/2 的控制器操作的 API 功能（并且可能永远不会）。

在第二个选项中，我有一些控制器的副本，但好消息是大多数/全部？我的控制器操作只是几行代码。通常：

```
Whatever whatever = new Whatever(....);
repository.Save(whatever); 
```

无论如何，堆栈溢出者是怎么想的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T08:25:49.717

您似乎想创建类似 REST 服务的东西。请看一下[Phil Haack 的这篇文章](http://haacked.com/archive/2009/01/06/handling-formats-based-on-url-extension.aspx)。
是的，我相信你可以把它放在同一个项目中。但最好以某种方式将它们分开（使用 MvcContrib 中的区域或移动 api 和 Web 应用程序的控制器来分离组件，就像在[SharpArchitecture](http://code.google.com/p/sharp-architecture/)中完成的那样。如果您的控制器重复了很多代码，您可以创建通用控制器，例如：

```
public class ControllerBase<T, Service> : Controller
where Service : IService<T>
{
    public Service service { get; set; }
    public ActionResult Save(int id)
    {
        var item = service.Get(id);
        if (TryUpdateModel<T>(item))
        {
            service.Save(item);
            return View("Success");
        }
        return View("Error", item);
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T02:24:22.237

我想我会投入同一个项目，但使用单独的路线将其隔离。

```
API: http://example.com/api/widget/list
App: http://example.com/widget/list 
```

然后，您可以尽可能多地重用代码——例如，将数据选择和其他代码推送到您的 BLL 中。将其保存在同一个项目中将使通过客户端的 AJAX 使用您的 API 代码变得更加容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T23:34:12.600

我认为从长远来看，将相同的代码放在 2 个不同的项目中是自找麻烦。

将它们全部放在同一个项目中。

如果您需要在常规请求与 API 请求之间进行一些分隔，您可以使用单独的路由。

然后，您可以创建一个执行该操作的私有函数，并让面向公众的函数决定以 html 或 JSON/XML 呈现

# ruby - 从 ruby 脚本进行调用并将值传递给 vbscript

> ID：574083
> 
> 赞同：3
> 
> 时间：2009-02-22T01:04:26.203
> 
> 标签：ruby, vbscript

是否可以从 ruby​​ 脚本调用 vbscript？基本上，我正在我的 ruby​​ 脚本中创建一个具有随机名称的临时文件夹，我想调用 vbscript 并传递该文件夹的名称以执行下一个操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T01:50:46.810

尝试使用您的脚本调用 Windows 脚本宿主 ( `cscript`)：

```
 system "cscript //nologo script.vbs #{random_filename}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T01:10:34.363

使用系统并将其作为命令行参数传递

```
system "script.vbs #{random_filename}" 
```

# c# - C# 关闭表单的好方法

> ID：574099
> 
> 赞同：1
> 
> 时间：2009-02-22T01:12:14.407
> 
> 标签：c#, forms, design-patterns

说我想打开一个新表格..

```
TestForm test = new TestForm(); 
```

关闭它的好方法是什么？更准确地说，只调用 close() 可以吗？我应该使用 using() {} 所以调用 dispose() 吗？最后，假设有一个对话框应该只打开一个对话框实例，是否有一个众所周知的模式？我有不同的选择，例如将其存储在静态字段中，并在关闭时将其归零。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T01:14:13.683

`using`每当对象实现`IDisposable`. 这仅适用于模态对话框：

```
using (TestForm test = new TestForm())
{
    ....
} 
```

它在语法上等同于`try{}finally{}`块，因此即使在花括号内抛出异常，`Dispose()`也会在您的对象上调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T01:24:31.210

那么就您的单实例对话框而言（如果它是模态的，您不必担心），您可以将构造函数设为私有并提供一个公共静态方法来访问表单。

```
public class MyForm : Form
{
    protected MyForm()
    {
    }

    protected int MyValue { get; set; }

    public static int GetResult()
    {
        using(MyForm myForm = new MyForm())
        {
            if(myForm.ShowDialog == DialogResult.OK)
                return myForm.MyValue;   
        }
        return -1;
    }
} 
```

这将迫使呼叫以..

```
int someValue = MyForm.GetResult(); 
```

# algorithm - 保证唯一代理键分配 - 非二分图的最大匹配

> ID：574107
> 
> 赞同：1
> 
> 时间：2009-02-22T01:17:59.947
> 
> 标签：algorithm, graph-theory, surrogate-key

我正在维护一个数据仓库，其中包含关于必须合并的一类实体的多个数据源。每个源都有一个自然键，并且应该发生的是，始终为每个自然键创建一个且只有一个代理键。如果来自一个源系统的具有特定自然键的一条记录与来自具有不同自然键的另一个源系统的另一条记录表示相同的实体，则将为两者分配相同的代理键。

换句话说，如果源系统 A 具有与源系统 B 的自然键 DEF 表示相同实体的自然键 ABC，我们将为两者分配相同的代理键。该表如下所示：

```
SURROGATE_KEY   SOURCE_A_NATURAL_KEY    SOURCE_B_NATURAL_KEY
 1               ABC                     DEF 
```

这就是计划。但是，这个系统已经生产了一段时间，代理键分配是一团糟。在源系统 B 知道之前，源系统 A 会在某一天给出自然键 ABC。DW 为其分配了代理键 1。然后源系统 B 开始给出自然键 DEF，它表示与源系统 A 的自然键 ABC 相同的东西。DW 错误地给了这个组合代理键 2。该表如下所示：

```
SURROGATE_KEY   SOURCE_A_NATURAL_KEY    SOURCE_B_NATURAL_KEY
 1               ABC                     NULL
 2               ABC                     DEF 
```

所以仓库乱七八糟。还有比这更复杂的情况。我有一个很短的清理时间表，需要找出一组干净的自然键映射的代理键。

一点谷歌搜索表明，这可以建模为非二分图中的匹配问题：

[维基百科 - 匹配](http://en.wikipedia.org/wiki/Matching)

[MIT 18.433 组合优化 - 非二分匹配讲义](http://math.mit.edu/~goemans/18433S07/edmonds.pdf)

我需要 Edmond 的路径、树和花算法的易于理解的实现（不是最佳执行）。我没有正式的数学或计算机科学背景，我所拥有的是自学的，而且我今晚不在数学上。任何人都可以帮忙吗？一个指导我实现的写得很好的解释将不胜感激。

编辑：

数学方法是最优的，因为我们想要最大化全局适应度。贪婪的方法（首先获取 A 的所有实例，然后是 B，然后是 C...）会将您绘制到局部最大值角落。

无论如何，我把这个推回业务分析师手动完成（全部 2000 万）。我正在帮助他们评估全局匹配质量。这是理想的，因为无论如何他们都是签字的人，所以我的背面被遮住了。

不使用代理键不会改变匹配问题。仍然需要发现和维护 1:1 自然键映射。代理键是一个方便的锚，仅此而已。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T03:47:27.403

我的印象是您以错误的方式处理此问题；正如 cdonner 所说，还有其他方法可以重建关键结构而不会经历这种混乱。特别是，您需要保证自然键对于给定记录**始终是唯一**的（违反此条件是您陷入困境的原因！）。拥有两者`ABC`并`DEF`识别相同的记录是灾难性的，但最终是可以修复的。我什至不确定你为什么需要代理键。虽然它们确实有很多优点，但我会考虑使用纯关系并将它们从您的模式中剔除，例如 la Celko；它可能会让你摆脱这个烂摊子。但这是在查看整个架构后必须做出的决定。

为了解决您的潜在解决方案，我拿出了我的 DB West 的*图论简介*，第二版，它在第 144 页描述了开花算法。您需要一些数学背景，包括数学符号和图论，才能遵循算法，但它足够简洁，我认为它可以提供帮助（如果你决定走这条路）。如果您需要解释，请先咨询有关图论的资源（维基百科、您当地的图书馆、谷歌等），或​​者询问您是否没有找到您需要的东西。

> **3.3.17。算法。**（Edmonds 的 Blossom 算法 [1965a]---草图）。
> 
> **输入。**一个图`G`，一个匹配`M`，`G`一个-`M`不饱和顶点`u`。
> 
> **主意。**探索`M`从 的交替路径`u`，为每个顶点记录到达它的顶点，并在找到时收缩花朵。维护集合`S`，`T`类似于算法 3.2.1 中的集合，`S`包含`u`和 顶点沿饱和边到达。到达不饱和顶点会产生增强。
> 
> **初始化。** `S = {u}`和`T = {}`（空集）。
> 
> **迭代。**如果`S`没有未标记的顶点，则停止；没有`M`从`u`. 否则，请选择未标记`v`的`S`. 从探索开始`v`，依次考虑每一个`y`在`N(v)`这样`y`的不在的`T`。
> 
> 如果`y`不饱和`m`，则从`y`（根据需要扩展花朵）追溯以报告`M`-augmenting `(u, y)`-path。
> 
> 如果`y`在 中`S`，则已找到一朵花。暂停对花朵的探索`v`和收缩，将其顶点替换为 中的`S`和`T`中的单个新顶点`S`。在较小的图中从该顶点继续搜索。
> 
> 否则，`y`与某些`w`by匹配`M`。包括`y`在`T`（从 到达`v`）和包括`w`在`S`（从 到达`y`）。
> 
> 在探索了 的所有这些邻居之后`v`，标记`v`并迭代。

此处描述的算法运行时间为 O(n^4)，其中 n 是顶点数。West 给出了运行速度为 O(n^5/2) 或 O(n^1/2 m)（m 是边数）的版本的参考。如果你想要这些参考资料，或者对 Edmonds 原始论文的引用，只要问，我就会从索引中挖掘出来（这本书很烂）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T03:16:01.660

我认为通过建立一组规则并使用一组以迭代方式强制执行每个规则的简单查询来攻击您的键映射表，您会做得更好。也许我过于简单化了，因为您的示例很简单。

以下是规则示例 - 只有您可以决定哪些规则适用：

*   如果有重复项，请使用最低（最旧）的代理键
*   使用具有最高（最新）代理键的行中的自然键
*   使用最完整映射行中的自然键
*   使用最近出现的每个自然键
*   ... ?

一旦你建立了规则，编写重建你的键映射的查询是微不足道的。我不确定这怎么可能是一个数学问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T02:06:51.537

如果您正在寻找一个实现，Eppsteins [PADS](http://www.ics.uci.edu/~eppstein/PADS/)库有一个匹配算法，这对于您的目的应该足够快，通用匹配算法在 CardinalityMatching.py 中。实现中的注释解释了发生了什么。该库易于使用，要在 Python 中提供图形，您可以使用字典 G 表示图形，这样 G[v] 会给出顶点 v 的邻居列表（或集合）。

例子：

```
G = {1: [1], 2:[1,3], 3: [2,4], 4:[3]} 
```

给出一个有 4 个顶点的折线图.

# asp.net-mvc - ASP.NET Web 表单作为 ASP.NET MVC

> ID：574108
> 
> 赞同：2
> 
> 时间：2009-02-22T01:18:43.737
> 
> 标签：asp.net-mvc, webforms

我很抱歉可能对标题产生误导，但我不知道合适的标题。

随意编辑。

无论如何，我正在使用 ASP.NET Web 表单，也许这不是 Web 表单的用途，但我喜欢手动构造和填充 HTML 元素。它给了我更多的控制权。

我不使用 DataBinding 之类的东西。我使用 SqlConnection、SqlCommand 和 SqlDataReader，设置 SQL 字符串等，并从 DataReader 读取数据。如果你喜欢，老学校。:)

我确实创建了 WebControls，这样我就不必每次需要一些控件时都复制粘贴，但大多数情况下，我需要 WebControls 以呈现为 HTML，以便我可以将该 HTML 附加到其他一些函数中，该函数使用控件呈现最终输出里面。

我知道我可以使用 control.RenderControl(writer) 渲染控件，但这只能在 (pre)Render 或 RenderContents 覆盖中完成。

例如。

我有一个 dal.cs 文件，其中存储了与数据库通信的所有静态函数和空隙。函数大多返回字符串，以便可以将其附加到其他函数中以呈现最终结果。

我这样做的原因是我想尽可能地将编码与 HTML 分开，这样我就不会在 HTML 中执行 <% while (dataReader.Read()) %> 并显示数据。我把它移到了 CodeBehind 中。我还使用此函数在 HttpHandler 中呈现 AJAX 响应。

效果很好，但是当我想添加一个控件（ASP.NET 服务器控件（.cs 扩展名，而不是 .ascx））时，我不知道该怎么做，所以我看到我自己编写了与函数相同的控件返回字符串或该控件内的另一个函数，该函数返回字符串并替换 RenderContents 执行的作业，以便在需要将控件附加到另一个字符串时调用该函数。我知道这可能不是一个很好的做法。

当我看到所有关于 ASP.NET MVC 的教程/视频时，我认为它适合我的需求，就像 MVC 你必须自己构建所有东西（或大部分）一样，我现在已经在使用 Web 表单.

在这个长长的介绍之后，我想问我如何构建我的控件，以便我可以像我提到的那样使用它们（返回字符串），或者我必须忘记服务器控件并将控件构建为函数并以这种方式使用它们？使用 ASP.NET 服务器控件（.cs 扩展名）是否有可能，或者当我说我没有正确使用它时我是对的。

为了清楚起见，我说的是如何正确使用 Web 表单，但要避免数据绑定，因为我想自己构建所有内容（在 Code Behind 中渲染 HTML）。
有人可能会认为我正在附加诸如“some”+“string”之类的字符串，但我不是。我为此使用 StringBuilder，所以没有缓慢。

欢迎任何意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-22T01:39:58.817

您需要停止考虑“控件”和网络表单。MVC 是一种完全不同的构建应用程序的方式。

我也讨厌 WebForms 中的自动渲染器，它们生成的 html 毫无意义。但是，您不想在代码隐藏中编写 html 并将其作为字符串传递，这很讨厌。您的演示代码与您的逻辑混合在一起，并且您正在用 c# 字符串编写 HTML ！！！

所以，MVC ...而不是与代码隐藏和回发进行交互的“小部件”，您的视图仅显示数据并包含允许您发布到控制器的表单。

因此，您可以将视图强类型化为 Type，然后通过 Model 属性访问从控制器传递给它的数据。与 UserControl 等效的是部分视图 (ViewUserControl)，可用于模块化您的渲染代码类型。例如，您可能会创建一个地址，每次需要渲染时，您都将您的 Person 的 Address 属性传递给该地址。这样你就不会到处重复 html。

PS 为所有 DAL 提供一个文件？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T05:32:14.517

我希望我*永远* 不必在你以这种方式编写的应用程序上工作**。**如果您的应用程序是字符串繁重的，那么就有问题了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T08:04:54.210

同意@sliderhouserules，您使用 MVC 框架的方式很糟糕。你必须忘记你所有的“老派”技术。您永远不应该在页面代码中使用 SqlCommands、SqlReaders 等。您应该只将模型（例如 View(bar)）传递给视图，如果您避免使用

```
ViewData["some magic string"] = bar 
```

每次使用“老派”技术时，都会杀死 2 个人和 2 只猫 :)。
此外，最好使用一些 ORM（对象关系映射器），如 Linq2sql、NHibernate、SubSonic 等。
如果您需要良好的应用程序设计示例，请查看[SharpArchitecture](http://code.google.com/p/sharp-architecture/)。它有一个非常好的架构和实现，可能会有很大帮助。它有一个示例（带有 Northwind db），很快将添加一个示例。
另请查看[CodeCampServer](http://code.google.com/p/codecampserver/)。它也有很好的架构。
最好看这些项目的代码而不是看视频，因为现有的视频无法展示良好的架构示例，只是简单的功能使用。
关于服务器控件，如果它们可以在没有 'runat="server"' 的情况下使用，您可以使用它们，例如 PlaceHolder。你也可以创建它们，但你不应该直接在其中加载任何数据。如果您不想复制粘贴 html，您应该检查您的代码并重构它。每个重复的代码都应该移动到 UserControls（ascx 的）的 MasterPages。
再一次，请花一些时间查看这些样本。当您需要更新应用程序或修复某些问题时，您将节省您的精力和时间。乍一看，他们可能很难理解，但这只是第一眼。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T00:04:16.777

如果您想要 ASP.NET MVC 路径，您可以将控件设置为 ASCX，它们将只是由控制器填充的标记。然而，这对你来说可能还不够老派。

如果您愿意，可以在代码后面创建完整的 UI。这可以包括在例程中创建 HTML。

但是，我建议，如果您坚持使用 ASP.NET，请重新考虑通过 DataReader.Read() 和输出 + 循环的绑定模型。它不仅是旧样式，而且效率极低且难以维护。

ASP.NET MVC 确实创建了一个更松散的 ASPX，因为它只是一个视图。并且代码和 UI 的分离度要大得多。但它也不适合旧学校的模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T13:18:41.300

您是否考虑过使用[微模板](http://ejohn.org/blog/javascript-micro-templating/)？Dave Ward 有一个很好的[客户端数据转发器](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)示例，它在调用页面方法后使用微模板进行布局。这听起来更像是您想要完成的精神，并且仍然可以与 WebForms 很好地集成。

副作用将是您将不依赖于传递 HTML，并且可以将您的演示文稿与您的逻辑隔离开来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-21T07:29:58.910

@lopkiju，如果您想要对输出 HTML 进行如此多的控制，我认为 MVC 模式会比您当前的 WebForms 解决方案更好地为您服务。
您可以像以前一样以这种方式使用 Web 表单，但它并非设计为以这种方式使用，因此会很痛苦。

**更多详情**

在我看来，阅读一些关于[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)（也称为 SoC）原则的文章。如果你正确地应用它，它可以在你调试你的应用程序时为你省去很多麻烦，也可以为那些与你一起工作的人（例如，那些可能需要阅读或修改你的源代码的人）省去很多麻烦。

我给你的另一个提示是：你是对的，你不应该在你的视图代码中
做类似的事情。`<% while (dataReader.Read()) %>`但也许有更好的方法让它比你现在的方法更优雅。

我认为您应该考虑为这些目的使用某种 ORM。（LINQ to SQL，甚至 NHibernate。）如果你得到它，它会简单得多。如此之多以至于您可能不想`DataReader`再次直接使用 s 。:-)

**我为你推荐的**

只需阅读[NerdDinner 教程](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)，然后自己一步一步构建示例应用程序。
之后，尝试自己构建一个用于不同目的的类似应用程序，同时应用您在教程中应用的相同规则和设计。

我很确定你有这方面的专业知识，并且在实际使用它之后，你几乎可以感受到它。

本教程**还**解释并包含了我上面提到的原则，这对你很有用。

# c# - 应用程序.DoEvents();

> ID：574110
> 
> 赞同：4
> 
> 时间：2009-02-22T01:21:19.673
> 
> 标签：c#, multithreading

如何让我的 C# 表单（比如说在 for 循环中）不被锁定？我是否调用 Application.DoEvents(); 在循环之前还是之后？据我所知，使用 DoEvents 方法可以防止我的应用程序被锁定。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-22T01:31:30.320

您不应该使用 Application.DoEvents() 来保持您的应用程序响应。

调用此方法将允许发送任何等待的 Windows 消息。这意味着如果用户单击按钮（或执行任何其他用户交互），则将处理该操作。因此，这可能会导致重入。如果他们按下与导致您正在处理的循环的按钮相同的按钮，您最终将在完成之前再次调用例程！

相反，您应该使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)线程来执行长流程，然后在操作完成后执行所需的任何其他操作。例如，一旦按下按钮，您将启动工作线程，然后禁用您的按钮，使其无法再次按下。一旦工作线程完成，您将再次启用该按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T01:29:01.730

有几种方法，这（DoEvents）只是强制消息泵处理消息。有些人将 Thread.Sleep 放在线程中的循环末尾（尽管总是在循环内）。您在线程中到底在做什么，因为可能有更好的方法来实现您的总体目标？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T01:32:23.390

如果进程导致 UI 锁定了不可接受的时间，请尝试使用单独的线程（创建它、使用线程池或使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类。

# mod-rewrite - 在 IIS7 上使用 Joomla 重写 URL

> ID：574123
> 
> 赞同：5
> 
> 时间：2009-02-22T01:28:43.773
> 
> 标签：mod-rewrite, iis-7, seo, joomla

我在 IIS7 上运行了 Joomla 1.5.9。我现在正在尝试使用 Joomla 全局配置页面中的 SEO 设置。

首先，我玩弄了搜索引擎友好的 URL（摆脱了 URL 的查询部分）；效果很好。

我还尝试启用“使用 Apache mod_rewrite”。我安装了“Microsoft URL Rewrite Module for IIS 7.0”并按照[http://learn.iis.net/page.aspx/527/joomla-on-iis](http://learn.iis.net/page.aspx/527/joomla-on-iis)添加了 web.config 。单击菜单链接时，这似乎起作用，因为我不再在 URL 中看到 index.php。地址栏会更新为正确的 URL，但显示的内容始终是主页的内容。我在 IE 和 Google Chrome 中都尝试过，结果相同。加载后刷新页面没有任何区别。

我尝试重新启动 IIS7，但没有任何区别。

编辑：在我遵循以下建议之后（遵循[http://www.mydotnetworld.com/post/2008/10/24/URL-Rewriting-In-Joomla-15-on-IIS-7.aspx](http://www.mydotnetworld.com/post/2008/10/24/URL-Rewriting-In-Joomla-15-on-IIS-7.aspx)的说明：打开快速的 cgi、修改的 php.ini 和导入的重写规则，而不是自己将它们放在 web.config 中），我现在得到 404 而不仅仅是显示主页的内容。该 URL 似乎仍被正确重写。所以，不同的行为，但仍然不起作用。我不确定这是不是有用的信息，但是这两个字段显示在 404 页面中： Requested URL [http://localhost:80/joomla_course/seasonal-specialties](http://localhost:80/joomla_course/seasonal-specialties) 物理路径 C:\inetpub\wwwroot\joomla_course\seasonal-specialties物理路径是否应该是“未重写”的 URL？还是预期会是这样？

编辑2：哦！我发现有人在 Joomla 论坛上发布了同样的问题：http: [//forum.joomla.org/viewtopic.php](http://forum.joomla.org/viewtopic.php?f=543&t=364706&p=1598137#p1598137) ?f=543&t=364706&p=1598137#p1598137 。不过，那里也没有答案。

关于如何诊断（甚至更好，修复:)）的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:28:11.830

我现在开始工作了。关键是确保使用 FastCGI 运行 php（根据[http://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis-70](http://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis-70)），并确保启用了“使用 Apache mod_rewrite”。如果“使用 Apache mod_rewrite”已关闭，但 IIS7 中存在重写规则，则 HTML 会显示，但不会显示样式或图像。

使用 FastCGI 的要求很奇怪（并且与[http://maximumpcguides.com/windows-vista/how-to-create-a-windows-vista-iis7-mysql-php-web-server](http://maximumpcguides.com/windows-vista/how-to-create-a-windows-vista-iis7-mysql-php-web-server)中的建议相矛盾，即我最初用来设置 php 的东西）。不使用 FastCGI 时似乎一切正常，除了 URL 重写。

似乎要么导入规则（如[http://www.mydotnetworld.com/post/2008/10/24/URL-Rewriting-In-Joomla-15-on-IIS-7.aspx](http://www.mydotnetworld.com/post/2008/10/24/URL-Rewriting-In-Joomla-15-on-IIS-7.aspx)中所建议）或手动添加将它们添加到 web.config 文件（如[http://learn.iis.net/page.aspx/527/joomla-on-iis](http://learn.iis.net/page.aspx/527/joomla-on-iis)中的建议）将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T21:11:26.747

看起来 web.config 中的规则有问题。仅仅从对您链接的文章的评论开始，您并不是唯一一个遇到此问题的人。我将删除 web.config，然后按照[此处](http://www.mydotnetworld.com/post/2008/10/24/URL-Rewriting-In-Joomla-15-on-IIS-7.aspx)列出的步骤进行操作。

# python - 许多控制器（子视图）的一个视图（frontpage）

> ID：574140
> 
> 赞同：1
> 
> 时间：2009-02-22T01:42:10.573
> 
> 标签：python, model-view-controller, pylons, cherrypy

*注意：*不能使用 Javascript 或 iframe。事实上，我不能相信客户端浏览器可以做任何事情，除了超基础。

我正在将一个遗留的 PHP4 应用程序重建为一个 MVC 应用程序，我目前的大部分研究都集中在 Pylon 的框架上。

我遇到的第一个奇怪问题之一，过去我通过使用 iframe 或更好的 JavaScript 解决了一个问题，它显示了一个动态的“小部件”集合，就像典型控制器的索引视图的摘要视图。

可视化我的问题的最佳方法是查看 Google 的个性化主页。他们用 Javascript 解决了这个问题，但是对于我的场景来说，javascript 和几乎任何高于基本 XHTML 的东西都是不可能的。

我开始研究的一个想法是让我的 Frontpage 控制器为当前激活的小部件轮询数据库或其他服务，然后获取元组/字典列表，动态实例化每个控制器并构建渲染子视图的列表/字典并传递到首页视图，让它解决问题。

所以使用 peusudo 代码：

```
Get request goes to WSGI
WSGI calls pylons
Pylons routes to Frontpage.index()
Frontpage.index() 
   myViews = list()
   for WidgetController in ActiveWidegets():
        myViews.append(subRender(WidgetController, widgetView))

c.subviews = myViews
render(frontpage.mako) 
```

关于 subRender 的奇怪之处

*   `__import__`通过（当前硬编码到项目的命名空间：（）动态导入控制器
*   有可能非常昂贵（大多数小部件调用可以被缓存，但一个是用户面板）

我觉得必须有一种更好的方法，或者可能已经在 WSGI 或更好的 Pylons 中实现了一种机制来做到这一点，但到目前为止，我发现的最接近的是这个实用方法： http: [//www.pylonshq.com/ docs/en/0.9.7/modules/controllers_util/#pylons.controllers.util.forward](http://www.pylonshq.com/docs/en/0.9.7/modules/controllers_util/#pylons.controllers.util.forward)`N`但在 pylons 之上构建 pylons实例只是为了获得集合视图似乎有点疯狂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T04:08:31.680

虽然在大多数情况下，我会推荐您最初所说的，使用 Javascript 加载每个小部件，因为这不是一个选项，我认为您需要做一些不同的事情。

除了使用尝试让单个前端控制器遍历所有需要的小部件并构建它们的方法之外，您可能要考虑的另一种方法是更强大地使用 Mako 中的模板。

您实际上可以将小块定义为 Mako def 的，这当然具有完整的 Python 功能。为避免域逻辑污染您的 Mako 模板，请确保将所有内容保留在您的模型中，并根据需要调用 Mako def 中的模型实例，以便页面组件自行构建。

这种方法的一个巨大优势是，由于 Mako def 支持缓存参数，您实际上可以让页面的组件决定如何缓存自己。也许侧边栏应该被缓存 5 分钟，但例如，顶栏每次点击都会改变。此外，由于组件正在触发 db hit，因此当组件缓存自身时，您将保存 db hit。

ToscaWidgets 没有性能使其成为更大规模的非常可行的选择，所以我不会尝试它。

至于对您现有想法的一些调整，请确保实际上不要将 Pylons 控制器用于“小部件”，因为它们在支持 WSGI 时需要做更多工作，而您不需要构建小部件页面。

我会考虑让所有 Widget 类都像这样工作：

```
class Widget(object):
    def process(self):
        # Determine if this widget should process a POST aimed at it
        # ie, one of the POST args is a widget id indicating the widget
        # to handle the POST

    def prepare(self):
        # Load data from the database if needed in prep for the render

    def render(self):
        # return the rendered content

    def __call__(self):
        self.process()
        self.prepare()
        return self.render() 
```

然后让您的主 Mako 模板遍历小部件实例，并调用它们来渲染它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T07:03:57.870

您可以使用[ToscaWidgets](http://toscawidgets.org/)来封装您的小部件，以及为每个用户启用的小部件的存储列表（在数据库或其他服务中，如您所建议的那样）。将启用的 ToscaWidgets 列表传递给视图，小部件将呈现自己（包括在小部件需要这些资源时动态添加 CSS/JavaScript 引用到页面）。

# c++ - 什么是缓冲区溢出，如何导致？

> ID：574159
> 
> 赞同：32
> 
> 时间：2009-02-22T02:05:42.173
> 
> 标签：c++, buffer-overflow, fortify-source

我听说过缓冲区溢出，我想知道如何导致缓冲区溢出。

有人可以给我看一个小的缓冲区溢出示例吗？新的（它们的用途是什么？）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-22T02:27:43.383

缓冲区溢出的经典示例：

```
// noone will ever have the time to type more than 64 characters...
char buf[64];
gets(buf); // let user put his name 
```

单独的缓冲区溢出通常不会故意发生。它最常发生是因为所谓的“一个接一个”错误。这意味着您将数组大小错误地计算了一个 - 可能是因为您忘记考虑终止空字符，或者因为其他一些东西。

但它也可以用于一些邪恶的东西。事实上，用户早就知道这个漏洞，然后插入说 70 个字符，最后一个字符包含一些特殊字节，这些字节会覆盖一些堆栈槽 - 如果用户真的很棘手，他/她会点击堆栈中的返回地址槽, 并覆盖它，使其向前跳转到刚刚插入的缓冲区：因为用户输入的不是他的名字，而是他之前编译并转储的 shell 代码。然后那个将被执行。有一些问题。例如，您必须安排在该二进制代码中不包含“\n”（因为gets 会停止读取那里）。对于其他与危险字符串函数混淆的方式，二进制零是有问题的，因为字符串函数停止复制到缓冲区。人们用过`xor`两次相同的值也可以产生零，而无需明确写入零字节。

这是经典的做法。但是有一些安全块可以告诉我们发生了这样的事情，以及其他使堆栈不可执行的东西。但我想有比我刚才解释的更好的技巧。一些汇编人员现在可能会告诉你关于那个的长篇大论:)

### 如何避免它

****如果您不能100%**确定缓冲区是否足够大，请**始终**使用带有最大长度参数的函数。不要玩“哦，数量不会超过5个字符”之类的游戏——它总有一天会失败。请记住，科学家曾说过一枚火箭的数量不会超过某个数量级，因为火箭永远不会那么快。但是有一天，它*实际上*更快了，结果是整数溢出和火箭坠毁（这是关于[Ariane 5](http://en.wikipedia.org/wiki/Ariane_5_Flight_501)中的一个错误，这是历史上最昂贵的计算机错误之一）。**

 **例如，而不是使用`fgets`. 而不是在合适和可用的地方`sprintf`使用`snprintf`（或者只是像 istream 之类的 C++ 风格的东西）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-22T02:12:27.507

缓冲区溢出基本上是指内存的精心设计的部分（或缓冲区）被写入其预期范围之外。如果攻击者能够设法从程序外部实现这一点，它可能会导致安全问题，因为它可能允许他们操纵任意内存位置，尽管许多现代操作系统可以防止最坏的情况发生。

虽然超出预期范围的读取和写入通常被认为是一个坏主意，但术语“缓冲区溢出”通常保留用于超出范围的*写入*，因为这可能导致攻击者轻松修改代码运行方式。Wikipedia 上有一篇关于[缓冲区溢出](http://en.wikipedia.org/wiki/Buffer_overflow)以及它们可用于漏洞利用的各种方式的好文章。

就您如何自己编程而言，这将是一个简单的问题：

```
char a[4];
strcpy(a,"a string longer than 4 characters"); // write past end of buffer (buffer overflow)
printf("%s\n",a[6]); // read past end of buffer (also not a good idea) 
```

是否编译以及运行时会发生什么可能取决于您的操作系统和编译器。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-12-07T09:31:54.040

在现代 linux 操作系统中，如果没有一些额外的实验，你就无法利用缓冲区溢出。为什么 ？因为您将被这个现代 GNU C 编译器中的**ASLR**（地址堆栈层随机化）和**堆栈保护器阻止。**你不会轻易定位内存，因为内存会落入由**ASLR**引起的随机内存。如果您尝试溢出程序，您将被**堆栈保护器阻止。**

首先，您需要将 ASLR 设置为 0 默认值为 2

```
root@bt:~# cat /proc/sys/kernel/randomize_va_space
2
root@bt:~# echo 0 > /proc/sys/kernel/randomize_va_space
root@bt:~# cat /proc/sys/kernel/randomize_va_space
0
root@bt:~# 
```

在这种情况下，不是关于您可能从互联网上获得的 OLD STYLE 缓冲区溢出教程。或 aleph one 教程现在将不再在您的系统中工作。

现在让我们制作一个缓冲区溢出场景的程序漏洞

```
---------------------bof.c--------------------------
#include <stdio.h>
#include <string.h>

int main(int argc, char** argv)
{
        char buffer[400];
        strcpy(buffer, argv[1]);

        return 0;
}
---------------------EOF----------------------------- 
```

看 strcpy 函数在没有堆栈保护器的情况下是危险的，因为函数没有检查我们将输入多少字节。使用额外选项**-fno-stack-protector dan -mpreferred-stack-boundary=2**编译以在 C 程序中取消堆栈保护器

```
root@bt:~# gcc -g -o bof -fno-stack-protector -mpreferred-stack-boundary=2 bof.c
root@bt:~# chown root:root bof
root@bt:~# chmod 4755 bof 
```

SUID root 访问场景的缓冲区溢出 C 程序现在我们已经完成了。现在让我们搜索我们需要将多少字节放入缓冲区以造成程序分段错误

```
root@bt:~# ./bof `perl -e 'print "A" x 400'`
root@bt:~# ./bof `perl -e 'print "A" x 403'`
root@bt:~# ./bof `perl -e 'print "A" x 404'`
Segmentation fault
root@bt:~# 
```

你看我们需要 404 字节来制造程序分段错误（崩溃）现在我们需要多少字节来覆盖**EIP**？EIP是指令将在之后执行。所以黑客确实会在程序的二进制 SUID 中将**EIP**覆盖到他们想要的邪恶指令中。如果程序在 SUID 根目录下，该指令将在根目录下运行。

```
root@bt:~# gdb -q bof
(gdb) list
1       #include <stdio.h>
2       #include <string.h>
3
4       int main(int argc, char** argv)
5       {
6               char buffer[400];
7               strcpy(buffer, argv[1]);
8
9               return 0;
10      }
(gdb) run `perl -e 'print "A" x 404'`
Starting program: /root/bof `perl -e 'print "A" x 404'`

Program received signal SIGSEGV, Segmentation fault.
0xb7e86606 in __libc_start_main () from /lib/tls/i686/cmov/libc.so.6
(gdb) run `perl -e 'print "A" x 405'`
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /root/bof `perl -e 'print "A" x 405'`

Program received signal SIGSEGV, Segmentation fault.
0xb7e800a9 in ?? () from /lib/tls/i686/cmov/libc.so.6
(gdb) 
```

程序 GOT 分段错误返回码。让我们输入更多字节并查看 EIP 寄存器。

```
(gdb) run `perl -e 'print "A" x 406'`
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /root/bof `perl -e 'print "A" x 406'`

Program received signal SIGSEGV, Segmentation fault.
0xb7004141 in ?? ()
(gdb)

(gdb) run `perl -e 'print "A" x 407'`
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /root/bof `perl -e 'print "A" x 407'`

Program received signal SIGSEGV, Segmentation fault.
0x00414141 in ?? ()
(gdb) 
```

再多一点

```
(gdb) run `perl -e 'print "A" x 408'`
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /root/bof `perl -e 'print "A" x 408'`

Program received signal SIGSEGV, Segmentation fault.
0x41414141 in ?? ()
(gdb)

(gdb) i r
eax            0x0      0
ecx            0xbffff0b7       -1073745737
edx            0x199    409
ebx            0xb7fc9ff4       -1208180748
esp            0xbffff250       0xbffff250
ebp            0x41414141       0x41414141
esi            0x8048400        134513664
edi            0x8048310        134513424
eip            0x41414141       0x41414141 <-- overwriten !!
eflags         0x210246 [ PF ZF IF RF ID ]
cs             0x73     115
ss             0x7b     123
ds             0x7b     123
es             0x7b     123
fs             0x0      0
gs             0x33     51
(gdb) 
```

现在你可以做你的下一步...

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-22T02:11:42.627

缓冲区溢出只是写到缓冲区的末尾：

```
int main(int argc, const char* argv[])
{
    char buf[10];
    memset(buf, 0, 11);
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-22T02:21:43.630

除了已经说过的内容之外，请记住，当发生缓冲区溢出时，您的程序可能会“崩溃”，也可能不会“崩溃”。它*应该*会崩溃，你应该希望它会崩溃——但是如果缓冲区溢出“溢出”到你的应用程序也分配的另一个地址——你的应用程序可能会在更长的时间内正常运行。

如果您使用的是 Microsoft Visual Studio 的更高版本 - 我建议在 stdlib 中使用新的安全对应版本，例如 sprintf_s insted of sprintf 等...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T02:21:31.540

这应该足以重现它：

```
void buffer_overflow() 
{
    char * foo = "foo";
    char buffer[10];

    for(int it = 0; it < 1000; it++) {
        buffer[it] = '*';
    }

    char accessViolation = foo[0];
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-22T03:44:31.513

“经典”缓冲区溢出示例是：

```
int main(int argc, char *argv[])
{
    char buffer[10];
    strcpy(buffer, argv[1]);
} 
```

这使您可以使用缓冲区溢出参数并将它们调整为您的心满意足。“[黑客 - 剥削的艺术](https://rads.stackoverflow.com/amzn/click/com/1593271441)”一书（链接到亚马逊）非常详细地介绍了如何解决缓冲区溢出问题（显然纯粹是一种智力练习）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-22T09:03:14.663

如果你想检查你的程序是否有缓冲区溢出，你可以使用[Valgrind](http://valgrind.org/)之类的工具来运行它。他们会为您找到一些内存管理错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-12T13:25:30.063

这是对您收到的答案的一般性评论。例如：

> ```
> int main(int argc, char *argv[])
> {
>     char buffer[10];
>     strcpy(buffer, argv[1]);
> } 
> ```

和：

> ```
> int main(int argc, const char* argv[])
> {
>     char buf[10];
>     memset(buf, 0, 11);
>     return 0;
> } 
> ```

在现代 Linux 平台上，这可能无法按预期或预期工作。由于 FORTIFY_SOURCE 安全功能，它可能不起作用。

`memcpy`FORTIFY_SOURCE 使用和等高风险函数的“更安全”变体`strcpy`。当编译器可以推断目标缓冲区大小时，它会使用更安全的变体。如果副本超出目标缓冲区大小，则程序调用`abort()`.

要为您的测试禁用 FORTIFY_SOURCE，您应该使用`-U_FORTIFY_SOURCE`或编译程序`-D_FORTIFY_SOURCE=0`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-22T02:11:51.407

在这种情况下，缓冲区是为特定目的留出的一部分内存，缓冲区溢出是当对缓冲区的写操作不断超过末尾时发生的（写入具有不同目的的内存）。这*始终*是一个错误。

缓冲区溢出攻击是使用此错误来完成程序作者不打算实现的事情。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-22T08:33:07.077

给出正确答案：要深入了解该主题，您可能需要收听 Podcast Security Now。在[第 39 集](http://www.grc.com/securitynow.htm#39)（不久前）中，他们深入讨论了这个问题。这是一种无需消化整本书即可获得更深入理解的快速方法。

（在链接中，如果您比较注重视觉，您会找到具有多种尺寸版本的存档以及成绩单）。音频不是这个主题的*完美*媒介，但史蒂夫正在努力解决这个问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-05T11:07:47.703

缓冲区溢出是插入超出分配的内存可以容纳的字符。

# iphone - UIPickerView 中的文本右对齐

> ID：574163
> 
> 赞同：8
> 
> 时间：2009-02-22T02:08:34.553
> 
> 标签：iphone, uipickerview

如何正确对齐 a 中的文本`UIPickerView`？我尝试`UILabel`为行视图制作自定义 s，但由于某种原因，没有显示任何内容，无论是右对齐还是其他。这是我写的：

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view {
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectZero];
    [label setText:[NSString stringWithFormat:@"row %d", row]];
    [label setTextAlignment:UITextAlignmentRight];
    return [label autorelease];
} 
```

如果有人想知道，我使用`CGRectZero`它是因为我在`UICatalog`示例中看到了它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-12-06T11:40:48.890

我在选择器中使用了两个组件和两个数组来设置特定组件中行的标题。

下面的代码将使用选取器的默认字体和字体大小在中心显示选取器数据。它将提供精确的pickerdata显示行为，pickerdata的中心对齐。

这里，

```
NSArray *component1Array=[NSArray arrayWithObjects:@"0 lbs",@"1 lbs",@"2 lbs",@"3 lbs",@"4 lbs",@"5 lbs",nil];

NSArray *component2Array=[NSArray arrayWithObjects:@"0.00 oz",@"0.25 oz",@"0.50 oz",@"0.75 oz",@"1.00 oz",nil];

     - (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
        {
             //I have taken two components thats why I have set frame of my "label" accordingly. you can set the frame of the label depends on number of components you have... 

             UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 145, 45)];

             //For right alignment of text,You can set the UITextAlignmentRight of the label.  
             //No need to set alignment to UITextAlignmentLeft because it is defaulted to picker data display behavior.

             [label setTextAlignment:UITextAlignmentCenter];
             label.opaque=NO;
             label.backgroundColor=[UIColor clearColor];
             label.textColor = [UIColor blackColor];
             UIFont *font = [UIFont boldSystemFontOfSize:20];
             label.font = font;
             if(component == 0)
             {
                 [label setText:[NSString stringWithFormat:@"%@",[component1Array objectAtIndex:row]]];
             }
             else if(component == 1)
             {
                 [label setText:[NSString stringWithFormat:@"%@", [component2Array objectAtIndex:row]]];
             }
             return [label autorelease];
        } 
```

如果您使用上述方法，您应该在下面评论提及 UIPickerView 委托方法...

```
-(NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component 
```

上面示例代码的输出将如下所示

![替代文字](https://i.stack.imgur.com/NEbWK.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T03:37:11.623

由于 CGRectZero，您什么也看不到。您需要根据自己的情况设置大小。

在 UICatalog 中，如果您谈论他们如何将 CGRectZero 用于 CustomView ......好吧，如果您查看 CustomView.m，您会发现他们实际上忽略了 CGRectZero 并在 initWithFrame 中将框架设置为大小：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T02:22:58.360

在 iOS 6 中，您现在可以返回一个 NSAttributedString，它可以包含文本对齐属性。我在这里发布了另一个相关问题的简短片段：[https ://stackoverflow.com/a/14035356/928963](https://stackoverflow.com/a/14035356/928963)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T11:05:15.807

确保你：

*   提供所需的高和宽的显式框架；
*   适当地设置标签的显示不透明度（通过 .opaque = YES 或 NO）和背景颜色（通常分别需要 NO 和 [UIColor clearColor]）。
*   明确设置字体。

# dns - 在域名服务器打开 whois 记录之前，DNS 服务器不响应是否正常？

> ID：574165
> 
> 赞同：2
> 
> 时间：2009-02-22T02:09:08.187
> 
> 标签：dns, nameservers

我有人告诉我，DNS 服务器只有在 whois 记录更新为指向其 DNS 服务器后才开始响应。这是正常行为吗？或者 DNS 服务器是否应该在更新 whois 记录之前做出响应？

此外，一旦域处于活动状态（因此在添加域之后或更新 whois 记录之后，取决于上述问题的答案）名称服务器应该开始响应多长时间？

我不是指在互联网上传播所需的时间，而只是在域的名称服务器上的时间。我也不关心互联网的其余部分何时看到更改，只是想知道在使用以下命令时该 DNS 服务器应该何时响应：

```
 nslookup www.example.com ns1.dnsserver.com 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T02:45:05.540

要找到 DNS 服务器，您所称的*whois 记录*必须知道在哪里可以找到它们。
严格来说，whois 记录包含的不仅仅是域的 DNS 服务器，但我们不要吹毛求疵。

假设您的 DesktopA 需要连接到`example.com`，将联系以下服务器，假设您的 ISP 的 DNS 或本地计算机尚未缓存答案。

*   DesktopA 具有指向 ISP 的 DNS 设置，因此 DektopA 将询问 ISP 的 DNS 服务器是否知道其`example.com.`位置（其 IP）。

*   ISP DNS服务器不知道，所以它会联系[根域数据库](http://en.wikipedia.org/wiki/Root_domain)（`com.`所有[完全限定的域名](http://en.wikipedia.org/wiki/Fqdn)都以a结尾`.`，尽管我们一般不显式使用它，但你可以尝试在web请求中插入它，它应该工作正常）。
    这个全局根服务器的引导列表通常由操作系统定期更新。根服务器将知道要为每个全局域（例如、、等
    ）联系哪个顶级域 TLD 服务器。 在我们的示例中，ISP 将询问根服务器来查询域。 根服务器以 .COM TLD 服务器之一的 IP 地址进行应答。`.com``.org``.uk`
    `com`

*   ISP DNS 服务器现在将联系 .COM TLD 服务器并询问它在哪里可以找到示例。
    .COM 数据库记录`example.com`将包含 2 个（或更多）与域名一起注册的 DNS 服务器`example.com`。这些是您的 whois 记录的一部分。

*   ISP 现在拥有 DNS 服务器的 IP 地址，用于`example.com`whois 中的设置。它将查询第一个（如果第一个不可用，则查询第二个）并询问它：'example.com' 的 IP 是什么？

*   例如，DNS 服务器`example.com`将查看其记录并返回为`example.com`域定义的 A 记录作为 IP `1.2.3.4`。

*   您的 ISP 的 DNS 服务器会将此信息缓存一段预定的时间 (TTL)，并将 IP 1.2.3.4 返回给 DesktopA。

*   桌面 A 现在`example.com`可以通过其 IP 直接联系服务器。
    DesktopA 可能会将此信息缓存一段时间以便快速查找。

对于诸如`www.example.com`或之类的子域，这将是相同的`john.people.example.com`。域之前的所有内容都`example.com`必须在您的 DNS 服务器中声明，因此当有人查询他们的地址时，您的 DNS 服务器`example.com`可以查找定义并回答它们（如果需要，它也可以很好地将它们传递给另一台服务器）。

**综上所述**

因此，回到您的问题，您的 whois 记录必须设置为您的域的正确 DNS 记录，然后任何人都可以使用该域名访问它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T02:42:53.657

DNS 服务器与 Whois 服务器完全分开运行。Whois 后 DNS 更新速度的关系完全取决于注册商。注册商或网络主机可能会在客户在控制面板中进行更改后的一两秒内更新 DNS，或者如果他们以批处理模式进行更新，则可能需要几分钟或几小时。

理想情况下，客户请求的所有 DNS 更改都应该在 DNS 服务器上快速发生（几秒钟内），但正如您所注意到的，在更改通过 Internet 传播之前可能会有延迟。

# c# - 这个基本 Java 方法的等效 C# 方法是什么？

> ID：574171
> 
> 赞同：2
> 
> 时间：2009-02-22T02:12:06.633
> 
> 标签：c#, java, stringbuffer

这里真的很简单的问题（更多地证实我的想法，而不是任何事情）......

Java方法：[StringBuffer.Delete(start,end)](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuffer.html#delete(int,%20int))；

Java代码：

```
sb.delete(sb.length()-2, sb.length()); 
```

C#（不确定这是否正确）：

```
StringBuilder sb = new StringBuilder();
....
sb.Remove(sb.Length - 2, sb.Length - (sb.Length - 2)); 
```

我不确定的原因是在Java delete 方法的文档中。它说

> 子字符串从指定的开头开始并延伸到索引 end - 1 处的字符，如果不存在这样的字符，则延伸到 StringBuffer 的末尾

我只是不太确定这个***结局——***那句话的一点点……如果我可能把事情搞砸了。

干杯:)

编辑：呵呵。我知道它正在从字符串中删除最后 2 个字符，但我保持转换准确，因此我的代码很冗长。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T02:17:21.957

要删除您要编写的最后 2 个字符：

```
sb.Remove(sb.Length - 2, 2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T02:21:27.797

对，那是正确的。“end - 1”表示如果您调用 delete(2, 8)，它会删除索引为 2 到 7 的字符，但不会删除索引为 8 的字符。

所以，你的代码是正确的。然而，一些数学技能在这里会派上用场，你会看到：

```
x - (x - 2)
= x - x + 2
= (x - x) + 2
= 0 + 2
= 2 
```

制作代码：

```
sb.Remove(sb.Length - 2, 2); 
```

做同样事情的另一种方法是：

```
sb.Length -= 2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T02:20:33.523

在 Java 的 delete 调用中，它从 start 到 end-1 删除字符。无论您指定多久，C# 调用都会从开头删除一个字符串。

# text - “标签云”生成器？

> ID：574173
> 
> 赞同：10
> 
> 时间：2009-02-22T02:13:08.160
> 
> 标签：text, cloud, tag-cloud

我想在我正在进行的项目中添加一个“标签云”。我通过谷歌看到了很多，但它们似乎大多是“输入网址”类型。

这是我的意思的一个例子：

[![](https://i.stack.imgur.com/2wCym.png)](https://i.stack.imgur.com/2wCym.png)

我正在寻找一个有

*   一个不错的可通过网络访问的 api
*   独立的本地可执行文件（首选 linux）
*   一个可链接的库（c，python 首选）

当然，其他选项和建议表示赞赏！

**更新：似乎我正在寻找的通常称为*标签云*而不是*文本云*，即使我有兴趣使用它来查看文本块。**

***更新 2：最优秀的 Jonathan Feinberg 和 IBM 发布了 Wordle……万岁！！！***

> [http://www.wordle.net](http://www.wordle.net)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-05T21:17:40.147

这个问题很老，已经回答了，但我想说[Wordcram](http://wordcram.org/)似乎非常好。而且它是开源的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-22T02:40:01.373

我不确定您指的是简单的（ala [Flickr](http://www.flickr.com/photos/tags/)）[标签云](http://en.wikipedia.org/wiki/Tag_Cloud)，还是像[Wordle](http://www.wordle.net/)这样更复杂的东西。

无论如何，如果您正在寻找一个简单的标签云，那么自己实现它不会太难（只要您已经有能力呈现 HTML），因为它只是改变每个项目的大小和/或颜色基于其频率（或其他一些措施）。

如果您想使用现有库，您可以查看其中一个开源 php 版本，例如[Tag Cloud](http://www.lotsofcode.com/demo/tag-cloud-v2/)，只需使用 php 在您的机器上本地运行它们，而不是通过 Web 服务器。只需安装 php 并运行`php filename.php`类似于执行 python 脚本的方式。

查看 Wordle 服务，似乎没有办法自动创建一个，因为他们使用 java 小程序生成图形，使用`curl`. [但是，他们的常见问题解答中](http://www.wordle.net/faq#redx)确实有一个关于 API 的问题：

> *您能否将 Wordle 公开为生成图像的 Web 服务？*
> 
> 一个可扩展的 Web 服务应该花费不超过几十毫秒的时间来完成它的工作。在 Java 运行时中创建 Wordle 需要几秒钟。（那个漂亮的动画不是用来展示的；它实际上是在动画过程中布置东西）。因此，Wordle 将始终将 CPU 密集型内容分配给您、用户和您的 CPU。
> 
> 在撰写本文时，Wordle 每秒可承受 10 次点击。地球上没有办法以这种速度渲染 Wordles。好吧，有一种方法，但它涉及的钱比我拥有的要多得多。

此外，这个[先前的问题](https://stackoverflow.com/questions/227/whats-the-best-way-to-generate-a-tag-cloud-from-an-array-using-h1-through-h6-f)可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-19T19:13:33.500

以下是标签云的两个 Python 版本：

*   [https://github.com/atizo/PyTagCloud](https://github.com/atizo/PyTagCloud)
*   [http://peekaboo-vision.blogspot.de/2012/11/a-wordcloud-in-python.html](http://peekaboo-vision.blogspot.de/2012/11/a-wordcloud-in-python.html)

这些天我搜索了很多，似乎这两个是少数几个“独立”标签云生成器中的一些，它们在命令行上运行在 Linux 中（特别是在 python 中运行的那些）。

# c++ - win32 C++上的按钮样式

> ID：574177
> 
> 赞同：1
> 
> 时间：2009-02-22T02:19:26.943
> 
> 标签：c++, winapi

我知道有一些样式可以放在 C++ win32 exa 中的按钮上。像 BS_DEFPUSHBUTTON BS_RADIOBUTTON 但我不知道所有这些以及我将如何制作用户绘制的按钮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T02:23:18.493

您可以在 MSDN 上找到[所有按钮样式的参考（和往常一样）。](http://msdn.microsoft.com/en-us/library/bb775951(VS.85).aspx)以及Button 控件的总体[概述。](http://msdn.microsoft.com/en-us/library/cc678951(VS.85).aspx)

要创建所有者绘制的按钮，您需要指定`BS_OWNERDRAW`标志并[`WM_DRAWITEM`](http://msdn.microsoft.com/en-us/library/bb775923(VS.85).aspx)在按钮父窗口中处理通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T03:36:41.983

如果您只想调整按钮绘制算法，您应该查看[DrawThemeBackground](http://msdn.microsoft.com/en-us/library/bb773289.aspx) API - 它允许您使用标准 Windows 主题引擎使用的相同视觉效果来绘制按钮。

但是，当禁用主题（当 OpenTheme 失败时）时，您确实需要小心处理这种情况 - 在这种情况下，不幸的是，您只能靠自己了。

# android - Android YouTube 应用播放视频意图

> ID：574195
> 
> 赞同：154
> 
> 时间：2009-02-22T02:37:17.977
> 
> 标签：android, youtube, android-intent, emulation

我创建了一个应用程序，您可以在其中下载适用于 Android 的 YouTube 视频。现在，我想要它，这样如果你在 YouTube 原生应用中播放视频，你也可以下载它。为此，我需要知道 YouTube 原生应用程序为了播放 YouTube 应用程序而发出的 Intent。
如果我的模拟器上有 YouTube 程序，我可以很容易地做到这一点，所以我的第一个问题是：
1\. 我可以为我的模拟器下载 YouTube 应用程序，或者......
2\. 用户选择视频时使用的意图是什么用于播放。

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2012-09-15T17:03:02.523

这个怎么样：

```
public static void watchYoutubeVideo(Context context, String id){
    Intent appIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube:" + id));
    Intent webIntent = new Intent(Intent.ACTION_VIEW,
                Uri.parse("http://www.youtube.com/watch?v=" + id));
    try {
        context.startActivity(appIntent);
    } catch (ActivityNotFoundException ex) {
        context.startActivity(webIntent);
    }
} 
```

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2009-08-21T02:28:47.023

根据[Lemmy 的回答](https://stackoverflow.com/a/599119/50776)，这将适用于*设备*，但不适*用于模拟器*。

```
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.youtube.com/watch?v=cxLG2wtE7TM"))); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2011-08-18T22:45:45.333

以下是我解决此问题的方法：

```
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube://" + video_id));
startActivity(intent); 
```

现在我已经做了更多的研究，看起来我只需要'vnd.youtube:VIDEO_ID'而不是冒号后面的两个斜杠（':' vs. '://'）：

[http://it-ride.blogspot.com/2010/04/android-youtube-intent.html](http://it-ride.blogspot.com/2010/04/android-youtube-intent.html)

我在这里尝试了大多数建议，但对于所有引发异常的所谓“直接”方法，它们并不能很好地工作。我会假设，使用我的方法，如果未安装 YouTube 应用程序，则操作系统具有默认的后备位置，而不是使应用程序崩溃。理论上，该应用程序只能在装有 YouTube 应用程序的设备上运行，因此这应该不是问题。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-09-07T12:56:47.170

使用我的代码..我可以使用此代码播放 youtube 视频...您只需要在“videoId”变量中提供 youtube 视频 ID ....

```
String videoId = "Fee5vbFLYM4";
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube:"+videoId)); 
intent.putExtra("VIDEO_ID", videoId); 
startActivity(intent); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-11-15T05:00:02.103

```
Intent videoClient = new Intent(Intent.ACTION_VIEW);
videoClient.setData(Uri.parse("http://m.youtube.com/watch?v="+videoId));
startActivityForResult(videoClient, 1234); 
```

`videoId`必须播放的 youtube 视频的视频 ID在哪里。此代码在**Motorola Milestone**上运行良好。

但基本上我们可以做的是检查启动 Youtube 应用程序时加载了哪些活动，并相应地替换 packageName 和 className。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-01T02:27:59.097

Youtube（和 Market 应用程序）只能与谷歌为 G1 和 G2 发布的特殊 ROM 一起使用。因此，不幸的是，您不能像 Emulator 中使用的那样在 OpenSource-ROM 中运行它们。好吧，也许你可以，但不是以官方支持的方式。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-02-21T09:31:45.447

编辑：以下实现被证明在至少某些 HTC 设备上存在问题（它们崩溃了）。出于这个原因，我不使用 setclassname 并坚持使用动作选择器菜单。我强烈反对使用我的旧实现。

**以下是旧的实现：**

```
Intent intent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse(youtubelink));
if(Utility.isAppInstalled("com.google.android.youtube", getActivity())) {
    intent.setClassName("com.google.android.youtube", "com.google.android.youtube.WatchActivity");
}
startActivity(intent); 
```

其中 Utility 是我自己的个人实用程序类，具有以下方法：

```
public static boolean isAppInstalled(String uri, Context context) {
    PackageManager pm = context.getPackageManager();
    boolean installed = false;
    try {
        pm.getPackageInfo(uri, PackageManager.GET_ACTIVITIES);
        installed = true;
    } catch (PackageManager.NameNotFoundException e) {
        installed = false;
    }
    return installed;
} 
```

首先我检查是否安装了 youtube，如果安装了，我告诉 android 我更喜欢哪个包来打开我的意图。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-18T19:41:04.000

找到了：

```
03-18 12:40:02.842: INFO/ActivityManager(68): Starting activity: Intent { action=android.intent.action.VIEW data=(URL TO A FLV FILE OF THE VIDEO) type=video/* comp={com.google.android.youtube/com.google.android.youtube.YouTubePlayer} (has extras) } 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-07-21T18:45:55.433

回复老问题，只是为了通知你们包已经改变，这里是更新

```
Intent videoClient = new Intent(Intent.ACTION_VIEW);
videoClient.setData("VALID YOUTUBE LINK WITH HTTP");
videoClient.setClassName("com.google.android.youtube", "com.google.android.youtube.WatchActivity");
startActivity(videoClient); 
```

这很好用，但是当您使用 ACTION_VIEW 和有效的 youtube URL 调用普通 Intent 时，用户仍然会得到 Activity 选择器。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-02-17T00:12:55.327

在不同的应用程序上运行视频的最安全方法是首先尝试解析包，换句话说，检查该应用程序是否安装在设备上。因此，如果您想在 youtube 上播放视频，您可以执行以下操作：

```
public void playVideo(String key){

    Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube:" + key));

    // Check if the youtube app exists on the device
    if (intent.resolveActivity(getPackageManager()) == null) {
        // If the youtube app doesn't exist, then use the browser
        intent = new Intent(Intent.ACTION_VIEW,
                Uri.parse("http://www.youtube.com/watch?v=" + key));
    }

    startActivity(intent);
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-02-10T12:05:30.263

Youtube 现在有一个播放器 api，你应该试试。

[https://developers.google.com/youtube/android/player/](https://developers.google.com/youtube/android/player/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-10-04T05:37:12.060

```
/**
 * Intent to open a YouTube Video
 * 
 * @param pm
 *            The {@link PackageManager}.
 * @param url
 *            The URL or YouTube video ID.
 * @return the intent to open the YouTube app or Web Browser to play the video
 */
public static Intent newYouTubeIntent(PackageManager pm, String url) {
    Intent intent;
    if (url.length() == 11) {
        // youtube video id
        intent = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube://" + url));
    } else {
        // url to video
        intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
    }
    try {
        if (pm.getPackageInfo("com.google.android.youtube", 0) != null) {
            intent.setPackage("com.google.android.youtube");
        }
    } catch (NameNotFoundException e) {
    }
    return intent;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-11-06T13:40:12.253

如果安装了 youtube 应用程序，这将起作用。如果没有，将出现一个选择器来选择其他应用程序：

```
Uri uri = Uri.parse( "https://www.youtube.com/watch?v=bESGLojNYSo" );
uri = Uri.parse( "vnd.youtube:" + uri.getQueryParameter( "v" ) );
startActivity( new Intent( Intent.ACTION_VIEW, uri ) ); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-11-08T23:47:32.423

你也可以抓住`WebViewClient`

```
wvClient = new WebViewClient() {
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url) {
  if (url.startsWith("youtube:")) {
    String youtubeUrl = "http://www.youtube.com/watch?v="
    + url.Replace("youtube:", "");
  startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(youtubeUrl)));
}
return false;
} 
```

在我的应用程序中运行良好。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-03-21T09:36:16.667

尝试这个：

```
public class abc extends Activity implements OnPreparedListener{

  /** Called when the activity is first created. */

  @Override
    public void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.youtube.com/watch?v=cxLG2wtE7TM")));          

    @Override
      public void onPrepared(MediaPlayer mp) {
        // TODO Auto-generated method stub

    }
  }
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-11-13T09:10:56.770

这个函数对我来说很好......只需在函数中传递 url 字符串：

```
void watch_video(String url)
{
    Intent yt_play = new Intent(Intent.ACTION_VIEW, Uri.parse(url))
    Intent chooser = Intent.createChooser(yt_play , "Open With");

    if (yt_play.resolveActivity(getPackageManager()) != null) {
                    startActivity(chooser);
                }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-11-09T09:35:49.437

尝试这个，

```
WebView webview = new WebView(this); 

String htmlString = 
    "<html> <body> <embed src=\"youtube link\"; type=application/x-shockwave-flash width="+widthOfDevice+" height="+heightOfDevice+"> </embed> </body> </html>";

webview.loadData(htmlString ,"text/html", "UTF-8"); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-01-19T14:35:44.357

如果安装了 Youtube 应用程序，您可以使用 Youtube Android 播放器 API 播放视频，否则只提示用户从可用的网络浏览器中进行选择。

```
if(YouTubeIntents.canResolvePlayVideoIntent(mContext)){
                    mContext.startActivity(YouTubeIntents.createPlayVideoIntent(mContext, mVideoId));
}else {
    Intent webIntent = new Intent(Intent.ACTION_VIEW, 
           Uri.parse("http://www.youtube.com/watch?v=" + mVideoId));

    mContext.startActivity(webIntent);
} 
```

# html - 如何使用 Perl 提取 HTML 标题？

> ID：574199
> 
> 赞同：0
> 
> 时间：2009-02-22T02:41:22.290
> 
> 标签：html, perl, title

有没有办法使用 Perl 提取 HTML 页面标题？我知道它可以在表单提交期间作为隐藏变量传递，然后以这种方式在 Perl 中检索，但我想知道是否有办法在没有提交的情况下做到这一点？

就像，假设我有一个这样的 HTML 页面：

```
<html><head><title>TEST</title></head></html> 
```

然后在 Perl 中我想做：

```
$q -> h1('something'); 
```

如何用 <title> 标签中包含的内容动态替换“某物”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-22T02:46:36.503

我会使用[pQuery](http://search.cpan.org/perldoc?pQuery)。它就像 jQuery 一样工作。

你可以说：

```
use pQuery;
my $page = pQuery("http://google.com/");
my $title = $page->find('title');
say "The title is: ", $title->html; 
```

替换东西是类似的：

```
$title->html('New Title');
say "The entirety of google.com with my new title is: ", $page->html; 
```

您可以将 HTML 字符串传递给`pQuery`构造函数，这听起来像是您想要做的。

最后，如果您想使用任意 HTML 作为“模板”，然后使用 Perl 命令“优化”它，您需要使用[Template::Refine](http://search.cpan.org/perldoc?Template::Refine)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T18:41:21.303

[HTML::HeadParser](http://search.cpan.org/dist/HTML-Parser)会为你做这件事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T03:33:29.777

我不清楚你在问什么。您似乎在谈论可以在用户浏览器中运行的东西，或者至少是已经加载了 html 页面的东西。

如果*不是*这样，答案是[URI::Title](http://search.cpan.org/perldoc/URI::Title)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-29T11:15:31.243

```
use strict;
use LWP::Simple;

my $url = 'http://www.google.com'|| die "Specify URL on the cmd line";
my $html = get ($url);
$html =~ m{<TITLE>(.*?)</TITLE>}gism;

print "$1\n"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-18T13:32:53.270

前面的答案是错误的，如果更频繁地使用 HTML 标题标签，那么可以通过检查以确保标题标签有效（中间没有标签）来轻松解决这个问题。

```
my ($title) = $test_content =~ m/<title>([a-zA-Z\/][^>]+)<\/title>/si; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-15T22:44:41.850

# 从文件中获取标题名称。

```
 my $spool = 0;

                    open my $fh, "<", $absPath or die $!; 
                    #open ($fh, "<$tempfile" );
                    # wrtie the opening brace
                    print WFL "[";
            while (<$fh>) {
                    # removes the new line from the line read
                        chomp;
                    # removes the leading and trailing spaces.
                    $_=~ s/^\s+|\s+$//g;
            # case where the <title> and </title> occures in one line
            # we print and exit in one instant
                if (($_=~/$startstring/i)&&($_=~/$endstring/i)) {

                        print WFL "'";

                    my ($title) = $_=~ m/$startstring(.+)$endstring/si;
                        print WFL "$title";
                        print WFL "',";
                        last;
                        }
            # case when the <title> is in one line and </title> is in other line

            #starting <title> string is found in the line
                elsif ($_=~/$startstring/i) {

                        print WFL "'";
            # extract everything after <title> but nothing before <title>       
                    my ($title) = $_=~ m/$startstring(.+)/si;
                        print WFL "$title";
                        $spool = 1;
                        }
            # ending string </title> is found
                elsif ($_=~/$endstring/i) {
            # read everything before </title> and nothing above that                                
                    my ($title) = $_=~ m/(.+)$endstring/si;
                        print WFL " ";
                        print WFL "$title";
                        print WFL "',";
                        $spool = 0;
                        last;
                        }
            # this will useful in reading all line between <title> and </title>
                elsif ($spool == 1) {
                        print WFL " ";
                        print WFL "$_";

                        }

                    }
        close $fh;
        # end of getting the title name 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-22T03:10:55.433

如果您只想提取页面标题，可以使用正则表达式。我相信这会是这样的：

```
my ($title) = $html =~ m/<title>(.+)<\/title>/si; 
```

您的 HTML 页面存储在字符串中的位置`$html`。在`si`中，`s`代表*单行模式*（即，点也匹配换行符）和`i`忽略*大小写*。

# php - Apache2 不提供 index.php

> ID：574200
> 
> 赞同：0
> 
> 时间：2009-02-22T02:41:40.883
> 
> 标签：php, apache

我的服务器相当老旧（基于 SuSE 9），当我尝试经历更新到最新的 Apache2、PHP5 和 MySQL 的痛苦时，我的一个托管域遇到了这个问题。

该站点有一个 index.php，如果我浏览到他们的站点 example.org/index.php，它显示得很好。

但是，如果我导航到[http://example.org](http://example.org)或[http://example.org/](http://example.org/)，Firefox 会弹出一个对话框，询问我是否要保存文件或在程序中查看它。下载的文件是未处理的 index.php 文件的副本。

域的配置文件没有改变，但显然我搞砸了。在配置文件中是“DirectoryIndex index.php”。在 DocumentRoot 中是一个 .htaccess 文件，只有“XBitHack on”。

令人困惑的是，我有另一个托管域，它安装了一个也使用 index.php 的 Wordpress，并且在那里导航工作得很好。

这是网站： [http](http://www.sjbridge.org) ://www.sjbridge.org 或[http://www.sjbridge.org/index.php](http://www.sjbridge.org/index.php)

魔精

这里有更多信息：当我导航到[http://www.sjbridge.org](http://www.sjbridge.org)时，Firefox 在内容类型中将文件显示为“application/x-httpd-php”，但对于 /index.php，内容类型是，当然是文本/html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T02:50:55.980

呃，我清除了浏览器中的缓存，问题就消失了。让我说“没关系”。

# ssis - SSIS - 在处理之前从平面文件或 excel 文件中读取单个标题记录

> ID：574203
> 
> 赞同：0
> 
> 时间：2009-02-22T02:43:22.550
> 
> 标签：ssis, dataflow

有没有一种方法可以只读取文件的第一条记录，即读取头信息，以便决定是否处理文件的其余部分？

我知道使用拆分转换组件可以编写一个表达式，该表达式将根据标题中的关键字忽略除标题之外的所有行。我宁愿不走那条路，因为那会低效地读取文件中的每条记录。

具体来说，是否有脚本组件逻辑可以实现以在读取第一条记录后关闭文件并结束数据流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T02:47:54.253

请参阅Todd McDermid[的这篇文章](http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/2285e99f-429a-4495-84bd-66c34f906bc6/)：

> 基本上，您将设置一个 Foreach 容器来遍历目录中的文件。在 Foreach 内部，您将确定“文件类型” - 可能通过创建一个带有冗长表达式的变量来分离文件名并假定“文件类型”值 - 然后将控制权传递给五个通过条件连接器的数据流。（双击标准的绿色连接器，将其评估操作更改为表达式和约束，并将表达式设置为“file_type_variable =”。）然后每个数据流选择一个“文件类型”。

# c++ - 制作组框按钮win32 C++

> ID：574206
> 
> 赞同：0
> 
> 时间：2009-02-22T02:45:43.747
> 
> 标签：c++, winapi

我有一个矩形按钮我将如何将单词放入其中我想制作所以我可以单击单词并启动程序我知道 ShellExecute 样式是 BS_GROUPBOX

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T02:59:46.753

如果您要启动多个程序，则每个要启动的程序都需要一个按钮。

要启动外部程序，在按钮父窗口中，您需要处理[`WM_COMMAND`](http://msdn.microsoft.com/en-us/library/ms647591(VS.85).aspx)带有[`BN_CLICKED`](http://msdn.microsoft.com/en-us/library/bb761825(VS.85).aspx)通知的消息。

要设置按钮的文本，您需要[`WM_SETTEXT`](http://msdn.microsoft.com/en-us/library/ms632644(VS.85).aspx)使用要显示的文本向按钮发送消息。

顺便说一句，`BS_GROUPBOX`用于在单选按钮周围创建矩形。这种风格不适用于您的场景。

如果您想要使用多个 Button 控件的替代方法，可以使用[Toolbar](http://msdn.microsoft.com/en-us/library/bb760435(VS.85).aspx)。事实上，在我看来，工具栏对你来说是一个更好的控制。您可以阅读有关[创建工具栏的](http://msdn.microsoft.com/en-us/library/bb760446(VS.85).aspx#Creating_Toolbars)更多信息。

# asp.net - iframe 的替代品

> ID：574214
> 
> 赞同：2
> 
> 时间：2009-02-22T02:51:34.650
> 
> 标签：asp.net, ajax, iframe

我一直在开发一项服务，该服务允许用户使用 iframe 将我的数据库中的信息插入到他们的网站上。唯一的问题是 iframe 需要调整大小，这是大多数人已经知道的 iframe 的最大问题之一，以及我可以从 iframe 内访问父页面上的对象的事实，反之亦然。

我曾想过制作一个 asp.net web 服务来服务器化 HTML 并使用 get 请求访问它。然而，这也有一个问题，因为这些请求只能来自同一个域？

我需要知道的是从服务器检索一小段包含客户评论的 HTML 并使用某种 AJAX 将其显示在他们的页面上的最佳方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T03:28:48.523

如果您的用户可以在他们的网站上添加一个 < script > 行来指向您网站上的代码，那么您可以很容易地提供一种机制来在他们的页面上构建一个浮动（和可调整大小的）DIV，您可以使用 jquery.load() 中的内容地点 ...

例如：“要在您的网站上使用我的服务，请将以下行添加到您的 <head>”

```
<script type='text/javascript' src='http://mysite.com/scripts/dataget.js /> 
```

然后在任何地方添加一个链接或按钮，并给它一个类'get-date-from-mysite'

```
< input type='button' value='Click to see the data' class='get-data-from-mysite' /> 
```

--

然后在那个脚本中你做（类似）：

```
$(function() {
    $('.get-data-from-mysite').click(function() {
        $('body').append("<div id='mydiv' 'style=position:absolute; z-index:999; left:                 ...

        $('#mydiv').load(' .... // url that sends html for content
    });
   ...etc 
```

也需要添加可调整大小的 div 内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T02:54:42.117

我认为[jQuery 库](http://www.jquery.com/)可能是您所需要的 - 具体来说，请查看[jQuery Ajax](http://docs.jquery.com/ajax)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T04:35:34.370

按照[Scott Evernden](https://stackoverflow.com/users/11397/scott-evernden)的解释，您可以添加一个`<script>`标签，例如：

```
<script id="my_script_tag" type='text/javascript' src='http://mysite.com/scripts/dataget.js' /> 
```

在里面你可以简单地通过使用它的“id”（ ）`dataget.js`引用脚本标签本身，并将它（ ）替换为相关数据。`document.getElementById("my_script_tag");``insertBefore()`

要从您的服务器获取数据，您可以使用[JSONP](http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/)（SO 上也有很多东西），这是一种用于跨域通信的 ajax 技术。

# c# - Chrome 风格的 C# 应用程序？

> ID：574218
> 
> 赞同：15
> 
> 时间：2009-02-22T02:55:55.997
> 
> 标签：c#, windows-vista, google-chrome

我不是在谈论 vista glass 功能，我已经知道如何实现它。我正在谈论的功能是向标题栏添加控件，就像 Office 2007 对徽标和工具栏所做的那样。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-22T03:26:51.307

你需要做一些 Win32 互操作来达到这个效果。根据您使用的是 Winforms 还是 WPF，您连接到消息处理的方式会有所不同（我不记得 Winforms，所以我将给出 WPF 的所有示例）。但在这两种情况下，您都需要：

1.  拦截窗口的创建，修改窗口样式和扩展样式。在 WPF 中，您需要继承[`HwndSource`](http://msdn.microsoft.com/en-us/library/system.windows.interop.hwndsource.aspx)并修改[`HwndSourceParameters`](http://msdn.microsoft.com/en-us/library/system.windows.interop.hwndsourceparameters.aspx)以实现此目的。常规样式需要 WS_OVERLAPPEDWINDOW、WS_CLIPSIBLINGS 和 WS_VISIBLE，扩展样式需要 WS_EX_WINDOWEDGE 和 WS_EX_APPWINDOW。

2.  通过 HwndSource 参数 HwndSourceHook 添加消息处理程序。

3.  在第二步通过钩子添加的message proc中，需要处理几条消息：

    *   [`WM_NCACTIVATE`](http://msdn.microsoft.com/en-us/library/ms632633(VS.85).aspx)- 在应用程序激活或不激活时更改标题的绘画
    *   [`WM_NCCALCSIZE`](http://msdn.microsoft.com/en-us/library/ms632634(VS.85).aspx)- 返回没有非客户区的操作系统
    *   [`WM_NCPAINT`](http://msdn.microsoft.com/en-us/library/dd145212(VS.85).aspx)- 通常你只需要在这里使窗口矩形失效，WPF 会处理实际的绘画）
    *   [`WM_NCHITTEST`](http://msdn.microsoft.com/en-us/library/ms645618(VS.85).aspx)- 处理窗口的移动，最小化和最大化。
4.  完成上述操作后，WPF 将绘制可视化树的客户区域将跨越窗口的整个区域。您将需要添加“非客户端”视觉效果，以便您的应用程序在用户看来就像一个常规应用程序。

5.  您可能需要更多消息：

    *   [`WM_THEMECHANGED`](http://msdn.microsoft.com/en-us/ms632650.aspx)如果你想改变你的“非客户”区域绘画与操作系统主题一致
    *   [`WM_DWMCOMPOSITIONCHANGED`](http://msdn.microsoft.com/en-us/library/aa969230(VS.85).aspx)如果您想在启用玻璃时扩展玻璃并获得标准 OS NC 玻璃绘画，并在未启用玻璃时切换到您的自定义逻辑。
6.  如果您想获得用于边框、标题、关闭、最小化和最大化按钮的标准 Win32 资产以在“非客户端”区域中使用，您可能需要查看 Win32 主题 API。

7.  如果您想将 Glass 扩展到您的窗口中，您可以查看：

    *   [`DwmExtendFrameIntoClientArea`](http://msdn.microsoft.com/en-us/library/aa969512(VS.85).aspx)- 获得标准玻璃 NC 区域
    *   [`DwmDefWindowProc`](http://msdn.microsoft.com/en-us/library/aa969507(VS.85).aspx)- 让桌面管理器绘制 Glass 和标准 NC 控件
    *   [`DwmIsCompositionEnabled`](http://msdn.microsoft.com/en-us/library/aa969518.aspx)- 确定是否启用了 Glass；只有在 Glass 启用的情况下，您才能使用上述两个 API。如果 Glass 未启用，您需要自己绘制 NC 区域。

您可以在[P/Invoke](http://pinvoke.net)上找到所需的所有消息、样式和相应 Win32 API 的正确 C# 定义。

您也可以通过使用带有`WindowStyle=none`. 但是，桌面对您的应用程序和其他应用程序的行为会有一些差异；其中最明显的是，您将无法通过右键单击任务栏来堆叠或平铺窗口。

您还可以查看一些启用此功能的第三方组件。我没有使用过任何（如你所见，我并不害怕 Win32 互操作 :-)），所以我不能特别推荐你。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-22T03:48:38.570

正如弗朗西提到的，你想要的是 DwmExtendFrameIntoClientArea。这是来自 Codeproject 的一个示例，它展示了如何做到这一点。

[http://www.codeproject.com/KB/dialog/AeroNonClientAreaButtons.aspx](http://www.codeproject.com/KB/dialog/AeroNonClientAreaButtons.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-08T21:35:31.043

WPF 产品团队开发人员 Joe Castro 有一个名为“WPF Chrome”的 MSDN 代码库项目，可用于创建类似 Office 2007 的 UI（即：跨越窗口的客户端和非客户端区域的控件）。

在这里找到它：http: [//code.msdn.microsoft.com/chrome](http://code.msdn.microsoft.com/chrome)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T03:13:03.803

我已经成功使用了 DotNetBar 控制套件。

# php - PHP 从视频中提取音频

> ID：574223
> 
> 赞同：1
> 
> 时间：2009-02-22T03:00:14.553
> 
> 标签：php, video, audio, streaming, youtube

我需要一种从某些视频中提取音频的方法（在 PHP 中）。我有来自 YouTube 的视频流，所以如果它是即时流式传输的，我真的很喜欢它，而不是我必须将它保存到临时目录并在那里处理它（尽管这是可以接受的。）谢谢，Isaac Waller
编辑：更具体地说，我有一个 MP4，我希望它是一个 MP3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T05:05:29.260

您将要使用[ffmpeg](http://ffmpeg.org/)之类的东西并使用 php 的 exec 命令调用它。如果您在文档中四处查看，我相信您可以找出仅用于获取音频的标志。

我之前在一个视频实时转码项目中使用过这个应用程序，就像一个魅力。只需确保您的服务器已正确安装即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T03:35:28.103

Mplayer 应该为您执行此操作，并且您可以调用一些库和编解码器（PHP 支持 C 库），它们会即时从 AV 流中删除视频。

鉴于您的目标是 youtube，您的工作会更容易一些，因为它们使用了非常小的文件编码子集。

如果您花时间学习格式，您可以非常轻松地即时删除视频流并仅返回音频流。

如果您提供更多信息，例如您将其编码到什么位置，或者它将最终到达哪里，我们可能会提供更具体的帮助。

-亚当

# asp.net - asp.net DB：在网络服务器上发布时如何处理？

> ID：574232
> 
> 赞同：0
> 
> 时间：2009-02-22T03:10:37.540
> 
> 标签：asp.net, database, deployment, sql-server-express

在 Web 服务器上部署时，ASPNETDB 是否应该保留在 Visual Studio 创建的默认应用程序文件夹中？我在 mssql 数据文件夹中有另一个数据库，它也应该放在同一目录中吗？我不清楚它是否重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T06:32:11.860

这取决于您将应用程序部署到什么环境。具体来说，您可以使用哪些数据库服务器或您可以部署哪些数据库服务器。

如果您拥有或可以安装 SQL Server 并对实例拥有完整的管理权限，那么最简单的选择是将两个数据库附加到该实例并适当地更改连接字符串。在这种情况下，这两个文件都应位于 wwwroot 之外的 SQL Server 特定目录中。

我想这就是访问“mssql”数据文件夹中的数据库的方式。连接字符串不应包含“AttachDbFilename”。

另一个选项涉及 SQL Server Express Edition 和用户实例。当应用程序用户无权将其附加到设置创建的实例时，会按需创建用户实例以托管数据库。用户实例在应用程序用户的上下文中运行，在您的情况下为 ASPNET，并且缺乏高级安全功能。

Visual Studio 使用相同的设置。ASPNETDB 很可能使用这种方法。连接字符串应该包含“AttachDbFilename”。

在用户实例中创建的数据库可以迁移到设置实例。但是，由于安全信息不可用，无法将设置实例中的数据库附加到用户实例。

有关详细信息，请参阅[配置 ASP.NET 2.0 应用程序服务以使用 SQL Server 2000 或 SQL Server 2005](http://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)和[SQL Server 2005 Express Edition 用户实例](http://msdn.microsoft.com/en-us/library/bb264564.aspx)。

# python - 如何使用 Python 确定驱动器上的文件数？

> ID：574236
> 
> 赞同：5
> 
> 时间：2009-02-22T03:12:46.363
> 
> 标签：python, macos, filesystems, hard-drive

我一直在试图弄清楚如何使用 python 检索（快速）给定 HFS+ 驱动器上的文件数。

我一直在玩 os.statvfs 之类的东西，但什么都得不到（这对我来说似乎有帮助）。

有任何想法吗？

**编辑：**让我更具体一点。=]

由于各种原因，我正在围绕 rsync 编写一个类似时间机器的包装器，并且希望非常快速地估计（不必是完美的）驱动器 rsync 将要扫描的文件数量。通过这种方式，我可以在 rsync 构建初始文件列表时查看进度（如果您将其称为`rsync -ax --progress`，或使用`-P`选项），并将百分比和/或 ETA 报告给用户。

这与实际备份完全分开，跟踪进度没有问题。但是对于我正在处理数百万个文件的驱动器，这意味着用户正在观察文件数量的计数器在几分钟内没有上限。

到目前为止，我已经尝试使用答案之一中描述的方法来使用 os.statvfs ，但结果对我来说没有意义。

```
>>> import os
>>> os.statvfs('/').f_files - os.statvfs('/').f_ffree
64171205L 
```

更便携的方式在这台机器上给了我大约 110 万，这与我在这台机器上看到的所有其他指标相同，包括 rsync 运行它的准备工作：

```
>>> sum(len(filenames) for path, dirnames, filenames in os.walk("/"))
1084224 
```

请注意，第一种方法是即时的，而第二种方法让我在 15 分钟后回来更新，因为它只需要很长时间才能运行。

有谁知道获得这个数字的类似方法，或者我如何处理/解释 os.statvfs 数字有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-22T03:37:47.677

对于您的目的，正确的答案是一次没有进度条，存储 rsync 提出的数字，并假设每次连续备份您拥有与上次相同数量的文件。

我不相信，但这似乎适用于 Linux：

```
os.statvfs('/').f_files - os.statvfs('/').f_ffree 
```

这计算文件块的总数减去空闲文件块。即使您将其指向另一个目录，它似乎也显示了整个文件系统的结果。os.statvfs 仅在 Unix 上实现。

好吧，我承认，在惊叹于快速方法之前，我实际上并没有让“缓慢、正确”的方法完成。只有几个缺点：我怀疑`.f_files`也会计算目录，结果可能完全错误。一次以慢速方式计算文件并以“快速”方式调整结果可能会起作用吗？

便携方式：

```
import os
files = sum(len(filenames) for path, dirnames, filenames in os.walk("/")) 
```

`os.walk`为从给定路径开始的文件系统中的每个目录返回一个 3 元组 (dirpath, dirnames, filenames)。这可能需要很长时间`"/"`，但您已经知道了。

简单的方法：

让我们面对现实吧，没有人知道或关心他们真正拥有多少文件，这是一个单调乏味的统计数据。您可以使用以下代码将这个很酷的“文件数量”功能添加到您的程序中：

```
import random
num_files = random.randint(69000, 4000000) 
```

让我们知道这些方法是否适合您。

另请参阅[如何防止 Python 的 os.walk 穿过挂载点？](https://stackoverflow.com/questions/577761/how-do-i-prevent-pythons-os-walk-from-walking-across-mount-points)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T11:20:23.530

您可以使用以前`rsync`运行的数字。它快速、便携，对于`10**6`文件和任何合理的备份策略，它将为您提供`1%`或更好的精度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T11:23:55.067

如果遍历目录树是一个选项（比直接查询驱动器要慢）：

```
import os

dirs = 0
files = 0

for r, d, f in os.walk('/path/to/drive'):
  dirs += len(d)
  files += len(f) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T03:42:55.620

编辑：Spotlight 不会跟踪每个文件，因此它的元数据是不够的。

# java - 使用同步方法而不是同步块有优势吗？

> ID：574240
> 
> 赞同：418
> 
> 时间：2009-02-22T03:13:48.140
> 
> 标签：java, multithreading, concurrency, locking, synchronized

谁能用一个例子告诉我同步方法相对于同步块的优势？

* * *

## 回答 #1

> 赞同：446
> 
> 时间：2009-02-22T03:36:20.207

> *谁能通过示例告诉我同步方法相对于同步块的优势？谢谢。*

在块上使用同步方法没有明显的优势。

也许唯一的（但我不会称之为优势）是您不需要包含对象引用`this`。

方法：

```
public synchronized void method() { // blocks "this" from here.... 
    ...
    ...
    ...
} // to here 
```

堵塞：

```
public void method() { 
    synchronized( this ) { // blocks "this" from here .... 
        ....
        ....
        ....
    }  // to here...
} 
```

看？一点优势都没有。

块**确实**比方法有优势，主要是灵活性，因为你可以使用另一个对象作为锁，而同步方法会锁定整个对象。

比较：

```
// locks the whole object
... 
private synchronized void someInputRelatedWork() {
    ... 
}
private synchronized void someOutputRelatedWork() {
    ... 
} 
```

对比

```
// Using specific locks
Object inputLock = new Object();
Object outputLock = new Object();

private void someInputRelatedWork() {
    synchronized(inputLock) { 
        ... 
    } 
}
private void someOutputRelatedWork() {
    synchronized(outputLock) { 
        ... 
    }
} 
```

此外，如果方法增长，您仍然可以将同步部分分开：

```
 private void method() {
     ... code here
     ... code here
     ... code here
    synchronized( lock ) { 
        ... very few lines of code here
    }
     ... code here
     ... code here
     ... code here
     ... code here
} 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-02-22T03:26:33.570

唯一真正的区别是同步块可以选择在哪个对象上同步。一个同步方法只能使用`'this'`（或同步类方法对应的 Class 实例）。例如，这些在语义上是等价的：

```
synchronized void foo() {
  ...
}

void foo() {
    synchronized (this) {
      ...
    }
} 
```

后者更灵活，因为它可以竞争*任何*对象的关联锁，通常是成员变量。它也更细化，因为您可以在块之前和之后执行并发代码，但仍在方法内。当然，您可以通过将并发代码重构为单独的非同步方法来轻松使用同步方法。使用使代码更易于理解的那个。

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-02-22T07:31:18.770

## 同步法

优点：

*   您的 IDE 可以指示同步方法。
*   语法更紧凑。
*   强制将同步块拆分为单独的方法。

缺点：

*   与此同步，因此外部人员也可以与之同步。
*   将代码移出同步块更难。

## 同步块

优点：

*   允许为锁使用私有变量，从而强制锁留在类中。
*   可以通过搜索对变量的引用来找到同步块。

缺点：

*   语法更复杂，因此使代码更难阅读。

* * *

就我个人而言，我更喜欢将同步方法与只关注需要同步的事物的类一起使用。这样的类应该尽可能小，因此应该很容易查看同步。其他人不需要关心同步。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-02-22T03:32:28.937

主要区别在于，如果您使用同步块，您可以锁定除此之外的对象，*这样*可以更加灵活。

假设您有一个消息队列和多个消息生产者和消费者。我们不希望生产者相互干扰，但消费者应该能够检索消息而无需等待生产者。所以我们只是创建一个对象

```
Object writeLock = new Object(); 
```

从现在开始，每次生产者想要添加新消息时，我们都会锁定它：

```
synchronized(writeLock){
  // do something
} 
```

所以消费者仍然可以阅读，而生产者将被锁定。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2011-04-18T21:15:14.357

**同步方式**

同步方法有两个效果。
首先，当一个线程正在为一个对象执行同步方法时，所有其他为同一对象调用同步方法的线程都会阻塞（暂停执行），直到第一个线程处理完该对象。

其次，当同步方法退出时，它会自动与任何后续对同一对象的同步方法调用建立起之前的关系。这保证了对象状态的更改对所有线程都是可见的。

请注意，构造函数不能同步——在构造函数中使用 synchronized 关键字是一个语法错误。同步构造函数没有意义，因为只有创建对象的线程才能在构造对象时访问它。

**同步语句**

与同步方法不同，同步语句必须指定提供内在锁的对象：大多数情况下，我使用它来同步对列表或映射的访问，但我不想阻止对对象的所有方法的访问。

问：内在锁和同步 同步是围绕称为内在锁或监视器锁的内部实体构建的。（API 规范通常将此实体简称为“监视器”。）内在锁在同步的两个方面都发挥作用：强制对对象状态的独占访问和建立对可见性至关重要的先发生关系。

每个对象都有一个与之关联的内在锁。按照惯例，需要对对象字段进行排他和一致访问的线程必须在访问对象之前获取对象的内在锁，然后在完成访问时释放内在锁。在获得锁和释放锁之间，线程被称为拥有内在锁。只要一个线程拥有一个内在锁，其他线程就不能获得相同的锁。另一个线程在尝试获取锁时会阻塞。

```
package test;

public class SynchTest implements Runnable {  
    private int c = 0;

    public static void main(String[] args) {
        new SynchTest().test();
    }

    public void test() {
        // Create the object with the run() method
        Runnable runnable = new SynchTest();
        Runnable runnable2 = new SynchTest();
        // Create the thread supplying it with the runnable object
        Thread thread = new Thread(runnable,"thread-1");
        Thread thread2 = new Thread(runnable,"thread-2");
//      Here the key point is passing same object, if you pass runnable2 for thread2,
//      then its not applicable for synchronization test and that wont give expected
//      output Synchronization method means "it is not possible for two invocations
//      of synchronized methods on the same object to interleave"

        // Start the thread
        thread.start();
        thread2.start();
    }

    public synchronized  void increment() {
        System.out.println("Begin thread " + Thread.currentThread().getName());
        System.out.println(this.hashCode() + "Value of C = " + c);
//      If we uncomment this for synchronized block, then the result would be different
//      synchronized(this) {
            for (int i = 0; i < 9999999; i++) {
                c += i;
            }
//      }
        System.out.println("End thread " + Thread.currentThread().getName());
    }

//    public synchronized void decrement() {
//        System.out.println("Decrement " + Thread.currentThread().getName());
//    }

    public int value() {
        return c;
    }

    @Override
    public void run() {
        this.increment();
    }
} 
```

使用同步方法、块和不同步交叉检查不同的输出。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2009-02-22T03:30:31.920

注意：**静态**同步方法和块在 Class 对象上工作。

```
public class MyClass {
   // locks MyClass.class
   public static synchronized void foo() {
// do something
   }

   // similar
   public static void foo() {
      synchronized(MyClass.class) {
// do something
      }
   }
} 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2014-04-21T08:53:49.020

当 java 编译器将你的源代码转换为字节码时，它处理同步方法和同步块的方式非常不同。

当JVM执行同步方法时，执行线程识别到该方法的method_info结构设置了ACC_SYNCHRONIZED标志，然后自动获取对象的锁，调用该方法，释放锁。如果发生异常，线程会自动释放锁。

另一方面，同步方法块绕过了 JVM 对获取对象的锁定和异常处理的内置支持，并要求将功能显式地写入字节码中。如果您阅读具有同步块的方法的字节码，您将看到十几个额外的操作来管理此功能。

这显示了生成同步方法和同步块的调用：

```
public class SynchronizationExample {
    private int i;

    public synchronized int synchronizedMethodGet() {
        return i;
    }

    public int synchronizedBlockGet() {
        synchronized( this ) {
            return i;
        }
    }
} 
```

该`synchronizedMethodGet()`方法生成以下字节码：

```
0:  aload_0
1:  getfield
2:  nop
3:  iconst_m1
4:  ireturn 
```

这是该`synchronizedBlockGet()`方法的字节码：

```
0:  aload_0
1:  dup
2:  astore_1
3:  monitorenter
4:  aload_0
5:  getfield
6:  nop
7:  iconst_m1
8:  aload_1
9:  monitorexit
10: ireturn
11: astore_2
12: aload_1
13: monitorexit
14: aload_2
15: athrow 
```

* * *

同步方法和块之间的一个显着区别是，同步块通常会减少锁定范围。由于锁定范围与性能成反比，因此只锁定代码的关键部分总是更好。使用同步块的最佳示例之一是[Singleton 模式中的双重检查锁定，](http://docs.oracle.com/cd/E19205-01/820-0619/gedig/index.html)`getInstance()`我们只锁定用于创建 Singleton 实例的代码的关键部分，而不是锁定整个方法。这极大地提高了性能，因为锁定只需要一两次。

在使用同步方法时，如果同时使用静态同步和非静态同步方法，则需要格外小心。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-02-22T07:04:38.193

大多数情况下，我使用它来同步对列表或映射的访问，但我不想阻止对对象的所有方法的访问。

在以下代码中，修改列表的线程不会阻塞等待正在修改映射的线程。如果方法在对象上同步，那么每个方法都必须等待，即使它们所做的修改不会发生冲突。

```
private List<Foo> myList = new ArrayList<Foo>();
private Map<String,Bar) myMap = new HashMap<String,Bar>();

public void put( String s, Bar b ) {
  synchronized( myMap ) {
    myMap.put( s,b );
    // then some thing that may take a while like a database access or RPC or notifying listeners
  }
}

public void hasKey( String s, ) {
  synchronized( myMap ) {
    myMap.hasKey( s );
  }
}

public void add( Foo f ) {
  synchronized( myList ) {
    myList.add( f );
// then some thing that may take a while like a database access or RPC or notifying listeners
  }
}

public Thing getMedianFoo() {
  Foo med = null;
  synchronized( myList ) {
    Collections.sort(myList);
    med = myList.get(myList.size()/2); 
  }
  return med;
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-02-22T03:19:18.720

使用同步块，您可以拥有多个同步器，以便多个同时但不冲突的事情可以同时进行。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-12-10T14:25:53.723

可以使用反射 API 检查同步方法。这对于测试一些合约很有用，例如*模型中的所有方法都是同步的*。

以下代码段打印了 Hashtable 的所有同步方法：

```
for (Method m : Hashtable.class.getMethods()) {
        if (Modifier.isSynchronized(m.getModifiers())) {
            System.out.println(m);
        }
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-08-12T11:41:31.133

使用同步块的重要注意事项：小心你使用什么作为锁定对象！

上面来自 user2277816 的代码片段说明了这一点，因为对字符串文字的引用被用作锁定对象。意识到字符串字面量在 Java 中会自动进行实习，您应该开始看到问题：在字面量“锁”上同步的每段代码都共享同一个锁！这很容易导致完全不相关的代码段出现死锁。

您需要小心的不仅仅是 String 对象。装箱的原语也是一种危险，因为自动装箱和 valueOf 方法可以重用相同的对象，具体取决于值。

有关更多信息，请参阅： [https ://www.securecoding.cert.org/confluence/display/java/LCK01-J.+Do+not+synchronize+on+objects+that+may+be+reused](https://www.securecoding.cert.org/confluence/display/java/LCK01-J.+Do+not+synchronize+on+objects+that+may+be+reused)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-09-30T06:43:56.023

通常在方法级别上使用锁太粗鲁了。为什么要通过锁定整个方法来锁定一段不访问任何共享资源的代码。由于每个对象都有一个锁，您可以创建虚拟对象来实现块级同步。 **块级别更有效，因为它不会锁定整个方法。**

这里有一些例子

**方法级别**

```
class MethodLevel {

  //shared among threads
SharedResource x, y ;

public void synchronized method1() {
   //multiple threads can't access
}
public void synchronized method2() {
  //multiple threads can't access
}

 public void method3() {
  //not synchronized
  //multiple threads can access
 }
} 
```

**块级**

```
class BlockLevel {
  //shared among threads
  SharedResource x, y ;

  //dummy objects for locking
  Object xLock = new Object();
  Object yLock = new Object();

    public void method1() {
     synchronized(xLock){
    //access x here. thread safe
    }

    //do something here but don't use SharedResource x, y
    // because will not be thread-safe
     synchronized(xLock) {
       synchronized(yLock) {
      //access x,y here. thread safe
      }
     }

     //do something here but don't use SharedResource x, y
     //because will not be thread-safe
    }//end of method1
 } 
```

**[编辑]**

对于`Collection`like`Vector`和`Hashtable`它们何时同步`ArrayList`或`HashMap`不同步，您需要设置同步关键字或调用 Collections 同步方法：

```
Map myMap = Collections.synchronizedMap (myMap); // single lock for the entire map
List myList = Collections.synchronizedList (myList); // single lock for the entire list 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-05-21T18:12:34.677

唯一的区别：***与同步方法不同，同步块允许粒度锁定***

基本上`synchronized`，块或方法已用于通过避免内存不一致错误来编写线程安全代码。

这个问题很老了，在过去的 7 年里，很多事情都发生了变化。为线程安全引入了新的编程结构。

`synchronied`您可以通过使用高级并发 API 而不是块来实现线程安全。该文档[页面](https://docs.oracle.com/javase/tutorial/essential/concurrency/highlevel.html)提供了良好的编程结构来实现线程安全。

[***锁定对象***](https://docs.oracle.com/javase/tutorial/essential/concurrency/newlocks.html)支持简化许多并发应用程序的锁定习惯用法。

[**执行器**](https://docs.oracle.com/javase/tutorial/essential/concurrency/executors.html)定义了一个用于启动和管理线程的高级 API。java.util.concurrent 提供的执行器实现提供了适合大规模应用的线程池管理。

[**并发集合**](https://docs.oracle.com/javase/tutorial/essential/concurrency/collections.html)使管理大型数据集合变得更加容易，并且可以大大减少同步的需要。

[**原子变量**](https://docs.oracle.com/javase/tutorial/essential/concurrency/atomicvars.html)具有最小化同步并有助于避免内存一致性错误的功能。

***[ThreadLocalRandom](https://docs.oracle.com/javase/tutorial/essential/concurrency/threadlocalrandom.html)***（在 JDK 7 中）提供了从多个线程高效地生成伪随机数。

更好的同步替代品是[ReentrantLock](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html)，它使用`Lock`API

> 一种可重入互斥锁，其基本行为和语义与使用同步方法和语句访问的隐式监视器锁相同，但具有扩展功能。

带锁的例子：

```
class X {
   private final ReentrantLock lock = new ReentrantLock();
   // ...

   public void m() {
     lock.lock();  // block until condition holds
     try {
       // ... method body
     } finally {
       lock.unlock()
     }
   }
 } 
```

有关其他编程结构，请参阅[java.util.concurrent](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/package-summary.html)和[java.util.concurrent.atomic](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/package-summary.html)包。

也参考这个相关问题：

[同步与锁定](https://stackoverflow.com/questions/4201713/synchronization-vs-lock/34267717#34267717)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-07-14T06:35:56.373

同步方法用于锁定所有对象 同步块用于锁定特定对象

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-22T20:28:59.213

一般来说，除了明确说明正在使用的对象的监视器与隐含的 this 对象之外，这些几乎相同。我认为有时会被忽略的同步方法的一个缺点是，在使用“this”引用进行同步时，外部对象可能会锁定在同一个对象上。如果您遇到它，这可能是一个非常微妙的错误。在内部显式对象或其他现有字段上进行同步可以避免此问题，完全封装同步。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-07-16T08:43:36.597

正如这里已经说过的，同步块可以使用用户定义的变量作为锁对象，当同步函数只使用“this”时。当然，您可以使用应该同步的功能区域进行操作。但是每个人都说同步函数和使用“this”作为锁定对象覆盖整个函数的块之间没有区别。这不是真的，区别在于两种情况下都会生成的字节码。在同步块使用的情况下，应分配局部变量，该变量包含对“this”的引用。因此，我们的函数大小会稍大一些（如果您只有少数函数，则不相关）。

您可以在此处找到有关差异的更详细说明： [http ://www.artima.com/insidejvm/ed2/threadsynchP.html](http://www.artima.com/insidejvm/ed2/threadsynchP.html)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-10-28T18:08:45.290

实际上，同步方法相对于同步块的优势在于它们更耐白痴。因为您不能选择要锁定的任意对象，所以不能滥用同步方法语法来做愚蠢的事情，例如锁定字符串文字或锁定从线程下更改出来的可变字段的内容。

另一方面，使用同步方法，您无法保护锁不被任何可以获得对象引用的线程获取。

因此，在方法上使用 synchronized 作为修饰符可以更好地保护您的工作人员免受伤害，而将同步块与私有最终锁定对象结合使用可以更好地保护您自己的代码免受工作人员的伤害。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-12-13T11:54:37.933

在同步方法的情况下，将在对象上获取锁。但是，如果您使用同步块，您可以选择指定将获取锁的对象。

例子 ：

```
 Class Example {
    String test = "abc";
    // lock will be acquired on String  test object.
    synchronized (test) {
        // do something
    }

   lock will be acquired on Example Object
   public synchronized void testMethod() {
     // do some thing
   } 

   } 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-12-08T16:47:02.267

我知道这是一个老问题，但是通过快速阅读这里的回复，我并没有真正看到有人提到有时一种`synchronized`方法可能是**错误**的锁。
来自 Java 并发实践（第 72 页）：

```
public class ListHelper<E> {
  public List<E> list = Collections.syncrhonizedList(new ArrayList<>());
...

public syncrhonized boolean putIfAbsent(E x) {
 boolean absent = !list.contains(x);
if(absent) {
 list.add(x);
}
return absent;
} 
```

上面的代码**看起来**是线程安全的。然而，实际上并非如此。在这种情况下，锁定是在类的实例上获得的。但是，**列表**有可能被另一个不使用该方法的线程修改。正确的方法是使用

```
public boolean putIfAbsent(E x) {
 synchronized(list) {
  boolean absent = !list.contains(x);
  if(absent) {
    list.add(x);
  }
  return absent;
}
} 
```

上面的代码将阻止所有试图修改**列表的****线程**修改列表，直到同步块完成。

 *** * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-12-17T23:10:51.970

来自 Java 规范摘要： [http ://www.cs.cornell.edu/andru/javaspec/17.doc.html](http://www.cs.cornell.edu/andru/javaspec/17.doc.html)

> 同步语句（第 14.17 节）计算对对象的引用；然后它会尝试对该对象执行锁定操作，并且在锁定操作成功完成之前不会继续进行。...
> 
> 同步方法（第 8.4.3.5 节）在调用时自动执行锁定操作；在锁定操作成功完成之前，它的主体不会被执行。**如果该方法是一个实例方法**，它会锁定与调用它的实例相关联的锁（即，在方法体执行期间将被称为 this 的对象）。**如果方法是静态的**，它会锁定与代表定义该方法的类的 Class 对象关联的锁。...

基于这些描述，我会说大多数以前的答案都是正确的，并且同步方法可能对静态方法特别有用，否则您将不得不弄清楚如何获取“表示该方法所在的类的类对象”定义。”

编辑：我最初认为这些是实际 Java 规范的引用。澄清此页面只是规范的摘要/说明

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-08-15T22:12:36.533

**TLDR；**既不使用`synchronized`修饰符也不使用`synchronized(this){...}`表达式，但最终实例字段`synchronized(myLock){...}`在哪里`myLock`保存私有对象。

* * *

`synchronized`在方法声明中使用修饰符和`synchronized(..){ }`在方法体中使用表达式的区别如下：

*   方法签名上指定的`synchronized`修饰符
    1.  在生成的 JavaDoc 中可见，
    2.  [在为Modifier.SYNCHRONIZED](https://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Modifier.html#SYNCHRONIZED)测试方法的修饰符时，可以通过[反射](https://docs.oracle.com/javase/tutorial/reflect/)以编程方式确定，
    3.  `synchronized(this) { .... }`与,相比需要更少的打字和缩进
    4.  （取决于您的 IDE）在类大纲和代码完成中可见，
    5.  `this`在非静态方法上声明时使用对象作为锁，在静态方法上声明时使用封闭类。
*   该`synchronized(...){...}`表达式允许您
    1.  仅同步方法主体部分的执行，
    2.  在构造函数或（[静态](https://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)）初始化块中使用，
    3.  选择控制同步访问的锁定对象。

但是，使用`synchronized`修饰符或`synchronized(...) {...}`with`this`作为锁定对象（如 中`synchronized(this) {...}`），具有相同的缺点。两者都使用它自己的实例作为要同步的锁对象。这是危险的，因为不仅对象本身，而且**任何**其他持有对该对象的引用的外部对象/代码也可以将其用作具有潜在严重副作用（性能下降和[死锁](https://en.wikipedia.org/wiki/Deadlock)）的同步锁。

因此，最佳实践是既不使用`synchronized`修饰符也不要将`synchronized(...)`表达式与`this`as lock object 结合使用，而是使用该对象私有的 lock object。例如：

```
public class MyService {
    private final lock = new Object();

    public void doThis() {
       synchronized(lock) {
          // do code that requires synchronous execution
        }
    }

    public void doThat() {
       synchronized(lock) {
          // do code that requires synchronous execution
        }
    }
} 
```

您也可以使用多个锁对象，但需要特别注意确保在嵌套使用时不会导致死锁。

```
public class MyService {
    private final lock1 = new Object();
    private final lock2 = new Object();

    public void doThis() {
       synchronized(lock1) {
          synchronized(lock2) {
              // code here is guaranteed not to be executes at the same time
              // as the synchronized code in doThat() and doMore().
          }
    }

    public void doThat() {
       synchronized(lock1) {
              // code here is guaranteed not to be executes at the same time
              // as the synchronized code in doThis().
              // doMore() may execute concurrently
        }
    }

    public void doMore() {
       synchronized(lock2) {
              // code here is guaranteed not to be executes at the same time
              // as the synchronized code in doThis().
              // doThat() may execute concurrently
        }
    }
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-02-04T14:52:13.563

**我想这个问题是关于Thread Safe Singleton**和**Lazy initialization with Double check locking**之间的区别。当我需要实现一些特定的单例时，我总是参考这篇文章。

好吧，这是一个**线程安全的单例**：

```
// Java program to create Thread Safe 
// Singleton class 
public class GFG  
{ 
  // private instance, so that it can be 
  // accessed by only by getInstance() method 
  private static GFG instance; 

  private GFG()  
  { 
    // private constructor 
  } 

 //synchronized method to control simultaneous access 
  synchronized public static GFG getInstance()  
  { 
    if (instance == null)  
    { 
      // if instance is null, initialize 
      instance = new GFG(); 
    } 
    return instance; 
  } 
} 
```

> 优点：
> 
> 1.  延迟初始化是可能的。
>     
>     
> 2.  它是线程安全的。
>     
>     
> 
> 缺点：
> 
> 1.  getInstance() 方法是同步的，因此会导致性能下降，因为多个线程无法同时访问它。

这是**带有双重检查锁定的延迟初始化**：

```
// Java code to explain double check locking 
public class GFG  
{ 
  // private instance, so that it can be 
  // accessed by only by getInstance() method 
  private static GFG instance; 

  private GFG()  
  { 
    // private constructor 
  } 

  public static GFG getInstance() 
  { 
    if (instance == null)  
    { 
      //synchronized block to remove overhead 
      synchronized (GFG.class) 
      { 
        if(instance==null) 
        { 
          // if instance is null, initialize 
          instance = new GFG(); 
        } 

      } 
    } 
    return instance; 
  } 
} 
```

> 优点：
> 
> 1.  延迟初始化是可能的。
>     
>     
> 2.  它也是线程安全的。
>     
>     
> 3.  克服了由于同步关键字而降低的性能。
>     
>     
> 
> 缺点：
> 
> 1.  第一次，它会影响性能。
>     
>     
> 2.  作为缺点。双重检查锁定方法是可以忍受的，因此它可以用于高性能的多线程应用程序。

请参阅这篇文章了解更多详情：

[https://www.geeksforgeeks.org/java-singleton-design-pattern-practices-examples/](https://www.geeksforgeeks.org/java-singleton-design-pattern-practices-examples/)

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2013-04-13T16:29:17.050

与线程同步。1）永远不要在线程中使用 synchronized(this) 它不起作用。与 (this) 同步使用当前线程作为锁定线程对象。由于每个线程都独立于其他线程，因此没有同步协调。2) 代码测试表明，在 Mac 上的 Java 1.6 中，方法同步不起作用。3) synchronized(lockObj) 其中 lockObj 是所有线程在其上同步的公共共享对象将起作用。4) ReenterantLock.lock() 和 .unlock() 工作。请参阅 Java 教程。

以下代码显示了这些要点。它还包含将替换 ArrayList 的线程安全 Vector，以表明添加到 Vector 的许多线程不会丢失任何信息，而与 ArrayList 相同的线程可能会丢失信息。0）当前代码显示由于竞争条件导致信息丢失 A）注释当前标记的 A 行，并取消注释其上方的 A 行，然后运行，方法丢失数据但它不应该。B) 反转步骤 A，取消注释 B 和 // 结束块 }。然后运行查看结果没有数据丢失 C) 注释掉 B，取消注释 C。运行，看到同步上 (this) 丢失数据，如预期的那样。没有时间完成所有的变化，希望这会有所帮助。如果在 (this) 上进行同步，或者方法同步有效，请说明您测试的 Java 和操作系统版本。谢谢你。

```
import java.util.*;

/** RaceCondition - Shows that when multiple threads compete for resources 
     thread one may grab the resource expecting to update a particular 
     area but is removed from the CPU before finishing.  Thread one still 
     points to that resource.  Then thread two grabs that resource and 
     completes the update.  Then thread one gets to complete the update, 
     which over writes thread two's work.
     DEMO:  1) Run as is - see missing counts from race condition, Run severa times, values change  
            2) Uncomment "synchronized(countLock){ }" - see counts work
            Synchronized creates a lock on that block of code, no other threads can 
            execute code within a block that another thread has a lock.
        3) Comment ArrayList, unComment Vector - See no loss in collection
            Vectors work like ArrayList, but Vectors are "Thread Safe"
         May use this code as long as attribution to the author remains intact.
     /mf
*/ 

public class RaceCondition {
    private ArrayList<Integer> raceList = new ArrayList<Integer>(); // simple add(#)
//  private Vector<Integer> raceList = new Vector<Integer>(); // simple add(#)

    private String countLock="lock";    // Object use for locking the raceCount
    private int raceCount = 0;        // simple add 1 to this counter
    private int MAX = 10000;        // Do this 10,000 times
    private int NUM_THREADS = 100;    // Create 100 threads

    public static void main(String [] args) {
    new RaceCondition();
    }

    public RaceCondition() {
    ArrayList<Thread> arT = new ArrayList<Thread>();

    // Create thread objects, add them to an array list
    for( int i=0; i<NUM_THREADS; i++){
        Thread rt = new RaceThread( ); // i );
        arT.add( rt );
    }

    // Start all object at once.
    for( Thread rt : arT ){
        rt.start();
    }

    // Wait for all threads to finish before we can print totals created by threads
    for( int i=0; i<NUM_THREADS; i++){
        try { arT.get(i).join(); }
        catch( InterruptedException ie ) { System.out.println("Interrupted thread "+i); }
    }

    // All threads finished, print the summary information.
    // (Try to print this informaiton without the join loop above)
    System.out.printf("\nRace condition, should have %,d. Really have %,d in array, and count of %,d.\n",
                MAX*NUM_THREADS, raceList.size(), raceCount );
    System.out.printf("Array lost %,d. Count lost %,d\n",
             MAX*NUM_THREADS-raceList.size(), MAX*NUM_THREADS-raceCount );
    }   // end RaceCondition constructor

    class RaceThread extends Thread {
    public void run() {
        for ( int i=0; i<MAX; i++){
        try {
            update( i );        
        }    // These  catches show when one thread steps on another's values
        catch( ArrayIndexOutOfBoundsException ai ){ System.out.print("A"); }
        catch( OutOfMemoryError oome ) { System.out.print("O"); }
        }
    }

    // so we don't lose counts, need to synchronize on some object, not primitive
    // Created "countLock" to show how this can work.
    // Comment out the synchronized and ending {, see that we lose counts.

//    public synchronized void update(int i){   // use A
    public void update(int i){                  // remove this when adding A
//      synchronized(countLock){            // or B
//      synchronized(this){             // or C
        raceCount = raceCount + 1;
        raceList.add( i );      // use Vector  
//          }           // end block for B or C
    }   // end update

    }   // end RaceThread inner class

} // end RaceCondition outter class 
```

# php - 如何使用 CURL 发送数组？我应该对其进行“urlencode”吗？

> ID：574242
> 
> 赞同：20
> 
> 时间：2009-02-22T03:14:33.207
> 
> 标签：php, post, curl, urlencode

当我分配要作为 cURL 选项发布的数据数组时（通过 CURLOPT_POSTFIELDS），我是否需要先对该数据进行 urlencode 或将其处理？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-22T03:18:38.580

的 C 实现[`curl_setopt`](http://curl.haxx.se/)似乎没有对文本进行 URL 编码。但是，在 PHP5 中，该函数返回URL 编码的数组*的*[`http_build_query`](http://us2.php.net/http_build_query)查询字符串表示形式。

 *### 示例用法

```
 $curl_parameters = array(
    'param1' => $param1,
    'param2' => $param2
  );

  $curl_options = array(
    CURLOPT_URL => "http://localhost/service",
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => http_build_query( $curl_parameters ),
    CURLOPT_HTTP_VERSION => 1.0,
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_HEADER => false
  );

  $curl = curl_init();
  curl_setopt_array( $curl, $curl_options );
  $result = curl_exec( $curl );

  curl_close( $curl ); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-22T04:10:48.610

您不必先进行 urlencode。但是，重要的是要意识到传递一个数组会使 cURL 将其发送为`multipart/form-data`，这就解释了为什么它不需要进行 urlencoded（你和 cURL 都不是），如果你想上传文件，你需要使用一个数组. 如果您`http_build_query()`首先（并将其作为字符串发送），它将被视为`application/x-www-form-urlencoded`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T13:56:01.090

为 CURLOPT_POSTFIELDS 使用数组的一个问题是您不能有一个空值的名称-值对。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-22T07:47:51.923

我用：

```
curl_setopt($curl , CURLOPT_POSTFIELDS, $array ); 
```

代替：

```
curl_setopt($curl , CURLOPT_POSTFIELDS, http_build_query($array)  ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T04:12:04.053

POST 数据不会添加到 URL（如 GET），因此您不需要对其进行 URL 编码。

# linux - 网络编程语言

> ID：574252
> 
> 赞同：1
> 
> 时间：2009-02-22T03:26:25.097
> 
> 标签：linux, ubuntu

我想去学习网络编程，但除了名字和一点html我什么都不知道。所以我问你推荐什么编程语言，为什么，可以用它做什么，学习工具等。我不知道不知道这是否重要，但我在 Linux 环境（Ubuntu）中编程。我不想做硬核的网络编程，我只想能够开发完整的网站并理解网络概念。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-22T03:28:21.177

好吧，大多数便宜/免费的网络主机都支持 PHP、MySQL，并且大多数浏览器都支持 Javascript。

以这些为目标，您将走上一条相当不错的道路。

有些支持 Ruby 和 Python，如果您想学习这些语言，您可能会选择该路径。

祝你好运！

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-22T03:42:42.390

绝对从 HTML 和基本的 CSS 开始。这些是 Web 编程的核心，你需要很好地理解它们才能做任何有意义的事情。

一旦你搞定了这些，你就会想要转向服务器端语言。最简单的是[PHP](http://php.net/)，但要小心养成坏习惯，因为它是一个松散的环境；如果你坚持使用 PHP，你最终会希望将它与诸如[CodeIgniter](http://codeigniter.com/)之类的 MVC 框架一起使用，它鼓励分离表示和逻辑。要更高级一点，您还可以尝试[Python](http://www.diveintopython.net "潜入 Python")或[Ruby](http://poignantguide.net/ "为什么是 Ruby 的辛酸指南")。给自己找一些服务器空间来摆弄；大多数共享托管计划是每月 5-10 美元。

对于 Javascript/AJAX，您可能希望首先使用[Firebug](http://getfirebug.com/)或 Firefox 的 DOM 检查器来了解页面的 HTML 和 Javascript 用来与之交互的 DOM 对象之间的关系。一旦你了解了 DOM 是如何工作的，就可以[玩弄 jQuery](http://jquery.com/)来开始做有用（而且有趣！）的东西。

您最终还想学习 MySQL（或类似的 SQL 变体），但这可能需要等待，因为您可以在不处理数据库问题的情况下做很多有趣的事情。

最重要的是，要有耐心和坚持，并利用您可以使用的所有资源：书籍、Google、Stack Overflow 和[备忘单](http://webdeveloper.econsultant.com/cheat-sheets/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T03:38:15.880

一路红宝石。如果您对 Web 开发感兴趣并且完全从头开始编程，这正是您所需要的。从 Ruby 的基础知识很容易进入 Rails，这是一个对初学者非常友好的 Web 框架。

亚马逊上有很多关于 Ruby 和 Rails 的好书（当然是寻找评分最高的）。

链接的好起点： [http ://www.ruby-lang.org/en/documentation/](http://www.ruby-lang.org/en/documentation/)

以及查看[学习编程](http://pine.fm/LearnToProgram/?Chapter=00)

现在开始学习。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T03:38:20.123

Google App Engine 为不超过指定限制的应用程序提供免费托管。服务器端语言是 Python，客户端语言是 Django 模板中的 JavaScript。在 Ubuntu 8.10 中，一切对我来说都很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T19:26:53.980

好问题，几年前我在同一个地方 - 诚实地帮助我的是使用 Dreamweaver，我将它设置为拆分模式并开始观看代码

我使用它并开始深入研究 PHP 应用程序世界，并且可以看到发生了什么（有点）

我知道您可以在 linux 上将 Dreamweaver 与 wine 一起使用，如果您继续使用它可以帮助您获得 TON 授权，它有可能将您限制在 Dreamweaver 世界中......但可以同时帮助您学习和创造

（我现在用记事本从头开始构建完整的 php 应用程序......但我从 DW 开始）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T03:41:58.227

我的问题是你想在网络编程上做什么样的规模？如果它是小东西，那么 LAMP 堆栈将是我的建议，而如果您想深入了解 3 层架构，那么 Java 或 ASP.Net 可能值得进入中间件或业务逻辑代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T19:45:59.360

除了上面提到的 LAMP 堆栈之外，没有任何 Perl 建议。我喜欢 Perl，因为它很容易构建功能齐全的 Web 应用程序（使用 CGI 或 mod_perl）。当然，如果你要在网络上做任何事情，你将不得不学习 HTML/CSS。我觉得 Perl 是 Web 开发的不错选择，因为它相当健壮且功能齐全，具有 CPAN 上可用的所有模块。结合 CGI::Application 或 Catalyst 等应用程序框架，您可以在短时间内构建复杂的 Web 应用程序。此外，使用 XAMPP 之类的工具会有所帮助，因为您无需担心 Web 服务器或数据库配置即可开始使用。

# jquery - 列表元素的 jQuery 选择器

> ID：574264
> 
> 赞同：1
> 
> 时间：2009-02-22T03:35:23.937
> 
> 标签：jquery, html, html-lists, getjson

我正在使用 jQuery 和 jQuery UI。

使用 getJSON 函数，我们正在创建列表元素并将它们附加到 OL 元素。这是代码：

```
$.getJSON("http://localhost/b/t.php", function(data){

        $.each(data, function(i, thet){
            //alert(thet.fname)
            var t = '<li class="name" id="p' + thet.pid + '">' + thet.pid + ' ' + thet.fname + ' ' + thet.lname + '</li>';

            $(t).appendTo("#" + thet.tour + 'list');

        });
    }); 
```

我正在尝试使用 jQuery 选择列表元素。如果我在 HTML 页面中手动放置一个列表，它将起作用。但是，以编程方式将列表项附加到 OL，不允许它选择 - 至少从我尝试过的。

```
$('li:last-child').css({color: 'red', backgroundColor: 'black'}); 
```

我尝试过使用 ID 和许多其他多重选择器，但无济于事。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T03:40:31.867

您何时尝试执行为列表项着色的命令？我相信您必须在 getJSON 的回调函数的末尾放置如下：

```
$.getJSON("http://localhost/b/t.php", function(data){
    $.each(data, function(i, thet){
        //alert(thet.fname)
        var t = '<li class="name" id="p' + thet.pid + '">' + thet.pid + ' ' + thet.fname + ' ' + thet.lname + '</li>';

        $(t).appendTo("#" + thet.tour + 'list');
    });
    $('li:last-child').css({color:'red',backgroundColor:'black'});
}); 
```

# oop - 命名子类的最佳实践

> ID：574269
> 
> 赞同：15
> 
> 时间：2009-02-22T03:36:59.207
> 
> 标签：oop, naming, hierarchy

我经常处于这样一种情况，即我有一个由接口或类表示的概念，然后我有一系列扩展它的子类/子接口。

例如： 一个通用的“DoiGraphNode” 一个代表资源的“DoiGraphNode” 一个代表 Java 资源的“DoiGraphNode” 一个带有关联路径的“DoiGraphNode”，等等等等。

我可以想到三种命名约定，并希望对如何选择提出意见。

* * *

选项 1：始终以概念名称开头。

因此：DoiGraphNode、DoiGraphNodeResource、DoiGraphNodeJavaResource、DoiGraphNodeWithPath 等。

Pro：很清楚我在处理什么，很容易看到我拥有的所有选项

骗子：不是很自然？一切看起来都一样？

* * *

选项2：把特殊的东西放在开头。

因此：DoiGraphNode、ResourceDoiGraphNode、JavaResourceDoiGraphNode、PathBaseDoiGraphNode 等等等等。

亲：看到代码就很清楚了

缺点：找到它可能很困难，特别是如果我不记得名字，缺乏视觉一致性

* * *

选项 3：放置特殊内容并删除一些多余的文本

因此：DoiGraphNode、ResourceNode、JavaResourceNode、GraphNodeWithPath

优点：写和读的不多 缺点：看起来像 cr*p，非常不一致，可能与其他名称冲突

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-22T03:45:40.310

为它们命名。

如果命名它们很难或模棱两可，这通常表明该类做得太多（单一职责原则）。

为避免命名冲突，请妥善选择您的命名空间。

就个人而言，我会使用3

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-22T03:42:45.463

使用任何你喜欢的东西，这是一个主观的事情。重要的是要明确每个类代表什么，并且名称应该使继承关系有意义。不过，我真的认为在名称中编码关系并不是那么重要。这就是文档的用途（如果你的名字适合对象，人们应该能够很好地猜测什么继承自什么）。

对于它的价值，我通常使用选项 3，根据我查看其他人代码的经验，选项 2 可能比选项 1 更普遍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T02:33:10.450

您可以在编码标准文档中找到一些指导，例如这里有 C# 的 IDesign[文档](http://www.idesign.net/idesign/DesktopDefault.aspx)。

就个人而言，我更喜欢选项 2。这通常是 .NET Framework 命名其对象的方式。例如查看属性类。它们都以属性（TestMethodAttribute）结尾。EventHandlers 也是如此： OnClickEventHandler 是处理 Click 事件的事件处理程序的推荐名称。

我通常在设计自己的代码和接口时尝试遵循这一点。因此，IUnitWriter 会生成 StringUnitWriter 和 DataTableUnitWriter。这样我总是知道他们的基类是什么，而且读起来更自然。自我记录代码是所有敏捷开发人员的最终目标，所以它似乎对我很有效！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-01T10:48:15.947

我通常命名类似于选项 1，尤其是当类将被多态使用时。我的理由是最重要的信息位列在最前面。（即子类基本上是祖先的事实，（通常）扩展“添加”）。我也喜欢这个选项，因为在对类名列表进行排序时，相关的类将被一起列出。即我通常将翻译单元（文件名）命名为与类名相同，因此相关的类文件自然会一起列出。同样，这对于增量搜索很有用。

尽管我在编程生涯的早期倾向于使用选项 2，但我现在避免使用它，因为正如您所说，它“不一致”并且看起来不是很正交。

当子类提供大量扩展或规范时，或者如果名称很长，我经常使用选项 3。例如，我的文件系统名称类是从 String 派生的，但它们极大地扩展了 String 类并且具有显着不同的用途/含义：

从 String 派生的 Directory_entry_name 增加了广泛的功能。从 Directory_entry_name 派生的 File_name 具有相当专业的功能。从 Directory_entry_name 派生的 Directory_name 也具有相当专业的功能。

此外，与选项 1 一起，我通常对接口类使用非限定名称。例如，我可能有一个类交互链：

*   文本（一个界面）
*   text_abstract（抽象（基）泛化类）
*   Text_ASCII（特定于 ASCII 编码的具体类）
*   Text_unicode（特定于 unicode 编码的具体类）

我更喜欢接口和抽象基类自动出现在排序列表的首位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T04:08:07.447

选项三更符合逻辑继承的概念。由于您正在专门研究接口或类，因此名称应表明它不再使用基本实现（如果存在）。

有许多工具可以查看类继承自什么，因此一个简洁的名称表明类的真正功能将比试图将过多的类型信息打包到名称中走得更远。

# lisp - 各种 ANSI CL 实现有何不同？

> ID：574279
> 
> 赞同：31
> 
> 时间：2009-02-22T03:42:57.430
> 
> 标签：lisp, common-lisp

当我开始从 Practical Common Lisp 学习 CL 时，正如书中所宣扬的那样，我从 Allegro CL 编译器开始。我停止使用它，因为它的商业性但免费的部分并没有给我留下深刻印象。它需要连接到其远程服务器以获取一些许可。

我切换到“clisp”并正在使用它。现在，我一直听说 SBCL 并计划开始使用它。

所以，问题是：各种 ANSI CL 实现有何不同？有任何使用其中一个的实际经验吗？

谢谢你。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-22T08:32:06.783

参见[*Common Lisp 实现：*](https://web.archive.org/web/20180824234333/https://common-lisp.net/~dlw/LispSurvey.html) Daniel Weinreb 的调查。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-22T15:31:02.627

如果你在一台可以运行 SBCL 的机器上，你应该使用它。它是最快的免费 Lisp 编译器（它可以生成与 Haskell、OCaml、Java、C 和 C++ 一样快的代码，这些代码都非常快，尤其是与 Python 和 Ruby 相比）。它也是一个相当完整的实现，并且支持 Swank 的大部分功能（用于 SLIME），这在您开发时非常有用。

正如其他一些评论所提到的，当您第一次开始时，您不会真正注意到任何差异。所有免费的 CL 实现都“足够快”并支持您需要的所有功能。但是，如果您开始编写生产软件，您会喜欢 SBCL 的功能。OTOH，现在真的没有理由不切换。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-01-17T03:26:48.720

我一直在寻找相同问题的 Win32 解决方案。至于 Windows 上的免费 Lisp 实现，我强烈推荐 Clozure CL (CCL)。有几个原因。首先是 Clozure 支持 32 位和 64 位二进制文​​件。它非常快，而且有点紧凑。但最重要的是，它是一致且正确的。在使用 Lispworks（我很怀念）几年后，我发现它是一个非常成熟的 Lisp。CCL 在本机操作系统线程、套接字和其他一些不属于 CL 规范的元素方面做得非常好。它对CLOS的实现似乎非常彻底。它的 GC 和内存管理非常出色。我在 Win32 上将 CCL 与 SBCL 进行了比较，虽然 SBCL 在几个基准测试中要快一些，但它的缺点更多，而且它的形象不断增长，即使经过几次强制GC。同时，CCL 始终如一、小巧、快速且易于使用。如果您想要一个在 Windows、Mac 和 Linux 上保持一致并且同时支持 32 位和 64 位的平台，那就别无所求。

我确实在 Win32 上尝试过 CormanLisp，我喜欢它的很多地方。但它不能在 64 位 Windows 平台上正常运行，并且仅限于 Win32。它也不是免费的，当我向它扔一些垃圾代码时，不知何故我让它崩溃了。我也很容易让 SBCL 崩溃。CCL 并非如此。坚如磐石。真的，这些人做得非常出色，最终将帮助 Lisp 保持活力。

至于 SLIME，我没有尝试让 SLIME 与 SBCL 一起工作，但我确实让它与 CCL 一起工作得很好。无论您喜欢什么，我都建议人们编写易于移植的代码。目标是 Windows、Mac 和 Linux，目标是 64 位。如果您考虑这些，那么整体而言，CCL 是您的最佳选择。

回答这个问题的最后一个尝试是考虑其他问题的问题。这是我来找的：

*   CLISP is nice, but is far slower, relative to SBCL or CCL. I see little upside
*   SBCL seems poor on Win32\. Image size can get big.
*   CormanLisp is good on Win32, but not portable, and does not support Windows x64. It also seems that Roger Corman is not actively developing CormanLisp, which is a shame, but it's the reality.
*   Clojure (with a "j") is *not* Common Lisp. As nice as it may be, I think that if you already know CL, then it's not worth the overhead of learning Clojure's many differences. I'm sure some may pick them up fast, but I surely did not. (If Java-compatible code is what you're after, then look at ABCL).

dave

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-22T04:38:10.730

ANSI CL 的某些部分将某些细节留给实现来确定；您会发现对于标准的这些部分，每个实现都有自己的怪癖。

此外，寻找对运行时很重要但未在语言中定义的东西：线程和多处理以及垃圾收集之类的东西在性能和可靠性方面会有很大差异。

我发现 SBCL 是 Linux 中最容易使用的实现。它对 Linux 中的线程有很好的支持。关于垃圾收集器我不能说太多，因为它对我来说还不是很重要。

在 Windows 上，您最好的选择可能是 Allegro 或 LispWorks，尽管我在 Windows 上使用 clisp 取得了一些成功。SBCL 的 Windows 移植正在进展中，但我并没有使用太多，所以我不能真正发表评论。

一般来说，对这类通过研究或分析难以获得的事物的理解；它来自经验。只需选择一个您感到满意的体面实现，然后开始工作。你会在你去的时候弄清楚棘手的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-22T04:19:56.920

我没有足够的知识来给你一个详细的答案，但我注意到当我在我的 AI 课程中使用 CL 时，SBCL 比 Clisp 快得多。除非您有令人信服的理由不这样做，否则我建议您选择 SBCL。

我听说 Clisp 比 SBCL 更容易安装并且更便携（它有很多特定于处理器的优化），但是如果你使用的是 Linux，它们都很容易从包管理器中获取。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-20T23:32:26.047

我发现 clisp 中的错误消息更友好，可以帮助我更快地找到问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-15T07:11:15.977

看来 SBCL 的 REPL 与 clisp 相比不友好？EG 我可以使用 TAB 键在 clisp 中自动完成输入。

所以 clisp 更适合 lisp 新手。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T16:23:54.060

取决于您选择的操作系统

*   Windows - 使用 ecl 或 abcl
*   Linux - 使用 sbcl 或 ecl 或 abcl 或 cmucl
*   Mac - ccl 或 ecl 或 sbcl
*   其他 - abcl 或 ecl 或 sbcl

编辑：

Windows 上的 Sbcl 缺乏线程，并且通常不是那么稳定，并且没有一个核心维护人员使用 Windows。

ecl 是跨平台 lisps 的更好选择，它的功能集在所有主要平台上都同样稳定。

编辑 2011-10：Sbcl windows 现在有线程支持。它还没有完全合并到 mainiline 中，但是有一个非常稳定的 fork，它具有线程和其他 Windows 特定的好东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-22T13:55:52.700

如果您在 Windows 下使用[cygwin](http://www.cygwin.com/)安装 clisp，我非常幸运。

# c# - 运算符'=>'在C#中是什么意思？

> ID：574280
> 
> 赞同：6
> 
> 时间：2009-02-22T03:43:18.473
> 
> 标签：c#, delegates, lambda

此语句中的“=>”是什么意思？

```
del = new SomeDelegate(() => SomeAction()); 
```

上面的声明和这个一样吗？

```
del = new SomeDelegate(this.SomeAction); 
```

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-22T03:46:44.190

基本上它指定了一个匿名函数，它不接受调用 SomeAction 的参数。所以是的，它们在功能上是等效的。虽不相等。使用 lambda 更等同于：

```
del = new SomeDelegate(this.CallSomeAction); 
```

其中 CallSomeAction 定义为：

```
public void CallSomeAction()
{
    this.SomeAction();
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T03:54:24.033

它们*做*同样的事情，但“() => ...”语法是所谓的 lambda 表达式，因此与匿名函数相同。您可以完全省略委托部分，让编译器为您推断委托类型。

```
del = this.SomeAction; 
```

取决于“del”被声明为什么类型。

**编辑**

使用 lambdas 或匿名方法或仅使用常规方法作为初学者，您可以将没有委托签名的方法映射到委托。

例如，假设您有一个签名为 bool myDelegate(int, int) 的委托，但您希望有一个签名为 bool myMethod(string, string) 的方法来处理该委托。然后，您可以使用 lambda 表达式让您使用类似这样的简短语法内联执行此操作。

```
delegate bool myDelegate(int x, int y);

// With lambdas... 
myDelegate del = (int a, int b) => myMethod(a.ToString(), b.ToString());

// With anonymous methods...
myDelegate del2 = delegate(int a, int b) { return myMethod(a.ToString(), b.ToString()); };

// The good ol' way without lambdas or anonymous methods...
myDelegate del3 = SomeDelegateHandler;

... then write a method somewhere else ...

// Handler method
private bool SomeDelegateHandler(int a, int b)
{
  return myMethod(a.ToString(), b.ToString());
} 
```

所以你可以看到 lambdas 和匿名方法基本上只是一种更短/内联的方法来处理委托。在您的情况下，您可能不需要额外的方法。这仅取决于委托签名是否与您的方法签名相同，对我来说，似乎是这样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T04:00:48.480

“=>”可以读作“转到”（[来源：Eric Lippert](http://blogs.msdn.com/ericlippert/archive/2008/05/16/reading-code-over-the-telephone.aspx)），并简单地将参数与 lambda 表达式中的操作分开。在这种情况下，lambda 是多余的。更好的例子是：

```
var subList = list.FindAll(item => item.Type == "Foo"); 
```

（查找项目类型为 Foo 的所有项目）

等等。在 C# 2.0 中，也可以这样写：

```
var subList = list.FindAll(delegate(SomeType item) {
   return item.Type == "Foo";}); 
```

并且是一种快速表达函数“内联”的方式，同时还提供“闭包”支持 - 即它也可以是：

```
string itemType = ...
var subList = list.FindAll(item => item.Type == itemType); 
```

要做到这一点，否则需要一个类型定义来传递项目类型：

```
class Searcher {
    public string itemType;
    public bool Find(SomeType item) {return item.Type == itemType;}
}
...
Searcher searcher = new Searcher();
searcher.itemType = ...
var subList = list.FindAll(searcher.Find); 
```

事实上，这几乎正是编译器为我们所做的（对于“委托”和 lambda 的使用）。最大的区别是 lambda 也*可以*表示`Expression`，例如对于 LINQ。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T03:59:00.900

`=>`是[Lambda 运算符](http://msdn.microsoft.com/en-us/library/bb311046.aspx)，lambda 表达式就像 C# 2.0[匿名方法](http://msdn.microsoft.com/en-us/library/0yw3tz5k(VS.80).aspx)的演变。

您可以以非常相似的方式使用匿名方法和 lambda 表达式来创建委托实例：

```
Func<string,int> wordCount;
wordCount = delegate (string text) { return text.Split().Length; };
Console.WriteLine (wordCount("Hello World")); 
```

使用 lambda 表达式：

```
Func<string,int> wordCount;
wordCount = (string text) => { text.Split().Length; };
Console.WriteLine (wordCount("Hello World")); 
```

# rest - 数据的语义是 REST 的组成部分吗？

> ID：574281
> 
> 赞同：1
> 
> 时间：2009-02-22T03:43:54.573
> 
> 标签：rest, semantics, representation

[这是对要求解释 REST](https://stackoverflow.com/questions/551933/can-you-explain-the-web-concept-of-restful/)的问题的跟进。

正如您从对我的回答的评论中看到的那样，我们与达雷尔·米勒（ [Darrel Miller](https://stackoverflow.com/users/6819/darrel-miller)）就资源的最佳媒体表现进行了小争论。我们进行了进一步的电子邮件讨论，导致了这个问题。

Darrel 和我对 REST 的理解的主要区别在于数据的语义是否是 REST API 的一部分。

Darrel 相信（我对他的话的解释 :-)）数据的语义是 REST API 的重要组成部分，因此，选择的媒体表示应该反映它。因此，一个合适的 REST API 应该选择：

*   像 ATOM 这样的知名媒体来表示数据，以便尽可能多的客户端可以原生地理解资源的语义；
*   特定于应用程序的媒体类型，例如 application/vdn.mycomany.mymedia 并希望客户端了解此媒体类型以便能够使用资源数据。application/xml 不是一个很好的资源表示，因为它不表示媒体类型中的语义，但需要客户端更多地了解语义。

另一方面，我认为 REST API 是与实际数据表示不同的层。API 暴露的媒体类型只是一个传递资源数据的容器。数据的实际语义是分开处理的。因此，不理解数据的客户端仍然可以使用 REST API。Application/xml 是一种非常好的数据表示，因为它允许理解架构的客户端紧密耦合，但仍然允许不理解架构的客户端对资源进行一些基本处理。

**因此，问题**是：REST API 的数据语义部分吗？我们是否应该只选择媒体类型来表示实际也表示数据语义的资源表示？

如果人们在他们的答案中发布一些引文，最好是来自罗伊人本人，我会很感激。:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T14:46:08.100

让我们从头开始：媒体类型的存在是为了向客户端提供一种格式，它可以用来决定下一步要做什么。没有 html 页面，浏览器就没有可访问的链接。如果没有 html 渲染器，浏览器将无法渲染页面并且不知道该做什么。

如果没有媒体类型，客户端不知道它是否能够对字节流做任何事情。实际上，当客户端收到指定 application/xml 的标头时，除了获取 xml 解析器之外，它不知道要做什么。

所以问题真的是，客户端是否应该能够在不查看消息内部的情况下根据 http 消息做出决定，还是应该去查看消息内部（或者更糟糕的是，首先解析消息）以知道要做什么做。

缺少媒体类型意味着您的客户端将不得不做额外的窥视工作，或者更糟的是处理实体主体本身，然后才能做出决定，无论是渲染还是处理。您现在必须为您可能想要处理的每种格式添加大量自定义行为，并且您在此过程中松散了一些耦合。

这也是一个 http 基础，中介应该能够在不检查正文的情况下处理请求，而且 application/xml 也是有问题的。

现在，当您说媒体类型的语义是 API 的一部分或不是 API 的一部分时……什么构成 API？

从客户端的角度来看，没有 API。有一个初始表示可以让客户决定下一步该做什么。媒体类型确实是客户端获取导航“API”所需信息的地方，因此没有表示就没有 API。

此外，客户端应该只有三个知识：引导位置、HTTP 协议和媒体类型。第一个只是一个 URI，并没有传达超出继续所需的表示位置的内容。第二个已经有了很清晰的语义。第三个是您可以控制的，因为这是您与客户的合同。

该合同规定，无论何时您想做某事，该某事都将具有语义：要添加客户，请使用 POST 将 application/vnd.acme.customer+xml 发送到 /customers。

因此我的回答是：设计 REST 架构依赖于两个步骤：资源建模（在概念级别）和媒体类型构建。其他任何事情，您都可能做错了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T05:42:20.903

我认为没有必要对此过于迂腐。一个资源可以暴露多个表示；每个都有自己的语义（甚至还有多个语义维度）。如果一种表示不提供特定用例所需的语义，则公开提供的一种。

> 因此，不理解数据的客户端仍然可以使用 REST API。

我不确定这是一个很好的试金石，可以测试什么可以或不可以做一个体面的代表。可以使用文档但不能很好地理解它以对其进行任何操作的客户端有什么好处？我想我不明白“资源的基本处理”如何使 application/xml 成为比任意 1 和 0 的 blob 更好的选择？

既然您要求提供参考资料，[这里有一篇来自 Roy Fielding 的文章，他在其中“提出”了社交网络图的位图表示](http://roy.gbiv.com/untangled/2008/paper-tigers-and-hidden-dragons)。我当然可以得到一台机器来显示这些位图，但是如果我不了解底层的社交网络图又有什么用呢？将表示更改为 application/xml 是否允许天真的客户端从中提取位图中未包含的其他含义？没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T14:20:34.793

查看Mark Ba​​ker 的[这](http://www.markbaker.ca/Talks/2004-xmlself/slide1-0.html)组幻灯片，了解有关 application/xml 为何不满足“自我描述”约束的更多解释。您还可以阅读他博客上的许多文章，包括[这篇](http://www.markbaker.ca/blog/2004/01/xml-namespace-dispatching-with-applicationxml/)文章，他继续解释为什么 application/xml + 命名空间不等同于媒体类型。

# c++ - 使用 C++ 代码检查 txt 文件是否存在

> ID：574285
> 
> 赞同：3
> 
> 时间：2009-02-22T03:45:43.617
> 
> 标签：c++, visual-studio, file

首先，我要确定我的文件夹目录中确实有文本文件。我正在使用 Visual Studio，这是我的源代码正在编译的地方。

下面的代码应该说明它为什么不工作。在视觉工作室。

```
int main( const int argc, const char **argv )
{
    char usrMenuOption;
    const char *cFileName = argv[ 1 ];
    checkName( cFileName );  // supplying the checkName function with contents of argv[1]

    usrMenuOption = getUsrOption();  // calling another function

    fgetc(stdin);
         return 0;
}
ifstream *openInputFile( const char *cFileName )
{
    // this function might be the pronblem.
    ifstream *inFile;
    inFile = new ifstream; 
    inFile->open( cFileName, ios::in );
    return inFile;
}
bool checkName( const char *cFileName )
{
    // it works fine if i use a regular ifstream obj and not the one from the function
    ifstream *inFile;
    inFile = openInputFile( cFileName );
    inFile->open( cFileName, ios::in );

    if ( inFile->good() )
    { 
        return true;
    }
    else
    { 
        cout << '"' << cFileName << '"' << ": File does not exist! " << endl;
        return false;
    }         
} 
```

如果我对 ifstream 使用非指针对象，它确实有效。但是我需要使用我制作的功能以这种方式打开所有输入文件。我有点困惑，因为我在 dev-cpp 中编译时没有这个问题

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-22T04:03:11.780

你有几个选择：

1.  您尝试过的那个 - 打开文件。
2.  使用[stat](http://www.techbytes.ca/techbyte103.html)。
3.  使用[GetFileAttributes](http://msdn.microsoft.com/en-us/library/aa364944(VS.85).aspx)。
4.  使用[FindFirstFile](http://msdn.microsoft.com/en-us/library/aa364418(VS.85).aspx)。

保证它存在**并且您可以使用它**的唯一方法是打开它。如果您使用其他方法，您最终会遇到竞争条件（因为在您检查文件是否存在后可能会删除或锁定该文件。

**编辑**：您的代码中还有其他一些问题。首先，您分配了一个`infile`via `new`，但您从来没有分配过`delete`它。其次，你打电话`open`两次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T03:54:32.457

这是测试是否存在的糟糕方法：因为如果文件被另一个进程打开，则文件存在但您无法打开它。

更好的测试方法可能是使用[GetFileAttributes 函数](http://msdn.microsoft.com/en-us/library/aa364944(VS.85).aspx)：如果它不返回`INVALID_FILE_ATTRIBUTES`，则文件存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-22T16:30:39.270

If you don't mind using Boost, there is a simple function boost::filesystem::exists( path ) that would be useful to you I guess !

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T16:34:06.077

I always check ifs.is_open() where ifs is a ifstream.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T05:49:33.803

检查文件是否存在（符合 POSIX.1）：

```
#include <unistd.h>

if (! access (file_name, F_OK))
{
  // File exists.
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T05:56:34.223

[如何使用 ANSI C++ 检查文件是否存在？](http://www.allegro.cc/forums/print-thread/313562)

```
#include <fstream>

inline bool FileExists(const char * filename)
{
    return std::ifstream(filename);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-22T06:35:08.390

您试图在内部打开文件两次`checkName()`：第一次在调用内部的构造函数调用中`openInputFile()`，第二次在内部调用`checkName()`。为什么第二次调用`open()`？

我不知道当`ifstream`一个已经打开的文件尝试访问`open()`另一个文件时会发生什么，但这不会很好，而且它很可能取决于确切的库实现（因此 Dev-C++ 和 MSVC++ 之间的行为不同） . 简而言之，**不要这样做**。

至少还有一个错误：您没有`inFile`关闭`checkName()`.

## 但无论如何，改为这样做

Really, it's better not to have a separate `checkName()` function -- just have `openInputFile()` attempt to open the file, and if it fails, report the error right there and/or return a `NULL` pointer (or even throw an exception). That way, the operation is "atomic" -- as things stand, if the file exists at the time `checkName()` is called but is deleted before a subsequent call to `openInputFile()`, your code will get very confused.

# iphone - 在标签中播放音乐的 UITabBar 应用程序和按钮

> ID：574288
> 
> 赞同：1
> 
> 时间：2009-02-22T03:47:35.843
> 
> 标签：iphone

我有一个 AVAudioPlayer 实例在我的一个选项卡中运行。它通过 IBAction 激活。

我希望当用户单击另一个选项卡时音乐停止。

我该怎么做呢？

我试过 theAudio.stop; 在 viewDidLoad 中，但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T06:15:01.747

在您的 UITabBarControllerDelegate 中实现以下方法；

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController 
```

每当用户在控制器中选择一个新视图时都会调用它。

我认为您还可以在播放音频的 UIViewController 中覆盖以下方法

```
-(void) viewDidDisappear:(BOOL)animated 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:46:30.520

将 UITabBarControllerDelegate 连接到您的主视图，然后监听`(void)tabBarController:(UITabBarController *)tabBarController didSelectItem:(UITabBarItem *)item`

当您收到该事件时，在您的对象模型中找到播放器并停止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-22T03:09:06.833

我在尝试回答相同的确切问题时偶然发现了这篇文章。以防万一其他人还在寻找，我终于想出了如何使用 NSNotificationCenter 来做到这一点。基本上，NSNotificationCenter 向整个应用程序发送“广播”消息。如果“观察者”碰巧在监听，如下所示，则调用给定的方法。代码如下所示：

在您的应用程序委托中：

```
 - (void)applicationDidFinishLaunching:(UIApplication *)application {

    // Add the tab bar controller's current view as a subview of the window
    [window addSubview:tabBarController.view];

    // Make sure you add this so that your tab bar calls its delegate methods
    tabBarController.delegate = self;
}

    // Optional UITabBarControllerDelegate method (this will be commented out by default - uncomment it)

    - (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
                // Create the NSNotificationCenter
                [[NSNotificationCenter defaultCenter] postNotificationName:@"tabChanged" object:nil];
    } 
```

在您的视图控制器中：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    // Register an observer to stop audio recording/playing on tab change
    [[NSNotificationCenter defaultCenter] addObserver:self
                          selector:@selector(tabChanged)
                          name:@"tabChanged"
                          object:nil];
}

- (void)tabChanged {
        @"Received Notification!";
        if([player isPlaying]) {
            [player stop];
        }
} 
```

# unix - 解析每个字段并使用 'awk'/'gawk' 处理它

> ID：574292
> 
> 赞同：0
> 
> 时间：2009-02-22T03:53:44.923
> 
> 标签：unix, awk

这是一个查询：

```
grep bar 'foo.txt' | awk '{print $3}' 
```

'awk' 查询发出的字段名称是错位的 C++ 符号名称。我想将每个传递给[dem](http://docs.oracle.com/cd/E24457_01/html/E22003/dem.1.html)，最后输出 'dem' 的输出 - 即去错符号。

假设字段分隔符是“”（空格）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T03:58:40.090

`awk`是一种模式匹配语言。`grep`完全没有必要。

```
awk '/bar/{print $3}' foot.txt 
```

做你的例子。

**编辑**阅读前面答案的评论后修正了一点（我对`dem`......一无所知）：

您可以使用`system`awk 中的调用，例如：

```
awk '/bar/{cline="dem " $3; system(cline)}' foot.txt 
```

但这会`dem`为每个处理的符号生成一个实例。非常低效。

所以让我们变得更聪明：

```
awk '/bar/{list = list " " $3;}END{cline="dem " list; system(cline)}' foot.txt 
```

**顺便说一句**——未经测试，因为我没有`dem`或您的输入。

* * *

另一个想法：如果您要使用`xargs`其他海报提供的公式，`cut`可能会比`awk`. 但是，到那时，您将`grep`再次需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T03:54:49.087

怎么样

```
grep bar 'foo.txt' | awk '{ print $3 }' | xargs dem | awk '{ print $3 }' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T04:04:58.483

这将打印解构后的符号，并在方法的情况下包含参数列表：

```
awk '/bar/ { print $3 }' foo.txt | xargs dem | sed -e 's:.* == ::' 
```

这将打印解构符号，在方法的情况下*没有*参数列表：

```
awk '/bar/ { print $3 }' foo.txt | xargs dem | sed -e 's:.* == \([^(]*\).*:\1:' 
```

干杯，V。

# c# - 在 C#、Windows 窗体中调整面板的大小

> ID：574299
> 
> 赞同：3
> 
> 时间：2009-02-22T03:56:59.020
> 
> 标签：c#, winforms, visual-studio

如何让用户在运行时通过拖动角来调整面板的大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T04:14:29.477

我不知道拖动角落，但您可以停靠面板并使用拆分器为用户提供调整停靠区域大小的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T04:33:10.180

你可以拦截鼠标位置和点击..如果它在一个角落然后设置一个调整大小的布尔值，然后在 mousemove 事件上你可以实现这样的东西..

```
 if (_resizing)
  {
    this.Height = top + e.Y;
    this.Width = width + e.X;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T04:30:48.687

如果您想使用实际的 System.Windows.Forms.Panel 并让它动态调整大小，那么您必须像进行拖放一样进行操作。您必须处理面板上的鼠标 Click 事件，确定您是否位于面板边缘（在 2-3 像素内），然后处理 Drag 事件并更改面板的 Size 属性。

# html - 如何匹配 HTML 中不在标签内的文本？

> ID：574302
> 
> 赞同：8
> 
> 时间：2009-02-22T03:59:04.117
> 
> 标签：html, regex, perl

给定这样的字符串：

```
<a href="http://blah.com/foo/blah">This is the foo link</a> 
```

...和像“foo”这样的搜索字符串，我想突出显示 HTML 文本中所有出现的“foo”——但不在标签内。换句话说，我想得到这个：

```
<a href="http://blah.com/foo/blah">This is the <b>foo</b> link</a> 
```

但是，简单的搜索和替换不会起作用，因为它会匹配 <a> 标记的 href 中的部分 URL。

因此，以问题的形式表达上述内容：如何限制正则表达式，使其仅匹配 HTML 标记之外的文本？

注意：我保证有问题的 HTML 永远不会像以下那样病态：

```
<img title="Haha! Here are some angle brackets to screw you up: ><" /> 
```

**编辑：**是的，我当然知道 CPAN 中有复杂的库可以解析最令人发指的 HTML，从而减少对这种正则表达式的需求。在很多情况下，这就是我会使用的。但是，这不是其中一种情况，因为保持这个脚本简短而简单，没有外部依赖是很重要的。我只想要一个单行正则表达式。

**编辑 2：**同样，我知道 Template::Refine::Fragment 可以为我解析所有 HTML。如果我正在编写*应用程序*我当然会使用这样的解决方案。但这不是应用程序。它只不过是一个 shell 脚本。这是一段一次性代码。在这种情况下，作为可以传递的单个、独立的文件非常有价值。“嘿，运行这个程序”比“嘿，安装一个 Perl 模块然后运行这个程序——等等，什么，你以前从未使用过 CPAN？好吧，运行 perl -MCPAN -e shell（最好作为 root) 然后它会问你一堆问题，但你真的不需要回答它们。不，不要害怕，这不会破坏任何东西。看，你不需要仔细回答每一个问题——只是一遍又一遍地敲回车。不，我保证，它不会破坏任何东西。

现在，很多用户都想知道为什么他们一直在使用的简单脚本不再那么简单了，而所有改变的只是使搜索词变为粗体字。

因此，虽然 Template::Refine::Fragment 可能是其他人的 HTML 解析问题的答案，但它不是*这个*问题的答案。我只想要一个正则表达式，它适用于脚本实际上将被要求解析的非常有限的 HTML 子集。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-22T04:26:05.720

If you can absolutely guarantee that there are no angle brackets in the HTML other than those used to open and close tags, this should work:

```
s%(>|\G)([^<]*?)($key)%$1$2<b>$3</b>%g 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-22T04:15:06.743

通常，您希望将 HTML 解析为 DOM，然后遍历文本节点。我会为此使用 Template::Refine：

```
#!/usr/bin/env perl

use strict;
use warnings;
use feature ':5.10';

use Template::Refine::Fragment;

my $frag = Template::Refine::Fragment->new_from_string('<p>Hello, world.  <a href="http://foo.com/">This is a test of foo finding.</a>  Here is another foo.');

say $frag->process(
    simple_replace {
        my $n = shift;
        my $text = $n->textContent;
        $text =~ s/foo/<foo>/g;
        return XML::LibXML::Text->new($text);
    } '//text()',
)->render; 
```

这输出：

```
<p>Hello, world.  <a href="http://foo.com/">This is a test of &lt;foo&gt; finding.</a>  Here is another &lt;foo&gt;.</p> 
```

无论如何，不​​要使用正则表达式解析结构化数据。HTML 不是“常规的”，它是“无上下文的”。

Edit: finally, if you are generating the HTML inside your program, and you have to do transformations like this on strings, "UR DOIN IT WRONG". You should build a DOM, and only serialize it when everything has been transformed. (You can still use TR, however, via the `new_from_dom` constructor.)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T04:29:38.457

The following regex will match all text between tags or outside of tags:

```
<.*?>(.*?)<.*?>|>(.*?)< 
```

Then you can operate on that as desired.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T09:44:19.347

Try this one

`(?=>)?(\w[^>]+?)(?=<)`

it matches all words between tags

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-27T07:36:02.747

To strip off the variable size contents from even nested tags you can use this regex that is in fact a mini-regular grammar for that. (note: PCRE machine)

(?<=>)((?:\w+)(?:\s*))(?1)*

# wpf - 具有选择跨度能力的 DatePicker

> ID：574303
> 
> 赞同：3
> 
> 时间：2009-02-22T04:00:14.847
> 
> 标签：wpf, datepicker

这是我从 Google Analytics 获得的想法的快速视图。

组合框折叠：

[组合框折叠 http://www.googlemapscontrol.net/images/CalendarDropDownClosed.jpg](http://www.googlemapscontrol.net/images/CalendarDropDownClosed.jpg)

组合框展开：

[组合框扩展 http://www.googlemapscontrol.net/images/CalendarDropDownOpen.jpg](http://www.googlemapscontrol.net/images/CalendarDropDownOpen.jpg)

我不关心时间线或日期范围文本框的功能。基本上我希望有一些看起来有点像带有单个日历控件的 ComboBox 的东西。选择日期范围并关闭控件后，该范围将显示在文本框中。

我不认为我可以让 ComboBox 以这种方式运行，我认为我需要使用文本块、按钮和弹出窗口等内容。

有人有我可以开始的样品吗？

如果您没有样本，您将如何处理这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T00:15:14.743

[WPF 工具包](http://www.codeplex.com/wpf)有一个 Calendar/DatePicker 控件，可以作为一个合适的基础，您可以将其修改为复杂的日期范围选择器。

我将从 WPF Toolkit 发行版中的 DatePicker Generic.xaml 文件开始，并检查他们对 DatePicker 控件模板所做的工作。对您来说有趣的部分将在使用`PART_TextBox`和`PART_Button`使用的区域周围。他们确实使用了网格、文本框、按钮和弹出控件的组合。

希望有帮助！

# bash - 没有 BASH 的 UNIX shell 中有哪些好东西？

> ID：574305
> 
> 赞同：5
> 
> 时间：2009-02-22T04:01:42.127
> 
> 标签：bash, unix, shell

自从我使用 Unix-Linux/Solaris 以来，我一直在使用“bash”。现在，我很想知道像 'ksh'、'zsh' 这样的 shell 提供什么更好？*“极客”有什么用？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T04:13:34.207

我偏爱 zsh（它就像 ksh 和 bash 的混合体）。该[指南](http://zsh.sunsite.dk/Guide/zshguide.html)对其功能进行了很好的概述。这个[页面](http://www.faqs.org/faqs/unix-faq/shell/shell-differences/)有一个很好的图表，显示了不同 shell 中不同功能的可用性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T04:18:44.287

*   bash：根据我的经验，大多数人使用 bash，部分原因是它是大多数 Linux 系统中的标准 shell。

*   ksh：许多 Solaris 系统使用 ksh 代替，但这似乎正在失去对 bash 的普及。

*   csh：csh 曾经更流行，但一般被 tcsh 取代。tcsh 对于那些非常熟悉类 c 语法的人来说还不错。

*   zsh：我没用过zsh，不过好像功能很丰富。

就个人而言，我更喜欢 bash，因为它几乎安装在所有与 unix 兼容的操作系统上，用途广泛，是简单命令行工具和脚本语言之间的良好折衷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T05:36:47.610

最好知道 Bash 具有最广泛的兼容性，您基本上可以坐在任何 Unix 上，它会在那里。

Zsh 可能是最现代的 shell 之一。你可以用它做各种疯狂有趣的事情

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T04:14:31.473

我偏好使用 ksh93。这意味着我发现自己使用的几乎任何系统都可以使用 ksh 的基础知识，因此我的交互体验和 98% 的复杂配置文件保持不变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T04:23:10.250

`bash`有点慢，但像许多 FSF 程序一样，它试图合并所有已知的功能。我使用`ksh93`，这在很大程度上与`bash`. 的主要优点`ksh`是它有一个很好的接口，可以用 C 代码扩展 shell。自定义也更容易一些，例如，让 tab 键在上下文中做任何你想做的事情。缺点是没有内置命令补全；你必须对其进行编程。

避免`csh`及其衍生物:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T05:32:16.183

`csh`根据我的经验，在标准 Unix shell（对我来说，这意味着, `sh`, `ksh`）中很少有好东西在`bash`. 因此，只要您`bash`对所有机器都感到满意，您也可以使用它来获得最大的功能。

OTOH，如果您想处理可移植性，您可能会使用`ksh`，它非常接近 POSIX 标准 - 带有一些扩展（bash 也非常接近 POSIX 标准，但有更多的扩展）。

我真的很喜欢 POSIX`$(cmd)`符号来代替经典的反引号

```
`cmd` 
```

（这在 Markdown 中可不好玩！）。喜欢它的一个主要原因是嵌套调用要容易得多：

```
gcclib=$(dirname $(dirname $(which gcc)))/lib 
```

用反引号把它写在一条线上是很愚蠢的，以至于你不会试图把它变成一条线。那是`ksh`和`bash`; 它不在经典的 Bourne shell 中（`/bin/sh`但请注意，`/bin/sh`在某些机器上不是经典的 Bourne shell 而是`bash`伪装的），也不在 C shell 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-28T02:02:02.117

如果您正在使用 bash 并且对它感到满意，则无需立即更改。这是一个很好的外壳。了解它的历史也会告诉你一些事情：Bourne Again SHell。这是一个比 C-Shell 及其衍生工具（如 tcsh）更好的 shell 的尝试，允许您使用 /bin/sh 语法来编写脚本（或用于交互使用），但添加了一些 csh 更好的特性（如历史等）。

Korn shell 和 Bash 在概念上有很多共同点。与 /bin/sh 一样，[Korn shell](http://en.wikipedia.org/wiki/Korn_shell)最初来自 AT&T，直到最近才开源。它有一个很好的历史机制，并且对历史状态文件进行文件锁定，因此如果它们安装在网络文件服务器上，shell 的多个副本将正确地写入历史文件而不会相互破坏。它还支持 /bin/sh 语法，并结合了 /bin/csh 的一些优点。ksh 有很多东西，如果你能找到它，它通常是一个相当不错的 shell。我曾经在 Solaris 上使用它，尤其是当我在 Sun 工作时。我不想安装操作系统没有附带的任何东西，因为我每周安装了几次新的操作系统，所以这是一个不错的选择。

现在我使用 Bash 或 zsh。我更喜欢 zsh，因为它具有丰富的命令完成功能和一般编写 shell 函数的功能（对于我的交互式 shell——在编写脚本时，我坚持使用非常标准的 Bourne shell 东西）。

正如其他人所说，最好避免使用任何版本的 C-shell，除了那些为您提供 /bin/csh 的某些功能但不是从 /bin/csh 代码派生的 shell。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T04:14:28.883

我安装了一个来提供每个会话的 shell 历史记录。

这里的独特之处在于每个窗口都有自己的 shell 历史。很方便。

# c# - 传输带有元数据的文件

> ID：574310
> 
> 赞同：0
> 
> 时间：2009-02-22T04:06:13.363
> 
> 标签：c#, xml, ftp, transfer

我正在编写一个客户端 Windows 应用程序，它将允许将文件和相应的元数据上传到服务器。例如 gear.stl（原始文件）和 gear.stl.xml（元数据）。我正在尝试找出用于传输文件的正确协议。

我正在考虑使用 ftp，因为它被广泛使用并且是一种经过验证的传输文件的方法，除了我必须为每个实际文件（.stl 和 .stl.xml）传输 2 个文件。然而，另一个想法也闪过我的脑海......如果我创建一个对象并包装文件、元数据和我需要将其传输到的目录、序列化对象然后向 Web 服务提交请求以传输文件怎么办？ .

原始文件大小范围从 100k 到 10MB。元数据大小可能小于 200k

对我来说，网络服务调用似乎是一个更容易反序列化对象并相应地分发文件和相应元数据的过程。但是，我不确定这是否是一个合理的想法，或者除了我提到的两种方法之外，是否还有更好的方法来传输这些数据。

如果有人能指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T05:06:11.130

您可以像“新”办公文档格式一样将其包装在一个 zip 文件中。您甚至可以使用他们的类将其全部打包。

**编辑：**

看看[System.IO.Packaging.Package](http://msdn.microsoft.com/en-us/library/system.io.packaging.package.aspx "System.IO.Packaging.Package")类。这似乎是你需要的。此类驻留在 WindowsBase.dll 程序集中并在 .NET 3.0 中可用。

PS：请记住，即使它是一个 zip 文件，也不需要压缩。如果您有非常大的文件，最好不要压缩它们。这一切都取决于它们将如何使用以及传输大小是否是一个问题。

# sql-server - 使用 sqlconnection 类连接到 sql server

> ID：574311
> 
> 赞同：1
> 
> 时间：2009-02-22T04:07:45.653
> 
> 标签：sql-server, database, database-connection, connection-string

我正在尝试使用以下代码在我的应用程序中连接到 Sql Server：

```
SqlConnection myConnection = new SqlConnection();
myConnection.ConnectionString = "Data Source = (local);Initial Catalag = Inventory;
                                 Persist Security Info = false;
                                 Integrated Security = true;
                                 Packet Size = 4096;Connect TimeOut = 30";
myConnection.Open(); 
```

其中 Inventory 是我的数据库，它存在于我的本地计算机上。

“错误 40：无法打开与 Sql Server 的连接”---错误在上述代码执行时出现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T05:44:06.657

它的**Initial Catalog**而不是**Initial Catalag**。

你可能想测试这个改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T04:24:00.717

如果您未在连接字符串中指定网络库，则默认情况下将使用 TCP/IP 建立与数据库的连接。

安装 SQL Server 后通常不启用 TCP/IP 网络库。使用 SQL Server 配置管理器启用协议。

或者，如果您想使用启用的协议（可能是共享内存），请将 Network Library=dbmslpcn 添加到连接字符串中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-22T06:06:10.330

您的电脑中是否有超过 1 个 SQL Server 实例？那么**Data Source = (local)**是不明确的。

如果是这种情况，请尝试在连接字符串中使用**Data Source = MyServername\MyInstance 。**

# css - 3 列和 2 列全屏（宽度和高度）布局 (CSS)

> ID：574317
> 
> 赞同：10
> 
> 时间：2009-02-22T04:11:42.510
> 
> 标签：css, xhtml

我想知道是否有任何简单的例子可以做到以下几点

```
    * 带有流体中心的左右固定柱。
      具有完整的高度和宽度以及页眉和页脚。
    * 一个带有流体含量列的左侧固定列 2。
      具有完整的高度和宽度以及页眉和页脚。
    * 一个带有流动内容列的右固定列。
      具有完整的高度和宽度以及页眉和页脚。

```

我尝试了一些方法（例如 listapart 中列出的方法），但它们看起来非常复杂，并且使用了很多 div，或者它们只是不支持填充。

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-22T04:19:36.670

看看这个网站：

[http://matthewjamestaylor.com/blog/perfect-stacked-columns.htm](http://matthewjamestaylor.com/blog/perfect-stacked-columns.htm)

上述其他布局示例：http:
[//matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm](http://matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm)
[http://matthewjamestaylor.com/blog/perfect-2-column-right-menu.htm](http://matthewjamestaylor.com/blog/perfect-2-column-right-menu.htm)
[http ://matthewjamestaylor.com/blog/perfect-3-column.htm](http://matthewjamestaylor.com/blog/perfect-3-column.htm)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-23T15:01:42.173

我知道这样做是错误的，而且我是一个彻头彻尾的语义编码器（这不是押韵），但我仍然使用单个布局表来做列。

为什么？它具有互操作性且简单。它不需要荒谬的 CSS hack，只是*勉强*将事物组合在一起（说真的，浮动是用于排版，*而不是*布局）。它在当前使用的每个浏览器中都以相同的方式显示。它。只是。作品。这是一种语义黑客，但有时你只需要做你必须做的事情。

然而，地平线上有曙光。CSS 的 table-* 显示值使等高列变得微不足道，尽管它们仍然可能违反源顺序（您仍然需要最左边的列位于中心列之前，即使它是导航部分并且应该接近结尾您的页面代码）。IE8 和所有非 IE 浏览器已经支持这些。

CSS3 Grids 和 CSS3 Template Layout 都可以很好地解决这个问题，但距离可用还有很长的路要走。但是，编码员可以做梦，对吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-24T10:59:24.070

您在 alistapart.com 中找到的示例非常复杂，而且您可以找到的关于这些布局的每个重要示例都支持填充。您会在互联网上找到（并且已经找到）很多关于它的好例子，只需花一些时间尝试理解它们，最终您会发现它们并没有那么复杂。

无论如何，我有一个很好的演示布局，类似于您正在寻找的第二个，这里： [http ://www.meiaweb.com/test/BMS_DM_NI/](http://www.meiaweb.com/test/BMS_DM_NI/)

基本上，html是这样的：

```
<body>
        <div id="head">
            <h1>Title</h1>
        </div>
        <div id="main">
            <div id="navigation">

               <!-- navigation content -->

            </div>

            <div id="content">
                <h2>Content Title</h2>
                <p>
                   <!-- main content here -->
                </p>
            </div>
        </div>
    </body> 
```

而CSS是：

```
html {
    overflow: auto;
    height: 100%;
}
body {
    margin: 0;
    padding: 0;
    font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
    width: 100%;
    height: 100%;
    line-height: 1.5em;
}

#head {
    height: 20px;
    background-color: #666;
    color: #AAA;
    padding: 20px 20px;
}

#navigation {
    width: 210px;
    padding: 20px 20px;
    background: #efefef;
    border: none;
    border-right: solid 1px #AAA;
    float: left;
    overflow: auto;
}

#content {
    margin-left: 250px;
    padding: 20px 20px;
} 
```

我认为它很简单，并且适用于所有现代浏览器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-22T04:35:58.223

您还可以查看[Layout Gala](http://blog.html.it/layoutgala/) - 40 个不同的 2% 和 3% 以及固定大小的列布局示例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-18T08:42:22.587

我已经修改了我的示例模板，因此您可以看到您请求的所有三种格式的实际效果。

这是一个 CSS 解决方案，不涉及表格。我已经设置好了，所以侧栏的宽度是固定的，页眉/页脚的高度是固定的。其他一切都是流动的。

对于所有现代浏览器，除了 IE7，内容都是垂直和水平居中的。IE7 的盒子模型存在问题。我相信 IE8 已经解决了这些问题。

中心框在 IE7 中垂直居中，因为我在中心 div 中嵌套了一个 1 单元格表作为 IE7 框模型问题的破解。我知道这是愚蠢和丑陋的，但这只是为了表明它有效。

实际操作 -[三列全屏布局](http://sontag.ca/TheChallenge/Three%20Column%20Full%20Screen%20Layout.html)

我有点惊讶这个答案没有获得一票或获得赏金。它可以工作，很简单，并且可以满足 OP 所要求的一切。那好吧。

## CSS

```
DIV { text-align: center }
#h0, #f0 { float: left; clear: both }
#h1, #f1 { height: 100px; float: none; width: 800px } 
#l0 { float: left; clear: left; }
#c0, #r0 { float: left; clear: none }
#l1, #r1 { width: 150px }
#c1 { width: 500px }
#l1, #r1, #c1 { height: 350px }
#h0, #f0 { background-color: orange }
#l0 { background-color: red }
#r0 { background-color: blue }
#c0 { background-color: yellow }

#h1, #f1, #l1, #r1, #c1
{ display: table-cell; vertical-align: middle; } 
```

## 的HTML

```
<div id="h0"><div id="h1">
  header
</div></div>

<div id="l0"><div id="l1">
  left column
</div></div>

<div id="c0"><div id="c1">
  <img alt="dilbert (3K)" src="../gif/dilbert.gif" height="82" width="80" />
</div></div>

<div id="r0"><div id="r1">
  right column
</div></div>

<div id="f0"><div id="f1">
  footer
</div></div> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-22T04:37:18.000

[http://www.alistapart.com/articles/holygrail](http://www.alistapart.com/articles/holygrail)

这应该正是您所需要的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-22T06:01:51.543

看看 Yahoo 的[YUI：Grids builder](https://yuilibrary.com/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-22T19:28:31.120

我发现[Floatutorial 的 Liquid 两列布局在](http://css.maxdesign.com.au/floatutorial/tutorial0801.htm)设置全高两列布局时非常有用 - 固定左列和可拉伸的右列，并带有标题行和脚行引导。在他们的示例中，他们建议将左列用作导航，但它可以是任何东西。

使用 Floatutorial，您不仅可以从中获得示例 HTML 结构和 CSS，而且当您完成后，您就会明白*为什么*会得到最终结果。

我按照@JohannesH 的建议简单地尝试了 YUI: Grids builder，并且遇到了一些小问题，但最糟糕的问题是它太复杂了，我不知道它为什么不工作，或者为什么它应该完成了。

**编辑：**还有[一个关于液体三列布局的教程](http://css.maxdesign.com.au/floatutorial/tutorial0901.htm)（我没有使用过），还有一大堆[使用 floats 的其他教程](http://css.maxdesign.com.au/floatutorial/index.htm)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-18T19:45:08.327

为了回应来自原始海报的消息，这是我如何使用 <table> 执行第一个请求（其他是微不足道的修改）：

```
<style>
body {
    height: 100%;
}

#container {
    height: 100%;
    width: 100%;
    border-collapse: collapse;
}

#top, #left, #center, #right, #bottom {
    border: 1px solid black;
    text-align: center;
    vertical-align: center;
}

#left, #right {
    width: 200px;
}

#top, #bottom {
    height: 200px;
}
</style>

<table id="container">
    <tr>
        <td colspan=3 id="top">header</td>
    </tr>
    <tr>
        <td id="left">left</td>
        <td id="center">center</td>
        <td id="right">right</td>
    </tr>
    <tr>
        <td colspan=3 id="bottom">footer</td>
    </tr>
</table>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-21T01:35:08.150

有一个基于黄金法则的预制 css 网格系统，并且很容易实现所有类型的列格式。查看[960 网格系统](http://www.960.gs)。您可以在不使用表格的情况下完成您的目标。通过使用纯 CSS 解决方案，您可以更快地更改布局，这是一件好事。

还有一个[jQuery 流体实现](http://www.mostinspired.com/blog/wp-content/uploads/2009/rip/16_fluid_jquery/)，它具有您可能感兴趣的流体布局。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-23T14:48:55.463

这应该有你需要的一切：

[http://maxdesign.com.au/presentation/page_layouts/](http://maxdesign.com.au/presentation/page_layouts/)

以及针对所有 CSS 问题的更通用的解决方案：

[http://www.blueprintcss.org/](http://www.blueprintcss.org/)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-10-09T15:19:49.163

您应该查看 Elastic CSS 框架：

[http://elasticss.com/two-columns-based-layout/](http://elasticss.com/two-columns-based-layout/)

干杯。

# php - 让 CodeIgniter HelloWorld 示例工作

> ID：574334
> 
> 赞同：5
> 
> 时间：2009-02-22T04:28:40.300
> 
> 标签：php, codeigniter

伙计们，我是编码点火器的新手。我不明白如何使用这个框架。它只是打开用户指南。谁能告诉我在代码点火器上执行“hello world”程序需要遵循的步骤？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-22T04:49:46.847

`hello.php`在您的系统/应用程序/控制器文件夹中创建一个文件。在文件中，输入以下代码：

```
<?php
class Hello extends Controller
{
   function index()
   {
     echo 'Hello world!';
   }
}
?> 
```

然后转到`http://localhost/codeigniter/index.php/hello`，您应该会看到 hello world。（您可能将其放在与 codeigniter 不同的目录中，因此请根据需要更改 url）。

然后您可以将代码更改为：

```
<?php
class Hello extends Controller
{
   function index()
   {
     echo 'Hello world!';
   }

   function test()
   {
      echo 'Second hello world!';
   }
}
?> 
```

并会`http://localhost/codeigniter/index.php/hello/test`从类中运行“测试”功能。

使用 .htaccess 和 mod_rewrite 你可以从你的 url 中删除 'index.php'，所以你只会访问`http://localhost/codeigniter/hello`or `http://localhost/codeigniter/hello/test`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T07:33:54.753

不要将代码点火器与 IDE 混淆。

代码点火器是一个框架，而不是一个集成开发环境（IDE）。IDE 的一个示例是 ECLIPSe。IDE 将有一个文本编辑器，mabee 一些语法突出显示/错误检查/甚至编译功能..

另一方面，框架是一组函数/类/脚本，其中包含您可以重用的代码，以使您的生活更简单，或给它秩序。

因此，假设您已经下载了代码点火器并将其放在您的网络服务器上，您可以使用以前的用户说明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T17:14:00.280

我的建议是观看/收听此处提供的视频教程：http: [//codeigniter.com/tutorials/](http://codeigniter.com/tutorials/)和[http://video.derekallard.com/](http://video.derekallard.com/)并做笔记。应该向您展示 codeigniter 的工作原理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-25T06:56:27.807

```
<html>

<head>
<title>Codeigniter</title>
</head>

<body>

<?php

include "index.php";

class hello extends CI_Controller
{
   function index()
   {
     echo "Hello world!";
   }
}

echo "head<br>";
$t = new hello();
$t->index();
?>

</body>
</html> 
```

# perl - 有谁知道一个好的 Perl 单元测试生成器？

> ID：574337
> 
> 赞同：1
> 
> 时间：2009-02-22T04:30:44.600
> 
> 标签：perl, unit-testing, automated-tests

有谁知道一个好的 Perl 单元测试生成器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-22T04:38:24.677

不确定您要问什么，但大多数人使用 [Test::More](http://search.cpan.org/perldoc?Test::More)或 [Test::Class](http://search.cpan.org/perldoc?Test::Class)编写测试。`prove`然后使用 Perl 中包含的命令（实际上是使用 Test::Harness）运行这些测试。

示例测试：

```
# foo.t
use strict;
use warnings;
use Test::More tests => 1;

ok( 1 == 1, 'is one one?' ); 
```

运行这个：

```
$ prove foo.t

foo....ok
All tests successful.
Files=1, Tests=1,  0 wallclock secs ( 0.01 usr  0.01 sys +  0.03 cusr  0.00 csys =  0.05 CPU)
Result: PASS 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T04:36:50.513

**编辑：（**感谢评论者）

我最初对 PerlUnit 的建议已被弃用。请改用[Test::Class](http://search.cpan.org/perldoc?Test::Class)。

*原帖：*

你可以试试[PerlUnit](http://perlunit.sourceforge.net/)。Perl 中还有一本关于单元测试的书籍章节：[Extreme Perl: Chapter 13: Unit Testing](http://www.extremeperl.org/bk/unit-testing)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-22T11:05:19.690

如果您要测试 Web 应用程序，[Selenium IDE](http://seleniumhq.com "硒 IDE")允许您在 firefox 中执行操作并自动将其记录为一组等效的 Perl（或其他语言）测试。

虽然它不能测试所有内容，但它对于测试用户体验很有用。

# javascript - JQuery：查找创建 DOM 元素的对象

> ID：574339
> 
> 赞同：0
> 
> 时间：2009-02-22T04:31:59.417
> 
> 标签：javascript, jquery, dom

所以我整天都在做这个，我不知道如何让它工作。我有一张 TD 的表格，里面充满了使用 JQuery“getJSON”命令从数据库中提取的内容。我设置了一个事件处理程序，这样当您双击一个 TD 元素时，它的内容就会变成一个 INPUT 元素，其中包含 TD 先前内容的默认值。

INPUT 元素是在名为“Input”的 Javascript 对象中创建的，如下所示：

```
var Input = function() {
    var obj = this;
    obj.docElement = $('<input/>').attr('type', 'text').val(obj.defaultValue);
} 
```

到目前为止，所有这些都有效。我的问题是，我希望用户能够在选择 INPUT 时按下 RETURN 键以表示他们已经完成了该字段的编辑。我尝试过类似以下的方法：

```
$(obj.docElement).bind('keydown', function(e) {
    if(e.which == 13) {
        // do something
    }
} 
```

这适用于您第一次编辑字段；但是，如果您多次编辑一个字段，它将停止工作。此外，如果您随机双击 TD，它最终会中断。我对其进行了测试并确定 INPUT 元素停止注册任何类型事件，就好像“绑定”不再存在一样。

我做了很多谷歌搜索，并确定放置在 INPUT 元素上的常规 JQuery“绑定”处理程序是不可靠的。因此，我决定将事件处理程序附加到文档对象，而不是使用以下内容：

```
$(document).bind('keydown', function(e) {
    // do something
} 
```

我知道我可以使用“e.target”来获取执行操作的目标元素（这对我有用，e.target 正确地引用了 INPUT 元素）。

我的问题是，我如何首先获得创建 INPUT 元素的对象？我需要能够执行包含在用于创建 INPUT 元素的相应“输入”类中的函数。我需要从“$(document).bind”函数中调用这些函数。所以基本上我需要能够获得 INPUT 元素的父/创建者 Input 对象。

如果我没有足够清楚地解释任何事情，请告诉我。在这件事上的任何帮助将不胜感激！我也愿意接受有关替代方法的建议（除了使用“$（document）.bind”）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T04:42:56.507

我想我明白这个问题...

您可以遍历 DOM 以找到父文档元素，但这不是您的意思，对吧？您希望父脚本元素具有一堆对元素进行操作的逻辑。

我怀疑在创建输入元素时提供对父级的某种引用可能是最简单的......将其传递给事件处理程序，或将其设置在全局可访问的位置（如 current_element_parent var）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T04:50:17.893

我同意tobyhede。您可以将自定义属性添加到 INPUT 元素以返回到父元素，或者在内存中保留一个映射，将动态创建的 INPUT 元素映射到创建它的父元素。当您捕获 Return 键时，只需从地图中删除关系，以便在用户再次单击它时可以再次添加它。

# apache-flex - 使用 Flex ViewStack 重新创建/重置视图

> ID：574344
> 
> 赞同：1
> 
> 时间：2009-02-22T04:35:53.230
> 
> 标签：apache-flex, flash, air

我正在为不同的应用程序状态编写一个使用 ViewStack 的 Adob​​e AIR 应用程序。有没有办法确保每个视图组件在每次显示/隐藏时都被创建/销毁？

例如，如果我在一个视图中有一个 TextInput，我希望它在每次更改到该视图时重置为其初始状态，而不是之前输入的文本。或者，如果我有一个计时器，我希望它在我离开视图时被销毁，这样当我在应用程序的不相关部分时它就不会继续运行。我知道我可以手动初始化/销毁 show() 和 hide() 事件中的所有内容，但是有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T09:34:52.980

AFAIK没有内置的方法可以做到这一点，所以你必须通过处理你提到的显示和隐藏事件来手动完成。

然而，ViewStack 确实有两种方法“ [saveState](http://livedocs.adobe.com/flex/3/langref/mx/containers/ViewStack.html#saveState()) ”和“ [loadState](http://livedocs.adobe.com/flex/3/langref/mx/containers/ViewStack.html#loadState()) ”，它们或许可以帮助您解决这个问题。历史管理器使用这些方法来启用后退/前进导航。不过，文档似乎没有任何示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T18:36:16.673

在创建/删除策略和管理状态方面，ViewStacks 可能是魔鬼的工作。当我们开发法定的 ecoDrive 时，我们遇到了各种各样的问题，大约 3/4 的时候，尽管我们都非常反对 ViewStacks 来管理我们应用程序中的视图状态。

但是... 一个不错的选择是首先将 creationPolicy 设置为 ContainerCreationPolicy.NONE。这样，您可以控制何时在 ViewStack 中创建任何面板。然后我认为您需要某种逻辑，以便当 ViewStack 更改面板时，它会删除或重置您所在的面板。

另一种可行的替代方法是使用视图状态。有一个作为主容器的基本状态，然后是每个部分的简单状态。这样，当您切换到新状态时，旧状态会以与其创建方式相反的顺序被删除。你必须对状态进行自律，因为当它们开始嵌套时，它们最终会变得非常复杂和混乱。如果您保持简单，它可能会按您的需要工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-18T21:55:35.507

在 MXML 2009 中，您可以使用 itemDestructionPolicy="auto" 在使用后销毁组件。如果在具有两种状态（init、logged）的第一个视图组件中使用此属性，则可以销毁并重新初始化所有子视图组件。例子 ：

```
 <s:states>
    <s:State name="init" />
    <s:State name="logged" />
  </s:states>

  <s:SkinnableContainer id="skincon" width="100%" height="100%" backgroundAlpha="0"
                        backgroundColor="#FFFFFF">
    <s:VGroup id="MainContainer" width="100%" height="100%" paddingTop="0"
              paddingLeft="20" paddingRight="20" gap="0">
      <views:_HeaderView id="header" />
      <mx:ViewStack id="viewStack" width="100%" height="100%">
        <s:NavigatorContent includeIn="init" itemDestructionPolicy="auto">
          <s:layout>
            <s:VerticalLayout horizontalAlign="center" verticalAlign="middle" />
          </s:layout>
          <views:LoginView title="Login" id="loginView" />
        </s:NavigatorContent>
        <s:NavigatorContent includeIn="logged" itemDestructionPolicy="auto">
          <s:layout>
            <s:VerticalLayout horizontalAlign="center" verticalAlign="top" />
          </s:layout>
          <views:_CentralView id="userView" />
        </s:NavigatorContent>
      </mx:ViewStack>
      <views:_FooterView id="footer" />

    </s:VGroup>
  </s:SkinnableContainer> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T15:52:04.417

两个答案都是正确的——似乎没有任何内置的方法可以做到这一点。我通过为我的视图组件创建一个“包装器”组件解决了这个问题。每次显示视图时，它都会创建一个新的视图组件。这并不理想，但很好地满足了我的要求，并且需要对我的应用程序结构进行少量更改。

```
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" show="init()" hide="cleanup()">
    <mx:Script>
        <![CDATA[
            private var myComponent:MyComponent;

            private function init():void
            {
                myComponent = new MyComponent();
                componentContainer.addChild(myComponent);   
            }

            private function cleanup():void
            {
                componentContainer.removeAllChildren(); 
            }
        ]]>
    </mx:Script>

    <mx:Canvas width="100%" height="100%" id="componentContainer" />
</mx:Canvas> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T17:37:22.260

将您的“视图”构建为单独的模块，然后使用 ViewStack 在它们之间切换。然后，您可以编写一个函数来在触发 ViewStack 的“更改”事件时销毁未使用的模块（根据 selectedChild 属性检查每个模块）。

2美分

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T17:29:20.737

我为我的不同观点使用不同的状态。在每次状态更改时，我都会添加和删除组件。

这会导致火灾`add`和`remove`事件，`UIComponent`这使我可以在每次添加组件时初始化和清理组件。

就是这个想法...

```
 <mx:states>
      <mx:State name="state1">
         <mx:AddChild>
            <mx:SomeUIComponent id="myComp" add="myComp.initialize()" remove="myComp.cleanup()"/>
         </mx:AddChild>
      </mx:State>
   </mx:states> 
```

# java - 无法正确设置类路径

> ID：574351
> 
> 赞同：0
> 
> 时间：2009-02-22T04:37:23.400
> 
> 标签：java, jar, classpath

我正在尝试编译[这个](http://thejavablog.wordpress.com/2008/06/08/using-slick-2d-to-write-a-game/)slick2d 示例（第一个），但我无法让它工作。这是代码：

```
import org.newdawn.slick.AppGameContainer;
import org.newdawn.slick.BasicGame;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.SlickException;
/**
 * @author panos
 */
public class WizardGame extends BasicGame
{
    public WizardGame()
    {
        super("Wizard game");
    }

    public static void main(String[] arguments)
    {
        try
        {
            AppGameContainer app = new AppGameContainer(new WizardGame());
            app.setDisplayMode(500, 400, false);
            app.start();
        }
        catch (SlickException e)
        {
            e.printStackTrace();
        }
    }

    @Override
    public void init(GameContainer container) throws SlickException
    {
    }

    @Override
    public void update(GameContainer container, int delta) throws SlickException
    {
    }

    public void render(GameContainer container, Graphics g) throws SlickException
    {
    }
} 
```

我已按照指示将 lwjgl.jar、slick.jar 和 ibxm.jar 放入目录中。然后我尝试了：

javac -classpath .; *完整路径*\slick.jar.; *完整路径*\lwjgl.jar; *完整路径*\ibxm.jar

然后

java精灵游戏

但是我收到未定义 jar 类的错误，这意味着当我设置类路径时一定有问题。我不确定我做错了什么。

我也试过

javac -classpath .;.\slick.jar.;.\lwjgl.jar;.\ibxm.jar

无论哪种方式，如果 .jar 文件与源代码位于同一目录中，jvm 不应该自行查找它们吗？就我而言，我已经在 WizardGame.java 的同一目录中设置了 3 个 jar。如果我尝试在没有 -classpath 参数的情况下进行编译，则它不起作用。

编辑：我按照指示做了，但现在它告诉我“java.library.path 中没有 lwjgl”

我用winrar检查了我的lwjgl.jar，发现它包含两个文件夹：meta-inf和org，然后在org里面有lwjgl。应该是这样吗？因为如果是的话，我不知道出了什么问题。

编辑2：用你所说的创建清单，然后使用：

jar cfm test.jar manifest.txt

这创建了一个 jar 文件，然后我使用

java -jar test.jar

然后它告诉我它没有找到 WizardGame 类的定义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T04:40:05.687

您还必须将***-classpath***选项添加到***java***命令。不仅对编译器。

喜欢：

```
javac -classpath .;lib\myjar.jar MyClass.java 
```

接着

```
java -classpath .;lib\myjar.jar MyClass 
```

否则解释器 ( java ) 将不知道在哪里可以找到所需的类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T04:48:03.060

Oscar 大获成功 - 您也需要 java 命令上的 -classpath。

您可以查看的另一件事（对于您现在正在做的事情来说有点过分了，但您仍然应该为了体验而这样做）是创建一个 JAR 文件。在 JAR 文件中，您可以提供一个 manifest.mf 文件，该文件告诉 java 命令在哪里可以找到其他 JAR 文件以及主类是什么。

然后，您将通过“java -jar foo.jar”运行您的程序

*   http://java.sun.com/docs/books/tutorial/deployment/jar/manifestindex.html
*   http://java.sun.com/docs/books/tutorial/deployment/jar/appman.html
*   http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html

我相信下面的 manifest.m 文件会做你想做的事（注意你必须在最后有一个空行，否则它将不起作用）：

```
主类：WizardGame
类路径：slick.jar lwjgl.jar ibxm.jar

```

这假定所有 JAR 文件（foo.jar 和其他三个）都在同一个目录中。

# c - C 预处理器 - 用于家庭作业

> ID：574362
> 
> 赞同：-1
> 
> 时间：2009-02-22T04:49:15.757
> 
> 标签：c, preprocessor

任务：

> 您需要实现 C 预处理器。预处理器将作为命令行工具实现，其输入是 C 源文件（.c 扩展名），输出是预处理文件（.i 扩展名）。该工具也有几个选项。
> 
> `$ cppr <options> file.c`
> 
> 成功处理后，将生成文件 .i。
> 
> <选项> 可能是：
> 
> 预处理器选项
> - -Aassertion -C -dD -dM -dN -Dmacro[=defn] -E -H
> -idirafter dir -include 文件 -imacros 文件
> -iprefixfile -iwithprefix dir -M -MD -MM -MMD
> -nostdinc –P - Umacro –undef
> 目录选项
> --Bprefix -Idir -I-
> 
> 实现以上任意两项。这必须在需求阶段确定。
> 
> 这些是 GCC 编译器定义的选项。请参阅 GCC 的手册页以了解这些选项。
> 
> 您必须至少实现以下功能：
> 
> 1.  剥离评论
>     
> 2.  `#ifdef`和`#endif`
>     
> 3.  `#define`对于常量（不是宏）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T09:22:50.617

不知道你到底不明白什么并不容易回答，但无论如何我都会尝试，使用我非常有限的 C 经验。

**什么是预处理器？** 预处理器是在代码文件被编译之前对其进行某种处理的程序。例如，您可以使用预处理器指令定义符号常量：

```
#define PI 3.14159 
```

然后，您可以在代码中将此值与有意义的名称一起使用：

```
area = r * r * PI;
...
circumference = 2 * r * PI; 
```

预处理器在这里所​​做的是将所有出现的 PI 替换为您指定的数值：

```
area = r * r * 3.14159;
...
circumference = 2 * r * 3.14159; 
```

您还可以根据是否已在代码中的其他位置定义常量来包含代码（这通常用于具有多个文件的项目中）：

```
#define WINDOWS

...

#ifdef WINDOWS
    /* do Windows-specific stuff here */
#endif 
```

只有在之前定义了常量时，才会包含`#ifdef`和之间的行。`#endif``WINDOWS`

我希望现在你对你的程序应该做什么有了一些想法。

**实现“最小功能”的提示**

在这里，我将为您提供一些关于如何编写教授所需的最低功能的想法。这些只是我的想法，所以请先考虑一下。

*剥离评论*

在阅读输入时，寻找“ `/*`”。当你遇到它时，停止写入输出，然后当你找到“ `*/`”时，你可以重新开始写入。使用布尔标志来指示您是否在注释中（AFAIK，C 中没有 bool 类型，因此请使用带有 0 或 1 的 int，或者更理想的是使用两个符号常量，如`INSIDE_COMMENT`和`OUTSIDE_COMMENT`）。

*#define 用于常量（不是宏）*

如果你遇到任何以#开头的行，显然你不应该把它写出来。如果找到`#define`指令，请将符号名称和值存储在某处（两个字符串），然后在输入中查找名称，并在每次找到时写出值。您可以为常量名称设置最大长度，我认为这是 C 中的 6 个字符，并且始终从输入中检查 6 个字符。如果这 6 个字符*以已知常量名称开头，*则改为写出该值。

*#ifdef 和 #endif*

创建一个布尔标志来指示您是否在 内部`#ifdef`，就像注释一样。查找时`#ifdef`，检查您是否已经存储了常量名称，并根据该名称写入输出。

我希望这有帮助。

**编辑：**还阅读 gs 的评论！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T04:56:10.453

您的 C 教科书应该描述标准 C 预处理器的功能，但您也可以尝试[`man cpp`](http://unixhelp.ed.ac.uk/CGI/man-cgi?cpp).

然后编写一个程序来执行这些任务的有限子集（即进程`#ifdef`/`#endif`对和简单`#define`的s）。

你的程序应该解析它的命令行，至少接受上面列出的两个选项，并按照`gcc`手册页中解释的方式处理它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T04:56:31.980

这是[有关预处理器选项的 gcc 文档](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Preprocessor-Options.html#Preprocessor-Options)，可能对您有所帮助。它相当长，但其中大部分涉及您不需要打扰的选项，因此您可以浏览并挑选相关部分。

# asp.net-mvc - 将序列化的 JQuery 可排序结果提交到数据库的最佳方法是什么？

> ID：574364
> 
> 赞同：3
> 
> 时间：2009-02-22T04:49:49.283
> 
> 标签：asp.net-mvc, linq-to-sql, jquery-ui

我正在使用 JQuery.Sortable() 函数来创建一个可重新排序的项目列表，如下所示

```
 <script type="text/javascript">
    // When the document is ready set up our sortable with it's inherant function(s)
    $(document).ready(function() {
        $("#goal-list").sortable({
            handle: '.handle',
            placeholder: 'ui-state-highlight',
            update: function() {
                var order = $('#goal-list').sortable('serialize');
                $("#info").load("/goals/process?" + order);
            }
        });
    });
</script> 
```

返回的结果是项目 ID 的逗号分隔列表（即 1、2、3、4、5、6 等）

我想知道将其提交到相关项目表的排序列的最佳方式是什么......我可以循环并更新每条记录，但我认为这是大量的数据库写入，可能会造成潜在的瓶颈特别是如果列表相当大。

我正在使用 LINQ-to-SQL 和 ASP.NET MVC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T07:04:56.993

如果您正在使用 LINQ to SQL，我建议您更多地研究延迟执行。这可能是一个常见的陷阱。尤其是在使用关联时。

多个插入和更新实际上可以组合在一起。在数据库上下文中调用 SaveChanges 或 SubmitChanges 之前，它们不会被写入数据库。

如果你遍历一组项目并修改它们..然后在退出循环后调用 SaveChanges ，这组更新语句应该一起批处理并一次发送到数据库..

# php - Apache/PHP 在短时间（12 秒）后关闭连接

> ID：574367
> 
> 赞同：0
> 
> 时间：2009-02-22T04:51:13.193
> 
> 标签：php, apache, apache2

我遇到了一个特殊的问题。Apache 在 12 秒左右后关闭连接。这会导致浏览器上出现“对等连接重置”消息。

我在 Linux Centos 5 上。使用 apache2/php5.x/mod_gzip。（带有 eAccelerator 的 php）

我测试了一些变化：

*   通常，我会在最后一步打印所有 HTML 输出。当处理时间超过 12 秒时，它总是关闭连接。
*   如果打印速度更快（< 12 秒），则连接不会关闭，我会在浏览器上看到页面。
*   如果我定期（每隔一秒左右）打印一些东西，即使处理时间超过 12 秒，连接也不会关闭。

这里可能存在什么问题？有关解决此问题的任何建议？

编辑 - 更多细节：

*   apache access-log 显示状态码为 200。
*   TimeOut 指令已设置。超时值设置为 60。
*   php.ini：max_execution_time 设置为 30 秒。
*   客户端和服务器在不同的机器上。它是直接连接（ Edit2~~之间没有代理~~：ISP 通过其代理路由所有请求。）。
*   Apache 是独立的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T04:57:42.023

在软件方面，

*   登录什么状态码`access.log`？
*   您（或在任何其他可能包含的文件中）是否有[Timeout 指令](http://httpd.apache.org/docs/2.0/mod/core.html#timeout)？`httpd.conf``httpd.conf`
*   [`max_execution_time`](http://us.php.net/set_time_limit)在 php.ini中配置了什么？
*   您的 Apache 是用作反向代理，还是独立使用？

在网络侧，

*   服务器和您的客户端（浏览器 PC）是否在同一台机器上，或者中间是否有代理、防火墙或路由器？

# svn - 即使是小型项目，您也应该有分支、标签和主干文件夹吗？

> ID：574368
> 
> 赞同：7
> 
> 时间：2009-02-22T04:51:24.397
> 
> 标签：svn

我在 SVN 中混合了小型和大型项目。其中一些太小了，我无法预见自己会分支或标记。

那么，即使我相当确定分支/标签目录将不会用于较小的项目，我是否仍应坚持使用 trunk/branch/tag 文件夹约定？我只是觉得这可能是矫枉过正。

对此有什么想法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-22T04:59:04.173

直接回答标题中的问题：不，您不必这样做。SVN 存储库可以按照您选择的任何文件夹结构进行组织。

话虽这么说，现在至少将所有内容放在主干文件夹中可能是个好主意，这样如果以后您改变主意并决定分支或标记有用，您可以轻松添加分支/标记文件夹，而无需必须移动所有东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T04:59:45.250

即使是琐碎的项目，我也会使用 Subversion 中的分支/标签/主干目录。这几乎是零成本，并且在一致性方面是值得的。如果我需要结帐，我总是知道我的项目将如何布局。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T04:59:31.600

它们是约定俗成的，所以添加它们有什么害处。如果您的项目达到了您需要它们的地步，那么从一开始就将它们放置到位要比事后尝试添加它们要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T05:42:29.093

在我的 SVN 存储库中，我有一个主干/分支/标记目录。我将所有项目放在主干中，并根据实际达到可标记状态的项目分别组织我的分支和标记目录。约定可能建议为每个项目使用一个分支/标签/主干目录，但是如果您不希望进行标记和分支，这可能是不切实际的。

即使是个人项目也可以受益于在重大重写之前或长时间中断之后不频繁的标记和分支。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T05:45:59.053

通常（或很明显），分支/标记在团队中非常有用，其中许多编码人员将同时使用源代码。每个编码员都在自己的分支中工作，因此没有节省其他人工作的风险。

作为一名单兵开发人员，我仍然发现分支/标记在以下情况下很有用：

1.  我需要在不放弃当前工作源的情况下创建一个实验分支。如果实验代码证明更好，我会将其合并回来。

2.  如果我有几个单独的组件，用表示项目版本号的名称标记每个组件并将它们放在以项目命名的标记文件夹中可能会很有用。当您想要返回到版本 1.0.5.10 并且需要知道组件 Foo 中发生了什么变化时，这有助于密切关注。提交说明可能信息不足。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T06:16:03.270

根据我的经验，“主干/分支/标签”组织是一种非常常用的源代码控制布局。我已经看到它在许多不同的组织中使用不同的工具（ClearCase、SVN、CVS 等等）实现。我目前使用的 ClearCase 设置稍微复杂一些（复杂？），但一般来说，遵循非常相似的布局。

虽然在 SVN 中不需要，但我强烈建议您习惯这种类型的布局，包括合并到/来自不同的分支和主干。

对于个人项目，我发现标记是保存最终、不可变版本的一种有价值的方法。分支通常保留用于实验切线，因此我不会在现实开始之前破坏我的代码的最新（稳定）版本。

# c# - MVC Web 框架和 Mono

> ID：574381
> 
> 赞同：3
> 
> 时间：2009-02-22T04:59:34.047
> 
> 标签：c#, .net, mono

我在一家商店工作，那里有许多非常优秀的 C# 开发人员，他们一直在使用 ASP.NET WebForms，并希望迁移到 MVC 框架。为了让事情变得更复杂，我们还希望能够在单声道下运行它。

所以我的问题是，是否有任何好的单声道 MVC 框架，已经在现实世界中经过尝试和测试，或者我们是否更好地使用 Windows Server 和 IIS？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T05:17:00.607

我在 Mono 2.0 中使用过[Castle Monorail](http://www.castleproject.org/MonoRail/)，没有遇到任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T05:08:10.500

我很确定您可以在单声道下使用 Ironpython 运行 django。我从未尝试过，但也许你应该检查一下。

抱歉，如果您提到了 Django 不是 C#，这对您没有帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T21:34:33.670

看看[http://netfluid.org/](http://netfluid.org/)这是一个新的有趣的 .net Web 服务器，它适用于单声道

# javascript - jQuery中无尽的背景色动画，如何？

> ID：574392
> 
> 赞同：3
> 
> 时间：2009-02-22T05:11:19.340
> 
> 标签：javascript, jquery, loops, jquery-animate

我正在处理一个网络表单，我希望（在表单提交后）突出显示那些未正确输入的输入字段。

`background-color: #fcc`我希望创建的高光效果是在;之间无限循环的动画。和`#fff`; 在错误的输入字段中，使用 jQuery。当其中一个领域获得焦点时，我希望停止该领域的动画。

我在 jQuery 和 JS 方面相当与众不同，所以如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-22T06:20:58.907

看看这两个 jQuery 插件：

**脉冲**：http: [//james.padolsey.com/javascript/simple-pulse-plugin-for-jquery/](http://james.padolsey.com/javascript/simple-pulse-plugin-for-jquery/)

**寻求注意**：[http](http://enhance.qd-creative.co.uk/demo/seekAttention/) ://enhance.qd-creative.co.uk/demo/seekAttention/ （链接现已失效）

我认为 Pulse 是您所要求的，但 Seek Attention 在某些情况下也很有用。

这是我使用脉冲插件创建的一个非常*基本的示例。*

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js" type="text/javascript"></script>
<script src="http://enhance.qd-creative.co.uk/demos/pulse/pulse.jquery.js" type="text/javascript"></script>

<script type="text/javascript">
    function doSomething() {
        if ($('.BadTextBox').val() == "") {
            $('.BadTextBox').pulse({ backgroundColors: ['#fcc', '#fff'] });
        }
        else {
            $('.BadTextBox').css({'background-color': '#fff'}).stop();
        }

    }
</script>

<input type="text" class="BadTextBox" onblur="doSomething();" /> 
```

当用户离开文本框时，如果为空，它会开始跳动。如果他们回去填写，它就会停止跳动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T03:57:21.010

我做了类似的事情

首先创建javascript函数变量

```
var PulsePut = function (){

    if ($(this).val() == "") {
        $(this).pulse({ backgroundColors: ['#ffffee', '#fff'] });
    }
    else {
        $(this).css({'background-color': '#fff'}).stop();
    } } 
```

然后在输入中添加一个类

```
<input type="text" class="PulsePut" /> 
```

最后，初始化函数

```
$(document).ready(function(){

$('.PulsePut').blur(PulsePut); } 
```

如果为空，这将使您对 .PulsePut 类的任何输入产生脉冲。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T05:44:50.147

这是我的做法（一般步骤）：

1.  循环输入，将类“不正确”添加到这些字段
2.  循环时，切换“不正确”类的背景，睡眠时间长
3.  点击输入，删除它的“不正确”类。

如果在 while 循环中，这可能不起作用，没有其他可执行文件。在评论中发布修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-29T09:46:49.953

我会捕获 onblur 事件并触发一个函数来验证输入：

```
function matchShippingEmail() {
$('#shippingEmail').css('border',validColor);
if ($('#shippingEmail').val() == '') {
    $('#shippingEmailLabel').html('email');
    return 0;
}
if ($('#shippingEmail').val().match(RegExp('^([a-zA-Z0-9._%%-]+@+[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})'))) {
    $('#shippingEmailLabel').html('email');
    return 1;
} else {
    $('#shippingEmail').css('border',invalidColor);
    $('#shippingEmailLabel').html(email error');
    return 0;
} 
```

}

在提交表单时，我这样做了：

```
$(document).ready(function() {
$('.confirmOrder').click(function(event){
    if (!matchCardOwnerName())        {$('#cardOwnerName').css('border',invalidColor);        $('#cardOwnerName').focus();        return false;}
    if (!matchCardNumber())            {$('#cardNumber').css('border',invalidColor);            $('#cardNumber').focus();            return false;}
    if (!matchCVV2Code())             {$('#CVV2Code').css('border',invalidColor);                $('#CVV2Code').focus();                return false;}
    if (!matchCardOwnerId())        {$('#cardOwnerId').css('border',invalidColor);            $('#cardOwnerId').focus();            return false;}
    if (!matchShippingFullName())    {$('#shippingFullName').css('border',invalidColor);        $('#shippingFullName').focus();        return false;}
    if (!matchShippingAddress())    {$('#shippingAddress').css('border',invalidColor);        $('#shippingAddress').focus();        return false;}
    if (!matchShippingCity())        {$('#shippingCity').css('border',invalidColor);            $('#shippingCity').focus();            return false;}
    if (!matchShippingZipCode())    {$('#shippingZipCode').css('border',invalidColor);        $('#shippingZipCode').focus();        return false;}
    if (!matchShippingEmail())         {$('#shippingEmail').css('border',invalidColor);        $('#shippingEmail').focus();        return false;}
    if (!matchShippingPhoneNumber()){$('#shippingPhoneNumber').css('border',invalidColor);    $('#shippingPhoneNumber').focus();    return false;}
    if (!$('#agreeToTermsAndConditions').attr('checked')) {
        $('#agreeToTermsAndConditionsDiv').css('color','#FF0000');
        $('#agreeToTermsAndConditionsDiv').css('font-weight','bold');
        $('#agreeToTermsAndConditionsDiv').css('font','150%% ariel');
        return false;
    }
    $('html').css('cursor','wait');
    $('.confirmOrder').css('cursor','wait');
    $('#confirmOrderButton').attr('src','images/confirmOrderDisabled.jpg');
    $('#paymentForm').submit();
    //document.paymentForm.submit();
    $('form').get(0).setAttribute('action', '#'); //this works

    return true;
}); 
```

});

# c# - 将流保存到 asp.net 3.5 中的文件的最佳方法？

> ID：574396
> 
> 赞同：3
> 
> 时间：2009-02-22T05:18:04.113
> 
> 标签：c#, asp.net, resources, stream

我有一个 Stream 对象，其中填充了 XSD 文件的内容，作为我正在处理的项目中的嵌入式资源，如下所示：

```
using ( Stream xsdStream = assembly.GetManifestResourceStream( xsdFile ) )
{
  // Save the contents of the xsdStream here...
} 
```

在这个 using 块中，我想通过 Web 上的“保存文件”对话框提示用户，他们可以选择保存流中包含的这个 XSD 文件。

实现这一目标的最佳方法是什么？我完全迷失了，谷歌似乎无法用正确的术语来获得相关答案。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T05:28:56.770

如果您不使用 AJAX，则可以使用 Response.WriteFile。否则我会使用 MemoryStream。这就是我在[这里](http://zi255.com/?Req=Post&PID=187)做的。抱歉，它在 VB.NET 中，我没有对其进行转码。请注意，这还允许您通过网络服务器下载文件，即，如果您的文件位于没有公共访问权限的应用服务器上。

```
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.Sql
Imports System.Net
Imports System.IO

Partial Class DownloadFile
Inherits System.Web.UI.Page

Protected Sub page_load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load
Dim url As String = Request.QueryString("DownloadUrl")
If url Is Nothing Or url.Length = 0 Then Exit Sub

'Initialize the input stream
Dim req As HttpWebRequest = WebRequest.Create(url)
Dim resp As HttpWebResponse = req.GetResponse()
Dim bufferSize As Integer = 1 

'Initialize the output stream
Response.Clear()
Response.AppendHeader("Content-Disposition:", "attachment; filename=download.zip")
Response.AppendHeader("Content-Length", resp.ContentLength.ToString)
Response.ContentType = "application/download"

'Populate the output stream
Dim ByteBuffer As Byte() = New Byte(bufferSize) {}
Dim ms As MemoryStream = New MemoryStream(ByteBuffer, True)
Dim rs As Stream = req.GetResponse.GetResponseStream()
Dim bytes() As Byte = New Byte(bufferSize) {}
While rs.Read(ByteBuffer, 0, ByteBuffer.Length) > 0
Response.BinaryWrite(ms.ToArray())
Response.Flush()
End While

'Cleanup
Response.End()
ms.Close()
ms.Dispose()
rs.Dispose()
ByteBuffer = Nothing
End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T05:30:14.053

您将需要设置内容处置：

```
Response.AddHeader "Content-Disposition","attachment; filename=" & xsdFile 
```

您还需要将 Content-Type 设置为 text/plain 并将 Content-Length 设置为文件的大小。然后你写文件的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T15:24:05.437

```
private void DownloadEmbeddedResource( 
  string resourceName, Assembly resourceAssembly, string downloadFileName )
{
  using ( Stream stream = resourceAssembly.GetManifestResourceStream( resourceName ) )
  {
    if ( stream != null )
    {
      Response.Clear();
      string headerValue = string.Format( "attachment; filename={0}", downloadFileName );
      Response.AppendHeader( "Content-Disposition:", headerValue );
      Response.AppendHeader( "Content-Length", stream.Length.ToString() );
      Response.ContentType = "text/xml";

      var byteBuffer = new Byte[1];

      using ( var memoryStream = new MemoryStream( byteBuffer, true ) )
      {
        while ( stream.Read( byteBuffer, 0, byteBuffer.Length ) > 0 )
        {
          Response.BinaryWrite( memoryStream.ToArray() );
          Response.Flush();
        }
      }

      Response.End();
    }
  }
} 
```

我最终使用了上面的这种方法。感谢您在语法 tsilb 方面帮助我。JohannesH，如果资源不是来自不同的程序集，我会使用你的建议（对不起，我应该在我原来的问题中澄清这一点）。

上面的代码有效，但我遇到了一个相当奇怪的问题......方法完成并下载完成后，页面似乎仍然没有恢复活力，鼠标仍然处于沙漏模式，就像它仍然认为工作正在进行一样完毕。关于如何补救的任何想法？

再次感谢你的帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T05:29:36.223

在我看来，您应该看看 WebResource.axd 处理程序。

微软有一篇关于这个主题的优秀[文章](http://support.microsoft.com/kb/910442 "在 ASP.NET 2.0 中使用 Web 资源")。

**编辑：**

似乎 tsilb 比我的回答快了一分钟左右。但是，AssemblyResourceLoader（又名 WebResource.axd）已经实现了为您执行此操作并正确执行此操作，并且不要忘记此小狗支持输出缓存。因此，请继续使用它，以免麻烦。;)

# java - 如何在 jstack 输出中显示源代码行号？

> ID：574397
> 
> 赞同：0
> 
> 时间：2009-02-22T05:18:51.803
> 
> 标签：java, debugging, concurrency, jvm

这是来自正在运行的 JVM 的 jstack 输出

```
"FooThread" prio=10 tid=0x00007f159c2ca000 nid=0x6e21 waiting on condition ..snipped
    java.lang.Thread.State: TIMED_WAITING (sleeping) 
    at java.lang.Thread.sleep(Native Method)
    at com.myco.impl.QueueFooThread.run(Unknown Source) 
```

我希望 QueueFooThread 中的行号显示为 Catalina 进程的此帧

```
 at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1548) 
```

在编译/引导期间我应该怎么做才能启用它？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T05:23:24.210

这可能不是一个完整的答案，但通过`-g`(debugging) 选项`javac`使调试器 ( `jdb`) 能够显示源信息，包括行号。我不确定它是否适用于您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T06:12:31.703

使用调试选项编译您的源代码。例如

```
<javac target="1.5" source="1.5" classpathref="class.path" srcdir="${src}" destdir="${build}" debug="true" encoding="UTF-8"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T08:58:31.900

您需要在编译代码时启用调试。**注意**：对于库，它们必须在编译时启用调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T08:21:43.817

使用调试信息编译当然是最好的。但如果它不是你的源代码，你总是可以用 jad 之类的东西反编译。这对你的行号没有帮助，但如果你做出一些有根据的猜测，它在紧要关头仍然很有用。

# networking - 大多数现代内核是否将 DMA 用于具有通用以太网控制器的网络 IO？

> ID：574401
> 
> 赞同：1
> 
> 时间：2009-02-22T05:27:07.103
> 
> 标签：networking, io, kernel

在大多数现代操作系统（如 Linux 和 Windows）中，网络 IO 通常是使用 DMA 完成的吗？这与通用以太网控制器有关；我不是在问需要特殊驱动程序的东西（例如许多无线网卡，至少在 Linux 中是这样）。我想答案是“是”，但我对任何资源（尤其是 Linux 内核）以及提供更多一般信息的资源都感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T06:29:21.680

我不知道真的有*通用*网络接口控制器这样的东西，但我所知道的最接近的东西——由大量廉价控制器实现的[NE2000](http://wiki.osdev.org/Ne2000)接口规范——似乎至少有一些限制DMA 支持和更复杂的控制器可能包含更复杂的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T16:28:50.957

问题应该有点不同：

> 典型的网络适配器板载 dma 控制器吗？

在找到这个问题的答案后（我猜 99.9% 是肯定的），你应该询问每张卡的特定驱动程序。我假设任何体面的驱动程序都将充分利用硬件功能（即我们的例子中的 DMA 支持），但是关于操作系统的问题并不相关，因为没有操作系统可以强制驱动程序实现 DMA 支持。像 Windows 和 Linux 这样的高级操作系统提供了更容易实现 DMA 的原语，但实现是驱动程序的责任。

# .net - 系统错误 5 启动 .NET 服务时访问被拒绝

> ID：574411
> 
> 赞同：53
> 
> 时间：2009-02-22T05:37:16.797
> 
> 标签：.net, windows, visual-studio, error-handling, windows-services

当我尝试启动在 Visual Studio 中创建的服务时，我收到以下错误：

```
System error 5 has occurred.

Access is denied. 
```

我正在以提升的权限运行命令行，所以这不是问题。有什么地方可以查看发生了什么错误。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-22T05:58:29.617

为了让它工作，我需要为我的服务项目的输出 bin\debug 文件夹添加权限。

本地服务帐户没有对输出 .exe 文件的权限，这就是发生错误的原因。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-09-16T10:55:35.757

有同样的问题。

通过在“本地系统帐户”下运行服务修复

![在此处输入图像描述](https://i.stack.imgur.com/wBF8d.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-03T11:24:02.927

就我而言，解决方案就这么简单：以*管理员*身份运行命令提示符。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-22T09:23:52.820

我看到你已经解决了这个问题；但实际上，您通常不应该从项目的 bin 文件夹中运行服务 - 文件应该放在项目和配置文件独立的地方（例如，在程序文件下）。出于调试目的（当它位于 bin 文件夹中时），*您*可以检测它是否是 中的服务`Main()`，如果它正在交互运行，则直接运行服务代码，而不是通常的服务启动设置。

您可以通过添加命令行参数来检测，也可以*尝试*检查`Environment.UserInteractive`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-27T18:59:44.060

本地服务帐户似乎没有控制服务的特权。因此，在服务的登录属性中，将帐户类型更改为本地系统并允许服务与桌面交互。

此外，请确保您以管理员身份使用 instalutil 安装服务。

最后，当您想使用“net start [服务名称]”命令从命令提示符运行服务时，您必须以管理员身份运行命令提示符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-28T07:07:25.577

我遇到了同样的问题，因为我的项目及其源代码位于启用了 NTFS 加密文件系统 ( [EFS](http://en.wikipedia.org/wiki/Encrypting_File_System) ) 的文件夹中。这是由于编译的程序集也被加密，并且运行我的服务的用户没有解密它们的权限。删除 EFS 是解决此问题的简单方法。它可以通过命令行使用 CIPHER.EXE 来完成，它是一个 Windows 工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-16T06:32:40.023

当我将服务从 vs05 迁移到 vs2010，同时从框架 2.0 迁移到框架 4.0 时，我遇到了同样的问题。我被拒绝访问。一旦更改回框架 2.0，它就会再次工作。?%¤#%&%& 问题是服务的初始化字符串不正确（？！）。字符串在开头和结尾都需要引号！

之前....path + service name" "/parameter=1 ' 这曾与框架 2.0 一起使用

之后...."路径+服务名""/parameter=1"

拒绝访问与问题无关。为什么不是“找不到路径”或“缺少参数”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-04T18:05:10.530

从具有最高权限的任务计划程序运行它，它将起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-07T16:42:29.320

具有管理员权限的用户帐户会提示“您确定吗？” 在未提示管理员帐户的情况下。我在使用 net stop netprofm 时遇到了这个问题。

要删除提示，请执行此操作。

控制面板，用户帐户，更改用户帐户控制设置，从不通知

这似乎为具有管理员权限的用户帐户提供了与管理员帐户相同的行为。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-23T22:33:05.810

在我运行“sc config”来更改服务的 binPath 后，我遇到了这个问题。

对我有用的唯一修复是“sc删除”服务并再次安装。

在那之后一切都很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-07T09:06:05.677

**不要简单地以不同的用户名或 admin 启动服务**。（当然，除非您的服务实际上需要管理员权限！）这是一个安全漏洞，会造成糟糕的用户体验。

实际问题是该服务一开始没有被分配任何权限。

但是，必须注意的是，Microsoft 并没有完全让它们易于更改 - 服务权限类似于常规文件权限，但遗憾的是无法通过简单的右键单击来更改。然而，它们可以通过以下方式阅读：

```
sc.exe sdshow <service name> 
```

并通过以下方式编写：

```
sc.exe sdset <service name> <permissions> 
```

*   `<service name>`是您的服务名称。
*   `<permissions>`是 SDDL 格式的权限。

因此，请使用`sdshow`获取权限，然后`sdset`根据您的要求更新它们。SDDL 看似随机字母的杂音，超出了本文的范围，更让人联想到 Unix 而不是 Windows。简而言之，添加描述符`(A;;RPWP;;;WD)`将允许 ( `A`) 每个人 ( `WD`) 启动 ( `RP`) 和停止 ( `WP`) 命名服务。

# objective-c - Objective-C：如何使用 2d C 数组作为字段创建一个类？

> ID：574416
> 
> 赞同：0
> 
> 时间：2009-02-22T05:44:47.543
> 
> 标签：objective-c

每当我调用 doSomething 函数时，我的程序就会崩溃。实际代码是一些数组边界检查，所以我知道这不是问题。

我的类.h

```
#import <Foundation/Foundation.h>
@interface myClass : NSObject {
    BOOL **myMatrix;

}
@property(readwrite) BOOL **myMatrix;

-(myClass*)initWithWidth: (int)w andHeight: (int)h;
-(void)doSomething;
+(BOOL **) createMatrixWithHeight: (int)h andWidth: (int)w;

@end 
```

我的班级.m

```
#import "myClass.h"
#import <Foundation/Foundation.h>

@implementation myClass

@synthesize myMatrix;

-(myClass*)initWithWidth: (int)w andHeight: (int)h    {
    self = [super init];
    myMatrix = [myClass createMatrixWithHeight: h andWidth: w];
    return self;
}

-(void)doSomething{
    myMatrix[2][2] = YES;
}

+(BOOL **) createMatrixWithHeight: (int)h andWidth: (int)w{
    BOOL **newMatrix;

    newMatrix = malloc(w * sizeof(BOOL *));

    int i;
    for(i = 0; i < w; i++){
        newMatrix[i] = malloc(h * sizeof(BOOL));
    }

    return newMatrix;
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T06:00:44.603

您发布的代码和程序中的代码之间一定有一些重要的区别，因为我将其复制并粘贴到程序中，它运行良好而没有崩溃。

所以你的问题的答案是这样的：就像你发布的代码一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-13T14:08:33.877

这个：

```
newMatrix = malloc(w * sizeof(BOOL *));

int i;
for(i = 0; i < w; i++){
    newMatrix[i] = malloc(h * sizeof(BOOL));
} 
```

不是二维数组。它是一个指向数组的指针数组。

二维数组将被分配为：

```
newMatrix = malloc(w * h * sizeof(BOOL)); 
```

请参阅[http://en.wikipedia.org/wiki/C_syntax#Multidimensional_arrays](http://en.wikipedia.org/wiki/C_syntax#Multidimensional_arrays)

# wpf - Observable Collection 中的 RemoveAt，同时修改 ListView 中的 IsSelected 属性

> ID：574418
> 
> 赞同：0
> 
> 时间：2009-02-22T05:45:31.003
> 
> 标签：wpf

我会尽可能明确地尝试。

我有两个 UI 对象，这是一个 TabControl 和一个 ListView，两者都再次绑定了相同对象的两个不同列表，两者都将 IsSelected 属性绑定到 Item.IsSelected 作为视图模型命令，

这完美地工作，（我可以通过选择其中一个来源来证明这一点，另一个选择它已更新）

我的问题是从两个列表中的任何一个中删除一个项目时。Remove 方法似乎将 IsSelected 调用为 FALSE，因此该项目在它仍然出现的另一个列表中被取消选择。

我做错了什么？？？

任何帮助将非常感激。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T06:47:47.347

发生的事情是，每当您从可观察集合中添加/删除项目时，它都会刷新列表。它这样做是为了让任何过滤器/视图/等。将被刷新/重新过滤。唉，它确实 - 正如您所发现的那样 - 在刷新时不会在任何绑定控件中维护所选项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T06:22:46.797

这可能是控件中的错误或疏忽。您可以做的是编写自己的 Remove 方法来保存选择，删除项目，然后将选择放回原处。

# ajax - IE挂起，占用100%的CPU

> ID：574423
> 
> 赞同：3
> 
> 时间：2009-02-22T05:49:42.070
> 
> 标签：ajax, internet-explorer, internet-explorer-7, internet-explorer-6

我有一个 Web 应用程序，它在正常交互过程中挂起 IE。“IE 被挂起”是指 IE 不再响应并使用 100% 的 CPU。摆脱这种状态的唯一方法是杀死 IE 进程。关于应用程序：

*   它只在浏览器中加载一个页面，通过 Ajax 查询与服务器通信，并更新 DOM。
*   我可以用 IE6 和 IE7 重现这个，但不能用 Firefox 或 Safari。

我想知道是否有人已经看过这个，以及是否有一些已知的案例可以让 IE 进入这个挂起/使用 100% 的 CPU 状态。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T08:45:28.763

使用 WinDbg，[http://www.microsoft.com/whdc/devtools/debugging/](http://www.microsoft.com/whdc/devtools/debugging/)

将其附加到有问题的 IE 进程。

.symfix+ 命令会将您的符号路径设置为指向 Microsoft 符号服务器并在本地缓存调试符号。

!runaway 命令将枚举进程中的所有堆栈，并告诉您哪个堆栈正在发疯。

如果幸运的话，您可能会看到一些可识别的东西，例如堆栈顶部的正则表达式替换。或者布局引擎可能进入了无限循环。这两件事过去都发生在我身上。

如果调用堆栈没有意义，请使用 'g' 使进程继续，等待几秒钟，按 Ctrl+Break，然后再次尝试 !runaway。

在本地获得符号后，您还可以使用 SysInternals 的 Process Explorer 查看进程的堆栈。将 Process Explorer 中的 Symbols 选项配置为指向本地符号缓存，例如 c:\Program Files\Debugging Tools for Windows\sym。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T06:00:50.860

尝试附加脚本调试器（在我的例子中是通过 Visual Studio），看看是什么原因造成的。

很可能它是一个运行无限循环的 javascript，或者只是循环太快而无法完成每个 ajax 请求所需的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T05:57:46.780

您是否尝试过跟踪问题？如果问题也发生在 IE8 中，您可以使用 console.log 命令及其内置的令人敬畏的新调试器/开发工具。否则，请使用旧的开发工具栏进行 IE 或警报。尝试减少问题，然后提交错误（请在此处粘贴代码）。

# c# - Linq to Xml：如果属性值等于 IEnumerable 中的节点值，则选择元素

> ID：574432
> 
> 赞同：8
> 
> 时间：2009-02-22T06:00:21.343
> 
> 标签：c#, asp.net, xml, linq

我创建了一个 IEnumerable 对象，它只包含我想要的 xml 文件中的节点：

```
IEnumerable<XElement> rosters = XDocument.Load("roster.xml")
                                         .Elements("rosterlist")
                                         .Elements("roster")
                                         .Where(w => w.Element("division")
                                                      .Value
                                                      .Equals("SUPER AWESOME DIVISION")); 
```

所以它是这些的集合：

```
<rosterlist>
    <roster>
        <userid>1</userid>
        <name></name>
        <etc></etc>
    </roster>
    <roster>
        <userid>2</userid>
        <name></name>
        <etc></etc>
    </roster>
</rosterlist> 
```

我只想获取`userid`属性也是集合中`userid`节点的用户。`rosters`

```
IEnumerable<XElement> users = XDocument.Load("user.xml")
                                       .Elements("userlist")
                                       .Elements("user")
                                       .Where(w => rosters.Elements("userid")
                                                          .Contains(w.Attribute("userid").Value)); 
```

但这给了我一个错误：

**无法从用法中推断方法“System.Linq.Enumerable.Contains(System.Collections.Generic.IEnumerable, TSource)”的类型参数。尝试明确指定类型参数。**

我的方法有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T06:52:24.277

我看到的一个问题是，在最后一个代码片段中，`...Elements("userid")`返回一个 XElement 对象列表，其中不能包含 Value 属性返回的字符串。这应该工作...

```
IEnumerable<XElement> rosters = obRoot.Elements("rosterlist").Elements("roster");
var rosterUserIds = (rosters.Elements("userid").Select(r => r.Value));
IEnumerable<XElement> users = obRoot.Elements("userlist").Elements("user")
                .Where(u => rosterUserIds.Contains(u.Attribute("userid").Value)); 
```

但是我会通过使用加入查询来做到这一点。在用户ID上选择用户加入名册
它会像这样

```
string sXml = @"
<root>
<rosterlist>
    <roster>
        <userid>1</userid>
        <name>R1</name>
        <etc></etc>
    </roster>
    <roster>
        <userid>2</userid>
        <name>R2</name>
        <etc></etc>
    </roster>
</rosterlist>
<userlist>
    <user userid='1'>
        <name>User on roster</name>
    </user>
    <user userid='5'>
        <name>User not on roster</name>
    </user>
</userlist>
</root>

";

XElement obRoot = XElement.Parse( sXml );
var results = from user in obRoot.Elements("userlist").Elements("user")
   join roster in obRoot.Elements("rosterlist").Elements("roster")
   on user.Attribute("userid").Value equals roster.Element("userid").Value
   select new {Name=user.Element("name").Value, RosterName=roster.Element("name").Value} ;

foreach (var v in results)
{
   Console.WriteLine("{0, -20} on Roster {1, -20}", v.Name, v.RosterName);
} 
```

输出：

```
User on roster       on Roster R1 
```

# asp.net-mvc - 如何在 ASP.NET MVC 中检查 ModelStateDictionary

> ID：574437
> 
> 赞同：1
> 
> 时间：2009-02-22T06:01:29.640
> 
> 标签：asp.net-mvc

使用 MvcContrib 中的 ModelStateToTempData 过滤器时，我收到“已添加具有相同密钥的项目”。我试图弄清楚重复键是什么，但无法弄清楚如何在过滤器添加键时检查模型状态。有没有办法在不连接到 MvcContrib 源的情况下这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T06:03:50.897

将 PDB 包含在与 mvccontrib DLL 相同的文件夹中。这将允许您在调试期间查看源代码并逐步执行 mvccontrib，而不包括整个源项目。

# internet-explorer - IE 7 错误：“无法进行传出调用，因为应用程序正在调度输入同步调用”

> ID：574440
> 
> 赞同：2
> 
> 时间：2009-02-22T06:03:30.760
> 
> 标签：internet-explorer

当我与我创建的 Web 应用程序交互时，我会不时收到此错误（请参阅帖子标题）。该应用程序使用 Ajax 与服务器通信，但不做任何特定于 IE 的花哨的事情。在 Firefox 或 Safari 上运行相同的应用程序时，我没有收到此错误或任何其他错误。

您以前是否看到过此错误消息，知道可能导致此错误的原因，或者对如何处理此问题有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T06:18:25.903

这是一个通用的 COM 错误。发生的事情是 AJAX 组件 XmlHttpRequest 是一个 COM 对象，因此遵循 COM 的规则。这里可能发生的是 XmlHttpRequest 正在调度传入事件。在对此事件的响应中，可能有代码调用了另一个公寓中的不同 COM 对象，这最终会导致死锁。COM 检测到这一点并防止这种情况发生。

一般建议是将这种类型的应用程序分解为使用队列。不要立即响应事件，而是将事件保存到队列中并立即返回。然后使用计时器异步处理事件。

# cocoa - NSMutable NSArray Array - 如何避免所有这些行并使用维度或 3D 数组？

> ID：574448
> 
> 赞同：1
> 
> 时间：2009-02-22T06:15:10.917
> 
> 标签：cocoa, arrays

```
enter code here- (void)viewDidLoad {

NSMutableArray *imageViewArray= [[NSMutableArray alloc] init];
for ( int i = 1; i < 10 ; i++ ) {

    NSString *imgName = [NSString stringWithFormat:@"pic%i.jpg", i];
    UIImage *img = [UIImage imageNamed:imgName];
    [imageViewArray addObject:img];
}   
self.gallery = imageViewArray;
[imageViewArray release];

NSString *p1 = [NSString stringWithFormat:@"p1.jpg"];
NSString *p2 = [NSString stringWithFormat:@"p2.jpg"];
NSString *p3 = [NSString stringWithFormat:@"p3.jpg"];
NSString *p4 = [NSString stringWithFormat:@"p4.jpg"];
NSString *p5 = [NSString stringWithFormat:@"p5.jpg"];
NSString *p6 = [NSString stringWithFormat:@"p6.jpg"];
NSString *p7 = [NSString stringWithFormat:@"p7.jpg"];
NSString *p8 = [NSString stringWithFormat:@"p8.jpg"];
NSString *p9 = [NSString stringWithFormat:@"p9.jpg"];
UIImage *P1V = [UIImage imageNamed:p1];
UIImage *P2V = [UIImage imageNamed:p2];
UIImage *P3V = [UIImage imageNamed:p3];
UIImage *P4V = [UIImage imageNamed:p4];
UIImage *P5V = [UIImage imageNamed:p5];
UIImage *P6V = [UIImage imageNamed:p6];
UIImage *P7V = [UIImage imageNamed:p7];
UIImage *P8V = [UIImage imageNamed:p8];
UIImage *P9V = [UIImage imageNamed:p9];
NSArray *imageViewArray2 = [[NSArray alloc] initWithObjects:P1V,P2V,P3V,P4V,P5V,P6V,P7V,P8V,P9V,nil];
self.gallery2 = imageViewArray2;
[imageViewArray2 release];

NSArray *array = [[NSArray alloc] initWithObjects:@"A",@"B",@"C",@"D",@"E",@"F",@"G",@"H",@"I",nil];
self.list = array;
[array release];

[super viewDidLoad]; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T06:20:10.703

您应该做的是将文件名放在一个数组中，然后在循环中简单地替换该变量。

下面是一些代码来证明这一点：

```
NSArray *dayStrings = [NSArray arrayWithObjects: @"Monday", @"Tuesday", @"Wednesday", @"Thursday", @"Friday", nil];
NSArray *timeStrings = [NSArray arrayWithObjects: @"9 AM", @"10 AM", @"11 AM", @"12 PM", @"1 PM", @"2 PM", @"3 PM", @"4 PM", @"5 PM", nil];

int i;
NSMutableAttributedString *day, *time;

for(i = 0; i < HORIZONTAL_CELL_COUNT; i++)
{
  day = [[[NSMutableAttributedString alloc] initWithString:[dayStrings objectAtIndex:i] attributes:attributes] autorelease];
  [days addObject:day];
}

for(i = 0; i < VERTICAL_CELL_COUNT; i++)
{
  time = [[[NSMutableAttributedString alloc] initWithString:[timeStrings objectAtIndex:i] attributes:attributes] autorelease];
  [times addObject:time];
} 
```

# apache-flex - 使用 Flex 扩展 Sprite？

> ID：574452
> 
> 赞同：1
> 
> 时间：2009-02-22T06:20:25.820
> 
> 标签：apache-flex, flash, application-types

到目前为止，我使用 Flash IDE 完成了所有的 Flash 应用程序（尽管我很少使用时间线，因为我更喜欢在代码中完成所有事情）或在 FlexBuilder 中作为 Flex 应用程序。**仅扩展 Sprite（例如在 FlexBuilder IDE 中使用）的应用程序是一种可行的应用程序方式，还是仅适用于 HelloWorlds？**在什么情况下你不会费心使用 Flash IDE？MXML 文件可以与仅扩展 Sprite 的应用程序一起使用吗？

注意：我不是在问何时使用 Flex 与 Flash。我也不是在问 Flash IDE 还是 FlexBuilder IDE 更适合编辑 ActionScript 文件。

**编辑：**我的意思是“MXML 文件可以与仅扩展 Sprite 的应用程序一起使用吗？” 我指的是您是否可以在 Flexbuilder 3 的 Actionscript 3.0 文件中使用 MXML 标记。我很确定您不能这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T06:36:21.193

> 仅扩展 Sprite（例如在 FlexBuilder IDE 中使用）的应用程序是一种可行的应用程序方式，还是仅适用于 HelloWorlds？

在 Flex 中，您可以选择扩展 Sprite 类或实现 IUIComponent 类。不过也有区别。

> 在什么情况下你不会费心使用 Flash IDE？

您需要数据服务吗？在这种情况下，我不太确定使用 Flash IDE 是否容易。

> MXML 文件可以与仅扩展 Sprite 的应用程序一起使用吗？

不太清楚你的意思`apps`。但是，AS3 组件与 MXML 一起工作得很好。如果将 Sprite 与 MXML 一起使用，则必须将其包裹在某种 IUIComponent 中。MXML 是语法糖。它**被**编译到 AS3 中，因此如果您要对它们进行编码，效率可能会降低。

您可能会对这篇[博文感兴趣。](http://userflex.wordpress.com/2008/06/12/sprite-uicomponent/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T06:45:22.467

我认为简单的答案是“是”。我在纯 AS3 中构建了多个站点和应用程序，这些站点和应用程序在 FlexBuilder 中“只是扩展了 Sprite”。

我喜欢编码，所以我不使用 flash IDE 做任何事情。也就是说，我看到我的 Flash 伙伴构建某些东西的速度有多快，所以我建议在 Flash 中构建小的、单独的效果，然后将 .swc 文件导入 FlexBuilder。

# internet-explorer - 在同一台计算机上运行 Internet Explorer 6、Internet Explorer 7 和 Internet Explorer 8

> ID：574463
> 
> 赞同：338
> 
> 时间：2009-02-22T06:30:24.720
> 
> 标签：internet-explorer, browser, internet-explorer-8, internet-explorer-7, internet-explorer-6

和其他人一样，我需要在 Internet Explorer 6 和 Internet Explorer 7 上测试我的代码。现在 Internet Explorer 8 为开发人员提供了一些很棒的工具，我想使用它们。我还想开始使用 Internet Explorer 8 测试我的代码，因为它很快就会发布。

问题是：如何在同一台机器上运行 Internet Explorer 6、Internet Explorer 7 和 Internet Explorer 8。到目前为止，对于 Internet Explorer 6 和 Internet Explorer 7，我一直在使用[Multiple IE](http://tredosoft.com/Multiple_IE?page=6)。但是人们在安装 Internet Explorer 8 后报告了（参见上一句中链接的页面上的评论）Internet Explorer 6 的问题。这些错误与表单字段中的焦点有关。运行 Internet Explorer 7 并不重要，因为 Internet Explorer 8 可以使用 Internet Explorer 7 渲染引擎，但我们仍然需要 Internet Explorer 6。

如何在同一台机器上运行 Internet Explorer 6、Internet Explorer 7 和 Internet Explorer 8？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-02-22T06:33:07.553

我不会这样做的。请改用虚拟 PC。这可能需要一些设置，但从长远来看，你会感谢自己。根据我的经验，你不能真正让它们并排安装干净，除非它们是独立安装，否则你无法真正验证它是 100% 真实的浏览器渲染。

**更新：**看起来完成此任务的更好方法之一（如果运行 Windows 7）是使用 Windows XP 模式设置多个虚拟机：在[IEBlog](https://docs.microsoft.com/en-us/archive/blogs/ie/)[的一台 PC 上测试多个版本的 IE](https://docs.microsoft.com/en-us/archive/blogs/ie/testing-multiple-versions-of-ie-on-one-pc)。

**更新 2：**（11/2014）自上次更新以来有新的解决方案。微软现在为任何环境提供虚拟机来测试多个版本的 IE：[Modern.IE](https://web.archive.org/web/20150505043654/https://www.modern.ie/en-us/virtualization-tools)

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2009-02-22T09:16:32.887

没有人提到这一点，但[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)是一个很棒的工具。它支持 Internet Explorer 5.5、6、7 和 8RC1。渲染匹配相应的浏览器。至少我还没有发现任何差异。

我通常使用它来对布局进行基本检查。我仍然需要 VM 来调试 JavaScript 或使用具有特定 Internet Explorer 版本的开发人员工具栏。

![IETest 0.3](https://i.stack.imgur.com/kcinP.png)

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-03-19T19:53:04.610

您可以使用新的[MS Expression Web SuperPreview](https://blogs.msdn.microsoft.com/xweb/2009/03/18/microsoft-expression-web-superpreview/)

[![替代文字](https://i.stack.imgur.com/0M1h9.jpg)](https://i.stack.imgur.com/0M1h9.jpg)
[（来源：[istartedsomething.com](https://www.istartedsomething.com/wp-content/uploads/2009/03/superpreview1.jpg)）]

如果您不想在 MS Expression Web 上花钱，您可以完全免费下载[Microsoft Expression Web SuperPreview for Windows Internet Explorer](https://www.microsoft.com/en-us/download/details.aspx?id=2020)。唯一的限制是试用期满后无法与非 IE 浏览器进行比较。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-02-22T06:46:50.607

我还建议运行一些虚拟机，而不是在同一个 Windows 实例上运行多个版本的 Internet Explorer。

Microsoft在[Internet Explorer 应用程序兼容性 VPC 映像](http://www.microsoft.com/downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en)下载页面上提供了带有 Internet Explorer 6、7 和 8 的[Virtual PC磁盘映像。](http://www.microsoft.com/windows/virtual-pc/default.aspx)

上述链接中可用的当前虚拟磁盘映像列表是：

*   Windows XP SP3 上的 Internet Explorer 6
*   Windows XP SP3 上的 Internet Explorer 7
*   Windows XP SP3 上的 Internet Explorer 8
*   Windows Vista 上的 Internet Explorer 7
*   Windows Vista 上的 Internet Explorer 8

（列表截至 2009 年 10 月 11 日。所有版本都有到期日期。）

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2013-02-06T05:52:06.010

**[Modern.IE](http://www.modern.ie/)**是 Microsoft 的一项承诺，旨在简化 Internet Explorer 浏览器的跨浏览器测试。微软创建了modern.IE，为开发人员和设计人员提供了一套促进IE浏览器测试的工具。

使用modern.IE，您有两种方法可以在IE 中测试您的网站。首先，modern.IE 为您提供三个月免费使用基于 Web 的浏览器测试服务**[BrowserStack](http://www.browserstack.com/)**的服务。您只需要一个 Facebook 帐户即可登录并开始测试。

Modern.IE 提供的第二种方法是[从 IE 6 到 IE 10 的每个浏览器的虚拟化映像](http://www.modern.ie/en-us/virtualization-tools#downloads)，它可以在虚拟化软件上运行，例如 VirtualBox、Virtual PC、Hyper-V 或 WIndows、Mac 或 Linux 上的 VMWare Player。

此外，modern.IE 还提供[了一个工具，它可以扫描您的网页以查找常见的编码问题](http://www.modern.ie/en-us/report)并将它们列出以供您更正，以便它们在所有 IE 版本中正确显示。

来源：*[modern.IE - 跨浏览器 IE 测试工具套件](http://www.functionn.in/2013/02/modernie-cross-browser-ie-testing-tools.html)*

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-02-22T06:45:29.440

不能用 IE8 代替 IE7。IE8 中的 JavaScript 引擎与 IE7 中的不同。尝试在 IE7 和 IE8 中的数组或对象文字中保留尾随逗号 - 前者会出现错误，但即使在兼容模式下也不会出现后者。如果您希望您的网站在 IE7 中运行，则需要在 IE7 中进行测试。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2009-05-10T18:54:17.423

试试[http://finalbuilds.edskes.net/iecollection.htm](http://finalbuilds.edskes.net/iecollection.htm)。

> Utilu IE Collection 包含**多个 IE 版本**，它们是**独立**的，因此它们可以同时使用。
> 
> 条件注释的工作方式与本机版本完全相同。原始版本号正确显示在用户代理字符串中。版本号也可以在窗口标题中找到。
> 
> Utilu IE Collection 还包括**Internet Explorer Developer Toolbar 1.00.2189.0**。此资源管理器栏提供了多种工具，可以更轻松地对网站进行故障排除。使用 Windows 2000 或更高版本时，Internet Explorer 开发工具栏与 Internet Explorer 5.0 及更高版本兼容。
> 
> Utilu IE Collection 可以选择**为 Internet Explorer 安装 Firebug Web 开发扩展**。Firebug 提供了许多有用的工具，使 Web 开发更容易......

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-10-18T12:50:41.193

我使用[http://www.spoon.net/browsers](http://www.spoon.net/browsers)（仅限 Windows）。

您可以运行 IE8、IE7、IE6、Firefox 3.5、Firefox 3、Firefox 2、Safari 4、Safari 3、Opera 10、Opera 9、Chrome。

你只需要安装一个插件，然后点击相应的图标。它将下载并运行运行上述每个浏览器所需的文件。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-12-02T09:17:11.273

如果您的机器上安装了**IE8**，您也可以测试您的网站在**IE7**中的工作方式。当您在需要在 IE7 浏览器中测试的页面时，打开**"Tools"->"developer tools"**。然后在**“开发者工具”**对话框的菜单中，点击**“浏览器模式：** [CURRENT MODE] **”**，你可以选择3个选项。那是，

1.  **IE7**
2.  **IE8**
3.  **IE8 兼容模式**

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-02-22T06:48:35.220

备份其他用户，您需要在 Windows 机器上运行 Virtual PC 实例。如果您尝试多次安装 Internet Explorer，您将破坏页面上的条件注释，这无论如何都会使测试变得困难（例如，使用 Internet Explorer 5、6 和 7。在 Windows 机器上，IF Internet Explorer 语句将即使在 Internet Explorer 5 中也可以解析到 Internet Explorer 7，这意味着更多奇怪的错误。

更多信息以及下载和运行 Internet Explorer 6 虚拟映像的链接：http: [//blogs.msdn.com/ie/archive/2007/04/17/ie7-virtual-pc-image-and-ie6-virtual- pc-image-refresh.aspx](http://blogs.msdn.com/ie/archive/2007/04/17/ie7-virtual-pc-image-and-ie6-virtual-pc-image-refresh.aspx)

如果您已经有 Virtual PC，这里是图像： [http ://www.microsoft.com/Downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en](http://www.microsoft.com/Downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-07-30T19:56:20.003

我今天在我的 Windows 7 电脑上做了这个：

1.  安装 Windows Virtual PC，并运行 XP Mode
2.  创建了两个 Windows XP 映像。一种使用 Internet Explorer 6，另一种使用 Internet Explorer 7。
3.  现在我可以从我的 Windows 7 桌面运行这些到浏览器了！就像任何其他应用程序一样。无需打开Virtual PC。

[http://www.microsoft.com/windows/virtual-pc/](http://www.microsoft.com/windows/virtual-pc/)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2010-03-20T16:18:26.310

有一种优雅的方式可以在同一台机器上运行 IE6、IE7 和 IE8，称为虚拟 PC。

首先从 Microsoft 网站下载虚拟 PC：http: [//www.microsoft.com/downloadS/details.aspx?FamilyID=04d26402-3199-48a3 -afa2-2dc0b40a73b6&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2dc0b40a73b6&displaylang=en)

然后在这里下载 3 个带有 IE6、IE7 和 IE8 的 EXE 文件：http: [//www.microsoft.com/downloads/details.aspx? FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

将它们安装在您的 PC 上并测试您的 Web 应用程序。节省了我寻找类似解决方案的时间。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-05-03T09:32:17.927

我一直在努力解决这个问题。虚拟化将是一个很好的解决方案，但它对我的需求来说太慢了。一台笔记本电脑只能处理这么多：与 Adob​​e Photoshop 和 Illustrator 一起运行一个开发环境，然后在连接到大量服务器的同时尝试进行虚拟化，并且在后台发生许多其他事情……嗯……*慢*。

我现在有以下设置可以优雅地解决问题，虽然它有点贵，但值得：

*   一台连接到外接显示器的 Macbook
*   一台 Windows 桌面，安装了 Windows XP 和 Windows Vista 双启动

两台机器都运行[Synergy](http://synergy2.sourceforge.net/)，在机器之间共享键盘和鼠标，所以我可以轻松地在两者之间切换。由于它们是独立的计算机，因此我没有任何性能问题，并且可以在我的 Mac 上愉快地进行 Photoshop 处理，而我的 Windows 机器仍然运行着每个浏览器。

此设置涵盖[了 Yahoo! 定义的分级浏览器支持中的大多数浏览器 http://developer.yahoo.com/yui/articles/gbs/](http://developer.yahoo.com/yui/articles/gbs/)：

浏览器：

*   火狐 2 Mac
*   火狐 3 Mac
*   火狐 3 窗口
*   火狐 2 窗口
*   Webkit 每晚 Mac
*   Safari 3 视窗
*   Safari 4 Mac
*   谷歌 Chrome 最新版本 Windows
*   Opera 最新版本 Windows
*   Opera 最新版 Mac
*   Internet Explorer 6（在 Windows 机器的 XP 部分）
*   Internet Explorer 8 w/ IE7 兼容模式（在 Windows 机器的 Vista 部分）

涵盖的电子邮件客户：

*   苹果邮件
*   Thunderbird == Firefox 渲染引擎（在 XP 机器上）
*   Outlook Express == IE6 渲染引擎
*   Outlook 2003（在 XP 机器上）
*   Outlook 2007（在 Vista 机器上）
*   上述所有浏览器上的所有流行 Web 客户端（Live mail、Gmail、Yahoo! 邮件）

此设置未涵盖的内容：

*   我没有 Mac OS 10.4
*   我只测试最新版本的 Opera，而不是任何早期版本（因为它的用户群很小）
*   我测试了 Safari 3 和 Safari 4，一个在 Windows 上，一个在 Mac 上，而不是两个平台上的两个版本。现在，无论如何，Safari 4 仍处于测试阶段。Safari 一直拥有并且拥有非常出色的渲染引擎。
*   至于电子邮件客户端，我从不费心测试 Lotus Notes

[您可以在此处](http://www.youtube.com/watch?v=bo7MOGWWHXk&eurl=http%3A%2F%2Fwww.wolfslittlestore.be%2F2009%2F02%2Fsynergie%2F&feature=player_embedded)查看设置视频。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2011-02-04T20:47:58.007

对于 Windows 用户，Windows XP 模式允许您在 Windows 7 专业版、企业版或旗舰版上运行多个版本的 IE。

[http://blogs.msdn.com/b/ie/archive/2011/02/04/testing-multiple-versions-of-ie-on-one-pc.aspx](http://blogs.msdn.com/b/ie/archive/2011/02/04/testing-multiple-versions-of-ie-on-one-pc.aspx)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-10-10T19:09:31.000

非常好的选择是更新到 Internet Explorer 10。您会发现非常有用的开发人员工具，包括从 IE5 到 IE 10 的兼容性，包括 quirks 模式。如果切换IE版本i菜单，页面的页面渲染会立即发生变化。

这种模式的一个很好的特性是javascript和HTML（类似firebug）调试器，它在兼容模式下工作。这意味着，您可以使用最新的调试器在非常旧的 IE 中调试 javascript，这是一个非常酷的功能。你不能用虚拟机做到这一点。是的，您可以使用虚拟机来检查最终结果。 ![在此处输入图像描述](https://i.stack.imgur.com/Lvbzo.png)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-02-22T06:41:17.360

我使用 Virtual PC 运行安装了 IE6 的 Windows 实例。它比在同一台计算机上安装不同版本有点笨拙，但它是 100% 工作的 IE6。多个 IE 在大多数测试中都可以正常工作，但缺少最后几个百分比。

不要为了让页面在 IE8 中看起来正确而工作太多，它仍然存在一些很可能会在最终版本中修复的小故障。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-22T06:43:30.600

这并不能直接回答您的问题，但是您看过[Litmus](http://litmusapp.com/)吗？我们倾向于将它主要用于测试跨多个浏览器的 HTML/CSS 兼容性（由 Litmus 支持）。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-03-19T20:00:33.063

有点相关，您应该考虑在几乎完成时通过[BrowserShots](http://browsershots.org/)运行您的网站，看看它在数百个配置的数十个浏览器中的外观。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2010-02-25T03:05:03.177

使用 Windows 7 XP 模式在同一台机器上运行 IE6、IE7 和 IE8

[http://articles.sitepoint.com/article/ie6-ie7-ie8-win7-xp-mode](http://articles.sitepoint.com/article/ie6-ie7-ie8-win7-xp-mode)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-05-13T15:49:33.437

我已经根据 Donavon 的教程安装了 Virutal PC，但我的笔记本电脑的 BIOS 似乎不支持硬件虚拟化，并且需要运行 Virtual PC。因此，在您进一步使用 Virtual PC 之前，请确保您的设备支持该功能。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-09-19T10:19:11.807

使用[Internet Explorer 应用程序兼容性 VPC 映像](http://www.webupd8.org/2011/09/test-websites-in-internet-explorer-9-8.html)。

从[Microsoft 下载中心](http://www.microsoft.com/download/en/details.aspx?id=11575)链接下载它

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-10-25T14:56:00.410

VMWare Player 是 Oracle VirtualBox 和 Microsoft VirtualPC 的免费替代品。不过，与提到 VirtualBox 一样，您需要创建自己的 OS+浏览器映像。VMWare 播放器在这里： http: [//www.vmware.com/products/player/](http://www.vmware.com/products/player/)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-22T06:55:25.563

使用 App-V 怎么样？ [http://www.microsoft.com/systemcenter/appv/default.mspx](http://www.microsoft.com/systemcenter/appv/default.mspx)

特别是动态应用程序虚拟化 [http://www.microsoft.com/systemcenter/appv/dynamic.mspx](http://www.microsoft.com/systemcenter/appv/dynamic.mspx)

它在应用程序级别进行虚拟化。在同一操作系统实例上运行不兼容的软件时，它很有用。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-22T07:02:10.150

Firefox 有一个加载项，可以像在 Internet Explorer 5.5/6/7/8 beta 2 中一样呈现网页。

[IE NET 渲染器](https://addons.mozilla.org/en-US/firefox/addon/6455)

编辑：这看起来只做截图，所以它可能不是很有用。有利于确保您的布局没有损坏，但其他方面也没什么。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-03-19T19:55:26.650

正如 Eduardo 所提到的，最近发布的[Microsoft SuperPreview](http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx)是一种工具，可让您查看网页在许多不同浏览器中的呈现方式，即使它们没有安装在本地。

例如，即使您没有安装这些浏览器，您也可以在 Internet Explorer 6、Internet Explorer 7、Internet Explorer 8、Firefox 和 Safari 中查看您的页面的外观。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-06-24T02:55:10.693

我认识的人使用 thinstall 创建了 IE8 的便携版本（现在它被 vmware 购买并称为 Thinapp）（只有 1.8 MB）。Thinstall 创建了一个内置虚拟文件系统的虚拟化应用程序，是 DLL 地狱的完美解决方案。整个应用程序从单个 exe 文件运行。

这是未经测试的其他版本安装，我可能会补充。

[http://rapidshare.com/files/247957494/IE8.Portable.Thinstall.exe](http://rapidshare.com/files/247957494/IE8.Portable.Thinstall.exe)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-08-19T20:19:03.367

在我的 Mac OS X 机器上，我使用免费的 Sun 的[VirtualBox](http://www.virtualbox.org/)。

我运行 3 个 WinXP 虚拟机并为每个机分配 256K。请参阅本教程：

[http://www.10voltmedia.com/blog/2008/12/screencast-install-internet-explorer-on-osx-using-virtualbox/](http://www.10voltmedia.com/blog/2008/12/screencast-install-internet-explorer-on-osx-using-virtualbox/)

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-08-19T20:36:03.943

Adobe 浏览器实验室。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2010-01-18T22:26:17.583

多个 IE [http://tredosoft.com/Multiple_IE](http://tredosoft.com/Multiple_IE) 最多可以安装 6 个 IE，而不会中断当前安装（我有 7 个，它保持原样）。现在我需要找到一种在所有这些之上运行 8 的方法。由于上面的那个小应用程序，6 和 7 已经运行良好。（仅在 XP 上测试）

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2010-02-11T15:24:02.003

我的一位同事推荐[Internet Explorer Collection](http://finalbuilds.edskes.com/iecollection.htm)。它似乎可以正常工作，但我离高级用户还很远。它还支持安装 IE 1 (!!) 到 8。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-05-11T14:19:52.713

最好也可能是唯一的解决方案可能是 IE 测试器，它可以在 ietester[dot]com 上找到。它使用适用于所有 IE 6、7 和 8 的 IE 引擎！而且我还没有发现任何差异！

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2012-06-04T12:35:58.463

尝试使用 IE Tab .. Firefox / Chrome 扩展
[http://www.ietab.net/home](http://www.ietab.net/home)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2012-11-16T13:29:07.917

这是用于进行 IE 6、7、8 和 9 测试的官方 microsoft VM 映像：http: [//www.microsoft.com/en-us/download/details.aspx?id=11575](http://www.microsoft.com/en-us/download/details.aspx?id=11575)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2013-01-25T19:30:49.737

我找到了一个新工具，让这变得非常简单。

使用 IE9 开发者模式。按 F12。

在文件菜单中，您可以看到浏览器版本：IE9，单击此处，您可以将浏览器版本一直更改回 7。对于 6，您仍然需要虚拟 PC。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2013-10-07T17:05:52.020

Microsoft 现在提供虚拟映像，您可以在选择的软件中使用这些虚拟映像来运行 IE8 和其他旧版软件！

[http://www.microsoft.com/en-us/download/details.aspx?id=11575](http://www.microsoft.com/en-us/download/details.aspx?id=11575)

相当大的下载量，但效果很好！（需要有效版本的 Windows 7 才能正常工作）。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2014-02-10T14:14:59.300

还有[CrossBrowserTesting](http://crossbrowsertesting.com/)，它支持[许多浏览器](http://crossbrowsertesting.com/browsers)，似乎无需在您的计算机上安装任何插件即可工作，并且还包括一个非常简洁的[布局比较工具](http://crossbrowsertesting.com/users/26655/screenshots/comparisons/z8d61df3595d232e9b80/z71567dce72084e65b1f/zf621ac3c4fba6825fae/tolerance/30/diff/1/public)。

[CrossBrowserTesting](http://crossbrowsertesting.com/)是从[Browsershots](http://browsershots.org/)中发布的。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-05-07T11:45:14.790

还可以查看[Microsoft 的 Compatibility Inspector](http://ie.microsoft.com/testdrive/html5/compatinspector/)，它会针对影响您的站点向后兼容性的问题向您发出警告。

[http://ie.microsoft.com/testdrive/html5/compatinspector/](http://ie.microsoft.com/testdrive/html5/compatinspector/)

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2010-01-07T10:46:53.690

要检查 Internet Explorer 的所有版本，您可以转到 codecpack.nl 并安装 Internet Explorer 的所有版本，即[IE 集合](http://codecpack.nl/iecollection.htm)。

或者您可以使用 www.multibrowserviewer.com。它可以检查 45 个浏览器和 3 个操作系统。

# mysql - 从列中选择唯一条目

> ID：574469
> 
> 赞同：1
> 
> 时间：2009-02-22T06:36:40.447
> 
> 标签：mysql

我有这个表 ID | 类别 | 子类别 |

```
 1  |      Books       |    Comic         |
           2  |      Books       |   Fiction        |
           3  |      Cars        |     New          |
           4  |      Books       |   Non- fiction   |
           4  |      Cars        |    Second hand   | 
```

我只想从“类别”列中选择唯一的条目。也就是说，我希望只选择一次“书籍”和“汽车”。我怎样才能写一个查询？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T06:38:50.283

你的意思是不同的？

```
SELECT Distinct Category
FROM Table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T06:51:38.460

或分组

```
SELECT Category
FROM Table
GROUP BY Category 
```

Group by 使您能够根据您的查询检索各种聚合（例如类别中的项目数等......）

# c# - 如何在后面的代码中为 Web 用户控件注册事件处理程序？

> ID：574474
> 
> 赞同：1
> 
> 时间：2009-02-22T06:40:36.910
> 
> 标签：c#, event-handling, web-user-controls

我在表单上设置事件时遇到问题。这是设置：

我得到了一个带有两个控件的页面，两个不同版本的表单供最终用户填写——标准和高级。这两种形式有不同的代码和 javascript，所以最初的开发者把它们放在单独的 web 用户控件中。除了控件之外，还有一个可以切换到高级模式的 LinkBut​​ton。

```
<uc1:Standard runat="server" ID="StandardForm" />
<uc1:Advanced runat="server" ID="AdvancedForm" />
<asp:LinkButton runat="server" ID="lnkAdvanced" Text="Go To Advanced" OnClick="lnkAdvanced_Click" /> 
```

lnkAdvanced_Click 只是将当前输入的所有信息带到高级并翻转可见。

我的问题是，其中一位老板想要标准表单中的“转到高级”按钮，但 .Visible 代码在页面上。所以我认为可以使用事件来完成，但它似乎不起作用。

我试图设置这样的事件：

```
public event EventHandler AdvanceClick;

protected void lnkAdvanced_Click(object sender, EventArgs e) {
    AdvanceClick(sender, e);
} 
```

当这不起作用时，我尝试设置一个代表：

```
public delegate void AdvancedEventHandler(object sender, EventArgs e);
public event AdvancedEventHandler AdvanceClick; 
```

当我将按钮移动到标准表单时，我希望能够输入如下内容：

```
StandardForm.AdvanceClick += new AdvancedEventHandler(GoToAdvanced); 
```

但它似乎无法识别控件内的任何事件！我收到一个错误：“标准不包含'AdvanceClick'的定义，并且没有扩展方法'AdvanceClick接受'标准'类型的第一个参数”它发现其他属性很好，我是不是错了方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T07:13:12.213

```
// in your Standard user control
public event EventHandler AdvancedClick;

private void lbtnAdvanced_Click(object sender, EventArgs e)
{
    OnAdvancedClick(e);
}

protected void OnAdvancedClick(EventArgs e)
{
    if (AdvancedClick != null)
        AdvancedClick(this, e);
}

// on your page
StandardForm.AdvancedClick += new EventHandler(StandardForm_AdvancedClick);

private void StandardForm_AdvancedClick(object sender, EventArgs e)
{
    // toggle logic here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T07:06:43.853

您不应该需要委托，因为您已经创建了标准事件。

尝试在您的表单加载或附近：

```
StandardForm.AdvanceClick += new EventHandler(GoToAdvanced); 
```

然后在托管 2 个用户控件的页面上的某个位置

```
protected void GoToAdvanced(object sender, EventArgs e)
{
    //Code that was previously in lnkAdvanced_Click on page.
} 
```

编辑：

听起来设置是错误的。

您能否发布主机页面的标记（此时我们假设它只是 2 个用户控件）。

然后我们还假设在标准 UC 中声明了 AdvanceClick 事件，但错误消息将表明它没有......并且 lnkAdvanced_Click 方法在标准 UC 中？

然后我们假设尝试附加到自定义事件的代码在主机页面中声明。

如果您可以确认或否认这些假设，我相信我们可以解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T07:44:34.900

如果标准表单有“切换到高级”按钮。然后，很明显，它必须知道高级形式，因此它们似乎非常紧密耦合。如果是这种情况，在我看来，您还不如将高级表单作为标准表单的子级......或者更好的是，将它们合并到一个控件中。

如果您不喜欢这些选项，您可能需要创建第三个控件来承载按钮和两个表单，以及在它们之间移动数据和切换其可见性的逻辑。

我个人推荐单一控制选项。拥有紧密耦合的控件通常只会导致混乱。您可以通过各种方式放松依赖关系，但在这样做之前要三思而后行。

在我目前工作的遗留项目中，我们有一堆示例，例如搜索表单和搜索结果被拆分为多个控件，但最终需要彼此的实例才能正常运行。正如我之前所说，我不会推荐这条路径。

# grails - Grails：复选框未设置回false

> ID：574476
> 
> 赞同：9
> 
> 时间：2009-02-22T06:41:44.427
> 
> 标签：grails, spring-mvc

我正在开发一个 Grails (1.0.4) 应用程序，我想在网格视图的单个页面上编辑集合集合。我让它工作得很好，仅取决于 Spring MVC 的索引参数处理，除了一件事：

可以通过复选框设置网格中的布尔值（或就此而言，布尔值），但不能取消设置，即当我选中复选框并更新时，该值设置为 true，但之后当我再次编辑时，取消选中复选框和更新，它仍然是真实的。

这是复选框的 GSP 代码：

```
<g:checkBox name="tage[${indexTag}].zuweisungen[${indexMitarb}].fixiert" value="${z.fixiert}" /> 
```

这是生成的 HTML：

```
<input type="hidden" name="tage[0].zuweisungen[0]._fixiert" />
<input type="checkbox" name="tage[0].zuweisungen[0].fixiert" checked="checked" id="tage[0].zuweisungen[0].fixiert"  /> 
```

我发现了一个准确描述这种效果的[Grails 错误](http://jira.codehaus.org/browse/GRAILS-2486)，但它在 1.0.2 中被标记为已修复，并且那里描述的问题机制（隐藏字段名称中的下划线放在错误的位置）在我的情况下不存在。

任何想法可能是什么原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T13:13:42.710

这是一个名叫 Julius Huang 的人在 grails-user 邮件列表中提出的解决方案。它是可重用的，但依赖于 JavaScript 来填充隐藏字段，其中包含 HTML 不幸未发送的未选中复选框的“错误”响应。

> 当使用自定义 TagLib 取消选中框（true -> false）时，我破解 GSP 以发送“false”。
> 
> 默认情况下，取消选中时复选框不发送任何内容，因此我使用复选框作为事件处理程序，而是发送隐藏字段。
> 
> Controller中的“params”可以处理“false”->“true”而不需要任何修改。例如。Controller 中的一切都保持不变。

GSP 中的自定义标签用法（示例 usedfunc_F 为“true”），

```
<jh:checkBox name="surveyList[${i}].usedfunc_F" value="${survey.usedfunc_F}"></jh:checkBox> 
```

这是标签生成的内容，

```
<input type="hidden" name="surveyList[#{i}].usedfunc_F" id="surveyList[#{i}].usedfunc_F" value="false" />
<input type="checkbox" onclick="jhtoggle('surveyList[#{i}].usedfunc_F')" checked="checked" /> 
```

Javascript

```
<script type="text/javascript">
function jhtoggle(obj) {
   var jht = document.getElementById(obj);
   jht.value = (jht.value !='true' ? 'true' : 'false');
}
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-01T13:08:59.447

这是我自己的解决方案，基本上是手动执行 grails 数据绑定应该执行的操作（但不执行）的解决方法：

```
Map<String,String> checkboxes = params.findAll{def i = it.key.endsWith("._fixiert")} // all checkboxes
checkboxes.each{
    String key = it.key.substring(0, it.key.indexOf("._fixiert"))
    int tagIdx = Integer.parseInt(key.substring(key.indexOf('[')+1, key.indexOf(']')))
    int zuwIdx = Integer.parseInt(key.substring(key.lastIndexOf('[')+1, key.lastIndexOf(']')))
    if(params.get(key+".fixiert"))
    {
        dienstplanInstance.tage[tagIdx].zuweisungen[zuwIdx].fixiert = true
    }
    else
    {
        dienstplanInstance.tage[tagIdx].zuweisungen[zuwIdx].fixiert = false                    
    }
} 
```

工作，不需要更改 grails 本身，但不可重用（可能可以通过一些额外的工作来实现）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T00:26:24.640

I think that the simplest workaround would be to attach a debugger and see why Grails is failing to populate the value. Considering Grails is open source you'll be able to access the source code and once you figure out the solution for it you can patch your version.

I have also found this other bug [GRAILS-2861](http://jira.codehaus.org/browse/GRAILS-2861) which mentions the issue related to binding to booleans (see Marc's comment in the thread). I guess that is exactly the problem you are describing.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T12:03:48.077

我将创建一个演示问题的小型示例应用程序并将其附加到 Grails 错误（或创建一个新错误）。这里的某个人可能能够调试您的示例应用程序，否则您将证明该错误并未真正修复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-28T02:53:33.240

试试这个，将日志设置为 DEBUG，首先尝试前 3 个，如果它们没有显示问题，将它们全部翻转到 DEBUG：

```
codehaus.groovy.grails.web.servlet="error"  //  controllers
codehaus.groovy.grails.web.pages="error" //  GSP
codehaus.groovy.grails.web.sitemesh="error" //  layouts
codehaus.groovy.grails."web.mapping.filter"="error" // URL mapping
codehaus.groovy.grails."web.mapping"="error" // URL mapping
codehaus.groovy.grails.commons="info" // core / classloading
codehaus.groovy.grails.plugins="error" // plugins
codehaus.groovy.grails.orm.hibernate="error" // hibernate integration 
```

这应该可以让您准确地看到参数设置失败的时间和方式，并可能找到解决方法。

# c++ - 类的构造函数

> ID：574486
> 
> 赞同：-1
> 
> 时间：2009-02-22T06:51:19.927
> 
> 标签：c++, arrays

N 个元素的 C/C++ 中的数组具有从 0 作为下限到 N-1 作为上限的下标。其他语言（如 Pascal）允许用户指定任何下限和上限下标值来创建（上限 - 下限 + 1）元素的数组。

**问题**：在 C++ 中创建一个类“Array”，允许用户指定两种形式的数组。数组中的每个元素都是一个浮点值。该类是为了最大限度地隐藏信息量。清楚地显示进入头文件 array.h 和源文件 array.cpp 的信息。头文件必须保证头文件信息的多份副本不能存在于任何源代码文件中。

有人可以帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T07:05:39.907

把你所有的问题放在一个堆栈中。

弹出他们...

> 有人可以帮我吗？

让我们来看看。

> 头文件必须保证头文件信息的多份副本不能存在于任何源代码文件中。

听说过头球后卫吗？或者，#pragma？这是两种解决方案，但您必须弄清楚每种解决方案的优缺点。

> 清楚地显示进入头文件 array.h 和源文件 array.cpp 的信息。

您熟悉使用 C 或 C++ 进行编程吗？

> 该类是为了最大限度地隐藏信息量。

封装。任何关于 C++/OOD 的标准文本都会对您有所帮助。这个想法是拥有接口并围绕它们构建您的代码。

> 数组中的每个元素都是一个浮点值

当然，为什么不呢？

> 在 C++ 中创建一个类“Array”，允许用户指定两种形式的数组。

当然。你还需要多维数组吗？您需要做的就是在这些表格之间进行翻译。您希望用户在使用您的数组类时使用什么语法？例如：流行的形式是使用 operator[] 访问数组元素，如 float_array[ i ] 其中 i = 0, 1, ... N-1。

```
class Array {
   public:
     explicit Array(size_t n); // default array, C-style indexing
     Array(size_t begin, size_t end); // Pascal-style indexing
   private:
     float *_a;
}; 
```

这会让你开始。如果您有更多问题，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T08:06:59.887

冒着这个风险，我会选择一个模板化的解决方案。它更加优雅。可能是这样的：

```
template<int START, int END>
class Array
{
   float operator[](int i) { ... }
...
private:
   float m_data[END - START];

}; 
```

# java - 难以从 Jpanel 中删除所有组件

> ID：574492
> 
> 赞同：1
> 
> 时间：2009-02-22T07:00:27.797
> 
> 标签：java, swing, components, jpanel

万事如意，

我正在为一个项目编写一个主菜单。菜单正确显示。我还为菜单上的三个按钮设置了 ActionListener。

我希望做的是在用户选择“开始新游戏”时将 JPanel 重用于一组新的单选按钮。

但是，编写 ActionPerformed 以从 JPanel 中删除现有组件让我感到困惑。我知道 removeAll 在某种程度上很重要，但不幸的是 NetBeans 告诉我我不能在 ActionPerformed 内的 mainMenu JPanel 对象上调用它。因此，我在下面的代码中将其注释掉了，但将其保留了下来，以便您可以看到我要做什么。

感谢您的想法或提示。

这是我的主要代码：

```
public class Main {

    public static void main(String[] args) {
        MainMenu menu = new MainMenu();
        menu.pack();
        menu.setVisible(true);
    }
} 
```

这是我的主菜单代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

    public class MainMenu extends JFrame implements ActionListener {
        JButton startNewGame = new JButton("Start a New Game");
        JButton loadOldGame = new JButton("Load an Old Game");
        JButton seeInstructions = new JButton("Instructions");

        public MainMenu() {
            super("RPG Main Menu");
            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            JPanel mainMenu = new JPanel();
            mainMenu.setLayout(new FlowLayout());
            startNewGame.setMnemonic('n');
            loadOldGame.setMnemonic('l');
            seeInstructions.setMnemonic('i');
            startNewGame.addActionListener(this);
            loadOldGame.addActionListener(this);
            seeInstructions.addActionListener(this);
            mainMenu.add(startNewGame);
            mainMenu.add(loadOldGame);
            mainMenu.add(seeInstructions);
            setContentPane(mainMenu);

        }

        public void actionPerformed(ActionEvent evt) {
            Object source = evt.getSource();
            if (source == startNewGame) {
                // StartNewGame code goes here
                // mainMenu.removeAll();
            }
            if (source == loadOldGame) {
                // LoadOldGame code goes here
            }
            if (source == seeInstructions) {
                // Quit code goes here
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T07:15:43.300

考虑改用 a ，它管理共享相同显示空间的[`CardLayout`](http://java.sun.com/docs/books/tutorial/uiswing/layout/card.html)两个或多个组件（通常是实例）。`JPanel`这样您就不必在运行时添加和删除组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T07:12:54.180

您没有参考 mainMenu actionPerformed 使用。如果您使用按钮声明 mainMenu。它会起作用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T07:13:04.040

您需要 mainMenu 成为成员变量：

```
 public class MainMenu extends JFrame implements ActionListener {
        JButton startNewGame = new JButton("Start a New Game");
        JButton loadOldGame = new JButton("Load an Old Game");
        JButton seeInstructions = new JButton("Instructions");
        JPanel mainMenu = new JPanel(); 
```

为什么你觉得有必要重新使用这个对象？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T07:13:51.977

问题是该`actionPerformed`方法试图调用`JPanel mainMenu`超出范围的方法，即该`mainMenu`变量在该方法中不可见`actionPerformed`。

解决此问题的一种方法是`JPanel mainMenu`在类本身中声明并使其成为类的所有实例方法都可以访问的实例字段。

例如：

```
public class MainMenu extends JFrame implements ActionListener
{
    ...
    JPanel mainMenu;

    public MainMenu()
    {
        ...
        mainMenu = new JPanel();
        ...
    }

    public void actionPerformed(ActionEvent e)
    {
        ...
        mainMenu.removeAll();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T11:54:35.017

避免尝试“重用”东西。计算机非常有能力整理。专注于使您的代码清晰。

因此，与其尝试整理面板，不如用一个新面板替换它。

通常，编写侦听器的更好方法是匿名内部类。其中的代码将可以访问封闭范围内的最终变量和封闭类的成员。所以，如果你 make `mainMenu`final 并且你`ActionListener`是匿名内部类，你的代码至少应该编译。

也不要尝试“重用”类。尽量让每个类做一件明智的事情，并避免继承（实现）。几乎没有任何需要 extend `JFrame`，所以不要那样做。为每个操作创建一个`ActionListener`，而不是尝试确定事件源。

另请注意，您应该始终在 AWT 事件调度线程上使用 Swing 组件。更改`main`方法以添加样板文件，例如：

```
public static void main(final String[] args) {
    java.awt.EventQueue.invokeLater(new Runnable() { public void run() {
        runEDT();
    }});
} 
```

# php - 是什么 ”？” 用于 php 的 URL 中的符号？

> ID：574493
> 
> 赞同：10
> 
> 时间：2009-02-22T07:00:33.883
> 
> 标签：php, url

我是 PHP 新手。在学习 PHP 语言的过程中，我注意到，有些网站会有这样的 URL：

www.website.com/profile.php?user=roa3&...

我的问题：

1.  是什么 ”？” 符号用于？

2.  如果我正在开发一个 php 网站，我必须在我的 URL 中使用它吗？例如，用户（roa3）成功登录后，我将重定向到“www.website.com/profile.php?user=roa3”而不是“www.website.com/profile.php”

3.  使用它的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-22T07:10:47.383

好问题，简单地说，

1.  “？” 代表查询字符串的开始，其中包含要传递给服务器的数据。在这种情况下，您将 user=roa3 传递给 profile.php 页面。您可以在 profile.php 中使用 $_GET['user'] 获取数据。查询字符串是从客户端代理向服务器发送数据的方法之一。另一个将数据放在 HTTP 正文中并 POST 到服务器，您不会直接从浏览器看到 HTTP POST 数据。

2.  查询字符串可以由用户编辑，并且对公众可见。如果 www.website.com/profile.php?user=roa3 打算公开，那很好，否则您可能想使用 session 来获取当前用户的上下文。

3.  它是一种将数据传递到服务器的灵活方式，但它对用户是可见和可编辑的，对于某些敏感数据，至少在将其附加到查询字符串之前产生某种散列，这会阻止用户对其进行编辑或理解它的意义。然而，这并不能阻止一个体面的黑客对您的网站做错事。不同的浏览器支持不同的最大 URL 长度，冗长的 URL 由这些查询字符串参数组成。如果要发送大量数据，请将数据放在 HTTP 正文中并 POST 到服务器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T08:28:22.797

到目前为止，我看到的大多数答案都是关于 PHP 的，而实际上这并不是特定于语言的。到目前为止给出的答案都是从 PHP 的角度来看的，并且您用于访问信息的方法因一种语言而异，但数据在 URL 中的格式（称为查询字符串）将保持不变相同（例如：page.ext?key1=value&key2=value&...）。

我不知道你的技术背景或知识，所以请原谅我......

网页有两种不同的方法将数据提供回 Web 服务器。这些被称为 POST 或 GET 方法。还有很多其他的，但在与普通用户打交道时，这些都不应该用于任何类型的网页设计。POST 方法以不可见的方式发送到服务器，用于“上传”数据，而 GET 方法作为 URL 中的查询字符串对用户可见，仅用于“获取”信息。

并非所有网站都遵循这一经验法则，但可能有原因。例如，一个站点可以专门使用 POST 来绕过代理服务器或浏览器的缓存，或者因为它们使用双字节语言，并且在尝试执行 GET 时可能由于编码转换而导致问题。

关于这两种方法以及何时使用它们的一些资源......

[http://www.cs.tut.fi/~jkorpela/forms/methods.html](http://www.cs.tut.fi/~jkorpela/forms/methods.html) [http://weblogs.asp.net/mschwarz/archive/2006/12/04/post-vs-get.aspx](http://weblogs.asp.net/mschwarz/archive/2006/12/04/post-vs-get.aspx) [http:// /en.wikipedia.org/wiki/Query_string](http://en.wikipedia.org/wiki/Query_string)

现在从严格的 PHP 位置来看，现在有 3 个不同的数组可用于获取网页已发送回服务器的信息。你必须随心所欲...

*   $_POST['keyname']，仅从 POST 方法中获取信息
*   $_GET['keyname']，仅从 GET 方法中获取信息
*   $_REQUEST['keyname']，允许您获取 POST、GET 和任何可能已提交的 COOKIE 信息。有点笼统，尤其是在您不知道页面可能使用哪种方法来提交数据的情况下。

不要因为直接使用 $_REQUEST 方法而马虎。除非你有我上面提到的 $_REQUEST 变量的情况，否则不要使用它。在安全性方面，您想尝试使用“全部拒绝，并且只允许 x、y、z”的方法。仅查找您知道您自己的站点将发送的数据，仅查找您期望的组合，并在使用之前清理所有信息。例如..

*   切勿对通过上述方法传递的任何内容执行 eval()。我从未见过这样做过，但这并不意味着人们没有尝试过或做过。
*   切勿在不清理数据库的情况下直接将信息用于数据库（如果您不熟悉它们，请研究 SQL 注入攻击）

到目前为止，这还不是 PHP 安全性的终极目标，但我们并不是为此而存在的。如果您想了解更多信息，那么这就是 SO 的另一个问题。

希望这会有所帮助，并随时提出任何问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T07:20:13.883

**1）**如果用户登录到您的站点，您将使用[Sessions](http://www.tizag.com/phpT/phpsessions.php)将用户名存储在那里，而不是在 url 中传递它，例如`profile.php?username=roa3`

**2)**在 url 中使用`?`符号通常被认为对`Search Engine Optimization`. 此外，网址看起来有点难看。使用[mod_rewrite](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)`profile.php?user=roa3`你可以做与or相同的事情`products.php?id=123&category=toys`：`site.com/profile/roa3`or `products/toys/123`。

默认情况下，使用[CodeIgniter](http://www.codeigniter.com)框架将为您提供友好的 URL，并消除`?`url 中对 s 的需要。有关示例，请参[见此页面。](http://codeigniter.com/user_guide/general/urls.html)

**3）**该`?`符号也用于php页面的代码中。例如，一个`if else`块，例如：

```
if ($x==1)
   $y=2;
else
   $y=3; 
```

也可以写成：

```
$y=($x==1) ? 2 : 3; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-22T07:22:47.120

这 ”？” 表示要遵循一些 GET 变量。您的示例使用了一个名为“user”的变量，并分配了一个名为“roa3”的变量。

使用 GET 变量的优点：

*   它们可以作为 URL 的一部分加入书签

缺点

*   它们是公开的。任何人都可以拦截并查看此信息。这些 url 请求甚至被旅程中的服务器缓存。因此，任何人都可以通过手动输入该信息来模拟您的 roa3 用户......他们也可以将 roa3 更改为不同的用户并模拟他们......

您还可以使用“&”符号来分隔多个变量，例如： `www.website.com/profile.php?user=roa3&fav_colour=blue`

其他选项：

*   POST 变量

    *   您可以通过 POST 变量发送变量。这些变量是在请求的标头中传递的，而不是在请求的 url 中。它们不是立即显而易见的，也不会在旅途中被服务器缓存，但它们仍然可以被读取。除非您已建立 HTTPS 连接。
    *   表单中的变量可以通过 POST 或 GET 方法发送。您可以在表单的“方法”中指定这一点。`<form action="index.php" method='post'/>`
*   会话变量

    *   会话变量存储在服务器上。会话 id 被传递给用户，并且每次用户发出另一个请求时，这个会话 id 都会被传递回服务器。然后可以使用此会话 ID 来获取存储的会话变量。因此，您可以存储用户最喜欢的颜色、他们的姓名和 IP 地址等。但您可以将其存储在服务器上而不是用户的家用 PC 上。
        会话 id 可以被模拟，因此最好检查用户的 IP，或者将它们包装在一个安全的连接中。例如 https。
    *   拦截请求的人不能更改会话变量。
*   COOKIE 变量：
    类似于会话变量，只是它们存储在用户的 PC 上，而不是服务器上。它们是针对域存储的，当它们进入该域时，它们会将请求标头中的变量重新提交给服务器。这意味着用户可以更改和破解变量，或者其他人可以。

要在 php 中访问这些变量，您可以使用：

*   `$x = $_GET['user']`获取变量
*   `$x = $_POST['user]`
*   `$x = $_REQUEST['user']`- get、post 和 cookie 变量的组合
*   `$x = $_COOKIE['user']`- cookie 变量
*   `$x = $_SESSION['user']`访问会话变量

（`user`可以替换为您正在使用的变量的名称）

足够简单的东西，但重要的是要知道它们实际上做了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T10:43:00.493

? 是 HTTP 标准的一部分，而不是 PHP 的一部分。我想我应该指出这一点，所以当你转向另一种语言并再次看到它时，你不会因为涉及 PHP 而感到困惑。

否则上面有一些很好的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T07:10:14.733

从服务器的角度来看，? 只是另一个角色。PHP 为 ? 之后的部分 URL 提供了简单的方法。字符，例如对于“/profile.php?user=roa3”，PHP 将设置 $_GET['user'] = 'roa3'。

原因 ？在 URL 中很有用的是浏览器可以使用表单构建动态 URL——在上面的例子中，我希望 URL 是由带有字段“user”的 HTTP 表单构建的，人类用户在其中输入了“roa3”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-22T07:11:49.393

1.  “？” 用于分隔 URL 和参数。例如，它就像[http://www.url.com/resourcepath?a=b&c=d](http://www.url.com/resourcepath?a=b&c=d)。在这种情况下，a=b 就像 request_parameter=request_value。

2.  是的，不建议使用太多参数，因为总 url 大小是有限的，就像 GET 请求一样，所有参数都显示在 url 上，用户可以修改它。在您的示例中，说明如果用户将 url 修改为“user=techmaddy”。

3.  优点是它可以用于 GET 类型的请求。缺点是安全性低，规模有限。

# apache-flex - 如何从 Actionscript 定位到 MXML 中的 Flex 3 数据网格？

> ID：574497
> 
> 赞同：0
> 
> 时间：2009-02-22T07:02:04.690
> 
> 标签：apache-flex, datagrid, air

我在 mxml 文件（flex 3）中定义了一个数据网格：

我正在使用外部类连接到 sqlite 数据库并生成一些结果（这是有效的，我可以跟踪结果）。

如何定位外部类在 mxml 中生成的数据网格？我试过了：

Application.application.resultsGrid.dataProvider = results.data;

并得到“错误：未定义属性应用程序的访问。” 来自 amxmlc 编译器。

我也试过：

```
[Bindable]
public var resultsGrid:DataGrid; 
```

在类属性中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T07:17:25.497

看起来我需要包含 import mx.core.*; 现在它可以工作了。

我真的不明白你的回答。我是否没有通过以下方式绑定 dataprovider 属性：

Application.application.resultsGrid.dataProvider = result.data; ?

我来自 PHP 背景，熟悉该环境中的 OOP，因此 Flex 中的习语对我来说很陌生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T07:11:12.610

更新：你的问题的措辞让我很困惑:(

~~如果您需要使用您的数据库填充数据网格，您确实应该考虑绑定 dataProvider 属性。~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T18:21:24.697

正如 brd664 所说，你实际上在做什么

```
Application.application.resultsGrid.dataProvider = result.data; 
```

实际上是一个任务。就像给变量赋值一样

```
var a : uint = 1; 
```

绑定为您提供了更多的结构，并允许您基于单个属性更新填充多个组件。绑定还有很多其他好处，可能在这篇文章中无法涵盖。

这是一个关于绑定如何工作的快速简单的示例。请注意，有一个属性是可绑定的……当您单击按钮时，它会将该属性设置为 textInput 中的任何值。然后，此更新会导致绑定触发并更新已绑定到该属性的任何内容。它是 flex 最大的功能之一（它也广泛用于 silverlight 和 wpf，可能还有很多我不知道的其他技术）。无论如何......玩一下它，看看你是否可以让你的组件从绑定中更新。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="horizontal">

    <mx:Script>
        <![CDATA[

            private var _myData : String

            [Bindable]
            public function get myData() : String
            {
                return _myData;
            }
            public function set myData(value : String) : void
            {
                _myData = value;
            }

            private function clickHandler(event : MouseEvent) : void
            {
                myData = myTextInput.text;
            }
        ]]>
    </mx:Script>
    <mx:VBox>
        <mx:HBox>
            <mx:Label text="{myData}" />
            <mx:Label text="{myData}" />
            <mx:Label text="{myData}" />
        </mx:HBox>
        <mx:TextInput id="myTextInput" text="TYPE HERE" />
        <mx:Button label="CLICK TO BIND" click="clickHandler(event)" />
    </mx:VBox>

</mx:Application> 
```

# c# - 如何在业务逻辑层设计数据传输对象

> ID：574520
> 
> 赞同：10
> 
> 时间：2009-02-22T07:19:43.120
> 
> 标签：c#, dto, llblgenpro, business-logic-layer

## DTO

我正在构建一个希望扩展到许多用户的 Web 应用程序。此外，我需要通过 Web 服务向受信任的第三方公开功能。

我正在使用 LLBLGen 生成数据访问层（使用 SQL Server 2008）。目标是构建一个业务逻辑层，使 Web App 免受 DAL 细节的影响，当然，还提供 DAL 之外的额外验证级别。此外，据我现在所知，Web 服务本质上将是 BLL 的薄包装器。

当然，DAL 有自己的一组实体对象，例如 CustomerEntity、ProductEntity 等等。但是，我不希望表示层直接访问这些对象，因为它们包含特定于 DAL 的方法，并且程序集特定于 DAL 等等。因此，这个想法是创建数据传输对象 (DTO)。这个想法是，本质上，这些将是普通的旧 C#/.NET 对象，它们具有所有字段，例如 CustomerEntity，实际上是数据库表 Customer，但没有其他东西，除了一些 IsChanged/IsDirty 属性。因此，会有 CustomerDTO、ProductDTO 等。我假设这些将继承自基本 DTO 类。我相信我可以使用 LLBLGen 的一些模板生成这些，但我还不确定。

因此，这个想法是 BLL 将通过接受和返回这些 DTO 对象来公开其功能。我认为 Web 服务将处理将这些对象转换为 XML 以供使用它的第三方使用，许多可能没有使用 .NET（此外，有些东西可以通过 Web 应用程序上的 AJAX 调用使用 JSON 进行脚本调用）。

我不确定设计这个的最佳方法以及如何前进。这里有一些问题：

1）这应该如何暴露给客户端（表示层和Web服务代码）

我在想会有一个具有这些方法的公共类，每次调用都是原子操作：

InsertDTO、UpdateDTO、DeleteDTO、GetProducts、GetProductByCustomer 等等...

然后客户端只需调用这些方法并传入适当的参数，通常是 DTO。

这是一个好的、可行的方法吗？

2）从这些方法返回什么？显然，Get/Fetch 类型的方法将返回 DTO。但是插入呢？部分签名可能是：

```
InsertDTO(DTO dto) 
```

但是，插入时应该返回什么？我想收到错误通知。但是，我对某些表使用自动递增主键（但是，一些表具有自然键，尤其是多对多表）。

我想到的一个选项是 Result 类：

```
class Result
{
    public Exception Error {get; set;}
    public DTO AffectedObject {get; set;}
} 
```

因此，在插入时，DTO 将获取其获取 ID（如 CustomerDTO.CustomerID）属性集，然后放入此结果对象。如果 Result.Error != null 客户端将知道是否有错误，然后它会从 Result.AffectedObject 属性中知道 ID。

这是一个好方法吗？一个问题是，它似乎在来回传递大量冗余数据（当它只是 ID 时）。我不认为添加“int NewID”属性是干净的，因为某些插入不会有这样的自动递增键。另一个问题是我认为 Web 服务不能很好地处理这个问题？我相信他们只会在 Result 类中返回 AffectedObject 的基本 DTO，而不是派生的 DTO。我想我可以通过拥有大量不同类型的 Result 对象（可能从基本 Result 派生并继承 Error 属性）来解决这个问题，但这似乎不太干净。

好吧，我希望这不是太罗嗦，但我想清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T08:59:53.627

1：这是一种非常标准的方法，非常适合“存储库”实现，以获得最佳的单元可测试方法。

2：异常（应该在 WCF 边界上声明为“故障”，顺便说一句）将自动引发。你不需要直接处理。对于数据 - 有三种常见的方法：

*   在合同上使用`ref`（不是很漂亮）
*   返回（更新的）对象 - 即`public DTO SomeOperation(DTO item);`
*   只返回更新的身份信息（主键/时间戳/等）

关于所有这些的一件事是，每个操作不需要不同的类型（对比你的`Result`类，每个 DTO 都需要复制它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T08:12:35.707

Q1：您可以将您的 WCF 数据协定复合类型视为 DTO 来解决此问题。这样，您的 UI 层只能访问 DataContract 的 DataMember 属性。您的原子操作将是您的 WCF 接口公开的方法。

Q2：配置您的响应数据协定以使用您的主键等返回一个新的自定义类型... WCF 也可以配置为将异常返回到 UI。

# java - 编码技巧 - 交集类型和 java 枚举

> ID：574529
> 
> 赞同：8
> 
> 时间：2009-02-22T07:34:38.590
> 
> 标签：java, generics, enums

交集类型允许您（有点）做具有继承层次结构的枚举。您不能继承实现，但可以将其委托给辅助类。

```
enum Foo1 implements Bar {}
enum Foo2 implements Bar {}

class HelperClass {
   static <T extends Enum<T> & Bar> void fooBar(T the enum) {}
} 
```

当您有许多实现某种模式的不同枚举时，这很有用。例如，许多具有父子关系的枚举对。

```
enum PrimaryColor {Red, Green, Blue;}
enum PastelColor {Pink, HotPink, Rockmelon, SkyBlue, BabyBlue;}

enum TransportMedium {Land, Sea, Air;}
enum Vehicle {Car, Truck, BigBoat, LittleBoat, JetFighter, HotAirBaloon;} 
```

您可以编写通用方法，说“好的，给定一个枚举值，它是一些其他枚举值的父级，子类型的所有可能子枚举中有多少百分比将这个特定的父值作为其父值？”，并拥有一切类型安全且无需强制转换即可完成。（例如：“海”是所有可能的车辆的 33%，“绿色”是所有可能的粉彩的 20%）。

代码如下所示。请特别注意，“叶子”类本身非常简洁——但泛型类的声明非常丑陋。没关系：你只写一次。一旦有了泛型类，就很容易使用它们。

下面的帮助类只有一些静态方法。其他方法包括

*   提供一个返回单例的实例，但根据父/子类型输入
*   为每个父/子返回一个实例，键入正确，并在每个父枚举中包含一个

使用第二个选项，“children”对象实际上将位于帮助器内部，因此减少了枚举中所需的代码量。他们都会实例化一个助手，并委派任何困难的事情。

```
import java.util.EnumSet;

import javax.swing.JComponent;

public class zz extends JComponent {

    public static void main(String[] args) {
        System.out.println(PrimaryColor.Green + " " + ParentUtil.pctOf(PrimaryColor.Green) + "%");
        System.out.println(TransportMedium.Air + " " + ParentUtil.pctOf(TransportMedium.Air) + "%");
    }

}

interface Parent<P extends Enum<P> & Parent<P, C>, C extends Enum<C> & Child<P, C>> {
    Class<C> getChildClass();

    EnumSet<C> getChildren();
}

interface Child<P extends Enum<P> & Parent<P, C>, C extends Enum<C> & Child<P, C>> {
    Class<P> getParentClass();

    P getParent();
}

enum PrimaryColor implements Parent<PrimaryColor, PastelColor> {
    Red, Green, Blue;

    private EnumSet<PastelColor>    children;

    public Class<PastelColor> getChildClass() {
        return PastelColor.class;
    }

    public EnumSet<PastelColor> getChildren() {
        if(children == null) children=ParentUtil.loadChildrenOf(this);
        return children;
    }
}

enum PastelColor implements Child<PrimaryColor, PastelColor> {
    Pink(PrimaryColor.Red), HotPink(PrimaryColor.Red), //
    Rockmelon(PrimaryColor.Green), //
    SkyBlue(PrimaryColor.Blue), BabyBlue(PrimaryColor.Blue);

    final PrimaryColor  parent;

    private PastelColor(PrimaryColor parent) {
        this.parent = parent;
    }

    public Class<PrimaryColor> getParentClass() {
        return PrimaryColor.class;
    }

    public PrimaryColor getParent() {
        return parent;
    }
}

enum TransportMedium implements Parent<TransportMedium, Vehicle> {
    Land, Sea, Air;

    private EnumSet<Vehicle>    children;

    public Class<Vehicle> getChildClass() {
        return Vehicle.class;
    }

    public EnumSet<Vehicle> getChildren() {
        if(children == null) children=ParentUtil.loadChildrenOf(this);
        return children;
    }
}

enum Vehicle implements Child<TransportMedium, Vehicle> {
    Car(TransportMedium.Land), Truck(TransportMedium.Land), //
    BigBoat(TransportMedium.Sea), LittleBoat(TransportMedium.Sea), //
    JetFighter(TransportMedium.Air), HotAirBaloon(TransportMedium.Air);

    private final TransportMedium   parent;

    private Vehicle(TransportMedium parent) {
        this.parent = parent;
    }

    public Class<TransportMedium> getParentClass() {
        return TransportMedium.class;
    }

    public TransportMedium getParent() {
        return parent;
    }
}

class ParentUtil {
    private ParentUtil(){}
    static <P extends Enum<P> & Parent<P, C>, C extends Enum<C> & Child<P, C>> //
    float pctOf(P parent) {
        return (float) parent.getChildren().size() / //
                (float) EnumSet.allOf(parent.getChildClass()).size() //
                * 100f;
    }
    public static <P extends Enum<P> & Parent<P, C>, C extends Enum<C> & Child<P, C>> //
    EnumSet<C> loadChildrenOf(P p) {
        EnumSet<C> cc = EnumSet.noneOf(p.getChildClass());
        for(C c: EnumSet.allOf(p.getChildClass())) {
            if(c.getParent() == p) {
                cc.add(c);
            }
        }
        return cc;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-01T18:49:11.693

您可以改用 Commons Enum 实现：

[http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/enums/Enum.html](http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/enums/Enum.html)

它允许您创建可以被子类化的枚举。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-12T19:56:44.170

这更简单，它做你想要的吗？

```
import java.util.*;
interface Tree{
    Tree parent();
    Set<Tree> children();
}
enum PrimaryColor implements Tree {
    Red,Green,Blue;
    @Override public Tree parent() {
        return null;
    }
    @Override public Set<Tree> children() {
        return Collections.unmodifiableSet(children);
    }
    final Set<Tree> children=new LinkedHashSet<Tree>();
}
enum PastelColor implements Tree {
    Pink(PrimaryColor.Red),HotPink(PrimaryColor.Red),Rockmelon(PrimaryColor.Green),SkyBlue(PrimaryColor.Blue),BabyBlue(PrimaryColor.Blue);
    PastelColor(final PrimaryColor primaryColor) {
        this.primaryColor=primaryColor;
        if (primaryColor!=null) primaryColor.children.add(this);
    }
    @Override public Tree parent() {
        return primaryColor;
    }
    @Override public Set<Tree> children() {
        return Collections.emptySet();
    }
    double percent() {
        return primaryColor.children().size()*100./EnumSet.allOf(super.getClass()).size();
    }
    private final PrimaryColor primaryColor;
}
public class Main{
    static double percent(final Tree tree) {
        final Tree parent=tree.parent();
        if (tree instanceof Enum) { return parent.children().size()*100./((Enum)tree).getClass().getEnumConstants().length; }
        else throw new RuntimeException("strange tree!");
    }
    public static void main(String[] args) {
        System.out.println("one way");
        for(PastelColor pastelColor:PastelColor.values())
            System.out.println(pastelColor+" "+pastelColor.percent());
        System.out.println("another way");
        for(PastelColor pastelColor:PastelColor.values())
            System.out.println(pastelColor+" "+percent(pastelColor));
    }
} 
```

# javascript - Jquery使用多行追加

> ID：574530
> 
> 赞同：0
> 
> 时间：2009-02-22T07:34:50.727
> 
> 标签：javascript, jquery

我一直在做一个项目，该项目使用从另一个站点调用的 ASP.NET 动态创建一个 javascript 文件。

这个 jquery javascript 文件附加了一个 div 并用一个相当大的 HTML 段填充它，为了做到这一点，我需要将段转换为这样的字符串：

```
$(document).ready(function(){   
var html = "Giving this magazine such a lofty epithet may seem a bit presumptuous, but for a non scientifically trained outsider this magazine offers a fresh and challenging look at the fast paced world of science that doesn't shy away from humor and the use of terms and ideas that may require its readers to go online and define a term. And in some cases it may inspire the reader to pick up a book on science by such greats as Hawking and Greene in order to better grasp some of the concepts dealing with time, space and atoms. This magazine isn't dumbed down. It includes well placed and efficient illustrations to help explain some of the more abstract points. It is not designed in the way popular magazinea are, in so much as they only touch upon a topic in the simplest manner and then move on before the audience is lost. Yet this magazine keeps the attention of the reader by combining explanatory notes that help people with no background knowledge have some grasp of the topic and by using humor and well written articles to clearly make their points. <br />For a magazine with a serious and well researched list of topics having small cartoons the likes of the New Yorker shows how comfortable this magazine is with itself. From the moment I picked up this magazine for the first time I felt like every word I read mattered and was worth my time to read. (Not true of many other magazines) American Scientist may not have the audience of Discover or National Geographic, nor is it as accessible as said titles, but for those with a true interest in science willing to challenge themselves and commit to real learning this magazine may be a perfect fit. At $4.95 it is certainly worth it to pick a copy on the news stand and try it out."

$("#divname").append(html);  
}); 
```

如您所见，该段将非常大，我无法知道它有多大，因为它是从我的数据库动态生成的，具体取决于用户在其请求中定义的 reviewID。

要插入到 div 中的 html 是评论列表，它是使用 asp.net MVC 由循环遍历列表的中继器生成的。（如果这有助于让您了解我在做什么）。

有没有办法把这个大段变成一个可以插入到附加脚本中的字符串？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T07:52:43.507

一些想法：

*   您可以用空格替换新行并创建一个巨大的行。应该没有问题。
*   使用字符串连接。拆分字符串和行并执行以下操作：

    var html = line1 + line2 + ... 亚麻布；

*   进行 Ajax 调用以填充 div：

    $("#divname").load(service_url);

您需要创建一个将返回字符串的服务。

在我看来，第三个选项比其他选项更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T08:58:30.183

跨域 jquery json
[http://docs.jquery.com/Release:jQuery_1.2/Ajax#Cross-Domain_getJSON_.28using_JSONP.29](http://docs.jquery.com/Release:jQuery_1.2/Ajax#Cross-Domain_getJSON_.28using_JSONP.29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T07:52:13.057

如果我错了，请纠正我，但我认为开始和结束引号之间的所有内容都将被视为该字符串的一部分，无论它有多少行。除非您的字符串本身有任何引号，在这种情况下，最好在 ASP 中对您的字符串执行相当于[php 的 addlashes()](http://php.net/addslashes)`\`函数，它应该在字符串的所有`"`标记之前添加一个。

另一个想法是使用 Json 对字符串进行编码/解码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T08:47:00.617

我看不出只生成一个大屁股长的单行字符串并像你正在做的那样附加它有什么问题。时期。完毕。Fancier不会给你带来任何好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T00:36:58.693

将它隐藏在页面上的其他位置并在需要时用它填充 div？

# c# - 使用 VS 2008 对内部类进行奇怪的单元测试

> ID：574532
> 
> 赞同：1
> 
> 时间：2009-02-22T07:38:09.720
> 
> 标签：c#, visual-studio-2008, unit-testing, intellisense

我正在启动一个项目，该项目分为多个 VS 项目，并且我计划为每个项目设置单独的测试项目，所以我有一个这样的解决方案：

*   项目1
*   项目1.测试
*   项目2
*   Project2.Test

`internal`我想测试一些课程。所以我使用 Visual Studio 2008 (SP1) 在我的测试项目中生成测试存根，并添加了`InternalsVisibleTo`. 但是我在内部类下得到了一条红色的波浪线。如果我编译我得到一个成功的构建，并且查看测试方法，红色曲线消失了。

但是，如果我对文件进行严格处理，那么曲线就会回来，并且我对内部类没有智能感知。

位于`internal`Project1 内，而测试位于 Project1.Test 内。为了完整起见，我决定以完全相同的方式生成测试方法，但这次是在 Project2.Test 中，这一次它被证明是完全有效的。我没有得到红色曲线，我得到智能感知，一切。

我已经尝试删除 Project1.Test 并重新创建测试方法，这是我能想到的一切，但无论我做什么，我都无法让内部在其配对的测试项目中*完全*可见，只能在*设计*的项目中为另一个项目。

我疯了，它不起作用！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T18:07:20.070

您是否可以在 InternalsVisibleTo 属性中使用字符串常量或除了确切的文字搅拌（不连接）以外的其他内容？我们习惯使用字符串常量来定义它，这对除了智能感知之外的所有东西都适用。通过粘贴为简单的字符串来替换它并且它可以工作。

删除您的 .suo 文件（与您的解决方案文件相同的文件夹）也可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T08:49:55.040

我也见过这种情况，尤其是在使用强名称时。老实说，我并没有兴奋。只要它正确编译和测试，我就可以忍受这个奇怪的故障。例如，如果您遇到*一个*构建问题，我看到它抱怨它找不到其他（内部）方法 - 但干净的构建显示没有错误。再说一次，我不会为此烦恼......（也许我太宽容了？）。

特别是，我*很少*需要在测试中使用内部类型/成员（大部分时间我会尝试通过公共 API 进行测试）；所以缺乏 100% 可靠的智能感知通常不是什么大问题。我已经知道我正在寻找的类型/成员（复制/粘贴；-p）。

当然，如果修复它会很好，但如果我是预算经理，我可能会接受它并首先关注其他功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T08:21:32.923

这可能是 IntelliSense DB 文件的问题。尝试删除它并让 VS 尝试重建数据库。

为此，请关闭解决方案并删除（全部？） .ncb 文件。为了安全起见，只需将它们重命名为 .nc4 之类的名称即可。重新打开解决方案并重建它。让我知道它是否有效。

**编辑：**显然，ncb 文件仅适用于 C++ 项目。我不知道 C# 项目的 IntelliSense DB 在哪里，也找不到。如果我是你，我仍然会尝试找到一种方法来重置数据库。

阿萨夫

# linux - 异步套接字连接如何报告错误？

> ID：574533
> 
> 赞同：7
> 
> 时间：2009-02-22T07:39:39.997
> 
> 标签：linux, posix, asynchronous, connect

我正在异步连接一个套接字（O_NONBLOCK + connect）。POSIX 标准规定，在连接套接字后，应该通过使套接字的文件描述符准备好写入来发出事件信号。它似乎没有说明异步连接期间的失败。

在 Linux 上对其进行测试时，在这种情况下，有时我会得到 POLLOUT，有时会出现 POLLERR。行为中有什么模式吗？我可以让它以单一方式报告错误吗？POSIX 是否说了我忽略的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T11:10:57.820

DJ Bernstein 有一些看起来可能相关的东西： http: [//cr.yp.to/docs/connect.html](http://cr.yp.to/docs/connect.html)。特别是他提出了几种不同的方法来消除错误。

UNIX Socket FAQ 有一个关于[Connect with timeout](http://www.developerweb.net/forum/showthread.php?t=3196)的部分，其中包括使用失败的连接获取错误`getsockopt`

# visual-c++ - 从 Visual C++ 项目查看汇编级代码

> ID：574536
> 
> 赞同：1
> 
> 时间：2009-02-22T07:42:18.633
> 
> 标签：visual-c++

哪个项目设置可以让我看到 Microsoft Visual C++ 2005 中生成的汇编级代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T07:47:10.353

项目属性页 > C/C++ > 输出文件 > 汇编器输出（然后选择）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T07:47:30.820

如果调试然后查看-> 反汇编。

# feed - 如何使用 ROME 将链接标识为 RSS Feeds 链接？

> ID：574539
> 
> 赞同：0
> 
> 时间：2009-02-22T07:43:32.483
> 
> 标签：feed, rome

我正在使用 ROME 库来解析提要。我想知道如何将链接识别为 XML 链接或普通链接。在 ROME 中是否对此提供支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-21T23:22:20.580

听起来您是在说您将从某个地方（RSS 提要内容或其他内容）获得一堆链接。然后，您需要检查它们并确定它们是 RSS/Atom 提要还是常规 HTML 页面。

您可能会尝试使用 Rome 获取它，然后查看它是否引发异常。更好的选择可能是在每个链接的末尾拉入文档并查看标题中的内容。

请记住，如果有人链接到一个非常大的文件，则检索每个链接可能会遇到问题。

在下载整个内容之前，您可能会考虑使用 HEAD 命令找出链接末尾要获取的文件类型。

# c++ - 将所有程序输出写入 C++ 中的 txt 文件

> ID：574543
> 
> 赞同：8
> 
> 时间：2009-02-22T07:50:24.543
> 
> 标签：c++, file-io

我需要将所有程序输出写入文本文件。我相信它是这样做的，

```
sOutFile << stdout; 
```

其中 sOutFile 是创建文件的 ofstream 对象，如下所示：

```
sOutFile("CreateAFile.txt" ); // CreateAFile.txt is created. 
```

当我将标准输出插入到 sOutFile 对象中时，我得到了一些看起来像的代码~~八进制~~[十六进制] 代码或我创建的文本文件中的某种地址。

```
0x77c5fca0 
```

但令我困惑的是，在我的程序中，我多次使用 cout。大多只是字面上的陈述。如果我没记错的话，那就是程序输出。

如果此代码是一个地址，它会包含我的所有输出吗？我可以把它读回到程序中并找出那个方法吗？

我该怎么做才能将我的所有程序输出写入文本文件？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-22T07:53:29.370

如果您的程序已经使用 cout/printf 并且您想将当前输出的所有内容发送到文件，您可以简单地将 stdout 重定向到在现有调用之前指向文件：http: [//support.microsoft.com/kb/58667](http://support.microsoft.com/kb/58667)

相关代码：

```
freopen( "file.txt", "w", stdout );
cout << "hello file world\n"; // goes to file.txt
freopen("CON", "w", stdout);
printf("Hello again, console\n"); // redirected back to the console 
```

或者，如果您只想将某些内容打印到文件中，您只需要常规文件输出流：[http ://www.cplusplus.com/doc/tutorial/files.html](http://www.cplusplus.com/doc/tutorial/files.html)

相关代码：

```
ofstream myfile;
myfile.open("file.txt");
myfile << "Hello file world.\n";
printf("Hello console.\n");
myfile.close(); 
```

编辑以汇总 John T 和 Brian Bondy 的答案：
最后，如果您从命令行运行它，您可以使用重定向运算符“>”或附加“>>”来重定向输出，就像其他人提到的那样：

```
myProg > stdout.txt 2> stderr.txt 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-22T08:01:07.357

这是一个副本：[这个问题](https://stackoverflow.com/questions/573724/how-can-i-redirect-stdout-to-some-visible-display-in-a-windows-application/573733)

您可以使用重定向标准输出、标准错误和标准输入[`std::freopen`](http://en.cppreference.com/w/cpp/io/c/freopen)。

从上面的链接：

```
/* freopen example: redirecting stdout */
#include <stdio.h>

int main ()
{
  freopen ("myfile.txt","w",stdout);
  printf ("This sentence is redirected to a file.");
  fclose (stdout);
  return 0;
} 
```

您还可以通过命令提示符运行程序，如下所示：

```
a.exe > stdout.txt 2> stderr.txt 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-22T07:53:08.797

如果您希望所有输出都在文本文件中，则无需编写任何额外代码。

从命令行：

```
program > output.txt 
```

如果您只想重定向某些输出，您可以按照直接建议使用 ostream。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-22T07:54:10.243

然后，您不能在其他任何地方使用 std::cout 来打印程序中的内容。将 std::cout 更改为 std::ostream ，然后根据需要传递您的文件或 std::cout 。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-22T07:59:42.790

```
sOutFile << stdout; 
```

在 C 中“ `stdout`”被定义为一个`FILE*`变量。这只是一个指针。将其输出到文件只是将指针的值写入文件，在您的情况下：`0x77c5fca0`写入文件。

如果要将输出定向到文件，请首先将其写入文件或使用命令行将程序的输出重定向到文件。

# sql-server - 高效事务，记录锁定

> ID：574549
> 
> 赞同：5
> 
> 时间：2009-02-22T07:57:03.917
> 
> 标签：sql-server, transactions, locking

我有一个存储过程，它选择了 1 条记录。可以从不同 PC 上的多个不同应用程序调用存储过程。想法是存储过程带回下一条需要处理的记录，如果两个应用程序同时调用存储过程，不应该带回相同的记录。我的查询在下面，我正在尝试尽可能高效地编写查询（sql 2008）。它可以比这更有效地完成吗？

```
CREATE PROCEDURE GetNextUnprocessedRecord
AS
BEGIN
    SET NOCOUNT ON;

    --ID of record we want to select back
    DECLARE @iID BIGINT     

    -- Find the next processable record, and mark it as dispatched
    -- Must be done in a transaction to ensure no other query can get
    -- this record between the read and update
    BEGIN TRAN

        SELECT TOP 1
            @iID = [ID]
        FROM
            --Don't read locked records, only lock the specific record
            [MyRecords] WITH (READPAST, ROWLOCK)
        WHERE
            [Dispatched] is null
        ORDER BY
            [Received]

        --Mark record as picked up for processing   
        UPDATE 
            [MyRecords]
        SET
            [Dispatched] = GETDATE()
        WHERE
            [ID] = @iID     

    COMMIT TRAN

    --Select back the specific record
    SELECT 
        [ID],
        [Data]
    FROM    
        [MyRecords] WITH (NOLOCK, READPAST)
    WHERE
        [ID] = @iID

END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T16:08:32.630

使用 READPAST 锁定提示是正确的，并且您的 SQL 看起来没问题。

我会添加使用 XLOCK 虽然它也是 HOLDLOCK/SERIALIZABLE

```
...
[MyRecords] WITH (READPAST, ROWLOCK, XLOCK)
... 
```

这意味着您获得了 ID，并在您继续并更新它时专门锁定该行。

编辑：在 Dispatched 和 Received 列上添加索引以使其更快。如果 [ID]（我假设它是 PK）未聚集，则包括 [ID]。并过滤索引，因为它是 SQL 2008

你也可以使用这个结构，它可以在没有 XLOCK 或 HOLDLOCK 的情况下一次性完成

```
UPDATE
    MyRecords
SET
    --record the row ID
    @id = [ID],
    --flag doing stuff
    [Dispatched] = GETDATE()
WHERE
    [ID] = (SELECT TOP 1 [ID] FROM MyRecords WITH (ROWLOCK, READPAST) WHERE Dispatched IS NULL ORDER BY Received) 
```

[更新，分配，集于一身](http://msdn.microsoft.com/en-us/library/ms177523.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T08:37:46.410

您可以为每个选择器进程分配一个唯一的 ID，并将列 pickerproc 和 pickstate 添加到您的记录中。然后

> UPDATE MyRecords
> SET pickerproc = myproc,
> pickstate = 'I' -- for 'I'n process
> WHERE Id = (SELECT MAX(Id) FROM MyRecords WHERE pickstate = 'A') -- 'A'vailable

这让您在一个原子步骤中获得您的记录，您可以在闲暇时完成其余的处理。然后，您可以将 pickstate 设置为 'C'complete'、'E'rror 或任何解决问题时的值。

我认为 Mitch 指的是另一种好的技术，您可以创建一个消息队列表并在其中插入 Id。有几个 SO 线程 - 搜索“消息队列表”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T13:12:50.507

您可以将 MyRecords 保存在“MEMORY”表中以加快处理速度。

# sql-server - SQLServer 尝试捕获性能

> ID：574564
> 
> 赞同：11
> 
> 时间：2009-02-22T08:16:38.677
> 
> 标签：sql-server, try-catch

有没有人发现在 sql server 2008 中使用 BEGIN TRY..END TRY 与旧的 IF @@ERROR <> 0 相比有任何性能提升/折衷？只是想知道是否存在性能损失。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T08:46:21.257

由于数据库磁盘命中问题是相同的，因此应该没有明显的性能问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T08:19:36.750

从 SQL 2005 开始，您应该尝试使用 TRY CATCH 方式来处理异常或记录错误。它被认为是最佳实践。使用它应该不会对性能造成重大影响。

```
BEGIN TRY
    BEGIN TRANSACTION
    -- SQL 
    COMMIT TRANSACTION
END TRY
BEGIN CATCH
    ROLLBACK
    SELECT
        ERROR_MESSAGE(),
        ERROR_NUMBER() -- etc
END CATCH 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-12T23:58:16.373

这是一个老问题，但在 2012 年，Aaron Bertrand 写了一篇详细的文章[Performance Impact of different error handling techniques](http://sqlperformance.com/2012/08/t-sql-queries/error-handling)，他比较了 SQL Server 中处理异常的几种方法，我认为这里值得一提。

他说，人们用来处理异常的主要方法是：

> *   只需让引擎处理它，并将任何异常返回给调用者。
> *   使用`BEGIN TRANSACTION`和`ROLLBACK`如果`@@ERROR <> 0`。
> *   在块中使用`TRY/CATCH`with (SQL Server 2005+)。`ROLLBACK``CATCH`
> 
> 许多人采取的方法是，他们应该首先检查他们是否会发生违规，因为自己处理重复项似乎比强迫引擎去做更干净。

他的结论是：

> 如果我们认为我们的故障率很高，或者不知道我们的潜在故障率是多少，那么首先检查以避免引擎中的违规行为将非常值得我们花时间。即使在我们每次都成功插入的情况下，首先检查的成本也是微不足道的，并且很容易通过以后处理错误的潜在成本来证明（除非您的预期失败率恰好是 0%）。

这是文章中的图表：

[![概括](https://i.stack.imgur.com/uYSN9.png)](https://i.stack.imgur.com/uYSN9.png)

```
CheckInsert    |  Checks `IF EXISTS` first  |  Simple `INSERT`
CheckRollback  |  Checks `IF EXISTS` first  |  Use `IF @@ERROR <> 0`
CheckTryCatch  |  Checks `IF EXISTS` first  |  Use `TRY CATCH`
JustInsert     |                            |  Simple `INSERT`
JustRollback   |                            |  Use `IF @@ERROR <> 0`
JustTryCatch   |                            |  Use `TRY CATCH` 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T16:23:26.430

忘记性能吧，这该死的景象更安全、更好、更可预测。

但是，使用@@ERROR 通常需要一个 GOTO 和/或大量 IF 语句才能正确管理它，所以我猜想 TRY..CATCH 可能会有微小的提升。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T23:18:06.310

在没有错误的情况下，TRY ... CATCH 的性能很可能会多一点。另一方面，在许多有错误的情况下，它会更快。

但是，无论如何，您都不应该为性能而严格编码。而且，开销（如果有的话）将会相当小，所以在这种情况下我不会为了性能而牺牲更安全的语法。

此外，Try ... Catch 使代码更易于维护，特别是如果您的 SQL 开发团队使用 SQL Server 的时间不长，不幸的是，这种情况经常发生。我想几年后这种情况会更多。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2010-02-02T15:38:33.643

*   [速度测试：Try / Catch Block](http://www.blackwasp.co.uk/SpeedTestTryCatch.aspx)
*   [try...catch 块会损害运行时性能吗？](http://www.programmersheaven.com/user/pheaven/blog/175-Do-trycatch-blocks-hurt-runtime-performance/)

# html - 2009 年 1 月 Microsoft 更新破坏了 IE7 中的 mp3 声音对象

> ID：574565
> 
> 赞同：0
> 
> 时间：2009-02-22T08:18:29.187
> 
> 标签：html, browser, internet-explorer-7

我维护的几个网站在页面中使用 HTML 音频/mp3 对象。他们过去常常工作，但后来出了点问题。如果客户端浏览器是 IE，则页面依赖于 Windows Media Player。

大约一个月前，该对象将显示为 WMP 控件。它应该看起来像[这样](http://www.calgarydj.ca/img/wmp.jpg) [（来源：][[calgarydj.ca](http://calgarydj.ca/img/wmp.jpg)][）][![替代文字](https://i.stack.imgur.com/ksTlf.jpg "wmp控制")](https://i.stack.imgur.com/ksTlf.jpg "wmp控制")

但现在出现的东西就像一个邮筒，附有一个小滚动条。
点击此[链接](http://calgarydj.ca/img/badSoundObjects.jpg)查看。 [（来源：][[calgarydj.ca](http://calgarydj.ca/img/wmp2.jpg)][）][![替代文字](https://i.stack.imgur.com/smW93.jpg)](https://i.stack.imgur.com/smW93.jpg)

我认为这种变化**可能**发生在*2009 年 1 月的 Microsoft 更新*中。

我已经搜索了答案，但只找到了一个关于此的其他问题。我看过其他一些有相关问题的网站。这是[另一个](http://joliclic.free.fr/html/object-tag/en/)似乎遇到相同问题的站点 - 请参阅[此页面](http://joliclic.free.fr/html/object-tag/en/object-audio.html#mp3)以获取音频示例。

1.  有没有其他人遇到过这个问题？Windows XP 上的 IE7（2 个系统）
2.  这发生在 Vista 上还是 XP 上（或者只是我的 2 个系统）？
3.  有解决办法吗？

这是典型声音对象的 html

```
<div class="music">
  <p>Pachelbel's Canon</p>
  <object id="Cannon" type="audio/mpeg" data="./sound%20files/Pachebels%20Cannon.mp3" width="250" height="16">
    <param name="autoplay" value="false" />
    <param name="src" value="./sound files/Pachebels%20Cannon.mp3" />
    <object id="Cannon" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" width="250" height="50">
      <param name="autostart" value="false" />
      <param name="url" value="./sound%20files/Pachebels Cannon.mp3" />
      <param name="showcontrols" value="true" />

      <param name="volume" value="100" />
    </object>
  </object>
</div><!-- end of control --> 
```

这是一个很酷的网站。但我试图在这篇文章中添加图片，但这些图片从未出现在最后一篇文章中。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T12:13:51.197

所以我最终使用**IE 条件注释**（啊！）来解决这个问题。这很丑陋，但它有效。它甚至*验证*为**XHTML**。

仍然有 2 个嵌套对象，但现在 IE 条件注释包装器隐藏了第一个对象，因此 IE 看​​不到它，只有第二个。 *Firefox、Safari*和*Chrome*会看到第一个对象并使用*Quicktime*插件（如果已安装）来呈现控件。

其他浏览器会忽略 IE 条件注释，因为它们看起来像一个常规的打开/关闭的注释块，中间有点乱码。

注意：*下面的注释行周围的勾号（`）不属于那里，但是您需要做一些必要的事情来解决这里的问题。*

```
`<!--[if !IE]>-->`
  <object id="Cannon" type="audio/mpeg" data="./sound%20files/Pachebels%20Cannon.mp3" width="250" height="16">
    <param name="autoplay" value="false" />
    <param name="src" value="./sound files/Pachebels%20Cannon.mp3" />
`<!--<![endif]>-->`
  <object id="Cannon" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" width="250" height="60">
      <param name="autostart" value="false" />
      <param name="url" value="./sound%20files/Pachebels Cannon.mp3" />
      <param name="showcontrols" value="true" />
      <param name="volume" value="100" />
`<!--[if !IE]>--></object><!--<![endif]-->`
</object> 
```

不久前，IE7 过去常常忽略音频/mpeg 类型的对象，除非它们具有适用于 Windows Media Player (WMP) 的合法 CLSID 标签。由于第二个对象（在我以前的模型中）确实有一个 CLSID，IE 将呈现一个 WMP 控件，一切都只是鸭子。其他浏览器将简单地识别第一个对象并使用 Quicktime 插件进行声音控制。

2008 年 12 月 9 日，Microsoft 发布了另一个 Windows Media Player 安全更新。一切仍然像以前一样工作（对我来说）。随后于 2009 年 1 月 13 日进行了另一次更新，部分目的是修补 12 月 9 日的 WMP 更新。（见[这篇文章](http://mcpmag.com/news/rss.asp?editorialsid=1739)）。那是事情停止工作的时候（在 IE 上）。

现在 IE7（在 XP 上）将*无类*对象呈现为看起来像带有滚动条的邮槽的东西。它们与 LCD 屏幕上的邮件槽一样有用。并且 IE 浏览器满意地完成了它的工作，忽略了嵌套在其中的具有正确 CLSID 的第二个对象。

所以 IE 自己的*条件注释*让我摆脱了困境，但微软却在自己的浏览器中发挥了作用！为什么选择微软？为什么？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-22T15:18:19.193

我强烈建议使用 Adob​​e Flash 在网站上播放音乐。与使用 Windows Media Player 等外部播放器相比，它几乎是防弹的，而且您还可以完全控制播放器的外观。

# java - 序列化的对象构造 - 首选哪个？

> ID：574569
> 
> 赞同：0
> 
> 时间：2009-02-22T08:23:21.093
> 
> 标签：java, parsing, oop

假设您有一个类`SomeClass`，它有自己的 实现`toString()`，并且还能够通过读取相同的字符串来解析自身的新实例。

您更喜欢这些方法中的哪一种，或者发现更好用？您可以将其定义为另一个构造函数：

```
public SomeClass(String serializedString); 
```

或者您可以将其定义为静态方法，该方法反过来创建一个新实例（由其他构造函数之一，对其进行一些处理，然后返回新实例：

```
public static SomeClass toObject(String serializedString); 
```

这还重要吗？（我的预感是这无关紧要，但我正在努力确保）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T08:27:17.667

我自己的偏好是将解析逻辑排除在构造函数之外。这样它就可以根据需要调用适当的构造函数（可能是私有的）。它不必依赖于默认对象构造等。所以我会使用 toSomeClass() 方法。

此外，目前尚不清楚 SomeClass(String) 是否会根据序列化字符串解析对象。接受 String 的构造函数可能还有许多其他含义。toSomeClass() 静态方法清楚地说明了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T19:31:36.557

我同意 Avi 的建议。我想再补充两个优点：

*   静态工厂方法允许您返回 null，而构造函数不能。
*   静态工厂方法允许您返回其定义的返回类型的子类，这有助于提供前向兼容性。

一个例外：如果您正在编写一个简单的值类型并使用不可变模式，我认为没有理由使用静态工厂方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T08:28:49.380

静态方法的优点是您可以将字符串读取构造函数用于其他用途。此外，通常在任何非平凡类中使用静态工厂比使用构造函数要好。它为您提供更大的灵活性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T20:08:25.890

A Java convention for such static methods is:

```
public class Foo {
    // ...
    public Foo parseFoo (String s) {...}
    // ...
} 
```

as in the standard `parseInt(`...`)`, `parseLong(`...`)`, `parseDouble(`...`)`, etc. Unfortunately, Sun also gave us a *different* convention with the wrapper classes, as in `Boolean.valueOf(`...`)`. However, I'd pick one of those conventions and follow it consistently.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T08:37:46.473

将某些特定逻辑（如从字符串解析）排除在构造函数之外是很好的设计策略。

构造函数的工作主要是对象创建。它的字段的初始化和创建。

序列化逻辑需要与创建分离。首先，您可能不想创建单独的静态方法，其次在您的类的演变中，您可能希望实现某种 Serializable 接口并将读/写工作委托给另一个类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T20:02:25.827

Another advantage to a static constructor is that you can give it a meaningful name. In this case, I would suggest `parse`:

```
SomeClass inst = SomeClass.parse("wibble"); 
```

# ruby-on-rails - 在 Rails 2.2.2 中动态向 ActiveRecord 模型添加字段？

> ID：574570
> 
> 赞同：3
> 
> 时间：2009-02-22T08:23:21.953
> 
> 标签：ruby-on-rails

假设我想允许管理用户通过 Rails 应用程序中的界面向 ActiveRecord 模型添加字段。我相信正常的 ActiveRecord::Migration 代码足以修改 AR 模型的表结构（这对于许多应用程序来说是不明智的——我知道）。当然，只能添加某些类型的字段……理论上。

显然，向这个新修改的 ActiveRecord 模型添加（或编辑）记录的表单需要在运行时动态构建。一个常见的 form_for 方法是行不通的。这个讨论表明这只能通过 JavaScript 来完成。

[http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/fc0b55fd4b2438a5](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/fc0b55fd4b2438a5)

我过去使用 Ruby 来查询对象的可用方法。我似乎记得它非常慢。我对 Ruby 和 Rails 太熟悉了，不知道有一种优雅的方法来解决这个问题。我希望这里有人可以。我也对不涉及修改数据库的这个问题的完全不同的方法持开放态度。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T09:15:34.807

要访问当前为模型定义的列，请使用[columns](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002239)方法 - 它会为您提供每一列的名称、类型和其他信息（例如它是否是主键等）

但是，在运行时修改模式是很微妙的。

模式在首次加载时由每个模型类预加载（并从 DB 驱动程序缓存）。在`production`mode 下，Rails 只在每个模型启动时执行*一次。*

1.  为了强制 Rails 在修改后刷新其缓存模式，您应该强制 Ruby 重新加载受影响模型的类（几乎是 Rails 在每次请求后自动为您做的事情，在`development`模式下运行时 - 了解[如何使用重新加载类`remove_const`紧随其后`load`](http://hildolfur.wordpress.com/2006/10/29/class-reloading-in-ruby/)。）
2.  如果你有一个 Mongrel 集群，你还必须通知集群中的其他进程，这些进程在它们自己的单独内存空间中运行，也重新加载它们的模型类（一些集群将允许你创建一个“restart.txt”文件，这将导致集群中的所有进程自动软重启，而无需代表您进行额外的工作。）

现在，已经说了这些，根据您需要解决的实际问题，您可能根本不需要动态更改架构。您可以使用一个名为, where Entry和 where的表，而不是添加，比如说，columns ，`col1`and`col2`到某个`col3`表（`entries`模型）等的对应值）`Entry``dyn_attribs``has_many :dyn_attribs``dyn_attribs``key``col1``col2``col3``value``col1``col2`

因此，而不是：

```
my_entry = Entry.find(123)
col1 = my_entry.col1
#do something with col1 
```

你会使用：

```
my_entry = Entry.find(123, :include => :dyn_attribs)
dyn_attribs = my_entry.dyn_attribs.inject(HashWithIndifferentAccess.new) { |s,a|
  s[a.key] = a.value ; s
}
col1 = dyn_attribs[:col1]
#do something with col1 
```

上述`inject`调用可以分解到模型中，甚至可以分解到由所有模型继承的基类中，这些模型可能需要额外的动态列/属性（请参阅[多态关联](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)，了解如何使多个模型共享同一个`dyn_attribs`表以获得动态属性。）

* * *

**更新**

通过常规 HTML 表单添加或重命名列。

假设您有一个`DynAttrTable`模型来表示具有动态属性的表，以及`DynAttrDef`定义给定表的动态属性名称。

跑：

```
script/generate scaffold_resource DynAttrTable name:string
script/generate scaffold_resource DynAttrDef name:string
rake db:migrate 
```

然后编辑生成的模型：

```
class DynAttrTable < ActiveRecord::Base
  has_many :dyn_attr_defs
end

class DynAttrDef < ActiveRecord::Base
  belongs_to :dyn_attr_table
end 
```

您可以继续编辑[本教程中](http://ariejan.net/2007/01/23/rails-nested-resource-scaffold/)的控制器和视图，替换`Recipe`为`DynAttrTable`和`Ingredient`。`DynAttrDef`

**或者，使用**[此处审查](http://www.joesniff.co.uk/critique/rails-admins-plugins-review.html)的插件之一，通过自动化界面（及其所有花里胡哨）自动将`dyn_attr_tables`和表置于管理之下，代表您的实施工作几乎为零。`dyn_attr_defs`

这应该让你继续前进。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T22:34:15.697

> 假设我想允许管理用户通过 Rails 应用程序中的界面向 ActiveRecord 模型添加字段。

我之前通过一个名为 AdminAdditions 的额外模型解决了这类问题。该表包括一个 id、一个管理员用户 id、一个模型名称字符串、一个类型字符串和一个默认值字符串。

我覆盖模型的查找和保存方法以从其 admin_additions 添加属性，并在更改时适当地保存它们。模型表有一个很大的文本字段，最初是空的，我在其中保存了添加属性的非默认值。

本质上，视图和控制器可以假装模型的每个属性都有自己的列。这意味着`form_for`等等所有的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-16T12:04:01.653

ActiveRecord::Migration.add_column(User, "email", :string)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T08:52:27.000

您可以为此使用[Flex 属性](http://agilewebdevelopment.com/plugins/flex_attributes)，但如果您希望能够通过这些新列进行搜索或排序，则必须编写（大量）自定义 SQL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-22T09:06:54.343

我已经多次看到作为解决方案提供的表的动态更改/迁移，但我从未真正看到它实现过。这种解决方案很少实施的原因有很多。

*   如果桌子很大，那么桌子可能/将被锁定一段应该正常运行的时间。
*   为什么你的模型是动态变化的？模型结构很少需要动态更改。这通常表明您正在尝试以通用方式对特定事物进行建模。
*   这通常是一种尝试生成“分类”模型，而不是通过另一种方法更好地解决。
*   用于日常 DML 需求的同一用户通常不允许使用 DDL 语句。虽然这可能是这种情况，并且通常是在 ROR 领域，但它并不总是“正确”的方式来做到这一点。

你想在这里达到什么目的？更好地理解这个问题可能会揭示一个更自然的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-16T22:27:19.613

如果您现在使用 PostgreSQL 执行此操作，您可能可以使用 JSON 类型字段，然后将任何内容存储在 json 哈希中。

# javascript - Javascript - 检查方法原型是否已更改？

> ID：574584
> 
> 赞同：4
> 
> 时间：2009-02-22T08:34:09.243
> 
> 标签：javascript, prototype, methods

检查方法的原型是否已更改的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T09:52:52.533

如果您的意思是在加载代码时和稍后的某个时间之间发生更改，这取决于您所说的“更改”的含义，您可以只存储对该函数的引用，a la

```
var oldFunc = SomeType.prototype.someFunction;
...
if (oldFunc === someInstance.someFunction) // unchanged, note the use of strict equality 
```

但是，如果您的意思是从默认的本机实现更改，则没有真正的方法可以说明。

# asp.net-mvc - Html.RenderAction。为什么它不包含在 MVC RC1 中？

> ID：574586
> 
> 赞同：3
> 
> 时间：2009-02-22T08:35:44.200
> 
> 标签：asp.net-mvc

我在使用 Html.RenderAction 与 Html.RenderPartial 进行局部视图的想法之间纠结。使用 RenderPartial 意味着操作和传递 ViewModel，我觉得很麻烦。在这种情况下，RenderAction 简洁明了，但不包含在 RC1 中（尽管包含在期货中）。

为什么会这样？有什么具体原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T09:30:07.157

据我所知，他们决定将其移至 futures 程序集，因为他们希望尽快发布框架的第一个版本，并且 RenderAction 存在一些问题（[这里是一个示例](http://weblogs.asp.net/rashid/archive/2009/02/14/asp-net-mvc-rc1-validateinput-a-potential-dangerous-request-and-the-pitfall.aspx)）。并且 RenderAction 计划包含在 asp.net mvc 版本 2 中。在我看来，最好使用 MvcContrib 中的 SubController 而不是 RenderAction。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T02:54:40.167

还有其他不明显的晦涩“问题”，例如在子控件及其父控件上调用 POST 操作 - 当子控件由 RenderAction 呈现时。

[我在这里](https://stackoverflow.com/questions/523695/)发了一篇关于它的帖子。

虽然可以说这种行为是设计使然，但它至少是令人困惑和烦人的，并且最多可能是危险的，如果您不保持警惕，可能会导致严重的应用程序错误。

我几乎已经恢复到 RenderPartial，尤其是在该操作有 POST 操作的情况下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T09:04:10.917

我不知道它被转移（进入“期货”）的原因；*猜测*是为了让它不那么“明显”，因为它比 RenderPartial 成本更高（模拟更多的管道等）。

# vba - 调试错误的 DLL 调用约定

> ID：574587
> 
> 赞同：17
> 
> 时间：2009-02-22T08:37:37.283
> 
> 标签：vba, ms-access, dll

如何调试 MSAccess VBA 代码中的错误 DLL 调用约定错误？

我对模块中的函数进行了一些更改，然后出现错误。如何调试它以找到原因？

该错误发生在函数的 Exit 函数语句上。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2011-02-16T12:00:09.710

我以前在 Excel 中看到过这个，没有任何外部引用。与您的问题一样，它发生在 Exit Function 调用中。Excel 似乎没有 /decompile 选项，但我通过在我的一个类模块中进行更改，从“调试”菜单执行编译，然后撤消更改来修复它。我怀疑我的一个类模块由于某种原因编译错误，并且 Excel 不会重新编译，除非它认为某些内容发生了变化。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-25T20:53:27.973

你检查过你的参考资料并反编译了吗？

```
"C:\Program Files\Microsoft Office\Office\MSACCESS.EXE" 
                                "d:\My Documents\access\mayapp.mdb" /decompile 
```

另见：
[http ://www.granite.ab.ca/access/decompile.htm](http://www.granite.ab.ca/access/decompile.htm)
[VBScript 反编译](http://wiki.lessthandot.com/index.php/Decompile)

* * *

检查代码中的引用

```
Dim ref As Reference
Dim sMsg As String

''Available since 2010
If BrokenReference Then
    For Each ref In References
        ''Available since at least 2000
        If ref.IsBroken Then
            sMsg = sMsg & "Ref Name: " & ref.Name
            'Also, if required
            'sMsg = sMsg & vbCrLf & "Built In: " & ref.BuiltIn
            'sMsg = sMsg & vbCrLf & "Full Path: " & ref.FullPath
            'sMsg = sMsg & vbCrLf & "GUID: " & ref.Guid
            'sMsg = sMsg & vbCrLf & "Kind: " & ref.Kind
            'sMsg = sMsg & vbCrLf & "Major (version number): " & ref.Major
            'sMsg = sMsg & vbCrLf & "Minor (version number): " & ref.Minor
            sMsg = sMsg & vbCrLf & "=================================" & vbCrLf
        End If
    Next
    MsgBox sMsg
End If 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-06T10:44:26.390

我使用MS Access VBA[中的 WinSCP .NET 库](http://winscp.net/eng/docs/library_vb#example)体验并解决了这个错误。

发生的事情是：

1.  `UploadSomething`连接到 SFTP 服务器和上传文件的功能运行良好。
2.  在函数`UploadSomething`中，使用以下代码更改了“恢复支持”选项：`myTransferOptions.ResumeSupport.State = TransferResumeSupportState.TransferResumeSupportState_Off`

更改后，代码按预期工作。然而，在*调用* `UploadSomething`的代码中，函数完成后抛出了错误 49。

该错误发生在使用调试器单步执行代码时以及在调试器之外立即执行时。重新编译项目对我不起作用。

起作用的是：

1.  移除对 COM 组件的引用
2.  添加对 COM 组件的引用
3.  重新编译

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-20T00:36:08.857

在 Excel VBA 中，这可能是由以下几个问题中的任何一个引起的：

1.  参数或返回值类型不匹配。
2.  应用于该方法不可用的错误对象变体的对象方法（例如 AutoFit）。
3.  对外部库函数的调用。
4.  损坏的库引用

有关这些原因的解决方法，请参阅我的帖子：[运行时错误 49，错误的 DLL 调用约定](https://stackoverflow.com/questions/15758834/runtime-error-49-bad-dll-calling-convention)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-13T15:51:22.247

我刚刚在 Excel 中得到了这个，想知道是否有其他人以前得到过它。我的解决方案是移动对我自己的 DLL 的引用，然后单击“编译 <项目>”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-01T07:13:12.287

在尝试调用在 Intel Fortran 中编译的 DLL 时，我们遇到了 VBA 的一些问题。事实证明，您需要将调用约定与编译器标志调用约定对齐回“C”上下文***：cfv***

[英特尔网站](https://software.intel.com/en-us/forums/topic/298583)上的更多信息关于 同一问题的另一个有用线程：[英特尔 Fortran DLL <-> C](https://software.intel.com/en-us/forums/topic/276310)

# mysql - 另一个 mysql 减号问题

> ID：574593
> 
> 赞同：2
> 
> 时间：2009-02-22T08:42:31.843
> 
> 标签：mysql

我正在努力实现以下目标：

```
SELECT id, name FROM t_profiles MINUS (SELECT p.id, p.name FROM t_profiles AS p LEFT JOIN t_skills AS s ON p.id = s.id_employee WHERE s.lvl>0 and s.id_task=1) 
```

在 MySQL 中是否有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T09:04:31.260

```
SELECT id, name FROM t_profiles 
WHERE id not in 
   (SELECT p.id FROM t_profiles AS p 
    LEFT JOIN t_skills AS s ON p.id = s.id_employee 
    WHERE s.lvl>0 and s.id_task=1) 
```

应该做的伎俩。

# java - 如何使用 Maven 创建具有依赖关系的可执行 JAR？

> ID：574594
> 
> 赞同：2709
> 
> 时间：2009-02-22T08:43:45.460
> 
> 标签：java, maven-2, build-process, build-automation, executable-jar

我想将我的项目打包在一个可执行的 JAR 中以进行分发。

如何使 Maven 项目将所有依赖项 JAR 打包到我的输出 JAR 中？

* * *

## 回答 #1

> 赞同：2650
> 
> 时间：2009-02-22T09:31:28.857

```
<build>
  <plugins>
    <plugin>
      <artifactId>maven-assembly-plugin</artifactId>
      <configuration>
        <archive>
          <manifest>
            <mainClass>fully.qualified.MainClass</mainClass>
          </manifest>
        </archive>
        <descriptorRefs>
          <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
      </configuration>
    </plugin>
  </plugins>
</build> 
```

你运行它

```
mvn clean compile assembly:single 
```

*编译目标应该在 assembly:single 之前添加，否则不包括您自己项目中的代码。*

在评论中查看更多详细信息。

* * *

通常，此目标与自动执行的构建阶段相关联。这可确保在执行`mvn install`或执行部署/发布时构建 JAR。

```
<build>
  <plugins>
    <plugin>
      <artifactId>maven-assembly-plugin</artifactId>
      <configuration>
        <archive>
          <manifest>
            <mainClass>fully.qualified.MainClass</mainClass>
          </manifest>
        </archive>
        <descriptorRefs>
          <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
      </configuration>
      <executions>
        <execution>
          <id>make-assembly</id> <!-- this is used for inheritance merges -->
          <phase>package</phase> <!-- bind to the packaging phase -->
          <goals>
            <goal>single</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：386
> 
> 时间：2010-12-01T10:46:24.403

您可以在打包阶段之前使用依赖插件在单独的目录中生成所有依赖项，然后将其包含在清单的类路径中：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
        <execution>
            <id>copy-dependencies</id>
            <phase>prepare-package</phase>
            <goals>
                <goal>copy-dependencies</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.build.directory}/lib</outputDirectory>
                <overWriteReleases>false</overWriteReleases>
                <overWriteSnapshots>false</overWriteSnapshots>
                <overWriteIfNewer>true</overWriteIfNewer>
            </configuration>
        </execution>
    </executions>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <configuration>
        <archive>
            <manifest>
                <addClasspath>true</addClasspath>
                <classpathPrefix>lib/</classpathPrefix>
                <mainClass>theMainClass</mainClass>
            </manifest>
        </archive>
    </configuration>
</plugin> 
```

或者使用`${project.build.directory}/classes/lib`作为 OutputDirectory 将所有 jar 文件集成到主 jar 中，但是您需要添加自定义类加载代码来加载 jar。

* * *

## 回答 #3

> 赞同：294
> 
> 时间：2014-06-02T03:01:53.313

请参阅[可执行的 jar-with-maven-example](https://github.com/jinahya/executable-jar-with-maven-example) (GitHub)

## 笔记

这些优点和缺点由[Stephan](https://stackoverflow.com/users/363573/stephan)提供。

* * *

## 对于手动部署

*   优点
*   缺点
    *   依赖项不在最终的 jar 中。

### 将依赖项复制到特定目录

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-dependency-plugin</artifactId>
  <executions>
    <execution>
      <id>copy-dependencies</id>
      <phase>prepare-package</phase>
      <goals>
        <goal>copy-dependencies</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.directory}/${project.build.finalName}.lib</outputDirectory>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

### 使 Jar 可执行且可感知类路径

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-jar-plugin</artifactId>
  <configuration>
    <archive>
      <manifest>
        <addClasspath>true</addClasspath>
        <classpathPrefix>${project.build.finalName}.lib/</classpathPrefix>
        <mainClass>${fully.qualified.main.class}</mainClass>
      </manifest>
    </archive>
  </configuration>
</plugin> 
```

此时，`jar`实际上可以使用外部类路径元素执行。

```
$ java -jar target/${project.build.finalName}.jar 
```

### 制作可部署的档案

该`jar`文件只能与同级`...lib/`目录一起执行。我们需要制作档案以与目录及其内容一起部署。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-antrun-plugin</artifactId>
  <executions>
    <execution>
      <id>antrun-archive</id>
      <phase>package</phase>
      <goals>
        <goal>run</goal>
      </goals>
      <configuration>
        <target>
          <property name="final.name" value="${project.build.directory}/${project.build.finalName}"/>
          <property name="archive.includes" value="${project.build.finalName}.${project.packaging} ${project.build.finalName}.lib/*"/>
          <property name="tar.destfile" value="${final.name}.tar"/>
          <zip basedir="${project.build.directory}" destfile="${final.name}.zip" includes="${archive.includes}" />
          <tar basedir="${project.build.directory}" destfile="${tar.destfile}" includes="${archive.includes}" />
          <gzip src="${tar.destfile}" destfile="${tar.destfile}.gz" />
          <bzip2 src="${tar.destfile}" destfile="${tar.destfile}.bz2" />
        </target>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

现在你有`target/${project.build.finalName}.(zip|tar|tar.bz2|tar.gz)`which each 包含`jar`and `lib/*`。

* * *

## Apache Maven 程序集插件

*   优点
*   缺点
    *   没有类重定位支持（如果需要类重定位，请使用 maven-shade-plugin）。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-assembly-plugin</artifactId>
  <executions>
    <execution>
      <phase>package</phase>
      <goals>
        <goal>single</goal>
      </goals>
      <configuration>
        <archive>
          <manifest>
            <mainClass>${fully.qualified.main.class}</mainClass>
          </manifest>
        </archive>
        <descriptorRefs>
          <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

你有`target/${project.bulid.finalName}-jar-with-dependencies.jar`.

* * *

## Apache Maven 阴影插件

*   优点
*   缺点

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-shade-plugin</artifactId>
  <executions>
    <execution>
      <goals>
        <goal>shade</goal>
      </goals>
      <configuration>
        <shadedArtifactAttached>true</shadedArtifactAttached>
        <transformers>
          <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
            <mainClass>${fully.qualified.main.class}</mainClass>
          </transformer>
        </transformers>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

你有`target/${project.build.finalName}-shaded.jar`.

* * *

## onejar-maven-插件

*   优点
*   缺点
    *   自 2012 年以来未得到积极支持。

```
<plugin>
  <!--groupId>org.dstovall</groupId--> <!-- not available on the central -->
  <groupId>com.jolira</groupId>
  <artifactId>onejar-maven-plugin</artifactId>
  <executions>
    <execution>
      <configuration>
        <mainClass>${fully.qualified.main.class}</mainClass>
        <attachToBuild>true</attachToBuild>
        <!-- https://code.google.com/p/onejar-maven-plugin/issues/detail?id=8 -->
        <!--classifier>onejar</classifier-->
        <filename>${project.build.finalName}-onejar.${project.packaging}</filename>
      </configuration>
      <goals>
        <goal>one-jar</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

* * *

## Spring Boot Maven 插件

*   优点
*   缺点
    *   添加潜在的不必要的 Spring 和 Spring Boot 相关类。

```
<plugin>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-maven-plugin</artifactId>
  <executions>
    <execution>
      <goals>
        <goal>repackage</goal>
      </goals>
      <configuration>
        <classifier>spring-boot</classifier>
        <mainClass>${fully.qualified.main.class}</mainClass>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

你有`target/${project.bulid.finalName}-spring-boot.jar`.

* * *

## 回答 #4

> 赞同：152
> 
> 时间：2009-02-26T04:31:05.863

接受未回答的答案并重新格式化，我们有：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <mainClass>fully.qualified.MainClass</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

接下来，我建议将其作为构建的自然部分，而不是显式调用。要使其成为您构建的一个组成部分，请将此插件添加到您的`pom.xml`并将其绑定到`package`生命周期事件。但是，一个问题是，如果将其放在 pom.xml 中，则需要调用`assembly:single`目标，而如果从命令行手动执行，则需要调用“程序集：程序集”。

```
<project>
  [...]
  <build>
      <plugins>
          <plugin>
              <artifactId>maven-assembly-plugin</artifactId>
              <configuration>
                  <archive>
                      <manifest>
                          <addClasspath>true</addClasspath>
                          <mainClass>fully.qualified.MainClass</mainClass>
                      </manifest>
                  </archive>
                  <descriptorRefs>
                      <descriptorRef>jar-with-dependencies</descriptorRef>
                  </descriptorRefs>
              </configuration>
              <executions>
                  <execution>
                      <id>make-my-jar-with-dependencies</id>
                      <phase>package</phase>
                      <goals>
                          <goal>single</goal>
                      </goals>
                  </execution>
              </executions>
          </plugin>
      [...]
      </plugins>
    [...]
  </build>
</project> 
```

* * *

## 回答 #5

> 赞同：101
> 
> 时间：2010-09-22T15:20:20.127

使用 maven-shade-plugin 将所有依赖项打包到一个 uber-jar 中。也可以通过指定主类来构建可执行jar。在尝试使用 maven-assembly 和 maven-jar 之后，我发现这个插件最适合我的需要。

我发现这个插件特别有用，因为它合并了特定文件的内容而不是覆盖它们。当 jar 中存在同名的资源文件并且插件尝试打包所有资源文件时，需要这样做

请参阅下面的示例

```
 <plugins>
    <!-- This plugin provides the capability to package the artifact in an uber-jar, including its dependencies and to shade - i.e. rename - the packages of some of the dependencies. -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>1.4</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                    <configuration>
                        <artifactSet>
                        <!-- signed jars-->
                            <excludes>
                                <exclude>bouncycastle:bcprov-jdk15</exclude>
                            </excludes>
                        </artifactSet>

                         <transformers>
                            <transformer
                                implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                <!-- Main class -->
                                <mainClass>com.main.MyMainClass</mainClass>
                            </transformer>
                            <!-- Use resource transformers to prevent file overwrites -->
                            <transformer 
                                 implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                                <resource>properties.properties</resource>
                            </transformer>
                            <transformer
                                implementation="org.apache.maven.plugins.shade.resource.XmlAppendingTransformer">
                                <resource>applicationContext.xml</resource>
                            </transformer>
                            <transformer
                                implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                                <resource>META-INF/cxf/cxf.extension</resource>
                            </transformer>
                            <transformer
                                implementation="org.apache.maven.plugins.shade.resource.XmlAppendingTransformer">
                                <resource>META-INF/cxf/bus-extensions.xml</resource>
                            </transformer>
                     </transformers>
                    </configuration>
                </execution>
            </executions>
        </plugin>

    </plugins> 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2017-10-26T00:57:51.373

您可以使用 maven-shade 插件来构建一个 uber jar，如下所示

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>shade</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2012-03-13T20:55:58.763

长期使用**maven 程序集插件**，但我找不到解决问题的方法[`"already added, skipping"`](https://stackoverflow.com/questions/2596655/how-do-i-surpress-maven-assembly-plugin-skipping-files-that-are-already-added-o)。现在，我正在使用另一个插件 - [**onejar-maven-plugin**](http://code.google.com/p/onejar-maven-plugin/)。下面的示例（`mvn package`构建 jar）：

```
<plugin>
    <groupId>org.dstovall</groupId>
    <artifactId>onejar-maven-plugin</artifactId>
    <version>1.3.0</version>
    <executions>
        <execution>
            <configuration>
                <mainClass>com.company.MainClass</mainClass>
            </configuration>
            <goals>
                <goal>one-jar</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

您需要为该插件添加存储库：

```
<pluginRepositories>
    <pluginRepository>
        <id>onejar-maven-plugin.googlecode.com</id>
        <url>http://onejar-maven-plugin.googlecode.com/svn/mavenrepo</url>
    </pluginRepository>
</pluginRepositories> 
```

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2009-10-13T12:16:24.040

您可以使用 maven-dependency-plugin，但问题是如何创建可执行 JAR。为此，需要对 Matthew Franglen 的响应进行以下更改（顺便说一句，从干净的目标开始时使用依赖插件需要更长的时间来构建）：

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-jar-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <mainClass>fully.qualified.MainClass</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
        <plugin>
            <artifactId>maven-dependency-plugin</artifactId>
            <executions>
                <execution>
                    <id>unpack-dependencies</id>
                    <phase>package</phase>
                    <goals>
                        <goal>unpack-dependencies</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
    <resources>
        <resource>
            <directory>${basedir}/target/dependency</directory>
        </resource>
    </resources>
</build> 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2011-08-13T18:23:43.320

您可以将以下内容添加到您的**pom.xml**中：

```
<build>
<defaultGoal>install</defaultGoal>
<plugins>
  <plugin>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>2.3.2</version>
    <configuration>
      <source>1.6</source>
      <target>1.6</target>
    </configuration>
  </plugin>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>2.3.1</version>
    <configuration>
      <archive>
        <manifest>
          <addClasspath>true</addClasspath>
          <mainClass>com.mycompany.package.MainClass</mainClass>
        </manifest>
      </archive>
    </configuration>
  </plugin>
  <plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <configuration>
      <descriptorRefs>
        <descriptorRef>jar-with-dependencies</descriptorRef>
      </descriptorRefs>
      <archive>
        <manifest>
          <mainClass>com.mycompany.package.MainClass</mainClass>
        </manifest>
      </archive>
    </configuration>
    <executions>
      <execution>
        <id>make-my-jar-with-dependencies</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
      </execution>
    </executions>
  </plugin>
</plugins>
</build> 
```

之后，您必须通过控制台切换到 pom.xml 所在的目录。然后你必须执行**mvn assembly:single**然后你的可执行 JAR 文件与依赖项将有望被构建。您可以在使用**cd ./target切换到输出（目标）目录并使用类似于****java -jar mavenproject1-1.0-SNAPSHOT-jar-with-dependencies.jar**的命令启动 jar时检查它。

我用**Apache Maven 3.0.3**对此进行了测试。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2009-03-11T15:12:55.553

如果您真的想在单个结果 JAR 中重新打包其他 JAR 内容，另一个选择是[Maven Assembly 插件](http://maven.apache.org/plugins/maven-assembly-plugin/)。它解压缩然后将所有内容重新打包到一个目录中`<unpack>true</unpack>`。然后你会有第二遍将它构建到一个巨大的 JAR 中。

[另一种选择是 OneJar 插件](http://code.google.com/p/onejar-maven-plugin/)。这一步完成了上述重新打包操作。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2015-11-23T20:28:55.190

我浏览了这些响应中的每一个，希望制作一个包含所有依赖项的胖可执行 jar，但它们都不能正常工作。答案是阴影插件，它非常简单明了。

```
 <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-shade-plugin</artifactId>
      <version>2.3</version>
      <executions>
         <!-- Run shade goal on package phase -->
        <execution>
        <phase>package</phase>
        <goals>
            <goal>shade</goal>
        </goals>
        <configuration>
          <transformers>
             <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                <mainClass>path.to.MainClass</mainClass>
             </transformer>
          </transformers>
        </configuration>
          </execution>
      </executions>
    </plugin> 
```

请注意，您的依赖项需要具有编译或运行时范围才能正常工作。

[这个例子来自 mkyong.com](http://www.mkyong.com/maven/create-a-fat-jar-file-maven-shade-plugin/)

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2011-11-26T14:17:01.947

你可以结合`maven-shade-plugin`和`maven-jar-plugin`。

*   将`maven-shade-plugin`您的类和所有依赖项打包在一个 jar 文件中。
*   配置`maven-jar-plugin`以指定可执行 jar 的主类（请参阅[设置类路径](http://maven.apache.org/shared/maven-archiver/examples/classpath.html)，“使 Jar 可执行”一章）。

示例 POM 配置`maven-jar-plugin`：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <mainClass>com.example.MyMainClass</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin> 
```

最后通过调用创建可执行jar：

```
mvn clean package shade:shade 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2009-09-09T13:37:43.527

在我看来，Ken Liu 是对的。maven 依赖插件允许您扩展所有依赖项，然后您可以将其视为资源。这允许您将它们包含在*主*工件中。组装插件的使用创建了一个可能难以修改的辅助工件 - 在我的情况下，我想添加自定义清单条目。我的 pom 最终变成：

```
<project>
 ...
 <build>
  <plugins>
   <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
     <execution>
      <id>unpack-dependencies</id>
      <phase>package</phase>
      <goals>
       <goal>unpack-dependencies</goal>
      </goals>
     </execution>
    </executions>
   </plugin>
  </plugins>
  ...
  <resources>
   <resource>
    <directory>${basedir}/target/dependency</directory>
    <targetPath>/</targetPath>
   </resource>
  </resources>
 </build>
 ...
</project> 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2010-03-05T15:39:19.130

它应该是这样的：

```
<plugin>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
        <execution>
            <id>unpack-dependencies</id>
            <phase>generate-resources</phase>
            <goals>
                <goal>unpack-dependencies</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

解包必须在 generate-resources 阶段，因为如果在 package 阶段，将不会作为资源包含在内。尝试干净的包装，你会看到。

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2011-03-13T11:40:45.050

使用 maven-assembly-plugin-2.2.1 定位共享程序集文件有问题吗？

尝试使用descriptorId 配置参数而不是descriptors/descriptor 或descriptorRefs/descriptorRef 参数。

他们都没有做你需要的事情：在类路径中查找文件。当然，您需要在 maven-assembly-plugin 的类路径中添加共享程序集所在的包（见下文）。如果您使用的是 Maven 2.x（不是 Maven 3.x），您可能需要在 pluginManagement 部分的最顶层父 pom.xml 中添加此依赖项。

有关更多详细信息，请参阅[此](http://svn.apache.org/repos/asf/maven/plugins/tags/maven-assembly-plugin-2.2.1)内容。

类：org.apache.maven.plugin.assembly.io.DefaultAssemblyReader

例子：

```
 <!-- Use the assembly plugin to create a zip file of all our dependencies. -->
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.2.1</version>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                    <configuration>
                        <descriptorId>assembly-zip-for-wid</descriptorId>
                    </configuration>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>cz.ness.ct.ip.assemblies</groupId>
                    <artifactId>TEST_SharedAssemblyDescriptor</artifactId>
                    <version>1.0.0-SNAPSHOT</version>
                </dependency>
            </dependencies>
        </plugin> 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2016-09-01T10:21:52.237

为了解决这个问题，我们将使用 Maven 程序集插件，它将 JAR 及其依赖 JAR 一起创建到单个可执行 JAR 文件中。只需在您的 pom.xml 文件中添加以下插件配置。

```
<build>
   <pluginManagement>
      <plugins>
         <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
               <archive>
                  <manifest>
                     <addClasspath>true</addClasspath>
                     <mainClass>com.your.package.MainClass</mainClass>
                  </manifest>
               </archive>
               <descriptorRefs>
                  <descriptorRef>jar-with-dependencies</descriptorRef>
               </descriptorRefs>
            </configuration>
            <executions>
               <execution>
                  <id>make-my-jar-with-dependencies</id>
                  <phase>package</phase>
                  <goals>
                     <goal>single</goal>
                  </goals>
               </execution>
            </executions>
         </plugin>
      </plugins>
   </pluginManagement>
</build> 
```

完成此操作后，不要忘记使用此命令运行 MAVEN 工具 mvn clean compile assembly:single

[http://jkoder.com/maven-creating-a-jar-together-with-its-dependency-jars-into-a-single-executable-jar-file/](http://jkoder.com/maven-creating-a-jar-together-with-its-dependency-jars-into-a-single-executable-jar-file/)

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-12-28T16:43:35.350

我不会直接回答这个问题，因为其他人之前已经这样做了，但我真的想知道将所有依赖项嵌入到项目的 jar 本身中是否是个好主意。

我明白了这一点（易于部署/使用），但这取决于您的项目的用例（并且可能有替代方案（见下文））。

如果您完全独立使用它，为什么不呢。

但是，如果您在其他上下文中使用您的项目（例如在 web 应用程序中，或者放在其他 jar 所在的文件夹中），您的类路径中可能有 jar 重复项（文件夹中的那些，jar 中的那个）。也许不是投标交易，但我通常会避免这种情况。

一个很好的选择：

*   将您的应用程序部署为 .zip / .war ：存档包含您项目的 jar 和所有依赖的 jar；
*   使用动态类加载器机制（请参阅 Spring，或者您可以自己轻松地做到这一点）拥有项目的单个入口点（启动单个类 - 请参阅另一个答案的清单机制），这将（动态）添加到当前类路径所有其他需要的罐子。

像这样，最后只有一个清单和一个“特殊的动态类加载器主程序”，您可以使用以下命令开始您的项目：

```
java -jar ProjectMainJar.jar com.stackoverflow.projectName.MainDynamicClassLoaderClass 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2010-09-14T04:37:43.210

要从命令行本身创建可执行 JAR，只需从项目路径运行以下命令：

```
mvn assembly:assembly 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2013-09-24T16:11:16.630

对我有用的是：

```
 <plugin>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
      <execution>
        <id>unpack-dependencies</id>
        <phase>prepare-package</phase>
        <goals>
          <goal>unpack-dependencies</goal>
        </goals>
        <configuration>
          <outputDirectory>${project.build.directory}/classes</outputDirectory>
        </configuration>
      </execution>

    </executions>
  </plugin>

  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <executions>
      <execution>
        <id>unpack-dependencies</id>
        <phase>package</phase>
      </execution>
    </executions>
    <configuration>
      <archive>
        <manifest>
          <addClasspath>true</addClasspath>
          <classpathPrefix>lib/</classpathPrefix>
          <mainClass>SimpleKeyLogger</mainClass>
        </manifest>
      </archive>
    </configuration>
  </plugin> 
```

我有特殊情况，因为我的依赖是系统一：

```
<dependency>
  ..
  <scope>system</scope>
  <systemPath>${project.basedir}/lib/myjar.jar</systemPath>
</dependency> 
```

我已经更改了@user189057 提供的代码并进行了更改：1）maven-dependency-plugin 在“准备包”阶段执行 2）我将解压的类直接提取到“目标/类”

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2015-03-09T22:22:50.527

这是我发现的最好方法：

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>2.4</version>
    <configuration>
      <archive>
        <manifest>
        <addClasspath>true</addClasspath>
        <mainClass>com.myDomain.etc.MainClassName</mainClass>
        <classpathPrefix>dependency-jars/</classpathPrefix>
        </manifest>
      </archive>
    </configuration>
  </plugin>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <version>2.5.1</version>
    <executions>
      <execution>
        <id>copy-dependencies</id>
        <phase>package</phase>
        <goals>
            <goal>copy-dependencies</goal>
        </goals>
        <configuration>
            <outputDirectory>
               ${project.build.directory}/dependency-jars/
            </outputDirectory>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

使用此配置，所有依赖项都将位于`/dependency-jars`. 我的应用程序没有`Main`类，只有上下文类，但我的一个依赖项确实有一个`Main`类 ( `com.myDomain.etc.MainClassName`)，它启动 JMX 服务器并接收一个`start`或一个`stop`参数。所以有了这个我能够像这样启动我的应用程序：

```
java -jar ./lib/TestApp-1.0-SNAPSHOT.jar start 
```

我等待它对大家有用。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-02-24T18:12:01.653

我比较了这篇文章中提到的树插件。我生成了 2 个 jar 和一个包含所有 jar 的目录。我比较了结果，肯定 maven-shade-plugin 是最好的。我的挑战是我有多个需要合并的 spring 资源，以及 jax-rs 和 JDBC 服务。与 maven-assembly-plugin 相比，它们都被 shade 插件正确合并。在这种情况下，除非您将它们复制到自己的资源文件夹并手动合并一次，否则 spring 将失败。两个插件都输出正确的依赖树。我有多个范围，如测试、提供、编译等，测试和提供的两个插件都跳过了。他们都产生了相同的清单，但我能够使用他们的转换器将许可证与阴影插件合并。使用 maven-dependency-plugin 你当然不需要 没有这些问题，因为罐子没有被提取。但就像其他人指出的那样，您需要携带一个额外的文件才能正常工作。这是 pom.xml 的片段

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <executions>
                <execution>
                    <id>copy-dependencies</id>
                    <phase>prepare-package</phase>
                    <goals>
                        <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${project.build.directory}/lib</outputDirectory>
                        <includeScope>compile</includeScope>
                        <excludeTransitive>true</excludeTransitive>
                        <overWriteReleases>false</overWriteReleases>
                        <overWriteSnapshots>false</overWriteSnapshots>
                        <overWriteIfNewer>true</overWriteIfNewer>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.6</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <mainClass>com.rbccm.itf.cdd.poller.landingzone.LandingZonePoller</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
            <executions>
                <execution>
                    <id>make-my-jar-with-dependencies</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>2.4.3</version>
            <configuration>
                <shadedArtifactAttached>false</shadedArtifactAttached>
                <keepDependenciesWithProvidedScope>false</keepDependenciesWithProvidedScope>
                <transformers>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/services/javax.ws.rs.ext.Providers</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.factories</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.handlers</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.schemas</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.tooling</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer"/>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"/>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ApacheLicenseResourceTransformer">
                    </transformer>
                </transformers>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2016-05-03T08:09:12.603

对于任何寻找从 uber-jar 中排除特定依赖项的选项的人，这是一个对我有用的解决方案：

```
<project...>
<dependencies>
        <dependency>
            <groupId>org.apache.spark</groupId>
            <artifactId>spark-core_2.11</artifactId>
            <version>1.6.1</version>
            <scope>provided</scope> <=============
        </dependency>
</dependencies>
<build>
        <plugins>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                    <archive>
                        <manifest>
                            <mainClass>...</mainClass>
                        </manifest>
                    </archive>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

所以它不是 mvn-assembly-plugin 的配置，而是依赖项的属性。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2016-09-29T23:27:04.027

已经有数百万个答案，`<mainClass>`如果您不需要将 entryPoint 添加到您的应用程序，我想添加您不需要。**例如，API 不一定有`main`方法。**

## maven插件配置

```
 <build>
    <finalName>log-enrichment</finalName>
    <plugins>
      <plugin>
        <artifactId>maven-assembly-plugin</artifactId>
        <configuration>
          <descriptorRefs>
            <descriptorRef>jar-with-dependencies</descriptorRef>
          </descriptorRefs>
        </configuration>
      </plugin>
    </plugins>
  </build> 
```

## 建造

```
mvn clean compile assembly:single 
```

## 核实

```
ll target/
total 35100
drwxrwx--- 1 root vboxsf     4096 Sep 29 16:25 ./
drwxrwx--- 1 root vboxsf     4096 Sep 29 16:25 ../
drwxrwx--- 1 root vboxsf        0 Sep 29 16:08 archive-tmp/
drwxrwx--- 1 root vboxsf        0 Sep 29 16:25 classes/
drwxrwx--- 1 root vboxsf        0 Sep 29 16:25 generated-sources/
drwxrwx--- 1 root vboxsf        0 Sep 29 16:25 generated-test-sources/
-rwxrwx--- 1 root vboxsf 35929841 Sep 29 16:10 log-enrichment-jar-with-dependencies.jar*
drwxrwx--- 1 root vboxsf        0 Sep 29 16:08 maven-status/ 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2014-10-10T22:11:18.943

我在这里尝试了投票最多的答案，并且能够让 jar 可运行。但是程序没有正确运行。我不知道是什么原因。当我尝试从 运行时`Eclipse`，我得到了不同的结果，但是当我从命令行运行 jar 时，我得到了不同的结果（它因程序特定的运行时错误而崩溃）。

我有与 OP 类似的要求，只是我的项目有太多（Maven）依赖项。幸运的是，唯一对我有用的解决方案是使用`Eclipse`. 非常简单，非常直接。这不是针对 OP 的解决方案，而是针对具有类似要求但具有许多 Maven 依赖项的人的解决方案，

1）只需右键单击您的项目文件夹（在 Eclipse 中）并选择`Export`

2）然后选择`Java`->`Runnable Jar`

3) 系统会要求您选择 jar 文件的位置

4）最后，选择具有您要运行的Main方法的类并选择`Package dependencies with the Jar file`并单击`Finish`

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2015-11-25T10:40:27.850

这也可以是一个选项，您将能够构建您的 jar 文件

```
<build>
    <plugins>
        <plugin>
            <!-- Build an executable JAR -->
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib/</classpathPrefix>
                        <mainClass>WordListDriver</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2017-06-21T19:35:38.527

添加到 pom.xml：

```
 <dependency>
            <groupId>com.jolira</groupId>
            <artifactId>onejar-maven-plugin</artifactId>
            <version>1.4.4</version>
  </dependency> 
```

和

```
<plugin>
       <groupId>com.jolira</groupId>
       <artifactId>onejar-maven-plugin</artifactId>
       <version>1.4.4</version>
       <executions>
              <execution>
                     <goals>
                         <goal>one-jar</goal>
                     </goals>
              </execution>
       </executions>
</plugin> 
```

就是这样。下一个 mvn 包还会额外创建一个 fat jar，包括所有依赖 jar。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2022-01-14T16:26:13.123

尝试了多种解决方案，但在我们想要创建一个不可执行的胖 jar 的场景中完美运行的解决方案，其中外部系统的所有内部依赖项以前没有相关性。产品场景测试。

将其包含在 pom.xml 中

```
<?xml version="1.0" encoding="UTF-8"?>
<build>
   <sourceDirectory>src</sourceDirectory>
   <plugins>
      <plugin>
         <artifactId>maven-compiler-plugin</artifactId>
         <version>3.8.1</version>
         <configuration>
            <source>1.8</source>
            <target>1.8</target>
         </configuration>
      </plugin>
      <plugin>
         <artifactId>maven-assembly-plugin</artifactId>
         <configuration>
            <descriptorRefs>
               <descriptorRef>jar-with-dependencies</descriptorRef>
            </descriptorRefs>
         </configuration>
      </plugin>
   </plugins>
</build> 
```

运行命令以构建胖 jar->> mvn assembly:assembly

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2013-05-24T19:42:04.053

maven-assembly-plugin 对我很有用。我花了几个小时使用 maven-dependency-plugin 并且无法使其工作。主要原因是我必须在配置部分明确定义应包含的工件项，如[文档](http://maven.apache.org/plugins/maven-dependency-plugin/usage.html)中所述。当您想使用它时，有一个示例：`mvn dependency:copy`，其中不包含任何 artifactItems 但它不起作用。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2015-05-27T15:21:55.317

这篇博文展示了另一种结合 maven-jar 和 maven-assembly 插件的方法。使用博客文章中的程序集配置 xml，还可以控制是否扩展依赖项或仅将依赖项收集在文件夹中并由清单中的类路径条目引用：

> 理想的解决方案是将 jar 包含在 lib 文件夹中，并且主 jar 的 manifest.mf 文件包含类路径中的所有 jar。

正是在这里描述了一个：[https ://caffebig.wordpress.com/2013/04/05/executable-jar-file-with-dependent-jars-using-maven/](https://caffebig.wordpress.com/2013/04/05/executable-jar-file-with-dependent-jars-using-maven/)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2020-06-25T12:33:31.477

我希望我的经验可以帮助某人：我想将我的应用程序 Spring（使用 cas 客户端）迁移到 Spring Boot（1.5 而不是 2.4）。我遇到了很多问题，例如：

> 没有主要清单属性，在 target/cas-client-web.jar

我想制作一个具有所有依赖项的唯一 jar。在网上搜索了几天。我可以用这些线来完成我的工作：

```
 <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <configuration>
                <fork>true</fork>
                <mainClass>${start-class}</mainClass>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <mainClass>${start-class}</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
        </plugin> 
```

with *start-class*是您的主要课程

```
<properties>
    <java.version>1.8</java.version>
    <start-class>com.test.Application</start-class>
</properties> 
```

我的*应用程序*是这样的：

```
package com.test;

import java.util.Arrays;

import com.test.TestProperties;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.Bean;

@SpringBootApplication
@EnableAutoConfiguration
@EnableConfigurationProperties({TestProperties.class})
public class Application {

public static void main(String[] args) {
    SpringApplication.run(Application.class, args);
}

@Bean
public CommandLineRunner commandLineRunner(ApplicationContext ctx) {
    return args -> {

        System.out.println("Let's inspect the beans provided by Spring Boot:");

        String[] beanNames = ctx.getBeanDefinitionNames();
        Arrays.sort(beanNames);
        for (String beanName : beanNames) {
            System.out.println(beanName);
        }

    };
}

} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-02-28T21:47:39.673

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.4.1</version>
            <configuration>
                <!-- get all project dependencies -->
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <!-- bind to the packaging phase -->
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #32

> 赞同：-2
> 
> 时间：2015-02-13T00:51:56.557

好的，这就是我的解决方案。我知道它没有使用 pom.xml 文件。但是我的程序在 Netbeans 上编译和运行时遇到了问题，但是当我尝试 Java -jar MyJarFile.jar 时它失败了。现在，我并不完全了解 Maven，我认为这就是为什么让 Netbeans 8.0.2 无法将我的 jar 文件包含在库中以将它们放入 jar 文件中的原因。我正在考虑如何在 Eclipse 中使用没有 Maven 的 jar 文件。

可以编译所有依赖项和插件的是 Maven。不是 Netbeans。（如果您可以获得 Netbeans 并能够使用 java .jar 来执行此操作，请告诉我如何 (^.^)v ）

[已解决 - 适用于 Linux] 通过打开终端。

然后

```
cd /MyRootDirectoryForMyProject 
```

下一个

```
mvn org.apache.maven.plugins:maven-compiler-plugin:compile 
```

下一个

```
mvn install 
```

这将在目标目录中创建 jar 文件。

```
MyJarFile-1.0-jar-with-dependencies.jar 
```

现在

```
cd target 
```

（您可能需要运行`chmod +x MyJarFile-1.0-jar-with-dependencies.jar`：）

最后

```
java -jar MyJarFile-1.0-jar-with-dependencies.jar 
```

请参见

[https://cwiki.apache.org/confluence/display/MAVEN/LifecyclePhaseNotFoundException](https://cwiki.apache.org/confluence/display/MAVEN/LifecyclePhaseNotFoundException)

我将把这个解决方案发布在有类似问题的其他几个页面上。希望我能从一周的挫折中拯救某人。

# global-asax - 需要有关 Global.asax 文件的帮助

> ID：574602
> 
> 赞同：0
> 
> 时间：2009-02-22T08:53:31.507
> 
> 标签：global-asax

我在 global.asax 文件中设置了 default.aspx作为设置的开始页面。我想使用 global.asax 文件和会话启动方法以编程方式执行此操作。只要我运行应用程序时不做任何设置，default.aspx 页面应该首先出现。这必须工作以编程方式不使用任何设置。希望我解释了我的问题。

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T09:05:35.580

我不认为是否有一种编程方式来设置启动页面。您可以将重定向设置为 Session_Start 但如果用户来自链接您的页面**product.aspx?category=hardware**的另一个网站怎么办。你想让他重定向到 default.aspx 吗？

我认为明确的方法是，从您的应用程序中删除这些文件：

*   索引.htm、索引.html
*   默认.htm，默认.html
*   索引.aspx

那么 default.aspx 将是唯一的重定向选项。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T09:01:00.677

你试过把

```
void Session_Start(object sender, EventArgs e)
{
  Response.Redirect("default.aspx");
} 
```

在 Global.asax 文件中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T10:40:00.500

您可以在 default.aspx 页面中设置一个小的会话变量，即

```
Session("AppInit") = True 
```

然后在每个其他 page_load 事件上执行以下操作：

```
 If Session("AppInit") <> True then
     Response.Redirect("Default.aspx")
   End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T11:01:36.643

您可以编写一个 HTTP 模块来将所有到默认 URL 的流量重定向到特定页面。

很容易做到，您可以通过编程方式进行设置。

这里有一些页面： [http://support.microsoft.com/kb/307996](http://support.microsoft.com/kb/307996) [http://geekswithblogs.net/flanakin/articles/ModuleHandlerIntro.aspx](http://geekswithblogs.net/flanakin/articles/ModuleHandlerIntro.aspx) [http://www.15seconds.com/Issue/020417.htm](http://www.15seconds.com/Issue/020417.htm)

# delphi - 从 Delphi7 中的字符串中去除非字母数字字符的最快方法是什么？

> ID：574603
> 
> 赞同：5
> 
> 时间：2009-02-22T08:55:31.767
> 
> 标签：delphi, delphi-7

允许的字符是 A 到 Z、a 到 z、0 到 9。代码量最少或单个功能最好，因为系统对输入的响应时间很关键。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-22T10:05:12.613

如果我理解正确，您可以使用这样的函数：

```
function StripNonAlphaNumeric(const AValue: string): string;
var
  SrcPtr, DestPtr: PChar;
begin
  SrcPtr := PChar(AValue);
  SetLength(Result, Length(AValue));
  DestPtr := PChar(Result);
  while SrcPtr[0] <> #0 do begin
    if SrcPtr[0] in ['a'..'z', 'A'..'Z', '0'..'9'] then begin
      DestPtr[0] := SrcPtr[0];
      Inc(DestPtr);
    end;
    Inc(SrcPtr);
  end;
  SetLength(Result, DestPtr - PChar(Result));
end; 
```

这将`PChar`用于最高速度（以降低可读性为代价）。

**编辑：**重新评论 gabr 关于使用`DestPtr[0]`而不是`DestPtr^`：无论如何这应该编译为相同的字节，但是在类似的代码中有很好的应用程序，您需要向前看。假设您想要替换换行符，那么您可以执行类似的操作

```
function ReplaceNewlines(const AValue: string): string;
var
  SrcPtr, DestPtr: PChar;
begin
  SrcPtr := PChar(AValue);
  SetLength(Result, Length(AValue));
  DestPtr := PChar(Result);
  while SrcPtr[0] <> #0 do begin
    if (SrcPtr[0] = #13) and (SrcPtr[1] = #10) then begin
      DestPtr[0] := '\';
      DestPtr[1] := 't';
      Inc(SrcPtr);
      Inc(DestPtr);
    end else
      DestPtr[0] := SrcPtr[0];
    Inc(SrcPtr);
    Inc(DestPtr);
  end;
  SetLength(Result, DestPtr - PChar(Result));
end; 
```

因此我通常不使用`^`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-08T20:38:06.267

```
uses JclStrings;

  S := StrKeepChars('mystring', ['A'..'Z', 'a'..'z', '0'..'9']); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-22T10:01:39.063

只是补充一句。

使用集合的解决方案在 Delphi 7 中很好，但在 Delphi 2009 中可能会导致一些问题，因为集合不能是 char（它们被转换为 ansichar）。

您可以使用的解决方案是：

```
case key of 
  'A'..'Z', 'a'..'z', '0'..'9' : begin end; // No action
else
  Key := #0;
end; 
```

但最通用的方式当然是：

```
if not ValidChar(key) then
  Key := #0; 
```

在这种情况下，您可以在多个位置使用 ValidChar，如果需要更改，您只需更改一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T09:20:57.697

OnKeypress 事件

如果不是，则开始（键入 ['A'..'Z','a'..'z','0'..'9']）然后 Key := #0; 结尾;

# python - 有人用 IronPython 使用过 SciPy 吗？

> ID：574604
> 
> 赞同：16
> 
> 时间：2009-02-22T08:57:53.600
> 
> 标签：python, scipy, ironpython, python.net

我已经能够使用 IronPython 的标准 Python 模块，但我还没有让 SciPy 工作。有没有人能够使用 IronPython 的 SciPy？你必须做什么才能让它发挥作用？

更新：请参阅[IronPython 和 Ironclad 中的数值计算](http://www.johndcook.com/blog/2009/03/19/ironclad-ironpytho/)

更新：微软正在[与 Enthought 合作](http://www.johndcook.com/blog/2010/07/01/scipy-and-numpy-for-net/)为 .NET 制作 SciPy。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-22T13:21:58.333

我的一些同事正在研究[Ironclad](http://code.google.com/p/ironclad/)，该项目将使 CPython 的扩展模块在 IronPython 中工作。它仍在开发中，但部分 numpy、scipy 和其他一些模块已经可以使用。您应该尝试一下，看看是否支持您需要的 scipy 部分。

这是一个开源项目，所以如果你有兴趣，你甚至可以提供帮助。在任何情况下，关于您正在尝试做什么以及我们接下来应该查看哪些部分的一些反馈也很有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-22T09:13:41.457

任何用 C 编写的组件（例如 NumPy，它是 SciPy 的一个组件）都不能在 IronPython 上运行，因为外部语言接口的工作方式不同。任何 C 语言组件都可能无法工作，除非它已明确移植以与 IronPython 一起使用。

您可能需要深入研究各个模块并检查哪些模块可以工作或者是纯 python，并找出是否有任何基于 C 的模块已被移植。

# regex - FLEX：有没有办法一次返回多个令牌

> ID：574621
> 
> 赞同：7
> 
> 时间：2009-02-22T09:11:12.913
> 
> 标签：regex, flex-lexer, lexical-analysis

在 flex 中，我想为一个正则表达式的匹配返回多个标记。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:16:20.593

我一直这样做的方式是创建一个待返回令牌的队列，并在开始时`yylex()`检查令牌并返回它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T09:26:29.507

~~你的意思是所有的比赛？您使用的是正则表达式函数还是字符串函数？使用全局标志。~~

至于 flex，我认为你做不到。您一次测试一个模式的匹配项，因此这可能超出了范围。你为什么要那个？作为优化？范围问题？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-03-04T17:25:17.573

通常，这是由扫描仪顶部的解析器处理的，它为您提供更清晰的代码。你可以在某种程度上用状态来模拟它：

```
%option noyywrap

%top {
#define TOKEN_LEFT_PAREN    4711
#define TOKEN_RIGHT_PAREN   4712
#define TOKEN_NUMBER        4713
}

%x PAREN_STATE
%%
"("         BEGIN(PAREN_STATE); return TOKEN_LEFT_PAREN;
<PAREN_STATE>{
   [0-9]+   return TOKEN_NUMBER;
   ")"      BEGIN(INITIAL); return TOKEN_RIGHT_PAREN;
   .|\n     /* maybe signal syntax error here */
}
%%
int main (int argc, char *argv [])
{
  int i;

  while ((i = yylex ()))
    printf ("%d\n", i);

  return 0;
} 
```

但是一旦你的语法变得更复杂，这就会变得非常混乱。

# flash - 如何翻转 flash.media.Video？

> ID：574627
> 
> 赞同：3
> 
> 时间：2009-02-22T09:15:47.363
> 
> 标签：flash, actionscript-3, video

我正在使用 flash.media.Video 和带有 Actionscript 的相机，我发现视频摄像头正在显示翻转的视频，这让我很烦恼。让我用一个例子来描述：

当我向右转时，视频会显示我向左转。如果我在右手上举起和平手势，就好像我在用左手做一样。

那么，如何翻转视频以使其看起来“镜像”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-22T10:30:01.553

为了让视频看起来像一面“镜子”，我几乎必须设置两件事：

myVideo.scaleX = -1; myVideo.x = myVideo.width + myVideo.x;

*   谢谢克里斯托夫

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-22T09:22:24.867

您可以通过将视频对象的“scaleX”属性设置为 -1 来做到这一点。

```
myVideo.scaleX = -1; 
```

# flash - 如何制作黑白flash.media.Video？

> ID：574632
> 
> 赞同：2
> 
> 时间：2009-02-22T09:18:50.897
> 
> 标签：flash, actionscript-3, video

我正在玩 flash Video cam，我是一个真正的小狗级别的新手，使用 Actionscript、flash 和视频内容。

如何使视频以黑白显示？我想说的是制作视频的“黑白”功能。

我必须弄乱过滤器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T09:25:05.563

是的，你需要一个[ColorMatrixFilter](http://livedocs.adobe.com/flex/3/langref/flash/filters/ColorMatrixFilter.html)来做到这一点。

看看这个例子：[http ://blog.flexexamples.com/2007/07/27/converting-an-image-to-black-and-white-using-the-colormatrixfilter/](http://blog.flexexamples.com/2007/07/27/converting-an-image-to-black-and-white-using-the-colormatrixfilter/)

# visual-studio - 加载项文件中的巨大 AboutIconData 块

> ID：574649
> 
> 赞同：0
> 
> 时间：2009-02-22T09:31:17.467
> 
> 标签：visual-studio, add-in, extensibility

在我为 Visual Studio 生成的 .addin 文件中，我在`AboutIconData`属性下得到了非常大的二进制数据。谁能建议为什么这些数据会随着时间的推移而不断增长，以及我是否可以安全地删除它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T18:22:19.190

它只是用 Base64 编码的图标，我从未见过随着时间的推移数据变得更大。（但另一方面，我几乎没有修改过的文件，它只被源代码控制读取）

# sql-server - 每秒存储 1000 条记录时使用 SQL Server 分区

> ID：574657
> 
> 赞同：1
> 
> 时间：2009-02-22T09:40:53.607
> 
> 标签：sql-server, partitioning

我阅读了您的文章（SQL Server 分区：不是所有问题的答案）并且对我的情况使用分区感到惊讶我必须每秒存储大约 1000 条记录，这些数据是关于移动节点的位置，这些数据构成了我的数据库你认为我是否必须对我的数据库进行分区太大（我将来有很多报告）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T16:20:44.160

一秒1000也不算多。

*   是 24/7 的每一秒吗？
*   在定义的窗口中？
*   它是每秒 1000 次但通常更少的峰值吗？

我们最近的系统以每月 2000 万行的速度增长（在整理后说另外 50-8000 万行），我们没有考虑分区之类的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T15:26:21.420

这是很多数据。

数据的生命周期是什么，即您只需要在有限的时间内存储记录吗？例如一个月后，也许某些数据可以归档或移动到数据仓库？

考虑到您打算使用的数据量，您可能想要使用易于扩展的架构？出于这个原因，您可能希望考虑在 Azure 平台上使用云类型服务，例如 Amazon Ec2 或 SQL 数据服务。

[http://aws.amazon.com/ec2/](http://aws.amazon.com/ec2/)

[http://www.microsoft.com/azure/data.mspx](http://www.microsoft.com/azure/data.mspx)

也许如果您提供有关您实际想要做什么的更具体的细节，即您希望支持的业务流程，我们也许能够提供更具体的帮助。

如果没有这些详细信息，就无法确定 SQL Server 分区是否适合您的设计方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T23:16:41.517

假设有问题的表是索引的，那么当任何索引超出可用 RAM 时，肯定需要两个选项之一。毫不奇怪，其中之一就是增加 RAM。另一个当然是垂直分区。

gbn 的答案提供了一些您没有提到的好东西，例如每月（或每周或每天）添加多少条记录。Richard 关于（平均）记录有多大的评论也很重要，特别是在索引的平均记录有多大方面，假设索引不包括表中的所有字段。

然而，gbn 的回答对我来说似乎也有点鲁莽。每月增长 2000 万行，甚至没有“考虑分区之类的事情”。如果没有上述足够的指标，这可能会导致灾难。在需要考虑更多 RAM 或分区之前，您至少应该考虑一下，即使只是为了确定您可以维持当前和/或预期的增长率多长时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T22:48:00.307

您可能需要查看不同的 RDMS。我会看看[Vertica](http://www.vertica.com)。

# .net - 如何确定重定向网址

> ID：574658
> 
> 赞同：0
> 
> 时间：2009-02-22T09:46:11.863
> 
> 标签：.net, url, redirect

我如何知道 url 以编程方式重定向到哪里？

例如这个网址：

**[http://scobleizer.com/feed/](http://scobleizer.com/feed/)**

重定向到以下网址：

**[http://feeds2.feedburner.com/fastcompany/scobleizer](http://feeds2.feedburner.com/fastcompany/scobleizer)**

我正在尝试阅读提要的 xml 文档。但以下代码行：

```
var doc = new XmlDocument();
doc.Load(url); 
```

将为第一个 url 抛出异常：

> System.Net.WebException：远程服务器返回错误：（404）未找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T09:51:01.337

那不应该扔。这对我来说可以：

```
 var doc = new XmlDocument();
        doc.Load(@"http://scobleizer.com/feed/"); 
```

（现在已加载提要）

（**编辑**：它**正在**工作，但现在我得到 404 ......奇怪）

如果您需要*知道*最终的 url，您可能必须`HttpWebRequest`手动使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-20T21:04:34.977

如果它给你一个 404，很可能是因为提要生成器检查了你的用户代理或类似的，然后在它不满足要求时响应 404。

我同意 Marc：使用 WebRequest 并检查响应，它应该是 301 或 302（永久或临时重定向），然后它将包含目标 URL。

如果您的响应代码不是 301 或 302，那么它不会重定向您 - 这可能是由用户代理检查服务器端引起的。

# css - Google 搜索框的 CSS 秘密是什么？

> ID：574671
> 
> 赞同：3
> 
> 时间：2009-02-22T09:55:10.937
> 
> 标签：css, user-interface, search-box

我正在研究 Google 用来创建他们的 ui 的 css 方法。我意识到他们主页上的 css 代码没有引用他们的搜索框；它似乎只是一个裸输入标签，没有边框、背景图像或任何通常用于样式化边框的约定。然而，它不仅可以显示一种色调和一种渐变，而且它略微圆润，并且对光标焦点也有反应。

所以，你的猜测和我的一样好。请使用您的 Firebug 来检查它并帮助我解开这个谜题。

[http://www.google.com/](http://www.google.com/)

编辑：为了清楚起见，我不想做出审美判断。尽管我认为 Google 主页的极简主义非常棒，但我真的很想了解他们用来对搜索框周围的边框进行风格化的技术——而不使用任何 CSS。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-22T09:59:12.237

你用的是mac吗？不是所有的原生 UI 元素都是圆形的、发光的和变色的吗？

您是否有任何附加组件（例如 Google 工具栏）可以在您无法检测到的情况下修改页面的 UI？

编辑：问题中询问的技术实际上与 CSS 无关，与浏览器有关。Google 主页上的文本输入没有应用 CSS 样式，因此由浏览器决定它的外观。以下是该领域在 Google Chrome 中的焦点时的样子：

*删除了无效的 ImageShack 链接*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T09:58:34.017

没有秘密。这是一个普通的文本框... Google 的主页一直以极简主义着称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T10:50:16.747

不确定他们的主页，但他们在 Gmail 中也这样做，并且涉及 CSS：

```
.mFwySd:focus
{
border:2px solid #73A6FF !important; 
margin:0 !important;
outline-color:-moz-use-text-color !important; 
outline-style:none !important; 
outline-width:0 !important; 
}

.mFwySd {
background-color:#FFFFFF;
border-color:#666666 #CCCCCC #CCCCCC;
border-style:solid;
border-width:1px;
color:#000000;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T10:40:15.850

这一切都与 Chrome 有关，当您使用此浏览器专注于任何文本框时，它会应用外部发光效果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T16:10:22.147

看起来他们没有对搜索框进行样式化。但如果他们愿意，他们可以只使用本机 HTML 标记`input`。您只需在 CSS 文件中引用它。

```
input {
     padding:???;
     margin:???;
     background:url(http://www.???.???/images/???.???) #FFF no-repeat 0 0;
     color:#??????;
     text-align:????;
     font:normal ?em/?em arial;
} 
```

这只会覆盖搜索字段框。如果您需要覆盖按钮，只需在按钮输入字段中添加一个类。

我总是用`.btn`

```
input.btn {
     padding:???;
     margin:???;
     background:url(http://www.???.???/images/???.???) #FFF no-repeat 0 0;
     color:#??????;
     text-align:????;
     font:normal ?em/?em arial;
} 
```

现在，这应该使您可以完全控制`input`整个网站上的任何字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-15T02:59:22.207

现在某些浏览器（例如 firefox）能够读取 css3，您可以使用它来获得圆角半径，我现在正在使用它！虽然它还不是 w3c 有效的。

# java - 如何以编程方式将输入发送到在浏览器窗口中运行的 java 应用程序？

> ID：574672
> 
> 赞同：0
> 
> 时间：2009-02-22T09:56:23.040
> 
> 标签：java, firefox, wordle

考虑最优秀的 wordle 标签云生成器：

*   [http://www.wordle.net/create](http://www.wordle.net/create)

在“textform”文本区域中输入文本并单击 go 按钮会在该页面上启动 wordle java 小程序。没有流量返回服务器。

**我怎样才能以编程方式导致这种情况发生？没有黑客太便宜！**

这个问题的背景：

*   [“标签云”生成器？](https://stackoverflow.com/questions/574173/tag-cloud-generators)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T10:33:37.257

如果您的意思是从浏览器页面以编程方式启动它，您可以使用该页面使用的相同类型的 JavaScript，它调用函数 Wordle.t() 来启动小程序。

如果要从Java程序中调用，可以自己下载Wordle.class或者jar文件，直接调用函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-25T16:21:10.523

我是 Wordle 的创造者。

万一将来有人发现这个页面，我认为解释一下 Wordle 通过构造一个带有一个`<param>`包含您粘贴的任何文本的净化版本的小程序标签来调用它的小程序会很有用。这是可以想象的最便宜的黑客攻击。

# java - 在小程序中读取文件

> ID：574675
> 
> 赞同：1
> 
> 时间：2009-02-22T09:58:38.760
> 
> 标签：java, file, applet

您好，我想读出一个位于服务器上的文件。我通过参数获取文件的路径

```
<PARAM name=fileToRead value="http://someserver.de/file.txt"> 
```

当我现在启动小程序时，会发生以下错误

引起：java.lang.IllegalArgumentException：URI 方案不是“文件”

有人可以给我一个提示吗？

```
BufferedReader file;
                        String strFile = new String(getParameter("fileToRead"));

                        URL url = new URL(strFile);
                        URI uri = url.toURI();
                        try {

                            File theFile = new File(uri);
                            file = new BufferedReader(new FileReader(new File(uri)));

                        String input = "";

                            while ((input = file.readLine()) != null) {
                               words.add(input);
                            }
                        } catch (IOException ex) {
                          Logger.getLogger(Hedgeman.class.getName()).log(Level.SEVERE, null, ex);
                        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T10:08:16.943

```
 File theFile = new File(uri); 
```

不是正确的方法。您访问的是 URL，而不是文件。

您的代码应如下所示：

```
try
{
 URL url = new URL(strFile);
 InputStream in = url.openStream();
 (... read file...)
 in.close();
} catch(IOException err)
{
 (... process error...)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T10:06:01.080

正如错误所暗示的，您正在尝试作为文件打开，它不遵循 file:// uri。

如果你想使用 URL，我建议你只使用 url.openStream() 应该更简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T17:06:16.797

您将需要对 applet 进行签名，除非该文件是从 applet 所在的同一服务器/端口访问的。

# cocoa - 核心动画 - 片状窗口滑动

> ID：574680
> 
> 赞同：2
> 
> 时间：2009-02-22T10:02:55.067
> 
> 标签：cocoa, core-animation, nsview

使用核心动画让 NSView 像一张纸一样在视野外的幻灯片中有多难？一般来说，完成此任务将涉及什么？我一直在阅读 CA 文档，但我很难确定哪些部分与我想做的事情相关，因为我没有使用该框架的经验。

任何提示都将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T11:02:19.697

由于您说的是 NSView，因此您可能正在使用 Cocoa 的动画支持，而不是直接使用 CA。在这种情况下，您只需要通过视图的 animator 对象设置视图的框架：

```
[theView setFrame:offscreenFrame];
[[theView animator] setFrame:finalFrame]; 
```

不幸的是，Cocoa 视图动画与 CA 的更高级功能（例如设置缓动）的交互非常糟糕。使用 NSViewAnimation 可能会更幸运，因为它不是 Core Animation 支持的，并且提供了更多的灵活性。

# java - Java/J2me 中时区的通用格式

> ID：574682
> 
> 赞同：2
> 
> 时间：2009-02-22T10:05:03.643
> 
> 标签：java, java-me, timezone, sync, dst

我们正在开发一个 j2me 应用程序，用于将联系人同步到服务器/从服务器同步。我们正在为每个联系人存储更新和创建时间（长磨秒），以进行冲突解决/同步计算。

现在，由于客户端和服务器应用程序可以位于不同的时区，如何以标准格式（以注意不同时区和夏令时）存储时区时间，以便在客户端和服务器端进行计算。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T10:34:18.750

如果您使用 System.currentTimeMillis() 您不必担心时区，因为它是通用时间。从[System.currentTimeMillis() Javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/System.html#currentTimeMillis())：

公共静态长 currentTimeMillis()

[...]

返回： 当前时间与 UTC 1970 年 1 月 1 日午夜之间的差异，以毫秒为单位。

时区 UTC 是[协调世界时](http://en.wikipedia.org/wiki/Coordinated_Universal_Time)，主要是 GMT。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T10:08:21.950

我建议您将所有时间存储在 GMT+0 中，并仅在显示时转换时间。

# php - 在 Apache 和 NGINX 之间共享 PHP-CGI

> ID：574690
> 
> 赞同：2
> 
> 时间：2009-02-22T10:17:56.700
> 
> 标签：php, apache, nginx, fastcgi

我一直在我的网站上的 fastcgi 后端运行我的大部分 PHP 应用程序，由 NGINX 提供服务。我有一个新的应用程序，它似乎与 Apache 很好地集成了；例如，它严重依赖于动态编写的 .htaccess 文件。我正在修改它以与 NGINX 一起工作，但这还没有准备好。与此同时，我打算让 NGINX 代理到该路径的所有连接，直接连接到 Apache，并让 Apache 处理它。

但是，我在一个内存有限的 VPS 上，我宁愿不为 NGINX 运行一组 PHP-CGI 进程（使用它们自己的 APC 缓存）和为 Apache 运行另一组 PHP-CGI 进程（为它们的 APC 缓存使用更多内存*）*。有没有人有幸在两者之间共享 PHP？

mod_fcgid 似乎不支持使用已经运行的服务器，所以我尝试了 mod_fastcgi。起初这似乎有效，但占用了相当多的内存（承诺——它正在增长，而不仅仅是静态的）。更糟糕的是，我无法让我的 apache 配置中的 DirectoryIndex 行与 mod_fastcgi 一起使用！

我添加了

```
    AddHandler php5-fastcgi .php
    FastCgiExternalServer /var/www -host 127.0.0.1:9000

```

到我的 Apache 配置，所有 .php 页面都被处理，但是像[http://example.com/foo/](http://example.com/foo/)这样的路径不服务器 /foo/index.php！如果我删除 FastCgiExternalServer，它确实会找到 index.php，但当然只是将其显示为文本。

我假设这是因为 DirectoryIndex 在 FastCgiExternalServer 之后处理，但我不知道如何更改。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-22T19:33:42.527

问题解决了。诀窍是使用以下几行

```
FastCGIExternalServer /var/www/fast-cgi-fake-handler -host 127.0.0.1:9000
AddType application/x-httpd-fastphp5 .php
动作应用程序/x-httpd-fastphp5 /fast-cgi-fake-handler

```

Action 中的相对路径 + FastCGIExternalServer 中的完整路径做到了！

# php - MySQL 大圆距离（Haversine 公式）

> ID：574691
> 
> 赞同：192
> 
> 时间：2009-02-22T10:18:10.023
> 
> 标签：php, mysql, great-circle

我有一个有效的 PHP 脚本，它获取经度和纬度值，然后将它们输入到 MySQL 查询中。我想只做MySQL。这是我当前的 PHP 代码：

```
if ($distance != "Any" && $customer_zip != "") { //get the great circle distance

    //get the origin zip code info
    $zip_sql = "SELECT * FROM zip_code WHERE zip_code = '$customer_zip'";
    $result = mysql_query($zip_sql);
    $row = mysql_fetch_array($result);
    $origin_lat = $row['lat'];
    $origin_lon = $row['lon'];

    //get the range
    $lat_range = $distance/69.172;
    $lon_range = abs($distance/(cos($details[0]) * 69.172));
    $min_lat = number_format($origin_lat - $lat_range, "4", ".", "");
    $max_lat = number_format($origin_lat + $lat_range, "4", ".", "");
    $min_lon = number_format($origin_lon - $lon_range, "4", ".", "");
    $max_lon = number_format($origin_lon + $lon_range, "4", ".", "");
    $sql .= "lat BETWEEN '$min_lat' AND '$max_lat' AND lon BETWEEN '$min_lon' AND '$max_lon' AND ";
    } 
```

有谁知道如何使这个完全 MySQL ？我浏览了一些互联网，但大多数关于它的文献都很混乱。

* * *

## 回答 #1

> 赞同：374
> 
> 时间：2009-02-22T11:04:31.847

来自[Google Code FAQ - Creating a Store Locator with PHP, MySQL & Google Maps](http://web.archive.org/web/20170126150533/https://developers.google.com/maps/articles/phpsqlsearch_v3)：

> 下面的 SQL 语句将找到距离 37, -122 坐标 25 英里半径范围内最近的 20 个位置。它根据该行的纬度/经度和目标纬度/经度计算距离，然后仅询问距离值小于 25 的行，按距离对整个查询进行排序，并将其限制为 20 个结果。要按公里而不是英里搜索，请将 3959 替换为 6371。

```
SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) 
* cos( radians( lng ) - radians(-122) ) + sin( radians(37) ) * sin(radians(lat)) ) ) AS distance 
FROM markers 
HAVING distance < 25 
ORDER BY distance 
LIMIT 0 , 20; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-22T11:19:48.393

`$greatCircleDistance = acos( cos($latitude0) * cos($latitude1) * cos($longitude0 - $longitude1) + sin($latitude0) * sin($latitude1));`

以弧度为单位的纬度和经度。

所以

```
SELECT 
  acos( 
      cos(radians( $latitude0 ))
    * cos(radians( $latitude1 ))
    * cos(radians( $longitude0 ) - radians( $longitude1 ))
    + sin(radians( $latitude0 )) 
    * sin(radians( $latitude1 ))
  ) AS greatCircleDistance 
 FROM yourTable; 
```

是你的 SQL 查询

要获得以公里或英里为单位的结果，请将结果乘以地球的平均半径（`3959`英里、`6371`公里或`3440`海里）

您在示例中计算的是一个边界框。如果您将坐标数据放在[启用了空间的 MySQL 列](http://dev.mysql.com/doc/refman/5.0/en/gis-introduction.html)中，则可以使用[MySQL 的内置功能](http://dev.mysql.com/doc/refman/5.0/en/relations-on-geometry-mbr.html)来查询数据。

```
SELECT 
  id
FROM spatialEnabledTable
WHERE 
  MBRWithin(ogc_point, GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))')) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-09-02T13:54:04.557

如果将帮助字段添加到坐标表中，可以提高查询的响应时间。

像这样：

```
CREATE TABLE `Coordinates` (
`id` INT(10) UNSIGNED NOT NULL COMMENT 'id for the object',
`type` TINYINT(4) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'type',
`sin_lat` FLOAT NOT NULL COMMENT 'sin(lat) in radians',
`cos_cos` FLOAT NOT NULL COMMENT 'cos(lat)*cos(lon) in radians',
`cos_sin` FLOAT NOT NULL COMMENT 'cos(lat)*sin(lon) in radians',
`lat` FLOAT NOT NULL COMMENT 'latitude in degrees',
`lon` FLOAT NOT NULL COMMENT 'longitude in degrees',
INDEX `lat_lon_idx` (`lat`, `lon`)
) 
```

如果您使用的是 TokuDB，如果您在任一谓词上添加集群索引，您将获得更好的性能，例如，如下所示：

```
alter table Coordinates add clustering index c_lat(lat);
alter table Coordinates add clustering index c_lon(lon); 
```

对于每个点，您需要以度数为单位的基本纬度和经度以及以弧度表示的 sin(lat)、以弧度表示的 cos(lat)*cos(lon) 和以弧度表示的 cos(lat)*sin(lon)。然后你创建一个mysql函数，像这样：

```
CREATE FUNCTION `geodistance`(`sin_lat1` FLOAT,
                              `cos_cos1` FLOAT, `cos_sin1` FLOAT,
                              `sin_lat2` FLOAT,
                              `cos_cos2` FLOAT, `cos_sin2` FLOAT)
    RETURNS float
    LANGUAGE SQL
    DETERMINISTIC
    CONTAINS SQL
    SQL SECURITY INVOKER
   BEGIN
   RETURN acos(sin_lat1*sin_lat2 + cos_cos1*cos_cos2 + cos_sin1*cos_sin2);
   END 
```

这给了你距离。

不要忘记在纬度/经度上添加索引，这样边界框可以帮助搜索而不是减慢搜索速度（索引已经添加到上面的 CREATE TABLE 查询中）。

```
INDEX `lat_lon_idx` (`lat`, `lon`) 
```

给定一个只有纬度/经度坐标的旧表，您可以设置一个脚本来更新它，如下所示：（使用 meekrodb 的 php）

```
$users = DB::query('SELECT id,lat,lon FROM Old_Coordinates');

foreach ($users as $user)
{
  $lat_rad = deg2rad($user['lat']);
  $lon_rad = deg2rad($user['lon']);

  DB::replace('Coordinates', array(
    'object_id' => $user['id'],
    'object_type' => 0,
    'sin_lat' => sin($lat_rad),
    'cos_cos' => cos($lat_rad)*cos($lon_rad),
    'cos_sin' => cos($lat_rad)*sin($lon_rad),
    'lat' => $user['lat'],
    'lon' => $user['lon']
  ));
} 
```

然后，您优化实际查询以仅在真正需要时进行距离计算，例如通过从内部和外部限制圆形（嗯，椭圆形）。为此，您需要为查询本身预先计算几个指标：

```
// assuming the search center coordinates are $lat and $lon in degrees
// and radius in km is given in $distance
$lat_rad = deg2rad($lat);
$lon_rad = deg2rad($lon);
$R = 6371; // earth's radius, km
$distance_rad = $distance/$R;
$distance_rad_plus = $distance_rad * 1.06; // ovality error for outer bounding box
$dist_deg_lat = rad2deg($distance_rad_plus); //outer bounding box
$dist_deg_lon = rad2deg($distance_rad_plus/cos(deg2rad($lat)));
$dist_deg_lat_small = rad2deg($distance_rad/sqrt(2)); //inner bounding box
$dist_deg_lon_small = rad2deg($distance_rad/cos(deg2rad($lat))/sqrt(2)); 
```

鉴于这些准备工作，查询如下所示（php）：

```
$neighbors = DB::query("SELECT id, type, lat, lon,
       geodistance(sin_lat,cos_cos,cos_sin,%d,%d,%d) as distance
       FROM Coordinates WHERE
       lat BETWEEN %d AND %d AND lon BETWEEN %d AND %d
       HAVING (lat BETWEEN %d AND %d AND lon BETWEEN %d AND %d) OR distance <= %d",
  // center radian values: sin_lat, cos_cos, cos_sin
       sin($lat_rad),cos($lat_rad)*cos($lon_rad),cos($lat_rad)*sin($lon_rad),
  // min_lat, max_lat, min_lon, max_lon for the outside box
       $lat-$dist_deg_lat,$lat+$dist_deg_lat,
       $lon-$dist_deg_lon,$lon+$dist_deg_lon,
  // min_lat, max_lat, min_lon, max_lon for the inside box
       $lat-$dist_deg_lat_small,$lat+$dist_deg_lat_small,
       $lon-$dist_deg_lon_small,$lon+$dist_deg_lon_small,
  // distance in radians
       $distance_rad); 
```

对上述查询的解释可能会说它不使用索引，除非有足够的结果来触发它。当坐标表中有足够的数据时，将使用索引。您可以将 FORCE INDEX (lat_lon_idx) 添加到 SELECT 以使其使用索引而不考虑表大小，因此您可以使用 EXPLAIN 验证它是否正常工作。

使用上面的代码示例，您应该有一个按距离进行对象搜索的工作且可扩展的实现，并且误差最小。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-07-25T12:19:02.870

我不得不在一些细节上解决这个问题，所以我会分享我的结果。这使用`zip`带有`latitude`和表的`longitude`表。它不依赖于谷歌地图；相反，您可以将其调整为任何包含纬度/经度的表格。

```
SELECT zip, primary_city, 
       latitude, longitude, distance_in_mi
  FROM (
SELECT zip, primary_city, latitude, longitude,r,
       (3963.17 * ACOS(COS(RADIANS(latpoint)) 
                 * COS(RADIANS(latitude)) 
                 * COS(RADIANS(longpoint) - RADIANS(longitude)) 
                 + SIN(RADIANS(latpoint)) 
                 * SIN(RADIANS(latitude)))) AS distance_in_mi
 FROM zip
 JOIN (
        SELECT  42.81  AS latpoint,  -70.81 AS longpoint, 50.0 AS r
   ) AS p 
 WHERE latitude  
  BETWEEN latpoint  - (r / 69) 
      AND latpoint  + (r / 69)
   AND longitude 
  BETWEEN longpoint - (r / (69 * COS(RADIANS(latpoint))))
      AND longpoint + (r / (69 * COS(RADIANS(latpoint))))
  ) d
 WHERE distance_in_mi <= r
 ORDER BY distance_in_mi
 LIMIT 30 
```

查看该查询中间的这一行：

```
 SELECT  42.81  AS latpoint,  -70.81 AS longpoint, 50.0 AS r 
```

这将搜索`zip`表中距离纬度/经度点 42.81/-70.81 50.0 英里范围内最近的 30 个条目。当您将其构建到应用程序中时，您可以在其中放置自己的点和搜索半径。

如果您想以公里而不是英里为单位工作，请在查询中更改`69`为`111.045`和更改`3963.17`为`6378.10`。

这里有详细的写法。我希望它可以帮助某人。 [http://www.plumislandmedia.net/mysql/haversine-mysql-nearest-loc/](http://www.plumislandmedia.net/mysql/haversine-mysql-nearest-loc/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-02T11:24:39.797

```
 SELECT *, (  
    6371 * acos(cos(radians(search_lat)) * cos(radians(lat) ) *   
cos(radians(lng) - radians(search_lng)) + sin(radians(search_lat)) *         sin(radians(lat)))  
) AS distance  
FROM table  
WHERE lat != search_lat AND lng != search_lng AND distance < 25  
 ORDER BY distance  
FETCH 10 ONLY 
```

距离 25 公里

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-29T04:08:21.610

我已经编写了一个可以计算相同的程序，但是您必须在相应的表格中输入纬度和经度。

```
drop procedure if exists select_lattitude_longitude;

delimiter //

create procedure select_lattitude_longitude(In CityName1 varchar(20) , In CityName2 varchar(20))

begin

    declare origin_lat float(10,2);
    declare origin_long float(10,2);

    declare dest_lat float(10,2);
    declare dest_long float(10,2);

    if CityName1  Not In (select Name from City_lat_lon) OR CityName2  Not In (select Name from City_lat_lon) then 

        select 'The Name Not Exist or Not Valid Please Check the Names given by you' as Message;

    else

        select lattitude into  origin_lat from City_lat_lon where Name=CityName1;

        select longitude into  origin_long  from City_lat_lon where Name=CityName1;

        select lattitude into  dest_lat from City_lat_lon where Name=CityName2;

        select longitude into  dest_long  from City_lat_lon where Name=CityName2;

        select origin_lat as CityName1_lattitude,
               origin_long as CityName1_longitude,
               dest_lat as CityName2_lattitude,
               dest_long as CityName2_longitude;

        SELECT 3956 * 2 * ASIN(SQRT( POWER(SIN((origin_lat - dest_lat) * pi()/180 / 2), 2) + COS(origin_lat * pi()/180) * COS(dest_lat * pi()/180) * POWER(SIN((origin_long-dest_long) * pi()/180 / 2), 2) )) * 1.609344 as Distance_In_Kms ;

    end if;

end ;

//

delimiter ; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-24T19:38:43.923

我无法对上述答案发表评论，但要小心@Pavel Chuchuva 的答案。如果两个坐标相同，该公式将不会返回结果。在这种情况下，距离为空，因此该行不会按原样返回该公式。

我不是 MySQL 专家，但这似乎对我有用：

```
SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(-122) ) + sin( radians(37) ) * sin( radians( lat ) ) ) ) AS distance 
FROM markers HAVING distance < 25 OR distance IS NULL ORDER BY distance LIMIT 0 , 20; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-15T07:57:09.300

我认为我的 javascript 实现将是一个很好的参考：

```
/*
 * Check to see if the second coord is within the precision ( meters )
 * of the first coord and return accordingly
 */
function checkWithinBound(coord_one, coord_two, precision) {
    var distance = 3959000 * Math.acos( 
        Math.cos( degree_to_radian( coord_two.lat ) ) * 
        Math.cos( degree_to_radian( coord_one.lat ) ) * 
        Math.cos( 
            degree_to_radian( coord_one.lng ) - degree_to_radian( coord_two.lng ) 
        ) +
        Math.sin( degree_to_radian( coord_two.lat ) ) * 
        Math.sin( degree_to_radian( coord_one.lat ) ) 
    );
    return distance <= precision;
}

/**
 * Get radian from given degree
 */
function degree_to_radian(degree) {
    return degree * (Math.PI / 180);
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-02-06T08:58:52.153

在Mysql中计算距离

```
 SELECT (6371 * acos(cos(radians(lat2)) * cos(radians(lat1) ) * cos(radians(long1) -radians(long2)) + sin(radians(lat2)) * sin(radians(lat1)))) AS distance 
```

因此将计算距离值，任何人都可以根据需要申请。

# sql - SQL 2005 存储过程返回值或创建它，如果它不存在

> ID：574692
> 
> 赞同：1
> 
> 时间：2009-02-22T10:18:15.937
> 
> 标签：sql, stored-procedures

我在使用存储过程 (SQL 2005) 时遇到问题。

我有一个名为`tbrm_Tags`两列的表，`TagID`并且`TagName`. 我想将一个`TagName`值传递给存储过程，然后我想：

1.  检查是否`Tagname`存在以及是否返回`TagID`
2.  如果`Tagname`不存在，我希望它插入表中并返回`TagID`.

这是我正在使用的存储过程：

```
 @TagID int = null,
  @TagName varchar(50)  

AS

DECLARE @returnValue int

  BEGIN
  IF EXISTS (SELECT * FROM tbrm_Tags WHERE TagName = @TagName)
  BEGIN

  SELECT

  TagID

  FROM tbrm_Tags

  WHERE TagName = @TagName

END
ELSE
BEGIN
IF NOT EXISTS (SELECT * FROM tbrm_Tags WHERE TagName = @TagName)

   INSERT INTO tbrm_Tags

  (
    TagName

  )
  VALUES
  (
    @TagName

      )

  SELECT @returnValue = @@IDENTITY

  END
  END

  RETURN @returnValue 
```

我无法让 select 语句`TagID`在`Tagname`存在时返回。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-22T10:25:03.203

注意：不要使用`@@IDENTITY`- 它会受到触发；总是使用`SCOPE_IDENTITY()`

我可能会这样做：

```
DECLARE @returnValue int

SELECT @returnValue = TagID
FROM tbrm_Tags
WHERE TagName = @TagName

IF @returnValue IS NULL
BEGIN
     INSERT tbrm_Tags(TagName)
     VALUES (@TagName)

     SET @returnValue = SCOPE_IDENTITY()
END

RETURN @returnValue 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T10:20:58.080

```
SELECT

@returnValue = TagID

FROM tbrm_Tags

WHERE TagName = @TagName 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T10:33:38.300

我怀疑 Marc G. 的代码可以正常工作，但我会像这样写最后一行：

```
SELECT @returnValue AS RETURNVALUE 
```

我一直都是这样做的，但我不确定这两种方法之间是否存在任何功能差异……有人知道吗？

# linux - “while (sleep 100 &!) do; done”如何在 zsh 中工作，如何在 bash 中复制？

> ID：574695
> 
> 赞同：14
> 
> 时间：2009-02-22T10:20:44.057
> 
> 标签：linux, bash, shell, zsh

根据[Wikipedia](http://en.wikipedia.org/wiki/Fork_bomb)`:(){ :|:& };:`的说法，可以使用 zsh 命令停止forkbomb `while (sleep 100 &!) do; done`，这应该会产生 sleep 100 进程，直到所有 forkbomb 进程都消失。这似乎很神奇；它是如何工作的？我特别好奇到底是什么“&！” 方法。

bash 中的等效命令是什么样的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-22T12:02:45.327

分叉炸弹起作用的原因是因为在任何时候可以运行的进程数量是有限的，而分叉炸弹就是为了填补这个限制而设计的。

因为您提供的 forkbomb 代码如果无法生成子进程就会死掉，因此父进程实际上并没有闲逛，但是子进程不断创建新的 grand*-children 的事实使进程表保持满了。

因此，睡眠解决方案旨在潜入一些仅睡眠一小段时间的进程，并且对于每个设法创建的睡眠进程，发生的分叉炸弹更少。最终，睡眠进程自己填满了进程表，叉子炸弹消失了。

一旦进程表满了 sleep 进程，while 循环就可以被杀死，并且一旦它们的睡眠时间到了，sleep 进程就会死掉。*问题解决了*。

正如已经提到的 zsh 命令的重要部分是 run-in-background `&`，因此 bash 命令基本上与其他答案中给出的相同：

```
while (sleep 100 &) do; done 
```

除非您想在睡眠时间内注销，否则我认为`nohup`/`!`部分并不重要，但如果我错了，我很乐意直言不讳。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-22T10:45:14.717

首先叉子炸弹可以写成：

```
foo()
{
    foo|foo&
}
foo 
```

这使它更清楚一点 - 每次迭代都会启动两个子进程，然后终止。所以如果分叉失败，它就不会挂起。

因此，我们要做的就是让分叉暂时失败。因此，我们创建了睡眠 100 并占用进程空间的进程，就像睡眠进程一样。

zsh`&!`就像`&`但不承认新进程（在注销时不会杀死它） - 在这个例子中它可能并不重要。（[手动](http://zsh.sourceforge.net/Doc/Release/zsh_9.html#SEC35)）它可以替换为`nohup`。

因此bash：

```
while (nohup sleep 100 &) do; done 
```

应该管用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-28T07:34:51.840

我是撰写维基百科文章那部分的人（并且在我的系统上意外启动了叉形炸弹后“发现”了这种治疗方法！）。

“&！”的原因 而不是 "&" 确实是为了防止 zsh 对新进程进行工作控制，即试图关心它何时以及是否完成。我不记得为什么在我尝试工作控制时会出现问题，但确实如此。您实际上可以尝试一下，看看“治愈”是如何工作的，以及如果您不阻止工作控制会发生什么。也许作业控制的问题与 zsh 中的一些错误有关，而这些错误在 bash 中甚至不存在，并且可能在 zsh 中也不再相关。

所以尝试使用 bash 的“&”，如果作业控制受到干扰，请尝试禁用它（“set +m”），希望这会起作用。

你说得对，维基百科文章可能不应该依赖于 zsh。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T10:42:34.893

非常有趣的问题！

根据那篇维基百科文章，完整命令的目的是创建许多无害的作业，这些作业将禁用分叉炸弹，因为它将不再能够产生更多的孩子。

根据[zsh手册](http://zsh.sourceforge.net/Doc/Release/zsh_9.html#SEC35)，

> 如果作业以`&|' or`&!' 开头，则该作业将立即被拒绝。启动后，它在作业表中没有位置，不受此处描述的作业控制功能的约束。

我不确定如何使用 bash 实现相同的效果。但是，可能会执行以下操作：

```
nohup sleep 100 & 
```

# jquery - 使用 URL 中的参数选择 jQuery 选项卡

> ID：574699
> 
> 赞同：20
> 
> 时间：2009-02-22T10:28:49.107
> 
> 标签：jquery, jquery-ui, tabs

我目前正在研究用 jQuery UI 提供的选项卡替换[Struts](http://en.wikipedia.org/wiki/Apache_Struts) 1 标记库提供的选项卡。我已成功设法将选项卡与现有应用程序集成，但我正在努力解决如何使用传入 URL 上的参数设置选定选项卡，即 myurl.com/action.do?selectedTab=SecondTab。

我是 JavaScript 和 jQuery 的新手；关于从哪里开始有哪些指示？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-06-14T12:59:45.327

Jquery-UI 为您提供（几乎）免费的：使用内部链接。而且比使用丑陋的get参数要好。

在导航器中传递**[http://my.site.org/mypage/#foo-tab](http://my.site.org/mypage/#foo-tab)**将自动选择具有 id="foo-tab" 的容器的选项卡。

诀窍是在选择选项卡时添加一个事件以更新 url，以便在重新加载时不会丢失当前选项卡：

```
 $(document).ready(function () {
        $("#tabs").bind('tabsselect', function(event, ui) {
            window.location.href=ui.tab;
        });
    }); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-22T10:45:03.937

使用[http://www.mathias-bank.de/2007/04/21/jquery-plugin-geturlparam-version-2](http://www.mathias-bank.de/2007/04/21/jquery-plugin-geturlparam-version-2)：

```
$(document).ready(function(){
    var param = $(document).getUrlParam('selectedTab');
    $('#menu').tabs('select', param);
}); 
```

从[文档](http://docs.jquery.com/UI/Tabs#methods)：

```
#select 
```

签名：

```
.tabs( 'select' , [index] ) 
```

选择一个选项卡，就像单击它一样。第二个参数是要选择的选项卡的从零开始的索引或与选项卡关联的面板的 id 选择器（选项卡的 href 片段标识符，例如哈希，指向面板的 id）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T10:34:23.633

jQuery 插件的以下链接似乎是解决方案的可能候选者，因为它为您提供了 URL 和组件部分。然后，您可以通过 jQuery 选择器将值与要选择的选项卡的索引或按 id 或类匹配：

[http://www.oakcitygraphics.com/jquery/jqURL/jqURLdemo.html?var1=1&var2=2&var3=3](http://www.oakcitygraphics.com/jquery/jqURL/jqURLdemo.html?var1=1&var2=2&var3=3)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-14T20:01:54.407

我有一个稍微不同的方法，它不一定依赖内置的 select() 函数，但确实使用 livequery 插件：

[http://plugins.jquery.com/project/livequery/](http://plugins.jquery.com/project/livequery/)

这是 jQuery live 功能的更强大的版本。它可以轻松绑定匹配查询的未来元素。

假设你有一个如下的标签结构：

```
<div class="Tabs">
<ul class="nav">
<li><a id="tab1">Link 1</a></li>
<li><a id="tab2">Link 2</a></li>
<li><a id="tab3">Link 3</a></li>
</ul>
..
..
</div> 
```

理想情况下，您需要这样的 URL 结构：

```
mydomain/mypage?tab=tab2 
```

它变得相当棘手，因为 select() 方法只支持整数索引，当你改变你的标签时会发生什么？

假设您可以将 url 参数放入如上所述的变量中以执行以下操作：

首先你找到你的目标元素并向它添加一个类：

```
jQuery('a#' + param).addClass('selectMe'); 
```

接下来，将 livequery 函数绑定到元素：

```
jQuery('.ui-tabs-nav a.selectMe').livequery(function(){
 jQuery(this).removeClass('selectMe').triggerHandler('click');
}); 
```

只有当它被标签化并虚拟地“点击”它时，它才会匹配它。

然后，您可以不带参数调用您的选项卡函数：

```
jQuery(".Tabs").tabs(); 
```

完成后，将自动单击并选择选项卡！

更好的是，您可以将选项卡创建绑定到 livequery 本身：

```
jQuery(".Tabs").livequery(function(){
    jQuery(this).tabs();    
}); 
```

这样您在类“.Tabs”中拥有的任何元素都会在加载时自动转换为选项卡，现在或将来！

# svn - 使用登录名签出 svn+ssh

> ID：574701
> 
> 赞同：7
> 
> 时间：2009-02-22T10:31:09.103
> 
> 标签：svn, console

我想从存储库中签出一些东西..但是我输入：

```
svn co svn+ssh://URL 
```

我被要求输入密码。我想他使用了我控制台中的用户名，这不一样。

那么我怎样才能用 svn+ssh 用不同的登录名签出一些东西呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-22T10:43:58.277

SSH 允许您在连接 URL 中选择用户：

```
svn co svn+ssh://alabaster@URL 
```

# c# - 什么是应用域？

> ID：574708
> 
> 赞同：143
> 
> 时间：2009-02-22T10:37:32.830
> 
> 标签：c#, .net, appdomain

什么是[AppDomain](http://en.wikipedia.org/wiki/Application_Domain)？AppDomains 的好处是什么，或者为什么微软提出了 AppDomains 的概念，没有 AppDomains 的问题是什么？

请详细说明。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-02-22T10:40:53.977

An`AppDomain`在进程中提供了一层隔离。您通常认为“每个程序”（静态变量等）的所有内容实际上都是每个 AppDomain。这对于：

*   插件（您可以卸载`AppDomain`，但不能卸载 中的*程序*集`AppDomain`）
*   安全性（您可以运行一组具有特定信任级别的代码）
*   隔离（您可以运行不同版本的程序集等）

痛苦是您需要使用远程处理等。

有关更多信息，[请参阅 MSDN 。](http://msdn.microsoft.com/en-us/library/cxk374d9.aspx)老实说，这不是你需要经常搞砸的事情。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-09-02T03:09:47.983

一个应用程序域实现了一个连续的虚拟内存空间的概念，它保存了可以直接访问或引用的代码和内存中的资源。

单独的 AppDomain 不共享内存空间，因此一个 AppDomain 不能直接引用另一个 AppDomain 中的内容。特别是，数据必须通过按值复制过程在 AppDomain 之间传递。特别是，依赖于指针和内存地址的引用对象必须首先从源序列化，然后反序列化到目标 AppDomain。

以前在 Windows 系统上，内存边界是由进程实现的；然而，构建流程是资源密集型的。它们还具有作为线程边界的双重目的。另一方面，应用程序域只关心内存边界或地址空间。线程可以在 AppDomain 中“流动”（也就是说，一个过程可以调用另一个 AppDomain 中的入口点并等待它返回。线程被称为“继续”在另一个 AppDomain 中执行）。

这种架构的一个显着好处是应用域之间的通信模式基本上保持不变，无论应用域在同一进程中、不同进程中还是在不同机器上：即参数数据的序列化和反序列化（编组）过程.

注意 1：跨 AppDomain 的线程的含义是对另一个 AppDomain 的阻塞或同步方法调用（相对于非阻塞或异步调用，后者将产生另一个线程以继续在目标 AppDomain 中执行并在其当前 AppDomain 中继续执行无需等待回复）。

注2：有线程本地存储之类的东西。但是，一个更好的名称应该是 App-Domain Thread Local Storage，因为线程在跨 App-Domains 时将其数据留在后面，但在返回时将其取回：http: [//msdn.microsoft.com/en-us/library /6sby1byh.aspx](http://msdn.microsoft.com/en-us/library/6sby1byh.aspx)

注意 3：.Net 运行时是具有关联堆的 Windows 进程应用程序。它可能在该堆中托管一个或多个 AppDomain。但是，AppDomain 被设计为相互忽略并通过编组相互通信。可以想象，可以执行一种优化，绕过共享相同 .Net 运行时的通信 AppDomain 之间的封送处理，因此共享相同的 Windows 进程堆。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-02-22T10:59:12.700

AppDomain 可以被视为轻量级进程。它们共享进程的许多相同特征，例如，它们有自己的静态、程序集等副本，但它们包含在单个进程中。从操作系统的角度来看，一个进程只是一个进程，不管它可能包含多少个 AppDomain。

然而，与进程不同的是，AppDomain 没有任何线程，除非您明确创建它们。线程可以在任何 AppDomain 中运行代码。

AppDomain 是同一进程的一部分，因此实际上共享相同的托管堆。这通常不是问题，因为 AppDomain 编程模型阻止了 AppDomain 之间的隐式访问。但是，一些引用实际上是在 AppDomain 之间共享的，例如类型对象和内部字符串。

# html - HTML, CSS 编辑

> ID：574713
> 
> 赞同：1
> 
> 时间：2009-02-22T10:42:35.657
> 
> 标签：html, css, xhtml

我写了一些 html 代码并想使用 css 编辑它的视图

```
 <div id="contact_4" name="contact" >
                <input type="checkbox" id="chk_4" class="contactChk"/>
                <img height="25" width="25" alt="" src="Images/Contacts/1.jpg" style="width: 30px; height: 35px;"/>
                <span class="contactItem" id="contactName_4" name="contactName">
                    Amr ElGarhy
                </span>
                <img src="Images/Common/Motiva.png" alt=""/>
                <br/>
            </div> 
```

[替代文字 http://igurr.com/resized-image.ashx/__size/500x400/__key/CommunityServer.Components.PostAttachments/00.00.00.01.73/OneContact.JPG](http://igurr.com/resized-image.ashx/__size/500x400/__key/CommunityServer.Components.PostAttachments/00.00.00.01.73/OneContact.JPG)

我想要做的是使文本和图像在主 div 中垂直对齐，如果有人知道如何在不使用任何表格而只使用 CSS 的情况下这样做，请告诉我是否必须编辑 html 本身。

更新：我希望主 div 中的所有内容都垂直居中对齐。正如您在图像中看到的那样，默认情况下，文本、复选框和 2 个图像底部对齐，我想覆盖它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T11:15:24.160

做这个：

```
#contact_4 * {      
    vertical-align: middle;
    display: inline;
} 
```

“显示：内联；” 如果您没有其他样式更改这些元素的显示类型，则不需要。

PS div 和 span 元素没有“名称”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T10:58:02.267

我不是 CSS 的专家，但也许将这些放在所有元素上会有所帮助：

```
margin-top: auto;
margin-bottom: auto; 
```

# xml - REXML 保留属性顺序

> ID：574724
> 
> 赞同：3
> 
> 时间：2009-02-22T10:58:16.463
> 
> 标签：xml, ruby

我尝试使用 REXML 生成这样的 XML

```
<root>
  <add key='foo' value='bar'/>
</root> 
```

但我得到的是（注意键/值顺序）

```
<root>
  <add value='bar' key='foo'/>
</root> 
```

代码：

```
require 'rexml/document'
include REXML

doc = Document.new
doc.add_element('root')
el = doc.root.add_element('add')
el.add_attribute('key', 'foo')
el.add_attribute('value', 'bar')
puts doc 
```

我写没关系：

```
el.add_attribute('key', 'foo')
el.add_attribute('value', 'bar') 
```

或者

```
el.add_attribute('value', 'bar')
el.add_attribute('key', 'foo') 
```

结果是一样的。看起来 REXML 使用一些字典来保留属性......

我可以强制执行所需的顺序：键/值吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T11:19:50.030

在 XML 中，属性的顺序无关紧要。如果您有一些 XML 处理代码确实很重要，那么我建议该代码有错误。

从[这里](http://www.w3.org/TR/2004/REC-xml11-20040204/#NT-Attribute)的 XML 规范中，请注意以下短语：“请注意，开始标记或空元素标记中属性规范的顺序并不重要”。

在回答您是否可以执行某个命令的具体问题时，我不相信。我从来没有真正尝试过这样做（因为它是不必要的），但 REXML 人似乎不太可能浪费时间来实现这样一个非功能:-)。由于键/值对存储为散列，因此它们的顺序可能是随机的（从键的字母顺序可以看出）。

当然，由于 Ruby 附带了 REXML 的源代码，您可以（如果绝望）用您自己的版本（REXML2 ？）替换或扩充包含的副本。

由于您正在执行简单的放置操作，因此它可能使用漂亮的格式化程序，因此请检查执行“ ”的`write_element`代码的开头- 您可能会发现它就像在处理元素之前对该列表进行排序一样简单。`src/rexml/formatters/pretty.rb``node.attributes.each_attribute do |attr|`

您可能还想向开发人员建议（请参阅[此处](http://www.germane-software.com/software/XML/rexml/index.html#id2248285)的邮件列表或[此处](http://trac.germane-software.com//rexml)的错误报告和增强请求），他们在未来的版本中将此作为选项，但如果我是他们，我只会说这是不必要的.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-21T17:56:19.847

您可以尝试使用 ad-hoc `REXML::Formatter`，而无需接触 REXML 源。[ruby-talk ml 上的一篇文章](http://www.ruby-forum.com/topic/196014)建议使用以下代码：

```
class OrderedAttributes < REXML::Formatters::Pretty
    def write_element(elm, out)
        att = elm.attributes

        class <<att
            alias _each_attribute each_attribute

            def each_attribute(&b)
                to_enum(:_each_attribute).sort_by {|x| x.name}.each(&b)
            end
        end

        super(elm, out)
    end
end

fmt = OrderedAttributes.new
fmt.write(doc, $stdout) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T21:46:26.920

如果您正在修改配置文件并且格式很重要，那么通过 REXML 读取它可能更容易，但通过正则表达式进行修改。

另外，请记住，通过 REXML 生成大量 XML 非常慢。我有一个站点必须同时读取和写入大量 XML；我发现对于阅读，REXML 足够快，但对于写作，我必须使用 libxml。实际上，libxml 安装起来很麻烦，而且它的 ruby​​ 库还很不成熟，以至于我最终使用 erb 来替换已经编写的 XML 文档的某些部分。

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T22:36:18.217

想要保留属性序列有很多正当理由。最重要的是验证任何修改 XML 的程序。维护属性序列后，可以使用简单的 diff 验证对文档的更改。保留将要显示给用户的信息序列是另一回事。出于性能原因，XML 标准采用了使用哈希映射的路径，但我认为规范中缺少维护顺序的功能是一个主要限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-20T11:48:44.940

gioele 优秀解决方案的简化版本：

如果我们对属性列表进行排序，那么输出是确定性的，这是避免生成的 XML 文档版本之间虚假更改的重要因素。

将这 8 行添加到您的脚本或应用程序中，使属性随处排序，无需进一步更改（例如，修改您编写 XML 的方式，或查找元素隐式转换为字符串的每个位置并将其更改为使用格式化程序）。

```
# make REXML sort attributes by name so output is deterministic
module REXML
  class Attributes
    alias _each_attribute each_attribute
    def each_attribute(&b)
      to_enum(:_each_attribute).sort_by {|x| x.name}.each(&b)
    end
  end
end 
```

# c# - 这怎么不会导致堆栈溢出？

> ID：574727
> 
> 赞同：4
> 
> 时间：2009-02-22T11:01:34.943
> 
> 标签：c#

我正在查看使用 SocketAsyncEventArgs 的服务器的源代码，并试图弄清楚这不会导致堆栈溢出：

因此，调用此代码以允许套接字接受传入连接（向下滚动到底部以了解我的意思）：

```
/// <summary>
/// Begins an operation to accept a connection request from the client.
/// </summary>
/// <param name="acceptEventArg">The context object to use when issuing 
/// the accept operation on the server's listening socket.</param>
private void StartAccept(SocketAsyncEventArgs acceptEventArg)
{
    if (acceptEventArg == null)
    {
        acceptEventArg = new SocketAsyncEventArgs();
        acceptEventArg.Completed += new EventHandler<SocketAsyncEventArgs>(OnAcceptCompleted);
    }
    else
    {
        // Socket must be cleared since the context object is being reused.
        acceptEventArg.AcceptSocket = null;
    }

    this.semaphoreAcceptedClients.WaitOne();
    Boolean willRaiseEvent = this.listenSocket.AcceptAsync(acceptEventArg);
    if (!willRaiseEvent)
    {
        this.ProcessAccept(acceptEventArg);
    }
} 
```

然后在实际接受连接后调用此代码（请参见最后一行）：

```
 /// <summary>
        /// Process the accept for the socket listener.
        /// </summary>
        /// <param name="e">SocketAsyncEventArg associated with the completed accept operation.</param>
        private void ProcessAccept(SocketAsyncEventArgs e)
        {
            if (e.BytesTransferred > 0)
            {
                Interlocked.Increment(ref this.numConnectedSockets);
                Console.WriteLine("Client connection accepted. There are {0} clients connected to the server",
                    this.numConnectedSockets);
            }

            // Get the socket for the accepted client connection and put it into the 
            // ReadEventArg object user token.
            SocketAsyncEventArgs readEventArgs = this.readWritePool.Pop();
            readEventArgs.UserToken = e.AcceptSocket;

            // As soon as the client is connected, post a receive to the connection.
            Boolean willRaiseEvent = e.AcceptSocket.ReceiveAsync(readEventArgs);
            if (!willRaiseEvent)
            {
                this.ProcessReceive(readEventArgs);
            }

            // Accept the next connection request.
            this.StartAccept(e); // <==== tail end recursive?
        } 
```

看最后一行。它再次调用顶部函数。这如何不会通过在这两个函数之间来回乒乓来溢出堆栈？这似乎是尾端递归，但这不是 Haskell，所以我不知道它是如何工作的。

我的理解是这些不是在线程中触发的，而是由 cpu 一次执行一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T11:11:40.753

看代码：

```
if (!willRaiseEvent)
{
    this.ProcessAccept(acceptEventArg);
} 
```

虽然我还不了解整个机制，但 willRaiseEvent == true 显然会结束递归，所以我猜这发生了所以它不是无限递归。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T11:21:20.683

如果 AsyncAccept（或任何 AsyncXXX 操作）不能立即得到满足，那么它将返回 true，表示操作将异步完成。发生这种情况时，回调事件最终将在线程池线程上触发。即使它编组回到 UI 线程（因为它是从那里启动的），它也会通过帖子这样做。

AsyncAccept*很有*可能返回 true，因为除非有真正待处理的套接字连接（参见[Listen](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.listen.aspx)中的积压工作），否则您正在等待客户端连接。

因此，StartAccept() 将直接退出而不调用 ProcessAccept，并且 ProcessAccept 当（以及如果）它触发时，可能会在不同的线程上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T11:12:05.633

这完全取决于`willCauseEvent`标志，当设置为 true 时会中断递归。如果没有挂起的连接，该标志可能设置为 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T11:12:12.887

很难从上下文中确定，但看起来第一个只在

```
Boolean willRaiseEvent = this.listenSocket.AcceptAsync(acceptEventArg);    
if (!willRaiseEvent)    
{ 
```

因此我猜大部分时间它会在完成时引发一个事件（来自不同的回调线程）？

（另见“堆栈潜水”部分

[http://blogs.msdn.com/mjm/archive/2005/05/04/414793.aspx](http://blogs.msdn.com/mjm/archive/2005/05/04/414793.aspx)

这似乎是一种类似的事情。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T11:13:14.150

`ProcessAccept()` **总是**打电话`StartAccept()`，但反之则不然。

In `StartAccept()`,`ProcessAccept()`仅在`willRaiseEvent`设置为 true 时调用。那就是你从那里的无限递归中退出。

如果您怀疑无限递归（在单个递归函数或您的乒乓函数之一中，正如您雄辩地指出的那样 :-)，您总是寻找可能的退出点。

# python - Python：如何忽略异常并继续？

> ID：574730
> 
> 赞同：502
> 
> 时间：2009-02-22T11:02:22.227
> 
> 标签：python, exception

我在我的代码中有一个 try...except 块，当抛出异常时。我真的只想继续编写代码，因为在这种情况下，一切仍然可以正常运行。问题是，如果您将 except: 块留空或使用 #do nothing，则会出现语法错误。我不能使用 continue 因为它不在循环中。我可以使用一个关键字来告诉代码继续运行吗？

* * *

## 回答 #1

> 赞同：742
> 
> 时间：2009-02-22T11:03:55.700

```
except Exception:
    pass 
```

[pass 语句的 Python 文档](https://docs.python.org/3.7/tutorial/controlflow.html#pass-statements)

* * *

## 回答 #2

> 赞同：314
> 
> 时间：2009-02-22T20:23:15.030

### 通用答案

Python 中的标准“nop”是以下`pass`语句：

```
try:
    do_something()
except Exception:
    pass 
```

使用`except Exception`而不是裸避免捕获诸如等之类的`except`异常。`SystemExit``KeyboardInterrupt`

### 蟒蛇2

由于在 Python 2 中会记住最后一次抛出的异常，因此异常抛出语句中涉及的一些对象将无限期地保持活动状态（实际上，直到下一个异常）。如果这对您很重要并且（通常）您不需要记住最后抛出的异常，您可能希望执行以下操作而不是`pass`：

```
try:
    do_something()
except Exception:
    sys.exc_clear() 
```

这将清除最后抛出的异常。

### 蟒蛇 3

在 Python 3 中，保存异常实例的变量在退出块时被*删除。*`except`即使变量之前保存了一个值，在进入和退出`except`块之后它再次变为**未定义**。

* * *

## 回答 #3

> 赞同：254
> 
> 时间：2013-03-22T08:41:56.060

Python 3.4 中有一种新方法可以做到这一点：

```
from contextlib import suppress

with suppress(Exception):
  # your code 
```

这是添加它的提交：http: [//hg.python.org/cpython/rev/406b47c64480](http://hg.python.org/cpython/rev/406b47c64480)

这里是作者 Raymond Hettinger，谈论这个和其他各种 Python 热点（相关位在 43:30）：[http ://www.youtube.com/watch?v=OSGv2VnC0go](http://www.youtube.com/watch?v=OSGv2VnC0go)

如果您想模拟 bare`except`关键字并且还忽略诸如`KeyboardInterrupt`（尽管您通常不这样做）之类的内容，则可以使用`with suppress(BaseException)`.

编辑：看起来像在 3.4 版本之前`ignored`被重命名。`suppress`

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-02-22T11:04:33.140

试试这个：

```
try:
    blah()
except:
    pass 
```

# graphics - 计算曲面的地平线？- 不是极值

> ID：574732
> 
> 赞同：5
> 
> 时间：2009-02-22T11:03:20.570
> 
> 标签：graphics, 3d, points, bezier, geometry-surface

我需要找到一个曲面的*视觉地平线的 2 个点。*

我有：

*   4 个角点的 XYZ
*   2 个弯曲边缘贝塞尔点的 XYZ

我需要计算：

*   2 个水平点的 XY
*   2 个水平点的 XYZ

* * *

**注意：**我[上次](https://stackoverflow.com/questions/573416/calculate-the-horizon-of-a-curved-face)问这个问题时得到了一个解决方案，但它只找到曲线的*极值*，而不是*水平点*，它会根据两条曲线相对于彼此的位置和旋转而变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T11:27:59.480

首先旋转曲线使角点之间的连接是水平的然后计算极值是否有效？

为了直观地测试它，您可以将示例图像旋转大约 150 度：

[旋转图片 http://www.freeimagehosting.net/uploads/ad502509e9.png](http://www.freeimagehosting.net/uploads/ad502509e9.png)

请注意，这条曲线的极值并不完全在您想要的位置，但这可能是由几个因素造成的，例如您标记水平点的方式似乎并不那么精确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T12:39:41.523

你没有说你的表面是如何定义的，只是说它由两条二次贝塞尔曲线界定。有很多方法可以构建这样的表面，每种构建方法都会有不同的视野。所以这个答案将是猜测。

地平线由表面上的那些点组成，其中从相机到该点的矢量与表面相切，如下所示：

![与贝塞尔曲线相切](https://i.stack.imgur.com/3aq2i.png)

二次贝塞尔曲线具有参数方程

> B( *t* ) = (1 - <em>t) ² P [0] + 2(1 - <em>t) *t* P [1] + *t* ²  P [2]

对 t 进行微分可以得到曲线的切线：

> B′( *t* ) = 2( *t*  - 1) P [0] + 2(1 - 2 *t* ) P [1] + 2 *t*  P [2]

这与从相机（在原点）到曲线的向量平行，如果

> B( *t* ) × B′( *t* ) = 0

*为t*解决这个问题，您将在曲线上找到地平线上的点。如何将其扩展到整个表面的地平线取决于表面的构造方式。（也许你可以在曲面的每一端找到曲线的地平线点并用直线连接它们？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T11:29:01.397

您要寻找的实际上是**轮廓**，而不是地平线。
最简单的方法是找到法线指向相机的表面部分（点积为负）与法线远离相机的表面部分（点积为正）之间的边界.

使用三角形网格，您可以使用法线直接执行此操作。使用 NURBS，您可能会找到一个封闭的公式来执行此操作。

# ide - 为什么 Visual Studio 中的 Consolas 看起来很粗？

> ID：574738
> 
> 赞同：5
> 
> 时间：2009-02-22T11:04:48.960
> 
> 标签：ide, visual-studio-2005, fonts

我已经尝试安装 Consolas 字体包，以便可以在 VS 2005 中使用它。出于某种原因，它看起来比[Wikipedia](http://en.wikipedia.org/wiki/Consolas)和[Jeff Atwood 的](http://www.codinghorror.com/blog/archives/000356.html)示例要大胆得多。我读了一些关于抗锯齿的东西，我现在正在尝试。关于如何让它看起来又薄又滑的任何想法？

编辑：抱歉发现了。它与 ClearType 字体有关。打开它解决了我所有的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T11:12:16.507

您可以通过下面的 MS 网站上的向导运行 clearType，

[http://www.microsoft.com/typography/cleartype/tuner/step1.aspx](http://www.microsoft.com/typography/cleartype/tuner/step1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T11:10:04.547

当您的 Windows 操作系统（XP？）打开[字体平滑](http://support.microsoft.com/kb/306527)时，它看起来更大胆。

右键单击桌面>属性>外观选项卡>效果>“使用以下方法平滑屏幕字体”。

尝试将其更改为 ClearType / Standard / 将其关闭。继续切换回 VS 并向上/向下滚动一下以查看效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T11:09:33.753

你确定你激活了 ClearType 吗？

# clearcase - 如何使用 ClearCase 列出我的所有签到？

> ID：574742
> 
> 赞同：18
> 
> 时间：2009-02-22T11:08:09.887
> 
> 标签：clearcase, cleartool

是否可以使用 cleartool 获取我在给定源代码目录树中所做的所有签入的列表？如果可能的话，我想看看签到的时间和文件版本。我正在使用 Windows。

提前致谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-22T13:10:56.987

这将涉及一个[`cleartool find`](http://www.samecs.com/commands/cleartool%20commands/find/find.htm)命令：

*   描述找到的版本的`-exec`指令
*   a`-fmt`更好地[格式化](http://techpubs.sgi.com/library/tpl/cgi-bin/getdoc.cgi?coll=0530&db=man&fname=/usr/share/catman/u_man/cat5/fmt_ccase.z)结果
*   查询语言运算符，将结果限制为`-created_by`仅您的签入版本。

您可以显示所有版本的签入文件，或者每个签入的所有版本仅显示一个文件，即“元素”。在您的情况下，要查看签入的时间，您需要列出版本。

就像是：

```
REM Windows syntax
cleartool find . -ver "created_by(myLogin)" -exec "cleartool descr -fmt \"%En : %Sn made %Vd\n\" \"%CLEARCASE_XPN%\""

# Linux syntax
cleartool find . -ver 'created_by(myLogin)' -exec 'cleartool descr -fmt "%En : %Sn made %Vd\n" "$CLEARCASE_XPN"' 
```

'。' 将指定您从中查找版本的当前目录。

`%Sn`会给你分支/版本号，`%Ln`只会给你版本号。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-15T10:31:37.227

我知道最初的问题是关于 cleartool，但是很多人没有意识到您也可以使用 ClearCase ReportBuilder GUI 来做到这一点。使用 GUI 的优点（除了不必学习 cleartool find 的语法），结果是您可以右键单击选定的元素并立即弹出“与以前的版本比较”或版本树。这取决于你想对输出做什么。

ReportBuilder 位于“Administration”文件夹下（所有程序 > IBM Rational ClearCase XXX > Administration > ReportBuilder）。您可能没有注意到它，因为它隐藏在“管理”下，但它不仅适用于管理员 - 对于任何使用 ClearCase 的人来说，都有许多有用的查询。

在 Report Builder 下，转到 Elements > Checkins since Date by User 并选择要报告的目录、自日期和您的用户 ID，然后单击“Run Report”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-21T22:22:14.177

我使用此命令（在 DOS shell 中，而不是 Cygwin 中）来（1）忽略目录，以及（2）另外获取签入注释：

```
cleartool find . -ver "eltype(text_file) && created_by(your_login)" -exec "cleartool descr -fmt \"%n: %c\n\n--\n\n\" \"%CLEARCASE_XPN%\"" >> checkins.txt 
```

# java - 为什么 JDialog 在 setLocationRelativeTo() 上“跳跃”？

> ID：574746
> 
> 赞同：1
> 
> 时间：2009-02-22T11:10:13.627
> 
> 标签：java, swing, jdialog

有一个扩展 JDialog 的类。它完全在 EDT 上初始化（以防万一）。现在，

```
public PropsDialog (JFrame parentFrame)
{
    super(parentFrame);
    // boring
    pack();
    setLocationRelativeTo(getParent());
    setVisible(true);
} 
```

导致对话框出现在最左角，然后跳转到它的预期位置。我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T09:23:40.607

您能否提供一个工作示例和更多信息？例如，您在什么操作系统上进行测试？Swing 之间有一些差异，例如没有父级的 JDialogs 在 gnome 面板中获得条目，但在 Windows 任务栏中没有条目等。

其次，我猜想，在您调用 setLocationRelativeTo 之前，您的 JDialog 是可见的，可能在您评论为“无聊”的部分中有所体现。建议你快点打

```
System.out.println(isVisible()); 
```

进入你的代码，就在setLocationRelativeTo之前，以防万一......

# java - 用于开发 Java 桌面应用程序的最佳 IDE

> ID：574756
> 
> 赞同：15
> 
> 时间：2009-02-22T11:13:21.090
> 
> 标签：java, ide, desktop

我一直在使用 Eclipse 作为 IDE 开发 Java Web 应用程序。计划开始开发基于 Java 的桌面应用程序。

有人可以推荐用于开发基于 Java 的桌面应用程序的最佳 IDE 吗？（一个可以拖放来构建像 Visual Studio 这样的界面）

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-22T11:16:24.063

我推荐[NetBeans IDE](http://www.netbeans.org)，当然它是免费的。

查看[Swing GUI 生成器功能](http://www.netbeans.org/features/java/swing.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-22T17:31:22.570

我想说这取决于您要使用的 GUI 框架：

*   对于 Swing，[NetBeans Swing GUI 构建器](http://www.netbeans.org/features/java/swing.html)似乎是最佳选择（尽管[Eclipse 中](https://stackoverflow.com/questions/29426)也有用于 Swing 的可视化编辑器）
*   对于 JavaFX，[选择非常明确](http://www.netbeans.org/kb/trails/matisse.html)
*   对于 Eclipse（即[SWT](http://www.eclipse.org/swt/)、[JFace](http://wiki.eclipse.org/index.php/JFace)、[RCP](http://wiki.eclipse.org/index.php/Rich_Client_Platform)）[，Java 的 Eclipse IDE](http://www.eclipse.org/downloads/)加上[可视化编辑器](http://www.eclipse.org/vep/WebContent/main.php)可能是最好的选择

当然，现在选择哪个是一个[不同的](https://stackoverflow.com/questions/281342) [问题](https://stackoverflow.com/questions/286251/alternate-java-gui-frameworks)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-22T11:23:33.173

[Netbeans](http://www.netbeans.org)对创建 GUI 有最好的支持

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-22T11:42:10.477

对于用于 GUI 的 Netbeans +1，但[IntelliJ](http://www.jetbrains.com/idea/)仍然是我最喜欢的通用 IDE 工作。不幸的是，它不是免费的。

更新：有一个适用于 Java 桌面开发的 IntelliJ Idea 的开源版本

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-22T20:55:34.733

我一直很喜欢 Eclipse ( [http://www.eclipse.org/downloads/](http://www.eclipse.org/downloads/) ) + 实例化的 Window Builder ( [http://www.instantiations.com/windowbuilder/](http://www.instantiations.com/windowbuilder/) )

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-22T11:18:50.533

这个[http://www.eclipse.org/](http://www.eclipse.org/)或者这个[http://www.netbeans.org/](http://www.netbeans.org/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-12-01T05:57:05.073

对 RTFM 消息的回复：我同意阅读手册是了解该工具更多信息的好方法。OP 正试图找出一些工具来深入了解并最终归零（或满足不同要求的子集）。要在阅读随附手册之前到达第一个列表，需要一些指导和基于经验的帮助。如果您在确定满足您要求的工具之前必须阅读所有相关工具的手册，那么就会有新工具出现，或者您的项目会超越您！

对基于最佳 IDE 的编辑器的原始问题的回复：

1.  Eclipse（强大的社区 + 精心设计和记录的插件架构）
2.  GNU Emacs（具有无限扩展能力的文本编辑器引擎......你的想象力是极限）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T23:14:36.177

在某些方面，只要你努力深入学习它，你使用哪种工具并不重要。了解你的工具！阅读免费手册！

在实践中：您可能希望为 SWT 选择 Eclipse，为 Swing 选择 Netbeans（当您开始时，Matisse 非常棒）。我没有使用过 IntelliJ，但我相信它非常棒。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-22T23:55:07.407

几年前，我将 Eclipse 与[Visual Editor](http://www.eclipse.org/projects/project_summary.php?projectid=tools.ve)一起使用，我发现它非常有用。我喜欢它生成的代码——很容易接受它并添加我需要的额外功能。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2010-09-03T19:17:01.880

如果您只针对 Windows，那么 Visual Studio 是最佳选择。对于多个平台，Mono 非常好，它没有 java 的[性能问题](http://www.codeproject.com/KB/dotnet/RuntimePerformance.aspx)。当然，如果使用 Mono 或 VS，你会使用 C# 而不是 Java。

# data-binding - 浏览器关闭时，Silverlight 绑定的 TextBox 会丢失数据

> ID：574767
> 
> 赞同：3
> 
> 时间：2009-02-22T11:21:32.257
> 
> 标签：data-binding, silverlight-2.0

当我使用两种方式绑定将 TextBox 控件绑定到对象的字符串属性时，它可以正常工作 - 只要用户在关闭浏览器窗口/选项卡之前离开控件。

但是，如果用户更改了文本框的内容，然后关闭了期望数据已保存的窗口，该怎么办？

虽然可以挂接到 TextChanged 事件或 Application_Exit() 处理程序并手动更新属性，但您实际上是在重新执行活页夹的工作。尽管如此，这些似乎是迄今为止唯一的解决方案。

注意。WPF 应用程序中的相同 xaml/代码工作正常（App.OnExit 显示对象中的更新数据）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T15:26:42.357

我在这里根据重要的 Web 开发经验做出有根据的猜测，但 Silverlight 经验非常有限。

您可以使用一些 Javascript 来挂钩 HTML 中的 onunload，然后在 Silverlight 代码中调用一个函数来处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T15:30:46.450

这似乎是 Silverlight 的问题。在失去焦点之前，它不会更新文本框上的绑定属性。

我必须使用的一种解决方法（我正在实现动态过滤器）是实现 TextChanged 事件处理程序并手动更新支持属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T11:26:58.157

Silverlight 的 Binding 类是否具有 UpdateSourceTrigger 属性？在 WPF 中，您可以告诉控件在属性更改时（而不是在控件失去焦点时）更新其绑定源，如下所示：

```
<TextBox Text="{Binding Path=Foo,UpdateSourceTrigger=PropertyChanged}" /> 
```

# c# - 防火墙后面的 WCF 服务生成错误的 wsdl URI

> ID：574768
> 
> 赞同：2
> 
> 时间：2009-02-22T11:22:24.580
> 
> 标签：c#, wcf, firewall

我开发了一个 WCF 服务，并使用 IIS 发布了它。在本地网络内一切正常，但是当外部客户端从 Internet 访问服务时，由防火墙重定向，服务会生成客户端无法解决的本地 wsdl uri。

像这样的东西：

*   *需要 URI*：http:// **external_url** /service.svc?wsdl
*   *创建的 URI*：http:// **internal_url** /service.svc?wsdl

我想继续使用自动生成 wsdl 文件而不指示外部路径。我还证明了将*ServiceBehavior*属性操作到服务类中，但问题仍然存在。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T11:27:17.360

您需要在 IIS 中为您的网站配置 serverBinding 标头。[这是配置 WCF WSDL 以使用外部域名](http://www.codemeit.com/wcf/wcf-wsdl-xsdimport-schemalocations-link-to-local-machine-name-not-domain-name-while-hosted-in-iis.html)的分步操作

# batch-file - 使用bat文件创建文件夹

> ID：574777
> 
> 赞同：16
> 
> 时间：2009-02-22T11:30:04.920
> 
> 标签：batch-file

我需要编写一个 bat 文件，该文件使用当前日期和时间作为文件夹名称创建一个新文件夹。我想出了以下内容：

```
for /f "tokens=1-3 delims=:," %%i in ("%TIME%") do md %DATE%-%%i.%%j.%%k 
```

这段代码有任何缺陷吗？有没有更简单/更自然的方法来做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-22T18:18:26.937

您可以使用子字符串和内置的 %DATE% 和 %TIME% 变量来执行此操作：

```
@echo OFF

:: Use date /t and time /t from the command line to get the format of your date and
:: time; change the substring below as needed.

:: This will create a timestamp like yyyy-mm-dd-hh-mm-ss.
set TIMESTAMP=%DATE:~10,4%-%DATE:~4,2%-%DATE:~7,2%-%TIME:~0,2%-%TIME:~3,2%-%TIME:~6,2%

@echo TIMESTAMP=%TIMESTAMP%

:: Create a new directory
md "%1\%TIMESTAMP%" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T11:34:16.207

我用这个球棒

```
for /F "tokens=1-4 delims=. " %%i in ('date /t') do (
set Day=%%i
set Month=%%j
set Year=%%k
)

for /F "tokens=1-4 delims=: " %%i in ('time /t') do (
set Hour=%%i
set Minute=%%j
set Second=%%k
)

md %1\%Year%-%Month%-%Day% 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-04T14:23:33.180

我无法使上述许多工作正常工作，但成功使用了原始海报命令。

这是我的版本：

> for /f "tokens=1-3 delims=:/" %%i in ("%DATE%") do set DATESTAMP=%%i.%%j.%%k
> @echo 目录将使用这个名称：
> @echo 备份。%DATESTAMP%
> md 备份。%DATESTAMP%
> @echo 目录已创建，现在继续进行文件复制...
> @echo 请确保 PC 没有打开电子邮件或任何文件。
> pause
> cd backup.%DATESTAMP%
> md "Shared Documents"
> xcopy "c:\documents and settings\all users\documents\documents" "Shared Documents" /E /C /I /H /Q
> @echo in Documents Complete。

ETC ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-26T14:40:00.180

简单的 %time% 不起作用的原因是它用 : 分隔，这在批处理脚本中是不允许的。但是这个应该可以正常工作：

它对我来说效果很好。

```
Rem Get Day,Mth & Year from %Date%
set Day=%Date:~0,2%
set Mth=%Date:~3,2%
set Yr=%Date:~6,4%
REM Get Hour and Min from %Time%
set Hour=%Time:~0,2%
if "%hour:~0,1%" == " " set hour=0%hour:~1,1%
set Min=%Time:~3,2%

mkdir %date%-%hour%.%min% 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-20T16:45:34.000

您是否不只是尝试使用保存为 new_folder_maker.bat 的日期和时间以及此代码创建一个新的新文件夹制造商

```
:start
@echo off
md new_folder_%date%_%time%
exit 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-30T17:56:57.450

这是我的解决方案（修改了 lopkiju 的）。它使用日期戳创建一个文件夹。如果该名称的文件夹已存在，则向其附加一个整数以使其唯一。将其放入 .bat 文件中并传入父文件夹的路径。
在 Windows 7 家庭高级版 x64 中测试。

```
REM Create a folder using the current date.  If such a folder already exists, append a number to make it unique.
@ECHO OFF
for /F "tokens=2-5 delims=/ " %%i in ('date /t') do (
set Day=%%j
set Month=%%i
set Year=%%k
)

set Path=%~1\%Year%-%Month%-%Day%
set /a inx=2

:LOOP
IF NOT EXIST "%Path%" GOTO CREATE
set Path=%~1\%Year%-%Month%-%Day% (%inx%)
set /a inx+=1
if %inx% gtr 9 goto :END REM Eh, giving up.
goto LOOP
:END

:CREATE
md "%Path%"
:END 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-21T19:17:01.843

您可以使用的格式说明符来利用[GNU sh-utils ：](http://gnuwin32.sourceforge.net/)`date.exe`

```
for /f "delims=" %%a in ('date.exe +%%Y-%%m-%%d.%%H-%%M') do @set dd=%%a
md %dd% 
```

此解决方案对于具有**本地化版本**Windows 的用户尤其重要。

`for`循环运行一次，但它是必需的，因为没有更简单的方法可以使用从命令输出中获取的值来分配变量。

用于`date --help`格式说明符的完整列表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-05T09:21:33.310

这对我来说效果很好

```
dkdir foldername

cd foldername

dkdir %date% %time% 

cls 
```

# java - 继承和在哪里声明一个预期的通用对象

> ID：574778
> 
> 赞同：0
> 
> 时间：2009-02-22T11:30:07.743
> 
> 标签：java, inheritance, object

我有一个`Player`类，它继承自一个`ArmedHumanoids`类，而该类又继承自一个`Humanoids`类。

我应该在何时何地创建`Player`对象，以便在我的所有其他类（例如，一个`selectPlayerRace`类）中都可以访问它？

我知道通过扩展`Player`类它变得可访问，但我被挫败了，因为我所有其他类都扩展了`JFrame`. 只能有一个扩展名，不能有两个。

目前，在我的类中创建对象后，NetBeansIDE 抱怨`Player`当我为它编写代码时它无法找到该对象。`selectPlayerRace``Player``Main`

显然，当我`Player`在类中创建对象时会更快乐`selectPlayerRace`，但是我无法`Player`在所有其他类中访问该对象，因为它是`selectPlayerRace`.

该`Player`对象旨在成为可在我的所有其他类中访问的通用对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T11:41:58.557

> 该`Player`对象旨在成为可在我的所有其他类中访问的通用对象。

`Player`为什么不直接在其他类的构造函数或您调用的方法中传递这个对象呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T11:40:07.597

您可以创建您的 Player 类的对象，并通过例如接受 Player 类型的构造函数或方法将其传递给其他对象。

```
public class Entry
{
   public static void main(string[] args)
   {
      // initialize a player object
      Player player=new Player("elwynn");
      // initialize some other object which requires player object.
      // since player object needs to be accessed within foo.
      Foo foo = new Foo(player);
      // you are about to use player object within foo.
      foo.MakePlayerPlay(); 
   } 
} 

public class Foo
{

  Player player;
  public Foo(Player p)
  {
   this.player = p;
  }

  public void MakePlayerPlay()
  {
    // you are using player object here
    // which is the same instance you created 
    // within main() in Entry class.
    if(this.player!=null) this.player.play();
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T11:38:31.593

听起来您正在在`static`这里寻找声明。据我了解，您希望获得对某些 Player 实例的全局访问权限，但不需要`extend`其他类或`implement`某些接口来执行此操作（这意味着您不必继承任何行为，您只需要访问一个对象）。您可以将要访问的 Player 实例存储`static`在一个`PlayerManagement`类中。然后，您在其中放置一个静态方法，就像`getPlayer(String playerName)`同步对其数组/向量/包含所有 Player 对象的任何内容的访问，然后返回有问题的对象（或者`null`如果未找到）。您可以将您的类人机器人类链接到 PlayerManagement，反之亦然。

也许你还想要一个 Player `interface`。您可以实现任意数量的接口，但只能扩展一个其他类，但您必须重新实现所有功能，因为您无法将任何代码写入接口，只需定义实现该接口的类必须提供的属性/方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T11:41:01.120

拥有全局对象是不好的风格，因为这

*   将使测试更加困难，并且

*   当需要有多个实例时会导致问题。

最好在需要知道的基础上在构造时提供对其他对象的引用（这称为依赖注入），或者在适当的情况下通过参数传递引用。

也就是说，查看 Singleton 设计模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T04:37:10.800

这听起来像一个单例模式。

```
public class Player extends ArmedHumanoid {

  private static Player instance = new Player();

  private Player() {}

  public static Player getIntstance() {
    return instance
  }

} 
```

然后任何类都可以调用`Player.getInstance()`来访问 Player 对象。

# javascript - Javascript 语法 VS <script>- 最奇怪的事情

> ID：574787
> 
> 赞同：1
> 
> 时间：2009-02-22T11:41:39.947
> 
> 标签：javascript, html, xhtml

> ### 复制
> 
> [为什么自闭合脚本标签不起作用？](https://stackoverflow.com/questions/69913/why-dont-self-closing-script-tags-work)

我正在编写一个 ASP.net 页面，该页面在 JS 文件中有一些用于客户端身份验证的 Javascript 代码。

在使用此代码时，我的服务器端代码无法正常工作**：**

```
<script src="../../JavaScript/BaseJS.js" type="text/javascript" defer="defer" /> 
```

**这段代码**以某种方式起作用：

```
<script src="../../JavaScript/BaseJS.js" type="text/javascript" defer="defer"></script> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-22T11:59:35.660

定义元素的[HTML4.01 手册部分](http://www.w3.org/TR/html401/interact/scripts.html#edef-SCRIPT)`SCRIPT`指出：

> 18.2.1 脚本元素
> 
> ...
> 
> 开始标签：**必填**，结束标签：**必填**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T11:48:25.017

我说你在用 IE 测试是对的吗？这是一个[已知的](http://www.phpied.com/ie-script-tag-problem/) [错误](http://webbugtrack.blogspot.com/2007/08/bug-153-self-closing-script-tag-issues.html)。（我敢肯定还有很多其他页面也提到了它。）

编辑：事实上，关于这个还有[另一个 Stack Overflow 问题](https://stackoverflow.com/questions/69913/why-dont-self-closing-script-tags-work)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T11:47:28.233

`<script>`只能在 XHTML 中自我关闭，而不是 HTML。

# javascript - scripty (scriptaculous) 可拖动 onEnd 未在 Safari 中执行

> ID：574796
> 
> 赞同：0
> 
> 时间：2009-02-22T11:49:41.083
> 
> 标签：javascript, safari, scriptaculous, draggable

我创建了一个非常 iphone-y 滑块元素，它既限制了整体水平移动（0-400 像素并且它不垂直移动），又在 400 像素“容器”通过 200 像素标记时“捕捉”到任一侧并且拖动已经结束。它在Firefox中完美运行。在 Safari 中，将元素定位到这个 400px 容器的任一端的 onEnd 函数永远不会被调用。更重要的是，可拖动元素“粘”在鼠标光标上，我必须重新加载页面才能结束动画。

这是我的代码

```
<div style="width:100px;height: 60px;background-color:#000;z-index:999" id="dragtest" />
<script language="JavaScript" type="text/javascript">
new Draggable('dragtest', { constraint: 'horizontal',
    onEnd: function(e, me) {
        console.debug("!!!")
        element = e.element
        x = element.style.left
        x = x.gsub('px','')

        if (x >= 200) {
            $('dragtest').style.left = 400+'px';

        }

        if (x < 200) {
            $('dragtest').style.left = 0+'px';
        }

        console.debug("Snapping to ", element.style.left, " (x was ", x, ")")
        return true;

    },
    snap: function(x, y) {
        ret_x = x
        ret_y = y

        if (x >= 400) {
            ret_x = 400
        }

        if (x <= 0) {
            ret_x = 0
        }

        return [ret_x,ret_y]

    }
});
</script> 
```

谢谢！安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T17:05:29.207

为了您将来的参考（无法通过谷歌搜索任何内容），从 onEnd 处理程序中取消注释 console.debug() 调用解决了这个问题。奇怪的。

# java - 单例 servlet？

> ID：574798
> 
> 赞同：1
> 
> 时间：2009-02-22T11:51:30.173
> 
> 标签：java, servlets, singleton

如果我声明一个像这样的单例 servlet

公共静态类 SomeServlet 扩展 HttpServlet {.....

它给出的错误指示在 NetBeans 中不允许使用修饰符 static。

请让我知道如何创建一个单例 servlet，它一次只允许一个客户端执行。

提前致谢， 马赫斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T11:58:59.280

*   *static*与在任何时间点仅由一个线程执行无关。
*   您可以将静态类作为内部类，但这对您的问题没有帮助，因为第一点
*   如果我没记错的话，只有一个 servlet 实例化过，所以没有必要创建单例。**更新：我没记错，**正如 DefLog 指出的那样
*   因此在方法（doGet、doPost、服务或您的实现方法）上*同步***更新：不会**成功。

根据您对问题的理解（没有双关语），我怀疑这是您应该选择的解决方案。而是改写您的问题，以便用您在问题的第一次修订中陈述的解决方案陈述您要解决的问题。

更新：请参阅此答案的评论，了解为什么您真的不想爱上*synchronized*。您可能（例如）希望多个 servlet*一次*访问一个相同的功能。另外，如果您在 servlet 级别上进行同步，您会引入严重的扩展问题。这绝对是解决并发问题的错误地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T12:11:27.490

我真的强烈反对制作一个一次只能处理一个请求的 Servlet。您可能应该创建另一个（正确同步的类）并让您的 servlet 将请求放入某种执行队列中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T12:11:17.987

实施`SingleThreadModel`。但请注意：它已被弃用，它可能没有任何作用/没有意义，这是一件愚蠢的事情（很像单身人士）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T12:37:11.453

顶级声明永远不可能是`static`. `static`意味着一个元素是在类级别声明的，所以它需要一个封闭的类声明。

对于 servlet，通常会有一个但*可能有*多个同时处理请求的 servlet 实例。所以，也许你真的不想在这个级别减少并发，或者你会使用 servlet 过滤器或像 Spring Security 这样可以限制并发会话数量的框架。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-22T12:38:19.810

我倾向于认为 Singleton 被过度使用，并且通常表明解决方案的基本架构存在缺陷。假设您已经完成了足够的分析以证明您需要一个单例，您可以使用不依赖静态初始化的旧单例模式。这是一个例子：

```
public SomeServlet extends HttpServlet {

    private instance = null;

    private SomeServlet() {
        // Construction code here
    }

    public synchronized SomeServlet getInstance() {
        if(instance == null) {
            instance = SomeServlet();
        }
        return instance;
    }

    // Servlet methods here

} 
```

我看到两个潜在的问题：

首先，您需要一个包装器 Servlet（或者可能只是从另一个 servlet 链接，因为 Servlet 容器不知道如何处理没有私有构造函数的情况。

其次，您仍然需要同步 servlet 方法，因为您仍然不能保证一次只有一个执行程序线程“在”servlet 中。

# c# - 如何在不访问控件表单的情况下检测每个应用程序的控件进入/离开？

> ID：574799
> 
> 赞同：1
> 
> 时间：2009-02-22T11:51:50.000
> 
> 标签：c#, .net, winforms, focus

我可以使用 Control.Enter 和 Control.Leave 事件来检测用户焦点何时进入或离开控件，但这仅适用于每个表单。我在我的应用程序中使用了多个表单，并且想要跟踪哪个控件具有用户焦点，我必须使用表单的 Activated 和 Deactivated 事件来跟踪哪个表单处于活动状态，然后跟踪哪个控件聚焦在每个表单中。

我们正在使用 DockPanel 套件构建客户端，因此我们无法直接访问控件的表单。我们不能只将侦听器添加到控件的顶级表单，因为当用户停靠或取消停靠面板时，它会发生变化。但是我们仍然需要在每个应用程序的基础上跟踪焦点。如何在不访问控件表单的情况下检测每个应用程序的控件进入/离开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T13:21:16.120

您能否改为挂钩到 Control.GotFocus/Control.LostFocus，然后全局跟踪当前具有焦点的控件？

将这些事件挂钩添加到每个控件将非常乏味且容易出错，因为您可能会错过感兴趣的控件。因此，如何使用[Application.AddMessageFilter](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.addmessagefilter.aspx)调用来获取应用程序中出现的每个 Windows 消息的回调。

然后您可以观看所有[WM___SETFOCUS](http://social.msdn.microsoft.com/Search/en-US/?query=WM_SETFOCUS&ac=8)和[WM_KILLFOCUS](http://msdn.microsoft.com/en-us/library/ms646282.aspx)调用，并记录当前控件的焦点。请记住使用方便的[Control.FromHandle](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.fromhandle(VS.80).aspx)静态方法从您在跟踪两个窗口消息时缓存的窗口句柄中获取一个不错的 .NET 控件引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T13:16:52.777

也许看看 Unity 应用程序块和控制反转 (IOC) 容器依赖注入？

[http://codebetter.com/blogs/david.hayden/archive/2008/02/22/unity-ioc-screencast.aspx](http://codebetter.com/blogs/david.hayden/archive/2008/02/22/unity-ioc-screencast.aspx)

# c# - 在 C# 中调用 C++ 库

> ID：574801
> 
> 赞同：25
> 
> 时间：2009-02-22T11:53:22.617
> 
> 标签：c#, c++, function

我有很多用 C++ 编写的库。我想从 C# 调用这些库，但是我遇到了很多问题。我想知道是否有书或指南告诉我如何做到这一点。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-22T12:02:11.270

1.  DllImport - [http://msdn.microsoft.com/en-us/library/aa984739(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa984739%28VS.71%29.aspx)
2.  包装类 - [http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/67cc9eea-a4fe-48bd-b8d5-f3c8051ba896](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/67cc9eea-a4fe-48bd-b8d5-f3c8051ba896)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-22T15:09:33.550

如果你在谷歌上搜索“c++ c# interop”，你会发现关于这个主题的大量信息。

几个链接：

[http://msdn.microsoft.com/en-us/magazine/cc301501.aspx](http://msdn.microsoft.com/en-us/magazine/cc301501.aspx)
[http://msdn.microsoft.com/en-us/library/ms235281(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms235281%28VS.80%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T12:03:14.420

我最近不得不在 .NET 中包装一些 c++ 代码。虽然 c++ 代码被打包为 dll，但接口对 P/Invoke 来说太不友好了，所以我决定用托管 c++ 或 C++/CLI 来编写它，因为它现在显然是众所周知的。

我发现[本教程](http://www.functionx.com/cppcli/index.htm)在语法上非常有用。看起来不是那么容易，但内容似乎还不错。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-22T15:21:57.467

[我是C++/CLI in Action](http://www.manning.com/sivakumar/)这本书的忠实粉丝，该书在该地址有几个有用的在线示例章节。

CodeProject 的这个[介绍](http://www.codeproject.com/KB/mcpp/quickcppcli.aspx)是一个很好的起点。

C++/CLI in Action 的作者在 CodeProject 上有许多文章，向下滚动到[他索引](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=20248)中的 C++/CLI 部分。

关于 P/Invoke的[Wikipedia 文章](http://en.wikipedia.org/wiki/Platform_Invocation_Services)有很多您可能不想使用这种方法的原因，我同意：

*   编译器失去类型支持
*   possible data type or alignment issues as you have to map types by hand
*   need to pin garbage-collected objects

The best starting point on MSDN is the [summary article](http://msdn.microsoft.com/en-us/library/ms235282.aspx).

# php - 如何使用 PHP 在 SQL Server 中转义字符串？

> ID：574805
> 
> 赞同：94
> 
> 时间：2009-02-22T11:54:43.050
> 
> 标签：php, sql-server, escaping, input-sanitization

我正在寻找`mysql_real_escape_string()`SQL Server 的替代方案。是`addslashes()`我最好的选择还是可以使用其他替代功能？

的替代方案`mysql_error()`也很有用。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-02-22T12:10:12.640

`addslashes()`还不够充分，但 PHP 的 mssql 包没有提供任何不错的替代方案。丑陋但完全通用的解决方案是将数据编码为十六进制字节串，即

```
$unpacked = unpack('H*hex', $data);
mssql_query('
    INSERT INTO sometable (somecolumn)
    VALUES (0x' . $unpacked['hex'] . ')
'); 
```

抽象，那将是：

```
function mssql_escape($data) {
    if(is_numeric($data))
        return $data;
    $unpacked = unpack('H*hex', $data);
    return '0x' . $unpacked['hex'];
}

mssql_query('
    INSERT INTO sometable (somecolumn)
    VALUES (' . mssql_escape($somevalue) . ')
'); 
```

`mysql_error()`等价于`mssql_get_last_message()`.

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-03-26T21:01:29.957

```
function ms_escape_string($data) {
        if ( !isset($data) or empty($data) ) return '';
        if ( is_numeric($data) ) return $data;

        $non_displayables = array(
            '/%0[0-8bcef]/',            // url encoded 00-08, 11, 12, 14, 15
            '/%1[0-9a-f]/',             // url encoded 16-31
            '/[\x00-\x08]/',            // 00-08
            '/\x0b/',                   // 11
            '/\x0c/',                   // 12
            '/[\x0e-\x1f]/'             // 14-31
        );
        foreach ( $non_displayables as $regex )
            $data = preg_replace( $regex, '', $data );
        $data = str_replace("'", "''", $data );
        return $data;
    } 
```

这里的一些代码是从 CodeIgniter 中窃取的。效果很好，是一个干净的解决方案。

编辑：上面的代码片段有很多问题。请不要在未阅读评论以了解这些评论的情况下使用它。更好的是，请不要使用它。参数化查询是你的朋友： http: [//php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-09-09T14:53:26.973

当您可以在查询中使用参数时，为什么还要费心转义任何东西？！

```
sqlsrv_query(
    $connection, 
    'UPDATE some_table SET some_field = ? WHERE other_field = ?', 
    array($_REQUEST['some_field'], $_REQUEST['id'])
) 
```

无论您的值参数是否存在，它都适用于选择、删除、更新`null`。做一个原则问题 - 不要连接 SQL，你总是安全的，你的查询读起来更好。

[http://php.net/manual/en/function.sqlsrv-query.php](http://php.net/manual/en/function.sqlsrv-query.php)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-22T12:06:21.247

您可以查看[PDO Library](http://au.php.net/pdo)。您可以将预准备语句与 PDO 一起使用，如果您正确执行预准备语句，它将自动转义字符串中的任何坏字符。我认为这仅适用于 PHP 5。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-02T14:04:49.927

另一种处理单引号和双引号的方法是：

```
function mssql_escape($str)
{
    if(get_magic_quotes_gpc())
    {
        $str = stripslashes($str);
    }
    return str_replace("'", "''", $str);
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-07T23:14:12.910

为了逃避单引号和双引号，您必须将它们加倍：

```
$value = 'This is a quote, "I said, 'Hi'"';

$value = str_replace( "'", "''", $value ); 
```

`$value = str_replace( '"', '""', $value );`

```
$query = "INSERT INTO TableName ( TextFieldName ) VALUES ( '$value' ) "; 
```

ETC...

和归属： [Microsoft SQL Server 2000 中的转义字符](http://tipsandtricks.nogoodatcoding.com/2007/07/escape-character-in-microsoft-sql.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-19T19:02:19.927

在为此苦苦挣扎了几个小时之后，我想出了一个感觉几乎是最好的解决方案。

Chaos 将值转换为十六进制字符串的答案不适用于每种数据类型，尤其是日期时间列。

我使用 PHP 的`PDO::quote()`，但由于它带有 PHP，`PDO::quote()`MS SQL Server 不支持它并返回`FALSE`。它的工作解决方案是下载一些 Microsoft 捆绑包：

*   [Microsoft Drivers 3.0 for PHP for SQL Server](http://www.microsoft.com/en-us/download/details.aspx?id=20098) (SQLSRV30.EXE)：下载并按照说明进行安装。
*   [Microsoft® SQL Server® 2012 Native Client](http://www.microsoft.com/en-us/download/details.aspx?id=29065)：在扩展页面中搜索 Native Client。*即使是 2012 年，我也使用它连接到 SQL Server 2008（安装 2008 Native Client 没有用）。*下载并安装。

之后，您可以使用 DSN 在 PHP 中使用 PDO 连接，如下例所示：

```
sqlsrv:Server=192.168.0.25; Database=My_Database; 
```

在 DSN 中使用`UID`and`PWD`参数不起作用，因此在创建连接时，用户名和密码作为 PDO 构造函数的第二个和第三个参数传递。现在您可以使用 PHP 的`PDO::quote()`. 享受。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-11T03:48:41.843

[*来自用户混乱*](https://stackoverflow.com/questions/574805/how-to-escape-strings-in-sql-server-using-php/574821#574821)[的 2009-02-22T121000 的答案](https://stackoverflow.com/questions/574805/how-to-escape-strings-in-sql-server-using-php/574821#574821)并不适合所有查询。

例如，“CREATE LOGIN [0x6f6c6f6c6f] FROM WINDOWS”会给你一个例外。

PS：看PHP的SQL Server驱动， http: [//msdn.microsoft.com/library/cc296181%28v=sql.90%29.aspx](http://msdn.microsoft.com/library/cc296181%28v=sql.90%29.aspx)和sqlsrv_prepare函数，可以绑定参数。

PSS：上面的查询也没有帮助您；）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-17T19:02:12.737

> 警告：这个函数在 PHP 7.0.0 中被移除。

[http://php.net/manual/en/function.mssql-query.php](http://php.net/manual/en/function.mssql-query.php)

对于仍在使用这些 mssql_* 函数的任何人，请记住，从 v7.0.0 开始，它们已从 PHP 中删除。因此，这意味着您最终必须重写模型代码以使用 PDO 库、sqlsrv_* 等。如果您正在寻找具有“引用/转义”方法的东西，我会推荐 PDO。

> 此函数的替代方法包括：PDO::query()、sqlsrv_query() 和 odbc_exec()

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-22T18:49:43.940

为了将 SQL 中的十六进制值转换回 ASCII，这是我得到的解决方案（使用[用户*混乱*](https://stackoverflow.com/questions/574805/how-to-escape-strings-in-sql-server-using-php/574821#574821)中的函数编码为十六进制）

```
function hexEncode($data) {
    if(is_numeric($data))
        return $data;
    $unpacked = unpack('H*hex', $data);
    return '0x' . $unpacked['hex'];
}

function hexDecode($hex) {
    $str = '';
    for ($i=0; $i<strlen($hex); $i += 2)
        $str .= chr(hexdec(substr($hex, $i, 2)));
    return $str;
}

$stringHex = hexEncode('Test String');
var_dump($stringHex);
$stringAscii = hexDecode($stringHex);
var_dump($stringAscii); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-11T10:11:01.683

如果您使用的是 PDO，则可以使用该[`PDO::quote`](http://php.net/manual/en/pdo.quote.php)方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-11-05T05:00:28.240

最好也转义 SQL 保留字。例如：

```
function ms_escape_string($data) {
    if (!isset($data) or empty($data))
        return '';

    if (is_numeric($data))
        return $data;

    $non_displayables = array(
        '/%0[0-8bcef]/',        // URL encoded 00-08, 11, 12, 14, 15
        '/%1[0-9a-f]/',         // url encoded 16-31
        '/[\x00-\x08]/',        // 00-08
        '/\x0b/',               // 11
        '/\x0c/',               // 12
        '/[\x0e-\x1f]/',        // 14-31
        '/\27/'
    );
    foreach ($non_displayables as $regex)
        $data = preg_replace( $regex, '', $data);
    $reemplazar = array('"', "'", '=');
    $data = str_replace($reemplazar, "*", $data);
    return $data;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-08-16T12:08:45.470

我一直在使用它作为替代`mysql_real_escape_string()`：

```
function htmlsan($htmlsanitize){
    return $htmlsanitize = htmlspecialchars($htmlsanitize, ENT_QUOTES, 'UTF-8');
}
$data = "Whatever the value's is";
$data = stripslashes(htmlsan($data)); 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-03-02T18:31:23.407

您可以使用以下正则表达式滚动您自己的`mysql_real_escape_string`, 版本（并对其进行改进）：`[\000\010\011\012\015\032\042\047\134\140]`. 这会处理以下字符：null、退格、水平制表符、换行符、回车、替换、双引号、单引号、反斜杠、重音符。不支持退格和水平制表符`mysql_real_escape_string`。

# spring - Grails：在 Bootstrap 代码的 destory 闭包中访问 spring bean？

> ID：574807
> 
> 赞同：7
> 
> 时间：2009-02-22T11:59:07.440
> 
> 标签：spring, grails, bootstrapping

我正在寻找在我的 grails 项目的 Bootstrap.groovy 中的销毁闭包中访问一个 bean。关于如何实现这一目标的任何想法？

我似乎无法访问 servletContext ...？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-05T11:24:40.910

您可以使用该代码块从任何地方（包括 BootStrap 的销毁闭包）获取对 applicationContext 的引用：

```
def ctx = org.codehaus.groovy.grails.web.context.ServletContextHolder.servletContext.getAttribute(org.codehaus.groovy.grails.web.servlet.GrailsApplicationAttributes.APPLICATION_CONTEXT); 
```

获取对 bean 的引用就像`ctx.beanName`.

这是一个可以简化此任务的小型 util 类（用 Java 编写）：

```
import org.springframework.context.ApplicationContext;
import org.codehaus.groovy.grails.web.context.ServletContextHolder;
import org.codehaus.groovy.grails.web.servlet.GrailsApplicationAttributes;

public class SpringUtil {

    public static ApplicationContext getCtx() {
        return getApplicationContext();
    }

    public static ApplicationContext getApplicationContext() {
        return (ApplicationContext) ServletContextHolder.getServletContext().getAttribute(GrailsApplicationAttributes.APPLICATION_CONTEXT);
    }

    @SuppressWarnings("unchecked")
    public static <T> T getBean(String beanName) {
        return (T) getApplicationContext().getBean(beanName);
    }

} 
```

和一个例子：

```
def bean = SpringUtil.getBean("beanName") 
```

干杯，西吉

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-31T21:50:02.273

我知道我在这里都迟到了，但自从我通过谷歌找到了这个......

您的 BootStrap 类按名称注入 Spring bean，就像所有服务和控制器等一样。如果你想要一个 bean，只需按名称定义它，它就会出现。否则，只需 def grailsApplication 并转到 grailsApplication.mainContext.getBean 等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T23:30:59.570

*嗯，即使在 Bootstrap 中使用*破坏块闭包，我也找不到任何人的例子。从文档：

```
    不保证会调用 {{destroy}}，除非
应用程序正常退出（例如通过使用应用程序
服务器的关闭命令）所以不要过分依赖它

```

作为一种猜测，我不得不说 servletContext 在执行 Bootstrap 的 {{destroy}} 闭包之前已经被销毁，因此您尝试访问的 bean 已经消失了。任何人都可以确认吗？

# java - 加载包含在 jar 中的资源

> ID：574809
> 
> 赞同：22
> 
> 时间：2009-02-22T12:00:15.113
> 
> 标签：java, jar, resources

在我的应用程序中，我以这种方式加载资源：

```
WinProcessor.class.getResource("repository").toString(); 
```

这给了我：

```
file:/root/app/repository   (and I replace "file:" with empty string) 
```

当我从 IDE 运行我的应用程序时，这工作正常，但是当我运行我的应用程序的 jar 时：

```
java -jar app.jar 
```

路径变为：

```
jar:/root/app.jar!/repository 
```

有没有办法解决这个问题？

我将使用“存储库”目录名称来创建它：

```
ConfigurationContext ctx = (ConfigurationContext) ConfigurationContextFactory.createConfigurationContextFromFileSystem(repositoryString, null); 
```

以同样的方式，我会得到一个文件名（而不是一个目录），我会这样使用它：

```
System.setProperty("javax.net.ssl.trustStore", fileNameString) 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-22T12:04:04.357

听起来您正在尝试使用 a`FileInputStream`或类似的东西加载资源。不要那样做：而不是调用`getResource`，调用[`getResourceAsStream`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))并从中读取数据。

（您可以改为从 URL 加载资源，但调用`getResourceAsStream`更方便一些。）

编辑：看到您更新的答案后，似乎其他代码位依赖于文件系统中物理单个文件中的数据。因此，答案是首先不要将它捆绑在一个 jar 文件中。你*可以*检查它是否在一个单独的文件中，如果不把它解压到一个临时文件中，但这在 IMO 中是相当 hacky 的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T23:41:02.590

使用 运行代码时`java -jar app.jar`，java 仅使用 JAR 文件清单中定义的类路径（即`Class-Path`属性）。如果该类位于 中`app.jar`，或者该类位于 JAR 清单的属性中设置的类路径中`Class-Path`，则可以使用以下代码片段加载该类，其中`className`是完全限定的类名。

```
final String classAsPath = className.replace('.', '/') + ".class";
final InputStream input = ClassLoader.getSystemResourceAsStream( path/to/class ); 
```

现在，如果该类不是 JAR 的一部分，并且不在清单中`Class-Path`，那么类加载器将找不到它。相反，您可以使用`URLClassLoader`, 小心处理 windows 和 Unix/Linux/MacOSX 之间的差异。

```
// the class to load
final String classAsPath = className.replace('.', '/') + ".class";

// the URL to the `app.jar` file (Windows and Unix/Linux/MacOSX below)
final URL url = new URL( "file", null, "///C:/Users/diffusive/app.jar" );
//final URL url = new URL( "file", null, "/Users/diffusive/app.jar" );

// create the class loader with the JAR file
final URLClassLoader urlClassLoader = new URLClassLoader( new URL[] { url } );

// grab the resource, through, this time from the `URLClassLoader` object
// rather than from the `ClassLoader` class
final InputStream input = urlClassLoader.getResourceAsStream( classAsPath ); 
```

在这两个示例中，您都需要处理异常，以及输入流`null`是否找不到资源这一事实。另外，如果你需要`InputStream`进入一个`byte[]`，你可以使用 Apache 的 commons `IOUtils.toByteArray(...)`。而且，如果你想要一个`Class`，你可以使用类加载器的`defineClass(...)`方法，它接受`byte[]`.

您可以在 Diffusive 源代码中的一个类中找到此代码[`ClassLoaderUtils`](http://sourceforge.net/p/diffusive/code/ci/5168b7cc7015788bf54b1bddc370c71b144a1762/tree/src/org/microtitan/diffusive/utils/ClassLoaderUtils.java?format=raw)，您可以在 SourceForge 的 github.com/robphilipp/diffusive 上找到该代码

以及一种从相对路径和绝对路径为 Windows 和 Unix/Linux/MacOSX 创建 URL 的方法[`RestfulDiffuserManagerResource.createJarClassPath(...)`](https://github.com/robphilipp/diffusive/blob/develop/restful_server/src/main/java/org/microtitan/diffusive/diffuser/restful/resources/RestfulDiffuserManagerResource.java?source=c)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-22T12:03:19.567

构造 a ，然后您可以使用该方法`URL`加载资源（甚至在 jar 文件中） 。[`openStream`](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URL.html#openStream())

# javascript - 在 html Javascript 中搜索

> ID：574816
> 
> 赞同：1
> 
> 时间：2009-02-22T12:06:06.940
> 
> 标签：javascript, jquery, html, xhtml

我有下面的 HTML 代码，我也将有一个用于输入关键字的文本框，我想要的是当用户在此文本框中编写时，使用 FirstName 和 LastName 在此 HTML 代码中进行 javascript 搜索，并且在比较项目时，如果一个项目与我想要`display: none`的容器 div不匹配。我如何使用 JS 来做到这一点并在 firefox 和 IE 上工作

```
<div id="contact_4">
    <input class="contactChk" id="chk_4" type="checkbox" />
    <img alt="" src='img/4.jpg' width="25px" height="25px" />
    <span id="contactName_4" class="contactItem">
        FirstName LastName
    </span>
    <br />
</div>
<div id="contact_5">
    <input class="contactChk" id="chk_5" type="checkbox" />
    <img alt="" src='img/5.jpg' width="25px" height="25px" />
    <span id="contactName_5" class="contactItem">
        ACharName AnyLast
    </span>
    <br />
</div>
<div id="contact_6">
    <input class="contactChk" id="chk_6" type="checkbox" />
    <img alt="" src='img/6.jpg' width="25px" height="25px" />
    <span id="contactName_6" class="contactItem">
        BCharName AnyLast
    </span>
    <br />
</div>
<div id="contact_7">
    <input class="contactChk" id="chk_7" type="checkbox" />
    <img alt="" src='img/7.jpg' width="25px" height="25px" />
    <span id="contactName_7" class="contactItem">
        CCharName AnyLast
    </span>
    <br />
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T13:07:17.260

如果您要显示更大的联系人集，这看起来非常低效。最简单的方法是使用[jQuery](http://jquery.com/)并将函数绑定到文本字段的 keyup 事件：（假设上面的代码包含在类似的内容中`<div id="contactlist">`）

```
 var searchstring = "";

function filterContact() {
  var jthis = $(this); // should give a tiny performance gain
  if ($('span.contactItem', this).text().toLowerCase().indexOf(searchstring) >= 0) {
    jthis.addClass('matching');
    jthis.removeClass('nonmatching');
  } else {
    jthis.addClass('nonmatching');
    jthis.removeClass('matching');
  }
}

function filterContacts() {
  var elem = $('input#yourtextfield')[0];
  searchstring = elem.value.toLowerCase(); // because we like to match all cases
  searchstring = searchstring.replace(/^\s+/,'').replace(/\s+$/,''); // trim

  $('#contactlist div').each(filterContact);
}

function initFiltering() {
  $('input#yourtextfield').live('keyup',filterContacts);
}

$(document).ready(initFiltering); 
```

还要向您的 CSS添加`.matching`和类。`.nonmatching`(`display: block`和`none`)

如前所述，这非常低效，不仅需要内存（和带宽），还需要过滤时的 CPU 时间（加上渲染时间）。如果您在某个数组中处理该数据，或者如果您有非常大的数据集，您应该按需从服务器获取分页的过滤数据（也可以通过 jQuery 的 AJAX 函数完成），它可能会更快。如果用户仍在输入，您还可以延迟过滤（仅在他停止输入约 500 毫秒时过滤）。

`toLowerCase()`非 ASCII 输入可能会遇到一些困难；所以如果你需要它，你应该在你的目标语言上测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T14:58:16.860

这可能会帮助你：

> **javascript**

```
<script language="javascript">
    function go() {
        elem = document.getElementById("thesearch");
        for (var x = 4; x <= 7; x++) {
            if (((document.getElementById('contactName_' + x).innerHTML).toUpperCase()).indexOf((elem.value).toUpperCase()) > -1)
                document.getElementById('contact_' + x).style.display = "";
            else
                document.getElementById('contact_' + x).style.display = "none";
        }

    }
</script> 
```

> **HTML**

```
<input type="text" value="" id="thesearch" onkeyup="go();" /> 
```

请注意，在我的示例中，要检查的 div 数量是固定的和静态的。这应该改进，但这个例子在 IE6 / FF3 中工作。

希望这能有所帮助。

编辑：哦，是的，toUpperCase() 可以删除，如果你想要一些区分大小写的东西

# .htaccess - 编辑 .htaccess 文件

> ID：574818
> 
> 赞同：3
> 
> 时间：2009-02-22T12:07:10.090
> 
> 标签：.htaccess, mod-rewrite, codeigniter

我使用 CodeIgniter 创建了一个应用程序，并尝试使用[CodeIgniter 用户指南](http://codeigniter.com/user_guide/general/urls.html)中列出的 apache mod_rewrite 规则，如下所示：

```
RewriteEngine on

RewriteCond $1 !^(index\.php|images|robots\.txt)

RewriteRule ^(.*)$ /index.php/$1 [L] 
```

问题是我在一个文件夹中有这个应用程序`abc/`，但是当我输入`mysite/abc/something`（应该指向`mysite/abc/index.php/something`）时，我被重定向到`mysite/index.php/something`.

我应该对`.htaccess`文件进行哪些更改以使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T12:17:33.997

```
RewriteCond $1 !(index\.php|^images|^robots\.txt)
RewriteRule (.*) index.php/$1 [L,NS] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T12:15:17.323

尝试在替换中使用相对路径：

```
RewriteCond $1 !^(index\.php|images|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L] 
```

# c# - MSDN C# DeflateStream 示例代码问题

> ID：574824
> 
> 赞同：0
> 
> 时间：2009-02-22T12:13:48.887
> 
> 标签：c#, compression, deflatestream

任何想法为什么在下面的示例中，我们需要添加 100 (buffer.Length + 100)？buffer.Length 应该和解压后的缓冲区长度一样，所以不需要再增加100。:-)

[http://msdn.microsoft.com/en-us/library/bc2dbwea.aspx](http://msdn.microsoft.com/en-us/library/bc2dbwea.aspx)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T12:22:06.557

我不知道他们为什么要这样做，但这通常不是一个很好的例子——例如，他们使用显式调用`Close`（而不是在 finally 块中）`FileStream`而不是使用`using`语句，并且还假设一次调用`Read`将读取整个文件。哎呀，即使将整个文件读入缓冲区也是一个坏主意——最好一次将一个块直接复制到`DeflateStream`.

这些事情向我表明，在该示例中不必担心这个特定的奇数位代码（额外的 100 个字节）。当然不要将其视为“最佳实践”。

MSDN 的例子通常比这更好——尽管还有很多其他奇怪的例子。

编辑：重新阅读代码和 CodeMelt 的答案后，它确实需要额外的 100 个字节——但这只是因为 ReadAllBytesFromStream 的实现如此糟糕。这是一个更好的实现，它总是要求流填充缓冲区的其余部分：

```
public static int ReadAllBytesFromStream(Stream stream, byte[] buffer) 
{
    int offset = 0;
    int bytesRead;
    while ((bytesRead = stream.Read(buffer, offset, 
                                    buffer.Length-offset)) > 0) 
    {
        offset += bytesRead;
    }
    return offset;
} 
```

（请注意，两者都不需要，`offset`因为`totalCount`它们总是具有相同的值。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T12:24:16.787

它可以防止 stream.Read(buffer, offset, 100) 在以下方法中超过其长度，因为流一直在读取，直到它什么也没读。

```
public static int ReadAllBytesFromStream(Stream stream, byte[] buffer) 
{
// Use this method is used to read all bytes from a stream.
int offset = 0;
int totalCount = 0;
    while (true) 
    {
    // even it reads to the end, but it will still read the next
    // 100 bytes to see if anything has been read.
    int bytesRead = stream.Read(buffer, offset, 100); 
        if ( bytesRead == 0) 
        {
        break; 
        }
offset += bytesRead;
totalCount += bytesRead; 
    }
return totalCount;
} 
```

# visual-studio-2008 - 将新的 MS C++ 编译器与旧的 Visual Studio 一起使用

> ID：574827
> 
> 赞同：1
> 
> 时间：2009-02-22T12:19:55.550
> 
> 标签：visual-studio-2008, ide, compiler-construction, visual-c++-6

我想将最近的 MS C++ 编译器（我需要 TR1）与旧 IDE（Visual C 6.0）一起使用。我听说我只能下载免费的命令行 MS C++ 编译器。是否可以？我可以在旧 IDE 中使用新编译器吗？如果是这样，可能会出现哪些其他问题？

我想保留 VS6，因为我很熟悉它。我想使用 TR1 的 MS 实现，因为我希望它比 Boost 更快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T12:23:04.653

您实际上可以下载**新 IDE**的免费版本，即[Express Edition](http://www.microsoft.com/express/vc/)。与非免费版本相比，它有一些限制（例如，不支持插件），但对于大多数应用程序来说，它仍然大大优于 VS6。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T12:32:06.223

Visual Studio 版本将非常愉快地并排安装。

只需避免双击解决方案文件（这将打开最新的），而是从正确的版本打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T12:33:09.217

您是否考虑过使用[Boost.TR1](http://www.boost.org/doc/libs/1_38_0/doc/html/boost_tr1.html)？

# java - 在命令行上将感叹号传递给java程序

> ID：574835
> 
> 赞同：3
> 
> 时间：2009-02-22T12:24:25.180
> 
> 标签：java, command-line

我想传递字符串“！changeme！” 到命令行上的java程序，如：

```
java -cp "!AXIS2_CLASS_PATH!" ClientJava --userid admin --passwd "!changeme!" 
```

使用 Windows XP，Java jdk 1.6.0_07。

AXIS2_CLASS_PATH 被正常替换，我假设由 java 运行时。但是 !changeme! 的密码！似乎也被替换为空字符串。我假设这个替换是某种 JVM 特性。

使用以下程序：

```
static int Run(String[] aArgs) {
    for (String s: aArgs) {
        System.out.println("arg: " + s);
    }
    return 0;
} 
```

我得到以下结果：

```
"C:\Program Files\Java\jdk1.6.0_07\bin\java" -cp "!AXIS2_CLASS_PATH!"
    ClientJava --userid admin --passwd "!changeme!"
arg: --userid
arg: admin
arg: --passwd
arg: 
```

我需要按原样传递密码。我已经尝试了各种转义，但我还没有找到我需要使用的东西。

任何人都可以提供有关如何执行此操作的提示吗？

**[Zach Scrivena](https://stackoverflow.com/questions/574835/passing-exclamation-point-to-java-program-on-command-line/574893#574893)提供的解决方案是：**

使用插入符号来转义感叹号。

```
java -cp "!AXIS2_CLASS_PATH!" ClientJava --xxx "^!changeme^!"

arg: --userid
arg: admin
arg: --passwd
arg: !changeme! 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T13:06:47.153

`!`问题是由命令行解释器引起的——它用相应的环境变量替换了感叹号中的术语。

只需在每个转义字符前加上一个插入符号`^`。这适用于命令行和批处理文件：

```
java -cp "!AXIS2_CLASS_PATH!" ClientJava --xxx "^!changeme^!" 
```

在命令行上，您还可以将每个转义字符括在双引号中`"`

```
java -cp "!AXIS2_CLASS_PATH!" ClientJava --xxx ""!"changeme"!"" 
```

# c# - VS2008，Windows Mobile 安装程序项目

> ID：574839
> 
> 赞同：3
> 
> 时间：2009-02-22T12:28:44.810
> 
> 标签：c#, .net-3.5, windows-mobile, installation

我正在使用 Visual Studio 2008 专业版。我为 Windows Mobile 编写了一个应用程序，我想为此应用程序创建安装程序。它是怎么做的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-22T13:25:46.780

您需要将应用程序打包到 CAB 文件中。

要做到这一点很容易——您只需创建一个新的“智能设备 CAB 项目”（新项目->其他项目类型->设置和部署）。

首先 - 指定您希望应用程序的 exe 项目的输出与任何其他相关 dll 一起进入应用程序目录。

您可能还想为您的应用程序创建一个图标，方法是右键单击目标计算机上的文件系统，选择添加特殊文件夹->开始菜单文件夹，然后再次右键单击开始菜单文件夹并选择创建新快捷方式。现在将此快捷方式指向应用程序的 exe。

根据您项目的要求，可能还需要创建一个桌面安装程序（msi 文件），您的用户可以直接在他们的 Windows PC 上运行，它指示 ActiveSync 在下次插入 Windows Mobile 设备时自动安装您的 cab 文件基本上，这是通过从命令行调用 ActiveSync (CeAppMgr.exe) 并传递一个引用您的 cab 文件的 ini 文件来完成的。

如果您在安装过程中需要做任何其他更复杂的事情，也可以编写一个“自定义操作”，其中 cab 文件调用另一个 dll（由您编写）以执行安装过程中需要执行的任何其他步骤.

[可在此处](http://msdn.microsoft.com/en-us/library/aa446504.aspx)获得上述所有内容的综合指南

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T08:18:06.740

[Mobile Packager](http://www.mobilepackager.com) (www.MobilePackager.com)等工具也可用于为 Windows Mobile 创建安装包。它允许您创建非常流畅的安装程序，以便通过桌面或设备安装进行安装。

[![设备上的移动打包程序安装](https://i.stack.imgur.com/xeIR9.jpg)](https://i.stack.imgur.com/xeIR9.jpg)
[（来源：[mobilepackager.com](http://www.mobilepackager.com/images/Screen_Device.jpg)）]

看看这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T12:33:56.747

[http://msdn.microsoft.com/en-us/library/bb158729.aspx](http://msdn.microsoft.com/en-us/library/bb158729.aspx)

在这里，您可以找到不止一种解决问题的方法。此外，还有一些软件可以在 VS2008 环境之外直接创建 CAB 文件，但我尝试的所有软件都非常讨厌且成本高昂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T18:58:55.340

我自己的经验是，创建在 Windows 下运行的安装文件太费时了（除非您只是在谈论创建输出 CAB 的安装项目，这需要额外的 .NET 框架安装程序，并且只能在您的 WM 中运行机器）。

“官方”过程包括生成 CAB 文件、使 CAB 文件“自动运行”的附加 DLL，以及安装该 DLL 的附加安装项目。

如果您要以这种方式进行，请参阅此处：http: [//msdn.microsoft.com/en-us/library/bb158529.aspx](http://msdn.microsoft.com/en-us/library/bb158529.aspx)

经过几天的挣扎，我决定购买商业产品来自动创建安装文件。我购买的一个名为“PocketPC Installer Professional”（谷歌它，因为我与这个商业产品无关）。生成的设置看起来与通常的 Windows 软件设置不相似，但至少它可以工作并且需要更少的努力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T20:20:13.680

谢谢回复。我找到了本教程：[Installer](http://msdn.microsoft.com/en-us/netframework/bb649500.aspx)。

* * *

最好的：[卫星表格知识库](http://www.satelliteforms.net/KB/index.html?HowToCreateAnInstallerForYourSatForms7PocketPCApplication)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-19T08:14:26.313

这是 InnoSetup（带有预处理器）中的一个非常基本的脚本示例，用于为 Windows 移动设备创建桌面安装程序。您必须已经创建了 CAB 并编写了 .ini 文件才能正常工作。

```
#define AppName "Your Software"
#define AppPublisher "Your Name Here"
#define ExeName "Your Software.exe"
#define UnixName "YourSoftware"
#define Short "YS"
#define Version "1.0"

[Setup]
AppName={#AppName}
AppVerName={#AppName} {#Version}
AppPublisher={#AppPublisher}
DefaultDirName={pf}\{#AppName}
DefaultGroupName={#AppName}
AllowNoIcons=yes
LicenseFile=license.rtf
OutputDir=//
OutputBaseFilename={#Short}_{#Version}_Setup
SetupIconFile=Icons\{#UnixName}.ico
Compression=lzma
SolidCompression=yes

[Languages]
Name: english; MessagesFile: compiler:Default.isl

[Tasks]
Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked

[Registry]
Root: HKLM; Subkey: Software\{#Short}; ValueType: string; ValueName: Version; ValueData: {#Version}; Flags: uninsdeletekey

[Files]
Source: license.rtf; DestDir: {app}; Flags: ignoreversion
Source: {#UnixName}_{#Version}_Setup.CAB; DestDir: {app}; Flags: ignoreversion
Source: {#UnixName}_{#Version}_Setup.ini; DestDir: {app}; Flags: ignoreversion

[Icons]
Name: {group}\{#AppName}; Filename: {app}\{#ExeName}
Name: {group}\{cm:UninstallProgram,{#AppName}}; Filename: {uninstallexe}
Name: {userdesktop}\{#AppName}; Filename: {app}\{#ExeName}; Tasks: desktopicon
Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\{#AppName}; Filename: {app}\{#ExeName}; Tasks: quicklaunchicon

[Run]
Filename: "{pf64}\Microsoft ActiveSync\CEAPPMGR.EXE"; Parameters: ""{app}\{#UnixName}_{#Version}_Setup.ini""; Check: Is64BitInstallMode; WorkingDir: {app}
Filename: "{pf32}\Microsoft ActiveSync\CEAPPMGR.EXE"; Parameters: ""{app}\{#UnixName}_{#Version}_Setup.ini""; Check: not Is64BitInstallMode; WorkingDir: {app} 
```

# c# - 如何实现可以取消的事件？

> ID：574849
> 
> 赞同：3
> 
> 时间：2009-02-22T12:35:59.207
> 
> 标签：c#, .net, events

帮我实现一个事件，哪个处理程序可以取消它。

```
public class BuildStartEventArgs : EventArgs
{
    public bool Cancel { get; set; }
}

class Foo
{
    public event EventHandler<BuildStartEventArgs> BuildStart;

    private void Bar()
    {
        // build started
        OnBuildStart(new BuildStartEventArgs());
        // how to catch cancellation?
    }

    private void OnBuildStart(BuildStartEventArgs e)
    {
        if (this.BuildStart != null)
        {
            this.BuildStart(this, e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T12:39:46.920

您需要修改此代码：

```
private void Bar()
{
    // build started
    OnBuildStart(new BuildStartEventArgs());
    // how to catch cancellation?
} 
```

像这样：

```
private void Bar()
{
    var e = new BuildStartEventArgs();
    OnBuildStart(e);
    if (!e.Cancel) {
      // Do build
    }
} 
```

.NET 中的类具有引用语义，因此您可以通过事件引用的参数看到对对象所做的任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T12:40:03.490

在 BuildStartEventArgs 类上有一个布尔 Cancel 属性。让事件处理程序能够对此进行标记。

```
private void Bar()
{
  // build started
  var args = new BuildStartEventArgs();
  OnBuildStart(args);
  if (args.Cancel)
  {
    // cancel
  }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T12:41:06.433

你`BuildStartEventArgs`是多余的，框架已经提供了这个[`CancelEventArgs`](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.aspx)类——考虑使用它。

# php - 如何在 PHP 中的 MSSQL 中获取插入 ID？

> ID：574851
> 
> 赞同：9
> 
> 时间：2009-02-22T12:37:06.507
> 
> 标签：php, sql-server

问题标题说什么。对于诸如 的查询`SELECT @@IDENTITY AS ins_id`，我是否需要提供表名或任何其他信息来指定我正在谈论的表/数据库？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-22T12:54:31.147

[`@@IDENTITY`](http://msdn.microsoft.com/en-us/library/ms187342.aspx)返回当前会话中生成的最新身份。在大多数情况下，您可能希望使用[`SCOPE_IDENTITY`](http://msdn.microsoft.com/en-us/library/ms190315.aspx)它来返回当前范围内生成的最新标识。

例如，如果您在*table1*中插入一行，但该插入触发了一个触发器，该触发器将一行插入到*table2*中，那么`@@IDENTITY`将从*table2*返回标识，而`SCOPE_IDENTITY`从*table1*返回标识。

```
INSERT INTO my_table (my_column) VALUES ('test')

-- return the identity of the row you just inserted into my_table
-- regardless of any other inserts made by triggers etc
SELECT SCOPE_IDENTITY() AS ins_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T12:44:38.953

不; 它的工作原理很像 mysql 中的 SELECT LAST_INSERT_ID()，检索最后插入的标识值。您可能想看看[这个深入的检查](http://www.kamath.com/tutorials/tut007_identity.asp)，以了解更多关于您可能想要关注的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-26T20:57:11.297

这是基于 Joomla 代码的代码片段。$dbh 是数据库连接（mssql_connect() 的结果）。如果您传递 $keyName 参数，则会更新密钥名称 (ID)。

此代码使用 MSSQL 关键字“OUTPUT”来获取插入值的 ID（或任何所需值）。

```
function mssql_insertObject($table, &$object, $keyName = NULL)
{
    global $dbh;

    if($keyName) {
        $fmtsql = 'INSERT INTO '. $table .' ( %s ) OUTPUT INSERTED.' . $keyName . ' VALUES ( %s ) ';
    }
    else {
        $fmtsql = 'INSERT INTO '. $table .' ( %s ) VALUES ( %s ) ';
    }

    $fields = array();

    foreach (get_object_vars( $object ) as $k => $v) {
        if (is_array($v) or is_object($v) or $v === NULL) {
            continue;
        }

        if ($k[0] == '_') { // internal field
            continue;
        }

        $fields[] = $k;
        $values[] = "'" . str_replace("'", "''", $v) . "'";
    }

    $sql = sprintf( $fmtsql, implode( ",", $fields ) ,  implode( ",", $values ) );

    $query = mssql_query($sql, $dbh);

    if($query === false) {
        return false;
    }

    if(is_resource($query))
    {
        if($keyName) {
            $id = mssql_result($query, 0, 0);

            if($id) {
                $object->$keyName = $id;
            }
        }

        mssql_free_result($query);
    }

    return true;
} 
```

# javascript - 如何在一个类中添加/删除一个类 当它已经有课程时

> ID：574860
> 
> 赞同：2
> 
> 时间：2009-02-22T12:41:39.537
> 
> 标签：javascript, jquery

当 div 已经有一个或多个类时，如何从 div 中添加/删除一个类？

```
<div class="class1 class2" id="id1">some text</div>

$("#id1").toggleClass("class3"); // doesn't work

$("#id1").toggleClass(" class3"); // doesn't work 
```

我必须解析字符串吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T12:47:16.187

你的代码肯定可以工作。实际上，该[`toggleClass`示例](http://docs.jquery.com/Attributes/toggleClass) *使用*了多个类名！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T12:47:42.720

你试过 $("#id1").addClass("classname") 和 $("#id1").removeClass("classname") 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T12:46:04.863

我相信你可以遍历这些类。

[这是关于 JQuery google 组的讨论。](http://groups.google.com/group/jquery-en/browse_thread/thread/33a01a43d67e5d7c?pli=1)

编辑：[也发现了一个与此相关的问题。](https://stackoverflow.com/questions/529737/jquery-multiple-class-actions)

# python - 使用 python libgmail 在邮件中包含 html 部分

> ID：574861
> 
> 赞同：2
> 
> 时间：2009-02-22T12:41:45.823
> 
> 标签：python, html, gmail, mime, libgmail

我有一个关于它的用法的问题：我需要发送一个 html 格式的邮件。我准备我的信息

```
ga = libgmail.GmailAccount(USERNAME,PASSWORD)
msg = MIMEMultipart('alternative') 
msg.attach(part1)
msg.attach(part2)
...
ga.sendMessage(msg.as_string()) 
```

这种方式行不通，好像不能`msg`用 sendMessage 方法发送。什么是正确的方法？: D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T13:40:48.773

如果您从 sourceforge 引用`libgmail`，则需要使用[电子邮件模块](http://docs.python.org/library/email.html#module-email)撰写您的消息。

将 HTML 消息生成为[MIME 文档](http://docs.python.org/library/email.generator.html)，并将其作为[多部分 MIME 消息](http://docs.python.org/library/email.mime.html#email.mime.multipart.MIMEMultipart)的一部分。当你有一个完全构造的多部分 MIME 时，将它作为一个字符串传递给`libgmail`构造函数，使用 to`.as_string()`方法。

[文档](http://docs.python.org/library/email-examples.html#id4)中的示例包含类似要求的代码：

```
# Create message container - the correct MIME type is multipart/alternative.
msg = MIMEMultipart('alternative')
msg['Subject'] = "Link"
msg['From'] = me
msg['To'] = you
...
# Record the MIME types of both parts - text/plain and text/html.
# ... text and html are strings with appropriate content.
part1 = MIMEText(text, 'plain')
part2 = MIMEText(html, 'html')

# Attach parts into message container.
# According to RFC 2046, the last part of a multipart message, in this case
# the HTML message, is best and preferred.
msg.attach(part1)
msg.attach(part2) 
```

# c# - C# ASP.NET QueryString 解析器

> ID：574868
> 
> 赞同：7
> 
> 时间：2009-02-22T12:45:30.963
> 
> 标签：c#, asp.net, query-string

如果您一直在寻找一种很好且干净的方法来解析查询字符串值，我想出了这个：

```
 /// <summary>
    /// Parses the query string and returns a valid value.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="key">The query string key.</param>
    /// <param name="value">The value.</param>
    protected internal T ParseQueryStringValue<T>(string key, string value)
    {
        if (!string.IsNullOrEmpty(value))
        {
            //TODO: Map other common QueryString parameters type ...
            if (typeof(T) == typeof(string))
            {
                return (T)Convert.ChangeType(value, typeof(T));
            }
            if (typeof(T) == typeof(int))
            {
                int tempValue;
                if (!int.TryParse(value, out tempValue))
                {
                    throw new ApplicationException(string.Format("Invalid QueryString parameter {0}. The value " +
                                                              "'{1}' is not a valid {2} type.", key, value, "int"));
                }
                return (T)Convert.ChangeType(tempValue, typeof(T));
            }
            if (typeof(T) == typeof(DateTime))
            {
                DateTime tempValue;
                if (!DateTime.TryParse(value, out tempValue))
                {
                    throw new ApplicationException(string.Format("Invalid QueryString parameter {0}. The value " +
                                                         "'{1}' is not a valid {2} type.", key, value, "DateTime"));
                }
                return (T)Convert.ChangeType(tempValue, typeof(T));
            }
        }
        return default(T);
    } 
```

我一直想拥有这样的东西，最后做对了……至少我是这么认为的……

代码应该是不言自明的......

任何使它更好的意见或建议表示赞赏。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-09-03T00:13:38.060

一种简单的解析方法（如果您不想进行类型转换）是

```
 HttpUtility.ParseQueryString(queryString); 
```

您可以从 URL 中提取查询字符串

```
 new Uri(url).Query 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-22T12:51:58.703

鉴于您只处理三种不同的类型，我建议改为使用三种不同的方法 - 泛型方法最好适用于类型约束允许的每个类型参数。

此外，我强烈建议您指定要使用的`int`文化`DateTime`- 它不应该真正取决于服务器恰好所处的文化。（如果您有代码来猜测用户的文化，您可以使用它相反。）最后，我还建议支持一组明确指定的`DateTime`格式，而不仅仅是`TryParse`默认支持的任何格式。（我几乎*总是*使用`ParseExact`/`TryParseExact`而不是`Parse`/ `TryParse`。）

请注意，字符串版本实际上不需要做任何事情，因为它`value`已经是一个字符串（尽管您当前的代码将 "" 转换为`null`，这可能是您想要的，也可能不是您想要的）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-17T11:39:55.037

我编写了以下方法来将 QueryString 解析为强类型值：

```
public static bool TryGetValue<T>(string key, out T value, IFormatProvider provider)
{
    string queryStringValue = HttpContext.Current.Request.QueryString[key];

    if (queryStringValue != null)
    {
        // Value is found, try to change the type
        try
        {
            value = (T)Convert.ChangeType(queryStringValue, typeof(T), provider);
            return true;
        }
        catch
        {
            // Type could not be changed
        }
    }

    // Value is not found, return default
    value = default(T);
    return false;
} 
```

使用示例：

```
int productId = 0;
bool success = TryGetValue<int>("ProductId", out productId, CultureInfo.CurrentCulture); 
```

对于 的查询字符串`?productId=5`将为`bool`真并且`int productId`等于 5。

对于 的查询字符串`?productId=hello`将`bool`是假的，`int productId`将等于 0。

对于 的查询字符串`?noProductId=notIncluded`将`bool`是假的，`int productId`将等于 0。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T13:02:04.823

在我的应用程序中，我一直在使用以下功能：-

```
public static class WebUtil
{
    public static T GetValue<T>(string key, StateBag stateBag, T defaultValue)
    {
        object o = stateBag[key];

        return o == null ? defaultValue : (T)o;
    }
} 
```

如果未提供参数，则返回所需的默认值，从 defaultValue 推断类型，并根据需要引发强制转换异常。

用法如下：-

```
var foo = WebUtil.GetValue("foo", ViewState, default(int?)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-04T22:16:20.960

这是一个旧答案，但我做了以下事情：

```
 string queryString = relayState.Split("?").ElementAt(1);
            NameValueCollection nvc = HttpUtility.ParseQueryString(queryString); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T12:54:08.603

在我看来，您正在做很多不必要的类型转换。tempValue 变量是您尝试返回的类型的前导。同样在字符串的情况下，值已经是一个字符串，所以只需返回它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-06T13:43:41.637

根据[Ronalds 的回答](https://stackoverflow.com/questions/574868/c-asp-net-querystring-parser/1921182#1921182)，我更新了自己的查询字符串解析方法。我使用它的方法是将它作为扩展方法添加到 Page 对象上，这样我就可以轻松检查查询字符串的值和类型，并在页面请求无效时重定向。

扩展方法如下所示：

```
public static class PageHelpers
{
    public static void RequireOrPermanentRedirect<T>(this System.Web.UI.Page page, string QueryStringKey, string RedirectUrl)
    {
        string QueryStringValue = page.Request.QueryString[QueryStringKey];

        if(String.IsNullOrEmpty(QueryStringValue))
        {
            page.Response.RedirectPermanent(RedirectUrl);
        }

        try
        {
            T value = (T)Convert.ChangeType(QueryStringValue, typeof(T));
        }
        catch
        {
            page.Response.RedirectPermanent(RedirectUrl);
        }
    }
} 
```

这让我可以执行以下操作：

```
protected void Page_Load(object sender, EventArgs e)
{
    Page.RequireOrPermanentRedirect<int>("CategoryId", "/");
} 
```

然后，我可以编写其余代码并依赖查询字符串项的存在和正确格式，因此我不必在每次想要访问它时都对其进行测试。

注意：如果您使用的是 .net 4 之前的版本，那么您还需要以下 RedirectPermanent 扩展方法：

```
public static class HttpResponseHelpers
{
    public static void RedirectPermanent(this System.Web.HttpResponse response, string uri)
    {
        response.StatusCode = 301;
        response.StatusDescription = "Moved Permanently";
        response.AddHeader("Location", uri);
        response.End();
    }
} 
```

# fonts - 如何在 Smalltalk Squeak/Pharo 中轻松更改为原生字体

> ID：574873
> 
> 赞同：13
> 
> 时间：2009-02-22T12:50:32.013
> 
> 标签：fonts, smalltalk, squeak, pharo

对于每一个新的 Squeak/Pharo 图像，我都会立即将字体更改为一些原生版本。这是很多鼠标点击，我想编写这个过程的脚本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-09T21:05:03.817

上面的答案现在可能已经过时了，至少它不适用于我的 3.10 图像。所以，我用这个：

```
defaultFont := LogicalFont familyName: 'Geneva' pointSize: 10 emphasis:0 .
codeFont := LogicalFont familyName: 'Monaco' pointSize: 10 emphasis:0.
Preferences setCodeFontTo: codeFont.
Preferences setWindowTitleFontTo: defaultFont.
Preferences setButtonFontTo: defaultFont.
Preferences setListFontTo: defaultFont.
Preferences setMenuFontTo: defaultFont.
Preferences setSystemFontTo: defaultFont. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T18:14:46.257

找到了答案，正在寻找 setSystemFontTo。完整的脚本现在是：

```
"Set fonts on Mac OS X"
defaultFont := LogicalFont familyName: 'Lucida Grande' pointSize: 10 
   stretchValue:  5 weightValue: 400 slantValue: 0.
codeFont := LogicalFont familyName: 'Monaco' pointSize: 10 
   stretchValue:  5 weightValue: 400 slantValue: 0.
Preferences setCodeFontTo: codeFont.
Preferences setWindowTitleFontTo: defaultFont.
Preferences setButtonFontTo: defaultFont.
Preferences setListFontTo: defaultFont.
Preferences setMenuFontTo: defaultFont.
Preferences setSystemFontTo: defaultFont. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-09-19T19:31:32.070

**这是在 Pharo 中执行此操作的新方法：**

```
|font codeFont|

font := LogicalFont familyName: 'Bitmap DejaVu Sans' pointSize: 10.
codeFont := LogicalFont familyName: 'Bitmap DejaVu Sans' pointSize: 9.
StandardFonts listFont: codeFont.
StandardFonts menuFont: font.
StandardFonts codeFont: codeFont.
StandardFonts buttonFont: codeFont.
StandardFonts defaultFont: font.
StandardFonts windowTitleFont: font.

FreeTypeFontProvider current updateFromSystem. 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-07T09:51:01.123

在带有 Pharo 2.0 的 Linux 上，我将以下内容添加到一个特殊目录中的文件中，该目录在 Image 启动时会自动读取：

```
StartupLoader default executeAtomicItems: {
  StartupAction
    name: 'Use Free type'
    code: '(Smalltalk at: #FreeTypeSystemSettings)
    perform: #loadFt2Library: with: (true)'
    runOnce: true.
  StartupAction name: 'Setting up fonts' code: [
    |font codeFont|

    FileStream stdout lf; nextPutAll: 'Setting up fonts'; lf.

    font := LogicalFont familyName: 'DejaVu Sans' pointSize: 12.
    codeFont := LogicalFont familyName: 'DejaVu Sans Mono' pointSize: 12.
    StandardFonts listFont: codeFont.
    StandardFonts menuFont: font.
    StandardFonts codeFont: codeFont.
    StandardFonts buttonFont: codeFont.
    StandardFonts defaultFont: font.
    StandardFonts windowTitleFont: font.
    StandardFonts balloonFont: font.
    StandardFonts haloFont: font.

    FileStream stdout lf; nextPutAll: 'Finished'; lf].
}. 
```

这个特殊的目录可以用

```
FileDirectory preferencesVersionFolder 
```

您应该阅读 StartupLoader 类的文档。

# c# - 为什么允许从函数内返回不安全的指针？

> ID：574874
> 
> 赞同：2
> 
> 时间：2009-02-22T12:51:00.733
> 
> 标签：c#, .net, pointers, unsafe

我最近看到了几个真正做到这一点的开源项目。从函数返回一个不安全的指针，例如：“int* input = this.someIterator.GetUnsafePtr()”。

据我了解，这一定是完全错误的。不安全的指针只能通过“固定”语句获得，当然那些从函数内返回的指针将不再被固定（它们将“失去”它们的声明范围），导致它们最终被垃圾回收。

但是我也不记得编译器对此有任何警告，那么如果您实际上可以将“未固定”指针分布在各处，为什么还要费心使用固定语句呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T12:58:45.020

怎么样，`Marshal.AllocHGlobal`或者`Marshal.AllocCoTaskMem`，都返回 IntPtr，可以自由转换为`void *`使用`.ToPointer()`函数？

或者指针可以源自非托管代码。您需要`fix/pin`内存，因为内存是托管的，因此只要不是`fixed/pinned`垃圾收集器就可以自由移动它，从而使指针无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T13:04:25.723

我从未在开源项目中看到过这样的结构。如果您在问题中提供一些此类用法的示例，那就更好了。它的含义可能取决于行为。
但我同意，不安全的指针是邪恶的，只应在与某些本机库或代码交互时使用。
据我所知，您只能在不安全的块中使用此构造。所以我认为编译器不会在这里给出任何警告。而且 IMO 最好使用 IntPtr （不安全的块只能在完全信任的情况下执行）。
编辑：
@Stephen 是对的，IntPtr 不会保留对 GC 集合上对象的引用。

# c - 处理windows上的fpu异常

> ID：574877
> 
> 赞同：1
> 
> 时间：2009-02-22T12:52:42.787
> 
> 标签：c, windows, exception, fpu

我想在 Windows 上处理 fpu 异常，例如：

```
#include <math.h>
#include <fenv.h>
#include <stdio.h>

int main()
{
    double b = 0;
    int raised;
    feclearexcept (FE_ALL_EXCEPT);
    b /= 0;
    raised = fetestexcept (FE_OVERFLOW | FE_INVALID);
    if (raised & FE_OVERFLOW) { printf("over\n");}
    if (raised & FE_INVALID)  { printf("invalid\n");}

    return 0;
} 
```

但是在窗户上。我尝试阅读 MSDN，但文件根本不清楚。我想在 x86 和 amd64 架构上使用 Visual Studio 编译器来做到这一点。

我对在 C++ 中翻译异常不感兴趣——实际上，我什至对 FPU 异常都不感兴趣，只对经过一些计算后知道 FPU 状态感兴趣，就像上面的例子一样。

== 编辑 ==

好的，看起来它实际上要简单得多：使用 _clearfp 就足够了：

```
#include <math.h>
#include <float.h>
#include <stdio.h>

int main()
{
    double b = 0;
    int raised;
    raised = _clearfp();
    b /= 0;
    raised = _clearfp();
    if (raised & SW_INVALID)  { printf("invalid\n");}

    return 0;
} 
```

比处理异常、SEH 和其他不可移植的东西要好得多:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T13:07:09.010

如果是 Visual Studio，请尝试输入以下行：

```
#pragma   float_control (except, on) 
```

更多关于[这里](http://msdn.microsoft.com/en-us/library/e7s85ffb(VS.80).aspx)和[这里](http://msdn.microsoft.com/en-us/library/45ec64h6(VS.80).aspx)的信息。

**编辑：**

如果您想在纯 C 中执行此操作，则需要查看[结构化异常处理 ( *SEH* )。](http://msdn.microsoft.com/en-us/library/ms680657(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T15:38:24.557

您可以使用 _statusfp2() 检索浮点状态。注意 32 位同时使用 FPU 和 SSE 指令。一些示例代码：

```
#include "stdafx.h"
#include <float.h>
#include <math.h>
#include <assert.h>

int _tmain(int argc, _TCHAR* argv[])
{
  unsigned x86;
  unsigned sse;
  // Test zero-divide
  double d = 0;
  double v = 1 / d;
  _statusfp2(&x86, &sse);
  assert(x86 & _EM_ZERODIVIDE);
  // Test overflow
  v = pow(10, 310.0);
  _statusfp2(&x86, &sse);
  assert(sse & _EM_OVERFLOW);
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-22T12:58:24.803

这些功能是标准规定的，因此您在移植时应该没有问题。你遇到了什么确切的错误？

# c# - 如何在 .NET 中使用自定义格式对 TimeSpan 对象进行 String.Format ？

> ID：574881
> 
> 赞同：189
> 
> 时间：2009-02-22T12:57:55.443
> 
> 标签：c#, .net, string, time, formatting

`TimeSpan`将对象格式化为具有自定义格式的字符串的推荐方法是什么？

* * *

## 回答 #1

> 赞同：260
> 
> 时间：2010-12-08T10:13:48.123

**请注意：此答案适用于 .Net 4.0 及更高版本。如果您想在 .Net 3.5 或更低版本中格式化 TimeSpan，请参阅[JohannesH 的回答](https://stackoverflow.com/a/574894/39277)。**

.Net 4.0 中引入了自定义 TimeSpan 格式字符串。[您可以在 MSDN自定义时间跨度格式字符串](http://msdn.microsoft.com/en-us/library/ee372287.aspx)页面上找到可用格式说明符的完整参考。

这是一个示例时间跨度格式字符串：

```
string.Format("{0:hh\\:mm\\:ss}", myTimeSpan); //example output 15:36:15 
```

（**更新**），这是一个使用 C# 6 字符串插值的示例：

```
$"{myTimeSpan:hh\\:mm\\:ss}"; //example output 15:36:15 
```

您需要使用“\”转义“：”字符（除非您使用逐字字符串，否则必须对其本身进行转义）。

[MSDN Custom TimeSpan Format Strings](http://msdn.microsoft.com/en-us/library/ee372287.aspx)页面的这段摘录解释了如何转义“:”和“.”。格式字符串中的字符：

> 自定义 TimeSpan 格式说明符不包括占位符分隔符，例如将天与小时、小时与分钟或秒与小数秒分开的符号。相反，这些符号必须作为字符串文字包含在自定义格式字符串中。例如，“dd.hh:mm”将句点 (.) 定义为天和小时之间的分隔符，将冒号 (:) 定义为小时和分钟之间的分隔符。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2009-02-22T13:06:56.093

对于 .NET 3.5 及更低版本，您可以使用：

```
string.Format ("{0:00}:{1:00}:{2:00}", 
               (int)myTimeSpan.TotalHours, 
                    myTimeSpan.Minutes, 
                    myTimeSpan.Seconds); 
```

*代码取自 Jon Skeet对字节的[回答](http://bytes.com/groups/net-c/520177-string-format-timespan)*

对于 .NET 4.0 及更高版本，请参阅 DoctaJonez[答案](https://stackoverflow.com/questions/574881/how-can-i-string-format-a-timespan-object-with-a-custom-format-in-net/4386305#4386305)。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-22T13:00:34.530

一种方法是创建一个`DateTime`对象并将其用于格式化：

```
new DateTime(myTimeSpan.Ticks).ToString(myCustomFormat)

// or using String.Format:
String.Format("{0:HHmmss}", new DateTime(myTimeSpan.Ticks)) 
```

这是我知道的方式。我希望有人可以提出更好的方法。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-08-09T18:26:52.643

简单的。`TimeSpan.ToString`与 c、g 或 G 一起使用[。MSDN上的更多信息](http://msdn.microsoft.com/en-us/library/ee372286.aspx)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-06-29T14:00:04.787

我会去

```
myTimeSpan.ToString("hh\\:mm\\:ss"); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-11-18T20:14:58.637

```
Dim duration As New TimeSpan(1, 12, 23, 62)

DEBUG.WriteLine("Time of Travel: " + duration.ToString("dd\.hh\:mm\:ss")) 
```

它适用于框架 4

[http://msdn.microsoft.com/en-us/library/ee372287.aspx](http://msdn.microsoft.com/en-us/library/ee372287.aspx)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-11-22T19:27:56.957

就个人而言，我喜欢这种方法：

```
TimeSpan ts = ...;
string.Format("{0:%d}d {0:%h}h {0:%m}m {0:%s}s", ts); 
```

您可以根据自己的喜好进行自定义，没有任何问题：

```
string.Format("{0:%d}days {0:%h}hours {0:%m}min {0:%s}sec", ts);
string.Format("{0:%d}d {0:%h}h {0:%m}' {0:%s}''", ts); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-04-14T17:11:25.980

这是一个很棒的：

```
string.Format("{0:00}:{1:00}:{2:00}",
               (int)myTimeSpan.TotalHours,
               myTimeSpan.Minutes,
               myTimeSpan.Seconds); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-11-18T22:58:43.780

您还可以选择：

```
Dim ts As New TimeSpan(35, 21, 59, 59)  '(11, 22, 30, 30)    '
Dim TimeStr1 As String = String.Format("{0:c}", ts)
Dim TimeStr2 As String = New Date(ts.Ticks).ToString("dd.HH:mm:ss") 
```

编辑：

您还可以查看[Strings.Format](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.strings.format.aspx)。

```
 Dim ts As New TimeSpan(23, 30, 59)
    Dim str As String = Strings.Format(New DateTime(ts.Ticks), "H:mm:ss") 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-07-01T10:35:35.480

```
if (timeSpan.TotalDays < 1)
    return timeSpan.ToString(@"hh\:mm\:ss");

return timeSpan.TotalDays < 2
    ? timeSpan.ToString(@"d\ \d\a\y\ hh\:mm\:ss")
    : timeSpan.ToString(@"d\ \d\a\y\s\ hh\:mm\:ss"); 
```

所有文字字符都必须转义。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-12-24T11:17:42.833

这是我自己使用条件格式的方法。我把它贴在这里是因为我认为这是干净的方式。

```
$"{time.Days:#0:;;\\}{time.Hours:#0:;;\\}{time.Minutes:00:}{time.Seconds:00}" 
```

输出示例：

> `00:00`（最低限度）
> 
> `1:43:04`（当我们有时间时）
> 
> `15:03:01`（当小时数超过 1 位数时）
> 
> `2:4:22:04`（当我们有日子的时候。）

格式化很容易。`time.Days:#0:;;\\`之前的格式`;;`适用于值为正时。负值被忽略。对于零值，我们必须`;;\\`将其隐藏在格式化字符串中。请注意，转义的反斜杠是必需的，否则将无法正确格式化。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-07-19T07:20:32.610

这是我的[扩展方法](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods)：

```
public static string ToFormattedString(this TimeSpan ts)
{
    const string separator = ", ";

    if (ts.TotalMilliseconds < 1) { return "No time"; }

    return string.Join(separator, new string[]
    {
        ts.Days > 0 ? ts.Days + (ts.Days > 1 ? " days" : " day") : null,
        ts.Hours > 0 ? ts.Hours + (ts.Hours > 1 ? " hours" : " hour") : null,
        ts.Minutes > 0 ? ts.Minutes + (ts.Minutes > 1 ? " minutes" : " minute") : null,
        ts.Seconds > 0 ? ts.Seconds + (ts.Seconds > 1 ? " seconds" : " second") : null,
        ts.Milliseconds > 0 ? ts.Milliseconds + (ts.Milliseconds > 1 ? " milliseconds" : " millisecond") : null,
    }.Where(t => t != null));
} 
```

示例调用：

```
string time = new TimeSpan(3, 14, 15, 0, 65).ToFormattedString(); 
```

输出：

```
3 days, 14 hours, 15 minutes, 65 milliseconds 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-03-27T15:54:30.140

我使用了下面的代码。它很长，但它仍然是一个表达式，并且产生非常友好的输出，因为如果它们的值为零，它不会输出天、小时、分钟或秒。

在示例中，它产生输出：“4 天 1 小时 3 秒”。

```
TimeSpan sp = new TimeSpan(4,1,0,3);
string.Format("{0}{1}{2}{3}", 
        sp.Days > 0 ? ( sp.Days > 1 ? sp.ToString(@"d\ \d\a\y\s\ "): sp.ToString(@"d\ \d\a\y\ ")):string.Empty,
        sp.Hours > 0 ? (sp.Hours > 1 ? sp.ToString(@"h\ \h\o\u\r\s\ ") : sp.ToString(@"h\ \h\o\u\r\ ")):string.Empty,
        sp.Minutes > 0 ? (sp.Minutes > 1 ? sp.ToString(@"m\ \m\i\n\u\t\e\s\ ") :sp.ToString(@"m\ \m\i\n\u\t\e\ ")):string.Empty,
        sp.Seconds > 0 ? (sp.Seconds > 1 ? sp.ToString(@"s\ \s\e\c\o\n\d\s"): sp.ToString(@"s\ \s\e\c\o\n\d\s")):string.Empty); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-06-26T08:53:21.817

我使用这种方法。我是比利时人，说荷兰语，所以小时和分钟的复数不仅仅是在末尾添加“s”，而且几乎是一个与单数不同的词。

它可能看起来很长，但我认为它非常易读：

```
 public static string SpanToReadableTime(TimeSpan span)
    {
        string[] values = new string[4];  //4 slots: days, hours, minutes, seconds
        StringBuilder readableTime = new StringBuilder();

        if (span.Days > 0)
        {
            if (span.Days == 1)
                values[0] = span.Days.ToString() + " dag"; //day
            else
                values[0] = span.Days.ToString() + " dagen";  //days

            readableTime.Append(values[0]);
            readableTime.Append(", ");
        }
        else
            values[0] = String.Empty;

        if (span.Hours > 0)
        {
            if (span.Hours == 1)
                values[1] = span.Hours.ToString() + " uur";  //hour
            else
                values[1] = span.Hours.ToString() + " uren";  //hours

            readableTime.Append(values[1]);
            readableTime.Append(", ");

        }
        else
            values[1] = string.Empty;

        if (span.Minutes > 0)
        {
            if (span.Minutes == 1)
                values[2] = span.Minutes.ToString() + " minuut";  //minute
            else
                values[2] = span.Minutes.ToString() + " minuten";  //minutes

            readableTime.Append(values[2]);
            readableTime.Append(", ");
        }
        else
            values[2] = string.Empty;

        if (span.Seconds > 0)
        {
            if (span.Seconds == 1)
                values[3] = span.Seconds.ToString() + " seconde";  //second
            else
                values[3] = span.Seconds.ToString() + " seconden";  //seconds

            readableTime.Append(values[3]);
        }
        else
            values[3] = string.Empty;

        return readableTime.ToString();
    }//end SpanToReadableTime 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-02-20T00:31:50.927

这在 VS 2010 中很痛苦，这是我的解决方法。

```
 public string DurationString
        {
            get 
            {
                if (this.Duration.TotalHours < 24)
                    return new DateTime(this.Duration.Ticks).ToString("HH:mm");
                else //If duration is more than 24 hours
                {
                    double totalminutes = this.Duration.TotalMinutes;
                    double hours = totalminutes / 60;
                    double minutes = this.Duration.TotalMinutes - (Math.Floor(hours) * 60);
                    string result = string.Format("{0}:{1}", Math.Floor(hours).ToString("00"), Math.Floor(minutes).ToString("00"));
                    return result;
                }
            } 
        } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-01-23T15:54:09.757

`Substring`当您只需要小时：分钟：秒时，该方法非常有效。它是简单、干净的代码并且易于理解。

```
 var yourTimeSpan = DateTime.Now - DateTime.Now.AddMinutes(-2);

    var formatted = yourTimeSpan.ToString().Substring(0,8);// 00:00:00 

    Console.WriteLine(formatted); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-01-26T20:27:30.640

这是我的版本。它只显示必要的内容，处理复数形式，否定形式，并且我试图使其轻量级。

### 输出示例

```
0 seconds
1.404 seconds
1 hour, 14.4 seconds
14 hours, 57 minutes, 22.473 seconds
1 day, 14 hours, 57 minutes, 22.475 seconds 
```

### 代码

```
public static class TimeSpanExtensions
{
    public static string ToReadableString(this TimeSpan timeSpan)
    {
        int days = (int)(timeSpan.Ticks / TimeSpan.TicksPerDay);
        long subDayTicks = timeSpan.Ticks % TimeSpan.TicksPerDay;

        bool isNegative = false;
        if (timeSpan.Ticks < 0L)
        {
            isNegative = true;
            days = -days;
            subDayTicks = -subDayTicks;
        }

        int hours = (int)((subDayTicks / TimeSpan.TicksPerHour) % 24L);
        int minutes = (int)((subDayTicks / TimeSpan.TicksPerMinute) % 60L);
        int seconds = (int)((subDayTicks / TimeSpan.TicksPerSecond) % 60L);
        int subSecondTicks = (int)(subDayTicks % TimeSpan.TicksPerSecond);
        double fractionalSeconds = (double)subSecondTicks / TimeSpan.TicksPerSecond;

        var parts = new List<string>(4);

        if (days > 0)
            parts.Add(string.Format("{0} day{1}", days, days == 1 ? null : "s"));
        if (hours > 0)
            parts.Add(string.Format("{0} hour{1}", hours, hours == 1 ? null : "s"));
        if (minutes > 0)
            parts.Add(string.Format("{0} minute{1}", minutes, minutes == 1 ? null : "s"));
        if (fractionalSeconds.Equals(0D))
        {
            switch (seconds)
            {
                case 0:
                    // Only write "0 seconds" if we haven't written anything at all.
                    if (parts.Count == 0)
                        parts.Add("0 seconds");
                    break;

                case 1:
                    parts.Add("1 second");
                    break;

                default:
                    parts.Add(seconds + " seconds");
                    break;
            }
        }
        else
        {
            parts.Add(string.Format("{0}{1:.###} seconds", seconds, fractionalSeconds));
        }

        string resultString = string.Join(", ", parts);
        return isNegative ? "(negative) " + resultString : resultString;
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-05-15T06:49:09.567

如果你想要类似于 youtube 的持续时间格式，给定秒数

```
int[] duration = { 0, 4, 40, 59, 60, 61, 400, 4000, 40000, 400000 };
foreach (int d in duration)
{
    Console.WriteLine("{0, 6} -> {1, 10}", d, d > 59 ? TimeSpan.FromSeconds(d).ToString().TrimStart("00:".ToCharArray()) : string.Format("0:{0:00}", d));
} 
```

输出：

```
 0 ->       0:00
     4 ->       0:04
    40 ->       0:40
    59 ->       0:59
    60 ->       1:00
    61 ->       1:01
   400 ->       6:40
  4000 ->    1:06:40
 40000 ->   11:06:40
400000 -> 4.15:06:40 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-06-16T07:45:29.797

我想返回一个字符串，例如“1 天 2 小时 3 分钟”，并考虑例如天数或分钟数是否为 0，然后不显示它们。感谢[John Rasch](https://stackoverflow.com/a/840177/5788969)的回答，我的回答几乎不是

```
TimeSpan timeLeft = New Timespan(0, 70, 0);
String.Format("{0}{1}{2}{3}{4}{5}",
    Math.Floor(timeLeft.TotalDays) == 0 ? "" : 
    Math.Floor(timeLeft.TotalDays).ToString() + " ",
    Math.Floor(timeLeft.TotalDays) == 0 ? "" : Math.Floor(timeLeft.TotalDays) == 1 ? "day " : "days ",
    timeLeft.Hours == 0 ? "" : timeLeft.Hours.ToString() + " ",
    timeLeft.Hours == 0 ? "" : timeLeft.Hours == 1 ? "hour " : "hours ",
    timeLeft.Minutes == 0 ? "" : timeLeft.Minutes.ToString() + " ",
    timeLeft.Minutes == 0 ? "" : timeLeft.Minutes == 1 ? "minute " : "minutes "); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-06-01T14:14:43.560

没有人展示过使用十进制格式说明符的方法，这是我最喜欢的一种，尤其是在与字符串插值一起使用时 - [https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-numeric-format-字符串？redirectedfrom=MSDN#decimal-format-specifier-d](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-numeric-format-strings?redirectedfrom=MSDN#decimal-format-specifier-d)

例如：

```
$"{time.Hours:D2}:{time.Minutes:D2}:{time.Seconds:D2}.{time.Milliseconds:D3}"
// Sample output: 00:00:09.200 
```

你当然可以用一些辅助方法来包装它。

# javascript - 在 IE6 上看到奇怪的行为 - 我一无所知

> ID：574885
> 
> 赞同：2
> 
> 时间：2009-02-22T13:00:34.843
> 
> 标签：javascript, internet-explorer-6

我使用以下内容将脚本植入随机网站：（由网站管理员在 /body 之前添加）

```
<script type="text/javascript">
var xHost = (("https:" == document.location.protocol) ? "https://" : "http://");
document.write(unescape("%3Cscript src='" + xHost + "domain/script.js.php?u="+encodeURIComponent(window.location.host)+"' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

它是谷歌分析工作方式的延伸。我将它安装在特定网站上，其中上面的 html 格式不完美。

它适用于除 IE6 之外的所有浏览器。在 IE6 上，脚本永远不会运行。**除非我运行 fiddler2 在这种情况下它运行完美**。

问：我怎样才能让它在IE6上运行。知道为什么当提琴手挡路时它表现良好而提琴手不在时表现不佳吗？

注意：我无法控制已经集成此代码的网站。当我将网站页面代码复制到我的服务器并从那里运行它时，它运行正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T16:04:16.447

啊，我看到你在这里使用https。当 fiddler 在运行 https 时进入您的代码中间时，fiddler 使用其 OWN 证书与您的浏览器对话。也许您的 IE6 副本信任 Fiddler 的证书，但由于某种原因不信任您引用的站点的证书？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T16:06:58.827

事实证明，一个名为activationmanager.dll 的插件导致了这个问题。它是一个间谍软件。（IE6 在我 5.5 岁的男孩电脑上）。谢谢您的帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T14:05:33.220

您是否尝试过将脚本标签放在文档末尾，就在完成正文元素之前？通常那是你放谷歌分析代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T14:24:50.243

你怎么知道它没有运行？坚持一个简单的

```
alert('hello!'); 
```

在脚本标签中运行？

其他 js 代码的上方/下方呢？

有问题的页面上的 html 有什么“无效”？

# web-services - 一切都通过公共汽车吗？

> ID：574892
> 
> 赞同：2
> 
> 时间：2009-02-22T13:05:55.580
> 
> 标签：web-services, biztalk, soa, esb, architecture

我们已将 BizTalk 作为服务总线引入我们的组织，它将新的 Web GUI 链接到许多现有的后端系统。我们已将现有系统包装为服务 (WCF)，并将它们连接到 BUS。

我们还用我们的新 Web GUI 替换了一些遗留系统 GUI（确保我们复制现有功能），但我很好奇我们是否应该通过 BUS 公开所有遗留服务/api，直接连接到它们或以不同方式组合它们并且通过总线暴露它们。例如，假设我们的客户管理系统有 5 个现有服务/api，搜索、添加、检索、更新、设置帐单详细信息。

通过 BUS 公开这些服务是否有意义（有人认为它会增加延迟）？或者 BUS 是否应该只公开粗粒度的服务，例如搜索、添加、检索和更新，而不是细粒度的服务？GUI 是否应该直接连接到细粒度服务？

我的印象是，在理想的 SOA/ESB 中，您会将更新和设置计费详细信息组合到一个粗粒度服务中，这是正确的吗？

我想忠于 SOA/ESB 范式，请有人赐教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T13:17:28.767

ESB 最适用于构建“复合”应用程序。

首先，您必须从大量离散应用程序中公开大量细粒度服务。

这为构建复合应用程序奠定了基础。

*重点是创建任何单个*应用程序中都不存在的复合服务。这些服务仅存在于 ESB 中。它们是由细粒度的服务构建的。

请注意，组合依赖于细粒度服务，这两者都存在于 ESB 中，从而减少了定位和执行细粒度服务所涉及的开销。但是，真正的工作是由外部应用程序完成的，这会带来一些开销。

请注意，基于 ESB 的应用程序的性能完全击败了其他交互方法，以至于让您对“延迟”束手无策，从而错过了直接、直接集成的巨大胜利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T14:20:54.393

通常情况下，有不同的方法来看待这个问题——如果你只是从总线的角度来看（我不完全赞成）——那么将 BizTalk 用于非聚合/复合服务几乎没有价值（并且，正如您所提到的）您正在增加延迟等。当然，即使在这种情况下，人们也可以争论 BizTalk 为您提供的所有服务，例如监控、管理、可伸缩性等，但很难判断这些服务有多少在不了解完整情况的情况下是相关的。

但是，BizTalk 也是（并且有些人会争辩 - 主要是）一个集成引擎，并且经常用于将消费者从服务实现中屏蔽掉。

这是一个可能的场景（同样，不知道这是否以及在多大程度上适用于您的案例） - 您有一个遗留应用程序，您将其包装在服务中以启用 SOA。从现在起 18 个月后，您完成了替换服务的实施，但它具有不同的界面（因为它具有更多功能） - 如果您在中间有 BizTalk，那么您有一个层，您可以将调用者提供的旧格式潜在地映射到服务要求的新格式，反之亦然。这意味着您不必更改所有客户端应用程序（无论如何一次）。

所以 - 答案是，我猜 - 这取决于。

# javascript - JavaScript 中的块方案

> ID：574898
> 
> 赞同：0
> 
> 时间：2009-02-22T13:08:59.753
> 
> 标签：javascript, algorithm, components, visualization

我需要`algorithms`用 JavaScript 创建的可视化工具。与 BlockSchemes 类似，主要使用 If 和 Statement 块。可以移动，调整大小，用箭头连接。有人知道这样的开源项目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T11:58:42.557

我正在使用来自[Google Visualization API](http://code.google.com/intl/cs-CZ/apis/visualization/documentation/gallery.html)的 Org Chart - 它是一个 JavaScript 库，可以绘制树状图。它可以用于大量数据，我经常将它用于 if 语句树之类的结构。

不幸的是，结果是静态的，不能移动或调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T13:12:42.443

如果您指的是使用 JavaScript 绘图，我唯一能想到的两件事是 HTML Canvas 标记，它是 HTML 5 或具有图像处理程序和使用 CSS 定位，它不是使用 JavaScript 绘图，而是简单地定位以通过使用 AJAX

# mysql - 运行./mysqldump时如何保留特殊字符？

> ID：574900
> 
> 赞同：1
> 
> 时间：2009-02-22T13:11:44.863
> 
> 标签：mysql, character-encoding

运行 mysqldump 时如何保留特殊字符？

当我进行查询时，它在数据库上正确显示。但在我导出后的文件上，所有特殊字符如下所示：

```
'R. Ant√≥nio  Lt1, 1¬∫ Dt¬∫' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T13:14:51.127

通过在编辑器中设置或（更好地）强制转储您喜欢的字符集（例如 UTF8）来使用正确的字符集（这也有助于避免跨服务器移动数据库转储的所有这些问题）。

`mysqldump --default-character-set=UTF8`

# javascript - 使用 JavaScript 获取下一个/上一个元素？

> ID：574904
> 
> 赞同：133
> 
> 时间：2009-02-22T13:14:02.517
> 
> 标签：javascript, html, dom

如何使用 JavaScript 获取 HTML 中的下一个元素？

假设我有 3 个`<div>`s 并且我在 JavaScript 代码中得到一个引用，我想知道哪个是下一个`<div>`，哪个是前一个。

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2009-02-22T13:24:04.070

使用[`nextSibling`](https://developer.mozilla.org/en-US/docs/Web/API/Node/nextSibling)和[`previousSibling`](https://developer.mozilla.org/en-US/docs/Web/API/Node/previousSibling)属性：

```
<div id="foo1"></div>
<div id="foo2"></div>
<div id="foo3"></div>

document.getElementById('foo2').nextSibling; // #foo3
document.getElementById('foo2').previousSibling; // #foo1 
```

但是在某些浏览器中（我忘记了），您还需要检查空格和注释节点：

```
var div = document.getElementById('foo2');
var nextSibling = div.nextSibling;
while(nextSibling && nextSibling.nodeType != 1) {
    nextSibling = nextSibling.nextSibling
} 
```

像 jQuery 这样的库开箱即用地为您处理所有这些跨浏览器检查。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-22T13:19:32.723

好吧，在纯 javascript 中，我的想法是您首先必须将它们整理到一个集合中。

```
var divs = document.getElementsByTagName("div");
//divs now contain each and every div element on the page
var selectionDiv = document.getElementById("MySecondDiv"); 
```

所以基本上用 selectionDiv 遍历集合以找到它的索引，然后显然 -1 = previous +1 = next in bounds

```
for(var i = 0; i < divs.length;i++)
{
   if(divs[i] == selectionDiv)
   {
     var previous = divs[i - 1];
     var next = divs[i + 1];
   }
} 
```

请注意，正如我所说，需要额外的逻辑来检查您是否在范围内，即您不在集合的末尾或开头。

这也意味着说你有一个嵌套了一个子 div 的 div。下一个 div 不是兄弟姐妹而是孩子，因此，如果您只想要与目标 div 处于同一级别的兄弟姐妹，那么一定要使用 nextSibling 检查**tagName**属性。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-22T13:20:52.657

确实取决于文档的整体结构。

如果你有：

```
<div></div>
<div></div>
<div></div> 
```

它可能就像遍历 using 一样简单

```
mydiv.nextSibling;
mydiv.previousSibling; 
```

但是，如果“下一个”div 可能位于文档中的任何位置，您将需要更复杂的解决方案。你可以尝试使用

```
document.getElementsByTagName("div"); 
```

并通过这些以某种方式到达您想要的地方。

如果您正在执行大量复杂的 DOM 遍历，我建议您查看 jQuery 等库。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-01-11T18:28:37.770

每个 HTMLElement 都有一个属性“previousElementSibling”。

前任：

```
<div id="a">A</div>
<div id="b">B</div>
<div id="c">c</div>

<div id="result">Resultado: </div> 
```

* * *

```
var b = document.getElementById("c").previousElementSibling;

document.getElementById("result").innerHTML += b.innerHTML; 
```

直播：http: [//jsfiddle.net/QukKM/](http://jsfiddle.net/QukKM/)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-01-03T06:57:48.383

这很容易......它是一个纯javascript代码

```
 <script>
           alert(document.getElementById("someElement").previousElementSibling.innerHTML);
    </script> 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2021-02-10T12:40:59.010

它很简单。试试这个：

```
let myReferenceDiv = document.getElementById('mydiv');
let prev = myReferenceDiv.previousElementSibling;
let next = myReferenceDiv.nextElementSibling; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-01-31T17:18:11.583

所有这些解决方案看起来都是矫枉过正。为什么使用我的解决方案？

`previousElementSibling`从 IE9 开始支持

`document.addEventListener`需要一个 polyfill

`previousSibling`可能会返回文本

请注意，如果边界被破坏，我选择返回第一个/最后一个元素。在 RL 使用中，我希望它返回一个空值。

```
var el = document.getElementById("child1"),
    children = el.parentNode.children,
    len = children.length,
    ind = [].indexOf.call(children, el),
    nextEl = children[ind === len ? len : ind + 1],
    prevEl = children[ind === 0 ? 0 : ind - 1];

    document.write(nextEl.id);
    document.write("<br/>");
    document.write(prevEl.id);
```

```
<div id="parent">
  <div id="child1"></div>
  <div id="child2"></div>
</div>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-16T08:39:24.377

测试了它，它对我有用。找到我的元素会根据您拥有的文档结构而变化。

```
<html>
    <head>
        <script type="text/javascript" src="test.js"></script>
    </head>
    <body>
        <form method="post" id = "formId" action="action.php" onsubmit="return false;">
            <table>
                <tr>
                    <td>
                        <label class="standard_text">E-mail</label>
                    </td>
                    <td><input class="textarea"  name="mail" id="mail" placeholder="E-mail"></label></td>
                    <td><input class="textarea"  name="name" id="name" placeholder="E-mail">   </label></td>
                    <td><input class="textarea"  name="myname" id="myname" placeholder="E-mail"></label></td>
                    <td><div class="check_icon icon_yes" style="display:none" id="mail_ok_icon"></div></td>
                    <td><div class="check_icon icon_no" style="display:none" id="mail_no_icon"></div></label></td>
                    <td><div class="check_message" style="display:none" id="mail_message"><label class="important_text">The email format is not correct!</label></div></td>
                </tr>
            </table>
            <input class="button_submit" type="submit" name="send_form" value="Register"/>
        </form>
    </body>
</html> 
```

```
var inputs;
document.addEventListener("DOMContentLoaded", function(event) {
    var form = document.getElementById('formId');
    inputs = form.getElementsByTagName("input");
    for(var i = 0 ; i < inputs.length;i++) {
        inputs[i].addEventListener('keydown', function(e){
            if(e.keyCode == 13) {
                var currentIndex = findElement(e.target)
                if(currentIndex > -1 && currentIndex < inputs.length) {
                    inputs[currentIndex+1].focus();
                }
            }   
        });
    }
});

function findElement(element) {
    var index = -1;
    for(var i = 0; i < inputs.length; i++) {
        if(inputs[i] == element) {
            return i;
        }
    }
    return index;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-02T13:29:34.163

您可以使用**nextElementSibling**或**previousElementSibling**属性

```
<div>
    <span id="elem-1">
        span
    </span>
</div>
<div data-id="15">
    Parent Sibling
</div>

const sp = document.querySelector('#elem-1');
let sibling_data_id = sp.parentNode.nextElementSibling.dataset.id;
console.log(sibling_data_id); // 15 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-09-13T10:23:51.657

就是这么简单

```
var element = querySelector("div")
var nextelement = element.ParentElement.querySelector("div+div") 
```

这里是浏览器支持[https://caniuse.com/queryselector](https://caniuse.com/queryselector)

# winapi - 如何正确设置 OpenGL 场景以可视化单个对象

> ID：574908
> 
> 赞同：2
> 
> 时间：2009-02-22T13:16:00.923
> 
> 标签：winapi, opengl, wgl

我需要为我的网格工具包编写一个简单的可视化工具。我正在使用的对象始终位于 [-1,1]^3 框（包括）内，因此我需要确保该对象对用户完全可见。我还希望有可能围绕对象旋转相机，就像用户在对象周围“飞行”一样。

这就是我这样做的方式：

```
static void Reshape(int w, int h)
{
    glViewport(0,0,(GLsizei) w, (GLsizei) h);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    float maxDistance = sqrt(2);
    if (w <= h)
    {
        glOrtho(-maxDistance, maxDistance, -maxDistance * (GLfloat)h / (GLfloat)w,
            maxDistance * (GLfloat)h / (GLfloat)w, -6.0, 6.0);
    }
    else
    {
        glOrtho(-maxDistance * (GLfloat)w / (GLfloat)h, maxDistance * (GLfloat)w / (GLfloat)h,
            -maxDistance, maxDistance, -6.0, 6.0);
    }
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

static void PolarView(GLdouble distance, GLdouble twist, GLdouble elevation)
{
    double centerx, centery, centerz;
    double eyex, eyey, eyez;

    eyex = distance * cos(-twist) * cos(elevation);
    eyey = distance * sin(-twist) * cos(elevation);
    eyez = distance * sin(elevation);
    centerx = centery = centerz = 0;

    gluLookAt(eyex, eyey, eyez, centerx, centery, centerz, 0, 0, 1);
} 
```

在初始设置期间调用 Reshape 函数，并且在每次调整可视化控件的大小后，在每次重绘时调用 PolarView 函数，其中某些角度和距离大于 3 的平方根（真的很重要吗？）。该代码适用于立方体或球体等凸面对象，但圆环对象存在一些问题（有些面是通过其他人看到的），所以我相信这是关于深度测试的东西。我的设置有什么问题？截图： 我在互联网上进行了一些搜索，发现如果我的近平面和远平面参数有问题，就会出现这样的问题。在我的情况下，这些的正确值是什么？我的绘图过程如下：
[![坏环面](https://i.stack.imgur.com/atr2X.jpg)](https://i.stack.imgur.com/atr2X.jpg)
[![坏环面填充](https://i.stack.imgur.com/rvc6L.jpg)](https://i.stack.imgur.com/rvc6L.jpg)

```
glEnable(GL_DEPTH_TEST);
glClearDepth(1);
glPolygonMode(GL_FRONT, GL_LINE); // Changing of GL_LINE to GL_FILL doesn't fixing my problem, it just changing the appearance of the model.
glClearColor(BackColor.R / 255.0f, BackColor.G / 255.0f, BackColor.B / 255.0f, 1);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glLoadIdentity();
PolarView(sqrt(3), _phi, _theta);
// .. only draws 
```

我的像素格式描述符：

```
 PIXELFORMATDESCRIPTOR pfd =
    {
        sizeof(PIXELFORMATDESCRIPTOR),
        1,
        PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER,
        PFD_TYPE_RGBA,
        24,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        32, // Depth buffer size
        0,
        0,
        PFD_MAIN_PLANE,
        0,
        0,
        0,
        0
    }; 
```

* * *

我找到了一些解决此问题的方法：

*   为我的近平面和远平面交换值
*   设置`glDepthFunc`为`GL_GREATER`和`glClearDepth`确定`0`
    ，如果有偶数个错误，我的代码将正常工作。但是第一个错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T15:58:23.573

你读过[OpenGL 常见问题 12](http://www.opengl.org/resources/faq/technical/depthbuffer.htm)吗？

您的代码看起来可疑的一件事是负面的近平面。负 Z 值位于相机后面，这通常是渲染 3D 场景时的错误。但是，这本身不应该导致您看到的问题，并且 Z 的范围 [-6,6] 应该为这种场景提供足够的精度。

你在打电话`glEnable(GL_DEPTH_TEST)`吗？你是否传递`GL_DEPTH_BUFFER_BIT`到`glClear`每一帧？

更新：你打电话给`glPolygonMode(GL_FRONT, GL_LINE)`. 这意味着正面三角形仅绘制轮廓，这意味着如果正面三角形 A 与另一个正面三角形 B 重叠，您可以通过 A 看到 B 的边缘。对于凸体，这不会发生，所以你不会注意到这个问题。

如果你想让三角形遮挡它们后面的三角形，那么你需要使用 mode 填充它们`GL_FILL`。为了得到一个线框图形，你需要用白色填充绘制模型，然后用黑色轮廓再次绘制模型，如下所示：

```
glDepthFunc(GL_LEQUAL);
glPolygonMode(GL_FRONT, GL_FILL);
/* 用白色绘制模型 */
glDepthFunc(GL_EQUAL);
glPolygonMode(GL_FRONT, GL_LINE);
/* 再次用黑色绘制模型 */

```

这个想法是，在模型的第二次遍历中，我们只想绘制未被第一次遍历中更靠近相机（即 Z 值较低）绘制的某个三角形遮挡的轮廓。

另一个想法：我认为你的相机可能指向错误的方向。这可以解释为什么使用 glOrtho 透视图会错误地绘制场景，而不是使用 glFrustum 透视图。在 glOrtho 案例中，整个场景都*在摄像机后面*绘制；这就是为什么它以错误的方式用 Z 顺序绘制。当您将近平面设置为正数时，整个场景都会被剔除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T10:41:39.053

*“8.070 如何自动计算显示整个模型的视图？（我知道边界球和向上向量。）”* [OpenGL FAQ 8](http://www.opengl.org/resources/faq/technical/viewing.htm)中的条目回答了我的问题。但是，我的设置略有不同，这是我重写的 PolarView 和 Reshape 函数：

```
static void Reshape(int w, int h)
{
    float diameter = sqrt(3);
    glViewport(0, 0, (GLsizei)w, (GLsizei)h);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    GLdouble zNear = 1;
    GLdouble zFar = zNear + diameter * 2;
    GLdouble left = -diameter;
    GLdouble right = diameter;
    GLdouble top = -diameter;
    GLdouble bottom = diameter;
    double aspect = (double)w / (double)h;
    if (aspect < 1)
    {
        bottom /= aspect;
        top /= aspect;
    }
    else
    {
        left *= aspect;
        right *= aspect;
    }
    glOrtho(left, right, bottom, top, zNear, zFar);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

static void PolarView(GLdouble twist, GLdouble elevation)
{
    float diameter = sqrt(3);
    double distance = diameter * 2;
    double centerx, centery, centerz;
    double eyex, eyey, eyez;

    eyex = distance * cos(twist) * cos(elevation);
    eyey = distance * sin(twist) * cos(elevation);
    eyez = distance * sin(elevation);
    centerx = centery = centerz = 0;
    gluLookAt(eyex, eyey, eyez, centerx, centery, centerz, 0, 0, 1);
} 
```

# visual-c++ - Windows 和控制台应用程序之间的区别

> ID：574911
> 
> 赞同：56
> 
> 时间：2009-02-22T13:17:35.973
> 
> 标签：visual-c++

Windows 和控制台应用程序之间有什么区别？

在 Visual C++ 中创建新项目时，它会要求选择上述任何一种。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-22T13:21:34.327

唯一的区别是，如果控制台应用程序不是从一个控制台启动（或者控制台在启动时被主动抑制），它总是会生成一个控制台。另一方面，Windows 应用程序不会产生控制台。它仍然*可以*连接到现有控制台或使用`AllocConsole`.

这使得 Windows 应用程序更适合 GUI 应用程序或后台应用程序，因为您通常不希望为这些应用程序创建终端窗口。

在更技术性的说明中，控制台和 Windows 可执行文件之间的唯一区别是文件的 PE 标头中的*一个字节*`exe`。手动切换此字节（例如使用十六进制编辑器）转换应用程序类型。这是一个广为人知的 hack，用于在 VB6 中创建控制台应用程序（没有明确支持这种类型的应用程序）。

要确定和更改应用程序的子系统类型，您需要读取部分 PE 标头。子系统数据的地址不是固定的，因为它是可选文件头的一部分，其位置由存储在 DOS 文件头（在成员中`e_lfanew`）中的地址确定。该地址实际上指向`_IMAGE_NT_HEADERS`记录，该记录又包含`IMAGE_OPTIONAL_HEADER32`结构。这有一个名为`int16`^(1))`Subsystem`的成员。Windows 应用程序的成员值为 2，控制台应用程序的成员值为 3。存在其他子系统（特别是 POSIX 和内核）。我编写了一个小型 VB6 应用程序来更改应用程序的子系统，可以从[ActiveVB](http://www.activevb.de/cgi-bin/upload/download.pl?id=2436)作为源代码下载。

PE 格式没有很好的文档记录，但本文档可以作为介绍：[PE 内部的 Peering: A Tour of the Win32 Portable Executable File Format](http://msdn.microsoft.com/en-us/magazine/ms809762.aspx)。

* * *

^(1))这并不真正与我声称只有一个字节不同的说法相矛盾：该成员的最高有效字节始终为 0。只有最低有效字节发生变化。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-22T13:34:22.797

除了 Konrad 提到的差异之外，控制台和 Windows 应用程序在从命令提示符交互调用时表现不同：

当您启动控制台应用程序时，命令提示符在控制台应用程序退出之前不会返回。当您启动 Windows 应用程序时，该命令会立即返回。

这不适用于批处理文件；他们将一直等到应用程序退出。（您始终可以使用该`start`命令启动应用程序而无需等待。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-22T14:26:44.857

不同之处在于应用程序被剔除的方式。当您使用控制台模板时，您有一个将在控制台中启动的存根。如果您已经在控制台中运行，它会忽略启动控制台的调用。

出于同样的原因，Windows 应用程序设计有默认表单。如果你想清除它，你可以创建一个无窗体的 Windows 窗体应用程序，它本质上是一个没有控制台窗口的控制台应用程序。

就应用程序的内容而言，它们本质上是相同的。主要区别是在编译阶段添加的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-05T11:20:55.360

消息循环也是区别之一：

[http://en.wikipedia.org/wiki/Message_loop_in_Microsoft_Windows](http://en.wikipedia.org/wiki/Message_loop_in_Microsoft_Windows)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-08T12:09:52.200

您可以使用 EDITBIN.exe 更改子系统（ EDITBIN.exe[上的 MSDN 条目](https://docs.microsoft.com/en-us/cpp/build/reference/editbin-options)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-06-04T13:27:21.197

如果您默认选择退出 Unicode ，则控制台应用程序的入口点是`wmain`（自 Visual Studio 2008 IIRC 起） 。`main`对于台式机，它是`wWinMain`/ `WinMain`。

这并不是说这些技术是相互排斥的。控制台应用程序仍然可以使用整个 Win32 API，桌面应用程序可以使用控制台 I/O（但它们必须首先显式创建一个控制台窗口）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-22T13:20:08.713

控制台应用程序从 Windows 命令行运行（开始/运行/cmd）

Window 应用程序是预设的，因此您可以对在 Windows 环境中运行的 GUI 应用程序进行编程。

# apache-flex - Flex 应用扩展 Sprite 不使用整个浏览器宽度 (Flash/Flex)

> ID：574912
> 
> 赞同：1
> 
> 时间：2009-02-22T13:19:15.733
> 
> 标签：apache-flex, flash, firefox

我在 FlexBuilder 中完成了一个简单的 HelloWorld 应用程序。它只是一个扩展 Sprite 的简单类。在专用的 Flash 播放器中，SWF 会占据整个屏幕。然而，在 Firefox 中，无论是在 HTML 中还是单独在 Firefox 中，它都会显示在右侧。**有简单的治疗方法吗？**

代码只是一个构造函数（其中 stage.stageWidth 和 stageHeight 被正确读取，奇怪），它将 TextField 添加到 Sprite 并将大小设置为 stage.stageWidth 和 stage.stageHeight。

**编辑：**无济于事我已经尝试将构造函数的内容移动到`Event.ADDED_TO_STAGE`事件处理中，但我认为整个调查线已经死了。

**编辑：**现在我知道 Theo 的答案是正确的，我找到[了这个链接](http://hubflanger.com/stage-resize-and-the-stagewidth-and-stageheight-properties/)。好的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T13:34:45.823

**HTML Flash 嵌入**

首先确保你的嵌入标签没问题（宽度和高度设置为 100%，CSS 等）。这应该不是问题，但正如您所说，仅显示在浏览器中的 swf 也会出现错误。

**对齐**

检查您是否已在构造函数中将舞台对齐设置为左上角：

```
stage.align = StageAlign.TOP_LEFT; 
```

**缩放**

通常，如果您让 Flash 扩展您的整个应用程序，它可能看起来很难看（字体太大等）。最好的用途是将舞台缩放设置为“无缩放”并收听舞台 RESIZE 事件，以便缩放和定位需要它的对象。

```
stage.scaleMode = StageScaleMode.NO_SCALE;
stage.addEventListener(Event.RESIZE, stageResizeHandler);
stageResizeHandler(); 
```

和类似的东西（伪代码）：

```
private function stageResizeHandler(event:Event=null):void
{
    backgroundShape.width = stage.stageWidth;
    backgroundShape.height = stage.stageHeight;

    footer.y = stage.stageHeight - footer.height;

} 
```

# javascript - 我想扫描2个数据，看看它是否有相关性

> ID：574913
> 
> 赞同：0
> 
> 时间：2009-02-22T13:19:26.797
> 
> 标签：javascript

所以我想扫描2个Datum，这些是文本，然后如果它具有相关性，我会对其进行评分。

例子：

```
Data: individual facts
Data: statistics, items of information individual facts 
```

这是我的 JS 代码，它将扫描整个网页：

```
var listitem, thislist;
var itemname = new Array();
listitem = getElementsByClass('Forwards');
for(var i = 0; i < listitem.length; i++) {  
  if (listitem[i].innerHTML.match(/Data:/)) itemname.push(listitem[i].innerHTML);
} 
```

所以 itemname 数组包含文本。第一个数组包含：

```
Data: individual facts 
```

第二个数组包含：

```
Data: statistics, items of information individual facts 
```

如您所见，第二个数组包含更多信息：

```
Data: statistics, items of information 
```

但它们是相关的，对吧？

所以我想回来`TRUE`

我将如何编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T03:28:31.763

I'm assuming that your data conforms to "Data: [data Element], [data Element]..." -- after the initial colon individual elements are separated by a comma.

So, what you want to do is extract the data (everything after the colon) and break it down into individuals (everything between commas)

```
 function ProcessDatum(datum){
    var str = datum.toString();
    var dataPieces = str.substr(str.indexOf(':')).split(',');
    return dataPieces;
}

    function CompareData(first, second){
    // Do your usual array compare stuff, I don't know what would be best for you
    // What you want to do is to check if any element of second appears in first
} 
```

ProcessDatum() will give you an array of the individual data from your original "Data: first, second, third". CompareData() on two datasets to process.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T10:26:23.677

让我们简化一下，我只想要一个可以扫描字符串的脚本。然后，如果它找到 2 个匹配项，它将返回 true。

例如，如果字符串 1 = “Blue big doll”，则字符串 2 = “Blue doll”。两者的字符串中都有“BLUE”和“doll”，所以它会返回true。如果 string 2 = "BLUE" 它将返回 false，因为条件是 2 个匹配项。

# string - 需要格式良好的数据进行测试

> ID：574920
> 
> 赞同：1
> 
> 时间：2009-02-22T13:22:02.407
> 
> 标签：string, csv, testing, url-encoding, sample-data

有时您需要用于测试的数据，例如[Adob​​e Thermo](http://www.youtube.com/watch?v=d9IjZJ0D_bo)已经预先编写了数据“集”，例如 1 字字符串、3 字字符串等，用于填充数据控件。

我需要：

*   连续文本，没有换行符
*   CSV 数字、整数
*   CSV 数字、小数
*   URL 编码字符串

关于如何获得其中任何一个的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-01T17:45:54.537

[GenerateData.com](http://www.generatedata.com/#about)是用 JavaScript、PHP 和 MySQL 编写的免费开源脚本，可让您快速生成各种格式的大量自定义数据，用于测试软件和填充数据库。

*   支持 JS 且对浏览器友好。
*   许多数据类型：姓名、电话号码、电子邮件地址、城市、州、省、县、日期、街道地址、数字范围、字母数字字符串、lorem ipsum 文本等等。
*   可选择以 XML、Excel、HTML、CSV 或 SQL 格式生成数据。
*   加拿大、美国、荷兰和英国的国家特定数据（州/省/县）。
*   保存您的数据生成表格供以后使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T13:26:03.143

生成它们？一个快速的 perl 脚本可以生成大量数据。

CSV 的部分挑战在于所有边缘情况（换行符的标准使用尴尬，这与 Excel 或 SQL Server 解析 CSV 的方式不完全匹配）。过去我不得不手工建造这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T13:26:23.970

> 连续文本，没有换行符

[从Project Gutenberg](http://www.gutenberg.org/)下载一些文件并在其上运行 sed 以用空格替换换行符。

> CSV 数字、整数

谷歌/Y！Finance AFAIK 允许您下载历史股票报价。那将是一个不错的开始。但它们通常是字符串（股票名称）、日期和 4 个不同的浮点值和一个整数体积值的混合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T14:07:04.573

我只是（在 VB.NET 中）制作了一个帮助类来生成指定范围内长度的随机字符串或随机数。我第一次尝试在 Visual Studio 中进行单元测试时就这样做了。因此，例如，当我想测试 Customer.Create 时，我会设置一个循环运行 1000 次，以创建 1000 个具有各种随机值的客户。例如，

（伪真实代码）

```
For x = 1 to 1000
    Dim c as New Customer
    c.Name = Helpers.GetRandomString([minLenth], [maxLength])
    c.Address1 = Helpers.GetRandomString([minLenth], [maxLength])
    c.Telephone = Helpers.GetRandomPhoneNumber()
    ...
Next 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-29T03:32:00.440

试试[www.mockaroo.com](http://www.mockaroo.com)。

这是一个免费工具，可让您生成多达 100,000 行 CSV、制表符分隔和 SQL 格式的真实测试数据。您可以生成几乎任何数据类型：字符串、数字、电子邮件、域、url、地址、名称、unicode、基于您提供的公式的自定义值等等。您还可以保存模式以供重复使用。

# c# - OCR：如何比较图像、排序不匹配并快速完成？

> ID：574923
> 
> 赞同：1
> 
> 时间：2009-02-22T13:24:26.737
> 
> 标签：c#, arrays, compare, ocr

我设法将每个字符存储在位图中，并正在寻找一种方法来快速确定它是哪个字符。

因此，我将把每个可能的字符存储到一个 1 和 0 的数组中，并将它们与我刚刚抓取的位图数组进行比较。

我可以做一些简单的检查，比如比较我得到了多少黑色像素，比较尺寸等等，但是所有这些检查都很慢（只是猜测..）。

所以我正在寻找的是一种方法，它从下到上遍历每个像素，或者随机将数组与一组数组进行比较并排序不匹配，直到只剩下一个数组。但是我该如何实现呢？

谢谢你的帮助。

斯文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T13:48:17.083

在 OCR 世界中，您很少会在目标资源和原始比较资源之间遇到“完美匹配”。

实际上这是一个巨大的科学领域，但这里有一篇关于这个主题的不错的论文，应该会给你一些基本知识： [http ://www.discover.uottawa.ca/~qchen/my_papers/master_thesis.pdf](http://www.discover.uottawa.ca/~qchen/my_papers/master_thesis.pdf)

请注意，此类算法的数学运算量很大，并且现在针对标准 x86 CPU 进行了优化。

如果您正在寻找一个完美匹配（我的意思是，非常完美，精确到字节到字节）并且您想快速轻松地实现这一点，我建议您做一个“快速跳过明显的不匹配” - 有点算法 -就像是：

1）比较数组的大小，如果不同，这不是你要找的

2）比较每个位图的哈希值

3）逐个比较每个位/字节，一旦发现差异，这不是您要寻找的

4) 赢了，你找到了匹配:)

这非常慢，具体取决于您要实现的目标，但易于实施并且会起作用。对于类似原型的应用程序来说也很顺利。正如我所说，OCR（和所有其他形式的数字信号处理）是一个巨大的研究领域，所以你不能指望人们在一个快速的论坛帖子中教你，可悲的是:(

祝你好运

[编辑] 看看你的 OQ 中的评论，我会说去哈希表/字典数据结构对你来说是最快的。那，或二叉搜索树..两者都非常依赖于您的哈希键生成器:)

[EDIT2 (xD)] “这是计算机生成的别名文本。背景不同，但文本始终具有相同的颜色。” 那里有非常重要的信息：P 文本/位图的大小是否也总是相同？我建议要么实现你自己的散列算法，丢弃预设的背景颜色，这样散列值只取决于文本的颜色（以及它的形状），或者只是重写目标中的所有背景像素与您的原始颜色相同（或者只是将原始背景设置为目标的颜色？再次取决于您在此处使用的数据 - 需要更多信息:)）。

# c# - C#/SQL - 程序中的 SqlDbType.Xml 有什么问题？

> ID：574928
> 
> 赞同：6
> 
> 时间：2009-02-22T13:26:45.997
> 
> 标签：c#, xml, stored-procedures, sql-server-ce, compact-framework

我问过很少人为什么在存储过程中使用 xml 作为参数不起作用，每个人都说，就是这样。我不敢相信。

```
command.Parameters.Add("@xmldoc", SqlDbType.Xml); 
```

那是编译器返回错误的地方，我不能使用 NVarChar 因为它仅限于 4k 唱。XML 将是完美的，因为它可以是 2gigs 大。

为什么其他 SqlDbTypes 运行良好，而这个返回错误？

*

> 错误：指定的参数超出了有效值的范围。参数名称：@xmldoc：无效的 SqlDbType 枚举值：25。

*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-22T14:50:13.690

它确实有效。您必须将值设置为 SqlXml 而不是字符串，但可以这样做。想象一下这张桌子：

```
CREATE TABLE XmlTest
(
    [XmlTestId] [int]   identity(1,1) primary key,
    [XmlText]   [xml]   NOT NULL
) 
```

和存储过程：

```
CREATE PROCEDURE XmlTest_Insert
(
    @XmlText    xml
)
AS

INSERT INTO XmlTest (XmlText)
VALUES (@XmlText) 
```

现在想象一个如下所示的控制台应用程序：

```
using System.Data.SqlClient;
using System.Data;
using System.Data.SqlTypes;
using System.Xml;

namespace TestConsole
{
    class Program
    {

        static void Main(string[] args)
        {
            string xmlDoc = "<root><el1>Nothing</el1></root>";
            string connString = "server=(local);database=IntroDB;UID=sa;PWD=pwd";
            SqlConnection conn = new SqlConnection(connString);
            SqlCommand cmd = new SqlCommand("XmlTest_Insert", conn);
            cmd.CommandType = CommandType.StoredProcedure;
            SqlParameter param = new SqlParameter("@XmlText", SqlDbType.Xml);
            param.Value = new SqlXml(new XmlTextReader(xmlDoc
                           , XmlNodeType.Document, null));
            cmd.Parameters.Add(param);

            conn.Open();
            cmd.ExecuteNonQuery();
            conn.Dispose();
        }
    }
} 
```

答对了！

这是在 Visual Studio 2008 (.NET 3.5) 中完成的，但我相当肯定它也应该在 Visual Studio 2005 (2.0 Framework) 中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T13:49:39.220

不要使用 Add 方法，而是尝试使用 AddWithValue，您不需要指定类型，只需指定名称和值。除非您使用不同的方向输入？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-09-18T07:14:13.713

```
//创建StringWriter对象

var stringWriter = new System.IO.StringWriter();

//为序列化创建XmlSerializer对象，
RequestUpdateRBCustomerExternal 是具有所有值的类型的类

var serializer = new XmlSerializer(typeof(RequestUpdateRBCustomerExternal));

//请求的类型为 RequestUpdateRBCustomerExternal

serializer.Serialize(stringWriter, request);

SqlXml xml = new SqlXml(new XmlTextReader(stringWriter.ToString(), XmlNodeType.Document, null));

cmd.CommandText ="插入 SAPDataTracking 值('"+DateTime.Now+"','"+xml.Value+"')";

```

# javascript - 在输入类型 =“文本”中键入时跟踪 onchange 的最佳方法？

> ID：574941
> 
> 赞同：548
> 
> 时间：2009-02-22T13:43:48.157
> 
> 标签：javascript, html, forms

根据我的经验，`input type="text"` `onchange`事件通常仅在您离开 ( `blur`) 控件后发生。

有没有办法强制浏览器在`onchange`每次`textfield`内容更改时触发？如果不是，那么“手动”跟踪这个最优雅的方法是什么？

使用`onkey*`事件是不可靠的，因为您可以右键单击该字段并选择粘贴，这将更改该字段而无需任何键盘输入。

是`setTimeout`唯一的方法吗？..丑:-)

* * *

## 回答 #1

> 赞同：822
> 
> 时间：2014-10-05T11:39:17.617

**这几天听着[`oninput`](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/oninput)。** 感觉就像[`onchange`](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onchange)不需要失去对元素的关注。它是 HTML5。

所有人（甚至是移动设备）都支持它，除了 IE8 及更低版本。对于 IE 添加`onpropertychange`. 我这样使用它：

```
const source = document.getElementById('source');
const result = document.getElementById('result');

const inputHandler = function(e) {
  result.innerHTML = e.target.value;
}

source.addEventListener('input', inputHandler);
source.addEventListener('propertychange', inputHandler); // for IE8
// Firefox/Edge18-/IE9+ don’t fire on <select><option>
// source.addEventListener('change', inputHandler); 
```

```
<input id="source">
<div id="result"></div>
```

* * *

## 回答 #2

> 赞同：297
> 
> 时间：2009-02-22T14:09:05.787

***更新：***

请参阅[另一个答案](https://stackoverflow.com/questions/574941/best-way-to-track-onchange-as-you-type-in-input-type-text/26202266#26202266)（2015 年）。

* * *

*2009 年原始答案：*

那么，您希望`onchange`事件在 keydown、blur*和*paste 时触发？那是魔法。

如果您想在输入时跟踪更改，请使用`"onkeydown"`. 如果您需要用鼠标捕获粘贴操作，请使用`"onpaste"`( [IE](http://msdn.microsoft.com/en-us/library/ms536955(VS.85,loband).aspx) , [FF3](https://developer.mozilla.org/En/DOM/Element.onpaste) ) 和`"oninput"`( [FF, Opera, Chrome, Safari](http://help.dottoro.com/ljhxklln.php) ¹ )。

¹[在 Safari 上][损坏。改为`<textarea>`使用[`textInput`](http://help.dottoro.com/ljhiwalm.php)]

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2015-01-21T08:42:12.947

下面的代码适用于我的 Jquery 1.8.3

HTML：`<input type="text" id="myId" />`

Javascript/JQuery：

```
$("#myId").on('change keydown paste input', function(){
      doSomething();
}); 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-07-04T09:36:23.150

Javascript在这里是不可预测和有趣的。

*   `onchange`仅在您模糊文本框时发生
*   `onkeyup`&`onkeypress`并不总是发生在文本更改时
*   `onkeydown`在文本更改时发生（但无法通过鼠标单击跟踪剪切和粘贴）
*   `onpaste`&`oncut`发生在按键甚至鼠标右键单击时。

因此，要跟踪文本框中的变化，我们需要`onkeydown`和。在这些事件的回调中，如果您检查文本框的值，那么您不会获得更新的值，因为回调后值已更改。所以解决这个问题的方法是设置一个超时函数，超时时间为 50 毫秒（或者可能更短）来跟踪变化。`oncut``onpaste`

这是一个肮脏的黑客，但这是我研究的唯一方法。

这是一个例子。 [http://jsfiddle.net/2BfGC/12/](http://jsfiddle.net/2BfGC/12/)

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2018-06-19T09:28:56.440

我认为在 2018 年最好使用该`input`事件。

-

正如 WHATWG 规范所描述的（[https://html.spec.whatwg.org/multipage/indices.html#event-input-input](https://html.spec.whatwg.org/multipage/indices.html#event-input-input)）：

> 当用户更改值时在控件上触发（另请参见[更改事件](https://html.spec.whatwg.org/multipage/indices.html#event-change)）

-

以下是如何使用它的示例：

```
<input type="text" oninput="handleValueChange()"> 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2010-04-13T17:12:31.987

`onkeyup`例如，在您键入后发生，`t`当我抬起手指时，动作发生，但`keydown`动作发生在我数字字符之前`t`

希望这对某人有帮助。

因此`onkeyup`，当您想发送刚刚输入的内容时，效果会更好。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-02-09T20:22:06.740

我有类似的要求（twitter 风格的文本字段）。使用`onkeyup`和`onchange`。`onchange`实际上在从现场失去焦点期间负责鼠标粘贴操作。

*[更新]*在 HTML5 或更高版本中，用于`oninput`获取实时字符修改更新，如上面其他答案中所述。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-02-08T17:31:35.283

请使用 JQuery 判断下一个方法：

HTML：

```
<input type="text" id="inputId" /> 
```

Javascript（JQuery）：

```
$("#inputId").keyup(function() {
    $(this).blur();
    $(this).focus();
});

$("#inputId").change(function() {
    // Do whatever you need to do on actual change of the value of the input field
}); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-05-19T10:52:32.037

如果你只使用 Internet Explorer，你可以使用这个：

```
<input type="text" id="myID" onpropertychange="TextChange(this)" />

<script type="text/javascript">
    function TextChange(tBox) {
        if(event.propertyName=='value') {
            //your code here
        }
    }
</script> 
```

希望有帮助。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-03-29T09:20:44.373

有一个非常接近的解决方案（不要修复所有粘贴方式），但其中大多数：

它适用于输入以及文本区域：

```
<input type="text" ... >
<textarea ... >...</textarea> 
```

这样做：

```
<input type="text" ... onkeyup="JavaScript: ControlChanges()" onmouseup="JavaScript: ControlChanges()" >
<textarea ... onkeyup="JavaScript: ControlChanges()" onmouseup="JavaScript: ControlChanges()" >...</textarea> 
```

正如我所说，并非所有在所有浏览器上都粘贴触发事件的方法......最糟糕的是，有些根本不会触发任何事件，但计时器用于这种情况是可怕的。

但是大多数粘贴方式都是通过键盘和/或鼠标完成的，因此通常在粘贴后会触发 onkeyup 或 onmouseup，在键盘上键入时也会触发 onkeyup。

确保您的检查代码不会花费太多时间……否则用户的印象会很差。

是的，诀窍是在键和鼠标上开火......但要注意两者都可以开火，所以要记住这样的！！！

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-01-19T19:47:48.520

“输入”对我有用。

```
var searchBar  = document.getElementById("searchBar");
searchBar.addEventListener("input", PredictSearch, false); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-04-01T21:24:07.173

要跟踪每个尝试这个示例，在此之前将光标闪烁率完全降低为零。

```
<body>
//try onkeydown,onkeyup,onkeypress
<input type="text" onkeypress="myFunction(this.value)">
<span> </span>
<script>
function myFunction(val) {
//alert(val);
var mySpan = document.getElementsByTagName("span")[0].innerHTML;
mySpan += val+"<br>";
document.getElementsByTagName("span")[0].innerHTML = mySpan;
}
</script>

</body>
```

onblur : 退出时生成事件

onchange ：如果在 inputtext 中进行任何更改，则在退出时生成事件

onkeydown：在任何按键按下时都会生成事件（也可以长时间按住按键）

onkeyup ：事件在任何键释放时生成

onkeypress：与 onkeydown（或 onkeyup）相同，但不会对 ctrl、backsace、alt 其他做出反应

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-04-15T23:32:01.343

2018在这里，这就是我所做的：

```
$(inputs).on('change keydown paste input propertychange click keyup blur',handler); 
```

如果您能指出这种方法的缺陷，我将不胜感激。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2021-01-15T05:05:24.007

使用`oninput`而不是`onchange`.

索引.html

```
<html>
  <head>
    <title>title here</title>
    <script src="index.js"></script>
  </head>
  <body>
    <input oninput="onclickhandler(this)"></input>
  </body>
</html> 
```

脚本.js

```
function onclickhandler(e) {
  console.log(e.value);
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-22T13:49:41.277

您也可以使用`keydown`,`keyup`和`keypress`事件。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-11-05T04:06:31.603

**方法一：**添加事件监听器`input`：

```
element.addEventListener("input", myFunction); 
```

**方法二：**`oninput`用 JavaScript定义属性：

```
element.oninput = function()
{
    myFunction();
}; 
```

**方法3：**`oninput`用HTML定义属性：

```
<input type="text" oninput="myFunction();"> 
```

# dns - 使用非英语无处不在的语言？

> ID：574942
> 
> 赞同：4
> 
> 时间：2009-02-22T13:46:27.103
> 
> 标签：dns, domain-driven-design, ubiquity

在讨论最近一个项目的规格和功能要求时，我们正在与领域专家讨论荷兰语的会计术语，因为整个团队和客户都是荷兰语母语人士。

当开发开始时，我们自然地用英文实现了领域类和接口，因为我们用英文编写了所有代码。尽管我注意到与客户的后续会议有时让他们感到困惑，尤其是当开发人员讨论实施细节并因此使用英文术语时。

您对此有何经验？

PS：我知道 Stack Overflow 上还有其他一些关于您是否应该用您的母语编写代码的帖子，但这个问题更多的是关于创建和使用所有开发人员、客户和领域专家都能理解的普遍存在的语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T13:54:40.033

这要么是以下内容的副本，要么被以下内容广泛涵盖：

*   [编程语言不是英语？](https://stackoverflow.com/questions/300276/programming-languages-not-in-english);
*   [你用你的语言编码变量吗？](https://stackoverflow.com/questions/553082/do-you-code-variables-in-your-language);
*   [命名约定：寻找混合英语和领域/工作流程术语的替代方案](https://stackoverflow.com/questions/455013/naming-conventions-looking-for-alternative-to-mixing-of-english-and-domain-workf)；
*   [您使用其他语言而不是英语吗？](https://stackoverflow.com/questions/250824/do-you-use-another-language-instead-of-english);
*   [如何管理非英语客户](https://stackoverflow.com/questions/204506/how-to-manage-non-english-speaking-customer)；
*   [用其他（口语）语言编码](https://stackoverflow.com/questions/202723/coding-in-other-spoken-languages)；和
*   毫无疑问其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T13:49:21.013

您可能已经了解[Z](http://en.wikipedia.org/wiki/Z_notation)。这可能适合也可能不适合您当前的情况。

# javascript - 显示基于 Javascript/Div 的悬停窗口的最佳方式？

> ID：574943
> 
> 赞同：0
> 
> 时间：2009-02-22T13:46:40.847
> 
> 标签：javascript, html, css, dhtml

我说的是[Ibox](http://www.ibegin.com/labs/ibox/)排序。即，用户单击一个链接，一个基于 javascript 的小 div 悬停在上面，其中包含一个小表单等。

我想给用户一个`<script>`他们会放在他们网站上的标签。然后，他们会将所需的 javascript 函数放入`<a href>`他们想要用于显示表单的标签中。例如，他们会提出：

```
<a href="javascript:mysite_signUpForm();">
Create an account on [My site's name]</a> 
```

显然，这里的 mysite 将被我的网站名称替换。

这里的主要要求是它应该能够在表单中显示异地 url。即，它应该接收一个 url 并在其 div 中加载该 url 的内容。此外，更改背景/边框颜色等应该很容易。而且视觉上越吸引人越好。

有什么建议么？

此外，如果它的高度会随着更多内容的加载/隐藏而扩大/减少，那将是最好的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T14:17:40.710

好吧，如果你使用 jquery，你可以使用[facebox](https://github.com/defunkt/facebox)插件。所以，一旦你这样做了，你可以像这样制作链接：

```
<a href="http://site.name.com/page.html" rel="facebox">Link content</a> 
```

然后像这样初始化插件：

```
 $('a[rel*=facebox]').facebox() 
```

*这将在 div 中加载site.name.com/page.html*的远程内容并显示它。

除此之外，还有许多[其他适用于](http://jquery.com/demo/thickbox/)[jquery](http://webtecker.com/2008/02/26/8-ajax-lightbox-scripts/)的lightbox 插件。

# javascript - 如何使用 Javascript 加载 CSS 文件？

> ID：574944
> 
> 赞同：359
> 
> 时间：2009-02-22T13:48:00.673
> 
> 标签：javascript, html, css, dhtml

是否可以使用 Javascript 将 css 样式表导入 html 页面？如果是这样，怎么办？

PS javascript 将托管在我的网站上，但我希望用户能够放入`<head>`他们网站的标签，并且它应该能够将托管在我的服务器上的 css 文件导入当前网页。（css 文件和 javascript 文件都将托管在我的服务器上）。

* * *

## 回答 #1

> 赞同：490
> 
> 时间：2009-02-23T09:25:35.197

这是“老派”的做法，希望它适用于所有浏览器。理论上，`setAttribute`不幸的是，您会使用 IE6 并不能始终如一地支持它。

```
var cssId = 'myCss';  // you could encode the css path itself to generate id..
if (!document.getElementById(cssId))
{
    var head  = document.getElementsByTagName('head')[0];
    var link  = document.createElement('link');
    link.id   = cssId;
    link.rel  = 'stylesheet';
    link.type = 'text/css';
    link.href = 'http://website.com/css/stylesheet.css';
    link.media = 'all';
    head.appendChild(link);
} 
```

此示例检查 CSS 是否已添加，因此仅添加一次。

将该代码放入 javascript 文件中，让最终用户简单地包含 javascript，并确保 CSS 路径是绝对路径，以便从您的服务器加载。

# 香草JS

`head`这是一个使用纯 JavaScript根据 URL 的文件名部分将 CSS 链接注入元素的示例：

```
<script type="text/javascript">
var file = location.pathname.split( "/" ).pop();

var link = document.createElement( "link" );
link.href = file.substr( 0, file.lastIndexOf( "." ) ) + ".css";
link.type = "text/css";
link.rel = "stylesheet";
link.media = "screen,print";

document.getElementsByTagName( "head" )[0].appendChild( link );
</script> 
```

在结束标记之前插入代码`head`，CSS 将在页面呈现之前加载。使用外部 JavaScript ( `.js`) 文件将导致出现无样式内容 ( [FOUC](http://en.wikipedia.org/wiki/Flash_of_unstyled_content) ) 的 Flash。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2015-10-28T09:13:53.110

如果你使用 jquery：

```
$('head').append('<link rel="stylesheet" type="text/css" href="style.css">'); 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-02-22T13:56:26.863

我想像这个脚本这样的东西会做：

```
<script type="text/javascript" src="/js/styles.js"></script> 
```

该 JS 文件包含以下语句：

```
if (!document.getElementById) document.write('<link rel="stylesheet" type="text/css" href="/css/versions4.css">'); 
```

如果要引用您的站点，则 javascript 和 css 的地址必须是绝对地址。

[这篇“用分支技术对 CSS hacks 说不”](http://www.tjkdesign.com/articles/branching.asp)一文讨论了许多 CSS 导入技术。

但是[“使用 JavaScript 动态添加 Portlet CSS 样式表”](http://cse-mjmcl.cse.bris.ac.uk/blog/2005/08/18/1124396539593.html)一文也提到了 CreateStyleSheet 可能性（IE 的专有方法）：

```
<script type="text/javascript">
//<![CDATA[
if(document.createStyleSheet) {
  document.createStyleSheet('http://server/stylesheet.css');
}
else {
  var styles = "@import url(' http://server/stylesheet.css ');";
  var newSS=document.createElement('link');
  newSS.rel='stylesheet';
  newSS.href='data:text/css,'+escape(styles);
  document.getElementsByTagName("head")[0].appendChild(newSS);
}
//]]> 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2018-06-12T17:22:21.637

[Element.insertAdjacentHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)有很好的浏览器支持，可以一行添加一个样式表。

```
document.getElementsByTagName("head")[0].insertAdjacentHTML(
    "beforeend",
    "<link rel=\"stylesheet\" href=\"path/to/style.css\" />"); 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-12-02T14:01:30.417

如果您想知道（或等待）直到样式本身已加载，这可行：

```
// this will work in IE 10, 11 and Safari/Chrome/Firefox/Edge
// add ES6 poly-fill for the Promise, if needed (or rewrite to use a callback)

let fetchStyle = function(url) {
  return new Promise((resolve, reject) => {
    let link = document.createElement('link');
    link.type = 'text/css';
    link.rel = 'stylesheet';
    link.onload = function() { resolve(); console.log('style has loaded'); };
    link.href = url;

    let headScript = document.querySelector('script');
    headScript.parentNode.insertBefore(link, headScript);
  });
}; 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-07-05T03:41:21.140

在现代浏览器中，您可以`promise`像这样使用。创建一个带有承诺的加载器函数：

```
function LoadCSS( cssURL ) {

    // 'cssURL' is the stylesheet's URL, i.e. /css/styles.css

    return new Promise( function( resolve, reject ) {

        var link = document.createElement( 'link' );

        link.rel  = 'stylesheet';

        link.href = cssURL;

        document.head.appendChild( link );

        link.onload = function() { 

            resolve(); 

            console.log( 'CSS has loaded!' ); 
        };
    } );
} 
```

那么显然你想要在 CSS 加载后完成一些事情。您可以像这样调用 CSS 加载后需要运行的函数：

```
LoadCSS( 'css/styles.css' ).then( function() {

    console.log( 'Another function is triggered after CSS had been loaded.' );

    return DoAfterCSSHasLoaded();
} ); 
```

如果您想深入了解它是如何工作的，有用的链接：

[关于 Promise 的官方文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises)

[有用的承诺指南](https://developers.google.com/web/fundamentals/primers/promises)

[关于承诺的精彩介绍视频](https://www.youtube.com/watch?v=s6SH72uAn3Q)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-09-27T04:17:58.460

使用此代码：

```
var element = document.createElement("link");
element.setAttribute("rel", "stylesheet");
element.setAttribute("type", "text/css");
element.setAttribute("href", "external.css");
document.getElementsByTagName("head")[0].appendChild(element); 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2012-01-25T08:04:50.463

我知道这是一个很老的话题，但我的 5 美分来了。

根据您的需求，还有另一种方法可以做到这一点。

我有一个案例，我希望一个 css 文件只激活一段时间。就像css切换一样。激活 css，然后在另一个事件之后将其停用。

您可以在新 css 中的所有元素前面添加一个类/一个 id，而不是动态加载 css 然后将其删除，然后只需切换 css 基节点的类/id（如 body 标记）。

使用此解决方案，您最初会加载更多的 css 文件，但您有一种更动态的方式来切换 css 布局。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-11-04T16:47:15.150

你听说过承诺吗？它们适用于所有现代浏览器，并且使用起来相对简单。看看这个将 css 注入 html 头部的简单方法：

```
function loadStyle(src) {
    return new Promise(function (resolve, reject) {
        let link = document.createElement('link');
        link.href = src;
        link.rel = 'stylesheet';

        link.onload = () => resolve(link);
        link.onerror = () => reject(new Error(`Style load error for ${src}`));

        document.head.append(link);
    });
} 
```

您可以按如下方式实现它：

```
window.onload = function () {
    loadStyle("https://fonts.googleapis.com/css2?family=Raleway&display=swap")
        .then(() => loadStyle("css/style.css"))
        .then(() => loadStyle("css/icomoon.css"))
        .then(() => {
            alert('All styles are loaded!');
        }).catch(err => alert(err));
} 
```

真的很酷，对吧？这是一种使用 Promises 决定样式优先级的方法。

要查看多样式加载实现，请参阅：[https ://stackoverflow.com/a/63936671/13720928](https://stackoverflow.com/a/63936671/13720928)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-12-12T12:01:58.723

有一个通用的 jquery 插件，可以按需加载 css 和 JS 文件同步和异步。它还跟踪已经加载的内容:) 请参阅：[http ://code.google.com/p/rloader/](http://code.google.com/p/rloader/)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-10-22T18:18:32.587

这是 jQuery 的元素创建方法（我的偏好）和回调的一种方式`onLoad`：

```
var css = $("<link>", {
  "rel" : "stylesheet",
  "type" :  "text/css",
  "href" : "style.css"
})[0];

css.onload = function(){
  console.log("CSS IN IFRAME LOADED");
};

document
  .getElementsByTagName("head")[0]
  .appendChild(css); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-09-06T12:08:12.260

下面是用于加载 JS 和/或 CSS 的完整代码

```
function loadScript(directory, files){
  var head = document.getElementsByTagName("head")[0]
  var done = false
  var extension = '.js'
  for (var file of files){ 
    var path = directory + file + extension 
    var script = document.createElement("script")
    script.src = path        
    script.type = "text/javascript"
    script.onload = script.onreadystatechange = function() {
        if ( !done && (!this.readyState ||
            this.readyState == "loaded" || this.readyState == "complete") ) {
            done = true
            script.onload = script.onreadystatechange = null   // cleans up a little memory:
            head.removeChild(script)  // to avoid douple loading
        }
  };
  head.appendChild(script) 
  done = false
 }
}

function loadStyle(directory, files){
  var head = document.getElementsByTagName("head")[0]
  var extension = '.css'
  for (var file of files){ 
   var path = directory + file + extension 
   var link = document.createElement("link")
   link.href = path        
   link.type = "text/css"
   link.rel = "stylesheet" 
   head.appendChild(link) 
 }
}

(() => loadScript('libraries/', ['listen','functions', 'speak', 'commands', 'wsBrowser', 'main'])) ();
(() => loadScript('scripts/', ['index'])) ();

(() => loadStyle('styles/', ['index'])) (); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-09-16T18:52:40.883

这是**一个单行**示例，它使用纯 JavaScript 根据 URL 的文件名部分将 CSS 链接注入到 head 元素中：

`document.head.innerHTML += '<link rel="stylesheet" href="css/style.css">';`

大多数浏览器都支持它。查看[浏览器兼容性](https://developer.mozilla.org/en-US/docs/Web/API/Document/head#Browser_compatibility)。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-22T13:59:34.390

你可以使用这个[YUI 库](http://developer.yahoo.com/yui/get/)或者使用这篇[文章来实现](http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-22T14:04:31.023

[YUI 库](http://developer.yahoo.com/yui/get/)可能是您正在寻找的。它还支持跨域加载。

如果你使用 jquery，[这个插件](http://nicolas.rudas.info/jQuery/getPlugin/)会做同样的事情。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-11-26T18:42:43.773

我想分享另一种方法，不仅可以加载 css，还可以加载所有资产（js、css、图像）并处理一堆文件的**onload事件。**是`async-assets-loader`。请参见下面的示例：

```
<script src="https://unpkg.com/async-assets-loader"></script>
<script>
var jsfile = "https://code.jquery.com/jquery-3.4.1.min.js";
var cssfile = "https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css";
var imgfile = "https://logos.keycdn.com/keycdn-logo-black.png";
var assetsLoader = new asyncAssetsLoader();
assetsLoader.load([
      {uri: jsfile, type: "script"},
      {uri: cssfile, type: "style"},
      {uri: imgfile, type: "img"}
    ], function () {
      console.log("Assets are loaded");
      console.log("Img width: " + assetsLoader.getLoadedTags()[imgfile].width);
    });
</script> 
```

根据[async-assets-loader](https://www.npmjs.com/package/async-assets-loader)文档

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-07-31T10:36:48.390

```
var elem = document.createElement('link');
elem.rel = ' stylesheet'
elem.href= 'style.css';//Link of the css file
document.head.appendChild(elem); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-10-21T04:45:23.740

```
var fileref = document.createElement("link")
fileref.setAttribute("rel", "stylesheet")
fileref.setAttribute("type", "text/css")
fileref.setAttribute("th:href", "@{/filepath}")
fileref.setAttribute("href", "/filepath") 
```

我正在使用百里香，这很好用。谢谢

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-08-10T20:04:57.493

采用：

```
document.getElementById("of head/body tag")
        .innerHTML += '<link rel="stylesheet" type="text/css" href="style.css">'; 
```

# python - 如何将所有 6 个字母的拉丁词提取到一个列表中？

> ID：574952
> 
> 赞同：1
> 
> 时间：2009-02-22T13:51:36.220
> 
> 标签：python, regex, data-mining

我需要在一个列表中包含所有 6 个字母的[拉丁词。](http://www.math.ubc.ca/~cass/frivs/latin/latin-dict-full.html)

我还想在列表中包含遵循 Xyzzyx 模式的单词。

我用过小 Python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T14:10:50.557

正则表达式是你的朋友，我的朋友！这是作业吗？

*这是一个接近*您想要的示例：

```
egrep "^\w{6}$" /usr/share/dict/words | egrep "(.)(.)(.)\3\2\1" 
```

我将把它作为练习留给读者创建一个拉丁单词列表并处理第二个正则表达式中的大写 X，但总体思路应该很明显。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T20:20:48.547

请注意，除非您的列表包含所有名词的变格和动词的变位，否则您的程序将不会产生像拉丁语中的*所有*六字母单词一样的任何内容。

例如，您的列表可能只包含名词的主格。主格长度为五个字母的第一变格名词（例如*mensa*）具有六个字母的属格（例如*mensae*）。所有的变格都包含名词长度与其主格不同的情况。

动词的情况更是如此，每个动词都有（至少）四个主要部分，可以有不同的长度，并且它们的变位也可以有不同的长度。*所以乐高*的第一人称单数现在时是四个字母，但它的不定式*legere*是六个；*porto*在第一人称单数中是五个，但在第二人称单数中是六个，*portas*。

 ***我认为原则上可以构建一个引擎，在给定关于每个单词的足够元信息的情况下，以编程方式拒绝和结合拉丁词。Python 实际上是一种非常好的语言来做到这一点。但这比编写正则表达式要大得多。

# objective-c - 你可以在 Xcode 中设置代码区域吗？

> ID：574953
> 
> 赞同：23
> 
> 时间：2009-02-22T13:51:59.120
> 
> 标签：objective-c, xcode

在编写 c# 时，在 Visual Studio 中，您可以设置[区域](http://msdn.microsoft.com/en-us/library/9a1ybwek(VS.71).aspx)以相应地对代码进行分组。作为 Xcode 的新手，我似乎找不到类似的功能。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-22T14:39:49.113

使用 Xcode 编辑器，您可以通过单击左边的小边距来折叠或展开任何代码块。此外，您可以在代码中的任何位置添加标记：

`#pragma mark` *只要你愿意，你的头衔*

然后，您的标记将出现在编辑器窗口顶部的中间弹出菜单中。

* * *

更新：我发现[这里](https://stackoverflow.com/questions/288508/xcode-regions)存在这个问题的副本。答案可能很有趣。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-24T10:01:00.190

您还可以使用：

```
// MARK: - 
```

或者

```
// MARK: Initialization 
```

这比#pragma 标记更便携。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-22T15:21:40.900

很抱歉学究，但它是“Xcode”，而不是“X-Code”。

你可以例如去：

```
#pragma mark - 
```

或者

```
#pragma mark Initialization 
```

这会给你这种东西：

[![替代文字](https://i.stack.imgur.com/xobw9.png)](https://i.stack.imgur.com/xobw9.png)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-12-07T21:42:43.893

另一种选择

```
#pragma mark - Initialization 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-31T07:44:01.290

如果您想拥有一个带有自定义代码部分的折叠区，那么将您想要的代码放在大括号内`{` `}`，它将成为一个折叠区。

但是您必须记住，大括号也定义了变量范围，因此此代码不应包含将在这些括号之外使用的变量声明。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-09-09T16:24:11.007

如果不支持 .Net 样式区域，那么能够折叠所有功能是次佳选择。

`command`- `option`- `shift`-`left arrow` 崩溃。

`command`- `option`- `shift`-`right arrow` 展开。

Xcode 会记住折叠函数的最后状态。

# c# - c# CF、WinForms 和双缓冲

> ID：574958
> 
> 赞同：1
> 
> 时间：2009-02-22T13:58:06.203
> 
> 标签：c#, winforms, compact-framework, doublebuffered

我在表单上有一个带有 PictureBox 的 CF 2.0 应用程序。我想通过鼠标移动来移动 PictureBox，我需要在表单中添加双缓冲区以避免闪烁。

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-22T14:37:39.977

你不需要双缓冲的表格，你需要的是 PB。这在CF中并不容易。但是，您可以创建自己的控件，PB 非常简单。例如：

```
using System;
using System.Drawing;
using System.Windows.Forms;

public class MyPictureBox : Control {
  private Image mImage;
  public Image Image {
    get { return mImage; }
    set { mImage = value; Invalidate(); }
  }
  protected override void OnPaintBackground(PaintEventArgs pevent) {
    // Do nothing
  }
  protected override void OnPaint(PaintEventArgs e) {
    using (Bitmap bmp = new Bitmap(this.ClientSize.Width, this.ClientSize.Height)) {
      using (Graphics bgr = Graphics.FromImage(bmp)) {
        bgr.Clear(this.BackColor);
        if (mImage != null) bgr.DrawImage(mImage, 0, 0);
      }
      e.Graphics.DrawImage(bmp, 0, 0);
    }
    base.OnPaint(e);
  }
} 
```

希望我没有使用 CF 中没有的东西......

# c# - base64 和 UTF-8 编码问题

> ID：574972
> 
> 赞同：0
> 
> 时间：2009-02-22T14:09:55.973
> 
> 标签：c#, encoding, utf-8, base64

我正在编写一个返回 byte[] 的简单 Web 方法，并且 byte[] 由 UTF-8 编码。我调查了相关的 WSDL 和肥皂消息，似乎底层的 Web 服务堆栈将使用 base64 编码？

由于各种原因，我无法使用或将返回的字节 [] 从 UTF-8 重新编码为 base64。将base64编码修改为UTF-8编码有什么想法吗？

这是我在 WSDL 中的相关 Web 方法、SOAP 消息和相关类型

Web服务服务器端代码

```
 [WebMethod]
        public byte[] HelloWorld2()
        {
            return utf8encodedbytes;
        } 
```

SOAP 响应

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <HelloWorld2Response xmlns="http://tempuri.org/">
      <HelloWorld2Result>base64Binary</HelloWorld2Result>
    </HelloWorld2Response>
  </soap:Body>
</soap:Envelope> 
```

WSDL 中的相关类型

```
xsd:base64Binary 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-22T14:40:23.090

恐怕您的问题并没有多大意义-字节数组未使用 UTF-8 之类的文本编码进行编码。您通常将 UTF-8 编码应用于*文本*以获取字节数组。要在 XML 中传输任意字节数组，您应该使用 base64。

如果你想传输*文本*，你应该只返回一个字符串开始。

在发生任何类型的编码之前，原始数据是什么？如果它是一个字节数组，您应该返回一个字节数组，并且 XML 应该自动包含 base64 编码的数据。如果是文本，您应该返回一个字符串并让 XML 处理编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T15:10:52.347

那么是什么阻止你使用`Convert.ToBase64()`and`Convert.FromBase64()`呢？这些函数正是这样做的：将`byte`数组转换为 base64 `string`，反之亦然。

# c++ - 从 C++ dll 导出一个类？

> ID：574973
> 
> 赞同：3
> 
> 时间：2009-02-22T14:10:31.400
> 
> 标签：c++, winapi, visual-c++

如何从 dll 公开一个类？

导入 dll 的应用程序应该能够创建类的对象，并且他应该能够调用类的成员函数。

是否类似于使用 公开 C 类型函数`__declspec(dllexport)`？

而且，当我构建 dll（它只包含头文件中的类定义和 cpp 文件中的成员函数定义）时，没有创建相应的 lib 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T14:13:31.813

[在这里](http://msdn.microsoft.com/en-us/library/a90k134d(VS.80).aspx)。请记住，您不能使用 LoadLibrary()/GetProcAddress() 来使用这个导出的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T14:34:12.170

导出类中至少一个公共方法的定义必须有 _declspec(dllexport) 前缀才能创建 lib 文件。如果所有方法都没有此前缀，则只有声明（即头文件）可用，但类将无法实例化（为此需要导出构造函数）。如果至少一个方法有 _declspec(dllexport) 前缀，那么编译器将理解 dll 用户必须能够链接到这个 dll。一旦加载链接到它们的 exe，操作系统就会加载此类 dll。

您可以考虑对您的问题采用“工厂”方法。例如，Symbian OS 使用多态 dll 实现了这种方法。为此，您必须：

1.  在您的 dll 中声明（即头文件）并定义（即 cpp 文件）类。不需要其他任何东西。

2.  在您的 dll 中创建一个“工厂”函数，该函数将为您的类创建一个实例并返回指向它的指针。此函数必须具有 _declspec(dllexport) 前缀。

3.  与您的用户共享您的头文件和 lib 文件。

4.  用户包含头文件并与 lib 文件链接。

5.  用户调用工厂函数实例化类（即制作对象），然后将其作为普通类使用。

上面的 5 个步骤就像 Symbian OS 中的魅力一样。您必须自己在您的平台上尝试并发布结果。坦率地说，我还没有在 Windows 上尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T14:14:20.563

> 是否类似于使用 公开 C 类型函数`_declspec(dllexport)`？

是的。并且 __declspec 可以应用于该类。

> 没有创建对应的lib文件

IIRC 这是默认设置，但您可以覆盖默认链接器选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T14:13:24.763

查看[Def Files](http://msdn.microsoft.com/en-us/library/d91k01sh(VS.80).aspx)，在附加的第一个链接中是[Using __declspec(dllexport)](http://msdn.microsoft.com/en-us/library/a90k134d(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T14:14:38.287

谷歌搜索“class dllexport”导致[MSDN 的这个页面](http://msdn.microsoft.com/en-us/library/81h27t8c(VS.80).aspx)作为第一个结果。

该页面似乎表明您只`__declspec(dllexport)`需要拥有即可。

# c# - 基于先前用户输入的值在文本控件中自动完成的库或代码片段

> ID：574979
> 
> 赞同：0
> 
> 时间：2009-02-22T14:14:17.100
> 
> 标签：c#, .net, vb.net, autocomplete, controls

我正在寻找一个用于文本控件中自动完成支持的库，它可以记住用户以前的所有条目并为其提供自动完成支持。

例如，对于“最近的文件”，我使用[http://www.genghisgroup.com/](http://www.genghisgroup.com/)，效果很好。你知道类似的东西吗？

**更新：**这是一个 .NET Winforms 应用程序，我使用的是普通的文本控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T15:27:20.810

内置在 .NET TextBox 中的是 AutoComplete 功能。首先设置 AutoCompleteMode 属性（Suggest、Append 等），然后选择 AutoCompleteSource。您的选择是：

FileSystem HistoryList RecentUsedList AllUrl AllSystemSources FileSystemDirectories CustomSource 无 ListItems

在您的情况下，您将使用 CustomSource，然后填充作为 TextBox 上的属性的 AutoCompleteCustomSource 集合。我建议有一个简单的 SqlCe 数据库，您可以在其中存储用户过去输入的值，然后在加载应用程序时检索这些值，并填充 AutoCompleteCustomSource。

快速代码示例：

```
private void button1_Click(object sender, EventArgs e)
{
    this.textBox1.AutoCompleteMode = AutoCompleteMode.Suggest;
    this.textBox1.AutoCompleteSource = AutoCompleteSource.CustomSource;

    string[] items = GetListForCustomSource();
    this.textBox1.AutoCompleteCustomSource.AddRange(items);

}

private string[] GetListForCustomSource()
{
    var result = new List<string>();

    foreach(var value in Enum.GetNames(typeof(DayOfWeek)))
    {
        result.Add(value);
    }

    return result.ToArray();
} 
```

我只是以 DayOfWeek 为例，但您可以在该方法中查询数据库，并返回结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-22T15:10:20.820

下载源代码并查看最近的文件。毫无疑问，它正在存储某种形式的持久存储（数据库、文件等）并使用该信息来填写列表。您只是欺骗了该功能，并将其用于专注于单词而不是文件的 TextBox。

我没有看过 Genghis 的源代码，但我确信通过你使用的具有类似功能的控件运行并欺骗它是很容易的。当您这样做时，请联系 Genghis 集团并将其作为提交内容提供。这就是我们支持开源的方式。

# java - 将 Java 对象添加到数据库

> ID：574984
> 
> 赞同：3
> 
> 时间：2009-02-22T14:17:38.903
> 
> 标签：java, database, blob, derby

对于我被分配的大学作业，我有一个 Prize 对象，其中包含文本、图像或视频内容。我想将此信息保存到 Apache Derby 数据库（将在低功率 PDA 上运行）中的 BLOB 字段中。如何将此数据添加到数据库中？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T14:48:15.863

在这篇文章[中，使用 Derby 管理非结构化数据的五个步骤，](http://www.ibmpressbooks.com/articles/article.asp?p=1146304&seqNum=3) 您可以阅读如何执行此操作。

它描述了如何在 Apache Derby 中使用 JDBC 将二进制数据插入到具有 BLOB 数据类型的列中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T14:22:59.857

我假设您将通过 JDBC 进行连接。如果是这样，只需编写 SQL 并查看 PreparedStatement 的 setBlob 方法。应该很简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T17:10:51.077

[序列化](http://java.sun.com/developer/technicalArticles/Programming/serialization/)是一种简单的方法，但是如果可能的话，你可以让它看起来像一个真正的数据库表，其结构包含`id (bigint)`, `datatype (smallint)`，`creationdate (date)`并`data (blob)`专门制作客户端代码来保存对象的数据。这样，您可以进行类似的搜索`"get all video prizes created between January 1st 2008 and January 15th 2009"`，并且如果您的类更改太多而导致序列化停止工作，它不会分解旧数据。

如果需要，这种解决方案将来也很容易扩展；我知道这是一项学校作业，这种需求很可能永远不会浮出水面，但如果你的老师/教授知道他的东西，我敢打赌他愿意为以这种方式进行这项练习多加一两分，因为这需要一点时间更多的时间，并表明您可以采取措施提前准备应对不断变化的软件开发环境。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T17:00:07.980

如果您使用的是 Netbeans（我假设 Eclipse 具有类似的功能），您可以设置数据库模式并从数据库创建新的 Java 实体类，它将为您生成适当的 JPA 类。

[http://hendrosteven.wordpress.com/2008/03/06/simple-jpa-application-with-netbeans/](http://hendrosteven.wordpress.com/2008/03/06/simple-jpa-application-with-netbeans/)

这很好，因为它允许您专注于您的代码而不是数据库粘合代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-16T10:42:03.397

最好的解决方案是使用 Derby，因为它一直是通过 Java 开发的多平台应用程序。

# linux - 64 位 linux，汇编语言，问题？

> ID：574990
> 
> 赞同：7
> 
> 时间：2009-02-22T14:23:12.010
> 
> 标签：linux, assembly, 64-bit

我目前正在学习汇编语言。我在[Linux Mint](http://en.wikipedia.org/wiki/Linux_Mint)（32 位）上使用[Gas 。](http://en.wikipedia.org/wiki/GNU_Assembler)使用本书： [从头开始编程](http://savannah.nongnu.org/projects/pgubook/)。

我使用的机器有一个[AMD Turion 64 位](http://en.wikipedia.org/wiki/AMD_Turion)处理器，但我限制为 2 GB 的 RAM。我正在考虑将我的 Linux 安装升级到 64 位版本的 Linux Mint，但我担心因为这本书是针对 32 位 x86 架构的，所以代码示例将不起作用。

所以两个问题：

1.  代码示例是否可能存在任何问题？
2.  这里有没有人注意到使用 64 位 Linux 而不是 32 位的任何好处（我在 Stack Overflow 上看到了一些关于此的线程，但它们主要与 Windows Vista 和 Windows XP 相关。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-22T14:32:43.593

您的代码示例应该仍然有效。64 位处理器和操作系统仍然可以以某种“兼容模式”运行 32 位代码。您的装配示例也不例外。您可能需要提供一两行额外的程序集（例如 .BITS 32），仅此而已。

一般来说，使用 64 位操作系统会比使用 32 位操作系统更快。x86_64 的寄存器比 i386 多。由于您正在处理汇编，因此您已经知道寄存器的用途......拥有更多意味着更少的东西必须在堆栈（和其他临时内存）上移入和移出，因此您的程序花费更少的时间来管理数据和更多时间处理这些数据。

**编辑**：要在 64 位 linux 上使用 gas 编译 32 位代码，您只需使用命令行参数“--32”，如[GAS 手册中所述](http://sourceware.org/binutils/docs-2.19/as/i386_002dOptions.html#i386_002dOptions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T14:32:57.617

即使您运行 64 位 Linux，也可以在其上编译和运行 32 位二进制文​​件。我不知道 Mint 对此的支持有多好，我想你应该检查一下。

但是，64 位汇编器与 32 位不完全兼容，例如您有不同的（更多）寄存器。在这两个平台上都没有一些特定的说明。

我会说转向 64 位并不是什么大问题。**您仍然可以编写 32 位程序集**，然后也许尝试让它也以 64 位运行（不应该太难），作为更多编程/学习乐趣的来源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-05T15:25:52.593

通常 32 位就足够了，所以如果你真的需要，只能使用 64 位或更多。最好在编程之前决定是否要将其作为 32 位应用程序或 64 位应用程序进行，然后坚持使用它，因为混合模式调试会很快变得棘手。

# php - 是否有像 ruby 调试器这样的 php 交互式调试器？

> ID：574991
> 
> 赞同：9
> 
> 时间：2009-02-22T14:23:29.840
> 
> 标签：php, ruby, debugging, interactive

我观看了[用 Rails 2 在 15 分钟内创建一个博客，](http://rubyonrails.org/screencasts) 9 分钟后他在视频中展示了 ruby​​ 的交互式调试器，它允许您从正在运行的脚本中调用函数/方法。

这远远超出了断点，看起来非常有用。

PHP 是否有提供类似功能的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-22T15:22:44.220

安装[xdebug](http://www.xdebug.org/)，然后使用[此处](http://www.xdebug.org/docs/remote)提到的调试客户端之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-14T03:18:54.763

尽管[Milen 的答案](https://stackoverflow.com/a/575058/4463672)是 2009 年左右唯一正确的答案，而且 Xdebug 仍然是一个有用的工具，但使用它需要您重新编译 PHP 或编辑`php.ini`运行时配置以将其作为共享对象加载。这也意味着使用支持其网络协议的特定客户端应用程序，例如像 PhpStorm 这样的 IDE。

另一种方法是[`phpdbg`](http://phpdbg.com/)，它是一个交互式调试器，[附带 PHP 核心版本 5.6 和更高版本](https://secure.php.net/manual/debugger-about.php)，可以调试为符合 PHP 5.4 或更高版本而编写的 PHP 脚本。

使用它很简单：

```
phpdbg php_script_i_want_to_debug.php 
```

进入调试器后，键入`help`以访问帮助菜单。

如果您的系统上还没有`phpdbg`，可能是因为您的 PHP 没有配置该`--enable-phpdbg`选项。您可以：

1.  重新编译你的 PHP，确保`--enable-phpdbg`在运行时添加`./configure`（这也将简单地构建`phpdbg`二进制文件），或者
2.  独立下载`phpdbg`源代码并针对您安装的 PHP 进行编译（假设您有可用的 PHP 源代码）。这样做的说明虽然很少，但[在这里](http://phpdbg.com/docs)。

# vba - 如何在 Excel 中动态更新工作表的名称？

> ID：574995
> 
> 赞同：0
> 
> 时间：2009-02-22T14:29:23.680
> 
> 标签：vba, excel

我有一个 Excel 电子表格，用于为我们的 Unix 团队指定文件系统构建信息。

根据要构建的系统，此工作表将包含不同的信息。例如，一个生产系统会有很多文件系统，而一个开发系统只有一两个。

因此，根据用户输入，我们将填充两种输入工作表格式（“dev”、“prod”）中的一种或另一种，但目标工作表将始终相同。只有一个开发或生产工作表对用户在任何给定时间输入数据是可见和活动的。

我们如何告诉 Excel 使用特定的输入工作表来计算另一个输出工作表？

我最初的想法是，为简单起见，“输出”工作表将从“输入”工作表中获取数据，并且我们将动态地使“开发”或“产品”模板成为“输入”工作表。这是正确的方法吗，还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T15:09:23.537

根据工作表的复杂性，有几种方法：

*   如果您只有几个工作表，而用户只需选择“生产”或“测试”，您可以在公式中设置条件逻辑。例如：=if(A1="Test",TestSheet!A1 + TestSheet!A2, ProdSheet!A1 + ProdSheet!A2)
*   您可以使用与上述相同类型的想法，但使用 vlookup 表会增加更多复杂性
*   您的 VBA 代码可以根据用户输入动态创建整个 Excel 电子表格

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T11:56:30.730

如果您可以按照 LuckyLindy 的建议使用 VBA 代码，那么您几乎可以做任何事情。我以前做的是记录各种操作的宏，例如添加或重命名工作表，并获取生成的代码并对其进行调整以完全满足需要。

一个简单的宏代码示例：

```
Sub Macro1()
'
' Macro1 Macro
'

'
    Sheets("Sheet1").Select
    Sheets("Sheet1").Name = "My Sheet"
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Sheet5").Select
    Sheets("Sheet5").Name = "My Sheet 2"
End Sub 
```

您可以记录非常复杂的操作并操作生成的代码并将其置于特定事件之后。因此，如果您希望代码在工作表加载或工作表激活时触发，您可以将其插入相关块中：即

```
'in Sheet1 - code behind (alt+F11 shortcut)
Private Sub Worksheet_Activate()
    Sheets("Sheet1").Select
    Sheets("Sheet1").Name = "My Sheet"
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Sheet5").Select
    Sheets("Sheet5").Name = "My Sheet 2"
End Sub 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:25:55.823

另一种方法是使用 INDIRECT 公式。

假设您在单元格 A1 中有要从中查找输入的工作表的名称，那么以下内容将从该工作表中查找单元格 B7 的值：

```
=INDIRECT($A$1,"!B7") 
```

# actionscript - 任何 Flash 编译器都可以将脚本放在多个帧上吗？

> ID：574996
> 
> 赞同：1
> 
> 时间：2009-02-22T14:30:50.227
> 
> 标签：actionscript, compiler-construction, flash, haxe, mtasc

任何 Flash 编译器都可以将**特定脚本**放在Flash 电影 SWF 的特定**帧上吗？**

就像您可以在**Flash IDE中执行的操作一样，只需使用“****时间轴**”面板在所需帧上放置一个脚本，该脚本就会被编译为 Flash 电影 SWF 的该帧。

例如。第 1 帧上的脚本：

```
trace("Reached frame 1"); 
```

例如。第 2 帧上的脚本：

```
trace("Reached frame 2"); 
```

**SWF 编译器：（**有希望）

*   AS3 编译器 - [Haxe](http://haxe.org/)
*   AS2 编译器 - [MTASC](http://www.mtasc.org/)
*   Adobe Flex 编译器 - [Mxmlc](http://livedocs.adobe.com/flex/15/flex_docs_en/00000860.htm)
*   C# 到 SWF 编译器 - [Debreuil](http://blog.debreuil.com/archive/2004/08/18/376.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-06T12:16:37.937

MXMLC 是可能的，尽管它没有很好的文档记录。

[Google 搜索 Flex Frame 元数据](http://www.google.ca/search?q=flex+frame+metadata)会显示代码。一点点试验和错误，你应该能够得到一些工作。（这就是 flex 预加载器的工作原理）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T15:40:00.530

据我所知，您提到的编译器都没有管理基于时间线的执行。但是[swfmill](http://www.swfmill.org/doc/using-swfmill.html)在这里可能会有所帮助。我建议您编译自己的二进制文件，因为预编译的二进制文件已经过时并且缺少重要的修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-22T22:08:02.657

MTASC 和 Haxe 都允许您将代码“注入”到现有 swf 的特定框架中。通常的过程是使用包含所有资产的 SWFMill 创建一个库 swf。之后，您将使用任一编译器的代码注入到该 swf 中，从而生成一个新的 swf。

将代码注入第 1 帧后，尝试将代码注入第 2 帧作为下一步。理论上这应该有效。我自己没有尝试过，所以你可能想尝试一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T01:06:37.283

有一个小型 haxe 编写的 neko 工具，可让您构建多帧 swf：http: [//gamehaxe.com/2009/02/04/haxe-preloader-for-flash-written-in-haxe/](http://gamehaxe.com/2009/02/04/haxe-preloader-for-flash-written-in-haxe/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T10:31:13.807

也许你也可以看看未记录的功能

`addFrameScript(frameNumber,function,frameNumber,function...)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-07T21:08:34.730

在 FLEX sdk 中使用开源 ASC 怎么样，您可以使用它进行编译，然后将生成的 abc 封装到 DoAbc 标记中，并使用任何处理 swf 文件格式的库放入所需的框架中。*********