# StackOverflow 问答 10584000-10584999

# postgresql - plpgsql：使用 2 个 OUT 参数调用函数

> ID：10584002
> 
> 赞同：24
> 
> 时间：2012-05-14T13:10:26.210
> 
> 标签：postgresql, plpgsql

我正在尝试从具有 2 个 OUT 参数的 plpgsql 函数中获取值，但我遇到了一些问题。

这些是功能：

```
CREATE OR REPLACE FUNCTION get_test(OUT x text, OUT y text)
AS $$
BEGIN
   x := 1;
   y := 2;
END;
$$  LANGUAGE plpgsql;
----------------------------------------------------------------

CREATE OR REPLACE FUNCTION get_test_read()
RETURNS VOID AS $$
DECLARE
   xx text;
   yy text;
BEGIN

   SELECT get_test() INTO xx, yy;

   RAISE INFO 'x: <%>', xx;
   RAISE INFO 'y: <%>', yy;

END;
$$  LANGUAGE plpgsql; 
```

* * *

命令的输出：

> 选择 get_test_read();
> 
> 信息：x：<（1,2）
> 
> 信息：y：<>
> 
> get_test_read
> 
> * * *

所以这两个值都转到第一个参数。我找不到一些关于如何调用这样的函数的例子。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-14T13:37:02.450

由于您有 2 个`OUT`参数，因此您的函数将返回一个[记录](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-SQL-ONEROW)。

为了获取所有值，您应该使用函数作为数据源并将其放入`FROM`子句中，如下所示：

```
SELECT * FROM get_test() INTO xx, yy; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-10-17T20:46:39.150

```
SELECT * INTO xx, yy FROM get_test(); 
```

**更新：**

解释：

修改第二个函数：

```
CREATE OR REPLACE FUNCTION get_test_read()
RETURNS VOID AS $$
DECLARE
   xx text;
   yy text;
BEGIN

   SELECT * INTO xx, yy FROM get_test();

   RAISE INFO 'x: <%>', xx;
   RAISE INFO 'y: <%>', yy;

END;
$$  LANGUAGE plpgsql; 
```

这类似于带有 TABLE 的 SELECT INTO，其中仅获得 2 个值：

```
SELECT "FIELD1", "FIELD2" INTO variable1, variable2 FROM "TABLE" WHERE ... 
```

[Npgsql 基本用法](https://www.npgsql.org/doc/basic-usage.html?q=stored%20procedure)

[PL/pgSQL 函数参数模式：IN、OUT、INOUT](https://www.postgresqltutorial.com/plpgsql-function-parameters/)

# php - 如何使用 PHP 和 MySQL 创建数据库？

> ID：10584003
> 
> 赞同：-1
> 
> 时间：2012-05-14T13:10:28.413
> 
> 标签：php, mysql, database, create-table

在这个`create`函数中，我试图创建一个数据库。但是，它无法创建并显示错误`Error creating database: Access denied.`因此，这意味着存在连接并且它通过了第一次检查。然后当`mysql_query`被调用时，它不会返回true。任何人都可以帮忙吗？

```
function create($dbName, $tbName, $fields, $types_sizes, $PK)
        {
            $sql = null;
            $con = mysql_connect("borg.cs.up.ac.za","username", "password");

            if (!$con)
            {
                die('Could not connect: ' . mysql_error());
            }
            else 
                {
                  if(mysql_query("CREATE DATABASE". $dbName, $con))
                    {
                        echo "Database created";
                        $dbExists = 1;
                    }
                   else
                    {
                        echo "Error creating database: " . mysql_error();
                        $dbExists = 0;
                    }
                   $i = 0;
                    if(($con)&&($bdExists = 1))
                    {
                        $sql . "CREATE TABLE " . $tbName . "(";
                        while($i < count($fields))
                        {
                            $sql . $fields[$i] . " " + $types_sizes[$i] . ",";
                            $i++;
                        }
                    if($PK != null)
                    {
                        $sql . "PRIMARY KEY (" . $PK .")";
                    }
                    }
                mysql_query($sql,$con);
                mysql_close($con);
            }
         } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-14T13:24:34.907

尝试这个。这是未经测试的。更改了代码中的一些行。

```
function create($dbName, $tbName, $fields, $types_sizes, $PK)
    {
        $sql = null;
        $con = mysql_connect("borg.cs.up.ac.za","username", "password");

        if (!$con)
        {
            die('Could not connect: ' . mysql_error());
        }
        else 
            {
    if(mysql_select_db($dbName))
                {
                    echo "Database selected";
                    $dbExists = 1;
                }
               else
                {
                    echo "Error creating database: " . mysql_error();
                    $dbExists = 0;
                }
               $i = 0;
                if(($con)&&($dbExists == 1))
                {
                    $sql = "CREATE TABLE " . $tbName . "(";
                    while($i < count($fields))
                    {
                        $sql .= $fields[$i] . " " + $types_sizes[$i] . ",";
                        $i++;
                    }
                if($PK != null)
                {
                    $sql .= "PRIMARY KEY (" . $PK .")";
                }
                }
            mysql_query($sql,$con);
            mysql_close($con);
        }
     } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T13:19:18.013

你没有在行中给空间

`if(mysql_query("CREATE DATABASE". $dbName, $con)),`**请在“创建数据库**” **->** “**创建数据库**”之后提供空格`.$dbname`，否则它将是数据库+名称组合。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-02-04T12:07:42.870

很简单，只要按照这两个步骤

```
$con = mysql_connect("localhost", "root", "password");

mysql_select_db("database_name", $con); 
```

# javascript - 如何使用 JavaScript 中的参数调用 Django 视图？

> ID：10584007
> 
> 赞同：1
> 
> 时间：2012-05-14T13:10:46.583
> 
> 标签：javascript, django

在用户对页面的外观进行一些修改（通过 JQuery）之后，我希望捕获并保存页面的状态（Django 模板 + 后端）。现在我已经使用 JS 变量获取了 innerHTML，我需要将它发送到将进行保存的 Django 视图。如何*调用*这个 Django 视图并将其传递给 JS 变量？

PS：关于stackoverflow的第一个问题，如果问题不清楚或格式不正确，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:38:06.927

最方便的入门方法是首先制作一个适当的表单和一个对其做出反应的 django 视图（“request.post”）。该表单应该包含您在页面中更改的任何内容的字段。

接下来，使用 jquery.ajax 从您的页面提交该表单的变量。

所以这个想法是隔离各种问题：

*   表单参数应该是什么？

*   获取一个运行实际更改的视图。

*   让javascript工作。

# r - 贝叶斯线性回归模型预测的置信区间

> ID：10584009
> 
> 赞同：4
> 
> 时间：2012-05-14T13:10:49.157
> 
> 标签：r

我在看[一篇关于贝叶斯线性回归（MHadaptive）的优秀帖子](http://www.r-bloggers.com/general-bayesian-estimation-using-mhadaptive/)

给出后置可信区间的输出

```
BCI(mcmc_r)
#              0.025       0.975
# slope       -5.3345970   6.841016
# intercept    0.4216079   1.690075
# epsilon      3.8863393   6.660037 
```

我现在使用什么函数来构建具有这些参数的置信区间的模型？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T19:48:23.290

为什么不使用从 MCMC 获得的分布来预测`y`任意点的分布`x`？在您使用的示例中，以下是相关部分，其中 eggmass = y 和 length = x

```
##@  3.1  @##

## Function to compute predictions from the posterior
## distribution of the salmon regression model
predict_eggmass<-function(pars,length)
{
    a <- pars[, 1]      #intercept
    b <- pars[, 2]      #slope
    sigma <- pars[, 3]  #error    
    pred_mass <- a + b * length 
    pred_mass <- rnorm(length(a), pred_mass, sigma)
    return(pred_mass)
}

###  --  ###
##@  3.2  @##

## generate prediction
pred_length <- 80     # predict for an 80cm individual
pred <- predict_eggmass(mcmc_salmon$trace, length=pred_length)
## Plot prediction distribution
hist(pred, breaks=30, main='', probability=TRUE)

## What is the 95% BCI of the prediction?
pred_BCI <- quantile(pred, p=c(0.025, 0.975))
    2.5%    97.5% 
33.61029 43.16795 
```

我认为您在评论中提到的分布可在此处获得`pred`，置信区间为`pred_BCI`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-16T01:31:00.917

如果要查看每个参数的后边际密度，可以使用`density()`存储在对象`trace`组件中的样本`mcmc_r`。

```
library(MHadaptive)
data(mcmc_r)

BCI(mcmc_r)
#              0.025    0.975   post_mean
# a       -6.6113522 7.038858 0.001852978
# b        0.2217377 1.543519 0.902057671
# epsilon  3.8094802 6.550360 4.957292114

head(mcmc_r$trace)
#           [,1]      [,2]     [,3]
# [1,] 3.1448136 0.7211228 5.449728
# [2,] 2.2287645 0.7155189 4.602004
# [3,] 2.0812509 0.8035820 4.224071
# [4,] 1.2444855 0.8448825 4.737466
# [5,] 3.2765630 0.5947548 4.740052
# [6,] 0.4271876 0.9014841 5.333821

plot(density(mcmc_r$trace[,3]), main=mcmc_r$par_names[3]) 
```

![在此处输入图像描述](../Images/58b53e34e8350b60f2fdd127acae4774.png)

# c# - 需要一些项目建议

> ID：10584011
> 
> 赞同：2
> 
> 时间：2012-05-14T13:10:52.607
> 
> 标签：c#, xml

我将做一个项目任务作为 C# 编程课程的最后一部分，我选择做一个媒体库来存储 DVD 电影收藏的信息。我需要一些建议是关于如何保存这些信息，因为该任务应该通过使用简单的文本文件而不是更好的数据库来解决。

所以，这是保存这些信息的最佳方式，以便能够添加、编辑和允许搜索标题和演员，还可以按类型排序，以提及我对这个程序的一些想法。

我是否应该通过在文件末尾为每部电影连续添加标题、年份、播放时间、导演、演员 1、演员 2、演员 3、流派、等级、评论来保存信息？我可以在文件中搜索还是应该以某种方式首先将其全部读入一个数组，然后执行 serach 并可能再次编辑并保存完整的文件？

还是像这样使用 XML 更好：

```
<movie_collections>
<movie>
<title=Tron Legacy"></title>
<year=2010></year>
<playtime=120></playtime>
etc.
</movie>
</movie_collections> 
```

如果我使用 XML，我可以搜索标题并加载或编辑该部分吗？还有比这些更好的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:14:56.003

您可以将数据存储在 XML 文件中。XML 文件可以存储类似于数据库表的数据。您可以添加多条记录、分层数据等...您可以使用**LINQ to XML**轻松查询数据。

如果你不想使用`LINQ to XML`，你可以使用如此典型`XMLDocument`的来处理 XML 数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T13:16:03.210

也许你的水平太低了。该文件实际上只是为了持久性，而不是将您自己的数据库实现为文件。

只需实现您所追求的对象并将其序列化为 imo。

```
public class MovieCollections
{
    private ICollection<Movie> Movies {get; set;}
    // etc...
}

public class Movie
{
    public string Title {get; private set;}
    public int PlayTime {get; private set;}
    public DateTime ReleaseDate {get; private set;}
} 
```

序列化 MovieCollections 的实例。可能保留`MovieCollections`为 Singleton 实例，因为您只需要一个集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:46:26.693

**正如@M_Affifi 建议的那样，通过驻留在内存中**的对象（例如，MovieCollections 类的实例和 Movie 类的实例）、XML 文件，考虑您与数据的所有交互（例如，排序、添加、查找、删除、更新等）仅用于存储对象的状态，因此下次运行应用程序时可以使用该数据。

完成对数据的操作后，只需将其序列化为 XML。序列化只是将您的对象转换为您可以存储或传输的格式的过程，在这种情况下将转换为 XML。看看[这个参考](http://support.microsoft.com/kb/815813)，你的序列化需求是非常基本的，所以你只需要几行代码。

```
System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(YourObject.GetType());
      x.Serialize(Console.Out, YourObject) 
```

最后，我建议考虑您的应用程序逻辑。当程序启动时，您可能想要检查您的 Movies.xml 是否存在，如果存在，则“反序列化”它，这意味着将其从 XML 加载到您的对象集合中。如果 XML 文件不存在，则只需开始操作您的对象，完成后选择 Save(Serialize)。如果需要，我可以帮助进行序列化/反序列化过程。

希望这会有所帮助；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T13:20:04.817

顺便说一句，这似乎是一个非常普遍的问题，也是一个非常常见的家庭作业问题！！

我认为你应该为此谷歌，你会得到更好的项目想法。

这行类似的东西：

1\. [C# 中使用 Microsoft Access 的简单电影数据库](http://www.codeproject.com/Articles/24043/Simple-Movie-Database-in-C-using-Microsoft-Access)
2.[创建电影数据库应用程序](http://www.asp.net/mvc/tutorials/older-versions/movie-database/create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-cs)
3\. [imdbapi](http://imdbapi.codeplex.com/)
& finally
4\. [SO 的类似帖子](https://stackoverflow.com/questions/10371120/imdb-movie-database)

就数据库和 XML 之间的比较而言，我确实向您推荐了一个数据库，因为就此类项目而言，考虑到了 XML 的几个优点。

# xml - 如果我们传递整个属性（//@lang），有什么方法可以显示完整的 xpath？

> ID：10584012
> 
> 赞同：0
> 
> 时间：2012-05-14T13:11:00.200
> 
> 标签：xml, powershell, xpath, powershell-2.0

如果我们通过给定名称的 select all 属性，是否可以通过 powershell 获取整个 xpath？

我的 xml 文件有一个名为 lang 的属性。我用 //@lang 来查找属性值。

如果我能获得完整的 xpath [如 /root/child/@attribute ），它将避免混淆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:40:06.787

不。

.NET 没有“给定一个节点，创建一个 XPath 表达式”功能。虽然在理论上这很容易（迭代到父级，获取每个级别的兄弟级的基数来创建`/node[n]/node[n]/...`）在实践中这样的 XPath 表达式是无用的，因为它们与特定的文档相关联。

另一个匹配模式的文档可能在每个级别具有不同数量的子级，并且可能具有不同的顺序；这样的 XPath 将找不到等效节点。

考虑：

```
<root>
 <child1 attr1='foo'/>
</root> 
```

和

```
<root>
 <child1 attr1='bar'/>
 <child1 attr1='foo'/>
</root> 
```

从第一个文档生成的表达式`/root/child1[1]/@attr1`将在第二个文档中找到一个不同的——尽管相似的——节点。

# erlang - 为什么这个模式不匹配

> ID：10584014
> 
> 赞同：3
> 
> 时间：2012-05-14T13:11:13.433
> 
> 标签：erlang

嗨，我是 Erlang 的新手，并在模式匹配中尝试了以下代码。正如预期的那样，它对我不起作用，请有人帮助我更好地理解这个概念

```
1> Prat = {name,{{first,prat},{last,redy}},{age,23},occupation,{{company,"TS"},{work, "SW"}}}
2> {_,{_,_},_,_,{{_,c},_}} = Prat 
```

但它返回给我无与伦比的错误。请帮助我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T13:19:44.033

在这个表达式中，`"{_,{_,_},_,_,{{_,c},_}} = Prat"`, c 是一个变量，应该大写。 `{_,{_,_},_,_,{{_,C},_}} = Prat`.

C = "TS"。

# junit - tfs中的junit测试结果

> ID：10584017
> 
> 赞同：2
> 
> 时间：2012-05-14T13:11:30.083
> 
> 标签：junit, nunit, mstest, xunit

如何让 TFS 2010 显示由第三方工具生成的 junit 测试结果？如果不能，可能有一种方法可以将 junit 报告转换为 xunit/nunit/mstest 报告。也会很棒！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:21:36.003

为了在 TFS-Build 期间发布 Junit 测试，您可以使用[TFS Build Extension Power Tool](http://visualstudiogallery.msdn.microsoft.com/2d7c8577-54b8-47ce-82a5-8649f579dcb6/)。
在那里，您可以找到一组从 JUnit 输出到 TRX 的 XSLT 转换。使用 TFS-Build 上传 TRX 应该是可能的。

# c++ - 向下转换并同时从 const 转换为 non-const

> ID：10584018
> 
> 赞同：1
> 
> 时间：2012-05-14T13:11:33.317
> 
> 标签：c++, inheritance, casting

我在转换参数时遇到了一些问题：

我有这个结构：

```
class XMLCO 
{...};

class CO: public XMLCO 
{...}; 
```

而我的问题在于构造函数中的这个类：

```
class ProcessUnit
{
public:
    ProcessUnit( const CO& co );
private:
    NetComm _ipComm;
}; 
```

对象 _ipComm（NetComm 类型）需要使用 XMLCO 进行初始化，但在这个构造函数中，我只获得了一个继承 XMLCO 的 CO，所以我虽然可以在构造函数中进行某种向下转换：

```
ProcessUnit::ProcessUnit( const CO& co )
{
    CO temp = const_cast<CO>( co ); // to remove the const -- THIS LINE CAUSE THE PROBLEM (it gives me this error: the type in a const_cast must be a pointer or reference to an object type 
    CO* ptrTemp = &temp; // to make it a pointer
    XMLCO* xmlcc = dynamic_cast<IOXMLDescCreationContext*>( ptrTemp );

    _ipComm = new IONetworkComm( *xmlcc );
} 
```

我想知道的是，是否有更简单的方法（不改变任何通用结构）或者我做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:26:58.760

> 需要使用 XMLCO 初始化对象 _ipComm（NetComm 类型），但是在这个构造函数中，我只得到了一个继承 XMLCO 的 CO，所以我虽然可以做一些向下转换

在你的情况下，你不能*放下*，只能*向上*。幸运的是，这个演员表是*隐式*的。因此，您无事可做。您可以分配：

```
CO temp = co; 
```

但是请注意，这会*复制*对象。这真的是你想要的吗？此外，删除`const`可能不仅没有必要，而且是错误的。即使您更正了代码中的语法，这仍然行不通。要正确诊断此问题，您需要发布其他定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:16:51.960

不要使用 a `const_cast`，因为这里没有必要 - 看起来您的问题与参数的常量性无关，因为*可能*`_ipComm`会通过. *`co`*

 *问题可能是构造函数`IONetworkComm`采用非常量对象。如果是这种情况并且这不是一个错误，那么它会告诉您有关设计的一些信息`IONetworkComm`- 即它需要从非常量对象初始化。也许您应该在`ProcessUnit`类的构造函数中反映这一点？也许应该是：

```
ProcessUnit( CO& co ); 
```*

# sql-server - 从 jar 文件运行程序时 jdbc 连接失败

> ID：10584019
> 
> 赞同：1
> 
> 时间：2012-05-14T13:11:33.087
> 
> 标签：sql-server, jdbc, jar, connection, deadlock

我有一个应用程序，我在其中使用 JDBC 连接。当我从 Eclipse 环境中运行它时，任何东西都没有问题，连接也没有。但是，当我将它打包成可执行的 jar 文件并从命令行运行它时，同时调用该行

```
DriverManager.getConnection(url, user, password); 
```

使用正确的凭据，应用程序将被冻结。（错误的登录尝试一切正常 - 抛出 SQLServerException）。我尝试使用不同的库选择创建 jar 文件，但结果是相同的。

任何人都可以帮忙吗？

我使用 sqljdbc4.jar 库

我的数据库类的构造函数：

```
public Database(String url, String user, String password) throws SQLException, ClassNotFoundException {
    Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");

    System.out.println("forname");
    connection = DriverManager.getConnection(url, user, password);
    System.out.println("get connection");
} 
```

正确登录后不会抛出异常，并且不会打印出“get connection”字符串（仅打印“forname”字符串）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T17:23:56.967

您使用的是 Java 6 更新 29 吗？如果是，请更新到 Java 6 Update 30 或更高版本（最好是最新版本：Update 32）。该 Java 版本中存在导致 Microsoft SQL Server JDBC 驱动程序挂起的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:14:56.653

“冻结”？您是否使用空的 catch 块捕获异常？

我敢打赌，当您在 Eclipse 中运行时，JDBC 驱动程序 JAR 位于 CLASSPATH 中，但在您运行可执行 JAR 时则不在。将 Class-Path 添加到您的 JAR 清单中，并将所有 JAR 与您的可执行 JAR 放在一起。那应该这样做。

# html - 覆盖溢出：隐藏

> ID：10584020
> 
> 赞同：13
> 
> 时间：2012-05-14T13:11:34.257
> 
> 标签：html, css, overflow

我有一个包含很多子元素的父容器。由于动画原因（子元素滑入和滑出父元素），我已将其`overflow`属性设置为`hidden`.

这很好用，但我确实希望有几个孩子在父母的范围之外可见。

我如何才能使只有某些孩子在父母的范围之外可见？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T13:28:19.197

答案是：你不能。要么父母有`overflow:hidden`然后所有的子元素都将被剪裁，或者你有`overflow:(visible|auto|scroll|...)`所有的孩子都根据该规则进行处理。您不可能混合州 - 所有孩子都受到平等对待。

但是，您可以在父级（不再具有溢出：隐藏）中引入额外的容器元素，就像在这个伪代码中一样：

```
<parent>    
   <container1 style="overflow:hidden">
      <!-- these will be clipped -->
      <element>
      <element>
   </container>

   <container2 style="overflow:visible">
      <!-- these will be shown -->
      <element>
      <element> 
   </container>
</parent> 
```

编辑：**[示例](http://jsfiddle.net/esUD2/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:13:46.373

**根据与 OP 的更多讨论，这个答案没有帮助。相反，请参阅评论以使用 OP 进行澄清。**

首先，如果您包含一些特定的代码，它会有所帮助。

一般而言，提供一个`CSS`比设置`overflow: hidden;`

例如，

**风格：**

```
.hide-children div {overflow: hidden;}
.hide-children div.show-me {overflow: none;} 
```

**HTML：**

```
<div class="hide-children">
    <div class="child"></div>
    <div class="child"></div>
    <div class="child show-me"></div>
</div> 
```

*但是就像我说的，只有在一些示例代码之后才能提供更有意义的答案。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-03T06:44:22.823

对我来说，我通过让父级溢出来解决它：隐藏更大，然后给周围元素负边距。

# php - Apache Mod php 文件夹到 php 获取

> ID：10584023
> 
> 赞同：0
> 
> 时间：2012-05-14T13:11:52.697
> 
> 标签：php, apache, mod-rewrite

我正在尝试实现一些 url 重写，但我有点迷失了..

我有一个重写规则，将 www.mysite.com/news/222 转换为 www.mysite.com/index.php?cat=news&id=222 这很好。

```
RewriteRule ^([a-z])/([0-9]+)$ /index.php?cat=$1&id=$2 
```

现在，即使可以直接访问脚本，我该如何重写，例如 www.mysite.com/index.php?cat=news&id=222，我如何将其重写为 www.mysite.com/news/222 ?

编辑：编辑因为我犯了一个错误，这是相反的方式大声笑对不起

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:19:01.987

是的，这确实有道理:)

无需添加其他规则，这会兼顾双方：它构建漂亮的 URL 并将变量传递给 PHP 脚本。

对于该位置，请尝试将 .htaccess 这条规则放在您在 VirtualHost 中定义的 DocumentRoot 文件夹中。

# c# - c#在没有dos/form窗口的情况下运行应用程序

> ID：10584025
> 
> 赞同：0
> 
> 时间：2012-05-14T13:11:59.297
> 
> 标签：c#

任何人都知道一种在不弹出窗口（表单或 dos 窗口）或将其作为应用程序放在任务栏的情况下运行 ac# 应用程序的方法。我希望它可以在任务管理器的进程选项卡或系统图标（在任务栏的右侧）中看到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:14:28.720

那么你需要创建一个 Windows 服务。

Visual Studio => 新项目 => Windows => Windows 服务

以下是更多信息：

*   [Windows 服务应用程序简介](http://msdn.microsoft.com/en-us/library/d56de412%28v=vs.80%29.aspx)
*   [如何：创建 Windows 服务](http://msdn.microsoft.com/en-us/library/9k985bc9%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:13:44.267

在 Windows 应用程序设置中，您可以为表单集

```
ShowinTaskbar = false; 
```

# iphone - iPhone：如何从数组中获取特殊字符

> ID：10584031
> 
> 赞同：1
> 
> 时间：2012-05-14T13:12:19.263
> 
> 标签：iphone, objective-c, ios5

假设我有一个数组如下：

```
shuffleArray = [[NSMutableArray alloc] initWithObjects:@"H",@"$",@"E",@"*",@"L",@"L",@"O", nil]; 
```

我只想从此数组中获取特殊字符

此外，在获取它们之后，我想从数组中删除这些特殊字符

我该怎么做？

任何帮助都将是可观的。

提前谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:26:05.767

试试这个，

```
NSMutableArray *shuffleArray = [[NSMutableArray alloc] initWithObjects:@"H",@"$",@"E",@"*",@"L",@"L",@"O", nil];
    NSLog(@"Letters Array%@",[shuffleArray filteredArrayUsingPredicate:[NSPredicate predicateWithBlock:^BOOL(NSString *evaluatedString, NSDictionary *bindings) {
              return [[evaluatedString stringByTrimmingCharactersInSet:[NSCharacterSet letterCharacterSet]] length]==0;

    }]]); 
    NSLog(@"Special Characters  Array%@",[shuffleArray filteredArrayUsingPredicate:[NSPredicate predicateWithBlock:^BOOL(NSString *evaluatedString, NSDictionary *bindings) {
        return [[evaluatedString stringByTrimmingCharactersInSet:[NSCharacterSet letterCharacterSet]] length]!=0;

    }]]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:28:14.077

```
NSMutableArray *shuffleArray = [[NSMutableArray alloc] initWithObjects:@"H",@"$",@"E",@"*",@"L",@"L",@"O", nil];
for(int i=0; i<[shuffleArray count];i++)
{
    unichar c = [[shuffleArray objectAtIndex:i] characterAtIndex:0];
    if (![[NSCharacterSet alphanumericCharacterSet] characterIsMember:c])
    {
        NSLog(@"%c",c);
        [shuffleArray removeObjectAtIndex:i];
        i--;
    }
} 
```

试过这个，它的工作原理。希望能帮助到你。快乐编码:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:17:31.943

您为此使用 NSPredicate ：

例子：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"memberNumber == %@", [NSNumber numberWithInt:memberNumber]];
NSArray *matchingMembers = [members filteredArrayUsingPredicate:predicate];

Customer *customer = [matchingMembers lastObject];
NSLog(@"%@", customer.name); 
```

[这](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)是 Apple 的文档链接。

[这](http://www.peterfriese.de/using-nspredicate-to-filter-data/)是另一种解释

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-14T13:26:37.593

您需要匹配特殊字符的正则表达式，此链接可能会对您有所帮助。

你的正则表达式是这样的“[^[A-Za-z][0-9]]”

[如何使用正则表达式在 iOS 中获取匹配项？](https://stackoverflow.com/questions/4184845/how-to-get-matches-in-ios-using-regular-expression)

# c# - 引入客户端 javascript 确认后 PostBackUrl 不触发

> ID：10584033
> 
> 赞同：0
> 
> 时间：2012-05-14T13:12:40.357
> 
> 标签：c#, visual-studio-2010, grid, telerik

我有一个有很多行的 Telerik 网格。我还有一个删除按钮：

```
<telerik:GridButtonColumn ButtonType="ImageButton" FilterControlAltText="Filter column column" UniqueName="GridButtonDelete" CommandName="Delete"> 
```

我最初在 PostBackUrl 中有代码。单击删除按钮后，我成功地转到了另一个页面，我做了我必须做的事情。但是，我决定添加客户端确认

```
(item["GridButtonDelete"].Controls[0] as ImageButton).OnClientClick = "return confirm ('OK to Delete?');"; 
```

添加确认后，删除按钮的 PostBackUrl 不会触发。
我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:17:02.727

我以前也遇到过这个问题。试试这个。

```
OnClientClick="if(!confirm('OK to Delete?'))return false;" 
```

# iphone - 在超类数组中初始化 UIViewController 子类？

> ID：10584038
> 
> 赞同：0
> 
> 时间：2012-05-14T13:13:16.240
> 
> 标签：iphone, objective-c, ios, xcode

这是我的设置。我`UIViewController`进行了一次子类化以创建一个“小部件”视图控制器，它可以处理我所有的小部件可以做的所有事情。然后，我为我的每个小部件子类化了小部件视图控制器，因为它们每个都处理自己独特且通常复杂的功能集。

我想创建一个小部件数组，将每个活动小部件存储在我的场景中，但是我在尝试弄清楚如何初始化正确的小部件以存储在数组中时遇到了麻烦。最初我认为我可以这样做 `[widgets addObject:[[Widget alloc] initWithNibName:widgetName bundle:nil]];`，但是这完全忽略了单个小部件 initWithNibName 函数并直接进入抽象的 Widget 类（这是有道理的，因为这是我将其加载到的类......）。

如何将我的类正确加载到这个数组中，每个小部件都由其自己的唯一子类初始化？如有必要，也可以随意推荐结构更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:37:56.197

如果类名与笔尖相同

```
NSArray* widgets = [NSArray arrayWithObjects: @"MyVC1",@"MyVC2",nil];

NSString* newVC = [widgets objectAtIndex: value];

Class classVC = NSClassFromString(newVC);

Widget* controller = [[classVC alloc] initWithNibName:newVC bundle:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:24:45.967

好吧，而不是这样：

```
[widgets addObject:[[Widget alloc] initWithNibName:widgetName bundle:nil]]; 
```

你可以这样做：

```
MySpecifc *mySpecificWidget = [[MySpecifc alloc] initWithNibName:widgetName bundle:nil];
[widgets addObject:myWidget]; 
```

我的问题是，它`NSMutableArray`存储在哪里？

Myabe 有一个[单身](https://stackoverflow.com/questions/8796529/singleton-in-ios-5)人士，所以你可以跟踪他们？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:29:29.927

我有一个类似的问题，我在“抽象”小部件类中使用这样的函数解决了这个问题：

```
+ (Widget)InstanceFor(widgetType)type {
    switch(type) {
        case widgetTypeWidgetOne:
            return [[WidgetOne alloc] initWithNibName:@"WidgetOneName" bundle:nil] autorelease];
            break;
        case widgetTypeWidgetTwo:
            return [[WidgetTwo alloc] initWithNibName:@"WidgetTwoName" bundle:nil] autorelease];
            break;
    }
} 
```

widgetType是**这样**的：

```
typedef enum {
    widgetTypeOne,
    widgetTypeTwo
} widgetType; 
```

因此，您可以将 Widget 对象存储在数组中，并在需要时进行转换。当你想初始化一个小部件时，你可以这样做：

```
[widgets addObject:[Widget InstanceFor:widgetTypeWidgetOne]]; 
```

# javascript - jQuery 中的 focusin/focusout 与 focus/blur 有什么区别？

> ID：10584042
> 
> 赞同：10
> 
> 时间：2012-05-14T13:13:33.347
> 
> 标签：javascript, jquery

我正在使用以下代码和[jQuery 1.7.2](http://code.jquery.com/jquery-1.7.2.js)处理一些事件：

```
$().on('focus blur', function(event) {
  console.log(event.type);
}); 
```

而且我注意到，`event.type`对于这两个事件，都会打印出：`focusin`和`focusout`.

`focusin/focusout`vs 和有什么不一样`focus/blur`？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T13:15:01.867

**简短的回答：`focusin`    泡沫，`focus`没有。**
        **`focusout` 泡沫，`blur`   没有。**
阅读[**文档**](http://api.jquery.com/focusin/)：

> 当某个元素或其中的任何元素获得焦点时，focusin 事件将发送到该元素。这与焦点事件不同，它支持检测父元素上的焦点事件（换句话说，它支持事件冒泡）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T13:15:18.703

从[文档](http://api.jquery.com/focusin/)：

> 当某个元素或其中的任何元素获得焦点时，focusin 事件将发送到该元素。这与焦点事件不同，它支持检测父元素上的焦点事件**（换句话说，它支持事件冒泡）**。

是的，您也可以在这里找到相同的答案：[JavaScript/jQuery 事件“focus”和“focusin”之间的区别？](https://stackoverflow.com/questions/7311143/difference-between-the-javascript-jquery-events-focus-and-focusin)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T13:14:42.537

当某个元素或其中的任何元素获得焦点时，focusin 事件将发送到该元素。这与焦点事件不同，它支持检测父元素上的焦点事件（换句话说，它支持事件冒泡）。

[资源](http://api.jquery.com/focusin/)

# c# - c# socket server - 部署、启动、停止

> ID：10584047
> 
> 赞同：2
> 
> 时间：2012-05-14T13:13:47.253
> 
> 标签：c#, sockets

当谈到在线部署套接字服务器时，我有点困惑。

在本地运行很好，因为大多数教程都会让您制作一个我可以执行的服务器应用程序和一个客户端应用程序。现在做了一段时间，我对它很满意，但现在我想使用虚拟主机尝试它。

如何将套接字服务器部署到我的 Web 主机然后运行服务器？我是否只是将程序上传到服务器并运行 www.mywebpage.com/mysocketserver（假设程序称为 mysocketserver.exe）

可能听起来像一个愚蠢的问题，但我有一个脑死的时刻。

[编辑] 很好的答案，谢谢。不好意思，我只能标记一个作为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:26:25.550

大多数托管服务与网站相关：您将网站上传到他们的服务器，主机负责配置应用程序。

但是，您还没有编写由 Web 服务器提供服务的网站，而是一个套接字服务器，它更类似于运行网站的 Web 服务器本身。

因此，您将需要一台允许您安装和运行应用程序的主机，例如[虚拟专用服务器](http://dreamhost.com/servers/vps/)服务、租用[物理服务器](http://www.rackspace.com/managed_hosting/managed_colocation/)或使用[Amazon EC2](http://aws.amazon.com/ec2/)等云服务。

您通常将远程桌面或 SSH 连接到您租用（或拥有）的服务器，以将应用程序作为普通应用程序、服务或守护程序上传和启动。

在主机服务器上安装套接字服务器并启动运行的应用程序后，您应该能够使用服务器的 IP 地址和运行套接字服务器的端口来联系您的服务。

例如，如果您的 ip 地址是 10.0.0.1，并且您已经编写了套接字服务器以侦听端口 1234，那么您应该能够通过地址 10.0.0.1:1234 联系您的服务。

考虑允许访问该端口的防火墙。

然后，您还可以使用 DNS 服务（例如[DynDns](http://dyn.com/dns/)）将域名分配给该 IP 地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:25:39.693

除非您的套接字服务器使用 HTTP 作为协议，否则您不能这样做。

您正在为您的服务器使用端口，对吗？这些端口用于识别要与哪个应用程序通信。

当您使用“”浏览网页时，您真的说让我使用端口（为 HTTP 注册）`http://something`获取可以在 IP `1.2.3.4`（DNS 查找）上找到的内容。`80`您不必在浏览器中指定端口，因为所有浏览器都知道 HTTP 使用端口 80。

所以你真正应该做的是将套接字服务器放在你的主机上，并告诉你的客户/用户他们可以在主机“ `www.mywebpage.com`”上的端口 XXX 连接到你的套接字服务器。

如果您已经构建了一个客户端，您只需在其中硬编码端口或自动指定默认端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:20:25.830

Internet 中的问题是路由/名称转换，因此 mywebpage 被转换为正确的 IP 地址。
您的网络服务器需要一个固定的公共 IP 地址，或者您需要使用像 dynds 这样的服务，它将您不断变化的 IP 地址动态映射到静态名称。

# java - GWT 垂直菜单

> ID：10584048
> 
> 赞同：2
> 
> 时间：2012-05-14T13:13:57.293
> 
> 标签：java, gwt

我需要一些关于谷歌网络工具包的帮助来制作一个带有扩展子菜单项的垂直菜单。

我想创建一个垂直菜单，就像[GWT 展示柜上的左侧菜单一样](http://gwt.google.com/samples/Showcase/Showcase.html)

我试过这个：

```
VerticalPanel vertpanel = new VerticalPanel();
MenuBar menubar = new MenuBar(true);//set to true so its set to vertical alignment
MenuBar subbar = new MenuBar(true);
MenuBar subbar2 = new MenuBar(true);
subbar.addItem("Fist item of submenu1", new AddEmployeeCommand());
subbar.addItem("Second item of submenu1", new AddEmployeeCommand());
subbar2.addItem("First item of submenu2", new AddEmployeeCommand());
subbar2.addItem("Second item of submenu2", new AddEmployeeCommand());
menubar.addItem("sub 1", subbar);
menubar.addItem("sub 2", subbar2);
vertpanel.add(menubar);
RootPanel.get().add(menubar); 
```

但这不起作用，因为菜单项不会展开以显示其子项。虽然当我将它设置为水平菜单栏时它可以工作，但这不是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:20:48.200

您需要使用`DisclosurePanel`s 来实现这一点。

[在GWT 展示](http://gwt.google.com/samples/Showcase/Showcase.html#!CwDisclosurePanel)中查看它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:21:11.023

那可能是使用 DosclosurePanel，而不是菜单栏。

[http://gwt.google.com/samples/Showcase/Showcase.html#!CwDisclosurePanel](http://gwt.google.com/samples/Showcase/Showcase.html#!CwDisclosurePanel)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:31:39.530

也许你可以看看`StackPanel`

[Gwt Stackpanel 展示](http://gwt.google.com/samples/Showcase/Showcase.html#!CwStackPanel)

# build - 如何加快全球团队的构建下载速度？

> ID：10584059
> 
> 赞同：0
> 
> 时间：2012-05-14T13:14:25.187
> 
> 标签：build, download, continuous-integration, scalability, scaling

我正在与一个全球分布的开发团队合作，该团队必须跨地理和海洋下载我们的软件版本。我们的构建输出大小为 GB，中国的开发人员需要一段时间才能从我们在美国的服务器获取内容。

我的团队可以做些什么来帮助加快这个过程？我有一些想法（镜像，仅下载增量更改，P2P），但希望了解其他团队如何解决此问题。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:46:43.110

最好的方法是使用代理服务器。TFS 使用开箱即用的代理服务做得很好。

![TFS 代理](../Images/c8d2592a9f8d311be9fe3e3316bd844f.png)

您可以考虑在镜像 FTP 上发布您的工件或使用 3rd 方代理解决方案，例如 [WinGate](http://www.wingate.com/)。

# android - 无法使用广播接收器启动服务

> ID：10584064
> 
> 赞同：0
> 
> 时间：2012-05-14T13:14:33.223
> 
> 标签：android, android-intent

我想通过此代码使用 BroadcastReceiver 启动服务

```
public void onReceive(Context context, Intent intent) {

    Intent myIntent = new Intent(context,BlueToothService.class);   

    context.startService(myIntent);

} 
```

但无法启动服务。我还在清单中注册了服务和接收者。

而且我还有一个疑问，我们可以在没有活动的情况下使用广播接收器吗？

这是我的服务班

```
public class BlueToothService extends Service {

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void onStartCommand(Intent intent, int startId) {

    super.onStart(intent, startId);
    Toast.makeText(this, "service Started", Toast.LENGTH_LONG);
    doBluetoothJob();

} 
```

我的清单文件看起来像这样。

```
<uses-permission android:name="android.permission.BLUETOOTH" />
    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
    <uses-permission android:name="android.permission.BROADCAST_SMS" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
    </application>

    <service
        android:name=".BlueToothService"
        android:enabled="true" >
    </service>

    <receiver android:name="com.simsys.bt.DemoBT" >
    </receiver>

    <intent-filter>
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:00:28.947

这与我一起工作，我创建了一个接收器。

```
public class MyReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
        Toast.makeText(context, "MyReceiver Started", Toast.LENGTH_SHORT).show();
        Intent myIntent=new Intent(context,MyService.class);        
        context.startService(myIntent);
    }
} 
```

* * *

然后创建一个简单的服务

```
public class MyService extends Service {

    @Override
    public IBinder onBind(Intent intent) {      
            return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId){
        Toast.makeText(getBaseContext(), "Service Started", Toast.LENGTH_SHORT).show();
        // We want this service to continue running until it is explicitly
        // stopped, so return sticky.
        return START_STICKY;
    }
} 
```

* * *

不要忘记在清单文件中为广播接收器和服务创建条目

```
<application android:icon="@drawable/icon" android:label="@string/app_name">        
<service
    android:enabled="true"
    android:name=".MyService">
    <intent-filter>
        <action
            android:name = "com.rdc.MyService">
        </action>
    </intent-filter>
  </service>
  <receiver
    android:enabled="true"
    android:name=".MyReceiver">
    <intent-filter>
        <action android:name = "android.intent.action.BOOT_COMPLETED"/>
    </intent-filter>
  </receiver>
</application> 
```

现在重新启动后，模拟器 Toast 将出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:52:40.550

您发布的清单文件格式不正确。`<service>`和`<receiver>`标签需要在标签**内**。`<application>`像这样：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <service
        android:name=".BlueToothService"
        android:enabled="true" >
    </service>
    <receiver android:name="com.simsys.bt.DemoBT" >
    </receiver>
</application> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:34:07.080

您需要在 Service 子类中覆盖[onStartCommand()](http://developer.android.com/reference/android/app/Service.html#onStartCommand%28android.content.Intent,%20int,%20int%29)而不是 onStart() 。onStart() 已折旧，仍应调用它，但建议覆盖 onStartCommand() 并查看是否有效。

此外，在您的清单文件中，服务、接收者和意图过滤器标记应该是应用程序标记的子级。接收者还需要声明它将处理什么意图。例如

```
<receiver android:name="com.simsys.bt.DemoBT" >
    <intent-filter>
        <action android:name="com.simsys.bt.intents.StartService" />
    </intent-filter>    
</receiver> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:42:31.190

尝试用以下方式展示你的吐司：

```
Toast.makeText(this, "service Started", Toast.LENGTH_LONG).show(); 
```

您需要在清单中为服务声明提供一个特定的意图过滤器，其中包含您希望它监听的意图，例如：

```
<receiver android:name="com.simsys.bt.DemoBT" >
    <intent-filter>
        <action android:name="your.intent.action.definition" />
    </intent-filter>    
</receiver> 
```

# php - 我如何从 php 页面获取城市 ID

> ID：10584065
> 
> 赞同：0
> 
> 时间：2012-05-14T13:14:33.943
> 
> 标签：php

我正在为我的网站创建一个注册表单。在我的注册表单中，有两个选择框可以选择用户所在的地区和城市。所以我需要这样做，当用户选择他们的地区时，会自动显示城市选择框，其中包含与上述所选地区相关的城市。为此，我使用了 AJAX 和 PHP。我使用 findcity.php 页面在我的 register.php 页面中显示城市。我的问题是当我尝试从 register.php 页面获取城市 ID 时，我无法获取它。我需要将其他数据从 register.php 页面发送到数据库。

从我的 register.php 页面

```
<div>
<label for="district">District <img src="../images/required_star.png" alt="required" /> : </label>
<?php

    require_once ('../includes/config.inc.php');    
    require_once( MYSQL2 );

    $query="select * from district order by district_id";
    $result = mysqli_query( $dbc, $query);

        echo '<select name="district" class="text" onChange="getCity(' . "'" . 'findcity.php?district=' . "'" . '+this.value)">';
        echo '<option value="">-- Select District --</option>';

        while( $row = mysqli_fetch_array($result, MYSQLI_NUM)) { 
            echo '<option value="' . $row[0] . '"';

            // Check for stickyness: 
            if ( isset( $_POST['district']) && ( $_POST['district'] == $row[0] ))    
                echo ' selected="selected"';

                echo " >$row[1]</option>";    
        }
        echo '</select>';
?> 

</div>    
<div>
    <label for="city">City <img src="../images/required_star.png" alt="required" /> : </label>
    <input type="hidden" name="reg_locationid" id="reg_locationid" value="56" />
    <div id="citydiv" style="position: relative; top: -14px; left: 130px; margin-bottom: -26px;">
        <select name="city" class="text">
            <option>-- Select City --</option>
        </select>
    </div>
</div> 
```

这是 findcity.php 页面

```
<?php

$districtId=$_GET['district'];

require_once ('../includes/configaration.inc.php'); 
require_once( MYSQLCONNECTION );

$query="select city_id, city_name from city2 where district_id=$districtId";
$result=mysqli_query( $dbc, $query);

echo '<select name="city" class="text">
        <option>-- Select City --</option>';

while($row=mysqli_fetch_array($result, MYSQLI_NUM)) { 

    echo '<option value="' . $row[0] . '"';

    // Check for stickyness: 
    if ( isset( $_POST['city']) && ( $_POST['city'] == $row[0] )) { 
        echo ' selected="selected"';

        //echo '<input type="hidden" name="city"  value="' . $row[0] . '"'; 

    }
        echo " >$row[1]</option>";  

}

echo '</select>'; 
```

?>

这是我的 ajax 函数

```
function getXMLHTTP() { //function to return the xml http object
    var xmlhttp=false;  
    try{
        xmlhttp=new XMLHttpRequest();
    }
    catch(e)    {       
        try{            
            xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch(e){
            try{
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
            }
            catch(e1){
                xmlhttp=false;
            }
        }
    }

    return xmlhttp;
}

function getCity(strURL) {      

    var req = getXMLHTTP();

    if (req) {

        req.onreadystatechange = function() {
            if (req.readyState == 4) {
                // only if "OK"
                if (req.status == 200) {                        
                    document.getElementById('citydiv').innerHTML=req.responseText;                      
                } else {
                    alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                }
            }               
        }           
        req.open("GET", strURL, true);
        req.send(null);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:25:45.953

```
 echo '<select name="district" class="text" onChange="getCity(' .
      '\'findcity.php?district=\'+this.value+\'&city=\'' .
      '+document.getElementsByName(\'city\')[0].value)">'; 
```

或按照学习者的建议使用会话。

此外，如果您从 HTML 中提取 JavaScript，代码会变得不那么难看...

# android - 使用位图类的 Android 画廊

> ID：10584070
> 
> 赞同：0
> 
> 时间：2012-05-14T13:14:51.450
> 
> 标签：android

有人可以发布使用位图属性的android画廊示例。我是新手，所以无法弄清楚它是如何工作的。我有没有位图的画廊，这会导致内存错误。请发布不会导致内存错误的示例

错误日志是

```
05-14 15:33:25.336: E/AndroidRuntime(563): FATAL EXCEPTION: main
05-14 15:33:25.336: E/AndroidRuntime(563): java.lang.OutOfMemoryError
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:483)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.content.res.Resources.loadDrawable(Resources.java:1937)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.content.res.Resources.getDrawable(Resources.java:664)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.ImageView.resolveUri(ImageView.java:542)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.ImageView.setImageResource(ImageView.java:315)
05-14 15:33:25.336: E/AndroidRuntime(563):  at com.hospital.ImageAdapter.getView(ImageAdapter.java:46)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.Gallery.makeAndAddView(Gallery.java:844)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.Gallery.fillToGalleryRightLtr(Gallery.java:798)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.Gallery.fillToGalleryRight(Gallery.java:742)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.Gallery.layout(Gallery.java:651)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.Gallery.onLayout(Gallery.java:346)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.View.layout(View.java:11278)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.View.layout(View.java:11278)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.View.layout(View.java:11278)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.View.layout(View.java:11278)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.View.layout(View.java:11278)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.os.Looper.loop(Looper.java:137)
05-14 15:33:25.336: E/AndroidRuntime(563):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-14 15:33:25.336: E/AndroidRuntime(563):  at java.lang.reflect.Method.invokeNative(Native Method)
05-14 15:33:25.336: E/AndroidRuntime(563):  at java.lang.reflect.Method.invoke(Method.java:511)
05-14 15:33:25.336: E/AndroidRuntime(563):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-14 15:33:25.336: E/AndroidRuntime(563):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-14 15:33:25.336: E/AndroidRuntime(563):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:59:13.653

要修复 OutOfMemory，您应该执行以下操作：

```
BitmapFactory.Options options=new BitmapFactory.Options();
options.inSampleSize = 8;
Bitmap preview_bitmap=BitmapFactory.decodeStream(is,null,options); 
```

也看到这个

[https://stackoverflow.com/a/823966/985143](https://stackoverflow.com/a/823966/985143)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T10:39:29.960

查看开发者网站上添加的这个新资源：http: [//developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)（查看屏幕右侧的示例项目）

# database - 将 EF 中的 SaveChanges 与 MVC 一起使用时出现奇怪的错误消息

> ID：10584072
> 
> 赞同：1
> 
> 时间：2012-05-14T13:14:54.483
> 
> 标签：database, asp.net-mvc, linq, entity-framework, entity-framework-4

我有一个`dropdownlistfor`不来自我的数据库的值，当用户选择我的数据库中不存在的值时，我想将它保存到数据库中（如果它已经存在，我只使用现有数据）。

这适用于我的一些数据（请参阅代码以了解它不起作用的地方）

这是我的存储库：

```
 public void newPerson(Person addperson)
    {
        db.Person.AddObject(addperson);
        db.SaveChanges(); //This wont work
    } 
```

这是我的控制器：

```
[HttpPost]
    public ActionResult Create(CreateNKIphase1ViewModel model)
    {
        if (ModelState.IsValid)
        {
            var goalcard = new GoalCard();

            var companyChecker = "";
            var dbCompanies = createNKIRep.GetCustomerByName();
            var addcustomer = new Customer();
            foreach (var existingcustomer in dbCompanies)
            {
                companyChecker = existingcustomer.CompanyName;
                    if (existingcustomer.CompanyName == model.CompanyName)
                    {
                        var customerId = existingcustomer.Id;
                        var selectedCustomerID = createNKIRep.GetByCustomerID(customerId);
                        goalcard.Customer = selectedCustomerID;
                        break;
                    }
            }
            if (companyChecker != model.CompanyName)
            {
                addcustomer.CompanyName = model.CompanyName;
                createNKIRep.newCustomer(addcustomer); //This works!
                goalcard.Customer = addcustomer;
            }

            if (model.PersonName != null)
            {
                var Personchecker = "";
                var dbPersons = createNKIRep.GetPersonsByName();

                foreach (var existingPerson in dbPersons)
                {
                    Personchecker = existingPerson.Name;
                    if (existingPerson.Name == model.PersonName)
                    {
                        var personId = existingPerson.Id;
                        var selectedPersonID = createNKIRep.GetByPersonID(personId);
                        goalcard.Person = selectedPersonID;
                        break;
                    }
                }
                if (Personchecker != model.PersonName)
                {
                    Person newPerson = new Person();
                    newPerson.Name = model.PersonName;
                    createNKIRep.newPerson(newPerson);//Where repository is called
                    goalcard.Person = newPerson;
                }
            } 
```

但是当我尝试保存新的时，`Person`我收到以下错误消息：

> 将 datetime2 数据类型转换为 datetime 数据类型导致值超出范围。该语句已终止。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

即使我的数据库中`Person`只有`Id`和`name`作为属性。

我的代码有什么问题，还是我的数据库中的任何设置都必须更改？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T07:23:23.617

这是因为我`db.SaveChanges();`在一个中使用了多次`post`。减少我使用的时间`db.SaveChanges`帮助我摆脱了错误。

# android - 如何在等待来自服务器的 httpResponse 时使用 ProgressBar 显示微调器

> ID：10584078
> 
> 赞同：2
> 
> 时间：2012-05-14T13:15:01.650
> 
> 标签：android, progress-bar, android-asynctask, progressdialog

当应用程序对在线数据库进行查询时，我试图向用户显示加载图标。我尝试过使用 AnimationDrawable（我放弃了，因为不需要自定义图标）、ProgressDialog 和 ProgressBar。ProgressBar 似乎最合适，因为我不想要消息，只是一个旋转图标。但我什至不能让 ProgressBar 出现在屏幕上，不管我在哪里调用它。我的 ProgressDialog 出现在屏幕上，但它只出现在服务器响应之后，如果我使用 dismiss() 或 cancel() 它甚至根本不会出现。

我使用 AsyncTasks 或 Threads 取得了任何成功。

在应用程序中，有一个类 JogarActivity.java 尝试显示选项列表。它接收一些参数，如用户 id，并调用 UserFunctions：

public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState);

```
 setContentView(R.layout.jogar_layout);
    Intent in = getIntent();
    String url = this.getString(R.string.urlSite);
    ArrayList<HashMap<String, String>> respostaList = new ArrayList<HashMap<String, String>>();

    String idt = in.getStringExtra(TAG_ID);
    primeiraPergunta = in.getBooleanExtra(TAG_PRIMEIRAPERGUNTA, true);

    TextView insertPergunta = (TextView) findViewById(R.id.insertPergunta);
    ListView insertRespostas = (ListView) findViewById(R.id.listResposta);

    SharedPreferences settings = getSharedPreferences("PREFS_LOGIN", MODE_PRIVATE);
    Integer idUsuario = settings.getInt("idUsuario", 0);
    String idUser = idUsuario.toString();

    if (primeiraPergunta){
        UserFunctions userFunction = new UserFunctions();
        json = userFunction.getJogar(idt, idUser);
    }else{
        try {
            json = new JSONArray(in.getStringExtra(TAG_JSON));
            json = json.getJSONArray(2);
        } catch (JSONException e) {
            e.printStackTrace();
        }
    } 
```

下面是 userFunctions 中的 getJogar 函数： public JSONArray getJogar(String categoria, String usuarioId){ List params = new ArrayList();

```
 params.add(new BasicNameValuePair("categoria", categoria));
    params.add(new BasicNameValuePair("idUsuario", usuarioId));
    JSONArray json = jsonParser.getJSONFromUrl(perguntaURL, params);

    return json;
} 
```

JSONParser.java 是发出 httpRequest 的类： public JSONArray getJSONFromUrl(String url, List params) {

```
 // Making HTTP request
    try {
        // defaultHttpClient
        HttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();

        // json = EntityUtils.toString(httpEntity);
        // HttpEntity httpEntity2 = httpEntity;
        json = EntityUtils.toString(httpEntity);
        // is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } 
            //then makes the JSON manipulation 
```

只要 JSONParser 和 userFunctions 不是活动，我就不能在其中使用 ProgressDialogs（无法获取应用程序上下文）。所有服务器请求都在 JSONParser.java 中进行，这就是我首先尝试将 ProgressDialog/ProgressBar 放在那里的原因。

我所达到的最接近的是在 JogarActivity 中使用此代码（它显示 ProgressDialog，但在获得服务器的响应之后。如果我使用关闭，它甚至不会出现）

```
 final ProgressDialog loader = new ProgressDialog(JogarActivity.this);
    loader.show();
    //...the if-else code i've pasted above
    loader.dismiss(); 
```

即使使用 runOnUiThread 它也不起作用！我越来越没有选择...

感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T11:34:53.273

这有效：

```
public class RegisterActivity extends Activity{
EditText reg_fullname;
EditText reg_email;
EditText reg_login;
EditText reg_password;
EditText reg_password2;
Spinner reg_country;
Spinner reg_genre;
EditText reg_birthday;
EditText reg_promocode;
Button btnRegister;
Context ctx = this;
ProgressDialog pDialog;
JSONArray json;
String status;
String msg;

String fullname;
String email;
String login;
String password;
String password2;
String country;
String genre;
String birthday;
String promocode;

boolean finishActivity = false;

/**
 * @see android.app.Activity#onCreate(Bundle)
 */

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.register);

    TextView loginScreen = (TextView) findViewById(R.id.link_to_login);

    loginScreen.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {
                            // Closing registration screen
            // Switching to Login Screen/closing register screen
            finish();
        }
    });

    reg_fullname = (EditText) findViewById(R.id.reg_fullname);
    reg_email = (EditText) findViewById(R.id.reg_email);
    reg_login = (EditText) findViewById(R.id.reg_login);
    reg_password = (EditText) findViewById(R.id.reg_password);
    reg_password2 = (EditText) findViewById(R.id.reg_password2); //confirmação de senha
    reg_country = (Spinner) findViewById(R.id.reg_country);
    reg_genre = (Spinner) findViewById(R.id.reg_genre);
    reg_birthday = (EditText) findViewById(R.id.reg_birthday);
    reg_promocode = (EditText) findViewById(R.id.reg_promocode);

    btnRegister = (Button) findViewById(R.id.btnRegister);

    btnRegister.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {

            fullname = reg_fullname.getText().toString();
            email = reg_email.getText().toString();
            login = reg_login.getText().toString();
            password = reg_password.getText().toString();
            password2 = reg_password2.getText().toString();
            country = reg_country.getSelectedItem().toString();
            genre = reg_genre.getSelectedItem().toString();
            birthday = reg_birthday.getText().toString();
            promocode = reg_promocode.getText().toString();

            boolean validation = true;
            String message = "Campo de preencimento obrigatório";

            if(fullname.equalsIgnoreCase("")){
                reg_fullname.setError(message);
                validation = false;
            }
            if(email.equalsIgnoreCase("")){
                reg_email.setError(message);
                validation = false;
            }
            if(!email.matches(".*@.*")){
                reg_email.setError("O endereço de email não é válido");
                validation = false;
            }
            if(login.equalsIgnoreCase("")){
                reg_login.setError(message);
                validation = false;
            }
            if(password.equalsIgnoreCase("")){
                reg_password.setError(message);
                validation = false;
            }
            if(password2.equalsIgnoreCase("")){
                reg_password2.setError(message);
                validation = false;
            }
            if(!password.equals(password2)){
                reg_password2.setError("A confirmação de senha não confere");
                validation = false;
            }
            if(birthday.equalsIgnoreCase("")){
                reg_birthday.setError(message);
                validation = false;
            }
            SimpleDateFormat bd = new SimpleDateFormat("dd/MM/yyyy");
            if(bd.parse(birthday, new ParsePosition(0)) == null){
                reg_birthday.setError("Esta data não é válida! Preencha novamente, usando o formato dd/mm/aaaa");
                validation = false;
            }

            if(validation){
            new Register().execute();
            }

        }
    });

}

class Register extends AsyncTask<Void, Void, JSONArray>{

@Override
protected void onPreExecute() {
    super.onPreExecute();
    pDialog = new ProgressDialog(ctx);
    pDialog.setMessage("Aguarde...");
    pDialog.setIndeterminate(true);
    pDialog.setCancelable(false);
    pDialog.show();
}

@Override
protected JSONArray doInBackground(Void... params) {
    UserFunctions userFunction = new UserFunctions();
    json = userFunction.newUser(fullname, email, login, password, country, genre, birthday, promocode);

    return json;

}

protected void onPostExecute(JSONArray result) {
    // dismiss the dialog once done
    pDialog.dismiss();
    final AlertDialog alertDialog = new AlertDialog.Builder(
            RegisterActivity.this).create();

            try {
                status = json.getString(0);
                msg = json.getString(1);
                Log.d("Status", status);
            } catch (JSONException e) {
                Log.e("RegisterActiviry", "Error converting result " + e.toString());
                e.printStackTrace();
                status = null;
            }

            if (status.equalsIgnoreCase("erro")){
                alertDialog.setTitle("Erro");
                alertDialog.setMessage(msg);

            }else if (status.equalsIgnoreCase("sucesso")){
                alertDialog.setTitle("Sucesso!");
                alertDialog.setMessage(msg);
                finishActivity = true;
            }else{
                alertDialog.setTitle("Erro");   
                alertDialog.setMessage("Não foi possível realizar seu cadastro, tente novamente mais tarde.");
            }

            alertDialog.setButton("OK", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    if(finishActivity){
                    finish();
                    }else{
                        alertDialog.dismiss();
                    }
                }
        });

        alertDialog.show();

}

}

} 
```

# spring - Spring - 支付网关集成

> ID：10584082
> 
> 赞同：1
> 
> 时间：2012-05-14T13:15:10.933
> 
> 标签：spring, payment-gateway

我正在尝试为本地支付网关开发代理（即：用户将使用我们的系统进行支付，而真正的支付网关将被隐藏）。从我们的系统向支付网关发出呼叫的最佳方式是什么？我正在考虑开发服务并使用 httpclient（通过 ssl 发布方法）有什么想法吗？或示例代码？

系统可能会变得复杂，因为我有交易，http 调用将成为其中的一部分（调用支付网关，在本地插入数据，更新数据库中的一些其他记录......等等），我正在考虑开发一个特殊的日志来每当任何操作成功时更新它，如果不是我保存它并稍后通过 cron 处理它！这是一个好的架构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T07:27:16.277

回答你的问题太主观了。您所描述的基本上是*大多数*支付相关网站的构建方式。

至于支付网关，可以参考[http://git.springsource.org/spring-payment/spring-payment/trees/master](http://git.springsource.org/spring-payment/spring-payment/trees/master)。

您可以首先创建基本设计，即数据库结构等。完成后，您可以开始使用存根进行开发。这将帮助您验证与支付网关相关的假设。一旦完成并且一切正常，您就可以继续使用真正的支付网关。

同时，您可以亲自或在线访问支付网关提供商/银行，看看哪一个最适合您。当您获得许可并且所有手续都准备就绪时，您有望准备好您的系统。然后，您可以将您的系统与真正的支付网关集成。

# ruby-on-rails - 在 Ruby on Rails 中的控制器和视图之间传递模型

> ID：10584086
> 
> 赞同：1
> 
> 时间：2012-05-14T13:15:26.050
> 
> 标签：ruby-on-rails, ruby, model-view-controller

我的主屏幕上有注册表单。如果用户输入无效数据，我会将他重定向到`/signin`页面。在此页面上，我可以看到填充字段，但错误描述为空。

这是我的`UsersController`：

```
class UsersController < ApplicationController
  def new
    @user = User.new(params[:user])
  end

  def create
    @user = User.new(params[:user])
    print @user
    if  @user.save

    else
      render 'new'
    end
  end
end 
```

我用来显示错误的方法

```
module ApplicationHelper

  def errors_for(model, attribute)
    if model.errors[attribute].present?
      content_tag :div, :class => 'well error' do
        content_tag :ul do
          model.errors[attribute].collect {|item| concat(content_tag(:li, item))}

        end
      end
    end
  end
end 
```

我的表格部分：

```
<%= f.label :user_name %>
<%= f.text_field :user_name, :class=>"input-medium" %>
<%= errors_for(@user, :user_name) %>

<%= f.label :email %>

<%= f.text_field :email, :class=>"input-medium " %>

<%= errors_for(@user, :email) %>

<%= f.label :password %>

<%= f.password_field :password, :class=>"input-medium" %>

<%= f.label :password_confirmation, "Confirmation" %>

<%= f.password_field :password_confirmation, :class=>"input-medium" %> 
```

和我的注册视图：

```
<section class="centered user-form-container">
  <div class="user-form well pull-left">
    <div class="centered">
      <h1>Sign up</h1>
      <%= form_for(@user, :action=>"create") do |f| %>
          <%= render 'signup', :f=>f %>
          <%= f.submit "Sign up" %>

      <% end %>
    </div>
  </div>

</section> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:20:43.520

在这种情况下，我相信您需要使用`flash.now`，如下所示：

根据[Rails 文档](http://guides.rubyonrails.org/action_controller_overview.html#the-flash)：

> 默认情况下，将值添加到闪存将使它们可用于下一个请求，但有时您可能希望在同一个请求中访问这些值。例如，如果创建操作未能保存资源并且您直接呈现新模板，则不会导致新请求，但您可能仍希望使用 flash 显示消息。为此，您可以像使用普通 flash 一样使用 flash.now：

```
def create
  @user = User.new(params[:user])
  print @user
  if  @user.save

  else
    # start with this, then expand the error text
    flash.now[:error] = "Could not save user"
    render 'new'
  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:31:09.757

您将在您的验证方法中执行此操作。

如果您使用的是标准 rails 验证，您可以这样做：

```
validates_presence_of :foo, :message => 'Message you want to display here' 
```

如果您正在进行自定义验证，那么：

```
def my_validation_method
  begin
    my_validation_code_here
  rescue
    self.errors[:base] << 'Message you want to display here'
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T11:01:27.750

```
 def new
    @user = User.new(params[:user])
    if (!params[:user].nil?)
      @user.valid?
    end

  end 
```

# android - Twitter4j 缓存响应列表

> ID：10584095
> 
> 赞同：2
> 
> 时间：2012-05-14T13:15:50.403
> 
> 标签：android, json, caching, twitter4j, jtwitter

我已经制作了一个安卓应用程序好几个星期了，它几乎已经发布了，但我有一个问题。我需要能够缓存来自 twitter 的响应列表，例如使用 twitter4j 的朋友和搜索结果。我知道我可以使用可以缓存的 DataObjectFactory.getRawJSON() 获取响应列表的原始 Json，但是我无法找到将其转回响应列表的方法？

我也尝试使用 gson 来缓存结果，但这表示用户（响应列表）不可序列化并崩溃，我无法编辑用户，因为它在 .jar 中。

我更喜欢使用 rawJson 那么有没有办法将它转换回响应列表？我知道我可以获取用户的原始 json 并将其转换回用户，所以肯定有一种方法可以使用整个响应列表，而不仅仅是每个单独的用户或您正在使用的任何类型的响应列表？

任何帮助表示赞赏，我真的不想开始使用数据库或任何东西来缓存推特结果，并认为必须有一种方法来做我要求做的事情？

# jquery - jQuery 事件 - 元素变得可见

> ID：10584096
> 
> 赞同：14
> 
> 时间：2012-05-14T13:15:51.197
> 
> 标签：jquery, html, css

> **可能重复：**
> [当 div 可见时触发操作的 jQuery 事件](https://stackoverflow.com/questions/1225102/jquery-event-to-trigger-action-when-a-div-is-made-visible)

当由ajax加载的元素变得可见时（“显示”从“无”切换到“块”），我如何运行我的一些代码？好吧，我需要一些活动，比如

```
$('#element').live('show', function(){
// CODE
}); 
```

或监视删除/向元素添加某些类的事件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T07:31:10.747

问题已通过使用 jquery-appear 插件解决

[https://github.com/morr/jquery.appear](https://github.com/morr/jquery.appear)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:20:23.210

没有任何内置的 jQuery 可以让您实现这一目标。你可以看看[livequery 插件](http://docs.jquery.com/Plugins/livequery)。例如：

```
$('#element').livequery(function() {
    // CODE
}); 
```

当一个 id="element" 的元素被添加到 DOM 时，回调应该被执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T14:15:57.660

每 1 秒运行一次检查。如果`#element`存在并且可见，则清除（停止）间隔并执行您的代码。

```
var checkVisible = setInterval(function(){

    // if element doesn't exist or isn't visible then end
    if(!$('#element').length || !$('#element').is(':visible'))
        return;

    // if element does exist and is visible then stop the interval and run code

    clearInterval(checkVisible);

    // place your code here to run when the element becomes visible

},1000); 
```

不可避免地会有一些显示元素的 jQuery 事件回调；在这些事件回调中，您应该放置“当元素可见时”运行代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:17:33.863

你试过`jQuery.load()`吗？

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

它至少应该适用于图像、脚本标签等……但不适用于没有 URL 的元素。

否则，[livequery](http://docs.jquery.com/Plugins/livequery)应该会有所帮助：

[用于添加 dom 元素的 jquery 实时事件](https://stackoverflow.com/questions/3840149/jquery-live-event-for-added-dom-elements)

# facebook - 如何获取当前用户也使用我的应用程序的朋友列表？

> ID：10584097
> 
> 赞同：0
> 
> 时间：2012-05-14T13:15:55.130
> 
> 标签：facebook, facebook-graph-api, web-applications

我的要求是找到安装该应用程序的朋友列表。

在这里，我需要将输入作为应用程序 ID，基于此应用程序 ID，我需要获取已安装此应用程序的用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:19:34.673

比 avs099 的回答更快（单次调用）：

`/me/friends?fields=installed`使用该应用程序的访问令牌（或`/USER_ID/friends?fields=installed`应用程序访问令牌）进行 API 调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:48:10.107

这相对容易：

1.  [使用https://graph.facebook.com/me/friends](https://graph.facebook.com/me/friends)调用获取好友列表（您可以使用[Graph API Explorer](https://developers.facebook.com/tools/explorer/)）

2.  对于每个朋友，获取他的 ID 并向以下 Graph API 发送请求：[https ://graph.facebook.com/FRIEND_ID?access_token=APP_ID|APP_SECRET&](https://graph.facebook.com/FRIEND_ID?access_token=APP_ID|APP_SECRET&) **fields=installed**

注意：**fields=installed**是必需的，根据[文档](https://developers.facebook.com/docs/reference/api/user/)

如果你得到类似的东西

> {“已安装”：真，“id”：“FRIEND_ID”}

这意味着该朋友已安装该应用程序。如果只是 ID 回来了 - 那么他没有安装应用程序。

APP_ID 和 APP_SECRET 可以在您的应用页面上找到。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T18:15:44.753

我遇到了同样的问题，但在使用带有 FQL 的 Facebook API 时仍然有点模糊。Facebook FQL 页面几乎没有帮助，所以我继续写了一个快速的解决方案，供那些将来可能在这个问题上苦苦挣扎的人使用。

可以这么说，如果您使用的是 Facebook PHP SDK，那么长的 FQL 解决方案可以压缩成几行，这很高兴看到。 [我的 Facebook API 解决方案](http://www.crimson-cardinal.com/writings/technology/91-facebook-api-friends-with-my-app)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T22:34:11.033

如果你使用考拉，你可以这样做

在控制器 user.rb

```
@user = User.all 
```

在模型 user.rb

```
def friends_using_app
facebook { |fb| fb.get_connection("me", "friends?fields=installed") }
end 
```

在视图中

```
 <% friends = current_user.friends_using_app %>
 <% friends_using_app = friends.find_all {|x| x['installed'] == true}    %>
 <% friends_id = friends_using_app.map {|x| x['id']}  %>
 <% show_friends = @user.find_all{|x| x[:uid] = friends_id} %>
 <% show_friends.each do |x| %>
 <%= image_tag x.avatar %>
 <% end %> 
```

# android - 创建要包含在我的应用程序中的 android jar

> ID：10584103
> 
> 赞同：0
> 
> 时间：2012-05-14T13:16:10.100
> 
> 标签：android, eclipse, jar

我开发了一些像 Phonegap 这样的 android 应用程序。

我想制作一个 jar 文件并在另一个应用程序中使用它，就像我们使用 Phonegap 一样。包含 jar 并扩展 DroidGap。

但我无法制作罐子。

请让我知道如何使用eclipse创建jar？

非常感
谢斯内哈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:22:46.043

```
RightClick on your project -> Export -> type JAR in filter -> next -> finish 
```

干得好...

有关更多信息，请参阅此[链接](http://www.cs.utexas.edu/%7Escottm/cs307/handouts/Eclipse%20Help/jarInEclipse.htm)...

# bash - 如何查找和替换至少有一个字母且没有数字的项目？

> ID：10584105
> 
> 赞同：0
> 
> 时间：2012-05-14T13:16:29.087
> 
> 标签：bash, sed

我需要`-`用 `\texthyphen ' 替换文档中的所有 '，但前提是它至少由一个字母限定，无论是之前还是之后，但如果之前或之后恰好是一个数字，则不需要。例如：

*   `A-B`变成`A\texthyphen B`.
*   `a-b`变成`a\texthyphen b`.
*   `%-b`变成`%\texthyphen b`.
*   `%-%`不变，因为它不靠近任何字母。
*   `1-2`不变，因为它接近数字。
*   `A-2`不变，因为它接近一个数字。

如何将连字符替换为`\texthyphen`，但仅在字母旁边而不是数字旁边时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:28:17.343

```
sed -e 's/\([[:alpha:]]\)-\([^[:digit:]]\)/\1\\texthyphen \2/g' -e 's/\([^[:digit:]]\)-\([[:alpha:]]\)/\1\\texthyphen \2/g' -e 's/^-\([:alpha:]\)/\\texthyphen \1/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:53:39.840

我刚刚遇到可以处理类似 Perl 的正则表达式的`ssed`(super )。`sed`它应该在类似 Debian 的系统上可用，不确定其他系统。

```
$ echo '    A-B becomes A\texthyphen B.
    a-b becomes a\texthyphen b.
    %-b becomes %\texthyphen b.
    %-% is unchanged, because it is not near any letter.
    1-2 is unchanged, because it is near numbers.
    A-2 is unchanged, because it is near one number.' | \
> ssed -R 's/(?<=[A-Za-z])-(?![0-9])|(?<![0-9])-(?=[A-Za-z])/\\texthyphen /g' 
```

给

```
 A\texthyphen B becomes A\texthyphen B.
    a\texthyphen b becomes a\texthyphen b.
    %\texthyphen b becomes %\texthyphen b.
    %-% is unchanged, because it is not near any letter.
    1-2 is unchanged, because it is near numbers.
    A-2 is unchanged, because it is near one number. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T23:14:55.490

这可能对您有用：

```
sed 's/\([[:alpha:]]\)-\([^[:digit:]]\)\|\([^[:digit:]]\)-\([[:alpha:]]\)/\1\3\\texthyphen \2\4/g' file 
```

# performance - 在 Nopcommerce 上构建的电子商务网站的多个主机名上从 CDN 加载图像的挑战

> ID：10584112
> 
> 赞同：4
> 
> 时间：2012-05-14T13:16:56.940
> 
> 标签：performance, asp.net-mvc-3, optimization, nopcommerce

我正在开发一个建立在 Nop Commerce 2.3 之上的电子商务网站。我们想使用 CDN 加载所有静态内容，包括其图像，但不确定如何使用 NopCommerce 执行此操作。

Nopcommerce 设置为在插入产品时将图像的二进制文件保存在数据库中，然后在运行时根据需要生成拇指或调整大小/优化的图像，并将它们存储在同一应用程序的内容文件夹中以进行检索在加载期间在页面上。

现在，假设在某个页面上，比如主页，我们有 70 张产品图片。我想将它分布在四个主机名中，因此每个主机名将提供 17/18 个图像。

这绝对是为了节省一些图像加载时间。

现在的问题是：

如何在 NopCommerce 中以最佳方式做到这一点？

挑战是：

1.  更改 nop 商业代码以从 CDN 而不是其 application\content 文件夹加载图像。这不是问题，可以很好地管理。

2.  为了正确实现这一点，我们可能需要一些机制来检查 CDN 上的图像是否不存在，那么我们可能需要将图像从内容文件夹传输到 CDN 上的适当文件夹？（建议），如果内容文件夹中不存在，则需要先生成合适的图像，然后再传输。

我担心这第二个挑战，并想了解做到这一点的最佳方法。此外，如何做到这一点......专门检查图像是否存在于CDN中？

不是很确定，如何做到这一点？可以吗？或者你有别的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:20:16.190

如果您使用 OVH CDN，您只需将您的 dns 指向 CDN dns，将静态文件的扩展名添加到 CDN 配置中，然后让它为您工作。所有其他扩展都将通过。无需更改代码。

# php - 如何拆分包含多个工作表的 Excel 文件？

> ID：10584113
> 
> 赞同：2
> 
> 时间：2012-05-14T13:17:02.837
> 
> 标签：php, excel

我有包含几张工作表的 Excel 文件。如何拆分此文件以将每张工作表作为单独的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:19:15.080

在 PHP 中，您需要使用 phpExcel 之类的东西[来](http://phpexcel.codeplex.com/)打开电子表格，并将每个选项卡重写为一个新文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:43:36.153

使用[PHPExcel](http://www.phpexcel.net)库：

```
include 'PHPExcel.php';

$fileType = 'Excel2007';
$inputFileName = 'testExcel.xlsx';

$objPHPExcelReader = PHPExcel_IOFactory::createReader($fileType);
$objPHPExcel = $objPHPExcelReader->load($inputFileName);

$sheetIndex = 0;
$sheetCount = $objPHPExcel->getSheetCount();
while ($sheetIndex < $sheetCount) {
    ++$sheetIndex;
    $workSheet = $objPHPExcel->getSheet(0);

    $newObjPHPExcel = new PHPExcel();
    $newObjPHPExcel->removeSheetByIndex(0);
    $newObjPHPExcel->addExternalSheet($workSheet);

    $objPHPExcelWriter = PHPExcel_IOFactory::createWriter($newObjPHPExcel,$fileType);
    $outputFileTemp = explode('.',$inputFileName);
    $outputFileName = $outputFileTemp[0].$sheetIndex.'.'.$outputFileTemp[1];
    $objPHPExcelWriter->save($outputFileName);
} 
```

# c++ - fork() 2 个带有管道的子代，当 wait() 时出错

> ID：10584115
> 
> 赞同：1
> 
> 时间：2012-05-14T13:17:03.693
> 
> 标签：c++, fork, wait, pipeline

我有以下代码 fork() 的 2 个来自共同父级的子级，并在它们之间实现了管道。当我在父级中调用 wait() 函数时，只有程序完美运行。但是，如果我尝试调用 wait() 函数两次（从两个孩子那里收获），程序什么也不做，必须强制退出。

谁能告诉我为什么我不能在这里等两个孩子？

```
int main()
{
    int status;
    int pipeline[2];
    pipe(pipeline);

    pid_t pid_A, pid_B;

    if( !(pid_A = fork()) )
    {
        dup2(pipeline[1], 1);
        close(pipeline[0]);
        close(pipeline[1]);
        execl("/bin/ls", "ls", 0);
    }

    if( !(pid_B = fork()) )
    {
        dup2(pipeline[0], 0);
        close(pipeline[0]);
        close(pipeline[1]);
        execl("/usr/bin/wc", "wc", 0);
    }

    wait(&status);
    wait(&status);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:36:26.163

分叉子项后，您需要关闭父项中管道的两端。问题是输出`ls`到父级，并且`wc`正在等待输入。因此，第一个等待清除了`ls`，但第二个等待`wc`在未接收数据的管道上被阻塞。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T13:38:31.167

进程 B ( `wc`) 在其输入流上收到文件结尾之前不会终止。管道的另一端作为进程 A 的输出流和`pipeline[1]`父进程共享，因此您需要`close(pipeline[1])`在等待进程 B 之前进入父进程。

# c# - 在 Windows Phone 中实现标准视频播放器

> ID：10584121
> 
> 赞同：1
> 
> 时间：2012-05-14T13:17:38.617
> 
> 标签：c#, windows-phone-7

我正在编写一个能够播放视频的 Windows Phone 应用程序。我找到了很多自定义视频播放器，但我想了解一下，Windows Phone 中是否有标准视频播放器以及使用它需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:22:43.440

[http://msdn.microsoft.com/en-us/library/ff769551(v=VS.92).aspx](http://msdn.microsoft.com/en-us/library/ff769551(v=VS.92).aspx) MediaElement 是在 WP7 应用程序中播放视频文件的标准控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T14:17:08.910

`MediaElement`您可以在和的帮助下使用默认媒体播放器`MediaPlayerLauncher`。您可以播放本地视频和带有视频的网址。

我希望此链接对您有所帮助 * [http://www.developer.nokia.com/Community/Wiki/Video_Playback_with_MediaElement](http://www.developer.nokia.com/Community/Wiki/Video_Playback_with_MediaElement) *

# amazon-ec2 - 对于 AWS，如何使用 ruby aws-sdk 为资源设置标签？

> ID：10584123
> 
> 赞同：3
> 
> 时间：2012-05-09T07:12:16.197
> 
> 标签：amazon-ec2, amazon-web-services, ruby

我对使用 Amazon 的 ruby​​-sdk (gem install aws-sdk) 非常陌生，并且一直试图简单地为快照资源创建一个标签。这就是我正在做的事情：

```
ec2.tags.create(:resource_id => "snap-7d3aa701", :key => "My Test Tag", :value => "My test value")
ArgumentError: wrong number of arguments (1 for 2) 
```

注意，ec2 = AWS::EC2.new（在我设置了我的凭证之后）。

任何想法我做错了什么？我无法在网上找到一个使用 ruby​​ aws-sdk 进行标记的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T20:31:48.880

标记 EC2 资源的最简单方法是使用 #tags 方法：

```
ec2.snapshots["snapshot-id"].tags["tag"] = "value" 
```

如果您想要创建标签对象的句柄，您仍然可以使用 TagCollection#create 方法。它期望第一个参数是资源：

```
tag = ec2.tags.create(ec2.snapshots['snapshot-id'], 'tag') # no tag value

tag = ec2.tags.create(ec2.snapshots['snapshot-id'], 'tag', 'value') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T07:50:33.263

这可能只是由拼写错误引起的，第一个参数名称应该是`resource`而不是`resource_id`- 请参阅[AWS SDK for Ruby的](http://aws.amazon.com/sdkforruby/)[API 参考](http://docs.amazonwebservices.com/AWSRubySDK/latest/frames.html)以了解[create(resource, key, options = {})](http://docs.amazonwebservices.com/AWSRubySDK/latest/AWS/EC2/TagCollection.html#create-instance_method)实例方法，其中提供了两个简短示例：好：

> 创建一个新标签并将其分配给 EC2 资源。
> 
> **例子**：
> 
> **仅使用名称（键）标记**
> `ec2.tags.create(instance, 'webserver')`
> 
> **使用名称（键）和值进行标记**
> `ec2.tags.create(instance, 'stage', 'production')`
> 
> **参数**
> 
> *   resource (Object) — 要标记的项目。这应该是可标记的 EC2 资源，例如实例、安全组等。
> *   key (String) — 标签键（或名称）。
> *   options (Hash)（默认为：{}） optins (Hash) — 一组可自定义的选项
> 
> **返回**：
> 
> *   （[标签](http://docs.amazonwebservices.com/AWSRubySDK/latest/AWS/EC2/Tag.html)）

# sql - 从 SQLCLR 获取结果

> ID：10584125
> 
> 赞同：0
> 
> 时间：2012-05-14T13:17:52.430
> 
> 标签：sql, sql-server, tsql, sqlclr

我有以下问题：我必须从 LAN 内的各种客户端访问一个 DLL，该 DLL 驻留在承载 SQL Server 的 PC 中。

我需要从所有客户端访问此 DLL 以使其返回合法税务校验和。

我想创建一个 CLR 过程来调用服务器中的 DLL 并返回校验和。

我遵循了一些互联网示例并创建了一个简单的 HelloWorld 应用程序......

我在 C# 中创建了一个 DLL

```
[SqlProcedure]
public static int HelloWorld(int h)
{
    return h;
} 
```

我在 SQL Server 中创建了程序集：

```
CREATE ASSEMBLY MyChecksum
    from 'C:\Users\Panos\Documents\Visual Studio 2010\Projects\DigitalSignature\Algobox\bin\Debug\checksum.dll'
    WITH PERMISSION_SET = UNSAFE 
```

我创建了程序

```
CREATE PROC sp_mychecksum (@h int)
AS
EXTERNAL NAME MyAlgobox.Signatures.HelloWorld 
```

底线是，当我执行我的程序 ( ) 时，我只收到一条消息`exec sp_mychecksum
12`

> 命令成功完成

而不是 12

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:33:23.337

按照您定义事物的方式，HelloWorld() 方法的返回值将作为存储过程的返回值返回。因此，正如@Damien_The_Unbeliever 在您问题的评论中所建议的那样，这将为您提供您在 SQL Server 上寻找的内容：

```
DECLARE @rc int
EXEC @rc = sp_mychecksum 12
SELECT @rc 
```

要让您的 HelloWorld() 方法将值作为结果集返回，您必须执行以下操作（**警告，未经测试**）：

```
[SqlProcedure]
public static int HelloWorld(int h) {
    SqlDataRecord record = new SqlDataRecord(new SqlMetaData("colname", SqlDbType.Int));
    record.SetSqlInt32(0, h);
    SqlContext.Pipe.Send(record);
} 
```

但是，考虑到您的用例，我认为您希望将现有的 CLR 例程映射到 SQL 函数，而不是存储过程。例如，像这样：

```
CREATE FUNCTION dbo.f_mychecksum(@h int) RETURNS int
WITH EXECUTE AS CALLER 
AS
EXTERNAL NAME MyAlgobox.Signatures.HelloWorld 
```

然后像这样使用它：

选择 dbo.f_mychecksum(12)

# openoffice-calc - 开放式办公室排序 - 月份和年份

> ID：10584128
> 
> 赞同：3
> 
> 时间：2012-05-14T13:18:01.990
> 
> 标签：openoffice-calc

我只想根据月份和年份组合（即基于A列）升序对它进行排序。如何在 OpenOffice Calc 中执行此操作？月份的排序选项不起作用，因为我猜还附加了年份。

以下是从 A1 开始的一些数据：

```
Month                    Total
September 2011           27825
September 2010           35801
October 2011             108485
October 2010             22223
November 2011            139222
May 2012                 39319
May 2011                 38226
May 2010                 9671 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:53:22.697

有不同的解决方案：

*   您可以将 A 列的值转换为日期，以便 OpenOffice / LibreOffice 可以相应地对它们进行排序（参见下面的**解决方案 1**）；
*   您可以将文本值分成两列（分别为月份和年份）并首先按年份排序，然后按月份排序（请参阅下面的**解决方案 2**）。

## 解决方案 1

1.  选择保存月/年值的单元格；
2.  选择菜单`Format`-> `Cells...`-> `Numbers`;
3.  `Date`从左侧列表中选择；
4.  在字段中输入以下格式代码`Format Code`：`MMMM YYYY` ![格式](../Images/9465057fd04b96fa9534c12f664ae8a5.png)

5.  打`OK`

6.  在单元格仍处于选中状态的情况下，选择菜单`Edit`->`Find & Replace...`或点击`CTRL`+`H`
7.  在 field 中`Search for`，输入一个点，在 field 中输入一个和号`Replace with`( `&`) ；打`More Options`，打勾`Regular Expression`。选择`Replace all`：

    ![搜索](../Images/c33c66d28bf27801998bbc19db4063d6.png)

8.  选择单元格 A1，使用菜单`Data`->`Sort`按 A 列（“月”）应用排序。

因此，OpenOffice / LibreOffice 将 A 列的值转换为日期（例如，01/09/2011 而不是 2011 年 9 月）。由于使用代码的自定义单元格格式，显示的单元格内容将保持“2011 年 9 月” `MMMM YYYY`。排序时，OpenOffice / LibreOffice 识别日期并按月/日期排序。

## 解决方案 2

1.  在 A 列旁边插入一个新列作为年份值：选择 B 列，选择菜单`Insert`-> `Columns`；
2.  选择A列，选择菜单`Data`->`Text to Columns...`
3.  在下面的对话框中，选择`Space`作为分隔符，然后点击`OK`;
4.  在单元格 B1 中添加`Year`为标题；
5.  选择单元格A1，选择菜单`Data`-> `Sort`；选择第一年，然后选择月份；**不要**点击`OK`（否则月份会按字母顺序排序），但是选择`Options`-> `Custom sort order`; 选择月份排序顺序。现在，打`OK`。

# jquery - 在 jquery 中创建一个数组

> ID：10584129
> 
> 赞同：2
> 
> 时间：2012-05-14T13:18:10.993
> 
> 标签：jquery, arrays

我在 jQuery 中有一个函数

```
 jQuery(function () {
      jQuery(".one").showcase({
          animation: { type: "fade" },
          titleBar: { autoHide: false },
          navigator: { autoHide: true }
      });
      prettyPrint();
      jQuery(".two").showcase({
          animation: { type: "fade" },
          titleBar: { autoHide: false },
          navigator: { autoHide: true }
      });
      prettyPrint();
      jQuery(".three").showcase({
          animation: { type: "fade" },
          titleBar: { autoHide: false },
          navigator: { autoHide: true }
      });
      prettyPrint();
  }); 
```

现在注意上面的代码。我重复展示功能三遍。我想通过数组创建一次函数。怎么可能。我看到了 jQuery 数组示例，但无法理解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:20:43.670

最好的方法不是使用数组，而是将 jQuery 选择器更改为同时定位所有 3 个；

```
 jQuery(".one,.two,.three").showcase({
      animation: { type: "fade" },
      titleBar: { autoHide: false },
      navigator: { autoHide: true }
  });
  prettyPrint(); 
```

...它使用了[多个选择器](http://api.jquery.com/multiple-selector/)，尽管您可能想向这些元素添加*另一个*`showcase`类（？）并将其称为；

```
 jQuery(".showcase").showcase({
      animation: { type: "fade" },
      titleBar: { autoHide: false },
      navigator: { autoHide: true }
  });
  prettyPrint(); 
```

... 反而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:23:20.727

你可以做：

```
 jQuery(function () {
      var arObj = ['.one','.two','.three'];

      for(var i = 0; i< arObj.length ; i++){
          jQuery(arObj[i]).showcase({
              animation: { type: "fade" },
              titleBar: { autoHide: false },
              navigator: { autoHide: true }
          });
          prettyPrint();
      }
  }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:24:23.233

如果您想要一个基于数组的解决方案，您可以执行以下操作：

```
jQuery.each([".one", ".two", ".three"], function(index, value) {
    jQuery(value).showcase({
        animation: { type: "fade" },
        titleBar: { autoHide: false },
        navigator: { autoHide: true }
    });
    prettyPrint();
}); 
```

...或者：

```
function fadeAll(arr) {
    jQuery.each(arr, function(index, value) {
        jQuery(value).showcase({
            animation: { type: "fade" },
            titleBar: { autoHide: false },
            navigator: { autoHide: true }
        });
        prettyPrint();
    });
} 
```

否则，请选择马特的回答。

# multithreading - 如何设计和实现分布式和多线程应用程序？

> ID：10584131
> 
> 赞同：0
> 
> 时间：2012-05-14T13:18:12.267
> 
> 标签：multithreading, distributed-computing

我有一个场景，我需要收集文件并根据存储在数据库中的作业（任务）创建归档文件，其中这些作业（任务）将是每个应用程序的线程（可能是 10 个），它们应该在一个分布式方式。为了简化，我可以总结为：

*   我将拥有许多（例如 10 个）服务器，这些服务器将托管应用程序（多线程应用程序），这些应用程序将从数据库中为其线程获取作业。
*   但是为了同步（服务器上的两个或多个应用程序或线程不应从 DB 获得相同的作业（任务）），我不能在每台服务器上单独运行这些应用程序（我需要某种管理器进程）。

作为一项研究，我查找了一些文章，但我发现的大多数文章都是关于多线程或分布式编程的。甚至我的问题看起来像一个分布式编程问题，我想它不是。

在网上和文章中寻找解决方案时，我遇到了术语“分布式共享内存”、“分布式对象计算”和“分布式多线程检查点 ( [http://dmtcp.sourceforge.net/](http://dmtcp.sourceforge.net/) )”。

但是，由于我是这个编程概念的新手（对于多线程和分布式计算），在我选择一条路径（这对我的情况可能是错误的）之前，我决定在这里问它，向专家提出建议，API ，设计模式，我需要学习的概念来完成我的任务。

提前感谢所有人。

# php - PHP：使用 Zend 连接到 Firebird (Interbase) 数据库

> ID：10584133
> 
> 赞同：2
> 
> 时间：2012-05-14T13:18:24.147
> 
> 标签：php, zend-framework, firebird, zend-db, interbase

我正在尝试使用 Zend Framework 库连接到 Firebird 数据库（请参阅此处的 Zend 文档：http: [//framework.zend.com/manual/en/zend.db.adapter.html](http://framework.zend.com/manual/en/zend.db.adapter.html)）

扩展程序被`php_interbase.dll`激活。如果我运行此代码：

```
$db = Zend_Db::factory('Php_Interbase', array(
    "host"      =>  "127.0.0.1",
    "username"  =>  "xxxxxx",
    "password"  =>  "xxxxxx",
    "dbname"    =>  "xxxxxx"
)); 
```

我收到此错误消息：

**警告：include_once(Zend\Db\Adapter\Php\Interbase.php) [function.include-once]: 无法打开流：第 146 行的 C:\php\includes\Zend\Loader.php 中没有这样的文件或目录**

实际上`Interbase.php`，库中似乎不存在文件（而文档中提到的所有其他数据库驱动程序都存在）。我该怎么办？我在哪里可以下载丢失的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:24:33.703

此适配器在 1.7.3 版中的“附加”库中的“完整包”中发布。根据这里的最后一条评论 [http://framework.zend.com/wiki/display/ZFPROP/Zend_Db%2BFirebird-Interbase%2Bsupport](http://framework.zend.com/wiki/display/ZFPROP/Zend_Db%2BFirebird-Interbase%2Bsupport)

# android - 客户端-服务器应用程序中的 Android Socket 错误

> ID：10584139
> 
> 赞同：0
> 
> 时间：2012-05-14T13:19:01.770
> 
> 标签：android, sockets, client

当我想与我的服务器建立连接时，我的 android 应用程序在创建新套接字的线路上崩溃。

我在 ClientAppl.java 中建立连接的代码如下所示。

```
public class ClientAppl {
private InetAddress host;
private int port;
private Socket link = null;
ObjectInputStream istream;
ObjectOutputStream ostream;
private static MainActivity mainActivity;
private static ClientAppl instance = new ClientAppl(mainActivity);

private ClientAppl(MainActivity frm){
ClientAppl.mainActivity = frm;
}

public static ClientAppl getInstance(){
return instance;
}

public void makeConnection(String sIP, int port) throws IOException, java.net.ConnectException{
    if(link == null){

    System.out.println("Make connection...");
    this.host = InetAddress.getByName(sIP);
        this.port = port;
        link = new Socket(host, port);

        System.out.println("Inputkanaal & outputkanaal vastleggen...");
        ostream = new ObjectOutputStream(link.getOutputStream());
        System.out.println("OK - output");
        istream = new ObjectInputStream(link.getInputStream());
        System.out.println("OK - input");

        AcceptMessageHandler amh = new AcceptMessageHandler();
        Thread t = new Thread(amh);
        t.start();
    }
} 
```

在 MainActivity.java 我添加了这段代码来启动一个连接。

```
txtServerIP = (EditText)findViewById(R.id.txtServerIP);
txtServerPoort = (EditText)findViewById(R.id.txtServerPoort);
try {
ClientAppl.getInstance().makeConnection(txtServerIP.getText().toString(),    Integer.parseInt(txtServerPoort.getText().toString()));
} catch (NumberFormatException e) {
e.printStackTrace();
} catch (UnknownHostException e) {
e.printStackTrace();
} catch (ConnectException e) {
e.printStackTrace();
} catch (IOException e) {
e.printStackTrace();
} 
```

这是我的清单文件。怎么了？:(

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="be.howest"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET">
</uses-permission>
<application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
    <activity
        android:name="project.client.pc.view.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T17:04:36.867

正如 Chris 所指出的，您需要在 UI 线程以外的线程上进行所有 TCP 套接字交互。在我的代码中，我在 AsyncTask 中建立了套接字，这听起来很吓人，但如果我能做到，你当然可以。这是一个体面的教程：

[http://www.vogella.com/articles/AndroidPerformance/article.html](http://www.vogella.com/articles/AndroidPerformance/article.html)

随后，为每个套接字“对话”生成一个新线程——这也不是太难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T16:43:59.390

```
5-14 15:55:28.669: E/AndroidRuntime(572): android.os.NetworkOnMainThreadException 
```

您一直被警告不要在主 (UI) 线程上进行网络操作，而现在通过主动检查有效地禁止您这样做，这将导致此致命异常。

# java - 无法多次连接到mysql

> ID：10584142
> 
> 赞同：2
> 
> 时间：2012-05-14T13:19:09.980
> 
> 标签：java, mysql, scala, database-connection, specs2

我正在scala中编写自己的数据库。为了验证我的结果是否正确，我检查了 specs2 规范中的 MySQL。我得到了正确的结果，一切都很好。但是如果我再次运行测试而不做任何更改，我会得到一个`SQLException: No suitable driver found for jdbc:mysql://localhost:3306/DBNAME?user=DBUSER (null:-1)`. 为什么没有再次加载驱动程序？

**编辑**

```
import java.sql.{ Connection, DriverManager, ResultSet }
import org.specs2.mutable.Specification
// SDDB imports ...

class DBValidationSpec extends Specification {

  "SDDB and MySQl" should {
    // SDDB
    // ...
    // JDBC
    val connectionString = "jdbc:mysql://localhost:3306/sddb_test?user=root"
    val query = """SELECT content, SUM( duration ) duration
                    FROM test
                    WHERE times
                    BETWEEN  '2011-12-08'
                    AND  '2011-12-09'
                    GROUP BY content"""
    classOf[com.mysql.jdbc.Driver]

    "give the same result" in {
      // ...
      //sddbResult

      lazy val conn = DriverManager.getConnection(connectionString)
      try{
        val rs = conn.createStatement().executeQuery(query)
        var mysqlResult = Map[List[String], Int]()
        while (rs.next) {
          mysqlResult += (rs.getString("content") :: Nil) -> rs.getInt("duration")
        }
        sddbResult == mysqlResult && sddbResult.size == 478 must beTrue 
      } finally {
        conn.close()
      }
    }

  }

} 
```

我遗漏了我的代码的某些部分，因为它们不属于问题。

**编辑#2**

问题变得更奇怪了。我添加了第二个测试用例。测试用例使用相同的`connectionString`. 异常仅引发一次。第二次测试成功。我添加`sequential`到我的测试定义中，发现只有第一个执行的测试会引发异常。之后我追踪了`classLoader`它以检查它是否是同一个。这是。
我做了以下解决方法：

```
trait PreExecuting extends Before {
  override def before {
    var conn: Option[Connection] = None
    try {
      val connectionString = "jdbc:mysql://localhost:3306/sddb_test?user=root"
      conn = Some(DriverManager.getConnection(connectionString))
    } catch {
      case _ =>
    } finally {
      conn map (_.close())
    }
  }
} 
```

我不再收到异常，因为我通过使用 PreExecution tait 来抑制它。但我仍然想知道这里出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:07:35.067

我无法将错误确定为以下内容，但至少最好也**关闭**结果集和语句。

```
 val stmt = conn.createStatement()
    val rs = stmt.executeQuery(query)
    var mysqlResult = Map[List[String], Int]()
    while (rs.next) {
      mysqlResult += (rs.getString("content") :: Nil) -> rs.getInt("duration")
    }
    sddbResult == mysqlResult && sddbResult.size == 478 must beTrue 
    rs.close()
    stmt.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-19T05:38:24.960

似乎是驱动注册的问题，驱动必须像这样注册......

```
DriverManager.registerDriver(new com.mysql.jdbc.Driver());   
or some like this...
DriverManager.registerDriver(new DriverWrapper((Driver) Class.forName(props.getProperty("dbg.driver"), true, gcloader).newInstance())); 
```

在使用 getConnection 之前。我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:30:16.693

驱动程序只加载一次。

没有合适的驱动程序通常意味着连接 URL 语法不正确。

# windows - 使用带有命令行参数的批处理脚本递归搜索和构建任意 VS 解决方案

> ID：10584147
> 
> 赞同：0
> 
> 时间：2012-05-14T13:19:19.883
> 
> 标签：windows, visual-studio, batch-file, build-script

因此，我希望能够使用批处理脚本构建任意数量的 VS 解决方案。我希望脚本搜索给定的项目名称，并将它们的文件路径传递给 VS CLI。格式如下：

```
build_slns (debug|release) [proj1] [proj2] ... [projN] 
```

第一个参数是配置，所有后续参数都是项目名称。我遇到的问题是这些项目都将位于我的基本代码目录的不同子目录中。所以一个例子是这样的：

```
build_slns debug foo bar foobar 
```

我要构建的 .slns 的位置如下：

```
Code\foo\foo.sln
Code\foo\bar\bar.sln
Code\foobar\foobar.sln 
```

我相信我会想使用 FOR /F，但我只是对批处理不够熟悉，无法让它按照我想要的方式工作。非常感谢这里的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:49:22.187

像这样的东西应该工作

```
@echo off
setlocal
::change the definition of cmd and root as needed
set cmd="C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe"
set root="d:\utils"

:loop
if "%~2" equ "" exit /b
echo Searching for %2
for /f "eol=: delims=" %%F in ('dir /b /s "%root%\%2.sln"') do (
  echo Building %%F
  %cmd% "%%F" /build %1
)
shift /2
goto :loop 
```

# asp.net - 具有空值的 ASP.Net MVC3 Razor 模板变量

> ID：10584149
> 
> 赞同：1
> 
> 时间：2012-05-14T13:19:33.817
> 
> 标签：asp.net, asp.net-mvc-3, razor, castle-monorail, nvelocity

我一直在开发 Castle Monorail MVC Web 应用程序。我开始使用 Asp.Net MVC 3 和 Razor 学习和开发一些项目。

我使用 NVelocity 作为 Monorail 的视图引擎。它能够使用通过 PropertyBag 传递的变量，例如`$!variablename`. 这允许我使用 as，如果变量等于 null，那么它不会打印任何值并且不会引发异常。

是否有任何方法可以与 MVC 3 一起使用，或者我是否总是需要检查通过 ViewData 传递的变量是否为空？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:30:50.730

如果使用`ViewBag`或`ViewData`传递字符串，则不必检查是否为空。

如果您要传递一个更复杂的对象，比如`UserObject`带有属性的 a `Name`，那么尝试访问`@ViewBag.UserObject.Name`将导致错误。在这种情况下，您应该检查无效性，例如：

```
@if (ViewBag.UserObject != null) { ViewBag.UserObject.Name } 
```

# javascript - JavaScript 名称范围

> ID：10584154
> 
> 赞同：1
> 
> 时间：2012-05-14T13:19:55.793
> 
> 标签：javascript

这是什么意思，在您自己的名称范围内编写 JavaScript，显然它避免了冲突并符合 W3C 标准，但我不知道它的含义或它是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:24:04.037

这是一种尽量减少使用全局变量的方法（从而避免可能的冲突）。

```
var myNS = {}; // Your namespace (an object) = a global var.
myNS.title = "Demo"; // Your variables come here as object properties.
myNS.date = "2012-05-21"; 
```

对象属性可以是任何类型：标量类型、数组、对象、函数...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T13:24:23.893

我认为你的意思是命名空间。这意味着您应该将代码包含在命名空间中，这样您就不会污染全局范围（好吧，您确实只用一个变量污染了它，仅此而已）。您打算创建的每个函数和其他内容都将存在于该命名空间中。

一个简单的命名空间示例，在对象字面量中

```
var ns = {
    foo : function(){...},
    bar : function(){...}
} 
```

您只声明了一个全局`ns`. 其余的存储在其中并通过以下方式访问`ns`

```
ns.foo();
ns.bar(); 
```

现实生活中的例子可以在 JS 框架中看到。例如，我们有 jQuery 和 Underscore

```
//jQuery uses "jQuery" and "$" as namespaces and has "each()"
$.each();

//Underscore has "_" as a namespace and also has "each()"
_.each(); 
```

尽管它们具有相同的函数名称，但它们位于不同的命名空间中。这可以避免冲突，并帮助您确定哪些内容属于哪里。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T13:25:37.483

我想这意味着在您自己的对象中编写函数，而不是编写全局函数：

```
var myScope = (function() {

    function privateFunction1() {...}
    function privateFunction2() {...}
    function a() {...}
    function b() {...}
    function c() {...}

    return {a: a, b: b, c: c};

})(); 
```

# weblogic - weblogic下的sl4j/logback

> ID：10584156
> 
> 赞同：13
> 
> 时间：2012-05-14T13:19:58.807
> 
> 标签：weblogic, slf4j, logback

我正在尝试在 Weblogic12 下配置 sl4j/logback。我部署 ear 文件，其中包含 war 文件，其中包含 WEB-INF\classes\logback.xml
这是配置：

```
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
    </encoder>
</appender>

<root level="debug">
    <appender-ref ref="STDOUT" />
</root>

</configuration> 
```

我要记录的代码：

```
private static final Logger logger = LoggerFactory.getLogger(FrontEndServlet.class);
//......
logger.info("info test");
logger.debug("debug test");
logger.error("error test"); 
```

我在标准输出中看到的是：

```
ьрщ 14, 2012 5:09:29 PM .....FrontEndServlet doPost
INFO: info test
ьрщ 14, 2012 5:09:29 PM .....FrontEndServlet doPost
SEVERE: error test 
```

因此，看起来配置文件没有被拾取。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-12T07:30:25.780

问题在这里详细讨论：[https ://stagingthinking.wordpress.com/2012/06/02/annoying-slf4j-problem-in-weblogic-server-12c/](https://stagingthinking.wordpress.com/2012/06/02/annoying-slf4j-problem-in-weblogic-server-12c/)

您需要放入 prefer-application-packages 机制的确切包是`org.slf4j`，如下所示：

```
<?xml version='1.0' encoding='UTF-8'?>
<weblogic-application>
  <prefer-application-packages>
    <package-name>org.slf4j</package-name>
  </prefer-application-packages>
</weblogic-application> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-15T15:43:05.323

**注意：**这个问题也已经回答了，我想补充一点，你也应该添加`prefer-application-resources`.

**答案：**在您的耳朵中添加一个名为 META-INF/weblogic-application.xml 的文件，其中包含`prefer-application-packages`和`prefer-application-resources`！

```
<?xml version="1.0" encoding="UTF-8"?>
<weblogic-application
        xmlns="http://xmlns.oracle.com/weblogic/weblogic-application"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://xmlns.oracle.com/weblogic/weblogic-application http://xmlns.oracle.com/weblogic/weblogic-application/1.5/weblogic-application.xsd"
        version="6">

    <!-- http://www.torsten-horn.de/techdocs/jee-oracleweblogic.htm -->
    <prefer-application-packages>
        <package-name>org.slf4j.*</package-name>
    </prefer-application-packages>

    <!-- if not using prefer-application-resources you will get a warning like this: -->
    <!-- Class path contains multiple SLF4J bindings -->
    <!-- SLF4J: Found binding in [jar:file:/C:/wls1211/modules/org.slf4j.jdk14_1.6.1.0.jar!/org/slf4j/impl/StaticLoggerBinder.class] -->
    <prefer-application-resources>
        <resource-name>org/slf4j/impl/StaticLoggerBinder.class</resource-name>
    </prefer-application-resources>

</weblogic-application> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-15T09:32:07.247

问题是 - sl4j 没有选择 logback，而是使用了 Weblogic 的 slf4j-jdk 日志记录。可以通过 Weblogic 的配置***weblogic-application.xml***，选项***prefer-application-packages来修复***

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-11T13:15:57.630

或者，如果您遇到的问题不仅仅是 slf4j，您可以使用

```
<wls:container-descriptor>
    <wls:prefer-web-inf-classes>true</wls:prefer-web-inf-classes>
</wls:container-descriptor> 
```

代替

```
<prefer-application-packages>
    <package-name>org.slf4j.*</package-name>
</prefer-application-packages> 
```

资料来源：[甲骨文](https://docs.oracle.com/cd/E24329_01/web.1211/e21049/weblogic_xml.htm#WBAPP591)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-12T15:47:20.993

**环境：Weblogic 12.2.1 日志框架：Slf4j 和 Logback 要求：记录到我选择的文件（每个应用程序）以及 Weblogic 服务器日志**

在 weblogic.xml 中使用`<prefer-application-packages/>`or `<prefer-web-inf-classes>`不满足要求。在我的测试中，使用一个或其他标签（不能同时使用两者）将导致应用程序 logback.xml 被拾取，并且日志记录将转到 logback.xml 中定义的文件。但是，使用 logback 的 ConsoleAppender 的典型 STDOUT 定义不会记录到服务器日志。

```
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"> 
```

从 weblogic.xml 中删除以下内容

```
<wls:prefer-application-packages>
    <wls:package-name>org.slf4j.*</wls:package-name>
</wls:prefer-application-packages> 
```

将导致使用捆绑的 SLF4j 绑定，在 Weblogic 12.2.1 中，它是 Java Util 日志记录。在这种情况下，日志语句将转到服务器日志，而不是应用程序级别 logback.xml 中的文件定义。在我的研究中，有时 Weblogic 12 的某些版本允许内部 SLF4j 绑定到 Log4j，但在其中一个次要版本中被删除。这是我的情况；我没有通过管理控制台启用 Log4j 作为 Weblogic 中的主要日志框架的选项。我很确定这对我没有帮助，但我确实想指出它，因为我阅读的几份文件表明这是可用的。

经过大量研究和使用 weblogic.xml 进行配置、POM 配置（排除等）并尝试使用不同的绑定和桥接后，我无法实现我想要的日志记录配置。似乎 Weblogic 的 slf4j 绑定到 Java 实用程序日志记录，无论好坏。如果您选择自己的 slf4j 和绑定实现（在我的情况下为 Logback），我无法通过配置将这些消息路由到 Weblogic 服务器日志。slf4j 中只能有一个绑定，虽然很多框架都可以路由到那个绑定，（我发现[这个](https://www.slf4j.org/legacy.html)图有用）Weblogic 12.2.1 仅使用 Java util 日志绑定，没有办法（在应用程序配置级别）连接 Weblogic 以使用您提供的 Logback 绑定来记录到其服务器日志。可能有一些方法可以使用 log4j 和 bridges 来完成此任务，但对我来说，完成一个简单的日志记录任务完全过于臃肿和配置。

放弃尝试通过配置来解决这个问题，我决定简单地编写自己的 logback appender，将日志事件转换为 JUL 日志事件。我用我[自己](http://www.baeldung.com/custom-logback-appender)实现的 Logback 的 AppenderBase 替换了在许多 Logback 示例中看到的标准 STDOUT 定义。此时，我现在可以使用每个应用程序日志配置进行日志记录，也可以记录到 Weblogic Server 日志。

**相关POM依赖：**

```
<!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.7.25</version>
    </dependency>
    <!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-classic -->
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.2.3</version>
    </dependency>
    <!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-core -->
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-core</artifactId>
        <version>1.2.3</version>
    </dependency> 
```

**weblogic.xml（请注意，Hibernate 带有 JbossLogging，它会自动桥接到 slf4j）**

```
<?xml version="1.0" encoding="UTF-8"?>
<weblogic-web-app xmlns="http://xmlns.oracle.com/weblogic/weblogic-web-app"
xmlns:wls="http://xmlns.oracle.com/weblogic/weblogic-web-app"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://xmlns.oracle.com/weblogic/weblogic-web-app http://xmlns.oracle.com/weblogic/weblogic-web-app/2.0/weblogic-web-app.xsd">
<jsp-descriptor>
    <keepgenerated>true</keepgenerated>
    <debug>true</debug>
</jsp-descriptor>
<context-root>YourContextRoot</context-root>
<wls:container-descriptor>
    <wls:prefer-application-packages>
        <wls:package-name>ch.qos.logback.*</wls:package-name>
        <wls:package-name>org.jboss.logging.*</wls:package-name>
        <wls:package-name>org.slf4j.*</wls:package-name>
    </wls:prefer-application-packages>
    <wls:prefer-application-resources>
        <wls:resource-name>org/slf4j/impl/StaticLoggerBinder.class</wls:resource-name>
    </wls:prefer-application-resources>
</wls:container-descriptor> 
```

**Logback AppenderBase 实现**

```
import java.util.logging.Logger;

import ch.qos.logback.classic.spi.ILoggingEvent;
import ch.qos.logback.core.AppenderBase;

public class WeblogicAppender extends AppenderBase<ILoggingEvent> {

private final Logger logger = Logger.getLogger(WeblogicAppender.class.getName());
ILoggingEvent event = null;

@Override
protected void append(ILoggingEvent event) {
    this.event = event;
    logger.log(getJULLevel(), event.getFormattedMessage());
}

private java.util.logging.Level getJULLevel() {

    if (this.event == null) {
        return java.util.logging.Level.SEVERE;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.ALL) {
        return java.util.logging.Level.ALL;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.DEBUG) {
        return java.util.logging.Level.FINE;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.ERROR) {
        return java.util.logging.Level.SEVERE;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.INFO) {
        return java.util.logging.Level.INFO;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.TRACE) {
        return java.util.logging.Level.FINEST;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.WARN) {
        return java.util.logging.Level.WARNING;
    } else if (this.event.getLevel() == ch.qos.logback.classic.Level.OFF) {
        return java.util.logging.Level.OFF;
    } else {
        return java.util.logging.Level.INFO;
    }
} 
```

}

**Logback.xml 配置**

```
<?xml version="1.0" encoding="UTF-8"?>
 <configuration>
<appender name="STDOUT" class="com.your.package.WeblogicAppender">
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger: LineNumber:%L - %message%n</pattern>
    </encoder>
</appender>
<appender name="FILE"
    class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>yourlog.log
    </file>
    <rollingPolicy
        class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
        <fileNamePattern>yourlog.%d{yyyy-MM-dd}.%i.log
        </fileNamePattern>
        <maxFileSize>25MB</maxFileSize>
        <maxHistory>60</maxHistory>
        <totalSizeCap>10GB</totalSizeCap>
    </rollingPolicy>
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger: LineNumber:%L - %message%n</pattern>
    </encoder>
</appender>

<root level="TRACE">
    <appender-ref ref="STDOUT" />
    <appender-ref ref="FILE" />
</root>
</configuration> 
```

希望我可以为其他人节省一些我在尝试以我想要的方式工作时所经历的痛苦。

# java - 改进随机生成功能

> ID：10584173
> 
> 赞同：1
> 
> 时间：2012-05-14T13:20:53.847
> 
> 标签：java, random

我正在做一个涉及系统随机生成对象的小应用程序。这是怎么回事

每个对象都有一个指定对象**“类型”**的字段。假设火、冰、风（虽然不是应用程序中的实际事物）每种类型都有一个名为**“可能性”**的字段，用于确定生成该类型的可能性。这个字段的默认值当然是 1/numberOfTypes 类型的另一个字段是它在列表中的**“顺序”**，假设火是第一，冰是第二，风是第三。

我对此的幼稚解决方案是使用 `Math.floor(Math.random()*100 / defualtPossibilities)`并将其与 type.oder 匹配因此，如果随机值为 .75，并且存在三种类型，`Math.floor(...)`则`return 2`意味着该对象是冰对象。

但是，我遇到了一些潜在的问题：

1.  可以更改每种类型的可能性值。在这种情况下，我仍然可以生成一个随机数并使用循环检查每个**type.order*type.possibilities**直到它超过随机数。但我不确定是否有更好的方法。

2.  当您更改一种**type.possibilities**时，另**一种类型。可能性**必须根据总可能性100而改变。我计划通过将变化量平均分配给所有其他类型来做到这一点。是不是一个好办法。

如果我在某些方面含糊不清，我很抱歉，但请帮助我^-^

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:38:59.967

这是一个简短的解决方案：

```
 float weights[]; // each >0

 public int nextIndex() {     
     float sum =0;
     for (int i=weights.length; i-->0;) sum+=weights[i];
     float r = myrandom.nextFloat()*sum;
     sum = 0;
     for (int i=0; i<weights.length-1; i++) {
         sum += weights[i];
         if (r<sum) return i;
     }
     return weights.length-1;
 } 
```

您可以单独更改每个重量。这个想法只是重新计算权重的总和，而不是假设它是 100。

显然，为了获得最佳性能，您可以预先计算总和。

# c# - 将 dateformat 字符串绑定到 web.config 中的值？

> ID：10584176
> 
> 赞同：1
> 
> 时间：2012-05-14T13:21:00.790
> 
> 标签：c#, asp.net, asp.net-ajax

我的 web.config 中有这个

```
<add key="DateFormat" value="dd/MM/yy"/> 
```

我想使用带有格式属性的ajax日历并将其绑定到这种格式。

但我还没有找到如何做的表达。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:51:48.560

您应该能够使用`<%$ AppSettings: DateFormat %>`（根据MSDN 上的[ASP.NET 表达式概述）](http://msdn.microsoft.com/en-us/library/d5bd1tad.aspx)

# java - 使用 JPA EntityManager 进行批量插入

> ID：10584179
> 
> 赞同：34
> 
> 时间：2012-05-14T13:21:31.260
> 
> 标签：java, jakarta-ee, ejb-3.0, eclipselink

有没有一种方法可以使用 JPA EntityManager 使用批量插入。我知道没有直接的方法可以实现这一点，但必须有某种方法来实现这种机制。

实际上，对于每个插入操作，我需要 300 毫秒，我想使用批量插入而不是单次插入来减少。

这是我当前正在为单个插入执行的代码

```
 @PersistenceContext(unitName = "testing")
        EntityManager eM;

        Query querys = this.eM.createNativeQuery(insertQuery);
        for (String s : someList) {
            //setting parameters
            querys.executeUpdate();
        } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-15T09:06:33.510

根据事务是否包含循环，批处理通常已经在您的情况下发生。

JPA 将在其 L1 缓存中收集您的所有更新，并通常在事务提交时将所有更新批量写入数据库。这与 JDBC 中的批处理并没有什么不同，您添加的每个批处理项也暂时在内存中，直到您调用更新方法。

潜在的问题是，您没有硬性保证 JPA 确实会执行此批处理，以及是否在事务提交或达到阈值时执行此操作，但我发现在实践中几乎在所有情况下，尤其是在涉及此类的情况下简单的更新循环，它确实可以进行批处理。

一个问题是，即使 JPA 确实已经进行了批处理，您仍然可能希望控制批处理大小。其他答案链接的文章为此提供了非常有用的信息。

最后，你应该知道你的 L1 缓存在循环中不断增长，所以如果更新的数量真的很大，请定期清除它。或者，如果您的业务逻辑可以维持它，请在多个事务中进行部分更新。例如，事务 1 中的项目 0 到 100.000，事务 2 中的 100.001 到 200.000 等。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-06-24T07:59:22.560

我知道这是一个相当古老的问题，答案已被接受。尽管如此，我想对这个非常具体的主题“JPA 批量插入”给出一个新的答案。

```
@PersistenceContext
private EntityManager entityManager;

@Value("${hibernate.jdbc.batch_size}")
private int batchSize;

public <T extends MyClass> Collection<T> bulkSave(Collection<T> entities) {
  final List<T> savedEntities = new ArrayList<T>(entities.size());
  int i = 0;
  for (T t : entities) {
    savedEntities.add(persistOrMerge(t));
    i++;
    if (i % batchSize == 0) {
      // Flush a batch of inserts and release memory.
      entityManager.flush();
      entityManager.clear();
    }
  }
  return savedEntities;
}

private <T extends MyClass> T persistOrMerge(T t) {
  if (t.getId() == null) {
    entityManager.persist(t);
    return t;
  } else {
    return entityManager.merge(t);
  }
} 
```

来源： http: [//frightanic.com/software-development/jpa-batch-inserts/](http://frightanic.com/software-development/jpa-batch-inserts/)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-14T13:53:48.553

可以使用 JPA 执行批量写入，但它高度依赖于持久性提供程序、数据库和 JDBC 驱动程序的具体实现*。*例如，[本文](http://java-persistence-performance.blogspot.com/2011/06/how-to-improve-jpa-performance-by-1825.html)解释了如何使用 EclipseLink JPA 2.3 和 Oracle 数据库启用批量写入（优化 #8）。在您的特定环境中寻找类似的配置参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-14T13:55:03.457

JPA 本身没有任何批处理设置。但是，有一些依赖于实现的设置。[这是 hibernate 的示例](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html)。

# jquery - jQuery tabSlideOut 插件动态高度

> ID：10584180
> 
> 赞同：0
> 
> 时间：2012-05-14T13:21:34.113
> 
> 标签：jquery, css

我在我的应用程序中使用这个 jQuery 插件[http://www.building58.com/examples/tabSlideOut.html](http://www.building58.com/examples/tabSlideOut.html)

除了我的滑出面板的高度不固定之外，这一切都很好 - 它使用 Ajax 请求来填充可以是任意长度的项目列表 - 顶部的下拉列表允许按状态过滤此列表，所以高度会改变。

我可以为 CSS 添加一个高度，但它可以是任何高度，这并不能真正解决问题，但因为列表是动态填充的，当我将高度从 CSS 中移除时，它看不到任何内容并且显示太小.

当内容发生变化时，有没有办法调整面板的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T10:33:51.790

万一其他人遇到这个问题，我通过稍微修改 JavaScript 来解决它 - 尺寸只是第一次检查，这就是它没有调整大小的原因。

我做了这个改变，所以它每次都会创建一个新对象

```
var properties = function(){
    return {
        containerWidth: parseInt(obj.outerWidth(), 10) + ‘px’,
        containerHeight: parseInt(obj.outerHeight(), 10) + ‘px’,
        tabWidth: parseInt(settings.tabHandle.outerWidth(), 10) + ‘px’, 
        tabHeight: parseInt(settings.tabHandle.outerHeight(), 10) + ‘px’
    }
}; 
```

然后我更新了所有参考资料

```
properties.attribute 
```

到

```
properties().attribute 
```

现在，只要内容更新，高度就会调整。

# magento - 在 Magento 中为 Google Analytics 设置 CMS 页面名称

> ID：10584183
> 
> 赞同：1
> 
> 时间：2012-05-14T13:21:44.847
> 
> 标签：magento

在 /app/code/core/Mage/GoogleAnalytics/Block/Ga.php 中，第 88 行引用了同一脚本第 95 行中使用的 $this->getPageName()。虽然这是有道理的，因为如果页面定义了“页面名称”，它会将其附加到 Google Analytics 代码中，但我无法找到 Magento Admin 或页面 XML 中的位置我是否将此“页面名称”设置为内容管理系统页面？在 Ga.php 的注释中它说“自定义的“页面名称”可以从布局或其他地方设置。它必须从斜线开始。” 但我不知道我会怎么做。

当我向 Magento Support 提出这个问题时，他们返回“查看我们的设计指南”，没有其他信息。

如何在 Magento Enterprise 1.12.0.2 中为 CMS 页面设置页面名称？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:23:38.070

默认情况下它没有设置在任何地方。您可以在使用操作调用在布局 xml 中创建块时设置它，例如：

```
<action method="setPageName"><name>blah/blahblah/foo.html</name></action> 
```

您可以通过在块上调用 setPageName() 方法将其设置在控制器中。或者您可以直接覆盖 Mage_GoogleAnalytics_Block_Ga 类并添加您自己的自定义功能：

```
public function getPageName()
{
    if (!$this->hasData('page_name')) {
        $this->setPageName(Mage::getSingleton('core/url')->escape($_SERVER['REQUEST_URI']));
     }
    return $this->getData('page_name');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-09T17:31:10.597

另一种解决方案，基于 Roscius 版本：

```
public function getPageName()
{
    if (!$this->hasData('page_name')) {
        $this->setPageName(str_replace(Mage::getStoreConfig('design/head/title_prefix'), '', $this->getLayout()->getBlock('head')->getTitle()));
     }
    return $this->getData('page_name');
} 
```

# vb.net - 将 xml 数据加载到 Ultragrid

> ID：10584185
> 
> 赞同：3
> 
> 时间：2012-05-14T13:21:50.553
> 
> 标签：vb.net, infragistics, ultrawingrid

我正在尝试在 Ultragrid 中显示 xml 数据。我尝试使用 Ultragrid.loadfromxml 并使用文件的位置，并且我还使用了文件输入流并将其放入加载 xml 方法中。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:40:01.560

为此，您可以使用类似这样的内容加载 XML 文件

```
Dim dt as DataTable = new DataTable("myData")
dt.ReadXml("path_to_your_file")
ultraGrid1.DataSource = dt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T00:50:22.207

UltraGrid 可以绑定到任何实现 IList 的东西，因此您需要将数据加载到某种列表中。如果您需要网格在初始加载数据后响应对集合的更改，那么您可能需要使用 IBindingList。在线帮助中有更多关于 DataSource 可以设置的详细信息： [http ://help.infragistics.com/NetAdvantage/WinForms/Current/CLR2.0/?page=Infragistics2.Win.UltraWinGrid.v12.1~ Infragistics.Win.UltraWinGrid.UltraGridBase~DataSource.html](http://help.infragistics.com/NetAdvantage/WinForms/Current/CLR2.0/?page=Infragistics2.Win.UltraWinGrid.v12.1~Infragistics.Win.UltraWinGrid.UltraGridBase~DataSource.html)

如果您的 XML 是可以读入 DataTable 的格式，那么最简单的解决方案是在调用 ReadXml 将数据加载到 DataTable 之后将 UltraGrid 绑定到 DataTable。

如果您不能使用 DataTable，那么您可以使用[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387098)来获取数据并将其转换为 UltraGrid 可以绑定的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T14:18:14.280

引用 Infragistics Ultragrid Ninja，Mike Saltzman 本人的话：

> [网格需要某种实现 IList 或 IBindingList 的数据源。因此，您必须将 XML 加载到其中一种类型的对象中。](http://forums.infragistics.com/forums/t/12271.aspx)

因此，您需要将 XML 加载到实现这些接口之一的集合类型中，然后将其设置为网格上的数据源。查看这个[问题](https://stackoverflow.com/questions/6431255/retrieving-data-from-xml-file)，了解如何从文件中加载 XML。然后就这么简单...

```
UltraGrid1.DataSource = myAwesomeBindingListMadeFromXML 
```

UltraGrid.DisplayLayout 上的[LoadFromXML](http://help.infragistics.com/Help/NetAdvantage/WinForms/2011.2/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v11.2~Infragistics.Win.UltraWinGrid.UltraGridLayout~LoadFromXml%28String,PropertyCategories%29.html)方法用于加载先前保存的布局（即显示设置），而不是网格本身中的数据。

# javascript - 使用 JQuery 注册系统不起作用

> ID：10584187
> 
> 赞同：1
> 
> 时间：2012-05-14T13:21:58.090
> 
> 标签：javascript, jquery, ajax, redirect

我在一个网站上有一个注册系统***当有人注册时，它会显示错误，或者如果它被接受，它会显示“真实”。javascript 文件 ( [http://pastebin.com/mv9CWZcT](http://pastebin.com/mv9CWZcT) ) 用于在注册成功但对我不起作用时重定向用户！我以前使用过这个脚本，我知道它可以工作，但由于某种原因不在这里？

我在学校，无法查看任何错误对话框等。

谢谢，乔希。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:25:12.403

您的 AJAX 正在返回两个换行符和`true`，而不仅仅是 true。`$.trim(html)`在查看值是否为 之前使用`true`。

# java - 一个文件可以用Java的多个字符集编码吗？

> ID：10584190
> 
> 赞同：2
> 
> 时间：2012-05-14T13:22:19.523
> 
> 标签：java, character-encoding, java-io

我正在开发一个 Java 插件，它允许人们通过指定他们希望使用的字符集编码来写入和读取文件。但是，我对如何在一个文件中编码多个编码感到困惑。例如，假设 A 字符来自一个字符集而 B 字符来自另一个字符集，是否可以将“AAAAABBBBBAAAAA”写入文件？

如果不可能，这对于任何编程语言是否普遍适用，或者特别适用于 Java？如果可能的话，我将如何继续读取（解码）文件？

我不想使用 Charset 的 encode() 和 decode() 方法，因为对它们的测试失败了（某些字符集没有正确解码）。由于各种原因我也不想使用第三方程序，所以这个问题的范围纯粹是在标准的java包/代码中。

非常感谢！
NS

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T13:26:38.323

您需要将其作为字节流读取并事先知道字符开始和结束的字节位置，或者使用一些特殊的分隔符/字节范围来指示字符组的开始和结束。通过这种方式，您可以获得特定字符组的字节，并最终使用所需的字符编码对其进行解码。

此问题并非特定于 Java。这个要求很奇怪。我想知道混合这样的字符编码有什么意义。始终使用一种统一的编码，例如 UTF-8，它几乎支持人类知道的所有字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:29:25.810

当然，原则上可以将用不同字符集编码的文本写入一个文件，但你为什么要这样做呢？

字符编码只是从文本字符到字节的映射，反之亦然。文件由字节组成。写入文件时，字符编码决定了字符如何转换为字节，读取时，它决定了字节如何转换回字符。

您可以使用一种字符编码对文件的一部分进行编码，而将另一部分使用另一种字符编码进行编码。你必须有一些机制来跟踪哪些部分是用什么编码编码的，因为文件不会自动为你跟踪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-16T19:47:22.273

我也想知道这个，因为我的客户刚刚问了一个类似的问题。就像 BalusC 提到的，这不是 java 特有的问题。经过几次来回，我发现真正的问题可能是“信息的多重编码”，而不是多重编码文件。即我们有一个xml字符串文本需要用8859-1编码，如果我们将它保存为文件，那么我们需要对其进行编码。xml 的默认编码是 UTF-8，我们可能不需要将整个 xml 编码为 8859-1。由于 xml 节点只是将信息传递给其他系统和内容的工具（xml 节点的值，需要使用 8859-1 持久化）。那么在这种情况下我们需要多重编码吗？可能不是。我们仍然可以使用 UTF-8 对 xml 进行编码，然后将其传递过来。一旦客户端收到 xml，

# c# - Caliburn Micro：用户控件绑定

> ID：10584192
> 
> 赞同：1
> 
> 时间：2012-05-14T13:22:28.327
> 
> 标签：c#, wpf, binding, user-controls, caliburn.micro

我将 Caliburn Micro 用于我的 WPF 应用程序。我实现了一个小用户控件：

```
<UserControl Name="ImageButtonUserControl"
             x:Class="SportyMate.Utility.Controls.ImageButton"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
    <Grid>
        <Button>
            <StackPanel Orientation="Horizontal">
                <Image Source="{Binding ElementName=ImageButtonUserControl, Path=Image}" />
                <TextBlock Text="{Binding ElementName=ImageButtonUserControl, Path=Text}" />
            </StackPanel>
        </Button>
    </Grid>
</UserControl> 
```

现在我想在我的视图中使用这些控件：

```
<uc:ImageButton Name="Cancel" Image="/Images/Icons/cancel_16x16.png" Text="Abbrechen" Margin="3" /> 
```

当我想打开我的视图时（在我的情况下它是作为对话框打开的）它不起作用。视图不打开。当我删除 Name-Attribute 时，一切都很好，但 Button 没有绑定到操作。谁能告诉我我必须做些什么才能正确绑定？一个普通的按钮工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:47:12.223

你走错了路。您不应该为这种简单的修改创建用户控件。您需要创建一个 DataTemplate 并将其用于 Button.ContentTemplate。首先，您需要为按钮内容定义一个帮助器类型：

```
public class ImageButtonContent
{
    public BitmapImage Image { get; set; }
    public string Label { get; set; }
} 
```

之后，您可以将其用于 DataTemplate：

```
<Window x:Class="Trys.MainWindow"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:Trys="clr-namespace:Trys"
            Title="MainWindow"
            Height="350"
            Width="525">
      <Window.Resources>
        <Trys:ImageButtonContent x:Key="YourImageButtonHere"
                                 Label="Your ImageButtonHere">
          <Trys:ImageButtonContent.Image>
            <BitmapImage UriSource="your-icon.png" />
          </Trys:ImageButtonContent.Image>
        </Trys:ImageButtonContent>
        <DataTemplate x:Key="ImageButton"
                      DataType="{x:Type Trys:ImageButtonContent}">
          <StackPanel Orientation="Horizontal">
            <Image Source="{Binding Image}"
                   Margin="5" />
            <TextBlock Text="{Binding Label}"
                       VerticalAlignment="Center"
                       Margin="10,0,0,0" />
          </StackPanel>
        </DataTemplate>
      </Window.Resources>
      <Grid>
        <Button ContentTemplate="{StaticResource ImageButton}"
                Content="{StaticResource YourImageButtonHere}"
                Height="50"
                Width="250" />
      </Grid>
</Window> 
```

我将资源用于对象，但您可以在 ViewModel 上使用属性。结果是：

![带有文本的图像按钮](../Images/9aa387e08a5e4bea12dae21de305681d.png)

而这只是一个普通的按钮。您可以使用 Caliburn.Micro 约定的所有功能，例如 Click 事件默认绑定。享受！

# scala - 带有异常的 Sql 查询。不能使用模式匹配

> ID：10584193
> 
> 赞同：0
> 
> 时间：2012-05-14T13:22:32.523
> 
> 标签：scala, anorm

下面显示的代码片段应该用于从数据库中检索一些数据。

```
import anorm._

object Instruction {

 def findAll(date:String):List[RealTimeInstruction]={

    query = SQL("""
                select * from instructions where date > {dd}
                """).on("dd"->date)
 }

} 
```

然后我想使用模式匹配来执行查询并处理结果。但是，当我尝试使用时，`query.map(...)`我得到以下信息：

> 值映射不是异常 SimpleSql 的成员。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:35:01.580

您需要创建一个 ResultSetParser 来将结果集解析为可以进行模式匹配的内容。也许像

```
val rowParser : RowParser[String~Date] = get[String]("instructions.name")~get[Date]("instructions.date")
val resultSetParser = rowParser *
(query as resultSetParser) map { case name~date => ... } 
```

# c# - AjaxFileUpload 隐藏上传按钮并手动处理上传？

> ID：10584194
> 
> 赞同：3
> 
> 时间：2012-05-14T13:22:32.617
> 
> 标签：c#, asp.net, asp.net-ajax

我想使用[AjaxFileUpload](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/AjaxFileUpload/AjaxFileUpload.aspx)控件：

我正在审查这个，我需要的功能是隐藏上传按钮，并从另一个按钮单击事件中保存所有按钮。

有可能吗？

根据他们显示的属性，我没有看到隐藏按钮的选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:01:17.197

查看源html，似乎在做：

```
$('.ajax__fileupload_uploadbutton').hide(); 
```

会做隐藏上传按钮的伎俩。但是，问题仍然存在，即当用户放下第一个文件或通过“选择”按钮选择它时是否触发了事件。我相信有一个你可以挂钩来调用上面的代码行（在我的例子中使用 jQuery）。

您可以使用纯 Javascript 实现相同的功能。

# javascript - 带有原型的多个 CSS 选择器

> ID：10584195
> 
> 赞同：0
> 
> 时间：2012-05-14T13:22:38.933
> 
> 标签：javascript, prototypejs, css-selectors, sizzle

我正在重构一些目前看起来像这样的代码：

```
$$('#wrapper > div').each(function(e){ 
    if((e.id!='header') && (e.id!='footer') && (e.id!='content')){
        // various other stuff here
    }
}); 
```

我想切换初始选择器并检查 ID 到单行，沿着这些行：

```
$$('#wrapper > div[id!=header]', '#wrapper > div[id!=content]', '#wrapper > div[id!=footer]') 
```

虽然多个选择器不起作用，但每个选择器本身都可以正常工作。不确定这是语法问题还是[原型文档](http://api.prototypejs.org/dom/dollar-dollar/)所说的应该有效，但是一旦我添加了额外的选择器，就没有任何效果。

要确认这有效：

```
$$('#wrapper > div[id!=header]') 
```

这有效：

```
$$('#wrapper > div[id!=footer]') 
```

但这无法选择（没有抛出错误）

```
$$('#wrapper > div[id!=header]', '#wrapper > div[id!=footer]') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:37:08.053

您可以将选择器彼此附加`div[attr selector 1][attr selector 2]` 请参阅以下[示例小提琴](http://jsfiddle.net/epoch/FKacW/)。

您最初尝试的问题。即使用逗号分隔选择器，它们是`OR`-ing。因此，即使您指定了所有三个，其他每个都将返回其他尝试排除的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:37:26.597

这两个代码片段做了完全不同的事情。与顶部片段等效的应该是这样的：

```
$$('#wrapper > div[id!=header][id!=footer][id!=content]') 
```

您的选择器将选择所有具有 的 div `id`，因为那些是“ `footer`”的 div 将在“非”下被选中`header`。

# powershell - 为什么我的 PowerShell 配置文件只会为 32 位版本的 powershell 加载？

> ID：10584199
> 
> 赞同：2
> 
> 时间：2012-05-14T13:22:47.413
> 
> 标签：powershell

根据本文档[http://msdn.microsoft.com/en-us/library/bb613488(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/bb613488(v=vs.85).aspx)我在以下位置创建了一个配置文件：

```
%windir%\system32\WindowsPowerShell\v1.0\Microsoft.PowerShell_profile.ps1 
```

该配置文件仅包含用于测试的基本功能。

当我运行 64 位版本的 PowerShell 时，配置文件不会加载。当我尝试调用测试函数时，PowerShell 返回错误。

当我运行 x86 版本时，配置文件正确加载，我可以调用该函数。

我已经在几台 64 位机器上对此进行了测试，并且每次都得到相同的结果。

如何让我的配置文件在 64 位版本中正确加载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:29:21.267

打开 PowerShell 的 64 位实例并创建配置文件。这些文件保存在不同的位置：64b - c:\windows\system32、32b (c:\windows\SysWOW64)。

# java - SWT 浏览器 - Swing 集成 - Mac - JDK 1.7

> ID：10584204
> 
> 赞同：3
> 
> 时间：2012-05-14T13:24:07.073
> 
> 标签：java, macos, swing, swt, swt-awt

是的，所以我在这里遇到了一个有趣的问题，涉及运行 java 1.7 的 mac 上的 SWT 和 swing 集成。我试图将 SWT 浏览器小部件作为面板嵌入到我的 Swing 项目中，这在 Java 1.6 版上非常简单。有许多帖子解释了如何使用 SWT_AWT 桥接类以及以下示例来执行此操作：

```
import java.awt.BorderLayout;
import java.awt.Canvas;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;
import org.eclipse.swt.SWT;
import org.eclipse.swt.awt.SWT_AWT;
import org.eclipse.swt.browser.Browser;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class MySWTBrowserTest implements ActionListener {

public JButton addCodeButton;
public JButton launchBrowserButton;
public JTextField inputCode;
public JFrame frame;
static Display display;
static boolean exit;

public MySWTBrowserTest() {
    frame = new JFrame("Main Window");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JPanel mainPanel = new JPanel();
    mainPanel.setLayout(new FlowLayout());

    inputCode = new JTextField(15);
    inputCode.setText("999");
    addCodeButton = new JButton("Add Code");
    addCodeButton.addActionListener(this);
    addCodeButton.setActionCommand("addcode");

    launchBrowserButton = new JButton("Launch Browser");
    launchBrowserButton.addActionListener(this);
    launchBrowserButton.setActionCommand("launchbrowser");

    mainPanel.add(inputCode);
    mainPanel.add(addCodeButton);
    mainPanel.add(launchBrowserButton);

    frame.getContentPane().add(mainPanel, BorderLayout.CENTER);
    frame.pack();
    frame.setVisible(true);
}

@Override
public void actionPerformed(ActionEvent e) {
    if (e.getActionCommand().equals("addcode")) {
    } else if (e.getActionCommand().equals("launchbrowser")) {
        createAndShowBrowser();
    }

}

public void createAndShowBrowser() {
    JFrame f = new JFrame();
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    final Canvas canvas = new Canvas();
    f.setSize(850, 650);
    f.getContentPane().add(canvas);
    f.setVisible(true);
    display.asyncExec(new Runnable() {

        @Override
        public void run() {
            Shell shell = SWT_AWT.new_Shell(display, canvas);
            shell.setSize(800, 600);
            Browser browser = new Browser(shell, SWT.NONE);
            browser.setLayoutData(new GridData(GridData.FILL_BOTH));
            browser.setSize(800, 600);
            browser.setUrl("http://www.google.com");
            shell.open();
        }
    });
}

public static void main(String args[]) {
    //SWT_AWT.embeddedFrameClass = "sun.lwawt.macosx.CEmbeddedFrame";
    display = new Display();

    EventQueue.invokeLater(new Runnable() {

        @Override
        public void run() {
            MySWTBrowserTest mySWTBrowserTest = new MySWTBrowserTest();
        }
    });

    while (!exit) {
        if (!display.readAndDispatch()) {
            display.sleep();
        }
    }
    display.dispose();
}
} 
```

我使用 swt-3.8M5-cocoa-macosx-x86_64 JAR 文件，显然需要包含这些文件才能运行上述示例。当同时使用 1.6 JDK 的 32 位和 64 位版本时，它运行得非常好，但是当切换到 JDK 1.7 或 1.8 VM 时，会抛出可重现的错误：

```
2012-05-14 15:11:30.534 java[1514:707] Cocoa AWT: Apple AWT Java VM was loaded on first thread -- can't start AWT. (
0   liblwawt.dylib                      0x00000008db728ad0 JNI_OnLoad + 468
1   libjava.dylib                       0x00000001015526f1 Java_java_lang_ClassLoader_00024NativeLibrary_load + 207
2   ???                                 0x00000001015a4f90 0x0 + 4317663120
)
_NSJVMLoadLibrary: NSAddLibrary failed for /libjawt.dylib
JavaVM FATAL: lookup of function JAWT_GetAWT failed. Exit
Java Result: 255 
```

我检查了 java 1.7 vm 并确实在那里找到了库，所以我努力想看看是什么导致它无法加载该库。当然，我确保使用： -XstartOnFirstThread 作为 VM 参数之一，这是 SWING/AWT 集成所必需的。

进一步说明，我尝试了 DJ Native Widgets 框架，它抛出了完全相同的错误，因为它也使用了底层的 SWT 框架。

为了重现效果，我建议在 mac 上安装 JDK 1.7（不是开发者预览版），下载：[http ://www.eclipse.org/downloads/download.php?file=/eclipse/downloads/drops4/S-4.2 M7-201205031800/swt-S-4.2M7-201205031800-cocoa-macosx-x86_64.zip](http://www.eclipse.org/downloads/download.php?file=/eclipse/downloads/drops4/S-4.2M7-201205031800/swt-S-4.2M7-201205031800-cocoa-macosx-x86_64.zip)获取库，然后使用 -XstartOnFirstThread -d64 java 1.7 vm 运行它。

*真的希望有人能够解决这个问题，因为我确定我不是唯一一个试图将 SWT 集成到 1.7 vm 上的 swing 的人*

我还在谷歌上花了 8 个小时来查看这个错误是否已在其他任何地方重现，并且它已经出现在一些 Matlab 邮件列表中，但除此之外，我还没有找到更接近解决方案的东西。

提前致谢。

* * *

# >> 更新 1

看起来我们可能有赢家：[https](https://bugs.eclipse.org/bugs/show_bug.cgi?id=374199) ://bugs.eclipse.org/bugs/show_bug.cgi?id= 374199 去监控它，看看它的去向。

# >> 更新 2

这是一个工作示例：[https ://stackoverflow.com/a/27754819/363573](https://stackoverflow.com/a/27754819/363573)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T03:01:46.177

不幸的是，这个问题没有好的答案。在 Java 7 中，AWT 已被完全重写为使用 CoreAnimation 层。SWT 假设 AWT Canvas 将由 NSView 支持，但现在不再如此。您现在唯一的选择是坚持使用 Java 6。

AWT 团队已意识到该问题，但您可能希望在 bugs.sun.com 上提交另一个错误。

# c++ - 实时和用户时间之间的巨大差异

> ID：10584205
> 
> 赞同：1
> 
> 时间：2012-05-14T13:24:10.487
> 
> 标签：c++, linux

我在两个不同的计算环境中运行相同的 C++ 实现，第一个是 Xeon 2.3 GHz 和 48 Gb 内存，第二个是 Core2 Duo 2.53 GHz 和 3 Gb 内存。对于编译，我使用了带有类似选项的 g++。我应该注意第一个系统是 64 位 Red Hat，第二个是 32 位 Ubuntu。另外，g++版本不同，第一个系统安装的是4.1.2版本，第二个系统安装的是4.6.1版本。

当我运行代码时，两个系统都返回完全相同的解决方案。对于每个系统，时间结果如下。

**System-1：**
真正的 0m19.623s
用户 2m13.588s
sys 0m3.118s

**System-2：**
真正的 0m11.229s
用户 0m11.785s
sys 0m1.496s

我有 2 个问题。

1.  为什么 System-1（更好的计算环境）运行的代码比 System-2 差？
2.  对于 System-1，实际时间和用户时间之间的差异是相当大的。为什么会出现这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:30:50.963

为什么用户时间很大？

如果您有 2 个核心，每个核心都在用户模式下运行 1 分钟，那么您将获得 2 个用户分钟。

这暗示您的代码在多线程上表现不佳。诸如忙于等待锁定争用或缓存争用之类的原因可能是原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T22:58:00.173

问题已经解决了。我在我的应用程序中使用共享库。我意识到这个共享库在其默认设置中是多线程的。我将它设置为单线程，然后它开始在两个系统中正常工作。

# c# - 在窗体之间切换

> ID：10584206
> 
> 赞同：1
> 
> 时间：2012-05-14T13:24:10.707
> 
> 标签：c#, .net, winforms

我有一堆窗体。每个表格都有用于切换表格的“返回”和“下一步”按钮。例如，在 Form3 上单击“返回”，然后我们转到 Form2。然后单击 Form2 上的“下一步”按钮，然后显示 Form3。

现在我的问题是，如果我们从一开始就单击“下一步”，它就会顺利运行。但是，如果我在 Form3 上单击“返回”，则会显示 Form2，然后在 Form3 上单击“下一步”转到 Form3。代码没有转到 Form3_Load 事件。我的代码有什么问题？

```
 public partial class Form3 : Form
{
    Form2 FormPrev;
    Form4 FormNext;
    List<DataRow> drlist = new List<DataRow>();
    DataTable dt = new DataTable();

    public Form3(Form2 _FormPrev)
    {
        InitializeComponent();
        this.FormPrev = _FormPrev;
    }

    private void btnCancel_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    private void btnNext_Click(object sender, EventArgs e)
    {
        ShowNext();
    }

    private void btnBack_Click(object sender, EventArgs e)
    {
        ShowPrev();
    }

    private void ShowNext()
    {
        if (FormNext == null)
            FormNext = new Form4(this);
        FormNext.Show();
        this.Hide();
    }

    private void ShowPrev()
    {
        FormPrev.Show();
        this.Hide();
    }

    private void Form3_Load(object sender, EventArgs e)
    {
       // blah blah.
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:30:48.163

表单的 Load 事件仅在第一次调用表单时触发。如果您随后隐藏表单并重新显示它，那么这不会重新加载表单，因此不会触发表单的 Load 事件。

如果您想在重新显示表单时使用事件来处理，那么您应该查看以下更合适的事件：

已激活显示可见已更改

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:29:08.093

表单加载事件仅在表单第一次显示之前被触发。您应该使用不同的事件，例如 Form Activated 或 GotFocus。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:31:52.077

这是正常的行为。加载是为了加载形式，而不是为了展示。在您的情况下，您尝试显示隐藏的形式。如果你想使用

```
form.Show() 
```

比不使用

```
form.Hide() 
```

但

```
form.Close() 
```

**UPD：** 代码应该是：

```
public partial class Form3 : Form
{
    List<DataRow> drlist = new List<DataRow>();
    DataTable dt = new DataTable();

    public Form3()
    {
        InitializeComponent();
    }

    private void btnCancel_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    private void btnNext_Click(object sender, EventArgs e)
    {
        ShowNext();
    }

    private void btnBack_Click(object sender, EventArgs e)
    {
        ShowPrev();
    }

    private void ShowNext()
    {
        Form4 formNext = new Form4();
        formNext.Show();
        this.Close();
    }

    private void ShowPrev()
    {
        Form2 formPrev = new Form2();
        formPrev.Show();
        this.Close();
    }

    private void Form3_Load(object sender, EventArgs e)
    {
       // blah blah.
    }
} 
```

但是这样的解决方案存在一个问题——你不应该关闭你的主窗体。

# facebook - Facebook：将请求的发件人链接到收件人？

> ID：10584208
> 
> 赞同：0
> 
> 时间：2012-05-14T13:24:13.950
> 
> 标签：facebook, facebook-graph-api

使用请求对话框时，facebook 会发出如下通知：

![在此处输入图像描述](../Images/f2cfebddb7614075d9e7f53a96893535.png)

我希望实现的是用户单击上面显示的请求链接并在我们的应用程序上显示“随机用户邀请您...”消息。

但是，当单击该链接时，Facebook 似乎没有将“随机用户”的 id 传递给应用程序。链接访问的 url 类似于：

```
http://apps.facebook.com/randomcomp/?fb_source=notification&request_ids=350578327437399,350578327437399&ref=notif&app_request_type=user_to_user&notif_t=app_request 
```

其中不包含对发起请求的用户的任何引用。

从应用程序的角度来看，似乎没有办法从 Facebook 获取这些信息。当然，您可以获得请求列表，但该列表可以包含许多请求的信息，包括来自*其他*用户的请求以及我们感兴趣的请求，因此在这种情况下它没有用处。例如，这是数据的快照：

```
{
    "data": [
    {
        "id": "340083146057323_100003817986566",
        "application": {
            "name": "Random Competition",
            "namespace": "randomcomp",
            "id": "350578327437399"
        },
        "to": {
            "name": "Hannah Smith",
            "id": "100003817986566"
        },
        "from": {
            "name": "Random User",
            "id": "100002286042525"
        },
        "data": "100002286042525",
        "message": "Use the app!",
        "created_time": "2012-05-14T13:26:30+0000"
    }, {
        "id": "358318457550141_100003817986566",
        "application": {
            "name": "Random Competition",
            "namespace": "randomcomp",
            "id": "350578327437399"
        },
        "to": {
            "name": "Hannah Smith",
            "id": "100003817986566"
        },
        "from": {
            "name": "Jane Young",
            "id": "100003771838663"
        },
        "data": "100002286042525",
        "message": "Use the app!",
        "created_time": "2012-05-14T10:54:25+0000"
    }],
    }
} 
```

如您所见，`data`正在传入，但*仍然*无法将来自上述链接（对于随机用户）的点击加入列表中的正确请求；链接通过**两个**请求的 ID，而不仅仅是随机用户的 ID，并且虽然链接状态为“随机用户”，但它不通过标识符。

我错过了什么吗？是否有文档中没有的机制允许我获取“随机用户”ID，以便当他们点击时我可以在应用程序中提供一个很好的“随机用户邀请您...”消息？

**编辑：**

事实证明这是不可能的 - 请参阅[我的答案](https://stackoverflow.com/a/10585942/30478)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:39:47.990

您可以向请求中添加一些数据，以便在处理请求时可以将其与其他请求区分开来。

数据可以与应用请求和用户请求一起发送，参数名称为*“数据”*。例如，在[请求对话框](http://developers.facebook.com/docs/reference/dialogs/requests/)的指南中，您可以在文档（几乎）末尾的属性表中看到它，它说：

> 您可以传递用于跟踪的可选附加数据。这将作为创建的请求对象的一部分存储。最大长度为 255 个字符

[Social Channels](http://developers.facebook.com/docs/channels/)文档中也有一些关于它的信息，官方博客文章中关于[Upgrade to Requests 2.0](http://developers.facebook.com/blog/post/464/)的 (php) 使用示例。

我希望这就是你要找的。

* * *

# 编辑

当您发送请求时，您知道是谁在发送它吗？它是登录用户，因此您可以将用户 id/name/etc 放在请求的 data 参数中。然后，当有人点击请求时，通过 facebook 传递给您的 id 获取请求，并从数据中提取发送者的用户 id。

正如文档所述，您有 255 个字符可供使用，并且您可以做任何您想做的事情，您甚至可以将对象序列化为该参数并在以后反序列化它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:04:10.100

事实证明，这实际上根本不可能。

该链接如下图所示，可以呈现多个用户：

![在此处输入图像描述](../Images/621b5d33d28a997092c2a63a088f0457.png)

这就是为什么传入多个请求 ID 而不是发送者 ID 的原因。

# objective-c - 背景图像的objective-c内存友好方式

> ID：10584217
> 
> 赞同：3
> 
> 时间：2012-05-14T13:24:41.520
> 
> 标签：objective-c, memory-leaks, background-image, memory-warning

我有一个 ipad 应用程序（>30 个视图/页面）每个视图都有一个独特的背景。

问题：设置背景的最佳方法是什么（内存友好）

**有没有比添加：uiimageview“backgroundView”作为子视图更好的方法？**

版本1：

```
[[UIImage alloc] initWithData:imageData]; 
```

视网膜开关似乎有问题

版本2：

```
self.layer.contents = (id)image.CGImage; 
```

第 3 版：

```
UIImage* image = [UIImage imageWithContentsOfFile:fileLocation]; 
```

**版本 2 似乎工作正常。**也许有人告诉我什么是最好的方法，为什么;）

谢谢亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:15:58.213

`CGImage`视网膜有问题...版本3。最适合记忆！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:19:09.883

在版本 2 中，如果您不使用 ARC，您必须手动发布一个新的图像对象。版本 3 使用自动释放的对象。

两个版本在内存友好性方面是相同的。我更喜欢版本 3，因为您不必自己做任何事情来释放内存。

您还可以使用 [UIImage imageNamed:@"image-name.png"]，它还会生成一个自动释放的对象。

如果您希望它尽可能对内存友好，则应考虑使用 PVR 图像，因为这些图像是由图形硬件本机支持的。

最好的，

弗洛

# struct - 如何在 WinRT 组件 C++/CX 中通过引用传递结构

> ID：10584221
> 
> 赞同：3
> 
> 时间：2012-05-14T13:24:49.917
> 
> 标签：struct, components, windows-runtime, c++-cx

我的 WinRT 组件中有以下内容：

```
public value struct WinRTStruct
{
    int x;
    int y;
};

public ref class WinRTComponent sealed
{
    public:
    WinRTComponent();
    int TestPointerParam(WinRTStruct * wintRTStruct);
};

int WinRTComponent::TestPointerParam(WinRTStruct * wintRTStruct)
{
    wintRTStruct->y = wintRTStruct->y + 100;
    return wintRTStruct->x;
} 
```

但是，当从 C# 调用时，winRTStruct->y 和 x 的值在方法内似乎始终为 0：

```
WinRTComponent comp = new WinRTComponent();
WinRTStruct winRTStruct;
winRTStruct.x = 100;
winRTStruct.y = 200;
comp.TestPointerParam(out winRTStruct);
textBlock8.Text = winRTStruct.y.ToString(); 
```

通过引用传递结构以便在用 C++/CX 编写的 WinRTComponent 的方法中更新它的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T02:48:32.993

您不能通过引用传递结构。winrt 中的所有值类型（包括结构）都是按值传递的。Winrt 结构体预计相对较小——它们旨在用于保存 Point 和 Rect 之类的东西。

在您的情况下，您已经指出该结构是一个“out”参数 - “out”参数是只写的，它的内容在输入时被忽略并在返回时被复制出来。如果您希望结构进出，请将其拆分为两个参数 - 一个“in”参数和另一个“out”参数（WinRT 中不允许使用 in/out 参数，因为它们不会以您期望的方式投射到 JS他们进行项目）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T13:36:05.493

我的同事帮我解决了这个问题。在 WinRT 组件中，似乎最好的方法是定义一个 ref 结构而不是一个值结构：

```
public ref struct WinRTStruct2 sealed
{
private: int _x;
public:
 property int X
 {
    int get(){ return _x; }
    void set(int value){ _x = value; }
 }
private: int _y;
public:
 property int Y
 {
    int get(){ return _y; }
    void set(int value){ _y = value; }
 }
}; 
```

但这会产生其他问题。现在，当我尝试向 ref 结构添加一个返回结构实例的方法时，VS11 编译器会给出 INTERNAL COMPILER ERROR。

# vb.net - 用于在 Visual Basic 2010 中计算加权平均值的通用 LINQ 扩展

> ID：10584222
> 
> 赞同：1
> 
> 时间：2012-05-14T13:25:05.267
> 
> 标签：vb.net, linq, vb.net-2010

我编写了以下通用 LINQ 扩展，用于在 Visual Basic 2010 中计算加权平均值：

```
<Extension()>
Function WeightedAverage(Of T)(ByVal source As IEnumerable(Of T),
              ByVal selectorValue As Func(Of T, Integer),
              ByVal selectorWeight As Func(Of T, Integer)) As Double
  Dim weightedValueSum As Double
  Dim weightSum As Integer

  weightedValueSum = (From element In source
                      Select (selectorValue(element) * selectorWeight(element))).Sum()
  weightSum = (From element In source
               Select selectorWeight(element)).Sum()
  If weightSum <> 0 Then
      Return weightedValueSum / weightSum
  Else
      Return 0
  End If
End Function 
```

如何将此函数称为另一个 LINQ 查询的聚合函数？

我通过以下方式进行了尝试：

```
Dim q1 = From jd In oContext.JobDatas
         Where jd.Year = 2011
         Select jd
Dim q2 = Aggregate num In q1 Into WeightedAverage(num.AvSalary, num.NumPosHolder) 
```

Visual Basic 2010 编辑器告诉我以下代码的第二个查询 (q2) 不是有效语句。在第一个和第二个参数之间的逗号上说：“）”需要。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:02:57.410

使用 Aggregate 函数有什么特别的原因吗？如果您只想计算第一个查询的加权平均值，您可以这样做：

```
Dim q1 = From jd In oContext.JobDatas
         Where jd.Year = 2011
         Select jd
Dim avg As Double = q1.WeighedAverage(Function(num) num.AvSalary, Function(num) num.NumPosHolder) 
```

# jsf - 如何从中获取价值 ?

> ID：10584223
> 
> 赞同：1
> 
> 时间：2012-05-14T13:25:08.417
> 
> 标签：jsf, selectonemenu

我想从中获取价值。我尝试了这段代码，但它不起作用：

```
<h:form>
        <h:outputLabel value="départements : "/>
        <h:selectOneMenu value="#{departementController.selected.id}" onchange="submit()" immediate="true">
            <f:valueChangeListener type="Controller.Listener.DepartementValueListener"/>
            <f:selectItems value="#{departementController.itemsAvailableSelectOne}"/>
        </h:selectOneMenu>

        <h:outputLabel value="nouvelle valeur : "/>

        <h:inputText value="#{departementController.comboBox}" id="dep"/>
    </h:form> 
```

控制器：

```
 //departement change listener
private String comboBox;

public String getComboBox() {
    return comboBox;
}

public void setComboBox(String comboBox) {
    this.comboBox = comboBox;
}

public void departementChangeListener(ValueChangeEvent e) {
    // Skip validation of non-immediate components and invocation of the submit() method.
    FacesContext.getCurrentInstance().renderResponse();
    this.comboBox = e.getNewValue().toString();} 
```

sourceId=j_idt7:j_idt9[severity=(ERROR 2), summary=(j_idt7:j_idt9 : erreur de validation. La valeur est wronge.), detail=(j_idt7:j_idt9 : erreur de validation. La valeur est wronge.)]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:48:41.463

毕竟你有两个问题。

首先，错误*“erreur de validation. La valeur estcorrecte”是**“Validation Error: Value is not valid”*的法语翻译，意思是提交的值不存在`equals()`任何一个可用的项目`<f:selectItems>`。您的代码不够完整，无法指出根本原因，但我*猜*您有一个`List<Department>`，`<f:selectItems value>`因此每个项目都是`Department`，但您试图将其设置为`String`值`id`而不是 as `Department`。这个不对。您需要在 and 之间提供一个转换器，`Department`并改为`String`使用`#{departementController.selected}`。

像这样的东西：

```
<h:selectOneMenu value="#{bean.selectedDepartment}">
    <f:selectItems value="#{bean.availableDepartments}" />
</h:selectOneMenu> 
```

和

```
private Department selectedDepartment;
private List<Department> availableDepartments; 
```

以及在其唯一表示`@FacesConverter`之间进行转换的 a 。`Department``String`

您的第二个问题是您似乎过于关注以 JSF 1.x 为目标的示例，而不是在更改下拉列表时填充另一个字段。您为此使用了一个相当笨拙/笨拙的 JSF 1.x 解决方法。在 JSF 2.x 中，您可以只使用`<f:ajax>`它。

```
<h:selectOneMenu value="#{bean.selectedDepartment}">
    <f:selectItems value="#{bean.availableDepartments}" />
    <f:ajax listener="#{bean.changeDepartment}" render="inputId" />
</h:selectOneMenu>
<h:inputText id="inputId" value="#{bean.input}" /> 
```

和

```
public void changeDepartment() {
    input = selectedDepartment.getId();
} 
```

### 也可以看看：

*   [我们的 selectonemenu wiki 页面](https://stackoverflow.com/tags/selectonemenu/info)

# iphone - 字符串目标 C 中的字符出现

> ID：10584230
> 
> 赞同：13
> 
> 时间：2012-05-14T13:25:21.993
> 
> 标签：iphone, objective-c, ipad, nsstring

如何计算字符串中某个字符的出现次数？

*例子*

*字符串：123-456-7890*

*我想在给定的字符串中找到“-”的出现次数*

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-14T13:35:02.137

你可以简单地这样做：

```
NSString *string = @"123-456-7890";
int times = [[string componentsSeparatedByString:@"-"] count]-1;

NSLog(@"Counted times: %i", times); 
```

**输出：**

`Counted times: 2`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:35:30.487

这将完成工作，

```
int numberOfOccurences = [[theString componentsSeparatedByString:@"-"] count]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T13:45:09.610

我为你做了这个。试试这个。

```
unichar findC;
int count = 0;
NSString *strr = @"123-456-7890";

for (int i = 0; i<strr.length; i++) {
    findC = [strr characterAtIndex:i];
    if (findC == '-'){
        count++;
    }
}

NSLog(@"%d",count); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T13:30:46.480

```
int num = [[[myString mutableCopy] autorelease] replaceOccurrencesOfString:@"-" withString:@"X" options:NSLiteralSearch range:NSMakeRange(0, [myString length])]; 
```

该`replaceOccurrencesOfString:withString:options:range:`方法返回进行的替换次数，因此我们可以使用它来计算字符串中有多少`-`s。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T13:33:54.763

```
int total = 0;
NSString *str = @"123-456-7890";
for(int i=0; i<[str length];i++)
{
    unichar c = [str characterAtIndex:i];
    if (![[NSCharacterSet alphanumericCharacterSet] characterIsMember:c])
    {
        NSLog(@"%c",c);
        total++;
    }
}
NSLog(@"%d",total); 
```

这行得通。希望能帮助到你。快乐编码:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-14T13:33:07.850

您可以使用`replaceOccurrencesOfString:withString:options:range:`以下方法`NSString`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-30T04:07:54.790

如果字符串以您正在检查的字符开头或结尾，则当前选择的答案将失败。

改用这个：

```
int numberOfOccurances = (int)yourString.length - (int)[yourString stringByReplacingOccurrencesOfString:@"-" withString:@""].length; 
```

# php - php - 创建一个函数，稍后在同一页面中使用

> ID：10584235
> 
> 赞同：0
> 
> 时间：2012-05-14T13:25:38.243
> 
> 标签：php, function

我正在尝试向我的页面“functions.php”添加一个名为“addNotification”的函数

我的功能：

```
function addNoti($text,$userid)
{
    mysql_query("INSERT INTO notifications (time,text,userid) VALUES('".time()."','$text','$userid')");
    if(mysql_affected_rows() != 1)
        return 2;
    else
        return 100;
} 
```

几百行下面^（同一页），我有我的注册功能“注册”：

```
 function doRegister()
    {

        global $datesetting;
mysql_query("query to register goes here");
addNoti("You just joined us!","$userid");

} 
```

虽然，每当我处理我的注册表单时，我都会收到以下错误：

```
Fatal error: Call to undefined function addNoti() in /home/domain/public_html/path/to/functions.php on line 278 
```

（第 278 行是调用 addNoti 的地方）

每当我尝试将 addNoti 移动到另一个页面并在 functions.php 中加载该页面时，我都不会出错。

请帮忙。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:31:31.643

请记住，在 PHP 中，您可以在条件块中声明函数。可能是在您的代码执行中使用了另一个分支并且从未到达函数定义。检查代码块，检查带有函数定义的代码是否被执行（`echo`或者`var_dump`是你的朋友）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:37:06.413

是错字吗？在您的问题中，您命名函数`addNotification`并`addNoti()`...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:28:25.123

你在你的脚本中发生 addNoti() 之前调用 doRegister() 吗？！就是那个问题！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:34:58.250

仅从这两个功能很难说问题出在哪里。您是否不小心将函数 addNoti 放在另一个函数中（在右括号之前）？

# python - Position cursor at specifc line

> ID：10584241
> 
> 赞同：1
> 
> 时间：2012-05-14T13:25:56.523
> 
> 标签：python, qt, qt4, pyqt

I want to put the cursor at the start of a line in a `QPlainTextEdit` specified by its line number. The problem is I have the "real" line number, i.e. the number of `\n` between the line and the start, while the cursor seems to be using "virtual" line numbers, i.e. including the line wraps done by the textedit.

Which means that the following does not work correctly:

```
old_line = textedit.textCursor().blockNumber()
line = token.line
diff = line - old_line
move = QtGui.QTextCursor.Down if diff >= 0 else QtGui.QTextCursor.Up
for _ in range(abs(diff)): textedit.moveCursor(move, QtGui.QTextCursor.MoveAnchor) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:53:47.927

The simple solution I went with was to deactivate line wrapping before moving the cursor and activating it afterwards again:

```
textedit.setLineWrapMode(QtGui.QPlainTextEdit.NoWrap)
# above code in between here
textedit.setLineWrapMode(QtGui.QPlainTextEdit.WidgetWidth) 
```

Most certainly horribly inefficient but for my few hundred lines long text it works fine without any noticeable lag.

# sql-server - 与主数据库的默认连接

> ID：10584254
> 
> 赞同：0
> 
> 时间：2012-05-14T13:27:10.383
> 
> 标签：sql-server, connection, master

我们的应用程序托管在多层环境中。当应用程序服务器创建与 SQL Server 的连接时，它会在其默认数据库（假设 xyz）上打开连接，但是当使用相同连接字符串的数据服务器在默认数据库和主数据库上打开连接时。

有什么理由吗。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:39:55.280

检查数据服务器上的连接属性。驱动程序（OLEDB、ODBC、ADO.NET）都应该能够识别它们连接到的默认数据库。我的猜测是，由于驱动程序属性，数据服务器驱动程序默认连接到主数据库。

# php - PHP - 如何在函数中使用 SWITCH

> ID：10584258
> 
> 赞同：2
> 
> 时间：2012-05-14T13:27:17.157
> 
> 标签：php, function, switch-statement

我试图减少代码中选择语句、更新等的数量，所以我想我会尝试为此创建一个函数，但是我很困惑我的努力在第一个障碍中失败了。

我已经非常全面地搜索了这个问题（我觉得），并且在我找到的示例中找不到任何差异。

这是我的功能，带有打印语句，可帮助我诊断问题。

```
function select_statement($action, $table, $where){
print $action.' - ';

switch ($action){
    case 'select':
        print 'select used - ';
        $thequery = 'SELECT * FROM '. $table . ' WHERE '. $where;
    case 'insert':
        print 'insert used - ';
        $thequery = 'INSERT INTO '. $table;
    case 'update':
        print 'update used - ';
        $thequery = 'UPDATE ' . $table . ' SET ';
    }
print $thequery;
mysql_query($thequery);

} 
```

这是调用该函数的行：-

```
$logins = select_statement('select', 'users', 'user_id=1');//calls function 
```

这是结果：-

```
select - select used - insert used - update used - UPDATE users SET 
```

如您所见，代码正在触发每个打印语句，并且似乎忽略了“case”语句。

我真的不确定我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:28:07.310

你忘了使用`break`. 没有它，每个 case 语句都将“落空”到下一个并继续运行。在每条语句`break`的末尾停止执行`;`case`

```
switch ($action){
    case 'select':
        print 'select used - ';
        $thequery = 'SELECT * FROM '. $table . ' WHERE '. $where;
        break;
    case 'insert':
        print 'insert used - ';
        $thequery = 'INSERT INTO '. $table;
        break;
    case 'update':
        print 'update used - ';
        $thequery = 'UPDATE ' . $table . ' SET ';
        break;
    } 
```

# python - 在 Ubuntu/Xubuntu 中管理库

> ID：10584259
> 
> 赞同：1
> 
> 时间：2012-05-14T13:27:25.343
> 
> 标签：python, ubuntu

我已经使用Xubuntu 大约一年了，但我无法解决一个问题（我知道重新安装操作系统肯定会有所帮助，但我仍然认为我会多次遇到这个问题）。通常，库所在的文件夹有两个（或者我认为只有两个必要的文件夹，这样程序才能正常安装和工作）。它们在内容上彼此相似

```
~/usr/

~/usr/local/ 
```

唯一不明白的是软件先搜索的是哪个文件夹。我有很多问题。例如，当我尝试启动软件中心时，我遇到了错误

```
ERROR:root:Could not find any typelib for Gtk
Traceback (most recent call last):
  File "/usr/bin/software-center", line 33, in <module>
    from gi.repository import Gtk
ImportError: cannot import name Gtk 
```

因此，Gtk 最初​​位于我提到的第一个文件夹中的 gi.repository 中，但在第二个文件夹中不存在。当我从第二个文件夹中删除 gi.repository 时，它给了我第二个类似于第一个错误

```
ERROR:root:Could not find any typelib for GObject
Traceback (most recent call last):
  File "/usr/bin/software-center", line 31, in <module>
    from gi.repository import GObject
ImportError: cannot import name GObject 
```

GObject 存在于第二个文件夹中，而第一个文件夹中不存在，并且我已将其删除，正如我所提到的。当我再次重新安装它时，它返回到第一个错误。我通过直接重装操作系统解决了这个问题，但我认为这会导致更多的问题。那么如何管理程序以安装、搜索和使用仅来自一个文件夹的库？抱歉，如果这个问题很长或很愚蠢，我是 Xubuntu 的新手 :)

# c# - 从 OperationContract 方法返回图像（WCF 服务）

> ID：10584260
> 
> 赞同：4
> 
> 时间：2012-05-14T13:27:28.680
> 
> 标签：c#, wcf, image

我正在尝试`Image`从 WCF 服务中获取。

我有一个`OperationContract`返回给客户端的函数`Image`，但是当我从客户端调用它时，我得到了这个异常：

> 套接字连接被中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为“00:00:59.9619978”。

客户：

```
private void btnNew_Click(object sender, EventArgs e)
{
    picBox.Picture = client.GetScreenShot();
} 
```

服务.cs：

```
public Image GetScreenShot()
{
    Rectangle bounds = Screen.GetBounds(Point.Empty);
    using (Bitmap bmp = new Bitmap(bounds.Width,bounds.Height))
    {
        using (Graphics g = Graphics.FromImage(bmp))
        {
            g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
        }
        using (MemoryStream ms = new MemoryStream())
        {
            bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
            return Image.FromStream(ms);
        }
    }
} 
```

`IScreenShot`界面：

```
[ServiceContract]
public interface IScreenShot
{
    [OperationContract]
    System.Drawing.Image GetScreenShot();
} 
```

那么为什么会发生这种情况，我该如何解决呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T20:50:24.787

我已经想通了。

*   首次使用`TransferMode.Streamed`或`StreamedResponse`（取决于您的需要）。
*   返回流，不要忘记设置`Stream.Postion = 0`，以便从头开始读取流。

在服务中：

```
public Stream GetStream()
{
    Rectangle bounds = Screen.GetBounds(Point.Empty);
    using (Bitmap bmp = new Bitmap(bounds.Width, bounds.Height))
    {
        using (Graphics g = Graphics.FromImage(bmp))
        {
            g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
        }
        MemoryStream ms = new MemoryStream();
        bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
        ms.Position = 0;  // This is very important
        return ms;
    }
} 
```

界面：

```
[ServiceContract]
public interface IScreenShot
{
    [OperationContract]
    Stream GetStream();
} 
```

在客户端：

```
public partial class ScreenImage: Form
{
    ScreenShotClient client;
    public ScreenImage(string baseAddress)
    {
        InitializeComponent();
        NetTcpBinding binding = new NetTcpBinding(SecurityMode.None);
        binding.TransferMode = TransferMode.StreamedResponse;
        binding.MaxReceivedMessageSize = 1024 * 1024 * 2;
        client = new ScreenShotClient(binding, new EndpointAddress(baseAddress));
    }

    private void btnNew_Click(object sender, EventArgs e)
    {
        picBox.Image = Image.FromStream(client.GetStream());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T13:45:25.523

您可以使用 Stream 返回大数据/图像。

[来自 MSDN 的示例示例（将图像作为流返回）](http://msdn.microsoft.com/en-us/library/cc681221.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:39:33.697

您将需要定义可序列化的内容。`System.Drawing.Image`是，但默认情况下不在 WCF 的上下文中（使用`DataContractSerializer`）。这可能包括将原始字节作为数组返回，或序列化为字符串（base64，JSON）或实现[`DataContract`](http://msdn.microsoft.com/en-us/library/ms733127.aspx)可序列化并可以携带数据的 a。

正如其他人所说，WCF 支持流式传输，但这不是问题的症结所在。根据您可能希望执行此操作的数据大小，这样做会减少问题本身，因为您将流式传输字节（从明显的顶级视图）。

您还[可以查看此答案](https://stackoverflow.com/questions/9737399/wcf-hosting-issues/9737481#9737481)以帮助您了解实际的异常详细信息，例如完整的堆栈跟踪，而不仅仅是故障信息。

# continuous-integration - 詹金斯 - 多个位置的 SVN。是否可以指定构建版本

> ID：10584262
> 
> 赞同：1
> 
> 时间：2012-05-14T13:27:37.387
> 
> 标签：continuous-integration, jenkins

我是 Jenkins CI 工具的新手，我想知道当有多个项目在不同的 SVN 位置相互依赖时，是否可以指定要使用的构建。例如，如果我在 SVN location1 上有 web 项目，在 SVN location2 上有后端项目，并且 web 依赖于后端，并且其中一个开发人员在后端修改了某些内容，那么当 web 开发人员进行提交时，将会出现构建失败. 是否有可能指定来自 Web 部件的构建应该考虑来自后端的构建 x 而不是最新的构建？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T20:14:59.070

您针对另一个项目的特定版本构建项目的示例有点不标准，但并非不可能。

在您的情况下，我会使用 Jenkins 执行任意脚本的能力来提供帮助。该脚本将负责获取我要构建的项目所依赖的项目的正确版本。

在您的 Web 和后端项目示例的基础上，我将在不使用参数化构建的情况下执行以下操作：

1.  向 Web 项目的存储库添加一个文件，该文件存储要使用的后端项目的版本
2.  在 SVN 中后端项目的源发生更改时，配置作业以构建 Web 项目。
    1.  该项目应签出最新版本的 Web 项目
    2.  项目的第一个构建步骤将是执行以下操作的脚本（执行 Shell 或执行 Windows 批处理命令）：
        1.  从包含版本信息的文件中获取要使用的后端版本
        2.  从后端的存储库中提取适当版本的后端；或拉取适当版本的后端源的源
    3.  （如果你只为后端拉取源，下一个构建步骤应该是构建后端）
    4.  构建 Web 部分
    5.  做任何单元测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:36:24.807

是的，可以做到。在 Jenkins 中检查项目 web-settings 中的**Build Triggers选项，并在****构建其他项目后的 Build**行上，您可以在对基础项目进行更改后指定要自动构建的项目的名称。

同样，在**Post-build Actions**中，查找**Build other projects**，您可以在其中指定如果基础项目构建成功，它将自动触发子项目的构建。

希望这可以帮助。

# jquery - jQuery 高度调整

> ID：10584266
> 
> 赞同：1
> 
> 时间：2012-05-14T13:27:57.437
> 
> 标签：jquery, css, height

有没有办法说：如果约翰的身高大于迈克的身高，那么让迈克的身高等于约翰的身高？CSS（虽然我不相信这可以用 CSS 完成）或 jQuery。

查看图片 --> [http://i50.tinypic.com/2ecdstw.jpg](http://i50.tinypic.com/2ecdstw.jpg)了解我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:32:37.660

```
var john = $("#john").css('height'), //use css
    mike = $("#mike").height(); //or just the height() method

if (john>mike) mike=john; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:35:28.157

```
 $.fn.equalHeight = function(){
    var h = 0;
    this.each(function(){
        h = Math.max(h, $(this).height());
    }).height(h);
 }; 
```

这个小插件是你需要的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:35:39.903

[你可以使用 jQuery 使用height](http://api.jquery.com/height/)样式属性来做这样的事情。

```
if($(".john").height() > $(".mike").height())
{
    $(".john").height($(".mike").height());
} 
```

**更新**

[上述代码的演示](http://codepen.io/pen/319/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:36:41.840

## *[jsBin 演示](http://jsbin.com/inewen/edit#javascript,html,live)*

```
$(".elements").height(Math.max.apply(null, $(".elements").map(function () {
    return $(this).height();
}).get())); 
```

* * *

## *这是唯一的 CSS 解决方案：*

```
 .el_wrapper{
    position:relative;
    display:table;
    overflow:hidden;
  }      
  .el{
    position:relative;
    display:inline-block;
    overflow:hidden;
    width:150px;
    float:left;
    background:#eee;
    margin:3px;
    padding:10px;
    margin-bottom:-3000px;
    padding-bottom:3015px;
  } 
```

## *[jsBin 演示 2](http://jsbin.com/inewen/4/edit)*

# ruby-on-rails-3 - 如何指定用于 Ruby on Rails Mailer 的语言

> ID：10584268
> 
> 赞同：0
> 
> 时间：2012-05-14T13:28:06.137
> 
> 标签：ruby-on-rails-3

首先：我使用的是 Ruby On Rails 3.2.x

我有一个正在运行的观察者，它在保存订单时触发电子邮件，准确地说是两封电子邮件，一封给卖家，一封给买家。

一切正常，ActionMailer 发送电子邮件。我现在添加了多语言支持，即用户可以在他的用户设置中设置他的首选语言。

不幸的是，ActionMailer 现在以触发订单处理的用户设置的语言发送两封电子邮件，因此如果订单的另一方与发起人不同，则会收到错误的语言。

如何让 ActionMailer 在发送电子邮件时使用特定的语言环境/语言？

我确实遇到过

```
<%= I18n.t('daily_mail.hello', :locale => @user.locale) + @user.name %> 
```

但这不起作用，因为我对不同的语言有不同的看法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:03:58.863

一些进展，解决方案似乎有效，我没有注意到任何副作用。

我存储当前语言环境

```
tmp = I18n.locale
I18N.locale = User.find(uid).language
# send the emails
I18n.locale = tmp 
```

这是正确的方法吗？我应该注意哪些可能的副作用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-26T09:08:04.953

```
I18n.with_locale(locale) do
  # send the email
end 
```

我找到了一个更好的方法来做到这一点。

# php - jScrollPane 在类刷新后重置为原始状态

> ID：10584279
> 
> 赞同：0
> 
> 时间：2012-05-14T13:28:36.230
> 
> 标签：php, jquery, refresh, jscrollpane

我有一个网站，其中有一个包含 Youtube 视频及其评论的部分。使用以下代码，div 类中的注释每 5 分钟刷新一次：

```
<script type="text/javascript">
    setInterval(function(){
        $(".comments").load("test.php .comments");
    }, 300000);
</script> 
```

评论滚动条由 jScrollPane 提供支持。然而，在评论刷新后，滚动条消失并恢复到原来的浏览器滚动条。我已经尝试调整上面的脚本，这样也刷新了滚动条，但没有希望。

评论的容器如下图

```
 echo '<div class="comments scroll">';

        $feedURL = curl_init("http://gdata.youtube.com/feeds/api/videos/{$cut}/comments");
            curl_setopt($feedURL, CURLOPT_RETURNTRANSFER, true);
            curl_setopt($feedURL, CURLOPT_HEADER, 0);

        $data = curl_exec($feedURL);
            curl_close($feedURL);

        $sxml = new SimpleXmlElement($data);            

        foreach($sxml->entry as $comment)
            {
            echo '<p>',$comment->content,'</br><i>',$comment->author->name,'</i></br>','</p>';
            }
    echo '</div>'; 
```

有人可以建议如何解决此错误。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:43:30.323

```
<script type="text/javascript">
    setInterval(function(){
        $(".comments").load("test.php");

        $('.scroll').jScrollPane();
    }, 300000);   
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T03:02:01.983

感谢@ThulasiRam 的想法，终于解决了。不过做了个小改动。

```
<script type="text/javascript">
   setInterval(function(){
      $(".comments").load("test.php .comments");
      $('.scroll').jScrollPane({showArrows:true});
   }, 300000);   
</script> 
```

# xslt - 如何在我的 XSLT 文本输出中包含节点 XML？

> ID：10584282
> 
> 赞同：5
> 
> 时间：2012-05-14T13:28:54.573
> 
> 标签：xslt

我正在尝试使用 XSLT（用于批量加载到 Postgres）将 XML 文件转换为平面、管道分隔的文件。我希望输出中的最后一列是节点的实际 XML（用于额外的后处理和调试）。例如：

```
<Library>
  <Book id="123">
    <Title>Python Does Everythig</Title>
    <Author>Smith</Author>
  </Book>

  <Book id="456">
    <Title>Postgres is Neat</Title>
    <Author>Wesson</Author>
  </Book>
</Library> 
```

应该生成

```
Python Does Everything|Smith|<Book id="123"><Title>Python Does Everythig</Title>Author>Smith</Author></Book>
Postgres is Neat|Wesson|<Book id="456"><Title>Postgres is Neat</Title><Author>Wesson</Author></Book> 
```

我当前的 XSL 是

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:strip-space elements="*" />
  <xsl:output method="text" omit-xml-declaration="yes" indent="no" /> 
  <xsl:template match="//Book">
    <xsl:value-of select="Title" />
    <xsl:text>|</xsl:text>
    <xsl:value-of select="Author" />

    <!-- put in the newline -->
    <xsl:text>&#xa;</xsl:text>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T15:50:52.857

我不确定这是否是推荐的解决方案，但您可以尝试将输出方法设置为 xml，然后只使用**xsl:copy-of**函数。

所以，下面的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 
  <xsl:strip-space elements="*" /> 
  <xsl:output method="xml" omit-xml-declaration="yes" indent="no" />  
  <xsl:template match="//Book"> 
    <xsl:value-of select="Title" /> 
    <xsl:text>|</xsl:text> 
    <xsl:value-of select="Author" /> 
    <xsl:text>|</xsl:text>  
    <xsl:copy-of select="." />
    <!-- put in the newline --> 
    <xsl:text>&#xa;</xsl:text> 
  </xsl:template> 
</xsl:stylesheet> 
```

应用于示例 XML 时，生成以下输出

```
Python Does Everythig|Smith|<Book id="123"><Title>Python Does Everythig</Title><Author>Smith</Author></Book>
Postgres is Neat|Wesson|<Book id="456"><Title>Postgres is Neat</Title><Author>Wesson</Author></Book> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:07:24.330

试试看：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:output method="text"/>
    <xsl:strip-space elements="*"/>
    <xsl:template match="/">
        <xsl:apply-templates select="//Book"/>
    </xsl:template>
    <xsl:template match="Book">
        <xsl:value-of select="Title" />
        <xsl:text>|</xsl:text>
        <xsl:value-of select="Author" />
        <xsl:text>|</xsl:text>
        <xsl:apply-templates select="." mode="outputTags"/>
    </xsl:template>
    <xsl:template match="*"  mode="outputTags">
        <xsl:text>&lt;</xsl:text>
        <xsl:value-of select="local-name()"/>
        <xsl:apply-templates select="@*"/>
        <xsl:text>></xsl:text>
        <xsl:apply-templates mode="outputTags"/>
        <xsl:text>&lt;/</xsl:text>
        <xsl:value-of select="local-name()"/>
        <xsl:text>></xsl:text>
        <xsl:if test="self::Book">
            <xsl:text>&#x0A;</xsl:text>
        </xsl:if>
    </xsl:template>
    <xsl:template match="@*">
        <xsl:text> </xsl:text>
        <xsl:value-of select="local-name()"/>
        <xsl:text>="</xsl:text>
        <xsl:value-of select="."/>
        <xsl:text>"</xsl:text>
    </xsl:template>
</xsl:stylesheet> 
```

它从您的输入文件中产生以下结果：

```
Python Does Everythig|Smith|<Book id="123"><Title>Python Does Everythig</Title><Author>Smith</Author></Book>
Postgres is Neat|Wesson|<Book id="456"><Title>Postgres is Neat</Title><Author>Wesson</Author></Book> 
```

# spring - Spring + Jasperreports + Unicode 字符在 PDF 中不可见

> ID：10584283
> 
> 赞同：3
> 
> 时间：2012-05-14T13:29:03.133
> 
> 标签：spring, jasper-reports

我已经完成了几乎所有提到的不同的事情，从字体扩展到 jasperreports.properties 文件；但无法找到解决方案。请协助。

我正在使用 Ireport 设计器创建一个包含 UTF8 编码的 pdf。所有字段中使用的字体是 Arial Unicode MS（在所有字段中都使用）。生成的输出 PDF 在默认预览器和 itext 的 PDF 预览器中显示 unicode 字符。

但是，当我使用 Spring Application 显示页面时，我得到的是空白而不是 Unicode 字符。我创建了 jasperreports-fonts-arialuni.jar 并包含在我的项目类路径中，但不知何故我无法获得那些 unicode 字符。

有人可以帮忙吗？

谢谢，

# blackberry - 在黑莓中使用带有眼睑字段管理器的垂直字段管理器

> ID：10584284
> 
> 赞同：1
> 
> 时间：2012-05-14T13:29:06.027
> 
> 标签：blackberry, tabs, fieldmanager

我在我的黑莓应用程序中创建了 3 个选项卡。我现在想添加一个眼睑字段管理器，它只允许在第三个选项卡上使用眼睑组件。

使用当前代码，我可以创建一个眼睑，但它没有显示任何选项卡。

```
 // setup the tab model with 3 tabs
 final PaneManagerModel model = new PaneManagerModel();
  model.enableLooping( true );

  // setup the first tab
  VerticalFieldManager vfm = new VerticalFieldManager( 
      Field.USE_ALL_HEIGHT | Field.USE_ALL_WIDTH |
      Manager.NO_VERTICAL_SCROLL | Manager.NO_HORIZONTAL_SCROLL );
  LabelField lbl = new LabelField( "Content for tab 1", Field.FOCUSABLE );
  vfm.add( lbl );

  ButtonField _btnGoBack = new ButtonField(" Tab 3 ",ButtonField.FIELD_HCENTER | ButtonField.CONSUME_CLICK);
      _btnGoBack.setChangeListener(new FieldChangeListener() 
      {
            public void fieldChanged(Field field,int context) 
            {

                  System.out.println("Inside button");
                  jumpTo(2,PaneManagerView.DIRECTION_NONE);
            }

       });
  vfm.add(_btnGoBack);

  MyLabelField myLbl = new MyLabelField( "Tab 1" );
  NullField nullFld = new NullField( Field.FOCUSABLE );
  HorizontalFieldManager hfm = new HorizontalFieldManager();
  hfm.add( nullFld );
  hfm.add( myLbl );

  Pane pane = new Pane( hfm, vfm );
  model.addPane( pane );

  // setup the second tab
  vfm = new VerticalFieldManager( 
      Field.USE_ALL_HEIGHT | Field.USE_ALL_WIDTH |
      Manager.NO_VERTICAL_SCROLL | Manager.NO_HORIZONTAL_SCROLL );
  lbl = new LabelField( "Content for tab 2", Field.FOCUSABLE );
  vfm.add( lbl );

  myLbl = new MyLabelField( "Tab 2" );
  nullFld = new NullField( Field.FOCUSABLE );
  hfm = new HorizontalFieldManager();
  hfm.add( nullFld );
  hfm.add( myLbl );

  pane = new Pane( hfm, vfm );
  model.addPane( pane );

  //Setup the third tab
  vfm = new VerticalFieldManager( 
      Field.USE_ALL_HEIGHT | Field.USE_ALL_WIDTH |
      Manager.NO_VERTICAL_SCROLL | Manager.NO_HORIZONTAL_SCROLL );
  lbl = new LabelField( "Content for tab 3", Field.FOCUSABLE );
 vfm.add( lbl );
  myLbl = new MyLabelField( "Tab 3" );
  nullFld = new NullField( Field.FOCUSABLE );
  hfm = new HorizontalFieldManager();
  hfm.add( nullFld );
  hfm.add( myLbl );
  ((LabelField)myLbl).setEnabled(false);
  ((NullField)nullFld).setEnabled(false); 
```

在这里，我开始实施眼睑现场经理

```
 _eyelidFieldManager = new EyelidFieldManager();

    // Change the display time from the default 1.2s
    _eyelidFieldManager.setEyelidDisplayTime(2000);

    // Add components to the north eye-lid of the blinker

    _eyelidFieldManager.vfm.addTop(new LabelField(" Do you wish to send report to client?",LabelField.FIELD_HCENTER | LabelField.NON_FOCUSABLE));  
    _eyelidFieldManager.addTop(new LabelField("                                      ",LabelField.FIELD_HCENTER | LabelField.NON_FOCUSABLE));               

  // Add components to the south eye-lid of the blinker
    _eyelidFieldManager.addBottom(new LabelField(" Send Report as: ",LabelField.FIELD_HCENTER | LabelField.NON_FOCUSABLE));
    HorizontalFieldManager buttonPanel = new HorizontalFieldManager(Field.FIELD_HCENTER | Field.USE_ALL_WIDTH);
    buttonPanel.add(new ButtonField("SMS"));
    buttonPanel.add(new ButtonField("Email"));
    _eyelidFieldManager.addBottom(buttonPanel);

    // Add checkbox in non-eyelid region for showing eyelids on user input        
    _showOnInputCheckbox = new CheckboxField("Show eyelids on user input", true, Field.FIELD_HCENTER);
    _showOnInputCheckbox.setChangeListener(this);

    add(_eyelidFieldManager); 

    // Disable virtual keyboard so it doesn't obscure bottom eyelid
    VirtualKeyboard keyboard = getVirtualKeyboard();
    if( keyboard != null )
    {
        keyboard.setVisibility(VirtualKeyboard.IGNORE);
    }

  pane = new Pane( hfm, vfm );
  model.addPane( pane );

  // select the tab to be displayed
  model.setCurrentlySelectedIndex( 0 ); 
```

现在设置其余的选项卡组件

```
 // setup the rest of the components
  HorizontalTabTitleView titleView = new HorizontalTabTitleView( Field.FOCUSABLE );
  titleView.setNumberOfDisplayedTabs( 3 );
  titleView.setModel( model );

  PaneView paneView = new PaneView( Field.FOCUSABLE );
  paneView.setModel( model );

  PaneManagerView view = new PaneManagerView( 
          Field.FOCUSABLE  | Manager.NO_VERTICAL_SCROLL | 
          Manager.NO_HORIZONTAL_SCROLL | Manager.USE_ALL_HEIGHT | 
          Manager.USE_ALL_WIDTH, 
          titleView, paneView );
  view.setModel( model );
  model.setView( view );

  // configure the Controller
  HorizontalTabController controller = new HorizontalTabController();
  controller.setModel( model );
  controller.setView( view );
  model.setController( controller );
  view.setController( controller );

  // add the tab manager to the MainScreen
  this.add( view );
} 
```

任何知道解决方案的人请指导。谢谢

# javascript - JQuery 到常规 JavaScript

> ID：10584287
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:14.773
> 
> 标签：javascript, jquery, scrollbar

出于学习目的，我将此滚动条转换为常规 JavaScript。我只是从脚本中编写 JQuery（JQuery 很棒，但我希望在使用 JQuery 之前学习原始 JavaScript）。

这是滚动条代码：

[http://jsfiddle.net/PVZB8/139/](http://jsfiddle.net/PVZB8/139/)

我不明白如何将最后几行转换为常规 JavaScript：

```
$('#chatlist').slimscroll({
    color: '#000',
    size: '8px',
    width: '150px',
    height: '250px'                  
}); 
```

我会假设 $('#chatlist') 等于 document.getElementById('chatlist') 但这当然会失败，因为 div 元素没有名为'slimscroll'的方法......

我有点理解这些代码行的作用（创建一个 slimscroll 的新实例并传递一些选项）。

如果我们取出 JQuery，这些行会是什么样子？如果不使用 JQuery，整个脚本会如何？

（我知道如果没有 JQuery，脚本的所有方面都不会以类似的方式工作，例如淡入淡出功能）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T13:31:01.830

> 我不明白如何将最后几行转换为常规 JavaScript：

代码调用存储在`$.fn.slimscroll`其中的函数，并`this`绑定到包含具有 id 的元素的 jQuery 对象`chatlist`，并将包含您指定的值的对象传递给该函数。

> 如果不使用 JQuery，整个脚本会如何？

这里没有人会为您将整个脚本转换为纯 JavaScript。我也不建议你这样做——这将是一项繁重的工作，因为你失去了所有不错的 DOM 遍历函数等。

# mysql - 将 CSV 导入 MySQL 数据库，仅插入第一行

> ID：10584288
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:15.443
> 
> 标签：mysql, sql, csv

我针对我的 MySQL 数据库运行以下 SQL 查询：

```
load data local infile '/tmp/ad_packs.csv' 
into table ad_packs 
fields terminated by ',' 
enclosed by '"' 
lines terminated by '\n' 
(company_name,pack_size,remaining,ad_pack_purchase_officer,advertising_contact_officer,updated_ad_pack,email,phone,website,note,organisation_id,categories,modified) 
```

这似乎只插入一行，我已经检查了 csv，它有标题，所以它只插入第一行，即标题。

有什么原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T10:12:54.513

迟来的答案，我自己也遇到过这个问题；什么都试过了。对我来说，解决方案是设置`AUTO_INCREMENT`我的 id 字段，瞧，记录进来了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:30:20.443

您确定您的线路由 终止`"\n"`吗？试试`"\r\n"`；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T00:12:18.950

尝试查看表的主键。如果 '\n', '\r\n' 问题没有问题，很可能您的 csv 文件中的第一行和第二行共享相同的主键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-28T20:03:24.763

最近遇到了同样的问题，并在 csv 文件上使用了 od -c 命令。它表明 \r 正在用于换行符。

# ios - iOS 应用在解析时忽略制表符和空格

> ID：10584289
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:19.670
> 
> 标签：ios, xml, parsing

我有一个 iphone 应用程序正在解析我自己生成的 xml。为了更容易阅读，我希望能够忽略制表符并返回字符。如果我对 xml 进行了格式化，则显示数据的表格视图本身就是选项卡。

我看到了这个问题：[XML Parsing: how to ignore whitespace or enter/return space](https://stackoverflow.com/questions/2523949/xml-parsing-how-to-ignore-whitespace-or-enter-return-space)

但它似乎并没有摆脱制表符/返回字符，它只是摆脱了所有的空白。换句话说，我希望元素本身中的内容保持间隔，而忽略 xml 文件中的选项卡（用于格式化/便于阅读）。

我怎样才能做到这一点？

这是我要显示的 XML 示例。它是 XML 中的内容：

```
 <Event>
            <EventName>STUFF TO DISPLAY</EventName>
            <EventImage>STUFF TO DISPLAY</EventImage>
        </Event> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:55:05.853

你可以使用这个： -

```
NSStirng *string=@"Your String";
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"[\r\n]|[ ^t^b]|[\t]" options:NSRegularExpressionCaseInsensitive error:&error];
[regex enumerateMatchesInString:string options:0 range:NSMakeRange(0, [string length]) usingBlock:^(NSTextCheckingResult *match, NSMatchingFlags flags, BOOL *stop)
{
    // your statement if it matches
}]; 
```

你也可以这样做：-

```
NSString *string= [originalString stringByReplacingOccurrencesOfRegex:[NSString stringWithFormat:@"%@%@%@",'\n','\t',@" "] withString:@" "]; 
```

# python - concurrent.futures ThreadPoolExecutor 等待失败？

> ID：10584290
> 
> 赞同：2
> 
> 时间：2012-05-14T13:29:20.863
> 
> 标签：python, multithreading, concurrent.futures

我正在尝试使用 concurrent.futures 中的 ThreadPoolExecutor 来提高脚本性能。我正在通过 Popen 启动一些外部 python 脚本并将它们封装为未来对象，但是这些对象在完成后进入回调函数，但我可以看到它们在我的机器上运行（它们运行了几分钟）。代码如下所示：

```
with futures.ThreadPoolExecutor(max_workers=4) as executor: 
        p1 = executor.submit(subprocess.Popen([myotherPythonscript1], stdout = subprocess.PIPE))
        p1.add_done_callback(process_result)
        p2 = executor.submit(subprocess.Popen([myotherPythonscript2], stdout = subprocess.PIPE))
        p2.add_done_callback(process_result)

def process_result( future ):
        logger.info( "Seeding process finished...") 
```

我还尝试了使用 running() 和 wait() 未来函数的不同方法，但结果相同。未来的对象被标记为已经完成，但实际上它们仍在运行。我错过了什么吗？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:36:47.927

你不能只将结果传递`Popen`给你的执行者，你必须传递一个可调用的。

```
>>> from concurrent.futures import *
>>> from subprocess import *
>>> executor = ThreadPoolExecutor(4)
>>> future = executor.submit(Popen(['echo', 'test'], stdout=PIPE))
>>> future.exception()
TypeError("'Popen' object is not callable",) 
```

另一方面，这有效：

```
from concurrent.futures import *
from subprocess import *

def make_call():
    process = Popen(['echo', 'test'], stdout=PIPE)
    return process.communicate()[0]

executor = ThreadPoolExecutor(4)
future = executor.submit(make_call)
print(future.result()) 
```

# android - 带有 MediaPlayer 的 NullPointerException

> ID：10584294
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:28.523
> 
> 标签：android, nullpointerexception, media-player

这是我的代码：

```
MediaPlayer a1,a2,a3...a24;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.a);
    a1 = MediaPlayer.create(this, R.raw.a1);
    a2 = MediaPlayer.create(this, R.raw.a2);
    a3 = MediaPlayer.create(this, R.raw.a3);
             ...
    a24 = MediaPlayer.create(this, R.raw.a24);
}

private void play(MediaPlayer p) {
    p.start();
} 
```

问题是，如果我在玩 a1、a2、a3 一切都是正确的，但如果我在玩 a24，我会得到 NullPointerException。24个音频文件的大小约为25Kb，所以我认为不是内存消耗的问题。我曾尝试在开始游戏之前延迟一些时间，但似乎没有任何帮助。android 文档对此并没有太多解释；我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:32:44.833

在调用 create() 之后，你真的检查过 a24 的值吗？它是非空的吗？我认为您遇到了可以创建的 MediaPlayer 对象数量的限制。这里有一篇关于 MediaPlayer 和 SoundPool 的精彩文章：http: [//www.stealthcopter.com/blog/2010/08/android-soundpool-vs-mediaplayer-focus-on-soundboards-and-memory-problems/](http://www.stealthcopter.com/blog/2010/08/android-soundpool-vs-mediaplayer-focus-on-soundboards-and-memory-problems/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:41:22.643

要回答您的评论：

```
MediaPlayer mp = new MediaPlayer();

AssetFileDescriptor descriptor;

descriptor = getAssets().openFd( "track name" ); 
mp.setDataSource(     descriptor.getFileDescriptor(), descriptor.getStartOffset(), descriptor.getLength() ); 
descriptor.close(); 
mp.setLooping(false); 
mp.prepare();
mp.start(); 
```

您需要重新设置下一次并重新设置才能再次播放。

# c++ - clGetDeviceIds 返回 -1

> ID：10584296
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:40.817
> 
> 标签：c++, ubuntu, opencl

我正在使用 ATI Radeon Mobility 4800 HD 运行 Ubuntu Lucid。3D 支持工作（即 OpenGL 应用程序以正常速度运行），但是当我尝试使用 OpenCL 时它失败了：

```
#include <CL/opencl.h>
#include <iostream>
#include <cstdlib>

#define CL_SAFE_CALL( call ) {                                                               \
    cl_int err = call; std::cerr << "EC: " << err << std::endl;                              \
    if(CL_SUCCESS != err){                                                                   \
      std::cerr << "Unsuccesful OpenCL call " << __FILE__ << " : " << __LINE__ << std::endl; \
      exit(EXIT_FAILURE);                                                    \
    } }

// OpenCL platform
cl_platform_id platform;

char* getPlatformInfo(cl_platform_id platform, cl_platform_info paramName){
  size_t infoSize = 0;
  CL_SAFE_CALL( clGetPlatformInfo(platform, paramName, 0, NULL, &infoSize) );
  char* info = (char*)malloc(infoSize);
  CL_SAFE_CALL( clGetPlatformInfo(platform, paramName, infoSize, info, NULL) );
  return info;
}

cl_platform_id createPlatform(){
  cl_platform_id platform;

  CL_SAFE_CALL( clGetPlatformIDs(1, &platform, NULL));
  std::cout << getPlatformInfo(platform, CL_PLATFORM_VERSION) << std::endl;
  return platform;
}

// OpenCL devices of the platform
cl_device_id device_id;

void* getDeviceInfo(cl_device_id device_id, cl_device_info paramName){
  size_t infoSize = 0;
  CL_SAFE_CALL( clGetDeviceInfo(device_id, paramName, 0, NULL, &infoSize) );

  char* info = (char*)malloc(infoSize);
  CL_SAFE_CALL( clGetDeviceInfo(device_id, paramName, infoSize, info, NULL) );
  return info;
}

cl_device_id createDevice(cl_platform_id platform, cl_device_type type){
  cl_device_id device_id;

  // THIS IS LINE 44:

  CL_SAFE_CALL( clGetDeviceIDs(platform, type, 1, &device_id, NULL) );

  cl_uint* max_compute_units = (cl_uint*)getDeviceInfo(device_id, CL_DEVICE_MAX_COMPUTE_UNITS);
  std::cout << "Max compute units: " << *max_compute_units << std::endl;

  return device_id;
}

int main(void){
  std::cerr << "createDevice:" << std::endl;
    platform = createPlatform();
  std::cerr << "createDevice:" << std::endl;
  device_id = createDevice(platform, CL_DEVICE_TYPE_GPU);
} 
```

以下：

```
~$ g++ -o test test.cc -lOpenCL
~$ ./test
createDevice:
EC: 0
EC: 0
EC: 0
OpenCL 1.2 AMD-APP (923.1)
createDevice:
EC: -1
Unsuccesful OpenCL call test.cc : 44 
```

我从安装中获得了 libOpenCl，并且我 apt-get opencl-headers。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:57:35.187

`-1`实际意思的错误代码`CL_DEVICE_NOT_FOUND`（查看您的 include\CL 文件夹中的 cl.h 以供参考）。这可能意味着几件事：

*   *您的 GPU 视频驱动程序是什么？*检查它是否根本不支持 OpenCL。
*   *您的驱动程序是最新的吗？*检查您是否拥有最新版本。

# javascript - json twitter 查询，解析为 html 提要

> ID：10584298
> 
> 赞同：0
> 
> 时间：2012-05-14T13:29:44.460
> 
> 标签：javascript, json, api, twitter

我正在尝试为 twitter 构建一个 hastag 提要，我已经阅读了如何创建搜索查询，并且我有这个 json 结构......

```
{
  "completed_in": 0.026,
  "max_id": 201961894368653313,
  "max_id_str": "201961894368653313",
  "next_page": "?page=2&max_id=201961894368653313&q=wearetwo&lang=en&rpp=100&include_entities=1",
  "page": 1,
  "query": "wearetwo",
  "refresh_url": "?since_id=201961894368653313&q=wearetwo&lang=en&include_entities=1",
  "results": [
    {
{
      "created_at": "Sat, 12 May 2012 01:06:19 +0000",
      "entities": {
        "hashtags": [
          {
            "text": "wearetwo",
            "indices": [
              12,
              21
            ]
          }
        ],
        "urls": [

        ],
        "user_mentions": [
          {
            "screen_name": "crifor",
            "name": "Cristina Forlani",
            "id": 110646291,
            "id_str": "110646291",
            "indices": [
              3,
              10
            ]
          }
        ],
        "media": [
          {
            "id": 201101250740240387,
            "id_str": "201101250740240387",
            "indices": [
              34,
              54
            ],
            "media_url": "http:\/\/p.twimg.com\/Asp0haZCQAMC-Sq.jpg",
            "media_url_https": "https:\/\/p.twimg.com\/Asp0haZCQAMC-Sq.jpg",
            "url": "http:\/\/t.co\/1EXkTMYq",
            "display_url": "pic.twitter.com\/1EXkTMYq",
            "expanded_url": "http:\/\/twitter.com\/crifor\/status\/201101250740240384\/photo\/1",
            "type": "photo",
            "sizes": {
              "small": {
                "w": 340,
                "h": 455,
                "resize": "fit"
              },
              "large": {
                "w": 765,
                "h": 1024,
                "resize": "fit"
              },
              "thumb": {
                "w": 150,
                "h": 150,
                "resize": "crop"
              },
              "orig": {
                "w": 765,
                "h": 1024,
                "resize": "fit"
              },
              "medium": {
                "w": 600,
                "h": 803,
                "resize": "fit"
              }
            }
          }
        ]
      },
      "from_user": "stevoltan",
      "from_user_id": 165713968,
      "from_user_id_str": "165713968",
      "from_user_name": "Stefano Voltan",
      "geo": null,
      "id": 201116057396719616,
      "id_str": "201116057396719616",
      "iso_language_code": "en",
      "metadata": {
        "result_type": "recent"
      },
      "profile_image_url": "http:\/\/a0.twimg.com\/profile_images\/2163464409\/crepes_normal.jpg",
      "profile_image_url_https": "https:\/\/si0.twimg.com\/profile_images\/2163464409\/crepes_normal.jpg",
      "source": "&lt;a href=&quot;http:\/\/twitter.com\/#!\/download\/iphone&quot; rel=&quot;nofollow&quot;&gt;Twitter for iPhone&lt;\/a&gt;",
      "text": "RT @crifor: #wearetwo belle facce http:\/\/t.co\/1EXkTMYq",
      "to_user": null,
      "to_user_id": 0,
      "to_user_id_str": "0",
      "to_user_name": null
    }, 
```

我需要提取媒体 url 和文本...有人可以帮帮我吗..我对此很陌生...如果您能给我展示一个可行的示例，我将不胜感激..至少是功能。 ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:17:52.217

本文档将向您展示如何将数据转换为可以使用 jQuery 使用的格式：

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

就像是：

```
$.getJSON('http://search.twitter.com/search.json?q=wearetwo&lang=en&result_type=recent&rpp=100&include_entities=true', function(data) {
  var media_url = data.results.media.media_url;
  var text = data.text;
}); 
```

# ruby - Ruby 1.9.3：protocol.rb:160：[BUG] 可能的缓冲区溢出：0 为 17

> ID：10584305
> 
> 赞同：1
> 
> 时间：2012-05-14T13:30:27.753
> 
> 标签：ruby, multithreading

我有一个 Ruby 脚本在 1.8.7 中运行良好，但现在在 1.9.3 中因 Ruby 错误而崩溃。

它使用一个简单的线程池来打开一个 URL 列表，以便它们被预先缓存。

以下是脚本的相关部分。

线程池：

```
require 'thread'

# see http://burgestrand.se/articles/quick-and-simple-ruby-thread-pool.html
class Pool
  def initialize(size)
    @size = size
    @jobs = Queue.new

    @pool = Array.new(@size) do |i|
      Thread.new do
        Thread.current[:id] = i

        catch(:exit) do
          loop do
            job, args = @jobs.pop
            job.call(*args)
          end
        end
      end
    end
  end

  def schedule(*args, &block)
    @jobs << [block, args]
  end

  def shutdown
    @size.times do
      schedule { throw :exit }
    end

    @pool.map(&:join)
  end
end 
```

load_url 方法：

```
def load_url(url)
  http_proxy = ENV['http_proxy']
  proxy_regex = /http\:\/\/(\w+):(\w+)@([\w|\.]+):(\d+)/

  url_regex = /^((http[s]?|ftp):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/

  url.match(url_regex)

  host = $3
  path = $4 + $6

  if http_proxy and http_proxy =~ proxy_regex
    proxy_addr = $3
    proxy_port = $4
    proxy_user = $1 
    proxy_pass = $2

    Net::HTTP::Proxy(proxy_addr, proxy_port, proxy_user, proxy_pass).start(host) do |http|
      req = Net::HTTP::Get.new(path)
      http.read_timeout = 500
      response = http.request(req)
    end
  else
    Net::HTTP.start(host) do |http|
      req = Net::HTTP::Get.new(path)
      http.read_timeout = 500
      response = http.request(req)
    end
  end
end 
```

下载代码：

```
pool = Pool.new(5)

# the_trips are loaded from the db
the_trips.each do |trip|
  cleaned_urls = TripPage.empty_cache(trip)

  cleaned_urls.each do |cleaned_url|
    pool.schedule do
      puts "Loading #{cleaned_url}..."
      begin
        load_url(cleaned_url)
        puts "#{cleaned_url} OK\n"
      rescue Timeout::Error => e
        puts "Caught Timeout error for #{cleaned_url} :("
      end
    end
  end
end

# wait for all threads to finish
puts "Done, shutting down the threadpool..."
pool.shutdown 
```

设置就这么多。

当我用 Ruby 1.9.3 运行它时，我得到了这个：

```
Loading http://some.server.com/reisen/2010003...
Loading http://some.server.com/reisen/2010003-the-title...
Loading http://some.server.com/reisen/2010011...
Loading http://some.server.com/reisen/2010011-different-title...
Loading http://some.server.com/reisen/2010100...
http://some.server.com/reisen/2010003 OK
Loading http://some.server.com/reisen/2010100-yet-another-title...
~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/protocol.rb:160: [BUG] probable buffer overflow: 17 for 0
ruby 1.9.3p0 (2011-10-30 revision 33570) [i386-solaris2.10]

-- Control frame information -----------------------------------------------
c:0025 p:0017 s:0112 b:0112 l:000111 d:000111 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/protocol.rb:160
c:0024 p:0061 s:0107 b:0107 l:000106 d:000106 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/protocol.rb:124
c:0023 p:0159 s:0101 b:0101 l:000100 d:000100 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:2584
c:0022 p:0024 s:0091 b:0091 l:000090 d:000090 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:2669
c:0021 p:0106 s:0086 b:0086 l:000077 d:000085 BLOCK  ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:1321
c:0020 p:---- s:0084 b:0084 l:000083 d:000083 FINISH
c:0019 p:---- s:0082 b:0082 l:000081 d:000081 CFUNC  :catch
c:0018 p:0025 s:0078 b:0078 l:000077 d:000077 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:1316
c:0017 p:0097 s:0072 b:0072 l:000071 d:000071 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:1293
c:0016 p:0053 s:0065 b:0065 l:001d94 d:000064 BLOCK  clear_diskcache.rb:60
c:0015 p:0057 s:0060 b:0060 l:000059 d:000059 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:745
c:0014 p:0182 s:0057 b:0057 l:000056 d:000056 METHOD ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/net/http.rb:557
c:0013 p:0140 s:0044 b:0044 l:001d94 d:001d94 METHOD clear_diskcache.rb:57
c:0012 p:0034 s:0031 b:0031 l:0012e4 d:000030 BLOCK  clear_diskcache.rb:115
c:0011 p:---- s:0028 b:0028 l:000027 d:000027 FINISH
c:0010 p:---- s:0026 b:0026 l:000025 d:000025 CFUNC  :call
c:0009 p:0034 s:0023 b:0023 l:002110 d:000022 BLOCK  clear_diskcache.rb:16
c:0008 p:---- s:0019 b:0019 l:000018 d:000018 FINISH
c:0007 p:---- s:0017 b:0017 l:000016 d:000016 CFUNC  :loop
c:0006 p:0009 s:0014 b:0014 l:002110 d:000013 BLOCK  clear_diskcache.rb:14
c:0005 p:---- s:0012 b:0012 l:000011 d:000011 FINISH
c:0004 p:---- s:0010 b:0010 l:000009 d:000009 CFUNC  :catch
c:0003 p:0038 s:0006 b:0006 l:002110 d:000005 BLOCK  clear_diskcache.rb:13
c:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH
c:0001 p:---- s:0002 b:0002 l:000001 d:000001 TOP   

-- Ruby level backtrace information ----------------------------------------
clear_diskcache.rb:13:in `block (2 levels) in initialize'
clear_diskcache.rb:13http://some.server.com/reisen/2010011 OK
:in `catch'
clear_diskcache.rb:14:in `block (3 levels) in initialize'
clear_diskcache.rbLoading http://some.server.com/reisen/201T004...
:14:in `loop'
clear_diskcache.rb:16:in `block (4 levels) in initialize'
clear_diskcache.rb:16:in `call'
clear_diskcache.rb:113:in `block (4 levels) in <top (required)>'
clear_diskcache.rb:113:in `puts'
clear_diskcache.rb:113:in `puts'
clear_diskcache.rb:113:in `write' 
```

知道可能是什么问题吗？我找到了这个，但我不能 100% 确定这是否是我看到的错误：http: [//bugs.ruby-lang.org/issues/6099](http://bugs.ruby-lang.org/issues/6099)

如果是这样，看起来好像直到 Ruby 2.0 才会发布修复程序......

# c++ - win32项目中的C++字符可视化

> ID：10584306
> 
> 赞同：0
> 
> 时间：2012-05-14T13:30:29.583
> 
> 标签：c++, visual-c++, encoding, character

在win32项目的可视化过程中我遇到了这个问题，如果我这样做：

```
char temp[80]="hello"; 
```

进而：

```
MessageBox(hDlg,(LPCWSTR)temp,_T("titolo"),MB_OK); 
```

结果是日文，有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:31:31.720

问题是 a`LPCWSTR`是一个宽字符数组，而你有一个`char`数组。

尝试：

```
wchar_t temp[]= L"hello"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:31:06.793

Luchian给你基本的答案。

回到过去，当我开始开发 Windows 应用程序时，我什至不记得有 Unicode 版本的 Windows。只有多字节字符串。当您使用 Visual C++ 向导创建新应用程序时，它会创建一个应用程序，其中基本字符串字符是“char”。在那里的某个时候，微软预见到 Unicode 是要走的路，他们创建了名为`TCHAR`,`LPTSTR`和`LPCTSTR`. 这些类型的编译方式不同，具体取决于您是否在项目中定义了“UNICODE”。如果您没有定义 UNICODE，则`TCHAR`= `char`、`LPTSTR`=`LPSTR`和`LPCTSTR`= `LPCSTR`。但是，如果您定义了 UNICODE，则`TCHAR`= `WCHAR`（或`wchar_t`）、`LPTSTR`=LPWSTR 和`LPCTSTR`= `LPCWSTR`。

我仍在开发的当前应用程序不是 UNICODE 应用程序，而是 MBCS（多字节字符串）。在未来的某个时候，我希望它最终会更改为 UNICODE。我一直试图做的是使用`TCHAR`我的字符串的类型，以便将来我所要做的就是定义 UNICODE 并且我的所有字符串功能都可以工作。

话虽如此，`TCHAR`如果您不知道是否定义了 UNICODE，也可以使用这些函数：

`TCHAR temp[] = _T("hello");`

# javascript - JavaScript：表单刷新页面，onchange this.form.submit 问题

> ID：10584308
> 
> 赞同：-1
> 
> 时间：2012-05-14T13:30:42.447
> 
> 标签：javascript, database, internet-explorer, firefox, google-chrome

所以我有一个从数据库生成的网站。

每个页面都是一个 div，用户选择页面。

当用户选择一个交付选项时，我设置了它，因此在更改时它将计算他们的成本。这是在每一页（div）上。

在谷歌浏览器中这很好，它提交页面并停留在我所在的页面（div）上。当我在 Firefox 或 IE 中时，它会刷新页面并从起始页面 (div) 开始。

有任何想法吗？

我的代码太长，无法发布，但它是一个使用 div 制作书籍的 JQuery 插件。这本书的每一页都有编号，上面有 1 个项目。然后交付选​​项在表格中，如下所示：

```
echo "<td><form method='post' action=''>";
if ($postage != "")
{?>
    <label>
        <select name="postage" id="postage" onchange="this.form.submit()" >
            <option value="UK"<?php echo($postage == 'UK'?' selected="selected"':null) ?>>UK</option> 
            <option value="International"<?php echo($postage == 'International'?' selected="selected"':null) ?>>International</option> 
        </select>
    </label><?php
}
else
{
    ?><label>
        <select name="postage" id="postage" onchange="this.form.submit()" >
            <option>Choose:</option>
            <option value="UK">UK</option>
            <option value="International">International</option>
        </select>
    </label>
    <?php
} 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:59:41.317

确保你的按钮是这样的：

```
<button type="button">a button</button> 
```

# svn - Subversion：恢复更新前发生的版本

> ID：10584311
> 
> 赞同：0
> 
> 时间：2012-05-14T13:30:50.287
> 
> 标签：svn, tortoisesvn

我刚开始使用带有 TortoiseSVN 的 Subversion。让我们将我的初始工作副本命名为**A**。我在 A 中做了很多更改，然后提交了它。

但是当我的同事更新我的提交时，它并没有在他的机器上编译。然后他拒绝**了 A**并从**A**之前的版本开始进行了很多更改和提交。他的最后一个提交名称是**B**。

然后我将我**的 A**更新为他的**B**。您能否帮我解决以下问题：我怎样才能回到我最初的 A 版本？

如果我在日志中按“将项目更新到修订版”或“恢复到此修订版”或“恢复此修订版的更改”，它没有帮助..我选择修订版 A，然后执行此操作，但看不到我的工作..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:42:13.697

You can update your working copy to A with the command:

`svn up -rA <path to your repository>`

where A is the revision number of your changes

or in TortoiseSVN, use TortoiseSVN → Update to Revision for your working copy.

# perl - 如何在 perl 的父进程中获取死掉的子进程的 PID？

> ID：10584314
> 
> 赞同：1
> 
> 时间：2012-05-14T13:30:55.787
> 
> 标签：perl, fork

我正在使用 proc::queue 来管理一堆子进程，然后像这样将它们关闭：

```
if(Proc::Queue::running_now() < $kids)
  {
    logger("Starting another server process...");
    my $newprocessid = Proc::Queue::run_back(\&serverprocess);
    logger("New child process id: $newprocessid");
    $childprocessids{$newprocessid} = 1;
  } 
```

所以现在我有一个子进程 ID 的哈希值，当父进程发送一个 kill SIGTERM 时我可以杀死它。

但是如果子进程被外部杀死怎么办？父进程知道要启动另一个子进程来弥补丢失的子进程，而新的子进程 PID 最终会出现在我的哈希中，但是父进程如何找出死去的子进程的 PID 以将其从哈希中删除，所以我以后不要尝试杀死它？

我可以设置`$SIG{CHLD}`，但我看不到如何让子 PID 将其从我的哈希中删除。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:38:29.710

您可以将父进程及其子进程放在他们自己的进程组中，并通过向父进程发送信号来杀死整个家庭。

根据问题的性质，您可能愿意`kill`离开（McManus 先生！）并忍受由于每次尝试`kill`对已经死亡的子进程而导致的失败。

如果父进程除了跟踪孩子什么都不做，[`waitpid`](http://perldoc.perl.org/functions/waitpid.html)那么您只需要一个简单的循环。

```
while ((my $kid = waitpid -1, 0) > 0) {
  warn "$0: [$$] reaped $kid\n";
  delete $kid{$kid};
} 
```

如果您在父进程中有其他处理，`WNOHANG`则将第二个参数中的位设置为`waitpid`告诉系统调用不要阻塞。这使您可以定期获取僵尸子节点，然后返回其他处理。

出于演示目的，假设我们启动了一群昏昏欲睡的孩子。

```
#! /usr/bin/env perl

use strict;
use warnings;

use 5.10.0;  # for defined-or

my %kid;

for (1 .. 5) {
  my $pid = fork // die "$0: fork: $!";  # / fix SO hilighting
  if ($pid == 0) {
    warn "$0: [$$] sleeping...\n";
    sleep 10_000;
    exit 0;
  }
  else {
    $kid{$pid} = 1;
    warn "$0: [$$] forked $pid\n";
  }
} 
```

然后为了模拟来自外部的杀戮，我们派出另一个孩子随机挑选其余的兄弟姐妹。

```
my $pid = fork // die "$0: fork: $!";
if ($pid == 0) {
  warn "$0: [$$] The killer awoke before dawn.\n";
  while (keys %kid) {
    my $pid = (keys %kid)[rand keys %kid];
    warn "$0: [$$] killing $pid...\n";
    kill TERM => $pid or warn "$0: [$$] kill $pid: $!";
    delete $kid{$pid};
    sleep 1;
  }
  exit 0;
} 
```

现在上面的循环读取讣告。

```
while ((my $kid = waitpid -1, 0) > 0) {
  warn "$0: [$$] reaped $kid\n";
  delete $kid{$kid};
} 
```

仔细检查没有人活着出来。

```
if (keys %kid) {
  my $es = keys %kid == 1 ? "" : "es";
  die "$0: unkilled process$es:\n",
      map "  - $_\n", keys %kid;
} 
```

输出：

```
./waitpid-demo: [1948] 分叉 7976
./waitpid-demo: [7976] 正在睡觉...
./waitpid-demo: [1948] 分叉 7244
./waitpid-demo: [7244] 正在睡觉...
./waitpid-demo: [1948] 分叉 4776
./waitpid-demo: [4776] 正在睡觉...
./waitpid-demo: [1948] 分叉 4304
./waitpid-demo: [4304] 正在睡觉...
./waitpid-demo: [1948] 分叉 7908
./waitpid-demo: [7908] 正在睡觉...
./waitpid-demo: [5144] 杀手在黎明前醒来。
./waitpid-demo: [5144] 杀死 7908...
./waitpid-demo: [1948] 收获 7908
./waitpid-demo: [5144] 杀死 7976...
./waitpid-demo: [1948] 收获 7976
./waitpid-demo: [5144] 杀死 4776...
./waitpid-demo: [1948] 收获 4776
./waitpid-demo: [5144] 杀死 4304...
./waitpid-demo: [1948] 收获 4304
./waitpid-demo: [5144] 杀死 7244...
./waitpid-demo: [1948] 收获 7244
./waitpid-demo: [1948] 收获 5144
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:55:25.323

如果唯一的问题是*“从哈希中删除它，这样我以后就不会尝试杀死它”*，您可以尝试以下操作：

```
# probably you should put this code in a loop for all your process IDs
$alive = kill 0, $childprocessids{$processId};

if ( $alive ) {
    # process is still alive, do whatever you want with it
}
else {
    # process is dead, probably killed externally
    # do whatever you need for this scenario or just delete your hash key
} 
```

# javascript - XMLHttpRequest 的 onerror 处理程序应该何时触发

> ID：10584318
> 
> 赞同：54
> 
> 时间：2012-05-14T13:31:05.580
> 
> 标签：javascript, ajax, xmlhttprequest

我在理解`XMLHttpRequest`的处理程序时遇到了一点问题。[规范说明了有关`onerror`处理程序](http://www.w3.org/TR/XMLHttpRequest/#event-xhr-error)的内容：

> `error` [Dispatched ... ] 当请求失败时。
> 
> `load` [Dispatched ... ] 当请求成功完成时。

问题是，“请求失败”是什么意思。那可能是

*   根本无法发出请求（例如，连接被拒绝和此类错误），或
*   以上加上服务器返回的错误代码（例如404）

另外，我想知道它是否意味着`onerror`并且`onload`不应该同时开火。

[此参考](http://www.javascriptkit.com/jsref/ajax.shtml)表明`onerror`应根据`status`代码执行处理程序，并`onload`取决于`readyState`. 这表明它们不是相互排斥的，但是，我认为这不是权威信息。

我问是因为使用最新的 Opera 快照，我发现`onload`即使在 404 状态码上也会被触发。我知道测试`status`是一个肯定的选择，但我想知道这是我必须按照规范执行的操作，还是只是针对 Opera 中的错误的一种解决方法。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-05-14T13:41:11.930

正如评论中提到的，当*网络级别*`onerror`出现故障时触发。如果错误仅存在于应用程序级别，例如，发送了 HTTP 错误代码，那么仍然会触发。您需要在处理程序中显式测试返回的状态代码。*`onload``onreadystatechange`*

 *请注意，被拒绝的跨域请求也会触发`onerror`处理程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-14T07:55:23.860

除了 apsillers 的回答之外，请注意 XMLHttpRequest 在后台自动处理重定向，因此您不必在事件中检查此回复代码`onload`（此事件将仅被调用一次 - 在最终调用中）。另请注意，如果您使用 POST 方法发送有效负载数据并且请求被重定向，则 XMLHttpRequest 将方法从 更改`POST`为`GET`并出于安全原因丢弃任何有效负载数据。该`onload`事件仍将被调用，但您需要再次手动将请求重新发送到新目的地。*

# bash - 关于流程的简单 bash 问题

> ID：10584322
> 
> 赞同：-1
> 
> 时间：2012-05-14T13:31:11.747
> 
> 标签：bash

我需要在 bash 中实现以下两件事：

```
Give a list of all processes that were started from your terminal 
```

和

```
In one command, give a detailed multi-paged list of all processes that
are currently running on the [server]. 
```

我发现了[ps 命令](http://ss64.com/bash/ps.html)，但我正在处理的服务器上没有它的信息页面，我不完全理解。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:52:41.843

完整的选项列表可通过`man 1 ps`. 不同平台上的标志可能会有所不同，因此无法替代阅读系统的手册页。但是，假设您的*ps*版本使用非 BSD 标志，请特别注意`-t`and`-e`选项。

# android - 仅通过 adb 杀死 android monkey 进程

> ID：10584323
> 
> 赞同：1
> 
> 时间：2012-05-14T13:31:15.573
> 
> 标签：android, adb, monkey

我有一个猴子进程的问题。启动 Monkey 很容易，但如何停止呢？我知道如何停止任何进程，但我不知道如何调用猴子进程。DDMS 显示“？” 进程，就是这样，但我必须用 adb 命令杀死它。

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-20T14:31:59.130

命令 ：

```
adb shell ps | awk '/com\.android\.commands\.monkey/ { system("adb shell kill " $2) }' 
```

在安卓 2.3 上工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-03T07:12:27.627

1.  做 adb shell ps

2.  搜索进程名称猴子。记下猴子进程的pid（pidvalue）

3.  adb shell 杀死*pidvalue*。- 其中*pidvalue*是猴子进程的 pid。

就这样。猴子赛跑者停止了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T20:07:46.930

在带有 Android 2.2 的模拟器上，猴子进程称为“app_process”。你可以用

```
adb shell ps | awk '/app\_process/ { system("adb shell kill -9 " $2) }' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:38:20.413

只需使用一组事件运行它：

```
$ adb shell monkey -p your.package.name -v NUMEVENTS 
```

如果您不知道自己遇到了什么，并且用大量事件（任何大于 3 个零的事件）运行了猴子，那么您可以按照[我如何阻止猴子疯狂](https://stackoverflow.com/questions/9999036/how-do-i-stop-the-monkey-madness)的两个答案中的描述杀死它！

# events - TouchGridPanel 中的滚动事件

> ID：10584324
> 
> 赞同：0
> 
> 时间：2012-05-14T13:31:15.737
> 
> 标签：events, scroll, touch, extjs

我正在使用 Sencha Touch 1.0 构建一个移动应用程序。我需要显示报告，因为它使用 Ext.ux.TouchGridPanel 给出的网格。它工作正常。

我需要在 Ext.ux.TouchGridPanel 中捕获滚动事件。我在 Dataview 的气泡事件中添加了“滚动”。我还试图在创建 Dataview 后捕获事件。

但似乎没有任何效果。以下是我更改的代码。

有人知道如何捕获滚动事件的开始吗？

提前致谢。

```
Ext.ux.TouchGridPanel = Ext.extend(Ext.Panel, {
layout: "fit",

multiSelect: false,    

initComponent: function () {
    var me = this;

    me.items = me.dataview = me.buildDataView();

    Ext.ux.TouchGridPanel.superclass.initComponent.call(me);

    var store = me.store;
    store.on("update", me.dispatchDataChanged, me);

    var dataview = me.dataview;        
    dataview.on('scroll', me.startScroll);
},

dispatchDataChanged: function (store, rec, operation) {
    var me = this;

    me.fireEvent("storeupdate", store, rec, operation);
},

startScroll: function (scroller, offset) {
    console.log('is this event captured???')
    var me = this;
    me.fireEvent("scroll", this.scroller, offset);
},

buildDataView: function () {
    var me = this, colModel = me.colModel, colNum = me.getColNum(false), cellWidth = 100 / colNum,
    colTpl = '<div class="x-grid-head">';
    colTpl += '<thead><tr class="x-grid-header">';

    for (var i = 0; i < colModel.length; i++) {
        var col = colModel[i];
        var width = (Ext.isDefined(col.width)) ? ("width =" + (col.width - 4) + "%") : '';
        colTpl += '<th class="x-grid-cell" ' + width + ' style="' + col.style + '" >' + col.header + '</th>';
    }
    colTpl += '</tr></thead>';
    colTpl += '<tbody ><tpl for="."><tr class="x-grid-row">';
    for (var i = 0; i < colModel.length; i++) {
        var col = colModel[i];
        var width = (Ext.isDefined(col.width)) ? ("width =" + col.width + "%") : '';
        colTpl += '<td class="x-grid-cell" style="' + col.style + '"   >{' + col.mapping + '}</td>';
    }
    colTpl += '</tr></tpl></tbody>';

    colTpl += '</table></div>'

    return new Ext.DataView({
        store: me.store,
        itemSelector: "tr.x-grid-row",
        simpleSelect: me.multiSelect,
        scroll: me.scroll,
        tpl: new Ext.XTemplate(colTpl,
            {
                isRowDirty: function (dirty, data) {
                    return dirty ? "x-grid-row-dirty" : "";
                }
            }
        ),
        prepareData: function (data, index, record) {
            var column,
                i = 0,
                ln = colModel.length;
            var prepare_data = {};
            prepare_data.dirtyFields = {};
            for (; i < ln; i++) {

                column = colModel[i];
                if (typeof column.renderer === "function") {
                    prepare_data[column.mapping] = column.renderer.apply(me, [data[column.mapping], column, record, index]);
                } else {
                    prepare_data[column.mapping] = data[column.mapping];
                }
            }

            prepare_data.isDirty = record.dirty;

            prepare_data.rowIndex = index;
            return prepare_data;
        },
        bubbleEvents: [
            "beforeselect",
            "containertap",
            "itemdoubletap",
            "itemswipe",
            "itemtap",
            "selectionchange",
                    "scroll"
        ]

    });
},

// @private
onScrollStart: function () {
    console.log("Are you coming here");
    var offset = this.scroller.getOffset();
    this.closest = this.getClosestGroups(offset);
    this.setActiveGroup(this.closest.current);
},

// @private
onScroll: function (scroller, pos, options) {

} 
```

});

Ext.reg("touchgridpanel", Ext.ux.TouchGridPanel);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:19:45.537

We can directly access dataview scroller and check event of the same.

For eg.

```
newGrid = new Ext.ux.TouchGridPanel({.... 
```

after creation of the Panel just access its dataview scroller

```
newGrid.dataview.scroller.on('scroll', scrollGrid1);    

var scrollGrid1 = function(scroller, offsets){   
  console.log(' Grid scrolling with offset ' + offsets.x + ' & ' + offsets.y);
} 
```

# ruby - Ruby 轻松搜索散列数组中的键值对

> ID：10584326
> 
> 赞同：26
> 
> 时间：2012-05-14T13:31:22.850
> 
> 标签：ruby, arrays

假设我有这个哈希数组：

```
[
{"href"=>"https://company.campfirenow.com", "name"=>"Company", "id"=>123456789, "product"=>"campfire"},
{"href"=>"https://basecamp.com/123456789/api/v1", "name"=>"Company", "id"=>123456789, "product"=>"bcx"}, 
{"href"=>"https://company.highrisehq.com", "name"=>"Company", "id"=>123456789, "product"=>"highrise"}
] 
```

如何解析**“product”=>“bcx”**的哈希值的“ **href ”值**

 **在 Ruby 中有没有简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-14T13:33:46.830

```
ary = [
  {"href"=>"https://company.campfirenow.com", "name"=>"Company", "id"=>123456789, "product"=>"campfire"},
  {"href"=>"https://basecamp.com/123456789/api/v1", "name"=>"Company", "id"=>123456789, "product"=>"bcx"}, 
  {"href"=>"https://company.highrisehq.com", "name"=>"Company", "id"=>123456789, "product"=>"highrise"}
]

p ary.find { |h| h['product'] == 'bcx' }['href']
# => "https://basecamp.com/123456789/api/v1" 
```

请注意，这仅在元素存在时才有效。否则，您将调用订阅运算符`[]`on `nil`，这将引发异常，因此您可能需要先检查一下：

```
if h = ary.find { |h| h['product'] == 'bcx' }
  p h['href']
else
  puts 'Not found!'
end 
```

如果您需要多次执行该操作，您应该为自己构建一个数据结构以便更快地查找：

```
href_by_product = Hash[ary.map { |h| h.values_at('product', 'href') }]
p href_by_product['campfire'] # => "https://company.campfirenow.com"
p href_by_product['bcx']      # => "https://basecamp.com/123456789/api/v1" 
```**

# objective-c - 何时将数据精确地保存在 UiView 中？

> ID：10584330
> 
> 赞同：0
> 
> 时间：2012-05-14T13:31:35.090
> 
> 标签：objective-c, uitableview, concurrency

我的问题是：我必须在视图的哪个函数中执行代码并确保前面视图的所有工作都已完成？保存的所有数据以及其他？

这是我的情况，让我问这个问题：我有三个视图 1）出发岛 2）到达岛 3）地图

在出发岛上，您可以选择从哪个岛出发，在您想到达的目的地时，在地图上，您可以直观地看到到达目的地所必须遵循的路线。以编程方式，我有前两个视图，它们是两个表视图（岛屿名称字符串列表），第三个是一个简单的图像视图，它有一个在其上绘制路线的系统。我将数据保存到一个简单的 sql 数据库，但我在使用 NSUserDefaults 更简单地保存数据时遇到了同样的问题。两个表视图保存在他们选择的岛

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     NSString *islandChoosen= [departureIsland objectAtIndex:indexPath.row];
     [[IslandDatabase database] saveOneRecord:@"1" name:arrivalIslandChoosen];
} 
```

在 IslandDatabase 类中

```
- (void) saveOneRecord:(NSString *)id name:(NSString *)name {

    NSLog(@"Saving data Partenza");
    sqlite3_stmt *statementINSERT;
    NSString somedataToInsertContainingNameofTheIsland;

    NSString *insertSQL = [NSString stringWithFormat: @"INSERT INTO aTable somedataToInsertContainingNameofTheIsland"; 
    NSLog(@"%@", insertSQL);

    sqlite3_prepare_v2(database,[insertSQL UTF8String], -1, &statementINSERT, NULL);
    sqlite3_step(statementINSERT);
    sqlite3_finalize(statementINSERT); 
```

} *为简单起见，省略实际查询的代码

现在，当我选择第二个岛屿时，我继续前往地图，在地图的 viewDidLoad 上，我尝试获取选择的两个岛屿的数据以构建我的路线。这就是问题所在。我可以得到选择的第一个岛屿的数据，但不能得到第二个岛屿的数据，这是时间问题。

我做了很多测试，似乎我在第二个视图（到达岛）的 didSelectRowAtIndexPath 中保存的数据实际上在第三个视图（地图）的 viewDidLoad*之后*完成，没有给我时间获取数据当我需要它们时，我执行在 viewDidLoad 中绘制路线的代码。我在真正将数据写入数据库时​​调用的 NsLog 恰好在地图视图设计和启动后显示。

我试图在第三个视图 viewDidLoad 开始时做一段时间，一直持续到第二个岛的数据可用但我没有运气..它似乎只是在设计第三个视图之前被卡住了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:43:06.910

您应该尝试使用`- (void)viewWillAppear:(BOOL)animated`而不是在第三个视图中加载数据`- (void)viewDidLoad`吗？

`viewDidLoad`当控制器将其层次结构加载到内存中时调用该方法，这会急切地优化性能。

# javascript - Safari 将 URL # 片段合并到其浏览器缓存中

> ID：10584331
> 
> 赞同：2
> 
> 时间：2012-05-14T13:31:35.870
> 
> 标签：javascript, ajax, caching, safari, fragment

我正在研究加快我们网站速度的解决方案。我让客户端首先 ajax 加载应用程序的预期下一页：

```
$.ajax({url: '/some/real/path', ...}); 
```

服务器对此做出响应并在标头中包含：

```
Cache-Control => 'max-age=20' 
```

这将响应标记为可缓存。

然后，客户端应用程序等待查看其预测是否正确，并在发现正确后将浏览器转换到同一页面，但将一些信息作为# 片段添加到 URL 中，这些信息可供我们使用仅当用户实际执行了他们的操作时（即不可预测）：

```
location.href = '/some/real/path#additionalInfoInFragement'; 
```

当浏览器转换到页面时，片段中的附加信息会被该页面的 javascript 获取并在那里实现一些效果。

对于包括 Safari 在内的所有浏览器，对起始 ajax 请求的响应已正确插入浏览器缓存中。

然后，对于除 Safari 之外的所有浏览器，当我们将 location.href 转换到该页面时，浏览器会将该内容从缓存中拉出。这避免了服务器命中，是我们提速的基础。

Safari 虽然没有使用缓存来重新提供内容。它似乎被过渡的“#additionalInfoInFragment”部分绊倒了。它将片段包含在其用于检查现有缓存内容的缓存键的构造中。以下是我通过 sqlite 转储的 Safari 的 cache.db 文件中的条目：

```
* ajax request: INSERT INTO "cfurl_cache_response" VALUES(3260,0,-1982644086,0,'http://localhost:8080/TomcatScratchPad/EmptyPage','2012-05-14 07:01:10');

* location.href transition: INSERT INTO "cfurl_cache_response" VALUES(3276,0,-230554366,0,'http://localhost:8080/TomcatScratchPad/EmptyPage#wtf','2012-05-14 07:01:20'); 
```

同样值得注意的是 Chrome 的行为是正确的，尽管两者共享大量的 WebKit 代码。

我真的很感激社区的任何想法。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:37:33.927

我只看到几个选项：

1.  向 Apple 提交错误报告，不要担心。:-) 您的缓存内容仍然适用于其他浏览器。总体而言，Safari 的[市场份额](http://marketshare.hitslink.com/browser-market-share.aspx?qprid=2&qpcustomd=0)[*非常*](http://marketshare.hitslink.com/browser-market-share.aspx?qprid=2&qpcustomd=0)小，当然，如果您的网站针对的是（例如）iPad 或 iPhone 用户，这反而会改变您特定网站的统计数据的性质。:-) （您可能从您的日志中知道您的 Safari 用户有多大。）

    子类别：如果 Safari 是您的目标市场的重要组成部分并且这确实让您感到困扰，请查看它是否是它的任何开源部分中的错误，如果是，请提供补丁。

2.  不要使用片段标识符来传递信息，而是使用其他东西（也许是 cookie）。

# regex - 用于提取坐标的python正则表达式

> ID：10584339
> 
> 赞同：1
> 
> 时间：2012-05-14T13:32:22.050
> 
> 标签：regex

有人可以帮助我使用正则表达式来提取此列表中 MULTIPOLYGON 中的 3-D 坐标：

```
[(1,
  'public Library',
  'SRID=4326;MULTIPOLYGON(((352877.02163887 1233618.83923531 5,352872.32998848 1233609.44478035 5,352867.693426132 1233612.15611458 5,352861.67354393 1233602.76770592 5,352841.814386368 1233616.9818058 5,352848.495328903 1233625.69463921 5,352861.076768875 1233617.56668663 5,352866.429475784 1233626.28557014 5,352877.02163887 1233618.83923531 5)))')] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:19:27.037

我认为此正则表达式可能会在您的字符串中找到您要查找的内容： '([\d.]+?)\s([\d.]+?)\s([\d.]+?)'

我用python对其进行了测试，它返回了一个坐标列表列表：

```
import re
foo = "SRID=4326;MULTIPOLYGON(((352877.02163887 1233618.83923531 5,352872.32998848 1233609.44478035 5,352867.693426132 1233612.15611458 5,352861.67354393 1233602.76770592 5,352841.814386368 1233616.9818058 5,352848.495328903 1233625.69463921 5,352861.076768875 1233617.56668663 5,352866.429475784 1233626.28557014 5,352877.02163887 1233618.83923531 5)))"
print re.findall('([\d.]+?)\s([\d.]+?)\s([\d.]+?)', foo) 
```

它打印：

```
[('352877.02163887', '1233618.83923531', '5'), ('352872.32998848', '1233609.44478035', '5'), ('352867.693426132', '1233612.15611458', '5'), ('352861.67354393', '1233602.76770592', '5'), ('352841.814386368', '1233616.9818058', '5'), ('352848.495328903', '1233625.69463921', '5'), ('352861.076768875', '1233617.56668663', '5'), ('352866.429475784', '1233626.28557014', '5'), ('352877.02163887', '123361 8.83923531', '5')] 
```

# c# - Entity Framework 5.0b2 Code First：同一张表的一对多和一对一，带有级联删除

> ID：10584341
> 
> 赞同：4
> 
> 时间：2012-05-14T13:32:25.567
> 
> 标签：c#, entity-framework, entity-framework-5

经过几个小时的反复试验，我到达了这个[线程](https://stackoverflow.com/questions/5346870/entity-framework-code-first-how-can-i-create-a-one-to-many-and-a-one-to-one-rel)，它解释了如何建立一个一对多的关系和一个一对一的关系与相同的两种类型。

但是，我不能让它与 Cascade Delete 一起使用：

> 抛出：“无法确定相关操作的有效排序。由于外键约束、模型要求或存储生成的值，可能存在依赖关系。” (System.Data.UpdateException) 异常消息 = “无法确定依赖操作的有效顺序。由于外键约束、模型要求或存储生成的值，可能存在依赖关系。”，异常类型 = “System.Data.UpdateException "

仅当我不取消设置 1:1 关系时才会发生这种情况（请参见下面的代码），我认为这是有道理的，因为它会创建一个无效的引用。我只是想知道是否有更好的方法来表示这一点。

示例代码：

```
class Program
{
    static void Main(string[] args)
    {
        Database.SetInitializer(new DropCreateDatabaseAlways<Context>());

        using (var ctx = new Context())
        {
            var user = new User();

            ctx.Users.Add(user);
            ctx.SaveChanges();

            var source = new PaymentSource();
            user.PaymentSources = new Collection<PaymentSource>();
            user.PaymentSources.Add(source);
            user.DefaultPaymentSource = source;
            ctx.SaveChanges();

            // if I don't do this, I get ordering exception
            user.DefaultPaymentSource = null;
            ctx.SaveChanges();

            ctx.Users.Remove(user);
            ctx.SaveChanges();

            Assert.Equal(0, ctx.Users.Count());
            Assert.Equal(0, ctx.PaymentSources.Count());
        }
    }
}

public class User
{
    public int Id { get; set; }

    public virtual ICollection<PaymentSource> PaymentSources { get; set; }
    public virtual PaymentSource DefaultPaymentSource { get; set; }
    public int? DefaultPaymentSourceId { get; set; }
}

public class PaymentSource
{
    public int Id { get; set; }
    public virtual User User { get; set; }
    public int UserId { get; set; }
}

public class Context : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<PaymentSource> PaymentSources { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Entity<User>()
            .HasOptional(u => u.DefaultPaymentSource)
            .WithMany()
            .HasForeignKey(u => u.DefaultPaymentSourceId)
            .WillCascadeOnDelete(false);

        modelBuilder.Entity<PaymentSource>()
            .HasRequired(p => p.User)
            .WithMany(p => p.PaymentSources)
            .HasForeignKey(p => p.UserId)
            .WillCascadeOnDelete();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:11:25.937

我列出了其他选项来描述您的抽象：

**一个。**

如何使用 3 个这样的表：

```
user 1-* paymentSource
user 1-0..1 DefaultPaymentSource
DefaultPaymentSource 0..1-1 PaymentSource 
```

或这个：

**B.**

```
user 1-* paymentSource
user 1-0..1 DefaultPaymentSource
DefaultPaymentSource --derive from--> PaymentSource 
```

或这个：

**C。**

```
user 1-* paymentSource
PaymentSource has addtional boolean field for "IsDefault" 
```

我投票选择 B 为最佳选项。

我确信从同一个源表到同一个目标表的两个关系不是一个好主意。它可能违反了一些关于数据库最佳实践的规则或模式。

# python - 为什么 paramiko 的连接速度可能比 openssh 客户端慢？

> ID：10584343
> 
> 赞同：2
> 
> 时间：2012-05-14T13:32:32.560
> 
> 标签：python, ssh, paramiko

我正在使用 paramiko 通过 ssh 运行一些命令。我注意到 paramiko 需要 2-3 秒来打开一个连接，而命令行 ssh 客户端几乎是即时的。

使用一些打印，我发现症结是 Transport.auth_publickey（它使用的是发现的 ~/.ssh/id_dsa）。这与命令行 ssh 使用的身份验证方法相同，那么为什么 paramiko 运行得更慢呢？

我用来连接的代码非常简单：

```
 ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    ssh.connect('myhostname', **{'username': 'root'}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-05T10:11:53.630

这很可能是因为Diffie-Hellman 密钥交换和 RSA 公钥认证所需的[模幂](https://en.wikipedia.org/wiki/Modular_exponentiation)运算在 Python 字节码解释器（如在纯 Python Paramiko 中）中比经过高度优化的编译原生二进制文件慢几个数量级。 OpenSSH 使用。

# c++ - 无法从头文件 C++ 访问主文件中的函数

> ID：10584344
> 
> 赞同：0
> 
> 时间：2012-05-14T13:32:33.607
> 
> 标签：c++, scope

我不知道为什么我不能从头文件中的 .cpp 文件中访问函数 clearConsole()，我想我说错了吗？如何从头文件定位主文件？在用户输入 customer.h 中的 addCustomer() 函数后，我尝试调用 clearConsole() 函数。

主文件

```
// OTS.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include <fstream>
#include <iomanip>
#include <string>
using namespace std;

#include "customer.h"

// Clear function specific to Windows 
// Cross platform alternatives are more convoluted to reach desired effect, so have not been included
void clearConsole()
{
    #ifdef _WIN32
    system("cls");
    #endif
} 
```

客户.h

```
//customer.H
//The object class customer

   class customer
    {
    //...
    clearConsole();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:33:37.337

如果您的文件链接在一起，则函数的前向声明就足够了。

**客户.h**

```
//customer.H
//The object class customer

void clearConsole(); // <--- declare function

class customer
{

//....

}; 
```

但是这个结构看起来是错误的。我将在 a 内的不同标头中声明该函数`namespace`，并在相应的实现文件中定义它：

**清除控制台.h**

```
namespace ConsoleUtils
{
    void clearConsole();
} 
```

**清除控制台.cpp**

```
namespace ConsoleUtils
{
    void clearConsole()
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:27:28.493

将您的 clearConsole() 方法移至头文件（我认为不在讨论中。我实际上不同意的 .header 文件下的实现，但无论如何......），并将系统消息更改为您需要的特定消息，如下所示：

```
#ifndef _WIN32
#include <syscall.h>
#endif

void clearConsole(){
    #ifdef _WIN32
    system("cls");
    #else
    system("clear");
    #endif
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-27T04:15:54.677

我在用 C、C++ 和汇编编写的内核中也遇到了这个问题。我可以通过使用标志告诉`ld`命令允许共享变量和函数来解决这个问题。`-shared`在 gcc 中你会做同样的事情，因为 gcc 是一个链接器、程序集、c 编译器和一个 c++ 编译器。

# c# - XNA 主菜单中的光标移动得很快？

> ID：10584346
> 
> 赞同：2
> 
> 时间：2012-05-14T13:32:37.690
> 
> 标签：c#, xna

我有一个小问题。我正在为我的游戏使用标题屏幕或主菜单。这是主窗口的屏幕截图：

**[截屏](http://i.stack.imgur.com/2pJc2.png)**

和代码：

```
class MenuPrincipal
{
    public Texture2D Fondo { get; set; }
    public Texture2D Cursor { get; set; }

    int cambiar = 0;
    int tiempoTranscurrido;

    KeyboardState teclaActual;

    bool menuActivo;
    public bool MenuActivo 
    { 
        get { return menuActivo; } 
        set { menuActivo = value; } 
    }

    public MenuPrincipal(Texture2D fondo, Texture2D cursor)
    {
        Fondo = fondo;
        Cursor = cursor;
    }

    public void Update(GameTime gameTime)
    {
        teclaActual = Keyboard.GetState();

        tiempoTranscurrido = gameTime.ElapsedGameTime.Milliseconds;

        if (tiempoTranscurrido > 50)
        {
            tiempoTranscurrido = 0;

            if (teclaActual.IsKeyDown(Keys.Down))
            {
                if (cambiar > 2)
                    cambiar = 0;
                else
                    cambiar++;
            }
        }
     }

    public void Draw(SpriteBatch spriteBatch)
    {
        spriteBatch.Draw(Fondo, new Rectangle(0, 0, 800, 600), Color.White);

        switch(cambiar)
        {
            case 0: spriteBatch.Draw(Cursor, new Rectangle(325, 225, 16, 12), Color.White);
                    break;

            case 1: spriteBatch.Draw(Cursor, new Rectangle(325, 281, 16, 12), Color.White); 
                    break;

            case 2: spriteBatch.Draw(Cursor, new Rectangle(325, 336, 16, 12), Color.White); 
                    break;
        }
    }

} 
```

}

当用户按下向下箭头键时，我希望光标从“un jugador”移动到“opciones”，并从“opciones”移动到“creditos”。然而，当用户按下向下键时，光标移动得非常快。我想要一个速度限制，这样当我按一次键时，光标会移动一个选项。如果我放置一个“限制框架”（变量`tiempoTranscurrido`），光标永远不会移动。如果我什么都不放，光标移动得非常快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:35:55.347

添加一个标志，直到钥匙出现，像这样......

```
bool keyDown = false;
public void Update(GameTime gameTime)
{
    teclaActual = Keyboard.GetState();

    tiempoTranscurrido = gameTime.ElapsedGameTime.Milliseconds;

    if (tiempoTranscurrido > 50)
    {
        tiempoTranscurrido = 0;

        if (teclaActual.IsKeyDown(Keys.Down) && !keyDown)
        {
            keyDown = true;
            if (cambiar > 2)
                cambiar = 0;
            else
                cambiar++;
        }
        if (teclaActual.IsKeyUp(Keys.Down))
        {
            keyDown = false;
        }
    }
} 
```

# c# - 使用 LINQ 如何从集合实体中创建实体的一个特定字段的列表

> ID：10584347
> 
> 赞同：4
> 
> 时间：2012-05-14T13:32:38.660
> 
> 标签：c#, linq, list, lambda

如果我有以下收藏

```
IEnumerable<ProviderOrganisation> listOfProviders

public class ProviderOrganisation
{
    public virtual string Code { get; set; }
    public virtual string Description { get; set; }
    public virtual int SortOrder { get; set; }
    public virtual bool IsDefault { get; set; }
    public virtual DateTime EffectiveStartDate { get; set; }
    public virtual DateTime? EffectiveEndDate { get; set; }
} 
```

请问如何编写 LINQ 来生成代码集合？

所以，只是一个代码列表：

```
List<string> listOfCodes 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:34:19.030

使用[`Enumerable.Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)和[`Enumerable.ToList`](http://msdn.microsoft.com/en-us/library/bb342261.aspx)。

```
List<String> listOfCodes = listOfProviders
                     .Select(p => p.Code)
                     .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:33:58.967

您可以调用该[`Select()`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)方法仅提取您需要的属性。然后调用[`ToList()`](http://msdn.microsoft.com/en-us/library/bb342261.aspx)施放它。

```
listOfProviders.Select(p => p.Code).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T01:55:02.850

在查询语法中，它看起来像这样：

```
List<string> listOfCodes = (from p in listOfProviders
                            select p.code).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-26T13:22:26.953

我喜欢使用 ConvertAll

```
List<string> listOfCodes = listOfProviders
                    .ToList()
                    .ConvertAll(x => x.Code); 
```

一些测试表明，ConvertAll 比当前接受的答案的方法稍微快一点！:)

# android - json格式的异步任务问题

> ID：10584349
> 
> 赞同：0
> 
> 时间：2012-05-14T13:32:46.883
> 
> 标签：android, json, android-asynctask

我从服务器以文本形式获取数据时遇到问题我无法转换为 json 对象无法转换为 json 数组我只是从数据库中获取标题和作者并显示在列表视图中

```
 {"document":[{"id":"1","title":"complete refrence of android",
"author":"parag vyas","description":"lnvkzxhbkgbovdghognsdkhogjhlldnglj"}]} 
```

请帮帮我

```
public class showalbooks extends Activity {
ArrayList<String> mylist = new ArrayList<String>();
String returnString="";

  ListView listView ;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.showalbooks);

     listView = (ListView) findViewById(R.id.mylist);
    new LongRunningGetIO().execute();

}

private class LongRunningGetIO extends AsyncTask <Void, Void, String> {

    protected String getASCIIContentFromEntity(HttpEntity entity) throws IllegalStateException, IOException {
       InputStream in = entity.getContent();
         StringBuffer out = new StringBuffer();
         int n = 1;
         while (n>0) {
             byte[] b = new byte[4096];
             n =  in.read(b);
             if (n>0) out.append(new String(b, 0, n));
         }
         return out.toString();
    }

    @Override
    protected String doInBackground(Void... params) {
         HttpClient httpClient = new DefaultHttpClient();
         HttpContext localContext = new BasicHttpContext();
         HttpGet httpGet = new HttpGet("http://192.168.1.156/recess/document/document.json");
         HttpClient client = new DefaultHttpClient();
         HttpResponse response=null;
         try{
          response = client.execute(httpGet);
          }
         catch(Exception e){}
         System.out.println(response.getStatusLine());
         String text = null;
         try {
                response = httpClient.execute(httpGet, localContext);
               HttpEntity entity = response.getEntity();
               text = getASCIIContentFromEntity(entity);

         } catch (Exception e) {
             return e.getLocalizedMessage();
         }
              String var =text;             
              try{
                  JSONArray jArray = new JSONArray(var);
                  for(int i=0;i<jArray.length();i++){

                          JSONObject json_data = jArray.getJSONObject(i);
                          Log.i("log_tag","id: "+json_data.getString("id")+
                                  ", title: "+json_data.getString("title")
                          );
                          returnString += "\n" +"id:"+ json_data.getString("id")+" "+"Title:"+ json_data.getString("title");

                          }

          }
          catch(JSONException e){
                  Log.e("log_tag", "Error parsing data "+e.toString());
          }

              listView.setFilterText(returnString);
            return returnString;
    }   
    protected void onPostExecute(String results) {
        if (results!=null) {

            listView.setOnItemClickListener(new OnItemClickListener() {

                @Override
                public void onItemClick(AdapterView<?> arg0, View listview,
                        int documentid, long documenttitle) {
                    // TODO Auto-generated method stub

                }
        });
        }

}}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:37:03.900

JSON 数组包含在 JSON 对象中，并具有 id “文档”。

代替：

```
JSONArray jArray = new JSONArray(var); 
```

你应该有：

```
JSONObject jObj = new JSONObject(var);
JSONArray jArray = jObj.getJSONArray("document"); 
```

# iphone - 如何知道 Flex 应用程序是否在 iPad 或 iPhone 上运行

> ID：10584351
> 
> 赞同：0
> 
> 时间：2012-05-14T13:32:55.847
> 
> 标签：iphone, ipad, apache-flex

我有一个在 iPad 上运行的 Flex 应用程序，现在我希望同一个应用程序在 iPhone 上运行，并对视图界面进行一些修改，以保持它们的外观和感觉。问题是：是否可以判断应用程序何时在 iPad 上运行以及何时在 iPhone 上运行以执行此类操作？我知道这样做：

```
flash.system.Capabilities.version.indexOf("IOS"); 
```

您可以知道应用程序是否在 iOS 上运行，但您不知道是哪个设备。

我希望你能帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T12:24:26.067

**edsv14**, actually you've almost got what you want :)
Just instead of *Capabilities.version* use *Capabilities.os*.
So you'll get smth. like this: "iPhone OS 5.1.1 iPod4,1" (iPod), "iPhone OS 6.0.1 iPad2,2" (iPad2), "iPhone OS 5.1.1 iPad3,3" (iPad3), "iPhone OS 4.3.3 iPhone3,1" (iPhone4) etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:50:22.943

[使用Capabilities.screenResolutionX](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Capabilities.html#screenResolutionX)和[Capabilities.screenResolutionY](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Capabilities.html#screenResolutionY)检查屏幕分辨率？

您可以执行一些条件逻辑来确定您使用的 iOS 设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:49:51.040

`Capabilities`您可以通过屏幕分辨率来区分设备，使用该类可以很好地工作。不过，要进一步区分 iPad1/2 和 3，您需要一些解决方法。

查看这篇文章：[http ://www.richardlord.net/blog/using-the-ipad-retina-display-with-adobe-air](http://www.richardlord.net/blog/using-the-ipad-retina-display-with-adobe-air)

# linux - 在 Debian 中使用文件夹解压缩存档？

> ID：10584356
> 
> 赞同：11
> 
> 时间：2012-05-14T13:33:32.150
> 
> 标签：linux, directory, rar

我有任务：我有 Windows 制作的 rar 存档（文件夹、其中的文件等），通过 FTP 复制到 Linux 服务器。我想解压缩此存档以保持文件结构与 Windows 中的一样 - 带有文件夹。

```
rar у my_archivive 
```

有效，但我只有没有文件夹的文件列表。

怎么做 ？

谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-14T13:35:49.830

`man unrar`说

```
x      Extract files with full path. 
```

# python - 在python中合并数据时填补空白

> ID：10584358
> 
> 赞同：1
> 
> 时间：2012-05-14T13:33:40.123
> 
> 标签：python, csv, matrix, gaps-and-islands

这是我的问题：我从几个矩阵开始，从中提取数据以构建一个新的通用矩阵。第一步是使用 csv 模块读取 infiles 并提取将用作最终矩阵中的列标题的“位置”值（存储在行 [1] 中）。每个 infile 包含总“位置”的一个子集，这些位置有时存在于多个 infile 中。所以我首先从所有“位置”值的合并中构建一个有序列表（从更小到更大的整数），忽略重复的值。这就是我的做法：

```
for infile in glob.glob('passed_*.vcf'):
    infilen=open(infile)
    inf = csv.reader(infilen,delimiter='\t')
    for row in inf:
        if row[1] in pos:
            continue
        else:
            pos.append(row[1])
    infilen.close()
pos.sort(key=int)
head=str('\t'.join(pos))
of=open('trial.txt', 'a')   
print>>of,head 
```

完成此操作后，我返回原始 infiles 并读取另一个值（这次在 row[3] 中），我想在上面创建的相应标题下添加它（即“位置”）。由于每个 infile 都包含总位置的一个子集，因此当最终矩阵位置（存储在列表“pos”中）不存在于单个 infile 的行 [1] 中时，我将不得不填补空白。这是我正在尝试的代码：

```
for infile in glob.glob('passed_*.vcf'):
    infilen=open(infile)
    inf = csv.reader(infilen,delimiter='\t')
    seq=[]
    for row in inf:
        if row[1] in pos:
            seq.append(row[3])  
        else:
            seq.append('N') 
```

不用说，我被困住了。我正在考虑使用 while 循环，但由于我没有真正的经验，所以我想请教您任何形式的建议。

## 样本数据

输入（样本 1）：

```
1   2025    blah    A   .   blah    PASS    AC=0    GT:DP   0/0:61
2   2027    blah    C   .   blah    blah    AC=0    GT:DP   0/0:61
3   2028    blah    T   .   blah    PASS    AC=0    GT:DP   0/0:61 
```

输入（样本 n）：

```
1   2025    blah    G   .   blah    PASS    AC=0    GT:DP   0/0:61
2   2026    blah    A   .   blah    blah    AC=0    GT:DP   0/0:61
3   3089    blah    T   .   blah    PASS    AC=0    GT:DP   0/0:61 
```

输出（单个矩阵，输入 row[1] 作为变量，row[3] 作为值。每一行是一个不同的样本，即不同的输入文件）：

```
 2025    2026    2027    2028  ...  3089
sample1    A       NaN     C       T         NaN
samplen    G        A     NaN     NaN         T 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:47:58.390

```
>>> from collections import defaultdict
>>> import glob
>>> pos = defaultdict(dict)
>>> for index, infile in enumerate(glob.glob('D:\\DATA\\FP12210\\My Documents\\Temp\\Python\\sample*.vcf'), 1):
    for line in open(infile):
        # Convert value in integer already
        val, letter = int(line.split()[1]), line.split()[3]
        pos[val][index] = letter

>>> def print_pos(pos):
    """ Formats pos """
    # Print header by sorting keys of pos
    values = sorted(pos.keys())
    print '          ',
    for val in range(values[0], values[-1] + 1):
        print '{0:5}'.format(val),
    print

    # pos has keys according to row1, create pos2 with keys = sample #
    pos2 = defaultdict(dict)
    for val, d in pos.iteritems():
        for index, letter in d.iteritems():
            pos2[index][val] = letter

    # Now easier to print lines
    for index in sorted(pos2.keys()):
        print ' sample{0:2} '.format(index),
        for val in range(values[0], values[-1] + 1):
            if val in pos2[index]:
                print '   {0} '.format(pos2[index][val]),
            else:
                print ' NaN ',
        print

>>> print_pos(pos)
            2025  2026  2027  2028  2029  2030  2031  2032
 sample 1     A   NaN     C     T   NaN   NaN   NaN   NaN 
 sample 2     G     A   NaN   NaN   NaN   NaN   NaN     T 
>>> 
```

我`pos`用来收集值，我也使用`pos2`包含不同排序的相同数据用于打印目的，因为：

*   `pos`以价值为导向，对具有价值范围很有用
*   `pos2`是面向样本的，对于给定样本编号的值很有用

为了没有太大的范围，我使用了值：

-sample1.vcf：

```
1   2025    blah    A   .   blah    PASS    AC=0    GT:DP   0/0:61
2   2027    blah    C   .   blah    blah    AC=0    GT:DP   0/0:61
3   2028    blah    T   .   blah    PASS    AC=0    GT:DP   0/0:61 
```

-sample2.vcf：

```
1   2025    blah    G   .   blah    PASS    AC=0    GT:DP   0/0:61
2   2026    blah    A   .   blah    blah    AC=0    GT:DP   0/0:61
3   2032    blah    T   .   blah    PASS    AC=0    GT:DP   0/0:61 
```

# android - 是否有任何用于社交网络的一体化库

> ID：10584359
> 
> 赞同：2
> 
> 时间：2012-05-14T13:33:40.937
> 
> 标签：android, facebook

我正在尝试实现从我的 Android 应用程序发布到多个社交网络（Facebook、Twitter ...）的可能性，而不是一一通过 API，我想知道是否存在允许我这样做的免费库只需一个链接和简单的调用。

我搜索过旧问题，但像 SocialLib 这样的解决方案已经完全从互联网上消失了，而其他解决方案则从 libs 转向付费服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:45:31.750

Android 中的 Share api 怎么样：

```
//create the send intent
Intent shareIntent = Intent(android.content.Intent.ACTION_SEND);

//set the type
shareIntent.setType("text/plain");

//add a subject
shareIntent.putExtra(android.content.Intent.EXTRA_SUBJECT,  "Insert Subject Here");

//build the body of the message to be shared
String shareMessage = "Insert message body here.";

//add the message
shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, shareMessage);

//start the chooser for sharing
startActivity(Intent.createChooser(shareIntent, "Insert share chooser title here")); 
```

你会得到这个弹出窗口：http: [//4.bp.blogspot.com/-gn8nnLC70Xc/TrFoY1GxKtI/AAAAAAAAAEI/6UDPHv-Zxv8/s1600/sharelist.png](http://4.bp.blogspot.com/-gn8nnLC70Xc/TrFoY1GxKtI/AAAAAAAAAEI/6UDPHv-Zxv8/s1600/sharelist.png)

# php - 如何将数据从 jQuery 传递到 php 以保存到数据库中？

> ID：10584370
> 
> 赞同：3
> 
> 时间：2012-05-14T13:34:22.743
> 
> 标签：php, jquery, mysql

我已经阅读了 jQuery.ajax 方法，并相信这应该是我需要的——但到目前为止还不能让它工作。

我用一个名为“users”的表创建了一个测试 mysql 数据库，在该表中添加了“name”和“location”的行，然后确保我可以使用命令行将数据保存到它，我可以。然后我制作了一个带有按钮的测试页面并将这个副本添加到我的脚本文件中（$.ajax 部分直接来自 jQuery api 示例）：

```
$('#button').click(function(){
    saveData();
});

function saveData(){  
$.ajax({
       type: "POST",
   url: "process.php",
   data: { name: "John", location: "Boston" }
    }).done(function( msg ) {
 alert( "Data was saved: " + msg );
    });
} 
```

我确实收到了一条警报消息，“数据已保存”，但实际上没有任何内容保存到我的数据库中。我一定是对 process.php 做错了，但不确定是什么。这是 process.php 中的代码（我为数据库、db_host、用户等设置了变量，我没有在这里显示）：

```
// 1\. Create a connection to the server. 
$connection = mysql_connect($db_host, $db_user,$db_pwd);

// make sure a connection has been made
if (!$connection){
die("Database connection failed: " . mysql.error());
}

// 2\. Select the database on the server
$db_select = mysql_select_db($database, $connection);
if (!$db_select){
die("Database selection failed: " . mysql.error());
}

// START FORM PROCESSING
if (isset($_POST['submit'])) { // Form has been submitted.
    $name = trim(mysql_prep($_POST['name']));
$location = trim(mysql_prep($_POST['location']));

// INSERT THE DATA 
$query = "INSERT INTO user ( name, location )
              VALUES ( '{$name}','{$location}' )";
        // Confirm if the query is successful.
        $result = mysql_query($query, $connection);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:42:41.107

其他人已经告诉过使用“成功”和“错误”这确实是捕获成功/错误回调的更好方法。但这并不是为什么没有插入任何内容的问题。除此之外，您的 Ajax 调用看起来还不错。

我看到的另一个问题是您只传递了以下参数：

```
data: { name: "John", location: "Boston" } 
```

但是在您的 PHP 代码中，您会检查是否设置了提交按钮：

```
if (isset($_POST['submit'])) 
```

显然情况并非如此，因为发送的唯一内容是您在 Ajax 调用的“数据”属性中传递的内容。而是使用：

```
if ( $_SERVER['REQUEST_METHOD'] == 'POST' ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:40:30.590

在这个例子中，$_POST['submit'] 没有设置，因为你没有像往常一样发送表单，你是用 ajax 发送数据并且没有任何名为“submit”的变量。

这可能会更好：

```
if ((isset($_POST['name'])) && (isset($_POST['location']))) { // Form has been submitted.
    $name = trim(mysql_prep($_POST['name']));
$location = trim(mysql_prep($_POST['location']));

// INSERT THE DATA 
$query = "INSERT INTO user ( name, location )
              VALUES ( '{$name}','{$location}' )";
        // Confirm if the query is successful.
        $result = mysql_query($query, $connection);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:38:12.107

“完成”并不意味着“成功”。而不是 done:，使用它来查看它是否成功完成：

```
success: function(data)
    {
       alert(data);
    },
error:function (xhr, ajaxOptions, thrownError){
        alert("Error Status: " + xhr.status + " Thrown Errors: "+thrownError);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:39:49.360

所有这一切

```
.done(function( msg ) {
     alert( "Data was saved: " + msg );
}); 
```

告诉你的是ajax请求已经完成。你可能需要看看`.success`。此外，您的代码没有显示这一点，所以我假设它没有这样做，而是为了让`msg`您`php`需要任何东西来实际返回一些东西。（`PHP`人们帮我解决这个问题，我是一个`.Net`帮助解决这个问题的人`JS`：））

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T13:40:06.777

这是一个简单的错误。`submit`您在更新数据库之前检查它的存在时发布到 process.php 时离开了

```
$('#button').click(function(){
    saveData();
});

function saveData(){  
$.ajax({
       type: "POST",
   url: "process.php",
   data: { name: "John", location: "Boston",submit:"submit" }
    }).done(function( msg ) {
 alert( "Data was saved: " + msg );
    });
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-14T13:41:50.407

由于您不是通过传统表单提交，而是使用 ajax，我怀疑提交不是帖子的一部分。通过在您的代码中添加以下 else 子句来检查这一点。如果您正在点击该 die 语句，则删除 if 测试

```
if (isset($_POST['submit'])) { // Form has been submitted.
    $name = trim(mysql_prep($_POST['name']));
$location = trim(mysql_prep($_POST['location']));

// INSERT THE DATA 
$query = "INSERT INTO user ( name, location )
              VALUES ( '{$name}','{$location}' )";
        // Confirm if the query is successful.
        $result = mysql_query($query, $connection);
} else {
  die("$_POST['submit'] didn't exist");
} 
```

# hibernate - 通过提供整个对象来删除记录的命名查询

> ID：10584372
> 
> 赞同：4
> 
> 时间：2012-05-14T13:34:29.033
> 
> 标签：hibernate, jpa

嗨，我想通过提供其 entityClass SptTutorials 的对象来从表 spt_tutorials 中删除一条记录。我正在编写这样的命名查询。

```
@NamedQuery(name = "SptTutorials.deleteVideo", query = "DELETE s FROM SptTutorials s WHERE s.SptTutorials = :SptTutorials")}) 
```

其中 SptTutorials 是实体类，我通过 WHERE 子句传递的参数是一个 SptTutorials 对象。此查询是否正确。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:09:59.613

由于“SptTutorials”**不是**SptTutorials 中的字段，因此请修复您的查询。“s.SptTutorials”表示对象“s”（SptTutorials 类型）的字段“SptTutorials”。也许

```
DELETE FROM SptTutorials s WHERE s = :param 
```

或者

```
DELETE FROM SptTutorials s WHERE s.id = :id 
```

其中“id”是要删除的 SptTutorials 对象的标识（字段）。所有这些都可以在快速阅读 JPA 规范或许多在线 JPA 文档中看到

# ios - iOS 中的单例

> ID：10584376
> 
> 赞同：1
> 
> 时间：2012-05-14T13:34:46.727
> 
> 标签：ios, singleton

我试图了解为什么在重复调用 sharedInstance 时 dinpatch_once_t 和 _sharedObject 没有分别设置为 0 和 nil 的原因。在我看来，这是编码的方式，局部变量将被重新初始化，因为您可以重置静态值，对吧？我在这里不了解 ARC 或 iOS 内存管理的哪些基础知识？

```
+ (id)sharedInstance
{
// structure used to test whether the block has completed or not
static dispatch_once_t p = 0;

// initialize sharedObject as nil (first call only)
__strong static id _sharedObject = nil;

// executes a block object once and only once for the lifetime of an application
dispatch_once(&p, ^{
    _sharedObject = [[self alloc] init];
});

// returns the same object each time
return _sharedObject;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T13:40:58.980

它实际上是 C 的东西，而不是 ARC 或 iOS。它是一个“内部静态变量”（又名局部静态变量），它的声明只处理一次。它具有该功能的本地范围，但使用寿命更长。

# c++ - CORBA C++：未定义对“CosNaming::NamingContext::_narrow(CORBA::Object*)”的引用

> ID：10584377
> 
> 赞同：2
> 
> 时间：2012-05-14T13:34:50.417
> 
> 标签：c++, corba

我得到以下错误：

```
'undefined reference to `CosNaming::NamingContext::_narrow(CORBA::Object*)' 
```

这里是注册服务器的函数：

```
void registerServer(CORBA::ORB_var obj){

CORBA::Object_var nsobj = obj->resolve_initial_references("NameService");
CosNaming::NamingContext_var nc = CosNaming::NamingContext::_narrow (nsobj);

if (CORBA::is_nil (nc)) {
    cerr << "Fehler: Konnte Naming Service nicht erreichen!" << endl;
    exit (1);
}

// Naming Service fuer unser Konto einrichten
CosNaming::Name name; 
name.length (1);
name[0].id = CORBA::string_dup ("VMS");
name[0].kind = CORBA::string_dup ("");
name[1].id = CORBA::string_dup("VMS_Context");
name[1].kind = CORBA::string_dup("");

cout << "VMS wird an Naming Service gebunden ... " << flush;
try{
 CosNaming::NamingContext_var namingContext = nc->bind_new_context(name);
}
catch(CosNaming::NamingContext::AlreadyBound_catch &ex){
    //darf ignoriert werden
}
cout << "done." << endl; 
```

}

这里主要的funcitoncall：

```
CORBA::ORB_var orb = CORBA::ORB_init(argc, argv, "omniORB3");

  CORBA::Object_var poaobj = orb->resolve_initial_references("RootPOA");

  PortableServer::POA_var poa = PortableServer::POA::_narrow( poaobj);
  PortableServer::POAManager_var mgr = poa->the_POAManager();

  //My Object

  VMSRepository_i* myVMSRepository = new VMSRepository_i (100, 10);

  PortableServer::ObjectId_var oid = poa->activate_object(myVMSRepository);

  CORBA::Object_var ref = poa->id_to_reference(oid.in());

   registerServer(orb); 
```

故障是由以下原因引起的：

```
CosNaming::NamingContext_var nc = CosNaming::NamingContext::_narrow (nsobj); 
```

# c# - 如何在没有启动 Activity 的情况下初始化 MvvmCross 框架？

> ID：10584385
> 
> 赞同：3
> 
> 时间：2012-05-14T13:35:15.150
> 
> 标签：c#, xamarin.android, mvvmcross

在我的应用程序中，我正在创建一个广播接收器，它将监听网络变化。在 OnReceive 中，它会检查设备是否刚刚连接到 WiFi，然后开始在后台上传。不会显示任何活动，所以我需要做什么才能在没有启动活动的情况下初始化框架？我不需要框架的任何页面导航部分，因此精简的初始化将是最佳的。

```
 private override void OnReceive(Context context, Intent intent)
    {
        bool isWifiConnected = false;
        bool isMobileConnected = false;

        if (intent.Action.Equals(ConnectivityManager.ConnectivityAction))
        {
            NetworkInfo networkInfo = (NetworkInfo)intent.GetParcelableExtra(ConnectivityManager.ExtraNetworkInfo);

            if (networkInfo.IsConnected)
            {
                if (networkInfo.Type == (int)ConnectivityType.Wifi)
                {
                    isWifiConnected = true;
                }
                if (networkInfo.Type == (int)ConnectivityType.Mobile)
                {
                    isMobileConnected = true;
                }
            }
        }

        if (isWifiConnected)
        {
            StartUp(); //What do I put in this private method?
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T19:21:54.693

我现在已经向 GitHub 推送了一些更改，希望这些更改能够让您使用其 BroadcastReceiver 创建您的应用程序。

使用这些修改，您现在可以使用以下代码从任何应用程序组件（Activity、BroadcastReceiver、Service 或 ContentProvider）初始化核心应用程序：

```
var setup = MvxAndroidSetupSingleton.GetOrCreateSetup(this.ApplicationContext);
setup.EnsureInitialized(this.GetType()); 
```

这些更改应该使 MvvmCross 应用程序能够在“Intent.ActionMain”场景以及以下情况下启动：

*   当应用程序清单中的辅助意图是请求时
*   当请求 Service、BroadcastReceiver 或 ContentProvider 组件时
*   当请求重新启动时，因为 Android 操作系统之前已将应用程序从内存中清除，但用户现在已请求重新启动应用程序（有点像 WP7 中墓碑后的水合作用）

* * *

这些变化的更详细的解释是[http://slodge.blogspot.co.uk/2012/05/android-application-initialization-and.html](http://slodge.blogspot.co.uk/2012/05/android-application-initialization-and.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:41:49.653

**更新**

我留下这个答案只是因为它很好地记录了我们的谈话以及我们如何达成目前的理解。我的另一个答案提供（我希望）一个解决方案......

* * *

老实说，听起来你描述的这个特定应用程序或部分不需要 MVVM 框架？

我觉得这可能被构建为“原始 MonoDroid”？也许您甚至可以将其作为 Android 服务来实现？

在这种情况下，您希望从框架中得到什么？- 例如，它只是一个 IoC 容器吗？在这种情况下，您可以自己初始化，而不必担心 MVvvm 或者您还在寻找更多的东西吗？

* * *

如果您确实想要启动一个最小的框架，那么一个选择可能是查看 SimpleBinding 示例 - 例如[https://github.com/slodge/MvvmCross/tree/master/Sample%20-%20SimpleDialogBinding/SimpleBinding /SimpleDroid](https://github.com/slodge/MvvmCross/tree/master/Sample%20-%20SimpleDialogBinding/SimpleBinding/SimpleDroid)

这些“简单”应用程序使用 MvxSimpleAndroidBindingSetup 设置例程，它不会创建完整的“应用程序” - 我不确定这是否正是您要找的？

在这些类型的应用程序中您可能会发现的一个问题是，如果您使用任何期望以单元线程方式使用的代码 - 当您开始构建 View 和 ViewModel 感知代码时，一些代码期望在那里并不少见成为可用的 UI 线程。您应该能够解决这个问题 - 但在设计和调试代码时要注意它。

* * *

作为另一种选择，考虑在您的 MonoDroid 项目中子类化 Android.App.Application - [http://developer.android.com/reference/android/app/Application.html](http://developer.android.com/reference/android/app/Application.html)

然后，此 Android 应用程序可以在其内部启动设置的第一阶段`OnCreate`- 这应该是广播接收器工作所需的最低要求 - 修改后的 SplashActivity 然后可以启动第二阶段 - 完整应用程序所需的其余代码去工作。

您可能会发现您需要调整您`Setup.cs`和您的 MvxApplication 应用程序代码，并且您可能需要为您的闪屏 Activity 使用不同的基类 - 而不是[MvxBaseSplashScreenActivity.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Android/Views/MvxBaseSplashScreenActivity.cs)。重要的是您的应用程序中的某处：

*   创建一个 Setup 实例
*   在该实例上调用必要的 Initialize 方法
*   `IMvxStartNavigation.Start()`当需要“正常应用”操作时触发
*   允许广播接收器在需要此“其他”操作时进行操作
*   允许两个操作位于相同的内存空间中 - 例如，如果在“普通应用程序”运行时调用广播接收器会发生什么？

现在再次查看 Android 文档，我认为我们需要更改一些 mvx 以在未来更好地支持这种情况 - 并更好地应对再水化场景 - 在 android 相当于墓碑之后对活动进行再水化。

* * *

**我认为这注定是为了[https://github.com/slodge/MvvmCross/issues/new](https://github.com/slodge/MvvmCross/issues/new)** - 如果你能提供一个简单的演示应用程序，那就太好了......

# c# - CheckBox_Checked 事件

> ID：10584387
> 
> 赞同：0
> 
> 时间：2012-05-14T13:35:23.180
> 
> 标签：c#, silverlight, checkbox, counter

我在 Silverlight 应用程序中有八个复选框，每次加载包含它们的窗口时都会检查它们，这会在没有任何用户输入的情况下不断检查和取消选中这些框。

例如，有没有办法和一个计数器来确保每次加载窗口时不使用 CheckBox_Checked 事件？

就像是-

```
private void checkBox1_Checked(object sender, RoutedEventArgs e)
{
    int counter = 0
    if(counter == 1)
    {
        //do nothing
    }
    else
    {
        //do something
    }
    counter1 = 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:40:27.503

将设置事件的逻辑移至 Form_Load 的 Silverlight 等效项。

# matlab - Matlab中eps的实际值是多少？

> ID：10584390
> 
> 赞同：1
> 
> 时间：2012-05-14T13:35:30.767
> 
> 标签：matlab

根据 MA​​TLAB 文档， 的值`eps`应该是`2^-52`。

“eps 返回从 1.0 到下一个最大双精度数的距离，即 eps = 2^(-52)。” （来自[http://www.mathworks.com/help/techdoc/ref/eps.html](http://www.mathworks.com/help/techdoc/ref/eps.html)）。

但是，当我`eps`在 MATLAB 的命令窗口中键入时，我得到`eps = 2.2204e-016`.

我很困惑。*的*实际值是多少`eps`？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T13:39:48.907

错误，在我的机器上 Matlab 给出了`2^(-52) == 2.2204e-16`. 我在你的问题中遗漏了一些明显的东西吗？

# php - 处理php（爆炸）

> ID：10584392
> 
> 赞同：0
> 
> 时间：2012-05-14T13:35:43.560
> 
> 标签：php, mysql

我正在创建一个具有 4 列的数据库，“类型”、“兼容”、“StockLevel”、“成本”。

类型可能是“电池”，兼容字段是与此电池一起使用的设备的 ID。例如“1、4、9”。

我需要我的 PHP 做的是在数据库中查询“兼容”行中包含 $_POST[compatible] 的所有“类型”。当然这不像 IF X = X 那样简单，因为我们首先需要 (php) 分解 Compatible 字段。

我的头很痛，我仍在努力寻找解决方案，但我将粘贴我的代码并希望你们中的某个人能提供一些帮助。

```
IF ($_POST["printer"]) {

    $printerinfo_query = mysql_query("SELECT * FROM printers WHERE ID LIKE '$_POST[printer]'");
    $printerinfo_result = mysql_fetch_assoc($printerinfo_query);

    echo ("<H5>".$printerinfo_result["Model"]."</H5>");
    echo "".$printerinfo_result["Description"]."";

    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    $cartridge_query = mysql_query("SELECT * FROM cartridges");
    $cartridge_result = mysql_fetch_assoc($cartridge_query);

    $explode = $cartridge_result["Compatible"];
    $explodedata = explode(", ", $explode);
    $explode_count = count($explodedata);
    $explode_count_dec = count($explodedata);
    $explode_number = "0"; // Re-creates $explodedata[0], [1], [2] etc.. using $explodedata[$explode_number] in the loop!

    echo ("<P>Select a cartridge type &mdash;</P>");

    echo "<form action='index.php?page=printeradv' method='POST'>";

      while ($explode_count_dec > "0"):

        $while_query = mysql_query("SELECT * FROM cartridges WHERE ID LIKE '$explodedata[$explode_number]'");
        $while_result = mysql_fetch_assoc($while_query);

        echo "<input type='radio' value='".$explodedata[$explode_number]."' name='cartridge' />".$while_result["Type"]." <BR /> ";

        ++$explode_number;
        --$explode_count_dec;
      endwhile;

    echo "<input type='submit' value='Select model' />";
    echo "</form>";

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:42:39.640

您不需要使用`explode()`，我不知道您为什么在实际不使用通配符时使用 LIKE 。

您可以直接使用 搜索`$cartridge_result['Compatible']`，如下所示：

```
... WHERE ID IN('.$cartridge_result['Compatible'].')' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:51:28.067

我认为您需要添加一个额外的关系表来将您的电池与设备相关联。这是一个非常简单的表：

> 关系ID | 电池ID | 设备ID

这使您可以进行简单的查询以获取所有兼容的电池*或*设备。这是管理诸如此类的多对多关系的标准做法。最终结果是您可以运行单个查询来确定兼容性，并且之后在 PHP 中的处理是最小的。

# delphi - 在运行时更改模态表单的位置

> ID：10584393
> 
> 赞同：0
> 
> 时间：2012-05-14T13:35:44.927
> 
> 标签：delphi, delphi-2007

我的 Delphi 2007 应用程序中有一个模态表单。我已经在表单上应用了 MinHeight、MaxHeight、MinWidth 和 MaxWidth 约束。

如果屏幕分辨率低于最小/最大约束，我想根据屏幕分辨率重新调整大小并重新定位表单。

我在*OnCreate*事件处理函数中编写了以下代码来处理屏幕分辨率。

```
procedure TfrmMyForm.FormCreate(Sender: TObject);
var      
  WorkArea: TRect;
  iTitleHeight: Integer;
begin
  inherited;
  //-------------------------------------------------------------------
  //Adjust Height/Width of the form if min/max values 
  //don't fall under the current resolution.
  iTitleHeight := GetSystemMetrics(SM_CYCAPTION); //Height of titlebar
  WorkArea := Screen.WorkAreaRect;

  if(Self.Constraints.MinWidth > WorkArea.BottomRight.X) then
  begin
    if(Self.Constraints.MaxWidth > WorkArea.BottomRight.X) then
    begin
      Self.Constraints.MinWidth := WorkArea.BottomRight.X;
      Self.Constraints.MaxWidth := WorkArea.BottomRight.X;
      Self.Position := poDesigned;
      SetBounds(0,0,WorkArea.BottomRight.X, WorkArea.BottomRight.Y - 5);
    end
    else
    begin
      Self.Constraints.MinWidth := WorkArea.BottomRight.X;
    end;
  end;
  if(Self.Constraints.MinHeight > WorkArea.BottomRight.Y) then
  begin
    if(Self.Constraints.MaxHeight > WorkArea.BottomRight.Y) then
    begin
      Self.Constraints.MinHeight := WorkArea.BottomRight.Y - iTitleHeight;
      Self.Constraints.MaxHeight := WorkArea.BottomRight.Y;
      Self.Position := poDesigned;
      SetBounds(0,0,WorkArea.BottomRight.X, WorkArea.BottomRight.Y -  5);
    end
    else
    begin
      Self.Constraints.MinHeight := WorkArea.BottomRight.Y;
    end;
  end;
//-------------------------------------------------------------------
end; 
```

在设计时，我将*Position*属性设置如下

```
Position := poCentreScreen 
```

现在，当屏幕分辨率较低（如 1024x768）并且最小和最大高度/宽度约束值高于此分辨率时，我面临三个问题。

我将*Position*属性更改为*poDesigned*，否则表单不会移动到我想要的位置。

当我在具有双显示器的系统上运行我的应用程序时，它的行为异常。

我还在表单的系统菜单中添加了一个自定义菜单项，当我在*OnCreate函数中将**Position*属性更改为*poDesigned*时，它会重置系统菜单并删除自定义菜单项。

 **有没有办法在不修改Position*属性的情况下重新调整表单的大小和位置？

感谢期待。*

# c - C位布尔逻辑

> ID：10584394
> 
> 赞同：2
> 
> 时间：2012-05-14T13:35:49.130
> 
> 标签：c, boolean-logic

我有以下 C 语句：

```
int res = x & (x ^ y); 
```

有没有办法做同样的事情，但每次只使用`x`一次`y`？

例如：

```
x | (~x & y) == x | y 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T13:38:54.363

是的，通过扩展 xor ( `a ^ b == (a & ~b) | (~a & b)`)，然后简化结果，可以得到：

```
res = x & ~y; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T13:39:12.620

`x & (x ^ y)`设置已设置`x`和设置的位，`x^y`例如未设置的位`y`。

所以你可以这样做：

```
int res = x & ~y; 
```

# iphone - 如何将 NSData 编码为 base64？(iPhone/iPad)

> ID：10584396
> 
> 赞同：0
> 
> 时间：2012-05-14T13:35:50.950
> 
> 标签：iphone, uiimage, base64, nsdata

我正在尝试将 UIImage 添加到`HTML`电子邮件中，但是我遇到了问题。我环顾了许多其他帖子，他们都说我需要将我的转换`NSData`为`base64`，但是他们都建议的方法似乎不再存在（除非我遗漏了什么？！）。

这是我到目前为止的代码：

```
UIImage *mapImage = [mapViewController convertMapToImage];
NSData *imageData = [NSData dataWithData:UIImagePNGRepresentation(mapImage)];
NSString *base64String = // [imageData base64EncodedString];   --- this method isn't recognised 
```

请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:47:15.563

```
+ (NSString*)base64forData:(NSData*)theData {
const uint8_t* input = (const uint8_t*)[theData bytes];
NSInteger length = [theData length];

static char table[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";

NSMutableData* data = [NSMutableData dataWithLength:((length + 2) / 3) * 4];
uint8_t* output = (uint8_t*)data.mutableBytes;

NSInteger i;
for (i=0; i < length; i += 3) {
    NSInteger value = 0;
    NSInteger j;
    for (j = i; j < (i + 3); j++) {
        value <<= 8;

        if (j < length) {
            value |= (0xFF & input[j]);
        }
    }

    NSInteger theIndex = (i / 3) * 4;
    output[theIndex + 0] =                    table[(value >> 18) & 0x3F];
    output[theIndex + 1] =                    table[(value >> 12) & 0x3F];
    output[theIndex + 2] = (i + 1) < length ? table[(value >> 6)  & 0x3F] : '=';
    output[theIndex + 3] = (i + 2) < length ? table[(value >> 0)  & 0x3F] : '=';
}

return [[[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding] autorelease];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:40:03.057

您尝试使用的方法不附带默认框架。您可以将[NSData 类别](https://github.com/yllan/FoundationAddition/)添加到您的项目中。

# sql - 将此 SQL Count 语句转换为 LINQ 语句

> ID：10584398
> 
> 赞同：1
> 
> 时间：2012-05-14T13:36:08.140
> 
> 标签：sql, linq, sql-to-linq-conversion

如果我使用 Count，这条 SQL 语句将如何与 LINQ 一起使用？

```
select count(*) from GoalCard
where GoalCard.Completed_Date is not null 
```

提前致谢！

更新：

我会删除“过于本地化”的投票，因为有些人使用谷歌来查找如何在 LINQ 语句中使用 count 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:38:46.350

用这个：

```
context.GoalCards.Count(gc => gc.Completed_Data != null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:38:41.747

数数：

```
context.GoalCards.Count(x => x.Completed_Date.HasVale) 
```

# c++ - std::vector 使用 g++ 调试和发布构建

> ID：10584402
> 
> 赞同：3
> 
> 时间：2012-05-14T13:36:20.213
> 
> 标签：c++, debugging, stl, g++

> **可能重复：**
> [GCC STL 绑定检查](https://stackoverflow.com/questions/5594686/gcc-stl-bound-checking)

在 g++ STL 中是否有类似 std:vector 的自动调试版本，如果没有，我该如何实现？

我想要的是在我的 g++ 调用中指定一个调试参数，例如：

```
g++ -D DEBUG_ main.cpp 
```

定义此参数后，我希望我的所有 std::vector 在访问元素时检查它们的边界，就像使用 vector::at() 时一样。

当参数被省略时，我希望所有向量的行为就像使用普通的 [] 运算符一样，这​​意味着边界检查不会“浪费”任何性能。

我听说 VC++ 做了这样的事情。所以我的问题是如何使用 g++ 来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T13:38:19.970

你想要的标志是`-D_GLIBCXX_DEBUG`

libstdc++ 的更多调试选项可以在以下位置找到：

[http://gcc.gnu.org/onlinedocs/libstdc++/manual/debug_mode_using.html#debug_mode.using.mode](http://gcc.gnu.org/onlinedocs/libstdc++/manual/debug_mode_using.html#debug_mode.using.mode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:40:07.457

在调试模式下，您可以进行额外的断言和检查，但使用`at()`or`[]`它始终在您身边。

`at()`- 抛出 out_of_bounds 异常，`[]`- 不要

# mongodb - 为什么 MongoDB 的 map/reduce 有时会返回一个对象作为 reduce 函数的一部分？

> ID：10584403
> 
> 赞同：1
> 
> 时间：2012-05-14T13:36:23.447
> 
> 标签：mongodb, mapreduce

所以我正在使用 mongo 进行 mapreducing，有时但并非总是如此，reduce 数组的第一个元素是一个 bson 对象，其中包含另一个 reduce 数组。我处理它的方式是将该数组与外部数组结果相结合。

我不明白为什么会这样，也找不到任何文档。谁能指出我正确的方向，以便我可以确定我正在正确处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:49:07.620

[http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-ReduceFunction](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-ReduceFunction) 有你的答案（但你必须仔细阅读）。请参阅引用的部分：

“请注意，结果文档与 map 函数发出的文档具有相同的结构。这很重要，因为当 reduce 函数针对给定键运行时，不能保证处理该键（或用户名）的每个值. 事实上，reduce 函数可能要运行不止一次。

基本上，reduce 不会在每个“键”上“一次全部”运行，而是可以“增量”调用以处理已处理结果的新结果。

# android - 如何在android中计算多个地理坐标内的面积

> ID：10584411
> 
> 赞同：2
> 
> 时间：2012-05-14T13:36:53.327
> 
> 标签：android

在我的应用程序中，我正在捕获所有选定的位置 gps 坐标，并且我在每个选定的坐标之间画线。

我已经知道如何计算两点之间的距离

但在我的应用程序中，用户可以选择任意数量的位置，所以我想计算所有选定坐标之间的区域

谁能告诉我如何计算n个坐标内的面积。

还请让我如何将所得面积转换为英亩。

因为从两天开始我正在寻找很多来实现这一目标但没有成功所以请帮助我

# visual-studio-2010 - Coderush xpress (11.2.11) not working in VS2010

> ID：10584414
> 
> 赞同：0
> 
> 时间：2012-05-14T13:37:01.463
> 
> 标签：visual-studio-2010, coderush-xpress

I've just upgraded CodeRush Xpress from 10.1.4 to 11.2.11 (the latest version).

Although the DexExpress menu has been restored, and I can still get to the options screen (CTRL + Shift + Alt + O), but none of the other shortcuts (e.g. CTRL + ') do anything. In the options screens, the the Refactor short is set and is enabled.

There also used to be a 'Refactor!' context menu that no longer appears.

I've enabled the message log, but it doesn't flinch when I try any key combo - it's doing absolutely nothing.

I've also tried repairing the installation but no joy... and have disabled all other VS extensions.

Am I missing something? Has anyone got this working with VS2010 (v10.0.040219.1 SP1Rel)?

I've also tried posting on the DX forums but they are out of action at the moment.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:04:48.257

I think that the DevExpress Support Team is better equipped to resolve such issues. DX forums are now available but they are read-only. Use the new [Support Center](http://www.devexpress.com/Support/Center/) instead. In addition, support [@] devexpress.com is a fast way to get help from the official DevExpress support.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T09:11:12.150

My contact with DevExpress is detailed in [this thread](http://www.devexpress.com/Support/Center/Question/Details/Q400881).

I now have it working on my main PC, and working substantially on my second PC. It's not 100% certain what the cause was - but certainly the installer I downloaded from the main site did not work, whereas a [different installer](http://downloads.devexpress.com/Share/IDE/CRX/CodeRushXpress-11.2.11.exe) that they provided did work. [I'm not sure how long this installer will remain]

# cakephp - 如何对 query() cakephp 进行分页？

> ID：10584415
> 
> 赞同：0
> 
> 时间：2012-05-14T13:37:01.750
> 
> 标签：cakephp

```
 $v = array(1,11.38,15.8);
    $sortByPrice = $this->Product->query
    (
    "SELECT *,
    CASE `Product`.`currency` 
        WHEN '1' THEN $v[0]
        WHEN '2' THEN $v[1]
        WHEN '3' THEN $v[2]
    END AS 'ratio'          
    FROM `products` AS `Product` 
        LEFT JOIN `marks` AS `Mark` ON (`mark_id` = `Mark`.`id`)
        LEFT JOIN `categories` AS `Category` ON (`category_id` = `Category`.`id`)
        RIGHT JOIN `photos` AS `Photo` ON (`Photo`.`product_id` = `Product`.`id`)
    ORDER BY price*ratio DESC"
    ); 
```

如何对这个查询进行分页？我在 book.cake 上读过，但解释得不是很好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-26T20:18:18.127

在这种情况下，如果您的当前页面对应于 Product 而不是在 cakephp 3 中看起来像这样：

```
$this->paginate($sortByPrice);
$this->set(compact('$sortByPrice')); 
```

正如前面的评论所说，最好使用 cakephp 的内置查询功能

# javafx - JavaFX - 显示图片列表

> ID：10584421
> 
> 赞同：0
> 
> 时间：2012-05-14T13:37:16.117
> 
> 标签：javafx, javafx-2

我想在我的视图中显示图片列表，如果我添加新照片，列表应该刷新。我查看了可绑定的 ListView，但我想知道它是否是我需要显示图片并且我不想要滚动的组件，而是有一些指向下一页和上一页的链接。我正在寻找一些做过此类工作的人的建议，JavaFx 中的哪个组件适合我的工作。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:33:13.137

1.  `Button`您可以通过将两个自定义的 s 和添加`ImageView`到场景中来创建自己的控件。

2.  或者查看具有类似功能的“展示架”示例（将链接复制粘贴到浏览器，因为 StackOverflow 不理解链接中的空格）：`http://download.oracle.com/otndocs/products/javafx/2.1/samples/Ensemble/index.html#SAMPLES/Graphics/Display Shelf`

3.  或者查看 JavaFX 2.2 的开发版本，它具有新的`Pagination`控件，可以完全满足您的需要，甚至支持手势来更改页面：[2.2 开发预览](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)

![在此处输入图像描述](../Images/d75313fa73011c93838edc1a2f8c017c.png)

# html - 是否可以使用 CSS 定位 HTML（文本）？- 它显示为（文本）作为 ID

> ID：10584423
> 
> 赞同：1
> 
> 时间：2012-05-14T13:37:23.543
> 
> 标签：html, css, wordpress

我在将 twitter 嵌入到我从 HTML 5 转换的 wordpress 运行网站时遇到问题。

我遇到的问题是推文不在我的自定义字体中......

![在此处输入图像描述](../Images/56fba4f8ee12df9a203d68b3a5b9b852.png)

这是我无法使用任何 css 定位的 HTML 代码，我正在为网站上的所有文本使用通过 css 导入的自定义字体。

```
<article id="twitter">
    <h3>Twitter:</h3>
        Test tweet to get embedded code. 
            <a href="http://twitter.com/Max__Chandler/statuses/202020801917095939" class="aktt_tweet_time">28 mins ago
    </a>
</article> 
```

取自 Index.php 的 PHP 代码

```
<article id="twitter">
    <h3>Twitter:</h3><?php aktt_latest_tweet(); ?>
</article> 
```

chrome中显示的css ID是

```
article#twitter (text) 
```

我尝试定位：#twitter、html、正文、文本、（文本）、“”。

有人启发我如何让这段文本以我选择的字体显示 - 我只想使用 CSS 来保持简单！

网址：

[http://www.msc-media.co.uk](http://www.msc-media.co.uk)

这是使用 CSS 导入字体的方式

```
 @font-face {
        font-family: 'JosefinSansStdLight';
        src: url('/wp-content/themes/1/JosefinSansStd-Light-webfont.eot');
        src: url('/wp-content/themes/1/JosefinSansStd-Light-webfont.eot?#iefix') format('embedded-opentype'),
             url('/wp-content/themes/1/JosefinSansStd-Light-webfont.woff') format('woff'),
             url('/wp-content/themes/1/JosefinSansStd-Light-webfont.ttf') format('truetype'),
             url('/wp-content/themes/1/JosefinSansStd-Light-webfont.svg#JosefinSansStdLight') format('svg');
        font-weight: normal;
        font-style: normal;

    }

    p, a, h1, h2, h3, h4, h5, h6{
        font:'JosefinSansStdLight';
        letter-spacing: 0.1em;
    }
    a{font:1.25em 'JosefinSansStdLight';}
    p{font:1.2em 'JosefinSansStdLight';}
    h1{font:3em 'JosefinSansStdLight';}
    h2{font:2em 'JosefinSansStdLight';}
    h3{font:1.25em 'JosefinSansStdLight';}
    h4{font:18px/27px 'JosefinSansStdLight';}
    h5{font:18px/27px 'JosefinSansStdLight';}
    h6{font:18px/27px 'JosefinSansStdLight';} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:44:09.130

尝试`#twitter {font-family: your fonts}`如果它不起作用，那么您的字体或嵌入/注册它的方式有问题。
要测试它，请尝试更改`background-color`字体是否有效，这是您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:14:45.490

CSS“font”属性要求“font-size”和“font-family”值都有效。您的 CSS 文件中有几个地方，您有以下内容：

```
font:'JosefinSansStdLight'; 
```

这不是有效的 CSS，因为它不包含“font-size”值。您应该像为 a、p、h1、h2、h3 等所做的那样包含大小：

```
a{font:1.25em 'JosefinSansStdLight';}
p{font:1.2em 'JosefinSansStdLight';}
h1{font:3em 'JosefinSansStdLight';}
h2{font:2em 'JosefinSansStdLight';}
h3{font:1.25em 'JosefinSansStdLight';}
h4{font:18px/27px 'JosefinSansStdLight';}
h5{font:18px/27px 'JosefinSansStdLight';}
h6{font:18px/27px 'JosefinSansStdLight';} 
```

或者，您可以将“font”声明更改为“font-family”声明：

```
font-family:'JosefinSansStdLight'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:04:16.653

看起来 tweat 的主体没有包含在任何段落标签中，并且显示的 css 不包括段落或标题之外的任何文本方向。

您可以尝试在 css 中为“body”元素指定字体和格式，或者将 tweat 的内容包装在一些

标签。

当您提到定位问题时，可能值得注意的是它是一个 HTML5 元素，并且目前对使用此元素识别和定位 css 的支持可能因浏览器而异。

您可以使用 html5shiv 或modernisr javascript 变通方法来支持在不受支持的浏览器中将其更改为 div。

[http://code.google.com/p/html5shiv/](http://code.google.com/p/html5shiv/)

[http://modernizr.com/](http://modernizr.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:07:02.707

我认为让它在所有浏览器上工作的最佳选择是将 twitter 内容包含在另一个 html 元素中——一个 div 或一个 span。为此，你想让你的 php 代码看起来像这样：

```
<article id="twitter">
    <h3>Twitter:</h3>
    <div class="twitter_content">
      <?php aktt_latest_tweet(); ?>
    </div>
</article> 
```

然后，您将在`.twitter_content`该类上设置 css 属性。

如果您使用 div （就像我在这里所做的那样），您可能希望这些 css 属性之一是`display:inline-block;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T14:14:27.147

@janw 和 @digitalsean 是正确的。使用`font-family: 'JosefinSansStdLight'`而不仅仅是`font: 'JosefinSansStdLight'`. 根据浏览器的不同，您可能还需要添加一个 shiv。

听起来您可能正在处理 CSS 特异性问题。CSS 代码中的其他内容比您尝试应用的声明具有更高的特异性。尝试使您的声明如下所示：

```
body article#twitter {

    font-family:'JosefinSansStdLight' !important;
    letter-spacing: 0.1em;

}

body article#twitter h3 {

    font-family:'JosefinSansStdLight' !important;
    letter-spacing: 0.1em;

} 
```

适用于我在此示例中使用您的基本结构：http: [//jsfiddle.net/jstam/Z8Fh7/](http://jsfiddle.net/jstam/Z8Fh7/)

# c# - FluentMongo LINQ：如何查询类的子列表

> ID：10584425
> 
> 赞同：2
> 
> 时间：2012-05-14T13:37:29.677
> 
> 标签：c#, linq, list, mongodb, sublist

假设我有这样的课程：

```
public class BOa
{

    public ObjectId Id { get; set; }

    public string Name { get; set; }

    public List<BOb> VisiteEffettuate = new List<BOb>();
}

public class BOvalues
{

    public DateTime Data { get; set; }
    public int Age { get; set; }
    public int Score { get; set;}

 } 
```

在 MongoDB 中，需要明确的是，我收集了许多 BOa。它们中的每一个都包含许多（...列表）BOvalues 我想知道如何使用 FluentMongo LINQ（或其他方法）获得一个 BOvalues 列表，例如，Score 大于一个值或两个值之间的 Age。

我想使用 SelectMany，但 fluentmongo 似乎不支持它。

获得此结果的最佳方法是什么？

先感谢您！

编辑：我尝试在 LINQ 上使用 QueryBuilder ......例如：

```
 var query = MongoDB.Driver.Builders.Query.ElemMatch("VisiteEffettuate", MongoDB.Driver.Builders.Query.And( 
                MongoDB.Driver.Builders.Query.GT("Age", 32),
                MongoDB.Driver.Builders.Query.EQ("Name", "xxxx")
                )
                );

        var res = pazienti.Find(query); 
```

...等等。它似乎工作。但是 QueryBuilder 并没有如此记录，并且（我不确定）不可能以编程方式创建查询（例如动态 LINQ）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:55:23.997

您可以使用 Any 运算符重写您的查询。

```
col.AsQueryable().Where(x => x.Any(y => y.Age < 40)); 
```

这现在可以在 FluentMongo 中使用。但是，由于官方驱动程序获得了 linq 支持，FluentMongo 不再是受支持的项目。

这目前在官方驱动程序中不起作用，但计划用于 1.5 版。我建议你现在坚持使用查询构建器，直到 1.5 出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:51:23.810

您可以使用现在原生支持 LINQ 查询的官方 C# 驱动程序。我用过它，效果很好。

在此处查看文档：[http ://www.mongodb.org/display/DOCS/CSharp+Driver+LINQ+Tutorial](http://www.mongodb.org/display/DOCS/CSharp+Driver+LINQ+Tutorial)

# php - mysql数据库中的格式化日期

> ID：10584428
> 
> 赞同：-1
> 
> 时间：2012-05-14T13:37:55.820
> 
> 标签：php, mysql

如何提取存储在数据库中的日期？示例此日期存储在数据库中`2012-01-02`，我想获取月份和年份。

```
year = 2012
month = 01
day = 02 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:42:16.787

```
SELECT MONTH(date_col) AS month
     , YEAR(date_col) AS YEAR
     , DAYOFMONTH(date_col) AS day
  FROM tablename 
... 
```

[`Year()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_year) [`month()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_month) [`dayofmonth()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_dayofmonth)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:42:04.533

只需将其从数据库中读取到日期对象中，然后使用日期对象方法来获取您想要的信息

# php - 可以在外部文件中执行 AJAX 执行 PHP 吗？

> ID：10584430
> 
> 赞同：0
> 
> 时间：2012-05-14T13:38:02.140
> 
> 标签：php, mysql, ajax

是否可以使用 ajax 通过链接或表单（example.php）检索外部文件（数据库），然后执行该文件中的任何 php 代码，然后将其显示给用户？

谢谢，巴特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:44:14.740

如果您要求使用 ajax 检索 php 文件并在检索后执行它，我认为答案是“否”。ajax 是客户端，php 是服务器端。但是，您可以使用 .GET 或 .POST 从 jquery 调用 php 文件，使用提供的数据对其进行处理，然后将结果返回给 ajax 函数以根据需要显示它。如果你用谷歌搜索的话，有成千上万个简单的例子。

# javascript - 有没有办法检测对象的属性何时更改？

> ID：10584433
> 
> 赞同：2
> 
> 时间：2012-05-14T13:38:13.880
> 
> 标签：javascript, oop

如何检测对象的属性是否在 Javascript 中发生了变化？我特别希望在对象的属性数量发生变化时调用一个函数（无论它是获得还是丢失属性）。我想避免使用方法并设置和更改对象的属性，因为那样会很快变得相当笨拙，而且`setInterval`显然不是一种选择。那么，这可能吗？

* * *

编辑：我正在专门寻找一种方法来通过`length`类似于 Array 对象上的属性来获取对象属性的长度。我假设每当添加或删除索引时他们都会更改长度，但显然情况并非如此。Javascript 的原始设计者是如何做到这一点的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:42:35.787

好吧，实现它的常用方法是使用 getter 和 setter 类型的函数来完成它，类似于骨干如何处理它的模型。您通过函数修改数据，然后函数在执行您想要执行的操作之前执行其他处理（如执行侦听器、检查属性等）。

```
function ListenableObject(data){

    var that = this;
    this.data = data;
    this.listeners = [];

    this.edit = function(newvalues){
        //modify data
        //execute listeners
    }

    this.addListener = function(callback){
        that.listeners.push(callback);
    }
}

var mydata = new ListenableObject({'foo':'bar'});

mydata.addListener(function(){...callback...});

mydata.edit(somedata); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:08:31.557

根据您的要求，简短的回答是不可能做您想做的事情。至少，现在还没有。您可以使用一些技术来获得相同的功能，而对代码的影响最小。这是我个人最喜欢的一个——在 SO 的某个地方发现的——如果我能找到，我会链接。

```
function myObj(){

   var _this = this;

   // onUpdate callbacks
   this.onBeforeUpdate = [];
   this.onAfterUpdate  = [];

   this.UpdateProperty = function( prop, value ){

      // execute onBeforeUpdate callbacks...  
      for ( var i = 0; i < _this.onBeforeUpdate.length; i++ )
         _this.onBeforeUpdate[i]();

      _this[prop] = value;

      // execute onAfterUpdate callbacks...
      for ( var i = 0; i < _this.onAfterUpdate.length; i++ )
         _this.onAfterUpdate[i]();
   };

} 
```

当然，通过大量使用原型分配，可以使这个示例表现得更好，但您可以看到其意图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:34:00.767

因此，总结一下我通过评论所说的一切：ES6 将提供代理，这些代理应该为“新属性”或“属性已删除”等事件启用处理程序。（不过，我并没有对此进行过多研究。）不幸的是，代理成为跨浏览器还需要数年时间。

至于`length`对象的属性，你可以为它定义一个getter函数，但这会在IE8中中断，因为IE只在IE9中实现了getter。所以，这给你留下了一个`length()`方法。所以：

```
function objectLength () {
    return Object.keys( this ).length;
} 
```

然后，确保您的对象具有此功能（作为自己的属性或继承的属性）：

```
yourObj.length = objectLength; 
```

或者

```
YourConstructor.prototype.length = objectLength; 
```

# iphone - 如何取消已经触发的非重复 NSTimer？

> ID：10584434
> 
> 赞同：0
> 
> 时间：2012-05-14T13:38:18.393
> 
> 标签：iphone, ios, nstimer, invalidation

**我想要什么**：
1）UIImageViews 中的 4 个拼图图像，我可以四处移动 2）在解决拼图后我想显示 2 张图像而不是拼图：第一个是在拼图解决后，第二个是在第一个图像后 2 秒...

**我所拥有的：**
1）如果你一个接一个地快速解决一个难题，你可能会陷入 NSTimer 间隔，这会使这两个图像交换得太快，比如在 0.1 秒而不是 2.0 秒之后

有什么办法可以解决 NSTimer，不干扰已经被解雇的人吗？

**解决方案（？）：**我正在考虑阻止交互，因此会出现第二张图像，但这似乎是一个糟糕的解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:44:04.383

您应该保留对此计时器的引用（作为属性或 iVar）。

然后`[myTimer invalidate]; myTimer = nil;`在您想取消它时简单地调用它。

编辑：

如果您不保留对计时器的引用（如果您是在代码块中从头开始创建它），那么总是存在创建多个实例的危险......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T04:44:17.533

写setter方法，像这样。每当您需要取消计时器时

```
self.myTimer = nil;

- (void)setMyTimer:(NSTimer *)inTimer
{
   if (inTimer != mMyTimer)
  {
    [mMyTimer invalidate];
    [mMyTimer release];
    mMyTimer = [inTimer retain];
  }
} 
```

希望这可能对你有用。

# javascript - 从字符串中删除点符号

> ID：10584438
> 
> 赞同：43
> 
> 时间：2012-05-14T13:38:25.490
> 
> 标签：javascript

> **可能重复：**
> [如何在 JavaScript 中替换字符串中的所有点](https://stackoverflow.com/questions/2390789/how-to-replace-all-points-in-a-string-in-javascript)

我正在尝试从我的字符串中删除 '.'(dot) 符号。我使用的代码是

```
checkedNew = checked.replace('.', ""); 
```

Bt 当我尝试提醒checkedNew 的值时，例如如果checkedNew 具有原始值US Marshal，我得到的输出是US。元帅，它不会删除该字符串中的第二个点。如何删除所有点符号？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-05-14T13:39:40.963

拆分所有`.`'s 上的字符串，然后用空格再次加入，如下所示：

```
checkedNew = checked.split('.').join(""); 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-05-14T13:40:50.233

您需要执行全局替换，因为默认情况下`replace`只执行一次替换。理论上，您可以将全局指令作为第三个参数传递，但这有一些兼容性问题。请改用正则表达式。

```
checkedNew = checked.replace(/\./g, ""); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-05-14T13:41:34.457

replace 只会替换第一次出现。要解决此问题，请使用打开全局选项的正则表达式：

```
checked.replace(/\./g, ''); 
```

# jquery - Google.code Gravity Script(Mr.Doob) 在 mousemove 上触发/激活，而不是在 (document).ready 时触发/激活

> ID：10584449
> 
> 赞同：2
> 
> 时间：2012-05-14T13:38:50.997
> 
> 标签：jquery, google-api, box2d, gravity

我目前正在使用[此处](http://code.google.com/p/gravityscript/)找到的重力脚本在本地 atm 开发的网页上创建重力效果。

我的问题是重力效果的激活似乎是在鼠标移动上，而我需要它在文档准备好时才触发。google.code 页面要求您简单地链接到 head 或 body 中的gravityscript.js 文件，一旦加载，一旦鼠标移到我假设`<body>`标签的网页上，重力效果就会触发。

这种效果的一个例子可以在[这里](http://www.cs.umb.edu/~joecohen/pwn/demos/wordpress.htm)看到。

脚本的上传者确实提供了这段代码（如下），它应该在点击时激活重力效果，但它似乎所做的只是在点击时加载文件然后你仍然需要在点击后移动鼠标才能激活重力效应。我怎样才能使这种效果在页面加载时真正自动化？

```
$('body').click(function() {
    var script = document.createElement("script");
    script.src="http://gravityscript.googlecode.com/svn/trunk/gravityscript.js";
    document.body.appendChild(script);void(0);
}); 
```

可以看到实际的gravityScript 脚本[here](http://gravityscript.googlecode.com/svn/trunk/gravityscript.js)我查看了它以了解实际触发脚本的原因，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T01:57:31.993

我添加了另一个脚本来执行此操作。只需使用这个新脚本。

[http://gravityscript.googlecode.com/svn/trunk/gravityscript-autorun.js](http://gravityscript.googlecode.com/svn/trunk/gravityscript-autorun.js)

此外，GravityScript 不是 Doob 先生制作的。

他制作了 Google Gravity，它是 GravityScript 的基础。

# java - 如何初始化从内部类继承的类？

> ID：10584452
> 
> 赞同：0
> 
> 时间：2012-05-14T13:38:58.013
> 
> 标签：java, constructor, inner-classes

如何初始化从内部类继承的类？为什么 foo1.this() 不会编译？

```
class Foo1 {
    class Inner {
    }
}

class Foo2 extends Foo1.Inner {
    //Foo2(Foo1 foo1) {foo1.this();} //won't compile
    Foo2(Foo1 foo1) {foo1.super();}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:54:41.147

如果您将内部类声明为静态，则可以这样做，否则您需要外部类 Foo1 的实例。

```
class Foo1 {
    static class Inner {
    }
} 
```

但是您的直接问题似乎很奇怪：

```
foo1.this(); //won't compile 
```

你想在这里做什么？调用一个看起来像“this”的方法，但也许希望使用无参数构造函数？如果是这样就使用`this()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:19:38.977

我不确定我理解`foo1.this();`应该做什么。也许您正在尝试调用`Inner`. 由于`Inner`不是静态类，因此它没有无参数构造函数。它只是看起来那样。实际上，它有一个构造函数，该构造函数接受一个`Foo1`包含对其父对象的引用的参数。

`foo1.super()`但是，对 的调用将正常工作。它将使用隐式父引用调用新`Inner`实例的构造函数。`foo1`也就是说，新`Inner`实例将绑定到给定`Foo1`实例。

正如其他人指出的那样，您可以将您的`Inner`类设为静态，在这种情况下，它不包含对`Foo1`实例的隐式引用。然后你可以简单地调用`super();`你的`Foo2`构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:53:53.110

让你的内心阶层`static`。没有可从中获取非静态类定义的实例

# jquery - 向 JQuery 滑块添加启动/停止功能

> ID：10584456
> 
> 赞同：0
> 
> 时间：2012-05-14T13:39:17.580
> 
> 标签：jquery, jquery-ui, slider, jquery-slider

我有一个 JQuery 滑块，一切正常。

你可以在这里找到它：http: [//sebastiaanbr.nl/hetluisterendoog/](http://sebastiaanbr.nl/hetluisterendoog/)

但现在我想为滑块添加启动/停止功能，以便我可以随时暂停或启动滑块。我不知道应该从哪里以及如何开始：

```
jQuery(document).ready(function($){
//var timings
//var fade_rand
//bullets
//transition_time
var blocked = false;
var slide_names = "fade_"+fade_rand+"_slide_";
var current_slide = 0;
$(document).oneTime(timings[0],fade_rand+"_timer", function(){
    change_slide(null);
});
if(parseInt(bullets) == 1){
    $("#fade_"+fade_rand+" div.fade_custom_bullets ul li").click(function(){

        var id = $(this).attr("data-id");
        if(id != current_slide){
            $(document).stopTime(fade_rand+"_timer");
            change_slide(id);
        }
    });
}

function change_slide(next_slide){
    if(blocked == false){
        blocked = true;
        if(next_slide != null){
            var nextnum = next_slide;
        }
        else{
            var nextnum = parseInt(current_slide) +1;
        }
        next = $("#"+slide_names+nextnum);
        next_id = next.attr("id");
        if(next_slide == null){
            if(typeof(next_id) == "undefined"){
                next = $("#"+slide_names+"0");
                nextnum = 0;
            }
        }
        var current = $("#"+slide_names+current_slide);
        if(current.attr("id") != next.attr("id")){
            $("#fade_"+fade_rand+" div.fade_custom_bullets ul li#fade_bullet_"+current_slide).removeClass("active");
            current.fadeOut(transition_time,function(){
                $("#fade_"+fade_rand+" div.fade_custom_bullets ul li#fade_bullet_"+nextnum).addClass("active");
                next.fadeIn(transition_time, function(){
                    current_slide = nextnum;
                    blocked = false;
                    $(document).oneTime(timings[current_slide],fade_rand+"_timer", function(){
                        change_slide(null);
                    });
                });
            });
        }
        else{
            blocked = false;
        }
    }
} 
```

});

# android - 自动刷新 webview，当用户想要滚动应用程序顶部边框时

> ID：10584458
> 
> 赞同：0
> 
> 时间：2012-05-14T13:39:29.133
> 
> 标签：android, scrollview

我正在尝试制作一个简单的 android 应用程序。

它应该显示带有一些 url 的 webview。诀窍是：我想刷新 webview，当用户想要滚动顶部应用程序边框时（然后应该出现一个文本框，说明 webview 正在刷新）。

Dolphin Webzine 中实现了类似的功能：https: [//play.google.com/store/apps/details? id=com.dolphin.browser.magazines&hl=pl](https://play.google.com/store/apps/details?id=com.dolphin.browser.magazines&hl=pl)

当您选择 ie Wired 然后滚动到顶部时，Feed 将被更新。任何想法如何做到这一点？我现在完全迷失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:24:01.120

//你的意思是拉刷新。

[点击这里下载完整的源代码](https://github.com/johannilsson/android-pulltorefresh/zipball/master)

# sql - 如何在列中获取最后插入的具有重复值的行？

> ID：10584460
> 
> 赞同：0
> 
> 时间：2012-05-14T13:39:39.753
> 
> 标签：sql, sql-server-2008

我的数据库中有 4 个表，其中包含以下字段：

*   全球定位系统（gps_id，序列号）
*   客户（client_id，名称）
*   client_gps(client_id, gps_id)
*   person_gps(gps_id, date1, date2)

我需要显示来自选定客户端的所有 gps 设备序列号。“person_gps”表可以有重复的“gps_id”记录。

像这样，

```
gps_id++++date1++++++++date2
===================================
110   ----10/05/99----05/05/05
110   ----03/02/06----NULL
112   ----03/02/04----04/02/04
112   ----05/09/04----06/08/08
113   ----09/09/09----10/03/10 
```

而且我需要检查每个 gps_id 的最后一条记录中的“date2”是否不为空。因此，在此示例中，应仅显示来自 gps 且 id=112 和 id=113 的序列号。

做这个的最好方式是什么？所有这些都应该在存储过程上创建，所以正如我之前所说，client_id 是一个给定的参数（@client）。

我正在使用 SQL Server 2008。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:56:09.273

尝试这个：

```
select * from person_gps a
INNER JOIN client_gps b ON a.gps_id = b.gps_id
INNER JOIN gps c on a.gps_id = c.gps_id
WHERE b.client_id = @client_id and NOT EXISTS (select 1 from person_gps
where x a.gps_id = x.gps_id and x.date2 is null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:52:20.183

也许是这样的：

```
;WITH CTE
AS
(
    SELECT
        ROW_NUMBER() OVER(PARTITION BY gps_id 
                     ORDER BY date2 DESC) AS RowNbr,
        person_gps.*
    FROM
        person_gps  
)
SELECT
    *
FROM
    gps
    JOIN CTE
        ON gps.gps_id=CTE.gps_id
        AND CTE.RowNbr=1
WHERE EXISTS
    (
        SELECT
            NULL
        FROM
            client_gps
        WHERE
            client_gps.gps_id=gps.gps_id
            AND client_gps.client_id=2--Limit on some clientid
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:52:37.077

```
SELECT distinct g.serial_number
FROM person_gps pg, client_gps cg, gps g
WHERE cg.client_id = $INPUT
AND pg.gps_id = cg.gps_id
AND g.gps_id = cp.gps_id
AND NOT EXISTS(SELECT 1 
               FROM person_gps
               WHERE gps_id = cg.gps_id
               AND date2 IS NULL)
ORDER BY gps_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:53:22.693

您可以使用 select 语句来执行此操作。

首先，考虑要选择哪些行。您可以使用 row_number() 获取最后一行，然后检查 date2 是否正确。然后，将这些连接回原始记录以提取您想要的记录：

```
select *
from person_gsp pg join
     (select pg.gp_id
      from (select pg.*,
                   row_number() over (partition by gps_id order by date1 desc) as seqnum
            from person_gps pg
           ) pg
      where seqnum = 1 and date2 is not null
     ) ids
     on pg.gp_id ids.gp_id 
```

# box-api - 对象 BoxUpdate 缺少一些信息

> ID：10584467
> 
> 赞同：0
> 
> 时间：2012-05-14T13:39:52.760
> 
> 标签：box-api

当请求 get_updates 时，BoxUpdate 对象不会提供 API 发送的所有字段。特别是“文件”数组（为什么它是数组？）。

所以在我的更新部分，我可以知道谁做了什么，什么时候做了什么，而不是在哪个文件上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T21:44:43.053

V1 Box API (http://developers.box.net/w/page/22926051/ApiFunction_get_updates) 中的 get_updates API 提供了文件和文件夹字段（包括 ID）的精简列表。如果您想要更新的文件或文件夹的完整信息，您需要调用相应的 API。

get_updates 返回一个数组的原因是，在您调用 get_updates API 之间，许多文件或文件夹可能会被触及。API 允许您发送开始和结束时间戳，并获取更新列表，因此它必须是一个数组。

# sql-server-2008 - SQL Server 2008 中跨多个表的 SQL OUTER JOIN

> ID：10584469
> 
> 赞同：4
> 
> 时间：2012-05-14T13:39:55.837
> 
> 标签：sql-server-2008, outer-join

我有一个 SQL Server 2008 数据库。这个数据库有三个表：

**人**

```
 - Id
  - FullName
  - MembershipStatusId (nullable)
  - HairStyleId (nullable) 
```

**会员状态**

```
 - Id
  - Name 
```

**发型**

```
 - Id
  - ColorName
  - Description 
```

我需要创建一个查询，列出我数据库中的所有人员。因为`MembershipStatusId`和`HairStyleId`都可以为空，所以我知道我需要进行左外连接。但是，因为有多个表，我不知道该怎么做。通过一个左外连接，我知道我可以做到这一点：

```
SELECT
  p.*,
  m.Name as 'MembershipStatus',
  -- how do i include the person's hair color as part of my result set?
FROM
  Person p LEFT OUTER JOIN
    MembershipStatus m ON p.[MembershipStatusId] 
```

但是，我不确定如何为发型名称添加左外连接。有人可以告诉我如何包含人的头发颜色吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T13:44:18.503

您只需再做一个`LEFT JOIN`以包含 HairStyle Table

```
SELECT
  p.*,
  m.Name as 'MembershipStatus',
  h.ColorName
FROM Person p 
LEFT JOIN MembershipStatus m 
    ON p.[MembershipStatusId] = m. Id
LEFT JOIN HairStyle h
    ON p.HairStyleId = h.id 
```

[查看关于SQL Fiddle](http://sqlfiddle.com/#!3/2a285/1)的演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:44:46.773

也许是这样的：

```
SELECT
    Person.id,
    MembershipStatus.Name AS MemberShip,
    HairStyle.ColorName AS HairStyleColorName
FROM
    Person
    LEFT JOIN MembershipStatus
        ON Person.MembershipStatusId=MembershipStatus.Id
    LEFT JOIN HairStyle
        ON Person.HairStyleId = HairStyle.Id 
```

# apache-flex - Tomcat 和更新的 flex services-config.xml

> ID：10584478
> 
> 赞同：2
> 
> 时间：2012-05-14T13:40:12.127
> 
> 标签：apache-flex, tomcat, grails

我需要更新列出 Tomcat 中 amf 通道的 flex/services-config.xml，而无需重新启动 Tomcat 或使用管理器。

这可能吗 ？是否有一些命令可以用来在不重新启动 Tomcat 的情况下重新加载应用程序。

我正在使用 Tomcat 6

谢谢

戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:05:51.503

在`services-config.xml`中，您可以设置自动重新部署间隔，以查找配置更改：

```
<system>
    <redeploy>
        <enabled>true</enabled>
        <!-- Change to fit your requirements -->
        <watch-interval>20</watch-interval>
        <watch-file>{context.root}/WEB-INF/flex/services-config.xml</watch-file>
        <watch-file>{context.root}/WEB-INF/flex/proxy-config.xml</watch-file>
        <watch-file>{context.root}/WEB-INF/flex/remoting-config.xml</watch-file>                       
        <watch-file>{context.root}/WEB-INF/flex/messaging-config.xml</watch-file>                                  
        <watch-file>{context.root}/WEB-INF/flex/data-management-config.xml</watch-file> 
        <touch-file>{context.root}/WEB-INF/web.xml</touch-file>
    </redeploy>
</system> 
```

不过，您必须至少手动重新部署一次才能使其生效

# c - 调整窗口大小后无法正确检索鼠标坐标

> ID：10584479
> 
> 赞同：5
> 
> 时间：2012-05-14T13:40:20.630
> 
> 标签：c, sdl

下面是一个简化的代码，显示了我面临的问题。

代码的目的是创建一个 512x512 的窗口，并在检测到左键单击时将其顶层表面的 Y 尺寸更改为 512x(512+25)。当检测到另一个左键单击时，我们将尺寸恢复为 512x512。

当检测到左键单击事件或检测到 a`mouseMotionEvent`时，我们显示（用`printf()`）鼠标坐标。

观察到奇怪的行为：

当我运行代码时，我左键单击一次，窗口的 Y 尺寸发生了变化，但是当我在新创建的区域内移动鼠标时，显示的 Y 坐标卡在 511。

有时我没有得到这个奇怪的行为，那么 Y 坐标可以大于 511。为了得到这个奇怪的行为，左键单击几次，快速移动鼠标。

编译（Linux）：

```
$ gcc -o test test.c `sdl-config --cflags --libs` 
```

来源：（test.c）

```
#include <stdlib.h>
#include <stdio.h>
#include <SDL.h>

/* Prototypes */
void event_handler(void);

/* global variables declaration */
SDL_Surface *screen=NULL;

/***** MAIN FUNCTION *****/
int main(int argc, char** argv)
{   
    /* init SDL */
    if (SDL_Init(SDL_INIT_VIDEO) < 0) {
        fprintf(stderr, "Erreur à l'initialisation de la SDL : %s\n", SDL_GetError());
        exit(EXIT_FAILURE);
    }

    if ((screen = SDL_SetVideoMode(512, 512, 32, SDL_SWSURFACE )) == NULL) {
        fprintf(stderr, "Graphic mode could not be correctly initialized : %s\n",     SDL_GetError());
        exit(EXIT_FAILURE);
    }
    SDL_WM_SetCaption("my window", NULL);

    /* handle event & wait until quit_event is raised */
    event_handler();    

    /* quit & return */
    SDL_Quit();
    return EXIT_SUCCESS;
}

/*** Event handler ***/
void event_handler(void)
{
    SDL_Event event;
    int quit=0;
    char message_is_displayed=0;
    SDL_Rect mess_coord = {0,512,512,512+25}; //{x_start,y_start,width,height}

    while(!quit)
    {
        SDL_WaitEvent(&event);
        switch(event.type)
        {
            case SDL_QUIT:
                quit = 1;
                break;

            case SDL_MOUSEBUTTONDOWN:
                if (event.button.button == SDL_BUTTON_LEFT)
                {
                    if(!message_is_displayed)
                    {
                        screen = SDL_SetVideoMode(512,512+25, 32, SDL_SWSURFACE); //change the screen size
                        SDL_FillRect(screen, &mess_coord, SDL_MapRGB(screen->format, 255, 255, 255));  // fill in white the bottom area 
                    }
                    else
                    {
                        screen = SDL_SetVideoMode(512, 512, 32, SDL_SWSURFACE);
                    }
                    message_is_displayed = !message_is_displayed;
                    SDL_Flip(screen);
                }
                printf("mouse position: (%d,%d)\n",event.button.x, event.button.y);
                break;

            case SDL_MOUSEMOTION:
                printf("mouse position: (%d,%d)\n",event.motion.x, event.motion.y);
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:15:36.823

您可以尝试以下函数来获取变量 oldx 和 oldy 中的 x 和 y 坐标

```
int oldx,oldy;    
oldx=wherex();
oldy=wherey(); 
```

在 Windows 中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T12:54:58.093

如果您使用的是 SDL1，我认为您应该将其添加到您的代码中：

```
int x, y;
SDL_GetMouseState(&x, &y); 
```

现在鼠标位置在`x`和`y`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-12T15:29:38.620

只要您按下鼠标按钮，它就会调整大小，然后打印按钮位置。它可能是在裁剪窗口后裁剪鼠标位置。

尝试仅在 SDL_MOUSEBUTTONUP 上调整窗口大小。这样，您可以在鼠标真正单击 (SDL_MOUSEBUTTONDOWN) 时打印当前位置，然后在释放鼠标后调整大小。

# facebook - 如何判断 Facebook 应用程序是否在页面上？

> ID：10584480
> 
> 赞同：7
> 
> 时间：2012-05-14T13:40:23.650
> 
> 标签：facebook, web-scraping

我最初使用的方法是：

```
http_head('http://www.facebook.com/pages/Test/' . $input['fb_page_id'] . '?sk=app_' . $input['fb_id']), 'HTTP/1.1 301 Moved Permanently') 
```

这种方法的问题是：

1.  如果页面根本不存在，Facebook 将返回`200`标题，而不是`404`（例如`http://www.facebook.com/pages/Test/DominosPizza?sk=app_311706258843058`）。
2.  如果页面有用户名，此请求将返回响应`301`响应。

我正在构建一个脚本，该脚本偶尔会遍历`<div data-page="130414917005937" data-app="299770086775725"></div>`我的投资组合中的所有实例。然后检查应用程序是否仍在页面上。如果应用程序在页面上，它将提供一个链接，否则保持标签不变。

**我正在寻找不需要访问令牌的解决方案。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T23:26:56.727

这是查看 Facebook 页面是否安装了该应用程序的官方方法。

请参阅[http://developers.facebook.com/docs/reference/api/page/](http://developers.facebook.com/docs/reference/api/page/)

> **测试应用安装**
> 
> 您可以通过向`PAGE_ID/tabs/APP_ID`.
> 
> 此请求适用于任何 APP_ID 并返回上述字段是应用程序安装在页面上。如果页面上没有安装应用程序，该请求将返回一个空的 data[] 数组。
> 
> 您还可以使用应用访问令牌发出相同的查询。在这种情况下，您可以查询任何PAGE_ID，如果您的应用安装在指定页面上，则会返回上述字段。如果应用程序未安装在指定页面上，则照常返回一个空的 data[] 数组。

所以这是一个简单的 HTTP GET`http://graph.facebook.com/PAGE_ID/tabs/APP_ID`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T07:52:02.417

除非 Facebook 更改他们的 URL 方案，否则这是可行的。

请注意，此方法发出`HEAD`请求，而不是`GET`. 因此，不会下载任何内容。有关如何/为什么工作的进一步说明，请参阅[http://anuary.com/47/keeping-facebook-portfolio-up-to-date](http://anuary.com/47/keeping-facebook-portfolio-up-to-date)。

请注意，如果页面隐私设置限制未经身份验证的用户，您需要伪造用户身份验证才能使其正常工作。

```
$fn_is_app_on_page  = function($page_id, $app_id)
{
    $ch         = curl_init();

    curl_setopt_array($ch,
    [
        CURLOPT_USERAGENT       => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_0) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11',
        CURLOPT_URL             => 'https://www.facebook.com/pages/anuary/' . $page_id . '?sk=app_' . $app_id,
        CURLOPT_FOLLOWLOCATION  => TRUE,
        CURLOPT_HEADER          => FALSE,
        CURLOPT_NOBODY          => TRUE
    ]);

    $response   = curl_exec($ch);

    $info       = curl_getinfo($ch);

    curl_close($ch);

    if($info['http_code'] == '404')
    {
        return FALSE;
    }

    if(strpos($info['url'], (string) $app_id) !== FALSE)
    {
        return TRUE;
    }

    return FALSE;
};

$fn_is_app_on_page(130414917005937, 299770086775725); // TRUE
$fn_is_app_on_page(1, 299770086775725); // FALSE
$fn_is_app_on_page(130414917005937, 1); // FALSE 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T07:53:48.427

您可以检查您请求的页面的 http 响应并搜索字符串`pagelet_app_APPID`（其中 APPID 是实际的应用程序 ID）

这解决了问题 1，因为如果请求的页面实际上不是选项卡应用程序，则该字符串将不存在于页面上。

针对问题 2，如果出现 301，请遵循重定向并在重定向页面的响应中搜索此字符串。

**已于 2012 年 10 月 29 日编辑**

我只是进一步研究了这个问题。匿名用户无法访问首页的原因。这是由于页面管理员设置的一些权限限制。正是由于这些限制，facebook 要求用户在看到页面之前进行身份验证。当您使用 cURL 时，facebook 将此请求视为匿名用户并将请求重定向到登录页面。第二个应用程序没有这个问题。

为了解决这个问题，我建议您在使用浏览器登录后检查您的 Facebook cookie，并将其作为 cURL 请求的一部分发送。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-08-02T08:49:41.423

以下代码将帮助您了解应用程序是否通过 Facebook 页面加载。

```
<script>
  $(document).ready(function(){
    var isInIFrame = (window.location != window.parent.location) ? true : false;
    if (isInIFrame == true){
        //enter your code here
    }

});

</script> 
```

# android - 没有菜单按钮的 Android 设备上的菜单

> ID：10584486
> 
> 赞同：0
> 
> 时间：2012-05-14T13:40:48.163
> 
> 标签：android, android-button, android-menu

我正在尝试构建一个 Android 应用程序并想要一个菜单​​。关键是菜单选项仅适用于菜单按钮。那么没有这个按钮的新手机呢？好的，我可以使用

```
openOptionsMenu(); 
```

并以编程方式打开菜单，但是当我触摸屏幕时，菜单消失了。

制作一个看起来像真实但不使用菜单按钮的静态漂亮菜单的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:45:18.870

如果设备没有菜单按钮并且应用程序创建了菜单选项，则会显示一个软菜单按钮。Galaxy Nexus、HTC One X、HTC One S 等就是这种情况。

但是，您确实应该寻求创建一个 ActionBar 并将您的菜单项放在 ActionBar 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:46:32.527

我相信 android 去掉菜单按钮是有原因的，我无法想象尝试让你的应用看起来像它有一个静态菜单按钮是个好主意。也许您应该重新考虑您的 UI 设计并查看[操作栏](https://developer.android.com/design/patterns/actionbar.html)

# javascript - 为什么 event.bubbles 对于“focusin”和“focusout”是错误的？

> ID：10584488
> 
> 赞同：9
> 
> 时间：2012-05-14T13:40:56.910
> 
> 标签：javascript, jquery, focusin

几分钟前，我回答了这个问题：
[jQuery 中的 focusin/focusout 与 focus/blur 有什么区别？](https://stackoverflow.com/q/10584042/601179)

答案是：

**简短的回答：`focusin`    泡沫，`focus`没有。**
        **`focusout` 泡沫，`blur`   没有。**

我测试了一下，确实如此，但是在尝试设置[**DEMO**](http://jsfiddle.net/gdoron/95u6a/)时遇到了一件奇怪的事情：

```
$('#test').on('focusin focusout focus blur change', function(e) {
    console.log(e.type + 'event bubles? : ' + e.bubbles);
});​ 
```

`focusin`给`focusout`我`e.bubbles == false`

它是 jQuery 的错误还是我在这里错过了明显的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T13:43:50.803

~~听起来像是 jQuery 中的一个错误。~~您是否在支持本机的浏览器上对此进行了`focusin`测试`focusout`？（例如，IE？）因为如果不是，您正在测试 jQuery 模拟支持的标志。

我已经删除了上面的“听起来像一个错误”，因为 jQuery 没有声称要规范化`bubbles`文档中的属性。因此，由于它不能保证它，它不必在模拟事件上支持它。（请注意，如果我在 IE7 上运行您的演示，我会得到，`undefined`因为 IE7 不支持 DOM3 Events`bubbles`属性。）仍然是一个*问题*，但可能不是*错误*。:-)

* * *

**更新**：

[对jQuery 票的](http://bugs.jquery.com/ticket/11763)回应：

> 该文档没有声称规范化 event.bubbles 属性。您可以在 event.originalEvent 中查找它，但这将是平台提供的任何内容，未标准化。

所以我上面的猜测是正确的。这不是一个*错误*，因为他们没有声称将其标准化。:-)

# jquery - 谷歌地图和 jQuery 手风琴的问题

> ID：10584492
> 
> 赞同：3
> 
> 时间：2012-05-14T13:41:19.473
> 
> 标签：jquery, google-maps, accordion

我遇到了一个问题，这里已经描述过了，但我没有找到解决它的方法。问题是我将这个 jQuery 片段用于手风琴：

```
$(document).ready(function() {
$('#accordion > li > div.ac-inner').click(function(){

if(false == $(this).next().is(':visible')) {
    $('#accordion ul').slideUp(300);
}
    $(this).next().slideToggle(300);
});
    //$('#accordion ul:eq(0)').show()
}); 
```

我正在使用这个 HTML 加载谷歌地图：

```
<ul id="accordion">
<li id="acc-1"><div class="ac-inner"><h3>Tab 1</h3></div>
    <ul>
        <li><div><!-- Map goes here --></div></li>
    </ul>
</li>
<li id="acc-2"><div class="ac-inner"><h3>Tab 2</h3></div>
    <ul>
        <li><!-- Content goes here --></li>
    </ul>
</li>
<li id="acc-3"><div class="ac-inner"><h3>Tab 3</h3></div>
    <ul>
        <li><!-- Content goes here --></li>
    </ul>
</li>
</ul> 
```

这是我的 CSS：

```
#accordion {
list-style: none;
padding: 0;
width: 527px;
}
#accordion li {
background: none;
padding-left: 0;
}
#accordion div.ac-inner {
display: block;
cursor: pointer;
margin-bottom: 10px;
padding: 0 7px;
border: 1px solid #ddd;
background: #F5F5F5; /* Old browsers */
background: -moz-linear-gradient(top, #FAFAFA 0%, #F5F5F5 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#FAFAFA), color-stop(100%,#F5F5F5)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top, #FAFAFA 0%, #F5F5F5 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top, #FAFAFA 0%, #F5F5F5 100%);/* Opera 11.10+ */
background: -ms-linear-gradient(top,  #FAFAFA 0%,#F5F5F5 100%); /* IE10+ */
background: linear-gradient(top,  #FAFAFA 0%,#F5F5F5 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#FAFAFA', endColorstr='#F5F5F5',GradientType=0 ); /* IE6-9 */
border-radius: 5px;
box-shadow: 0 1px 0 #fff inset;
-moz-box-shadow: 0 1px 0 #fff inset;
-webkit-box-shadow: 0 1px 0 #fff inset;
text-shadow: 0 1px 0 #fff;
-moz-text-shadow: 0 1px 0 #fff;
-webkit-text-shadow: 0 1px 0 #fff;
}
#accordion ul {
list-style: none;
padding: 0 0 0 0;
}
#accordion ul {
display: none;
}
#accordion ul li {
font-weight: normal;
cursor: auto;
background-color: #fff;
padding: 0 0 0 7px;
}

#accordion a {
text-decoration: none;
}
#accordion a:hover {
text-decoration: underline;
}
#accordion #acc-1 div.ac-inner {
background: url(../images/icons/map.png) no-repeat 0 0 #F5F5F5;
text-indent: 70px;
}
#accordion #acc-2 div.ac-inner{
background: url(../images/icons/calendar.png) no-repeat 0 0 #F5F5F5;
text-indent: 70px;
}
#accordion #acc-3 div.ac-inner {
background: url(../images/icons/camera.png) no-repeat 0 0 #F5F5F5;
text-indent: 70px;
} 
```

谷歌说这是一个问题，因为 CSS 规则显示：无；所以地图被部分渲染（灰色块上方）并且没有居中。

是否可以仅调整上部 jQuery 代码片段以使此功能正常工作，或者我是否必须触摸 Google 地图加载脚本（通过 CMS 插件动态加载）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:46:06.100

这在[jQuery UI Tabs faq](http://jqueryui.com/demos/tabs/#...my_slider.2C_Google_Map.2C_sIFR_etc._not_work_when_placed_in_a_hidden_.28inactive.29_tab.3F)中也有描述。尝试收听手风琴更改事件并触发地图刷新

```
 google.maps.event.trigger(map, 'resize') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T19:21:11.657

如果您将 iframe 嵌入到手风琴中，那么在打开面板时刷新 iframe 的 src 对我有用：

```
$(".theaccordion" ).accordion({
    autoHeight: false,
    collapsible:    true,
    activate    :   function(e,ui) {
        ui.newPanel.find('iframe').each(function() {
            $(this).get(0).src = $(this).attr('src');
        });
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T07:12:06.273

$(".theaccordion" ).accordion({ autoHeight: false, collapsible: true, activate : function(e,ui) { ui.newPanel.find('iframe').each(function() { $(this). get(0).src = $(this).attr('src'); }); } });

这对我有用。谢谢米奇·麦考伊

# php - SQL 数据到表格/表格中

> ID：10584496
> 
> 赞同：0
> 
> 时间：2012-05-14T13:41:25.720
> 
> 标签：php, sql, datagrid, tabular

我想知道将数据行显示到 4x4 网格/表中的最简单方法是什么。我已经环顾了很长一段时间，但似乎找不到解决方案/不知道该怎么做。

这是我用来从 SQL 数据库中提取数据的代码。

```
<?php
require('json.php');
error_reporting(E_ALL);
mysql_connect("localhost", "root", "") or
die("Could not connect: " . mysql_error());
mysql_select_db("timetable") or die("No such database");
$sql = sprintf("
SELECT *
 FROM `event`
  WHERE `module` = 'SET08101'");

$result = mysql_query($sql)
 or die(mysql_error());
  while ($row = mysql_fetch_array($result)){
   print "<div>$row[id] $row[module] $row[day] $row[start]</div>\n";
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:45:57.800

像这样的东西会起作用：

```
<?php
require('json.php');
error_reporting(E_ALL);
mysql_connect("localhost", "root", "") or
die("Could not connect: " . mysql_error());
mysql_select_db("timetable") or die("No such database");
$sql = sprintf("
SELECT *
 FROM `event`
  WHERE `module` = 'SET08101'");

$result = mysql_query($sql)
 or die(mysql_error());
 ?>
 <table>
 <?php
  while ($row = mysql_fetch_array($result)){
   ?>
   <tr>
      <td><?php echo $row["id"];?></td>
      <td><?php echo $row["module"];?></td>
      <td><?php echo $row["day"];?></td>
      <td><?php echo $row["start"];?></td>
   </tr>
   <?php
  }
 ?>
 </table>
 <?php
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:57:26.000

我会这样做：

```
<?php
error_reporting(E_ALL);

require('json.php');

mysql_connect("localhost", "root", "") or die("Could not connect: " . mysql_error());
mysql_select_db("timetable") or die("No such database");

$sql = sprintf("SELECT *
                FROM `event`
                WHERE `module` = '%s'", 'SET08101');

echo "<table>";

$result = mysql_query($sql) or die(mysql_error());

while ($row = mysql_fetch_array($result)){
   echo "<tr>
             <td>{$row['id']}</td>
             <td>{$row['module']}</td>
             <td>{$row['day']}</td>
             <td>{$row['start']}</td>
         </tr>";
}
echo "</table>";
?> 
```

# database - 如何通过 Node.js 为 Redis 数据库发出 HGET/GET 命令？

> ID：10584502
> 
> 赞同：14
> 
> 时间：2012-05-14T13:41:53.320
> 
> 标签：database, node.js, redis

我正在使用 Node.js 和 Redis Database 。我是 Redis 新手。

我正在为节点使用[https://github.com/mranney/node_redis驱动程序。](https://github.com/mranney/node_redis)

初始化代码 -

```
var redis = require("redis"),
client = redis.createClient(); 
```

我尝试设置一些键值对 -

```
client.hset("users:123" ,"name", "Jack"); 
```

我想知道我可以通过 Node 从 Redis 获取 name 参数。

我试过

```
var name = client.hget("users:123", "name");  //returns 'true' 
```

但它只是返回“真”作为输出。我想要值（即-Jack） 我需要使用什么语句？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T14:06:34.080

你应该这样做：

```
client.hset("users:123", "name", "Jack");
// returns the complete hash
client.hgetall("users:123", function (err, obj) {
   console.dir(obj);
});

// OR

// just returns the name of the hash
client.hget("users:123", "name", function (err, obj) {
   console.dir(obj);
}); 
```

还要确保你了解 JavaScript 中回调和闭包的概念以及 node.js 的异步特性。如您所见，您将一个函数（回调或闭包）传递给`hget`. 一旦 redis 客户端从服务器检索到结果，就会调用此函数。如果发生错误，第一个参数将是一个错误对象，否则第一个参数将为空。第二个参数将保存结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:03:17.833

我找到了答案——

获取值需要回调函数。

```
client.hget("users:123", "name", function (err, reply) {

    console.log(reply.toString());

    }); 
```

# facebook - 在小组墙上的帖子上发表评论

> ID：10584505
> 
> 赞同：0
> 
> 时间：2012-05-14T13:42:09.563
> 
> 标签：facebook, comments

所以，我正在使用[fb.wall](http://www.neosmart.de/social-media/facebook-wall/) jQuery 插件，在我的网站上显示私人群组的墙。我尝试使用新版本，但无法与私人团体一起使用。

我的问题是：如何使用 api 对墙上的帖子发表评论？我在文档中没有找到任何关于它的[信息](http://developers.facebook.com/docs/reference/api/Comment/)。

但是，如果您知道任何其他 PHP/JS 解决方案，我也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:26:14.713

如果用户已授予您`user_groups`和权限，您可以从该用户所在的组访问提要`read_stream`并`publish_stream`代表他们向帖子添加评论。

因此，使用正确的权限，访问：

*   `/me/groups`获取[组列表](https://developers.facebook.com/docs/reference/api/group/)
*   `/GROUP_ID_HERE/feed`查看当前组内容
*   从那里获取[帖子](https://developers.facebook.com/docs/reference/api/post/)ID
*   通过发出 POST 请求将评论添加到帖子`/POST_ID/comments`
*   您将取回评论 ID

[我刚刚使用Graph API Explorer 工具](https://developers.facebook.com/tools/explorer)测试了这些确切的步骤，它工作并成功发布了评论

# entity-framework - Entityframework，控制新对象的创建

> ID：10584508
> 
> 赞同：0
> 
> 时间：2012-05-14T13:42:15.833
> 
> 标签：entity-framework, controls, createobject

我正在尝试更新**Transaction类的对象**

```
 public int Id { get; set; }
    public System.DateTime Date { get; set; }
    public string Remarks { get; set; }
    public double Amount { get; set; }
    public Nullable<long> GroupId { get; set; }
    public long UserId { get; set; }

    public virtual ICollection<User> PaidForUsers { get; set; }
    public virtual User PaidByUser { get; set; } 
```

元素 PaidForUsers 是**User**对象的集合

```
 public long Id { get; set; }
    public long UserId { get; set; } 
```

这里的 Id 是自动生成的，而 UserId 是由代码提供的。

我想要做的是，每当我创建一个新事务时，只有当用户不存在于数据库中时，我才应该创建一个新用户。

我目前正在使用 DbContext.Transactions.Add( *new transaction* )。这显然会在我每次创建新事务时在数据库中创建一个新用户。

我目前采用的解决方案是仅对尝试执行相同操作的用户实体使用自定义存储过程。但我也收到以下错误

*对数据库的更改已成功提交，但在更新对象上下文时出错。ObjectContext 可能处于不一致的状态。内部异常消息：AcceptChanges 无法继续，因为对象的键值与 ObjectStateManager 中的另一个对象冲突。在调用 AcceptChanges 之前确保键值是唯一的。*

这是存储过程 -

```
ALTER PROCEDURE [dbo].[InsertUser]
    (@UserId bigint )
AS
declare @val bigint
declare @countza int

SELECT @val= Id  FROM dbo.Users1 where UserId = @UserId
set @countza = @@Rowcount

    if @countza = 0
    begin
    insert into dbo.Users1 (UserId) values (@UserId)
    select [Id] from [dbo].[Users1] 
            where @@ROWCOUNT > 0 and [Id] = scope_identity() 

    end
    else
    begin
        SELECT  'Id' = @val
    end 
```

有人能说出最好的方法是什么吗？创建存储过程是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:32:57.547

我想说正确的方法 - 在“正常”情况下 - 是使用 LINQ：

（我假设它`UserId`必须是唯一的，但不是主键（即`Id`））

```
var transaction = context.Transactions.Create();
var user = context.Users.SingleOrDefault(u => u.UserId == userId);
if (user != null)
    transaction.PaidForUsers.Add(user);
else
    transaction.PaidForUsers.Add(new User { UserId = userId });
context.Transactions.Add(transaction);
context.SaveChanges(); 
```

如果您的操作对性能非常关键，那么正确的方法可能是存储过程。

# iphone - 如何从 UIpickerView 中选择特定值

> ID：10584513
> 
> 赞同：0
> 
> 时间：2012-05-14T13:42:27.467
> 
> 标签：iphone

我正在开发一个应用程序。在该应用程序中，我使用具有 10 个值的选择器视图。每当我向下滚动选择器时，在选择器弯下最后一个值后将被选中，并且 selectrow 将被触发。但我不想要那个，我需要选择我要选择的那个。所以请告诉我如何做那个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:00:48.617

有一种`UIPickerViewDelegate`方法可以为您提供选定的行：

```
-(void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row
inComponent:(NSInteger)component
{
        float rate = [[exchangeRates objectAtIndex:row] floatValue];
        float dollars = [dollarText.text floatValue];
        float result = dollars * rate;

        NSString *resultString = [[NSString alloc] initWithFormat:
        @"%.2f USD = %.2f %@", dollars, result,
               [countryNames objectAtIndex:row]];
        resultLabel.text = resultString;
} 
```

这可能是正确的链接[单击此处](http://www.techotopia.com/index.php/An_iOS_5_iPhone_UIPickerView_Example)查看您的问题。

# r - R中的ggplot2堆叠面积条图

> ID：10584524
> 
> 赞同：1
> 
> 时间：2012-05-14T13:42:55.020
> 
> 标签：r, ggplot2, stacked-area-chart

有没有办法在ggplot2（或R中的任何其他图形包）中结合堆叠条形图和堆叠面积图？我想创建一个堆积条形图，列之间有一些空间。条的组应由区域连接。换句话说，应该有带百分比标签的条形图，而不是区域图的边缘。

我试过的是：

```
ggplot(subdata, aes(x=variable, y=value, group=Name, fill=Name)) +
geom_area (positon="fill") +
geom_bar(stat="identity", colour="black") 
```

问题是我希望填充区域连接条形的边界而不是它们的中线。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T20:06:51.237

在这里没有得到任何答案后，我在邮件列表上问了这个问题`ggplot2`，Winston Chang 想出了一个解决方案：[ggplot2 google group中的线程](http://groups.google.com/group/ggplot2/browse_thread/thread/594d6d321da7043e/47dfa68bcfc94953?lnk=gst&q=combination%20of%20stacked%20area%20plot%20and%20stacked%20bar%20plot#47dfa68bcfc94953)

# api - 使用 Confluence REST API，是否可以检索给定页面的浏览量？

> ID：10584526
> 
> 赞同：16
> 
> 时间：2012-05-14T13:43:00.160
> 
> 标签：api, soap, confluence-rest-api

我正在使用 REST Confluence API 来检索我们的 Confluence 页面周围的一堆数据，例如版本、上次修改、创建等。但是，我看不到任何检索页面视图的方法。

你知道这是否可以通过他们的任何 API 访问？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-26T02:55:17.823

**ViewTracker 插件：**

默认情况下，由于性能原因，Confluence 不会记录任何页面浏览量或页面计数；但是，在安装和配置[Confluence ViewTracker 插件](http://www.bitvoodoo.ch/plugins/confluence-viewtracker-plugin.html)之后，您将开始记录这些数据。

但是，没有任何地方提及此信息是否可通过 API 获得。该插件没有 API，尚不清楚是否可以通过 API 获得附加信息。ViewTracker[文档](http://wiki.customware.net/repository/display/track/tracking-column)确实定义了一个返回计数的宏，因此信息清楚地存储在数据库中。

```
view count - The number of times the content has been viewed since the firstViewed date. 
```

如果 API 未返回此信息，则您可能需要向插件的维护者提出功能请求。

**Confluence 谷歌分析插件：**

如果 ViewTracker 插件不能满足您的需求，没有 API，并且开发人员不打算公开一个，那么您的另一个选择是安装[Confluence Google Analytics Plugin](https://marketplace.atlassian.com/plugins/me.davidsimpson.confluence.plugins.googleanalytics)。

与 ViewTracker 不同，它不是免费的。但是，您确实可以通过 Google Analytics 以编程方式访问这些数据。Google 公开了一个[核心报告 API](https://developers.google.com/analytics/resources/tutorials/hello-analytics-api#query_visits)，允许您以编程方式访问分析代码报告的综合浏览量、访问次数和其他指标。

Google 提供了有关如何使用 Java、PHP、Python 和 JavaScript 获取数据的示例和文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-23T19:43:53.220

最新版本的 ViewTracker 现在提供 ReST API： [https ://app.swaggerhub.com/apis/bitvoodooag/Viewtracker/7.1.0#/Reporting/getContentDailyVisits](https://app.swaggerhub.com/apis/bitvoodooag/Viewtracker/7.1.0#/Reporting/getContentDailyVisits)

# google-docs-api - DocumentList API 和 GAS。如何嫁给他们？

> ID：10584528
> 
> 赞同：1
> 
> 时间：2012-05-14T13:43:04.287
> 
> 标签：google-docs-api, google-apps-script, google-spreadsheet-api

使用这个 API 怎么样？

developer.google.com/google-apps/documents-list

它似乎能够访问修订历史提要。

但是这些示例在.NET 中。如何在 Google Apps 脚本中应用/使用此 API？任何人都知道如何并且可以阐明一些问题吗？也许是一个简短的示例代码？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:03:42.413

您需要查看 DocLists API 的协议。您可以将此协议与 URLFetch 和 Google oAuth 一起使用 这是一个快速示例，它以 json 格式返回修订历史记录

```
//Get revison history
//resource_id is the id of the doc
function getRevisionHistory(resource_id){
  var scope = 'https://docs.google.com/feeds/';
  var fetchArgs = googleOAuth_('docs', scope);
  fetchArgs.method = 'GET';
  var url = scope + 'default/private/full/'+resource_id+'/revisions?v=3&alt=json';
  var urlFetch = UrlFetchApp.fetch(url, fetchArgs);
  var jsonFeed = Utilities.jsonParse(urlFetch.getContentText()).feed.entry;
  return jsonFeed
}

//Google oAuth
//Used by getRevisionHistory
function googleOAuth_(name,scope) {
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey("anonymous");
  oAuthConfig.setConsumerSecret("anonymous");
  return {oAuthServiceName:name, oAuthUseToken:"always"};
} 
```

[要更多地使用 DocsList API，您可以在我的 Google 站点https://sites.google.com/site/appsscripttutorial/urlfetch-and-oauth](https://sites.google.com/site/appsscripttutorial/urlfetch-and-oauth)上查看更多示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:28:50.973

查看：[https](https://sites.google.com/site/scriptsexamples/custom-methods/driveservice) ://sites.google.com/site/scriptsexamples/custom-methods/driveservice 只需将源代码复制到您的文件中即可。

我将在接下来的几周内添加缺少的方法。修订肯定在我的清单上。

您将能够使用这些库，例如： DOCS_LIST_API.GdocToFormat (docID, format)

无需设置 OAuth，它将被内置。

# awk - 使用 awk 根据在文件 B 中查找匹配项来选择文件 A 中的行

> ID：10584531
> 
> 赞同：2
> 
> 时间：2012-05-14T13:43:11.937
> 
> 标签：awk

我有两个文件，文件 A 如下所示：

```
1       101427      GENE|ACT-A      1       101589      GENE|ACT-B    0.0357
1       101427      GENE|ACT-A      1       101785      GENE|ACT-C    0.6357
1       101427      GENE|TAD-J      1       101437      GENE|TAD-L    0.8967
1       101427      GENE|TAD-J      1       158988      GENE|TAD-O    0.0067
1       101427      GENE|TAD-J      1       159999      GENE|TAD-V    0.5427
1       101427      GENE|POL-D      1       101437      GENE|POL-H    0.2347 
```

和文件 B 看起来像这样：

```
GENE|ACT-A
GENE|TAD-L
GENE|POL-D 
```

我想选择文件 A 中的行，其中第 3 列或第 6 列在文件 B 中有匹配项。在上面的示例中，输出如下所示：

```
1       101427      GENE|ACT-A      1       101589      GENE|ACT-B    0.0357
1       101427      GENE|ACT-A      1       101785      GENE|ACT-C    0.6357
1       101427      GENE|TAD-J      1       101437      GENE|TAD-L    0.8967
1       101427      GENE|POL-D      1       101437      GENE|POL-H    0.2347 
```

这可以通过一些 awk 简单地实现吗？

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:01:21.767

```
awk 'FNR == NR {keys[$1]; next} $3 in keys || $6 in keys' fileB fileA 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:31:20.990

我会使用 awk 解决方案，因为它只需要检查每个文件一次，但这里有一个替代方案。

```
{ join -1 3 <(sort -k3 fileA) <(sort fileB) 
  join -1 6 <(sort -k6 fileA) <(sort fileB)
} > output 
```

# excel - excel vba - 复制一行并插入新工作表

> ID：10584540
> 
> 赞同：0
> 
> 时间：2012-05-14T13:43:49.737
> 
> 标签：excel, vba

我正在尝试从一张表中的一行复制信息，然后根据用户输入将其粘贴到另一张表中。粘贴数据后，单元格应向下滑动。我还没有找到好的示例代码来做到这一点，但它似乎应该在那里

谢谢

# java - 这个新 Intent 的 Android Intent 和 Object（实例）

> ID：10584542
> 
> 赞同：0
> 
> 时间：2012-05-14T13:43:51.343
> 
> 标签：java, android, android-intent

我对 Android 编程的理解有问题。

当我想在我的应用程序上添加选项卡时，我使用我的选项卡和与这些选项卡相关的 Intent 创建了一个代码。

现在，我将获得由我的选项卡创建的活动实例。（要检索公共选项卡的字段，例如 2 并与 3 的公共字段连接。所有在我的活动中启动了视线 TabHost）

如何在不使用静态的情况下做到这一点？

提前谢谢你，朱利安。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:46:35.880

您是否为每个选项卡使用不同的活动？

如果是，并将字段视为字符串，在示例 2 中：

```
 Intent intent = new Intent(this, YourThirdActivity.class);
        intent.putExtra("Field2", field2.toString()); 
```

在示例 3 中：

```
 intent = getIntent();
    Field2 = intent.getStringExtra("Field2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T09:17:43.947

这不是我认为的最佳解决方案，但它有效：

 `````
public class Tab2 extends Activity {

static Tab2 Instance;

protected void onCreate(Bundle savedInstanceState) {
Instance = this;
{...} 
````  ``````
public class TabMain extends TabActivity {

protected void onCreate(Bundle savedInstanceState) {
{... Create and launch all Intent Tab ...}
String value = Tab2.Instance.MyMethodReturnSomeThing();
{...} 
````  `目前，这是我的解决方案。如果你有更好的考虑：/````

# asp.net - ASP.NET 中的 ActiveDirectory 当前用户名

> ID：10584545
> 
> 赞同：8
> 
> 时间：2012-05-14T13:44:03.200
> 
> 标签：asp.net, active-directory, forms-authentication, windows-authentication

我正在尝试让 ActiveDirectory 和标准表单登录工作，但有一件事阻止了我。我无法获取当前 Windows 用户的名称。我得到的最接近的是`var i = WindowsIdentity.GetCurrent();`，但这给了我 IIS 应用程序池用户的名称。我在 IIS 中启用了匿名身份验证、表单身份验证和 Windows 身份验证。我可以从 AD 加载用户，所以我假设我的 web.config 设置正确。

**编辑**：这是我的 web.config（使用 Facade 提供程序）：

```
<membership defaultProvider="HybridMembershipProvider">
      <providers>
        <clear />
        <add name="HybridMembershipProvider" type="MyApp.Data.HybridMembershipProvider" AspNetProviderName="AspNetSqlMembershipProvider" ActiveDirectoryProviderName="ADMembershipProvider" />
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="MyAppConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="4" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
        <add name="ADMembershipProvider" type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="ADConnectionString" 
            attributeMapUsername="sAMAccountName" enableSearchMethods="true" attributeMapEmail="mail"/>
      </providers>
    </membership> 
```

编辑 2：这是我的 IIS 安全设置。

![IIS 安全设置](../Images/79155817933c700f13ec62b1acb866ef.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:05:25.620

如果你在 IIS 中打开 ASP.Net Impersonation，你可以得到你想要的用户名。这仅在该数据位于成员资格提供者/AD 表单中且它们不是匿名的情况下才有效。

此外，混合基于表单和基于 Windows/AD 的身份验证是可行的，但不推荐。如果您需要这样做，请参阅[此。](https://stackoverflow.com/questions/2250921/mixing-forms-authentication-with-windows-authentication)

**编辑**：我想我误解了你想要的，所以这里是对上述解决方案的高级掩饰：

如果您关闭匿名身份验证并打开 Asp.Net 模拟，IIS 将在有人访问该站点时执行 401 质询。
如果一切都在同一个域中，Web 浏览器会将您的凭据发送到 IIS，IIS 将根据其 Active Directory 验证它们，然后 AD 将为 IIS 提供一个可以使用的身份。

当您打开 Asp.Net Impersonation 时，IIS 会将该身份绑定到当前线程/请求。因此，在身份验证发生后，您可以从当前线程标识中获取用户名，然后查询 Active Directory，如下所示：

```
using System.Threading;
using System.DirectoryServices;
using System.DirectoryServices.AccountManagement;

......

PrincipalContext pc = null;
UserPrincipal principal = null;

try
{
    var username = Thread.CurrentPrincipal.Identity.Name;
    pc = new PrincipalContext(ContextType.Domain, "active.directory.domain.com");
    principal = UserPrincipal.FindByIdentity(pc, username);

    var firstName = principal.GivenName ?? string.Empty
    var lastName = principal.Surname ?? string.Empty
    return string.Format("Hello {0} {1}!", firstName, lastName);
}
catch ...
finally
{
    if (principal != null) principal.Dispose();
    if (pc != null) pc.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:49:35.690

我使用 Windows 身份验证编写的 .Net 应用程序仍然可以`User.Identity.Name`用来获取 AD 用户名。当然，这通常包括 DC，并返回用户的 SAM 帐户名称。我并没有尝试同时实现两者，但`User.Identity.Name`肯定是分开工作的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:21:32.670

如果您在活动目录中使用表单身份验证，请尝试以下操作：

```
Context.User.Identity.Name 
```

//代码片段

```
sub Page_Load(sender as object, e as EventArgs)
  lblName.Text = "Hello " + Context.User.Identity.Name & "."
  lblAuthType.Text = "You were authenticated using " &   Context.User.Identity.AuthenticationType & "."
end sub 
```

参考：
[来自 ASP .NET 的 Active Directory 身份验证](http://msdn.microsoft.com/en-us/library/ms180890%28v=vs.80%29.aspx)
[如何使用表单身份验证和 Visual Basic .NET 对 Active Directory 进行身份验证](http://support.microsoft.com/kb/326340) [构建安全的 ASP.NET 应用程序：身份验证、授权和安全通信](http://msdn.microsoft.com/en-us/library/ff649227.aspx)

参考：您可以通过多种方式将 Windows 身份验证与 ASP.NET 一起使用：

*   **无需模拟的 Windows 身份验证**。这是默认设置。ASP.NET 使用应用程序的进程标识（默认情况下是 Windows Server 2003 上的网络服务帐户）执行操作和访问资源。

*   **带有模拟的 Windows 身份验证**。使用这种方法，您可以模拟经过身份验证的用户并使用该身份来执行操作和访问资源。

*   **具有固定身份模拟的 Windows 身份验证**。使用这种方法，您可以模拟一个固定的 Windows 帐户来使用特定身份访问资源。在 Windows Server 2003 上，您应该避免这种模拟方法；相反，使用具有自定义服务标识的自定义应用程序池。

根据文档，您可以获得经过身份验证的用户的 Windows 令牌。

```
IIdentity WinId= HttpContext.Current.User.Identity;
WindowsIdentity wi = (WindowsIdentity)WinId; 
```

> 如果有问题，请按照[如何：在 ASP.NET 2.0 中使用 Windows 身份验证](http://msdn.microsoft.com/en-us/library/ff647405.aspx)的 MSDN 文档检查您的应用程序 **模拟方法**

请参阅 ScottGu 的文章[配方：在 Intranet ASP.NET Web 应用程序中启用 Windows 身份验证](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:54:40.177

这是我不久前在我的 ASP.NET MVC 应用程序中使用的一段代码，它对我有帮助，但不知道它是否对你有帮助，你可以随意检查

```
 private static void CheckIfUserExists(string p)
    {
        try
        {
                var user = (from x in Data.EntityDB.UserInfoes where x.SAMAccountName == p select x).FirstOrDefault();
                DirectoryEntry entry = new DirectoryEntry(Properties.Settings.Default.LDAPPath); //this is the connection to your active directory
                DirectorySearcher search = new DirectorySearcher(entry);
                search.PropertiesToLoad.Add("*");
                search.Filter = "(&(sAMAccountName=" + p + ")(objectCategory=person))";
                SearchResult searchResult = search.FindOne();
            //If the user under the alias is not found, Add a new user. Else, update his current data
            if (user == null)
            {
                XXXXXXX.Models.UserInfo newUserEntry = new Models.UserInfo
                {
                    SAMAccountName = p,
                    First_Name = searchResult.Properties.Contains("givenName") ? searchResult.Properties["givenName"][0].ToString() : string.Empty,
                    Last_Name = searchResult.Properties.Contains("sn") ? searchResult.Properties["sn"][0].ToString() : string.Empty,
                    Title = searchResult.Properties.Contains("title") ? searchResult.Properties["title"][0].ToString() : string.Empty,
                    Office = searchResult.Properties.Contains("l") ? searchResult.Properties["l"][0].ToString() : string.Empty,
                    Country = searchResult.Properties.Contains("c") ? searchResult.Properties["c"][0].ToString() : string.Empty,
                    Telephone = searchResult.Properties.Contains("telephoneNumber") ? searchResult.Properties["telephoneNumber"][0].ToString() : string.Empty,
                    Mobile_Phone = searchResult.Properties.Contains("mobile") ? searchResult.Properties["mobile"][0].ToString() : string.Empty,
                    Email_Address = searchResult.Properties.Contains("mail") ? searchResult.Properties["mail"][0].ToString() : string.Empty,
                    Image_Path = string.Format(Properties.Settings.Default.UserPicturePath, p),
                    LastUpdate = DateTime.Now,
                }; 
```

**更新**

请注意，我还在此摘录中查询了不同的数据库，忽略所有 Linq 语句。,`DirectoryEntry`和`DirectorySearcher`类`SearchResult`应该可以帮助您满足您的需求。

**更新 2** 变量 p 可以替换为`HttpContext.Current.User.Identity`Property

**更新 3** 这是 LDAP 名称的当前列表（您可以在其中看到 searchResult.Properties.Contains("")[在这里](http://www.kouti.com/tables/userattributes.htm)指向活动目录中的不同用户属性

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-14T13:48:59.420

我会尝试：

`var i = Environment.CurrentUser;`

你也可以使用我的课程： http: [//pastebin.com/xnYfVsLX](http://pastebin.com/xnYfVsLX)

# iphone - viewController 显示时的计时器？

> ID：10584549
> 
> 赞同：0
> 
> 时间：2012-05-14T13:44:09.987
> 
> 标签：iphone, objective-c

在显示视图时，我需要在其视图控制器中重复调用一个函数——也许每秒一次。如果用户离开视图（通过向下或向上包含导航控制器的堆栈），计时器应该停止。当他们移回视图时，计时器应该恢复。

我如何实现这一目标？有什么特别需要考虑的（如果用户退出应用程序或接听电话？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:02:50.223

试试这个代码：

```
 NSTimer *timer;

    - (void)viewWillAppear:(BOOL)animated
    {

           timer = [NSTimer scheduledTimerWithInterval: 0.1 target:self selector:@selector(targetMethod:) userInfo:nil repeats: YES];
    }
    - (void)viewWillDisappear:(BOOL)animated
    {

          [timer invalidate];
    }

    -(void) targetMethod: NSTimer * theTimer 
    {
           NSLog(@"Me is here at 1 sec delay");
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:46:19.160

使用`- (void)viewWillAppear:(BOOL)animated`和`- (void)viewWillDisappear:(BOOL)animated`设置/重置您的`NSTimer`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:48:22.913

将您的计时器存储在一个数组中（如果需要，还可以使用其他计时器）。

当你需要停止定时器使用时`[theTimer invalidate];`

当您需要恢复它时，解析您的数组计时器并触发它/它们

如果用户更改/停止应用程序，它不会停止当前计时器，它会结束，但其他计时器将不再启动。

# android - 适用于 RC、Lite 和 Full 应用的 Android 项目结构

> ID：10584550
> 
> 赞同：3
> 
> 时间：2012-05-14T13:44:13.493
> 
> 标签：android, google-play

我正在为 Android Marketplace 计划一个应用程序。

首先，我想将它作为免费 RC 发布以进行公开测试，以在我将完整应用程序作为付费应用程序发布之前收集一些反馈。当 RC 被完整版取代时，我将发布一个有一些限制的免费 Lite 版。

计划是添加一组基本功能，对 RC 没有任何限制

以后会有

*   具有更多功能的完整付费版本
*   具有与 Full 相同的功能但有某些限制的 Lite 免费版本。

我正在寻找一些关于如何规划我的项目结构的建议，以避免随着应用程序的发展而对代码进行大量重构/移动。

这样的事情看起来合理吗？

*   一个主分支
*   RC 免费应用程序源自 MAIN 分支，准备就绪后发布到 Market
*   当 RC 生命周期结束时，来自 RC 的所有更改都合并到 MAIN 分支中，并且 RC 分支停止。RC 应用程序现在也从 Market 中撤出。
*   Lite 免费应用程序源自 MAIN 分支，一些限制适用于 Lite 分支
*   MAIN 分支现在是完全付费应用的分支。当完整版应用程序的新版本准备就绪时，更改将合并到 Lite 分支中，以便添加新功能而不会删除任何限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:56:15.400

前段时间我遇到了同样的问题，我决定采用以下结构。（我有一个 LITE / PAID 版本的应用程序）。

我对两个版本都使用了**一个**代码库，多亏了 maven，我可以做到这一点。有了它，我可以构建我需要的目标版本。

我的 Maven (pom.xml) 配置为创建一个全新的源库、重构包名称、更改 AndroidManifest、替换图标、替换属性文件、使用右键构建和签名 APK 全部使用单个命令行：

```
mvn install -Dedition=lite -P release 
```

我认为这是一个很好的解决方案，唯一的缺点是需要一些工作来正确配置您的 pom.xml（尤其是如果您不太了解 maven）。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T09:38:24.403

如果您（更）熟悉/熟悉[Eclipse ADT](http://developer.android.com/tools/projects/projects-eclipse.html)，那么设置一个库项目和两个依赖项目（精简版、完整版）可能是另一种方式。[firstlightassociates](http://www.firstlightassociates.co.uk/blog/2011/software/android-software/managing-free-and-paid-android-applications-2/)和[donnfelker](http://blog.donnfelker.com/2010/08/05/howto-android-full-and-lite-versions/)的详细信息。

*   `com.example.myapp`-包含所有代码和运行时检查包名称以打开/关闭特定功能的Android*库。*
*   `com.example.myapp.full`- 安卓应用程序。任何*完整*版本的特定资产。
*   `com.example.myapp.lite`- 安卓应用程序。任何*精简*版特定资产。

# php - 将一个地理区域分成一系列较小的区域（大小可控）并计算给定的经纬度点属于哪个区域

> ID：10584556
> 
> 赞同：1
> 
> 时间：2012-05-14T13:44:32.357
> 
> 标签：php, math, latitude-longitude, batch-processing, geo

不幸的是，数学从来都不是我的强项，我正在努力寻找最好的方法/公式来执行以下操作（然后我需要将其转换为 PHP 代码）：

1）。从一个单一的大区域开始（例如覆盖整个欧洲）

2）。将此区域分解为一系列较小的块（即，将其变成各种网格）

3）。每个网格块的宽度应大致对应于 75 公里的距离（考虑到地球的曲率）。

4）。计算每个网格块的中心纬度/经度点

5）。对于每个网格块的中心点，针对单独的纬度/经度点数据库（代表感兴趣的地方）运行搜索，以找到每个网格块最多 5 个最近的感兴趣点。最远的兴趣点距离网格块中心不得超过 150 公里。

完成上述所有操作后，我应该得到一个网格块数据库及其对应的 5 个最近的兴趣点。

我的希望是，然后我应该能够获取任何随机纬度/经度点并计算（使用有效的数学公式）它属于哪个预先计算的网格块，因此能够立即返回 5 个最近的兴趣点而不必做任何昂贵的计算。

[注：为清楚起见根据下面高性能标记的有用回复进行了编辑]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:50:29.987

我认为您最好的选择是使用或遵循现有的网格化区域方法的示例，例如[UTM](http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system)。既然你承认你的数学很弱，那么在这个阶段使用可能是你更好的方法。

UTM 会给你 1 和 2。

没有什么能让你在欧洲这么大的面积上获得 3 分。您将无法定义总和为正方形的 75 公里正方形数组，地球在如此大的区域内还不够平坦。

UTM 给你 4。

一旦你明白了这一切，你不应该对 5 有太多麻烦，但是当你到达那里并且遇到困难时再发布另一个问题。

**编辑**

扩展第 3 点。我建议您找到您感兴趣的区域的中纬度，即您感兴趣的区域的北部和南部界限之间的中纬度（以角度测量）。然后谷歌搜索公式，将经度的长度转换为该纬度的公里。沿该中纬度 75 公里间距的垂直线将成为您的网格的基础。这些线将在角度测量中等距分布。

接下来，计算出您感兴趣的区域的北部和南部边界处这些垂直线之间的距离（以公里为单位） - 相同的公式。如果线性度量仍在您的灵活性范围内，则您已完成此步骤。如果他们不是（a）我很惊讶并且（b）你将不得不解决一些棘手的数学和编程问题。

接下来，再次牢记您的中纬度，计算出该纬度对应 75 公里（纬度）的角度测量值。这将为您提供 2 条水平（即平行于赤道）网格线。由于纬度 75 公里的弧度测量值远小于经度随纬度变化的线性测量值，因此您可能可以用相同的角度测量值标出其他正方形。

# css - -webkit-外观：按钮；但对于火狐？

> ID：10584559
> 
> 赞同：2
> 
> 时间：2012-05-14T13:44:52.513
> 
> 标签：css, firefox

Firefox 有没有办法隐藏所有选择列表的样式？我已经为带有 -webkit-appearance: 按钮的 webkit 浏览器完成了它；

理想的 id 类解决方案适用于所有浏览器，但 Firefox 和 Webkit 对我来说是最重要的。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:49:02.273

添加这些以在所有浏览器中执行此操作：

```
appearance: button;
-o-appearance: button;
-ms-appearance: button;
-moz-appearance: button;
-khtml-appearance: button;
-webkit-appearance: button; 
```

# fortran - ＆符号在第 5 列和行尾

> ID：10584561
> 
> 赞同：4
> 
> 时间：2012-05-14T13:44:53.683
> 
> 标签：fortran, fortran90

我今天遇到了一些看起来像这样的代码：

```
 subroutine sub(hello,world,this,routine,takes,a, &
     &   crazy,large,number,of,arguments,              &
     &   so,many,that,it,gets,split,across,four,       &
     &   lines) 
```

似乎第 5 列中的和号是为了防止用户想要使用 f77 编译器编译代码——我的问题是这是否是合法的（符合标准的）fortran 90 代码。我想它可能不是符合标准的 f77 代码，因为尾随的 & 号也不在第 73 列中……但如果是的话，这是否是使自由格式和固定格式编译器满意的标准方法？换句话说，fortran 90 标准是否说在一行中间的 & 被简单地忽略（或类似的东西）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:06:59.197

& 是 Fortran 90 自由格式的*连续字符*。编译器的行为就像通过将尾随 & 的位置与下一行的前导 & 匹配来连接行一样。由于 Fortran 很乐意忽略标记之间的空格，因此您发布的内容是一种跨多个源文件行编写非常长的语句的方式。（OP 可能已经知道这一切，其他读者可能不知道。）

您显示的片段绝对是符合标准的 Fortran 90。标准定义了一个尾随 & 作为延续字符。如果要跨行拆分标记（例如变量名）或“字符上下文”（例如字符串文字），则继续运行的行必须以 & 开头，并且不能有空格插入到行首 & 之后的字符序列中。我认为您发布的内容潜入标准符合性，因为可能认为连续的 &s 不会将任何空白引入现有空白。

但是，您的代码段中不需要以 &s 开头的行。

您的代码段绝对不是符合标准的固定格式 FORTRAN77。然而，大多数现代 Fortran 编译器，除非您另有指示，否则会对这种“不符合标准”但“显而易见”的代码采取轻松的看法，并非常愉快地编译它。除非，也就是说，你尝试一些奇怪的事情，比如将自由格式的代码添加到现有的固定格式的源文件中，那只是要求编译器适应。

**编辑**

我最初的答案未能回答 OP 关于将 &s 移动到第 73 列作为创建代码以保持固定和自由格式编译满意的策略的问题。在 FORTRAN77 中，续行由续行第 6 列中的字符（任何字符）标记。该版本的语言不需要在行尾出现任何字符。同样，我看不出在第 73 列中放置 & 有什么问题。正如 OP 在评论中指出的那样，固定格式的 Fortran 忽略了第 73-80 列中的任何字符，并且打孔卡（啊，快乐的日子）只有 80列。

但我也看不出有什么可以推荐这种方法的。我认为最好不要在同一个源文件中混合自由格式和固定格式。当前所有的 Fortran 编译器都将在同一编译中编译这两种形式。但是，如果您想继续将两者混合，请随意这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:03:04.497

是的，这符合 Fortran 90。如果下一行的第一个非空白字符是“&”，则实际源文本从下一个非空白字符开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-14T11:59:42.007

高性能标记的答案是正确的，但是关于固定（F77）与免费（F90 及更高版本中允许）格式的延续还有另一个重要点。首先，在我看来，提供的代码`&`在第 6 列中有字符。如果是这样，那么它几乎与 F77 兼容；所需要做的就是删除行尾的尾随`&`'，或将它们移动到第 73 列。正如 Hristo Iliev 所指出的，在第`&`73 列和第 6 列都使用 an 允许符合多个 Fortran 的格式标准，这对于`INCLUDE`在不遵守单一标准的环境中编码时的语句 很有用。

# windows - 使用 VS 2008 的 Windows 上的 Apache 2.4 链接器错误

> ID：10584562
> 
> 赞同：1
> 
> 时间：2012-05-14T13:44:57.513
> 
> 标签：windows, visual-studio-2008, compilation, linker-errors

**问题：是否有任何关于如何为 Windows 构建 Apache 的手册/步骤？官方文档是不够的。**

我尝试在 Windows 7 Service Pack 3 上使用 Visual Studio 2008 Professional 在 Windows 上编译 Apache HTTP Server 2.4，但完全没有希望！！已经使用 Apache HTTP Server 2.2 测试了相同的步骤，并且构建过程成功。

我不知道出了什么问题，或者缺少了什么。这里遵循以下步骤：

```
Visual Studio 2008 Command Prompt:

"C:\Program Files\Microsoft Visual Studio 9.0\VC\bin\vcvars32.bat"

cd C:\path\to\httpd-2.4.2

perl srclib\apr\build\lineends.pl

perl srclib\apr\build\cvtdsp.pl -2005

cd srclib\zlib
nmake -f win32/Makefile.msc LOC="-DASMV -DASMINF -I." OBJA="inffas32.obj match686.obj"
MT -manifest zlib1.dll.manifest -outputresource:zlib1.dll;2

cd ..\..\srclib\openssl
perl Configure VC-WIN32 enable-camellia disable-idea
ms\do_nasm
nmake /f ms\ntdll.mak

Open Apache.dsw with VS9 "Yes to All" to the "convert projects" question, Select relase win32
Now build InstallBin
Test your build 
```

所需的库已经到位：

```
srclib\apr
srclib\apr-iconv
srclib\apr-util
srclib\openssl
srclib\pcre
srclib\zlib 
```

正如我所说，所有 Apache HTTP Server **2.2**编译都是成功的，而所有 Apache HTTP Server **2.4**都不**是**。

这是最常出现的错误，重复了 100 多次：

```
fatal error LNK1181: cannot open input file '..\..\release\libhttpd.lib' 
```

其他错误：

```
fatal error LNK1181: cannot open input file '..\release\mod_proxy_balancer.lib'
fatal error LNK1181: cannot open input file '..\core\release\mod_watchdog.lib'
fatal error C1083: Cannot open include file: 'pcre.h': No such file or directory    
fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 9.0\Common7\ide\devenv.COM"' : return code '0x1'
error PRJ0019: A tool returned an error code from "Performing Makefile project actions" 
```

**注意：我注意到 Apache 2.4 包中缺少多个 .mak 文件，包括 httpd.mak 和其他文件。我认为这是问题的很大一部分。**

有什么建议么？

环境：Windows 7 | 视觉工作室 2008 | 赛金 | Apache HTTP Server 2.4 源代码 | APR/APR-UTIL/APR-ICONV/ZLIB/OPENSSL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T18:24:52.350

在编译之前尝试编译每个依赖项，在尝试自行编译 Apache 之前尝试编译每个依赖项的依赖项。

# soap - 拉取通知 - 重复订阅/取消订阅是不是很糟糕？

> ID：10584565
> 
> 赞同：2
> 
> 时间：2012-05-14T13:45:04.153
> 
> 标签：soap, exchangewebservices, exchange-server-2007

我对 EWS 肥皂 API 中的“订阅”操作有疑问。

假设我有一个监视多个文件夹的邮件应用程序，并且我正在使用拉取通知来同步它。每次用户进入一个文件夹时，我只需要同步那个文件夹。对交换服务器要求更高的是什么？订阅邮箱中的每个文件夹（在一次订阅操作中）或从一个文件夹转到下一个文件夹时，取消订阅旧文件夹然后订阅新文件夹？

我只是想了解对交流的要求更高。谢谢！

# java - 无法连接：MySQL Connector/J 给了我一个奇怪的异常

> ID：10584568
> 
> 赞同：0
> 
> 时间：2012-05-14T13:45:14.503
> 
> 标签：java, mysql, jakarta-ee, tomcat, jdbc

在我的 web-inf 文件夹中，我创建了一个名为`com.utilClass.java`. 在这个类中，我有一个连接字符串。它在 localhost 中工作，但是当我尝试将其上传到主机时，它给了我如下错误：

> 连接代码

```
static public final String driver = "com.mysql.jdbc.Driver";
static public final String connection = "jdbc:mysql://localhost:3307/dilipgodhani?";
static public final String user = "user";
static public final String password = "xxxxx";
Connection con = null;

Class.forName(driver);
con = DriverManager.getConnection(connection, user, password);
Statement st = con.createStatement();
System.out.println(q);
rs = st.executeQuery(q); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:46:59.593

```
static public final String connection = "jdbc:mysql://localhost:3307/dilipgodhani?" 
```

这个仅适用于本地主机。

如果您将代码上传到远程主机，则应将其更改为

```
static public final String connection = "jdbc:mysql://REMOTE-HOST-IP:REMOTE-HOST-PORT/dilipgodhani?" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:49:36.087

可能是您在生产机器上名为“user”的连接用户缺乏适当的访问权限？你可以`mysql -u user`在生产主机上做一个并登录吗？

# jquery - 似乎无法让 jQuery UI 自动完成工作

> ID：10584569
> 
> 赞同：1
> 
> 时间：2012-05-14T13:45:17.177
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, jquery-ui, ruby-on-rails-3.1

我意识到这是一个非常笼统的问题，但我束手无策，试图让 jQuery 自动完成功能与我的 rails 搜索一起工作。我在 rails 3.1.0 和 ruby​​ 1.8.7 上运行。我想知道是否有人能够破译我的问题，我的代码如下......

应用程序.js：

```
//= require jquery
//= require jquery_ujs
//= require jquery-ui
//= require_self
//= require products

$(".search").autocomplete({
    source: ['foo', 'food', 'four']
}); 
```

看法：

```
<form action="<%= products_path %>" method="get" id="searchBox">
    <%= text_field_tag 'search', params[:search], :class => 'search', :placeholder => "What are you looking for?" %>
    <%= submit_tag "Search", :name => nil, :class => "button large" %>
</form> 
```

HTML 输出：

```
<form action="/products" method="get" id="searchBox">
    <input class="search" id="search" name="search" placeholder="What are you looking for?" type="text" />
    <input class="button large" type="submit" value="Search" />
</form> 
```

**解决方案**

我可以通过修改我的 jQuery 来实现它。虽然我仍然不确定为什么初始代码适用于我的测试应用程序而不是我的生产应用程序。

```
jQuery(function($){
  $('.search').each(function(){
    var self = $(this);
    self.autocomplete({source: ['foo', 'food', 'four']});
  });
}); 
```

# php - 我想“保存”模型以运行验证，但不将其写入数据库

> ID：10584573
> 
> 赞同：0
> 
> 时间：2012-05-14T13:45:35.800
> 
> 标签：php, cakephp, cakephp-2.1

我一直在寻找如何做到这一点的解决方案，但我最接近的解决方案是在你的模型中，有

```
public function beforeSave() {
    parent::beforeSave();

    if(!isset($this->data["Model"]["confirm"])) {
        return false;
    }
   } 
```

在控制器中只需执行以下操作：

```
 $this->Model->save($this->request->data);
        if($this->Model->validates()) {
            $this->render("confirm");
        } else {
            $this->Session->setFlash(__('The model could not be saved. Please, try again.'));
            // now we can render
            $this->render("index");
        } 
```

这种方法的问题是它会显示两次错误消息，有没有更好的方法来做到这一点？还是我应该以骇人听闻的方式执行此操作并找到一种方法来删除显示两次的错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:49:20.403

我应该更深入地研究一下文档：答案在[http://book.cakephp.org/2.0/en/models/data-validation/validating-data-from-the-controller.html](http://book.cakephp.org/2.0/en/models/data-validation/validating-data-from-the-controller.html)

感谢 @dm03514 指点我查看文档而不是 API（我已经阅读了几天但没有找到真正的答案）！

# java - 如何设置 Netbeans 以轻松使用 Play Framework 2.0

> ID：10584575
> 
> 赞同：0
> 
> 时间：2012-05-14T13:45:50.540
> 
> 标签：java, netbeans, playframework-2.0

作为 Netbeans 用户，我如何以简单的方式在 Netbeans 中编辑我的 Play 2.0 应用程序，并且所有类都被识别并且没有红色下划线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:35:58.140

这是一个更简单的方法。

1.  下载并安装 Play Framework 2.0
2.  进入命令行： `play new <application-name>
    cd <application-name>
    play eclipsify`
3.  打开 Netbeans
4.  从 netbeans 菜单中，选择： `File > Import Project > Eclipse Project > Import project ignoring dependencies`
5.  将您的项目文件夹位置复制并粘贴到两个文本框中

**尖端：**

1.  不要在创建项目和导入项目之间进行编译、构建或任何操作。
2.  在您的播放控制器中，如果播放服务器未运行，Netbeans 将无法识别您的新视图。您也可以在命令行和输入：`play compile`强制编译视图。

# html - 试图让 IE8 CSS 浮动：顶部（我知道不存在这样的东西）

> ID：10584578
> 
> 赞同：0
> 
> 时间：2012-05-14T13:46:11.653
> 
> 标签：html, css, internet-explorer-8

我正在尝试将其显示在左侧-

```
<div id="imageWrap">
          <img id="bigpic" src="pictures/3inchBinders/3inLarge.jpg" 
          height="200" width="175" alt="3 inch Binder" />
</div> 
```

这将在 imageWrap 下

```
<div class="thumbnail-wrapper" align="justify">
                <a href="#" class="thumbnail" data-index="0">
                    <img height="75" width="75" 
                            src="pictures/other/backSide.JPG" /></a>           
                <a href="#" class="thumbnail" data-index="1">
                    <img height="75" width="75" 
                            src="pictures/other/underSide.jpg" /></a>
                <a href="#" class="thumbnail" data-index="2">
                    <img height="75" width="75" 
                            src="pictures/other/open180logoTwo.jpg" /></a> 
                </div> 
```

所有这些都是我需要的，但两者之间存在很大差距......我还有关于需要位于 imageWrap 右侧的活页夹和缩略图包装器的统计信息。这是我的问题，因为我无法对齐顶部，所以我尝试使用 -10em 作为边距和填充，但没有任何效果。

我怎样才能让它更正确地显示？

# c++ - 我可以让 vim 对没有扩展名的 C++ 头文件进行语法突出显示吗？

> ID：10584580
> 
> 赞同：17
> 
> 时间：2012-05-14T13:46:19.437
> 
> 标签：c++, vim, editor, syntax-highlighting

我有一个项目，其中包含一堆遵循标准 C++ 头文件命名约定的 C++ 头文件；也就是说，一个名为 Foo 的类将在一个名为`Foo`, not `Foo.h`or的文件中声明`Foo.hh`。有没有一种好方法可以将 vim 配置为仅对这些文件进行语法高亮显示？一个稍微不那么令人愉快的后备方案是为所有没有扩展名的文件启用 C++ 样式的突出显示。我不确定是否有更复杂的方法来检测文件的类型，而不是仅仅依靠它的扩展名。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-14T13:49:55.430

您可以为此使用该`modeline`功能。模式允许您在文件的前几行/最后几行的注释中设置某些选项。

这使它成为设置编码指南和折叠参数的好地方。出于安全原因，某些选项无法设置。有关更多信息，请参阅[文档](http://vimdoc.sourceforge.net/htmldoc/options.html#modeline)。

把它放在文件的顶部或底部：

```
/* vim: set ft=cpp: */ 
```

编辑：更多细节，由评论提示:)：

它仅在启用模式行时才有效。在正常情况下，它应该是默认的。要确保它已启用，或更改检测到的区域的大小，请`modeline`在您的`.vimrc`:

```
set modelines=5 
```

将确保在每个文件的前五行或最后五行中检测到像上面引用的行。

在模式行内，`setlocal`表示为加载文件的缓冲区设置选项。该`ft`选项，也称为`filetype`，是决定语法高亮语言的因素。该值`cpp`是 C++ 文件使用的值。

编辑 2：没有模式行，如果你能识别一个神奇的模式，做更多的工作：

```
au BufRead * if search('MagicPattern', 'nw') | setlocal ft=cpp | endif 
```

含义：每次打开文件时，检查是否`"MagicPattern"`在其中。如果是，则将其视为 C++。模式参数是正则表达式的vim方言；检查`help pattern`详情。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-01T13:32:25.120

使用默认的 vim 设置，将其添加到文件顶部以让 vim 选择文件类型：

```
/* vim: set filetype=cpp: */ 
```

如果您使用其他语言，请进行相应调整，例如：

```
# vim: set filetype=python: 
```

## modeline 与 modelines 澄清

在答案中，[https://stackoverflow.com/a/10584645](https://stackoverflow.com/a/10584645)，

```
set modeline=5 
```

应该：

```
set modelines=5 
```

请参阅文档：[https](https://stackoverflow.com/a/10584645) ://stackoverflow.com/a/10584645 。具体来说，*modeline*是一个布尔启用标志，默认打开[http://vimdoc.sourceforge.net/htmldoc/options.html#%27modeline%27](http://vimdoc.sourceforge.net/htmldoc/options.html#%27modeline%27)，*modelines*采用整数参数（在任何情况下默认为 5）设置如果启用了模式行，*则要*查看的行数[http://vimdoc.sourceforge.net/htmldoc/options.html#%27modelines%27](http://vimdoc.sourceforge.net/htmldoc/options.html#%27modelines%27)。

OP 对这些都不感兴趣，但我在此处添加它以供任何通过搜索到达的人提醒自己如何告诉 vim 文件顶部的文件类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-24T14:44:24.257

寻找解决方案，我还找到了这个答案，如果您想将特定文件扩展名设置为标准文件扩展名的同义词，这是完美的：

[https://vi.stackexchange.com/a/5203/31568](https://vi.stackexchange.com/a/5203/31568)

例如，在我的情况下，我使用扩展名`.icc`来存储 C++ 方法的内联定义，并按照上面链接的答案，我可以将`icc`扩展名分配给`cpp`自定义`filetype.vim`文件中的语言：

```
" My own filetype file
" where I define custom filetypes/extensions
"
if exists("did_load_filetypes")
    finish
endif
augroup filetypedetect
    au! BufRead,BufNewFile *.icc       setfiletype cpp
augroup END 
```

# jsp - 在 Struts 2 中显示 LinkedHashMap

> ID：10584582
> 
> 赞同：0
> 
> 时间：2012-05-14T13:46:31.323
> 
> 标签：jsp, struts2

我在jsp中有一张地图

```
<s:set name="answer" value="#{0:'No', 1:'Yes', 2:'Maybe' }"/> 
```

如何使用密钥访问答案图？

```
<s:property value="?"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:25:37.657

尝试这个

```
<s:set name="answer" value="#{'0':'No', '1':'Yes', '2':'Maybe' }"/>
   <s:property value="#answer['1']"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:09:25.380

*编辑：对不起，在移动设备上读错了。*

```
#theMap[theKey] 
```

使用创建`<s:set>`的变量是命名变量，必须使用前导`#`.

# java - SortedSet 或 sorted Collection

> ID：10584584
> 
> 赞同：3
> 
> 时间：2012-05-14T13:46:46.843
> 
> 标签：java, list, sorting, collections, sortedset

假设一个应用程序产生了许多`HashMap<String, MyClass>`数据结构，每个数据结构都包含几十到几百个`Comparable`类型的对象`MyClass`，这些对象需要以单个和排序的形式结束`Collection`。

此功能的两种可能实现返回 SortedSet 或 sorted List，如下所示：

```
public static Set<MyClass> getSortedSet(HashMap<String, MyClass>... allMaps)
{
    SortedSet<MyClass> set = new TreeSet<MyClass>();

    Collection<MyClass> c;

    for (HashMap<String, MyClass> map:allMaps)
    {
        c = map.values();
        set.addAll(c);
    }

    return set;
}

public static List<MyClass> getSortedList(HashMap<String, MyClass>... allMaps)
{
    List<MyClass> list = new ArrayList<MyClass>();

    Collection<MyClass> c;

    for (HashMap<String, MyClass> map:allMaps)
    {
        c = map.values();
        list.addAll(c);
    }

    Collections.sort(list);

    return list;
} 
```

以上两种方法中的任何一种都会有明显的性能优势吗？

是否有更快的方法来实现相同的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:00:38.260

您的排序列表方法存在一些问题：

ArrayLists 由数组支持。每当您添加一个新元素时，它可能必须在幕后增加数组。如果您想使用这种方法，您应该事先创建适当大小的 ArrayList。

添加所有元素后的排序似乎不是最佳的。为什么不将元素添加到列表中的正确位置？（使用排序集合然后变成列表）[Java 的一个好的排序列表](https://stackoverflow.com/questions/2661065/a-good-sorted-list-for-java)

为了真正回答您的问题，我将采用在幕后使用 TreeSet 的方法。因为，如果用户想要，他们总是可以做 Set.toArray() 然后有一个列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T13:51:04.607

从某种意义上说，集合和列表的性质不同，集合不保留重复项。您只能拥有一个对象的一个​​实例。列表允许您保留重复项。

因此，集合做更多的工作，因此它们更慢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T13:55:55.237

> 有没有理由假设一种实现总是比另一种更快？

不，没有理由假设。

哪个更快可能取决于数据量、属性、比较器的性能特征、JDK、JIT 编译器等。

唯一可以确定的方法是在实际数据上对代码进行基准测试。

# javascript - 将正则表达式保存的值作为数组索引传递

> ID：10584585
> 
> 赞同：1
> 
> 时间：2012-05-14T13:46:48.890
> 
> 标签：javascript, regex

我需要替换`[link]0[/link]`为`<a href=...`

现在，链接保存在一个数组中`links`，里面的数字`[link][/link]`是指向`links`索引的指针。

我正在尝试下一步：

```
txt.replace( /\[link\](\d+)\[\/link\]/ , "<a href='" + links[ THE_INDEX ][ 0 ] + "' target='_blank'>" + ( links[ THE_INDEX ][ 1 ] || links[ THE_INDEX ][ 0 ] ) + "</a>" ); 
```

但我不知道如何传递保存的值。你能帮我解决吗？

PS我知道我可以制作循环并使用`exec()`来保存价值并传递它，但我想知道，是否可以像我上面所说的那样做。

### 一个更简单的期望示例

```
my_array = [ "data1", "data2", "data3" ];

"xxx1xxx".replace( /xxx(\d+)xxx/, "my_data=" + my_array[ THE_MATCH ] ); // should be "my_data=data1"
"xxx3xxx".replace( /xxx(\d+)xxx/, "my_data=" + my_array[ THE_MATCH ] ); // should be "my_data=data3" 
```

`THE_MATCH`从正则表达式匹配中获取的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:21:42.040

找到了解决方案：

```
function replacer(str, p1, p2 ){
    return "<a href='" + links[ p1 ] + "'></a>"
}
var newString = "XXzzzz".replace(/(X*)(z*)/, replacer) 
```

而`replacer()`作为 p1 传递的值，p2 是匹配的值。`p`参数的数量`replacer()`需要作为匹配值的数量。

# vb.net - 该进程无法访问该文件，因为它正在被 vb.net 中的另一个进程使用

> ID：10584586
> 
> 赞同：1
> 
> 时间：2012-05-14T13:46:49.170
> 
> 标签：vb.net

帮帮我..我是Visual Basic的新手....

当我运行更新时，它显示错误进程无法访问文件'C:\Documents and Settings\Macky\My Documents\Visual Studio 2008\Projects\Marcelo 2.2.3\Marcelo\bin\Debug\Students\MIC953867 .jpg'，因为它正被另一个进程使用。

我的代码是这个

```
Public Sub copingfile()
    If inFileName = Nothing Then
        studpic.Image = Nothing
    Else
        outFileName = inFileName
        pos = inFileName.LastIndexOf(".")
        If (pos > 0) Then
            outFileName = outFileName.Substring(0, pos)
        End If
        outFileName += ".jpg"
        str = Application.StartupPath & "\Students\"
        saveJPEGFile.FileName = str & StudID.Text & ".jpg" '& outFileName
        fil1.Copy(inFileName, saveJPEGFile.FileName, True) 'the error shows here...
        outFileName = saveJPEGFile.FileName()
    End If

End Sub 
```

我可以用图片保存新的学生信息..但是在更新图片时这些代码不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:29:48.623

```
 fil1.Copy(inFileName, saveJPEGFile.FileName, True) 
```

您正在尝试覆盖已打开或正在使用的文件。如果文件在查看器/编辑器中打开，则无法复制。要么你手动打开它，要么通过代码打开它，它仍然“附加”到正在运行的东西上。

如果它没有在窗口中打开，请尝试停止您的代码并手动删除该文件。如果可以的话，很明显，当您到达出错的行时，代码中的某些内容仍在使用它。您需要弄清楚该文件仍在使用的位置（在某处打开流？在 VS 中打开，本身？），因为它似乎不在您提供的代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:18:49.447

您将需要显示更多代码，您使用的变量不在代码清单中。另外，您不会显示最初保存图像的代码。

但这是我的猜测……您确定在第一次保存文件时关闭了文件吗？您通常不能复制到或从打开的文件中复制。

（文件可以作为共享打开，但我不认为你这样做）。

如果有机会，请发布更多代码。

# performance - 移动应用程序 UI 性能 - RhoMobile Rhodes 与 PhoneGap

> ID：10584587
> 
> 赞同：1
> 
> 时间：2012-05-14T13:46:52.480
> 
> 标签：performance, cordova, flicker, rhomobile, rhodes

有没有人同时使用 Rhodes 和 PhoneGap 的经验？

我尝试使用两个 Android 框架构建相同的“Hello World”-App，并在运行 Android 2.3.3 的三星 Galaxy S 设备上对其进行了测试。

在这两种情况下，我都使用 HTML5 和 jQuery Mobile（在同一版本中）来设计 UI。

该应用程序只在“主页”页面上提供一个链接，该链接使用幻灯片过渡到第二页。Rhodes 应用程序需要更长的时间才能启动，但在过渡到第二页时动画非常流畅。PhoneGap 应用程序闪烁不定。

你们中有人遇到过类似的行为吗？你能解决PhoneGap版本中的问题吗？差异可能在于 Rhodes / PhoneGap 使用的不同浏览器引擎 / WebViews 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T17:43:20.063

我不能给你一个好的答案，因为我自己对 Rhodes 和 Phonegap 还很陌生。我所知道的是，如果您[启用了 RhoElements](http://edgedocs.rhomobile.com/rhoelements/rhoelements2-native#enabling-motorola-device-capabilities)或[添加`motorola_browser`了功能](http://edgedocs.rhomobile.com/rhoelements/rhoelements2-native#enabling-motorola-webkit)，RhoMobile 将使用摩托罗拉自己构建的 WebKit 。

如果您的 Rhodes 应用程序使用的是摩托罗拉的 Webkit，我想自定义 Webkit 构建可能已针对渲染 Rhodes 生成的内容以及其[EMML](http://en.wikipedia.org/wiki/EMML_%28Motorola%29)和所有内容进行了优化。当然，这只是猜测。

然而，Phonegap 依赖于系统的浏览器及其在性能方面提供的功能。AFAIK，它基本上是 iOS 上的 UIWebView 对象。

使用摩托罗拉 Webkit 的一个非常好的好处是，您只需一个浏览器即可在所有平台上工作。（至少在理论上，我还没有测试过渲染引擎在平台之间的实际一致性。）

总而言之，Rhodes/RhoMobile 在纸面上听起来很棒。我只是希望它能不辜负我的期望。您的“Hello world”测试可能只是 Phonegap 的侥幸，也可能意味着摩托罗拉的 Webkit 确实表现更好。我想我迟早会知道的。

# android - FFmpeg 为 Android 编译（配置、制作）

> ID：10584589
> 
> 赞同：3
> 
> 时间：2012-05-14T13:46:59.953
> 
> 标签：android, android-ndk, ffmpeg

我想为 Android 版本编译 ffmpeg。
但是每次我尝试，我都无法编译ffmpeg的源代码。
我认为我的配置选项可能无效。

我使用这个脚本进行配置。

```
#!/bin/sh
NDK_PATH=$HOME/android-ndk-r8
PREBUILT=$NDK_PATH/toolchains/arm-linux-androideabi-4.4.3/prebuilt/darwin-x86

LDFLAGS="-Wl,-T,$PREBUILT/armelf_linux_eabi.x -Wl,-rpath-link=$NDK_PATH/platforms/android-8/arch-arm/usr/lib \
     -L$NDK_PATH/platforms/android-8/arch-arm/usr/lib -nostdlib $PREBUILT/lib/gcc/arm-linux-androideabi/4.4.3/crtbegin.o \
     $PREBUILT/lib/gcc/arm-linux-androideabi/4.4.3/crtend.o -lc -lm -ldl"
COMMON_CONFIG="\
          ./configure --target-os=linux \
          --arch=arm \
          --enable-cross-compile \
          --cc=$PREBUILT/bin/arm-linux-androideabi-gcc \
          --as=$PREBUILT/bin/arm-linux-androideabi-gcc \
          --cross-prefix=$PREBUILT/bin/arm-linux-androideabi- \
          --sysinclude=$NDK_PATH/platforms/android-8/arch-arm/usr/include \
          --nm=$PREBUILT/bin/arm-linux-androideabi-nm \
          --extra-ldflags=\"$LDFLAGS\" \
          --extra-cflags=-I$NDK_PATH/platforms/android-8/arch-arm/usr/include \

eval "$COMMON_CONFIG"
if [ $? -ne 0 ]; then
  exit 1
fi 
```

我必须给编译器一个新的头文件路径（通过--extra-cflags），因为当我输入'make'时，编译器不知道头文件在哪里（比如math.h，ctime.h）

使用此脚本配置并键入“make”后，我收到了这些错误。

```
CC  libavdevice/alldevices.o
In file included from /Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/stdlib.h:42,
             from ./libavutil/common.h:35,
             from ./libavutil/avutil.h:126,
             from libavdevice/avdevice.h:22,
             from libavdevice/alldevices.c:22:
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/strings.h:49: warning: redundant redeclaration of 'index'
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/string.h:47: note: previous declaration of 'index' was here
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/strings.h:50: warning: redundant redeclaration of 'strcasecmp'
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/string.h:57: note: previous declaration of 'strcasecmp' was here
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/strings.h:51: warning: redundant redeclaration of 'strncasecmp'
/Users/gyeongmingim/android-ndk-r8/platforms/android-8/arch-arm/usr/include/string.h:58: note: previous declaration of 'strncasecmp' was here
In file included from ./libavutil/internal.h:178,
             from ./libavutil/common.h:342,
             from ./libavutil/avutil.h:126,
             from libavdevice/avdevice.h:22,
             from libavdevice/alldevices.c:22:
./libavutil/libm.h:62: error: static declaration of 'lrint' follows non-static declaration
./libavutil/libm.h:69: error: static declaration of 'lrintf' follows non-static declaration
./libavutil/libm.h:76: error: static declaration of 'round' follows non-static declaration
./libavutil/libm.h:90: error: static declaration of 'trunc' follows non-static declaration
make: *** [libavdevice/alldevices.o] Error 1 
```

有什么问题？
我的配置有错误的信息吗？或任何丢失的标志？

操作系统：Mac Lion
Android-ndk 版本：android-ndk-r8

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:54:50.510

我不知道您的配置，但我能够在 Ubuntu 下（或在 Windows 下运行 Ubuntu 的 Oracle VM Virtual Box 下）使用来自[bambuser](http://bambuser.com/opensource)（最新版本）的脚本编译 FFMPEg。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-11T16:27:02.327

我在 Mac 上编译 FFmpeg 时遇到了同样的问题。解决方法是：

编辑`config.h`（是的，它是由配置生成的）并将所有`lrint`和设置`friends`为`1`. 例如：`#define HAVE_LRINT 1`

这将允许构建继续。

如果重新运行`configure`，则需要`config.h`再次进行编辑。

# sql - where 中的操作顺序

> ID：10584590
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:04.037
> 
> 标签：sql, tsql, sql-order-by

这是我的sql

```
SELECT * FROM Answers
WHERE QuesID = 1 AND OptionID IN (2,5) AND CONVERT(float, ISNULL(AnswerValue, 0)) < 300 
```

问题是 OptionID = 6 中有旧数据是字符串。当我运行上述查询时，它给了我

> 将数据类型 varchar 转换为浮点数时出错。

我确认 QuesID=1 和 OptionId IN (2,5) 中的所有数据都是浮点数据。似乎 SQL 是先做这个 sql 的数学部分，有没有让它在运行 AnswerValue 比较之前检查 OptionID？还是我完全不在基地？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:58:08.663

您无法真正控制 SQL 将“解析”子句中的`WHERE`子句的顺序。我做了一些快速测试，如果只为 QuesId=3 输入了一个字符串值，它就起作用了。

所以，是的，正如你在我写这篇文章时发布的那样，折腾

```
AND isnumeric(AnswerValue) = 1 
```

将处理此问题，因为 SQL 似乎在其过程中较早地对其进行评估。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:56:30.397

想通了，我只是将 ISNUMERIC 添加到 SQL 中，然后就解决了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:14:23.793

如果`CASE`搜索条件匹配，表达式只会评估其结果表达式，因此您可以尝试：

```
SELECT * FROM Answers
WHERE
    CASE WHEN QuesID = 1 AND OptionID IN (2,5) THEN
        CONVERT(float, ISNULL(AnswerValue, 0))
    ELSE
        500
    END < 300 
```

对于更复杂的表达式，您可以选择使用嵌套`CASE`表达式来执行更多逻辑 - 通常，这将导致您表达所有条件并使结果等于`0`or `1`，然后执行最终的外部比较`1`：

```
WHERE
1 = CASE WHEN <Condition 1> THEN
        CASE WHEN <Condition 1, Subcondition 1> THEN 0
             WHEN <Condition 1, Subcondition 2> THEN 1
        END
         WHEN <Condition 2> THEN
        CASE WHEN <Condition 2, Subcondition 1> THEN 1
             WHEN <Condition 2, Subcondition 2> THEN 0
        END
    END 
```

仅当为真`Condition 1`时才会评估两个子条件（对于也是如此）`Condition 1``Condition 2`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:55:49.527

如果升级到 SQL Server 2012，则可以使用 TRY_CONVERT。它是专有的，但它确实解决了问题。

```
SELECT * FROM Answers
WHERE QuesID = 1
AND TRY_CONVERT(int,OptionID) IN (2,5)
AND CONVERT(float, ISNULL(AnswerValue, 0)) < 300 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T14:46:16.177

如果您想保证操作的顺序，并且性能不是那么重要，您可以声明一个表变量来存储前两个条件的结果，然后根据最终条件过滤临时表。例如

```
declare @tempAnswers table (quesID int, optionid int, answervalue varchar(50))

insert into @tempAnswers
select * 
from Answers
where QuesID = 1 and OptionID in (2,5) 

select * from @tempAnswers
where convert(float, isnull(AnswerValue, 0)) < 300 
```

# iphone - 在 iOS 上识别我的不带文件扩展名的 mime 类型

> ID：10584591
> 
> 赞同：3
> 
> 时间：2012-05-14T13:47:05.613
> 
> 标签：iphone, ios, mime-types

我正在编写一个需要识别我的自定义 mime 类型的应用程序，以便在从服务器下载此类文件时启动我的应用程序。我在如何将[文件类型与 iPhone 应用程序关联？](https://stackoverflow.com/questions/2774343/how-do-i-associate-file-types-with-an-iphone-application)*当且仅当*我的 plist 部分中还指定了文件的扩展名`UTExportedTypeDeclarations / UTTypeTagSpecification`并且服务器为具有相同扩展名的文件提供服务时，它才能正常工作。如果服务器使用不同的扩展名提供文件，或者 plist 中未指定扩展名*但*mime-type 匹配，则会发生以下情况：

浏览器（或接收文件的应用程序）显示我的文件类型的正确图标和正确的 [Open in myApplication] 按钮，但单击该按钮没有任何作用，我的应用程序没有启动，如果它正在运行，则没有`application:openURL:sourceApplication:annotation:`消息发送。

有什么方法可以编写仅基于 mime 类型的文件类型识别器，而不需要特定的文件扩展名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T14:24:25.157

这已经得到回答，你想使用 NSURLRequest，这将允许你访问 mimeType，你可以根据需要使用它来确定文件扩展名。完整代码和其他提示和技巧可在这篇文章中找到：

[https://stackoverflow.com/a/1401918/728261](https://stackoverflow.com/a/1401918/728261)

# javascript - 数组循环 - 处理下拉列表中的空值

> ID：10584592
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:06.413
> 
> 标签：javascript, arrays, google-maps, loops, jquery-selectors

我需要通过数组进行此循环的帮助。现在我有 3 个下拉菜单。我试图遍历我的数组，并说如果下拉菜单中的值与数组中的值匹配，然后运行一个函数（在我的地图上绘制标记）。这一切都有效。

除了，所有 3 个下拉菜单当前都必须匹配一个值，我怎么能说如果一个值匹配，其余的是 null 绘制所有这些位置？那有意义吗？我需要考虑 1 个或 2 个甚至 3 个未选择的下拉菜单。如果您需要查看更多代码，请告诉我。

```
for (var i = 0; i <mymarkers.length; i++) {
    if (mymarkers[i].type==type&&mymarkers[i].day==day&&mymarkers[i].time==time){
        mymarkers[i].setMap(MYMAP.map);
    }else{
        mymarkers[i].setMap(null);
    }
} 
```

这可能不是具体的地图问题，而是与我完成位置地图有关的问题。这是一个链接： http: [//mycwebdesign.com/meetings.php](http://mycwebdesign.com/meetings.php)。如果您选择“MA”、“Friday”和“Late”，您将看到它有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:10:32.140

对于具有属性的任何标记，您想要的是其属性与所选属性匹配（`true`将其放在地图上）或所选属性为`--`，因此测试也是`true`。

```
if ((mymarkers[i].type==type || type=='--') &&
    (mymarkers[i].day==day   || day =='--') &&
    (mymarkers[i].time==time || time=='--')) { 
```

如果`type=='--'`那么它无关紧要`mymarkers[i].type`：该测试将是`true`.

您可能需要将上面的三行代码全部放在一行上。拆分后更容易看到这里发生了什么。

# android - 如何使用 Android SDK 撤销所有 Facebook 权限？

> ID：10584593
> 
> 赞同：3
> 
> 时间：2012-05-14T13:47:11.197
> 
> 标签：android, facebook-graph-api, facebook-android-sdk

我在使用 Android SDK 撤销 Facebook 权限时遇到问题。

在我的应用程序中有一个案例，我想撤销所有权限。根据 Facebook 文档，您可以使用 AsyncFacebookRunner 来执行此操作，并且“如果您不指定权限，那么这将完全取消对应用程序的授权。”

我目前正在这样做：

```
String method = "DELETE";
Bundle params = new Bundle();
params.putString("permission", "");

mAsyncRunner.request("/me/permissions", params, method, new RequestListener()
                     { ... }, null); 
```

使用这样的请求签名：

```
void request(String graphPath, Bundle parameters, final String httpMethod,
             RequestListener listener, final Object state) 
```

onComplete() 回调函数似乎恢复正常，但似乎没有取消对访问令牌的授权。我推断这是因为下次我调用 facebook.authorize() 时，它不会将用户推送到 Facebook 登录页面。

任何想法我需要更改以完全取消授权访问令牌？还是有不同/更好的方法来做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-01T05:19:25.600

对于希望在更高版本的 SDK/Graph API 中执行此操作的任何人 - 现在执行此操作的正确方法似乎如下所示[https://developers.facebook.com/docs/graph-api/reference/user/permissions /](https://developers.facebook.com/docs/graph-api/reference/user/permissions/)

```
new Request(
   session,
    "/me/permissions/{permission-to-revoke}",
    null,
    HttpMethod.DELETE,
    new Request.Callback() {
        public void onCompleted(Response response) {
            /* handle the result */
        }
    }
).executeAsync(); 
```

离开`/{permission-to-revoke}`第二个参数将撤销所有权限

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-05T14:25:53.503

您可以使用最新的 SDK（我的是 4.1.1）从用户 Facebook 帐户中删除整个应用程序（不仅是权限）

```
void deleteFacebookApplication(){
    new GraphRequest(AccessToken.getCurrentAccessToken(), "/me/permissions", null, HttpMethod.DELETE, new GraphRequest.Callback() {
        @Override
        public void onCompleted(GraphResponse response) {
            boolean isSuccess = false;
            try {
                isSuccess = response.getJSONObject().getBoolean("success");
            } catch (JSONException e) {
                e.printStackTrace();
            }
            if (isSuccess && response.getError()==null){
                // Application deleted from Facebook account
            }

        }
    }).executeAsync();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T01:07:24.680

从这篇文章中可以看出：[Facebook 取消我的应用程序](https://stackoverflow.com/questions/5781015/facebook-deauthorize-my-app)和其他应用程序的授权无法以编程方式取消对应用程序的授权。不幸的是，上面的调用成功返回到 onCreate() 但没有为用户删除/删除应用程序。

底线：看起来对应用程序进行认证的唯一方法是让用户直接在 Facebook 中进行。如果有人知道不同，请说出来-否则，请不要浪费时间尝试！谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T09:43:55.920

我正在使用问题中建议的代码，它完全取消了我的测试应用程序的授权。对其进行了多次测试，并且每个人都有效。

这也是官方 facebook 文档中建议的代码：[https](https://developers.facebook.com/docs/mobile/android/build/) ://developers.facebook.com/docs/mobile/android/build/ - 第 7 步

# php - PHP 类型转换混淆

> ID：10584596
> 
> 赞同：2
> 
> 时间：2012-05-14T13:47:15.897
> 
> 标签：php, types

我有以下代码：

```
<?php
    $val = 0;
    $res = $val == 'true';

    var_dump($res);
?> 
```

我一直认为 $res 应该是“假”，因为在上面的表达式中 PHP 会尝试将类型转换 $val 输入布尔类型（其中零将被转换为假）和字符串（非空字符串为真）。但是如果我执行上面的代码，输出将是：

```
boolean true 
```

我错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:48:40.427

在 PHP 中，所有非空、非数字字符串的计算结果为零，因此`0 == 'true'`为 TRUE，但`0 === 'true'`为 FALSE。该字符串`true`尚未转换为布尔值，而是作为*字符串*与零进行比较。零保留为 int 值，而不是转换为布尔值。所以最终你会得到：

```
// string 'true' casts to int 0
0 == 0 // true 
```

尝试这个：

```
echo intval('true');
// 0
echo intval('some arbitrary non-numeric string');
// 0 
```

查看[PHP 类型比较表](http://php.net/manual/en/types.comparisons.php)。一般来说，当在 PHP 中进行布尔比较并且类型不相同时（在这种情况下为 int 到 string），使用严格比较很有价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:51:13.567

尝试这个

```
<?php
    $val = 1;
    $res = (bool)$val == 'true';

    var_dump($res);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:49:04.130

因为`$val`是第一个运算符 PHP 将字符串转换`true`为整数，然后变成 0。结果 0 ==0 并且你的结果为真；

# database - 甲骨文死锁

> ID：10584598
> 
> 赞同：2
> 
> 时间：2012-05-14T13:47:24.470
> 
> 标签：database, oracle, deadlock

最近我每天随机看到一次或两次死锁，所以我查看了代码，我们将代码放在一个事务中。同时我想在 Oracle 上将 ini_trans 增加到 5，以便它可以处理并发访问。该应用程序正在使用“app_user”模式，该模式调用“app_admin”模式（app_admin 拥有该表），并且多个应用程序实例同时访问数据库。我应该增加 app_user 或 app_admin 或两者的 ini_trans 吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T03:13:08.870

[这里](https://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:3932525800346405986)描述了问题的可能原因。以下建议帮助了我：“*索引外键并且死锁消失*”。检查引用到您的表的外键，并尝试对它们进行索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:57:46.167

我认为您应该考虑修改的是 MAXTRANS，而不是 INITRANS，但在 10.2 及更高版本中，它已被弃用，默认情况下使用 255 的值。

有位图索引吗？它们有利于引起争论。

# android - HttpURLConnection readLine() 挂在 Sprint 4G 网络上

> ID：10584600
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:31.963
> 
> 标签：android, httpurlconnection, socket-timeout-exception

我有一个例程使用 HttpURLConnection 通过 multipart/form-data 内容类型上传文件。服务器对上传的文件进行一些处理并返回一个简短的响应代码。到目前为止，这在所有情况下都可以正常工作，除非一位用户在 4G 上使用 HTC Evo。如果用户切换到 3G，那么一切正常。当在 4G 上时，应用程序将等待`while ((line = reader.readLine()) != null) {`直到抛出套接字连接超时异常。我将连接超时设置为 70 秒。服务器在 php 这里是相关的片段

```
//all ob_ related entries were added because I found some info indicating
//that some clients would not acknowledge the response without the content-length header

ob_end_clean(); 
header("Connection: close");
ob_start();
...
//the response is one of either
echo "BACKGROUND"; //this one works!
//or
echo $rv //$rv = "1336757671374T37171FR"
//or
echo "FailedQA";

$size = ob_get_length();
header("Content-Length: $size");
ob_end_flush(); 
ob_flush();
flush();        
die();
?> 
```

请注意，“BACKGROUND”响应有效，其余响应会导致客户端等待超时异常。我目前对此有 2 个想法，但我不在 4G 领域，所以我只能通过最终用户进行测试，我真的想限制尝试次数。我的第一个想法是“BACKGROUND”比“FailedQA”稍长，而另一个更长，它有一个数字开头。所以也许在响应中添加空格会有所帮助？另一个方面是响应时间。'BACKGROUND' 消息通常比其他消息发送得更快。但是，我这里有一个反例，所以我不是陛下。示例：“BACKGROUND”消息通常会在 15 到 20 秒内消失。其他消息通常为 30-40 秒。但是，我有一个例子，其中 '

总结一下：这只发生在 Sprint 4G 上。我怀疑可能是导致问题的内容长度或响应时间，但在这两种情况下，我都有一个相反的反例。除了长度情况之外，较长的反例示例以数字开头，所以就是这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T17:58:58.883

这似乎是导致问题的响应之前的延迟。我使用本指南[Easy Parallel Processing in PHP](http://phplens.com/phpeverywhere/?q=node/view/254 "本指南")来设置多任务 php 配置。这样我就有了一个脚本，它只计算并回显经过的秒数，而另一个脚本则执行作业处理。现在问题已解决。

# ios - 使用 iOS Storyboard Seque“模型”或“推送”样式时是否存在内存泄漏（或对象过度实例化）？

> ID：10584601
> 
> 赞同：3
> 
> 时间：2012-05-14T13:47:34.917
> 
> 标签：ios, storyboard, push, modal-dialog

假设我正在开发一个带有两个屏幕的简单 iPhone 应用程序：登录和注册屏幕。在登录屏幕中，它具有进入注册屏幕的“注册”按钮。同样，在注册屏幕中，它具有进入登录屏幕的“登录”按钮。全部使用 iOS Storyboard Segue “Modal” 样式实现。

问题是：每次视图控制器以“模态”样式呈现时，是否会不断向堆栈添加新视图？那么，如果我在登录和注册屏幕之间反复切换，它是否会每次都实例化新对象并不断累积内部数组容器（即堆栈）？

此外，如果我将样式更改为“推”，那么类似问题的情况会如何？每次“推送”时，“推送”不会一直将新的视图对象添加到顶部吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:18:54.897

@trapper 是绝对正确的。你 segues 会将它们堆叠起来，但只要你`dismissViewControllerAnimated:completion:`用`popViewControllerAnimated:`. 如果您错误地将登录/注册屏幕切换回主视图，则不会释放该内存（从技术上讲，这不是泄漏，但这是错误的，您不会释放内存）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:53:06.857

是的，无论哪种方式，它都会继续堆叠它们。

只是为了澄清，它不会导致任何泄漏。

# jsf - 当我使用视图参数时，设置器不会被调用

> ID：10584604
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:47.567
> 
> 标签：jsf, jsf-2

我正在使用 JSF 2.1.1。我有一个用于发布国家/地区评论的示例 JSF 页面。我使用`f:viewparam`标签来选择国家页面。这是代码：

`country.xhtml`：

```
<f:metadata>
        <f:viewParam name="country" value="#{countryBean2.selectedCountry}" converter="countryConverter" />
    </f:metadata>

    <h:head>
        <title>Country</title>
    </h:head>

    <h:body>
        <h:form id="form">
            <h:outputText value="#{countryBean2.selectedCountry.countryName}" />
            <br/><br/>
            <h:outputText value="Comment:" />
            <h:inputText value="#{countryBean2.comment}" />
            <br/>
            <h:commandButton value="Send">
                <f:ajax  listener="#{countryBean2.sendComment}" render="form" />
            </h:commandButton>
        </h:form>
    </h:body> 
```

`CountryBean2.java`：

```
@Named("countryBean2")
@SessionScoped
public class CountryBean2 implements Serializable {
    private EntityCountry selectedCountry;
    private String comment;

    public EntityCountry getSelectedCountry() { return selectedCountry; }
    public void setSelectedCountry(EntityCountry newValue) { selectedCountry = newValue; }

    public String getComment() { return comment; }
    public void setComment(String newValue) { comment = newValue; }

    EntityManagerFactory emf = Persistence.createEntityManagerFactory("testPU");

    public void sendComment() {
        EntityManager em = emf.createEntityManager();
        try {
            FacesMessage msg = null;
            EntityTransaction entr = em.getTransaction();
            boolean committed = false;
            entr.begin();
            try {
                EntityCountryComment c = new EntityCountryComment();
                c.setCountry(selectedCountry);
                c.setComment(comment);
                em.persist(c);
                committed = true;
                msg = new FacesMessage();
                msg.setSeverity(FacesMessage.SEVERITY_INFO);
                msg.setSummary("Comment was sended");
            } finally {
                if (!committed) entr.rollback();
            }
        } finally {
            em.close();
        }
    }
} 
```

`CountryConverter.java`：

```
public class CountryConverter implements Converter {
    public static EntityCountry country = new EntityCountry();

    EntityManagerFactory emf = Persistence.createEntityManagerFactory("testPU");

    @Override
    public EntityCountry getAsObject(FacesContext context, UIComponent component, String value) {
        EntityManager em = emf.createEntityManager();
        Query query = em.createQuery("SELECT c FROM EntityCountry c WHERE c.countryName = :countryName")
                .setParameter("countryName", value);
        country = (EntityCountry) query.getSingleResult();
        return country;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value) {
        EntityCountry c = (EntityCountry) value;
        return c.getCountryName();
    }
} 
```

我可以成功打开一个国家页面（例如`http://localhost:8080/test/faces/country.xhtml?country=england`），但是当我尝试使用 发表评论时`commandButton`，`setComment`没有调用 setter 并且`comment`变量仍然存在`null`。我试图同时设置`immediate="true"`和`inputText`，`commandButton`它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:54:27.547

的`execute`属性`<f:ajax>`默认为`@this`当前组件。如果您想提交整个表单，那么您需要`@form`。也使用这个`render`。

```
<h:commandButton value="Send">
    <f:ajax execute="@form" listener="#{countryBean2.sendComment}" render="@form" />
</h:commandButton> 
```

# vhdl - FFd1 在 VHDL 中是什么意思 警告 FF/Latch 的常数值为 0

> ID：10584605
> 
> 赞同：1
> 
> 时间：2012-05-14T13:47:54.177
> 
> 标签：vhdl, xilinx

我正在尝试使用 xilinix 10.1 实现有限状态机标识符我在以前的问题中看到了这些错误，但答案不包括我的问题。我不是在寻找答案，而是在寻找 FFd1 部分的含义

产生以下错误

```
WARNING:Xst:1293 - FF/Latch <machine1/current_state_FFd1> has a constant value of 0 in block <Main>. This FF/Latch will be trimmed during the optimization process.
WARNING:Xst:1293 - FF/Latch <machine1/current_state_FFd2> has a constant value of 0 in block <Main>. This FF/Latch will be trimmed during the optimization process. 
```

这是我的代码

```
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_ARITH.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity M_1 is
    Port ( x : in  STD_LOGIC;
       clk : in  STD_LOGIC;
       state : out  integer range 0 to 5 := 0;
       z : out  STD_LOGIC );
end M_1;

architecture Behavioral of M_1 is

 type state_type is (A, B, C, D);
 signal next_state, current_state: state_type := A;

begin

process(clk) is
begin
if (clk = '1' and clk'event) then
    current_state <= next_state;
end if;
end process;

process(x,current_state)
begin
case current_state is
    when A =>
        if(x='0') then
            next_state <= B;
            z <='0';
        elsif(x='1') then
            next_state <= C;
            z <='1';            
        end if;
    when B =>
        if(x='0') then
            next_state <= C;
            z <='1';
        elsif(x='1') then
            next_state <= D;
            z <='0';            
        end if;
    when C =>
        if(x='0') then
            next_state <= A;
            z <='0';
        elsif(x='1') then
            next_state <= D;
            z <='1';            
        end if;
    when D =>
        if(x='0') then
            next_state <= B;
            z <='0';
        elsif(x='1') then
            next_state <= C;
            z <='0';            
        end if;
    end case;
end process;

process (current_State) is
begin
    case current_state is
    when A =>
        state <=0;
    when B =>
        state <=1;
    when C =>
        state <=2;
    when D =>
        state <=3;
    end case;
end process;

end Behavioral; 
```

谁能告诉我

*   current_state_FFd1 和 current_State_1 有什么区别？
*   我该如何解决这个错误？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T16:24:06.847

CAD 工具将“current_state”信号映射到 2 位触发器原语上。触发器看起来类似于[FD16CE 原语，如图所示](http://www.xilinx.com/support/documentation/sw_manuals/xilinx13_2/virtex6_scm.pdf#page=165)。

触发器将采用 2 个数据输入（current_state_FFd1 和 current_state_FFd2）和一个时钟，并产生两个数据输出（current_state_FFq1 和 current_state_FFq2）。输入确定在下一个时钟沿采样的 current_state 信号的值，输出反映当前状态。

您看到的消息表明 CAD 工具可以证明“current_state”永远不会从“00”编码（枚举类型中的“A”）改变，因此可以使用硬连线优化触发器“00”的输出。

您发布的 VHDL 看起来很合理——“x”输入的变化应该会导致 current_state 的变化。我敢打赌，“x”输入在更高级别的 VHDL（或您的测试台）中以某种方式硬连线到 0。

# android - 将对象绑定到列表视图

> ID：10584606
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:54.723
> 
> 标签：android, android-listview, adapter

我想将从 Web 服务获取的一些数据绑定到自定义列表视图...我的列表视图有一个图像视图和三个文本视图...

我读过的大多数教程都建议应该制作一个适配器类，所以我目前编写了一个如下所示的适配器：

```
public class InboxAdapter extends BaseAdapter {

    private Context context;

    private List<MailInbox> mails;

    public InboxAdapter(Context context, List<MailInbox> mails)
    {
        this.context = context;
        this.mails = mails;
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return mails.size();
    }

    @Override
    public Object getItem(int item) {
        // TODO Auto-generated method stub
        return mails.get(item);
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup viewGroup) {

        MailInbox entry = mails.get(position);

        if(convertView == null)
        {
            LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = inflater.inflate(R.layout.mail_list_row, null);
        }

        ImageView mailImg = (ImageView)convertView.findViewById(R.list.mail_thumb);
        //Set the appropriate image - either unread or read

        TextView author = (TextView)convertView.findViewById(R.list.mail_text);
        TextView body = (TextView)convertView.findViewById(R.list.mail_detail);
        TextView date = (TextView)convertView.findViewById(R.list.mail_date);

        author.setText(entry.AuthorName);
        body.setText(entry.MessageBody);
        date.setText(entry.CreatedAt);

        return convertView;
    }
} 
```

所以这是我卡住的部分。我现在有一个适配器，但我不完全确定如何使用它......

在具有列表视图的活动中：

更新：

好的，所以我正在尝试像这样填充适配器：

```
private void setUpList()
{
    list = (ListView)findViewById(R.id.mail_list);      

    final List<MailInbox> mails = new ArrayList<MailInbox>();

    for(int i = 0; i < mMessages.myMail.size(); i++)
    {
        MailInbox inbox = new MailInbox();

        inbox.setProperty(0, mMessages.myMail.get(i).CreatedAt);
        inbox.setProperty(1, mMessages.myMail.get(i).MessageBody);
        inbox.setProperty(3, mMessages.myMail.get(i).AuthorName);
        inbox.setProperty(4, mMessages.myMail.get(i).IsRead);//used to determine the image that will be in the imageview

        mails.add(inbox);
    }

    // Just to check if it's added properly - it outputs 5
    int length = mails.size();
    System.out.println("Size: " + length);

    InboxAdapter adapter = new InboxAdapter(this, mails);

    list.setAdapter(adapter);
} 
```

但是在 list.setAdapter(adapter) 上，我得到一个 Nullpointer 异常

整个错误：

```
05-14 17:43:17.855: E/AndroidRuntime(976): FATAL EXCEPTION: main
05-14 17:43:17.855: E/AndroidRuntime(976): java.lang.NullPointerException
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.cim.daycare.InboxActivity.setUpList(InboxActivity.java:67)
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.cim.daycare.InboxActivity.access$2(InboxActivity.java:43)
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.cim.daycare.InboxActivity$GetMails.onPostExecute(InboxActivity.java:96)
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.cim.daycare.InboxActivity$GetMails.onPostExecute(InboxActivity.java:1)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.os.AsyncTask.finish(AsyncTask.java:417)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.os.Looper.loop(Looper.java:123)
05-14 17:43:17.855: E/AndroidRuntime(976):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-14 17:43:17.855: E/AndroidRuntime(976):  at java.lang.reflect.Method.invokeNative(Native Method)
05-14 17:43:17.855: E/AndroidRuntime(976):  at java.lang.reflect.Method.invoke(Method.java:507)
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-14 17:43:17.855: E/AndroidRuntime(976):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-14 17:43:17.855: E/AndroidRuntime(976):  at dalvik.system.NativeStart.main(Native Method) 
```

从做一些谷歌，听起来问题可能出在xml文件上......我有两个xml，一个叫做mail_list，一个叫做mail_list_row......

列表：

```
<?xml version="1.0" encoding="utf-8"?>
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mail_list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="2"
    android:drawSelectorOnTop="false" >    
</ListView> 
```

排：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="48dip"
    android:background="@drawable/listselector"
    >
    <ImageView
        android:id="@+list/mail_thumb"
        android:layout_width="30dip"
        android:layout_height="30dip"
        android:layout_centerVertical="true"
        android:layout_alignParentLeft="true"
        android:contentDescription="@string/imgdesc"
        />
    <TextView
        android:id="@+list/mail_text"
        android:layout_toRightOf="@+list/mail_thumb"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="14dip"
        android:layout_marginLeft="8dip"
        android:layout_centerVertical="false"
        android:singleLine="true"
        android:ellipsize="end"
        android:textStyle="bold"
        android:textColor="@android:color/white"
        />
    <TextView 
        android:id="@+list/mail_detail"
        android:layout_toRightOf="@+list/mail_thumb"
        android:layout_below="@+list/mail_text"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:textSize="12dip"
        android:layout_marginLeft="8dip"
        android:layout_centerVertical="false"
        android:singleLine="true"
        android:ellipsize="end"
        android:textColor="@color/grey"     
        />
    <TextView 
        android:id="@+list/mail_date"
        android:layout_toRightOf="@+list/mail_detail"
        android:layout_below="@+list/mail_text"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:textSize="12dip"
        android:singleLine="true"
        android:ellipsize="end"
        android:textColor="@color/grey"
        android:layout_alignParentRight="true"      
        />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:52:18.920

在 setUpList 方法中，您将要使用的数据传递给适配器。

然后构造函数将它们的集合分配给适配器内的集合。getView 然后提取相关数据（1 x 1）并将其放入视图的正确元素中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:55:12.220

尝试类似的东西

```
private void setUpList()
{
    list = (ListView)findViewById(R.id.mail_list);
     InboxAdapter adapter=new InboxAdapter(this,YourArrayList);
    list.setAdapter(adapter);
} 
```

# excel - 打开 xls 文件并启用保存模式并使用 C# 保存

> ID：10584607
> 
> 赞同：0
> 
> 时间：2012-05-14T13:47:59.873
> 
> 标签：excel, c#-4.0

我从网站下载了一个 xls 文件，我需要转换为 csv 以便进一步解析。我使用第 3 方库来执行此操作，但 xls 文件不会打开。但是在我用excel打开文件并手动保存后，它就可以工作了。我不确定发生了什么。有人可以让我知道如何编写 ac# 代码以在 Excel 中打开 xls 并启用保存、保存并关闭它吗？如果我能以编程方式做到这一点，我就准备好了。

# position - wpLicese 页面检查 ScrollBars 位置是否为最大值（Inno Setup）

> ID：10584610
> 
> 赞同：3
> 
> 时间：2012-05-14T13:48:12.340
> 
> 标签：position, scrollbar, inno-setup

是否可以在 Inno Setup 的 wpLicense 页面中检查 ScrollBar 的位置，而无需编写自定义备忘录页面？

例如

```
procedure CurPageChanged(CurPageID: Integer);
 begin

     if CurPageID = wpLicense then
        WizardForm.LicenseAcceptedRadio.Enabled := False;
        WizardForm.LicenseNotAcceptedRadio.Enabled := False;

     if ScrollBar.Position := ScrollBar.Max then
        WizardForm.LicenseAcceptedRadio.Enabled := True;
        WizardForm.LicenseNotAcceptedRadio.Enabled := True;
  end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:07:22.380

无法直接访问这些滚动条，但是您可以通过[`GetScrollInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787583%28v=vs.85%29.aspx)以下方式使用该功能：

```
[code]
const
  SB_VERT = 1;
  SIF_RANGE = 1;
  SIF_POS = 4;
  SIF_PAGE = 2;

type
  TScrollInfo = record
    cbSize: UINT;
    fMask: UINT;
    nMin: Integer;
    nMax: Integer;
    nPage: UINT;
    nPos: Integer;
    nTrackPos: Integer;
  end;

function GetScrollInfo(hWnd: HWND; BarFlag: Integer; 
  var ScrollInfo: TScrollInfo): BOOL;
  external 'GetScrollInfo@user32.dll stdcall';

procedure CurPageChanged(CurPageID: Integer);
var
  ScrollInfo: TScrollInfo;
begin
  if CurPageID = wpLicense then
  begin
    ScrollInfo.cbSize := SizeOf(ScrollInfo);
    ScrollInfo.fMask := SIF_RANGE or SIF_POS or SIF_PAGE;
    if GetScrollInfo(WizardForm.LicenseMemo.Handle, SB_VERT, ScrollInfo) then
      if ScrollInfo.nPos = ScrollInfo.nMax - ScrollInfo.nPage then
        MsgBox('You are at the end of the license!', mbInformation, MB_OK);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T07:53:21.763

这就是我现在所拥有的。它有效，但是如果您发现任何问题，请说我喜欢的评论。

```
procedure OnScrollPosition(Wnd: HWND; Msg: UINT; TimerID: UINT_PTR; 
  SysTime: DWORD);
  var
    ScrollInfo: TScrollInfo;
begin
  ScrollInfo.cbSize := SizeOf(ScrollInfo);
  ScrollInfo.fMask := SIF_RANGE or SIF_POS or SIF_PAGE;
    if GetScrollInfo(WizardForm.LicenseMemo.Handle, SB_VERT, ScrollInfo) then
       if ScrollInfo.nPos = ScrollInfo.nMax - ScrollInfo.nPage then
          begin
            WizardForm.LicenseAcceptedRadio.Enabled := True;
            WizardForm.LicenseNotAcceptedRadio.Enabled := True;
          end;
end;

procedure ScrollPosition();
var
  TimerCallback: LongWord;
begin
  TimerCallback := WrapTimerProc(@OnScrollPosition, 4);
  TimerID := SetTimer(0, 0, 500, TimerCallback);
end;

procedure CurPageChanged(CurPageID: Integer);
var
  ScrollInfo: TScrollInfo;
begin
   if CurPageID = wpInstalling then
     StartSlideTimer
   else
     KillSlideTimer;
if CurPageID = wpLicense then
  WizardForm.LicenseAcceptedRadio.Enabled := False;
  WizardForm.LicenseNotAcceptedRadio.Enabled := False;
  ScrollPosition
end; 
```

# jquery - 强制 LI 在其包含的 IMG 旁边调整宽度

> ID：10584614
> 
> 赞同：0
> 
> 时间：2012-05-14T13:48:25.610
> 
> 标签：jquery, scroll, html-lists, image

我正在构建一个看起来像的水平滚动画廊

```
<ul class='scroll'>
<li class='img'>
<img/>
</li>
</ul>
<li class... 
```

支持的 CSS 如下所示：

```
.img {
float: left;
display: inline;
height:90%;
width:auto;
}

.scroll {
    display:block;
    max-height:800px; 
    height:100%
}

.img img {
    margin:5px 10px;
    float:left;
    max-height:100%;
    height:auto;
    width:auto;
} 
```

目前它工作得很好。加载图像时调整大小并最大为 800px 高度。然而，真正困扰我的是，当我将窗口调整为更小（或从更小到更大）时，li.img 不会随图像一起调整大小，这意味着你会留下巨大的白色边框或重叠的图像。

如果我用 chrome 中的 INSPECT ELEMENT 选择图像，它就会神奇地跳到位。

我想知道是否有一个 JQUERY 解决方案可以强制浏览器在调整大小时重新绘制 LI 标记（就像打开 Inspector 一样），或者以任何其他方式将 LI 锁定到包含的 IMG 宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:22:05.003

你可以使用

```
$(window).resize(function(){
  ...
}); 
```

并调用一个计算正确高度的函数。

# .net - 如何将 FrameworkElement 保存为非常大的光栅图像？

> ID：10584615
> 
> 赞同：1
> 
> 时间：2012-05-14T13:48:26.563
> 
> 标签：.net, wpf, image, bitmap, frameworkelement

我必须将我的[FrameworkElement](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.aspx)保存为非常大的光栅图像。现在我以这种方式使用[RenderTargetBitmap](http://msdn.microsoft.com/en-us/library/ms653503%28v=vs.90%29)类和[BitmapEncoder](http://msdn.microsoft.com/en-us/library/ms619208%28v=vs.90%29)：

```
RenderTargetBitmap bmp = new RenderTargetBitmap(ElementWidth, ElementHeight, 
     90, 96, PixelFormats.Default);

bmp.Render(MyElement);  // OutOfMemoryException here

PngBitmapEncoder encoder = new PngBitmapEncoder();
encoder.Frames.Add(BitmapFrame.Create(bmp));

using (var stream = File.Create(filePath))
{ encoder.Save(stream); } 
```

其中 ElementWidth 和 ElementHeight 是大数字（大约 10000x6000）。但是使用此解决方案时，当我尝试[渲染](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.rendertargetbitmap.render%28v=vs.90%29)我的元素时会出现 OutOfMemoryException。

还有其他方法可以满足我的需要（不会导致 OutOfMemoryException）？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:41:58.757

在这种情况下，您将不得不在图块中呈现 FrameworkElement。执行此操作的最简单方法是将[Clip](http://msdn.microsoft.com/en-us/library/system.windows.uielement.clip.aspx)属性设置为要渲染的图块的位置/大小，然后使用图块大小的 RenderTargetBitmap 的实例将该块放在磁盘上。现在你可以

1.  保持原样并在某种[深度缩放类型的平铺渲染器中使用它们](http://www.codeproject.com/Articles/128695/Deep-Zoom-for-WPF)
2.  [使用ImageMagick 的命令行](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=11320)/[大图像支持](http://www.imagemagick.org/script/architecture.php#tera-pixel)将它们全部组合（请注意，如果它们不适合内存以首先渲染，您也无法将它们全部加载以进行组合）或通过解析文件自己完成格式，然后写入正确的输出文件。

当然，我不知道选项 2 是否有任何帮助，因为即使您确实编写了巨大的输出文件 - 任何人将如何加载它？:)

希望这可以帮助！

# r - 如何根据索引将函数应用于多维数组

> ID：10584617
> 
> 赞同：3
> 
> 时间：2012-05-14T13:48:34.977
> 
> 标签：r, multidimensional-array, indices

我有一个 4 维数组，我想用作为输入函数的值填充插槽。通过搜索这里的论坛，我发现函数“outer”对 2x2 矩阵很有帮助，但不能应用于一般的多维数组。有什么东西可以比下面的代码更有效地在 R 中实现这一点？

```
K <- array(0,dim=c(2,2,2,2)) #dimensions will be much larger
for(x1 in 1:2)
{
  for(y1 in 1:2)
  {
    for(x2 in 1:2)
    {
      for(y2 in 1:2)
      {
        K[x1,y1,x2,y2] <- x1*y2 - sin(x2*y1) #this is just a dummy function.
      }   
    }
  }
} 
```

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T19:07:18.697

编辑; 这是我认为更快的解决方案。它假定您已经按照您提供的方式预定义了 K。它使用该`K[] <-`构造插入在数据框环境中计算的值。在作业的 LHS 上使用方括号可以保留 K 的结构，我认为它既是矢量化的又是自记录的：

```
dfm <- expand.grid(x1=1:2,x2=1:2,y1=1:2,y2=1:2) 
K[] <- with(dfm, x1*y2 - sin(x2*y1 ) ) 
```

提供的第一个解决方案：如果您可以创建具有索引 x1,x2,y1,y2 和值的 data.frame 或矩阵，则可以使用： K[cbind(index-vectors)] <- values 构造：

```
mtx<- data.matrix( expand.grid(x1=1:2,x2=1:2,y1=1:2,y2=1:2) )
K[mtx] <- apply(mtx, 1, function(x) x["x1"]*x["y2"] - sin(x['x2']*x['y1']) )
#----------------
> K
, , 1, 1

        [,1]       [,2]
[1,] 0.158529 0.09070257
[2,] 1.158529 1.09070257

, , 2, 1

          [,1]     [,2]
[1,] 0.09070257 1.756802
[2,] 1.09070257 2.756802

, , 1, 2

        [,1]     [,2]
[1,] 1.158529 1.090703
[2,] 3.158529 3.090703

, , 2, 2

        [,1]     [,2]
[1,] 1.090703 2.756802
[2,] 3.090703 4.756802 
```

# grails - Grails 2.0.3 忽略可为空的约束

> ID：10584620
> 
> 赞同：2
> 
> 时间：2012-05-14T13:48:40.970
> 
> 标签：grails, grails-orm

我们遇到了 Grails 的问题，它在某些情况下忽略了可为空的约束。例如：

```
class SomeSetting {
    ...
    Employee manager
    ...

    static belongsTo = [ employee: Employee ]

    static constaints = {
        manager nullable: true
    }
}

class Employee {
    ...

    static hasOne = [ settings: SomeSetting ]
} 
```

grails 继续创建数据库，其中 manager 字段`NOT NULL`用于`SomeSetting`该类。这只是一个粗略的例子。有谁知道如何解决这个问题。我们不想`NOT NULL`为字段设置默认值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:55:42.207

通过使用让它工作`static mappedBy = [ ... ]`

# sql - 如何在 SQL Server 中将每一行选择到一个变量中

> ID：10584624
> 
> 赞同：1
> 
> 时间：2012-05-14T13:48:47.347
> 
> 标签：sql, sql-server

我们有一个将分隔列表转换为表格的函数：

```
select * from dbo.fn_rpt_ParseValues('abc|123|test','|') 
```

结果：

```
abc
123
test 
```

如何将每一行放入 SQL 变量中？例如：

```
@Name = 'abc'
@Phone = '123'
@Comment = 'test' 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:34:04.703

```
declare @S varchar(100) = 'abc|123|test'

declare @Name varchar(10)
declare @Phone varchar(10)
declare @Comment varchar(10)

select @Name = X.value('x[1]', 'varchar(10)'),
       @Phone = X.value('x[2]', 'varchar(10)'),
       @Comment = X.value('x[3]', 'varchar(10)')
from (select cast('<x>'+replace(@S, '|', '</x><x>')+'</x>' as xml)) as T(X)

select @Name, @Phone, @Comment 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:16:52.180

```
DECLARE @Split table(
     RowIndex int IDENTITY(1,1)
    ,Item varchar(200));
INSERT INTO @Split 
    SELECT * from dbo.fn_rpt_ParseValues('abc|123|test','|');

DECLARE @Name   varchar(50);
DECLARE @Phone  varchar(50);
DECLARE @Comment varchar(100);
SET @Name   =  (SELECT Item FROM @Split WHERE RowIndex=1);
SET @Phone  =  (SELECT Item FROM @Split WHERE RowIndex=2);
SET @Comment = (SELECT Item FROM @Split WHERE RowIndex=3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:20:19.810

假设这些行是有序的，您想要进行透视以将它们变成列。

另一种选择是让您的解析函数（或修改后的版本）返回单行结果集（表值函数）并使用 CROSS/OUTER APPLY 将它们附加到一行：

[http://msdn.microsoft.com/en-us/library/ms174853.aspx](http://msdn.microsoft.com/en-us/library/ms174853.aspx)

# c# - 使用 Ghostscript 生成高质量（或可读）缩略图

> ID：10584625
> 
> 赞同：1
> 
> 时间：2012-05-14T13:48:48.537
> 
> 标签：c#, .net, ghostscript, thumbnails

我目前正在尝试使用 Ghostscript（或更具体地说是[GhostscriptSharp](https://github.com/mephraim/ghostscriptsharp)，C# 包装器版本）生成 PDF 的缩略图，并且遇到了一些正在输出的图像质量问题。

使用以下方法：

```
GeneratePageThumbs(string inputPath, string outputPath, int firstPage, int lastPage, int width, int height) 
```

并将宽度和高度更改为较小的数字，这将生成一个与我正在寻找的大小大致相同的缩略图，例如高度为 12 和宽度为 8 将生成一组大小为 102 x 88 像素的缩略图。

理想情况下 - 我正在尝试生成大小为 100 x 80 的缩略图，当呈现为 HTML（在图像标签中）时看起来相当不错，以便读者可以从缩略图中了解他们正在查看的内容（因为它目前完全不可读）

这些是当前设置（来自 C# 包装器）：

```
private static readonly string[] ARGS = new string[] {
     // Keep gs from writing information to standard output
     "-q",                     
     "-dQUIET",

     "-dPARANOIDSAFER",         // Run this command in safe mode
     "-dBATCH",                 // Keep gs from going into interactive mode
     "-dNOPAUSE",               // Do not prompt and pause for each page
     "-dNOPROMPT",              // Disable prompts for user interaction           
     "-dMaxBitmap=500000000",   // Set high for better performance
     "-dNumRenderingThreads=4", // Multi-core, come-on!

     // Configure the output anti-aliasing, resolution, etc
     "-dAlignToPixels=0",
     "-dGridFitTT=0",
     "-dTextAlphaBits=4",
     "-dGraphicsAlphaBits=4"
}; 
```

但是 - 我不太熟悉 Ghostsharp 及其在尺寸和质量之间取得平衡的设置。我不反对创建更大的图像并为缩略图缩放它们，尽管如果可能的话，我更愿意让缩略图正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T07:13:32.023

如果没有看到原始文档，我无法确定，但在我看来，102x88 像素似乎不太可能足以创建可读的文本。

对于这个尺寸，TextAlphaBits 可能太大了，你只会得到一个模糊。尝试根本不设置 TextAlphaBits。NumRenderingThreads 不会对这么小的页面做任何有用的事情（尽管它也不会造成任何伤害）。

# jquery - 如何在 JQuery Ajax beforeSend 函数中使用 $(this).val()？

> ID：10584634
> 
> 赞同：0
> 
> 时间：2012-05-14T13:49:13.180
> 
> 标签：jquery, ajax, post

我认为这很简单。我有一个有效的 AJAX Jquery 脚本，可以将数据发布到另一个页面。我想在包含输入的分区中添加一个预加载器，每个分区都有一个类名，其中包含一个 id。

我需要知道如何在 beforeSend 函数中使用发布数据。

```
$('#stock_ctrl input').change(function() {

        $.ajax({
            type: "POST",
            data:   {   stock: this.value, 
                        id: this.name
                    },
            url: "example.php",

            beforeSend: function(data) {

                $('.updating'+data.id).html("Preloader here.");

               // I have tried data.id, this.name, $(this).attr.("name");

            success: function(){
                // success (this works fine)
            }
        });

    }); 
```

请参阅我在代码中的评论，这是我想使用来自原始输入的名称数据的地方，这就是我坚持的。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:52:03.643

在发送 ajax 之前定义 $(this)，例如：

```
$('#stock_ctrl input').change(function() {  
var self = $(this);

    $.ajax({
        type: "POST",
        data:   {   stock: self.val(), 
                    id: self.attr('name')
                },
        url: "example.php",
        beforeSend: function(data) {
            $('.updating'+data.id).html("Preloader here.");
           // I have tried data.id, this.name, self.attr.("name");
        success: function(){
            // success (this works fine)
        }
    });
}); 
```

那应该做的工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:53:35.127

当 beforeSend 的匿名函数正在执行时，您切换上下文，因此`this`不再引用同一个对象。你需要给`this`你想要的功能

```
$('#stock_ctrl input').change(function() {

    $.ajax({
        type: "POST",
        data:   {   stock: this.value, 
                    id: this.name
                },
        url: "example.php",

        beforeSend: $.proxy(function(data) {

           // this should now refer to the correct object and you can perform your operations
        }, this),
        success: function(){
            // success (this works fine)
        }
    });

}); 
```

刚刚输入，但应该可以工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:53:42.070

这应该这样做

```
$('#stock_ctrl input').change(function() {
    var myVar = $(this);
    $.ajax({
        type: 'post',
        data: {
            stock: myVar.val(),
            id: myVar.attr('name')
        },
        url: 'example.php',
        beforeSend: function(data) {
            //do anything with myVar
        },
        success: function(){
            //do anything with myVar
        }
    });
}); 
```

# ajax - AjaxFormValidatingBehavior 性能和失去对 Firefox 的关注

> ID：10584635
> 
> 赞同：0
> 
> 时间：2012-05-14T13:49:15.363
> 
> 标签：ajax, treeview, wicket

我的项目正在使用 Wicket 的*AjaxFormValidatingBehavior*将表单内容自动保存到带有树形菜单的多选项卡表单上的 Session（单个选项卡上没有保存按钮，尽管有一个实际提交表单的“保存”按钮，运行验证并将内容保存到数据库）。我面临几个问题：

1.  由于该行为被添加到所有表单组件的*onChange*事件中，因此每次用户从一个字段移动到另一个字段时都会发生一次服务器跳闸。我知道可以指定油门持续时间来防止这种情况，但在我的情况下无法设置，因为我的表单具有不同的长度/复杂性，许多组件是动态生成的（包括树形菜单）。但是有没有更优雅的解决方案来自动保存表单内容（没有提交按钮）而不是这个烦人的解决方案。

2.  我面临的另一个问题是发布*onChange*事件，在 Firefox 上，组件在“服务器之旅”结束后失去焦点。在 IE7 上它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T11:46:16.620

对于第一个问题，我认为您需要添加一个流水线设施，在您的组件`onchange`调用您的调用您的 webapp 的 javascript 函数。您可以包含与节流持续时间提供的功能类似的功能，但在页面范围内（例如延迟每个调用，并且仅在它早于 x 毫秒时才触发最后一个调用）。

对于第二个，我认为你必须`AjaxRequestTarget#focusComponent`在你的行为中使用，或者在你的“包装器”中处理这个东西，如第一个答案中所述。

# ruby - 编写 gem 时设置配置设置

> ID：10584638
> 
> 赞同：14
> 
> 时间：2012-05-14T13:49:23.043
> 
> 标签：ruby, rubygems

我正在编写一个我想在有或没有 Rails 环境的情况下使用的 gem。

我有一个`Configuration`允许配置 gem 的类：

```
module NameChecker
  class Configuration
    attr_accessor :api_key, :log_level

    def initialize
      self.api_key = nil
      self.log_level = 'info'
    end
  end

  class << self
    attr_accessor :configuration
  end

  def self.configure
    self.configuration ||= Configuration.new
    yield(configuration) if block_given?
  end
end 
```

现在可以这样使用：

```
NameChecker.configure do |config|
  config.api_key = 'dfskljkf'
end 
```

但是，我似乎无法从我的 gem 中的其他类中访问我的配置变量。例如，当我`spec_helper.rb`像这样配置 gem 时：

```
# spec/spec_helper.rb
require "name_checker"

NameChecker.configure do |config|
  config.api_key = 'dfskljkf'
end 
```

并从我的代码中引用配置：

```
# lib/name_checker/net_checker.rb
module NameChecker
  class NetChecker
    p NameChecker.configuration.api_key
  end
end 
```

我得到一个未定义的方法错误：

```
`<class:NetChecker>': undefined method `api_key' for nil:NilClass (NoMethodError) 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-20T04:30:11.847

尝试重构为：

```
def self.configuration
  @configuration ||=  Configuration.new
end

def self.configure
  yield(configuration) if block_given?
end 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-14T14:40:44.820

主要问题是您应用了太多间接性。你为什么不做

```
module NameChecker
  class << self
    attr_accessor :api_key, :log_level
  end
end 
```

并完成它？您还可以在之后立即覆盖两个生成的阅读器，以确保它们存在您需要的环境......

```
module NameChecker
  class << self
    attr_accessor :api_key, :log_level

    def api_key
      raise "NameChecker really needs is't api_key set to work" unless @api_key
      @api_key
    end

    DEFAULT_LOG_LEVEL = 'info'

    def log_level
      @log_level || DEFAULT_LOG_LEVEL
    end

  end
end 
```

现在，实际（技术）问题是您正在定义一个名为的类`NetChecker`，并且在定义它时您试图`api_key`在假定的`Configuration`对象上打印调用的返回值（因此您在这里违反了得墨忒耳定律）。这失败了，因为您`NetChecker`在任何人真正有时间定义任何配置之前进行定义。所以你实际上是在调用方法`api_key`之前请求的，所以它在它的ivar 中。`configure``NameChecker``nil``configuration`

我的建议是删除过度工程并重试;-)

# android - Android FragmentActivity 没有返回到上一个

> ID：10584639
> 
> 赞同：0
> 
> 时间：2012-05-14T13:49:32.437
> 
> 标签：android, stack, android-fragmentactivity

我有 3 个片段活动：主屏幕、新闻提要和文章视图。单击主屏幕上的按钮打开新闻提要，单击新闻提要中的文章打开文章视图。但是当我在文章视图中单击“返回”按钮时，它会返回主屏幕。

有什么理由会跳过以前的活动吗？如何确保它返回到呼叫活动而不是主屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T16:09:30.953

我通过添加`android:alwaysRetainTaskState="true"`打开文章的活动来解决问题。

我认为问题在于，当我切换到文章活动时，活动被破坏了，而当它试图返回时，那里什么也没有。

# java - 黑莓上的 XML 解析失败

> ID：10584642
> 
> 赞同：0
> 
> 时间：2012-05-14T13:49:44.350
> 
> 标签：java, xml, blackberry, xml-parsing

我正在使用以下代码来解析 XML 文件。但我没有得到任何回应。任何人都可以帮忙吗？

打开连接时，我也会收到警告：

*“警告！：调用有问题的方法：找到 java.lang.String.()”`？*

```
public static void main(String arg[]){
    XML_Parsing_Sample application = new XML_Parsing_Sample();
    //create a new instance of the application
    //and start the application on the event thread
    application.enterEventDispatcher();
}

public XML_Parsing_Sample() {
    _screen.setTitle("XML Parsing");//setting title
    _screen.add(new RichTextField("Requesting....."));
    _screen.add(new SeparatorField());
    pushScreen(_screen); // creating a screen
    //creating a connection thread to run in the background
    _connectionthread = new Connection();
    _connectionthread.start();//starting the thread operation
}

public void updateField(String node, String element){
    //receiving the parsed node and its value from the thread
    //and updating it here
    //so it can be displayed on the screen
    String title="Title";
    _screen.add(new RichTextField(node+" : "+element));

    if(node.equals(title)){
        _screen.add(new SeparatorField());
    }
}

private class Connection extends Thread{
    public Connection(){
        super();
    }

    public void run(){
        // define variables later used for parsing
        Document doc;
        StreamConnection conn;

        try{
            //providing the location of the XML file,
            //your address might be different
            conn=(StreamConnection)Connector.open
              ("http://www.w3schools.com/xml/note.xml",Connector.READ);
            //next few lines creates variables to open a
            //stream, parse it, collect XML data and
            //extract the data which is required.
            //In this case they are elements,
            //node and the values of an element
            DocumentBuilderFactory docBuilderFactory
              = DocumentBuilderFactory. newInstance(); 
            DocumentBuilder docBuilder
              = docBuilderFactory.newDocumentBuilder();
            docBuilder.isValidating();
            doc = docBuilder.parse(conn.openInputStream());
            doc.getDocumentElement ().normalize ();
            NodeList list=doc.getElementsByTagName("*");
            _node=new String();
            _element = new String();
            //this "for" loop is used to parse through the
            //XML document and extract all elements and their
            //value, so they can be displayed on the device

            for (int i=0;i<list.getLength();i++){
                Node value=list.item(i).
                  getChildNodes().item(0);
                _node=list.item(i).getNodeName();
                _element=value.getNodeValue();
                updateField(_node,_element);
            }//end for
        }//end try
        //will catch any exception thrown by the XML parser
        catch (Exception e){
            System.out.println(e.toString());
        }
    }//end connection function
}// end connection class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:19:40.917

您可能正在超时。尝试将连接打开为 HTTP 连接，并使用新`ConnectionFactory`类摆脱烦人的后缀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T06:58:15.043

```
public InputStream getResult(String url) {
            System.out.println("in get result");
    HttpConnection httpConn;
    httpConn = (HttpConnection) getHTTPConnection(url);
    try {
        if (httpConn != null) {
            final int iResponseCode = httpConn.getResponseCode();
            if (iResponseCode == httpConn.HTTP_OK) {

                _inputStream = httpConn.openInputStream();

                byte[] data = new byte[20];
                int len = 0;
                int size = 0;
                ByteArrayOutputStream baos = new ByteArrayOutputStream();
                try {
                    while (-1 != (len = _inputStream.read(data))) {
                        baos.write(data, 0, len);
                        size += len;
                    }
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                InputStream is2 = new ByteArrayInputStream(
                        baos.toByteArray());

                return is2;
            } else {
                return null;
            }
        }
    } catch (IOException e) {
        System.err.println("Caught IOException: " + e.getMessage());
    }
    try {
        httpConn.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return null;
} 
```

下载 xml 解析下载的 xml。

```
public Document XMLfromInputStream(InputStream xml) {
    Document doc = null;
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    dbf.setAllowUndefinedNamespaces(true);
    dbf.setCoalescing(true);
    dbf.setExpandEntityReferences(true);

    try {
        DocumentBuilder db;
        db = dbf.newDocumentBuilder();
        InputSource _source = new InputSource();
        _source.setEncoding("UTF-8");
        _source.setByteStream(xml);
        db.setAllowUndefinedNamespaces(true);
        doc = db.parse(_source);
    } catch (SAXException e) {
        System.out.println("Wrong XML file structure: " + e.getMessage());
        return null;
    } catch (IOException e) {
        System.out.println("I/O exeption: " + e.getMessage());
        return null;
    } catch (net.rim.device.api.xml.parsers.ParserConfigurationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        return null;
    } finally {

    }
    return doc;

} 
```

然后将此文档解析为元素

```
Element rootElement = document.getDocumentElement();
rootElement.normalize();
displayNode( rootElement, 0 );

private void displayNode( Node node, int depth ) 
{        

    if ( node.getNodeType() == Node.ELEMENT_NODE ) 
    {
        StringBuffer buffer = new StringBuffer();
        indentStringBuffer( buffer, depth );
        NodeList childNodes = node.getChildNodes();
        int numChildren = childNodes.getLength();
        Node firstChild = childNodes.item( 0 );

        // If the node has only one child and that child is a Text node, then it's of 
        // the form  <Element>Text</Element>, so print 'Element = "Text"'.
        if ( numChildren == 1 && firstChild.getNodeType() == Node.TEXT_NODE ) 
        {
            buffer.append( node.getNodeName() ).append( " = \"" ).append( firstChild.getNodeValue() ).append( '"' );
            add( new RichTextField( buffer.toString() ) );
        } 
        else 
        {
            // The node either has > 1 children, or it has at least one Element node child. 
            // Either way, its children have to be visited.  Print the name of the element
            // and recurse.
            buffer.append( node.getNodeName() );
            add( new RichTextField( buffer.toString() ) );

            // Recursively visit all this node's children.
            for ( int i = 0; i < numChildren; ++i ) 
            {
                displayNode( childNodes.item( i ), depth + 1 );
            }
        }
    } 
    else 
    {
        // Node is not an Element node, so we know it is a Text node.  Make sure it is 
        // not an "empty" Text node (normalize() doesn't consider a Text node consisting
        // of only newlines and spaces to be "empty").  If it is not empty, print it.
        String nodeValue = node.getNodeValue();
        if ( nodeValue.trim().length() != 0 ) 
        {
            StringBuffer buffer = new StringBuffer();
            indentStringBuffer( buffer, depth );
            buffer.append( '"' ).append( nodeValue ).append( '"' );
            add( new RichTextField( buffer.toString() ) );
        }
    }
}

/**
 * Adds leading spaces to the provided string buffer according to the depth of 
 * the node it represents.
 * 
 * @param buffer The string buffer to add leading spaces to.
 * @param depth The depth of the node the string buffer represents.
 */
private static void indentStringBuffer( StringBuffer buffer, int depth ) 
{
    int indent = depth * _tab;

    for ( int i = 0; i < indent; ++i ) 
    {
        buffer.append( ' ' );
    }
} 
```

您可以使用上述示例下载并解析 xml。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T11:05:40.540

```
NamedNodeMap attributes = (NamedNodeMap)value.getAttributes();
                for (int g = 0; g < attributes.getLength(); g++) {
                    Attr attribute = (Attr)attributes.item(g);
                    System.out.println(" Attribute: " + attribute.getName() +
                    " with value " +attribute.getValue()); 
```

上面的代码获取属性及其值..欢呼

# mysql - 将作为子查询结果的多行转换为字符串

> ID：10584644
> 
> 赞同：2
> 
> 时间：2012-05-14T13:49:52.123
> 
> 标签：mysql, sql

是否可以将作为子查询结果的多行转换为 MySQL 中的字符串？

我的意思是以下查询：

```
SELECT id, 
       FUNCTION_THAT_CONVERTS_MUTLIPLE_ROWS_TO_STRING(
          SELECT name FROM test2 t2 where t2.id = t.id
       ) FROM test t; 
```

其中`SELECT name FROM test2 t2 where t2.id = t.id`返回多行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T13:51:38.453

是的，您需要使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。

# javascript - XPages 复选框组和 jQuery Mobile

> ID：10584646
> 
> 赞同：1
> 
> 时间：2012-05-14T13:50:08.183
> 
> 标签：javascript, jquery, checkbox, jquery-mobile, xpages

如果我在 jQuery Mobile 中使用复选框组，我会生成一些奇怪的 UI。我想我可以通过在重复控件中使用单个复选框来解决这个问题。我可以使用此方法使 UI 正确显示，并且重复绑定到一个视图，我可以使用该视图为每个复选框生成标签。

但我不确定我应该如何处理数据服务器端或者我应该将复选框绑定到什么。最终，所选值应存储在 Notes 文档上的单个多值字段中。如果我绑定到文档上的这个字段，那么它只会获取最后一个复选框的值——这是有道理的。

或者......是否有某种修复方法可以让复选框组正确显示。

这个问题已经有一段时间了......但现在它已成为一个更紧迫的问题......所以任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:29:56.347

Martin - 复选框组一般都很糟糕。我建议您使用单独的复选框并在后端计算您想要的答案。单个复选框没有问题

```
<xp:checkBox id="checkBox1" value="#{invite.Marketing}">
</xp:checkBox>
<xp:label value="Marketing" id="label4" for="checkBox1"
        style="font-weight:bold">
</xp:label>
<xp:checkBox id="checkBox2" value="#{invite.Tracking}">
</xp:checkBox>
<xp:label value="Tracking" id="label3" for="checkBox2"
        style="font-weight:bold">
</xp:label> 
```

# java - SimpleDateFormat 解析耗时一小时（夏季使用 RFC 1123，GMT）

> ID：10584647
> 
> 赞同：3
> 
> 时间：2012-05-14T13:50:08.453
> 
> 标签：java, simpledateformat, dst

我使用 SimpleDateFormat 和 RFC 1123 来格式化日期和解析日期。但是， parse(format(date)) 有时与原始日期相差一小时。

下面的代码：

```
public static void main(String[] args) throws ParseException {
    String RFC1123_DATE_PATTERN = "EEE, dd MMM yyyy HH:mm:ss zzz";
    SimpleDateFormat dateFormat = new SimpleDateFormat(RFC1123_DATE_PATTERN);

    Date date = new Date(1000);
    String str = dateFormat.format(date);
    Date date2 = dateFormat.parse(str);

    System.out.println("date="+date+"; "+date.getTime());
    System.out.println("str="+str);
    System.out.println("date2="+date2+"; "+date2.getTime());
} 
```

写出：

```
date=Thu Jan 01 01:00:01 GMT 1970; 1000
str=Thu, 01 Jan 1970 01:00:01 GMT
date2=Thu Jan 01 02:00:01 GMT 1970; 3601000 
```

我从 apache.http.util.DateUtil 得到了这个模式，所以希望它能够工作 [1]。

据推测，格林威治标准时间是否包括或不包括夏令时？

我正在使用 Java(TM) SE 运行时环境（构建 1.6.0_31-b04-415-10M3646，也在 1.7.0_71 上测试过）。

* * *

一种解决方法是使用模式“EEE，dd MMM yyyy HH:mm:ss Z”，它给出：

```
date=Thu Jan 01 01:00:01 GMT 1970; 1000
str=Thu, 01 Jan 1970 01:00:01 +0100
date2=Thu Jan 01 01:00:01 GMT 1970; 1000 
```

[1] [http://www.docjar.com/html/api/org/apache/http/util/DateUtils.java.html](http://www.docjar.com/html/api/org/apache/http/util/DateUtils.java.html)

编辑：根据@oscar-castiblanco 的评论，我已将其更改为`new Date(1000)`，而不是使用 1234ms。同样的问题仍然发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:12:18.113

我尝试了第一个模式“EEE，dd MMM yyyy HH:mm:ss zzz”，我得到了这个答案

```
date=Thu Jan 01 01:00:01 CET 1970; 1234
str=Thu, 01 Jan 1970 01:00:01 CET
date2=Thu Jan 01 01:00:01 CET 1970; 1000 
```

我尝试了第二种模式，得到了相同的答案。

为了在两种情况下都有相同的时间，我将缺少的转换毫秒添加到模式中：

模式 = “EEE，dd MMM yyyy HH:mm:ss:SSS Z”

```
date=Thu Jan 01 01:00:01 CET 1970; 1234
str=Thu, 01 Jan 1970 01:00:01:234 +0100
date2=Thu Jan 01 01:00:01 CET 1970; 1234 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-10T15:07:16.020

GMT 没有夏令时。在英国，我们按照夏令时的“英国标准时间”生活。“格林威治标准时间”是世界参考时间，没有夏令时。然而，微软犯了这个错误，这助长了混乱。

# java - 使用 JNA 聚焦外部窗口（shell）

> ID：10584649
> 
> 赞同：2
> 
> 时间：2012-05-14T13:50:13.560
> 
> 标签：java, java-native-interface, jna

我想将注意力集中在使用 JNA（或 JNI）知道 xterm 标题的 xterm 上。目前我正在使用 xdotools 进行操作，但我想更改为纯 Java。可能吗？如何？

注意：我使用的是 ubuntu 11.10

# jquery - Mobile Jquery - 翻转效果

> ID：10584651
> 
> 赞同：5
> 
> 时间：2012-05-14T13:50:14.963
> 
> 标签：jquery, html

请在下面找到网址。

[http://jquerymobile.com/demos/1.1.0/docs/pages/page-transitions.html](http://jquerymobile.com/demos/1.1.0/docs/pages/page-transitions.html)

如何在页面 onload 或 document.onReady 上使用这些效果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T14:24:31.800

在标准页面上从 jQuery Mobile 重新创建翻转过渡非常简单。首先创建一个绝对定位的容器，其中包含两个相对定位的子项，这将是您要在其间翻转的两个页面。加载完两个页面后，将“flip”和“out”类应用于要替换的页面并调用`hide()`它。最后，将 'flip' 和 'in' 类添加到正在显示的页面并调用`show()`它。

转换只是 CSS3 转换，所以请注意它们不适用于所有浏览器，并且它们可能在大屏幕/低性能机器上表现不佳。

**HTML**

```
<button type="button" id="go">FLIP</button>
<div class="container">
    <div class="page1">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.
    </div>
    <div class="page2">
        Duis interdum, odio vel condimentum varius, nibh nunc ultrices velit.
    </div>
</div> 
```

**CSS**

```
.container {
    position: absolute;   
    -webkit-perspective: 1000;
    -moz-perspective: 1000;
}
.page1 {
    width: 300px;
    height: 300px;
    background: red;
    position: relative;
}
.page2 {
    width: 300px;
    height: 300px;
    background: blue;
    position: relative;
    display: none;
}

.flip {
    -webkit-backface-visibility:hidden;
    -webkit-transform:translateX(0); 
    -moz-backface-visibility:hidden;
    -moz-transform:translateX(0);
}
.flip.out {
    -webkit-transform: rotateY(-90deg) scale(.9);
    -webkit-animation-name: flipouttoleft;
    -webkit-animation-duration: 175ms;
    -moz-transform: rotateY(-90deg) scale(.9);
    -moz-animation-name: flipouttoleft;
    -moz-animation-duration: 175ms;
}
.flip.in {
    -webkit-animation-name: flipintoright;
    -webkit-animation-duration: 225ms;
    -moz-animation-name: flipintoright;
    -moz-animation-duration: 225ms;
}
.flip.out.reverse {
    -webkit-transform: rotateY(90deg) scale(.9);
    -webkit-animation-name: flipouttoright;
    -moz-transform: rotateY(90deg) scale(.9);
    -moz-animation-name: flipouttoright;
}
.flip.in.reverse {
    -webkit-animation-name: flipintoleft;
    -moz-animation-name: flipintoleft;
}
@-webkit-keyframes flipouttoleft {
    from { -webkit-transform: rotateY(0); }
    to { -webkit-transform: rotateY(-90deg) scale(.9); }
}
@-moz-keyframes flipouttoleft {
    from { -moz-transform: rotateY(0); }
    to { -moz-transform: rotateY(-90deg) scale(.9); }
}
@-webkit-keyframes flipouttoright {
    from { -webkit-transform: rotateY(0) ; }
    to { -webkit-transform: rotateY(90deg) scale(.9); }
}
@-moz-keyframes flipouttoright {
    from { -moz-transform: rotateY(0); }
    to { -moz-transform: rotateY(90deg) scale(.9); }
}
@-webkit-keyframes flipintoleft {
    from { -webkit-transform: rotateY(-90deg) scale(.9); }
    to { -webkit-transform: rotateY(0); }
}
@-moz-keyframes flipintoleft {
    from { -moz-transform: rotateY(-90deg) scale(.9); }
    to { -moz-transform: rotateY(0); }
}
@-webkit-keyframes flipintoright {
    from { -webkit-transform: rotateY(90deg) scale(.9); }
    to { -webkit-transform: rotateY(0); }
}
@-moz-keyframes flipintoright {
    from { -moz-transform: rotateY(90deg) scale(.9); }
    to { -moz-transform: rotateY(0); }
} 
```

**JavaScript**

您需要将此部分替换为与您的页面更相关的内容，但概念是相同的。

```
$('#go').click(function() {
    var page1 = $('.page1');
    var page2 = $('.page2');
    var toHide = page1.is(':visible') ? page1 : page2 ;
    var toShow = page2.is(':visible') ? page1 : page2 ;

    toHide.removeClass('flip in').addClass('flip out').hide();
    toShow.removeClass('flip out').addClass('flip in').show();
}); 
```

这是一个工作演示：http: [//jsfiddle.net/lakario/VPjX9/](http://jsfiddle.net/lakario/VPjX9/)

# xcode - 是否有在 Xcode 中创建存储变量的最佳实践？

> ID：10584652
> 
> 赞同：0
> 
> 时间：2012-05-14T13:50:15.673
> 
> 标签：xcode, variables, initialization

我想知道是否有人可以告诉我首先创建一个局部变量的好处，而不是直接初始化一个存储的变量。请参见下面的示例：

**例子.h**

```
NSString *exampleString;

@property (nonatomic, retain) NSString *exampleString; 
```

**例子.m**

```
@synthesize exampleString; 
```

**方法一（直接初始化）**

```
self.exampleString = [NSString stringWithString:@"Example"]; 
```

**方法二（本地初始化）**

```
NSString *example = [NSString stringWithString:@"Example"];
self.exampleString = example;
[example release]; 
```

我在我的代码中使用了这两种类型，但没有注意到任何直接的区别，但是当我查看大多数编码示例时，它们使用方法 2。我只是想知道两者之间是否存在实际差异？

提前致谢，埃利奥特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:58:29.597

对于您只使用一次的情况，我想不出任何办法。事实上，你的例子指出了一个问题，如果它存在，有人可能会试图过度释放它。:)

实际上，`self.exampleString = @"Example";`比它们中的任何一个都更容易阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:56:09.447

第二种方法是错误的！您正在释放一个已经自动释放的对象。您不拥有示例字符串，因为您没有调用 init 或 retain。然后你不需要释放它，否则它可能会使你的应用程序崩溃。第二种方法的正确版本是：

```
NSString *example = [[NSString alloc] initWithString:@"Example"];
self.exampleString = example;
[example release]; 
```

这与您的第一种方法之间的区别在于，在这里您没有自动释放的对象。您初始化一个字符串，将其分配（并保留）给您的实例变量，然后释放它。在第一个方法中，stringWithString 将创建一个自动释放的对象，该对象将在未来的某个时间（通常在循环结束时）释放。在那之前它在内存中（并浪费它）。所以特别是对于（很多）大物体，你应该避免这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:55:27.010

在方法 2 中，您不应该释放`example`变量，因为您没有创建它也没有保留它。看看这个： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)

除了这个问题，你的两种方法没有区别。在我看来，方法 1 更简洁，因为您不需要那个额外的变量。

# codeigniter - CodeIgniter 500 子域中的内部服务器错误

> ID：10584654
> 
> 赞同：1
> 
> 时间：2012-05-14T13:50:26.527
> 
> 标签：codeigniter

我有一个关于 500 Internal Server Error 的问题。这是故事

1.  我创建了一个子域，并将我的基于 CI 的网站放在那里。
2.  我尝试访问它，它可以工作，但是有一些错误需要修复。
3.  修复错误后，我删除了子域中的所有文件并重新上传。
4.  我尝试访问它，但它显示 500 内部服务器错误。我检查了 .htaccess 文件，没有任何问题，因为我从未更改过它。

这是我的 htaccess 文件

```
RewriteEngine on
RewriteCond $1 !^(index\.php|assets|css|js|images|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

这是我的 CI 配置文件

```
$config['base_url'] = '';
$config['index_page'] = ''; 
```

当我尝试访问我的网站时检查了我的 cpanel 错误日志。它显示如下：

```
[Sat May 12 20:48:23 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group
[Sat May 12 20:48:23 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group
[Sat May 12 20:48:21 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group
[Sat May 12 20:48:21 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group
[Sat May 12 20:48:20 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group
[Sat May 12 20:48:20 2012] [error] [client 180.247.155.67] SoftException in Application.cpp:254: File "/home/*****/public_html/sipr/index.php" is writeable by group 
```

我尝试通过 localhost 访问我的网站，它工作正常。我的本地站点地址是

```
http://localhost/sipr/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T18:20:01.447

Apache 不会运行任何人都可以读写的公共文件夹中的代码 (CHMOD 777)。

我建议让你`DOCUMENT_ROOT`在你的主文件夹之外的某个地方。`/var/www/`, `/srv/www/htdocsc`, 或任何适用于您的操作系统的默认值。

备份解决方案是将您的访问设置设置为 Apache 标准（并使其不可组写入）：`CHMOD -R 775 sipr`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T04:32:12.263

非常感谢 Zenbait，您的建议很棒。现在，我的网站运行良好。

首先，我尝试将访问设置更改为 775，就像您说的那样，但它不起作用。因此，我在 /public_html/ 文件夹之外创建了另一个子域。我把它设置在`/home/my_username/raport/`. 我将我的网站放在该文件夹中，并尝试访问它。有用！！

# javascript - 回发后如何在下拉列表中保留所选值？

> ID：10584655
> 
> 赞同：0
> 
> 时间：2012-05-14T13:50:29.653
> 
> 标签：javascript, jquery, ajax, cascadingdropdown

```
$("#county_id").change(function() {
    $("#vice_county_id").html("<option value=\"\">-- Select One --</option>");
    var co_id = $(this).val();
    if(co_id != 0) {
        $.getJSON('./php/includes/vice_county_web_service.php?co_id=' + co_id,function(data) {   
            $.each(data, function() {
                $("#vice_county_id").append($("<option></option>").val(this['vice_county_id']).html(this['vice_county_name']));
            });
        });
    }
}); 
```

嗨，伙计们，我有上面的代码，用于根据另一个下拉列表中的选择加载选项。它工作得很好，但为了完成这个，我试图让它变得粘稠。即，如果表格已发布并且县已经选择了一个值，那么副县将预加载相关选项。基本上在加载时触发 .change 功能。我已经尝试过 .load 和 triggerhandler 功能，但它似乎不起作用。有任何想法吗？？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:16:02.450

据我所知，为了预填充表单，您需要使用服务器端代码。您说用户在某处发布了他的代码，但您没有说明如何处理表单发布。

我在我工作的地方使用 ASP.net，所以我会为每个下拉列表的值提供一个服务器端属性。然后，当页面呈现时，我将属性的值打印到我的 JavaScript 代码中。您需要让您的 JavaScript 代码将该属性添加`selected='selected'`到您希望在页面加载时选择的选项。

**更新：** 听起来您是在说您选择下拉菜单 1，然后自动填充下拉菜单 2 的选项。听起来问题是在回发后无法保留下拉 2，因为它的选项是在页面加载*后*填充的（通过 AJAX）。我相信解决问题的方法是在通过 AJAX 成功获取下拉选项时运行的代码中设置 selected 属性。

```
 $.each(data, function() {
            $("#vice_county_id").append($("<option></option>").val(this['vice_county_id']).html(this['vice_county_name']));
            //Check if the option being added was previously selected.
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T14:11:33.307

使用 Cookie 存储下拉更改事件的值。

当表单加载时，使用相同的 cookie 来检索值并向用户显示他选择的内容。

但不建议为此任务维护 cookie。

如果它是 JSP 页面，您可以使用 JSTL。

Cookie 创建指南 [http://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

# mysql - 从一个表中选择 1 条记录，从另一个表中选择 0.n

> ID：10584658
> 
> 赞同：0
> 
> 时间：2012-05-14T13:50:43.833
> 
> 标签：mysql, sql, database, database-design

我有 2 个表（clients 和 client_forms）。客户端始终是单个实例（因为它与单个人有关，但他们每年填写一张表格（1 - 0.n）。我需要一个 MySQL 语句为每个客户端选择所有表格，但我不确定怎么做它会使用某种嵌套查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:52:02.653

我建议您阅读[`JOIN`语法](http://dev.mysql.com/doc/refman/5.6/en/join.html)。基本上你必须写

```
SELECT *
FROM clients
[LEFT OUTER] JOIN client_forms ON [put the join condition here] 
```

我不确定您是否需要将其设为`LEFT OUTER JOIN`（始终为每个客户返回至少一条记录）或`INNER JOIN`（为每个客户和表单返回一条记录）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:57:13.800

```
select
  *
from
  clients
  join clent_forms on client_forms.client_id=clients.client_id 
```

将返回所有客户端及其所有表单 - 假设`client_id`两个表中都有一个列标识客户端。它不会返回没有表格的客户。

如果您还想要没有表格的客户，则需要`outer`加入：

```
select
  *
from
  clients
  left outer join clent_forms on client_forms.client_id=clients.client_id 
```

# asp.net - ASP.NET MVC 中每个用户变量的 Session 替代方案

> ID：10584659
> 
> 赞同：4
> 
> 时间：2012-05-14T13:50:48.417
> 
> 标签：asp.net, .net, asp.net-mvc, iis-7

我正在开发一个 MVC 3 应用程序，该应用程序将托管在具有多工作进程设置的网络场中。大约有十几个变量存储在 Session 中，但由于 IIS 设置而丢失。

迷路是指当登录过程成功时，我通过日志记录看到我已经设置了会话变量，但是在重定向操作和登陆控制器操作之后，会话变量通常为空。我不确定这是否相关，但这是在 HTTPS 中。

我们正在研究将存储在 Session 中的用户特定设置转移到其他机制的可能性，但有一个变量我将无法做到这一点。鉴于上述部署环境，我有以下问题。

1.  cookie 是我唯一（最好的？）为用户特定设置存储会话变量的替代方法吗？
2.  如果是这样，是否有一种安全的机制来编写 cookie，这样它们就不能被操纵并且仍然可以在多服务器环境中读取？
3.  据我了解，`System.Runtime.Caching`在上述 IIS 配置中运行时，它会遇到同样的问题。真的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T13:58:31.767

> cookie 是我唯一（最好的？）为用户特定设置存储会话变量的替代方法吗？

不-它们是最糟糕的方法。想到三个原因：

1.  它们可以被操纵。
2.  他们带着从客户端到服务器的每一个请求——效率低下。
3.  它们会给您的实施增加更多复杂性，因为您必须开始考虑以不同的方式保护它们。

> 如果是这样，是否有一种安全的机制来编写 cookie，这样它们就不能被操纵并且仍然可以在多服务器环境中读取？

见上面的答案。

> 据我了解，System.Runtime.Caching 在上述 IIS 配置中运行时会遇到同样的问题。真的吗？

真的。您应该使用任何超出 proc 的 State Providers。您可以使用 Sql Server 存储会话数据 - 前提是您的对象显然是可序列化的 - 或[状态服务器模式](http://msdn.microsoft.com/en-us/library/ms972429.aspx) `mode="stateserver"`

[阅读此处](http://msdn.microsoft.com/en-us/library/ms972429.aspx)了解更多详情

# javascript - 如何将局部变量值从一个函数传递到另一个函数？

> ID：10584660
> 
> 赞同：2
> 
> 时间：2012-05-14T13:50:54.123
> 
> 标签：javascript, function, variables

在我的脚本中，我有 2 个函数。第一个函数引用 div 元素，在 div 中创建一个段落元素，并将一些文本附加到该段落元素；在我的第二个函数中，由附加到链接元素的 onclick 事件触发。我希望在单击链接时将 div 中的文本更改为另一个文本。我确实意识到有两种方法可以实现这一目标：

1）声明全局变量并在我的第二个函数中使用它们；2）将变量值从第一个函数传递给第二个函数并从第二个函数中操作这个值

但问题是如何正确地将变量值从第一个函数传递到第二个函数：

这是代码：

```
<a href=''onclick='change();return false;'>Change</a>
<div id='box'></div> 
```

Javascript：

```
window.onload= function createEl(){
    var el = document.createElement('p');
    var x = document.getElementById('box');
    var text = 'text';

    el.appendChild(document.createTextNode(text));
    x.appendChild(el);
}

function change(){
    x.innerHTML="other text";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:54:49.197

一般来说，你可以这样写：

```
function one(){
   var var1 = "hello";
   two(var1);
}

function two(x){
   alert(x);
} 
```

这将提醒“你好”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:05:44.430

对于您正在做的事情，我将通过代码注册我的事件，以便更轻松地传递变量。我们想在事件处理函数中使用一个参数来将数据传递给它。

```
window.onload = function()
{
    // do your normal stuff with creating elements
    var anc = document.getElementById('ID of your a element here');
    if(anc.attachEvent)
    {
        //code for ancient IE
        anc.attachEvent('onclick', function(){change(x);});
    }
    else if(anc.addEventListener)
    {
        //code for modern browsers
        anc.addEventListener('click', function(){change(x);});
    }
}
function change(elem)
{
    elem.innerHTML='other text';
} 
```

请注意，旧版本的 IE 无法识别 addEventListener 并改用 attachEvent，如上面的 if 块所示。这是 addEventListener 的[文档](https://developer.mozilla.org/en/DOM/element.addEventListener)。

# java - 在 Java DOM 文档中设置名称空间和前缀

> ID：10584670
> 
> 赞同：14
> 
> 时间：2012-05-14T13:51:47.413
> 
> 标签：java, xml, serialization, transformer

我正在尝试将 ResultSet 转换为 XML 文件。我首先使用这个例子进行序列化。

```
import  org.w3c.dom.bootstrap.DOMImplementationRegistry;
import  org.w3c.dom.Document;
import  org.w3c.dom.ls.DOMImplementationLS;
import  org.w3c.dom.ls.LSSerializer;

...

DOMImplementationRegistry registry = DOMImplementationRegistry.newInstance();

DOMImplementationLS impl = 
    (DOMImplementationLS)registry.getDOMImplementation("LS");

...     

LSSerializer writer = impl.createLSSerializer();
String str = writer.writeToString(document); 
```

完成这项工作后，我尝试验证我的 XML 文件，但出现了一些警告。一个关于没有文档类型的问题。所以我尝试了另一种方法来实现这一点。我遇到了 Transformer 类。这个类让我设置编码、文档类型等。

以前的实现支持自动命名空间修复。以下没有。

```
private static Document toDocument(ResultSet rs) throws Exception {   
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setNamespaceAware(true);
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document doc = builder.newDocument();

    URL namespaceURL = new URL("http://www.w3.org/2001/XMLSchema-instance");
    String namespace = "xmlns:xsi="+namespaceURL.toString();

    Element messages = doc.createElementNS(namespace, "messages");
    doc.appendChild(messages);

    ResultSetMetaData rsmd = rs.getMetaData();
    int colCount = rsmd.getColumnCount();

    String attributeValue = "true";
    String attribute = "xsi:nil";

    rs.beforeFirst();

    while(rs.next()) {
        amountOfRecords = 0;
        Element message = doc.createElement("message");
        messages.appendChild(message);

        for(int i = 1; i <= colCount; i++) {

            Object value = rs.getObject(i);
            String columnName = rsmd.getColumnName(i);

            Element messageNode = doc.createElement(columnName);

            if(value != null) {
                messageNode.appendChild(doc.createTextNode(value.toString()));
            } else {
                messageNode.setAttribute(attribute, attributeValue);
            }
            message.appendChild(messageNode);
        }
        amountOfRecords++;
    }
    logger.info("Amount of records archived: " + amountOfRecords);

    TransformerFactory tff = TransformerFactory.newInstance();
    Transformer tf = tff.newTransformer();
    tf.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
    tf.setOutputProperty(OutputKeys.ENCODING, "UTF-8");
    tf.setOutputProperty(OutputKeys.INDENT, "yes");

    BufferedWriter bf = createFile();
    StreamResult sr = new StreamResult(bf);
    DOMSource source = new DOMSource(doc);
    tf.transform(source, sr);

    return doc;
} 
```

当我在测试之前的实现时，我得到了一个 TransformationException: Namespace for prefix 'xsi' has not been declared。如您所见，我尝试将带有 xsi 前缀的命名空间添加到文档的根元素中。经过测试，我仍然得到了异常。设置命名空间及其前缀的正确方法是什么？

编辑：我在第一个实现中遇到的另一个问题是 XML 文档中的最后一个元素没有最后三个结束标记。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-24T11:41:43.673

在 namespaceAware 文档上设置节点的正确方法是使用：

```
rootNode.createElementNS("http://example/namespace", "PREFIX:aNodeName"); 
```

因此，您可以将“PREFIX”替换为您自己的自定义前缀，并将“aNodeName”替换为您的节点名称。为了避免每个节点都有自己的命名空间声明，您可以将命名空间定义为根节点上的属性，如下所示：

```
rootNode.setAttribute("xmlns:PREFIX", "http://example/namespace"); 
```

请务必设置：

```
documentBuilderFactory.setNamespaceAware(true) 
```

否则你没有命名空间意识。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-10-16T07:18:30.090

请注意，使用 setAttribute 设置 xmlns 前缀是错误的。如果你想签署你的 DOM，你必须使用 setAttributeNS： `element.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:PREFIX", "http://example/namespace");`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-14T14:20:06.843

您还没有在根节点中添加命名空间声明；你刚刚在命名空间中声明了根节点，两个完全不同的东西。在构建 DOM 时，您需要引用每个相关节点上的命名空间。换句话说，当你添加你的属性时，你需要定义它的命名空间（例如，setAttributeNS）。

旁注：虽然 XML 名称空间看起来像 URL，但实际上并非如此。这里不需要使用 URL 类。

# c++ - std::async 使用相同的线程，我的代码没有实现并行性。

> ID：10584673
> 
> 赞同：8
> 
> 时间：2012-05-14T13:51:52.803
> 
> 标签：c++, multithreading, c++11, future, promise

我在 Mac OS Xcode 4.3.2 std::async 上使用 C++11 使用相同的线程并且我的代码没有实现并行性。在下面的示例代码中，我想创建 10 个新线程。在每个线程中，我想计算输入变量的平方根并将结果设置为 promise。在主函数中，我想显示从线程计算的结果。我用策略启动::async 调用 std::async，所以我希望它创建一个新线程（10 次）。

```
 #include <mutex>
    #include <future>
    #include <thread>
    #include <vector>
    #include <cmath>
    #include <iostream>

    using namespace std;
    mutex iomutex;

    void foo(int i, promise<double> &&prms)
    {
        this_thread::sleep_for(chrono::seconds(2));
        prms.set_value(sqrt(i));
        {
            lock_guard<mutex> lg(iomutex);
            cout << endl << "thread index=> " << i << ", id=> "<< this_thread::get_id();
        }
    }

    int main() 
    {   
        {
            lock_guard<mutex> lg(iomutex);
            cout << endl << "main thread id=>"<< this_thread::get_id();
        }
        vector<future<double>> futureVec;
        vector<promise<double>> prmsVec;

        for (int i = 0; i < 10; ++i) {
            promise<double> prms;
            future<double> ftr = prms.get_future();
            futureVec.push_back(move(ftr));
            prmsVec.push_back(move(prms));

            async(launch::async, foo, i, move(prmsVec[i]));
        }

        for (auto iter = futureVec.begin(); iter != futureVec.end(); ++iter) {
            cout << endl << iter->get();
        }

        cout << endl << "done";

        return 0;

    } 
```

但是，如果我使用 std::thread，那么我可以实现并行性。

```
 #include <mutex>
    #include <future>
    #include <thread>
    #include <vector>
    #include <cmath>
    #include <iostream>

    using namespace std;
    mutex iomutex;

    void foo(int i, promise<double> &&prms)
    {
        this_thread::sleep_for(chrono::seconds(2));
        prms.set_value(sqrt(i));
        {
            lock_guard<mutex> lg(iomutex);
            cout << endl << "thread index=> " << i << ", id=> "<< this_thread::get_id();
        }
    }

    int main() 
    {   
        {
            lock_guard<mutex> lg(iomutex);
            cout << endl << "main thread id=>"<< this_thread::get_id();
        }
        vector<future<double>> futureVec;
        vector<promise<double>> prmsVec;
        vector<thread> thrdVec;
        for (int i = 0; i < 10; ++i) {
            promise<double> prms;
            future<double> ftr = prms.get_future();
            futureVec.push_back(move(ftr));
            prmsVec.push_back(move(prms));

            thread th(foo, i, move(prmsVec[i]));
            thrdVec.push_back(move(th));
        }

        for (auto iter = futureVec.begin(); iter != futureVec.end(); ++iter) {
            cout << endl << iter->get();
        }
        for (int i = 0; i < 10; ++i) {
            thrdVec[i].join();
        }
        cout << endl << "done";

        return 0;

    } 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-14T21:45:09.337

```
 async(launch::async, foo, i, move(prmsVec[i])); 
```

此行返回 a `future`but 因为您没有将它分配给任何东西，未来的析构函数在语句末尾运行，它通过调用阻塞并等待结果`std::future::wait()`

当它返回一个未来时，你为什么要手动调用`std::async`一个承诺？异步的要点是您不需要手动使用承诺，这是在内部为您完成的。

重写你`foo()`的返回`double`然后调用它`async`

```
#include <mutex>
#include <future>
#include <thread>
#include <vector>
#include <cmath>
#include <iostream>

using namespace std;
mutex iomutex;

double foo(int i)
{
    this_thread::sleep_for(chrono::seconds(2));
    lock_guard<mutex> lg(iomutex);
    cout << "\nthread index=> " << i << ", id=> "<< this_thread::get_id();
    return sqrt(i);
}

int main()
{
    cout << "\nmain thread id=>" << this_thread::get_id();
    vector<future<double>> futureVec;

    for (int i = 0; i < 10; ++i)
        futureVec.push_back(async(launch::async, foo, i));

    for (auto& fut : futureVec)
    {
        auto x = fut.get();
        lock_guard<mutex> lg(iomutex);
        cout << endl << x;
    }

    cout << "\ndone\n";
} 
```

# php - 数组合并和删除重复问题 PHP

> ID：10584675
> 
> 赞同：2
> 
> 时间：2012-05-14T13:51:55.447
> 
> 标签：php, arrays

我有两个数组，由结果填充。

1) users_facebook & 2) users_twitter

```
Array
(
    [users_facebook] => Array
    (
        [0] => Array
            (
                [id] => "180",
                [email] => "",
                [first_name] => "Djon",
                [last_name] => "Katview"
        ),
        [1] => Array
            (
                [id] => "182",
                [email] => "",
                [first_name] => "Awaaru",
                [last_name] => "Bhejafry"
        )
    ),

    [users_twitter] => Array
    (
        [0] => Array
            (
                [id] => "180",
                [email] => "",
                [first_name] => "Djon",
                [last_name] => "Katview"
        ),
        [1] => Array
            (
                [id] => "181",
                [email] => "",
                [first_name] => "Kavritis",
                [last_name] => "Abrfafda"
        ),
        [2] => Array
            (
                [id] => "182",
                [email] => "",
                [first_name] => "Awaaru",
                [last_name] => "Bhejafry"
        )
    ),
) 
```

我想在两个数组中选择具有相同**“id”**的元素并将其附加到新数组中，比如“users_final_array”

当它附加到新数组时，我想从两个数组中删除它。

**ps** : 不匹配的元素必须保持原样.. 近 3 小时以来我一直在搞乱它

添加：

结果数组将如下所示：

```
Array
(
    [users_facebook] => Array
    (
    ),

    [users_twitter] => Array
    (
        [0] => Array
            (
                [id] => "181",
                [email] => "",
                [first_name] => "Kavritis",
                [last_name] => "Abrfafda"
            )
    ),

    [users_final_array] => Array
    (
        [0] => Array
            (
                [id] => "180",
                [email] => "",
                [first_name] => "Djon",
                [last_name] => "Katview"
        ),
        [1] => Array
            (
                [id] => "182",
                [email] => "",
                [first_name] => "Awaaru",
                [last_name] => "Bhejafry"
        )
    ),
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:56:01.210

通过解码将其转换为 json 到数组。然后尝试将这两个数组合并为一个数组。合并后使用 array_unique() 函数删除重复如下

```
array_unique($merge_array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T13:55:44.967

首先这两个数组是 JSON 数组，所以将主题解码为 php 的：

```
$array = json_decode($response, true); 
```

然后，只需使用 php "array_merge" 并选择它们（facebook 和 twitter）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:10:47.517

[array_intersect](http://php.net/array_intersect)

```
<?php

$res = '{
    "users_facebook": [
        {
            "id": "180",
            "email": "",
            "first_name": "Djon",
            "last_name": "Matfew"
        },
        {
            "id": "182",
            "email": "",
            "first_name": "Awaaru",
            "last_name": "Bhejafry"
        }
    ],
    "users_twitter": [
        {
            "id": "180",
            "email": "",
            "first_name": "Djon",
            "last_name": "Matfew"
        },
        {
            "id": "181",
            "email": "",
            "first_name": "Kavritis",
            "last_name": "Abrfafda"
        },
        {
            "id": "182",
            "email": "",
            "first_name": "Awaaru",
            "last_name": "Bhejafry"
        }
    ]
}';

$res = json_decode($res, true);

print_r(array_intersect($res['users_facebook'],$res['users_twitter']));

?> 
```

比[array_diff](http://php.net/array_diff)查看原始响应还剩下什么

# python - python中的文字字符串替换

> ID：10584679
> 
> 赞同：0
> 
> 时间：2012-05-14T13:52:06.860
> 
> 标签：python

考虑以下python中的代码片段

```
argKey = 'actualArgument'

methodA(argKey=argVal) #invoking methodA 
```

其中 methodA() 定义为：

```
def methodA(actualArgument, actualArgument2, actualArgument3) 
```

methodA 只能通过命名参数调用，即。您通过指定参数名称并传递参数值来调用。

--> 抛出错误：

```
TypeError: methodA() got an unexpected keyword argument 'argKey ' 
```

我希望通过“argKey”变量中包含的值调用“methodA”，即

```
methodA(actualArgument=argVal) 
```

如何将字符串替换为方法调用调用。？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:03:40.423

要传递具有计算名称的参数，请使用 dict：

```
def foo(a, b):
  return a+b

name_of_a = 'a'
params = {name_of_a: 1, 'b': 2}
print foo(**params) # note the asterisks 
```

# html - 如何写一个 jsp页面中haml中的选定属性

> ID：10584680
> 
> 赞同：0
> 
> 时间：2012-05-14T13:52:09.037
> 
> 标签：html, jsp, haml

我想在haml中输出这个jsp：

```
<select>
  <option ${page.defaultCar=="Volvo" ? "selected" : ""}>Volvo</option>
  <option ${page.defaultCar=="Saab" ? "selected" : ""}>Saab</option>
</select> 
```

目前如何找到的解决方案是转义整行：

```
\<option ${page.defaultCar=="Volvo" ? "selected" : ""}>Volvo</option> 
```

只是想知道是否有更聪明的方法来做到这一点。

谢谢 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:54:31.777

你可以使用这个：

```
<option '${page.defaultCar=="Volvo" ? "selected" : ""}'>Volvo</option> 
```

# svn - 在 Xcode 4 中使用 SVN 和 MacOSX Lion (10.7)

> ID：10584686
> 
> 赞同：0
> 
> 时间：2012-05-14T13:52:25.567
> 
> 标签：svn, xcode4, osx-lion

我的问题是：我应该在 SVN 服务器上上传一个项目以将其置于版本控制之下。我成功创建了一个新的存储库，插入了 url、用户名和密码，但是当我单击“根”目录时，微调器会无限旋转。我的 Mac 配置是 Lion 和 Xcode 4.3.2

![在此处输入图像描述](../Images/9e814e67da9b8e25d380cdf7fdf41442.png)

如果我使用 Xcode 4.2 和 Snow Leopard 在另一台 Mac 上创建相同的存储库，那就完美了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:24:37.670

XCode 不适用于 SVN。我建议您获取[http://versionsapp.com/](http://versionsapp.com/)来管理与您的存储库/设置/等的连接。然后您可以将 Xcode 仅用于提交/更新。当我遇到 XCode 时，我有好几次没有看到提交/更新/项目受 svn 版本控制，而 Versions 有助于解决所有问题。

# html - 如何通过触摸它来抛出 HTML5 画布元素。？

> ID：10584687
> 
> 赞同：1
> 
> 时间：2012-05-14T13:52:31.663
> 
> 标签：html

我想通过触摸它来抛出一个 html5 画布元素。我正在制作一个游戏。对不起，我不能把我之前的问题说得很清楚。提前谢谢。

# html - html5裁剪在画布上绘制的图像

> ID：10584688
> 
> 赞同：0
> 
> 时间：2012-05-14T13:52:32.180
> 
> 标签：html, canvas

我正在尝试使用我想从顶部裁剪以显示时间倒计时的图像在画布游戏中绘制计时器。

我知道我需要使用这个：

```
 ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh); 
```

但是我无法理解它，我一直在查看一些网站，但他们的解释似乎并没有引起我的注意。

下面的排序可以降低高度，因为我有一个变量倒计时来降低高度，我只需要使用它来裁剪高度而不是降低高度：

```
 ctx.drawImage(img,0,0,80,heightVar); 
```

谁能告诉我如何在 0,0 处绘制这个图像，它的宽度是 80 像素，高度是 480 像素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:01:11.377

如果我理解你的正确，你会想要做这样的事情：

```
ctx.drawImage(img, 0, 480 - heightVar, 80, heightVar,
                   0, 480 - heightVar, 80, heightVar); 
```

当仪表已满（heightVar = 480）时，这将使图像显示在 0、0 处，并随着 heightVar 的增加从上向下裁剪。我希望这可以帮助你。

您还需要确保 heightVar 保持在 (0 - 480) 区间内。否则，可能会出现鬼魂。

# c# - 在 C# 中使用 Delphi 的 stuct 数组和字符串

> ID：10584690
> 
> 赞同：4
> 
> 时间：2012-05-14T13:52:35.353
> 
> 标签：c#, delphi, pinvoke

我一直在尝试通过以下方式调用在 Delphi 中创建的方法：

```
 function _Func1(arrParams: array of TParams): Integer;stdcall;    

 type 
   TParams = record
   Type: int;
   Name: string;
   Amount : Real;
 end; 
```

我的代码是：

```
[DllImport("some.dll", EntryPoint = "_Func1", CallingConvention = CallingConvention.StdCall)]
public static extern int Func(
  [MarshalAs(UnmanagedType.LPArray, ArraySubType=UnmanagedType.Struct)] TParams[] arrParams) 
```

结构是：

```
[StructLayoutAttribute(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public struct TParams
{
  public int Type;
  [MarshalAs(UnmanagedType.AnsiBStr)]
  public string Name;
  public double Amount;
} 
```

当我调用此方法时，我收到错误消息：无法编组“TParams”类型的字段“名称”：托管/非托管类型组合无效（字符串字段必须与 LPStr、LPWStr、BStr 或 ByValTStr 配对）。

然而，这些组合都不起作用，因为 Delphi 的字符串以它的长度为前缀，而且它肯定是 Ansi（我已经尝试过使用其他字符串参数）。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:10:36.747

这有两个主要问题，使用开放数组和使用 Delphi `string`。

**开放阵列**

Delphi 开放数组是通过传递指向数组的第一个元素的指针和指定最后一项的索引的额外参数来实现的，`high`在 Delphi 术语中。有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/7944447/how-do-i-use-c-sharp-to-call-a-function-that-receives-a-delphi-open-array-parame#7944655)。

**德尔福字符串**

C# 编组器无法与 Delphi 字符串互操作。Delphi 字符串是私有类型，只能在 Delphi 模块内部使用。相反，您应该使用以 null 结尾的字符串，`PAnsiChar`.

* * *

把它们放在一起，你可以这样写：

**德尔福**

```
type 
  TParams = record
    _Type: Integer;//Type is a reserved word in Delphi
    Name: PAnsiChar;
    Amount: Double;
  end;

function Func(const arrParams: array of TParams): Integer; stdcall; 
```

**C＃**

```
[StructLayoutAttribute(LayoutKind.Sequential)]
public struct TParams
{
  public int Type;
  public string Name;
  public double Amount;
}

[DllImport("some.dll")]
public static extern int Func(TParams[] arrParams, int high);

TParams[] params = new TParams[len];
...populate params
int retval = Func(params, params.Length-1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T14:05:34.227

为了恭维大卫的回答，您*可以*编组到德尔福字符串，但这很丑陋。在 C# 中，您必须将结构中的所有字符串替换为`IntPtr`.

```
private static IntPtr AllocDelphiString(string str)
{
    byte[] unicodeData = Encoding.Unicode.GetBytes(str);
    int bufferSize = unicodeData.Length + 6;

    IntPtr hMem = Marshal.AllocHGlobal(bufferSize);

    Marshal.WriteInt32(hMem, 0, unicodeData.Length); // prepended length value

    for (int i = 0; i < unicodeData.Length; i++)
        Marshal.WriteByte(hMem, i + 4, unicodeData[i]);

    Marshal.WriteInt16(hMem, bufferSize - 2, 0); // null-terminate

    return new IntPtr(hMem.ToInt64() + 4);
} 
```

这可以直接发送到 Delphi，在那里它会被正确地读取为字符串。

请记住，您**必须**在完成后释放该字符串。但是，`GlobalFree()`不能直接在指向字符串的指针上调用，因为它不指向分配的开始。您必须将该指针转换为 long，然后减去 4，然后将其转换回指针。这补偿了长度前缀。

# php - 如何按日期对 Twitter 朋友/关注者进行排序？

> ID：10584698
> 
> 赞同：3
> 
> 时间：2012-05-14T13:53:05.517
> 
> 标签：php, sorting, twitter

我想按照他们关注我的顺序显示 Twitter 用户。

我可以使用这个 Twitter API 调用来获取我的关注者列表

```
https://api.twitter.com/1/followers/ids.json?screen_name=edent 
```

这将返回一个 ID 列表，这些 ID**按**他们关注我的时间排序：

```
574597584,531113272,787166,1060121,
etc 
```

然后我必须调用*用户/查找*来获取所有用户的数据

```
https://api.twitter.com/1/users/lookup.xml?user_id=574597584,531113272,787166,... 
```

这是问题 - users/lookup is **unsorted**。每次我调用它时，我都会以不同的顺序让用户返回。

使用 PHP将*用户/查找*排序为与*关注者/ID***相同的顺序**的最有效方法是什么？

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T11:35:30.433

根据 ilanco 的评论，这是订购 Twitter 朋友/关注者的方法

```
// Get all the user ID of the friends   
$request_ids = "https://api.twitter.com/1/friends/ids.json?screen_name={$user}"; 
```

这会按顺序返回所有 ID 的 JSON 列表

它们需要以 1、2、3、4 的形式发送使用用户/查找

```
// Construct the request
$request = "https://api.twitter.com/1/users/lookup.xml?user_id=".$user_ids; 
```

然后，遍历用户数组，从第一个数组中查找用户ID，按照第一个数组中的顺序将用户放入一个新数组中

```
$sortedUsers = array();

foreach ($users as $user) {
    $user_id = $user->id;       
    $key = array_search($user_id, $ids);
    $sortedUsers[$key] = $user;
} 
```

按键排序新数组

```
ksort($sortedUsers); 
```

它相当粗糙，但它确实有效。*

# jquery - Jquery UI datepicker 限制选择 [工作日]

> ID：10584701
> 
> 赞同：0
> 
> 时间：2012-05-14T13:53:12.303
> 
> 标签：jquery, datepicker

## 已解决：http : [//jsfiddle.net/YV34P/5/](http://jsfiddle.net/YV34P/5/)

我正在尝试设置 datepicker 以将选择范围限制为 5 天。

这可以正常工作，但问题是这一天必须是“工作日”，没有周日和周六，这意味着如果我选择 5 月 18 日星期五，我的限制将是 5 月 24 日星期四。

任何想法？我有以下代码：

```
$('.datepicker').datepicker({
            dayNames: ["Domingo", "Lunes", "Martes", "Miercoles", "Jueves", "Viernes", "Sábado"],
            dayNamesMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
            monthNames: ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],
            //dateFormat: "DD, dd MM yy",
            //altFormat: "DD, dd MM yy",
            dateFormat: "dd M yy",
            showAnim: "drop",
            beforeShow: LimitaRango,
            beforeShowDay: $.datepicker.noWeekends
    });

function LimitaRango(input){
    if (input.id == 'FechaHasta'){
        var minDate = new Date($('#FechaDesde').val());
        minDate.setDate(minDate.getDate() + 1);
        var maxDate = new Date($('#FechaDesde').val());
        maxDate.setDate(maxDate.getDate() + 5);
        return {
            minDate: minDate,
            maxDate: maxDate
            };
        }
} 
```

这个HTML：

```
<tr>
      <td>Fecha Desde:</td>
      <td colspan="2"><input type="text" name="FechaDesde" size="40" class="datepicker" id="FechaDesde"></td>
</tr>    
<tr>
      <td>Fecha Hasta:</td>
      <td colspan="2"><input type="text" name="FechaHasta" size="40" class="datepicker" id="FechaHasta"></td>
    </tr> 
```

**PS：非常感谢您的帮助，但问题是识别周末。现在，我有这个工作，但是如果用户选择“星期五”，我的目标是将他的选择限制在星期四，但是现在，使用此代码，它仅限于“星期四”，因为周末包括在“5 天”中" 从选定的开始日期开始。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:59:39.940

您可以使用以下代码禁用周末：

```
$("#element").datepicker(
    {
        beforeShowDay: $.datepicker.noWeekends
    }
); 
```

编辑：要禁用指定的日期，请查看： [Can the jQuery UI Datepicker is made to disables Saturdays and Sundays (and holiday)?](https://stackoverflow.com/questions/501943/can-the-jquery-ui-datepicker-be-made-to-disable-saturdays-and-sundays-and-holid)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T23:05:40.057

您想要的是从今天到未来六天的任何时间。因此，您需要设置选项 maxDate。

```
var maxd = Date();
maxd.setTime( maxd.getTime() + (1000 * 3600 * 24 * 6) );
$('.datepicker').datepicker({
    ... // existing options
    maxDate: maxd,
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:04:28.987

使用**beforeShowDay**事件来限制日期的可选择性。如果此函数返回 false，则该日期将无效

IE

```
beforeShowDay:
function(date) {
    var dayOfWeek = date.getUTCDay();
    if(dayOfWeek ==0 || dayOfWeek ==6) //0= Sunday 6= Saturday
    {
      return false;

    }
    else
    {
      return true;
    }
} 
```

有关更多详细信息，请参阅[http://jqueryui.com/demos/datepicker/#event-beforeShowDay](http://jqueryui.com/demos/datepicker/#event-beforeShowDay) 和[jQuery ui datepicker，从 onSelect 获取星期几](https://stackoverflow.com/questions/5237478/jquery-ui-datepicker-get-day-of-week-from-onselect)

# python - 从 strace 输出中提取唯一的系统调用名称（通过正则表达式？）

> ID：10584702
> 
> 赞同：1
> 
> 时间：2012-05-14T13:53:12.233
> 
> 标签：python, c, regex, linux, notepad++

我有一个由[strace](http://linux.die.net/man/1/strace)生成的文件，其中包含所有系统调用。现在我想获取所有系统调用的名称。因此，如果我`mprotect`列出了 4 次，我只需要列出 1 次，即我只需要列出唯一的系统调用。

想到的一种方法是使用 python 或任何其他支持解析正则表达式的语言使用正则表达式，以首先查看所有系统调用，然后消除重复项。为此，我首先尝试使用 notepad++ 的搜索功能来测试我的正则表达式。我想匹配这样的任何东西，`blah(`. 为此，我设计了以下正则表达式

`[a-zA-Z_](`

但记事本什么也没找到。您认为正确的正则表达式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T13:58:01.913

为什么你认为你需要正则表达式呢？的输出`strace`是一系列行，每行以

```
<c_identifier>( 
```

和 C 标识符不能包含`(`，因此您可以只使用该部分`(`来获取系统调用的名称。在 Python 中，这个单线计算一组不同的系统调用：

```
syscalls = set(ln.split('(', 1)[0] for ln in strace_output) 
```

（如果您宁愿在 shell 中工作而不是在 Python 中工作，也可以在一行 Awk 中执行此操作。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T13:57:46.437

Notepad++ 应该告诉你**无效的正则表达式**。最新版本可以。

在正则表达式中，括号具有特殊含义，因此您必须对其进行转义：

```
[a-zA-Z_]\( 
```

会在 中找到`h(`，`blah(`因为括号中的部分没有被量化（正如@CharlesDuffy 指出的那样）。

要匹配整个`blah(`，请使用

```
[a-zA-Z_]+\( 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T13:57:59.553

应该是`[a-zA-Z_]+\(`。这是因为圆括号被用作元字符。

# jquery - 使用 jQuery Mobile swiperight 检测滑动速度

> ID：10584705
> 
> 赞同：1
> 
> 时间：2012-05-14T13:53:25.377
> 
> 标签：jquery, mobile, swipe

我正在使用 jQuery Mobile，我想检测滑动的速度以使用轮播创建“轻弹”效果。

有没有办法确定刷卡的速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:30:10.263

我现在实际上正在研究另一个脚本的模型。一旦我弄清楚了，我会在这里更新。

# c# - 通过 EWS 发送电子邮件时使用自定义显示名称

> ID：10584708
> 
> 赞同：9
> 
> 时间：2012-05-14T13:53:30.727
> 
> 标签：c#, web-services, email, exchange-server, exchangewebservices

我正在使用`EWS (Exchange Web Services)`with`Exchange 2010`在我们的组织内部生成和发送电子邮件。我们目前有一个邮箱/用户，我们所有的应用程序都通过调用来发送`app`。

生成电子邮件是没有问题的，但是当发送测试消息时，无论在代码中设置什么**显示名称，它都会以****默认帐户名称在收件人的邮箱中接收到 exchange 。**

 **示例代码：

```
EmailMessage message = new EmailMessage(ExchangeManager.CreateConnection());

// set from address as generic application account
message.From = new EmailAddress("app@company.com");

// set custom display name for sender email
message.From.Name = "Test Display Name";

// set send recipient as myself for testing
message.ToRecipients.Add(new EmailAddress("myaccount@company.com"));

ExchangeManager.SendExchangeMessage(message); 
```

收到消息，但它显示为`app`帐户的默认名称，而不是上面代码中使用的“测试显示名称”。请参阅下面的 Outlook 收件箱屏幕截图：

![收件箱视图](../Images/77e56fc2113af40600e2450ed95493fc.png)

这种方法在使用 Exchange 2003 STMP 服务时效果很好 - 我们可以根据需要对地址进行格式化，例如“Intranet Generated Mail”或“Some Other Application”等。现在使用 Exchange 2010 和 EWS 似乎不会允许我们使用此选项使用自定义显示名称。

我还通过调试验证了在发送消息之前已成功设置显示名称。

是否有人在 EWS/Exchange 2010 中成功使用了自定义显示名称？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-15T04:24:51.257

（用 C# 术语说话）通常的方法

> 电子邮件地址（）

有一个重载，您可以在其中指定显示名称：

> message.From = new EmailAddress("自定义显示名称", "app@company.com");

试试上面的代码看看。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-05-14T14:02:34.653

我使用 EWS，但我不必手动设置显示名称，因为我事先在 Exchange 中对其进行了配置。换句话说，在 Exchange 中更改您的“应用”帐户的显示字段，您无需在程序中手动设置它。**

# java - 用于绘制概率树图的 Java 图形库

> ID：10584712
> 
> 赞同：7
> 
> 时间：2012-05-14T13:53:40.503
> 
> 标签：java, graph, diagram

是否有任何 Java 库可以让我绘制以下图表？[不幸的是， JFreeChart](http://www.jfree.org/jfreechart/)不包括这类图表。

![在此处输入图像描述](../Images/c844240c2e9441400a9fe662be91f857.png)

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:40:47.070

尝试[jgraph](http://www.jgraph.com/jgraph.html)或创建一个[graphviz](http://www.graphviz.org/)文件并单独渲染它或使用[Java graphviz API](http://www.loria.fr/~szathmar/off/projects/java/GraphVizAPI/index.php)。

# java - 将 JBehave 与 SpringJUnit4ClassRunner 结合以启用事务回滚

> ID：10584714
> 
> 赞同：9
> 
> 时间：2012-05-14T13:53:43.717
> 
> 标签：java, spring, hibernate, junit, jbehave

**本质：**

如何在使用**JBehave**运行的 JUnit 测试中**自动回滚**我的**休眠事务**？

 **问题似乎是 JBehave 想要但根据需要`SpringAnnotatedEmbedderRunner`注释测试。`@Transactional``SpringJUnit4ClassRunner`

我试图找到一些关于如何使用 实现回滚`SpringAnnotatedEmbedderRunner`或使 JBehave 工作的文档，`SpringJUnit4ClassRunner`但我都无法工作。

有没有人有一个（最好是简单的）设置来运行带有 Spring 和 Hibernate 以及事务自动回滚的 JBehave 故事？

* * *

* * *

**到目前为止有关我的设置的更多信息：**

使用 Spring 工作 JBehave - 但不使用自动回滚：

```
@RunWith(SpringAnnotatedEmbedderRunner.class)
@Configure(parameterConverters = ParameterConverters.EnumConverter.class)
@UsingEmbedder(embedder = Embedder.class, generateViewAfterStories = true, ignoreFailureInStories = false, ignoreFailureInView = false)
@UsingSpring(resources = { "file:src/main/webapp/WEB-INF/test-context.xml" })
@UsingSteps
@Transactional // << won't work
@TransactionConfiguration(...) // << won't work
// both require the SpringJUnit4ClassRunner 

public class DwStoryTests extends JUnitStories {

    protected List<String> storyPaths() {

        String searchInDirectory = CodeLocations.codeLocationFromPath("src/test/resources").getFile();
        return new StoryFinder().findPaths(searchInDirectory, Arrays.asList("**/*.story"), null);
    }

} 
```

在我的测试步骤中，我可以`@Inject`做得很好：

```
@Component
@Transactional // << won't work
public class PersonServiceSteps extends AbstractSmockServerTest {

    @Inject
    private DatabaseSetupHelper databaseSetupHelper;

    @Inject
    private PersonProvider personProvider;

    @Given("a database in default state")
    public void setupDatabase() throws SecurityException {
        databaseSetupHelper.createTypes();
        databaseSetupHelper.createPermission();
    }

    @When("the service $service is called with message $message")
    public void callServiceWithMessage(String service, String message) {
        sendRequestTo("/personService", withMessage("requestPersonSave.xml")).andExpect(noFault());
    }

    @Then("there should be a new person in the database")
    public void assertNewPersonInDatabase() {
        Assert.assertEquals("Service did not save person: ", personProvider.count(), 1);
    } 
```

（是的，databaseSetupHelper 方法都是事务性的）

PersonProvider 基本上是一个`org.springframework.data.jpa.repository.support.SimpleJpaRepository`. 所以可以访问 entityManager 但控制事务（使用开始/回滚）不起作用，我猜是因为`@Transactional`在该助手类内部完成的所有 s 。

我还读到 JBehave 在不同的上下文中运行？会话？什么？这会导致对测试开始的事务失去控制？很混乱的东西。。

* * *

**编辑：**

编辑上面的改写帖子以反映我当前的知识并缩短整个内容，以便问题变得更加明显并且设置不那么突兀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T08:36:23.000

我认为您可以跳过 SpringAnnotatedEmbedderRunner 并自己为 JBehave 提供必要的配置。例如，而不是

```
@UsingEmbedder(embedder = Embedder.class, generateViewAfterStories = true, ignoreFailureInStories = false, ignoreFailureInView = false) 
```

你可以做

```
configuredEmbedder()
.embedderControls()
.doGenerateViewAfterStories(true)
.doIgnoreFailureInStories(false)
.doIgnoreFailureInView(false); 
```

另外：为什么要回滚事务？通常，您使用 JBehave 进行验收测试，这些测试在类似生产的环境中运行。例如，您首先在数据库中设置一些数据，通过浏览器/Selenium 访问它并检查结果。为此，必须提交数据库事务。测试后是否需要手动清理，可以在 @AfterStories 或 @AfterScenario 带注释的方法中进行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-09T21:34:22.807

我通过手动控制事务范围使其工作，在每个场景之后回滚它。只需按照官方指南如何将 Spring 与 JBehave 一起使用，然后执行如下所示的技巧。

```
@Component
public class MySteps
{
    @Autowired
    MyDao myDao;

    @Autowired
    PlatformTransactionManager transactionManager;

    TransactionStatus transaction;

    @BeforeScenario
    public void beforeScenario() {
        transaction = transactionManager.getTransaction(new DefaultTransactionDefinition());
    }

    @AfterScenario
    public void afterScenario() {
        if (transaction != null)
            transactionManager.rollback(transaction);
    }

    @Given("...")
    public void persistSomething() {
        myDao.persist(new Foo());
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:18:24.487

我不熟悉 JBehave，但您似乎正在搜索此注释。

```
@TransactionConfiguration(transactionManager = "transactionManager", defaultRollback = true). 
```

您还可以在 testContext 中将 defaultRollback 设置为 true。**

# jquery - tablesorter，不会按日期正确排序

> ID：10584718
> 
> 赞同：3
> 
> 时间：2012-05-14T13:53:50.667
> 
> 标签：jquery, html, css, tablesorter

如果有空格，tablesorter 的行为是否会有所不同？

我对 tablesorter 很陌生，但我被要求很快将其添加到客户站点（特别是允许他们按发布日期排序）。据我所知，日期（例如 2012 年 5 月 14 日）被读取为文本，因此我需要添加一个解析器将其更改为数字，以便正确排序。（例如 14052012）

我有这个（目前使用其他开发人员编写的代码 - 位于 tablesorter.js 中）。

```
$.tablesorter.addParser({
id: 'dayMonthYear',
is: function(s) {
    return false;
},
format: function(s) {           

    var date = s.match(/^(\d{1,2})[ ](\w{3})[ ](\d{4})$/);
    var day = String(date[1]);
    if (day.length == 1) {
        day = "0" + day;
    }        

    var month = monthNames[date[2]];
    var year = date[3];
    var sortableDate = '' + year + month + day;
    return sortableDate;
},
type: 'numeric'  
});

var monthNames = {};
monthNames["Jan"] = "01";
monthNames["Feb"] = "02";
monthNames["Mar"] = "03";
monthNames["Apr"] = "04";
monthNames["May"] = "05";
monthNames["Jun"] = "06";
monthNames["Jul"] = "07";
monthNames["Aug"] = "08";
monthNames["Sep"] = "09";
monthNames["Oct"] = "10";
monthNames["Nov"] = "11";
monthNames["Dec"] = "12"; 
```

我也有这个放在 html 页面中

```
$("table#searchresults").tablesorter ({
    headers: {
        0: {sorter:'dayMonthYear'}
    }
}); 
```

尽管我已经看到此代码有效，但它似乎对我不起作用。该月仍以文本形式读取。

有任何想法吗？我唯一能看到的工作演示和我的站点之间的不同之处在于，表格中有大量空白，这可能是个问题吗？

* * *

编辑：刚刚发现这个[http://beausmith.com/blog/custom-date-sorting-for-jquery-tablesorter-plugin/](http://beausmith.com/blog/custom-date-sorting-for-jquery-tablesorter-plugin/)看起来对上面的代码很熟悉。希望它有帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T10:45:40.393

得到它的工作..呸

```
$.tablesorter.addParser({
id: 'dayMonthYear',
is: function(s) {
    return false;
},
format: function(s) {       

    s = $.trim(s.replace(/\s+/g, ' '));

    var date = s.match(/^(\d{1,2})[ ](\w{3})[ ](\d{4})$/);
    var day = String(date[1]);
    if (day.length == 1) { day = "0" + day;}        
    var month = monthNames[date[2]];
    var year = date[3];

    return sortableDate = '' + year + month + day;
},
type: 'numeric'  
});
var monthNames = {};
monthNames["Jan"] = "01";
monthNames["Feb"] = "02";
monthNames["Mar"] = "03";
monthNames["Apr"] = "04";
monthNames["May"] = "05";
monthNames["Jun"] = "06";
monthNames["Jul"] = "07";
monthNames["Aug"] = "08";
monthNames["Sep"] = "09";
monthNames["Oct"] = "10";
monthNames["Nov"] = "11";
monthNames["Dec"] = "12"; 
```

# xhtml - 编辑 portlet（xhtml 部分）而不进行部署

> ID：10584720
> 
> 赞同：2
> 
> 时间：2012-05-14T13:53:59.083
> 
> 标签：xhtml, primefaces, liferay, edit

我有一个关于 portlet 'hot-edition' 的问题。我希望我可以更改 xhtml 文件中的一些代码行，并在刷新 LR 6.1 站点时看到这些更改。我正在使用 6.1 版本 + Primefaces 3.2 开发 portlet。

在某些情况下，我可以更改某些内容并查看更改，但是当我遇到错误时，就像一切都被阻止了，我必须重新部署 portlet 编译并再次生成战争。所以，在这个过程中浪费了很多时间。

任何人都知道如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T05:24:08.100

您是否使用 Liferay IDE 和 Eclipse 进行开发？如果是，那么您可以将插件 portlet 项目添加到服务器，并且每当您对项目中的任何文件进行一些更改时，只需右键单击并说发布，您的更改就会被反映。

或者，如果添加到服务器的项目发生任何更改，您也可以配置为自动发布。

希望这可以帮助。

# android - 加油计算（全部和部分）

> ID：10584721
> 
> 赞同：0
> 
> 时间：2012-05-14T13:53:59.323
> 
> 标签：android, sql, sqlite

在我的一个应用程序中，我需要计算油耗，其中考虑了完全加油和部分加油。我的 Android 应用程序基于 SQLite 语法和功能。

我尝试在 SQL 中解决这个难题，并且不想遍历所有行以编程方式完成这些事情。

结果列表中应省略 FULL='N' 的行，但应将其值添加到下一个 FULL='Y' 行。至少这是我的想法。

这是 DML（仅显示必需的列）：

```
CREATE TABLE FUELINGS (
ID INTEGER PRIMARY KEY,
MILEAGE INTEGER,
VOLUME DECIMAL(8, 2),
FULL CHAR(1)); 
```

这是该表的一些输入：

```
INSERT INTO FUELINGS VALUES(1,22995,29.48,'Y');
INSERT INTO FUELINGS VALUES(2,23385,31.27,'Y');
INSERT INTO FUELINGS VALUES(3,23869,16.71,'N');
INSERT INTO FUELINGS VALUES(4,24065,33.18,'Y');
INSERT INTO FUELINGS VALUES(5,24485,30.59,'Y');
INSERT INTO FUELINGS VALUES(6,24956,33.78,'Y'); 
```

好的，问题来了。这是我使用的查询：

```
SELECT T2.MILEAGE, 
       T2.VOLUME, 
       T2.FULL, 
       T2.PREVMILEAGE, 
       T2.PREVVOLUME, 
       T2.PREVFULL, 
       100 * T2.VOLUME / ( T2.MILEAGE - T2.PREVMILEAGE ) 
FROM   (SELECT T.MILEAGE, 
               T.VOLUME, 
               T.FULL, 
               T.PREVMILEAGE, 
               (SELECT VOLUME 
                FROM   FUELINGS 
                WHERE  MILEAGE = T.PREVMILEAGE 
                       AND MILEAGE IS NOT NULL 
                       AND MILEAGE > 0 
                       AND VOLUME IS NOT NULL 
                       AND VOLUME > 0) AS PREVVOLUME, 
               (SELECT FULL 
                FROM   FUELINGS 
                WHERE  MILEAGE = T.PREVMILEAGE 
                       AND MILEAGE IS NOT NULL 
                       AND MILEAGE > 0 
                       AND VOLUME IS NOT NULL 
                       AND VOLUME > 0) AS PREVFULL 
        FROM   (SELECT F.MILEAGE, 
                       F.VOLUME, 
                       F.FULL, 
                       (SELECT Max(MILEAGE) 
                        FROM   FUELINGS PREV 
                        WHERE  PREV.MILEAGE < F.MILEAGE 
                               AND MILEAGE IS NOT NULL 
                               AND MILEAGE > 0 
                               AND VOLUME IS NOT NULL 
                               AND VOLUME > 0) AS PREVMILEAGE 
                FROM   FUELINGS F 
                WHERE  MILEAGE IS NOT NULL 
                       AND MILEAGE > 0 
                       AND VOLUME IS NOT NULL 
                       AND VOLUME > 0) AS T 
        WHERE  PREVMILEAGE IS NOT NULL) AS T2 
ORDER  BY T2.MILEAGE; 
```

这是结果：

```
T2.MILEAGE  T2.VOLUME   T2.FULL T2.PREVMILEAGE  T2.PREVVOLUME   T2.PREVFULL 100 * T2.VOLUME / (T2.MILEAGE - T2.PREVMILEAGE)
23385   31.27   Y   22995   29.48   Y   8.017948717948718
23869   16.71   N   23385   31.27   Y   3.4524793388429753
24065   33.18   Y   23869   16.71   N   16.928571428571427
24485   30.59   Y   24065   33.18   Y   7.283333333333333
24956   33.78   Y   24485   30.59   Y   7.171974522292993 
```

16.92 是错误的，因为之前的加油是部分加油。我需要对这两行进行求和并计算。我知道可能有不止 1 次部分加油。但我不知道如何构建 FULL='N' 值的范围，将它们相加并将它们添加到以下 FULL='Y' 值。

可以请有人把我放在正确的方向。我怎样才能做到这一点？

提前谢谢了。

**编辑/解决方案：**

```
SELECT T.MILEAGE,
       T.PREVMILEAGE,
       SUM(VOLUME),
       100 * SUM(VOLUME) / ( T.MILEAGE - T.PREVMILEAGE )
FROM   (SELECT F1.MILEAGE      AS MILEAGE,
               MAX(F2.MILEAGE) AS PREVMILEAGE
        FROM   FUELINGS F1
               LEFT OUTER JOIN FUELINGS F2
                 ON F1.MILEAGE > F2.MILEAGE
                    AND F2.FULL = 'Y'
                    AND F2.MILEAGE IS NOT NULL
                    AND F2.MILEAGE > 0
                    AND F2.VOLUME IS NOT NULL
                    AND F2.VOLUME > 0.0
        WHERE  F1.FULL = 'Y'
               AND F1.MILEAGE IS NOT NULL
               AND F1.MILEAGE > 0
               AND F1.VOLUME IS NOT NULL
               AND F1.VOLUME > 0.0
        GROUP  BY F1.MILEAGE) AS T,
       (SELECT VOLUME
        FROM   FUELINGS F3
        WHERE  F3.MILEAGE > T.PREVMILEAGE
               AND F3.MILEAGE <= T.MILEAGE)
GROUP  BY T.MILEAGE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:23:13.353

如果您有一个名为 FuelingsFull 的表，该表仅包含有关完整加油的完整信息，则您的原始查询将起作用。这可以从Fueling中总结出来。使用窗口函数，这个过程会更简单，但你在 SQLite 中没有这些。

所以，这里有一个关于如何做到这一点的想法。首先，获取之前的完整 id：

```
select f1.id, max(f2.full) as prevFullId
from fuelings f1 left outer join
     fuelings f2
     on f1.id > f2.id and
        f2.full = 0
group by f1.id 
```

现在，您拥有一组属于同一类的燃料。下一个查询将其连接回燃料，然后将它们组合在一起。

```
select fills.id, max(mileage) as mileage, sum(volume) as volume, count(*) as numFills
from fuelings f join
     (select f1.id, max(f2.full) as prevFullId
      from fuelings f1 left outer join
           fuelings f2
           on f1.id > f2.id and
              f2.full = 1
      group by f1.id
     ) fills
     on f.id > fills.prevFullId and f.id <= fills.id
  group by fills.id 
```

将此作为您的 FuelingFull，您的原始查询应该可以工作。

# orbeon - 表单生成器中的 orbeon 自定义 xbl 组件

> ID：10584727
> 
> 赞同：0
> 
> 时间：2012-05-14T13:54:26.337
> 
> 标签：orbeon

我正在尝试创建一个自定义组件，当它在表单构建器中实例化时，它将在 fr-form-instance 中包含一个包含子节点的节点，而不仅仅是教程中所示的单个节点： [http ://wiki.orbeon.com /forms/doc/developer-guide/xbl-components-guide#TOC-Event-handling](http://wiki.orbeon.com/forms/doc/developer-guide/xbl-components-guide#TOC-Event-handling)。

例如，如果我在 form-b​​uilder 中实例化教程输入组件：

```
.....

    <fb:metadata>
        <fb:display-name lang="en">Custom Component</fb:display-name>
        <fb:datatype>xforms:string</fb:datatype>
        <fb:template>
            <cc:test ref=""/>
        </fb:template>
    </fb:metadata>   
    <xbl:binding element="fr|tutorial-input" id="fr-tutorial-input">
        <xbl:template>
            <xforms:group xbl:attr="model context ref bind" xxbl:scope="outer">
                <xbl:content includes="xforms|label,xforms|help,xforms|hint,xforms|alert"/>
                <xforms:group xxbl:scope="inner">
                    <xxforms:variable name="binding" as="node()?">
                        <xxforms:sequence select="." xxbl:scope="outer"/>
                    </xxforms:variable>
                    <xforms:input ref="$binding"/>
                </xforms:group>
            </xforms:group>
        </xbl:template>
    </xbl:binding>

..... 
```

表单生成器在 fr-form-instance 中只有一个节点：

```
.....
    <xforms:instance id="fr-form-instance">
        <form>
            <section>
                <contorl-x/> //only one node
..... 
```

我想做的是：

```
.....
    <xforms:instance id="fr-form-instance">
        <form>
            <section>
                <contorl-x>// x child nodes 
                    <contorl-x-child-one> 
                    <contorl-x-child-two> 
                       .....
                </contorl-x> 
..... 
```

是否有可能做到这一点？是否存在与此类似的其他组件/示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T01:39:53.853

部分模板做类似的事情：

*   插入节模板时，Form Builder 仅插入一个元素
*   部分模板组件在运行时变得可见时插入其嵌套元素

您可以看到这是如何在[`form-to-xbl.xsl`](https://github.com/orbeon/orbeon-forms/blob/master/src/resources/forms/orbeon/builder/service/form-to-xbl.xsl#L271).

类似地，[这里是一个](https://gist.github.com/2156397)XBL 组件的原型，它在缺少元素时创建一个元素。

现在魔鬼在细节中。您必须特别确定：

*   当组件创建其嵌套元素时
*   是否会删除它们

此外，要记住的一件事是 XBL 组件本身目前无法验证嵌套元素。只有具有由表单生成器生成的绑定的顶级元素才能验证数据。

部分模板通过验证 XBL 组件本身中的子实例来解决此问题。

# ios - 当我的应用程序被点击时启动newstand

> ID：10584728
> 
> 赞同：0
> 
> 时间：2012-05-14T13:54:26.587
> 
> 标签：ios, ios5, newsstand-kit

有没有一种方法，我们可以在 iPhone 的主屏幕上显示一个应用程序图标，然后点击该应用程序以杂志作为参数打开 Newsstand 应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T15:26:05.050

You can use custom URLs in ios. Check out Apple's documentation [here](https://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/AdvancedAppTricks/AdvancedAppTricks.html)

To give you some brief: You app can register for custom url schema (e.g. yourapp://whatever_you_want.com?param1=value@param2=value

> To communicate with an app using a custom URL, create an NSURL object with some properly formatted content and pass that object to the openURL: method of the shared UIApplication object. The openURL: method launches the app that registered to receive URLs of that type and passes it the URL. At that point, control passes to the new app.

# c++ - 绘制线程上下文切换的工具

> ID：10584730
> 
> 赞同：0
> 
> 时间：2012-05-14T13:54:31.040
> 
> 标签：c++, multithreading, profiling

我正在寻找一种用于性能分析和调试的工具，它可以绘制线程上下文切换，也许还有信号量状态、事件，......我在嵌入式世界中使用过类似的工具，但我现在正在寻找相同的工具Windows 或 Linux 平台。我要分析的应用程序是一个 c++ 多线程应用程序。有没有人为此推荐一个工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:17:57.770

对于 Linux 和 Solaris，来自 Oracle Solaris Studio 的**Oracle 线程分析器**（尽管它的名字也可以在 Linux 上运行）可以深入了解多线程应用程序的性能问题。此外 Oracle Solaris Studio*仍然是免费*的。

**英特尔 VTune Amplifier XE**（以前称为英特尔线程分析器）可在 Linux 和 Windows 上使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T10:58:02.693

在 Windows 上，您可以使用 xperf 工具来收集和绘制上下文切换。它是一个免费工具，是[Windows 性能分析开发人员中心](http://msdn.microsoft.com/en-us/performance/cc709422)的一部分。对我来说效果很好，请参见屏幕截图。 ![xperf 为我的应用程序的线程显示上下文切换](../Images/6d439dc241f01d97fa8b49104794c6aa.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T13:59:00.227

可能这不是您正在考虑的工具，但它简单、快速且很有用。

使用 GDB 时，您可以键入：

```
info threads 
```

查看有关正在运行的线程的信息。接下来，您可以切换到所选线程并打印回溯以查看它的位置：

```
thread <thread-id>
bt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T13:58:43.940

Windows 性能监视器？

[`perfmon.exe`](http://technet.microsoft.com/en-us/library/cc749249.aspx)

我认为它是大多数 Windows 平台上的标准，并提供有关上下文切换的信息等等。

恐怕只有Windows。

# mysql - 组合 2 个表 - 子查询返回多于 1 行

> ID：10584738
> 
> 赞同：0
> 
> 时间：2012-05-14T13:54:54.970
> 
> 标签：mysql, sql, join, phpmyadmin

当我加入 2 个表时，出现错误

```
select * from picture where id=(SELECT id FROM user where age= 40 ) 
```

> #1242 - 子查询返回多于 1 行

加入这两个大型数据表的最佳方法是什么？我想要所有的结果

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T13:56:55.340

替换`=`为`IN`

```
select * from picture where id in (select id from user where age = 40) 
```

请注意，这只是“半连接”这两个表，即您只会得到图片作为结果，而不是图片-用户关系。如果您实际上是在尝试执行后者，那么您将不得不`inner join`使用两个表：

```
select * from picture p
join user u on p.id = u.id -- are you sure about this join condition?
where u.age = 40 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T13:58:15.187

在 where 子句中，当您为 赋值时`id`，SQL 需要一个值。问题是第二个查询`SELECT id FROM user where age= 40`返回不止一行。

你能做的是

```
select * 
from picture 
where id in
    (select id from user where age = 40) 
```

**或者**

```
select *
from picture p, user u
where p.id = u.id
and u.age = 40 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T13:57:33.247

尝试使用 'IN' 而不是 '='

```
select * from picture where id IN (SELECT id FROM user where age= 40 ) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T14:15:07.220

**从我所看到的猜测中，**

您有一个“图片”表和一个“用户”表。

1.  表名应该是复数。使其成为“图片”和“用户”。
2.  首先定义你的关系。在您的情况下，一个用户有_许多图片，而一张图片属于_一个用户。（一张图片[在一个和平的世界上]不会属于许多用户）。
3.  在您的图片表中，有一个“user_id”列并使用适当的 user_ids 填充该列。
4.  现在，

**您想要所有年龄正好是 40 岁的用户的照片。**

你可以做一个，

```
SELECT *   
FROM pictures 
WHERE user_id IN (SELECT user_id 
                  FROM users 
                  WHERE user_age = 40) 
```

那是你的要求吗？我有任何意义吗？

# objective-c - 从 sendAsynchronousReques 返回数据

> ID：10584741
> 
> 赞同：0
> 
> 时间：2012-05-14T13:55:08.327
> 
> 标签：objective-c, asynchronous, callback, return

`NSURLConnection`目标 c：我有一个使用and连接到数据库的 serviceClass `sendAsynchronousRequest`。

我希望能够使用这个类方法并将 db-data 返回给任何其他请求它的类方法。

但是由于`sendAsynchronousRequest`返回 void - 我该怎么做？

我根本无法理解它。块？但是怎么...

请帮忙

atm 我正在下面的代码块中直接创建一个用户对象：

```
[NSURLConnection
 sendAsynchronousRequest:urlRequest
 queue:[[NSOperationQueue alloc] init]
 completionHandler:^(NSURLResponse *urlResponse,
                     NSData *data,
                     NSError *error) {

     if ([data length] > 0 && error == NULL){ // do success or error call with true or    false
         NSMutableData *incomingData;
         if(!incomingData) {
             incomingData = [[NSMutableData alloc]init];
         }
         [incomingData appendData:data];
         NSString *string = [[NSString alloc]initWithData:incomingData
                                                 encoding:NSUTF8StringEncoding];
         //incomingData = nil;

         // create dictionary from json
         NSData *jsondata = [NSData dataWithData:incomingData];
         NSMutableDictionary *userDictionary = [NSJSONSerialization JSONObjectWithData:jsondata 
                                                                                  options:NSJSONReadingMutableContainers 
                                                                                    error:NULL];
         // create user object
         User *user = [User userFromDictionary:userDictionary];
         NSLog(@"user back to object successfull!! %@", user);

     }

     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:17:50.993

您可以使用incomingData 的属性，然后使用该属性将数据传递给其他方法/类。

```
@property (nonatomic, retain) NSMutableData * incomingData; 
```

现在您可以使用`self.incomingData`设置值，并且您需要返回。您可以在其他方法中使用它，当您需要将其传递给其他类时，您可以传递它。

# html - div 边框 - 折叠到 0 高度

> ID：10584744
> 
> 赞同：1
> 
> 时间：2012-05-14T13:55:17.757
> 
> 标签：html, css, border

请查看这个 JSFiddle：http: [//jsfiddle.net/dNJxd/1/](http://jsfiddle.net/dNJxd/1/)

正如您在其中看到的那样，div 位于`.left_field > div`并且`.right_field > div`有一个边框。但是，该边框正在“折叠”到 0 高度。

如果我将其更改`overflow`为`hidden`（所有类似的问题都在提倡），它可以解决问题，但这不是一个选项，因为它会切断我正在使用的日期控制。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:01:13.407

在以下部分中：

```
<div>
    <span class="field_label">PO Number:</span>
    <span class="field_data">12345</span>
</div> 
```

第一个跨度具有`position: absolute;`并且因此假定其容器中没有空间，第二个是浮动的，这对容器空间具有相同的影响，除非它被清除。

以下代码不会有同样的问题：

```
<div>
    <span class="field_label">PO Number:</span>
    <span class="field_data">12345</span>
    <div style="clear: both;"></div>
</div> 
```

[小提琴](http://jsfiddle.net/q6fGR/)

# python - Python调用可执行程序

> ID：10584746
> 
> 赞同：0
> 
> 时间：2012-05-14T13:55:26.687
> 
> 标签：python

我需要用 Python 调用一个可执行程序，比如说：

```
C:\Program Files\ANSYS Inc\v140\ansys\bin\winx64\ANSYS140.exe 
```

我需要`afshin.txt`使用这个可执行应用程序运行一个 txt 文件 ( )，然后获取同样是 txt 文件的输出文件。例如，在 MATLAB 中，它将是：

```
dos '"C:\Program Files\Ansys Inc\v121\ANSYS\bin\intel\ansys121.exe" -p AA_T_A -b -i afshin.txt -o file01.out' 
mod_1 = load('output_res.txt'); 
```

你能帮我用 Python 做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:37:23.463

看看[envoy](https://github.com/kennethreitz/envoy)，一个围绕子流程的理智包装器：

```
import envoy
r = envoy.run("C:\Program Files\Ansys Inc\v121\ANSYS\bin\intel\ansys121.exe -p AA_T_A -b -i afshin.txt -o file01.out")
mod_1 = open("output_res.txt").read()
print mod_1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:19:19.410

我一直在使用以下几行。

```
import os;
os.system("\"C:\\Apl\\ANSYS Inc\\v130\\ansys\\bin\\winx64\\ansys130.exe\" -b -j jobname -i InputFile.inp -o jobname.out"); 
```

# javascript - 查找并替换字符串中第 n 次出现的 [bracketed] 表达式

> ID：10584748
> 
> 赞同：17
> 
> 时间：2012-05-14T13:55:30.523
> 
> 标签：javascript, jquery, html, regex, string

我有一个**名称属性得到更新**的表单，但问题是我使用多维值，如下所示：

```
<input type="text" name="questions[0][question]" />
<input type="text" name="questions[0][order]" />
<input type="text" name="questions[0][active]" />
<input type="text" name="answers[0][1][answer]" />
<input type="text" name="answers[0][2][answer]" />
<input type="text" name="answers[0][3][answer]" />

<input type="text" name="questions[1][question]" />
<input type="text" name="questions[1][order]" />
<input type="text" name="questions[1][active]" />
etc... 
```

**无论它们在什么位置**，我都需要使用JavaScript 更改方括号内的值。我尝试使用以下正则表达式来匹配方括号之间的值：

```
/(?<=\[)[^\]]*(?=\])/g 
```

但这匹配所有出现，我需要做的是以某种方式找到并替换第 n 个出现。

或者，如果有另一种方法可以在不使用正则表达式的情况下查找和替换方括号内的值，我会全力以赴。

提前致谢

**解决**

这个最终代码如下：

```
$('input', this).each(function(){
    var name = $(this).attr('name');
    var i = 0;
    $(this).attr('name', name.replace(/\[.+?\]/g,function (match, pos, original) {
    i++;
    return (i == 1) ? "[THE REPLACED VALUE]" : match;
    }));
}); 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-14T14:23:11.850

这是另一种可能的解决方案。您可以向 string.replace 函数传递一个函数来确定替换值应该是什么。该函数将传递三个参数。第一个参数是匹配文本，第二个参数是原始字符串中的位置，第三个参数是原始字符串。

以下示例将“HELLO, WORLD”中的第二个“L”替换为“M”。

```
var s = "HELLO, WORLD!";
var nth = 0;
s = s.replace(/L/g, function (match, i, original) {
    nth++;
    return (nth === 2) ? "M" : match;
});
alert(s); // "HELMO, WORLD!"; 
```

请参阅 MDN：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-17T12:58:50.027

接受的答案中给出的方法简洁而可靠，但它有一个缺点：如果有一个大字符串，并且给定子字符串的外观很多，它将被扫描到最后 - 即使只需要在开始。另一种方法是使用“exec”，然后在替换完成后立即断开链：

```
function replaceNthOccurence(source, pattern, replacement, n) {
  var substr = '';
  while (substr = pattern.exec(source)) {
    if (--n === 0) {
      source = source.slice(0, substr.index) + replacement + source.slice(pattern.lastIndex);
      break;
    }
  }
  return source;
}

console.log( replaceNthOccurence('bla_111_bla_222_bla_333', /\d+/g, '1st', 1) );
console.log( replaceNthOccurence('bla_111_bla_222_bla_333', /\d+/g, '2nd', 2) );
console.log( replaceNthOccurence('bla_111_bla_222_bla_333', /\d+/g, '3rd', 3) );
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:11:12.700

如果我正确理解了这个问题，下面显示的 RegExp 应该这样做：

```
var patt = /<input.*?(\[(\d)\])(\[(\d)\]){0,1}.*/g
var res = patt.exec(' <input type="text" name="questions[0][1][question]" />');

alert('First number: ' + res[2] + "\nSecond number: " + res[4]); 
```

在这里演示：http: [//jsfiddle.net/EUcdX/](http://jsfiddle.net/EUcdX/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-22T04:23:02.060

简短，这就是我用于**“查找第 n 个并替换”**的内容：

**`function replNth(str,n,find,repl){var A=str.split(find);return A.slice(0,n).join(find)+repl+A.slice(n).join(find)}`**

*返回`str`，将第`n`th 次出现`find`替换为`repl`。*

## 示例用法：

```
var str='M1,2C3,4 5,6 7,8 9,10 11,12',
    newStr=replNth( str, 3, ' ', 'S' );
console.log( newStr ); / / "M1,2C3,4 5,6 7,8S9,10 11,12" 
```

# spring - Maven Shade 插件的 Spring 3 NamespaceHandler 问题

> ID：10584752
> 
> 赞同：8
> 
> 时间：2012-05-14T13:55:41.240
> 
> 标签：spring, maven, maven-3, spring-3, maven-shade-plugin

Spring 3.1.1.RELEASE 与 Apache Maven 3.0.3 和 Maven Shade 插件 1.6。

使用 mvn shade 插件将工件打包到 uber-jar 中，包括它的依赖项：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <version>1.6</version>
    <executions>
        <execution>
        <phase>package</phase>
        <goals>
            <goal>shade</goal>
        </goals>
        <configuration>
            <transformers>
                <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                    <mainClass>com.MyApplication</mainClass>
                </transformer>
            </transformers>
        </configuration>
    </execution>
</executions> 
```

似乎打包得很好，但在执行时抱怨 Spring NamespaceHandler 问题：

```
Caused by: org.springframework.beans.factory.parsing.BeanDefinitionParsingException:
Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://www.springframework.org/schema/util]
Offending resource: class path resource [spring/test-context.xml] 
```

这适用于 util 和 p-命名空间，但不限于这些：

```
xmlns:util="http://www.springframework.org/schema/util"
xmlns:p="http://www.springframework.org/schema/p" 
```

如果我以手写方式重写属性或列表（util），问题就会消失。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-14T18:00:22.440

尝试将[AppendingTransformer](http://maven.apache.org/plugins/maven-shade-plugin/examples/resource-transformers.html#AppendingTransformer)添加到您的配置中。该示例特别提到这对 Spring 处理程序很有用。

# c# - 我们是否需要编写代码来对 gridView 进行排序？

> ID：10584755
> 
> 赞同：0
> 
> 时间：2012-05-14T13:55:53.753
> 
> 标签：c#, asp.net, gridview

我在网上阅读了一些文章，他们说您只需将“AllowSorting”属性设置为 true，而其他一些文章则在 Sorting 事件中编写了代码。所以我的问题是 - 要在 ASP.NET 中对 gridviwe 进行排序，我们是否需要在排序事件中编写任何代码，或者是否将“AllowSorting”设置为 true 以启用排序？

此外，如果我以编程方式设置我的数据源而不是直接将其设置为 .aspx 文件本身中的 SqlDataSource，是否会发生任何变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:02:21.553

[根据要求，我的评论作为答案：]

这取决于你使用的是什么`DataSource`。如果您使用声明式数据源控件，`SqlDataSource`或者`ObjectDataSource`您已经完成，否则您需要自己编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:14:30.683

我最近通过使用以下内容完成了您的要求：

```
DataTable dt = YourOwnWayOfCreatingADataTable();
dt.DefaultView.Sort = "ColumnNameToSort"; // You can append ASC or DESC to this
gridView1.DataSource = dt;
gridView1.DataBind(); 
```

我希望这可以帮助你。显然，这是在显示结果之前对结果进行排序，但是您可以通过更改 .Sort 属性并重新绑定来再次排序。如果您需要更具体的内容或多列，这可能行不通。

# linux - 如何在不使用 dlsym 的情况下在 linux 中挂钩

> ID：10584757
> 
> 赞同：2
> 
> 时间：2012-05-14T13:55:59.650
> 
> 标签：linux, gcc, hook, shared-libraries, glibc

我正在尝试挂钩 glibc 的一些功能，例如 fopen、fread 等。但是在挂钩功能中，我必须使用与 glibc 中相同的功能。像这样：

```
// this is my fopen
FILE *fopen(.....)
{
    fopen(....);// this is glibc fopen
} 
```

我找到了一种使用 dlsym 执行此操作的方法，但是通过这种方式，我必须将所有 glibc 函数调用替换为使用 dlsym 调用 glibc 函数的包装器。我很好奇在没有编码包装函数的情况下是否还有另一种方法可以完成相同的工作。我曾经试过这个：

fopen.c

```
....fopen(..)
{
  myfopen(..);
} 
```

我的fopen.c

```
myfopen(..)
{
  fopen(...);// glibc version
} 
```

主程序

```
int main()
{
  fopen(...);
}

$ gcc -c *.c
$ gcc -shared -o libmyopen.so myopen.o
$ gcc -o test main.o fopen.o libmyopen.so 
```

在我的理解中，gcc 会按照命令行中的规定从左到右链接，所以 main.o 会在 fopen.o 中使用 fopen，fopen.o 会在 libmyfopen.so 中使用 myfopen，libmyfopen.so 会在 glibc 中使用 fopen。但是在运行时，我遇到了段错误，gdb 显示有 fopen 和 myfopen 的递归调用。我有点困惑。谁能解释为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T05:25:18.137

> 我的理解，gcc会按照命令行的规定从左到右链接，所以main.o会在fopen.o中使用fopen，fopen.o会在libmyfopen.so中使用myfopen，libmyfopen.so会在glibc中使用fopen

你的理解是*不正确*的。`myfopen`from`libmyfopen.so`将使用可用的第*一个*定义`fopen`。在您的设置中，该定义将来自`fopen.o`链接到`test`程序中，您最终会遇到无限递归，并且由于堆栈耗尽而崩溃。

`gdb ./test`您可以通过运行、运行直到崩溃和使用来观察这一点`backtrace`。您将看到无休止的`fopen`和`myfopen`调用序列。

> 编译时符号 fopen 与 libc 中的符号不​​绑定

这是正确的：在`ELF`格式中，库记录它需要`fopen`定义符号（在这种情况下），但它不“记住”或关心哪个其他模块定义了该符号。

你可以通过运行看到这一点`readelf -Wr libmyfopen.so | grep fopen`。

> 这与 Windows DLL 不同。

是的。

# charts - Visiblox 图表：用于计算增量值的标尺行为

> ID：10584762
> 
> 赞同：0
> 
> 时间：2012-05-14T13:56:20.507
> 
> 标签：charts, visiblox, rulers

有没有人在 Visiblox 图表工具包的 RulerBehavior 上工作的经验？我正在寻找一些增量查找示例。Visiblox 论坛不包含任何此类信息。因此，如果有人可以分享他/她的经验。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T21:06:10.237

增量值？如最大值减去最小值？

这是我所做的：

```
double xMeasure = (double)MyRuler.MaxX - (double)MyRuler.MinX;
double yMeasure = (double)MyRuler.MaxY - (double)MyRuler.MinY; 
```

# xslt - 如何对 xsl1.0 和 2.0 中的元素进行分组？

> ID：10584767
> 
> 赞同：1
> 
> 时间：2012-05-14T13:56:50.320
> 
> 标签：xslt

这样的例子

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <a id='a1' name='a1 is a Chinese pig'/>
    <b text='b1'/>
    <d test='test0' location='L0' text='c0'/>
    <a id='a2' name='a2 is a Japanese pig'/>
    <b text='b2'/>
    <c test='test1' location='L1' text='c1 is a red pig'/>
    <c test='test2' location='L2' text='c2 is a green pig'/>
    <a id='a3' name='a3 is a American dog'/>
    <b text='b3'/>
    <c test='test3' location='L3' text='c3 is a lovely dog'/>
    <c test='test4' location='L4' text='c4 is a ugly dog'/>
    <c test='test5' location='L5' text='c5 is a smart dog'/>
    <a id='a4' name='a4 is a Japanese bird'/>
    <b text='b4'/>
    <c test='test6' location='L6' text='c6 is a lovely bird'/>
    <c test='test7' location='L7' text='c7 is a ugly bird'/>
    <c test='test8' location='L8' text='c8 is a smart bird'/>   
    <a id='a5' name='a5 is a American pig'/>
    <b text='b2'/>
    <c test='test10' location='L10' text='c10 is a red pig'/>
    <c test='test11' location='L11' text='c11 is a green pig'/>
    <a id='a6' name='a6 is a Chinese dog'/>
    <b text='b3'/>
    <c test='test12' location='L12' text='c12 is a lovely dog'/>
    <c test='test14' location='L14' text='c14 is a ugly dog'/>
    <c test='test15' location='L15' text='c15 is a smart dog'/>
    <a id='a7' name='a7 is a Chinese bird'/>
    <b text='b4'/>
    <c test='test16' location='L16' text='c16 is a lovely bird'/>
    <c test='test17' location='L17' text='c17 is a ugly bird'/>
    <c test='test18' location='L18' text='c18 is a smart bird'/>        
</root> 
```

我像这样应用xsl1.0

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="text" indent="yes"/>

   <xsl:key name="lookup" match="c" use="generate-id(preceding-sibling::a[1])" />
   <xsl:template match="/root">
      <xsl:apply-templates select="a[key('lookup', generate-id())]" />
   </xsl:template>

   <xsl:template match="a">dog:<xsl:value-of select="concat(@name[contains(.,'dog')], ':&#13;', '&#13;')" />
      <xsl:apply-templates select="key('lookup', generate-id())" />
   </xsl:template>

   <xsl:template match="c">
      <xsl:apply-templates select="@*" />
      <xsl:value-of select="'&#13;'" />
   </xsl:template>

   <xsl:template match="c/@*">
      <xsl:value-of select="concat(local-name(), ':', ., ':&#13;')" />
   </xsl:template>
</xsl:stylesheet> 
```

我想要这样的输出，规则是

1.  如果在一个元素和下一个 a 之间有一个或多个后续 c 元素，那么我们输出这些 c 元素
2.  然后根据@name，检查该值是否包含一些字符串，例如 pig、dog 或 bird，这些是关键字，而不仅仅是这里的硬代码工作。我们可以对这些信息进行分组，因为有更多的猪，鸟和狗。无论他们是中国人还是日本人，我们都按照我们之前知道的狗，鸟，猪这些类别进行分组。

我想要的输出是这样的

```
case1:the following are  all pigs:

a2 is a Japanese pig

test:test1
location:L1
text:c1 is a red pig
test:test2
location:L2
text:c2 is a green pig

a5 is a American pig

test:test10
location:L10
text:c10 is a red pig
test:test11
location:L11
text:c11 is a green pig

case2:the following are  all dogs:

a3 is a American dog

test:test3
location:L3
text:c3 is a lovely dog

test:test4
location:L4
text:c4 is a ugly dog

test:test5
location:L5
text:c5 is a smart dog

a6 is a Chinese dog

test:test12
location:L12
text:c12 is a lovely dog

test:test14
location:L14
text:c14 is a ugly dog

test:test15
location:L15
text:c15 is a smart dog    

case3:the following are  all birds:

a4 is a Japanese bird
test:test6
location:L6
text:c6 is a lovely bird

test:test7
location:L7
text:c7 is a ugly bird

test:test8
location:L8
text:c8 is a smart bird

a7 is a Chinese bird

test:test16
location:L16
text:c16 is a lovely bird

test:test17
location:L17
text:c17 is a ugly bird

test:test18
location:L18
text:c18 is a smart bird 
```

问题是如何纠正我的xsl1.0？另一个在 xsl2.0 中更容易实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T07:38:01.613

有了这个 xsl

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="text" indent="yes"/>
   <xsl:template match="/root">
      <p>the followings are birds:</p>
      <xsl:apply-templates select="a[contains(@name, 'bird')][key('bird_lookup', generate-id())]"/>
      <p>the followings are pigs:</p>
      <xsl:apply-templates select="a[contains(@name, 'pig')][key('pig_lookup', generate-id())]"/> 
      <p>the followings are dogs:</p>
      <xsl:apply-templates select="a[contains(@name, 'dog')][key('dog_lookup', generate-id())]"/>                
   </xsl:template>
   <xsl:key name="bird_lookup" match="c" use="generate-id(preceding-sibling::a[1][contains(@name, 'bird')])"/>
   <xsl:template name="bird" match="a[contains(@name, 'bird')]">
      <xsl:value-of select="'&#13;'"/> 
      <xsl:value-of select="@name"/>
      <xsl:value-of select="'&#13;'"/>      
      <xsl:apply-templates select="key('bird_lookup', generate-id())" />
      <xsl:apply-templates select="c/@*"/>
   </xsl:template>

   <xsl:key name="pig_lookup" match="c" use="generate-id(preceding-sibling::a[1][contains(@name, 'pig')])"/>
   <xsl:template name="pig" match="a[contains(@name, 'pig')]">
         <xsl:value-of select="'&#13;'"/> 
      <xsl:value-of select="@name"/>
      <xsl:value-of select="'&#13;'"/>      
      <xsl:apply-templates select="key('pig_lookup', generate-id())" />
      <xsl:apply-templates select="c/@*"/>
   </xsl:template>

      <xsl:key name="dog_lookup" match="c" use="generate-id(preceding-sibling::a[1][contains(@name, 'dog')])"/>
   <xsl:template name="dog" match="a[contains(@name, 'dog')]">
      <xsl:value-of select="'&#13;'"/>     
      <xsl:value-of select="@name"/>
      <xsl:value-of select="'&#13;'"/>      
      <xsl:apply-templates select="key('dog_lookup', generate-id())" />
      <xsl:apply-templates select="c/@*"/>
   </xsl:template>

   <xsl:template match="c">
      <xsl:apply-templates select="@*"/>
      <xsl:value-of select="'&#13;'"/>
   </xsl:template>

   <xsl:template match="c/@*">
      <xsl:value-of select="concat(local-name(), ':', ., '&#13;')"/>
   </xsl:template>

</xsl:stylesheet> 
```

我可以得到

```
the followings are birds:
a4 is a Japanese bird
test:test6
location:L6
text:c6 is a lovely bird

test:test7
location:L7
text:c7 is a ugly bird

test:test8
location:L8
text:c8 is a smart bird

a7 is a Chinese bird
test:test16
location:L16
text:c16 is a lovely bird

test:test17
location:L17
text:c17 is a ugly bird

test:test18
location:L18
text:c18 is a smart bird

the followings are pigs:
a2 is a Japanese pig
test:test1
location:L1
text:c1 is a red pig

test:test2
location:L2
text:c2 is a green pig

a5 is a American pig
test:test10
location:L10
text:c10 is a red pig

test:test11
location:L11
text:c11 is a green pig

the followings are dogs:
a3 is a American dog
test:test3
location:L3
text:c3 is a lovely dog

test:test4
location:L4
text:c4 is a ugly dog

test:test5
location:L5
text:c5 is a smart dog

a6 is a Chinese dog
test:test12
location:L12
text:c12 is a lovely dog

test:test14
location:L14
text:c14 is a ugly dog

test:test15
location:L15
text:c15 is a smart dog 
```

如何让这个优雅？

# bootloader - 是否有关于 Minix 3.2（最新）如何启动的文档？

> ID：10584768
> 
> 赞同：17
> 
> 时间：2012-05-14T13:56:51.283
> 
> 标签：bootloader, minix

我找到了这个站点：[http](http://www.os-forum.com/minix/boot/) ://www.os-forum.com/minix/boot/ ，它声称记录了 Minix 的启动顺序。

但是在我刚刚从 Git 获得的 Minix 3.2 的源代码树中，上述站点中描述的文件根本不存在。

他们是：

```
masterboot.s
bootblock.s
boothead.s
boot.c
bootimage.c
rawfs.c 
```

Minix 会改变它的启动方式吗？

是否有任何关于 Minix 如何引导自身的文档？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T03:55:48.853

该网页讨论了 Minix，如*操作系统*第二版中所述，即 Minix 2。Minix 3 的等效文档[位于 Minix wiki 上](http://wiki.minix3.org/en/DevelopersGuide/FromPowerOnToLoginPrompt)。其中一些也已经过时了，因为在 3.2 中[Minix 采用了 NetBSD 引导加载程序](http://wiki.minix3.org/en/MinixReleases)。

有一些文档是[如何启动 NetBSD](http://wiki.netbsd.org/how_netbsd_boots_on_x86/)的，但它不如您正在谈论的站点好。对于源代码，请开始查看此文件夹：[https ://github.com/Stichting-MINIX-Research-Foundation/minix/tree/master/sys/arch/i386/stand](https://github.com/Stichting-MINIX-Research-Foundation/minix/tree/master/sys/arch/i386/stand)

# javascript - 两个 Backbone.Router 定义之间的区别

> ID：10584769
> 
> 赞同：0
> 
> 时间：2012-05-14T13:56:51.643
> 
> 标签：javascript, backbone.js

我尝试使用backbone.js 创建我的第一个javascript 应用程序，但我发现了奇怪的行为，不明白两段代码之间的区别一个运行良好，第二个似乎不起作用。

在主页和“#test”网址上显示警报

```
var AppRouter = Backbone.Router.extend({
    routes:{
        "": 'index',
       "test": 'test'
    },
    index: function(){
        alert('index');
    },
    test: function(){
        alert('test');
    }    
});
var app = new AppRouter();
Backbone.history.start(); 
```

这不起作用，但`Backbone.history.hanlers`看起来相同

```
var router = new Backbone.Router({
    routes:{
        "": 'index',
       "test": 'test'
    },
    index: function(){
         alert('index');
    },
    test: function(){
         alert('test');
    }    
});
Backbone.history.start(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:08:16.707

两段代码之间的区别在于，在第一个代码中，您创建了一个名为的新类`AppRouter`，而在第二个代码中，您只是创建了一个普通`Backbone.Router`类。

我可能会误解，但是您似乎是在说第一个示例有效，而第二个示例无效？

第二个示例不起作用的原因是因为 Backbone.Router 只接受`routes`哈希作为其构造函数的参数。您传递的`index`and`test`函数不是作为对象上的函数创建的。

如果您想将`routes`哈希传递给构造函数，您仍然需要使用实际的路由函数扩展 Backbone.Router。例如：

```
var AppRouter = Backbone.Router.extend({
    index: function(){
        alert('index');
    },
    test: function(){
        alert('test');
    }    
});
var app = new AppRouter({ 
    routes:{
        "": 'index',
       "test": 'test'
    }});
Backbone.history.start(); 
```

# ruby-on-rails - Ruby on Rails 身份验证设计或 Authlogic

> ID：10584771
> 
> 赞同：0
> 
> 时间：2012-05-14T13:56:55.483
> 
> 标签：ruby-on-rails, ruby, devise

大家好，我是 ruby​​ on rails 的新手，我正在为我的应用程序寻找身份验证解决方案，我遇到了 Devise 和 Authlogic，所以我的问题是选择哪一个？我的要求 1.节省时间 2.高度可定制 3.易于理解 4.易于调试

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:25:02.847

**请访问下面的链接并从头开始了解身份验证。**

[http://railscasts.com/episodes/250-authentication-from-scratch](http://railscasts.com/episodes/250-authentication-from-scratch)

**优点：**
*1\. 非常容易理解，作为初学者。
2\. 高度可定制。
3\. 对正在发生的事情有一个极端的把握。
4\. 摆脱复杂代码。
5\. 是你写的。*

**缺点：**
*1\. 它是你写的。*

谢谢。

# image - Flash 从目录中拉入图像

> ID：10584772
> 
> 赞同：0
> 
> 时间：2012-05-14T13:57:00.863
> 
> 标签：image, flash, slider

我正在尝试创建一个 Flash 图像滑块，但是我需要将图像从目录中拉到 Flash 文件中，然后过渡到下一个。

有没有人知道从哪里开始或任何可以帮助的链接？

非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:13:05.580

从本地或服务器目录中提取图像？对于服务器目录，您将使用 Flash Loader 类[Loader](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Loader.html)

如果您使用的是 Adob​​e AIR，则可以使用 FileReference 加载本地文件。

对于淡入淡出，我使用[Tweenlite](http://www.greensock.com/tweenlite/)并对 from 图像和 to 图像的 alpha 值进行补间，以使一个淡出而另一个淡入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:21:17.327

Flash 无法读取文件夹的内容。

您要么必须手动指定文件名，要么使用服务器端脚本创建文件夹中的文件列表 - 它可以作为 XML、文本文件或仅作为查询字符串传递给 Flash，最多你。

# android - android中的自定义ArrayAdapter仅在ListActivity中更新第一个条目的视图

> ID：10584773
> 
> 赞同：1
> 
> 时间：2012-05-14T13:57:07.553
> 
> 标签：android

我有一个 ListActivity 显示项目列表，每个项目的右端都有一个 ImageView，它在开头显示一个箭头图标。按下某个按钮后，我想用删除图标替换这些箭头图标。为此，我已更改 ListView 的 ArrayAdapter 并调用 notifyDataSetChanged()。在 ArrayAdapter 的 getView 方法中，我为 ImageView 设置了 ImageResource，但更改未显示在列表中，只有第一个条目具有更改的图标。

这是 ArrayAdapter 代码：

```
private class CCAdapter extends ArrayAdapter<CCcenter>{

    ArrayList<CCcenter> items;
    int mode;
    public CCAdapter(Context context, int textViewResourceId, ArrayList<CCcenter> Items,int m) {
        super(context, textViewResourceId, Items);
        this.items=Items;
        this.mode=m;
        // TODO Auto-generated constructor stub
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
            View v = convertView;
            if (v == null) {
                LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.lisitem, null);
            }
            final CCcenter o = items.get(position);
            if (o != null) {

                    TextView title = (TextView) v.findViewById(R.id.ttl_txt);
                    TextView desc=(TextView)v.findViewById(R.id.desc_txt);
                    TextView dist=(TextView)v.findViewById(R.id.dist_txt);
                    ImageView icon=(ImageView)findViewById(R.id.lst_icon);
                    RatingBar rating=(RatingBar)findViewById(R.id.lst_ratings);

                    if(title!=null)
                    {
                        title.setText(o.title);
                    }
                    if(desc!=null)
                    {
                        desc.setText(o.desc);
                    }
                    if(dist!=null)
                    {
                        dist.setText(o.dist);
                    }
                    if(rating!=null)
                    {
                        rating.setRating(o.rating);
                    }
                    if(icon!=null) //edit mode
                    {
                        if(this.mode==1)
                        {
                            icon.setImageResource(R.drawable.arrow);
                        }
                        else
                        {
                            icon.setImageResource(R.drawable.dlet);
                        }
                    }
            }
            return v;
    }

} 
```

在按钮的 OnClick 方法中，我执行以下操作：

```
CCAdapter mAdapter=new CCAdapter(context, R.layout.lisitem, CCS,2);
             MyList.this.setListAdapter(mAdapter);
                   mAdapter.notifyDataSetChanged();
             MyList.this.getListView().invalidateViews(); 
```

但是在这样做之后，只有列表的第一个条目有一个删除图标，其他人只显示默认的箭头图标。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:17:44.057

我认为这是你的问题：

```
final CCcenter o = items.get(position); 
```

您已将其声明为最终... 所以我很惊讶你的清单没有一遍又一遍地显示相同的项目。

尝试删除最终声明，看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:19:36.047

制作一个内部静态类来保存您的视图的引用，例如

```
static class viewHolder{
TextView title ;
TextView desc;
TextView dist;
ImageView icon;
RatingBar rating;

} 
```

然后在getview中使用类似的东西：

```
public View getView(int position, View convertView, ViewGroup parent)
{
    View v = convertView;
    viewHolder holder;
    if (v == null)
    {
        holder=new ViewHolder();
        LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.lisitem, null);
        holder.title = (TextView) v.findViewById(R.id.ttl_txt);
        holder.desc=(TextView)v.findViewById(R.id.desc_txt);
        holder.dist=(TextView)v.findViewById(R.id.dist_txt);
        holder.icon=(ImageView)findViewById(R.id.lst_icon);
        holder.rating=(RatingBar)findViewById(R.id.lst_ratings);
        v.setTag(holder);
    }
    else
    {
        holder=(ViewHolder)v.getTag();
    }
    CCcenter o = items.get(position);
    if(title!=null)
    {
        holder.title.setText(o.title);
    }
    if(desc!=null)
    {
        holder.desc.setText(o.desc);
    }
    if(dist!=null)
    {
        holder.dist.setText(o.dist);
    }
    holder.rating.setRating(o.rating);
    if(this.mode==1)
    {
        holder.icon.setImageResource(R.drawable.arrow);
    }
    else
    {
        holder.icon.setImageResource(R.drawable.dlet);
    }
    return v;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T18:50:53.973

像这样检索 RatingBar 和 ImageView 的代码中的愚蠢错误

```
ImageView icon=(ImageView) findViewById(R.id.lst_icon);
RatingBar rating=(RatingBar) findViewById(R.id.lst_ratings); 
```

但是这些应该这样做

```
ImageView icon=(ImageView) v.findViewById(R.id.lst_icon);
RatingBar rating=(RatingBar) v.findViewById(R.id.lst_ratings); 
```

# java - 引起：org.apache.axis2.AxisFault：无法接合模块：壁垒

> ID：10584776
> 
> 赞同：2
> 
> 时间：2012-05-14T13:57:16.900
> 
> 标签：java, eclipse, apache, soap, axis2

您对为 SOAP**客户端**应用程序设置 Axis2 和 Rampart 有任何了解吗？

我已经通过 Eclipse 将 Axis2 和 Rampart 的 jar 文件添加到构建路径中，并将 Rampart 的 jar 和 mar 文件处理到 Axis 的文件结构中。

我的 Axis/Rampart 设置有问题，但我不知道是什么……</p>

这就是日志给我的所有内容：

com.good.gc10.Fault：无法在 com.good.gcTalk.GCTActivationPinHandler.main(GCTActivationPinHandler.java:34) 处的 com.good.gcTalk.GCSoapClient.(GCSoapClient.java:51) 实例化 GCServiceStub 原因 **：org .apache.axis2.AxisFault：无法使用模块：** com.good.gcTalk.GCSoapClient.(GCSoapClient.java:45) 的 org.apache.axis2.client.ServiceClient.engageModule(ServiceClient.java:363) 的壁垒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T03:55:42.973

Have you set your Config Context?

This needs to be set before you can engage Rampart, You also need to have the folder structure correct. ie In the below example you would need to have the following subfolder in Axis2WithRampart: Conf, Resources, Modules

If you add log4j with the Rampart & Axis 2 settings you get more information logged. I can tell you how to do this if you're not sure.

```
enter configContext = ConfigurationContextFactory.createConfigurationContextFromFileSystem("Axis2WithRampart/repository", null); 
//create the stub
stub = new MyRampartServiceStub(configContext,"http://localhost:8080/axis2/services/MyRampartService"); here 
```

# php - 如何回显这个数组的值？

> ID：10584784
> 
> 赞同：12
> 
> 时间：2012-05-14T13:57:41.877
> 
> 标签：php, arrays, key

如何单独回显这个数组的值？

```
Array ( [0] => 20120514 [1] => My Event 3 ) 
```

所以

```
 echo $value[0]; etc 
```

到目前为止我有这个：

```
foreach (json_decode($json_data_string, true) as $item) {

$eventDate = trim($item['date']);

    // positive limit

   $myarray = (explode(',', $eventDate, 2));

foreach ($myarray as $value) {
   echo $value;
} 
```

此回显将整个字符串 no 作为数组输出。如果我这样做？

```
 echo $value[0}; 
```

然后我只得到它的2个字符？？

print_r ：

```
Array ( [0] => 20120430 [1] => My Event 1 ) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-14T13:59:11.817

```
foreach ($array as $key => $val) {
   echo $val;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-06T14:36:10.410

这是原始元素数组的简单例程：

```
for ($i = 0; $i < count($mySimpleArray); $i++)
{
   echo $mySimpleArray[$i] . "\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:00:05.950

为此，您需要在 foreach 循环中设置键和值：

```
foreach($item AS $key -> $value) {
echo $value;
} 
```

这应该可以解决问题:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T14:08:03.607

这里的问题在于您的爆炸声明

```
//$item['date'] presumably = 20120514\.  Do a print of this
$eventDate = trim($item['date']);

//This explodes on , but there is no , in $eventDate
//You also have a limit of 2 set in the below explode statement
$myarray = (explode(',', $eventDate, 2));

 //$myarray is currently = to '20'

 foreach ($myarray as $value) {
    //Now you are iterating through a string
    echo $value;
 } 
```

如果您要这样做，请尝试将您的初始 $item['date'] 更改为 2012,04,30 。否则，我不完全确定您要打印什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-07T05:28:44.787

```
var_dump($value) 
```

它解决了我的问题，希望你也是。

# javascript - js 正则表达式清除除数字以外的所有内容

> ID：10584787
> 
> 赞同：0
> 
> 时间：2012-05-14T13:57:50.407
> 
> 标签：javascript, regex

我目前有这个...

```
sanitizeNumber = function ( dirtyNumber ){
    // remove any non-digits from the number
    return dirtyNumber.replace(/[^\d.]/g, "");
} 
```

..但它似乎允许小数点通过。

除了 0 到 9 的数字之外，我怎样才能完全删除所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T13:59:56.030

你应该删除`.`之后`\d`

```
sanitizeNumber = function ( dirtyNumber ){
    // remove any non-digits from the number
    return dirtyNumber.replace(/\D/g, "");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:59:08.803

删除`.`之后`\d`

```
dirtyNumber.replace(/[^\d]/g, ""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T13:59:17.180

`/\D/g`抓住每个非数字字符。
`\d`- 一个数字
`\D`- 不是一个数字

```
sanitizeNumber = function ( dirtyNumber ){
    // remove any non-digits from the number
    return dirtyNumber.replace(/\D/g, "");
} 
```

请注意，如果您想学习`regex`其他选项是：

```
return dirtyNumber.replace(/[^0-9]/g, "");
return dirtyNumber.replace(/[^\d]/g, ""); 
```

# algorithm - 谁能更清楚地解释 Nilsson 在 8-puzzle 中的序列得分？

> ID：10584788
> 
> 赞同：4
> 
> 时间：2012-05-14T13:57:52.597
> 
> 标签：algorithm, graph, artificial-intelligence, a-star, heuristics

我正在学习关于 8 谜题的 A* 算法。

我没有关于 A* 的问题，但有一些关于启发式分数的问题 - Nilsson 的序列分数。

[Justin Heyes-Jones 网页 - A* 算法](http://www.heyes-jones.com/astar.html)非常清楚地解释了 A*。它有一张 Nilsson 序列分数的图片。

![Nilsson 的序列分数](../Images/5a813a3179ff63d3dfce374d716565b5.png)

它解释说：

**Nilsson 的序列得分**

> 中间的牌得分`1`（因为它应该是空的）
> 
> 对于不在中心的每个图块，如果顺时针方向的图块不是顺时针方向的图块，则得分`2`。
> 
> 将此序列乘以三，最后加上将每个图块移回正确位置所需的总距离。

我无法理解上述计算分数的步骤。

例如，对于开始状态，什么`h = 17`？

```
+---+---+---+
|   | A | C |
+---+---+---+
| H | B | D |
+---+---+---+
| G | F | E |
+---+---+---+ 
```

所以，按照描述， `B`是在中心，所以我们有一个分数`1`。

然后

> 对于不在中心的每个标题，如果顺时针方向的**图块**不是顺时针方向的图块，**则**得分`2`。

我不确定这句话是什么意思。加粗的**瓷砖**指的是什么？加粗的**表示**什么？加粗的**是否**指的是中心标题（本例中为 B）？还是它指的是不在中心的每个图块？

是我们从下一步开始的`A`，所以`C`不应该是顺时针方向`A`，那么我们就有了一个分数`2`。然后`B`应该顺时针到`A`，然后我们忽略，以此类推？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:00:47.593

Let us number the squares as follows:

```
+---+---+---+
| 0 | 1 | 2 |
+---+---+---+
| 7 | 8 | 3 |
+---+---+---+
| 6 | 5 | 4 |
+---+---+---+ 
```

Now, let `N(x)` be the current square number for tile `x`. So, for example, if a tile `A` is in the square number `3`, then `N(A) = 3`. Note that a "tile" can be in any of these squares and the number of each square remains the same (so the upper left square will always be the number `0`).

The sequence score is given by:

```
for each tile x in (A, B, C, ..., H)
    score += distance from N(x) to the correct square for tile x
    if N(x) == 8  # i.e. the tile is in the center
       score += 3*1
    else if N(next(x)) != (N(x) + 1) % 8
       score += 3*2 
```

where `next(x)` takes `x` to the next letter, i.e. `next(A) = B, next(B) = C, ... , next(G) = H, next(H) = A`.

So to answer your specific questions:

1.  **tile** refers to the tile on square `(N(x) + 1) % 8`, i.e. the next square round the edge
2.  **it** refers to the tile in "for each tile not in the center"
3.  The next step is given by looking at `A`. `C` should not be clockwise to `A`, then we have `2`. Next we look at `C`, `D` should be clockwise to `A`, so this is okay. Looking at `D, E, F` and `G` all of these are okay, but when we get to `H` it should not be next to 0, so we have a score of `4`. We add 1 because `B` is in the center to get `5`. Then multiply by `3` to get `15`. Then add `1` to move `B` up to the right place, and `1` to move `A` left to the right place for a final total of `17`.

# javascript - 无法将请求事件附加到 Node 的 http-proxy

> ID：10584789
> 
> 赞同：0
> 
> 时间：2012-05-14T13:57:53.513
> 
> 标签：javascript, events, node.js, proxy

我正在尝试设置一个登录 Node.js 的代理。我试过像[https://github.com/nodejitsu/node-http-proxy#listening-for-proxy-events那样做](https://github.com/nodejitsu/node-http-proxy#listening-for-proxy-events)

代理工作，但似乎没有调用结束事件 - 当我访问页面时没有任何内容输出到控制台。我错过了什么？

```
var httpProxy = require('http-proxy');

var server = httpProxy.createServer(function (req, res, proxy) {
    var buffer = httpProxy.buffer(req);

    proxy.proxyRequest(req, res, {
      host: 'nodejs.org',
      port: 80,
      buffer: buffer
    });

});

server.proxy.on('end', function() {
  console.log("The request was proxied.");
});

server.listen(8000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T20:44:09.127

你没有错过任何东西 - 这是一个错误。该修复程序已经在 master 分支上。不过，它还没有部署到 npm。

# javascript - Ajax 加载页面更改 url

> ID：10584793
> 
> 赞同：0
> 
> 时间：2012-05-14T13:58:03.017
> 
> 标签：javascript, ajax

我正在编写以下代码来加载页面的一部分：

```
function load(b)
{
var xmlHttp;
try
{   
    xmlHttp=new XMLHttpRequest();
}
catch (e)
{
    try
    {
        xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); 
    }
    catch (e)
    {
        try
        {
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch (e)
        {
            alert("No AJAX!?");
            return false;
        }
    }
}

xmlHttp.open("GET",b,true);
xmlHttp.onreadystatechange=function(){
if( this.readyState == 4 )
{
    document.getElementById('main').innerHTML=xmlHttp.responseText;
}
}

    xmlHttp.send(null); 
} 
```

//而调用代码的HTML是：

```
<a href="#" onclick="load('reg.php')">Item 3.1.1</a> 
```

它有正确的结果。但在 url 中它是：localhost/corpo/#

而我期待：localhost/corpo/reg.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:01:32.393

元素中的超链接`<a>`指向“#”，所以一切都很好。

在 HTML5 之前，您只能通过 JavaScript 操作 url 的哈希部分，因此您的期望是不可能实现的。

然而，随着 HTML5 的到来，这是可行的。检查此链接：[http](http://spoiledmilk.dk/blog/html5-changing-the-browser-url-without-refreshing-page) ://spoiledmilk.dk/blog/html5-chang-the-browser-url-without-refreshing-page 或 goole 所说的任何内容，例如“html5 url change”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T17:12:46.327

利用`<span>`

例如：

```
 <span onClick="load('reg.php');">hello</span> 
```

# c# - 当孩子打开时让父窗口保持活动状态

> ID：10584795
> 
> 赞同：2
> 
> 时间：2012-05-14T13:58:11.707
> 
> 标签：c#, wpf, silverlight, childwindow

如何打开子窗口并保持父窗口处于活动状态。我正在将 Silverlight 5 与最新版本的工具包一起使用。

我知道使用画笔可以帮助使背景看起来正常，但父窗口仍然被禁用。

我正在尝试实现类似于控件 F 的查找功能。我希望用户在子窗口中进行搜索，并且匹配项将显示在主显示屏上。

谢谢您的帮助，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:21:25.253

ChildWindow 是为模态（禁用父级）使用而设计的。

它使用覆盖窗口使背景显示为已禁用，但它也将 Application.Current.RootVisual 的 IsEnabled 标记为 false，然后在 ChildWindow 关闭时将其恢复。

这可以防止与“父”窗口的控件发生任何交互。解决此问题的唯一方法是制作您自己的样式 ChildWindow 控件但忽略此行为。

[FloatableWindow](http://floatablewindow.codeplex.com/)是 Tim Heuer 的一个 codeplex 项目，它是解决问题的好方法。尽管如此，该项目似乎已经有一段时间没有更新了，因此与最新的 Silverlight 版本的兼容性可能是有问题的。

DevExpress 有一个[DXDialog](http://documentation.devexpress.com/#Silverlight/CustomDocument4975)控件，其中包括用于模态和非模态行为的 Show 和 ShowDialog 函数。我确信其他 silverlight 工具包公司也提供类似的替代方案，这只是我熟悉的一个。

如果您不介意制作自定义控件，您可以按照 Tim Heuer 关于该主题的[博客文章](http://timheuer.com/blog/archive/2009/05/10/silverlight-childwindow-non-modal-refactor.aspx)之类的内容来调整您自己的控件，或者使用[Reflector](http://www.reflector.net/)之类的工具从 silverlight 本身对 ChildWindow 进行逆向工程并删除您不想要的部分.

# php - 当facebook突然登录php sdk时，getuser函数在浏览器中第一次返回0

> ID：10584802
> 
> 赞同：0
> 
> 时间：2012-05-14T13:58:46.420
> 
> 标签：php, facebook, facebook-php-sdk

第一次在浏览器中登录 Facebook 时。我调用函数 getuser 进行检查，但我无法得到它，它只返回零。仅在我第一次打开浏览器时才发生。

```
$facebook = new Facebook(array(
      'appId'  => 'xxxxx',
      'secret' => 'xxxxxxx',
      'cookie' => true
    ));

$here = 'https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
    $next = preg_replace('~#.*$~s', '', $here);
    $next = preg_replace('~\?.*$~s', '', $next);
    $next = preg_replace('~/[^/]*$~s', '/login.php', $next);
$params=array(
      'scope' => 'publish_stream,user_birthday,read_stream,read_friendlists,user_about_me,email,user_checkins,friends_checkins,publish_checkins,publish_actions',
      'redirect_uri' => $next
    ); 
 $loginUrl = $facebook->getLoginUrl($params); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:05:22.343

SDK 将 facebook 用户 ID 和访问令牌存储在会话中，因此 getUser 不会在 auth 后返回 0，除非您清除 cookie 或像之前那样重新打开浏览器。

您也可以调用`destroySession()`删除 SDK 中的 cookie。

# javascript - javascript中的奇怪语法：'sth'+ +new Date

> ID：10584803
> 
> 赞同：3
> 
> 时间：2012-05-14T13:58:57.200
> 
> 标签：javascript, jquery

我正在阅读一个 jquery 插件，发现这个有趣的语法：

```
'sth'+ +new Date 
```

它创建了一个数字字符串，作者将其用作唯一 ID：`sth1237004731731`

我很好奇它是什么样的语法，是否有一些关于它的阅读材料？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T14:20:28.703

它使用 JavaScript 类型强制的一些副作用来构建唯一标识符（可能用于元素）。令人困惑的部分是`+new Date`. 在这里，`new Date`（或`new Date()`）返回一个`Date`对象。但是在 this 前面加上 a`+`或 a`-`会强制 JS 解释器将此值强制转换为`Number`对象，而 JS 这样做的方式`Date`>`Number` 是通过返回时间戳（或`getTime()`）。

所以这段代码可以用不同的方式表达，如下所示：

```
var date = new Date(), // "Mon May 14 2012 10:03:58 GMT-0400 (EST)"
    timestamp = date.getTime(), // 1337004238612
    identifierString = "sth" + timestamp.toString(); 
```

您可能会合理地声称没有必要如此冗长，所以我个人可能会这样写：

```
var identifier = "sth" + (new Date()).getTime(); 
```

但是，如果您希望有人可能需要维护您的代码，请避免编写类似示例的代码。如果它阻止了你，它可能会阻止很多人。编码风格不仅仅是向解释器表达意图，而是向人类开发人员表达意图。如果代码在浏览器中工作，但在大多数有经验的开发人员的头脑中出现语法错误，那么你做错了，简单明了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T14:24:34.537

这是一元运算符的有趣用法`+`。基本上，您可以将此表达式分解为三个独立的部分，在二元`+`运算符处拆分：

`"sth"`，然后`+`，然后`+new Date`。

二进制的第一个操作数`+`只是一个通用的字符串文字。第二个操作数使用[一元运算`+`符](http://es5.github.com/#x11.4.6)，正如链接的标准状态，它将其操作数转换为 a `Number`。

因为`new`运算符具有[最高优先级](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Operator_Precedence)，它比一元“绑定更紧密” `+`，这意味着`new Date`将首先评估。所以一元的操作数`+`又是表达式的结果`new Date`。当然，`new Date`只是简单地创建一个空白`Date`对象。根据[§ 15.9.3.3 new Date()](http://es5.github.com/#x15.9.3.3)：

> 新构造对象的 [[PrimitiveValue]] 内部属性设置为标识当前时间的时间值 (UTC)。

换句话说，a`new Date`将只是一个`Date`表示当前时间的对象。并且，反过来，`+new Date`会将空白`Date`对象转换为数字。

## 简短的回答

该规范很长且难以遵循。简而言之，`+new Date`返回与当前时间关联的 UNIX 时间戳。

## 长答案：遵循规范

遵循规范的长答案是一元`+`调用`ToNumber(GetValue(expr))`where`expr`是评估的操作数。`GetValue(dateObj)`将简单地返回`dateObj`，因此表达式变为`ToNumber(dateObj)`.

结果[`ToNumber`](http://es5.github.com/#x9.3)取决于参数的类型。在对象的情况下，它返回`ToNumber(ToPrimitive(input argument, hint Number))`.

`ToPrimitive`反过来，将调用[对象的](http://es5.github.com/#x15.9.5.8)[`valueOf`属性`Date`](http://es5.github.com/#x15.9.5.8)。这会返回 a `Number`，它是与对象关联的时间值`Date`：终于，我们要找的东西了！然后它回到链上：`ToNumber(num)`简单地返回`num`。

当然，从那里，字符串`"sth"`和结果`+new Date`被连接起来（如果你愿意，你可以在规范中找到它），这会给你你正在寻找的结果。

# jquery - Telerik Chart 在 IE 中无法正确显示

> ID：10584805
> 
> 赞同：0
> 
> 时间：2012-05-14T13:59:00.740
> 
> 标签：jquery, html, internet-explorer, google-chrome, telerik

我有一个有趣的问题。我有一个包含 Telerik 图表的页面，该图表还具有“打印机友好版本”类型功能，它会打开一个新窗口，其中包含第一页中的*一些*html。由于某些格式问题，打印友好版本功能通过与原始视图不同的视图。

以下几点可能会有所帮助：

1.  我正在使用 HTML 4.01 Strict
2.  我正在使用 IE 8
3.  *Telerik GRID*调用完全相同的代码，有趣的是它渲染得很好。

它的工作方式是这样的：

1.  原始页面被渲染（通过 OriginalPage.aspx）——图表显示得很好
2.  抓取并保存包含图表的 div 的 html
3.  调用 PrinterFriendly.aspx（此页面仅包含图表 div、一些 js 和一些用于嵌套表格的 html（是的，我知道，使用表格进行布局很糟糕，但我没有编写 UI 代码）
4.  将打开一个新窗口，其中包含 PrinterFriendly.aspx 的结果
5.  第一次渲染的 div 的 html 被注入到新页面的 html 中
6.  页面被渲染——图表在 IE 中根本不显示（在 chrome 和 FF 中工作正常）

我认为这是因为 IE 对 HTML 验证非常严格，并且不允许某些元素包含在某些其他元素中。但这里的问题是 Telerik 图表。知道这可能是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:32:51.797

在 IE 8 中按 F12 运行开发者工具。在那里您可以将“文档模式”更改为 IE8。可能是您的页面以 IE7 标准模式或 Quirks 模式打开。您应该通过设置 DOCTYPE 标记来设置页面的文档模式。我不熟悉 Telerik 控件，但这些类型的控件通常适用于特定模式，例如 HTML 5。

# string - 在批处理文件中，如何查找文本文件中出现的字符串？

> ID：10584806
> 
> 赞同：2
> 
> 时间：2012-05-14T13:59:03.747
> 
> 标签：string, for-loop, batch-file

我有一个文本文件，我想运行一个批处理文件，它读取整个文本文件并告诉我字符串“PASS”的出现次数：

你能帮忙怎么做吗 - 我无法理解 BAT 文件中令牌的用法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:03:12.877

也许该`findstr`命令会对您有所帮助：[Findstr Help](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/findstr.mspx?mfr=true)。它不会打印出现的次数，但也许你可以对结果做点什么。

更新：[Find 命令](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/find.mspx?mfr=true)有一个`/c`选项，它计算包含该字符串的行数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T14:26:58.700

Mulmoth 的答案很好，通常它应该可以解决您的问题。

但是由于您不了解令牌，因此我将尝试对其进行解释。

`FOR/F`您可以使用该命令读取文件的内容。
将`FOR/F`逐行读取文件，每个空行都将被跳过，每一行都以 EOL 字符开头（默认为`;`）。

它默认使用`tokens=1 delims=<TAB><SPACE> EOL=;`.
在这种情况下，您总是得到一个令牌，直到行尾或第一个`SPACE`或`TAB`.

```
for /F "tokens=1" %%a in (myFile.txt) do (
  echo token1=%%a
) 
```

如果您想阅读更多令牌，则需要定义它。

```
for /F "tokens=1,2,3,4" %%a in (myFile.txt) do (
  echo token1=%%a token2=%%b token3=%%c token4=%%d
) 
```

现在，如果一行中的分隔符较少，则该行将在分隔符（SPACE 或 TAB）处分成四个标记，然后标记为空。

如果您不想要多个标记，或者在特定标记之后的行的其余部分，您可以使用`*`.
for /F "tokens=1,2,3,4*" %%a in (myFile.txt) do ( echo token1=%%a token2=%%b token3=%%c token4=%%d )

现在，在 token4 中将是第四个标记和该行的其余部分。

```
for /F "tokens=1*" %%a in (myFile.txt) do (
  echo token1=%%a token2=%%b token3=%%c token4=%%d
) 
```

在这种情况下，仅存在一个标记 ( `%%a`) 其他标记 ( `%%b` `%%c` `%%d`) 不是有效标记，文本`token2=%b token3=%c token4=%d`将被回显。

您还可以使用 delim 将所有标记减少到只有一个标记。for /F "delims=" %%a in (myFile.txt) do ( echo complete line=%%a )

这是可行的，因为只有一个标记，因为没有任何字符可以将行拆分为更多标记。

# cakephp-2.0 - CakePHP 2 使用分页时如何通过 URL 传递变量？

> ID：10584807
> 
> 赞同：0
> 
> 时间：2012-05-14T13:59:05.233
> 
> 标签：cakephp-2.0

我在 CakePHP 应用程序中有一个项目，我想向它添加分页。我已经为其添加了分页，但是当我单击页码或转到下一页时，我的应用程序会中断。

该页面依赖于传递给控制器​​的变量以显示正确的数据。这是我的视图代码：

```
 <table class="table table-striped">
            <thead>
                <tr>
                    <th>Job ID</th>
                    <th>Date</th>
                    <th>Site</th>
                    <th>&nbsp;</th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($data as $jobsheet) { ?>
                    <tr>
                        <td>
                            <?php echo $jobsheet['Jobsheet']['jobnum']; ?>
                        </td>
                        <td>
                            <?php echo date("l, jS F Y", strtotime($jobsheet['Jobsheet']['jobdate'])); ?>
                        </td>
                        <td>
                            <span class="companyname"><strong><?php echo $jobsheet['Siteaddress']['sitename'] ?></strong></span><br />
                            <?php echo $jobsheet['Siteaddress']['addressline1']; ?>, 
                            <?php echo $jobsheet['Siteaddress']['addressline2']; ?>, 
                            <?php if ( $jobsheet['Siteaddress']['addressline3'] = '') { ?>
                                <?php echo $jobsheet['Siteaddress']['addressline3']; ?>, 
                            <?php } else { ?>

                            <?php } ?>
                            <?php echo $jobsheet['Siteaddress']['city']; ?>, 
                            <?php echo $jobsheet['Siteaddress']['county']; ?>, 
                            <?php echo $jobsheet['Siteaddress']['country']; ?>, 
                            <?php echo $jobsheet['Siteaddress']['postcode']; ?>
                        </td>
                        <td><a data-toggle="modal" href="#viewjobsheet<?php echo $jobsheet['Jobsheet']['id']; ?>" onClick="document.getElementById('jbif<?php echo $jobsheet['Jobsheet']['id']; ?>').src='/modal/customers/<?php echo $company['Company']['id']; ?>/jobs/<?php echo $jobsheet['Jobsheet']['id']; ?>/view/';" title="View" class="icon-eye-open"></a>
                        </td>
                    </tr>
                <?php } ?>
            </tbody>
        </table>
    </div>
</div>

<div class="row">
    <div class="controls">
        <?php echo $this->Paginator->prev('« Previous', null, null, array('class' => 'disabled')); ?> 

        <?php echo $this->Paginator->numbers(); ?>

        <?php echo $this->Paginator->next('Next »', null, null, array('class' => 'disabled')); ?>
    <br />
    <br />
        <?php echo $this->Paginator->counter(array(
                'format' => 'Page {:page} of {:pages}, showing {:current} records out of
                         {:count} total, starting on record {:start}, ending on {:end}'
            ));
        ?>
    </div>
</div> 
```

这是控制器：

```
function index(){

    $companyid = $this->params['customer'];
    $this->set('companyid', $companyid);
    $siteid = $this->params['site'];

    $this->loadModel('Jobsheet');

    // Job Sheets
    $jobsheets = $this->Jobsheet->find('all', array('conditions' => array('Jobsheet.company' => $companyid), 'recursive' => 2, 'order' => 'Jobsheet.jobdate DESC', 'limit' => '10'));
    $this->set('jobsheets', $jobsheets);

    $this->paginate = array(
        'limit' => 10
    );

    $data = $this->paginate('Jobsheet');
    $this->set(compact('data'));    

} 
```

虽然分页确实有效，但它最终会丢失变量，这破坏了我正在尝试做的事情。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T07:49:58.633

一种方法是使用`PaginatorHelper::options`（参见[API](http://api20.cakephp.org/class/paginator-helper#method-PaginatorHelperoptions "API")）

例如，假设我们要`$pass`在 Paginator 页面更改之间传递变量。所以首先将变量传递给`View`.

```
public function index() {
    $pass = 'testString';
    $this->set(compact('pass'));
    $this->set('posts', $this->paginate());
} 
```

在 中`View`，我们可以将其添加到 Paginator 在更改页面时使用的参数`Paginator::options`和`url`选项中。

```
<?php
    $this->Paginator->options(array(
        'url' => array(
            'pass' => $pass
        )
    ));
?> 
```

因此，如果您从第 1 页移动到第 2 页，则生成的 url 将类似于：

```
http://localhost/cake/posts/index/pass:testString/page:2 
```

这也是 Paginator 传递排序顺序和排序键的方式。因此，虽然“传入”`pass:testString`可以是任何你想要的，但一定不要使用`sort`,`direction`和`page`.

只要您通过分页器链接更改页面，传递的变量就会保留。请注意，您可以通过属性访问传递的参数的值`View`和`Controller`属性：

```
$this->passedArgs 
```

# php - PHP 字符串长度

> ID：10584814
> 
> 赞同：4
> 
> 时间：2012-05-14T13:59:26.700
> 
> 标签：php, string, standards, php-internals

[PHP编码标准](http://svn.php.net/viewvc/php/php-src/trunk/CODING_STANDARDS?view=co)说：

> ... PHP 拥有每个字符串的长度属性，它不应该用 strlen() 来计算。以这样一种方式编写你的函数，以便它们能够利用长度属性，既是为了提高效率，也是为了使它们是二进制安全的。...

如何访问此长度属性？还是我误解了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:02:00.803

[正如伊格纳西奥在另一篇文章](https://stackoverflow.com/a/4161983/427992)中提到的那样：

> 他们在谈论 C 函数，而不是 PHP 函数。C 函数将在第一个 \0 之后停止计数，但 PHP 字符串可以在结尾以外的其他位置包含 \0。

该文档很可能是关于如何扩展 PHP 的引擎，而不是使用 PHP 本身进行编程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T14:01:59.817

这些编码标准并非针对使用 PHP 的网站开发人员，而是针对 PHP 引擎本身的开发人员。

PHP 是使用 C 语言开发的，`strlen`要避免的功能是 C 语言，而不是 PHP 语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:01:20.843

从某种意义上说，它不是其他语言（如 C#）中的“属性”。

你不能这样做： `myString.Length;`

相反，您需要这样做： `strlen(myString);`

# symfony - Symfony 2 & Twig，如何从扩展访问块

> ID：10584815
> 
> 赞同：3
> 
> 时间：2012-05-14T13:59:28.197
> 
> 标签：symfony, twig

我正在创建我的 Twig Extension 来扩展实际的“FormExtension”。原因是我需要创建新函数而不覆盖当前函数并使其在整个项目中可用。

因此，建设和扩展似乎是正确的方式。构建扩展不是问题，我的问题是如何从那里渲染块？

到目前为止，我所理解的是，我需要创建一个 Twig_Environment ，我必须在其中加载我的实际树枝模板（包含我的块）。从那里我应该能够使用“$mytemplate->displayBlock()”渲染这些块。

示例代码：

> 公共函数 renderWidgetinline(FormView $view, array $variables = array()) {
> 
> ```
>  $loader = new \Twig_Loader_Filesystem(__DIR__.'/../Resources/views/Form');
>   $twig = new \Twig_Environment($loader);
>   $this->template = $twig->loadTemplate("form_layout.html.twig");
> 
>   ob_start();
>   $this->template->displayBlock(???WHAT-PARAMS???);
>   $html = ob_get_clean();
> 
>   return $html; 
> ```
> 
> }

我通过查看 Symfony 基础 FormExtension.php 文件找到了这些信息。

我的问题是：

1.  displayBlock() 是如何工作的，我在哪里可以找到该函数的定义？
2.  我上面描述的方法是正确的吗？
3.  我应该如何继续访问该新的 TWIG 模板以及基本的 form_div_layout.html 模板？我能否以某种方式获得当前环境而不必重新创建一个并在那里加载我的附加模板？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-06T11:33:39.213

你试过`renderBlock`改用吗？

您需要的第一个参数是块的名称，第二个应该是传递给块的值的关联数组。

因此，对于呈现块的服务，您将拥有以下内容：

服务等级：

```
<?php

namespace Acme\BlockBundle\Blocks;

use Doctrine\Common\Persistence\ObjectManager;

Class Block {

    private $om;
    private $environment;
    private $template;

    public function __construct( ObjectManager $om, Twig $environment )
    {
        $this->om = $om;
        $this->environment = $environment;
    }

    public function render( $template, $data )
    {
        $this->template = $this->environment->loadTemplate( $template );

        // maybe query the DB via doctrine, that is why I have included $om
        // in the service arguments
        // example:

        $entities = $om->getRepository( 'AcmePizzaBundle:Pizza' )->getMeatyOnes()

        return $this->template->renderBlock( 'acme_block', array(
            'data' => $entities,
        ));
    }
} 
```

Twig 扩展类

```
<?php

namespace Acme\BlockBundle\Twig\Extension;

use Twig_Extension;
use Twig_Function_Method;

class BlockExtension extends Twig_Extension
{
    protected $container;

    public function __construct( $container )
    {
        $this->container = $container;
    }

    public function getName()
    {
        return 'block_extension';
    }

    public function getFunctions()
    {
        return array(
            'render_block' => new Twig_Function_Method( $this, 'renderBlock', array(
                'is_safe' => array( 'html' ),
            )),
        );
    }

    public function renderBlock( $template, $data )
    {
        return $this->container->get( 'acme.block' )->render( $template, $data );
    }
} 
```

服务.yml

```
parameters:
    acme.blocks.block.class:           Acme\BlocksBundle\Blocks\Block
    acme.twig.block_extension.class:   Acme\BlocksBundle\Twig\Extension\BlockExtension

services:
    acme.blocks.block:
        class:  '%acme.blocks.block.class%'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@twig'

acme.twig.block_extension:
    class: %acme.twig.block_extension.class%
    arguments:
        - '@service_container'
    tags:
        - { name: twig.extension } 
```

不要忘记您的模板：

```
{% block acme_block %}
    {% spaceless %}
        {# do something with your data here #}
    {% endspaceless %}
{% endblock acme_block %} 
```

然后当你想显示它时，你只需要调用你刚刚创建的twig函数：

```
{{ render_block( '::block_template.html.twig', someDataOneThePage ) }} 
```

这绝不是一个完整的解决方案，但我使用了类似的东西，它被证明是有效的。

高温高压

谭

[编辑：2016 年 4 月 - 供参考：此解决方案正在处理 Symfony 2.4 项目]

# javascript - 如何在 VS11 中为 javascript Metro 应用程序创建预构建步骤？

> ID：10584823
> 
> 赞同：2
> 
> 时间：2012-05-14T14:00:02.317
> 
> 标签：javascript, windows-8, visual-studio-2012, winjs

我想在每次构建之前运行一些自定义批处理代码。在 VS<11/C# 应用程序中，我可以在项目设置中设置预构建事件。我在 javascript Metro VS11 解决方案中找不到类似的设置。

任何人都知道它在哪里，或者如果选项消失了（！）我可以采取什么样的解决方法来代替它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T16:42:30.550

您可以使用 Visual Studio .jsproj 文件中的 BeforeBuild 目标来完成此操作：

```
<Target Name="BeforeBuild"></Target>
<Target Name="AfterBuild"></Target> 
```

到达这里：

1.  在 Visual Studio 中右键单击您的项目，然后选择在 Windows 资源管理器中打开文件夹
2.  在资源管理器中，右键单击 .jsproj 文件并选择打开方式...，然后选择记事本等编辑器
3.  滚动到文件底部，您会注意到这两个 Target 部分已被注释掉

取消注释 BeforeBuild 目标并在其中添加您的自定义步骤。您可以使用该元素执行命令行脚本；与 C# 预构建步骤中相同的 $ 变量可用（例如 $(ProjectDir)）。您可以做的不仅仅是在 Target 中调用命令行脚本，但这与您通常使用 C# 预构建步骤所做的最接近。

例如，下面的代码将调用一个名为 processFile.bat 的批处理文件，将它传递给项目根目录中 default.js 的路径和一个输出路径以在项目的输出目录中创建一个名为 output.js 的文件（例如 /bin/在调试模式下调试）：

```
<Target Name="BeforeBuild">
    <Exec Command="processFile.bat &quot;$(ProjectDir)default.js&quot; &quot;$(OutDir)output.js&quot;">
</Target> 
```

注意：“ 故意在 Command 参数中，这确保两个参数在传递给 processFile.bat 并通过 cmd.exe 调用时被引用。

# javascript - 播放视频的进度条

> ID：10584824
> 
> 赞同：1
> 
> 时间：2012-05-14T14:00:03.830
> 
> 标签：javascript, jquery, html, video, html5-video

我正在尝试添加一个进度条，显示视频的持续时间，但可以放置在视频本身之外（如屏幕的另一部分）。我已经环顾了一段时间，只找到了显示加载进度的，这是我不需要的。任何人都可以帮我找到在哪里可以找到它，或者甚至自己提供一个。

以防万一，这是视频的脚本

```
var numb = $(this).index(),
            videos = ['images/talking1.m4v', 'images/talking2.m4v', 'images/talking1.m4v', 'images/talking2.m4v', 'images/talking1.m4v', 'images/talking2.m4v'
            ],
            myVideo = document.getElementById('myVid');
            myVideo.src = videos[numb];

            myVideo.load();

    setTimeout(function(){

        myVideo.play();
    }, 200); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T14:35:46.210

您可以将事件侦听器绑定到`timeupdate`事件：

```
myVideo.addEventListener("timeupdate", function() {
   // if the video is loaded and duration is known
   if(!isNaN(this.duration)) {
        var percent_complete = this.currentTime / this.duration;
        // use percent_complete to draw a progress bar
    }
}); 
```

为进度条选择一个最大长度，将其乘以`percent_complete`（介于 0 和 1 之间），然后将该乘积用作进度条的当前长度。

# wordpress - 元描述显示垃圾邮件

> ID：10584827
> 
> 赞同：0
> 
> 时间：2012-05-14T14:00:13.527
> 
> 标签：wordpress, security

我的网站 (thebyandby.com) 几周前被黑了。问题是，谷歌上的描述显示了伟哥的垃圾邮件描述，并且最受欢迎的帖子之一（当从谷歌链接时）进入垃圾邮件网站。

该网站是一个 WordPress 网站，所以我重新安装了主题并确保所有内容都已更新。只安装了两个插件，Akismet 和 Google Analytics。我认为插件不会受到影响，但我不确定。问题仍然存在，所以我检查了谷歌上次索引我的网站的时间，那是在我重新安装主题之后。我从谷歌网站管理员那里检查了恶意软件，它说没有发现任何恶意软件。我在整个 web 目录上运行了 grep -r "viagra"，但没有找到任何东西。我真的不知道还能做什么。这可能是数据库问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:15:19.810

是的，很可能是您的数据库中的内容受到了损害。毕竟，这是存储所有页面和帖子的地方。您的托管公司是否提供像 phpMyAdmin 这样的工具来浏览和编辑数据库？

但同样，如果您只重新安装了*主题*，那么还有更多的*核心 WordPress 文件*可能已被黑客入侵。鉴于您遇到问题，完全重新安装 WordPress 文件是非常值得的。只需确保保留 wp-config 文件的副本，因为您需要将其复制回来。还要确保您重新安装了与您当前拥有的相同版本的 WordPress。

但你知道吗：从长远来看，从 WordPress 中导出所有帖子和页面，然后彻底清除被黑网站并从头开始安装，这可能会节省你的时间。您可以在任何体面的编辑器中打开导出文件，一旦您了解了 XML 结构，您就可以删除黑客放在那里的任何垃圾。我想这个选项取决于您已经在网站上放置了多少内容，以及您重新配置新网站以匹配旧网站的难易程度。

当然，如果您在黑客到达那里之前有完整的文件和数据库备份，那么您有一个简单的选择可以避免所有这些痛苦;-)

# jquery - 警告元素的像素宽度

> ID：10584829
> 
> 赞同：1
> 
> 时间：2012-05-14T14:00:19.320
> 
> 标签：jquery

我需要一个警报来显示元素的宽度（以像素为单位）。出于某种原因，下面的代码不会触发任何警报。

```
 var myVar = #('#from-1 select').width();

  alert(myVar); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:02:00.803

```
 var myVar = $('#from-1 select').width();

  alert(myVar); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:02:59.490

你的语法很狡猾。不知道你的意思，但是

```
var myVar = $('#from-1 select').width();

alert(myVar); 
```

# firefox-addon - 是否可以从 Firefox 扩展程序调用 youtube 的暂停/播放功能？

> ID：10584831
> 
> 赞同：1
> 
> 时间：2012-05-14T14:00:27.603
> 
> 标签：firefox-addon, youtube-api, firefox-addon-sdk

我正在尝试制作一个小扩展，以允许我使用放置在状态栏上的控件播放/暂停在浏览器选项卡中播放的视频。

我可以使用[youtube api](https://developers.google.com/youtube/js_api_reference)做到这一点吗？

最简单的方法是什么？

我正在尝试使用[Add-on SDK](https://addons.mozilla.org/en-US/developers/builder)编写它。这是个坏主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:15:40.557

我对 youtube api 了解不多，但看起来您可以在 youtube 播放器嵌入页面的情况下执行此操作（而不是视频显示在 youtube 网站本身上）：

> 为嵌入式播放器启用 JavaScript API
> 
> 使用以下 URL 加载嵌入式视频播放器。在 URL 中，将字符串 VIDEO_ID 替换为 11 个字符的 YouTube 视频 ID，该 ID 标识播放器将显示的视频。
> 
> [http://www.youtube.com/v/VIDEO_ID?version=3&enablejsapi=1](http://www.youtube.com/v/VIDEO_ID?version=3&enablejsapi=1)

在您的 Jetpack 附加组件中，您将使用 page-mod 将脚本注入页面，然后调用诸如“player.play()”等方法。这些方法将通过从您的小部件发送消息来触发，通过主.js 脚本，用于页面模块的工作人员。

有关内容脚本通信如何工作的更多信息，请参阅 SDK 文档：

[https://addons.mozilla.org/en-US/developers/docs/sdk/1.6/dev-guide/guides/content-scripts/index.html](https://addons.mozilla.org/en-US/developers/docs/sdk/1.6/dev-guide/guides/content-scripts/index.html)

# regex - 与 grep 意外的正则表达式匹配

> ID：10584833
> 
> 赞同：0
> 
> 时间：2012-05-14T14:00:35.687
> 
> 标签：regex, grep

我在 Ubuntu 10.10 上使用 GNU grep 2.6.3 并且正在复习我的正则表达式技能以准备即将到来的培训课程，并且在以下方面受到了意想不到的打击。

我有一个名为 strings.regex.txt 的文件，其内容如下：

```
STRING1   Mozilla/4.0 (compatible; MSIE 5.0; Windows NT; DigExt)
STRING2   Mozilla/4.75 [en](X11;U;Linux2.2.16-22 i586) 
```

这个 grep 命令：

```
grep 'x[0-9A-Z]' strings.regex.txt 
```

结果是：

```
STRING1   Mozilla/4.0 (compatible; MSIE 5.0; Windows NT; DigExt)
STRING2   Mozilla/4.75 [en](X11;U;Linux2.2.16-22 i586) 
```

我期望这是结果：

```
STRING2   Mozilla/4.75 [en](X11;U;Linux2.2.16-22 i586) 
```

谁能解释为什么我会得到上述结果？grep 输出的第一行不包含正则表达式 x[0-9A-Z] 的匹配项。它会在 x[0-9a-z] 或 x[0-9A-Za-z] 或许多其他正则表达式上匹配。我学习和理解正则表达式的方式。它不应该匹配。

以下是一些额外的 grep 命令和结果输出：

```
grep -o 'x[0-9A-Z]' strings.regex.txt 
x2 
```

（我预料到了这一点，它支持我目前对正则表达式的理解。）

```
grep -oc 'x[0-9A-Z]' strings.regex.txt 
2 
```

（我没想到会这样。我期待 1。）

```
grep -c 'x[0-9A-Z]' strings.regex.txt 
2 
```

（我没想到会这样。我期待 1。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:07:32.670

在grep命令前加a `LC_ALL=C`，即

```
$ grep -c 'x[0-9A-Z]' strings.regex.txt
2

$ LC_ALL=C grep -c 'x[0-9A-Z]' strings.regex.txt
1 
```

从 grep[手册页](http://www.gnu.org/software/grep/manual/html_node/Environment-Variables.html)

```
LC_ALL
LC_COLLATE
LANG
    These variables specify the locale for the LC_COLLATE category,
    which determines the collating sequence used to interpret range
    expressions like ‘[a-z]’. 
```

# ios - 显示最后一个单元格时添加表格单元格。在ios中

> ID：10584835
> 
> 赞同：0
> 
> 时间：2012-05-14T14:00:47.787
> 
> 标签：ios, uitableview, cell, reloaddata

我设置。显示最后一个单元格时，通过threadProcess添加单元格。

```
-(void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell      forRowAtIndexPath:(NSIndexPath *)indexPath
 {
    int nArrayCount;
    nArrayCount=[self.mAppGameList count];
    int row= (int)indexPath.row ;

    if(row == nArrayCount)
    {
        if(mSearchGame_Thread != nil)
            return;

        NextSearchCell *searchCell =(NextSearchCell *)cell;

        [searchCell.mActivityView startAnimating];

        NSThread *searchThread = [[NSThread alloc] initWithTarget:self
                                                         selector:@selector(searchNextThreadProc:) object:tableView];

        self.mSearchGame_Thread = searchThread;
        [searchThread release];
        [self.mSearchGame_Thread start];
        // start new search ...

    } 
```

//线程方法

```
 -(void)searchNextThreadProc:(id)param
 {

    UITableView *tableView=(id)param;

    NSMutableArray *newArray;

    newArray=[NSMutableArray arrayWithArray:self.mAppGameList];

    NSArray *pressedlist;
    nArrayCount=[self.mAppGameList count];

               .
               .
               .
   [newArray addObject:item];
   self.mAppGameList = newArray;

     [tableView reloadData];

     self.mSearchGame_Thread=nil;
 } 
```

这种方式是有问题的。

1.  如果我在 tableview 重新加载数据时滚动表格，有一段时间 tableview 消失并出现。

2.  如果我在添加下一个单元格时触摸单元格，有时会出现坏的 exc 内存。我认为，它在重新加载新表之前调用 tableView: didSelectRowAtIndexPath: 方法。所以，表的数据不是。

所以，我想替换reload tableview的方式。有什么办法吗？请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:45:28.363

您可以在 UITableView 中使用此方法通过动画添加新行，而不是使用 reloadData：

```
- (void)insertRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation; 
```

这样，您的视图在重新加载时不会消失并重新出现。

看到这个问题：[UITableView 添加单元格动画](https://stackoverflow.com/questions/3122934/uitableview-add-cell-animation)

还要确保使用以下命令在主线程中执行 UI 的任何刷新：

```
[self performSelectorOnMainThread:@selector(refreshMethodName) withObject:nil waitUntilDone:NO]; 
```

**关于您的代码的一些评论：**

*   如果在您的代码中如上使用，请确保您的 mAppGameList 是保留属性或复制属性。否则可能会导致访问不正确。
*   您应该确保 searchNextThreadProc 不会一次调用多次，否则您可能会遇到时间和性能问题。它看起来不是线程安全的。
*   通常，您应该将内容数据与 UITableView 分开处理。将表格视图视为显示已存在数据列表的工具。它不应该担心搜索数据等。而是使用一个单独的类来保存您正在使用的 NSMutableArray 中的数据，您可以在需要时不断填充数据。这个类可以通过方法调用触发tableView开始搜索新数据，但要确保刷新过程是线程安全的，并且对UI的多次调用是可持续的！一次 10xrefresh 调用仍然意味着一次只刷新 1 次！（例如，我们不希望同时调用 10 个服务器）这个内容列表应该与 UITableView 的列表完全分开。
*   当新数据可用时，通过创建可以调用的刷新方法告诉 UITableView 刷新。刷新UITableView时，如果mAppGameList属性为retain或copy，则无需重新添加列表中的所有数据。如果您在包含建议的所有数据的单独类中有一个 NSMutableArray，只需使用类似 self.mAppGameList = [NSArray arrayWithArray:[yourClass gameList]]; （如果您对 mAppGameList 使用保留）
*   当触发 UITableView 的刷新时，使用 performSelectorOnMainThread。要启动一个新的后台线程，您还可以使用 performSelectorInBackground 而不是 NSThread alloc 等。

# c - pthread_cond_timedwait 忽略取消请求

> ID：10584836
> 
> 赞同：3
> 
> 时间：2012-05-14T14:00:48.050
> 
> 标签：c, macos, pthreads, posix

我对 pthread_cond_timedwait() 有一个奇怪的问题：根据 POSIX 规范，它是一个取消点。但是，当我在线程上调用 pthread_cancel() 时，它永远不会被取消！相反， pthread_cond_timedwait() 继续正常运行。它没有锁定或任何东西，它只是继续运行，就好像从未调用过 pthread_cancel() 一样。但是，只要我插入 pthread_testcancel() 调用，线程就会被正确取消！如果没有调用 pthread_testcancel()，线程永远不会被取消，尽管我一直在调用 pthread_cond_timedwait()。

有人知道这里出了什么问题吗？非常感谢！

编辑：这里是代码：

```
#include <stdio.h>
#include <pthread.h>
#include <time.h>
#include <sys/time.h>

// replacement function because OS X doesn't seem to have clock_gettime()
static int clock_gettime(int clk_id, struct timespec* t)
{
    struct timeval now;
    int rv = gettimeofday(&now, NULL);

        if(rv) return rv;

    t->tv_sec = now.tv_sec;
        t->tv_nsec = now.tv_usec * 1000;

    return 0;
}

static void *threadproc(void *data)
{
    pthread_mutex_t mutex;
    pthread_mutexattr_t attr;               
    pthread_cond_t cond;

    pthread_mutexattr_init(&attr);
    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);

    pthread_mutex_init(&mutex, &attr);      
    pthread_mutexattr_destroy(&attr);

    pthread_cond_init(&cond, NULL);

    for(;;) {

        struct timespec ts;

        clock_gettime(0, &ts);

        // wait 60ms
        ts.tv_nsec += 60 * 1000000;

        pthread_mutex_lock(&mutex);
        pthread_cond_timedwait(&cond, &mutex, &ts);
        pthread_mutex_unlock(&mutex);   

#if 0
        pthread_testcancel();
#endif      
    }

    return NULL;    
}

int main(int argc, char *argv[])
{
    pthread_t pThread;

    pthread_create(&pThread, NULL, threadproc, NULL);

    printf("Waiting...\n");
    sleep(5);
    printf("Killing thread...\n");

    pthread_cancel(pThread);
    pthread_join(pThread, NULL);

    printf("Ok!\n");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:19:23.947

您对代码应该如何表现的期望是正确的，事实上它在我刚刚测试的其他系统上按预期工作。我认为您刚刚在 OSX 中发现了（又一个）错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-19T20:42:51.093

`pthread_cancel`在 OS X 10.11.4（可能还有更早的版本）中正常运行。此外，返回的`value_ptr`参数，正如预期的那样。`pthread_join``PTHREAD_CANCELED`

# linux - JCR / Jackrabit / Derby - 在 Linux 上恢复版本时使用二进制数据进行慢速 IO

> ID：10584839
> 
> 赞同：1
> 
> 时间：2012-05-14T14:01:04.450
> 
> 标签：linux, io, derby, jackrabbit, jcr

我在其上存储带有二进制数据（3mb）的默认节点。更改它们并再次保存。后来我想找回旧版本，所以我使用了恢复功能。在 Windows 上，这可以正常速度（最多 1 秒）运行。但在 Linux 上大约需要 20 秒。

有谁知道是什么让它这么慢？这里的堆栈跟踪来自缓慢的地方：

```
Daemon Thread [ajp-bio-8011-exec-40] (Evaluating)   
RandomAccessFile.writeBytes(byte[], int, int) line: not available [native method]   
DirRandomAccessFile4(RandomAccessFile).write(byte[], int, int) line: 466    
LogAccessFile.writeToLog(byte[], int, int, long) line: not available    
LogAccessFile.flushDirtyBuffers() line: not available [local variables unavailable] 
LogAccessFile.switchLogBuffer() line: not available 
LogAccessFile.reserveSpaceForChecksum(int, long, long) line: not available  
LogToFile.appendLogRecord(byte[], int, int, byte[], int, int) line: not available   
FileLogger.logAndDo(RawTransaction, Loggable) line: not available   
Xact.logAndDo(Loggable) line: not available 
LoggableActions.doAction(RawTransaction, BasePage, Loggable) line: not available    
LoggableActions.actionInsert(RawTransaction, BasePage, int, int, Object[], FormatableBitSet, LogicalUndo, byte, int, boolean, int, DynamicByteArrayOutputStream, int, int) line: not available  
StoredPage(BasePage).insertLongColumn(BasePage, LongColumnException, byte) line: not available  
StoredPage(BasePage).insertAllowOverflow(int, Object[], FormatableBitSet, int, byte, int, RecordHandle) line: not available 
StoredPage(BasePage).insert(Object[], FormatableBitSet, byte, int) line: not available  
HeapController.doInsert(DataValueDescriptor[]) line: not available  
HeapController.insertAndFetchLocation(DataValueDescriptor[], RowLocation) line: not available   
RowChangerImpl.insertRow(ExecRow) line: not available   
InsertResultSet.normalInsertCore(LanguageConnectionContext, boolean) line: not available    
InsertResultSet.open() line: not available  
GenericPreparedStatement.executeStmt(Activation, boolean, long) line: not available 
GenericPreparedStatement.execute(Activation, long) line: not available  
EmbedPreparedStatement40(EmbedStatement).executeStatement(Activation, boolean, boolean) line: not available 
EmbedPreparedStatement40(EmbedPreparedStatement).executeStatement(Activation, boolean, boolean) line: not available 
EmbedPreparedStatement40(EmbedPreparedStatement).execute() line: not available  
PoolablePreparedStatement(DelegatingPreparedStatement).execute() line: 172  
DelegatingPreparedStatement.execute() line: 172 
DelegatingPreparedStatement.execute() line: 172 
DerbyConnectionHelper(ConnectionHelper).execute(PreparedStatement, Object[]) line: 473  
DerbyConnectionHelper(ConnectionHelper).reallyExec(String, Object...) line: 303 
ConnectionHelper$1.call() line: 285 
ConnectionHelper$1.call() line: 281 
ConnectionHelper$1(ConnectionHelper$RetryManager<T>).doTry() line: 486  
DerbyConnectionHelper(ConnectionHelper).exec(String, Object...) line: 281   
BundleDbPersistenceManager$DbBlobStore.put(String, InputStream, long) line: 1214    
BundleWriter.writeState(NodePropBundle$PropertyEntry) line: 240 
BundleWriter.writeBundle(NodePropBundle) line: 132  
BundleBinding.writeBundle(OutputStream, NodePropBundle) line: 164   
DerbyPersistenceManager(BundleDbPersistenceManager).storeBundle(NodePropBundle) line: 885   
DerbyPersistenceManager(AbstractBundlePersistenceManager).putBundle(NodePropBundle) line: 769   
DerbyPersistenceManager(AbstractBundlePersistenceManager).storeInternal(ChangeLog) line: 686    
DerbyPersistenceManager(AbstractBundlePersistenceManager).store(ChangeLog) line: 563    
DerbyPersistenceManager(BundleDbPersistenceManager).store(ChangeLog) line: 477  
SharedItemStateManager$Update.end() line: 770   
SharedItemStateManager.update(ChangeLog, EventStateCollectionFactory) line: 1492    
XAItemStateManager(LocalItemStateManager).update(ChangeLog) line: 400   
XAItemStateManager.update(ChangeLog) line: 354  
XAItemStateManager(LocalItemStateManager).update() line: 375    
VersionManagerImplBase$WriteOperation.save() line: 470  
VersionManagerImpl$6.perform(SessionContext) line: 253  
SessionState.perform(SessionOperation<T>) line: 216 
VersionManagerImpl.perform(SessionOperation<T>) line: 96    
VersionManagerImpl.restore(Version[], boolean) line: 225    
VersionManagerImpl.restore(Version, boolean) line: 217 
```

我的配置你能指点我一个新的吗？：

```
<?xml version="1.0"?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!DOCTYPE Repository PUBLIC "-//The Apache Software Foundation//DTD Jackrabbit 1.5//EN"
"http://jackrabbit.apache.org/dtd/repository-1.5.dtd">
<!-- Example Repository Configuration File
Used by
- org.apache.jackrabbit.core.config.RepositoryConfigTest.java
-
-->
<Repository>
    <!--
    virtual file system where the repository stores global state
    (e.g. registered namespaces, custom node types, etc.)
    -->
    <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
        <param name="path" value="${rep.home}/repository"/>
    </FileSystem>
    <!--
    security configuration
    -->
    <Security appName="Jackrabbit">
        <!--
        security manager:
        class: FQN of class implementing the JackrabbitSecurityManager interface
        -->
        <SecurityManager class="org.apache.jackrabbit.core.security.simple.SimpleSecurityManager" workspaceName="security">
            <!--
            workspace access:
            class: FQN of class implementing the WorkspaceAccessManager interface
            -->
            <!-- <WorkspaceAccessManager class="..."/> -->
            <!-- <param name="config" value="${rep.home}/security.xml"/> -->
        </SecurityManager>
        <!--
        access manager:
        class: FQN of class implementing the AccessManager interface
        -->
        <AccessManager class="org.apache.jackrabbit.core.security.simple.SimpleAccessManager">
            <!-- <param name="config" value="${rep.home}/access.xml"/> -->
        </AccessManager>
        <LoginModule class="org.apache.jackrabbit.core.security.simple.SimpleLoginModule">
            <!--
            anonymous user name ('anonymous' is the default value)
            -->
            <param name="anonymousId" value="anonymous"/>
            <!--
            administrator user id (default value if param is missing is 'admin')
            -->
            <param name="adminId" value="admin"/>
        </LoginModule>
    </Security>
    <!--
    location of workspaces root directory and name of default workspace
    -->
    <Workspaces rootPath="${rep.home}/workspaces" defaultWorkspace="default"/>
    <!--
    workspace configuration template:
    used to create the initial workspace if there's no workspace yet
    -->
    <Workspace name="${wsp.name}">
        <!--
        virtual file system of the workspace:
        class: FQN of class implementing the FileSystem interface
        -->
        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
            <param name="path" value="${wsp.home}"/>
        </FileSystem>
        <!--
        persistence manager of the workspace:
        class: FQN of class implementing the PersistenceManager interface
        -->
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.bundle.DerbyPersistenceManager">
            <param name="url" value="jdbc:derby:${wsp.home}/db;create=true"/>
            <param name="schemaObjectPrefix" value="${wsp.name}_"/>
        </PersistenceManager>
        <!--
        Search index and the file system it uses.
        class: FQN of class implementing the QueryHandler interface
        -->
        <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
            <param name="path" value="${wsp.home}/index"/>
            <param name="textFilterClasses" value="org.apache.jackrabbit.extractor.PlainTextExtractor,org.apache.jackrabbit.extractor.MsWordTextExtractor,org.apache.jackrabbit.extractor.MsExcelTextExtractor,org.apache.jackrabbit.extractor.MsPowerPointTextExtractor,org.apache.jackrabbit.extractor.PdfTextExtractor,org.apache.jackrabbit.extractor.OpenOfficeTextExtractor,org.apache.jackrabbit.extractor.RTFTextExtractor,org.apache.jackrabbit.extractor.HTMLTextExtractor,org.apache.jackrabbit.extractor.XMLTextExtractor"/>
            <param name="extractorPoolSize" value="2"/>
            <param name="supportHighlighting" value="true"/>
        </SearchIndex>
    </Workspace>
    <!--
    Configures the versioning
    -->
    <Versioning rootPath="${rep.home}/version">
        <!--
        Configures the filesystem to use for versioning for the respective
        persistence manager
        -->
        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
            <param name="path" value="${rep.home}/version" />
        </FileSystem>
        <!--
        Configures the persistence manager to be used for persisting version state.
        Please note that the current versioning implementation is based on
        a 'normal' persistence manager, but this could change in future
        implementations.
        -->
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.bundle.DerbyPersistenceManager">
            <param name="url" value="jdbc:derby:${rep.home}/version/db;create=true"/>
            <param name="schemaObjectPrefix" value="version_"/>
        </PersistenceManager>
    </Versioning>
    <!--
    Search index for content that is shared repository wide
    (/jcr:system tree, contains mainly versions)

    <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
        <param name="path" value="${rep.home}/repository/index"/>
        <param name="textFilterClasses" value="org.apache.jackrabbit.extractor.PlainTextExtractor,org.apache.jackrabbit.extractor.MsWordTextExtractor,org.apache.jackrabbit.extractor.MsExcelTextExtractor,org.apache.jackrabbit.extractor.MsPowerPointTextExtractor,org.apache.jackrabbit.extractor.PdfTextExtractor,org.apache.jackrabbit.extractor.OpenOfficeTextExtractor,org.apache.jackrabbit.extractor.RTFTextExtractor,org.apache.jackrabbit.extractor.HTMLTextExtractor,org.apache.jackrabbit.extractor.XMLTextExtractor"/>
        <param name="extractorPoolSize" value="2"/>
        <param name="supportHighlighting" value="true"/>
    </SearchIndex>
    -->
</Repository> 
```

正确的配置是：

```
<?xml version="1.0"?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!DOCTYPE Repository PUBLIC "-//The Apache Software Foundation//DTD Jackrabbit 1.5//EN"
"http://jackrabbit.apache.org/dtd/repository-1.5.dtd">
<!-- Example Repository Configuration File
Used by
- org.apache.jackrabbit.core.config.RepositoryConfigTest.java
-
-->
<Repository>
    <!--
    virtual file system where the repository stores global state
    (e.g. registered namespaces, custom node types, etc.)
    -->
    <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
        <param name="path" value="${rep.home}/repository"/>
    </FileSystem>

    <!--
        data store configuration
    -->
    <DataStore class="org.apache.jackrabbit.core.data.FileDataStore"/>

    <!--
    security configuration
    -->
    <Security appName="Jackrabbit">
        <!--
        security manager:
        class: FQN of class implementing the JackrabbitSecurityManager interface
        -->
        <SecurityManager class="org.apache.jackrabbit.core.security.simple.SimpleSecurityManager" workspaceName="security">
            <!--
            workspace access:
            class: FQN of class implementing the WorkspaceAccessManager interface
            -->
            <!-- <WorkspaceAccessManager class="..."/> -->
            <!-- <param name="config" value="${rep.home}/security.xml"/> -->
        </SecurityManager>
        <!--
        access manager:
        class: FQN of class implementing the AccessManager interface
        -->
        <AccessManager class="org.apache.jackrabbit.core.security.simple.SimpleAccessManager">
            <!-- <param name="config" value="${rep.home}/access.xml"/> -->
        </AccessManager>
        <LoginModule class="org.apache.jackrabbit.core.security.simple.SimpleLoginModule">
            <!--
            anonymous user name ('anonymous' is the default value)
            -->
            <param name="anonymousId" value="anonymous"/>
            <!--
            administrator user id (default value if param is missing is 'admin')
            -->
            <param name="adminId" value="admin"/>
        </LoginModule>
    </Security>
    <!--
    location of workspaces root directory and name of default workspace
    -->
    <Workspaces rootPath="${rep.home}/workspaces" defaultWorkspace="default"/>
    <!--
    workspace configuration template:
    used to create the initial workspace if there's no workspace yet
    -->
    <Workspace name="${wsp.name}">
        <!--
        virtual file system of the workspace:
        class: FQN of class implementing the FileSystem interface
        -->
        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
            <param name="path" value="${wsp.home}"/>
        </FileSystem>
        <!--
        persistence manager of the workspace:
        class: FQN of class implementing the PersistenceManager interface
        -->
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.bundle.DerbyPersistenceManager">
            <param name="url" value="jdbc:derby:${wsp.home}/db;create=true"/>
            <param name="schemaObjectPrefix" value="${wsp.name}_"/>
        </PersistenceManager>
        <!--
        Search index and the file system it uses.
        class: FQN of class implementing the QueryHandler interface
        -->
        <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
            <param name="path" value="${wsp.home}/index"/>
            <param name="textFilterClasses" value="org.apache.jackrabbit.extractor.PlainTextExtractor,org.apache.jackrabbit.extractor.MsWordTextExtractor,org.apache.jackrabbit.extractor.MsExcelTextExtractor,org.apache.jackrabbit.extractor.MsPowerPointTextExtractor,org.apache.jackrabbit.extractor.PdfTextExtractor,org.apache.jackrabbit.extractor.OpenOfficeTextExtractor,org.apache.jackrabbit.extractor.RTFTextExtractor,org.apache.jackrabbit.extractor.HTMLTextExtractor,org.apache.jackrabbit.extractor.XMLTextExtractor"/>
            <param name="extractorPoolSize" value="2"/>
            <param name="supportHighlighting" value="true"/>
        </SearchIndex>
    </Workspace>
    <!--
    Configures the versioning
    -->
    <Versioning rootPath="${rep.home}/version">
        <!--
        Configures the filesystem to use for versioning for the respective
        persistence manager
        -->
        <FileSystem class="org.apache.jackrabbit.core.fs.local.LocalFileSystem">
            <param name="path" value="${rep.home}/version" />
        </FileSystem>
        <!--
        Configures the persistence manager to be used for persisting version state.
        Please note that the current versioning implementation is based on
        a 'normal' persistence manager, but this could change in future
        implementations.
        -->
        <PersistenceManager class="org.apache.jackrabbit.core.persistence.bundle.DerbyPersistenceManager">
            <param name="url" value="jdbc:derby:${rep.home}/version/db;create=true"/>
            <param name="schemaObjectPrefix" value="version_"/>
        </PersistenceManager>
    </Versioning>
    <!--
    Search index for content that is shared repository wide
    (/jcr:system tree, contains mainly versions)

    <SearchIndex class="org.apache.jackrabbit.core.query.lucene.SearchIndex">
        <param name="path" value="${rep.home}/repository/index"/>
        <param name="textFilterClasses" value="org.apache.jackrabbit.extractor.PlainTextExtractor,org.apache.jackrabbit.extractor.MsWordTextExtractor,org.apache.jackrabbit.extractor.MsExcelTextExtractor,org.apache.jackrabbit.extractor.MsPowerPointTextExtractor,org.apache.jackrabbit.extractor.PdfTextExtractor,org.apache.jackrabbit.extractor.OpenOfficeTextExtractor,org.apache.jackrabbit.extractor.RTFTextExtractor,org.apache.jackrabbit.extractor.HTMLTextExtractor,org.apache.jackrabbit.extractor.XMLTextExtractor"/>
        <param name="extractorPoolSize" value="2"/>
        <param name="supportHighlighting" value="true"/>
    </SearchIndex>
    -->
</Repository> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T08:21:30.023

问题似乎是您使用的`FileDataStore`是未使用的旧配置文件。要使用它，您可以：

*   按照[Jackrabbit Wiki 页面中所述为 DataStore](http://wiki.apache.org/jackrabbit/DataStore#How_to_Configure_the_File_Data_Store)配置`FileDataStore`现有文件（这可能需要更改文档类型），或者`repository.xml`

*   将您的存储库迁移到新版本的 Jackrabbit，如[备份和迁移的 Jackrabbit Wiki 页面](http://wiki.apache.org/jackrabbit/BackupAndMigration)中所述。

迁移数据的好处是现有的二进制文件也被移动到 FileDataStore，这应该会减少存储库的大小。

# apache - Apache 2.2：“客户端被服务器配置拒绝” - .htaccess 密码保护

> ID：10584840
> 
> 赞同：1
> 
> 时间：2012-05-14T14:01:09.113
> 
> 标签：apache, .htaccess, passwords, httpd.conf

我在尝试在 .htaccess 文件中为我的服务器上的子目录设置密码时遇到问题。很长一段时间后，它终于按预期工作了，但是每次我在浏览器中打开该站点后，Apache error.log 中都会出现错误：
[Mon May 14 13:55:33 2012] [error] [client 127.0.0.1 ] 客户端被服务器配置拒绝：C:/Program Files (x86)/Apache Software Foundation/Apache2.2/htdocs/creativedesigner/.htaccess

我的一些 httpd.conf：
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authn_file_module modules/mod_authn_file.so

<Directory />
选项 FollowSymLinks
AllowOverride None
Order deny,allow
Deny from all
</Directory>

<Directory "C:/Program Files (x86)/Apache Software Foundation/Apache2.2/htdocs/">
Options Indexes FollowSymLinks
AllowOverride All
Order allow,deny
Allow from all
</Directory>

访问文件名 .htaccess

<FilesMatch "^.ht">
命令拒绝，允许
拒绝所有
满足所有
</FilesMatch>

和 .htaccess 文件：
AuthType Basic
AuthName "Password"
AuthUserFile "C:/Program Files (x86)/Apache Software Foundation/Apache2.2/htdocs/pass/.htpasswd"
需要有效用户

无论如何 - 它有效 - 我必须使用正确的用户名和密码才能看到该站点。但是我正在准备一个相当大的项目，所以我不希望将来出现任何错误，并且在日志中得到这个肯定是有问题的。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:03:29.117

哦，我的天哪 - 我上周问了同样的问题，这一定是 Apache 中的一个错误：

[Apache Log 说：拒绝 - 但它有效（htaccess）](https://stackoverflow.com/questions/10532746/apache-log-says-deny-but-it-works-htaccess)

# ruby-on-rails - 视图和控制器之外的 Rails 引擎 RouteProxy

> ID：10584843
> 
> 赞同：3
> 
> 时间：2012-05-14T14:01:14.310
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routes, rails-engines

我正在尝试评估为不安全代码评估而设计的类中的路由帮助器字符串。基本上我有一个类 SafeEval 它将评估沙盒类中的字符串。我做了以下工作以使路线助手在 SafeEval 中工作

```
include ActionController::UrlFor
include Rails.application.routes.url_helpers 
```

所有 ruote 助手都在工作，除了引擎路由代理。在我的视图和控制器中，我可以调用 blog.page_path(@page) 但我不能在 SafeEval 中调用 blog.page_path - 我没有定义博客。我查看了我的视图，博客是 RouteProxy。

所以我的问题是如何在视图/控制器之外的类中获取引擎路由代理

（SafeEvla 不做很多沙盒。你可以假设一个非常简单的结构：一个现在只在 SafeEval 类中运行 eval(str) 的方法。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-11-23T08:31:07.063

我认为在您的班级中包含已安装的助手可以解决问题：

```
include Rails.application.routes.mounted_helpers 
```

# .net - 如何强制 Visual Studio MSI 包覆盖更新的文件？

> ID：10584850
> 
> 赞同：0
> 
> 时间：2012-05-14T14:01:33.640
> 
> 标签：.net, vb.net, visual-studio-2010, windows-installer

这是我在此的头一篇博文。

我在这里遇到了一个大问题。我有一个 1.0.0 应用程序，它将 Access 数据库安装到用户的机器中。我还有一个需要发布的 1.0.1 版本，它有一个我想安装的新数据库文件，覆盖旧文件。不幸的是，如果用户对旧文件进行任何更新，1.0.1 版本不会再覆盖它，而且我在任何地方都没有找到如何在更新后强制删除或覆盖该文件。

你们能帮我解决这个问题吗？谢谢和最好的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:25:11.317

Oy vey，我对这个头疼不已。

基本上，您可以尝试以下操作：

```
msiexec.exe /i yourmsi.msi REINSTALLMODE=omus 
```

[这里有一些有用的信息](http://www.packagedeploy.com/packaging-tips-tricks/always-overwrite-a-file-irrespective-of-msi-versioning-rules.html)。

老实说，我们最终使用了 InstallShield，它更简单而且物有所值。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T08:19:39.770

由于您提到 Orca 是您对[matt 答案的回复](https://stackoverflow.com/a/10585277/15498)，因此您可以通过编辑表中的[列](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368596%28v=vs.85%29.aspx)将访问数据库设置为[伴随文件](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367997%28v=vs.85%29.aspx)：`Version`[`File`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368596%28v=vs.85%29.aspx)

> 伴随文件的安装状态不取决于它自己的文件版本信息，而是取决于它的伴随父文件的版本。请参阅[文件版本控制规则](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368599%28v=vs.85%29.aspx)。要指定伴随文件，必须将[File 表](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368596%28v=vs.85%29.aspx)中伴随父级的主键编写到伴随记录的 Version 列中。

# javascript - 谷歌地图上的多个多边形 - 不工作 - 加入

> ID：10584851
> 
> 赞同：0
> 
> 时间：2012-05-14T14:01:43.640
> 
> 标签：javascript, google-maps

使用下面的代码，我可以在地图上绘制多边形，但是多边形被视为一个多边形，并且 api 将它们连接起来，就像在多边形上一样。我一直在用头撞这个！我需要每个多边形在地图上加载不同的形状。在数组中的格式如下：

```
[[11.11,11.11],[22.22,22.22],[33.33,33.33]] 
```

的

```
[[[11.11,11.11],[22.22,22.22],[33.33,33.33]],[[11.11,11.11],[22.22,22.22],[33.33,33.33]]]

var polys = [[[51.4503639, -0.1006082], [51.4502851, -0.1000704], [51.4491791, -0.0992159], [51.4480629, -0.0978004], [51.4486121, -0.098658], [51.4503639, -0.1006082]], [[51.4225526, -0.1618125], [51.42297, -0.160525], [51.4222314, -0.1603534], [51.421847, -0.1590405], [51.4216169, -0.1583023], [51.4198131, -0.1587487], [51.4196633, -0.1579333], [51.4195509, -0.1571436], [51.4188674, -0.1577788], [51.4190548, -0.1585427], [51.4189852, -0.1594954], [51.4182427, -0.1601064], [51.4175419, -0.1606966], [51.416929, -0.1618334], [51.4175821, -0.1618763], [51.4183207, -0.1624428], [51.4181762, -0.1640049], [51.4182297, -0.1646916], [51.4191932, -0.1649233], [51.4204705, -0.1644732], [51.4211931, -0.1643445], [51.4216213, -0.1642758], [51.4209897, -0.1643016], [51.4201781, -0.163241], [51.4214072, -0.1623876], [51.4219531, -0.1621987], [51.4220602, -0.1621558], [51.4225526, -0.1618125]]]

  var latLng =[]
  var locs = []

  for (var _p=0; _p < polys.length; _p++) {
      locs = polys[_p];

      for (_i = 0, _len = locs.length; _i < _len; _i++) {
          point = locs[_i];
          latLng.push(new google.maps.LatLng(point[0], point[1]));}

          bermudaTriangle = new google.maps.Polygon({
           paths: latLng,
           fillColor: "#FF0000",
           fillOpacity:0.1
           });
  }
          bermudaTriangle.setMap(map);

  } 
```

最后这奏效了：

```
 var latLng =[]
  var locs = []
  for (var _p=0; _p < polys.length; _p++) {
      locs = polys[_p];
      var  latLng = [];
      var bermudaTriangle = []
    for (_i = 0, _len = locs.length; _i < _len; _i++) {

            point = locs[_i];
            latLng.push(new google.maps.LatLng(point[0], point[1]));}

    bermudaTriangle = new google.maps.Polygon({
               paths: latLng,
               fillColor: "#FF0000",
               fillOpacity:0.1
    });

    bermudaTriangle.setMap(map);
     }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:24:36.580

您应该将调用移动到内部循环之外创建 Polygon。而且您每次都需要重新创建 latLng 数组。

```
var latLng =[];

for (_i = 0, _len = locs.length; _i < _len; _i++) {
          point = locs[_i];
          latLng.push(new google.maps.LatLng(point[0], point[1]));}
}

bermudaTriangle = new google.maps.Polygon({
           paths: latLng,
           fillColor: "#FF0000",
           fillOpacity:0.1
});

bermudaTriangle.setMap(map); 
```

# django - 我的 PostGIS 数据库看起来不错，但 GeoDjango 不这么认为……为什么？

> ID：10584852
> 
> 赞同：11
> 
> 时间：2012-05-14T14:01:53.247
> 
> 标签：django, postgresql, postgis, geodjango

我正在尝试设置一个 GeoDjango 应用程序来测试我之前遇到[的问题](https://stackoverflow.com/questions/10486149/)。我已经建立了一个 postgresql 数据库，创建了一个新的 Django 项目和应用程序，但是当我尝试时，`./manage.py syncdb`我得到了这个：

> django.core.exceptions.ImproperlyConfigured：无法确定数据库“django_geotest”的 PostGIS 版本。GeoDjango 至少需要 PostGIS 1.3 版。数据库是从空间数据库模板创建的吗？

我不明白，因为我之前已经完成了 GeoDjango 要求的所有安装，并`django_geotest`通过这样做创建了这个数据库：

```
$ createdb -T template_postgis django_geotest 
```

看起来数据库设置正确：

```
django_geotest=# SELECT PostGIS_full_version();
                                     postgis_full_version                                          
-------------------------------------------------------------------------------------------------------
 POSTGIS="1.5.3" GEOS="3.2.2-CAPI-1.6.2" PROJ="Rel. 4.7.1, 23 September 2009" LIBXML="2.7.3" USE_STATS
(1 row) 
```

描述数据库，我得到这个：

```
django_geotest=# \d                
             List of relations
 Schema |       Name        | Type  | Owner 
--------+-------------------+-------+-------
 public | geography_columns | view  | phil
 public | geometry_columns  | table | phil
 public | spatial_ref_sys   | table | phil
(3 rows) 
```

所以现在我不知道接下来要尝试什么......我对postgresql及其模板等的了解并不是那么好。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-02-11T15:19:57.050

I had the same problem with PostgreSQL 9.3 and PostGIS 2.1 installed on OS X 10.9.1 using homebrew.

For this particular issue, you only need to add this line:

```
POSTGIS_VERSION = ( 2, 1 ) 
```

using the comma separated number for your PostGIS version to `settings.py`.

I'm not sure why, but Django's having trouble reading the version information from PostGIS.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-02T14:20:09.347

`DATABASES`每当我在类似情况下遇到此错误时（即当数据库似乎是一个完全有效的 PostGIS 数据库时），结果证明`settings.py`. 连接到数据库失败时实际上是身份验证，但碰巧在启动我的 GeoDjango 项目时接触数据库的第一件事是`postgis_lib_version`来自的调用`django/contrib/gis/db/backends/postgis/operations.py`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T02:16:57.647

几个月前我遇到了同样的问题。我不得不再次重新创建 template_database 和主数据库。[从这个链接](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#creating-a-spatial-database-template-for-postgis)。

# asp.net - 在 ASP.NET CreateUserWizard 控件中隐藏和预填充字段？

> ID：10584856
> 
> 赞同：1
> 
> 时间：2012-05-14T14:02:06.387
> 
> 标签：asp.net, vb.net, asp.net-membership, createuserwizard

我有一个应用程序，用户在其中填写了一份表明他们对服务感兴趣的表格。这包括联系信息。（例如姓名、电子邮件）。然后将它们重定向到带有 CreateUserWizard 控件的页面 - 其想法是它将使用大部分信息预填充表单。需要创建一个用户帐户（不包括需要手动输入的用户名/密码）。

我想做的是让 CreateUserWizard 控件根本不显示这些字段（以便它们以不可见的方式预填充），因此用户看到的只是他们需要输入用户名和密码。我可以通过两种方式实现这一目标：

使用子程序：我可以使用像 CreateUserWizard_CreatedUser 这样的子程序来添加信息。以编程方式。我不确定 CreatedUser 是否是添加此信息的最佳位置。？

使用隐藏字段：我想我可以将隐藏字段添加到 CreateUserWizard 控件布局中，并以某种方式告诉控件在这些不可见字段中查找信息。喜欢姓名和电子邮件？

我正在寻找有关实现此目标的最佳方法的建议以及有关如何实际实施的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:19:50.700

当用户填写联系信息表单并单击提交时，您可以将该信息存储在 Session 变量中（这里，“phoneNum”和“email”将是您的联系信息`TextBox`）：

```
Session("name") = phoneNum.Text
Session("email") = email.Text 
```

这样，您可以轻松地从您`CreateUserWizard`所在的页面代码中访问这些值。

听起来您很可能希望处理[创建用户](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx)`CreateUserWizard`事件，以便在成员资格提供程序上调用 CreateUser 方法之前将这些值放在您的适当控件中。像这样的东西：

```
Protected Sub RegisterUser_CreatingUser(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.LoginCancelEventArgs) Handles RegisterUser.CreatingUser
    RegisterUser.Email = Session("email").ToString()
    RegisterUser.UserName = Session("name").ToString()
End Sub 
```

（“RegisterUser”是您的`CreateUserWizard`控件的名称）

如果您有任何问题，请告诉我。

# php - 如果代码字段未禁用，则为该字段创建规则

> ID：10584858
> 
> 赞同：0
> 
> 时间：2012-05-14T14:02:08.413
> 
> 标签：php, yii

我有一个现场客户代码。如果列表框的值为人员，它将被禁用，如果列表框的值为管理员，它将被启用。如果是管理员，则需要客户代码。但在员工的情况下，客户代码被禁用，无需应用任何规则。

怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T18:51:02.413

我可以想到两种方法，或者是这些方法的组合。两者都需要一些调整以获得完美的结果，但它们都非常好：

1）场景：请注意，我有两个字段/属性： text / dropdown 在您的控制器中：

```
public function actionScenario()
{
    $model=new ScenarioForm;

    // if it is ajax validation request
    if(isset($_POST['ajax']) && $_POST['ajax']==='scenario-form')
    {
        if($_POST['ScenarioForm']['dropdown'] == 'admin')
            $model->scenario = 'admin';

        echo CActiveForm::validate($model);
        Yii::app()->end();
    }

    // collect user input data
    if(isset($_POST['ScenarioForm']))
    {
        $model->attributes=$_POST['ScenarioForm'];

        if($model->dropdown == 'admin')
            $model->scenario = 'admin';

        // validate user input
        $model->validate();
        //do other stuff
    }
    // display the login form
    $this->render('scenario', array('model'=>$model));
} 
```

如您所见，我检查下拉值是否为 admin；如果是这样，我将模型的场景更改为“管理员”。在模型规则中，我有这个：

```
public function rules()
{
        return array(
                array('dropdown', 'required'),
                array('text', 'required', 'on' => 'admin'),
        );
} 
```

你看，只有当场景是管理员时才需要文本。当您现在在下拉列表中有管理员，而您的文本字段中没有任何内容，并提交表单时，您将得到正确的错误。如果您想要即时的 ajax 反馈，当用户更改下拉列表时，您可能希望在您的视图中显示：

```
 <?php echo $form->labelEx($model,'dropdown'); ?>
    <?php echo $form->dropDownList($model,'dropdown', array('admin' => 'Admin', 'staff' => 'Staff!')); ?>
    <?php echo $form->error($model,'dropdown', array('afterValidateAttribute' => 'js:function(form, attribute, data, hasError)
    { 
        mSettings = $.fn.yiiactiveform.getSettings(form);
        $.fn.yiiactiveform.updateInput(mSettings.attributes[1], data, form)
    }')); ?> 
```

下拉错误中的第三个参数是一个数组，其中包含几个html选项，例如使用ajax验证下拉后调用的回调。通常，当您执行 ajax-validation 时，仅更新当前字段（即使您收到所有错误）。所以我们在回调中指定文本字段的错误也应该更新。您现在会看到，当您在下拉列表中选择 admin 时（不是在启动时）会出现错误。

这并不完美，因为您没有得到文本字段所需的*，并且您会立即收到警告。我不确定 Yiiactiveform 是否具有绘制字段装饰的功能，而不是警告。但是您可能可以扩展它来做到这一点，或者在回调中使用自定义 js。如果只需要提交后正常验证，也可以使用自定义的Javascript在文本标签中添加需要的类。目前我不确定 CActiveForm 的属性中是否有一个特殊参数。

2) 自定义验证规则。和一个类似，虽然你不使用场景（但仍然是视图中的js回调）。相反，您为下拉菜单创建自定义验证规则，并将其放入规则数组中。当下拉列表更改时，我们会在文本字段中添加一个错误。

```
public function check_dropdown($attribute,$params){
    if($this->$attribute=="admin"){
        $this->addError('text', 'Please enter Text!');

        $this->clearErrors('text');
    }            
}

public function check_text($attribute,$params){
    if($this->$attribute!=""){
            $this->clearErrors('text');
    }
} 
```

在这里，您不需要在控制器中设置场景。但是您丢失了所需的规则。同样的问题也与缺少的星号有关。

我可能会选择方式 1。如果您不想要一个彻底的警告，您可能必须从 JSON 中读出错误消息，检查它是否是正确的，并将正确的类应用于文本标签回调函数中的自定义 Javascript。

# jquery - jquery - 为什么不：checkbox：checked验证不起作用

> ID：10584859
> 
> 赞同：0
> 
> 时间：2012-05-14T14:02:11.390
> 
> 标签：jquery, validation

我正在为客户开发一个应用程序。需要特殊的验证编码，所以我不能像在其他几个应用程序中那样使用插件。我在验证文本和下拉字段时让这段代码工作，但是当我添加代码来验证复选框时它就坏了。我在这个 jquery 代码中做错了什么？**我的 jsFiddle**：http: [//jsfiddle.net/justmelat/7N7bw/](http://jsfiddle.net/justmelat/7N7bw/)

**完整的jquery代码：>>**

```
$(document).ready(function(){
    $("#btnCatchReqFlds").on('click', function(){
        $("#holdErrMsg").empty();
        var reqButEmpty = $('fieldset:visible').find('input[type="text"][class*="-required"],textarea[class*="-required"],select[class*="-required"]').filter(function() 
            {
                    return $.trim($(this).val()) === "";
            });
        var chkbx_reqButEmpty = $('fieldset:visible').find('input[type="checkbox"][class*="-required"]').filter(function() 
            {
                    return !$(this).is(':checked')
            });
                    var holdAll = reqButEmpty + chkbx_reqButEmpty;
                    if(holdAll.length > 0)
                        {
                            holdAll.each(function() {
                                $('#holdErrMsg').append("Please fill in the " + this.name + "<br />"); 
                            });
                        }
                    return !holdAll.length;
                });
        }); 
```

**上面一直在工作，直到我添加了这个复选框验证：>>**

```
var chkbx_reqButEmpty = $('fieldset:visible').find('input[type="checkbox"][class*="-required"]').filter(function() 
            {
                    return !$(this).is(':checked')
            });
                    var holdAll = reqButEmpty + chkbx_reqButEmpty; 
```

**这是带有新建议的 jquery - 但不起作用>>**

```
$(document).ready(function(){
    $("#btnCatchReqFlds").on('click', function(){
        $("#holdErrMsg").empty();
        var reqButEmpty = $('fieldset:visible').find('input[type="text"][class*="-required"],textarea[class*="-required"],select[class*="-required"]').filter(function() 
            {
                    return $.trim($(this).val()) === "";
            });
        //var chkbx_reqButEmpty = $('fieldset:visible').find('input[type="checkbox"][class*="-required"]').filter(function() 
        var chkbx_reqButEmpty = $('fieldset:visible').find('input:checked[class*="-required"]').filter(function() 
            {
                    console.log(this);
                    //return !$(this).is(':checked')
                    //return !this.checked;
                    return $(this).is(!':checked');
            });
                    //var holdAll = reqButEmpty + chkbx_reqButEmpty;
                    //var holdAll = reqButEmpty.concat(chkbx_reqButEmpty).length;
                    var holdAll = $.extend(reqButEmpty,chkbx_reqButEmpty);
                    if(holdAll.length > 0)
                        {
                            holdAll.each(function() {
                                $('#holdErrMsg').append("Please fill in the " + this.name + "<br />"); 
                            });
                        }
                    return !holdAll.length;
                });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:06:31.470

你`(input:checked)`在你的查找功能中尝试过吗？

```
$('fieldset:visible').find('input:checked[class*="-required"]').filter(function(){}); 
```

编辑 ：

这行不应该：`return !$(this).is(':checked')` 是`return $(this).is(':checked')`

编辑 ：

```
if(!$(this)is(':checked')
    return true/false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:08:32.883

尝试

```
return $(this).is(!':checked') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:14:43.933

你可以试试：

```
var chkbx_reqButEmpty = $('fieldset:visible').find('input[type="checkbox"][class*="-required"]').filter(function() {
      return !this.checked;
});
var holdAll = reqButEmpty.concat(chkbx_reqButEmpty).length; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T14:09:43.840

线路有问题：

```
var holdAll = reqButEmpty + chkbx_reqButEmpty; 
```

通过连接两个 JQuery 对象，您可以得到 type `[Object][Object]`。

请改用此代码：

```
var holdAll = $.extend(reqButEmpty,chkbx_reqButEmpty); 
```

**演示：http:** [//jsfiddle.net/7N7bw/2/](http://jsfiddle.net/7N7bw/2/)

# url - 规范化/规范化 URL？

> ID：10584861
> 
> 赞同：11
> 
> 时间：2012-05-14T14:02:14.387
> 
> 标签：url, python-3.x, normalization

我正在寻找一个库函数来规范化 Python 中的 URL，即删除路径中的“./”或“../”部分，或添加默认端口或转义特殊字符等。结果应该是指向同一网页的两个 URL 唯一的字符串。例如`http://google.com`and`http://google.com:80/a/../`应该返回相同的结果。

我更喜欢 Python 3 并且已经浏览了该`urllib`模块。它提供了拆分 URL 的功能，但没有将它们规范化。Java 有`URI.normalize()`做类似事情的功能（尽管它不认为默认端口 80 等于没有给定端口），但是有没有类似的东西是 python？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:34:01.517

这个怎么样：

```
In [1]: from urllib.parse import urljoin

In [2]: urljoin('http://example.com/a/b/c/../', '.')
Out[2]: 'http://example.com/a/b/' 
```

受到[这个问题](https://stackoverflow.com/questions/2131290/how-can-i-normalize-collapse-paths-or-urls-in-python-in-os-independent-way)的答案的启发。它不会规范化端口，但创建一个功能应该很简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T04:56:52.143

这就是我使用的，到目前为止它一直有效。您可以从 pip 获取 urlnorm。

请注意，我对查询参数进行了排序。我发现这是必不可少的。

```
from urlparse import urlsplit, urlunsplit, parse_qsl
from urllib import urlencode
import urlnorm

def canonizeurl(url):
    split = urlsplit(urlnorm.norm(url))
    path = split[2].split(' ')[0]

    while path.startswith('/..'):
        path = path[3:]

    while path.endswith('%20'):
        path = path[:-3]

    qs = urlencode(sorted(parse_qsl(split.query)))
    return urlunsplit((split.scheme, split.netloc, path, qs, '')) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-11T17:01:04.180

## 旧（已弃用）答案

[*不再维护]* [urltools](https://github.com/erazor85/urltools)模块标准化多个斜杠`.`和`..`组件，而不会弄乱`http://`.

一旦你这样做*（这不再起作用，因为作者重命名了 repo）*，用法如下：~~`pip install urltools`~~

 *```
print urltools.normalize('http://example.com:80/a////b/../c')
>>> 'http://example.com/a/c' 
```

虽然该模块不再是 pip 可安装的，但它是[一个文件](https://github.com/erazor85/urltools/blob/master/urltools/urltools.py)，因此您可以重复使用它的一部分。

## 更新了 Python3 的答案

对于 Python3，请考虑[`urljoin`](https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urljoin)从[`urllib.urlparse`](https://docs.python.org/3/library/urllib.parse.html)模块中使用。

```
from urllib.parse import urljoin

urljoin('https://stackoverflow.com/questions/10584861/', '../dinsdale')
# Out[17]: 'https://stackoverflow.com/questions/dinsdale' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-24T08:55:24.800

现在有一个专门解决这个问题的库[url-normalize](https://pypi.org/project/url-normalize)

它不仅仅按照文档规范化路径：

> URI 标准化功能：
> 
> 1.  照顾 IDN 域。
> 2.  始终以小写字符提供 URI 方案。
> 3.  始终以小写字符提供主机（如果有）。
> 4.  仅在必要时执行百分比编码。
> 5.  百分比编码时始终使用大写的 A 到 F 字符。
> 6.  防止点段出现在非相对 URI 路径中。
> 7.  对于定义默认权限的方案，如果需要默认权限，请使用空权限。
> 8.  对于将空路径定义为等效于“/”路径的方案，请使用“/”。
> 9.  对于定义端口的方案，如果需要默认端口，请使用空端口
> 10.  URI 的所有部分必须是来自 Unicode 字符串的 utf-8 编码 NFC

这是一个例子：

```
from url_normalize import url_normalize

url = 'http://google.com:80/a/../'
print(url_normalize(url)) 
```

这使：

```
http://google.com/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T13:29:26.447

在[良好的开端](https://stackoverflow.com/a/10587428/1018226)之后，我编写了一个适合大多数网络常见案例的方法。

```
def urlnorm(base, link=''):
  '''Normalizes an URL or a link relative to a base url. URLs that point to the same resource will return the same string.'''
  new = urlparse(urljoin(base, url).lower())
  return urlunsplit((
    new.scheme,
    (new.port == None) and (new.hostname + ":80") or new.netloc,
    new.path,
    new.query,
    '')) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-08T10:33:05.273

我在上面使用了@Antony 的答案并使用了[url-normalize](https://pypi.org/project/url-normalize)库，但它有一个当前未修复的错误：当在没有方案的情况下发送 URL 时，不小心将其设置为 HTTPS。我编写了一个函数，通过将其设置为 HTTP 来包装和修复它：

```
from url_normalize import url_normalize
from urllib.parse import urlparse

def parse_url(url):
    return_val = url_normalize(url)
    wrong_default_prefix = "https://"
    new_default_prefix = "http://"
    # If the URL came with no scheme and the normalize function mistakenly 
    # set it to the HTTPS protocol, then fix it and set it to HTTP
    if urlparse(url).scheme.strip() == '' and return_val.startswith(wrong_default_prefix):
        return_val = new_default_prefix + return_val[len(wrong_default_prefix):]
    return return_val 
```*

# visual-studio - Webshaper 和 VS 2010 外壳

> ID：10584863
> 
> 赞同：1
> 
> 时间：2012-05-14T14:02:15.570
> 
> 标签：visual-studio, websharper

有谁知道如何将 Websharper 与 VS shell 一起使用？我了解 Websharper 开发人员认识到这一点并打算将其添加到未来的版本中？： [https ://bitbucket.org/IntelliFactory/websharper/issue/35/support-installing-with-vs-shell-only](https://bitbucket.org/IntelliFactory/websharper/issue/35/support-installing-with-vs-shell-only)

同时： [https ://bitbucket.org/Mickeysg/websharper/src/1aa9056f55f9/README.markdown](https://bitbucket.org/Mickeysg/websharper/src/1aa9056f55f9/README.markdown)

是否仍然可以仅通过 shell 安装和使用 Websharper？如果是这样，目前有什么缺点吗？

> 如果您只安装了免费的 VS shell 和 F# 编译器，则需要添加 `C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319`到 PATH。

```
 PATH=%PATH%;C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319
    msbuild /p:Configuration=Release 
```

`msbuild`没有选项将为平台 AnyCPU 构建调试配置。

如果我正确地阅读了上面的报价？如果有人可以给我一个“白痴”指南来完成这个吗？

TIA，伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T14:14:17.423

讨论已转移到 FPish：[http ://fpish.net/topic/Some/0/75413](http://fpish.net/topic/Some/0/75413)

# php - 从 php 源文件自动完成重新查询源页面而不是调用 PHP 源文件

> ID：10584866
> 
> 赞同：0
> 
> 时间：2012-05-14T14:02:21.393
> 
> 标签：php, jquery

我正在尝试将 JQuery Autocomplete 与 PHP 源文件一起使用，但是当我使用 FIREBUG 检查时，我看到输入字段的更改，页面只是重新查询本身而不是调用我的源 PHP 文件

代码段

```
$().ready(function() {
    $("#item_name").autocomplete("./utilities.php?op=autocomplete", {
        width: 260,
        matchContains: true,
        //mustMatch: true,
        minChars: 2,
        //multiple: true,
        //highlight: false,
        //multipleSeparator: ",",
        selectFirst: false
    });
}); 
```

PHP 源文件

```
if($op=='autocomplete'){
        $dataset = array();
        $item_name = $_REQUEST['item_name'];
        if (!$item_name) return;
        $sql = "select select concat(item_id,' - ',item_name) item from payment_items where item_name like '%$item_name%'";
            //echo $sql;
            $result = mysql_query($sql);
            if($result){
            for($i=0; $i<$numrows; $i++){
            $row = mysql_fetch_array($result);
            echo $row['item'];
            }
            }

    } 
```

实用程序文件是一个实用程序页面，因此需要定义一个 $op 参数来确定我想要实现的目标。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:46:59.403

```
$("#item_name").autocomplete("/utilities.php?op=autocomplete", 
{
  width: 260,
    matchContains: true,
    //mustMatch: true,
    minChars: 2,
    //multiple: true,
    //highlight: false,
    //multipleSeparator: ",",
    selectFirst: false
}).result(function(event, data, formatted) {
// your built function call
  myDefinedFunction(data);

 // update with another result
 $(this).val('your value'); 
```

})

如文档：[http ://docs.jquery.com/Plugins/Autocomplete/result#handler](http://docs.jquery.com/Plugins/Autocomplete/result#handler)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:26:58.587

尝试删除“。”

```
$("#item_name").autocomplete("/utilities.php?op=autocomplete", { 
```

那么它应该请求 PHP 页面而不是它本身。

# c# - WPF 控件名称带有 . 在里面。

> ID：10584867
> 
> 赞同：0
> 
> 时间：2012-05-14T14:02:31.967
> 
> 标签：c#, wpf

我有一个 wpf 控件，我想将名称设置为包含 . 当试图这样做时，我得到一个异常抛出：

```
{"'Communications.WCF.URL' is not a valid value for property 'Name'."} 
```

我假设这是因为 . 在名字里。

我看不到任何其他可用于存储 Communications.WCF.URL 值的属性，但我认为是 id check。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T14:05:22.073

A`Control`的名称不能包含您发现的句点。您可以用下划线替换句点。或者您可以使用该`Tag`属性来存储 URL。`Tag`用于存储无关信息的属性并不罕见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:07:36.630

如果这是您要命名控件的方式，则需要将命名空间更改为 Communications.WCF，其中 URL 是您的控件名称（如果我理解正确的话）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T14:07:58.500

控件的名称也是在代码中表示该控件的对象的名称。这就是为什么`.`（句点）不是控件名称的有效字符的原因。

`Name`您是否可能与`Caption`属性混淆控制？

# javascript - 如何像 cookie 中的下拉列表一样序列化 jquery 对象

> ID：10584870
> 
> 赞同：0
> 
> 时间：2012-05-14T14:02:41.157
> 
> 标签：javascript, jquery, dom

我有一些带有下拉列表的表单数据。我想保存下拉列表，包括 cookie 中的所有选项。JSON stringify 返回错误：将循环结构转换为 JSON。当然，我可以遍历所有选择选项并在 cookie 中创建类似 CSV 的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:08:23.730

如果你想序列化一个 DOM 对象，选择的格式是 XML。如果你想序列化一个选项值的数组，你需要提取它们——你不能对一个 jQuery 对象进行 JSON 编码。

# python - 计算任意嵌套列表列表中的所有元素，无需递归

> ID：10584873
> 
> 赞同：14
> 
> 时间：2012-05-14T14:02:51.270
> 
> 标签：python, recursion, iteration

我刚刚了解了 Python 中的递归并完成了作业，其中一项是计算任意嵌套列表列表中的所有元素。我搜索了这个网站，发现的答案似乎都使​​用了递归调用。既然已经教导任何可以递归表达的东西都可以迭代表达，并且迭代在 Python 中是首选的，那么在 Python 2.6 中没有递归或导入模块（作为学习练习）如何实现呢？（嵌套列表本身将被视为一个元素，其内容也是如此。）例如：

```
>>> def element_count(p):
...     count = 0
...     for entry in p:
...         count += 1
...         if isinstance(entry, list):            
...             count += element_count(entry)
...     return count
>>> print element_count([1, [], 3]) 
3 
>>> print element_count([1, [1, 2, [3, 4]]])
7
>>> print element_count([[[[[[[[1, 2, 3]]]]]]]])
10 
```

这将如何使用迭代编写？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-14T14:07:03.403

这是一种方法：

```
def element_count(p):
  q = p[:]
  count = 0
  while q:
    entry = q.pop()
    if isinstance(entry, list):
      q += entry
    count += 1
  return count

print element_count([1, [], 3]) 
print element_count([1, [1, 2, [3, 4]]])
print element_count([[[[[[[[1, 2, 3]]]]]]]]) 
```

该代码维护了一系列要查看的内容。每当循环遇到子列表时，它将其内容添加到队列中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-14T14:12:13.823

通常每个递归问题都可以通过使用堆栈以某种方式转换为迭代，在本例中为`list`：

```
def element_count(p):
    elements = list(p)
    count = 0
    while elements:
        entry = elements.pop()
        count += 1
        if isinstance(entry, list):
            elements.extend(entry)
    return count 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T14:48:42.453

您可能会发现这个版本`element_count`比其他版本更强大。它可以处理所有支持迭代的容器，并将递归容器正确识别为具有无限数量的元素。

```
>>> def element_count(p):
    stack, pointers, count = [iter(p)], set([id(p)]), 0
    while stack:
        for item in stack.pop():
            try:
                iterator = iter(item)
            except TypeError:
                pass
            else:
                location = id(item)
                if location in pointers:
                    return float('inf')
                stack.append(iterator)
                pointers.add(location)
            count += 1
    return count

>>> element_count([1, [], 3])
3
>>> element_count([1, [1, 2, [3, 4]]])
7
>>> element_count([[[[[[[[1, 2, 3]]]]]]]])
10
>>> p = [1, 2, 3]
>>> element_count(p)
3
>>> p.append({4, 5, 6})
>>> element_count(p)
7
>>> p.append(p)
>>> element_count(p)
inf
>>> 
```

# azure - 在多个区域运行 Azure 角色？

> ID：10584875
> 
> 赞同：8
> 
> 时间：2012-05-14T14:03:02.263
> 
> 标签：azure

我目前在西欧有一个生产部署，并想创建另一个在美国运行的实例。

这怎么可能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T14:08:05.787

这在实例级别是不可能的。[但是您可以使用流量管理器](http://azure.microsoft.com/en-us/services/traffic-manager/)在托管服务级别拥有地理分布的应用程序。这意味着您的西欧部署需要托管服务，美国部署需要托管服务。

此博客文章解释了如何使其工作：[http ://www.hanselman.com/blog/CloudPowerHowToScaleAzureWebsitesGloballyWithTrafficManager.aspx](http://www.hanselman.com/blog/CloudPowerHowToScaleAzureWebsitesGloballyWithTrafficManager.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:09:32.497

您需要在要部署到的美国数据中心/区域中创建新的托管服务。然后将您的服务部署到该新的托管服务。您可以使用[Windows Azure 流量管理器](http://msdn.microsoft.com/library/windowsazure/hh745750.aspx)将用户引导到离他们最近的部署（可以建立的三个策略之一 - 性能、循环和/或故障转移）

# ruby - 捆绑安装时 ruby 版本的问题

> ID：10584876
> 
> 赞同：2
> 
> 时间：2012-05-14T14:03:04.183
> 
> 标签：ruby

如果我给 Bundle install 我得到

```
Gem::InstallError: factory_girl requires Ruby version >= 1.9.2. 
```

但是如果我做 ruby​​ -v 我得到

```
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.2.0] 
```

所以问题应该出在使用以前版本的rails或bundle中，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:12:42.817

您正在使用 rbenv 吗？

~/.bash_profile 文件需要修改：

```
export PATH="$HOME/.rbenv/bin:$PATH"
eval "$(rbenv init -)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T10:41:35.480

我解决了从源代码重新安装Ruby并编译！

# php - json_decode 中的 PHP 额外字符

> ID：10584878
> 
> 赞同：1
> 
> 时间：2012-05-14T14:03:09.070
> 
> 标签：php, api, json, last.fm

last.fm API 返回一个 JSON 字符串，我使用它转换为数组

```
json_decode($response, ($returnType == 'array')); 
```

当响应被转储时，它给了我以下 json 字符串：

```
{"session":{"name":"turncoat9","key":"b311abDee2d34e07541eeeefted2bad","subscriber":"0"}} 1 
```

（注意最后的1）

由于这个额外的字符，json 字符串无法转换为关联数组，因此是我的问题。

我发现一些讨论指出 1 是 BOM（字节顺序掩码）字符，但提供的所有解决方案都不适用于我的 json 字符串。

这个角色是什么？为什么它在那里，为什么当我在本地开发时不会发生这种情况？解决方案是什么？

在两个不同的网络服务器上试过这个，给出了相同的结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:05:34.367

您可以使用修剪将其删除：

```
$cleaned_json = trim($received_json, '1 '); 
```

[手动的](http://us3.php.net/manual/en/function.trim.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:27:31.197

首先，我不明白`($returnType == 'array')`，你应该只放在`TRUE`那里

`assoc`->`When TRUE, returned objects will be converted into associative arrays.`

其次，您从 API 中得到什么答案？你确定它只返回json字符串吗？

# windows - Windows 的 CVDisplayLink 替代品？

> ID：10584882
> 
> 赞同：7
> 
> 时间：2012-05-14T14:03:22.937
> 
> 标签：windows, macos, opengl, animation, vsync

在 Mac OS X 上，[CVDisplayLink](http://developer.apple.com/library/mac/#documentation/QuartzCore/Reference/CVDisplayLinkRef/Reference/reference.html)提供了一种可靠地更新屏幕以实现 60 fps 动画而不会撕裂的好方法。Windows上是否有类似的界面，兼容OpenGL？

在等待垂直同步时当然可以阻塞，但这不适用于需要同时动画的多个窗口。在 Windows 上，它们都将相互等待（因此两个等待垂直同步的窗口将下降到 30 fps），这与 OS X 不同。

例如，视频播放器如何实现平滑的屏幕更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T18:36:45.320

Windows 的典型架构与 Mac 不同，因为您可以控制主循环而不是操作系统库 - 不需要 CVDisplayLink 等价物（当然，如果 API 更好，您不需要了解太多具体信息为达到这个）。

如果您使用的是无限旋转的循环，那么在循环结束时等待 vsync 就可以了。如果您有多个窗口，您需要相应地安排您的渲染，以便您的“主更新循环”在所有渲染提交后等待 vsync 结束。

通常我有这样的事情：

```
while(!toldToQuit)
{
    Render();
    Update();

    WaitForVsync();
} 
```

这允许 CPU 更新工作（下一帧）与 GPU 渲染工作一起发生......

如果驱动程序将此作为其默认行为，SwapBuffers( HDC ) 将等待 vsync，否则有一个用于设置 vsync 的 wgl 扩展 - wglSwapIntervalEXT( int )：

[http://www.opengl.org/registry/specs/EXT/wgl_swap_control.txt](http://www.opengl.org/registry/specs/EXT/wgl_swap_control.txt)

我一直实现“非垂直同步”的方式是通过渲染单个缓冲而不调用 SwapBuffers ......因为 wglSwapIntervalEXT( 0 ) 在我测试过的任何硬件上都没有实现这一点。

# azure - 将数据库迁移到云端

> ID：10584883
> 
> 赞同：2
> 
> 时间：2012-05-14T14:03:26.320
> 
> 标签：azure, cloud, azure-sql-database

我有一个使用本地数据库的 PC 应用程序 (FoxPro)。我想将它迁移到云数据库，但保持应用程序完好无损。我能否在 Windows XP/7 中配置 ODBC 数据源以指向云数据库服务，例如 SQL Azure、xeround.com、database.com 或其他？你有什么想分享的经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:52:21.177

每当我讨论将客户端服务器应用程序迁移到云端时，我总是会讨论将整个应用程序 + 数据库迁移到云端。如果您将其中一个（应用程序或数据库）移动到云端，即使您的应用程序在地理位置上非常接近，您仍然会遇到网络延迟，并且您需要调整您的本地防火墙设置以让其他应用程序获取进入。在大多数情况下，需要将客户端/服务器应用程序转换为具有云就绪的 Web 前端，我认为以下文章有助于理解全局：http: [//www.visualwebgui.com/Technology/WhitePapers /tabid/528/articleType/ArticleView/articleId/919/Transformation-of-ClientServer-application-to-Windows-Azure-Cloud.aspx](http://www.visualwebgui.com/Technology/WhitePapers/tabid/528/articleType/ArticleView/articleId/919/Transformation-of-ClientServer-application-to-Windows-Azure-Cloud.aspx)

关于直接回答您的问题，如果您想使用 SQL Azure，最好了解将数据库迁移到云的限制，因为并非大多数云数据库都提供 loca 数据库中的所有功能：http: [//msdn.microsoft。 com/en-us/library/windowsazure/ee336245.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee336245.aspx)

还要确保知道您将使用 SQL Azure 数据库获得什么：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee621784.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee621784.aspx)

最后，您确定可以使用 ODBC 数据库连接器与 SQL azure 对话，如果您使用的是 ODBC，那么您需要使用 .NET Framework Data Provider for ODBC，如下所述： [https ://www.windowsazure.com/en-us/开发/网络/how-to-guides/sql-azure/#using-ODBC](https://www.windowsazure.com/en-us/develop/net/how-to-guides/sql-azure/#using-ODBC)

希望这对您和任何其他希望将其客户端/服务器应用程序迁移到云的人有所帮助。顺便说一句，这是一个很好的问题，我 +1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:15:59.553

SQL Azure 支持 ODBC 数据源，但最好使用 SQL Server 2008 R2 Native Client ODBC 驱动程序。MSDN 上的**一般准则和限制（SQL Azure 数据库）**一文在工具和技术支持标题下包含有关 ODBC 支持的更多信息。

参考：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee336245.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee336245.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-19T09:02:28.750

我同意 Avakash 的观点，即我们应该将整个应用程序 + 数据库迁移到云端，除非有一些法定或安全需要在本地托管数据库。

几年以来我一直在使用 Cloud，我发现有一些虚拟化服务，例如 Ravello，它提供了将现有基础设施迁移到在 Google/Amazon 之上运行的 Ravello 云的选项。

我发现的优势是 Ravello 允许将完整的 VM 从您的 DC 迁移到云，而无需对网络或其他配置进行任何更改。Ravello 提供嵌套虚拟化即服务来简化此操作。这意味着您的 vmdk 将按原样在 EC2 之上运行，从而保持您的 VMware 工具、操作系统补丁级别等完好无损。通过这种方式，您可以非常轻松地将您的数据库、应用程序所有内容迁移到云端。

您可以在[http://www.ravellosystems.com/blog/esxi-vm-to-ec2-vmware-tools/参考此用例](http://www.ravellosystems.com/blog/esxi-vm-to-ec2-vmware-tools/)

# actionscript-3 - actionscript 3键释放停止声音

> ID：10584889
> 
> 赞同：1
> 
> 时间：2012-05-14T14:03:51.530
> 
> 标签：actionscript-3, flash, audio, keypress

嗨，我对 actionscript 真的很陌生，我在播放声音时遇到了问题。当我松开向上键时，我希望我的声音停止播放。我设法让声音在按键时播放。

这是我的代码...

```
import flash.events.KeyboardEvent;

var mySound:Sound = new carstart();

stage.addEventListener(KeyboardEvent.KEY_DOWN, playSound);
stage.addEventListener(KeyboardEvent.KEY_UP, stopSound);

function playSound(keyEvent:KeyboardEvent) {
    if (keyEvent.keyCode == 38) {
        mySound.play();
    }
}

function stopSound(keyEvent:KeyboardEvent) {
    if (keyEvent.keyCode == 38) {
     mySound.stop();
    }
} 
```

我得到这个错误

```
Scene 1, Layer 'Actions', Frame 1, Line 29  1061: Call to a possibly undefined method stop through a reference with static type flash.media:Sound. 
```

如果您能想到任何事情，那将是一个很大的帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:09:18.270

```
import flash.events.KeyboardEvent;

var mySound:Sound = new carstart();
var myChannel:SoundChannel = new SoundChannel();

myChannel = mySound.play();

function playSound(keyEvent:KeyboardEvent) {
    if (keyEvent.keyCode == 38) {
        mySound.play();
    }
}

function stopSound(keyEvent:KeyboardEvent) {
    if (keyEvent.keyCode == 38) {
     myChannel.stop();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:09:42.140

您需要将您的`Sound`对象包装成一个`SoundChannel`... 按照[这个](http://www.dreamincode.net/code/snippet2563.htm)示例，您将立即设置！

# pointers - Ada 任务：任务条目中的指针

> ID：10584890
> 
> 赞同：4
> 
> 时间：2012-05-14T14:03:53.027
> 
> 标签：pointers, task, ada

我想在 Ada 中创建一个包含一些任务条目的任务类型（例如称为“计算机”的任务类型）。我想创建一个输入参数类型为“访问所有计算机”的任务条目，即指向任务类型的指针。这是可能吗？

我试图做这样的事情：

```
task type computer;
type computer_ptr is access all computer;    
task type computer is
  entry init(a: computer_ptr);
end computer; 
```

这是[在这里](https://stackoverflow.com/questions/1655525/is-there-a-this-keyword-in-ada)提出的。不幸的是，这不起作用：GNAT 说“计算机”的声明冲突。

谁能想到一种方法来实现我想做的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:09:46.257

通过使用`task type computer;`，您声明了一台完全没有条目的任务类型计算机。之后，您声明另一个具有相同名称的任务类型。

如果您想“前向声明”任务类型（根据访问类型的需要），您应该`type computer;`像任何其他类型一样编写。这是一个不完整的类型，可以通过任务类型声明来完成。

所以你的例子应该是这样的：

```
type computer;
type computer_ptr is access all computer;
task type computer is
   entry init (a: computer_ptr);
end computer; 
```

# php - Foreach 循环嵌套不起作用

> ID：10584891
> 
> 赞同：1
> 
> 时间：2012-05-14T14:03:54.547
> 
> 标签：php, html, foreach, nested

所以我正在处理一个表单，我正在使用 PHP 从数据库中提取一组联系人。由于结果是一个数组，我正在使用一个 foreach 循环来回显联系人并继续前进。这是我的代码：

```
 <p class='contact-list'>
      <?php

        foreach( $contacts as $contact ){
            echo "<p><input type='radio' name='contact' id='contact-{$contact['id']}' value='{$contact['id']}'/>";
            echo " {$contact['name']}</p>";
        }

      ?>
    </p> 
```

我这样做是因为我希望将每个联系人作为 .contact-list 的子项放置，并且当页面呈现时，源看起来应该是：

```
<p class='contact-list'>
    <p><input type='radio' ...
    </p>
    <p><input type='radio' ...
    </p>
</p> 
```

事实并非如此。每个联系人不是 .contact-list 的孩子，而是它的兄弟，我想知道为什么会这样。

页面渲染后的来源是这样的：

```
<p class='contact-list'></p>
<p><input type='radio' name=''...
</p>
<p><input type='radio' name=''...
</p> 
```

谁能解释为什么段落标签在 foreach 循环运行之前关闭？

**更新：**

我决定使用 div 而不是段落，然后嵌套工作正常，所以我假设这是段落标签的一个特征。也就是说，我仍然有兴趣找出*为什么*段落标签会这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:08:18.537

因为`p`是一个只能包含内联元素的块元素。但是您将其他`p`元素放入其中。改用s 这应该可以按您的预期`span`工作`p`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:09:37.080

你试过这个吗？

```
foreach( $contacts as $contact ){
        echo "<span><input type='radio' name='contact' id='contact-{$contact['id']}' value='{$contact['id']}'/>{$contact['name']} </span>";
    } 
```

# visual-c++ - std::wstring 导致内存访问冲突（0xC0000005：访问冲突）

> ID：10584892
> 
> 赞同：0
> 
> 时间：2012-05-14T14:04:01.470
> 
> 标签：visual-c++, memory, activex, named-pipes

我们的应用程序浏览命名管道列表并查找由我们的应用程序创建的命名管道。

如果我们的命名管道不存在，我们继续创建一个。然而，最近我们的客户报告说

应用程序崩溃在线：

```
fileName = std::wstring(TmpInfo->FileName); 
```

您可以查看下面随附的 windbg 故障转储报告。崩溃是零星的，并非始终可重现。你能帮我找出问题吗？转换`TmpInfo->FileName`成`wstring`. 请注意，该组件是一个 ActiveX 控件。我们的 ActiveX 正在使其他应用程序崩溃。

以下代码负责枚举命名管道。

```
typedef struct {
        ULONG                   NextEntryOffset;
        ULONG                   FileIndex;
        ULONG                   FileNameLength;
        WCHAR                   FileName[1];    
    } FILE_NAMES_INFORMATION, *PFILE_NAMES_INFORMATION;

inline void EnumerateRunningPipes(std::vector<std::wstring>& pipeNames, std::wstring stringLookup,      

                                     bool useStringLookup, bool 

truncatePipeDirPrefix)
    {
        LONG ntStatus;   
        IO_STATUS_BLOCK IoStatus;       
        BOOL bReset = TRUE;       
        PFILE_NAMES_INFORMATION fileNameInfo, TmpInfo;              

        fileNameInfo = (PFILE_NAMES_INFORMATION) new BYTE[1024];

        HANDLE hPipe = CreateFile("//./pipe/", 
            GENERIC_READ,
            FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE,
            NULL,
            OPEN_EXISTING,
            0,
            NULL);

        if(hPipe == INVALID_HANDLE_VALUE)
            throw CEnumeratePipeException("Could not get handle to root directory for pipes.",
            CEnumeratePipeException::ErrorType::CREATE_FILE, GetLastError());       

        USES_CONVERSION;

        locale loc;
        mbstate_t state = {0};

        while(true)
        {
            memset(fileNameInfo, 0, 1024);
            ntStatus = NtQueryDirectoryFile( hPipe, NULL, NULL, NULL, &IoStatus, fileNameInfo, 

1024,
                FileNameInformation, FALSE, NULL, bReset );

            if (ntStatus!=NO_ERROR)   
            {   
                if (ntStatus == STATUS_NO_MORE_FILES)                       

                    break;              

                std::stringstream sstream;      
                sstream << "NtQueryDirectoryFile error " << ntStatus;

                logger->writeLog(sstream.str()); 
                throw CEnumeratePipeException(
                    "NtQueryDirectoryFile could not get information about the directory or 

file.", 
                    CEnumeratePipeException::ErrorType::QUERY_DIR, ntStatus);
            }   

            TmpInfo = fileNameInfo;                         

            while(true)   
            {           
                const int endStringAt = TmpInfo->FileNameLength / sizeof(WCHAR);        

                std::wstring fileName;

                try
                {                                       
                    fileName = std::wstring(TmpInfo->FileName);//The access violation 

occurs at this line of code.
                    fileName = fileName.substr(0, endStringAt);
                }
                catch (...)
                {
                    logger->writeLog("Caught unknown exception.");

                    if (TmpInfo->FileName == NULL)
                    {
                        logger->writeLog("TmpInfo->FileName = NULL");           

                    }                   
                }

                if (useStringLookup)
                {               
                    if (fileName.find(stringLookup) != std::wstring::npos)
                    {       
                        if (!truncatePipeDirPrefix)
                            fileName.insert(0, L"\\\\.\\pipe\\");
                        pipeNames.push_back(fileName);  
                    }   
                }
                else
                {
                    pipeNames.push_back(fileName);
                }

                if(TmpInfo->NextEntryOffset==0)
                    break;   

                TmpInfo = (PFILE_NAMES_INFORMATION)((DWORD)TmpInfo+TmpInfo->NextEntryOffset);
            }   

            bReset = FALSE;
        }   

        delete fileNameInfo;
    } 
```

以下是故障转储报告的一部分：

```
FAULTING_IP：
msvcr100!memcpy+57 [f:\dd\vctools\crt_bld\SELF_X86\crt\src\INTEL\memcpy.asm @ 185]
78aa1ed7 f3a5 rep movs dword ptr es:[edi],dword ptr [esi]

EXCEPTION_RECORD: ffffffff -- (.exr 0xffffffffffffffff)
异常地址：78aa1ed7 (msvcr100!memcpy+0x00000057)
异常代码：c0000005（访问冲突）
异常标志：00000000
数量参数：2
参数[0]：00000000
参数[1]：0d6b8000
尝试从地址 0d6b8000 读取

SYMBOL_STACK_INDEX：0

SYMBOL_NAME: msvcr100!memcpy+57

FOLLOWUP_NAME：机器所有者

模块名称：msvcr100

IMAGE_NAME：msvcr100.dll

DEBUG_FLR_IMAGE_TIMESTAMP：4ba1dbbe

FAILURE_BUCKET_ID：STRING_DEREFERENCE_c0000005_msvcr100.dll!memcpy

桶 ID：

APPLICATION_FAULT_STRING_DEREFERENCE_CODE_ADDRESS_MISMATCH_INVALID_POINTER_READ_WRONG_SYMBOLS_msvcr100!memcpy

+57

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:22:14.000

我在文档中没有看到任何[`FILE_NAMES_INFORMATION`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540329%28v=vs.85%29.aspx)说明该`FileName`成员以空值终止的内容。并且该`FileNameLength`成员的存在表明它不是空终止的。

所以看起来很可能

```
fileName = std::wstring(TmpInfo->FileName); 
```

正在读取`TmpInfo`缓冲区的末尾，直到遇到两个连续的空字节。如果在到达不可读的虚拟内存区域之前没有遇到空字节，您将遇到访问冲突。

我建议替换这两行代码：

```
fileName = std::wstring(TmpInfo->FileName);
fileName = fileName.substr(0, endStringAt); 
```

有了这个：

```
fileName = std::wstring(TmpInfo->FileName, TmpInfo->FileNameLength); 
```

该构造函数只会`FileNameLength`从缓冲区中读取字符，因此它不应该崩溃。而且效率更高！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:20:37.770

TmpInfo 和 TmpInfo->FileName 是如何定义的？TmpInfo->FileName 崩溃时是否有示例值？

我的猜测是，在某些情况下它不会被 null 终止，导致`std::wstring`' 构造函数读取到不属于它的内存中。

# c++ - 基于 C++ 中另一个数组的成员对数组进行排序

> ID：10584894
> 
> 赞同：9
> 
> 时间：2012-05-14T14:04:12.873
> 
> 标签：c++, arrays, sorting, qsort

我的问题是下一个（是一个显示问题的简单示例）：

我有：

```
int* array1;
double* array2\. 

array1=new int[10];
array2=new double[10];
array1=filledWithIntegers(random);
array2=filledWithDoubles(random); 
```

//这里我想根据array2的值对array1进行排序。我正在尝试使用 stdlib 的 qsort 函数。qsort（array1,6，sizeof（int），比较）；

重点是如何在array2的基础上对array1进行排序的比较函数。

不能使用 std 库数据结构，必须直接在数组指针中完成。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T14:06:38.633

不是对 的整数进行`array1`排序，而是使用比较项目对它们的索引进行排序`array2[index]`，然后`array1`根据从排序中得到的排列重新排列。

这是一个[快速演示](http://ideone.com/BEKEy)：

```
#include <stdio.h>
#include <stdlib.h>

int array1[] = {1, 7, 3, 9, 5};
double array2[] = {1.1, 7.7, 3.3, 9.9, 5.5};

int compare (const void * a, const void * b) {
    double diff = array2[*(int*)a] - array2[*(int*)b];
    return  (0 < diff) - (diff < 0);
}

int main(void) {
    int perm[5], i;
    int res[5];
    for (i = 0 ; i != 5 ; i++) {
        perm[i] = i;
    }
    qsort (perm, 5, sizeof(int), compare);
    for (i = 0 ; i != 5 ; i++) {
        res[i] = array1[perm[i]];
    }
    for (i = 0 ; i != 5 ; i++) {
        printf("%d\n", res[i]);
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T14:05:47.867

是的。您需要将两个数组组合成一对数组，然后定义比较函数。

比较函数可以是：

```
bool compare(const pair<int,double>& t1, const pair<int,double>& t2){
    return (t1.second < t2.second);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T14:27:49.070

好吧，您只需要使用元素的位置来索引比较函数中的另一个数组（标准保证比较函数的指针参数始终指向要排序的数组）：

```
int compare(const void *a, const void *b)
{
    unsigned int i = (const int*)a - array1;
    unsigned int j = (const int*)b - array1;
    if(array2[i] < array2[j])
        return -1;
    if(array2[i] > array2[j])
        return 1;
    return 0;
} 
```

缺点是，比较函数明确需要知道具体的数组，因为它不能接受任何额外的参数。

无论如何，我都会质疑使用`qsort`，因为您的问题被标记为 C++。虽然`std::sort`有同样的问题，但您可以通过使用封装依赖数组的比较函子来获得更多的通用性/抽象性。

# clickonce - 对于内部 Winform 应用程序，为什么不使用文件共享来部署代码而不是 clickonce？

> ID：10584897
> 
> 赞同：0
> 
> 时间：2012-05-14T14:04:15.757
> 
> 标签：clickonce

**背景**

*   我们正在将 .NET 1.1 winforms 应用程序迁移到 .NET 4.0。（是时候了！:-)）

*   该应用程序仅由我的组织内部使用。

*   .NET 1.1 应用程序使用已弃用的无接触部署技术部署给我们的用户。我们有一个内部 iis 6 网站，用户在其中输入应用程序 .exe 的 url 并运行应用程序（在 IEExec 内）。

*   我们至少每两周更新一次应用程序。

*   我们只是想在每个人的设备上都有一个快捷方式来运行应用程序 exe。我们不需要安装程序组或任何其他花哨的安装机制。

*   我没有使用 clickonce 技术部署应用程序的经验。

*   该应用程序当然包含一个 .exe 和 10 个支持 dll。它使用 Web 服务（目前）来执行 CRUD 操作。

**问题**

*   像我这样的应用程序甚至需要 clickonce 吗？

*   为什么不直接将 exe 和支持 dll 部署到网络共享并让用户从共享运行应用程序？

**我的想法**

*   从我一直在做的研究来看，clickonce 听起来很有趣，但我不知道为什么它会适用于我的情况。任何新技术都会带来一些痛苦，请查看 SO 关于 clickonce 的所有问题。

*   我想集中精力将我的应用程序转换为 .NET 4.0，而不是尝试学习和测试 clickonce 部署策略。

*   我倾向于将文件放在网络共享上并设置适当的权限（文件和.NET）并称之为好。

感谢您的输入！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:39:18.970

您的用户绝对可以从网络共享运行应用程序，但您可能会遇到性能问题，具体取决于网络的稳健性。

您的部署听起来很基础，因此设置 ClickOnce 部署并不困难。我们已经为我们的应用程序和 Office 加载项使用 ClickOnce 部署 5 年了，并且没有遇到任何问题。如果您不需要做一些困难的事情，比如拥有管理权限，它可能对您非常有效。

您可以查看[ClickOnce 概述](http://msdn.microsoft.com/en-us/library/142dbbz4%28VS.90%29.aspx)或[如何发布 ClickOnce 应用程序](http://msdn.microsoft.com/en-us/library/31kztyey.aspx)以获取更多信息。

# ruby-on-rails - 如何从 AR::Relation 中删除条件？

> ID：10584902
> 
> 赞同：2
> 
> 时间：2012-05-14T14:04:31.330
> 
> 标签：ruby-on-rails, activerecord, arel

我想使用 default_scope 并从中删除所有订单条件。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:35:18.357

使用[`reorder`方法](http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-reorder)。

```
User.reorder('id DESC') 
```

# css - 具有溢出大小的 DIV - 占用最大可用空间

> ID：10584904
> 
> 赞同：0
> 
> 时间：2012-05-14T14:04:34.077
> 
> 标签：css, html

我有这样的文件：

```
<html>
<head>
<style>
div.result {
height: 500px;
overflow: auto;
width: 900px;
}
</style>
<div class="options"></div>
<div class="result">
<table>
<!--here I have large table-->
</table>
</div> 
```

这给了我一个带有滚动条的固定大小的框。我希望我的结果框在浏览器中占据剩余的可用大小并且仍然有滚动条（如果有必要）

这样我的选项 div 将保持在顶部，下面将是另一个具有 100% 宽度和剩余浏览器高度高度的 div。

是否可以？

这是我想要得到的结果： ![在此处输入图像描述](../Images/ca1f41ea8b0a2c957f0547dc82dcab4a.png) 所以当我调整浏览器滚动条的大小时，滚动条将位于右侧和底部，类似于 iframe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:12:50.090

您可以为选项和结果元素设置绝对大小和位置：

```
div.options {
    width: 100%;
    height: 300px; // Set height of the options box
    padding: 0;
}

div.result {
    position: absolute;
    top: 300px; // Same as options box
    left: 0;
    right: 0;
    bottom: 0;
    overflow: scroll; // Could be auto too
} 
```

这应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:09:12.327

是的，这是可能的！

尝试位置：绝对填充到所有方面

```
 div.result {
    position: absolute;
    bottom: 0px;
    right: 0px;
    left: 0px;
    overflow: auto;
  } 
```

或保持宽度独立于边距和填充的边界框解决方案（因此我们可以在 width:100% 仍然正确应用时使用边距）

```
 div.result {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    height: 100%;
    width: 100%;
    overflow: auto;
    margin-top: 100px; /* Or whatever you need */
  } 
```

# bash - 当我的 shell 脚本从 cron 运行时，为什么非 ASCII 字符会被破坏？

> ID：10584905
> 
> 赞同：1
> 
> 时间：2012-05-14T14:04:34.590
> 
> 标签：bash, character-encoding, cron

我有一个简单的[shell 脚本，它可以同步 Google 日历](https://github.com/nikreiman/gcal-agenda/blob/master/sync-calendars)以便快速进行本地访问。当我从命令行运行它时，带有非 ASCII 字符（如 ä、ö、å）的事件可以正常工作，并且生成的输出文件看起来很完美。

但是，当脚本从 cron 运行时，输出文件中的字符会被破坏。例如，Ä 被替换为文字字符序列`\xc4`（即，“Ärstidernas”变为“\xc4rstidernas”）。该脚本正在 OSX 10.6 上运行。我不知道链中的哪个工具（cron、bash、python-2.6）导致这种情况发生。有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T06:54:36.207

感谢@aztaroth，我做了一些研究`LC_CTYPE`，发现正确的解决方案是将其添加到脚本中：

```
export LC_CTYPE="UTF-8" 
```

`LC_CTYPE`需要字符编码类型，而不是语言字符集。因此将其设置为 UTF-8 可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:16:54.883

`LC_CTYPE=sv_SE`在 crontab 的开头添加，也许？

# frameworks - Yii ，从 $_FILES 保存图像，但不使用模型

> ID：10584908
> 
> 赞同：7
> 
> 时间：2012-05-14T14:04:45.087
> 
> 标签：frameworks, yii, ckeditor

这可能吗 ？这是一个模型

```
 CUploadedFile::getInstance($model,'newsimage');
  $model->image->saveAs("image\path") 
```

但我不想创建一个模型只是为了保存我的图像。

我实际上需要的是......好吧，我正在尝试使CKEditor的“上传图像”功能起作用，但我需要一个用于保存图像的脚本。当我单击“上传图片”按钮时，我只是调用了一个操作，然后我可以使用 访问我选择的图片`$_FILES`，但我似乎无法将文件保存到目标目录。

是否可以将文件保存到目标路径（例如“C:\myProject\images”）而不使用模型？

编辑 ：

这是我稍后找到的解决方案我上传的文件在`$_FILES['upload']`..

```
$temp = CUploadedFile::getInstanceByName("upload");  // gets me the file into this variable (  i gues this wont work for multiple files at the same time )
$temp->saveAs("D:/games/" . $temp->name);  // full name , including the filename too. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T14:15:30.030

**假设“没有模型”=“没有数据库表”**

您只需在您的模型目录中创建一个从 CFormModel 扩展的 UploadForm.php

```
class UploadForm extends CFormModel
{
    public $upload_file;

    public function rules()
    {
        return array(
        array('upload_file', 'file', 'types'=>'jpg,jpeg,gif,png','maxSize'=>10*1024*1024),
        );
    }

    /**
     * Declares attribute labels.
     */
    public function attributeLabels()
    {
        return array(
            'upload_file'=>'Upload File',
        );
    }

} 
```

在你的控制器中

```
$model->upload_file=CUploadedFile::getInstance($model,'upload_file');
$model->upload_file->saveAs("C:\myProject\images\".$model->upload_file->name) 
```

# jsf - 如何在 JSF Datatable 上创建多行

> ID：10584910
> 
> 赞同：0
> 
> 时间：2012-05-14T14:04:49.507
> 
> 标签：jsf, datatable

我需要创建一个具有这种结构的表：

```
Column A     Column B     Column C     Column D
 xxxx         xxxx         xxxx         xxxx
Column E     Column F     Column G     Column H
 xxxx         xxxx         xxxx         xxxx 
```

`N`根据我清单上的项目数量，这将重复多次。

我进行了 Google 搜索，但没有找到任何包含多行的示例。

我尝试`datatable`在 main 内部使用，`datatable`但没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T12:08:52.093

我会创建一个`HTML`表并使用 EL，如有必要，这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T20:59:22.213

像这样的东西怎么样：

```
 <h:dataTable value="#{bean.items}" var="item">
        <table>
          <tr>
              <td>column A</td>
              <td>column B</td>
              <td>column C</td>
              <td>column D</td>
          </tr>
          <tr>
              <td>#{item.columnA}</td>
              <td>#{item.columnB}</td>
              <td>#{item.columnC}</td>
              <td>#{item.columnD}</td>
          </tr>
          <tr>
              <td>column E</td>
              <td>column F</td>
              <td>column G</td>
              <td>column H</td>
          </tr>
          <tr>
              <td>#{item.columnE}</td>
              <td>#{item.columnF}</td>
              <td>#{item.columnG}</td>
              <td>#{item.columnH}</td>
          </tr>
        </table>
    </h:dataTable> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:05:58.827

使用标准 JSF 组件的最简单方法是仅在单个列/单元格中呈现彼此下方的单元格值。

```
<h:dataTable value="#{bean.items}" var="item">
    <h:column>#{item.columnA}<br/>#{item.columnE}</h:column>
    <h:column>#{item.columnB}<br/>#{item.columnF}</h:column>
    <h:column>#{item.columnC}<br/>#{item.columnG}</h:column>
    <h:column>#{item.columnD}<br/>#{item.columnH}</h:column>
</h:dataTable> 
```

如有必要，您可以将每个值包装在 a 中`<div>`，并相应地添加一些具有正确尺寸、边框和背景的 CSS，使其看起来像一个真实的行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-18T00:09:13.783

您可以根据需要传递协议，并在[此处的答案](https://stackoverflow.com/questions/1315357/is-it-possible-to-have-multiple-rows-with-jsf-hdatatable/42306841#42306841)`List<Object[]>`中获取值属性。`<h:datatable>`

# ios - TTableViewCell 中的这些神秘边框是什么？

> ID：10584911
> 
> 赞同：0
> 
> 时间：2012-05-14T14:04:50.100
> 
> 标签：ios, uitableview, three20

我在 IO 应用程序中有以下层次结构：

```
. TTTableViewController, with the following elements
.. @""
.. TTTableCaptionItem
.. @""
.. TTTableSubtitleItemCell
.. @""
.. TTTableTextItem
.. @""
.. (other cells)
.. TTTableViewItem
 ... TTTableViewController 
```

这显示了嵌入式 TTTableViewController 周围的“神秘边界”，我似乎无法摆脱。

![图片](../Images/b51c7aff99d246174a69e9e5ac9b3b79.png)

嵌入式 TableViewItem 的初始化完全是普通的：

```
@implementation DetailCommentsItemCell
   - (id) initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
    {
      if (self = [super initWithStyle:UITableViewCellStyleSubtitle  reuseIdentifier:reuseIdentifier])
      {
      }
      return self;
    }
- (void)setObject:(id)object {
  _item = object;
  [self.contentView addSubview:[[object commentsViewController] tableView]];
} 
```

（“commentsViewController”是嵌入的 TTTableViewController）

有谁知道这些边界是什么以及如何摆脱它们？

根据要求，这是该表的设置代码：

```
 - (id)initWithFilter:(ObjectId)parameter_filter detailViewController:(DetailViewController  *)dvp;
   {
      DDLogInfo(@"CommentsViewController::initWithFilter parameter_filter %llu",
                parameter_filter);

      if (self = [super initWithStyle:UITableViewStyleGrouped])
      {

        self.tableView.clipsToBounds = YES;
        self.variableHeightRows = YES;
      }
      return self;
    } 
```

更新：

在@rishi 的优秀建议中，我添加了

```
self.tableView.backgroundColor = [UIColor clearColor];
self.tableView.backgroundView = nil; 
```

这好多了，但我还有一个神器。见下文：

![在此处输入图像描述](../Images/d962a10f47de7d17a697d0e046918acf.png)

另一个更新：我添加了以下代码：

```
self.tableView.layer.borderColor      = [[UIColor clearColor] CGColor];
self.tableView.layer.backgroundColor  = [[UIColor clearColor] CGColor]; 
```

现在看起来像这样：

![在此处输入图像描述](../Images/e3544cc31668b5c757e46d84ce44427a.png)

似乎它是罪魁祸首的层 - 但我无法摆脱边界 - 如果是这样的话。

作为一个实验，我将包含单元格的图层的边框设置为 2 和红色。这是我得到的，它告诉我神秘边框与表格相关联，而不是与周围的单元格相关联：

![在此处输入图像描述](../Images/666b5ef35b73037411291f79597e38ed.png)

这很奇怪。我在 Retina 显示器中查看它，“边框”实际上是表格后面的某个对象的边框。

![在此处输入图像描述](../Images/82686e000a5888776825a655cbdabdf2.png)

最后更新：

该工件原来是嵌入了内部 TableViewItem 的表格单元格的边框。由于我所做的插入调整，单元格被偏移，但我未能正确调整 y 原点。

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:33:57.223

在方法中使用以下代码`initWithFilter`-

```
self.tableView.backgroundColor = [UIColor clearColor];
self.tableView.backgroundView = nil; 
```

# android - 带有自定义适配器的可扩展 ListView

> ID：10584915
> 
> 赞同：1
> 
> 时间：2012-05-14T14:05:09.563
> 
> 标签：android

我正在尝试通过实现自定义适配器在 Android 中实现 ExpandableListView，但我没有在屏幕上获得任何输出。

主要的xml布局是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="This is an expandable listview"
    />
<ExpandableListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    />

</LinearLayout> 
```

组布局文件为：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
>

<TextView
    android:id="@+id/tvPlayerName"
    android:textSize="14px"
    android:textStyle="normal"
    android:layout_width="150px"
    android:layout_height="wrap_content"
    /> 
```

子布局文件是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
>

<TextView
    android:id="@+id/tvPlayerName"
    android:textSize="14px"
    android:textStyle="normal"
    android:layout_width="150px"
    android:layout_height="wrap_content"
    />

</LinearLayout> 
```

最后，活动类文件是：

```
public class ExpandableListViewTest extends ExpandableListActivity {
 String groupElements[] = {"India","Austrailia","England","South Africa"};
 String childElements[][] = {
    {"Sachin Tendulkar","Raina","Dhoni","Yuvraj"},
    {"Ponting","Adam Gilchrist","Michael Clarke"},
    {"Andrew Strauss","Kevin Peterson","Nasir Hussain"},
    {"Grame Smith","AB de Villiers","Jacques Kallis"}
};

int width;
ExpandableListView expList;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    //Setup our adapter
    MyExpandableAdapter mAdapter = new MyExpandableAdapter(this);
    setListAdapter(mAdapter);
}
public class MyExpandableAdapter extends BaseExpandableListAdapter
{
   private Context myContext;

   public MyExpandableAdapter(Context context)
   {
       this.myContext= context;
   }

@Override
public Object getChild(int groupPosition, int childPosition) {
    // TODO Auto-generated method stub
    return childElements[groupPosition][childPosition];
}

@Override
public long getChildId(int groupPosition, int childPosition) {
    // TODO Auto-generated method stub
    return childPosition;
}

@Override
public View getChildView(int groupPosition, int childPosition,
        boolean isLastChild, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
    if(convertView == null)
    {
        LayoutInflater inflater = getLayoutInflater();
        convertView = inflater.inflate(R.layout.child, parent,false);
    }
    TextView tvPlayerName = 
       (TextView)convertView.findViewById(R.id.tvPlayerName);
    tvPlayerName.setText(childElements[groupPosition][childPosition]);

    return convertView;

}

@Override
public int getChildrenCount(int groupPosition) {
    // TODO Auto-generated method stub
    return childElements[groupPosition].length;
}

@Override
public Object getGroup(int groupPosition) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public int getGroupCount() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public long getGroupId(int groupPosition) {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public View getGroupView(int groupPosition, boolean isExpanded,
        View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
    if(convertView == null)
    {
        LayoutInflater inflater = getLayoutInflater();
        convertView = inflater.inflate(R.layout.group,parent,false);
    }
    TextView tvGroupName = (TextView)convertView.findViewById(R.id.groupName);
    //tvGroupName.setText(groupElements[groupPosition]);
    tvGroupName.setText("Group Row");

    return convertView;

}

@Override
public boolean hasStableIds() {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    // TODO Auto-generated method stub
    return false;
}

}

} 
```

一切似乎都很简单，但运行应用程序后，屏幕保持空白。感谢任何帮助/理想。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:20:15.583

您的代码看起来不完整。您刚刚在方法中添加了占位符`getGroup`,`getGroupId`和`getGroupCount`. 他们应该引用您的`groupElements`数组。

当前返回零的事实`getGroupCount`足以`ExpandableListView`不显示任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:20:48.873

您可能应该将返回值设置为`getGroupCount()`to `groupElements.length`。

当前返回的**0**表示您没有任何组，因此没有可显示的内容。

# javascript - 有没有一种优雅的方式来在 JavaScript 中搜索关联数组？

> ID：10584921
> 
> 赞同：0
> 
> 时间：2012-05-14T14:05:31.203
> 
> 标签：javascript, arrays

我是 JavaScript 新手，希望对代码片段提出一些建设性的批评。此示例使用用户输入的值搜索关联数组。有没有更好的方法来解决这个问题？在仍然使用关联数组的同时，什么是更优雅的解决方案？谢谢。

```
var myObject = [
    {id: 1, word: 'ant', definition: 'an insect with eight legs.'}, 
    {id: 2, word: 'cake', definition: 'a food made with flour and sugar.'},
    {id: 3, word: 'house', definition: 'a building where a family lives.'},
];

function search(arg){
    var count = 0;
    for (var i = 0; i <= myObject.length; i++) {
        if (myObject[i].word == arg) {
            document.write(myObject[i].id + " - " + myObject[i].word + " - " + 
                               myObject[i].definition + "<br>"); 
            count += 1;
        }
        else {
            if (count != 1 &&
                    myObject[i].word != arg &&
                    i == myObject.length - 1) {

                document.write("NOT FOUND!");
            }
        }
    }
}

var arg = prompt("Search For An Entry");
if (arg != null && arg.length != 0) {
    search(arg);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:07:59.857

看起来还不错。我唯一可以建议的（这是一个*非常*小的改进）是在循环之前缓存关联数组的长度，如下所示：

```
for (var i = 0, len = myObject.length; i < len; i++) { 
```

您还可以移动最后一条`if`语句以检查是否未在`for`循环之外找到搜索参数，如下所示：

```
for (var i = 0, len = myObject.length; i < len; i++) {
    if (myObject[i].word == arg) {
        document.write(myObject[i].id + " - " + myObject[i].word + " - " + myObject[i].definition + "<br>");
        count += 1;
    }

    if(i == len-1 && count > 0) return;
}

document.write("NOT FOUND!"); 
```

`for`如果在结束循环之前找到任何搜索参数，此代码将退出搜索功能。这意味着`for`只有在搜索结果为“未找到”时，退出循环的任何代码才会运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:21:29.670

试试这个方法：

```
var myObject = {'ant': {id: 1, word: 'ant', definition: 'an insect with eight legs.'}, 
        'cake' : {id: 2, word: 'cake', definition: 'a food made with flour and sugar.'},
        'house' : {id: 3, word: 'house', definition: 'a building where a family lives.'},
        };

function search(arg){
    var count = 0;
    if (myObject[arg] != undefined)
    {
        document.write(myObject[arg].id + " - " + arg + " - " + myObject[arg].definition + "<br>");
    }
    else
    {
        document.write("NOT FOUND!");
    }
} 
```

这只有在每个单词有一个定义时才有效。如果您想要更多，并且仍然能够调用关联数组的力量，您可以将字典变量更改为如下所示：

```
var myObject = {'ant': [{id: 1, word: 'ant', definition: 'an insect with eight legs.'}, {id: 666, word: 'ant', definition: 'progeny of the devil'}], 
        'cake' : [{id: 2, word: 'cake', definition: 'a food made with flour and sugar.'}],
        'house' : [{id: 3, word: 'house', definition: 'a building where a family lives.'}],
        }; 
```

当然也相应地更改代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T00:33:46.120

这是我的看法：

```
var i, found = 0;

for (i = 0; i < myArray.length; i++) {
    if(myArray[i].word === arg) {
        document.write(myArray[i].id + " - " + myArray[i].word + " - " + myArray[i].definition + "<br>");
        found++;
    }
}

if(found === 0) {
    document.write("None found!");
} 
```

或者代替 final `if`，你可以总是写找到的项目的数量：

```
document.write(found.toString() + " items found"); 
```

# sql - SQL 导入/导出

> ID：10584923
> 
> 赞同：1
> 
> 时间：2012-05-14T14:05:33.903
> 
> 标签：sql

运行 select 语句以便稍后可以将输出插入回 SQL 的最直接方法是什么？数据集的大小会非常小，（可能少于 100 行）。我意识到有特定于数据库的导入/导出工具，但我想知道这是否可以仅使用 SQL 完成（可能还有一些 unix 命令行）。

编辑：

为了澄清，我想保存一组行：

```
select * from my_table where category='test' 
```

然后，一段时间后，我希望将那些匹配的行重新插入到同一个表中。我假设 SQL 选择输出将被保存到一个文件中，并且该文件将通过 sql 命令行实用程序重新播放。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:36:53.403

一种方法是通过将一些字符串连接在一起以生成 INSERT 语句来生成 SQL。假设您使用的是 MSSQL：

```
SELECT'INSERT INTO Table1(Col1,Col2) VALUES('+CAST(Col1 AS VARCHAR(500))+',' +CAST(Col2 AS VARCHAR(500))+')' FROM Table1 
```

这不是一个很好的方法，因为它显然不能很好地扩展，但对于小型用途来说它并不算太糟糕，特别是如果你想要一个快速的答案。

我不知道您的数据库是如何构建的，但请确保您记得检查您插入的数据不会受到任何 PK / FK 约束的影响。

另请查看以下问题：[为 SQL Server 表自动生成 INSERT 语句的最佳方法是什么？](https://stackoverflow.com/questions/982568/what-is-the-best-way-to-auto-generate-insert-statements-for-a-sql-server-table)

您还可以考虑使用 BCP [http://msdn.microsoft.com/en-us/library/aa196743(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa196743(v=sql.80).aspx) 用于 SQL BCP 的 google 会向您显示大量结果，这应该会有所帮助。

我知道您想要基于代码的解决方案，但我只想提一下，您还可以从 SQL Management Studio 导出此类数据（假设您正在使用该数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:28:21.710

我不确定我是否理解正确，但您想运行选择并将结果插入到同一命令的表中？

不确定是否可以完成，但我认为最像你想要的是 OUTPUT 语句：

```
declare @mytables table
(
   name varchar(50)
)

INSERT INTO @mytables    
output inserted.*   
select name 
from sys.tables 
```

在这里，您将插入`@mytables`查询结果并使用子句`select name from sys.tables`呈现结果`OUTPUT`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:37:44.263

如果数据库是`TableA { Id, Column1, Column2 }`

```
SELECT 
     'INSERT INTO [TableA] ([Id], [Column1], [Column2])' 
     + VALUES (' + [Id] + ', ''' + [Column1] + ''', ''' + [Column2] + ''')'
FROM TableA 
```

结果将是：

```
INSERT INTO [TableA] ([Id], [Column1], [Column2]) VALUES (1, 'Value1', 'Value2')
INSERT INTO [TableA] ([Id], [Column1], [Column2]) VALUES (2, 'Value11', 'Value22') 
```

然后您可以将结果复制到文件中

# android - Phonegap 关系数据库

> ID：10584925
> 
> 赞同：0
> 
> 时间：2012-05-14T14:05:36.857
> 
> 标签：android, iphone, database, sqlite, cordova

我正在创建一个 Phonegap / Cordova 应用程序，它将从关系数据库中提取大量列表视图。

当我四处搜索时，我在网上找到的很多东西都围绕着 HTML5 本地存储和 iPhone 中的客户端数据库，限制为 5mb。

我希望我的数据库大于 5mb，所以我想尝试将 SQLite 与我的应用程序捆绑在一起......或者至少我想我想！

Phonegap（iphone / android）上关系数据库的最佳方法是什么？如何将数据库与 PhoneGap 应用程序捆绑在一起？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T10:54:26.570

您可能会为此寻找 jembe (http://www.jembe.fr)。jembe 让你嵌入一个[大型的 sqlite 数据库](http://blog.jembe.fr/creer-un-projet-avec-une-base-de-donnees-prepopulate/)。访问该数据库的 API 类似于标准的 js API。

# unix - 当输入按数字排序时加入省略输出行

> ID：10584926
> 
> 赞同：5
> 
> 时间：2012-05-14T14:05:38.190
> 
> 标签：unix, join

我有两个文件，aa 和 bb：

```
 $ cat aa 
84 xxx
85 xxx
10101 sdf
10301 23

 $ cat bb
82 asd
83 asf
84 asdfasdf
10101 22232
10301 llll 
```

我使用 join 命令加入他们：

```
 $ join aa bb
84 xxx asdfasdf 
```

但预期的是 84、10101 和 10301 都加入了。为什么只加入了84个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T14:12:55.057

使用字典排序而不是数字排序。

作为该过程的一部分执行此操作：

```
$ join <(sort aa) <(sort bb) 
```

这给出了输出：

```
10101 sdf 22232
10301 23 llll
84 xxx asdfasdf 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T14:14:55.763

您未能包括输出错误消息的事实：

```
$ join aa bb
join: file 2 is not in sorted order
84 xxx asdfasdf
join: file 1 is not in sorted order 
```

您可以使用正常的字典排序：

```
join <(sort aa) <(sort bb) | sort -k1,1n 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-29T14:11:51.060

如果你想避免排序，那么你可以用 awk 补零：

```
join \
 <(awk '{printf("%05d %s\n", $1, $2)}' aa) \
 <(awk '{printf("%05d %s\n", $1, $2)}' bb) \
| awk '{print int($1),$2,$3}' 
```

生成保留原始排序顺序的输出：

```
84 xxx asdfasdf
10101 sdf 22232
10301 23 llll 
```

你想避免排序，因为 Unix 排序是 O(n log n)。

# jakarta-ee - Java EE 声明式安全性，从应用程序客户端获取对安全 bean 的引用

> ID：10584929
> 
> 赞同：2
> 
> 时间：2012-05-14T14:05:46.660
> 
> 标签：jakarta-ee, java-ee-6, declarative-authorization, declarative-security

关于 2 个问题，我想咨询您。

**背景**：我编写了一个测试、Java EE 应用程序并添加了声明式安全性。该应用程序部署在 Glassfish 3.1 上。对于单元测试，我将 JUnit 与嵌入式容器一起用于所有具有本地接口的 bean。对于应用程序的入口点 SessionFacde bean，它具有唯一的远程接口，我编写了一个简单的客户端来获取对 SessionFace bean 的引用。我只为 SessionFacade bean 应用了安全注释。

**（问题 1：**推荐的安全单元测试策略是什么？如果我为 sessionFacade 使用一个简单的应用程序客户端可以吗？（其他（本地）bean 不受影响，因为那里没有应用安全注释。））

**问题2：**我应该如何从应用程序客户端访问SessionFacde？如果您可以在此处复制 application-client.xml 的一些代码示例并获取对 JNDI 服务的引用，我将非常感激。这样可以节省我很多时间。这个问题类似于[Java EE 6 Application Client login](https://stackoverflow.com/questions/7663711/java-ee-6-application-client-login)下的问题，但我找到了一个解释（[http://docs.oracle.com/cd/E18930_01/html/821-2418/beacm.html](http://docs.oracle.com/cd/E18930_01/html/821-2418/beacm.html)），它不是真的推荐因为它将安全性负担重回开发人员而不是框架。请参阅以下文字：

> “[...]程序化登录允许应用程序开发人员绕过 GlassFish Server 支持的身份验证机制，并将身份验证数据直接提供给安全服务。虽然很灵活，但如果不了解安全问题，则不应使用此功能。
> 
> 由于这种机制绕过了容器管理的身份验证过程和顺序，因此应用程序开发人员必须非常小心地确保在访问任何受限资源或方法之前建立身份验证。验证登录尝试的状态并相应地更改应用程序的行为也是应用程序开发人员的责任。
> 
> 程序化登录状态不一定会在会话中持续存在或参与单点登录。[...]"

感谢您到目前为止已阅读。亲切的问候，塔马斯

**备注：**由于我写了原帖后一直没有回应，我想说回答第二个问题就足够了。这将帮助我继续。谢谢， 塔马斯

# javascript - 有没有办法将文件附加到已经存在的文件列表中？javascript文件api

> ID：10584932
> 
> 赞同：2
> 
> 时间：2012-05-14T14:05:58.820
> 
> 标签：javascript, flash, html, file-upload, upload

有没有办法将文件附加到已经存在的文件列表中？

```
function file_select_handler(e){   
    file_drag_hover(e);  

    var new_files = e.target.files || e.dataTransfer.files;

    //something like:
    files.append(new_files);

    for (var i = 0, f; f = files[i]; i++) {  
        parse_file(f); 
    }  
} 
```

编辑//我现在已经尝试过了：

```
function file_select_handler(e){   
file_drag_hover(e);    

    var new_files = e.target.files || e.dataTransfer.files;
    files_collect.push(new_files);

    for (a in files_collect) {    
        for (b in files_collect[a]) {  
            parse_file(files_collect[a][b]); 
        }  
    }  
} 
```

//编辑不回答:::://

But the above seems to put a pointer into the array, so when more files are chosen, they replace the others stored in the array. 疯狂的？有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:55:26.547

您需要考虑使用 Flash/Java 执行此操作。使用 JS 无法实现这一点有几个原因：安全问题，事实上“文件”输入类型只允许选择文件（而不是文件夹）。

# xcode - 了解 Xcode 的 Copy Headers 阶段

> ID：10584936
> 
> 赞同：26
> 
> 时间：2012-05-14T14:06:18.220
> 
> 标签：xcode, build, header

在 Xcode 的“Copy Headers”阶段，“Project”部分和“Private”部分下的 headers 有什么区别？你想什么时候使用每个？

另外，我可以理解您为什么要复制公共标头（例如对于静态库）-但是为什么要复制私有标头？

**编辑：** @mipadi 下面解释了公共和私有部分的角色。但是，我仍然缺少在“项目”部分中包含标题与在“复制标题”阶段的任何部分中没有标题之间的区别。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-14T16:35:03.880

如果公共标头包含私有标头，则必须复制私有标头，但您要确保库或框架的使用者知道这些私有标头不是公共 API 的一部分。

“项目”标头是*不*包含在公共标头中的私有标头（它们通常是内部实现的一部分，因此仅包含在实现`.c`或`.m`文件中）。

在构建框架时，公共头文件被复制到`Headers`框架的目录中，而私有头文件被复制到`PrivateHeaders`目录中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-28T14:43:16.413

@Danra，如果您将标题放在“项目”下，则这些标题将对您的实现可见，无论标题的实际位置如何。

假设您的文件夹结构如下： /Sources/libAF/AFSomething.h /Sources/libAF/AFSomething.m /Sources/exec/main.m

如果您将“AFSomething.h”放在“项目”下，则可以在 main.m 中像这样使用它：#import "AFSomething.h"

用外行的话来说，Xcode 将包含项目标头，尽管您省略了实际的路径信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T03:37:02.830

从[设置头文件的可见性](http://developer.apple.com/library/mac/#recipes/xcode_help-project_editor/Articles/Setting%20the%20Role%20of%20a%20Header%20File.html)：

*   公开：界面已完成，旨在供您产品的客户使用。公共标头包含在产品中，作为不受限制的可读源代码。

*   私有：该界面不适用于您的客户，或者它处于开发的早期阶段。产品中包含一个私有标头，但它被标记为“私有”。因此，这些符号对所有客户都是可见的，但客户应该明白他们不应该使用它们。

*   项目：该接口仅供当前项目中的实现文件使用。项目标头不包括在目标中，除了在目标代码中。这些符号对客户根本不可见，只有您自己可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-20T06:41:47.753

除此之外，通常人们有一个脚本来“清理”私有标题，这样公众就无法看到这些符号是什么。出于调试/开发目的，保留私有标头，它们在开发和调试阶段派上用场。

# wordpress - 来自自定义位置的页面模板

> ID：10584937
> 
> 赞同：0
> 
> 时间：2012-05-14T14:06:20.677
> 
> 标签：wordpress

我正在创建一个具有自定义帖子类型的 wordpress 插件。

我想在插件中包含一些自定义页面模板，但我不知道如何在添加新屏幕中填充模板下拉菜单。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-28T23:54:48.300

这是我从 Wordpress 插件（受 Tom McFarlin 启发）添加页面模板的代码解决方案。

注意 - 这是页面的解决方案，但您还需要配置自定义帖子类型以接受页面模板。

这是为插件设计的（模板文件在插件的根目录中搜索）。如果需要，可以更改 - 查看我的完整教程[http://www.wpexplorer.com/wordpress-page-templates-plugin/](http://www.wpexplorer.com/wordpress-page-templates-plugin/)了解有关此解决方案的更多详细信息。这些文件的格式也与直接包含在主题中的格式完全相同。

要自定义，只需在 __construct 方法中编辑以下代码块；

```
 $this->templates = array(
       'goodtobebad-template.php'     => 'It\'s Good to Be Bad',
   ); 
```

**完整代码；**

```
class PageTemplater {

    /**
     * A Unique Identifier
     */
     protected $plugin_slug;

    /**
     * A reference to an instance of this class.
     */
    private static $instance;

    /**
     * The array of templates that this plugin tracks.
     */
    protected $templates;

    /**
     * Returns an instance of this class. 
     */
    public static function get_instance() {

            if( null == self::$instance ) {
                    self::$instance = new PageTemplater();
            } 

            return self::$instance;

    } 

    /**
     * Initializes the plugin by setting filters and administration functions.
     */
    private function __construct() {

            $this->templates = array();

            // Add a filter to the attributes metabox to inject template into the cache.
            add_filter(
                'page_attributes_dropdown_pages_args',
                 array( $this, 'register_project_templates' ) 
            );

            // Add a filter to the save post to inject out template into the page cache
            add_filter(
                'wp_insert_post_data', 
                array( $this, 'register_project_templates' ) 
            );

            // Add a filter to the template include to determine if the page has our 
            // template assigned and return it's path
            add_filter(
                'template_include', 
                array( $this, 'view_project_template') 
            );

            // Add your templates to this array.
            $this->templates = array(
                    'goodtobebad-template.php'     => 'It\'s Good to Be Bad',
            );

    } 

    /**
     * Adds our template to the pages cache in order to trick WordPress
     * into thinking the template file exists where it doens't really exist.
     *
     */

    public function register_project_templates( $atts ) {

            // Create the key used for the themes cache
            $cache_key = 'page_templates-' . md5( get_theme_root() . '/' . get_stylesheet() );

            // Retrieve the cache list. 
            // If it doesn't exist, or it's empty prepare an array
            $templates = wp_get_theme()->get_page_templates();
            if ( empty( $templates ) ) {
                    $templates = array();
            } 

            // New cache, therefore remove the old one
            wp_cache_delete( $cache_key , 'themes');

            // Now add our template to the list of templates by merging our templates
            // with the existing templates array from the cache.
            $templates = array_merge( $templates, $this->templates );

            // Add the modified cache to allow WordPress to pick it up for listing
            // available templates
            wp_cache_add( $cache_key, $templates, 'themes', 1800 );

            return $atts;

    } 

    /**
     * Checks if the template is assigned to the page
     */
    public function view_project_template( $template ) {

            global $post;

            if (!isset($this->templates[get_post_meta( 
                $post->ID, '_wp_page_template', true 
            )] ) ) {

                    return $template;

            } 

            $file = plugin_dir_path(__FILE__). get_post_meta( 
                $post->ID, '_wp_page_template', true 
            );

            // Just to be safe, we check if the file exist first
            if( file_exists( $file ) ) {
                    return $file;
            } 
            else { echo $file; }

            return $template;

    } 

} 

add_action( 'plugins_loaded', array( 'PageTemplater', 'get_instance' ) ); 
```

查看我的教程以获取更多信息。

[http://www.wpexplorer.com/wordpress-page-templates-plugin/](http://www.wpexplorer.com/wordpress-page-templates-plugin/)

我希望这可以帮助您完成您想做的事情:)

# jquery - 使用 jquery 和 asp.net 服务器端函数调用强制下载文件

> ID：10584938
> 
> 赞同：0
> 
> 时间：2012-05-14T14:06:23.313
> 
> 标签：jquery, asp.net

我有一张图片，我只是想显示另存为对话框，以便通过 jquery ajax 调用下载该图片。当有人点击按钮时，客户端代码运行，这里的代码如下

```
$("#btnSaveAsImage").click(function () {
    if (_TrackNumber == '') {
        alert('Track Number is not valid');
        return;
    }
    var fname = _TrackNumber + '.gif';
    var DTO = { FileName: fname };

    jQuery.ajax({
        type: "POST",
        url: "UPSLabelFormUK.aspx/SaveAs",
        data: JSON.stringify(DTO),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            var retVal = data.d;
            alert(retVal);
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
            alert(textStatus);
        }
    });
    return false;
}); 
```

这个客户端代码实际上调用了我的服务器端函数。服务器端功能看起来像

```
[WebMethod]
    public static void SaveAs(string FileName)
    {
        HttpContext.Current.Response.Clear();
        HttpContext.Current.Response.WriteFile(HttpContext.Current.Server.MapPath(@"~/UPS_New/LabelImages/" + FileName));
        HttpContext.Current.Response.Flush();
        HttpContext.Current.Response.Close();
    } 
```

当服务器端函数执行结束时，jsuey 会显示一条错误消息，如解析错误。我只是不明白为什么会出现错误以及为什么没有保存为对话框......任何想法请与我分享。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:19:59.577

您收到解析错误的原因是因为 jQuery 被告知将 AJAX 调用的返回值解释为 JSON。该行`dataType: "json"`告诉 jQuery 您期待来自服务器的 JSON，因此它可以继续通过 JSON 解析器运行它。但是，您的服务器正试图返回一个数据流——这显然**不是**JSON。

我不确定您尝试做的事情是否可行。AJAX 不适用于文件类型或基于流的响应。它旨在用于 XML（异步 Javascript 和**XML**）或 JSON。无论哪种方式，AJAX 通常用于解释来自服务器的基于文本的响应，而不是基于流的。所以你试图用 jQuery 做的事情可能行不通。

相反，为什么不提供图像的直接下载链接。请参阅以下问题以获取参考：

[使用 jQuery/Javascript 打开保存图像对话框？](https://stackoverflow.com/questions/399486/open-the-save-image-dialog-using-jquery-javascript)

# java - NullPointerException 引起的 UmbrellaException

> ID：10584940
> 
> 赞同：0
> 
> 时间：2012-05-14T14:06:28.370
> 
> 标签：java, eclipse, gwt, smartgwt

当我调用此方法时，我的 GWT 项目中有空指针异常：

```
public void getPerson(ArrayList<Date> set, TextItem box, ListBox listBox) {
    if (listBox.getSelectedIndex() == 0) {
        Person person = new Person(box.getValueAsString(), set);
        Leaders.add(person);
    } else if (listBox.getSelectedIndex() == 1) {
        Person person = new Person(box.getValueAsString(), set);
        Reviewers.add(person);
    } else if (listBox.getSelectedIndex() == 2) {
        Person person = new Person(box.getValueAsString(), set);
        Leaders.add(person);
        Reviewers.add(person);
    }
} 
```

它是具有以下定义的类的一部分：

```
public class FunctionalityManager {

private Date startDate;
private Date endDate;
private HashSet<Person> Leaders;
private HashSet<Person> Reviewers;
private ArrayList<SoftwareWork> SoftwareWorks;
private ArrayList<DiplomaWork> HardwareWorks;
private ArrayList<DiplomaWork> NetWorks;

public FunctionalityManager() {
    super();
    startDate = new Date();
    endDate = new Date();
    HashSet<Person> Leaders = new HashSet<Person>();
    HashSet<Person> Reviewers = new HashSet<Person>();
    ArrayList<SoftwareWork> SoftwareWorks = new ArrayList<SoftwareWork>();
    ArrayList<DiplomaWork> HardwareWorks = new ArrayList<DiplomaWork>();
    ArrayList<DiplomaWork> NetWorks = new ArrayList<DiplomaWork>();
} 
```

...以及一些吸气剂和二传手。在主类中，我的 onModuleLoad() 方法是我创建 FunctionalityManager 的方式：

```
public class Salvation implements EntryPoint {

private FunctionalityManager FM = new FunctionalityManager(); 
```

这里是我调用 getPerson 方法的地方：

```
Button oneMoreButton = new Button("One More");
    oneMoreButton.addClickHandler(new ClickHandler() {
        public void onClick(ClickEvent event) {
            FM.getPerson(dates, textBox, listBox);
            RootPanel.get("mainDiv").clear();
            addPerson();
        }
    });

    Button next = new Button("Next");
    next.addClickHandler(new ClickHandler() {
        public void onClick(ClickEvent event) {
            FM.getPerson(dates, textBox, listBox);
            RootPanel.get("mainDiv").clear();
            addDiploma();

        }
    }); 
```

这是和例外，如果它会有所帮助：

```
16:53:11.406 [ERROR] [Salvation] Uncaught exception escaped
com.google.gwt.event.shared.UmbrellaException: One or more exceptions caught, see full set in UmbrellaException#getCauses
    at com.google.gwt.event.shared.HandlerManager.fireEvent(HandlerManager.java:129)
    at com.smartgwt.client.widgets.BaseWidget.fireEvent(BaseWidget.java:67)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
    at com.google.gwt.core.client.impl.Impl.apply(Impl.java)
    at com.google.gwt.core.client.impl.Impl.entry0(Impl.java:213)
    at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessages(BrowserChannelServer.java:292)
    at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:546)
    at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: null
    at org.elsys.salvation.client.FunctionalityManager.getPerson(FunctionalityManager.java:101)
    at org.elsys.salvation.client.Salvation$5.onClick(Salvation.java:149)
    at com.smartgwt.client.widgets.events.ClickEvent.dispatch(ClickEvent.java:96)
    at com.smartgwt.client.widgets.events.ClickEvent.dispatch(ClickEvent.java:1)
    at com.google.gwt.event.shared.GwtEvent.dispatch(GwtEvent.java:1)
    at com.google.web.bindery.event.shared.EventBus.dispatchEvent(EventBus.java:40)
    at com.google.web.bindery.event.shared.SimpleEventBus.doFire(SimpleEventBus.java:193)
    at com.google.web.bindery.event.shared.SimpleEventBus.fireEvent(SimpleEventBus.java:88)
    at com.google.gwt.event.shared.HandlerManager.fireEvent(HandlerManager.java:127)
    at com.smartgwt.client.widgets.BaseWidget.fireEvent(BaseWidget.java:67)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
    at com.google.gwt.core.client.impl.Impl.apply(Impl.java)
    at com.google.gwt.core.client.impl.Impl.entry0(Impl.java:213)
    at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessages(BrowserChannelServer.java:292)
    at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:546)
    at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
    at java.lang.Thread.run(Unknown Source) 
```

如何修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:12:37.340

您没有正确创建全局变量。更改以下行...

```
public FunctionalityManager() {
    super();
    startDate = new Date();
    endDate = new Date();
    Leaders = new HashSet<Person>(); // Changed
    Reviewers = new HashSet<Person>(); // Changed
    SoftwareWorks = new ArrayList<SoftwareWork>(); // Changed
    HardwareWorks = new ArrayList<DiplomaWork>(); // Changed
    NetWorks = new ArrayList<DiplomaWork>(); // Changed
} 
```

您正在创建名为`Leaders`,`Reviewers`等的局部变量，而不是初始化全局变量。

基本上你叫这个..

```
HashSet<Person> Leaders = new HashSet<Person>(); 
```

而不是仅仅调用这个......

```
Leaders = new HashSet<Person>(); 
```

所以全局变量实际上并没有被设置——你只是创建了同名的新局部变量，在`FunctionalityManager()`构造函数方法结束后不再存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:09:58.607

```
 at org.elsys.salvation.client.FunctionalityManager.getPerson(FunctionalityManager.java:101) 
```

101号线是哪个？

我相信`TextItem box`是空的。

# mysql - 使用 UNION 选择但限制每个子查询并接收不同的值

> ID：10584941
> 
> 赞同：7
> 
> 时间：2012-05-14T14:06:29.490
> 
> 标签：mysql, sql

我有一张桌子，想用一个订单获得 15 个值，用另一个订单获得 15 个值。目标是获得 30 个不同的值。
这是我的代码：

```
 (SELECT * FROM table1 WHERE criteria ORDER BY views DESC LIMIT 15)  
  UNION All  
 (SELECT * FROM table1 WHERE criteria ORDER BY date_upload DESC LIMIT 15) 
```

我知道如何用两个查询（用 NOT IN ）完成任务，但是有没有办法在一个查询中完成它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T17:28:03.057

如有必要，将“id”替换为您的主键名称：

```
(SELECT * FROM table1 WHERE criteria ORDER BY views DESC LIMIT 15)
UNION
(SELECT * FROM table1 WHERE criteria AND id NOT IN(SELECT id FROM table1 WHERE criteria LIMIT 15) ORDER BY date_upload DESC LIMIT 15) 
```

此查询：
- 选择按视图排序的前 15 个匹配条件的记录
- 选择前 15 个匹配条件且不在第一个 SELECT 中的记录，并按 date_upload 对其进行排序

使用此查询，每次 table1 中有 30 条不同的记录可用时，您一定会获得 30 条记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:20:12.960

我不太确定，如果它是你正在寻找的，但你总是可以将它包装在一个子选择中，并在你的外部 SELECT 中使用 DISTINCT 来过滤结果。当然不能保证你会得到 30 个搜索结果：

```
SELECT DISTINCT * FROM (
    (SELECT * FROM table1 WHERE criteria ORDER BY views DESC LIMIT 15)  
     UNION All  
    (SELECT * FROM table1 WHERE criteria ORDER BY date_upload DESC LIMIT 15) 
) AS a 
```

您可以为您的子选择设置一个更高的限制，并为您的外部选择添加一个额外的限制，虽然......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T04:07:11.210

```
WITH combined
AS
(
    SELECT * from table1
    union 
    SELECT * from table2
)
SELECT TOP 30 * FROM combined ORDER BY date_uploaded 
```

注意：将 * 与 UNION 一起使用并不是一个好主意。最好列出字段。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-22T10:54:46.697

UNION ALL 将列出重复的记录，而不是搞乱 Distinct 和 UNION ALL。尝试使用“UNION”，它为您提供独特的价值。

试试这个！

SELECT top 15 * FROM table1 UNION SELECT top 15 * FROM table1 ORDER BY date_upload

# events - QKeyEvent：找到原始小部件？

> ID：10584945
> 
> 赞同：1
> 
> 时间：2012-05-14T14:06:39.940
> 
> 标签：events, widget, pyqt4, keyboard-events

我有一个相当复杂的小部件结构，它代表一些对象的列表。包含框架对子小部件自己不处理的某些`QKeyEvent`s（例如）做出反应。`Alt+Up`但是，当我收到事件时，我想知道它的来源，或者通过

1.  获取当前具有键盘焦点的小部件，或通过
2.  获取该小部件的屏幕坐标（之后我可以转换）。

我无法处理`QKeyEvents`这些小部件，因为它们对父级的功能一无所知 - 具体而言，`Alt-Up`将项目在列表中向上移动，但项目的编辑器本身并不知道它在列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:24:45.767

知道了：

```
# get focus with keyboard focus
widget=QApplication.focusWidget() 
# use its middle position
globPos=widget.mapToGlobal(QPoint(.5*w.width(),.5*w.height())) 
```

# asp.net - 如果页面上出现异常，则使输出缓存无效

> ID：10584947
> 
> 赞同：7
> 
> 时间：2012-05-14T14:06:54.587
> 
> 标签：asp.net, caching, webforms, outputcache

我在其中一个页面中启用了输出缓存，如下所示：

```
<%@ OutputCache Duration="300" VaryByParam="*"%> 
```

问题是有时会出现异常，我们会显示适当的消息。但是该页面随后被缓存，其他用户也看到了异常消息。例如，假设数据库超时并因此引发 Sql 异常。捕获此异常并显示一条消息“连接数据库时出错。请稍后再试”。现在，此消息被缓存并显示给其他用户，甚至无需查询数据库。

所以我想要做的是在出现异常时使特定的输出缓存无效，或者在出现异常时可能不缓存。如何才能做到这一点？

这适用于 ASP.NET 3.5 Webforms。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T14:27:41.210

您应该能够删除缓存项

```
HttpResponse.RemoveOutputCacheItem("/MyPage/MyParameter"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T20:56:10.507

假设您的异常到达`Application_Error`Global.asax，您可以尝试以下操作：

```
public void Application_Error(Object sender, EventArgs e) {
    ...

    Response.Cache.AddValidationCallback(
        DontCacheCurrentResponse, 
        null);

    ...
}

private void DontCacheCurrentResponse(
    HttpContext context, 
    Object data, 
    ref HttpValidationStatus status) {

    status = HttpValidationStatus.IgnoreThisRequest;
} 
```

这将确保下一个响应不会从缓存中提供，但实际上会发送到您的页面/控制器。

# java - 双打、逗号和点

> ID：10584948
> 
> 赞同：18
> 
> 时间：2012-05-14T14:06:54.867
> 
> 标签：java, android, decimal

我正在制作一个从用户那里获取双值的 Android Java 程序。如果我在计算机上运行该程序，由于我计算机的语言环境 EN_UK，它运行良好。但是当我用 FI_FI 语言环境在我的手机上运行它时，它就不起作用了。我知道原因：在英国，人们使用点作为小数分隔符，但在芬兰，小数分隔符是逗号。

```
DecimalFormat df = new DecimalFormat("#.#");
Double returnValue = Double.valueOf(df.format(doubleNumber)); 
```

当我使用逗号时，它说`java.lang.NumberFormatException: Invalid double: "1234,5"`.

我怎样才能让它与他们一起工作，逗号和点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-14T14:12:32.383

使用 DecimalFormat 的其他构造函数之一：

```
new DecimalFormat("#.#", new DecimalFormatSymbols(Locale.US)) 
```

然后尝试使用两个分隔符解析它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T14:15:29.430

using`DecimalFormatSymbols.getInstance()` 将生成默认语言环境的正确符号，因此您可以在运行的任何平台上正确使用它。

```
DecimalFormat df = new DecimalFormat("#.#", DecimalFormatSymbols.getInstance()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-10T08:01:07.977

这应该适用于 Java(Tested) 和 android :)

*   **类名：In18Helper.java**

    ```
    package com.akmeher.app.utils;

    import java.text.NumberFormat;
    import java.text.ParseException;
    import java.util.Locale;

    public class In18Helper {
        private final static In18Helper mHelper = new In18Helper();

        public static final In18Helper getInstance() {
            return mHelper;
        }

        public double getDouble(String sValue, Locale locale) {
            NumberFormat numberFormat = NumberFormat.getInstance(locale);

            Number parse = null;
            try {
                parse = numberFormat.parse(sValue);
            } catch (ParseException e) {
                e.printStackTrace();
            }

            return parse == null ? 0 : parse.doubleValue();
        }

    } 
    ```

*   **类名：Application.java**

    ```
    package com.akmeher.app;

    import java.util.Locale;
    import com.akmeher.app.utils.In18Helper;

    public class Application {

        static DataModel[] testData = new DataModel[] {
                new DataModel("1.034567", Locale.ENGLISH),
                new DataModel("1,0345.67", Locale.ENGLISH),
                new DataModel("1.0345,67", Locale.GERMANY),
                new DataModel("1,034,567", Locale.CANADA),
                new DataModel("1.034567", Locale.KOREA),
                new DataModel("1,03.4567", Locale.ITALY) };

        /**
         * @param args
         */
        public static void main(String[] args) {

            for (int i = 0; i < testData.length; i++) {
                        double d = In18Helper.getInstance().getDouble(testData[i].mValue,
                        testData[i].mLocale);

                System.out.println("Trial Value: "+testData[i].mValue+" for Locale: "+testData[i].mLocale+" converted to: "+d);
            }
        }

        private static class DataModel {
            String mValue;
            Locale mLocale;

            public DataModel(String value, Locale locale) {
                this.mLocale = locale;
                this.mValue = value;
            }
        }
    } 
    ```

**输出：**

`Trial Value: 1.034567 for Locale: en converted to: 1.034567 Trial Value: 1,0345.67 for Locale: en converted to: 10345.67 Trial Value: 1.0345,67 for Locale: de_DE converted to: 10345.67 Trial Value: 1,034,567 for Locale: en_CA converted to: 1034567.0 Trial Value: 1.034567 for Locale: ko_KR converted to: 1.034567 Trial Value: 1,03.4567 for Locale: it_IT converted to: 1.03`

希望这将有助于有人使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-07T19:39:04.073

```
public static Double parseDoubleTL(String value){
    DecimalFormat df =  new DecimalFormat("#.#", new DecimalFormatSymbols(new Locale("tr_TR")));
    Double doublePrice = 0.0;
    try {
        doublePrice =  df.parse(value).doubleValue();
    } catch (ParseException e) {
        Log.w(MainActivity.TAG,"Couldnt parse TL. Error is "+e.toString());
    }
    return doublePrice;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-06-26T17:35:53.110

不是最好的方法，但对我有用；

```
 Double val=null;
    try{
        val=Double.valueOf(value);
    }catch(Exception e){
        val=Double.valueOf(value.replace(',','.'));
    }
            Double val=null;
    try{
        val=Double.valueOf(value);
    }catch(Exception e){
        val=Double.valueOf(value.replace(',','.'));
    }
    return val; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-12-14T14:56:41.897

我的错误：

```
java.lang.NumberFormatException: Invalid float: "1,683.88" 
```

...这对我有用

```
replace(",", "") 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-02-12T01:55:52.957

```
DecimanFormat df = new DecimalFormat("#.#"); 
```

# weblogic - 如何使用 eclipse 在远程 Weblogic 服务器中部署战争。

> ID：10584949
> 
> 赞同：1
> 
> 时间：2012-05-14T14:06:57.867
> 
> 标签：weblogic

我正在使用 weblogic 9，并尝试连接到远程服务器。

但首先它要求 Weblogic Home。由于我正在连接到远程系统，我的系统上怎么没有 weblogic 主目录。

再次只是为了测试我还在本地系统上安装了 Weblogic 并尝试访问远程服务器。

我提供了所有必要的值。它检测到正在运行的服务器。

但是当我尝试部署一个 JSF Web 应用程序时，它给出了一个错误。

如下：-

名为“HelloWorldJSF”的模块未能部署。有关详细信息，请参阅错误日志视图。weblogic.deploy.api.spi.exceptions.ServerConnectionException: [J2EE 部署 SPI:260041] 无法上传 'E:\eclipseWorkspace.metadata.plugins\org.eclipse.core.resources.projects\HelloWorldJSF\beadep\remote_weblogic\HelloWorldJSF。 war' 到 't3://192.168.218.51:7001' 从部署驱动程序收到异常。有关详细信息，请参阅错误日志视图。

如果我尝试在本地服务器上运行相同的 JSF Web 应用程序，它工作正常。

您能否让我知道如何在没有成功 Weblogic Home 的情况下在 Eclipse 中配置远程服务器连接。

真的非常感谢！

米通

# excel - VBA将列中的所有单元格转换为输入文本

> ID：10584950
> 
> 赞同：0
> 
> 时间：2012-05-14T14:06:58.553
> 
> 标签：excel, vba

我正在使用 VBA 对始终采用相同格式的生成 CSV 文件进行进一步格式化。我的 For Each 循环有问题。如果可以仅从第一列确定多个空白行，则循环将删除整行。

```
Dim rowCount As Integer
For Each cell In Columns("A").Cells 
    rowCount = rowCount + 1
    '
    ' Delete blank row
    '
    If cell = "" And cell.Offset(1, 0) = "" Then
        Rows(rowCount + 1).EntireRow.Delete
        spaceCount = 0
    End If
Next 
```

在某些时候，循环中的调用之一的值没有“”值，它只是空的并导致它崩溃。为了解决这个问题，我认为在比较之前将单元格的类型更改为文本会起作用，但我不知道如何（没有智能感知！！！）

那么如何在 VBA 中转换单元格类型，或者我将如何解决问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:29:08.593

使用`cell.Value`而不是，`cell.Text`因为它将评估单元格的值，而不管格式如何。按 F1`.Value`并`.Text`阅读更多关于两者的信息。

请注意该语句`For Each cell In Columns("A").Cells`，因为您将测试工作表中的每一行（在 Excel 2010 中超过一百万），这可能会使 Excel 崩溃。

**编辑：**

还要考虑函数`TRIM`。它删除字符串前后的每个空格。如果单元格中有空格“”；它在人眼看来是空的，但它内部有一个空间，因此与“”不同。如果您想将其视为空单元格，请尝试：

```
If Trim(cell.value) = "" then 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-22T15:18:01.533

正如@andy（[https://stackoverflow.com/users/1248931/andy-holaday](https://stackoverflow.com/users/1248931/andy-holaday)）在评论中所说，`For Each`绝对是要走的路。这甚至允许在行之间有空格。

示例代码：

```
Sub ListFirstCol()

Worksheets("Sheet1").Activate
Range("A1").Activate

For Each cell In Application.Intersect(Range("A:A"), Worksheets("Sheet1").UsedRange)
    MsgBox (cell)
Next

End Sub 
```

谢谢安迪！

# javascript - 每次重新加载页面时停止此脚本重置

> ID：10584953
> 
> 赞同：0
> 
> 时间：2012-05-14T14:07:00.597
> 
> 标签：javascript, cookies, countdown

我一直在搜索和搜索，但在重新加载页面后无法让这个脚本停止重置。

该脚本每 x 小时倒计时一次。问题是每次重新加载页面时，计时器都会重置。

即使重新加载页面，任何人都可以在这里帮助我如何保持倒计时？

我打电话给计时器。计时器 8 示例：>div... 等 id="timeLeft8"

```
 <script type="text/javascript">
    var events = new Array();

    events[1]={name: 'Blood Castle:', startUp: new Array(
        {hour:0,minute:25},
        {hour:2,minute:25},
        {hour:4,minute:25},
        {hour:6,minute:25},
        {hour:8,minute:25},
        {hour:10,minute:25},
        {hour:12,minute:25},
        {hour:14,minute:25},
        {hour:16,minute:25},
        {hour:18,minute:25},
        {hour:20,minute:25},
        {hour:22,minute:25}
    )}

    events[2]={name: 'Devil Square:', startUp: new Array(
        {hour:1,minute:55},
        {hour:3,minute:55},
        {hour:5,minute:55},
        {hour:7,minute:55},
        {hour:9,minute:55},
        {hour:11,minute:55},
        {hour:13,minute:55},
        {hour:15,minute:55},
        {hour:17,minute:55},
        {hour:19,minute:55},
        {hour:21,minute:55},
        {hour:23,minute:55}
    )}

    events[3]={name: 'Chaos Castle:', startUp: new Array(
        {hour:0,minute:55},
        {hour:2,minute:55},
        {hour:4,minute:55},
        {hour:6,minute:55},
        {hour:8,minute:55},
        {hour:10,minute:55},
        {hour:12,minute:55},
        {hour:14,minute:55},
        {hour:16,minute:55},
        {hour:18,minute:55},
        {hour:20,minute:55},
        {hour:22,minute:55}
    )}

    events[4]={name: 'Red Dragon:', startUp: new Array(
        {hour:0,minute:0},
        {hour:2,minute:0},
        {hour:4,minute:0},
        {hour:6,minute:0},
        {hour:8,minute:0},
        {hour:10,minute:0},
        {hour:12,minute:0},
        {hour:14,minute:0},
        {hour:16,minute:0},
        {hour:18,minute:0},
        {hour:20,minute:0},
        {hour:22,minute:0}
    )}

    events[5]={name: 'Gold Invasion:', startUp: new Array(
        {hour:0,minute:0},
        {hour:2,minute:0},
        {hour:4,minute:0},
        {hour:6,minute:0},
        {hour:8,minute:0},
        {hour:10,minute:0},
        {hour:12,minute:0},
        {hour:14,minute:0},
        {hour:16,minute:0},
        {hour:18,minute:0},
        {hour:20,minute:0},
        {hour:22,minute:0}
    )}

    events[6]={name: 'White Wizard:', startUp: new Array(
        {hour:0,minute:0},
        {hour:2,minute:0},
        {hour:4,minute:0},
        {hour:6,minute:0},
        {hour:8,minute:0},
        {hour:10,minute:0},
        {hour:12,minute:0},
        {hour:14,minute:0},
        {hour:16,minute:0},
        {hour:18,minute:0},
        {hour:20,minute:0},
        {hour:22,minute:0}
    )}

    events[7]={name: 'Blue:', startUp: new Array(
        {hour:0,minute:40},
        {hour:1,minute:40},
        {hour:2,minute:40},
        {hour:3,minute:40},
        {hour:4,minute:40},
        {hour:5,minute:40},
        {hour:6,minute:40},
        {hour:7,minute:40},
        {hour:8,minute:40},
        {hour:9,minute:40},
        {hour:10,minute:40},
        {hour:11,minute:40},
        {hour:12,minute:40},
        {hour:13,minute:40},
        {hour:14,minute:40},
        {hour:15,minute:40},
        {hour:16,minute:40},
        {hour:17,minute:40},
        {hour:18,minute:40},
        {hour:19,minute:40},
        {hour:20,minute:40},
        {hour:21,minute:40},
        {hour:22,minute:40},
        {hour:23,minute:40},
        {hour:24,minute:40}
    )}

    events[7]={name: 'Hide&Seek:', startUp: new Array(
        {hour:0,minute:42},
        {hour:1,minute:22},
        {hour:2,minute:32},
        {hour:3,minute:42},
        {hour:4,minute:52},
        {hour:6,minute:02},
        {hour:7,minute:12},
        {hour:8,minute:22},
        {hour:9,minute:32},
        {hour:10,minute:42},
        {hour:11,minute:52},
        {hour:13,minute:02},
        {hour:14,minute:12},
        {hour:15,minute:22},
        {hour:16,minute:32},
        {hour:17,minute:42},
        {hour:18,minute:52},
        {hour:20,minute:02},
        {hour:21,minute:12},
        {hour:22,minute:22},
        {hour:23,minute:32}
    )}

    events[8]={name: 'Sky:', startUp: new Array(
        {hour:1,minute:5},
        {hour:4,minute:5},
        {hour:7,minute:5},
        {hour:10,minute:5},
        {hour:13,minute:5},
        {hour:16,minute:5},
        {hour:19,minute:5},
        {hour:23,minute:5}
    )}

    events[9]={name: 'Boss Attack:', startUp: new Array(
        {hour:1,minute:50},
        {hour:4,minute:50},
        {hour:7,minute:50},
        {hour:10,minute:50},
        {hour:13,minute:50},
        {hour:16,minute:50},
        {hour:23,minute:50}
    )}

    events[10]={name: 'Happy Hour:', startUp: new Array(
        {hour:5,minute:5},
        {hour:2,minute:5},
        {hour:8,minute:5},
        {hour:11,minute:5},
        {hour:14,minute:5},
        {hour:17,minute:5},
        {hour:20,minute:5},
        {hour:0,minute:5}
    )}

    events[11]={name: 'Hit and Up:', startUp: new Array(
        {hour:0,minute:20},
        {hour:2,minute:20},
        {hour:5,minute:20},
        {hour:8,minute:20},
        {hour:11,minute:20},
        {hour:14,minute:20},
        {hour:20,minute:20}
    )}

    events[12]={name: 'Raklion:', startUp: new Array(
        {hour:0,minute:15},
        {hour:3,minute:15},
        {hour:6,minute:15},
        {hour:9,minute:15},
        {hour:12,minute:15},
        {hour:15,minute:15},
        {hour:18,minute:15},
        {hour:21,minute:15}
    )}

    events[13]={name: 'Moss:', startUp: new Array(
        {hour:3,minute:35},
        {hour:7,minute:35},
        {hour:11,minute:35},
        {hour:15,minute:35},
        {hour:19,minute:35},
        {hour:23,minute:35}
    )}

    events[14]={name: 'Illusion Temple:', startUp: new Array(
        {hour:0,minute:25},
        {hour:1,minute:25},
        {hour:2,minute:25},
        {hour:3,minute:25},
        {hour:4,minute:25},
        {hour:5,minute:25},
        {hour:6,minute:25},
        {hour:7,minute:25},
        {hour:8,minute:25},
        {hour:9,minute:25},
        {hour:10,minute:25},
        {hour:11,minute:25},
        {hour:12,minute:25},
        {hour:13,minute:25},
        {hour:14,minute:25},
        {hour:15,minute:25},
        {hour:16,minute:25},
        {hour:17,minute:25},
        {hour:18,minute:25},
        {hour:19,minute:25},
        {hour:20,minute:25},
        {hour:21,minute:25},
        {hour:22,minute:25},
        {hour:23,minute:25},
        {hour:24,minute:25}
    )}

    events[15]={name: 'Castle Deep:', startUp: new Array(
        {hour:1,minute:25},
        {hour:7,minute:25},
        {hour:13,minute:25},
        {hour:19,minute:25}
    )}

    events[16]={name: 'CryWolf:', startUp: new Array(
        {hour:1,minute:45},
        {hour:4,minute:45},
        {hour:7,minute:45},
        {hour:10,minute:45},
        {hour:13,minute:45},
        {hour:16,minute:20},
        {hour:19,minute:45},
        {hour:22,minute:45}
    )}

    var curTime=1336998502
    var dateTime=1336953600
    function timeLeft(i){
        for(j in events[i].startUp){
            tmp=events[i].startUp[j].hour*3600+events[i].startUp[j].minute*60
            if(dateTime+tmp>curTime){
                return dateTime+tmp-curTime;
            }
        }
        tmp=events[i].startUp[0].hour*3600+events[i].startUp[0].minute*60
        return dateTime+86400+tmp-curTime;
    }

    function getFormatedLeftTime($seconds){
        $second = $seconds % 60;
        $minutes = parseInt(($seconds / 60) % 60);
        $hour =  parseInt(($seconds / 3600) % 24);
        $days = parseInt($seconds / (24 * 3600));

        $ret = '';
        if ($days > 0)
            if ($days == 1) $ret += '1 day ';
            else $ret += $days + ' days ';

        if ($hour > 0){
            if ($hour < 10) $hour = '0' + $hour;
            $ret += $hour + ':';
        }else if ($days > 0) $ret += '00:';

        if($minutes < 10) $minutes = '0' + $minutes;

        $ret += $minutes + ':';

        if ($second < 10) $second = '0' + $second;

        $ret += $second;
        return $ret;

    }

    function updateTimes(){
        curTime++;
        for (i in events){
            document.getElementById("timeLeft"+i).innerHTML=getFormatedLeftTime(timeLeft(i));
        }
    }

    for(i in events)
        document.getElementById("eventList").innerHTML+="<div style='float:right; color: #FFFF00;' id='timeLeft"+i+"'>"+getFormatedLeftTime(timeLeft(i))+"</div><div style=\"color: #00FFFF;\"><strong>"+events[i].name+"</strong></div>";
    setInterval("updateTimes()", 1000);

    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:09:58.173

欢迎，javascript和html是无状态的，每一页都是新的一天。

虽然你用 标记了你的问题`cookie`，但你没有使用它，所以......使用它。
无论如何，这类事情应该在服务器端，而不是客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:10:19.503

将计数器值保存在本地存储中可能吗？当您的页面加载时，您可以检查它是否存在，如果不是从头开始。

像这样：

```
var counter = 0;
if(localStorage.counter) {
    counter = Number(localStorage.counter);
} else {
    counter = 1;
} 
```

然后当您更新计数器时，将其保存在存储中，例如：

```
counter += 1;
localStorage.counter = counter; 
```

好的，这是在您的脚本中实现的这种技术：（请记住，我不完全确定它的行为方式！）

```
<script type="text/javascript">
var events = new Array();

events[1]={name: 'Blood Castle:', startUp: new Array(
    {hour:0,minute:25},
    {hour:2,minute:25},
    {hour:4,minute:25},
    {hour:6,minute:25},
    {hour:8,minute:25},
    {hour:10,minute:25},
    {hour:12,minute:25},
    {hour:14,minute:25},
    {hour:16,minute:25},
    {hour:18,minute:25},
    {hour:20,minute:25},
    {hour:22,minute:25}
)}

events[2]={name: 'Devil Square:', startUp: new Array(
    {hour:1,minute:55},
    {hour:3,minute:55},
    {hour:5,minute:55},
    {hour:7,minute:55},
    {hour:9,minute:55},
    {hour:11,minute:55},
    {hour:13,minute:55},
    {hour:15,minute:55},
    {hour:17,minute:55},
    {hour:19,minute:55},
    {hour:21,minute:55},
    {hour:23,minute:55}
)}

events[3]={name: 'Chaos Castle:', startUp: new Array(
    {hour:0,minute:55},
    {hour:2,minute:55},
    {hour:4,minute:55},
    {hour:6,minute:55},
    {hour:8,minute:55},
    {hour:10,minute:55},
    {hour:12,minute:55},
    {hour:14,minute:55},
    {hour:16,minute:55},
    {hour:18,minute:55},
    {hour:20,minute:55},
    {hour:22,minute:55}
)}

events[4]={name: 'Red Dragon:', startUp: new Array(
    {hour:0,minute:0},
    {hour:2,minute:0},
    {hour:4,minute:0},
    {hour:6,minute:0},
    {hour:8,minute:0},
    {hour:10,minute:0},
    {hour:12,minute:0},
    {hour:14,minute:0},
    {hour:16,minute:0},
    {hour:18,minute:0},
    {hour:20,minute:0},
    {hour:22,minute:0}
)}

events[5]={name: 'Gold Invasion:', startUp: new Array(
    {hour:0,minute:0},
    {hour:2,minute:0},
    {hour:4,minute:0},
    {hour:6,minute:0},
    {hour:8,minute:0},
    {hour:10,minute:0},
    {hour:12,minute:0},
    {hour:14,minute:0},
    {hour:16,minute:0},
    {hour:18,minute:0},
    {hour:20,minute:0},
    {hour:22,minute:0}
)}

events[6]={name: 'White Wizard:', startUp: new Array(
    {hour:0,minute:0},
    {hour:2,minute:0},
    {hour:4,minute:0},
    {hour:6,minute:0},
    {hour:8,minute:0},
    {hour:10,minute:0},
    {hour:12,minute:0},
    {hour:14,minute:0},
    {hour:16,minute:0},
    {hour:18,minute:0},
    {hour:20,minute:0},
    {hour:22,minute:0}
)}

events[7]={name: 'Blue:', startUp: new Array(
    {hour:0,minute:40},
    {hour:1,minute:40},
    {hour:2,minute:40},
    {hour:3,minute:40},
    {hour:4,minute:40},
    {hour:5,minute:40},
    {hour:6,minute:40},
    {hour:7,minute:40},
    {hour:8,minute:40},
    {hour:9,minute:40},
    {hour:10,minute:40},
    {hour:11,minute:40},
    {hour:12,minute:40},
    {hour:13,minute:40},
    {hour:14,minute:40},
    {hour:15,minute:40},
    {hour:16,minute:40},
    {hour:17,minute:40},
    {hour:18,minute:40},
    {hour:19,minute:40},
    {hour:20,minute:40},
    {hour:21,minute:40},
    {hour:22,minute:40},
    {hour:23,minute:40},
    {hour:24,minute:40}
)}

events[7]={name: 'Hide&Seek:', startUp: new Array(
    {hour:0,minute:42},
    {hour:1,minute:22},
    {hour:2,minute:32},
    {hour:3,minute:42},
    {hour:4,minute:52},
    {hour:6,minute:02},
    {hour:7,minute:12},
    {hour:8,minute:22},
    {hour:9,minute:32},
    {hour:10,minute:42},
    {hour:11,minute:52},
    {hour:13,minute:02},
    {hour:14,minute:12},
    {hour:15,minute:22},
    {hour:16,minute:32},
    {hour:17,minute:42},
    {hour:18,minute:52},
    {hour:20,minute:02},
    {hour:21,minute:12},
    {hour:22,minute:22},
    {hour:23,minute:32}
)}

events[8]={name: 'Sky:', startUp: new Array(
    {hour:1,minute:5},
    {hour:4,minute:5},
    {hour:7,minute:5},
    {hour:10,minute:5},
    {hour:13,minute:5},
    {hour:16,minute:5},
    {hour:19,minute:5},
    {hour:23,minute:5}
)}

events[9]={name: 'Boss Attack:', startUp: new Array(
    {hour:1,minute:50},
    {hour:4,minute:50},
    {hour:7,minute:50},
    {hour:10,minute:50},
    {hour:13,minute:50},
    {hour:16,minute:50},
    {hour:23,minute:50}
)}

events[10]={name: 'Happy Hour:', startUp: new Array(
    {hour:5,minute:5},
    {hour:2,minute:5},
    {hour:8,minute:5},
    {hour:11,minute:5},
    {hour:14,minute:5},
    {hour:17,minute:5},
    {hour:20,minute:5},
    {hour:0,minute:5}
)}

events[11]={name: 'Hit and Up:', startUp: new Array(
    {hour:0,minute:20},
    {hour:2,minute:20},
    {hour:5,minute:20},
    {hour:8,minute:20},
    {hour:11,minute:20},
    {hour:14,minute:20},
    {hour:20,minute:20}
)}

events[12]={name: 'Raklion:', startUp: new Array(
    {hour:0,minute:15},
    {hour:3,minute:15},
    {hour:6,minute:15},
    {hour:9,minute:15},
    {hour:12,minute:15},
    {hour:15,minute:15},
    {hour:18,minute:15},
    {hour:21,minute:15}
)}

events[13]={name: 'Moss:', startUp: new Array(
    {hour:3,minute:35},
    {hour:7,minute:35},
    {hour:11,minute:35},
    {hour:15,minute:35},
    {hour:19,minute:35},
    {hour:23,minute:35}
)}

events[14]={name: 'Illusion Temple:', startUp: new Array(
    {hour:0,minute:25},
    {hour:1,minute:25},
    {hour:2,minute:25},
    {hour:3,minute:25},
    {hour:4,minute:25},
    {hour:5,minute:25},
    {hour:6,minute:25},
    {hour:7,minute:25},
    {hour:8,minute:25},
    {hour:9,minute:25},
    {hour:10,minute:25},
    {hour:11,minute:25},
    {hour:12,minute:25},
    {hour:13,minute:25},
    {hour:14,minute:25},
    {hour:15,minute:25},
    {hour:16,minute:25},
    {hour:17,minute:25},
    {hour:18,minute:25},
    {hour:19,minute:25},
    {hour:20,minute:25},
    {hour:21,minute:25},
    {hour:22,minute:25},
    {hour:23,minute:25},
    {hour:24,minute:25}
)}

events[15]={name: 'Castle Deep:', startUp: new Array(
    {hour:1,minute:25},
    {hour:7,minute:25},
    {hour:13,minute:25},
    {hour:19,minute:25}
)}

events[16]={name: 'CryWolf:', startUp: new Array(
    {hour:1,minute:45},
    {hour:4,minute:45},
    {hour:7,minute:45},
    {hour:10,minute:45},
    {hour:13,minute:45},
    {hour:16,minute:20},
    {hour:19,minute:45},
    {hour:22,minute:45}
)}

var curTime=1336998502;
var dateTime=1336953600;
if(localStorage.curTime) {
    curTime = Number(localStorage.curTime);
} else {
    // use default set above
}
// not sure if we need to persist dateTime but doing it anyway!
if(localStorage.dateTime) {
    dateTime = Number(localStorage.dateTime);
} else {
    // use default set above
}
function timeLeft(i){
    for(j in events[i].startUp){
        tmp=events[i].startUp[j].hour*3600+events[i].startUp[j].minute*60
        if(dateTime+tmp>curTime){
            return dateTime+tmp-curTime;
        }
    }
    tmp=events[i].startUp[0].hour*3600+events[i].startUp[0].minute*60
    return dateTime+86400+tmp-curTime;
}

function getFormatedLeftTime($seconds){
    $second = $seconds % 60;
    $minutes = parseInt(($seconds / 60) % 60);
    $hour =  parseInt(($seconds / 3600) % 24);
    $days = parseInt($seconds / (24 * 3600));

    $ret = '';
    if ($days > 0)
        if ($days == 1) $ret += '1 day ';
        else $ret += $days + ' days ';

    if ($hour > 0){
        if ($hour < 10) $hour = '0' + $hour;
        $ret += $hour + ':';
    }else if ($days > 0) $ret += '00:';

    if($minutes < 10) $minutes = '0' + $minutes;

    $ret += $minutes + ':';

    if ($second < 10) $second = '0' + $second;

    $ret += $second;
    return $ret;

}

function updateTimes(){
    curTime++;
    localStorage.curTime = curTime; // save current time
    for (i in events){
        document.getElementById("timeLeft"+i).innerHTML=getFormatedLeftTime(timeLeft(i));
    }
}

for(i in events)
    document.getElementById("eventList").innerHTML+="<div style='float:right; color: #FFFF00;' id='timeLeft"+i+"'>"+getFormatedLeftTime(timeLeft(i))+"</div><div style=\"color: #00FFFF;\"><strong>"+events[i].name+"</strong></div>";
setInterval("updateTimes()", 1000);

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T14:12:26.393

您可以保留计数器服务器端并在页面中仅放置一个图形计时器

# ios - 将 Google+ API 与 xCode/iOS (ARC) 一起使用

> ID：10584956
> 
> 赞同：0
> 
> 时间：2012-05-14T14:07:08.163
> 
> 标签：ios, xcode, api

我想访问我的 iOS 应用程序的 Google+ 时间线。

按照 Google 文档，我导入了 libGTlTouchStaticLib.a 和库的头文件。

尝试构建项目后，出现以下警告/错误：

```
ld: warning: ignoring file ..../libGTLTouchStaticLib.a, file was built for archive which is not the architecture being linked (i386) 
```

如何为 xCode 4.3.2 架构构建 Lib？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:18:06.970

命令：文件 libGTLTouchStaticLib.a 返回什么？听起来它是为 ARM（设备）编译的，并且您正在模拟器（i386）中运行它。您可能还想在设备上试用它。

# php - mcrypt 警告，但仍会解密数据

> ID：10584957
> 
> 赞同：13
> 
> 时间：2012-05-14T14:07:09.347
> 
> 标签：php, mcrypt

我在这堂课上有点奇怪：

```
<?php
namespace lib;

/**
 * Short description of Crypt
 *
 * @author xxxx
 * @package
 */
class Encryption
{
    /**
     * Short description of _ch
     * handle to the mcrypt resource
     *
     * @access private
     * @var $_ch
     */
    private $_ch;

    /**
     * Short description of __construct
     *
     * @access public
     * @author xxxx
     * @param
     * @return void
     */
    public function __construct( $keyData = NULL, $algorithm = \MCRYPT_RIJNDAEL_256, $mode = MCRYPT_MODE_ECB, $encLibPath = '', $modeDir = '' )
    {
        $this->_ch = mcrypt_module_open( $algorithm, $encLibPath, $mode, $modeDir );

        $vector  = mcrypt_create_iv ( mcrypt_enc_get_iv_size( $this->_ch ), \MCRYPT_DEV_URANDOM );
        $keySize = mcrypt_enc_get_key_size( $this->_ch );

        $key = substr( hash( 'SHA512', $keyData . $keySize ), 0, $keySize );

        $x = mcrypt_generic_init( $this->_ch, $key, $vector );
    }

    /**
     * Short description of encrypt
     *
     * @access public
     * @author xxxx
     * @param String $str
     * @return String $res
     */
    public function encrypt( $str )
    {
        if( !is_string( $str ) )
        {
            throw new \InvalidArgumentException( 'Attemptig to encrypt data that is not a string' );
            return false;
        }
        $res = mcrypt_generic( $this->_ch, $str );

        mcrypt_generic_deinit( $this->_ch );
        mcrypt_module_close( $this->_ch );

        #var_dump($str,$res);
        return $res;
    }

    /**
     * Short description of decrypt
     *
     * @access public
     * @author xxxx
     * @param String $str
     * @return String $res
     */
    public function decrypt( $str )
    {
        if( !is_string( $str ) )
        {
            throw new \InvalidArgumentException( 'Attemptig to decrypt data that is not a string' );
            return false;
        }

82      $res = mdecrypt_generic( $this->_ch, $str );

84      mcrypt_generic_deinit( $this->_ch );
85      mcrypt_module_close( $this->_ch );

        #var_dump($str,$res);
        return trim( $res);
    }
} 
```

当这样调用时：

```
<?php
$encryption    = new \lib\Encryption( 'somekey' );

echo $encryption->decrypt( $safeInfo ); 
```

扼杀产量：

警告：mdecrypt_generic(): 90 is not a valid MCrypt resource in E:\htdocs\site\application\lib\encryption.cls.php on line 82

警告：mcrypt_generic_deinit(): 90 is not a valid MCrypt resource in E:\htdocs\site\application\lib\encryption.cls.php on line 84

警告：mcrypt_module_close(): 90 is not a valid MCrypt resource in E:\htdocs\site\application\lib\encryption.cls.php on line 85

（这些行显示在加密类中。）

和

预期的解密字符串（如成功解密）。

我将感谢任何可能指出为什么会提出警告以及为什么它似乎不会影响结果的人。

PS 任何关于加密类有效性的评论都非常受欢迎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T10:13:30.347

看起来不错

```
<?php
$encryption = new \lib\Encryption( 'somekey' );
echo $encryption->decrypt(pack("H*", "4a4a564f26618d47536ff35b8a0af3212814a5f0ba635d2cf6f8cd31589042e2")); 
```

`_ch`迷失`mcrypt_module_close( $this->_ch );`在方法上`encrypt()`

也许您只能更改`__construct`和保存 args，只需`_ch`在每次加密或解密时创建句柄（like）。

我不擅长 Mcrypt，所以可能比我的要好一些，但是“有效的 MCrypt 资源”问题的原因确实是`mcrypt_module_close`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T13:08:52.330

看起来像命名空间问题，因为您没有`MCRYPT_MODE_ECB`在`__construct()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-19T12:35:13.317

这是要检查的东西，但是由于我无法重现，因此不确定它是否是答案。

您有 SHA512（创建 512 长度的密钥），但算法需要 256 长度的密钥。如果你使用 SHA256 有什么不同吗？通常，键的不匹配会产生垃圾，但在这种情况下，它可能仍会“产生副作用”。

# ruby-on-rails - Rails 3.2 应用程序的 PostgreSQL 数据库浏览器 - 感应应用程序而不是 SQLite 数据库浏览器

> ID：10584959
> 
> 赞同：2
> 
> 时间：2012-05-14T14:07:13.523
> 
> 标签：ruby-on-rails, postgresql, ruby-on-rails-3.2, railstutorial.org, induction

我正在关注 Rails 教程，使用 postgreSQL 设置数据库，因此开发和生产在本地以及在 Heroku 上的部署位置是相同的。到现在为止还挺好。我已经设置了 User 模型，并且在本地和部署到 heroku 中都可以工作。我的问题是我想在本地以表格形式访问数据库。使用 SQLite 数据库浏览器访问 SQLite 数据库很容易。我无法访问我的应用程序的 postgreSQL 数据库。

到目前为止，我已经下载了免费但完全令人困惑的 PGAdmin3。接下来我从 App Store 下载了 Navicat Essentials for PostgreSQL，售价 4.99 美元。我的 config/database.yml 是：

```
development:
  adapter: postgresql
  encoding: unicode
  database: [app_name]_development
  pool: 5
  username: [app_name]
  password: 
```

在 Navicat Essentials for PostgreSQL 中，我输入：

```
Connection Name: Test
Host Name/IP Address: localhost
Port: 5432
Default Database: [app_name]_development
username: [app_name]
password: 
```

当我点击“测试连接”时，它显示“连接成功”。我似乎仍然无法弄清楚如何以表格格式访问数据库。我点击了表格选项卡，但没有显示任何数据。有人有什么建议吗？我已经有至少一个用户，我可以在 Rails 顾问中确认。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T06:31:26.937

如果您使用的是 mac，则应该查看以下两个应用程序：

*   [Postgres 应用程序](http://www.postgresapp.com)- 用于安装和运行 postgres
*   [Induction 应用程序](http://www.inductionapp.com)- 用于探索数据和导航

两者都应该比其他选项更直接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T21:03:46.040

注意：这是我为使[Induction](http://inductionapp.com/)工作所做的工作。它可能包括额外的步骤，并且不是最严格的，但......

1) 在我的 rails 根目录下，我克隆了感应应用程序。$ git clone git://github.com/Induction/Induction.git

2）不确定我在第一步中完成了什么，我在我的硬盘驱动器，应用程序文件夹等中搜索了 Induction 是徒劳的。返回到 github 上的 Induction 自述文件，我在 uri 找到了对下载的引用： [https:// github.com/Induction/Induction/downloads](https://github.com/Induction/Induction/downloads)

在那里我下载了最新的 Induction - Alpha Build (4/12/2012) zip 并打开它，在我的下载中生成了 Induciton 应用程序。（我将很快将应用程序从下载移动到我的应用程序目录。）

3) 双击 Induction 应用程序打开了一个对话框，我填写了以下信息：

```
Adapter     postgres
Hostname    localhost
Username    [my_rails_app_name]
Password    [I left this blank]
Port        5432
Database    [my_rails_app_name]_development 
```

注意：要打开数据库，必须“打开”我的 postres 数据库，方法是在终端中打开一个新选项卡，导航到我的 rails 应用程序目录并键入：

```
$ postgres -D /usr/local/var/postgres 
```

回到 Induction，输入上述数据库信息后，我点击 connect 并打开 Induction。在归纳中，我点击顶部的“探索”，左侧是我的模型名称，我的数据以表格的形式出现。它就像用于 SQLite3 数据的 SQLite 数据库浏览器！再次感谢@CraigKerstines！

最后，不要忘记将 Induction 应用程序从下载转移到将来可以找到它的应用程序。

# android - 带有安卓模拟器的黑色窗口

> ID：10584960
> 
> 赞同：0
> 
> 时间：2012-05-14T14:07:17.613
> 
> 标签：android, eclipse, android-emulator, adb

我在 Eclipse for Android 上编程。但是我的Android模拟器有问题。当我运行模拟器时，我得到一个黑色窗口和错误“这个模拟器已经在运行”。我已经尝试重新启动 Eclipse 和 ADB 但它不起作用，重新安装 Eclipse 可以解决问题，直到它恢复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:35:48.210

我认为两个模拟器正在工作，只需关闭所有模拟器并重新运行程序

你可以从 window-avd manager 创建一个新的模拟器

# ios - UITableView 在联系人列表中按字母划分

> ID：10584966
> 
> 赞同：2
> 
> 时间：2012-05-14T14:07:39.703
> 
> 标签：ios

我确定以前有人问过这个问题，但我在搜索中找不到任何东西。

我有一个城市名称列表，可以根据所选国家/地区进行更改。我想按字母顺序订购这些，并根据第一个字母（如联系人列表）将它们显示在部分中。

我怎样才能做到这一点？我必须手动创建所有部分还是有内置方法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:09:39.533

将您的数据源排序为您希望的顺序，然后重新加载表格视图。

尝试制作 NSMutableArrays 的 NSDictionary。取每个城市的第一个字母，toUpper it。然后将您的城市插入到字母 k 的数组中。

部分数 = [[NSDictionary allKeys] 计数]

```
NSArray* cityNames = [NSArray arrayWithObject: @"Detroit"];

NSMutableDictionary* dataSource = [[NSMutableDictionary alloc] init];    

for( NSString* city_name in cityNames){

    NSString* key = [[city_name substringToIndex:1] uppercaseString];

    if( ![dataSource objectForKey: key] ){
        [dataSource setObject:[NSMutableArray array] forKey:key];
    }
    [[dataSource objectForKey: key] addObject: city_name];
} 
```

如果您需要更多帮助来设置您的 tableview 数据源，请在评论中说出来，我会为您提供更多帮助。干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:19:49.347

是的，您必须手动创建所有部分。并且将部分存储在`NSDictionary`. 要有字母的部分索引只需返回它们的数组`sectionIndexTitlesForTableView:`

# eclipse - Eclipse 的 Http Analyzer 插件

> ID：10584974
> 
> 赞同：1
> 
> 时间：2012-05-14T14:08:14.170
> 
> 标签：eclipse, eclipse-plugin

我在 JDeveloper 中使用过 Http Analyzer，有 Eclipse 编辑器的插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:27:23.867

尝试**TCP/IP 监视器**视图。（窗口>显示视图>其他...然后调试>TCP/IP 监视器）。

# regex - 如何创建一个匹配多个相似字符串的正则表达式？

> ID：10584975
> 
> 赞同：0
> 
> 时间：2012-05-14T14:08:15.660
> 
> 标签：regex

我正在寻找一个可以将多个字符串作为输入的函数，并创建一个匹配所有字符串的正则表达式。

例如，假设输入是：

*   有趣的狗
*   有趣的狗
*   有趣的狗

它应该输出如下内容：

```
/fun(ny)? dogs?/ 
```

我想知道 Levenshtein 距离是否可以用于这样的目的，但不知道......你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T14:36:11.083

您不是在说哪种正则表达式。Perl 带有一个叫做的东西[`Regex::PreSuf`](http://search.cpan.org/~jhi/Regex-PreSuf-1.17/PreSuf.pm)，它可以做这种事情。

# javascript - 引导弹出窗口在 Chrome 中不起作用

> ID：10584978
> 
> 赞同：10
> 
> 时间：2012-05-14T14:08:21.347
> 
> 标签：javascript, html, css, twitter-bootstrap

[http://www.rightoption.co/](http://www.rightoption.co/)

您会在页面的 RHS 一侧找到“我们的客户”，单击缩略图会打开弹出窗口（Firefox），但它在 Google chrome 中不起作用，请帮我解决这个问题

**编辑**：网站不再托管

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-14T19:01:10.143

这是因为弹出框的默认触发器是焦点。在 Firefox 中，当您单击某物时，它似乎会获得焦点，但在这种情况下，Chrome 似乎并非如此。

您可以尝试以下两种方法之一：

尝试手动将标签上的触发器设置为“手动”。所以添加这个属性 data-trigger="manual"

或者

在您的文档 onload 中，而不是执行以下操作：

```
$('#element, #element1').popover('toggle').popover('hide'); 
```

改用这一行：

```
$('#element, #element1')
   .popover()
   .click(function(e) { 
       e.preventDefault(); 
       $(this).focus(); 
   }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-08T20:52:11.683

接受的答案现在已经过时了，但它是在谷歌搜索中出现的，所以我想补充一点，从 2.3.0 版开始，Bootstrap 现在允许发送“悬停焦点”作为触发器，因此它可以在两者上都起作用. 非常重要的是，它还允许按您期望的方式工作的“点击”触发器（特别是对于 Chrome）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-11T19:01:28.757

这对我有用！

```
var el = $('[data-toggle="popover"]');
el
    .on('shown.bs.popover', function(){
        $(document).on('click.popover', function() {
            el.popover('hide');
            $(document).off('click.popover');
        });                            
    })
    .popover(); 
```

**更新**：上面有一个问题，即在显示弹出框时单击另一个弹出框元素会关闭打开的弹出框，但不会打开新的弹出框。以下将关闭打开的弹出框并一键打开新的弹出框。

```
var el = $('[data-toggle="popover"]');
el
    .on('click', function(e){
        var el = $(this);
        setTimeout(function(){
            el.popover('show');
        }, 200); // Must occur after document click event below.
    })
    .on('shown.bs.popover', function(){
        $(document).on('click.popover', function() {
            el.popover('hide'); // Hides all 
        });
    })
    .on('hide.bs.popover', function(){
        $(document).off('click.popover');
    }); 
```

# php - PHP 中来自模板和哈希树的动态 XML

> ID：10584981
> 
> 赞同：0
> 
> 时间：2012-05-14T14:08:28.647
> 
> 标签：php, xml, tree

## 大家好！

我在一个相当大的项目中很活跃，但我在 XML 方面的经验有限。我正在动态生成 XML，这些数据可以根据个别客户的需求进行定制。当前的解决方案是（请不要伤害我，我是新人）通过`include()`. 这不是好的做法，我想转向更好的解决方案。

### 结构

```
<?xml version='1.0'?>
<Product id="">
  <AswItem></AswItem>
  <EanCode></EanCode>
  <ImagePopup></ImagePopup>
  <ImageInfo></ImageInfo>
  <ImageThumbnail></ImageThumbnail>
  <PriceCurrency></PriceCurrency>
  <PriceValueNoTax></PriceValueNoTax>
  <Manufacture></Manufacture>

  <ProductDescriptions>
    <ProductDescrition language="" id="">
      <Name></Name>
      <Description></Description>
      <Color></Color>
      <Size></Size>
      <NavigationLevel1></NavigationLevel1>
      <NavigationLevel2></NavigationLevel2>
      <NavigationLevel3></NavigationLevel3>
      <NavigationLevel4></NavigationLevel4>
    </ProductDescrition>

  </ProductDescriptions>

  <MatrixProducts>
    <AswItem></AswItem>
    <EanCode></EanCode>
    <ParentId></ParentId>
    <PriceCurrency></PriceCurrency>
    <PriceValueNoTax></PriceValueNoTax>
    <ImagePopup></ImagePopup>
    <ImageInfo></ImageInfo>
    <ImageThumbnail></ImageThumbnail>
  </MatrixProducts>
</Product> 
```

这是我们的主要结构。`ProductDescriptions`并且`MatrixProducts`基本上是列表项，并且可能不包含多个子项。我们要翻译成 XML 的对象是一个 PHP 哈希树，它具有相似的结构但具有不同的键。

### 问题

我遇到的问题是我陷入了关于如何从对象动态创建树的思考过程中。我目前的计划是有一个密钥转换表（请参阅当前解决方案），但我脑后的声音告诉我这不是最佳实践。

### 以前的解决方案

**填充.php**

```
foreach($products as $product) {

    // too much black magic in here
    include($chosenTemplate);

    // $productXMLString is generated in the previous include
    printToXML($productXMLString)

} 
```

**模板.php**

```
<? 
echo "<Product id='{$product['id']}'>";
// etc...
echo "</product>"; 
```

如您所见，这是一种非常糟糕的方法。糟糕的错误处理、凌乱的语法和许多其他怪癖。

### 当前解决方案

```
 $xmlProductTemplate = simplexml_load_file($currentTemplate);

    foreach($products as $product) {
    $xmlObj = clone $xmlProductTemplate;
        foreach($product as $key => $productValue) { 
    // if value is a <$key>$string</$key>, just input 
    // it into the translated key for the $xmlObject
    if(!is_array($productValue))
        $xmlObj[translateKeyToXML($key)] = $productValue;

    // elseway, we need to call the magic; traverse a child array
    // and still hold true to templateing
    else {
        // what DO you do?
    }
    }
// save xml
fputs($xmlObj->asXML());
    } 
```

你会怎么做？什么是最佳实践？我有点饿和脱水，所以请告诉我是否缺少基本的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T14:23:36.733

我在理解您要做什么时遇到了一些麻烦，如果我不在，请原谅。看起来您正在尝试做的是基于“模板”创建一个 XML 文件，其中包含一个包含 XML 元素的属性和值的 ArrayObject。

也许，您只需创建一个 SimpleXML 对象，而不是尝试这样做。我认为这对于您尝试做的事情会容易得多，并且它增加了错误捕获的价值。请参阅PHP.net 上的[SimpleXML](http://www.php.net/simplexml)。

如果我的答案不正确，您能否发布更多源代码，例如包含这些值的类？谢谢。

# perl - 尝试按照说明在 Strawberry Perl 中安装 DB_File

> ID：10584986
> 
> 赞同：0
> 
> 时间：2012-05-14T14:08:45.833
> 
> 标签：perl

我正在尝试按照[这些说明](http://win32.perl.org/wiki/index.php?title=Install_DB_File_on_Strawberry_Perl)[`DB_File`](https://metacpan.org/module/DB_File)在 Strawberry Perl中安装。

*   [从这里](http://www.oracle.com/technology/software/products/berkeley-db/htdocs/popup/db/4.6.21/db-msi.html)下载并安装 Oracle/Sleepycat libdb MSI

*   转到 Berkeley DB 目录 - 例如 C:\Program Files\Oracle\Berkeley DB 4.6.21

*   将包含目录复制到 \strawberry\c\include\db：

*   将 lib\libdb46.lib 文件复制到 \strawberry\c\lib\libdb.a：

*   注释掉 \strawberry\c\include\db\db.h 中的两个 typedef

但我找不到文件夹**db**，也找不到文件**db\db.h**和文件夹**libdb.a**。请帮我`DB_File`在 Perl 中安装。

我使用 Windows 7 和草莓 Perl 5.14.2.1/64bit

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:38:09.960

DB_File 模块已经预装在草莓 perl 5.14.x 中

如果您想从 CPAN 安装/升级较新版本，则不需要安装 DB 库，因为所有必需的开发文件 (*.h + *.a) 也包含在草莓 perl 5.14.x 中 - 只需运行：

```
cpan -i DB_File 
```

--kmx

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:54:50.650

作者的意图是将*整个目录* `C:\Program Files\Oracle\Berkeley DB 4.6.21\include`（或系统上的等效目录）复制到`C:\strawberry\c\include`目录中（制作`C:\strawberry\c\include\include`），然后重命名为`db`.

`db.h`是新`C:\strawberry\c\include\db`目录中的一个文件。您需要按照说明对其进行编辑。

`libd.a`是一个*文件*，说明告诉你从`libdb46.lib`in复制`C:\Program Files\Oracle\Berkeley DB 4.6.21\lib`。（现在它更可能出现在 . 附近`libdb53.lib`。）您应该将此文件*复制*`C:\strawberry\c\lib`到目录并将其重命名为`libdb.a`.

之后，您需要按照说明编辑分发目录中的`config.in`文件。`DB_File`然后像往常一样构建、测试和安装。

# http - Apache Camel：谁负责发送 HTTP 消息？

> ID：10584987
> 
> 赞同：0
> 
> 时间：2012-05-14T14:09:03.030
> 
> 标签：http, apache-camel

目前，我使用 Camel 作为编排引擎（一个 HTTP 请求进来，我的 Camel 应用程序将发送某些 HTTP 消息并根据回复做出决定）。Camel 应用程序运行在 Apache 的 TomCat 之上。

作为测试的一部分，我开始向我的 Camel 应用程序发送越来越多的并发请求。精简后的场景如下：

```
 HTTP POST --> Camel --> HTTP GET to server Z
                     <-- 200 ok (this could take up to 5 sec)
           <-- 200 ok 
```

问题：同时发送 20 个请求时，一切正常（所有请求都由 Camel 应用程序处理）。

但是，当发送 21 个请求时，我看到以下行为：正在处理前 20 个请求，并且只有当第一个请求收到最终回复（= 200 ok）时，第 21 个 HTTP GET 请求才会发送到服务器 Z ??

这意味着对于 20 个请求，所有请求都在大约 5 秒内得到处理。但是当发送 21 个请求时，大约需要 10 秒（最后一个请求只能在 5 秒后由服务器 Z 处理）！

现在，我在 Camel 代码中添加了一些日志记录（向服务器 Z 发送 HTTP GET 消息之前和之后的时间戳），这让我很困惑：根据日志信息，Camel 确实立即发送了第 21 个请求！（它不等待第一条消息的 200 ok 最终回复？！）

所以，我想知道......这个第 21 个请求（到服务器 Z 的 HTTP GET）在哪里卡住了 5 秒？为什么？这真是让我脑洞大开……

所以，总结一下第 21 个请求：

在骆驼日志中：

```
 time x           = POST comes in
  time x+some msec = Camel sends HTTP GET to server Z
  time x+10        = Camel receives 200 ok on HTTP GET 
```

在wireshark中：

```
 time x           = POST comes in
  time x+5         = Camel sends HTTP GET to server Z
  time x+10        = Camel receives 200 ok on HTTP GET 
```

注意：我在我的骆驼代码中打印时间戳如下：

```
 .log("${date:now:yyyyMMdd-HH-mm-ss-SSS} **** Sending HTTP GET message... ****")
    .to("{{serverZ.endpoint}}") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T09:57:51.503

经过进一步调查，我发现了限制因素。Apache 的 HTTP 公共客户端有一个名为“MAX TOTAL CONNECTIONS”的参数，其默认值为 ... 20 ！

增加这个参数后，我不再遇到这个问题。

注意：我使用的是 Spring 框架 (STS) 和 Eclipse IDE。对于我的 Camel 应用程序，我修改了 applicationContext.xml 文件，如下所示：

```
<bean id="http" class="org.apache.camel.component.http.HttpComponent">
    <property name="camelContext" ref="camel"/>
    <property name="httpConnectionManager" ref="myHttpConnectionManager"/>
</bean>

<bean id="myHttpConnectionManager" class="org.apache.commons.httpclient.MultiThreadedHttpConnectionManager">
    <property name="params" ref="myHttpConnectionManagerParams"/>
</bean>

<bean id="myHttpConnectionManagerParams" class="org.apache.commons.httpclient.params.HttpConnectionManagerParams">
    <property name="defaultMaxConnectionsPerHost" value="1000"/>
    <property name="maxTotalConnections" value="1000"/>    
</bean> 
```

# visual-studio-2010 - 选择标准在 Crystal Reports 和 Visual Studio 2010 中不起作用

> ID：10584989
> 
> 赞同：1
> 
> 时间：2012-05-14T14:09:07.560
> 
> 标签：visual-studio-2010, crystal-reports

我继承了现有的 Crystal Report (.rpt)，用于打印相关数据集中所有记录的报表。

我现在想添加选择标准，以便仅在报告上打印具有匹配票号的结果。

我输入的选择标准是：

{REGISTER.TICKET_NO} = {?sTicketNo}

sTicketNo 反映了我从 C# 中的文本框中读取并作为参数传递给 Crystal Reports 的文本值。（参数传递肯定有效。当我将 sTicketNo 字段添加到报告中时，它会打印我在文本框中输入的正确值）。

问题是，无论我输入什么选择标准，报告都不会被过滤。无论标准如何，它总是打印所有记录。我已经使用其他硬编码标准进行了测试，例如仅选择具有非空值的记录。

我还尝试了来自[C# 和 Crystal Reports SDK - 忽略选择标准](https://stackoverflow.com/questions/9926991/c-sharp-and-crystal-reports-sdk-selection-criteria-ignored)但没有成功的建议。

Crystal Reports 中是否还有其他地方必须指定您不希望打印所有记录？我在菜单“Crystal Reports”>“Report”>“Select Expert”>“Record”中添加了我的选择标准。我对水晶报告很陌生。也许报告的作者在其他地方添加了一些设置来忽略选择标准，但我不确定在哪里看......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T22:20:41.433

有同样的问题 - 找到了这个解决方案。尽管它提到了 VS 2005/2008，但为我们工作了 VS 2010。

症状

在 Visual Studio .NET 2005 中升级 VS .NET 应用程序以使用 Crystal Reports 2008 时，将忽略选择公式 (.RecordSelectionFormula)。

原因

在 Visual Studio .NET 2005 中，当 Crystal Windows 窗体查看器添加到 Windows 窗体时，自动生成的代码会添加两行代码，将选择公式设置为空字符串 ("")。查看器的 SelectionFormula`ViewTimeSelectionFormula`默认设置为“”，因此，应用程序将忽略选择公式，无论是在报表设计器中还是在运行时传递给报表。

解析度

要解决此问题，请执行以下步骤：

展开`Form1.vb|cs`显示`Form1.Designer.vb|cs`。（`form1`表示包含您的查看器的表单）

双击`Form1.Designer.vb|cs`以显示其代码。

在 InitializeComponent 方法中，您将找到`CrystalReportViewer1`设置属性的代码。

注释掉或删除以下两行：

```
me.crystalReportViewer.SelectionFormula = ""

me.crystalReportViewer.ViewTimeSelectionFormula = "" 
```

# constraint-programming - SMT-solver 在约束求解方面比 CSP-solver 有什么优势？

> ID：10584990
> 
> 赞同：9
> 
> 时间：2012-05-14T14:09:09.707
> 
> 标签：constraint-programming, satisfiability

SMT-Solver 可用于约束求解。众所周知，CSP 求解器多年来也用于约束求解。那么 SMT 求解器相对于 CSP 求解器的优势是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:37:09.727

这完全取决于你想做什么。您可以将两者转换为 SAT 并将约束问题作为 SAT 问题来解决。在建模问题时，约束求解器通常提供最高级别的抽象。SAT 求解器非常快，但根据您的问题，SMT 或约束求解器可能更快。

您的问题没有一般性的答案。这取决于您的特定用例。

# r - R：循环遍历 data.table 中的列

> ID：10584993
> 
> 赞同：10
> 
> 时间：2012-05-14T14:09:16.283
> 
> 标签：r, data.table, sapply

我想确定大型 data.table 的列类。

```
colClasses <- sapply(DT, FUN=function(x)class(x)[1]) 
```

有效，但显然本地副本存储到内存中：

```
> memory.size()
[1] 687.59
> colClasses <- sapply(DT, class)
> memory.size()
[1] 1346.21 
```

循环似乎是不可能的，因为 data.table "with=FALSE" 总是导致 data.table。

一种快速且非常肮脏的方法是：

```
DT1 <- DT[1, ]
colClasses <- sapply(DT1, FUN=function(x)class(x)[1]) 
```

什么是最优雅和最有效的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T18:07:33.873

简单调查了一下，好像是个`data.table`bug。

```
> DT = data.table(a=1:1e6,b=1:1e6,c=1:1e6,d=1:1e6)
> Rprofmem()
> sapply(DT,class)
        a         b         c         d 
"integer" "integer" "integer" "integer" 
> Rprofmem(NULL)
> noquote(readLines("Rprofmem.out"))
[1] 4000040 :"as.list.data.table" "as.list" "lapply" "sapply"       
[2] 4000040 :"as.list.data.table" "as.list" "lapply" "sapply" 
[3] 4000040 :"as.list.data.table" "as.list" "lapply" "sapply"   
[4] 4000040 :"as.list.data.table" "as.list" "lapply" "sapply" 

> tracemem(DT)
> sapply(DT,class)
tracemem[000000000431A290 -> 00000000065D70D8]: as.list.data.table as.list lapply sapply 
        a         b         c         d 
"integer" "integer" "integer" "integer" 
```

所以，看`as.list.data.table`：

```
> data.table:::as.list.data.table
function (x, ...) 
{
    ans <- unclass(x)
    setattr(ans, "row.names", NULL)
    setattr(ans, "sorted", NULL)
    setattr(ans, ".internal.selfref", NULL)
    ans
}
<environment: namespace:data.table>
> 
```

注意第一行的讨厌`unclass`。`?unclass`确认它需要其论点的深层副本。从这个快速的外观来看，它似乎没有`sapply`或`lapply`正在复制（我认为他们没有这样做，因为 R 擅长写时复制，而那些不是写的），而是`as.list`in `lapply`（它发送到`as.list.data.table`）。

所以，如果我们避免`unclass`，它应该加速。我们试试看：

```
> DT = data.table(a=1:1e7,b=1:1e7,c=1:1e7,d=1:1e7)
> system.time(sapply(DT,class))
   user  system elapsed 
   0.28    0.06    0.35 
> system.time(sapply(DT,class))  # repeat timing a few times and take minimum
   user  system elapsed 
   0.17    0.00    0.17 
> system.time(sapply(DT,class))
   user  system elapsed 
   0.13    0.04    0.18 
> system.time(sapply(DT,class))
   user  system elapsed 
   0.14    0.03    0.17 
> assignInNamespace("as.list.data.table",function(x)x,"data.table")
> data.table:::as.list.data.table
function(x)x
> system.time(sapply(DT,class))
   user  system elapsed 
      0       0       0 
> system.time(sapply(DT,class))
   user  system elapsed 
   0.01    0.00    0.02 
> system.time(sapply(DT,class))
   user  system elapsed 
      0       0       0 
> sapply(DT,class)
        a         b         c         d 
"integer" "integer" "integer" "integer" 
> 
```

所以，是的，*无限*好。

我已经提出了[错误报告 #2000](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2000&group_id=240&atid=975)来删除该`as.list.data.table`方法，因为 a`data.table` `is()`已经 a`list`了。这实际上可能会加速很多成语，例如`lapply(.SD,...)`. [编辑：这已在 v1.8.1 中修复]。

谢谢你问这个问题！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T14:55:01.987

我认为这样的方法没有任何问题

```
colClasses <- sapply(head(DT1,1), FUN=class) 
```

它基本上是您的快速'n'dirty解决方案，但可能更清晰（即使不是那么多）......