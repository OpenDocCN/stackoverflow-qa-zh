# StackOverflow 问答 11832000-11832999

# groovy - 忽略声纳中的重复导入语句

> ID：11832000
> 
> 赞同：7
> 
> 时间：2012-08-06T16:10:53.107
> 
> 标签：groovy, sonarqube, code-duplication

我有一个 Sonar 3.0.1 正在分析的 Groovy 项目。我们使用声纳检测器打开了重复代码检测。

在一组文件中，它检测到 11 行重复`import`语句。在另一组文件中，它检测到 15 行重复的成员声明。由于这个项目有一个明确的数据库与显示对象分离（即使它们大多相似，因此重复的成员声明），我想配置 Sonar 以忽略这些重复集——我们认为它们是可接受的重复。

我如何告诉 Sonar 忽略重复的导入和/或成员声明，​​但仍然因为方法中的重复代码而对我大喊大叫？

# java - 为什么访问说明符不能用于 Java 类的方法内部声明的变量？

> ID：11832001
> 
> 赞同：3
> 
> 时间：2012-08-06T16:10:55.003
> 
> 标签：java, class, variables, methods, access-specifier

为什么我们不能对 Java 类的方法内声明的变量使用访问说明符？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-06T16:12:39.347

因为没有意义。方法中声明的变量是方法的局部变量；即它们不能在方法之外访问。修改变量的声明会实现什么？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T16:12:53.577

这样做是没有意义的。

局部变量（在方法中声明的变量）仅在该方法的范围内 - 将其声明为“公共”或“受保护”*意味着什么？*只有该方法中的代码才会知道它，并且您不会区分该方法中的不同代码位*以*允许某些部分访问变量而其他部分不可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:17:30.347

访问修饰符只有在您想控制其他类如何使用它时才有意义。您想如何通过使用这些修饰符来控制对方法中变量的访问？在方法内控制变量的访问听起来绝对愚蠢，尤其是当变量范围仅在方法内时。一旦方法完成，变量将不存在。即使变量是从堆中分配的内存，一旦引用消失，内存仍可用于垃圾收集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-16T17:21:57.257

*   在方法、块或构造函数中声明的变量称为局部变量。
*   局部变量在方法/块内初始化，并在方法/块执行完成后销毁。

因此，为这些类型的变量指定访问修饰符没有任何意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-09T14:14:02.803

根据 java 的规则，无论在方法范围内声明的变量不能在外部访问，这本身意味着变量本身是**私有的、受保护**的，如果没有指定，我们当然知道它的**默认值。**所以用上面提到的访问修饰符声明一个局部变量是没有意义的。但是，***您***仍然可以使用**“final”**访问修饰符，因为您不希望在 method() 过程中更改它，因为某些处理（例如不需要的值重新分配给变量等），

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-31T10:16:07.987

应用访问修饰符没有意义，因为局部变量访问范围仅限于方法范围。因此，应用访问修饰符没有任何意义。

```
class Foo{ 
    public void stuff(){
     private String x=2;  //compilation error.
}
} 
```

如果我们显式应用访问修饰符，上面的代码将无法编译。

# android - 定制的 Android 单选按钮 [不是他们的外观和感觉... ;) ]

> ID：11832003
> 
> 赞同：1
> 
> 时间：2012-08-06T16:11:00.817
> 
> 标签：android, radio-button, android-arrayadapter, listadapter

我很清楚有一些方法可以自定义元素`GridView`，例如`ListView`使用`Adapters`(like `BaseAdapter`)。我也知道 Holder 范式可以保持复杂数据结构的状态。

我想知道`RadioGroup`工作是否相同。如果不是，我怎么能实现这样的东西：

```
|-------|
| 正文 |
|-------|
| 图片 |
|-------|
| 收音机 |
| 但。|
|-------|

```

这可以模块化（以编程方式）添加到 a`RadioGroup`以获得更复杂的结构，例如：

```
|-------|-------|--------|
| 正文 | 正文 | 正文 |
|-------|-------|--------|
| 图片 | 图片 | 图片 |
|-------|-------|--------|
| 收音机 | 收音机 | 收音机 |
| 但。| 但。| 但。|
|-------|-------|--------|

```

我发现的其他解决方案涉及[Horizo​​ntal ListView](https://stackoverflow.com/questions/3240331/horizontal-listview-in-android)或自定义 [GridView](http://vikaskanani.wordpress.com/2011/07/20/android-custom-image-gallery-with-checkbox-in-grid-to-select-multiple/)。

是否有任何其他 Android 设计模式可以遵循以实现更优雅的结果？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:49:51.750

我不确定，如果我完全理解你的问题，但看一下插图，我认为你需要扩展[ViewGroup](http://developer.android.com/reference/android/view/ViewGroup.html)类，并添加一些自定义功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T11:03:38.807

最后，我发现这样做的唯一方法是在 JAVA 中进行大量编码。基本适配器 + ViewHolder 范例 + 带有所需组件的线性布局的硬编码生成。

# php - 如何拆分url参数值

> ID：11832005
> 
> 赞同：0
> 
> 时间：2012-08-06T16:11:10.767
> 
> 标签：php, url, parameters, split

如何使用拆分器将 url 参数拆分为`file.php?subid2=1234567|user@email.com` 两个值`1234567`和电子邮件地址`|`？

我`$_REQUEST['subid2'];`用来获取完整值，但我想将其拆分为 2 个值并将其保存到 cookie 中。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:12:47.423

您可以使用[`explode`](http://cn2.php.net/manual/en/function.explode.php)：

```
$values = explode('|', $_GET['subid2']);

// access them like this:
$id = $values[0];
$email = $values[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:13:41.557

`list($id, $email) = explode('|', $_GET['subid2']);`

# entity-framework - 如何在 EF 中使用/持久化 POCO 对象关系？

> ID：11832008
> 
> 赞同：2
> 
> 时间：2012-08-06T16:11:21.327
> 
> 标签：entity-framework, ef-code-first, poco, entity-framework-5

我有一些看起来像这样的 POCO 对象：

```
public class Foo
{
    public int Id { get; set; }
    public string FooProperty { get; set; }
    public int BarId { get; set; }
    public virtual Bar Bar { get; set; }
}
public class Bar
{
    public int Id { get; set; }
    public string BarProperty { get; set; }
    public int FooId { get; set; }
    public virtual Foo Foo { get; set; }
} 
```

每个 Foo 对象只有一个 Bar（反之亦然）。

现在我想创建一对新的 Foo/Bar 对象。所以我这样做（这是我怀疑我出错的地方）：

```
var foo = new Foo() { FooProperty = "hello" };

dbContext.Foos.Add(foo);

var bar = new Bar() { BarProperty = "world" };

foo.Bar = bar;

dbContext.SaveChanges(); 
```

正如您可能知道的那样，我希望因为我 "添加" `foo`， then`bar`也将被添加，因为它是同一个对象图的一部分，但不：它没有被添加 - 也没有在`FooId`之后`Bar`更新对象的调用`SaveChanges`（尽管`Id`Foo 对象*的 已*更新）。

所以，我的猜测是这种行为是因为我正在处理 POCO 而不是 EF 代理对象，因此没有“管道”来完成这项工作。我可以`Id`从`Foo`对象中获取 并手动将其存储在`Bar`对象中（反之亦然）并进行更多调用`SaveChanges`，但显然这不是正确的方法。

所以，大概我需要创建 EF 代理对象而不是裸 POCO 对象。最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:18:45.710

如果实体满足创建代理对象的要求，您可以通过从上下文本身调用 create 函数来完成这项工作：

```
 var foo = dbContext.Foos.Create();
    dbContext.Foos.Add(foo);
    var bar = dbContext.Bars.Create();
    foo.Bar = bar;
    dbContext.SaveChanges(); 
```

# c++ - C++/CLR 类中的成员 CComPtr

> ID：11832010
> 
> 赞同：2
> 
> 时间：2012-08-06T16:11:27.983
> 
> 标签：c++, com, clr

我正在编写一个 C++/CLI 类，该类需要在`CComPtr`其生命周期内持续使用，例如

```
public ref class MyClass
{
public:
    MyClass()
    {
        CComPtr<ISomeType> pSomeType;
        // init someType;
        m_pSomeType = pSomeType;
    }

private:
    CComPtr<ISomeType> m_pSomeType;

    void DoSomething()
    {
        m_pSomeType->DoSomething();
    }
} 
```

但是，由于不支持混合类型，因此无法编译 - 解决方案是使用[`AutoPtr`](http://weblogs.asp.net/kennykerr/archive/2007/03/26/AutoPtr.aspx). 我仍然需要引用计数，所以这就是我想出的。

```
public ref class MyClass
{
public:
    MyClass()
    {
        CComPtr<ISomeType> pSomeType;
        // init someType;
        m_pSomeType = new CComPtr<ISomeType>(pSomeType);
    }

private:
    AutoPtr<CComPtr<ISomeType>> m_pSomeType;

    void DoSomething()
    {
        CComPtr<ISomeType> pSomeType = *m_pSomeType.GetPointer();
        pSomeType->DoSomething();
    }
} 
```

这对我来说看起来很讨厌，而且我也怀疑它在某种程度上是错误的（我来自 C# 背景，所以我在学习过程中学到了很多东西）。

`CComPtr`我应该如何将 a作为 C++/CLR 类的成员“存储” ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:40:54.763

我制作了一个智能指针，可能会对您有所帮助。它不能用于直接管理 COM 指针，但可以用于在托管类中保存 CComPtr。

*   [适用于 C++/CLI 的 scoped_ptr（确保托管对象正确释放拥有的本机对象）](https://codereview.stackexchange.com/questions/1695/scoped-ptr-for-c-cli-ensure-managed-object-properly-frees-owned-native-object)

如果您选择使用它，请尊重许可要求（不禁止商业使用，但您必须给予信任）。

另外，你可以写

```
(*m_pSomeType)->DoSomething(); 
```

而不是复制`CComPtr`（必须更新引用计数）。

除此之外，我会在构造函数中使用*ctor-initializer-list*而不是赋值。

```
MyClass()
    : m_pSomeType(new CComPtr<ISomeType>)
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:15:23.857

如果您想分别编译托管和非托管代码，那么[这里](http://msdn.microsoft.com/en-us/library/0adb9zxe%28v=vs.80%29.aspx)有一个链接。

使用它，您可以保留两者的风味。

# java - Android更改ItemizedOverlay中某些项目的不透明度

> ID：11832012
> 
> 赞同：0
> 
> 时间：2012-08-06T16:11:35.213
> 
> 标签：java, android, google-maps, itemizedoverlay

我正在尝试更改`OverlayItems`. `ItemizedOverlay`被`ItemizedOverlay`添加到 Android 中的 MapView 中。

如果我使用此代码，**所有**项目都具有相同的不透明度。
根据日志，这种情况大约达到了 50%...

有任何想法吗？`getMarker()`如果我覆盖其中的方法也无济于事`OverlayItem`。这是一样的效果。

如果我使用 2 个不同的可绘制对象（每种情况 1 个），这种方法**确实**有效……但我需要使用相同的可绘制对象。

```
for (OverlayItem overlay : overlays) {              
    Drawable marker = boundCenterBottom(context.getResources().getDrawable(markerId));
    if (/* some condition - about 50/50 */) {           
        marker.setAlpha(100);
        Log.d("itemized Overlay", "FILTER set marker to => " + marker);
    } else {
        Log.d("itemized Overlay", "NOFILT set marker to => " + marker);
    }

    overlay.setMarker(marker);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:59:57.693

您必须调用`mutate()`实例`Drawable`，否则它将共享状态。

就像 mutate() 的文档中所说的那样：

> [...] 可变可绘制对象保证不会与任何其他可绘制对象共享其状态。当您需要修改从资源加载的可绘制对象的属性时，这尤其有用。默认情况下，从同一资源加载的所有可绘制实例共享一个公共状态；如果您修改一个实例的状态，所有其他实例将收到相同的修改。[...]

很简单，它是这样工作的：

```
for (OverlayItem overlay : overlays) {              
    Drawable marker = boundCenterBottom(context.getResources().getDrawable(markerId));
    marker.mutate();
    if (/* some condition */) {           
        marker.setAlpha(100);
    }

    overlay.setMarker(marker);
} 
```

# android - Android - 与蓝牙子系统 (BlueZ) 通信

> ID：11832018
> 
> 赞同：5
> 
> 时间：2012-08-06T16:12:03.553
> 
> 标签：android, android-ndk, bluetooth, core-bluetooth

我正在寻找一种从我的 Android 智能手机（带有 Android 4.0.1 的 HTC Desire）进行定期蓝牙查询的方法。该设备已植根，它是安装的自定义 Rom，因此我拥有完全权限。我已经写了一个 shellscript，它使用 hcitool、hciconfig 和 hcidump 来进行查询。到目前为止效果很好，但对我来说有点慢。我想这是因为我使用 android-app 从 linux 执行 shellscript 的肮脏解决方法。虽然我通过我的应用程序杀死执行的进程遇到了问题。

所以我想找到一种从Android API查询BT设备的方法。我发现直到现在都没有可能这样做，但我读到了可能能够满足我的要求的 bluez API。有人对我有任何链接、提示或建议吗？

我没有发现任何有用的东西：/

提前致谢。

* * *

*编辑（2012-09-28）：*

好的，我想我现在更接近解决方案了。[我从bluez.org](http://www.bluez.org/)下载了 blueZ 库的源代码 然后我将重要文件（hci.h、bluetooth.h、hcilib.h 及其源文件）放入我的 android 项目的 jni 文件夹中，并将它们编译到我的共享库中。我围绕该函数编写了一个 JNI Wrapper

```
hci_inquiry(int dev_id, int len, int nrsp, const uint8_t *lap,inquiry_info **ii, long flags) 
```

并按照[这](http://people.csail.mit.edu/albert/bluez-intro/c404.html)本书的建议做我的调查。一切都很好，直到这里。

但是当我开始查询时，功能

```
 dev_id = hci_get_route(NULL); 
```

总是返回-1，我无法继续。

蓝牙已激活，我已经尝试授予对我的应用程序的 root 访问权限。不是更好:(

直到这里我做错了什么？是否允许从 Android 应用程序使用 BlueZ HCI 命令？我的意思是 JBlueZ 不做任何其他事情是吗？

我的本机代码如下所示：

```
inquiry_info *ii = NULL;
int max_rsp, num_rsp;
int dev_id, sock, len, flags;
int i;
char addr[19] = { 0 };
char name[248] = { 0 };

dev_id = hci_get_route(NULL);
if (dev_id < 0 ) {
    LOGI("ERROR ON finding Device ID");
    return;
}
sock = hci_open_dev( dev_id );
if (sock < 0) {
    LOGI("ERROR ON opening socket");
    return;
}

len  = 8;
max_rsp = 255;
flags = IREQ_CACHE_FLUSH;
ii = (inquiry_info*)malloc(max_rsp * sizeof(inquiry_info));

num_rsp = hci_inquiry(dev_id, len, max_rsp, NULL, &ii, flags);

//##################################################################################
LOGI("INQUIRY Executed!!!");

(*env)->CallVoidMethod(env, obj, callBackID, num_rsp);

free(ii);
close(sock); 
```

感谢您的任何帮助。

# javascript - 经典 asp - 下拉列表选择与第一个下拉列表具有相同值的所有下拉列表

> ID：11832020
> 
> 赞同：0
> 
> 时间：2012-08-06T16:12:09.157
> 
> 标签：javascript, ajax, dynamic-data, html.dropdownlistfor, array-population

我有一个包含三个值的主要下拉列表：1 - 选择 2 - 失败 3 - 通过

该页面是从数据库中填充的，因此您可以在此处使用从 1 到 50 的任何内容来将每条记录的状态设置为失败或通过。

我想从主下拉列表中选择“失败”，从数据库填充的任何下拉列表都应设置为我所做的选择为“失败”

希望有人可以提供帮助。谢谢亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:16:39.673

您可以使用`javascript`或执行此操作`jquery`。

`OnChange`在第一个下拉列表中，相应地选择所有下拉值。

## 编辑：

为了您的参考，我准备了一个例子。参考**[现场演示](http://jsfiddle.net/SivaCharan/gtd6U/)**

## HTML：

```
<select class="dDown">
    <option value="select">select</option>
    <option value="Pass">Pass</option>
    <option value="Fail">Fail</option>
</select>
<select>
    <option value="select">select</option>
    <option value="Pass">Pass</option>
    <option value="Fail">Fail</option>
</select>
<select>
    <option value="select">select</option>
    <option value="Pass">Pass</option>
    <option value="Fail">Fail</option>
</select>
​ 
```

## JS：

```
$('.dDown').on("change", function() {
    $('select').not('.dDown').val(this.value);
});​ 
```

# encryption - 为什么在 RSA/加密中使用“大素数”？

> ID：11832022
> 
> 赞同：12
> 
> 时间：2012-08-06T16:12:22.540
> 
> 标签：encryption, rsa, public-key

我已经学习了公钥加密的理论，但我错过了与物理世界的联系。例如

有人告诉我，良好的 RSA 加密应该依赖于 300 个十进制数字的素数，但为什么呢？这个数字是谁想出来的？破解这种加密需要多长时间（关于不同机器的统计数据）。

我试过谷歌，但找不到我想要的。任何人？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T16:33:02.563

非对称密码学的关键是具有非对称功能，允许解密由非对称密钥加密的消息，而不允许找到另一个密钥。在 RSA 中，使用的函数基于素数的因式分解，但它不是唯一的选择（例如，[椭圆曲线](http://en.wikipedia.org/wiki/Elliptic_curve_cryptography)是另一种选择）。

所以，基本上你需要两个素数来生成一个 RSA 密钥对。如果您能够分解公钥并找到这些质数，那么您将能够找到私钥。**RSA 的整体安全性是基于不容易分解大合数这一事实，这就是**为什么密钥的长度会极大地改变 RSA 算法的鲁棒性的原因。

每年都有比赛用计算器分解大素数，而且价格不错。分解 RSA 密钥的最后一步是[在**2009 年通过分解 768 位**](http://en.wikipedia.org/wiki/RSA_Factoring_Challenge)**密钥**完成的。这就是为什么现在至少应该使用 2048 位密钥的原因。

像往常一样，[维基百科](http://en.wikipedia.org/wiki/RSA_%28algorithm%29)是 RSA 的一个很好的参考。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-06T17:51:01.667

所有公钥算法都基于[陷门函数](http://en.wikipedia.org/wiki/Trapdoor_function)，即以一种方式“容易”计算但“难以”反转的数学结构，除非您还有一些额外的信息（用作私钥），此时也反向变得“容易”。

“简单”和“困难”只是定性形容词，它们总是根据[计算复杂性](http://en.wikipedia.org/wiki/Computational_complexity_theory)进行更正式的定义。“难”通常是指对于某些固定**x**并且其中**n**是输入数据的多项式时间**O(n ^x )**无法解决的计算。

 ****在 RSA 的情况下，“简单”函数是模幂*C = M ^e mod N ，其中**N*的因子是保密的。“困难”问题是找到C 的第*e*个根（即*M*）。当然，“难”并不意味着它*总是*很难，而是（直观地）将*N*的大小增加某个因子会使复杂度增加一个更大的因子。

推荐的模数大小（2048 位或 617 个十进制数字）与当前计算能力的可用性有关，因此如果您坚持使用它们，您可以放心，攻击者破解它的代价将非常高. 有关更多详细信息，我应该向您推荐[关于 cryptography.SE 的精彩答案](https://crypto.stackexchange.com/questions/1978/how-big-an-rsa-key-is-considered-secure-today/1982#1982)（去投票:-)）。

最后，为了有一个活板门，*N*被构建为一个合数。从理论上讲，为了提高性能，N 可能有超过 2 个因素，但一般的安全规则是所有因素必须平衡并且具有大致相同的大小。这意味着如果您有*K*个因子，并且*N*是*B*位长，则每个因子大约是*B/K*位长。

这个要解决的问题与[整数分解问题](http://en.wikipedia.org/wiki/Integer_factorization)不同。两者是相关的，如果您设法将*N*分解，您可以通过重新执行生成密钥的一方所做的事情来计算私钥。通常，使用的指数*e*非常小 (3)；不能排除有一天[有人](http://upload.wikimedia.org/wikipedia/en/thumb/1/16/Drevil_million_dollars.jpg/200px-Drevil_million_dollars.jpg)设计了一种算法来计算*e* -th 而不考虑*N*。

编辑：更正了 2048 位 RSA 密钥模数的十进制位数。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-06T16:47:41.810

RSA 使用单向数学函数的思想，因此如果您有密钥，则很容易加密和解密，但如果您没有密钥，则很难（因为它需要大量的 CPU 周期）解密。甚至在他们考虑使用素数之前，数学家就已经确定了对单向函数的需求。

他们想到的第一个方法是，如果您的“密钥”是质数，而您的消息是另一个数字，那么您可以通过将两者相乘来加密。有钥匙的人可以很容易地划分出质数并得到消息，但对于没有质数的人来说，找出质数的钥匙很难。****

# python - 当用户最初输入错误密码时，Fabric sudo() 捕获不正确的输出

> ID：11832025
> 
> 赞同：3
> 
> 时间：2012-08-06T16:12:30.310
> 
> 标签：python, sudo, fabric

考虑以下`sudo`使用 Fabric 的调用：

```
def ls():
    output = sudo('ls /tmp/', user = 'someone', shell = True)
    print "Output:", output 
```

执行此操作`fab`并在第一次提示您时输入*错误*`sudo`的密码。您将看到一条错误消息，并`sudo`再次要求您输入密码。第二次输入正确的密码。会话看起来像这样：

```
$ fab ls
[user@server] Executing task 'ls'
[user@server] sudo: ls /tmp/
[user@server] out: sudo password: 

[user@server] out: Sorry, try again.
[user@server] out: sudo password: 

[user@server] out: hsperfdata_someone

Output: Sorry, try again.

Done. 
```

注意 的值是输入错误密码时`output`打印的第一条消息`sudo`（“抱歉，重试。”）。它不包含随后的正确输出（“hsperfdata_someone”）。

难道我做错了什么？在这种情况下，有没有更好的方法来正确捕获输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:32:08.667

我会说这可能是一个需要报告的错误，但您可以查看[本节](http://docs.fabfile.org/en/1.4.3/usage/interactivity.html#combining-the-two)以尝试一些不同的组合。

# objective-c - 使用一个 UIViewController 来添加和更新记录是一种好习惯吗？

> ID：11832026
> 
> 赞同：1
> 
> 时间：2012-08-06T16:12:32.150
> 
> 标签：objective-c, ios, uiviewcontroller

我正在为 iPad 开发一个应用程序。我有一个表单（UIViewController）用于向我的 sqlite3 数据库添加新记录（Person 类型）。

对于更新（即修改）记录，我正在考虑使用相同的 UIViewController，但我想知道什么更好：一个 UIViewController 用于添加，另一个用于更新，或者一个 UIViewController 用于添加和更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:31:35.470

这取决于重叠的数量。

如果更新一条记录提供与创建一条记录相同的所有信息，那么代码行数将更少，重复更少，因此如果只有一个视图控制器，则更易于维护。

您甚至可以使用同一个视图控制器拥有两个不同的故事板视图。这将使您在创建或更新记录时具有不同的外观。我认为对于不同的操作有明显的视觉差异是很好的。它为用户提供了关于他们当前正在执行的操作的视觉线索。

另一方面，如果更新记录时有不同的业务规则，或者创建新记录时有不同的工作流程，那么两个视图控制器可能会阻止大量分支代码，从而降低认知复杂性。

在这种情况下，您可能需要考虑从另一个视图控制器中继承一个视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:32:02.270

这个问题有点模糊。让我检查一下我的理解：

*   您正在用 Obj-C 编写代码，其中涉及一种称为`Person`包含一些信息的类型
*   您有一个表单，人们通过该表单填写 type 中的信息`Person`。
*   然后，您可以帮助该人发出某种“更新”通知，以便他们知道您在努力工作，而不是在努力工作。

您的问题是，您应该使用一个`UIViewController`用于表单，一个用于更新通知，还是使用一个涵盖两种情况的，对吗？

如果这是您的问题，我会回答这主要是口味问题，但您可能不需要全新`UIViewController`的更新通知。我什至不相信您需要不同的视图，更不用说它的控制器了。您*可以*按照自己的喜好进行操作，但我建议您使用最简单的选项来满足您的需求。

# c# - Silverlight DataGrid SelectedItems.Add 非常慢

> ID：11832029
> 
> 赞同：3
> 
> 时间：2012-08-06T16:12:42.243
> 
> 标签：c#, performance, silverlight, datagrid, mvvm-light

我正在开发一个基于 DataGrid 的自定义控件，它具有自己独特的功能，但还包括一些按钮，这些按钮将在使用时随控件一起提供。这些按钮实现过滤器、全选和清除选择。我对后两者有性能问题。

这是响应 MVVMLight 消息的代码，该消息指示提供的对象列表需要切换其选择。对于 SelectAll 和 ClearSelection，我使用 Linq 函数来获取适当的点列表。我知道慢速部分在 foreach 循环中是一个事实。循环上方和下方的代码更改了自定义控件的状态，以便忽略与选择有关的其他函数。

```
 SelectionChanged -= GridSelectionChanged;
            _isUpdating = true;
            var points = obj.Content;
            foreach (var point in points)
            {
                if (point.IsSelected)
                {
                    SelectedItems.Add(point);
                }
                if (!point.IsSelected)
                {
                    SelectedItems.Remove(point);
                }
            }
            _isUpdating = false;
            SelectionChanged += GridSelectionChanged; 
```

Ctrl+A 的效果非常好，这让人倍感沮丧。这都是因为 SelectedItems.add/remove 很慢吗？有没有办法解决这个问题？

让我知道是否需要更多信息。谢谢。

# crystal-reports - 在另一个部分重复组页脚

> ID：11832032
> 
> 赞同：1
> 
> 时间：2012-08-06T16:12:48.220
> 
> 标签：crystal-reports

我有一个显示信用卡批次的水晶报告。它的数据源包含一堆信用卡交易，每笔交易都有一个批号和卡类型。报告首先按批号分组，然后按卡片类型分组。在每个卡类型组的末尾，它显示为该卡类型结算的总金额。显示所有卡片类型组后，将显示批次组页脚。这是一个例子：

```
Batch 1
 Visa
   Transaction1    $100
   Transaction2    $243

   Visa Total      $343
 AmEx
   Transaction1    $543
   Transaction2    $234
   Transaction3    $49

   Amex Total      $826

   Batch Total     $1169

Batch 2
 .... 
```

现在客户要求查看每张卡的总和高于每批次的总和。例如

```
 Batch 1
 Visa
   Transaction1    $100
   Transaction2    $243

   Visa Total      $343
 AmEx
   Transaction1    $543
   Transaction2    $234
   Transaction3    $49

   Amex Total      $826

   Visa Total      $343
   Amex Total      $826
   Batch Total     $1169

Batch 2
 .... 
```

一个问题是，我事先不知道会有哪些卡片类型，因此它们不能硬编码到报告中。如果没有 Visa 交易，Visa Total 行不应显示或占用任何空间。如果稍后，一张 Diners 卡被接受，它应该在不编辑报告的情况下显示。

必须创建子报表并产生额外开销才能显示已计算的值似乎很愚蠢。还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:57:44.450

最简单的方法是我认为使用将按批次返回摘要的子报表。

# php - php下拉检测选择

> ID：11832043
> 
> 赞同：0
> 
> 时间：2012-08-06T16:13:23.243
> 
> 标签：php

我有一个出生日期，当用户超过 2 月 (02) 时，日子应该只到 29 岁。如您所见，我`$month="1"`只是用来测试它。我应该只使用 PHP，没有 JavaScript 或其他任何东西。我该怎么做呢？

```
<?php
$month="1"; // <-- currently using this to make it 29,30 or 31 days

print "<select name='day'>";
if  ($month==1){
    for ($i=0; $i<=28; $i++)    
    {
        $day = 1 + $i;
        print "<option value = $day>" . $day ."</option>";
    }
}
if  ($month==2){
    for ($i=0; $i<=29; $i++)
    {
        $day = 1 + $i;
        print "<option value = $day>" . $day ."</option>";
    }
}

print "</select>";

print "<select name='month'>";
for ($i=0; $i<=11; $i++)
{

    $month = 1 + $i;
    print "<option value = $month>" .$month ."</option>";
}
print "</select>"; 
```

?>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:15:48.240

一旦 PHP 将内容发送到浏览器，*它就完成了*。它不会以任何方式影响页面。

另一方面，JavaScript 在浏览器获取页面时接管。它可以更改页面，甚至可以要求服务器做一些事情（在这种情况下 PHP 可能会参与其中）。

换句话说，如果没有 JavaScript，您将无法完成您所要求的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:17:07.220

没有Javascript，这是不可能的。

# asp.net-mvc - asp.net mvc3 razor 语法通过反射将模型转换为其子类

> ID：11832044
> 
> 赞同：2
> 
> 时间：2012-08-06T16:13:24.993
> 
> 标签：asp.net-mvc, asp.net-mvc-3, reflection, razor, casting

我有一个非常简单的问题，我找不到答案。在剃刀视图中有一个接口类型的模型。该接口有多个实现它的子类。问题是：*如何将模型转换为实际类型*？我**必须**有实际类型的变量，但不知道如何从反射 IE 中获取它

```
@model IInterface
@{
   var actualType1 = Model as Model.GetType(); // doesn't work :(
   var actualType2 = (Model.GetType()) Model; // doesn't work :(
} 
```

正如您可以想象的那样，我不感兴趣，`Model as ActualType`或者`(ActualType) Model`因为我不知道提前会出现什么实际类型。这是一个关于技术而不是架构的问题。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:28:06.287

你在这里真的走错了路。你不能在这里真正做你想做的事情，因为你并没有真正考虑清楚。像这样的声明：

```
var actualType1 = Model as Model.GetType(); 
```

不起作用，因为 var 不是动态类型，它是在编译时而不是在运行时键入的静态类型。因此，即使您可以设法让它工作，它也只能用于一种类型（直到它再次重新编译）。

除此之外，接口是一个糟糕的选择，因为接口属性与实现属性是分开的。因此，无论您的类有什么属性，您都不会通过该类的接口获取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:25:28.560

根据您的 OP 评论，听起来您有一些数据注释问题。我强烈建议完全重新创建一些使用[MetadataType](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.metadatatypeattribute.aspx)的模型和接口。

```
public SomeViewModel
{
  public string FormField { get; set; }
  public string FormField2 { get; set; }
}

public interface IAnonymousSomeViewModel
{
  [Required]
  public string FormField { get; set; }
  [Scaffold(false)]
  public string FormField2 { get; set; }
}

public interface IUserSomeViewModel
{
  [Scaffold(false)]
  public string FormField { get; set; }
  [Required]
  public string FormField2 { get; set; }
}

[MetadataType(typeof(IAnonymousSomeVieModel)]
public AnonymousViewModel : SomeViewModel { }

[MetadataType(typeof(IUserSomeVieModel)]
public UserViewModel : SomeViewModel { } 
```

在您的视图中，您通过`AnonymousViewModel`or `UserViewModel`，则视图中没有逻辑：

```
@model SomeViewModel

@Html.EditorFor(m => m.FormField)

@Html.EditorFor(m => m.FormField2) 
```

# python - 根据 RGB 值更改图像的颜色

> ID：11832055
> 
> 赞同：7
> 
> 时间：2012-08-06T16:14:03.273
> 
> 标签：python, image-processing, image-manipulation, python-imaging-library

## 情况：

您有一个具有 1 种主要颜色的图像，您需要根据给定的 rgb 值将其转换为另一个。

## 问题：

该颜色有许多不同但相似的阴影也需要转换，这使得简单的“将所有（0,0,0）像素更改为（0,100,200）”解决方案毫无价值。

如果有人能指出我正确的方向，就可以使这项任务更易于管理的算法或图像处理技术，那就太好了。

我一直在使用 PIL 来尝试这个问题，但任何一般提示都会很好。

编辑：

另外，我使用了另一个 SO 答案（[使用 Python PIL 更改图像色调](https://stackoverflow.com/questions/7274221/changing-image-hue-with-python-pil)）来完成我所要求的部分内容（色调变化），但它没有考虑饱和度或值

编辑：[http](http://dpaste.org/psk5C/) ://dpaste.org/psk5C/显示使用 pil 查看我必须使用的 rgb 值以及与之相关的 hsv。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T18:03:49.550

参考链接问题中的解决方案：您可以调整`shift_hue()`功能以调整色调，饱和度和值，而不仅仅是色调。然后，您应该可以随意更改所有这些参数。

原来的：

```
def shift_hue(arr, hout):
    r, g, b, a = np.rollaxis(arr, axis=-1)
    h, s, v = rgb_to_hsv(r, g, b)
    h = hout
    r, g, b = hsv_to_rgb(h, s, v)
    arr = np.dstack((r, g, b, a))
    return arr 
```

调整版：

```
def shift_hsv(arr, delta_h, delta_, delta_v):
    r, g, b, a = np.rollaxis(arr, axis=-1)
    h, s, v = rgb_to_hsv(r, g, b)
    h += delta_h
    s += delta_s
    v += delta_v
    r, g, b = hsv_to_rgb(h, s, v)
    arr = np.dstack((r, g, b, a))
    return arr 
```

假设您知道原始图像的基色和所需的目标颜色，您可以轻松计算增量：

```
base_h, base_s, base_v = rgb_to_hsv(base_r, base_g, base_b)
target_h, target_s, target_v = rgb_to_hsv(target_r, target_g, target_b)
delta_h, delta_s, delta_v  = target_h - base_h, target_s - base_s, target_v - base_v 
```

# android - 我可以更改操作栏项目上的图标吗

> ID：11832059
> 
> 赞同：2
> 
> 时间：2012-08-06T16:14:23.820
> 
> 标签：android, android-actionbar

我不是想改变主 Icon ，只是一个菜单项的图标。

该图标本质上是显示我当时是否正在录制。我在使用时更改图标

```
item.setIcon(R.drawable.recordstart); 
```

在这个方法中。

```
public boolean onOptionsItemSelected(MenuItem item) {
    ...
    } else if (item.getItemId() == R.id.ab_menu_VRecord) {

        if(recording)
                    {
                       item.setIcon(R.drawable.recordstop);
                    }else{
                       item.setIcon(R.drawable.recordstart);
                    }

        }

        return true;
    } else {
        return super.onOptionsItemSelected(item);
    }
} 
```

任何人都知道我如何在这种方法之外做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:34:13.583

例子：

```
class {

    public MenuItem example;

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.actionbar, menu);       
        example = menu.findItem(R.id.ab_menu_exampleview);
        return true;
    }
} 
```

然后在你的课堂上你可以使用

```
example.setIcon("Your Image"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:16:37.717

不是 100% 确定要更改图标的位置，但您当然可以缓存或创建一个类成员变量，并将其指向 Activity 或 Fragment 中的 MenuItem。在他们单击它或将其膨胀后，将其分配给成员变量，当您需要更改它时，您有一个引用或“缓存”指针指向它以更改图标。

我认为这是 UI 更改，因此您可能必须确保仅在 UI 线程上调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T04:55:54.000

```
if(!item.isChecked()){
    item.setChecked(true);
    item.setIcon(R.drawable.icon1);
}else{
    item.setChecked(false);
    item.setIcon(R.drawable.icon2);
} 
```

这是？

# azure - ACS 服务命名空间创建是否可以自动化？

> ID：11832065
> 
> 赞同：0
> 
> 时间：2012-08-06T16:15:03.743
> 
> 标签：azure, wif, acs

首先，让我陈述我*真正的*问题：我有调用 ACS 管理服务的代码，并且我希望我的集成测试能够同时运行，而每个测试运行不会影响其他测试运行。也就是说，由于多个人/构建服务器可能最终同时运行这些测试，如果他们都使用相同的 ACS 服务命名空间，则会出现并发问题。

我的想法是实现这一目标的最简单方法是为每个测试运行程序生成新的、唯一的 ACS 服务命名空间——但据我所知，没有自动创建新服务命名空间（或管理客户端密钥）的方法。我错了吗？还有另一种解决方法吗？

创建新服务命名空间的自动化方法将非常有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T11:33:53.510

从技术上讲，这应该是可能的，因为管理门户是一个访问 WCF RIA 服务的 Silverlight 应用程序。

如果你深入挖掘，你会发现一些有用的信息：

*   这是用于管理 Windows Azure AppFabric 的 Silverlight XAP：[https ://appfabricportal.windows.azure.com/ClientBin/Microsoft.AppFabric.WebConsole.4.1.3.xap](https://appfabricportal.windows.azure.com/ClientBin/Microsoft.AppFabric.WebConsole.4.1.3.xap)
*   这是列出/创建/...命名空间等时使用的服务：[https ://appfabricportal.windows.azure.com/Services/Microsoft-AppFabric-Web-Services-AppFabricDomainService.svc?wsdl](https://appfabricportal.windows.azure.com/Services/Microsoft-AppFabric-Web-Services-AppFabricDomainService.svc?wsdl)

这是 DomainContext 的一部分：

```
 public sealed class AppFabricDomainContext : DomainContext
  {

    public AppFabricDomainContext(Uri serviceUri)
      : this((DomainClient) new WebDomainClient<AppFabricDomainContext.IAppFabricDomainServiceContract>(serviceUri, true))
    {
    }

    ...

    public InvokeOperation CreateServiceNamespace(IEnumerable<string> serviceNames, string parentProjectKey, string serviceNamespace, IEnumerable<string> packageKeys, string regionKey, Action<InvokeOperation> callback, object userState)
    {
      Dictionary<string, object> dictionary = new Dictionary<string, object>();
      dictionary.Add("serviceNames", (object) serviceNames);
      dictionary.Add("parentProjectKey", (object) parentProjectKey);
      dictionary.Add("serviceNamespace", (object) serviceNamespace);
      dictionary.Add("packageKeys", (object) packageKeys);
      dictionary.Add("regionKey", (object) regionKey);
      this.ValidateMethod("CreateServiceNamespace", (IDictionary<string, object>) dictionary);
      return this.InvokeOperation("CreateServiceNamespace", typeof (void), (IDictionary<string, object>) dictionary, true, callback, userState);
    }
  } 
```

找到这个信息是很容易的部分，让它工作......那是另一回事。以身份验证部分为例，您需要使用 Windows Live 进行身份验证，并在调用 WCF RIA 服务时使用这些凭据。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:03:53.183

你是对的。这在今天是不可能的。也许您可以更详细地描述您的场景，并且可能有一些替代解决方案可以避免重新创建命名空间？

# caching - 缓存激活时地理服务器层移位

> ID：11832068
> 
> 赞同：1
> 
> 时间：2012-08-06T16:15:19.313
> 
> 标签：caching, openlayers, geoserver, map-projections

我试图解决一个问题几天，我什至无法找到 geoserver 行为的原因。我有一个 Web 应用程序，它通过 openlayers 从我的地理服务器（版本 2.1.3）打印一些地图图层。我在我的地理服务器应用程序中配置了所有图层，并且这些图层由 openlayers 使用投影 900913 很好地绘制。

当我尝试从直接从我的地理服务器获取图层图像更改为通过地理服务器分发中包含的 geowebcache 获取图层时出现问题（在请求中添加参数“&tiled=true”）。

然后也获得了这些层，但从原始位置偏移了几公里。

也许它使用不同的投影，但在地理服务器日志中我看到它正在使用 900913 投影调用请求。我还擦除了可以找到缓存文件的 geowebcache 的临时目录，以强制 geowebcache 重绘图层缓存文件。但它用同样的问题重绘它们。

是否有人遇到过这个问题或知道使用缓存层时该层位移的原因是什么？

非常感谢，阿莱克斯

编辑：我在 StackExchange 社区的 GIS 站点中看到以下帖子中存在相同的问题，尽管它没有得到回答......（http://gis.stackexchange.com/questions/4289/geowebcache-misalignment-of -瓷砖）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:49:00.763

如果您想真正使用 GWC，请点击 GWC 自己的 WMS 服务，它还会告诉您您发出的请求是否与缓存的网格相比发生了位移： `http://localhost:8080/geoserver/gwc/service/wms?...`

# android - 以 Intent 方式打开浏览器，但不要将其保留在 Activity 堆栈中

> ID：11832074
> 
> 赞同：1
> 
> 时间：2012-08-06T16:15:28.447
> 
> 标签：android, browser, android-intent, activity-stack

我在理解活动堆栈以及它如何影响我的应用程序的行为方面遇到了一些问题。

单击按钮后，它会启动一个打开浏览器的 Intent。当我在浏览器中并按下主页按钮时，我会进入主屏幕。现在，如果我通过启动器再次启动我的应用程序，它会打开浏览器而不是我的应用程序。如何避免在启动我的应用程序时打开浏览器？

现在，打开 url 的代码如下所示：

```
private void openUrlExternal(String url) {
    Intent openUrlIntent = new Intent(Intent.ACTION_VIEW);
    openUrlIntent.setFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
    openUrlIntent.setData(Uri.parse(url));
    startActivity(openUrlIntent);
} 
```

我使用了错误的标志吗？如果是这样，我必须使用哪些标志？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:30:33.683

试试这样：

```
openUrlIntent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
openUrlIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

这应该将浏览器任务与您自己的任务解除关联，这意味着当您重新启动您的任务时，它应该转到您的 Activity 而不是浏览器。

但是，它还取决于您从哪里调用 openUrlExternal() 。如果您在活动启动时调用它，它仍然会将您带回浏览器，但如果您从事件侦听器（即按钮单击）调用它，那么当您重新启动应用程序时不应调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-29T18:22:05.250

我认为接受的答案并不完全正确。这取决于您打算做什么（不是双关语，呵呵）。

使用`Intent.FLAG_ACTIVITY_NEW_TASK`它意味着启动的活动与启动的活动完全分开。特别是，您可以使用“应用程序”按钮切换到旧活动，而无需退出新活动。

Using`Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET`意味着用户从应用程序抽屉启动时将返回到上一个活动。

在这两种情况下，再次启动应用程序都会让您进入上一个活动。主要区别在于两个活动（或仅最后一个活动）是否显示在应用切换器中。

# java - 将一个类转换为另一个类的设计模式

> ID：11832076
> 
> 赞同：47
> 
> 时间：2012-08-06T16:15:32.280
> 
> 标签：java

我有一个名为 GoogleWeather 的类，我想将它转换为另一个类 CustomWeather。

是否有任何设计模式可以帮助您转换类？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-06T16:20:44.727

在那种情况下，我会使用带有一堆静态方法的 Mapper 类：

```
public final class Mapper {

   public static GoogleWeather from(CustomWeather customWeather) {
      GoogleWeather weather = new GoogleWeather();
      // set the properties based on customWeather
      return weather;
   }

   public static CustomWeather from(GoogleWeather googleWeather) {
      CustomWeather weather = new CustomWeather();
      // set the properties based on googleWeather
      return weather;
   }
} 
```

所以你在类之间没有依赖关系。

示例用法：

```
CustomWeather weather = Mapper.from(getGoogleWeather()); 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-08-06T19:57:44.387

需要做出一个关键决定：

*您是否需要转换生成的对象来反映对源对象的未来更改？*

如果您不需要此类功能，那么最简单的方法是使用具有静态方法的实用程序类，该方法根据源对象的字段创建新对象，如其他答案中所述。

另一方面，如果您需要转换后的对象来反映对源对象的更改，您可能需要一些符合[适配器设计模式](http://en.wikipedia.org/wiki/Adapter_pattern)的东西：

```
public class GoogleWeather {
    ...
    public int getTemperatureCelcius() {
        ...
    }
    ...
}

public interface CustomWeather {
    ...
    public int getTemperatureKelvin();
    ...
}

public class GoogleWeatherAdapter implements CustomWeather {
    private GoogleWeather weather;
    ...
    public int getTemperatureKelvin() {
        return this.weather.getTemperatureCelcius() + 273;
    }
    ...
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-30T16:58:27.020

此外，您还可以使用来自 java.util.function 的新 Java8 功能 'Function'。

[http://www.leveluplunch.com/java/tutorials/016-transform-object-class-into-another-type-java8/](http://www.leveluplunch.com/java/tutorials/016-transform-object-class-into-another-type-java8/)中提供了更详细的解释。请看一看！

# mit-scheme - 带有 mit-scheme 的 slimv 中的未绑定变量错误

> ID：11832077
> 
> 赞同：1
> 
> 时间：2012-08-06T16:15:37.797
> 
> 标签：mit-scheme, slimv

尝试从 vim 启动 swank 服务器后（或执行命令后

方案 --load /usr/share/emacs/site-lisp/slime/contrib/swank-mit-scheme.scm

从终端提示符）我收到以下错误：

```
Image saved on Tuesday November 8, 2011 at 10:40:30 PM
  Release 9.1.1 || Microcode 15.3  || Runtime 15.7 
  SF 4.41       || LIAR/i386 4.118 || Edwin 3.116

;Loading "/usr/share/emacs/site-lisp/slime/contrib/swank-mit-scheme.scm"...
;Unbound variable: o
;To continue, call RESTART with an option number:
; (RESTART 3) => Specify a value to use instead of o.
; (RESTART 2) => Define o to a given value.
; (RESTART 1) => Return to read-eval-print level 1. 
```

似乎该错误是由以下行引起的：

```
(define-generic inspect (o)) 
```

有什么想法我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:29:38.317

尝试运行嵌入在 Slimv 中的 swank-mit-scheme.scm。它稍作修改：它加载选项并在无限循环中运行 swank 服务器。

# android - 在 Eclipse 中弹出错误提示“传输错误：只读文件系统”

> ID：11832089
> 
> 赞同：1
> 
> 时间：2012-08-06T16:16:27.397
> 
> 标签：android, eclipse, sd-card

我是一名 android 新手，正在尝试通过 android Eclipse 显示离线地图。

当我尝试在文件资源管理器中将地图文件推送到 android SD 卡上时，我一开始就收到一个错误，上面写着：
`transfer error:read only file system, Failed to push selection: Read-only file system`

我检查了文件的只读属性没有设置。

关于可能出了什么问题的任何线索？

# c# - 有条件的 Where 过滤器是否使用延迟执行？

> ID：11832093
> 
> 赞同：3
> 
> 时间：2012-08-06T16:16:43.943
> 
> 标签：c#, linq

如果我有表格查询

```
var query = from items in entityDb.TableName
            join requestedBy in entityDb.People on items.RequestedById equals requestedBy.PersonId in requestedByOuter
            from requestedBy in requestedByOuter.DefaultIfEmpty()
            select items; 
```

还假设这是一个大查询，还有 10 个连接。然后我有一个条件过滤器

```
if (!string.IsNullOrEmpty(phaseFilter))
{
   query = query.Where(item => item.Phase == phaseFilter);
} 
```

在这一点上，我相信我已经失去了延迟执行的优势。如果有 1000 条结果，这可能会损害性能。考虑到我的查询实际上是 50 行代码，我宁愿不去...

```
if(phaseFilter not null)
  //50 lines....
else if(filter2 not null)
  //50 lines...
else if (filter2 not null and phaseFilter not null)
  //50 lines... 
```

啊。我可以以某种方式拥有我的蛋糕并吃掉它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T16:19:16.970

不，你不会失去它。执行仍然被推迟，因为`.Where`只返回一个`IEnumerable<T>`过滤`IEnumerable<T>`传递给它的过滤器，并且当你这样做时它仍然被推迟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T16:18:35.453

不，您的案件不会失去延期执行。

您可以通过多次`IQueryable`调用来修改 ，并在您枚举时执行实际查询。`Where``IQueryable`

以上适用于其他方法，`OrderBy`例如。

# jquery - bpopup 插件只弹出一次

> ID：11832097
> 
> 赞同：0
> 
> 时间：2012-08-06T16:17:00.243
> 
> 标签：jquery, jquery-click-event, bpopup

我正在使用 jquery bpopup 插件。我想对页面上的所有按钮/弹出窗口使用相同的脚本。不幸的是，每个按钮点击在页面加载后只能工作一次。我会非常感谢你的帮助！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src="http://dinbror.dk/downloads/jquery.bpopup-0.7.0.min.js" type="text/javascript"></script>

    <script language="javascript" type="text/javascript">
    $(document).ready(function() {  
        $('.button').live('click', function(e) { 

            // Prevents the default action to be triggered. 
            e.preventDefault();

            // Triggering bPopup when click event is fired
            $(this).find('.popup').bPopup({

            });

        });

    });
    </script>

    </head>
    <body>
        <!-- Button 1 -->
        <div class="button">Button1
        <div class="popup" style="background-color:#fff; width:400px; height:400px; display:none">
            PopUp Content1
            </div>
        </div>

                <!-- Button 2 -->
        <div class="button">Button2
            <div class="popup" style="background-color:#fff; width:400px; height:400px; display:none">
            PopUp Content2
            </div>
        </div>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:21:02.793

应用单击文档以及 .button 类的过滤器。建议使用`on`而不是`Live`已弃用。

**[现场演示](http://jsfiddle.net/rajaadil/nUdnc/)**

```
$(document).ready(function() {

    $(document).on('click', '.button', function(e) { 
        e.preventDefault();

        // Triggering bPopup when click event is fired
        $(this).find('.popup').bPopup({

        });            
    });

});​ 
```

**根据有关原始帖子的评论中的讨论进行编辑。**

jquery`bpopup`库用于创建弹出窗口。该库对 dom 进行更改并将弹出 div 从其位置移动，这会导致下一次弹出失败。这可以在[**这里看到**](http://jsfiddle.net/rajaadil/nUdnc/12/)

我已经更改了 html 和 javascript 来处理`bpopup`. 这可以在**[这里](http://jsfiddle.net/rajaadil/nUdnc/14/)**看到。进行这些更改是为了使其运行，并且可以根据要求进行调整。

**[现场演示](http://jsfiddle.net/rajaadil/nUdnc/14/)**

**更新的 HTML**

```
 <!-- Button 1 -->
    <div id="button1" class="button">Button1</div>
       <div class="popup" style="background-color:#fff; width:400px; height:400px; display:non">
        PopUp Content1
        </div>
    <!-- Button 2 -->
    <div id="button2" class="button">Button2</div>
    <div  class="popup" style="background-color:#fff; width:400px; height:400px; display:none;">
        PopUp Content2
    </div> 
```

更新 **的 Javascript**

```
$(document).ready(function() {

    $(document).on('click', '.button', function(e) {
        e.preventDefault();

        if ($(this).next('.popup').length == 1) {
            $(this).next('.popup').attr('attachedbutton', $(this).attr('id'));
            $(this).next('.popup').bPopup({
            });
        }
        else {
                $('body').parent().find("'.popup[attachedbutton=" + this.id + "]'").bPopup({
                 });
        }
    });
});​ 
```

# mod-rewrite - 无法将子域重定向到文件夹

> ID：11832099
> 
> 赞同：0
> 
> 时间：2012-08-06T16:17:16.373
> 
> 标签：mod-rewrite, subdomain, vhosts, wildcard-subdomain

我有这个工作：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.co\.uk
RewriteRule ^(.*) http://domain.co.uk/%1 [L] 
```

所以它会将 test.domain.co.uk 重定向到 test.domain.co.uk/test

但是，我希望它更改文档根目录而不是用户看到重定向。我在这里阅读了几篇文章并尝试了一些事情。但我不确定如何调试任何错误，它只是不起作用。我尝试过的另一个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI} !^/-
RewriteCond %{HTTP_HOST} ^([^\./]+)
RewriteCond %{DOCUMENT_ROOT}/-%1 -d
RewriteRule ^(.*)$ -%1/$1 [L] 
```

但这似乎根本不起作用。

任何帮助，将不胜感激。

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:36:13.177

在您的文档根目录中尝试这样的操作：

```
RewriteEngine On

# check if subdomain folder has the existing file, if so, serve it
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.co\.uk
RewriteCond %{DOCUMENT_ROOT}/%1%{REQUEST_URI} -f
RewriteRule ^(.*)$ /%1/$1 [L] 

# check if subdomain folder has the existing directory WITH A TRAILING SLASH, if so serve it
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.co\.uk
RewriteCond %{DOCUMENT_ROOT}/%1%{REQUEST_URI} -d
RewriteRule ^(.*?)/$ /%1/$1/ [L] 

# check if subdomain filder has the existing directory but missing trailing slash, redirect with it
RewriteCond %{REQUEST_URI} !/$
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.co\.uk
RewriteCond %{DOCUMENT_ROOT}/%1%{REQUEST_URI} -d
RewriteRule ^(.*)$ /$1/ [R=301,L] 
```

这个方法为你做了两件事，如果是 404，它不会尝试在内部重写，所以如果你去：`http://sub.domain.co.uk/this/path/does/not/exist/blah`，你不会收到 404 消息说：`/sub/this/path/does/not/exist/blah`不存在，只是`/this/path/does/not/exist/blah`因为 URI 是' t 重写，因此不会暴露您的底层目录结构。

第二件事是你可能已经`DirectorySlash`打开了。这意味着如果您访问类似的目录：`http://sub.domain.co.uk/this/path`，缺少尾部斜杠， mod_dir 将希望重定向并添加该斜杠，但它可能会做错，因为 URI 已被重写并将您重定向到：`http://sub.domain.co.uk/sub/this/path/`。我们先发制人地添加带有正确 URI 的尾部斜杠，隐藏`sub`.

# database - 如何通过检查 Joomla 中的某些功能定期发送电子邮件？

> ID：11832103
> 
> 赞同：0
> 
> 时间：2012-08-06T16:17:27.170
> 
> 标签：database, email, scripting, joomla

我有一个包含一些发布结束日期的项目列表，我想检查日期是否已过。如果已超过系统日期，则应向该项目的所有者发送一封信息电子邮件。不登录网站怎么办？我猜数据库端脚本是必要的，但它应该如何与 joomla 结合使用？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:42:18.167

据我所知，没有扩展可以做这样的事情，所以我们编写了每晚自动运行的自定义脚本。简而言之，我们安排 PHP CLI 来运行我们的 PHP 脚本。该脚本选择符合条件的文章，然后构建一个电子邮件，并使用 phpMailer 发送它。

它对我们来说非常有效，因为它不依赖于访问者加载 Joomla 站点中的页面来触发要执行的代码。

更新：
有关计划 PHP 的详细信息，请参阅[如何在计划任务中运行 PHP 文件（Windows 任务计划程序）](https://stackoverflow.com/questions/295386/how-to-run-a-php-file-in-a-scheduled-task-windows-task-scheduler)。
有关将 Joomla 函数包含到计划的 PHP 脚本中的详细信息，请参阅[使用 Ajax 查询的 joomla 组件开发](https://stackoverflow.com/questions/11454226/joomla-component-development-with-ajax-queries/11455748#11455748)
Joomla 教程/文档在[如何使用 Joomla 创建独立应用程序！平台](http://docs.joomla.org/How_to_create_a_stand-alone_application_using_the_Joomla!_Platform)

# css - CSS letter-spacing and proportional fonts

> ID：11832111
> 
> 赞同：4
> 
> 时间：2012-08-06T16:18:06.000
> 
> 标签：css, readability, typography, letter-spacing

So I know that my question is pretty technical, but basically I would like to know specifically how the following CSS affects the display of text in `<p>` tags.

```
p {
letter-spacing:2px;
font-family:"Georgia";
} 
```

I know that Georgia is a proportional font, that the designer has spent time crafting the spaces between letters to make the font more readable and visually pleasing.

But my question is how does the letter-spacing property affect this proportionality? Does this code *add* two pixels onto the spacing already defined by the type designer, or does it *reset* that spacing to two pixels?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:21:04.367

This property is additive to what the font would normally use. So, 1px will increase it by a pixel. [Sitepoint](http://reference.sitepoint.com/css/letter-spacing) calls it "extra" space (with negative values allowed).

The [W3C docs](http://www.w3.org/TR/1998/REC-CSS2-19980512/text.html#spacing-props) say the same thing:

> "This value indicates inter-character space in addition to the default space between characters. Values may be negative..."

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:22:44.587

It is in addition to any default spacing.

See: [https://developer.mozilla.org/en-US/docs/CSS/letter-spacing](https://developer.mozilla.org/en-US/docs/CSS/letter-spacing)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T16:25:33.123

From my experiment on Firefox on OSX, using a kerned font (Arial) as opposed to Georgia which does not appear to have kerning on my machine, I can testify that the spacing is in addition to existing spacing, and kerning, and can be either additive, or subtractive.

It is also worth mentioning that different browsers and operating systems replace fonts, and handle them slightly differently to each other, making it impossible to predict 100% how any font will be rendered.

# php - 为具有特殊字符的 excel 创建 CSV 文件

> ID：11832112
> 
> 赞同：1
> 
> 时间：2012-08-06T16:18:08.487
> 
> 标签：php, excel, csv, utf-8

我创建了一个简单的 PHP 脚本作为测试。我想让 PHP 从一些数据中保存一个 csv。这个脚本有效，但是当我在 Excel 中打开它时，特殊字符是乱码。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Character Test</title>
</head>

<body>
<ul>
<?php
$spanishDept = array('Swimwear'=>'Trajes de baῆo','Boys Swimwear'=>'Trajes de baῆo','Girls Swimwear'=>'Trajes de baῆo','Kids Shoes'=>'Zapatos de niῆos',"Scarves"=>'Paῆoletas','Children\'s'=>'Niῆos','Coffee Mugs'=>'Tasas para café');

$list = '"Item","Spanish"'."\r";
foreach($spanishDept AS $english=>$spanish) {
        echo '<li>'.$english.': '.$spanish.'</li>';
        $list .= '"'.$english.'","'.$spanish."\"\r";
}
$fp = fopen('theEXCELlist.csv',"w+");
fwrite($fp,$list,strlen($list)+100);
?>
</ul>
</body>
</html> 
```

我可以在 NotePad++ 或 Dreamweaver 中打开它，一切都很好，但在 Excel 中不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:19:48.523

也许这个问题的解决方案在于 PHP 手册的“[多字节字符串函数](http://php.net/manual/en/ref.mbstring.php#50298)”部分。
换句话说，PHP 输出文件似乎应该是一个 UTF-16 little endian 编码的文件（带有 BOM）。
我不知道您使用的是哪个版本的 Excel，但[这篇文章](http://www.the-art-of-web.com/php/dataexport/#section_6)可能很有用。
另一种方法是打开 Excel，插入特殊字符，另存为 CSV，最后检查这些字符在输出文件中的编码方式。

# java - 在 Map 中添加两次相同的键

> ID：11832113
> 
> 赞同：9
> 
> 时间：2012-08-06T16:18:20.540
> 
> 标签：java, collections, hashmap

我正在对`Map`s 进行研究，我发现如果我故意添加两次相同的键，那么 Map 的大小保持不变。这背后的技术原因是什么？

```
 Map map=new HashMap();//HashMap key random order.
         map.put("Amit","Java");
         map.put("Amit","Java"); 
```

检索代码...

```
System.out.println("There are "+map.size()+" elements in the map.");
         System.out.println("Content of Map are...");
         Set s=map.entrySet();
         Iterator itr=s.iterator();
         while(itr.hasNext())
         {
             Map.Entry m=(Map.Entry)itr.next();
             System.out.println(m.getKey()+"\t"+m.getValue()+"\t"+ m.hashCode());
          } 
```

我得到的结果：

```
There are 1 elements in the map.
Content of Map are...
Amit    Java    3943477 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-06T16:19:35.183

因为[Map 的约定](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)是键必须是唯一的。因此，如果您将新值关联到现有键，它将覆盖现有条目的值，而不是创建新条目：

> 将键映射到值的对象。地图不能包含重复的键；每个键最多可以映射到一个值。

您还可以检查[Map#put() javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html#put%28K,%20V%29)（强调我的）：

> 将指定值与此映射中的指定键关联（可选操作）。**如果映射先前包含键的映射，则旧值将替换为指定值。**（当且仅当 m.containsKey(k) 返回 true 时，映射 m 被称为包含键 k 的映射。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T16:26:36.943

标准 Java Map 每个键只能有一个值。请注意，该值*可能*是一个集合，因此您可以有效地为每个键存储多个值。

如果您想要地图中有多个相同的键，则存在各种解决方案。例如，参见 Guava [Multimap](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimap.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:21:32.823

如果新键与任何现有键相同，则映射中的值将被覆盖。

# qtembedded - Qt Embedded 交换颜色位：红色和蓝色

> ID：11832120
> 
> 赞同：6
> 
> 时间：2012-08-06T16:18:40.763
> 
> 标签：qtembedded

我在帧缓冲区 (/dev/fb0) 上具有 16 位色深的 ARM 显示设备上使用 QtEmbedded (4.8.0)。在这种情况下，我们正在交换颜色位 RED 和 BLUE。

我们使用以下编译标志：

```
./configure -embedded arm -xplatform qws/linux-arm-gnueabi-g++ -prefix /home/rchaves/Toolchain -release -opensource -shared -fast -depths 16 -largefile -no-exceptions -no-accessibility -stl -no-sql-mysql -no-sql-psql -no-sql-oci -no-sql-odbc -no-sql-tds -no-sql-db2 -no-sql-sqlite -no-sql-sqlite2 -no-sql-ibase -no-qt3support -no-xmlpatterns -no-multimedia -no-audio-backend -no-phonon-backend -no-svg -no-webkit -no-javascript-jit -no-script -no-scripttools -no-declarative -no-declarative-debug -qt-zlib -qt-libtiff -qt-libpng -qt-libmng -qt-libjpeg -no-openssl -no-nis -no-cups -iconv -no-pch -no-dbus -qt-freetype -no-opengl -qt-gfx-linuxfb -qt-kbd-linuxinput -qt-mouse-tslib -nomake demos -nomake examples 
```

以及执行应用程序的以下参数：

```
QWS_DISPLAY=LinuxFb:/dev/fb0:depth=16 ./app -qws 
```

这里有应用程序帧缓冲区（样本）日志：

```
The framebuffer device was opened successfully.

Fixed screen info:
    id:          DISP3 BG
    smem_start:  0x93800000
    smem_len:    7864320
    type:        0
    type_aux:    0
    visual:      2
    xpanstep:    1
    ypanstep:    1
    ywrapstep:   0
    line_length: 2048
    mmio_start:  0x0
    mmio_len:    0
    accel:       0

The framebuffer device was mapped to memory successfully.

Successfully switched to graphics mode.

Variable screen info:
    xres:           1024
    yres:           768
    xres_virtual:   1024
    yres_virtual:   3840
    yoffset:        0
    xoffset:        0
    bits_per_pixel: 16
    grayscale: 0
    red:    offset:  0, length:  5, msb_right:  0
    green:  offset:  5, length:  6, msb_right:  0
    blue:   offset: 11, length:  5, msb_right:  0
    transp: offset:  0, length:  0, msb_right:  0
    nonstd:       0
    activate:     64
    height:       -1
    width:        -1
    accel_flags:  0x0
    pixclock:     15385
    left_margin:  157
    right_margin: 157
    upper_margin: 16
    lower_margin: 15
    hsync_len:    5
    vsync_len:    1
    sync:         0
    vmode:        0

Frame Buffer Performance test...
    Average:   43020 usecs
    Bandwidth: 174.338 MByte/Sec
    Max. FPS:  23.245 fps

Will draw 3 rectangles on the screen,
they should be colored red, green and blue (in that order).
Done. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-20T01:13:09.330

迟到总比不到好。我在使用 Qt5.5.1 和 linuxfb 插件的 SAM5 处理器上遇到了这个确切的问题。重新配置或重新编译 Qt5 框架不会解决问题。

显然 LinuxFB 插件不支持 BGR 格式。有一个[开放的错误](https://bugreports.qt.io/browse/QTBUG-40527)跟踪此问题。检查 中的`determineFormat`函数`../src/plugins/platforms/linuxfb/qlinuxfbscreen.cpp`，您会发现无论提供哪种帧缓冲区信息，ImageFormat 都被硬编码为 **RGB。

要解决此问题，应用附加到错误的[补丁](https://bugreports.qt.io/secure/attachment/42158/linuxfb_swapRGB_2.patch)可能会帮助您解决此问题。

我说“可能”是因为我的帧缓冲驱动程序错误地报告它是 RBG 格式。所以要注意这一点。如果是这种情况，只需对`swapRgb`标志进行硬编码，直到修复帧缓冲区驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:28:41.453

**更新**：尝试设置`-depths generic`并`./configure`运行`-display linuxfb:genericcolors`。这是根据讨论该问题的[线程。](http://lists.trolltech.com/qtopia-interest/2008-03/thread00014-0.html)

**旧答案：**听起来您的显示字节序被交换了。

根据[文档](http://doc.qt.nokia.com/4.7-snapshot/qt-embedded-displaymanagement.html)，您可以尝试将`littleendian`选项传递给显示字符串。另一种选择是查阅`fb`有关执行字节序交换的 linux 文档。

# sql - SQL查询一段时间内的最后一个条目

> ID：11832121
> 
> 赞同：1
> 
> 时间：2012-08-06T16:18:40.950
> 
> 标签：sql, oracle, frequency, oracle-sqldeveloper

我正在尝试为 Oracle SQL 编写一个 SQL 查询，以便检索某个周期频率的最后一条记录。例如，假设频率是季度，（我也希望每月和每年工作），如果需要，我可以提供季度的开始日期和结束日期，但我需要检索每个季度内的最后一个条目。我怎样才能做到这一点？到目前为止，我的运气有限，没有写很多子查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:26:14.623

尝试类似：

```
select * from
(select t.*,
        row_number() over (partition by trunc(date_field, 'MON') 
                           order by date_field desc) rn
 from my_table t)
where rn = 1 
```

几个月。`trunc`（在季度或年的子句中使用“Q”或“Y”而不是“MON” 。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:31:10.587

```
SELECT col1, col2, col3...colN
FROM TableA
WHERE  (colX = (SELECT     MAX(Date) AS LastDate
    FROM          TableA 
    WHERE      QuarterDate Between (BeginningDate AND EndingDate) 
```

colX 是日期列，它是您需要检查的日期是否在该季度。

我认为这应该有效。

# sql-server - 如何将所有列合并为一列

> ID：11832125
> 
> 赞同：0
> 
> 时间：2012-08-06T16:18:57.583
> 
> 标签：sql-server, tsql

我已将三个表合并为一个表，并且我注意到每个合并表都有相似的数据列，从而产生冗余。

将所有这些列更新为一列的最佳方法是什么？

现在数据将读取

```
WallJambHeadCut | WallJambSillCut | DoorJambSillCut | DoorJambHeadCut | ect ....
       1               0                0                   0 
       0               0                1                   0 
```

以上内容也需要浓缩为两列：

```
 Headcut | SillCut 
```

换句话说，这些列中的每一列都可以浓缩为一列。我只是想确保我编写了正确的更新语句，因为我讨厌将我的数据提取出来。

```
CREATE TABLE [dbo].[Table_1](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [WallJambHeadCut] [bit] NOT NULL,
    [WallJambSillCut] [bit] NOT NULL,
    [DoorJambSillCut] [bit] NOT NULL,
    [DoorJambHeadCut] [bit] NOT NULL,
    [VerticalHeadCut] [bit] NOT NULL,
    [VerticalSillCut] [bit] NOT NULL,
 CONSTRAINT [PK_Table_1] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:38:05.127

你能从这个查询中得到你想要的吗？

```
select Headcut,Sillcut from (
select [WallJambHeadCut] as Headcut,[WallJambSillCut] as Sillcut from table_1 
union all
select [DoorJambHeadCut] as Headcut,[DoorJambSillCut] as Sillcut from table_1 
union all
select [VerticalHeadCut] as Headcut),[VerticalSillCut] as Sillcut from table_1 
) a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:25:36.797

根据您想要执行的复杂性，您可以将所有列替换为 tinyint 类型的列，并执行按位运算来处理数据。我们实际上在我正在进行的项目中这样做。

对于您给出的示例，您将拥有

```
0000 1000  --Which is 8
0000 0010  --Which is 2 
```

每当您需要更新这些值时，您只需使用运算符。

您可以在此处查看更多信息[http://msdn.microsoft.com/en-us/library/ms176122.aspx](http://msdn.microsoft.com/en-us/library/ms176122.aspx)

tinyint 更好，因为它只占用 8 位

1.  添加新列
2.  更新表格并设置 newCol = WallJambHeadCut | WallJambSillCut | DoorJambSillCut | DoorJambHeadCut --对于每一行

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:26:11.820

在 int 类型的列上创建，并使用按位运算存储/读取/更新数据。例如，对 col1 使用第一位，对 col2 使用第二位，对 col3 使用第三位等（假设每列只有两种可能性）。

# ip - 如何识别重复数据包

> ID：11832127
> 
> 赞同：0
> 
> 时间：2012-08-06T16:19:10.560
> 
> 标签：ip, duplicates, host, packets

当主机需要重新发送数据包时（无论有效负载如何），标头中是否有任何字段被修改，以便您可以判断它是重复数据包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:32:52.507

不，IP 数据包不会重新发送，这是更高[协议层](http://en.wikipedia.org/wiki/OSI_model)的功能。

某些传输协议（例如 TCP 或 SCTP）具有内置的重传功能，可在该协议层重新发送数据包，某些应用协议（例如 DNS）在应用协议层应用重传。

IP 层不知道也不关心这一点，没有协议字段标识来自更高层的重传。

# model-view-controller - 在 Zend 中渲染部分视图以将 html 添加到路由操作布局

> ID：11832129
> 
> 赞同：0
> 
> 时间：2012-08-06T16:19:27.770
> 
> 标签：model-view-controller, zend-framework, partial-views, php, zend-framework-mvc

我正在渲染一个包含很多帧的页面（通过 dojo 的 XHR 内容窗格）。这是通过`IndexController`设置区域“header,left,right,center,footer”的请求来完成的，但该中心没有填充内容。这又是通过调用`PaneController`menu.onclick 来设置的。警告; 搜索引擎索引服务没有获取中心区域内容。如果用户通过/index/index 进入，我希望绕过中心的 AJAX 加载。

来自 IndexController 的相关片段：

```
class IndexController extends Zend_Controller_Action {
    public function indexAction() {
        $this->indexModel = $this->view->indexModel = new Application_Model_Index();

        // Goal is to render "/pane/main/" action and capture the HTML
        $this->view->mainPane = (string) $this->renderPaneMain();
        return $this->render();
    }
    public function renderPaneMain() {
        // ActionStack ?
        // action() ?
        return $HTML;
    }
} 
```

窗格中的相关内容

```
class PaneController extends Zend_Controller_Action {

    public function preDispatch() {
        // will only return a contentpane, dont render layout 
        if ($this->getRequest()->isXmlHttpRequest()) {
            $this->_helper->layout()->disableLayout();
            $this->view->doLayout = true;
        }
    }
    public function mainAction() {
            this.render("main.phtml");
    }
    public function init() {
        $this->panesModel = new Application_Model_Panes();
        $variant = $this->getRequest()->getParam('variant', '');
            // routing variables need to be set, how?
        if (empty($variant))
            $this->_redirect('/');
    }
} 
```

基本上，我需要 PaneController _not 渲染全局布局，而是调用它的 .phtml 视图文件，一旦它已经设置了相关的模型条目等。

关于如何以最有效的形式实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:16:45.940

很好，请附上我在此处使用的解决方法

我已将表单和分叉逻辑转移到与 PanesController 共存的模型中。对于 IndexController，它将默认窗格显示为没有 AJAX 的内联 HTML - 有几个重复的初始化正在进行。

因此，IndexModel 扩展了 PanesModel - 无需对其进行初始化。在我的 index.phtml 视图（用于索引操作）中，我有以下代码来呈现窗格中的内联 html。

### 在索引控制器中

```
$this->view->model = new IndexModel(); // extends PanesModel
$this->view->model->setDefaultProperties($variant, $pagination, ...); 
```

### 在索引视图中：

```
$this->partial("panes/main/main.phtml", array("model", $this->model); 
```

### 并从窗格视图：

```
<?php if($this->model->goThisDirection()): ?>
     Switch 1 HTML contents
<?php endif; ?> 
```

警告：我还必须*不在*窗格内呈现任何形式的布局（dojox contentpanes 允许`<script>`和`<style>`标记） - 这个 ofc 会影响我的任何其他窗格操作。

# css - 跨浏览器使用CSS旋转图像的方式？

> ID：11832131
> 
> 赞同：33
> 
> 时间：2012-08-06T16:19:29.973
> 
> 标签：css, image, background, rotation

我有一个我正在处理的网站布局，它有一个主要内容区域，然后在内容区域的四个角中的每一个都有一个角图形。整体效果是桌面吸墨纸的效果。

这是我左上角的代码：

```
.corner-top-left    { width:96px ;
height:96px ;
background:url("images/corner.png") no-repeat ;
position:absolute ;
top:-5px ;
left:-5px ;
z-index:3000 ;
} 
```

而不是制作四个单独的角落图像，我想做的（如果可能的话）是使用原始图像（corner.png）并使用CSS旋转它。

是否有跨浏览器兼容的方式来做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-08-06T16:46:15.477

[http://jsfiddle.net/tJkgP/2/](http://jsfiddle.net/tJkgP/2/)

CSS 旋转 45 度：

```
.desk
{
    width: 50%;
    height: 400px;
    margin: 5em auto;
    border: solid 1px #000;
    overflow: visible;
}
.desk img
{
    behavior:url(-ms-transform.htc);
    /* Firefox */
    -moz-transform:rotate(45deg);
    /* Safari and Chrome */
    -webkit-transform:rotate(45deg);
    /* Opera */
    -o-transform:rotate(45deg);
    /* IE9 */
    -ms-transform:rotate(45deg);
    /* IE6,IE7 */
    filter: progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476);
    /* IE8 */
    -ms-filter: "progid:DXImageTransform.Microsoft.Matrix(SizingMethod='auto expand', M11=0.7071067811865476, M12=-0.7071067811865475, M21=0.7071067811865475, M22=0.7071067811865476)"; 

} 
```

IE6-8 CSS 来自这里：[CSS rotate property in IE](https://stackoverflow.com/questions/4617220/css-rotate-property-in-ie)

# c++ - C++：默认参数和向量

> ID：11832134
> 
> 赞同：0
> 
> 时间：2012-08-06T16:19:55.040
> 
> 标签：c++, function, vector, optional-parameters

在 C++ 中，我想要一个函数，该函数采用向量类型的可选参数。如果未提供参数，我希望变量的大小为 0。我目前有

```
void v_connect::import(vector<int> vid_,vector<double> vpos_,vector<int> vbd_,vector<int>    bd_ss_=std::vector<int>() ) 
```

但这不起作用。基本上，如果用户提供了可选参数`bd_ss_`，我想做一个检查`bd_ss_.size()!=0`，然后做一些额外的事情。如果用户不提供参数，我想要`bd_ss.size()==0`. 这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T16:25:32.813

无法判断可选参数是否是用户提供的。但是，您可以使用重载：

```
void v_connect::import(
    std::vector<int> vid_,
    std::vector<double> vpos_,
    std::vector<int> vbd_,
    std::vector<int> bd_ss_) 
{
    check(!bd_ss_.empty());
    do_extra_stuff();
    do_import(vid_, cpos_, vbd_, bd_ss_);
}

void v_connect::import(
    std::vector<int> vid_,
    std::vector<double> vpos_,
    std::vector<int> vbd_) 
{
    do_import(vid_, cpos_, vbd_, std::vector<int>());
}

// private:
void v_connect::do_import(
    std::vector<int> vid_,
    std::vector<double> vpos_,
    std::vector<int> vbd_,
    std::vector<int> bd_ss_)
{
    // common import code goes here
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T16:25:49.990

您可以让用户传递一个指针：

```
void foo(std::vector<int> * ov = NULL)
{
    std::vector<int> dummy;
    std::vector<int> & bd_ss_ = ov ? *ov : dummy;

    if (ov) assert(!bd_ss_.empty());

    // ...
} 
```

或者，使用[Boost.optional](http://www.boost.org/doc/libs/1_50_0/libs/optional/doc/html/index.html)，这是一个巧妙的 C++ 风格包装器，它围绕这个想法，允许您通过无缝接口获得相同的行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T16:25:37.470

可选参数放在标题中，而不是 cpp。

顺便说一句，您正在混合矢量和 std::vector，请使用其中一个（最好坚持使用 std::vector）。

# java - 将纹理设置为 md2 模型 java/android

> ID：11832137
> 
> 赞同：1
> 
> 时间：2012-08-06T16:20:09.290
> 
> 标签：java, android, loading, textures, setting

我需要帮助在 java/android 中将纹理设置为 .MD2 模型

根据维基百科，我想出了以下内容：（ MD2 (file_format) ）

加载 texCoords：

```
int idx = 0;
for(int i = 0; i < this.pHeader.num_st; i++) //num_st = Number of texture coordinates
{
    this.fTexCoords[i][0] =  (float)is.readShort(); //S
    this.fTexCoords[i][1] =  (float)is.readShort(); //T
} 
```

并计算它们：

```
int idx2 = 0;
int idx = 0;
for(int i = 0; i < this.pHeader.num_tris; i++) //num_tris = Number of triangles
{
    this.fIndices[idx+0] = is.readUnsignedShort();
    this.fIndices[idx+1] = is.readUnsignedShort();
    this.fIndices[idx+2] = is.readUnsignedShort();

    int uvID0 = is.readUnsignedShort();
    int uvID1 = is.readUnsignedShort();
    int uvID2 = is.readUnsignedShort();

    this.fTEXTURE[idx2+0] = (float)(this.fTexCoords[uvID0][0] / (float)this.pHeader.skinwidth); //s
    this.fTEXTURE[idx2+1] = (float)(this.fTexCoords[uvID0][1] / (float)this.pHeader.skinheight); //t
    this.fTEXTURE[idx2+2] = (float)(this.fTexCoords[uvID1][0] / (float)this.pHeader.skinwidth); //s
    this.fTEXTURE[idx2+3] = (float)(this.fTexCoords[uvID1][1] / (float)this.pHeader.skinheight); //t
    this.fTEXTURE[idx2+4] = (float)(this.fTexCoords[uvID2][0] / (float)this.pHeader.skinwidth); //s
    this.fTEXTURE[idx2+5] = (float)(this.fTexCoords[uvID2][1] / (float)this.pHeader.skinheight); //t

    idx += 3;
    idx2 += 6;
} 
```

将所有内容转换为缓冲区并绘制它：

```
gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, this.TextureBuffer);
gl.glNormalPointer(GL10.GL_FLOAT, 0, this.NormalBuffer);
gl.glVertexPointer(3, GL10.GL_FLOAT, 0, this.VertexBuffer); 

gl.glDrawElements(GL10.GL_TRIANGLES, (this.max_indices*3), GL10.GL_UNSIGNED_SHORT, this.IndexBuffer); 
```

这就是结果（模型用动画等渲染得很好，但是颜色/纹理搞砸了——它应该只是给脚上色）

它应该是什么样子（搅拌机）： http: [//img6.imagebanana.com/img/rh6l4awq/blender.png](http://img6.imagebanana.com/img/rh6l4awq/blender.png)以及它在我的手机上的实际外观：http: [//img6.imagebanana.com/img/wud654s9/SC20120806172956。 PNG](http://img6.imagebanana.com/img/wud654s9/SC20120806172956.png)

我将搅拌机纹理文件保存为 png（查看 -> 打包为 PNG -> 另存为）

谢谢你的帮助

# c++ - 来自 Cormen 的霍夫曼算法

> ID：11832138
> 
> 赞同：1
> 
> 时间：2012-08-06T16:20:15.623
> 
> 标签：c++, algorithm, huffman-code

我正在尝试编写[Huffman 编码树](http://en.wikipedia.org/wiki/Huffman_coding)，使用`multimap<int, NODE*>`where `NODE`is just a classic tree node。所以我写了这个方法：

```
this->CreateMapTree();
int n = (int)tree.size();
pair<int, NODE*> x, y, z;

for (int i = 0; i < n-1; ++i)
{
    x = *tree.begin(); tree.erase(tree.begin());
    y = *tree.begin(); tree.erase(tree.begin());

    z.second = new NODE;

    z.second->left = y.second;
    z.second->right = x.second;
    z.first = x.first + y.first;

    tree.insert(z);
}//after loop there is only one element in the tree

head = tree.begin()->second; 
```

方法`CreateMapTree`工作完美，结果我有`tree`。我使用了创建 Huffman 树的经典算法（来自 Cormen）。我多次检查此代码，但我找不到我的错误。代码三是错误的，我无法为编码和解码创建正确的字典。

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-02-20T19:22:40.407

我建议你看看从树中删除 x 和 y 后它们会发生什么。指向它们的指针可能不再有效。

# javascript - GAS Click 事件处理程序导致 UI Web App 中出现“意外错误”

> ID：11832140
> 
> 赞同：0
> 
> 时间：2012-08-06T16:20:20.857
> 
> 标签：javascript, user-interface, google-apps-script, dom-events

我编写了一个 Google 应用程序脚本，它首先在 UI 应用程序中创建并显示一个折线图，然后使用 Click-button 事件处理程序根据选定的列表框值重新绘制图形，以在图形“刷新”时触发。

我试图解决的问题是，当触发点击事件时作为 Web 应用程序发布时，我收到：

> 遇到错误：发生意外错误

代码从电子表格中完美运行（除了一些令人讨厌的权限问题，其他用户被要求下载面板对象；我稍后会谈到），我真的很困惑为什么它不会翻译。

这是它的价值的代码：

```
function doGet(){
  var app = UiApp.createApplication().setWidth(800).setHeight(650).setTitle('FLEET Chart');
  var e = 'undefined';
  lb(app);
  return click(e, app);
 }

function lb(app){
  var lb = app.createListBox(true).setId('myId').setName('myLbName');// add items to ListBox      
  var lb2 = app.createListBox(true).setId('myId2').setName('myLbName2');
  var lb3 = app.createListBox(true).setId('myId3').setName('myLbName3');
  var bttn = app.createButton('Refresh').setId('myBttn');
  lb3.addItem('2011').addItem('2012');
  lb2.addItem('January')
     .addItem('February')
     .addItem('March')
     .addItem('April')
     .addItem('May')
     .addItem('June')
     .addItem('July')
     .addItem('August')
     .addItem('September')
     .addItem('October')
     .addItem('November')
     .addItem('December');
   lb.addItem('Drug1')    
     .addItem('Drug2')    
     .addItem('Drug3')    
     .addItem('Drug4');
  var mypanel = app.createHorizontalPanel().setVisible(true);
  mypanel.add(lb).add(lb2).add(lb3).add(bttn);
  app.add(mypanel);
  var handler = app.createServerChangeHandler('click').addCallbackElement(mypanel);
  handler.addCallbackElement(bttn);
  bttn.addClickHandler(handler);
}

function click(e, app) {
  var valuelb = new Array('Drug1','Drug2','Drug3','Drug4');
  var valuelb2 = new Array    ('January','February','March','April','May','June','July','August','September','October','November','December');
  var valuelb3 = new Array('2011','2012');
  var SS = SpreadsheetApp.openById('0Am8DRqAEaxH7dF9NWFJLSTdWZGRxeEFfMkFjNlFCT2c');
  var sheeteff = SS.getSheetByName('Efficiency');
  var data = sheeteff.getDataRange().getValues();
  if (String(e) != 'undefined') {
    app.setWidth(800).setHeight(650).setTitle('FLEET Chart');
    var valuelb = String(e.parameter.myLbName);
    if (valuelb.indexOf(',') != -1) {
      var valuelb = e.parameter.myLbName.split(',');
    }
    var valuelb2 = String(e.parameter.myLbName2);
    if (valuelb2.indexOf(',') != -1) {
      var valuelb2 = e.parameter.myLbName2.split(',');
    }
    var valuelb3 = String(e.parameter.myLbName3);
    if (valuelb3.indexOf(',') != -1) {
      var valuelb3 = e.parameter.myLbName3.split(',');
    }
    SS.getSheetByName('Sheet2').getRange(1,1).setValue(String(valuelb2) + ' ' + valuelb.indexOf(','));//for unformation purposes
    lb(app);
  }else{
    SS.getSheetByName('Sheet2').getRange(1,1).setValue(String(e));//for information purposes
  }
  var usedata = ArrayLib.filterByText(ArrayLib.filterByText(ArrayLib.filterByText(data, 3, valuelb), 1, valuelb2), 0, valuelb3);

  //Build data table
  var dataTable = Charts.newDataTable();

  //Add Column types
  dataTable.addColumn(Charts.ColumnType.DATE, data[0][2]);
  dataTable.addColumn(Charts.ColumnType.NUMBER, data[0][9]);
  dataTable.addColumn(Charts.ColumnType.NUMBER, data[0][8]);
  //Add rows
  for(var j=0; j<usedata.length; j++){
    dataTable.setValue(j, 0, usedata[j][2]);
    dataTable.setValue(j, 1, usedata[j][9]);
    dataTable.setValue(j, 2, usedata[j][8]);
  }

  //Create and build chart
  var chart = Charts.newLineChart()
      .setDataTable(dataTable)
      .setTitle('Efficiency over Time \nConfiguration: [' + valuelb + ']\n' + 'Month: [' + valuelb2 + ']\n' + 'Year: [' + valuelb3 + ']')
      .setXAxisTitle('Time')
      .setYAxisTitle('Percentage')
      .setDimensions(750, 600)
      .setPointStyle(Charts.PointStyle.MEDIUM)
      .build();
  app.add(chart);
  return app;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:40:09.733

我的代码中也有“意外错误”。为了修复它们，我编写了一个简单的库来帮助查找服务器处理程序中的问题。[这](https://script.google.com/macros/s/AKfycbzwmbSfkJNUj5Bg2DoLaTHbAw8rVknxHNVoG21WIc-h4WfxlMdH/exec)是一个演示如何使用该库的示例。示例源代码在[这里](https://script.google.com/d/1X6Yv8B_W5bT56Yw8D6jgw9TOFRVKjQbt0K7pxg1SMRI7WgGBVDT1IprH/edit)。要将库添加到脚本中，必须使用对话框`Mr6TKHuVEJGjYr-NnLUNbEkFO7CoOZA03`中的项目键。`Resources->Manage Libraries`该库使用`ScriptProperties`服务来存储自己的内部变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:35:28.650

我没有浏览您的整个代码，但肯定看到了这个错误 - 您已将 doGet 设置为要在处理程序上调用的函数。没有问题，除非您第二次尝试调用 UiApp.createApplication() ，这是不允许的。

我建议您更改处理程序以调用另一个函数（可能是 lb）而不是 doGet。

# iphone - MKReverseGeocoder “在 iOS 5 中已弃用”

> ID：11832150
> 
> 赞同：0
> 
> 时间：2012-08-06T16:20:50.390
> 
> 标签：iphone, ios, xcode, mkreversegeocoder

它说它“在 iOS 5 中已弃用”。

```
- (void)viewDidLoad {
    [super viewDidLoad];
    CLGeocoder *geocoder = [[CLGeocoder alloc] init];

    [geocoder reverseGeocodeLocation:self.locationManager.location // You can pass aLocation here instead
                   completionHandler:^(NSArray *placemarks, NSError *error) {

                 dispatch_async(dispatch_get_main_queue() , ^ {
                           // do stuff with placemarks on the main thread

                           CLPlacemark *place = [placemarks objectAtIndex:0];

                           NSString *zipString = [place.addressDictionary valueForKey:@"ZIP"];

                           [self performSelectorInBackground:@selector(showWeatherFor:) withObject:zipString];

                       }
            }
 } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T16:36:22.453

`MKReverseGeocoder`在 iOS4 之后的所有固件中已弃用。这只是意味着它现在已经过时并且不赞成使用过时的类。改为使用`CLGeocoder`，如下所示：

```
 CLGeocoder *geocoder = [[CLGeocoder alloc] init];

        [geocoder reverseGeocodeLocation:self.locationManager.location // You can pass aLocation here instead 
                       completionHandler:^(NSArray *placemarks, NSError *error) {

                           dispatch_async(dispatch_get_main_queue(),^ {
                               // do stuff with placemarks on the main thread

                           if (placemarks.count == 1) {

                           CLPlacemark *place = [placemarks objectAtIndex:0];

                           NSString *zipString = [place.addressDictionary valueForKey:@"ZIP"];

                           [self performSelectorInBackground:@selector(showWeatherFor:) withObject:zipString];

                           }

     });

}]; 
```

如果你想对一对硬编码的坐标进行反向地理编码——

用您的纬度和经度初始化 CLLocation 位置：

```
 CLLocation *aLocation = [[CLLocation alloc] initWithLatitude:latitude longitude:longitude]; 
```

我还想指出，您仍然可以使用`MKReverseGeocoder`. 不过，它可能会在未来的 iOS 更新中被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T16:24:54.370

我不知道这是否回答了您的默认问题，但[文档](http://developer.apple.com/library/ios/#DOCUMENTATION/MapKit/Reference/MKReverseGeocoder_Class/Reference/Reference.html)说要改用[CLGeocoder](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLGeocoder_class/Reference/Reference.html#//apple_ref/occ/cl/CLGeocoder)。

# javascript - javascript推送到1个数组

> ID：11832154
> 
> 赞同：0
> 
> 时间：2012-08-06T16:21:05.413
> 
> 标签：javascript

我正在尝试将新值推送到数组中，但是当推送值时会创建 2 个新数组。我正在尝试将值推送到一个数组中，而不是单独的数组中。我怎么做？这是我正在使用的代码。

```
for (count = 0; count < xmlItem.length; count++) {
  // dates
  xmlDate = new Date(xmlItem[count].getElementsByTagName("pubDate")[0].childNodes[0].nodeValue);
  // titles
  xmlTitle = xmlItem[count].getElementsByTagName("title")[0].childNodes[0].nodeValue;
  // descriptions
  xmlDescription = xmlItem[count].getElementsByTagName("description")[0].childNodes[0].nodeValue;
  // date reformated
  pubDate = (xmlDate.getMonth() + 1) + "/" + xmlDate.getDate() + "/" + xmlDate.getFullYear();
  // if there is a new code
  if (pubDate == today) {
      // array with titles for new values
      totalValues = new Array();
      // add the title
      totalValues.push(xmlTitle);
      // add badge for number of values
      chrome.browserAction.setBadgeText({ text: JSON.stringify(totalValues.length) });
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:22:19.937

`totalCodes = new Array();`在你的`for`循环之前移动它。

每次`for`循环迭代时，它都会使用`totalCodes = new Array();`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:24:05.823

每次执行循环时，`totalCodes = new Array()`都会调用该行，并将其重置`totalCodes`为空数组。在循环`totalCodes`之外声明。`for`

# jquery - jQuery.get() 并返回 html 数据：如何提取一段代码？

> ID：11832155
> 
> 赞同：0
> 
> 时间：2012-08-06T16:21:06.800
> 
> 标签：jquery, jquery-get

假设您可以使用该`jQuery.get()`函数通过调用来检索一个HTML页面，例如如下：

```
$.get('xxx.php', 
        function(data) {
        //handle data, that is HTML code....
}); 
```

是否有任何*jQuery*解决方案可以通过变量提取元素（例如*div*、*ul*等） ？`data`

PS：我不认为使用`load()`加载*页面片段*是一个好主意，因为我想尽量减少服务器请求的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:23:32.477

```
$.get('xxx.php', 
        function(data) {
        //handle data, that is HTML code....
        var pageDivs = $(data).find('div');
}); 
```

只需让 HTML 返回一个 jquery 对象，就可以正常使用任何 DOM 函数。

# ruby-on-rails - 如何使这个 javascript 不显眼？

> ID：11832156
> 
> 赞同：0
> 
> 时间：2012-08-06T16:21:12.347
> 
> 标签：ruby-on-rails, unobtrusive-javascript, google-visualization

我有这个javascript代码，来自我视图底部的谷歌图表api：

```
<div id='visualization'></div>
...
<script type="text/javascript">
function drawVisualization() {
        // Create and populate the data table.

        var data = google.visualization.arrayToDataTable(<%=raw @pie_gender %>)

        // Create and draw the visualization.
        new google.visualization.PieChart(document.getElementById('visualization')).
            draw(data, {title:"Men and Women"});
      }
      google.setOnLoadCallback(drawVisualization);
</script> 
```

我试图将此 js 代码放在我的资产文件夹中的 .js 文件下，并将其包含在我的标题中，以及替换`<%=raw @pie_gender %>`为`this.getAttribute('data-message')`并将我的 div 设置为'，但随后我收到一个 javascript 错误`"getAttribute" does not exist for object window`

我也尝试将我的数组作为输入参数传递，例如 : `onload="drawVisualization(<%=raw @pie_gender %>)`，但后来我得到“错误：不是数组”

我可能做错了什么？

**编辑**

@pie_gender = [['性别', '出现次数']['M', 10]['F', 5]]

基于[谷歌的例子](http://code.google.com/apis/ajax/playground/?type=visualization#pie_chart)

**编辑 2** 如果我打印 json 输出

```
<% logger.debug "Pie Gender : #{@pie_gender.to_json}" %>
        <div id="visualization" onload="drawVisualization(<%= @pie_gender.to_json %>)" > </div> 
```

，看起来还不错：

```
Pie Gender : [["Gender","Receipts"],["",25000],["F",8658]] 
```

但似乎在将它作为参数发送给我的 js 函数时发生了一些事情，因为它仍然说消息不是数组：

```
function drawVisualization(message) {
        // Create and populate the data table.
        var data = google.visualization.arrayToDataTable(message);

        // Create and draw the visualization.
        new google.visualization.PieChart(document.getElementById('visualization')).
            draw(data, {title:"Men and Women"});
      }
      google.setOnLoadCallback(drawVisualization); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T10:11:03.397

为了解决这个问题，我将我的 javascript 代码插入了部分

_googlescript.html.erb

```
<script type="text/javascript">
function drawVisualization() {
        // Create and populate the data table.

        var data = google.visualization.arrayToDataTable(<%=raw data_array %>)

        // Create and draw the visualization.
        new google.visualization.PieChart(document.getElementById('visualization')).
            draw(data, {title:"Men and Women"});
      }
      google.setOnLoadCallback(drawVisualization);
</script> 
```

在我看来，我在页面底部呈现了部分，并删除了 onload，这似乎没有做任何事情......：

```
<div id="visualization" > </div>
...
<%= render partial: 'shared/googlescript', locals: {data_array:@pie_gender} %> 
```

现在我可以再次看到图表......但我仍然觉得我的问题有更好的答案。

# javascript - Array.sort 在 chrome 和 firefox 和 IE 中的工作方式不同

> ID：11832158
> 
> 赞同：2
> 
> 时间：2012-08-06T16:21:21.830
> 
> 标签：javascript, internet-explorer, google-chrome

我正在尝试根据对象中的字段 [marks] 对包含对象的数组进行排序。该数组在 Firefox 和 chrome 中的排序方式不同。在 Chrome 和 IE9 中，第十六项无缘无故地移到了数组的顶部。由于所有标记都是 0，我假设不会进行排序。在 Firefox 中没有排序发生，但在 chrome 和 IE 中不是这样。请在下面找到我使用过的代码。任何关于为什么会发生这种情况的建议将不胜感激

```
var arr = [
{"userid":"1","name":"USER_1","subjectid":"123","marks":"0"},
{"userid":"2","name":"USER_2","subjectid":"123","marks":"0"},
{"userid":"3","name":"USER_3","subjectid":"123","marks":"0"},
{"userid":"4","name":"USER_4","subjectid":"123","marks":"0"},
{"userid":"5","name":"USER_5","subjectid":"123","marks":"0"},
{"userid":"6","name":"USER_6 ","subjectid":"123","marks":"0"},
{"userid":"7","name":"USER_7","subjectid":"123","marks":"0"},
{"userid":"8","name":"USER_8","subjectid":"123","marks":"0"},
{"userid":"9","name":"USER_9","subjectid":"123","marks":"0"},
{"userid":"10","name":"USER_10","subjectid":"123","marks":"0"},
{"userid":"11","name":"USER_11","subjectid":"123","marks":"0"},
{"userid":"12","name":"USER_12","subjectid":"123","marks":"0"},
{"userid":"13","name":"USER_13","subjectid":"123","marks":"0"},
{"userid":"14","name":"USER_14","subjectid":"123","marks":"0"},
{"userid":"15","name":"USER_15","subjectid":"123","marks":"0"},
{"userid":"16","name":"USER_6","subjectid":"123","marks":"0"},
{"userid":"17","name":"USER_17","subjectid":"123","marks":"0"},
{"userid":"18","name":"USER_8","subjectid":"123","marks":"0"},
{"userid":"19","name":"USER_19","subjectid":"123","marks":"0"},
{"userid":"20","name":"USER_20","subjectid":"123","marks":"0"},
{"userid":"21","name":"USER_21","subjectid":"123","marks":"0"},
{"userid":"22","name":"USER_22","subjectid":"123","marks":"0"},
{"userid":"23","name":"USER_23","subjectid":"123","marks":"0"},
{"userid":"24","name":"USER_24","subjectid":"123","marks":"0"},
{"userid":"25","name":"USER_25","subjectid":"123","marks":"0"},
{"userid":"26","name":"USER_26","subjectid":"123","marks":"0"},
{"userid":"27","name":"USER_27","subjectid":"123","marks":"0"},
{"userid":"28","name":"USER_28","subjectid":"123","marks":"0"},
{"userid":"29","name":"USER_29","subjectid":"123","marks":"0"},
{"userid":"30","name":"USER_30","subjectid":"123","marks":"0"},
{"userid":"31","name":"USER_31","subjectid":"123","marks":"0"},
{"userid":"32","name":"USER_32","subjectid":"123","marks":"0"},
{"userid":"33","name":"USER_33","subjectid":"123","marks":"0"}
];

console.log(JSON.stringify(arr));

arr.sort(function(a,b){
    return b['marks'] - a['marks'];
});

for(var i = 0; i < arr.length; i++){
        arr[i].position = i + 1;
}

console.log(JSON.stringify(arr));​ 
```

# android - 将按钮从相对布局更改为线性布局奇怪的副作用

> ID：11832163
> 
> 赞同：3
> 
> 时间：2012-08-06T16:21:44.553
> 
> 标签：android, xml, multithreading, layout

今天最奇怪的事情发生在我身上，导致了数小时的沮丧和愤怒管理问题。

我有一个可用的 Android 幻灯片应用程序。但是，我对按钮（在相对布局中）不满意，并将它们移动到线性布局。但是，在运行我的应用程序时，按钮的行为被交换了（即按钮 1 完成了按钮 2 的工作，反之亦然）。我可以通过更改其中一个按钮的 id 来解决这个问题，而不是全部（这不起作用）。与此相关的是，当我切换方向时，我的应用程序开始崩溃。当我有相对布局时，它以前工作过。（我正在使用处理程序来更改幻灯片的 UI）

我无法解决这个问题，所以我恢复到我的相对布局，但我想知道这首先是怎么发生的。

有效的布局：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_centerInParent="true"
        android:contentDescription="@string/imageView"
        android:scaleType="centerInside"
        android:src="@drawable/image1" />

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:textAppearance="?android:attr/textAppearanceMedium" />

        <ImageButton
            android:id="@+id/startStop"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:contentDescription="@string/startStop"
            android:src="@drawable/ic_menu_slideshow" />

        <ImageButton
            android:id="@+id/next"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentRight="false"
            android:layout_toRightOf="@+id/startStop"
            android:contentDescription="@string/next"
            android:src="@drawable/ic_media_next" />

        <ImageButton
            android:id="@+id/previous"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="false"
            android:layout_toLeftOf="@+id/startStop"
            android:contentDescription="@string/previous"
            android:src="@drawable/ic_media_previous" />

</RelativeLayout> 
```

导致问题的代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="wrap_content" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_centerInParent="true"
    android:contentDescription="@string/imageView"
    android:scaleType="centerInside"
    android:src="@drawable/image1" />

<TextView
    android:id="@+id/title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<LinearLayout
    android:orientation="horizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:background="#30eee9e9" >

            <ImageButton
        android:id="@+id/previous"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:contentDescription="@string/previous"
        android:src="@drawable/ic_media_previous" />

    <ImageButton
        android:id="@+id/bla"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:contentDescription="@string/startStop"
        android:src="@drawable/ic_menu_slideshow" />

    <ImageButton
        android:id="@+id/next"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:contentDescription="@string/next"
        android:src="@drawable/ic_media_next" /> 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-09-07T02:44:42.547

我遇到了同样的问题，但是将相对布局作为父布局，将线性布局作为子布局，我采用了四个图像按钮

*   玩
*   分数
*   帮助
*   退出

并且按钮功能被转移到下一个，即当我按下 PLAY 时，按下 SCORE 时没有任何反应 点击 HELP 显示我的分数等游戏开始播放。试着看电影，但有一段时间我看它很无聊，我再次启动了 Eclipse，神奇的是它运行得如此之好。不知道 但是正如 DeeV 所说，Rebuild & Clean 解决了我的问题

# objective-c - 将 base64 解码的 NSData 转换为 NSString

> ID：11832165
> 
> 赞同：4
> 
> 时间：2012-08-06T16:21:50.093
> 
> 标签：objective-c, ios, nsstring, nsdata

我正在尝试对 base64 数据进行编码和解码。但是在解码 base64 数据时，它返回一堆十六进制值，但我无法使用 NSlog 显示或打印输出到原始可读字符串。下面的代码不能打印任何东西，只是空的。

任何人都可以帮忙吗？谢谢>>

```
NSString* msgEncoded = [[NSString alloc] initWithFormat:@"Q1NNKE1DTC9TTUEgUkNWL2FkbWluQHNldGVjcy5jb20gT1JHLyBUVkIvNDNkYzNlMzQwYWQ3Yzkp:"];  
NSData* decoded = [[NSData alloc] initWithData:[self decodeBase64WithString:msgEncoded]];
NSString* plainString = [[NSString alloc]initWithData:decoded encoding:NSUTF8StringEncoding];
NSLog(@"\n Decoded string:  %@ \n", plainString ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-21T11:54:48.030

NSData 中有一个内置函数

```
[data base64Encoding];
[data base64EncodedStringWithOptions:NSDataBase64Encoding76CharacterLineLength]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T18:38:02.523

如果您仍然遇到问题，请试用此库： [https ://github.com/l4u/NSData-Base64](https://github.com/l4u/NSData-Base64)

像这样使用它：

```
#import "NSData+Base64.h"

NSData *someData  //load your data from a file, url or photo as needed
NSData *file = [NSData dataWithContentsOfFile:@"mytextfile.txt"];
NSData *photo = UIImageJPEGRepresentation(self.photo.image,1);

//encode it
NSString *base64string = [photo base64EncodedString];
NSString *base64file = [file base64EncodedString];

//decode it
NSData *back = [NSData dataFromBase64String:base64string]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T19:11:52.913

试试谷歌的[GTMStringEncoding](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMStringEncoding.m)类。你也需要[GTMDefines.h](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/GTMDefines.h)。

```
GTMStringEncoding *coder = [GTMStringEncoding rfc4648Base64StringEncoding];
NSString *encodedBase64 = [coder encodeString:@"Mary had a little lamb"];

// will contain the original text
NSString *decodedText = [coder decodeString:encodedBase64]; 
```

要编码`NSData*`到`NSString*`和返回到`NSData*`，请使用`encode:`+`decode:`方法而不是`encodeString:`+ `decodeString:`。

作为奖励，您可以获得许多其他有用的编码，例如Base64的[url-safe 变体。](http://en.wikipedia.org/wiki/Base64#RFC_4648)

# vba - 在 Outlook 中接收电子邮件以连接到外部 Access 数据库时创建自动化规则

> ID：11832167
> 
> 赞同：1
> 
> 时间：2012-08-06T16:21:56.410
> 
> 标签：vba, ms-access, outlook

我创建了一个自定义的联系人访问数据库。我想将 Outlook 连接到数据库，以便每次用户收到电子邮件时，都会触发一个操作来搜索访问数据库以查看该联系人是否存在（基于我猜的电子邮件地址）。如果联系人不存在，它会使用电子邮件中的信息自动将联系人添加到数据库中，然后将电子邮件的内容作为信息注释添加到该联系人。如果联系人确实存在，它会自动将电子邮件内容作为信息注释添加到现有联系人中。

谁能指导我如何设置这样的系统？我习惯于在 MS Access 中使用 VBA 进行开发，但我不习惯在 Outlook 中使用 VBA 进行开发，所以我不知道从哪里开始。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T11:13:13.807

我测试这个已经有一段时间了，但是可以使用 Outlook 事件。

对于此示例，您将需要一个名为 clsOlMail 的类模块，其中包含以下代码：

```
'Requires reference to the Microsoft Outlook x.x Object Library
Dim WithEvents conItems As Outlook.Items

Private Sub Class_Initialize()
   Set oApp = Outlook.Application
   Set oNS = oApp.GetNamespace("MAPI")
   Set conFolder = oNS.GetDefaultFolder(olFolderSentMail)
   Set conItems = conFolder.Items
End Sub

Private Sub Class_Terminate()
   Set conItems = Nothing
   Set conFolder = Nothing
   Set oNS = Nothing
   Set oApp = Nothing
End Sub

Sub ConItems_ItemAdd(ByVal Item As Object)
Dim frm As Form

   Set frm = Forms!frmEmailDetails

   frm.txtSenderName = Item.SenderName
   frm.txtSentOn = Item.SentOn
   frm.txtTo = Item.To
   frm.txtCreationTime = Item.CreationTime
   frm.txtBCC = Item.BCC
   frm.txtCC = Item.CC
   frm.txtSentOnBehalfOfName = Item.SentOnBehalfOfName
   frm.txtSubject = Item.Subject
   frm.txtBody = Item.Body
End Sub 
```

您还需要一个名为 frmEmailDetails 的表单，其中包含以下文本框：

```
txtSenderName, 
txtSentOn, 
txtTo, 
txtCreationTime, 
txtBCC, 
txtCC, 
txtSentOnBehalfOfName, 
txtSubject, 
txtBody 
```

而这段代码：

```
Private oEvent As clsOLMail
'Requires reference to Microsoft Outlook x.x Object Library

Public oApp As Outlook.Application
Public oNS As Outlook.NameSpace
Public conFolder As Outlook.MAPIFolder

Private Sub Form_Open(Cancel As Integer)
    Set oEvent = New clsOlMail
End Sub 
```

打开表单并通过 Outlook 发送电子邮件，您可以使用上面显示的示例之一。表单字段应填写已发送电子邮件中的相关详细信息。您可能会收到 Outlook 安全警告。

# android - 获取 OpenGL LookAt 位置

> ID：11832168
> 
> 赞同：0
> 
> 时间：2012-08-06T16:22:00.490
> 
> 标签：android, opengl-es, matrix

在 Android OpenGL 中

它有命令 setLookAtM 来指定相机视图的位置

```
Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, lookX, lookY,
            lookZ, upX, upY, upZ); 
```

如果我旋转相机，使用命令 rotateM

```
Matrix.rotateM(mViewMatrix, 0 , angle , 0.0f, 1.0f, 0.0f); 
```

那么，我怎样才能从 mViewMatrix 获得**“LookAt”**的确切相机视图？

相机视图位置，我想要的是相机看的 x,y,z

![例子](../Images/e3972c1d70fdf5732074082fc44c572b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:58:52.423

小心，因为从技术上讲，调用 rotateM 不会旋转相机，它会将旋转应用于任何未来绘制的对象。（这并不意味着同样的事情）。

但是一般来说，如果您有一个视图矩阵，并且您想查看它所面向的方向，您希望通过视图矩阵的逆来变换眼睛空间前向向量 (0,0,1)。

当视图矩阵将世界空间中的向量变换到眼睛空间时，逆视图矩阵将向量从眼睛空间变换到世界空间。

这样你就可以：

1.  对当前视图矩阵应用任意操作
2.  取反
3.  将逆矩阵乘以 (0,0,1,0)。（请注意，这与仅拉出逆矩阵的第三列相同）。

在#3 之后，您将在世界空间中获得相机眼睛的方向。将此添加到眼睛的位置，您应该知道它指向的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T18:25:10.690

我已经完成了我的问题，这是我的解决方案

首先，我需要制作这 3 个矩阵以获得 x、y、z 位置的结果

```
private float[] mRotXMatrix = new float[] {
 1, 0, 0, 0, 
 0, 0, 1, 0,
 0, 1, 0, 0,
 0, 0, 0, 1 };
private float[] mRotYMatrix = new float[] {
 0, 0, 1, 0,
 0, 1, 0, 0,
 1, 0, 0, 0,
 0, 0, 0, 1 };
private float[] mRotZMatrix = new float[] { 
 0, 1, 0, 0,
 1, 0, 0, 0,
 0, 0, 1, 0,
 0, 0, 0, 1 }; 
```

然后在 onSensorChanged(SensorEvent e) 方法中，我像这样旋转所有这 3 个矩阵以及我的相机视图

```
Matrix.multiplyMM(mViewMatrix, 0, deltaRotationMatrix, 0, mViewMatrix, 0);
Matrix.multiplyMM(mRotXMatrix, 0, deltaRotationMatrix, 0, mRotXMatrix, 0);
Matrix.multiplyMM(mRotYMatrix, 0, deltaRotationMatrix, 0, mRotYMatrix, 0);
Matrix.multiplyMM(mRotZMatrix, 0, deltaRotationMatrix, 0, mRotZMatrix, 0); 
```

要获取我的相机视图的 X、Y、Z，只需从这些矩阵中获取

```
viewX = mRotXMatrix[2];
viewY = -mRotYMatrix[6]; // +/- up to your initial camera view
viewZ = mRotZMatrix[10]; 
```

# php - 使用 PHP 生成具有连续时间的表

> ID：11832169
> 
> 赞同：-3
> 
> 时间：2012-08-06T16:22:02.463
> 
> 标签：php, time, html-table

我正在尝试编写一个生成时间表的网站。表格的左侧列应显示从早上 7:00 开始的时间，并且每行增加 30 分钟。我不知道如何将时间增加 30 分钟。我只能显示当前时间：

代码：

```
<table>
<tr>
    <td></td>
    <td>Monday</td>
    <td>Tuesday</td>
    <td>Wednesday</td>
    <td>Thursday</td>
    <td>Friday</td>
</tr>
<?php
    $p=0;
    $r=7;
    while($p<30){
        echo "<tr><td>";
        echo date('g:i a');
        echo "</td></tr>";
        $p++;

    }
?>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:26:43.203

[date()](http://us3.php.net/manual/en/function.date.php)函数有一个可选的第二个时间戳参数。

如果您知道某一天早上 7 点的时间（使用类似[mktime](http://us.php.net/manual/en/function.mktime.php)的东西），那么您可以添加 30 分钟的增量。因为时间戳以秒为单位，所以您需要`(60 * 30)`为每个增量添加。

# r - R中稀疏矩阵的元素最大操作

> ID：11832170
> 
> 赞同：9
> 
> 时间：2012-08-06T16:22:11.100
> 
> 标签：r

我正在尝试采用两个“矩阵”类（稀疏矩阵）矩阵的元素最大值。我已经尝试过这个`pmax(...)`函数，它似乎适用于两个“正常”矩阵，但是当我传入两个稀疏矩阵时，它在 R 2.15 上给了我以下错误。

```
library(Matrix)
# Loading required package: lattice
v=Matrix(0,100,100); v[1,1]=1; 
x=v
pmax(v,x)
# Error in pmax(v, x) : (list) object cannot be coerced to type 'logical'
# In addition: Warning message:
# In any(nas) : coercing argument of type 'list' to logical 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T16:46:54.793

正如您发现`pmax`的那样，它不支持稀疏矩阵。原因是因为`cbind`不支持稀疏矩阵。的作者`Matrix`已经写`cBind`了相当于`cbind`. 如果您更改函数中的一行`pmax`，它可以正常工作：

```
pmax.sparse=function (..., na.rm = FALSE) 
{
    elts <- list(...)
    if (length(elts) == 0L) 
        stop("no arguments")
    if (all(vapply(elts, function(x) is.atomic(x) && !is.object(x), 
        NA))) {
        mmm <- .Internal(pmax(na.rm, ...))
    }
    else {
        mmm <- elts[[1L]]
        attr(mmm, "dim") <- NULL
        has.na <- FALSE
        for (each in elts[-1L]) {
            attr(each, "dim") <- NULL
            l1 <- length(each)
            l2 <- length(mmm)
            if (l2 < l1) {
                if (l2 && l1%%l2) 
                  warning("an argument will be fractionally recycled")
                mmm <- rep(mmm, length.out = l1)
            }
            else if (l1 && l1 < l2) {
                if (l2%%l1) 
                  warning("an argument will be fractionally recycled")
                each <- rep(each, length.out = l2)
            }
            # nas <- cbind(is.na(mmm), is.na(each))
            nas <- cBind(is.na(mmm), is.na(each)) # Changed row.
            if (has.na || (has.na <- any(nas))) {
                mmm[nas[, 1L]] <- each[nas[, 1L]]
                each[nas[, 2L]] <- mmm[nas[, 2L]]
            }
            change <- mmm < each
            change <- change & !is.na(change)
            mmm[change] <- each[change]
            if (has.na && !na.rm) 
                mmm[nas[, 1L] | nas[, 2L]] <- NA
        }
    }
    mostattributes(mmm) <- attributes(elts[[1L]])
    mmm
}

pmax.sparse(x,v)
# Works fine. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-06T17:13:21.593

尝试这个。它连接矩阵输出，然后在成对`summary`分组后取最大值。`(i, j)`从某种意义上说，它也是可泛化的，您可以执行任何类型的元素操作，只需替换`max`为您选择的函数（或编写一个带`FUN`参数的通用函数）。

```
pmax.sparse <- function(..., na.rm = FALSE) {

   # check that all matrices have conforming sizes
   num.rows <- unique(sapply(list(...), nrow))
   num.cols <- unique(sapply(list(...), ncol))
   stopifnot(length(num.rows) == 1)
   stopifnot(length(num.cols) == 1)

   cat.summary <- do.call(rbind, lapply(list(...), summary))
   out.summary <- aggregate(x ~ i + j, data = cat.summary, max, na.rm)

   sparseMatrix(i = out.summary$i,
                j = out.summary$j,
                x = out.summary$x,
                dims = c(num.rows, num.cols))
} 
```

如果您的矩阵太大且不够稀疏以至于此代码对于您的需要来说太慢了，我会考虑使用类似的方法`data.table`。

这是一个应用示例：

```
N <- 1000000
n <- 10000
M1 <- sparseMatrix(i = sample(N,n), j = sample(N,n), x = runif(n), dims = c(N,N))
M2 <- sparseMatrix(i = sample(N,n), j = sample(N,n), x = runif(n), dims = c(N,N))
M3 <- sparseMatrix(i = sample(N,n), j = sample(N,n), x = runif(n), dims = c(N,N))
system.time(p <- pmax.sparse(M1,M2,M3))
#   user  system elapsed 
#   2.58    0.06    2.65 
```

另一个建议的解决方案失败了：

```
Error in .class1(object) : 
  Cholmod error 'problem too large' at file ../Core/cholmod_dense.c, line 106 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-24T18:48:33.613

修改 flodel 的答案（不能直接评论答案），通过使用 data.table 包加快对更大矩阵的计算。

使用原始的 flodel 版本运行：

```
> object.size(m1)
# 131053304 bytes
> dim(m1)
# [1] 8031286      39
> object.size(m2)
# 131053304 bytes
> dim(m2)
# [1] 8031286      39
> system.time(pmax.sparse(m1, m2))
# user  system elapsed 
# 326.253  21.805 347.969 
```

将 cat.summary、out.summary 和结果矩阵的计算修改为：

```
cat.summary <- rbindlist(lapply(list(...), summary)) # that's data.table
out.summary <- cat.summary[, list(x = max(x)), by = c("i", "j")]

sparseMatrix(i = out.summary[,i],
             j = out.summary[,j],
             x = out.summary[,x],
             dims = c(num.rows, num.cols)) 
```

运行修改版本：

```
> system.time(pmax.sparse(m1, m2))
# user  system elapsed 
# 21.546   0.049  21.589 
```

# google-apps-script - 日期框不工作

> ID：11832175
> 
> 赞同：0
> 
> 时间：2012-08-06T16:22:31.837
> 
> 标签：google-apps-script

令人惊讶的是，我所有使用 datebox 并经过一段时间验证的脚本今天都不起作用。这个小工具有（我希望是暂时的）问题吗？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:44:55.147

我认为您只使用函数设置了 DataBoxes 的 ID，而不使用`setId`函数设置名称`setName`。如果是，则添加到所有 DataBoxes 附加`setName`函数调用，即如果您的代码是

```
dateBox01.setId('dateBox01'); 
```

那么应该是

```
dateBox01.setId('dateBox01').setName('dateBox01'); 
```

我今天有类似的问题。

# .net - VB 字符串生成器包含

> ID：11832176
> 
> 赞同：3
> 
> 时间：2012-08-06T16:22:41.923
> 
> 标签：.net, vb.net, stringbuilder

我在 VB 中有一个字符串生成器

我喜欢检查它是否包含一个值，如果我喜欢做某事：

```
If strMsg.Contains("<table>") Then
  ' strMsg = strMsg + "<br/><br/><br/>"
  strMsg.Append("<br/><br/><br/>")
End If 
```

我尝试了上述方法，但说包含不是 System.Text.StringBuilder 的成员。

我可以用什么代替包含

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T16:24:30.597

我会检查你在`StringBuilder`这种情况下的输入。

```
Dim hasTable As Boolean = False

' Check inputs, set hasTable to True if needed

If hasTable Then
    strMsg.Append("<br/><br/><br/>")
End If 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T16:27:41.750

`Contains()`不在[Stringbuilder 的方法](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder_methods)中。也就是说，你有几个选择......

*1.：在进入的过程中测试您的值，并为您的附加`<br>`标签*状态维护一个布尔标志。

2.：执行`ToString()`并调用`Contains()`结果：

```
if strMsg.ToString().Contains("<table>") then '... 
```

3.：实施`IndexOf()`和/或`Contains()`您自己：

```
Module StringBuilderExtensions

    <Extension()>
    Public Function IndexOf(ByVal sb As StringBuilder, ByVal value As String) As Integer

        For i As Integer = 0 To sb.Length - value.Length - 1

            For y As Integer = 0 To value.Length - 1

                If value(y) <> sb(i + y) Then

                    Exit For

                ElseIf y = value.Length - 1 Then

                    Return i

                End If

            Next

        Next

        Return -1

    End Function

    <Extension()>
    Public Function Contains(ByVal sb As StringBuilder, ByVal value As String) As Boolean

        Return sb.IndexOf(value) > -1

    End Function

End Module 
```

**免责声明**：这还没有经过性能测试......迈克尔哈伦的评论是针对该`ToString()`选项的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T11:35:14.583

`StringBuilder.ToString` *给出的建议监视输入的答案是最好的选择，但是如果您需要在决赛之前* 做任何需要访问的事情`ToString`- 在这种情况下这是替代方案 - 使用`sb.ToString(0, sb.Length)`所以`String`肯定会创建一个新的并且正在建造的可以继续（有效地）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T00:44:21.413

```
If strMsg.ToString().Contains("<table>") Then
    strMsg.Append("<br /><br /><br />")
End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T03:13:04.730

您可能也想研究正则表达式。它们允许您搜索大量文本并对其进行操作。这个[网站](http://www.ultrapico.com/Expresso.htm)有一个很棒的程序来试验它们。

[这](http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial)也是关于它们的一个很好的教程。

# python - django 访问/Runserver 时出现 404 错误，但没有返回错误

> ID：11832178
> 
> 赞同：0
> 
> 时间：2012-08-06T16:22:48.257
> 
> 标签：python, django, get, http-status-code-404, django-urls

当我 syncdb 和 runserver 在 Django 中一切正常，但是当我尝试访问它所在的网页时，`http://127.0.0.1:8000/` 它返回 404 错误。

```
Page not found (404)
Request Method: GET
Request URL:    http://127.0.0.1:8000/
Using the URLconf defined in MyBlog.urls, Django tried these URL patterns, in this order:
^admin/
The current URL, , didn't match any of these. 
```

奇怪的是，当我访问`/admin`该页面时，它工作正常。我不明白这里出了什么问题。任何帮助都是极好的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:30:09.437

您需要到主页的 URL 路由。MyBlog.urls 中的 urlpatterns 变量应该有一个像 (r'^$', app.views.show_homepage) 这样的元组对，其中 show_homepage 是在 views.py 中定义的函数。有关 URL 调度程序的更多信息，您可以在此处阅读：[https ://docs.djangoproject.com/en/dev/topics/http/urls/](https://docs.djangoproject.com/en/dev/topics/http/urls/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:37:41.443

查看[Django 编写您的第一个 Django 应用](https://docs.djangoproject.com/en/1.4/intro/tutorial03/#design-your-urls)教程的第 3 章。

简而言之，您需要指定（in `urls.py`）Django 应该为特定的 URL 运行哪些代码；没有定义默认 URL（您会在 中看到包含管理 URL 的一行`urls.py`）。

编辑你的`urls.py`，让它看起来像

```
from django.conf.urls import patterns, include, url
from django.views.generic import TemplateView

from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^$', TemplateView.as_view(template_name="home.html"),
) 
```

（您还需要`home.html`在 中指定的目录之一中创建`TEMPLATE_DIRS`）

# dojo - 在为 DOH 配置正确路径时需要帮助

> ID：11832179
> 
> 赞同：0
> 
> 时间：2012-08-06T16:22:48.517
> 
> 标签：dojo, doh

我正在尝试让 DOH 测试为我公司即将推出的平台工作，但我无法找出正确的路径组合。我们的文件结构如下所示：

```
/dojo15
  /release
    /dojo
       /dojo
          dojo.js
          dojoExt.js
  /dojo
     dojo.js
  /util
     /doh
/js
  mainLib.js
  /tests
     base.js 
```

这是由我们的承包商创建的，所以不幸的是，在我进行的过程中，有些事情我必须弄清楚。

1.  “发布”目录是我们页面上使用的目录。
2.  “util”目录在我们的发布目录中不存在。（我想避免在那里复制它。）
3.  我不完全确定他们在那里对 dojoExt.js 做了什么，但这似乎是必需的。我能够进行简单的“hello world”类型的测试，但是一旦我执行了 dojo.require(js.mainLib)，我得到了一个错误，即 dojo.behavior.add 不是一种方法。所以似乎他们制作了一个精简的 dojo.js 并将其他所需的代码放在 dojoExt.js 中。

我的猜测是 DOH 正在使用 dojo15/dojo 中的 dojo，但我需要包含 dojo15/release/dojo/dojo/dojoExt.js。我已经尝试了我能想到的 dojoUrl、testModule、registerModulePath 的所有组合......也从其他 SE 问题中看到了“启动”和“路径”，即使我在 runner.html 中看不到它们甚至会被使用的地方，但我试着把它们扔进去，看看它们是否会神奇地提供帮助。

目前我真的没有移动代码的选项，所以我希望用它们当前所在的文件来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:45:34.463

您是否尝试过我在[相关问题](https://stackoverflow.com/questions/11307908/testing-dojo-with-doh-without-local-dojo-installation)上提出的建议？我们使用我在那里详述的部分来组合一个完全自定义的 dojo + util 布局。看看 boot 和 dojoUrl。我认为是 runner.js 完成了大部分狡猾的事情，而不是 runner.html。

是您无法安排 dojoExt.js 加载的问题吗？您的其他代码如何安排它加载？tests/base.js 是你的测试模块吗？

# c# - for 循环不计算过去的 2 列 - 即使 excel 工作表的第 3 列中有数据

> ID：11832182
> 
> 赞同：0
> 
> 时间：2012-08-06T16:22:57.103
> 
> 标签：c#, macros

```
string workbookPath = filePath;
Excel.Application xlApp;
Excel.Workbook xlWorkBook;
Excel.Worksheet xlWorkSheet;
Excel.Range range;

int rCnt = 0;
int cCnt = 0;

xlApp = new Excel.Application();
xlWorkBook = xlApp.Workbooks.Open(workbookPath, 0, true, 5, "", "", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

range = xlWorkSheet.UsedRange;

int rowCount = range.Rows.Count;
int columnCount = range.Columns.Count;

string[][] myArray = new string[rowCount][];

for (rCnt = 1; rCnt < rowCount; rCnt++)
{
    myArray[rCnt] = new string[columnCount];

    for (cCnt = 1; cCnt < columnCount; cCnt++)
    {

        object str = (range.Cells[rCnt, cCnt] as Excel.Range).get_Value();
----->  myArray[rCnt][cCnt] = str == null ? string.Empty : str.ToString();

    }
}

xlWorkBook.Close(true, null, null);
xlApp.Quit();

return myArray; 
```

以上是将excel文件上传到sql数据库的代码。本质上，当我传递 ----> 上面的 rCnt 和 cCnt 变量时……行数每次增加一次，列数增加两次……我希望列数增加到 3，或者有很多可用的列。

这样做的原因可能是在 excel csv 的第一行 - 单元格中没有任何内容 - 但是，在第 4-5 行中，第 3 列中有数据。

谁能看看我错过了什么？

任何问题/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:09:06.170

我的第一个猜测是您的代码允许您返回一个锯齿状数组，`string[][] myArray = new string[rowCount][];`并且`myArray[rCnt] = new string[columnCount];`您以某种方式超出了这些界限。UsedRange 有时可能很挑剔（特别是如果您删除了数据 - 范围不会缩小以适合您当前的数据）。

这段代码对我来说很好，我在工作中使用它。不包括 COM 入口/发布代码，如果需要，我可以稍后添加。

```
public string[,] ReadArray(int SheetNumber)
{
  worksheet = (Excel.Worksheet)sheets.get_Item(SheetNumber);
  Excel.Range range = worksheet.UsedRange;

  //Get array, use range values. Not always correct, esp if user has deleted data. Ignore null values
  Object[,] arr = range.Cells.Value;
  string[,] output = new string[arr.GetLength(0), arr.GetLength(1)];

  for (int i = 0; i < arr.GetLength(0); i++)
  {
    for (int j = 0; j < arr.GetLength(1); j++)
    {
      //If nothing in the cell, write a blank
      if (arr[i + 1, j + 1] == null)
      {
        output[i, j] = "";
        continue;
      }
      //else, write the output
      output[i, j] = arr[i + 1, j + 1].ToString();
    }
  }

  if (range != null)
    Marshal.ReleaseComObject(range);
  if (worksheet != null)
    Marshal.ReleaseComObject(worksheet);

  return output;
} 
```

# postgresql - 限制 Heroku Postgres 从我们的 AWS 安全组内部连接

> ID：11832184
> 
> 赞同：1
> 
> 时间：2012-08-06T16:23:16.070
> 
> 标签：postgresql, heroku

有谁知道是否可以删除 Heroku Postgres 数据库的外部连接？

我们希望通过我们的安全组限制仅从我们的应用程序节点连接到 PG 数据库。

使用 RDS 是可能的，我们正在考虑迁移到 Heroku Postgres，但从 PCI 的角度来看，这将是一个阻碍。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T05:01:59.883

目前无法将请求限制到特定的安全组。

对于 PCI 合规性，我们强烈建议您使用符合 PCI 标准的网关，例如[https://www.braintreepayments.com](https://www.braintreepayments.com)或[https://stripe.com](https://stripe.com)，并且绝对不要在本地存储任何 CC 信息。这实际上是 Heroku 本身向我们的用户收费的方式。

# javascript - 仅在永久链接页面上显示 Tumblr 帖子中的元素

> ID：11832186
> 
> 赞同：0
> 
> 时间：2012-08-06T16:23:30.613
> 
> 标签：javascript, themes, tumblr

我有一个客户想在他们的 Tumblr 帖子上放置一个“返回博客主页”链接。问题在于，使用标准的 Tumblr 框架，该按钮将出现在永久链接帖子（它应该在的位置）上，但也会出现在索引页面上。显然我不需要主页上指向主页的链接。关于如何在此处指定的任何想法？非常感谢您的帮助！

博客链接：http: [//blog.molliestones.com/](http://blog.molliestones.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:30:03.523

如果您*只*希望它出现在帖子上（即，不出现在页面上），那么您可以对@stevether 的回答使用这个小调整：

```
{block:PermalinkPage}{block:Date}
  <a />
{/block:Date}{/block:PermalinkPage} 
```

这意味着如果页面被呈现为附加到它的日期，所有博客文章都这样做，那么它将显示。如果没有附加日期，就像所有静态页面一样，链接将不会显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:17:44.840

```
{block:permalinkpage}
  <a />
{/block:permalinkpage} 
```

# algorithm - 根据权重分配的算法，项目总数未知，保证良好的分配？

> ID：11832196
> 
> 赞同：2
> 
> 时间：2012-08-06T16:24:15.720
> 
> 标签：algorithm, distribution, probability

我想将代币分配到 3 个插槽中。

每个插槽都有一定的权重：可能 50% 的代币应该进入第一个插槽，30% 应该进入第二个插槽，20% 应该进入第三个插槽。

我不知道代币的总数——它们不断涌现。我可能会在中午获得 1000 个代币来分发，我在下午 1 点获得另外 300 个代币，依此类推，这是不可预测的。在任何时间点，我到目前为止收到的代币都应该根据权重尽可能好地分配。

一种解决方案是按概率分布。我为每个令牌掷一个 100 面骰子。如果结果是 1-50，则令牌进入插槽 1。51-80 的结果平均插槽 2，81-100 的结果平均插槽 3。

但这意味着，例如，每个令牌最终都出现在插槽 3 中并非不可能（只是不太可能）。

我想保证当我总共收到 100 个令牌时，其中正好 50 个将在插槽 1 中。当我收到 1000 个令牌时，恰好 500 应该在插槽 1 中。

什么是一个好的算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:31:20.497

根据理想分布计算每个槽中的误差。始终将令牌插入错误最多的插槽中。如果有两个或多个插槽并列，则插入其中的一个随机插槽。

误差是预期的令牌数量（添加的令牌 * 比率）与实际令牌数量之间的差异。

这样，您将始终将错误降至最低，并且如果令牌能够准确分配，则不会出现错误。

演示代码（如果错误数量相等，则插入第一个插槽，而不是随机分布）：

```
import random

tokens_in_slots = [0, 0, 0]
slot_distributions = [0.5, 0.3, 0.2]

def add_token():
    num_tokens = sum(tokens_in_slots)
    if not num_tokens:
        #first token can go anywhere
        tokens_in_slots[random.randint(0,2)] += 1
        return
    expected_tokens = [num_tokens*distr for distr in slot_distributions]
    errors = [expected - actual
              for expected, actual in zip(expected_tokens, tokens_in_slots)]
    most_error = max(enumerate(errors), key=lambda (i,e): e)
    tokens_in_slots[most_error[0]] += 1

def add_and_print(n):
    for i in xrange(n):
        add_token()
        print sum(tokens_in_slots), tokens_in_slots 
```

结果：

```
>>> add_and_print(100)
1 [0, 0, 1]
2 [1, 0, 1]
3 [1, 1, 1]
4 [2, 1, 1]
5 [2, 2, 1]
6 [3, 2, 1]
7 [3, 2, 2]
8 [4, 2, 2]
9 [4, 3, 2]
10 [5, 3, 2]
11 [6, 3, 2]
12 [6, 4, 2]
13 [6, 4, 3]
14 [7, 4, 3]
15 [7, 5, 3]
16 [8, 5, 3]
17 [8, 5, 4]
18 [9, 5, 4]
19 [9, 6, 4]
20 [10, 6, 4]
21 [11, 6, 4]
22 [11, 7, 4]
23 [11, 7, 5]
24 [12, 7, 5]
25 [12, 8, 5]
26 [13, 8, 5]
27 [13, 8, 6]
28 [14, 8, 6]
29 [14, 9, 6]
30 [15, 9, 6]
31 [16, 9, 6]
32 [16, 10, 6]
33 [16, 10, 7]
34 [17, 10, 7]
35 [17, 11, 7]
36 [18, 11, 7]
37 [18, 11, 8]
38 [19, 11, 8]
39 [19, 12, 8]
40 [20, 12, 8]
41 [21, 12, 8]
42 [21, 13, 8]
43 [21, 13, 9]
44 [22, 13, 9]
45 [22, 14, 9]
46 [23, 14, 9]
47 [23, 14, 10]
48 [24, 14, 10]
49 [24, 15, 10]
50 [25, 15, 10]
51 [26, 15, 10]
52 [26, 16, 10]
53 [26, 16, 11]
54 [27, 16, 11]
55 [27, 17, 11]
56 [28, 17, 11]
57 [28, 17, 12]
58 [29, 17, 12]
59 [29, 18, 12]
60 [30, 18, 12]
61 [31, 18, 12]
62 [31, 19, 12]
63 [31, 19, 13]
64 [32, 19, 13]
65 [32, 20, 13]
66 [33, 20, 13]
67 [33, 20, 14]
68 [34, 20, 14]
69 [34, 21, 14]
70 [35, 21, 14]
71 [36, 21, 14]
72 [36, 22, 14]
73 [36, 22, 15]
74 [37, 22, 15]
75 [37, 23, 15]
76 [38, 23, 15]
77 [38, 23, 16]
78 [39, 23, 16]
79 [39, 24, 16]
80 [40, 24, 16]
81 [41, 24, 16]
82 [41, 25, 16]
83 [41, 25, 17]
84 [42, 25, 17]
85 [42, 26, 17]
86 [43, 26, 17]
87 [43, 26, 18]
88 [44, 26, 18]
89 [44, 27, 18]
90 [45, 27, 18]
91 [46, 27, 18]
92 [46, 28, 18]
93 [46, 28, 19]
94 [47, 28, 19]
95 [47, 29, 19]
96 [48, 29, 19]
97 [48, 29, 20]
98 [49, 29, 20]
99 [49, 30, 20]
100 [50, 30, 20] 
```

结果

```
tokens_in_slots = [0, 0, 0, 0]
slot_distributions = [0.8, 0.1, 0.05, 0.05] 
```

：

```
>>> add_and_print(100)
1 [0, 0, 1, 0]
2 [1, 0, 1, 0]
3 [2, 0, 1, 0]
4 [3, 0, 1, 0]
5 [3, 1, 1, 0]
6 [4, 1, 1, 0]
7 [5, 1, 1, 0]
8 [6, 1, 1, 0]
9 [7, 1, 1, 0]
10 [7, 1, 1, 1]
11 [8, 1, 1, 1]
12 [9, 1, 1, 1]
13 [10, 1, 1, 1]
14 [11, 1, 1, 1]
15 [11, 2, 1, 1]
16 [12, 2, 1, 1]
17 [13, 2, 1, 1]
18 [14, 2, 1, 1]
19 [15, 2, 1, 1]
20 [16, 2, 1, 1]
21 [17, 2, 1, 1]
22 [17, 3, 1, 1]
23 [18, 3, 1, 1]
24 [19, 3, 1, 1]
25 [20, 3, 1, 1]
26 [20, 3, 2, 1]
27 [21, 3, 2, 1]
28 [22, 3, 2, 1]
29 [23, 3, 2, 1]
30 [23, 3, 2, 2]
31 [24, 3, 2, 2]
32 [25, 3, 2, 2]
33 [26, 3, 2, 2]
34 [27, 3, 2, 2]
35 [27, 4, 2, 2]
36 [28, 4, 2, 2]
37 [29, 4, 2, 2]
38 [30, 4, 2, 2]
39 [31, 4, 2, 2]
40 [32, 4, 2, 2]
41 [33, 4, 2, 2]
42 [33, 5, 2, 2]
43 [34, 5, 2, 2]
44 [35, 5, 2, 2]
45 [36, 5, 2, 2]
46 [36, 5, 3, 2]
47 [37, 5, 3, 2]
48 [38, 5, 3, 2]
49 [39, 5, 3, 2]
50 [39, 5, 3, 3]
51 [40, 5, 3, 3]
52 [41, 5, 3, 3]
53 [42, 5, 3, 3]
54 [43, 5, 3, 3]
55 [43, 6, 3, 3]
56 [44, 6, 3, 3]
57 [45, 6, 3, 3]
58 [46, 6, 3, 3]
59 [47, 6, 3, 3]
60 [48, 6, 3, 3]
61 [49, 6, 3, 3]
62 [49, 7, 3, 3]
63 [50, 7, 3, 3]
64 [51, 7, 3, 3]
65 [52, 7, 3, 3]
66 [52, 7, 4, 3]
67 [53, 7, 4, 3]
68 [54, 7, 4, 3]
69 [55, 7, 4, 3]
70 [55, 7, 4, 4]
71 [56, 7, 4, 4]
72 [57, 7, 4, 4]
73 [58, 7, 4, 4]
74 [59, 7, 4, 4]
75 [59, 8, 4, 4]
76 [60, 8, 4, 4]
77 [61, 8, 4, 4]
78 [62, 8, 4, 4]
79 [63, 8, 4, 4]
80 [64, 8, 4, 4]
81 [65, 8, 4, 4]
82 [65, 9, 4, 4]
83 [66, 9, 4, 4]
84 [67, 9, 4, 4]
85 [68, 9, 4, 4]
86 [68, 9, 5, 4]
87 [69, 9, 5, 4]
88 [70, 9, 5, 4]
89 [71, 9, 5, 4]
90 [71, 9, 5, 5]
91 [72, 9, 5, 5]
92 [73, 9, 5, 5]
93 [74, 9, 5, 5]
94 [75, 9, 5, 5]
95 [75, 10, 5, 5]
96 [76, 10, 5, 5]
97 [77, 10, 5, 5]
98 [78, 10, 5, 5]
99 [79, 10, 5, 5]
100 [80, 10, 5, 5] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:24:54.767

我想到的解决方案：

给每个插槽一个计算分数。将令牌放入得分最高的插槽中。如果不止一个共享该分数，我不在乎我们是选择第一个还是随机的。

计算出的分数将类似于以下 Ruby/伪代码：

```
# Example values
# Floats to avoid integer division
slot_1_weight = 50.0
total_weight  = 100.0
slot_1_tokens = 2.0
total_tokens  = 3.0

if total_tokens == 0 || total_weight == 0 || slot_1_tokens
  # Avoid division by zero.
  slot_1_score = slot_1_weight
else
  expected_distribution = slot_1_weight/total_weight
  actual_distribution = slot_1_tokens/total_tokens
  slot_1_score  = slot_1_weight * (expected_distribution/actual_distribution)
end 
```

所以当预期和实际匹配时，分数就是原来的权重。如果期望值太高，则按比例缩小权重。如果期望值太低，权重会按比例放大。

# c++ - 从一系列数字中找到加法和减法后的最小值和最大值

> ID：11832197
> 
> 赞同：0
> 
> 时间：2012-08-06T16:24:16.373
> 
> 标签：c++, algorithm

我有一个算法问题，其中给出了从 1 到 N 的数字，并且要执行许多操作，然后必须在其中找到最小值/最大值。

两个运算 - 加法和减法

和操作的形式是 abcd ，其中 a 是要执行的操作，b 是起始编号，c 是结束编号，d 是要加/减的数字

例如

> 假设数字是 1 到 N 并且 N = 5

1 2 3 4 5

我们执行操作

1 2 4 5

2 1 3 4

1 4 5 6

通过这些操作，我们将得到从 1 到 N 的数字

1 7 8 9 5

-3 3 4 9 5

-3 3 4 15 11

所以最大值是15，最小值是-3

我的方法：我取了数字的下限和上限，在这种情况下它是 1 和 5 只存储在一个数组中并应用操作，然后找到了最小值和最大值。

有没有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:14:33.440

我将假设所有更新（加法/减法）操作都发生在找到最大值/最小值之前。对于将更新和最小/最大操作混合在一起，我没有一个好的解决方案。

您可以使用普通数组，其中数组索引 i 处的值是索引 i 和原始数组的索引 (i - 1) 之间的差。这使得从索引 0 到我们数组的索引 i 的总和成为原始数组索引 i 处的值。

减法是与负数的加法，因此可以类似地对待它们。当我们需要从索引 i 到索引 j 的原始数组中添加 k 时，我们会将 k 添加到数组的索引 i，并减去 k 到数组的索引 (j + 1)。每次更新需要 O(1) 时间。

您可以通过累加对值求和并记录最大/最小值来找到原始数组的最小值/最大值。每次操作需要 O(n) 时间。我假设这对整个数组执行一次。

伪代码：

```
a[N] // Original array
d[N] // Difference array

// Initialization
d[0] = a[0]
for (i = 1 to N-1)
    d[i] = a[i] - a[i - 1]

// Addition (subtraction is similar)
add(from_idx, to_idx, amount) {
    d[from_idx] += amount
    d[to_idx + 1] -= amount
}

// Find max/min for the WHOLE array after add/subtract
current = max = min = d[0];
for (i = 1 to N - 1) {
   current += d[i]; // Sum from d[0] to d[i] is a[i]
   max = MAX(max, current);
   min = MIN(min, current);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:50:38.667

一般来说，从性能的角度来看，没有“最好的方法”来找到最小值/最大值，因为它取决于如何使用这个应用程序。

- 在列表中查找最大值和最小值需要 O(n) 时间，因此如果您想运行许多（在输入上下文中的许多）操作，那么在所有操作发生后查找最小值/最大值的方法很好.

-但是如果列表将包含许多元素并且您不想运行那么多操作，则最好检查操作的每个结果是否是新的最大值/最小值，并在必要时进行更新。

# tmux - tmux set -g mouse-mode on 不起作用

> ID：11832199
> 
> 赞同：305
> 
> 时间：2012-08-06T16:24:33.910
> 
> 标签：tmux

我一直在环顾四周，人们说

```
set -g mouse-mode on 
```

应该让您在运行 tmux 时滚动浏览终端输出。但是，在将其放入我的`~/.tmux.conf`文件并`tmux set -g mouse-mode on`在 tmux 会话中说之后，没有任何变化。当我滚动时，我仍然在 tmux 之外，就像使用默认设置在 vim 中滚动一样。

有谁知道这是为什么？

* * *

## 回答 #1

> 赞同：675
> 
> 时间：2015-10-26T00:14:54.503

所以这个选项在 2.1 版（2015 年 10 月 18 日）中被重命名

从[变更日志](https://github.com/tmux/tmux/blob/2.1/CHANGES#L6L13)：

```
 Mouse-mode has been rewritten.  There's now no longer options for:
    - mouse-resize-pane
    - mouse-select-pane
    - mouse-select-window
    - mode-mouse

  Instead there is just one option:  'mouse' which turns on mouse support 
```

所以这就是我现在在我的`.tmux.conf`文件中使用的

```
set -g mouse on 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2015-11-01T10:25:20.567

正如@Graham42 所指出的，鼠标选项在 2.1 版中已更改。现在滚动需要您先进入复制模式。要启用几乎与 2.1 之前相同的滚动，请将以下内容添加到您的`.tmux.conf`.

```
set-option -g mouse on

# make scrolling with wheels work
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M 
```

这将启用悬停在窗格上的滚动，您将能够逐行滚动该窗格。

来源：[https ://groups.google.com/d/msg/tmux-users/TRwPgEOVqho/Ck_oth_SDgAJ](https://groups.google.com/d/msg/tmux-users/TRwPgEOVqho/Ck_oth_SDgAJ)

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2015-10-23T20:02:21.093

只是对现在失去理智的其他人的快速提醒：

[https://github.com/tmux/tmux/blob/310f0a960ca64fa3809545badc629c0c166c6cd2/CHANGES#L12](https://github.com/tmux/tmux/blob/310f0a960ca64fa3809545badc629c0c166c6cd2/CHANGES#L12)

所以这只是

```
:setw -g mouse 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-08-06T16:28:17.103

这应该工作：

```
setw -g mode-mouse on 
```

然后资源然后配置文件

```
tmux source-file ~/.tmux.conf 
```

或者杀死服务器

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2018-06-24T18:24:47.663

粘贴到 ~/.tmux.conf

```
set -g mouse on 
```

并在终端上运行

```
tmux source-file ~/.tmux.conf 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-02-19T20:47:43.077

正如@Graham42 所说，从 2.1 版开始，鼠标选项已重命名，但您可以将鼠标与任何版本的 tmux 一起使用，并将其添加到您的 ~/.tmux.conf 中：

**Bash**贝壳：

```
is_pre_2_1="[[ $(tmux -V | cut -d' ' -f2) < 2.1 ]] && echo true || echo false"
if-shell "$is_pre_2_1" "setw -g mode-mouse on; set -g mouse-resize-pane on;\
      set -g mouse-select-pane on; set -g mouse-select-window on" "set -g mouse on" 
```

**Sh**（伯恩壳）壳：

```
is_pre_2_1="tmux -V | cut -d' ' -f2 | awk '{print ($0 < 2.1) ? "true" : "false"}'"
if-shell "$is_pre_2_1" "setw -g mode-mouse on; set -g mouse-resize-pane on;\
      set -g mouse-select-pane on; set -g mouse-select-window on" "set -g mouse on" 
```

希望这可以帮助

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2020-05-21T15:28:11.097

您仍然可以根据您当前的 Tmux 版本使用设置选项的魔鬼逻辑：请参阅我以前的[答案](https://stackoverflow.com/a/42332679/3589567)。

但是从 Tmux v1.7 开始，`set-option`添加了“-q”以消除错误并且不打印任何内容（请参阅[changelog](https://github.com/tmux/tmux/blob/master/CHANGES)）。我推荐使用这个特性，它更具可读性和易于扩展。

将此添加到您的`~/.tmux.conf`：

```
# from v2.1
set -gq mouse on
# before v2.1
set -gq mode-mouse on
set -gq mouse-resize-pane on
set -gq mouse-select-pane on
set -gq mouse-select-window on 
```

重新启动 tmux 或`source-file`你的新`.tmux.conf`

* * *

旁注：如果人们更喜欢这个答案，我愿意删除我的旧答案

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2021-11-04T15:28:53.917

这一行：

```
set -g mouse-mode on 
```

在您的`~/.tmux.conf`文件中将不起作用。

一方面，正确的设置是`mode-mouse`（不是`mouse-mode`）。

其次，它仅适用于旧版本`tmux`（pre-version 2；您可以运行`tmux -V`以查看您拥有的版本，但您也可以运行`man tmux`以查看是否`mode-mouse`受支持的选项）。

第三，从技术上讲`man tmux`，该`mode-mouse`选项与`setw`( `set-window-option`) 一起使用，而不与`set`( `set-option`) 一起使用，尽管我已经看到它与`set`(以及`setw`) 一起使用。

* * *

这些行应该有效：

如果您的版本`tmux`足够新（也就是说，如果`tmux -V`显示版本 2 或更新版本），您可以将这一行放入您的`~/.tmux.conf`文件中：

```
set-option -g mouse on 
```

但是，如果您使用旧版本的`tmux`，请将这些行放入您的`~/.tmux.conf`文件中：

```
set-window-option -g mode-mouse on

set-option -g mouse-resize-pane on
set-option -g mouse-select-pane on
set-option -g mouse-select-window on 
```

同样，如果您不确定要在`~/.tmux.conf`文件中放入哪一行，请运行`man tmux`并搜索`mouse-mode`、`mouse-resize-pane`、`mouse-select-pane`和/或`mouse-select-window`。如果您找到它们，请使用这些选项（旧版本的选项`tmux`）。

将这些行放入将允许您使用鼠标滚轮，它将允许您单击各种窗格以激活它们，并且它允许您通过单击并拖动它们的拆分器分隔符来调整窗格的大小。

您也可以使用鼠标进行复制和粘贴。但是，您可能会注意到，使用鼠标进行复制和粘贴可能不像在控制台上通常那样工作。为了解决这个问题，我注意到`SHIFT`在使用鼠标的复制/粘贴功能时按住键会使它们再次正常工作。或者你可以学习`tmux`复制粘贴的方法（我推荐）。

* * *

关于使用`tmux`的本机复制/选择/粘贴功能的说明：

就个人而言，我觉得这些`vi`键对我来说比默认键更有意义`emacs`（例如，使用模式退出选择模式比使用模式 + 或 + 更自然），*所以*我的文件中有这个：`vi``ENTER``emacs``CTRL``w``ALT``w``~/.tmux.conf`

```
# For vi-like keys in copy/paste/selection mode:
set-window-option -g mode-keys vi 
```

但是，我注意到在旧版本上`tmux`，此行将不起作用，*除非*我*还*包含以下行：

```
set-window-option -g mode-mouse on 
```

* * *

**很高兴知道：** 有时，当您使用鼠标的滚轮时，您会发现您的窗格/屏幕似乎被冻结或锁定（它不会响应键盘输入），并且不清楚该怎么做解锁它。

它没有上锁。您很可能处于`tmux`的选择模式。要摆脱它，请尝试以下方法之一：

*   打`ENTER`。（可能会在`vi`模式下工作。）
*   点击`ALT`+ `w`。（可能会在`emacs`模式下工作。）
*   点击`CTRL`+ `w`。（可能会在`emacs`模式下工作。）
*   点击`META`+ `w`。（可能会在`emacs`模式下工作。）
*   打`Esc`。（可能会在`emacs`模式下工作。）
*   打`q`。（可能会在`vi`模式下工作，也可能在`emacs`模式下工作。）

最终，您可以尝试点击：

`CTRL`+`w`     `ENTER`

或者：

`Esc`     `q`

很有可能，这将使您回到键盘再次响应的正常模式。

* * *

使用鼠标`vim`：

我发现将这一行放在我的`~/.vimrc`文件中：

```
:set mouse=a 
```

似乎与`tmux`, 比这行更好：

```
:set mouse=r 
```

我无法真正解释其中的区别。如果您是`vim`用户，请尝试一下，看看哪种设置最适合您。

* * *

如果您需要测试这些`tmux`选项，您可能会发现自己正在编辑文件、`~/.tmux.conf`退出. 这可能会成为一个乏味的过程，因此如果您想要一些变通方法，这里有一些选项：`tmux``tmux`

*选项 1：* 编辑（并保存）`~/.tmux.conf`文件后，运行以下命令（在 中`tmux`）：

`CTRL`+`B` `:source-file ~/.tmux.conf` `ENTER`

这将立即将`~/.tmux.conf`文件中的新设置应用到当前`tmux`会话中，而无需重新启动`tmux`.

*选项 2：* 如果您在`tmux`会话中，您可以通过在 Unix shell 提示符下运行以下命令来临时打开/关闭该会话的选项：

`tmux set-option -g mouse on`

`tmux set-window-option -g mode-keys vi`

*选项 3：*`tmux`您还可以在会话 中临时打开/关闭选项：

`CTRL`+`B` `:set-option -g mouse on` `ENTER`

`CTRL`+`B` `:set-window-option -g mode-keys vi` `ENTER`

* * *

祝你好运，玩得开心`tmux`！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-01T13:48:08.130

试试这个。它适用于我的电脑。

```
set -g mouse on 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-03-05T10:10:05.717

`Ctrl`+`B`然后设置鼠标。`-g`不再需要。

# cuda - CUDA 随机数生成

> ID：11832202
> 
> 赞同：7
> 
> 时间：2012-08-06T16:24:39.943
> 
> 标签：cuda

我想在我的`__device__`函数中生成随机数，并将其保存在我的 int Board[500] 中，我找到了一些示例，但它们使用了一些名为 curandState 的类型。我只需要一个像`rand()`C++ 中的函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T10:44:44.003

这是我的代码，我的设备内存中有 N3[40000] 数组，我在内核中为一个线程生成了一些随机数（我的意思是这个“内核<<<1,1>>> ...”），然后我将它从 CPU 复制到我的 N2[40000] 并打印出来，所以这是代码

```
#include <iostream>
#include <Cuda.h>
#include<curand.h>
#include<curand_kernel.h>

int n = 200;
using namespace std;

__device__ float generate( curandState* globalState, int ind ) 
{
    //int ind = threadIdx.x;
    curandState localState = globalState[ind];
    float RANDOM = curand_uniform( &localState );
    globalState[ind] = localState;
    return RANDOM;
}

__global__ void setup_kernel ( curandState * state, unsigned long seed )
{
    int id = threadIdx.x;
    curand_init ( seed, id, 0, &state[id] );
}

__global__ void kernel(float* N, curandState* globalState, int n)
{
    // generate random numbers
    for(int i=0;i<40000;i++)
    {
        int k = generate(globalState, i) * 100000;
        while(k > n*n-1)
        {
            k-=(n*n-1);
        }
        N[i] = k;
    }
}

int main() 
{
    int N=40000;

    curandState* devStates;
    cudaMalloc ( &devStates, N*sizeof( curandState ) );

    // setup seeds
    setup_kernel <<< 1, N >>> ( devStates,unsigned(time(NULL)) );

    float N2[40000];
    float* N3;
    cudaMalloc((void**) &N3, sizeof(float)*N);

    kernel<<<1,1>>> (N3, devStates, n);

    cudaMemcpy(N2, N3, sizeof(float)*N, cudaMemcpyDeviceToHost);

    for(int i=0;i<N;i++)
    {
        cout<<N2[i]<<endl;
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:08:21.760

您可以使用 curand 库在设备内存中生成随机数，然后运行内核，甚至无需将这些值复制到主机。

# iphone - iOS 崩溃分析和报告

> ID：11832203
> 
> 赞同：3
> 
> 时间：2012-08-06T16:24:41.720
> 
> 标签：iphone, ios, ipad, crash

我们正在为我们的 iOS 应用程序评估第三方解决方案或自定义解决方案以进行崩溃报告。我们正在研究 Crashlytics、BugSense、Testflight。他们似乎都服务于目的，即实时崩溃报告。此外，我们一直在按照[Xcode 4.2 debug doesn't symbolicate stack call的方式研究自定义解决方案实现](https://stackoverflow.com/questions/7841610/xcode-4-2-debug-doesnt-symbolicate-stack-call)

2个问题：

1.  当我们想要使用它的唯一目的是崩溃报告时，第三方解决方案（Crashlytics、BugSense 等）是否提供了优于自定义解决方案的优势？
2.  我们可以向自定义异常处理程序添加多少功能，例如，如果我想通过 HTTP post 将堆栈跟踪发布到服务器，我可以在异常处理程序中执行，还是需要等到我的应用程序下一次启动发送日志？异常处理程序应该多久退出？

谢谢， 黑塔尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:43:35.513

您不应该编写自己的崩溃报告解决方案，而应使用现有的解决方案，因为编写可靠且安全的崩溃报告器很难。[PLCrashReporter](https://code.google.com/p/plcrashreporter/)的开发人员 Landon Fuller在这篇文章中解释了原因：[可靠的崩溃报告](http://landonf.bikemonkey.org/code/objc/Reliable_Crash_Reporting.20110912.html)

一般来说，一旦发生崩溃，就应该不惜一切代价避免运行任何非异步安全的代码！这意味着必须完全避免使用任何 Objective-C 代码。这也意味着您的崩溃报告应该只在下次启动时发送到您的服务器。您也不应该依赖默认使用 PLCrashReporter 的第 3 方框架，因为该框架还应该执行异步安全操作。

编写自己的异常处理程序几乎不会像基于 PLCrashReporter 的任何东西那样详细、良好和可靠。

除了您提到的第 3 方解决方案之外，还有开源解决方案[QuincyKit](http://quincykit.net)（基于 PLCrashReporter 以及配套的基于 PHP 的基本服务器解决方案）和[HockeyApp](http://hockeyapp.net)，它们也可以与 QuincyKit 客户端一起使用。（注：我是这两种解决方案的开发者之一）

# java - 如何在 OSGi 中实现 ManagedServiceFactory？

> ID：11832204
> 
> 赞同：4
> 
> 时间：2012-08-06T16:24:50.333
> 
> 标签：java, osgi

我目前正在尝试设置我自己的`ManagedServiceFactory`. 这是我正在尝试做的事情：我需要基于每个配置的某些服务的多个实例。使用 DS，组件可以完美运行，但现在我发现这些服务应该根据某些外部资源的可用性来处理自己的生命周期（即在服务注册表中（取消）注册），而这在 DS 中是不可能的。

因此，我的想法是创建一个`ManagedServiceFactory`，然后它将接收来自`ConfigurationAdmin`我的类​​的配置并创建实例。这些将再次尝试在单独的线程中连接到资源，并在准备好操作时将自己注册为服务。

由于我还没有实现这一点，我试图将所有内容分解为最基本的部分，甚至不处理动态（取消）注册，只是试图让其`ManagedServiceFacotry`工作：

```
package my.project.factory;

import java.util.Dictionary;
import java.util.HashMap;
import java.util.Hashtable;
import java.util.Map;

import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;
import org.osgi.framework.Constants;
import org.osgi.framework.ServiceRegistration;
import org.osgi.service.cm.ConfigurationException;
import org.osgi.service.cm.ManagedServiceFactory;

public class Factory implements BundleActivator, ManagedServiceFactory {

private ServiceRegistration myReg;
private BundleContext ctx;
private Map<String, ServiceRegistration> services;

@Override
public void start(BundleContext context) throws Exception {
    System.out.println("starting factory...");
    this.ctx = context;
    java.util.Dictionary properties = new Hashtable<String, Object>();
    properties.put(Constants.SERVICE_PID, "my.project.servicefactory");
    myReg = context.registerService(ManagedServiceFactory.class, this,
            properties);
    System.out.println("registered as ManagedServiceFactory");
    services = new HashMap<String, ServiceRegistration>();
}

@Override
public void stop(BundleContext context) throws Exception {
    for(ServiceRegistration reg : services.values()) {
        System.out.println("deregister " + reg);
        reg.unregister();
    }
    if(myReg != null) {
        myReg.unregister();
    } else {
        System.out.println("my service registration as already null " +
                           "(although it shouldn't)!");
    }
}

@Override
public String getName() {
    System.out.println("returning facotry name");
    return "ServiceFactory";
}

@Override
public void updated(String pid, Dictionary properties)
        throws ConfigurationException {
    System.out.println("retrieved update for pid " + pid);
    ServiceRegistration reg = services.get(pid);
    if (reg == null) {
        services.put(pid, ctx.registerService(ServiceInterface.class,
                new Service(), properties));
    } else {
        // i should do some update here
    }
}

@Override
public void deleted(String pid) {
    ServiceRegistration reg = services.get(pid);
    if (reg != null) {
        reg.unregister();
    }
}

} 
```

现在，它应该从`ConfigurationAdmin`for PID接收配置`my.project.servicefactory`，不是吗？但它没有从`ConfigurationAdmin`. 捆绑包已启动，服务已注册，在 Web 控制台中，我可以看到配置管理员持有对我的 ManagedServiceFactory 的引用。是否应该设置某个属性？[接口规范](http://www.osgi.org/javadoc/r4v42/org/osgi/service/cm/ManagedServiceFactory.html)不建议这样做。实际上我的实现与那里的示例或多或少相同。我不知道我在这里做错了什么，非常欢迎任何指向解决方案的指针。

另外，我最初考虑将`ManagedServiceFactory`自身实现为 DS，这也应该是可能的，但我在同一点上失败了：没有配置由`ConfigAdmin`.

**更新** 澄清问题：我认为这主要是一个配置问题。正如我所看到的，我应该能够为工厂指定两个 PID，一个标识工厂本身的配置（如果有的话），另一个通过这个工厂生产服务，我认为应该是`factory.pid`. 但是框架常量不包含这样的东西。

**更新2** 在搜索了一下Felix Fileinstall源代码后，我发现当文件名中是否有a时，它对配置文件的处理方式不同`-`。将配置文件命名为`my.project.servicefactory.cfg`它不起作用，但命名的配置`my.project.servicefactory-foo.cfg`并按`my.project.servicefactory-bar.cfg`预期正确移交给了我的 ManagedServiceFactory，并且`ServiceInterface`注册了多个服务。欢呼！

**更新 3** 根据 Neil 的建议，我将[声明性服务部分放在一个新问题](https://stackoverflow.com/questions/11860240/how-do-you-properly-implement-a-managedservicefactory-as-decalarative-service-in)中，以限制该问题的范围。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T08:15:52.767

我*认为*问题在于你有一个单例配置记录而不是工厂记录。您需要使用作为*factoryPid*`createFactoryConfiguration`的方法调用 Config Admin 。`my.project.servicefactory`

 *如果您使用的是 Apache Felix FileInstall（这是一种无需编写代码即可创建配置记录的好方法），那么您需要在目录中创建一个名为`my.project.servicefactory-1.cfg`的`load`文件。`my.project.servicefactory-2.cfg`您可以通过调用它们等来创建具有相同 factoryPID 的更多配置。*

# c++ - C++ 无法建立对“父”对象的句柄引用——循环包含或未定义类型错误

> ID：11832208
> 
> 赞同：0
> 
> 时间：2012-08-06T16:24:59.800
> 
> 标签：c++, c, compiler-construction

我正在寻找一个分层的类结构，其中一个级别的控制器“父”类负责创建/指导许多“子”类。父类应该能够直接引用它创建的每个子类，并且每个子类应该能够直接引用它的父类（并且，假设这个子类不是更多类的父类，只是它的父类）。这允许通过父级引用兄弟姐妹。我发现这种范例在 Java 和 C# 等 JIT 编译语言中很有用，但 C++ 提出了一个独特的问题......

我第一次尝试实现这个范例如下：

父类 TreeRoot.h

```
#ifndef __CCPP_SCENE_H__
#define __CCPP_SCENE_H__
#include "ChildA.h"
#include "ChildB.h"

class TreeRoot : 
{
private:

ChildA* a;
ChildB* b;

public:

//member getters
ChildA* getA();
ChildB* getB();
};

#endif // __CCPP_SCENE_H__ 
```

子类 ChildA.h

```
#ifndef CHILDA_H_
#define CHILDA_H_

#include "TreeRoot.h"

class ChildA
{

private:
TreeRoot* rootScene;

public:
ChildA(TreeRoot*);
~ChildA(void);

TreeRoot* getRootScene();
void setRootScene(TreeRoot*);

};

#endif /*CHILDA_H_*/ 
```

子类 ChildB.h

```
#ifndef CHILDB_H_
#define CHILDB_H_

#include "TreeRoot.h"

class ChildB
{

private:
TreeRoot* rootScene;

public:
ChildB(TreeRoot*);
~ChildB(void);

TreeRoot* getRootScene();
void setRootScene(TreeRoot*);

};

#endif /*CHILDB_H_*/ 
```

现在当然不会因为循环包含而编译（TreeRoot.h 包括 ChildA.h 和 ChildB.h，它们都包括 TreeRoot.h 等）所以我尝试使用前向声明：

父类 TreeRoot.h

```
#ifndef __CCPP_SCENE_H__
#define __CCPP_SCENE_H__
#include "ChildA.h"
#include "ChildB.h"

class TreeRoot : 
{
private:

ChildA* a;
ChildB* b;

public:

//member getters
ChildA* getA();
ChildB* getB();
};

#endif // __CCPP_SCENE_H__ 
```

子类 ChildA.h

```
#ifndef CHILDA_H_
#define CHILDA_H_

//#include "TreeRoot.h" //can't use; circular include!
class TreeRoot;

class ChildA
{

private:
TreeRoot* rootScene;

public:
ChildA(TreeRoot*);
~ChildA(void);

TreeRoot* getRootScene();
void setRootScene(TreeRoot*);

};

#endif /*CHILDA_H_*/ 
```

子类 ChildB.h

```
#ifndef CHILDB_H_
#define CHILDB_H_

//#include "TreeRoot.h" //can't use; circular include!
class TreeRoot;

class ChildB
{

private:
TreeRoot* rootScene;

public:
ChildB(TreeRoot*);
~ChildB(void);

TreeRoot* getRootScene();
void setRootScene(TreeRoot*);

};

#endif /*CHILDB_H_*/ 
```

该实现几乎可以正常工作，因为我可以成功地将消息广播到子对象并执行从子对象到父类的回调，如下所示：

树根.cpp

```
...
a->someChildMethod();
a->getRootScene()->someParentMethod(); 
```

但是，当我尝试以下操作时：

子A.cpp

```
...
rootScene->someParentMethod(); //ERROR C2027: use of undefined type TreeRoot 
```

我得到一个未定义的类型错误。这是有道理的，因为使用上面的前向声明并不会告知编译器 TreeRoot 的实际含义。那么问题是如何启用来自子对象的调用，例如上面的 rootScene->someParentMethod() 调用？也许通过模板使用泛型类型会使编译器满意并提供我正在寻找的功能？

谢谢，CCJ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:31:33.510

`.h`在所有文件中使用前向声明。您可以这样做，因为您只将指针存储为类成员，因此您不需要完整的类声明。

然后，在所有相应的`.cpp`文件中，`#include`您需要的类的头文件。

所以，在`TreeRoot.h`你前向声明`ChildA`and `ChildB`。在`TreeRoot.cpp`，你`#include` `ChildA.h`和`ChildB.h`。

冲洗并重复您的其他 2 个课程。

请注意，这将解决您当前的问题，但这种设计充其量似乎是片状的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:30:07.030

这不涉及摆弄头文件，但我的建议是：要么让所有节点成为同一个类（实现更大的灵活性[如果你决定要将一棵树变成另一棵树的子树怎么办？你必须将根节点的类从第一棵树更改为子类]，并且至少在我看来，更有意义/看起来更优雅/会减少和/或简化您必须编写的代码的数量)，或者对父节点和子节点类都使用超类（正如 ATaylor 建议的那样），尽管我认为只有当您的父节点和子节点具有很多不同的功能时，这才是更好的解决方案树状结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T16:29:31.167

您可以尝试在 ChildA 和 ChildB 文件中包含“TreeRoot.h”。我还建议使用多态性并创建一个 A 和 B 继承自的父类，以实现共享行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:30:37.660

在 ChildA.cpp 文件中，您必须将父标头包含为

```
#include "TreeRoot.h" 
```

# magento - 在 Magento 产品之间创建新链接

> ID：11832210
> 
> 赞同：2
> 
> 时间：2012-08-06T16:25:04.330
> 
> 标签：magento

Magento 中的产品链接默认具有以下类型：

1.  有关的
2.  交叉销售
3.  追加销售
4.  分组产品

我正在为其默认功能使用默认选项。但是，我需要以另一种方式将相关产品链接在一起。那可能吗？我是否可以创建一个新的链接方法，其工作方式与相关链接选项的工作方式非常相似？

我正在销售可定制的印刷产品，例如贺卡。我只允许卡片的前视图可以在商店中搜索和查看，我们可以称之为“主产品”。一旦客户点击他们喜欢的卡片产品，我就需要显示卡片内部和背面的不同产品选项。这些是我商店中单独的 magento 产品。有些卡片有不同的文字选项、照片选项等。

因此，当我在后端添加新的“主产品”时，我需要将与内部关联的产品以及与后端关联的产品“链接”到该主产品。

“相关”产品选项卡的工作方式很棒。如果我可以在创建产品页面上使用我自己的链接属性选项卡重新创建该功能，那么我应该没问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T19:48:20.317

好的，所以你有两个选择。快速且不那么灵活的 SKU 模式匹配产品的方式，或者您可以将全新的产品链接关系添加到 Magento。显然，最后一个选项会花费更多时间，但可以让您处理来自管理员的关系并确定批次中的显示顺序。

**选项 1：在 SKU 上匹配（简单、快速，也许有点脏）**

您可以编写一个方法，比如说，获取当前产品的前 4 个字符，然后使用它来匹配产品数据库的其余部分。

下面是该代码外观的模型版本：

```
$match = substr($product->getSku(), 0, 4);
$resource = Mage::getModel('core/resource');
$read = $resource->getConnection('core_read');

$select = $read->select()
    ->from(array('e'=>$resource->getTableName('catalog/product')), 'entity_id')
    ->where("e.sku LIKE '" . $match . "%'");
$ids = $read->fetchAll($select); 
```

这将检索匹配产品的 ID。然后可以将这些 id 加载到产品集合中，例如：

```
$_productCollection = Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToSelect('<your_needed_product_attributes>')
    ->addAttributeToFilter('entity_id',array('in'=> <your_array_of_productids>));

 Mage::getSingleton('catalog/product_status')->addSaleableFilterToCollection($_productCollection);
 Mage::getSingleton('catalog/product_visibility')->addVisibleInCatalogFilterToCollection($_productCollection);
 $_productCollection->addStoreFilter()->load(); 
```

现在您只需遍历集合并构建您的 HTML。

**选项 2：添加新的产品关系**

Magento 使用该表`catalog_product_link`来存储所有类型的产品关系。在`catalog_product_link_type`您添加一个新的链接类型。这需要能够在`catalog_product_link`. 这种新的链接类型应该通过模块中的升级脚本添加。

从这一点开始，我们需要对 Magento 管理员进行调整和添加。由于这是一个提供答案的地方，而不是完整的模块解决方案，我将只标记需要我们注意添加新链接类型的地方。不过，有了以下信息，我认为您在建立和运行新关系时不会遇到太多麻烦。

1) 在产品编辑管理页面的菜单中添加新类型的选项卡。

就像`Mage_Adminhtml_Block_Catalog_Product_Edit_Tabs`我们需要为我们的链接类型创建一个新选项卡一样。

```
 $this->addTab('combine', array(
            'label'     => Mage::helper('catalog')->__('Combine'),
            'url'       => $this->getUrl('*/*/combine', array('_current' => true)),
            'class'     => 'ajax',
        )); 
```

`*/*/combine`将路由到`Mage_Adminhtml_Catalog_ProductController`控制器的组合操作。您可能希望对自己的模块使用不同的路由，但我将在此示例中坚持使用此路由。

2）为了处理页面请求`*/*/combine/`，我们需要让这个动作在控制器中可用。您将在其中找到您的代码参考`Mage_Adminhtml_Catalog_ProductController`。

```
/**
 * Get combine products grid and serializer block
 */
public function combineAction()
{
    $this->_initProduct();
    $this->loadLayout();
    $this->getLayout()->getBlock('catalog.product.edit.tab.combine')
        ->setProductsUpsell($this->getRequest()->getPost('products_combine', null));
    $this->renderLayout();
} 
```

我们还需要一个操作来处​​理此选项卡中稍后的网格操作。

```
/**
 * Get upsell products grid
 */
public function combineGridAction()
{
    $this->_initProduct();
    $this->loadLayout();
    $this->getLayout()->getBlock('catalog.product.edit.tab.combine')
        ->setProductsRelated($this->getRequest()->getPost('products_combine', null));
    $this->renderLayout();
} 
```

此外，该控制器还包含一种`->_initProductSave()`方法，其中从请求中获取产品关系并将其添加到“待保存”产品对象中。

您需要通过扩展控制器或为此使用观察者来添加下面的代码片段。你的来电。`catalog_product_before_save`观察者是做到这一点的最佳方式。

```
 if (isset($links['combine']) && !$product->getCombineReadonly()) {
        $product->setCombineLinkData(Mage::helper('adminhtml/js')->decodeGridSerializedInput($links['combine']));
    } 
```

在第 5 步中，将再次提取该数据，以进一步将新关系保存到前面提到的`catalog_product_link`表中。

3) 如果没有以下 XML 句柄，我们在第 2 步中尝试构建的布局将不会做很多事情。

```
<adminhtml_catalog_product_combine>
    <block type="core/text_list" name="root">
        <block type="<your_own_custom_block_for_product_link_type>" name="catalog.product.edit.tab.combine"/>
        <block type="adminhtml/widget_grid_serializer" name="upsell_grid_serializer">
            <reference name="upsell_grid_serializer">
                <action method="initSerializerBlock">
                    <grid_block_name>catalog.product.edit.tab.combine</grid_block_name>
                    <data_callback>getSelectedCombineProducts</data_callback>
                    <hidden_input_name>links[combine]</hidden_input_name>
                    <reload_param_name>products_combine</reload_param_name>
                </action>
                <action method="addColumnInputName">
                    <input_name>position</input_name>
                </action>
            </reference>
        </block>
    </block>
</adminhtml_catalog_product_combine>

<adminhtml_catalog_product_combinegrid>
    <block type="core/text_list" name="root">
        <block type="<your_own_custom_block_for_product_link_type>" name="catalog.product.edit.tab.combine"/>
    </block>
</adminhtml_catalog_product_combinegrid> 
```

4) 有了所有这些，我们需要为我们的“组合”类型创建块。

这一步很`fairly`简单。作为`Mage_Adminhtml_Block_Catalog_Product_Edit_Tab_Upsell`参考。我们几乎需要这个文件的精确副本。因此，将其放在您的模块中，并将所有追加销售重命名为“组合”，或您用于此关系的任何名称。您需要将此块类型`<your_own_custom_block_for_product_link_type>`放在第 3 步中。

5) 扩展 Mage_Catalog_Model_Product_Link

`Mage_Catalog_Model_Product_Link`是保存有关关系类型的所有数据的文件。例如，哪些类型可用以及一些用于保存和加载关系类型的逻辑。

在您的扩展中，您至少需要以下内容：

*   定义关系类型的常量`const LINK_TYPE_COMBINE = 6;`
*   像这样的`useCombineLinks`方法`useUpsellLinks`
*   该方法的扩展`saveProductRelations`与下面的添加。虽然这可能也可以通过适当的事件观察器来实现。

    ```
    $data = $product->getCombineLinkData();
    if (!is_null($data)) {
        $this->_getResource()->saveProductLinks($product, $data, self::LINK_TYPE_COMBINE);
    } 
    ```

此代码段最终将在保存产品后触发。

6) 向产品模型添加新的关系逻辑 让管理员启动并运行的最后一步是一些需要添加到产品模型的逻辑（`Mage_Catalog_Model_Product`）。您可能希望通过此模型上的模块的扩展来添加这些方法。

您将需要添加 4 个方法，您可以将以下内容作为参考，将它们复制并重命名为您的关系名称。

*   `getUpSellProducts`
*   `getUpSellProductIds`
*   `getUpSellProductCollection`
*   `getUpSellLinkCollection`

当您按照上述步骤操作时，您应该有一个工作管理员来添加和处理这个新的产品关系。唯一剩下的就是在页面的“前端”布局中使用一个块。这也是一个很好的参考`Mage_Catalog_Block_Product_List_Upsell`。

我希望这可以为您提供一些好的信息。你选择走哪条路。如前所述，第二个选项工作量更大，但通过管理员为您提供了更大的灵活性，并且是一个更强大的解决方案。

# ruby - 杀死 pid 从 gem net-ssh 开始

> ID：11832211
> 
> 赞同：0
> 
> 时间：2012-08-06T16:25:19.047
> 
> 标签：ruby, shell, net-ssh

如果您使用 net/ssh gem 在远程服务器中启动命令，并且该命令处于死锁状态，如何找到远程服务器中运行的进程的 pid 并杀死它？

net/ssh gem 支持这个吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-06T18:21:21.153

好吧，如果你可以`ssh`进入远程服务器，你可以使用它来获取进程的 pid：

```
# Assuming the command you want to kill is a ruby program.
# If the program is something else, say sparrow mail app, you should replace
# ruby with sparrow below.
  ps -ax | grep ruby 
```

然后，也许：

```
kill -9 <pid> 
```

# c# - 基于列以编程方式在sharepoint中创建树视图

> ID：11832212
> 
> 赞同：5
> 
> 时间：2012-08-06T16:25:21.603
> 
> 标签：c#, linq, sharepoint, sharepoint-2010, treeview

我必须为 SharePoint 开发一个 Web 部件来读取列表并创建树视图。

树视图必须按如下方式组织：根（或根）将由代表类别的选择字段创建，例如**Drinks**，子节点是包含该类别的行的名称，树视图必须以编程方式创建。

```
List:
Title(string)       Category(Choice)
Coke            Drinks
Beer            Drinks
Fish            Food
Chips           Food

Would produce this:
Drinks
    Coke
    Beer
Food
    Fish
    Chips 
```

我到目前为止的代码

```
 TreeView treeView;
    TreeNode rootNode;
    TreeNode childNode;

    protected override void RenderContents(System.Web.UI.HtmlTextWriter writer)
    {
        // render the control
        base.RenderContents(writer);
    }

    protected override void CreateChildControls()
    {
        List<TreeNode> items = new List<TreeNode>();

        base.CreateChildControls();

        // get the current site
        using (SPSite Site = new SPSite(SPContext.Current.Site.Url + "/UberWiki"))
        {
            using (SPWeb currentWeb = Site.OpenWeb())
            {

                // set the tree view properties

                SPList list = currentWeb.Lists["Pages"];

                SPFieldChoice field = (SPFieldChoice)list.Fields["Categories"];

                foreach (string str in field.Choices)
                {
                    treeView = new System.Web.UI.WebControls.TreeView();
                    rootNode = new System.Web.UI.WebControls.TreeNode(str);
                    treeView.Nodes.Add(rootNode);

                    foreach (SPListItem rows in list.Items)
                    {
                        childNode = new System.Web.UI.WebControls.TreeNode(rows.Title);
                        treeView.Nodes.Add(childNode);
                    }
                }
            }
            this.Controls.Add(treeView);
            base.CreateChildControls();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T15:44:32.740

找到了解决方案：

```
 using (SPSite Site = new SPSite(SPContext.Current.Site.Url + "/UberWiki"))
                        {
                            using (SPWeb currentWeb = Site.OpenWeb())
                            {

                                SPList list = currentWeb.Lists["Pages"];
                                SPFieldChoice field = (SPFieldChoice)list.Fields["Categories"];

                                treeView = new System.Web.UI.WebControls.TreeView();

                                foreach (string str in field.Choices)
                                {

                                    treeNode = new System.Web.UI.WebControls.TreeNode(str);

                                    foreach (SPListItem rows in list.Items)
                                    {
                                        SPFieldMultiChoiceValue multiChoice = new SPFieldMultiChoiceValue(Convert.ToString(rows["Wiki Categories"]));

                                        string input = multiChoice.ToString();
//remove the ;# that comes with the multiple choiches
                                        string cleanString = input.Replace(";#", "");

                                        if (cleanString == str)
                                        {
                                            string PageNameWithExt = rows.Name;

                                            childNode = new System.Web.UI.WebControls.TreeNode(PageNameWithExt);

                                            treeNode.ChildNodes.Add(childNode);
                                        }
                                    }
                                    treeView.Nodes.Add(treeNode);
                                }
                            }
                        }
                        this.Controls.Add(treeView);
                        base.CreateChildControls();
                    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T07:28:47.983

另一种无需清理多选字符串值的解决方案

```
using (SPSite Site = new SPSite(SPContext.Current.Site.Url + "/UberWiki"))
{
    using (SPWeb currentWeb = Site.OpenWeb())
    {
        // set the tree view properties
        SPList list = currentWeb.GetList(currentWeb.Url+"/Lists/Pages");

        SPFieldChoice field = (SPFieldChoice)list.Fields["Categories"];
        treeView = new System.Web.UI.WebControls.TreeView();

        // Add root nodes
        foreach (string str in field.Choices)
        {
            rootNode = new System.Web.UI.WebControls.TreeNode(str);
            treeView.Nodes.Add(rootNode);                        
        }

        // Add child nodes
        foreach (SPListItem rows in list.Items)
        {
            childNode = new System.Web.UI.WebControls.TreeNode(rows["Title"].ToString());
            treeView.FindNode(rows["Categories"].ToString()).ChildNodes.Add(childNode);
        }
    }
    this.Controls.Add(treeView);
    base.CreateChildControls();
} 
```

# backbone.js - 主干选择器和使用查找

> ID：11832220
> 
> 赞同：0
> 
> 时间：2012-08-06T16:25:53.403
> 
> 标签：backbone.js, backbone-views

我看到一些奇怪的行为，希望有人能解释一下。

从主干视图中的渲染方法，我一直在尝试执行以下操作：

```
this.$(".msg").colorbox(); 
```

和

```
this.$el.find(".msg").colorbox(); 
```

然而，在这两种情况下，虽然 msg 元素都已定位，但当尝试在返回的元素上调用 colorbox 方法时，我得到一个未定义该方法的异常。

但是，当我使用：

```
$(this.el).find(".msg").colorbox(); 
```

一切都很好。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:57:00.130

这是一个常见的问题。当然 colorbox 是一个 jQuery 插件。jQuery 插件被注入，直到视图的元素被添加到页面的 DOM 中。

我的意思是，您的代码因自然行为而失败是正常的。

```
$('body').append( view.render().el ); 
```

但如果你这样做，它会起作用：

```
$('body').append( view.el );
view.render(); 
```

第三方 Backbone.js 插件有一个名为 onRender 的方法，该方法在渲染视图后执行（并假设已添加到 DOM）。但是，如果您不使用其他 Backbone.js 插件，请确保调用颜色框，直到您的视图被添加到 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:30:17.097

在黑暗中拍摄...

`this.$el`并且`$(this.el)`是不同的实例，即使两者都引用相同的 DOM 元素。

也许从 Backbone 进行预编译`this.$el = $(this.el)`的那一刻到您调用`this.$el.colorbox()`某事的那一刻已经发生了，所以这个函数不可用并且它在实例中从未可用过`this.$el`。

我不知道是什么，`colorbox()`但如果这是第三方 jQuery 插件的一部分，那么加载 JS 代码的顺序可能很重要？

# vb.net - 两个坐标的图像结果

> ID：11832234
> 
> 赞同：0
> 
> 时间：2012-08-06T16:26:50.363
> 
> 标签：vb.net, google-maps, map, coordinates

有什么方法可以输入两个位置（起点和目的地）的坐标，并获得地图的图像结果（jpeg），比如谷歌地图，在同一张图像上显示两个位置？

我需要这个用于 vb 应用程序谢谢！

更新：我已经成功添加了两个位置的图像，但是有一个小问题，如果两个位置太近或太远怎么办，缩放应该不同，也许大小也不同，什么是最好的根据给定的坐标，如何操作这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:10:13.390

是的，您可以使用静态地图 API 来获取地图图像： [https ://developers.google.com/maps/documentation/imageapis/](https://developers.google.com/maps/documentation/imageapis/)

# bpel - Apache ODE、BPEL、调用 RESTful API

> ID：11832235
> 
> 赞同：0
> 
> 时间：2012-08-06T16:26:53.573
> 
> 标签：bpel, restful-architecture, orchestration, apache-ode

Apache ODE 文档似乎支持这一点，即调用/编排 RESTFul API。他们的网站上没有可用的示例资源，即使在 Google 上努力尝试后也找不到任何有用的东西。

有人可以帮我找到方向吗？

我正在使用带有 Eclipse BPEL 设计器的最新 Apache ODE 发行版。

我们拥有大量 RESTFul API，它们完全为我们的业务流程提供核心接口。BPEL 似乎是很好的编排/工作流编程解决方案，但如果没有开箱即用的 RESTFul API 支持，我几乎要放弃它。

我一定在这里遗漏了一些东西。请建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T17:34:44.273

此示例符合 ws-BPEL 2.0 标准，我们仅在 wso2 bps 上进行了测试，您将能够在 ODE 上运行它，只需对流程进行最少的更改。[https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/products/bps/3.0.0/modules/samples/product/src/main/resources/bpel/2.0/TestRESTProcess](https://svn.wso2.org/repos/wso2/carbon/platform/branches/4.0.0/products/bps/3.0.0/modules/samples/product/src/main/resources/bpel/2.0/TestRESTProcess)

# .net - 是否可以在 .NET WMQ API 中读取 JMSDeliveryMode 属性？

> ID：11832238
> 
> 赞同：0
> 
> 时间：2012-08-06T16:26:56.757
> 
> 标签：.net, jms, ibm-mq

我正在尝试使用.NET WMQ API 使用.NET 应用程序通过 WebSphere MQ (WebSphere MQ Server v7) 发送的 JMS 消息。我正在使用 WebSphere MQ Client v7.5 和 amqmdnet.dll 版本 7.5.0.0。

`JMSDeliveryMode`读取属性（`Dlv`来自`jms`RFH2 文件夹的属性）时有一些非常奇怪的行为。JMS 应用程序（WebSphere Application Server v7 中托管的 servlet）发送的属性值设置为`Persistent`(2)，但我的 .NET 客户端始终读取 1（这意味着`Non_persistent`）。我需要读取正确的值，因为我的 .NET 应用程序用作路由器/转发器，它必须转发具有正确配置的消息。

我尝试使用[RFHUtils](https://sites.google.com/site/ibmmiddleware/rfhutils)模拟 JMS 消息。当我将传递模式设置为 1 并将其发送到我的 .NET 客户端时，它再次读取 1，但如果我还在 MQMD 中更改 MQ 消息的持久性，它读取为 0。看起来`JMSDeliveryMode`根本没有使用 in 的值，并且 .NET 客户端总是从属性中读取值，`Persistence`但这是不正确的行为！这两个属性具有不同的正确值范围：

`JMSDeliveryMode`正确的值（来自 jms.jar）：

*   1 -`DeliveryMode.NON_PERSISTENT`
*   2 -`DeliveryMode.PERSISTENT`

`Persistence`正确的值（来自 amqmdnet.dll）：

*   0 -`MQC.MQPER_NOT_PERSISTENT`
*   1 -`MQC.MQPER_PERSISTENT`
*   2 - `MQC.MQPER_PERSISTENCE_AS_Q_DEF`/`MQC.MQPER_PERSISTENCE_AS_TOPIC_DEF`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:26:56.757

这又是 IBM 的 amqmdnet.dll 中的错误。[在使用.NET Reflector](http://www.reflector.net/)反汇编库并检查负责读取 JMS 属性的代码（类`GetJmsProperty`的私有方法`MQMessage`）后，我发现：

```
if (name.Equals("JMSDeliveryMode"))
{
   // Properties never contain the property with such name!
   if (this.properties.ContainsKey("JMSDeliveryMode"))
   {
      ...
   }
   return this.Persistence;  // Executes always
} 
```

问题是`properties`集合从不包含任何`JMSDeliveryMode`作为键的属性。`properties`集合包含格式*为 RFH2Folder.RFH2PropertyName*的 RFH2 标头。正确的属性名称`JMSDeliveryMode`是`jms.Dlv`! 有趣的是`GetJmsHeader`，在属性集合中搜索时，方法会读取所有 JMS 属性，并且所有其他属性都使用正确的 RFH2 名称！

当我检查反向操作时情况更糟 -类中的私有方法`SetJmsProperty`。`MQMessage`设置`JMSDeliveryMode`包含此代码：

```
else if (name.Equals("JMSDeliveryMode"))
{
    if (value is int)
    {
        int num2 = Convert.ToInt32(value);
        switch (num2)
        {
            // Non persistent JMS message creates persistent MQ message  
            case 1:
                this.Persistence = 1;
                break;
            // Invalid value for JMS delivery mode            
            case 0:
                this.Persistence = 0;
                break;
            // Great if I try to create persistent JMS message I will 
            // get MQRC_PERSISTENCE_ERROR exception!            
            default:
                base.throwNewMQException(2, 0x7ff);
                break;
        }

        queue.Enqueue(num2);
        // Correct RFH2 identifier is used
        this.properties.Add("jms.Dlv", queue);
    }
    else
    {
        base.throwNewMQException(2, 0x9a9);
    }
} 
```

因此设置`JMSDelivery`模式将触发异常或设置无效持久性！这是重现问题的小测试：

```
[Test]
public void PutAndGetMessageWithDeliveryMode() {
    using (MQQueue queue = _queueManager.AccessQueue(TestQueue, MQC.MQOO_OUTPUT | MQC.MQOO_INPUT_AS_Q_DEF)) {

        MQMessage message = new MQMessage();
        message.SetInt4Property("JMSDeliveryMode", 2);
        message.WriteString("some string");
        message.Format = MQC.MQFMT_STRING;

        queue.Put(message); 

        MQMessage readMessage = new MQMessage();
        queue.Get(readMessage); 

        Assert.AreEqual(2, readMessage.GetInt4Property("JMSDeliveryMode"));

        queue.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T18:05:35.400

MQ .NET 中 Persistence 的值是正确的，您可以与`cmqc.h`头文件进行比较，因为 amqmdnet 和 C MQI 都是 MQ 原生 API。

```
0 - MQC.MQPER_NOT_PERSISTENT
1 - MQC.MQPER_PERSISTENT
2 - MQC.MQPER_PERSISTENCE_AS_Q_DEF / MQC.MQPER_PERSISTENCE_AS_TOPIC_DEF 
```

jms.jar DeliveryMode 枚举定义了不同的值。我想 MQ JMS 实现会在内部适当地处理这个问题，并在 MQMD 和 RFH2 属性中设置正确的 MQ 特定值。

关于您使用 RFH2Util 进行的测试。在 MQMD 选项卡和 JMS 中设置的值可能不同。`No`您可以在 JMS 选项卡中将 DeliveryMode 设置为 1，在 MQMD 选项卡中将Persistent Msg 设置为。放置消息时，MQMD.Persistence 将显示为`0`，而 JMSDeliveryMode 将显示为 1。我通过在 MQ Explorer 中查看消息确认了此值。MQ .NET API 只是为您提供它从消息中得到的信息。据我所知，RFHUtil 是一个设置 RFH 属性的工具。它只是设置/获取 RFH 属性。它没有 MQ JMS 实现的智能。

在我看来，“JMSxxxx”属性最好由 JMS 实现处理，而不是由像 MQ .NET 这样的本机实现。

# phpunit - Phing PHPUnit 运行所有 php 文件

> ID：11832248
> 
> 赞同：0
> 
> 时间：2012-08-06T16:27:47.007
> 
> 标签：phpunit, phing

我正在使用 Phing 在一个名为 runtest 的文件夹上运行 phpunit，该文件夹包含我所有的 phpunit 测试。

我的 build.xml 如下：

```
<project name="TiVO" default="build">
 <target name="clean">
  <delete dir="build"/>
 </target>

 <target name="prepare">
  <mkdir dir="build/logs"/>
 </target>

 <target name="phpunit">
  <phpunit bootstrap="runtest/initalize.php" printsummary="true" haltonfailure="true">
    <formatter todir="build/logs" type="xml"/>
    <batchtest>
      <fileset dir="runtest">
        <include name="*.php"/>
      </fileset>
    </batchtest>
  </phpunit>
 </target>

 <target name="build" depends="clean,prepare,phpunit"/>
</project> 
```

问题是它不运行任何以 .php 结尾的 php 文件（例如 Channel.php、Video.php），并且只有在我将包含名称更改为：

```
 <include name="*Test.php"/> 
```

然后它运行一个匹配模式 *Test.php 的 MyChannelTest.php 文件，这很公平。

如何更改我的 build.xml 以运行 runtest 目录中以 .php 结尾的任何文件？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:49:54.663

抱歉，包含名称过滤器正在工作，第一个 phpunit 文件在执行时出现问题，导致构建失败，并且在它之后没有执行任何测试 php 单元没有报告错误，使它看起来好像没有执行任何文件。

# c# - 当 ac# .net using block 失败时会发生什么？

> ID：11832249
> 
> 赞同：3
> 
> 时间：2012-08-06T16:27:53.790
> 
> 标签：c#, .net, block, using

如果我有一个 using 块，我在其中创建了一个对象（例如 FileStream 对象），而该对象未能创建（返回 null、引发异常等），块中的代码是否仍然执行？

```
using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) {
    // do stuff with fs here
}
// do more stuff after 
```

如果 FileStream 构造函数要返回 null （如果 FileStream 构造函数总是返回一个有效的对象，我们只是为了参数的缘故，可以返回 null），里面的代码会执行吗？还是会跳过“在这里用 fs 做事”代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T16:30:43.233

```
using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) 
{
    // do stuff with fs here
}
// do more stuff after 
```

相当于：

```
FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
try
{
    // do stuff with fs here
}
finally
{
    if (fs != null)
    {
        ((IDisposable)fs).Dispose();
    }
}
// do more stuff after 
```

所以回答你的问题：

> 如果 FileStream 构造函数要返回 null （如果 FileStream 构造函数总是返回一个有效的对象，我们只是为了参数的缘故，可以返回 null），里面的代码会执行吗？

是的，它会。

显然，熟悉 C# 规范的每个人都知道，构造函数（无论是哪种类型）**永远无法**返回`null`哪种类型，这让您的问题有点不切实际。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:31:03.370

异常将照常处理，即通过封闭的 try...catch 如果您有一个或由系统处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:31:49.073

如果它抛出异常，它肯定不会执行。如果没有抛出异常，它将尝试执行该块。虽然如果它返回 null，我的猜测是在从内部抛出异常并退出之前不会走得太远。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:31:50.147

无论如何，代码都会执行，因此您需要保护您的代码免受它的影响。以这个控制台应用程序为例，`WriteLine`它将执行。

```
class Program
{
    static void Main(string[] args)
    {
        using (null)
        {
            Console.WriteLine("Hello.");
        }
    }
} 
```

# css - css bootstrap 显示按钮内嵌文本

> ID：11832250
> 
> 赞同：43
> 
> 时间：2012-08-06T16:28:01.763
> 
> 标签：css, twitter-bootstrap

我正在使用推特引导程序。

我正在尝试创建一个带有下拉菜单的按钮，该按钮应在文本之后立即显示。

按钮和所有内容都已创建，但它出现在下一行，而不是与我的文本在同一行。

这或多或少是代码：

```
<h1> Some title

    <div class="btn-group" xmlns="http://www.w3.org/1999/html">
      <button class="btn btn-mini">Edit</button>
      <button class="btn btn-mini dropdown-toggle data-toggle="dropdown">
          <span class="caret"></span>
      </button>
      <ul class="dropdown-menu">
         <li> ...my menu's...</li>
      </ul>
    </div>
</h1> 
```

h1 标签没有分配特殊的定位。我试图在 h1 标签中添加一个 float: left 但它不起作用，因为在 btn-group 的 css 中有一个 clear:both。

怎么了？谢谢！

**更新：**

我还尝试向 div 添加一个 .pull-right 类。这会将它带到正确的行，但它位于页面的右侧。不只是在正文之后。这太遥远了。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-06T17:28:25.410

我真的不知道你是怎么得到那个标记的，但这是一个工作版本：（[jsfiddle 上](http://jsfiddle.net/Sherbrow/5N6FQ/)的演示）

```
<h1> Some title
    <small>
        <span class="btn-group">
            <button class="btn btn-mini">Edit</button>
            <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li><a href="#">...my menus...</a></li>
            </ul>
        </span>
    </small>
</h1> 
```

```
h1 .btn-group { display: inline-block; } 
```

我只建议你使用`<small>`标签，因为它设置了一些与`<h1>`. 但这不是必需的。

# winapi - 子窗口将消息转发给父窗口

> ID：11832252
> 
> 赞同：1
> 
> 时间：2012-08-06T16:28:11.770
> 
> 标签：winapi, mfc

我有一个父窗口（MFC 对话框），上面有一些控件（编辑框、按钮等），如下所示：

![初始对话框的外观](../Images/1afc5a890f83d995a41c653c81ec6d8b.png)

在运行时 ( `OnInitDialog`)，我创建了另一个子窗口，它覆盖并隐藏了对话框中的所有其他控件，使用以下代码：

```
 RECT r;
  GetClientRect(&r);
  m_layer.Create(NULL, NULL, WS_CHILD | WS_VISIBLE, r, this, 0); 
```

该对象是继承自`m_layer`的类的实例。在这个类中，我重写了以下方法：`CLaywerWnd``CWnd`

```
BOOL CLayerWnd::OnEraseBkgnd(CDC* pDC)
{
  CBrush b(RGB(0, 100, 100));
  RECT r;
  GetClientRect(&r);
  pDC->FillRect(&r, &b);
  return TRUE;
} 
```

现在我的窗口看起来像这样：

![带有覆盖控件的子窗口的父级](../Images/29151d845bd88de05dcd2bfe26418afa.png)

问题是，当我移动鼠标光标或单击这个新的子窗口时，消息会转发到父窗口（我使用 Spy++ 进行了检查），并且其他子控件会在新的子窗口上重绘，如下所示。

![孩子们重画了](../Images/029c62823a727c5e7bc7705222e64c06.png)

我不明白为什么会发生这种情况，我想知道如何避免这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:33:53.017

我可能错了，但我想知道您是否在代码中混淆了两个对话框的句柄，以至于您将消息发布到错误的对话框？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:40:03.813

避免它的一种简单方法需要两个步骤：

1.  将所有隐藏控件的状态更改为禁用，这样它们就不会对任何消息做出反应。
2.  确保覆盖窗口位于 Z 顺序的顶部。您可以在创建窗口时或稍后使用`SetWindowPos`.

# python - 了解 numpy memmap 的性能

> ID：11832254
> 
> 赞同：5
> 
> 时间：2012-08-06T16:28:22.410
> 
> 标签：python, performance, numpy

我试图更好地理解 numpy 的 memmap 如何处理非常大文件的视图。下面的脚本打开一个内存映射的 2048^3 数组，并复制它的下采样 128^3 视图

```
import numpy as np
from time import time

FILE = '/Volumes/BlackBox/test.dat'
array = np.memmap(FILE, mode='r', shape=(2048,2048,2048), dtype=np.float64)

t = time()
for i in range(5):
    view = np.array(array[::16, ::16, ::16])
t = ((time() - t) / 5) * 1000
print "Time (ms): %i" % t 
```

通常，这会打印`Time (ms): 80`左右。但是，如果我将视图分配更改为

```
view = np.array(array[1::16, 2::16, 3::16]) 
```

并运行三遍，我得到以下信息：

```
Time (ms): 9988
Time (ms): 79
Time (ms): 78 
```

有谁明白为什么第一次调用这么慢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:36:00.970

操作系统仍然有部分（或全部）可用的映射文件缓存在物理 RAM 中。初始读取必须访问磁盘，这*比*访问 RAM 慢得多。做足够多的其他磁盘 IO，你会发现你会回到更接近原来的时间，操作系统必须重新读取它没有再次从磁盘缓存的位......

# c# - 外连接的编译版本是什么样的？

> ID：11832257
> 
> 赞同：1
> 
> 时间：2012-08-06T16:28:41.473
> 
> 标签：c#, linq, linq-to-entities

给定一个带有外连接的 LINQ to Entity 查询...

```
var query = from items in entityDb.TableName
         join requestedBy in entityDb.People on items.RequestedById equals requestedBy.PersonId into requestedByOuter
         from requestedBy in requestedByOuter.DefaultIfEmpty()
         select items; 
```

这种外连接的编译（Lamba 表达式）版本是什么样的？有没有办法在 Visual Studio 调试器中看到这个？

**更新**
为了澄清，Jon Skeet 在他的[书中](http://manning.com/skeet2/)解释说，查询表达式在进行“真正的编译”之前被“编译器翻译”为普通的 C# 代码。我的问题是，在外连接的情况下，查询表达式如何转换为真正的 C#？而且，我们可以在调试器中或通过其他方式看到这些翻译吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:50:02.370

以下声明：

```
from u in TblUsers
join c in TblCompanies on u.FkCompanyID equals c.PkCompanyID into g
from x in g.DefaultIfEmpty()
select u 
```

会导致这个lamba表达式（根据优秀的应用程序[LINQPad](http://www.linqpad.net/)）：

```
TblUsers
   .GroupJoin (
      TblCompanies, 
      u => u.FkCompanyID, 
      c => c.PkCompanyID, 
      (u, g) => 
         new  
         {
            u = u, 
            g = g
         }
   )
   .SelectMany (
      temp0 => temp0.g.DefaultIfEmpty (), 
      (temp0, x) => temp0.u
   ) 
```

# ruby-on-rails - ActiveAdmin 显示部分看不到模型

> ID：11832258
> 
> 赞同：4
> 
> 时间：2012-08-06T16:28:41.983
> 
> 标签：ruby-on-rails, haml, activeadmin

在 ActiveAdmin 0.4.3 和 Rails 3.2.2 中，我正在尝试自定义我的文章模式的显示屏幕

```
ActiveAdmin.register Article do

  show do
     render "show"
  end

end 
```

在 app/views/admin/articles/_show.html.haml

```
%div= article.description 
```

但是每当我尝试展示一篇文章时，我都会得到：

```
NoMethodError in Admin/articles#show

Showing /Users/phishman/Sites/wisegrowth/app/views/admin/articles/_show.html.haml where line #1 raised:

undefined method `description' for <article></article>
:Arbre::HTML::Article

Extracted source (around line #1):

1: %div= article.description

Trace of template inclusion: /Users/phishman/.rvm/gems/ruby-1.9.2-p290/gems/activeadmin-0.4.3/app/views/active_admin/resource/show.html.arb

Rails.root: /Users/phishman/Sites/wisegrowth
Application Trace | Framework Trace | Full Trace

app/views/admin/articles/_show.html.haml:1:in `_app_views_admin_articles__show_html_haml___3305533421865107600_2209712640'
app/admin/articles.rb:20:in `block (2 levels) in <top (required)>'
app/middleware/flash_session_cookie_middleware.rb:17:in `call' 
```

你能帮我解决这个问题吗？这让我快疯了！

在控制台中，一切似乎都运行良好，如果我这样做：

```
a = Article.last
a.description
=> "my article description" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T04:01:40.713

试试这个：

`render :partial => "show", :locals => {:article => article }`

# ios - iframe 内容中没有调整大小事件（iOS Safari）

> ID：11832259
> 
> 赞同：1
> 
> 时间：2012-08-06T16:28:48.623
> 
> 标签：ios, iframe, safari, resize

我有以下html页面：

```
<html>
<head>
    <script type="text/javascript">
var myDiv = null;

window.onload = function() {
    myDiv = document.getElementById("myDiv");
};

function buttonClick() {
    myDiv.style.width = "200px";
    myDiv.style.height = "100px";
}
    </script>
</head>
<body>
    <div id="myDiv" style="left:10px; top:10px; width:1000px; height:250px; overflow:auto;">
        <iframe scrolling="no" id="myIframe" style="width:100%;height:100%" src="a.svg"></iframe>
    </div>
    <input type="button" id="button1" onclick="buttonClick()" value="resize div"/>
</body>
</html> 
```

和一个 SVG “a.svg”，它是上面 iframe 的内容：

```
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="500">
    <circle cx="500" cy="250" r="240"/>
    <script type="text/ecmascript"><![CDATA[
window.onresize = function() {
    console.log("resize");
};
]]></script>
</svg> 
```

当我现在在 iOS Safari 上打开 html 页面并单击按钮将 iframe 调整为 200x100 像素时，我没有收到调整大小事件。

但是如果我在像 Firefox 这样的 PC 浏览器上做同样的事情，我会得到 resize 事件。我知道 iframe 在 iOS Safari 中的处理方式不同，但我怎样才能让它工作呢？

# mysql - Mysql按组处理数据

> ID：11832263
> 
> 赞同：3
> 
> 时间：2012-08-06T16:29:18.413
> 
> 标签：mysql

我有几组数据。每个组都有一些`property`字段。例如：

```
_________________________
| id  | value | property |  
--------------------------
| 1    |  2    |    3    |
--------------------------
| 2    |  2    |    3    |
--------------------------
| 3    |  2    |    3    |
--------------------------
| 4    |  2    |    4    |
-------------------------
| 5    |  2    |    4    |
--------------------------
| 6    |  2    |    4    |
-------------------------- 
```

如何更新由`id ASC`with排序的两个字符串，以及**由一个查询**`property = 3`排序的 2 个字符串？`id ASC``property = 4`

 **我想用 更新 3 行中的 2 行，用`property = 3`更新 3 行中的 2 行`property = 4`。例如：id 为 1 和 2 的行，以及 id 为 4 和 5 的行，即我希望**通过一个查询**
更新具有不同条件的数据组

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T14:31:22.683

您可以使用计算的排名字段来做到这一点，例如 -

```
SELECT p1.*, COUNT(*) rank FROM properties p1
  LEFT JOIN properties p2
    ON p2.property = p1.property AND p2.id <= p1.id
  GROUP BY p1.property, p1.id 
```

此查询将按属性返回具有行号的数据集：

```
+------+-------+----------+------+
| id   | value | property | rank |
+------+-------+----------+------+
|    1 |     2 |        3 |    1 |
|    2 |     2 |        3 |    2 |
|    3 |     2 |        3 |    3 |
|    4 |     2 |        4 |    1 |
|    5 |     2 |        4 |    2 |
|    6 |     2 |        4 |    3 |
+------+-------+----------+------+ 
```

然后你应该更新 rank < 3 的记录：

```
UPDATE properties p
  JOIN (SELECT p1.*, COUNT(*) rank FROM properties p1
          LEFT JOIN properties p2
            ON p2.property = p1.property AND p2.id <= p1.id
        GROUP BY p1.property, p1.id) r
  ON p.id = r.id
  SET p.value = 100 -- set new value here
  WHERE r.rank < 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:35:22.677

我假设您的意思是将您的两次更新限制为每行两行。您可以在更新语句中使用`ORDER BY`和：`LIMIT`

```
UPDATE yourtable
SET property = 'new_value'
WHERE value=2 AND property = 4
ORDER BY id ASC LIMIT 2

UPDATE yourtable
SET property = 'new_value'
WHERE value=2 AND property = 3
ORDER BY id DESC LIMIT 2 
```

### 更新：

要将其强制到一个查询中，您需要`JOIN`针对一个子查询，该子查询检索要通过`UNION`. 我*认为*这是合法的：

```
UPDATE yourtable
  JOIN (
    (SELECT id FROM yourtable WHERE value=2 AND property=4 ORDER BY id ASC LIMIT 2)
    UNION ALL
    (SELECT id FROM yourtable WHERE value=2 AND property=3 ORDER BY id DESC LIMIT 2)
  ) updaterows ON yourtable.id = updaterows.id
SET property = 'new value' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:11:09.057

这是解决方案，请参阅以下讨论：

```
update 
  t,
  (select GROUP_CONCAT(ids) as matching_ids from (
    select 
      SUBSTRING_INDEX(GROUP_CONCAT(id order by id), ',', 2) AS ids
    from
      t
    where
      property in (3,4)
    group by
      property
    ) s1
  ) s2
set value=12345
where 
  FIND_IN_SET(id, matching_ids) > 0
; 
```

为了说明，假设您的表被称为`t`，并且初始状态是：

```
root@mysql-5.1.51> select * from t;
+----+-------+----------+
| id | value | property |
+----+-------+----------+
|  1 |     2 |        3 |
|  2 |     2 |        3 |
|  3 |     2 |        3 |
|  4 |     2 |        4 |
|  5 |     2 |        4 |
|  6 |     2 |        4 |
+----+-------+----------+ 
```

运行此查询的结果是：

```
root@mysql-5.1.51> select * from t;
+----+-------+----------+
| id | value | property |
+----+-------+----------+
|  1 | 12345 |        3 |
|  2 | 12345 |        3 |
|  3 |     2 |        3 |
|  4 | 12345 |        4 |
|  5 | 12345 |        4 |
|  6 |     2 |        4 |
+----+-------+----------+ 
```

查询的简要说明：

我使用该语句`id`为每个属性选择前两个s。`SUBSTRING_INDEX(GROUP_CONCAT(id order by id), ',', 2)`

我结合上述使用`GROUP_CONCAT(ids) as matching_ids`来获得所有有效`id`的s。

最后，我更新了表中所有`id`在组合`matching_ids`文本中的行。

**笔记：**

*   您应该验证您的`group_concat_max_len`变量是否足够长。默认为**1024**。无论如何，您很可能希望拥有数百万个（不管我的回答如何）。

*   查询远非最佳。它回答了您的问题，但您无法在此处找到最佳查询。

*   包含两个或三个查询的事务很可能会更好。

祝你好运！****

# google-maps - 谷歌地图+基于邮政编码的绘图点（标记）

> ID：11832268
> 
> 赞同：1
> 
> 时间：2012-08-06T16:29:38.583
> 
> 标签：google-maps, google-maps-api-3

我知道您可以使用 google.maps.LatLng() 来绘制标记，但我不知道纬度和经度。我知道邮政编码。我可以用它来绘制标记吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:09:08.350

是的，您可以，您可以使用地理编码服务对邮政编码进行地理编码，您将获得可用于标记的邮政编码的中心点： [https ://developers.google.com/maps/documentation/ javascript/地理编码](https://developers.google.com/maps/documentation/javascript/geocoding)

# javascript - 在 document.ready 上调用 javascript

> ID：11832271
> 
> 赞同：-2
> 
> 时间：2012-08-06T16:29:49.597
> 
> 标签：javascript, jquery

我的 jquery 不会在准备好的文档上运行我的 java 脚本函数。

```
cont += "<script>";
cont += "$(document).ready(function() {Puma.getReasonForBTI()});";
cont += "</script>"; 
```

JS函数

```
Puma.getReasonForBTI = function() {
    var reason = document.getElementById("reasonId").value;
    var msql = "SELECT Pid FROM tPid WHERE Reason = 'reason'";
    sql = "action=getReasonForBTI&sql=" + encodeURIComponent(msql);
    objAjaxAd.main_flag = "getReasonForBTI";
    objAjaxAd.SendQuery(sql);
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:35:06.047

为什么不直接将 DocReady 添加到您的 JS 中？

```
Puma.getReasonForBTI = function() {
    var reason = document.getElementById("reasonId").value;
    var msql = "SELECT Pid FROM tPid WHERE Reason = 'reason'";
    sql = "action=getReasonForBTI&sql=" + encodeURIComponent(msql);
    objAjaxAd.main_flag = "getReasonForBTI";
    objAjaxAd.SendQuery(sql);
}

$(document).ready(function() {
  Puma.getReasonForBTI()
}); 
```

**编辑：**

另外，我会`reason`自己发送并在服务器端对其进行消毒，然后将其放入查询中。通过 Javascript/AJAX 发送 SQL 查询只是自找麻烦。

仿码：

```
sql("
    SELECT Pid
    FROM tPid 
    WHERE Reason = ?
", $ajax.reason) 
```

**双重编辑**

此外，`reason`在字符串中加上单引号不会评估`reason`. 只是想我会为你节省一些未来的头痛

```
var foo = "bar";
console.log("The value of foo is 'foo'");
=> "The value of foo is 'foo'"
console.log("The value of foo is " + foo);
=> "The value of foo is bar" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:40:16.543

尝试使用 chrome 浏览器和开发工具 (F12)。

1.  看看错误控制台。
2.  修复错误
3.  更改您的代码，因为**有人可以使用您的代码从底层数据库中删除任何数据**

**更新**

```
var reason = document.getElementById("reasonId").value;
// reason is entered directly byy a user (or Mr. EvilHacker).
var msql = "SELECT Pid FROM tPid WHERE Reason = 'reason'";
// Here you create a SQL, which may sounds like this:

SELECT Pid FROM tPid WHERE Reason = ''; DROP table tPid;--' 
```

如果邪恶的黑客进入`';DROP table tPid;--`了文本框。查看[owasp.org](http://owasp.org)了解更多信息

# jquery - 在 Ajax 调用中使用 AMFPHP

> ID：11832276
> 
> 赞同：0
> 
> 时间：2012-08-06T16:30:07.027
> 
> 标签：jquery, ajax, amfphp

我想知道是否有任何库或方法可以将 AMFPHP 与 Ajax 一起使用。我有一个大型类，其中准备好方法并开始一个新项目，我在其中使用 jQuery，而不是开始将各个部分分隔为 php 文件，我希望（如果有任何可能性）直接使用 amfphp。

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-28T15:46:03.540

`amfPHP`支持`JSON`，所以是的，您可以`jQuery`使用`amfphp`.

请参阅示例代码`Pizza Example`。`amfPHP`

# ruby-on-rails-3 - 如何区分用户参数和 Action Pack 参数？

> ID：11832278
> 
> 赞同：0
> 
> 时间：2012-08-06T16:30:12.713
> 
> 标签：ruby-on-rails-3, controller, actionpack

我有一个 Rails 应用程序，其中用户参数都是通过带有 JSON 参数的 RESTful API 提供的。具体来说，没有用户发布数据的客户端 HTML 表单：它是原始 JSON。

因此，要创建一个新的 Car 条目，用户可能会：

```
POST www.mysite.com/api/car
model=Ford&year=2012 
```

在我的应用程序中，当我收到此消息时，Action Pack 值与 params[] 哈希中的用户值混合在一起，因此我得到：

```
params = {:model=>"Ford", :year=>"2012", :format=>"json", :action=>"create", :controller=>"api/cars"} 
```

将用户生成的参数与 Action Pack 生成的参数分开的最佳方法是什么？我能想到的最好的方法是删除后者：

```
car_params = params.reject {|k,v| [:format, :action, :controller].member?(k)}
car = car.new(car_params) 
```

但这闻起来不对。有没有更好的办法？（例如，我可以让 Action Pack 将用户提供的参数封装到单个哈希中并将其作为 params[] 的单个元素传递吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:46:36.480

不知道它是否有帮助，但我只是在 application_controller 创建一个方法：

```
def user_params
  return params.reject {|k,v| [:format, :action, :controller].member?(k)}
end 
```

因此，在整个代码中，您可以只`user_params`在不需要 ActionPack 参数时使用

# yepnope - Yepnope Javascript 在调用两次时不会对 css 文件调用完整的函数

> ID：11832282
> 
> 赞同：1
> 
> 时间：2012-08-06T16:30:27.117
> 
> 标签：yepnope

我有 yepnope 来动态加载 css 和 js 文件。我的 yepnode 调用特定事件（例如：按钮单击）。

当我第一次调用（js，css）时 - 它加载文件 - 我可以看到 css 正确完成。

但是，当第二次触发事件时再次调用 yepnope - 它只是无法再次下载 css（或者甚至不使用旧的 css）。

Js 在第二次调用时也能正常工作。但是css不起作用。

但是，当我在 js 调用的回调中调用 injectcss 时，它会再次强制注入，但它破坏了速度的全部目的。

谢谢。

# google-chrome - 如何允许其他人更新我已上传到 Chrome 网上商店的 chrome 应用？

> ID：11832289
> 
> 赞同：1
> 
> 时间：2012-08-06T16:30:46.043
> 
> 标签：google-chrome, google-chrome-extension

将 chrome 应用程序上传到网上商店后，如何允许其他人访问更新/修改它？

# windows - Folder operation in .bat is unstable?

> ID：11832293
> 
> 赞同：1
> 
> 时间：2012-08-06T16:30:56.323
> 
> 标签：windows, batch-file, mkdir, cd

I write a .bat to automate generating and compiling a cmake project. The batch file will

1.  optional `rmdir build`
2.  `mkdir build` if not exist
3.  `cd build`
4.  `cmake ..` generate a nmake project from upper folder
5.  `nmake` compile project

the source:

```
@ECHO OFF
set "OpenCV_LIB=C:\Program Files (x86)\OpenCV2.1"
echo !! OpenCV Library: [ %OpenCV_LIB% ]
IF NOT EXIST "%OpenCV_LIB%" (
    echo Can't find OpenCV Library, please change OpenCV_LIB setting
    GOTO END
)

if %PROCESSOR_ARCHITECTURE%==x86   set BUILD_ARCH=x86
if %PROCESSOR_ARCHITECTURE%==AMD64 set BUILD_ARCH=x86_amd64
if %PROCESSOR_ARCHITECTURE%==IA64  set BUILD_ARCH=x86_IPF
echo !! Target architecture [ %BUILD_ARCH% ]
call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" %BUILD_ARCH%

cd "sikuli-script"
set /p answer=Do you want to make clean first? (Y/N):
if %answer% == Y ( IF EXIST build rmdir /s /q build )
if %answer% == y ( IF EXIST build rmdir /s /q build )

IF NOT EXIST build mkdir build
cd build

IF NOT EXIST CMakeCache.txt ( cmake -G "NMake Makefiles" -D CMAKE_BUILD_TYPE=Release -D "OpenCV_DIR=%OpenCV_LIB%" .. )
nmake

:END
pause 
```

After i run this .bat over and over, i notice that `cd build` failed sometimes, so i change my code to test it:

```
@ECHO ON
set /p answer=Do you want to make clean first? (Y/N):
if %answer% == Y ( IF EXIST build rmdir /s /q build )
if %answer% == y ( IF EXIST build rmdir /s /q build )
:DO_MKDIR_CD
IF NOT EXIST build mkdir build
cd build
if errorlevel 1 (
    pause
    GOTO DO_MKDIR_CD
) 
```

It comes out the error happens every time choose to clean up `build`, even the `build` is at small size (e.g. after interrupted compiling, size 3.08 MB, 183 files, 67 dirs).

```
!! OpenCV Library: [ C:\Program Files (x86)\OpenCV2.1 ]
!! Target architecture [ x86_amd64 ]
Setting environment for using Microsoft Visual Studio 2010 x64 cross tools.

D:\repo\sikuli>cd "sikuli-script"

D:\repo\sikuli\sikuli-script>set /p answer=Do you want to make clean first? (Y/N):
Do you want to make clean first? (Y/N):y

D:\repo\sikuli\sikuli-script>if y == Y (IF EXIST build rmdir /s /q build  )

D:\repo\sikuli\sikuli-script>if y == y (IF EXIST build rmdir /s /q build  )

D:\repo\sikuli\sikuli-script>IF NOT EXIST build mkdir build

D:\repo\sikuli\sikuli-script>cd build
Access is denied.

D:\repo\sikuli\sikuli-script>if errorlevel 1 (
pause
 GOTO DO_MKDIR_CD
)
Press any key to continue . . . 
```

So every time after remove and recreate `build`, the `cd build` fails, then `cmake` start messing up my source tree.

The error check and loop trying could fix this problem, but why is the file system not stable? or am i writing it in a wrong way?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T12:25:56.973

That build directory check:

```
IF NOT EXIST build mkdir build 
```

Will create the directory if both directory *and* file named "build" are not exist.

One way to check a directoy existence is:

```
if exist build\nul echo directory exist 
```

If you want to make sure a directory exist use:

```
if not exist build\nul mkdir build 
```

or better:

```
if not exist build\nul (
  mkdir build
  if not exist build\nul (
    echo mkdir failed
    goto :eof
  )
) 
```

# ruby-on-rails - Rails 有条件的，除非没有按预期工作

> ID：11832295
> 
> 赞同：0
> 
> 时间：2012-08-06T16:30:59.560
> 
> 标签：ruby-on-rails, conditional-statements

我有一个 rails 应用程序，在我的应用程序控制器中，我有以下代码：

```
redirect_to :login unless @current_user = User.find_by_uid(session[:cas_user])
@current_user.syncUserRoles 
```

因此，除非成功找到他们的用户帐户，否则这应该将他们重定向到登录。但是，即使@current_user 返回 nil，它仍然会进入下一行。因此，我将代码修改为以下内容：

```
@current_user = User.find_by_uid(session[:cas_user])
redirect_to :login unless @current_user.present?
@current_user.syncUserRoles 
```

但是，它会忽略内联，除非在第 2 行，并在第 3 行出现 nilClass 错误。我最终不得不求助于一个完整的 if else 语句，但我想知道我做错了什么。

```
if @current_user.present?
    @current_user.syncUserRoles
else
    redirect_to :login
end //This works as intended 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:33:56.273

redirect_to 不会停止方法中的代码执行。调用 return 以确保您停止代码执行：

```
(redirect_to :login && return) unless @current_user = User.find_by_uid(session[:cas_user]) 
```

它像这样工作吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:35:34.020

这里的困惑在于如何`redirect_to`工作，而不是`unless`. `redirect_to`只是设置一个`302 Moved`标题，它不会从您的操作中返回。所以下一行仍然会执行（你的`@current_user.syncUserRoles`行），当它渲染时，它会设置 302 状态代码。

正如您所发现的，将它放在一个单独的`else`分支中是避免执行该行的一种方法。

# log4j - 使用 log4j 处理屏幕输出

> ID：11832309
> 
> 赞同：6
> 
> 时间：2012-08-06T16:31:54.833
> 
> 标签：log4j

log4j 的一个恼人的事情是它总是想把东西转储到屏幕上。如果我登录到文件，我不需要它。我确定这与我设置 log4j.properties 文件的方式有关。解决所有这些配置问题令人沮丧！:-)

对于我当前调用 Balancer 的程序，这就是我进行记录器初始化的方式。也许它是错误的或什么的。

```
static Logger log = Logger.getLogger(Balancer.class); 
```

我的 log4j.properties 的部分转储：

```
log4j.rootLogger=fatal, stdout
log4j.logger.Balancer=fatal, rollingLog

# I still don't understand how category stuff works yet
log4j.category.Balancer=info, BalancerLog

#### First appender writes to console
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%5p %d [%t] (%F:%L) - %m%n

#### Second appender writes to a file
# Control the maximum log file size
# Archive log files (ten backups here)
log4j.appender.rollingLog=org.apache.log4j.RollingFileAppender
log4j.appender.rollingLog.File=default.log
log4j.appender.rollingLog.MaxFileSize=10000KB
log4j.appender.rollingLog.MaxBackupIndex=10
log4j.appender.rollingLog.layout=org.apache.log4j.PatternLayout
log4j.appender.rollingLog.layout.ConversionPattern=%5p %d [%t] (%F:%L) - %m%n

log4j.appender.BalancerLog=org.apache.log4j.RollingFileAppender
log4j.appender.BalancerLog.File=Balancer.log
log4j.appender.BalancerLog.MaxFileSize=100000KB
log4j.appender.BalancerLog.MaxBackupIndex=10
log4j.appender.BalancerLog.layout=org.apache.log4j.PatternLayout
log4j.appender.BalancerLog.layout.ConversionPattern=%5p %d [%t] (%F:%L) - %m%n 
```

我知道 rootLogger 如何将内容发送到 stdout appender。是否有 /dev/null 附加程序？您必须至少有一个附加程序。

无论如何，如果不出意外，我现在的基本解决方法是将屏幕输出发送到 /dev/null。顺便说一句，我的 Java 程序在预定的批处理环境（无 GUI）中运行。必须清理假脱机文件（是的，这是在 AS/400 上）有点痛苦，尽管这也可以自动化。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T17:01:07.847

> 是否有 /dev/null 附加程序？

是的。

```
log4j.appender.devnull=org.apache.log4j.varia.NullAppender
log4j.rootLogger=fatal, devnull 
```

我不确定你从哪里得到`log4j.category.*`的，但这不是我以前见过的东西，我会坚持只使用`appender`and `logger`。

```
log4j.logger.Balancer=fatal, rollingLog, BalancerLog 
```

会将`fatal`名为`Balancer`（没有包前缀）的记录器的级别消息发送到 rollingLog 和 BalancerLog 附加程序。如果将记录器级别更改为`info`

```
log4j.logger.Balancer=info, rollingLog, BalancerLog 
```

然后它将`info`向两个附加程序发送级别及以上的消息。您不能限制它以使 BalancerLog 获取`info`及更高版本，但 rollingLog 仅*基于每个记录器*`fatal`获取消息，但您可以在 rollingLog 附加器上设置阈值，以便它仅记录消息（无论它们来自哪个记录器）*`fatal`*

 *```
log4j.appender.rollingLog=org.apache.log4j.RollingFileAppender
log4j.appender.rollingLog.Threshold=fatal
log4j.appender.rollingLog.File=default.log
# other parameters as before 
```*

# oracle11g - Oracle 11g 日期函数的新功能

> ID：11832311
> 
> 赞同：0
> 
> 时间：2012-08-06T16:32:02.347
> 
> 标签：oracle11g

我正在尝试将 Sybase 脚本转换为 Oracle 11g。我不确定何时翻译以下内容并希望有人能够提供帮助。

我的 Sybase 有以下子句（简化）： SELECT * FROM MyTable1 a, MyTable2 b WHERE a.id = b.id AND a.date_modified > dateadd(dd, -4, getdate())

我翻译成以下但不确定这是正确的，请指教： SELECT * FROM MyTable1 a, MyTable2 b WHERE a.id = b.id AND a.dateAND a.date_modified > SYSDATE -4 ---> ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:47:53.963

只是为了清理它，您有一个不需要的额外 WHERE 子句。

```
SELECT 
    * 
FROM 
    MyTable1 a
INNER JOIN
    MyTable2 b 
ON (a.id = b.id)
WHERE
    a.date_modified > TRUNC(SYSDATE) -4 
```

# javascript - 禁用鼠标悬停事件然后重新启用

> ID：11832312
> 
> 赞同：0
> 
> 时间：2012-08-06T16:32:07.720
> 
> 标签：javascript, javascript-events, jquery

如何在鼠标悬停后解除绑定或禁用鼠标悬停，然后在另一个框淡出时重新启用。

我尝试了解除绑定，但似乎它不起作用，它只是禁用了整个东西。

我什至尝试过超时，但这并没有发挥我的优势。

任何帮助将不胜感激，谢谢

```
$("#shopping_basket").mouseover(function() { 
            // set a timeout so that this event will not trigger twice when mouseover from the bottom
            setTimeout(function() {
                /*$("#shopping_basket").unbind(mouseover);*/
                $("#miniBasketDetails").fadeIn(500);
            },500);
            });     
        $("#miniBasketDetails").mouseleave(function() { $("#miniBasketDetails").fadeOut(500); }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:38:54.467

只是猜测尝试这样的事情：

```
$("#shopping_basket").bind('mouseover', function() {
  setTimeout(function() {
    $("#shopping_basket").unbind('mouseover');
    $("#miniBasketDetails").fadeIn(500);
  }, 500);

 //Re-enable as needed: $("#shopping_basket").bind('mouseover', function(){});
}); 
```

此代码未经测试，但应该可以工作。

我认为您的问题是您作为变量而不是字符串`mouseover`传入。`.unbind()`这就是为什么“整个事情”被禁用的原因，因为 JavaScript 正在寻找一个名为 的变量`mouseover`，该变量未定义，并导致您的代码中断。试试这样：`.unbind('mouseover')`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:18:19.883

不确定这是否是您正在寻找的算法，它[基于此问题中显示的答案](https://stackoverflow.com/questions/1273566/how-do-i-check-if-the-mouse-is-over-an-element-in-jquery)。
这是[小提琴和代码](http://jsfiddle.net/rVEbp/)：

```
$("#shopping_basket").hover(function() {
    $("#miniBasketDetails").fadeIn(500);
}, function() {
    $("#miniBasketDetails").data('is_over', false);
    setTimeout(function() {
        if (!$('#miniBasketDetails').data('is_over')) {
            //if not hovered over the #miniBasketDetails in 650 miliseconds after mouseleave
            $("#miniBasketDetails").fadeOut(500);
        }
    }, 650);
});

$("#miniBasketDetails").mouseenter(function() {
    $(this).data('is_over', true);
});

$('#miniBasketClose').click(function() {
    $("#miniBasketDetails").fadeOut(500, function() {
        $(this).data('is_over', false);
    });
}); 
```

这`span#miniBasketClose`只是一个可选的“关闭按钮”，不是代码功能所必需的。它的功能可以被替换（如果需要），例如也可以将鼠标悬停在其他一些元素上。

# joomla - Joomla 2.5 仅通过菜单显示类别页面

> ID：11832315
> 
> 赞同：0
> 
> 时间：2012-08-06T16:32:22.150
> 
> 标签：joomla, joomla2.5

我只想通过菜单中的链接在**Joomla 2.5**中显示类别页面。

有没有办法通过从 url 中获取类别的 id 和名称来禁用类别页面的显示？例如，如果**动物**类别的**id**为 3，[http](http://example.com/animals/cat/3-animals) ://example.com/animals/cat/3-animals将加载**动物类别页面**，从而导致与[http://example.com/animals](http://example.com/animals)重复的内容！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T14:32:21.873

您不能禁用 Joomla 长 URL 而不会弄乱网站的其余部分。您可以做的而不是禁用它是在 Google 索引的任何页面上使用 301 重定向，以便列表得到更新并且不再出现在 Google 的索引中。只需 google site:example.com 即可查看他们已编入索引的所有内容。

# ruby-on-rails - 动态标签上下文赞美

> ID：11832317
> 
> 赞同：1
> 
> 时间：2012-08-06T16:32:31.287
> 
> 标签：ruby-on-rails, ruby, acts-as-taggable-on

这是acts_as_taggable_on 中的动态标签上下文文档提供的一些信息...

```
@user = User.new(:name => "Bobby")
@user.set_tag_list_on(:customs, "same, as, tag, list")
@user.tag_list_on(:customs) # => ["same","as","tag","list"]
@user.save
@user.tags_on(:customs) # => [<Tag name='same'>,...]
@user.tag_counts_on(:customs)
User.tagged_with("same", :on => :customs) # => [@user] 
```

我的问题是如何获得我创建的自定义标签列表的赞美。我想要 :tags - :customs，即所有标签减去海关指定标签的集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T02:06:45.077

从他们的 Github 页面：

```
# Find a user that's not tagged with awesome or cool:
User.tagged_with(["awesome", "cool"], :exclude => true) 
```

* * *

## 更新

* * *

你可以试试：

```
customs_tags = @user.tag_list_on(:customs)
user_tags = @user.tag_list
new_tags = user_tags - customs_tags

@user.set_tag_list_on(:customs, new_tags) 
```

# jquery - 勾选复选框后确认框

> ID：11832322
> 
> 赞同：2
> 
> 时间：2012-08-06T16:32:49.730
> 
> 标签：jquery, checkbox, confirm

根据我在这里找到的内容，我已经尝试了几个小时的不同方法，但无济于事。有人可以引导我朝着正确的方向前进吗？在检查或取消选中复选框时，我想丢弃确认书，然后根据用户选择，然后将复选框返回或取消选中。谢谢！

```
$('input:checkbox').click(function(){
     var checked = $("input:checked").length; 
    if (checked == 0){ 
if(confirm('Are you sure you want to discontinue this program?')){
    (':checkbox:checked').removeAttr('checked');
}
    }  else

    { 
if(confirm('Are you sure you want to resume use of this program?'))            
(':checkbox:checked').attr('checked');
    } 
```

HTML

```
<table>
  <tr>
    <td><input name="input" type="checkbox" value="" /></td>
    <td>Because We Care</td>
   </tr>
      <tr>
                     <td><input name="" type="checkbox" value="" /></td>
                     <td>Some Unused Program</td>
                     </tr> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T16:43:52.077

您的代码中有一些语法和逻辑缺陷，试试这个：

```
$('input:checkbox').click(function(){
    var checked = $(this).is(':checked');
    if(checked) {
        if(!confirm('Are you sure you want to resume use of this program?')){         
            $(this).removeAttr('checked');
        }
    } else if(!confirm('Are you sure you want to discontinue this program?')){
        $(this).attr("checked", "checked");
    }
}​);​ 
```

[JSFIDDLE](http://jsfiddle.net/dfKEZ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:39:16.090

执行侦听器时，复选框已选中或未选中。你应该做的是：

*   当用户确认什么都不做时
*   当用户不确认撤消已完成的操作时

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:46:50.283

这应该正是您正在寻找的：

```
<!doctype html>
<html>
<input id="chkTest" type="checkbox" />
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
    $("#chkTest").change(function(evt){
        var attr = $(evt.target).attr("checked")
        if (typeof attr !== 'undefined' && attr !== false){
            alert("Checked");
        }
        else{
            alert("Not Checked");
        }
    });
</script>
</html> 
```

# vim - LaTeX 环境中的 Vim 操作

> ID：11832324
> 
> 赞同：6
> 
> 时间：2012-08-06T16:32:58.820
> 
> 标签：vim, latex

我想知道在使用 vim 编写代码/乳胶时，当我在某个环境中时如何触发某个动作。例如，假设我正在编写 tex 并在 align 环境中，那么我希望我输入的每个等号都转换为 &=。

我现在想的比较麻烦。这是我的 vimrc 中的伪代码。这是它的样子

```
Shortcut for environment opens start and end tag for align environment (Using imap)
The above action also initiates a counter variable, sets it to 1
If counter is 1, every equals sign I enter should be entered as an &=.
Shortcut to force counter to zero when I move out of the environment. (Using imap) 
```

我想知道是否有更简单的方法来解决这个问题。这只是一个例子。这里的主要思想是让 vim 具有环境意识。

期待您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:33:10.790

这是一个非常有趣的问题，但我不确定您建议的方法是最好的方法！我尝试了一个答案，但第一次迭代可能并不完美。我假设 LaTeX 环境只是由`\begin`和`\end`命令分隔（我的 LaTeX 有点生疏了！）。

首先，您需要一个函数来返回光标位置的环境。我下面的函数跳转到上一个`\begin`命令，然后向前跳转到匹配的`\end`命令，计算光标是否在该区域内，并继续该过程直到找到包含环境。它应该处理嵌套环境。如果不在 LaTeX 环境中，则返回一个空字符串。

```
function! GetTeXEnv()
    let pos = getpos('.')
    let win = winsaveview()
    let env = ''
    let carry_on = 1
    let search_ops = 'bWc'
    let b_start = line('.')
    while carry_on
        keepjumps let b_start = search('\\begin{',search_ops)
        let search_ops = 'bW'
        " Only accept a match at the cursor position on the
        " first cycle, otherwise we wouldn't go anywhere!
        let env = matchstr(getline('.'),'\\begin{\zs.\{-}\ze}')
        let env_esc = escape(env,'*')
        keepjumps let b_end = search('\\end{\s*' . env_esc . '\s*}','Wn')
        if b_start == 0
            " finished searching; stop
            let carry_on = 0
        elseif b_end > b_start && b_end < pos[1]
            " not inside this env; carry on
            let env = ''
        elseif b_end > b_start && b_end >= pos[1] && b_start <= pos[1]
            " found it; stop
            let carry_on = 0
        endif
    endwhile
    call setpos('.',pos)
    call winrestview(win)
    return env
endfunction 
```

现在您可以使用 查询光标所在的环境`:echo GetTeXEnv()`。

要更改`=`键的行为，您需要创建另一个`&=`在 align 环境中返回的函数，`=`否则：

```
function! TeXEquals()
    return GetTeXEnv() =~ 'align\*\?' ? "&=" : "="
endfunction 
```

`=`然后您可以在插入模式下重新映射（仅适用于 TeX 文件）

```
autocmd FileType tex inoremap <silent> = <c-r>=TeXEquals()<CR> 
```

这似乎在我的示例 LaTeX 文件中有效。如果您发现任何问题或有任何改进的想法，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:12:15.177

我通常在事后解决这类问题。例如，我用普通`=`符号写它，然后在视觉上选择它的区域并使用`:s/=/\&=/g`. 如果您想在事后对“环境”执行多项操作，您可以创建一个函数并触发一个键来执行它。例如：

```
vnoremap <leader>la :call <SID>latexAlign()<cr>

function! s:latexAlign() range
  exe ":'<,'>s/=/\&=/g"
  " add more stuff here...
endfunction 
```

但是，我认为您的解决方案会更好，以防您稍后返回并对其进行编辑。vim 中的 htmlcomplete 文件处理这种情况是这样的：

```
let stylestart = searchpair('<style\>', '', '<\/style\>', "bnW")
let styleend   = searchpair('<style\>', '', '<\/style\>', "nW")
if stylestart != 0 && styleend != 0
   if stylestart <= curline && styleend >= curline
      let start = col('.') - 1
      let b:csscompl = 1
      while start >= 0 && line[start - 1] =~ '\(\k\|-\)'
         let start -= 1
      endwhile
   endif
endif 
```

您可以看到它如何使用 searchpair 来确定它是否在`<style></style>`标签内。有关`:help searchpair()`更多信息，请参阅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:28:02.863

如果您正在寻找“环境意识”，并且您的意思是“我在乳胶文件中吗？” 您*可以*使用`autocommand`.

Vim 可以识别大量文件类型，您可以通过以下方式确保默认识别您正在编辑的文件类型：

```
:echo &filetype 
```

在编辑 Python 文件时，我得到`python`了结果。如果你只需要对 latex 使用这个并且你从那个 Vim 变量中得到了一个满意的响应，你可以设置一个`autocommand`使用它的，否则你可以在其中指定扩展，它看起来像这样：

```
autocmd BufReadPost,BufNewFile,BufEnter *.tex, *.latex call MyFunction() 
```

RedPost、NewFile 和 Enter 是一些可能的 Vim 交互，它们会`MyFunction`在文件扩展名以`.text`或结尾时触发你`.latex`

如果您真正需要的是一些代码示例，可以按照您的描述进行操作，那么康纳的答案可能更适合。

# android - 如何获取与整个屏幕相对应的屏幕坐标，而不是触摸的视图？

> ID：11832333
> 
> 赞同：16
> 
> 时间：2012-08-06T16:33:49.043
> 
> 标签：android, screen, coordinates, android-view

通过处理一个视图项的触摸事件，我无法从屏幕上获取真实的 (x,y)。

我有这个：

![在此处输入图像描述](../Images/057ed9113c34212428b79080c7d9504b.png)

当我触摸 View 项目时，它会给我与位于他左上角的原点的坐标，如果我将手指滑出视图，它会给我负坐标（向上或向左滑动时）。 ![在此处输入图像描述](../Images/38c33a4d803dd180bb4158df88c6f9b3.png) ![在此处输入图像描述](../Images/38a7d7b4c7adfa27061dab904e38ca0a.png)

我想获取屏幕中的 View 位置，将其添加到我得到的 (x,y) 坐标中，所以最终结果是 (0,0) 在整个屏幕的左上角. ![在此处输入图像描述](../Images/96f4a1e6d49d98d6fbcd674abe65d721.png)

我还需要总屏幕尺寸，以便我知道手指何时位于右下角。

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-06T16:41:34.403

`getX()`正如您所发现的，MotionEvent 类具有`getY()`返回相对于视图的坐标的方法。

然而，它也有`getRawX()`和`getRawY()`方法，根据文档说：

> 返回此事件的原始原始 X（或 Y）坐标。对于屏幕上的触摸事件，这是屏幕上事件的原始位置，在它为包含窗口和视图进行调整之前。

听起来这就是你所追求的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T13:41:48.173

在屏幕上加载视图后尝试使用它。

```
int[] location = new int[2];
View.getLocationOnScreen(location); 
Log.v(Common.TAG,"left: "+ location[0]);
Log.v(Common.TAG,"top: "+ location[1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:37:24.187

获取`View`' 在屏幕上的位置，然后您可以使用简单的算术计算其余部分。 [如何获取视图的绝对坐标](https://stackoverflow.com/questions/2224844/how-to-get-the-absolute-coordinates-of-a-view)

# ruby-on-rails - 在 Rails 中剥离标签

> ID：11832336
> 
> 赞同：0
> 
> 时间：2012-08-06T16:33:59.520
> 
> 标签：ruby-on-rails, ruby

我正在制作一个 Rails 应用程序，但我对剥离标签的文本有疑问。`strip_tags`在视图显示用户提交的文本的任何地方都使用该方法是否正常？还是应该在模型中验证所有输入，然后您不需要`strip_tags`视图中的方法？将有很多地方可以添加此内容，因此我想知道我是否正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:37:57.070

如果您使用的是 Rails 3+，它会自动转义 Ruby 视图中输出的所有内容。无事可做，默认情况下你是安全的。

如果您使用的是 Rails 2.3 及以下版本，请使用`<%= h some_var %>`转义可能有害的变量。

您也可以使用`rails_xss`带有 Rails 2.3 的 gem 来添加 Rails 3 的保护

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:37:47.497

我会在输入/保存时删除所有标签，然后您以后不必担心。如果您确实想实际维护标签，那么请考虑使用`Presenter`设计模式，让您的所有模型数据输出都通过它的呈现器，此时您可以在一个地方剥离标签。

# python - 在python中获取JSON值

> ID：11832337
> 
> 赞同：0
> 
> 时间：2012-08-06T16:33:59.753
> 
> 标签：python, json

我有一个看起来像这样的 json 文档（as_stats.json）：

`{"failed":5, "received": {"192.168.5.2": 40, "192.168.5.45": 84, "127.0.0.1": 145}}`

我的 python 代码如下所示：

```
import json,urllib
data = open('as_stats.json').read()
d = json.loads(data)

for x in d['received']:
    if (x != '127.0.0.1'):
        print x 
```

返回的值是 IP 地址，它们是变量，即可以随时更改为任何其他地址。我感兴趣的是从每个 IP 地址接收到的文件数量。当我尝试将我的代码重写为

```
for x,y in d['received']:
        if (x <> '127.0.0.1'):
            print x,y 
```

我收到一条消息，说“解包的值太多”。

如何从键值对中获取我想要的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T16:37:30.397

利用：

```
for x,y in d['received'].iteritems(): 
```

对 dict 的正常迭代只会给你键。用于`itervalues`获取值，或`iteritems`同时获取键和值。

# apache - .htaccess 非 www 重定向创建错误 404？

> ID：11832339
> 
> 赞同：2
> 
> 时间：2012-08-06T16:34:12.493
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

错误：在此服务器上找不到请求的 URL /public_html/。

我在 .htaccess 文件中的 301 重定向不是去[http://www.mywebsite.com/](http://www.mywebsite.com/)，而是将浏览器发送到[http://www.mywebsite.com/public_html/](http://www.mywebsite.com/public_html/)并抛出该错误。

这可能与我在子目录中托管附加域的事实有关？该问题仅在使用 InMotion.com 托管时出现，相同的代码在我在 Bluehost 上托管的页面上运行良好。

.ht 访问代码：

```
Options +FollowSymlinks
RewriteEngine On
RewriteCond %{http_host} ^mywebsite.com [NC]
RewriteRule ^(.*)$ http://www.mywebsite.com/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:33:40.090

这一直对我有用。（注意“.com”之前的反斜杠）

```
RewriteCond %{HTTP_HOST} ^example\.com [NC]
RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

# processing - 处理：导出的小程序不起作用

> ID：11832342
> 
> 赞同：1
> 
> 时间：2012-08-06T16:34:26.930
> 
> 标签：processing

我在 Processing 中制作了一个简单的游戏，并尝试将其导出为小程序。它导出了文件，但是当我尝试在浏览器中运行小程序时，它只是空白并且不会加载。原始 jar 文件也不会在我的计算机上运行。

我会回答我自己的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:34:52.670

解决方案很简单，也很奇怪。导出时，Processing 创建一个小程序文件夹，但不包括运行应用程序所需的资产或对所需文件路径的更改。例如，图像、音频、字体等。

因此，您还需要手动将所有必需的文件放入 applet 文件夹（或更改路径定义）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T19:11:21.007

在您的网站上托管您的处理小程序的另一种解决方案（由于某种原因我遇到了很多麻烦），是使用一个名为[openprocessing](http://openprocessing.org/)的网站。

它会给你一个 HTML Iframe，你可以很容易地将它嵌入到你的博客文章中。

# bash - 请帮助确保通过 bash 解析完整保留文本

> ID：11832346
> 
> 赞同：0
> 
> 时间：2012-08-06T16:35:03.787
> 
> 标签：bash, parsing, filenames, filepath

有人可以帮助纠正我的 bash 文本解析行吗？

程序：eyeD3

## 文件

`PathAndPlaylists.txt`[制表符分隔]

/home/Music/A/Average White Band/1975/Average White Band - Cut The Cake.mp3 1970-POP; -所有流行音乐；1970-全部

```
cat PathAndPlaylists.txt | while read z; do filename=$(echo "$z" | cut -f1) playlists=$(echo "$z" | cut -f2) eyeD3 --no-tagging-time-frame --no-zero-padding --set-text-frame=TCOM:"$playlists" "$filename" done 
```

## 客观的

为程序“eyeD3”使用上述文本文件 (PathAndPlaylists.txt) 中的每个绝对文件/路径，以使用第二个制表符分隔字段 (1970-POP;-ALL-POP;1970-ALL)。

**问题：**我无法确保文件/路径将被视为文本，而某些字符不会导致代码失败。例如逗号。

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:03:51.897

如果输入是制表符分隔的，只需告诉外壳。

```
while IFS='        ' read filename playlists; do
    eyeD3 ... "$playlists" ... "$filename"
done <PathAndPlaylists.txt 
```

The IFS= value should be a literal tab character. If you work at the prompt, you might need to type something like ctrl-V tab to get a literal tab. Check your shell's documentation for specifics.

# c++ - 子字符串或将数组打印到 C++ 中的位置数

> ID：11832350
> 
> 赞同：1
> 
> 时间：2012-08-06T16:35:17.350
> 
> 标签：c++, cout, substr

在 PHP 中，我记得我可以做类似的事情

`substr(string,start,length)`

现在我宣布

`int array[20];`

如何在不使用 for 循环的情况下只打印其中的一部分

例如。

`cout << array[1 to 5] << "Here is the breaking point" << array[15 to 20] << endl;`

像这样的东西

我还记得是否`printf`会有类似`^5`或类似的东西说最多 5

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T16:39:41.647

您可以使用`ostream_iterator`and的组合`copy`（[链接到 ideone](http://ideone.com/1xwbb)）：

```
#include <iostream>
#include <iterator>
#include <algorithm>

using namespace std;

int main() {
    int array[] = {1,2,3,4,5,6,7,8,9,10,11,12,13};
    ostream_iterator<int> out_it (cout," ");
    copy ( array+3, array+6, out_it );
    return 0;
} 
```

`array+3`语法可能看起来不寻常：这是一个等价于 的指针表达式，`&array[3]`它产生一个指针。由于您可以在 C 标准库需要一对迭代器的地方传递一对数组指针，这会产生预期的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T16:39:42.613

您可以复制到 ostream 迭代器：

```
std::copy(array, array+5, std::ostream_iterator(std::cout, " "));
std::cout << "Here is the breaking point";
std::copy(array+15, array+20, std::ostream_iterator<int>(std::cout, " ")); 
```

# algorithm - 验证一个多重集是否是另一个多重集的子集和的并集

> ID：11832351
> 
> 赞同：1
> 
> 时间：2012-08-06T16:35:20.387
> 
> 标签：algorithm, verification, subset-sum

我想找出一个算法来验证一个多重集是否是另一个多重集的子集和的并集，但是我自己挣扎了几个小时后失败了。

详情如下：

多重集 A：正整数集

Multiset B：一个正整数集（小于等于A，后面你会知道为什么）

算法功能：验证对于B中的所有数字，是否有一个数字或A中的数字之和可以匹配它们。A 中的每个数字只能使用一次，并且必须使用 A 中的所有数字。B 中的所有数字必须匹配。

一个澄清这一点的例子：假设 multiset A = {1, 3, 4, 4, 6} , B = {5, 6, 7}

那么算法会输出“TRUE”，因为5是1和4之和，6等于6，7是3和4之和。同时A中的所有数字都被使用且只使用一次，而A中的所有数字B 已检查。

但是对于A = {2, 6, 8}, B = {7, 9}，算法会输出“FALSE”，虽然2+6+8 = 7+9，但是B中没有一个数字是A中的数字之和.

一些注意事项：

1 已知条件，A中的数字之和等于B中的数字之和。

2 如示例所示，某个数字可以出现多次。

3 多重集中的每个数字只能使用一次，因此如果在一个解中使用 3（得到 7），则不能在另一个解中再次使用它。数字 4 出现了两次，因此它可以用于两种解决方案。

4 一个数字有多种解法是可能的，（比如 7 可以是 1 和 6，也可以是 3 和 4），但有些（比如 7 可以是 1 和 6）在验证过程中可能是错误的。

5 Multiset A 不大，最多30个元素

我尽力而为，但我的解决方案始终无法涵盖多集 A 和 B 的所有条件。我认为解决方案显然超出了我的范围。

所以，我真的需要你们聪明人的帮助。请帮我。任何答案将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:20:45.567

这是 NP 完全问题（简化为“子集和问题”非常简单）。所以这个问题没有有效的解决方案。

您可以在这里看到不同的解决方法： [http ://en.wikipedia.org/wiki/Subset_sum_problem](http://en.wikipedia.org/wiki/Subset_sum_problem)

**天真的算法：**

```
naiveAlg(A,B) :
  for each partition P of A such that |P| = |B| do :
    for each element E in P do :
      calculate the sum of E numbers and store in E'
    if E' is equal to B return true
  return false 
```

# iphone - Universal App 中的特定 iPhone/iPad 资源

> ID：11832352
> 
> 赞同：0
> 
> 时间：2012-08-06T16:35:21.767
> 
> 标签：iphone, ipad, resourcebundle

我正在构建一个使用许多图像的通用应用程序。我已经为 iPad 和 iPhone 优化了图像，我的应用在不同的设备上使用了正确的图像（由文件名中的 ~ipad 和 @2x 标签定义）。但正如我所看到的，所有图像都分布在所有设备上。所以我的应用程序占用了大量空间，其中的图像永远不会在特定设备上使用。有没有办法指定将哪些图像（或其他文件）分发给不同的设备类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:37:26.327

不，唯一的“解决方案”是分发两个应用程序。

然而，“真正的”解决方案在于应用程序的设计。大多数应用程序对两个 UI 习惯用法（iPhone/iPad）使用相同的图像。它们使用诸如“可拉伸”图像之类的东西（`UIImage`有关更多信息，请参阅参考资料）而不依赖于分辨率. 您应该考虑使用数百种其他技巧来防止使用依赖于设备的许多图像。

如果您的完整图像存储库不超过 50 MB，则不必太在意。（如果是这样，你应该检查如何最小化它。50+ MB 对于移动设备来说有点多，64 GB 会花费你很多！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:39:57.493

除了分发两个应用之外，另一种解决方案是在首次启动时下载所需的图像资源，但这显然很复杂。（并且需要处理设备备份恢复到不同设备等情况）

# jsf - PrimeFaces 数据表头中的输入不更新支持 bean - 解决方案？

> ID：11832354
> 
> 赞同：2
> 
> 时间：2012-08-06T16:35:28.260
> 
> 标签：jsf, jsf-2, primefaces

如果我在数据表之外放置一个输入组件，那么支持 bean 将使用输入进行更新，并且搜索工作正常，在数据表中正确显示结果。

```
<h:form>
<!-- ------- Calendar input component outside dataTable ------- -->
    <p:calendar id="selectHireDate" value="#{backingBean.hireDateToSearch}" />

    <p:dataTable id="employeeDataTable"
        value="#{backingBean.employeeDataModel}" var="employee">
        <p:columnGroup type="header">
            <p:row>
                <p:column>                           
                        <f:facet name="header">
                            Lorem Ipsum
                        </f:facet>                          
                </p:column>
            </p:row>
        </p:columnGroup>

        <p:column>
            <h:outputText value="#{employee.hireDate}" />
        </p:column>     
    </p:dataTable>

    <p:commandButton value="Submit"
    actionListener="#{backingBean.searchEmployees}"
    update="employeeDataTable" />
</h:form> 
```

但是，如果我将该输入组件放置在数据表的表头中，则支持 bean 突然不再更新。（我在 backingBean.setHireDateToSearch 上放置了一个断点，它被上面的代码而不是下面的代码触发。）

```
<h:form>            
    <p:dataTable id="employeeDataTable"
        value="#{backingBean.employeeDataModel}" var="employee">
        <p:columnGroup type="header">
            <p:row>
                <p:column>                           
                        <f:facet name="header">
<!-- ------- Calendar input component inside dataTable ------- -->
                            <p:calendar id="selectHireDate" value="#{backingBean.hireDateToSearch}" />
                        </f:facet>                          
                </p:column>
            </p:row>
        </p:columnGroup>

        <p:column>
            <h:outputText value="#{employee.hireDate}" />
        </p:column>     
    </p:dataTable>

    <p:commandButton value="Submit"
    actionListener="#{backingBean.searchEmployees}"
    update="employeeDataTable" />
</h:form> 
```

为什么是这样？有没有办法使后者的设置工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:40:11.400

我可以重现您的问题，并且当我摆脱`<p:columnGroup>`周围的问题时，它就得到了解决，`<f:facet name="header">`无论如何，它本身在这个结构中没有多大意义。

```
<p:dataTable id="employeeDataTable" value="#{backingBean.employeeDataModel}" var="employee">
    <f:facet name="header">
        <p:calendar id="selectHireDate" value="#{backingBean.hireDateToSearch}" />
    </f:facet>                          
    <p:column>
        <h:outputText value="#{employee.hireDate}" />
    </p:column>     
</p:dataTable> 
```

*（这只显示第二小行空`<p:column>`标题，你可以用一点 CSS 隐藏它）*

不确定这是由设计还是由`decode()`与`<p:dataTable>`. 我肯定会向 PrimeFaces 人员[报告。](http://code.google.com/p/primefaces/issues/list)

# session - 如何在 WAB 包中共享登录会话

> ID：11832355
> 
> 赞同：1
> 
> 时间：2012-08-06T16:35:31.103
> 
> 标签：session, jakarta-ee, glassfish, osgi, wab

我有几个带有 JSF 页面的 WAB 包。我知道如何创建简单的 JSF 登录页面。问题是 WAB 包如何共享用户会话？我想要一个登录菜单来注册所有 WAB 包的会话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T06:18:59.053

每个 WAB 都部署为单独的 Web 应用程序。我不确定您将 WAB 部署到哪个容器，但可以配置一些 servlet 引擎（例如 Tomcat 或 Jetty）以在不同的 Web 应用程序 (WAR) 之间共享会话数据。（请参阅[WAR 之间的共享会话](https://stackoverflow.com/questions/2477845/sharing-session-between-wars)）

另一种选择是开发您自己的单点登录服务。此服务可以部署为 OSGi 包并由每个 WAB 使用。第一个登录的 WAB 向服务注册用户和密码。秘密也被加密存储在对整个域有效的安全 cookie 中（无路径）。一旦另一个 WAB 注意到 cookie，它就可以立即登录用户。但是，每个 WAB 仍然有自己的会话。但单点登录服务也可用于在 WAB 之间共享其他数据。该服务还应实施一些清理处理以丢弃旧数据。您还可以实施其他安全选项以使服务适应您的需求。

# shell - 用于计算文件中单词出现次数的 Shell 脚本

> ID：11832358
> 
> 赞同：5
> 
> 时间：2012-08-06T16:35:37.837
> 
> 标签：shell

让我们以下面的内容为例

```
 This file is a test file 
    this file is used to count the word 'file' in this test file
    there are multiple occurrences of word file in some lines in this test file 
```

我想计算上述内容中的“文件”一词。

我正在使用下面的 shell 命令

```
 cat $filename |  sed "s/_/new/g" | sed "s/$word/_/g" | tr -c -d _ |wc -c 
```

可以还是有更好的想法..？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T16:40:32.450

使用 tr 分隔单词，然后使用 grep 和 wc 似乎是可能的：

```
tr -s ' ' '\n' < file.txt | grep file | wc -l 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T16:38:55.527

```
grep $word $filename -o | wc -l 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-06T16:38:29.303

```
grep -cow "$word" "$filename" 
```

该`-c`选项指定报告计数。

该`-o`选项指定计算每次出现的次数，而不仅仅是匹配行的数量。

该`-w`选项指定只计算单词匹配，即不计算部分匹配，例如“文件”或“配置文件”。

不幸的是，当您将和结合使用时，某些版本`grep`无法正常工作。如果你有这个错误，@Nykakin 的回答是一个很好的解决方法。`-c``-o`

还要注意插值变量的正确引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-22T02:46:12.080

我会在这里推荐最简单的方法，即：

```
grep -c "file" filename 
```

我希望您严格搜索该单词并且没有前缀和后缀，然后将其修改如下：

```
grep -wc "file" filename 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T16:42:14.313

```
cat $filename | tr -s ' ' '\n' | grep -c $word 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T16:43:51.547

您可以全部完成，`awk`或者`perl`您绝对可以删除`cat`（sed 也可以处理文件名）。`grep`本身是不行的，因为它只会计算每行一个匹配项。

```
$ sed "s/_/new/g" delmememetest | sed "s/$word/_/g" | tr -c -d _ |wc -c
7
$ grep -c file delmememetest
3 
```

让我们尝试另一种时髦的方法，让 grep 有用：

```
$ sed "s/${word:0:1}/\n&/g" delmememetest | grep -c "$word"
7 
```

我在每个与搜索词的第一个字符相同的字符之前插入一个换行符。这样每行只有一个匹配不会干扰计数。如果您有最新版本的 GNU `grep`，则`-o`另一个答案中使用的选项将确保相同。

在任何情况下，请确保您匹配的模式不只是`$word`或具有相同根的单词也将匹配（或使用`-w`开关）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-26T01:02:03.417

使用 tr 命令的一些投票解决方案无法处理存在诸如“filefile”之类的链接词的情况。这是我使用 Perl 的解决方案：

```
perl -p -e s/file/file\\n/g $filename | grep -c file 
```

-p 告诉 perl 运行一个循环并回显输出。-e 指定接下来是单行程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-06T20:32:23.747

...我喜欢保持简单：

```
grep $string /file/name |wc -l 
```

或者

```
cat /file/name |grep $string |wc -l 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-10-17T06:00:37.330

使用以下命令：-less fileName | grep wordToBeSearched | wc -l 这里 less 是你想使用的编辑器类型 如果你想使用 nano 编辑器，那么使用以下命令：- nano fileName | grep wordToBeSearched | wc -l 这里 wc 代表字数，-l 代表有这个词的行数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-12T19:24:27.937

我发现这是最简单的方法：

```
 grep -o "$word" "$file" | wc -w 
```

中的`-o`选项`grep`指定计算每次出现的次数，而不仅仅是匹配行的数量。

中的`-w`选项`wc`是仅计算整个单词。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-02-20T08:46:59.000

编码：

```
 count=0;
    for i in `cat $filename`;
        do if [ $i == "file" ];
    then ((count++))fi $i; 
    done;
    echo $count; 
```

# spring - 如何设置 Spring/Heroku/postgres SSL 数据源

> ID：11832361
> 
> 赞同：17
> 
> 时间：2012-08-06T16:35:54.283
> 
> 标签：spring, postgresql, ssl, heroku

我正在尝试创建一个从 Heroku/Spring 应用程序到 postgres.heroku.com postgres 数据库的数据源。这是我的`applicationContext.xml`片段。

```
<bean id="securityDataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="org.postgresql.Driver"/>
    <property name="url" value="jdbc:postgresql://url/dstabase"/>
    <property name="username" value="user"/>
    <property name="password" value="password"/>
</bean> 
```

但是当我运行应用程序时，tomcat 给出了这个错误：

```
Cannot create PoolableConnectionFactory (FATAL: no pg_hba.conf entry for host "10.11.12.13", user "username", database "database", SSL off) 
```

如何将其配置为使用 SSL？我需要它来建立与 postgres.heroku.com 的连接

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-07T09:21:04.923

您需要使用相关的 ssl 信息扩展您的 JDBC 连接 URL。

您的 JDBC 连接 URL 需要包含以下内容：

```
ssl=true&sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

因此，在您的情况下，URL 将是：

```
jdbc:postgresql://url/dstabase?ssl=true&amp;sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

此信息的来源： [https ://devcenter.heroku.com/articles/connecting-to-relational-databases-on-heroku-with-java#connecting-to-a-database-remotely](https://devcenter.heroku.com/articles/connecting-to-relational-databases-on-heroku-with-java#connecting-to-a-database-remotely)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-10-25T13:25:23.417

以下为我工作：

```
jdbc:postgresql://url/databaseName?sslmode=require&amp;sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

`ssl=true`我想改成`sslmode=require`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-01T02:49:38.133

使用 jdbc 连接 Heroku Postgres 时，有时还会出现错误，除非您将 SSL 参数添加到 url：

```
ssl=true
sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-12T18:32:08.097

它对我有用：

```
 <bean id="securityDataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="org.postgresql.Driver"/>
        <property name="url" value="jdbc:postgresql://host:port/database?ssl=true&amp;sslfactory=org.postgresql.ssl.NonValidatingFactory"/>
        <property name="username" value="user"/>
        <property name="password" value="password"/>
    </bean> 
```

我做的错误是使用 & 而不是`&amp;`（我知道很傻）

```
 ?ssl=true&amp;sslfactory=org.postgresql.ssl.NonValidatingFactory 
```

是的，这个链接肯定是有帮助的： [https ://devcenter.heroku.com/articles/connecting-to-relational-databases-on-heroku-with-java#connecting-to-a-database-remotely](https://devcenter.heroku.com/articles/connecting-to-relational-databases-on-heroku-with-java#connecting-to-a-database-remotely)

并且请记住：在此链接中，使用了 jdbc: **postgres** ://host..如果**没有发生合适的 Sql 驱动程序错误**，则可能不适合您（请改用**postgresql ）**

# asp.net-mvc-3 - MVC3 对路径的访问被拒绝

> ID：11832362
> 
> 赞同：0
> 
> 时间：2012-08-06T16:36:00.227
> 
> 标签：asp.net-mvc-3, deployment

尝试部署 MVC3 站点时出现以下错误。

我已经搜索并了解如何处理访问文件系统的错误，但我将部署到共享环境，因此无法使用 RDP（即我无法控制）。

我可以通过 web.config 或其他方式做些什么吗？

对不起，如果答案很明显。

**错误**

> > 拒绝访问路径“C:\inetpub\wwwroot\SharedSiteTest\tmp\Views\Index.cshtml”。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> > 
> > 异常详细信息：System.UnauthorizedAccessException：对路径“C:\inetpub\wwwroot\SharedSiteTest\tmp\Views\Index.cshtml”的访问被拒绝。
> > 
> > ASP.NET 无权访问请求的资源。考虑向 ASP.NET 请求标识授予对资源的访问权限。ASP.NET 有一个基本进程标识（通常是 IIS 5 上的 {MACHINE}\ASPNET 或 IIS 6 和 IIS 7 上的网络服务，以及 IIS 7.5 上配置的应用程序池标识），如果应用程序不是模拟的，则使用该标识。如果应用程序通过 模拟，则身份将是匿名用户（通常是 IUSR_MACHINENAME）或经过身份验证的请求用户。
> > 
> > 要授予 ASP.NET 对文件的访问权限，请在资源管理器中右键单击该文件，选择“属性”并选择“安全”选项卡。单击“添加”以添加相应的用户或组。突出显示 ASP.NET 帐户，然后选中所需访问权限的框。

# hibernate - 如何在 Hibernate 4.1.5 SP1 中配置二级缓存？

> ID：11832369
> 
> 赞同：6
> 
> 时间：2012-08-06T16:36:34.377
> 
> 标签：hibernate, second-level-cache, hibernate-4.x

我在这里阅读了有关此主题的其他主题，但没有一个解决方案适合我。

我试着把它放在我的 hibernate.cfg.xml 中：

```
<property name="hibernate.cache.region.factory_class">org.hibernate.cache.spi.EntityRegion</property> 
```

我总是收到此错误： *无法实例化 RegionFactory [org.hibernate.cache.spi.EntityRegion]*

我还尝试了来自 Hibernate 网站上线程的大多数建议，但没有运气。

那么我该如何配置呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T16:56:22.007

好吧，我找到了答案（来自 Youtube 用户）：

1.  使用 hibernate-release-4.1.0.Final 或更高版本。
2.  从 lib\optional\ehcache 目录添加 jars
3.  更新`hibernate.cfg.xml`：

    ```
    <property name="cache.region.factory_class">org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory</property> 
    ```

4.  添加 slf4j-api-1.6.1.jar（我在从 ehcache.org 下载的 ehcache-2.5.1-distribution.tar.gz 中另外找到）因为 ClassNotFoundException。

5.  将此添加到您的 hibernate.cfg.xml 中：

    ```
    <!-- Enable Hibernate's automatic session context management -->
    <property name="cache.use_second_level_cache">true</property> 
    ```

这里的关键点是从 Hibernate4 的 optional\ 目录中添加 ehcache jar。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:04:34.973

将以下属性添加到 Hibernate 属性：

```
<prop key="hibernate.cache.use_second_level_cache">true</prop>
<prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop>
<prop key="hibernate.cache.provider_configuration_file_resource_path">hibernate-ehcache.xml</prop>
<prop key="hibernate.cache.use_query_cache">true</prop>
<prop key="hibernate.generate_statistics">true</prop>
<prop key="hibernate.cache.use_structured_entries">true</prop> 
```

您需要 hibernate-ehcache 4.1.1 jar 或不需要 ehcache jar。

请记下已更改的缓存提供程序类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-02T11:40:56.797

希望，它可能对某些人有用（hibernate 4.x）。

我的弹簧配置摘录：

```
public Properties hibernateProperties() {
    Properties properties = new Properties();
    properties.setProperty("hibernate.hbm2ddl.auto", env.getProperty("hibernate.hbm2ddl.auto"));
    properties.setProperty("hibernate.dialect", env.getProperty("hibernate.dialect"));
    properties.setProperty("hibernate.format_sql", "true");
    properties.setProperty("hibernate.generate_statistics", env.getProperty("hibernate.generate_statistics"));
    // second-level cache:
    properties.setProperty("hibernate.cache.use_second_level_cache", "true");        
    properties.setProperty("hibernate.cache.region.factory_class", "org.hibernate.cache.EhCacheRegionFactory");
    properties.setProperty("net.sf.ehcache.configurationResourceName", env.getProperty("net.sf.ehcache.configurationResourceName"));
    return properties;
} 
```

您的类路径中必须有 'org.hibernate:hibernate-ehcache:HIBERNATE_VERSION'。

请参阅：[关于休眠配置的 Ehcache 文档](http://www.ehcache.org/documentation/user-guide/hibernate#Configure-Ehcache-as-the-Second-Level-Cache-Provider)

# database - 如何快速加载大量数据并保持数据库响应？

> ID：11832370
> 
> 赞同：0
> 
> 时间：2012-08-06T16:36:36.040
> 
> 标签：database, oracle, indexing

情况：

*   我有一张桌子 A。

*   我想将大量数据加载到表 A 中（比如说几百万条记录或更多）

好的，所以我寻找选项等，我得出的结论是我应该在加载时禁用表的索引 ok ：

*更改索引 your_index 不可用；*

但是在加载过程中，其他进程和系统可以搜索表 A 中的数据并将数据插入表 A。所以我需要使用：

*改变系统设置skip_unusable_indexes = true;*

加载数据后，我重建索引并清除标志。

好的，这里有一个问题：

1.  查询会使用我的索引（当它设置为不可用时） - 我们正在谈论大表，没有索引它们将超时

2.  如果 1 为真，在我重建索引之前，新插入的记录（我的意思是通过其他进程而不是批量加载插入的记录）会发生什么情况，它们在查询时是否返回？是否有可能以某种方式部分重建索引/为一个会话禁用它们并为另一个会话保留？

我的意思是，在大型系统中这种情况并不罕见——要加载大量数据，但系统需要保持响应。

* * *

总而言之 - 分区和分区交换看起来像是要走的路

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:50:26.970

如果索引不可用，查询将无法使用它。如果您的查询在无法使用索引时会超时，并且查询需要在您加载数据的同时发生，则您不能将索引标记为不可用。在加载期间，您将不得不承担索引维护的开销。

根据具体情况，您可能会受益于以这样的方式对表进行分区，即可以将大负载完成到临时表中，索引建立在临时表上，并进行分区交换以交换新的, 表中的空分区，用于您刚刚填充的临时表。当然，如果不了解更多关于数据的信息，就不可能知道以这种方式对表进行分区是否可行，或者它是否会对查询性能产生其他负面影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:42:10.187

如果您的数据来自文件格式，我想知道是否使用 SQL*Loader 是解决方案，因为它会为您提供您正在寻找的所有选项，即。禁用索引/约束、提交频率等。

它是一个高性能的数据加载工具。它可能适合也可能不适合您的需求，但它为您提供了另一种选择。

您的情况不是我以前遇到过的，因为我处理的大量数据负载是在系统处于非活动状态或在线用户数量较少的情况下完成的。

# math - 确保：仅为无限常规语言抽取引理？

> ID：11832371
> 
> 赞同：11
> 
> 时间：2012-08-06T16:36:37.153
> 
> 标签：math, finite-automata, regular-language, formal-languages, pumping-lemma

所以这不是关于抽水引理及其工作原理，而是关于先决条件。

在网络上你可以读到的任何地方，常规语言都必须通过抽引引理，但是没有人谈论有限语言，它实际上是常规语言的一部分。

所以我们可能都同意，以下语言是一种有限语言，也是一种常规语言，但它绝对没有通过抽水引理：

`L = {'abc', 'defghi'}`

请告诉我是否根本没有人写它，或者我们**为什么**错了——甚至没有。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-06T17:14:12.257

有限语言使用抽水引理的原因是因为你可以使抽水长度比语言中最长的单词长。[如维基百科](http://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages)（我没有我的计算理论书）所述，抽水引理如下：

> 令*L*为常规语言。那么存在一个整数*p* ≥ 1 仅取决于*L*使得*L*中长度至少为*p的每个字符串**w*（*p*称为“泵送长度”）可以写成*w* = *xyz*（即*w*可以分为三个子串），满足以下条件：
> 
>  ***1.  | *是*| ≥1
> 2.  | *xy* | ≤ *p*
> 3.  对于所有*i* ≥ 0，*xy ^i z* ∈ *L****

 **现在，考虑一些有限语言*L*，让*k* = max [*w* ∈ *L*] | *w* | 是*L*中最长单词的长度。然后我声称*L*的最小泵送长度是*p* = *k* +1。由于*L中**没有*长度至少为*k* +1 的单词，因此（空洞地）*每个*这样的单词都满足三个条件（或者，实际上，您想指定的任何其他条件）是真的。

 ***当然，您可以看到任何有限语言都是正则的（正则语言在有限联合下是封闭的，并且一个单词的所有语言都是正则的），但请注意，此论点并未表明这一点；重要的是要记住，虽然可以抽取任何常规语言，[但存在可以抽取但不规则的语言](http://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages#Converse_of_lemma_not_true)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-24T09:08:52.627

## “在为常规语言抽取引理的背景下”

**是的，我们同意**，所有有限语言都是正则语言意味着我们可以拥有有限自动机以及任何有限语言的正则表达式。
而`a infinite language may be regular or not`. 维恩图如下所示。所以我们只需要检查无限的语言 L，它的规则不是！

想想FA：

*   任何`automata`for `a finite language can not contains loop!`（也是`regular expressions for finite language will be without * and +`操作）。

*   任何`automata`为`a infinite language(regular) will contain the loop`. `We can't construct an automata for infinite language without loop`; 其中循环可能是通过其他状态的自循环。{如果它的自循环，则单个符号重复任意次数，如果通过其他状态进入循环的符号序列可以重复任意次数}。

抽水意味着重复。在抽水引理`w`可以分为三部分*x, y, z*。'y' 部分`w`发生在循环中（即 y>=1 ）。因此，抽引引理并没有找到循环部分`y`并多次重复这个循环部分。
![在此处输入图像描述](../Images/2ce3808b83a4325024cba1fcdb3eda15.png) 您可以查看是否多次重复循环并生成新的字符串`w'`，它仍然是语言。

**注意**：`Regular Expressions for infinite language can't be without * and +`操作！

**[答案]**有限语言的自动机中没有循环，所以我们不能泵送（通过重复生成）语言中的新字符串。并且 Pumping Lemma 不适用于有限语言。

> 尽管一些作者还解释了有限语言的抽引引理，其中`i`xy ^i z 可以有界地重复（比如 k ≤ i ≤ m ）

* * *

![在此处输入图像描述](../Images/b2b5da1de943a9d2babcb61cf091f510.png)

在维恩图中，每个有限集都是正则的。无限集可能是规则的，也可能不是。 `Regular-Languages ⊆ Non-Regular Languages`

* * *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-21T15:39:33.027

有一种最简单的方法可以证明某种语言是无限的。假设 L 是某个正则表达式 E，L(E) 的语言。

假设 L(E) 等价于`{ab^nc | n ≥ 0}`。

我们知道 E 的形式是`ab*c`，并且我们知道这种语言可能是正则的（我们不能证明某些东西是正则的），因为这个结论的泵引理是`k = 0`，换句话说，`xz = ac`，并且每个正则表达式都有一个等价的自动机.

结论很简单，如果 DFA 有一些状态可以转换到自己，那么语言是无限的。

```
 a   b   c

 q0  q1    
 q1     q1  q2
*q2 
```

q1 具有到自身的过渡，因此 L(E) 是无限的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-06T17:03:42.153

根据定义，有限语言是正则语言，因为您可以通过仅表达所有单词的并集来构建满足它的正则表达式（例如`(abc)|(defghi)`，满足您的语言的正则表达式），因此您可以拥有一个满足它的[确定性有限自动机。](http://en.wikipedia.org/wiki/Deterministic_finite_automaton)

无法通过抽水引理并不意味着语言不规则。实际上，要使用抽水引理，您的语言必须在其定义中具有某种闭包。如果您的语言只是一组单词，则没有什么可以“泵入”其中的。*****

# cordova - GCM Phonegap，如何向手机的核心通知发送消息

> ID：11832374
> 
> 赞同：0
> 
> 时间：2012-08-06T16:36:59.227
> 
> 标签：cordova, google-cloud-messaging

我已成功设置代码以在 Android 应用程序上通过 phonegap 运行 GCM。我设法保护了手机注册 ID，并能够在 PHP 脚本中使用此 ID 向应用程序发送消息。

我唯一的问题是在应用程序打开时消息显示为 javascript 警报，并且我希望在应用程序运行或未运行时将消息发送到手机的核心通知（类似于什么是应用程序）。

有谁知道 Phonegap 的 GCM 插件是否能够做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T12:18:33.567

我使用了不同的插件来获取状态栏通知，在以下位置找到它：

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/StatusBarNotification](https://github.com/phonegap/phonegap-plugins/tree/master/Android/StatusBarNotification)

然后在设备上的 gcm java 脚本中的 on receive 函数中添加这行代码：

window.plugins.statusBarNotification.notify("把你的标题放在这里", "把你的消息放在这里");

工作得很好，唯一的问题是如何唤醒设备......我会尽快找到它的答案。

我找到了一种唤醒设备的方法，抱歉我忘了早点回复：

诀窍是在 JAVA 代码中的 GCM 服务的接收器模块中创建一个挂起的意图，然后该挂起的意图被应用程序的主要活动接收，活动和活动被加载到 ram 中。然后 GCM 服务等待五秒钟，以便主要活动完成加载......然后接收通知并将其发送给科尔多瓦......对我有用，但您可能还想在您提出之前检查活动是否已经在运行待定意图。

下面添加 GCM 服务的代码

```
//Intent notifyIntent = new Intent("com.cordova2.gcm.MainActivity");

Context context2 = getApplicationContext();

  PendingIntent pendingIntent;
  Intent notifyIntent = new Intent();
  notifyIntent.setClass(context2, com.cordova2.gcm.MainActivity.class);
  pendingIntent =  PendingIntent.getActivity(context2, 0, notifyIntent, 0);
  try {
    pendingIntent.send();
} catch (CanceledException e1) {
    // TODO Auto-generated catch block
    e1.printStackTrace();
}

long endTime = System.currentTimeMillis() + 5*1000;
while (System.currentTimeMillis() < endTime) {
    synchronized (this) {
        try {
            wait(endTime - System.currentTimeMillis());
        } catch (Exception e) {
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T14:45:23.207

Mark Nutter 有一个 Android C2DM Phonegap 插件的分支，转换为使用 GCM。

[https://github.com/marknutter/GCM-Cordova](https://github.com/marknutter/GCM-Cordova)

查看 GCM-Cordova/src/com/cordova/gcm/GCMIntentService.java 中的 onMessage 方法，这是 StatusBarNotifications 的好地方。

并查看GCM-Cordova/src/com/google/android/gcm/GCMBroadcastReceiver.java中的onReceive方法，这是Toast弹窗的好地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T17:00:43.003

Mark 的插件效果很好，但在应用程序未运行时我无法让它工作。它是一个已知的错误。

请记住，该插件不做系统通知。它只是将数据推送到您的手机......这太棒了，因为它可以让您对这些数据做任何您想做的事情，并且可以用来推送带有一些本机代码的系统通知。

然而，我也遇到的一个大问题是在应用程序脱机时让它工作。:(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T15:14:43.983

这篇文章让这一切发生...

[http://www.adobe.com/devnet/phonegap/articles/android-push-notifications-with-phonegap.html](http://www.adobe.com/devnet/phonegap/articles/android-push-notifications-with-phonegap.html)

在标题为“状态栏通知”的步骤中，我选择使用 java 本机代码而不是 javascript 插件。

# model-view-controller - 最大化/最小化时不保留 Portlet 状态

> ID：11832375
> 
> 赞同：0
> 
> 时间：2012-08-06T16:37:01.300
> 
> 标签：model-view-controller, extjs4, portlet, liferay-6

我正在使用 Liferay 6 和 MVC portlet。我使用 jsp 和 extjs 来呈现我的 portlet。当我最大化/最小化时，portlet 的当前状态会丢失。即使在最大化/最小化之后，我也想保留 portlet 的状态。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T09:19:55.100

Portlet 有两个阶段：动作阶段和呈现阶段。当某些状态必须改变时，动作阶段将运行，例如。当表单提交完成时。渲染阶段将始终运行，在最大化/最小化之后也是如此。如果您不希望在渲染阶段更改某些状态，请将此逻辑置于操作阶段。

通过 MVC-Portlet，您有两种方法来处理每个阶段：

```
public class MyLiferayTestPortlet extends MVCPortlet {
    @Override
    public void processAction(ActionRequest actionRequest, ActionResponse actionResponse) throws IOException, PortletException {
        System.out.println("action");
        //here you can change the state
    }

    @Override
    public void doView(RenderRequest renderRequest, RenderResponse renderResponse) throws IOException, PortletException {
        System.out.println("rendering");
        //here you can prepaire the rendering of jsp

        //print the window state
        ThemeDisplay td = (ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
        System.out.println("isStateMaximized: " + td.isStateMaximized());
    }
} 
```

在这里您可以阅读有关 portlet 的两个阶段的信息： [http ://www.liferay.com/documentation/liferay-portal/6.1/development/-/ai/understanding-the-two-phases-of-portlet-executi-4](http://www.liferay.com/documentation/liferay-portal/6.1/development/-/ai/understanding-the-two-phases-of-portlet-executi-4)

# node.js - 如何解决我的 MongoDB 服务器突然占用 100% CPU 的原因？

> ID：11832376
> 
> 赞同：2
> 
> 时间：2012-08-06T16:37:21.940
> 
> 标签：node.js, mongodb, mongoose

我即将准备好在 Amazon Cloud 上运行我的 node.js/mongo 应用程序。我为 Mongo 服务器设置了 3x 副本集。一切正常，直到大约 20 分钟前，突然间，PRIMARY mongo 服务器的 CPU 使用率跃升至 100%（通常它几乎没有任何使用率）。我目前正在测试只有大约 10 个用户的应用程序，所以这非常令人担忧。

我的第一反应当然是从服务器上抓取 mongodb 日志文件。我原以为这会有所启发，但现在我比以往任何时候都更加困惑。我的数据库的主要功能之一是为用户缓存数据，所以我有一个 Collection ('DataCache')，它只存储一个 JSON 字符串（Mongoose 代码）：

```
new Model('DataCache',{ 
  '_id': { type: String, unique: true }, 
 'data': String, 
 'updated': Date }); 
```

查看来自“100% CPU”时间的日志，我看到标准更新请求已执行，但花费了大约 47 秒！

```
Mon Aug  6 08:58:36 [conn28821] update storage.datacache query: { _id: "14954006/mentions/dcc3c69e72da714a0f3bffc518183ebb" } update: { $set: ... } } 47174ms 
```

此请求的数据不再比平时更长（JSON 字符串中约有 1000 个字符；为简洁起见，此处截断了数据）。

我真的不知道还有什么地方可以弄清楚为什么我的使用量突然上升了这么多。我无法想象这种情况有什么不寻常/独特之处，而且我在日志中看不到任何其他内容，但我非常担心当我们的 10 个用户扩展到数千个时会发生什么......

问题在启动后大约 20 分钟后突然消失，但 CPU 仍然出现奇怪的峰值（RightScale 仪表板图像）： ![右刻度](../Images/220e129ad3693ee510aa6fb528ec02bb.png)

* * *

更新：这是从 mongo 打印的一些关于缓存集合的信息，特别是。我不确定问题是否与缓存集合有关，但这是我在滞后时间内看到的最一致的一个查询......

```
 {
        "ns" : "storage.datacache",
        "count" : 43949,
        "size" : 132274592,
    "avgObjSize" : 3009.729277116658,
    "storageSize" : 158887936,
    "numExtents" : 13,
    "nindexes" : 5,
    "lastExtentSize" : 33828864,
    "paddingFactor" : 1.0099999999994833,
    "flags" : 1,
    "totalIndexSize" : 10972192,
    "indexSizes" : {
        "_id_" : 4570384,
    },
    "ok" : 1
} 
```

* * *

编辑：更多图表 ![在此处输入图像描述](../Images/57cf9a89a19aa041b9765cdce7e08cee.png) ![在此处输入图像描述](../Images/b47f22161bca3ebe9d15173aacbf6693.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:16:10.363

通常，对于 MongoDB，CPU 峰值来自几个特定问题。通常，MongoDB 的 CPU 非常低。它通常完全受 IO 或内存占用限制。

这是（希望）一个有用的简短列表：

1.  **不好的查询。**这是任何没有索引的查询。我注意到`DataCache`有一个`Updated`未编入索引的字段。你每次都按那个字段查询吗？
2.  **映射/减少**。Map / Reduce 作业通常会将一个核心“固定”在 100%。这些数据库上有多少个内核？你在做 MR 工作吗？
3.  **IO 掩码为 CPU**。根据报告，CPU 实际上可能是`CPU_WAIT`，这通常是磁盘 IO。

因此，如果您返回图表，请查看您的 IO 时间和 RAM 使用情况。找出您的 RAM:DATA 比率并找出您的 IO 需求。让我们知道您使用的是什么类型的机器。

# debugging - XSLT 逐步调试器

> ID：11832381
> 
> 赞同：0
> 
> 时间：2012-08-06T16:37:31.563
> 
> 标签：debugging, xslt

我知道这个问题就像之前提出的一个问题，但我需要一个好的 xslt 调试器，它允许我在发生 xsl 转换时逐步完成。我有氧气，真的很喜欢它的功能，但我的试用 lincense 用完了。有人知道为此目的的另一个好方法吗？最好完全免费，但如果它是试用版，总比没有好。我正在运行 mac osx，但我不想只为我的一个 vm 获得一个新许可证，因为我不想一直来回切换，而且我不确定我的 vm 上的网络映射有多稳定是并且可能需要一段时间才能允许它访问我想要的网络驱动器。任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:42:18.040

Visual Studio 可以很好地做到这一点。有关详细信息，请参见[此处](http://msdn.microsoft.com/en-us/library/ms255605%28v=vs.80%29.aspx)。我认为您可以使用免费的[VS express](http://www.microsoft.com/visualstudio/en-us/products/2010-editions/express)来做到这一点。

# javascript - 记录的对象更改时控制台未按预期运行

> ID：11832397
> 
> 赞同：0
> 
> 时间：2012-08-06T16:39:00.180
> 
> 标签：javascript, google-chrome-devtools

> **可能重复：**
> [Chrome 的 JavaScript 控制台是否懒于评估数组？](https://stackoverflow.com/questions/4057440/is-chromes-javascript-console-lazy-about-evaluating-arrays)

我不确定这是否与 JS 或 Chrome 或 console.log 或什么有关，但有兴趣得到答案。

我在 Eclipse 中编码并在 Chrome 中运行`console.log`以进行一些调试。我的代码包含在 JQuery`.ready()`方法中。

我定义了一个简单`var arr = [1,2,3,4,5];`的数组，然后记录数组和它的第一个值，这给了我（正如我所期望的）输出`[1, 2, 3, 4, 5]`和`1`.

`arr[0] = 12;`然后，我使用并再次记录相同的数组和第一个值来更新第一个值。我的代码现在看起来像这样：

```
var arr = [1,2,3,4,5];
console.log(arr);
console.log(arr[0]);
arr[0] = 12;
console.log(arr);
console.log(arr[0]); 
```

并得到以下输出：

```
[12, 2, 3, 4, 5]
1
[12, 2, 3, 4, 5]
12 
```

我的问题是，为什么在输入值之前调用第一个日志时，第一行和第三行都记录更新的第一个值？

这只是调用 log 方法的延迟还是这里发生了其他事情？

谢谢你的帮助 ：）

# python - 验证邮政编码？

> ID：11832400
> 
> 赞同：2
> 
> 时间：2012-08-06T16:39:08.453
> 
> 标签：python, python-3.x

我在网上做一些教程......我一直在做一个练习：定义一个函数`postalValidate(S)`，它首先检查 S 是否代表一个有效的邮政编码。**注意：**我应该用字符串、列表、if 语句、循环和其他基本结构（如变量和函数）来解决它。

首先，删除所有空格；余数必须`L#L#L#`是`L`字母（小写或大写）和`#`数字的形式。

如果`S`不是有效的邮政编码，则返回 boolean `False`。如果有效，则以每个大写`S`的漂亮格式返回相同邮政编码的版本。`L#L#L#``L`

我已经为这些练习创建了一个代码，但评分者说这是错误的，但我也会发布它。

```
def postalValidate(S):
   while " " in S:
     S.remove(" ")
   for i in range(1,6,2):
     S.isdigit(S[i])
   for j in range(0,5,2):
     S.upper(S[j]
     S.isalpha(S[j])
   return True 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T16:59:04.490

这显然是正则表达式的工作，虽然我不知道你是否应该在练习中使用它们......

我将其发布为答案，以防万一。否则，请告诉我们...

```
#/usr/bin/evn python

import re
zipCode = re.compile(r"\s*(\w\d\s*){3}\s*")

if __name__ == "__main__":
    samples = [
        "           44F 4 F", #Invalid
        "  L0L0L0    ", #Valid
        "  L0  L0  L0    ", #Valid
    ]

    for sample in samples:
        if zipCode.match(sample):
            print "The string %s is a valid zipCode (nice and clean: %s)" % (sample, sample.replace(" ", "").upper())
        else:
            print "The string %s is NOT a valid zipCode" % sample 
```

* * *

**编辑：**

既然你不能使用正则表达式，我建议你改变思维方式......而不是检查字符是否属于有效的邮政编码，我建议你做相反的事情：检查它们是否不属于在有效的邮政编码中，一旦检测到错位（或错误）字符，就会返回 False：

```
def postalValidate(S):
    S = S.upper().replace(" ", "")
    if len(S) == 6:
        for i in range(len(S)):
            if i % 2 == 0:
                #Even index (0, 2, 4, 6...) , has to be 'letter'
                if not(S[i].isalpha()):
                    return False 
            else:
                #Odd index (1, 3, 5, 7...), must be 'number'
                if not(S[i].isdigit()):
                    return False

    else:
        #You can save some cpu ticks here... at this point, the string has to be of length 6 or you know it's not a zip
        return False
    return S 
```

return 语句停止当前函数的执行，因此一旦您意识到要检查的字符串存在“错误”，您就可以返回 False（一旦您知道它无效，就没有必要继续检查，对吧？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:00:24.847

```
import re
def postalValid(S):
    spaceless = S.replace(' ','')
    if not re.match(r"[a-zA-Z][0-9]+[a-zA-Z][0-9]+[a-zA-Z][0-9]+",spaceless):
       return False
    return spaceless.upper() 
```

正则表达式（python [re 模块](http://docs.python.org/library/re.html)）在字符串中查找模式。

`[a-zA-Z]`将完全匹配 1 个字母

`[0-9]+`将匹配一位或多位数字（即 0,9,99,9999）...如果您只想要一位数字，只需去掉加号运算符 `[0-9]+`并使其`[0-9]`与一位数字完全匹配

so `[a-zA-Z][0-9]+[a-zA-Z][0-9]+[a-zA-Z][0-9]+`匹配一个字母后跟一个数字（多位数字很好），后跟一个字母，后跟另一个数字，后跟另一个字母，并以数字结尾

如果您不能使用正则表达式，那么您可以这样做

```
def postalValid(S):
    no_spaces = S.replace(" ","")
    if len(no_spaces ) > 6: return false
    for i in range(6):
        if i%2:
           if not no_spaces[i].isdigit():return False
        else:
           if not no_spaces[i].isalpha():return False

     return no_spaces.upper() #True 
```

但假设每个数字只有一个数字

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T06:28:11.717

我碰巧正在研究同一个教程，具有相同的编码约束。经过几个小时的挠头：

```
def postalValidate(S):
   S = S.replace(" ","") 
   if len(S) != 6 or S.isalpha() or S.isdigit(): 
      return False  
   if not S[0:5:2].isalpha(): 
      return False  
   if not S[1:6:2].isdigit(): 
      return False 
   return S.upper() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T16:59:56.997

所以大概 S 是一个字符串，所以我将不再使用它。首先，您调用 isdigit 和 isalpha 是错误的，其次，如果它不是有效的邮政编码，您将永远不会返回 false。 `return True`无论代码中发生什么，总是返回 True。这就是我认为你正在尝试做的事情：

```
def postal_validate(s):
    s = s.replace(' ', '')
    for i in range(1,6,2):
        if (not s[i].isdigit()):
            return False
    for i in range(0,5,2):
        if (not s[i].isalpha()):
           return False
    return s.upper() 
```

当然，我可能是错的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-06T17:00:21.003

```
import re

regex ="[a-zA-Z]+\d+[a-zA-Z]+\d+[a-zA-Z]+\d+"

def ispostal(v):
    v = re.sub('\s+', '', v)
    if re.match(regex, v):
        return v.upper()
    else:
        return False 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-06T17:03:58.773

我没有发布确切的代码，而只是发布算法。**请阅读内联评论。**（注意：以下不是python代码..）

```
def postalValidate(S):
   while " " in S:
     S.remove(" ") #Are you sure this will work? Strings are immutable.. You need to assign back to `S`

   for i in range(1,6,2):
     if s[i] is not a digit:
         return False
   for j in range(0,5,2):
     S.upper(S[j]) # you need to assign to S[j] again, plus use ".upper()"
     if S[j] is not alpha:
         return False
   return s.upper() #simple .upper() will do the job. 
```

如果你可以使用`re`，它会很简单：

```
if re.search(r'^([a-zA-Z][0-9]){3}$', s.strip()):
    return s.strip().upper()
return False 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-06T17:42:19.863

这是编写和验证练习函数的一种相对简单的方法。从字符串参数中删除第一个空格字符，这会在进程中生成它的本地副本。然后根据有点长的逻辑表达式中的每个子表达式的计算结果是否为 True，返回一个布尔值。

```
def postalValidate(s):
    s = s.replace(" ", "")
    return(len(s) == 6 and
           all(s[i].isdigit() for i in range(1, 6, 2)) and
           all(s[i].isalpha() for i in range(0, 5, 2)))

if __name__ == '__main__':
    for testcase in 'a1b2c3', '980222', 'A456C7':
        print('postalValidate({!r}) -> {}'.format(testcase,
                                                  postalValidate(testcase))) 
```

输出：

```
postalValidate('a1b2c3') -> True
postalValidate('980222') -> False
postalValidate('A456C7') -> False 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-02T18:10:00.877

我知道为时已晚，但让我试着回答这个问题，因为我刚刚完成了同样的练习。

根据[练习](https://cscircles.cemc.uwaterloo.ca/14-methods/)，定义一个函数`postalValidate(S)`，它首先检查是否`S`代表有效的邮政编码（加拿大）：

*   首先，删除所有空格；

*   余数必须`L#L#L#`是`L`字母（
    小写或大写）和# 是数字的形式。

如果`S`不是有效的邮政编码，则返回 boolean `False`。如果有效，则以每个大写`S`的漂亮格式返回相同邮政编码的版本。`L#L#L#``L`

应该使用他们刚刚介绍的以下方法：

`str.replace()`, `str.isalpha()`,`str.isdigit()`和`str.upper()`

他们的站点不允许导入模块，因此不能使用正则表达式。

这是我的代码：

```
def postalValidate(S):
   S = S.replace(' ', '')
   if len(S) == 6:
      if S[::2].isalpha() and S[1::2].isdigit(): # slicing with step
         return S.upper()
      else:
         return False
   else:
      return False 
```

测试运行包括以下参数：'H0H0H0'、'postal'、'd3 L3 T3'、'3d3 L3 T'、''、'n21 3g1z'、'V4L1D'、'K1A 0A3'、'H0H0H'</p>

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-16T22:11:53.383

接受的答案不认为 5 位邮政编码有效。我建议改用O'Reilly 的[这种模式](https://www.oreilly.com/library/view/regular-expressions-cookbook/9780596802837/ch04s14.html)：

`zipCode = re.compile(r"^[0-9]{5}(?:-[0-9]{4})?$")`

这适用于所有有效的美国邮政编码。

# javascript - JQuery 只切换最接近它的相关 div

> ID：11832405
> 
> 赞同：2
> 
> 时间：2012-08-06T16:39:30.787
> 
> 标签：javascript, jquery, toggle

我有一组类似的 div，我正在使用一些基本代码进行切换，如下所示：

```
 $(".field-group-format-toggler-abstract").click(function()
            {
        $(".field-group-format-wrapper").toggle();
   }); 
```

我遇到的问题是，每当我触发“+”时，当我只想切换最接近它的相关 div 时，它会切换具有相同类的所有其他 div `.field-group-format-wrapper`。我尝试了 .next 和 .closest 但这似乎只是锁定了一些东西然后它不起作用但我没有收到语法错误，例如

```
$(".field-group-format-toggler-abstract").click(function()
                {
            $(".field-group-format-wrapper").closest().toggle();
       }); 
```

我在这里创建了一个工作版本，但如果你像我上面那样添加 .closest，它就不再工作了。

[http://jsfiddle.net/LHguJ/5/](http://jsfiddle.net/LHguJ/5/)

** 注意，我只想显示/隐藏里面的内容，`field-group-format-wrapper`所以“标题”仍然需要显示是否展开。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:42:18.727

你想要的是[兄弟姐妹（）](http://api.jquery.com/siblings/)。并使用它来引用单击的元素。您正在使用最接近的寻找[最接近的（）](http://api.jquery.com/closest/) “父母”。

```
$(".field-group-format-toggler-abstract").click(function() {
    $(this).siblings(".field-group-format-wrapper").toggle();
});​ 
```

[http://jsfiddle.net/LHguJ/11/](http://jsfiddle.net/LHguJ/11/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:45:19.597

你可以这样使用`nextAll()`：

[jsFiddle](http://jsfiddle.net/swNLr/)

```
$(".field-group-format-toggler-abstract").click(function(){
    $(this).nextAll(".field-group-format-wrapper").toggle();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T16:50:16.923

尝试使用`$(this).parent().find(".field-group-format-wrapper")`

```
$(".field-group-format-toggler-abstract").click(function() {
    $(this).parent().find(".field-group-format-wrapper").toggle();
}); 
```

[http://jsfiddle.net/LHguJ/12/](http://jsfiddle.net/LHguJ/12/)

或与`siblings`：

```
$(".field-group-format-toggler-abstract").click(function() {
    $(this).siblings(".field-group-format-wrapper").toggle();
}); 
```

​http://jsfiddle.net/LHguJ/13/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:41:49.460

jQuery

```
$(".field-group-format-toggler-abstract").click(function(){
    $(this).siblings(".field-group-format-wrapper").toggle();
    $(this).html( $(this).html() == '+' ? '–' : '+');
});​ 
```

[http://jsfiddle.net/iambriansreed/JLj2X/](http://jsfiddle.net/iambriansreed/JLj2X/)

# c++ - 使用 GNU cgicc 处理多个 POST 附件

> ID：11832406
> 
> 赞同：2
> 
> 时间：2012-08-06T16:39:31.770
> 
> 标签：c++, post, cgi, httprequest

我正在尝试将包含多个二进制文件的 POST 请求发送到 HTTP 服务器。服务器使用[cgicc](http://www.gnu.org/software/cgicc/)解释请求。

对于单个文件，它的工作方式如下：

```
cgicc::Cgicc cgi;
cgicc::const_file_iterator file;
file = cgi.getFile("file_1");
if(file != cgi.getFiles().end())
{
      std::stringstream stringStream;
      file->writeToStream(stringStream);
      //do whatever with stringStream
} 
```

现在，假设我想发布多个文件并且我不知道附件的名称以便提前调用`cgi.getFile("file_x")`每个文件，有没有办法遍历所有文件？对于 GET 参数，我可以这样做：

```
cgicc::Cgicc cgi;
const std::vector<cgicc::FormEntry> &formElements = cgi.getElements();
for (std::vector<cgicc::FormEntry>::const_iterator i = formElements.begin(); i != formElements.end(); ++i)
{
    //process each (*i)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:58:58.087

我已经想通了（这很明显，但记录不充分）：

```
cgicc::Cgicc cgi;
const std::vector<cgicc::FormFile> &formFiles= cgi.getFiles();
for (std::vector<cgicc::FormFile>::const_iterator i = formFiles.begin(); i != formFiles.end(); ++i)
{
    //process each (*i)
} 
```

# msbuild - MSBuild 构建顺序

> ID：11832407
> 
> 赞同：29
> 
> 时间：2012-08-06T16:39:40.160
> 
> 标签：msbuild, msbuild-4.0

我有一个包含 100 多个项目（C++、托管 C++、C#）的大型解决方案，其中许多项目相互依赖。

我有一个 TeamCity 服务器，我想在那里构建这个解决方案。

当我在 VisualStudio 中构建解决方案时，一切正常，但使用 TeamCity 时出现 CS0006 错误。我知道为什么会这样——TeamCity 使用 MSBuild 4 来构建解决方案，但在 MSBuild 4 中有一个已知的错误——它忽略了构建顺序并按照它想要的顺序从解决方案构建项目。由于这种行为，如果您有：

```
Project A
Project B which has reference to A 
```

MSBuild 可以按以下顺序构建这些项目：

```
1\. B
2\. A 
```

最简单的解决方案是设置**BuildProjectReferences=true**（默认），所有引用的项目都将自动构建。但我不能使用这种方法，因为不是所有引用的项目都在这个解决方案中，而且我不能从另一个解决方案构建项目。

这是解决此问题的另一个方法 - 使用**ConfigurationManager**并禁用所有不应构建的项目，但它仅适用于 VisualStudio - MSBuild 会忽略它并构建所有引用的项目。

问题是恢复构建顺序，我可以在 VisualStudio 窗口**ProjectBuildOrder**中看到，如果我直接从控制台使用 MSBuild，这不是真的。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-14T12:53:48.087

请参阅Visual Studio 博客中的[使用 MSBuild.exe 时解决方案构建顺序不正确：](http://blogs.msdn.com/b/visualstudio/archive/2010/12/21/incorrect-solution-build-ordering-when-using-msbuild-exe.aspx)

> 遵循这个原则：根本不要使用解决方案文件中表达的依赖关系！更好地在具有依赖关系的文件中表达依赖关系：改为在项目中放置项目引用。在我们的示例中，这将是从 B 到 C 的项目引用。
> 
> 您之前可能没有这样做，因为您不想引用项目引用的目标，而只是订购构建。但是，在 4.0 中，您可以创建一个仅订购构建而不添加引用的项目引用。它看起来像这样——注意元数据元素，`<ItemGroup>`当然所有这些都在标签内：
> 
> ```
> <ProjectReference Include="foo.csproj">
>     <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
> </ProjectReference> 
> ```
> 
> 请注意，您必须使用文本编辑器添加子元素 - Visual Studio 可以添加项目引用，但不会公开此元数据的 UI。
> 
> 我也可以通过删除解决方案文件中的依赖项来进行整理——删除现在不需要的行——你的 GUID 会有所不同，但使用 VS 对话框，它会完成这项工作......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-02-08T08:56:40.363

当我尝试构建一个依赖于 .Net Core 项目输出的 .Net 标准项目时，上面的解决方案对我来说不太适用。我必须添加一个额外的“SkipGetTargetFrameworkProperties”才能获得在 VS2017 和 MSBuild 中构建的解决方案。

```
<ProjectReference Include="foo.csproj">
    <ReferenceOutputAssembly>false</ReferenceOutputAssembly>
    <SkipGetTargetFrameworkProperties>true</SkipGetTargetFrameworkProperties>
</ProjectReference> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-04-27T06:36:04.423

我有一个很像这样的问题。它通过在成功构建整个解决方案之前需要两次构建来体现在解决方案中。

事实证明，我不小心添加了一个*Reference*而不是*ProjectReference*（在 .sln 文件中查找），这意味着 VS/MSBuild 将需要并查找引用的库文件，但完全不知道*如何*构建它如果它不见了。最终，构建过程将与引用的库一起进入项目，构建它并使其可用于下一次构建尝试。

根据您的依赖关系树和 MS 工具链的特定情绪，这可能会出现零星错误，因此是一个需要调试的婊子。

**短版**：确保对解决方案中项目的引用被列为*ProjectReference*而不仅仅是*Reference*。*通过在解决方案*选项卡上添加引用而不是浏览和选择 DLL 文件来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-02T19:42:08.147

上面提到的任何内容都对我没有帮助。我使用的解决方案是构建 sln 几次，在第一次运行时传递 /t:1stproject.csproj，然后传递 /t:2ndproject，最后传递没有 /t 的 sln 以完成其余的解决方案。

# asp.net - clientid 在两台不同的机器上的创建方式不同

> ID：11832417
> 
> 赞同：0
> 
> 时间：2012-08-06T16:40:17.757
> 
> 标签：asp.net

我在转发器中有一个用户控件，它有一些自定义验证。我为 OnItemDataBound 中的每个文本框按钮对创建了一个验证组。在本地环境中，验证对每个控件单独进行。在我们的暂存环境中，单击一个按钮会验证所有文本框。

查看生成的 JS 代码，我看到了不同之处。我不知道这是否重要，但可能是。

分期：

```
cphBody_bodyContent_rptFieldsSummary_ucFieldSummary_0_ucNewSubjectQuestion_0_vldNotHintText_0.clientvalidationfunction = "HintText_ClientValidate"; 
```

当地的：

```
ctl00_ctl00_cphBody_bodyContent_rptFieldsSummary_ctl00_ucFieldSummary_ucNewSubjectQuestion_vldNotHintText.clientvalidationfunction = "HintText_ClientValidate"; 
```

这可能是问题吗？无论如何，如果有人知道为什么存在这种差异，我很想知道，即使这不是我问题的解决方案:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:45:43.970

如果您有任何其他代码通过 ID 引用这些元素，这可能会成为一个问题。显然，根据您提供的行，事件处理程序仍将被正确分配。

如果您担心这会成为问题，请将所有控件的**"ClientIDMode"**设置为**"Static"**，然后为它们分配一个 ID。这应该会导致文本框/按钮始终具有相同的 ID。

请注意，这只发生在 ASP .NET 控件中，而不是标准 HTML 控件。

# c# - 具有复利区间的数字范围

> ID：11832418
> 
> 赞同：1
> 
> 时间：2012-08-06T16:40:23.080
> 
> 标签：c#, math, gdi+

为了调整字体大小，我需要计算范围内开始和结束之间的步骤。

鉴于：

```
Start Value: 14.0,
End Value: 250.0,
Steps: 28

Resulting Values: 14.0, 15.5, 17.1, 18.9, ... 204.9, 226.3, 250.0 
```

`10.45%`我通过添加到前一个值（基于反复试验）来计算每个值，但我如何计算这个百分比？
猜测这里可以使用一些复利类型的函数。
公式或伪代码很好。

最终，这将是一个 C#。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:56:09.477

```
EndValue = StartValue * ( ( 1 + Percentage ) ^ NumberOfSteps ) 
```

是您需要的基本公式。

如果你知道`NumberOfSteps`并且你想要`Percentage`，一点代数就会得到公式（伪代码，`^`是指数运算符）：

```
EndValue / StartValue = ( 1 + Percentage ) ^ NumberOfSteps
(EndValue / StartValue) ^ (1 / NumberOfSteps) = 1 + Percentage
Percentage = ( (EndValue / StartValue) ^ (1 / NumberOfSteps) ) - 1 
```

如果您知道`Percentage`并且想要`NumberOfSteps`，最好使用循环

```
int NumberOfSteps = 0;
for(double i = StartValue; i < EndValue; i *= (1 + Percentage))
{
    ++NumberOfSteps;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:48:16.753

Ce^(kt) 是数学中的复利利率本金。其中 C 是初始量，e 是常数 e= 2.71828.... 它就像 pi；k 是百分比，t 是时间。如果您想要百分比，则使用 Ce^(kt) 向后工作以获得 K 值。

# c# - 为什么我会遇到在 EF 中进行简单更新的所有障碍？

> ID：11832420
> 
> 赞同：8
> 
> 时间：2012-08-06T16:40:26.853
> 
> 标签：c#, asp.net, entity-framework, ef-code-first, entity-framework-4.3

我有身份证，也有名字。所以本质上，我的方法只有这些参数：

```
public void Foo(int id, string name)
{
} 
```

我在方法中有这段逻辑：

```
User user = new User(){ Id = id, Name = name };
Db.Entry(user).State = System.Data.EntityState.Modified;
Db.SaveChanges(); 
```

而已。没有什么花哨。我收到此错误：`"An object with the same key already exists in the ObjectStateManager. The ObjectStateManager cannot track multiple objects with the same key"`

以及 Ladislav Mrnka 的回答：[ObjectStateManager 中已经存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象](https://stackoverflow.com/questions/6033638/an-object-with-the-same-key-already-exists-in-the-objectstatemanager-the-object)

建议使用`context.Entry(oldEntity).CurrentValues.SetValues(newEntity);`，但我并没有 oldEntity。谁能告诉我如何只更新用户的 1 个属性？我快疯了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:26:26.677

> 我每个请求只创建一次，创建后我将它存储在 HttpContext.Items 中。因此，即使我向 DB 发出多个请求，它也使用相同的 DbContext。这有帮助吗？

如果“对 DB 的多个请求”中的任何一个加载具有相同 ID 的用户，您将收到此异常。尝试使用这个：

```
public void Foo(int id, string name) {
   var user = Db.Users.Local.SingleOrDefault(u => u.Id == id);
   if (user == null) {
      user = new User { Id = id };
      Db.Users.Attach(user);
   } 

   user.Name = name;
   Db.SaveChanges();
} 
```

代码首先尝试从已加载的实体中获取用户实例（不对数据库进行查询），并仅在尚未加载用户时创建一个新实例。

# javascript - 在 iPad 上按 Enter 时停止回发

> ID：11832422
> 
> 赞同：0
> 
> 时间：2012-08-06T16:40:29.227
> 
> 标签：javascript, jquery, ipad

每次在 iPad 上按下 enter 时，整个页面都会刷新，我想防止这种情况发生。我已经尝试了我看到的每个示例，但它无法在 ipad 上运行。

```
 $('#<%= txtEmail.ClientID %>').keyup(function (e) {
       if (e.which === 13) {  
           alert('enter was pressed');  
           e.preventDefault();         
           return false;
       }
   }); 
```

警报正在工作，但页面每次都在刷新，有什么想法可以更改以使此代码在 ipad 上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:59:20.290

我猜这个`keypress`事件会导致表单提交，你需要阻止它。`submit`但是，阻止事件而不是处理令人困惑的[键事件](http://quirksmode.org/dom/events/keys.html)可能更直接（另请参见[检测击键](http://quirksmode.org/js/keys.html)）。

# php - 在 jQuery 中使用 getScript() 在 FireFox 中报告 Javascript 错误“XML 不能是整个程序”

> ID：11832424
> 
> 赞同：0
> 
> 时间：2012-08-06T16:40:47.677
> 
> 标签：php, javascript, jquery, firefox, getscript

我遇到了浏览器在我的页面上报告 javaScript 错误的问题。尽管该页面功能齐全，但我更喜欢没有 javaScript 错误，因为它对用户来说看起来很糟糕。

我在 FF 中遇到的错误是：

```
Error: SyntaxError: missing } in XML expression
Source File: http://localhost/resources/adagiotips.php
Line: 14, Column: 4
Source Code:
 }); 
```

我在 jQuery 中使用 getScript() 函数来定位一个 php 页面，该页面呈现包含 javascript 和 html 的代码。然后我使用此页面的输出来填充 div 的内部 html。这是我在第 1 页上的内容：

```
<script type="text/javascript">
    jQuery(document).ready(function(){

        jQuery.getScript('/includes/showmehow_videolist.php?sort=recent&type=desc', function(output){
            jQuery("#apple").html(output);
        });

    });
</script>

<div id="apple">content will populate here</div> 
```

在“showmehow_videolist.php”上，我有一个 php while 循环，它编写了一个 jQuery 函数列表和一些 html。代码看起来像这样：

```
<script type="text/javascript">
jQuery(document).ready(function(){

<?PHP
$result4 = mysql_query("SELECT * FROM videos")or die(mysql_error());
while($row4 = mysql_fetch_array($result4)){
?>

        jQuery("#video_<?=$row4['vid_id']?>").fancybox({
            'width'             : <?=$new_width_parsed?>,
            'height'            : <?=$new_height_parsed?>,
            'autoScale'         : false,
            'transitionIn'      : 'elastic',
            'transitionOut'     : 'none',
            'type'              : 'iframe',
            'scrolling'         : 'no',
            'overlayColor'      : '#000',
            'overlayOpacity'    : 0.6
        });

    <?
    }//end while 
    ?>
}); //end document.ready function 

</script>

<div>some content</div> 
```

当我从第 2 页中删除 javascript 部分时，我在 FF 中得到一个不同的错误：

```
Error: SyntaxError: XML can't be the whole program
Source File: http://localhost/resources/adagiotips.php
Line: 1136, Column: 6
Source Code:
</div> 
```

有任何想法吗？问题是因为我正在用javascript填充div的innerhtml ...来自javascript吗？就像我说的，一切正常，只是了解浏览器为什么告诉我有错误。

任何帮助将不胜感激，谢谢。

/includes/showmehow_videolist.php 的输出：

```
<script type="text/javascript">
jQuery(document).ready(function(){

        jQuery("#video_82").fancybox({
            'width'             : 782,
            'height'            : 720,
            'autoScale'         : false,
            'transitionIn'      : 'elastic',
            'transitionOut'     : 'none',
            'type'              : 'iframe',
            'scrolling'         : 'no',
            'overlayColor'      : '#000',
            'overlayOpacity'    : 0.6
        });

        jQuery("#video_83").fancybox({
            'width'             : 782,
            'height'            : 720,
            'autoScale'         : false,
            'transitionIn'      : 'elastic',
            'transitionOut'     : 'none',
            'type'              : 'iframe',
            'scrolling'         : 'no',
            'overlayColor'      : '#000',
            'overlayOpacity'    : 0.6
        });

        jQuery("#video_84").fancybox({
            'width'             : 782,
            'height'            : 720,
            'autoScale'         : false,
            'transitionIn'      : 'elastic',
            'transitionOut'     : 'none',
            'type'              : 'iframe',
            'scrolling'         : 'no',
            'overlayColor'      : '#000',
            'overlayOpacity'    : 0.6
        });

    }); //end document.ready function 

</script>

<div style="overflow-x:hidden; overflow-y: auto; height:350px; width:725px;" id="main_div_of_video_links">

        <div class="tab1">
            <div class="tab2">
                <span class="h2_standard">5</span> <span class="sm">views</span>
            </div>
            <div class="tab3">
                 <img src="/images/icon_video_sm.gif" alt="History - Show Me How Video!" /> <a id="video_181" href="../video_pop.php?id=181" class="newAStyle">Adagio OrderEntry History</a> 

                 <!--<img src="/images/flame_sm.png" />--> <img src="/images/new_icon.png" />       

            </div>
            <div class="tab4">
                <span class="sm"><em>Added: </em>Jul 23 2012</span>
            </div>

            <div style="clear:both"></div>
        </div>

        <div class="tab1">
            <div class="tab2">
                <span class="h2_standard">5</span> <span class="sm">views</span>
            </div>
            <div class="tab3">
                 <img src="/images/icon_video_sm.gif" alt="Alternate Price Lists - Show Me How Video!" /> <a id="video_165" href="../video_pop.php?id=165" class="newAStyle">Adagio Inventory Alternate Price Lists</a> 

                 <!--<img src="/images/flame_sm.png" />--> <img src="/images/new_icon.png" />       

            </div>
            <div class="tab4">
                <span class="sm"><em>Added: </em>Jul 13 2012</span>
            </div>

            <div style="clear:both"></div>
        </div>

        <div class="tab1">
            <div class="tab2">
                <span class="h2_standard">1</span> <span class="sm">views</span>
            </div>
            <div class="tab3">
                 <img src="/images/icon_video_sm.gif" alt="Special Prices - Show Me How Video!" /> <a id="video_166" href="../video_pop.php?id=166" class="newAStyle">Adagio OrderEntry Special Prices</a> 

                 <!--<img src="/images/flame_sm.png" />--> <img src="/images/new_icon.png" />       

            </div>
            <div class="tab4">
                <span class="sm"><em>Added: </em>Jul 13 2012</span>
            </div>

            <div style="clear:both"></div>
        </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T09:27:26.220

我明白了，原来使用 getScript 和 html() 不是要走的路，而是我应该使用 load() 函数：

```
jQuery('#apple').load('/includes/showmehow_videolist.php?sort=recent&type=desc'); 
```

没有错误；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:10:32.690

尝试以下更改：

1.  在第 1 页中，删除行`jQuery("#apple").html(output);`。您不需要将返回的脚本嵌入到 div 中。page2 中的脚本将由 jQuery 解析和运行，无需将其嵌入到 page1 中

首先尝试上述方法，如果仍不能解决问题，请同时执行第二步：

1.  在第 2 页中，删除以下行：

    <script type="text/java script"> jQuery(document).ready(function(){} </script>

这是因为，使用 jQuery.getScript 获取的 JS 已经在 jQuery.ready() fn 的上下文中运行，因此不需要再次将 javascript 包装在 page2 中。 .

# objective-c - 从 UIViewController 导航返回时无法更新 UITableViewController 中的 TableCelView

> ID：11832425
> 
> 赞同：1
> 
> 时间：2012-08-06T16:40:52.017
> 
> 标签：objective-c, ios, ios5, uitableview

我有一个导航视图控制器，它与`UITableViewController`. 在表格视图控制器中，我有静态单元格。我有表格视图单元格的正确标签格式。`UIViewController`单击时我将导航到，`UITableViewCell`然后当我导航回我的 时`UITableViewController`，我想更新我的`UITableViewCell`.

我能够将值从`enter code here`e`UIViewController`传递到`UITableViewcontroller`. 我已经使用`NSLog`. 但我无法更新单元格中的详细信息标签。

我使用过`-(void) tableView:(UITableView *) tableView didDeselectRowAtIndexPath`，但这对我没有帮助，因为只有当我单击另一个表格视图单元格时，表格视图单元格才会更新。我希望此更新在我导航回时自动发生`UITableViewController`

请查看以下链接 [http://www.icodeblog.com/wp-content/uploads/2011/10/navigation_interface.jpeg](http://www.icodeblog.com/wp-content/uploads/2011/10/navigation_interface.jpeg)

我想要类似上图的东西

如何才能做到这一点。

更新代码

```
@interface designTableViewController ()

@end

@implementation designTableViewController
{
    glimmpseliteAppDelegate *appDelegate;
}

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{

    appDelegate = [[UIApplication sharedApplication]delegate];
    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

-(void)viewWillAppear:(BOOL)animated
{

}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    return 8;
}

#pragma mark - Table view delegate

-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(indexPath.row == 1)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designSolvingForViewController"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        tb.detailTextLabel.text = appDelegate.solvingFor;

    }
    if(indexPath.row == 2)
    {
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designTypeIErrorRate"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.typeIError;
    }
    if(indexPath.row == 3)
    {
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designNumberOfGroups"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.numberOfGroups;
    }

    if(indexPath.row == 4)
    {
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designRelativeGroupSize"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.relativeGroupSize;
    }

    if(indexPath.row == 5)
    {
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designSmallestGroupSize"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.smallestGroupSize;
    }

    if(indexPath.row == 6)
    {
        UIViewController *uiViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"designMeansAndVariance"];
        [self.navigationController pushViewController:uiViewController animated:YES];
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.meansAndVariance;
    }
}

- (void) tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(indexPath.row == 1)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        tb.detailTextLabel.text = appDelegate.solvingFor;
    }

    if(indexPath.row == 2)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        //tb.textLabel.text =@"Sample";
        tb.detailTextLabel.text = appDelegate.typeIError;
    }

    if(indexPath.row == 3)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        //tb.textLabel.text =@"Sample";
        tb.detailTextLabel.text = appDelegate.numberOfGroups;
    }

    if(indexPath.row == 4)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        //tb.textLabel.text =@"Sample";
        tb.detailTextLabel.text = appDelegate.relativeGroupSize;
    }

    if(indexPath.row == 5)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        //tb.textLabel.text =@"Sample";
        tb.detailTextLabel.text = appDelegate.smallestGroupSize;
    }

    if(indexPath.row == 6)
    {
        UITableViewCell *tb = [tableView cellForRowAtIndexPath:indexPath];
        //tb.textLabel.text =@"Sample";
        tb.detailTextLabel.text = appDelegate.meansAndVariance;
    }
}

@end 
```

第一个表格单元格只是一个有按钮的单元格。我有一个用于那个按钮的推送 UIViewController。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T16:34:55.883

看来您并不完全了解 UITableView 委托和数据源的实现。一些提示：

* * *

1.  由于您使用的是情节板，因此在选择单元格时将控制拖动从静态表单元格到您希望出现的视图控制器，这将自动创建一个segue（您可能意识到这一点），这样您就不必担心关于实现 didDeselectRowAtIndexPath，您可以将每个静态单元连接到不同的 VC。
2.  你的 UITableViewController 类中可能已经有一个数据源，例如你的 detailLabel(s) 的 NSString 标题数组。在 tableView:CellForRowAtIndex: 你会想要编写类似的代码

cell.detailLabel.text = [dataArray objectAtIndex:indexPath.row];

3) 在更改这些标题的视图控制器中，您希望建立与 UITableViewController 的委托连接，该连接使用新值更新 dataArray。然后在 UITableViewController 类中重写 setDataArray:(NSArray *)array 如下：

> ```
> - (void)setDataArray:(NSArray *)array {
>     _dataArray = array;  
>    [self.tableView reloadData]; 
> ```
> 
> }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:47:56.257

在 viewWillAppear 中：使用 [tableView reloadData]。

```
- (void)viewWillAppear:(BOOL)animated
{
     [tableView reloadData];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T16:48:54.193

首先确保您的模型已更新，以便您`cellForRowAtIndexPath:`返回正确的单元格。

然后使用以下方法之一更新单元格`viewWillAppear`：

```
- (void)reloadData
- (void)reloadRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:46:52.800

您必须使用 tableView:CellForRowAtIndex: 来更新单元格的内容，就像您最初创建单元格一样。当应用程序返回列表时（在另一个视图中更新设置后） tableView:CellForRowAtIndex: 将被自动调用。

更正：tableView:cellForRowAtIndex 不会被自动调用。在你看来WillAppear：放

```
[tableView ReloadData]; 
```

# floating-point - Windows/Intel 和 iOS/Arm 在浮点计算上的差异

> ID：11832428
> 
> 赞同：1
> 
> 时间：2012-08-06T16:41:05.473
> 
> 标签：floating-point, arm, intel

在对[Autodesk TinkerBox](http://tinkerboxnews.com/)的更新中，我在 Windows 上运行的仅限内部开发版本与在我们的最终目标 iOS 上运行的版本之间遇到了意外的浮点计算差异（以下信息基于调试构建在 iPad1 上运行）。

我们使用[Chipmunk](http://chipmunk-physics.net/)来满足我们的物理需求。这绝不可能是这个问题的唯一计算，但它是我正在分析的一个特殊计算：

```
static inline cpFloat
cpvcross(const cpVect &v1, const cpVect &v2)
{
    return v1.x*v2.y - v1.y*v2.x;
} 
```

我正在查看的特定情况`v1`为 (0xC0A7BC40 [-5.241729736328125], 0xC0E84C80 [-7.25933837890625]) 和`v2`(0x428848FB [68.14253997802734], 0x42BCBE40 [94.371582032])。我专注于值的十六进制版本，因为它们是两个平台上输入的确切值，通过检查两个平台上的内存位置来`v1`验证`v2`。作为参考，括号中的浮点值是从将十六进制值放入[此站点](http://babbage.cs.qc.edu/IEEE-754.old/32bit.html)中获取的。

在 Windows 上，结果是 0xBA15F8E8 [-0.0005720988847315311]，在 iOS 上，结果是 0xBA100000 [-0.00054931640625]。当然，差异很小，但当您考虑百分比时，差异并不大，它会随着时间的推移而累积，以显示物理行为的偏差。（请不要建议使用双打。它会减慢游戏速度，当然，不使用双打不是这里的问题。:)）

作为参考，这是两个平台上的调试版本，代码编译为：

```
Windows

static inline cpFloat
cpvcross(const cpVect &v1, const cpVect &v2)
{
01324790  push        ebp  
01324791  mov         ebp,esp 
01324793  sub         esp,0C4h 
01324799  push        ebx  
0132479A  push        esi  
0132479B  push        edi  
0132479C  lea         edi,[ebp-0C4h] 
013247A2  mov         ecx,31h 
013247A7  mov         eax,0CCCCCCCCh 
013247AC  rep stos    dword ptr es:[edi] 
    return v1.x*v2.y - v1.y*v2.x;
013247AE  mov         eax,dword ptr [v1] 
013247B1  fld         dword ptr [eax] 
013247B3  mov         ecx,dword ptr [v2] 
013247B6  fmul        dword ptr [ecx+4] 
013247B9  mov         edx,dword ptr [v1] 
013247BC  fld         dword ptr [edx+4] 
013247BF  mov         eax,dword ptr [v2] 
013247C2  fmul        dword ptr [eax] 
013247C4  fsubp       st(1),st 
013247C6  fstp        dword ptr [ebp-0C4h] 
013247CC  fld         dword ptr [ebp-0C4h] 
}
013247D2  pop         edi  
013247D3  pop         esi  
013247D4  pop         ebx  
013247D5  mov         esp,ebp 
013247D7  pop         ebp  
013247D8  ret              

iOS

invent`cpvcross at cpVect.h:63:
0x94a8:  sub    sp, sp, #8
0x94ac:  str    r0, [sp, #4]
0x94b0:  str    r1, [sp]
0x94b4:  ldr    r0, [sp, #4]
0x94b8:  vldr   s0, [r1]
0x94bc:  vldr   s1, [r1, #4]
0x94c0:  vldr   s2, [r0]
0x94c4:  vldr   s3, [r0, #4]
0x94c8:  vmul.f32 s1, s2, s1
0x94cc:  vmul.f32 s0, s3, s0
0x94d0:  vsub.f32 s0, s1, s0
0x94d4:  vmov   r0, s0
0x94d8:  add    sp, sp, #8
0x94dc:  bx     lr 
```

据我所知，这些计算是相同的，假设每条指令都以相同的方式计算操作数的结果。出于某种原因（Visual Studio 确实允许），Xcode 不允许我逐条指令执行，因此与英特尔 FP 单元相比，我无法缩小哪些指令偏离的范围。

那么，为什么这么简单的计算结果在两个 CPU 之间会如此不同呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:27:31.177

您将看到使用不同浮点精度进行计算的结果。

在 x86 代码中，计算是在扩展精度（80 位）的 FPU 寄存器中完成的，而 NEON 代码使用浮点数（32 位）。显然，乘法和减法期间的额外精度允许 x86 代码保留更多位，而 ARM 代码会丢失它们。

使用[_controlfp](http://msdn.microsoft.com/en-us/library/e9b52ceh%28v=vs.80%29.aspx)函数，您可以告诉 FPU 对所有计算使用特定精度。我使用 MSDN 中的示例编写了一个小程序，并且能够获得与 ARM 代码相同的结果：

```
#include <stdio.h>
typedef float cpFloat;
struct cpVect  {cpFloat x, y;};
struct cpVectI {unsigned int x, y;};
union cpv {cpVectI i; cpVect f;};
union cfi { float f; unsigned int i;};

cpFloat cpvcross(const cpVect &v1, const cpVect &v2)
{
    return v1.x*v2.y - v1.y*v2.x;
}

#include <float.h>
#pragma fenv_access (on)

void main(void)
{
  cpv v1, v2;
  cfi fi;
  v1.i.x = 0xC0A7BC40;
  v1.i.y = 0xC0E84C80;
  v2.i.x = 0x428848FB;
  v2.i.y = 0x42BCBE40;

  unsigned int control_word_x87;

  // Show original x87 control word and do calculation.
  __control87_2(0, 0, &control_word_x87, 0);
  printf( "Original: 0x%.4x\n", control_word_x87 );
  fi.f = cpvcross(v1.f, v2.f);
  printf("Result: %g (0x%08X)\n", fi.f, fi.i);

  // Set precision to 24 bits and recalculate.
  __control87_2(_PC_24, MCW_PC, &control_word_x87, 0);
  printf( "24-bit:   0x%.4x\n", control_word_x87);
  fi.f = cpvcross(v1.f, v2.f);
  printf("Result: %g (0x%08X)\n", fi.f, fi.i);

  // Restore default precision-control bits and recalculate.
  __control87_2( _CW_DEFAULT, MCW_PC, &control_word_x87, 0);
  printf( "Default:  0x%.4x\n", control_word_x87 );
  fi.f = cpvcross(v1.f, v2.f);
  printf("Result: %g (0x%08X)\n", fi.f, fi.i);
} 
```

这是输出：

```
Original: 0x9001f
Result: -0.000572099 (0xBA15F8E8)
24-bit:   0xa001f
Result: -0.000549316 (0xBA100000)
Default:  0x9001f
Result: -0.000572099 (0xBA15F8E8) 
```

使用此函数和调用外部库时要小心；某些代码可能依赖于默认设置，如果您在其背后更改它们，它们将会中断。

另一种选择可能是切换到将使用特定精度的[SSE 内在函数。](http://msdn.microsoft.com/en-us/library/x5c07e2a.aspx)不幸的是，`/arch:SSE2`似乎没有将 SSE2 用于浮点（至少在 VS2010 中）。

# magento - 使用 SSL 的网站的所有浏览器中 https 页面上的内容不安全

> ID：11832429
> 
> 赞同：0
> 
> 时间：2012-08-06T16:41:17.460
> 
> 标签：magento, ssl, https

试图让 SSL 在 Magento 网站的安全页面上工作有点麻烦。

请访问[https://www.showermania.co.uk/checkout/onepage/](https://www.showermania.co.uk/checkout/onepage/)

浏览器会提醒访问者注意页面上的不安全内容，随后绿色条没有显示为认证应有的内容。

如果您使用[http://www.whynopadlock.com](http://www.whynopadlock.com)检查该页面，它会提供各种信息，但查看源代码会显示通过 https 获取的所有内容。

我真的不确定要安全加载页面上的所有内容需要什么（似乎已经如此）。

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:46:09.377

相关的证书不是在安全的证书链中创建的。

例如，您要求威瑞信或您选择购买证书的任何人，他们有两个或三个数字签名以证明证书有效，然后证书本身说明您的网站托管在那里，如果您有专业版，您的公司正在运行该站点。

如果是您自己创建的，则意味着您关闭的证书颁发机构不在浏览器的可信来源列表中。如果其他人为您创建了它，那么您可能缺少该过程中的一些步骤，因为您需要安装一些额外的证书才能正确验证认证链。检查他们的指示。

编辑：检查 comodo，找到一些有关安装的信息，您应该根据您购买的版本检查这些信息。检查[如何安装以及有关](https://support.comodo.com/index.php?_m=knowledgebase&_a=view&parentcategoryid=95&pcid=1&nav=0,96,1&key5sk1=11b7b3309f676bf952f1e24f7d4eb34ba81cc98a&key5sk2=2128&key5sk3=1344271817000&key5sk4=2128&key5sk5=1344271837000&key5sk6=1904&key5sk7=1344271872000&key6sk1=&key6sk2=FF110&key6sk3=7&key6sk4=es-es&key6sk5=CO&key6sk6=0&key6sk7=Google&key6sk9=1366768&key6sk10=false&key6sk11=0f02e414c577aabd7f399b1fb513bc31e2e5bc1b&key6sk12=2032&key7sk1=2&key7sk2=196112&key1sk1=ors&key1sk2=Google)[根证书和中间证书](https://support.comodo.com/index.php?_m=knowledgebase&_a=viewarticle&kbarticleid=1182)的指示。

# php - $this->request->is('post') 在表单提交时返回 FALSE

> ID：11832430
> 
> 赞同：1
> 
> 时间：2012-08-06T16:41:17.580
> 
> 标签：php, cakephp, request

该模型

```
class CompanyCategory extends AppModel
{
    public $name = "CompanyCategory";

    public $hasMany = array(
        "Company"
    );
} 
```

控制器

```
public function admin_edit($id = null){

            //debug($this->request);
            //exit(0);
            if($id == null){
                $this->Session->setFlash("ID categorie eronat!", "flash/simpla_error");
                $this->redirect("index");
            }
            if($this->request->is('post')){
                if($this->CompanyCategory->save($this->request->data)){
                    $this->Session->setFlash("Categoria a fost salvata!", "flash/simpla_success");
                }
                else{
                    $this->Session->setFlash("Categoria NU a fost salvata!", "flash/simpla_error");
                }
            }
            else{
                $this->Session->setFlash("READ!", "flash/simpla_error");
                $this->request->data = $this->CompanyCategory->read(null, $id);
            }
        } 
```

风景

```
<div class="content-box">
    <div class="content-box-header">
        <h3>Editeaza categorie firme</h3>
    </div>
    <div class="content-box-content">
        <?php
            echo $this->Form->create("CompanyCategory", array(
                'inputDefaults' => array(
                    'error' => array(
                        'attributes' => array(
                            'wrap' => 'span', 
                            'class' => 'input-notification error png_bg'
                        )                   
                    )
                )
            ));
        ?>

        <?=$this->Form->input('id', array('type' => 'hidden'))?>

        <?=$this->Form->input('title', array('class' => "text-input small-input", 'label' => 'Denumire'))?>

        <?=$this->Form->submit('Salveaza', array('class' => "button"))?>
    </div>
</div> 
```

我的问题是提交表单时，控制器为 request->is('false'); 返回 false；

如果我在视图中明确设置 create 方法中的表单助手类型为“post”，它会按预期工作。

当表单方法已经发布而没有设置它时，这有点令人沮丧。

难道我做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:58:06.733

使用这个控制器

```
public function admin_edit($id = null) {
        $this->layout = 'admin_layout';
        $this->CompanyCategory->id = $id;
        if (!$this->CompanyCategory->exists()) {
            throw new NotFoundException(__('Invalid CompanyCategory model'));
        }
        if ($this->request->is('post') || $this->request->is('put')) {
            if ($this->CompanyCategory->save($this->request->data)) {
                $this->Session->setFlash(__('The CompanyCategory model has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The CompanyCategory model could not be saved. Please, try again.'));
            }
        } else {
            $this->request->data = $this->CompanyCategory->read(null, $id);
        }

    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T16:51:07.333

我不确定您为此使用的是什么框架，但我的猜测是在 $this->Form->create() 的视图中

应该有一个选项供您将表单操作类型设置为发布。

如果您查看 PHP 代码生成表单的 html，它是否创建了 ? 我的猜测是它可能默认执行 GET 。

# css - 将 -moz-radial-gradient 转换为所有其他支持的浏览器

> ID：11832437
> 
> 赞同：-3
> 
> 时间：2012-08-06T16:42:05.493
> 
> 标签：css, wordpress, firefox, gradient

```
.gradient {
background: -moz-radial-gradient(right bottom , circle farthest-corner, #CDCFD1 20%,     #696C71 70%) repeat scroll 0 0 transparent; 
```

我想采用该规则并将其应用于所有支持线性渐变的浏览器。有人可以告诉我为了在所有其他支持它的浏览器中支持上述径向渐变，代码会是什么样子，即 chrome、internet explorer、safari 等。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:48:21.413

您不能在一行代码中使渐变与所有浏览器兼容..您必须为不同的浏览器添加更多兼容的行..试试这个..

```
background: rgb(105,108,113); /* Old browsers */
background: -moz-linear-gradient(left,  rgba(105,108,113,1) 30%, rgba(205,207,209,1) 81%, rgba(205,207,209,1) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right top, color-stop(30%,rgba(105,108,113,1)), color-stop(81%,rgba(205,207,209,1)), color-stop(100%,rgba(205,207,209,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(left,  rgba(105,108,113,1) 30%,rgba(205,207,209,1) 81%,rgba(205,207,209,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(left,  rgba(105,108,113,1) 30%,rgba(205,207,209,1) 81%,rgba(205,207,209,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(left,  rgba(105,108,113,1) 30%,rgba(205,207,209,1) 81%,rgba(205,207,209,1) 100%); /* IE10+ */
background: linear-gradient(to right,  rgba(105,108,113,1) 30%,rgba(205,207,209,1) 81%,rgba(205,207,209,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#696c71', endColorstr='#cdcfd1',GradientType=1 ); /* IE6-9 */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:44:56.777

看看这个：[http ://css3please.com/](http://css3please.com/)

这也可能有帮助：http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:49:01.950

使用[http://gradients.glrzad.com/](http://gradients.glrzad.com/)或[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)支持所有浏览器。

# html - 如何组织一个大的 html 文件？

> ID：11832444
> 
> 赞同：1
> 
> 时间：2012-08-06T16:43:04.917
> 
> 标签：html, jsp

我已经从一个 JSP 文件中提取了大约 3500 行 JS 和 CSS 代码。

我目前正在清理一个包含超过 1500 行代码的大型 html 文件，以便我可以对功能进行一些增强。如何进一步分解此文件以使其易于管理并使网页的结构在 jsp 文件中可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:52:14.967

使用您正在使用的任何 IDE 的“源代码格式化”功能。几乎所有的 IDE 都有这个功能。它将为您提供结构，因为它根据元素的嵌套程度缩进源代码。你提到你有 1500 行代码。我猜你有很多样式是为每个元素内联定义的。在 css 文件中创建新类并将它们分配给元素以将样式与页面结构分开。在浏览器中启动页面，并使用 firebug 或 chromes 开发工具“分块”出主要结构，如导航、版权信息、联系通知、等等。如果您使用任何后端技术（如 jsp），请将您网站常用元素的 HTML 保存为单独的文件。例如，您的导航部分可能会保存为导航。

```
<?(some jsp tag to include that file here because I do not know jsp);
 ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:59:39.847

i use my tags as controls and templates, for example:

**masterPage.tag** file - general site template

```
<%@ tag description="page template" pageEncoding="utf-8" %>    
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />

        <title>${title} | ${app.servName}</title>

        <link href="${app.staticUrl}/css/general.css${v}"     rel="stylesheet"     type="text/css" />
    </head>
    <body>  
        <jsp:doBody />
    </body>
</html> 
```

**comments.jsp** - page with comments list(used masterPage.tag as template and commentsList.tag as controls)

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>

<%@ taglib prefix="c"  uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="utd" tagdir="/WEB-INF/tags/templates/default" %>
<%@ taglib prefix="uc" tagdir="/WEB-INF/tags/controls/" %>

<utd:masterPage>
    <div class="post-comments">
        <uc:commentsList comments="${post.comments}" />
    </div>
</utd:masterPage> 
```

`<jsp:doBody>` will be replaced in master page with content in `<utd:masterPage>`

**commentsList.tag** - control, rendering comments, used in several places

```
<%@ tag description="render comments" pageEncoding="utf-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<%@ attribute name="comments" required="true" type="java.util.List" description="comments list" %>

<c:if test="${not empty comments}">
    <ul class="comments">
        <c:forEach items="${comments}" var="comment" varStatus="i">
            <li>
                <div class="comments-text">
                    ${comment.friendlyCreateDate} 
                    <p>
                        ${comment.text}
                    </p>
                </div>
            </li>
        </c:forEach>
    </ul>
</c:if> 
```

*   i try logic html block make in control, this control may be used in other page
*   controls may in itself have other controls

# visual-studio - Intellisense 不允许在元素的类属性中添加多个 css 类

> ID：11832445
> 
> 赞同：1
> 
> 时间：2012-08-06T16:43:07.757
> 
> 标签：visual-studio, intellisense, visual-studio-2012

我刚刚在我的 Windows 7 x64 位系统上安装了 Visual Studio 2012 RC Ultimate。

我在一个 CSS 文件中有几个 CSS 类并正确引用了它。现在看看我在做什么

我在我的 a`div`元素中添加了一个类，例如

```
<div class="page"> 
```

当我将光标`page`放在`">`. 然后我按下空格按钮，智能感知打开，但它只包含我已经包含的项目，它是`page`.

我必须通过键入来完全写出所有其他类的名称。请告诉我您是否面临同样的问题。如果没有，那么有人请告诉我如何解决这个问题。

### 稍后添加

[在这里](http://connect.microsoft.com/VisualStudio/feedback/details/760316/intellinsense-do-not-work-for-adding-multiple-css-classes)，我在 Microsoft Connect 中报告了这个[BUG 。](http://connect.microsoft.com/VisualStudio/feedback/details/760316/intellinsense-do-not-work-for-adding-multiple-css-classes)
我刚刚安装了 VS 2012 Update 2，希望能修复这个问题，**现在它已经修复了。没有这样的问题了。**感谢 Microsoft 考虑我的错误报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T23:32:38.523

这是VS2012的一个已知问题。Microsoft 已意识到这一点并正在修复（[BUG 760316：Intellinsense 不适用于添加多个类](http://connect.microsoft.com/VisualStudio/feedback/details/760316/intellinsense-do-not-work-for-adding-multiple-css-classes)）

你仍然可以添加多个类，你只需要输入它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T06:46:07.820

此[问题](http://connect.microsoft.com/VisualStudio/feedback/details/760316/intellinsense-do-not-work-for-adding-multiple-css-classes)现已通过[Visual Studio 2012 Update 2修复](http://support.microsoft.com/kb/2797912)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-25T23:26:28.390

不要单独键入空格键，而是键入 Ctrl+空格键。它会告诉你所有的课程。

当您仅键入空格键时，它将显示以 page 开头的类。做以下。转到 css 文件。复制 .page 类并立即粘贴到下面并将其重命名为 page1。回到您的复制步骤，您现在将参加 2 节智能感知课程。一个“page”和另一个“page1”。

# matlab - OpenCV 和潜在 SVM 检测器

> ID：11832447
> 
> 赞同：5
> 
> 时间：2012-08-06T16:43:19.130
> 
> 标签：matlab, opencv, classification, pattern-recognition

我想知道是否有人成功地使用了潜在 SVM 检测器的 OpenCV 实现（[http://docs.opencv.org/modules/objdetect/doc/latent_svm.html](http://docs.opencv.org/modules/objdetect/doc/latent_svm.html)）。有一个示例代码展示了如何使用该库，但问题是示例代码使用了使用 MatLab 生成的现成检测器模型。有人可以指导我完成如何生成自己的检测器模型的步骤吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T18:14:16.020

[本文作者对LatSVM](http://people.cs.uchicago.edu/~rbg/latent/voc-release5.tgz)的 MATLAB 实现有一个名为`pascal`. 有一个带有 tarball 的 README 解释了它的用法：

```
使用学习代码
========================

1\. 下载并安装 2006-2011 PASCAL VOC 开发包和数据集。
   （你应该在 VOCinit.m 中设置 VOCopts.testset='test'）
2\. 根据你的配置修改'voc_config.m'。
3.启动matlab。
4\. 运行'compile'函数来编译辅助函数。
   （您可能需要编辑 compile.m 以使用不同的卷积
    例程取决于您的系统）
5\. 使用“pascal”脚本来训练和评估模型。

例子：
>> 帕斯卡 ('自行车', 3); % 训练和评估一个 6 组件的自行车模型

学习代码将多个中间模型保存在模型缓存中
'voc_config.m' 中定义的目录。

```

如需更多信息，请访问[作者网站](http://people.cs.uchicago.edu/~rbg/latent/)。该页面还包含此方法的论文。

# c++ - 在 G++ 中使用 -frepo 选项

> ID：11832450
> 
> 赞同：4
> 
> 时间：2012-08-06T16:43:36.480
> 
> 标签：c++, templates, g++

我的工作是为一些没有虚拟内存的绝对古老的硬件开发代码。正因为如此，我们试图尽量减少对象和二进制文件的文本大小，所以我们不会耗尽内存。这可能意味着我们需要限制使用来自 STL 的模板，或者彻底禁止它们。在四处寻找一种最小化文件大小并仍然使用模板的方法时，我遇到了`-frepo`g++ 的选项。几次测试之后，我比开始时更加困惑。当使用 -frepo 时，最终的二进制文件大小相同或更大，这对我来说没有意义。谁能向我解释这个选项实际上做了什么（除了“它只是工作”，因为这是 GCC 4.7.1 手册中的解释）以及我可能如何滥用它？

正在编译`g++ -c -frepo main.cpp test8.cpp`和链接`g++ test8.o main.o` .rpo 文件正在创建中。

测试8.h：

```
#include <list>
using namespace std;

class Test
{
  public:
    Test ();
    list<int> makeNewIntList ();
  private:
  list<int> intList;
}; 
```

测试8.cpp：

```
#include "test8.h"
#include <list>

using namespace std;

Test::Test()
{
  intList = list<int>( 10, 12 );
}

list<int> Test::makeNewIntList()
{
  intList.push_back(4);
  return intList;
} 
```

主文件

```
#include "test8.h"

using namespace std;

void findFive (int num);
list<int> makeIntList();

int main( int argc, char* argv[])
{
  Test test;
  list<int> intList = test.makeNewIntList();
  list<int> intList2 = makeIntList();
  list<float> floatList = list<float> (10,12);
  floatList.push_back(5);
}

list<int> makeIntList()
{
  list<int> intList = list<int> (10,12);
  return intList;
} 
```

我们正在使用 GCC 4.1.2。另请注意，GCC 4.7.0 也好不到哪里去，升级编译器不是一个可行的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:55:20.227

我建议你忘记`-frepo`它，它是一个遗物，很少使用。

相反，您可以查看`extern template`声明显式实例化的语法，以防止模板被隐式实例化，从而允许您控制实例化，使它们只发生在一个地方。为了确保你不会错过任何你也可以编译的东西`-fno-implicit-templates`（如果你严格要求在`extern template`任何必要的地方使用声明，这不是必需的。）

# javascript - 显示/隐藏 div onchange 下拉菜单

> ID：11832456
> 
> 赞同：0
> 
> 时间：2012-08-06T16:44:11.047
> 
> 标签：javascript, jquery, ruby-on-rails, haml

我有一个使用haml的表单中的下拉菜单代码

```
= f.select :contact_type, options_for_select(['String','Email','Phone','Textarea','Boolean', 'Multi Select'],
 selected: @contact_object.contact_type), onchange: "showDiv(this, @i)"
- if @contact_object.contact_type == 'Boolean'
  %div{:id=>"options_for_boolean_#{@i}"}
    %li
      =f.label :first_boolean_option do
        Field
        %span{:class => "item-number"}
          =@i
        First opt.
      =f.text_field :first_boolean_option, :placeholder => "Enter First option:"
    %li
      =f.label :second_boolean_option do
        Field
        %span{:class => "item-number"}
          =@i
        First opt.
      =f.text_field :second_boolean_option, :placeholder => "Enter Second option:"
- if @contact_object.contact_type == 'Multi Select'    
  %div{:id=>"options_for_multiselect_#{@i}"}
    %li
      =f.label :multiselect_options do
        Field
        %span{:class => "item-number"}
          =@i
        Multiselect opt.
      =f.text_area :multiselect_options, :placeholder => "Enter all options separated with comma:" 
```

这里@i 是迭代器值。我在这里要做的是，上面的代码在循环中。每个循环都有一个带有选定值的下拉菜单。当用户选择布尔或多选选项时，它将向他显示相应的 div 以获取更多详细信息。因此，如果用户选择第二个下拉框的布尔选项，它应该在第二个迭代层中显示布尔值的 div。使困惑？这是更简单的解释

```
drop-down-box1
  div1 for boolean
  div1 for multi select

drop-down-box2
  div2 for boolean
  div2 for multi select

drop-down-box3
  div3 for boolean
  div3 for multi select 
```

*默认隐藏所有 div。如果用户选择“drop-down-box2”的“boolean”，它应该显示“div2 for boolean”怎么做？

到目前为止，我的 jQuery 代码是

```
:javascript
$(document).ready(function() {
  function showDiv(changing,numb) {
    var sel_val = changing.options[changing.selectedIndex].val();
    if (sel_val == 'Boolean') {
      $('#options_for_boolean_' + numb).show();
    } else if (sel_val == 'Multi Select') {
        $('#options_for_multiselect_' + numb).show();
    } else {
        $('#options_for_boolean_' + numb ).hide();
        $('#options_for_multiselect_'+ numb).hide();
    } 
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:25:54.180

实际上问题出在 select 标签的 haml 代码中，**onchange 事件未正确触发**。我们可以将此问题称为“ **onchange html 选项未出现在浏览器中**”。

下面这个概念对我帮助很大。

:onchange 是一个 html_option。这是选择的语法：

**

> 选择（对象，方法，选择，选项={}，html_options={}）

**

所以在我的情况下：

```
= f.select :contact_type, options_for_select(['String','Email','Phone','Textarea','Boolean', 'Multi Select'], selected: @contact_object.contact_type),{},
  :onchange => "showDiv(#{@i});" 
```

注意那里的空哈希代表选项。此外，我将我的 javascript 代码更改为下面的

```
:javascript
$(document).ready(function() {
  function showDiv(numb) {
    var sel_val = $('#userservicepage_contactsettings_attributes_' + numb + '_contact_type').val();
    if (sel_val == "Boolean") {
      $('#options_for_boolean_' + numb).show();
    } else if (sel_val == "Multi Select") {
      $('#options_for_multiselect_' + numb).show();
    } else {
      $('#options_for_boolean_' + numb ).hide();
      $('#options_for_multiselect_'+ numb).hide();
    }
  }
}); 
```

结果，整个事情变得充满活力。

# jquery - GMaps.js：通过地理编码设置的两个标记之间的跟踪路线

> ID：11832458
> 
> 赞同：3
> 
> 时间：2012-08-06T16:44:15.357
> 
> 标签：jquery, google-maps, google-maps-api-3, geocode

我正在使用这个：[http ://hpneo.github.com/gmaps/examples.html](http://hpneo.github.com/gmaps/examples.html)

我有两个输入，我在其中放置了一个地址，我想追踪两点之间的路线。我可以添加两个标记，但我不知道如何绘制路线。

关于如何做到这一点的任何想法？

谢谢！

这是我的代码...

```
 GMaps.geocode({
      address: address_from,
      callback: function(results, status) {
        if (status == 'OK') {
          var address_from = results[0].geometry.location;
          map.addMarker({
            lat: address_from.lat(),
            lng: address_from.lng()
          });
        }
      }       
    });

    GMaps.geocode({
      address: address_to,
      callback: function(results, status) {
        if (status == 'OK') {
          var address_to = results[0].geometry.location;
          map.addMarker({
            lat: address_to.lat(),
            lng: address_to.lng()
          });
        }
      }
    });

    map.drawRoute({
      origin: [address_from.lat(), address_from.lng()],
      destination: [address_to.lat(), address_to.lng()],
      travelMode: 'driving',
      strokeColor: '#131540',
      strokeOpacity: 0.6,
      strokeWeight: 6
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:52:16.293

这个[类似问题的](https://stackoverflow.com/questions/11743799/clickable-driving-direction-on-google-maps-v3)[示例](http://www.geocodezip.com/inventoresdegaragem_com_dbteste_indexA.html)通过单击获取放置在地图上的两个标记之间的方向（直接使用 Google Maps API v3）。

# iphone - NSXMLParser 遇到特殊字符后停止解析

> ID：11832460
> 
> 赞同：2
> 
> 时间：2012-08-06T16:44:26.890
> 
> 标签：iphone, ios, xml, xcode, xcode4

我正在从谷歌天气 api 读取 XML 文件并使用 NSXMLParser 解析它。有问题的城市是巴黎。这是我得到的一个简短的 xml 输出

```
 <?xml version="1.0"?>
    <xml_api_reply version="1">
    <weather module_id="0" tab_id="0" mobile_row="0" mobile_zipped="1" row="0" section="0" ><forecast_information>
    <city data="Paris, Île-de-France"/>
    <postal_code data="Paris"/>
    <latitude_e6 data=""/>
    <longitude_e6 data=""/> 
...
... 
```

现在我用来解析这个xml的代码是

```
NSString *address = @"http://www.google.com/ig/api?weather=Paris";
    NSURL *URL = [NSURL URLWithString:address];

NSXMLParser *parser = [[NSXMLParser alloc] initWithContentsOfURL:URL];
    [parser setDelegate:self];
    [parser parse];
...

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict 
{

    NSLog(@"XML Parser 1 ... elementName ... %@", elementName);

} 
```

这是我为上述 xml 获得的输出

```
XML Parser 1 ... elementName ... xml_api_reply
XML Parser 1 ... elementName ... weather
XML Parser 1 ... elementName ... forecast_information 
```

问题是它解析所有标签直到它到达“城市数据”，因为名称 Paris, Île-de-France 中有一个非 ascii 字符，然后它就停止了。之后它不会像 postal_code 那样处理标签。纬度、经度等

所以我的问题是，有没有办法可以从返回的 URL XML 字符串中删除所有非 ascii 字符？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-01T18:25:30.920

我知道会发生什么，我只是遇到了同样的问题......

`foundCharacters`在解析器中查看您的方法...

我有这样的事情：

```
if (!currentElementValue) {
   currentElementValue = [[NSMutableString alloc] initWithString:string];
} 
```

当特殊字符发生时`currentElementValue`就停止了。

现在我的工作代码是：

```
if (!currentElementValue) {
    currentElementValue = [[NSMutableString alloc] initWithString:string];
} else {
    [currentElementValue appendString:string];
} 
```

请记住在方法结束时设置`currentElementValue`为`nil``didEndElement`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:53:47.567

行。我已经解决了这个问题。这就是我让它工作的方式。

首先我要做的是从带有特殊字符的 URL 中获取 XML。然后我从 XML 字符串中删除所有特殊字符。然后我将字符串转换为 NSdata，然后将该 nsdata 对象传递给我的 NSXMLParser。因为它没有更多的特殊字符 NSXMLParser 很高兴。

这是将来可能遇到的任何人的代码。非常感谢所有为这篇文章做出贡献的人！

```
NSString *address = @"http://www.google.com/ig/api?weather=Paris";
    NSURL *URL = [NSURL URLWithString:address];
    NSError *error;    
    NSString *XML = [NSString stringWithContentsOfURL:URL encoding:NSASCIIStringEncoding error:&error];

    //REMOVE ALL NON-ASCII CHARACTERS
         NSMutableString *asciiCharacters = [NSMutableString string];
         for (NSInteger i = 32; i < 127; i++)  
         {
         [asciiCharacters appendFormat:@"%c", i];
         }

         NSCharacterSet *nonAsciiCharacterSet = [[NSCharacterSet characterSetWithCharactersInString:asciiCharacters] invertedSet];

         XML = [[XML componentsSeparatedByCharactersInSet:nonAsciiCharacterSet] componentsJoinedByString:@""];

    NSData *data = [XML dataUsingEncoding:NSUTF8StringEncoding];
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
    [parser setDelegate:self];
    [parser parse]; 
```

**编辑：**

NSXMLParser 是一个可怕的工具。我已在所有应用程序中成功使用 RaptureXML。它超级易于使用，并且避免了所有这些无意义的非 ascii 字符。[https://github.com/ZaBlanc/RaptureXML](https://github.com/ZaBlanc/RaptureXML)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:11:58.933

您遇到的问题是 Google 的响应使用的编码与您期望的 ASCII 或 UTF8 不同。使用方便的命令行工具`curl`，很容易看出：

```
$ curl -I http://www.google.com/ig/api?weather=Paris
HTTP/1.1 200 OK
X-Frame-Options: SAMEORIGIN
Content-Type: text/xml; charset=ISO-8859-1
... 
```

如果您查找 ISO-8859-1，您会发现它也被称为 Latin-1 字符集。内置编码选项之一是`NSISOLatin1StringEncoding`，因此请执行以下操作：

```
NSString *XML = [NSString stringWithContentsOfURL:URL encoding:NSISOLatin1StringEncoding error:&error]; 
```

使用正确的编码将使 NSString 能够弄清楚如何解释字符，并且您将获得可用的数据。或者，您可以修改您的请求以指定您希望 Google 提供的字符编码。这可能更可取，这样您就不必尝试将您使用的编码与特定请求相匹配。

**编辑：**到目前为止，我的答案集中在将响应作为可读字符串获取。不过，我看到您的真正问题涉及使用 NSXMLParser 进行解析。我认为您在这里至少有两个选择：

*   **修改**您收到的 XML 以包含字符编码。您返回的 XML 是 Latin-1 编码的，但 XML 标记只显示：`<?xml version="1.0"?>`。您可以将其修改为：`<?xml version="1.0" encoding="ISO-8859-1"?>`. 我不知道这是否会解决 NSXMLParser 的问题，但它可能会。

*   如上所述，向Google**请求您想要的字符集。**向请求添加`Accept-Charset`标头应该可以解决问题，尽管这会使检索数据变得更加复杂。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-06T16:52:49.953

坚持使用 ISO-8859-1，因此您不需要“删除特殊字符”。使用不同的机制来获取 http 数据。

使用 NSURLConnection，从长远来看，它更加灵活和异步。

```
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:url]
                                            cachePolicy:NSURLRequestUseProtocolCachePolicy
                                        timeoutInterval:15.0];

 NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (theConnection) {
        // Create the NSMutableData to hold the received data.
        // receivedData is an instance variable declared elsewhere.
        receivedData = [[NSMutableData data] init];
        return YES;
    } else {
        // Inform the user that the connection failed.
        return NO;
    }
}

#pragma mark - Url connection data delegate

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    receivedData = nil;
    [self badLoad];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    //inform delegate of completion
    [self.delegate fetchedData:receivedData];

    receivedData = nil;
} 
```

# python - 属性 %s 是必需的

> ID：11832468
> 
> 赞同：0
> 
> 时间：2012-08-06T16:45:13.540
> 
> 标签：python, google-app-engine

我正在使用 GAE 和 python 2.7 编写一个简单的程序，但是在将数据存储到 db 时遇到了一些问题。我的代码如下：

```
class MemberInfo(db.Model):
    firstName = db.StringProperty(required=True)

class RegisterPageButtonDown(webapp2.RequestHandler):
    def post(self):
        memberInfo = MemberInfo()       
        memberInfo.firstName = self.request.get('firstName')
        memberInfo.put() 
```

“ **memberInfo = MemberInfo()** ”中出现错误，它说“**需要属性 firstName** ”。我确定我将数据以 html 形式放置，并且该方法也是 post。

我被这个问题困扰了一晚上，谢谢你的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:54:19.527

您已将该`firstName`属性设置为必需，因此当您实例化一个对象时，您必须为该属性提供一个值，例如：

```
memberInfo = MemberInfo(firstName = self.request.get('firstName')) 
```

或者，您可以`firstName`在模型中设置为不需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T16:54:30.343

错误来自函数的第一行，甚至在您从请求中获取值之前。这是因为您需要在实例化对象时传入该值。

```
firstName = self.request.get('firstName')
memberInfo = MemberInfo(firstName=firstName) 
```

（另请注意，Python 的正常命名约定意味着变量和属性是`lower_case_with_underscore`，而不是`camelCase`。）

# javascript - 无法重载 Ajax.BeginForm 的提交方法

> ID：11832470
> 
> 赞同：0
> 
> 时间：2012-08-06T16:45:16.363
> 
> 标签：javascript, jquery, ajax, asp.net-mvc-3, razor

我正在尝试从我的剃刀视图提交一个 ajax 表单，并且我希望控制器返回一个 JSON 对象。当我使用 ("#form0").submit(alert("hi");); 数据进入控制器，我收到警报。但是，当我使用 ("#form0").submit(function(){alert("hi");}); 数据没有通过，我也没有收到警报。我觉得这对我缺少的语法来说是次要的。以下是相关代码：

jQuery：

```
$(function () {
//setting up the schedule modal dialoag.
$("#schedModal").dialog({
    buttons: {
        Submit:
                function () {
                    $("#form0").ajaxSubmit(function () {
                        //this is where I want to put the magic, but I need the alert to fire first.
                        alert("hi");
                        return false;
                    });
                },
        Cancel:
                function () {
                    $(this).dialog("close");
                }
    },
    autoOpen: false,
    minHeight: 350,
    modal: true,
    resizable: false
}); 
```

目标视图：

```
@model FSDS.DataModels.Schedule

@using (Ajax.BeginForm("scheduleNew", null, new AjaxOptions { UpdateTargetId = "partial" }, new {}))
{
@Html.ValidationSummary(true)

    <div class="editor-label">
        @Html.LabelFor(model => model.ScheduleName)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.ScheduleName)
        @Html.ValidationMessageFor(model => model.ScheduleName)
    </div>

    @* tons of other labels and editor fields go in here, omitted for brevity. *@
} 
```

控制器，如果这很重要：

```
 [HttpPost]
    public ActionResult scheduleNew(Schedule schedule)
    {
        if (Request.HttpMethod == "POST")
        {
            FSDSDBEntities context = new FSDSDBEntities();

            if (ModelState.IsValid)
            {
                context.Schedules.AddObject(schedule);
                context.SaveChanges();
            }

            return Json(schedule);
        }
        else
        {
            return PartialView();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:54:39.130

只需使用`$('#form0').submit();`：

```
Submit: function () {
    $('#form0').submit();
} 
```

然后在 AjaxForm 中定义一个`OnSuccess`处理程序，当 AJAX 请求成功时将调用该处理程序：

```
@using (Ajax.BeginForm("scheduleNew", null, new AjaxOptions { OnSuccess = "success", UpdateTargetId = "partial" }, new {})) 
```

最后`success`是javascript处理程序：

```
function success(data) {
    // the form was successfully submitted using an AJAX call.
    // here you could test whether the data parameter
    // represents a JSON object or a partial view
    if (data.ScheduleName) {
        // the controller action returned the schedule JSON object
        // => act accordingly
    } else {
        // the controller action returned a partial view
        // => act accordingly
    }
} 
```

# ios - iOS 应用测试静态库初始化

> ID：11832473
> 
> 赞同：1
> 
> 时间：2012-08-06T16:45:26.307
> 
> 标签：ios, unit-testing, xcode4, ocunit, sentestingkit

我正在尝试为具有旧版 C++ 库依赖项的 iOS 应用程序编写测试。遗留库具有每个应用程序周期必须运行/设置一次的初始化例程和静态变量。

我创建了一个正常工作的测试目标。我的测试目标设置为通过 Bundle Loader 将我的应用程序用作测试主机。这将启动 iOS 应用程序，然后使用 [SenTestCase 调用测试] 运行测试。鉴于此设置，我希望让应用程序初始化库并让测试在“库已初始化”状态下运行。这似乎符合 Apple Application Test 范式。但是，在运行测试时，在应用启动期间初始化的旧库的静态变量为 NULL。没有可以重置变量的用户代码。

我希望我的应用程序测试能够访问我的应用程序的静态变量。我可以配置一些东西来允许这样做吗？我错过了什么吗？

* * *

为了澄清，麻烦的静态变量在链接的 c++ 库中。应用程序和单元测试似乎没有共享相同的应用程序范围。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T06:51:09.393

我有一个类似的问题，但使用的是 Obj-C 静态库。单例创建了两次（一次在应用程序中，一次在测试包中）。它们的指针也在静态内存中。

问题是我将库链接到测试包目标。

我通过从“Link Binary With Libraries”列表中删除该库来修复它。然后我还需要更改静态库的构建设置：我必须将“默认隐藏的符号”设置为 NO。

# android - 读取 NFC 时遇到问题 - Android

> ID：11832482
> 
> 赞同：0
> 
> 时间：2012-08-06T16:46:10.367
> 
> 标签：android, nfc, ndef

我正在尝试做一个简单的应用程序，它使用 URL 读取标签 NFC 并将 URL 写入 TextView。我试图运行它但没有用。有人可以帮我吗？代码如下，AndroidManifest 也是！我希望你能帮助我。

/ ***** *******主类****** ** *** ***** /

```
public class MainActivity extends Activity {
    private TextView mCardView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // ImageView that we'll use to display cards
        mCardView = (TextView) findViewById(R.id.result);

        Parcelable[] rawMsgs = getIntent().getParcelableArrayExtra(
                NfcAdapter.EXTRA_NDEF_MESSAGES);
        NdefMessage msg = (NdefMessage) rawMsgs[0];
        NdefRecord cardRecord = msg.getRecords()[0];
        String val = new String(cardRecord.getPayload());
        displayCard(val);
    }

    private void displayCard(String val) {
        mCardView.setText(val);
    }
} 
```

/ ***** ** *** ** *** ** *** ** *** *** /

/ ***** ***** *Android 清单****** ** *** *** /

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.readnfc"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="14" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:debuggable="true">
        <activity
            android:name=".MainActivity"
            android:label="@string/app_name" >

            <!-- Handle a collectable card NDEF record -->
            <intent-filter>
                <action android:name="android.nfc.action.NDEF_DISCOVERED" />

                <category android:name="android.intent.category.DEFAULT" />

                <data
                    android:host="developer.android.com"
                    android:pathPrefix="/index.html"
                    android:scheme="http" />
            </intent-filter>
            <intent-filter>
                <action android:name="android.nfc.action.NDEF_DISCOVERED" />

                <data android:mimeType="text/plain" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

/ ***** ** *** ** *** ** *** ** *** *** /

为你腾出时间。

真诚的，丽塔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T07:55:44.630

获得 Parcelable 数组后，像这样迭代并尝试读取。它可能会解决您的问题。

```
 Parcelable[] rawMsgs = intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
        if (rawMsgs != null) {
            messages = new NdefMessage[rawMsgs.length];
            for (int i = 0; i < rawMsgs.length; i++) {
                messages[i] = (NdefMessage) rawMsgs[i];
            }
        }
        if(messages[0] != null) {
            String result="";
            byte[] payload = messages[0].getRecords()[0].getPayload();
            for (int b = 1; b<payload.length; b++) {
                result += (char) payload[b];
            }
            Toast.makeText(getApplicationContext(), "Tag Contains " + result, Toast.LENGTH_SHORT).show();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:37:32.240

结果`cardRecord.getPayload()`为字节数组，包含二进制数据。此数据不能简单地转换为 URL，因为 URL 的一部分被压缩以节省存储空间。有效载荷的第一个字节编码 URL 的常见前缀（例如“http://www.”和“https://”），因此您需要单独解码。有关完整列表，请参阅[NFC URI RTD 技术规范](http://www.nfc-forum.org/specs/spec_list/)。您可以轻松地自己实现它，或者尝试使用[https://github.com/grundid/nfctools](https://github.com/grundid/nfctools)中的 NDEF 解码类来为您完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-09T06:13:18.140

```
 textView.setText(new String(ndefMessage.getRecords()[1].getPayload())); 
```

# inno-setup - 如何强制目录编辑框的第一个字符大写？

> ID：11832486
> 
> 赞同：1
> 
> 时间：2012-08-06T16:46:35.787
> 
> 标签：inno-setup

在运行 Inno Setup 时，我需要确保用户输入后安装目录的驱动器号为大写。

原因：Apache 的[mod_xsendfile](https://tn123.org/mod_xsendfile/)需要它。如果驱动器号以小写形式输入，则它不起作用（在 httpd.conf 中）。并且只有驱动器号必须更改；如果路径的任何字符与文件系统中路径的大小写不匹配（尽管 Windows 不区分大小写），Apache 也无法处理它。

如何使 Inno Setup`{app}`常量自动大写其第一个字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:13:07.390

这段代码应该保持目录编辑框的第一个字母总是大写：

```
[Code]
procedure DirEditChange(Sender: TObject);
var
  S: string;
  SelStart: Integer;
  SelLength: Integer;  
begin
  S := WizardForm.DirEdit.Text;
  if Length(S) > 0 then
  begin
    SelStart := WizardForm.DirEdit.SelStart;
    SelLength := WizardForm.DirEdit.SelLength;
    Insert(UpperCase(S[1]), S, 2);  
    Delete(S, 1, 1);
    WizardForm.DirEdit.Text := S;
    WizardForm.DirEdit.SelStart := SelStart;
    WizardForm.DirEdit.SelLength := SelLength;
  end;
end;

procedure InitializeWizard;
begin
  WizardForm.DirEdit.OnChange := @DirEditChange;
end; 
```

# linux - SCSI LUN id 是什么意思，它的用途是什么？

> ID：11832488
> 
> 赞同：1
> 
> 时间：2012-08-06T16:46:38.330
> 
> 标签：linux, ioctl, scsi

在 Linux 中，ioctl SCSI_IOCTL_GET_LUNID 中的 LUN id 是什么意思？这意味着什么？它将如何提供帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:52:49.230

LUN id 是逻辑单元号，是指存储设备。

来自他评论中链接的维基百科文章 tMC：

> LUN 0：每个目标中都需要存在一个 LUN：零。LUN 为 0 的逻辑单元的特殊之处在于它必须执行一些特定的命令，最显着的是报告 LUN，这是启动器可以找到目标中所有其他 LUN 的方式。但 LUN 零不需要提供任何其他服务，例如存储卷。

所以每个目标都有一个 LUN 0。如果一个目标有更多的存储卷，它可能有更多的 LUN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T01:23:18.023

简单来说，你可以认为每个逻辑单元（由lun标识）代表一个连续的逻辑块，从0开始编号。所以如果SCSI启动器要访问SCSI目标，它必须提供目标ID、LUN、逻辑块的偏移量和多少块它想要。

# java - 斯坦福核心 nlp java 输出

> ID：11832490
> 
> 赞同：18
> 
> 时间：2012-08-06T16:46:49.047
> 
> 标签：java, nlp, stanford-nlp

我是 Java 和斯坦福 NLP 工具包的新手，并试图将它们用于项目。具体来说，我正在尝试使用 Stanford Corenlp 工具包来注释文本（使用 Netbeans 而不是命令行）并且我尝试使用[http://nlp.stanford.edu/software/corenlp.shtml#Usage](http://nlp.stanford.edu/software/corenlp.shtml#Usage)上提供的代码（使用斯坦福 CoreNLP API）.. 问题是：谁能告诉我如何在文件中获取输出，以便我可以进一步处理它？

我已经尝试将图表和句子打印到控制台，只是为了查看内容。这样可行。基本上我需要的是返回带注释的文档，这样我就可以从我的主类中调用它并输出一个文本文件（如果可能的话）。我正在尝试查看 stanford corenlp 的 API，但鉴于我缺乏经验，我真的不知道返回此类信息的最佳方式是什么。

这是代码：

```
Properties props = new Properties();
    props.put("annotators", "tokenize, ssplit, pos, lemma, ner, parse, dcoref");
    StanfordCoreNLP pipeline = new StanfordCoreNLP(props);

    // read some text in the text variable
    String text = "the quick fox jumps over the lazy dog";

    // create an empty Annotation just with the given text
    Annotation document = new Annotation(text);

    // run all Annotators on this text
    pipeline.annotate(document);

    // these are all the sentences in this document
    // a CoreMap is essentially a Map that uses class objects as keys and has values with custom types
    List<CoreMap> sentences = document.get(SentencesAnnotation.class);

    for(CoreMap sentence: sentences) {
      // traversing the words in the current sentence
      // a CoreLabel is a CoreMap with additional token-specific methods
      for (CoreLabel token: sentence.get(TokensAnnotation.class)) {
        // this is the text of the token
        String word = token.get(TextAnnotation.class);
        // this is the POS tag of the token
        String pos = token.get(PartOfSpeechAnnotation.class);
        // this is the NER label of the token
        String ne = token.get(NamedEntityTagAnnotation.class);       
      }

      // this is the parse tree of the current sentence
      Tree tree = sentence.get(TreeAnnotation.class);

      // this is the Stanford dependency graph of the current sentence
      SemanticGraph dependencies = sentence.get(CollapsedCCProcessedDependenciesAnnotation.class);
    }

    // This is the coreference link graph
    // Each chain stores a set of mentions that link to each other,
    // along with a method for getting the most representative mention
    // Both sentence and token offsets start at 1!
    Map<Integer, CorefChain> graph = 
      document.get(CorefChainAnnotation.class); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-11T21:10:52.957

一旦您的代码示例中显示了任何或所有自然语言分析，您所需要做的就是将它们发送到正常 Java 方式的文件中，例如，使用 FileWriter 进行文本格式输出。具体来说，这是一个简单的完整示例，显示发送到文件的输出（如果您为其提供适当的命令行参数）：

```
import java.io.*;
import java.util.*;

import edu.stanford.nlp.io.*;
import edu.stanford.nlp.ling.*;
import edu.stanford.nlp.pipeline.*;
import edu.stanford.nlp.trees.*;
import edu.stanford.nlp.util.*;

public class StanfordCoreNlpDemo {

  public static void main(String[] args) throws IOException {
    PrintWriter out;
    if (args.length > 1) {
      out = new PrintWriter(args[1]);
    } else {
      out = new PrintWriter(System.out);
    }
    PrintWriter xmlOut = null;
    if (args.length > 2) {
      xmlOut = new PrintWriter(args[2]);
    }

    StanfordCoreNLP pipeline = new StanfordCoreNLP();
    Annotation annotation;
    if (args.length > 0) {
      annotation = new Annotation(IOUtils.slurpFileNoExceptions(args[0]));
    } else {
      annotation = new Annotation("Kosgi Santosh sent an email to Stanford University. He didn't get a reply.");
    }

    pipeline.annotate(annotation);
    pipeline.prettyPrint(annotation, out);
    if (xmlOut != null) {
      pipeline.xmlPrint(annotation, xmlOut);
    }
    // An Annotation is a Map and you can get and use the various analyses individually.
    // For instance, this gets the parse tree of the first sentence in the text.
    List<CoreMap> sentences = annotation.get(CoreAnnotations.SentencesAnnotation.class);
    if (sentences != null && sentences.size() > 0) {
      CoreMap sentence = sentences.get(0);
      Tree tree = sentence.get(TreeCoreAnnotations.TreeAnnotation.class);
      out.println();
      out.println("The first sentence parsed is:");
      tree.pennPrint(out);
    }
  }

} 
```

# servicestack - 如何在 ServiceStack.Mvc 中实现滑动过期？

> ID：11832491
> 
> 赞同：1
> 
> 时间：2012-08-06T16:46:49.143
> 
> 标签：servicestack

*   我无法增加 Session.Timeout 或无法滑动其到期时间。

ps：这个问题与永久qookies无关（记住我选项）

# ruby-on-rails - 基于组的问题和答案 - Ruby on Rails 3

> ID：11832492
> 
> 赞同：0
> 
> 时间：2012-08-06T16:46:49.720
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, survey

我希望为我的网站创建一个投票系统。我在决定如何建模时遇到了一些麻烦。

目前我有这样的模型：

```
Group has many users 
```

在每个组页面上都会有相同的问题，例如：

“接下来你想要什么功能？”

每个组将有一组相同的可以投票的答案。我将使用 Thumbs Up gem 来对答案进行投票。

组的数量非常大，在 5000 左右。

我正在考虑这样建模：

```
Answer has many Responses
Response belongs to Group, Answer and is voteable (acts_as_voteable with Thumbs Up gem) 
```

任何人都可以就其他明智的问题和答案建模提出建议吗？由于某种原因，这感觉不正确。

基本上，多个组将有相同的问题和答案，只是投票结果不同。我想尽量避免为每个组创建投票和问题，因为这会导致数据库中有超过 100,000 条记录。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:10:22.657

“基本上多个组将有相同的问题和答案，只是投票结果不同。我想尽量避免为每个组创建投票和问题，因为这会导致数据库中有超过 100,000 条记录。”

据我了解，您有一组固定的可能答案的问题，并且您将结果存储在响应中？

我会选择问题和答案之间的 1:n 关系，以及组和问题之间的 n:m 关系，这样您就可以在多个组中“重用”问题。

# javascript - 如何优化地欺骗 chrome 不提示加载不安全的内容

> ID：11832498
> 
> 赞同：6
> 
> 时间：2012-08-06T16:47:13.573
> 
> 标签：javascript, google-chrome, ssl, https, optimizely

在最新的 chrome 更新之一中，chrome 团队添加了“无论如何加载”消息，提示用户批准在安全页面上加载不安全的内容，不知何故优化地找到了一种“欺骗”chrome 不问这个问题的方法，并且简单地使用黄色警告键加载内容，例如：[https ://www.optimizely.com/edit#url=http://www.yahoo.com/](https://www.optimizely.com/edit#url=http://www.yahoo.com/)

我似乎无法理解他们是如何做到的......有人明白吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:30:12.413

看起来他们是在页面加载后执行的。提供的初始页面仅包含一个无害的`<iframe></iframe>`- 尚未加载不安全的内容。Javascript 会实际加载`iframe`.

我做了一些测试，但在 Chromium 18 (Linux) 上看不到任何消息。但是，在我的测试页面上，安全图标在页面加载时开始为绿色，然后在将不安全内容加载到`iframe`. 完全相同的情况也发生在 Optimizely 上。所以我最好的猜测是，这种方法将避免“仍然加载”消息，同时让您加载不安全的内容。

不过不要指望这一点——如果这是 Chrome 的一项新功能，他们很可能也会发现这个技巧并在以后修复它。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-11T04:24:34.550

他们似乎没有在 Chrome 上解决它：他们要求用户按照此屏幕截图启用它： ![在此处输入图像描述](../Images/43619548c8e162a3700b10007ffeb98c.png)

# c# - 有没有办法缩短分配中 if 语句的使用？

> ID：11832499
> 
> 赞同：0
> 
> 时间：2012-08-06T16:47:16.043
> 
> 标签：c#

例如，如果我有这个代码：

```
if (foo != default(foo))
{ 
  int foo2 = foo; 
} 
```

有没有办法将其缩短为仅分配？在伪代码中，类似于： foo2 = if not default foo

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:49:47.397

试图缩短它的问题在于`foo2`它仅在 if 语句内的范围内有效。通过将其移至一行，您总是必须`foo2`在外部范围中定义，并且它总是需要*一些*值。

如果这是可以接受的，您可以使用[C# 的条件运算符](http://msdn.microsoft.com/en-us/library/ty67wk28.aspx)：

```
int foo2 = foo != default(foo) ? foo : default(int); 
```

请注意，您还需要一些用于 when`foo == default(foo)`的内容，这将成为最后一部分。使用 int 值，我可能会`: 0;`在最后使用，但由于您正在检查`default(foo)`，我假设您的“真实用例”可能不是一个`Int32`值......

* * *

编辑：

> (int) 是事后才想到的，在我实际尝试的过程中，我已经分配了 foo2，所以这正是我想要的。

鉴于此评论，您可以这样做：

```
foo2 = foo != default(foo) ? foo : foo2; 
```

`foo2`如果`foo`没有默认值，这将有效地重新分配，如果有，则不理会它（将其分配给自己）。

话虽这么说，我个人更喜欢类似于你原来的东西：

```
// Assumes foo2 is already defined, based on your comment
if (foo != default(foo))
    foo2 = foo; 
```

在我看来，就您的意图而言，这更加清楚，并且确实避免了您使用条件运算符获得的额外分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:50:53.247

```
// either
int foo2 = (foo != default(foo)) ? foo : default(int);
// or
int? foo2 = (foo != default(foo)) ? foo : null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:51:09.873

您将无法再简化它。如果您只是设置值`foo2`而不是声明它（以及在范围块中），那么您可以想象将其重构为一种方法以获得微小的收益。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:54:14.563

你也可以这样做：

```
foo2 = foo != default(foo) ? foo : foo2; 
```

# vbscript - VB脚本复制文件和进度条

> ID：11832500
> 
> 赞同：1
> 
> 时间：2012-08-06T16:47:20.733
> 
> 标签：vbscript

我用于将文件从源复制到目标的代码工作正常，我尝试做的只是复制文件，如果它们是较新的文件或具有不同的名称。文件名示例 abc1.txt 和下周这将被替换为 abc2.txt 的源文件夹 这是 VB 脚本代码。

```
`

Dim intFCount, FSO, strSrcFolder, strDestFolder, strSource, FC, i, intPercentComplete

    i = 0
    intFCount = 0
    intPercentComplete = 0
    Set FSO = CreateObject("Scripting.FileSystemObject")

    strSrcFolder = "\\server\DATA\Production\RUM\"
    strDestFolder = "E:\DATA\Production\test\"

    set strSource = FSO.GetFolder(strSrcFolder)
    set FC = strSource.Files

    for each file in FC
        intFCount = intFCount + 1
    Next

    For Each file in FC
        FSO.CopyFile file, strDestFolder
        i = i + 1
    Next
    2\.  I was able to find some progress bar vbs or hta script but struggling to incorporate my copy script to display the progress.  
    Here is the progress bar .hta script found on the net
    <html>
    <head>
    <title id="title">ProgressBar 2.1</title>
    <HTA:APPLICATION ID="porgbar" APPLICATIONNAME="progbartest">
    <script language="vbscript">

    Public x,y, MyTitle, iTimerID, KeepGoing

    Sub Window_Onload
    MyTitle = document.Title
    id("ProgBarToDo").innerText = String(80, "_") & "|"  
    window.ResizeTo 720, 200       
    x=0       
    y=35     
    End Sub

    Sub Go
    '---FOR TEST ONLY---
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set oof = fso.CreateTextFile("testpb.vbs", True)
    oof.WriteLine "wscript.sleep WScript.Arguments(0)"  
    oof.Close
    Set WshShell = CreateObject("WScript.Shell")
    '----END OF TEST ONLY----

    Progress(1)
    Do Until x=y
    x=x+1
    WshShell.Run "testpb.vbs 250",1,True  '----FOR TEST ONLY
    If KeepGoing = False Or window.screenTop > 10000 Then 
    Exit Do
    End If
    Loop
    Progress(0)
    End Sub

    Sub Progress(v)
    Select Case v
    Case 0  
    window.clearInterval(iTimerID)  
    iTimerID =""             
    id("BtnGo").disabled = False       
    id("BtnCancel").disabled = True    
    id("BtnExit").disabled = False     
    Progress(2)            
    MsgBox "Operation finished.",,MyTitle

    Case 1  
    iTimerID = window.setInterval("Progress(2)", 500)    
    id("BtnGo").disabled = True        
    id("BtnCancel").disabled = False   
    id("BtnExit").disabled = True      
    KeepGoing = True
    Progress(2)         

    Case 2  
    document.Title = FormatPercent(x/y, 0) & MyTitle  
    id("ProgBarText").innerText = x & "/" & y  
    d = Round( x / (y/80)  ,0)   
    id("ProgBarDone").innerText = String(d, "_")  
    If d<80 Then   
    id("ProgBarToDo").innerText = String(80-d, "_") & "|"  
    Else     
    id("ProgBarToDo").innerText = "|"  
    End If

    End Select
    End Sub

    Function id(o)
    Set id = document.getElementById(o)
    End Function

    Sub Help
    MsgBox "This is an example of progressbar in HTA written by Fredledingue.",,MyTitle
    End Sub

    </script>
    </head>
    <body bgcolor="GreenYellow">

    <input id="BtnGo"     type="button" value="Go"     onclick="Go">
    <input id="BtnCancel" type="button" value="Cancel" onclick="KeepGoing=False" disabled="True">
    <input id="BtnExit"   type="button" value="Exit"   onclick="window.close">
    <input id="BtnHelp"   type="button" value="Help"   onclick="Help">
    <br>

    Done: <span id="ProgBarText">?</span><br>
    <span id="ProgBarDone" style="background-color:blue"></span>
    <span id="ProgBarToDo" style="background-color:silver"></span>

    </body>
    </html>
    ` 
```

非常感谢任何帮助。非常感谢，SS

在 msdn 上也找到了一些比较代码，但如果没有将 abc2.txt 从服务器复制到本地驱动器，我需要检查服务器上是否存在文件 abc1.txt。这是代码

```
enter code here Option Explicit  
Dim objFSO, wshShell  
Set objFSO   = CreateObject("Scripting.FileSystemObject")     
Set wshShell = CreateObject("Wscript.Shell")  
'----------------------------------------------------------------------------------------------------------------------------  
On Error Resume Next 
   ProcessScript  
   If Err.Number <> 0 Then 
      Wscript.Quit  
   End If 
On Error Goto 0  
'----------------------------------------------------------------------------------------------------------------------------  
'Name       : ProcessScript -> Primary Function that controls all other script processing.  
'Parameters : None          ->  
'Return     : None          ->  
'----------------------------------------------------------------------------------------------------------------------------  
Function ProcessScript  
   Dim localFile, serverFile  
   Dim localFileVersion, serverFileVersion  
   localFile  = "C:\rsccc2k\login\login.exe" 
   serverFile = "\\destiny\Install\RSCCC\login.exe" 
   If objFSO.FileExists(localFile) Then 
      If Not GetFileVersion(localFile, localFileVersion) Then 
         Exit Function 
      End If 
      If objFSO.FileExists(serverFile) Then 
         If Not GetFileVersion(serverFile, serverFileVersion) Then 
            Exit Function 
         End If 
      End If 
      If StrComp(localFileVersion, serverFileVersion, vbTextCompare) <> 0 Then 
         On Error Resume Next 
            wshShell.Run "\\destiny\Install\RSCCC\RSCCCInstall.bat", 0, true  
         On Error Goto 0  
      End If 
   End If 
End Function 

'----------------------------------------------------------------------------------------------------------------------------  
'Name       : GetFileVersion -> Enumerates the version number of a file.  
'Parameters : fileSpec       -> Input  : Folder path and file name for the file to enumerate the version number from.  
'           : fileVersion    -> Output : The file version number of input parameter "fileSpec".  
'Return     : GetFileVersion -> Returns False or True and the version number of the file.  
'----------------------------------------------------------------------------------------------------------------------------  
Function GetFileVersion(fileSpec, fileVersion)  
   GetFileVersion = False 
   On Error Resume Next 
      fileVersion = objFSO.GetFileVersion(fileSpec)  
      If Len(fileVersion) = 0 Or Err.Number <> 0 Then 
         Exit Function 
      End If 
   On Error Goto 0  
   GetFileVersion = True 
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-20T02:00:52.620

您也可以使用等待栏尝试此脚本

（脚本由 Sree 翻译）

```
Option Explicit
Dim sSrc,sDest,MyCmd,Temp,Title,MsgTitle,MsgWaiting,Copyright,oExec,ws,LogTmpFile,LogFile,MyExcludeFile,Settings
Copyright = "[ XcopyScript © Hackoo Crackoo © 2014 ]"
Set ws = CreateObject("WScript.Shell")
Temp = ws.ExpandEnvironmentStrings("%Temp%")
sSrc = "C:\Downloads"
sDest = "C:\XCopytest"
LogTmpFile = "MyTmpXCopyLog.txt"
LogFile = "MyXCopyLog.txt"
Settings = " /D /Y /E /F"
MyCmd = "XCopy" & " " & DblQuote(sSrc) & " " & DblQuote(sDest) & " " & Settings &" > " & LogTmpFile &_
" & cmd /U /C Type " & LogTmpFile & " > " & LogFile & " & Del " & LogTmpFile & ""
Title = "Copy backup " & Copyright
MsgWaiting = "Copy backup : <font color=Yellow>" & DblQuote(sSrc) & " to " & DblQuote(sDest) & " </font>  . . . ."
Call CreateProgressBar(Title,MsgWaiting)
Call LaunchProgressBar()
Call Pause(2)
Call Run(MyCmd,0)
Call CloseProgressBar()
ws.run LogFile
'****************************************************************************************************
 Function Run(StrCmd,Console)
    Dim ws,MyCmd,Result
    Set ws = CreateObject("wscript.Shell")
'A value of 0 to hide the MS-DOS console
    If Console = 0 Then
        MyCmd = "CMD /C " & StrCmd & " "
        Result = ws.run(MyCmd,Console,True)
        If Result = 0 Then
            MsgBox "Success"
        Else
            MsgBox "An unknown error has occurred!",16,"An unknown error has occurred!"
        End If
    End If
'A value of 1 to show the MS-DOS console
    If Console = 1 Then
        MyCmd = "CMD /K " & StrCmd & " "
        Result = ws.run(MyCmd,Console,False)
        If Result = 0 Then
            MsgBox "Success"
        Else
            MsgBox "An unknown error has occurred!",16,"An unknown error has occurred!"
        End If
    End If
    Run = Result
End Function
'****************************************************************************************************
Sub CreateProgressBar(Title,MsgWaiting)
    Dim ws,fso,f,f2,ts,ts2,Ligne,i,fread,LireTout,NbLigneTotal,Temp,PathOutPutHTML,fhta,oExec
    Set ws = CreateObject("wscript.Shell")
    Set fso = CreateObject("Scripting.FileSystemObject")
    Temp = WS.ExpandEnvironmentStrings("%Temp%")
    PathOutPutHTML = Temp & "\Barre.hta"
    Set fhta = fso.OpenTextFile(PathOutPutHTML,2,True)
    fhta.WriteLine "<HTML>"
    fhta.WriteLine "<HEAD>"
    fhta.WriteLine "<Title>  " & Title & "</Title>"
    fhta.WriteLine "<HTA:APPLICATION"
    fhta.WriteLine "ICON = ""magnify.exe"" "
    fhta.WriteLine "BORDER=""THIN"" "
    fhta.WriteLine "INNERBORDER=""NO"" "
    fhta.WriteLine "MAXIMIZEBUTTON=""NO"" "
    fhta.WriteLine "MINIMIZEBUTTON=""NO"" "
    fhta.WriteLine "SCROLL=""NO"" "
    fhta.WriteLine "SYSMENU=""NO"" "
    fhta.WriteLine "SELECTION=""NO"" "
    fhta.WriteLine "SINGLEINSTANCE=""YES"">"
    fhta.WriteLine "</HEAD>"
    fhta.WriteLine "<BODY text=""white""><CENTER><DIV><SPAN ID=""ProgressBar""></SPAN>"
    fhta.WriteLine "<span><marquee DIRECTION=""LEFT"" SCROLLAMOUNT=""3"" BEHAVIOR=ALTERNATE><font face=""Comic sans MS"">" & MsgWaiting &"</font></marquee></span></DIV></CENTER></BODY></HTML>"
    fhta.WriteLine "<SCRIPT LANGUAGE=""VBScript""> "
    fhta.WriteLine "Set ws = CreateObject(""wscript.Shell"")"
    fhta.WriteLine "Temp = WS.ExpandEnvironmentStrings(""%Temp%"")"
    fhta.WriteLine "Sub window_onload()"
    fhta.WriteLine "    CenterWindow 500,90"
    fhta.WriteLine "    Self.document.bgColor = ""DarkOrange"" "
    fhta.WriteLine " End Sub"
    fhta.WriteLine " Sub CenterWindow(x,y)"
    fhta.WriteLine "    Dim iLeft,itop"
    fhta.WriteLine "    window.resizeTo x,y"
    fhta.WriteLine "    iLeft = window.screen.availWidth/2 - x/2"
    fhta.WriteLine "    itop = window.screen.availHeight/2 - y/2"
    fhta.WriteLine "    window.moveTo ileft,itop"
    fhta.WriteLine "End Sub"
    fhta.WriteLine "</script>"
    fhta.close
End Sub
'**********************************************************************************************
Sub LaunchProgressBar()
    Set oExec = Ws.Exec("mshta.exe " & Temp & "\Barre.hta")
End Sub
'**********************************************************************************************
Sub CloseProgressBar()
    oExec.Terminate
End Sub
'**********************************************************************************************
Sub Pause(NSeconds)
    WScript.Sleep(NSeconds*1000)
End Sub  
'**********************************************************************************************
Function DblQuote(Str)
    DblQuote = Chr(34) & Str & Chr(34)
End Function
'********************************************************************************************** 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T13:25:52.097

我有一个***进度条***代码，最大值为 15%，但它会打开**Internet Explorer**。如果您想尝试*此*代码，那么这里是代码，但您需要 Internet Explorer 12（或 11 也可能）：

```
On Error Resume Next

strComputer = "."
Set objWMIService = GetObject("Winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery("Select * From Win32_DesktopMonitor")
For Each objItem in colItems
    intHorizontal = objItem.ScreenWidth
    intVertical = objItem.ScreenHeight
Next

Set objExplorer = CreateObject _
    ("InternetExplorer.Application")

objExplorer.Navigate "about:blank"   
objExplorer.ToolBar = 0
objExplorer.StatusBar = 0
objExplorer.Left = (intHorizontal - 425) / 2
objExplorer.Top = (intVertical - 100) / 2
objExplorer.Width = 425
objExplorer.Height = 100
objExplorer.Visible = 1             

objExplorer.Document.Title = "Progress bar = 0-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='0' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 1-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='1' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 2-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='2' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 3-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='3' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 4-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='4' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 5-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='5' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 6-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='6' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 7-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='7' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 8-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='8' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 9-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='9' max='15'></progress>"

WScript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 10-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='10' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 11-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='11' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 12-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='12' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 13-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='13' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 14-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='14' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 15-15 %"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 1000

objExplorer.Document.Title = "Progress bar = 15-15 % -"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 500

objExplorer.Document.Title = "Progress bar = 15-15 % --"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 500

objExplorer.Document.Title = "Progress bar = 15-15 % ---"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 500

objExplorer.Document.Title = "Progress bar = 15-15 % ----"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 500

objExplorer.Document.Title = "Progress bar = 15-15 % ---- C"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- CO"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COM"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMP"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPL"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLE"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLET"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLETE"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLETE!"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLETE!!"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

Wscript.Sleep 250

objExplorer.Document.Title = "Progress bar = 15-15 % ---- COMPLETE!!!"
objExplorer.Document.Body.InnerHTML = "<progress value='15' max='15'></progress>"

WScript.Quit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T11:56:54.020

我只有在 vbs 中有这样的例程，但 Tomalak 是对的，运行外部命令会更容易和更快

```
Set oShell = WScript.CreateObject("WScript.Shell")
source = "c:\temp"
target = "c:\temp2"
parameters = "/ds"
oShell.Run "XCOPY " & parameters & " """ & source & """ """ & target & """" 
```

# router - 模拟糟糕的互联网连接

> ID：11832505
> 
> 赞同：40
> 
> 时间：2012-08-06T04:28:48.167
> 
> 标签：router, lan, internet-connection, testing

我正在开发一个可以通过 LAN 访问互联网的嵌入式设备。我现在处于测试阶段，我想测试设备在互联网连接不佳时的性能。目前，该设备通过集线器连接到路由器，我使用集线器通过 Wireshark 监控数据包。降低设备的互联网速度以模拟可能发生的场景的最佳方法是什么？

我可以通过 PC 完成吗？我需要访问路由器吗？如果是这样，是否可以限制路由器接口中每个IP的速度？

其实有朋友建议我买个usb2lan网卡，把PC局域网连接到嵌入式设备，然后用软件QoS限制器。你认为它会起作用吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-06T05:52:09.950

如果你手边有一台 Mac，Mac 有`dummynet`内置的内核工具，你可以通过`ipfw`. 它允许您模拟慢速连接、以特定概率随机丢弃数据包等等。

Linux 和其他操作系统中存在相同的工具。

从[dummynet 主页](http://info.iet.unipi.it/~luigi/dummynet/)：

> 截至 2010 年 2 月，我们已经发布了 dummynet 的第三个主要版本，它现在可以在所有主要平台上运行：FreeBSD、Mac OS X 作为本机发行版的一部分，您可以在此处找到 Linux、OpenWRT 和 Windows 版本。

它可以为您做很多事情：

*将总传入 TCP 流量限制为 2Mbit/s，将 UDP 限制为 300Kbit/s*

```
ipfw add pipe 2 in proto tcp
ipfw add pipe 3 in proto udp
ipfw pipe 2 config bw 2Mbit/s
ipfw pipe 3 config bw 300Kbit/s 
```

*将网络 10.1.2.0/24 上每个主机的传入流量限制为 300Kbit/s。*

```
ipfw add pipe 4 src-ip 10.1.2.0/24 in
ipfw pipe 4 config bw 300Kbit/s queue 20 mask dst-ip 0x000000ff 
```

*模拟到月球的 ADSL 链接：*

```
ipfw add pipe 3 out
ipfw add pipe 4 in
ipfw pipe 3 config bw 128Kbit/s queue 10 delay 1000ms
ipfw pipe 4 config bw 640Kbit/s queue 30 delay 1000ms 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-09T10:05:29.837

您可以尝试使用“[提琴手](http://www.fiddler2.com/fiddler2/)”

您可以选择模拟不良网络（如旧调制解调器 33k 或 56k）

您需要将设备插入 PC 并打开代理（每个请求都将通过 Fiddler 传输）

然后你可以用糟糕的网络测试你的代码然后看看发生了什么;)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-04-05T00:37:26.713

您可以使用（几乎）来自 liveCd 的任何 linux 发行版（如 ubuntu、mandriva 等）在您想要的任何硬件上运行它，并使用基于内核的工具[netem](http://www.linuxfoundation.org/collaborate/workgroups/networking/netem)，即“网络仿真”和“iproute2”包工具。它可以让您控制广域网的延迟、包丢失、损坏、重复和其他可能的问题。

有最常用的模拟列表，例如：

*   使用令牌桶过滤器进行速率控制：

    ```
    tc qdisc add dev eth0 root handle 1:0 netem delay 100ms
    tc qdisc add dev eth0 parent 1:1 handle 10: tbf rate 256kbit buffer 1600 limit 3000 
    ```

*   将所有数据包延迟固定时间：`tc qdisc add dev eth0 root netem delay 100ms`

*   包丢失：`tc qdisc change dev eth0 root netem loss 0.1%`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-07T10:45:35.360

这是另一个 OSX 解决方案，请查看 Network Link Conditioner。

以下引述摘自以下博客（以下所有功劳均应归功于 Matt Gemmell）：

[http://mattgemmell.com/2011/07/25/network-link-conditioner-in-lion/](http://mattgemmell.com/2011/07/25/network-link-conditioner-in-lion/)

> 获取 Xcode 的硬件 IO 工具。为此，请进入 Xcode 菜单，然后选择“Open Developer Tool”，最后选择“More Developer Tools...”。您将被带到 Apple 的开发者下载站点；你应该下载“Hardware IO Tools for Xcode”。
> 
> 生成的磁盘映像将包含（除其他外）系统首选项的首选项窗格，称为“网络链接调节器”。双击 prefpane 文件并进行身份验证以允许安装它。然后，您将在“系统偏好设置”中看到该窗格。
> 
> 您可以使用配置文件弹出菜单从各种不同类型的网络条件中进行选择。
> 
> 您还可以通过单击“管理配置文件”来添加您自己的配置文件，无论是从头开始还是通过复制现有配置文件。
> 
> 在测试应用程序时模拟不太理想的网络条件非常方便。只是不要忘记之后将其关闭！

# css - css sprite Img 加载时间哪个更快？

> ID：11832514
> 
> 赞同：1
> 
> 时间：2012-08-06T16:48:30.990
> 
> 标签：css, sprite

最近我一直在将我的网站切换到 css sprites 以提高性能。我曾经有五个 16 x 16px imgs 的 dll，我现在有一个 220x140px 的 css sprite，由这 5 个图像和文本组成。加载这个更大的图像真的更快吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:51:43.960

答案是“视情况而定”

如果您从精灵图像加载一张图像，它会更慢，因为文件较大。

但是如果你开始第二次请求第二张图片，精灵会变得更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:16:06.650

我相信真实的精灵永远是最好的解决方案。我只是不明白您如何从 5x 16 x 16 像素变为 220 x 140 像素的单个文件。如果您使用最小的空间，您应该能够使用 16 像素 x 80 像素的单个图像来完成。尺寸确实很重要。将文本放入图像中并不是一个好主意。在您的 html 中将文本作为纯文本发送要快得多，而且它可以提高使用屏幕阅读器的人的可读性，并且对于 SEO 来说要好得多。如果它使用一些我无法用 css 重现的特殊字体或样式，我只会将文本放入图像中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:51:36.643

老实说，这取决于您必须加载多少次。数量较少时速度较慢，但​​数量较大时速度会更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T16:54:22.603

当精灵被精心构建（不浪费大量空间）并在网站的任何地方使用时，**是**的！特别是在请求之间的延迟和时间可能非常大的移动设备上。

# core-graphics - 为什么 Retina 显示器上 CoreGraphics 中的线宽呈现半宽？

> ID：11832515
> 
> 赞同：1
> 
> 时间：2012-08-06T16:48:38.043
> 
> 标签：core-graphics, retina-display, cgcontext

我的过程如下所示：

*   使用点尺寸定义我要绘制的矩形。
*   定义`CGFloat scale = [[UIScreen mainsScreen] scale]`
*   将矩形的大小乘以比例
*   使用创建矩形大小的图像上下文`CGBitmapContextCreate`
*   在图像上下文中绘制
*   称呼`CGBitmapContextCreateImage`
*   call `UIImage imageWithCGImage:scale:orientation`：具有适当的规模。

我原以为这总是会在视网膜和旧屏幕上产生完美的图像，但一直没有密切关注线条对比度/厚度。一般来说，笔触与填充的对比度很高，所以直到现在我才注意到，线条和填充之间的对比度很低。

我想也许我误解了用户空间，但我认为这只是通过缩放和应用转换的直接转换。除了视网膜屏幕双重缩放之外，在我的特定情况下没有应用缩放和变换。

尝试渲染 2 像素线而不是 1 像素更容易解释：当我调用 时 `UIContextSetLineWidth(context, 2)`，线在视网膜模拟器上被渲染为 1 像素粗。1个像素！但这应该是两个像素，在视网膜显示器上。

`UIContextSetLineWidth(context, 2 * scale)`在视网膜屏幕上产生一条 2 像素宽的线，但我希望它是 4 像素。

`UIContextSetLineWidth(context, 1)`生成一条部分透明的 1 像素宽的线。我了解跨越路径的笔划，所以我更喜欢用 2 像素宽的笔划和像素边界上的路径来讨论。

我需要了解为什么渲染的线宽被分成两半。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:20:41.807

我的错。我自己的 99% 的错误都是在我公开发布后自己解决的。

绘制代码包括构建和复制路径后的**CGContextClip 。**之后，可以应用填充，渐变或其他方式，然后绘制线条，所以一切都很好而且整洁。我专注于数学和特定的绘图代码，并没有注意到剪切线，但这会有效地**减半笔画宽度**。通常我会立即发现这样的逻辑错误，但因为它已发布到 SO，所以答案也在这里。

# windows-8 - Windows8 中的音频流

> ID：11832520
> 
> 赞同：2
> 
> 时间：2012-08-06T16:48:58.977
> 
> 标签：windows-8

我需要一些有关在 Windows8 上流式传输音频内容的帮助。我有几个需要播放的 URL。不确定是否有任何现成的 API 可用于此或其他任何内容。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:01:29.450

试试这个：

[将此](http://msdn.microsoft.com/en-US/library/windows/apps/xaml/Hh465160#mediaelement_object)与[此](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh868173%28v=win.10%29.aspx)结合起来。

基本上，您使用指向您的音频`MediaElement`的 URI创建类的实例。`Uri targetUri = new Uri(@"http://www.bing.com");`

由于您提到了“几个 URL”，因此您需要创建某种“播放列表”（可能只是 URL 的集合）。您可以订阅 MediaElement 的 MediaEnded 事件以了解何时转到下一个曲目。您还需要订阅 MediaFailed 事件，以防网络出现故障、音频文件被删除或音频文件使用了不受支持的编解码器。

最后，考虑添加对音频的支持，即使您的应用程序没有获得焦点，也可以继续在后台运行。[这个](http://social.msdn.microsoft.com/Forums/en-AU/winappswithcsharp/thread/2d3496df-a145-4d87-be08-aadd5a8098e2)线程应该有帮助。

# java - 即使类存在于 jar 文件中，也会抛出 java.lang.ClassNotFoundException

> ID：11832521
> 
> 赞同：0
> 
> 时间：2012-08-06T16:49:00.603
> 
> 标签：java, exception, jar

我无法理解为什么在运行 jar 文件时会出现此错误：

> 线程“main”中的异常 java.lang.NoClassDefFoundError: net/sf/mzmine/main/MZ mineModulesList at net.sf.mzmine.main.MZmineCore.main(MZmineCore.java:100) 原因：java.lang.ClassNotFoundException： net.sf.mzmine.main.MZmineModulesList

它说`MZmineModulesList`找不到该类，但它存在于此路径中。也许我在将类写入 jar 文件时做错了什么？

我想补充一点，这是在我用更新版本替换 MZmineModuleList 文件后出现的。我所做的：我从 Jar 中提取文件并添加了我的新类，并且我将旧的 MZmineModuleList 类替换为新的类，其中添加了几行代码。也许当我使用 java.util.jar 的方法写入 jar 文件时，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:56:00.913

如果类的`NoClassDefFoundError`静态代码块中存在错误，则可能发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:58:56.263

类可能是abigious。如果可以从多个类加载器加载一个类，则也可能会引发此错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:08:34.110

如果您使用 IDE 或其他工具为您构建所有内容，请检查以确保它包含 jar 中的所有类。我见过没有包含所有类文件的 Eclipse IDE 导出 jar。如果是这种情况，只需将类文件放入 jar 中。

# google-app-engine - Oauth错误没有这种方法

> ID：11832523
> 
> 赞同：0
> 
> 时间：2012-08-06T16:49:05.287
> 
> 标签：google-app-engine

我不知道为什么，但是当我启动我的应用程序时，我突然总是收到以下错误（以前从未出现过）：

> java.lang.NoSuchMethodError: com.google.gdata.client.authn.oauth.GoogleOAuthParameters.setOAuthType(Lcom/google/gdata/client/authn/oauth/OAuthParameters$OAuthType;)

产生错误的代码行是：

```
oauthParameters.setOAuthType(OAuthParameters.OAuthType.TWO_LEGGED_OAUTH); 
```

这个错误以前没有出现过，在eclipse中总是没有错误，一切正常。

我从来没有改变图书馆。似乎当我部署到 app-engine 时，它​​没有上传带有该类的 jar？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:00:37.863

由于您仅在部署时看到此问题，因此听起来您已将 gdata-java-client jar 包含在某个位置，以便它们对您的本地 Java 运行时可见，但不会发送到 App Engine 服务器部署。

解决此问题的最简单方法是将 gdata-java-client 及其依赖项包含在`war/WEB-INF/lib`应用程序的目录中，并在 Eclipse 中的 Java 构建路径中引用这些 jar。

# html - 我将 html、body 和容器 div 设置为 100% 高度，但页面顶部仍然存在间隙？

> ID：11832525
> 
> 赞同：0
> 
> 时间：2012-08-06T16:49:09.420
> 
> 标签：html, height, gaps-in-visuals

```
@charset "utf-8";

html {
height:100%; 
```

}

```
body {
background-color:#000000;
height:100%;
}

img
{  border-style: none;
}

container {
background: #EEE;
position:relative;
width:763px;
margin:auto;
min-height:100%;
border-right: 2px solid #0F0;
border-left: 2px solid #0F0; position:inherit;} 
```

伙计们怎么了？是不是因为我读到的 utf-8 会留下没有宽度的垂直间隙，idk 有点在黑暗中拍摄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:50:29.093

您已将内容高度设置为 100%，但未删除默认边距（或某些浏览器中的填充）。这意味着内容是视口的高度，并且您会获得滚动条，以便您可以到达它的底部。

放：

```
html, 
body { 
    margin: 0;
    padding: 0;
} 
```

删除默认边距/填充。

# asp.net - 视图状态持久化

> ID：11832526
> 
> 赞同：0
> 
> 时间：2012-08-06T16:49:17.267
> 
> 标签：asp.net, controls, viewstate

假设我有一个页面，上面有一个用户控件 (A)。此用户控件有许多其他服务器和用户控件作为其子项。如果我禁用用户控件 A 上的视图状态，里面的所有子项是否也会丢失其视图状态？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T16:54:29.503

子控件也将失去其视图状态。有关更多详细信息，请参阅上一个问题：[在父项中禁用时，如何为子自定义控件启用 ViewState？](https://stackoverflow.com/questions/175252/how-do-i-enable-viewstate-for-child-custom-controls-when-disabled-in-parent)

# ruby-on-rails - 我无法在 Windows 7 上安装 ruby -debug-base19 -v '0.11.25

> ID：11832528
> 
> 赞同：2
> 
> 时间：2012-08-06T16:49:19.497
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-1.9.3, ruby-debug

我正在尝试在 Windows 7 上安装 Rails。

当我安装我得到这个错误：

```
make
generating ruby_debug-i386-mingw32.def
compiling breakpoint.c
compiling ruby_debug.c
ruby_debug.c:29:19: error: conflicting types for 'rb_iseq_compile_with_option'
C:/Ruby193/include/ruby-1.9.1/ruby-1.9.3-p194/vm_core.h:505:7: note: previous declaration of 'rb_iseq_compile_with_option' was here
ruby_debug.c: In function 'context_jump':
ruby_debug.c:2414:53: warning: comparison between signed and unsigned integer expressions
ruby_debug.c:2428:27: warning: comparison between signed and unsigned integer expressions
make: *** [ruby_debug.o] Error 1

Gem files will remain installed in C:/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25 for inspection.
Results logged to C:/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/ext/ruby_debug/gem_make.out
An error occured while installing ruby-debug-base19 (0.11.25), and Bundler cannot continue.
Make sure that `gem install ruby-debug-base19 -v '0.11.25'` succeeds before bundling. 
```

我在“[在 Ruby 1.9.3 中的 Windows 上安装 ruby](https://stackoverflow.com/questions/9705947/installing-ruby-debug-base19-on-windows-in-ruby-1-9-3) ​​-debug-base19”之后安装了 ruby​​-debug-base19 -v '0.11.26

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:47:32.310

只需在 gemfile 中注释掉即可

```
#  gem 'ruby-debug19', :require => 'ruby-debug' 
```

如果您喜欢[Link to better_errors ，可以尝试使用 better_errors 进行调试](https://github.com/charliesome/better_errors)

# ruby-on-rails - ping 网站会增加点击次数吗？

> ID：11832529
> 
> 赞同：2
> 
> 时间：2012-08-06T16:49:20.243
> 
> 标签：ruby-on-rails, heroku, web, ping, hit

我最近`ping`在mac上找到了该命令。我习惯于随便 ping 我的 rails heroku 应用程序。我想知道来自终端的这种类型的 ping 是否会增加网站获得的点击总数（显然不是唯一点击）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:51:36.463

`ping`是不使用端口 80 或 http 协议的网络命令。因此，它无法计入 Rails 应用程序命中。

更多信息： [http ://wiki.answers.com/Q/Which_port_is_used_by_Ping_command](http://wiki.answers.com/Q/Which_port_is_used_by_Ping_command)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T16:53:35.470

ping 命令只 ping 主机，它是一个检查机器之间连接性的网络工具，它是与 HTTP 不同的协议，请阅读此内容，它可以帮助您更好地理解什么是 ping [http://en.wikipedia。 org/wiki/Ping_%28networking_utility%29](http://en.wikipedia.org/wiki/Ping_%28networking_utility%29)以及他的用途。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T18:59:38.130

安东尼上面说的是真的。Ping 使用 ICMP，它在堆栈中低于通过端口 80 的 http 请求。Ping 只发送一个数据包，期望一个相当小的数据包作为响应（我认为 64 字节往返）。

但是，这会在运行您的服务器的机器上产生负载。所以要小心过度使用，因为你可能会无意中导致拒绝服务:)

# c# - 获取上个月的日期

> ID：11832530
> 
> 赞同：2
> 
> 时间：2012-08-06T16:49:33.877
> 
> 标签：c#, datetime

我有一个看起来很简单的日期问题，我只是无法集中精力尝试有效地解决它......我基本上需要获取特定日期的前几个月日期。

**例如**：如果今天是本月的第三个星期四，我想获取上个月的第三个星期四的日期。重要的是它基于当天的数字......即：第一个星期一，第四个星期五，第二个星期三等。

完成这项工作的最佳方法是什么？

顺便说一句...如果没有等效的前几个月的一天，那很好。我可以处理。另外，目前我正在手动计算数字或天数（“星期一”、“星期二”等）来解决这个问题。我只是希望有一种更优雅的方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:55:33.710

这是我要做的：

```
static DateTime? GetLastMonthSameNthDayOfWeek(DateTime date)
{
    int nth = (date.Day-1) / 7; // returns 0 if 1st, 1 if 2nd...
    var prevMonthDay = date.AddMonths(-1);

    // find the first date of month having the same day of week
    var d = new DateTime(prevMonthDay.Year, prevMonthDay.Month, 1);
    while(d.Day <= 7)
    {
        if (d.DayOfWeek == date.DayOfWeek)
            break;
        d = d.AddDays(1);
    }
    // go to nth day of week
    d = d.AddDays(7 * nth);
    // if we have passed the current month, there's no nth day of week
    if (d.Month != prevMonthDay.Month)
        return null;
    return d;
} 
```

使用示例：

```
// 3rd wednesday of August 2012
var a = new DateTime(2012, 8, 15);
var aPrev = GetLastMonthSameNthDayOfWeek(a);
// aPrev = July 18th 2012 (i.e. the 3rd wednesday of July 2012)

// 5th wednesday of August 2012
var b = new DateTime(2012, 8, 15);
var bPrev = GetLastMonthSameNthDayOfWeek(b);
// bPrev = null, because there's no 5th wednesday of July 2012 
```

注意：

在一个月内获得星期几的序数位置真的很容易：

```
int nth = ((date.Day-1) / 7) + 1; // 1 -> 1st, 2 -> 2nd, 3 -> 3rd ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:06:07.987

由于找不到内置方法，我为 编写了这个简单的扩展方法`DateTime`，请查看：

```
public static class DateTimeExtension
{
    public static DateTime GetPositionalDate(this DateTime BaseDate, DayOfWeek WeekDay, int position)
    {
        if (position < 1)
        {
            throw new Exception("Invalid position");
        }
        else
        {
            DateTime ReturnDate = new DateTime(BaseDate.Year, BaseDate.Month, BaseDate.Day);
            int PositionControl = 1;
            bool FoundDate = false;

            while(ReturnDate.DayOfWeek != WeekDay)
            {
                ReturnDate = ReturnDate.AddDays(1);
            }

            while (!FoundDate && PositionControl <= position)
            {
                PositionControl++;

                if (PositionControl == position)
                {
                    FoundDate = true;
                }
                else
                {
                    ReturnDate = ReturnDate.AddDays(7);
                }
            }

            if (FoundDate)
            {
                return ReturnDate;
            }
            else
            {
                throw new Exception("Date not found");
            }
        }
    }
} 
```

用法：

```
DateTime lastMonth = DateTime.Now.GetPositionalDate(DayOfWeek.Sunday, 2); 
```

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:04:39.103

默认情况下，.Net 没有一种方式可以理解日期的这种特定逻辑。因此，使用以下内容，您可以获得所需的内容：

```
var now = DateTime.Now.Date; 
```

[使用 DateTime.AddMonth(-1) 获取 last month](http://msdn.microsoft.com/en-us/library/system.datetime.addmonths)。

[使用 DateTime.AddDays(now.Days * -1 + 1) 获取月份的第一天](http://msdn.microsoft.com/en-us/library/system.datetime.adddays)。

[使用 DateTime.DayOfWeek 确定日期并根据需要减去或增加天数](http://msdn.microsoft.com/en-us/library/system.datetime.dayofweek)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:08:51.253

好的，你可以做的是确定上个月的第一天的星期几，取你想要的星期几和星期几之间的差，然后加上7 *你想要的周数（不到一周）...

```
// Let's get the 3rd Friday of last month:

// get starting date
DateTime date = new DateTime();

// get first day of last month
DateTime firstOfLastMonth = date.AddMonths(-1).AddDays(-1 * (date.Day + 1));

// subtract out the day of the week (get the previous Sunday, even if it is last month)
DateTime justBeforeMonth = firstOfLastMonth.AddDays((int)firstOfLastMonth.DayOfWeek);

// Add in the DayOfWeek number we are looking for
DateTime firstFridayOfMonth = justBeforeMonth.AddDays(DayOfWeek.Friday);

// if we are still in last month, add a week to get into this month
if (firstFridayOfMonth.Month != date.AddMonth(-1).Month) { firstFridayOfMonth.AddDays(7); }

// add in 2 weeks to get the third week of the month
DateTime thirdFridayOfMonth = firstFridayOfMonth.AddDays(14); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:31:33.597

这是我想出的解决方案。如果这一天不存在（例如第 8 个星期六），GetDate() 将返回 null：

```
{
    DateTime lastMonth = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1).AddMonths(-1);
    DateTime? date = GetDate(lastMonth.Month, lastMonth.Year, DayOfWeek.Thursday, 2);
}

private static DateTime? GetDate(int month, int year, DayOfWeek dayOfWeek, int which)
{
    DateTime firstOfMonth = new DateTime(year, month, 1);

    DateTime date;
    for (date = firstOfMonth; date.DayOfWeek != dayOfWeek; date = date.AddDays(1))
        ;

    date = date.AddDays(7 * (which - 1));

    return date.Month == month && date.Year == year ? (DateTime?)date : null;
} 
```

# mono - xsp2 服务器启动错误

> ID：11832532
> 
> 赞同：0
> 
> 时间：2012-08-06T16:49:52.200
> 
> 标签：mono, xsp2

我用linux

我已经安装了单声道，当我运行命令 xsp2 时出现以下错误：

> 读取配置文件期间捕获的异常：System.NullReferenceException：对象引用未设置为 Mono.WebServer.XSP.Server+ApplicationSettings..ctor () [0x00000] 中的对象实例：0 读取配置文件期间捕获的异常：System.NullReferenceException：对象引用未设置为 Mono.WebServer.XSP.Server+ApplicationSettings..ctor () [0x00000] in :0 xsp2 中的对象实例
> 
> 监听地址：127.0.0.1
> 
> 根目录：/etc/mono
> 
> 监听端口：8080（非安全）
> 
> 点击 Return 停止服务器。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:43:18.720

我过去曾见过这种情况。但是 IIRC 在第一次请求后不会发生错误。随后的请求工作正常。

[不过，您应该在http://buzilla.xamarin.com/](http://buzilla.xamarin.com/)中将其报告为错误。另外，您是否测试过 xsp4？

# css - 在过小的 div 中居中文本

> ID：11832533
> 
> 赞同：3
> 
> 时间：2012-08-06T16:49:56.787
> 
> 标签：css, html

我试图让文本在一个固定的 div 内居中，这将允许溢出，但我似乎无法让它在 div 内居中。

我做了一个 jsfiddle 来告诉你我的意思：http: [//jsfiddle.net/mdHKZ/3/](http://jsfiddle.net/mdHKZ/3/)

问题是一旦文本开始溢出 div，它将不再居中。但是，我无法扩展 div，因为这会破坏我拥有固定宽度 div 的目的。有什么办法可以实现我想要做的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:16:42.683

我认为不可能使用直接的 css 动态地执行此操作，但如果您提前知道文本的宽度，则可以在内容上指定负边距：[jsFiddle](http://jsfiddle.net/mdHKZ/6/)

如果您想动态地执行此操作（即让文本居中在一个小 div 中，适用于任何宽度的文本），我认为您必须使用 javascript。

*编辑*：这是使用 jQuery 设置边距的更新 jsFiddle：[jsFiddle](http://jsfiddle.net/mdHKZ/10/)

HTML：

```
<div class="contents">
    <span id="hack">Sample Text Sample Text Sample Text</span>
</div> 
```

jQuery：

```
var $hack = $('#hack');
var innerWidth = $hack.width();
var outerWidth = $hack.parent().width();
if(innerWidth > outerWidth) {
    var marginLeft = -1 * (innerWidth - outerWidth)/2;
    $hack.css('margin-left', marginLeft);
} 
```

CSS：

```
.contents {
  margin-left: 150px;
  text-align: center;
  width: 100px;
  white-space: nowrap;
  border: 1px solid;
  margin-bottom: 20px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:22:55.883

你知道里面的div的宽度是多少吗？我不确定您是否能够根据可变宽度自动执行此操作。我能够以静态宽度居中：

```
<div style="margin-left: 150px; text-align: center; width: 100px; overflow: visible; white-space: nowrap; border: 1px solid; margin-bottom: 20px;">
    <div style="width:200px;margin-left:-100px;">Sample Text Sample Text SamText Sampl eple </div>
</div> 
```

我必须将宽度设置为 200px，然后用左边距减去一半。我无法让它与更通用的东西一起使用，比如“margin-left：50%”，因为它只会从外部 div 向左移动 -75px（150px 的一半）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:52:12.040

将溢出更改为“自动”而不是“可见”

# java - Java 循环更新 JLabel

> ID：11832537
> 
> 赞同：0
> 
> 时间：2012-08-06T16:50:01.043
> 
> 标签：java, swing, loops, timer

很抱歉发布另一个关于 Java swing 和循环的帖子。我已经阅读了其他人，但没有一个解决方案真正适合我。好的，现在开始讨论这个问题。我有一个扩展 JFrame 的类，其中我有一个运行秒表的计时器，如下所示：

```
class StopWatch extends TimerTask{
    public void run() {
        time.setText(String.format("%02d:%02d", minutes_elapsed,seconds_elapsed));
        seconds_elapsed++;
        if(seconds_elapsed == 60){
            seconds_elapsed = 0;
            minutes_elapsed++;
        }
    }

} 
```

现在，我的标签“时间”更新的唯一方法是当我调用 time.update(time.getGraphics()) 时，但这会覆盖上一次。有什么想法我应该做什么？我也尝试过重新绘制、验证和绘制。Paint 对我做的事情和更新一样……有什么想法吗？PS我不知道这是否重要，但我在公共 void start_timer() 函数中创建了 Timer，如下所示：

```
public void start_timer(int minutes, int seconds){
        if(timer == null)
             timer = new Timer();
        timer.scheduleAtFixedRate(new StopWatch(),0,1000);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T16:54:20.097

我怀疑您使用的是 a`java.util.Timer`而不是 a [`javax.swing.Timer`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html)。后者将确保计时器在 UI 线程上运行，我*怀疑*这是问题所在。

有关它们的教程，请参阅[“如何使用摆动计时器”](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。您需要将您`TimerTask`的转换为 ActionListener`，然后使用

```
timer.setDelay(1000);
timer.setRepeats(true);
timer.start(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T16:53:24.243

你可以这样做

```
public void run() 
{
    SwingUtilities.invokeLater(new Runnable()
    {
        @Override
        public void run()
        {
            // do stuff
        }
    }
    ));
} 
```

但你真的应该使用[`javax.swing.Timer`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html)虽然。请记住，Swing 是单线程的，因此，必须在其线程中修改其组件（即*Event Dispatch Thread*）。

# sql - 使用 em.createQuery 时出现 java.sql.SQLIntegrityConstraintViolationException

> ID：11832539
> 
> 赞同：0
> 
> 时间：2012-08-06T16:50:02.043
> 
> 标签：sql, xml, jakarta-ee, sax

所以我正在用 Sax 解析一个 Xml 文件，我想知道我的数据库中是否已经存在一个实体。我正在使用我的代码@endElement 的 createQuery 部分：

```
EntityManagerFactory factory = Persistence.createEntityManagerFactory("PU");
        em = factory.createEntityManager();
        em.getTransaction().begin();  
........
    empExisists = em.createQuery("SELECT s FROM Employee s WHERE s.userName=:userName", Employee.class). setParameter("userName", emp.getUserName()).getSingleResult(); 
```

我已经在我的应用程序的其他地方使用过这段代码，它运行良好。

现在发生了一些非常奇怪的事情，我收到了 SQLIntegrityConstraintException，因为存在主键违规。

```
Internal Exception: java.sql.SQLIntegrityConstraintViolationException: Die Anweisung wurde abgebrochen, weil sie in einer für 'EMPLOYEE' definierten Vorgabe für einen eindeutigen oder Primärschlüssel bzw. für einen von 'SQL120805145505950' bezeichneten eindeutigen Index zu einem duplizierten Schlüsselwert geführt hätte. 
```

我真的不知道为什么会出现这个异常，因为我不想在这里保留任何实体。我的持久部分位于 endDocument 中，我在其中捕获了所有 ConstraintViolationExceptions。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:43:54.697

似乎 java 在尝试执行 em.createQuery 之前总是调用 em.flush() 以保证所有数据都存储在数据库中。

我仍然不知道为什么会出现这个错误，因为我的实体管理器不应该包含任何在调用 em.createQuery 之前将被持久化的 EMPLOYEE 对象。

我现在在发生异常的 em.createQuery 之前使用 em.clear() 的解决方法。因此，我现在总是在使用 em.persist() 之后立即使用 em.fush()。

我认为这不是一个很好的解决方案，所以如果有更好的解决方案，请告诉我

# android - 如何创建幻灯片布局

> ID：11832540
> 
> 赞同：0
> 
> 时间：2012-08-06T16:50:05.333
> 
> 标签：android, android-layout, android-widget

在我的应用程序中，我将创建一个新布局，就像您看到时钟、电池等的标准 Android 一样。也就是说，它会通过手指在屏幕上的滑动打开。我该如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:09:58.167

您需要使用 ViewPager

```
 <android.support.v4.view.ViewPager
android:layout_width="match_parent" 
android:layout_height="match_parent" 
android:id="@+id/myfivepanelpager"
android:background="#234567"/> 
```

请参阅：http: [//developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

您还可以将 ViewPager 解决方案作为 Fragments 执行。这是要走的路。

# javascript - jquery div根据url显示？

> ID：11832543
> 
> 赞同：2
> 
> 时间：2012-08-06T16:50:27.443
> 
> 标签：javascript, jquery

我有以下代码

```
<html>
<head>
    <script src="jquery.js"></script>
    <script>
        $(document).ready(function () {
            $("#div1").hide();
            $("#div2").hide();
        });
    </script>

</head>
<body>
    <div id="div1">This is first Div</div>
    <div id="div2">Welcome At 2nd Div </div>
</body>
</html> 
```

网址是 index.html。如果 url 类似于 index.html#div1 和 #div2 如果 url 类似于 index.html#div2，我如何显示#div1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:52:58.687

```
$(document).ready(function){
    $("div[id^=div]").hide();
    var loc = window.location.href;
    if( loc.indexOf( '#' ) >= 0 ) {
        hash = loc.substr( loc.indexOf('#') + 1 ); // output: div1, div2 etc..
        $('#'+hash).show();
    }
}); 
```

# wpf - PrintVisual 到特定的打印机托盘

> ID：11832548
> 
> 赞同：2
> 
> 时间：2012-08-06T16:50:48.267
> 
> 标签：wpf, printing

我有一个 WPF 用户控件，我希望能够使用 PrintDialog.PrintVisual() 来打印它。我不想显示打印对话框，所以我希望能够设置特定的打印机和打印机托盘来打印它。我想出了如何打印到特定的打印机，但我需要打印到打印机的“纸盘 3”，但我不知道如何打印。

```
PrintDialog dialog = new PrintDialog();
LocalPrintServer localPrintServer = new LocalPrintServer();
PrintQueue pq = localPrintServer.GetPrintQueue("HC102-HP5SIMXX");
dialog.PrintQueue = pq;
//Set printer tray somehow
dialog.PrintVisual(myControl, "My control"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:34:38.910

更新：这里有更多信息：

[http://social.msdn.microsoft.com/Forums/en-US/windowsxps/thread/f5859148-26f1-4e89-949c-180413bc​​c898/](http://social.msdn.microsoft.com/Forums/en-US/windowsxps/thread/f5859148-26f1-4e89-949c-180413bcc898/)

[http://www.wittersworld.com/selecting-the-input-tray-when-printing-xps-documents/](http://www.wittersworld.com/selecting-the-input-tray-when-printing-xps-documents/)

您必须使用 GetPrintcapabilitiesAsXML 才能获得 InputBins 的完整列表。

* * *

您可以在 PrintCapabilities 上查询 InputBinCapability 以查询可用的 InputBin。

创建一个通过 InputBin 选择托盘的 PrintTicket。

然后通过 UserPrintTicket 告诉 PrintQueue 使用用户票

*   [http://msdn.microsoft.com/en-us/library/system.printing.printqueue.userprintticket](http://msdn.microsoft.com/en-us/library/system.printing.printqueue.userprintticket)

*   [http://msdn.microsoft.com/en-us/library/system.printing.printcapabilities.inputbincapability](http://msdn.microsoft.com/en-us/library/system.printing.printcapabilities.inputbincapability)

*   [http://msdn.microsoft.com/en-us/library/system.printing.printticket](http://msdn.microsoft.com/en-us/library/system.printing.printticket)

# filemaker - Filemaker：没有记录与请求匹配

> ID：11832554
> 
> 赞同：0
> 
> 时间：2012-08-06T16:51:15.217
> 
> 标签：filemaker

我是filemaker的新手。我正在尝试设置搜索功能，但出了点问题，`No records match the request`即使它存在，它也会返回。这是代码

```
public function get_row($table, $search='')
{
    $layout_object = $this->fm->getLayout($table);
    if (FileMaker::isError($layout_object)) {
        return array();
    }

    $request = $this->fm->newFindCommand($table);
    if ($search)
    {
        $request->addFindCriterion($search['key'], 'hh@kkk.nn'); // hardcoded. 
    }
    $result = $request->execute();
    if (FileMaker::isError($result)) {
        echo $result->getErrorString();
    }
            //.....Result: No records match the request 

} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T12:40:24.677

您需要转义 @ 符号，因为它是查找模式下的特殊字符以匹配任何一个字符，所以试试这个：

```
$request->addFindCriterion($search['key'], 'hh\@kkk.nn'); // hardcoded. 
```

# python - 用python编写一个简单的MongoDB模块

> ID：11832556
> 
> 赞同：1
> 
> 时间：2012-08-06T16:51:27.547
> 
> 标签：python, mongodb, pymongo

我已经开始编写一个简单的模块供 mongodb 使用。我是 python 新手，我写的代码有问题：

```
import pymongo

class mongoDB():

    conn = object

    def __init__(self):
        global conn
        self.conn = pymongo.Connection("localhost",27017)

    def CreateCollection(self,name =""):
        self.dbCollection  = conn.name
        return self.dbCollection

if __name__ == '__main__':
    database = mongoDB
    collection = database.CreateCollection("Hello") 
```

首先，如果您能发现并纠正我，我认为我的代码可能没有什么问题。我也不断收到这个错误：

```
collection = database.CreateCollection("Hello")
TypeError: unbound method CreateCollection() must be called with mongoDB      

instance as first argument (got str instance instead) 
```

我希望能够在类的构造函数中创建连接，然后有一个创建集合并返回它的方法，以及另一个插入删除和更新实体的方法

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-06T17:38:30.413

所以，从语法上讲，你有很多问题。看起来您正在以不同的方式混合几个教程。所以，首先我将解释你的代码发生了什么，并解释为什么你会看到你所看到的：

```
import pymongo

class mongoDB():  # you don't need ()'s here - only if you are inheriting classes
                  # you could inherit from object here, which is a good practice
                  # by doing class mongoDb(object):, otherwise you can just take
                  # them out

    conn = object # here, you're defining a class member - global for all instances
                  # generally, you don't instantiate an object pointer like this,
                  # you would set it to None instead.  It won't fail doing this,
                  # but it's not "right"

    def __init__(self):
        # the __init__ method is the constructor method - this will 
        # allow you to initialize a particular instance of your class, represented
        # by the self argument.  This method is called when you call the class, i.e.
        # inst = mongoDb()

        # in this case, the conn variable is not a global.  Globals are defined
        # at the root module level - so in this example, only pymongo is a global
        # conn is a class member, and would be accessed by doing mongoDB.conn
        global conn

        # with that being said, you're initializing a local variable here called conn
        # that is not being stored anywhere - when this method finishes, this variable
        # will be cleaned up from memory, what you are thinking you're doing here
        # should be written as mongoDB.conn = pymongo.Connection("localhost", 27017)
        conn = pymongo.Connection("localhost",27017)

    def CreateCollection(name =""):
        # there is one of two things you are trying to do here - 1, access a class 
        # level member called conn, or 2, access an instance member called conn

        # depending on what you are going for, there are a couple of different ways 
        # to address it.

        # all methods for a class, by default, are instance methods - and all of them
        # need to take self as the first argument.  An instance method of a class
        # will always be called with the instance first.  Your error is caused because
        # you should declare the method as:

        # def CreateCollection(self, name = ""):

        # The alternative, is to define this method as a static method of the class -
        # which does not take an instance but applies to all instances of the class
        # to do that, you would add a @staticmethod decorator before the method.

        # either way, you're attempting to access the global variable "conn" here,
        # which again does not exist

        # the second problem with this, is that you are trying to take your variable
        # argument (name) and use it as a property.  What python is doing here, is
        # looking for a member variable called name from the conn object.  What you
        # are really trying to do is create a collection on the connection with the
        # inputed name

        # the pymongo class provides access to your collections via this method as a
        # convenience around the method, create_collection.  In the case where you
        # are using a variable to create the collection, you would call this by doing

        # conn.create_collection(name)

        # but again, that assumes conn is what you think it is, which it isn't
        dbCollection  = conn.name
        return dbCollection

if __name__ == '__main__':
    # here you are just creating a pointer to your class, not instantiating it
    # you are looking for:

    # database = mongoDB()
    database = mongoDB

    # this is your error, because of the afore mentioned lack of 'self' argument
    collection = database.CreateCollection("Hello") 
```

我想说看看 Pep-8 (http://www.python.org/dev/peps/pep-0008/) 编码风格指南（非常有帮助）来了解如何让你的代码“流动”蟒蛇。

通过您的代码来解释发生了什么 - 这就是您最终想要做的事情：

```
import pymongo

class MongoDB: # Classes generally are camel-case, starting with uppercase
    def __init__(self, dbname):
        # the __init__ method is the class constructor, where you define
        # instance members.  We'll make conn an instance member rather
        # than a class level member
        self._conn = pymongo.Connection("localhost", 27017)
        self._db   = self._conn[dbname]

    # methods usually start with lowercase, and are either camel case (less desirable
    # by Python standards) or underscored (more desirable)
    # All instance methods require the 1st argument to be self (pointer to the
    # instance being affected)
    def createCollection(self, name=""):
        return self._db[name]

if __name__ == '__main__':
    # you want to initialize the class
    database   = MongoDB("Hello")
    collection = database.createCollection("MyTable") 
```

鉴于此 - 编写此类包装器的目标是什么？同样可以写成：

```
import pymongo
conn       = pymongo.Connection('localhost', 27017)
database   = conn["Hello"]
collection = database["MyTable"] 
```

如果您正在尝试创建一个更大的 API 围绕 pymongo 数据库，那么我建议您查看一些已经构建的 ORM 模块。有一些 - 不是 100% 确定哪些可用于 MongoDB，但我使用的（我有偏见，我写的）称为 ORB，可以在[http://docs.projexsoftware.com/找到api/orb](http://docs.projexsoftware.com/api/orb)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:42:56.480

这不是如何解决您的问题的具体答案，而是如何逐步完成您想要做的事情并在出现更简单的问题时解决问题的答案：

1) 首先忘记课程，而是

2) 使用 Python 命令行或 IDLE 之类的 Python 程序，

3) 通过编写调用打开 MongoDB 数据库来完成您的任务或任务来建立您的目标。换句话说，在担心类之前，先编写最简单的代码来实现你的目标。

4）一旦你完成了，并且感觉很好继续前进，然后使用[文档](http://docs.python.org/tutorial/classes.html)编写一个测试类。我的链接是您能找到的众多链接之一。

5）我认为您的问题的一部分但不是全部是您的课程设置不正确。我的班级 - 未完全显示 - 如下：

```
class GlobalData:
    def set_xfer_date(self, value):
        self.xfer_date = value
        self.date_str = str(value)
        self.xfer_date_base = self.date_str[0:10] + " " + "00:00:00"

        # Now build tomorrow.
        self.xfer_date_tomorrow = datetime.today() + timedelta(1)
        self.date_str_tomorrow = str(self.xfer_date_tomorrow) 
        self.xfer_date_tomorrow = \
          self.date_str_tomorrow[0:10] + " " + "00:00:00" 

        self.section_totals = {}
        self.billable_reads = {}

    def set_xfer_fnam_out(self, value):
        self.xfer_fnam_out = value

    def set_xfer_dir_in(self, value):
        self.xfer_dir_in = value
    .
    .
    .

    def get_billable_reads(self):
        return self.billable_reads 
```

我看到的问题之一是您没有使用`self.` Good lucky 来引用数据。

# php - 视图文件中的 PHP 编码错误

> ID：11832557
> 
> 赞同：0
> 
> 时间：2012-08-06T16:51:32.653
> 
> 标签：php, html, sql

> **可能重复：**
> [通过 PHP 解码数字 html 实体](https://stackoverflow.com/questions/9587751/decoding-numeric-html-entities-via-php)

我在面包屑中出现编码错误（查看文件）

我该如何解决？php还是html？

输入 =>**马达加斯加 3：欧洲头号通缉犯**

输出 =>`Madagascar 3: Europe&#x27;s Most Wanted`

我正在使用 Yii PHP 框架和 MySQL

![在此处输入图像描述](../Images/67ecec92e3c6869d84ba7ee5300c5e3a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:54:29.980

你需要使用这个`html_entity_decode`

这是一个参考[http://php.net/manual/en/function.html-entity-decode.php](http://php.net/manual/en/function.html-entity-decode.php)

# php - Wordpress + 子文件夹 + htaccess + Internet Explorer 7/9 = 重定向循环

> ID：11832564
> 
> 赞同：0
> 
> 时间：2012-08-06T16:51:44.037
> 
> 标签：php, internet-explorer, .htaccess, wordpress

我在子文件夹中使用 wordpress 设计的网站有问题。

[网站 www.risvegliati.it/blog/](http://www.risvegliati.it/blog/)

因为如果我尝试使用 Internet Explorer 浏览会出现错误 404？它与重定向一起循环：

[网站错误 http://www.risvegliati.it/blog/blog/blog/blog/blog/....](http://www.risvegliati.it/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/)

这是[http://www.risvegliati.it/的文件索引](http://www.risvegliati.it)

```
<?php 
Header( "HTTP/1.1 301 Moved Permanently" );
Header( "Location: http://www.risvegliati.it/blog" );
?> 
```

这是/blog的htaccess文件

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /blog/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /blog/index.php [L]
</IfModule>
# END WordPressenter code here 
```

建议？

# ajax - 使用 AJAX 调用将 GeoJSON 数据拉入 Leaflet

> ID：11832565
> 
> 赞同：5
> 
> 时间：2012-08-06T16:52:05.383
> 
> 标签：ajax, geojson, leaflet

因此，我正在尝试使用 Leaflet 发布 MapBox 地图，并希望通过 AJAX 调用从外部数据源添加一些标记。具体来说，我正在用[这个数据集](https://nycopendata.socrata.com/Media/Wifi-Hotspot-Locations/ehc4-fktp)绘制出纽约市的所有 wifi 热点。我看到它说我可以在 JSON 中下载 wifi 位置，但我仍在尝试自学如何编码并且不知道从那里做什么。

这是 MapBox 提供的使用站点目录上托管的 .js 的示例。如果我改为进行 AJAX 调用会是什么样子？

```
<script src="museums.js"></script>
<script type="text/javascript">
// Define a GeoJSON data layer with data
var geojsonLayer = new L.GeoJSON();

// Display the name property on click
geojsonLayer.on('featureparse', function (e) {
    if (e.properties && e.properties.name){
    e.layer.bindPopup(e.properties.name);
}
});

geojsonLayer.addGeoJSON(data);

// Add the GeoJSON layer
map.addLayer(geojsonLayer);
</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T22:22:15.050

按照您指向 wifi spot 数据集的链接，告诉我您可以从此 url 调用 json 数据：[wifi spot](https://nycopendata.socrata.com/api/views/ehc4-fktp/rows.json)

问题是生成的 json 不是 GEOJSON 格式（[维基百科](http://en.wikipedia.org/wiki/GeoJSON)）...

如果您有效地拥有一个为您提供有效 GEOJSON 的 url，您可以使用 jQuery 通过以下方式进行 Ajax 调用：

```
$.ajax({
    type: "POST",
    url: "https://nycopendata.socrata.com/api/views/ehc4-fktp/rows.json",
    dataType: 'json',
    success: function (response) {

        geojsonLayer = L.geoJson(response, {
            style: yourLeafletStyle
        }).addTo(map);
    }
}); 
```

问候

艾蒂安

# vb.net - 如何检查记录是否存在的数据库？

> ID：11832570
> 
> 赞同：0
> 
> 时间：2012-08-06T16:52:21.780
> 
> 标签：vb.net, ms-access

我使用多种形式在 vb.net 2008 上开发了该程序。

其中一种形式必须检查数据库，以查看数据库中是否存在学生 ID 号。

如果数据库中没有这样的ID号，程序应该用消息框通知用户“没有这样的ID号”，否则，如果数据库中确实存在ID号，则ID应该显示在我已经创建的dataGridView。

我正在使用 MS Access 数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T16:57:50.817

在没有看到任何代码的情况下很难给出任何示例，但您可以计算有多少学生拥有该 ID（因此，如果存在）：

```
select count(*) from [students table] where id = [The id to compare] 
```

如果 count > 0 则存在。如果不是（如果等于 0），那么它不存在，您可以显示您的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:47:37.783

我认为 DLookup() 函数非常适合您。DLookup 可以从记录集中查找特定值。如果没有匹配，它将返回 null。您可以在此处找到有关 DLookup 的更多信息：[DLookup 函数](http://office.microsoft.com/en-us/access-help/dlookup-function-HA001228825.aspx)

# c# - 制作哈希集 具有相同值的对象之间存在差异

> ID：11832581
> 
> 赞同：2
> 
> 时间：2012-08-06T16:53:17.423
> 
> 标签：c#

我已经覆盖了`Equal(Object comparee)`方法，但是当我将对象添加到我的 HashSet 时，我仍然得到双打。我错过了什么？该`MyType`类型包含两个`int`字段（假设是这样）。也许是`HashSet`错误的集合类型？

我希望添加一些`MyType`东西，但这样集合只存储唯一的东西，其中唯一的由我定义（使用`Equals`方法或任何其他方式）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T16:55:53.363

`GetHashCode()`当你覆盖时，你应该总是覆盖`Equals()`。如果可用，我通常会为该方法返回某种主键。否则，您可以查看[此线程](https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-system-object-gethashcode)以获取实现它的想法。

理解这两种方法之间关系的关键是：

*   如果两个条目具有不同的哈希码，则它们肯定不相等。
*   如果两个条目具有相同的哈希码，则它们可能相等，因此请致电 `Equals()`确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T16:55:05.690

您还需要覆盖`GetHashCode()`；否则，您的对象将具有不同的哈希码，因此将自动被假定为不同。从您的对象中获取一些独特的价值并使用它（如果可用），或者只生成您自己的。

也不要偷懒，对所有这些都使用相同的哈希码；这将破坏 a 的目的`HashSet`。

因此，对于具有两个`int`字段的示例，您可能会执行以下操作：

```
public override int GetHashCode() {
    return field1 ^ field2;
} 
```

# c# - 不断检查 SerialPort 对象以查看是否存在任何字节，如果存在则读取字节并执行功能

> ID：11832586
> 
> 赞同：0
> 
> 时间：2012-08-06T16:53:37.897
> 
> 标签：c#, multithreading, for-loop, background, lag

我正在与设备交互，需要一种方法来不断检查串行端口是否可以读取任何字节，如果是，我需要读取它们并执行不同的功能。由于我正在从事的项目，由于多种原因，我无法创建 data_received 事件。截至目前，我在一个新线程中运行了一个无限 for 循环，但它导致计算机速度变慢。

有没有人有任何其他想法？任何帮助表示赞赏。下面是我目前正在使用的 for 循环代码。

```
void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        object[] parameters = (object[])e.Argument;
        SerialPort port = (SerialPort)parameters[0];
        agentRadio agentR = (agentRadio)parameters[1];

        for (; ; )
        {
            if (port.IsOpen)
            {
                try
                {
                    if (port.BytesToRead > 0)
                    {
                        byte value = (byte)port.ReadByte();

                        if (value == Global.OFF_CHAR)
                        {
                            port.Close();
                            Global.isConnected = false;
                            Form form = new Form();
                            form.deviceDisconnect(agentR);

                            MessageBox.Show("Your device has disconnected on its own, due to inactivity or because a key was switched off.", "Device Disconnect", MessageBoxButton.OK, MessageBoxImage.Information);

                            break;
                        }
                        else if (value == Global.WARNING_CHAR[0])
                        {
                            if (Global.activeClick)
                            {
                                port.BaseStream.Write(Global.POLL_CHAR, 0, Global.POLL_CHAR.Length);
                            }
                        }
                    }
                }
                catch {  }
            }
            else
            {
                break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:01:12.407

摆脱可怕的“if (port.BytesToRead > 0)”轮询循环！你为什么这样做 - 如果检查返回错误，你什么都不做，所以让读取以正常方式阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T02:55:12.980

使用`DataReceived`事件。此事件在辅助线程上调用，无需创建另一个或事件 a `BackgroundWorker`。

# javascript - Zend 框架日期时间选择器

> ID：11832588
> 
> 赞同：0
> 
> 时间：2012-08-06T16:54:02.603
> 
> 标签：javascript, jquery, zend-framework, frameworks, zendx

我是一个真正的编程新手，终于让 ZendX Jquery 工作了。但是，我想包括一个日期时间选择器，并在[http://www.binpress.com/app/zfdatetimepicker/85](http://www.binpress.com/app/zfdatetimepicker/85)找到了一个选项。但是，文档并不完整，我真的很想正确设置它。任何人都可以帮助我完成所需的步骤吗？我尝试设置它并得到错误“对象不支持属性或方法'datetimepicker'”。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:20:20.450

听起来您需要包含 jquery UI 脚本文件。查看他的[演示](http://www.binpress.com/app/demo/app/85)，它正在从 jquery 的“代码”服务器中[引入 jQuery UI 1.8.21 。](http://code.jquery.com/ui/1.8.21/jquery-ui.min.js)我也知道，如果不包含 UI 组件，`Object doesn't support property or method 'datepicker'`当您执行类似`$('#myDate').datepicker`. 所以我假设你只是缺少正确的脚本包括。

我根本没有使用过zend-framework，所以我可能会在这方面遗漏一些东西。

# javascript - 与 datetimepicker 绑定的淘汰赛 js 给出了一个异常

> ID：11832589
> 
> 赞同：4
> 
> 时间：2012-08-06T16:54:03.047
> 
> 标签：javascript, jquery-ui, knockout.js, knockout-2.0

我想我可以很容易地用 jquery ui calendar 和 knockout.js 绑定日期数据，这要归功于[这个答案。](https://stackoverflow.com/a/6400701/1194873)

现在我需要绑定日期数据及其时间。当然，我可以使用[timepicker](http://trentrichardson.com/examples/timepicker/)。但我不确定如何将其数据与 knockout.js 绑定。我希望它类似于 datepicker 所以我制作了以下脚本

```
 ko.bindingHandlers.datetimepicker = {
        init: function (element, valueAccessor, allBindingsAccessor) {
            //initialize datepicker with some optional options
            var options = allBindingsAccessor().datetimepickerOptions || {};
            $(element).datetimepicker(options);

            //handle the field changing
            ko.utils.registerEventHandler(element, "change", function () {
                var observable = valueAccessor();
                observable($(element).datetimepicker("getDate"));//****
            });

            //handle disposal (if KO removes by the template binding)
            ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
                $(element).datetimepicker("destroy");
            });

        },
        update: function (element, valueAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor()),
                current = $(element).datetimepicker("getDate");

            if (value - current !== 0) {
                $(element).datetimepicker("setDate", value);
            }
        }
    }; 
```

`//****`但是当我运行脚本时，我在 javascript中遇到错误

```
TypeError: observable is not a function 
```

但是我在这里找不到我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:02:12.930

此特定错误是由于 observable = valueAccessor() 行造成的。您通过将 () 添加到末尾来分配给 observable valueAccessor 的值。为了以这种方式将值传递给 observable，您需要改为：

```
var observable = valueAccessor; 
```

否则， observable 不是“可观察函数”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:52:29.810

我刚刚发现以下代码正在运行。由于很少有开源代码这样做，这个插件不是很稳定，有时会调用带有 null observable 的 change 事件。所以我编写了代码来捕获异常并继续前进。

```
 ko.bindingHandlers.datetimepicker = {
        init: function (element, valueAccessor, allBindingsAccessor) {
            //initialize datepicker with some optional options
            var options = allBindingsAccessor().datetimepickerOptions || {};
            $(element).datetimepicker(options);

            //handle the field changing
            ko.utils.registerEventHandler(element, "change", function () {
                var observable = valueAccessor();
                try {
                    observable($(element).datetimepicker("getDate"));//****
                }
                catch(ex) {}
            });

            //handle disposal (if KO removes by the template binding)
            ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
                $(element).datetimepicker("destroy");
            });

        },
        update: function (element, valueAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor()),
                current = $(element).datetimepicker("getDate");

            if (value - current !== 0) {
                $(element).datetimepicker("setDate", value);
            }
        }
    }; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-29T19:32:42.573

替换此行

```
var observable = valueAccessor(); 
```

和

```
var xxxx= valueAccessor(); 
```

因为你不能使用 observable，因为它是淘汰赛中的保留关键字。

此外，如果您使用 observable 作为变量名，将来可能会在某个地方出现错误。

# javascript - 用于搜索引擎样式搜索的 JavaScript 库？

> ID：11832591
> 
> 赞同：25
> 
> 时间：2012-08-06T16:54:08.777
> 
> 标签：javascript, search

是否有可以确定字符串是否与搜索查询匹配的 JavaScript 库？它应该是高效的，并提供类似于 Google 或 LexisNexis 的高级查询功能（诸如和/或运算符、同义词和括号之类的东西）。任何一种高级搜索功能都会很棒；它不必与任何特定的搜索引擎完全匹配。

动机：我有一个带有搜索框的 HTML 页面，后跟一堆段落（它们具有唯一的 id，并且是从 JavaScript 数组生成的）。当用户在框中键入搜索查询并按 Enter 键时，如果所有段落与查询不匹配，则应隐藏所有段落（即它们的`display`设置为）。`none`

我目前的策略（使用 jQuery）：

1.  通过将查询字符串拆分为空格，将查询字符串分隔为关键字数组。
2.  用 隐藏所有段落`$('p').hide()`。
3.  对于每个关键字，用 显示包含它的段落`$('p:contains("'+keyword+'")').show()`。

这是一个非常有限的搜索功能，它区分大小写，将所有关键字视为可选关键字，并且不提供诸如 、 或括号之类的运算`and`符`or`。这也是低效的，因为它为每个关键字遍历每个字符串一次，即使它已经匹配。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-07-08T21:41:42.953

以下是我正在为项目评估的一些库（2013 年 7 月）。其中任何一个都应该能够提供搜索功能的核心。

*   [http://lunrjs.com/](http://lunrjs.com/)
    *   词干提取，内置评分
    *   13.8 kb 缩小
    *   最近更新（[https://github.com/olivernn/lunr.js/commits/master](https://github.com/olivernn/lunr.js/commits/master)）
    *   10 位贡献者
    *   没有外部依赖
*   [http://fusejs.io](http://fusejs.io)（以前在[http://kiro.me/projects/fuse.html](http://kiro.me/projects/fuse.html)）
    *   模糊搜索
    *   1.58 kb 缩小
    *   最近更新（[https://github.com/krisk/Fuse/commits/master](https://github.com/krisk/Fuse/commits/master)）
    *   1 位贡献者
    *   没有外部依赖
*   [http://reyesr.github.io/fullproof/](http://reyesr.github.io/fullproof/)
    *   使用优雅降级的 html5 存储
    *   459 kb 缩小
    *   最后更新于 2013 年（[https://github.com/reyesr/fullproof/commits/master](https://github.com/reyesr/fullproof/commits/master)）
    *   2 位贡献者
    *   没有外部依赖
*   [http://eikes.github.io/facetedsearch/](http://eikes.github.io/facetedsearch/)
    *   分页，内置模板
    *   5.70 kb 缩小
    *   最后更新于 2014 年（[https://github.com/eikes/facetedsearch/commits/master](https://github.com/eikes/facetedsearch/commits/master)）
    *   1 位贡献者
    *   取决于 jquery 和下划线

如果您想自己构建，这里有 2 种常见的词干提取算法的实现，可以帮助您入门：

*   [https://github.com/fortnightlabs/snowball-js](https://github.com/fortnightlabs/snowball-js)
*   [http://tartarus.org/martin/PorterStemmer/](http://tartarus.org/martin/PorterStemmer/)

至于处理布尔逻辑搜索运算符，也许[这个关于 js 查询解析器](https://stackoverflow.com/questions/5235384/search-expressions-parser-written-in-javascript)的问题会很有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T12:03:29.757

最好的（简单而好的）方法是使用向量搜索算法。

首先取每个段落中的所有单词并将它们保存在一个向量对象中（如何构建稍后解释）并比较每个段落向量的查询向量的关系

然后在每个单词上使用[Porter 词干分析器](https://github.com/jedp/porter-stemmer)将其聚集在一起，例如孩子和孩子。

```
var Vector = function(phar) {

var self = this;
self.InitVector = function () {
    var wordArray = self.spltwords(phar);
    self.VectorSize = wordArray .length;
    var stemdWordArray = self.runPotterStemmer(wordArray);
    self.VectoData = self.GroupAndCountWords(stemdWordArray) ;
}
self.VectoData = {}; 

self.runPotterStemmer = function(arr){
    // run potter as seen in link
}

self.spltwords= function(arr) {
    // run split
}

self.GroupAndCountWords = function(arr) {
    for (var i=0; i<arr.length; i++) {
        if (VectoData[arr[i]] === undefined) {
            VectoData[arr[i]] = 0;     
        } else {
            VectoData[arr[i]] = VectoData[arr[i]] +1;        
        }
    }
}  
self.compare = function(queryVector) {
    // compare queryVector to current vector and return a similarity number
    // number of similar words count in query divided by the length of paragraph                       
}                        
self.InitVector()
return self; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-25T17:15:44.110

免责声明 - 我是作家。

你也可以试试 ItemsJS。这是一个支持全文、分面和排序的 JavaScript 搜索引擎。

您将在下面找到一个交互式示例 - ItemsJS + VueJS：

```
var configuration = {
  searchableFields: ['title', 'tags', 'actors'],
  sortings: {
    name_asc: {
      field: 'name',
      order: 'asc'
    }
  },
  aggregations: {
    tags: {
      title: 'Tags',
      size: 10
    },
    actors: {
      title: 'Actors',
      size: 10
    },
    genres: {
      title: 'Genres',
      size: 10
    }
  }
}

// the rows comes from external resources
// https://github.com/itemsapi/itemsapi-example-data/blob/master/jsfiddle/imdb.js
itemsjs = itemsjs(rows, configuration);

var vm = new Vue({
  el: '#el',
  data: function () {

    // making it more generic
    var filters = {};
    Object.keys(configuration.aggregations).map(function(v) {
      filters[v] = [];
    })

    return {
      query: '',
      // initializing filters with empty arrays
      filters: filters,
    }
  },
  methods: {
    reset: function () {
      var filters = {};
      Object.keys(configuration.aggregations).map(function(v) {
        filters[v] = [];
      })

      this.filters = filters;
      this.query = '';
    }
  },
  computed: {
    searchResult: function () {

      var result = itemsjs.search({
        query: this.query,
        filters: this.filters
      })
      return result
    }
  }
});
```

```
<script src="https://cdn.rawgit.com/itemsapi/itemsapi-example-data/master/jsfiddle/imdb.js"></script>
<script src="https://cdn.rawgit.com/itemsapi/itemsjs/master/dist/itemsjs.js"></script>
<script src="https://cdn.jsdelivr.net/vue/latest/vue.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet"/>
<div id="el">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <a class="navbar-brand" href="#" v-on:click="reset()">ItemsJS movies</a>
      </div>
      <div id="navbar">
        <form class="navbar-form navbar-left">
          <div class="form-group">
            <input type="text" v-model="query" class="form-control" placeholder="Search">
          </div>
        </form>
      </div><!--/.nav-collapse -->
    </div>
  </nav>

  <div class="container" style="margin-top: 50px;">

    <h1>List of items ({{ searchResult.pagination.total }})</h1>

    <p class="text-muted">Search performed in {{ searchResult.timings.search }} ms, facets in {{ searchResult.timings.facets }} ms</p>

    <div class="row">
      <div class="col-md-2 col-xs-2">
        <div v-for="facet in searchResult.data.aggregations">
          <h5 style="margin-bottom: 5px;"><strong style="color: #337ab7;">{{ facet.title }}</strong></h5>

          <ul class="browse-list list-unstyled long-list" style="margin-bottom: 0;">
            <li v-for="bucket in facet.buckets">
            <div class="checkbox block" style="margin-top: 0; margin-bottom: 0;">
              <label>
                <!--<input class="checkbox" type="checkbox" v-on:click="updateFilters(facet.name, bucket.key)" v-model="filters[bucket.key]" value="{{ bucket.key }}" v-bind:value="isChecked2()">-->
                <!--<input class="checkbox" type="checkbox" v-on:click="updateFilters(facet.name, bucket.key)" v-model="filters[bucket.key]" v-bind:value="bucket.key">-->
                <input class="checkbox" type="checkbox" v-model="filters[facet.name]" v-bind:value="bucket.key">
                {{ bucket.key }} ({{ bucket.doc_count }}) 
              </label>
            </div>
            </li>
          </ul>
        </div>
      </div>

      <div class="col-md-10 col-xs-10">
        <div class="breadcrumbs"></div>
        <div class="clearfix"></div>
        <!--<h3>List of items ({{ searchResult.pagination.total }})</h3>-->
        <table class="table table-striped">
          <tbody>
          <tr v-for="item of searchResult.data.items">
            <td><img style="width: 100px;" v-bind:src="item.image"></td>
            <td></td>
            <td>
              <b>{{ item.name }}</b>
              <br />
              {{ item.description }}
            </td>
            <td></td>
            <td>
              <span style="font-size: 12px; display: block; float: left; background-color: #dbebf2; border-radius: 5px; padding: 1px 3px 1px 3px; margin: 2px;" v-for="tag in item.tags">{{ tag }}</span>
            </td>
          </tr>
          </tbody>
        </table>
        <div class="clearfix"></div>
      </div>

      <div class="clearfix" style="margin-bottom: 100px;"></div>
    </div>
  </div>
</div>
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-28T11:39:21.683

我在搜索和 NLP 领域从事过一些开源 javascript 项目。[您可以结帐`search-index`](https://github.com/fergiemcdowall/search-index)似乎接近您正在寻找的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-21T16:57:16.883

PEG.js 和 boolean-search.js 都是获取一些解析库的有用库。

[https://pegjs.org/](https://pegjs.org/)

[https://www.npmjs.com/package/boolean-parser](https://www.npmjs.com/package/boolean-parser)

[https://www.npmjs.com/browse/keyword/lucene](https://www.npmjs.com/browse/keyword/lucene)

希望有帮助。

# ms-access - 什么是向我的访问表写入记录？

> ID：11832592
> 
> 赞同：0
> 
> 时间：2012-08-06T16:54:09.160
> 
> 标签：ms-access

我正在对正在创建的表单进行故障排除。我注意到每次打开表单时都会在我的一个表中错误地写入一些记录（其中也有很多子表单）。我查看了 OnCurrent 方法并没有看到任何东西。所以我开始添加一些断点，看看是否可以缩小范围。这就是奇怪的地方。如果我删除断点，果然，记录会按照我的描述写入。但是，如果我添加断点，然后缓慢地单击每个断点（例如在每个断点上等待几秒钟），则不会写入记录。但是如果我快速点击，记录确实会被写入，就像我根本没有断点时一样。

所以我的问题是，在没有启用断点的情况下，什么样的事情会导致访问做一件事，而仅仅通过添加断点并慢慢点击来做另一件事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:03:45.370

如果不用细梳子（听起来你已经做过），它可能是一百万件事情。其中一种形式可以在其中包含用于在打开或关闭时插入记录的代码。可能是一个计时器循环（可能是为了增加插入记录的延迟），并且有人忘记关闭/停止循环。还可能有一个模块或类似触发器（来自 SQL Server 的触发器），在访问字段时会调用它们。
同样，没有看到数据库或任何代码，很难说。

# wordpress - 从 URL 将图像上传到 Wordpress

> ID：11832594
> 
> 赞同：0
> 
> 时间：2012-08-06T16:54:10.647
> 
> 标签：wordpress

我正在为 Wordpress 网站创建用户提交的发布工具。

用户可以输入图像 URL，我希望将其与标题和帖子内容等其他内容一起添加到帖子中。

我已经使用常规图像附件完成了这项工作。我创建帖子，然后使用此脚本附加图像：

```
 $files = $_FILES['upload_attachment'];

 $file = array(
    'name' => $files['name'],
    'type' => $files['type'],
    'tmp_name' => $files['tmp_name'],
    'error' => $files['error'],
    'size' => $files['size']
);

$_FILES = array("upload_attachment" => $file);

foreach ($_FILES as $file => $array) {
     $newupload = insert_attachment($file,$userPost);
    } 
```

但是我怎样才能使用`insert_attachment()`或类似但使用 URL 来做同样的事情呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:15:52.647

我认为您可以使用[file_get_contents()](http://www.php.net/manual/en/function.file-get-contents.php)和[file_put_contents()](http://www.php.net/manual/en/function.file-put-contents.php)。你可能不得不做这样的事情：

```
file_put_contents('your_file_on_server.xxx', file_get_contents('http://someurl.com/filename.xxx')); 
```

这将从指定的 url 下载文件并将其保存到您的服务器。从那里您可以稍微修改原始代码以将其附加到帖子中。

# java - Speedup HashSet and HashMap performance

> ID：11832604
> 
> 赞同：3
> 
> 时间：2012-08-06T16:54:39.473
> 
> 标签：java, integer, hashmap, hashset

In Java, I have:

```
Set<Integer> set = new HashSet<Integer>();
callVoidMethod(set);
...
public static void callVoidMethod(Set<Integer> set) {

    Set<Integer> superset = new HashSet<Integer>(set);
    ...
    // I just added this loop to show that I'm adding quite a lot
    // well, it depends on conditions, sometimes I add nothing,
    // but it is unpredictable and do not know if add something
    for (int i = 0; i < 1000; i++) {
         ...
         if (conditionSatisfied) superset.add(someValue);
         ...
    }

} 
```

The code above is simplified, the idea is to pass the set by reference into a void method and create a full copy of a set such that we will be able to add some new elements to the copy (superset here) and do not touch the set as we need it untouched when we exit the void method.

My code works with lots of data processing and if there is no faster way to make a copy, then I would like to optimize the `HashSet` itself, for instance I do not need `Integer`s as keys, but better primitive `int`s. Would be a good idea to implement an `int[]` array of keys in the `MyHashSet`?

If so is possible, I would be interested in using the same idea for improving this:

```
Map<Integer, ArrayList<Item>> map = new HashMap<Integer, ArrayList<Item>>(); 
```

**EDIT**: I need only speed-performance-optimization. I do not need beautiful-maintainable code and memory.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T16:58:46.690

In general, if you're looking for high speed collections that allow for primitives, consider using [Trove](http://trove4j.sourceforge.net/). I would say - don't optimize unless you've discovered that this is actually a bottleneck. You or someone else will need to maintain this code, and reading an optimized version is often harder.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T17:03:03.340

Have you tried first tweaking the HashSet's initial capacity and load factor?

[HashSet](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#HashSet%28int,%20float%29)

Here's a post that might help you.

[HashMap initialization parameters](https://stackoverflow.com/questions/434989/hashmap-intialization-parameters-load-initialcapacity)

If you have such a big amount of data to process, it would probably payoff to analyze it's distribution and adjust these settings first.

Having tweaked that, it might give a very slight performance to replace Integers with ints, but it might depend more on JVM implementation specifics and hardware configuration than what this improvement alone would give you.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-06T17:00:40.460

What do you do with these objects later? If you're just doing lookups or something like that, it might be faster to keep them separate and check both, rather than making a full copy. So,

```
public static void callVoidMethod(Set<Integer> set) {

    Set<Integer> superset = new HashSet<Integer>();
    ...
    if (conditionSatisfied) superset.add(someValue);

    ...
    if(set.contains(value) || superset.contains(value))
        doSomething();

} 
```

# marklogic - MarkLogic 特定的方式（或更快的方式）进行位置查询？

> ID：11832605
> 
> 赞同：1
> 
> 时间：2012-08-06T16:54:44.473
> 
> 标签：marklogic

我有以下有效的查询，但速度很慢，因为我猜它必须查看每个文档而不是使用索引：

```
xquery version "1.0-ml";

declare namespace appl="http://ap.org/schemas/03/2005/appl";
declare namespace appls="http://ap.org/schemas/09/2011/applsearch";

let $p := cts:and-query((
      cts:element-range-    query(xs:QName("appls:ArrivalDateTime"),">=",fn:dateTime(xs:date("2003-01-01"), xs:time("00:00:00"))),
      cts:element-range-query(xs:QName("appls:ArrivalDateTime"),"<=",fn:dateTime(xs:date("2003-01-31"), xs:time("23:59:59"))),
      cts:element-value-query(xs:QName("appl:MediaType"), "text")
      ))

let $results := cts:search(fn:doc(), $p, "unfiltered")
return
 for $result in $results

where cts:contains($result//appl:block/appl:p[position()=last()], "information from:")
return fn:document-uri($result) 
```

我尝试使用 cts:element-word-query 并打开标点符号敏感选项​​，但我相信由于空间限制，我们没有在数据库中索引它，所以它不起作用。

希望有任何关于如何加快或改进它的建议。如果添加索引是我唯一的办法，我想我可以回到我们的管理员那里看看有什么可能，但希望我不必走那条路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:31:52.207

我不认为真的有一个包含单个元素位置的索引。恐怕最好的解决方案是复制`appl:p[position()=last()]`元素并给它一个唯一的名称，这样你就可以`cts:element-value-query`直接使用它。

如果 where 子句过滤掉了很多**误报**，并且如果这些案例根本不包含`appl:p`值为 'information from:' 的 a，那么使用 a`cts:element-word-query`可能会有很大帮助。

您不一定需要使用索引`element-word-queries`。

！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T14:17:25.370

我不确定这`unfiltered`对这个查询有多大帮助：大部分时间可能会花在`cts:contains`表达式上。一般来说，内置过滤速度非常快。

无论如何，我会尝试的第一件事是将 a 添加`cts:element-word-query(xs:QName('appl:p'), "information from")`到`and-query`at `$p`。但也要保持`cts:contains`表情。通过这种方式，索引查找可以检查任何`appl:p`元素中的“信息”，这应该会消除一些文档。那么`cts:contains`应该有更少的工作要做。如果内容结构允许，您可以通过将“//appl:block”步骤替换为完整路径来帮助它。如果只有一个 last-p，您还可以编写表达式，使其在找到第一个后停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T18:45:08.540

您还可以在摄取时标记最后一个（例如 make it `<appl:p last="true">...</appl:p>`），以便您可以利用索引来避免 where 子句。

# facebook-graph-api - 一旦永久弃用该权限，使用 offline_access 的用户访问令牌究竟会发生什么？

> ID：11832606
> 
> 赞同：0
> 
> 时间：2012-08-06T16:54:46.380
> 
> 标签：facebook-graph-api, authentication, oauth, access-token

我们目前有许多用户拥有offline_access 用户令牌，我们使用这些令牌代表他们管理页面。我已经阅读了[删除 offline_access](https://developers.facebook.com/roadmap/offline-access-removal)指南并且大部分更改都很清楚，但是我们想澄清一个未知数。

在永久弃用offline_access 之后，我们将切换到使用非过期页面access_tokens。我们对新用户的工作流程进行了彻底的测试，发现将短期令牌交换为长期令牌，然后使用长期用户 access_tokens 检索未过期的页面 access_tokens 没有问题。

我的查询与使用现有的 offline_access access_tokens 检索未过期的页面令牌有关。上述指南中“场景 5：页面访问令牌”的最后一句表明您应该能够使用长期存在的 access_tokens 或 offline_access access_tokens 来检索未过期的页面访问令牌，但是当我们使用离线访问令牌进行测试时，返回的页面 access_tokens 有 2 个月的到期日期。

正如指南在场景 2 中所述，offline_access 令牌只会在永久弃用权限时将其到期日期截断为 60 天，我们假设此时所有 offline_access 令牌都将转换为长期用户令牌。

如果这个假设是正确的，我们就没有问题，因为我们已经知道使用长寿命用户令牌获得的页面 access_tokens 没有过期。然而，如果这个假设是不正确的并且offline_access 令牌只会在弃用时给出一个到期日期，我们就会遇到一个问题，因为使用offline_access 令牌检索的页面访问令牌似乎会过期。

有人能够证实这个假设吗？

tl;dr 当offline_access 权限被弃用时，现有的offline_access access_tokens 是否会被转换为长寿命用户access_tokens，或者只是给他们一个到期日？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:09:16.370

[http://developers.facebook.com/roadmap/offline-access-removal/](http://developers.facebook.com/roadmap/offline-access-removal/)

> 场景 2：如果您之前请求过 offline_access - 更新于 2012 年 4 月 30 日
> 
> 启用迁移后，现有使用 access_tokens 和 offline_access 权限将继续工作，而不会更改其到期时间。但是，您的应用程序的新用户将不会在 Auth 对话框中被提示授予 offline_access 权限，并且会收到一个短期或长期的 access_token，具体取决于您的环境以及您请求 access_token 的方式（客户端或服务器端 OAuth ，请参见下面的场景 3 和 4）。
> 
> 在offline_access 删除日期之后（请参阅路线图了解确切日期），所有现有的offline_access access_tokens 的到期时间将被截断为60 天。这种截断对用户来说是透明的，您的应用程序将继续正常运行；当这种截断发生时，Facebook 将通过每周开发人员汇总发送更新消息。

# jsf-2 - 使用 f:param 传递参数时 f:ajax 不起作用

> ID：11832607
> 
> 赞同：2
> 
> 时间：2012-08-06T16:54:46.233
> 
> 标签：jsf-2, facelets

我正在点击链接调用一个方法。以下代码 ajaxfully 工作

```
 <ui:repeat value="#{myBean.names}" var="name"
                               varStatus="idx">
                        <li>
                            <h:commandLink value="#{name.label}">
                                <f:ajax execute="@this" event="click" render="@all" listener="#{myBean.changeActiveName}" >
                                </f:ajax>
                            </h:commandLink>
                        </li>
                    </ui:repeat> 
```

但是当我尝试将参数传递给 Ajax 调用时，它开始刷新整个页面

```
 <ui:repeat value="#{myBean.names}" var="name"
                               varStatus="idx">
                        <li>
                            <h:commandLink value="#{name.label}">
                                <f:ajax execute="@this" event="click" render="@all" listener="#{myBean.changeActiveName}" >
                                    <f:param name="idx" value="#{idx}" />
                                </f:ajax>
                            </h:commandLink>
                        </li>
                    </ui:repeat> 
```

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:11:06.680

`<f:param>`必须是父组件的子`UICommand`组件，而不是`<f:ajax>`.

```
<h:commandLink value="#{name.label}">
    <f:param name="idx" value="#{idx}" />
    <f:ajax listener="#{myBean.changeActiveName}" render="@all" />
</h:commandLink> 
```

*（请注意，我删除了`execute`and`event`属性，因为您的定义已经是默认值；另外，我想知道将整个`IterationStatus`实例作为请求参数发送有什么用处……也许您只是想发送索引？改用`#{idx.index}`左右）*

### 也可以看看：

*   [如何将选定的行传递给 dataTable 中的 commandLink？](https://stackoverflow.com/questions/4994458/how-can-i-pass-a-parameter-to-a-commandlink-inside-a-datatable)（虽然这处理`<h:dataTable>`，完全相同的答案也适用`<ui:repeat>`）

# python - 使用 mod_wsgi 部署烧瓶应用程序

> ID：11832611
> 
> 赞同：5
> 
> 时间：2012-08-06T16:55:09.677
> 
> 标签：python, apache, mod-wsgi, flask, web-deployment

我正在尝试将我的 Flask 应用程序之一部署到 apache 上的 mod_wsgi，但我遇到了麻烦，因为 apache 试图解决文件系统上的一些路由：

**阿帕奇的错误日志：**

```
[Mon Aug 06 19:18:38 2012] [error] [client ::1] File does not exist: 
/srv/http/webchat/src/_publish_message, referer: http://localhost:88/webchat/chat 
```

我说的是“一些路由”，因为身份验证（在“/”上）和重定向到“/chat”有效。

路由“_publish_message”通过 AJAX 访问，如下所示（使用 jQuery）：

```
function publish_message(e){
    e.preventDefault();
    $.post('/_publish_message', {'message': "user's message taken from a text field"})
        .fail(Handler.publish_error);
} 
```

路由“_sse_stream”用作事件源的 URL。

这两个都不行！

虚拟主机配置：

```
<VirtualHost *:88>
    ServerName webchat.dev

    WSGIDaemonProcess webchat user=http group=http threads=5
    WSGIScriptAlias /webchat /srv/http/webchat/src/webchat.wsgi
    WSGIScriptReloading On

    DocumentRoot /srv/http/webchat/src

    <Directory /srv/http/webchat/src>
        WSGIProcessGroup webchat
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    </Directory>
</VirtualHost> 
```

`webchat.wsgi`文件：

```
import sys
sys.path.insert(0, '/srv/http/webchat/src')
from index import app as application 
```

一个基本的“hello world”应用程序部署`mod_wsgi`运行正常。我的烧瓶应用程序在使用集成到烧瓶中的开发服务器运行时表现良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:48:31.780

使用此链接遵循正确的流程。您必须使用 $SCRIPT_ROOT 变量。

[flask.pocoo.org/docs/patterns/jquery](http://flask.pocoo.org/docs/patterns/jquery)

# php - Magento：需要获取产品选项的 Catalog_Product_Option ID

> ID：11832612
> 
> 赞同：0
> 
> 时间：2012-08-06T16:55:15.777
> 
> 标签：php, mysql, magento

我的产品有多种选择。所有这些都将复制到其他产品中。该设计是高度定制的，因此我需要在代码本身中传递选项。

设置它们不是问题，我已经弄清楚了。问题是我只使用在 HTML 中传递的选项的 1 个产品。我正在寻找的是 PHP 来获取某些选项值，以便正确配置。

```
<dl>            
<dt><label class="required"><em>*</em>Size</label></dt>
<dd class="last">
    <div class="input-box">
        <select name="options[3]" id="select_3" class=" required-entry product-custom-option" title=""  onchange="opConfig.reloadPrice()">
        <option value="" >-- Please Select --</option>
        <option value="7"  price="1" >a +$1.00</option>
        <option value="8"  price="2" >b +$2.00</option>
        <option value="9"  price="3" >c +$3.00</option>
        </select>                                
      </div>
</dd>
</dl> 
```

我需要的是 PHP 从数据库中获取值

```
name="options[3]"

id="select_3" 
```

我可以在数据库中看到这些，但我不知道如何将它们拉出来并在代码中回显它们。

我想我需要一个首先识别产品的代码，然后基于它来回显选项所需的值和 ID。

我在网上搜索了答案，但没有运气。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T04:37:19.740

尝试这个

```
$product = Mage::getModel('catalog/product')->load($product_id);    
foreach ($product->getOptions() as $o) { 
$o->getValues();
} 
```

从这里你可以找到产品的所有选项

# php - PHP重定向回用户所在的位置

> ID：11832617
> 
> 赞同：1
> 
> 时间：2012-08-06T16:55:37.337
> 
> 标签：php

假设我有这个脚本：

[http://www.example.com/profile.php?uid=12345](http://www.example.com/profile.php?uid=12345)

在这个脚本中，有一个由 sendmessage.php 处理的发送消息功能。sendmessage.php 实际所做的是将某些内容插入数据库，然后重定向回用户开始的位置（profile.php?uid=12345）。

我尝试使用标头（“位置：profile.php”）。

但是由于 profile.php 在 URL 中需要 ?uid=12345 [并且它是动态的]，因此我的重定向计划不起作用。

如何“传递”当前 URL。在我的情况下，使用 GET 方法将 'profile.php?uid=12345' 发送到 sendmessage.php。然后，一旦 sendmessage.php 完成处理，将用户返回到他们自己的屏幕 (profile.php?uid=12345)？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:57:38.343

尝试这个：

```
header("Location: " . $_SERVER['HTTP_REFERER']); 
```

来自 PHP.net 的注释：

`The address of the page (if any) which referred the user agent to the current page. This is set by the user agent. Not all user agents will set this, and some provide the ability to modify HTTP_REFERER as a feature. In short, it cannot really be trusted.`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:14:02.303

如果您`profile.php?uid=12345`使用表单向其发送数据，`sendmessage.php` 那么您可以有一个隐藏字段，例如 -

`<input type="hidden" name="redirect_to" value="<?=$_SERVER['REQUEST_URI']?>">`

然后在`sendmessage.php`你可以使用`header("Location: ".$_REQUEST['redirect_to']);`'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T16:57:48.037

一个技巧是在链接本身中填充信息，这样当您转到不同的页面时，这些参数仍然存在......如果您愿意，您可以使用一个参数作为以前的 url。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T19:42:02.270

您可以使用 GET 和一些 javascript。使用这种方法可以避免使用 PHP 的 header 函数的问题。

```
echo "<script type=\"text/javascript\"> window.location = \"profile.php?uid=" . $_GET["uid"] .    "\"</script>"; 
```

确保检查“uid”是否实际通过。您还可以在用户首次登录时将 uid 存储在会话变量中，然后在我的示例中使用它，从而避免使用 GET。无论哪种方式都有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:10:44.620

另一种选择是确保将 uid 作为表单提交数据的一部分发送。

然后您可以使用传入的值重建 URL：

header("位置：profile.php?uid=" . $_GET["uid"]);

或者，将用户 ID 存储在他们的会话中。这样，它总是在 $_SESSION["uid"] 中可用，并且您不必记住在表单中创建一个无关紧要的字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T17:12:13.267

您应该将变量传递给 sendmessage.php

```
sendmessage.php?uid=<?php echo (isset($_GET['uid']) ? (INT)$_GET['uid'] : 'default') ?> 
```

然后在 sendmessage.php 上。使用类似的东西

```
header("Location: profile.php?uid=" . (isset($_GET['uid']) ? (INT)$_GET['uid'] : 'default') ); 
```

# c - 根据它的索引从结构中获取原语

> ID：11832619
> 
> 赞同：1
> 
> 时间：2012-08-06T16:55:46.370
> 
> 标签：c, struct

我有以下

```
typedef struct{

GLfloat x;

GLfloat y;

GLfloat z;

}Vertex3D; 
```

我想使用一个 for 循环。是否可以根据其索引从结构中指定您想要的原语。例如，如果我想使用数字 0 表示 x 1 表示 y 和 2 表示 z 就像一个数组？

感谢您的所有回复。我想我会改用数组。希望避免它，但很好。GC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:00:27.550

你可以使用

```
((GLfloat *)&Vertex3D)[i]; 
```

但这很丑陋。

编辑：正如下面的答案所指出的，这在技术上甚至可能行不通。有可能（尽管对于这种特殊情况不太可能）元素将被填充并且在内存中不连续。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:06:10.317

不合法。结构的元素可能会在内存中对齐，但我强烈建议不要这样做，这可能会在以后引起很多麻烦，尤其是当您发现结构以后需要其他成员时。

请尝试：

```
typedef struct
{
    GLfloat c[3];
}Vertex3D; 
```

和

```
#define VERTEX_X 0
#define VERTEX_Y 1
#define VERTEX_Z 2 
```

然后访问：

```
Vertex3D v;
v.c[VERTEX_X] = 5.5; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:02:29.067

不，不干净。你可以做

```
Vertex3D v;
float *pv = (float*)&v;
/* use pv[0],pv[1],pv[2] */ 
```

从技术上讲，这是未定义的行为，但*在这种特殊情况下*，我不希望任何广泛使用的编译器/OS/CPU 组合出现问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:06:34.700

您可以利用结构存储在内存中的方式，但我建议不要这样做。因为所有元素在内存中彼此相邻，您可以将其视为一个数组，这在技术上是一种未定义的行为，但只要您的结构中的所有内容都是相同的类型，就不会导致任何问题（因为它基本上是一个数组）。

这是我为证明这一点而制作的测试程序

```
#include <stdio.h>

typedef struct {
    int x;
    int y;
    int z;
} Point;

int main() {

    Point test = {1, 2, 3};

    printf("x: %d\ty: %d\tz: %d\n", test.x, test.y, test.z);

    int *ptest = (int *) &test;

    for (int i = 0; i < 3; i++)
        printf("%d\n", ptest[i]);

    return 0;
} 
```

按预期工作

# perl - 需要在 perl 中转置一个 LARGE csv 文件

> ID：11832625
> 
> 赞同：-3
> 
> 时间：2012-08-06T16:56:06.827
> 
> 标签：perl, csv, large-files, transpose

csv 数据文件总共 3.2 GB，天知道有多少行和列（假设很大）。该文件是一个基因组学数据，其中包含一组个体的 SNP 数据。因此，csv 文件包含 ID`TD102230`和遗传数据，例如`A/A`和`A/T`。

现在我使用了`Text::CSV`和`Array::Transpose`模块，但似乎无法正确使用（因为计算集群冻结了）。是否有特定的模块可以做到这一点？我是Perl新手（底层编程经验不多，以前主要使用R和MATLAB）所以特别欢迎详细解释！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:04:14.717

将任务分解为几个步骤以节省内存。

1.  读取一行并将字段写入以行号命名的文件中。每场输出一行。
2.  重复步骤 1，直到输入 CSV 文件用完。
3.  使用[paste](http://www.gnu.org/software/coreutils/manual/html_node/paste-invocation.html)将所有输出文件合并为一个大文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:05:21.140

作为直接答案，您应该逐行读取文件，使用 处理它们`Text::CSV`，将新值推送到数组中，每个数组对应于原始列，然后将它们输出为`join`or like 以获得原始的转置表示。之后立即处理每个数组`join`也将有助于解决内存问题。

将值写入外部文件而不是数组并将它们与操作系统设施连接是另一种解决内存需求的方法。

您还应该考虑为什么需要这个。真的没有更好的方法来解决手头的实际任务，因为转置本身并没有真正的目的吗？

# python - 如何让 python 等到 Excel 宏/刷新完成

> ID：11832628
> 
> 赞同：3
> 
> 时间：2012-08-06T16:56:28.490
> 
> 标签：python, excel, win32com, vba

我正在使用 Python 在 excel 中运行宏。我希望 Python 关闭 excel。宏刷新 excel 中的数据连接，这可能很慢。

我如何让 python 等到刷新完成才能关闭。这就是我正在使用的，我在 xl.Quit 之前需要一些东西，它会等到宏中的刷新完成？？？？

```
 import win32com.client
 import os

 xl = win32com.client.DispatchEx("Excel.Application")
 wb = xl.workbooks.open("X:\Backoffice\Options Trading\BloombergRate.xlsm")
 xl.Visible = True
 xl.run("Refresh")
 xl.Quit() 
```

等等我可以做这个工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:09:51.963

编辑您的`Refresh`宏以将[`QueryTable.BackgroundQuery`](http://msdn.microsoft.com/en-us/library/office/ff839478.aspx)属性设置为`False`. 这应该会导致宏阻塞，直到它完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T10:23:19.063

您甚至不必设置宏来运行它。win32com 有一个本地方法来刷新所有数据连接。

```
import win32com.client
import os

xl = win32com.client.DispatchEx("Excel.Application")
wb = xl.workbooks.open("X:\Backoffice\Options Trading\BloombergRate.xlsm")
xl.Visible = True
wb.RefreshAll()
xl.Quit() 
```

# arrays - 将超过 256 列的 CSV 文件导入 Excel 2003

> ID：11832631
> 
> 赞同：0
> 
> 时间：2012-08-06T16:56:44.227
> 
> 标签：arrays, vba, csv, import

我喜欢将一些 375 列的 csv 文件导入到 excel 2003 中。但是 excel 2003 将列数限制为 256。

*由于相关性，我必须编辑这个问题*

我有几个 CSV 文件，它们正好有 375 列和不同的行数。如何删除包含不必要信息的每一秒（奇数）列。不需要的列是从数字 5 到 375（5、7、9、...373、375）。
是否有一个有用的解决方案可以使用**VBS**中的脚本删除所有不需要的列？

我会继续努力寻求解决方案，并在此先感谢您。

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T07:26:55.693

看看 CSV 编辑器。它们通常允许您删除列。您必须指定要删除的列（即您将无法通过内容删除列）。但是您应该能够删除足够的内容以在 Excel 中查看/编辑。您也可以从 Csv 编辑器剪切/粘贴到 Excel 中。

这里有几个（前 2 个免费，后 2 个有 30 天试用期）

[http://csved.sjfrancke.nl/](http://csved.sjfrancke.nl/)
[http://recsveditor.sourceforge.net/](http://recsveditor.sourceforge.net/)

[http://www.whitepeaksoftware.com/killink-csv-editor/](http://www.whitepeaksoftware.com/killink-csv-editor/)

[http://www.gammadyne.com/csv_editor_pro.htm](http://www.gammadyne.com/csv_editor_pro.htm)

您也可以谷歌“CSV 编辑器”/查看 SourceForge 了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-13T18:45:50.790

**很长一段时间没有回应......** 我尝试了几个 CSV 编辑器（免费或可购买），但似乎没有人可以通过在标题中包含字符串“percent”来删除列）。只有**ReCsvEditor_0.80.6**正在使用过滤器，但过滤器似乎无法正常工作。

**如果有人有合适的 VBS (WSH) 脚本解决方案，我将不胜感激。**

# javascript - Jquery动画功能不起作用

> ID：11832632
> 
> 赞同：0
> 
> 时间：2012-08-06T16:56:48.967
> 
> 标签：javascript, jquery

我正在使用以下 javascript 为 div 设置动画，但 div 没有设置动画...有谁知道可以是什么？

JavaScript：

```
 <script language="JavaScript">   
    $(document).ready(function(){
    $('#LayoutDiv1').animate({top: "500px"}, 1500); }); 
    </script> 
```

HTML：

```
<div id="LayoutDiv1">
    <img src="images/logo.png">
</div> 
```

CSS：

```
#LayoutDiv1 {
    clear: both;
    float: left;
    width: 100%;
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:04:32.173

工作演示：http: [//jsfiddle.net/LRuZp/3/](http://jsfiddle.net/LRuZp/3/)

在定义 top、left、bottom 和 right 属性时，应指定 position 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:08:09.397

你需要将你的`div`位置设置为`relative`

```
#LayoutDiv1 {
    clear: both;
    float: left;
    width: 100%;
    display: block;

    position: relative

} 
```

# php - 条带重定向网址

> ID：11832633
> 
> 赞同：6
> 
> 时间：2012-08-06T16:56:49.917
> 
> 标签：php, stripe-payments

我正在尝试将用户连接到我的 Stripe 帐户。 [https://stripe.com/docs/apps/getting-started](https://stripe.com/docs/apps/getting-started) 我尝试将重定向 url 设置为 localhost。然后我得到一个错误，而不是 safari 无法打开页面“”，因为 safari 无法连接到服务器“”。有谁知道我应该将重定向网址设置为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-22T19:18:54.147

您不能将重定向 url 设置为 localhost，服务器将尝试重定向到它的 localhost。使用公共域或 ip 设置重定向 url。

# android - android服务启动活动没有像我认为的那样做出反应

> ID：11832635
> 
> 赞同：0
> 
> 时间：2012-08-06T16:57:10.383
> 
> 标签：android, service, bluetooth

我一直在开发一个程序来监听蓝牙消息以在我的手机上启动各种应用程序。如果显示主布局，则以下每一项都可以正常工作，但是一旦调用其中一个命令，另一个命令将无法正确响应。这是两个命令的代码：

```
if (readMessage.equals("Button"))
{
    Intent i = new Intent(Intent.ACTION_MAIN);
    PackageManager manager = getPackageManager();
    i = manager.getLaunchIntentForPackage("com.google.android.apps.maps");
    Log.d("Main","i is:  "+ i);
    i.addCategory(Intent.CATEGORY_LAUNCHER);
    startActivity(i);
    Log.d("Main","Map pushed");
}
if (readMessage.equals("Home"))
{
    Intent startMain = new Intent(Intent.ACTION_MAIN);
    startMain.addCategory(Intent.CATEGORY_HOME);
    startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(startMain);
    Log.d("Main","Home pushed");
} 
```

因此，例如发送消息主页，应用程序将显示主屏幕。但是，如果在显示主屏幕并发送消息“按钮”之后没有任何反应，但我知道代码是从日志中调用的。

我是否需要将我的消息处理程序放入它自己的服务中？

这是两个java文件：

主要的：

```
package com.lorenjz.phoneremotefive;

import java.lang.Thread.State;
import java.util.ArrayList;
import java.util.Set;

import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.app.Activity;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.content.ComponentName;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.OnSharedPreferenceChangeListener;
import android.content.pm.PackageManager;
import android.util.Log;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.preference.PreferenceActivity;
import android.preference.PreferenceManager;

public class MainRemote extends Activity {

    private static TextView btstatus=null;
    private Button closeButt;
    private TextView ringtone=null;
    private TextView checkbox2=null;
    private Boolean serverState = false;

    //declerations:

    private BluetoothAdapter btAdapter;

    public ArrayList myArray;
    public ArrayList devArray;

    private int myContext;
    private BlueStuff mChatService = null;

    // Message types sent from the BluetoothChatService Handler
    public static final int MESSAGE_STATE_CHANGE = 1;
    public static final int MESSAGE_READ = 2;
    public static final int MESSAGE_WRITE = 3;
    public static final int MESSAGE_DEVICE_NAME = 4;
    public static final int MESSAGE_TOAST = 5;

    public static final String DEVICE_NAME = "device_name";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_remote);

        btstatus=(TextView)findViewById(R.id.btstatus);
        closeButt=(Button)findViewById(R.id.close);
        /**checkbox=(TextView)findViewById(R.id.checkbox);
        checkbox2=(TextView)findViewById(R.id.checkbox2);**/

        SharedPreferences prefs=PreferenceManager
                .getDefaultSharedPreferences(this);
        //checkbox.setText(new Boolean(prefs.getBoolean("checkbox", false))
            //    .toString());
        Boolean servState = (new Boolean(prefs.getBoolean("serverstate", false)).booleanValue());
        if (servState = true){
            Log.d("Main","It thinks the server should be on");
            //checkbox2.setText(new Boolean(prefs.getBoolean("checkbox2", false))
                //    .toString());
            mChatService = new BlueStuff(getBaseContext(), mHandler);
            int stateString = mChatService.getState();
            Log.d("Main","chat service:  " + stateString);
            //+ mChatService.getState()
            mChatService.start();
        }
        int stateString = mChatService.getState();
        Log.d("Main","After stuff happens. chat service:  " + stateString);
        btstatus.setText("No Connection yet");
        setupUI();

        closeButt.setOnClickListener(new OnClickListener(){
            public void onClick(View v) {

                mChatService.stop();
            }
        });
    }

    @Override
    public void onResume() {
        super.onResume();

        SharedPreferences prefs=PreferenceManager
                .getDefaultSharedPreferences(this);
        //checkbox.setText(new Boolean(prefs.getBoolean("checkbox", false))
            //    .toString());
        String servState = (new Boolean(prefs.getBoolean("serverstate", false)).toString());
        Log.d("Main","Server State:  " +servState);
        //checkbox2.setText(new Boolean(prefs.getBoolean("checkbox2", false))
            //    .toString());

           // Performing this check in onResume() covers the case in which BT was
        // not enabled during onStart(), so we were paused to enable it...
        // onResume() will be called when ACTION_REQUEST_ENABLE activity returns.
        if (mChatService != null) {
            // Only if the state is STATE_NONE, do we know that we haven't started already
            if (mChatService.getState() == BlueStuff.STATE_NONE) {
              // Start the Bluetooth chat services
              mChatService.start();
              startService(new Intent(this, BlueStuff.class));

            }
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.activity_main_remote, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {       
            case R.id.menu_settings:
            startActivity(new Intent(this, PreferencesB.class));        
            return true;      
        }  

        return(super.onOptionsItemSelected(item));
    }

     public void setupUI(){

    }

    private final Handler mHandler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
                case MESSAGE_STATE_CHANGE:
                    //if(D) Log.i("Main", "MESSAGE_STATE_CHANGE: " + msg.arg1);
                    switch (msg.arg1) {
                        case BlueStuff.STATE_CONNECTED:
                            Toast.makeText(getApplicationContext(), "Connected", Toast.LENGTH_SHORT).show();
                            //setStatus(getString(R.string.title_connected_to, mConnectedDeviceName));
                            //mConversationArrayAdapter.clear();
                            break;
                        case BlueStuff.STATE_CONNECTING:
                            Toast.makeText(getApplicationContext(), "Connecting", Toast.LENGTH_SHORT).show();
                            //setStatus(R.string.title_connecting);
                            break;
                        case BlueStuff.STATE_LISTEN:
                            Toast.makeText(getApplicationContext(), "Listening", Toast.LENGTH_SHORT).show();
                            break;
                        case BlueStuff.STATE_NONE:
                            //setStatus(R.string.title_not_connected);
                            break;
                    }
                    break;
                /**case MESSAGE_WRITE:
                    byte[] writeBuf = (byte[]) msg.obj;
                    // construct a string from the buffer
                    String writeMessage = new String(writeBuf);
                    mConversationArrayAdapter.add("Me:  " + writeMessage);
                    break;**/
                case MESSAGE_READ:
                    byte[] readBuf = (byte[]) msg.obj;
                    // construct a string from the valid bytes in the buffer
                    String readMessage = new String(readBuf, 0, msg.arg1);
                    //mConversationArrayAdapter.add(mConnectedDeviceName+":  " + readMessage);
                    //Toast.makeText(getApplicationContext(), "Message:  " + readMessage, Toast.LENGTH_SHORT).show();
                    if (readMessage.equals("Button"))
                    {
                        /**Intent startMain = new Intent(Intent.ACTION_MAIN);
                        startMain.addCategory(Intent.CATEGORY_HOME);
                        startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        startActivity(startMain);**/

                        Intent i = new Intent(Intent.ACTION_MAIN);
                        PackageManager manager = getPackageManager();
                        i = manager.getLaunchIntentForPackage("com.google.android.apps.maps");
                        Log.d("Main","i is:  "+ i);
                        i.addCategory(Intent.CATEGORY_LAUNCHER);
                        startActivity(i);
                        Log.d("Main","Map pushed");

                        /**Intent launch_intent = new Intent("android.intent.action.MAIN");
                        launch_intent.addCategory("android.intent.category.LAUNCHER");
                        launch_intent.setComponent(new ComponentName("com.google.android.maps", "map"));
                        launch_intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

                        startActivity(launch_intent);**/
                    }
                    if (readMessage.equals("Home"))
                    {
                        Intent startMain = new Intent(Intent.ACTION_MAIN);
                        startMain.addCategory(Intent.CATEGORY_HOME);
                        startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        startActivity(startMain);
                        Log.d("Main","Home pushed");
                    }
                    break;
                /**case MESSAGE_DEVICE_NAME:
                    // save the connected device's name
                    mConnectedDeviceName = msg.getData().getString(DEVICE_NAME);
                    Toast.makeText(getApplicationContext(), "Connected to "
                                   + mConnectedDeviceName, Toast.LENGTH_SHORT).show();
                    break;
                case MESSAGE_TOAST:
                    Toast.makeText(getApplicationContext(), msg.getData().getString(TOAST),
                                   Toast.LENGTH_SHORT).show();
                    break;**/
            }
        }
    };

    final static void updateBTStatus(int mState){
        Log.d("Main", "update called.  mState is:  " + mState);
        btstatus.setText("prior to switch");
        statusTry();

        switch(mState){
            case 1:
                btstatus.setText("Listening for connection");
                Log.d("Main","Status should be listening for connection");
            case 2:
                btstatus.setText("Connecting");
            case 3:
                btstatus.setText("Connected");
        }

    }

    public static void statusTry(){
        btstatus.setText("post switch try");
    }
} 
```

蓝色的东西：

```
package com.lorenjz.phoneremotefive;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.UUID;

import android.app.Service;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothServerSocket;
import android.bluetooth.BluetoothSocket;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.os.IBinder;
import android.os.Message;
import android.util.Log;
import android.widget.Toast;

public class BlueStuff extends Service{

    private static final String TAG = "Blue";

    private static final boolean D = true;

    private final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");
    private final String NAME = "Zimmer";
    //private BluetoothAdapter mBluetoothAdapter;

    private final BluetoothAdapter mAdapter;
    private final Handler mHandler;
    private int mState;

    public static final int STATE_NONE = 0;       // we're doing nothing
    public static final int STATE_LISTEN = 1;     // now listening for incoming connections
    public static final int STATE_CONNECTING = 2; // now initiating an outgoing connection
    public static final int STATE_CONNECTED = 3;  // now connected to a remote device

    private ConnectThread mConnectThread;
    private ConnectedThread mConnectedThread;
    private AcceptThread mSecureAcceptThread;
    private AcceptThread mInsecureAcceptThread;

    /**
     * Constructor. Prepares a new BluetoothChat session.
     * @param context  The UI Activity Context
     * @param handler  A Handler to send messages back to the UI Activity
     */
    public BlueStuff(Context context, Handler handler) {
        mAdapter = BluetoothAdapter.getDefaultAdapter();
        mState = STATE_NONE;
        mHandler = handler;
    }

    /**
     * Return the current connection state. */
    public synchronized int getState() {
        return mState;
    }

    /**
     * Start the chat service. Specifically start AcceptThread to begin a
     * session in listening (server) mode. Called by the Activity onResume() */
    public synchronized void start() {
        if (D) Log.d(TAG, "start");

        // Cancel any thread attempting to make a connection
        if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}

        // Cancel any thread currently running a connection
        if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}

        setState(STATE_LISTEN);

        if (mInsecureAcceptThread == null) {
            mInsecureAcceptThread = new AcceptThread();
            mInsecureAcceptThread.start();
        }
    }

    public void stop(){
        mConnectedThread.cancel();
    }

    /**
     * Set the current state of the chat connection
     * @param state  An integer defining the current connection state
     */
    private synchronized void setState(int state) {
        if (D) Log.d(TAG, "setState() " + mState + " -> " + state);
            mState = state;

        // Give the new state to the Handler so the UI Activity can update
        mHandler.obtainMessage(MainRemote.MESSAGE_STATE_CHANGE, state, -1).sendToTarget();
    }

    class AcceptThread extends Thread {
        private final BluetoothServerSocket mmServerSocket;

        public AcceptThread() {

            // Use a temporary object that is later assigned to mmServerSocket,
            // because mmServerSocket is final
            BluetoothServerSocket tmp = null;
            try {
                // MY_UUID is the app's UUID string, also used by the client code

                //tmp = mAdapter.listenUsingRfcommWithServiceRecord(NAME, MY_UUID);
                tmp = mAdapter.listenUsingRfcommWithServiceRecord(NAME, MY_UUID);
            } catch (IOException e) { }
            Log.d("Blue","Listen Failed tmp 1c:  " + tmp);

            mmServerSocket = tmp;
            Log.d("Blue","mmServerSocket 1:  " + mmServerSocket);
            MainRemote.updateBTStatus(mState);
        }

        public void run() {
            Log.d("Blue","Run Called");
            BluetoothSocket socket = null;
            // Keep listening until exception occurs or a socket is returned
            while (true) {
                try {
                    Log.d("Blue","mmServerSocket 2:  " + mmServerSocket);
                    socket = mmServerSocket.accept();
                }
                catch (IOException e) {
                    break;
                }
                // If a connection was accepted
                /** if (socket != null) {
                    // Do work to manage the connection (in a separate thread)
                    //manageConnectedSocket(socket);
                    //mmServerSocket.close();
                    Log.d("Blue","Connection was accepted");
                    MainRemote.updateBTStatus(mState);
                    break;
                }**/
                if (socket != null) {
                    synchronized (BlueStuff.this) {
                        switch (mState) {
                            case STATE_LISTEN:
                            case STATE_CONNECTING:
                                // Situation normal. Start the connected thread.
                                connected(socket, socket.getRemoteDevice());
                                break;
                            case STATE_NONE:
                            case STATE_CONNECTED:
                                // Either not ready or already connected. Terminate new socket.
                                try {
                                    socket.close();
                                } catch (IOException e) {
                                    Log.e(TAG, "Could not close unwanted socket", e);
                                }
                                break;
                        }
                    }
                }
            }
        }

        /** Will cancel the listening socket, and cause the thread to finish */
        public void cancel() {
            try {
                mmServerSocket.close();
            } catch (IOException e) { }
        }
    }

    class ConnectThread extends Thread {
        final BluetoothSocket mmSocket;
        private final BluetoothDevice mmDevice;

        public ConnectThread(BluetoothDevice device) {
            // Use a temporary object that is later assigned to mmSocket,
            // because mmSocket is final
            BluetoothSocket tmp = null;
            mmDevice = device;

            // Get a BluetoothSocket to connect with the given BluetoothDevice
            try {
                // MY_UUID is the app's UUID string, also used by the server code
                tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
            } catch (IOException e) { }
            mmSocket = tmp;
        }

        public void run() {
            // Cancel discovery because it will slow down the connection
            mAdapter.cancelDiscovery();

            try {
                // Connect the device through the socket. This will block
                // until it succeeds or throws an exception
                mmSocket.connect();
            } catch (IOException connectException) {
                // Unable to connect; close the socket and get out
                try {
                    mmSocket.close();
                } catch (IOException closeException) { }
                return;
            }

            // Do work to manage the connection (in a separate thread)
            //manageConnectedSocket(mmSocket);
        }

        /** Will cancel an in-progress connection, and close the socket */
        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) { }
        }
    }

    class ConnectedThread extends Thread {
        private final BluetoothSocket mmSocket;
        private final InputStream mmInStream;
        private final OutputStream mmOutStream;

        public ConnectedThread(BluetoothSocket socket) {
            mmSocket = socket;
            InputStream tmpIn = null;
            OutputStream tmpOut = null;

            // Get the input and output streams, using temp objects because
            // member streams are final
            try {
                tmpIn = socket.getInputStream();
                tmpOut = socket.getOutputStream();
            } catch (IOException e) { }

            mmInStream = tmpIn;
            mmOutStream = tmpOut;
        }

        public void run() {
            byte[] buffer = new byte[1024];  // buffer store for the stream
            int bytes; // bytes returned from read()

            // Keep listening to the InputStream until an exception occurs
            while (true) {
                try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);
                    // Send the obtained bytes to the UI activity
                    mHandler.obtainMessage(MainRemote.MESSAGE_READ, bytes, -1, buffer)
                            .sendToTarget();
                    Log.d("Blue","message recieved!:  " + bytes);
                } catch (IOException e) {
                    break;
                }
            }
        }

        /* Call this from the main activity to send data to the remote device */
        public void write(byte[] bytes) {
            try {
                mmOutStream.write(bytes);
            } catch (IOException e) { }
        }

        /* Call this from the main activity to shutdown the connection */
        public void cancel() {
            try {
                mmSocket.close();
            } catch (IOException e) { }
        }
    }
    /**
     * Start the ConnectedThread to begin managing a Bluetooth connection
     * @param socket  The BluetoothSocket on which the connection was made
     * @param device  The BluetoothDevice that has been connected
     */
    public synchronized void connected(BluetoothSocket socket, BluetoothDevice
            device) {
        //if (D) Log.d(TAG, "connected, Socket Type:" + socketType);

        // Cancel the thread that completed the connection
        if (mConnectThread != null) {mConnectThread.cancel(); mConnectThread = null;}

        // Cancel any thread currently running a connection
        if (mConnectedThread != null) {mConnectedThread.cancel(); mConnectedThread = null;}

        // Cancel the accept thread because we only want to connect to one device
        if (mSecureAcceptThread != null) {
            mSecureAcceptThread.cancel();
            mSecureAcceptThread = null;
        }
        if (mInsecureAcceptThread != null) {
            mInsecureAcceptThread.cancel();
            mInsecureAcceptThread = null;
        }

        // Start the thread to manage the connection and perform transmissions
        mConnectedThread = new ConnectedThread(socket);
        mConnectedThread.start();

        // Send the name of the connected device back to the UI Activity
        Message msg = mHandler.obtainMessage(MainRemote.MESSAGE_DEVICE_NAME);
        Bundle bundle = new Bundle();
        bundle.putString(MainRemote.DEVICE_NAME, device.getName());
        msg.setData(bundle);
        mHandler.sendMessage(msg);

        setState(STATE_CONNECTED);
    }

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:07:10.943

并不是什么都没有发生。它的活动没有重新创建。尝试覆盖 onStart() 我敢打赌这会被调用。

# cocos2d-iphone - 如何使用 Cocos2d 创建更高效 的肖像画廊？

> ID：11832636
> 
> 赞同：0
> 
> 时间：2012-08-06T16:57:21.817
> 
> 标签：cocos2d-iphone, nsmutablearray, gallery, ccsprite, parallax

我正在构建一个具有肖像画廊（如博物馆）的应用程序，我的角色从左到右从左到左走过它们。我的肖像（图像）都是 2048x2048。我还没有减小它们的尺寸，因为我想确保它们可以用于 iPad 版本。我知道它们的大尺寸是一个问题，因为当我尝试一次加载所有它们时它会崩溃（即使只有 10 张图像也需要很长时间才能启动）。

话虽如此，我真正的问题是尝试创建一种有效的方法来根据需要添加/删除它们（精灵）。我想出了一些可行的方法，但这显然不是最好的方法。

我希望有人可以提出一种更有效的方法。

这是我的代码。您可以假设另一种方法负责将图像加载到一个名为 framedSprites 的可变数组中（由于大小/崩溃，我一次只能加载 10 个）。每次屏幕位置发生变化（通过 TouchMoved 滑动）时，都会调用以下方法 (checkPosition)。正如我所看到的，我将不得不为数组中的每个图像/肖像创建类似的语句（非常低效且耗时）......

```
-(void)checkPosition {

CGSize winSize = [CCDirector sharedDirector].winSize;

for (CCSprite *sprite in framedSprites) {

    if (sprite.tag == 2) {

        if ((sprite.position.x > 2000.0f)&&(sprite.position.x < 2010.0f)) {

            CCSprite *portrait = (CCSprite *)[_backgroundNode getChildByTag:0];

            if (portrait.tag == 0) {

                NSLog(@"Removing a Portrait Left 2 Places From This One");

                 [_backgroundNode removeChildByTag:0 cleanup:YES];

            }
        }

        if ((sprite.position.x > 1980.0f)&&(sprite.position.x < 1990.0f)) {

            CCSprite *portrait = (CCSprite *)[_backgroundNode getChildByTag:0];

            if (portrait == nil) {

                CCSprite * framedSprite = (CCSprite *)[framedSprites objectAtIndex:0];

                NSLog(@"Adding a Portrait Left, 2 Places From This One");

                framedSprite.position = ccp(600,winSize.height/2);  //figuring these positions is also not efficient and time consuming

                [_backgroundNode addChild:framedSprite z:0 parallaxRatio:ccp(0.4f,0.5f) positionOffset:framedSprite.position];

            }
        } 
    }
}   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:57:08.177

您应该只需要一次加载 3 张图像以允许在任一方向滚动（假设您也不允许在 y 方向移动）。显示的那个，任一侧作为缓冲区，然后根据需要延迟加载和替换。

如果您不需要一次查看整个图像，您还可以考虑使用 Tilen 等免费工具将其切割成图块 (http://itunes.apple.com/gb/app/tilen/id409199185?mt=12)然后根据需要加载瓷砖。

# node.js - redis 和 watch + multi 允许并发用户

> ID：11832637
> 
> 赞同：1
> 
> 时间：2012-08-06T16:57:24.427
> 
> 标签：node.js, transactions, load, redis

我正在对使用相同电子邮件地址的 Web 服务的用户注册进行负载测试，同时连接的前 10 个用户将始终注册。

我正在使用 WATCH 和 MULTI，但这似乎不起作用。

我正在调用 save() 来保存用户。

```
this.insert = function(callback) {
    this.preInsert();

    created = new Date();
    updated = new Date();

    // Also with these uncommented it still doesn't work
    // Common.client.watch("u:" + this.username);
    // Common.client.watch("em:" + this.email);

    console.log(ID + " email is locked " + this.email);
    Common.client.multi()
    .set("u:" + this.username, ID)
    .hmset("u:" + ID, 
        {"username": this.username
        ,"password": this.password
        ,"email": this.email
        ,"payment_plan": payment_plan
        ,"created": created.getTime()
        ,"updated": updated.getTime()
        ,"avatar": this.avatar})
    .zadd("u:users", 0, ID)
    .sadd("u:emails", this.email)
    .set("u:"+ ID + ":stats", 0)
    .set("em:" + this.email, ID)
    .exec();

    this.postInsert();

    if (callback != null)
        callback(null, this);
}

this.save = function(callback) {
    // new user
    if (ID == -1) {
        var u = this;

        Common.client.watch("u:" + this.username);
        Common.client.exists("u:" + this.username, function(error, exists) {
            // This username already exists
            if (exists == 1) {
                Common.client.unwatch();
                if (callback != null)
                    callback({code: 100, message: "This username already exists"});
            }
            else {
                Common.client.watch("em:" + u.email);
                Common.client.get("em:" + u.email, function(err, emailExists) {
                    if (emailExists != null) {
                        Common.client.unwatch();
                        if (callback != null)
                            callback({code: 101, message: "This email is already in use"});
                    }
                    else {
                        Common.client.incr("u:nextID", function(error, id) {
                            if (error) callback(error);
                            else {
                                ID = id;
                                u.insert(callback);
                            } 
                        });
                    }
                });
            }
        });
    }
    // existing user
    else {
        var u = this;
        Common.client.get("em:" + this.email, function(err, emailExists) {
            if (emailExists != ID && emailExists) {
                if (callback != null) {
                    callback({code: 101, message: "This email is already in use " + ID + " " + emailExists});
                }
            }
            else {
                u.update(callback);
            }
        });
    }
} 
```

输出几乎总是：

```
1 email is locked test@test.com
2 email is locked test@test.com
3 email is locked test@test.com
4 email is locked test@test.com
5 email is locked test@test.com
6 email is locked test@test.com
7 email is locked test@test.com
8 email is locked test@test.com
9 email is locked test@test.com
10 email is locked test@test.com 
```

我做错了什么还是redis无法处理那么多并发。这也是Common的定义：

```
var Common = {
    client: redis.createClient(),
...
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:46:45.807

是的！经过一晚的休息，解决方案当然是在淋浴时找到了我。

问题是我为整个应用程序使用了一个 redis 线程，并且所有连接都在该线程上注册了手表。当然，它并不表示密钥已被其他客户端修改，因为没有其他客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T18:11:51.643

我知道这个线程是 8 个月大，但无论如何，我的想法仍然可以帮助某人。有一个问题我仍然无法理解，我什至启动了我自己的线程，专门针对这个问题[Redis WATCH MULTI EXEC 由一个客户端](https://stackoverflow.com/questions/15776955/redis-watch-multi-exec-by-one-client)，我指的是你的。我现在使用“每个事务的连接”方法，这意味着如果我需要使用 WATCH-MULTI-EXEC 进行事务，我会创建新的连接。在其他原子操作的情况下，我使用连接，它是在应用程序启动期间创建的。不确定此方法是否有效，因为创建新连接意味着创建 + 授权，这会产生延迟，但它有效。

# python - 如何指定python请求http put body？

> ID：11832639
> 
> 赞同：56
> 
> 时间：2012-08-06T16:57:32.617
> 
> 标签：python, http, put, httplib2, python-requests

我正在尝试使用 requests 模块重写一些旧的 python 代码。目的是上传附件。邮件服务器需要以下规范：

```
https://api.elasticemail.com/attachments/upload?username=yourusername&api_key=yourapikey&file=yourfilename 
```

有效的旧代码：

```
h = httplib2.Http()        
        resp, content = h.request('https://api.elasticemail.com/attachments/upload?username=omer&api_key=b01ad0ce&file=tmp.txt', 
        "PUT", body=file(filepath).read(), 
        headers={'content-type':'text/plain'} ) 
```

没有找到如何在请求中使用正文部分。

我设法做到了以下几点：

```
 response = requests.put('https://api.elasticemail.com/attachments/upload',
                    data={"file":filepath},                         
                     auth=('omer', 'b01ad0ce')                  
                     ) 
```

但不知道如何用文件内容指定正文部分。

谢谢你的帮助。奥马尔。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-08-06T17:25:54.337

从[文档中引用](https://requests.readthedocs.io/en/master/user/quickstart/#more-complicated-post-requests)

> **data –（可选）要在****Request**正文中发送的字典或字节。

所以这*应该*有效（未经测试）：

```
 filepath = 'yourfilename.txt'
 with open(filepath) as fh:
     mydata = fh.read()
     response = requests.put('https://api.elasticemail.com/attachments/upload',
                data=mydata,                         
                auth=('omer', 'b01ad0ce'),
                headers={'content-type':'text/plain'},
                params={'file': filepath}
                 ) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-04-03T18:25:44.813

我使用 Python 和它的请求模块让这个东西工作。有了这个，我们可以提供一个文件内容作为页面输入值。请参阅下面的代码，

```
import json
import requests

url = 'https://Client.atlassian.net/wiki/rest/api/content/87440'
headers = {'Content-Type': "application/json", 'Accept': "application/json"}
f = open("file.html", "r")
html = f.read()

data={}
data['id'] = "87440"
data['type']="page"
data['title']="Data Page"
data['space']={"key":"AB"}
data['body'] = {"storage":{"representation":"storage"}}
data['version']={"number":4}

print(data)

data['body']['storage']['value'] = html

print(data)

res = requests.put(url, json=data, headers=headers, auth=('Username', 'Password'))

print(res.status_code)
print(res.raise_for_status()) 
```

如果您有任何疑问，请随时询问。

* * *

**注意**：在这种情况下，请求的主体被传递给`json`kwarg。

# mysql - 如何通过触发器创建表作为插入的数据之一

> ID：11832645
> 
> 赞同：-5
> 
> 时间：2012-08-06T16:58:00.167
> 
> 标签：mysql, sql, sql-server, tsql, sql-server-2008-r2

我想要一个在将数据添加到表时创建表的触发器。表名必须是插入的条目的名称。

`paitientDetail` 示例：当患者在医院登记时，表格中会插入一行。触发器必须创建包含患者姓名的表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:21:55.840

在我回答这个问题之前，我必须先说**这是一个糟糕的主意**。 *请不要为每个患者创建一个新表。* 这会给你带来很多问题。

例如，如果您有 100 个患者，那么您将有 100 个表。那么，如果您需要为每个患者返回数据，您会怎么做……您将一团糟。

在 SQL Server 中，如果您想要执行此类过程，您可以通过以下方式执行此操作：

**样品表**：

```
CREATE TABLE [dbo].[Test](
    [id] [int] NOT NULL,
    [name] [varchar](50) NOT NULL
) ON [PRIMARY] 
```

`Your Trigger`将使用动态 SQL 从插入的数据中检索名称。：

```
CREATE TRIGGER dbo.testTrg
   ON  dbo.test
   AFTER INSERT
AS 
BEGIN
    SET NOCOUNT ON;

    declare @newtable varchar(50)
    set @newtable = (select quotename(name) from inserted)

    declare @sql varchar(max)

    set @sql = 'create table ' + @newtable + '
        ( 
            [id] [int] NOT NULL, 
            [newColumn1] [varchar](50) NOT NULL
        ) ON [PRIMARY]' 

    exec(@sql)

END 
```

此触发器将创建表：

```
CREATE TABLE [dbo].[test1](
    [id] [int] NOT NULL,
    [newColumn1] [varchar](50) NOT NULL
) ON [PRIMARY] 
```

以下是对患者更好的设计。拥有一张患者表格，然后您将根据需要拥有其他表格，以包括患者的任何其他详细信息：

```
Patient Table:
id int, -- PK
name varchar(50)

Doctor Table
id int, -- PK
name varchar(50)

Patient_Doctor table
p_id int,  -- PK -- FK to Patient Table
d_id int  -- PK  -- FK to Doctor Table 
```

# eclipse - An internal error occurred during: "Updating Maven Project

> ID：11832647
> 
> 赞同：55
> 
> 时间：2012-08-06T16:58:07.793
> 
> 标签：eclipse, maven

when i convert to maven project the error is :

```
> An internal error occurred during: "Updating Maven Project".
> Unsupported IClasspathEntry kind=4 
```

what's the problem?

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-11-24T21:32:13.910

This is all you need:

1.  Right-click on your project, select Maven -> Disable Maven Nature.
2.  Open you terminal, go to your project folder and do “mvn eclipse:clean”</li>
3.  Right click on your Project and select “Configure -> Convert into Maven Project”</li>

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-05T20:19:16.013

Here is what worked for me: After the steps posted in Answer 21 above (the last being Convert to Maven Project), I did:

1.  `mvn eclipse:eclipse` - this regenerates your .project and .classpath files (both of which were blown away by `mvn eclipse:clean` in step (2) above)

2.  In Eclipse, I right-clicked my project(s) and then Maven > Update Project

I did not see the `Unsupported IClasspathEntry kind=4` message anymore :)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-10-09T15:42:57.790

As posted [here](http://alsdias.blogspot.com.ar/2013/07/eclipse-maven-import-error-internal.html), the problem is the command line eclipse project generation. So, do not use mvn eclipse:eclipse instead do:

1.  delete your project from eclipse (without deleting it from your file system)
2.  do mvn eclipse:clean in your command line inside your project folder
3.  delete .classpath .project .settings in your project folder (if they still exist after doing 2.)
4.  in eclipse import your project as an "Existing Maven Projects" and it should work flawlessly

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T13:05:52.123

Revert back to an earlier commit/change fixes the problem.... so it could be some corrupted project/mvn file issue, somehow. So, I followed the steps to clean up and then import the project.It worked after a couple attempts.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-26T08:58:29.527

An internal error occurred during: "Importing Maven projects". Unsupported IClasspathEntry kind=4

1.  Right-click on your project, select Maven -> Remove Maven Nature. 2.Open you terminal, go to your project folder and do “mvn eclipse:clean” 3.Right click on your Project and select “Configure -> Convert into Maven Project”</li>

also delete project from eclipse. and run: mvn eclipse:clean then import project again.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-03T09:14:40.230

In my case the problem was a .settings-folder commited to svn. it contained the wrong settings (in my case the jdk was set to wrong location). So deleting .settings on svn and doing a clean checkout did it.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-09T18:44:06.187

Following worked for me: Right-click project, select Maven -> Remove Maven Nature. Close Eclipse go to project folder on command prompt and do “mvn eclipse:clean” Start Eclipse Right click on Project and select “Configure -> Convert into Maven Project”</p>

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-11T14:13:29.683

I meet the same problem before when I import a project as a maven project. what I did is like is right click project and choose Maven -> Update Project... (Alt-F5) on the context menu. In the Update Maven Project dialog, ensure that "Update project configuration from pom.xml" is checked. Then press OK.

The issue should be resolved.

Another way is, you go to Problem tab, and find the Error, there is a hint saying that right click it and use Quick fix to resolve the problem.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-20T07:26:03.107

This issue has been fixed in m2e 1.5.0 which is available for Eclipse Kepler (4.3) and Luna (4.4)

Please see [https://bugs.eclipse.org/bugs/show_bug.cgi?id=374332#c14](https://bugs.eclipse.org/bugs/show_bug.cgi?id=374332#c14)

The problem is caused by the fact that STS (the Spring IDE/Eclipse), as well Eclipse and other Eclipse based IDE's, use the m2e(clipse) plugin but that eclipse:eclipse has been probably been run on the project. When m2e encounters a "var" .classpath entry, it throws this error.

The update sites are specified at the following url: [http://download.eclipse.org/technology/m2e/milestones/1.6/](http://download.eclipse.org/technology/m2e/milestones/1.6/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-08-27T03:27:10.327

1.  Switch to terminal and type command `mvn eclipse:clean`
2.  Right-click on you project, select Maven -> Update Project

Okay, everything is settled

# c# - 如何通过 windows shell (iDropTarget) 填充列表或视图

> ID：11832649
> 
> 赞同：0
> 
> 时间：2012-08-06T16:58:17.887
> 
> 标签：c#, treeview, windows-shell, shell-extensions

我有一个带有树视图的小 WinForms 应用程序。我可以拖放文件和目录，并且可以通过在其上拖放一个或多个文件或目录/使用命令行（args）来启动程序。我想不通的是如何进行外壳扩展以允许资源管理器的多个部分启动它。

有没有人有一个小示例说明使用 shell 扩展和 GUI 和/或从命令行填充某种类型的列表或视图？

我将非常感谢您的帮助！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T19:41:15.523

虽然不完全是 iDropTarget 的答案，但此链接为我的问题提供了解决方案： [The Weekly Source Code 31- Single Instance WinForms and Microsoft.VisualBasic.dll](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx)

# c# - 是否定义了任何默认编译符号，例如 NET40 或 NET20 之类的？

> ID：11832654
> 
> 赞同：0
> 
> 时间：2012-08-06T16:58:40.680
> 
> 标签：c#

我很好奇是否存在基本上由 C# 编译器自动定义的“默认条件编译符号”。例如，编译器框架版本或任何东西。

我粗略检查了一下，没有看到任何默认值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:41:43.733

从[这个询问类似问题](https://stackoverflow.com/questions/408908/conditional-compilation-depending-on-the-framework-version-in-c-sharp#408937 "关于类似问题的问题")但以不同方式提出问题的问题

> 没有任何内置的，但您可以提供自己的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:11:28.687

在项目构建选项中，您可以启用 DEBUG 和 TRACE 常量（默认情况下基于 Active Configuration 启用/禁用 DEBUG）。据我所知，这些只是默认常量。

# c# - C# 方括号和大于/小于

> ID：11832655
> 
> 赞同：4
> 
> 时间：2012-08-06T16:58:43.637
> 
> 标签：c#, .net, f#

在 C# 中，您可能会看到如下内容：

```
[<DllImport("myUnmanagedDLL.dll")>] 
```

或类似的行（但没有大于/小于符号）：

```
[assembly: AssemblyTitle("MyProject")] 
```

我知道第一个称为属性（它具有 gt 和 lt 符号），可用于向方法、类型等添加一种元数据，但第二个的语法是什么意思？我正在尝试用这种语法将某些东西翻译成 F#——即这一行：

```
[MonoMac.Foundation.Register("AppDelegate")] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:01:38.730

> 但是第二个的语法是什么意思？

这意味着该属性被应用于程序集，而不是类型（类或结构）或成员。

在 F# 中，您尝试翻译的行应该是：

```
[<MonoMac.Foundation.Register("AppDelegate")>] 
```

然而，如果没有看到更多，就不可能知道应该在哪里应用它（类型、方法等）。`type`不过，考虑到这通常用于 C# 类，我怀疑这会继续您在 F# 中的定义。

附带说明，`[<DllImport("myUnmanagedDLL.dll")>]`不是有效的 C# - 那是 F# 语法。C#`[Attribute]`用于属性（和 VB.Net 使用`<Attribute>`）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T19:42:04.047

如果它有帮助——在 F# 中，程序集级属性通常应用于空`do`块：

```
[<assembly: AssemblyTitle("MyProject")>]
do () 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-06T17:03:58.650

我认为您将 C# 与 VB.NET 语法混淆了

在 VB.NET`<DllImport("myUnmanagedDLL.dll")>`中，在 C# 中它`[DllImport("myUnmanagedDLL.dll")]`没有大于或小于符号。

第二个是程序集属性，它用于将属性应用于整个程序集，而不仅仅是特定的类、方法或属性

# c++ - 如何定义向量

> ID：11832657
> 
> 赞同：-8
> 
> 时间：2012-08-06T16:58:45.840
> 
> 标签：c++, stdvector

我在一个类的头文件中有以下内容：

```
#include <vector>
#include <math.h> 
```

在类描述中，我有以下受保护的成员：

```
vector<Point2D>         samples; 
```

Point2D 被定义为一个类

在编译期间我收到很多错误（C2143、C4430 和 C2238）

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T17:04:31.303

除非在代码的其他部分中定义命名空间，否则您需要使用`std::vector`.

```
#include <vector>
#include <math.h>
...
std::vector<Point2D> samples; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:05:27.383

您需要链接到标准向量。 `std::vector`

# mongodb - Grails - MongoDB - 处理请求时发生 IndexOutOfBoundsException

> ID：11832660
> 
> 赞同：0
> 
> 时间：2012-08-06T16:58:59.310
> 
> 标签：mongodb, grails

我正在尝试学习 MongoDB，但在使用嵌入式域时遇到了麻烦。我的应用程序有一个问题，其中可以包含 0 个选项：

```
class Question {

    ObjectId id
    String text

    List<Option> optionList = []
    static embedded = ['optionList']
}

class Option {
    ObjectId id

    String text
    static belongsTo = [question: Question]
} 
```

现在，当我想请求使用以下 2 个选项保存问题时：

```
void testSave() {
    QuestionController questionController = new QuestionController()
    questionController.request.parameters =
        [
                "text": "test question",
                "optionList[0].text": "a",
                "optionList[1].text": "b"
        ]
    questionController.save()
} 
```

这会引发异常：

```
Invalid property 'optionList[0]' of bean class [groovy.lojzatran.anketa.Question]: Index of out of bounds in property path 'optionList[0]'; nested exception is java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
org.springframework.beans.InvalidPropertyException: Invalid property 'optionList[0]' of bean class [groovy.lojzatran.anketa.Question]: Index of out of bounds in property path 'optionList[0]'; nested exception is java.lang.IndexOutOfBoundsException: Index: 0, Size: 0 
```

当我使用静态 hasMany 将关系更改为一对多时，效果很好。

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T19:51:56.067

替换这一行：

```
List<Option> optionList = [] 
```

和

```
List<Option> optionList =  new org.springframework.util.AutoPopulatingList<Option>(Option) 
```

# sql - 在 Oracle 10g 的 SQL 过程中使用游标的任何替代方法？

> ID：11832662
> 
> 赞同：2
> 
> 时间：2012-08-06T16:59:06.323
> 
> 标签：sql, plsql, oracle10g

我为 SQL 提供了一些输入，我需要获取所有不满足所需条件的 ID 及其计数。

*我想知道是否有任何替代使用光标。*

```
DECLARE
   v_count            INTEGER;
   v_output           VARCHAR2 (1000);
   pc                 table1%ROWTYPE;
   unmarked_ids       EXCEPTION;
   dynamic_sql        VARCHAR (5000);
   cur                SYS_REFCURSOR;
   id                 pp.id%TYPE;
   pos                INTEGER;
BEGIN
   v_count := 0;
   SELECT *
     INTO pc
     FROM table1
    WHERE id = '&ID';
   DBMS_OUTPUT.ENABLE;
      dynamic_sql :=
            'SELECT ID from pp
                    WHERE ( TO_CHAR(cdate, ''yyyy/mm/dd'') = 
                    TO_CHAR (:a, ''yyyy/mm/dd''))
                    AND aid IN (SELECT aid FROM ppd WHERE TO_CHAR(cdate, ''yyyy/mm/dd'') = 
                    TO_CHAR (:b, ''yyyy/mm/dd'')
                    AND cid = :c )
                    AND cid <> :d';
      OPEN cur FOR dynamic_sql USING pc.cdate, pc.cdate, pc.id, pc.id;
      LOOP
         FETCH cur INTO id;
         EXIT WHEN cur%NOTFOUND;
         v_count := v_count + 1;
         DBMS_OUTPUT.PUT_LINE (' Id:' || id);
      END LOOP;
      CLOSE cur;
   IF (v_count > 0)
   THEN
      DBMS_OUTPUT.PUT_LINE ( 'Count: ' || v_count || ' SQL: ' || dynamic_sql);
      RAISE unmarked_ids;
   END IF;
   DBMS_OUTPUT.PUT_LINE('SQL ended successfully');
EXCEPTION
   WHEN unmarked_ids
   THEN
      DBMS_OUTPUT.put_line (
         'Found ID's that not marked with the current id.');
   WHEN NO_DATA_FOUND
   THEN
      DBMS_OUTPUT.put_line (
         'No data found in table1 with the current id ' || '&ID');
END; 
```

查询中有绑定变量。其中一个是日期，还有三个。需要显示计数和 ID，稍后将报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:09:30.340

您可以将 rowid 与索引值 (0...n) 一起存储在临时表中，然后使用 while 循环遍历索引值并使用 rowid 连接到真实表。

# jsf-2 - JSF 2.0 /CDI 范围和最佳实践

> ID：11832666
> 
> 赞同：0
> 
> 时间：2012-08-06T16:59:30.153
> 
> 标签：jsf-2, scope, java-ee-6, cdi

假设我有以下结构：

*   **pageA.xhtml** - 在这里我们可以选择在**pageB**和**pageC**中需要但在**pageE**中不需要的项目。

*   **pageB.xhtml** - 这里我们使用从**pageA**中选择的 Item 。我们在这个页面上还有一个选择框和一些按钮。当从 selectBox 中选择某些东西时，一些按钮将被停用，并且可以显示一些文本。（刷新此页面时，我们再次需要相同的状态）。pageB 包括 **pageD**列出了一些东西。现在我们可以导航到**pageC**。我们还创建了一些仅与**pageC**相关但与其他页面无关的对象。

*   **pageC.xhtml** - 这里我们从**pageB**获取对象，根据一些用户输入我们修改它，当我们按下应用时，我们回到**pageB**，它显示我们的更改。从**pageB**我们可以按保存，这将保存更改，并且**pageD**（包含在**pageB**中）将被更新。

*   **pageD.xhtml** - 只是列出一些东西。（仅包含在**pageB 中**）

*   **pageE.xhtml** - 此页面将开始完全不同的内容，不需要来自**pageA**的输入，但您可以直接导航到**pageC**。在这种情况下**pageC**必须隐藏一些东西。

我希望这个例子有点清楚。实际上我只是为了让我的问题更清楚一点：我想知道在不同页面之间传递数据并保存实际状态的最佳实践是什么（回来时也有相同的状态）。

以及如何重置/清除某些页面中需要但不同页面中不需要的数据。例如，一些数据将需要几个页面，但一些仅在嵌套页面内（在最佳世界中，嵌套页面内的数据应在离开时清除）

当然，我可以将我需要的东西保存到会话中，但是当我不再需要它们时，我必须小心再次删除这些东西。JSF 和 CDI 支持对话。但这里的问题是不可能进行嵌套对话。当然，我也可以使用请求参数传递所有内容.. 但在这种情况下，如果我的页面中有 ajax 请求，我必须小心（我想我必须始终发送所有参数）。

我将 JSF 2.0 与 CDI 一起使用。任何答案将不胜感激。可悲的是我无法提供任何代码示例..所以我希望我能够足够清楚地表达我的自我。

问候库库达斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:11:36.600

您可以创建新的 CDI 范围或在 CDI 中重新创建 ViewScope。也可以看看 CODI 对话。

# java - Java 客户端如何使用本机 Windows-MY 存储在 SSL 握手期间根据需要提供其客户端证书？

> ID：11832672
> 
> 赞同：4
> 
> 时间：2012-08-06T16:59:57.717
> 
> 标签：java, authentication, ssl

这个问题也发布在[TLS client authentication failed when using SunMSCAPI](https://forums.oracle.com/forums/thread.jspa?messageID=10498197&#10498197) but has not found an answer。

我有一个在 Windows Win2008R2 客户端上运行的 Java6 应用程序，该客户端连接到需要客户端证书的服务器。Java 应用程序需要使用本地 Windows 存储，即 Windows-Root 和 Windows-My，并使用 SunMSCAPI 提供程序。Windows 证书管理控制台报告客户端证书和签署它的 CA 证书都是正确的，并且已为所有目的启用。

服务器验证完全按预期工作，但是当客户端抛出 SSLException 抱怨私钥不是 RSA 私钥时，客户端身份验证失败。但是，当使用 Java 默认提供程序，并且从 JKS 密钥库中获取相同的客户端证书时，即不使用 SunMSCAPI 和 Windows 存储，客户端身份验证按预期工作并且 SSL 连接成功。

执行时，应用程序报告它正在使用 SunMSCAPI 提供程序，并且能够打印正确的客户端证书以及有关其 RSAPrivateKey 的信息。跟踪表明客户端异常发生在服务器“Hello Done”之后，因为它正在准备对服务器证书请求的响应。

客户端密钥库部分的相关代码位是：

```
SSLContext sslContext = SSLContext.getInstance("TLS");
KeyManagerFactory kFac = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
Provider pvdr = new sun.security.mscapi.SunMSCAPI();  
Security.insertProviderAt(pvdr,1);
KeyStore kStore = KeyStore.getInstance("Windows-MY",pvdr);
kStore.load(null,null);
kFac.init(kstore,null);
sslContext.init(kFac.getKeyManagers(), <a trust factory>.getTrustManagers(), new java.security.SecureRandom());
SSLSocketFactory sockFactory = SSLSocketFactory(sslContext);
SSLSocket sslSock = (SSLSocket)sockFactory.createSocket(<some destination host>, <some destination port>);
BufferedInputStream bInStr = new BufferedInputStream(sslSock.getInputStream());
bInStr.read(<the read arguments>);   <<< exception thrown in here 
```

任何指示或建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T01:28:55.857

您的链接中显示的堆栈跟踪显示问题出在 RSA 的 JSSL 提供程序上。特别是对于这种情况，您应该使用 Sun/Oracle 的 JSSE 提供程序。无论如何，它是默认的。

称它为

```
SSLContext sslContext = SSLContext.getInstance("TLS", "SunJSSE"); 
```

# actionscript-3 - 将字符串转换为多维数组

> ID：11832673
> 
> 赞同：1
> 
> 时间：2012-08-06T17:00:09.157
> 
> 标签：actionscript-3, multidimensional-array

有没有办法将字符串转换为多维数组？

例如：

```
new Array(new Array(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1), new
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new 
    Array(1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new 
    Array(1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,1), new 
    Array(1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,1,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1), new 
    Array(1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new 
    Array(1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new 
    Array(1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new 
    Array(1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new 
    Array(1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new 
    Array(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)) 
```

它是一个字符串，单词和括号也是字符，我想将它转换为一个真正的数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:14:59.123

我确信有更好的方法来编写正则表达式，但是在这里，它基本上删除了“new”，用“[”替换了“Array(”，用“]”替换了“)”。结果字符串是一个有效的 JSON 字符串，可以使用 JSON.parse() 将其转换为数组。

```
var str:String = "new Array(new Array(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1), new\
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new \
    Array(1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new \
    Array(1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,1), new \
    Array(1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,1,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1), new \
    Array(1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new \
    Array(1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new \
    Array(1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new \
    Array(1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new \
    Array(1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1), new \
    Array(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1))";

    var myPattern:RegExp = /new/g;  

    var json:String = str.replace(myPattern, " ");   
    myPattern = /Array\(/g;

    json = json.replace(myPattern, "[");

    myPattern = /\)/g;
    json = json.replace(myPattern, "]");

    var array:Array = JSON.parse(json) as Array; 
```

# php - Behat with Jenkins - 如何提供 PHP 应用程序？

> ID：11832674
> 
> 赞同：5
> 
> 时间：2012-08-06T17:00:14.717
> 
> 标签：php, continuous-integration, jenkins, behat, mink

我最近开始在一个使用 Slim 微框架的 PHP 项目中使用[Behat](http://behat.org/)和[Mink](http://mink.behat.org/)我的 Behat 测试工作正常，但我想将它们作为我构建的一部分运行，它使用 Sebastian Bergmann 的 Jenkins-PHP 模板。

为此，我希望我需要运行一个 Web 服务器来为 Slim 应用程序提供服务。显而易见的答案似乎是 PHP 5.4 的内置 Web 服务器，但我仅限于 PHP 5.3。

我目前唯一的想法是有一个部署阶段，如果 Ant 构建通过，Jenkins 会在服务器上部署一个工作区，然后针对它运行 Behat 测试。感觉这将是很多工作并且可能会不稳定，而且它需要启动另一个 VM，我希望避免这种情况。我们希望在大量不同的项目中使用 Behat，因此“一次性”的东西会更可取。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T13:20:50.267

我们最终采用的解决方案很像 Jakub 建议的 - 我们的 Jenkins 实例在 conf.d 中为每个使用 Behat 的工作区生成 Apache vhost 文件，使用类似以下的脚本：

```
# Set up a host file entry if none exists
hostFileEntry="127.0.0.1 ${JOB_NAME}.loc"
if fgrep -i "$hostFileEntry" /etc/hosts
then
        echo "${hostFileEntry}" already in hosts file
else
        echo $hostFileEntry >> /etc/hosts
fi

# Set up a virtual host for this job
echo "<VirtualHost *:80>" > /etc/httpd/conf.d/${JOB_NAME}.conf
echo "    ServerName ${JOB_NAME}.loc" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "    DocumentRoot ${WORKSPACE}/public" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "        <Directory ${WORKSPACE}/public>" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "            AllowOverride all" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "            Order allow,deny" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "            Allow from all" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "        </Directory>" >> /etc/httpd/conf.d/${JOB_NAME}.conf
echo "</VirtualHost>" >> /etc/httpd/conf.d/${JOB_NAME}.conf

# Reload Apache
sudo /sbin/service httpd reload 
```

然后，我们针对这些工作区运行 Behat 并以 JUnit 格式输出，以将结果与我们的构建集成。它需要对权限进行一些调整，但这对我们来说非常有效，非常感谢您的帮助:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T11:10:25.257

你或许可以使用 Ruby 的[Rack](http://rack.github.com/)来服务 PHP：[https ://github.com/jimeh/php-rack](https://github.com/jimeh/php-rack)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T14:35:07.537

另一种选择是为 Mink 实现 Slim 框架驱动程序（就像 Symfony 一样）。只要没有 javascript 场景，您就不需要网络服务器来运行您的场景。

对于 javascript 场景，我只是在我的 jenkins 实例上安装了 Web 服务器和 php。虚拟主机是作为构建的一部分创建的，并指向 jenkins 的工作区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T16:53:43.223

您可以使用 php 5.3 部署 vagrant 服务器。它是“另一个虚拟机”，但它是一次性的。

# objective-c - 如果 UIBarButtonItem:initWithImage: 被使用但不是 UIBarButtonItem:initWithCustomView: 时调用的方法：

> ID：11832675
> 
> 赞同：0
> 
> 时间：2012-08-06T17:00:19.310
> 
> 标签：objective-c, ios

我有一个方法，当用户单击导航栏中的按钮时，我想调用它。如果我像这样添加按钮，那么我的方法会被调用：

```
 UIBarButtonItem *editButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"myEditButton"]
                                                                   style:UIBarButtonItemStyleBordered
                                                                  target:self 
                                                                  action: @selector(enterEditMode:)];
  editButton.title = @"Edit";
  [self.navigationItem setRightBarButtonItem:editButton animated:YES]; 
```

当用户单击按钮时，我的 enterEditMode: 方法被调用。

然而，使用此代码，结果看起来像附件中的 - 没有文本，但更糟糕的是我的图像位于蓝色按钮的顶部。我不能使用标准系统编辑按钮，因为要求它是黑色而不是蓝色，而且 AFAIA 我无法将标准编辑栏按钮的颜色更改为黑色？

因此，在 xib 中，我创建了一个父 UIView，其中包含一个 UIImageView，它是按钮图像和文本的 UILabel。然后我像这样创建按钮项：

```
UIBarButtonItem *editButton = [[UIBarButtonItem alloc] initWithCustomView:self.editButtonParentView];
[editButton setTarget:self];
[editButton setAction: @selector(enterEditMode:)];
editButton.style = UIBarButtonItemStyleBordered;
editButton.target = self;
self.editButtonLabel.text = @"Edit"
[self.navigationItem setRightBarButtonItem:editButton animated:YES]; 
```

其中 editButtonParentView 是笔尖中部分视图的 IBOutlet。

这显示得很完美，但是问题是当用户点击它时 enterEditMode: 不会被调用。

为什么它不被调用？

谢谢

![在此处输入图像描述](../Images/309b643e91bf3af6b34c963d250986fa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:06:59.263

在此[链接](http://fredandrandall.com/blog/2011/03/31/how-to-change-the-color-of-a-uibarbuttonitem/)中，我发现了如何获得与系统“编辑”按钮相同的外观，但获得所需的任何背景颜色。试试这个代码：

// 从：

```
#import "UIBarButtomItem+Tinted.h"

@implementation UIBarButtonItem (Tinted)

+ (UIBarButtonItem *)newBarButtonItemWithTint:(UIColor*)color andTitle:(NSString*)itemTitle andTarget:(id)theTarget andSelector:(SEL)selector
{
    UISegmentedControl *button      = [[UISegmentedControl alloc] initWithItems:@[itemTitle]];
    button.momentary                = YES;
    button.segmentedControlStyle    = UISegmentedControlStyleBar;
    button.tintColor                = color;

    [button addTarget:theTarget action:selector forControlEvents:UIControlEventValueChanged];
    return [[UIBarButtonItem alloc] initWithCustomView:button];
}

@end 
```

# postgresql - PostgreSQL：网络上的空 BLOB

> ID：11832679
> 
> 赞同：0
> 
> 时间：2012-08-06T17:00:37.810
> 
> 标签：postgresql, networking, blob, pgadmin

当从本地（Ubuntu 11.10）的 pgAdmin III（v 1.12.3）访问时，一个表显示其 BLOB（bytea 列），但是当使用 pgAdmin III（v 1.14.2）从远程 Windows 7 机器通过网络访问 PG 时，表显示所有数据，但 BLOB。他们看起来像空的。

Ubuntu 机器上的 PostgreSQL 是“x86_64-pc-linux-gnu 上的 PostgreSQL 9.1.3，由 gcc-4.6.real (Ubuntu/Linaro 4.6.1-9ubuntu3) 4.6.1, 64-bit 编译”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:29:05.283

您所描述的似乎是此功能（引用[pgAdmin](http://pgadmin.org/development/changelog.php)的更改日志）：

> 2006-11-06 DP 1.6.0 在编辑网格中隐藏二进制数据 (bytea)。

[这](http://archives.postgresql.org/pgadmin-support/2006-11/msg00041.php)是 pgAdmin 列表上的相应线程。

您应该在`bytea`编辑网格的单元格中看到“”。（当您从对象浏览器打开表格时，您会看到标题为“编辑数据”的窗口。）

在 SQL 编辑器的“数据输出”窗格中，`bytea`显示列本身的数据（以转义字符串表示法）。

在任何一种情况下，单元格都不应该是“空的”。

至于版本 1.12.3：您可能想要安装当前版本 1.14.3 并查看是否有任何改变。1.16 也将很快与 Postgres 9.2 一起发布。测试版出来了。

# android - 在 AVD 中运行 SQLite

> ID：11832680
> 
> 赞同：0
> 
> 时间：2012-08-06T17:00:39.330
> 
> 标签：android, avd, android-sqlite

我正在尝试在我的应用程序中使用 DB SQLite，但遇到了麻烦。当我尝试运行应用程序时，Android 正在返回一个应用程序崩溃说“强制关闭”，我检查了代码以查看值和返回是否正常，并且似乎是，进行了一些调试，问题显然出在 createDataBase方法。他需要找到数据库的位置，我已经传入了一个变量 PATH，即使它仍然崩溃，不知道直接在平板电脑上运行是否是正确的原因我需要创建一个不同的路径，如数据/数据。 ...（发现正在研究，不确定）和 AVD（这就是问题所在）我需要指定数据库在我的桌面上的位置？

看一下代码：

连接数据库

```
 package com.victor.profile;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.app.Dialog;
import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;
import com.victor.profile.MainActivity;

public class ConnectDB extends SQLiteOpenHelper{

    //The Android's default system path of your application database.
    private static String DB_PATH = "C:/Users/Victor/Dropbox/workspace/Profile/database";

    private static String DB_NAME = "profile_db";

    private SQLiteDatabase myDataBase; 

    private final Context myContext;

    Dialog dialog;

    boolean  dbalert;

    /**
     * Constructor
     * Takes and keeps a reference of the passed context in order to access to the application assets and resources.
     * @param context
     */
    public ConnectDB(Context context) {

        super(context, DB_NAME, null, 1);
        this.myContext = context;
    }   

  /**
     * Creates a empty database on the system and rewrites it with your own database.
     * */
    public void createDataBase() throws IOException{

        boolean dbExist = checkDataBase();

        if(dbExist){
            //do nothing - database already exist
        }else{

            //By calling this method and empty database will be created into the default system path
               //of your application so we are gonna be able to overwrite that database with our database.
            this.getReadableDatabase();

            try {

                copyDataBase();

            } catch (IOException e) {

                throw new Error("Error copying database");

            }
        }

    }

    /**
     * Check if the database already exist to avoid re-copying the file each time you open the application.
     * @return true if it exists, false if it doesn't
     */
    private boolean checkDataBase(){

        SQLiteDatabase checkDB = null;

        try{
            String myPath = DB_PATH + DB_NAME;
            checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

        }catch(SQLiteException e){

            dbalert = new MainActivity().dbFail();

        }

        if(checkDB != null){

            checkDB.close();

        }

        return checkDB != null ? true : false;
    }

    /**
     * Copies your database from your local assets-folder to the just created empty database in the
     * system folder, from where it can be accessed and handled.
     * This is done by transfering bytestream.
     * */
    private void copyDataBase() throws IOException{

        //Open your local db as the input stream
        InputStream myInput = myContext.getAssets().open(DB_NAME);

        // Path to the just created empty db
        String outFileName = DB_PATH + DB_NAME;

        //Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        //transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0){
            myOutput.write(buffer, 0, length);
        }

        //Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();

    }

    public void openDataBase() throws SQLException{

        //Open the database
        String myPath = DB_PATH + DB_NAME;
        myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READWRITE);

    }

    @Override
    public synchronized void close() {

            if(myDataBase != null)
                myDataBase.close();

            super.close();

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }

        // Add your public helper methods to access and get content from the database.
       // You could return cursors by doing "return myDataBase.query(....)" so it'd be easy
       // to you to create adapters for your views. 
```

主要活动

```
 package com.victor.profile;

import java.io.IOException;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onDestroy(){
        System.exit(0);
    }

    public void RegisterActivity(View view) throws IOException{

        Intent intent = new Intent (this, RegisterActivity.class);
        ConnectDB dbcreator = new ConnectDB(this);
        dbcreator.createDataBase();
        startActivity(intent);  
    }

    public boolean dbFail(){
        AlertDialog alertDialog = new AlertDialog.Builder(MainActivity.this).create();
        alertDialog.setTitle("Closing App");
        alertDialog.setMessage("Unable to find Database...");
        alertDialog.setButton("OK", new DialogInterface.OnClickListener() {
           public void onClick(DialogInterface dialog, int which) {
              onDestroy();
           }
        });
        alertDialog.show();
        return true;
    }

} 
```

这是 logcat 错误

```
08-06 17:44:09.915: I/Database(283): sqlite returned: error code = 14, msg = cannot open file at source line 25467
*08-06 17:44:09.915: E/Database(283): sqlite3_open_v2("profile_db", &handle, 1, NULL) failed*
08-06 17:44:09.925: D/AndroidRuntime(283): Shutting down VM
08-06 17:44:09.925: W/dalvikvm(283): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
*08-06 17:44:09.946: E/AndroidRuntime(283): FATAL EXCEPTION: main
08-06 17:44:09.946: E/AndroidRuntime(283): java.lang.IllegalStateException: Could not execute method of the activity
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.view.View$1.onClick(View.java:2072)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.view.View.performClick(View.java:2408)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.view.View$PerformClick.run(View.java:8816)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.os.Handler.handleCallback(Handler.java:587)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.os.Handler.dispatchMessage(Handler.java:92)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.os.Looper.loop(Looper.java:123)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-06 17:44:09.946: E/AndroidRuntime(283):  at java.lang.reflect.Method.invokeNative(Native Method)
08-06 17:44:09.946: E/AndroidRuntime(283):  at java.lang.reflect.Method.invoke(Method.java:521)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-06 17:44:09.946: E/AndroidRuntime(283):  at dalvik.system.NativeStart.main(Native Method)
08-06 17:44:09.946: E/AndroidRuntime(283): Caused by: java.lang.reflect.InvocationTargetException
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.victor.profile.MainActivity.RegisterActivity(MainActivity.java:36)
08-06 17:44:09.946: E/AndroidRuntime(283):  at java.lang.reflect.Method.invokeNative(Native Method)
08-06 17:44:09.946: E/AndroidRuntime(283):  at java.lang.reflect.Method.invoke(Method.java:521)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.view.View$1.onClick(View.java:2067)
08-06 17:44:09.946: E/AndroidRuntime(283):  ... 11 more
08-06 17:44:09.946: E/AndroidRuntime(283): Caused by: java.lang.IllegalStateException: System services not available to Activities before onCreate()
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.app.Activity.getSystemService(Activity.java:3526)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.android.internal.app.AlertController$AlertParams.<init>(AlertController.java:743)
08-06 17:44:09.946: E/AndroidRuntime(283):  at android.app.AlertDialog$Builder.<init>(AlertDialog.java:273)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.victor.profile.MainActivity.dbFail(MainActivity.java:43)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.victor.profile.ConnectDB.checkDataBase(ConnectDB.java:83)
08-06 17:44:09.946: E/AndroidRuntime(283):  at com.victor.profile.ConnectDB.createDataBase(ConnectDB.java:47)
08-06 17:44:09.946: E/AndroidRuntime(283):  ... 15 more
08-06 17:44:09.965: W/ActivityManager(58):   Force finishing activity com.victor.profile/.MainActivity
08-06 17:44:10.315: I/ARMAssembler(58): generated scanline__00000077:03515104_00000000_00000000 [ 33 ipp] (47 ins) at [0x342d00:0x342dbc] in 385721 ns
08-06 17:44:10.525: W/ActivityManager(58): Activity pause timeout for HistoryRecord{44fee218 com.victor.profile/.MainActivity}
08-06 17:44:20.796: W/ActivityManager(58): Activity destroy timeout for HistoryRecord{44fee218 com.victor.profile/.MainActivity}* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:11:28.980

您不能像这样在模拟器中定义硬盘驱动器的路径：

```
private static String DB_PATH = "C:/Users/Victor/Dropbox/workspace/Profile/database"; 
```

模拟器创建了一个尽可能模仿真实设备的环境。它有自己的文件结构，您的方法不正确。而是使用它来创建数据库：

```
checkDB = SQLiteDatabase.openDatabase(DB_NAME, null, SQLiteDatabase.OPEN_READONLY); 
```

如果您想在模拟器中访问您的数据库，请阅读以下内容：[Android 模拟器在哪里存储 SQLite 数据库？](https://stackoverflow.com/q/1510840/1267661)

**新的 LogCat**

当您调用`new ConnectDB(this)`SQLiteOpenHelper 类时，会为您创建数据库。您不需要您的方法 createDataBase()。

当你像这样使用 getReadableDatabase() 时：

```
try {
    SQLiteDatabase database = mDbHelper.getReadableDatabase();
}
catch(SQLiteException exception) {
    // Database didn't open, exit app gracefully
} 
```

那么你也不需要你的 checkDataBase() 方法，这两个过程都已经由 SQLite 完成了。

**最后**，您不需要在 onDestory() 中退出您的应用程序。试图关闭正在关闭的应用程序是多余的。此外，如果您想关闭应用程序，请使用 Android 方法`finish()`。始终使用 Android 命令而不是标准 Java 命令。

# c# - 从 Lua 引擎获取所有 Lua 库和关键字

> ID：11832683
> 
> 赞同：3
> 
> 时间：2012-08-06T17:00:48.563
> 
> 标签：c#, lua

我正在为我的 Lua IDE 开发代码完成控件

[https://github.com/AndersMalmgren/FreePIE](https://github.com/AndersMalmgren/FreePIE)

我正在使用反射来获取可从脚本访问的 C# 对象信息，但我也希望在列表中包含 Lua 特定的东西，比如数学库等。

有没有办法得到这些？还想获取所有关键字，例如 if、then、end 等

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T19:10:39.023

> 有没有办法得到这些？

该手册包含所有内容，但您也可以在启动时遍历全局名称空间以获取所有内容（您必须尽早执行此操作，然后再将任何内容添加到名称空间！）。如果某物是一个表，那么它也是一个类似`string`or的命名空间`table`，您可以遍历它来获取方法。

```
local exclude = { _G = true, _VERSION = true, arg = true }
for name, value in pairs(_G) do
    if not exclude[name] then
        print(name)
        if type(value) == 'table' then
            for name, value in pairs(value) do
                print('\t', name)
            end
        end
    end
end 
```

产生以下内容：

```
string
                sub
                upper
                len
                gfind
                rep
                find
                match
                char
                dump
                gmatch
                reverse
                byte
                format
                gsub
                lower
xpcall
package
                preload
                loadlib
                loaded
                loaders
                cpath
                config
                path
                seeall
tostring
print
os
                exit
                setlocale
                date
                getenv
                difftime
                remove
                time
                clock
                tmpname
                rename
                execute
unpack
require
getfenv
setmetatable
next
assert
tonumber
io
                lines
                write
                close
                flush
                open
                output
                type
                read
                stderr
                stdin
                input
                stdout
                popen
                tmpfile
rawequal
collectgarbage
getmetatable
module
rawset
math
                log
                max
                acos
                huge
                ldexp
                pi
                cos
                tanh
                pow
                deg
                tan
                cosh
                sinh
                random
                randomseed
                frexp
                ceil
                floor
                rad
                abs
                sqrt
                modf
                asin
                min
                mod
                fmod
                log10
                atan2
                exp
                sin
                atan
debug
                getupvalue
                debug
                sethook
                getmetatable
                gethook
                setmetatable
                setlocal
                traceback
                setfenv
                getinfo
                setupvalue
                getlocal
                getregistry
                getfenv
pcall
table
                setn
                insert
                getn
                foreachi
                maxn
                foreach
                concat
                sort
                remove
newproxy
type
coroutine
                resume
                yield
                status
                wrap
                create
                running
select
gcinfo
pairs
rawget
loadstring
ipairs
dofile
setfenv
load
error
loadfile 
```

# c# - 具有多个日期字段的项目的订单集合

> ID：11832684
> 
> 赞同：2
> 
> 时间：2012-08-06T17:00:50.273
> 
> 标签：c#, asp.net, linq

我有一个项目集合，其中每个项目都有以下字段：`Title`、`DateCreated`和`DateUpdated`

我想订购这些项目，以便首先显示最近的项目，其中最近的项目是刚刚创建或更新的项目。

因此，如果我在三秒前创建了 Item2，它将显示在顶部。但是如果我再去更新 Item1，它现在会显示在顶部，因为 Item1`DateUpdated`比 Item2 更新`DateCreated`

有没有办法根据两个日期以这种方式订购收藏？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:07:21.090

```
var newList = 
      list.OrderByDescending(s=>Math.Max(s.DateCreated.Ticks,s.DateUpdated.Ticks)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T17:09:14.257

创建项目时，只需将`DateCreated`和都设置`DateUpdated`为创建日期。然后，您可以按`DateUpdated`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T17:11:42.197

如果我没有错，那么您正在为您的收藏使用自定义数据。所以你必须使用 IComparable 接口才能实现它。这是参考“http://msdn.microsoft.com/en-us/library/system.icomparable.aspx”

# ios - 在 Flash CS6 中用于 iOS 的滑动手势

> ID：11832690
> 
> 赞同：1
> 
> 时间：2012-08-06T17:01:10.850
> 
> 标签：ios, actionscript-3, flash, actionscript, flash-cs6

我在 Flash CS6 中（主要是）为 iOS 创建了一个应用程序，但在让特定页面正常工作时遇到了一些问题。

布局如下：我有一个影片剪辑，其内容是舞台宽度的 3 倍，实例名称为`txtContent`.

在单独的层上，我的动作脚本 (v3.0) 如下所示：

```
import com.greensock.*;
import flash.events.MouseEvent;

//Swipe
Multitouch.inputMode = MultitouchInputMode.GESTURE;

var currentTile:Number = 1;
var totalTiles:Number = 3;

txtContent.addEventListener(TransformGestureEvent.GESTURE_SWIPE , onSwipe); 

function moveLeft():void{
    txtContent.x += 640;
}

function moveRight():void{
    txtContent.x -= 640;
}

function onSwipe (e:TransformGestureEvent):void{
    if (e.offsetX == 1) { 
        if(currentTile > 1){ 
            moveLeft()
            currentTile--
        } else {}
    }

    if (e.offsetX == -1) { 
        if(currentTile < totalTiles){
            moveRight()
            currentTile++
        }
    }
}

stop(); 
```

当我使用触摸层测试影片时，影片剪辑在每次滑动时都成功地左右移动，并且不会继续在任一方向上移动太远，实际上忽略了任何其他滑动。

但是，当我编译 IPA 并在 iPhone 上进行测试时，只有前两个“磁贴”移动（滑动时我只能看到三分之二的影片剪辑），好像我滑动到第三个“磁贴”我无法向后滑动一点也不。无论我做什么，它都会卡在第三部分。

我的代码中是否存在未在 iOS 中正确注册的问题？

仅供参考，我正在 iPhone 3GS 上进行测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:28:09.667

这是我自己的错误 - 幻灯片的最后“页面”没有像其他幻灯片那样设置为 0% 的大背景，因此要将其滑回它只会在按住文本（很小）时起作用。随着背景的添加，影片剪辑是实心的，因此滑动整个屏幕效果很好。

# ios - Google Places API 未返回响应

> ID：11832692
> 
> 赞同：5
> 
> 时间：2012-08-06T17:01:14.893
> 
> 标签：ios, google-places-api

我正在关注在线[教程](http://www.raywenderlich.com/13160/using-the-google-places-api-with-mapkit)，我有 2 种方法可以向 Google Places API 提交查询。不幸的是，我正试图得到回复，它不起作用。我在代码中有一些调试编号。但是，这里是代码。

```
-(void) queryGooglePlaces{
    NSString *url = @"https://maps.googleapis.com/maps/api/place/search/json?location=-33.8670522,151.1957362&radius=500&types=food&name=harbour&sensor=false&key=myKey";

    //Formulate the string as a URL object.
    NSURL *googleRequestURL=[NSURL URLWithString:url];
    NSLog(@"1.5");
    // Retrieve the results of the URL.
    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL: googleRequestURL];
        [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:YES];
    });
    NSLog(@"2");
}

-(void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization 
                          JSONObjectWithData:responseData 

                          options:kNilOptions 
                          error:&error];

    //The results from Google will be an array obtained from the NSDictionary object with the key "results".
    NSArray* places = [json objectForKey:@"results"]; 

    //Write out the data to the console.
    NSLog(@"Google Data: %@", places);
    NSLog(@"3");
} 
```

在日志中，输出如下：

```
2012-08-03 16:40:12.411 sCode[25090:1a303] 1.5
2012-08-03 16:40:12.411 sCode[25090:1a303] 2
2012-08-03 16:40:12.512 sCode[25090:1a303] 4
2012-08-03 16:40:12.751 sCode[25090:1a303] Google Data: (
)
2012-08-03 16:40:12.751 sCode[25090:1a303] 3
2012-08-03 16:40:13.628 sCode[25090:1a303] 1
2012-08-03 16:40:14.129 sCode[25090:1a303] 4 
```

谁能告诉我出了什么问题，所以我没有得到回应。？是的，我确实调用`[self queryGooglePlaces];`了我的`ViewDidLoad`方法感谢帮助！对不起，如果我太冗长了..只是一个尝试学习的初学者！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:37:29.577

鉴于提供的代码，我最好的猜测是您需要通过添加百分比转义来编码您的 URL 字符串。尝试`url`像这样创建...

```
NSString *url = @"https://maps.googleapis.com/maps/api/place/search/json?location=-33.8670522,151.1957362&radius=500&types=food&name=harbour&sensor=false&key=myKey";
url = [url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

You would typically make that into one line, but have shown it as two lines for clarity. This will convert those `=` and `&` into properly escaped characters to provide a valid URL.

# css - 使用 css 在输入的焦点或悬停上设置 2 个 div

> ID：11832693
> 
> 赞同：0
> 
> 时间：2012-08-06T17:01:15.363
> 
> 标签：css, focus, hover

我有一个这样的html结构：

```
<form class="form">
                <div class="row">
                    <input id="search" class="search-input" type="text" placeholder="Search">
                    <div class="input-icon" data-icon="s"></div>
                    <div class="triangle-left"></div>                    
                 </div>
            </form> 
```

并且以下css代码女巫很重要：

```
input[type="text"]:focus, input[type="text"]:hover, input[type="password"]:focus, input[type="password"]:hover {
    border:1px solid #ffa800;
    box-shadow: 0 0 5px #ffa800, 0 4px 4px rgba(0,0,0,.1) inset;
    -moz-box-shadow: 0 0 5px #ffa800, 0 4px 4px rgba(0,0,0,.1) inset;
    -webkit-box-shadow: 0 0 5px #ffa800, 0 4px 4px rgba(0,0,0,.1) inset;
}
input[type="text"]:focus + .input-icon:before, input[type="text"]:hover + .input-icon:before, input[type="password"]:focus + .input-icon:before, input[type="password"]:hover + .input-icon:before{
    color:#ffa800;
    border-color: #ffa800;
}
input[type="text"]:focus  .triangle-left, input[type="text"]:hover .triangle-left, input[type="password"]:focus .triangle-left, input[type="password"]:hover .triangle-left{
    border-color:transparent transparent transparent #ffa800;
} 
```

如果我将输入悬停或聚焦于具有类 input-icon 的 div 获得新颜色和边框颜色，则第一个代码效果很好。我的问题是我也可以在第二个 div (.triangle-left) 中进行更改吗？我试过了，但我不工作。只有第一个 div 有效。如果我更改 div ，那么第一个三角形左比 css 代码有效。

你知道一种方法来做到这一点，或者是使用小型 jquery 脚本的唯一可能性吗？

谢谢你的帮助：）

问候 Crazymodder

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:36:19.477

作为快速编辑： http: [//jsfiddle.net/xngbv/](http://jsfiddle.net/xngbv/) 问题是您实际上没有任何设置`.triangle-left`来使用您想要的悬停和焦点样式。`.triangle-left`是一个 div，而不是任何类型的输入，因此您在最后一个块中设置的样式（您使用`.triangle-left`的位置）无效

编辑：我所做的影响渲染的更改正在使用

`.triangle-left:focus, .triangle-left:hover`

代替

`input[type="text"]:focus .triangle-left, input[type="text"]:hover .triangle-left`

因为按照您的方式，该样式适用于在聚焦/悬停时具有 text 类型的输入，该输入也具有 style `triangle-left`。由于唯一具有 class 的元素`triange-left`是 a `div`，因此没有任何元素受到影响。您想要的是将样式直接应用于实际`triangle-left`设置的元素。如果您不想仅使用类名，则可以使用`div.triangle-left:focus`或类似的名称。

# abap - 在消息类型 e 之后，程序不会返回到选择屏幕 ABAP

> ID：11832700
> 
> 赞同：4
> 
> 时间：2012-08-06T17:02:11.530
> 
> 标签：abap, sap-selection-screens

我正在尝试在我的报告中使用消息类型 E。问题是当消息被触发时，程序不会返回到选择屏幕。谁能帮我？这是我用来实现此目的的代码：

```
IF rb_tri IS NOT INITIAL AND p_trim-low IS INITIAL.

  MESSAGE e038.

ENDIF. 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T13:08:03.353

当我将您的问题与[您的答案](https://stackoverflow.com/a/11844518/676874)结合起来时，我会提供另一种解决方案：

不要在启动过程 ( `START-OF-SELECTION`) 后进行测试，而是在选择屏幕上进行：

```
PARAMETER: p_test.

AT SELECTION-SCREEN.
  IF p_test IS INITIAL.
    MESSAGE e038(00).
  ENDIF. 
```

电子消息会阻止选择屏幕，直到问题解决。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T11:01:48.390

我找到了答案。我应该使用 S 消息并像 E 类型消息一样显示它。要返回选择屏幕，我必须使用 LEAVE LIST_PRECESSING。代码如下：

```
START-OF-SELECTION.

IF rb_tri IS NOT INITIAL AND p_trim-low IS INITIAL.

  MESSAGE s038 DISPLAY LIKE 'E'.
  Leave list-processing.

ENDIF. 
```

还是非常感谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-24T14:21:57.233

```
Message text-001 TYPE 'S' Display LIKE 'E' 
```

或者

```
At selection screen on radiobutton group rad1.
  if condition
    message text-001 type 'I' display like 'E'.
    set screen 1000.
    leave screen.
  endif 
```

# c - 不推荐使用错误

> ID：11832705
> 
> 赞同：3
> 
> 时间：2012-08-06T17:02:50.363
> 
> 标签：c, networking, glibc, gethostbyaddr

在回答[另一个问题](https://stackoverflow.com/q/11830514/1468366)时，我偶然发现了[一个](http://linux.die.net/man/3/herror)名为`herror`. `perror`除了打印与某些主机查找问题相关的错误外，它似乎非常相似。手册页指出此功能“已过时”。`hsterror`可用于将错误号转换为字符串而不打印它的函数也被标记为已过时。

我没有看到任何迹象表明*为什么*它们中的任何一个都已过时，以及应该使用什么*替代品。*那么，`h_errno`在 GNU libc linux 系统上将晦涩的错误号转换为用户可读字符串的首选方法是什么？每个微小的应用程序都应该提供自己的转换表，并希望可能的错误代码集不会很快改变吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:05:10.687

它们已经过时了，因为它们已经`gethostbyname*`过时了。改为使用`getaddrinfo`，并`gai_strerror`用于错误。

从[`gethostbyname(3)`手册页](http://linux.die.net/man/3/gethostbyname)：

> gethostbyname*() 和 gethostbyaddr*() 函数已过时。应用程序应改为使用[getaddrinfo(3)](http://linux.die.net/man/3/getaddrinfo)和[getnameinfo(3)](http://linux.die.net/man/3/getnameinfo)。

# javascript - 如何查看附加到 html 元素的事件？

> ID：11832706
> 
> 赞同：66
> 
> 时间：2012-08-06T17:02:50.597
> 
> 标签：javascript, jquery, javascript-events

你好我是一个新的程序员，还在学习。这是我试图弄清楚的代码：

```
<div id="buy" class="buy button">Buy</div> 
```

当我单击 div （按钮）时，会执行一些 javascript 代码，但我不知道是不是这样。当点击发生时，我怎么知道触发了什么函数？一些监听器是如何附加到这个元素的

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-08-06T17:22:03.120

在谷歌浏览器的开发者工具中（点击扳手图标>工具>开发者工具），选择元素选项卡中的元素，在右侧打开“事件监听器”面板，您将看到所有事件

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-06T17:08:06.800

如果您使用 Firefox 和 Firebug，您可以尝试安装 FireQuery。它将使您可以*看到*由 jQuery 绑定的处理程序。[http://firequery.binaryage.com/](http://firequery.binaryage.com/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-08-06T17:08:10.337

您不能通过“仅”使用 ECMAscript 本身以非常好的方式做到这一点。例如，如果*DOM Level 1*添加了一个 click 事件处理程序，其形式为

```
document.getElementById('buy').onclick = function() {}; 
```

您当然可以轻松地拦截节点本身的该属性。*如果DOM Level 2*受到`.addEventListener()`尊重，事情就会变得更加复杂`.attachEvent()`。现在你真的没有一个“地方”来寻找所有不同的监听器函数从哪里绑定。

使用 jQuery 会变得更好。jQuery 会将它的所有事件处理函数保存在一个特殊的对象中，该对象链接到调用的 DOM 节点。您可以通过获取`.data()`节点的 -expando 属性来检查，例如

```
$('#buy').data('events'); 
```

但是，现在我已经描述了将事件侦听器绑定到节点的三种不同方法（实际上是两种，因为像 jQuery 这样的库当然也使用 DOM Level 1 或 2 方法）。

如果一个事件是由委托触发的，那真的会变得很难看。这意味着，我们将 click 事件绑定在某个父节点上，等待该事件向我们冒泡，这样我们就可以检查`target`. `node`所以现在我们甚至在和之间没有直接的关系`event listener`。

这里的结论是，注意浏览器插件或者可能是[VisualEvent 之](http://www.sprymedia.co.uk/article/Visual+Event)类的东西。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-08-07T17:51:28.353

您可以使用“ [Visual Event 2](http://www.sprymedia.co.uk/article/Visual+Event+2) ”脚本作为书签或与[Chrome 扩展程序](https://chrome.google.com/webstore/detail/pbmmieigblcbldgdokdjpioljjninaim)相同的脚本。

此脚本显示附加到 dom-elements 的所有 js 事件。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-06T17:06:45.220

利用`jQuery("#buy").data('events');`

[http://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)可能很有趣。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-06T17:07:49.093

`element.onclick=`使用传统处理程序或 HTML附加的事件处理程序`<element onclick="handler">`可以`element.onclick`从脚本或调试器中的属性中轻松检索。

使用 DOM 级别 2 事件 addEventListener 方法和 IE 的 attachEvent 附加的事件处理程序目前根本无法从脚本中检索。DOM Level 3 曾经提出 element.eventListenerList 来获取所有的监听器，但不清楚这是否会成为最终规范。今天在任何浏览器中都没有实现。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-06T17:08:15.903

如果您使用的是 FireFox，则应该安装 FireBug。一旦你有了它，你就可以安装 FireQuery，它会告诉你哪些 jQuery 事件绑定到哪些对象。

[http://getfirebug.com/](http://getfirebug.com/)

[http://firequery.binaryage.com/](http://firequery.binaryage.com/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-06T17:15:57.100

这是我发现的最简单的方法： [http ://www.sprymedia.co.uk/article/Visual+Event](http://www.sprymedia.co.uk/article/Visual+Event)

> 在 Javascript 中处理事件时，通常很容易忘记在哪里订阅了哪些事件。如果您使用大量事件，则尤其如此，这在采用渐进增强的现代界面中很典型。从技术角度来看，Javascript 库还为侦听器增加了另一程度的复杂性，而从开发人员的角度来看，它们当然可以让生活变得更轻松！但是当出现问题时，很难追查为什么会这样。
> 
> 正是由于这个原因，我整理了一个名为 Visual Event 的 Javascript 小书签，它直观地显示了页面上订阅了事件的元素、这些事件是什么以及事件在触发时将运行的功能。这主要是为了帮助调试，但在其他页面上查看订阅的事件也可能非常有趣和信息丰富。

那里有一个书签按钮，您可以将其拖到您的工具栏（FF 或 Chrome），然后只需在您想要查看附加事件的任何页面上单击该按钮。效果很好！（至少对于 jQuery 或其他库附加的事件）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-06T17:12:03.453

以下是我过去使用过的东西，我认为这可能是您正在寻找的东西。它的作用是观察页面元素上的属性（在下面的示例中，它是文档的“标题”属性），然后在该属性更改时显示带有 JS 调用堆栈的警报。您需要在尝试查找的任何代码触发之前将其放入 DOM，但希望您能够确定导致问题的原因。

我建议使用 Firefox 并使用 Firebug 进行 JavaScript 调试。

```
// Call stack code
function showCallStack() {
   var f=showCallStack,result="Call stack:\n";

   while((f=f.caller)!==null) {
      var sFunctionName = f.toString().match(/^function (\w+)\(/)
      sFunctionName = (sFunctionName) ? sFunctionName[1] : 'anonymous function';
      result += sFunctionName;
      result += getArguments(f.toString(), f.arguments);
      result += "\n";
   }
   alert(result);
}

function getArguments(sFunction, a) {
   var i = sFunction.indexOf(' ');
   var ii = sFunction.indexOf('(');
   var iii = sFunction.indexOf(')');
   var aArgs = sFunction.substr(ii+1, iii-ii-1).split(',')
   var sArgs = ''; 
   for(var i=0; i<a.length; i++) {
      var q = ('string' == typeof a[i]) ? '"' : '';
      sArgs+=((i>0) ? ', ' : '')+(typeof a[i])+' '+aArgs[i]+':'+q+a[i]+q+'';
   }
   return '('+sArgs+')';
} 

var watchTitle = function(id, oldval, newval) { showCallStack(); }

// !! This is all you should need to update, setting it to whatever you want to watch.
document.watch("title", watchTitle); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-06T17:07:00.827

你在使用 jQuery 吗？如果是这样，您想搜索以下三行代码之一：

```
$("#buy").click //the div is refered by its id 
```

或者

```
$(".buy").click //the div is refered to by the style "buy" 
```

或者

```
$(".button").click //refered to by the style "button" 
```

`F12`大多数较新的浏览器通过按（至少在 IE 和 Chrome 中）内置了“开发者工具” 。这可能会帮助您进行一些进一步的调试和跟踪。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-06T17:11:41.650

1.  右键页面，选择查看页面源
2.  查找`<script>`标签
3.  寻找`$("#buy")`和提及`onClick`或`.on("click",function(){...});`
4.  如果找不到，请按照以下方式搜索：`document.getElementById("buy")`
5.  您已找到`function`事件处理程序代码所在的 或 代码

`$("#buy")`是 JQuery 的说法，即找到一个具有 的`id`属性的元素，`buy`如果它`.`后面有某个函数，则该函数正在作用于 JQuery 找到的元素。

# jquery - 通过Rails在嵌套表单中使用jQuery从POST参数分配属性值？

> ID：11832709
> 
> 赞同：0
> 
> 时间：2012-08-06T17:02:56.437
> 
> 标签：jquery, ruby-on-rails, nested-attributes

我在我的 Rails 应用程序中使用嵌套表单 ( [RailsCast #196 )。](http://railscasts.com/episodes/196-nested-model-form-revised)这是我目前的问题以及我想做的事情；但是，我不确定解决此问题的最佳方法是什么，并希望得到一些指示。

我有一个`dish`表单 ( `_form.html.haml`)，其中包含以下一些字段：

```
.control-group
  =f.label :menu, :class => 'control-label'
  .controls
    =select("dish", "menu_id", (current_user.has_role? :admin) ? (Menu.all.collect {|m| [ m.name, m.id ] }) : (current_user.menus.all.collect {|m| [ m.name, m.id ] }), {:include_blank => 'Choose a Menu'})
.control-group
  =f.label :name, :class => 'control-label'
  .controls
    =f.text_field :name

.control-group
  =f.label :category_ids, "Category", :class => 'control-label'
  .controls
    =f.collection_select :category_ids, (current_user.has_role? :admin) ? (Category.order(:name)) : (current_user.categories.order(:name)), :id, :name, params[:category_id].nil? ? {} : {:selected => params[:category_id]}, {multiple: true, :class => 'chzn-select'}

  .controls
    %p.help-block
      =link_to_add_fields "Add New Category", f, :categories, "categories" 
```

从文件中`=link_to_add_fields`生成嵌套表单`_category_fields.html.haml`，此函数在 my 中定义`application_helper.rd`为：

```
def link_to_add_fields(name, f, association, parent)
  new_object = f.object.send(association).klass.new
  id = new_object.object_id
  fields = f.fields_for(association, new_object, child_index: id) do |builder|
    render(parent + "/" + association.to_s.singularize + "_fields", f: builder)
  end
  link_to(name, '#', class: "add_fields", data: {id: id, fields: fields.gsub("\n", "")})
end 
```

我的`category`部分形式 ( `_category_fields.html.haml`) 看起来像这样：

```
%fieldset
  .control-group
    %h5
      New Category

    =f.select("menu_id", (current_user.has_role? :admin) ? (Menu.all.collect {|m| [ m.name, m.id ] }) : (current_user.menus.all.collect {|m| [ m.name, m.id ] }), {:include_blank => 'Choose a Menu'})
    =f.hidden_field :_destroy

    =f.text_field :name, placeholder: "Name"

    =link_to "X", "#", :class => "remove_fields" 
```

您会注意到，用户已经在下拉菜单`menu_id`中的表单中选择并定义了：`dish`

```
.control-group
  =f.label :menu, :class => 'control-label'
  .controls
    =select("dish", "menu_id", (current_user.has_role? :admin) ? (Menu.all.collect {|m| [ m.name, m.id ] }) : (current_user.menus.all.collect {|m| [ m.name, m.id ] }), {:include_blank => 'Choose a Menu'}) 
```

但您也注意到，我强迫用户从嵌套表单的部分表单中的`menu_id`另一个下拉列表中重新选择。`category`

我想要它，这样`menu_id`用户就不需要在嵌套表单中重新选择它，而是在用户点击提交按钮后通过从传递给的参数中检测它来`category`分配给新项目`category`数据库。

例如，当您点击提交按钮时，终端/控制台会显示以下内容：

```
Started POST "/dishes" for 127.0.0.1 at 2012-08-06 09:51:41 -0700
Processing by DishesController#create as HTML
  Parameters: {"utf8"=>"✓&quot;, "authenticity_token"=>"tAbx+14Ve22FVimgY0x2d+fbImuG+pjkgC7Zgdco73k=", "dish"=>{"menu_id"=>"1", "name"=>"New Dish", "category_ids"=>["", "2"], "categories_attributes"=>{"1344271336031"=>{"menu_id"=>"1", "_destroy"=>"false", "name"=>""}} ... }} 
```

`menu_id`重申一下，我希望`"categories_attributes"=>{"1344271336031"=>{"menu_id"=>"1"...`通过拿起`"dish"=>{"menu_id"=>"1" ...`.

我假设最好的方法是通过 jQuery，但是当谈到 jQuery 时，我是一个完整的新手，并且不知道如何开始以及在线研究要寻找什么。

我尝试的另一件事是在创建后使用回调并读取数据库，但这是不安全的，因为我需要考虑许多变量。

## 更新 1：几乎就在那里，但卡住了

多亏了 MurifoX 指针，我可以`menu_id`通过`hidden_field`在嵌套表单中`menu_id`分配`dish`.

但是，当我在菜式表单中创建一个新的 Dish 和一个新的 Category 时，它会抛出我设置的验证错误，该错误验证是否已为新的 Category 对象提供了一个类别 ID。所以基本上，`menu_id`没有被传递到`hidden_field`新的 Category 对象中。

另一方面，我能够：

1.  编辑 Dish 并从嵌套表单创建一个新类别。
2.  从其自己的 _form.html.haml 页面创建一个新类别。
3.  并编辑现有的类别项目。

但我根本不能：

*   同时从嵌套表单创建一个新的 Dish 和一个新的 Category 项。

这是我更新的代码：

**_category_fields.html.haml**

```
...
=f.hidden_field :menu_id, :value => @dish.nil? ? [:dish][:menu_id] : @dish.menu_id
... 
```

**类别控制器.rb**

```
def create      
  if @dish.blank?
    @category = Category.new(params[:category])
  else
    @category = Category.new(:menu_id => [:dish][:menu_id], :name => [:category])
  end

  respond_to do |format|
    if @category.save
      format.html { redirect_to categories_path, notice: 'Category was successfully created.' }
    else
      format.html { render action: "new" }
    end
  end
end

def update
  @category = Category.find(params[:id])

  respond_to do |format|        
    if @dish.blank?
      if @category.update_attributes(params[:category])
        format.html { redirect_to categories_path, notice: 'Category was successfully updated.' }
      else
        format.html { render action: "edit" }
      end
    else
      if @category.update_attributes(:menu_id => [:dish][:menu_id], :name => [:category])
        format.html { redirect_to categories_path, notice: 'Category was successfully updated.' }
      else
        format.html { render action: "edit" }
      end
    end
  end
end 
```

# cygwin - Cygwin 终端崩溃

> ID：11832713
> 
> 赞同：2
> 
> 时间：2012-08-06T17:03:29.680
> 
> 标签：cygwin, windows-7-x64

我在 windows 7 64 位终极版上安装了 Cygwin，在启动 cygwin 终端后它崩溃并创建了一个名为 mintty.exe.stackdump 的文件，在这个文件中有一行，即

```
Exception: STATUS_ACCESS_VIOLATION at eip=61004DF6 
```

在谷歌上搜索后；如果它们是系统中的两个 cygwin1.dll，似乎会发生此异常。只有一个在 cygwin 的安装目录中。

我已经安装了mingw，但是即使在卸载mingw之后它仍然崩溃。我之前没有在 cygwin 上工作过，有人可以指导我如何摆脱这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T18:20:45.037

`cygwin1.dll`由其他一些从 Linux 移植到 Windows 的程序安装，例如 OpenSSH。您的系统上的其他地方可能有另一个版本，它是由不同的应用程序安装的。

它也不一定需要在您的 Cygwin 安装目录中。例如，仅仅位于`PATH`env 变量中的目录中就足以引起 Cygwin 的混乱。

如果您确切知道可能的罪魁祸首（想想传统 Linux 程序和工具的 Windows 端口），我会先检查这些。否则，请尝试在您的 var 中挖掘不同的目录`path`（您可以通过启动`cmd.exe`终端并运行命令来查看它们`echo %path%`）。

# asp.net - SQL Server 2012 Express 冗余进程

> ID：11832714
> 
> 赞同：0
> 
> 时间：2012-08-06T17:03:36.060
> 
> 标签：asp.net, iis, sql-server-2012-express

我最近在开发一个新的网络应用程序时遇到了一些奇怪的问题。所以我决定看看 SQL Server 作为随机挂起等的可能来源。

在查看 SQL Server Management Studio 中的活动监视器时，我看到在应用程序的使用过程中，`Processes`面板中构建了很多项目，所有项目都归 IIS 默认应用程序池所有。

现在我一直小心地在查询后和页面关闭时关闭数据库连接，但是这些并没有消失。

这只是以前进程的列表，还是它们都还活着？

我可以右键单击-> 杀死进程，然后它们就会消失。

# php - php ssh2 连接到 HP 交换机 - 失败并显示“警告：ssh2_exec() [function.ssh2-exec]：无法请求在远程主机上执行命令”

> ID：11832716
> 
> 赞同：0
> 
> 时间：2012-08-06T17:03:42.553
> 
> 标签：php, ubuntu, apache2

我一直在尝试遵循在以下位置找到的示例代码：

[http://kevin.vanzonneveld.net/techblog/article/make_ssh_connections_with_php/](http://kevin.vanzonneveld.net/techblog/article/make_ssh_connections_with_php/)

我能够连接到我的交换机，并成功进行身份验证。但是当我尝试运行命令时，它会失败，并在这篇文章的标题中显示错误消息。

```
 if (!function_exists("ssh2_connect")) die("function ssh2_connect doesn't exist");
          // log in at server1.example.com on port 22
         if(!($con = ssh2_connect("10.14.123.12", 22))){
            echo "fail: unable to establish connection\n";
            } else {
                 // try to authenticate with username root, password secretpassword
                 if(!ssh2_auth_password($con, "root", "mypassword")) {
                          echo "fail: unable to authenticate\n";
                  } else {
                      // execute a command
                      if (!($stream = ssh2_exec($con, "show mac-address" ))) {
                           echo "fail: unable to execute command\n";
                      } else {
                             stream_set_blocking($stream, true);
                             $data = "";
                            while ($buf = fread($stream,4096)) {
                             $data .= $buf;
                      }
                      fclose($stream);
                  }
             }
         } 
```

它在我尝试执行 show mac-address 命令的那一行上快死了。我已经确认这是 switch 命令的正确语法 - 手动尝试过......它返回数据就好了。有什么建议么？谢谢。

# css - 多个元素的 CSS 选择器问题

> ID：11832717
> 
> 赞同：2
> 
> 时间：2012-08-06T17:03:44.173
> 
> 标签：css, css-selectors

我以为我的 CSS 做得很好，但我似乎无法弄清楚为什么会出现这个问题。我一定做错了什么。

因此，如果我想选择多个作为 div 子元素的元素，我可以编写：

```
#mydiv > input, label{

} 
```

我对么？我认为这是真的，直到我意识到我网站中的其他输入和标签正在继承这些 CSS 属性，即使它们不在名为#mydiv 的 div 中。要解决我不得不使用的问题：

```
#mydiv > input, #mydiv > label {

} 
```

但我很确定这不是最快的方法。我尝试检查 W3.org 上的[选择器页面](http://www.w3.org/TR/CSS2/selector.html)，但他们没有为我的情况提供示例。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:06:14.377

> 我对么？

不[，分组选择器](http://www.w3.org/TR/CSS2/selector.html#grouping)（逗号）的优先级最低，因此您不能使用它来选择多个使用此选择器的 div 子元素：

```
#mydiv > input, label 
```

最简洁的选择器是您自己找到的：

```
#mydiv > input, #mydiv > label 
```

* * *

[您可以使用LESS](http://lesscss.org/)或[Sass](http://sass-lang.com/)中的嵌套规则稍微干一些事情，尽管这确实会在您的代码和/或构建过程中引入依赖关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:06:30.300

您的第二个片段是使用纯 CSS 实现它的最简单方法。逗号分隔独立的CSS 选择器，这就是为什么您需要为两个选择器都`,`以每个开头。`#mydiv`

您可以使用类似[LESS](http://lesscss.org/)的东西，它允许[嵌套规则](http://lesscss.org/#-client-side-usage)。非德语示例：

```
#header {
  h1 {
    font-size: 26px;
    font-weight: bold;
  }
  p { font-size: 12px;
    a { text-decoration: none;
      &:hover { border-width: 1px }
    }
  }
} 
```

但是使用纯 CSS 可能会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:12:06.800

你的第二种方法很好

```
#mydiv > input, #mydiv > label {

} 
```

如果您想以某种方式在不使用逗号分隔的多个选择器的情况下执行此操作，则可以为输入和标签元素使用类名

```
.your-class-name {

} 
```

或者如果出于某种原因 input 和 label 是#mydiv 仅有的两种子元素类型，那么您可以像这样使用通用选择器：

```
#mydiv > * {

} 
```

# ruby-on-rails - ActiveRecord - 执行查询后如何包含？

> ID：11832720
> 
> 赞同：1
> 
> 时间：2012-08-06T17:03:53.753
> 
> 标签：ruby-on-rails, activerecord

在具有 1->N->N 关联的场景中。例如：帖子->评论->投票（投票将是对评论投票的人的姓名列表）。要显示包含查询的页面，可能如下所示：

```
@post = Post.where(:id => 100).includes({:comments => :votes}).first 
```

我开始添加缓存支持。这意味着如果评论部分已经被缓存，我将不需要一直运行包含评论/投票。所以我想知道是否有办法让代码看起来像：

```
# controller
@post = Post.find(100)

# view
<% cache('comments', @post.last_comment_time do %>
    <% @post.includes({:comments => :votes}).comments.each do |comment| # ???? %>
<% end %> 
```

运行“后查询”包括，将“填写”关联。因此@post.comments 将被填充，并且每条评论都将包含所有投票。有没有办法做到这一点？

PS 我知道视图不是运行查询的最佳位置，这只是一个示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:31:35.737

`all`在最新版本的 rails 中，所有 finder-methods 都返回一个代理对象，只有在您向它发送一些迭代器方法（如或`first`在您的情况下）时才会触发数据库调用。这就是为什么您可以链接所有调用，例如`Post.where.order.sort.bla`.

`includes`虽然加载后模型并稍后使用调用是不可能的。`includes`通过`join`调用与模型实例一起加载的关系来工作，这样您就只有一个数据库调用，而不是每个关系一个。

在您的视图中执行 active_record 代码也是一种不好的做法。数据检索是控制器的责任，而不是视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-20T18:47:42.180

这是一个相当古老的问题，但现在*可以*像这样完成

```
# controller
@post = Post.find(100)

# view
<% cache('comments', @post.last_comment_time do %>
    <% ActiveRecord::Associations::Preloader.new.preload @post, comments: :votes # this will trigger one query %>
    <% @post.comments.each do |comment| # this will not trigger any additional queries %>
<% end %> 
```

不是最干净的方式，但它可以完成工作

# ruby-on-rails - highcharts & rails

> ID：11832726
> 
> 赞同：0
> 
> 时间：2012-08-06T17:04:14.593
> 
> 标签：ruby-on-rails, charts, highcharts

嗨，我正在尝试在我的应用程序上使用 highcharts ......为此，我正在关注[highcharts 情节](http://railscasts.com/episodes/223-charts?view=asciicast)，脚本有效，但是当我想输入真实数据时，我得到了这个： ![在此处输入图像描述](../Images/36596ac17723bee0a4aeeec76bb835d9.png)

我已按照所有步骤操作，但这是我的模型：

```
class TankingLog < ActiveRecord::Base
belongs_to :gas_station 
belongs_to :car
attr_accessible :car_id, :cost, :date, :gallon, :gas_station_id, :km
validates_presence_of :cost, :date,:gallon,:km
validates_numericality_of :cost, :gallon
validates_numericality_of :km #:only_integer
def self.total_on(date)
    where("date(date) = ?",date).sum(:cost)
end
end 
```

这是我的 html.erb：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
        }
    </style>
</head>
<body>
  <div class="container">
  <h1>Listing Tankings</h1>
  <% if @tankinglog.count<1 %>
    <p>
    There are no tankings for this car. Do you want to <%= link_to 'create a new tanking', new_user_car_tanking_log_path(@user, @car)%>
    </p>
  <% else %>
  <script type="text/javascript" charset="utf-8">
    $(function () {
      new Highcharts.Chart({
      chart: { renderTo: 'foo_chart' },
      title: { text: 'Tankings by Day' },
      xAxis: { type: 'datetime' },
      yAxis: {
      title: { text: 'Cost' }
    },
      series: [{
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= 0.weeks.ago.at_midnight.to_i * 1000 %>,
        data: [data: <%= (1.weeks.ago.to_date..Date.today).map { |date| TankingLog.total_on(date).to_f}.inspect %>]
      }]
      });
    });
  </script>
  <div id="foo_chart" style="width: 560px; height: 300px;"></div>

    <table class="table table-condensed">
      <tr>
        <th>Cost</th>
        <th>Gallon</th>
        <th>Km</th>
        <th>Date</th>
        <th>Gas Station's id</th>
        <th></th>
      </tr>
      <% for tankinglog in @tankinglog  %>
        <tr>
          <td><%= number_to_currency (tankinglog.cost) %></td>
          <td><%= tankinglog.gallon %></td>
          <td><%= tankinglog.km %></td>
          <td><%= tankinglog.date %></td>
          <td><%= tankinglog.gas_station_id %></td>
        </tr>
      <% end %>
    </table>
    <br />
    <%= link_to 'New tanking', new_user_car_tanking_log_path(@user, @car), :class => "btn btn-primary" %>
  <% end %>
  <br />
  <br />
  <%= link_to 'back', user_cars_path(current_user), :class => "btn btn-primary" %>
  </div> <!-- /container -->
</body> 
```

感谢您的帮助

这也是我的脚本显示： ![在此处输入图像描述](../Images/b040a06b79494fff6e88faba197cb9d5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:48:02.810

你有它试图渲染到的 foo_chart div 吗？在包含 highcharts 的 js 之前是否包含了 jQuery 的 js？浏览器“控制台”的内容是什么？控制台有没有js错误？您可以将生成的 html 分享为文本而不是图像吗？

如何从控制台获取错误（Chrome） ![在此处输入图像描述](../Images/c7fd0e3dd505741b997691cd9f802ee0.png)

点击行号会带你到js崩溃的确切地方

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T19:58:01.140

是我的错，我有一个语法错误，它是：

```
series: [{
        pointInterval: <%= 1.day * 1000 %>,
        pointStart: <%= 0.weeks.ago.at_midnight.to_i * 1000 %>,
        data: <%= (0.weeks.ago.to_date..Date.today).map { |date| TankingLog.total_on(date).to_f}.inspect %>
      }] 
```

不是

```
series: [{
    pointInterval: <%= 1.day * 1000 %>,
    pointStart: <%= 0.weeks.ago.at_midnight.to_i * 1000 %>,
    data: [data: <%= (1.weeks.ago.to_date..Date.today).map { |date| TankingLog.total_on(date).to_f}.inspect %>]
  }] 
```

感谢帮助

# asp.net - ASP.NET MVC3 链接区域“找不到资源”

> ID：11832727
> 
> 赞同：0
> 
> 时间：2012-08-06T17:04:30.130
> 
> 标签：asp.net, asp.net-mvc-3, razor, hyperlink, area

我刚刚创建了一个新区域来组织我的代码。但目前我无法将它从我的“基础”或“根”索引页面链接到我的新区域页面。

```
@Html.ActionLink("Tube Record Form", "BearingAssemblyForm", "_HiCT", new { area = "HICT" }, null) 
```

* * *

```
 public class HICTAreaRegistration : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "HICT";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute(
            "HICT_default",
            "HICT/{controller}/{action}/{id}",
            new {controller = "_HiCT", action = "BearingAssemblyForm", id = UrlParameter.Optional }
        );
    }
} 
```

无法找到该资源。似乎它的链接错误

> 请求的 URL：/HICT/HiCT/BearingAssemblyForm
> 控制器：HiCT，视图/操作：BearingAssemblyForm，区域：HICT。

我怎么会喜欢这个？

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:07:50.403

尝试这个：

```
@Html.ActionLink("LinkText",
        "ActionName",
        "ControllerName",
        new { area = "HICT" }, null) 
```

我认为您没有使用正确的`@Html.ActionLink`方法重载。

首先，查看您的区域是否已正确注册：

```
public class Routes : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "HICT";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute(
            "HICT_default",
            "HICT/{controller}/{action}/{id}",
            new { controller = "_HiCT", action = "BearingAssemblyForm", id = UrlParameter.Optional }
    );
} 
```

确保您在`RegisterAllAreas`文件中调用`Global.asax.cs`：

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:06:50.503

/Master/BearingAssemblyForm

通常，Master 是控制器，第二部分是动作，因此您的控制器名称似乎与您的路线不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:10:06.550

你在打电话吗：

```
AreaRegistration.RegisterAllAreas(); 
```

在`Application_Start`您的 Global.asax 中？您使用什么服务器进行开发 Cassini、IISExpress、IIS？

在查看更多详细信息后进行编辑。

如果您有此代码，请在您的管理区域注册文件中

```
context.MapRoute(
    "Admin_default",
    "Admin/{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = UrlParameter.Optional },
    new string[] { "CoolProject.Web.Areas.Admin.Contollers" }
); 
```

我认为有一个错字，`CoolProject.Web.Areas.Admin.Contollers`应该是`CoolProject.Web.Areas.Admin.Controllers`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:12:33.043

这是一个诡计，但这应该有效。

```
@Html.ActionLink("Tube Record Form", "action", "Area/controller") 
```

# iphone - 当表包含跨列单元格时，使用目标 c 和 xpath 查找列索引

> ID：11832733
> 
> 赞同：0
> 
> 时间：2012-08-06T17:05:06.593
> 
> 标签：iphone, html, objective-c, xpath, libxml2

我在 iPhone 应用程序中使用 hpple 和 libxml2 解析表。当兄弟单元格使用 colspan 跨越多行时，我在查找列索引时遇到了一个真正的问题。

我看到了[这个问题](https://stackoverflow.com/questions/1166452/finding-column-index-using-jquery-when-table-contains-column-spanning-cells) 但我不能使用 jquery 来计算列。

考虑下表

```
<table>
  <tbody>
    <tr>
      <td>One</td>
      <td>Two</td>
      <td id="example1">Three</td>
      <td>Four</td>
      <td>Five</td>
      <td>Six</td>
    </tr>
    <tr>
      <td colspan="2">One</td>
      <td colspan="2">Two</td>
      <td colspan="2" id="example2">Three</td>
    </tr>
    <tr>
      <td>One</td>
      <td>Two</td>
      <td>Three</td>
      <td>Four</td>
      <td>Five</td>
      <td>Six</td>
    </tr>
  </tbody>
</table> 
```

对于 id 为“example1”的单元格，如何将列索引设为 6 NOT 3？

编辑添加了更多细节

```
NSString *xpathQuery = [NSString stringWithFormat:@"1 
+ count(//a[contains(@href,'testHref')]
/../preceding-sibling::td[not(@colspan)])
+ sum(//a[contains(@href,'testHref')]/../preceding-sibling::td/@colspan)
+ sum(@colspan)
- count(@colspan)",bookingUrl, bookingUrl];

//Execute XPath
NSArray *array = [parser searchWithXPathQuery:columnCount]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:25:20.733

这似乎有效：

```
1 + count(preceding-sibling::td[not(@colspan)])
+ sum(preceding-sibling::td/@colspan)
+ sum(@colspan)
- count(@colspan) 
```

将 xpath`<td>`作为当前节点运行。

# mongodb - Mongod重启后连接断开

> ID：11832750
> 
> 赞同：0
> 
> 时间：2012-08-06T17:06:11.563
> 
> 标签：mongodb

我正在使用 Mongo Java 驱动程序 (2.8.0) 连接到 Mongo 实例。

我注意到，如果我重新启动 mongod，那么重新启动后的第一个操作（即使是简单的 count()）总是会因 EOFException 或 Broken 管道而失败。

我正在使用以下 Mongo 选项：

```
opts.autoConnectRetry = true;
opts.maxAutoConnectRetryTime = 2000L;
opts.connectTimeout = 30000;
opts.socketTimeout = 60000; 
```

有没有办法告诉驱动程序尝试重新建立连接？我认为“autoReconnectRetry”会做到这一点，但这只有在连接被“发现”（通过单个失败的操作）被破坏后才有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:20:36.923

[AutoConnectRetry](http://api.mongodb.org/java/current/com/mongodb/MongoOptions.html#autoConnectRetry)选项将在打开与服务器的连接时重试，但不能保证您不会收到读取异常。您仍然需要处理应用程序中的异常并在适当时重试。

来自文档的模糊：

> 如果为 true，驱动程序将继续尝试连接到同一服务器，以防套接字无法建立。持续重试的最长时间，默认为 15 秒。这对于通过阻止操作来避免在服务器暂时关闭时引发一些异常很有用。平滑过渡到新的主节点也很有用（以便在重试时间内选出新的主节点）。请注意，当使用此标志时： - 对于副本集，驱动程序将尝试连接到旧主服务器，而不是立即故障转移到新主服务器 -**这不会阻止在读/写中引发异常套接字上的操作，必须由应用程序处理**. 即使此标志为假，驱动程序也已经具有自动重新创建断开连接并重试读取操作的机制。默认为假。

# javascript - 如何在数据表的命令链接中使用 ajax 禁用表单字段

> ID：11832752
> 
> 赞同：0
> 
> 时间：2012-08-06T17:06:18.273
> 
> 标签：javascript, ajax, jsf, facelets

我在上面有一个表单，它捕获合同记录并将它们显示在具有命令链接“编辑”标签的数据表中。当我单击“编辑”时，我希望在表单中填充此合同数据，但禁用“合同号”字段。我正在尝试在 Ajax onEvent 标记中禁用此功能，并且它正在工作（即禁用）。但是，当使用 ajax 时，不会在表单中填充/显示字段。如果我删除它，一切都很好，只是合同编号是可编辑的。这些是我的编辑标签。

```
<h:commandLink id="editLink"  value="#{bundle.ListUnitEditLink}"   >
   <f:ajax   onevent="disablePK" listener="#{contractManager.updateContract}"  />
</h:commandLink> 
```

这是我的后盾。

```
public String updateContract() {
    System.out.println("Now in UPDATECONTRACT method and serious debugging");
    current = (Contract) items.getRowData();
    this.newContractId=current.getContractid();
    this.newContractDesc=current.getContractdesc();
    this.newContractDt=current.getContractdt();
    this.newContractAmt=current.getContractamt();
    this.newContractStrtDt=current.getContractstrtdt();
    this.newExpDuration=current.getExpduration();
    this.newCtdBy=current.getCtdby();
    this.newCtdOn=current.getCtdon();
    this.lstUpdBy=current.getLstupdby();
    this.lstUpdOn=current.getLstupdon();
    return "contracts";
} 
```

bean 中的属性被赋予了正确的值，但它们没有出现在要编辑的表单中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T07:57:26.310

我通过在 ajax 标记中添加 render=@all 来解决我的问题

```
 <h:commandLink id="editLink"  value="#{bundle.ListUnitEditLink}"  
                                       actionListener="#{contractManager.updateContract}">
         <f:ajax   onevent="disablePK"   render="@all"  />

 </h:commandLink> 
```

# c# - 在消息框中显示表单数据

> ID：11832755
> 
> 赞同：1
> 
> 时间：2012-08-06T17:06:36.713
> 
> 标签：c#, combobox, messagebox

当用户单击提交以验证输入是否正确时，我试图在消息框中显示 3 个值。

这 3 个值来自组合框，形式为：年龄、身高、体重。

在我当前的设置中，该框只会显示“年龄：”，实际数值位于上边框。

如何让 3 个组合框数据项出现在具有适当标题的消息框中？

像这样：年龄：27身高：62体重：180

数据存储在变量 age_Num.Text、height_Num.Text 和 weight_Num.Text 中

```
MessageBox.Show("Age:", age_Num.Text); //just shows "Age:". Value is in titlebar of mb 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:11:50.317

如果是 a ，您可以通过属性`ComboBox`获取选定的文本。[`ComboBox.SelectedText`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedtext.aspx)

要从多个值构建字符串，您可以使用[`String.Format()`](http://msdn.microsoft.com/en-us/library/system.string.format.aspx).

```
string age = age_num.SelectedText;
string height = height_Num.SelectedText;
string weight = weight_Num.SelectedText
string text = String.Format(
                     "Age: {0}, Height: {1}, Weight: {2}", age, height, weight);
MessageBox.Show(text); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:11:48.857

您必须将这些值连接成一个字符串。试试这个，使用`StringBuilder`：

```
 StringBuilder MessageText = new StringBuilder();
        MessageText.AppendLine(string.Format("Age: {0}", age_Num.Text));
        MessageText.AppendLine(string.Format("Height: {0}", height_Num.Text));
        MessageText.AppendLine(string.Format("Weight: {0}", weight_Num.Text));
        MessageBox.Show(MessageText.ToString()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:10:04.833

您可以直接使用组合的值，

```
MessageBox.Show("Sometext 1:" + cbo1.SelectedValue.ToString() + " Sometext 2:" + cbo2.SelectedValue.ToString() + " Sometext 3:" + cbo3.SelectedValue.ToString()); 
```

或者你已经在变量中。

```
MessageBox.Show("Age: " + age_num.Text + " Height: " + age_num.Text + " Sometext 3: " + weight_Num.Text); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T17:23:30.567

如果您不喜欢上述任何一项，只需创建一个根据需要设置的对话框表单，并使用静态功能以模态方式显示它。

# vim - Vim - 跟踪准确的空白计数

> ID：11832760
> 
> 赞同：4
> 
> 时间：2012-08-06T17:06:54.643
> 
> 标签：vim, whitespace

在 Eclipse 和 Notepad++ 中，我都配置了我的文本编辑器，因此空格的中心有一个半透明的点，这样可以很容易地计算空格。在我的文本编辑中，我更喜欢使用空格而不是制表符，当使用 Python 等对空格敏感的语言时，此功能至关重要。

我附上了带有一些虚拟代码的屏幕截图，以防我的措辞不清楚。

无论如何，有没有办法在 Vim（或 GVim）中接近这个功能？我想有[突出显示](https://stackoverflow.com/questions/4998582/show-whitespace-characters-in-gvim)，但这似乎有点低于标准。通过查看列号也有很好的老式数学。我还有哪些其他选择？

![空白示例](../Images/09577026eccd80678941a143e272d864.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:20:15.760

vimrc 中的这些行应该给你一个近似值，但你不会得到正常或前导空格的点：只有尾随空格。这是 Vim 的限制。

```
set list
set listchars=
set listchars+=tab:»\ 
set listchars+=extends:› 
set listchars+=precedes:‹ 
set listchars+=nbsp:· 
set listchars+=trail:· 
```

见`:help 'list'`和`:help 'listchars`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T18:47:18.837

我同意 romainl 的回答，但想提一下[缩进指南](https://github.com/nathanaelkane/vim-indent-guides)，它可以根据您当前的标签大小设置为缩进着色。

# http - Netty 中 HttpMessageDecoder.skipControlCharacters 上的 NullPointerException

> ID：11832764
> 
> 赞同：1
> 
> 时间：2012-08-06T17:07:03.897
> 
> 标签：http, scala, netty

尝试在 Netty 中读取 HTTP 请求时出现奇怪的错误：

```
java.lang.NullPointerException
at
 org.jboss.netty.handler.codec.http.HttpMessageDecoder.skipControlCharacters(HttpMessageDecoder.java:409)
at org.jboss.netty.handler.codec.http.HttpMessageDecoder.decode(HttpMessageDecoder.java:184)
at org.jboss.netty.handler.codec.http.HttpMessageDecoder.decode(HttpMessageDecoder.java:107)
at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:470)
at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:443)
at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)
at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)
at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:351)
at org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:282)
at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:202)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:679) 
```

堆栈跟踪不会出现在我的代码中，我不知道如何调试它？

```
class RouteHandler(default: Tuple2[String, Int]) extends SimpleChannelUpstreamHandler {

  override def handleUpstream(ctx: ChannelHandlerContext, e: ChannelEvent) {
    e match {
      case evt: UpstreamMessageEvent =>
        evt.getMessage match {
          case req: HttpRequest => {
            val projectHdr = req.getHeader("HDR")
            RouteHandler.log.info("Project ID: {}", projectHdr)
            val backendServerUri = projectHdr match {
              case null => default
              case uri: String =>
                if (ObjectId.isValid(projectHdr)) {
                  val serverData = MappingService.resolveServer(new ObjectId(projectHdr))
                  (serverData.host(), serverData.port())
                }
                else
                  default
            }
            RouteHandler.log.info("Route to {}", backendServerUri)
            val pipeline = ctx.getPipeline
            pipeline.synchronized {
              val handler = new ForwardRequestHandler(backendServerUri._1, backendServerUri._2)
              pipeline.get(HANDLER_NAME) match {
                case null => pipeline.addLast(HANDLER_NAME, handler)
                case _ => pipeline.replace(HANDLER_NAME, HANDLER_NAME, handler)
              }
            }
          }
          case z => RouteHandler.log.warn("Can not handle {}", z.getClass)
        }
      case z: DefaultExceptionEvent => RouteHandler.log.error("Exception from Netty", z.getCause)
      case z =>
    }
    super.handleUpstream(ctx, e)
  }

  override def exceptionCaught(ctx: ChannelHandlerContext, e: ExceptionEvent) {
    RouteHandler.log.error("Caught", e.getCause)
    e.getChannel.close()
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:37:12.117

所以只是为了记录......错误是 HttpMessageDecoder 在 Channels 之间共享，这是不允许的，因为它没有用 @Sharable 注释

# php - php无法从mysql读取带有空格的数据

> ID：11832765
> 
> 赞同：1
> 
> 时间：2012-08-06T17:07:08.600
> 
> 标签：php, mysql

我有一个带有动态表的页面，其中填充了来自 mysql 数据库的数据。该表不仅仅是一张普通的表，其中一列包含一个复选框，其值为数据库的 id（主键）。但是我要检索的来自 mysql 的数据在它们之间有空格。

例子：

```
id|name
1 |Chuck Norris
2 |Bruce Lee
3 |Jackie Chan 
```

从列名中，我可以找到 Chuck、Bruce 和 Jackie，但不是 Norris、Lee 和 Chan。

我必须页面即：delete.php 和 checkIt.php

delete.php 的一部分包含`

```
 $query = "SELECT * FROM account";
    $result = mysql_query($query) or die ("Query failed");
    $num = mysql_num_rows($result);

    echo "<form method='post' action='checkIt.php'><table>";
    if($num>0)
    {

        echo '<tr>
                <td></td>
                <td>ID</td>
                <td>NAME</td>';
        echo '</tr>';

        while($row = mysql_fetch_array($result))
        {   
            echo "<tr>
                    <td><input type='checkbox' name='names[]' value=".$row['name']."/></td>
                    <td>".$row['id']."</td>
                    <td>".$row['name']."</td>";
            echo "</tr>";
        }
    }
    echo "</table><br><input type='submit' value='Delete' /></form>";
?>` 
```

checkIt.php 的一部分包含 `

```
for ($i=0; $i<count($_POST['names']); $i++)
{ 
    $name = $_POST['names'][$i]; 
    echo " ".$name;
    $sql="DELETE from account WHERE name='$name';";
    $result=mysql_query($sql);
}
?>` 
```

`$name`从 checkIt.php 只得到一个字。我想从 mysql 中获取完整的数据，以便 DELETE 正确执行。有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:16:52.403

您需要将`value`复选框输入中的引号括起来。

现在它出来了：

```
<input type='checkbox' name='names[]' value=chuck norris/> 
```

将您的回声更改为：

```
echo "<tr>
          <td><input type='checkbox' name='names[]' value='".$row['name']."' /></td>
          <td>".$row['id']."</td>
          <td>".$row['name']."</td>"; 
```

应该解决问题。

此外，请务必转义`$_POST`您在查询中使用的参数，否则您很容易受到 SQL 注入的攻击。

# php - 使用 INSERT 更新 MySQL

> ID：11832766
> 
> 赞同：0
> 
> 时间：2012-08-06T17:07:09.053
> 
> 标签：php, mysql, codeigniter, sql-update

我正在使用 PHP、MySQL 和 CodeIgniter。我有一张`product`桌子和`product_item`一张桌子。

`product`表包含主要*Product*的信息，并`product_item`包含用于制作*Product*的材料的信息。

在编辑*Product*时，我还需要更新`product_item`表格。

示例：我向表中添加了一项，因此我需要`INSERT`将值添加到表中。

我有两个想法：

1.  只需从表单中获取值，如果项目已经存在`UPDATE`，否则`INSERT`循环遍历项目。
2.  [`INSERT ... ON DUPLICATE KEY UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

可能有很多方法，但是执行此操作的最有效/最佳做法是什么？通常我有大约 1-10 行需要考虑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:03:13.327

REPLACE 的工作方式与 INSERT 完全相同，只是如果表中的旧行与 PRIMARY KEY 或 UNIQUE 索引的新行具有相同的值，则在插入新行之前删除旧行。

# java - LinkedBlockingQueue 中的死锁（？）

> ID：11832770
> 
> 赞同：1
> 
> 时间：2012-08-06T17:07:24.600
> 
> 标签：java, concurrency, queue

我有一个非常基本的线程池代码。它调用一个位于linkedblockingqueue 中的工作对象池。该代码只是通过重新循环工作对象来打印出输入数据。

我发现以下一致的死锁/冻结：

```
public class throttleheapthreadpool{
            private quoteworkerobject[] channels;
            private LinkedBlockingQueue<quoteworkerobject> idlechannels;
            public throttleheapthreadpool(int poolsize,int stocks){
        channels=new quoteworkerobject[poolsize];
        idlechannels=new LinkedBlockingQueue<quoteworkerobject>();

        for(int i=1;i<poolsize;i++){
            channels[i]=new quoteworkerobject(idlechannels);
            idlechannels.add(channels[i]);//All WORKERS to Idle pool to start
        }
    }

    public void execute(Integer quote){
        quoteworkerobject current = null;
        try {
                        //extract worker from pool
            current = (quoteworkerobject)idlechannels.take();
            current.put(quote);
        } catch (InterruptedException e) {
        }
    }

    class quoteworkerobject{
        LinkedBlockingQueue<Integer> taskqueue=new LinkedBlockingQueue<Integer>(); 
        Thread quotethread=null;
        LinkedBlockingQueue<quoteworkerobject> idle=null;
        @SuppressWarnings("unchecked")
        public quoteworkerobject(LinkedBlockingQueue<quoteworkerobject> idlechannels){
            this.idle=idlechannels;
            Runnable r=new Runnable(){
                public void run() {
                    insertquote();
                }
            };
            quotethread=new Thread(r);
            quotethread.start();//spawn a thread from the worker 
        }
        public void put(Integer  quote){
            taskqueue.add(quote);
        }
        public void insertquote(){
            try{
                Integer thisquote=taskqueue.take();
                idle.add(this);
            }
            catch(Exception ex){
            }

        }

    }

    public static void main(String[] args){
        throttleheapthreadpool pool=new throttleheapthreadpool(5,200);
        Random randomGenerator = new Random();

        for(int node=0;node < 20;node++){
            int d=randomGenerator.nextInt(5*200);
            pool.execute(d);
        }
    }

} 
```

此代码在第 8 次执行时始终冻结 - 在点 current = (quoteworkerobject)idlechannels.take();

上面有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T08:40:18.563

这正是我（讨厌？）不喜欢使用这样的代码的原因。您应该考虑让您/我们的生活更轻松，并编写即使在几个月后您也可以查看并证明它的代码：相应地命名您的变量，编写简短的文档或解释等。我花了 25 分钟来重构，因为我不明白发生了什么。

我添加了一个小的重构，我还添加了一些断点，看看代码 - 解释在里面。但问题在于 insertQuote 方法——它完成得太早了。

```
import java.util.Random;
import java.util.concurrent.LinkedBlockingQueue;

public class Pool {
private Worker[] workers;
private LinkedBlockingQueue<Worker> workerQueue;

/**
 * Create a pool of 5 workers and a {@link LinkedBlockingQueue} to store them
 */
public Pool(int poolsize) {
    //1\. First you get here : you create a Pool of 5 Worker Threads and a Queue to store them
    System.out.println("1.");
    workers = new Worker[poolsize];
    workerQueue = new LinkedBlockingQueue<Worker>();

    for (int i = 0; i < poolsize; i++) {
        //2\. You instantiate 5 worker Threads and place each of them on the Queue
        System.out.println("2.");
        workers[i] = new Worker(workerQueue);
        workerQueue.add(workers[i]);
    }
}

public void execute(Integer quote) {
    Worker current = null;
    try {
        // extract worker from pool
        //6\. Get a worker from the Queue
        System.out.println("6.");
        current = workerQueue.take();
        current.put(quote);
    } catch (InterruptedException e) {
    }
}

/**
 * 
 *
 */
class Worker {
    LinkedBlockingQueue<Integer> taskqueueForEachWorker = new LinkedBlockingQueue<Integer>();
    LinkedBlockingQueue<Worker> workerQueue = null;

    public Worker(LinkedBlockingQueue<Worker> idlechannels) {
        new Thread(new Runnable() {
            @Override
            public void run() {
                //3\. You call the insert quote method
                System.out.println("3.");
                insertquote();
            }
        }).start();
    }

    public void put(Integer quote) {
        //7\. Add a task for each Thread to do
        System.out.println("7.");
        taskqueueForEachWorker.add(quote);
    }

    //TODO The problem is here: After you execute this line : workerQueue.add(this); this method ends, NO MORE worker Threads are put on the queue,
    // thus at point 6 you block, well because there are no more worker Threads an no one add them.

    public void insertquote() {
        try {
            // 4\. You try to take an Integer from the Pool of tasks from rach Thread, but there is nothing yet - it is empty, thus each Thread (worker)
            // blocks here, waiting for a task
            System.out.println("4.");
            Integer thisquote = taskqueueForEachWorker.take(); // This will successed only after 7.
            workerQueue.add(this);
        } catch (Exception ex) {
        }
    }
}

public static void main(String[] args) {
    Pool pool = new Pool(5);
    Random randomGenerator = new Random();

    for (int node = 0; node < 20; node++) {
        int d = randomGenerator.nextInt(5 * 200);
        System.out.println("5.");
        pool.execute(d);
    }
} 
```

}

输出将是 1\. 2\. 3\. 4\. 2\. 3\. 4\. 2\. 3\. 4\. 2\. 3\. 4\. 2\. 3\. 4\. 5\. 6\. 7\. 5\. 6\. 7\. 5\. 6\. 7\. 5\. 6\. 7\. 5\. 6\. 7\. 5\. 6.

看到最后一行是 6。如果这里阻塞，因为方法 insertQuote 已退出，因此队列现在为空，则所有工作线程都已被占用。

在我看来，因为您的工作线程每个都使用一个单独的队列，所以您应该实现“工作窃取”模式或**Deque**。也调查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:39:00.033

请参阅下面我的重构（仍然不完美，但更具可读性）。您的问题如下：

*   您创建 4 个工人（在 的构造函数中从 1 循环到 5 `throttleheapthreadpool`）
*   每个工作人员在单独的线程中运行`insertquote` **一次**并返回空闲池

因此，总体而言，您提交了 4 个已完成的作业，并且工作人员返回队列，然后您再给他们 4 个作业（总共 8 个），除了他们不使用该作业，因为他们的`insertquote`方法已经退出。

解决方案：`insertquote`在while循环中运行：

```
public void insertquote() {
    try {
        while (true) {
            taskqueue.take();
            idle.add(this);
        }
    } catch (Exception ex) {
    }
} 
```

有关信息，这是我当前版本的代码：

```
public class ThrottleHeapThreadPool {

    private final BlockingQueue<QuoteWorkerObject> idlechannels = new LinkedBlockingQueue<QuoteWorkerObject>();

    public static void main(String[] args) {
        ThrottleHeapThreadPool pool = new ThrottleHeapThreadPool(5, 200);
        Random randomGenerator = new Random();

        for (int node = 0; node < 20; node++) {
            int d = randomGenerator.nextInt(5 * 200);
            pool.execute(d);
        }
    }

    public ThrottleHeapThreadPool(int poolsize, int stocks) {

        for (int i = 1; i < poolsize; i++) {
            QuoteWorkerObject worker = new QuoteWorkerObject(idlechannels);
            idlechannels.add(worker);//All WORKERS to Idle pool to start
            worker.init();
        }
    }

    public void execute(Integer quote) {
        try {
            //extract worker from pool
            QuoteWorkerObject worker = idlechannels.take();
            worker.put(quote);
        } catch (InterruptedException e) {
        }
    }

    class QuoteWorkerObject {

        private final BlockingQueue<Integer> taskqueue = new LinkedBlockingQueue<Integer>();
        private final BlockingQueue<QuoteWorkerObject> idle;

        @SuppressWarnings("unchecked")
        public QuoteWorkerObject(BlockingQueue<QuoteWorkerObject> idlechannels) {
            this.idle = idlechannels;
        }

        public void init() {
            new Thread(new Runnable() {
                public void run() {
                    insertquote();
                }
            }).start();
        }

        public void put(Integer quote) {
            taskqueue.add(quote);
        }

        public void insertquote() {
            try {
                while (true) {
                    taskqueue.take();
                    idle.add(this);
                }
            } catch (Exception ex) {
            }
        }
    }
} 
```

# xcode - 此团队中没有 ID 为 xxxxxxxxxx 的 IOS 证书

> ID：11832772
> 
> 赞同：10
> 
> 时间：2012-08-06T17:07:30.753
> 
> 标签：xcode, xcode4.3, provisioning, ios-provisioning

在 Xcode 中：

**组织者 > 设备**

然后在*左侧* **Library > Provisioning Profiles**

单击右下角的**刷新- 这运行正常**

在即将到期的条款上单击**续订。**我最终收到一条提示：“此团队中没有 ID 为 'xxxxxxxxxx' 的 IOS 证书。”

当然，该消息包含一个真实的 ID，我只是用 Xs 将其涂抹掉。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:04:59.020

在多次删除和更新配置文件后，它终于起作用了。在这一点上我又高兴了，所以我没有心情问任何问题..

# 重要的

我已经在 Xcode 中多次删除并创建了我需要的配置文件，但它只有在我在在线供应门户中重新创建后才有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T01:17:12.387

I am having the same problem. I called Apple for support. They referred me to following these instructions: [https://developer.apple.com/legacy/library/technotes/tn2250/_index.html](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html) heading: How do I delete/revoke my certificates and start over fresh?

I was concerned about following those instructions, but was assured by this statement in the instructions: "Important: Members of the Standard iOS Developer Program can be assured that replacing either your developer or distribution certificate will not affect any existing apps that you've published in the iOS App Store, nor will it affect your ability to update those apps."

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-20T23:30:07.330

从 Xcode 首选项中删除和重新添加 AppleID 对我有帮助。

# php - 每次发布后更新按钮（php，sql）

> ID：11832778
> 
> 赞同：0
> 
> 时间：2012-08-06T17:07:58.167
> 
> 标签：php, sql, button, posts

我需要一些有关 PHP 和 SQL 的帮助。在这里寻找旧问题和答案的帮助，但找不到像我的问题一样的东西。我正在做一个网站，您可以在其中发布不同主题（工作、家庭、学校等）的笔记。在从我的数据库中选择的每条笔记之后，我都有一个删除按钮，用于删除选定的笔记。

现在我想在删除按钮旁边添加一个更改/更新按钮。当按下更新按钮时，我想被重定向到原始注释所在的另一个页面（例如 update.php），准备输入新内容或更改注释。然后按下另一个更新按钮，发送并替换我的数据库表中的注释。我不知道该怎么做，我会非常感谢我能得到的所有帮助。

这是我的代码，它显示了主题工作的所有当前帖子以及更新按钮应该在删除按钮旁边的位置。

```
<?php 

if(isset($_POST['delete'])){
   $id = $_POST['delete_rec_id'];  
   $query = "DELETE FROM notes WHERE id=$id"; 
   $result = mysql_query($query);
}

$query = "SELECT * FROM notes WHERE subject='Work' order by id desc";
$result = mysql_query($query);
while ($row = mysql_fetch_array($result)) { 
        $id = $row['id'];
        $subject = $row['subject'];
        $date = $row['date'];
        $note = $row['note']; 

        print "<p><strong>$subject</strong> ($id), $date </p>"; 
        print "<p> $note </p>";

    ?>
    //delete button starts here here
    <form id="delete" method="post" action="">
    <input type="hidden" name="delete_rec_id" value="<?php print $id; ?>"/> 
    <input type="submit" name="delete" value="Delete!"/>  
    </form>
    //THIS IS WHERE THE DELETE BUTTON SHOULD BE
    <?php
}   
?> 
```

非常感谢我能得到的任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:59:23.517

基本上，更新按钮只会将用户重定向到另一个页面。所以：

```
<form id="delete" method="post" action="">
<input type="hidden" name="delete_rec_id" value="<?php print $id; ?>"/> 
<input type="submit" name="delete" value="Delete!"/>  
</form>
<input type="button" name="redirect<?php print $id; ?>" value="Update" onClick="location.href( 'http://www.domain.com/update.php?id=<?php print $id; ?>');"/> 
```

在您的`update.php`文件中，您只是`$_GET`用来访问行的 ID。

```
$id =$_GET['id'];
echo "You want to edit the row with ID = ".$id; 
```

# sql - 服务器正在写入数据库和 VB.Net 应用程序同时读取它

> ID：11832779
> 
> 赞同：0
> 
> 时间：2012-08-06T17:07:58.820
> 
> 标签：sql, database

这会是一个问题吗？

当用户买卖或添加商品时，数据库每秒都会发生变化。

我有一个 vb.net 应用程序，它不会将数据写入数据库，但它只会在每次更改时读取数据。因此，一个数据库每小时更改数千次，vb.net 应用程序实时绘制和列出该数据。

如果这不起作用，我有什么选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:13:52.057

你没有说你正在使用什么数据库，但是一些数据库（例如 SQL Server）在读取表时会锁定表，所以如果数据库一直在更新，你可能想要进行脏读。

# php - 确定 URI / URL 中的最后一个文件夹

> ID：11832780
> 
> 赞同：0
> 
> 时间：2012-08-06T17:08:02.050
> 
> 标签：php

我是 php 新手，并试图根据用户 url 返回 true / false。（在drupal中使用它）例如，如果用户在：

[http://www.example.com/training](http://www.example.com/training)我希望它返回 true

[http://www.example.com/training/home](http://www.example.com/training/home)我希望它返回 true

[http://www.example.com/browse/training/results/](http://www.example.com/browse/training/results/) * 我希望它返回 true

对于其他任何事情，尽管我希望它是假的。

[http://www.example.com/training/backpacking](http://www.example.com/training/backpacking)我希望它返回 false。

我的第一个 php 脚本有一个错误……去看看。无论如何，它不会显示在未接受培训的任何内容上，但会显示在不需要的培训子区域上。

```
global $language;
$curr_uri = check_plain(request_uri());

if ($language->language == 'en')
    if (basename(dirname($curr_uri)) == 'training')
        return TRUE;
    else
        return FALSE;
else
    return FALSE; 
```

我理解需要完成什么的概念。我想检查三个特定的 uri，而不是显示在其他任何东西上。我也试过：

```
global $language;
$curr_uri = check_plain(request_uri());

if ($language->language == 'en')
    if ($curr_uri == '/training/home')
        return TRUE;
    else
        return FALSE;
else
    return FALSE; 
```

Adnan ...我不确定您的编辑是什么，但我发现了一个错字，它现在正在使用以下代码：

```
<?php
  global $language;
  $curr_uri = check_plain(request_uri());

if ( $language->language == 'en')
  if($curr_uri == '/training/home' || $curr_uri == '/browse/training/results' )
    return TRUE;
  else
    return FALSE;
else
  return FALSE;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:20:11.610

```
$pairs = array(  array('training'),
                 array('training','home'),
                 array('browse','training','results'));

$urls = explode('/',$_SERVER['REQUEST_URI']);

foreach($pairs as $pair){
  if ( !empty(array_diff($pair,$urls)) )
    return true;
}

return false; 
```

# c# - Container.DataItemIndex 在gridview 内不起作用

> ID：11832785
> 
> 赞同：1
> 
> 时间：2012-08-06T17:08:19.177
> 
> 标签：c#, asp.net

由于某种原因，在我的代码中 container.DateItemIndex 没有在我的代码中返回任何值。

这是我的asp.net：

```
 <asp:Label ID="Label1" runat="server" Text=""></asp:Label>

<form id="form1" runat="server"> 
         <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
             AutoGenerateColumns="False" DataKeyNames="ID" DataSourceID="SqlDataSource1" 
             EnableModelValidation="True" onrowcommand="GridView1_RowCommand" OnRowUpdating="GridView1_RowUpdating" >

             <Columns>
                 <asp:CommandField ShowEditButton="True" ControlStyle-CssClass="savefile"/>
                 <asp:BoundField DataField="ID" HeaderText="ID" InsertVisible="False" 
                     ReadOnly="True" SortExpression="ID" />
                 <asp:BoundField DataField="event_name" HeaderText="event_name" 
                     SortExpression="event_name" />

                 <asp:TemplateField HeaderText="PDF">

           <ItemTemplate>

               <asp:Button ID="Button1" CommandArgument='<%# Container.DataItemIndex %>' CommandName="DownloadFile" runat="server" Text="Button" />

            </ItemTemplate>

           <EditItemTemplate>

               <asp:FileUpload ID="FileUpload1" runat="server" /> // shown only in edit mode

           </EditItemTemplate>

          </asp:TemplateField>

             </Columns>
         </asp:GridView>
</form> 
```

和我的 C# 代码：

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {

    if (e.CommandName == "DownloadFile")
    {

        Label1.Text = e.CommandArgument.ToString();

    }

} 
```

为什么我没有从 CommandArgument='<%# Container.DataItemIndex %>' 获得任何值

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:41:07.790

替换`CommandArgument='<%# Container.DataItemIndex %>'`为`CommandArgument='<%#DataBinder.Eval(Container, "DataItemIndex")%>'`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:42:34.560

尝试在[RowDataBound](http://msdn.microsoft.com/ru-ru/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)上动态更改按钮属性：

```
 void GridView1_RowDataBound(Object sender, GridViewRowEventArgs e)
      {

        if(e.Row.RowType == DataControlRowType.DataRow)
        {
          var button =  e.Row.FindControl("Button1");

          button.CommandArgument = e.Row.DataItemIndex;
          button.CommandName="DownloadFile";         
          button.Text="Button";
          // COLUMN_INDEX where button shoud be
          e.Row.Cells[COLUMN_INDEX].Controls.Add(button);
         }

      } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:56:18.083

每隔一段时间，您需要获取触发事件的 GridView 中的行索引。您可以设置 CommandArgument 来存储行的索引，以便在后面的代码中使用。在网格视图中：

```
<asp:GridView ID="gridView" runat="server" DataKeyNames="myId" OnRowCommand=" gridView_RowCommand">
    <Columns>
        <asp:TemplateField ShowHeader="False">
            <ItemTemplate>
                <asp:Button ID="btnAdd" runat="server" CommandArgument='<%# Container.DataItemIndex %>'
                    CommandName="Add" Text="Add" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

在代码隐藏中引用：

```
protected void gridView_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "Add")
    {
        int myId = (int)gridView.DataKeys[Convert.ToInt32(e.CommandArgument)].Value;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-10-14T10:26:27.467

试试这个……我一直都喜欢……

```
<asp:TemplateField HeaderText="SNo." >
                <ItemTemplate>
                    <%# Container.DataItemIndex + 1 %>
                </ItemTemplate>
</asp:TemplateField> 
```

# ibm-mq - Websphere MQ 资源管理器和 AMQ8077 错误

> ID：11832788
> 
> 赞同：3
> 
> 时间：2012-08-06T17:08:30.013
> 
> 标签：ibm-mq

我看到一堆看起来像的错误

```
AMQ8077: Entity 'tcs-mq-user ' has insufficient authority to access object 'SYSTEM.INTERNAL.REPLY.QUEUE' 
```

每当我通过 MQ Explorer 访问队列对象时，在 mq 错误日志上。这对许多系统对象重复，例如......

```
 SYSTEM.MQEXPLORER.REPLY.MODEL SYSTEM.ADMIN.COMMAND.QUEUE
 SYSTEM.SELECTION.VALIDATION.QUEUE SYSTEM.DEFAULT.MODEL.QUEUE
 SYSTEM.RETAINED.PUB.QUEUE SYSTEM.PENDING.DATA.QUEUE
 SYSTEM.NDURABLE.MODEL.QUEUE SYSTEM.MQSC.REPLY.QUEUE
 SYSTEM.JMS.TEMPQ.MODEL SYSTEM.INTERNAL.REPLY.QUEUE
 SYSTEM.INTER.QMGR.PUBS SYSTEM.INTER.QMGR.FANREQ
 SYSTEM.INTER.QMGR.CONTROL SYSTEM.HIERARCHY.STATE
 SYSTEM.DURABLE.SUBSCRIBER.QUEUE SYSTEM.DURABLE.MODEL.QUEUE
 SYSTEM.DOTNET.XARECOVERY.QUEUE SYSTEM.DEFAULT.REMOTE.QUEUE
 SYSTEM.DEFAULT.MODEL.QUEUE SYSTEM.DEFAULT.LOCAL.QUEUE
 SYSTEM.DEFAULT.INITIATION.QUEUE SYSTEM.DEFAULT.ALIAS.QUEUE
 SYSTEM.DEAD.LETTER.QUEUE SYSTEM.CLUSTER.TRANSMIT.QUEUE
 SYSTEM.CLUSTER.REPOSITORY.QUEUE SYSTEM.CLUSTER.REPOSITORY.QUEUE
 SYSTEM.CLUSTER.HISTORY.QUEUE SYSTEM.CLUSTER.COMMAND.QUEUE
 SYSTEM.CICS.INITIATION.QUEUE SYSTEM.CICS.INITIATION.QUEUE 
```

我该如何摆脱这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:49:02.037

当 WMQ Explorer 绘制队列屏幕时，它需要枚举所有队列，并通过发出相当于`DIS Q(*)`PCF 命令的命令服务器来实现。该命令的结果在每个队列的基础上返回，因此用户有权访问的`MQCC=0`每个队列 display 返回，而用户无权访问 display 的每个队列返回`MQCC=2, MQRC=2035`。由于它为定义的每个队列帽执行此操作，因此您需要授权`tcs-mq-user`至少显示所有队列。

由于`tcs-user`在`mq-user`组中（基于以前帖子中的注释），因此请执行以下操作：

```
SET AUTHREC PROFILE('**') GROUP('mq-users') OBJTYPE(QUEUE) AUTHADD(DSP) 
```

请注意，配置文件名称中需要**两个**星号，因为 WMQ 将点字符识别为节点分隔符。例如，使用配置文件`SYSTEM*`将匹配一个命名的队列`SYSTEM_QUEUE`但不匹配一个命名的队列，`SYSTEM.QUEUE`因为单个星号通配符仅匹配名称中的单个节点。两个星号通配符 like`SYSTEM**`将匹配两个名称。要匹配所有`SYSTEM`队列，您通常会使用模式`SYSTEM.**`，包括点和两个星号。这样，该模式会排除用户定义的名称，例如`SYSTEMIC` 但匹配所有默认对象名称。要匹配所有队列，只需使用`**`上面命令示例中所示的模式。

您还将在其他对象上遇到许多相同的错误。要一步解决所有这些问题，首先应用基本授权，如[在 WebSphere MQ Explorer 中查看通道一](https://stackoverflow.com/questions/11799377/websphere-mq-viewing-channels-in-wmq-explorer/11799762#11799762)文中所述。这提供了显示和/或查询所有对象的能力，然后您可以添加更具体的配置文件以允许仅在`mq-user`需要更多访问权限的对象上放置、获取、浏览等。

您可能还想查看 developerWorks 上的[WebSphere MQ Security Heats](http://www.ibm.com/developerworks/websphere/techjournal/0711_col_wyatt/0711_col_wyatt.html) Up 文章，了解更多背景知识和 setmqaut 命令。

# iphone - 从 Xcode 4.3 升级到 Xcode 4.4 后，未加载 .xib 文件之一

> ID：11832789
> 
> 赞同：0
> 
> 时间：2012-08-06T17:08:30.950
> 
> 标签：iphone, xcode, interface, builder

我有一个 .xib 从 4.3 升级到 4.4 后没有加载。我试图将开发目标从界面生成器 ---> 文件检查器更改为 4.4，但相同。我有另一台带有 Xcode 4.3 的 Mac，同样的项目在那里工作正常。

![界面生成器 xcode 4.4](../Images/fbc39a5c23dc3e9f463ca99200279028.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T08:16:05.263

我想到了。这不是 Xcode 版本的问题。一旦我将@synthesize 放入 .m 文件中，我的 .xib 文件成功加载后，似乎 Xcode 4.3 和更早版本就不再关心 .m 文件中的 @synthesize 了。

# sql - 2个SQL表的区别

> ID：11832790
> 
> 赞同：1
> 
> 时间：2012-08-06T17:08:31.710
> 
> 标签：sql

我有两个表：tableA 和 tableB。如何获取 tableA 中但不在 tableB 中的所有记录？我对执行此操作的正确方法感兴趣，而不是解决方法。我尝试使用左连接，然后添加`where ID is not null`. 它有效，但我不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:10:10.757

```
select * from tableA
where id not in (select id from tableB) 
```

或者

```
select * from tableA a
left join tableB b on a.id = b.id
where b.id is null 
```

两者都是完全可以接受的检索您所问内容的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:20:35.463

Sql 小提琴 [][1]

[演示](http://www.sqlfiddle.com/#!3/10300/2) [http://www.sqlfiddle.com/#!3/10300/2](http://www.sqlfiddle.com/#!3/10300/2)

`select * from table1 where id not in(select id from table2)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:16:25.003

您可以使用`NOT EXISTS`. 我更喜欢使用`NOT EXISTS` ，因为当列允许空值但没有空值时，`NOT IN`性能明显比`NOT EXISTS`.

```
Select * from table1 a
    Where not exists (Select ID from table2 b where a.ID = b.ID) 
```

在`non-nullable`列上，您可以使用适合您情况的任何一种，因为`NOT IN`和 NOT EXISTS 的行为和性能是相同的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:36:22.143

由于您没有给出表模式，因此假设每个 table.id1,​​id2 中都有主键

你可以在左连接的帮助下做。

Select * from table1 left join table2 where id2 is null

注意这不是一个实际的查询，只是提示您继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:12:49.457

如果您需要在页面上显示数据（编程），您必须为此使用连接，如果您需要将数据从一个表移动到另一个表以进行备份或其他类似目的，则需要一个 sql 比较工具。首先，您需要 sql left join。将您的表 A 设为左表并与 B 一起放置并加入

```
select * from A
left join B  on A.id = B.id
where b.id is null 
```

# python - 迭代两个列表并同步它们

> ID：11832793
> 
> 赞同：3
> 
> 时间：2012-08-06T17:08:58.240
> 
> 标签：python, iteration

我需要通过以下方式迭代两个列表：

伪代码：

```
j=1
for i=1 to n:
   print a[i], b[j]
   while b[j+1] <= a[i]:
      j++
      print a[i], b[j] 
```

例如：

```
a = [1 3 5 7]
b = [2 4 9] 
```

期望的输出：

```
1 2
3 2
5 2
5 4
7 4 
```

你如何在python中干净地做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:15:04.810

您的伪代码几乎可以在 Python 中运行。一些可以满足您要求的工作代码是：

```
a = [1, 3, 5, 7]
b = [2, 4, 9] 
j = 0
for i in range(len(a)):
    print a[i], b[j]
    while j<len(b)-1 and b[j+1] <= a[i]:
        j += 1
        print a[i], b[j] 
```

请注意使其在 Python 中工作的一些更改：

1.  声明列表时，项目之间需要逗号。
2.  列表索引从 0 开始，因此两者都`i`应该`j`从那里开始。
3.  `len(a)`返回（在这种情况下为 4）的长度`a`，并迭代执行`i`从到`range(len(a))`的每个整数的循环，这是 中的所有索引。`0``len(a)-1``a`
4.  `++`Python中不支持该操作，所以我们`j +=1`改用。
5.  我们必须避免使用 的超出范围的索引`b`，因此我们在增加它之前进行测试以确保`j`在范围内。

通过遍历列表，可以使这段代码更加 Pythonic，如下所示：

```
a = [1, 3, 5, 7]
b = [2, 4, 9] 
j = 0
for element in a:
   print element, b[j]
   while j<len(b)-1 and b[j+1] <= element:
      j += 1
      print element, b[j] 
```

一般来说，您可能不想只打印列表元素，因此对于更一般的用例，您可以创建一个[生成器](https://stackoverflow.com/questions/102535/what-can-you-use-python-generator-functions-for)，例如：

```
def sync_lists(a, b)
    if b:
        j = 0
        for element in a:
            yield (element, b[j])
            while j<len(b)-1 and b[j+1] <= element:
                j += 1
                yield (element, b[j]) 
```

然后你可以像以前一样打印它们

```
a = [1, 3, 5, 7]
b = [2, 4, 9]
for (e1, e2) in sync_lists(a, b):
    print e1, e2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:45:07.067

[murgatroid99 的答案](https://stackoverflow.com/a/11832874/279627)中的生成器代码可以通过使用`next()`而不是索引算术来推广到任何可迭代对象（而不是仅序列）：

```
def sync_list(a, b):
    b = iter(b)
    y, next_y = next(b), next(b)
    for x in a:
       yield x, y
       while next_y <= x:
          y, next_y = next_y, next(b)
          yield x, y 
```

# java - 关于junit测试用例

> ID：11832794
> 
> 赞同：-1
> 
> 时间：2012-08-06T17:08:59.170
> 
> 标签：java, junit, junit4

我是 Junit 测试用例世界的新手，我只是想知道我是否开发了一个程序

```
class MapDemo1
{static final Logger logger = Logger.getLogger(MapDemo1.class);
     /**
     *  
     */
    public static void main(String arg[])
     {PropertyConfigurator.configure("src/log4j.properties");
     logger.info("-->Map");
    // Map map=new TreeMap();

         Map map=new HashMap();//HashMap key random order.
      //   System.out.println("Amit".hashCode());
         map.put("Amit","Java");
         map.put("Amit","Javas");
        // map.put("mAit","J2EE");
         //map.put("Saral","J2rrrEE");
         /*map.put("ty","Spring");
         map.put("Anupam","Hibernate");
         map.put("Ravi",".Net");
         map.put("Saral","Andriod");//same key but different value 
         map.put("Nitin","PHP");
         map.put("hj","Spring1");*/
         System.out.println("There are "+map.size()+" elements in the map.");
         System.out.println("Content of Map are...");
         Set s=map.entrySet();
         Iterator itr=s.iterator();
         while(itr.hasNext())
         {
             Map.Entry m=(Map.Entry)itr.next();
             System.out.println(m.getKey()+"\t"+m.getValue()+"\t"+ m.hashCode());
          }
]
} 
```

现在请告知什么是 junit 测试用例，以及它们将如何在单独的类中编写。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T17:11:53.203

事实上，这个程序无法使用 JUnit 进行测试——它太小了，而且都在一个方法中。为了使其可测试，您需要将其分解为只做一件事的部分。

一个这样的部分可能是`populateMap()`创建`HashMap`和添加值的方法。然后，您可以添加一两个调用该方法并测试地图大小和内容的测试。

打印输出也很难（如果不是不可能的话）测试。解决此问题的一种方法是将打印输出的代码放入接受 a`PrintWriter`作为参数的方法中。在实际程序中，调用它并将连接到的东西传递给它`System.out`。在测试中，您可以通过`PrintWriter`连接到 a来调用它`StringWriter`，然后检查 that 的内容`StringWriter`。

通常，您不会使用 JUnit测试*程序。*你测试*单元*。一个*单元*要么是一个类，要么是一小组紧密耦合的类，它们为程序的其余部分提供某种定义良好的服务。例如，类 like`StringBuilder`是一个相当大且复杂的单元，希望您可以想象为它编写的数十或数百个测试。

# java - 安卓 html 链接

> ID：11832795
> 
> 赞同：0
> 
> 时间：2012-08-06T17:09:13.377
> 
> 标签：java, android

使用此代码`map.put(TAG_LINK, "" + Html.fromHtml(link));`，我能够将 json 超链接解析到我的视图中。但问题是它只会显示这个词，我无法点击它。例如，如果我有

```
<a href="http://something"> CLICK </a> 
```

, 我只能看到 CLICK 但我不能点击它。我知道 html.fromhtml 有更多工作，setMovementMethod。但是我不知道如何将它与 map.put 一起使用。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T19:49:38.050

您应该告诉 TextView 使其成为可点击的链接

```
textView.setAutoLinkMask( Linkify.ALL ); 
```

请参阅：http: [//developer.android.com/reference/android/widget/TextView.html#setAutoLinkMask](http://developer.android.com/reference/android/widget/TextView.html#setAutoLinkMask(int) (int )

# c# - asp.net 向 api 发送 get 请求并获取 json 结果

> ID：11832797
> 
> 赞同：0
> 
> 时间：2012-08-06T17:09:22.407
> 
> 标签：c#, asp.net-mvc

如何从服务器向 API 发送“获取”请求并使用 json 数据获取结果？我听说 .net 4.5 中的 HTTPClient 可能在 .net 4.0 中有类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:18:00.163

对于较旧的框架版本，您可以使用[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient%28v=vs.80%29.aspx)（这是一个非常简单的类来下载/上传数据），也可以使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest%28v=vs.80%29.aspx)。WebRequest 级别较低，但您可以定义方法（GET、POST）、UserAgent 等。[在这里](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)您可以找到有关使用 WebRequest 进行 POST 的示例。

如果您只想从地址获取返回的 JSON，WebClient 应该就足够了。

# drupal - 如何在drupal中显示基于分类的菜单

> ID：11832799
> 
> 赞同：1
> 
> 时间：2012-08-06T17:09:30.070
> 
> 标签：drupal, drupal-7

我正在尝试制作一个drupal网站。我已将词汇表命名为类别。现在我想根据类别术语在侧边栏中显示一个特定的菜单。例如，如果我在一个在类别术语中有“移动”的节点上，那么它应该在菜单块中只显示“移动”子菜单术语。我四处寻找，但找不到任何解决方案。有什么办法解决这个问题吗？看来意见也没有这个功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T00:51:58.463

It's very simple,use the taxonomy menu module [link to the taxonomy menu module](http://drupal.org/project/taxonomy_menu)

# objective-c - 意外的“预期标识符”错误

> ID：11832801
> 
> 赞同：3
> 
> 时间：2012-08-06T17:09:52.777
> 
> 标签：objective-c, ios

以下两种方法在我的一个控制器中。buttonPressed 方法连接到按钮并正常工作。但是，当我添加对 workWithAString 的调用时出现错误。想知道我在这里缺少什么，并感谢您的建议。

```
-(NSString *) workWithAString: (NSString *) string1
{

NSString *string2 = [[NSString alloc] initWithString:string1];

// Here I will do some other things with string2

return string2;

}

-(IBAction)button1Pressed
{
NSString *modifiedString1 = [[NSString alloc] initWithString:InputValue.text];
modifiedString1 = [[self workWithAString: modifiedString1 ];  // Expected identifier error here

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T17:12:27.763

出于某种原因，您有两个括号...

```
[self workWithAString:modifiedString1]; 
```

# android - 滚动视图的问题

> ID：11832804
> 
> 赞同：0
> 
> 时间：2012-08-06T17:10:00.167
> 
> 标签：android, gridview, scrollview

以下是安卓布局。

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android" 
 android:id="@+id/svb"
    android:layout_width="fill_parent" 
    android:layout_height="450dp" 

    android:isScrollContainer="true" 
    android:scrollbarAlwaysDrawVerticalTrack="true" 
    android:scrollbarStyle="outsideInset" 
    android:scrollbars="vertical">
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<GridView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/grid_view"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:numColumns="2"

android:gravity="center_horizontal"
android:layout_gravity="center_horizontal"
android:stretchMode="columnWidth" 
> 
</GridView>

 <RelativeLayout
android:layout_width="fill_parent" 
android:layout_height="wrap_content"
android:gravity="center"
android:id="@+id/rl2"
>
<RelativeLayout
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
android:id="@+id/rl3"
>
 <ImageView
    android:id="@+id/total"
    android:layout_width="30dp"
    android:layout_height="30dp" 
     android:src="@drawable/total"         
    /> 
<TextView
        android:id="@+id/totalscore"
        android:layout_width ="wrap_content"
        android:layout_height="wrap_content"
       android:layout_centerVertical="true"
       android:layout_toRightOf="@id/total"
       android:paddingLeft="5dp"
        android:text="" />
</RelativeLayout>
</RelativeLayout>
<LinearLayout
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
    android:orientation="vertical"
android:id="@+id/rl4"

>
<LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="0dip"
    android:layout_weight="1"
    android:gravity="bottom"
    >
 <Button
            android:id="@+id/comment"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="RATE THIS APP"
            android:layout_marginLeft="20dp"
            android:layout_marginRight="20dp"
            android:layout_alignParentBottom="true"

           />
 </LinearLayout>
 <LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="0dip"
    android:layout_weight="1"
    android:gravity="center_vertical"
    >

<Button
            android:id="@+id/paid"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="BUY AD FREE VERSION"
            android:layout_marginLeft="20dp"
            android:layout_marginRight="20dp"
            android:layout_centerVertical="true"

            />

   </LinearLayout>

     </LinearLayout>

   </LinearLayout>
  </ScrollView> 
```

我希望滚动包含整个布局，但它只涵盖网格视图。只显示了gridview 的一项，要查看其他项，我必须滚动。网格视图下方的视图始终可见。如何纠正这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:17:28.550

尝试在 scrollView 之后的第一个 LinearLayout 中设置 android:layout_height="wrap_content"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:26:17.773

```
try this

<ScrollView
android:layout_width="fill_parent" 
android:layout_height="450dp"> <----replace this with wrap_content

<LinearLayout ...>        

   // ADD ALL OTHER LAYOUT HERE

       <TextView
                android:id="@+id/totalscore"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_toRightOf="@+id/total" <---- you forget PLUS sign here
                android:paddingLeft="5dp"
                android:text="" />

</LinearLayout>
</ScrollView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-16T15:16:17.753

您可以在 ScrollView 中使用 Tablelayout。这是一个有效的示例代码

```
 <?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/ScrollView01"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textSize="20sp">

    <TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/tableLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/back"
        android:scrollbars="vertical"
        android:textSize="20sp">
        <!--Month Combo Box-->
        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Select Month"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <Spinner
                android:id="@+id/spinner"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <Spinner
                android:id="@+id/spinneryr"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />
        </TableRow>
        <!--Field1 Combo Box-->
        <TableRow
            android:id="@+id/tableRow2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/ERYTHROCYTE"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/ERYTHROCYTE"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"

                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field2 Combo Box-->
        <TableRow
            android:id="@+id/tableRow3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/HAEMOGLOBIN"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/HAEMOGLOBIN"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"

                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field3 Combo Box-->
        <TableRow
            android:id="@+id/tableRow4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/PCV"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/PCV"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"

                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field4 Combo Box-->
        <TableRow
            android:id="@+id/tableRow5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/RDW"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/RDW"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"

                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field5 Combo Box-->
        <TableRow
            android:id="@+id/tableRow6"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/MCV"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/MCV"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field6 Combo Box-->
        <TableRow
            android:id="@+id/tableRow7"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/MCH"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/MCH"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"

                android:inputType="numberDecimal" />
        </TableRow>

        <!--Field7 Combo Box-->
        <TableRow
            android:id="@+id/tableRow8"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/MCHC"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/MCHC"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field8 Combo Box-->
        <TableRow
            android:id="@+id/tableRow9"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/LEUCOCYTECOUNT"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/LEUCOCYTECOUNT"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field9 Combo Box-->
        <TableRow
            android:id="@+id/tableRow10"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/PLATELETS"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/PLATELETS"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field10 Combo Box-->
        <TableRow
            android:id="@+id/tableRow11"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/NEUTROPHILS"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/NEUTROPHILS"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field11 Combo Box-->
        <TableRow
            android:id="@+id/tableRow12"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/EOSINOPHILS"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/EOSINOPHILS"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!--Field12 Combo Box-->

        <TableRow
            android:id="@+id/tableRow13"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:padding="20sp">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/LYMPHOCYTES"
                android:textColor="#0c0b0b"
                android:textSize="20sp" />

            <EditText
                android:id="@+id/LYMPHOCYTES"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/back"
                android:gravity="center"
                android:inputType="numberDecimal" />
        </TableRow>
        <!-- Button :Start here-->
        <TableRow
            android:id="@+id/tableRow14"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:padding="20sp">

            <Button
                android:id="@+id/btnAdd"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/add" />
            <Button
                android:id="@+id/btnViewAll"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/view_all" />
        </TableRow>

            <!--<Button
                android:id="@+id/btnDelete"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/delete" />

            <Button
                android:id="@+id/btnShowInfo"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/show_info" />
        </TableRow>-->

<!--        <TableRow
            android:id="@+id/tableRow15"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:padding="20sp">

            <Button
                android:id="@+id/btnModify"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/modify" />

            <Button
                android:id="@+id/btnView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/view" />

           <Button
            android:id="@+id/btnShowInfo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/show_info" >
        </TableRow-->

        <TextView
            android:id="@+id/tvValues"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:textSize="20sp" />
    </TableLayout>
</ScrollView> 
```

[![在此处输入图像描述](../Images/3e0ecf1944372efb39b397225e65f9b1.png)](https://i.stack.imgur.com/q3YSP.png)

# linux - 使用 perl 脚本更改文件的选定内容

> ID：11832805
> 
> 赞同：-2
> 
> 时间：2012-08-06T17:10:02.557
> 
> 标签：linux, perl, unix

我需要帮助来编写一些 Perl 代码来替换文本文件中的一些选定值。下面是我的文本文件的示例。

> 服务器=主机1
> 
> ```
> network=true
> start=false
> end=YYYYMMDD
> key=34 
> ```

改成

> 服务器=主机
> 
> ```
> network=false
> start=true
> end=YYYYMMDD
> key=10 
> ```

我希望 start 和 network 的值随机生成 false 或 true.sometimes true 有时 false

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:21:17.737

```
perl -i.bak -lpe'
    for my $word (qw(network start)) { 
        s/$word=\K.*/rand > 0.5 ? "true" : "false"/e 
    }
' *.txt 
```

# c - 显示固定值的浮点值

> ID：11832816
> 
> 赞同：0
> 
> 时间：2012-08-06T17:10:51.097
> 
> 标签：c

当我在最多 6 位小数之后存储 12 位小数的浮点值时，它显示的是固定值。如果它是垃圾值，那么对于不同的编译器它应该是不同的，但是当我在我的书中看到输出并实际尝试时，它们都是相同的结果。

```
#include <stdio.h>

int main(void)
{
    float a = 1.234567890000;

    printf("%.12f\n", a);
    return 0;
} 
```

输出：

```
1.234567880630   // In my book it also represents same output. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:18:30.970

> 如果它是垃圾值，那么对于不同的编译器它应该是不同的，但是当我在我的书中看到输出并实际尝试时，它们都是相同的结果。

很有可能您的编译器和您使用的书都使用[IEEE 754](http://en.wikipedia.org/wiki/IEEE_754-2008)浮点数标准，并且有类似的机制来处理这些值。因此，他们可能会得到相同的答案，就像许多其他编译器和系统一样。

主要问题在于[浮点值如何存储](http://floating-point-gui.de/formats/fp/)和运行。32 位浮点值没有足够的精度来准确表示您的 12 位小数，因此您得到的输出与您输入的不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:24:36.553

期望编译器为浮点数实现 IEEE 754 标准。对于浮点数（ binary32 位），数字有 23 位，符号有 1 位。这为您提供了 7.x 十进制数字。所以你看到的是正确的。

如果您需要更高的精度，请使用 double，它使用 52 位作为数字并为您提供 34 位精度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:27:00.777

如果您使用的是浮点数，您可能还会发现这篇文章很有启发性，让您免于许多惊喜：[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

请记住，与数学不同，0.1 的 10 倍几乎永远不会是 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:16:41.983

浮点数（在大多数系统上）将其值存储在 32 位中，这些位分为符号、指数和“有效数”（值的主要部分），这为大多数值提供了 7 到 8 位的十进制精度，很短您正在查看的 12 位数字。

double 使用 64 位并为大多数值提供 15-16 位的精度。

您在第 7-9 位附近获得奇数值，因为您的编译器必须舍入该值才能存储它。舍入方法几乎是标准的，因此编译器通常会给出相同的舍入结果。

请注意，C/C++ 通常要求编译器提供“最小”大小，但是这些值可能存储在更大的存储空间中，例如 CPU 寄存器中，因此您的里程会因低有效位而异。

# django - 如何针对 oracle 中的不同模式运行 inspectdb？

> ID：11832817
> 
> 赞同：5
> 
> 时间：2012-08-06T17:10:58.787
> 
> 标签：django, oracle, inspectdb

我想对 Oracle 数据库运行[inspectdb 。](https://docs.djangoproject.com/en/dev/ref/django-admin/#django-admin-inspectdb)我使用的用户帐户是拥有 0 个表的只读用户。但是，它可以访问包含所有表的模式。使用时如何指定架构`inspectdb`？

目前，我的命令是：`python manage.py inspectdb --database "oradb" > test_model.py`

这只会输出一个带有`from django.db import models`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T19:17:20.317

关于 Oracle 支持，César 的回答是正确的。`django\db\backends\oracle\introspection.py`但是，我能够通过在两个地方进行修改来生成粗略的模型。

`cursor.execute`将行更改为`get_table_list`：

```
cursor.execute("SELECT TABLE_NAME FROM ALL_TABLES WHERE OWNER = 'OTHERSCHEMA'") 
```

将第一行中的`user_table_cols`to更改为： `ALL_TAB_COLUMNS``cursor.execute``get_table_description`

```
cursor.execute("""
        SELECT
            column_name,
            data_default,
            CASE
                WHEN char_used IS NULL THEN data_length
                ELSE char_length
            END as internal_size
        FROM ALL_TAB_COLUMNS
        WHERE table_name = UPPER(%s)""", [table_name]) 
```

接下来，将第二`cursor.execute`行更改`get_table_description`为：`cursor.execute("SELECT * FROM OTHERSCHEMA.%s WHERE ROWNUM < 2" % self.connection.ops.quote_name(table_name))`

由于这是一个遗留数据库，其中策略阻止对数据库进行更改，这对于一次性运行来说是件好事。

模型完成后，还需要进行一些更改。我的一些类似乎缺少主键引用和外键引用。我将手动添加这些。

我所做的最后一个更改是修改所有`class Meta:`实例以引用正确的架构：

```
class Meta:
    db_table = u'"SCHEMA"."TABLE_NAME"'     # Notice the quoting needed 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:27:10.963

问题是 Django 的[inspectdb](https://docs.djangoproject.com/en/dev/ref/django-admin/#inspectdb)不支持 Oracle。从文档：

> inspectdb 适用于 PostgreSQL、MySQL 和 SQLite。外键检测仅适用于 PostgreSQL 和某些类型的 MySQL 表。
> 
> --database 选项可用于指定要自省的数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-20T14:19:34.030

如果有人遇到这个线程：安迪的建议 + 我还更改了 get_relations 方法以在生成的源中获取外键，适用于 1.9.1：

```
 def get_relations(self, cursor, table_name):
    """
    Returns a dictionary of {field_name: (field_name_other_table, other_table)}
    representing all relationships to the given table.
    """
    table_name = table_name.upper()

    cursor.execute("""
        SELECT a.column_name, c_pk.table_name r_table_name, c_pk.constraint_name r_pk
          FROM all_cons_columns a
          JOIN all_constraints c ON a.owner = c.owner
                                AND a.constraint_name = c.constraint_name
          JOIN all_constraints c_pk ON c.r_owner = c_pk.owner
                                   AND c.r_constraint_name = c_pk.constraint_name
         WHERE c.constraint_type = 'R'
           AND a.table_name = %s""", [table_name])

    relations = {}
    for row in cursor.fetchall():
        relations[row[0].lower()] = (row[2].lower(), row[1].lower())
    return relations 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T13:19:31.587

我的两分钱。（django 版本 1.9.7 + django GIS 扩展）

根据 Andy 和 Mirek Simek 的建议，我进一步修改：

**在settings.py**的数据库配置中添加了*“模式”*

 **```
 ...
    'oracle1': {
        'ENGINE': 'django.contrib.gis.db.backends.oracle',
        'NAME': 'dbname',
        'USER': 'dbuser',
        'PASSWORD': 'dbpass',
        'HOST': 'dbhostname',
        'PORT': 'dbport',
        'schemas': ['SCHEMANAME1', ....] #<-- this
    }, 
    ... 
```

以这种方式修改**get_tables_list ：**

```
def get_table_list(self, cursor):
    """
    Returns a list of table and view names in the current database.
    """
    cursor.execute("SELECT TABLE_NAME, 't' FROM USER_TABLES UNION ALL "
                   "SELECT VIEW_NAME, 'v' FROM USER_VIEWS")
    res = [TableInfo(row[0].lower(), row[1]) for row in cursor.fetchall()]

    schemas = self.connection.settings_dict.get('schemas')
    if schemas and len(schemas)>0:
        for s in schemas:
            cursor.execute("SELECT TABLE_NAME, 't' FROM ALL_TABLES WHERE OWNER = '%s'" %s)
            for row in cursor.fetchall():
                tbl_name, typ = '.'.join([s,row[0].lower()]), row[1]
                try:
                    # let us check for permission to query
                    cursor.execute("SELECT * FROM %s WHERE ROWNUM < 1" % tbl_name.upper())
                except DatabaseError, e:
                    pass
                else:
                    res.append(TableInfo(tbl_name, typ))
    return res 
```

因为我使用的是 gis，所以我不得不对**django/contrib/gis/db/backends/oracle/introspection.py打一个脏补丁（我不知道是否需要它，因为数据库问题）**

**刚刚在get_geometry_type**的末尾添加了这个

 **```
 ...
        dim = len(dim)
        if dim != 2:
            field_params['dim'] = dim
    except:  # <-- this
        pass # <-- this
    finally:
        cursor.close()
    ... 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-02-05T15:04:29.543

尝试通过在 settings.py 的 DATABASES 变量中添加一个选项来指定 search_path，如下所示：

```
'OPTIONS': {
       'options': '-c search_path=myschema'
} 
```

完整的 DATABASES 变量应该是：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': 'mydatabase',
        'USER': 'postgres',
        'PASSWORD': 'mypassword',
        'HOST': 'localhost',
        'PORT': '5432',
        'OPTIONS': {
            'options': '-c search_path=myschema'
        }
    }
} 
```

之后`python migrate inspectdb`应该适用于您的架构****

# reporting-services - 根据 SSRS 中的下拉菜单更改报告类型

> ID：11832818
> 
> 赞同：1
> 
> 时间：2012-08-06T17:11:09.973
> 
> 标签：reporting-services, ssrs-2008, dropdownbox

我有一个报告，它将有一个参数指定，而不是它应该是一个图表或表格。我想要做的只是根据他们在该下拉列表中选择的值隐藏和显示正确的元素。这可能吗，如果可以，我将如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:24:38.850

试试这个 ：

```
IIf(Parameters!YourParameterName.Value == "Something", True, False) 
```

上面的表达式应该写在表格的可见性属性中

# file - 错误消息仍然出现 >nul 2>nul

> ID：11832820
> 
> 赞同：0
> 
> 时间：2012-08-06T17:11:20.193
> 
> 标签：file, batch-file, cmd

批处理文件输出“系统找不到指定的文件”。而不是将错误重定向到`nul`

```
set /p firstline=<text.txt >nul 2>nul
pause 
```

我需要做什么来抑制错误消息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:53:47.383

使用此代码重定向将被忽略。我不确定为什么，我的猜测是因为重定向机制本身发生错误，以后的 redirs 将永远不会运行。

要在您期望错误的地方强制分离重定向 - 使用 ()：

```
(set /p firstline=<text.txt) >nul 2>nul 
```

您还可以考虑使用不同的语法将所有内容重定向到一个输出：

```
(set /p firstline=<foo2.txt) >nul 2>&1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:10:39.723

情况确实如此（在Win7上测试）。似乎是一个类似错误的功能。:-) 如果您的批处理文件足够简单，您可以通过使用`2>nul`(ie, `foo.cmd 2>nul`) 调用您的批处理文件来解决这个问题。

或者，您可以只将该行放在它自己的批处理文件中（例如，`setfirstline.cmd`）并`call setfirstline.cmd 2>nul`从“父”批处理文件中使用。哈克，但功能齐全。

# python - 获取 Unicode 字符串所需的字节数

> ID：11832824
> 
> 赞同：7
> 
> 时间：2012-08-06T17:11:31.073
> 
> 标签：python, string, unicode, cjk

我有一个编码为 Unicode 的韩语字符串，例如`u'정정'`. 我怎么知道表示这个字符串需要多少字节？

我需要知道确切的字节数，因为我将字符串用于 iOS 推送通知，并且它对有效负载的大小有限制。

`len('정정')`不起作用，因为它返回字符数，而不是字节数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T17:17:43.510

您需要知道要测量字节大小的*编码：*

```
>>> print u'\uC815\uC815'
정정
>>> print len(u'\uC815\uC815')
2
>>> print len(u'\uC815\uC815'.encode('UTF-8'))
6
>>> print len(u'\uC815\uC815'.encode('UTF-16-LE'))
4
>>> print len(u'\uC815\uC815'.encode('UTF-16'))
6
>>> print len(u'\uC815\uC815'.encode('UTF-32-LE'))
8
>>> print len(u'\uC815\uC815'.encode('UTF-32'))
12 
```

您真的很想查看[Python Unicode HOWTO](http://docs.python.org/howto/unicode.html)以充分了解 unicode 对象和它的字节编码之间的区别。

另一篇优秀的文章是Joel Spolsky（Stack Overflow 背后的人之一[）的 The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses! )。](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T17:17:38.163

表示 所需的字节数`unicode`取决于您使用的编码。

```
>>> s = u'정정'
>>> len(s)
2
>>> len(s.encode('UTF-8'))
6
>>> len(s.encode('UTF-16'))
6
>>> len(s.encode('UTF-32'))
12 
```

如果您要重用编码结果，我建议对其进行一次编码，然后将其拉出`len`并稍后重用已编码的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:17:40.213

确保您使用的是正确的[标准编码](http://docs.python.org/library/codecs.html#standard-encodings)。

如果你不是，你总是可以`decodedString = myString.decode('UTF-8')`（用你可以从上一个链接中找到的正确编码字符串替换 UTF-8，如果不是 UTF-8）以`len(decodedString)`应该返回正确数字的格式获取字符串

# ms-access - 在执行数据透视之前修改记录集

> ID：11832827
> 
> 赞同：1
> 
> 时间：2012-08-06T17:11:44.890
> 
> 标签：ms-access, vbscript, ado

我有一个访问数据库，我通过 vbscript 从 asp 页面访问。我需要查询数据库并返回一个记录集，修改记录集中的一些数据然后执行数据透视。如何对修改后的记录集执行透视？

我已经返回了记录集并完成了数据修改，但不知道现在如何执行数据透视。数据修改涉及检查记录集中的每个项目（计划请求）以查看它是否跨越过滤器日期范围。如果是，则调整开始和/或结束时间并重新计算请求的时间。不是在 SQL 查询本身中可以完成的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T11:41:21.353

一些 SQL 变体有自己的 PIVOT 功能，我不知道 ACCESS 但这里是 vbscript 中的一般透视功能。我在这里的数组中使用数组，没有 vbscript 多维数组。如果您需要这样的版本，请告诉我。

```
arr = Array(_
  Array(1,2,3),_
  Array(4,5,6)_
)

for each line in arr
  wscript.echo join(line)
next

'1 2 3
'4 5 6

pivotted = pivot(arr)

function pivot(arr)
  dim arr2(), temp()
  redim arr2(ubound(arr(0)))
  for col = 0 to ubound(arr(0))
    redim temp(ubound(arr))
    for row = 0 to ubound(arr)
      temp(row) = arr(row)(col)
    next
    arr2(col) = temp
  next
  pivot = arr2
end function

for each line in pivotted
  wscript.echo join(line)
next

'1 4
'2 5
'3 6 
```

# sql - SQL Server - 将 varchar 转换为日期时间。YYYY-MM-DD 10:30:36.157 格式

> ID：11832829
> 
> 赞同：0
> 
> 时间：2012-08-06T17:11:48.333
> 
> 标签：sql, sql-server

尝试在 sql server 中将 varchar 转换为 datetime 时出现以下错误。

**将 varchar 数据类型转换为 datetime 数据类型导致值超出范围。**

以下是 ResponseDate 列值：

```
2012-06-19 10:30:36.157
2012-06-19 10:30:36.157
2012-07-09 11:37:14.287
2012-06-21 10:15:06.733
2012-07-02 13:19:13.080 
```

我正在尝试编写一个在 7 月选择 * 的查询。

```
 Select * From table WHERE CONVERT(datetime,ResponseDate)  BETWEEN '20120631' AND '20120801' 
```

我认为不会有任何问题，因为 varchar 已经是日期时间格式。

谁能给我建议？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:18:11.967

尝试使用以下修改后的语句。我认为问题在于它试图将 WHERE 子句中的字符串隐式转换为 DateTime ，但它们的格式不是可以的。

```
Select * From table 
WHERE 
CONVERT(datetime,ResponseDate)  BETWEEN '6/30/2012' AND '8/1/2012' 
```

# c# - DLL 未更新的单服务器问题

> ID：11832834
> 
> 赞同：1
> 
> 时间：2012-08-06T17:12:03.653
> 
> 标签：c#, mono

*按问题编辑由于某种原因，当我对 aspx 标记以外的任何内容进行了更改时，mono 没有检测到，我编写了一些代码，发现了一个错误，杀死了这个错误，上传了新文件，并且错误仍然存​​在，事实上，如果我更改另一个文件（我故意弄乱了一个 CSV 文件以使其出错）它读取它就好像它仍然是旧文件（即使在检查并保存在服务器上之后）它几乎就像一个缓存问题，但是我已经reset，重装了apache。以及我的浏览器，从其他机器等测试。这没有解决任何问题，任何可以帮助解决这个问题的人都会很棒。

感谢您的阅读。

# html - iPad HTML 兼容性

> ID：11832837
> 
> 赞同：0
> 
> 时间：2012-08-06T17:12:13.727
> 
> 标签：html, ipad, compatibility

我已经为多选问题生成了 HTML，只需使用一个包含问题的 png 和多项选择答案，每个答案都包含自己的 png。我希望用户能够点击他们选择的答案，然后继续下一个问题。

在测试中，我发现它使用标准浏览器可以完美运行，但在 iPad 上我无法单击答案选项。我不熟悉 iPad 的 html 要求/限制。我假设我正在做一些苹果的 iPad 版本的 safari 不支持的事情，尽管我不知道它会是什么。

这是身体：

```
<body onload="init('single')" class="single">
<div id="navBar">
  <div id="testButtons" class="formButtons"><button id="submitButton"><img src="../assets/check2.png">I'm done</button><button id="resetButton"><img src="../assets/delete2.png">Start over</button></div>
  <div id="resultsButtons" class="formButtons"></div>
</div>
<div id="test">
  <form>
    <div class="problem" id="problem-1">
      <div class="problemLabel"><span>Problem 1</span></div><img class="stem" src="1.png"><table class="answer">
        <tbody>
          <tr>
            <th><input type="radio" name="rg-1" id="rb-1-1" class="false"><label for="rb-1-1">&#65;</label></th>
            <td><label for="rb-1-1"><img src="1-1.png"></label></td>
          </tr>
          <tr>
            <th><input type="radio" name="rg-1" id="rb-1-2" class="false"><label for="rb-1-2">&#66;</label></th>
            <td><label for="rb-1-2"><img src="1-2.png"></label></td>
          </tr>
          <tr>
            <th><input type="radio" name="rg-1" id="rb-1-3" class="true"><label for="rb-1-3">&#67;</label></th>
            <td><label for="rb-1-3"><img src="1-3.png"></label></td>
          </tr>
          <tr>
            <th><input type="radio" name="rg-1" id="rb-1-4" class="false"><label for="rb-1-4">&#68;</label></th>
            <td><label for="rb-1-4"><img src="1-4.png"></label></td>
          </tr>
        </tbody>
      </table>
    </div>
  </form>
</div>
<div id="results">
  <h3 id="testcomplete">Online Test Complete!</h3>
  <div id="resultsHeader">
    <table class="summary">
      <tbody>
        <tr>
          <th>Title</th>
          <td>single_question_test</td>
        </tr>
        <tr>
          <th>Correct</th>
          <td id="problemsCorrect"></td>
        </tr>
      </tbody>
    </table>
  </div>
</body> 
```

任何帮助将非常感激！希望 iPad 应该使用不同的按钮类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:21:04.683

见[这里](https://stackoverflow.com/questions/7780617/why-arent-my-website-radio-buttons-clickable-on-iphone-ipad)：

如果我不得不猜测，您的表格元素覆盖了 iPad 上的输入元素，这不允许触摸事件。我会尝试制作一个只有单选按钮的 HTML 页面，确保它们是可点击的，然后按照你的方式工作。

# c# - 在另一台计算机上运行我的项目（Windows 窗体）C#

> ID：11832840
> 
> 赞同：3
> 
> 时间：2012-08-06T17:12:29.303
> 
> 标签：c#, forms, exe

有什么方法可以让我的项目（使用 IO、OLEDB 等的多种形式）在没有安装任何 C# 软件的计算机上工作？

我需要让我的项目从 EXE 文件运行。我知道我有一个 exe 文件，`Project/bin/release/Debug`它在安装了 C# express 软件的计算机上运行。

如何将我的项目导出到客户端计算机？

此外，是否有任何公共和免费产品可供安装（用于查找文件和文件夹等任务）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:15:16.630

是的当然！

在大多数情况下，您应该能够简单地将可执行文件（在该`bin`目录中找到）复制到目标机器。您可能还想复制该文件夹中的一些其他必需/有用的文件（例如 .exe.config 或 .pdb 文件，如果您的程序拆分为多个项目，甚至可能是 .dll 文件）。如果有疑问，复制所有内容可能会起作用 - 最坏的情况是其中一些文件是不必要的（例如 .vshost 文件）。

您的目标机器需要安装您所针对的版本（例如 2.0、3.5、4.0 等）的 .Net 框架。在许多情况下，这将已经安装（尤其是在 .Net 2.0 的情况下），如果不是，则通常可以通过 Windows 更新安装这些，或者快速搜索“.Net version X 安装程序”应该做的伎俩。如果您尝试在未安装所需 .Net 框架版本的机器上运行应用程序，您应该会收到相当简单的错误消息。

如果您愿意，那么在将软件分发给客户端时可能需要做一些额外的事情，例如

*   在发布模式下构建
*   创建安装程序
*   [使用ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)进行部署

但是，以上内容应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:15:07.243

您可以右键单击项目的节点以将其发布，然后将其安装到其他机器上。见[clickonce](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T17:16:10.717

您只需在目标计算机上安装 .Net Framework。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:17:57.533

您始终需要在客户端 PC 中安装 .NET 框架。

下面举例说明如何创建安装包。

[为 C# 应用程序制作安装程序，并将 .NET Framework 安装程序包含到安装程序中](https://stackoverflow.com/questions/6090913/make-an-installation-program-for-c-sharp-applications-and-include-net-framework)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:19:05.100

对于 Visual Studio 工具上的开发/部署，仅需要 c# 或 VB.net。需要整个框架。Evrything 有自己的角色（针对它们的设计目的）。你不能跳过它们。但是，是的，您可以通过安装或使用第三方环境来最小化要求。由于我们都知道 VS 是一种许可产品，并且成本为 1000 美元，但一个框架可以免费下载和分发。此外，要开发具有最低要求的 C# 应用程序，您可以使用[icsharp](http://www.icsharpcode.net/)。它是一个轻量级且免费使用的 .Net IDE..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-23T07:06:51.160

您必须安装与您开发 c# 应用程序相同的 .net 框架，您可以从您的 PC 中找到它，只需转到 msvisualstudio 安装文件夹，您就可以找到它，将其复制并安装到客户端 PC 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-13T10:51:52.980

如果您将 yo 应用程序作为 86x 应用程序而不是 64x 应用程序运行，Microsoft.ACE.OLEDB.12.0 将主要在 yo 应用程序中被接受。试试看

# django - 使用 mod_fcgid 添加自定义 Django 应用程序时出现 500 错误

> ID：11832842
> 
> 赞同：0
> 
> 时间：2012-08-06T17:12:33.183
> 
> 标签：django, mod-fcgid

我一直在关注他们网站上的官方 Django 1.3 教程。当我将自定义应用程序（民意调查）添加到`INSTALLED_APPS`列表中时，我的问题出现了`settings.py`：

```
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    'polls',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
) 
```

但是，当我回去查看堆栈跟踪时，我得到了这个：

```
mod_fcgid: stderr: TemplateSyntaxError: Caught ImportError while rendering: No module named polls 
```

我究竟做错了什么？这是整个堆栈跟踪：

```
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: Traceback (most recent call last):
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "build/bdist.linux-i686/egg/flup/server/fcgi_base.py", line 574, in run
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "build/bdist.linux-i686/egg/flup/server/fcgi_base.py", line 1159, in handler
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/core/handlers/wsgi.py", line 272, in __call__
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: response = self.get_response(request)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/core/handlers/base.py", line 169, in get_response
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/core/handlers/base.py", line 203, in handle_uncaught_exception
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return debug.technical_500_response(request, *exc_info)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/views/debug.py", line 59, in technical_500_response
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: html = reporter.get_traceback_html()
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/views/debug.py", line 151, in get_traceback_html
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return t.render(c)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/base.py", line 123, in render
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return self._render(context)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/base.py", line 117, in _render
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return self.nodelist.render(context)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/base.py", line 744, in render
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: bits.append(self.render_node(node, context))
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/debug.py", line 73, in render_node
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: result = node.render(context)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/debug.py", line 90, in render
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: output = self.filter_expression.resolve(context)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/base.py", line 536, in resolve
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: new_obj = func(obj, *arg_vals)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/template/defaultfilters.py", line 695, in date
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return format(value, arg)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/dateformat.py", line 285, in format
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return df.format(format_string)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/dateformat.py", line 30, in format
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: pieces.append(force_unicode(getattr(self, piece)()))
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/dateformat.py", line 191, in r
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return self.format('D, j M Y H:i:s O')
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/dateformat.py", line 30, in format
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: pieces.append(force_unicode(getattr(self, piece)()))
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/encoding.py", line 71, in force_unicode
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: s = unicode(s)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/functional.py", line 206, in __unicode_cast
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return self.__func(*self.__args, **self.__kw)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/translation/__init__.py", line 81, in ugettext
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return _trans.ugettext(message)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/translation/trans_real.py", line 286, in ugettext
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: return do_translate(message, 'ugettext')
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/translation/trans_real.py", line 276, in do_translate
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: _default = translation(settings.LANGUAGE_CODE)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/translation/trans_real.py", line 185, in translation
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: default_translation = _fetch(settings.LANGUAGE_CODE)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/translation/trans_real.py", line 162, in _fetch
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: app = import_module(appname)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: File "/usr/lib/python2.4/site-packages/django/utils/importlib.py", line 35, in import_module
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: __import__(name)
[Sat Aug 04 07:16:55 2012] [warn] [client 74.202.255.243] mod_fcgid: stderr: TemplateSyntaxError: Caught ImportError while rendering: No module named polls 
```

编辑...这是我的`sys.path`：

```
/home/andydefo/andydeforest
/usr/lib/python2.4/site-packages/MySQL_python-1.2.3-py2.4-linux-i686.egg
/usr/lib/python2.4/site-packages/setuptools-0.6c12dev_r88846-py2.4.egg
/usr/lib/python2.4/site-packages/flup-1.0.3.dev_20110405-py2.4.egg
/usr/lib/python2.4/site-packages/pip-1.1-py2.4.egg
/usr/lib/python24.zip
/usr/lib/python2.4
/usr/lib/python2.4/plat-linux2
/usr/lib/python2.4/lib-tk
/usr/lib/python2.4/lib-dynload
/usr/lib/python2.4/site-packages
/usr/lib/python2.4/site-packages/Numeric
/usr/lib/python2.4/site-packages/gtk-2.0 
```

我的`urls.py`：

```
from django.conf.urls.defaults import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'andydeforest.views.home', name='home'),
    # url(r'^andydeforest/', include('andydeforest.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:59:00.680

你的应用程序在`PYTHONPATH`吗？您可以通过以下方式在外壳中检查它

```
$ python manage.py shell 
```

在外壳中，使用

```
> import sys
> print sys.path 
```

如果应用程序未打开`PYTHONPATH`，您可以使用项目的`settings.py`.

在`settings.py`：

```
import os
import sys
PROJECT_ROOT = os.path.dirname(__file__)
sys.path.insert(0, os.path.join(PROJECT_ROOT, "polls")) 
```

如果这不是问题，您是否还可以显示调用模板的 urls.py 和 views.py 部分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T10:28:42.800

有同样的问题，解决了，在settings.py中试试这个：

```
import sys
sys.path.insert(0, "/home/user/django_projects/myproject/") 
```

从这里：[http ://www.bluehostforum.com/showthread.php?21680-DJANGO-Can-t-import-own-module](http://www.bluehostforum.com/showthread.php?21680-DJANGO-Can-t-import-own-module)

# haskell - Haskell 为 Existentials 类型类派生 Eq 实例

> ID：11832851
> 
> 赞同：2
> 
> 时间：2012-08-06T17:13:28.093
> 
> 标签：haskell, typeclass, deriving

有没有办法自动为 Eq （和显示）派生实例`Power`？我设法找到[http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/deriving.html](http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/deriving.html)但我找不到与下面代码相关的任何解释。

此外，如果对下面创建的效果有更好的实践，我愿意接受建议，因为我是 Haskell 和函数式编程的新手。

```
{-# LANGUAGE ExistentialQuantification #-}

class Country a

instance Country CountrySet1 
data CountrySet1 =
  Belgium | 
  Algeria
    deriving (Show)

data Power =
  forall a. Country a => Power a |
  Netural |
  Water
    deriving (Eq, Show) 
```

编辑：我知道这是一种 hack，但由于它几乎都是用前奏函数完成的，它应该得到正确的结果，除非存在完全恶意代码（这是“开放世界假设”最常见的情况） .

```
class Country a where
  show :: a -> String

instance Country CountrySet1 where
  show a = Prelude.show a

data CountrySet1  = 
  England | 
  Turkey
    deriving (Show)

data Power = 
  forall a. Country a => Power a |
  Netural |
  Water

instance Show Power where
  show (Power b) = "Power" ++ Main.show b
  show (Netural) = "Netural"
  show (Water) = "Water"

instance Eq Power where
  (==) a b = Prelude.show a == Prelude.show b 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:53:00.087

我相信 GHC 目前不支持为大多数复杂类型（即只能通过扩展编写的类型）派生实例。但是，与您在此处建议的方法相比，手动编写此实例有一种更简洁的方法。如果您告诉编译器这没关系，您可以分派到and ，而不是创建一个新的`Main.show`and 。这样做的方法是制作和超类：`(Main.==)``Prelude.show``(Prelude.==)``Show``Eq``Country`

```
class (Show a, Eq a) => Country a 
```

但是，正如我们从 的历史中了解到的那样`Num`，您通常希望将负担转移到其他地方。因此，您的另一个选择是将这些约束放在您的存在中：

```
data Power = forall a. (Show a, Eq a, Country a) => Power a | ... 
```

再退一步，您也很可能根本不应该在这里使用存在主义。它们通常是不必要的。但是，如果没有更多上下文，很难给出更有针对性的重构建议。

# animation - 防止 calayer 移动到原始位置

> ID：11832852
> 
> 赞同：0
> 
> 时间：2012-08-06T17:13:28.387
> 
> 标签：animation, calayer, cakeyframeanimation

```
 CAKeyframeAnimation *anim = [CAKeyframeAnimation animationWithKeyPath:@"position"];
NSArray *times = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0], [NSNumber numberWithFloat:0.33], [NSNumber numberWithFloat:0.5], [NSNumber numberWithFloat:1.0], nil];
[anim setKeyTimes:times];
NSArray *values = [NSArray arrayWithObjects:[NSValue valueWithCGPoint: CGPointMake(100., 100.)], [NSValue valueWithCGPoint: CGPointMake(100., 200.)], [NSValue valueWithCGPoint: CGPointMake(220., 200.)], [NSValue valueWithCGPoint: CGPointMake(220., 100.)], nil];
anim.speed=1.0f;
[anim setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[anim setValues:values];
[anim setDuration:6.0]; 
[sublayer addAnimation:anim forKey:@"position"]; 
```

我能够让 CALayer 在路径上设置动画，但在动画之后 CALayer 会跳回原始位置。有什么办法可以防止这种情况发生吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:36:54.957

添加动画后，需要将图层的位置设置为动画的最终位置。

```
CAKeyframeAnimation *anim = [CAKeyframeAnimation animationWithKeyPath:@"position"];
NSArray *times = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0], [NSNumber numberWithFloat:0.33], [NSNumber numberWithFloat:0.5], [NSNumber numberWithFloat:1.0], nil];
[anim setKeyTimes:times];
NSArray *values = [NSArray arrayWithObjects:[NSValue valueWithCGPoint: CGPointMake(100., 100.)], [NSValue valueWithCGPoint: CGPointMake(100., 200.)], [NSValue valueWithCGPoint: CGPointMake(220., 200.)], [NSValue valueWithCGPoint: CGPointMake(220., 100.)], nil];
anim.speed=1.0f;
[anim setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[anim setValues:values];
[anim setDuration:6.0]; 
[sublayer addAnimation:anim forKey:@"position"];
[sublayer.layer.position = [[values lastObject] CGPointValue];// this will set the position to the final position of the animation, (220., 100.); 
```

# c++ - 在递归函数 C++ 中保持计数

> ID：11832854
> 
> 赞同：0
> 
> 时间：2012-08-06T17:13:41.623
> 
> 标签：c++, recursion

我有一个按级别顺序遍历 AVL 树的函数。输出格式为：

```
level 0: jim(2)
level 1: bob(1) joe(1) 
```

但是当我达到 4 级及更高级别时，我想将其分解，因此每行仅显示 8 个项目。所以输出开始看起来像这样：

```
level 4: item1(1) item2(1) item3(2) item4(2) item5(1) item6(2) item7(1) item8(2)
level 4: item9(2) item10(2) 
```

现在我的代码将显示所有项目，但只显示在一行上。我无法弄清楚如何改进此代码，以便按照我想要的方式对其进行格式化。我该如何实施？

以下是当前功能：

```
//PRINT BY LEVEL ORDER TRAVERSAL
void Avltree::level_order(Avlnode* root, ofstream &out){
int h = height(root);
for(int i = 0; i < h; i++){
    out << "Level " << i << ": "; 
    print_level(root, i, out);
    out << endl;
}
}

//PRINT A GIVEN LEVEL ON A TREE
void Avltree::print_level(Avlnode* root, int level, ofstream &out){

    if(root == NULL)
        return;
    if(level == 0){
        out << root->data << "(" << height(root) << ") ";
    }
    else if (level > 0)
    {
        print_level(root->left, level-1, out);
        print_level(root->right, level-1, out);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:16:33.317

您应该将计数作为参数传递给递归函数，当 count % 8 （或任何您希望每行的数字）为 0 时，然后开始新行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:22:10.173

为打印的节点总数添加引用参数的调用

```
void Avltree::print_level(Avlnode* root, int level, ofstream &out, int &count)
{
    ...
    if(level == 0){
        out << root->data << "(" << height(root) << ") ";
        count++;
    }
    if(count==8){
        out << endl;
        count=0;
    }
    ...
} 
```

虽然调用将是

```
int count=0;
for(int i = 0; i < h; i++){
    count=0;
    out << "Level " << i << ": "; 
    print_level(root, i, out, count);
    out << endl;
} 
```

# codeigniter - Chatset latin1 (Vbulletin) 的 Codeigniter 错误

> ID：11832861
> 
> 赞同：1
> 
> 时间：2012-08-06T17:14:07.960
> 
> 标签：codeigniter, vbulletin, latin1

**我使用codeigniter制作了一个项目，如下所示。** 我想连接到 Vbulletin 的 mysql 并在我的项目中显示，我用**UTF-8**而不是**DOM**保存代码，它显示正常，但我在 Chrome 和 IE 上看到错误**HEAD**没有一切。但只有**HEAD**中的**TITLE和****BODY**之后的所有内容。并且在 BODY 之后的 "" 中有空格

 ******我在 codeigniter 中配置 database.php 是。**

```
$db['default']['char_set'] = 'latin1';//utf8
$db['default']['dbcollat'] = 'latin1_swedish_ci';//utf8_general_ci 
```

我使用 latin1 因为 Vbulletin 使用它。

**网页**

```
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="author" content="mr.sam" /> 
```

我尝试更改聊天集是（latin1 或 utf-8）。但它不起作用请帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:23:48.000

这是一个好/常见的问题......把它放在 index.php 中：

```
header("Content-Type: text/html; charset=UTF-8", true); 
```

或者

```
$db['default']['char_set'] = "iso-8859-1";
$db['default']['dbcollat'] = "latin1_general_ci"; 
```

在 config.php 中。

否则，请查看此页面：[http ://hash-bang.net/2009/02/utf8-with-codeigniter/](http://hash-bang.net/2009/02/utf8-with-codeigniter/)****

# ruby-on-rails - 关于 emberjs 中命名约定的困惑

> ID：11832864
> 
> 赞同：1
> 
> 时间：2012-08-06T17:14:17.037
> 
> 标签：ruby-on-rails, ember.js

也许有些人只知道答案，但我试图理解以下内容：

假设您要声明一个视图：

`App.FooView = Ember.View.extend({});`

现在引用此视图会`App.Router`导致以下错误：

`router.get('applicationController').connectOutlet('Foo')`

当我引用 Foo 时，控制台状态：`Uncaught Error: assertion failed: The name you supplied Foo did not resolve to a controller FooController`

我在解释参数的文档中找不到任何地方。也许投反对票的人实际上可以为解决方案做出贡献。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:39:51.947

当你连接一个插座时，路由器会同时寻找一个控制器和一个与提供的同名的视图。在您列出的示例中，路由器正在寻找 FooController 和 FooView，但没有找到控制器。如果你想指定更多细节，你可以传递一个带有视图、控制器和上下文的选项对象，如下所示：

```
router.get('applicationController').connectOutlet( {
           outletName: 'master',
           controller: 'fooController',
           view: 'fooView',
           context: data
        }); 
```

从文档中：

```
connectOutlet: function(name, context) {
// Normalize arguments. Supported arguments:
//
// name
// name, context
// outletName, name
// outletName, name, context
// options
//
// The options hash has the following keys:
//
//   name: the name of the controller and view
//     to use. If this is passed, the name
//     determines the view and controller.
//   outletName: the name of the outlet to
//     fill in. default: 'view'
//   viewClass: the class of the view to instantiate
//   controller: the controller instance to pass
//     to the view
//   context: an object that should become the
//     controller's `content` and thus the
//     template's context. 
```

编辑：语法和代码格式

# ajax - Ajax 错误“Microsoft JScript 运行时错误：‘ID’未定义”

> ID：11832866
> 
> 赞同：0
> 
> 时间：2012-08-06T17:14:23.737
> 
> 标签：ajax, asp.net-ajax

嗨，我正在尝试使用简单的 ajax UpdatePanel ..但是在我尝试朗读页面时不断收到错误“Microsoft JScript 运行时错误：'ID'未定义”。任何人都可以帮助我吗？

代码如下：-

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs"  Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
<title>Hello, world!</title>
</head>
   <body>
<form id="form1" runat="server">
    <asp:ScriptManager ID="MainScriptManager" runat="server" />
    <asp:UpdatePanel ID="pnlHelloWorld" runat="server">
        <ContentTemplate>
            <asp:Label runat="server" ID="lblHelloWorld" Text="Click the button!" />
            <br /><br />
            <asp:Button runat="server" ID="btnHelloWorld" OnClick="btnHelloWorld_Click" Text="Update label!" />
        </ContentTemplate>
    </asp:UpdatePanel>
</form>
</body>
</html> 
```

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-18T15:15:14.300

我遇到了同样的错误，我将其追踪到我正在使用的 C# 类、HTML 代码和淘汰赛 js。似乎淘汰 js 将 javascript viewModel 对象链接到 HTML 页面值和您正在使用的 C# 类对象。例如：

**HTML 页面有：** 注意使用的淘汰赛 Id()。

**C# 类必须具有对该“Id()”的引用：** public int Id { get; 放; }

**这样当您在 javascript 中链接两者时：** viewModel.urlColumn1ReportArray.push(viewModel.currentReportDataArray()[i].ReportDataList()[0]); Knockout js 可以将 HTML“Id()”与 C# 类“Id()”链接起来

很酷吧？！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T23:28:43.743

有同样的问题，认为这与我为 3.5 下载的 Ajax 包有关。我正在使用 win7 x64 - IE 8。在我将 IE 8 更新到 IE 9 后，问题得到了解决。所以我猜它可能与IE 8有关。

# c++ - 使用 C++ 比较大文件

> ID：11832867
> 
> 赞同：7
> 
> 时间：2012-08-06T17:14:26.320
> 
> 标签：c++, file, diff

我有两个大文本文件，每个文件都有超过 1000 万行。如何使用 C++ 比较文件并获取文件中的不同行。

我尝试将一个文件加载到内存中并对内存进行排序并使用二叉​​树逻辑来比较文件。它比较并在 20 秒内给了我结果。但它会消耗更多的内存。（文本文件大约 500 MB）。

我想在不消耗更多内存的情况下比较两个文件，一个良好的性能并且对硬盘的影响最小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:27:04.367

您可以使用两遍方法。

第一遍，您读取文件但只存储哈希值和行的行开始位置，然后您可以根据哈希值比较文件，当两行具有相同的哈希值时，您只能在第二遍中再次读取行以进行完整比较。这将节省内存消耗和 cpu 时间，但读取某些行两次会有点惩罚。

# visual-studio - 如何从模型 .dbml 创建数据库

> ID：11832872
> 
> 赞同：3
> 
> 时间：2012-08-06T17:15:00.350
> 
> 标签：visual-studio, linq-to-sql

我有一个项目以前连接到数据库 SQL Server 2012，但现在我想连接到本地数据库。

如何在模型 .dbml 上创建本地数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T08:28:43.197

您可以以编程方式执行此操作：

[http://weblogs.asp.net/ashicmahtab/archive/2008/11/21/linq-to-sql-dbml-more-than-just-for-accessing-a-db.aspx](http://weblogs.asp.net/ashicmahtab/archive/2008/11/21/linq-to-sql-dbml-more-than-just-for-accessing-a-db.aspx)

# jquery - 如何从加载的内容中调用 jquery lightBox

> ID：11832876
> 
> 赞同：0
> 
> 时间：2012-08-06T17:15:08.383
> 
> 标签：jquery, image, load, loaded

我正在尝试使用 jquery lightbox 来显示使用 load() 加载到页面中的照片。我的代码是：

```
$('#content').on('click', 'a.thumb_link', function(){        
    $('a.thumb_link').lightBox();
    return false;
}); 
```

这仅在我单击链接两次时才有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:45:09.560

你不能做类似的事情吗

```
$('#content').live('click', function()
{
   $('a.thumb_link').lightBox();
   return false;
} 
```

如果我有更多代码作为示例可以使用，我可能能够提供更好的解决方案，但我只能抓住稻草假设内容是什么，与类的链接`thumb_link`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T03:06:47.927

这是我的完整代码：

加载的.php

```
<a class="thumb_link" href="../members/21000_21999/21659/21659-1.jpg">
<img src="../members/21000_21999/21659/21659-1.jpg"></a>

<a class="thumb_link" href="../members/21000_21999/21659/21659-3.jpg">
<img src="../members/21000_21999/21659/21659-3.jpg"></a> 
```

测试.php

```
<!doctype html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Test</title>
<link rel="stylesheet" type="text/css" href="css/jquery.lightbox-0.5.css"        media="screen" />
<script src="js/jquery.js"></script>
<script src="js/jquery.lightbox-0.5.js"></script>

<body>
<a class="link" href="../members/21000_21999/21659/21659-1.jpg">
<img src="../members/21000_21999/21659/21659-1.jpg">
</a>

<a class="link" href="../members/21000_21999/21659/21659-3.jpg">
<img src="../members/21000_21999/21659/21659-3.jpg">
</a>

<div id="content"></div>
<script>
$(document).ready(function(){

    $('a.link').lightBox();

    $('#content').load('loaded.php');

    $('#content').on('click', 'a.thumb_link', function(){        
        $('a.thumb_link').lightBox();
        return false;
    }); 

});
</script>
</body>
</html> 
```

直接在 test.php 中编码的前 2 个图像将通过单击图像运行 lightBox。底部 2 个加载的图像仅在我单击两次时才运行 lightBox。

或者，如果我首先单击顶部图像然后单击加载的图像（仍然单击两次），加载的图像将运行 lightBox

我正在使用：jquery v1.7.1 jquery lightBox v0.5

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T08:28:17.267

我很困惑，为什么提供的2个答案不起作用？

最后，我设法通过将我的 JS 包含在加载的页面中来使其工作，以便脚本与其他内容一起加载到页面中。

这成功了：

```
$('a.thumb_link').lightBox(); 
```

# sql - 前 N 个聚合子查询

> ID：11832878
> 
> 赞同：0
> 
> 时间：2012-08-06T17:15:16.763
> 
> 标签：sql, subquery, aggregate-functions, top-n

假设我有一张名为 COFFEE 的表格，其中显示了公交车站和公交车站 10 个街区内的所有咖啡店：

```
 BusStationID| CoffeeShopID |  Distance (in city blocks)
    1|2103|2
    1|2222|2
    1|8864|7
    1|9920|5
    1|3544|2
    1|4830|2
    1|4823|6
    1|9561|2
    7|6262|2
    7|8561|10
    7|9510|5
    7|2744|1       
    7|4223|9
    7|5960|3 
```

[编辑：明确问题是如何通过非程序查询来做到这一点]

而且我必须编写一个*查询*（而不是 proc）来显示每个公交车站到最近的五家咖啡店的平均距离。

我可以找到特定巴士站的前 5 家最近的咖啡店：

```
 select avg(top5.distance) as AvgDistToFiveClosest
           from
           (
           select top 5 distance from COFFEE where busstationid = 1
           order by distance
           ) as top5 
```

但是如何将其连接为子查询并使 AvgDistToFiveClosest 成为我的主查询中返回的列：

```
 select BusStationId,  AvgDistToFiveClosest
        from COFFEE...
         ?????? 
```

鉴于上面的示例数据，查询应返回：

```
 BusStationID | AvgDistToFiveClosest
           1 | 2
           7 | 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:46:10.333

这是 Oracle (9g+) SQL 代码，已更正，我找到了单个选择语句的答案

```
with
distanceRanks as
(
  SELECT
    busstationid,
    distance,
    --rank the rows on the distance column from smallest to longest, and differentiate equal distances by rownum
    rank() over ( partition by busstationid
                  order by distance, rownum asc) as ranking
  FROM coffee
  ORDER BY 1 asc
)
SELECT busstationid, avg(distance)
FROM distanceRanks
WHERE ranking < 6
group by busstationid; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:12:38.980

尝试这个：

```
SELECT c.BusStationID, AVG(c.distance)
FROM COFFEE c
WHERE c.CoffeeShopID IN 
(SELECT TOP 5 c2.CoffeeShopID FROM COFFEE c2 WHERE c2.BusStationID = c.BusStationID
ORDER BY c2.distance)
GROUP BY c.BusStationID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T05:48:20.890

尝试这个

```
Select distinct busstationid , (select top 5 avg(distance) from coffee ce where ce.busstationid = b.busstationid order by distance) as AvgDistToFiveClosest
From coffee b 
```

# node.js - 如何在不进行磁盘写入的情况下处理 Express.js 中的 POST 文件

> ID：11832884
> 
> 赞同：3
> 
> 时间：2012-08-06T17:16:02.450
> 
> 标签：node.js, post, express

我想允许用户使用表单将图像文件上传（POST）到我的 Express.js Web 应用程序。收到后，我的 Web 应用程序会将其发布到 GetChute API（一种图像 Web 服务）。

我不希望我的服务器暂时将图像写入磁盘 - 相反，它应该将图像存储到变量中，并将其发送到 GetChute。

默认情况下，我认为 2 个 Express 中间件项（Connect 和 Formidable）提供了一种从 POST 自动执行磁盘写入的好方法，但我将如何绕过它们直接访问字节流，从而避免磁盘写入？

我怀疑比我更聪明的人可以提出比最近针对类似问题提出的更简洁的解决方案：

[通过gm使用Express.js上传的流文件消除双重写入](https://stackoverflow.com/questions/11764585/stream-file-uploaded-with-express-js-through-gm-to-eliminate-double-write)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:49:54.513

您可以直接将请求流式传输到 GetChute 吗？

```
app.post('/upload', function(req, res) {
  var chuteReq = http.request({
    host: 'api.getchute.com',
    path: '/x/y/z',
    method: 'POST'
  }, function(chuteRes) {
    var chuteBody = '';

    chuteRes.on('data', function(chunk) {
      chuteBody += chunk;
    });

    chuteRes.on('end', function() {
      var chuteJSON = JSON.parse(chuteBody);

      // check the result and build an appropriate response.
      res.end(chuteJSON);
    });
  });

  // pipe the image data directly to GetChute
  req.pipe(chuteReq);      
}); 
```

当然，您可以将请求调整为 GetChute。小心，您可能必须解码[multipart/form-data](https://stackoverflow.com/questions/4526273/what-does-enctype-multipart-form-data-mean)。

# cassandra - 用于对所有行进行分页的 Cassandra CQL 方法

> ID：11832886
> 
> 赞同：2
> 
> 时间：2012-08-06T17:16:07.473
> 
> 标签：cassandra, thrift, cql

我想以编程方式检查大型 cassandra 表中的所有行，并希望使用 CQL。我知道我可以用 thrift 来做到这一点，使用 multiget 一次获取 10,000（左右）行，并将最后检索到的密钥交给下一个 multiget 调用。但是我查看了有关 CQL select 的所有文档，似乎没有办法做到这一点。我已经将选择限制设置得越来越高，并将超时设置得越来越高以匹配它。

是否有一种未记录的方式可以将起点交给 CQL 选择，还是我只需要使用 thrift API 分解和重写我的代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T18:02:05.747

结果证明大于和小于具有非常不直观但有用的行为（至少在 CQL2 中，我还没有检查 CQL3）。它实际上比较的是标记而不是键值。这是一个例子：

```
> create table users (KEY varchar PRIMARY KEY, data varchar);
> insert into users (KEY, 'data') values ('1', 'one');
> insert into users (KEY, 'data') values ('2', 'two');
> insert into users (KEY, 'data') values ('3', 'three');
> insert into users (KEY, 'data') values ('4', 'four');
> select * from users;
   3 | three
   2 |   two
   1 |   one
   4 |  four
> select * from users LIMIT 1;
   3 | three
> select * from users WHERE KEY > '3' LIMIT 1;
   2 |  two
> select * from users WHERE KEY > '2' LIMIT 1;
   1 |  one
> select * from users WHERE KEY > '1' LIMIT 1;
   4 | four 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T10:42:32.537

检查这个：[http ://wiki.apache.org/cassandra/FAQ#iter_world](http://wiki.apache.org/cassandra/FAQ#iter_world)

您需要手动对其进行编程，例如，每个后续查询都需要提供起点，这是上一个查询的最后一个结果。此起始端口将允许您创建切片查询，该查询返回有限数量的结果。

例如，您有具有以下列名称的行：

A1,A2,A3,B1,B2,B3,B4,B5,B6,C4,C5,D1,D2,D4,E2,E23,E4,E5,E6,E7

现在你想迭代它，每个响应都有 3 个结果

切片 1) 开始：“”，结束：“”，限制：3 -> A1,A2,A3
切片 2) 开始：“A3”，结束：“”，限制：3 -> B1,B2,B3
切片 3)开始：“B3”，结束：“”，限制：3 -> B4,B5,B6
切片 4) 开始：“B6”，结束：“”，限制：3 -> C4,C5,D1

# android - Android中的权限使用

> ID：11832889
> 
> 赞同：0
> 
> 时间：2012-08-06T17:16:11.630
> 
> 标签：android, android-intent, permissions

我需要保证，只有我的应用程序才能向我的 IntentService 广播意图。如何使用 Android 权限进行设置？

我在 gcm android 库中看到了类似的权限用法，但我不明白它是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:31:55.623

如果您希望您自己的任何应用程序可以使用此服务（多个应用程序）但其他应用程序不能，您将需要实现基于签名的权限。

声明自己的自定义签名权限

```
<permission android:description="string resource"
android:icon="drawable resource"
android:label="string resource"
android:name="string"
android:permissionGroup="string"
android:protectionLevel="signature" /> 
```

然后使用 BroadcaseReceiver 在您的 BroadcaseReceiver 中强制执行此权限

```
android:permission="string" 
```

在您的接收器中添加标签，甚至您可以在任何其他组件（如活动等）中执行此操作。

然后在您想要访问上述功能的其他应用程序中，可以在其清单中声明使用权限。请记住：您的第二个应用程序必须由相同的证书签名才能使用基于自定义签名的权限。在此处阅读有关权限的更多信息：http: [//developer.android.com/guide/topics/security/permissions.html](http://developer.android.com/guide/topics/security/permissions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:23:32.657

请参阅：

[http://developer.android.com/guide/components/services.html](http://developer.android.com/guide/components/services.html)

> 如果您计划仅在本地使用您的服务（其他应用程序不使用它），那么您不需要（也不应该）提供任何意图过滤器。如果没有任何意图过滤器，您必须使用明确命名服务类的意图来启动服务。

只是不要在清单中放置任何 Intent 过滤器......

# javascript - 使用 jQuery-File-Upload 插件创建上传按钮和进度条

> ID：11832891
> 
> 赞同：4
> 
> 时间：2012-08-06T17:16:15.023
> 
> 标签：javascript, jquery

我正在尝试使用[jQuery File Upload](http://blueimp.github.com/jQuery-File-Upload/)插件以 ajax 形式上传一些文件。我正在尝试遵循[“基本”插件](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)的说明，但文档有点稀疏。

我看不到任何创建“开始上传”按钮的方法。我也不太明白如何为单个上传设置进度条。我看到我可以`data.context`在`add`回调中进行设置，但是如果其中有多个文件，这将如何工作`data.files`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:35:02.757

所有标记都必须包含在表单中，这是表单的标记。

```
<form id="fileupload" action="/path/to/your/controller/ext" method="POST" type="multiplart/form-data">...everything below this goes in here </form> 
```

这是用于创建“开始上传”按钮的标记。

```
<button class="btn btn-primary start" type="submit">
    <span>Start upload</span>
</button> 
```

这是创建“添加文件”按钮的标记。

```
<span class="btn btn-success fileinput-button">
   <span>Add files...</span>
   <input type="file" multiple="" name="files[]">
</span> 
```

这是创建“取消上传”按钮的标记。

```
<button class="btn btn-warning cancel" type="reset">
    <span>Cancel upload</span>
</button> 
```

这是创建“删除”按钮的标记。

```
<button class="btn btn-danger delete" type="button">
    <span>Delete</span>
</button> 
```

这是显示单个文件进度的标记。每个文件都是*同步*处理的，这意味着这个进度条将始终显示文件的进度`currently queued file.`

```
<div class="span5 fileupload-progress fade">
    <!-- The global progress bar -->
    <div aria-valuemax="100" aria-valuemin="0" role="progressbar" class="progress progress-success progress-striped active">
        <div style="width:0%;" class="bar"></div>
    </div>
    <!-- The extended global progress information -->
    <div class="progress-extended">&nbsp;</div>
</div> 
```

这是用于在处理文件数据时保存文件数据的 HTML。

```
<table class="table table-striped" role="presentation">
    <tbody data-target="#modal-gallery" data-toggle="modal-gallery" class="files"></tbody>
 </table> 
```

您可以看到这是一个标准的“提交”按钮。它将用于处理我们的表单。当您单击它时，表单将尝试上传所有文件部分。

进度条的 HTML，如上面的代码所假定的那样。

```
<div id="progress">
    <div class="bar" style="width: 0%;"></div>
</div>

$(function () {
    $('#fileupload').fileupload({
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result, function (index, file) {
                $('<p/>').text(file.name).appendTo(document.body);
             });
        },
        progressall: function (e, data) {
           var progress = parseInt(data.loaded / data.total * 100, 10);
           $('#progress .bar').css(
               'width',
               progress + '%'
           );
        }
   });
}); 
```

根据该站点，每个 javascript 文件都会提交有关其功能和要求的评论。让我们分解一下

jQuery

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
//We need the jQuery core. No need for an explanation. 
```

jQuery UI Widget 贯穿始终，如果**我们还没有包含 jQuery UI 核心或 jQuery UI.widget 核心，我们必须包含它们

```
<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
<script src="js/vendor/jquery.ui.widget.js"></script> 
```

有一个模板工厂插件用于在您将元素拖放/添加到列表时自动生成元素。你会想要包括这个。

```
<!-- The Templates plugin is included to render the upload/download listings -->
<script src="http://blueimp.github.com/JavaScript-Templates/tmpl.min.js"></script> 
```

您希望能够调整大小和预览图像吗？我打赌你会

```
<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
<script src="http://blueimp.github.com/JavaScript-Load-Image/load-image.min.js"></script> 
```

这是为了 HTML5 Canvas 到 Blob 的支持。它保持与上述类似的功能，但是对于 HTML5 上传是必需的。

```
<!-- The Canvas to Blob plugin is included for image resizing functionality -->
<script src="http://blueimp.github.com/JavaScript-Canvas-to-Blob/canvas-to-blob.min.js"></script> 
```

下一个非常不言自明，我们不需要这些，但他将它们用于演示。

```
<!-- Bootstrap JS and Bootstrap Image Gallery are not required, but included for the demo -->
<script src="http://blueimp.github.com/cdn/js/bootstrap.min.js"></script>
<script src="http://blueimp.github.com/Bootstrap-Image-Gallery/js/bootstrap-image-gallery.min.js"></script> 
```

如果浏览器不支持 XHR 文件上传，那么我们在后台使用 iFrame 来模拟该功能。您需要它来支持浏览器。

```
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="js/jquery.iframe-transport.js"></script> 
```

其余的是与插件本身相关的核心文件。

```
<!-- The basic File Upload plugin -->
<script src="js/jquery.fileupload.js"></script>

<!-- The File Upload file processing plugin -->
<script src="js/jquery.fileupload-fp.js"></script>

<!-- The File Upload user interface plugin -->
<script src="js/jquery.fileupload-ui.js"></script> 
```

下一个不是那么自我解释。本地化处理语言差异化。

```
<!-- The localization script -->
<script src="js/locale.js"></script> 
```

最后，这是我们土豆的肉。Main.js 处理我们所有的脚本执行和条件化。这是您要熟悉的文件。如果您检查他们的页面，您会看到正在发生的一切。一个简单的复制+粘贴就足够了；但是，您需要更改此脚本中的 URL 值以匹配您计划使用的服务器。

```
<!-- The main application script -->
<script src="js/main.js"></script> 
```

祝你好运。

# javascript - 如何在 node.js 中执行同步 SQL 查询

> ID：11832892
> 
> 赞同：2
> 
> 时间：2012-08-06T17:16:22.877
> 
> 标签：javascript, mysql, node.js

> **可能重复：**
> [使用 Node.js 进行同步数据库查询](https://stackoverflow.com/questions/6597493/synchronous-database-queries-with-node-js)

通常，我们执行 SQL 查询并在回调中获取结果。像这样：

```
sqlExec('SELECT COL FROM TBL;', function (err, results, fields) {
    doSomething(results);
}); 
```

但是如果我们需要对 SQL 结果做更复杂的工作，代码会更难看，像这样：

```
var tmp = '';
sqlExec('SELECT COL1 FROM TBL1;', function (err, results, fields) {
    tmp = doSomething(results);
    sqlExec('SELECT COL2 FROM TBL2 WHERE CONDITION2 = ' + tmp +  ';', function (err, results, fields) {
        tmp = doSomething2(results);
        sqlExec('SELECT COL3 FROM TBL3 WHERE CONDITION3 = ' + tmp  + ';', function (err, results, fields) {
            ....
        });
    });
}); 
```

我们有让它同步的想法吗？像这样：

```
var tmp = '', result = ''; 
result = sqlExec('SELECT COL1 FROM TBL1;');
tmp = doSomething(result);
sqlExec('SELECT COL2 FROM TBL2 WHERE CONDITION2 = ' + tmp  + ';');
tmp = doSomething(result);
sqlExec('SELECT COL3 FROM TBL3 WHERE CONDITION3 = ' + tmp  + ';');
... 
```

谢谢， 考菲

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:59:56.210

此处描述了一个不错的模式[http://stella.laurenzo.org/2011/03/bulletproof-node-js-coding/](http://stella.laurenzo.org/2011/03/bulletproof-node-js-coding/)第 2 段，以您的示例为例，它将是这样的：

```
sqlExec('SELECT COL1 FROM TBL1;', function (err, results, fields) {
    var tmp = doSomething(results);
    nextStep( tmp );
}

function nextStep( tmp ) {
    sqlExec('SELECT COL2 FROM TBL2 WHERE CONDITION2 = ' + tmp +  ';', function (err, results, fields) {
    var othertmp = doSomething2(results);
    nextNextStep( othertmp );
    }
}

function nextNextStep( tmp ) {
    sqlExec('SELECT COL3 FROM TBL3 WHERE CONDITION3 = ' + tmp  + ';', function (err, results, fields) {
        ....
 } 
```

现在它几乎看起来像你想要的结果

# oauth-2.0 - OAuth 2 - “用户名和密码流”与“客户端凭据流”有什么区别

> ID：11832893
> 
> 赞同：7
> 
> 时间：2012-08-06T17:16:23.903
> 
> 标签：oauth-2.0

在这两种情况下，用户凭据都被交换为访问令牌。有人可以解释其中的区别吗？

这是来自[http://hueniverse.com的流程描述](http://hueniverse.com)

```
• User-Agent Flow – for clients running inside a user-agent (typically a web browser).
• Web Server Flow – for clients that are part of a web server application, accessible via HTTP requests. This is a simpler version of the flow provided by OAuth 1.0.
• Device Flow – suitable for clients executing on limited devices, but where the end-user has separate access to a browser on another computer or device.
• Username and Password Flow – used in cases where the user trusts the client to handle its credentials but it is still undesirable for the client to store the user’s username and password.  This flow is only suitable when there is a high degree of trust between the user and the client.
• Client Credentials Flow – the client uses its credentials to obtain an access token. This flow supports what is known as the 2-legged scenario.
• Assertion Flow – the client presents an assertion such as a SAML assertion to the authorization server in exchange for an access token. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T20:28:52.133

您在这里混合了*客户端*和*用户*凭据。

*OAuth 上下文中的客户端*始终是指获得授权的应用程序。因此，在*客户端凭证流*中，应用程序直接向提供者授权自己，而无需用户的任何输入（也称为[*2-legged 流*](https://stackoverflow.com/a/6949008/1467115)，因为只涉及两方）。

用户名和*密码流程*是一个*3-legged-flow*。用户向应用程序提供他的用户名和密码，然后应用程序使用这些凭据向提供者请求数据。

# android - 片段内的Android WebView：如何使WebView回退？

> ID：11832903
> 
> 赞同：0
> 
> 时间：2012-08-06T17:17:13.873
> 
> 标签：android, webview

我想知道如果按下后退按钮，如何使片段中的 onCreateView 内的 WebView 返回。前段时间在这里被问过，但没有得到任何答案。有人能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:42:00.210

您需要将 WebView 添加到 FragmentManager 的 BackStack。查看[FragmentManager Docs](http://developer.android.com/reference/android/app/FragmentManager.html)了解具体语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-29T21:10:04.027

**在您的 OnCreateView 内部：**

```
 @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        view = inflater.inflate(R.layout.your_layout, container, false);

      mWebView = (WebView) view.findViewById(R.id.webView);
        mWebView.getSettings().setJavaScriptEnabled(true);
        mWebView.setWebViewClient(new MyWebViewClient());
        mWebView.loadUrl(expertsUrl);

        return view;
    }

private class MyWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    } 
```

好的！在您的 MainActivity 中，您将编写它：

```
 @Override
        public void onBackPressed() {
if (WebViewFragment.mWebView!=null) {
            if (WebViewFragment.mWebView.canGoBack()) {
                WebViewFragment.mWebView.goBack();
            }
}
        } 
```

WebViewFragment= 这是你的 nameFragment 内容的 Webview

mWebView= 您的 WebView 的名称 (id)

现在。在您的 Fragment 内部，您必须声明静态全局变量

```
public static Webview mWebView; 
```

就是这样！祝你好运！

# android - 是否可以拦截和取消 FragmentTransaction

> ID：11832904
> 
> 赞同：0
> 
> 时间：2012-08-06T17:17:27.873
> 
> 标签：android, android-fragments, android-actionbar

我在 ActionBar (Sherlock) 上有两个选项卡。在某些情况下，我想询问用户是否尝试离开当前选项卡并在未确认时停止选项卡更改。这主要是由于在用户在另一个选项卡上摆弄其设置之前停止了一个进程。

当我使用 TabHost 时，我有一个非常丑陋但可行的解决方案，在选项卡本身上有一个 OnTouchListener，所以我可以在事件真正处理之前拦截它。似乎 ActionBar 选项卡不能有触摸监听器，所以这似乎是不可能的。

现在有了 ActionBar，我有了 TabListeners 来处理 FragmentTransaction 上的分离和附加。有什么简单的方法可以取消交易吗？我想我可以对 onTabUnselected 和 onTabSelected 进行检查，只是不进行相应的分离和附加操作，但这感觉有点复杂。

如果停止标签更改听起来过于愚蠢，我也愿意接受其他建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:02:44.933

好的，这就是我最终要做的，以防有人在这里绊倒。我找不到任何合理的方法来阻止选项卡更改或获取选项卡视图以附加触摸侦听器。令人恼火，至少可以这么说。

相反，当我想将用户转回原始选项卡时，我使用 TabListener 附加一个空片段。在这个片段的 onResume() 中，我打开了一个对话框，提供继续第二个选项卡或返回第一个选项卡的选择。在任何一种情况下，我只需使用正确的选项卡调用操作栏的 setSelectedNavigationItem()，TabListener 将处理传输，处理我的空片段。

最后它实际上工作得很好。

# ruby-on-rails - RSpec：将带有字符串键的哈希与带有符号键的哈希进行比较？

> ID：11832906
> 
> 赞同：19
> 
> 时间：2012-08-06T17:17:28.227
> 
> 标签：ruby-on-rails, ruby, rspec2

考虑以下 RSpec 片段：

```
it "should match" do
  {:a => 1, :b => 2}.should =~ {"a" => 1, "b" => 2}
end 
```

此测试失败，因为一个哈希使用符号作为键，而另一个使用字符串作为键。在我的例子中，一个散列是解析的 JSON 对象，另一个是创建对象的散列。我希望他们平等比较。

在我编写自己的匹配器或强制两个哈希具有字符串键之前，是否有处理这种（常见）情况的匹配器或技术？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-06T17:39:44.480

你可以这样做：

```
it "should match" do
    {:a => 1, :b => 2}.stringify_keys.should =~ {"a" => 1, "b" => 2}
end 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-09-30T20:07:12.393

假设您可以访问[Rails 的 ActiveSupport](http://apidock.com/rails/ActiveSupport/HashWithIndifferentAccess)。您可以利用 `with_indifferent_access`来匹配两个哈希。下面是 hashrocket Ruby 语法和 Rspec 期望语法的示例：

```
it 'matches two hashes' do
  hash_1 = {a: 1, b: 2}.with_indifferent_access
  hash_2 = {'a' => 1, 'b' => 2}
  expect(hash_1).to match(hash_2)
end 
```

注意：确保`with_indifferent_access`在带有符号键的散列上使用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:28:45.580

最简单的方法是编写它以使其与您得到的东西相匹配，例如如果您获得字符串则放入字符串，或者如果您获得符号则放入符号。

如果你不能这样做，我会做的是：

```
it "should match" do
  {:a => 1}.with_indifferent_access.should =~ {'a' => 1}.with_indifferent_access
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T17:24:00.673

我从来没有听说过，但你可以看看在`HashWithIndifferentAccess`rails 中解决这个问题的 active_supports：http: [//apidock.com/rails/ActiveSupport/HashWithIndifferentAccess](http://apidock.com/rails/ActiveSupport/HashWithIndifferentAccess)

# android - 具有自定义 ImageAdapter 的 GridView 在数据集更改后不会更新

> ID：11832907
> 
> 赞同：1
> 
> 时间：2012-08-06T17:17:28.880
> 
> 标签：android, gridview, adapter

我正在实现一个支持多项选择的图像库。主要布局是`GridView`使用自定义的`Adapter`. 每个显示的项目都是一个组合`ImageView`+ `CheckBox`。如果选中了多个复选框，我想通过触摸`GridView`. 我呼吁`notifyDataSetChanged()`实现这个功能。不幸的是，这个“取消选中所有”功能不起作用。我还是一个新手，所以可能有一些我不明白的基本内容。有人可以告诉我我的 有什么问题`Adapter`吗？谢谢。

```
public class ImageAdapter extends BaseAdapter {
    private Context mContext;

    // References to our images
    public Integer[] mThumbIds = {
            R.drawable.sample_1, R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_1, R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_1, R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_1, R.drawable.sample_2, R.drawable.sample_3
    };

    // The layout inflater used to retrieve gallery children layouts
    private LayoutInflater mInflater;

    // Array used to update checkboxes
    public boolean[] checkboxesState = new boolean[getCount()];

    public ImageAdapter(Context c) {
        mContext = c;
        mInflater = (LayoutInflater) 
                c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        // Define the initial checked/unchecked state of the checkboxes
        for(int i = 0; i < getCount(); i++) {
            checkboxesState[i] = false;
        }
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    /* Create a new View for each cell displayed in the GridView.
     * In our case a View is an instance of RelativeLayout from which
     * we can extract the image and checkbox to be displayed in the cell
     */
    public View getView(int position, View convertView, ViewGroup parent) {
        View cell = convertView;
        if (cell == null) {
            // No View passed, create one.
            cell = mInflater.inflate(R.layout.galleryitem, null);
            // Setup the View content
            ImageView imageView = (ImageView)cell.findViewById(R.id.thumbImage);
            CheckBox checkBox = (CheckBox) cell.findViewById(R.id.itemCheckBox);
            checkBox.setChecked(checkboxesState[position]);
            checkBox.setId(position);
            imageView.setImageBitmap(downsample(mThumbIds[position]));

            // Setup the View behavior
            imageView.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    // Uncheck all checked items
                    uncheckAll();
                }
            });

            checkBox.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    CheckBox cb = (CheckBox) v;
                    checkboxesState[cb.getId()] = cb.isChecked();
                }
            });
        }
        return cell;
    }

    private Bitmap downsample(int resId){
        // Some code here
    }

    private void uncheckAll() {
        // This code does not work. GridView is not refreshed
        for(int i = 0; i < checkboxesState.length; i++) {
            checkboxesState[i] = false;
        }
        notifyDataSetChanged();
    }
} 
```

**更新**

我意识到我最初的帖子并没有准确描述 uncheckAll 方法是如何失败的。当我选中 N 个复选框并调用 uncheckAll 方法时会发生什么：

*   最初选中的复选框未选中
*   一组新的 N 个复选框被选中

这种行为让我想到可能是 gridview 项目出乎意料地改变了它们在 中的位置，`GridView`所以我`TextView`为每个项目添加了一个唯一名称。我的想法是正确的：当我滚动屏幕时，项目会改变它们在`GridView`. 调用 uncheckAll 时也会发生同样的情况。我[在这个线程中](https://stackoverflow.com/questions/6055730/gridview-elements-changes-their-place-dynamically-when-scroll-screen)找到了适合我的解决方案。

注意：一开始我并没有意识到移动问题，因为在这个开发阶段我`ImageView`为每个`GridView`项目使用相同的资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:20:30.453

问题很可能是您的 getView() 方法正确初始化了新的单元格视图，但从未更新已回收的单元格视图的状态。所以基本上每个单元格视图只会显示它被初始化的状态。它应该看起来像这样：

```
public View getView(int position, View convertView, ViewGroup parent) {
    View cell = convertView;

    if (cell == null) {
        // No View passed, create one.
        cell = mInflater.inflate(R.layout.galleryitem, null);
        // Setup the View content
        ImageView imageView = (ImageView)cell.findViewById(R.id.thumbImage);
        CheckBox checkBox = (CheckBox) cell.findViewById(R.id.itemCheckBox);
        checkBox.setChecked(checkboxesState[position]);
        checkBox.setId(position);
        imageView.setImageBitmap(downsample(mThumbIds[position]));

        // Setup the View behavior
        imageView.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                // Uncheck all checked items
                uncheckAll();
            }
        });

        checkBox.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                CheckBox cb = (CheckBox) v;
                checkboxesState[cb.getId()] = cb.isChecked();
            }
        });
    } else {
        ImageView imageView = (ImageView)cell.findViewById(R.id.thumbImage);
        CheckBox checkBox = (CheckBox) cell.findViewById(R.id.itemCheckBox);
        checkBox.setChecked(checkboxesState[position]);
        checkBox.setId(position);
        imageView.setImageBitmap(downsample(mThumbIds[position]));
    }

    return cell;
} 
```

此外，为了提高 getView() 方法的性能，请查看本[教程](http://developer.android.com/training/improving-layouts/smooth-scrolling.html#ViewHolder)。

# url - java 应用程序 URL 客户端上下文

> ID：11832908
> 
> 赞同：0
> 
> 时间：2012-08-06T17:17:36.757
> 
> 标签：url

我在 abc.com 上有一个应用程序。我希望各种公司在 abc.com 上注册，以便我可以分配他们专用的 URL，例如 client1.abc.com。例如 client1.jira.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:52:06.960

如果您不想要一个“真正的”子域，那么您必须与您的虚拟主机一起处理。这样做涉及将条目添加到 DNS 服务器（由您的托管服务管理，而不是您）。

但是，您可以将其设置为将所有请求`*.yourdomain.com`路由到同一服务器，然后该服务器解析实际请求 url 并相应地重定向。这称为***通配符域***。

因此，基本上，当客户登录您的站点并选择他们的子域名时，您只需将其添加到您检查的子域名列表中即可。本质上，每次客户端向子域发出请求时，您都会遍历列表，检查请求是否与列表中的任何条目匹配，如果匹配，则显示该子域的选项。

当客户添加子域时，您只需将子域添加到列表中，并为它添加逻辑，但是您想这样做。当然请注意，这是您真正想做的事情的过度简化版本。这只是为了给您提供想法并帮助您入门。

# javascript - 如有必要，如何舍入至多 2 位小数？

> ID：11832914
> 
> 赞同：3552
> 
> 时间：2012-08-06T17:17:48.293
> 
> 标签：javascript, rounding, decimal-point

我想最多四舍五入小数点后 2 位，但*仅限于必要时*。

输入：

```
10
1.7777777
9.1 
```

输出：

```
10
1.78
9.1 
```

如何在 JavaScript 中做到这一点？

* * *

## 回答 #1

> 赞同：4654
> 
> 时间：2012-08-06T17:20:31.017

使用[`Math.round()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)：

```
Math.round(num * 100) / 100 
```

或者更具体地说，为了确保 1.005 之类的东西正确舍入，请使用[Number.EPSILON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON)：

```
Math.round((num + Number.EPSILON) * 100) / 100 
```

* * *

## 回答 #2

> 赞同：3769
> 
> 时间：2012-10-11T00:27:24.237

如果值是文本类型：

```
parseFloat("123.456").toFixed(2); 
```

如果值是一个数字：

```
var numb = 123.23454;
numb = numb.toFixed(2); 
```

有一个缺点是，像 1.5 这样的值会给出“1.50”作为输出。@minitech 建议的修复：

```
var numb = 1.5;
numb = +numb.toFixed(2);
// Note the plus sign that drops any "extra" zeroes at the end.
// It changes the result (which is a string) into a number again (think "0 + foo"),
// which means that it uses only as many digits as necessary. 
```

这似乎`Math.round`是一个更好的解决方案。**但事实并非如此！**在某些情况下，它**不会**正确舍入：

```
Math.round(1.005 * 100)/100 // Returns 1 instead of expected 1.01! 
```

在某些情况下， toFixed() 也**不会**正确舍入（在 Chrome v.55.0.2883.87 中测试）！

例子：

```
parseFloat("1.555").toFixed(2); // Returns 1.55 instead of 1.56.
parseFloat("1.5550").toFixed(2); // Returns 1.55 instead of 1.56.
// However, it will return correct result if you round 1.5551.
parseFloat("1.5551").toFixed(2); // Returns 1.56 as expected.

1.3555.toFixed(3) // Returns 1.355 instead of expected 1.356.
// However, it will return correct result if you round 1.35551.
1.35551.toFixed(2); // Returns 1.36 as expected. 
```

我猜，这是因为 1.555 实际上在幕后类似于 float 1.55499994。

**解决方案 1**是使用具有所需舍入算法的脚本，例如：

```
function roundNumber(num, scale) {
  if(!("" + num).includes("e")) {
    return +(Math.round(num + "e+" + scale)  + "e-" + scale);
  } else {
    var arr = ("" + num).split("e");
    var sig = ""
    if(+arr[1] + scale > 0) {
      sig = "+";
    }
    return +(Math.round(+arr[0] + "e" + sig + (+arr[1] + scale)) + "e-" + scale);
  }
} 
```

[https://plnkr.co/edit/uau8BlS1cqbvWPCHJeOy?p=preview](https://plnkr.co/edit/uau8BlS1cqbvWPCHJeOy?p=preview)

**注意：**这不是每个人的通用解决方案。有几种不同的舍入算法，您的实现可能会有所不同，具体取决于您的要求。[https://en.wikipedia.org/wiki/Rounding](https://en.wikipedia.org/wiki/Rounding)

**解决方案 2**是避免前端计算并从后端服务器拉取舍入值。

**编辑：**另一种可能的解决方案，这也不是防弹的。

```
Math.round((num + Number.EPSILON) * 100) / 100 
```

在某些情况下，当你对 1.3549999999999998 这样的数字进行四舍五入时，它会返回不正确的结果。应该是 1.35，但结果是 1.36。

* * *

## 回答 #3

> 赞同：570
> 
> 时间：2013-08-21T12:56:28.870

您可以使用

```
function roundToTwo(num) {    
    return +(Math.round(num + "e+2")  + "e-2");
} 
```

我在[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)上找到了这个。他们的方式避免了[提到](https://stackoverflow.com/questions/11832914/round-up-to-2-decimal-places-in-javascript#comment24719818_11832950)的 1.005 的问题。

```
roundToTwo(1.005)
1.01
roundToTwo(10)
10
roundToTwo(1.7777777)
1.78
roundToTwo(9.1)
9.1
roundToTwo(1234.5678)
1234.57 
```

* * *

## 回答 #4

> 赞同：185
> 
> 时间：2013-11-01T07:40:59.277

MarkG 的答案是正确的。这是任意小数位数的通用扩展。

```
Number.prototype.round = function(places) {
  return +(Math.round(this + "e+" + places)  + "e-" + places);
} 
```

用法：

```
var n = 1.7777;    
n.round(2); // 1.78 
```

单元测试：

```
it.only('should round floats to 2 places', function() {

  var cases = [
    { n: 10,      e: 10,    p:2 },
    { n: 1.7777,  e: 1.78,  p:2 },
    { n: 1.005,   e: 1.01,  p:2 },
    { n: 1.005,   e: 1,     p:0 },
    { n: 1.77777, e: 1.8,   p:1 }
  ]

  cases.forEach(function(testCase) {
    var r = testCase.n.round(testCase.p);
    assert.equal(r, testCase.e, 'didn\'t get right number');
  });
}) 
```

* * *

## 回答 #5

> 赞同：171
> 
> 时间：2017-01-18T10:19:30.623

你应该使用：

```
Math.round( num * 100 + Number.EPSILON ) / 100 
```

似乎没有人知道[`Number.EPSILON`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON)。

另外值得注意的是，这并不是某些人所说的*JavaScript 怪异。*

**这就是浮点数在计算机中的工作方式。**像 99% 的编程语言一样，JavaScript 没有*自制的*浮点数。它依赖于 CPU/FPU。计算机使用二进制，而在二进制中，没有像 那样的数字`0.1`，而只是二进制的近似值。为什么？出于同样的原因，1/3 不能写成十进制：它的值是 0.33333333... 有无穷多个三。

来了[`Number.EPSILON`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON)。该数字是 1 与双精度浮点数中存在的*下一个数字之间的差。***就是这样：和 1 +****之间没有数字。`1``Number.EPSILON`**

**编辑：**

正如评论中所要求的，让我们澄清一件事：`Number.EPSILON`仅当要舍入的值是算术运算的结果时，加法才是相关的，因为它可以吞下一些浮点误差增量。

当值来自直接来源（例如：文字、用户输入或传感器）时，它没有用。

**编辑（2019）：**

就像@maganap 和一些人指出的那样，最好[`Number.EPSILON`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON)在相乘之前添加：

```
Math.round( ( num + Number.EPSILON ) * 100 ) / 100 
```

**编辑（2019 年 12 月）：**

最近，我使用与此类似的函数来比较数字 epsilon 感知：

```
const ESPILON_RATE = 1 + Number.EPSILON ;
const ESPILON_ZERO = Number.MIN_VALUE ;

function epsilonEquals( a , b ) {
  if ( Number.isNaN( a ) || Number.isNaN( b ) ) {
    return false ;
  }
  if ( a === 0 || b === 0 ) {
    return a <= b + EPSILON_ZERO && b <= a + EPSILON_ZERO ;
  }
  return a <= b * EPSILON_RATE && b <= a * EPSILON_RATE ;
} 
```

我的用例是我开发多年[的断言+数据验证库。](https://www.npmjs.com/package/doormen)

事实上，在我使用的代码中，`ESPILON_RATE = 1 + 4 * Number.EPSILON`and `EPSILON_ZERO = 4 * Number.MIN_VALUE`（四倍 epsilon），因为我想要一个足够松散的相等检查器来累积浮点错误。

到目前为止，它看起来对我来说很完美。我希望它会有所帮助。

* * *

## 回答 #6

> 赞同：111
> 
> 时间：2016-07-30T16:47:16.293

这个问题很复杂。

假设我们有一个函数 ，`roundTo2DP(num)`它接受一个浮点数作为参数并返回一个四舍五入到小数点后 2 位的值。这些表达式中的每一个应该评估为什么？

*   `roundTo2DP(0.014999999999999999)`
*   `roundTo2DP(0.0150000000000000001)`
*   `roundTo2DP(0.015)`

“显而易见”的答案是第一个示例应该舍入到 0.01（因为它比 0.02 更接近 0.01），而其他两个应该舍入到 0.02（因为 0.0150000000000000001 更接近 0.02 而不是 0.01，并且因为 0.015 正好介于两者之间它们，并且有一个数学约定，这些数字会被四舍五入）。

您可能已经猜到的问题是，`roundTo2DP` *不可能*实现给出那些明显的答案，因为传递给它的所有三个数字都是*相同的 number*。IEEE 754 二进制浮点数（JavaScript 使用的那种）不能准确地表示大多数非整数，因此上述所有三个数字文字都会四舍五入为附近的有效浮点数。这个数字，碰巧，*正是*

0.01499999999999999944488848768742172978818416595458984375

比 0.02 更接近 0.01。

您可以在浏览器控制台、Node shell 或其他 JavaScript 解释器中看到所有三个数字都是相同的。只需比较它们：

```
> ***0.014999999999999999 === 0.0150000000000000001***
true
```

所以当我写的时候，我最终`m = 0.0150000000000000001`得到的*确切值`m`*`0.01`比它更接近`0.02`。然而，如果我转换`m`为字符串......

```
> ***var m = 0.0150000000000000001;***
> ***console.log(String(m));***
0.015
> ***var m = 0.014999999999999999;***
> ***console.log(String(m));***
0.015
```

...我得到 0.015，它应该四舍五入到 0.02，这显然*不是*我之前所说的所有这些数字都完全相等的 56 位小数。那么这是什么黑魔法？

答案可以在 ECMAScript 规范的第[*7.1.12.1 节：ToString 应用于 Number 类型*](http://www.ecma-international.org/ecma-262/7.0/#sec-tostring-applied-to-the-number-type)中找到。这里规定了将一些数字*m*转换为字符串的规则。关键部分是第 5 点，其中生成了一个整数*s*，其数字将用于*m*的字符串表示：

> 令*n*、*k*和*s*为整数，使得*k* ≥ 1, 10 ^(*k* -1) ≤ *s* < 10 ^(*k*) *， s* × 10 ^(*n* - *k*)的Number 值为*m*，并且*k*尽可能小。*请注意，k 是s*的十进制表示中的位数，即*s*不能被 10 整除，并且*s*的最低有效位不一定由这些标准唯一确定。

这里的关键部分是“ *k*尽可能小”的要求。该要求相当于要求，给定一个 Number `m`， 的值`String(m)`必须具有*尽可能少的位数*，同时仍满足 的要求`Number(String(m)) === m`。既然我们已经知道了`0.015 === 0.0150000000000000001`，现在很清楚为什么`String(0.0150000000000000001) === '0.015'`一定是真的。

当然，这些讨论都没有直接回答`roundTo2DP(m)` *应该*返回什么。如果`m`' 的确切值是 0.01499999999999999944488848768742172978818416595458984375，但它的字符串表示是 '0.015'，那么当我们将它四舍五入到小数点后两位时，*正确的答案是什么——数学上、实践上、哲学上或其他什么？*

对此没有单一的正确答案。这取决于您的用例。在以下情况下，您可能希望尊重字符串表示并向上取整：

*   所表示的值本质上是离散的，例如以 3 位小数表示的货币数量，如第纳尔。在这种情况下，像 0.015 这样的数字的*真实*值*是*0.015，而 0.0149999999... 以二进制浮点表示的形式是舍入误差。（当然，许多人会合理地争辩说，您应该使用十进制库来处理此类值，并且从一开始就不要将它们表示为二进制浮点数。）
*   该值由用户键入。在这种情况下，再次输入的确切十进制数比最接近的二进制浮点表示更“真实”。

另一方面，当您的值来自固有的连续刻度时，您可能希望尊重二进制浮点值并向下舍入 - 例如，如果它是来自传感器的读数。

这两种方法需要不同的代码。为了尊重数字的字符串表示，我们可以（使用相当微妙的代码）实现我们自己的舍入，该舍入直接作用于字符串表示，逐个数字，使用您在学校时使用的相同算法被教导如何四舍五入。下面是一个示例，它尊重 OP 的要求，即“仅在必要时”通过去除小数点后的尾随零来将数字表示为 2 个小数位；当然，您可能需要根据您的精确需求对其进行调整。

```
/**
 * Converts num to a decimal string (if it isn't one already) and then rounds it
 * to at most dp decimal places.
 *
 * For explanation of why you'd want to perform rounding operations on a String
 * rather than a Number, see http://stackoverflow.com/a/38676273/1709587
 *
 * @param {(number|string)} num
 * @param {number} dp
 * @return {string}
 */
function roundStringNumberWithoutTrailingZeroes (num, dp) {
    if (arguments.length != 2) throw new Error("2 arguments required");

    num = String(num);
    if (num.indexOf('e+') != -1) {
        // Can't round numbers this large because their string representation
        // contains an exponent, like 9.99e+37
        throw new Error("num too large");
    }
    if (num.indexOf('.') == -1) {
        // Nothing to do
        return num;
    }

    var parts = num.split('.'),
        beforePoint = parts[0],
        afterPoint = parts[1],
        shouldRoundUp = afterPoint[dp] >= 5,
        finalNumber;

    afterPoint = afterPoint.slice(0, dp);
    if (!shouldRoundUp) {
        finalNumber = beforePoint + '.' + afterPoint;
    } else if (/^9+$/.test(afterPoint)) {
        // If we need to round up a number like 1.9999, increment the integer
        // before the decimal point and discard the fractional part.
        finalNumber = Number(beforePoint)+1;
    } else {
        // Starting from the last digit, increment digits until we find one
        // that is not 9, then stop
        var i = dp-1;
        while (true) {
            if (afterPoint[i] == '9') {
                afterPoint = afterPoint.substr(0, i) +
                             '0' +
                             afterPoint.substr(i+1);
                i--;
            } else {
                afterPoint = afterPoint.substr(0, i) +
                             (Number(afterPoint[i]) + 1) +
                             afterPoint.substr(i+1);
                break;
            }
        }

        finalNumber = beforePoint + '.' + afterPoint;
    }

    // Remove trailing zeroes from fractional part before returning
    return finalNumber.replace(/0+$/, '')
} 
```

示例用法：

```
> ***roundStringNumberWithoutTrailingZeroes(1.6, 2)***
'1.6'
> ***roundStringNumberWithoutTrailingZeroes(10000, 2)***
'10000'
> ***roundStringNumberWithoutTrailingZeroes(0.015, 2)***
'0.02'
> ***roundStringNumberWithoutTrailingZeroes('0.015000', 2)***
'0.02'
> ***roundStringNumberWithoutTrailingZeroes(1, 1)***
'1'
> ***roundStringNumberWithoutTrailingZeroes('0.015', 2)***
'0.02'
> ***roundStringNumberWithoutTrailingZeroes(0.01499999999999999944488848768742172978818416595458984375, 2)***
'0.02'
> ***roundStringNumberWithoutTrailingZeroes('0.01499999999999999944488848768742172978818416595458984375', 2)***
'0.01'
```

上面的函数*可能*是您想要使用的，以避免用户看到他们输入的数字被错误地四舍五入。

（作为替代方案，您也可以尝试使用[round10](https://github.com/jhohlfeld/round10)库，它提供了类似行为的函数，但实现完全不同。）

但是如果你有第二种数字——一个取自连续刻度的值，没有理由认为小数位数较少的近似十进制表示比那些小数位数多的更*准确？*在这种情况下，我们*不想*尊重 String 表示，因为该表示（如规范中所述）已经是四舍五入的；我们不想犯“0.014999999...375 舍入为 0.015，舍入为 0.02，因此 0.014999999...375 舍入为 0.02”的错误。

这里我们可以简单地使用内置[`toFixed`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed)方法。请注意，通过调用`Number()`返回的字符串`toFixed`，我们得到一个数字，其字符串表示没有尾随零（感谢 JavaScript 计算数字的字符串表示的方式，在本答案前面讨论过）。

```
/**
 * Takes a float and rounds it to at most dp decimal places. For example
 *
 *     roundFloatNumberWithoutTrailingZeroes(1.2345, 3)
 *
 * returns 1.234
 *
 * Note that since this treats the value passed to it as a floating point
 * number, it will have counterintuitive results in some cases. For instance,
 * 
 *     roundFloatNumberWithoutTrailingZeroes(0.015, 2)
 *
 * gives 0.01 where 0.02 might be expected. For an explanation of why, see
 * http://stackoverflow.com/a/38676273/1709587\. You may want to consider using the
 * roundStringNumberWithoutTrailingZeroes function there instead.
 *
 * @param {number} num
 * @param {number} dp
 * @return {number}
 */
function roundFloatNumberWithoutTrailingZeroes (num, dp) {
    var numToFixedDp = Number(num).toFixed(dp);
    return Number(numToFixedDp);
} 
```

* * *

## 回答 #7

> 赞同：108
> 
> 时间：2018-02-13T10:23:22.130

通常，小数舍入是通过缩放完成的：`round(num * p) / p`

**幼稚的实现**

使用以下带有中间数字的函数，您将获得预期的上舍入值，或者有时取决于输入的下舍入值。

这种`inconsistency`舍入可能会在客户端代码中引入难以检测的错误。

```
function naiveRound(num, decimalPlaces = 0) {
    var p = Math.pow(10, decimalPlaces);
    return Math.round(num * p) / p;
}

console.log( naiveRound(1.245, 2) );  // 1.25 correct (rounded as expected)
console.log( naiveRound(1.255, 2) );  // 1.25 incorrect (should be 1.26)

// testing edge cases
console.log( naiveRound(1.005, 2) );  // 1    incorrect (should be 1.01)
console.log( naiveRound(2.175, 2) );  // 2.17 incorrect (should be 2.18)
console.log( naiveRound(5.015, 2) );  // 5.01 incorrect (should be 5.02)
```

为了判断舍入操作是否涉及中点值，Round 函数将要舍入的原始值乘以 10 ** n，其中 n 是返回值中所需的小数位数，然后判断剩余的小数是否值的一部分大于或等于 0.5。由于`"Exact Testing for Equality"`浮点格式在二进制表示和精度方面存在问题，因此浮点值存在问题。这意味着任何略小于 0.5 的小数部分（由于精度损失）都不会向上舍入。

在前面的例子中，`5.015`如果要四舍五入到小数点后两位，则 5.015 * 100 的值实际上是`501.49999999999994`. 因为 .49999999999994 小于 0.5，所以向下舍入为 501，最终结果为 5.01。

**更好的实现**

**指数符号**

通过将数字转换为指数符号中的字符串，正数按预期四舍五入。但是，请注意负数与正数的舍入方式不同。

事实上，它执行的规则基本上相当于[“四舍五入”](http://en.wikipedia.org/wiki/Rounding#Round_half_up)，您会看到即使`round(-1.005, 2)`评估为 ，也会评估为。lodash [_.round](https://lodash.com/docs/4.17.15#round)方法使用了这种技术。`-1``round(1.005, 2)``1.01`

```
/**
 * Round half up ('round half towards positive infinity')
 * Negative numbers round differently than positive numbers.
 */
function round(num, decimalPlaces = 0) {
    num = Math.round(num + "e" + decimalPlaces);
    return Number(num + "e" + -decimalPlaces);
}

// test rounding of half
console.log( round(0.5) );  // 1
console.log( round(-0.5) ); // 0

// testing edge cases
console.log( round(1.005, 2) );   // 1.01
console.log( round(2.175, 2) );   // 2.18
console.log( round(5.015, 2) );   // 5.02

console.log( round(-1.005, 2) );  // -1
console.log( round(-2.175, 2) );  // -2.17
console.log( round(-5.015, 2) );  // -5.01
```

如果在舍入负数时想要通常的行为，则需要在调用[Math.round()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)之前将负数转换为正数，然后在返回之前将它们转换回负数。

```
// Round half away from zero
function round(num, decimalPlaces = 0) {
    if (num < 0)
        return -round(-num, decimalPlaces);

    num = Math.round(num + "e" + decimalPlaces);
    return Number(num + "e" + -decimalPlaces);
} 
```

**近似舍入**

为了纠正前面`naiveRound`示例中显示的舍入问题，我们可以定义一个自定义舍入函数，该函数执行“几乎相等”测试以确定小数值是否足够接近中点值以进行中点舍入。

```
// round half away from zero
function round(num, decimalPlaces = 0) {
    if (num < 0)
        return -round(-num, decimalPlaces);
    var p = Math.pow(10, decimalPlaces);
    var n = num * p;
    var f = n - Math.floor(n);
    var e = Number.EPSILON * n;

    // Determine whether this fraction is a midpoint value.
    return (f >= .5 - e) ? Math.ceil(n) / p : Math.floor(n) / p;
}

// test rounding of half
console.log( round(0.5) );  // 1
console.log( round(-0.5) ); // -1

// testing edge cases
console.log( round(1.005, 2) );  // 1.01
console.log( round(2.175, 2) );  // 2.18
console.log( round(5.015, 2) );  // 5.02

console.log( round(-1.005, 2) ); // -1.01
console.log( round(-2.175, 2) ); // -2.18
console.log( round(-5.015, 2) ); // -5.02
```

**编号.EPSILON**

有一种不同的纯数学技术来执行舍入到最近（使用[“离零的一半”](http://en.wikipedia.org/wiki/Rounding#Round_half_away_from_zero)），其中在调用舍入函数之前应用 epsilon 校正。

简单地说，我们在舍入之前将最小可能的浮点值（= 1.0 ulp；最后一个单位）添加到产品中。这将移动到下一个可表示的浮点值，远离零，因此它将抵消乘法期间可能发生的二进制[舍入误差](https://en.wikipedia.org/wiki/Round-off_error)`10 ** n`。

```
/**
 * Round half away from zero ('commercial' rounding)
 * Uses correction to offset floating-point inaccuracies.
 * Works symmetrically for positive and negative numbers.
 */
function round(num, decimalPlaces = 0) {
    var p = Math.pow(10, decimalPlaces);
    var n = (num * p) * (1 + Number.EPSILON);
    return Math.round(n) / p;
}

// rounding of half
console.log( round(0.5) );  // 1
console.log( round(-0.5) ); // -1

// testing edge cases
console.log( round(1.005, 2) );  // 1.01
console.log( round(2.175, 2) );  // 2.18
console.log( round(5.015, 2) );  // 5.02

console.log( round(-1.005, 2) ); // -1.01
console.log( round(-2.175, 2) ); // -2.18
console.log( round(-5.015, 2) ); // -5.02
```

添加 1 ulp 后，5.015 * 100 的值`501.49999999999994`将被修正为`501.50000000000006`，这将四舍五入为 502，最终结果为 5.02。

请注意，[最后一个单元](https://en.wikipedia.org/wiki/Unit_in_the_last_place)的大小（“ulp”）由（1）数字的大小和（2）相对机器 epsilon（2^-52）决定。Ulp 在具有较大量级的数字上比在具有较小量级的数字上相对较大。

**双舍入**

在这里，我们使用[toPrecision()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Number/toPrecision)方法去除中间计算中的浮点舍入误差。简单地说，我们四舍五入到 15位[有效数字](https://en.wikipedia.org/wiki/Significant_figures)以去除第 16 位有效数字的舍入误差。**PHP 7** [舍](https://github.com/php/php-src/blob/PHP-7.4.10/ext/standard/math.c#L127-L206)入函数也使用了这种将结果预舍入为有效数字的技术。

5.015 * 100 的值`501.49999999999994`将首先四舍五入为 15 位有效数字`501.500000000000`，然后再次四舍五入为 502，最终结果为 5.02。

```
// Round half away from zero
function round(num, decimalPlaces = 0) {
    if (num < 0)
        return -round(-num, decimalPlaces);
    var p = Math.pow(10, decimalPlaces);
    var n = (num * p).toPrecision(15);
    return Math.round(n) / p;
}

// rounding of half
console.log( round(0.5) );  // 1
console.log( round(-0.5) ); // -1

// testing edge cases
console.log( round(1.005, 2) );  // 1.01
console.log( round(2.175, 2) );  // 2.18
console.log( round(5.015, 2) );  // 5.02

console.log( round(-1.005, 2) ); // -1.01
console.log( round(-2.175, 2) ); // -2.18
console.log( round(-5.015, 2) ); // -5.02
```

**任意精度的 JavaScript 库**- [decimal.js](https://mikemcl.github.io/decimal.js/)

```
// Round half away from zero
function round(num, decimalPlaces = 0) {
    return new Decimal(num).toDecimalPlaces(decimalPlaces).toNumber();
}

// rounding of half
console.log( round(0.5) );  // 1
console.log( round(-0.5) ); // -1

// testing edge cases
console.log( round(1.005, 2) );  // 1.01
console.log( round(2.175, 2) );  // 2.18
console.log( round(5.015, 2) );  // 5.02

console.log( round(-1.005, 2) ); // -1.01
console.log( round(-2.175, 2) ); // -2.18
console.log( round(-5.015, 2) ); // -5.02
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/10.2.1/decimal.js" integrity="sha512-GKse2KVGCCMVBn4riigHjXE8j5hCxYLPXDw8AvcjUtrt+a9TbZFtIKGdArXwYOlZvdmkhQLWQ46ZE3Q1RIa7uQ==" crossorigin="anonymous"></script>
```

**解决方案 1：指数符号的字符串**

受 KFish 提供的解决方案的启发：[https ://stackoverflow.com/a/55521592/4208440](https://stackoverflow.com/a/55521592/4208440)

一个简单的解决方案，提供精确的小数四舍五入、地板和天花板到特定的小数位数，而无需添加整个库。它通过修复二进制舍入问题来将浮点数更像小数处理以避免意外结果：例如， floor((0.1+0.7)*10) 将返回预期结果 8。

数字四舍五入到特定数量的小数位数。指定负精度将四舍五入到小数点左侧的任意位数。

```
// Solution 1
var DecimalPrecision = (function() {
    if (Math.trunc === undefined) {
        Math.trunc = function(v) {
            return v < 0 ? Math.ceil(v) : Math.floor(v);
        };
    }
    var decimalAdjust = function myself(type, num, decimalPlaces) {
        if (type === 'round' && num < 0)
            return -myself(type, -num, decimalPlaces);
        var shift = function(value, exponent) {
            value = (value + 'e').split('e');
            return +(value[0] + 'e' + (+value[1] + (exponent || 0)));
        };
        var n = shift(num, +decimalPlaces);
        return shift(Math[type](n), -decimalPlaces);
    };
    return {
        // Decimal round (half away from zero)
        round: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces);
        },
        // Decimal ceil
        ceil: function(num, decimalPlaces) {
            return decimalAdjust('ceil', num, decimalPlaces);
        },
        // Decimal floor
        floor: function(num, decimalPlaces) {
            return decimalAdjust('floor', num, decimalPlaces);
        },
        // Decimal trunc
        trunc: function(num, decimalPlaces) {
            return decimalAdjust('trunc', num, decimalPlaces);
        },
        // Format using fixed-point notation
        toFixed: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces).toFixed(decimalPlaces);
        }
    };
})();

// test rounding of half
console.log(DecimalPrecision.round(0.5));  // 1
console.log(DecimalPrecision.round(-0.5)); // -1

// testing very small numbers
console.log(DecimalPrecision.ceil(1e-8, 2) === 0.01);
console.log(DecimalPrecision.floor(1e-8, 2) === 0);

// testing simple cases
console.log(DecimalPrecision.round(5.12, 1) === 5.1);
console.log(DecimalPrecision.round(-5.12, 1) === -5.1);
console.log(DecimalPrecision.ceil(5.12, 1) === 5.2);
console.log(DecimalPrecision.ceil(-5.12, 1) === -5.1);
console.log(DecimalPrecision.floor(5.12, 1) === 5.1);
console.log(DecimalPrecision.floor(-5.12, 1) === -5.2);
console.log(DecimalPrecision.trunc(5.12, 1) === 5.1);
console.log(DecimalPrecision.trunc(-5.12, 1) === -5.1);

// testing edge cases for round
console.log(DecimalPrecision.round(1.005, 2) === 1.01);
console.log(DecimalPrecision.round(39.425, 2) === 39.43);
console.log(DecimalPrecision.round(-1.005, 2) === -1.01);
console.log(DecimalPrecision.round(-39.425, 2) === -39.43);

// testing edge cases for ceil
console.log(DecimalPrecision.ceil(9.13, 2) === 9.13);
console.log(DecimalPrecision.ceil(65.18, 2) === 65.18);
console.log(DecimalPrecision.ceil(-2.26, 2) === -2.26);
console.log(DecimalPrecision.ceil(-18.15, 2) === -18.15);

// testing edge cases for floor
console.log(DecimalPrecision.floor(2.26, 2) === 2.26);
console.log(DecimalPrecision.floor(18.15, 2) === 18.15);
console.log(DecimalPrecision.floor(-9.13, 2) === -9.13);
console.log(DecimalPrecision.floor(-65.18, 2) === -65.18);

// testing edge cases for trunc
console.log(DecimalPrecision.trunc(2.26, 2) === 2.26);
console.log(DecimalPrecision.trunc(18.15, 2) === 18.15);
console.log(DecimalPrecision.trunc(-2.26, 2) === -2.26);
console.log(DecimalPrecision.trunc(-18.15, 2) === -18.15);

// testing round to tens and hundreds
console.log(DecimalPrecision.round(1262.48, -1) === 1260);
console.log(DecimalPrecision.round(1262.48, -2) === 1300);

// testing toFixed()
console.log(DecimalPrecision.toFixed(1.005, 2) === "1.01");
```

**解决方案2：纯数学（Number.EPSILON）**

出于性能原因，此解决方案避免了任何类型的字符串转换/操作。

```
// Solution 2
var DecimalPrecision2 = (function() {
    if (Number.EPSILON === undefined) {
        Number.EPSILON = Math.pow(2, -52);
    }
    if (Math.trunc === undefined) {
        Math.trunc = function(v) {
            return v < 0 ? Math.ceil(v) : Math.floor(v);
        };
    }
    var powers = [
        1e0,  1e1,  1e2,  1e3,  1e4,  1e5,  1e6,  1e7,
        1e8,  1e9,  1e10, 1e11, 1e12, 1e13, 1e14, 1e15,
        1e16, 1e17, 1e18, 1e19, 1e20, 1e21, 1e22
    ];
    var intpow10 = function(power) {
        if (power < 0 || power > 22) {
            return Math.pow(10, power);
        }
        return powers[power];
    };
    var isRound = function(num, decimalPlaces) {
        //return decimalPlaces >= 0 &&
        //    +num.toFixed(decimalPlaces) === num;
        var p = intpow10(decimalPlaces);
        return Math.round(num * p) / p === num;
    };
    var decimalAdjust = function(type, num, decimalPlaces) {
        if (type !== 'round' && isRound(num, decimalPlaces || 0))
            return num;
        var p = intpow10(decimalPlaces || 0);
        var n = (num * p) * (1 + Number.EPSILON);
        return Math[type](n) / p;
    };
    return {
        // Decimal round (half away from zero)
        round: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces);
        },
        // Decimal ceil
        ceil: function(num, decimalPlaces) {
            return decimalAdjust('ceil', num, decimalPlaces);
        },
        // Decimal floor
        floor: function(num, decimalPlaces) {
            return decimalAdjust('floor', num, decimalPlaces);
        },
        // Decimal trunc
        trunc: function(num, decimalPlaces) {
            return decimalAdjust('trunc', num, decimalPlaces);
        },
        // Format using fixed-point notation
        toFixed: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces).toFixed(decimalPlaces);
        }
    };
})();

// test rounding of half
console.log(DecimalPrecision2.round(0.5));  // 1
console.log(DecimalPrecision2.round(-0.5)); // -1

// testing very small numbers
console.log(DecimalPrecision2.ceil(1e-8, 2) === 0.01);
console.log(DecimalPrecision2.floor(1e-8, 2) === 0);

// testing simple cases
console.log(DecimalPrecision2.round(5.12, 1) === 5.1);
console.log(DecimalPrecision2.round(-5.12, 1) === -5.1);
console.log(DecimalPrecision2.ceil(5.12, 1) === 5.2);
console.log(DecimalPrecision2.ceil(-5.12, 1) === -5.1);
console.log(DecimalPrecision2.floor(5.12, 1) === 5.1);
console.log(DecimalPrecision2.floor(-5.12, 1) === -5.2);
console.log(DecimalPrecision2.trunc(5.12, 1) === 5.1);
console.log(DecimalPrecision2.trunc(-5.12, 1) === -5.1);

// testing edge cases for round
console.log(DecimalPrecision2.round(1.005, 2) === 1.01);
console.log(DecimalPrecision2.round(39.425, 2) === 39.43);
console.log(DecimalPrecision2.round(-1.005, 2) === -1.01);
console.log(DecimalPrecision2.round(-39.425, 2) === -39.43);

// testing edge cases for ceil
console.log(DecimalPrecision2.ceil(9.13, 2) === 9.13);
console.log(DecimalPrecision2.ceil(65.18, 2) === 65.18);
console.log(DecimalPrecision2.ceil(-2.26, 2) === -2.26);
console.log(DecimalPrecision2.ceil(-18.15, 2) === -18.15);

// testing edge cases for floor
console.log(DecimalPrecision2.floor(2.26, 2) === 2.26);
console.log(DecimalPrecision2.floor(18.15, 2) === 18.15);
console.log(DecimalPrecision2.floor(-9.13, 2) === -9.13);
console.log(DecimalPrecision2.floor(-65.18, 2) === -65.18);

// testing edge cases for trunc
console.log(DecimalPrecision2.trunc(2.26, 2) === 2.26);
console.log(DecimalPrecision2.trunc(18.15, 2) === 18.15);
console.log(DecimalPrecision2.trunc(-2.26, 2) === -2.26);
console.log(DecimalPrecision2.trunc(-18.15, 2) === -18.15);

// testing round to tens and hundreds
console.log(DecimalPrecision2.round(1262.48, -1) === 1260);
console.log(DecimalPrecision2.round(1262.48, -2) === 1300);

// testing toFixed()
console.log(DecimalPrecision2.toFixed(1.005, 2) === "1.01");
```

**解决方案3：双舍入**

此解决方案使用[toPrecision()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Number/toPrecision)方法去除浮点舍入误差。

```
// Solution 3
var DecimalPrecision3 = (function() {
    if (Math.trunc === undefined) {
        Math.trunc = function(v) {
            return v < 0 ? Math.ceil(v) : Math.floor(v);
        };
    }
    var powers = [
        1e0,  1e1,  1e2,  1e3,  1e4,  1e5,  1e6,  1e7,
        1e8,  1e9,  1e10, 1e11, 1e12, 1e13, 1e14, 1e15,
        1e16, 1e17, 1e18, 1e19, 1e20, 1e21, 1e22
    ];
    var intpow10 = function(power) {
        if (power < 0 || power > 22) {
            return Math.pow(10, power);
        }
        return powers[power];
    };
    // Eliminate binary floating-point inaccuracies.
    var stripError = function(num) {
        if (Number.isInteger(num))
            return num;
        return parseFloat(num.toPrecision(15));
    };
    var decimalAdjust = function myself(type, num, decimalPlaces) {
        if (type === 'round' && num < 0)
            return -myself(type, -num, decimalPlaces);
        var p = intpow10(decimalPlaces || 0);
        var n = stripError(num * p);
        return Math[type](n) / p;
    };
    return {
        // Decimal round (half away from zero)
        round: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces);
        },
        // Decimal ceil
        ceil: function(num, decimalPlaces) {
            return decimalAdjust('ceil', num, decimalPlaces);
        },
        // Decimal floor
        floor: function(num, decimalPlaces) {
            return decimalAdjust('floor', num, decimalPlaces);
        },
        // Decimal trunc
        trunc: function(num, decimalPlaces) {
            return decimalAdjust('trunc', num, decimalPlaces);
        },
        // Format using fixed-point notation
        toFixed: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces).toFixed(decimalPlaces);
        }
    };
})();

// test rounding of half
console.log(DecimalPrecision3.round(0.5));  // 1
console.log(DecimalPrecision3.round(-0.5)); // -1

// testing very small numbers
console.log(DecimalPrecision3.ceil(1e-8, 2) === 0.01);
console.log(DecimalPrecision3.floor(1e-8, 2) === 0);

// testing simple cases
console.log(DecimalPrecision3.round(5.12, 1) === 5.1);
console.log(DecimalPrecision3.round(-5.12, 1) === -5.1);
console.log(DecimalPrecision3.ceil(5.12, 1) === 5.2);
console.log(DecimalPrecision3.ceil(-5.12, 1) === -5.1);
console.log(DecimalPrecision3.floor(5.12, 1) === 5.1);
console.log(DecimalPrecision3.floor(-5.12, 1) === -5.2);
console.log(DecimalPrecision3.trunc(5.12, 1) === 5.1);
console.log(DecimalPrecision3.trunc(-5.12, 1) === -5.1);

// testing edge cases for round
console.log(DecimalPrecision3.round(1.005, 2) === 1.01);
console.log(DecimalPrecision3.round(39.425, 2) === 39.43);
console.log(DecimalPrecision3.round(-1.005, 2) === -1.01);
console.log(DecimalPrecision3.round(-39.425, 2) === -39.43);

// testing edge cases for ceil
console.log(DecimalPrecision3.ceil(9.13, 2) === 9.13);
console.log(DecimalPrecision3.ceil(65.18, 2) === 65.18);
console.log(DecimalPrecision3.ceil(-2.26, 2) === -2.26);
console.log(DecimalPrecision3.ceil(-18.15, 2) === -18.15);

// testing edge cases for floor
console.log(DecimalPrecision3.floor(2.26, 2) === 2.26);
console.log(DecimalPrecision3.floor(18.15, 2) === 18.15);
console.log(DecimalPrecision3.floor(-9.13, 2) === -9.13);
console.log(DecimalPrecision3.floor(-65.18, 2) === -65.18);

// testing edge cases for trunc
console.log(DecimalPrecision3.trunc(2.26, 2) === 2.26);
console.log(DecimalPrecision3.trunc(18.15, 2) === 18.15);
console.log(DecimalPrecision3.trunc(-2.26, 2) === -2.26);
console.log(DecimalPrecision3.trunc(-18.15, 2) === -18.15);

// testing round to tens and hundreds
console.log(DecimalPrecision3.round(1262.48, -1) === 1260);
console.log(DecimalPrecision3.round(1262.48, -2) === 1300);

// testing toFixed()
console.log(DecimalPrecision3.toFixed(1.005, 2) === "1.01");
```

**解决方案 4：双舍入 v2**

此解决方案与解决方案 3 类似，但它使用自定义`toPrecision()`函数。

```
// Solution 4
var DecimalPrecision4 = (function() {
    if (Math.trunc === undefined) {
        Math.trunc = function(v) {
            return v < 0 ? Math.ceil(v) : Math.floor(v);
        };
    }
    var powers = [
        1e0,  1e1,  1e2,  1e3,  1e4,  1e5,  1e6,  1e7,
        1e8,  1e9,  1e10, 1e11, 1e12, 1e13, 1e14, 1e15,
        1e16, 1e17, 1e18, 1e19, 1e20, 1e21, 1e22
    ];
    var intpow10 = function(power) {
        if (power < 0 || power > 22) {
            return Math.pow(10, power);
        }
        return powers[power];
    };
    var toPrecision = function(num, significantDigits) {
        // Return early for ±0, NaN and Infinity.
        if (!num || !Number.isFinite(num))
            return num;
        // Compute shift of the decimal point (sf - leftSidedDigits).
        var shift = significantDigits - 1 - Math.floor(Math.log10(Math.abs(num)));
        // Return if rounding to the same or higher precision.
        var decimalPlaces = 0;
        for (var p = 1; num != Math.round(num * p) / p; p *= 10) decimalPlaces++;
        if (shift >= decimalPlaces)
            return num;
        // Round to "shift" fractional digits
        var scale = intpow10(Math.abs(shift));
        return shift > 0 ?
            Math.round(num * scale) / scale :
            Math.round(num / scale) * scale;
    };
    // Eliminate binary floating-point inaccuracies.
    var stripError = function(num) {
        if (Number.isInteger(num))
            return num;
        return toPrecision(num, 15);
    };
    var decimalAdjust = function myself(type, num, decimalPlaces) {
        if (type === 'round' && num < 0)
            return -myself(type, -num, decimalPlaces);
        var p = intpow10(decimalPlaces || 0);
        var n = stripError(num * p);
        return Math[type](n) / p;
    };
    return {
        // Decimal round (half away from zero)
        round: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces);
        },
        // Decimal ceil
        ceil: function(num, decimalPlaces) {
            return decimalAdjust('ceil', num, decimalPlaces);
        },
        // Decimal floor
        floor: function(num, decimalPlaces) {
            return decimalAdjust('floor', num, decimalPlaces);
        },
        // Decimal trunc
        trunc: function(num, decimalPlaces) {
            return decimalAdjust('trunc', num, decimalPlaces);
        },
        // Format using fixed-point notation
        toFixed: function(num, decimalPlaces) {
            return decimalAdjust('round', num, decimalPlaces).toFixed(decimalPlaces);
        }
    };
})();

// test rounding of half
console.log(DecimalPrecision4.round(0.5));  // 1
console.log(DecimalPrecision4.round(-0.5)); // -1

// testing very small numbers
console.log(DecimalPrecision4.ceil(1e-8, 2) === 0.01);
console.log(DecimalPrecision4.floor(1e-8, 2) === 0);

// testing simple cases
console.log(DecimalPrecision4.round(5.12, 1) === 5.1);
console.log(DecimalPrecision4.round(-5.12, 1) === -5.1);
console.log(DecimalPrecision4.ceil(5.12, 1) === 5.2);
console.log(DecimalPrecision4.ceil(-5.12, 1) === -5.1);
console.log(DecimalPrecision4.floor(5.12, 1) === 5.1);
console.log(DecimalPrecision4.floor(-5.12, 1) === -5.2);
console.log(DecimalPrecision4.trunc(5.12, 1) === 5.1);
console.log(DecimalPrecision4.trunc(-5.12, 1) === -5.1);

// testing edge cases for round
console.log(DecimalPrecision4.round(1.005, 2) === 1.01);
console.log(DecimalPrecision4.round(39.425, 2) === 39.43);
console.log(DecimalPrecision4.round(-1.005, 2) === -1.01);
console.log(DecimalPrecision4.round(-39.425, 2) === -39.43);

// testing edge cases for ceil
console.log(DecimalPrecision4.ceil(9.13, 2) === 9.13);
console.log(DecimalPrecision4.ceil(65.18, 2) === 65.18);
console.log(DecimalPrecision4.ceil(-2.26, 2) === -2.26);
console.log(DecimalPrecision4.ceil(-18.15, 2) === -18.15);

// testing edge cases for floor
console.log(DecimalPrecision4.floor(2.26, 2) === 2.26);
console.log(DecimalPrecision4.floor(18.15, 2) === 18.15);
console.log(DecimalPrecision4.floor(-9.13, 2) === -9.13);
console.log(DecimalPrecision4.floor(-65.18, 2) === -65.18);

// testing edge cases for trunc
console.log(DecimalPrecision4.trunc(2.26, 2) === 2.26);
console.log(DecimalPrecision4.trunc(18.15, 2) === 18.15);
console.log(DecimalPrecision4.trunc(-2.26, 2) === -2.26);
console.log(DecimalPrecision4.trunc(-18.15, 2) === -18.15);

// testing round to tens and hundreds
console.log(DecimalPrecision4.round(1262.48, -1) === 1260);
console.log(DecimalPrecision4.round(1262.48, -2) === 1300);

// testing toFixed()
console.log(DecimalPrecision4.toFixed(1.005, 2) === "1.01");
```

## 基准

[http://jsbench.github.io/#31ec3a8b3d22bd840f8e6822e681a3ac](http://jsbench.github.io/#31ec3a8b3d22bd840f8e6822e681a3ac)

这是比较 Chrome 85.0.4183.83 上上述解决方案中每秒操作数的基准。显然，所有浏览器都不同，因此您的里程可能会有所不同。

[![基准比较](../Images/a553edc5f6fd0ce077d3d23b4baa7408.png)](https://i.stack.imgur.com/llFZn.png) （注：越多越好）

感谢@Mike 添加基准的屏幕截图。

* * *

## 回答 #8

> 赞同：97
> 
> 时间：2012-08-06T17:21:23.260

考虑`.toFixed()`和`.toPrecision()`：

[http://www.javascriptkit.com/javatutors/formatnumber.shtml](http://www.javascriptkit.com/javatutors/formatnumber.shtml)

* * *

## 回答 #9

> 赞同：89
> 
> 时间：2014-10-21T17:02:21.313

一个可以使用`.toFixed(NumberOfDecimalPlaces)`。

```
var str = 10.234.toFixed(2); // => '10.23'
var number = Number(str); // => 10.23 
```

* * *

## 回答 #10

> 赞同：65
> 
> 时间：2013-06-13T09:35:39.070

**在这里找到的答案都不正确**。@stinkycheeseman 要求**四舍五入**，你们都四舍五入了。

要四舍五入，请使用：

```
Math.ceil(num * 100)/100; 
```

* * *

## 回答 #11

> 赞同：64
> 
> 时间：2014-08-01T08:02:16.467

一种精确的舍入方法。资料来源：[Mozilla](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)

```
(function(){

    /**
     * Decimal adjustment of a number.
     *
     * @param   {String}    type    The type of adjustment.
     * @param   {Number}    value   The number.
     * @param   {Integer}   exp     The exponent (the 10 logarithm of the adjustment base).
     * @returns {Number}            The adjusted value.
     */
    function decimalAdjust(type, value, exp) {
        // If the exp is undefined or zero...
        if (typeof exp === 'undefined' || +exp === 0) {
            return Math[type](value);
        }
        value = +value;
        exp = +exp;
        // If the value is not a number or the exp is not an integer...
        if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {
            return NaN;
        }
        // Shift
        value = value.toString().split('e');
        value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));
        // Shift back
        value = value.toString().split('e');
        return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));
    }

    // Decimal round
    if (!Math.round10) {
        Math.round10 = function(value, exp) {
            return decimalAdjust('round', value, exp);
        };
    }
    // Decimal floor
    if (!Math.floor10) {
        Math.floor10 = function(value, exp) {
            return decimalAdjust('floor', value, exp);
        };
    }
    // Decimal ceil
    if (!Math.ceil10) {
        Math.ceil10 = function(value, exp) {
            return decimalAdjust('ceil', value, exp);
        };
    }
})(); 
```

例子：

```
// Round
Math.round10(55.55, -1); // 55.6
Math.round10(55.549, -1); // 55.5
Math.round10(55, 1); // 60
Math.round10(54.9, 1); // 50
Math.round10(-55.55, -1); // -55.5
Math.round10(-55.551, -1); // -55.6
Math.round10(-55, 1); // -50
Math.round10(-55.1, 1); // -60
Math.round10(1.005, -2); // 1.01 -- compare this with Math.round(1.005*100)/100 above
// Floor
Math.floor10(55.59, -1); // 55.5
Math.floor10(59, 1); // 50
Math.floor10(-55.51, -1); // -55.6
Math.floor10(-51, 1); // -60
// Ceil
Math.ceil10(55.51, -1); // 55.6
Math.ceil10(51, 1); // 60
Math.ceil10(-55.59, -1); // -55.5
Math.ceil10(-59, 1); // -50 
```

* * *

## 回答 #12

> 赞同：62
> 
> 时间：2012-08-06T17:27:02.007

这是一个简单的方法：

```
Math.round(value * 100) / 100 
```

不过，您可能希望继续创建一个单独的函数来为您执行此操作：

```
function roundToTwo(value) {
    return(Math.round(value * 100) / 100);
} 
```

然后，您只需传入该值。

您可以通过添加第二个参数来增强它以四舍五入到任意小数位数。

```
function myRound(value, places) {
    var multiplier = Math.pow(10, places);

    return (Math.round(value * multiplier) / multiplier);
} 
```

* * *

## 回答 #13

> 赞同：36
> 
> 时间：2012-08-06T17:21:19.177

这可能会帮助您：

```
var result = Math.round(input*100)/100; 
```

有关更多信息，您可以查看此链接

[Math.round(num) vs num.toFixed(0) 和浏览器不一致](https://stackoverflow.com/questions/566564/javascript-functions-math-roundnum-vs-num-tofixed0-and-browser-inconsistenci)

* * *

## 回答 #14

> 赞同：36
> 
> 时间：2014-06-25T10:27:07.933

```
+(10).toFixed(2); // = 10
+(10.12345).toFixed(2); // = 10.12

(10).toFixed(2); // = 10.00
(10.12345).toFixed(2); // = 10.12 
```

* * *

## 回答 #15

> 赞同：36
> 
> 时间：2014-10-08T10:51:14.573

使用此功能`Number(x).toFixed(2);`

* * *

## 回答 #16

> 赞同：36
> 
> 时间：2018-04-27T06:32:32.583

对我来说[Math.round()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)没有给出正确的答案。我发现[toFixed(2)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed)效果更好。以下是两者的示例：

```
console.log(Math.round(43000 / 80000) * 100); // wrong answer

console.log(((43000 / 80000) * 100).toFixed(2)); // correct answer
```

* * *

## 回答 #17

> 赞同：34
> 
> 时间：2014-10-20T10:21:12.397

试试这个**轻量级的**解决方案：

```
function round(x, digits){
  return parseFloat(x.toFixed(digits))
}

 round(1.222,  2) ;
 // 1.22
 round(1.222, 10) ;
 // 1.222 
```

* * *

## 回答 #18

> 赞同：31
> 
> 时间：2016-03-01T05:36:08.913

有几种方法可以做到这一点。对于像我这样的人，Lodash 的变种

```
function round(number, precision) {
    var pair = (number + 'e').split('e')
    var value = Math.round(pair[0] + 'e' + (+pair[1] + precision))
    pair = (value + 'e').split('e')
    return +(pair[0] + 'e' + (+pair[1] - precision))
} 
```

**用法：**

```
round(0.015, 2) // 0.02
round(1.005, 2) // 1.01 
```

如果您的项目使用 jQuery 或 lodash，您还可以`round`在库中找到合适的方法。

## 更新 1

我删除了 variant `n.toFixed(2)`，因为它不正确。谢谢@avalanche1

* * *

## 回答 #19

> 赞同：31
> 
> 时间：2017-11-01T16:10:25.003

2017
只使用原生代码`.toFixed()`

```
number = 1.2345;
number.toFixed(2) // "1.23" 
```

如果您需要严格并在需要时添加数字，则可以使用`replace`

```
number = 1; // "1"
number.toFixed(5).replace(/\.?0*$/g,''); 
```

* * *

## 回答 #20

> 赞同：30
> 
> 时间：2017-07-28T06:59:19.573

如果您使用的是 lodash 库，您可以使用 lodash 的 round 方法，如下所示。

```
_.round(number, precision) 
```

例如：

```
_.round(1.7777777, 2) = 1.78 
```

* * *

## 回答 #21

> 赞同：27
> 
> 时间：2018-02-06T04:34:00.013

由于 ES6 有一种“正确”的方式（不覆盖静态和创建变通方法）通过[使用 toPrecision来做到这一点](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Number/toPrecision)

```
var x = 1.49999999999;
console.log(x.toPrecision(4));
console.log(x.toPrecision(3));
console.log(x.toPrecision(2));

var y = Math.PI;
console.log(y.toPrecision(6));
console.log(y.toPrecision(5));
console.log(y.toPrecision(4));

var z = 222.987654
console.log(z.toPrecision(6));
console.log(z.toPrecision(5));
console.log(z.toPrecision(4));
```

那么你就可以了`parseFloat`，零会“消失”。

```
console.log(parseFloat((1.4999).toPrecision(3)));
console.log(parseFloat((1.005).toPrecision(3)));
console.log(parseFloat((1.0051).toPrecision(3)));
```

不过，它并不能解决“1.005 舍入问题”——因为它是[处理浮点分数的固有方法](https://softwareengineering.stackexchange.com/questions/101163/what-causes-floating-point-rounding-errors)。

```
console.log(1.005 - 0.005);
```

如果你对图书馆开放，你可以使用[bignumber.js](https://github.com/MikeMcl/bignumber.js/)

```
console.log(1.005 - 0.005);
console.log(new BigNumber(1.005).minus(0.005));

console.log(new BigNumber(1.005).round(4));
console.log(new BigNumber(1.005).round(3));
console.log(new BigNumber(1.005).round(2));
console.log(new BigNumber(1.005).round(1));
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/2.3.0/bignumber.min.js"></script>
```

* * *

## 回答 #22

> 赞同：25
> 
> 时间：2020-03-19T08:09:01.170

最简单的方法是使用 toFixed，然后使用 Number 函数去除尾随零：

```
const number = 15.5;
Number(number.toFixed(2)); // 15.5 
```

```
const number = 1.7777777;
Number(number.toFixed(2)); // 1.78 
```

* * *

## 回答 #23

> 赞同：24
> 
> 时间：2014-01-24T02:48:33.730

MarkG 和 Lavamantis 提供了一个比已被接受的解决方案更好的解决方案。可惜他们没有得到更多的支持！

这是我用来解决浮点小数问题的函数，[也是基于 MDN 的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round#Example%3a_Decimal_rounding)。它比 Lavamantis 的解决方案更通用（但不太简洁）：

```
function round(value, exp) {
  if (typeof exp === 'undefined' || +exp === 0)
    return Math.round(value);

  value = +value;
  exp  = +exp;

  if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0))
    return NaN;

  // Shift
  value = value.toString().split('e');
  value = Math.round(+(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp)));

  // Shift back
  value = value.toString().split('e');
  return +(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp));
} 
```

使用它：

```
round(10.8034, 2);      // Returns 10.8
round(1.275, 2);        // Returns 1.28
round(1.27499, 2);      // Returns 1.27
round(1.2345678e+2, 2); // Returns 123.46 
```

与 Lavamantis 的解决方案相比，我们可以做...

```
round(1234.5678, -2); // Returns 1200
round("123.45");      // Returns 123 
```

* * *

## 回答 #24

> 赞同：20
> 
> 时间：2012-08-06T17:21:40.257

它可能对你有用，

```
Math.round(num * 100)/100; 
```

要知道 toFixed 和 round 之间的区别。你可以看看*[Math.round(num) vs num.toFixed(0) 和 browser inconsistencies](https://stackoverflow.com/questions/566564/javascript-functions-math-roundnum-vs-num-tofixed0-and-browser-inconsistenci)*。

* * *

## 回答 #25

> 赞同：20
> 
> 时间：2015-05-23T19:43:48.863

*仅在必要时*实现这种舍入的一种方法是使用[Number.prototype.toLocaleString()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString)：

```
myNumber.toLocaleString('en', {maximumFractionDigits:2, useGrouping:false}) 
```

这将提供您期望的输出，但作为字符串。如果这不是您期望的数据类型，您仍然可以将它们转换回数字。

* * *

## 回答 #26

> 赞同：18
> 
> 时间：2016-11-25T08:37:38.063

这是最简单、更优雅的解决方案（我是世界上最好的；）：

```
function roundToX(num, X) {    
    return +(Math.round(num + "e+"+X)  + "e-"+X);
}
//roundToX(66.66666666,2) => 66.67
//roundToX(10,2) => 10
//roundToX(10.904,2) => 10.9 
```

具有后备值的现代语法替代方案

```
const roundToX = (num = 0, X = 20) => +(Math.round(num + `e${X}`)  + `e-${X}`) 
```

* * *

## 回答 #27

> 赞同：17
> 
> 时间：2015-05-15T07:18:05.300

```
var roundUpto = function(number, upto){
    return Number(number.toFixed(upto));
}
roundUpto(0.1464676, 2); 
```

`toFixed(2)`这里 2 是我们想要四舍五入的位数。

* * *

## 回答 #28

> 赞同：17
> 
> 时间：2019-04-04T17:12:49.573

最后更新：

将这个答案留给后代，但我建议使用@AmrAli 对 DecimalPrecision 函数的改编，因为它也可以处理指数符号。出于性能原因，我最初试图避免任何类型的字符串转换/操作，但他的实现在性能上几乎没有差异。

编辑 2020 年 8 月 22 日：我认为这里应该澄清的是，这些努力的目标不是完全消除由浮点数据类型引起的固有舍入误差，因为如果不切换到实际上是将值存储为base10（十进制）。真正的目标应该是将不准确性尽可能推到边缘，以便您可以对给定值执行数学运算而不会产生错误。当您的值达到绝对边缘时，简单地调用该值会导致 JS 在您操作它之前或之后产生错误，您无能为力来缓解这种情况。例如，如果你实例化值 0.014999999999999999，JS 会立即将其四舍五入为 0.015。因此，如果您将该值传递给这些函数中的任何一个，您实际上传递的是 0.015。那时您甚至无法先转换为字符串然后对其进行操作，该值必须从一开始就实例化为字符串才能起作用。为缓解此错误而创建的任何函数的目标，也是唯一合理的期望只是允许对浮点值执行数学运算，同时将错误一直推到起始值或结果值的边缘无论如何都会简单地通过调用来产生错误。唯一的其他替代解决方案是将整数和十进制值独立地存储为整数，以便它们只被这样调用，

在运行所有可能的方法的各种迭代以实现真正准确的小数舍入精度之后，很明显最准确和有效的解决方案是使用 Number.EPSILON。这为浮点数学精度问题提供了真正的数学解决方案。它可以很容易地填充，如下所示：[https](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON) ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON以支持所有最后剩下的 IE 用户（然后也许我们应该停止这样做）。

改编自此处提供的解决方案：[https ://stackoverflow.com/a/48850944/6910392](https://stackoverflow.com/a/48850944/6910392)

一个简单的解决方案，提供精确的小数四舍五入、地板和天花板，具有可选的精度变量，无需添加整个库。

2020 年 5 月 19 日更新：正如 Sergey 在评论中指出的那样，这种（或任何）方法有一个限制，值得指出。对于像 0.014999999999999999 这样的数字，您仍然会遇到不准确性，这是由于浮点值存储的准确性限制的绝对边缘而导致的。没有可以应用的数学或其他解决方案来解释这一点，因为该值本身立即被评估为 0.015。您可以通过简单地在控制台中调用该值来确认这一点。由于这个限制，甚至不可能使用字符串操作来减少这个值，因为它的字符串表示只是“0.015”。任何解决这个问题的解决方案都需要在数据源逻辑上应用，然后再将值接受到脚本中，

2020 年 8 月 19 日更新：根据 Amr 的评论，当输入值为整数时，ceil 和 floor 函数将产生不希望的结果。这是由于对 Number.EPSILON 的输入应用了加法，以抵消预期的浮点误差。该函数已更新，以检查输入值是否为整数并返回未更改的值，因为这是任一函数在应用于整数时的正确结果。

*注意：此问题还表明，虽然 ceil 和 floor 函数仍需要应用 Number.EPSILON 调整，但当应用于输入数字中的小数位数低于小数位数的值时，它们确实会产生不良结果要求输出的小数 (p)。例如，当应用于数学中的整数时，ceil(17.1, 5) 应返回与预期的“ceil”函数行为相关的 17.1，其中“1”之后的所有小数位都假定为 0。为此，我'我们添加了一个额外的函数检查来识别输入数字中的小数位数是否低于请求的输出小数位数，并返回不变的数字，就像整数一样。

```
var DecimalPrecision = (function(){
        if (Number.EPSILON === undefined) {
            Number.EPSILON = Math.pow(2, -52);
        }
        if(Number.isInteger === undefined){
            Number.isInteger = function(value) {
                return typeof value === 'number' && 
                isFinite(value) && 
                Math.floor(value) === value;
            };
        }
        this.isRound = function(n,p){
            let l = n.toString().split('.')[1].length;
            return (p >= l);
        }
        this.round = function(n, p=2){
            if(Number.isInteger(n) || this.isRound(n,p))
                return n;
            let r = 0.5 * Number.EPSILON * n;
            let o = 1; while(p-- > 0) o *= 10;
            if(n<0)
                o *= -1;
            return Math.round((n + r) * o) / o;
        }
        this.ceil = function(n, p=2){
            if(Number.isInteger(n) || this.isRound(n,p))
                return n;
            let r = 0.5 * Number.EPSILON * n;
            let o = 1; while(p-- > 0) o *= 10;

            return Math.ceil((n + r) * o) / o;
        }
        this.floor = function(n, p=2){
            if(Number.isInteger(n) || this.isRound(n,p))
                return n;
            let r = 0.5 * Number.EPSILON * n;
            let o = 1; while(p-- > 0) o *= 10;

            return Math.floor((n + r) * o) / o;
        }
        return this;
    })();
    console.log(DecimalPrecision.round(1.005));
    console.log(DecimalPrecision.ceil(1.005));
    console.log(DecimalPrecision.floor(1.005));
    console.log(DecimalPrecision.round(1.0049999));
    console.log(DecimalPrecision.ceil(1.0049999));
    console.log(DecimalPrecision.floor(1.0049999));
    console.log(DecimalPrecision.round(2.175495134384,7));
    console.log(DecimalPrecision.round(2.1753543549,8));
    console.log(DecimalPrecision.round(2.1755465135353,4));
    console.log(DecimalPrecision.ceil(17,4));
    console.log(DecimalPrecision.ceil(17.1,4));
    console.log(DecimalPrecision.ceil(17.1,15));
```

* * *

## 回答 #29

> 赞同：14
> 
> 时间：2013-08-12T18:30:28.637

这是一个原型方法：

```
Number.prototype.round = function(places){
    places = Math.pow(10, places); 
    return Math.round(this * places)/places;
}

var yournum = 10.55555;
yournum = yournum.round(2); 
```

* * *

## 回答 #30

> 赞同：14
> 
> 时间：2015-02-25T20:09:30.867

最简单的方法：

`+num.toFixed(2)`

它将其转换为字符串，然后再转换回整数/浮点数。

* * *

## 回答 #31

> 赞同：14
> 
> 时间：2018-03-26T08:26:56.257

使用类似“parseFloat(parseFloat(value).toFixed(2))”的东西

```
parseFloat(parseFloat("1.7777777").toFixed(2))-->1.78 
parseFloat(parseFloat("10").toFixed(2))-->10 
parseFloat(parseFloat("9.1").toFixed(2))-->9.1 
```

* * *

## 回答 #32

> 赞同：12
> 
> 时间：2013-10-11T15:21:39.430

要不处理许多 0，请使用以下变体：

```
Math.round(num * 1e2) / 1e2 
```

* * *

## 回答 #33

> 赞同：11
> 
> 时间：2019-06-07T11:21:59.490

将类型保留为整数以供以后排序或其他数学运算：

```
Math.round(1.7777777 * 100)/100 
```

> 1.78

```
// Round up!
Math.ceil(1.7777777 * 100)/100 
```

> 1.78

```
// Round down!
Math.floor(1.7777777 * 100)/100 
```

> 1.77

或转换为字符串：

```
(1.7777777).toFixed(2) 
```

> “1.77”

* * *

## 回答 #34

> 赞同：10
> 
> 时间：2014-06-18T13:35:04.093

如果您碰巧已经在使用 d3 库，他们有一个强大的数字格式化库：[https ://github.com/mbostock/d3/wiki/Formatting](https://github.com/mbostock/d3/wiki/Formatting)

四舍五入在这里：[https ://github.com/mbostock/d3/wiki/Formatting#d3_round](https://github.com/mbostock/d3/wiki/Formatting#d3_round)

在你的情况下，答案是：

```
> d3.round(1.777777, 2)
1.78
> d3.round(1.7, 2)
1.7
> d3.round(1, 2)
1 
```

* * *

## 回答 #35

> 赞同：10
> 
> 时间：2017-10-20T17:59:36.083

更简单的 ES6 方式是

```
const round = (x, n) => 
  Number(parseFloat(Math.round(x * Math.pow(10, n)) / Math.pow(10, n)).toFixed(n)); 
```

此模式还返回所要求的精度。

前任：

```
round(44.7826456, 4)  // yields 44.7826
round(78.12, 4)       // yields 78.12 
```

* * *

## 回答 #36

> 赞同：9
> 
> 时间：2019-01-26T09:46:08.683

> parseFloat("1.555").toFixed(2); // 返回 1.55 而不是 1.56。

1.55 是绝对正确的结果，因为计算机中不存在 1.555 的精确表示。如果读数为 1.555，则四舍五入到最接近的可能值 = 1.55499999999999994（64 位浮点数）。将这个数字用 toFixed(2) 四舍五入得到 1.55。

如果输入为 1.55499999999999，此处提供的所有其他函数都会给出故障结果。

解决方案：在扫描前附加数字“5”以四舍五入（更准确地说：从 0 开始四舍五入）数字。仅当数字确实是浮点数（有小数点）时才这样做。

```
parseFloat("1.555"+"5").toFixed(2); // Returns 1.56 
```

* * *

## 回答 #37

> 赞同：9
> 
> 时间：2019-02-27T18:59:02.787

另一种方法是使用库。为什么不`lodash`：

```
const _ = require("lodash")
const roundedNumber = _.round(originalNumber, 2) 
```

* * *

## 回答 #38

> 赞同：8
> 
> 时间：2020-07-30T15:49:34.510

我查看了这篇文章的**每个答案**。以下是我对此事的看法：

```
const nbRounds = 7;
const round = (x, n=2) => {
  const precision = Math.pow(10, n)
  return Math.round((x+Number.EPSILON) * precision ) / precision;
}
let i = 0;
while( nbRounds > i++ ) {
  console.log("round(1.00083899, ",i,") > ", round(1.00083899, i))
  console.log("round(1.83999305, ",i,") > ", round(1.83999305, i))
}
```

* * *

## 回答 #39

> 赞同：8
> 
> 时间：2022-01-27T13:22:28.280

## 2022，原生，无库，现代浏览器，清晰易读。

```
function round(
  value,
  minimumFractionDigits,
  maximumFractionDigits
) {
  const formattedValue = value.toLocaleString('en', {
    useGrouping: false,
    minimumFractionDigits,
    maximumFractionDigits
  })
  return Number(formattedValue)
}

console.log(round(21.891, 2, 3)) // 21.891
console.log(round(21.0001, 0, 1)) // 21.0
console.log(round(1.8, 2)) // 1.80
console.log(round(0.875, 3)) // 0.875
```

* * *

## 回答 #40

> 赞同：6
> 
> 时间：2016-07-05T13:34:18.450

我将为此添加另一种方法。

```
number = 16.6666666;
console.log(parseFloat(number.toFixed(2)));
"16.67"

number = 16.6;
console.log(parseFloat(number.toFixed(2)));
"16.6"

number = 16;
console.log(parseFloat(number.toFixed(2)));
"16" 
```

`.toFixed(2)`返回一个正好有 2 个小数点的字符串，它可能是也可能不是尾随零。执行 a`parseFloat()`将消除那些尾随零。

* * *

## 回答 #41

> 赞同：6
> 
> 时间：2018-06-19T00:03:39.120

这对我有用（TypeScript）：

```
round(decimal: number, decimalPoints: number): number{
    let roundedValue = Math.round(decimal * Math.pow(10, decimalPoints)) / Math.pow(10, decimalPoints);

    console.log(`Rounded ${decimal} to ${roundedValue}`);
    return roundedValue;
}

// Sample output:
Rounded 18.339840000000436 to 18.34
Rounded 52.48283999999984 to 52.48
Rounded 57.24612000000036 to 57.25
Rounded 23.068320000000142 to 23.07
Rounded 7.792980000000398 to 7.79
Rounded 31.54157999999981 to 31.54
Rounded 36.79686000000004 to 36.8
Rounded 34.723080000000124 to 34.72
Rounded 8.4375 to 8.44
Rounded 15.666960000000074 to 15.67
Rounded 29.531279999999924 to 29.53
Rounded 8.277420000000006 to 8.28 
```

* * *

## 回答 #42

> 赞同：6
> 
> 时间：2018-07-18T06:59:24.367

如果你想四舍五入，简单的解决方案是使用 lodash 的 ceil 函数......

[https://lodash.com/docs/4.17.10#ceil](https://lodash.com/docs/4.17.10#ceil)

```
_.round(6.001,2) 
```

给 6

```
_.ceil(6.001, 2); 
```

给出 6.01

```
_.ceil(37.4929,2); 
```

给出 37.5

```
_.round(37.4929,2); 
```

给出 37.49

* * *

## 回答 #43

> 赞同：6
> 
> 时间：2018-10-24T17:43:16.437

基于[选择的答案](https://stackoverflow.com/a/11832950/1417223)和对同一问题的[赞成评论：](https://stackoverflow.com/questions/11832914/round-to-at-most-2-decimal-places-only-if-necessary#comment26122771_11832950)

```
Math.round((num + 0.00001) * 100) / 100 
```

这适用于这两个示例：

```
Math.round((1.005 + 0.00001) * 100) / 100

Math.round((1.0049 + 0.00001) * 100) / 100 
```

* * *

## 回答 #44

> 赞同：6
> 
> 时间：2020-01-08T23:34:08.590

数学地板和圆形[定义](https://math.stackexchange.com/a/2886808/605065)[：](https://latex.codecogs.com/gif.latex?%5Cinline%20%5Cdpi%7B150%7D%20%5Cbg_white%20%5Cbegin%7Bmatrix%7D%20%5Cleft%20%5Clfloor%20x%20%5Cright%20%5Crfloor%20%26%20%3D%20%26%20x%20-%20%28x%20%5Cmod%201%29%20%26%20%5C%5C%20%5Cmathrm%7Bround%7D%20%28x%29%20%26%20%3D%20%26%20%5Cleft%20%5Clfloor%20x%20+%201/2%20%5Cright%20%5Crfloor%20%26%20%5Cend%7Bmatrix%7D%20%5C%5C%20%5Cphantom.%5Cqquad%20%5Cqquad%20%5Cqquad%20%5CDownarrow%20%5C%5C%20%5Cmathrm%7Bround%7D%20%28x%29%20%3D%20%28x+1/2%29%20-%20%28%28x+1/2%29%5Cmod%201%29)

[![在此处输入图像描述](../Images/e244c04f19f4d358505dfc7d706bb4b7.png)](https://i.stack.imgur.com/QOHKX.png)

带领我们

```
let round= x=> ( x+0.005 - (x+0.005)%0.01 +'' ).replace(/(\...)(.*)/,'$1');

// for case like 1.384 we need to use regexp to get only 2 digits after dot
// and cut off machine-error (epsilon)

console.log(round(10));
console.log(round(1.7777777));
console.log(round(1.7747777));
console.log(round(1.384));
```

* * *

## 回答 #45

> 赞同：6
> 
> 时间：2020-05-22T18:29:38.863

一个简单的一般舍入函数可能如下：

# 步骤是：

1.  **使用Math.pow(10,places)**将数字乘以（10 的小数位数的幂） 。
2.  **使用Math.Round**将结果舍入为整数。
3.  将结果除以（10 小数位数的幂）**Math.pow(10,places)**。

# 例子：

数字是： 1.2375 要四舍五入到小数点后 3 位

1.  1.2375 * (10^3)​​ ==> 1.2375 * 1000 = 1237.5
2.  四舍五入为整数 ==> 1238
3.  将 1238 除以 (10^3)​​ ==> 1238 / 1000 = 1.238

*（注意：10^3 表示 Math.pow(10,3)）。*

```
 function numberRoundDecimal(v,n) {
 return Math.round((v+Number.EPSILON)*Math.pow(10,n))/Math.pow(10,n)}

// ------- tests --------
console.log(numberRoundDecimal(-0.024641163062896567,3))  // -0.025
console.log(numberRoundDecimal(0.9993360575508052,3))     // 0.999
console.log(numberRoundDecimal(1.0020739645577939,3))     // 1.002
console.log(numberRoundDecimal(0.975,0))                  // 1
console.log(numberRoundDecimal(0.975,1))                  // 1
console.log(numberRoundDecimal(0.975,2))                  // 0.98
console.log(numberRoundDecimal(1.005,2))                  // 1.01
```

* * *

## 回答 #46

> 赞同：6
> 
> 时间：2020-10-23T15:38:59.140

我已经阅读了所有答案，类似问题的答案以及最“好”解决方案的复杂性并没有让我满意。我不想放一个巨大的圆形函数集，或者一个小的但在科学计数法上失败了。所以，我想出了这个功能。在我的情况下，它可能会对某人有所帮助：

```
function round(num, dec) {
   const [sv, ev] = num.toString().split('e');
   return Number(Number(Math.round(parseFloat(sv + 'e' + dec)) + 'e-' + dec) + 'e' + (ev || 0));
} 
```

我没有运行任何性能测试，因为我将调用它只是为了更新我的应用程序的 UI。该函数为快速测试提供以下结果：

```
// 1/3563143 = 2.806510993243886e-7
round(1/3563143, 2)  // returns `2.81e-7`

round(1.31645, 4)    // returns 1.3165

round(-17.3954, 2)   // returns -17.4 
```

这对我来说已经足够了。

* * *

## 回答 #47

> 赞同：5
> 
> 时间：2017-12-08T06:40:01.960

我知道有很多答案，但其中大多数在某些特定情况下都有副作用。

没有任何副作用的最简单和最短的解决方案如下：

```
Number((2.3456789).toFixed(2)) // 2.35 
```

它正确舍入并返回数字而不是字符串

```
console.log(Number((2.345).toFixed(2)))  // 2.35
console.log(Number((2.344).toFixed(2)))  // 2.34
console.log(Number((2).toFixed(2)))      // 2
console.log(Number((-2).toFixed(2)))     // -2
console.log(Number((-2.345).toFixed(2))) // -2.35

console.log(Number((2.345678).toFixed(3))) // 2.346 
```

* * *

## 回答 #48

> 赞同：4
> 
> 时间：2014-07-11T12:04:29.727

尝试使用 jQuery [.number 插件](http://www.teamdf.com/web/jquery-number-format-redux/196)：

```
var number = 19.8000000007;
var res = 1 * $.number(number, 2); 
```

* * *

## 回答 #49

> 赞同：4
> 
> 时间：2015-03-17T14:57:40.663

您还可以覆盖 Math.round 函数以正确进行舍入并添加小数参数并像这样使用它：Math.round(Number, Decimals)。请记住，这会覆盖内置组件 Math.round 并为其提供另一个属性，然后是原始属性。

```
var round = Math.round;
Math.round = function (value, decimals) {
  decimals = decimals || 0;
  return Number(round(value + 'e' + decimals) + 'e-' + decimals);
} 
```

然后你可以像这样简单地使用它：

```
Math.round(1.005, 2); 
```

[https://jsfiddle.net/k5tpq3pd/3/](https://jsfiddle.net/k5tpq3pd/3/)

* * *

## 回答 #50

> 赞同：4
> 
> 时间：2015-04-28T15:58:02.143

**这是最短和完整的答案：**

```
function round(num, decimals) {
        var n = Math.pow(10, decimals);
        return Math.round( (n * num).toFixed(decimals) )  / n;
}; 
```

**这也处理了将返回 1.01 的示例案例 1.005。**

* * *

## 回答 #51

> 赞同：4
> 
> 时间：2016-04-16T22:26:11.360

在小数位`pos`（包括没有小数）处四舍五入`Math.round(num * Math.pow(10,pos)) / Math.pow(10,pos)`

```
var console = {
 log: function(s) {
  document.getElementById("console").innerHTML += s + "<br/>"
 }
}
var roundDecimals=function(num,pos) {
 return (Math.round(num * Math.pow(10,pos)) / Math.pow(10,pos) );
}
//https://en.wikipedia.org/wiki/Pi
var pi=3.14159265358979323846264338327950288419716939937510;
for(var i=2;i<15;i++) console.log("pi="+roundDecimals(pi,i));
for(var i=15;i>=0;--i) console.log("pi="+roundDecimals(pi,i));
```

```
<div id="console" />
```

* * *

## 回答 #52

> 赞同：4
> 
> 时间：2018-07-16T20:26:09.287

我正在构建一个简单的tipCalculator，这里有很多答案似乎使问题过于复杂。所以我发现总结这个问题是真正回答这个问题的最佳方式

如果你想创建一个四舍五入的十进制数，首先你调用`toFixed(# of decimal places you want to keep)`然后将它包装在一个 Number()

所以最终结果：

```
let amountDue = 286.44;
tip = Number((amountDue * 0.2).toFixed(2));
console.log(tip)  // 57.29 instead of 57.288 
```

* * *

## 回答 #53

> 赞同：4
> 
> 时间：2018-08-02T12:06:32.313

可以通过使用以指数符号表示的数字来避免舍入问题。

```
public roundFinancial(amount: number, decimals: number) {
    return Number(Math.round(Number(`${amount}e${decimals}`)) + `e-${decimals}`);
} 
```

* * *

## 回答 #54

> 赞同：4
> 
> 时间：2021-09-03T23:14:23.573

一个简单的通用解决方案

```
const round = (n, dp) => {
  const h = +('1'.padEnd(dp + 1, '0')) // 10 or 100 or 1000 or etc
  return Math.round(n * h) / h
}

console.log('round(2.3454, 3)', round(2.3454, 3)) // 2.345
console.log('round(2.3456, 3)', round(2.3456, 3)) // 2.346
console.log('round(2.3456, 2)', round(2.3456, 2)) // 2.35
```

或者只使用具有相同签名的lodash [round - 例如 _.round(2.3456, 2)](https://lodash.com/docs/4.17.15#round)

* * *

## 回答 #55

> 赞同：3
> 
> 时间：2013-06-17T06:48:53.123

这是我想出的一个“四舍五入”的功能。我使用 double Math.round 来补偿 JavaScript 的不准确乘法，因此 1.005 将正确地四舍五入为 1.01。

```
function myRound(number, decimalplaces){
    if(decimalplaces > 0){
        var multiply1 = Math.pow(10,(decimalplaces + 4));
        var divide1 = Math.pow(10, decimalplaces);
        return Math.round(Math.round(number * multiply1)/10000 )/divide1;
    }
    if(decimalplaces < 0){
        var divide2 = Math.pow(10, Math.abs(decimalplaces));
        var multiply2 = Math.pow(10, Math.abs(decimalplaces));
        return Math.round(Math.round(number / divide2) * multiply2);
    }
    return Math.round(number);
} 
```

* * *

## 回答 #56

> 赞同：3
> 
> 时间：2013-07-03T00:41:14.020

我为自己编写了以下一组函数。也许它也会帮助你。

```
function float_exponent(number) {
    exponent = 1;
    while (number < 1.0) {
        exponent += 1
        number *= 10
    }
    return exponent;
}
function format_float(number, extra_precision) {
    precision = float_exponent(number) + (extra_precision || 0)
    return number.toFixed(precision).split(/\.?0+$/)[0]
} 
```

用法：

```
format_float(1.01); // 1
format_float(1.06); // 1.1
format_float(0.126); // 0.13
format_float(0.000189); // 0.00019 
```

对于你的情况：

```
format_float(10, 1); // 10
format_float(9.1, 1); // 9.1
format_float(1.77777, 1); // 1.78 
```

* * *

## 回答 #57

> 赞同：3
> 
> 时间：2019-07-30T00:45:06.103

如果您需要将货币金额格式化为货币总量或带有小数货币部分的金额，则对此略有不同。

例如：

1 应该输出 $1

1.1 应该输出 $1.10

1.01 应该输出 $1.01

假设金额是一个数字：

`const formatAmount = (amount) => amount % 1 === 0 ? amount : amount.toFixed(2);`

如果 amount 不是数字，则使用 parseFloat(amount) 将其转换为数字。

* * *

## 回答 #58

> 赞同：2
> 
> 时间：2017-02-08T17:13:31.343

仅作记录，如果要舍入的数字和位数足够大，则缩放方法理论上可以返回 Infinity。在 JavaScript 中这不应该是一个问题，因为最大数字是 1.7976931348623157e+308，但是如果你正在处理非常大的数字或很多小数位，你可以尝试这个函数：

```
Number.prototype.roundTo = function(digits)
{
    var str = this.toString();
    var split = this.toString().split('e');
    var scientific = split.length > 1;
    var index;
    if (scientific)
    {
        str = split[0];
        var decimal = str.split('.');
        if (decimal.length < 2)
            return this;
        index = decimal[0].length + 1 + digits;
    }
    else
        index = Math.floor(this).toString().length + 1 + digits;
    if (str.length <= index)
        return this;
    var digit = str[index + 1];
    var num = Number.parseFloat(str.substring(0, index));
    if (digit >= 5)
    {
        var extra = Math.pow(10, -digits);
        return this < 0 ? num - extra : num + extra;
    }
    if (scientific)
        num += "e" + split[1];
    return num;
}
```

* * *

## 回答 #59

> 赞同：2
> 
> 时间：2018-02-13T07:48:23.420

从我在[MDN上找到的针对](https://developer.mozilla.org/en-US/)[**precisionRound**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round)提出的示例开始 （1.005 的事件返回 1 而不是 1.01），我编写了一个自定义的**precisionRound**来管理随机精度数，并且 1.005 返回 1.01。

 **这是功能：

```
function precisionRound(number, precision)
{
  if(precision < 0)
  {
    var factor = Math.pow(10, precision);
    return Math.round(number * factor) / factor;
  }
  else
    return +(Math.round(number + "e+"+precision)  + "e-"+precision);
}

console.log(precisionRound(1234.5678, 1));  // output: 1234.6
console.log(precisionRound(1234.5678, -1)); // output: 1230
console.log(precisionRound(1.005, 2));      // output: 1.01
console.log(precisionRound(1.0005, 2));     // output: 1
console.log(precisionRound(1.0005, 3));     // output: 1.001
console.log(precisionRound(1.0005, 4));     // output: 1.0005 
```

对于打字稿：

```
public static precisionRound(number: number, precision: number)
{
  if (precision < 0)
  {
    let factor = Math.pow(10, precision);
    return Math.round(number * factor) / factor;
  }
  else
    return +(Math.round(Number(number + "e+" + precision)) +
      "e-" + precision);
} 
```

* * *

## 回答 #60

> 赞同：2
> 
> 时间：2018-05-23T06:21:50.877

从现有的答案中，我发现了另一个似乎效果很好的解决方案，它也适用于发送字符串并消除尾随零。

```
function roundToDecimal(string, decimals) {
    return parseFloat(parseFloat(string).toFixed(decimals));
} 
```

如果您发送一些公牛......就像“apa”一样，它不会考虑在内。或者它可能会抛出一个我认为无论如何都是正确方法的错误，隐藏应该修复的错误（通过调用函数）永远不会好。

* * *

## 回答 #61

> 赞同：2
> 
> 时间：2018-09-06T17:35:03.843

当我想总是四舍五入到某个小数时，这对我来说效果很好。这里的关键是我们将始终使用 Math.ceil 函数进行四舍五入。

如果需要，您可以有条件地选择天花板或地板。

```
 /**
     * Possibility to lose precision at large numbers
     * @param number
     * @returns Number number
     */
    var roundUpToNearestHundredth = function(number) {

        // Ensure that we use high precision Number
        number = Number(number);

        // Save the original number so when we extract the Hundredth decimal place we don't bit switch or lose precision
        var numberSave = Number(number.toFixed(0));

        // Remove the "integer" values off the top of the number
        number = number - numberSave;

        // Get the Hundredth decimal places
        number *= 100;

        // Ceil the decimals.  Therefore .15000001 will equal .151, etc.
        number = Math.ceil(number);

        // Put the decimals back into their correct spot
        number /= 100;

        // Add the "integer" back onto the number
        return number + numberSave;

    };

console.log(roundUpToNearestHundredth(6132423.1200000000001))
```

* * *

## 回答 #62

> 赞同：2
> 
> 时间：2019-03-16T20:53:29.430

这个看似简单的任务的最大挑战是，我们希望它产生心理预期的结果，即使输入包含最小的舍入误差（更不用说在我们的计算中会发生的误差）。如果我们知道实际结果正好是 1.005，我们预计四舍五入到两位数会产生 1.01，即使 1.005 是经过大量舍入误差的大型计算的结果。

`floor()`当处理而不是处理时，问题变得更加明显`round()`。例如，当在 33.3 点后面的最后两位数之后删除所有内容时，我们当然*不会*期望得到 33.29，但这就是发生的情况：

```
console.log(Math.floor(33.3 * 100) / 100)
```

在简单的情况下，解决方案是对字符串而不是浮点数进行计算，从而完全避免舍入错误。但是，此选项在第一次非平凡的数学运算（包括大多数除法）时失败，并且速度很慢。

在对浮点数进行操作时，解决方案是引入一个参数，该参数命名我们愿意偏离实际计算结果的量，以输出心理预期的结果。

```
var round = function(num, digits = 2, compensateErrors = 2) {
  if (num < 0) {
    return -this.round(-num, digits, compensateErrors);
  }
  const pow = Math.pow(10, digits);
  return (Math.round(num * pow * (1 + compensateErrors * Number.EPSILON)) / pow);
}

/* --- testing --- */

console.log("Edge cases mentioned in this thread:")
var values = [ 0.015, 1.005, 5.555, 156893.145, 362.42499999999995, 1.275, 1.27499, 1.2345678e+2, 2.175, 5.015, 58.9 * 0.15 ];
values.forEach((n) => {
  console.log(n + " -> " + round(n));
  console.log(-n + " -> " + round(-n));
});

console.log("\nFor numbers which are so large that rounding cannot be performed anyway within computation precision, only string-based computation can help.")
console.log("Standard: " + round(1e+19));
console.log("Compensation = 1: " + round(1e+19, 2, 1));
console.log("Effectively no compensation: " + round(1e+19, 2, 0.4));
```

注意：Internet Explorer 不知道`Number.EPSILON`. 如果您仍然不得不支持它，您可以使用 shim，或者只为特定的浏览器系列自己定义常量。

* * *

## 回答 #63

> 赞同：2
> 
> 时间：2019-04-24T18:50:50.233

这是我对这个问题的解决方案：

```
function roundNumber(number, precision = 0) {
var num = number.toString().replace(",", "");
var integer, decimal, significantDigit;

if (num.indexOf(".") > 0 && num.substring(num.indexOf(".") + 1).length > precision && precision > 0) {
    integer = parseInt(num).toString();
    decimal = num.substring(num.indexOf(".") + 1);
    significantDigit = Number(decimal.substr(precision, 1));

    if (significantDigit >= 5) {
        decimal = (Number(decimal.substr(0, precision)) + 1).toString();
        return integer + "." + decimal;
    } else {
        decimal = (Number(decimal.substr(0, precision)) + 1).toString();
        return integer + "." + decimal;
    }
}
else if (num.indexOf(".") > 0) {
    integer = parseInt(num).toString();
    decimal = num.substring(num.indexOf(".") + 1);
    significantDigit = num.substring(num.length - 1, 1);

    if (significantDigit >= 5) {
        decimal = (Number(decimal) + 1).toString();
        return integer + "." + decimal;
    } else {            
        return integer + "." + decimal;
    }
} 

return number;
} 
```

* * *

## 回答 #64

> 赞同：2
> 
> 时间：2019-07-23T08:38:47.137

问题是小数点后 2 位。

让我们不要做这个复杂的修改原型链等。

这是一条线解决方案

```
let round2dec = num => Math.round(num * 100) / 100; 

console.log(round2dec(1.77));
console.log(round2dec(1.774));
console.log(round2dec(1.777));
console.log(round2dec(10));
```

* * *

## 回答 #65

> 赞同：2
> 
> 时间：2020-02-23T14:51:35.867

根据评论中已经给出的答案以及指向[http://jsfiddle.net/AsRqx/](http://jsfiddle.net/AsRqx/)的链接， 以下一个对我来说非常有用。

```
function C(num) 
  { return +(Math.round(num + "e+2")  + "e-2");
  }

function N(num, places) 
  { return +(Math.round(num + "e+" + places)  + "e-" + places);
  }

C(1.005);

N(1.005,0);
N(1.005,1); //up to 1 decimal places
N(1.005,2); //up to 2 decimal places
N(1.005,3); //up to 3 decimal places 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2014-10-06T09:29:49.813

我只是想根据前面提到的答案分享我的方法：

让我们创建一个函数，将任何给定的数值四舍五入到给定的小数位数：

```
function roundWDecimals(n, decimals) {
    if (!isNaN(parseFloat(n)) && isFinite(n)) {
        if (typeof(decimals) == typeof(undefined)) {
            decimals = 0;
        }
        var decimalPower = Math.pow(10, decimals);
        return Math.round(parseFloat(n) * decimalPower) / decimalPower;
    }
    return NaN;
} 
```

并为数字原型引入一种新的“round”方法：

```
Object.defineProperty(Number.prototype, 'round', {
    enumerable: false,
    value: function(decimals) {
        return roundWDecimals(this, decimals);
    }
}); 
```

你可以测试它：

```
function roundWDecimals(n, decimals) {
    if (!isNaN(parseFloat(n)) && isFinite(n)) {
        if (typeof(decimals) == typeof(undefined)) {
            decimals = 0;
        }
        var decimalPower = Math.pow(10, decimals);
        return Math.round(parseFloat(n) * decimalPower) / decimalPower;
    }
    return NaN;
}
Object.defineProperty(Number.prototype, 'round', {
    enumerable: false,
    value: function(decimals) {
        return roundWDecimals(this, decimals);
    }
});

var roundables = [
    {num: 10, decimals: 2},
    {num: 1.7777777, decimals: 2},
    {num: 9.1, decimals: 2},
    {num: 55.55, decimals: 1},
    {num: 55.549, decimals: 1},
    {num: 55, decimals: 0},
    {num: 54.9, decimals: 0},
    {num: -55.55, decimals: 1},
    {num: -55.551, decimals: 1},
    {num: -55, decimals: 0},
    {num: 1.005, decimals: 2},
    {num: 1.005, decimals: 2},
    {num: 19.8000000007, decimals: 2},
  ],
  table = '<table border="1"><tr><th>Num</th><th>Decimals</th><th>Result</th></tr>';
$.each(roundables, function() {
  table +=
    '<tr>'+
      '<td>'+this.num+'</td>'+
      '<td>'+this.decimals+'</td>'+
      '<td>'+this.num.round(this.decimals)+'</td>'+
    '</tr>'
  ;
});
table += '</table>';
$('.results').append(table);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<div class="results"></div>
```

* * *

## 回答 #67

> 赞同：1
> 
> 时间：2017-05-31T15:43:48.343

适用于所有浏览器和精度的通用答案：

```
function round(num, places) {
      if(!places){
       return Math.round(num);
      }

      var val = Math.pow(10, places);
      return Math.round(num * val) / val;
}

round(num, 2); 
```

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2018-02-13T20:44:50.753

在节点环境中，我只使用[roundTo](https://www.npmjs.com/package/round-to)模块：

```
const roundTo = require('round-to');
...
roundTo(123.4567, 2);

// 123.46 
```

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2018-08-21T09:58:49.767

这个答案更多的是关于速度。

```
var precalculatedPrecisions = [1e0, 1e1, 1e2, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9, 1e10];

function round(num, _prec) {
    _precision = precalculatedPrecisions[_prec]
    return Math.round(num * _precision + 1e-14) / _precision ;
} 
```

[jsPerf](https://jsperf.com/round-with-precisions-diffs)关于这个。

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2019-05-23T21:27:34.990

我发现这适用于我的所有用例：

```
const round = (value, decimalPlaces = 0) => {
    const multiplier = Math.pow(10, decimalPlaces);
    return Math.round(value * multiplier + Number.EPSILON) / multiplier;
}; 
```

请记住，这是 ES6。相当于 ES5。虽然很容易编码，所以我不会添加它。

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2019-08-21T12:18:07.090

快速辅助函数`rounging`默认舍入在哪里：让舍入=4；

```
let round=(number)=>{ let multiply=Math.pow(10,rounding);  return Math.round(number*multiply)/multiply};

console.log(round(0.040579431)); 
```

=> 0.0406

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2019-09-24T18:04:15.013

有一个适用于所有数字的解决方案，试一试。表达式如下。

```
Math.round((num + 0.00001) * 100) / 100\. Try Math.round((1.005 + 0.00001) * 100) / 100 and Math.round((1.0049 + 0.00001) * 100) / 100 
```

我最近测试了所有可能的解决方案，并在尝试了近 10 次后终于得到了输出。这是计算过程中出现的问题的屏幕截图， [![屏幕截图](../Images/3f1f5be984869e83b1cf0e2c519741de.png)](https://i.stack.imgur.com/hpBPs.png).

前往`amount`田野，它几乎无限返回。我尝试了`toFixed()`一种方法，但它不适用于某些情况（即尝试使用 PI），最后得出上面给出的 s 解决方案。

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2019-12-12T01:24:25.947

[对这个答案](https://stackoverflow.com/a/34591063/144088)稍作修改，似乎效果很好。

**功能**

```
function roundToStep(value, stepParam) {
   var step = stepParam || 1.0;
   var inv = 1.0 / step;
   return Math.round(value * inv) / inv;
} 
```

**用法**

```
roundToStep(2.55) = 3
roundToStep(2.55, 0.1) = 2.6
roundToStep(2.55, 0.01) = 2.55 
```

* * *

## 回答 #74

> 赞同：1
> 
> 时间：2020-05-01T16:39:10.407

这个功能对我有用。您只需传入数字和要四舍五入的位置，它就可以轻松完成所需的操作。

```
round(source,n) {
 let places = Math.pow(10,n);

 return Math.round(source * places) / places;
} 
```

* * *

## 回答 #75

> 赞同：1
> 
> 时间：2021-08-25T21:49:09.880

正确处理正数、负数和大数

```
function Round(value) {
    const neat = +(Math.abs(value).toPrecision(15));
    const rounded = Math.round(neat * 100) / 100;

    return rounded * Math.sign(value);
}

//0.244 -> 0.24
//0.245 -> 0.25
//0.246 -> 0.25

//-0.244 -> -0.24
//-0.245 -> -0.25
//-0.246 -> -0.25 
```

* * *

## 回答 #76

> 赞同：1
> 
> 时间：2021-11-24T09:23:58.230

另一个简单的解决方案（不编写任何函数）可以使用 toFixed() 然后再次转换为浮点数。

```
For Example:
var objNumber = 1201203.1256546456;
objNumber = parseFloat(objNumber.toFixed(2)) 
```

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2014-11-10T17:05:57.007

### 节点.js

这在几秒钟内就为我在**Node.js上解决了问题：**

```
npm install math 
```

*来源： http: [//mathjs.org/examples/basic_usage.js.html](http://mathjs.org/examples/basic_usage.js.html)*

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2016-04-19T09:33:17.723

如果您不想四舍五入，请使用以下功能。

```
function ConvertToDecimal(num) {
  num = num.toString(); // If it's not already a String
  num = num.slice(0, (num.indexOf(".")) + 3); // With 3 exposing the hundredths place    
alert('M : ' + Number(num)); // If you need it back as a Number     
} 
```

* * *

## 回答 #79

> 赞同：0
> 
> 时间：2017-09-16T20:03:42.497

我尝试了自己的代码，试试这个

```
function AmountDispalyFormat(value) {
    value = value.toFixed(3);
    var amount = value.toString().split('.');
    var result = 0;
    if (amount.length > 1) {
        var secondValue = parseInt(amount[1].toString().slice(0, 2));
        if (amount[1].toString().length > 2) {
            if (parseInt(amount[1].toString().slice(2, 3)) > 4) {
                secondValue++;
                if (secondValue == 100) {
                    amount[0] = parseInt(amount[0]) + 1;
                    secondValue = 0;
                }
            }
        }

        if (secondValue.toString().length == 1) {
            secondValue = "0" + secondValue;
        }
        result = parseFloat(amount[0] + "." + secondValue);
    } else {
        result = parseFloat(amount);
    }
    return result;
} 
```

* * *

## 回答 #80

> 赞同：0
> 
> 时间：2017-12-19T14:23:05.273

```
number=(parseInt((number +0.005)*100))/100; 
```

如果要正常舍入，则添加 0.005（小数点后 2 位）

```
8.123 +0.005=> 8.128*100=>812/100=>8.12   

8.126 +0.005=> 8.131*100=>813/100=>8.13 
```

* * *

## 回答 #81

> 赞同：0
> 
> 时间：2018-06-07T02:34:17.053

使用 Brian Ustas 的解决方案：

```
function roundDecimal(value, precision) {
    var multiplier = Math.pow(10, precision);
    return Math.round(value * multiplier) / multiplier;
} 
```

* * *

## 回答 #82

> 赞同：0
> 
> 时间：2019-07-26T07:43:30.860

我创建了这个函数，用于四舍五入。该值可以是字符串（例如“1.005”）或数字 1.005，默认情况下为 1，如果指定小数为 2，则结果将为 1.01

```
round(value: string | number, decimals: number | string = "0"): number | null {
    return +( Math.round(Number(value + "e+"+decimals)) + "e-" + decimals);
} 
```

用法：round(1.005, 2) // 1.01 或用法：round('1.005', 2) //1.01

* * *

## 回答 #83

> 赞同：0
> 
> 时间：2020-03-17T11:04:02.550

建议的答案虽然通常是正确的，但没有考虑传入数字的精度，这在原始问题中没有表示为要求，但在 3 不同于 3.00（例如）的科学应用情况下可能是要求小数位数表示获得该值的仪器的精度或计算的准确度。事实上，建议的答案从 3.001 到 3，而通过保留有关数字精度的信息应该是 3.00

下面的函数考虑到

```
function roundTo(value, decimal) {

    let absValue = Math.abs(value);
    let int = Math.floor(absValue).toString().length;
    let dec = absValue.toString().length - int;
    dec -= (Number.isInteger(absValue) ? 0 : 1);
    return value.toPrecision(int + Math.min(dec, decimal));

}
```

* * *

## 回答 #84

> 赞同：0
> 
> 时间：2021-09-18T15:01:00.267

像这样的东西怎么样

```
 num=519.805;
 dp=Math.pow(10,2);
 num = parseFloat(num.toString().concat("1"));
 rounded = Math.round((num + Number.EPSILON)* dp)/dp; 
```

进行围捕。因为它会处理数字不足的情况，最后只有小数位要四舍五入。

* * *

## 回答 #85

> 赞同：0
> 
> 时间：2021-11-18T14:29:32.843

这是@astorije 答案的修改版本（[https://stackoverflow.com/a/21323513/384884](https://stackoverflow.com/a/21323513/384884)），它更好地支持舍入负值。

```
// https://stackoverflow.com/a/21323513/384884
// Modified answer from astorije
function round(value, precision) {
    // Ensure precision exists
    if (typeof precision === "undefined" || +precision === 0) {
        // Just do a regular Math.round
        return Math.round(value);
    }

    // Convert the value and precision variables both to numbers
    value = +value;
    precision = +precision;

    // Ensure the value is a number and that precision is usable
    if (isNaN(value) || !(typeof precision === "number" && precision % 1 === 0)) {
        // Return NaN
        return NaN;
    }

    // Get the sign of value
    var signValue = Math.sign(value);

    // Get the absolute value of value
    value = Math.abs(value);

    // Shift
    value = value.toString().split("e");
    value = Math.round(+(value[0] + "e" + (value[1] ? (+value[1] + precision) : precision)));

    // Shift back
    value = value.toString().split("e");
    value = +(value[0] + "e" + (value[1] ? (+value[1] - precision) : -precision));

    // Apply the sign
    value = value * signValue;

    // Return rounded value
    return value;
} 
```

* * *

## 回答 #86

> 赞同：0
> 
> 时间：2022-01-25T16:37:39.200

我的解决方案将输入视为字符串，并使用“数学舍入”算法到 n 位：取 n 位，如果 n+1 为 5 或更多，则添加一位。它还允许指定负数，例如将 123.45 舍入到 -1 数字是 120。它也适用于科学记数法（例如 1.2e-3）。我没有测量它的速度，我认为它不是最好的性能。

```
function safeRound( numInput, numPrecision ) {
    const strNumber = numInput.toString().replace( 'E', 'e' );
    const bSign = '+-'.indexOf( strNumber[ 0 ] ) !== -1;
    const strSign = bSign  ?  strNumber[ 0 ]  :  '';
    const numSign = strSign !== '-'  ?  +1  :  -1;
    const ixExponent = ( ixFound => ixFound !== -1  ?  ixFound  :  strNumber.length )( strNumber.indexOf( 'e' ) );
    const strExponent = strNumber.substr( ixExponent + 1 );
    const numExponent = ixExponent !== strNumber.length  ?  Number.parseInt( strExponent )  :  0;
    const ixDecimal = ( ixFound => ixFound !== -1  ?  ixFound  :  ixExponent )( strNumber.indexOf( '.' ) );
    const strInteger = strNumber.substring( !bSign  ?  0  :  1, ixDecimal );
    const strFraction = strNumber.substring( ixDecimal + 1, ixExponent );

    const numPrecisionAdjusted = numPrecision + numExponent;
    const strIntegerKeep = strInteger.substring( 0, strInteger.length + Math.min( 0, numPrecisionAdjusted ) ) + '0'.repeat( -Math.min( 0, numPrecisionAdjusted ) );
    const strFractionKeep = strFraction.substring( 0, Math.max( 0, numPrecisionAdjusted ) );
    const strRoundedDown = strSign + ( strIntegerKeep === ''  ?  '0'  :  strIntegerKeep ) + ( strFractionKeep === ''  ?  ''  :  '.' + strFractionKeep ) + ( strExponent === ''  ?  ''  :  'e' + strExponent );

    const chRoundUp = 0 <= numPrecisionAdjusted  ?  strFraction.substr( numPrecisionAdjusted, 1 )  :  ( '0' + strInteger ).substr( numPrecisionAdjusted, 1 );
    const bRoundUp = '5' <= chRoundUp && chRoundUp <= '9';
    const numRoundUp = bRoundUp  ?  numSign * Math.pow( 10, -numPrecision )  :  0;

    return Number.parseFloat( strRoundedDown ) + numRoundUp;
}

function safeRoundTest( numInput, numPrecision, strExpected ) {
    const strActual = safeRound( numInput, numPrecision ).toString();
    const bPassed = strActual === strExpected;
    console.log( 'numInput', numInput, 'numPrecision', numPrecision, 'strExpected', strExpected, 'strActual', strActual, 'bPassed', bPassed );
    return bPassed  ?  0  :  1;
}

function safeRoundTests() {
    let numFailed = 0;
    numFailed += safeRoundTest( 0, 0, '0' );
    numFailed += safeRoundTest( '0', 0, '0' );
    numFailed += safeRoundTest( '0.1', 0, '0' );
    numFailed += safeRoundTest( '+0.1', 0, '0' );
    numFailed += safeRoundTest( '-0.1', 0, '0' );
    numFailed += safeRoundTest( '0.1', 1, '0.1' );
    numFailed += safeRoundTest( '+0.1', 1, '0.1' );
    numFailed += safeRoundTest( '-0.1', 1, '-0.1' );
    numFailed += safeRoundTest( '0.9', 0, '1' );
    numFailed += safeRoundTest( '+0.9', 0, '1' );
    numFailed += safeRoundTest( '-0.9', 0, '-1' );
    numFailed += safeRoundTest( '0.9', 1, '0.9' );
    numFailed += safeRoundTest( '+0.9', 1, '0.9' );
    numFailed += safeRoundTest( '-0.9', 1, '-0.9' );
    numFailed += safeRoundTest( '0.5', 0, '1' );
    numFailed += safeRoundTest( '+0.5', 0, '1' );
    numFailed += safeRoundTest( '-0.5', 0, '-1' );
    numFailed += safeRoundTest( '0.4999', 0, '0' );
    numFailed += safeRoundTest( '+0.4999', 0, '0' );
    numFailed += safeRoundTest( '-0.4999', 0, '0' );
    numFailed += safeRoundTest( '1.005', 2, '1.01' );
    numFailed += safeRoundTest( '1.00499999999', 2, '1' );
    numFailed += safeRoundTest( '012.3456', -4, '0' );
    numFailed += safeRoundTest( '012.3456', -3, '0' );
    numFailed += safeRoundTest( '012.3456', -2, '0' );
    numFailed += safeRoundTest( '012.3456', -1, '10' );
    numFailed += safeRoundTest( '012.3456', 0, '12' );
    numFailed += safeRoundTest( '012.3456', 1, '12.3' );
    numFailed += safeRoundTest( '012.3456', 2, '12.35' );
    numFailed += safeRoundTest( '012.3456', 3, '12.346' );
    numFailed += safeRoundTest( '012.3456', 4, '12.3456' );
    numFailed += safeRoundTest( '012.3456', 5, '12.3456' );
    numFailed += safeRoundTest( '12.', 0, '12' );
    numFailed += safeRoundTest( '.12', 2, '0.12' );
    numFailed += safeRoundTest( '0e0', 0, '0' );
    numFailed += safeRoundTest( '1.2e3', 0, '1200' );
    numFailed += safeRoundTest( '1.2e+3', 0, '1200' );
    numFailed += safeRoundTest( '1.2e-3', 0, '0' );
    numFailed += safeRoundTest( '1.2e-3', 3, '0.001' );
    numFailed += safeRoundTest( '1.2e-3', 4, '0.0012' );
    numFailed += safeRoundTest( '1.2e-3', 5, '0.0012' );
    numFailed += safeRoundTest( '+12.', 0, '12' );
    numFailed += safeRoundTest( '+.12', 2, '0.12' );
    numFailed += safeRoundTest( '+0e0', 0, '0' );
    numFailed += safeRoundTest( '+1.2e3', 0, '1200' );
    numFailed += safeRoundTest( '+1.2e+3', 0, '1200' );
    numFailed += safeRoundTest( '+1.2e-3', 0, '0' );
    numFailed += safeRoundTest( '+1.2e-3', 3, '0.001' );
    numFailed += safeRoundTest( '+1.2e-3', 4, '0.0012' );
    numFailed += safeRoundTest( '+1.2e-3', 5, '0.0012' );
    numFailed += safeRoundTest( '-12.', 0, '-12' );
    numFailed += safeRoundTest( '-.12', 2, '-0.12' );
    numFailed += safeRoundTest( '-0e0', 0, '0' );
    numFailed += safeRoundTest( '-1.2e3', 0, '-1200' );
    numFailed += safeRoundTest( '-1.2e+3', 0, '-1200' );
    numFailed += safeRoundTest( '-1.2e-3', 0, '0' );
    numFailed += safeRoundTest( '-1.2e-3', 3, '-0.001' );
    numFailed += safeRoundTest( '-1.2e-3', 4, '-0.0012' );
    numFailed += safeRoundTest( '-1.2e-3', 5, '-0.0012' );
    numFailed += safeRoundTest( '9876.543e210', 0, '9.876543e+213' );
    numFailed += safeRoundTest( '9876.543e210', -210, '9.877e+213' );
    numFailed += safeRoundTest( '9876.543e210', -209, '9.8765e+213' );
    numFailed += safeRoundTest( '9876.543e+210', 0, '9.876543e+213' );
    numFailed += safeRoundTest( '9876.543e+210', -210, '9.877e+213' );
    numFailed += safeRoundTest( '9876.543e+210', -209, '9.8765e+213' );
    numFailed += safeRoundTest( '9876.543e-210', 213, '9.876543e-207' );
    numFailed += safeRoundTest( '9876.543e-210', 210, '9.877e-207' );
    numFailed += safeRoundTest( '9876.543e-210', 211, '9.8765e-207' );
    console.log( 'numFailed', numFailed );
}

safeRoundTests(); 
```

* * *

## 回答 #87

> 赞同：-1
> 
> 时间：2022-01-17T05:58:14.227

如果您在项目中使用 lodash，那么只需执行

```
_.round(value, 2);
```

* * *

## 回答 #88

> 赞同：-9
> 
> 时间：2013-07-28T09:01:31.717

我仍然认为没有人给他答案，告诉他如何只在需要时进行四舍五入。我看到的最简单的方法是检查数字中是否有小数，如下所示：

```
var num = 3.21;
if ( (num+"").indexOf('.') >= 0 ) { //at least assert to string first...
    // whatever code you decide to use to round
} 
```**

# php - 在 PHP 和 Perl 之间传递大量数据

> ID：11832915
> 
> 赞同：2
> 
> 时间：2012-08-06T17:17:54.527
> 
> 标签：php, perl, ipc

我有一个 perl 脚本，它对大量数据执行操作并构建一个表。我想从 PHP 调用这个脚本。我正在传递包含字符串、引号和各种讨厌的表格数据，所以很简单

```
 passthru('./path/to/pl $var1 $var2'); 
```

不会的。我正在考虑对数据进行 JSON 编码，然后对 JSON 进行 base64 编码并传递如下：

```
 passthru('./path/to/pl "$base64edJSON"'); 
```

这是正确的方法还是有更好的方法？perl 脚本必须通过 return、stdout 或其他方式将完成的表返回给 PHP 脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:26:55.643

[您可以使用proc_open](http://www.php.net/manual/en/function.proc-open.php)调用 perl 脚本。然后您可以通过标准输入将输入提供给它，并从标准输出获取输出/错误。Perl 脚本将作为管道运行。

这解决了临时文件的任何混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:27:51.710

在 PHP 端，[打开一个](http://php.net/proc_open)到 Perl 进程的双向管道并写入它的管道。在 Perl 方面，从 STDIN 读取。

要返回数据，请在 Perl 中写入 STDOUT。在 PHP 中，从管道中读取。

您不需要编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T17:23:22.933

我会将 PHP 中的内容序列化为一个文件，然后将其加载到 Perl 中。您可以使用 CPAN 模块[PHP::Serialization](http://p3rl.org/PHP%3a%3aSerialization)。

# php - 模型类应该代表一个实体还是返回它

> ID：11832921
> 
> 赞同：11
> 
> 时间：2012-08-06T17:18:14.183
> 
> 标签：php, model-view-controller, codeigniter

我正在使用[CodeIgniter](http://codeigniter.com/)设计一个 Web 应用程序（但我认为这个问题通常适用于 Web 应用程序中的[MVC](http://en.wikipedia.org/wiki/Model_view_controller)模式）。

当我为某些数据库实体设计模型类时（例如，`BlogEntry`用于说明的 a），我基本上有两种选择：

“经典的OOP”方法是，让类*代表*实体，即类的一个实例*是*BlogEntry。在 CodeIgniter 中，这将导致类似的代码

```
class Blogentry extends CI_Model {
    function load($id) {
      // Access database
      $this->id = $dbresult.id;
      $this->title = $dbresult.title;
      $this->author = $dbresult.author;
    }
} 
```

要访问一些博客条目，我会做一个`$this->load->model('blogentry');`, 调用`$this->blogentry->load($id)`，然后使用模型类实例。

我在野外经常看到的另一种方法是让模型以某种数据结构*返回*实体。在代码中：

```
class Blogentry extends CI_Model {
  function get_entry($id) {
    // Access database, yielding $dbresult
    return $dbresult;
} 
```

有了这个我会写

```
$this->load->model('blogentry');
$the_entry = $this->blogentry->get_entry($id); 
```

在控制器中并使用`$the_entry`. 在第二种情况下，该类更像是[工厂](http://en.wikipedia.org/wiki/Factory_pattern)或[构建器](http://en.wikipedia.org/wiki/Builder_pattern)类。

这两种方法中的任何一种都被认为是在 MVC 中执行 M 的“正确方法”吗？我想，我经常看到第二种方法，但我没有看过那么多 MVC-Webapps。关于为什么第一种或第二种方法可能更合适的任何想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T17:52:11.033

首先，CodeIgniter**不是**MVC 框架。最适合的范例可能是*MVP*或类似*ORM-Template-Adapter 的*东西。因此，让我根据该命名谬误分解我的答案：

在经典/传统 MVC（不是框架声称的 MVC）中，模型不是一个类或单个文件，而是**一个**包含所有领域业务逻辑的层，通常仅由诸如[Domain Objects](http://c2.com/cgi/wiki?DomainObject)之类的东西组成，[Data Mappers](http://martinfowler.com/eaaCatalog/dataMapper.html)，以及处理调用实体和域逻辑之间的接口的东西，以便将此类代码保持在控制器之外（例如在 MVC 中）。[Tereško 将它们命名为“服务”](https://stackoverflow.com/questions/5863870/how-should-a-model-be-structured-in-mvc/5864000#5864000)，这对于一个准官方名称来说已经足够了。

所以在传统的 MVC 中，对模型层 com 的请求是通过“服务”进入的，而这些服务又与域对象和数据映射器交互。

显然，所有这些都与 CodeIgniter 和其他框架所称的“MVC”无关。在这种设计模式（我简称为“CIMVC”）中，Model 是一个由 Controller 调用和操作的类，它直接与数据库交互。将数据存储在模型中的成员变量中并没有太多的语义意义，但如果您对类似的东西感兴趣，请查看任何用 CIMVC 编写的 ORM 插件/库。（虽然 ORM 解决方案在符合传统 MVC 方面不会更好......）

至于常见的做法，我见过的大多数 CI 应用程序会将“原始”数据库数据返回给控制器进行处理；这将域业务逻辑保留在模型中。我个人对 CIMVC 的偏好是最小化/消除模型中除域业务逻辑之外的任何内容。

tl;dr - CodeIgniter 中的“传统/正确”MVC 基本上是不可能的，因此试图强制您的 CI 代码符合传统 MVC 范例是愚蠢的（并且可能会让您发疯）

**编辑：**为了澄清之前对模型层中业务逻辑的一些混淆，是的，您应该在模型层中拥有**所有**业务逻辑。但是，如果正在进行额外的数据处理（排序、操作等），现在我们进入了违反 DRY 和 SRP 的危险区域；您希望模型是可重用的，因此要小心添加太多或如此专门的逻辑，以至于它在应用程序的其他部分变得无法使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T20:19:07.670

这是与 MVC 范式相关的通用答案，因为我在 CI 方面的经验为 0，但在 Symfony、Zend、Propel 和 Doctrine 方面有丰富的经验。

我发现，在使用原则时，在特定结构中返回对象数据最好添加一个指定所述结构的方法。例如，Doctrine_Record 对象有一个`toArray()`方法允许我将对象转换为数组，因此我可以使用对象访问器或调用`toArray(`) 并将对象作为数组处理。

```
// Accessing object data through available methods
foreach ($object->categories() as $category) {
    var_dump((string) $category);
}

// Accessing object data as an array
$objectAsArray = $object->toArray(true);

foreach ($objectAsArray as $element) {
    var_dump($element['Category']);
} 
```

归根结底，您访问数据的方式取决于您的偏好，完全取决于您希望如何处理数据以满足您的需求。在某些情况下，处理数组格式的数据会更快，因为对象水合往往会更多地影响性能。

无论您如何访问数据，我建议您将业务逻辑保留在模型层，这样您就不会最终重复代码（DRY：不要重复自己）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T03:11:33.980

首先你必须了解的是，CodeIgniter 与正确的 MVC 或 MVC 启发的设计模式相去甚远。CodeIgniter 实现的模式没有正式名称，但它与 Ruby on Rails 密切相关。

最严重的问题源于模型层是如何实现的。在整个文档中，建议使用[活动记录](http://martinfowler.com/eaaCatalog/activeRecord.html)模式，它本身就引入了几个设计问题：

*   [活动记录与对象](http://blog.objectmentor.com/articles/2007/11/02/active-record-vs-objects)
*   [ORM 反模式 - 第 1 部分：Active Record](http://www.mehdi-khalili.com/orm-anti-patterns-part-1-active-record)
*   [高级 OO 模式](https://vimeo.com/21173483#t=2136) ^([[幻灯片]](http://qafoo.com/talks/11_11_osidays_advanced_oo_patters.pdf))

另一个主要问题是缺乏意见。视图应该是包含表示逻辑的实例。这包括选择使用哪些模板来表示从模型层获取的信息。*视图不是模板，它们是使用模板的结构。*

在 CodeIgniter 之上创建适当模型层的最佳方法是忽略[`CI_Model`](https://github.com/EllisLab/CodeIgniter/blob/develop/system/core/Model.php)，因为恕我直言，扩展此类没有任何好处。而是创建类似`Services`. 这些结构可以充当与模型层交互的接口（不是 OO 意义上的）。每个*服务*可以处理多个[域对象](http://c2.com/cgi/wiki?DomainObject)和[映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)。

基本上服务从控制器接收命令/消息，这些命令/消息改变模型层的状态并提供从模型层提取信息的方法。通常提取会发生在*视图*实例中，但这在 CodeIgniter 中是不可能的。信息的提取也将发生在“控制器”中，将数据传递给模板。

代码看起来像这样：

```
class Library 
{

    protected $current_document = null;

    public function acquire_document( $id )
    {
        $document = load_class('Document', 'domain_object');
        $document->set_id( $id );

        $mapper = load_class('Document', 'persistence');
        $mapper->fetch( $document );

        $this->current_document = $document;
    }

    public function get_document_information()
    {
        $document = $this->current_document;        

        if ( $document === null )
        {
            return 'empty';
            // you either did not acquire the document
            // or document was not found
        }
        return $document->get_details();
    }
} 
```

MVC 设计模式实际上是两层的组合：模型层和表示层（应该主要由控制器和视图组成）。

**控制器永远不应该直接接触域对象（它们是模型层的一部分），因为这意味着你有一个泄漏的抽象。**

因此，总而言之，您所谓的“模型类”应该返回信息。

# coffeescript - 在咖啡脚本中缺乏隐含的 this

> ID：11832922
> 
> 赞同：1
> 
> 时间：2012-08-06T17:18:19.567
> 
> 标签：coffeescript

这是我的咖啡脚本代码。

```
class Hello
  constructor: ->
    @greetings()
    this.greetings()
    greetings()

  greetings: ->
    alert 'hello world'

new Hello 
```

这段代码翻译成

```
var Hello;

Hello = (function() {

  function Hello() {
    this.greetings();
    this.greetings();
    greetings();
  }

  Hello.prototype.greetings = function() {
    return alert('hello world');
  };

  return Hello;

})();

new Hello; 
```

在咖啡脚本代码的第三种情况下，我既不使用`@`也不使用`this`. 我假设咖啡脚本会使用隐含的 this，但事实并非如此。

我做了一个快速的谷歌搜索，但没有得到任何结果。所以任何人都可以确认coffeescript不支持隐式这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T17:27:01.527

Coffeescript 不支持隐式`this`。主要是因为咖啡脚本实际上只是 javascript 的糖，而在 javascript 中这将是一个非常糟糕的主意，因为函数是第一类对象并且可以分配给局部变量。

那么如何访问局部变量呢？

```
a = -> 123
@a = -> 456

// normal coffeescript
a() # 123

// with implicit this
a() # 123 or 456? Impossible to know. 
```

重要的是要记住，在 java 脚本中`var a;`，`this.a`彼此没有关系，并且始终是 2 个单独的变量。知道什么时候你在解决什么是真正重要的。

最后，这就是`@`创建符号的原因。在 javascript 中使用基于类的样式时，到处引用`this`with`this.propName`的属性变得非常普遍。 `@`以这种方式编程时，添加到咖啡脚本中将不那么乏味和烦人。

# windows - 使用 Mail::Sendmail 使用 Windows 机器从 perl 脚本发送电子邮件时出错

> ID：11832929
> 
> 赞同：2
> 
> 时间：2012-08-06T17:18:43.827
> 
> 标签：windows, perl, email, sendmail

我有一个简单的测试脚本，用于使用 cpan 模块 Mail::Sendmail 向自己发送电子邮件。我正在使用 Strawberry Perl 并通过命令行在 Windows 机器上操作，一切似乎都很好。我收到一条错误消息`connect to localhost failed (No connection could be made because the target machine refused it.)`

我的脚本是：

```
use Mail::Sendmail qw(sendmail %mailcfg);
$mailcfg{from} = 'dhagan@idatech.com';

print "Testing Mail::Sendmail version $Mail::Sendmail::VERSION\n";
print "Default server:  $Mail::Sendmail::mailcfg{smtp}->[0]\n";
print "Default sender:  $Mail::Sendmail::mailcfg{from}\n";

%mail = (   To      =>  'dhagan@email.com',
            From    =>  'dhagan@email.com',
            Message =>  'Test!'

        );

sendmail(%mail) or die $Mail::Sendmail::error;

print "OK.  Log says:\n", $Mail::Sendmail::log; 
```

有什么理由会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:59:14.707

默认情况下，Mail::Sendmail 配置为将邮件发送到本地主机，但您没有在本地运行 SMTP 服务器。

您必须配置合适的服务器 - 请参阅帮助。

```
 Default SMTP server(s)
       This is probably all you want to configure. It is usually done
       through $mailcfg{smtp}, which you can edit at the top of the
       Sendmail.pm file.  This is a reference to a list of SMTP servers.
       You can also set it from your script:

       "unshift @{$Mail::Sendmail::mailcfg{'smtp'}} , 'my.mail.server';"

       Alternatively, you can specify the server in the %mail hash you
       send from your script, which will do the same thing:

       "$mail{smtp} = 'my.mail.server';" 
```

# html - HTML Input="file" 接受属性文件类型 (CSV)

> ID：11832930
> 
> 赞同：632
> 
> 时间：2012-08-06T17:18:50.237
> 
> 标签：html, csv, file-upload, input, content-type

我的页面上有一个文件上传对象：

```
<input type="file" ID="fileSelect" /> 
```

在我的桌面上使用以下 excel 文件：

> 1.  文件1.xlsx
> 2.  文件 1.xls
> 3.  文件.csv

我希望文件上传***只***显示`.xlsx`, `.xls`, &`.csv`文件。

使用该`accept`属性，我发现这些内容类型负责`.xlsx`&`.xls`扩展...

> `accept`= 应用程序/vnd.openxmlformats-officedocument.spreadsheetml.sheet (.XLSX)
> 
> `accept`= 应用程序/vnd.ms-excel (.XLS)

但是，我找不到 Excel CSV 文件的正确内容类型！有什么建议么？

示例：http: [//jsfiddle.net/LzLcZ/](http://jsfiddle.net/LzLcZ/)

* * *

## 回答 #1

> 赞同：1629
> 
> 时间：2012-08-06T19:45:58.830

嗯，这很尴尬......我找到了我正在寻找的解决方案，而且再简单不过了。我使用以下代码来获得所需的结果。

```
<input id="fileSelect" type="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" /> 
```

## 有效接受类型：

对于**CSV**文件 (.csv)，请使用：

```
<input type="file" accept=".csv" /> 
```

对于**Excel 文件 97-2003** (.xls)，请使用：

```
<input type="file" accept="application/vnd.ms-excel" /> 
```

对于**Excel 文件 2007+** (.xlsx)，请使用：

```
<input type="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" /> 
```

对于**文本文件**(.txt)，请使用：

```
<input type="file" accept="text/plain" /> 
```

对于**图像文件**(.png/.jpg/etc)，请使用：

```
<input type="file" accept="image/*" /> 
```

对于**HTML 文件**(.htm,.html)，请使用：

```
<input type="file" accept="text/html" /> 
```

对于**视频文件**（.avi、.mpg、.mpeg、.mp4），请使用：

```
<input type="file" accept="video/*" /> 
```

对于**音频文件**（.mp3、.wav 等），请使用：

```
<input type="file" accept="audio/*" /> 
```

对于**PDF 文件**，请使用：

```
<input type="file" accept=".pdf" /> 
```

演示：http:
[//jsfiddle.net/dirtyd77/LzLcZ/144/](http://jsfiddle.net/dirtyd77/LzLcZ/144/)

* * *

*笔记：*

如果您尝试显示 Excel CSV 文件 ( `.csv`)，***请勿***使用：

*   `text/csv`
*   `application/csv`
*   `text/comma-separated-values`（*仅适用于 Opera*）。

* * *

如果您尝试显示*特定的文件类型*（例如 a`WAV`或`PDF`），那么这几乎总是可以工作...

```
 <input type="file" accept=".FILETYPE" /> 
```

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2017-09-19T20:21:48.197

这些天你可以只使用文件扩展名

```
<input type="file" ID="fileSelect" accept=".xlsx, .xls, .csv"/> 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-08-06T17:54:04.277

据我所知，Dom 这个属性很老，在现代浏览器中不被接受，但是这里有一个替代方法，试试这个

```
<script type="text/javascript" language="javascript">
function checkfile(sender) {
    var validExts = new Array(".xlsx", ".xls", ".csv");
    var fileExt = sender.value;
    fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
    if (validExts.indexOf(fileExt) < 0) {
      alert("Invalid file selected, valid files are of " +
               validExts.toString() + " types.");
      return false;
    }
    else return true;
}
</script>

<input type="file" id="file" onchange="checkfile(this);" /> 
```

我想它会帮助你当然你可以根据你的需要改变这个脚本。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-03-05T20:16:10.873

我`text/comma-separated-values`在接受属性中使用了 CSV mime-type，它在 Opera 中运行良好。尝试`text/csv`没有运气。

如果建议不起作用，则其他一些用于 CSV 的 MIME 类型：

*   文本/逗号分隔值
*   文本/csv
*   应用程序/csv
*   应用程序/excel
*   应用程序/vnd.ms-excel
*   应用程序/vnd.msexcel
*   文本/任何文本

来源： http: [//fileext.com/file-extension/CSV](http://filext.com/file-extension/CSV)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-04-04T08:01:16.613

这在 Safari 10 下对我不起作用：

```
<input type="file" accept=".csv" /> 
```

我不得不写这个：

```
<input type="file" accept="text/csv" /> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-19T03:58:57.153

您只需执行以下操作即可知道任何文件的正确内容类型：

1）选择感兴趣的文件，

2）并在控制台中运行：

```
console.log($('.file-input')[0].files[0].type); 
```

您还可以为您的输入设置属性“multiple”，以一次检查多个文件的内容类型，然后执行以下操作：

```
for (var i = 0; i < $('.file-input')[0].files.length; i++){
    console.log($('.file-input')[0].files[i].type);
} 
```

属性接受对多个属性有一些问题，在这种情况下无法正常工作。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-09-30T07:53:52.963

除了最佳答案之外，例如，CSV 文件在 macOS 下报告为 text/plain，但在 Windows 下报告为 application/vnd.ms-excel。所以我用这个：

```
<input type="file" accept="text/plain, .csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" /> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-08-10T16:35:00.777

我已经修改了@yogi 的解决方案。另外，当文件格式不正确时，我会重置输入元素值。

```
function checkFile(sender, validExts) {
    var fileExt = sender.value;
    fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
    if (validExts.indexOf(fileExt) < 0 && fileExt != "") {
        alert("Invalid file selected, valid files are of " +
                 validExts.toString() + " types.");
        $(sender).val("");
        return false;
    }
    else return true;
} 
```

我有自定义验证内置，因为在打开的文件窗口中，用户仍然可以选择“所有文件（'*'）”选项，无论我是否在输入元素中明确设置了接受属性。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-11-20T08:22:33.627

经过我的测试，在【macOS 10.15.7 Catalina】上，【Dom / Rikin Patel】的回答无法正常识别[.xlsx]文件。

我个人总结了大部分现有答案的做法，并通过了个人测试。总结以下答案：

> ```
> accept=".csv, .xls, .xlsx, text/csv, application/csv,
> text/comma-separated-values, application/csv, application/excel,
> application/vnd.msexcel, text/anytext, application/vnd. ms-excel,
> application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" 
> ```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-11-06T13:45:07.010

现在您可以使用新的 html5 输入验证属性`pattern=".+\.(xlsx|xls|csv)"`。

# uitableview - Objective-C 优化 filterContentForSearchText 中的排序：

> ID：11832935
> 
> 赞同：1
> 
> 时间：2012-08-06T17:19:11.280
> 
> 标签：uitableview, ios5, nspredicate, objective-c-blocks

我有一个带有搜索栏的表格视图。该表加载了 3700 个文本对象。搜索发生在“标题”文本上，平均长度为 35 个字符。我正在寻找任何可以加快搜索排序过程的优化建议。目前，搜索排序平均耗时 0.733 秒，约占整个搜索执行时间的 95%。我正在使用一个使用 CONTAINS 的谓词（不幸的是必须），然后是 sortedArrayUsingComparator:，我在其中传递了一个块。

谢谢参观！

这是我正在做的事情：

```
 //My sorting block implementation
    self.mySortBlock = ^NSComparisonResult(id obj1, id obj2) {
        Tip *tip1 = obj1;
        Tip *tip2 = obj2;

        NSString *string1 = [tip1.subject lowercaseString];
        NSString *string2 = [tip2.subject lowercaseString];

        NSUInteger searchStringLocation1 = [string1 rangeOfString:[self.userSearchText lowercaseString]].location;
        NSUInteger searchStringLocation2 = [string2 rangeOfString:[self.userSearchText lowercaseString]].location;

        if (searchStringLocation1 > searchStringLocation2) return NSOrderedDescending;
        if (searchStringLocation1 < searchStringLocation2) return NSOrderedAscending;
        return NSOrderedSame;
    };

 - (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope
{

    NSPredicate *filter = [NSPredicate predicateWithFormat:@"subject CONTAINS [cd] %@", searchText];
    NSArray *filtered = [myArray filteredArrayUsingPredicate: filter];
    self.sorted = nil; 
    self.sorted = [filtered sortedArrayUsingComparator:self.mySortBlock];

} 
```

**编辑** 根据 Catfish_Man 下面的建议，我重构了排序块以不实例化块内的对象，除非绝对必要。我删除了 4 个对象实例化。重构带来了 +300% 的速度提升：

![在此处输入图像描述](../Images/3df116344de86a6fd422812edf671eae.png)

这是重构的排序块：

```
self.mySortBlock = ^NSComparisonResult(id obj1, id obj2) {

    NSUInteger searchStringLocation1 = [[obj1 subject] rangeOfString:self.userSearchText options:NSCaseInsensitiveSearch].location;

    NSUInteger searchStringLocation2 = [[obj2 subject] rangeOfString:self.userSearchText options:NSCaseInsensitiveSearch].location;

     if (searchStringLocation1 > searchStringLocation2) return NSOrderedDescending;
     if (searchStringLocation1 < searchStringLocation2) return NSOrderedAscending;
     return NSOrderedSame;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:35:17.887

我看到的最重要的事情：您在排序函数中分配了 4 个对象。对象分配不是很快！相反，尝试使用 -rangeOfString:options: 并传递 NSCaseInsensitiveSearch。

# tomcat - Tomcat web.xml 配置变量

> ID：11832942
> 
> 赞同：2
> 
> 时间：2012-08-06T17:19:54.450
> 
> 标签：tomcat, servlets, configuration, web.xml

我的Java Web 应用程序在war 文件中包含一个配置文件（例如myapp.xml）。我在 web.xml 文件中提供了该文件的路径，如下所示。

```
 <servlet>
    <servlet-name>wc</servlet-name>
    <servlet-class>com.myapp.servlets.WC</servlet-class>
    <init-param>
      <param-name>configfile</param-name>
      <param-value>${catalina.base}/webapps/myapp/WEB-INF/myapp.xml</param-value>
    </init-param>
  </servlet> 
```

问题是我现在想在同一台服务器上部署各种版本进行测试和开发，每个版本在 webapps 下都有不同的路径。我想避免为每个部署修改 web.xml 文件，但我找不到任何方法来引用 WEB-INF 文件夹。

这就是我想做的：

```
 <servlet>
    <servlet-name>wc</servlet-name>
    <servlet-class>com.myapp.servlets.WC</servlet-class>
    <init-param>
      <param-name>configfile</param-name>
      <param-value>${app.base}/myapp.xml</param-value>
    </init-param>
  </servlet> 
```

其中**${app.base} == ${catalina.base}/webapps/myapp/WEB-INF**

是否有一些可用的变量可以为我提供应用程序目录的路径？

如果没有，你能想出其他方法来实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:03:10.983

您可以将变量 with 传递`-Dapp.base=/foo/bar`给 tomcat 的 JVM（取决于 catalina.sh 或 /conf 中的文件中的版本），然后在 WC servlet 中使用 `System.getProperty(..) 读取它。

尽管建议将这些配置放在外部位置，这样您就可以在不接触已部署应用程序的情况下更改它们，并且如果需要，还可以启用未打包的 WAR 部署。

如果您想访问应用程序中的资源，那么您最好使用相对（而不是绝对）路径。

*   如果资源在类路径上，请使用`getClass().getResourceAsAstream(..)`
*   如果资源在类路径之外，请使用`servletContext.getResourceAsStream(..)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:03:48.987

您可以使用

```
...
servletContext().getRealPath("");
... 
```

获取应用程序的物理主目录。

# java - 如何加快摆动动画的速度？

> ID：11832943
> 
> 赞同：1
> 
> 时间：2012-08-06T17:19:57.933
> 
> 标签：java, swing, animation, bufferedimage

我正在将动画绘制到摇摆 JPanel 上。1024x1024 屏幕被分成 2000 块，它们完全覆盖屏幕（没有重叠）。

每一块都是屏幕的一小块（占屏幕的 1/2000）。通过更改缓冲图像中的像素并调用 reaint()，动画每毫秒绘制一个片段。所以在整个屏幕上每 2 秒变化一次。动画在 java.util.Timer 任务中运行。

缓冲的图像没有加速并且不是易失性的。我将它的优先级设置为1。

框架根窗格已优化。前缓冲器和后缓冲器都被加速但不挥发。

这工作正常。

分析表明几乎所有的图形时间都花在绘制缓冲图像上，正如人们所期望的那样，使用一些脏矩形似乎并不能帮助减少绘制时间。

如果我用它的确切形状剪辑缓冲图像的绘图，则该部分被绘制并且屏幕的其余部分变为白色。

我想要的是让屏幕的其余部分保持原样，只绘制剪裁的形状。

为每个部分制作像素需要混合 10 层，因此需要进行一些计算。可以/应该在 awt 计时器线程中做得更好吗？

或者我应该使用画布和更新技巧[http://java.sun.com/products/jfc/tsc/articles/painting/src/UpdateDemo.java](http://java.sun.com/products/jfc/tsc/articles/painting/src/UpdateDemo.java)

我看到的建议包括 Toolkit.getDefaultToolkit().setDynamicLayout(true); System.setProperty("sun.awt.noerasebackground","true");

其他建议包括立即绘制，以及子类化 JComponent 而不是 JPanel。

我觉得这一切都有些令人困惑。

我想尽可能地保持这个操作系统独立，但该应用程序将主要在 Windows 7 上运行。

我在这里采取的下一个（小）合乎逻辑的步骤是什么？

更新：使用画布（没有更新技巧）显着减少了绘制缓冲图像所花费的时间。我找不到它，而不是在分析器的顶线上！当我使用面板时，我可能做的比我应该做的更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:58:43.157

这里有一些建议：

*   `repaint()`对每一毫秒的需求进行批判性检查；特别是，看看是否可以合并一些更新。

*   考虑 的便利性[`java.swing.Timer`](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)，它在 EDT 上呈现并支持合并事件。

*   不需要缩放时调用`drawImage()`速度最快，如下所示[`AnimationTest`](https://stackoverflow.com/a/3256941/230513)。

*   总是尽可能地预先计算图像，正如本文所建议的那样，[`KineticModel`](https://sites.google.com/site/drjohnbmatthews/kineticmodel)它说明了几种动画技术。

*   `TexturePaint`, 用于`KineticModel`, 也在[这里](https://stackoverflow.com/a/11556441/230513)显示。

*   `IndexColorModel`,[在这里](https://stackoverflow.com/a/7546025/230513)说明, 可能适用。

*   sscce将允许您隔离各种方法以便于分析[。](http://sscce.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:21:26.343

**编辑为更好的例子**

本质上，我们可以使用`RepaintManager`来跟踪/更新我们每毫秒更改的几个像素。肮脏的区域会累积，直到油漆真正能够发生。当绘制发生时，它使用`paintImmediately(int x, int y, int w, int h)`函数（除非整个组件是脏的）——所以我们只更新图像的一小部分就可以了。希望示例代码不依赖于操作系统 - 如果它不适合您，请告诉我。

```
import java.awt.*;
import java.awt.image.BufferedImage;

import javax.swing.*;

public class UpdatePane extends JPanel{
    final int MAX = 1024;

    //The repaint manager in charge of determining dirty pixels
    RepaintManager paintManager = RepaintManager.currentManager(this);

    //Master image
    BufferedImage img = new BufferedImage(MAX, MAX, BufferedImage.TYPE_INT_RGB);

    @Override
    public void paintComponent(Graphics g){
        g.drawImage(img, 0, 0, null);
    }

    public void paintImmediately(int x, int y, int w, int h){
        BufferedImage img2 = img.getSubimage(x, y, w, h);
        getGraphics().drawImage(img2, x, y, null);
    }

    public static void main(String... args) {
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                final UpdatePane outside = new UpdatePane(); 

                outside.setPreferredSize(new Dimension(1024,1024));

                JFrame frame = new JFrame();
                frame.add(outside);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.pack();
                frame.setVisible(true);

                outside.new Worker().execute();
            }
        });
        }

    //Goes through updating pixels (like your application would)
    public class Worker extends SwingWorker<Integer, Integer>{
        int currentColor = Color.black.getRGB();
        public int x = 0;
        public int y = 0;
        @Override
        protected Integer doInBackground() throws Exception {
            while(true){
                if(x < MAX-1){
                    x++;
                } else if(x >= MAX-1 && y < MAX-1){
                    y++;
                    x = 0;
                } else{
                    y = 0;
                    x = 0;
                }

                if(currentColor < 256){
                    currentColor++;
                } else{
                    currentColor = 0;
                }

                img.setRGB(x, y, currentColor); 

                //Tells which portion needs to be repainted [will call paintImmediately(int x, int y, int w, int h)]
                paintManager.addDirtyRegion(UpdatePane.this, x, y, 1, 1);
                Thread.sleep(1);
            }
        } 

    }
} 
```

# asp.net-mvc - 如何将 json 对象从 Javascript 传递到 asp.net mvc 控制器

> ID：11832948
> 
> 赞同：5
> 
> 时间：2012-08-06T17:20:25.780
> 
> 标签：asp.net-mvc

我刚开始 MVC 所以有很多困惑。每当我们在 asp.net webform 项目中通过 jquery 调用任何服务器端函数时，该方法必须是静态的，并且必须由 webmethod 属性修饰。所以我想知道在 mvc 的情况下也适用相同的规则。

我得到了一个代码，但我没有测试它。

## 客户端方法

```
function getTradeContribs(id,pfid, nodedates) {

    var data = {};
    data.portfolioId = pfid;
    data.nodedates = nodedates;

    $.ajax({
            type: "POST",
            url: "/Portfolios/getTradeContribs/"+id,
            dataType: "json",
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            success: parseTradeContribs,
            error: function (error) {
                    alert("failed in opening XML file !!!");
            }
    });
   } 
```

## 服务器端方法

```
public string getTradeContribs(int id,string portfolioId, string nodedates)
{
    string jsonTest = @" {""nodedates"": ""date"":""01/01/2012""}";
    return jsonTest;
} 
```

从上面的代码我有几个问题 1）mvc 中存在多少类型的控制器方法 2）**url：“/Portfolios/getTradeContribs”，**它是什么类型的 url。Portfolios 是控制器名称，而 getTradeContribs 是操作名称？如果没有，那么 getTradeContribs 是一种什么样的方法。

3) getTradeContribs 没有返回 ActionResult 为什么 4) ActionResult 的意义是什么？5) 为什么 id 作为查询字符串传递，其余数据作为 json 传递。它将如何工作？

请讨论这一点，因为我是 mvc 的新手

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T17:42:28.677

> 每当我们在 asp.net webform 项目中通过 jquery 调用任何服务器端函数时，该方法必须是静态的，并且必须由 webmethod 属性修饰。所以我想知道在 mvc 的情况下也适用相同的规则。

一点都不。ASP.NET MVC 是一种完全不同的模式。在 ASP.NET MVC 中，您使用返回操作结果的控制器操作（从 ActionResult 派生的类）。因此，如果您想返回 JSON，您只需定义一个返回 a`JsonResult`并将模型传递给它的控制器操作：

```
public ActionResult GetTradeContribs(int id, string portfolioId, string nodedates)
{
    var model = new 
    {
        nodedates = "foo",
        date = DateTime.Now
    };
    return Json(model, JsonRequestBehavior.AllowGet);
} 
```

甚至更好地定义视图模型：

```
public class TradeContribsRequestViewModel
{
    public int Id { get; set; }
    public string PortfolioId { get; set; }
    public string NodeDates { get; set; }
}

public class TradeContribsViewModel
{
    public string NodeDates { get; set; }
    public DateTime Date { get; set; }
} 
```

接着：

```
public ActionResult GetTradeContribs(TradeContribsRequestViewModel request)
{
    var model = new TradeContribsViewModel
    {
        NodeDates = "foo",
        Date = DateTime.Now
    };
    return Json(model, JsonRequestBehavior.AllowGet);
} 
```

ASP.NET MVC 会自动将模型序列化为 JSON 字符串并将其传递给视图。然后你可以使用 ajax 调用它：

```
$.ajax({
    url: '@Url.Action("GetTradeContribs", "Portfolios")',
    type: 'POST',
    data: { 
        id: 123, 
        portfolioId: 'some id', 
        nodedates: 'some node dates' 
    },
    success: function(result) {
        // You could directly use the properties of the result object here
        // like for example: alert(result.nodedates);
    }
}); 
```

您绝对不应该像在原始`getTradeContribs`方法中那样对 JSON 进行硬编码。这是框架已经为您处理的基础设施管道。您所需要关心的只是定义：

*   返回 ActionResult 的控制器操作
*   控制器操作将传递给视图的模型类型
*   一个看法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T17:43:18.163

以下是您的问题的一些答案：

1.  *mvc 中存在多少种控制器方法*- 不确定您的意思。控制器中可以通过路由 URL 访问的方法称为控制器操作方法。这些方法使用 ASP.net MVC 应用程序的 Global.asax 文件中的 RouteConfig 类进行映射。
2.  *url: "/Portfolios/getTradeContribs"，它是什么类型的 url* - 这些是宁静的 URL。MVC 框架将这些 URL 映射到控制器内的特定方法（控制器操作）。查看[asp.net mvc 站点](http://www.asp.net/mvc/overview/what-is-mvc)了解 MVC 的基础知识。
3.  *getTradeContribs 没有返回 ActionResult 为什么*- 没有必要从 Controller 操作返回 ActionResult。MVC框架提供了一些actionresults - 例如。ViewResult（显示视图）、JsonResult（返回 JSON 对象）等。在这种情况下，您可以返回字符串或 JsonResult。通过返回字符串，客户端脚本需要将其解析为 JSON 对象，如果您返回 JsonResult，则客户端脚本将使用填充的 JSON 对象。
4.  *ActionResult 的意义是什么*- ActionResult 是一个抽象基类，它将 Controller Action 的结果转换为各种格式（HTML、JSON、XML 等）。这只是呈现控制器操作结果的一种简单方法，或者在您的情况下将结果传递回客户端。
5.  *为什么 id 作为查询字符串传递，其余数据作为 json 传递。它将如何工作*- ASP.Net MVC 框架有一个名为 Model Binder 的组件，它在调用操作方法时将尝试绑定通过查询字符串传入的值和表单 post 值，并将其绑定到方法中的参数。如果您想更改用于将值绑定到参数的逻辑，可以插入您自己的 Modelbinder。

希望这些回答你的问题。但是，在开始使用某项技术之前，您应该了解该技术/框架的基础知识。请不要将此论坛视为学习基础知识的替代品。出于这个原因，我正在贬低你的问题。

# tsql - 在 CASE 语句中处理多个值？

> ID：11832955
> 
> 赞同：0
> 
> 时间：2012-08-06T17:20:49.473
> 
> 标签：tsql

我有一个场景，我试图根据 select 语句中的条件从字段/列中检索多个值。我试图使用案例语句，但问题是案例语句不支持字段/列中的多个值。是否有任何解决方法或任何其他方式来实现这一目标？

```
SELECT col1, col2, col3, Period         
FROM   tblMonthlyCost

WHERE  Period = CASE

    WHEN Datepart(MONTH, Getdate()) = 8 
        AND Datediff(DAY, '07/31/2012', Getdate()) <= 3 THEN Period IN
            ('0112','0212','0312','0412','0512','0612') 
    WHEN Datepart(MONTH, Getdate()) = 8 
        AND Datediff(DAY, '07/31/2012', Getdate()) > 3 THEN Period IN
        ('0112','0212','0312','0412','0512','0612','0712')      
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T17:25:59.080

为什么不这样做呢？

```
SELECT  col1,
        col2,
        col3,
        Period
FROM    tblMonthlyCost
WHERE   Period IN ( '0112', '0212', '0312', '0412', '0512', '0612' )
        AND DATEPART(MONTH, GETDATE()) = 8
        AND DATEDIFF(DAY, '07/31/2012', GETDATE()) <= 3
        OR Period IN ( '0112', '0212', '0312', '0412', '0512', '0612', '0712' )
        AND DATEPART(MONTH, GETDATE()) = 8
        AND DATEDIFF(DAY, '07/31/2012', GETDATE()) > 3 
```

# c# - 如何使用从环境变量配置中设置的变量在 SSIS 包中设置变量？

> ID：11832959
> 
> 赞同：1
> 
> 时间：2012-08-06T17:21:09.923
> 
> 标签：c#, ssis

为相当冗长的标题道歉，但这似乎是描述我遇到的问题的最简短方式。

我正在尝试用 C# 编写一个程序来生成 SSIS 包。我确实有可以用作模板的现有包，并且在现有包中，有一些变量使用其他变量，这些变量使用环境变量填充。例如，有一个名为“RootFolder”的变量，它是使用环境变量设置的，为包建立一个工作文件夹。包中还有另一个名为“OutputFolder”的变量，它采用 RootFolder 变量的值并附加字符串“\Output”。很简单，原始开发人员使用 BIDS Helper 为 OutputFolder 设置以下表达式：@[Template::RootFolder] + "\Output\"

我在 C# 中构建它时遇到了一些问题，因为在创建变量之前似乎没有设置环境变量，因此子变量似乎只有附加数据。使用上面的示例，我的“OutputFolder”变量等于“\OutPut\”。

这是我用来将配置设置为指向环境变量并从 RootFolder 堆叠变量的代码片段。

```
pkg.Variables.Add("FolderRoot", false, "Template", "");

Configuration configRootFolder = pkg.Configurations.Add();
configRootFolder.Name = @"RootFolder";
configRootFolder.ConfigurationType = Microsoft.SqlServer.Dts.Runtime.DTSConfigurationType.EnvVariable;
configRootFolder.ConfigurationString = @"Ssis_RootFolder";
configRootFolder.PackagePath = "\\Package.Variables[Template::FolderRoot].Properties[Value]";

pkg.Variables.Add("OutputFolder", false, "Template", pkg.Variables["Template::FolderRoot"].Value + "\\Output\\"); 
```

任何帮助将不胜感激。提前致谢！富有的

**编辑**：对不起，我意识到我错过了一个重要的细节：

*   使用程序创建包后，RootFolder 变量正在调用环境变量并被正确设置，并且在 Visual Studio 中可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:41:37.977

你可能在这里混淆了一些事情。您有添加变量的代码，然后您正在应用配置，然后您正在尝试添加另一个变量。现在忽略配置步骤，您*应该*在 Template 命名空间中将一个名为 OutputFolder 的变量添加到您的包中。问题是您试图将此变量的值分配为“与 \Output\ 连接的 FolderRoot 的值”，这将在执行代码时进行评估，从而导致您看到的结果为 \Output\

相反，您想要做的是让变量 OutputFolder 的值成为您分配的*表达式。*在您查看属性之前，您会感到有些困惑。

![在此处输入图像描述](../Images/f82f421c67f97aca2dd9afee66a5a956.png)

要使用 BIDS 实现这一点，您需要将该表达式分配给 Expression 属性**并将**EvaluateAsExpression 翻转为 True。在代码中，那是

```
Variable v = null;
v = pkg.Variables.Add("OutputFolder", false, "Template", String.Empty);
v.EvaluateAsExpression = true;
v.Expression = pkg.Variables["Template::FolderRoot"].Value + "\\Output\\"; 
```

在我的博客文章[中使用 SSIS EzAPI 进行变量和表达式的更多编码示例](http://billfellows.blogspot.com/2012/01/variables-and-expressions-with-ssis.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T03:05:04.850

使用 billinkc 提供的方法和链接，我能够使用以下代码让 BIDS 成功生成变量值：

```
Variable v = null;
v = pkg.Variables.Add("OutputFolder", false, "Template", String.Empty);
v.EvaluateAsExpression = true;
v.Expression = "@[Template::FolderRoot] + \"\\\\Output\\\\\""; 
```

请将您的答案信用应用于 billinkc 的答案。

# c++ - C ++中的短路`操作符<<`输出

> ID：11832960
> 
> 赞同：4
> 
> 时间：2012-08-06T17:21:12.797
> 
> 标签：c++

我有一些代码中散布着这样的结构

```
if(debug) {
    Output << "f1: " << f1() << "\n";
} 
```

现在我想做的是写一个流类`Debug`，我可以这样写

```
Debug << "f1: " << f1() << "\n"; 
```

如果设置了一些全局标志，那么这将生成输出，否则不会。

现在：这可以很容易地通过`Debug`返回一个流去`/dev/null`吞掉输出来完成。问题是`f1()`仍然会被评估（并“渲染”成可能更昂贵的文本表示），这可能对性能非常不利。

现在我的问题是：是否有任何技巧可以跳过

```
"f1: " << f1() << "\n" 
```

完全如果`Debug`决定不应该做任何输出？类似于 C++ 为`f() && g()`where`g()`不评估 if `f()`is的短路`false`（我认真考虑编写一个用作输出运算符的流类，`&&`但从我读到的内容来看，短路不是为重载而做的`operator&&`）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T17:36:16.183

你可以做的是定义这个宏：

```
#define Debug_Stream \
if(!debug); else Output 
```

这将使：

```
Debug_Stream << "f1: " << f1() << "\n"; 
```

变得等价于：

```
if(debug) {
    Output << "f1: " << f1() << "\n";
} 
```

但从字面上看（加上空格以提高可读性）

```
if(!debug);
else
    Output << "f1: " << f1() << "\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T17:35:53.753

如果您不反对宏，并且愿意接受以下语法：

```
Debug( "f1: " << f() << '\n' ); 
```

这很简单：只需定义如下内容：

```
#define Debug( x ) debug != NULL && *debug << x; 
```

然而，这有点危险，因为您不能采取通常的预防措施，将论点放在括号中。（另一方面，我已经看到它在许多应用程序中使用，没有问题。）宏方法具有额外的优势，允许您根据 `__FILE__`需要`__LINE__`自动插入。或者通过将宏定义为空，有条件地完全抑制*所有*代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T17:41:35.187

我认为您可以通过创建一个包装昂贵的函数调用的延迟评估器来做到这一点。您的流会知道它需要调用引用函数的延迟评估器类型，否则它不会对其进行操作，从而防止昂贵的调用。no-debug 流知道，对于您的代理评估器对象，只需完全跳过评估。

例如，调用可能如下所示：

```
Debug << "123" << delay(f()) << "456" << std::endl; 
```

这确实涉及记住在调试行中调用延迟。它确实避免了对宏的需要，这在您的情况下可能是也可能不是关键问题。

# git - git 将系统配置文件视为主目录而不是用户主文件夹（Windows 7）

> ID：11832967
> 
> 赞同：8
> 
> 时间：2012-08-06T17:21:29.457
> 
> 标签：git, windows-7, ssh, cmd, bitbucket

我是 git 新手，正在按照[这个 bitbucket 教程](https://confluence.atlassian.com/display/BITBUCKET/Set+up+SSH+for+Git)进行初始设置。在 git bash 窗口中，它显示为 brnt@brntslaptop，但如果我输入：

```
$ ls -a ~/.ssh
ls: /c/windows/system32/config/systemprofile/.ssh: No such file or directory. 
```

我认为这与我是管理员或禁用 UAC 有关，但我不确定最好的方法。

[这个答案是相似的](https://stackoverflow.com/questions/4313342/how-can-i-make-git-to-default-to-my-home-folder)- 但我认为从系统文件夹重定向到用户文件夹不是一个好主意，特别是如果另一个用户有同样的问题。其他类似的答案似乎为解决方案做一个符号链接或类似的。但我还没有找到涉及系统配置文件的。

我还考虑将快捷方式属性“Start In:”从 %HOME% 更改为 %USERPROFILE%，但 ~ 似乎仍然解析为 %HOME%

这种行为正常吗？使“~”或 %HOME% 解析到我的用户目录的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-09T16:15:42.643

只需更改 %HOME%（或实际上是 $HOME，因为 %HOME% 很可能根本没有设置）。
默认情况下`<git-install-dir>\etc\profile`，如果 $HOME 已设置并指向现有目录，则将其设置为 %HOMEDRIVE%%HOMEPATH%，否则设置为 %USERPROFILE%。

因此，您可以编辑该文件，找到该行

```
HOME="$HOMEDRIVE$HOMEPATH" 
```

并删除它或`#`在它前面添加一个以强制使用 %USERPROFILE% 。

或者，在此块之后的任何位置添加一行，将 HOME 明确设置为您想要的。

**编辑：**
在较新版本的 git 中，该行可能不再存在。我在我的最顶部添加了以下内容`etc\profile`（它非常具体且丑陋，但它有效）：

```
#homefix start
HOME=/c/Users/myusername/
HISTFILE=$HOME/.bash_history
export LANG=en_US
# normalize HOME to unix path
export HOME="$(cd "$HOME" ; pwd)"
#homefix end 
```

*该`export LANG...`行可以忽略。我在那里可以在 git gui 和 gitk 的菜单和按钮中获取英文文本，因为 IMO 翻译 git 命令不会增加任何价值，只会造成混乱。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-03T17:45:32.313

我来到这里寻找一个原因，为什么在同一台 Windows 机器上，一个用户可以`git config --list --global`从 PowerShell 命令行使用，而另一个用户却不能。

基本上`$HOME`在 PowerShell 中有一个变量集指向正确的位置；但是，这不是要设置的`git`变量`$env:HOME`。

为了解决这个问题，在无法列出其全局设置的用户上，我们运行了以下 PowerShell 命令：

```
[System.Environment]::SetEnvironmentVariable('HOME',$env:USERPROFILE,'User') 
```

# sed - sed 编辑特定列和特定行

> ID：11832971
> 
> 赞同：1
> 
> 时间：2012-08-06T17:21:47.957
> 
> 标签：sed

我有一个文件，其中每行的第一个字符是格式控制字符，我需要按如下方式编辑格式控制字符：

1.  在第一行更改`1`为`0`
2.  所有其他行 更改`+`为`0`、和`2`到`+``3``+`

是什么`sed`可以做到这

例如输入文件有：

```
1 abcd efg
3 abcd 567
2 abcd 234
+ abcd 123 
```

所需的结果文件：

```
0 abcd efg
+ abcd 567
+ abcd 234
0 abcd 123 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:06:24.490

这是：

```
sed '1{y/1/0/;b}; y/+23/0++/' 
```

或者

```
sed '1y/1/0/; 1!y/+23/0++/' 
```

如果您只想要每行的第一个字符，则需要这样做：

```
sed '1/^1/s::0: ; 1!{ /^[+]/s::0:; /^2/s::+:; /^3/s::+:; }' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:40:47.293

这应该做你想要的。

```
sed -e '1s/^1/0/' -e '1!s/^+/0/' -e '1!s/^[23]/+/' 
```

第一部分处理第一行，下一部分更改 +，最后一部分处理 2 和 3。感叹号表示“对给定行以外的行执行此操作”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T17:27:12.847

术语“控制字符”通常表示“0x00 和 0x1F 之间的字符代码”，有时扩展到包括 0x7F，有时扩展到 0x80 到 0x9F。但是，在上下文中，我怀疑您的意思是（在审查中）该列的第一个字符需要更改。在这种情况下，这个经过轻微修改的脚本应该可以解决问题；修订版添加了`^`以将匹配项锚定到每行的第一个字符。

```
sed -e '1s/^1/0/' -e '2,${s/^+/0/;s/^[23]/+/;}' "$@" 
```

第一个`-e`选项仅在第一行将 1 更改为 0。

第二个`-e`处理其他行。第一个替换处理`+`to `0`; 第二个用`2`or `3`to `+`。

这一切都可以用一个单一的`-e`（或没有明确的`-e`）来完成，但讨论更容易写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T17:37:31.960

乔纳森的解决方案本质上是正确的，但是应用多个命令分隔`;`是不可移植的。（特别是，OS X 上的 BSD sed 不承认这一点。）为了可移植性，最好把它写成：

```
sed -e '1s/^1/0/' -e '1!s/^+/0/' -e '1!s/^[23]/+/' 
```

或者

```
sed -e '1s/^1/0/'  -e '1!{
s/^+/0/
s/^[23]/+/
}' 
```

# database - 在 Django 中使用编码或 manyToMany 字段？

> ID：11832977
> 
> 赞同：0
> 
> 时间：2012-08-06T17:22:13.367
> 
> 标签：database, django

我是 Django 的新手（几乎是 DDBB）。我正在创建两个模型：问题和签名。我想在数据库中进行一些搜索以关注问题的签名。例如搜索历史签名（或生物学等）的 10 个问题。

主要问题是每个问题都可能属于不同的签名（例如数学和物理）。

我想到了 QUESTIONS 模型中的一个整数字段，它提供了签名的信息，例如签名的二进制表示：1010001，其中每个位置都表示相关签名的存在（或不存在）。这样做的问题是，对 BBDD 的了解还不够，而且您必须在确定签名是否关联之前进行计算。

这个操作会不会太慢搜索？

我听说过 manyToMany 领域，这是解决这种情况的更好方法吗？

感谢您的意见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:31:16.150

这很容易通过使用多对多字段来解决。多对多字段所做的是创建第二个表来加入关联。例如，

```
class Signature(models.Model):
    signature=models.CharField()  

class Question(models.Model):
    question=models.CharField()
    signatures=models.ManyToManyField(Signature) 
```

除了 Question 表和 Signature 表之外，还将创建名为 appname_question_signature 的第三个表，其中问题表的主键将映射到签名。由于您可以在此表中有多个条目，因此任何问题都可以映射到任意数量的签名，反之亦然。

并查询你会去的所有历史问题

```
sig=Signature.objects.get(signature="History")
questions=Question.objects.get(signatures=sig) 
```

# objective-c - copyItemAtPath:toPath:error: 正在返回 NO

> ID：11832978
> 
> 赞同：0
> 
> 时间：2012-08-06T17:22:20.590
> 
> 标签：objective-c, macos, nsurl, nsfilemanager, file-copying

我正在阅读的那一章是在讲`NSFileManager`，作者说要创建一个名为`testFile`. 与`testFile`位于同一文件夹下`main.m`。我没有创建`newfile`. 我不能复制`testFile`，这是`returning 2`和一个`NSLog`说法`@"couldnt copy file"`。我试图将 toPath: 的论点设置为`@"/Users/el/Desktop/prog/prog/newfile"`

```
int main (int argc, char *argv[]) {
    @autoreleasepool {
        NSString *fName = @"/Users/el/Desktop/prog/prog/testFile";
        NSFileManager *fm = [NSFileManager defaultManager];

        if ([fm fileExistsAtPath: fName] == NO) {
            NSLog(@"couldnt find file");
            return 1;
        }

        if ([fm copyItemAtPath:fName toPath:@"newfile" error:NULL] == NO) {
            NSLog(@"couldnt copy file");
            return 2;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:40:05.640

第二条路径也必须是绝对的。

```
[fm copyItemAtPath: @"/Users/el/Desktop/prog/prog/testFile" toPath: @"/Users/el/Desktop/prog/prog/newFile" error: NULL]; 
```

注意：您应该使用`NSURL`基于 - 的方法而不是`NSString`基于 - 的方法。

# objective-c - ios5 上的dismissViewControllerAnimated 崩溃

> ID：11832981
> 
> 赞同：1
> 
> 时间：2012-08-06T17:22:34.663
> 
> 标签：objective-c, ios, ios5, reference

代码会因为循环引用而崩溃吗？

```
MenuController: UIViewController

- (id)initWithNibName:
{...
TabsController *tabs = [[TabsController alloc] initWithNibName:@"TabsController" bundle:nil];
self.tab = tabs;
....
}

//button pressed:
- (IBAction)showPrefFromMenu:(id)sender {
    // todo change delegate!?
     tab.tabDelegate = self;
    [self presentModalViewController:tab animated:YES];
    //[tab release];
}

// delegate method:
 -(void)myViewDismissed {
    .... 
    NSLog(@"tab references: %d", [tab retainCount]) ;

    [self dismissModalViewControllerAnimated:YES];//crash       
     ...

} 
```

模态/子类：

```
TabsController : UIViewController <...>

- (IBAction)dismissTabs:(id)sender {
      ...
    NSLog(@"dismissTabs: sender: %@",sender);
    [self.tabDelegate myViewDismissed];    
} 
```

正如我所见，self.tabDelegate 是 MenuController 实例，并且在该代码上想要关闭并取消分配 TabsController。

尽管 [self.tabDelegate myViewDismissed] 之后不再是代码；但是如果它不能执行，因为它被释放了，也许程序集 Ret 或者什么指令不能执行？返回声明。

我会尝试将代表分开还是有更好的解决方案？

编辑：崩溃是典型的：EXC_BAD_ACCESS(code=1,address=090) 程序集如下所示：ldr r1, [r4, r0]

Edit2：更改了一点代码，因为在模拟器 4.3 中不会崩溃，但在 5.0 时会崩溃，现在这里是当前代码：

```
- (IBAction)showTab:(id)sender {

    tab.tabDelegate = self;

    if (SYSTEM_VERSION_LESS_THAN(@"5.0")) {
        [self presentModalViewController:tab animated:YES];
    }
    else{
        NSLog(@"Executing presentViewController (ios>= 5.0)");
        [self presentViewController:tab animated:true completion: nil];
    }

}

 -(void)delegateCallback {

     if (SYSTEM_VERSION_LESS_THAN(@"5.0")) {
         [self dismissModalViewControllerAnimated:NO]; 
     }
     else{
         NSLog(@"Executing dismissViewControllerAnimated (ios>= 5.0)");
         [self dismissViewControllerAnimated:TRUE completion: nil];//crash
     }        

} 
```

Edit3截图：

![线程](../Images/67278c762e6669449925cc8eb064faa9.png)

UIWindowController 转换：fromViewController:toViewController:didEndSeelctor 线崩溃，原因是：没有 parentViewController： [https](https://devforums.apple.com/message/451045) ://devforums.apple.com/message/451045 伙计们在这里找到了解决方案，：[https ://github.com/ideashower/ShareKit/问题/254](https://github.com/ideashower/ShareKit/issues/254)，但在保密协议下

编辑已解决以重新写入 ios 5.0+ 的 PushviewController 的完整链接：[https ://stackoverflow.com/a/7767767/529543](https://stackoverflow.com/a/7767767/529543)

```
- (IBAction)presentViewController:(id)sender {

    tab.tabDelegate = self;

    if (SYSTEM_VERSION_LESS_THAN(@"5.0")) {
        [self presentModalViewController:tab animated:FALSE];
    }
    else{
        NSLog(@"Executing presentViewController (ios>= 5.0) [tab retainCount]: %d " ,[tab retainCount]);       

    // store parent view to able to restore the state:
    parentView = self.view.superview;        

    // init a navigation controler and set up:
    navigationController=[[UINavigationController alloc] initWithRootViewController:self];                
    [self.view removeFromSuperview];

    [myAppDelegate.window addSubview:navigationController.view];   ///appDelegate is delegate of ur Application     

    navigationController.navigationBar.hidden =true;

    [navigationController pushViewController:tab animated:YES];       

} 
```

}

和弹出：

```
-(void)infoViewDismissed {

     if (SYSTEM_VERSION_LESS_THAN(@"5.0")) {

         [self dismissModalViewControllerAnimated:NO];  
     }
     else{
         NSLog(@"Executing dismissViewControllerAnimated (ios>= 5.0) ");

         [navigationController popToRootViewControllerAnimated:false];        

         [navigationController.view removeFromSuperview];

         [parentView addSubview:self.view];

     }     
} 
```

我已经解决了我的问题，在一个非常丑陋的模式下，但功能......还被告知放弃对 ios3 的支持 :) 我根本不喜欢运行时的 GUI 架构切换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T17:32:20.320

您的问题有点难以理解，但我认为您有一个保留周期：

```
ObjectA retains ObjectB
ObjectB retains ObjectA 
```

并且两个对象都没有被释放？

您的 tabDelegate 属性应为：

```
@property (nonatomic, assign) id tabDelegate;
//                    ^^^^^^-This is the important bit, this stops the retain cycle. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T17:47:02.460

没有更多信息很难说（您是否使用 ARC，您是否保留/分配了委托等），但根据 iOS 文档，您也在使用已弃用的 modalview 方法。可能值得尝试：

```
[self presentViewController:tab animated:YES completion:NULL]; 
```

和

```
[self dismissViewControllerAnimated:YES completion:NULL]; 
```

# objective-c - 使用未声明的标识符“NSEntityDescription”

> ID：11832982
> 
> 赞同：13
> 
> 时间：2012-08-06T17:22:39.170
> 
> 标签：objective-c, ios, core-data

我一直在努力解决这个问题太久了。我有两个试图使用 NSEntityDescription 的 ViewController，一个可以，一个不能（给我上面的错误）。

两个 ViewController 都导入 AppDelegate.h

我认为这一定是 ManagedObjectContext 的问题，但是两个 ViewController 都以相同的方式在 ViewDidLoad 中设置了 ManagedObjectContext：

```
if (!self.managedObjectContext) {
        self.managedObjectContext =  [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
    } 
```

也许它与视图控制器层次结构有关？Tho，我假设 NSEntityDescription 的使用是基于 managedObjectContext 的。

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-06T17:49:32.280

我通常添加`#import <CoreData/CoreData.h>`到我的 Prefix.pch 以确保它可用于所有类。听起来您忘记在其中一个视图控制器中导入 Core Data 标头。

# python - 删除列表中字符串的前四个和后四个字符，或者删除特定的字符模式

> ID：11832984
> 
> 赞同：11
> 
> 时间：2012-08-06T17:22:56.677
> 
> 标签：python, list

我是 Python 的新手，并且已经使用它几个星期了。我有一个字符串列表，想删除每个字符串的前四个和后四个字符。或者，或者，删除特定字符**模式**（不仅仅是特定字符）。

我一直在浏览这里的档案，但似乎没有找到与这个问题相匹配的问题。我发现的大多数解决方案都更适合删除特定字符。

这是我正在使用的字符串列表：

```
sites=['www.hattrick.com', 'www.google.com', 'www.wampum.net', 'www.newcom.com'] 
```

我要做的是隔离域名并获取

[hattrick, 谷歌, wampum, newcom]

这个问题不是关于从 URL 中分离域名（我已经看到了关于这个的问题），而是关于根据位置或模式编辑列表中字符串中的特定字符。

到目前为止，我已经尝试过 .split、.translate、.strip 但这些似乎不适合我正在尝试做的事情，因为它们要么删除了太多与搜索匹配的字符，要么不利于识别特定模式/分组字符，或者不能使用字符串中字符的位置。

非常感谢任何问题和建议，如果我以错误的方式提出这个问题等，我深表歉意。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-06T17:27:10.790

```
def remove_cruft(s):
    return s[4:-4]

sites=['www.hattrick.com', 'www.google.com', 'www.wampum.net', 'www.newcom.com']
[remove_cruft(s) for s in sites] 
```

结果：

```
['hattrick', 'google', 'wampum', 'newcom'] 
```

如果您知道要删除的所有字符串，则可以使用`replace`它们来摆脱它们。如果您不确定所有 URL 是否都以“www.”开头，或者如果 TLD 不是三个字符长，这将很有用。

```
def remove_bad_substrings(s):
    badSubstrings = ["www.", ".com", ".net", ".museum"]
    for badSubstring in badSubstrings:
        s = s.replace(badSubstring, "")
    return s

sites=['www.hattrick.com', 'www.google.com', 
'www.wampum.net', 'www.newcom.com', 'smithsonian.museum']
[remove_bad_substrings(s) for s in sites] 
```

结果：

```
['hattrick', 'google', 'wampum', 'newcom', 'smithsonian'] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T17:33:07.623

您可以使用[tldextract](https://github.com/john-kurkowski/tldextract)模块，它比自己解析字符串更强大：

```
>>> sites=['www.hattrick.com', 'google.co.uk',
           'apps.s3.stackoverflow.com', 'whitehouse.gov']
>>> import tldextract
>>> [tldextract.extract(s).domain for s in sites]
['hattrick', 'google', 'stackoverflow', 'whitehouse'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T17:34:21.397

你是这个意思吗：

```
>>> sites=['nosubdomain.net', 'ohcanada.ca', 'www.hattrick.com', 'www.google.com', 'www.wampum.net', 'www.newcom.com']
>>> print [x.split('.')[-2] for x in sites]
['nosubdomain', 'ohcanada', 'hattrick', 'google', 'wampum', 'newcom'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T17:28:51.387

阅读您的主题，这是一个答案，但可能不是您想要的。

```
for site in sites:
    print(site[:4]) # www .
    print(site[-4:]) # .com / .net / ... 
```

您还可以使用正则表达式：

```
import re
re.sub('^www\.','',sites[0])  # removes 'www.' if exists
re.sub('\.\w+$','',sites[0])  # removes chars after last dot & dot 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T17:28:19.587

我不清楚您对删除特定字符的要求，但如果您只想删除第一个和最后四个字符，您可以使用 python 的内置切片：

```
str = str[4:-4] 
```

这将为您提供从索引 4 开始的子字符串，直到但不包括字符串的倒数第四个索引。

编辑：[这](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)是一个很好的问题，它提供了很多关于 python 切片符号的信息。

# django - django：我应该尝试减少查询并增加毫秒时间吗？

> ID：11832987
> 
> 赞同：0
> 
> 时间：2012-08-06T17:23:20.970
> 
> 标签：django

在我的网站中，主页（用户大部分时间都在其中）有大约 140 个查询（其中 70 个来自`django-avatar`模块——*我必须看看有一天我是否能找到替代方案*）。但是它需要 5 秒才能加载（指标来自`django-toolbar`）。

我可以将查询数量增加到 170，并将加载时间减少到 2.5 秒（！）。

为此，我必须通过迭代较小的查询来简化使用`annotate()`和创建字典的复杂查询。我注意到虽然查询数量增加了，但 django 更喜欢它，因为我通过删除注释来减轻复杂查询的负载。

我应该怎么办？

PS：除了`MySql`我也用`memcached`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:52:42.403

首先，django-debug-toolbar 提供了一个*主观*的性能衡量标准，用于快速检查自己。如果您发现您的查询激增或请求突然比以前花费更长的时间，那么这让您知道您需要深入研究并查看是否可以对其进行一些优化。但是，它*不*适合泛化的“我的网站响应速度如何”类型测试；django-debug-toolbar，它本身引入了一些低效率的地方来给你它所做的数据。禁用工具栏后，您的代码将不可避免地比启用时执行*得更好。*如果您真的想衡量您的网站，您需要使用分析后端在最佳条件下对您的网站进行猛烈攻击，并为您提供有关瓶颈发生位置的统计信息。

也就是说，您获得的时间统计信息不仅取决于查询；它们还依赖于文件 I/O、模板渲染等。如果您在开发中使用 memcached，那么请求之间不可避免地会发生一些缓存，即使它只是被缓存的模板。不必重新解析模板并创建响应对象会占用大量时间。因此，看起来 170 次查询似乎更快，但这可能只是因为已经有一些缓存。如果关闭缓存，时间可能会显着增加。如果您正在开发和优化查询负载，您应该通过将缓存设置为`DummyCache`.

最后，在开发中，传输请求的实际时间不是问题，因为它是本地到本地的，这几乎是瞬时的。在现实世界的场景中，客户端向您的服务器发送请求需要花费数百毫秒的时间。如果您的数据库服务器与您的 Web 服务器不在同一台服务器上，则从 Web 应用程序到数据库来回发送请求需要时间，最后将响应发送回客户端需要时间。实际*传输*时间通常最终会比实际*查询*时间造成更多的瓶颈，因此通常更少、更复杂的查询总是比更多、更小的查询更可取。

基本上，在开发中测试这些东西的变量太多了。像 django-debug-toolbar 这样的东西是一个很好的*指南*，但它并不全面，也不是万无一失的。将您的代码放在类似生产的机器上并对其进行猛烈攻击——这是唯一确定的方法。

# mysql - Pharo Smalltalk 和 mySql

> ID：11832990
> 
> 赞同：5
> 
> 时间：2012-08-06T17:23:31.903
> 
> 标签：mysql, database, smalltalk, pharo

我正在寻找知道如何连接 Pharo Smalltalk 和 mySql 的人。我只想做一些基本的事情，比如“从名称中选择 *”，然后将结果读入 Pharo。

有人对这个有了解吗？如果你有一个超级棒的屏幕视频，我会给你买啤酒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T18:47:03.603

查看[DBXTalk](https://guillep.github.io/DBXTalk/)。Mariano Peck 在 ESUG 2011 上就它做了一个介绍。这是[摘要](http://www.esug.org/wiki/pier/Conferences/2011/Schedule-And-Talks/DBXTalk)和[视频](http://www.youtube.com/watch?v=HJQc22ksFCc)。请给我一个蓝月亮；-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T22:16:03.117

我会得到什么？;) 现在，真的，如果您有任何问题，请告诉我们。有更多视频和幻灯片：[http](http://dbxtalk.smallworks.com.ar/media/) ://dbxtalk.smallworks.com.ar/media/ 。

你的场景很简单。您将需要安装 MySQL 客户端库和 OpenDBX 库。如果它在 linux 中，它很容易安装和编译。在 Windows 中，您可以直接获取 dll。检查，因为所有信息都应该在网站上。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-07T18:41:02.133

> there is a package originally developed by Diego Gomez Deck and meanwhile updated in Squeaksource.
> 
> Use [my metacello config script](http://lists.gforge.inria.fr/pipermail/pharo-project/2010-November/035148.html) to load ODBC support and start with ODBCConnection class.
> 
> For further help you can consult the (outdated) [documentation](http://wiki.squeak.org/squeak/2480).

([Source](http://astares.blogspot.co.uk/2010/11/using-odbc-in-pharo.html))

# xcode - 可以有一个变量类对象声明

> ID：11832993
> 
> 赞同：0
> 
> 时间：2012-08-06T17:23:45.777
> 
> 标签：xcode, class, uitableview, declaration

这是我的例子：

```
UITableView *cell = [[MyCustomClass alloc] init]; 
```

有没有一种方法可以改变类“MyCustomClass”，比如有这样的方法：

```
-(NSObject*)newMethod:(int)intNumber{
 classVariable = someClass depending on intNumber
 UITableView *cell [[<<<classVariable>>> alloc] init];
 return cell;
} 
```

我想要这个方法，所以我可以创建正确的自定义单元格，并在我的下一个实现中将它用作全局方法，这是我在 Stack Overflow 的其他问题中找到的代码（用于从 xibs 加载自定义单元格):

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:stringIdentifier];

if (cell == nil) {
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:nibName owner:self options:nil];
    for (id currentObject in nib) {
        if ([currentObject isKindOfClass:[UITableViewCell class]]) {
            cell = (MyClassCell*) currentObject;
            break;
        }
    }
    cell = (MyClassCell *)[nib objectAtIndex:0];
} 
```

我的目标是有一个方法，我可以发送上面代码所需的所有信息，即 tableViw、stringidentifier、nibName 和 MyClassCell <——这就是整个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:26:46.300

您可以使用以下方法获取`Class`类的`class`：

```
Class myclass = [MYClass class]; 
```

您现在可以`myclass`作为变量传递，并且可以在`Class`需要 a 的地方使用它：

```
id myinstance = [[myclass alloc] init]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T17:29:43.570

您可以将类名甚至类放在 NSArray 中并使用索引：

```
NSArray *classes = [NSArray arrayWithObjects:[ClassOne class], [ClassTwo class], [C 
```

assThree class], Nil];

```
id instance = [[(Class)[classes objectAtIndex:anIndex] alloc] init]; 
```

如果您希望在运行时动态构造/使用类信息，可以使用 NSClassFromString() 函数：

```
id anObject = [[NSClassFromString(@"FooBar") alloc] init]; 
```

# python - Python print unicode 不显示正确的符号

> ID：11832997
> 
> 赞同：8
> 
> 时间：2012-08-06T17:24:09.610
> 
> 标签：python, ubuntu, python-unicode

我正在使用 Ubuntu 12.04 LTS。当我在终端尝试这样的事情时：

```
rfx@digest:/usr/share/fonts/truetype/ttf-dejavu$ echo вдлжофыдвж
вдлжофыдвж 
```

符号显示正确。但是，如果尝试使用 python 2.7 打印 unicode 符号，我会得到：

```
>>> print u'абв'
ц│ц┌ц≈ 
```

正如 python 所示，我默认为终端使用 utf-8 编码：

```
>>> sys.stdout.encoding
'UTF-8' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T18:01:29.877

Your input is being improperly deciphered by the terminal. This is not a Python problem.

To prove it, use the unicode representation:

```
myunicode = u'\u0430\u0431\u0432'
print myunicode
print myunicode.encode('utf-8') 
```

If this does not print the original string `абв` twice, then you need to configure your terminal emulator program correctly.

# apache - 如何使用 MAMP 将自定义条目添加到 /etc/hosts？

> ID：11832998
> 
> 赞同：1
> 
> 时间：2012-08-06T17:24:14.910
> 
> 标签：apache, mamp

我正在使用 MAMP Pro 在我的机器上创建和管理自定义虚拟主机。我发现我需要将以下内容添加到我的 /etc/hosts 文件中，以使某些浏览器（Chrome）加载得更快：

fe80::1%lo0 example.dev

问题是，每当我通过应用程序更改任何内容时，MAMP 都会清除我的自定义设置。

有什么想法可以保留我的自定义设置吗？

# javascript - 三个JS大小的对象（PlaneGeometry）？

> ID：11832999
> 
> 赞同：4
> 
> 时间：2012-08-06T17:24:26.893
> 
> 标签：javascript, three.js

我对尺寸有疑问：

```
 var geometry = new THREE.PlaneGeometry(50, 50);

    var plane = new THREE.Mesh(geometry, material);

    plane.doubleSided = true;
    plane.tile = tile; 
```

所以问题是：PlaneGeometry 的大小，不是以像素为单位的吗？当我有大约 500x500 的画布时，它最终会小于 50x50 吗？

PS>还有一个问题，当元素已经添加到场景中时如何获取它的大小？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T01:18:17.260

50x50 不是像素。是“单位”。无论您希望“单位”是什么（它与其他对象的大小有关）。

如果您想以受控方式调整对象的大小，可以这样做：

```
var geometry = new THREE.PlaneGeometry(1, 1);
var plane = new THREE.Mesh(geometry, material);

plane.scale.x = 50;
plane.scale.y = 50; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-06T12:08:37.143

> PS>还有一个问题，当元素已经添加到场景中时如何获取它的大小？谢谢！

我正在使用thingiview js插件，我注意到如果你有一个对象添加到场景中，你可以用坐标在立方体内关闭它：

`p0 = [minx, miny,minz], p1 =[minx,miny,maxz], ..., p7 =[maxx, maxy,maxz];`

， 在哪里：

`var minx = object.geometry.min_x; var maxz = object.geometry.max_z;`

ETC..

PS：我知道这个问题有点老了，但我一直在寻找那些参数（试图获取添加对象的大小）但在任何地方都找不到。