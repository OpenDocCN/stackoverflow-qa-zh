# StackOverflow 问答 000180000-000180999

# delphi - 更改今天的日期，提前一个月并设置系统时间

> ID：180003
> 
> 赞同：5
> 
> 时间：2008-10-07T19:38:45.467
> 
> 标签：delphi, datetime

我想要一个函数的代码示例，该函数将 tDateTime 和一个整数作为输入，并在将 tDateTime 提前 (int) 个月后使用 setlocaltime 设置系统时间。时间应该保持不变。

伪代码示例

```
SetNewTime(NOW,2); 
```

我遇到的问题相当令人沮丧。我不能使用 incmonth 或类似的 tDateTime，只能使用 tDate 等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T19:48:45.400

下面是一个适合我的完整命令行程序。在 Delphi 5 和 2007 中测试。为什么说[IncMonth](http://www.delphibasics.co.uk/RTL.asp?Name=IncMonth)不适用于 TDateTime？

```
program OneMonth;

{$APPTYPE CONSOLE}

uses
  SysUtils,
  Windows,
  Messages;

procedure SetLocalSystemTime(settotime: TDateTime);
var
  SystemTime : TSystemTime;
begin
  DateTimeToSystemTime(settotime,SystemTime);
  SetLocalTime(SystemTime);
  //tell windows that the time changed
  PostMessage(HWND_BROADCAST,WM_TIMECHANGE,0,0);
end;

begin
  try
    SetLocalSystemTime(IncMonth(Now,1));
  except on E:Exception do
    Writeln(E.Classname, ': ', E.Message);
  end;
end. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T20:46:14.690

IncMonth 应该与[TDateTime](http://www.delphibasics.co.uk/RTL.asp?Name=IncMonth)一起使用：

```
function IncMonth ( const StartDate  : TDateTime {; NumberOfMonths  : Integer = 1} ) : TDateTime; 
```

请记住，TDate 实际上只是一个 TDateTime，按照惯例，您会忽略上面的分数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T19:57:22.247

根据您的伪代码：

```
procedure SetNewTime(aDateTime: TDateTime; aMonths: Integer);
var
  lSystemTime: TSystemTime;
begin
  DateTimeToSystemTime(aDateTime, lSystemTime);
  Inc(lSystemTime.wMonth, aMonths);
  setSystemTime(lSystemTime);
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T22:40:11.857

setSystemTime 使用 UTC 时间，因此您必须根据您的时区进行调整。偏差是您的机器时区与 UTC 不同的分钟数。这会在我的系统上正确调整日期：

```
procedure SetNewTime(aDateTime: TDateTime; aMonths: Integer);
var
  lSystemTime: TSystemTime;
  lTimeZone: TTimeZoneInformation;
 begin
  GetTimeZoneInformation(lTimeZone);
  aDateTime := aDateTime + (lTimeZone.Bias / 1440);
  DateTimeToSystemTime(aDateTime, lSystemTime);
  Inc(lSystemTime.wMonth, aMonths);
  setSystemTime(lSystemTime);
end; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T00:48:17.090

没有足够的信息来为您的问题提供明确的答案。

考虑一下如果当前月份的某一天在未来的月份中不存在，您希望发生什么。比如说，1 月 31 日 + 1 个月。（一年中的 7 个月有 31 天，其余的则更少。）如果您增加年份并且开始日期是闰年的 2 月 29 日，您会遇到同样的问题。所以不可能有一个通用的 IncMonth 或 IncYear 函数在所有日期都一致地工作。

对于任何有兴趣的人，我衷心推荐[Julian Bucknall](http://www.boyet.com/Articles/PublishedArticles/Calculatingthenumberofmon.html)关于如何计算两个日期之间的月数和天数的此类计算所固有的复杂性的文章。

以下是唯一可能不会将异常引入通用日期数学的通用日期增量函数。但它只能通过将责任转回给可能具有他/她正在编程的特定应用程序的确切要求的程序员来实现这一点。

[IncDay](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncDay.html) - 添加或减去天数。
[IncWeek](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncWeek.html) - 增加或减少周数。

但是，如果您必须使用内置函数，那么至少要确保它们执行您希望它们执行的操作。查看 DateUtils 和 SysUtils 单位。拥有这些函数的源代码是 Delphi 最酷的方面之一。话虽如此，这里是内置函数的完整列表：

[IncDay](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncDay.html) - 添加或减去天数。
[IncWeek](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncWeek.html) - 增加或减少周数。
[IncMonth](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/delphivclwin32/SysUtils_IncMonth.html) - 加或减月数。
[IncYear](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncYear.html) - 添加或减去若干年。

至于您问题的第二部分，如何使用 TDatetime 设置系统日期和时间，一旦您拥有具有您想要的值的 TDatetime，以下从另一篇帖子中无耻窃取的代码将完成这项工作：

```
procedure SetSystemDateTime(aDateTime: TDateTime);
var
  lSystemTime: TSystemTime;
  lTimeZone: TTimeZoneInformation;
 begin
  GetTimeZoneInformation(lTimeZone);
  aDateTime := aDateTime + (lTimeZone.Bias / 1440);
  DateTimeToSystemTime(aDateTime, lSystemTime);
  setSystemTime(lSystemTime);
end; 
```

# asp.net - Why is LINQ to SQL converting my string parameter to a column name?

> ID：180005
> 
> 赞同：0
> 
> 时间：2008-10-07T19:38:56.357
> 
> 标签：asp.net, sql, vb.net, linq-to-sql

This Linq to SQL query ...

```
 Return (From t In Db.Concessions Where t.Country = "ga" Select t.ConcessionID, t.Title, t.Country) 
```

... is generating this SQL:

```
SELECT [t0].[ConcessionID], [t0].[Title], [t0].[Country]
FROM [dbo].[Concessions] AS [t0]
WHERE [t0].[Country] = ga 
```

... when what I want is

```
WHERE [t0].[Country] = 'ga' 
```

Any ideas why?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T19:53:28.760

Wild guess.... could it be?

`t.Country = "ga"`

vs.

`t.Country == "ga"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T20:15:24.003

Actually, it shouldn't be generating either of those. It would convert the constant into a parameter, so it would be:

```
SELECT [t0].[ConcessionID], [t0].[Title], [t0].[Country]
FROM [dbo].[Concessions] AS [t0]
WHERE [t0].[Country] = @p0 
```

with @p0 passed as 'ga'. could that be that you are seeing?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T20:15:34.893

## Answer

The Country field was a char(2); I changed it to nvarchar(50), and that fixed the problem. Is this a bug in Linq to SQL?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T05:49:04.017

I cannot be sure about this particular example, but there is a known bug that causes similar problems with nvarchar(1) fields. It may be related.

There is a [bug report here](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=337188&wa=wsignin1.0) about it and I also [wrote about it](http://reddnet.net/code/linq-to-sql-bug-quot-system-formatexception-string-must-be-exactly-one-character-long-quot/) on my own site too.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-07T19:43:24.583

the select should be

```
Select New With {t.ConcessionID, t.Title, t.Country} 
```

rather than

```
Select t.ConcessionID, t.Title, t.Country 
```

you need to create a new instance of an anonymous type to contain the fields.

# url - 如何配置可选或“无关”的 URL？

> ID：180007
> 
> 赞同：1
> 
> 时间：2008-10-07T19:39:14.903
> 
> 标签：url, configuration, url-rewriting

您将如何配置/处理无关/可选的 URL 实体（可能是别名）？

SO 就是一个很好的例子：

*   stackoverflow.com/questions/99999999/
*   stackoverflow.com/questions/99999999/ **question-goes-here**（不好的例子，但我想不出更好的例子）

亚马逊 URL 更加令人困惑（例如[Kindle](https://rads.stackoverflow.com/amzn/click/com/B000FI73MA)）

*   amazon.com/gp/product/B000FI73MA/
*   amazon.com/ **Kindle-Amazons-Wireless-Reading-Device** /dp/B000FI73MA/

[**编辑**] 这可能不是最好的行动计划，但我真的在问这个问题，而不是任何单个服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T19:47:28.630

如果您使用 Apache，请查看[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T19:52:29.637

这种技术通常称为 url 重写。如果您正在寻找 IIS 中的解决方案，您可以使用**[ISAPI rewrite ，这与 apache 的](http://www.isapirewrite.com/)**[**mod_rewrite**](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)非常相似。否则，您可以使用**[ASP.Net MVC 路由](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)**机制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T19:49:27.910

像这样（如果手动配置 URL）：

```
RewriteRule ^([^\/]+)\/([^\/]+)\/(.*) index.php?controller=$1&view=$2&args=$3 
```

否则，我让 MVC 框架处理它并根据需要定制控制器的参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T19:47:53.310

mod_rewrite 经常使用，至少在带有 Apache 的 Linux 下是这样。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-07T19:43:21.697

这是您的网络应用程序的任务，而不是您的网络服务器。

在 URL=> 文件映射上，比如 PHP（或静态网络服务器），这很棘手；但在 MVC 框架上，这很自然，即使在 PHP MVC 框架上也是如此。

# .net - XML 序列化，无空格

> ID：180018
> 
> 赞同：7
> 
> 时间：2008-10-07T19:41:11.810
> 
> 标签：.net, xml, vb.net, xml-serialization

我有以下序列化方法：

```
 Private Function SerializeData(ByVal data As cData) As String
        If data IsNot Nothing Then
            Dim xml_stream As New MemoryStream()
            Dim sr As StreamReader
            Dim xs As New XmlSerializer(GetType(cData))
            xml_stream = New MemoryStream()

            Try
                xs.Serialize(xml_stream, data)
                xml_stream.Position = 0

                sr = New StreamReader(xml_stream)
                Return sr.ReadToEnd()
            Finally
                If sr IsNot Nothing Then sr.Close()
                xml_stream.Close()
            End Try

        Else
            Return "No data"
        End If
    End Function 
```

但是它返回缩进的嵌套元素的xml。有没有办法在序列化程序上关闭它，还是我需要运行一个查找替换例程来摆脱它？

本质上，我想看到的是：

```
<root><child1>data</child1><child2>data</child2></root> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-07T19:48:19.987

使用接受 XmlWriter 参数的序列化覆盖。使用 XmlWriter::Create 创建 XmlWriter，传入一个将 Indent 属性设置为 false 的 XmlWriterSettings 对象。

# java - 为什么要在远程 EJB3 会话 Bean 上使用 InitialContext

> ID：180023
> 
> 赞同：5
> 
> 时间：2008-10-07T19:41:41.950
> 
> 标签：java, jakarta-ee, ejb-3.0, ejb, jndi

为什么在调用远程 EJB 时需要指定各种驱动程序信息？

```
java.naming.factory.initial=org.jnp.interfaces.NamingContextFactory
java.naming.factory.url.pkgs=org.jboss.naming:org.jnp.interfaces
java.naming.provider.url=localhost:1099 
```

我们不应该只需要指定 url/port 并且 EJB 容器应该解决所有其他的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T11:07:33.807

因为并非所有 EJB 容器都使用相同的属性。此属性适用于 Jboss 容器。

例如 Glassfish 使用以下属性：

```
java.naming.factory.initial=com.sun.enterprise.naming.SerialInitContextFactory
java.naming.factory.url.pkgs=com.sun.enterprise.naming
java.naming.factory.state=com.sucn.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl
org.omg.CORBA.ORBInitialHost=localhost
org.omg.CORBA.ORBInitialPort=3700 
```

# c# - 我怎样才能知道一张照片是在 Vista 上运行的 C# 中实际拍摄的？

> ID：180030
> 
> 赞同：49
> 
> 时间：2008-10-07T19:43:12.337
> 
> 标签：c#

在 Windows XP 中，“FileInfo.LastWriteTime”将返回照片的拍摄日期——无论文件在文件系统中移动了多少次。

在 Vista 中，它改为返回从相机复制图片的日期。

如何知道在 Vista 中拍摄照片的时间？在 Windows 资源管理器中，此字段称为“拍摄日期”。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2011-10-10T13:50:29.290

这里尽可能快和干净。通过使用 FileStream，您可以告诉 GDI+ 不要加载整个图像进行验证。它在我的机器上运行速度超过 10 倍。

```
//we init this once so that if the function is repeatedly called
//it isn't stressing the garbage man
private static Regex r = new Regex(":");

//retrieves the datetime WITHOUT loading the whole image
public static DateTime GetDateTakenFromImage(string path)
{
    using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read))
    using (Image myImage = Image.FromStream(fs, false, false))
    {
        PropertyItem propItem = myImage.GetPropertyItem(36867);
        string dateTaken = r.Replace(Encoding.UTF8.GetString(propItem.Value), "-", 2);
        return DateTime.Parse(dateTaken);
    }
} 
```

是的，正确的 id 是 36867，而不是 306。

下面的其他开源项目应该注意这一点。处理数千个文件时，这对性能造成了*巨大影响。*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-07T21:13:15.540

```
Image myImage = Image.FromFile(@"C:\temp\IMG_0325.JPG");
PropertyItem propItem = myImage.GetPropertyItem(306);
DateTime dtaken;

//Convert date taken metadata to a DateTime object
string sdate = Encoding.UTF8.GetString(propItem.Value).Trim();
string secondhalf = sdate.Substring(sdate.IndexOf(" "), (sdate.Length - sdate.IndexOf(" ")));
string firsthalf = sdate.Substring(0, 10);
firsthalf = firsthalf.Replace(":", "-");
sdate = firsthalf + secondhalf;
dtaken = DateTime.Parse(sdate); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-10-03T19:53:52.100

自 2002 年以来，我维护了一个[简单的开源库](https://github.com/drewnoakes/metadata-extractor-dotnet)，用于从图像/视频文件中提取元数据。

```
// Read all metadata from the image
var directories = ImageMetadataReader.ReadMetadata(stream);

// Find the so-called Exif "SubIFD" (which may be null)
var subIfdDirectory = directories.OfType<ExifSubIfdDirectory>().FirstOrDefault();

// Read the DateTime tag value
var dateTime = subIfdDirectory?.GetDateTime(ExifDirectoryBase.TagDateTimeOriginal); 
```

`Image.GetPropertyItem`在我的基准测试中，此代码的运行速度比 WPF `JpegBitmapDecoder`/ `BitmapMetadata`API快12 倍，大约快 17 倍。

库中提供了大量额外信息，例如相机设置（F-stop、ISO、快门速度、闪光模式、焦距……）、图像属性（尺寸、像素配置）和 GPS 位置等其他信息、关键词、版权信息等。

如果您只对元数据感兴趣，那么使用这个库非常快，因为它不会解码图像（即位图）。如果您有足够快的存储空间，您可以在几秒钟内扫描数千张图像。

`ImageMetadataReader`理解许多文件类型（JPEG、PNG、GIF、BMP、TIFF、PCX、WebP、ICO 等）。如果您*知道*您正在处理 JPEG，并且您*只*需要 Exif 数据，那么您可以使用以下方法加快处理速度：

```
var directories = JpegMetadataReader.ReadMetadata(stream, new[] { new ExifReader() }); 
```

元*数据提取器*库可通过[NuGet](https://www.nuget.org/packages/MetadataExtractor/)获得，[代码位于 GitHub 上](https://github.com/drewnoakes/metadata-extractor-dotnet)。感谢多年来改进库和提交测试图像的所有出色的贡献者。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-07T19:47:30.533

使用 WPF 和 C#，您可以使用 BitmapMetadata 类获取 Date Taken 属性：

[MSDN - 位图元数据](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapmetadata.aspx)

[WPF 和位图元数据](http://blogs.vertigosoftware.com/alanl/archive/category/1039.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-07T21:03:59.833

> 在 Windows XP 中，“FileInfo.LastWriteTime”将返回照片的拍摄日期——无论文件在文件系统中移动了多少次。

我非常怀疑 XP 是否真的这样做了。您用于将图像从相机复制到硬盘的工具更有可能将文件修改日期重置为图像的拍摄日期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T19:47:48.740

您必须检查图片中的 EXIF 信息。我认为使用常规的 .Net 功能您不会知道照片的拍摄时间。

可能会有点复杂...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T19:49:11.217

图像中将嵌入 EXIF 数据。如果您搜索 EXIF 和 C#，网络上有大量示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-06T17:57:56.080

```
 //retrieves the datetime WITHOUT loading the whole image
    public static DateTime GetDateTakenFromImage(string path)
    {
        using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read))
        using (Image myImage = Image.FromStream(fs, false, false))
        {
            PropertyItem propItem = null;
            try
            {
                propItem = myImage.GetPropertyItem(36867);
            }
            catch { }
            if (propItem != null)
            {
                string dateTaken = r.Replace(Encoding.UTF8.GetString(propItem.Value), "-", 2);
                return DateTime.Parse(dateTaken);
            }
            else
                return new FileInfo(path).LastWriteTime;
        }
    } 
```

# sql - 如何在 SQL Server 2005 中将多行组合成以逗号分隔的列表？

> ID：180032
> 
> 赞同：54
> 
> 时间：2008-10-07T19:43:14.693
> 
> 标签：sql, sql-server, list, function, concatenation

现在，我有一个这样的 SQL 查询：

```
SELECT X, Y FROM POINTS 
```

它返回如下结果：

```
X    Y
----------
12   3
15   2
18   12
20   29 
```

我想在一行中返回所有结果，如下所示（适合在 HTML <AREA> 标签中使用）：

```
XYLIST
----------
12,3,15,2,18,12,20,29 
```

有没有办法只使用 SQL 来做到这一点？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-10-07T20:55:02.363

感谢您提供快速而有用的答案！

我刚刚找到了另一种快速的方法来做到这一点：

```
SELECT  STUFF(( SELECT ',' + X + ',' + Y
                FROM Points
              FOR
                XML PATH('')
              ), 1, 1, '') AS XYList 
```

归功于这个人：

[http://geekswithblogs.net/mnf/archive/2007/10/02/t-sql-user-defined-function-to-concatenate-column-to-csv-string.aspx](http://geekswithblogs.net/mnf/archive/2007/10/02/t-sql-user-defined-function-to-concatenate-column-to-csv-string.aspx)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-07T19:48:10.470

```
DECLARE @XYList varchar(MAX)
SET @XYList = ''

SELECT @XYList = @XYList + CONVERT(varchar, X) + ',' + CONVERT(varchar, Y) + ','
FROM POINTS

-- Remove last comma
SELECT LEFT(@XYList, LEN(@XYList) - 1) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-08T03:40:23.247

使用这个`COALESCE`技巧，您不必担心结尾的逗号：

```
DECLARE @XYList AS varchar(MAX) -- Leave as NULL

SELECT @XYList = COALESCE(@XYList + ',', '') + CONVERT(varchar, X) + ',' + CONVERT(varchar, Y)
FROM POINTS 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-07-11T17:27:16.883

从 SQL 2017 开始，您可以使用`STRING_AGG`

```
SELECT STRING_AGG (X + ',' + Y, ',') AS XYLIST
FROM POINTS 
```

[https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T19:47:19.833

```
DECLARE @s VarChar(8000)
SET @s = ''

SELECT @s = @s + ',' + CAST(X AS VarChar) + ',' + CAST(Y AS VarChar) 
FROM POINTS

SELECT @s 
```

只需去掉前面的逗号

# xml - Groovy 解析 JSON 与 XML

> ID：180039
> 
> 赞同：5
> 
> 时间：2008-10-07T19:44:46.280
> 
> 标签：xml, json, serialization, grails, groovy

使用 groovy，您是否期望在读取和查询 JSON 与 XML 的速度和内存开销方面有更好的性能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T19:54:34.450

JSON 比 XML 更小更简单。我敢打赌 JSON 解析速度更快。

YAML 会更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T19:05:45.033

如果速度真的是个问题，我宁愿使用 java 库来解析我想要的任何东西，而不是依赖 Groovy 的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T14:04:58.947

如果它是相同的模式和相同的信息，那么内存使用将几乎相同。两者之间的性能应该可以忽略不计。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T02:59:43.047

我相信如果架构和数据相同，那么除了分析器之外的任何东西都无法检测到性能差异。也就是说，如果您使用了错误的 XML 解析器，您可能会看到很大的不同。换句话说，SAX 实现可以轻松匹配或可能优于 JSON 解析。有很多外部因素需要考虑。如果您想要真实的故事，请在相同的数据/模式中同时使用 JSON 和 SAX 解析器，而无需额外的逻辑。巨大的节省来自用于解释解析的逻辑。根据您的需求，使用 DOM 或拉解析器可能更简单，而 SAx 会导致过于复杂的非性能解决方案。解析器之间也存在显着差异。添加文件大小的变量，你很快就会失去你实际测量的范围。另一个例子，如果您的 XML 包含必须通过网络解析的 DTD 描述和实体引用，并且您的网络连接具有高延迟，那么您可以看到 JSON 的改进。这一切都归结为你真正想做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T19:56:49.003

由于尖括号和额外的信息等等，XML 比 JSON 有更多的开销。由于这个原因，任何好的解析器都应该能够比 XML 更快地解析 JSON。

# sql-server - SQL Server - 使用 CLR 集成来使用 Web 服务

> ID：180046
> 
> 赞同：7
> 
> 时间：2008-10-07T19:46:28.867
> 
> 标签：sql-server, web-services, clr

Web 上有一些[教程](http://www.simple-talk.com/sql/sql-server-2005/practical-sql-server-2005-clr-assemblies/)描述了使用 SQL Server 2005 的 CLR 集成来使用 Web 服务。大多数情况下，这个过程似乎相当复杂。我遇到了几个问题，包括需要更改数据库的信任级别，以及使用 sgen 工具创建静态 XmlSerializer 程序集；而且我还没有让它正常工作......（我确定我只需要投入更多的时间和精力）

采用这种类型的架构时，安全性、性能和维护方面的影响是什么？这可能是一个相当频繁使用的过程，并且易于维护是相对重要的。

我可以自由选择是将它作为 UDF 集成到 SQL Server 中，还是让它成为控制台/Web 应用程序的独立 .NET 库。SQL CLR 与外部程序集的集成值得麻烦吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T20:58:29.457

The short answer is, no, SQL CLR Integration is probably not worth the trouble.

The longer answer has several points, beginning with programming CLR in the database. It's a fine tool, when used correctly, but it does increase memory consumption and can lead to performance issues if not done correctly. I use it in my database for very specialized functionality, such as adding RegEx ability, but it's used sparingly, with well-tested code to prevent as many issues as possible from cropping up.

A second is, as you pointed out, you've got to modify security, opening up potential risks.

Use a stand alone application to load the data into your server. You'll have more control, less risk and a much easier time of it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T20:42:03.357

我想你已经回答了你自己的问题，我个人发现任何调用 WebService 的东西都比 likley 更适合存在于 SQL Server 之外。复杂性、提高的信任级别，以及正如您提到的整个复杂过程，使得解决方案难以记录和维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T14:04:21.280

我一直在做 clr 程序，它在 Exchange 和 AD 上调用 web 服务，我同意上面的帖子。它可以工作，但是我们很快就遇到了内存不足的问题，因为在 sql server 中的 CLR 中处理内存的特殊方式。正如您可以想象的那样，小型查询的性能还可以，但根本无法扩展。

通常，您的数据库性能决定了您的应用程序的性能，如果您无法完全控制自己在做什么，我认为将此类逻辑放入数据库中是不可以的。

使用 CLR 进行不依赖于外部资源的简单文本操作和其他计算。

# git - 在 Git 中签出子目录？

> ID：180052
> 
> 赞同：171
> 
> 时间：2008-10-07T19:47:14.450
> 
> 标签：git, sparse-checkout

是否可以在 Git 中签出存储库的子目录？

想象一下，我正在设置一个新的 WordPress 安装。我将为我的插件和主题自定义创建两个新目录：

*   `wordpress/wp-content/plugins/myplugins/`
*   `wordpress/wp-content/themes/mytheme/`

我想通过 Git 维护这些目录。在 Subversion 中，我将通过拥有目录和签出子目录来实现这`trunk/myplugins/`一点`trunk/mytheme/`。Git 是否有办法使用单个存储库完成相同的任务？

作为一个长期接触 Git 的 SVN 用户，我可能只是错过了一些 Git 范例。

**编辑：存储不同内容的** [多个分支](https://stackoverflow.com/questions/466303/git-branches-with-completely-different-content)是一种有趣的处理方式。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2010-02-20T20:40:42.140

[稀疏检出](http://schacon.github.io/git/git-read-tree.html#_sparse_checkout)现在[在 Git 1.7](http://schacon.github.io/git/RelNotes/1.7.0.txt)中。

另请参阅问题“<a href="https://stackoverflow.com/q/4114887/578288">是否可以在不先检查整个存储库的情况下进行稀疏检查？”。

请注意，稀疏签出仍然需要您*下载*整个存储库，即使 Git 下载的某些文件最终不会出现在您的工作树中。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-07T20:06:48.607

在 git 中没有真正的方法可以做到这一点。而且，如果您不会将同时影响两棵树的更改作为一个工作单元进行，那么就没有充分的理由为两者使用一个存储库。我以为我会错过这个 Subversion 功能，但我发现创建存储库的管理精神开销非常小（仅仅是因为存储库存储在它们的工作副本旁边，而不是要求我明确选择工作副本），我习惯于制作许多小型的单一用途存储库。

但是，如果您坚持（或确实需要），您可以创建一个仅包含`mytheme`和`myplugins`目录的 git 存储库，并在 WordPress 安装中对它们进行符号链接。

* * *

MDCore 写道：

> 提交到例如*mytheme*将增加*myplugin的修订号*

请注意，如果您决定将两个目录放在一个存储库中，这对 git 来说不是问题，因为 git 完全消除了任何形式的单调增加修订号的概念。

在 git 中将哪些东西放在一个存储库中的唯一标准是它是否构成一个单元，即。在您的情况下，是否存在单独查看每个目录中的编辑没有意义的更改。如果您有更改需要同时编辑两个目录中的文件并且编辑属于一起，则它们应该是一个存储库。如果没有，那么不要将它们放在一起。

Git 真的很想让你为不同的实体使用不同的存储库。

> [子模块](http://schacon.github.com/git/git-submodule.html)

子模块并没有解决将两个目录都保存在一个存储库中的愿望，因为它们实际上会*强制*为每个目录拥有一个单独的存储库，然后使用子模块将它们放在*另一个*存储库中。更糟糕的是，由于 WordPress 安装中的目录不是同一目录的直接子目录，并且也是具有许多其他文件的层次结构的一部分，因此将每个目录的存储库用作统一存储库中的子模块将没有任何好处，因为统一存储库不会反映任何用例/需求。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-03-22T16:33:00.960

我不喜欢稀疏签出的一件事是，如果您想签出一个深度为几个目录的子目录，您的目录结构必须包含通向它的所有目录。

我如何解决这个问题是在不是我的工作区的地方克隆 repo，然后在我的工作区目录中创建一个符号链接到存储库中的子目录。Git 像这样很好地工作，因为像 git status 这样的东西会显示相对于你当前工作目录的更改文件。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-09-11T07:19:03.610

**`git clone --filter`来自 git 2.19 现在可以在 GitHub 上运行（测试 2020-09-18，git 2.25.1）**

此选项是与远程协议的更新一起添加的，它确实可以防止从服务器下载对象。

`d1`要仅克隆此存储库所需的对象： [https](https://github.com/cirosantilli/test-git-partial-clone) ://github.com/cirosantilli/test-git-partial-clone我可以这样做：

```
git clone \
  --depth 1 \
  --filter=blob:none \
  --no-checkout \
  https://github.com/cirosantilli/test-git-partial-clone \
;
cd test-git-partial-clone
git checkout master -- d1 
```

我在以下位置更详细地介绍了这一点：[Git：如何仅克隆 Git 存储库的子目录？](https://stackoverflow.com/questions/600079/how-do-i-clone-a-subdirectory-only-of-a-git-repository/52269934#52269934)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-08T20:17:41.377

实际上，“窄”或“部分”或“稀疏”检出正在 Git 的当前大量​​开发中。请注意，您仍将拥有完整的存储库`.git`。因此，其他两篇文章是当前 Git 状态的最新文章，但**看起来**我们最终将能够进行稀疏检查。 如果您对更多详细信息感兴趣，请[查看邮件列表——它们正在迅速变化。](http://kerneltrap.org/mailarchive/git/2008/9/14/3292714)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T20:20:30.703

您不能签出存储库的单个目录，因为整个存储库由项目根目录中的单个 .git 文件夹处理，而不是 subversion 的无数 .svn 目录。

在单个存储库中处理插件的问题是提交到例如*mytheme*会增加*myplugin*的修订号，因此即使在颠覆中，最好使用单独的存储库。

子项目的颠覆范式是[svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)，它在某种程度上转换为git 中的[子模块](http://schacon.github.com/git/git-submodule.html)（但不完全是在你之前使用过 svn:externals 的情况下。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-16T03:13:16.410

正如您的编辑指出的那样，您可以使用两个单独的分支来存储两个单独的目录。这确实使它们都在同一个存储库中，但是您仍然不能跨两个目录树进行提交。如果您有一个更改需要更改另一个，则必须将它们作为两个单独的提交进行，并且您打开了两个目录的一对签出可能不同步的可能性。

如果您想将这对目录视为一个单元，您可以使用 'wordpress/wp-content' 作为 repo 的根目录，并在顶层使用 .gitignore 文件来忽略除两个感兴趣的子目录之外的所有内容。这可能是目前最合理的解决方案。

据称，稀疏结账已经出现了两年，但在 git 开发 repo 中仍然没有任何迹象，也没有任何迹象表明必要的更改将会到达那里。我不会指望他们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-16T14:51:49.477

**这里有灵感。只需使用`shell regex`or `git regex`。**

```
git checkout commit_id */*.bat  # *.bat in 1-depth subdir exclude current dir, shell regex  
git checkout commit_id '*.bat'  # *.bat in all subdir include current dir, git regex 
```

**使用引号转义 shell 正则表达式解释并将通配符传递给 git。**

第一个不是递归的，只有 1-depth 中的文件`subdir`。但第二个是递归的。

**至于您的情况，以下可能就足够了。**

```
git checkout master */*/wp-content/*/*
git checkout master '*/wp-content/*' 
```

只需根据需要修改线路。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-28T17:18:35.917

您只能将未提交的更改还原到特定文件或目录：

```
git checkout [some_dir|file.txt] 
```

# git - 切换分支时出现致命的 Git 错误

> ID：180064
> 
> 赞同：2
> 
> 时间：2008-10-07T19:48:38.597
> 
> 标签：git

错误信息：

> 致命：git checkout：更新路径与切换分支/强制不兼容

如何克服这个 Git 结帐错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T20:22:22.697

通过明确指定“<code>git checkout HEAD $blah”而不是仅仅说“<code>git checkout $blah”，假设您确实想要签出文件。

但是，您不会说出您尝试过的内容或键入的内容，因此除了盲目猜测之外，没有人可以给您任何信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T19:33:14.190

当我遇到此消息时，是因为我试图做`git checkout -f $blah`，期望丢弃本地更改，如`git checkout --help`.

相反，我`rm $blah && git checkout $blah`习惯于丢弃本地更改。

# sql - 在 BEGIN/END TRANSACTION 中执行存储过程

> ID：180075
> 
> 赞同：49
> 
> 时间：2008-10-07T19:50:58.313
> 
> 标签：sql, sql-server, stored-procedures, rollback, sqltransaction

如果我在 SQL 中创建一个存储过程并`EXEC spStoredProcedure`在 BEGIN/END TRANSACTION 中调用它（），那么这个其他存储过程是否也属于该事务？

我不知道它是否像 C# 中的 try/catch 一样工作。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-07T20:11:08.053

是的，您在开始事务和提交（或回滚）之间所做的*一切都是事务的一部分。*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-07T20:16:45.797

听起来不错，非常感谢。我最终做了这样的事情（因为我在 05）

```
 BEGIN TRY
       BEGIN TRANSACTION

       DO SOMETHING

       COMMIT
    END TRY
    BEGIN CATCH
      IF @@TRANCOUNT > 0
         ROLLBACK

      -- Raise an error with the details of the exception
      DECLARE @ErrMsg nvarchar(4000), @ErrSeverity int
      SELECT @ErrMsg = ERROR_MESSAGE(),
             @ErrSeverity = ERROR_SEVERITY()

      RAISERROR(@ErrMsg, @ErrSeverity, 1)
    END CATCH 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-07T20:11:58.207

我相信在 MS SQL Server 中，存储过程的执行会在事务中发生，但要非常小心。如果您有嵌套事务（即，存储过程之外的事务和存储过程内部的不同事务），回滚将影响所有事务，而不仅仅是最近的封闭事务。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-07T20:42:08.863

正如 Chris 所提到的，您应该小心回滚事务。

具体来说：

```
IF @@TRANCOUNT > 0 ROLLBACK 
```

并不总是你想要的。你可以做这样的事情

```
IF(@@TRANCOUNT = 1) ROLLBACK TRAN
ELSE IF(@@TRANCOUNT > 1) COMMIT TRAN
RETURN @error 
```

这样，调用 proc 可以检查存储过程的返回值，并确定它是要提交还是继续冒泡错误。

原因是“提交”只会减少您的交易计数器。一旦它将事务计数器减为零，就会发生实际的提交。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-08T08:57:57.117

正如[Chris](https://stackoverflow.com/questions/180075/executing-a-stored-procedure-inside-beginend-transaction#180166)和[James](https://stackoverflow.com/questions/180075/executing-a-stored-procedure-inside-beginend-transaction#180315)所提到的，在处理嵌套事务时需要小心。[Don Peterson](http://www.sqlservercentral.com/Authors/Articles/Don_Peterson/16830/)在[SQL Server Central](http://www.sqlservercentral.com/)上写了一组非常好的关于事务主题的文章，我建议您阅读这些文章：

这里有：

*   [第1部分](http://www.sqlservercentral.com/articles/Miscellaneous/allabouttransactionspart1/1583/)
*   [第2部分](http://www.sqlservercentral.com/articles/SQL+Puzzles/allabouttransactionspart2/1586/)
*   [第 3 部分](http://www.sqlservercentral.com/articles/Advanced+Querying/allabouttransactionspart3/1624/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T20:14:53.163

是的，所有嵌套的存储过程调用都包含在事务的范围内。如果您使用的是 SQL Server 2005 或更高版本，您也可以使用 Try...Catch。 [这里](http://www.4guysfromrolla.com/webtech/041906-1.shtml)有更多细节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T22:23:14.247

@Chris，我不知道。

当谷歌搜索更多信息时，我遇到了[这个](http://doc.ddart.net/mssql/sql70/sa-ses.htm)- 你可以设置“保存点”，可以回滚而不回滚整个事务。

在这种情况下可能有用。

# c# - 在 C# 中用于应用程序开发的最佳 3rd 方 GUI 框架是什么？

> ID：180081
> 
> 赞同：1
> 
> 时间：2008-10-07T19:51:22.803
> 
> 标签：c#, .net, user-interface

示例可能是 Infragistics 或 DevExpress。

但我也在寻找您对其他框架的意见。如果这是您最喜欢的，它甚至可以是 WPF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T20:09:09.367

基础设施非常好。我认为他们有比网络更好的 Windows 产品。但是，有时我对使用他们的产品感到非常沮丧。我只是想找到一些隐藏的财产，而且是不可能找到的。他们有很多属性。当然，你可以用他们的网格做任何事情，但它应该更容易。所有这些供应商都在相互竞争。你真的必须每年或每两年对它们进行比较。我目前在大多数 web 和 windows 项目上使用 Infragistics。如果我今天可以切换，我会去 DevExpress for Web 和 Windows。Mark Miller 和 DevExpress 的人制作的所有东西都很漂亮，也很周到。另一方面，您应该查看 CodeRush 和 Refactor。我可能听起来像个推销员，但我不是。如果没有 CodeRush，我就无法再编码了。感觉就像用一只手编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T04:14:31.277

我使用了 Telerik RAD Controls for Asp.Net，它是一套非常全面的控件，可以轻松转换为 AJAX。支持是一流的，论坛是在联系工作人员之前首先去研究的地方。

客户端 API 相当容易理解，并且他们有很好的客户端和服务器端代码混合实现的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T19:55:27.977

我会说[基础设施](http://www.infragistics.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T04:04:35.773

以前没用过，但我听说过[Telerik](http://www.telerik.com/)的好消息。我在 Infragistics Web 组件方面的经验并不出色。我发现有很多我需要的隐藏功能，这些功能没有文档记录，不得不在示例代码中四处寻找示例。

这些工具包对 Intranet 应用程序很有意义，但是当您开始在 Web 上提供它时，这些功能可能会以用户更大的下载量为代价。只是要记住的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T19:53:27.917

你在寻找什么框架？我目前在 winform 端使用 Janus Grids 来制作网格，但 DevExpress 有一个很棒的 Web 网格，非常棒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T19:55:06.493

对于当前的 Winforms 开发，我最喜欢的是 Infragistics。DevExpress 似乎有更多的 Silverlight 控件正在开发中，但 Infragistics 可能会提供。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T19:58:40.713

我不做太多非 Web 开发，但如果我愿意，我喜欢将 gtk# 用于 Mono（[截图](http://mono-project.com/Screenshots)）。它比winforms更有趣，也更容易编程。WPF看起来不错，但我只尝试了一个Hello World。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T14:48:27.580

Infragistics 对应用程序有很好的控制。WinGrid 是最重要的工具之一，它可以帮助您专业且快速地显示信息。

唯一的缺点是联系他们的帮助台或搜索隐藏属性的过程非常耗时。但是在你了解它们之后它们确实有效！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-28T05:13:50.110

我想说去 DevExpress 似乎是最优雅、最直观和最完善的文档套件。

在 demos.devexpress.com 中查看他们的产品

对任何组件套件执行相同操作，查看他们的演示并查看最适合您的组件。

# python - 如何在 python 中处理损坏的管道（SIGPIPE）？

> ID：180095
> 
> 赞同：54
> 
> 时间：2008-10-07T19:53:53.097
> 
> 标签：python, python-2.x, broken-pipe

我用 python 编写了一个简单的多线程游戏服务器，它为每个客户端连接创建一个新线程。我发现，由于管道/SIGPIPE 错误，服务器会时不时地崩溃。我很确定当程序尝试将响应发送回不再存在的客户端时会发生这种情况。

有什么好的方法来解决这个问题？我首选的解决方案是简单地关闭与客户端的服务器端连接并继续前进，而不是退出整个程序。

PS：[这个](https://stackoverflow.com/questions/108183/how-to-prevent-sigpipes-or-handle-them-properly)问题/答案以通用的方式处理问题；我应该如何具体解决它？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-08T00:14:18.967

假设您使用的是标准套接字模块，您应该捕获`socket.error: (32, 'Broken pipe')`异常（而不是其他人建议的 IOError）。这将在您描述的情况下提出，即发送/写入远程端已断开连接的套接字。

```
import socket, errno, time

# setup socket to listen for incoming connections
s = socket.socket()
s.bind(('localhost', 1234))
s.listen(1)
remote, address = s.accept()

print "Got connection from: ", address

while 1:
    try:
        remote.send("message to peer\n")
        time.sleep(1)
    except socket.error, e:
        if isinstance(e.args, tuple):
            print "errno is %d" % e[0]
            if e[0] == errno.EPIPE:
               # remote peer disconnected
               print "Detected remote disconnect"
            else:
               # determine and handle different error
               pass
        else:
            print "socket error ", e
        remote.close()
        break
    except IOError, e:
        # Hmmm, Can IOError actually be raised by the socket module?
        print "Got IOError: ", e
        break 
```

请注意，第一次写入已关闭的套接字时并不总是会引发此异常 - 更常见的是第二次写入（除非在第一次写入中写入的字节数大于套接字的缓冲区大小）。您需要记住这一点，以防您的应用程序认为远程端在可能已经断开连接时从第一次写入接收到了数据。

`select.select()`您可以通过使用(或)来降低这种情况的发生率（但不能完全消除`poll`）。在尝试写入之前检查准备好从对等方读取的数据。如果`select`报告有数据可从对等套接字读取，请使用`socket.recv()`. 如果这返回一个空字符串，则远程对等方已关闭连接。因为这里仍然存在竞争条件，所以您仍然需要捕获并处理异常。

Twisted 非常适合这类事情，但是，听起来您已经编写了相当多的代码。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-10-07T20:07:27.263

阅读 try: 声明。

```
try:
    # do something
except socket.error, e:
    # A socket error
except IOError, e:
    if e.errno == errno.EPIPE:
        # EPIPE error
    else:
        # Other error 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T20:55:36.327

`SIGPIPE`（尽管我认为您的意思可能是`EPIPE`？）在您关闭套接字然后向其发送数据时发生在套接字上。简单的解决方案是在尝试发送数据之前不要关闭套接字。这也可能发生在管道上，但听起来不像你正在经历的那样，因为它是一个网络服务器。

您也可以在每个线程的某些顶级处理程序中应用捕获异常的创可贴。

当然，如果您使用[Twisted](http://twistedmatrix.com/)而不是为每个客户端连接生成一个新线程，您可能不会遇到这个问题。如果多个线程正在处理相同的 I/O 通道，那么很难（可能不可能，具体取决于您的应用程序）获得正确的关闭和写入操作的顺序。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-10-26T05:46:49.020

我面临同样的问题。但是我下次提交相同的代码，它就可以了。第一次坏了：

```
$ packet_write_wait: Connection to 10.. port 22: Broken pipe 
```

第二次起作用：

```
[1]   Done                    nohup python -u add_asc_dec.py > add2.log 2>&1 
```

我猜原因可能与当前的服务器环境有关。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-10-07T21:05:54.400

我的答案非常接近 S.Lott 的，但我会更具体：

```
try:
    # do something
except IOError, e:
    # ooops, check the attributes of e to see precisely what happened.
    if e.errno != 23:
        # I don't know how to handle this
        raise 
```

其中“23”是您从 EPIPE 获得的错误编号。这样您就不会尝试处理权限错误或其他任何您不具备的条件。

# java - 动态查找表示原始 Java 类型的类

> ID：180097
> 
> 赞同：53
> 
> 时间：2008-10-07T19:54:25.967
> 
> 标签：java, reflection, types, primitive

我需要在 Java 中进行一些反射方法调用。这些调用将包括具有原始类型（int、double 等）参数的方法。反射性查找方法时指定此类类型的方法是 int.class、double.class 等。

挑战在于我正在接受来自外部源的输入，该输入将动态指定类型。因此，我还需要动态地提出这些类引用。想象一个带有参数类型列表的方法名称列表的分隔文件：

```
doSomething int double
doSomethingElse java.lang.String boolean 
```

如果输入类似于`java.lang.String`，我知道我可以使用`Class.forName("java.lang.String")`该 Class 实例返回。有什么方法可以使用该方法或其他方法来获取原始类型 Classes 吗？

**编辑：** 感谢所有受访者。很明显，没有内置的方法可以干净地做我想做的事，所以我将满足于重用`ClassUtils`Spring 框架中的类。它似乎包含 Class.forName() 的替代品，可以满足我的要求。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-07T20:02:24.593

正如您所说，使用 eg 可以获得原始类型的`Class`实例`int.class`，但也可以使用类似的东西获得相同的值`Integer.TYPE`。每个原始包装类都包含一个静态字段 ，`TYPE`它具有相应的原始类实例。

您无法通过 获取原始类`forName`，但可以从现成的类中获取它。如果你绝对必须使用反射，你可以尝试这样的事情：

```
Class clazz = Class.forName("java.lang.Integer");
Class intClass = clazz.getField("TYPE").get(null);

intClass.equals(int.class);         // => true 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-07T20:12:30.127

Spring 框架包含一个实用程序类[ClassUtils](http://static.springframework.org/spring/docs/1.1.5/api/org/springframework/util/ClassUtils.html)，其中包含静态方法 forName。此方法可用于您描述的确切目的。

如果您不喜欢依赖 Spring：可以找到[该方法的源代码](https://github.com/spring-projects/spring-framework/blob/cc74a2891a4d2a4c7bcec059f20c35aa80bcf668/spring-core/src/main/java/org/springframework/util/ClassUtils.java#L203-L271)~~e. G。[在](http://fisheye1.atlassian.com/browse/springframework/spring/src/org/springframework/util/ClassUtils.java?r=1.77)~~他们的公共存储库中。类源代码在 Apache 2.0 模型下获得许可。

但是请注意，该算法使用原始类型的硬编码映射。

* * *

**编辑：**感谢评论者 Dávid Horváth 和 Patrick 指出断开的链接。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-07T21:18:27.683

可能您只需要映射原语，其余类执行“forName”方法：

我会做类似的事情：

```
void someWhere(){
     String methodDescription = "doSomething int double java.lang.Integer java.lang.String"
     String [] parts = methodDescription.split();
     String methodName= parts[0]
     Class [] paramsTypes = getParamTypes( parts ); // Well, not all the array, but a, sub array from 1 to arr.length..  

    Method m = someObject.class.getMethod( methodName, paramTypes );
    etc. etc etc.
}

public Class[] paramTypes( String [] array ){
     List<Class> list = new ArrayList<Class>();
     for( String type : array ) {
         if( builtInMap.contains( type )) {
             list.add( builtInMap.get( type ) );
          }else{
             list.add( Class.forName( type ) );
          }
     }
     return list.toArray();
}  

    // That's right.
Map<String,Class> builtInMap = new HashMap<String,Class>();{
       builtInMap.put("int", Integer.TYPE );
       builtInMap.put("long", Long.TYPE );
       builtInMap.put("double", Double.TYPE );
       builtInMap.put("float", Float.TYPE );
       builtInMap.put("bool", Boolean.TYPE );
       builtInMap.put("char", Character.TYPE );
       builtInMap.put("byte", Byte.TYPE );
       builtInMap.put("void", Void.TYPE );
       builtInMap.put("short", Short.TYPE );
} 
```

也就是说，创建一个存储原始类型的映射，如果描述属于原始类型，则使用映射类。该映射也可以从外部配置文件加载，以增加灵活性，因此您可以将 String 添加为内置而不是 java.lang.String 或可能具有这样的方法。

“doSomething 字符串是|否”

在 Struts、Hibernate、Spring 和 Apache libs 等 OS 项目中有大量此类代码（仅举几例），因此您无需从零开始。

顺便提一句。我没有编译上面的代码，但我很确定它只需稍加修改就可以工作，不要对此投反对票。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-25T08:06:35.093

[Apache Commons Lang](http://commons.apache.org/proper/commons-lang/)有[ClassUtils.getClass(String)](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/ClassUtils.html#getClass%28java.lang.String%29)，它支持原始类型。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-14T21:10:13.907

不幸的是，许多 Class 方法不能以一致的方式处理原语。在 forName 中解决这个问题的一种常见方法是有一个类似的表；

```
private static final Map<String, Class> BUILT_IN_MAP = 
    new ConcurrentHashMap<String, Class>();

static {
    for (Class c : new Class[]{void.class, boolean.class, byte.class, char.class,  
            short.class, int.class, float.class, double.class, long.class})
        BUILT_IN_MAP.put(c.getName(), c);
}

public static Class forName(String name) throws ClassNotFoundException {
    Class c = BUILT_IN_MAP.get(name);
    if (c == null)
        // assumes you have only one class loader!
        BUILT_IN_MAP.put(name, c = Class.forName(name));
    return c;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-01T06:26:13.967

下面的代码讨论了如何获取字段名称已知的原始类型的类，例如在本例中为“sampleInt”。

```
public class CheckPrimitve {
    public static void main(String[] args) {
        Sample s = new Sample();
        try {
            System.out.println(s.getClass().getField("sampleInt").getType() == int.class); // returns true
            System.out.println(s.getClass().getField("sampleInt").getType().isPrimitive()); // returns true
        } catch (NoSuchFieldException e) {          
            e.printStackTrace();
        } catch (SecurityException e) {
            e.printStackTrace();
        }       
    }
}

class Sample {
    public int sampleInt;
    public Sample() {
        sampleInt = 10;
    }
} 
```

还可以通过获取给定值的相应包装类或其字段值来检查给定值是否为原始值。

```
 public class CheckPrimitve {
        public static void main(String[] args) {
            int i = 3;
            Object o = i;
            System.out.println(o.getClass().getSimpleName().equals("Integer")); // returns true
            Field[] fields = o.getClass().getFields();
            for(Field field:fields) {
                System.out.println(field.getType()); // returns {int, int, class java.lang.Class, int}
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-08T14:05:51.883

Google Guava 提供`com.google.common.primitives.Primitives`这类东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-25T19:32:46.483

您可以使用此代码:)

```
/**
 * Get an array class of the given class.
 *
 * @param klass to get an array class of
 * @param <C>   the targeted class
 * @return an array class of the given class
 */
public static <C> Class<C[]> arrayClass(Class<C> klass) {
    return (Class<C[]>) Array.newInstance(klass, 0).getClass();
}

/**
 * Get the class that extends {@link Object} that represent the given class.
 *
 * @param klass to get the object class of
 * @return the class that extends Object class and represent the given class
 */
public static Class<?> objectiveClass(Class<?> klass) {
    Class<?> component = klass.getComponentType();
    if (component != null) {
        if (component.isPrimitive() || component.isArray())
            return Reflect.arrayClass(Reflect.objectiveClass(component));
    } else if (klass.isPrimitive()) {
        if (klass == char.class)
            return Character.class;
        if (klass == int.class)
            return Integer.class;
        if (klass == boolean.class)
            return Boolean.class;
        if (klass == byte.class)
            return Byte.class;
        if (klass == double.class)
            return Double.class;
        if (klass == float.class)
            return Float.class;
        if (klass == long.class)
            return Long.class;
        if (klass == short.class)
            return Short.class;
    }

    return klass;
}

/**
 * Get the class that don't extends {@link Object} from the given class.
 *
 * @param klass to get the non-object class of
 * @return the non-object class of the given class
 * @throws IllegalArgumentException when the given class don't have a primitive type
 */
public static Class<?> primitiveClass(Class<?> klass) {
    if (klass == Character.class)
        return char.class;
    if (klass == Integer.class)
        return int.class;
    if (klass == Boolean.class)
        return boolean.class;
    if (klass == Byte.class)
        return byte.class;
    if (klass == Double.class)
        return double.class;
    if (klass == Float.class)
        return float.class;
    if (klass == Long.class)
        return long.class;
    if (klass == Short.class)
        return short.class;

    throw new IllegalArgumentException(klass + " don't have a primitive type");
} 
```

# javascript - 如何在 .ready() 期间更改文档的标题？

> ID：180103
> 
> 赞同：149
> 
> 时间：2008-10-07T19:55:10.770
> 
> 标签：javascript, jquery, ruby-on-rails

我在 Ruby on Rails 中使用了一些嵌套布局，在其中一个布局中，我需要从 div 读取字符串并将其设置为文档的标题。设置文档标题的正确方法（如果有）是什么？

```
<script type="text/javascript">
$(document).ready(function() {

    // ???

});
</script> 
```

* * *

## 回答 #1

> 赞同：316
> 
> 时间：2008-10-07T20:00:05.487

以下应该可以工作，但它不会与 SEO 兼容。最好将标题放在标题标签中。

```
<script type="text/javascript">

    $(document).ready(function() {
        document.title = 'blah';
    });

</script> 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2010-10-31T13:31:39.043

不要使用`$('title').text('hi')`，因为 IE 不支持。

最好使用`document.title = 'new title';`

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2011-02-14T06:52:44.780

这在所有浏览器中都可以正常工作...

```
$(document).attr("title", "New Title"); 
```

也可以在 IE 中使用

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-07T19:57:32.403

像这样：

```
$(document).ready(function ()
{
    document.title = "Hello World!";
}); 
```

如果您希望您的网站被搜索引擎正确索引，请务必设置默认标题。

一个小提示：

```
$(function ()
{
    // this is a shorthand for the whole document-ready thing
    // In my opinion, it's more readable 
}); 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-07T19:58:29.030

```
<script type="text/javascript">
$(document).ready(function() {

    $(this).attr("title", "sometitle");

});
</script> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-06-23T17:29:00.873

document.title 不适合我。

这是使用 JQuery 的另一种方法

```
$('html head').find('title').text("My New Page Title"); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-09T19:41:01.200

> 我在 Ruby on Rails 中使用了一些嵌套布局，在其中一个布局中，我需要从 div 读取字符串并将其设置为文档的标题。

正确的方法是在服务器端。

在您的布局中，有时会有一些代码*将文本放入 div 中*。使此代码还设置一些实例变量，例如`@page_title`，然后在您的外部布局中执行此操作`<%= @page_title || 'Default Title' %>`

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-11-09T09:43:32.433

如果你有一个响应当前标题会话的服务器端脚本 get_title.php，这在 jQuery 中可以正常工作：

```
$.get('get_title.php',function(*respons*){
    title=*respons* + 'whatever you want'   
    $(document).attr('title',title)
}) 
```

# apache-flex - 检测用户何时离开 Flex 中的页面/浏览器

> ID：180107
> 
> 赞同：2
> 
> 时间：2008-10-07T19:56:09.270
> 
> 标签：apache-flex, actionscript-3

我有一个包含 Flex 应用程序的 HTML 包装器，是否有一个我可以监听的事件，当用户通过导航箭头或关闭浏览器离开 HTML 包装器时触发该事件？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T14:29:33.907

您还可以在 Flash 中侦听 Event.ACTIVATE 和 Event.DEACTIVATE。当 Flash/AIR 从操作系统获得或失去焦点时，所有 EventDispatcher 都会收到这些事件。

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/EventDispatcher.html#event:deactivate](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/EventDispatcher.html#event:deactivate)

当您提供一个打开新窗口的链接并且您想要减少功能和负载（例如暂停和静音视频）然后在用户回来时恢复时，这非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T20:20:47.300

编辑：我意识到这可能不是您所要求的，但我会留下它，以防它对任何寻找它的人有帮助。另请注意，您可以在 onbeforeunload 事件中执行其他操作，这些操作通常会在用户访问确认对话框之前可靠地执行，除非您的卸载例程过于复杂（在这种情况下，您应该考虑改变您的设计）。

* * *

onbeforeunload 让您中断页面卸载：

```
window.onbeforeunload = function(e) {
    // Browser will pop up a confirmation dialog, with some text before
    // and after your return string; try it in different browsers to
    // see how they behave.
    return 'String to confirm';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T20:04:32.933

有 Body.onUnload，但我不确定它实际上有多可靠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T20:05:00.420

我为此找到的最接近的是 javascript window.onunload 事件。但是，您无法在 Flex 应用程序中真正听到这一点，因为在调用 unload 方法时应用程序可能不再运行。我们已经使用它通过 javascript 向页面的其他部分发出信号，表明应用程序已卸载，因此取决于您需要做什么，这可能就足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T06:56:31.507

问题是，当用户离开时你需要做什么？

如果您需要在服务器上执行操作，那么处理此问题的最佳方法是在您的 swf 初始化时打开一个 Socket()，然后当用户导航离开时，该套接字将被终止，并且服务器可以检测到并执行额外的逻辑。

如果您需要执行客户端操作，例如保存 SharedObject，那么您不能依赖插件的“最后一件事”事件，因为有很多方法可以关闭插件会话。在这种情况下，最好的办法是每隔几秒就不断地保存 SharedObjects。

# c# - 设计游戏对象

> ID：180119
> 
> 赞同：10
> 
> 时间：2008-10-07T19:57:54.850
> 
> 标签：c#, oop, xna

我最近开始使用 Microsoft XNA 和 C# 开发一个小游戏以供自己娱乐。我的问题是关于设计游戏对象和继承它的对象。我将把游戏对象定义为可以在屏幕上渲染的东西。因此，为此，我决定创建一个基类，所有其他需要渲染的对象都将继承它，称为 GameObject。下面的代码是我做的类：

```
class GameObject
{
    private Model model = null;
    private float scale = 1f;
    private Vector3 position = Vector3.Zero;
    private Vector3 rotation = Vector3.Zero;
    private Vector3 velocity = Vector3.Zero;
    private bool alive = false;
    protected ContentManager content;

    #region Constructors
    public GameObject(ContentManager content, string modelResource)
    {
        this.content = content;
        model = content.Load<Model>(modelResource);
    }
    public GameObject(ContentManager content, string modelResource, bool alive)
        : this(content, modelResource)
    {
        this.alive = alive;
    }
    public GameObject(ContentManager content, string modelResource, bool alive, float scale)
        : this(content, modelResource, alive)
    {
        this.scale = scale;
    }
    public GameObject(ContentManager content, string modelResource, bool alive, float scale, Vector3 position)
        : this(content, modelResource, alive, scale)
    {
        this.position = position;
    }
    public GameObject(ContentManager content, string modelResource, bool alive, float scale, Vector3 position, Vector3 rotation)
        : this(content, modelResource, alive, scale, position)
    {
        this.rotation = rotation;
    }
    public GameObject(ContentManager content, string modelResource, bool alive, float scale, Vector3 position, Vector3 rotation, Vector3 velocity)
        : this(content, modelResource, alive, scale, position, rotation)
    {
        this.velocity = velocity;
    }
    #endregion
} 
```

我省略了执行旋转、移动和绘制对象等操作的额外方法。现在如果我想创建另一个对象，比如船，我会创建一个 Ship 类，它会继承 GameObject。下面的示例代码：

```
class Ship : GameObject
{
    private int num_missiles = 20; // the number of missiles this ship can have alive at any given time
    private Missile[] missiles;
    private float max_missile_distance = 3000f; // max distance a missile can be from the ship before it dies

    #region Constructors
    public Ship(ContentManager content, string modelResource)
        : base(content, modelResource)
    {
        InitShip();
    }
    public Ship(ContentManager content, string modelResource , bool alive)
        : base(content, modelResource, alive)
    {
        InitShip();
    }
    public Ship(ContentManager content, string modelResource, bool alive, float scale)
        : base(content, modelResource, alive, scale)
    {
        InitShip();
    }
    public Ship(ContentManager content, string modelResource, bool alive, float scale, Vector3 position)
        : base(content, modelResource, alive, scale, position)
    {
        InitShip();
    }
    public Ship(ContentManager content, string modelResource, bool alive, float scale, Vector3 position, Vector3 rotation)
        : base(content, modelResource, alive, scale, position, rotation)
    {
        InitShip();
    }
    public Ship(ContentManager content, string modelResource, bool alive, float scale, Vector3 position, Vector3 rotation, Vector3 velocity)
        : base(content, modelResource, alive, scale, position, rotation, velocity)
    {
        InitShip();
    }
    #endregion
} 
```

同样，我省略了任何额外的特定于舰船的方法，例如发射导弹。您认为这种设计是好的还是应该以某种方式改进或完全改变？似乎子类的构造函数很乱，但也许这是唯一的方法。我从来没有做过这样的事情，我想知道我是否偏离了轨道。

* * *

感谢所有留下答案的人。他们都非常有帮助。似乎有一个普遍的共识，那就是改变它以使用 MVC 模式是最好的。我将进一步研究如何做到这一点。我还将删除大部分构造函数，并且将只有一个构造函数，因为 modelResource 之后的所有参数都不是创建对象所必需的，并且它们都可以在以后通过方法调用进行更改。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-07T20:13:44.257

就我个人而言，我发现你的构造函数的数量有点令人反感，但这是你的选择，从根本上没有错 :)

关于从公共基础派生游戏对象的一般策略，这是一种非常常见的做事方式。标准，甚至。我倾向于开始使用更类似于 MVC 的东西，使用仅包含数据的非常轻量级的“模型”游戏对象。

我在 XNA 中看到的其他常见方法包括/您可能需要考虑的事情：

*   IRenderable 接口的实现，而不是在基类或派生类中执行任何渲染代码。例如，您可能想要从不渲染的游戏对象——航点或类似的东西。
*   你可以让你的基类抽象，你可能不想实例化一个游戏对象。

不过，再一次，小问题。你的设计很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T22:14:04.217

由于您问的是与设计相关的问题，因此我将尝试提供一些提示，而不是您发布的大量代码，因为其他人已经开始这样做了。

游戏非常适合[模型-视图-控制器模式](http://en.wikipedia.org/wiki/Model_view_controller)。您正在明确谈论显示部分，但**请考虑一下：那里有向量等，这通常是您正在建模的一部分**。将游戏世界和其中的对象视为模型。他们有一个位置，他们可能有速度和方向。这就是 MVC 的模型部分。

我注意到你希望让船着火。您可能希望机械师在控制器类中使飞船开火，例如需要键盘输入的东西。这个**控制器类将向模型部分发送消息**。您可能想要的一个合理且简单的想法是在模型上使用一些 fireAction() 方法。在您的基本模型上，这可能是一个可覆盖的（虚拟的、抽象的）方法。在船上，它可能会为游戏世界增添一颗“子弹”。

看到我已经写了这么多关于模型行为的文章，还有另一件事对我有很大帮助：使用[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)使类的行为可交换。如果您认为 AI 并希望**在未来某个时候改变行为，那么****策略模式**也很棒。您现在可能不知道，但一个月后您可能希望将弹道导弹作为默认导弹，如果您使用了策略模式，以后可以轻松更改它。

 **所以最终你可能想要真正做一个显示类之类的东西。它将具有您命名的原语：旋转、平移等。并且您想从中派生以添加更多功能或更改功能。**但是想一想，一旦你拥有了不止一艘船**，一种特殊的船，另一种特殊的船，你会遇到推导地狱**，你会复制很多代码**。再次，使用策略模式。记住要保持简单。Displayble 类需要具备什么？

*   意味着知道它相对于屏幕的位置。它可以，这要归功于它的世界对象模型和类似于游戏世界模型的东西！
*   它必须知道要为其模型及其尺寸显示的位图。
*   它必须知道是否有任何东西应该阻止它绘制，如果绘制引擎没有处理（即另一个对象遮挡它）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-07T21:47:29.933

不仅构造函数的数量是一个潜在的问题（尤其是必须为每个派生类重新定义它们），而且构造函数的参数数量也可能成为一个问题。即使您使可选参数可以为空，以后也很难阅读和维护代码。

如果我写：

```
new Ship(content, "resource", true, null, null, null, null); 
```

第二个NULL有什么作用？

如果参数列表超过四个或五个参数，使用结构来保存参数会使代码更具可读性（但更冗长）：

```
GameObjectParams params(content, "resource");
params.IsAlive = true;
new Ship(params); 
```

有很多方法可以做到这一点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-07T20:05:53.383

这种设计没有分离对象的 UI 部分和对象的行为部分，可以说是“模型”和“视图”。这不一定是坏事，但如果继续这种设计，您可能会发现以下重构很困难：

*   通过更改所有艺术资产重新设计游戏
*   更改许多不同的游戏内对象的行为，例如确定对象是否存在的规则
*   更改为不同的精灵引擎。

但是，如果您对这些折衷感到满意并且此设计对您有意义，那么我认为它没有什么严重的错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-07T20:20:19.063

我对您在矢量中旋转的存储方法非常感兴趣。这是如何运作的？如果你存储 X、Y、Z 轴的角度（所谓的欧拉角），你应该重新考虑这个想法，如果你想创建一个 3D 游戏，因为你会在第一次渲染邪恶的[**GIMBAL LOCK后不久遇到**](http://en.wikipedia.org/wiki/Gimbal_lock)

就我个人而言，我不喜欢那里有那么多构造函数，因为您可以提供 1 个构造函数并将所有不需要的参数设置为 null。这样，您的界面就会保持清洁。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-07T21:14:02.280

I also heavily recommend looking into a component based design using composition rather than inheritance. The gist of the idea is to model object based on their underlying properties, and allow the properties to do all of the work for you.

In your case, a GameObject may have properties like being able to move, being renderable, or having some state. These seperate functions (or behaviors) can be modeled as objects and composed in the GameObject to build the functionality you desire.

Honestly though, for a small project you're working on I would focus on making the game functional rather than worry about details like coupling and abstraction.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T20:56:35.653

The people here talking about separating Model from View are correct. To put it in more game developer oriented terms, you should have separate classes for GameObject and RenderObject. Think back to your main game loop:

```
// main loop
while (true) {
    ProcessInput();  // handle input events
    UpdateGameWorld();  // update game objects
    RenderFrame();  // each render object draws itself
} 
```

You want the process of updating your game world and rendering your current frame to be as separate as possible.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-07T21:14:40.047

Alternatively you can make a struct or helper class to hold all the data and have the many constructors in the struct, that way you only have to have tons constructors in 1 object rather than in every class that inherits from GameObject

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-07T20:14:07.440

根据调用构造函数的频率，您可以考虑将所有额外参数设为可为空，并在它们没有值时将 null 传递给它们。Messier 创建对象，更少的构造函数

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-07T20:18:57.040

我第一次在 XNA 中创建游戏时走这条路，但下一次我会做更多的模型/视图类型的方法。Model 对象将是您在 Update 循环中处理的内容，而您的 Views 将在您的 Draw 循环中使用。

当我想使用我的精灵对象来处理 3D 和 2D 对象时，我遇到了不将模型与视图分离的麻烦。它很快就变得非常混乱。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-07T21:51:49.690

第一场比赛？开始**简单**。您的基础游戏对象（在您的情况下更恰当地称为 DrawableGameObject [注意 XNA 中的 DrawableGameComponent 类]）应该只包含属于所有游戏对象的信息。您的 live 和 velocity 变量并不真正属于。正如其他人所提到的，您可能不想混合绘图和更新逻辑。

Velocity 应该在 Mobile 类中，该类应该处理更新逻辑以更改 GameObject 的位置。您可能还需要考虑跟踪加速度，并在玩家按住按钮时稳定增加，并在玩家释放按钮后稳定减少（而不是使用恒定加速度）......但这更多是游戏设计决定而不是班级组织决定。

“活着”的含义可能因上下文而异。在一个简单的太空射击游戏中，不存在的东西可能应该被摧毁（可能用几块太空碎片代替？）。如果是重生的玩家，您需要确保玩家与飞船分开。船没有重生，船被摧毁，玩家得到一艘新船（在内存中回收旧船而不是删除它并创建新船将使用更少的周期 - 你可以简单地将船移到无人船- 完全着陆或将其从游戏场景中拉出并在重生后将其放回）。

另一件你应该注意的事情......不要让你的玩家在你的垂直轴上直接向上或向下看，否则你会遇到，正如彼得帕克所说，万向节锁定问题（你不想搞砸如果您是为了好玩而进行游戏开发！）。更好的是……从 2D 开始（或者至少，将运动限制在 2 维）！当您不熟悉游戏开发时，这会容易得多。

不过，我建议在进行更多编程之前遵循[XNA Creators Club 入门指南。](http://creators.xna.com/en-US/education/gettingstarted)您还应该考虑寻找一些其他更通用的游戏开发指南，以获得一些替代建议。

# c# - 生成 Reporting Services 2005 PDF 报告并将其存储在磁盘上

> ID：180133
> 
> 赞同：1
> 
> 时间：2008-10-07T20:00:46.670
> 
> 标签：c#, asp.net, sql-server, pdf, reporting-services

有没有一种简单的方法可以从已上传到报告管理器的 RDL 生成 PDF 报告并将该文件放在服务器磁盘上的某个位置？我已经在磁盘上有一个位置来放置文件，我只需要知道如何以编程方式生成 PDF。这适用于 SQL Server 2005 报告服务。VB 或 C# 中的代码都可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T20:20:29.813

本文**[将向](http://geekswithblogs.net/bsherwin/archive/2007/04/29/112094.aspx)**您展示如何在不使用报表查看器的情况下从报表服务生成 PDF 报表。您唯一需要做的更改是将结果字节数组写入文件流，而不是如该示例所示将其发送到响应流。上述示例是使用 SQL 报告服务提供的 Web 服务生成报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T20:27:02.827

您必须以编程方式进行吗？报表管理器已经内置了这个功能。您只需为该报告设置新订阅。不要将传递设置为电子邮件，而是将其更改为 Windows 文件共享。您还可以在这些选项中将报告格式更改为 PDF。

# java - 如何在 Java 中计时方法的执行？

> ID：180158
> 
> 赞同：956
> 
> 时间：2008-10-07T20:10:25.200
> 
> 标签：java, timing, execution-time

1.  如何获取方法的执行时间？
2.  是否有一个`Timer`实用程序类用于计时任务需要多长时间等？

Google 上的大多数搜索都会返回调度线程和任务的计时器的结果，这不是我想要的。

* * *

## 回答 #1

> 赞同：1373
> 
> 时间：2008-10-07T20:16:16.373

总是有老式的方法：

```
long startTime = System.nanoTime();
methodToTime();
long endTime = System.nanoTime();

long duration = (endTime - startTime);  //divide by 1000000 to get milliseconds. 
```

* * *

## 回答 #2

> 赞同：240
> 
> 时间：2008-10-07T20:14:29.560

我选择简单的答案。为我工作。

```
long startTime = System.currentTimeMillis();

doReallyLongThing();

long endTime = System.currentTimeMillis();

System.out.println("That took " + (endTime - startTime) + " milliseconds"); 
```

它工作得很好。分辨率显然只有毫秒，使用 System.nanoTime() 可以做得更好。两者都有一些限制（操作系统调度切片等），但这工作得很好。

几次运行的平均值（越多越好），你会得到一个不错的主意。

* * *

## 回答 #3

> 赞同：194
> 
> 时间：2013-03-13T20:11:24.663

拜托了伙计们！没有人提到[Guava](http://code.google.com/p/guava-libraries/)的方法（可以说是很棒的）：

```
import com.google.common.base.Stopwatch;

Stopwatch timer = Stopwatch.createStarted();
//method invocation
LOG.info("Method took: " + timer.stop()); 
```

好消息是 Stopwatch.toString() 在为测量选择时间单位方面做得很好。即数值小则输出38ns，长则显示5m 3s

更好的是：

```
Stopwatch timer = Stopwatch.createUnstarted();
for (...) {
   timer.start();
   methodToTrackTimeFor();
   timer.stop();
   methodNotToTrackTimeFor();
}
LOG.info("Method took: " + timer); 
```

*注意：Google Guava 需要 Java 1.6+*

* * *

## 回答 #4

> 赞同：165
> 
> 时间：2015-02-02T09:19:33.953

使用Java 8 新 API 中的[Instant](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)和[Duration ，](https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)

```
Instant start = Instant.now();
Thread.sleep(5000);
Instant end = Instant.now();
System.out.println(Duration.between(start, end)); 
```

输出，

```
PT5S 
```

* * *

## 回答 #5

> 赞同：137
> 
> 时间：2015-12-04T10:43:43.500

*将所有可能的方式聚集到一个地方。*

**[日期](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)**

```
Date startDate = Calendar.getInstance().getTime();
long d_StartTime = new Date().getTime();
Thread.sleep(1000 * 4);
Date endDate = Calendar.getInstance().getTime();
long d_endTime = new Date().getTime();
System.out.format("StartDate : %s, EndDate : %s \n", startDate, endDate);
System.out.format("Milli = %s, ( D_Start : %s, D_End : %s ) \n", (d_endTime - d_StartTime),d_StartTime, d_endTime); 
```

**系统。[当前时间米利斯（）](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis())**

```
long startTime = System.currentTimeMillis();
Thread.sleep(1000 * 4);
long endTime = System.currentTimeMillis();
long duration = (endTime - startTime);  
System.out.format("Milli = %s, ( S_Start : %s, S_End : %s ) \n", duration, startTime, endTime );
System.out.println("Human-Readable format : "+millisToShortDHMS( duration ) ); 
```

**人类可读[格式](http://www.rgagnon.com/javadetails/java-0585.html)**

```
public static String millisToShortDHMS(long duration) {
    String res = "";    // java.util.concurrent.TimeUnit;
    long days       = TimeUnit.MILLISECONDS.toDays(duration);
    long hours      = TimeUnit.MILLISECONDS.toHours(duration) -
                      TimeUnit.DAYS.toHours(TimeUnit.MILLISECONDS.toDays(duration));
    long minutes    = TimeUnit.MILLISECONDS.toMinutes(duration) -
                      TimeUnit.HOURS.toMinutes(TimeUnit.MILLISECONDS.toHours(duration));
    long seconds    = TimeUnit.MILLISECONDS.toSeconds(duration) -
                      TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(duration));
    long millis     = TimeUnit.MILLISECONDS.toMillis(duration) - 
                      TimeUnit.SECONDS.toMillis(TimeUnit.MILLISECONDS.toSeconds(duration));

    if (days == 0)      res = String.format("%02d:%02d:%02d.%04d", hours, minutes, seconds, millis);
    else                res = String.format("%dd %02d:%02d:%02d.%04d", days, hours, minutes, seconds, millis);
    return res;
} 
```

**Guava: Google** [**Stopwatch**](https://google.github.io/guava/releases/24.0-jre/api/docs/com/google/common/base/Stopwatch.html) ^([JAR](http://mvnrepository.com/artifact/com.google.guava/guava/24.1-jre)) « 秒表的一个对象是以纳秒为单位测量经过的时间。

```
com.google.common.base.Stopwatch g_SW = Stopwatch.createUnstarted();
g_SW.start();
Thread.sleep(1000 * 4);
g_SW.stop();
System.out.println("Google StopWatch  : "+g_SW); 
```

**Apache Commons Lang ^([JAR](http://mvnrepository.com/artifact/org.apache.commons/commons-lang3/3.4)) « [StopWatch](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/StopWatch.html)**为计时提供了方便的 API。

```
org.apache.commons.lang3.time.StopWatch sw = new StopWatch();
sw.start();     
Thread.sleep(1000 * 4);     
sw.stop();
System.out.println("Apache StopWatch  : "+ millisToShortDHMS(sw.getTime()) ); 
```

**[乔达](http://mvnrepository.com/artifact/joda-time/joda-time)时代**

```
public static void jodaTime() throws InterruptedException, ParseException{
    java.text.SimpleDateFormat ms_SDF = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss.SSS");
    String start = ms_SDF.format( new Date() ); // java.util.Date

    Thread.sleep(10000);

    String end = ms_SDF.format( new Date() );       
    System.out.println("Start:"+start+"\t Stop:"+end);

    Date date_1 = ms_SDF.parse(start);
    Date date_2 = ms_SDF.parse(end);        
    Interval interval = new org.joda.time.Interval( date_1.getTime(), date_2.getTime() );
    Period period = interval.toPeriod(); //org.joda.time.Period

    System.out.format("%dY/%dM/%dD, %02d:%02d:%02d.%04d \n", 
        period.getYears(), period.getMonths(), period.getDays(),
        period.getHours(), period.getMinutes(), period.getSeconds(), period.getMillis());
} 
```

**Java 8 中**的 Java 日期时间 API « [Duration](https://docs.oracle.com/javase/tutorial/datetime/iso/period.html)对象表示两个[Instant](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)对象之间的时间段。

```
Instant start = java.time.Instant.now();
    Thread.sleep(1000);
Instant end = java.time.Instant.now();
Duration between = java.time.Duration.between(start, end);
System.out.println( between ); // PT1.001S
System.out.format("%dD, %02d:%02d:%02d.%04d \n", between.toDays(),
        between.toHours(), between.toMinutes(), between.getSeconds(), between.toMillis()); // 0D, 00:00:01.1001 
```

* * *

[**Spring Framework**](https://spring.io/)提供了[StopWatch](https://docs.spring.io/spring/docs/2.0.x/javadoc-api/org/springframework/util/StopWatch.html)实用程序类来测量 Java 中的经过时间。

```
StopWatch sw = new org.springframework.util.StopWatch();
sw.start("Method-1"); // Start a named task
    Thread.sleep(500);
sw.stop();

sw.start("Method-2");
    Thread.sleep(300);
sw.stop();

sw.start("Method-3");
    Thread.sleep(200);
sw.stop();

System.out.println("Total time in milliseconds for all tasks :\n"+sw.getTotalTimeMillis());
System.out.println("Table describing all tasks performed :\n"+sw.prettyPrint());

System.out.format("Time taken by the last task : [%s]:[%d]", 
        sw.getLastTaskName(),sw.getLastTaskTimeMillis());

System.out.println("\n Array of the data for tasks performed « Task Name: Time Taken");
TaskInfo[] listofTasks = sw.getTaskInfo();
for (TaskInfo task : listofTasks) {
    System.out.format("[%s]:[%d]\n", 
            task.getTaskName(), task.getTimeMillis());
} 
```

输出：

```
Total time in milliseconds for all tasks :
999
Table describing all tasks performed :
StopWatch '': running time (millis) = 999
-----------------------------------------
ms     %     Task name
-----------------------------------------
00500  050%  Method-1
00299  030%  Method-2
00200  020%  Method-3

Time taken by the last task : [Method-3]:[200]
 Array of the data for tasks performed « Task Name: Time Taken
[Method-1]:[500]
[Method-2]:[299]
[Method-3]:[200] 
```

* * *

## 回答 #6

> 赞同：90
> 
> 时间：2008-10-07T21:35:58.927

使用分析器（JProfiler、Netbeans Profiler、Visual VM、Eclipse Profiler 等）。您将获得最准确的结果，并且干扰最少。他们使用内置的 JVM 机制进行分析，如果需要，还可以为您提供额外的信息，如堆栈跟踪、执行路径和更全面的结果。

当使用一个完全集成的分析器时，分析一个方法是非常简单的。右键单击，Profiler -> 添加到根方法。然后像进行测试运行或调试器一样运行分析器。

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2014-04-06T13:46:01.810

`System.currentTimeMillis();`不是衡量算法性能的好方法。它衡量您作为用户观看计算机屏幕所经历的总时间。它还包括在您的计算机上在后台运行的所有其他内容所消耗的时间。如果您的工作站上有很多程序正在运行，这可能会产生巨大的影响。

正确的方法是使用`java.lang.management`包。

来自[http://nadeausoftware.com/articles/2008/03/java_tip_how_get_cpu_and_user_time_benchmarking](http://nadeausoftware.com/articles/2008/03/java_tip_how_get_cpu_and_user_time_benchmarking)网站（[存档链接](https://web.archive.org/web/20190413083329/http://nadeausoftware.com/articles/2008/03/java_tip_how_get_cpu_and_user_time_benchmarking)）：

*   “用户时间”是运行应用程序自己的代码所花费的时间。
*   “系统时间”是代表您的应用程序（例如 I/O）运行操作系统代码所花费的时间。

`getCpuTime()`方法给你这些总和：

```
import java.lang.management.ManagementFactory;
import java.lang.management.ThreadMXBean;

public class CPUUtils {

    /** Get CPU time in nanoseconds. */
    public static long getCpuTime( ) {
        ThreadMXBean bean = ManagementFactory.getThreadMXBean( );
        return bean.isCurrentThreadCpuTimeSupported( ) ?
            bean.getCurrentThreadCpuTime( ) : 0L;
    }

    /** Get user time in nanoseconds. */
    public static long getUserTime( ) {
        ThreadMXBean bean = ManagementFactory.getThreadMXBean( );
        return bean.isCurrentThreadCpuTimeSupported( ) ?
            bean.getCurrentThreadUserTime( ) : 0L;
    }

    /** Get system time in nanoseconds. */
    public static long getSystemTime( ) {
        ThreadMXBean bean = ManagementFactory.getThreadMXBean( );
        return bean.isCurrentThreadCpuTimeSupported( ) ?
            (bean.getCurrentThreadCpuTime( ) - bean.getCurrentThreadUserTime( )) : 0L;
    }

} 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2008-10-07T20:13:00.640

这可能不是您要我说的，但这是 AOP 的一个很好的用途。在您的方法周围使用代理拦截器，并在那里进行计时。

遗憾的是，AOP 的内容、原因和方式超出了这个答案的范围，但我可能会这样做。

编辑：如果您愿意的话，[这里有一个指向 Spring AOP 的链接](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html)，可以帮助您入门。这是 Iive 为 java 遇到的最容易访问的 AOP 实现。

另外，鉴于其他人的非常简单的建议，我应该补充一点，AOP 适用于您不希望诸如时间之类的东西侵入您的代码时。但在很多情况下，那种简单易行的方法就可以了。

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2015-11-25T22:47:42.793

使用 Java 8，您还可以对每个普通**方法**执行类似的操作：

```
Object returnValue = TimeIt.printTime(() -> methodeWithReturnValue());
//do stuff with your returnValue 
```

与 TimeIt 一样：

```
public class TimeIt {

public static <T> T printTime(Callable<T> task) {
    T call = null;
    try {
        long startTime = System.currentTimeMillis();
        call = task.call();
        System.out.print((System.currentTimeMillis() - startTime) / 1000d + "s");
    } catch (Exception e) {
        //...
    }
    return call;
}
} 
```

使用这种方法，您可以在代码中的任何位置轻松测量时间而不会破坏它。在这个简单的例子中，我只是打印时间。您可以为 TimeIt 添加一个 Switch，例如仅在 DebugMode 或其他方式下打印时间。

如果您正在使用**Function**，您可以执行以下操作：

```
Function<Integer, Integer> yourFunction= (n) -> {
        return IntStream.range(0, n).reduce(0, (a, b) -> a + b);
    };

Integer returnValue = TimeIt.printTime2(yourFunction).apply(10000);
//do stuff with your returnValue

public static <T, R> Function<T, R> printTime2(Function<T, R> task) {
    return (t) -> {
        long startTime = System.currentTimeMillis();
        R apply = task.apply(t);
        System.out.print((System.currentTimeMillis() - startTime) / 1000d
                + "s");
        return apply;
    };
} 
```

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2011-12-03T04:37:24.460

我们也可以使用 Apache commons 的 StopWatch 类来测量时间。

示例代码

```
org.apache.commons.lang.time.StopWatch sw = new org.apache.commons.lang.time.StopWatch();

System.out.println("getEventFilterTreeData :: Start Time : " + sw.getTime());
sw.start();

// Method execution code

sw.stop();
System.out.println("getEventFilterTreeData :: End Time : " + sw.getTime()); 
```

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2016-07-01T22:59:18.107

# JEP 230：微基准套件

仅供参考，[JEP 230：Microbenchmark Suite](http://openjdk.java.net/jeps/230)是一个[OpenJDK](http://openjdk.java.net/)项目，用于：

> 在 JDK 源代码中添加一套基本的微基准测试，让开发人员可以轻松运行现有的微基准测试并创建新的微基准测试。

此功能在[Java 12](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_12)中出现。

# Java 微基准线束 (JMH)

对于 Java 的早期版本，请查看JEP 230 所基于的[Java Microbenchmark Harness (JMH)项目。](http://openjdk.java.net/projects/code-tools/jmh)

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2008-11-05T07:20:10.990

只是一个小转折，如果您不使用工具并且想要对执行时间较短的方法进行计时：执行多次，每次执行次数加倍，直到达到一秒左右。因此，调用 System.nanoTime 等的时间，以及 System.nanoTime 的准确性对结果影响很大。

```
 int runs = 0, runsPerRound = 10;
    long begin = System.nanoTime(), end;
    do {
        for (int i=0; i<runsPerRound; ++i) timedMethod();
        end = System.nanoTime();
        runs += runsPerRound;
        runsPerRound *= 2;
    } while (runs < Integer.MAX_VALUE / 2 && 1000000000L > end - begin);
    System.out.println("Time for timedMethod() is " + 
        0.000000001 * (end-begin) / runs + " seconds"); 
```

当然，使用挂钟的注意事项适用：JIT 编译的影响、多线程/进程等。因此，您需要先执行该方法*很多*次，以便 JIT 编译器完成其工作，然后多次重复此测试并采用最短的执行时间。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-10-08T06:40:38.203

为此，我们使用 AspectJ 和 Java 注释。如果我们需要知道某个方法的执行时间，我们只需对其进行注释即可。更高级的版本可以使用自己的日志级别，可以在运行时启用和禁用。

```
public @interface Trace {
  boolean showParameters();
}

@Aspect
public class TraceAspect {
  [...]
  @Around("tracePointcut() && @annotation(trace) && !within(TraceAspect)")
  public Object traceAdvice ( ProceedingJintPoint jP, Trace trace ) {

    Object result;
    // initilize timer

    try { 
      result = jp.procced();
    } finally { 
      // calculate execution time 
    }

    return result;
  }
  [...]
} 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2012-06-15T08:50:47.273

真的很好的代码。

[http://www.rgagnon.com/javadetails/java-0585.html](http://www.rgagnon.com/javadetails/java-0585.html)

```
import java.util.concurrent.TimeUnit;

long startTime = System.currentTimeMillis();
........
........
........
long finishTime = System.currentTimeMillis();

String diff = millisToShortDHMS(finishTime - startTime);

  /**
   * converts time (in milliseconds) to human-readable format
   *  "<dd:>hh:mm:ss"
   */
  public static String millisToShortDHMS(long duration) {
    String res = "";
    long days  = TimeUnit.MILLISECONDS.toDays(duration);
    long hours = TimeUnit.MILLISECONDS.toHours(duration)
                   - TimeUnit.DAYS.toHours(TimeUnit.MILLISECONDS.toDays(duration));
    long minutes = TimeUnit.MILLISECONDS.toMinutes(duration)
                     - TimeUnit.HOURS.toMinutes(TimeUnit.MILLISECONDS.toHours(duration));
    long seconds = TimeUnit.MILLISECONDS.toSeconds(duration)
                   - TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(duration));
    if (days == 0) {
      res = String.format("%02d:%02d:%02d", hours, minutes, seconds);
    }
    else {
      res = String.format("%dd%02d:%02d:%02d", days, hours, minutes, seconds);
    }
    return res;
  } 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2015-08-06T10:26:32.940

根据 JavaDoc，Spring 提供了一个实用程序类[org.springframework.util.StopWatch ：](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/util/StopWatch.html)

> 简单的秒表，允许对多个任务进行计时，显示每个命名任务的总运行时间和运行时间。

用法：

```
StopWatch stopWatch = new StopWatch("Performance Test Result");

stopWatch.start("Method 1");
doSomething1();//method to test
stopWatch.stop();

stopWatch.start("Method 2");
doSomething2();//method to test
stopWatch.stop();

System.out.println(stopWatch.prettyPrint()); 
```

输出：

```
StopWatch 'Performance Test Result': running time (millis) = 12829
-----------------------------------------
ms     %     Task name
-----------------------------------------
11907  036%  Method 1
00922  064%  Method 2 
```

**方面：**

```
@Around("execution(* my.package..*.*(..))")
public Object logTime(ProceedingJoinPoint joinPoint) throws Throwable {
    StopWatch stopWatch = new StopWatch();
    stopWatch.start();
    Object retVal = joinPoint.proceed();
    stopWatch.stop();
    log.info(" execution time: " + stopWatch.getTotalTimeMillis() + " ms");
    return retVal;
} 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2012-02-26T15:07:53.013

您可以使用[Perf4j](https://github.com/perf4j/perf4j)。非常酷的实用程序。用法很简单

```
String watchTag = "target.SomeMethod";
StopWatch stopWatch = new LoggingStopWatch(watchTag);
Result result = null; // Result is a type of a return value of a method
try {
    result = target.SomeMethod();
    stopWatch.stop(watchTag + ".success");
} catch (Exception e) {
    stopWatch.stop(watchTag + ".fail", "Exception was " + e);
    throw e; 
} 
```

~~更多信息可以在[开发者指南中找到](http://perf4j.codehaus.org/devguide.html)~~

编辑：[项目似乎死了](https://github.com/perf4j/perf4j/issues/18)

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2018-10-29T19:18:20.373

我写了一个方法，以一种可读的形式打印方法执行时间。例如，要计算 100 万的阶乘，大约需要 9 分钟。所以执行时间打印为：

```
Execution Time: 9 Minutes, 36 Seconds, 237 MicroSeconds, 806193 NanoSeconds 
```

代码在这里：

```
public class series
{
    public static void main(String[] args)
    {
        long startTime = System.nanoTime();

        long n = 10_00_000;
        printFactorial(n);

        long endTime = System.nanoTime();
        printExecutionTime(startTime, endTime);

    }

    public static void printExecutionTime(long startTime, long endTime)
    {
        long time_ns = endTime - startTime;
        long time_ms = TimeUnit.NANOSECONDS.toMillis(time_ns);
        long time_sec = TimeUnit.NANOSECONDS.toSeconds(time_ns);
        long time_min = TimeUnit.NANOSECONDS.toMinutes(time_ns);
        long time_hour = TimeUnit.NANOSECONDS.toHours(time_ns);

        System.out.print("\nExecution Time: ");
        if(time_hour > 0)
            System.out.print(time_hour + " Hours, ");
        if(time_min > 0)
            System.out.print(time_min % 60 + " Minutes, ");
        if(time_sec > 0)
            System.out.print(time_sec % 60 + " Seconds, ");
        if(time_ms > 0)
            System.out.print(time_ms % 1E+3 + " MicroSeconds, ");
        if(time_ns > 0)
            System.out.print(time_ns % 1E+6 + " NanoSeconds");
    }
} 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2013-01-06T20:12:22.387

[使用来自jcabi-aspects 的](http://aspects.jcabi.com/)AOP/AspectJ 和[`@Loggable`](http://aspects.jcabi.com/apidocs-0.7.6/com/jcabi/aspects/Loggable.html)注释，您可以轻松紧凑地完成它：

```
@Loggable(Loggable.DEBUG)
public String getSomeResult() {
  // return some value
} 
```

对该方法的每次调用都将发送到具有`DEBUG`日志记录级别的 SLF4J 日志记录工具。每条日志消息都将包含执行时间。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2013-04-03T14:13:33.093

```
new Timer(""){{
    // code to time 
}}.timeMe();

public class Timer {

    private final String timerName;
    private long started;

    public Timer(String timerName) {
        this.timerName = timerName;
        this.started = System.currentTimeMillis();
    }

    public void timeMe() {
        System.out.println(
        String.format("Execution of '%s' takes %dms.", 
                timerName, 
                started-System.currentTimeMillis()));
    }

} 
```

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2008-10-07T20:17:47.837

我基本上做了这个的变体，但考虑到热点编译的工作原理，如果你想获得准确的结果，你需要放弃前几次测量，并确保你在现实世界（阅读特定于应用程序的）应用程序中使用该方法。

如果 JIT 决定编译它，您的数字将有很大差异。所以请注意

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2008-10-07T20:18:33.030

有几种方法可以做到这一点。我通常会退回到只使用这样的东西：

```
long start = System.currentTimeMillis();
// ... do something ...
long end = System.currentTimeMillis(); 
```

或与 System.nanoTime() 相同的东西；

对于更多关于基准测试方面的内容，似乎也有这个：http: [//jetm.void.fm/](http://jetm.void.fm/)虽然从未尝试过。

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2017-07-31T10:53:13.923

您可以使用提供各种测量仪器的[Metrics库。](http://metrics.dropwizard.io/3.2.3/getting-started.html)添加依赖：

```
<dependencies>
    <dependency>
        <groupId>io.dropwizard.metrics</groupId>
        <artifactId>metrics-core</artifactId>
        <version>${metrics.version}</version>
    </dependency>
</dependencies> 
```

并为您的环境配置它。

方法可以用[@Timed](http://metrics.dropwizard.io/3.1.0/apidocs/com/codahale/metrics/annotation/Timed.html)注释：

```
@Timed
public void exampleMethod(){
    // some code
} 
```

或用[Timer](http://metrics.dropwizard.io/3.1.0/manual/core/#timers)包装的一段代码：

```
final Timer timer = metricsRegistry.timer("some_name");
final Timer.Context context = timer.time();
// timed code
context.stop(); 
```

聚合指标可以导出到控制台、JMX、CSV 或其他。

`@Timed`指标输出示例：

```
com.example.ExampleService.exampleMethod
             count = 2
         mean rate = 3.11 calls/minute
     1-minute rate = 0.96 calls/minute
     5-minute rate = 0.20 calls/minute
    15-minute rate = 0.07 calls/minute
               min = 17.01 milliseconds
               max = 1006.68 milliseconds
              mean = 511.84 milliseconds
            stddev = 699.80 milliseconds
            median = 511.84 milliseconds
              75% <= 1006.68 milliseconds
              95% <= 1006.68 milliseconds
              98% <= 1006.68 milliseconds
              99% <= 1006.68 milliseconds
            99.9% <= 1006.68 milliseconds 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2008-10-07T20:14:38.670

如果你想要挂钟时间

```
long start_time = System.currentTimeMillis();
object.method();
long end_time = System.currentTimeMillis();
long execution_time = end_time - start_time; 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2020-05-16T05:04:26.310

在 Spring 框架中，我们有一个名为 StopWatch (org.springframework.util.StopWatch) 的调用

```
//measuring elapsed time using Spring StopWatch
        StopWatch watch = new StopWatch();
        watch.start();
        for(int i=0; i< 1000; i++){
            Object obj = new Object();
        }
        watch.stop();
        System.out.println("Total execution time to create 1000 objects in Java using StopWatch in millis: "
                + watch.getTotalTimeMillis()); 
```

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2008-10-07T20:16:25.360

```
long startTime = System.currentTimeMillis();
// code goes here
long finishTime = System.currentTimeMillis();
long elapsedTime = finishTime - startTime; // elapsed time in milliseconds 
```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2008-10-07T20:21:19.047

正如“skaffman”所说，使用 AOP 或者您可以使用运行时字节码编织，就像单元测试方法覆盖工具用于透明地将时间信息添加到调用的方法一样。

您可以查看 Emma 等开源工具工具使用的代码 ( [http://downloads.sourceforge.net/emma/emma-2.0.5312-src.zip?modtime=1118607545&big_mirror=0](http://downloads.sourceforge.net/emma/emma-2.0.5312-src.zip?modtime=1118607545&big_mirror=0) )。另一个开源覆盖工具是[http://prdownloads.sourceforge.net/cobertura/cobertura-1.9-src.zip?download](http://prdownloads.sourceforge.net/cobertura/cobertura-1.9-src.zip?download)。

如果你最终设法做你所设定的，请。与您的 ant 任务/jars 在这里与社区分享。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2013-12-27T15:18:50.590

我修改了正确答案的代码以在几秒钟内得到结果：

```
long startTime = System.nanoTime();

methodCode ...

long endTime = System.nanoTime();
double duration = (double)(endTime - startTime) / (Math.pow(10, 9));
Log.v(TAG, "MethodName time (s) = " + duration); 
```

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2014-09-17T07:04:28.007

我机器上的性能测量

*   `System.nanoTime() : 750ns`
*   `System.currentTimeMillis() : 18ns`

如前所述，`System.nanoTime()`被认为可以测量经过的时间。如果在循环等内部使用，请注意成本。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2015-01-27T18:44:53.853

好的，这是一个简单的类，用于对您的函数进行简单的简单计时。下面有一个例子。

```
public class Stopwatch {
    static long startTime;
    static long splitTime;
    static long endTime;

    public Stopwatch() {
        start();
    }

    public void start() {
        startTime = System.currentTimeMillis();
        splitTime = System.currentTimeMillis();
        endTime = System.currentTimeMillis();
    }

    public void split() {
        split("");
    }

    public void split(String tag) {
        endTime = System.currentTimeMillis();
        System.out.println("Split time for [" + tag + "]: " + (endTime - splitTime) + " ms");
        splitTime = endTime;
    }

    public void end() {
        end("");
    }
    public void end(String tag) {
        endTime = System.currentTimeMillis();
        System.out.println("Final time for [" + tag + "]: " + (endTime - startTime) + " ms");
    }
} 
```

使用示例：

```
public static Schedule getSchedule(Activity activity_context) {
        String scheduleJson = null;
        Schedule schedule = null;
/*->*/  Stopwatch stopwatch = new Stopwatch();

        InputStream scheduleJsonInputStream = activity_context.getResources().openRawResource(R.raw.skating_times);
/*->*/  stopwatch.split("open raw resource");

        scheduleJson = FileToString.convertStreamToString(scheduleJsonInputStream);
/*->*/  stopwatch.split("file to string");

        schedule = new Gson().fromJson(scheduleJson, Schedule.class);
/*->*/  stopwatch.split("parse Json");
/*->*/  stopwatch.end("Method getSchedule"); 
    return schedule;
} 
```

控制台输出示例：

```
Split time for [file to string]: 672 ms
Split time for [parse Json]: 893 ms
Final time for [get Schedule]: 1565 ms 
```

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2018-03-08T08:18:54.867

您可以使用 spring 核心项目中的秒表类：

代码：

```
StopWatch stopWatch = new StopWatch()
stopWatch.start();  //start stopwatch
// write your function or line of code.
stopWatch.stop();  //stop stopwatch
stopWatch.getTotalTimeMillis() ; ///get total time 
```

秒表文档： **简单的秒表，允许对多个任务进行计时，显示每个命名任务的总运行时间和运行时间。隐藏 System.currentTimeMillis() 的使用，提高应用程序代码的可读性并降低计算错误的可能性。请注意，此对象并非设计为线程安全的，也不使用同步。此类通常用于在概念验证和开发过程中验证性能，而不是作为生产应用程序的一部分。**

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2013-12-06T05:48:51.857

如果只是想知道时间，您可以尝试这种方式。

```
long startTime = System.currentTimeMillis();
//@ Method call
System.out.println("Total time [ms]: " + (System.currentTimeMillis() - startTime)); 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2015-06-22T09:02:49.340

在 Java 8 中引入了一个名为的新类`Instant`。根据文档：

> Instant 表示时间线上一纳秒的开始。此类对于生成表示机器时间的时间戳很有用。瞬间的范围需要存储一个大于 long 的数字。为了实现这一点，该类存储了一个表示纪元秒的 long 和一个表示纳秒秒的 int，它们始终介于 0 和 999,999,999 之间。纪元秒是从标准 Java 纪元 1970-01-01T00:00:00Z 开始测量的，其中纪元之后的瞬间具有正值，而更早的瞬间具有负值。对于纪元秒和纳秒部分，较大的值在时间线上总是比较小的值晚。

这可以用作：

```
Instant start = Instant.now();
try {
    Thread.sleep(7000);
} catch (InterruptedException e) {
    e.printStackTrace();
}
Instant end = Instant.now();
System.out.println(Duration.between(start, end)); 
```

它打印`PT7.001S`。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2015-01-16T18:06:35.203

如果 java 有更好的功能支持，那就太好了，这样需要测量的动作可以被包装到一个块中：

```
measure {
   // your operation here
} 
```

在java中，这可以通过匿名函数来完成，看起来太冗长了

```
public interface Timer {
    void wrap();
}

public class Logger {

    public static void logTime(Timer timer) {
        long start = System.currentTimeMillis();
        timer.wrap();
        System.out.println("" + (System.currentTimeMillis() - start) + "ms");
    }

    public static void main(String a[]) {
        Logger.logTime(new Timer() {
            public void wrap() {
                // Your method here
                timeConsumingOperation();
            }
        });

    }

    public static void timeConsumingOperation() {
        for (int i = 0; i<=10000; i++) {
           System.out.println("i=" +i);
        }
    }
} 
```

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2015-09-21T14:28:54.407

您可以使用**javaagent**修改 java 类字节，动态添加监控代码。github 上有一些开源工具可以为您做到这一点。
如果你想自己做，只需实现**javaagent**，使用**javassist**修改你要监控的方法，以及方法返回之前的监控代码。它很干净，你可以监控你甚至没有源代码的系统.

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2016-12-15T09:25:22.020

这是漂亮的打印字符串准备好格式化的秒数，类似于谷歌搜索时间：

```
 long startTime = System.nanoTime();
        //  ... methodToTime();
        long endTime = System.nanoTime();
        long duration = (endTime - startTime);
        long seconds = (duration / 1000) % 60;
        // formatedSeconds = (0.xy seconds)
        String formatedSeconds = String.format("(0.%d seconds)", seconds);
        System.out.println("formatedSeconds = "+ formatedSeconds);
        // i.e actual formatedSeconds = (0.52 seconds) 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2016-12-29T09:10:23.660

我实现了一个简单的计时器，我认为它非常有用：

```
public class Timer{
    private static long start_time;

    public static double tic(){
        return start_time = System.nanoTime();
    }

    public static double toc(){
        return (System.nanoTime()-start_time)/1000000000.0;
    }

} 
```

这样你就可以为一个或多个动作计时：

```
Timer.tic();
// Code 1
System.out.println("Code 1 runtime: "+Timer.toc()+" seconds.");
// Code 2
System.out.println("(Code 1 + Code 2) runtime: "+Timer.toc()+"seconds");
Timer.tic();
// Code 3
System.out.println("Code 3 runtime: "+Timer.toc()+" seconds."); 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2013-07-03T07:55:34.887

`System.nanoTime()`是一个非常精确的系统实用程序，用于测量执行时间。但请注意，如果您在抢占式调度程序模式（默认）下运行，此实用程序实际上测量的是挂钟时间而不是 CPU 时间。因此，您可能会注意到每次运行的执行时间值不同，具体取决于系统负载。如果您寻找 CPU 时间，我认为以实时模式运行您的程序就可以了。你必须使用 RT linux。链接：[使用 Linux 进行实时编程](https://stackoverflow.com/questions/10502508/real-time-programming-with-linux)

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2017-07-06T12:47:55.437

在 java ee 中对我有用的策略是：

1.  用`@AroundInvoke`;注释的方法创建一个类

    ```
    @Singleton
    public class TimedInterceptor implements Serializable {

        @AroundInvoke
        public Object logMethod(InvocationContext ic) throws Exception {
            Date start = new Date();
            Object result = ic.proceed();
            Date end = new Date();
            System.out.println("time: " + (end.getTime - start.getTime()));
            return result;
        }
    } 
    ```

2.  注释要监视的方法：

    ```
    @Interceptors(TimedInterceptor.class)
    public void onMessage(final Message message) { ... 
    ```

我希望这会有所帮助。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2019-09-30T11:28:34.287

对于 java 8+，另一种可能的解决方案（更通用，func 样式且没有方面）可能是创建一些接受代码作为参数的实用程序方法

```
public static <T> T timed (String description, Consumer<String> out, Supplier<T> code) {
    final LocalDateTime start = LocalDateTime.now ();
    T res = code.get ();
    final long execTime = Duration.between (start, LocalDateTime.now ()).toMillis ();
    out.accept (String.format ("%s: %d ms", description, execTime));
    return res;
} 
```

调用代码可能是这样的：

```
public static void main (String[] args) throws InterruptedException {
    timed ("Simple example", System.out::println, Timing::myCode);
}

public static Object myCode () {
    try {
        Thread.sleep (1500);
    } catch (InterruptedException e) {
        e.printStackTrace ();
    }
    return null;
} 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2021-09-17T12:25:35.213

也可以实现 Timer 接口并在您的类的任何方法上执行

```
import java.util.function.*;

public interface Timer {

    default void timeIt(Runnable r) {
        timeIt(() -> { r.run(); return 0;});
    }

    default <S,T> T timeIt(Function<S,T> fun, S arg) {
        long start = System.nanoTime();
        T result = fun.apply(arg);
        long stop = System.nanoTime();
        System.out.println("Time: " + (stop-start)/1000000.0 + " msec");
        return result;
    }

    default <T> T timeIt(Supplier<T> s) {
        return timeIt(obj -> s.get(), null);
    }
} 
```

用法：

```
class MyClass implements Timer ..

timeIt(this::myFunction); 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2021-12-11T06:31:05.273

这里有很多有效的答案，所有这些都是在方法中实现的。为了制作一个通用的计时方法，我通常有一个`Timing`由以下组成的类。

```
public record TimedResult<T>(T result, Duration duration) {}

public static Duration time(Runnable r) {
    var s = Instant.now();
    r.run();
    var dur = Duration.between(s, Instant.now());
    return dur;
}

public static <T> TimedResult<T> time(Callable<T> r) throws Exception {
    var s = Instant.now();
    T res = r.call();
    var dur = Duration.between(s, Instant.now());
    return new TimedResult<>(res, dur);
} 
```

这足以传递[Runnable](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Runnable.html)或[Callable](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Callable.html)。

```
Duration result = Timing.time(() -> {
    // do some work.
});

TimedResult<String> result = Timing.time(() -> {
    // do some work.
    return "answer";
});

Duration timeTaken = result.duration();
String answer = result.result(); 
```

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2020-04-28T08:22:58.000

**纯 Java SE 代码**，无需添加依赖，使用`TimeTracedExecuter`：

```
public static void main(String[] args) {

    Integer square = new TimeTracedExecutor<>(Main::calculateSquare)
                .executeWithInput("calculate square of num",5,logger);

}
public static int calculateSquare(int num){
    return num*num;
} 
```

会产生这样的结果：

`INFO: It took 3 milliseconds to calculate square of num`

自定义可重用类：**TimeTracedExecutor**

```
import java.text.NumberFormat;
import java.time.Duration;
import java.time.Instant;
import java.util.function.Function;
import java.util.logging.Logger;

public class TimeTracedExecutor<T,R> {
    Function<T,R> methodToExecute;

    public TimeTracedExecutor(Function<T, R> methodToExecute) {
        this.methodToExecute = methodToExecute;
    }

    public R executeWithInput(String taskDescription, T t, Logger logger){
        Instant start = Instant.now();
        R r= methodToExecute.apply(t);
        Instant finish = Instant.now();
        String format = "It took %s milliseconds to "+taskDescription;
        String elapsedTime = NumberFormat.getNumberInstance().format(Duration.between(start, finish).toMillis());
        logger.info(String.format(format, elapsedTime));
        return r;
    }
} 
```

# java - 如何使用 JNI 向 JVM 公开 C ODBC 连接？

> ID：180167
> 
> 赞同：1
> 
> 时间：2008-10-07T20:12:10.110
> 
> 标签：java, jdbc, odbc, java-native-interface

我正在使用调用 API 将 JRE 嵌入到现有的 C 应用程序中，并且我希望能够使用 JDBC 来处理该代码中的数据库。该应用程序是一个事务处理应用程序，数据库事务由应用程序的 C 部分中的代码管理，Java 代码必须在该事务中运行。这意味着我无法打开 *新*连接，我必须重新使用现有连接。

那么，有没有办法在设置 JRE 时提供对现有 ODBC 连接句柄的 JDBC 访问？也许是一些 JDBC-ODBC 桥，但与现有的驱动程序不同，它可以设置为使用现有的连接和事务。

在我看来，我的其他选择如下：

*   为应用程序中可能的每个 C 操作提供 java 等效项（由于很多原因，这是不可取的——我们有很多方法，复制它们是一件很痛苦的事情。

*   编写我自己的 JDBC 驱动程序，用 JNI 包装 ODBC 连接。当然，这将是一个有趣的周末（月）项目，但我希望需要比这更快的事情完成。

帮助我，Stack-Overflow，你是我唯一的希望！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T21:22:06.413

不知道这是否可行，但是... 我快速浏览了 Sun 的 JDBC-ODBC 桥的反编译源代码。似乎您可以对 JdbcOdbcConnection 进行子类化，以便它使用已知的连接句柄和已经打开的状态来初始化自己。这假定 Java 端的连接句柄是实际的 ODBC 连接句柄或指向连接对象的指针，并且 JDBC-ODBC 桥使用的 ODBC 库和您的代码在它们可以共享连接句柄的意义上是兼容的。

不过，您需要检查 Sun 的许可证是否允许开发人员执行此类诡计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T20:31:03.053

Sun在 JDK 中提供了一个[JDBC-ODBC 桥。](http://java.sun.com/j2se/1.5.0/docs/guide/jdbc/bridge.html)

编辑：重读听起来你已经知道它并且不想使用它。

# c++ - 带空括号的默认构造函数

> ID：180172
> 
> 赞同：217
> 
> 时间：2008-10-07T20:13:10.967
> 
> 标签：c++, constructor, default-constructor, c++-faq, most-vexing-parse

是否有充分的理由表明一组空的圆括号（括号）对于调用 C++ 中的默认构造函数无效？

```
MyObject  object;  // ok - default ctor
MyObject  object(blah); // ok

MyObject  object();  // error 
```

我似乎每次都自动输入“（）”。有充分的理由不允许这样做吗？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-10-08T05:30:31.543

**最烦人的解析**

这与所谓的“C++ 最令人头疼的解析”有关。基本上，任何可以被编译器解释为函数声明的东西都将被解释为函数声明。

同样问题的另一个例子：

```
std::ifstream ifs("file.txt");
std::vector<T> v(std::istream_iterator<T>(ifs), std::istream_iterator<T>()); 
```

`v`被解释为带有 2 个参数的函数声明。

解决方法是添加另一对括号：

```
std::vector<T> v((std::istream_iterator<T>(ifs)), std::istream_iterator<T>()); 
```

或者，如果您有可用的 C++11 和列表初始化（也称为统一初始化）：

```
std::vector<T> v{std::istream_iterator<T>{ifs}, std::istream_iterator<T>{}}; 
```

有了这个，它就不可能被解释为一个函数声明。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2008-10-07T20:15:41.303

因为它被视为函数的声明：

```
int MyFunction(); // clearly a function
MyObject object(); // also a function declaration 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-10-07T20:15:22.163

函数声明使用相同的语法-例如函数`object`，不带参数并返回`MyObject`

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-07T20:15:25.690

因为编译器认为它是一个不带参数并返回 MyObject 实例的函数的声明。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-08T08:05:08.767

您还可以使用更详细的构造方式：

```
MyObject object1 = MyObject();
MyObject object2 = MyObject(object1); 
```

在 C++0x 中，这也允许`auto`：

```
auto object1 = MyObject();
auto object2 = MyObject(object1); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-07T20:17:11.147

我猜，编译器不知道这个语句是否：

> 我的对象对象（）；

是一个构造函数调用或函数原型，它声明了一个名为*object*的函数，返回类型为*MyObject*且没有参数。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-07T21:34:19.867

正如多次提到的，这是一个声明。这是向后兼容的方式。由于其遗留问题，C++ 的许多愚蠢/不一致/痛苦/虚假的领域之一。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-06-27T20:09:36.853

从 n4296 [dcl.init]：

> [注意：
> 由于*initializer*`()`的语法不允许， 因此不是类 X的*对象的声明，而是不带参数并返回 X 的**函数*的声明。在某些其他初始化上下文中允许使用 () 形式（ 5.3.4、5.2.3、12.6.2）。 ——尾注]*`X a();`*

 ***[C++11 链接](https://timsong-cpp.github.io/cppwp/n3337/dcl.init#10)
[C++14 链接](https://timsong-cpp.github.io/cppwp/n4140/dcl.init#11)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-10-19T07:11:57.337

正如其他人所说，它是一个函数声明。从 C++11 开始，如果您需要查看明确告诉您使用默认构造函数的空内容，*则可以使用大括号初始化。*

```
Jedi luke{}; //default constructor 
```

# javascript - jQuery DIV 点击，带有锚点

> ID：180211
> 
> 赞同：29
> 
> 时间：2008-10-07T20:19:40.487
> 
> 标签：javascript, jquery

为了制作可点击的 div，我这样做：

```
<div class="clickable" url="http://google.com">
    blah blah
</div> 
```

进而

```
$("div.clickable").click(
function()
{
    window.location = $(this).attr("url");
}); 
```

我不知道这是否是最好的方法，但它对我很有效，除了一个问题：如果 div 包含可点击元素，例如 <a href="...">，并且用户点击超链接，超链接和div的可点击都被调用

当锚标记引用 javascript AJAX 函数时，这尤其是一个问题，该函数执行 AJAX 函数*并*跟随 div 的“url”属性中的链接。

无论如何围绕这个？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-07T20:31:39.087

如果你从你的函数中返回“false”，它将停止事件冒泡，所以只有你的第一个事件处理程序会被触发（即你的锚不会看到点击）。

```
$("div.clickable").click(
function()
{
    window.location = $(this).attr("url");
    return false;
}); 
```

有关 return false 与 preventDefault 的详细信息，请参见[event.preventDefault() 与 return false](https://stackoverflow.com/questions/1357118/javascript-event-preventdefault-vs-return-false)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-07T20:24:34.033

`$("div.clickable").click( function(event) { window.location = $(this).attr("url"); event.preventDefault(); });`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-03T20:32:28.913

使用自定义 url 属性会使 HTML 无效。尽管这可能不是一个大问题，但给定的示例都无法访问。不适用于键盘导航，也不适用于 JavaScript 被关闭（或被其他脚本阻止）的情况。即使是谷歌也不会找到位于指定 url 的页面，至少不会通过这条路线。

虽然很容易做到这一点。只要确保 div 中有一个指向 url 的常规链接。使用 JavaScript/jQuery 向 div 添加一个 onclick，重定向到链接的 href 属性指定的位置。现在，当 JavaScript 不起作用时，链接仍然有效，甚至可以在使用键盘导航时获得焦点（并且您不需要自定义属性，因此您的 HTML 可以是有效的）。

* * *

我前段时间写了一个 jQuery 插件来做到这一点。它还将 classNames 添加到 div（或您希望使其可点击的任何其他元素）和链接，以便您可以在 div 确实可点击时使用 CSS 更改它们的外观。它甚至添加了可用于指定悬停和焦点样式的类名。

您需要做的就是指定要使其可点击的元素并调用它们的 clickable() 方法：在您的情况下，这将是`$("div.clickable).clickable();`

如需下载 + 文档，请参阅插件页面：[jQuery: clickable — jLix](http://jlix.net/extensions/jquery/clickable)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T20:24:36.700

我知道，如果您要将其更改为 href，您会这样做：

```
$("a#link1").click(函数(事件) {
  event.preventDefault();
  $('div.link1').show();
  //无论你想做什么
});

```

所以如果你想把它和div一起保存，我会试试

```
$("div.clickable").click(function(event) {
  event.preventDefault();
  window.location = $(this).attr("url");
});

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-01T15:00:57.050

```
<div class="info">
   <h2>Takvim</h2>
   <a href="item-list.php"> Click Me !</a>
</div>

$(document).delegate("div.info", "click", function() {
   window.location = $(this).find("a").attr("href");
}); 
```

# language-agnostic - 多站点登录ala Google

> ID：180215
> 
> 赞同：4
> 
> 时间：2008-10-07T20:20:08.817
> 
> 标签：language-agnostic

不确定标题是否完全适合这个问题，但我想不出任何其他方式来表达它..

假设您想创建多个不同的网络应用程序，但您希望登录一个应用程序的用户能够直接进入您的另一个应用程序而无需重新登录（假设他们也有权查看另一个应用程序） . 如果我没记错的话，如果您已登录 gmail，您可以直接访问您的 iGoogle、googleReader 等，而无需重新登录（如果您设置正确的话）。

你会如何处理这个问题？你会用什么？假设应用程序已经存在并且您不想更改用户的初始登录页面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T20:26:17.867

您正在寻找的是所谓的[Single Sign On](http://en.wikipedia.org/wiki/Single_sign-on)。如果您点击链接，您会发现几个实现。

其他人提到的 Open ID 并不是这样的方案，因为它需要为每个站点单独登录。Open ID 只是一个共享的身份验证系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T20:23:36.920

您将针对 foo.com 发出一个 cookie，然后它会在 app1.foo.com、app2.foo.com 上可见。

然后，每个应用程序都可以使用 cookie 访问集中式身份验证系统。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T21:17:42.413

尝试[CAS](http://www.ja-sig.org/products/cas/)，它应该提供您正在寻找的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T20:31:28.153

您需要的是单点登录 (SSO)。

有两种方法可以解决这个问题：

1.  滚动你自己的实现。在其最简单的形式中，它可以通过第一个站点设置一个 cookie 来实现，该 cookie 为登录用户保存票证，第二个站点验证该票证并接受登录用户。这里有很多潜在的陷阱：

    *   您必须保护自己免受信息泄露 - 确保票证不包含实际的用户凭据
    *   您必须保护自己免受欺骗 - 中间的人窃取有效票并冒充您的一个用户
    *   和别的
2.  采用第三方单点登录机制。谷歌、微软、Facebook 和其他大公司允许与他们的身份提供商集成，这样您的用户就可以登录他们的网站并处理验证、出票等。还有 OpenID，它是一种开放协议，您可以通过几乎任何支持 OpenID 的身份提供商在您的站点上启用 SSO。这里的潜在缺点是其他人控制您对您的用户身份的访问，并且可以限制您可以提供的功能和您可以为您的用户挖掘的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T20:29:33.897

如前所述，您可以使用类似 OpenId 或类似的东西来简化流程。否则，如果您自己滚动，您可以使用 cookie 来存储登录信息，那么基本上所有应用程序都必须有一个模仿基本 url 的入口点。

例如，谷歌使用 mail.google.com 作为进入 Gmail 的管道，允许它读取存储在 google.com 域中的 cookie。

# jakarta-ee - HTTP 输入过滤器，例如 WebSphere 的 mod_security？

> ID：180239
> 
> 赞同：2
> 
> 时间：2008-10-07T20:24:09.587
> 
> 标签：jakarta-ee, websphere, xss, sql-injection, mod-security

WebSphere 是否提供像 mod_security 这样的 HTTP 输入过滤器/防火墙？

我知道让 Apache 成为 WebSphere 的 HTTP 服务器前端是可能的，但这种类型的配置超出了我的影响。我们只能使用 WebSphere 本身可以做的事情。

编辑-澄清一下，我不是在这里寻找安全性的身份验证、授权或不可否认方面。我想要一个基于规则的 HTTP 防火墙，比如在 WebSphere 上运行的 mod_security。

另外，我知道在 1.x 版本中，Java 中有 mod_security 的部分实现。我们目前有一个定制的内部解决方案，它与工作类似，但不那么随意配置。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T23:55:08.363

J2EE 具有[保护](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/Security4.html#67530)其应用程序的[标准](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/Security.html)方法。我推荐使用这个。如果您尝试做的事情很奇怪，您可以查看[Custom User Registries (IBM specific) ，或者与](http://publib.boulder.ibm.com/infocenter/wasinfo/v5r1//index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/rsec_customauth.html)[Servlet Filters](http://www.ibm.com/developerworks/java/library/j-pj2ee10.html)一起实现自定义系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-13T09:31:24.113

有许多攻击针对您的应用程序服务器前面的 Web 服务器，因此您也应该控制该 Web 服务器的配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-16T14:30:34.680

看看 webcastellum [http://sourceforge.net/projects/webcastellum/](http://sourceforge.net/projects/webcastellum/) 它是一个 Java 开源 WAF。可悲的是，维护者的网站只有德语，但他们似乎有一些英文文档。

他们在他们的文档中说 WebCastellum 与所有常见的 J2EE 服务器兼容：WebCastellum ist kompatibel zu allen gängigen JavaEE-Servern Bei der Implementierung von WebCastellum wurde auf Kompatibilität zu allen gängigen JavaEE-Servern, wie Tomcat, BEA Weblogic, JBoss oder WebSphere Wert gelegt .

# mshtml - 使用 MSHTML 编辑表格

> ID：180240
> 
> 赞同：1
> 
> 时间：2008-10-07T20:24:10.757
> 
> 标签：mshtml

有没有办法使用 MSHTML 创建/编辑表格而无需编辑底层 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T20:36:49.633

如果您想自动执行此操作，您可以根据需要向文档添加行、单元格和表格来操作 DOM。

一个表格和行在那里，用户可以像文档的任何其他部分一样编辑它们。

# mysql - 如何在 ruby on rails 中复制 mySQL 数据库？

> ID：180242
> 
> 赞同：8
> 
> 时间：2008-10-07T20:24:21.287
> 
> 标签：mysql, ruby-on-rails, ruby, database

我们正在制作一个 Ruby On Rails 网络应用程序，每个客户都有自己的数据库。
在他们在我们的网站上填写表格后，需要创建数据库。

我们有一个模板数据库，其中包含我们需要复制的所有表和列。如何从 ruby​​ on rails 以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-08T12:56:51.690

我不确定你的意思，但你可以使用 ruby​​ 的命令行功能转储模板数据库，创建一个新数据库并使用[mysqldump](http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html)程序重新导入它：

```
> mysqldump -uroot -proot templateDB > dump.sql
> mysql -uroot -proot --execute="CREATE DATABASE newDB"
> mysql -uroot -proot newDB < dump.sql 
```

[这](http://blog.jayfields.com/2006/06/ruby-kernel-system-exec-and-x.html)是从 Ruby 调用命令行选项的一个很好的描述。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-07T20:32:38.883

从任何控制器，您都可以定义以下方法。

```
 def copy_template_database
        template_name = "customerdb1" # Database to copy from
        new_name = "temp" #database to create & copy to

        #connect to template database to copy.  Note that this will override any previous
        #connections for all Models that inherit from ActiveRecord::Base
        ActiveRecord::Base.establish_connection({:adapter => "mysql", :database => template_name, :host => "olddev",
        :username => "root", :password => "password" })

        sql_connection = ActiveRecord::Base.connection 
        sql_connection.execute("CREATE DATABASE #{new_name} CHARACTER SET latin1 COLLATE latin1_general_ci")
        tables = sql_connection.select_all("Show Tables")
        #the results are an array of hashes, ie:
        # [{"table_from_customerdb1" => "customers"},{"table_from_customerdb1" => "employees},...]
        table_names = Array.new
        tables.each { |hash| hash.each_value { |name| table_names << name }}

        table_names.each { |name| 
            sql_connection.execute("CREATE TABLE #{new_name}.#{name} LIKE #{template_name}.#{name}")
            sql_connection.execute("INSERT INTO #{new_name}.#{name} SELECT * FROM #{template_name}.#{name}")
        }
        #This statement is optional.  It connects ActiveRecord to the new database
        ActiveRecord::Base.establish_connection({:adapter => "mysql", :database => new_name, :host => "olddev",
        :username => "root", :password => "password" })
    end 
```

请注意，我不确定这是否会保持外键完整性。我认为这在很大程度上取决于模板数据库的创建方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-27T18:36:59.970

通过使用[yaml_db](http://github.com/adamwiggins/yaml_db)

您需要安装插件，使用 rake 任务将任何 rails 数据库（包括 mysql）转储到 data.yml 文件中，更改连接字符串以指向新数据库，然后使用另一个 rake 任务最终将 data.yml 加载到任何新数据库（包括 mysql）中. 非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T03:01:54.543

您可以将模板架构创建代码放入包含所有必需的表/索引/视图/过程创建语句的脚本中，将其称为“template_schema.sql”或其他任何内容，然后在您选择的数据库上运行脚本（从Ruby，如果那是你所追求的），你就完成了。

最好的方法可能是将每个数据库对象放在一个单独的文件中并受源代码控制（以便于跟踪单个对象的更改），然后将它们合并到一个文件中作为部署的一部分。

# asp.net - CheckBoxList 的 DataValueField 值存储在哪里？

> ID：180245
> 
> 赞同：5
> 
> 时间：2008-10-07T20:24:33.003
> 
> 标签：asp.net, javascript

我在页面上有这个 CheckBoxList：

```
<asp:checkboxlist runat="server" id="Locations" datasourceid="LocationsDatasource"
   datatextfield="CountryName" datavaluefield="CountryCode" /> 
```

我想使用 Javascript 遍历客户端上的复选框元素并获取每个选中复选框的值，但这些值在客户端似乎不可用。HTML 输出如下所示：

```
<table id="ctl00_Content_Locations" class="SearchFilterCheckboxlist" cellspacing="0" cellpadding="0" border="0" style="width:235px;border-collapse:collapse;">
<tr>
    <td><input id="ctl00_Content_Locations_0" type="checkbox" name="ctl00$Content$Locations$0" /><label for="ctl00_Content_Locations_0">Democratic Republic of the Congo</label></td>
</tr><tr>
    <td><input id="ctl00_Content_Locations_1" type="checkbox" name="ctl00$Content$Locations$1" /><label for="ctl00_Content_Locations_1">Central African Republic</label></td>
</tr><tr>
    <td><input id="ctl00_Content_Locations_2" type="checkbox" name="ctl00$Content$Locations$2" /><label for="ctl00_Content_Locations_2">Congo</label></td>
</tr><tr>
    <td><input id="ctl00_Content_Locations_3" type="checkbox" name="ctl00$Content$Locations$3" /><label for="ctl00_Content_Locations_3">Cameroon</label></td>
</tr><tr>
    <td><input id="ctl00_Content_Locations_4" type="checkbox" name="ctl00$Content$Locations$4" /><label for="ctl00_Content_Locations_4">Gabon</label></td>
</tr><tr>
    <td><input id="ctl00_Content_Locations_5" type="checkbox" name="ctl00$Content$Locations$5" /><label for="ctl00_Content_Locations_5">Equatorial Guinea</label></td>
</tr> 
```

值（“cd”、“cg”、“ga”等）无处可寻。他们在哪？甚至可以在客户端上访问它们，还是我需要使用中继器或其他东西自己构建这个复选框列表？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-22T18:27:12.677

我终于有了我一直在寻找的答案！

asp.net CheckboxList 控件*实际上*将 value 属性呈现为 HTML - 它已经在生产站点中为我工作了一年多！（我们总是为所有网站关闭 EnableViewState，它仍然可以工作，没有任何调整或黑客攻击）

然而，突然有一天，它停止了工作，我们的 CheckboxList 复选框不再在 HTML 中呈现它们的 value 属性！你说什么？我们也是！解决这个问题需要一段时间，但由于它之前一直有效，我们知道必须有一个原因。原因是我们的 web.config 发生了意外更改！

```
<pages controlRenderingCompatibilityVersion="3.5"> 
```

我们从页面配置部分中删除了这个属性，这就成功了！

为什么会这样？我们反映了 CheckboxList 控件的代码，并在 RenderItem 方法中找到了这一点：

```
if (this.RenderingCompatibility >= VersionUtil.Framework40)
{
    this._controlToRepeat.InputAttributes.Add("value", item.Value);
} 
```

最亲爱的开发者兄弟姐妹们不要绝望！我在 Stackexchange 和其他网络上搜索的所有答案都提供了错误信息！从 .Net 4.0 开始，asp.net 呈现 CheckboxList 的复选框的 value 属性：

```
<input type="checkbox" value="myvalue1" id="someid" /> 
```

也许实际上没有用，Microsoft 让您能够将“controlRenderingCompatibilityVersion”添加到您的 web.config 以通过将版本设置为低于 4 来关闭它，这对于我们的目的来说是完全不必要的，实际上是有害的，因为 javascript 代码依赖关于价值属性...

我们让所有复选框的 chk.val() 等于“on”，这是最初提醒我们注意这个问题的原因（使用 jquery.val() 获取复选框的值。结果是“on” " 是选中的复选框的值...每天学习一些东西）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-10T06:16:43.493

```
<body>
     <form id="form1" runat="server">
          <div>
               <asp:CheckBoxList ID="CheckBoxList1" runat="server" DataTextField="tx" DataValueField="vl">
               </asp:CheckBoxList>
          </div>
          <input id="Button1" type="button" value="button" onclick="return Button1_onclick()" /> 
     </form>
</body>
<script type="text/javascript">

function Button1_onclick() 
{
var itemarr = document.getElementById("CheckBoxList1").getElementsByTagName("span");
var itemlen = itemarr.length;
     for(i = 0; i <itemlen;i++)
     {
          alert(itemarr[i].getAttribute("dvalue"));
     }
return false;
}

</script> 
```

代码

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        DataTable dt = new DataTable();
        dt.Columns.Add("tx");
        dt.Columns.Add("vl");
        DataRow dr = dt.NewRow();
        dr[0] = "asdas";
        dr[1] = "1";
        dt.Rows.Add(dr);
        dr = dt.NewRow();
        dr[0] = "456456";
        dr[1] = "2";
        dt.Rows.Add(dr);
        dr = dt.NewRow();
        dr[0] = "yjryut";
        dr[1] = "3";
        dt.Rows.Add(dr);
        dr = dt.NewRow();
        dr[0] = "yjrfdgdfgyut";
        dr[1] = "3";
        dt.Rows.Add(dr);
        dr = dt.NewRow();
        dr[0] = "34534";
        dr[1] = "3";
        dt.Rows.Add(dr);
        CheckBoxList1.DataSource = dt;
        CheckBoxList1.DataBind();
        foreach (ListItem li in CheckBoxList1.Items)
        {
            li.Attributes.Add("dvalue", li.Value);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T20:25:58.710

[**存储在 ViewState 中，如果不进行一些黑客攻击**](http://www.daveparslow.com/2007/08/assigning-value-to-aspnet-checkbox.html)，您将无法在客户端上访问它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-21T14:46:24.727

为了避免破解复选框列表，只需使用中继器：

```
<asp:Repeater ID="rptItems" runat="server" DataSourceID="odsDataSource">
<ItemTemplate>
<input id="iptCheckBox" type="checkbox" runat="server" value='<%# Eval("Key") %>'><%# Eval("Value") %></input>
</ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-24T16:02:26.590

不得不做一些非常讨厌的事情才能让它工作..

```
 <asp:Repeater ID="rptItems" runat="server">
            <ItemTemplate>
                <input ID="iptCheckBox" type="checkbox" runat="server" value='<%# Eval("your_data_value") %>' />
                <label ID="iptLabel" runat="server"><%# Eval("your_data_field") %></label>
                <br />
            </ItemTemplate>
        </asp:Repeater> 
```

* * *

代码隐藏：

```
Private Sub rptItems_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rptItems.ItemDataBound
    Dim checkBox As HtmlInputCheckBox = DirectCast(e.Item.FindControl("iptCheckBox"), HtmlInputCheckBox)
    Dim label As HtmlControl = DirectCast(e.Item.FindControl("iptLabel"), HtmlControl)

    label.Attributes.Add("for", checkBox.ClientID)
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-23T16:12:06.910

Swapna，您的回答绝对有效。因此，为了检查 ASP.Net Checkboxlist 中的复选框是否被选中，然后将列表累积为逗号分隔的字符串，您可以这样做

C# 代码隐藏

```
ChkboxList1.DataSource = dsData;
ChkboxList1.DataTextField = "your-display-column-name";
ChkboxList1.DataValueField = "your-identifier-column-name";
ChkboxList1.DataBind();

foreach (ListItem li in ChkboxList1.Items)
{
    li.Attributes.Add("DataValue", li.Value); 
} 
```

然后在Javascript中做

```
var selValues = "";
var ChkboxList1Ctl = document.getElementById("ChkboxList1");
var ChkboxList1Arr = null;
var ChkboxList1Attr= null;

if (ChkboxList1Ctl != null)
{
   ChkboxList1Arr = ChkboxList1Ctl.getElementsByTagName("INPUT");
   ChkboxList1Attr = ChkboxList1Ctl.getElementByTagName("span");
}
if (ChkboxList1Arr != null)
{
    for (var i = 0; i < ChkboxList1Arr.length; i++)
    {
       if (ChkboxList1Arr[i].checked)
           selValues += ChkboxList1Attr[i].getAttribute("DataValue") + ",";
    }
    if (selValues.length > 0)
       selValues = selValues.substr(0, selValues.length - 1);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-08T18:39:47.447

删除`<pages controlRenderingCompatibilityVersion="3.5">`导致我正在处理的一些旧代码出现问题。我收到了[这个错误](https://stackoverflow.com/questions/778952/the-controls-collection-cannot-be-modified-because-the-control-contains-code-bl)。一旦我得到这个错误，我意识到改变的风险太大了。

为了解决这个问题，我最终扩展`CheckBoxList`并覆盖了该`Render`方法，以向每个列表项添加一个包含值的附加属性：

```
public class CheckBoxListExt : CheckBoxList
{
    protected override void Render(HtmlTextWriter writer)
    {
        foreach (ListItem item in this.Items)
        {
            item.Attributes.Add("data-value", item.Value);
        }

        base.Render(writer);
    }
} 
```

这将呈现`data-value`外部`span`标签上的属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-14T14:07:12.250

```
Easy Way I Do It.

//First create query directly From Database that contains hidden field code format (i do it in stored procedure)

SELECT Id,Name + '<input id="hf_Id" name="hf_Id" value="'+convert(nvarchar(100),Id)+'" type="hidden">' as Name FROM User

//Then bind checkbox list as normally(i bind it from dataview).

cbl.DataSource = dv;
cbl.DataTextField = "Name";
cbl.DataValueField = "Id";
cbl.DataBind();

//Then finally it represent code as follow.

<table id="cbl_Position" border="0">
<tbody>
<tr>
<td>
<input id="cbl_0" name="cbl$0" type="checkbox">
<label for="cbl_0">
ABC
<input id="hf_Id" name="hf_Id" value="1" type="hidden">
</label>
</td>
</tr>
</table>

This way you can get DataValueField as inside hiddenfield and also can get it value from client side using javascript. 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-27T13:00:20.017

我尝试了以下方法，它对我有用：

```
<asp:CheckBoxList ID="chkAttachments" runat="server"></asp:CheckBoxList> 
```

服务器端绑定：

```
private void LoadCheckBoxData()
        {

            var docList = new List<Documents>(); // need to get the list data from database
                    chkAttachments.Items.Clear();

                    ListItem item = new ListItem();

                    foreach (var doc in docList )
                    {
                        item = new ListItem();
                        item.Value = doc.Id.ToString();
                        item.Text = doc.doc_name;
                        chkAttachments.Items.Add(item);
                    }
                } 
```

# visual-studio - WinDbg 缺少哪些 Visual Studio 调试器功能？

> ID：180261
> 
> 赞同：0
> 
> 时间：2008-10-07T20:27:20.627
> 
> 标签：visual-studio, debugging, comparison, windbg

有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T07:04:03.183

精美的 UI 是一项功能。Windbg 有点缺乏这个功能。但这仅在 UI“错误”使我慢下来时才重要，而且这种情况并不经常发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T20:29:33.007

主要是更易于使用的 GUI——它比 VS 具有更多的调试功能。

顺便说一句，我强烈推荐[Advanced Windows Debugging](https://rads.stackoverflow.com/amzn/click/com/0321374460)来了解它以及其他高级调试工具和技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T12:58:37.273

也许在文件中查找搜索。
但我真的很想念编辑和“编译”按钮:)

# trac - Twiki/Source Control 具有细粒度的内部和外部使用权限

> ID：180265
> 
> 赞同：0
> 
> 时间：2008-10-07T20:29:00.170
> 
> 标签：trac, twiki

我们一直在内部使用 trac 和 svn，效果相当好。现在我们想向外部供应商开放我们系统的一部分——例如。我们想在 twiki 上为我们的外部设计师创建一个区域来上传图像、记录事物等等。我们需要能够限制他只能访问 twiki 的那部分。

同样，我们有外部开发人员在开发我们希望提供 twiki 和 svn 访问的特定模块，但仅限于他们的项目子集。

我们开始使用 trac 来做这件事，然后转而追求 basecamp，然后是 basecamp 替代方案，然后通常陷入困境。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T11:30:58.410

我们实施了这种方法：

对于 Trac，您可以尝试使用[细粒度权限](http://trac.edgewall.org/wiki/TracFineGrainedPermissions)来控制对 wiki 页面的访问。可以使用标准权限以某种方式管理其余权限。

对于SVN访问，您可以使用您的服务器提供的授权方式。

我们还将 LDAP 作为 Trac 和 SVN 的身份验证机制。

# c# - C# 枚举值的正确命名

> ID：180266
> 
> 赞同：3
> 
> 时间：2008-10-07T20:29:29.547
> 
> 标签：c#, enums, naming

您如何看待，拥有这样一个枚举是否是个好主意：

```
enum AvailableSpace {
   Percent10,
   Percent20,
   SqF500,
   SqF600
} 
```

问题是关于值名称的语义，即百分比和平方英尺。我真的认为这不是一个好主意，但我找不到支持这一点的指南等。

编辑：这将用于确定实体的状态 - 即作为描述对象状态的只读属性。如果我们知道总空间（即对象本身知道它），我们可以选择在内部进行转换，所以我们要么只有百分比，要么只有平方英尺，或两者兼而有之。争论是，“两者”都不是一个好主意。

上面当然是一个例子，但真正的问题是一些数据提供者向我们发送了总数（sq.f.）和其他百分比，而我的目标是统一 UI。我可以随意做出一些近似值，因此将根据我们想要呈现信息的准确程度来调整确切的值。

问题只是关于值名称的语义，而不是内容 - 即，将百分比放入（潜在的）int enum 是否是个好主意。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T20:37:50.730

**答案**：不，使用枚举来表示值不是一个好主意。尤其是两个语义不同的尺度中的值。您不应该将枚举用于值。

**原因**：两个尺度的枚举值之间有什么关系，比如 Percent10 和 SqF600？如何扩展可以在代码中表示的值列表？你如何对这些值进行比较和算术运算？

**该建议（未要求，但仍然存在。:-)）**：您尝试做的事情的语义将通过包含两个字段的结构更好地反映 - 一个用于绝对区域，一个用于该绝对区域的可用百分比。有了这样的结构，你可以用上面的枚举来表示任何你可以表示的东西。例如，为您提供绝对区域的数据提供者，用具有区域和 100% 可用的结构表示。为您提供百分比的数据提供者用一个结构表示，该结构具有他们设置的百分比和绝对区域，因此该区域的百分比是数据提供者想要报告的实际可用区域。您可以从这两种类型的提供程序中获得数据的“标准化”表示，并且您可以添加几个运算符来启用与实例的比较和算术计算。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T20:33:32.407

如果可能的话，我宁愿将您的示例分成两个值，其中您的枚举是“Percent”和“SquareFeet”，第二个值是量词。将它们绑定在一个结构中。

如果上下文允许，最好创建两个包装类型“Percent”和“SquareFeet”，然后创建一些运算符重载，这样您就可以执行“new SquareFeet(500) + new Percent(20); " 并消除枚举的使用。

*更新：*如果值是行业公认的术语，您的命名方案将是合适的，几乎到了符号的地步。例如，拥有一个包含诸如“ISO9001”之类的值而不是两个值（一个包含“ISO”和一个 int 为 9001 的枚举）的枚举是安全的。有一个像下面这样的枚举也是合适的：

```
public enum OperatingSystem
{
    Windows95,
    Windows98,
    Windows2000,
    WindowsXP,
    WindowsVista,
    MacOSClassic,
    MacOSXTiger,
    MacOSXLeopard
} 
```

如果术语“Percentage10”和“Sqf500”不是艺术术语或在规范、数据字典等中没有明确定义，那么将它们用作枚举中的值是不合适的。

# visual-studio - 视觉设计器错误，当没有错误时

> ID：180270
> 
> 赞同：0
> 
> 时间：2008-10-07T20:29:51.370
> 
> 标签：visual-studio, custom-controls, designer

查看表单时出现错误，但没有任何错误。我可以关闭VS并重新打开，这很好。这是什么情况？不关门可以修吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T20:48:30.350

验证您的自定义用户控件没有任何代码错误。

还可以尝试在命令提示符下使用**devenv /resetskippkgs**启动 Visual Studio 。如果加载时出现错误，它将重置包。

# git - 如何预览 git-pull？

> ID：180272
> 
> 赞同：231
> 
> 时间：2008-10-07T20:30:30.777
> 
> 标签：git, version-control

甚至可能吗？

基本上，有一个远程存储库，我只使用：

```
git pull 
```

现在，我想预览一下这个拉动会改变什么（一个差异），而不涉及我身边的任何东西。原因是我要拉的东西可能不是“好”的，我希望其他人在使我的存储库“变脏”之前修复它。

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2008-10-07T20:53:18.810

执行 a 后`git fetch`，执行 a`git log HEAD..origin/master`以显示您最后一次常见提交和源主分支之间的日志条目。要显示差异，请使用`git log -p HEAD..origin/master`显示每个补丁，或`git diff HEAD...origin/master`（三个点而不是两个点）显示单个差异。

通常不需要撤消提取，因为执行提取只会更新*远程*分支，而不会更新*您的*分支。如果您不准备在所有远程提交中进行拉取和合并，则可以使用`git cherry-pick`仅接受您想要的特定远程提交。稍后，当您准备好获取所有内容时， a`git pull`将合并到其余的提交中。

更新：我不完全确定您为什么要避免使用 git fetch。git fetch 所做的只是更新远程分支的本地副本。此本地副本与您的任何分支都没有任何关系，并且与未提交的本地更改没有任何关系。我听说有人在 cron 作业中运行 git fetch，因为它非常安全。（不过，我通常不建议这样做。）

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-07T20:45:40.573

我认为**git fetch**是你要找的。

它将拉取更改和对象，而不将它们提交到本地存储库的索引。

它们可以稍后与**git merge 合并**。

[手册页](http://www.kernel.org/pub/software/scm/git/docs/git-fetch.html)

编辑：进一步解释

直接来自**Git-SVN Crash Course** [链接](http://git.or.cz/course/svn.html)

> 现在，您如何从远程存储库中获取任何新更改？您获取它们：
> 
> ```
> git fetch http://host.xz/path/to/repo.git/ 
> ```
> 
> 此时它们位于您的存储库中，您可以使用以下方法检查它们：
> 
> ```
> git log origin 
> ```
> 
> 您还可以区分更改。您还可以使用**git log HEAD..origin**来查看您的分支中没有的更改。然后，如果想合并它们 - 只需执行以下操作：
> 
> ```
> git merge origin 
> ```
> 
> 请注意，如果您没有指定要获取的分支，它将方便地默认为跟踪远程。

老实说，阅读手册页可以让您更好地了解选项以及如何使用它。

我只是想通过示例和记忆来做到这一点，我目前没有一个可以测试的盒子。你应该看看：

```
git log -p //log with diff 
```

可以使用**git reset --hard** ( [link](http://git-scm.com/docs/git-reset) ) 撤消获取，但是树中所有未提交的更改以及您获取的更改都将丢失。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2011-03-21T11:02:03.000

您可以从远程仓库获取，查看差异，然后拉取或合并。

这是一个名为远程 repo`origin`和一个名为`master`tracking the remote branch的分支的示例`origin/master`：

```
git checkout master                                                  
git fetch                                        
git diff origin/master
git pull --rebase origin master 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-08-18T07:32:58.230

我创建了一个自定义 git 别名来为我做到这一点：

```
alias.changes=!git log --name-status HEAD.. 
```

有了它，你可以这样做：

```
$git fetch
$git changes origin 
```

这将为您提供一种在执行`merge`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-14T10:06:55.907

我可能会迟到，但这件事困扰了我太久。根据我的经验，我宁愿查看哪些更改未决，也不愿更新我的工作副本并处理这些更改。

这在`~/.gitconfig`文件中：

```
[alias]
        diffpull=!git fetch && git diff HEAD..@{u} 
```

它获取当前分支，然后在工作副本和获取的分支之间进行比较。所以你应该只看到随之而来的变化`git pull`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-02-15T05:39:03.673

我使用这两个命令，我可以看到要更改的文件。

1.  首先执行**git fetch**，它给出这样的输出（输出的一部分）：

    ```
    ...
    72f8433..c8af041 开发 -> 起源/开发
    ...
    ```

这个操作给了我们两个提交 ID，第一个是旧的，第二个是新的。

2.  **然后使用git diff**比较这两个提交

     **```
    混帐差异 72f8433..c8af041 | grep“差异--git”
    ```** 

 **此命令将列出将要更新的文件：

```
diff --git a/app/controller/xxxx.php b/app/controller/xxxx.php
diff --git a/app/view/yyyy.php b/app/view/yyyy.php 
```

例如*app/controller/xxxx.php*和*app/view/yyyy.php*将被更新。

**使用git diff**比较两个提交会打印所有更新后的文件，其中行已更改，但使用**grep**它会搜索并仅从输出中获取包含**diff --git的行。**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-06-24T11:51:25.980

下面这个有用的命令是我从这个链接[https://gist.github.com/jtdp/5443297](https://gist.github.com/jtdp/5443297)中挑选出来的。感谢[https://gist.github.com/jtdp](https://gist.github.com/jtdp)

```
git fetch origin

# show commit logs of changes
git log master..origin/master

# show diffs of changes
git diff master..origin/master

# apply the changes by merge..
git merge origin/master

# .. or just pull the changes
git pull 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-14T16:24:27.277

如果您不希望[git-fetch](https://git-scm.com/docs/git-fetch)更新您的本地 .git，只需将本地存储库复制到临时目录并在那里拉取即可。这是一个简写：

```
$ alias gtp="tar -c . | (cd /tmp && mkdir tp && cd tp && tar -x && git pull; rm -rf /tmp/tp)" 
```

前任。：

```
$ git status
# On branch master
nothing to commit (working directory clean)

$ gtp
remote: Finding sources: 100% (25/25)
remote: Total 25 (delta 10), reused 25 (delta 10)
Unpacking objects: 100% (25/25), done.
From ssh://my.git.domain/reapO
   32d61dc..05287d6  master     -> origin/master
Updating 32d61dc..05287d6
Fast-forward
 subdir/some.file       |    2 +-
 .../somepath/by.tes    |    3 ++-
 .../somepath/data      |   11 +++++++++++
 3 files changed, 14 insertions(+), 2 deletions(-)

$ git status
# On branch master
nothing to commit (working directory clean)

$ git fetch
remote: Finding sources: 100% (25/25)
remote: Total 25 (delta 10), reused 25 (delta 10)
Unpacking objects: 100% (25/25), done.
From ssh://my.git.domain/reapO
   32d61dc..05287d6  master     -> origin/master

$ git status
# On branch master
# Your branch is behind 'origin/master' by 3 commits, and can be fast-forwarded.
#
nothing to commit (working directory clean) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-02T00:01:20.390

13 年后，你现在有一个**`prefetch`**任务在“ [`git maintenance`](https://github.com/git/git/blob/d250f903596ee149dffcd65e3794dbd00b62f97e/Documentation/git-maintenance.txt)” ^(（[男人](https://git-scm.com/docs/git-maintenance)）)

> 预取任务使用来自所有已注册远程的最新对象更新对象目录。
> 
> 对于每个遥控器，`git fetch`都会运行一个命令。
> refmap 是自定义的，以避免更新本地或远程分支（在`refs/heads`or中的那些`refs/remotes`）。
> 相反，远程参考存储在**`refs/prefetch/<remote>/`**.
> 此外，标签不会更新。
> 
> **这样做是为了避免破坏远程跟踪分支**。
> 最终用户希望这些 refs 保持不动，除非他们启动 fetch。
> 
> 然而，使用预取任务，已经获得了完成稍后真正提取所需的对象，因此真正的提取会更快。
> 在理想情况下，它只是对一堆远程跟踪分支的更新，没有任何对象传输。

从 Git 2.32 (Q2 2021) a 开始`git fetch --prefetch`，您也可以这样做，而无需修改您的上一次获取状态。

请参阅[Derrick Stolee ( ) 的](https://github.com/derrickstolee)[提交 32f6788](https://github.com/git/git/commit/32f67888d85bd0af30b857a29ca25a55999b6d01)、[提交 cfd781e](https://github.com/git/git/commit/cfd781ea22e0f334d3c0104e1f34c47327934314)、[提交 2e03115](https://github.com/git/git/commit/2e03115d0c253843953ef9d113c72e0375892df4)（2021 年 4 月 16 日）和[提交 a039a1f](https://github.com/git/git/commit/a039a1fcf987de3a8209cc5229324d37d9ead16e)（2021 年 4 月 6 日[）](https://github.com/derrickstolee)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([d250f90 提交中](https://github.com/git/git/commit/d250f903596ee149dffcd65e3794dbd00b62f97e))^(，2021 年 4 月 30 日）)[`derrickstolee`](https://github.com/derrickstolee)
^([`gitster`](https://github.com/gitster))

> ## [`fetch`](https://github.com/git/git/commit/2e03115d0c253843953ef9d113c72e0375892df4): 添加`--prefetch`选项
> 
> ^(帮助者：Tom Saeger)
> ^(帮助者：Ramsay Jones)
> ^(签字者：Derrick Stolee)

> `--prefetch`'prefetch' 维护任务将使用该选项，而不是通过命令行显式发送 refspec。
> 目的是修改 refspec 以将所有结果放入`refs/prefetch/`而不是其他任何地方。
> 
> 创建辅助方法`filter_prefetch_refspec()`来修改给定的 refspec 以适应预取任务的预期规则：
> 
> *   负面的参考规范被保留。
> *   没有目的地的 Refspecs 被删除。
> *   源以 " " 开头的 Refspecs`refs/tags/`将被删除。
> *   其他 refspecs 放在“ `refs/prefetch/`”中。
> 
> 最后，我们添加 ' `force`' 选项以确保根据需要替换预取引用。
> 
> 有一些有趣的案例值得测试。
> 
> 此更改的早期版本`i--`从删除 refspec 项并将剩余条目向下移动的循环中删除了“”。
> 这允许不修改某些参考规范。
> 第一个`--prefetch`测试的微妙之处在于`refs/tags/*`refspec 直接出现在 refs/heads/bogus/* refspec 之前。
> 如果没有那个“ `i--`”，这个排序将删除“ `refs/tags/*`” refspec 并保留最后一个不修改，将结果放在“ `refs/heads/*`”中。
> 
> 可能有一个空的 refspec。
> 这通常适用于除源之外的远程，用户想要获取特定标签或分支。
> 为了正确测试这种情况，我们需要进一步删除本地分支的上游远程。
> 因此，我们正在测试一个将被删除的 refspec，没有任何东西可以获取。

`fetch-options`现在在其[手册页](https://github.com/git/git/blob/2e03115d0c253843953ef9d113c72e0375892df4/Documentation/fetch-options.txt#L113-L117)中包含：

> ## `--prefetch`
> 
> 修改配置的 refspec 以将所有 refs 放入 `refs/prefetch/`命名空间。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2017-06-19T14:58:21.153

将 repo 克隆到别处怎么样，然后在真正的结帐和新的克隆上执行 git log 以查看是否得到相同的东西。

# c++ - 以编程方式更改 Windows Mobile 6.1 主题

> ID：180277
> 
> 赞同：1
> 
> 时间：2008-10-07T20:31:37.763
> 
> 标签：c++, windows-mobile, mfc

我试图找出在 windows mobile 6.1 中应用新的基于 tsk 的主题文件的正确程序。

我已经尝试关闭页面[http://www.pocketpcdn.com/articles/changetodaytheme.html](http://www.pocketpcdn.com/articles/changetodaytheme.html)但这只会改变背景，而不是系统颜色，例如屏幕上的顶部和底部栏。

wceload.exe 似乎对某些 tsk 和部分其他 tsk 非常有效。

有谁知道更多关于 tsk 文件并在 Windows Mobile 6.1 中以编程方式应用它们的信息？

我的应用程序是一个开源应用程序，代码可用；可通过只读 svn 访问，请随时查看[@google 代码](http://code.google.com/p/manilla2dcustomizer/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T18:41:55.767

我最终找到了解决方案，但我认为这不是一个通用的解决方案。

调用“\Windows\cusTSK.exe \Windows\ThemeName.tsk”会改变顶部和底部的栏，但不会改变主题的所有方面......所以调用 wceload.exe 然后按该顺序调用 cuTSK.exe 似乎能够使用我测试过的所有 tsk 文件更改主题。

可以从 msdn 下载的 Windows Mobile 6.1 Professional 仿真器映像上不存在 cusTSK.exe 二进制文件，因此我认为该文件存在于自定义 rom 和 HTC 制造的设备上，这就是为什么我不认为这是通用的解决方案，但它适用于我的目的

# asp.net - 在 ASP.NET 中拉多个记录集时的 DataReader 或 DataSet

> ID：180283
> 
> 赞同：11
> 
> 时间：2008-10-07T20:32:55.653
> 
> 标签：asp.net, performance, dataset, sqldatareader

我有一个 ASP.NET 页面，其中包含一堆需要填充的控件（例如下拉列表）。

我想单次访问数据库并带回多个记录集，而不是为每个控件进行往返。

我可以带回 DataSet 中的多个表，或者我可以带回 DataReader 并使用“.NextResult”将每个结果集放入自定义业务类中。

使用 DataReader 方法可能会看到足够大的性能优势，还是应该只使用 DataSet 方法？

您通常如何处理此问题的任何示例将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T11:02:40.760

1.  **如果您有超过 1000 条**记录要从您的数据库中获取。
2.  *如果您对自定义存储和自定义分页“ For GridView* ”不是很感兴趣
3.  如果您的服务器有内存压力。
4.  如果每次调用该页面时连接到您的数据库都没有问题。

***然后我认为更好的是使用DataReader。***

别的

1.  **如果您从数据库中获取的记录**少于 1000条。****
***   如果您对存储和分页“ *For GridView* ”感兴趣*   如果您的服务器没有内存压力。*   如果您只想一次连接到您的数据库并获得**缓存**的好处。**

 *****然后我认为更好的是使用DataSet。***

我希望我是对的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T22:34:50.883

如果您的存储过程返回多个集合，请使用 DataReader.NextResult 前进到下一个数据块。通过这种方式，您可以获得所有数据，将其加载到您的对象中，并尽快关闭阅读器。这将是获取数据的最快方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-19T07:19:49.750

看到即使已经有很多好的答案也没有标记答案，我想我也会添加两位。

我会使用 DataReaders，因为它们要快得多（如果性能是你的事，或者你需要尽可能多的东西）。我从事的大多数项目在每个表中都有数百万条记录，性能是一个问题。

有人说跨层发送 DataReader 不是一个好主意。我个人不认为这是一个问题，因为“DbDataReader”在技术上与数据库无关（或不必）。也就是说，您可以在不需要数据库的情况下创建 DbDataReader 的实例。

我这样做的原因如下： 经常（在 Web 应用程序中）生成 Html、Xml 或 JSON 或其他数据转换。那么，为什么从 DaraReader 转到某个 POCO 对象只是为了将其转换回 XML 或 JSON 并将其发送到网络上。这种过程通常需要 3 次转换和对象实例化的引导加载，只是为了几乎立即将它们丢弃。

在某些情况下，这很好或无能为力。我的数据层通常为系统中的每个存储过程提供两种方法。一个返回 DbDataReader，另一个返回 DataSet/DataTable。返回 DataSet/DataTable 的方法调用返回 DbDataReader 的方法，然后使用 DataTable 的“Load”方法或适配器来填充数据集。有时您需要 DataSet，因为您可能必须以某种方式重新调整数据的用途，或者您需要触发另一个查询，并且除非您启用了 MARS，否则您无法打开 DbDataReader 并触发另一个查询。

现在使用 DbDataReader 或 DataSet/DataTable 存在一些问题，这通常是代码清晰度、编译时检查等。您可以为数据读取器使用包装类，实际上您可以将 DataReaders 与它们一起使用 IEnumerable。真的很酷的能力。因此，您不仅可以获得强大的类型和代码可读性，还可以获得 IEnumerable！

所以一个类可能看起来像这样。

```
public sealed class BlogItemDrw : BaseDbDataReaderWrapper
{
    public Int64 ItemId { get { return (Int64)DbDataReader[0]; } }
    public Int64 MemberId { get { return (Int64)DbDataReader[1]; } }
    public String ItemTitle { get { return (String)DbDataReader[2]; } }
    public String ItemDesc { get { if (DbDataReader[3] != DBNull.Value) return (String)DbDataReader[3]; else return default(String); } }
    public DateTime ItemPubdate { get { return (DateTime)DbDataReader[4]; } }
    public Int32 ItemCommentCnt { get { return (Int32)DbDataReader[5]; } }
    public Boolean ItemAllowComment { get { return (Boolean)DbDataReader[6]; } }
    public BlogItemDrw()
      :base()
    {
    }

    public BlogItemDrw(DbDataReader dbDataReader)
      :base(dbDataReader)
    {
    }
} 
```

[数据读取器包装器](http://www.matlus.com/2010/11/datareader-wrappers-typesafe/)

我有一篇博文（上面的链接），其中包含更多细节，我将为这些和其他 DataAccess 层代码制作源代码生成器。

您可以对 DataTables 使用相同的技术（代码生成器生成代码），因此您可以将它们视为强类型 DataTable，而不会产生 VS.NET 开箱即用的开销。

请记住，包装类只有一个实例。所以你不会创建一个类的数百个实例只是为了把它扔掉。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-07T20:34:57.863

始终将您的数据放入为特定用途定义的类中。不要传递 DataSet 或 DataReaders。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-07T20:55:21.553

Map the DataReader to intermediate objects and then bind your controls using those objects. It can be ok to use DataSets in certain circumstances, but those are few and far between when you have strong reasons for "just getting data". Whatever you do, don't pass a DataReader to your controls to bind off of (not that you said that you were considering that).

My personal preference would be to use an ORM, but if you are going to hand roll your data access, by all means I think you should prefer mapping DataReaders to objects over using DataSets. Using the .NextResult as a way to limit yourself from hitting the database multiple times is a double edged sword however so choose wisely. You will find yourself repeating yourself if you try to create procs that always grab exactly what you need using only one call to the database. If your application is only a few pages, it is probably OK, but things can get out of control quickly. Personally I'd rather have one proc per object type and then hit the database multiple times (once for each object type) in order to maximize maintainability. This is where an ORM shines because a good one will generate Sql that will get you exactly what you want with one call in most cases.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-03T13:10:13.900

无论您是获取单个结果集还是多个结果集，共识似乎是使用 DataReader 而不是 DataSet。

关于你是否*应该*打扰多个结果集，智慧是您不应该这样做，但我可以设想出该规则的合理例外类别：（紧密）相关的结果集。您当然不希望添加一个查询来为在应用程序的数百甚至数十个页面上重复的下拉列表返回相同的选择集，但可以合理地组合几组狭窄使用的选项。例如，我目前正在创建一个页面来显示一批 ETL 数据的几组“差异”。这些查询都不可能在其他地方使用，因此将它们封装为单个“获取差异”存储过程会很方便。另一方面，

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-07T20:35:43.167

如果您对更新或删除从数据库中获取的记录不感兴趣，我建议您使用 DataReader。基本上 DataSet 在内部使用多个 Datareader，因此 DataReader 应该会给您带来良好的性能优势。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-07T22:07:51.047

在几乎所有情况下`DataReader`，s都是从数据库读取 [的最佳解决方案。](http://aspnet.4guysfromrolla.com/articles/050405-1.aspx)`DataReader`s比s 或s[更快](http://www.devx.com/vb2themax/Article/19887/1954?pf=true)并且需要更少的内存。`DataTable``DataSet`

此外，`DataSet`s 经常会导致 OO 模型被[破坏](http://swap.wordpress.com/2007/07/10/dataset-vs-custom-entity/)的情况。传递关系数据/模式而不是知道如何操作该数据的对象并不是非常面向对象的。

因此，出于可扩展性、可伸缩性、模块化和性能原因，`DataReader`如果您认为自己是真正的程序员™，请始终使用 s ;)

检查链接以获取有关实践和理论中两者的事实和讨论。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-07T20:34:57.273

我已经使用了一种对所有调用都使用 DataReaders 的方法，我注意到性能显着提高，尤其是在我加载下拉列表和其他类似的简单项目时。

就个人而言，使用多个下拉菜单，我通常会提取单个数据块来获取它，而不是说一个返回 5 个结果集的存储过程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T22:28:42.597

查看 .NET 2.0 及更高版本可用的 TableAdapter。他们所做的是为您提供强类型 DataTable 的强度，并允许您将 Fill 方法映射到它，该方法将使用 DataReader 来加载它。您的填充方法可以是现有的存储过程、您自己的 AdHoc SQL，甚至可以让向导为您生成 AdHod 或存储过程。

您可以通过在项目中启动一个新的 XSD DataSet 对象来找到它。对于不仅仅用于查找的表，您还可以将插入/更新/删除方法映射到 TableAdapter。

# ruby-on-rails - ruby on rails 的限制是什么？

> ID：180290
> 
> 赞同：9
> 
> 时间：2008-10-07T20:35:32.340
> 
> 标签：ruby-on-rails, ruby

我记得曾经和那些使用 Ruby on Rails 的人交谈过，然后当他们遇到限制时不得不放弃它，或者发现它最终过于死板。我忘记了细节，但这可能与使用多个数据库有关。

所以我想知道的是 Ruby on Rails 之外的特性/要求，或者至少需要这样的扭曲，最好使用另一个更灵活的框架，即使你可能不得不失去一些优雅或编写额外的代码样板代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-08T01:36:54.667

Rails（不是 ruby​​ 本身）以成为“有意见的软件”而自豪。

这在实践中意味着 Rails 的作者有一定的目标受众（基本上是他们自己），并专门针对该目标受众。如果该目标受众不需要 X 功能，则不会添加它。

在我的脑海中，rails 明确不支持人们可能关心的事情：

1.  数据库中的外键
2.  一次连接到多个数据库
3.  SOAP Web 服务（自 rails 2.0 起）
4.  一次连接到多个数据库*服务器*

也就是说，使用插件扩展 rails 非常容易，并且有一些插件可以将上述所有功能添加到 rails 等等，所以我不会将这些视为限制。

唯一需要注意的是，rails 是*围绕*使用 MVC 创建 CRUD Web 应用程序的想法构建的。如果您尝试做一些不是 CRUD Web 应用程序的事情（例如 twitter，它实际上是一个消息传递系统，或者如果您很疯狂并且想要使用像 ASP.NET Webforms 这样的模型），那么您也会遇到问题。在这种情况下，您最好不要使用铁轨，因为您实际上是在尝试用自行车零件建造一艘船。

您遇到的问题很可能无法通过快速插件或一两天的编码来解决，这些问题都是底层 C Ruby 运行时的固有问题（内存泄漏、绿色线程、垃圾性能等） .

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T20:58:25.570

Ruby on Rails 不支持开箱即用的两阶段提交，如果您的数据库支持的应用程序需要保证即时一致性并且您需要使用两个或更多数据库模式，则可能需要这样做。

对于许多 Web 应用程序，我敢说这不是一个常见的用例。一个人可以很好地支持两个或多个数据库的最终一致性。或者可以支持与一种数据库模式的即时一致性。如果您的应用程序必须支持大量事务（请注意技术术语:)，前一种情况是一个很大的问题。后一种情况更典型，Rails 做得很好。

坦率地说，在遇到真正的可伸缩性问题之前，我不会担心使用 Ruby on Rails（或任何框架）的限制。*先*构建一个*杀手级*应用，然后再担心可扩展性。

 *澄清：我正在考虑 Rails 很难支持的事情，因为它可能需要对其架构进行根本性转变。我会很慷慨地包含一些属于 gem/plugin 生态系统的东西，例如外键强制或 SOAP 服务。

通过两阶段提交，我的意思是尝试在一个事务上下文中对物理上不同的服务器进行两次提交。

用于两阶段提交的用例 #1：您已经对数据库进行了集群化，因此您有 2 个或更多数据库服务器，并且您的架构分布在两台服务器上。您可能想要提交到两台服务器，因为您想让 ActiveRecord 认为做一个遍历不同服务器的“外键映射”。

两阶段提交的用例 #2：您正在尝试实现消息传递解决方案（抱歉，我白天是 J2EE 开发人员）。消息生产者向消息代理（一台服务器）和数据库（另一台服务器）提交。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T19:06:52.567

[还发现了一些关于ActiveRecord 限制的](https://stackoverflow.com/questions/7864/why-all-the-active-record-hate)很好的讨论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-12T19:41:18.737

我认为这里有一个更大的“元问题”，可以回答，那就是“什么时候可以依靠外部库来加快开发时间？”</p>

第三方库通常很棒，可以大大减少开发时间，但是有一个主要问题，Joel Spolsky 称之为“抽象泄漏定律”。如果您在 Google 上查找，他的帖子将首先出现。从本质上讲，这意味着开发时间的权衡意味着您不知道幕后发生了什么。因此，当出现问题时，您会完全陷入困境并且调试方法非常有限。这也意味着，如果您遇到了 RAILS 中根本不支持的功能之一，而您确实需要，那么如果幸运的话，除了自己编写该功能之外，您将没有下一步。许多图书馆可以使这很难做到。

这个问题在我的开发商店中被严重烧毁。我们的解决方案在正常负载下运行良好，但我们发现我们使用的第三方订阅库根本无法承受我们网站开始获得大量并发用户时所经历的那种负载。这使我们处于一个非常困难的境地；本质上，我们必须自己重写整个订阅服务，同时考虑到性能。这样做意味着我们浪费了所有使用库的时间。

第三方库非常适合中小型应用程序；它们可以大大减少开发时间并隐藏在开发的早期阶段不需要处理的复杂性。然而最终他们会赶上你，你可能不得不重写或重新设计你的解决方案以超越“泄漏抽象法则”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T07:09:31.277

Ruby 在 ASP.Net 中没有像 IsPostBack 这样的功能

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T17:03:51.863

猎户座的答案是正确的。AR/Rails 几乎没有硬性限制：部署到 Windows，不经常使用的 AR 连接器，例如 Firebird，），但即使是他提到的东西，多个数据库和 DB 服务器，也有解决这些问题的 gem 和插件遗留、分片和其他原因。

真正的限制是，在考虑到博客数量和邮件列表数量的情况下，掌握 Rails 开发人员正在处理的所有事情以及研究特定问题是多么耗时。

# iframe - 如何从 iframe 发布到 iframe 之外的另一个页面？

> ID：180294
> 
> 赞同：1
> 
> 时间：2008-10-07T20:36:00.780
> 
> 标签：iframe, post, redirect

在 iframe 中，我让用户使用第三方网站验证信用卡支付信息，验证后页面将重定向到我们应用程序中的预定义 URL。但是，它会在 iframe 本身内发布到此 URL。有没有一种干净的方法可以重定向到我需要的页面？还是我必须使用一些中间页面，然后将重定向“出”iframe？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T20:39:36.373

尝试将以下 javascript 放入返回的页面中。

```
window.parent.location = url; 
```

# c# - 获取新条目的主键

> ID：180295
> 
> 赞同：6
> 
> 时间：2008-10-07T20:36:27.567
> 
> 标签：c#, .net, database, ms-access, primary-key

我有许多子表具有父表的外键。

如何在父表中添加一个条目并获取该条目的主键，以便我可以在子表中输入指向父表中的条目的行？

我正在从 C# 应用程序的 MS Access 数据库中执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T20:39:49.367

Microsoft Access 2000 或更高版本不支持@@IDENTITY 属性在INSERT 之后检索自动编号字段的值。( [msdn](http://msdn.microsoft.com/en-us/library/ks9f57t0(VS.71).aspx) )

编辑：[这](http://msdn.microsoft.com/en-us/library/ks9f57t0.aspx)是 .NET 3.5 的类似文章的链接

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T20:42:56.477

[获取最近添加记录的标识](http://www.mikesdotnetting.com/Article.aspx?ArticleID=54)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T20:41:47.977

尝试查看将为您提供标识值的全局变量。在 SQL Server 中是：

选择@@身份

还要查看 Scope_Identity() 函数

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T20:42:26.600

即使您必须使用第二个查询来执行此操作，也应该能够选择 @@IDENTITY。我认为 MS Access 不会允许将其合并到一个查询中。

# java - 你的Java“规则”是什么？

> ID：180297
> 
> 赞同：6
> 
> 时间：2008-10-07T20:38:26.720
> 
> 标签：java

我正在学习 Java，我想知道每个人的 Java 规则是什么。您本质上知道的规则，如果您看到有人违反它们，您会尝试纠正它们。让你远离麻烦或帮助改善事情的事情。你永远不应该做的事情。你应该经常做的事情。初学者不会知道的规则。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-07T20:41:51.830

阅读Bloch 的《 [Effective Java](http://java.sun.com/docs/books/effective/)》。

这正是您所要求的，一组用于编写非常棒的、惯用的 Java 代码的规则。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-07T20:50:36.227

好的，头脑风暴：

*   考虑类和对象，而不是函数。
*   避免空的 catch 子句（尤其是**catch(Throwable t) {}**）
    *   处理错误，不要忽略它。
    *   仅处理您想要在您**可以处理的地方处理的异常****类型**。

***   使用 Javadoc。
    *   让你思考你在做什么。
    *   在开发时生成文档。
    *   使 Eclipse 等 IDE 在使用您的类和方法时显示提示。*   尝试使用泛型和注释来习惯它。**

 **还有更多，但那些是我最先想到的。

顺便说一句，如果您从初学者晋升为专家，您将知道何时对这些规则做出例外；）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-07T20:44:51.090

我的其中之一是坚持[Sun 编码约定](http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-07T21:28:54.760

如果您重复自己，例如通过复制和粘贴，那么您做错了。Java 是一种 OO 语言，就这样使用吧。

如果您不使用设计模式，那么您就是在重新发明轮子。原始的 GOF 设计模式能最好地解决多少问题，真是令人惊讶。只有在回顾了这些之后，你才能做一些不同的事情。

保持你的方法名称长，你的参数名称描述性，但你的方法短。这有点主观，但是您将事物拆分得越多，修复和重用代码就越容易。如果你不能用一句话解释你的方法在做什么，你要么有一个通常很复杂的问题，要么你的方法很可能做得太多。

避免让每个对象做太多事情。看看你的物品上的名字。如果对象中有与对象名称无关的方法，请将它们移动到它们可能属于的位置。

方法重载很好，它可以让你免于到处进行类型转换。

尽量避免以这样一种方式“聪明”，使您编写的代码更难理解。尽可能多地使用语言的内置特性（例如迭代器）。做可能可行的最简单的事情。以后你会感谢自己的。

源代码控制是必要的，即使您是一名单独工作的开发人员。它拯救了我的脖子，我数不清。

初始调试后，不应进行硬编码。对于跨应用程序使用的项目，例如环境和相关消息，在数据库中存储尽可能多的项目。如果您认为这些项目永远不会改变，请使用属性文件和全局 java 文件来保存您确信永远不会改变的东西，因为它们会改变。

使用您的 IDE 自动格式化您的代码，即使它变得丑陋，从长远来看，您仍然会更好。

如果有一个众所周知且可靠的框架，请使用它。JSF 或 Struts 将比您自己开发的任何东西都要好，即使您认为自己的 MVC 框架真的很酷。与持久性相同，使用主流的东西。在可能的情况下尝试使用尽可能少的框架或一个框架。您可能会因为使用 Hibernate 以及您自己开发的其他一些框架而拥有一个 Spring、Shale、JSF、Struts 项目给您的朋友留下深刻印象，但这实际上只是为了复杂而复杂。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-07T21:14:02.717

Never execute time-consuming tasks in the AWT event dispatch thread or you will have a non-responsive GUI.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-07T20:49:30.487

你应该记录你的代码！

*   您必须记录您编写的所有代码。当你在 3 个月后回来阅读它时，你必须对代码的作用留下一些提示，这一点至关重要。
*   您不应该记录代码正在做**什么**，因为它就在代码中。
*   但是，您应该记录代码存在的**原因。**从长远来看，你会从“为什么”评论中获得比“什么”评论更多的好处。
*   如果很难记录，可能是您对问题的考虑不够。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-07T20:51:01.733

**平等比较**

在进行相等比较时，请考虑是否要比较值相等（两个对象是否具有相同的值）或引用相等（它们是否完全相同的对象实例）。对于引用相等，使用`==`运算符；对于值相等，您通常需要使用该`.equals()`方法。

（请注意，非核心 Java 类可能有也可能没有有意义的 .equals() 实现；大多数核心类确实有良好的 .equals() 实现。）

例如，一个常见的错误是`(string1 == string2)`尝试并确定字符串变量是否`string1`和`string2`代表相同的字符串值。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-07T21:00:52.743

Use a **checked** (declared) exception if there is no way to guarantee the exception will not happen, but ensure the exception is documented in the contract (the JavaDoc). Punish the caller with an **unchecked** (runtime) exception if the caller violated the contract, e.g. passed in a null argument when the contract specified that the argument may not be null.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-07T20:43:11.110

查看 Java API。特别是 util 包。那里有许多库可以执行常见任务，重用它们比滚动你自己的要好得多。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-07T20:41:36.917

你应该经常做的事情。

阅读 Java 语言规范。如果您至少在另一种 OOP 语言方面有一定的背景，那将获得巨大的回报。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-07T22:01:31.590

总是尽可能多地编写单元测试。有 2 个主要的单元测试框架——junit 和 TestNG。他们每个人都有一个由其他测试扩展组成的生态系统。进行单元测试会给你信心。在有人添加新代码或修改代码后，您可以通过全面运行单元测试来确定系统是否损坏。

此外，java 社区已经接受了持续集成系统。其中许多是开源的——计划定期构建您的软件。如果可以的话，部署它并在它们上运行集成测试，但至少要定期构建和运行单元测试。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-07T20:55:17.497

Use and understand the Java Collection Framework.

Use the class `ArrayList` instead of `Vector`. Use `HashMap` instead of `Hashtable`.

For synchronized access, use the `Collections` utility class.

Only use `Hashtable` and `Vector` if you really must code against some legacy API.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-07T21:09:07.763

Be liberal in what you accept and specific in what you return.

For example, take a general-purpose method with the following signature:

> `public void doXY(LinkedList widgets)`

With this signature, clients cannot use your general-purpose method with other `Lists` or even a `Set` type. An input parameter type can often be broadened to make the method more flexible to use, e. g.:

> `public void doXY(Collection widgets)`

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-07T20:45:06.567

如果您发现自己使用[继承](http://en.wikipedia.org/wiki/Inheritance_(computer_science))而不是[组合](http://en.wikipedia.org/wiki/Object_composition)，那么您可能做错了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-07T23:45:03.830

在我看来，最重要的是：

1.  格式：我无法理解格式错误的代码。
2.  好的命名：好的命名约定是好的代码的第一步。
3.  文档：总是写关于代码是什么以及为什么这样做的文档
4.  不要重复代码
5.  利用“有效java”中提到的技术。这本书提供了非常有用的指导。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-07T23:51:58.823

一组很棒的建议！

让我们看看，我没有看到提到的..

使用很多小班。每个班级应该做好一件事。我从来没有见过太多的课程，几乎总是太少。

阅读 Refactoring 书——关于 Bad Code Smells 的部分列出了很多需要注意的东西。

您做 OO 错误的最大指示是很多 setter 和 getter，希望使用 switch 语句和大型继承树，但还有很多其他问题（您的问题不是 OO，但足够接近）。

不要习惯性地初始化局部变量（String s=null;），否则编译器无法捕捉到这个问题：

```
String s;
if(x == 5)
    s="5";

if(y == 5) 
    s.append("5"); // Compiler will tell you s might not have been assigned
                   // UNLESS your first line was "String s=null" 
```

学习 Javadocs。只要养成使用它们的习惯，它们并没有那么复杂。

使用 Eclipse 或 NetBeans。打开错误检查。注意错误。有些你可能认为并不重要，但很多会有所帮助。

如果您在 Swing 中工作，请了解事件线程——了解它，否则您的 GUI 将看起来像废话。

SDK 中有一些很棒的库。许多程序员都错过了高级线程控制、引用类、NIO 和反射——而这只是皮毛。

也就是说，不要滥用反射——它会使你的代码难以维护——只要知道它的存在以及它可以做什么。

不要“清空”变量来释放内存——它实际上从来没有用过，而且会让你看起来像不了解垃圾收集。用 finalize 方法来做更傻。

嗯，当我们在那里时——不要使用 finalize 方法。曾经。如果您需要清理外部资源，请查找引用类 (WeakReference)。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-08T07:44:38.247

*   保持代码整洁（缩进），带有注释和清晰的变量名。这将帮助您在以后阅读/编辑您的代码。它还将帮助其他人阅读您的代码。

*   在适用的情况下创建对象。

*   确保代码效率，不要重复代码（没有复制+粘贴 mkay?.

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-09-04T14:06:33.037

Another good book on the issue is [Robert C. Martins](http://en.wikipedia.org/wiki/Robert_Cecil_Martin) [Clean Code](http://books.google.de/books?id=dwSfGQAACAAJ&dq=isbn:0132350882&source=bl&ots=YW1ku8GLVZ&sig=4vhcjNCxOlbMwlt_RM9Gu8YDurE&hl=de&sa=X&ei=HAtGUJjxE4fxsgbl6oHgAQ&redir_esc=y).

It contains general coding rules and guidelines for java but most of them could be applied to other languages too.

I think a developer who read this book produces much more readable and maintainable code.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-07T20:46:56.997

1.  尽可能少地使用递归。递归有很多用途，但大多数情况下，一个简单的循环将完成相同的工作，而不会产生递归产生的开销。

2.  尽可能使用泛型。很多时候，一个类可以用于您在开发它时从未想过的应用程序。泛型简化了重用过程而无需重构。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-08T13:38:08.923

我看到了一个我尝试并应用的相当好的建议：避免将类字段初始化为默认值。

我仍然经常看到：

```
public class Foo
{
  boolean b = false;
  int n = 0;
  float x = 0.0;
  SomeClass sc = null;
} 
```

等等。

它是低效的（虽然在次要级别），因为 JVM 已经在变量分配时设置了值，丑陋（并且分散了读者对非默认值的注意力）并且在调试时令人讨厌（我们必须在类创建时进入那里） ）。

有人说在某些情况下需要这样的初始化，但并不是无法提供一个真实的案例。如果有人在这里有更多信息......

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-11-11T12:35:15.440

[Steven McConnel 编写的Code Complete](http://cc2e.com/)提供了许多有用的技巧，不仅适用于 Java 编程，还适用于一般编程。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2011-03-15T00:20:27.253

1.  ### `properties`始终对和使用不言自明的命名`methods`。

2.  ### `Comment`仅在需要时。

# delphi - Delphi 2009 英文版和法文版可以在同一台机器上共存吗？

> ID：180299
> 
> 赞同：2
> 
> 时间：2008-10-07T20:38:49.807
> 
> 标签：delphi, delphi-2009

有谁知道（如尝试并成功）我是否可以同时拥有英语和法语的 D2009？
与其说是生成法语或英语应用程序，不如说是让 IDE 以任何一种语言都可用，以拍摄屏幕截图并以法语或英语进行演示。

会涉及什么：补充安装加上一些快捷参数开关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T20:47:21.083

在虚拟机中安装一个版本。我听说 VMWare 工作得非常好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T22:08:49.127

不行，行不通。如果它们是不同的版本（即一个 2007，一个 2009），那么你应该没问题，但如果它们是相同的版本，你需要按照 Jim 的建议走 VM 路线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T10:22:02.437

你为什么要那个？如果您需要程序的国际化版本，您最好使用 at 工具（例如 dxGetText），而不是使用不同的 Delphi 版本重新编译它。在这种情况下，我绝对建议使用英语 IDE，这样您就可以将 RTL 错误从英语翻译成目标语言。

# c++ - C++ 模板只是变相的宏吗？

> ID：180320
> 
> 赞同：64
> 
> 时间：2008-10-07T20:43:07.177
> 
> 标签：c++, templates, macros

我用 C++ 编程已经有几年了，我用过很多 STL 并且创建了我自己的模板类几次，看看它是如何完成的。

现在我正在尝试将模板更深入地集成到我的 OO 设计中，一个烦人的想法不断地回到我的脑海：它们只是一个宏，真的……你可以使用 #defines 实现（相当丑陋）auto_ptrs，如果你真的想要。

这种对模板的思考方式有助于我理解我的代码实际上是如何工作的，但我觉得我一定是以某种方式错过了这一点。宏意味着邪恶的化身，但“模板元编程”风靡一时。

那么，真正的区别是什么？以及模板如何避免#define 导致您陷入的危险，例如

*   在您不希望出现的地方出现难以理解的编译器错误？
*   代码膨胀？
*   追溯代码困难？
*   设置调试器断点？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-07T20:46:51.070

宏是一种文本替换机制。

模板是一种功能图灵完备的语言，在编译时执行并集成到 C++ 类型系统中。您可以将它们视为该语言的插件机制。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-07T20:44:34.787

它们由*编译器*解析，而不是由在编译器*之前*运行的预处理器解析。

这是 MSDN 所说的：http: [//msdn.microsoft.com/en-us/library/aa903548 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa903548(VS.71).aspx)

> 以下是宏的一些问题：
> 
> *   编译器无法验证宏参数的类型是否兼容。
> *   宏在没有任何特殊类型检查的情况下展开。
> *   i 和 j 参数被评估两次。例如，如果任一参数具有后增量变量，则增量执行两次。
> *   因为宏是由预处理器扩展的，所以编译器错误消息将引用扩展的宏，而不是宏定义本身。此外，宏将在调试期间以扩展形式显示。

如果这对你来说还不够，我不知道是什么。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-10-07T21:34:37.150

这里有很多评论试图区分宏和模板。

是的 - 它们都是同一件事：代码生成工具。

宏是一种原始形式，没有太多的编译器强制执行（就像在 C 中做 Objects - 它可以完成，但它并不漂亮）。模板更高级，并且有更好的编译器类型检查、错误消息等。

然而，每个人都有对方没有的优势。

模板只能生成动态类类型——宏可以生成几乎任何你想要的代码（除了另一个宏定义）。宏对于将结构化数据的静态表嵌入到代码中非常有用。

另一方面，模板可以完成一些用宏无法实现的真正 FUNKY 的事情。例如：

```
template<int d,int t> class Unit
{
    double value;
public:
    Unit(double n)
    {
        value = n;
    }
    Unit<d,t> operator+(Unit<d,t> n)
    {
        return Unit<d,t>(value + n.value);
    }
    Unit<d,t> operator-(Unit<d,t> n)
    {
        return Unit<d,t>(value - n.value);
    }
    Unit<d,t> operator*(double n)
    {
        return Unit<d,t>(value * n);
    }
    Unit<d,t> operator/(double n)
    {
        return Unit<d,t>(value / n);
    }
    Unit<d+d2,t+t2> operator*(Unit<d2,t2> n)
    {
        return Unit<d+d2,t+t2>(value * n.value);
    }
    Unit<d-d2,t-t2> operator/(Unit<d2,t2> n)
    {
        return Unit<d-d2,t-t2>(value / n.value);
    }
    etc....
};

#define Distance Unit<1,0>
#define Time     Unit<0,1>
#define Second   Time(1.0)
#define Meter    Distance(1.0)

void foo()
{
   Distance moved1 = 5 * Meter;
   Distance moved2 = 10 * Meter;
   Time time1 = 10 * Second;
   Time time2 = 20 * Second;
   if ((moved1 / time1) == (moved2 / time2))
       printf("Same speed!");
} 
```

该模板允许编译器动态地创建和使用模板的类型安全实例。编译器实际上在编译时进行模板参数数学运算，为每个唯一结果创建单独的类。有一个隐含的 Unit<1,-1>（距离 / 时间 = 速度）类型，它在条件内创建和比较，但从未在代码中显式声明。

显然，大学里有人用 40 多个参数（需要参考）定义了这种模板，每个参数代表不同的物理单元类型。考虑一下那种类的类型安全，只是为了你的数字。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-12-14T18:20:02.883

答案太长了，我无法总结所有内容，但是：

*   例如，宏不能确保类型安全，而函数模板可以：
    编译器无法验证宏参数的类型是否兼容——在函数模板被实例化时，编译器也知道是否`int`或`float`定义`operator +`
*   模板为元编程打开了大门（简而言之，在编译时评估事物并做出决定）：
    在编译时可以知道类型是整数还是浮点数；无论是指针还是 const 限定等...[请参阅即将发​​布的 c++0x 中的“类型特征”](//www.stroustrup.com/C++11FAQ.html#type_traits)。
*   类模板具有部分特化
*   函数模板具有显式的完全专业化，在您的示例中，其实现方式可能与宏无法`add<float>(5, 3);`实现的方式不同`add<int>(5, 3);`
*   宏没有任何作用域
*   `#define min(i, j) (((i) < (j)) ? (i) : (j))`-`i`和`j`参数被评估两次。例如，如果任一参数具有后增量变量，则增量执行两次
*   因为宏由预处理器扩展，编译器错误消息将引用扩展的宏，而不是宏定义本身。此外，宏将在调试期间以扩展形式显示
*   ETC...

~~注意：在极少数情况下，我更喜欢依赖可变参数宏，因为在 c++0x 成为主流之前，没有可变参数模板之类的东西。~~ [C++11](//en.wikipedia.org/wiki/C++11)已上线。

参考：

*   [C++ FAQ Lite：[35] 模板](//isocpp.org/wiki/faq/templates)
*   [模板的优点](http://msdn.microsoft.com/en-us/library/z3f89ch8(VS.80).aspx)（已停用，可下载）
*   [模板 vs. 宏 (C++)](http://msdn.microsoft.com/en-us/library/aa903548(VS.71).aspx)（已停用，可下载）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-12-14T18:21:20.567

在非常基本的层面上，是的，模板只是宏替换。但是你这样想就跳过了*很多*事情。

考虑模板专业化，据我所知，您无法使用宏进行模拟。这不仅允许特定类型的特殊实现，它还是模板元编程中的关键部分之一：

```
template <typename T>
struct is_void
{
    static const bool value = false;
}

template <>
struct is_void<void>
{
    static const bool value = true;
} 
```

这本身只是[您可以做的许多事情](http://www.boost.org/doc/libs/1_41_0/libs/type_traits/doc/html/index.html)的一个例子。模板本身是图灵完备的。

这忽略了非常基本的东西，例如范围，类型安全，并且宏更混乱。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-12-14T18:20:11.177

**没有**。一个简单的反例：模板遵守命名空间，宏忽略命名空间（因为它们是预处理器语句）。

```
namespace foo {
    template <class NumberType>
    NumberType add(NumberType a, NumberType b)
    {
        return a+b;
    }

    #define ADD(x, y) ((x)+(y))
} // namespace foo

namespace logspace 
{
    // no problemo
    template <class NumberType>
    NumberType add(NumberType a, NumberType b)
    {
        return log(a)+log(b);
    }

    // redefintion: warning/error/bugs!
    #define ADD(x, y) (log(x)+log(y))

} // namespace logspace 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-07T20:50:05.290

C++ 模板有点像 Lisp 宏（不是 C 宏），因为它们对已经解析的代码版本进行操作，并且它们允许您在编译时生成任意代码。不幸的是，您正在使用类似于原始 Lambda 演算的东西进行编程，因此循环等高级技术有点麻烦。有关所有血腥细节，请参阅Krysztof Czarnecki 和 Ulrich Eisenecker 的*Generative Programming*。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-07T20:53:47.577

如果您正在寻找对该主题的更深入处理，我可以将您变成每个人[最喜欢的 C++ 仇恨](http://yosefk.com/c++fqa/templates.html#fqa-35.1)者。这个人知道和讨厌的 C++ 比我想象的要多。这同时使 FQA 非常具有煽动性和极好的资源。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-12-14T18:21:47.870

*   模板是类型安全的。
*   模板化的对象/类型可以命名空间，成为类的私有成员等。
*   模板化函数的参数不会在整个函数体中复制。

这些确实很重要，可以防止大量错误。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-12-14T18:24:03.040

不，这是不可能的。对于 T 的容器之类的一些事情，预处理器（勉强）足够了，但对于模板可以做的很多其他事情，它根本不够用。

对于一些真实的例子，请阅读Andre Alexandrescu 的*Modern C++ Programming或 Dave Abrahams 和 Aleksey Gurtovoy 的**C++ Metaprogramming*。几乎任何一本书中所做的任何事情都不能用预处理器模拟到极小的程度。

编辑：就目前`typename`而言，要求非常简单。编译器无法始终确定依赖名称是否指代类型。显式使用`typename`告诉编译器它引用了一个类型。

```
struct X { 
    int x;
};

struct Y {
    typedef long x;
};

template <class T>
class Z { 
    T::x;
};

Z<X>; // T::x == the int variable named x
Z<Y>; // T::x == a typedef for the type 'long' 
```

`typename`告诉编译器特定名称旨在引用类型，而不是变量/值，因此（例如）您可以定义该类型的其他变量。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-07T23:09:58.973

没有提到的是模板函数可以推断参数类型。

```
模板 <类型名 T>
无效函数（T t）
{
  T make_another = t;

```

有人可能会争辩说，即将推出的“typeof”运算符可以解决这个问题，但即使它也无法分解其他模板：

```
模板 <类型名 T>
无效函数（容器<T> c）

```

甚至：

```
模板 <tempate <typename> 类容器，typename T>
无效函数（容器<T> ct）

```

我也觉得专业化的主题没有得到足够的覆盖。这是宏不能做的一个简单示例：

```
模板 <类型名 T>
T min(T a, TB)
{
  返回 a < b ? 一：乙；
}

模板<>
char* min(char* a, char* b)
{
  如果 (strcmp(a, b) < 0)
    返回一个；
  别的
    返回 b;
}

```

空间太小，无法进入类型专业化，但就我而言，你可以用它做些什么，令人兴奋。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-12-14T18:23:34.713

**这个答案旨在阐明 C 预处理器以及它如何用于泛型编程**

* * *

它们在某些方面是因为它们启用了一些相似的语义。C 预处理器已用于启用通用数据结构和算法（请参阅[令牌连接](http://en.wikipedia.org/wiki/C_preprocessor)）。然而，在不考虑 C++ 模板的任何其他特性的情况下，它使整个通用编程游戏更**易于**阅读和实现。

如果有人想查看核心 C 仅通用编程的实际操作，请阅读[libevent源代码 -](http://monkey.org/~provos/libevent/)[这里](https://stackoverflow.com/questions/736307/multipurpose-linked-list-implementation-in-pure-c/961444#961444)也提到了这一点。实现了大量容器/算法，并在**单个**头文件中完成（非常易读）。我真的很佩服这一点，C++ 模板代码（我更喜欢它的其他属性）非常冗长。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-12-14T18:26:47.497

让我们尝试原始示例。考虑

```
#define min(a,b) ((a)<(b))?(a):(b) 
```

调用为

```
c = min(a++,++b); 
```

当然，真正的区别更深，但这应该足以放弃与宏的相似之处。

**编辑**：不，你不能确保宏的类型安全。您将如何`min()`为定义小于比较（即`operrator<`）的每种类型实现类型安全？

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-12-14T21:47:56.300

宏存在一些基本问题。

首先，他们不尊重范围或类型。如果我有`#define max(a, b)...`，那么每当我的`max`程序中有令牌时，无论出于何种原因，它都会被替换。如果它是变量名或嵌套范围内的深处，它将被替换。这可能会导致难以发现的编译错误。相反，模板在 C++ 类型系统中工作。模板函数可以在范围内重复使用其名称，并且不会尝试重写变量名称。

其次，宏不能变化。模板`std::swap`通常只会声明一个临时变量并进行明显的分配，因为这是通常工作的明显方式。这就是宏的限制。这对于大型向量来说效率极低，因此向量具有`swap`交换引用而不是整个内容的特殊功能。（事实证明，这在普通 C++ 程序员不应该编写但确实使用的东西中非常重要。）

第三，宏不能进行任何形式的类型推断。首先你不能写一个通用的交换宏，因为它必须声明一个类型的变量，而且它不知道类型可能是什么。模板是类型感知的。

模板强大的一个很好的例子是最初称为标准模板库，它在标准中作为容器、算法和迭代器。看看它们是如何工作的，并尝试考虑如何用宏替换它。Alexander Stepanov 研究了多种语言来实现他的 STL 想法，并得出结论认为带有模板的 C++ 是唯一可以使用的语言。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-07T21:11:05.997

Templates can do a lot more than the macro preprocessor is able to do.

E.g. there are template specializations: *If this template is instanciated with this type or constant, than do not use the default implementation, but this one here...*

... templates can enforce that some parameters are of the same type, etc...

* * *

Here are some sources You might want to look at:

*   [C++ templates](https://rads.stackoverflow.com/amzn/click/com/0201734842) by Vandervoorde and Jossutis. This is the best and most complete book about templates I know.
*   [The boost library](http://www.boost.org/) consists almost entirely of template definitions.

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-07T20:48:49.427

模板是类型安全的。使用定义，您可以拥有可以编译但仍无法正常工作的代码。

宏在编译器获取代码之前扩展。这意味着您将收到扩展代码的错误消息，并且调试器只能看到扩展版本。

使用宏，某些表达式总是有可能被计算两次。想象一下将 ++x 之类的东西作为参数传递。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-07T20:48:49.537

模板可以放在命名空间中，也可以是类的成员。宏只是一个预处理步骤。基本上，模板是该语言的一流成员，可以与其他所有内容配合得很好（更好？）。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-08T00:57:04.433

这不是一个答案，而是已经陈述的答案的结果。

与需要编程的科学家、外科医生、图形艺术家和其他人一起工作——但不是也不会成为专业的全职软件开发人员——我发现偶尔的程序员很容易理解宏，而模板似乎需要更高的只有通过更深入和持续的 C++ 编程经验才能实现抽象思维水平。它需要许多使用模板作为有用概念的代码的实例，才能使该概念足够有意义以供使用。虽然这可以说是任何语言功能，但模板的经验量与专业的临时程序员可能从他们的日常工作中获得的差距更大。

一般的天文学家或电子工程师可能很好地理解宏，甚至可能理解为什么应该避免使用宏，但对于日常使用的模板却不够好。在这种情况下，宏实际上更好。当然，也有很多例外。一些物理学家围绕专业软件工程师转圈，但这并不典型。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-12-14T18:25:14.103

提供 typename 关键字以启用上下文无关的嵌套 typdef。这些是允许将元数据添加到类型（尤其是内置类型，如指针）的特征技术所需要的，这是编写 STL 所必需的。typename 关键字在其他方面与 class 关键字相同。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-03-06T17:50:34.313

尽管模板参数经过类型检查并且模板比宏有许多优点，但模板与宏非常相似，因为它们仍然基于文本替换。编译器不会验证您的模板代码是否有意义，除非您给它类型参数以进行替换。只要您实际上没有调用它，Visual C++ 就不会抱怨这个函数：

```
template<class T>
void Garbage(int a, int b)
{
    fdsa uiofew & (a9 s) fdsahj += *! wtf;
} 
```

**编辑：**此示例仅适用于 Visual C++。在*标准*C++ 中，您的模板代码实际上在使用模板之前就被解析为语法树，因此该示例被 VC++ 接受，但不被 GCC 或 Clang 接受。*（当我尝试将 VC++ 代码移植到 GCC 并且不得不处理我的非专业模板中的数百个语法错误时，我了解到这一点。）但是，语法树在语义*上仍然不一定有意义。无论编译器如何，在您通过提供`<template arguments>`.

因此，一般来说，对于模板设计接受的给定类型参数类别，不可能知道您的模板代码是否能正常工作或编译成功。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-12-14T18:33:51.523

模板**理解数据类型。** 宏没有。

这意味着您可以执行以下操作...

*   定义可以采用任何数据类型的操作（例如，用于[包装数字](https://stackoverflow.com/questions/707370/clean-efficient-algorithm-for-wrapping-integers-in-c)的操作），然后提供根据数据类型是整数还是浮点数选择适当算法的特化
*   在编译时确定数据类型的各个方面，允许使用诸如[模板推导数组大小之](http://www.velocityreviews.com/forums/t279736-template-deduction-of-array-size.html)类的技巧，Microsoft 将其用于[strcpy_s](http://msdn.microsoft.com/en-us/library/td1esda9%28VS.80%29.aspx)及其同类的 C++ 重载

此外，由于模板是类型安全的，因此可以想象有许多模板编码技术可以使用一些假设的高级预处理器来执行，但充其量是笨拙和容易出错的（例如，[模板模板参数](http://www.informit.com/articles/article.aspx?p=376878)、默认模板参数、策略模板作为*现代 C++ 设计*中讨论）。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-12-14T18:36:16.463

模板仅在最基本的功能上类似于宏。毕竟，模板作为宏的“文明”替代品被引入语言。但即使涉及到最基本的功能，相似之处也只是肤浅的。

然而，一旦我们了解了模板的更高级特性，例如专业化（部分或显式），与宏的任何明显相似性都会完全消失。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-09-08T19:11:32.863

在我看来，宏是 C 语言的一个坏习惯。虽然它们对某些人有用，但当有 typedef 和模板时，我认为它们并没有真正的需要。模板是面向对象编程的自然延续。你可以用模板做更多的事情......

考虑这个...

```
int main()
{
    SimpleList<short> lstA;
    //...
    SimpleList<int> lstB = lstA; //would normally give an error after trying to compile
} 
```

为了进行转换，您可以在相当完整的列表示例中使用称为转换构造函数和序列构造函数（看最后）的东西：

```
#include <algorithm>

template<class T>
class SimpleList
{
public:
    typedef T value_type;
    typedef std::size_t size_type;

private:
    struct Knot
    {
        value_type val_;
        Knot * next_;
        Knot(const value_type &val)
        :val_(val), next_(0)
        {}
    };
    Knot * head_;
    size_type nelems_;

public:
    //Default constructor
    SimpleList() throw()
    :head_(0), nelems_(0)
    {}
    bool empty() const throw()
    { return size() == 0; }
    size_type size() const throw()
    { return nelems_; }

private:
    Knot * last() throw() //could be done better
    {
        if(empty()) return 0;
        Knot *p = head_;
        while (p->next_)
            p = p->next_;
        return p;
    }

public:
    void push_back(const value_type & val)
    {
        Knot *p = last();
        if(!p)
            head_ = new Knot(val);
        else
            p->next_ = new Knot(val);
        ++nelems_;
    }
    void clear() throw()
    {
        while(head_)
        {
            Knot *p = head_->next_;
            delete head_;
            head_ = p;
        }
        nelems_ = 0;
    }
    //Destructor:
    ~SimpleList() throw()
    { clear(); }
    //Iterators:
    class iterator
    {
        Knot * cur_;
    public:
        iterator(Knot *p) throw()
        :cur_(p)
        {}
        bool operator==(const iterator & iter)const throw()
        { return cur_ == iter.cur_; }
        bool operator!=(const iterator & iter)const throw()
        { return !(*this == iter); }
        iterator & operator++()
        {
            cur_ = cur_->next_;
            return *this;
        }
        iterator operator++(int)
        {
            iterator temp(*this);
            operator++();
            return temp;
        }
        value_type & operator*()throw()
        { return cur_->val_; }
        value_type operator*() const
        { return cur_->val_; }
        value_type operator->()
        { return cur_->val_; }
        const value_type operator->() const
        { return cur_->val_; }
    };
    iterator begin() throw()
    { return iterator(head_); }
    iterator begin() const throw()
    { return iterator(head_); }
    iterator end() throw()
    { return iterator(0); }
    iterator end() const throw()
    { return iterator(0); }
    //Copy constructor:
    SimpleList(const SimpleList & lst)
    :head_(0), nelems_(0)
    {
        for(iterator i = lst.begin(); i != lst.end(); ++i)
            push_back(*i);
    }
    void swap(SimpleList & lst) throw()
    {
        std::swap(head_, lst.head_);
        std::swap(nelems_, lst.nelems_);
    }
    SimpleList & operator=(const SimpleList & lst)
    {
        SimpleList(lst).swap(*this);
        return *this;
    }
    //Conversion constructor
    template<class U>
    SimpleList(const SimpleList<U> &lst)
    :head_(0), nelems_(0)
    {
        for(typename SimpleList<U>::iterator iter = lst.begin(); iter != lst.end(); ++iter)
            push_back(*iter);
    }
    template<class U>
    SimpleList & operator=(const SimpleList<U> &lst)
    {
        SimpleList(lst).swap(*this);
        return *this;
    }
    //Sequence constructor:
    template<class Iter>
    SimpleList(Iter first, Iter last)
    :head_(0), nelems_(0)
    {
        for(;first!=last; ++first)
            push_back(*first);

    }
}; 
```

看看[来自 cplusplus.com 的模板信息](http://www.cplusplus.com/doc/tutorial/templates/)！您可以使用模板来执行所谓的特征，该特征使用具有类型等的文档。您可以使用模板做更多的事情，然后使用宏！

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-07T20:46:51.023

模板提供了某种程度的类型安全。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-10-08T10:06:36.660

Templates are integrated in the language and are type-safe.

Tell me how you would do this with macros. This is heavy template metaprogramming.

[https://www.youtube.com/watch?v=0A9pYr8wevk](https://www.youtube.com/watch?v=0A9pYr8wevk)

I think that macros, AFAIK, cannot compute types the way that template partial specializations can do it.

# c# - 通过 OLE 实现 Excel 自动化 - 抑制/捕获对话框错误？

> ID：180324
> 
> 赞同：2
> 
> 时间：2008-10-07T20:44:35.910
> 
> 标签：c#, excel, ole

我通过 C# 程序和 OLE 刷新 Excel 2007 数据连接。大部分工作由单个 Workbooks.RefreshAll() 语句完成。

就像刷新电子表格的本质一样，各种事情都可能出错。在刷新过程中，程序可以给出关于“无法从文件'|'中读取数据”的对话框错误消息，以及关于“重叠的透视表报告”的消息。这两个都是致命的，我应该能够捕捉到这些错误，并以错误退出我的程序。

不幸的是，我似乎无法捕捉到这些问题，相反，我的自动化程序一直处于等待状态，直到我出现并在对话框中按 Enter 键。

有谁知道是否可以以编程方式捕获 excel 对话框中显示的错误，而不是将它们显示给用户？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T21:10:52.177

Your best bet is to set the Application.DisplayAlerts property to False. That is, assuming that your Excel.Application object variable is named "xlApp", all you'd have to do is the following:

```
xlApp.DisplayAlerts = false; 
```

Note that this will cause the default response to be taken for each dialog box, which is normally what you would want. (There's no good way around this. Leaving DisplayAlerts = True and using SendKeys might be your only other option, but would be ugly and very error prone.)

Since you are making this call via OLE Automation, this call is cross-process, and, therefore, the DisplayAlerts setting will persist until you change it. (If called in-process, via VBA, it is switches back to to true automatically when the routine completes. The same behavior probably applies for a VB.NET or C# add-in called via a CommandBar or Ribbon control, but one would need to test to be certain.)

# c++ - 线性数学方程的方程求解器

> ID：180327
> 
> 赞同：3
> 
> 时间：2008-10-07T20:45:16.160
> 
> 标签：c++, equation, algebra, solver

我需要在我的应用程序中求解一些数学方程。以下是此类等式的典型示例：

```
a + b * c - d / e = a 
```

附加规则：

*   b % 10 = 0
*   b >= 0
*   b <= 100
*   每个数字必须是整数
*   ...

我想获得 a、b、c、d 和 e 的可能解决方案集。

是否有**任何库**，无论是开源的还是商业的，**我可以用来解决这样的方程**？如果是，他们提供什么样的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T23:37:31.473

求解[线性系统](http://en.wikipedia.org/wiki/Linear_systems)*通常*可以使用线性规划来求解。我建议初学者看一下[Boost uBLAS](http://www.boost.org/doc/libs/1_36_0/libs/numeric/ublas/doc/index.htm) - 它有一个简单的三角求解器。然后，您可能会检查针对更多特定领域方法的库，也许是[QSopt](http://www2.isye.gatech.edu/~wcook/qsopt/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T20:56:14.420

你正在冒险进入数值分析的世界，这里是龙。看似微小的规范差异可能会对正确的方法产生巨大的影响。

如果没有对问题域进行相当精确的描述，我会犹豫提出具体的建议。听起来很肤浅，就像您正在解决足够简单的受限线性问题，以至于有很多方法可以解决，但是“...”可能是个问题。

一般求解器等的一个很好的资源是[GAMS](http://gams.nist.gov/)。对于您的要求，许多软件可能有点重。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T20:51:29.610

你想要一个计算机代数系统。

看[https://stackoverflow.com/questions/160911/symbolic-math-lib](https://stackoverflow.com/questions/160911/symbolic-math-lib)，其答案大多与 c++ 和 c 相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T21:07:55.053

我知道这不是你真正的问题，但你可以将给定的方程简化为：

d = b * c * e 与 e != 0

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T20:51:25.303

很确定[数字食谱](http://www.nr.com/)会有一些东西

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T20:53:12.743

你正在寻找一个计算机代数系统，这不是一件小事。

但是，其中有很多可用，请在 Wikipedia 上尝试以下列表：

[http://en.wikipedia.org/wiki/Comparison_of_computer_algebra_systems](http://en.wikipedia.org/wiki/Comparison_of_computer_algebra_systems)

-亚当

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T20:54:17.343

这看起来像线性规划。[这个](http://en.wikipedia.org/wiki/Linear_programming#Solvers_and_Scripting_.28Programming.29_Languages)清单有帮助吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T20:56:11.847

除了其他帖子。您的约束集让人想起**整数规划问题**，因此您可能也想检查这种事情。也许您的问题可以（重新）陈述为一个。

但是，您必须知道，整数规划问题往往是更难的计算问题之一，因此您最终可能会使用许多时钟周期来破解它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T15:35:43.227

只看“附加规则”部分，它看起来确实像线性规划，在这种情况下，LINDO 或实现单纯形算法的类似程序应该没问题。

但是，如果第一个方程真的很*典型*，则表明您的方程不是线性代数问题 - 线性方程中不应出现相互相乘或相除的 2 个变量！

所以我会说你肯定需要一个计算机代数系统或使用遗传算法解决问题。

由于您的限制类似于线性规划中的限制，尽管您并不完全在那里，如果您只想解决您的特定问题，我会说选择[维基百科关于遗传算法的文章](http://en.wikipedia.org/wiki/Genetic_algorithm)末尾提到的任何库和开发一个应用程序来给你结果。如果您想要更通用的方法，那么您必须在计算机上模拟代数运算，别无他法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-09T13:56:01.040

TI-89 计算器有一个“求解器”应用程序。它旨在解决您示例中的问题。我知道它不是图书馆。但是那里有几个 TI-89 仿真器。

# .net - 基于连接的可更新（和可持久）数据集 - 可以使用 ADO.Net 吗？

> ID：180328
> 
> 赞同：0
> 
> 时间：2008-10-07T20:45:25.333
> 
> 标签：.net, ado.net

因此，可以说我有一个基于以下内容的数据集：

```
SELECT     TopicLink.*, Topic.Name AS FromTopicName, Topic_1.Name AS ToTopicName
FROM         TopicLink INNER JOIN
                      Topic ON TopicLink.FromTopicId = Topic.TopicId INNER JOIN
                      Topic AS Topic_1 ON TopicLink.ToTopicId = Topic_1.TopicId 
```

使用老式 ADO，使用 Recordset，我可以修改表 TopicLink 中的列，并在记录集上调用 Save()，然后将其返回到数据库中。这个功能在 ADO.Net 中再也不可能了，大概是使用 CommandBuilder 吗？或者有解决方法吗？

（是的，我知道我可以“简单地”编写一个存储过程......但我正在寻找一种快速简便的解决方案，基本上与我们在旧 ADO 或 MS Access 中的等效功能，您可以在其中使用多个连接进行查询，将其绑定到表单上的网格，用户可以更新和保存数据，无需任何代码）

这里的关键点：我不想手动编写 INSERT、UPDATE 和 DELETE 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T20:48:46.573

我认为您可以通过为 ADO.net DataAdaptor 提供自己的更新命令来实现这一点。查看[此处](http://www.ondotnet.com/pub/a/dotnet/excerpt/progvisbasic_ch08-2/index.html?page=4)提供的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T22:35:47.930

我的理解是，只要您从要更新的每个表中选择了整个主键，就应该没问题，因为 ADO.NET 会自动知道如何处理更新的数据。但是，如果您返回的数据中没有主键，ADO.NET 将不知道它需要更新表中的哪些行，因此除非您指定自己的 UPDATE 语句（如另一个回答者建议）。

# c# - 获取C#保存对话框的文件路径

> ID：180330
> 
> 赞同：17
> 
> 时间：2008-10-07T20:45:47.080
> 
> 标签：c#, dialog

我有一个保存对话框，当我按下按钮时会弹出。但是我当时不想保存文件，我想取名称并将其放在按钮旁边的文本框中，以便稍后使用该名称。

谁能告诉我如何从保存对话框中获取文件路径以供以后使用？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-07T20:46:18.823

这是我刚刚快速编写的示例代码...而不是 Console.Write 您可以简单地将路径存储在变量中并稍后使用它。

```
SaveFileDialog saveFileDialog1 = new SaveFileDialog(); 
saveFileDialog1.InitialDirectory = Convert.ToString(Environment.SpecialFolder.MyDocuments); 
saveFileDialog1.Filter = "Your extension here (*.EXT)|*.ext|All Files (*.*)|*.*" ; 
saveFileDialog1.FilterIndex = 1; 

if(saveFileDialog1.ShowDialog() == DialogResult.OK) 
{ 
    Console.WriteLine(saveFileDialog1.FileName);//Do what you want here
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T20:51:15.787

寻址文本框...

```
if (saveFileDialog.ShowDialog() == DialogResult.OK)
{
    this.textBox1.Text = saveFileDialog.FileName;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-18T06:17:37.147

```
private void mnuFileSave_Click(object sender, EventArgs e)
{
    dlgFileSave.Filter = "RTF Files|*.rtf|"+"Text files (*.txt)|*.txt|All files (*.*)|*.*";
    dlgFileSave.FilterIndex = 1;
    if (dlgFileSave.ShowDialog() == System.Windows.Forms.DialogResult.OK && dlgFileSave.FileName.Length > 0)
    {
        foreach (string strFile in dlgFileSave.FileNames)
        {
            SingleDocument document = new SingleDocument();
            document.rtbNotice.SaveFile(strFile, RichTextBoxStreamType.RichText);
            document.MdiParent = this;
            document.Show();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-11-05T10:12:49.283

试试下面的代码。

```
saveFileDialog1.ShowDialog();
richTextBox1.SaveFile(saveFileDialog1.FileName, RichTextBoxStreamType.PlainText); 
```

# active-directory - 使用 Active Directory 用户登录到您的应用程序是否是个好主意

> ID：180343
> 
> 赞同：3
> 
> 时间：2008-10-07T20:48:40.223
> 
> 标签：active-directory, login

我正在为我的公司开发一个基于 Web 的 Intranet。我只想知道用户使用活动目录登录详细信息登录应用程序是一件好事，还是我应该与应用程序数据库一起创建登录名。如果有什么比这更好的，请提出建议。这是我的第一个应用程序开发，所以需要有经验的人的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T20:56:58.007

Only use Active directory for your intranet, if you infrastructure supports it.

You question is phrased as if you think the user to type there password in again to login to the intranet site - they should not do this! have windows pass on the credentials automatically. This is pretty much built in to dotnet/iis/etc.

Also AD will add group management a privledges so you can restrict areas of you intranet to members of certain groups.

And you support team already have the tools to manage all this.

PS you can enable FireFox to auto log on via NTLM and it is one of the most requested features for Chrome too so don't let browser issues put you off

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T21:02:07.200

There are several pros using Active Directory authentication in the intranet.

Thoses are the main ones:

*   You want to to keep authentication stores number as low as possible
*   Using Active Directory, users who have their desktop in the domain (as they should) will be able to use Integrated Windows Authentication. They will be able to log in without having to type their password.
*   An Active Directory authentication mechanism probably exists for your language

More information:

*   [http://msdn.microsoft.com/en-us/library/ms998358.aspx](http://msdn.microsoft.com/en-us/library/ms998358.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T20:53:42.087

一般来说，尽量减少人们需要拥有的帐户数量是个好主意。
所以我肯定会尝试使用他们的活动目录登录。

此外，如果需要，您可以使用各种单点登录方法自动将人们登录到您的应用程序中。（或者集成到 IIS 中，或者其他。）。
这使得应用程序非常有用，因为人们总是忘记登录详细信息，并且讨厌再次登录到其他系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T20:49:39.957

如果您创建一个单独的登录系统，那么您的用户必须记住 2 个不同的登录。当他们的“真正”登录就在眼前时，为什么还要麻烦呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T20:50:56.553

更少的代码供您编写并更好地集成到更广泛的系统中。而且，谁不想记住更少的密码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T21:04:51.517

Definitely go for the Active Directory option, or use Active Directory as an LDAP server if whatever language you're using doesn't directly support AD. Active Directory actually makes a pretty good LDAP server.

> If there is anything better that this please suggest.

OpenID?...

# ruby-on-rails - 如何动态更改 Ruby on Rails 中所有模型的 Active Record 数据库？

> ID：180349
> 
> 赞同：29
> 
> 时间：2008-10-07T20:49:14.700
> 
> 标签：ruby-on-rails, database, activerecord

在我们的程序中，每个客户都有自己的数据库。我们通过电子邮件向他们发送一个链接，将他们连接到他们的数据库。该链接包含一个 GUID，让程序知道要连接到哪个数据库。

如何以动态和编程方式将 ActiveRecord 连接到正确的数据库？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-07T20:59:47.127

您也可以轻松地做到这一点，而无需硬编码任何东西并自动运行迁移：

```
customer = CustomerModel.find(id)
spec = CustomerModel.configurations[RAILS_ENV]
new_spec = spec.clone
new_spec["database"] = customer.database_name
ActiveRecord::Base.establish_connection(new_spec)
ActiveRecord::Migrator.migrate("db/migrate_data/", nil) 
```

我发现之后在特定模型上重新建立旧连接很有用：

```
CustomerModel.establish_connection(spec) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-07T20:50:45.320

您可以随时通过调用 ActiveRecord::Base.establish_connection(...) 更改与 ActiveRecord 的连接

IE：

```
 ActiveRecord::Base.establish_connection({:adapter => "mysql", :database => new_name, :host => "olddev",
    :username => "root", :password => "password" }) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-05-27T20:03:36.503

自从创建这个问题以来已经有一段时间了，但我不得不说还有另一种方法：

```
conn_config = ActiveRecord::Base.connection_config
conn_config[:database] = new_database
ActiveRecord::Base.establish_connection conn_config 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-24T02:12:15.640

```
class Database
  def self.development!
    ActiveRecord::Base.establish_connection(:development)
  end

  def self.production!
    ActiveRecord::Base.establish_connection(ENV['PRODUCTION_DATABASE'])
  end

  def self.staging!
    ActiveRecord::Base.establish_connection(ENV['STAGING_DATABASE'])
  end
end 
```

在`.env`（`dotenv-rails`例如 gem）中：

```
PRODUCTION_DATABASE=postgres://...
STAGING_DATABASE=postgres://... 
```

现在您可以：

```
Database.development!
User.count
Database.production!
User.count
Database.staging!
User.count
# etc. 
```

# java - Delphi 与 C++ Builder - 对于使用 Win32 的 Java 程序员来说，这是更好的选择

> ID：180358
> 
> 赞同：16
> 
> 时间：2008-10-07T20:51:12.077
> 
> 标签：java, c++, delphi, winapi, c++builder

我是一个非常有经验的 Java 程序员，在过去的几年里一直在做很多 Win32 方面的工作。主要是我一直在使用 VB6，但我真的需要转向更好的东西。

我花了一个月左右的时间在玩 Delphi 2009。我喜欢 VCL GUI 的东西，Delphi 似乎比 VB6 更适合 Windows API 调用，我真的很喜欢它在 OO 方面比 VB6 更好的事实，我喜欢这个单元- IDE 附带的测试框架。

但是我真的很挣扎，因为 Delphi 没有广泛使用的垃圾收集器 - 必须手动释放每个对象或使用接口来处理所有事情似乎对您以面向对象的方式有效地做事的方式产生了相当大的影响. 此外，我并不特别热衷于语法，或者您必须在方法的顶部声明所有变量的事实。

我可以处理 Delphi，但我想知道 C++ Builder 2009 对我来说是否是一个更好的选择。我对 C++ Builder 和 C++ 知之甚少，但我对 Delphi 也知之甚少。我知道 C++ 语言有很多东西，但我怀疑只需要了解它的一个子集就可以高效地完成工作......我听说今天的 C++ 比 C++ 的编程效率更高10年前。

我只会做新的开发，所以我不需要掌握 C++ 语言的各个方面——如果我能找到 Java 的每个语言特性的等价物，我会很高兴，随着我的进步，我可以开始寻找在更高级的东西上多一点。（对不起，如果这听起来很天真——如果是这样，请让我直截了当！）

那么，对于对 Delphi 和 C++ Builder 都不熟悉的 Java 程序员，您认为哪个是 Win32 exe 和 dll 的高效开发的更好选择，为什么？您认为每种方法的优缺点是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-11T08:48:25.780

Delphi 或 C++ Builder - 这是一个艰难的选择！

如您所知，从 IDE 和 RAD 的角度来看，它们基本上非常相似。

每个人的优点和缺点 - 无论背景如何 - 有点像这样。两者都共享一个出色的 2 路 RAD 表单设计器和框架 (VCL)，非常适合原生 Windows 开发。

**德尔福：**

*   适用于：大型、活跃、热情的社区
*   FOR：Delphi 2009 是多年来最好的版本
*   FOR：Delphi“单元”使 C 源/头文件对显得过时
*   反对：当对象离开范围时不会自动销毁，因此代码中有很多“finally”
*   反对：语言可以“罗嗦”，这是一个品味问题
*   反对：在其他语言（尤其是 C）中使用第三方 DLL 或库需要编写 Delphi 头文件

**C++Builder**

*   FOR：C++Builder 2009 可能是有史以来最好的版本
*   FOR：RAII 成语极大地简化了内存管理
*   FOR：模板非常有用且功能强大，即使 C++Builder 实现存在一些错误。
*   FOR：支持 BOOST 和其他基于模板的现代库（即使 Boost 支持不是 100%）
*   FOR：与 Delphi 的良好互操作性意味着大多数 Delphi 组件都可以轻松使用。
*   FOR：易于与带有 C/C++ 头文件的第三方 DLL/库一起使用。
*   FOR：C++ 在 CV 上可能看起来比 Delphi 更好。
*   反对：CB2009 是“仅 unicode”——这对代码可移植性的影响与 Delphi 不同，而且没有经过深思熟虑
*   反对：C++Builder 用户群比 Delphi 小得多。可能是 20% 或更少。
*   反对：Borland/Inprise 几年前几乎杀死了 BCB，它只是在社区的重大努力后才复活。（然而，Codegear/Embarcadero 的承诺似乎确实令人印象深刻）
*   反对：C++Builder 不是 Codegear 中的佼佼者。
*   反对：第三方组件供应商并不总是理解/支持 C++Builder

就是这样。只是为了说明我的立场，我是一个快乐的 BCB2007/2009 用户（从 BCB5 开始），而且我也很少使用 Delphi。几年前，我考虑过从 C++ 切换到 Delphi，但缺乏 RAII 习语是我发现难以接受的一件事。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-07T21:22:58.610

使用 Delphi，您可以使用[Barry Kelly](http://barrkel.blogspot.com/)编写的[Boehm Garbage Collector API](http://cc.codegear.com/Item/21646) ，这样您就可以在 Delphi 中进行垃圾收集。Barry 在去 CodeGear 担任编译器架构师之前写了这篇文章。它确实对非常大的应用程序存在问题，并且很可能不适用于 64 位 Delphi。他在这个[播客采访](http://www.delphi.org/2008/09/episode-3-barry-kelly/)中谈到了很多。

即使您不使用那个垃圾收集内存管理器，我仍然会推荐 Delphi 而不是 C++。C++ 为一般开发提供的唯一优势是花括号语法。如果您不介意 Delphi 语法，那么对于大多数事情您会发现它更好。诚然 C++ Builder 拥有整个 Delphi VCL 和 RTL，所以它没有 Visual C++ 差，但我仍然认为 Delphi 会是一个更好的选择。

对于 Excel 插件（正如您在评论中提到的），我会推荐 Delphi 而不是 C++ builder，因为它具有更好的 COM 支持（我相信您需要 Excel 插件）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-07T21:12:15.887

Delphi 会让你更容易接受，当然你必须管理你的记忆，但它非常简单

```
MyObj = TMyObj.Create;

try
  MyObj.DoSomething;
finally
  MyObj.Free;
end 
```

在 Delphi 中，您的所有对象都分配在堆上，因此规则非常简单，如果您创建它就释放它。

C++ 及其基于堆栈和堆的 obj 意味着您有更多的学习空间和更大的陷入麻烦的空间。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-14T19:56:32.217

从 BCC 4.1/DOS 和 Delphi 3.0 到 2007 开始使用 Borland C 和 C++ 编译器之后，我可以诚实地告诉你，无论哪种方式，你都在进行一次伟大的冒险。在 Borland 的 Builder 和 RAD IDE 上从 C/C++ 迁移是从 Microsoft 的 VC++、C++ 和 .NET（从第一个 MS-DOS 版本中使用 VC——米色三环迷你活页夹）的重大范式转变（和学习曲线）。

C++ 和 Delphi 之间的选择是我建议您在用两种语言完成一些中小型项目后做出的选择。我最初是一名 C 程序员，大约五年后切换到 Delphi (V3.0)，当时 VCL 使 Windows 编程变得更容易和更有效率。

请注意，对于来自其他语言（如 COBOL、FORTRAN、VisualBasic）的程序员来说，Delphi 是一种诱人的语言，因为它的语法和代码规则强制执行一种纪律，使人们远离麻烦。C 的简洁性和原始金属力量使其成为一种出色的系统编程语言（设备驱动程序、O/S 代码、实时嵌入式编程），但在没有经验的人手中，它可能会咬你一口。

Borland 的 C++ Builder（Delphi 的 VCL 添加到 C++ 编译器）消除了 C++ 的许多尖锐边缘，是我第二喜欢的语言。由于 Borland 为这两种语言都添加了 .NET 支持，因此强烈主张使用 Builder 而不是 VC++ 进行 MS 框架编程。尽管与 C++ 相比，C# 具有大量内置的“友好性”，但如果我刚开始的话，我仍然会坚持使用 Delphi 或 Builder。

对于学习技巧、原型设计和快速概念程序，根本没有一种语言可以击败 Delphi，尤其是在 VCL 和第三方组件方面。没有炒作，只有事实。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-07T22:42:19.713

就个人而言，我认为除了语言之间的差异之外，还有其他重要的考虑因素。例如，Delphi IDE 非常适合以所见即所得的方式构建 GUI。我没有使用过 C++ builder IDE，但如果它有一个与 Delphi 一样好的 GUI 构建器，我会感到非常惊讶。

虽然表面上 C++ 的语法看起来更像 Java，但 Delphi 的对象模型实际上更接近于 Java。尽管 Delphi 中存在指针，但实际上 99% 的时间都在使用对象引用（如 Java 中的那些）。即使在现代 C++ 中，我也不认为可以避免使用指针。并不是说指针本身有什么问题，而是在实践中......

就个人而言，这些天我主要是 Java 人，但我在 Delphi 上工作了 2 年，并且很快就会回到它。相比之下，我在 C++ 方面的经验非常有限，我宁愿打扫厕所也不愿回到那种语言 :)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-07T21:04:38.430

当然java sintax更像c++而不是delphi，但是我认为对象模型更类似于delphi：

*   单继承。接口存在，但更像 COM 而不是 java 接口。
*   对象在堆上分配并通过引用访问

[你可以在这里](http://www.marcocantu.com/papers/ooplang.htm)找到比较这三种语言的论文

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-09T12:26:41.173

我想如果你使用Delphi，你会发现它在使用几次后会更容易，而且它有更多的第三方支持和C++ Builder之前在Delphi中引入的一些特性

还阅读了前 Java 的这篇博客，现在是 Delphi 中大部分数据库和 datasnap 工作的幕后推手 Steve Shaughnessy，讲述了他在使用 Java 10 年后对 Delphi 编程的经验 :-) [http://blogs.codegear.com/steveshaughnessy/ 2006/12/03/30193](http://blogs.codegear.com/steveshaughnessy/2006/12/03/30193)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-09T05:31:34.520

“例如，Delphi IDE 非常适合以所见即所得的方式构建 GUI。我没有使用过 C++ builder IDE，但如果它有一个与 Delphi 一样好的 GUI 构建器，我会感到非常惊讶。”

实际上，C++Builder GUI 编辑器是完全相同的编辑器，并且以相同的方式工作。太棒了。

.Net 有大量的类，就像 Java 一样。C# 具有与 Java 相似的语法，并且由于庞大的类库的工作方式非常相似。它是一个非常适合编程的环境。但坦率地说，Delphi 是一种更令人愉快的语言、IDE 和通用环境。C# 是由设计 Delphi 的同一个人设计的，并且在许多方面“感觉”非常相似，所以不要认为因为 Delphi 编译为本地代码（尽管您也可以使用 Delphi .Net），所以它从根本上更难使用。根本不是。

我个人的推荐是 Delphi，因为它是一种很酷的语言。但是，如果您对学习 C++ 感兴趣，C++ Builder 可能是最好的方法。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-19T22:38:04.463

在 C++ VCL 中没有什么是我无法用 Delphi VCL 做的，几乎所有 Delphi 组件在 C++ Builder 中都能正常工作。因为我同时为 Windows 和 UNIX 编程，所以 C++ 更便携。

如果您为容器使用 C++ STL 或其他设计良好的库，那么垃圾收集就会成为一个有争议的问题，否则手动 GC 并不困难（很快就会养成良好的习惯——不管是否有 GC，您都应该练习这些习惯）。只要您尽可能使用 RAII，将内存管理封装在容器中，明确对象所有权并仅将指针用作可空引用（无论语言如何，您都应该这样做），GC 真的不应该是问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T15:56:09.253

在过去的 10 年里，我在 Delphi 进行了专业编程，并且对 C++ 有很好的了解。我会去德尔福的方式。语法更简单，内存管理也更简单。我还没有听说过用于本机 Delphi 的 GC...虽然我不太喜欢由于 .NET gc 而引入的 Delphi.Net 代码中的陷阱，但我不太喜欢 gcs ;-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-13T18:31:35.523

之前忘记提的一件事：

从成本的角度来看，您实际上*不需要*选择。购买**RAD Studio**软件包，只需比一种单独的语言支付适度的额外费用，您就可以在同一个 IDE 中获得 Delphi*和C++Builder 个性。*

而且，值得一提的是，C++Builder 包包括 Delphi 编译器，您可以编写/添加 Delphi .pas 文件并将它们作为 C++ 项目的一部分。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-13T19:32:40.607

如果您要进行大量 Windows 编程，请学习 C++。你会为了去法国旅行而学习德语吗？C/C++ 是 Windows API 的本机语言。在 C/C++ 中处理 WinAPI 数据结构和调用要简单得多。至于 RAD，我已经使用 MSVC 大约 13 年了，我可以像使用 Visual Studio 的 GUI 编辑器的任何人一样快速地组装一个 GUI 应用程序。

# .net - C# WinForms UserControl 鼠标事件帮助

> ID：180363
> 
> 赞同：3
> 
> 时间：2008-10-07T20:51:50.450
> 
> 标签：.net, events, controls

我有一个为我的项目创建的自定义控件。在此控件中有几个子控件，如 Label、PictureBox 和 LinkLabel。除了 LinkLabel，我希望当前在父控件上的鼠标悬停事件并让控件响应鼠标悬停。当您将鼠标悬停在控件上时，背景颜色会发生变化，但在子控件上时背景颜色不会发生变化；这是因为子控件上没有 MouseEnter 和 MouseLeave 事件。我通过将父控件委托方法添加到子控件来解决了这个问题。问题仍然存在，当我订阅父控件上的单击事件时，子控件上的单击事件也会被忽略。我可以订阅每个单独的子控件，但是如何强制父控件的单击事件？我这个词 通过搜索发现是事件冒泡，但这似乎只适用于 ASP.NET 技术和框架。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T20:56:42.203

Your description leads me to believe that you want both your child and your parent controls to respond to a click on the child control.

If I understand your question correctly, I'd suggest subscribing to your child controls' click events and, in those event handlers, calling some common method that manipulates the state of the parent UserControl in the manner that you desire (e.g., changing the background color).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T21:22:00.280

It seems that someone else solved it for me. A friend explained that C# controls support a method called InvokeOnClick(Control, EventArgs);

I added my event delegate methods to each child control, and for the click event, I created a single method for each child control to use. This in turn calls InvokeOnClick(this, new EventArgs());

* * *

```
private void Control_Click(object sender, EventArgs e)
{
    // this is the parent control.
    InvokeOnClick(this, new EventArgs());
}

private void IFLVControl_MouseEnter(object sender, EventArgs e)
{
    this.BackColor = Color.DarkGray;
}

private void IFLVControl_MouseLeave(object sender, EventArgs e)
{
    this.BackColor = Color.White;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-09T12:11:55.210

我在处理所有子控件中的 Click 事件时遇到了类似的问题。代码是 VB.NET，但它应该很容易调整。

```
Public Shared Sub RelayEvents(ByVal usrcon As Windows.Forms.Control, ByVal del As System.EventHandler, Optional ByVal includeChildren As Boolean = True)
    For Each con As Windows.Forms.Control In usrcon.Controls
        AddHandler con.Click, del
        If includeChildren Then
            RelayEvents(con, del)
        End If
    Next
End Sub 
```

每当需要所需的级联时，可以将以下行添加到类的构造函数中。

```
CustomMethods.RelayEvents(Me, New EventHandler(AddressOf Me_Click)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T20:15:12.003

CodeProject 的 Peter Rilling 有一些简单有效的代码，可以在 winforms（和 C#）中进行事件冒泡/广播。它真的很容易使用。

[http://www.codeproject.com/KB/cs/event_broadcast.aspx](http://www.codeproject.com/KB/cs/event_broadcast.aspx)

# chm - 如何打开 .hxs 文件？

> ID：180365
> 
> 赞同：14
> 
> 时间：2008-10-07T20:52:39.310
> 
> 标签：chm

我知道 hxs 文件是编译后的帮助文件，是 .chm 文件的替代品，但我似乎无法打开它们。

我读到您使用帮助资源管理器 dexplore.exe 阅读它们：C:\Program Files\Common Files\microsoft shared\Help 9\dexplore.exe

当我尝试使用 dexplore 打开文件时，它会要求我将文件保存到磁盘，或使用其他程序打开。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T21:12:55.387

Not sure if you want to look through them programmatically or with some tool, but Help Explorer can open hxs files and extract contents. CHM files (the precursor to hxs) were a custom binary format with indexing and other data at the beginning of the file, and a zip archive in the rest.

You can also decompile hxs using HxComp.exe

EDIT: That link appears to be broken/down or something, but your answer did lead me to find [Help Explorer Viewer](http://download.cnet.com/Help-Explorer-Viewer/3000-6675_4-10666661.html), which may or may not be the same program, but it does the job.

Edit: I've deleted all broken links to spare confusion.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T21:08:54.113

After a bit more research, it looks like these files must be installed into the IDE when you install 3rd party tools. There is a diagnostic tool called Namespace#. You can see details about it here:

[http://code.msdn.microsoft.com/NamespaceSharp](http://code.msdn.microsoft.com/NamespaceSharp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-11T02:47:39.663

HXS 文件扩展名 - Microsoft 帮助编译的存储文件。它只是其中之一：HxI、HxS、HxC、HxT、HxK 女巫被称为 MS HTML Help 2。

[Help Explorer Viewer](http://download.cnet.com/Help-Explorer-Viewer/3000-6675_4-10666661.html)可以用来打开这个文件。

# asp.net - 在 UpdatePanel 中第一次部分回发后丢失 Button.Click 事件

> ID：180366
> 
> 赞同：4
> 
> 时间：2008-10-07T20:52:55.333
> 
> 标签：asp.net, asp.net-ajax, user-controls, postback

我有一个页面，它有一个 UserControl 的单个实例，它本身有一个 UpdatePanel。UpdatePanel 内部有几个 Button 控件。这些控件的 Click 事件在 UserControl 的 Init 事件的代码隐藏中连接起来。

我每次按下的第一个按钮都会收到 Click 事件，没问题。之后，我只获得一个按钮（SearchButton）的点击事件——其余的被忽略。我在下面包含了控件的代码——为简洁起见，我排除了单击事件处理程序方法，但它们都是标准的“void Button_Click(object sender, EventArgs e)”种类。有任何想法吗？

```
<asp:UpdatePanel ID="PickerUpdatePanel" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <asp:Panel ID="Container" runat="server">
            <div>
                <asp:TextBox ID="PickerResults" runat="server" style="margin-right: 3px;" SkinID="Plain" />
                <asp:Image
                    ID="LaunchPopup" runat="server" ImageUrl="~/images/icons/user_manage.png" 
                    ImageAlign="Top" BorderColor="#294254" BorderStyle="Dotted" BorderWidth="1px" 
                    Height="20px" Width="20px" style="cursor: pointer;" />
            </div>
            <asp:Panel ID="PickerPanel" runat="server" DefaultButton="OKButton" CssClass="popupDialog" style="height: 227px; width: 400px; padding: 5px; display: none;">
                <asp:Panel runat="server" id="ContactPickerSearchParams" style="margin-bottom: 3px;" DefaultButton="SearchButton">
                    Search: <asp:TextBox ID="SearchTerms" runat="server" style="margin-right: 3px;" Width="266px" SkinID="Plain" />
                    <asp:Button ID="SearchButton" runat="server" Text="Go" Width="60px" SkinID="Plain" />
                </asp:Panel>
                <asp:ListBox ID="SearchResults" runat="server" Height="150px" Width="100%" SelectionMode="Multiple" style="margin-bottom: 3px;" />
                <asp:Button ID="AddButton" runat="server" Text="Add >>" style="margin-right: 3px;" Width="60px" SkinID="Plain" />
                <asp:TextBox ID="ChosenPeople" runat="server" Width="325px" SkinID="Plain" />
                <div style="float: left;">
                    <asp:Button ID="AddNewContact" runat="server" SkinID="Plain" Width="150px" Text="New Contact" />
                </div>
                <div style="text-align: right;">
                    <asp:Button ID="OKButton" runat="server" Text="Ok" SkinID="Plain" Width="100px" />
                </div>
                <input id="SelectedContacts" runat="server" visible="false" />
            </asp:Panel>
            <ajax:PopupControlExtender ID="PickerPopEx" runat="server" PopupControlID="PickerPanel" TargetControlID="LaunchPopup" Position="Bottom" />
        </asp:Panel>
   </ContentTemplate>
   <Triggers>
        <asp:AsyncPostBackTrigger ControlID="AddButton" EventName="Click" />
        <asp:AsyncPostBackTrigger ControlID="SearchButton" EventName="Click" />
        <asp:AsyncPostBackTrigger ControlID="AddNewContact" EventName="Click" />
    </Triggers>
</asp:UpdatePanel>

public partial class ContactPicker : System.Web.UI.UserControl
{
    protected void Page_Init(object sender, EventArgs e)
    {
        SearchButton.Click += new EventHandler(SearchButton_Click);
        AddButton.Click += new EventHandler(AddButton_Click);
        OKButton.Click += new EventHandler(OKButton_Click);
    }

    // Other code left out
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T22:03:45.097

似乎将 UseSubmitBehavior="false" 添加到按钮定义中解决了我的问题。仍然不知道为什么第一次单击按钮会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T12:19:49.890

最可能的原因是 .Net 为其控件更改生成的客户端 ID。这些是动态分配的，并且可以在回发/部分回发之间更改。

如果控件被动态添加到面板，则回发之间的按钮 ID 可能不同，从而导致 .Net 无法将单击事件绑定到代码中的正确事件处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-22T18:16:09.200

就我而言，我有一个使用该属性`LinkButton`的`dgPatients_ItemDataBound`事件处理程序。`PostBackUrl`

我将 a 更改为的那一刻`LinkButton`，`HyperLink`问题就消失了。

# .net - 如何使用缩写的时区显示 DateTime？

> ID：180370
> 
> 赞同：40
> 
> 时间：2008-10-07T20:53:42.587
> 
> 标签：.net, datetime, formatting, timezone, tostring

我知道[System.TimeZone](http://msdn.microsoft.com/en-us/library/system.timezone(VS.80).aspx)类以及[DateTime.ToString()](http://msdn.microsoft.com/en-us/library/system.datetime.tostring(VS.80).aspx)方法的许多用途。我找不到的是一种将 DateTime 转换为字符串的方法，该字符串除了时间和日期信息之外，还包含三个字母的时区缩写（实际上，与 StackOverflow 的相对工具提示大致相同）时间显示工作）。

为了让每个人都能轻松理解和使用示例，让我们继续 StackOverflow 示例。如果您查看显示相对时间的工具提示，它会显示完整日期、时间（包括 12 小时格式的秒数）、AM/PM 名称，然后是三个字母的时区缩写（在他们的情况下，协调世界时）。我意识到我可以通过使用内置方法轻松获取 GMT 或 UTC，但我真正想要的是本地时间——在本例中，是在 Web 服务器上。

如果我们的 Web 服务器正在运行 Windows Server 2k3 并且它的时区设置为 CST（或者，直到[夏令时](http://en.wikipedia.org/wiki/Daylight_saving_time#Terminology)切换回来，CDT 是吗？），我希望我们的 ASP.NET Web 应用程序显示相对于该时区的 DateTimes以及格式化以在末尾显示“CST”。我意识到我可以很容易地对此进行硬编码，但出于稳健性的考虑，我真的更喜欢基于运行代码的操作系统环境设置的服务器的解决方案。

现在，除了时区缩写外，我使用以下代码拥有所有内容：

```
myDateTime.ToString("MM/dd/yyyy hh:mm:ss tt") 
```

其中显示：

2008 年 10 月 7 日下午 3:40:31

我想要的（这并不多，承诺！）就是让它说：

2008 年 10 月 7 日下午 03:40:31 CDT

我可以使用 System.TimeZone.CurrentTimeZone 并使用它来正确显示“Central Daylight Time”但是......为了简洁起见，这有点太长了。然后我是否坚持编写字符串操作例程来去除空格和任何非大写字母？虽然这可能有效，但对我来说这似乎令人难以置信......

[谷歌搜索](http://www.google.com/search?hl=en&safe=off&q=C%23+time+zone+abbreviation&btnG=Search)和查看这里并没有产生任何适用于我的具体问题的东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-27T19:32:56.317

这是我刚刚解决此问题的快速破解方法。

```
public static String TimeZoneName(DateTime dt)
{
    String sName = TimeZone.CurrentTimeZone.IsDaylightSavingTime(dt) 
        ? TimeZone.CurrentTimeZone.DaylightName 
        : TimeZone.CurrentTimeZone.StandardName;

    String sNewName = "";
    String[] sSplit = sName.Split(new char[]{' '});
    foreach (String s in sSplit)
        if (s.Length >= 1)
            sNewName += s.Substring(0, 1);

    return sNewName;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T03:42:00.280

有一个免费可用的库[TZ4NET](http://www.babiej.demon.nl/Tz4Net/main.htm)，其中提供了这些缩写。在 .NET 3.5 之前，这也是在时区之间转换的唯一选择之一。

如果您不想要一个单独的库，您当然可以使用 TimeZoneInfo 类生成合理缩写的映射，然后将它们提供给您的用户。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-12T20:16:46.680

使用[节点时间](http://nodatime.org/)。

以下函数采用`DateTime`UTC 时间并使用缩写的本地系统时区对其进行格式化。在格式字符串中使用`x`缩写的时区。[在此处](http://nodatime.org/unstable/userguide/zoneddatetime-patterns.html)查找自定义格式。

```
 public static string ConvertToFormattedLocalTimeWithTimezone(DateTime dateTimeUtc)
    {
        var tz = DateTimeZoneProviders.Tzdb.GetSystemDefault(); // Get the system's time zone
        var zdt = new ZonedDateTime(Instant.FromDateTimeUtc(dateTimeUtc), tz);
        return zdt.ToString("MM'/'dd'/'yyyy' 'hh':'mm':'ss' 'tt' 'x", CultureInfo.InvariantCulture);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T02:20:07.433

我将创建一个将时区名称转换为其缩写的查找表。如果未找到匹配项，您可以返回完整的区域名称。

请参阅[时区缩写](http://www.timeanddate.com/library/abbreviations/timezones/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-29T17:14:15.383

如果从 DaylightName/StandardName 中提取缩写，则最好使用 StringBuilder 构建字符串，因为字符串是不可变的。

```
 public static string ToCurrentTimeZoneString(this DateTime date)
    {
        string name = TimeZone.CurrentTimeZone.IsDaylightSavingTime(date) ?
            TimeZone.CurrentTimeZone.DaylightName :
            TimeZone.CurrentTimeZone.StandardName;
        return name;
    }

    public static string ToCurrentTimeZoneShortString(this DateTime date)
    {
        StringBuilder result = new StringBuilder();

        foreach (string value in date.ToCurrentTimeZoneString().Split(' '))
        {
            if (value.IsNotNullOrEmptyWithTrim())
            {
                result.Append(char.ToUpper(value[0]));
            }
        }

        return result.ToString();
    } 
```

当然，包含 KeyValuePair 的数组可能最适合跨国公司。如果您想在紧迫的最后期限中缩短几分钟，并且您在一家美国公司，这很有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T21:40:34.940

这取决于您需要的稳健性级别。

无论哪种方式，您都可能需要某种技巧。一个简单的方法是用空格分割字符串，然后连接每个单词的第一个字母。IE

```
string[] words = tzname.Split(" ".ToCharArray());
string tzabbr = "";
foreach (string word in words)
   tzabbr += word[0]; 
```

这并不适用于地球上的每个时区，但它适用于大多数时区。如果您需要它更健壮，那么您可能需要创建一个将时区名称映射到其缩写的映射。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-10-27T03:06:33.000

如果您使用的是 <= .Net 3.0，请下载 TZ4Net 并使用 OlsonTimeZone.CurrentTimeZone.StandardAbbreviation for > .Net 3.0 使用 NodaTime 或其他。时区名称不符合任何约定，您可以依靠简单的字符串操作来从首字母缩略词构造缩写。5% 的错误仍然是错误的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-10-12T14:03:22.247

好的，已经 4 年（差不多一周）了，是时候将 LINQ 带入讨论了……

把 Criag 和 Bob 的想法放在一起……

```
public static String TimeZoneName2(DateTime dt)
{
    var return ToCurrentTimeZoneShortString(dt)
                 .Split(new char[]{' '}, StringSplitOptions.RemoveEmptyEntries);
    return sSplit.Aggregate("", (st,w)=> st +=w[0]);
} 
```

除非您可以信任 TimeZone 永远不会返回包含两个连续空格的字符串：

```
public static String TimeZoneName3(DateTime dt)
{
    return ToCurrentTimeZoneShortString(dt).Split(' ')
                 .Aggregate("", (st,w)=> st +=w[0]);
} 
```

# c# - 在 Visual Studio/C# 的编译时强制使用“this”和“base”

> ID：180371
> 
> 赞同：2
> 
> 时间：2008-10-07T20:53:46.127
> 
> 标签：c#, visual-studio, compiler-construction

在扩展类时，我发现在访问基类中的方法时使用`base`（在 VB 中）关键字非常具有描述性。`MyBase`在访问扩展基类的类中的函数时使用`this`(在 VB 中) 关键字。`Me`这也适用于没有继承的“平面”结构。

我觉得读这个更容易：

```
public class World
{
    public String baseName = "World";
}

public class Hello : World
{
    public String thisName = "Hello";

    public String GetNames()
    {
        return this.thisName + " " + base.baseName;
    }
} 
```

比这个：

```
...

    public String GetNames()
    {
        return thisName + " " + baseName;
    }

... 
```

现在，我的问题是：是否可以在 Visual Studio/C# 的编译时强制使用`this`and `base`，以便如果您在代码中不使用这些关键字，编译器会抛出错误或警告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T20:55:49.337

看看 StyleCop。

[http://code.msdn.microsoft.com/sourceanalysis](http://code.msdn.microsoft.com/sourceanalysis)

那里有一些规则可以做你想做的事。您可以将其配置为将任何样式违规显示为警告或错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T22:23:21.373

您可能还想查看[SSW 的代码审核员](http://www.ssw.com.au/ssw/CodeAuditor/)

不幸的是，我不知道在编译器中强制执行此操作。

# javascript - 有什么方法可以代替 JS hack 让我从 iframe 发布到 iframe 之外的另一个页面？

> ID：180373
> 
> 赞同：1
> 
> 时间：2008-10-07T20:53:54.240
> 
> 标签：javascript, iframe, post, parent, pci-dss

有什么方法可以代替 JS hack 让我从 iframe 发布到 iframe 之外的另一个页面？

iframe 正在将数据发布到第 3 方，然后仅使用作为重定向 URl 的 URL 进行响应，因此我们无法设置表单目标。我们符合 PCI 标准，因此我们不能使用`window.parent.location = url;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T11:10:44.697

看来，它归结为：
1\. 您从 iframe 中的第 3 方获得一个文本 url。
2\. 您想将**页面的位置**更改为该 url。
3\. 除非您可以控制该第 3 方，否则您将获得的只是该文本 url。

**现在，自动更改页面位置**的唯一方法是使用`window.parent.location`(或`window.location`.)

如果使用 javascript 更改页面的 url 不符合 PCI，那么您正在尝试做一些不符合 PCI 的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T20:59:04.337

`<form>`接受一个目标参数，例如 target="_parent"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T20:59:31.107

在锚标记中，您可以设置`target='_parent'`这将导致 url 加载到父窗口中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T21:24:34.957

**不**，唯一的方法是使用 javascript。但这并不是真正的黑客使用`window.parent.location = url;`

# c# - C#抽象类，使用匿名而不是声明具体类？

> ID：180397
> 
> 赞同：2
> 
> 时间：2008-10-07T21:02:16.233
> 
> 标签：c#, .net, .net-2.0, abstract-class, anonymous-methods

我有一个抽象类，我想通过不创建继承抽象类的具体类来快速使用它。好吧，匿名定义抽象方法。

像这样的东西：

```
 Command c = new Command(myObject){
               public override void Do()
               {
               }                   
            }; 
```

在 C# .net 2.0 中有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T21:07:36.020

你可以创建一个类型来包装一个提供这样的实现的动作：

```
class ActionCommand
{
    private readonly Action _action;

    public ActionCommand(Action action)
    {
        _action = action;
    }

    public override void Do()
    {
        _action();
    }                   
}; 
```

然后可以这样使用：

```
Command c = new Command((Action)delegate()
           {
              // insert code here
           }); 
```

# java - 我可以让 JUnit 更详细吗？

> ID：180398
> 
> 赞同：24
> 
> 时间：2008-10-07T21:02:22.177
> 
> 标签：java, junit

我想让它在断言语句成功时大喊大叫，或者至少让它显示遇到的成功断言语句的数量。

我正在使用 JUnit4。

有什么建议么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-08T02:46:47.117

如果您想查看每个成功断言的一些输出，另一种不需要外部依赖项或源代码的简单方法是定义您自己的 Assert 类，它将所有方法委托给标准 JUnit Assert 类，并记录成功的断言（ JUnit 类将照常报告失败的断言）。

然后，您从“org.junit.Assert”=>“com.myco.test.Assert”对您的测试类运行全局搜索和替换，这应该修复所有常规和静态导入语句。

然后，您还可以轻松地将您的方法迁移到 quieter-is-better-camp 并更改包装类以仅报告每个测试或每个类等通过的断言的总数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-22T21:20:07.517

当我希望 JUnit 更冗长并偶然发现这个问题时，添加一些对我有帮助的信息。也许它会在未来帮助其他测试人员。

如果您正在从 Ant 运行 JUnit，并且想要查看正在运行的测试，您可以将以下内容添加到您的任务中：

```
<junit showoutput="true" printsummary="on" enabletestlistenerevents="true" fork="@{fork}" forkmode="once" haltonfailure="no" timeout="1800000"> 
```

请注意，showoutput、printsummary 和 enabletestlistenerevents 是有帮助的，而不是其他任务属性。如果你设置这些，你会得到如下输出：

```
Running com.foo.bar.MyTest
junit.framework.TestListener: tests to run: 2
junit.framework.TestListener: startTest(myTestOne)
junit.framework.TestListener: endTest(myTestOne)
junit.framework.TestListener: startTest(myTestTwo)
junit.framework.TestListener: endTest(myTestTwo)
Tests run: 2, Failures: 0, Errors: 0, Time elapsed: 0.495 sec 
```

当我的测试超时并且我不确定哪些测试实际上花费了太长时间以及哪些测试被取消时，这对我很有用，因为它们很不幸地在时间到时运行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T00:54:37.280

您可以使用 AOP（使用 Spring 或 AspectJ）在 junit.framework.Assert 类中的所有断言方法上定义切入点。[使用spring，您可以在返回建议（ http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-advice-after-returning）](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-advice-after-returning))后实现自己的类，这只会被调用如果 assert 方法通过（否则抛出异常： junit.framework.AssertionFailedError ）。在您自己的课程中，您可以实现一个简单的计数器并在最后打印它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-08T01:14:20.670

你真的对成功的断言感兴趣吗？通常，唯一有趣的断言是失败的断言。

作为一个热心的 JUnit 奉献者，我尝试让测试的输出尽可能安静，因为当某些事情没有通过时，它可以提高信噪比。最好的测试运行是一切都通过并且没有来自标准输出的窥视。

您可以一直处理您的单元测试，直到它成功并运行“grep Assert test.java | wc -l”。:-)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-07T21:34:36.857

很难做到。所有的 assert 方法都是 Assert 类的静态成员，这意味着 RunNotifier（计算成功和失败的测试）是遥不可及的。

如果您不避免丑陋的 hack：从 JUnit 获取源，在运行测试时修补它们以将当前通知器存储在 Assert 的静态字段中，以便静态方法可以向此通知器报告成功的断言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T21:28:38.473

我很确定您可以创建一个自定义的 TestRunner 来做到这一点。我们最终在我们自制的单元测试框架（NUnit 的克隆）中得到了类似的东西。

哦，等等 - 现在我再次阅读您的问题，如果您真的想要每个成功断言的输出，您将不得不深入研究管道。TestRunner 只为每个测试用例开始/结束调用一次，因此它将计算通过和失败的*测试*，而不是断言。

这对我来说不是什么大问题，因为我通常倾向于每次测试一个断言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T09:10:23.707

我不认为，JUnit 的目标是计算匹配的断言或打印出更详细的信息。如果测试是原子的，您将在那里获得大部分信息。所以我会回顾我的测试。

您还可以在 JUnit 中建立日志文件。这是可能的，但它会降低测试执行性能......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-08-14T13:54:53.490

这不是问题的直接答案，实际上是对 junit 功能的误用，但如果您需要调试断言中使用的一些值，则可以*临时*添加如下内容：

```
Assume.assumeTrue(interestingData, false); 
```

这不会使构建失败，但会将测试标记为 IGNORED，*并*强制将值包含在测试报告输出中。

> ❗️*完成后确保删除语句。或者，作为替代方案，您可以将语句更改为`Assume.assumeTrue(interestingData, true)`以防您将来可能想再次调试它。*

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-29T01:11:39.333

这个问题是很久以前提出的，但只是补充一下：

`build`每次测试后将报告生成为 html 并在文件夹下刷新浏览器不是更好吗？

使用 Gradle（因为它提供了对 Junit 开箱即用的支持以及用于集成的插件），我可以`build/reports/tests/test/index.html`在我的项目中打开文件并检查每个包、每个类和每个方法的结果。

[![Exemplo Relatório Testes](https://i.stack.imgur.com/hFvsG.png)](https://i.stack.imgur.com/hFvsG.png)

PS：如果页面变得烦人，您可以在浏览器中安装扩展以刷新页面。

如果限制适用，希望这对某人有所帮助。

[在这里](https://stackoverflow.com/questions/2385553/how-can-i-generate-an-html-report-for-junit-results)、[这里](https://junit.org/junit5/docs/current/user-guide/#running-tests)和[这里](https://www.tutorialspoint.com/testng/testng_junitreports.htm)，您可以找到更多关于如何为 Junit 测试结果生成报告的信息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T21:23:21.450

不幸的是，junit 的 javadoc 说只记录了失败的断言（[http://junit.sourceforge.net/javadoc_40/index.html](http://junit.sourceforge.net/javadoc_40/index.html)）

所以似乎不可能

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-07T22:19:44.097

可以考虑吗？

1) 下载 junit 源
2) 修改类 org.junit.Assert 以进行您正在寻找的任何修改

# c++ - 在指针声明中放置星号

> ID：180401
> 
> 赞同：111
> 
> 时间：2008-10-07T21:02:43.300
> 
> 标签：c++, c, pointers, declaration

我最近决定我只需要最终学习 C/C++，关于指针，或者更准确地说，它们的定义，我并不真正了解一件事。

这些例子怎么样：

1.  `int* test;`
2.  `int *test;`
3.  `int * test;`
4.  `int* test,test2;`
5.  `int *test,test2;`
6.  `int * test,test2;`

现在，据我了解，前三种情况都在做同样的事情：Test 不是一个 int，而是一个指向 int 的指针。

第二组示例有点棘手。在案例 4 中，test 和 test2 都是指向 int 的指针，而在案例 5 中，只有 test 是指针，而 test2 是“真正的”int。案例6呢？和案例5一样吗？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-10-07T21:04:33.343

4、5、6是同一个东西，只是*test*是一个指针。如果你想要两个指针，你应该使用：

```
int *test, *test2; 
```

或者，甚至更好（让一切都清楚）：

```
int* test;
int* test2; 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-07T21:05:52.827

星号周围的空白没有意义。这三个意思是一样的：

```
int* test;
int *test;
int * test; 
```

" `int *var1, var2`" 是一种邪恶的语法，只是为了迷惑人们，应该避免。它扩展为：

```
int *var1;
int var2; 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-10-07T21:13:22.983

许多编码指南建议您**每行只声明一个变量**。这避免了您在问这个问题之前所遇到的任何混淆。与我共事过的大多数 C++ 程序员似乎都坚持这一点。

* * *

我知道有点旁白，但我发现有用的是向后阅读声明。

```
int* test;   // test is a pointer to an int 
```

这开始工作得很好，特别是当您开始声明 const 指针时，很难知道它是 const 的指针，还是指针指向的东西是否是 const。

```
int* const test; // test is a const pointer to an int

int const * test; // test is a pointer to a const int ... but many people write this as  
const int * test; // test is a pointer to an int that's const 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2008-10-07T21:27:57.117

使用[“顺时针螺旋规则”](http://c-faq.com/decl/spiral.anderson.html)来帮助解析 C/C++ 声明；

> 需要遵循三个简单的步骤：
> 
> 1.  从未知元素开始，沿螺旋/顺时针方向移动；当遇到以下元素时，用相应的英文语句替换它们：
>     
>     
>     
>     `[X]`或`[]`：数组 X 大小...或数组未定义大小...
>     
>     
>     
>     `(type1, type2)`: 函数传递 type1 和 type2 返回...
>     
>     
>     
>     `*`: 指向...的指针
>     
>     
> 2.  继续以螺旋/顺时针方向执行此操作，直到所有标记都被覆盖。
> 3.  始终首先解决括号中的任何内容！

此外，声明应尽可能在单独的语句中（绝大多数情况下都是如此）。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-12-31T00:46:38.210

正如其他人提到的，4、5和6是相同的。通常，人们使用这些示例来使参数`*`属于变量而不是类型。虽然这是一个风格问题，但关于你是否应该这样思考和写它存在一些争论：

```
int* x; // "x is a pointer to int" 
```

或者这样：

```
int *x; // "*x is an int" 
```

FWIW我在第一个阵营，但其他人为第二种形式争论的原因是它（主要）解决了这个特殊问题：

```
int* x,y; // "x is a pointer to int, y is an int" 
```

这可能具有误导性；相反，你会写

```
int *x,y; // it's a little clearer what is going on here 
```

或者如果你真的想要两个指针，

```
int *x, *y; // two pointers 
```

就个人而言，我说每行保留一个变量，那么你喜欢哪种风格并不重要。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-09-15T16:27:35.927

```
#include <type_traits>

std::add_pointer<int>::type test, test2; 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2020-10-13T16:20:52.857

这个谜题分为三个部分。

第一部分是 C 和 C++ 中的空格通常不重要，除了分隔在其他情况下无法区分的相邻标记。

在预处理阶段，源文本被分解为一系列*标记*——标识符、标点符号、数字文字、字符串文字等。稍后分析该标记序列的语法和含义。分词器是“贪婪的”，并且会构建尽可能长的有效令牌。如果你写类似

```
inttest; 
```

标记器只看到两个标记 - 标识符`inttest`后跟标点符号`;`。在此阶段它不会被识别`int`为单独的关键字（在此过程中稍后会发生）。因此，要将该行读取为一个名为 的整数的声明`test`，我们必须使用空格来分隔标识符标记：

```
int test; 
```

该`*`字符不是任何标识符的一部分；它本身就是一个单独的标记（标点符号）。所以如果你写

```
int*test; 
```

编译器看到 4 个单独的标记 - `int`、`*`、`test`和`;`. 因此，空白在指针声明中并不重要，所有的

```
int *test;
int* test;
int*test;
int     *     test; 
```

以同样的方式解释。

* * *

谜题的第二部分是声明在 C 和 C++ ¹中的实际工作方式。声明分为两个主要部分 -*声明说明符*序列（存储类说明符、类型说明符、类型限定符等），然后是逗号分隔的（可能已初始化）*声明*符列表。在声明中

```
unsigned long int a[10]={0}, *p=NULL, f(void); 
```

声明说明符是`unsigned long int`，声明符是`a[10]={0}`,`*p=NULL`和`f(void)`. 声明器引入了被声明事物的名称（`a`、`p`和`f`）以及有关该事物的数组、指针和函数的信息。声明器也可以有一个关联的初始化器。

的类型`a`是“10 元素数组`unsigned long int`”。该类型完全由声明说明符和声明符的*组合*`={0}`指定，初始值由初始化器指定。类似地， 的类型`p`是“指针`unsigned long int`”，并且该类型再次由声明说明符和声明符的组合指定，并被初始化为`NULL`。同样的道理，类型`f`是“函数返回`unsigned long int`”。

这是关键 - 没有“指针”*类型说明符*，就像没有“数组”类型说明符一样，就像没有“函数返回”类型说明符一样。我们不能将数组声明为

```
int[10] a; 
```

因为运算符的操作数`[]`是`a`，不是`int`。同样，在声明中

```
int* p; 
```

的操作数`*`是`p`，不是`int`。但是因为间接操作符是一元的并且空格不重要，如果我们这样写，编译器不会抱怨。但是，它*总是*被解释为`int (*p);`。

因此，如果你写

```
int* p, q; 
```

`*`is的操作数`p`，所以它会被解释为

```
int (*p), q; 
```

因此，所有

```
int *test1, test2;
int* test1, test2;
int * test1, test2; 
```

做同样的事情 - 在所有三种情况下，`test1`is 的操作数`*`因此具有类型“指针`int`”，而`test2`具有类型`int`。

声明符可以变得任意复杂。您可以拥有指针数组：

```
T *a[N]; 
```

你可以有指向数组的指针：

```
T (*a)[N]; 
```

你可以让函数返回指针：

```
T *f(void); 
```

你可以有指向函数的指针：

```
T (*f)(void); 
```

您可以拥有指向函数的指针数组：

```
T (*a[N])(void); 
```

您可以让函数返回指向数组的指针：

```
T (*f(void))[N]; 
```

您可以让函数返回指向指针数组的指针，这些指针指向返回指针的函数`T`：

```
T *(*(*f(void))[N])(void); // yes, it's eye-stabby.  Welcome to C and C++. 
```

然后你有`signal`：

```
void (*signal(int, void (*)(int)))(int); 
```

读作

```
 signal                             -- signal
       signal(                 )          -- is a function taking
       signal(                 )          --   unnamed parameter
       signal(int              )          --   is an int
       signal(int,             )          --   unnamed parameter
       signal(int,      (*)    )          --   is a pointer to
       signal(int,      (*)(  ))          --     a function taking
       signal(int,      (*)(  ))          --       unnamed parameter
       signal(int,      (*)(int))         --       is an int
       signal(int, void (*)(int))         --     returning void
     (*signal(int, void (*)(int)))        -- returning a pointer to
     (*signal(int, void (*)(int)))(   )   --   a function taking
     (*signal(int, void (*)(int)))(   )   --     unnamed parameter
     (*signal(int, void (*)(int)))(int)   --     is an int
void (*signal(int, void (*)(int)))(int);  --   returning void 
```

这只是触及了可能的表面。但请注意，数组、指针和函数始终是声明符的一部分，而不是类型说明符。

需要注意的一件事 -`const`可以同时修改指针类型和指向类型：

```
const int *p;  
int const *p; 
```

以上两者都声明`p`为指向`const int`对象的指针。您可以编写一个新值以`p`将其设置为指向不同的对象：

```
const int x = 1;
const int y = 2;

const int *p = &x;
p = &y; 
```

但您不能写入指向的对象：

```
*p = 3; // constraint violation, the pointed-to object is const 
```

然而，

```
int * const p; 
```

声明`p`为`const`指向非 const的指针`int`；你可以写东西`p`指向

```
int x = 1;
int y = 2;
int * const p = &x;

*p = 3; 
```

但您不能设置`p`为指向不同的对象：

```
p = &y; // constraint violation, p is const 
```

* * *

这给我们带来了第三个难题——为什么声明是这样构造的。

目的是声明的结构应该密切反映代码中表达式的结构（“声明模仿使用”）。例如，假设我们有一个指向`int`named的指针数组`ap`，并且我们想要访问'th 元素`int`所指向的值。`i`我们将按如下方式访问该值：

```
printf( "%d", *ap[i] ); 
```

*表达式* 的`*ap[i]`类型为`int`; 因此， 的声明`ap`写成

```
int *ap[N]; // ap is an array of pointer to int, fully specified by the combination
            // of the type specifier and declarator 
```

声明`*ap[N]`器与表达式具有相同的结构`*ap[i]`。运算符`*`和`[]`在声明中的行为与它们在表达式中的行为相同 -`[]`具有比 unary 更高的优先级`*`，因此 is 的操作数`*`（`ap[N]`它被解析为`*(ap[N])`）。

再举一个例子，假设我们有一个指向`int`named数组的指针，`pa`并且我们想要访问第`i`' 个元素的值。我们会把它写成

```
printf( "%d", (*pa)[i] ); 
```

表达式的类型`(*pa)[i]`是`int`，所以声明写成

```
int (*pa)[N]; 
```

同样，适用相同的优先级和关联性规则。在这种情况下，我们不想取消引用`i`' 的第 ' 个元素`pa`，我们想访问*指向*`i`' 的第 ' 元素，所以我们必须显式地将运算符与 组合在一起。`pa` *`*``pa`*

 *,和运算符都是代码中*表达式*`*`的一部分，因此它们都是*声明*中的声明符的一部分。声明器告诉您如何在表达式中使用对象。如果您有一个类似 的声明，它会告诉您代码中的表达式将产生一个值。通过扩展，它告诉您表达式产生一个类型为“指向”的值，或者。`[]``()`**`int *p;``*p``int``p``int``int *`**

 *** * *

那么，诸如演员表和`sizeof`表达式之类的东西呢，我们在哪里使用`(int *)`或`sizeof (int [10])`或之类的东西呢？我如何阅读类似的内容

```
void foo( int *, int (*)[10] ); 
```

没有声明符，`*`和`[]`运算符不是直接修改类型吗？

好吧，不 - 仍然有一个声明符，只是带有一个空标识符（称为*抽象声明*符）。如果我们用符号 λ 表示一个空标识符，那么我们可以将这些内容读作`(int *λ)`、`sizeof (int λ[10])`和

```
void foo( int *λ, int (*λ)[10] );
```

它们的行为与任何其他声明完全一样。 `int *[10]`表示一个包含 10 个指针的数组，而`int (*)[10]`表示一个指向数组的指针。

* * *

现在是这个答案的固执部分。我不喜欢将简单指针声明为的 C++ 约定

```
T* p; 
```

并认为这是*不好*的做法，原因如下：

1.  它与语法不一致；
2.  它引入了混淆（正如这个问题所证明的那样，这个问题的所有重复项，关于 的含义的问题，*这些*`T* p, q;`问题的所有重复项等）；
**   它不是内部一致的——声明一个指针数组`T* a[N]`是不对称的（除非你有写作的习惯`* a[i]`）；*   它不能应用于指向数组的指针或指向函数的指针类型（除非您创建一个 typedef 以便您可以`T* p`干净地应用约定，这...*否*）；*   这样做的原因 - “它强调对象的指针性” - 是虚假的。它不能应用于数组或函数类型，我认为这些品质同样重要。*

 *最后，它只是表明对两种语言的类型系统如何工作的困惑思考。

有充分的理由单独申报物品；解决不好的做法 ( `T* p, q;`) 不是其中之一。如果您*正确*编写声明符( `T *p, q;`)，则不太可能引起混淆。

我认为这类似于故意将所有简单`for`循环编写为

```
i = 0;
for( ; i < N; ) 
{ 
  ... 
  i++; 
} 
```

语法上有效，但令人困惑，意图很可能被误解。但是，该`T* p;`约定在 C++ 社区中根深蒂固，我在自己的 C++ 代码中使用它，因为代码库之间的一致性是一件好事，但每次这样做都让我很痒。

* * *

 ^(1.  我将使用 C 术语 - C++ 术语略有不同，但概念大致相同。) 

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-07T21:05:21.143

在 4、5 和 6 中，`test`始终是指针而`test2`不是指针。空格在 C++ 中（几乎）从不重要。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-01T20:29:30.760

C 中的基本原理是您以使用它们的方式声明变量。例如

```
char *a[100]; 
```

说那 `*a[42]`将是一个`char`。和`a[42]`一个字符指针。因此`a`是一个 char 指针数组。

这是因为最初的编译器编写者希望对表达式和声明使用相同的解析器。（语言设计选择不是一个非常明智的理由）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-09-28T08:48:53.387

我会说最初的约定是将星号放在指针名称一侧（声明的右侧

*   在Dennis M. Ritchie*的 c 编程语言*中，星星位于声明的右侧。

*   通过查看[https://github.com/torvalds/linux/blob/master/init/main.c](https://github.com/torvalds/linux/blob/master/init/main.c)上的 linux 源代码， 我们可以看到星号也在右侧。

您可以遵循相同的规则，但如果您将星号放在字体一侧，这没什么大不了的。请记住，**一致性**很重要，所以无论您选择哪一边，始终要让明星站在同一边。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-05-02T18:19:33.233

在我看来，答案是两者皆有，视情况而定。通常，IMO，最好将星号放在指针名称旁边，而不是类型旁边。比较例如：

```
int *pointer1, *pointer2; // Fully consistent, two pointers
int* pointer1, pointer2;  // Inconsistent -- because only the first one is a pointer, the second one is an int variable
// The second case is unexpected, and thus prone to errors 
```

为什么第二种情况不一致？因为 eg`int x,y;`声明了两个相同类型的变量，但该类型在声明中只提及一次。这创造了一个先例和预期的行为。并且`int* pointer1, pointer2;`与此不一致，因为它声明`pointer1`为指针，但`pointer2`它是一个整数变量。显然容易出错，因此应该避免（通过将星号放在指针名称旁边，而不是类型旁边）。

**但是**，在某些**例外情况**下，您可能无法将星号放在对象名称旁边（以及放在哪里很重要）而不会得到不希望的结果 - 例如：

`MyClass *volatile MyObjName`

`void test (const char *const p) // const value pointed to by a const pointer`

*最后，在某些情况下，将星号放在类型*名称旁边可能*更清楚*，例如：

 *`void* ClassName::getItemPtr () {return &item;} // Clear at first sight`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-07T21:07:50.310

指针是类型的修饰符。最好从右到左阅读它们，以便更好地理解星号如何修改类型。'int *' 可以读作“指向 int 的指针”。在多个声明中，您必须指定每个变量都是指针，否则它将被创建为标准变量。

1,2 和 3) 测试属于 (int *) 类型。空格无关紧要。

4,5 和 6) 测试属于 (int *) 类型。Test2 是 int 类型。同样，空格是无关紧要的。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-10-07T21:50:10.223

一个好的经验法则是，很多人似乎通过以下方式来掌握这些概念： 在 C++ 中，许多语义含义是通过关键字或标识符的左绑定派生的。

举个例子：

```
int const bla; 
```

const 适用于“int”字。指针的星号也是如此，它们适用于它们左侧的关键字。和实际的变量名？是的，这是由它的剩余部分声明的。

# c# - 如何将动态“where”子句添加到 linq 查询？

> ID：180405
> 
> 赞同：25
> 
> 时间：2008-10-07T21:03:50.490
> 
> 标签：c#, linq, dynamic

我有一个包含用户角色的位掩码的用户表。下面的 linq 查询返回角色包括 1、4 或 16 的所有用户。

```
var users = from u in dc.Users
            where ((u.UserRolesBitmask & 1) == 1)
               || ((u.UserRolesBitmask & 4) == 4)
               || ((u.UserRolesBitmask & 16) == 16)
            select u; 
```

我想将其重写为以下方法以返回给定角色的所有用户，以便我可以重用它：

```
private List<User> GetUsersFromRoles(uint[] UserRoles) {} 
```

关于如何动态构建我的查询的任何指示？谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-07T21:18:04.440

您可以使用[PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)类。

PredicateBuilder 已在[LINQKit NuGet 包中发布](https://www.nuget.org/packages/LinqKit/)

> LINQKit 是一套免费的 LINQ to SQL 和实体框架高级用户扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T21:11:04.797

假设您的 UserRoles 值本身就是位掩码，这样的事情会起作用吗？

```
private List<User> GetUsersFromRoles(uint[] UserRoles) {
    uint roleMask = 0;
    for (var i = 0; i < UserRoles.Length;i++) roleMask= roleMask| UserRoles[i];
    // roleMasknow contains the OR'ed bitfields of the roles we're looking for

    return (from u in dc.Users where (u.UserRolesBitmask & roleMask) > 0) select u);
} 
```

可能有一个很好的 LINQ 语法可以代替循环，但概念应该是相同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T21:14:54.290

有几种方法可以做到这一点：

LINQ 动态查询库： [http ://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

表达式树和 Lamda 表达式：http: [//msdn.microsoft.com/en-us/library/bb882637.aspx](http://msdn.microsoft.com/en-us/library/bb882637.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-07T21:21:22.250

这是将可变数量的*where*子句添加到 LINQ 查询的一种方法。请注意，我没有触及您的位掩码逻辑，我只关注多个*where* s。

```
// C#
private List<User> GetUsersFromRoles(uint[] UserRoles)
{
   var users = dc.Users;

   foreach (uint role in UserRoles)
   {
      users = users.Where(u => (u.UserRolesBitmask & role) == role);
   }

   return users.ToList();
} 
```

* * *

编辑：实际上，这将与**where***子句*和您想要对它们进行**OR**。以下方法（内部联接）适用于 LINQ to Objects，但不能使用 LINQ to SQL 转换为 SQL：

```
var result = from user in Users
             from role in UserRoles
             where (user.UserRolesBitmask & role) == role
             select user; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T21:14:33.790

这个怎么样？它不是动态 linq，而是实现了目标。

```
private List<User> GetUsersFromRoles(uint[] userRoles) 
{
    List<User> users = new List<User>();

    foreach(uint userRole in UserRoles)
    {
        List<User> usersInRole = GetUsersFromRole(userRole);
        foreach(User user in usersInRole )
        {
            users.Add(user);
        }
    }
    return users;
}    

private List<User> GetUsersFromRole(uint userRole) 
{
    var users = from u in dc.Users
            where ((u.UserRolesBitmask & UserRole) == UserRole)
            select u;

    return users;    
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T21:15:11.480

```
private List<User> GetUsersFromRoles(uint UserRoles) {
  return from u in dc.Users            
         where (u.UserRolesBitmask & UserRoles) != 0
         select u;
} 
```

但是，应提供 UserRoles 参数作为位掩码，而不是数组。

# registry - WorkArounds2=8192 设置对 ODBC 连接有什么作用？

> ID：180412
> 
> 赞同：1
> 
> 时间：2008-10-07T21:04:40.613
> 
> 标签：registry, odbc, openedge, progress-db

[我的公司有一个在Progress](http://www.progress.com/)数据库上运行的第三方应用程序。我一直在使用 ODBC 连接在他们的数据库之上构建一个应用程序。

Progress 的“怪癖”之一是它不支持 SQL 列宽，因此它允许在定义为 varchar(50) 的列中包含 100 个字符。通过 ODBC 读取此数据时，出现以下错误：

> 表 PUB.test_table 中的列 test_column 的值超过了其最大长度或精度。

构建应用程序的公司的支持技术人员指出我要在注册表中为 ODBC 连接添加一些解决标志的工作，但是，我找不到任何关于这些标志将做什么或可能的值是什么的文档。注册表项是

> KEY_CURRENT_USER->软件->ODBC->ODBC.INI->MyODBCConnectionName->WorkArounds KEY_CURRENT_USER->软件->ODBC->ODBC.INI->MyODBCConnectionName->WorkArounds2

谷歌发现了人们通过添加这些带有特定值的标志（包括我个人最喜欢的[The Daily WTF](http://thedailywtf.com/Articles/Oh,_the_Workarounds.aspx)中的个人最爱）解决的其他问题，但我找不到任何地方告诉我这些标志的实际作用。你知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-05T01:58:27.957

@tom-bascom 的链接不再有效，因为 Progress 移动了他们的知识库。@stefan-moser 对@mdb 问题的评论是恰当的。

根据ODBC 参考的[DataDirect Connect 系列的](http://www.datadirect.com/download/docs/odbc/allodbc/help.htm)[第 11 章解决方法选项](http://media.datadirect.com/download/docs/odbc/allodbc/reference/workarounds.html)

解决方法 2=8192。启用此选项会导致 Microsoft Access 不传递错误 -7748。Microsoft Access 仅要求以两字节 SQL_C_WCHAR 形式提供数据，这不足以存储 UCS2 字符和空终止符的缓冲区大小；因此，驱动程序会返回一个警告“01004 数据被截断”，并向 Microsoft Access 返回一个空字符。Microsoft Access 然后传递错误 -7748。

参考：

*   [ODBC 产品文档](http://www.datadirect.com/techres/odbc.html)
*   [用于 ODBC 参考的 DataDirect Connect 系列](http://www.datadirect.com/download/docs/odbc/allodbc/help.htm)
*   [http://media.datadirect.com/download/docs/odbc/allodbc/reference/workarounds.html](http://media.datadirect.com/download/docs/odbc/allodbc/reference/workarounds.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:12:21.887

这是一个修复：

“当使用 Connect for ODBC 驱动程序链接到具有一个或多个关联索引的表时，Microsoft Access 2000 会发生此错误。”

[DataDirect 支持知识库](http://knowledgebase.datadirect.com/display/4n/kb/article.aspx?aid=2945&n=1&tab=search&bt=4n&s=1)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-07T21:19:39.570

[DataDirect Connect for ODBC](http://media.datadirect.com/download/docs/odbc/readme/unixread.htm)（基于 Unix 的 ODBC 驱动程序）的README 文件包含文档的“驱动程序解决方法选项”部分中的解决方法列表。

# unit-testing - 模拟课还是真课？

> ID：180413
> 
> 赞同：12
> 
> 时间：2008-10-07T21:04:49.753
> 
> 标签：unit-testing, mocking

使用其他类（作为成员或作为方法的参数）的类需要行为正确的实例以进行单元测试。如果您有这些类可用并且它们没有引入额外的依赖项，那么使用真实的东西而不是模拟不是更好吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-07T21:38:39.873

我说尽可能使用真正的课程。

我坚信尽可能地扩展“单元”测试的边界。在这一点上，它们并不是传统意义上的真正单元测试，而只是针对您的应用程序的自动回归套件。我仍然练习 TDD 并先编写所有测试，但我的测试比大多数人的要大一些，而且我的绿-红-绿循环需要更长的时间。但是现在我已经这样做了一段时间，我完全相信传统意义上的单元测试并不是他们所吹嘘的那样。

根据我的经验，编写一堆微小的单元测试最终会成为未来重构的障碍。如果我有一个使用 B 的类 A 并且我通过模拟 B 对其进行单元测试，那么当我决定将某些功能从 A 移动到 B 或反之亦然时，我的所有测试和模拟都必须更改。现在，如果我有测试来验证系统的端到端流程是否按预期工作，那么我的测试实际上可以帮助我确定我的重构可能导致系统外部行为发生变化的地方。

最重要的是，mock 编码了特定类的契约，并且通常最终实际上也指定了一些实现细节。如果您在整个测试套件中广泛使用模拟，您的代码库最终会产生很多额外的惯性，这将抵制任何未来的重构工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T21:09:37.310

只要您对对象有绝对的控制权，就可以使用“真实的东西”。例如，如果您有一个只有属性和访问器的对象，您可能没问题。如果您要使用的对象中有逻辑，您可能会遇到问题。

如果针对 a 类的单元测试使用了 b 类的一个实例，并且引入到 b 的更改破坏了 b，那么针对 a 类的测试也将被破坏。这是您可能遇到问题的地方，就像使用模拟对象一样，您总是可以返回正确的值。使用“真实的东西”可以使测试复杂化并隐藏真正的问题。

模拟也可能有缺点，我认为在一些模拟和一些你必须自己寻找的真实对象之间存在平衡。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T09:07:09.407

您想使用存根/模拟而不是真正的类有**一个非常好的理由。**即使您的单元测试的（纯单元测试）类在测试中与其他所有内容**隔离**。这个属性非常有用，并且保持测试隔离的好处很多：

*   测试运行得更快，因为它们不需要调用真正的类实现。如果实现是针对文件系统或关系数据库运行，那么测试将变得缓慢。缓慢的测试使开发人员不经常运行单元测试。如果你在做测试驱动开发，那么耗时的测试就是对开发人员时间的毁灭性浪费。
*   如果测试与被测类隔离，则更容易追踪问题。与系统测试相比，追踪在堆栈跟踪中不明显可见或其他不可见的令人讨厌的错误将更加困难。
*   对外部类/接口所做的更改的测试不那么脆弱，因为您纯粹是在测试正在测试的类。低脆弱性也是低耦合的标志，这是一个很好的软件工程。
*   您正在测试一个类的外部行为，而不是内部实现，这在决定代码设计时更有用。

现在，如果您想在测试中使用真正的类，那很好，但它**不是**单元测试。相反，您正在进行集成测试，这对于**验证需求和整体完整性检查**很有用。集成测试不像单元测试那样经常运行，实际上它主要在提交到最喜欢的代码存储库之前完成，但同样重要。

您唯一需要记住的是以下几点：

*   **模拟和存根**用于单元测试。

*   **真正的类**用于集成/系统测试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-08T01:08:18.030

如果依赖项访问外部系统（如数据库或 Web 服务），我总是使用依赖项的模拟版本。

如果不是这种情况，则取决于两个对象的复杂性。用真正的依赖关系测试被测对象本质上是使两组复杂性相乘。模拟出依赖关系让我可以隔离被测对象。如果任何一个对象都相当简单，那么组合的复杂性仍然是可行的，我不需要模拟版本。

正如其他人所说，在依赖项上定义一个接口并将其注入到被测对象中可以更容易地模拟出来。

就个人而言，我不确定是否值得使用严格的模拟并验证对依赖项的每次调用。我经常这样做，但这主要是习惯。

您可能还会发现这些相关问题很有帮助：

*   [什么是对象模拟，我什么时候需要它？](https://stackoverflow.com/questions/4314/what-is-object-mocking-and-when-do-i-need-it)
*   [我什么时候应该嘲笑？](https://stackoverflow.com/questions/38181/when-should-i-mock)
*   [模拟是如何使用的？](https://stackoverflow.com/questions/59195/how-are-mocks-meant-to-be-used)
*   甚至，[仅仅是我，还是接口被过度使用了？](https://stackoverflow.com/questions/90851/is-it-just-me-or-are-interfaces-overused)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-08T09:37:23.200

从我的答案中提取和扩展我如何对继承对象进行单元测试？">这里：

您应该尽可能使用真实的对象。

如果真实对象做了您不想设置的事情（例如使用套接字、串行端口、获取用户输入、检索大容量数据等），您应该只使用模拟对象。从本质上讲，模拟对象用于当使用真实对象实现和维护测试的估计工作量大于使用模拟对象实现和维护测试的估计量时。

我不赞成“依赖测试失败”的论点。如果测试因依赖类损坏而失败，则测试完全按照它应该做的那样做。这不是气味！如果依赖的接口发生变化，我想知道！

高度模拟的测试环境需要非常高的维护，尤其是在项目早期接口不断变化的时候。我总是发现尽快开始集成测试更好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-07T21:19:31.003

仅当它首先经过单元测试时才使用真实的东西。如果它引入了阻止这种情况的依赖项（循环依赖项，或者如果它需要首先采取某些其他措施），则使用“模拟”类（通常称为“存根”对象）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-08T08:50:57.613

自从我被他们咬过很多次以来，我一直对嘲笑的对象非常警惕。当您想要独立的单元测试时，它们很棒，但是它们有几个问题。主要问题是，如果 Order 类需要 OrderItem 对象的集合并且您模拟它们，则几乎不可能验证模拟的 OrderItem 类的行为是否与现实世界的示例相匹配（复制具有适当签名的方法通常不是足够）。我不止一次看到系统失败，因为模拟类与真实类不匹配，并且没有足够的集成测试来捕捉边缘情况。

我通常使用动态语言进行编程，并且我更喜欢仅仅覆盖有问题的特定方法。不幸的是，这有时在静态语言中很难做到。这种方法的缺点是您使用的是集成测试而不是单元测试，并且有时更难以追踪错误。好处是您使用的是实际编写的代码，而不是该代码的模拟版本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-07T21:35:58.193

如果您的“真实事物”只是 JavaBeans 之类的值对象，那很好。

对于任何更复杂的事情，我会担心，因为从模拟框架生成的模拟可以被给予关于如何使用它们的精确期望，例如调用的方法的数量、精确的序列和每次预期的参数。您的真实对象无法为您执行此操作，因此您可能会在测试中失去深度。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-07T22:12:06.937

如果您不关心验证您的 UnitUnderTest 应该如何与 Thing 交互的期望，并且与 RealThing 的交互没有其他副作用（或者您可以模拟这些），那么我认为让您的UnitUnderTest 使用 RealThing。

然后测试涵盖更多的代码库是一个奖励。

我通常发现很容易判断何时应该使用 ThingMock 而不是 RealThing：

*   当我想验证与事物交互的期望时。
*   使用 RealThing 时会带来不必要的副作用。
*   或者当 RealThing 太难/太麻烦而无法在测试环境中使用时。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T21:40:51.647

如果您根据接口编写代码，那么单元测试就会变得很有趣，因为您可以简单地将任何类的假版本注入您正在测试的类中。

例如，如果您的数据库服务器由于某种原因而关闭，您仍然可以通过编写一个虚假的数据访问类来进行单元测试，该类包含一些存储在内存中的哈希映射或其他东西中的熟数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T23:22:44.390

这取决于你的**编码风格**、**你**在做什么、你的**经验**和其他事情。

鉴于这一切，没有什么能阻止你**同时使用**.

我知道我经常使用术语**单元测试方式。**我所做的大部分工作可能更适合称为集成测试，但更好的是**仅将其视为测试**。

所以我建议使用所有适合的测试技术。总体目标是**测试好**，花**很少的时间**去做，并且个人**觉得它是正确的**。

话虽如此，根据您的编程方式，您可能需要考虑使用技术（如接口），使模拟的侵入性更频繁。但是不要在错误的地方使用接口和注入。此外，如果模拟需要相当复杂，则可能没有理由使用它。（你可以在这里的答案中看到很多好的指导，什么时候适合。）

**换句话说：** 没有答案总是有效的。保持你的智慧，观察什么有效，什么无效以及为什么。

# asp.net - Sharepoint InputFormSection 控件外观类似

> ID：180415
> 
> 赞同：0
> 
> 时间：2008-10-07T21:05:00.767
> 
> 标签：asp.net, sharepoint, controls

我正在寻找与 Sharepoint 中的 InputFormSection 控件类似的控件，我想在不在 Sharepoint 上下文中运行的常规网页中使用该控件。以下是输入表单部分的外观：[http ://graegert.com/wp-content/uploads/2008/01/moss_adminarea_page_structure1.png](http://graegert.com/wp-content/uploads/2008/01/moss_adminarea_page_structure1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T06:24:37.643

那么我是否正确理解了您的问题？您想要一个外观和行为类似于 SharePoint 的 InputFormSection 控件的控件，但它应该能够在 SharePoint 网站的上下文之外运行？

如果是这样，您可以采取的一种方法是删除生成的 HTML 并在您自己的用户控件中使用它。IE 开发者工具栏对于检索所有其他信息有很大帮助 ( [http://www.microsoft.com/en-us/download/details.aspx?id=18359](http://www.microsoft.com/en-us/download/details.aspx?id=18359) )。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T09:27:23.250

重现控件非常容易（它是一个用户控件，您可以访问 .ascx 文件）。事实上，这正是我昨天最终做的事情。

# .net - LINQ 内连接 Enumerable 和 DB Table

> ID：180422
> 
> 赞同：1
> 
> 时间：2008-10-07T21:06:18.037
> 
> 标签：.net, linq, inner-join, enumerable, dbtable

我试图确定当用户提交表单时要从数据库中删除哪些记录。该页面有两个CheckBoxList，一个代表修改前的记录，一个代表修改后的记录。

我可以像这样轻松获取需要删除的选定值...

```
//get the items not selected that were selected before
var oldSelectedItems = from oItem in oldChklSpecialNeeds.Items.Cast<ListItem>()
                       where !(from nItem in newChklSpecialNeeds.Items.Cast<ListItem>()
                               where nItem.Selected
                               select nItem.Value).Contains(oItem.Value)
                           && oItem.Selected
                       select oItem.Value; 
```

现在我正在尝试做这样的事情，但它不允许......

```
var itemsToDelete = from specialNeed in db.SpecialNeeds
                           join oldSelectedItem in oldSelectedItems on specialNeed.SpecialNeedsTypeCd equals oldSelectedItem.Value
                           where specialNeed.CustomerId == customerId 
```

我可以轻松地为每个项目使用 foreach 循环和 .DeleteOnSubmit() 但我认为有一种方法可以使用 LINQ 的功能并将内部连接的整个查询结果传递给 .DeleteAllOnSubmit()

```
//like so
db.SpecialNeeds.DeleteAllOnSubmit(itemsToDelete); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T22:36:19.883

本地集合可以通过 Contains() 方法在 LINQ to SQL 中使用。您可以尝试使用 Contains()将*join*子句更改为*where ：*

```
var itemsToDelete = from specialNeed in db.SpecialNeeds
                    where oldSelectedItems.Contains(specialNeed.SpecialNeedsTypeCd)
                       && specialNeed.CustomerId == customerId
                    select ...; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T21:31:39.233

你得到什么错误？SpecialNeedsTypeCd 和 oldSelectedItem.Value 之间的类型不匹配吗？您是否只是在这篇文章的第二个 Linq 语句中省略了 select 或者这是问题所在？

# c# - 从子类创建通用列表

> ID：180428
> 
> 赞同：0
> 
> 时间：2008-10-07T21:07:34.960
> 
> 标签：c#, vb.net, generics, reflection

```
Option Explicit On
Option Strict On

Public Class Class1

    Dim l As List(Of A)

    Public Sub New()
        l = New List(Of B)
    End Sub

End Class

Public Class A
End Class

Public Class B
    Inherits A
End Class<p> 
```

我遇到了这个问题。
我有一个声明为通用类型“A”
的列表，我想将该列表定义为通用类型“B”，它是“A”的子类。

为什么不能做到这一点，又怎么能达到同样的效果呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T21:09:55.377

这是一个差异问题，C# 不支持泛型。请参阅[Rick Byer 关于该主题的帖子](http://blogs.msdn.com/rmbyers/archive/2005/02/16/375079.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T21:13:44.730

如果您可以将 As 列表转换为 B 列表，那么如果添加 A 会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T22:53:36.213

在 C# 4.0（如昨天宣布的那样）中，我们已经[完成了一半](http://blogs.msdn.com/charlie/archive/2008/10/28/linq-farm-covariance-and-contravariance-in-visual-studio-2010.aspx)。

# php - 产生语法错误的控制结构的混合语法

> ID：180430
> 
> 赞同：0
> 
> 时间：2008-10-07T21:07:41.433
> 
> 标签：php, syntax

我正在重构一些 PHP 代码，发现某些嵌套组合

```
if () : 
```

和

```
if () { 
```

产生语法错误。并不是说我通常会将两者混合使用，但我喜欢在编写代码时经常进行语法检查，因此我不断收到语法错误。

示例 - 生成语法错误：

```
if ( $test == 1 ) :
  if ( $test2 == 'a' ) {
    if ( $test3 == 'A' ) {
    } else {
    }
  }
else :
  echo 'test2';
endif; 
```

示例 - 不会产生语法错误：

```
if ( $test == 1 ) :
  if ( $test2 == 'a' ) :
    if ( $test3 == 'A' ) :
    else :
    endif;
  endif;
else :
  echo 'test2';
endif; 
```

有人可以向我解释为什么第一段代码会产生错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T21:25:41.227

这是一个疯狂的猜测，因为我不熟悉 PHP 的语法。但这里有：

问题是第二个`else`。解析器无法查看这`else`是属于第一个还是第二个 if（从头开始计数）。在您的第二个示例中，有一个`endif`使第二个`if`-block 被终止，因此它可以在那里进行解析。也许这就是著名的“悬空-else”问题的变相？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T21:38:30.717

我不知道确切的原因。这是一个相关的[PHP 错误帖子](http://bugs.php.net/bug.php?id=18413)，其中开发人员基本上说，“不要这样做”:)。我最近没有仔细阅读 PHP 源代码，但如果我不得不冒险猜测，那是因为在递归执行 if 语句时没有检查替代语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T00:54:04.800

如果你在最后一个花括号后加一个分号，它工作正常：

```
if ( $test == 1 ) :
  if ( $test2 == 'a' ) {
    if ( $test3 == 'A' ) {
    } else {
    }
  };
else :
  echo 'test2';
endif; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T03:38:57.183

该死的缩进，它将第一个示例解释为使用大括号的 if 与使用备用语法的 else 匹配。

一致性是这里的经验法则，无论如何解释对任何读者来说都是模棱两可的，所以要么按照其他答案中的建议放入分号，或者更好......清理代码。那太糟了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T00:30:49.277

我在这里唯一能说的是代码完全不可读。避免：像瘟疫一样。使用熟悉的 C 风格花括号语法。

代码的质量很大程度上取决于它的可读性，所以一定要努力清理它，你会为自己省去一堆令人惊讶的错误。

# open-source - 用于大型文本文件 (> 200 MBytes) 的图形化开源文本编辑器

> ID：180435
> 
> 赞同：2
> 
> 时间：2008-10-07T21:08:45.627
> 
> 标签：open-source, editor, text-editor, large-files

是否有开源替代方案（类似于ultraedit）来处理文件大小> 200 MBytes的文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T21:11:01.193

[vim 或 gvim](http://www.vim.org/)（图形 vim）应该很乐意处理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-07T21:48:18.653

[*支持超过*](https://stackoverflow.com/questions/102829/best-free-text-editor-supporting-more-than-4g-files "Best Free Text Editor Supporting *More Than* 4G Files?")[4G 文件的](https://stackoverflow.com/questions/102829/best-free-text-editor-supporting-more-than-4g-files "Best Free Text Editor Supporting *More Than* 4G Files?")[最佳免费文本编辑器](https://stackoverflow.com/questions/102829/best-free-text-editor-supporting-more-than-4g-files "支持*超过* 4G 文件的最佳免费文本编辑器？")*的副本？甚至[编辑器可以打开大文本文件（XML 导出文件）](https://stackoverflow.com/questions/159521/editor-to-open-big-text-files-xml-export-files "编辑器打开大文本文件（XML 导出文件）")，即使您添加了“开源”（大多数都是）。*

 ** * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-07T21:20:29.753

好吧，没有其他人说过，所以：

[emacs](http://www.gnu.org/software/emacs/)

总是emacs。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T21:09:31.260

[文本板](http://www.textpad.com)可能会吞下它

哎呀，刚刚满足了“开源”要求。先打字再思考。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-07T21:13:42.590

Notepad++ 是开源的，对编辑非常大的文件有很好的支持：

[http://notepad-plus.sourceforge.net/uk/site.htm](http://notepad-plus.sourceforge.net/uk/site.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-24T16:24:45.307

好吧，vim 和 gvim 都很棒……我可以毫不费力地打开 3GB 文件 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-23T20:03:04.373

[scite](http://www.scintilla.org/SciTE.html)非常轻量级，可以毫无问题地处理 200+ MB 的文件（就我而言）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-30T17:30:42.717

[JujuEdit](http://jujusoft.com/software/edit/index.html)是正确的软件。它不会将整个文件加载到内存中，因此即使打开 1 GB 以上的文件也能快速打开。注意：它不是开源的（它是免费软件），也不是在积极开发中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T22:39:55.803

我的规格：Windows XP - 2 GByte RAM

测试文件大小：280 MB

我使用了以下编辑器的标准安装，没有任何进一步的配置：

Notepad++：没有打开文件（错误信息：File ist too big to be open by Notepad++）

Emacs：没有打开文件（错误消息：超出最大缓冲区大小）

GVIM 或 Cream：确实打开了文件，但无法对大量文本执行内部复制操作。

精简版的[Editpad](http://www.editpadpro.com/editpadlite.html)为我完成了这项工作（它不是开源的，但似乎可以免费用于非商业用途）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-12T17:45:57.483

EditPad Lite 对我来说也很快。像处理小文件一样处理大文件（例如：114MB）！很强大！！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-02-23T19:44:39.763

EditPad Lite 说：不支持 2GB 的文件，糟透了！

当前版本的 Notepad++（开源）只是打开它，但只查看文件的开头。对我来说幸运的是，这就是我在这种情况下需要看到的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-10T13:32:08.330

尝试[崇高文本](http://www.sublimetext.com/)

打开文件需要一些时间，但速度很快。

# javascript - 使用 javascript 和 jquery，用数组结构填充相关的选择框

> ID：180451
> 
> 赞同：24
> 
> 时间：2008-10-07T21:12:41.253
> 
> 标签：javascript, jquery

使用[这个问题](https://stackoverflow.com/questions/57522/javascript-array-with-a-mix-of-literals-and-arrays)的答案，我已经能够根据另一个选择框的选择来填充一个选择框。（[我在这里发布了我的答案](https://stackoverflow.com/questions/57522/javascript-array-with-a-mix-of-literals-and-arrays#58062)）从服务器端构建的数组结构中提取数据，存储在 .js 文件中并在 html 页面中引用。

现在我想添加第三个选择框。如果我有 3 组数据（模型、品牌、选项）是这样的（伪代码）：

```
cars : [Honda[Accord[Lx, Dx]], [Civic[2dr, Hatchback]],
   [Toyota[Camry[Blk, Red]], [Prius[2dr,4dr]] 
```

例如：如果选择 Honda，下一个选择框将显示 [Accord Civic]，如果选择 Accord，则下一个选择框将显示 [Lx Dx]

我怎样才能

1）创建一个数组结构来保存数据？这样

2）我可以使用一个选择框中的值来引用下一个选择框所需的值

谢谢

**编辑**

我可以创建以下内容，但无法以有助于填充选择框的方式找出引用

```
var cars = [
 {"makes"  : "Honda",
  "models"  : [
    {'Accord' : ["2dr","4dr"]} ,
    {'CRV'  : ["2dr","Hatchback"]} ,
    {'Pilot': ["base","superDuper"] } ]
 },
 {"makes"   :"Toyota",
  "models"  : [
    {'Prius'   : ["green","reallyGreen"]} ,
    {'Camry'   : ["sporty","square"]} ,
    {'Corolla' : ["cheap","superFly"] } ]
 } ] ;              

 alert(cars[0].models[0].Accord[0]); ---> 2dr 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-08T00:16:05.687

我更喜欢这样的数据结构：

```
var carMakers = [
    { name: 'Honda', models: [
            { name: 'Accord', features: ['2dr', '4dr'] },
            { name: 'CRV', features: ['2dr', 'Hatchback'] },
            { name: 'Pilot', features: ['base', 'superDuper'] }
        ]},

    { name: 'Toyota', models: [
            { name: 'Prius', features: ['green', 'superGreen'] },
            { name: 'Camry', features: ['sporty', 'square'] },
            { name: 'Corolla', features: ['cheap', 'superFly'] }
        ]}
]; 
```

给定三个带有 id 的选择列表：“制造商”、“模型”和“功能”，您可以使用它来操作它们（我相信这是不言自明的）：

```
// returns array of elements whose 'prop' property is 'value'
function filterByProperty(arr, prop, value) {
    return $.grep(arr, function (item) { return item[prop] == value });
}

// populates select list from array of items given as objects: { name: 'text', value: 'value' }
function populateSelect(el, items) {
    el.options.length = 0;
    if (items.length > 0)
        el.options[0] = new Option('please select', '');

    $.each(items, function () {
        el.options[el.options.length] = new Option(this.name, this.value);
    });
}

// initialization
$(document).ready(function () {
    // populating 1st select list
    populateSelect($('#maker').get(0), $.map(carMakers, function(maker) { return { name: maker.name, value: maker.name} }));

    // populating 2nd select list
    $('#maker').bind('change', function() {
        var makerName = this.value,
            carMaker = filterByProperty(carMakers, 'name', makerName),
            models = [];

        if (carMaker.length > 0)
            models = $.map(carMaker[0].models, function(model) { return { name: model.name, value: makerName + '.' + model.name} });

        populateSelect($('#model').get(0), models);
        $('#model').trigger('change');
    });

    // populating 3rd select list
    $('#model').bind('change', function () {
        var nameAndModel = this.value.split('.'),
            features = [];

        if (2 == nameAndModel.length) {
            var makerName = nameAndModel[0], 
                carModel = nameAndModel[1],
                carMaker = filterByProperty(carMakers, 'name', makerName);

            if (carMaker.length > 0) {
                var model = filterByProperty(carMaker[0].models, 'name', carModel)

                if (model.length > 0)
                    features = $.map(model[0].features, function(feature) { return { name: feature, value: makerName + '.' + carModel + '.' + feature} })
            }
        }

        populateSelect($('#feature').get(0), features);
    })

    // alerting value on 3rd select list change
    $('#feature').bind('change', function () { 
        if (this.value.length > 0)
            alert(this.value);
    })
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T15:37:41.677

感谢@Marko Dunic 的回答，我能够构建一个数组（数据）结构，可以引用它来填充 3 个选择框。我没有使用实现代码只是因为我没有完全理解它......它按发布的那样工作。稍后我会在学习 jQuery 时回到这段代码。我的代码贴在下面（显然，您对 jQuery 的引用可能不同）

```
<html><head>
<script language="Javascript" src="javascript/jquery-1.2.6.min.js"></script>
<script type="text/JavaScript">
var cars = [
{ name: 'Honda', models: [
{ name: 'Accord', features: ['2dr', '4dr'] },
{ name: 'CRV', features: ['2dr', 'Hatchback'] },
{ name: 'Pilot', features: ['base', 'superDuper'] }
   ]},
{ name: 'Toyota', models: [
{ name: 'Prius', features: ['green', 'superGreen'] },
{ name: 'Camry', features: ['sporty', 'square'] },
{ name: 'Corolla', features: ['cheap', 'superFly'] }
   ]
 }
];
$(function() {
var options = '' ;
for (var i = 0; i < cars.length; i++) {
    var opt = cars[i].name ;
    if (i == 0){  options += '<option selected value="' + opt + '">' + opt + '</option>'; }
    else {options += '<option value="' + opt + '">' + opt + '</option>'; } 
}
$("#maker").html(options);   // populate select box with array

var options = '' ;
for (var i=0; i < cars[0].models.length; i++) { 
    var opt = cars[0].models[0].name ;
    if (i==0){options += '<option selected value="' + opt + '">' + opt + '</option>';}
    else {options += '<option value="' + opt + '">' + opt + '</option>';} 
}
$("#model").html(options);   // populate select box with array

var options = '' ;
for (var i=0; i < cars[0].models[0].features.length; i++) { 
    var opt = cars[0].models[0].features[i] ;
    if (i==0){options += '<option selected value="' + opt + '">' + opt + '</option>';}
    else {options += '<option value="' + opt + '">' + opt + '</option>';}
}
$("#feature").html(options);   // populate select box with array

$("#maker").bind("click",
    function() {
        $("#model").children().remove() ;       // clear select box
        for(var i=0; i<cars.length; i++) {
            if (cars[i].name == this.value) {
                var options = '' ;
                for (var j=0; j < cars[i].models.length; j++) { 
                    var opt= cars[i].models[j].name ;
                    if (j==0) {options += '<option selected value="' + opt + '">' + opt + '</option>';}
                    else {options += '<option value="' + opt + '">' + opt + '</option>';} 
                }
                break;
            }
        }
        $("#model").html(options);   // populate select box with array

        $("#feature").children().remove() ;     // clear select box
        for(var i=0; i<cars.length; i++) {
            for(var j=0; j<cars[i].models.length; j++) {
                if(cars[i].models[j].name == $("#model").val()) {
                    var options = '' ;
                    for (var k=0; k < cars[i].models[j].features.length; k++) { 
                        var opt = cars[i].models[j].features[k] ;
                        if (k==0){options += '<option selected value="' + opt + '">' + opt + '</option>';}
                        else {options += '<option value="' + opt + '">' + opt + '</option>';}
                    }
                    break;
                }
            }
        }
        $("#feature").html(options);   // populate select box with array
    });

    $("#model").bind("click",
        function() {
            $("#feature").children().remove() ;     // clear select box
            for(var i=0; i<cars.length; i++) {
                for(var j=0; j<cars[i].models.length; j++) {
                    if(cars[i].models[j].name == this.value) {
                        var options = '' ;
                        for (var k=0; k < cars[i].models[j].features.length; k++) { 
                            var opt = cars[i].models[j].features[k] ;
                            if (k==0){options += '<option selected value="' + opt  + '">' + opt  + '</option>';}
                            else {options += '<option value="' + opt  + '">' + opt  + '</option>';}
                        }
                        break ;
                    }
                }
            }
            $("#feature").html(options);   // populate select box with array
    });
});
</script>
</head> <body>
<div id="selection">
<select id="maker"size="10" style="{width=75px}"></select>
<select id="model" size="10" style="{width=75px}"></select>
<select id="feature" size="10"style="{width=75px}"></select>
</div></body></html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-25T02:17:54.873

我真的很喜欢@Marko Dunic 的解决方案，但它不能满足我将 ID 附加到选项的需求。附上 ID 后，我意识到我可以使 JS 代码更小更简单。我的解决方案是为数据来自关系数据库而设计的，并且 JSON 输入数据保留了具有主键/外键的关系结构。这是 JSON 数据：

```
<html lang="en">
  <head>
    <title>Populate a select dropdown list with jQuery - WebDev Ingredients</title>
    <script type="text/javascript" src="js/jquery-1.4.2.js"></script>
    <script type="text/javascript">
        var types = [ 
            { typeID: 1, name: 'Domestic'},
            { typeID: 2, name: 'Import'},
            { typeID: 3, name: 'Boat'}
        ]
        var makes = [ 
            { typeID: 1, makeID: 1, name: 'Chevy'}, 
            { typeID: 1, makeID: 2, name: 'Ford'}, 
            { typeID: 1, makeID: 3, name: 'Delorean'}, 
            { typeID: 2, makeID: 4, name: 'Honda'}, 
            { typeID: 2, makeID: 5, name: 'Toyota'}, 
            { typeID: 2, makeID: 6, name: 'Saab'} 
        ]       
        var model = [ 
            { makeID: 1,  modelID: 1, name: 'Camaro'}, 
            { makeID: 1,  modelID: 2, name: 'Chevelle'}, 
            { makeID: 1,  modelID: 3, name: 'Nova'}, 
            { makeID: 2,  modelID: 4, name: 'Focus'}, 
            { makeID: 2,  modelID: 5, name: 'Galaxie'}, 
            { makeID: 2,  modelID: 6, name: 'Mustang'}, 
            { makeID: 4,  modelID: 7, name: 'Accord'},
            { makeID: 4,  modelID: 8, name: 'Civic'}, 
            { makeID: 4,  modelID: 9, name: 'Odyssey'}, 
            { makeID: 5,  modelID: 10, name: 'Camry'}, 
            { makeID: 5,  modelID: 11, name: 'Corolla'}
        ]
        // 
        // Put this in a stand alone .js file
        //
        // returns array of elements whose 'prop' property is 'value' 
        function filterByProperty(arr, prop, value) { 
            return $.grep(arr, function (item) { return item[prop] == value }); 
        } 
        // populates select list from array of items given as objects: { name: 'text', value: 'value' } 
        function populateSelect(el, items) { 
            el.options.length = 0; 
            if (items.length > 0) 
                el.options[0] = new Option('please select', ''); 
            $.each(items, function () { 
                el.options[el.options.length] = new Option(this.name, this.value); 
            }); 
        }  
        // initialization 
        $(document).ready(function () { 
            // populating 1st select list 
            populateSelect($('#sType').get(0), $.map(types, function(type) { return { name: type.name, value: type.typeID} }));      
             // populating 2nd select list 
            $('#sType').bind('change', function() { 
                var theModels = filterByProperty(makes, 'typeID', this.value);
                populateSelect($('#sMake').get(0), $.map(theModels, function(make) { return { name: make.name, value: make.makeID} })); 
                $('#sMake').trigger('change'); 
            }); 
             // populating 3nd select list 
            $('#sMake').bind('change', function() { 
                var theSeries = filterByProperty(model, 'makeID', this.value);  
                populateSelect($('#sModel').get(0), $.map(theSeries, function(model) { return { name: model.name, value: model.modelID} })); 
            }); 
        });
    </script>
  </head>
  <body>
    Enter values, click submit, and look at the post parameters
    <form method="get" action="index.php">
            <div id="selection"> 
                <select id="sType" name="type_id" style="{width=75px}"></select> 
                <select id="sMake"  name="make_id" style="{width=75px}"></select> 
                <select id="sModel"  name="model_id" style="{width=75px}"></select> 
            </div>
            <input type="submit">
    </form>
  </body>
</html> 
```

请注意，我的解决方案改变了功能，使 Make-Model 成为第 2 和第 3 个文本框，而 Type（国内、进口、船等）是第 1 级。我将样板 JS 减少到 23 行（更少的评论），同时保留了良好的格式。

JSON 数据很容易从 SQL 查询中呈现，这些查询在初始化时缓存在 java Lists 中，因为 Type-Make-Model 很少更改。我不使用任何动态 AJAX，因为这会使体系结构复杂化，而且我的可用值列表相对较少，所以我只是在页面请求时发送它。

“解决方案应该尽可能简单，但不能更简单”——A. Einstein

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T21:47:38.967

您应该在[这里](http://www.texotela.co.uk/code/jquery/select/)查看选择框操作。对于你想要的，我认为[JSON](http://json.org/)会为你做正确的工作。无论如何，如果我是你，我会这样做：当我更改第一个选择时，我会执行 ajax 请求。使用 ajax 响应，我将填充第二个框。第二个框也一样，第三个框填充了正确的数据。

# c# - 如何为表单设置点击事件？

> ID：180452
> 
> 赞同：7
> 
> 时间：2008-10-07T21:12:52.813
> 
> 标签：c#, winforms

我有一个带有许多自定义控件的 ac# 表单（我们称之为 MainForm）。我想让 MainForm.OnClick() 方法在有人点击表单时触发，无论点击是发生在表单上还是点击是在自定义控件之一上。我正在寻找类似于表单的 KeyPreview 功能的行为，除了鼠标点击而不是按键。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T15:18:34.920

我建议为应用程序中的其他表单创建一个基本表单以进行继承。将此代码添加到您的基本表单以创建一个名为 GlobalMouseClickEventHandler 的新事件：

```
namespace Temp
{
    public delegate void GlobalMouseClickEventHander(object sender, MouseEventArgs e);

    public partial class TestForm : Form
    {
        [Category("Action")]
        [Description("Fires when any control on the form is clicked.")]
        public event GlobalMouseClickEventHander GlobalMouseClick;

        public TestForm()
        {
            InitializeComponent();
            BindControlMouseClicks(this);
        }

        private void BindControlMouseClicks(Control con)
        {
            con.MouseClick += delegate(object sender, MouseEventArgs e)
            {
                TriggerMouseClicked(sender, e);
            };
            // bind to controls already added
            foreach (Control i in con.Controls)
            {
                BindControlMouseClicks(i);
            }
            // bind to controls added in the future
            con.ControlAdded += delegate(object sender, ControlEventArgs e)
            {
                BindControlMouseClicks(e.Control);
            };            
        }

        private void TriggerMouseClicked(object sender, MouseEventArgs e)
        {
            if (GlobalMouseClick != null)
            {
                GlobalMouseClick(sender, e);
            }
        }
    }
} 
```

此解决方案不仅适用于顶级控件，还适用于嵌套控件，例如放置在面板内的控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T21:40:21.273

在窗体的 ControlAdded 事件中，向控件添加一个 MouseClick 处理程序，其中包含窗体单击事件的地址。我没有对此进行测试，但它可能会起作用。

```
Private Sub Example_ControlAdded(ByVal sender As Object, ByVal e As System.Windows.Forms.ControlEventArgs) Handles Me.ControlAdded

    AddHandler e.Control.MouseClick, AddressOf Example_MouseClick
End Sub

Private Sub Example_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles Me.MouseClick
    MessageBox.Show("Click")
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T21:39:31.353

我曾经设法做到这一点的唯一方法是处理每个控件的 [c]Click[/c] 事件。我不相信在控制处理它之前引发事件。

在 WPF 中，有提供此功能的“隧道”预览事件，但这并不能真正帮助您在 WinForms 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T21:57:04.907

如果愿意，您可以挂钩所有控件的事件，然后以这种方式进行监视。我认为有一些超级花哨的 Win32 api 方法可以将它们全部捕获，但目前这超出了我的范围。

```
 public Form1()
    {
        InitializeComponent();
        HookEvents();
    }

    private void HookEvents() {
        foreach (Control ctl in this.Controls) {
            ctl.MouseClick += new MouseEventHandler(Form1_MouseClick);
        }
    }  

    void Form1_MouseClick(object sender, MouseEventArgs e)
    {
        LogEvent(sender, "MouseClick");
    }

    // and then this just logs to a multiline textbox you have somwhere on the form
    private void LogEvent(object sender, string msg) {
        this.textBox1.Text = string.Format("{0} {1} ({2}) \n {3}",
            DateTime.Now.TimeOfDay.ToString(),
            msg,
            sender.GetType().Name,
            textBox1.Text
            );
    } 
```

输出是这样的，显示所有事件以及谁“发送”了它们：

```
14:51:42.3381985 MouseClick (Form1) 
14:51:40.6194485 MouseClick (RichTextBox) 
14:51:40.0100735 MouseClick (TextBox) 
14:51:39.6194485 MouseClick (Form1) 
14:51:39.2131985 MouseClick (RichTextBox) 
14:51:38.8694485 MouseClick (Button) 
```

HTH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T21:18:16.373

在表单上的空白处捕捉点击很容易，但要获得实际在控件上的点击，您需要该控件的合作才能将其发送到表单。

一种可能性是在整个表单上放置一个透明控件，并接受对其的点击，处理它们，然后将它们传递给下面的适当控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T21:32:50.993

这是开发中常见的模式，称为观察者模式。有很多观察者模式的例子，这里的 c# 是 1 个例子[http://msdn.microsoft.com/en-us/library/ms954621.aspx](http://msdn.microsoft.com/en-us/library/ms954621.aspx)但是有一个很好的谷歌。

# php - php.ini 的 session.save_path 的正确用法是什么？

> ID：180464
> 
> 赞同：1
> 
> 时间：2008-10-07T21:14:21.780
> 
> 标签：php, iis, session, session-variables

我在 Windows/IIS 上运行 PHP。

我的会话变量似乎没有逐页保留。

这段代码…

```
//echos out the session variables in a nice format for inspection
echo "<p><pre>";
print_r($_SESSION);
echo "</pre></p>"; 
```

…输出空白值，像这样…

```
    大批  
    (  
        [s_firstvar] =>  
        [s_var2] =>  
        [s_第三] =>  
        [s_numberfour] =>  
        [s_youget] =>  
        [s_thepoint] =>  
        [] =>  
    )

```

我在论坛上找到建议...

> 我最近遇到了类似的问题（Win2000，IIS），结果表明 PHP 对存储会话数据的任何目录都没有写访问权限。你可能想看看这个。

和

> 你设置 session.save_path 了吗？

php.ini 的 session.save_path 的正确用法是什么？而且，这是我的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T21:20:40.393

你能发布更多你的会话代码吗？一些基础知识：

*   你开始你的会议了吗？( [`session_start()`](http://php.net/session_start))
*   您是否检查过您的保存路径是否具有适当的权限（OP 中未提及）
*   session.save_path 实际上只是将保存会话的目录。如果您在共享服务上，最好将其设置为与默认临时目录不同的目录（因为您的会话也会与其他应用程序的会话混合，并可能导致更大的会话冲突机会）
*   如果您正在更改会话配置（例如`save_path`，必须在调用`session_start()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T21:22:44.413

哎呀。我发现在赋值时我没有使用正确的语法：

不工作：

```
$_SESSION['$s_firstvar'] = 3; 
```

是否有效：

```
$_SESSION['s_firstvar'] = 3; 
```

# asp.net - How do you deal with connection strings when deploying an ASP.NET site?

> ID：180470
> 
> 赞同：9
> 
> 时间：2008-10-07T21:17:00.993
> 
> 标签：asp.net, deployment

Right now our test and production databases are on the same server, but with different names. Deploying has meant editing Web.config to change all the connection strings for the correct database. A step which I forget all too frequently...

We've finally created a new database server for testing, and I'm moving the databases over... but now the server will be different and we'll still need to deal with connection string issues.

I was thinking of managing it via a hosts file, but the thought of switching that on my desktop machine whenever I need to test against production data seems cumbersome at best.

So I'm just wondering if there's a better way out there. Something that would build with a "production" web config for deployment would be ideal...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T21:23:42.883

使用[Web 部署项目](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)并使用一些后期构建任务更新 wdproj 文件（它只是一个 MSBuild 文件）以输出正确的 .config 文件。我保留 web.config 和 web.release.config 然后在 wdproj 文件中使用它：

```
<Target Name="AfterBuild">
    <Copy Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' " SourceFiles="$(SourceWebPhysicalPath)\web.release.config" DestinationFiles="$(OutputPath)\web.config" />
    <Delete Files="$(OutputPath)\web.release.config" />
</Target> 
```

[更多信息](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)

一个更简单的解决方案是使用[appSettings 和 connectionStrings 的 configSource 属性，](http://weblogs.asp.net/fmarguerie/archive/2007/04/26/using-configsource-to-split-configuration-files.aspx)然后永远不要覆盖生产服务器上的该文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T21:22:15.243

我通常有三个独立的 Web 配置：一个用于我的开发机器，一个用于 QA，一个用于生产。开发版连接到我的本地 SQL 数据库（外部有防火墙），它是默认的 web.config。其他名为 web-prod.config 和 web-qa.config。发布后，我删除了两个我不需要的并将正确的重命名为 web.config。如果我忘记了，该应用程序在第一次尝试访问数据库时会中断，因为默认配置引用了它无法访问的配置。

由于 IIS 拒绝提供名为 .config 的文件，我确保它们都以 .config 结尾，而不是 web.config-prod 或 web.config-qa。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T21:35:49.927

这是您可以尝试的另一件事：

使用 SQL Server 配置管理器，为您的开发数据库创建一个 db 别名，以便 web.config 文件在您的开发服务器和生产服务器上可以是相同的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T21:36:16.807

我在每台服务器上创建一个数据库别名来指向数据库。然后我在我的 web.config 文件中使用这个别名。如果我需要更改应用程序指向的数据库，那么我更改别名而不是 web.config。

对于 SQL Server，请转到 SQL Server 配置管理器 > SQL Native Client 配置 > 别名 > 创建新别名。

您可以使用 tnsnames 文件对 Oracle 执行相同的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T21:20:22.330

have environment folders with separate configs for each environment

deploy out the correct one for the environment

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T21:23:27.173

我经常这样做，我将生产服务器上的 web.config 设为只读。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T21:44:37.287

我现在去过一些将它们存储在注册表中的地方。

现在可能有更复杂的方法可以做到这一点，但我使用 1.0/1.1 遗产处理的许多代码将字符串存储在注册表中。

注册表有几个优点

1.  它可以防止人们将代码部署到错误的地方，因为未正确配置的机器将缺少密钥
2.  它消除了开发人员会不小心打包一个带有开发连接字符串的 web.config 文件的问题（随后在半夜疯狂打电话，其中显示深夜系统管理员没有备份以前的web.config 和开发人员不知道或不记得生产字符串）
3.  它限制了黑客通过从机器上获取 web.config 来获取连接字符串的可能性。此外，注册表比文件系统具有更高级别的安全性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-07T21:49:13.923

我们从 CI 服务器驱动我们的部署。我们通常对每个位置都有一个单独的文件，并让 CI 服务器根据传递给它的参数切换到适当的配置。所有文件编辑都是在 NAnt 脚本中完成的，因此开发人员可以在他们的机器上运行 sam 构建以获取他们自己的设置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-12T05:14:56.473

我最近一直倾向于在持续集成服务器上进行配置操作。那是因为我们遇到了多个 web.config、web.qa.config、web.production.config 的问题，以保持 95% 的文件应该是相同的同步。

简而言之：源代码管理中只有一个 web.config，它是开发配置（调试友好、本地数据库等）。构建服务器进行编译，然后部署到金丝雀站点，然后是候选发布包。

我们使用的是 nant，所以它是 .build 文件，它具有 xmlpoke 来设置 debug="false"、更改连接字符串以及在金丝雀副本和 web.config 的打包副本中需要更改的任何其他内容。

构建机器的部署被称为“金丝雀”，因为如果出现问题，它是第一个死去的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-07T21:36:03.950

我将把我的连接字符串放在我们的 QA 和生产框上的 machine.config 中。不过，为了灵活性，我会将它们保存在我的开发箱上的 web.config 中。然后，在部署到 QA 时，我将使用 Web 部署项目来覆盖我的开发连接字符串（没有连接字符串）。因此，QA 站点依赖于 machine.config 中的连接字符串。我仍然手动部署到生产以确保一切成功。我通过手动将 QA（web.config 除外）中的所有内容复制到生产环境来做到这一点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-07T21:39:01.697

这种任务正是构建事件旨在解决的问题。将构建视为针对特定目标的构建，任何目标特定配置都应在此处完成。（通常需要注意的是，规则总是有一些例外）

# audio - 获取 MP3 音频压缩库

> ID：180471
> 
> 赞同：1
> 
> 时间：2008-10-07T21:17:06.157
> 
> 标签：audio, compression, operating-system, mp3

我想知道在哪里可以找到 MP3 库，以便在操作系统中实现。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T21:18:42.800

你在找[跛脚](http://lame.sourceforge.net/)吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T21:45:07.130

注意：MP3 编码受 Fraunhofer Institute 和 Thomson Multimedia 拥有的专利保护。如果您正在开发的操作系统不仅仅是您自己使用的爱好，您应该考虑专利问题和[许可](http://www.mp3licensing.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T21:48:29.637

如果你想要一个官方授权的 MP3 库，你可能应该联系[Thompson](http://www.mp3licensing.com)，他正在为 Fraunhofer 处理专利许可。

# sharepoint - MOSS 2007 文档库 - 选择列未显示所选值

> ID：180498
> 
> 赞同：2
> 
> 时间：2008-10-07T21:23:02.073
> 
> 标签：sharepoint, moss, document-library, choice

我对 MOSS 有一些奇怪的事情，想知道是否有人看到过类似的东西：

我在 MOSS 中有一个文档库，其中添加了几个自定义列。我有一列类型选择。对于库中的一个文档（word 文档），没有为一列显示所选值 - 所有其他列都很好，文件夹中的其他 60 个文档正确显示所选值。当我编辑文档的属性时，该列的值默认为空白，我可以将其更改为另一个值并保存。但是，新值不会显示在列表视图中，如果我再次编辑属性也不会显示。

如果我用 word 打开文档并查看文档信息面板，它会显示我为该列选择并保存的值。但是，该列显示为文本框而不是下拉列表。保存后，该值仍不会显示在列表视图或属性视图中。

有没有人见过这样的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T19:05:54.597

我的第一个猜测是自定义列与 SharePoint 开箱即用的列之间的名称冲突。导致问题的列名是什么？

当库中有文档，然后添加列时，我见过这样的情况。现有信息未正确更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T21:29:15.663

如果您将文档作为第二个内容重新上传，这是否会再次发生？

如果是，您可以在上传之前检查文档的高级属性。其中可能包含 SharePoint 在导入文件时尝试使用的一些数据。它可能说明您只复制/粘贴内容时没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T06:45:58.757

类似地，问题文档可能有一个名为主题的 Word 元数据字段，而 MOSS 正在做它的属性提升事情来搞乱您的字段。如果是这样，清除 Word 元数据可能会修复它。

# algorithm - 是否有所有内容的 Big-O 符号的主列表？

> ID：180510
> 
> 赞同：17
> 
> 时间：2008-10-07T21:28:01.457
> 
> 标签：algorithm, data-structures, big-o

是否有所有内容的 Big-O 符号的主列表？数据结构、算法、对每个执行的操作、平均情况、最坏情况等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T21:49:41.287

[算法和数据结构字典](http://xlinux.nist.gov/dads/)是一个相当全面的列表，并且在算法的描述中包括复杂性（Big-O）。如果您需要更多信息，它会在其中一个链接的参考资料中，并且总是有 Wikipedia 作为后备。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-07T21:31:49.093

[Cormen](https://rads.stackoverflow.com/amzn/click/com/0262032937)的书更多的是教你如何证明给定算法的 Big-O 是什么，而不是死记硬背算法的 Big-O 性能。前者比后者更有价值，并且需要您进行投资。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T21:29:55.023

试试Cormen、Leisersen 和 Rivest 的“[算法简介”。](https://rads.stackoverflow.com/amzn/click/com/0262032937)如果它不在那里，它可能不值得知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T21:47:31.197

在 c++ 中，STL 标准由算法的 Big-O 特征以及空间要求定义。这样，您可以在 STL 的竞争实现之间切换，并且仍然知道您的程序具有相同的运行时特性。特别好的 STL 实现甚至可以比标准要求更好的特定类型的特殊情况列表。

它使为特定问题选择正确的迭代器或列表类型变得很容易，因为您可以轻松地在空间消耗和速度之间进行权衡。

当然，Big-O 只是一个指导方针，因为所有常量都被删除了。如果算法在 k*O(n) 中运行，它将被归类为 O(n)，但如果 k 足够高，对于 n 和 m 的某些值，它可能比 O(n^2) 更差。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T21:30:41.433

[算法简介，第二版](http://mitpress.mit.edu/algorithms/)，又名 CLRS（Cormen，Leiserson，Rivest，Stein），是我能想到的最接近的东西。

如果失败了，那么试试Knuth[的 The Art of Computer Programming](http://www-cs-faculty.stanford.edu/~knuth/taocp.html)。如果不是这些，你可能需要做一些真正的研究。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-06T18:51:34.927

对于任何从谷歌来回答这个问题的人。

[http://bigocheatsheet.com/](http://bigocheatsheet.com/)

# c# - 在 DataGridViewComboBoxColumn 中显示无效的默认值

> ID：180511
> 
> 赞同：1
> 
> 时间：2008-10-07T21:28:30.720
> 
> 标签：c#, winforms, datagridview, combobox

我在 Windows 应用程序的 DataGridView 中有一个 DataGridViewComboBoxColumn。用户可以在其他地方更改设置，以使 DataGridViewComboBoxColumn 中的选择可能无效。我需要保留/显示无效项目，同时只在列表中选择有效项目。

如果不更正选择，则会引发异常：
DataGridViewComboBoxCell 值无效。

捕获并忽略该设置会将所选值还原为列表中的第一个有效项目。

有没有办法为 DataGridViewComboBoxColumn 提供一个值，这样它就不会出现在可选值​​列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:20:25.323

我将使用一个示例，下拉列表中的值是颜色，DataGridView 在你的衣橱里有一个 T 恤列表。

您是否尝试将无效颜色插入到绑定到 ComboBox 列的列表对象中？也许您可以在列表中插入一些内容，其键与您的无效颜色匹配但显示“（无效）”（或其他类似文本）。如果有人在您的初始绑定后尝试选择它，您必须响应 CellValidating 事件。

如果无效颜色是通过更改应用程序中其他位置的查找来导致 DataGridView 的值（T 恤）不再有效，那么您有一些选择。也许您可以更改该逻辑以查找进入 T 恤列表的数据并查看是否存在具有该颜色的任何现有 T 恤——然后提示用户说“您已停用红色，但您有红色T恤，你想做什么？” 您可以停止停用 Red、更换 T 恤或删除 T 恤。

如果无效颜色来自您无法控制的来源，您可以在用户尝试查看 T 恤列表时提示用户，“红色不再是 T 恤的有效颜色，我们该怎么办？红T恤？”

我们的应用程序中有类似的约束。我们删除了组合框并改用 CellValidating。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:56:47.220

我找到了一个非常奇怪的解决方案：

将 autosizecolumnmode 设置为 none...

这是一个解释

[http://www.kebabshopblues.co.uk/2007/03/24/more-on-that-datagridviewcombobox-error/](http://www.kebabshopblues.co.uk/2007/03/24/more-on-that-datagridviewcombobox-error/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T10:37:39.307

Presumably your bound datasource to populate the combobox is read only. If so, why not just temporarily insert the invalid value into the underlying datasource. That way it would still be displayed. You could add a temporary column to flag invalid items and not allow the user to leave it selected and then delete it when the user navigated off of the cell. I've never done this with a datagridview but we did something very similar with a different 3rd party grid. Good Luck!

# c++ - 如何从 std::map 中过滤项目？

> ID：180516
> 
> 赞同：28
> 
> 时间：2008-10-07T21:29:44.853
> 
> 标签：c++, boost, stl

我大致有以下代码。这可以做得更好或更有效吗？也许使用`std::remove_if`？您可以在遍历地图时从地图中删除项目吗？我们可以避免使用临时地图吗？

```
typedef std::map<Action, What> Actions;
static Actions _actions;

bool expired(const Actions::value_type &action)
{
  return <something>;
}

void bar(const Actions::value_type &action)
{
  // do some stuff
}

void foo()
{
  // loop the actions finding expired items
  Actions actions;
  BOOST_FOREACH(Actions::value_type &action, _actions)
  {
    if (expired(action))
      bar(action);
    else
      actions[action.first]=action.second;
    }
  }
  actions.swap(_actions);
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-07T23:01:19.020

Mark Ransom 算法的一种变体，但不需要临时算法。

```
for(Actions::iterator it = _actions.begin();it != _actions.end();)
{
    if (expired(*it))
    {
        bar(*it);
        _actions.erase(it++);  // Note the post increment here.
                               // This increments 'it' and returns a copy of
                               // the original 'it' to be used by erase()
    }
    else
    {
        ++it;  // Use Pre-Increment here as it is more effecient
               // Because no copy of it is required.
    }
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-07T21:54:39.233

您可以使用erase()，但我不知道BOOST_FOREACH 将如何处理无效的迭代器。[map::erase](http://en.cppreference.com/w/cpp/container/map/erase)的文档指出只有被擦除的迭代器会失效，其他的应该没问题。以下是我将如何重组内部循环：

```
Actions::iterator it = _actions.begin();
while (it != _actions.end())
{
  if (expired(*it))
  {
    bar(*it);
    Actions::iterator toerase = it;
    ++it;
    _actions.erase(toerase);
  }
  else
    ++it;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T22:18:54.427

似乎没有人知道的是，当在任何容器上使用时，erase 返回一个新的、保证有效的迭代器。

```
Actions::iterator it = _actions.begin();
while (it != _actions.end())
{
  if (expired(*it))
  {
    bar(*it);
    it = _actions::erase(it);
  }
  else
    ++it;
} 
```

在这种情况下，存储 actions.end() 可能不是一个好计划，因为我相信迭代器的稳定性不能得到保证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T21:33:45.000

如果想法是删除过期项目，为什么不使用[map::erase](http://www.cplusplus.com/reference/stl/map/erase.html)？这样，您只需删除不再需要的元素，无需使用您想要保留的所有元素重建整个副本。

这样做的方法是保存指向要擦除的元素的迭代器，然后在迭代结束后将它们全部擦除。

或者，您可以保存访问过的元素，移动到下一个元素，然后删除临时元素。但是，在您的情况下，循环边界会变得混乱，因此您必须自己微调迭代。

根据 expired() 的实现方式，可能还有其他更好的方法。例如，如果您正在跟踪时间戳作为地图的键（如 expired() 所暗示的那样？），您可以对当前时间戳执行 upper_bound，并且范围 [ begin(), upper_bound() ) 中的所有元素都需要被处理和删除。

# sql - Oracle 中的单行子查询——连接计划是什么？

> ID：180518
> 
> 赞同：0
> 
> 时间：2008-10-07T21:30:06.677
> 
> 标签：sql, database, oracle

我刚刚发现 Oracle 允许您执行以下操作：

```
SELECT foo.a, (SELECT c 
               FROM bar 
               WHERE foo.a = bar.a) 
from foo 
```

只要 bar 中只有一行匹配 foo 中的任何行。

我从 PL/SQL 开发人员那里得到的解释计划是这样的：

```
SELECT STATEMENT, GOAL = ALL_ROWS               
 TABLE ACCESS FULL  BAR 
 TABLE ACCESS FULL  FOO 
```

这实际上并没有指定表的连接方式。一位同事断言，这比进行常规连接更有效。真的吗？这样一个 select 语句的 join 策略是什么，为什么它没有出现在解释计划中？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T21:47:12.853

您那里的计划根本没有提供太多信息。

使用 SQL*Plus 并使用 dbms_xplan 获得更详细的计划。查找名为 utlxpls.sql 的脚本。

这提供了更多信息：-

```
--------------------------------------------------------------------------
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |      |  1837 | 23881 |     3   (0)| 00:00:01 |
|*  1 |  TABLE ACCESS FULL| BAR  |    18 |   468 |     2   (0)| 00:00:01 |
|   2 |  TABLE ACCESS FULL| FOO  |  1837 | 23881 |     3   (0)| 00:00:01 |
--------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("BAR"."A"=:B1)

Note
-----
   - dynamic sampling used for this statement

18 rows selected. 
```

我没有创建任何索引或外键或收集表的统计信息，这会改变计划和选择的连接机制。Oracle 实际上在这里进行了 NESTED LOOPS 类型的连接。第 1 步，您的内联子选择，针对从 FOO 返回的每一行执行。

这种执行 SELECT 的方式并不快。它可能相同或更慢。一般来说，尝试加入主要 WHERE 子句中的所有内容，除非它变得非常不可读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T00:10:32.423

如果你在 bar(a) 上创建一个普通索引，CBO 应该可以使用，但我很确定它不能进行散列连接。仅当您使用聚合函数并且在顶部 SELECT 中有多个单行子查询时，此类查询才有意义。即便如此，您始终可以将查询重写为：

```
SELECT foo.a, bar1.c, pub1.d
FROM foo
JOIN (SELECT a, MIN(c) as c
      FROM bar
      GROUP BY a) bar1
  ON foo.a = bar1.a
JOIN (SELECT a, MAX(d) as d
      FROM pub
      GROUP BY a) pub1
  ON foo.a = pub1.a 
```

这将使 CBO 能够使用更多选项，同时使您能够轻松地从子表中检索多个列，而无需多次扫描相同的表。

# java - 从 C++ 访问 Java 类的最佳方式？（比直接使用JNI好）

> ID：180528
> 
> 赞同：4
> 
> 时间：2008-10-07T21:31:49.513
> 
> 标签：java, c++, mixing

我必须在一个相当大的 C++ 应用程序中集成一个大型 Java 库。一种解决方案是使用 JNI，但这需要手动编写所有类的代码。例如，Python 有一个很好的 JPype ( [http://jpype.sourceforge.net/](http://jpype.sourceforge.net/) ) 解决方案，它可以自动化该过程（尽管由于 C++ 和 Python 的性质不同，相同的解决方案不能应用于 C++）。

谢谢，

达斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T21:34:16.030

[SWIG](http://www.swig.org/)是一种工具，可让您自动生成从一种语言到另一种语言的绑定。它支持 C++ 和 Java 以及十几种其他语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T18:52:44.280

看来我的问题还不够清楚。也许混乱来自JNI，它允许在展位方向访问......

我想要做的是从 C++ 访问 Java 库。也就是说，有人给我一个 JAR 文件，其中包含一个 JAVA 编译类的集合，我必须用 C++ 编写代码才能访问它（因为我想将该 Java 库的功能集成到 C++ 应用程序中）。

希望这能阐明访问的方向:)

谢谢，

达斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T09:19:19.913

[JNA](https://github.com/twall/jna/)并不是您想要的，但它确实让您的生活更轻松。它不需要任何样板/生成的代码 - 您只需为要调用的方法编写一个接口。

当然，完全有理由使用 JNA 而不是 JNI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T22:05:37.027

不确定这个商业工具是否让生活更轻松，但您可能想探索一下——http: [//www.teamdev.com/jniwrapper/index.jsf](http://www.teamdev.com/jniwrapper/index.jsf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T18:59:01.210

我有两个建议可能对你有用，也可能对你没用：

首先，您可以尝试一些非常简单的方法。在单独的进程中运行 Java 代码，并通过管道或套接字与其通信。这很容易做到，并且不需要任何疯狂的库。缺点是通信有些受限（只是一些简单的管道），您需要围绕它编写自己的包装器来发送数据

其次，这个库到底是什么？也许我们可以建议不是用 Java 编写的替代方案，这样在您的 C++ 应用程序中使用起来会更容易？

# sql-server - 用于生产的 SQL Express？

> ID：180537
> 
> 赞同：43
> 
> 时间：2008-10-07T21:34:21.363
> 
> 标签：sql-server, sql-server-express

在生产环境中使用 SQL Express 是一个合理的选择吗？

我看了微软的对比图：

[http://www.microsoft.com/sql/prodinfo/features/compare-features.mspx](http://www.microsoft.com/sql/prodinfo/features/compare-features.mspx)

我将在中小型网站上使用 SQL Express。我不相信我会超过 4GB 的数据库大小限制。共享主机环境通常支持 SQL Express 吗？有什么我遗漏的东西会使 SQL Express 成为不合理的选择吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-07T21:48:21.647

我知道很多人使用 SQL Express 进行生产，它运行良好，最大的限制因素是没有用于自动备份的 SQL 代理。要自动备份，您必须获取 VM 映像（如果在 VPS 上）或使用 Windows 调度程序或其他一些技术。

唯一的其他主要限制因素是内存限制，但对于一个小型站点，我并没有真正注意到这是一个太大的实际问题。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-07T21:40:44.690

许多廉价的托管公司使用 SQL Express。而且我从个人经验中知道，SQL Express 对于大多数事情来说都是一个可行的解决方案。

“大多数事情”包括生产环境中的大型项目。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-07T21:48:01.930

可能要问的一件事是 - 如果您的需求超过 SQL Server Express 的功能，您是否能够负担得起商业版本？

我认为 SQL Server Express 的一个想法是，您可以在其上托管您的网站，并且一旦您超出其规模（需要超过 4GB 等），您将购买商业版本，尤其是现在您被锁定在使用它。但是，如果您的网站在收入能够购买商业版本之前很快就超出了它，这可能是一个问题（如果您的网站消耗的数据/磁盘空间超出其需要，则可能是数据库设计缺陷）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-05T14:59:53.580

如果您不介意内存和处理器限制，SQL Express 是一个不错的选择。数据库大小限制不再是一个大问题，因为在 2008 R2 中他们将限制提高到 10gb。我认为其他限制仍然相同。

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2008-10-07T21:43:16.480

SQL Express 最多有 5 个并发连接。如果您有超过 5 个并发连接，性能将严重下降。此外，您必须考虑不包括 SQL 代理，因此如果您想安排备份或维护任务，您必须使用 windows 调度程序。除此之外，它是小型数据库的完美解决方案。

# c - 先学C再学Objective-C

> ID：180549
> 
> 赞同：107
> 
> 时间：2008-10-07T21:37:27.490
> 
> 标签：c, objective-c, cocoa

作为一名有抱负的 Apple 开发人员，我想获得社区的意见，如果在进入 Objective-C 并最终进入 Cocoa 框架之前先学习 C 会更好吗？

我的直觉说学习 C，这将为我打下良好的基础。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-10-07T23:32:34.340

我会先学习C。在转向 Obj-C 之前，我学习了 C（并且在 C 中做了很多工作）。我有很多同事从来都不是真正的 C 程序员，他们从 Obj-C 开始，只学了必要的 C。

我时不时地看到他们如何完全在 Obj-C 中解决问题，有时会导致非常笨拙的解决方案。通常我然后用纯C代码替换一些Obj-C代码（毕竟你可以随意混合它们，一个Obj-C方法的内容可以完全是纯C代码）。无意侮辱任何 Obj-C 程序员，Obj-C 中有一些非常优雅的解决方案，这些解决方案可以更好地工作（并且看起来）多亏了*对象*（OOP 编程可以使复杂的程序比函数式编程更可爱；例如，多态性是一个很棒的特性）......我真的很喜欢 Obj-C（比 C++ 更喜欢！我讨厌 C++ 语法，而且一些语言特性明显是矫枉过正并导致糟糕的开发模式恕我直言）；但是，当我有时重写同事的 Obj-C 代码时（我真的只是这样做，如果我认为这是绝对必要的），生成的代码通常会小 50%，只需要它使用的内存的 25%之前并且在运行时快了大约 400%。

我在这里想说的是：每种语言都有其优点和缺点。C 有利有弊，Obj-C 也是如此。然而，Obj-C 真正伟大的特性（这就是为什么我什至比 Java 更喜欢它的原因）是你可以随意跳转到纯 C 并再次返回。为什么这是一个很棒的功能？因为就像 Obj-C 修复了纯 C 的许多缺点一样，纯 C 可以修复 Obj-C 的一些缺点。如果您将它们混合在一起，您将获得一个非常强大的团队。

如果你只学过 Obj-C 对 C 语言一无所知，或者只知道它的基本知识，而从未尝试过它如何优雅地解决一些常见问题，那么实际上你只学了一半 Obj-C。C 是 Obj-C 的基础部分。随时随地使用 C 的能力是它的一个基本特征。

一个典型的例子是我们使用的一些代码必须以 base64 编码数据，但我们不能为此使用外部库（没有 OpenSSL 库）。我们使用了一个完全使用 Cocoa 类编写的 base64 编码器。它工作得很好，但是当我们让它编码 200 MB 的二进制数据时，它花了很长时间，而且内存开销是不可接受的。我用一个微型、超紧凑的 base64 编码器替换它，完全编写为一个 C 函数（我将函数体复制到方法体中，方法将 NSData 作为输入并返回 NSString 作为输出，但在函数内部一切都是 C）。C 编码器要紧凑得多，它的速度比纯 Cocoa 编码器高出 8 倍，而且内存开销也少得多。编码/解码数据、处理比特和类似的低级任务只是 C 语言的强项。

另一个例子是一些绘制大量图表的 UI 代码。为了存储绘制图形所需的数据，我们使用了 NSArray。实际上是 NSMutableArray，因为图形是动画的。结果：非常慢的图形动画。我们用普通的 C 数组替换了所有 NSArray，用结构替换了对象（毕竟图形坐标信息在对象中没有任何东西），用简单的 for 循环访问枚举器，并开始用 memcopy 在数组之间移动数据，而不是从一个数组中获取数据到另一种，索引索引。结果：速度提高了 4 倍。图表动画流畅，即使在旧的 PPC 系统上也是如此。

C 的弱点在于，从长远来看，每一个更复杂的程序都会变得丑陋。保持 C 应用程序的可读性、可扩展性和可管理性需要程序员的大量纪律。许多项目失败是因为缺少这门学科。Obj-C 使您可以轻松地使用类、继承、协议等来构建应用程序。也就是说，除非必要，否则我不会在方法的边界上使用纯 C 功能。我更喜欢将 Objective-C 应用程序中的所有代码保存在对象的方法中；其他一切都违背了 OO 应用程序的目的。但是，在该方法中，我有时会专门使用纯 C。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-07T23:06:39.227

你可以很容易地同时学习 C 和 Objective-C —— 在开始使用 Objective-C 对语言的添加之前，当然没有必要学习 C 的细节（包括指针运算等），并且作为一个新手程序员快速开始使用 Objective-C 可能会帮助您更快地开始“思考对象”。

就可用资源而言，Apple 的文档通常假定您熟悉 C，因此从[Objective-C 2.0 编程语言](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/chapter_1_section_1.html)开始对您没有多大好处。我会投资一本 Stephen Kochan 写的 Programming in Objective-C （取决于你想多快开始，你可以考虑等待第二版）：

[编程 Objective-C 开发人员库](https://rads.stackoverflow.com/amzn/click/com/0672325861) [编程 Objective-C 2.0 开发人员库](https://rads.stackoverflow.com/amzn/click/com/0321566157)

它假设没有任何经验，并教你 Objective-C 和你需要的尽可能多的 C。

如果你觉得有点野心，你可以从[Scott Stevenson 的“学习 C”教程](http://cocoadevcentral.com/articles/000081.php)开始，但它确实有一些先决条件（“你应该已经知道至少一种脚本或编程语言，包括函数、变量和循环。你”还需要在 Mac OS X 终端中键入命令。”）。

（只是为了记录和上下文：我在 1991 年同时学习了这两者——这似乎对我没有任何伤害。不过，我确实有BASIC、Pascal、Logo 和 LISP的*背景*。 )

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-04-11T16:34:28.950

在写关于 Objective-C 的书之前，我对这个问题想了很多。首先，我真的认为在学习 Objective-C 之前学习 C 语言是错误的道路。C是*程序*包含许多在 Objective-C 中编程不需要的特性的语言，尤其是在新手级别。事实上，诉诸其中一些特性与坚持良好的面向对象编程方法背道而驰。在学习面向对象的语言之前，教授程序语言的所有细节（并使用函数和结构化编程技术解决问题的解决方案）也不是一个好主意。这可能会使程序员朝着错误的方向开始，可能会导致培养错误的方向和思维方式来培养良好的面向对象编程学科。仅仅因为 Objective-C 是 C 语言的扩展并不意味着你必须先学习 C！

我认为将 Objective-C 和底层 C 语言作为单一的集成语言进行教学是正确的方法。没有理由知道“for”语句来自 C 语言，而不是来自其超集 Objective-C 语言。此外，为什么要详细了解诸如 C 数组和字符串（以及操作它们）*之类的东西*例如，学习数组（NSArray）和字符串对象（NSString）？许多 C 文本将大量时间用于结构和指向结构的指针，以及使用指针遍历数组。但是您可以在不了解任何这些 C 语言特性的情况下开始编写 Objective-C 程序。对于新手程序员来说，这很重要。这不仅缩短了学习曲线，而且减少了编写 Objective-C 程序时必须学习的材料量（其中一些有选择地过滤掉）。

我同意你会想要学习大部分（如果不是全部的话）底层 C 特性，但是很多可以推迟到牢牢掌握定义类和方法、使用对象和消息表达式以及理解继承的概念和多态性是很好理解的。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-07T21:44:32.653

我会直接使用Objective C - 如果您已经掌握了几种语言，那么学习曲线不是语法，而是Cocoa。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-07T21:42:52.253

我认为，在大多数情况下，无论你进入哪个领域，学习 C 都是一个好主意，至少在使用预包装商品之前了解软件开发的内部工作原理，这样如果出现问题你有更好的机会了解内部运作。在 SO 上有很多关于这个的讨论，这是一个相当主观的问题，但一般来说，你将在你的 Objective-C 代码中固有地使用 C，所以我想这真的取决于你。我是一个脚踏实地的人，但有时它会妨碍我，我认识几个自上而下的聪明人，我认为重要的部分是你要了解内部运作将你的能力与那些没有能力的人区分开来，同时提高你的能力。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-07T21:50:41.550

在学习Objective-C之前学习C是个好主意，Objective-C是C的严格超集。这意味着Objective-C可以支持所有正常的C代码，所以C程序通用的代码即使在Objective- C 代码。

除了纯粹从语言的角度来看，你会发现 Mac OS X 是一个完整的 Unix 操作系统。所有系统级库都是用 C 编写的。

可能可以同时学习两者，但我认为如果您首先对 C 有扎实的工作知识，您会更加欣赏和理解 Objective-C。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-07T21:49:06.357

我会学习Objective-C，并在学习过程中尽可能多地学习C。

您不太依赖的 C 领域：

*   指针算术和数组。我根本没有使用过 C 数组。
*   C 弦。Objective-C 的字符串做得更好更安全。
*   如果您在 Obj-C 2.1 中使用 GC，请手动管理内存。出于开发速度和性能的原因，我强烈推荐这条路线。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-25T16:04:33.377

当你学习 Objective-C 和 Cocoa 时，你不能避免学习 C 的一些细节。例如，矩形通常由 C 结构 CGRect 表示。

如果您有时间，请务必学习 C。正如其他人在这里所说，Kochan 的书（第二版和第一版）非常适合作为一本书深入了解。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-07T21:43:40.863

有很多事情你不能纯粹用 Objective-C 来做，所以学习一些基本的 C 技能将是非常关键的。您至少需要了解变量声明和基本的 C 库函数，否则您会感到沮丧。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-07T21:40:09.043

更好，我不知道，更不用说我不熟悉 Objective-C。
但是 C 的基础并不难学，它不是一门非常复杂的语言（就语法而言，而不是在掌握方面！），所以去吧，它不会浪费时间。
就个人而言，我认为学习 C 总是一个好主意，它可以很好地了解计算机的工作原理。毕竟，大多数语言和系统仍然是用 C 编写的。那就继续吧！:-)

PS.：我所说的“继续前进”并不是指“放弃”，只是“学习更多，学习不同”。一旦你了解了 C，你可能永远不会放弃它：Java 使用 JNI 为低级的东西调用 C 例程，Python、Lua 等经常用 C 代码扩展（Lua 参考甚至只是假设一些函数的 C 知识只是后面的 C 函数的薄包装器），依此类推。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-07T21:43:43.547

老实说，很多语言都是基于 C 语法的，熟悉它是一件好事。无论如何，我需要一两个星期来熟悉 C。

也就是说，我确实只是自学了 Objective C，而且我必须说实话：我发现我的 C 经验并没有我想象的那么有用。Objective C 绝对让我大开眼界。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-07T21:51:31.313

您可以直接跳入 Objective-C，具有以下好处：

1.  你会在路上学习“一些”C。
2.  您将学习与您相关的 C 部分。

至少对我来说，当我对某些特定的应用程序或示例感兴趣时，学习一门新语言会更容易，而当我必须学习其他不完全是我感兴趣的东西时，我就会失败。

如果您对较低级别的编程感兴趣，您可以随时完善您的 C 知识。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-10-24T15:41:04.583

是的，在任何其他高级语言之前学习 C 语言将帮助您快速学习其他语言。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-07T21:44:27.710

根据[Wikipedia](http://en.wikipedia.org/wiki/Objective-C)，Objective-C 是 C 的严格超集。在这种情况下，我建议先学习 C。然后，当您学习 Objective-C 时，将清楚添加了哪些部分作为 Objective-C 的一部分。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-07T21:44:55.617

C 为您提供了很少的汇编抽象。一些 C 编译器甚至可以让你内联汇编。这对于思考计算机的工作方式非常有用，了解这一点很重要。

话虽这么说，如果您真的对 Object-C 感兴趣，请不要仅仅因为它“对您有好处”而让自己陷入用 C 编写东西的困境。在尝试学习新技能时，您无需自责。重要的是你对你正在做的事情感到开心。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-24T05:52:11.173

你想成为一名铁杆开发者吗？然后先学c。

完全掌握 c 所需的书籍是技术领域的一些最佳著作。这是您需要的：

[C 编程语言](https://rads.stackoverflow.com/amzn/click/com/0131103628)

[标准 C 库](https://rads.stackoverflow.com/amzn/click/com/0131315099)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-01-29T05:27:30.073

Objective C 与 C 有很大的不同，因此不值得首先学习 C。

从语法/语言家族的角度来看，学习 SmallTalk （objective C 所基于的）几乎更好

从实际的角度来看，一次集中精力学习一种语言。

后来，如果您想学习另一种语言，C++、Java 和 Python 1) 易于学习 2) 流行并因此有市场 3) 功能强大。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2010-10-11T16:15:46.497

在开始 Objective_C 之前，你应该对 C 有基本的了解，但没有必要掌握 C 的每一个细节。

我在阅读“Objective-C 编程”后发表了我的笔记，以防它帮助其他人。

[通过编程学习目标 c-](http://www.fernando-rodriguez.com/learn-objective-c-with-programming-in-objecti)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-07T21:41:03.783

根据您已经知道的许多语言，刚开始学习 Objective-C 可能是一个更好的主意。大多数语言的基础基本相同，只是语法不同。在学习 Objective-C 时，首先学习 C 并不会产生太大的影响。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-11-22T10:03:43.597

我直接学了Objective-C，用了一年左右就很好用了，我下载项目看C代码的时候读C代码有点困难，但现在我真的觉得有必要学习C。你可以试试学习没有 C 的 ObjC，但迟早你会需要 C。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-09-09T22:56:59.097

恕我直言，首先应该至少学习一些 C 语言，尤其是指针。如果一个人来自一种没有指针的语言，那就更重要了。很多人问代码，比如

```
NSString *string = [[NSString alloc] init];
string = @"something"; 
```

因为他们不知道指针和它指向的对象之间的区别。

当然，在开始使用 Objective-C 之前，不必学习*所有C，但是一些基本的东西是绝对必要的。*

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-06-08T17:13:14.397

哎呀不，直接去目标C！

我从 ActionScript 3 转到了 Objective C，而且我已经在一家公司实习了！

做你想做的。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-10-11T22:37:56.603

如果您之前学习过其他语言，那么您在编写正确的语法时总是会感到困惑。我不知道目的，但对象 C 使用奇怪（不常见）的语法来调用对象方法。它将其命名为发送消息，是的，因此纯粹的面向对象概念是正确的，但是大多数面向对象的语言将其命名为调用方法并使用更传统的调用方法语法。垃圾收集也很奇怪，对象 C 是基于旧的引用计数。因此，如果您从其他语言切换，您将很难接受它。我正在为 C/C++ 程序员写一本书对象 C 快速迁移指南，希望能帮助人们更快地了解所有差异。

# vb.net - 选项卡控件的粗体文本

> ID：180563
> 
> 赞同：6
> 
> 时间：2008-10-07T21:41:10.243
> 
> 标签：vb.net, winforms

我想在某些条件下（不一定是 GotFocus）将标签页的文本加粗。唯一的最简单的方法是覆盖选项卡控件的 DrawItem 事件，这是真的吗？

[http://www.vbforums.com/showthread.php?t=355093](http://www.vbforums.com/showthread.php?t=355093)

似乎应该有一个更简单的方法。

喜欢 ...

`tabControl.TabPages(index).Font = New Font(Me.Font, FontStyle.Bold)`

这显然行不通。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T22:01:45.537

当您在 TabPage 上设置 Font 属性时，您正在为该选项卡页上的所有控件设置默认字体。但是，您没有为标题设置它。

当您执行以下代码时：

```
tabControl.TabPages(index).Font = New Font(Me.Font, FontStyle.Bold) 
```

该页面上的任何控件现在默认情况下都是粗体，这不是（我假设）你想要的。

页眉的字体（即选项卡本身）由 TabControl 的 Font 属性控制。如果您要将代码更改为：

```
tabControl.Font = New Font(Me.Font, FontStyle.Bold) 
```

你会在行动中看到这一点。**但是，它会更改显示的所有**选项卡的字体，我假设这也不是您想要的。

因此，使用默认的 WinForms 选项卡控件，您（我相信）仅限于您发布的链接中的技术。或者，您可以开始查看 3rd-party 控件，例如在[StackOverflow上的](https://stackoverflow.com/questions/169357/net-usercontrols-telerik-devexpress-infragistics-componentone-whos-best#170227)[这些](https://stackoverflow.com/questions/162413/what-is-the-best-commercial-3rd-party-control-library-out-right-now#162463) [问题](https://stackoverflow.com/questions/178661/recommended-c-winform-controls-packs#178671)中讨论的那些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T18:22:03.093

根据字段值为选项卡控件提供不同标签的一种简单方法是更改​​标题本身：

例如：

```
Private Sub Form_Current()
    If IsNull(Me.Subform.Form.Field_Name) Then
        Me.Tab_Name.Caption = "Tab One"
    Else
        Me.Tab_Name.Caption = "Tab One +++"
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-09T14:00:19.403

```
private void tabControl1_DrawItem(object sender, DrawItemEventArgs e)
{
    Font BoldFont = new Font(tabControl1.Font, FontStyle.Bold);
    e.Graphics.DrawString(tabControl1.TabPages[e.Index].Text, BoldFont, Brushes.Black, e.Bounds);
}

private void Form1_Paint(object sender, PaintEventArgs e)
{
    tabControl1.DrawMode = TabDrawMode.OwnerDrawFixed;
} 
```

# web-services - 定义肥皂服务（通用与特定操作）的最佳实践是什么？

> ID：180572
> 
> 赞同：7
> 
> 时间：2008-10-07T21:43:49.707
> 
> 标签：web-services, soap, wsdl

我的情况如下：

我有一个规范化的数据库，其中保存了有关机场的地理信息。结构是：

```
airport --is in--> city --is in--> country --is in--> continent 
```

现在我想让用户管理这些数据，而不是让他们直接访问数据库。我们需要通过 Web 服务提供这个管理界面。

现在，在设计服务时，我们遇到了关于如何定义操作的讨论。我们提出了不同的解决方案：

**方案A：具体操作**

对于四个表（机场、城市、国家、大陆）中的每一个，我们定义了 3 个操作：

*   插入
*   得到
*   更新

这将导致 2 个请求/响应对象 = 24 个对象的 12 个操作

要创建一个具有所有依赖项的全新机场，至少需要 4 个请求。

**解决方案 B：通用**

只有一种操作，通过参数控制。此操作能够创建管理数据库所需的一切。

该操作将决定需要做什么并执行它。如果发生错误，它将回滚所有内容。

==> 1 个操作 = 2 个高度复杂的请求/响应对象

**解决方案 C：在中间见面 1**

每个表一个通用操作，能够执行 get、insert、update，就像解决方案 B 一样，但每个表都集中在一个表上。

==> 4 个操作 = 8 个复杂的请求/响应对象

**方案 D：在中间相遇 2**

每个操作（get、insert、delete）一个通用操作，它可以在每个表上工作并解决依赖关系。

==> 3 个操作 = 6 个稍微复杂的请求/响应对象

**例子**

由于这是相当抽象的，因此为创建请求对象提供了一个简化示例（JFK/New York/USA/North America）：

**解决方案 A：**

请求 1/4：

```
<insertContinent>North America</insertContinent> 
```

请求 2/4：

```
<insertCountry continent="North America">USA</insertCountry> 
```

请求 3/4：

```
<insertCity country="USA">New York</insertCity> 
```

请求 4/4：

```
<insertAirport city="New York">JFK</insertAirport> 
```

**解决方案 B：**

请求 1/1：

```
<action type="insertCountry" parent="North America">USA</action>
<action type="insertAirport" parent="New York">JFK</action>
<action type="insertContinent" parent="">North America</action>
<action type="insertCity" parent="USA">New York</action> 
```

**解决方案 C：**

请求 1/4：

```
<countryAction type="insert" parent="North America">USA</countryAction> 
```

请求 2/4：

```
<airportAction type="insert" parent="New York">JFK</airportAction> 
```

请求 3/4：

```
<continentAction type="insert" parent="">North America</continentAction > 
```

请求 4/4：

```
<cityAction type="insert" parent="USA">New York</cityAction > 
```

**解决方案 D：** 请求 1/1：

```
<insert airport="JFK" city="New York" country="USA" continent="North America" /> 
```

解决方案 D 对我来说似乎相当优雅，因此我尝试将其放入 XSD：

代码：

```
<complexType name="NewContinent">
    <sequence>
        <element name="NAME" type="string"></element>
    </sequence>
</complexType>

<complexType name="NewCountry">
    <sequence>
        <element name="ISOCODE" type="string"></element>
        <element name="NAME" type="string"></element>
        <choice>
            <element name="newCONTINENT" type="tns:NewContinent"></element>
            <element name="CONTINENT" type="string"></element>
        </choice>
    </sequence>
</complexType>

<complexType name="NewCity">
    <sequence>
        <element name="IATA" type="string"></element>
        <element name="NAME" type="string"></element>
        <choice>
            <element name="COUNTRY" type="string"></element>
            <element name="newCOUNTRY" type="tns:NewCountry"></element>
        </choice>
    </sequence>

</complexType>

<complexType name="NewAirport">
    <sequence>
        <element name="IATA" type="string"></element>
        <element name="NAME" type="string"></element>
        <choice>
            <element name="CITY" type="string"></element>
            <element name="newCITY" type="tns:NewCity"></element>
        </choice>
    </sequence>

</complexType> 
```

相应的请求将如下所示：

```
<complexType name="Request">
    <choice>
        <element name="AIRPORT" type="tns:NewAirport"></element>
        <element name="CITY" type="tns:NewCity"></element>
        <element name="COUNTRY" type="tns:NewCountry"></element>
        <element name="CONTINENT" type="tns:NewContinent"></element>
    </choice>
</complexType> 
```

现在我的问题是：**这真的是最好的解决方案吗？XSD 是否足以理解，这是怎么回事？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T19:42:06.737

大概您正在编写一个可以理解您的不同消息类型的协议层。您还需要一个应用层来解析消息的内容。您提到的不同方法将转移这两层之间的解析负担。例如：

**解决方案 A**：协议层完成所有解析并返回数据和命令。应用层只能使用数据。这也称为 RPC 模式。

优点：您可以验证您的消息。您可以将消息直接映射到应用程序调用。

缺点：如果您需要更改接口，则您的协议会更改。

**解决方案 B**：协议层返回两个值和一个命令。应用层必须使用命令将值解析为类型。

优点：协议永远不会改变。

缺点：您无法验证消息。您的应用程序代码更复杂。

**解决方案 C**：协议层返回两个已知类型和一个必须解析的命令。应用层可以只解析命令并使用数据。

优点：我想不出，似乎不是一个很好的折衷方案。

缺点：仅部分完成解析。

**解决方案 D**：协议层返回已知类型（您实现它的方式）和通用命令。应用层必须查看它接收到的数据并将通用命令转换为特定命令。这类似于 REST 架构。

优点：调用是不同的操作，因此您可以例如缓存获取响应。

缺点：应用层的复杂性

REST 模型的实现方式通常与您所概述的不同。它使用 HTTP GET、POST、PUT、DELETE 消息来传递任意文档。参数作为 URL 的一部分给出。例如：

```
<insert airport="JFK" city="New York" country="USA" continent="North America" /> 
```

变成

```
<insert URL="airport?city=Chicago">ORD</insert> 
```

或者，如果您使用的是 HTTP，它会成为对机场 URL 的 POST 请求，其中包含城市的参数，内容是有关机场的信息。请注意，在您拥有多个元素和混合类型的更复杂的数据中，其中一些变得更加清晰。例如，如果您想发送机场缩写、全名和海拔高度。

我认为 REST 架构可以很好地用于您描述的界面。只要您需要做的就是支持 CRUD 操作。有许多网站可以为您提供 REST 架构风格的优缺点。

我个人更喜欢带有一些 REST-ful 属性的 RPC 样式（解决方案 A）。我希望协议完成解析工作并验证消息。这通常是人们实现 SOAP Web 服务接口的方式。

您的界面今天可能看起来很简单，但明天您的一位客户会要求您进行一个不太适合 REST 模型的新呼叫，您会发现自己将其嵌入到现有的四个消息中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-17T17:13:36.703

这是一个老问题，我敢肯定该服务是很久以前写的，但无论如何我想提供一个答案。

RESTful 方法是定义一个机场资源，例如：

```
<airport href="/airports/JFK">
    <name>JFK</name>
    <city>New York</city>
    <country>USA</country>
    <continent>North America</continent>
</airport> 
```

或者，如果您想使用与浏览器兼容的微格式：

```
<div class="object airport" href="/airports/JFK">
    <ul class="attributes"> 
        <li class="name">JFK</li>
        <li class="city">New York</li>
        <li class="country">USA</li>
        <li class="continent">North America</li>
    </ul>
</div> 
```

此资源将位于类似 的 URI 中`/airports/JFK`，该 URI 将使用方法检索、使用`GET`方法更新并使用`PUT`方法删除`DELETE`。

在这样的设计中，URI`/airports/`将代表数据库中所有机场的容器资源，并且 URI 类似于容器`/airports/?city=New+York`上`/airports/?country=USA`的过滤器，以返回机场的子集。这两个都是`GET`方法，资源将包含上面定义的机场资源列表，可以是完整的（因为它们很小），也可以是一些有用的属性，并且`href`指向每个机场的完整资源。

最后，添加新资源可以是`PUT`机场完整 URI 上的方法，`POST`也可以是`/airports/`. 在这两种情况下，请求的主体都是机场资源，如上所示。方法之间的区别在于谁来决定机场的最终 URI：客户端决定，`PUT`服务决定`POST`。您使用哪一种取决于您的客户是否可以合理地确定正确的 URI。通常服务会做出决定，因为 URI 包含一个数字唯一标识符，并且服务必须选择它。

当然，您最初的问题是关于 SOAP，而不是 REST。我将继续按照我所描述的那样设置一个 RESTful 设计，然后将我的资源描述为使用 XSD 和 SOAP 服务的复杂类型，该服务具有复制RESTful 服务的 、 、 和 操作`GET`的`PUT`操作`DELETE`。`POST`这将为您提供 RPC 等价物：

```
class Airport
    has String name
    has String city
    has String country
    has String continent
    method void update(name, city, country, continent)
    method void delete()

class AirportList
    method Airport[] get(opt name, opt city, opt country, opt continent)
    method void add(name, city, country, continent) 
```

# filesystems - 有人对 ZFS 有经验吗？

> ID：180586
> 
> 赞同：8
> 
> 时间：2008-10-07T21:46:58.890
> 
> 标签：filesystems, zfs

我正在考虑采用[ZFS](http://opensolaris.org/os/community/zfs/)，我很高兴知道您在生产和测试环境中的经验。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T23:14:58.493

我没有在生产中使用 ZFS - 还没有机会。好吧，基本上我们目前不需要巨大的存储空间，而且直到最近我们还没有运行任何 7.0。

在家里，我有一个更先进的 FreeBSD 系统（7.0-ish）。我已经使用 ZFS 快八个月了。我目前有一个 1.2 TB 在我的*坦克*。我非常喜欢 ZFS，原因有很多：

*   按需扩展我的文件系统
*   从“廉价”磁盘存储
*   文件系统快照
*   自我修复
*   *副本*（这可能是最棒的）

如果您想尝试一下并喜欢 FreeBSD，我推荐[FreeBSD wiki](http://wiki.freebsd.org/ZFS)。

我遇到了一些在 wiki 上概述的问题，并且我从 irc（#freebsdhelp @ Efnet）上的人们那里得到了很多帮助/反馈。虽然我没有丢失任何数据。:) （敲木头！）如果您正在寻找更多反馈，您可以查看 IRC。有很多人在运行 ZFS 池。

除了 FreeBSD，ZFS 在 sun 平台上已经存在了一段时间。因为我在 FreeBSD 上运行的是一个移植版，而且还有很多工作正在进行中，所以它在那里更加成熟。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T22:12:17.137

你打算用它做什么？大多数关于文件系统的问题只有在对应用程序和使用模式有很好的理解时才能得到明智的回答。例如，适用于传统邮件假脱机文件系统的可能不是您为数据库存储选择的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T02:11:08.917

我将它用作安装了 OpenSolaris 的机器上的低租金近线存储系统。我把它放在一个基本的镜像 RAID 系统上，有 30 天的快照。不止一次它救了我的培根，那是在一个非常基本的设置上。我只能想象在更严肃/功能更强大的硬件上你能用它做多少。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T13:27:44.267

作为 Linux 商店的系统管理员，我使用 ZFS 作为备份服务器。曾经运行 cronjob 来做快照，但现在我使用 SXCE 附带的 zfs-auto-snapshot 服务。备份是 NFS 导出并自动安装在网络中的所有机器上 - 因此人们可以自己恢复文件 - 甚至快照也通过网络导出！

我什至从所有 linux 机器上都挂载了我的主目录 NFS - 所以我每小时都会获得我日常工作的快照。

虽然 ZFS 并不完美，但它确实似乎是当今可用的最好的文件系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-15T19:03:42.117

我在两个环境中进行开发和使用 ZFS：

1) 在我的带有 RAIDZ2 的 Mac Pro 上超过四张光盘

2) 在一个DesktopBSD（基于FreeBSD）的备份服务器上，在RAIDZ1中有两个磁盘

我的总体经验是，我第一次不必每天备份数据，因为我看到 ZFS 似乎是我用过的最可靠的存储系统。

# c++ - 在 C++ 中使用“超级”

> ID：180601
> 
> 赞同：222
> 
> 时间：2008-10-07T21:49:42.770
> 
> 标签：c++, coding-style

我的编码风格包括以下成语：

```
class Derived : public Base
{
   public :
      typedef Base super; // note that it could be hidden in
                          // protected/private section, instead

      // Etc.
} ; 
```

这使我能够使用“super”作为 Base 的别名，例如，在构造函数中：

```
Derived(int i, int j)
   : super(i), J(j)
{
} 
```

甚至在从其覆盖版本中的基类调用方法时：

```
void Derived::foo()
{
   super::foo() ;

   // ... And then, do something else
} 
```

它甚至可以被链接起来（不过，我仍然需要找到它的用途）：

```
class DerivedDerived : public Derived
{
   public :
      typedef Derived super; // note that it could be hidden in
                             // protected/private section, instead

      // Etc.
} ;

void DerivedDerived::bar()
{
   super::bar() ; // will call Derived::bar
   super::super::bar ; // will call Base::bar

   // ... And then, do something else
} 
```

无论如何，我发现“typedef super”的使用非常有用，例如，当 Base 是冗长和/或模板化时。

事实是 super 是用 Java 和 C# 实现的（它被称为“base”，除非我错了）。但是 C++ 缺少这个关键字。

所以，我的问题：

*   在您使用的代码中，这种使用 typedef 是超级常见/罕见/从未见过的吗？
*   这种使用 typedef 是否超级好（即您是否看到了不使用它的强烈或不那么强烈的理由）？
*   “超级”应该是一件好事，它是否应该在 C++ 中有所标准化，或者通过 typedef 使用它已经足够了吗？

**编辑：** Roddy 提到 typedef 应该是私有的。这意味着任何派生类都无法在不重新声明的情况下使用它。但我想它也会阻止 super::super 链接（但谁会为此哭泣呢？）。

**编辑2：**现在，在大量使用“超级”几个月后，我完全同意罗迪的观点：“超级”应该是私有的。我会两次赞成他的回答，但我想我不能。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2008-10-07T22:00:31.997

Bjarne Stroustrup 在 C++ 的*设计和演进中*`super`提到，在C++ 第一次标准化时，ISO C++ 标准委员会考虑将其作为关键字。

Dag Bruck 提出了这个扩展，称基类为“继承的”。该提案提到了多重继承问题，并且会标记出模棱两可的用途。甚至 Stroustrup 也深信不疑。

经过讨论，Dag Bruck（是的，提出提案的人）写道，该提案是可实施的、技术上合理的、没有重大缺陷的，并且处理了多重继承。另一方面，没有足够的收益，委员会应该处理一个更棘手的问题。

Michael Tiemann 迟到了，然后证明 typedef'ed super 可以正常工作，使用的技术与本文中提到的相同。

所以，不，这可能永远不会标准化。

如果您没有副本，*Design and Evolution*非常物有所值。使用过的副本大约需要 10 美元。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2008-10-07T22:00:36.537

我一直使用“继承”而不是超级。（可能是由于 Delphi 背景），并且我总是将其设为**私有**，以避免在类中错误地省略“继承”但子类尝试使用它时出现问题。

```
class MyClass : public MyBase
{
private:  // Prevents erroneous use by other classes.
  typedef MyBase inherited;
... 
```

我用于创建新类的标准“代码模板”包括 typedef，所以我几乎没有机会意外地忽略它。

我不认为链接的“super::super”建议是一个好主意——如果你这样做，你可能会很难与特定的层次结构联系起来，并且改变它可能会严重破坏东西。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-10-07T21:59:03.797

这样做的一个问题是，如果您忘记（重新）为派生类定义 super，那么对 super::something 的任何调用都可以正常编译，但可能不会调用所需的函数。

例如：

```
class Base
{
public:  virtual void foo() { ... }
};

class Derived: public Base
{
public:
    typedef Base super;
    virtual void foo()
    {
        super::foo();   // call superclass implementation

        // do other stuff
        ...
    }
};

class DerivedAgain: public Derived
{
public:
    virtual void foo()
    {
        // Call superclass function
        super::foo();    // oops, calls Base::foo() rather than Derived::foo()

        ...
    }
}; 
```

（正如 Martin York 在对此答案的评论中指出的那样，可以通过将 typedef 设为私有而不是公共或受保护来消除此问题。）

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-07T22:51:55.153

FWIW Microsoft在其编译器中添加了[__super的扩展。](http://msdn.microsoft.com/en-us/library/94dw1w7x(VS.80).aspx)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-10-07T22:00:46.397

Super（或继承）是非常好的事情，因为如果您需要在 Base 和 Derived 之间添加另一个继承层，您只需更改两件事：1.“类 Base: foo”和 2\. typedef

如果我没记错的话，C++ 标准委员会正在考虑为此添加一个关键字……直到 Michael Tiemann 指出这种 typedef 技巧有效。

至于多重继承，因为它在程序员的控制之下，你可以做任何你想做的事情：可能是 super1 和 super2，或者其他。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-10-07T21:54:17.877

我不记得以前看过这个，但乍一看我喜欢它。正如[Ferruccio](https://stackoverflow.com/questions/180601/using-super-in-c#180607)所指出的，它在 MI 面前效果不佳，但 MI 更多的是例外而不是规则，没有什么说某些东西需要在任何地方都可用才能有用。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-04-11T14:22:32.767

我刚刚找到了另一种解决方法。我对今天困扰我的 typedef 方法有一个大问题：

*   typedef 需要类名的精确副本。如果有人更改了类名但没有更改 typedef，那么您将遇到问题。

所以我想出了一个更好的解决方案，使用一个非常简单的模板。

```
template <class C>
struct MakeAlias : C
{ 
    typedef C BaseAlias;
}; 
```

所以现在，而不是

```
class Derived : public Base
{
private:
    typedef Base Super;
}; 
```

你有

```
class Derived : public MakeAlias<Base>
{
    // Can refer to Base as BaseAlias here
}; 
```

在这种情况下，`BaseAlias`它不是私有的，我试图通过选择一个应该提醒其他开发人员的类型名称来防止粗心的使用。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-08T09:17:16.953

我已经在许多代码库中看到过这个习惯用法，而且我很确定我什至在 Boost 的库中的某个地方看到过它。但是，据我所知，最常见的名称是`base`(or `Base`) 而不是`super`.

如果使用类模板，这个习惯用法特别有用。例如，考虑以下类（来自[真实项目](http://www.seqan.de/)）：

```
template <typename TText, typename TSpec>
class Finder<Index<TText, PizzaChili<TSpec>>, MyFinderType>
    : public Finder<Index<TText, MyFinderImpl<TSpec>>, Default>
{
    using TBase = Finder<Index<TText, MyFinderImpl<TSpec>>, Default>;
    // …
} 
```

继承链使用类型参数来实现编译时多态性。不幸的是，这些模板的嵌套级别非常高。因此，完整类型名称的有意义的缩写对于可读性和可维护性至关重要。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-07T21:52:59.143

我经常看到它被使用，有时作为 super_t，当基础是复杂的模板类型时（`boost::iterator_adaptor`例如，这样做）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-07T21:59:53.670

*在您使用的代码中，这种使用 typedef 是超级常见/罕见/从未见过的吗？*

我从未在我使用的 C++ 代码中看到过这种特殊模式，但这并不意味着它不存在。

*这种使用 typedef 是否超级好（即您是否看到了不使用它的强烈或不那么强烈的理由）？*

它不允许多重继承（无论如何都是干净的）。

*“超级”应该是一件好事，它是否应该在 C++ 中有所标准化，或者通过 typedef 使用它已经足够了吗？*

由于上述原因（多重继承），没有。您在列出的其他语言中看到“super”的原因是它们仅支持单继承，因此对于“super”所指的内容没有混淆。当然，在那些语言中它很有用，但它在 C++ 数据模型中并没有真正的位置。

哦，仅供参考：C++/CLI 以“__super”关键字的形式支持这个概念。但请注意，C++/CLI 也不支持多重继承。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-07T22:22:43.247

为超类使用 typedef 的另一个原因是当您在对象的继承中使用复杂的模板时。

例如：

```
template <typename T, size_t C, typename U>
class A
{ ... };

template <typename T>
class B : public A<T,99,T>
{ ... }; 
```

在 B 类中，最好有一个 A 的 typedef，否则你会被困在任何你想引用 A 成员的地方重复它。

在这些情况下，它也可以使用多重继承，但你不会有一个名为“super”的 typedef，它会被称为“base_A_t”或类似的东西。

--杰夫克++

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-07T21:56:49.867

在当天从 Turbo Pascal 迁移到 C++ 之后，我曾经这样做是为了获得 Turbo Pascal“继承”关键字的等效项，它的工作方式相同。然而，在用 C++ 编程了几年之后，我停止了它。我发现我只是不太需要它。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-07-24T19:29:54.523

我试图解决这个完全相同的问题；我提出了一些想法，例如使用可变参数模板和包扩展以允许任意数量的父母，但我意识到这将导致像“super0”和“super1”这样的实现。我把它扔掉了，因为这比一开始就没有它几乎没有用。

我的解决方案涉及一个助手类`PrimaryParent`，并按如下方式实现：

```
template<typename BaseClass>
class PrimaryParent : virtual public BaseClass
{
protected:
    using super = BaseClass;
public:
    template<typename ...ArgTypes>
    PrimaryParent<BaseClass>(ArgTypes... args) : BaseClass(args...){}
} 
```

然后，您要使用的任何类都将被声明为：

```
class MyObject : public PrimaryParent<SomeBaseClass>
{
public:
    MyObject() : PrimaryParent<SomeBaseClass>(SomeParams) {}
} 
```

为了避免在`PrimaryParent`on中使用虚拟继承，使用`BaseClass`带有可变数量参数的构造函数来允许构造`BaseClass`.

into`public`继承背后的原因是尽管在它们之间有一个帮助类，但可以完全控制继承。`BaseClass``PrimaryParent``MyObject``BaseClass`

这确实意味着您想要拥有的每个类都`super`必须使用`PrimaryParent`辅助类，并且每个孩子只能从一个使用`PrimaryParent`的类继承（因此得名）。

此方法的另一个限制是`MyObject`只能继承一个继承自 的类`PrimaryParent`，并且该类必须使用 继承`PrimaryParent`。这就是我的意思：

```
class SomeOtherBase : public PrimaryParent<Ancestor>{}

class MixinClass {}

//Good
class BaseClass : public PrimaryParent<SomeOtherBase>, public MixinClass
{}

//Not Good (now 'super' is ambiguous)
class MyObject : public PrimaryParent<BaseClass>, public SomeOtherBase{}

//Also Not Good ('super' is again ambiguous)
class MyObject : public PrimaryParent<BaseClass>, public PrimaryParent<SomeOtherBase>{} 
```

在你放弃这个选项之前，因为看起来有很多限制，而且每个继承之间都有一个中间人类，这些事情还不错。

多重继承是一个强大的工具，但在大多数情况下，只有一个主父级，如果有其他父级，它们很可能是 Mixin 类，或者`PrimaryParent`无论如何都不会继承的类。如果仍然需要多重继承（尽管在许多情况下使用组合来定义对象而不是继承会受益），而不是仅仅`super`在该类中显式定义并且不继承自`PrimaryParent`.

必须在每个类中定义的想法对`super`我来说不是很有吸引力，使用`PrimaryParent`allow for `super`，显然是一个基于继承的别名，留在类定义行而不是数据应该去的类主体中。

那可能只是我。

当然，每种情况都不同，但是在决定使用哪个选项时，请考虑我所说的这些事情。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-07T21:55:39.513

我不知道这是否罕见，但我确实做过同样的事情。

正如已经指出的那样，使这部分语言本身的困难在于当类使用多重继承时。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-07T21:57:45.887

我不时使用它。就在我发现自己多次键入基类类型时，我将用与您的类似的 typedef 替换它。

我认为它可以是一个很好的用途。正如你所说，如果你的基类是一个模板，它可以节省打字。此外，模板类可以接受作为模板应该如何工作的策略的参数。只要基础接口保持兼容，您就可以自由更改基础类型，而无需修复对它的所有引用。

我认为通过 typedef 使用已经足够了。无论如何，我看不出它是如何内置到语言中的，因为多重继承意味着可以有许多基类，所以你可以在你认为适合你逻辑上认为是最重要基类的类时对它进行 typedef。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-05-05T17:53:33.637

除了提供带有注释的代码之外，我不会说太多，这表明 super 并不意味着调用 base！

`super != base.`

简而言之，“超级”到底是什么意思？那么“基础”应该是什么意思？

1.  super 表示，调用方法的最后一个实现者（不是基方法）
2.  base 表示，选择哪个类是多重继承中的默认基类。

这 2 条规则适用于类 typedef。

考虑图书馆实施者和图书馆用户，谁是超级谁是基础？

有关更多信息，这里是将复制粘贴到您的 IDE 中的工作代码：

```
#include <iostream>

// Library defiens 4 classes in typical library class hierarchy
class Abstract
{
public:
    virtual void f() = 0;
};

class LibraryBase1 :
    virtual public Abstract
{
public:
    void f() override
    {
        std::cout << "Base1" << std::endl;
    }
};

class LibraryBase2 :
    virtual public Abstract
{
public:
    void f() override
    {
        std::cout << "Base2" << std::endl;
    }
};

class LibraryDerivate :
    public LibraryBase1,
    public LibraryBase2
{
    // base is meaningfull only for this class,
    // this class decides who is my base in multiple inheritance
private:
    using base = LibraryBase1;

protected:
    // this is super! base is not super but base!
    using super = LibraryDerivate;

public:
    void f() override
    {
        std::cout << "I'm super not my Base" << std::endl;
        std::cout << "Calling my *default* base: " << std::endl;
        base::f();
    }
};

// Library user
struct UserBase :
    public LibraryDerivate
{
protected:
    // NOTE: If user overrides f() he must update who is super, in one class before base!
    using super = UserBase; // this typedef is needed only so that most derived version
    // is called, which calls next super in hierarchy.
    // it's not needed here, just saying how to chain "super" calls if needed

    // NOTE: User can't call base, base is a concept private to each class, super is not.
private:
    using base = LibraryDerivate; // example of typedefing base.

};

struct UserDerived :
    public UserBase
{
    // NOTE: to typedef who is super here we would need to specify full name
    // when calling super method, but in this sample is it's not needed.

    // Good super is called, example of good super is last implementor of f()
    // example of bad super is calling base (but which base??)
    void f() override
    {
        super::f();
    }
};

int main()
{
    UserDerived derived;
    // derived calls super implementation because that's what
    // "super" is supposed to mean! super != base
    derived.f();

    // Yes it work with polymorphism!
    Abstract* pUser = new LibraryDerivate;
    pUser->f();

    Abstract* pUserBase = new UserBase;
    pUserBase->f();
} 
```

这里的另一个重要点是：

1.  多态调用：向下调用
2.  super call：向上调用

在里面，`main()`我们使用了 super 向上调用的多态调用 downards，在现实生活中并不是很有用，但它展示了不同之处。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-08T09:12:20.863

我使用 __super 关键字。但它是微软特有的：

[http://msdn.microsoft.com/en-us/library/94dw1w7x.aspx](http://msdn.microsoft.com/en-us/library/94dw1w7x.aspx)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-02-15T23:18:08.030

这是我使用的一种方法，它使用宏而不是 typedef。我知道这不是 C++ 做事的方式，但是当只有层次结构最下方的基类对继承的偏移量起作用时，通过继承将迭代器链接在一起时会很方便。

例如：

```
// some header.h

#define CLASS some_iterator
#define SUPER_CLASS some_const_iterator
#define SUPER static_cast<SUPER_CLASS&>(*this)

template<typename T>
class CLASS : SUPER_CLASS {
   typedef CLASS<T> class_type;

   class_type& operator++();
};

template<typename T>
typename CLASS<T>::class_type CLASS<T>::operator++(
   int)
{
   class_type copy = *this;

   // Macro
   ++SUPER;

   // vs

   // Typedef
   // super::operator++();

   return copy;
}

#undef CLASS
#undef SUPER_CLASS
#undef SUPER 
```

我使用的通用设置使得在具有重复代码但必须被覆盖的继承树之间读取和复制/粘贴变得非常容易，因为返回类型必须与当前类匹配。

可以使用小写`super`来复制 Java 中的行为，但我的编码风格是对宏使用所有大写字母。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-12-28T01:33:03.600

为什么 c++ 不支持“super”关键字的简单答案是。

DDD（Deadly Diamond of Death）问题。

在多重继承中。编译器会混淆哪个是超类。

[![在此处输入图像描述](https://i.stack.imgur.com/IvleG.png)](https://i.stack.imgur.com/IvleG.png)

那么哪个超类是“D”的超类？“Both”不能成为解决方案，因为“super”关键字是指针。

# python - 如何在 python 中将 ascii 值列表转换为字符串？

> ID：180606
> 
> 赞同：84
> 
> 时间：2008-10-07T21:51:01.610
> 
> 标签：python, string, ascii

我在 Python 程序中有一个列表，其中包含一系列数字，这些数字本身就是 ASCII 值。如何将其转换为可以回显到屏幕的“常规”字符串？

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2008-10-07T21:54:33.040

您可能正在寻找“chr()”：

```
>>> L = [104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]
>>> ''.join(chr(i) for i in L)
'hello, world' 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-08T01:22:05.087

与其他人相同的基本解决方案，但我个人更喜欢使用 map 而不是列表理解：

```
 >>> L = [104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]
>>> ''.join(map(chr,L))
'hello, world' 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-08T20:22:31.633

```
import array
def f7(list):
    return array.array('B', list).tostring() 
```

来自[Python 模式 - 优化轶事](http://www.python.org/doc/essays/list2str.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-07T21:55:06.970

```
l = [83, 84, 65, 67, 75]

s = "".join([chr(c) for c in l])

print s 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-04-04T06:50:34.487

您可以使用它`bytes(list).decode()`来执行此操作 - 并`list(string.encode())`取回值。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-12-13T00:35:37.630

也许不像 Pyhtonic 一个解决方案，但对于像我这样的菜鸟来说更容易阅读：

```
charlist = [34, 38, 49, 67, 89, 45, 103, 105, 119, 125]
mystring = ""
for char in charlist:
    mystring = mystring + chr(char)
print mystring 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-08-04T03:42:20.930

```
def working_ascii():
    """
        G    r   e    e    t    i     n   g    s    !
        71, 114, 101, 101, 116, 105, 110, 103, 115, 33
    """

    hello = [71, 114, 101, 101, 116, 105, 110, 103, 115, 33]
    pmsg = ''.join(chr(i) for i in hello)
    print(pmsg)

    for i in range(33, 256):
        print(" ascii: {0} char: {1}".format(i, chr(i)))

working_ascii() 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-14T06:40:10.113

我已经计时了现有的答案。要重现的代码如下。TLDR 是`bytes(seq).decode()`迄今为止最快的。结果在这里：

```
 test_bytes_decode : 12.8046 μs/rep
     test_join_map : 62.1697 μs/rep
test_array_library : 63.7088 μs/rep
    test_join_list : 112.021 μs/rep
test_join_iterator : 171.331 μs/rep
    test_naive_add : 286.632 μs/rep 
```

设置为 CPython 3.8.2（32 位）、Windows 10、i7-2600 3.4GHz

有趣的观察：

*   “官方”最快的答案（由 Toni Ruža 转发）现在对于 Python 3 来说已经过时了，但一旦修复，基本上仍然排在第二位
*   加入映射序列的速度几乎是列表理解的两倍
*   列表理解比它的非列表对应物更快

要重现的代码在这里：

```
import array, string, timeit, random
from collections import namedtuple

# Thomas Wouters (https://stackoverflow.com/a/180615/13528444)
def test_join_iterator(seq):
    return ''.join(chr(c) for c in seq)

# community wiki (https://stackoverflow.com/a/181057/13528444)
def test_join_map(seq):
    return ''.join(map(chr, seq))

# Thomas Vander Stichele (https://stackoverflow.com/a/180617/13528444)
def test_join_list(seq):
    return ''.join([chr(c) for c in seq])

# Toni Ruža (https://stackoverflow.com/a/184708/13528444)
# Also from https://www.python.org/doc/essays/list2str/
def test_array_library(seq):
    return array.array('b', seq).tobytes().decode()  # Updated from tostring() for Python 3

# David White (https://stackoverflow.com/a/34246694/13528444)
def test_naive_add(seq):
    output = ''
    for c in seq:
        output += chr(c)
    return output

# Timo Herngreen (https://stackoverflow.com/a/55509509/13528444)
def test_bytes_decode(seq):
    return bytes(seq).decode()

RESULT = ''.join(random.choices(string.printable, None, k=1000))
INT_SEQ = [ord(c) for c in RESULT]
REPS=10000

if __name__ == '__main__':
    tests = {
        name: test
        for (name, test) in globals().items()
        if name.startswith('test_')
    }

    Result = namedtuple('Result', ['name', 'passed', 'time', 'reps'])
    results = [
        Result(
            name=name,
            passed=test(INT_SEQ) == RESULT,
            time=timeit.Timer(
                stmt=f'{name}(INT_SEQ)',
                setup=f'from __main__ import INT_SEQ, {name}'
                ).timeit(REPS) / REPS,
            reps=REPS)
        for name, test in tests.items()
    ]
    results.sort(key=lambda r: r.time if r.passed else float('inf'))

    def seconds_per_rep(secs):
        (unit, amount) = (
            ('s', secs) if secs > 1
            else ('ms', secs * 10 ** 3) if secs > (10 ** -3)
            else ('μs', secs * 10 ** 6) if secs > (10 ** -6)
            else ('ns', secs * 10 ** 9))
        return f'{amount:.6} {unit}/rep'

    max_name_length = max(len(name) for name in tests)
    for r in results:
        print(
            r.name.rjust(max_name_length),
            ':',
            'failed' if not r.passed else seconds_per_rep(r.time)) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-12-09T10:42:33.723

```
Question = [67, 121, 98, 101, 114, 71, 105, 114, 108, 122]
print(''.join(chr(number) for number in Question)) 
```

# internet-explorer - 如何在 Internet Explorer（7 和 8 Beta 2）中删除（而不是禁用）ActiveX 加载项？

> ID：180624
> 
> 赞同：13
> 
> 时间：2008-10-07T21:57:49.053
> 
> 标签：internet-explorer, activex

我正在开发一种使用 ActiveX 控件的解决方案（我们购买的商业控件，但我没有开发）。我需要开发正确的安装页面来模拟当一个从未访问过该站点并且没有安装附加组件的用户来到该页面时会发生什么。

我在 Internet 选项中找到了“管理加载项”位，但我没有任何运气。

在 IE7 中，我看到了启用或禁用任何控件的功能以及“删除 ActiveX”选项，但对于此特定控件，它已禁用。

在 IE8 Beta 2 中，“管理加载项”位已完全重新设计，我不再看到删除控件的选项。每个控件都有一个“属性”对话框，我可以“删除”它，但该按钮似乎没有做任何事情（可能与“删除 ActiveX”在 IE7 中对此不起作用有关）。

看起来这个控件的安装方式可能是仅仅从 IE 中删除它是行不通的或不允许的，但它不是一个在 XP 中的“添加/删除程序”菜单上有自己的条目的控件，所以我可以也不要那样卸载它。

如何在 IE 中删除/删除（而不是禁用）此 ActiveX 控件，以便我可以模拟当人们访问该站点并且尚未安装 ActiveX 控件时会发生什么？我认为必须有一种方法可以“清除”它的 IE。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T22:02:53.413

您可以使用注销控件

```
regsvr32 /u badboy.ocx 
```

在命令行。虽然我建议在 vmware 中测试这些东西。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-18T19:10:58.167

关闭所有浏览器和选项卡以确保 ActiveX 控件不驻留在内存中。打开一个全新的 IE9 浏览器。选择工具-> 管理加载项。将下拉菜单更改为“所有加载项”，因为默认仅显示已加载的加载项。

现在选择您要删除的加载项。左下角会显示一个链接，上面写着“更多信息”。点击它。

这将打开另一个对话框，允许您安全地卸载 ActiveX 控件。

如果您按照手动运行“regsvr32”的指示来删除 OCX，这还不够。ActiveX 控件被封装为签名的 CAB 文件，它们可能会提取到多个 DLL 和 OCX。您希望使用 IE 安全正确地注销每个 COM DLL 和 OCX。

你有它！问题是在 IE 9 中它有些隐藏，因为您必须单击“更多信息”，而 IE8 您可以从相同的 UI 中进行操作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-09-08T22:31:06.233

Internet选项-->常规选项卡-->浏览历史记录部分....单击设置，然后单击“查看对象”。您的活动 X 附加组件的列表显示在它们所在的 windows 文件夹中。您可以像处理任何其他文件一样操作这些文件。只需删除您要卸载的那些并重新启动 IE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-02T19:37:41.913

实际上，插件配置菜单中的“远程”选项对我有用（Win7 64，ie8，所有更新），但是：

1.  您需要管理员权限
2.  在按下删除按钮之前应禁用插件
3.  您需要重新启动 internet-explorer 才能看到更改。

如果现在安装了插件，之前关于浏览历史记录->查看对象的评论也很有用。

问候！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-09T22:19:56.940

开始 -> 控制面板 -> 程序和功能，搜索您要卸载的附加组件，然后单击要卸载的特定附加组件。

是的，我尝试从 IE 中卸载，工具 -> 管理加载项，然后单击底部的“更多信息”链接，但是“删除”按钮被禁用。这没有用。

上述从“程序和功能”卸载的解决方案有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-04T00:19:19.820

使用虚拟机。尽可能多地重新开始，并停止这些可能会或可能不会模拟干净机器的黑客行为。

说真的，使用 VMWare 或 VirtualPC。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-11-04T00:15:30.013

工具 > 管理加载项，右键单击“名称”标题并启用“文件夹中”部分。转到您感兴趣的插件的目录。右键单击插件文件，然后单击“删除”。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-06-10T07:19:51.747

你可以去`IE Tools -> Internet options -> Advanced Tab`。在高级下，检查安全性并选中第一个 2 选项，上面写着“允许 CD 中的活动内容在我的电脑上运行*和允许活动内容在我的电脑上的文件中运行*”

重新启动浏览器，ActiveX 脚本将不会显示。

# wcf - 在 WCF 中自托管时如何初始化服务对象

> ID：180626
> 
> 赞同：4
> 
> 时间：2008-10-07T21:58:29.413
> 
> 标签：wcf

我在 Windows 服务中托管服务。

以下代码片段实例化了 ServiceHost 对象：

```
Host = new ServiceHost(typeof(Services.DocumentInfoService)); 
```

DocumentInfoService 类实现了一个契约接口，该接口具有调用需要初始化的业务对象（实际上是一个连接字符串）的方法。理想情况下，我希望托管进程从配置文件中获取连接字符串并将其传递给我的服务对象 DocumentInfoService 的构造函数，该构造函数将保留它并根据需要使用它传递给业务对象。

但是，ServiceHost 构造函数采用 System.Type 对象——因此 DocumentInfoService 的实例是通过默认构造函数创建的。我确实注意到 ServiceHost 有另一个构造函数方法，它接受一个对象实例——但文档表明它是用于单例的。

有没有办法让我在构造对象后访问它，以便我可以传递一些初始化数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T22:48:51.293

ServiceHost 将根据为端点配置的绑定和行为创建服务实例。没有特定的时间点，您可以依赖服务实例。因此，ServiceHost 不公开服务实例。

您可以做的是向您的服务对象构造函数添加代码，以通过[ConfigurationManager](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)类读取相关配置值本身。

当然，如果您不将配置保存在 app.config 中，那将不适合您。另一种方法是拥有一个众所周知的单例对象，服务实例在创建时访问该对象以获得必要的配置。

并且还可以选择创建自己的 ServiceHost 或自己的 ServiceHostFactory 来显式控制服务实例化。这将使您能够在创建时访问新的服务实例。不过，我会远离那个选项。不值得为您的场景付出努力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T22:05:51.410

实现你自己的`ServiceHost`. 另见[http://hyperthink.net/blog/servicehostfactory-vs-servicehostfactorybase/](http://hyperthink.net/blog/servicehostfactory-vs-servicehostfactorybase/)

# c# - 删除最后一行数据绑定 DataGridView C#

> ID：180629
> 
> 赞同：5
> 
> 时间：2008-10-07T21:59:54.667
> 
> 标签：c#, datagridview

我正在使用 VS 2008/C# 并将帮助程序类的本地列表绑定为 DataGridView 控件的数据源。在我的助手类列表上调用 Remove() 方法会触发 DataGridView 的 CellFormatting 事件，这是有道理的（有点）。

当删除网格中最后一行的 DataBoundItem 时（只要网格不止一行），DataGridView 的 Rows 集合在此事件触发之前不会更新。因此，在 CellFormatting 事件处理程序中，我得到一个 IndexOutOfRangeException，因为 Rows 集合太大了。

我尝试使用 DataGridView.Rows.Remove() 方法删除行，并使用 BindingSource 进行绑定，而不是将 List 直接绑定为数据源。

我通过 Google 找到了一些关于此事件的引用，但答案要么没有出现，要么据说在 DataGridView 或 DataGridView.Rows 集合上使用 Delete() 方法——目前都不存在。

排序似乎也不是问题，因为执行/不执行排序会导致相同的结果。

“最后一行”的唯一例外是删除问题是 DataGridView 是否只包含一行 - 在这种情况下一切正常。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-08T00:39:37.917

我过去遇到过这个问题，如果我没记错的话，你可以做两件事之一。从集合中删除记录时，将 datagridview 上的 datasource 属性设置为 null，然后将其重新绑定到列表。这应该够了吧。

或者，您可以在 dataGridview 上处理 DataError 事件，并且在方法中您可以说 e.Cancel = true 来抑制异常，或者您可以在那里进一步处理它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-30T16:02:13.473

首先只是禁用`Datagridview`as的属性

```
dataGridView1.AllowUserToAddRows = false; 
```

然后通过保持-1，使用for循环删除最后一行。

```
dataGridView1.Rows.RemoveAt(dataGridView1.Rows.Count - 1);
dataGridView1.Rows.RemoveAt(dataGridView1.Rows.Count - 1); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-06T11:29:11.817

要隐藏最后一行，请更改 datagridview 的 AllowUserToAddRows 属性，如下所示：

```
myDataGridView1.AllowUserToAddRows = false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-06T22:02:30.707

我也有同样的问题。我找到了解决方案。尝试将所有行复制到下一行。然后删除第一行dgv。一个示例代码：

```
 If Dgv.CurrentCell.RowIndex + 1 = Dgv.Rows.Count Then
        For m = Dgv.Rows.Count - 2 To 0 Step -1
            Dgv.Rows(m + 1).Cells(0).Value = Dgv.Rows(m).Cells(0).Value
            Dgv.Rows(m + 1).Cells(1).Value = Dgv.Rows(m).Cells(1).Value
            Dgv.Rows(m + 1).Cells(2).Value = Dgv.Rows(m).Cells(2).Value
            Dgv.Rows(m + 1).Cells(3).Value = Dgv.Rows(m).Cells(3).Value

        Next
        Dgv.Rows.RemoveAt(0)
        Exit Sub
    End If
    Dgv.Rows.Remove(Dgv.CurrentRow) 
```

尝试一下：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-05T09:47:16.500

这是一个非常古老的问题，但我通过处理 row-remove 事件解决了它，如下所示。

```
private void dgViewItems_RowsRemoved(object sender, DataGridViewRowsRemovedEventArgs e)
{
     dataAdapter.Update((DataTable)bindingSource1.DataSource);
} 
```

它奏效了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-18T20:20:34.243

我知道这是一个老问题，但我找到了另一个对我有用的解决方案。在从数据源/绑定源中删除项目之前，取消连接 CellFormatting 事件的事件处理程序，然后重新连接它。例如：

```
RemoveHandler DataGridView1.CellFormatting, AddressOf DataGridView1_CellFormatting
Me.BindingSource1.Remove(item)
AddHandler DataGridView1.CellFormatting, AddressOf DataGridView1_CellFormatting 
```

# sql - 在 T-SQL 中确定时区偏移量

> ID：180638
> 
> 赞同：5
> 
> 时间：2008-10-07T22:02:38.763
> 
> 标签：sql, sql-server, sql-server-2005, timezone

我的数据库应用程序将部署在不同时区的多个站点。

我需要一个 T-SQL 函数来确定今年 1 月 1 日午夜的 UTC 时间戳以进行 YTD 计算。所有数据都存储在 UTC 时间戳中。

例如，芝加哥是 UTC-6 夏令时 (DST)，如果在 2008 年的任何时间在芝加哥运行，该函数需要返回“2008-01-01 06:00:00”。如果明年在纽约 (GMT-5 + DST) 运行，则需要返回 '2009-01-01 05:00:00'。

我可以从`YEAR(GETDATE())`. 我想我可以做一个`DATEDIFF`between `GETDATE()`and`GETUTCDATE()`来确定偏移量，但结果取决于查询是否在 DST 期间运行。我不知道任何用于确定偏移量或当前时间是否为 DST 的内置 T-SQL 函数？

有没有人在 T-SQL 中解决这个问题？我可以对其进行硬编码或将其存储在表格中，但不希望这样做。我想这是在 SQL Server 2005 中使用 CLR 集成的完美情况。我只是想知道是否有我不知道的 T-SQL 解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T00:05:47.143

查看之前的问题和答案以获取相关信息：

[在 SQL 2005 中有效地在 UTC 和本地（即 PST）时间之间转换日期](https://stackoverflow.com/questions/24797/effectively-converting-dates-between-utc-and-local-ie-pst-time-in-sql-2005#25073)

（总而言之，您确实需要在 Sql Server 2005 中构建时区和 DST 表。在 Sql Server 的下一个版本中，我们会在时区方面获得一些帮助。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T22:27:07.623

嗯，我想我不明白这个问题。如果数据库应用程序已经为它的所有事务存储了 UTC 时间戳，并且您想要总结自年初“本地时间”以来的一些值，那么您的条件必须类似于：

```
(timestamp + (getutcdate() - getdate())) > cast('01/01/2008' as datetime) 
```

DST 可以**打开**或**关闭，**具体取决于查询运行年份的时间 - 但`getdate()`会将其考虑在内，因此您必须每次都动态计算偏移量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T22:29:32.767

除非我弄错了，否则 GETUTCDATE() 函数使用服务器上定义的时区——它没有关于客户端时区（或任何时区）的信息。我不认为这些信息存储在 SQL Server 2005 的任何地方，这使得它无法计算这些信息。

[也许您可以从Oracle 的时区文件](http://download.oracle.com/docs/cd/B19306_01/server.102/b14225/ch4datetime.htm#i1006667)中“借用”数据并构建您自己的 SQL Server 函数？

离题（可能对其他人有用）但如果您使用的是 Oracle，则可以使用 FROM_TZ 函数和“AT TIME ZONE”：

```
FROM_TZ(YOUR_TIMESTAMP, 'UTC') AT TIME ZONE 'America/Dawson_Creek' 
```

# java - 任何人都可以为 Java 推荐一个高效的 UDP 消息传递框架吗？

> ID：180646
> 
> 赞同：3
> 
> 时间：2008-10-07T22:06:10.910
> 
> 标签：java, messaging

我需要能够从 Java 发送紧凑消息（理想情况下小到足以放入单个 UDP 数据包）。它需要尽可能高效 - 任何人都可以给我任何指示（除了手动构建它们）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T22:21:04.670

Mina -- [http://mina.apache.org/udp-tutorial.html](http://mina.apache.org/udp-tutorial.html) -- 非常好的工具

# html - 如何排列 HTML 输入元素？

> ID：180647
> 
> 赞同：24
> 
> 时间：2008-10-07T22:06:17.540
> 
> 标签：html, css, css-reset

我希望找到一个资源来排列 HTML 页面中的输入元素。我发现即使使用 width 样式属性也很难让选择元素和文本框具有相同的宽度，而且跨浏览器更难。最后，文件输入似乎不可能到达相同宽度的跨浏览器。是否有任何好的指南或提示来完成此操作？也许我应该设置一些默认的 CSS 属性。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-08T06:16:18.097

我在 Internet Explorer 7、Firefox 3 和 Safari/Google Chrome 中对此进行了测试。我肯定看到了`<select>`and的问题`<input type="file">`。我的发现表明，如果您将所有输入设置为相同宽度，则`<select>`在所有浏览器中都会缩短约 5 个像素。

使用[Eric Meyer CSS 重置脚本](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)并不能解决这个问题，但是如果您只是将`<select>`输入宽 5 像素，您将在主要浏览器中获得非常好的（尽管不是完美的）对齐。唯一不同的是 Safari/Google Chrome，它似乎比所有其他浏览器宽 1 或 2 个像素。

就`<input type="file">`而言，您在那里的造型没有太大的灵活性。如果您可以选择 JavaScript，则可以实现[quirksmode 上显示](http://www.quirksmode.org/dom/inputfile.html)的方法，以更好地控制文件上传控件的样式。

有关具有一致输入宽度的典型表单，请参阅下面的 XHTML 1.0 Strict 中的完整工作示例。请注意，这并没有使用其他人在此处指出的 100% 宽度技巧，因为它存在宽度不一致的相同问题。此外，没有用于呈现表单的表格，因为表格只能用于表格数据而不是布局。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <title>Example Form</title>
  <style type="text/css">
    label,
    input,
    select,
    textarea {
      display: block;
      width: 200px;
      float: left;
      margin-bottom: 1em;
    }

    select {
      width: 205px;
    }

    label {
      text-align: right;
      width: 100px;
      padding-right: 2em;
    }

    .clear {
      clear: both;
    }
  </style>
</head>

<body>
  <form action="#">
    <fieldset>
      <legend>User Profile</legend>
      <label for="fname">First Name</label>
      <input id="fname" name="fname" type="text" />
      <br class="clear" />

      <label for="lname">Last Name</label>
      <input id="lname" name="lname" type="text" />
      <br class="clear" />

      <label for="fav_lang">Favorite Language</label>
      <select id="fav_lang" name="fav_lang">
        <option value="c#">C#</option>
        <option value="java">Java</option>
        <option value="ruby">Ruby</option>
        <option value="python">Python</option>
        <option value="perl">Perl</option>
      </select>
      <br class="clear" />

      <label for="bio">Biography</label>
      <textarea id="bio" name="bio" cols="14" rows="4"></textarea>
      <br class="clear" />
    </fieldset>
  </form>
</body>

</html>
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-07T22:09:30.357

我通常将它们放在我想要的宽度的 div 或表格单元格中（恐怖！我知道），然后将选择和输入 style:width 设置为 100%，以便它们填充它们所在的 div / 单元格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-22T18:01:45.443

我发现如果将**选择**和**输入**元素边框和填充设置为 0，它们的宽度相同。（在 Chrome 14、Firefox 7.0.1、Opera 11.51、IE 9 上测试）

在选择和输入元素上放置 1px 边框/填充会使输入元素宽 2 像素。例如：

```
<form class="style">
    <input name="someInput" />
    <select name="options">
        <option value="1">Value 1</option>
        <option value="2">Value 2</option>
    </select>
</form>

.style select {
    width: 100px;
    padding: 1px;
    border: 1px solid black;
}
.style input {
    width: 96px; /* -2 px for 1px padding(1px from each side) and -2px for border
    (select element seems to put border inside, not outside?) */
    padding: 1px;
    border: 1px solid black;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T22:11:53.427

除了宽度，我也会设置边框和边距，这些可能会也可能不会影响您的控件。这样的事情可能会有所帮助：

```
input, select {
    width: 100px;
    margin: 0px;
    border: 1px solid;
} 
```

[罗恩](https://stackoverflow.com/questions/180647/how-to-line-up-html-input-elements#180656)也有个好主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T22:11:42.880

您是否使用一些基本设置开始您的 CSS 文件？关闭所有元素的填充和边距可能很有用。我还没有测试过这是否会影响选择/输入元素。

下面是 Eric Meyer 的 CSS 重置示例：

[http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T23:52:22.880

不同浏览器的文件输入可能根本不同，并且绝对不允许进行太多自定义，这可能很烦人，但我也理解为什么从安全角度来看。例如，尝试更改出现在大多数浏览器上的“浏览”按钮的文本，或者将 Safari 上的文件输入与其他浏览器进行比较...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-17T16:33:34.660

我认为[罗恩的](https://stackoverflow.com/questions/180647/how-to-line-up-html-input-elements#180656)想法行不通……

测试用例：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <link href="styles/reset.css" rel="stylesheet" type="text/css"/>

    <style type="text/css">
        input, select{
            width: 100%;
        }
    </style>
</head>
<body>

<div style="width: 200px;">
    <input type="text">
    <select>
        <option>asdasd</option>
        <option>asdasd</option>
    </select>

</div>

</body>
</html> 
```

这导致输入比选择宽一些 px（这可能取决于操作系统）。我不确定这是否可以实现，即使使用 +5px 技巧，因为选择的样式似乎依赖于操作系统（至少是 windows 主题）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-02T13:09:31.597

如果你迫切需要 { width: 100%; 并且没有以像素为单位指定宽度，那么 jQuery 是你的朋友：

```
$(function () {
    var allSelects = $('input[type="text"], textarea');
    allSelects.css('width', (allSelects.width()-6)+'px');
} 
```

-6 像素最适合我 (FF9)，根据需要进行编辑。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-13T09:22:18.980

这是因为使用 <input>，边框和填充被添加到宽度上（就像大多数其他元素一样）。使用 <select>，边框和填充包含在宽度中，就像在旧的 IE 怪癖模式中一样。

您可以通过增加宽度来解决这个问题：

```
input  { width: 200px; padding: 10px; border-width:5px; }
select { width: 230px; padding: 10px; border-width:5px; } 
```

或者（如果您可以依赖浏览器支持）您可以使用新的 CSS3 box-sizing 属性使它们的行为一致，并在元素宽度之外绘制填充和边框：

```
input, select {
  width: 200px;
  padding: 10px;
  border-width:5px;
  -webkit-box-sizing: content-box; /* Safari/Chrome, other WebKit */
  -moz-box-sizing: content-box;    /* Firefox, other Gecko */
  box-sizing: content-box;         /* Opera/IE 8+ */
} 
```

或者，您可以将 box-sizing 设置为 border-box 以使输入的行为类似于选择，并在框的宽度内绘制填充。

在 Chrome、IE8、FF 中测试

# analytics - 确定网站总大小的优雅方法？

> ID：180649
> 
> 赞同：12
> 
> 时间：2008-10-07T22:07:14.153
> 
> 标签：analytics, website-metrics

是否有一种优雅的方法来确定从网站下载的数据大小 - 请记住，并非所有请求都会转到您最初访问的同一个域，并且其他浏览器可能在后台同时轮询。理想情况下，我想查看每个单独页面的大小——或者对于 Flash 站点，随着时间的推移总下载量。

我正在寻找某种浏览器插件或 Fiddler 脚本。由于上述问题，我不确定 Fiddler 是否会工作。

我想比较与我类似的网站的总文件大小 - 并跟踪我自己的网站。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-07T22:38:02.640

Firebug 和 HttpFox 是两个 Firefox 插件，可用于确定从网站下载的**单个页面**的数据大小。虽然[Firebug](http://www.getfirebug.com/)对任何 Web 开发人员来说都是一个很棒的工具，但[HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)是一个更专业的插件，用于分析 HTTP 请求/响应（具有相对大小）。

您可以同时安装并试用它们，只需确保在启用另一个的同时禁用一个。

如果您需要**网站范围的测量**：

*   如果网站由纯 HTML 和资产（如 CSS、图像、flash 等）组成，您可以检查包含该网站的文件夹在服务器上的大小（假设您可以在服务器上登录）
*   您可以使用 wget、curl 或一些基于 GUI 的应用程序（如 Site Sucker）在本地镜像网站，并检查包含镜像的文件夹有多大
*   如果您知道网站*很大*，但您不知道有多少，您可以估计它的大小。即 www.mygallery.com 有 1000 个画廊；每个画廊平均加载 20 张图片；每个图像都以 2 种不同尺寸（缩略图和全尺寸）存储，平均为 _n_kb / 图像；...

请记住，如果您下载/估计动态网站，您处理的是网站生成的内容，而不是服务器上网站的实际大小。一个小的 PHP 脚本可以生成大量的 HTML。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-07T22:08:42.857

您是否尝试过用于 Firefox 的 Firebug？

Firebug 中的“网络”面板会告诉您每个提取文件的大小和提取时间，以及总数。

[![在此处输入图像描述](https://i.stack.imgur.com/cxnwA.png)](https://i.stack.imgur.com/cxnwA.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-30T18:32:04.290

您可以下载整个网站，然后您肯定会知道！

[https://www.httrack.com/](https://www.httrack.com/)

# c# - TryParse在C#中的应用

> ID：180658
> 
> 赞同：1
> 
> 时间：2008-10-07T22:10:37.000
> 
> 标签：c#

当下面的 'val' 不是`bool`我得到一个例外时，我相信我可以使用`TryParse`，但我不确定如何最好地将它与下面的代码一起使用。任何人都可以帮忙吗？

```
checkBox.Checked = Convert.ToBoolean(val); 
```

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-07T22:12:20.117

代码如下，判断字符串`val`是否为有效的布尔值，`Checked`如果是则使用它来设置属性。您需要决定如果它不代表有效值，您将采取什么行动。

```
bool result;
if (bool.TryParse(val, out result))
{
    // val does represent a Boolean
    checkBox.Checked = result;
}
else
{
    // val does not represent a Boolean
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T22:12:59.633

假设如果它不是一个有效的布尔值，你不希望它被检查：

```
bool result = false;
bool.TryParse(val, out result);
checkBox.Checked = result; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T22:13:31.253

```
bool z = false;
if(Boolean.TryParse(val, out z))
{
  checkBox.Checked = z;
} 
```

请注意：解析和转换是不同的操作，可能会导致不同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T22:16:37.067

布尔 isBool = false;

bool.TryParse(val, ref isBool);

```
if( isBool )    
{
   ///ok;

}
else
{
  // fail;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T22:18:30.947

这得看情况; 如果您希望 checkBox.Checked 等于 true 如果 val - 如果它是一个字符串 - 解析为 true，则使用以下命令：-

```
bool output;
checkBox.Checked = bool.TryParse(val, out output) && output; 
```

如果 bool 不是字符串，那么您需要根据其类型决定如何处理它，例如：-

```
checkBox.Checked = val != 0; 
```

等等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T18:51:03.253

这里已经有了很好的答案。

但是，我要补充一点，请小心使用 TryParse，因为与它的名称所表明的相反，它实际上仍然会抛出 ArgumentException！

这是我对 .NET 最讨厌的地方之一！:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-22T16:17:47.427

FWIW，在这种（或类似的）情况下，以下内容也可能派上用场......

```
bool myBool = val ?? false; 
```

...这是一个很好的旧“空合并运算符”，非常好。

如果您有兴趣，请在此处阅读更多信息：http: [//msdn.microsoft.com/en-us/library/ms173224.aspx](http://msdn.microsoft.com/en-us/library/ms173224.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-04-03T16:40:51.047

刚刚为另一个问题发布了相同的代码片段，但这是我在项目中使用的代码，用于更好地处理所有各种版本的布尔值：

```
bool shouldCheck;
TryParseBool(val, out shouldCheck);
checkBox.Checked = shouldCheck;

/// <summary>
/// Legal values: Case insensitive strings TRUE/FALSE, T/F, YES/NO, Y/N, numbers (0 => false, non-zero => true)
/// Similar to "bool.TryParse(string text, out bool)" except that it handles values other than 'true'/'false'
/// </summary>
public static bool TryParseBool(object inVal, out bool retVal)
{
    // There are a couple of built-in ways to convert values to boolean, but unfortunately they skip things like YES/NO, 1/0, T/F
    //bool.TryParse(string, out bool retVal) (.NET 4.0 Only); Convert.ToBoolean(object) (requires try/catch)
    inVal = (inVal ?? "").ToString().Trim().ToUpper();
    switch ((string)inVal)
    {
        case "TRUE":
        case "T":
        case "YES":
        case "Y":
            retVal = true;
            return true;
        case "FALSE":
        case "F":
        case "NO":
        case "N":
            retVal = false;
            return true;
        default:
            // If value can be parsed as a number, 0==false, non-zero==true (old C/C++ usage)
            double number;
            if (double.TryParse((string)inVal, out number))
            {
                retVal = (number != 0);
                return true;
            }
            // If not a valid value for conversion, return false (not parsed)
            retVal = false;
            return false;
    }
} 
```

# user-interface - 在文字处理器中使用 Office 功能区

> ID：180670
> 
> 赞同：3
> 
> 时间：2008-10-07T22:15:00.800
> 
> 标签：user-interface, ms-office, ribbon

我听说微软允许使用商业上可用的 Office UI 控件，但竞争产品除外，例如文字处理器或电子表格应用程序等。

这有多真实？

另外，如果不是这样，您知道任何*免费*的功能区控件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T22:24:03.167

您应该查看[Jensen Harris 的关于许可 Office 用户界面的博客条目，](http://blogs.msdn.com/jensenh/archive/2006/11/21/licensing-the-2007-microsoft-office-user-interface.aspx)其中详细解释了它。但是我相信这里的相关点是：

> 只有一个限制：如果您正在构建一个直接与 Word、Excel、PowerPoint、Outlook 或 Access（具有新 UI 的 Microsoft 应用程序）竞争的程序，则无法获得免版税许可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T23:34:39.717

您仍然可以使用功能区构建文字处理器。你只是不能使用*微软的*功能区。与 Office 2007 相比，类似功能区的界面存在的时间要长得多（我印象最深的是 C++ Builder 中的托盘：非常类似于功能区），所以他们绝对不*拥有*这个概念，如果那是甚至可能。我见过许多第三方甚至开源的功能区控件。

# dns - 将 *.domain.com 映射到单个地址

> ID：180684
> 
> 赞同：1
> 
> 时间：2008-10-07T22:22:12.093
> 
> 标签：dns, subdomain

我不确定这是否真的是一个编程问题，但这与我正在做的事情有关......我正在开发一个网站，该网站将有很多 .domain.com，并基于包含的内容，网站将显示不同的内容。

有谁知道该怎么做？也许它需要更改 DNS 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T22:24:01.013

您需要一个通配符 DNS 条目将所有这些子域指向同一个 IP（您的 Web 服务器使用的 IP）。然后在您的应用程序代码中根据主机标头对其进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T22:46:09.677

在所有 DNS 条目都指向同一个框后，您可以使用[Apache 虚拟主机](http://httpd.apache.org/docs/2.0/vhosts/examples.html)使它们运行并显示为单独的 Web 服务器，而无需多个 Apache 实例的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T22:49:51.227

将dns设置为将所有子域指向同一个IP后，还可以配置Apache重写url来路由请求。（[http://httpd.apache.org/docs/2.2/misc/rewriteguide.html](http://httpd.apache.org/docs/2.2/misc/rewriteguide.html)）。也就是说，如果你喜欢 Apache =)

# opensocial - pubsub 如何在 OpenSocial 中工作？

> ID：180704
> 
> 赞同：0
> 
> 时间：2008-10-07T22:33:38.687
> 
> 标签：opensocial, publish-subscribe

我正在尝试设计一个基于[OpenSocial API](http://en.wikipedia.org/wiki/OpenSocial)的应用程序，但我不确定[pubsub](http://code.google.com/apis/opensocial/docs/0.8/reference/gadgets/#gadgets.pubsub)设备将如何工作。这似乎类似于 Unix 管道，或者可能是 RSS 提要。

跨浏览器/计算机的通道是否持久？也就是说，我可以在浏览器 A 上订阅频道“x”并在浏览器 B 上发布到“x”，并在浏览器 A 中读取这些数据吗？如果没有，是否有一种方便的开放社交方法来完成同样的事情？

另外：如果一个小工具在数据发布后订阅了一个频道，那么该数据仍然可以读取吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T22:47:23.527

Pubsub 是一种 API 功能，它允许不同的 OpenSocial 小工具在 OpenSocial 容器中的同一页面上相互交谈。

这意味着连接不是持久的，但是例如，如果您有一个地图小工具，以及一个带有餐厅列表的小工具，它们都出现在页面中，这种机制可以使列表与当前显示的地图区域保持相关.

这需要两个小工具提前就消息格式和通道达成一致。

# language-agnostic - 强制转换的能力不会破坏类型变量的目的吗？

> ID：180710
> 
> 赞同：1
> 
> 时间：2008-10-07T22:37:24.997
> 
> 标签：language-agnostic, programming-languages, strong-typing

所以，我假设我们已经输入了语言，因为我们犯了很多错误......所以输入是让编译器为我们做很多检查并帮助我们的一种方式（请让我知道是不是我的假设不正确）。

但是，如果我们将强制转换引入类型化语言，难道我们不会重新引入我们在无法类型化变量时遇到的大多数问题吗？

我也知道我的假设并不是我们键入变量的唯一原因。请分享我们输入语言的其他一些原因。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-07T22:43:17.887

底线是**强类型让编译器为你检查**，**强制类型转换让你在必要时覆盖强类型。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T22:44:39.583

我会说“基本上不”。

如果您必须进行显式转换，您仍然可以避免动态类型引入的大多数问题。您的方法仍然需要存在于新类中。对象之间仍然必须具有某种层次关系。

能够将 XmlTextReader 转换为 TextReader 与能够在运行时确定 reader 具有称为“read”的成员并且可能是布尔值或可能是方法之间存在天壤之别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T22:40:38.000

> 所以打字是让编译器为我们做很多检查并帮助我们的一种方法

是的。

> 但是，如果我们将强制转换引入类型化语言，难道我们不会重新引入我们在无法类型化变量时遇到的大多数问题吗？

是的。

你应该尽可能避免它，但有时你仍然需要做肮脏的工作。

当然，有很多语言不强制执行严格的键入，并且很多人喜欢它们并使用它们完成有用的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T22:41:56.063

是的，强类型允许编译器为你做很多检查。

不，允许强制转换并不会停止它的有用性。关键是在极少数情况下需要进行强制转换时，它是明确的。程序员必须做出决定来制作演员表并且可以小心。铸造是一个有用的工具，就像许多强大的工具一样，它应该小心使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T22:53:00.037

至少在Java中，不是真的。您只能投射到您期望的班级的孩子。因此，如果您的类返回 RuntimeException，则不能将其强制转换为字符串，也无需将其强制转换为异常（它是父级）来访问它。

您只需将其转换为说您知道这实际上是 RuntimeException 的子/实现，并且您需要访问孩子知道的关于 RuntimeException 不知道的东西。

也就是说，过多的选角是不好的 OO 气味。您应该几乎完全通过父母公开的方法来访问孩子的唯一代码——如果您发现自己铸造了很多，也许您忘记了这条规则。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T22:44:25.653

当您进行强制转换时，您明确要求编译器放松其强类型。这允许您在 99% 的情况下进行编译时检查，但仍然在绝对必要时混合类型。

无论如何，编译器有可能在编译时发现“坏”的强制转换——那些没有成功的机会。

所以说**启用**强制转换否定了强类型的好处是错误的。然而，这可以说是**过度使用**铸造。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T22:45:50.987

打字还允许 Visual Studios Intellisense 等工具工作，这对提高生产力有很大帮助。

但除此之外，迈克 B 是对的。有时你只需要做一些肮脏的事情，比如将接口转换为类，或者将 longs 转换为 int。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T23:32:48.380

> 但是，如果我们将强制转换引入类型化语言，难道我们不会重新引入我们在无法类型化变量时遇到的大多数问题吗？

我没有看到指定的语言，但应该指出的是，在铸造方面有不同的程度。

例如，C++ 有一个 dynamic_cast，如果一个对象不能通过其继承关系转换为另一个对象，它将返回 NULL。

const_cast 将抛弃对象的常量性。这对于将 const 对象传递给未声明为 const 但您知道不会更改对象的方法可能很有用。

# java - How do you determine if a JDBC Connection was retrieved from a JTA enabled DataSource or straight JDBC?

> ID：180713
> 
> 赞同：4
> 
> 时间：2008-10-07T22:39:07.270
> 
> 标签：java, jdbc, transactions, jta

I'm using a vendor API to obtain a JDBC connection to the application's database. The API works when running in the application server or when running in a stand-alone mode. I want to run a series of SQL statements in a single transaction. I'm fine with them occurring in the context of the JTA transaction if it exists. However, if it doesn't then I need to use the JDBC transaction demarcation methods. (Calling these methods on a JDBC connection that is participating in a JTA transaction causes a SQLException.)

So I need to be able to determine whether the Connection came from the JTA enabled DataSource or if it's just a straight JDBC connection.

Is there a straight forward way to make this determination?

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-12T11:03:16.367

Even if it's straight JDBC, you can have a JTA transaction enabled. Checking the autoCommit flag will NOT help in this regard. You can be in a transaction, distributed or otherwise, with autoCommit set to false. autoCommit set to true would tell you you're not in a distributed transaction but a value of false just means you won't auto-commit... it could be in any kind of transaction.

I think you're going to have to call UserTransaction.getStatus() and verify that it is not equal to Status.NoTransaction(). This would tell you if you're in a JTA transaction.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T22:47:09.003

What thilo says does make sense.

Otherwise, Not sure of a straight way BUT I will give you a "hack" way

write a BAD SQL which you know will give a DB exception. That will result in a stack trace. From the stack trace, you can find out if it is a JTA derived connection or NOT ?

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-07T22:45:24.607

~~You could try to check the Connection's autoCommit flag to see if it is in a transaction (regardless of where it came from).~~ (Apparently, see the accepted answer, this does not work too well. I am not deleting this answer because the following still stands: )

But I think you should really modify your API to depend on external transactions exclusively. If you still want to support plain JDBC, wrap it into a separate API that just starts the transaction.

Update: Just re-read your question and saw that you are not providing an API, but want to use a container-managed connection. But still, can you just mandate (as part of your application's requirements) that JTA be in effect? If not, you could provide a configuration option to fall back to manually managed transactions. For such a critical feature it seems reasonable to require the proper configuration (as opposed to try to guess what would be appropriate).

# windows - 如何使用批处理脚本对目录中的每个文件执行某些操作

> ID：180741
> 
> 赞同：289
> 
> 时间：2008-10-07T22:49:33.180
> 
> 标签：windows, file, loops, batch-file, cmd

如何使用 .bat 或 .cmd 文件遍历目录中的每个文件？

为简单起见，请提供一个仅回显文件名或文件路径的答案。

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2008-10-07T22:51:57.213

命令行用法：

```
for /f %f in ('dir /b c:\') do echo %f 
```

批处理文件使用：

```
for /f %%f in ('dir /b c:\') do echo %%f 
```

**更新**：如果目录包含名称中带有空格的文件，则需要更改`for /f`命令使用的分隔符。例如，您可以使用管道字符。

```
for /f "delims=|" %%f in ('dir /b c:\') do echo %%f 
```

**更新 2** :(在原始答案之后一年半:-)) 如果目录名称本身的名称中有空格，则可以使用以下`usebackq`选项`for`：

```
for /f "usebackq delims=|" %%f in (`dir /b "c:\program files"`) do echo %%f 
```

如果您需要使用输出重定向或命令管道，请使用转义字符 ( `^`)：

```
for /f "usebackq delims=|" %%f in (`dir /b "c:\program files" ^| findstr /i microsoft`) do echo %%f 
```

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2012-10-18T23:22:13.993

或者，使用：

```
forfiles /s /m *.png /c "cmd /c echo @path" 
```

forfiles 命令在 Windows Vista 及更高版本中可用。

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2013-11-08T00:16:32.640

最简单的方法：

从命令行，使用：

```
for %f in (*.*) do echo %f 
```

从批处理文件（加倍 % 百分号）：

```
for %%f in (*.*) do echo %%f 
```

从将文件夹指定为第一个参数的批处理文件中：

```
for %%f in (%1\*.*) do echo %%f 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-07T22:56:57.483

采用

```
for /r path %%var in (*.*) do some_command %%var 
```

和：

*   path 是起始路径。
*   %%var 是一些标识符。
*   *.* 是文件掩码或变量的内容。
*   some_command 是使用路径和 var 连接作为参数执行的命令。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-17T23:44:05.960

其他方式：

```
for %f in (*.mp4) do call ffmpeg -i "%~f" -vcodec copy -acodec copy "%~nf.avi" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-14T21:30:20.200

我有一些恶意软件将目录中的所有文件标记为隐藏/系统/只读。如果其他人发现自己处于这种情况，请 cd 进入目录并运行`for /f "delims=|" %f in ('forfiles') do attrib -s -h -r %f`.

# c# - System.OutOfMemoryException 在大型数据集上使用 C#

> ID：180743
> 
> 赞同：1
> 
> 时间：2008-10-07T22:50:53.987
> 
> 标签：c#, exception

我正在使用 C#，在读取 50,000 条记录后出现 System.OutOfMemoryException 错误，处理如此大的数据集的最佳做法是什么？分页有帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T18:35:06.000

我可能会建议创建 MDB 文件并使用 DataReader 将记录流式传输到 MDB 中，而不是尝试在本地读取和缓存整个数据集。使用 DataReader，该过程更加手动，但您一次只能获取一条记录，因此您不会填满您的内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T23:00:35.357

您仍然不应该一次阅读所有内容。读入块，然后将块写入 mdb 文件，然后读取另一个块并将其添加到文件中。一次读取 50,000 条记录只是自找麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T23:00:59.067

显然，您不能在创建 MDB 文件之前读取内存中的所有数据，否则您不会出现内存不足异常。:-)

您有两个选择： - 分区 - 使用过滤读取较小块中的数据 - 虚拟化 - 将数据拆分为页面并仅加载当前页面

在任何情况下，您都必须创建 MDB 文件并在此之后以块的形式传输数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T22:52:43.220

如果您使用的是 xml，则一次只读取几个节点。如果您使用其他格式，一次只需阅读几行（或其他）。在开始处理之前不要将整个内容加载到内存中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-12T11:11:36.177

我建议使用[生成器](http://en.wikipedia.org/wiki/Generator_(computer_science))：

> “......而不是构建一个包含所有值的数组并一次返回它们，生成器一次生成一个值，这需要更少的内存并允许调用者立即开始处理前几个值。简而言之，生成器看起来像一个函数，但行为却像一个迭代器。”

维基百科文章也有几个[很好的例子](http://en.wikipedia.org/wiki/Generator_(computer_science)#C.23)

# wpf - 从 WPF 打印/报告的最佳方法是什么？

> ID：180746
> 
> 赞同：71
> 
> 时间：2008-10-07T22:51:33.457
> 
> 标签：wpf, printing, reporting

我有一个即将进行的项目，它必须能够从其数据中打印简单的报告。它将是基于 WPF 的，我想知道该走哪条路。

我知道 WPF 引入了自己的打印技术（基于 XPS），看起来很容易使用。然而，我的一部分想知道使用 ReportViewer 控件并将其嵌入到 Windows 窗体主机控件中是否更容易，因为这将使用户能够导出为各种格式以及打印。

有没有人有任何从 WPF 打印/报告的经验？你会推荐哪个方向？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2010-05-13T20:56:10.627

**RDL 的局限性**

我最初使用 RDLC/ReportViewer 来使用 WPF 进行打印，但发现它非常有限。我发现的一些限制是：

*   RDL 只能创建最无聊的报告
*   与直接使用 WPF 相比，使用 RDL 创建报告的工作量要多得多：与 Expression Blend 相比，设计工具非常原始，并且 RDL 仅在表格中处理
*   我没有能力使用 ControlTemplates、DataTemplates、Styles 等
*   我的报表字段和列无法根据数据大小有效调整大小和重新排列
*   图形必须作为图像导入 - 它不能作为矢量绘制或编辑
*   项目的定位需要代码隐藏而不是数据绑定
*   缺乏转换
*   非常原始的数据绑定

**直接从 WPF 打印非常容易**

由于这些限制，我研究了使用纯 WPF 创建报告并发现它真的很简单。WPF 允许您实现自己的`DocumentPaginator`可以生成页面的子类。

我开发了一个简单的 DocumentPaginator 子类，它接受任何 Visual，分析可视树，并隐藏选定的元素以创建每个页面。

**DocumentPaginator 详细信息**

这是我的 DocumentPaginator 子类在初始化期间所做的事情（在获取第一个 PageCount 时或在第一个 GetPage() 调用期间调用）：

1.  扫描可视化树并制作 ItemsControls 内所有滚动面板的地图
2.  从最外层开始，使 ItemsControls 中的项目从最后到第一个不可见，直到 Visual 适合单个页面而无需滚动。如果最外面的面板不能足够减少，则减少内部面板，直到成功或每个级别只有一个项目。将可见项目集记录为第一页。
3.  隐藏已在第一页显示的最低级别项目，然后使后续项目可见，直到它们不再适合页面。将最后添加的项目以外的所有项目记录为第二页。
4.  对所有页面重复该过程，将结果存储在数据结构中。

我的 DocumentPaginator 的 GetPage 方法如下：

1.  在初始化时生成的数据结构中查找给定的页码
2.  隐藏和显示可视树中的项目，如数据结构中所示
3.  设置 PageNumber 和 NumberOfPages 附加属性，以便报表可以显示页码
4.  刷新 Dispatcher ( `Dispatcher.BeginInvoke(DispatcherPriority.ApplicationIdle, new Action(() => {} ));`) 以完成任何后台渲染任务
5.  创建一个与其 VisualBrush 是正在打印的视觉对象的页面大小相同的 Rectangle
6.  测量、排列和更新布局矩形，然后返回它

结果证明这是非常简单的代码，并且允许我将几乎所有可以使用 WPF 创建的内容转换为页面并打印出来。

**额外的报告支持**

现在我的分页器正在工作，我不再需要非常担心我是为屏幕还是纸张创建 WPF 内容。事实上，我为数据输入和编辑构建的 UI 通常也非常适合打印。

从那里我添加了一个简单的工具栏和一些代码，从而产生了一个围绕 WPF 构建的成熟报告系统，它比 RDL 功能强大得多。我的报告代码可以导出到文件、打印到打印机、剪切/粘贴页面图像以及剪切/粘贴 Excel 数据。我还可以通过单击复选框将我的任何 UI 切换到“打印视图”，以查看打印后的外观。所有这一切都在几百行 C# 和 XAML 中！

在这一点上，我认为 RDL 的唯一功能是我的报告代码没有的，它能够生成格式化的 Excel 电子表格。我可以看到如何做到这一点，但到目前为止还没有必要 - 单独剪切和粘贴数据就足够了。

根据我的经验，我的建议是编写一个分页器，然后开始使用 WPF 本身来创建您的报告。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-08T13:08:40.743

我们遇到了同样的问题，最终暂时使用了 RDLC/ReportViewer。没有原生的 WPF 报告工具（据我所知），RDLC 使用起来非常简单，而且是免费的。它的运行时开销很小（大约 2Mb），但您必须记住分发它，因为它不是 .NET Framework 的一部分。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-05-21T20:37:18.553

看看[http://wpfreports.codeplex.com/](http://wpfreports.codeplex.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-09T10:28:40.303

看看[PdfReports](http://pdfreport.codeplex.com/)。它是一个代码优先报告引擎，构建在 iTextSharp 和 EPPlus 库之上。它与 .NET 3.5+ Web 和 Windows 应用程序兼容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-24T18:40:55.310

斯克里伯呢？它允许使用 xml 定义 PDF 报告模板并在运行时绑定到应用程序中的数据。[http://scryber.codeplex.com/](http://scryber.codeplex.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-07T00:20:28.207

要详细说明 Ray Burns 的答案，如果您正在寻找实现示例，请参阅： [自定义数据网格文档分页器](http://www.codeproject.com/Articles/138233/Custom-Data-Grid-Document-Paginator)

这是一个很好的起点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-08T12:29:57.670

我最近完成了开发自己的报告系统的任务，主要包括设计环境和数据源管理器。第一项任务是开发类似 WYSWIG 的设计环境。我已经使用 GDI+ 完成了这项工作，甚至不用担心打印，因为打印/生成打印预览比我预期的要简单，通常只需将屏幕上的所有内容绘制到打印事件的图形对象即可。

我认为在 WPF 的情况下它会是相似的，所以你应该担心的只是在屏幕上显示你的报告，打印只需要几行代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-17T18:39:46.373

无需对 WPF 的未来进行全面的政治讨论，我们发现的最佳选择是将 ReportViewer 包装在 Windows 窗体主机控件中。

[http://blog.pineywoodstech.com/index.php/2012/01/using-microsoft-reportviewer-with-wpf/](http://blog.pineywoodstech.com/index.php/2012/01/using-microsoft-reportviewer-with-wpf/)

# build-automation - 批处理文件中的字符串符号操作？

> ID：180750
> 
> 赞同：2
> 
> 时间：2008-10-07T22:52:04.297
> 
> 标签：build-automation, batch-file, automated-tests, dos

有没有办法使用 .bat/.cmd 文件获取字符串的子字符串？

例如，给定字符串“hello.txt”，有没有办法去除 .txt？

编辑：还有一种更通用的方法可以做到这一点，而不是假设它是文件名或文件路径？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T22:59:38.167

如果这是作为参数传递的文件，则可以使用 %~n1，如下所示：

```
test.bat
----------
echo %~n1 %~n2

c:\> test.bat myfile.txt my.long.file.bat
  myfile my.long.file 
```

如果您知道字符串的长度，则可以使用子字符串运算符：

```
echo %variable:0,4%   =>  "test.txt" => "test" 
```

并获得除最后 4 个字符之外的所有内容：

```
echo %variable:~0,-4%  => "file...name.txt" => "file...name" 
```

*   [BatchFiles 网站（高级）](http://www.batchfiles.co.nr/)
*   [体面的论坛帖子](http://forums.afterdawn.com/thread_view.cfm/514228)
*   [另一个好帖子](http://groups.google.com/group/alt.msdos.batch.nt/msg/923423bf3143fcdd?pli=1)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T23:09:00.143

.cmd 文件（和 Win95 后的 .bat 文件）中的一般子字符串语法是：

```
%变量：~num_chars_to_skip,num_chars_to_keep%

```

此页面提供更多选项：[VarSubstring](http://www.ss64.com/nt/syntax-substring.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T07:20:48.107

对于子字符串和其他有趣的“变量替换”方法，您可以获得以下帮助：

> 放 /？

对于字符串解析（例如在字符串中查找“.”）尝试

> 为了 /？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T23:11:04.650

尝试`help set`一些可用于 cmd.exe 的字符串处理。set 的帮助包括您可以正常执行的操作，在“set”命令之外

你可以做类似的事情

```
set source=hello.txt
REM print hello
echo %source:~0,-4%
REM print o.t
echo %source:~4,3%
REM print help.txt
echo %source:lo=p%
REM etc
echo %source:llo=% 
```

上面的“代码”可能有问题。我是从内存中写出来的，我附近没有可用的 cmd.exe 来测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T13:03:46.293

最好的方法就是安装python（或perl）相信我，我已经尝试了几乎所有的东西，而且在'DOS'（或实际上其他任何东西）中进行文本操作只是令人头疼。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T22:59:48.133

对于任意字符串，我不这么认为。

对于这个非常示例，`%~n1`将解析为不带扩展名的名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T21:09:25.513

You can also look at the documentation for call (call /?) for getting file and directory-based specific substring info as well.

# build-automation - 学习高级批处理文件使用的最佳免费资源？

> ID：180754
> 
> 赞同：8
> 
> 时间：2008-10-07T22:54:19.660
> 
> 标签：build-automation, batch-file, automated-tests, dos

学习高级批处理文件使用的最佳免费资源是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-07T22:59:43.017

它不是免费的，但它可能是最好的。 [Tim Hill 的“Windows NT Shell 脚本”](https://rads.stackoverflow.com/amzn/click/com/1578700477)。

也就是说，每当我尝试在 cmd 批处理文件中做一些“高级”的事情时，我总是会后悔。

**总是。**

编辑：对批处理文件缺点的一些解释：

*   数学能力很可怜
*   引用支持是事后的想法 - 如果您需要将带引号的字符串作为参数传递给需要自己引用的命令，请在庇护处保留一个位置（实际上，我不确定这是否可能）
*   字符串操作是半实现功能的拼凑

然后是看似永无止境的怪事、极端案例和不一致之处，您在每一个转折点都会遇到。

批处理文件唯一适用的是它们在每个 Windows 机器上都受支持。如果您只想作为一个组自动执行一些命令，那就太好了。也许添加一个简单的循环、几个子程序和一些环境变量来参数化。除此之外，我强烈建议您使用其他东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T23:32:35.057

还可以考虑学习 [Windows Scripting Host](http://msdn.microsoft.com/en-us/library/9bbdkx3k(VS.85).aspx)作为批处理脚本的替代方法。您可以使用您选择的语言来编写脚本（JScript、VBScript，甚至 Python）。每个现代版本的 Windows 都支持它，并提供功能丰富的函数库，相比之下，批处理文件看起来很原始。

我在说什么呢？Windows 批处理文件***是***原始的。

您还可以创建可重用的 WSH 库、模块等。与批处理文件相比，有一点学习曲线，但非常值得。我的 Linux 朋友不再取笑我劣质的脚本环境。现在他们只是取笑我的劣质操作系统。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T07:17:28.147

要获得命令帮助，这个 .bat 文件会将所有命令的帮助放入一个漂亮的 HTML 页面： [http ://www.robvanderwoude.com/files/allhelp.zip](http://www.robvanderwoude.com/files/allhelp.zip)

这家伙还有一些其他有趣的 .bat 东西。 [http://www.robvanderwoude.com/batexamples_a.html](http://www.robvanderwoude.com/batexamples_a.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-07T22:58:00.087

我发现这个很有用： [http ://www.ss64.com/ntsyntax/](http://www.ss64.com/ntsyntax/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-07T23:04:23.383

堆栈溢出可能吗？

[https://stackoverflow.com/questions/tagged/batch-file](https://stackoverflow.com/questions/tagged/batch-file)

我发现真正有用的是将所有内置的 cmd.exe 帮助保存到文件中。在 cmd.exe 中键入“help”，这将显示您可以获得帮助的命令的大列表，对于每个类型“help <command>”，然后将结果保存到适当命名的文件中。就我个人而言，我发现以文件形式阅读帮助信息要方便得多。

另外，我非常同意 Mike B 反对过多使用批处理文件的禁令。对于任何不重要的任务，使用比批处理更健壮的语言几乎总是更好。如果您的批处理文件在打印时超过一页，您几乎肯定会后悔。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-07T22:56:05.223

尝试过[维基百科的批处理文件条目](http://en.wikipedia.org/wiki/Batch_file)？...或者[谷歌给出的关于高级批处理文件使用的众多答案](http://www.google.co.uk/search?q=advanced+batch+file+usage&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a)中的任何一个？

# makefile - Makefile If-Then Else 和循环

> ID：180760
> 
> 赞同：59
> 
> 时间：2008-10-07T22:57:50.150
> 
> 标签：makefile

有人可以解释如何在 Makefiles 中使用 if-then 语句和 for 循环吗？我似乎找不到任何带有示例的好的文档。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-10-07T23:28:12.943

**条件形式**

简单的

```
conditional-directive
text-if-true
endif 
```

中度复杂

```
conditional-directive
text-if-true
else
text-if-false
endif 
```

更复杂

```
conditional-directive
text-if-one-is-true
else
conditional-directive
text-if-true
else
text-if-false
endif
endif 
```

**条件指令**

如果相等语法

```
ifeq (arg1, arg2)
ifeq 'arg1' 'arg2'
ifeq "arg1" "arg2"
ifeq "arg1" 'arg2'
ifeq 'arg1' "arg2" 
```

如果不相等语法

```
ifneq (arg1, arg2)
ifneq 'arg1' 'arg2'
ifneq "arg1" "arg2"
ifneq "arg1" 'arg2'
ifneq 'arg1' "arg2" 
```

如果定义语法

```
ifdef variable-name 
```

如果未定义语法

```
ifndef variable-name 
```

**foreach 函数**

foreach 函数语法

```
$(foreach var, list, text) 
```

foreach 语义
对于“list”中的每个空格分隔的单词，将“var”命名的变量设置为该单词并执行文本。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-07T23:02:19.487

这是一个示例，如果：

```
ifeq ($(strip $(OS)),Linux)
        PYTHON = /usr/bin/python
        FIND = /usr/bin/find
endif 
```

请注意，这带有一个警告，即不同版本的 Make 语法略有不同，似乎没有一个很好地记录在案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-07T22:59:57.697

您是否尝试过[GNU make 文档](http://www.gnu.org/software/make/manual/make.html#Conditionals)？它有一整节关于带示例的条件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-05-05T05:36:30.190

您确实经常看到 for 循环，但通常不需要它们。这是一个示例，说明如何在不借助 shell 的情况下执行 for 循环

```
LIST_OF_THINGS_TO_DO = do_this do_that 
$(LIST_OF_THINGS_TO_DO): 
       run $@ > $@.out

SUBDIRS = snafu fubar
$(SUBDIRS):
     cd $@ && $(MAKE) 
```

# reference - 通过 ActiveX 操作 Office 文档的在线参考资料有哪些？

> ID：180765
> 
> 赞同：2
> 
> 时间：2008-10-07T22:58:54.423
> 
> 标签：reference, activex, ms-office

我正在寻找涵盖使用 ActiveX 打开和操作 Excel（可能还有 Word）文档的参考资料。我更喜欢在线参考，但书籍建议也很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T23:02:25.650

我错过了什么吗？参考资料可在 MSDN 上找到：

*   [Excel 对象模型参考](http://msdn.microsoft.com/en-us/library/bb149081.aspx)
*   [Word 对象模型参考](http://msdn.microsoft.com/en-us/library/bb244515.aspx)

# silverlight - 防止显示 Silverlight ListBox 垂直滚动条

> ID：180777
> 
> 赞同：5
> 
> 时间：2008-10-07T23:03:54.477
> 
> 标签：silverlight, silverlight-2-rc0

我有一个 ListBox 显示可变高度的项目。我想在可用空间中显示尽可能多的项目，而不显示垂直滚动条。除了对 ListBox 项目模板进行手术外，有没有办法只显示不滚动即可适应的项目数量？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-07T23:30:08.743

```
 <ListBox ScrollViewer.VerticalScrollBarVisibility="Auto" /> 
```

默认可见

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T23:04:24.190

我认为默认值不是“可见”。我认为是“自动”。乔恩想将其设置为“隐藏”。

# ada - Ada 有免费的实现吗？

> ID：180778
> 
> 赞同：17
> 
> 时间：2008-10-07T23:04:02.353
> 
> 标签：ada

我查看了 AdaCore 站点以及 A#（现在似乎归 AdaCore 所有），但似乎都不是免费的（尽管我可能误读了某些内容）。有什么建议吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-08T03:40:21.907

GNAT 可在此处下载：[https ://libre.adacore.com/](https://libre.adacore.com/)

寻找“GNAT GPL 版”。不知道为什么它在那个鲜为人知的网站上隐藏得如此之好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-07T23:08:42.407

这是来自 Open Directory的[Ada 编译器](http://www.dmoz.org/Computers/Programming/Languages/Ada/Compilers/)的大列表。

[GNU Ada 编译器](http://gnuada.sourceforge.net/)似乎是一种更流行的编译器。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-07T23:06:49.417

GNAT，GNU Ada 实现：[http ://www.gnu.org/software/gnat/gnat.html](http://www.gnu.org/software/gnat/gnat.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-17T23:01:56.367

过去 ada 前端没有与 gcc 编译器一起打包，但现在当您安装大多数 linux 发行版时，gnat ada 编译器与 gcc 编译器捆绑在一起。当然，您自己的项目可能需要各种开发库，但 ada 前端就在那里。至少这是我在过去几年中使用 debian 和 ubuntu 的经验。

至于 AdaCore，他们隐藏了 gnat ada 编译器的 libre/free 版本，因为他们希望您购买支持；他们可以合法地做到这一点。但是，gcc 编译器是 GPL 并且被认为是开源的，这意味着您可以免费使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-21T15:20:28.470

[Thomas，您可以在http://libre.adacore.com/libre/](http://libre.adacore.com/libre/)中找到 GNAT Adacore Ada 框架的 GPL 版本，并从[http://libre.adacore.com/libre/download/](http://libre.adacore.com/libre/download/)下载。只需选择免费软件或学术开发和构建下载包。编译器是选项 gnat-gpl-2011-i686-pc-mingw32-bin.exe，但列表中还有几个附加库。

# solaris - 如何使用 tar -I 选项

> ID：180781
> 
> 赞同：0
> 
> 时间：2008-10-07T23:05:04.833
> 
> 标签：solaris, tar

我正在尝试仅在某个目录下的 Solaris 机器上压缩所有 *.class 文件。阅读 tar 的手册页使 -I 选项似乎是我想要的。这是我从有问题的目录中尝试过的：

```
find . -name "*.class" >> ~/includes.txt
tar cvf ~/classfiles.tar -I ~/includes.txt 
```

从中我得到：

```
tar: Removing leading `/' from member names
/home/myhomedir/includes.txt 
```

~/classfiles.tar 文件是垃圾。

我对 *.class 文件所在的目录没有写权限，所以我需要将 tar 写入我的主目录。有人能告诉我哪里出错了吗？我应该使用什么焦油魔法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T23:13:32.740

检查您正在运行的 tar。关于删除前导斜杠的消息是**gtar** (GNU tar) 消息，您尝试使用的 -I 选项是 Sun tar 选项（位于 /bin/tar 中）。

（至少以上在我的 Solaris 机器上都是正确的）

# java - 在 Java 中操作 ActiveX 对象的最佳/最简单方法是什么？

> ID：180784
> 
> 赞同：1
> 
> 时间：2008-10-07T23:07:39.100
> 
> 标签：java, com, activex

我想用 ActiveX 打开和操作 Excel 文件。我在其他项目上使用 Python 的[Win32 扩展](http://python.net/crew/mhammond/win32/Downloads.html)和 Groovy 的[Scriptom](http://groovy.codehaus.org/COM+Scripting)库取得了成功，但如果可能的话，这次需要做的是纯 Java。

我已经尝试过[Jacob Java COM Bridge](http://danadler.com/jacob/)，但这似乎并不那么简单或易于使用，而且我无法用它来检索单元格值（即使这是 Scriptom 底层的库）。有替代品吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T01:19:05.297

雅各布真的是这里工作的工具。我建议您花时间了解一下 COM 和 ActiveX 的工作原理，我想您会发现它更易于使用。COM 是一个相当大的成就，但它*很难*。像 VB 这样的包装器使它看起来很容易（对于它们工作的有限用途），但它一点也不容易。我有一本关于学习 COM 的好书，但现在手头没有名字......

您想了解 IDispatch 接口（这是大多数 Excel 的 COM 接口围绕它开发的）。这是一个令人讨厌的、讨厌的界面（其中一种病毒式的东西，你可以用它做很多事情，以至于无法判断实际发生了什么）——但学习它是关键。

如果您只在一个领域遇到问题（即从单元格中获取值），您可以获取 Scriptom 的源代码并查看它们的作用（毕竟是开源的！）。

另一个建议是尝试在 VBA 中实现代码的一些测试用例，并确保您正确考虑了所有返回值。当我们在我们的一个 Java 应用程序中进行 Excel 自动化时，我们从 Word 的 VBA 中实现了通用算法，解决了问题案例等......之后，转移到 Jacob 非常简单。

*   ķ

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T23:10:22.700

[http://www.nevaobject.com/_docs/_java2com/java2com.htm](http://www.nevaobject.com/_docs/_java2com/java2com.htm)怎么样——这是商业的，但效果更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T00:08:16.263

你看过 JExcelAPI 吗？这是一个直接读取和写入 Excel 文件的 Java 库，而不是使用 ActiveX。

不是对您的问题的确切答案，但它也可以解决问题，特别是如果您正在寻找纯 Java 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T01:07:53.837

还有[JIntegra](http://j-integra.intrinsyc.com/)，它做类似的事情。也是商业的。还有[JNIWrapper](http://www.teamdev.com/jniwrapper/index.jsf)，它做了类似的事情。再次，也是商业的。

# regex - 使用正则表达式调用替换分隔符内的模式

> ID：180793
> 
> 赞同：2
> 
> 时间：2008-10-07T23:13:46.140
> 
> 标签：regex

我需要剪掉所有出现在长字符串中的单引号*内*的模式“--” （保留单引号外的那些）。

有没有一种 RegEx 方法可以做到这一点？（将它与语言中的迭代器一起使用是可以的）。

例如，从

```
"xxxx rt / $ 'dfdf--fggh-dfgdfg' ghgh- dddd -- 'dfdf' ghh-g '--ggh--' vcbcvb" 
```

我应该最终得到：

```
"xxxx rt / $ 'dfdffggh-dfgdfg' ghgh- dddd -- 'dfdf' ghh-g 'ggh' vcbcvb" 
```

所以我正在寻找一个可以从以下语言运行的正则表达式，如图所示：

```
 +-------------+------------------------------------------+
    |  Language   |                  RegEx                   |
    +-------------+------------------------------------------+
    | JavaScript  |  input.replace(/someregex/g, "")         |
    | PHP         |  preg_replace('/someregex/', "", input)  |
    | Python      |  re.sub(r'someregex', "", input)         |  
    | Ruby        |  input.gsub(/someregex/, "")             |
    +-------------+------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T03:01:39.003

我从**Greg Hewgill**在[Qn138522](https://stackoverflow.com/questions/138552)
的回答中找到了另一种方法。 它基于使用这个正则表达式（适应包含我正在寻找的模式）：

```
--(?=[^\']*'([^']|'[^']*')*$) 
```

格雷格解释说：

> “这样做是使用非捕获匹配`(?=...)`来检查字符 x 是否在带引号的字符串中。它会查找一些非引号字符直到下一个引号，然后查找单个字符或带引号的字符组的序列，直到字符串的结尾。这依赖于你的假设，即引号总是平衡的。这也不是很有效。

使用示例将是：

*   JavaScript： `input.replace(/--(?=[^']*'([^']|'[^']*')*$)/g, "")`
*   PHP： `preg_replace('/--(?=[^\']*'([^']|'[^']*')*$)/', "", input)`
*   Python： `re.sub(r'--(?=[^\']*'([^']|'[^']*')*$)', "", input)`
*   红宝石：`input.gsub(/--(?=[^\']*'([^']|'[^']*')*$)/, "")`

我已经对 Ruby 进行了测试，它提供了所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T23:16:08.227

这不能用正则表达式来完成，因为您需要维护您是在单引号内还是在单引号外的状态，而正则表达式本质上是无状态的。（另外，据我了解，可以在不终止“内部”区域的情况下转义单引号）。

你最好的办法是逐个字符地遍历字符串，保持一个布尔标志你是否在一个带引号的区域内 - 并以这种方式删除 -- 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T23:41:41.683

如果允许稍微改变规则，这可能会起作用：

```
import re
p = re.compile(r"((?:^[^']*')?[^']*?(?:'[^']*'[^']*?)*?)(-{2,})")
txt = "xxxx rt / $ 'dfdf--fggh-dfgdfg' ghgh- dddd -- 'dfdf' ghh-g '--ggh--' vcbcvb"
print re.sub(p, r'\1-', txt) 
```

输出：

```
xxxx rt / $ 'dfdf-fggh-dfgdfg' ghgh- dddd -- 'dfdf' ghh-g '-ggh-' vcbcvb 
```

正则表达式：

```
(               # Group 1
  (?:^[^']*')?  # Start of string, up till the first single quote
  [^']*?        # Inside the single quotes, as few characters as possible
  (?:
    '[^']*'     # No double dashes inside theses single quotes, jump to the next.
    [^']*?
  )*?           # as few as possible
)
(-{2,})         # The dashes themselves (Group 2) 
```

如果开始和结束的分隔符不同，您可以使用以下内容：

```
-{2,}(?=[^'`]*`) 
```

* * *

**编辑：**我意识到如果字符串不包含任何引号，它将匹配字符串中的所有双破折号。解决它的一种方法是改变

```
(?:^[^']*')? 
```

一开始

```
(?:^[^']*'|(?!^)) 
```

更新的正则表达式：

```
((?:^[^']*'|(?!^))[^']*?(?:'[^']*'[^']*?)*?)(-{2,}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T23:33:39.393

嗯。如果没有带引号的撇号，Python 中*可能*有一种方法，因为正则表达式中有`(?(`*id/name* `)`*yes-pattern* `|`*no-pattern构造，但目前它超出了我的想象。*`)`

这有帮助吗？

```
def remove_double_dashes_in_apostrophes(text):
    return "'".join(
    part.replace("--", "") if (ix&1) else part
    for ix, part in enumerate(text.split("'"))) 
```

似乎对我有用。它的作用是将输入文本拆分为撇号上的部分，并仅在部分为奇数时替换“--”（即，在部分之前有奇数个撇号）。关于“奇数”的注意事项：零件编号从零开始！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T00:28:46.940

您可以使用以下 sed 脚本，我相信：

```
:again
s/'\(.*\)--\(.*\)'/'\1\2'/g
t again 
```

将其存储在文件 (rmdashdash.sed) 中，并在脚本语言中执行任何 exec 魔术，使您可以执行以下 shell 等效项：

sed -f rmdotdot.sed <*包含输入数据的文件*

该脚本的作用是：

**`:again`**<-- 只是一个标签

**`s/'\(.*\)--\(.*\)'/'\1\2'/g`**

替换模式 ' 后接任何内容，然后是 -- 后接任何内容，然后是 '，只需引号内的两个任何内容。

**`t again`**<-- 再次将生成的字符串送回 sed。

请注意，此脚本会将 '----' 转换为 ''，因为它是引号内的两个 -- 的序列。但是，'---' 将被转换为 '-'。

没有像老学校那样的学校。

# java - 让 JSF 视图生成对非 jsf 请求的响应的最佳方法是什么？

> ID：180796
> 
> 赞同：2
> 
> 时间：2008-10-07T23:15:16.077
> 
> 标签：java, jsf, servlets

我有一个 servlet，它与 JSF servlet 在同一个 Web 应用程序中。如何用 JSF 响应替换（而不是重定向）servlet 响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T00:05:39.827

不确定我是否完全理解您的问题 - 但如果您想在您的 servlet 响应中包含 JSF 页面的输出，例如：

```
public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException {
        // Do stuff
        req.getRequestDispatcher("/blah.jsf").forward(req, res);
        // Do other stuff
} 
```

应该做的伎俩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-24T18:05:34.670

我建议使用[urlrewritefilter](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/3.2/index.html)。

简单的

```
 <rule>
        <from>^/my/servlet/uri</from>
        <to>/jsfpage.jsf</to>
    </rule> 
```

应该足够了。

# python - In the Django admin interface, is there a way to duplicate an item?

> ID：180809
> 
> 赞同：76
> 
> 时间：2008-10-07T23:23:11.067
> 
> 标签：python, django, django-models, django-admin

Just wondering if there is an easy way to add the functionality to duplicate an existing listing in the admin interface?

In data entry we have run into a situation where a lot of items share generic data with another item, and to save time it would be very nice to quickly duplicate an existing listing and only alter the changed data. Using a better model structure would be one way of reducing the duplication of the data, but there may be situation where the duplicated data needs to be changed on an individual basis in the future.

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-10-07T23:26:15.867

You can [save as](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.save_as) by just enabling adding this to your ModelAdmin:

```
save_as = True 
```

这将“保存并添加另一个”按钮替换为“另存为”按钮。“另存为”表示对象将被保存为新对象（具有新 ID），而不是旧对象。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-04-10T11:10:08.127

这里有一个更好的（但不是内置的）解决方案：

[https://github.com/RealGeeks/django-modelclone](https://github.com/RealGeeks/django-modelclone)

从他们的自述文件中：

> Django Admin 有一个`save_as`功能，可以在更改页面中添加一个新按钮来保存该对象的新实例。
> 
> 我不喜欢此功能的工作方式，因为您将在单击该链接后立即保存原始对象的相同副本（如果您没有收到验证错误），并且如果您忘记进行您所做的小更改想要在新对象中，您最终会得到现有对象的副本。
> 
> 另一方面，django-modelclone 提供了一个中间视图，它基本上为您预先填写表单。所以你可以修改然后保存一个新实例。或者只是离开而没有副作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-12T16:04:02.750

您也可以应用此方法：[https ://stackoverflow.com/a/4054256/7995920](https://stackoverflow.com/a/4054256/7995920)

就我而言，在“名称”字段中具有唯一约束，此操作有效，并且可以从任何形式请求：

* * *

```
def duplicate_jorn(modeladmin, request, queryset):
    post_url = request.META['HTTP_REFERER']

    for object in queryset:
        object.id = None
        object.name = object.name+'-b'
        object.save()

    return HttpResponseRedirect(post_url) 
```

* * *

# asp.net - 没有任何 html 标记的数据库中的 asp.net 输出数据

> ID：180810
> 
> 赞同：1
> 
> 时间：2008-10-07T23:23:13.657
> 
> 标签：asp.net, jquery, ajax

我是 jquery 和 asp.net 的新手，所以如果这是一个明显的问题，请原谅。我正在使用一个 jquery 自动完成插件，它要求它异步查找数据的页面是这种格式的纯文本：

产品1|价格1 产品
2|价格2 产品3
|价格3

没有任何其他 HTML 标记。任何其他 html 标签似乎都会导致问题。通常对于这样的页面，我会使用转发器和一些标准数据库调用并输出 2 个字段。然而，这会创建 html 标签。

我如何才能将此数据输出为仅没有其他标记的文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T23:43:40.013

如果您有一个没有引用母版页的裸页面，则转发器不应生成任何 html。确保在 HTML 视图中您只有：

```
<asp:Repeater ID="outRepeater" runat="server">
- your template here
</asp:Repeater> 
```

另一种方法是向您的项目添加一个新的处理程序，该处理程序是一个实现 IHttpHandler 接口的类。这将允许您直接输出您的代码。这最终看起来像：

```
public class MyOutputHandler : IHttpHandler {
  public bool IsReusable { return false; }
  public void ProcessRequest(HttpContext context) {
    context.Response.Write("product1|price1");
  }
} 
```

如果您已将此作为新的处理程序（来自添加项）添加到项目中，则它应该具有 .ashx 扩展名。否则你需要在你的 web.config 中注册它的类型和文件名。

# asp.net - 表单发布后关闭浏览器窗口

> ID：180814
> 
> 赞同：1
> 
> 时间：2008-10-07T23:24:55.150
> 
> 标签：asp.net, javascript, html, reporting-services

这是我的情况。

我的 ASP.NET 网络表单上有一个按钮。此按钮创建一个新的浏览器窗口，指向一个包含许多隐藏字段（动态生成）的页面。此表单在 body onload 事件上将自身提交给 SQL Reporting Services。这工作正常，报告显示在这个新窗口中。

但是，现在我仍想将表单发布到 SQL 报告服务，但我想取回一个 Excel 电子表格。所以我添加了另一个隐藏输入，名称为 rs:Format 和 Excel 值。这有效，用户可以选择下载 excel 文件。

然而，他们现在被创建的额外窗口困住了。我该如何解决这个问题？我尝试在同一个窗口中创建动态表单和 POST，但随后他们看到了带有表单的（空）页面，而不是他们从中生成报告的页面。我试过关闭我创建的窗口，但我不知道在哪里放置 javascript 来执行此操作。如果我把它放在 onload 上，那么窗口会在没有提交表单的情况下关闭。

关于在这里做什么的任何想法？

编辑：我在这里所做的并不是获得所需结果的最佳方式。我最终使用 WebRequest 从 Reporting Services 获取 excel 报告，而不是发布表单，因此我根本不需要第二个窗口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T23:28:27.873

**不要**关闭浏览器。它属于用户，即使您打开它。关闭它会让他们生气。重定向到向用户传达您已完成窗口的页面
**。**在那里，您可以提供一个（基于 JavaScript 的）链接，如果您愿意，可以更轻松地关闭浏览器，但关闭浏览器窗口通常非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T23:39:42.797

顺便说一句，如果弹出窗口不包含任何有用的输出，您可能想要做的是将表单提交到页面内的一个小 Iframe 中。这样就不需要关闭窗口，因为框架可以变得不可见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T23:31:44.310

当用户想要一个 Excel 文件时，不需要弹出另一个窗口。我假设 Excel 文件或 HTML 报告的选择是在一些 HTML 控件中完成的，例如单选按钮或复选框。因此，在做任何事情之前，请使用 javascript 检查该单选按钮/复选框的值并执行适当的操作。就像是：

```
function getReport(excelFormat)
{
    if (excelFormat)
        document.form1.target = '_blank';
    else
        document.form1.target = '_self';
    document.form1.submit();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T00:21:04.493

如果按钮向原始页面发出 Ajax 请求并获得隐藏字段值怎么办。然后，您可以使用 javascript 在页面上构建另一个带有隐藏字段的表单并提交它 - 使用下载选项。由于该请求将返回一个 application/ms-excel 文件，因此它不应刷新当前页面，但仍应进行下载。您需要通过从客户端函数返回 false 来确保按钮单击不会导致回发。请注意，这仅适用于生成表单的发布导致下载，而不是新的 html 页面。

```
<script type="text/javascript">
   function submitReport( button ) {
      PageMethod.SubmitReport(onSuccess,onFailure,{ control: button });
   }

   function onSuccess(values,ctx) {
      var form = document.createElement('form');
      form.action = reporting-services.url;
      form.method = 'post';
      document.body.appendChild(form);
      .... add hidden fields to form from returned values
      form.submit();
      document.body.removeChild(form);
   }

   function onFailure(error,ctx) {
      ... pop up some error message....
   }

  </script>

  ...

  <asp:Button runat="server" id="reportButton" ClientClick="submitReport(this);return false;" Text="Report" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T23:32:08.257

通常可以关闭您的应用程序创建的任何弹出窗口。

这可以通过**window.close()**来完成（如果窗口不是由脚本创建的，它将弹出确认）。

如果您想在关闭窗口之前确保下载成功，您将需要执行一些服务器端魔术 - 让您的服务器跟踪正在进行的下载，并从弹出窗口通过 AJAX 轮询它，直到下载完成。

一旦服务器告诉你它已经完成，窗口就可以关闭了。

# vbscript - vbscript 中是否有与 Java 的 HashSet 等价的东西？

> ID：180822
> 
> 赞同：1
> 
> 时间：2008-10-07T23:29:54.737
> 
> 标签：vbscript

我必须在需要使用唯一集合的 vbscript 中编写一些东西。我正在寻找类似于 Java 的 HashSet 的东西，这已经在 vbscript 中还是我必须自己编写？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T00:06:21.573

它不完全相同，但 VBScript 有一个 Dictionary 对象，其行为类似于 Java 的 Map 或 Hashtable。

您几乎可以像使用 HashSet 一样使用它，只需在字典中查找作为键的项目并查找那里是否有任何值。当您想将某些东西放入集合中时，只需将其值设置为 1 或其他任何值。

# asp.net - 不显眼的 Javascript 富文本编辑器？

> ID：180827
> 
> 赞同：27
> 
> 时间：2008-10-07T23:31:46.807
> 
> 标签：asp.net, javascript, jquery

长期以来，我们一直将不再受支持的 RichTextBox 控件用作我们（基于 ASP.NET）CMS 的一部分，并且我们希望将其替换为更轻量级且具有更好跨浏览器支持的东西。我们最初正在研究各种 ASP.NET 组件，但我想知道我们是否最好只使用开源的全 Javascript 解决方案。

我最近改用 jQuery，我很惊讶可以在客户端使用非常紧凑的附加组件（如[Flexigrid](http://www.webplicity.net/flexigrid/)，当然[还有出色的 WMD](http://wmd-editor.com/) ）完成这些工作。我已经为全 Javascript 编辑器做了一些探索，这是我迄今为止发现的：

*   [巴蒂斯特 jQueryEditor](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html)
*   [新哈](http://xinha.webfactional.com/)
*   [YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)
*   [微型 MCE](http://tinymce.moxiecode.com/)
*   [FCK编辑器](http://www.fckeditor.net/demo/skins?skin=office2003)

经过表面的审查，Tiny MCE 看起来是个不错的选择；但我很想听听 SO 社区中实际使用过这些的人的意见。让我知道你的想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-07T23:37:50.117

我用过[TinyMCE](http://tinymce.moxiecode.com/)。跨浏览器很棒；易于配置，重量极轻，并允许您控制用户可以执行的操作。一些插件（例如图像管理器）非常棒且易于实现。很高兴它还支持 Google Spellchecker，因此您不需要在服务器上安装任何库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T23:35:09.793

我用过[FCKeditor](http://ckeditor.com/)，它是一个很好的编辑器。很容易使用。较新的版本具有非常好的跨浏览器支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-07T23:55:57.023

我用过 TinyMCE，我必须说我不是粉丝。它的主要问题是，当新版本发布时，API 可能会发生巨大变化，这使得管理升级变得非常困难。似乎很少考虑向后兼容性。

YUI 编辑器非常好，而且非常易于使用。据我所知，它仍然是测试版，所以我不确定我是否一定会在生产环境中推荐它。

FCK 是一个不错的编辑器，它支持 ASP.NET。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-16T12:56:42.393

有人提到过，但那一年丢失给 RadEditor 的记忆仍然困扰着我。

从好的方面来说，他们有令人难以置信的警惕，而且显然有很多支持人员。
因此，每当您需要找到导致特定日期的 RadBugs 的小东西时；
你知道你总是可以让他们酝酿一些自定义和模糊的迷你修复。

在与那只野兽接触了一年之后，我不得不撤退到田园 C64 GOTO 冒险以保持我的理智......

唉，我们都时不时需要我们所见即所得的编辑器，在 .NET 设置中尝试了 (F)CKeditor 和 TinyMCE 之后，我对两者都感到谦卑。

虽然会在枪口下选择 TinyMCE ......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T13:32:18.653

上周我也在寻找一个好的编辑器，尝试过 WMD，但与[markItUp](http://markitup.jaysalvat.com/examples/)相比，定制不够容易。扩展和自定义 markItUp 非常容易，无论是功能还是主题。

[OpenWYSIWYG](http://www.openwebware.com/wysiwyg/demo.shtml)也在我的列表中，但在尝试了 markItUp 之后，我被它卡住了。另外，OpenWYSIWYG 不是 jQuery，它是 JavaScript，而是开源和跨浏览器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-07T23:51:27.173

WebKit.org 有一个非常漂亮/微妙的文本编辑器的[演示](http://webkit.org/demos/editingToolbar/)，但我不知道它是否适用于 IE（它确实适用于基于 WebKit 的浏览器（显然）和 Firefox）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-08T00:00:10.977

我不知道您是否专门寻找免费/开源解决方案。其他人提到了许多伟大的开源编辑器。

如果您愿意查看商业解决方案，[Telerik](http://www.telerik.com/)提供了[RadEditor](http://www.telerik.com/products/aspnet-ajax/controls/editor/overview.aspx)。它与 ASP.NET 高度集成，支持所有主流浏览器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-28T12:42:42.207

如果您将有大量的连接带宽和耐心 :) 实际上，Telerik 是一个 ASP.NET 产品，它需要 asp.net ajax 框架用于运行时，它需要在运行页面上 ajax scriptmananer。在我看来，Telerik 不是这个主题的好例子。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-16T21:41:38.457

我目前正在寻找相同类型的编辑器 - 轻量级、jQuery 和 ASP.Net 支持。我遇到了[Batiste Bieler 的 jQuery 轻量级富文本编辑器](http://batiste.dosimple.ch/blog/2007-09-11-1/)，它看起来非常简单、漂亮、纯 jQuery 轻量级编辑器。

并且有[interpid studios 变体](http://www.intrepidstudios.com/projects/jquery-rich-text-editor/default.aspx)声明与 ASP.Net 兼容并基于上面提到的原始库（虽然，没有解释与 ASP.Net 兼容是什么以及不使原始与它兼容的问题也...）

我还没有尝试过其中任何一个，但我似乎会在接下来的几天内尝试，因为我正在寻找替换 FCK 编辑器，因为它对我的应用程序用户有一些怪癖和奇怪的行为。所以我可能会用我自己对这个/这些编辑器的经验来更新这篇文章。

如果有人已经尝试过，请发表评论，让其他人知道您对此有何感受。

# .net - 如何调试具有使用 app.config 文件的 .net 互操作项目的 VB6 项目？

> ID：180828
> 
> 赞同：10
> 
> 时间：2008-10-07T23:31:50.580
> 
> 标签：.net, vb6, interop, app-config

我有一个使用 app.config 文件的 .net 互操作项目。当我在调试模式下运行使用互操作控件的 VB6 项目时，ConfigurationManager 找不到 app.config 文件。当我将 VB6 项目制作成 exe 并将 app.config 文件重命名为（VB6 二进制名称）.exe.config 时，ConfigurationManager 可以找到该文件。

**有没有办法重命名 app.config 文件或更改设置，以便 ConfigurationManager 可以在 VB6 在调试模式下运行时找到 app.config 文件？**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-07T23:58:49.513

一个肮脏的hack是将app.config文件放入VB6文件夹并将其重命名为vb6.exe.config

# javascript - 最好的 javascript 语法糖

> ID：180841
> 
> 赞同：81
> 
> 时间：2008-10-07T23:35:56.423
> 
> 标签：javascript, language-features, syntactic-sugar

这里有一些宝石：

字面量：

```
var obj = {}; // Object literal, equivalent to var obj = new Object();
var arr = []; // Array literal, equivalent to var arr = new Array();
var regex = /something/; // Regular expression literal, equivalent to var regex = new RegExp('something'); 
```

默认值：

```
arg = arg || 'default'; // if arg evaluates to false, use 'default', which is the same as:
arg = !!arg ? arg : 'default'; 
```

我们当然知道匿名函数，但是能够将它们视为文字并在现场（作为闭包）执行它们很棒：

```
(function() { ... })(); // Creates an anonymous function and executes it 
```

**问题：** javascript 中还有哪些出色的语法糖？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-22T00:53:17.060

以毫秒为单位获取当前日期时间：

```
Date.now() 
```

例如，要计时一段代码的执行时间：

```
var start = Date.now();
// some code
alert((Date.now() - start) + " ms elapsed"); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-08T00:57:07.587

对象成员资格测试：

```
变种道具 = { a: 1, b: 2 };

("a" in props) // true
("b" in props) // true
("c" in props) // false

```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-07T23:41:07.817

在 Mozilla（据报道是 IE7）中，您可以使用以下方法创建 XML 常量：

```
var xml = <elem></elem>;

```

您也可以替换变量：

```
var elem = "html";
var text = "一些文字";
var xml = <{elem}>{文本}</{elem}>;

```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-10-08T00:21:02.573

使用匿名函数和闭包创建私有变量（信息隐藏）和相关的 get/set 方法：

```
var getter, setter;

(function()
{
   var _privateVar=123;
   getter = function() { return _privateVar; };
   setter = function(v) { _privateVar = v; };
})() 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-08T00:11:35.760

能够通过原型继承来扩展原生 JavaScript 类型。

```
String.prototype.isNullOrEmpty = function(input) {
    return input === null || input.length === 0;
} 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-10-07T23:45:23.423

用于`===`比较值**和**类型：

```
变量 i = 0;
变量 s = "0";

if (i == s) // 真

if (i === s) // 假

```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2008-10-08T00:13:41.730

多行字符串：

```
var str = "这是\
一个\
细绳。”;

```

由于您不能在不将空格添加到字符串中的情况下缩进后续行，因此人们通常更喜欢与加号运算符连接。但这确实提供了很好的[此处文档](http://en.wikipedia.org/wiki/Heredoc)功能。

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2009-08-28T07:07:37.743

**调整数组长度**

length 属性**不是只读**的。您可以使用它来增加或减少数组的大小。

```
var myArray = [1,2,3];
myArray.length // 3 elements.
myArray.length = 2; //Deletes the last element.
myArray.length = 20 // Adds 18 elements to the array; the elements have the empty value. A sparse array. 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2008-11-21T13:41:51.270

通过在空数组上利用 join 方法重复特定次数的字符串（例如“-”）：

```
var s = new Array(repeat+1).join("-"); 
```

当重复 == 3 时，结果为“---”。

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2010-08-20T08:10:27.470

与默认运算符一样，`||`是守卫运算符，`&&`.

```
answer = obj && obj.property 
```

与

```
if (obj) {
    answer = obj.property;
}
else {
    answer = null;
} 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2009-03-31T13:37:26.757

```
var tags = {
    name: "Jack",
    location: "USA"
};

"Name: {name}<br>From {location}".replace(/\{(.*?)\}/gim, function(all, match){
    return tags[match];
}); 
```

字符串替换的回调很有用。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2008-10-08T09:30:29.797

[获取器和设置器](http://ejohn.org/blog/javascript-getters-and-setters/)：

```
function Foo(bar)
{
    this._bar = bar;
}

Foo.prototype =
{
    get bar()
    {
        return this._bar;
    },

    set bar(bar)
    {
        this._bar = bar.toUpperCase();
    }
}; 
```

给我们：

```
>>> var myFoo = new Foo("bar");
>>> myFoo.bar
"BAR"
>>> myFoo.bar = "Baz";
>>> myFoo.bar
"BAZ" 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-10-07T23:46:48.803

这不是 javascript 独有的，但可以保存三行代码：

```
check ? value1 : value2 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-08T00:07:27.640

更多关于列维克的例子：

```
var foo = (condition) ? value1 : value2; 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-08T11:24:41.860

Javascript 1.6 上的[Array#forEach](http://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Objects:Array:forEach)

```
myArray.forEach(function(element) { alert(element); }); 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-08-03T09:10:52.057

关注 obj || {default:true} 语法：

用这个调用你的函数： hello(neededOne && neededTwo && needThree) 如果一个参数未定义或为假，那么它将调用 hello(false)，**有时**很有用

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-10-12T20:16:00.580

在解析具有一组固定组成部分的情况下：

```
var str = "John Doe"; 
```

您可以使用“解构赋值”语法将结果直接赋值给变量：

```
var [fname, lname] = str.split(" ");
alert(lname + ", " + fname); 
```

这比以下更具可读性：

```
var a = str.split(" ");
alert(a[1] + ", " + a[0]); 
```

交替：

```
var [str, fname, lname] = str.match(/(.*) (.*)/); 
```

请注意，这是[Javascript 1.7](http://en.wikipedia.org/wiki/JavaScript#Versions)的功能。这就是 Mozilla 2.0+ 和 Chrome 6+ 浏览器，此时。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-06-06T05:46:26.137

立即调用箭头函数：

```
var test = "hello, world!";
(() => test)(); //returns "hello, world!"; 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-09T06:33:51.697

我忘了：

```
(function() { ... }).someMethod(); // Functions as objects 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-09-06T16:49:36.380

简单地创建一个匿名对象文字： ({})

示例：需要知道对象是否具有 valueOf 方法：

var hasValueOf = !!({}).valueOf

额外的语法糖：双重不是'!!' 非常简洁地将几乎任何东西转换为布尔值。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-08T03:02:47.083

我喜欢能够 eval() 一个 json 字符串并取回一个完全填充的数据结构。我讨厌必须至少写两次（一次用于 IE，一次用于 Mozilla）。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-08-03T09:31:10.760

将常用关键字（或任何方法）分配给简单的变量，如 ths

```
 var $$ = document.getElementById;

  $$('samText'); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2010-08-19T18:30:20.783

JavaScript 的 Date 类提供了一个半“流利的接口”。这弥补了无法直接从 Date 类中提取日期部分：

```
var today = new Date((new Date()).setHours(0, 0, 0, 0)); 
```

它不是一个完全流畅的接口，因为下面只会给我们一个实际上不是 Date 对象的数值：

```
var today = new Date().setHours(0, 0, 0, 0); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-08-19T21:02:21.380

默认回退：

```
var foo = {}; // empty object literal

alert(foo.bar) // will alert "undefined"

alert(foo.bar || "bar"); // will alert the fallback ("bar") 
```

一个实际的例子：

```
// will result in a type error
if (foo.bar.length === 0)

// with a default fallback you are always sure that the length
// property will be available.
if ((foo.bar || "").length === 0) 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-03-10T09:33:16.583

我喜欢使用列表的简单性：

```
var numberName = ["zero", "one", "two", "three", "four"][number]; 
```

和哈希：

```
var numberValue = {"zero":0, "one":1, "two":2, "three":3, "four":4}[numberName]; 
```

在大多数其他语言中，这将是非常繁重的代码。默认值也很可爱。例如错误代码报告：

```
var errorDesc = {301: "Moved Permanently",
                 404: "Resource not found",
                 503: "Server down"
                }[errorNo] || "An unknown error has occurred"; 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2011-04-11T23:21:18.327

这是我刚刚发现的一个：调用函数之前的空检查：

```
a = b && b.length; 
```

这是一个较短的等价于：

```
a = b ? b.length : null; 
```

最好的部分是您可以检查属性链：

```
a = b && b.c && b.c.length; 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-03-31T13:49:59.317

int 到字符串转换

```
var i = 12;
var s = i+""; 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-09-01T07:55:50.877

```
element.innerHTML = "";  // Replaces body of HTML element with an empty string. 
```

删除元素所有子节点的快捷方式。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-07-06T13:08:36.997

将字符串转换为整数，如果不可能，默认为 0，

```
0 | "3" //result = 3
0 | "some string" -> //result = 0
0 | "0" -> 0 //result = 0 
```

在某些情况下可能很有用，主要是当 0 被认为是不好的结果时

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-09-20T05:57:36.710

**[模板文字](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)**

```
var a = 10;
var b = 20;
var text = `${a} + ${b} = ${a+b}`; 
```

那么**文本**变量将如下所示！

> 10 + 20 = 30

# svn - 如何在 CodePlex 上镜像 SVN 存储库？

> ID：180843
> 
> 赞同：4
> 
> 时间：2008-10-07T23:36:29.433
> 
> 标签：svn, codeplex, svnbridge

我是 CodePlex 项目的创建者（也是迄今为止唯一的开发者）。我已经在我的笔记本电脑上写了它，使用我家庭网络上的 Subversion 存储库。

通过 TeamServer 界面提交我对 CodePlex 的更改让我发疯，我真的很想要一种通过新的 SVN 界面将我的 svn 存储库与 CodePlex 同步的简单方法。svnsync 或 synmerge 似乎是要走的路，但对于一个只使用过 TortoiseSVN 的人来说，这两个指令似乎都不清晰。而且他们似乎也需要对目标服务器进行本地访问（这对于 CodePlex 来说显然是不可能的）

那么，有人可以给出简单的说明如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T12:18:18.040

CodePlex 存储库运行 SvnBridge 而不是真正的 Subversion 服务器。我认为 SvnBridge 不支持 svnsync 接收更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T00:06:19.530

正如您在[文档](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)中所见，svnsync 需要对目标服务器的独占（但不是本地）访问。这使它不适合您的目的，因为它会使其他开发人员无法访问 CodePlex 存储库（当他们来时；））。

不过，您可能会考虑另一种方式：始终提交到 CodePlex 存储库，并使用 svnsync 来保留它的本地（和只读）镜像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T17:45:19.050

为什么你不能只使用 Subversion 客户端与 Codeplex 存储库通信（他们现在托管 SvnBridge）

另请参阅[http://www.codeplex.com/CodePlex/Wiki/View.aspx?title=Source%20Control%20Clients](http://www.codeplex.com/CodePlex/Wiki/View.aspx?title=Source%20Control%20Clients)

# javascript - 引用 javascript 对象字面量数组

> ID：180844
> 
> 赞同：8
> 
> 时间：2008-10-07T23:36:35.783
> 
> 标签：javascript, data-structures

您将如何引用此结构中的模型（雅阁、CRV、普锐斯等）？这是一个能够提取品牌的糟糕结构......然后使用品牌来获取模型......然后使用模型来获取选项？

```
var cars = [
    {
        "makes"   : "Honda",
        "models"   : [
            {'Accord' : ["2dr","4dr"]} ,
            {'CRV'    : ["2dr","Hatchback"]} ,
            {'Pilot'  : ["base","superDuper"] }
        ]
    }, 
    {
        "makes"   : "Toyota",
        "models"  : [
            {'Prius'   : ["green","reallyGreen"]} ,
            {'Camry'   : ["sporty","square"]} ,
            {'Corolla' : ["cheap","superFly"] }
        ]
    }
]; 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-08T00:39:33.363

结构：

```
var cars = [
    { name: 'Honda', models: [
                { name: 'Accord', features: ['2dr', '4dr'] },
                { name: 'CRV', features: ['2dr', 'Hatchback'] },
                { name: 'Pilot', features: ['base', 'superDuper'] }
        ]},

    { name: 'Toyota', models: [
                { name: 'Prius', features: ['green', 'superGreen'] },
                { name: 'Camry', features: ['sporty', 'square'] },
                { name: 'Corolla', features: ['cheap', 'superFly'] }
        ]}
]; 
```

[我在这里](https://stackoverflow.com/questions/180451/using-javascript-and-jquery-to-populate-related-select-boxes-with-array-structu#180926)写了遍历和其他所有内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-07T23:39:51.050

~~cars[0].models.Accord cars[0].models.CRV cars[0].models.Pilot~~（见[olliej](https://stackoverflow.com/questions/180844/#180861)的回答）

不过，使用以下访问概念可能更容易：

```
cars.Honda.Accord
cars.Toyota.Prius 
```

...使用...

```
var cars = {
  Honda : {
    Accord : ["2dr", "4dr"],
    CRV    : ["2dr", "Hatchback"],
    Pilot  : ["base", "superDuper"]
  },
  Toyota : {
    Prius : ["green", "reallyGreen"],
    Camry : ["sporty", "square"],
    Corolla : ["cheap", "superFly"]
  }
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T23:44:11.960

乔纳森是正确的，但他错过了模型级别的 Array 的附加级别，所以应该是

```
 cars[0].models[0].Accord
 cars[0].models[1].CRV 
```

ETC

我怀疑您会发现使用以下结构更容易：

```
var cars = [
{makes  : "Honda",
 models  : {
    Accord : ["2dr","4dr"],
    CRV  : ["2dr","Hatchback"],
    Pilot: ["base","superDuper"]  
 }
}, 
{makes   :"Toyota",
 models  : {
    Prius   : ["green","reallyGreen"],
    Camry   : ["sporty","square"],
    Corolla : ["cheap","superFly"]
 }
}]; 
```

其中`models`数组被一个对象（或关联数组，如果你喜欢）替换

[编辑（olliej）：在第二个示例中整理代码]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T00:30:00.200

您可以使用以下代码遍历模型：

```
for (var i = 0, carslen = cars.length; i < carlen; i++) {
    for (var j = 0, modelslen = cars[i].models.length; j < modelslen; j++) {
        // 对 cars[i].models[j] 做一些事情
    }
}

```

但我同意 Olliej 关于将 JSON 的结构更改为他的格式的观点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T23:44:52.117

如果我是你，我不会将你所有的数据集中到一个大的多维数组/对象字面量中。我会封装每个对象并使用方法来访问数据。它对你的大脑的干扰会少很多。

# mfc - CEdit控件最大长度？（可以显示的字符）

> ID：180853
> 
> 赞同：11
> 
> 时间：2008-10-07T23:40:37.210
> 
> 标签：mfc, string, character, cedit

MFC 中 CEdit 控件中包含的文本字符串的最大长度是多少？尝试在字符 30001 之后添加字符时发出哔哔声，这是否记录在任何地方？我可以在 CEdit 中显示更长的文本吗？我应该使用其他控件吗？

正如下面的“Windows 程序员”所说，用户键入时的文本长度限制与我们使用 SetWindowText 以编程方式设置文本时的文本长度限制不同。任何地方都没有提到以编程方式设置文本的限制。用户输入的默认文本长度限制是错误的。（见下面我自己的帖子）。

我猜在我调用 pEdit->SetLimitText(0) 之后，编程和用户输入文本长度的限制都是 7FFFFFFE 字节。我对吗？

在 vista 中，将超过 40000 个字符的文本粘贴到 CEdit 中时，它会变得无响应。我之前是否调用过 SetLimitText(100000) 并不重要。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-08T19:35:29.903

当提到 vista 中单行 CEdit 控件的默认大小时，我发现文档是错误的。

我运行了这段代码：

```
CWnd* pWnd = dlg.GetDlgItem(nItemId);
CEdit *edit = static_cast<CEdit*>(pWnd); //dynamic_cast does not work
if(edit != 0)
{
    UINT limit = edit->GetLimitText(); //The current text limit, in bytes, for this CEdit object.
    //value returned: 30000 (0x7530)
    edit->SetLimitText(0);
    limit = edit->GetLimitText();
    //value returned: 2147483646 (0x7FFFFFFE) 
} 
```

该文件指出：

> 在调用 EM_SETLIMITTEXT 之前，用户可以在编辑控件中输入的文本量的默认限制是 32,767 个字符。

这显然是错误的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-08T04:30:17.717

您可以通过在控件上调用[CEdit::GetLimitText()](http://msdn.microsoft.com/en-us/library/xctw3bfb(VS.80).aspx)来找出控件的最大值。这将返回字符数据的最大大小（以字节为单位）。[您可以使用CEdit::SetLimitText()](http://msdn.microsoft.com/en-us/library/c4db48kc(VS.80).aspx)函数更改最大大小。

SetLimitText() 函数相当于发送一个[EM_SETLIMITTEXT](http://msdn.microsoft.com/en-us/library/bb761647(VS.85).aspx)消息。该消息的文档提供了可以使用的最大大小，但由于这些是 MSDN 链接，明天可能会被破坏，我将复制相关信息:)

UINT 参数解释为：

> 用户可以输入的最大 TCHAR 数。对于 ANSI 文本，这是字节数；对于 Unicode 文本，这是字符数。此数字不包括终止空字符。丰富的编辑控件：如果此参数为零，则文本长度设置为 64,000 个字符。
> 
> Windows NT/2000/XP 上的编辑控件：如果此参数为零，则文本长度设置为单行编辑控件的 0x7FFFFFFE 字符或多行编辑控件的 –1。
> 
> Windows 95/98/Me 上的编辑控件：如果此参数为零，则文本长度设置为单行编辑控件的 0x7FFE 字符或多行编辑控件的 0xFFFF。

此外，从备注部分：

> 在调用 EM_SETLIMITTEXT 之前，用户可以在编辑控件中输入的文本量的默认限制是 32,767 个字符。
> 
> Windows NT/2000/XP 上的编辑控件：对于单行编辑控件，文本限制为 0x7FFFFFFE 字节或 wParam 参数的值，以较小者为准。对于多行编辑控件，此值为 –1 字节或 wParam 参数的值，以较小者为准。
> 
> Windows 95/98/Me 上的编辑控件：对于单行编辑控件，文本限制为 0x7FFE 字节或 wParam 参数的值，以较小者为准。对于多行编辑控件，此值是 0xFFFF 字节或 wParam 参数的值，以较小者为准。

我认为他们在第二段中的意思是 0xFFFFFFFF 而不是 -1 ......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T04:48:54.840

“（它可以显示的字符）”！=“尝试添加字符时”。

“尝试添加字符时”==“用户可以输入的最大 TCHAR 数”，除非您的意思是以编程方式尝试添加字符。

"0x7FFFFFFE characters" != "0x7FFFFFFE bytes" 除了有时，引用的 MSDN 文本有时可以理解这一事实。

我敢打赌没有人知道原始问题的答案。但是“0x7FFFFFFE 字节”可能是众多限制之一。

# procedural - 程序音乐生成技术

> ID：180858
> 
> 赞同：89
> 
> 时间：2008-10-07T23:43:05.940
> 
> 标签：procedural, generative

一段时间以来，我一直在对内容的程序生成进行大量思考，但我从未见过对程序音乐进行太多实验。我们拥有用于生成模型、动画、纹理的绝妙技术，但音乐仍然要么是完全静态的，要么是简单的分层循环（例如 Spore）。

正因为如此，我一直在思考最佳的音乐生成技术，我很好奇其他人的想法。即使你以前没有考虑过，你认为什么会很好用？请每个答案使用一种技术，并在可能的情况下包括示例。该技术可以使用现有数据或完全从头开始生成音乐，可能是基于某种输入（情绪、速度等）。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-08T01:47:04.257

最成功的系统可能会结合多种技术。我怀疑你会找到一种适用于所有音乐流派的旋律、和声、节奏和低音序列生成的技术。

[例如，马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain#Music)非常适合旋律和和声序列的生成。这种方法需要分析现有歌曲来构建链转换概率。马尔可夫链的真正美妙之处在于状态可以是任何你想要的。

*   对于旋律生成，尝试与键相关的音符编号（例如，如果键是 C 小调，则 C 为 0，D 为 1，D# 为 2，依此类推）
*   对于和声生成，请尝试将和弦根音的键相关音符编号、和弦类型（大调、小调、减音、增音等）和和弦的转位（根音、第一或第二）组合起来

[神经网络](http://en.wikipedia.org/wiki/Artificial_neural_network)非常适合[时间序列预测](http://en.wikipedia.org/wiki/Time_series_prediction)（预测），这意味着当针对现有流行旋律/和声进行训练时，它们同样适合“预测”音乐序列。最终结果将类似于马尔可夫链方法。除了减少内存占用之外，我想不出马尔可夫链方法有什么好处。

除了音高，您还需要持续时间来确定生成的音符或和弦的节奏。您可以选择将此信息合并到马尔可夫链状态或神经网络输出中，或者您可以单独生成它并组合独立的音高和持续时间序列。

[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)可用于进化节奏部分。一个简单的模型可以使用二进制[染色体](http://en.wikipedia.org/wiki/Chromosome_(genetic_algorithm))，其中前 32 位表示底鼓的模式，第二个 32 位表示小鼓，第三个 32 位表示关闭的踩镲，依此类推。在这种情况下，缺点是它们需要持续的人工反馈来评估新进化模式的适用性。

专家[系统](http://en.wikipedia.org/wiki/Expert_system)可用于验证由其他技术生成的序列。这种验证系统的知识库可能可以从任何好的音乐理论书籍或网站中获取。试试 Ricci Adams 的[musictheory.net](http://www.musictheory.net/)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-07T23:45:15.563

元胞自动机 -[阅读](http://tones.wolfram.com/about/how-it-works/)。

你也可以在[这里](http://tones.wolfram.com/generate/)试试。

**编辑：**

rakkarage 提供了另一个资源：[http ://www.ibm.com/developerworks/java/library/j-camusic/](http://www.ibm.com/developerworks/java/library/j-camusic/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-07-08T12:12:02.623

对这些技术进行了 50 多年的研究，但经常被不熟悉计算机音乐和算法作曲历史的开发人员所忽视。可以在此处找到解决这些问题的许多系统和研究示例：

[http://www.algorithmic.net](http://www.algorithmic.net)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-08T00:14:07.407

一种简单且有效的算法是使用 1/f 噪声（又称“粉红噪声”）从音阶中选择持续时间和音符。这听起来有点像音乐，可以作为一个很好的起点。

更好的算法是使用“马尔可夫链”。扫描一些示例音乐并建立一个概率表。在最简单的情况下，可能是 C 有 20% 的可能性跟随 A。为了更好地说明这一点，请查看过去几个音符的顺序，例如“CA B”有 15% 的可能性跟随 B，和 4% 可能后面跟着一个 Bb 等。然后，只需使用先前选择的音符的概率来选择音符。这个非常简单的算法产生了非常好的结果。

[用于音乐生成的马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain#Music)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-06T11:24:34.037

Dmitri Tymoczko 在这里有一些有趣的想法和例子：

[http://music.princeton.edu/~dmitri/whatmakesmusicsoundgood.html](http://music.princeton.edu/~dmitri/whatmakesmusicsoundgood.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-08T01:08:41.040

[我的软件](http://www.musigenesis.com)使用应用进化论来“发展”音乐。这个过程类似于 Richard Dawkins 的[The Blind Watchmaker](http://en.wikipedia.org/wiki/The_Blind_Watchmaker)计划——MusiGenesis 随机添加音乐元素，然后用户决定是否保留每个添加的元素。这个想法是只保留你喜欢的东西，抛弃任何听起来不正确的东西，而且你不需要接受任何音乐训练来使用它。

界面爆炸，但它很旧 - 起诉我。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-18T09:56:26.300

我一直很喜欢使用 iMuse 系统的老 Lucasarts 游戏，它为游戏制作了永无止境的反应式配乐，而且非常具有音乐性（因为大部分仍然是由作曲家创作的）。您可以在此处找到规格（包括专利）： [http ://en.wikipedia.org/wiki/IMUSE](http://en.wikipedia.org/wiki/IMUSE)

任天堂似乎是唯一一家仍然使用类似于 iMuse 的方法来即时创作或影响音乐的公司。

除非你的项目是非常实验性的，否则我不会放弃使用作曲家——真正的人类作曲家会比算法产生更多的音乐和可听的结果。

把它比作写一首诗：你可以很容易地写出听起来很前卫的无意义的诗歌，但是用算法来复制莎士比亚是困难的，委婉地说。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-08T01:25:14.767

对非无聊程序音乐生成的研究可以追溯到很久以前。浏览计算机音乐杂志的新旧问题 [http://www.mitpressjournals.org/cmj](http://www.mitpressjournals.org/cmj) （没有真实域名？）这是音乐合成修补匠、烙铁骑师、牧民和学术研究人员实际使用的严肃技术文章。这不是诸如在主要书店中可以找到的几本杂志之类的蓬松评论和采访。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-11-04T06:23:30.093

你看过 SoundHelix (http://www.soundhelix.com) 吗？这是一个用于算法随机音乐创作的开源 Java 框架，可以产生非常整洁的音乐。您可以将 SoundHelix 用作独立应用程序、嵌入网页的小程序、基于 JNLP 的小程序，或者您可以将其包含到您自己的 Java 程序中。

可以在此处找到使用 SoundHelix 生成的示例：http: [//www.soundhelix.com/audio-examples](http://www.soundhelix.com/audio-examples)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-11-11T15:20:45.037

这么大的题目。您可以在 morganpackard.com 上查看我的 iPad 应用程序、Thicket 或我的 Ripple 软件。根据我的经验，大多数动态音乐生成的学术方法都提出了听起来很学术的东西。我认为在俱乐部/电子世界的边缘可以找到更成功的东西。在这方面，Monolake 是我的英雄。非常好听的东西，非常计算机生成的。我自己的音乐也不错。Paul Lansky 的“Alphabet Book”是非常好听的算法音乐的一个很好的例子，特别是考虑到他是一个学术人士。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-07T23:50:50.527

我一直在考虑的技术是创建小的音乐模式，最多一个小节左右。用感觉标识符标记这些模式，例如“兴奋”、“强烈”等。当您想为某种情况生成音乐时，请根据这些标签选择一些模式并选择您想要演奏的乐器。根据乐器，弄清楚如何组合模式（例如，在钢琴上，您可能可以一起演奏，这取决于手的跨度，在吉他上，您可以快速连续演奏音符），然后将其渲染到 PCM . 此外，您可以更改键、更改速度、添加效果等。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-07T23:58:47.453

你所描述的具体技术是托马斯杜比在十年或十五年前研究的，虽然我现在不记得他叫什么了，所以我不能给你一个好的搜索词。

但是请参阅[此](http://en.wikipedia.org/wiki/Algorithmic_composition)Wikipedia 文章和[此](http://ask.metafilter.com/15809/Nonlinar-Music)Metafilter 页面。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-12-12T04:56:45.743

《[算法组合](https://rads.stackoverflow.com/amzn/click/com/321175539X "算法组合")》一书很好地介绍了所使用的几种方法：

“涵盖的主题包括：马尔可夫模型、生成语法、过渡网络、混沌和自相似性、遗传算法、元胞自动机、神经网络和人工智能。”

这是这个广泛主题的一个很好的起点，但是它从未深入描述每种方法的工作原理。它提供了对每一个的很好的概述，但如果您还没有关于它们的知识，这还不够。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-07T23:53:12.707

早在 90 年代后期，微软就创建了一个名为“交互式音乐控件”的 ActiveX 控件，它可以满足您的需求。不幸的是，他们似乎已经放弃了这个项目。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-31T18:31:39.087

不完全是您所追求的，但我知道有人研究自动生成 DJ 集，称为[基于内容的音乐相似度](http://www.innovexpo.itee.uq.edu.au/2003/exhibits/s363304/)。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-31T18:32:48.787

如果您对音乐如何联系在一起的更深层次的理论感兴趣，[Bill Sethares 网站](http://eceserv0.ece.wisc.edu/~sethares/)有一些有趣的转折。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-27T20:45:40.887

我一直在研究这个项目提案 -来自哥本哈根大学计算机系的“编程语言的理论与实践”研究组的[“8.1 ”：](http://www.diku.dk/hjemmesider/ansatte/simonsen/projects/spr09.pdf)

> 8.1 音乐语料库的自动采集和统计分析
> 
> 传统的乐谱分析包括一个或多个人分析单个乐曲的节奏、和弦序列和其他特征，设置在同一作曲家或同一时期的其他作曲家对其他乐曲的模糊比较的背景下。
> 
> 传统的自动音乐分析几乎没有处理活页乐谱，而是专注于信号分析和使用机器学习技术来提取和分类，比如情绪或流派。相比之下，DIKU 的初期研究旨在实现乐谱分析的部分自动化。附加值是从大量活页乐谱中提取信息的潜力，这些信息不能用手轻易完成，也不能通过机器学习技术进行有意义的分析。

这 - 如我所见 - 与您的问题相反，生成的数据 - 我想 - 可用于某些程序生成音乐的实例。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-11-04T04:08:00.643

我的观点是，生成音乐只有经过严格的选择过程才能发挥作用。算法音乐先驱大卫·科普（David Cope）会从他的算法（我认为这些算法主要基于马尔可夫链）中进行数小时的音乐输出，以挑选出少数实际上表现良好的音乐。

我认为这个选择过程可以通过对特定音乐风格的特征进行建模来自动化。例如，“迪斯科”风格会为带有非节拍和鼓声部分的贝斯线加分，在反拍上带有圈套，但会因严重不和谐的和声而减分。

事实是，音乐创作过程充满了如此多的惯用做法，如果没有该领域的具体知识，它们很难建模。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-05-06T22:13:15.757

我一直在研究用于程序音乐的 Python 模块。我只是将我所知道的关于音符、音阶和和弦构造的知识编程出来，然后能够让它从这些约束中随机生成内容。我敢肯定，这样的系统可以教授更多的理论和模式，尤其是由更了解该主题的人来教授。然后，您可以将这些系统用作遗传算法或随机内容生成的约束。

您可以在[此处查看](http://davywybiral.blogspot.com/2010/10/python-musical-update.html)我的实现，尤其是随机生成的主要示例可能对您有用。对和弦进行有深入了解的人可以使用这样的技术创建歌曲结构，并在其上实现这样的受限随机旋律。我的音乐理论知识并没有延伸到那么远。

但基本上，您需要对您想要生成的音乐类型的理论进行编码，然后将其用作某些算法的约束，以便在程序上探索该理论的范围。

# mfc - CString 最大长度

> ID：180860
> 
> 赞同：5
> 
> 时间：2008-10-07T23:43:44.520
> 
> 标签：mfc, cstring

CString 对象可以容纳的最大字符长度是多少？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-07T23:47:39.833

取决于您的可用内存或 INT_MAX-1（以较小者为准）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T23:47:40.300

INT_MAX - 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T02:14:23.640

[2,147,483,647 个](http://msdn.microsoft.com/en-us/library/8a994dfk(VS.80).aspx)字符

# c++ - C/C++ 中最好的加密库是什么？

> ID：180870
> 
> 赞同：58
> 
> 时间：2008-10-07T23:48:28.193
> 
> 标签：c++, c, encryption

什么是 C/C++ 中最好的加密库 在以下方面：

*   熵
*   质量
*   使用方便
*   可读性
*   可移植性
*   表现

你最喜欢什么，为什么喜欢它？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-07T23:51:36.720

我们已经成功地使用了[OpenSSL 。](http://www.openssl.org/)便携、符合标准且易于使用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-08T08:36:03.773

我过去使用过 CryptoPP ( [http://www.cryptopp.com/](http://www.cryptopp.com/) )，虽然它的 API 风格和编程范式需要一点时间来适应，但我最终还是喜欢它。它提供了广泛的对称和非对称算法，具有很大的灵活性。文档一般，API 文档在那里，但几乎没有“高级”概述和简单的示例代码。我最终将网上的一些代码拼凑在一起。很容易集成到我的项目中（静态链接）。我开始使用 MSVC - 2003 时使用它，现在切换到 2008。它可以跨多个平台移植（查看网站）。我一直用默认的RNG，不知道是哪个。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-07T23:53:12.177

我将不得不使用[LibTomCrypt](https://github.com/libtom/libtomcrypt)。对于 OpenSSL，它经常被忽视，但 TomCrypt 就是如此轻量级和简单。至于质量，TomCrypt 被广泛接受为顶级加密。此外，它的许可证是公共领域的，这避免了 BSD 许可证在编写商业软件时给您带来的文档归属麻烦。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-08T03:02:22.903

[Crypto++](https://cryptopp.com)似乎名声很好

维基百科 - [https://en.wikipedia.org/wiki/Crypto%2B%2B](https://en.wikipedia.org/wiki/Crypto%2B%2B)

GitHub - [https://github.com/weidai11/cryptopp](https://github.com/weidai11/cryptopp)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-07T23:58:09.780

我最喜欢的是 GNU 的库：

[libgcrypt](http://www.gnu.org/software/libgcrypt/)

它的性能很好，它在任何地方都被使用，所以它经过了很好的测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-08T01:15:56.767

C++ 版本尚未发布，但 goolge KeyCzar [http://code.google.com/p/keyczar/](http://code.google.com/p/keyczar/)可能值得一看。无论您对他们的业务有何看法，他们确实有很多聪明的程序员为他们工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-08T15:17:05.917

[GPME](http://www.gnupg.org/related_software/gpgme/index.en.html) . 易于使用且与[OpenPGP 格式兼容](http://www.ietf.org/rfc/rfc4880.txt)

# wpf - 有没有办法在 100% 托管代码中编写 BitmapEffect？

> ID：180875
> 
> 赞同：1
> 
> 时间：2008-10-07T23:51:31.947
> 
> 标签：wpf, bitmapeffect

有没有办法在 100% 托管代码中编写 BitmapEffect？我知道它的运行速度会比使用非托管代码慢很多，但我想编写一个 BitmapEffect，但自从我完成任何 C++ 编程以来已经有很长时间了，而且应用程序可能必须在部分信任下运行（所以不允许使用非托管代码）。该效果将很少在静态内容上运行。只需获取渲染内容的位图并返回更改内容的位图就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T23:56:06.913

在你走那条路之前，你有没有看到这个：

[基于 GPU 的效果](http://blogs.msdn.com/llobo/archive/2008/05/30/gpu-based-effects.aspx)

这是一系列关于将效果（在 .NET 3.5SP1 中支持）编写为在 GPU 上运行的片段着色器的系列文章......非常整洁的东西！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T00:07:28.043

[您可以使用RGBFilter](http://msdn.microsoft.com/en-us/library/ms771475.aspx)作为起点- 一个用 C++ 和 C# 编写的自定义位图效果示例。

我不确定您是否只能在 C# 中实现自定义位图效果，因为它需要实现一些 MIL 接口，这在 C# 中可能不可行。虽然我可能是错的。

# javascript - JQuery 选择器未在 Ruby on Rails 中的 Ajax XHR 创建的表中的元素上找到类

> ID：180884
> 
> 赞同：4
> 
> 时间：2008-10-07T23:55:21.190
> 
> 标签：javascript, ruby-on-rails, ruby, ajax

使用时

```
$('.foo').click(function(){  
    alert("I haz class alertz!");  
    return false;
  }); 
```

在 application.js 中，和

```
<a href = "" class = "foo" id = "foobar_1" >Teh Foobar </a> 
```

在使用页面初始化的任何 div 中，当单击“Teh Foobar”时，它会发出警报并且不跟随链接。但是，当在 application.js 中使用相同的代码时，

```
<a href = "" class = "foo" id = "foobar_1" >Teh Foobar </a> 
```

正在被返回到 div

```
form_remote_tag 
```

单击时，“Teh Foobar”无法发出警报，并用作链接。

发生了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T00:00:52.660

当您设置页面时，从 AJAX 调用返回的标记不存在，因此它没有任何与之关联的 onclick 处理程序。您需要挂钩到 Rails AJAX 支持，以便在加载 AJAX 驱动的 div 时，它还会再次执行您的事件设置代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T00:22:40.010

绑定事件后添加到文档的新元素不会自动获取这些事件处理程序。解决此问题的一种方法是 - 正如 John Millikin 所说 - 在您创建新元素后重新绑定您的事件。

另一种标准方式是事件委托。因为事件在堆栈的所有父元素中一直向上和向下传递，所以您可以将事件绑定到将成为所有目标元素的祖先的元素。

例如，这个 jQuery 代码可以工作（您的语法可能因其他 JavaScript 库而异）：

```
$(document).ready(function() {
  $('body').click(function(event) {
    if ($(event.target).is('.foo')) { // <- this is the magic
      alert('Something of class foo was clicked.');
      return false;
    }
  });
}); 
```

现在，当您单击 foo 类的某些内容时，该事件将被触发，除非介于两者之间的某些内容捕获了该事件并取消了冒泡。实际上，几乎在单击任何内容时都会调用事件——“if”语句只是过滤掉哪些事件值得发出警报。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T05:59:46.257

您还可以使用[Live Query](http://docs.jquery.com/Plugins/livequery) jQuery 插件，该插件能够在 DOM 更新后自动为匹配的元素绑定事件。在您的情况下，它将是：

```
$('.foo').livequery('click', function() {  
    alert("I haz class alertz!");  
    return false;
}); 
```

# html - 如何根据当前页面突出显示链接？

> ID：180887
> 
> 赞同：11
> 
> 时间：2008-10-07T23:56:08.987
> 
> 标签：html, css, navigation

抱歉，如果这听起来像一个非常愚蠢的问题，但是当您在链接到的页面上时，我需要让链接更改颜色。

例如，当您在 StackOverflow 的“问题”页面上时，顶部的链接会改变颜色。你怎么做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T00:02:57.757

这实际上取决于您的页面是如何构建的。通常，我会使用 CSS 执行此操作，并为链接分配一个名为“活动”的 id ...

```
<a id="active" href="thisPage.html">this page</a> 
```

...在 CSS 中...

```
a#active { color: yellow; } 
```

显然，这是一个相当简单的示例，但它说明了总体思路。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-07T23:58:18.250

这是服务器端的事情——在渲染页面时，向链接添加一个类似“current-page”的类。然后，您可以将其与其他链接分开设置样式。

例如，当 StackOverflow`class="youarehere"`指向您已经在的页面时，它会呈现链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T00:04:56.117

您可以这样做，而不必实际修改每个页面的链接本身。

在我使用 Django 构建的 Stack Overflow 克隆中，我正在这样做：

```
<!-- base.html -->
...
<body class="{% block bodyclass %}{% endblock %}">
...
<div id="nav">
  <ul>
    <li id="nav-questions"><a href="{% url questions %}">Questions</a></li>
    <li id="nav-tags"><a href="{% url tags %}">Tags</a></li>
    <li id="nav-users"><a href="{% url users %}">Users</a></li>
    <li id="nav-badges"><a href="{% url badges %}">Badges</a></li>
    <li id="nav-ask-question"><a href="{% url ask_question %}">Ask Question</a></li>
  </ul>
</div> 
```

`bodyclass`然后在页面模板中填写like so：

```
<!-- questions.html -->
{% extends "base.html" %}
{% block bodyclass %}questions{% endblock %}
... 
```

然后，使用以下 CSS，为每个页面突出显示相应的链接：

```
body.questions #nav-questions a,
body.tags #nav-tags a,
body.users #nav-users a,
body.badges #nav-badges a,
body.ask-question #nav-ask-question a { background-color: #f90; } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T00:00:35.750

在每个页面的 body 标记上设置一个类（手动或服务器端）。然后在您的 CSS 中使用该类来识别您所在的页面并相应地更新项目的样式。

```
body.questions #questionsTab
{
    color: #f00;
} 
```

[这是一个很好的更长的解释](http://www.hicksdesign.co.uk/journal/highlighting-current-page-with-css)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T00:11:32.310

如果由于某种原因你不想在服务器端处理这个问题，你可以试试这个：

```
// assuming this JS function is called when page loads
onload()
{
  if (location.href.indexOf('/questions') > 0)
  {
    document.getElementById('questionsLink').className = 'questionsStyleOn';
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T00:08:54.063

服务器端代码是最简单的，只需在当前页面的链接上设置一个类，但这也可以在客户端使用 JavaScript，在特定类中具有匹配的 href 的所有元素上设置第二个类当前页面。

您可以使用 document.getElementsByTagName() 或 document.links[] 并仅查找表示导航链接的类中的那些，然后设置第二个表示当前的类（如果它与当前 URL 匹配）。

URL 是相对的，而 document.URL 不是。但是，如果您从表格驱动的设计生成内容并且用户无论如何都可以放置绝对或相对 URL，那么您有时会在服务器端遇到相对与绝对相同的问题。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-08T00:01:27.387

为此，您需要服务器上的代码。比较简单的做法是比较当前页面的 URL 和链接中的 URL；但是考虑到 stackoverflow 中有许多不同的 URL，所有这些都会导致“问题”选项卡被突出显示。

更复杂的版本可以在您更改页面时将某些内容放入会话中（不太健壮）；存储与每个菜单项相关的页面/URL 模式列表；或者在页面本身的代码中，设置一个变量来确定要突出显示的项目。

然后，正如 John Millikin 建议的那样，在链接或其父元素之一上放置一个类，例如“当前页面”，它将控制它的颜色。

# emacs - 如何使用 Emacs 更改文件的读/写模式？

> ID：180910
> 
> 赞同：128
> 
> 时间：2008-10-08T00:08:37.357
> 
> 标签：emacs, file, file-permissions

如果文件设置为只读模式，我如何在 Emacs 中将其更改为写入模式，反之亦然？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-10-08T00:10:47.930

> Mx 只读模式

在非常旧的 Emacs 版本中，命令是：

> Mx 切换只读

在我的 Windows 机器上，这相当于 Alt-x 来调出元提示并键入“只读模式”来调用正确的 elisp 函数。

如果您使用默认键盘绑定，

> Cx Cq

（您大声朗读为“Control-X Control-Q”）将具有相同的效果。但是请记住，鉴于 emacs 本质上是无限可重新配置的，您的里程可能会有所不同。

*从评论跟进：*您应该注意缓冲区的可写状态不会改变文件的可写权限。如果您尝试写入只读*文件*，您将看到一条确认消息。*但是，如果您拥有该文件，则可以在不*更改文件权限的情况下写出您的更改。

如果您想快速更改文件，而无需执行添加写入权限、写出更改、删除写入权限等多个步骤，这将非常方便。我倾向于忘记最后一步，留下潜在的关键文件以供以后意外更改。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-09T15:52:31.460

确保您没有将“文件”与“缓冲区”混淆。`C-x C-q`您可以使用( )将缓冲区设置为只读并再次返回`toggle-read-only`。如果您有权读取但不能写入文件，则访问该文件（`C-x C-f`或`find-file`）时获得的缓冲区将自动置于只读模式。如果要更改文件系统中文件的权限，可能从`dired`包含该文件的目录开始。dired 的文档可以在 info 中找到；`C-h i (emacs)dired RET`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-03-09T10:19:30.687

我发现的是`M-x set-file-modes filename mode`

它在我的 Windows Vista 机器上工作。例如：`M-x set-file-modes <RET> ReadOnlyFile.txt <RET> 0666`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-08T00:13:34.880

`CTRL + X`+`CTRL + Q`     

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-12-05T13:45:26.430

正如其他人在那里提到的那样：**Mx toggle-read-only**可以工作。

但是，现在已弃用，而**Mx 只读模式**是当前的执行方式，即设置为**Cx Cq**键绑定。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-16T14:30:25.430

如果只有缓冲区（而不是文件）是只读的，则可以使用`toggle-read-only`通常绑定到`C-x C-q`.

但是，如果文件本身是只读的，您可能会发现以下函数很有用：

```
(defun set-buffer-file-writable ()
  "Make the file shown in the current buffer writable.
Make the buffer writable as well."
  (interactive)
  (unix-output "chmod" "+w" (buffer-file-name))
  (toggle-read-only nil)
  (message (trim-right '(?\n) (unix-output "ls" "-l" (buffer-file-name))))) 
```

函数取决于`unix-output`和`trim-right`：

```
(defun unix-output (command &rest args)
  "Run a unix command and, if it returns 0, return the output as a string.
Otherwise, signal an error.  The error message is the first line of the output."
  (let ((output-buffer (generate-new-buffer "*stdout*")))
    (unwind-protect
     (let ((return-value (apply 'call-process command nil
                    output-buffer nil args)))
       (set-buffer output-buffer)
       (save-excursion 
         (unless (= return-value 0)
           (goto-char (point-min))
           (end-of-line)
           (if (= (point-min) (point))
           (error "Command failed: %s%s" command
              (with-output-to-string
                  (dolist (arg args)
                (princ " ")
                (princ arg))))
           (error "%s" (buffer-substring-no-properties (point-min) 
                                   (point)))))
         (buffer-substring-no-properties (point-min) (point-max))))
      (kill-buffer output-buffer))))

(defun trim-right (bag string &optional start end)
  (setq bag (if (eq bag t) '(?\  ?\n ?\t ?\v ?\r ?\f) bag)
    start (or start 0)
    end (or end (length string)))
  (while (and (> end 0)
          (member (aref string (1- end)) bag))
    (decf end))
  (substring string start end)) 
```

将函数放在您的 中`~/.emacs.el`，评估它们（或重新启动 emacs）。然后，您可以使当前缓冲区中的文件可使用`M-x set-buffer-file-writable`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-12-04T00:14:54.527

如果您正在查看文件目录（dired），则可以`Shift + M`在文件名上使用并输入命令`modespec`中使用的相同属性`chmod`。
`M modespec <RET>`

在 [http://www.gnu.org/s/libtool/manual/emacs/Operating-on-Files.html的目录列表中查看其他有用的文件命令](http://www.gnu.org/s/libtool/manual/emacs/Operating-on-Files.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-11T07:50:00.227

我尝试了 Vebjorn Ljosa 的解决方案，结果发现至少在我的 Emacs (22.3.1) 中没有“trim-right”这样的功能，用于在 chmod 输出末尾删除无用的换行符。

删除对 'trim-right' 的调用有所帮助，但由于额外的换行符而使状态行“反弹”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-09T07:32:27.207

`C-x C-q`没用。因为您还需要保存文件的权限。

我使用[Spacemacs](https://github.com/syl20bnr/spacemacs)。它给了我一个方便的功能来解决这个问题。代码如下。

```
(defun spacemacs/sudo-edit (&optional arg)
  (interactive "p")
  (if (or arg (not buffer-file-name))
      (find-file (concat "/sudo:root@localhost:" (ido-read-file-name "File: ")))
    (find-alternate-file (concat "/sudo:root@localhost:" buffer-file-name)))) 
```

我打电话`spacemacs/sudo-edit`在emacs中打开一个文件并输入我的密码，我可以在没有只读模式的情况下更改文件。

您可以编写一个新函数，例如`spacemacs/sudo-edit`.

# java - 在 Eclipse 中配置 tomcat 安全管理器

> ID：180924
> 
> 赞同：1
> 
> 时间：2008-10-08T00:14:25.473
> 
> 标签：java, eclipse, tomcat

在 Eclipse 中的动态 Web 项目中工作（使用 Tomcat (v5.5) 作为应用服务器），有没有什么方法可以配置东西，所以 Tomcat 将在打开安全性的情况下启动（即，就像我运行 catalina.sh start -security )?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T04:55:45.543

进入 'Window' -> 'Preferences' 然后选择 'Java' -> 'Installed JREs'，克隆 Tomcat 使用的 JRE 并将以下内容添加到默认 VM Arguments

```
-Djava.security.manager -Djava.security.policy="XXXX\conf\catalina.policy" 
```

用适当的路径替换 XXXX - 我的是`C:\Program Files\Apache Software Foundation\Tomcat 5.5`）。然后更改 JRE 名称（我在末尾添加了“启用安全性”）并单击“完成”。

之后，在首选项中打开“服务器”->“运行时环境”，然后选择您的 Apache Tomcat 环境，然后单击“编辑...”按钮。在出现的窗口中，选择新的启用安全性的 JRE，然后单击“完成”并重新启动 Tomcat。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T06:36:49.343

或者您可以在服务器概述页面中选中“启用安全性”。

（服务器 -> 您的服务器设置 -> 概述）

然后eclipse会在下面添加参数

> -Djava.security.manager -Djava.security.policy=X:XXX\XXX.metadata.plugins\org.eclipse.wst.server.core\tmp0\conf\catalina.policy -Dwtp.configured.security=true

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T00:36:52.230

我假设您使用的是 Tomcat 5.5.x

查看 catalina.bat/catalina.sh 后，所有 -security 标志所做的就是设置 -Djava.security.policy=="%CATALINA_BASE%\conf\catalina.policy"

大多数人将 CATALINA_BASE 设置为 TOMCAT_HOME 或 CATALINA_HOME

因此，如果您已经在目录 c:\tomcat 中安装了 tomcat，那么您需要做的就是在 tomcat 插件中设置一个选项以包含上述策略。
即，将其添加到 JAVA_OPTIONS：-Djava.security.policy=="c:\tomcat\conf\catalina.policy"。

就是这样，然后重新启动。

# sql - 如何使用 Alter Table 在 Access 中创建十进制字段？

> ID：180929
> 
> 赞同：6
> 
> 时间：2008-10-08T00:18:25.403
> 
> 标签：sql, ms-access

我想以编程方式在 MS Access 表中创建一个新列。我尝试了许多排列`ALTER TABLE MyTable Add MyField DECIMAL (9,4) NULL;`并得到：

> 字段定义中的语法错误

我可以轻松地创建一个`Double`类型的数字字段，但我想要`decimal`. 我非常希望在单个`ALTER TABLE`语句中执行此操作，而不必创建一个字段然后更改它。

我正在使用 Access 2003。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T02:52:47.167

默认的 Jet 4.0 mdb 文件不支持十进制数据类型。您必须使用 SQL Server 兼容性语法 (ANSI 92) 设置才能在 SQL 窗口中使用十进制数据类型。

单击菜单，工具 > 选项。单击表/查询选项卡。在 SQL Server 兼容性语法 (ANSI 92) 部分中选中“此数据库”复选框。此模式将影响整个数据库，包括使用通配符的查询，因此您可能希望在您的数据库副本上尝试此操作。

将其粘贴到 SQL 窗口中：

```
ALTER TABLE MyTable
  Add COLUMN MyField DECIMAL (9,4) NULL; 
```

如果您不想更改数据库的模式，则必须将 vba 代码与 adodb 库一起使用：

```
Dim conn As ADODB.Connection

Set conn = CurrentProject.Connection
conn.Execute "ALTER TABLE MyTable " _
    & "ADD COLUMN MyField DECIMAL (9,4) NULL;"
conn.Close 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T00:46:49.667

只有 Jet 4.0/ACE 在 ANSI-92 查询模式下才支持 ALTER TABLE 语法。尝试 ADO 连接，例如

CurrentProject.Connection.Execute “ALTER TABLE myTbl ADD COLUMN myColumn DECIMAL(9,4)”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T08:03:30.190

如果要在访问表中创建新列，使用 DAO.tableDef 对象很容易：

```
Dim my_tableDef As DAO.TableDef
Dim my_field As DAO.Field

Set my_tableDef = currentDb.TableDefs(my_table)
Set my_Field = my_tableDef.CreateField(my_fieldName, dbDecimal, myFieldSize)
my_Field.decimalPlaces = myDecimalPlaces
my_Field.defaultValue = myDefaultValue

my_tableDef.Fields.Append my_Field

set my_Field = nothing
set my_tableDef = nothing 
```

当然，您可以进一步删除它。

You might have the posibility to do so with ADODB (or ADOX?) object, but as long as you are working on an mdb file, DAO is straight and efficient.

PS: after checking on some forums, it seems there is a bug with decimal fields and DAO. [http://allenbrowne.com/bug-08.html](http://allenbrowne.com/bug-08.html). Advices are "go for double"(which is what I do usually to avoid any loosy issues related to decimal rounding) or use "implicite" ADO to modify your database

```
strSql = "ALTER TABLE MyTable ADD COLUMN MyField DECIMAL (28,3);"
CurrentProject.Connection.Execute strSql 
```

# c# - 生成正确 Json 的对象初始化器语法

> ID：180930
> 
> 赞同：1
> 
> 时间：2008-10-08T00:19:17.147
> 
> 标签：c#, linq, json

我正在尝试使用 linq 将数据列表塑造成特定的形状，以从 ajax 调用中作为 Json 返回。

鉴于此数据：

```
var data = new List<string>();
data.Add("One");
data.Add("Two");
data.Add("Three"); 
```

这段代码：**这是不正确的，需要修复！**

```
var shaped = data.Select(c =>
    new { c = c }
).ToList();

serializer.Serialize(shaped,sb);
string desiredResult = sb.ToString(); 
```

我想`desiredResult`成为：

```
{
    "One": "One",
    "Two": "Two",
    "Three": "Three"
} 
```

但目前是：

`{ "c" : "One" },{ "c" : "Two" }`， ETC。

一个问题是，在对象初始值设定项的左侧，我想要的是 的值`c`，而不是`c`它本身......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T06:05:56.137

在 json 中，“c”中的“c”：“One”是属性名称。在 C# 世界中，您不能动态创建属性名称（忽略 System.ComponentModel）。

基本上，我不认为你可以做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T13:44:23.467

提供的解决方案是为了正确性，而不是性能。

```
 List<string> data = new List<string>()
        {
            "One",
            "Two",
            "Three"
        };

        string result =
            "{ "
            +
            string.Join(", ", data
              .Select(c => @"""" + c + @""": """ + c + @"""")
              .ToArray()
            ) + " }"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T08:13:13.727

使用[JSON.NET](http://www.codeplex.com/Json)怎么样？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-26T08:14:43.900

我回答这个老问题只是因为所有其他回答基本上都是错误的或不完整的。

JSON 真的很简单，所以基本上，要得到你想要的 JSON，你只需要掌握 JSON 数组之间的区别：

```
["one", "two", "three"] 
```

和 JSON 对象/字典（对象和字典实际上是一样的）：

```
{"a": "one", "b": "two", "c": 3} 
```

请注意“c”元素的类型不同，但这对于 Javascript 来说不是问题。

鉴于此，我在 .NET 下使用的几乎每个序列化程序（几乎总是很棒的[JSON.NET](http://james.newtonking.com/projects/json-net.aspx)库）都将 .NET 对象或 .NET 字典转换为 JSON 对象。

因此，您需要将 List 转换为 Dictionary，然后为序列化程序提供字典或对象。另一个问题是为什么你想要一个值等于键的字典，但即使我很怀疑，我也会接受这一点。

给出的例子：

```
List<string> source = new List <string> () {"a", "b", "c"};

Dictionary<string, string> dict = source.ToDictionary(el => el, el => el);

var jsonString = Newtonsoft.Json.JsonConvert.SerializeObject(dict); 
```

jsonString 应该是`"{'a':'a', 'b':'b', 'c':'c'}"`, 或多或少的空格取决于格式

# c# - 将自制测试应用程序转换为标准单元测试框架

> ID：180935
> 
> 赞同：2
> 
> 时间：2008-10-08T00:21:28.530
> 
> 标签：c#, unit-testing, automated-tests, homebrew

我已经为一个软件编写了很多测试（这是一件很棒的事情），但它本质上是作为 C# 中的独立测试构建的。虽然这工作得很好，但它也有一些缺点，其中最重要的是它没有使用标准的测试框架，并且最终要求运行测试的人注释掉对不应该运行的测试的调用（当不希望运行整个测试“套件”时）。我想将它整合到我的自动化测试过程中。

我看到 VS 2008 的测试版有一个“通用测试”的概念，它可能会做我想做的事，但我们目前无法在那个版本上花钱。我最近开始使用 VS 2008 Pro 版本。

这些测试方法遵循一个熟悉的模式：

*   为测试做一些设置。
*   执行测试。
*   为下一次测试重置。

它们中的每一个都返回一个布尔值（通过/失败）和一个字符串 ref 来表示失败原因，如果失败则填写。

从好的方面来说，至少测试方法是一致的。

今晚我坐在这里，考虑明天早上我可能采取的方法，将所有这些测试代码迁移到测试框架，坦率地说，我对手动钻研超过 8-9K 行测试代码的想法并不那么兴奋进行转换。

你有过进行这种转换的经验吗？你有什么建议吗？我想我可能会因为全局搜索/替换和手动更改测试而苦苦挣扎。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T00:44:07.473

如果你使用 NUnit（你应该这样做），你需要为你当前的每个测试方法创建一个新的测试方法。NUnit 使用反射向测试类查询标有该`[Test]`属性的方法，这是它如何构建显示在 UI 中的测试列表的方式，并且测试类使用 NUnit`Assert`方法来指示它们是通过还是失败。

在我看来，如果您的测试方法与您所说的一样一致，那么所有这些 NUnit 方法都会如下所示：

```
[Test]
public void MyTest()
{
   string msg;
   bool result = OldTestClass.MyTest(out msg);
   if (!result)
   {
      Console.WriteLine(msg);
   }
   Assert.AreEqual(result, true); 
```

}

一旦你让它工作，你的下一步是编写一个程序，使用反射来获取旧测试类上的所有测试方法名称，并生成一个 .cs 文件，其中包含每个原始测试方法的 NUnit 方法。

烦人，也许，但不是特别痛苦。你只需要做一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T00:37:47.140

您将经历“一盎司的预防胜于一磅的治疗”的成语。在编程中尤其如此。

你没有提到 NUnit（我认为它是微软在 2008 年购买的，但不要让我这么认为）。您是否有一个特别的原因不只是首先使用 NUnit？

# language-agnostic - 异常真的是异常错误吗？

> ID：180937
> 
> 赞同：32
> 
> 时间：2008-10-08T00:22:10.933
> 
> 标签：language-agnostic, exception, frameworks

我的理解是，常识只在真正异常的情况下使用异常（事实上，我在 SO 上已经多次看到该声明）。

然而，Krzysztof Cwalina 说：

> > 关于异常的最大误解之一是它们是针对“异常情况”的。实际情况是它们用于传达错误条件。从框架设计的角度来看，没有所谓的“异常情况”。条件是否异常取决于使用的上下文， --- 但可重用库很少知道它们将如何使用。例如，OutOfMemoryException 对于简单的数据输入应用程序可能是异常的；对于执行自己的内存管理的应用程序（例如 SQL 服务器）来说，这并不是什么特别的事情。换句话说，一个人的特殊情况是另一个人的慢性病。

然后他还继续说例外应该用于：

*   使用错误
*   程序错误
*   系统故障

考虑到 Krzysztof Cwalina 是 MS CLR 团队的 PM，我问：您如何看待他的声明？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-08T00:41:59.583

这听起来过于简单，但我认为在适当的地方简单地使用异常是有意义的。在 Java 和 Python 等语言中，异常非常常见，尤其是在某些情况下。异常适用于您希望通过代码路径冒泡并强制开发人员显式捕获的错误类型。在我自己的编码中，我考虑在错误不能被忽略时添加异常的正确时间，或者抛出异常而不是将错误值返回给函数调用等更优雅。

我能想到的一些最适合例外的地方：

*   **NotImplementedException** - 指定特定方法或函数不可用的非常合适的方式，而不是简单地返回而不做任何事情。
*   **OutOfMemory**异常 - 很难想象有更好的方法来处理此类错误，因为它表示进程范围或操作系统范围的内存分配失败。当然，这是必须处理的！
*   **NullPointerException** - 访问空变量是程序员的错误，IMO 这是另一个迫使错误浮出水面的好地方
*   **ArrayIndexException** - 在像 C 这样无情的语言中，缓冲区溢出是灾难性的。更好的语言可能会返回某种类型的空值，或者在某些实现中，甚至会环绕数组。在我看来，抛出异常是一种更优雅的响应。

这绝不是一个完整的列表，但希望它说明了这一点。在优雅和合乎逻辑的地方使用异常。与编程一样，正确工作的正确工具是很好的建议。毫无意义地异常疯狂是没有意义的，但是完全忽略一个强大而优雅的工具同样是不明智的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-08T00:25:04.077

对于编写框架的人来说，也许这很有趣。

对于我们其他人来说，这很令人困惑（并且可能毫无用处）。对于普通应用程序，必须将异常作为“异常”情况搁置一旁。异常会中断程序的正常顺序呈现。

您应该小心打破程序的普通自上而下的顺序处理。异常处理 - 故意 - 难以阅读。因此，为标准场景之外的事情保留例外。

示例：不要使用异常来验证用户输入。人们总是犯输入错误。这并不例外，这就是我们编写软件的原因。这就是 if 语句的用途。

当您的应用程序出现 OutOfMemory 异常时，捕获它是没有意义的。这很特别。“顺序执行”的假设是不可能的。您的应用程序注定要崩溃，并希望您的 RDBMS 事务在您崩溃之前完成。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-08T01:02:05.190

确实很难知道究竟是什么解释了一个“异常条件”，它保证在程序中使用异常。

**一个对使用交流错误原因**非常有帮助的实例。正如 Krzysztof Cwalina 的引述所说：

> 关于异常的最大误解之一是它们是针对“异常情况”的。实际情况是它们用于传达错误条件。

举一个具体的例子，假设我们有一个`getHeader(File f)`从文件中读取一些头文件并返回一个`FileHeader`对象的方法。

尝试从磁盘读取数据可能会出现几个问题。也许指定的文件不存在，文件包含无法读取的数据，意外的磁盘访问错误，内存不足等。有多种失败方式意味着应该有多种方式来报告错误。

如果没有使用异常，但需要使用当前方法签名传达发生的错误类型，我们能做的最好的事情就是返回一个`null`. 由于获得的`null`信息量不是很大，因此我们从该结果中获得的最佳沟通是*“发生了某种错误，所以我们无法继续，抱歉。”* -- 它没有传达错误的原因。

（或者，我们可能有 FileHeader 对象的类常量，它们指示 FileNotFound 条件等，模拟错误代码，但这确实带有带有[`TRUE`, `FALSE`,`FILE_NOT_FOUND`](http://thedailywtf.com/Articles/What_Is_Truth_0x3f_.aspx)的布尔类型的气味。）

如果我们得到一个`FileNotFound`或`DeviceNotReady`异常（假设），至少我们知道错误的来源是什么，如果这是一个最终用户应用程序，我们可以通过解决问题的方式处理错误。

使用异常机制提供了一种不需要回退到使用错误代码来通知不在正常执行流程中的条件的通信方式。

但是，这并不意味着一切都应该由异常处理。[正如S.Lott](https://stackoverflow.com/questions/180937/are-exceptions-really-for-exceptional-errors#180945)所指出的：

> 例如，不要使用异常来验证用户输入。人们总是犯错误。这就是 if 语句的用途。

这是一件不能强调的事情。不知道何时确切使用异常的危险之一是倾向于对异常感到高兴。使用输入验证就足够的异常。

`InvalidUserInput`当处理这种情况所需要的只是通知用户预期的输入内容时，定义和抛出异常确实没有意义。

此外，应该注意的是，用户输入在某些时候会出现错误输入*。*在将输入从外部世界传递到程序内部之前验证输入是一种防御措施。

决定什么是特殊的，什么不是特殊的有点困难。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-08T00:47:48.480

由于我通常使用 Python 进行编程，并且在该语言中异常无处不在，因此对我来说，异常可能代表从系统错误到完全合法条件的任何内容。

例如，检查字符串是否包含整数的“pythonic”方法是尝试 int(theString) 并查看它是否引发异常。那是“异常错误”吗？

同样，在 Python 中，for 循环总是被认为作用于迭代器，迭代器在完成其工作时必须引发“StopIteration”异常（for 循环捕获该异常）。无论如何，这是“例外”吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-08T00:54:12.553

我认为你越接近地面，作为错误通信手段的异常就越不合适。在 Java 或 .net 等更高的抽象中，异常可能是一种将错误消息传递给调用者的优雅方式。然而，在 C 中情况并非如此。这也是一个框架与 api 设计决策。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T14:57:42.097

如果你练习“告诉，不要问”，那么例外就是程序说“我不能那样做”的方式。这是“例外”，因为您说“做 X”，但它不能做 X。一个简单的错误处理情况。在某些语言中，以这种方式工作很常见，在 Java 和 C++ 中，人们有不同的看法，因为异常变得非常昂贵。

一般：例外只是意味着“我不能”

务实的：......如果你能负担得起用你的语言那样工作的话。

公民身份：......而且你的团队允许这样做。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-08T01:03:10.397

我认为应该使用异常来捕获意外问题有几个很好的理由。

首先，他们创建一个对象来封装异常，根据定义，它必须比处理简单的 if 语句更昂贵。作为一个 Java 示例，您应该调用 File.exists() 而不是常规地期待和处理 FileNotFoundException。

其次，在当前方法（甚至可能是类）之外捕获的异常使代码比处理全部在一个方法中更难阅读。

话虽如此，我个人*喜欢*例外。它们使您无需显式处理所有这些可能发生但可能永远不会键入的错误，这会导致您重复编写 print-an-error-and-abort-on-non-zero-return-每个方法调用的代码处理。

我的底线是……如果您可以合理地预期它会发生，那么它就是您的应用程序的一部分，您应该为它编写代码。其他任何事情都是例外。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-07-23T15:40:01.920

以下是异常的定义：异常是在程序执行期间发生的事件，它破坏了程序指令的正常流程。

因此，要回答您的问题，不。例外是*破坏性*事件，可能是也可能不是*例外*。我喜欢这个定义，它很简单而且每次都有效——如果你像我一样接受例外。例如，用户提交了不正确的 un/pw，或者您有非法参数/错误的用户输入。在这里抛出异常是解决这些问题的最直接的方法，这些问题具有破坏性，但并非异常，甚至也不是意料之外的。

他们可能应该被称为*中断*，但那艘船已经航行了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-08T00:35:46.910

我自己一直在想这个。我们所说的“异常”是什么意思？也许没有严格的定义，但是在给定的上下文中，我们可以使用任何经验法则来决定什么是特殊的吗？

例如，说“异常”条件是违反函数契约的条件是否公平？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-08T00:37:45.847

KCwalina 有一个观点。识别代码失败的情况会很好（达到限制）

我同意 S.Lott 的观点，有时验证比抛出异常要好。话虽如此，OutOfMemory 并不是您在应用程序中所期望的（除非它正在分配大内存并需要内存才能继续运行）。

我认为，这取决于应用程序的领域。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T14:50:47.077

Krzysztof Cwalina 的声明有点误导。最初的陈述是指“例外情况”，对我来说，我自然是定义什么是例外的人。尽管如此，我认为消息通过了 OK，因为我认为我们都在谈论“开发人员”异常。

异常非常适合通信，但通过一些层次结构设计，它们也非常适合一些关注点分离，特别是在层之间（DAO、业务等）。当然，这仅在您以不同方式处理这些异常时才有用。

层次结构的一个很好的例子是 spring 的数据访问异常层次结构。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-05-25T21:41:20.227

我认为他是对的。看一下java中的数字解析。您甚至无法在解析之前检查输入字符串。如果出现问题，您将被迫解析和检索 NFE。解析失败是否异常？我想不是。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-03-15T12:09:47.407

我当然相信只有在您有异常情况时才应使用异常。

问题在于“异常”的定义。这是我的：

> 如果条件超出了引发异常的系统部分的假定正常行为，则该条件是异常的。

这有一些含义：

*   异常**取决于你的假设**。如果一个函数假定它传递了有效的参数，那么抛出一个 IllegalArgumentException 是可以的。但是，如果一个函数的合约说它将以某种方式纠正输入中的输入错误，那么这种用法是“正常的”，它不应该在输入错误时抛出异常。
*   异常**取决于子系统分层**。如果网络被取消注释，网络 IO 函数肯定会引发异常，因为它假定连接有效。然而，基于 ESB 的消息代理将被期望处理断开的连接，因此如果它在内部使用这样的网络 IO 功能，那么它需要适当地捕获和处理错误。如果不明显，try/catch 实际上相当于一个子系统，它说“我的一个组件的异常情况实际上被我认为是正常的，所以我需要处理它”。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-06-10T17:36:28.670

“Effective Java Second Edition”中使用了例外情况应该使用异常的说法：最好的Java书籍之一。

问题在于，这是断章取义的。当作者声明异常应该是异常时，他刚刚展示了一个使用异常来终止 while 循环的示例 - 一个糟糕的异常使用。去引用：

> 例外，顾名思义，仅用于例外情况；它们不应该用于普通的控制流。

所以这一切都取决于你对“异常条件”的定义。断章取义，您可以暗示它应该很少使用。

使用异常代替返回错误代码是好的，而使用它们来实现“聪明”或“更快”的技术是不好的。这通常是“异常情况”的意思。

已检查异常 - 不是错误且不应停止执行的小错误。前任。IO 或文件解析未经检查的异常 - 编程违反方法合同的“错误” - 例如。出界异常。或者一个错误，使继续执行成为一个非常糟糕的主意——例如 IO 或非常重要的文件的文件解析。也许是一个配置文件。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-25T21:28:35.033

归根结底是完成这项工作需要什么工具。

异常是一个非常强大的工具。在使用它们之前，请询问您是否需要这种功能以及随之而来的复杂性。

异常可能看起来很简单，因为您知道当遇到异常的行时，一切都会停止。但是从这里会发生什么？

是否会发生未捕获的异常？

异常会被全局错误处理捕获吗？

异常是否会通过更嵌套和更详细的错误处理来处理？

您必须了解堆栈中的所有内容才能知道该异常会做什么。这违反了独立性的概念。该方法现在依赖于错误处理来执行您期望的操作。

如果我有一种方法，我不应该关心该方法之外的内容。我应该只关心输入是什么，如何处理它，以及如何返回响应。

当您使用异常时，您实际上是在说，我不在乎从这里发生什么，出了点问题，我不希望它变得更糟，做任何需要做的事情来缓解问题。

现在，如果您关心如何处理错误，您将做更多思考并将其构建到方法的接口中，例如，如果您尝试查找某个对象，如果找不到对象，则可能返回该对象的默认值而不是而不是抛出一些异常，如“找不到对象”。

当您在方法接口中构建错误处理时，不仅该方法的签名更能描述它可以做什么，而且它将如何处理错误的责任放在方法的调用者身上。调用者方法可能能够通过它或不能通过它，如果没有，它会再次向上报告。最终，您将到达应用程序的入口点。现在抛出异常是合适的，因为如果您正在使用应用程序公共接口，您最好对如何处理异常有一个很好的理解。

让我举一个例子来说明我对 Web 服务的错​​误处理。

级别 1\. global.asax 中的全局错误处理 - 这是防止未捕获异常的安全网。永远不应该故意达到这一点。

级别 2\. Web 服务方法 - 包装在 try/catch 中，以确保它始终符合其 json 接口。

第 3 级。工作方法 - 这些方法获取数据、处理数据并将其原始返回给 Web 服务方法。

在工作方法中，抛出异常是不对的。是的，我有嵌套的 Web 服务方法错误处理，但是该方法可以在其他可能不存在的地方使用。

相反，如果使用 worker 方法获取记录并且找不到记录，它只会返回 null。Web 服务方法检查响应，当它发现 null 时，它知道它不能继续。Web 服务方法知道它有返回 json 的错误处理，因此抛出异常只会在 json 中返回所发生事件的详细信息。从客户的角度来看，它被打包成易于解析的 json 非常棒。

您会看到每件作品都知道它需要做什么并做到了。当您在混合中抛出异常时，您会劫持应用程序流。这不仅导致难以遵循代码，而且对滥用异常的响应是 try/catch。现在你更有可能滥用另一个非常强大的工具。

我经常看到一个 try/catch 在应用程序中间捕获所有内容，因为开发人员害怕他们使用的方法比看起来更复杂。

# c++ - C++ 中的 Base64 解码片段

> ID：180947
> 
> 赞同：89
> 
> 时间：2008-10-08T00:25:26.463
> 
> 标签：c++, base64

C++ 中是否有免费提供的 Base64 解码代码片段？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2012-12-18T15:02:52.980

这是我对[最初由*René Nyffenegger*](http://www.adp-gmbh.ch/cpp/common/base64.html)编写的实现的修改。为什么我要修改它？`std::string`好吧，因为对我来说，我应该使用存储在对象中的二进制数据似乎不合适；）

**base64.h**：

```
#ifndef _BASE64_H_
#define _BASE64_H_

#include <vector>
#include <string>
typedef unsigned char BYTE;

std::string base64_encode(BYTE const* buf, unsigned int bufLen);
std::vector<BYTE> base64_decode(std::string const&);

#endif 
```

**base64.cpp**：

```
#include "base64.h"
#include <iostream>

static const std::string base64_chars =
             "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
             "abcdefghijklmnopqrstuvwxyz"
             "0123456789+/";

static inline bool is_base64(BYTE c) {
  return (isalnum(c) || (c == '+') || (c == '/'));
}

std::string base64_encode(BYTE const* buf, unsigned int bufLen) {
  std::string ret;
  int i = 0;
  int j = 0;
  BYTE char_array_3[3];
  BYTE char_array_4[4];

  while (bufLen--) {
    char_array_3[i++] = *(buf++);
    if (i == 3) {
      char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
      char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
      char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
      char_array_4[3] = char_array_3[2] & 0x3f;

      for(i = 0; (i <4) ; i++)
        ret += base64_chars[char_array_4[i]];
      i = 0;
    }
  }

  if (i)
  {
    for(j = i; j < 3; j++)
      char_array_3[j] = '\0';

    char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
    char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
    char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
    char_array_4[3] = char_array_3[2] & 0x3f;

    for (j = 0; (j < i + 1); j++)
      ret += base64_chars[char_array_4[j]];

    while((i++ < 3))
      ret += '=';
  }

  return ret;
}

std::vector<BYTE> base64_decode(std::string const& encoded_string) {
  int in_len = encoded_string.size();
  int i = 0;
  int j = 0;
  int in_ = 0;
  BYTE char_array_4[4], char_array_3[3];
  std::vector<BYTE> ret;

  while (in_len-- && ( encoded_string[in_] != '=') && is_base64(encoded_string[in_])) {
    char_array_4[i++] = encoded_string[in_]; in_++;
    if (i ==4) {
      for (i = 0; i <4; i++)
        char_array_4[i] = base64_chars.find(char_array_4[i]);

      char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
      char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
      char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

      for (i = 0; (i < 3); i++)
          ret.push_back(char_array_3[i]);
      i = 0;
    }
  }

  if (i) {
    for (j = i; j <4; j++)
      char_array_4[j] = 0;

    for (j = 0; j <4; j++)
      char_array_4[j] = base64_chars.find(char_array_4[j]);

    char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
    char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
    char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

    for (j = 0; (j < i - 1); j++) ret.push_back(char_array_3[j]);
  }

  return ret;
} 
```

这是用法：

```
std::vector<BYTE> myData;
...
std::string encodedData = base64_encode(&myData[0], myData.size());
std::vector<BYTE> decodedData = base64_decode(encodedData); 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2008-10-08T00:28:35.443

请参阅*[使用 C++ 编码和解码 base 64](http://www.adp-gmbh.ch/cpp/common/base64.html)*。

这是该页面的实现：

```
/*
   base64.cpp and base64.h

   Copyright (C) 2004-2008 René Nyffenegger

   This source code is provided 'as-is', without any express or implied
   warranty. In no event will the author be held liable for any damages
   arising from the use of this software.

   Permission is granted to anyone to use this software for any purpose,
   including commercial applications, and to alter it and redistribute it
   freely, subject to the following restrictions:

   1\. The origin of this source code must not be misrepresented; you must not
      claim that you wrote the original source code. If you use this source code
      in a product, an acknowledgment in the product documentation would be
      appreciated but is not required.

   2\. Altered source versions must be plainly marked as such, and must not be
      misrepresented as being the original source code.

   3\. This notice may not be removed or altered from any source distribution.

   René Nyffenegger rene.nyffenegger@adp-gmbh.ch

*/

static const std::string base64_chars =
             "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
             "abcdefghijklmnopqrstuvwxyz"
             "0123456789+/";

static inline bool is_base64(unsigned char c) {
  return (isalnum(c) || (c == '+') || (c == '/'));
}

std::string base64_encode(unsigned char const* bytes_to_encode, unsigned int in_len) {
  std::string ret;
  int i = 0;
  int j = 0;
  unsigned char char_array_3[3];
  unsigned char char_array_4[4];

  while (in_len--) {
    char_array_3[i++] = *(bytes_to_encode++);
    if (i == 3) {
      char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
      char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
      char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
      char_array_4[3] = char_array_3[2] & 0x3f;

      for(i = 0; (i <4) ; i++)
        ret += base64_chars[char_array_4[i]];
      i = 0;
    }
  }

  if (i)
  {
    for(j = i; j < 3; j++)
      char_array_3[j] = '\0';

    char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
    char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
    char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
    char_array_4[3] = char_array_3[2] & 0x3f;

    for (j = 0; (j < i + 1); j++)
      ret += base64_chars[char_array_4[j]];

    while((i++ < 3))
      ret += '=';

  }

  return ret;

}
std::string base64_decode(std::string const& encoded_string) {
  int in_len = encoded_string.size();
  int i = 0;
  int j = 0;
  int in_ = 0;
  unsigned char char_array_4[4], char_array_3[3];
  std::string ret;

  while (in_len-- && ( encoded_string[in_] != '=') && is_base64(encoded_string[in_])) {
    char_array_4[i++] = encoded_string[in_]; in_++;
    if (i ==4) {
      for (i = 0; i <4; i++)
        char_array_4[i] = base64_chars.find(char_array_4[i]);

      char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
      char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
      char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

      for (i = 0; (i < 3); i++)
        ret += char_array_3[i];
      i = 0;
    }
  }

  if (i) {
    for (j = i; j <4; j++)
      char_array_4[j] = 0;

    for (j = 0; j <4; j++)
      char_array_4[j] = base64_chars.find(char_array_4[j]);

    char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
    char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
    char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

    for (j = 0; (j < i - 1); j++) ret += char_array_3[j];
  }

  return ret;
} 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2016-01-02T21:51:25.433

这里有几个片段。然而，这个是紧凑、高效且对 C++11 友好的：

```
static std::string base64_encode(const std::string &in) {

    std::string out;

    int val = 0, valb = -6;
    for (uchar c : in) {
        val = (val << 8) + c;
        valb += 8;
        while (valb >= 0) {
            out.push_back("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(val>>valb)&0x3F]);
            valb -= 6;
        }
    }
    if (valb>-6) out.push_back("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[((val<<8)>>(valb+8))&0x3F]);
    while (out.size()%4) out.push_back('=');
    return out;
}

static std::string base64_decode(const std::string &in) {

    std::string out;

    std::vector<int> T(256,-1);
    for (int i=0; i<64; i++) T["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[i]] = i;

    int val=0, valb=-8;
    for (uchar c : in) {
        if (T[c] == -1) break;
        val = (val << 6) + T[c];
        valb += 6;
        if (valb >= 0) {
            out.push_back(char((val>>valb)&0xFF));
            valb -= 8;
        }
    }
    return out;
} 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2016-05-09T06:41:34.930

我认为这个效果更好：

```
#include <string>

static const char* B64chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

static const int B64index[256] =
{
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  62, 63, 62, 62, 63,
    52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 0,  0,  0,  0,  0,  0,
    0,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  10, 11, 12, 13, 14,
    15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 0,  0,  0,  0,  63,
    0,  26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
    41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51
};

const std::string b64encode(const void* data, const size_t &len)
{
    std::string result((len + 2) / 3 * 4, '=');
    unsigned char *p = (unsigned  char*) data;
    char *str = &result[0];
    size_t j = 0, pad = len % 3;
    const size_t last = len - pad;

    for (size_t i = 0; i < last; i += 3)
    {
        int n = int(p[i]) << 16 | int(p[i + 1]) << 8 | p[i + 2];
        str[j++] = B64chars[n >> 18];
        str[j++] = B64chars[n >> 12 & 0x3F];
        str[j++] = B64chars[n >> 6 & 0x3F];
        str[j++] = B64chars[n & 0x3F];
    }
    if (pad)  /// Set padding
    {
        int n = --pad ? int(p[last]) << 8 | p[last + 1] : p[last];
        str[j++] = B64chars[pad ? n >> 10 & 0x3F : n >> 2];
        str[j++] = B64chars[pad ? n >> 4 & 0x03F : n << 4 & 0x3F];
        str[j++] = pad ? B64chars[n << 2 & 0x3F] : '=';
    }
    return result;
}

const std::string b64decode(const void* data, const size_t &len)
{
    if (len == 0) return "";

    unsigned char *p = (unsigned char*) data;
    size_t j = 0,
        pad1 = len % 4 || p[len - 1] == '=',
        pad2 = pad1 && (len % 4 > 2 || p[len - 2] != '=');
    const size_t last = (len - pad1) / 4 << 2;
    std::string result(last / 4 * 3 + pad1 + pad2, '\0');
    unsigned char *str = (unsigned char*) &result[0];

    for (size_t i = 0; i < last; i += 4)
    {
        int n = B64index[p[i]] << 18 | B64index[p[i + 1]] << 12 | B64index[p[i + 2]] << 6 | B64index[p[i + 3]];
        str[j++] = n >> 16;
        str[j++] = n >> 8 & 0xFF;
        str[j++] = n & 0xFF;
    }
    if (pad1)
    {
        int n = B64index[p[last]] << 18 | B64index[p[last + 1]] << 12;
        str[j++] = n >> 16;
        if (pad2)
        {
            n |= B64index[p[last + 2]] << 6;
            str[j++] = n >> 8 & 0xFF;
        }
    }
    return result;
}

std::string b64encode(const std::string& str)
{
    return b64encode(str.c_str(), str.size());
}

std::string b64decode(const std::string& str64)
{
    return b64decode(str64.c_str(), str64.size());
} 
```

感谢[Jens Alfke 指出了性能问题](https://stackoverflow.com/questions/180947/base64-decode-snippet-in-c/37109258#comment65046388_37109258)，我对这篇*旧*帖子进行了一些修改。这个工作方式比以前更快。它的另一个优点是也可以顺利处理损坏的数据。

*上一版*：虽然在这类问题中，速度似乎有点过头了，但只是为了好玩，我做了一些其他修改，以使这个算法成为 AFAIK 中最快的算法。特别感谢[GaspardP 的宝贵建议](https://stackoverflow.com/questions/180947/base64-decode-snippet-in-c/37109258#comment69418312_37109258)和良好的基准。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2014-08-04T16:13:23.137

使用[base-n](https://code.google.com/p/base-n/)迷你库，您可以执行以下操作：

```
some_data_t in[] { ... };
constexpr int len = sizeof(in)/sizeof(in[0]);

std::string encoded;
bn::encode_b64(in, in + len, std::back_inserter(encoded));

some_data_t out[len];
bn::decode_b64(encoded.begin(), encoded.end(), out); 
```

API 是通用的，基于迭代器的。

披露：我是作者。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-07-09T15:49:36.043

*根据GaspardP 所做的[出色比较](https://stackoverflow.com/questions/342409/how-do-i-base64-encode-decode-in-c/41094722#41094722)，我不会选择此解决方案。这不是最差的，但也不是最好的。唯一的原因是它可能更容易理解。*

我发现其他两个答案很难理解。它们还会在我的编译器中产生一些警告，并且在解码部分使用 find 函数会导致效率非常低。所以我决定自己动手。

标题：

```
#ifndef _BASE64_H_
#define _BASE64_H_

#include <vector>
#include <string>
typedef unsigned char BYTE;

class Base64
{
public:
    static std::string encode(const std::vector<BYTE>& buf);
    static std::string encode(const BYTE* buf, unsigned int bufLen);
    static std::vector<BYTE> decode(std::string encoded_string);
};

#endif 
```

身体：

```
static const BYTE from_base64[] = {    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                                    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                                    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,  62, 255,  62, 255,  63,
                                     52,  53,  54,  55,  56,  57,  58,  59,  60,  61, 255, 255, 255, 255, 255, 255,
                                    255,   0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
                                     15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25, 255, 255, 255, 255,  63,
                                    255,  26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
                                     41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51, 255, 255, 255, 255, 255};

static const char to_base64[] =
             "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
             "abcdefghijklmnopqrstuvwxyz"
             "0123456789+/";

std::string Base64::encode(const std::vector<BYTE>& buf)
{
    if (buf.empty())
        return ""; // Avoid dereferencing buf if it's empty
    return encode(&buf[0], (unsigned int)buf.size());
}

std::string Base64::encode(const BYTE* buf, unsigned int bufLen)
{
    // Calculate how many bytes that needs to be added to get a multiple of 3
    size_t missing = 0;
    size_t ret_size = bufLen;
    while ((ret_size % 3) != 0)
    {
        ++ret_size;
        ++missing;
    }

    // Expand the return string size to a multiple of 4
    ret_size = 4*ret_size/3;

    std::string ret;
    ret.reserve(ret_size);

    for (unsigned int i=0; i<ret_size/4; ++i)
    {
        // Read a group of three bytes (avoid buffer overrun by replacing with 0)
        size_t index = i*3;
        BYTE b3[3];
        b3[0] = (index+0 < bufLen) ? buf[index+0] : 0;
        b3[1] = (index+1 < bufLen) ? buf[index+1] : 0;
        b3[2] = (index+2 < bufLen) ? buf[index+2] : 0;

        // Transform into four base 64 characters
        BYTE b4[4];
        b4[0] =                            ((b3[0] & 0xfc) >> 2);
        b4[1] = ((b3[0] & 0x03) << 4) +    ((b3[1] & 0xf0) >> 4);
        b4[2] = ((b3[1] & 0x0f) << 2) +    ((b3[2] & 0xc0) >> 6);
        b4[3] = ((b3[2] & 0x3f) << 0);

        // Add the base 64 characters to the return value
        ret.push_back(to_base64[b4[0]]);
        ret.push_back(to_base64[b4[1]]);
        ret.push_back(to_base64[b4[2]]);
        ret.push_back(to_base64[b4[3]]);
    }

    // Replace data that is invalid (always as many as there are missing bytes)
    for (size_t i=0; i<missing; ++i)
        ret[ret_size - i - 1] = '=';

    return ret;
}

std::vector<BYTE> Base64::decode(std::string encoded_string)
{
    // Make sure string length is a multiple of 4
    while ((encoded_string.size() % 4) != 0)
        encoded_string.push_back('=');

    size_t encoded_size = encoded_string.size();
    std::vector<BYTE> ret;
    ret.reserve(3*encoded_size/4);

    for (size_t i=0; i<encoded_size; i += 4)
    {
        // Get values for each group of four base 64 characters
        BYTE b4[4];
        b4[0] = (encoded_string[i+0] <= 'z') ? from_base64[encoded_string[i+0]] : 0xff;
        b4[1] = (encoded_string[i+1] <= 'z') ? from_base64[encoded_string[i+1]] : 0xff;
        b4[2] = (encoded_string[i+2] <= 'z') ? from_base64[encoded_string[i+2]] : 0xff;
        b4[3] = (encoded_string[i+3] <= 'z') ? from_base64[encoded_string[i+3]] : 0xff;

        // Transform into a group of three bytes
        BYTE b3[3];
        b3[0] = ((b4[0] & 0x3f) << 2) + ((b4[1] & 0x30) >> 4);
        b3[1] = ((b4[1] & 0x0f) << 4) + ((b4[2] & 0x3c) >> 2);
        b3[2] = ((b4[2] & 0x03) << 6) + ((b4[3] & 0x3f) >> 0);

        // Add the byte to the return value if it isn't part of an '=' character (indicated by 0xff)
        if (b4[1] != 0xff) ret.push_back(b3[0]);
        if (b4[2] != 0xff) ret.push_back(b3[1]);
        if (b4[3] != 0xff) ret.push_back(b3[2]);
    }

    return ret;
} 
```

用法：

```
BYTE buf[] = "ABCD";
std::string encoded = Base64::encode(buf, 4);
// encoded = "QUJDRA=="
std::vector<BYTE> decoded = Base64::decode(encoded); 
```

这里的一个好处是 decode 函数还可以解码 Base64 编码的 URL 变体。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-06-15T08:30:16.420

使用更紧凑的查找表和使用 C++17 功能的一些变化：

```
std::string base64_decode(const std::string_view in) {
  // table from '+' to 'z'
  const uint8_t lookup[] = {
      62,  255, 62,  255, 63,  52,  53, 54, 55, 56, 57, 58, 59, 60, 61, 255,
      255, 0,   255, 255, 255, 255, 0,  1,  2,  3,  4,  5,  6,  7,  8,  9,
      10,  11,  12,  13,  14,  15,  16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
      255, 255, 255, 255, 63,  255, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
      36,  37,  38,  39,  40,  41,  42, 43, 44, 45, 46, 47, 48, 49, 50, 51};
  static_assert(sizeof(lookup) == 'z' - '+' + 1);

  std::string out;
  int val = 0, valb = -8;
  for (uint8_t c : in) {
    if (c < '+' || c > 'z')
      break;
    c -= '+';
    if (lookup[c] >= 64)
      break;
    val = (val << 6) + lookup[c];
    valb += 6;
    if (valb >= 0) {
      out.push_back(char((val >> valb) & 0xFF));
      valb -= 8;
    }
  }
  return out;
} 
```

如果您没有 std::string_view，请尝试使用 std::experimental::string_view。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-02-11T00:03:21.550

我对[DaedalusAlpha 的回答的](https://stackoverflow.com/questions/180947/base64-decode-snippet-in-c/31322410#31322410)变化：

它避免了以几次测试为代价来复制参数。

使用 uint8_t 而不是 BYTE。

添加了一些方便的函数来处理字符串，尽管通常输入数据是二进制的并且内部可能有零字节，因此通常不应将其作为字符串进行操作（这通常意味着以空值结尾的数据）。

还添加了一些强制转换来修复编译器警告（至少在 GCC 上，我还没有通过 MSVC 运行它）。

文件*base64.hpp*的一部分：

```
void base64_encode(string & out, const vector<uint8_t>& buf);
void base64_encode(string & out, const uint8_t* buf, size_t bufLen);
void base64_encode(string & out, string const& buf);

void base64_decode(vector<uint8_t> & out, string const& encoded_string);

// Use this if you know the output should be a valid string
void base64_decode(string & out, string const& encoded_string); 
```

### 文件*base64.cpp*：

```
static const uint8_t from_base64[128] = {
    // 8 rows of 16 = 128
    // Note: only requires 123 entries, as we only lookup for <= z , which z=122

    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,  62, 255,  62, 255,  63,
     52,  53,  54,  55,  56,  57,  58,  59,  60,  61, 255, 255,   0, 255, 255, 255,
    255,   0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
     15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25, 255, 255, 255, 255,  63,
    255,  26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,
     41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51, 255, 255, 255, 255, 255
};

static const char to_base64[65] =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    "abcdefghijklmnopqrstuvwxyz"
    "0123456789+/";

void base64_encode(string & out, string const& buf)
{
   if (buf.empty())
      base64_encode(out, NULL, 0);
   else
      base64_encode(out, reinterpret_cast<uint8_t const*>(&buf[0]), buf.size());
}

void base64_encode(string & out, std::vector<uint8_t> const& buf)
{
   if (buf.empty())
      base64_encode(out, NULL, 0);
   else
      base64_encode(out, &buf[0], buf.size());
}

void base64_encode(string & ret, uint8_t const* buf, size_t bufLen)
{
   // Calculate how many bytes that needs to be added to get a multiple of 3
   size_t missing = 0;
   size_t ret_size = bufLen;
   while ((ret_size % 3) != 0)
   {
      ++ret_size;
      ++missing;
   }

   // Expand the return string size to a multiple of 4
   ret_size = 4*ret_size/3;

   ret.clear();
   ret.reserve(ret_size);

   for (size_t i = 0; i < ret_size/4; ++i)
   {
      // Read a group of three bytes (avoid buffer overrun by replacing with 0)
      const size_t index = i*3;
      const uint8_t b3_0 = (index+0 < bufLen) ? buf[index+0] : 0;
      const uint8_t b3_1 = (index+1 < bufLen) ? buf[index+1] : 0;
      const uint8_t b3_2 = (index+2 < bufLen) ? buf[index+2] : 0;

      // Transform into four base 64 characters
      const uint8_t b4_0 =                        ((b3_0 & 0xfc) >> 2);
      const uint8_t b4_1 = ((b3_0 & 0x03) << 4) + ((b3_1 & 0xf0) >> 4);
      const uint8_t b4_2 = ((b3_1 & 0x0f) << 2) + ((b3_2 & 0xc0) >> 6);
      const uint8_t b4_3 = ((b3_2 & 0x3f) << 0);

      // Add the base 64 characters to the return value
      ret.push_back(to_base64[b4_0]);
      ret.push_back(to_base64[b4_1]);
      ret.push_back(to_base64[b4_2]);
      ret.push_back(to_base64[b4_3]);
   }

   // Replace data that is invalid (always as many as there are missing bytes)
   for (size_t i = 0; i != missing; ++i)
      ret[ret_size - i - 1] = '=';
}

template <class Out>
void base64_decode_any( Out & ret, std::string const& in)
{
   typedef typename Out::value_type T;

   // Make sure the *intended* string length is a multiple of 4
   size_t encoded_size = in.size();

   while ((encoded_size % 4) != 0)
      ++encoded_size;

   const size_t N = in.size();
   ret.clear();
   ret.reserve(3*encoded_size/4);

   for (size_t i = 0; i < encoded_size; i += 4)
   {
      // Note: 'z' == 122

      // Get values for each group of four base 64 characters
      const uint8_t b4_0 = (            in[i+0] <= 'z') ? from_base64[static_cast<uint8_t>(in[i+0])] : 0xff;
      const uint8_t b4_1 = (i+1 < N and in[i+1] <= 'z') ? from_base64[static_cast<uint8_t>(in[i+1])] : 0xff;
      const uint8_t b4_2 = (i+2 < N and in[i+2] <= 'z') ? from_base64[static_cast<uint8_t>(in[i+2])] : 0xff;
      const uint8_t b4_3 = (i+3 < N and in[i+3] <= 'z') ? from_base64[static_cast<uint8_t>(in[i+3])] : 0xff;

      // Transform into a group of three bytes
      const uint8_t b3_0 = ((b4_0 & 0x3f) << 2) + ((b4_1 & 0x30) >> 4);
      const uint8_t b3_1 = ((b4_1 & 0x0f) << 4) + ((b4_2 & 0x3c) >> 2);
      const uint8_t b3_2 = ((b4_2 & 0x03) << 6) + ((b4_3 & 0x3f) >> 0);

      // Add the byte to the return value if it isn't part of an '=' character (indicated by 0xff)
      if (b4_1 != 0xff) ret.push_back( static_cast<T>(b3_0) );
      if (b4_2 != 0xff) ret.push_back( static_cast<T>(b3_1) );
      if (b4_3 != 0xff) ret.push_back( static_cast<T>(b3_2) );
   }
}

void base64_decode(vector<uint8_t> & out, string const& encoded_string)
{
   base64_decode_any(out, encoded_string);
}

void base64_decode(string & out, string const& encoded_string)
{
   base64_decode_any(out, encoded_string);
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-12-24T06:40:43.570

我的版本是用于 C++Builder 的 Base64 的简单快速编码器（解码器）。

```
// ---------------------------------------------------------------------------
UnicodeString __fastcall TExample::Base64Encode(void *data, int length)
{
    if (length <= 0)
        return L"";
    static const char set[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    unsigned char *in = (unsigned char*)data;
    char *pos, *out = pos = new char[((length - 1) / 3 + 1) << 2];
    while ((length -= 3) >= 0)
    {
        pos[0] = set[in[0] >> 2];
        pos[1] = set[((in[0] & 0x03) << 4) | (in[1] >> 4)];
        pos[2] = set[((in[1] & 0x0F) << 2) | (in[2] >> 6)];
        pos[3] = set[in[2] & 0x3F];
        pos += 4;
        in += 3;
    };
    if ((length & 2) != 0)
    {
        pos[0] = set[in[0] >> 2];
        if ((length & 1) != 0)
        {
            pos[1] = set[((in[0] & 0x03) << 4) | (in[1] >> 4)];
            pos[2] = set[(in[1] & 0x0F) << 2];
        }
        else
        {
            pos[1] = set[(in[0] & 0x03) << 4];
            pos[2] = '=';
        };
        pos[3] = '=';
        pos += 4;
    };
    UnicodeString code = UnicodeString(out, pos - out);
    delete[] out;
    return code;
};

// ---------------------------------------------------------------------------
int __fastcall TExample::Base64Decode(const UnicodeString &code, unsigned char **data)
{
    int length;
    if (((length = code.Length()) == 0) || ((length & 3) != 0))
        return 0;
    wchar_t *str = code.c_str();
    unsigned char *pos, *out = pos = new unsigned char[(length >> 2) * 3];
    while (*str != 0)
    {
        length = -1;
        int shift = 18, bits = 0;
        do
        {
            wchar_t s = str[++length];
            if ((s >= L'A') && (s <= L'Z'))
                bits |= (s - L'A') << shift;
            else if ((s >= L'a') && (s <= L'z'))
                   bits |= (s - (L'a' - 26)) << shift;
            else if (((s >= L'0') && (s <= L'9')))
                   bits |= (s - (L'0' - 52)) << shift;
            else if (s == L'+')
                   bits |= 62 << shift;
            else if (s == L'/')
                   bits |= 63 << shift;
            else if (s == L'=')
            {
                length--;
                break;
            }
            else
            {
                delete[] out;
                return 0;
            };
        }
        while ((shift -= 6) >= 0);
        pos[0] = bits >> 16;
        pos[1] = bits >> 8;
        pos[2] = bits;
        pos += length;
        str += 4;
    };
    *data = out;
    return pos - out;
};
//--------------------------------------------------------------------------- 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-12-07T16:05:42.167

我用这个：

```
class BinaryVector {
public:
    std::vector<char> bytes;

    uint64_t bit_count = 0;

public:
    /* Add a bit to the end */
    void push_back(bool bit);

    /* Return false if character is unrecognized */
    bool pushBase64Char(char b64_c);
};

void BinaryVector::push_back(bool bit)
{
    if (!bit_count || bit_count % 8 == 0) {
        bytes.push_back(bit << 7);
    }
    else {
        uint8_t next_bit = 8 - (bit_count % 8) - 1;
        bytes[bit_count / 8] |= bit << next_bit;
    }
    bit_count++;
}

/* Converts one Base64 character to 6 bits */
bool BinaryVector::pushBase64Char(char c)
{
    uint8_t d;

    // A to Z
    if (c > 0x40 && c < 0x5b) {
        d = c - 65;  // Base64 A is 0
    }
    // a to z
    else if (c > 0x60 && c < 0x7b) {
        d = c - 97 + 26;  // Base64 a is 26
    }
    // 0 to 9
    else if (c > 0x2F && c < 0x3a) {
        d = c - 48 + 52;  // Base64 0 is 52
    }
    else if (c == '+') {
        d = 0b111110;
    }
    else if (c == '/') {
        d = 0b111111;
    }
    else if (c == '=') {
        d = 0;
    }
    else {
        return false;
    }

    push_back(d & 0b100000);
    push_back(d & 0b010000);
    push_back(d & 0b001000);
    push_back(d & 0b000100);
    push_back(d & 0b000010);
    push_back(d & 0b000001);

    return true;
}

bool loadBase64(std::vector<char>& b64_bin, BinaryVector& vec)
{
    for (char& c : b64_bin) {
        if (!vec.pushBase64Char(c)) {
            return false;
        }
    }
    return true;
} 
```

用于`vec.bytes`访问转换后的数据。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-03-07T01:20:22.317

我首先制作了自己的版本，然后找到了这个主题。

为什么我的版本看起来比这里介绍的其他版本更简单？难道我做错了什么？我没有测试它的速度。

```
inline char const* b64units = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

inline char* b64encode(void const* a, int64_t b) {
    ASSERT(a != nullptr);
    if (b > 0) {
        uint8_t const* aa = static_cast<uint8_t const*>(a);
        uint8_t v = 0;
        int64_t bp = 0;
        int64_t sb = 0;
        int8_t off = 0;
        int64_t nt = ((b + 2) / 3) * 4;
        int64_t nd = (b * 8) / 6;
        int64_t tl = ((b * 8) % 6) ? 1 : 0;
        int64_t nf = nt - nd - tl;
        int64_t ri = 0;
        char* r = new char[nt + 1]();
        for (int64_t i = 0; i < nd; i++) {
            v = (aa[sb] << off) | (aa[sb + 1] >> (8 - off));
            v >>= 2;
            r[ri] = b64units[v];
            ri += 1;
            bp += 6;
            sb = (bp / 8);
            off = (bp % 8);
        }
        if (tl > 0) {
            v = (aa[sb] << off);
            v >>= 2;
            r[ri] = b64units[v];
            ri += 1;
        }
        for (int64_t i = 0; i < nf; i++) {
            r[ri] = '=';
            ri += 1;
        }
        return r;
    } else return nullptr;
} 
```

PS：我的方法效果很好。我用[Node.js](https://en.wikipedia.org/wiki/Node.js)测试了它：

```
let data = 'stackabuse.com';
let buff = new Buffer(data);
let base64data = buff.toString('base64'); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-07T12:20:19.020

我喜欢[GitHub 上的这个解决方案](https://github.com/mvorbrodt/blog/blob/master/src/base64.hpp)。

它是一个单独的 hpp 文件，它使用 vector<byte> 类型的原始数据，这与接受的答案不同。

```
#pragma once

#include <string>
#include <vector>
#include <stdexcept>
#include <cstdint>

namespace base64
{
    inline static const char kEncodeLookup[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    inline static const char kPadCharacter = '=';

    using byte = std::uint8_t;

    inline std::string encode(const std::vector<byte>& input)
    {
        std::string encoded;
        encoded.reserve(((input.size() / 3) + (input.size() % 3 > 0)) * 4);

        std::uint32_t temp{};
        auto it = input.begin();

        for(std::size_t i = 0; i < input.size() / 3; ++i)
        {
            temp  = (*it++) << 16;
            temp += (*it++) << 8;
            temp += (*it++);
            encoded.append(1, kEncodeLookup[(temp & 0x00FC0000) >> 18]);
            encoded.append(1, kEncodeLookup[(temp & 0x0003F000) >> 12]);
            encoded.append(1, kEncodeLookup[(temp & 0x00000FC0) >> 6 ]);
            encoded.append(1, kEncodeLookup[(temp & 0x0000003F)      ]);
        }

        switch(input.size() % 3)
        {
        case 1:
            temp = (*it++) << 16;
            encoded.append(1, kEncodeLookup[(temp & 0x00FC0000) >> 18]);
            encoded.append(1, kEncodeLookup[(temp & 0x0003F000) >> 12]);
            encoded.append(2, kPadCharacter);
            break;
        case 2:
            temp  = (*it++) << 16;
            temp += (*it++) << 8;
            encoded.append(1, kEncodeLookup[(temp & 0x00FC0000) >> 18]);
            encoded.append(1, kEncodeLookup[(temp & 0x0003F000) >> 12]);
            encoded.append(1, kEncodeLookup[(temp & 0x00000FC0) >> 6 ]);
            encoded.append(1, kPadCharacter);
            break;
        }

        return encoded;
    }

    std::vector<byte> decode(const std::string& input)
    {
        if(input.length() % 4)
            throw std::runtime_error("Invalid base64 length!");

        std::size_t padding{};

        if(input.length())
        {
            if(input[input.length() - 1] == kPadCharacter) padding++;
            if(input[input.length() - 2] == kPadCharacter) padding++;
        }

        std::vector<byte> decoded;
        decoded.reserve(((input.length() / 4) * 3) - padding);

        std::uint32_t temp{};
        auto it = input.begin();

        while(it < input.end())
        {
            for(std::size_t i = 0; i < 4; ++i)
            {
                temp <<= 6;
                if     (*it >= 0x41 && *it <= 0x5A) temp |= *it - 0x41;
                else if(*it >= 0x61 && *it <= 0x7A) temp |= *it - 0x47;
                else if(*it >= 0x30 && *it <= 0x39) temp |= *it + 0x04;
                else if(*it == 0x2B)                temp |= 0x3E;
                else if(*it == 0x2F)                temp |= 0x3F;
                else if(*it == kPadCharacter)
                {
                    switch(input.end() - it)
                    {
                    case 1:
                        decoded.push_back((temp >> 16) & 0x000000FF);
                        decoded.push_back((temp >> 8 ) & 0x000000FF);
                        return decoded;
                    case 2:
                        decoded.push_back((temp >> 10) & 0x000000FF);
                        return decoded;
                    default:
                        throw std::runtime_error("Invalid padding in base64!");
                    }
                }
                else throw std::runtime_error("Invalid character in base64!");

                ++it;
            }

            decoded.push_back((temp >> 16) & 0x000000FF);
            decoded.push_back((temp >> 8 ) & 0x000000FF);
            decoded.push_back((temp      ) & 0x000000FF);
        }

        return decoded;
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-24T15:08:35.357

这是我写的一篇文章，它使用联合和位域来实现最大的效率和可读性。

```
const char PADDING_CHAR = '=';
const char* ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
const uint8_t DECODED_ALPHBET[128]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,0,0,0,0,0};

/**
 * Given a string, this function will encode it in 64b (with padding)
 */
std::string encodeBase64(const std::string& binaryText)
{
    std::string encoded((binaryText.size()/3 + (binaryText.size()%3 > 0)) << 2, PADDING_CHAR);

    const char* bytes = binaryText.data();
    union
    {
        uint32_t temp = 0;
        struct
        {
            uint32_t first : 6, second : 6, third : 6, fourth : 6;
        } tempBytes;
    };
    std::string::iterator currEncoding = encoded.begin();

    for(uint32_t i = 0, lim = binaryText.size() / 3; i < lim; ++i, bytes+=3)
    {
        temp = bytes[0] << 16 | bytes[1] << 8 | bytes[2];
        (*currEncoding++) = ALPHABET[tempBytes.fourth];
        (*currEncoding++) = ALPHABET[tempBytes.third];
        (*currEncoding++) = ALPHABET[tempBytes.second];
        (*currEncoding++) = ALPHABET[tempBytes.first];
    }

    switch(binaryText.size() % 3)
    {
    case 1:
        temp = bytes[0] << 16;
        (*currEncoding++) = ALPHABET[tempBytes.fourth];
        (*currEncoding++) = ALPHABET[tempBytes.third];
        break;
    case 2:
        temp = bytes[0] << 16 | bytes[1] << 8;
        (*currEncoding++) = ALPHABET[tempBytes.fourth];
        (*currEncoding++) = ALPHABET[tempBytes.third];
        (*currEncoding++) = ALPHABET[tempBytes.second];
        break;
    }

    return encoded;
}

/**
 * Given a 64b padding-encoded string, this function will decode it.
 */
std::string decodeBase64(const std::string& base64Text)
{
    if( base64Text.empty() )
        return "";

    assert((base64Text.size()&3) == 0 && "The base64 text to be decoded must have a length devisible by 4!");

    uint32_t numPadding =  (*std::prev(base64Text.end(),1) == PADDING_CHAR) + (*std::prev(base64Text.end(),2) == PADDING_CHAR);

    std::string decoded((base64Text.size()*3>>2) - numPadding, '.');

    union
    {
        uint32_t temp;
        char tempBytes[4];
    };
    const uint8_t* bytes = reinterpret_cast<const uint8_t*>(base64Text.data());

    std::string::iterator currDecoding = decoded.begin();

    for(uint32_t i = 0, lim = (base64Text.size() >> 2) - (numPadding!=0); i < lim; ++i, bytes+=4)
    {
        temp = DECODED_ALPHBET[bytes[0]] << 18 | DECODED_ALPHBET[bytes[1]] << 12 | DECODED_ALPHBET[bytes[2]] << 6 | DECODED_ALPHBET[bytes[3]];
        (*currDecoding++) = tempBytes[2];
        (*currDecoding++) = tempBytes[1];
        (*currDecoding++) = tempBytes[0];
    }

    switch (numPadding)
    {
    case 2:
        temp = DECODED_ALPHBET[bytes[0]] << 18 | DECODED_ALPHBET[bytes[1]] << 12;
        (*currDecoding++) = tempBytes[2];
        break;

    case 1:
        temp = DECODED_ALPHBET[bytes[0]] << 18 | DECODED_ALPHBET[bytes[1]] << 12 | DECODED_ALPHBET[bytes[2]] << 6;
        (*currDecoding++) = tempBytes[2];
        (*currDecoding++) = tempBytes[1];
        break;
    }

    return decoded;
} 
```

# silverlight - 你如何将silverlight dll打包成xap文件？

> ID：180963
> 
> 赞同：1
> 
> 时间：2008-10-08T00:36:48.610
> 
> 标签：silverlight, silverlight-2-rc0

刚刚用 rc0 更新了构建服务器，没有惊喜。想知道如何在没有 chiron 的情况下打包 xap 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T03:10:52.637

[嗨，Brian，您可以从http://www.codeplex.com/sdlsdk](http://www.codeplex.com/sdlsdk)获得 chiron——它已被决定从 SL SDK 核心工具中删除，但它仍然是可用的 DLR SDK 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T03:27:47.453

更具体地说，您仍然可以使用 MSBuild。如果您需要查看或修改目标，则目标应位于 C:\program files\MSBuild\Microsoft\Silverlight\v2.0...您的 .csproj（或 .vbproj）也可以有预/后构建任务MSBuild 也是如此。

# mysql - 一次向多个表添加新字段？

> ID：180967
> 
> 赞同：1
> 
> 时间：2008-10-08T00:38:50.290
> 
> 标签：mysql, sql

我想将相同的字段添加到多个表中。我可以在 MySql 中使用单个查询来执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T01:06:14.633

我认为您不能使用单个查询来执行此操作，因为它需要`ALTER TABLE`每个查询仅支持一个表的语法（尽管您可以在同一个表中添加/修改多个列）。

您必须对`ALTER TABLE`要修改的每个表执行一次查询。

# java - Java EE 编程技能

> ID：180978
> 
> 赞同：12
> 
> 时间：2008-10-08T00:45:05.893
> 
> 标签：java, jakarta-ee

我有多年的 Java 经验，包括 Swing、Servlet 和 JDBC，但从未为 Java EE 服务器编程。

许多大公司的招聘广告都专门要求有 Java EE 经验。是否有我应该学习的特定技能或发展环境才能胜任这类工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-08T00:54:11.383

下载 JBoss 并开始使用文档中的示例应用程序。如果你学过java，那你就95%了。Java EE 将容器和命名方面添加到您已经了解和喜爱的 java 中。随着 EJB3 的出现，bean 变得更加简单，因为您只需要几个注释就可以使用 EJB。Java EE 可能对可用技术的首字母缩略词有点令人生畏，但请专注于基础知识：EJB3、JNDI、JMS、数据访问（如 Hibernate/JDO）和容器基础知识。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-08T01:15:12.637

“是否有我应该学习的特定技能或发展环境才能胜任这类工作？”

如果我要采访一个典型的 Java EE 商店的人，我想知道你对以下内容的了解程度
1) servlets
2) EJB (也许)
3) JSP
4) ant
5) junit
6) subversion 或其他 VCS
7) http 和 html
8) javascript
9) struts
10) hibernate
11) spring(也许)

我不是想吓唬你，而是你需要知道的 1/2 可以通过 WROX 出版社的“专业 J2EE”获得。剩下的技能，你应该能够通过一本春季书籍（大多数春季书籍也谈论stuts和hibernate） - 例如“The Spring Primer” - [http://www.sourcebeat.com/books/ springlive.html](http://www.sourcebeat.com/books/springlive.html)。

祝你好运

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T00:53:17.547

这些工作很可能要求您有与一个或多个主要应用服务器供应商（即 WebLogic、WebSphere 或 JBoss）打交道的经验。它与您习惯使用的 servlet 和 JDBC 有点不同，但它仍然只是 Java。通常，您必须处理诸如 JNDI 查找、依赖注入、消息队列、维护事务之间的应用程序状态、对象/关系映射等。

我发现对于大多数 Java EE 项目，更多的是了解组件和系统是如何配置的以及它们如何协同工作，而不是任何特定的编程技能。而且您还会花费更多时间等待服务器启动；）；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T01:10:42.240

从 WROX 出版社获得“Professional J2EE”一书——它有 6 到 7 年的历史，但内容非常好。你应该可以用那本书和 3.x 版本的 JBoss 或 4.x 版本的 JBoss 和 eclipse 过得很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T01:12:03.920

我觉得你状态很好。Servlet 是 Java EE 的一部分，因此您已经掌握了一项技能。JDBC 的使用也几乎相同，但大部分时间是在其他一些框架下使用的。

所以我想说你已经有（一些）Java EE 经验。阅读有关 EJB、事务的信息，我认为您已经准备好接受面试了。

很多时候，获得这种体验的唯一方法就是亲身体验。如果你说服你的面试官，你已经具备的技能足以获得这个职位，那么剩下的你将通过经验获得。

继续！你准备好了。（至少你会从面试中学到东西：P）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T01:14:34.227

无论何时开始采访，Ken，请注意，疯狂的 Java 营销机器似乎正在将 J2EE 重命名为 Java EE。可以想象，在不久的将来，您可能会遇到一个从未听说过 J2EE，但迫切需要 Java EE 经验的 HR 部门。

# java - 使用 Collections API 进行随机播放

> ID：180979
> 
> 赞同：6
> 
> 时间：2008-10-08T00:45:15.207
> 
> 标签：java, collections, shuffle

我变得非常沮丧，因为我似乎无法弄清楚为什么 Collections shuffle 不能正常工作。

可以说我正在尝试对`randomizer`数组进行洗牌。

```
int[] randomizer = new int[] {200,300,212,111,6,2332}; 
Collections.shuffle(Arrays.asList(randomizer)); 
```

出于某种原因，无论我是否调用 shuffle 方法，元素都保持完全相同的排序。有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-08T00:52:52.603

`Arrays.asList`不能与基元数组一起使用。改用这个：

```
Integer[] randomizer = new Integer[] {200,300,212,111,6,2332}; 
Collections.shuffle(Arrays.asList(randomizer)); 
```

相同的规则适用于集合框架中的大多数类，因为您不能使用原始类型。

原始代码 (with `int[]`) 编译得很好，但没有按预期工作，因为可变参数方法的行为`asList`：它只是创建一个单元素列表，`int`数组作为其唯一成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T01:01:43.567

克里斯的回答是正确的。

正如我在对克里斯的回答的评论中所说的那样，除非数组列表需要增长，否则您的基础数组将适当更改，并且列表会创建一个新数组并将项目复制到其中。

您可能希望保留对列表的引用并在 Arrays.asList 调用之后对其进行迭代，之后不再对数组进行迭代，而是对 List 进行迭代。

# web-services - tempuri.org 是什么？

> ID：180985
> 
> 赞同：97
> 
> 时间：2008-10-08T00:50:36.740
> 
> 标签：web-services, namespaces

tempuri.org 为什么存在？为什么每个 XML Webservice 都需要自己的命名空间，与 Web 上的任何其他服务不同？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-08T00:57:46.367

不幸的是，该`tempuri.org`URL 现在只是重定向到 Bing。

您可以通过以下方式查看它用来渲染的内容`archive.org`：

> [https://web.archive.org/web/20090304024056/http://tempuri.org/](https://web.archive.org/web/20090304024056/http://tempuri.org/)

去引用：

> 每个 XML Web 服务都需要一个唯一的名称空间，以便客户端应用程序将其与 Web 上的其他服务区分开来。默认情况下，ASP.Net Web 服务为此目的使用[http://tempuri.org/ 。](http://tempuri.org/)虽然这适用于正在开发的 XML Web 服务，但发布的服务应该使用唯一的、永久的名称空间。
> 
> 您的 XML Web Service 应该由您控制的名称空间来标识。例如，您可以使用公司的 Internet 域名作为命名空间的一部分。尽管许多名称空间看起来像 URL，但它们不需要指向 Web 上的实际资源。
> 
> 对于使用 ASP.NET 创建的 XML Web 服务[原文如此]，可以使用 WebService 属性的 Namespace 属性更改默认命名空间。WebService 属性应用于包含 XML Web Service 方法的类。下面是将命名空间设置为“ [http://microsoft.com/webservices/](http://microsoft.com/webservices/) ”的代码示例：
> 
> C＃
> 
> ```
> [WebService(Namespace="http://microsoft.com/webservices/")]
> public class MyWebService {
>    // implementation
> } 
> ```
> 
> Visual Basic.NET
> 
> ```
> <WebService(Namespace:="http://microsoft.com/webservices/")> Public Class MyWebService
>     ' implementation
> End Class 
> ```
> 
> 视觉 J#.NET
> 
> ```
> /**@attribute WebService(Namespace="http://microsoft.com/webservices/")*/
> public class MyWebService {
>     // implementation
> } 
> ```

还值得阅读“A 1.3 生成 URI”部分：

[http://www.w3.org/TR/wsdl#_Toc492291092](http://www.w3.org/TR/wsdl#_Toc492291092)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-10-08T01:05:26.913

Web 服务需要唯一的名称空间，因此它们不会混淆彼此的模式和其他任何东西。URL（域、子域、子子域等）是一个聪明的标识符，因为它“保证”是唯一的，并且在大多数情况下你已经有了一个。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-08T00:59:21.840

可能是为了保证公共网络服务是独一无二的。

它总是让我想起美味的油炸食品……

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-08T00:58:49.157

[http://en.wikipedia.org/wiki/Tempuri](http://en.wikipedia.org/wiki/Tempuri)

> tempuri.org 是 Microsoft 开发产品（如 Visual Studio）使用的默认命名空间 URI。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-08T01:26:18.557

请注意，有效 Web URL 格式的命名空间不一定需要取消引用，即您不需要在该 URL 处提供实际内容。重要的是命名空间是全局唯一的。

# python - re.search 和 re.match 有什么区别？

> ID：180986
> 
> 赞同：624
> 
> 时间：2008-10-08T00:51:36.257
> 
> 标签：python, regex, search, match

[Python](http://docs.python.org/2/library/re.html)[模块](http://docs.python.org/2/library/re.html)`search()`中的和`match()`函数有什么区别？[`re`](http://docs.python.org/2/library/re.html)

我已阅读[文档](http://www.python.org/doc/2.5.2/lib/matching-searching.html)（[当前文档](http://docs.python.org/2/library/re.html?highlight=matching%20searching#search-vs-match)），但我似乎从未记得它。我一直不得不查找并重新学习它。我希望有人会用例子清楚地回答它，以便（也许）它会留在我的脑海中。或者至少我会有一个更好的地方来回答我的问题，并且重新学习它需要更少的时间。

* * *

## 回答 #1

> 赞同：603
> 
> 时间：2008-10-08T00:53:12.117

`re.match`锚定在字符串的开头。这与换行无关，因此与`^`在模式中使用不同。

正如[re.match 文档](http://docs.python.org/2/library/re.html#re.match)所说：

> **如果字符串开头的**零个或多个字符 与正则表达式模式匹配，则返回相应的`MatchObject`实例。`None`如果字符串与模式不匹配则返回；请注意，这与零长度匹配不同。
> 
> 注意：如果要在字符串中的任何位置找到匹配项，请`search()` 改用。

`re.search`[如文档](http://docs.python.org/2/library/re.html#re.search)所述，搜索整个字符串：

> **扫描字符串**以查找正则表达式模式产生匹配的位置，并返回相应的`MatchObject`实例。`None`如果字符串中没有位置与模式匹配，则返回；请注意，这与在字符串中的某个点找到零长度匹配不同。

因此，如果您需要匹配字符串的开头，或者匹配整个字符串，请使用`match`. 它更快。否则使用`search`.

该文档有一个针对[vs.的](http://docs.python.org/2/library/re.html#search-vs-match)[特定部分，`match``search`](http://docs.python.org/2/library/re.html#search-vs-match)其中也涵盖了多行字符串：

> Python 基于正则表达式提供了两种不同的原始操作：**仅在字符串的开头**`match`检查 匹配，而在字符串中的**任何位置**检查匹配 （这是 Perl 默认所做的）。**`search`**
> 
>  ****请注意， 即使使用以:开头的正则表达式`match`也可能有所不同，仅匹配字符串的开头，或者在 模式下也紧跟换行符。“<code>match”操作*只有在模式匹配**字符串的****开头***（ 无论模式如何）或在可选 参数给出的起始位置（无论是否有换行符之前）匹配时才会成功。`search``'^'``'^'``MULTILINE`**`pos`******

 ******现在，足够的谈话。是时候看一些示例代码了：

```
# example code:
string_with_newlines = """something
someotherthing"""

import re

print re.match('some', string_with_newlines) # matches
print re.match('someother', 
               string_with_newlines) # won't match
print re.match('^someother', string_with_newlines, 
               re.MULTILINE) # also won't match
print re.search('someother', 
                string_with_newlines) # finds something
print re.search('^someother', string_with_newlines, 
                re.MULTILINE) # also finds something

m = re.compile('thing$', re.MULTILINE)

print m.match(string_with_newlines) # no match
print m.match(string_with_newlines, pos=4) # matches
print m.search(string_with_newlines, 
               re.MULTILINE) # also matches 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2011-12-31T12:05:43.113

`search`⇒ 在字符串中的任何地方找到一些东西并返回一个匹配对象。

`match`⇒ 在字符串的*开头*找到一些东西并返回一个匹配对象。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2018-04-07T19:03:18.807

> match 比 search 快得多，因此如果您使用数百万个数据，您可以执行 regex.match((.*?)word(.*?)) 而不是执行 regex.search("word") 并获得大量性能样品。

[@ivan_bilan 在上面接受的答案下的这条评论](https://stackoverflow.com/questions/180986/what-is-the-difference-between-re-search-and-re-match#comment62326091_180993)让我想到这种*黑客*是否真的加速了任何事情，所以让我们看看你会真正获得多少吨的性能。

我准备了以下测试套件：

```
import random
import re
import string
import time

LENGTH = 10
LIST_SIZE = 1000000

def generate_word():
    word = [random.choice(string.ascii_lowercase) for _ in range(LENGTH)]
    word = ''.join(word)
    return word

wordlist = [generate_word() for _ in range(LIST_SIZE)]

start = time.time()
[re.search('python', word) for word in wordlist]
print('search:', time.time() - start)

start = time.time()
[re.match('(.*?)python(.*?)', word) for word in wordlist]
print('match:', time.time() - start) 
```

我进行了 10 次测量（1M、2M、...、10M 字），结果如下：

[![匹配与搜索正则表达式 speedtest 线图](https://i.stack.imgur.com/g55A6.png)](https://i.stack.imgur.com/g55A6.png)

如您所见，**搜索模式`'python'`**比匹配模式**更快**`'(.*?)python(.*?)'`。

*Python 很聪明。避免试图变得更聪明。*

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2008-10-08T01:07:26.490

`re.search` **在**整个字符串中****搜索**模式，`re.match`而不*搜索*模式；如果没有，除了在字符串的开头**匹配**它之外别无选择。**

 *** * *

## 回答 #5

> 赞同：38
> 
> 时间：2015-07-30T05:27:27.010

您可以参考以下示例来了解`re.match`和 re.search的工作原理

```
a = "123abc"
t = re.match("[a-z]+",a)
t = re.search("[a-z]+",a) 
```

`re.match`会回来`none`，但`re.search`会回来`abc`。

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2016-05-21T13:28:47.277

不同之处在于，会**`re.match()`误导任何习惯于*Perl*、*grep*或*sed*正则表达式匹配的人，而`re.search()`不会。**:-)

更清醒的是，[正如 John D. Cook 所说](http://www.johndcook.com/blog/python_regex/)，`re.match()`“表现得好像每个模式都有 ^ 前缀。” 换句话说，`re.match('pattern')`等于`re.search('^pattern')`。所以它锚定了图案的左侧。但它也*不会锚定模式的右侧：*仍然需要终止`$`.

坦率地说，鉴于上述情况，我认为`re.match()`应该弃用。我很想知道应该保留它的原因。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-08T00:54:57.620

re.match 尝试匹配**字符串开头的**模式。re.search 尝试匹配**整个字符串**中的模式，直到找到匹配项。

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2018-10-31T00:22:53.193

矮得多：

*   `search`扫描整个字符串。

*   `match`仅扫描字符串的开头。

跟随前任说：

```
>>> a = "123abc"
>>> re.match("[a-z]+",a)
None
>>> re.search("[a-z]+",a)
abc 
```

# xcode - 附加到远程进程以进行调试

> ID：180987
> 
> 赞同：6
> 
> 时间：2008-10-08T00:52:17.690
> 
> 标签：xcode, macos, debugging, gdb, xcode3.1

在 OSX 10.5 上使用 Xcode 3.1；是否可以将（调试器）附加到正在运行的远程进程？

我知道可以启动和调试远程进程（如此[处](http://developer.apple.com/documentation/developertools/Conceptual/XcodeDebugging/800-Debugging_Programs_Remotely/chapter_11_section_1.html#//apple_ref/doc/uid/TP40007057-CH11-SW1)所述），但如果我能找到一种附加到已经运行的远程进程的方法会很棒......

编辑添加：谢谢。我已经向 Apple 提交了错误报告。如果/当我收到他们的回复时，将更新这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-21T21:32:29.697

XCode 中没有很好的 gui，但你可以这样做：

1.  通过远程调试从 XCode 启动程序的第二个实例，
2.  从控制台使用 GDB attach 命令

分步说明：

1.  按照 Apple 的[说明](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/XcodeDebugging/300-Debugging_Programs_Remotely/remote_debugging.html "指示")设置远程调试：

2.  在远程机器上找出程序正在运行的实例的*进程 ID ：*

    ssh "remotemachine" 'ps -x -w -w' | grep“应用程序名称”

    （您也可以使用 ARD 和 ActivityMonitor）

3.  在您的应用程序主中放置一个断点，并从调试器（在远程框上）启动第二个实例

4.  在 GDB 控制台（运行/控制台菜单）中输入：

    附加*进程ID*

5.  现在您已将 XCode 附加到正在运行的进程。您现在可以使用图形调试器。

（在早期的 XCode 中，没有用于附加到本地进程的 GUI，所以[这个技巧/hack 是解决方案......](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/XcodeDebugging/300-Debugging_Programs_Remotely/remote_debugging.html "指示")）**************************