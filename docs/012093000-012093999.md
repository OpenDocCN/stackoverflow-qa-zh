# StackOverflow 问答 12093000-12093999

# python - Python：我可以从类 bar 中创建的类 foo 访问类实例吗？

> ID：12093000
> 
> 赞同：2
> 
> 时间：2012-08-23T13:41:50.360
> 
> 标签：python, class, instance

我有一堂课如下：

```
class Hand():
    def __init__(self, hand_a, play_deck, split_count, name): # hand_a for hand actual
        self.hand_a = hand_a  # the actual hand when instance created
        self.play_deck = play_deck  #  need to move this to deck class
        self.split_count = split_count
        self.name = name 
```

在另一个类中，我创建了一个 Hand 的实例：

```
class DECK():
    def __init__(self):
        pass

    def deal(self, play_deck):
        dhand = {}
        phand = {}
        for i in range (2):
            play_deck, phand[i] = pick_item(play_deck)
            play_deck, dhand[i] = pick_item(play_deck)

        # creat instance of Hand for player's starting hand
        self.start_hand = Hand(phand, play_deck, 0, "Player 1") 
```

在第三堂课中，我试图访问我的第一个 Hand 实例，称为“start_hand”：

```
class Game():
    def __init__(self):
        pass

    def play_game(self):
        self.deck = DECK()
        self.deck.deal(play_deck)
        print "dhand = %r" % start_hand.hand_a 
```

但我收到以下错误：

```
 print "dhand = %r" % start_hand.hand_a
NameError: global name 'start_hand' is not defined 
```

我也试过：

```
print "dhand = %r" % self.start_hand.hand_a 
```

但我收到以下错误：

```
 print "dhand = %r" % self.start_hand.hand_a
AttributeError: Game instance has no attribute 'start_hand' 
```

我是否必须以其他方式创建类实例，还是必须以不同的方式访问它或两者兼而有之？还是我离得太远了，我应该重新开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T13:44:16.360

是的，您可以访问该属性。你要

```
self.deck.start_hand.hand_a
# ^ deck object you just created
#         ^Hand object created by the deck constructor/initiator (DECK.__init__)
#                    ^ starting hand attribute of hand object. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T13:44:05.450

你为什么不试试这个？

```
def deal(self, play_deck):
  ...
  return start_hand 
```

否则`start_hand`是`DECK`对象的成员，因此您必须：

```
self.deck.start_hand 
```

访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T13:45:23.080

你`start_hand`是`deck`对象的成员。

```
print "dhand = %r" % self.deck.start_hand.hand_a 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T13:55:54.643

> 我是否必须以其他方式创建类实例，还是必须以不同的方式访问它或两者兼而有之？还是我离得太远了，我应该重新开始？

您的问题是 OO 设计之一，而不是特定于 python 的功能。决定你想要如何`Game`、如何`DECK`与`Hand`彼此相处。通常，适当的解决方案是在封闭类中创建一个将委托给其成员的方法。

很难提出具体的建议，因为看起来这可能是一些调试代码。但也许你可以更换

```
print "dhand = %r" % start_hand.hand_a 
```

和

```
print str(self.deck) 
```

只要您将`__str__`方法添加到`Deck`：

```
def __str__(self):
    return str(self.start_hand) 
```

为了有用，您可能还需要一个用于`Hand`课程。

不请自来的建议：（`hand_a`“实际的”）成员`Hand`创建了一个非常令人困惑的隐喻。考虑将其作为 the 的属性`DECK`或其他可能更有意义的属性。

# javascript - iOS 设备上使用 CraftyJS 的场景大小

> ID：12093002
> 
> 赞同：3
> 
> 时间：2012-08-23T13:42:08.627
> 
> 标签：javascript, ios, mobile-safari, viewport, craftyjs

我正在尝试使 CraftyJS 场景大小为 100x100 像素，以便在 iOS 上的移动 Safari 中完全显示为 100x100 像素。

代码本质上是这样的：

```
function init() {
// Start crafty     
Crafty.init(100, 100);
Crafty.canvas.init();
Crafty.background('#eeeeee');
Crafty.e('2D, Canvas, Color').attr({x: 0, y: 0, w: 10, h: 10}).Color('black');
} 
```

在桌面上它工作正常。在移动 Safari 上，它会调整为不同的大小。我试图摆弄视口元标记，但似乎 Crafty 有自己的设置。任何帮助或指向正确方向的指针表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:25:48.270

JS 代码看起来不错，您的视口设置应如下所示，以确保设备不会尝试缩放页面以适应：

```
 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T21:06:46.507

我相信我找到了原因 - 视网膜显示器（高 DPI）上的 Safari 将每个 CSS 像素解释为 2 个逻辑像素，因此图像大小加倍。有一个 webkit 设置可以改变这个，比如：

```
<link rel="stylesheet" type="text/css" href="/css/retina.css" media="only screen and (-webkit-min-device-pixel-ratio: 2)" /> 
```

至于 Crafty 本身，我可能需要调整它的视口设置并将初始比例设置为 0.5 而不是视网膜显示器上的 1.0 来解决这个问题。

# jquery - 图片预加载插件 onComplete 功能

> ID：12093004
> 
> 赞同：1
> 
> 时间：2012-08-23T13:42:15.613
> 
> 标签：jquery, image, preload

我在使用 jquery 预加载功能时遇到了一些问题，想知道是否有人可以帮助我。我在 jquery 预加载插件中添加了为我的站点加载背景图像，但我想创建一个 onComplete 函数，以便在加载图像时启动背景随机播放功能。但我似乎无法做到这一点。如果您知道更好的方法或方法，那将非常感谢。

```
$(document).ready(function () {

    $.fn.preload = function () {
        this.each(function () {
            $('<img/>')[0].src = this;
        });
    }

    $(['../images/background1.jpg', '../images/background2.jpg', '../images/background3.jpg', '../images/background4.jpg', '../images/background5.jpg', '../images/background6.jpg', '../images/background7.jpg']).preload();

    var images = new Array();
    images[1] = "../images/background-1.jpg",
images[2] = "../images/background-7.jpg",
images[3] = "../images/background-4.jpg",
images[4] = "../images/background-5.jpg",
images[5] = "../images/background-6.jpg",
images[6] = "../images/background-2.jpg",

    Array.prototype.shuffle = function () {
        var len = this.length;
        var i = len;
        while (i--) {
            var p = parseInt(Math.random() * len);
            var t = this[i];
            this[i] = this[p];
            this[p] = t;
        }
    };
    images.shuffle();
    // A little script for preloading all of the images

    // It's not necessary, but generally a good idea

    var index = 0;

    $.backstretch(images[index], { speed: 1000 });

    var slideshow = setInterval(function () {

        index = (index >= images.length - 1) ? 0 : index + 1;

        $.backstretch(images[index]);

    }, 5000);

}); 
```

# asp.net-mvc-3 - 如何在 MVC (Razor) 中对 PartialView 进行属性编码

> ID：12093005
> 
> 赞同：2
> 
> 时间：2012-08-23T13:42:19.133
> 
> 标签：asp.net-mvc-3, razor, attributes, partial-views, encode

我正在使用 PartialViews 在我的 ASP.NET MVC 应用程序中存储工具提示的 HTML。我最初的想法是 Razor 会自动对 HTML 中引号之间的任何内容进行属性编码。不幸的是，情况似乎并非如此，所以我现在的解决方法是使用单引号来封装我的 PartialViews HTML。如下：

```
<div class="tooltip" title='@Html.Partial("_MyTooltipInAPartial")'>Some content</div> 
```

这很有效，但如果我的 PartialView 中有任何单引号，我显然会遇到问题。

有谁知道解决这个问题的正确方法？我得到的最接近的是以下内容：

```
<div class="tooltip" title="@HttpUtility.HtmlAttributeEncode(Html.Partial("_MyTooltipInAPartial"))">Some content</div> 
```

不幸的是，这并不完全有效，因为 Partial 的输出是 MvcHtmlString 而不是直字符串。

有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T10:55:27.867

感谢 nemesv 的建议 - 它没有成功。经过一番思考，我最终通过编写一个名为`PartialAttributeEncoded`.

对于任何有兴趣的人，以下是您使用帮助程序的方式：

```
<div class="tooltip" title="@Html.PartialAttributeEncoded("_MyTooltipInAPartial")">Some content</div> 
```

这是帮手：

```
using System.Web;
using System.Web.Mvc;
using System.Web.Mvc.Html;

namespace My.Helpers
{
    /// <summary>
    /// MVC HtmlHelper extension methods - html element extensions
    /// </summary>
    public static class PartialExtensions
    {
        /// <summary>
        /// Allows a partial to be rendered within quotation marks.
        /// I use this with jQuery tooltips where we store the tooltip HMTL within a partial.
        /// See example usage below:
        /// <div class="tooltip" title="@Html.PartialAttributeEncoded("_MyTooltipInAPartial")">Some content</div>
        /// </summary>
        /// <param name="helper"></param>
        /// <param name="partialViewName"></param>
        /// <param name="model"></param>
        /// <returns></returns>
        public static MvcHtmlString PartialAttributeEncoded(
          this HtmlHelper helper,
          string partialViewName,
          object model = null
        )
        {
            //Create partial using the relevant overload (only implemented ones I used)
            var partialString = (model == null)
                ? helper.Partial(partialViewName)
                : helper.Partial(partialViewName, model);

            //Attribute encode the partial string - note that we have to .ToString() this to get back from an MvcHtmlString
            var partialStringAttributeEncoded = HttpUtility.HtmlAttributeEncode(partialString.ToString());

            //Turn this back into an MvcHtmlString
            var partialMvcStringAttributeEncoded = MvcHtmlString.Create(partialStringAttributeEncoded);

            return partialMvcStringAttributeEncoded;
        }
    }
} 
```

# c# - 将列表列表作为参数传递

> ID：12093007
> 
> 赞同：-2
> 
> 时间：2012-08-23T13:42:26.847
> 
> 标签：c#, arrays, string, list

我有一个字符串列表列表，我想将它传递给另一个方法。

我对列表有点困惑，我不知道如何处理它们。

```
public Form(string[] header, List<> data) 
```

List 是一种数据类型（或对象）吗？因为错误 VS2010 说它需要一个类型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T13:43:16.753

List<> - 是通用数据类型。您应该将列表项的类型放入括号中，在您的情况下，这是字符串列表 - `List<string>`。

```
public Form(string[] header, List<List<string>> data) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T13:50:44.083

您应该将`List<T>`其视为构建类型的模板。它实际上不是一种类型，即使它被称为泛型类型。

当你的程序运行时，它不能生成这种类型的对象。这就是令人困惑的地方。它们用于使用类型参数构建新类型。类型参数是您传递给泛型类型的类型。例如：

1.  `List<T>`- 泛型类型
2.  `T`部分 - 类型参数。T 可以是任何类型，例如`string`
3.  如果您使用泛型类型 (1)，并且某些类型作为类型参数 (2)，您将创建新类型：`List<string>`

您已经创建了新类型`List<string>`。对于每个类型参数，C# 编译器都会创建新类型。所以`List<string>`是完全不同的`List<int>`。

当然，它比引擎盖下的要复杂得多。类型实际上是由 .NET 框架在运行时创建的。这使您可以决定在应用程序运行时要创建哪些类型。但是，C# 编译器具有编译时类型检查，因此它也知道这个概念，并且不允许您简单地对泛型类型执行无效操作。

警告：模板已经是 C++ 中的现有概念，您不应将其与 C# 泛型混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T13:44:17.613

用这个：`List<List<string>> data`

# selenium - 运行硒代码时出错

> ID：12093014
> 
> 赞同：1
> 
> 时间：2012-08-23T13:42:56.490
> 
> 标签：selenium, amazon-ec2, amazon-web-services, binaryfiles, selenium-firefoxdriver

当我运行 selenium 脚本时，我遇到了这个问题：（我在 tomcat 中运行这段代码，这是我遇到异常的时候，但在普通的 eclipse 中这工作得很好）

```
**org.openqa.selenium.WebDriverException: org.openqa.selenium.WebDriverException: Failed to connect to binary FirefoxBinary(/opt/firefox/firefox-bin) on port 7055; process output follows:** 
Error: cannot open display: www.displayName.com:0.0
ï¿½
System info: os.name: 'Linux', os.arch: 'amd64', os.version: '3.2.21-1.32.6.amzn1.x86_64', java.version: '1.7.0_05'
Driver info: driver.version: firefox
System info: os.name: 'Linux', os.arch: 'amd64', os.version: '3.2.21-1.32.6.amzn1.x86_64', java.version: '1.7.0_05'
Driver info: driver.version: firefox
    at org.openqa.selenium.firefox.internal.ExtensionConnectionFactory.connectTo(ExtensionConnectionFactory.java:46)
    at org.openqa.selenium.firefox.FirefoxDriver.connectTo(FirefoxDriver.java:127)
    at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:117)
    at com.domain.myproject.server.MyServlet.doFilter(CrawlServlet.java:120)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at com.ensarm.wikirealty.server.service.CacheControllerFilter.doFilter(CacheControllerFilter.java:46)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:67)
    at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:122)
    at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:110)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.openqa.selenium.WebDriverException: Failed to connect to binary FirefoxBinary(/opt/firefox/firefox-bin) on port 7055; process output follows: 
Error: cannot open display: www.wikirealty.com:0.0
ï¿½
System info: os.name: 'Linux', os.arch: 'amd64', os.version: '3.2.21-1.32.6.amzn1.x86_64', java.version: '1.7.0_05'
Driver info: driver.version: firefox
    at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.connectToBrowser(NewProfileExtensionConnection.java:60)
    at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.<init>(NewProfileExtensionConnection.java:49)
    at org.openqa.selenium.firefox.internal.ExtensionConnectionFactory.connectTo(ExtensionConnectionFactory.java:44)
    ... 27 more
Caused by: org.openqa.selenium.firefox.NotConnectedException: Failed to start up socket within 45000
    at org.openqa.selenium.firefox.internal.AbstractExtensionConnection.connectToBrowser(AbstractExtensionConnection.java:143)
    at org.openqa.selenium.firefox.internal.NewProfileExtensionConnection.connectToBrowser(NewProfileExtensionConnection.java:58)
    ... 29 more 
```

请任何人都可以帮助我解决这个例外并为此提供解决方案

**编辑**

代码：

```
String url = "google.com";
WebDriver driver = new FirefoxDriver();
String str =""; 
driver.get(url); 
driver.wait(10000);
str = driver.getPageSource();
System.out.println(str); 
driver.close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T11:09:49.650

经过大量谷歌搜索并通过 Tarken 链接，最终解决方案是：

1.  在无头服务器上添加 xvfb
2.  在创建实例时将 xvfb 属性设置为 firefox 配置文件。
3.  正确组合你的罐子，请移除多余的罐子

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T11:03:23.417

如果您的实例是无头的，那就是问题所在。Firefox 需要一个窗口。

一些无头问题的链接：

*   [链接1](http://www.alittlemadness.com/2008/03/05/running-selenium-headless/)
*   [链接2](http://www.seleniumtests.com/2012/04/headless-tests-with-firefox-webdriver.html)

# css - 响应式 CSS 方法

> ID：12093016
> 
> 赞同：0
> 
> 时间：2012-08-23T13:42:57.863
> 
> 标签：css

下图是我想要得到的说明。第 1 个数字代表较长的宽度，第 2 个数字代表较短的宽度。所有红色块都停留在左右位置，黄色块应跟随容器的宽度。

[1](https://i.stack.imgur.com/dGIOe.jpg)：http: ![在此处输入图像描述](../Images/15b0a4c2c6bea3a70892d3e856d906ac.png) [//i.stack.imgur.com/6bHTo.jpg](https://i.stack.imgur.com/6bHTo.jpg)

这是我目前的方法

```
/* the one with black border :) */
.container{
    position: relative;
}
/* red blocks have auto heights depends on its content */
.red{
    position: absolute;
    top: 0;
    width: 100px;
}
.red-left{
    left:0;
}
.red-right{
    right:0;
}
/* yellow block follow the width of the container but should leave spaces for the left and right */
.yellow{
    margin: 0 110px;
} 
```

我几乎对这种方法感到满意，但是，我注意到当红色块高于容器时，容器不会自动跟随其内容的高度。我知道不可能自动调整容器高度，因为孩子们处于绝对位置。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:32:22.480

你考虑过使用 CSS3 Flex Box 吗？它会是这样的：

HTML：

```
<div class="container">
   <div class="red red-left">red-left<br>red-left<br>red-left<br>red-left<br>red-left</div>
   <div class="yellow">yellow<br>yellow</div>
   <div class="red red-right">red-right</div>
</div> 
```

和CSS：

```
.container{
  display: -webkit-box;
  -webkit-box-orient: horizontal;

  display: -moz-box;
  -moz-box-orient: horizontal;

  display: box;
  box-orient: horizontal;        
}

.red{
    background-color:red;  
    width:100px; 
}

.yellow{     
    background-color:yellow;
    -webkit-box-flex: 1;
    -moz-box-flex: 1;
    box-flex: 1;
} 
```

​​看看这个小提琴：

[http://jsfiddle.net/lucaslazaro/sjYNy/](http://jsfiddle.net/lucaslazaro/sjYNy/)

编辑：

要了解有关 Flex Box 的更多信息，我推荐此快速教程：[http ://www.html5rocks.com/pt/tutorials/flexbox/quick/](http://www.html5rocks.com/pt/tutorials/flexbox/quick/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:17:29.977

[我自己的演示，使其更容易。](http://jsfiddle.net/sGreB/)

我们在这里可以看到内容与容器重叠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T13:52:10.437

也许这有帮助：

**HTML**

```
<div class="container">
    <div class="red red-left">red-left<br>red-left<br>red-left</div>
    <div class="yellow">yellow<br>yellow</div>
    <div class="red red-right">red-right</div>
</div> 
```

​</p>

**​CSS**

 **```
/* the one with black border :) */
.container{
    position: relative;
}
/* red blocks have auto heights depends on its content */
.red{
    position: absolute;
    top: 0;
    width: 100px;
    background:red;
    height:auto
}
.red-left{
    left:0;
}
.red-right{
    right:0;
}
/* yellow block follow the width of the container but should leave spaces for the left and right */
.yellow{
    margin: 0 110px;
    background:yellow
} 
```

​</p>

​</p>

​​<strong> [DEMO](http://jsfiddle.net/F72HE/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-04T22:14:22.460

使用：

```
div {
    display: table;
    width: 100%;
    table-layout: fixed;
}

div > div {
    display: table-cell;
} 
```

查看完整代码：

[http://jsfiddle.net/BF6La/](http://jsfiddle.net/BF6La/)**

# gdcm - 以字符串形式检索 gdcm DataElement 值

> ID：12093022
> 
> 赞同：1
> 
> 时间：2012-08-23T13:43:12.870
> 
> 标签：gdcm

我基本上是在尝试使用 gdcm C++ 库从 DICOM 文件中读取所有或大部分属性值。我很难找出任何非字符串值。gdcm 示例通常假设我事先知道组/元素编号，因此我可以使用属性模板类，但我不需要或对它们感兴趣，我只需要报告所有属性名称和值。实际上这些值应该进入 XML，所以我需要一个字符串表示。我目前拥有的是这样的：

```
for (gdcm::DataSet::ConstIterator it = ds.Begin(); it!=ds.End(); ++it) {
    const gdcm::DataElement& elem = *it;
    if (elem.GetVR() != gdcm::VR::SQ) {
        const gdcm::Tag& tag = elem.GetTag();
        std::cout << dict.GetDictEntry(tag).GetKeyword() << ": ";
        std::cout << elem.GetValue() << "\n";
    }
} 
```

对于像 UL 这样的数值，输出似乎类似于“Loaded:4”，可能意味着库已经加载了 4 个字节的数据（一个无符号长整数）。这根本没有帮助，如何获得实际值？我肯定忽略了一些明显的东西。

从示例中，似乎有一个 gdcm::StringFilter 类可以做到这一点，但它似乎想在 DICOM 文件中单独搜索每个元素，这会使算法复杂度成为二次方，这当然是我想要的喜欢避免。

TIA 帕沃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T08:33:48.283

我最终将 gdcm::StringFilter::ToStringPair() 的部分提取到一个单独的函数中。似乎至少适用于更简单的 DCM 文件......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T17:17:07.717

你看过[gdcmdump](http://gdcm.sourceforge.net/html/gdcmdump.html)吗？您可以使用它将 DICOM 文件输出为文本或 XML。您还可以查看源代码以了解它是如何做到的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-31T12:25:25.907

您也可以先阅读常见问题解答，特别是[如何将属性值转换为字符串？](http://gdcm.sourceforge.net/wiki/index.php/Using_GDCM_API#How_do_I_convert_an_attribute_value_to_a_string_.3F)

正如那里所解释的，您只需要使用 gdcm:: [StringFilter](http://gdcm.sourceforge.net/html/classgdcm_1_1StringFilter.html)：

```
sf = gdcm.StringFilter()
sf.SetFile(r.GetFile())
print sf.ToStringPair(gdcm.Tag(0x0028,0x0010)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-15T11:19:20.160

尝试这样的事情：

> gdcm::Reader 阅读器；
> 
> reader.SetFileName(absSlicePath.c_str());
> 
> ```
> if( !_reader.Read() )
> {
>     return;
> } 
> 
> gdcm::File file = reader.GetFile();
> gdcm::DataSet ds = file.GetDataSet();
> std::stringstream strm;
> strm << ds; 
> ```

你会得到一个包含所有 DICOM 标签值的字符串流。实际上，大多数 DICOM 类（DataElement、DataSet 等）都重载了 std::ostream & operator<< (std::ostream &_os, const *Some_Class* &_val)。因此，您可以展开 for 循环并使用 operator<< 将值放入字符串流，然后放入字符串。

例如，如果您使用的是 QT ：

> ui->pTagsTxt->append(QString(strm.str().c_str()));

# jquery - 具有重试功能的 jquery .load() 函数

> ID：12093029
> 
> 赞同：1
> 
> 时间：2012-08-23T13:43:36.920
> 
> 标签：jquery, ajax

是否有一个 jquery 插件会尝试多次加载 url 直到成功？

我确实读过：[如果失败，如何让 jQuery 自动重试 load()？](https://stackoverflow.com/questions/6298854/how-to-make-jquery-automatically-retry-a-load-if-it-fails)

但我确信必须有一些更优雅的东西，也许是一个在尝试重试时显示 DIV 的插件等。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:04:25.683

```
function makeRequest() {    
    $('#container_id').load(url, "", callbackFunction(responseText, textStatus, XMLHttpRequest));    
}

function callbackFunction (responseText, textStatus, XMLHttpRequest) {
    if(textStatus == 'error') {
        // Yes, it failed
        $('#container_id').html('<p>Retrying...</p>');
        sleep(200);
        makeRequest();
    }
} 
```

# jquery - 带有输入的动态创建行上的日期选择器

> ID：12093030
> 
> 赞同：10
> 
> 时间：2012-08-23T13:43:38.687
> 
> 标签：jquery, forms, datepicker

我有一个表单，它可以使用输入动态创建新行，每个新行上的日期输入应该有一个日期选择器。我几乎可以正常工作，但是当创建带有输入的新行时，日期选择器将不再适用于已经存在的日期字段。我玩了一整天来找出我做错了什么，但我就是不知道如何解决这个问题。

这是小提琴-> [http://jsfiddle.net/HermesTrismegistus/vdFaH](http://jsfiddle.net/HermesTrismegistus/vdFaH)

我的表格如下所示：

```
<table id="productTable" class="table table-striped table-condensed">
     <thead>
        <tr>
         <th>Product</th>
         <th>Datum</th>
         <th>Tijd</th>
         <th>Minuten</th>
        </tr>
     </thead>
    <tbody>   
     <tr>
        <td><input id="products" class="input-medium" name="products[]" type="text" /></td>
        <td><input id="date" class="datepick input-mini" name="date[]" type="text" /></td>
        <td><input id="time" class="input-mini" name="time[]" type="text" /></td>
        <td><input id="minutes" class="input-mini" name="minutes[]" type="text" /></td>
        <td><a id="addnew" href=""><i class="icon-plus"></i></a></td>
      </tr>
    </tbody>
</table> 
```

我拥有的 jquery 看起来像这样：

```
 $(function(){
        // start a counter for new row IDs
        // by setting it to the number
        // of existing rows
        $('.datepick').datepicker();

        var newRowNum = 0;

        // bind a click event to the "Add" link
        $('#addnew').click(function(){
            // increment the counter
            newRowNum = $(productTable).children('tbody').children('tr').length +1;

            // get the entire "Add" row --
            // "this" refers to the clicked element
            // and "parent" moves the selection up
            // to the parent node in the DOM
            var addRow = $(this).parent().parent();

            // copy the entire row from the DOM
            // with "clone"
            var newRow = addRow.clone();

            // set the values of the inputs
            // in the "Add" row to empty strings
            $('input', addRow).val('');

            // insert a remove link in the last cell
            $('td:last-child', newRow).html('<a href="" class="remove"><i class="icon-minus"><\/i><\/a>');

            // insert the new row into the table
            // "before" the Add row
            addRow.before(newRow);

            // add the remove function to the new row
            $('a.remove', newRow).click(function(){
                $(this).closest('tr').remove();
                return false;               
            });

            $('#date', newRow).each(function(i){
                var newID = 'date_' + i;
                $(this).attr('id',newID);
            });

            // prevent the default click
            return false;
        }); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T14:53:17.073

试试这个，当您添加一行时，销毁所有日期选择器实例，然后在添加新行后重新绑定日期选择器。

**[jsFiddle 示例](http://jsfiddle.net/j08691/vdFaH/1/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-08T18:20:51.677

就我而言，我`clone()`用来创建 datepicker 的副本。

`$(".cloneDiv").clone().appendTo("#copyHolder");`

然后我删除 datepicker 添加到输入元素的“类”和“id”。

`$(".hasDatepicker").removeClass("hasDatepicker").removeAttr("id");`

注意：由于要克隆输入元素，因此我不给它们“id”属性。所以 datepicker 会自动将“id”添加到我的 DOM 元素中。此外，如果要克隆的元素具有用户分配的“id”，这意味着至少有两个元素共享相同的“id”，那么 datepicker 将很难找到正确的一个。可以在@j08691 的答案中找到一个示例。

最后，将 datepicker 重新绑定到输入元素：

`$(".inputDate").datepicker();`

所有具有“inputDate”类的输入元素都将具有日期选择器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-26T06:17:20.453

添加新行后，销毁日期选择器并再次创建。它将解决问题。

这是示例

```
jQuery( ".datepick" ).datepicker(); //Add date picker.

$('#addnew').click(function(){
   $(".datepick").datepicker("destroy"); //Distroy the date picker.

   /* Code to add a new row */

   jQuery( ".datepick" ).datepicker(); //recreating the date picker

}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-25T10:47:40.703

```
This is ur Answer I have done it......

 $(function(){
        // start a counter for new row IDs
        // by setting it to the number
        // of existing rows
        $('.datepick').datepicker();

        var newRowNum = 0;

        // bind a click event to the "Add" link
        $('#addnew').click(function(){
            // increment the counter
            newRowNum = $(productTable).children('tbody').children('tr').length +1;

            // get the entire "Add" row --
            // "this" refers to the clicked element
            // and "parent" moves the selection up
            // to the parent node in the DOM
            var addRow = $(this).parent().parent();

            // copy the entire row from the DOM
            // with "clone"
            var newRow = addRow.clone();

            // set the values of the inputs
            // in the "Add" row to empty strings
            $('input', addRow).val('');

            // insert a remove link in the last cell
            $('td:last-child', newRow).html('<a href="" class="remove"><i class="icon-minus"><\/i><\/a>');

            // insert the new row into the table
            // "before" the Add row
            addRow.before(newRow);

            // add the remove function to the new row
            $('a.remove', newRow).click(function(){
                $(this).closest('tr').remove();
                return false;               
            });

            $('#date', newRow).each(function(i){
              var newID = 'date_' + newRowNum;
           $(this).attr('id', newID).removeClass('hasDatepicker')
                  .removeData('datepicker')
                  .unbind()
                  .datepicker();
                 i++;
            });

            // prevent the default click
            return false;
        }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T14:46:45.570

Chrome 控制台中显示 javascript 错误：

```
Uncaught TypeError: Cannot read property 'inline' of undefined 
```

这可能正在关闭日期选择器功能。

# svn - 在使用 nas 驱动器作为文件存储库的 windows 上安装 subversion 的教程

> ID：12093035
> 
> 赞同：3
> 
> 时间：2012-08-23T13:43:50.103
> 
> 标签：svn, visualsvn, visualsvn-server, svn-server

我们都有 Windows 机器，但我们所有的文件都存储在 NAS 驱动器上，所以我们并没有真正的服务器，但想要使用某种版本控制。

谁能推荐一个要使用的版本控制软件和一个关于如何安装和使用它的简单教程，或者如果没有建议购买一本书，它将一步一步地告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T13:49:11.980

您可以使用[VisualSVN 服务器](http://www.visualsvn.com/server/)并将存储库存储在网络共享 (NAS) 上。

按照在[网络共享上存储存储库中](http://www.visualsvn.com/support/topic/00022/)提供的步骤设置 VisualSVN 服务器以将其存储库存储在共享上。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T13:52:45.813

对于stackoverflow来说有点离题，但我会咬一口。

我建议将 bitbucket ( [http://bitbucket.org](http://bitbucket.org) ) 与 mercurial 和 tortisehg ( [http://tortoisehg.bitbucket.io/](http://tortoisehg.bitbucket.io/) ) 一起使用。它不是 SVN，而是集中式 SCM 无论如何都会像恐龙一样走。

Bitbucket 对最多 5 个并发用户免费，并允许无限的免费私人存储库。

入门指南：

[http://tortoisehg.bitbucket.io/manual/2.9/quick.html](http://tortoisehg.bitbucket.io/manual/2.9/quick.html)

我们正在为我们的大型 ASP.net 项目使用 bitbucket / tortisehg，并且到目前为止很喜欢它。它与我们的错误跟踪系统 (jira) 紧密集成

# android - 在android中以固定间隔重复执行任务应该使用什么？

> ID：12093040
> 
> 赞同：0
> 
> 时间：2012-08-23T13:43:59.553
> 
> 标签：android, timer, handler

在我的 android 应用程序中，场景是这样的 -

我有几张图片存储在 SD 卡中。现在在我的应用程序中，我有一个图像视图，我必须像幻灯片放映一样不断更新这个图像视图。这必须通过从 SD 卡中一张一张地获取图像并将它们设置在同一个 ImageView 中来完成。ImageView 中图像变化的间隔也是固定的。所以我有一个游标来存储获取这些图像的信息。现在我想知道我应该用什么方法来逐个移动光标并从 SD 卡中获取图像并将它们设置在我的 ImageView 中。

我应该使用 Timer Task 和 Timer 还是应该使用 Handler 或其他东西？

请帮忙，因为这是我的应用程序的起点，我想从正确的方向开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:19:43.713

由于您要从 SD 卡中检索大量数据，因此最好使用线程来检索/解码位图。

在这种情况下，Timer 会很有用，因为它在自己的 Java 线程上运行预定的时间段。但是，您必须记住，您不能从非 UI 线程更新 UI 元素。因此，当位图完全加载时，您需要一个同步元素，以最终将解码的位图放入 ImageView。在这种情况下，您无论如何都需要使用 Handler 将消息队列发送到 UI 线程。

因此，我可能会推荐使用 Handler 和 AsyncTask 的组合。创建一个 AsyncTask 类，用于检索和解码`doInBackground()`. 更新`ImageView`in `onPostExecute()`。使用 Handler 每第 N 毫秒（无论何时更新视图）创建和执行一个新的 AsyncTask。

这样做的一个优点是它将所有图像检索保留在一个类中。您可以打开、检索、关闭光标。这比保持长时间运行的游标打开更安全。

# google-app-engine - 当我添加一个新的 servlet 时，我所有的 servlet 都找不到了

> ID：12093042
> 
> 赞同：-1
> 
> 时间：2012-08-23T13:44:06.800
> 
> 标签：google-app-engine, servlets

我所做的就是向 web.xml 添加一个新的 servlet，如下所示：

```
<servelt>
  <servlet-name>NewService</servlet-name>
  <servlet-class>app.server.NewServiceImpl</servlet-class>
</servelt>

<servlet-mapping>
  <servlet-name>NewService</servlet-name>
  <url-pattern>/MyApp/NewService</url-pattern>
</servlet-mapping> 
```

但是，当我添加这些行并尝试运行我的应用程序时，我的其他 servlet 之一出现服务不可用错误。我确定课程路径是正确的，并且课程正在被遵守。我还在 web.xml 的 web-app 标记之间添加了这些。有谁知道为什么添加这个 servlet 会破坏我的应用程序？

* * *

**编辑：**

当我在计算机上启动我的应用程序时，出现此错误：

> ```
> WARNING: Failed startup of context com.google.appengine.tools.development.DevAppEngineWebAppContext@6a360482{/,C:\Users\Admin\MyApp\war}
> java.lang.IllegalStateException: No such servlet: NewService
>     at org.mortbay.jetty.servlet.ServletHandler.updateMappings(ServletHandler.java:1026)
>     at org.mortbay.jetty.servlet.ServletHandler.setServletMappings(ServletHandler.java:1110)
>     at org.mortbay.jetty.webapp.WebXmlConfiguration.initialize(WebXmlConfiguration.java:306)
>     at org.mortbay.jetty.webapp.WebXmlConfiguration.configure(WebXmlConfiguration.java:222)
>     at org.mortbay.jetty.webapp.WebXmlConfiguration.configureWebApp(WebXmlConfiguration.java:180)
>     at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1247)
>     at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
>     at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
>     at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
>     at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
>     at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
>     at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
>     at org.mortbay.jetty.Server.doStart(Server.java:224)
>     at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
>     at com.google.appengine.tools.development.JettyContainerService.startContainer(JettyContainerService.java:197)
>     at com.google.appengine.tools.development.AbstractContainerService.startup(AbstractContainerService.java:241)
>     at com.google.appengine.tools.development.DevAppServerImpl.start(DevAppServerImpl.java:148)
>     at com.google.appengine.tools.development.gwt.AppEngineLauncher.start(AppEngineLauncher.java:97)
>     at com.google.gwt.dev.DevMode.doStartUpServer(DevMode.java:509)
>     at com.google.gwt.dev.DevModeBase.startUp(DevModeBase.java:1068)
>     at com.google.gwt.dev.DevModeBase.run(DevModeBase.java:811)
>     at com.google.gwt.dev.DevMode.main(DevMode.java:311) 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:51:26.883

在我看来，通过指定一个 servlet 映射，您将搁置其余部分。我认为你的 web.xml 应该是这样的：

```
 ... etc ...
    <servlet>
            <servlet-name>Servlet1</servlet-name>
            <servlet-class>com.Servlet1</servlet-class>
    </servlet>
    <servlet-mapping>
            <servlet-name>Servlet1</servlet-name>
            <url-pattern>/url1</url-pattern>
    </servlet-mapping>

    <servlet>
            <servlet-name>Servlet2</servlet-name>
            <servlet-class>com.Servlet2</servlet-class>
    </servlet>
    <servlet-mapping>
            <servlet-name>Servlet2</servlet-name>
            <url-pattern>/url2</url-pattern>
    </servlet-mapping>
    ... etc ... 
```

您还有多少其他 servlet，哪些失败了？例如，只有一个在新的之前，只有一个之后，所有之前，所有之后，还是没有那么明显？

**编辑：**

查看您的错误消息，很明显运行时遇到了您的新 servlet 的问题。我想我看到了问题。

您发布了：

```
<servelt>
  <servlet-name>NewService</servlet-name>
  <servlet-class>app.server.NewServiceImpl</servlet-class>
</servelt> 
```

更改`servelt`并`servlet`查看是否有帮助。

# java - 计算我的 Android 应用打开了多少次

> ID：12093048
> 
> 赞同：6
> 
> 时间：2012-08-23T13:44:25.217
> 
> 标签：java, android

我正在开发一个 android 应用程序，我想知道它被打开了多少次。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-06T15:02:13.970

`onCreate`在 an中使用的问题`Activity`是，即使方向发生变化，这也会增加计数器。使用`onCreate`in an`Application`也有一个缺点，即您的计数器只会在 VM 关闭后才会增加 - 所以即使应用程序退出并重新打开，它也不一定会增加。

事实是没有万无一失的方法来处理这种计数，但是我想出了一个非常好的方法，它尽可能接近 100% 准确。它需要在一个`Application`类和你的主`Activity`类中工作，并且依赖于时间戳来区分方向变化和实际的应用程序启动。首先，添加以下`Application`类：

```
/**
 * Application class used for correctly counting the number of times an app has been opened.
 * @author Phil Brown
 * @see <a href="http://stackoverflow.com/a/22228198/763080">Stack Overflow</a>
 *
 */
public class CounterApplication extends Application
{
    private long lastConfigChange;

    /** @param buffer the number of milliseconds required after an orientation change to still be considered the same event*/
    public boolean wasLastConfigChangeRecent(int buffer)
    {
        return (new Date().getTime() - lastConfigChange <= buffer);
    }

    @Override
    public void onCreate()
    {
        lastConfigChange = new Date().getTime();
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig)
    {
        super.onConfigurationChanged(newConfig);
        lastConfigChange = new Date().getTime();
    }
} 
```

您应该`AndroidManifest.xml`通过指定 name 应用程序属性将此应用程序添加到您的应用程序中：

```
android:name="path.to.CounterApplication" 
```

现在，在您的 main`Activity`中，添加以下内容`onCreate`：

```
//note that you can use getPreferences(MODE_PRIVATE), but this is easier to use from Fragments.
SharedPreferences prefs = getSharedPreferences(getPackageName(), MODE_PRIVATE);

int appOpenedCount = prefs.getInt("app_opened_count", 1);
if (!((CounterApplication) getApplication()).wasLastConfigChangeRecent(10000))//within 10 seconds - a huge buffer
{
    appOpenedCount += 1;
    prefs.edit().putInt("app_opened_count", appOpenedCount).commit();
}

//now say you want to do something every 10th time they open the app:
boolean shouldDoThing = (appOpenedCount % 10 == 0);
if (shouldDoThing)
{
    doThing();
    appOpenedCount += 1;
    //this ensures that the thing does not happen again on an orientation change.
    prefs.edit().putInt("app_opened_count", appOpenedCount).commit();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-30T09:17:38.403

只是，声明：

```
 private SharedPreferences prefs;
    private SharedPreferences.Editor editor;
    private int totalCount; 
```

在 onCreate(...) 中初始化：

```
 prefs = getPreferences(Context.MODE_PRIVATE);
    editor = prefs.edit(); 
```

随心所欲地打印或计数（onCreate 中的任何位置或您指定的任何特定点击）

```
 totalCount = prefs.getInt("counter", 0);
     totalCount++;
     editor.putInt("counter", totalCount);
     editor.commit(); 
```

现在打印要计算的总计数，例如：

```
 System.out.println("Total Application counter Reach to :"+totalCount); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-23T13:46:31.820

在您的应用程序或活动的方法中，递增存储在[持久存储](http://developer.android.com/guide/topics/data/data-storage.html)`onCreate()`中的计数器，例如.`SharedPreferences`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-23T13:49:13.300

您可以使用共享首选项。每次打开应用程序时，检索首选项，增加计数，然后立即存储。唯一的问题是，如果用户删除了应用程序以及所有偏好，那么计数也将被删除。这是一个承诺偏好的示例。用于`getPreferences`在应用程序启动时检索它们。

```
SharedPreferences prefs=getPreferences(Context.MODE_PRIVATE);
SharedPreferences.Editor editor=prefs.edit();
editor.putString("pref 1", "some text");

editor.commit(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T13:47:01.427

单程：

将属性保持`preferences`在启动`activity`更新首选项计数为“1”，但您可能无法看到此增加的值，因为它保留在手机上。

另一种方式

向您的服务器调用服务（如果有）以增加访问次数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-23T13:51:34.483

**1.**对于一个简单的方法，`text file`在读取值后保留一个将值增加 1 的位置。保持`OnCreate()`Activity 方法的计数增量

**2.**你可以使用`SharedPreference`.

**3.** Well`DataBase`也可以用……不过我觉得这个**太杀**了……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-07T05:41:50.840

```
 Using SharedPreference or the Database.

during OnCreate add 1 to the numberofTimes counter and commit.

OnCreate (Bundle bundle){
  mPref = getPreferences();
  int c = mPref.getInt("numRun",0);
  c++;
  mPref.edit().putInt("numRun",c).commit();
  //do other stuff...
}

OnCreate is called regardless of you start the app or you resume the app, but isFinishing() returns true if and only iff the user (or you) called finish() on the app (and it was not being destroyed by the manager)

This way you only increment when you are doing fresh start.

the onFinishing() Method inside of a OnPause method to check to see if the activity is being finish() or just being paused.

@Override
protected void OnPause(){
  if(!onFinishing()){
    c = mPref.getInt("numRun",0);
    c--;
    mPref.edit().putInt("numRun",c).commit();
  }
  //Other pause stuff.
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-18T21:59:25.487

正如我在[另一个答案](https://stackoverflow.com/a/24296921/2528167)中所说，我认为以下是最好的解决方案：

```
private static boolean valueOfLaunchCountModified = false;

@Override
protected void onCreate(Bundle savedInstanceState) {

    if(!valueOfCountModified){
        preferences = getPreferences(MODE_PRIVATE);
        launchCount= preferences.getInt("launchCount", 0);
        if(preferences.edit().putInt("launchCount", ++launchCount).commit()){
            valueOfCountModified = true;
        }
    }

    if(launchCount == 5 && valueOfCountModified){
        //Do whatever you want
    }
} 
```

如果我们记得[静态变量的定义](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)，我们会发现它对我们来说是完美的：

> 它们与类相关联，而不是与任何对象相关联。类的每个实例共享一个类变量。

当`onPause`执行方法或方向更改时， 的值`valueOfLaunchCountModified`不会改变；但是，如果应用程序进程被破坏，则该值`valueOfLaunchCountModified`将更改为 false。

* * *

# php - 在php中编码包括连字符（-）和点（。）的url

> ID：12093050
> 
> 赞同：17
> 
> 时间：2012-08-23T13:44:26.527
> 
> 标签：php, urlencode, encode

我需要在其中一个 API 中处理的编码 URL，但它需要完整的编码 URL。例如，来自的 URL：

```
http://test.site-raj.co/999999?lpp=1&px2=IjN 
```

必须成为编码的 URL，例如：

```
http%3a%2f%test%site%2draj%2eco%2f999999%3flpp%3d1%26px2%3dIjN 
```

我需要对每个符号进行编码，甚至像上面的点（。）和连字符（-）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-23T13:51:46.080

尝试这个。如果您不止一次使用它，则可能在函数内部...

```
$str = 'http://test.site.co/999999?lpp=1&p---x2=IjN';
$str = urlencode($str);
$str = str_replace('.', '%2E', $str);
$str = str_replace('-', '%2D', $str);
echo $str; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-23T14:02:39.733

这将对所有不是纯字母或数字的字符进行编码。您仍然可以使用标准 urldecode 或 rawurldecode 对其进行解码：

```
function urlencodeall($x) {
    $out = '';
    for ($i = 0; isset($x[$i]); $i++) {
        $c = $x[$i];
        if (!ctype_alnum($c)) $c = '%' . sprintf('%02X', ord($c));
        $out .= $c;
    }
    return $out;
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-02-11T14:10:38.740

你为什么不使用 rawurlencode

例如`rawurlencode("http://test.site-raj.co/999999?lpp=1&px2=IjN")`

# php - 完整文件传输后的PHP执行函数

> ID：12093051
> 
> 赞同：1
> 
> 时间：2012-08-23T13:44:35.443
> 
> 标签：php, file, buffer

我正在编写一个下载计数器，我想知道在服务器完全发送缓冲区（这里是使用 readfile 发送的文件）并被客户端接收后是否可以执行代码。请注意，我不能使用任何客户端语言，因为我直接传输文件（不使用 XHR 或/和 FileSystem javascript API）。

它以任何方式可行吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:33:00.833

> 可以在服务器完全发送缓冲区（这里是使用 readfile 发送的文件）后执行代码

是的....

```
<?php
readfile($_GET['i_am_so_vuln']);
print "whoops!"; 
```

……有那么难吗？

> 并被客户收到

不——因为你不这样做。它可以在中间网络上的多个点进行缓冲。（甚至缓存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:12:47.327

如果它是用户正在下载的文件，我认为你什么都做不了`echo`。我刚测试过。提示该文件，它完成并且没有任何内容打印到浏览器。请务必注意，这可能取决于浏览器。

但是，如果您尝试将记录插入/更新到数据库或保存日志文件，它会起作用。

所以，我想说，你可以，你不能。

# c++ - 并发可变优先级队列

> ID：12093053
> 
> 赞同：13
> 
> 时间：2012-08-23T13:44:37.887
> 
> 标签：c++, algorithm, data-structures, concurrency, priority-queue

是否有并发的可变优先级队列？理想情况下，我正在寻找 C++ 实现，但对于初学者来说，指向算法的指针会非常有帮助。

需要明确的是，我正在寻找一个可以调整元素优先级的优先级队列。特别是，TBB`concurrent_priority_queue`不提供必要的功能。（就此而言，STL 也没有`priority_queue`，即使我们忽略了并发性。）[Boost.Heap](http://www.boost.org/doc/libs/1_51_0/doc/html/heap.html)库提供了我想要的串行功能，但没有并发性。自然，我正在寻找比在每个操作上锁定整个队列更细粒度的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T18:58:06.230

A concurrent priority queue is often implemented using a skiplist, so Facebook's [ConcurrentSkipList](https://github.com/facebook/folly/blob/master/folly/ConcurrentSkipList.h) may fit your requirements.

# android - Android 4.0.3 创建wifi热点API

> ID：12093054
> 
> 赞同：1
> 
> 时间：2012-08-23T13:44:38.417
> 
> 标签：android

您好我正在尝试从我的应用程序创建一个接入点。我可以站起来 AP，但不能使用我设置的配置。我正在使用 HTC Sensation XE

```
WifiManager wifiManager = (WifiManager) rc.getSystemService(Context.WIFI_SERVICE);

if(wifiManager.isWifiEnabled())
{
    wifiManager.setWifiEnabled(false); 
}
Method[] wmMethods = wifiManager.getClass().getDeclaredMethods();
boolean methodFound=false;

WifiConfiguration netConfig = new WifiConfiguration();

netConfig.SSID = "MyWifiAP";
netConfig.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN);
netConfig.allowedProtocols.set(WifiConfiguration.Protocol.RSN);
netConfig.allowedProtocols.set(WifiConfiguration.Protocol.WPA);
netConfig.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
for(Method method: wmMethods){
if(method.getName().equals("setWifiApEnabled")){                   
  methodFound=true;
  try {
  boolean apstatus=(Boolean) method.invoke(wifiManager, netConfig,true);
  for (Method isWifiApEnabledmethod: wmMethods){
        if(isWifiApEnabledmethod.getName().equals("isWifiApEnabled")){
           while(!(Boolean)isWifiApEnabledmethod.invoke(wifiManager)){
           };
           for(Method method1: wmMethods){
              if(method1.getName().equals("getWifiApState")){
                int apstate;
                apstate=(Integer)method1.invoke(wifiManager);
                for(Method method2: wmMethods){
                   if(method2.getName().equals("getWifiApConfiguration")){
                      try {
                         netConfig=(WifiConfiguration)method2.invoke(wifiManager);
                      } catch (IllegalArgumentException e) {
                          // TODO Auto-generated catch block
                          e.printStackTrace();
                      } catch (IllegalAccessException e) {
                          // TODO Auto-generated catch block
                          e.printStackTrace();
                      } catch (InvocationTargetException e) {
                          // TODO Auto-generated catch block
                          e.printStackTrace();
                      }
                      Log.e("CLIENT", "\nSSID:"+netConfig.SSID+"\nPassword:"+netConfig.preSharedKey+"\n");                                          

                      if (apstate==0) {
                          Log.d("basura", "apstate es: "+apstate);
                      }
                   }
                }   
              }   
           }   
        } catch (IllegalArgumentException e) {
           e.printStackTrace();
        } catch (IllegalAccessException e) {
           e.printStackTrace();
        } catch (InvocationTargetException e) {
           e.printStackTrace();
        }
    }      
} 
```

当我打印时：

Log.e("CLIENT", "\nSSID:"+netConfig.SSID+"\nPassword:"+netConfig.preSharedKey+"\n");

我得到：

nSSID：空 nPassword：空

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T10:34:31.637

我的 HTC Desire 和 Android 2.2.2 也有同样的问题。似乎很多（或所有）HTC 设备都无法以这种方式进行配置。HTC 可能重写了一些代码并限制了一些隐藏的功能。您正在使用通过反射在 API（例如 setWifiApEnabled）中未正式使用的方法。在我的情况下，将创建热点，但使用默认配置。可能你有同样的问题。它适用于其他一些设备

# mysql - 检索每个组中最后过滤的记录

> ID：12093055
> 
> 赞同：1
> 
> 时间：2012-08-23T13:44:39.610
> 
> 标签：mysql, sql, group-by, greatest-n-per-group

我不久前读到了@Bill Karwin 的出色回答：

[https://stackoverflow.com/a/1313293/317889](https://stackoverflow.com/a/1313293/317889)

这几乎回答了这个问题，但是，我最近不得不更新我的查询以过滤连接表的状态。

我在下面写了两个查询，类似于上面帖子中的查询。第一个查询是慢查询与连接表状态过滤一起使用：

```
SELECT m.*, t1.* FROM mood m 
LEFT JOIN temper t ON ( m._id = t.mood_id ) 
WHERE grantee_username = "username" 
AND m.status_id != 1 // NOT INTERESTED IN THIS FILTER
AND t.status_id != 1 // FILTERING 
GROUP BY m._id; 
```

对于第二个查询，我不知道如何添加过滤以使其按上述方式工作：

```
SELECT m.*, t1.* FROM mood m 
LEFT JOIN temper t1 ON ( m._id = t1.mood_id ) 
LEFT JOIN temper t2 ON ( t1.mood_id = t2.mood_id AND t1._id < t2._id ) 
WHERE t2._id IS NULL 
AND m.grantee_username = "username" 
AND m.status_id != 1; // NOT INTERESTED IN THIS FILTER 
```

第一个查询完美运行，但被认为比第二个查询慢。

第二个查询用于恢复所有情绪记录及其相关的上次脾气记录，但是上次脾气记录可能具有我不想要的状态 1。

任何见解都会很有趣。我总是可以只使用第一个查询，但为了性能起见，我想弄清楚`t.status_id`如果可能的话如何将过滤添加到第二个查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:08:00.840

我认为您的第二个查询最后缺少 GROUP BY。

此版本在子查询中添加过滤器：

```
SELECT m.*, t1.*
FROM mood m  LEFT JOIN
     (select t.*
      from temper t
      where t.status_id != 1
     ) t1
     ON m._id = t1.mood_id  LEFT JOIN
     temper t2
     ON t1.mood_id = t2.mood_id AND t1._id < t2._id
WHERE t2._id IS NULL AND
      m.grantee_username = "username" 
GROUP BY m._id; 
```

您还想要 t2 上的过滤器吗？

顺便说一句，您在 MySQl 中使用了一个名为 Hidden Columns 的功能——您在一个列上进行聚合，但在其他列上返回没有聚合函数的行。此功能仅在 MySQL 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T17:29:44.260

好吧，事实证明这毕竟不是太难：

```
SELECT m.*, t1.* FROM mood m 
LEFT JOIN temper t1 ON ( m._id = t1.mood_id AND t1.status_id !=1) 
LEFT JOIN temper t2 ON ( t1.mood_id = t2.mood_id AND t1._id < t2._id AND t2.status_id !=1 ) 
WHERE t2._id IS NULL 
AND m.grantee_username = "username" 
AND m.status_id != 1; // NOT INTERESTED IN THIS FILTER 
```

过滤器 (status_id) 需要添加到每个 JOIN。

# arduino - Telnet 服务器启用客户端线路模式

> ID：12093057
> 
> 赞同：4
> 
> 时间：2012-08-23T13:44:41.153
> 
> 标签：arduino, telnet

我正在 Arduino 上编写一个小的 Telnet 客户端。使用以下代码停用 Telnet 客户端线路模式后，如何重新激活它？

```
 client.write(255); // IAC
  client.write(251); // WILL
  client.write(1);   // ECHO

  client.write(255); // IAC
  client.write(251); // WILL
  client.write(3);   // suppress go ahead

  client.write(255); // IAC
  client.write(252); // WONT
  client.write(34);  // LINEMODE 
```

用于输入密码。

我尝试了反向命令，但它们不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T01:27:47.910

使用 BSD telnet 客户端，使用以下命令：

```
set debug
set prettydump
set options
set netdata 
```

然后，可以使用命令切换一次字符模式和一次一行模式，

```
mode line
mode character 
```

接下来的协商可以被检查和复制。

但是，只发送 IAC DONT ECHO、密码、CR NUL 和 IAC DO ECHO 就足够了。使用“WILL ECHO，WILL SGA”进入“一次一个字符”模式称为“kludge 模式”——重新启用 ECHO 应默认为标准 NVT 行为（线路模式）。

但是，bsd 客户端具有完整的扩展线模式支持。这不是微不足道的，将近 50% 的代码库（forwardmask、slc、回调等）。

如果服务器回复 WONT LINEMODE，那么它实际上仍处于默认 NVT 线路模式——它只是不在增强线路模式或不关心协商它。这就是为什么发送 DO LINEMODE 实际上是一个糟糕的主意，因为您需要从后来的 rfc 中确认 linemode 的子协商协议。

回复 DO LINEMODE 的服务器可能会继续请求 linemode 子协商，例如 IAC SB LINEMODE MODE <1 byte bitmask> 和 IAC SB LINEMODE FORWARDMASK 。使用 WONT FORWARDMASK 拒绝此响应。MODE 必须设置 ACK 位并以类似方式回复。

# c# - Active Directory 中组的所有权，

> ID：12093069
> 
> 赞同：1
> 
> 时间：2012-08-23T13:45:22.433
> 
> 标签：c#, asp.net-mvc-3, active-directory

Web 应用程序 MVC3 C#。

我`System.DirectoryServices.AccountManagement`用来管理 Active Directory。

有谁知道我可以看到群主的方式吗？`managedBy`财产？

我正在寻找小组

```
var group = GroupPrincipal.FindByIdentity(directory, IdentityType.SamAccountName, groupName); 
```

但我看不到寻找集团所有权的方法。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:01:01.083

如果您需要的属性在 上不可用`GroupPrincipal`，则新`S.DS.AM`方法具有很好的可扩展性。

[在这里阅读更多关于它的信息](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx#S10)- 你基本上可以扩展`GroupPrincipal`并且在那个扩展类中，你可以“向下”进入底层`DirectoryEntry`并获取没有进入`GroupPrincipal`.

另外[查看这篇 CodeProject 文章]（如何使用未在 UserPrincipal、GroupPrincipal 和 ComputerPrincipal 中表示的 AD 属性）了解如何扩展`S.DS.AM`（与 一起显示`UserPrincipal`但工作方式相同`GroupPrincipal`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T14:05:44.873

确实，在`GroupPrincipal`.

快速而肮脏的解决方案是：

```
var group = GroupPrincipal.FindByIdentity(directory, IdentityType.SamAccountName, groupName));
DirectoryEntry obj =(DirectoryEntry)group.GetUnderlyingObject();
var owner = obj.Properties["managedBy"]; 
```

非常感谢！

# ant - 如何使用 ant-contrib 编写条件逻辑

> ID：12093071
> 
> 赞同：1
> 
> 时间：2012-08-23T13:45:24.180
> 
> 标签：ant, if-statement, depends

我是ANT的初学者。

我究竟做错了什么？ant-contrib-1.0b3 ，可用。我想按如下方式调用默认目标：

```
<target name="build">
<if>
 <equals arg1="${config.name}" arg2="foo" />
 <then>
   <depends="get-all-war,..." />
 </then>
 <elseif>
 <equals arg1="${config.name}" arg2="mark" />
 <then>
   <depends="zip-wars, ..." />
 </then>
 </elseif>
 <else>
    <depends="get-all-war, zip-wars, docs, deleteAll" />
 </else>
</if> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:44:25.540

您需要使用[antcall](http://ant.apache.org/manual/Tasks/antcall.html)来执行其他目标。

```
<target name="build">
<if>
 <equals arg1="${config.name}" arg2="foo" />
 <then>
   <antcall target="get-all-war" />
   <antcall target="..." />
 </then>
 <elseif>
 <equals arg1="${config.name}" arg2="mark" />
 <then>
   <antcall target="zip-wars" />
   <antcall target="..." />
 </then>
 </elseif>
 <else>
   <antcall target="get-all-war" />
   <antcall target="zip-wars" />
   <antcall target="docs" />
   <antcall target="deleteAll" />
 </else>
</if> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T10:14:45.587

您可以使用宏巧妙地做同样的事情。如果您的目标 get-all-war、zip-wars、docs、deleteAll 需要更多时间，您可以像这样并行运行它们：

```
<target name="build">
  <if>
  <equals arg1="${config.name}" arg2="foo" />
  <then>
    <mGetAllWar/>
  </then>
  <elseif>
  <equals arg1="${config.name}" arg2="mark" />
  <then>
    <mZipWars />
  </then>
  </elseif>
  <else>
    <mRestAllTargets/>
  </else>
</if>

<mGetAllWar>
  <parallel>
    <antcall name="target1">
    <antcall name="target2">
    ... 
  </parallel>
</mGetAllWar>

<mZipWars >
  <parallel>
    <antcall name="target1">
    <antcall name="target2">
    ... 
  </parallel>
</mZipWars >

<mRestAllTargets>
  <parallel>
    <antcall name="target1">
    <antcall name="target2">
    ... 
  </parallel>
</mRestAllTargets> 
```

# java - 在我的 Play 应用程序中使用 Ebean/JPA，如何删除 OneToOne 关系中的对象？

> ID：12093073
> 
> 赞同：2
> 
> 时间：2012-08-23T13:45:28.873
> 
> 标签：java, jpa-2.0, playframework-2.0, cascade, ebean

我有以下课程：

```
import play.db.ebean.Model;
import javax.persistence.*;

@Entity
public class A extends Model {
    @Id
    private int id;

    /* Other irrelevant properties */

    @OneToOne(cascade = CascadeType.ALL, optional = true)
    private B b;
} 
```

* * *

```
import play.db.ebean.Model;
import javax.persistence.*;

@Entity
public class B extends Model {
    @Id
    private int id;

    /* Other irrelevant properties */

    @OneToOne(mappedBy = "b")
    private A a;

    @OneToOne(cascade = CascadeType.ALL, optional = false)
    private C c;
} 
```

* * *

```
import play.db.ebean.Model;
import javax.persistence.*;

@Entity
public class C extends Model {
    @Id
    private int id;

    /* Other irrelevant properties */

    @OneToOne(mappedBy = "c")
    private B B;
} 
```

在数据库中，它看起来像这样：

```
Table    a
Columns  id, ... (other irrelevant columns), b_id

Table    b
Columns  id, ...(other irrelevant columns), c_id

Table    c
Columns  id, ...(other irrelevant columns) 
```

现在在一个控制器方法中（对于那些熟悉 Play 的人）我有一个对象 A，并且想从数据库中删除它的属性“b”。这也应该级联到 c，因此 c 也被删除。这是我目前的做法：

```
B b = a.getB();
b.delete(); 
```

但是，这会引发异常：

> [PersistenceException: ERROR execution DML bindLog[] error[Cannot delete or update a parent row: a foreign key constraint failed ( `databasename`. `a`, CONSTRAINT `fk_a_payme_4`FOREIGN KEY ( `b_id`) REFERENCES `b`( `id`))]]

它基本上归结为我试图删除 b 的事实，而 a 在 b_id 列中仍然持有对 b 的外键引用，所以我应该首先将该引用设置为 null。

在 Java 中，这转换为：

```
B b = a.getB();
a.setB(null);
a.update();
b.delete(); 
```

这确实将对象 a 中对 b 的引用设置为 null 并正确删除 b 对象，但 c 不会从数据库中删除。（为什么？我虽然级联属性会处理这个问题）我发现解决这个问题的唯一方法是显式删除 c ，就像这样：

```
B b = a.getB();
C c = b.getC();

b.setC(null);
b.update();
c.delete();

a.setB(null);
a.update();
b.delete(); 
```

不过我对此不是很满意，因为这已经是删除数据库中两行的 8 行代码了，如果这张图中有更多的关系会更多。

至于我的问题：

**如何从 a 中删除 b，以便首先自动删除从 a 到 b 的引用，以及如何确保在删除 b 时也删除 c？**

先感谢您！

编辑：迄今为止最好的想法：将ab关系的所有权移至b。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T13:57:51.303

尝试使用

```
class A{

   ......

   @JoinColumn(nullable=true)
   private B b;

   .......
} 
```

有关更多信息，请参阅此问题[@ManyToOne(optional=false) 与 @Column(nullable=false) 有什么区别](https://stackoverflow.com/questions/3331907/)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-23T10:39:14.387

我在@johny 的回答中遇到了一些问题。尝试这个。

```
@JoinColumn(name = "b_id", nullable = false) 
```

# php - 通过 AJAX 删除对象后重新加载内容页面

> ID：12093076
> 
> 赞同：0
> 
> 时间：2012-08-23T13:45:36.863
> 
> 标签：php, jquery, ajax, database, events

我有一个按钮，我希望它通过 AJAX 调用一个事件。此事件用于删除数据库记录，因此我希望在没有删除值/行的情况下更新内容。我想也许我应该把我的代码放在成功的 .ajax 调用中，但我怀疑如何刷新内容？我是否需要第二次 AJAX 调用来获取没有删除值/行的新内容？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:01:23.540

如果您使用的是ajax，那么为什么要刷新页面？我们使用 ajax 来避免页面刷新。如果你需要它，你可以尝试`window.location.reload();`在你的 ajax.success() 函数中添加函数。这是一个示例，以防它对您有用[http://www.amitpatil.me/ajax-table-adding-removing-rows-dynamically-using-javascript-animation/](http://www.amitpatil.me/ajax-table-adding-removing-rows-dynamically-using-javascript-animation/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T13:51:36.260

您可以在同一个通话中使用它。在`DELETE`ajax 调用指向的脚本中，只需添加查询并使用`json_encode()`. 然后，您只需更新页面的特定区域。

或者，如果您想偷懒，在从 ajax 成功返回后，只需执行以下操作：

`window.location.reload();`

这将刷新页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T13:51:55.573

如果您使用 AJAX 删除记录，则不需要重新加载所有页面内容（这是 AJAX 的目标）。在这种情况下，您必须通过移除 JavaScript DOM 元素来更改您的内容。

如果你用 AJAX 删除一些带有一些 id 的记录，你会执行如下操作：

```
$("#deleteBtn").click(function() {

    // detect ID of the record (var id = ...)
    // call AJAX with post(...) or ajax(...)

    $("#id" + id).remove();  

}); 
```

或者，如果您对 AJAX 结果执行**remove()**函数以提高安全性并仅在您的服务器端脚本确实已从数据库中删除记录时将其删除，则更好。

在我的示例中，假设您使用行（或其他 HTML 元素）的**id**属性来存储记录的 id，以便将来通过 $("#id" + id) 访问。您需要一些入口点来通过记录 id 找到您的 DOM 元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T13:53:17.327

在我看来，有谁可以做到这一点。

1：使用数据库行中的唯一 ID 将您的行包装在一个容器中，然后使用该 ID 删除/隐藏您刚刚从页面中删除的行。

2：正如您所提到的，您可以再次获取数据并打印它，但这在性能方面不会非常有效。

/问候

# c# - 这是一个 if else 语句吗

> ID：12093081
> 
> 赞同：6
> 
> 时间：2012-08-23T13:45:49.703
> 
> 标签：c#, if-statement

> **可能重复：**
> [在 C# 中，两个问号一起意味着什么？](https://stackoverflow.com/questions/446835/what-do-two-question-marks-together-mean-in-c)

我刚刚遇到下面的代码，并不确定它的含义并且无法谷歌搜索，因为谷歌省略了`??`

```
int? x = 32;
int  y = x ?? 5; 
```

第二行是某种 if else 语句，是什么`??`意思

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T13:46:35.820

它被称为[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)。

如果左侧的`??`值为`null`，则使用右侧的值， `??`否则使用左侧的值。

展开：

```
y = x == null ? 5 : x 
```

或者

```
if(x == null)
     y = 5
else
     y = x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T13:48:12.130

```
if(x == null)
     y = 5
else
     y = x 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T13:50:32.523

运算符与变量集合一起使用，`??`并计算第一个非空变量的值。例如，考虑以下代码：

```
int? x = null;
int? y = null;
int? z = null;

y = 12;
int? a = x ?? y ?? z; 
```

的值`a`将是 12，因为`y`它是语句中第一个具有非空值的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T13:51:08.347

是的，这是 if else 语句。看看这个 URL [http://www.webofideas.co.uk/Blog/c-sharp-double-question-mark-syntax.aspx](http://www.webofideas.co.uk/Blog/c-sharp-double-question-mark-syntax.aspx)

# php - 如何在不位于 HTML 标记中的字符串中查找最后一个空格（正则表达式 PHP）

> ID：12093084
> 
> 赞同：-3
> 
> 时间：2012-08-23T13:45:56.143
> 
> 标签：php, regex

我正在搜索正则表达式以查找文本中最后出现的空格，但我不想从 HTML 标记中查找空格。

```
"This is a string with <strong>some</strong> html in it" 
```

正则表达式应该找到的空间是 和 之间的`in`空间`it`。那个正则表达式并不难。相同的正则表达式也可以在这里工作：

```
"This is a string with <strong>some</strong> html in <a href="">the end</a>" 
```

空格现在将位于和之间的 HTML 中`the`（`end`好的！）

但是当我的字符串是：

```
"This is a string with <strong>some</strong> html in the <a href="">end</a>" 
```

那么空格应该在 and 之间`the`而`<a`不是`<a`and之间`href="">end<a>`。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T13:58:17.560

更新此答案，因为有关要求的更多信息曝光。

[strip_tags()](http://php.net/manual/en/function.strip-tags.php)、[strrpos()](http://www.php.net/manual/en/function.strrpos.php)、[substr()](http://www.php.net/manual/en/function.substr.php)函数的组合可以解决问题。首先使用 strip_tags() 函数清除 HTML。然后，您将留下文本并可以将其分解以找到最后一个单词，然后使用 strrpos() 查找该单词在原始文本中的位置。

```
$stringToken = explode( ' ', strip_tags( $str ) );
// Find the second-to-last word in the string.
$word = $stringToken[ count( $string ) - 2 ];

// Use $word to find its position within the original HTML-encoded string.
$wordPosition = strrpos( $str, $word );

if( $wordPosition !== false )
{
    $finalSpace = strpos( $str, ' ', $wordPosition );
    $lastSpacePrefix = substr( $str, 0, $finalSpace );
    $lastSpaceSuffix = substr( $str, $finalSpace + 1 );
    $newStr = sprintf( "%s%s%s", $lastSpacePrefix, $finalSpaceSub, $lastSpaceSuffix );
} 
```

# javascript - Node.js 正确的回调错误句柄

> ID：12093085
> 
> 赞同：1
> 
> 时间：2012-08-23T13:45:59.527
> 
> 标签：javascript, node.js, callback

让我们看一下下面的代码：

***mongodb.js***

```
var mongo = require('mongodb')
  , mongodb = module.exports;

mongodb.database = function(key, dbName, dbServer, callback){
  var db = new mongo.Db(dbName, dbServer);
  db.open(function(error, connection){ // 5
    if(error){ // 1
      throw error;
    }

    return callback(null, connection);
  });
};

mongodb.collection = function(dbKey, collName, callback){
  mongodb.database(dbKey, function(error, connection){
    connection.collection(collName, function(error, collection){ // 2
      if(error){ // 3
        throw error;
      }

      return callback(null, collection);
    });
  });
} 
```

***模型.js***

```
var db = require('./mongodb.js');
var model = module.exports;

model.test = function(callback){
  db.collection('users', function(error, collection){ // 4
    // do something.
  });
} 
```

我的问题是，为什么我们在传递回调时总是做“错误，资源”，因为，看看***1***

我们正在处理错误，所以它甚至不能达到***2* ***

与***3***和***4***相同，它们将始终为 NULL，因为错误是在不同的层上处理的。现在我为什么不在***5***这样做：

```
db.open(function(error, connection){
  if(error){ // 1
    return errorHandler(error);
  }

  return callback(collection);
}); 
```

errorHandler 函数将是一个处理重大错误的函数，因此我们不必在每一层都使用它们，例如 mongodb.findOne，为什么我们必须在传入回调时处理错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:58:56.463

我`callback(error,result)`主要在没有在任何地方抛出（或捕获）错误时使用该模式。即你不想仅仅因为缺少一些参数而停止你的应用程序。看下面的代码：

```
function somethingAsync (options, callback) {
  if (!options || !options.name) {
    callback('no name specified'); //we dont want to kill the Application
    return;
  };
  doSomeThingInternal(callback);
}; 
```

在消费者方面，您可以从任何内部函数将错误打印到客户端。

```
somethingAsync(null, function (err,res)) {
  if(err) {
    console.log('error occured: ' + err);
  };
}; 
```

# c# - 搜索所有组合

> ID：12093086
> 
> 赞同：1
> 
> 时间：2012-08-23T13:46:01.713
> 
> 标签：c#, regex

选择的水果 =`"banana,banana,cherry,kiwi,strawberry"`

```
lookup List<string>

"banana,strawberry" (true)
"strawberry" (true)
"banana,banana,banana" (false) 
```

如果查找中仅与所选项目的一部分完全匹配，则应在结果中选择该项目。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:20:57.190

问题只是将每个项目转换为一个袋子，然后测试袋子的密封性：

```
private IDictionary<string, int> StringToBag(string str)
{
    return str.Split(',').GroupBy(s => s).ToDictionary(g => g.Key, g => g.Count());
}

private bool BagContains(IDictionary<string, int> haystack, IDictionary<string, int> needle)
{
    return needle.All(kv => haystack.ContainsKey(kv.Key) && kv.Value <= haystack[kv.Key]);
}

var bag = StringToBag("banana,banana,cherry,kiwi,strawberry");
bool contained = BagContains(bag, StringToBag("banana,strawberry")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:09:14.123

如果您的对象是这样初始化的：

```
string selected = "banana,banana,cherry,kiwi,strawberry";

List<string> lookup = new List<string>()
{
    "banana,strawberry",
    "strawberry",
    "banana,banana,banana"
}; 
```

你有一个这样的分组方法：

```
Dictionary<string, int> ToGroupDictionary(string value)
{
    return value.Split(',')
        .GroupBy(s => s.Trim())
        .ToDictionary(g => g.Key, g => g.Count());
} 
```

你可以像这样测试每个字符串`lookup`：

```
var selectedDictionary = ToGroupDictionary(selected);

// ["banana", 2]
// ["cherry", 1]
// ["kiwi", 1]
// ["strawberry", 1]

foreach(string test in lookup)
{
    var testDictionary = ToGroupDictionary(test);
    testDictionary.Keys.ToList().ForEach(k =>
        Console.WriteLine(selectedDictionary.ContainsKey(k) && 
            selectedDictionary[k] >= testDictionary[k]));

    // [0] :=
    // ["banana", 1]
    // ["strawberry", 1]
    // true, banana and strawberry exist

    // [1] :=
    // ["strawberry", 1]
    // true, strawberry exists

    // [2] :=
    // ["banana", 3]
    // false, too many bananas
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T13:51:10.090

看一下这个：

```
 private static void LoadFruits(string Fruit, Dictionary<string, int> FruitDictionary)
    {
        if (FruitDictionary.ContainsKey(Fruit))
            FruitDictionary[Fruit] = FruitDictionary[Fruit] + 1;
        else
            FruitDictionary.Add(Fruit, 1);
    }

    private static bool HasFruit(string Fruit, Dictionary<string, int> FruitDictionary)
    {
        if (FruitDictionary.ContainsKey(Fruit) && FruitDictionary[Fruit] > 0)
        {
            FruitDictionary[Fruit] = FruitDictionary[Fruit] - 1;
            return true;
        }

        return false;
    }

        ...
        List<string> AllThefruits = new List<string>(){"banana" ,"banana","cherry","kiwi","strawberry"};

        Dictionary<string, int> FruitsDictionary = new Dictionary<string, int>();

        List<string> Combination1 = new List<string>() { "banana", "strawberry" }; 
        AllThefruits.ForEach(x => LoadFruits(x, FruitsDictionary));
        bool TestCombination1 = Combination1.All(x => HasFruit(x, FruitsDictionary)); //true
        FruitsDictionary.Clear();

        List<string> Combination2 = new List<string>() { "strawberry" };
        AllThefruits.ForEach(x => LoadFruits(x, FruitsDictionary));
        bool TestCombination2 = Combination2.All(x => HasFruit(x, FruitsDictionary)); //true
        FruitsDictionary.Clear();

        List<string> Combination3 = new List<string>() { "banana", "banana", "banana" };
        AllThefruits.ForEach(x => LoadFruits(x, FruitsDictionary));
        bool TestCombination3 = Combination3.All(x => HasFruit(x, FruitsDictionary)); //false
        FruitsDictionary.Clear();

        List<string> Combination4 = new List<string>() { "banana", "banana" };
        AllThefruits.ForEach(x => LoadFruits(x, FruitsDictionary));
        bool TestCombination4 = Combination4.All(x => HasFruit(x, FruitsDictionary)); //true 
```

但是，我不确定这是否是*最佳*解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T14:13:30.117

```
public static bool CheckCombination(List<string> values, List<string> combinations)
{
    var valuesLookup = values.ToLookup(x => x);

    return CheckCombination(valuesLookup, combinations);
}

public static bool CheckCombination(ILookup<string, string> valuesLookup, List<string> combinations)
{
    foreach (var combination in combinations.GroupBy(x => x))
    {
        if (valuesLookup.Contains(combination.Key) &&
            valuesLookup[combination.Key].Count() < combination.Count())
            return false;
    }
    return true;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T14:15:18.557

未经测试，但这是否可行：

```
string fr = "banana,banana,cherry,kiwi,strawberry";
    IList<string> selFr = fr.Split(new string[] { "," }, StringSplitOptions.None);
    IList<string> look = new List<string>();
    // Add the lookup values to the "look" list here...
    IList<string> res = new List<string>();
    foreach (string lookupStr in look) {
        foreach (string f in selFr) {
            if (lookupStr.Contains(f)) {
                  res.Add(lookupStr);
                  continue;
            }
        }
     }
  return res; 
```

# html - 无论内容的宽度如何，如何在页面中创建其内容适合屏幕的 div

> ID：12093089
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:13.773
> 
> 标签：html, css, webpage

有没有一种方法使用 CSS3 或一些 javascript 库来允许网页具有宽度大于屏幕宽度的内容的 div，例如大图像或新闻信类型的内容，但在不允许滚动或剪切任何内容的情况下使其适合屏幕内容。附件是显示此行为的图像。这取自iPhone Safari 上的 Gmail 移动网站（打开[https://gmail.com ）。](https://gmail.com)

![请参阅下面的附图，它解释了这种情况。](../Images/b9e565d40718e81a870a1016abfc5508.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T13:49:21.133

使用元视口

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1" / > 
```

[视口标签语法](https://stackoverflow.com/questions/5555125/viewport-tag-syntax)

# android - android上的浏览器图像仅在刷新后显示

> ID：12093091
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:15.943
> 
> 标签：android, jquery-mobile, modernizr

我正在使用 Modernizr 来检测不支持的 SVG 浏览器，并为那些不支持它的浏览器加载额外的样式表。图片由 CSS 中的 background-urls 设置。

这些图像起初没有显示在我的 android 浏览器中，但是当我刷新它们加载的页面时。在这样做之前，我确定缓存已被清除。我也在使用 Jquery Mobile，但没有使用它的任何样式。

这是我的标题：

```
 <head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title>My Website</title>

    <meta http-equiv="x-dns-prefetch-control" content="off">

    <meta name="viewport" content="width=device-width, target-densityDpi=160, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link href="<?php bloginfo('template_url'); ?>/css/reset.css" rel="stylesheet" />
    <link href="<?php bloginfo('stylesheet_url'); ?>" rel="stylesheet" />

    <script type="text/javascript" src="http://use.typekit.com/abv4xxx.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/mobile.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
    <script type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/modernizer.js"></script>
    <script type="text/javascript">

    Modernizr.load({
    test: Modernizr.svg,
        nope: '<?php bloginfo("template_url"); ?>/css/nono-svg.css'
    });

    </script>
    <?php wp_head(); ?>
</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:39:58.633

我找到了解决方案。我不得不将我的 js 脚本移动到modernizr 的加载命令中。

```
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title>My Website</title>

    <meta http-equiv="x-dns-prefetch-control" content="off">

    <meta name="viewport" content="width=device-width, target-densityDpi=160, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link href="<?php bloginfo('template_url'); ?>/css/reset.css" rel="stylesheet" />
    <link href="<?php bloginfo('stylesheet_url'); ?>" rel="stylesheet" />

    <script type="text/javascript" src="http://use.typekit.com/abv4xxx.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/modernizer.js"></script>
    <script type="text/javascript">

    Modernizr.load({
        load: ['https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js',
            '<?php bloginfo("template_url"); ?>/js/mobile.js',
            'http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js'
        ],
        test: Modernizr.svg,
            nope: '<?php bloginfo("template_url"); ?>/css/nono-svg.css'
    });

    </script>
    <?php wp_head(); ?>
</head> 
```

# sql - SQL Server 排序规则冲突 - 创建视图

> ID：12093095
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:26.740
> 
> 标签：sql, sql-server, tsql

我正在尝试在数据库 A 中创建一个视图，该视图由数据库 B 中的一个选择填充，并且我遇到了排序规则冲突，更准确地说，它介于（Latin1_General_CI_AS”和“Latin1_General_BIN”之间）。我需要在哪里（在代码中）放置整理？

最好的祝福。

代码在这里：

```
CREATE VIEW [dbo].[CML_SDG_MENSAL_ESTOQUE]
AS

select  
SUM(dw_fato_faturmes.val_fatur) val_fatur, 
SUM(dw_fato_faturmes.val_receita) val_receita, 
SUM(dw_fato_faturmes.qtd_bonif_item) qtd_bonif_item, 
SUM(dw_fato_faturmes.val_bonif_fatur) val_bonif_fatur,
SUM(dw_fato_faturmes.val_bonif_receita) val_bonif_receita,
SUM(dw_fato_faturmes.val_devol_fatur) val_devol_fatur,
SUM(dw_fato_faturmes.val_devol_receita) val_devol_receita,
DW_DIM_PRODUTO.B1_CODDB B1_CODDB,
dw_fato_faturmes.cod_produto cod_produto, 
SUM(dw_fato_faturmes.qtd_estoque) qtd_estoque, 
SUM(dw_fato_faturmes.qtd_devol) qtd_devol, 
SUM(dw_fato_faturmes.qtd_item) qtd_item, 
SUM(dw_fato_faturmes.qtd_meta) qtd_meta,
SUM(dw_fato_faturmes.qtd_pedido) qtd_pedido,
SUM(dw_fato_faturmes.qtd_item)+
    SUM(dw_fato_faturmes.qtd_bonif_item)+
    SUM(dw_fato_faturmes.qtd_devol) venda_liquida
(SUM(dw_fato_faturmes.qtd_item)
     +SUM(dw_fato_faturmes.qtd_bonif_item)
    +SUM(dw_fato_faturmes.qtd_devol))
    +SUM(dw_fato_faturmes.qtd_pedido) venda___pedido
FROM 
logixbi.dbo.dw_fato_faturmes dw_fato_faturmes, 
logixbi.dbo.DW_DIM_CLIENTE DW_DIM_CLIENTE, 
DW_DIM_EMPRESA DW_DIM_EMPRESA, 
logixbi.dbo.DW_DIM_MARCA DW_DIM_MARCA, 
logixbi.dbo.DW_DIM_PRODUTO DW_DIM_PRODUTO, 
logixbi.dbo.DW_DIM_REPRESENTANTE DW_DIM_REPRESENTANTE

where 
DW_DIM_EMPRESA.SM0_FILIAL=dw_fato_faturmes.filial and
DW_DIM_MARCA.BM_GRUPO=dw_fato_faturmes.grupo and
DW_DIM_PRODUTO.B1_COD=dw_fato_faturmes.cod_produto and
DW_DIM_REPRESENTANTE.A3_COD=dw_fato_faturmes.vendedor and
DW_DIM_CLIENTE.A1_COD=dw_fato_faturmes.cliente and
DW_DIM_CLIENTE.A1_LOJA=dw_fato_faturmes.loja

group by DW_DIM_PRODUTO.B1_CODDB,dw_fato_faturmes.cod_produto 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T13:54:45.690

为了找到具有 wich 排序规则的列，请使用以下代码段：

```
SELECT name, collation_name
  FROM sys.columns
  WHERE OBJECT_ID IN (SELECT OBJECT_ID
                        FROM sys.objects
                       WHERE type = 'U'
                         AND name = 'your_table_name'
                      )
    AND name = 'your_column_name' 
```

找到列后，请尝试以下操作：

```
column_1 COLLATE your_collation = column_2 COLLATE your_collation 
```

最好在全局范围内坚持单一的排序规则。否则你会有问题。这是一个片段，它将为您提供数据库中的所有列，这些列与数据库中的列`COLLATION`不同

```
SELECT [TABLE_NAME] = OBJECT_NAME([id]),
       [COLUMN_NAME] = [name],
       [COLLATION_NAME] = collation
  FROM syscolumns
 WHERE collation <> 'your_database_collation_type'
   AND collation IS NOT NULL
   AND OBJECTPROPERTY([id], N'IsUserTable')=1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T13:54:07.653

放在哪里取决于冲突在哪里。

我建议加入

IE

```
DW_DIM_EMPRESA.SM0_FILIAL COLLATE Latin1_General_CI_AS =dw_fato_faturmes.filial COLLATE Latin1_General_CI_AS 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-24T06:35:03.667

这是由于不同排序规则类型之间的操作而发生的，因此请尝试使用此 for 语句进行比较。

```
ColumnA = ColumnB collate database_default 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T13:53:10.097

尝试在 where 子句中的所有字符匹配条件中使用它：

```
colnameA COLLATE Latin1_General_CI_AS = columnnameB COLLATE Latin1_General_CI_AS 
```

# objective-c - 中断睡眠

> ID：12093101
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:40.193
> 
> 标签：objective-c

在这个例子中，一个类继承自 NSThread。它每 10 秒执行一次 methodA，除非通过方法 sleepFromBeginning 延长时间：

```
- (void)main {
    while (!terminate) {
        sleep(10);
        [self methodA]
    }
}

- (void)sleepFromBeginning {
    // todo: Interrupt sleep and loop once more without calling methodA. How?
} 
```

如何在不取消其线程的情况下中断睡眠？

# .net - 模拟按钮上的 css 在开发和生产中显示不同

> ID：12093104
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:51.467
> 
> 标签：.net, css, internet-explorer

我正在使用 css 来设置超链接的样式，使其看起来像一个按钮。这是一个.net 站点。

```
a.pretend
{
display:inline-block;
border-top:1px solid #CCCCCC;
border-left:1px solid #CCCCCC;
border-bottom:1px solid #999999;
border-right:1px solid #999999;
background-color:#E7F3F1;
padding:3px 8px;
color:Black;
text-decoration:None;
cursor:pointer;
} 
```

使用 IE 9.0 在我的开发机器上查看带有模拟按钮的页面，它们具有设置的背景颜色。

将站点发布到本地网络上的生产服务器，使用相同的浏览器从我的开发机器查看站点，背景色不出现。

有任何想法吗？它快把我逼疯了。（请不要说使用不同的浏览器——它是一个内部网——所以我坚持使用 IE）。

DocType 是 XML1.0 过渡

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T13:50:48.023

跨浏览器内联块：

```
display:inline-block;
display: -moz-inline-stack;
*display:inline;
zoom:1; 
```

# mysql - 多个状态的状态表连接

> ID：12093105
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:58.227
> 
> 标签：mysql, sql, database, join

我有两个表，A 和 B，A 包含条目列表，B 包含每个条目的多个状态行（0-n，按日期分组，状态 0 表示正常，1 表示失败）。

现在我想从 A 中选择所有行，包括它们各自的最新状态及其日期以及最近的失败及其日期（失败定义为至少有一个条目为 1）。

我尝试了两个左连接，但不相信这是最佳解决方案，并且在确定正确的失败次数方面仍然存在问题（SUM（b2.status））

```
SELECT a.id, b1.date, SUM(b1.status), b2.date, SUM(b2.status) FROM tablea a
LEFT JOIN tableb b1 ON b1.aid=a.id
LEFT JOIN tableb b2 ON b2.aid=a.id

WHERE (b1.date=(SELECT MAX(`date`) FROM tableb WHERE aid=a.id) OR b1.date IS NULL)
AND (b2.date=(SELECT MAX(`date`) FROM tableb WHERE aid=a.id GROUP BY `date` HAVING SUM(`status`)>0) OR b2.date IS NULL)

GROUP BY a.id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:54:58.287

哎呀，我认为我在这一点上所做的每一个假设都是错误的。我想这会给你你想要的。它将为您提供最近发生故障的日期的故障总数。

我不确定在非常大的数据库上性能如何，但在较小的数据库上效果很好。

```
SELECT a.id, MAX(b1.date) status_date, SUM(b1.status) latest_status, 
       b2.date latest_failure,
       b2.total_failures

FROM tablea a

     LEFT JOIN tableb b1
     ON b1.aid = a.id
     AND b1.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id)

     LEFT JOIN 
     (SELECT aid, date, count(*) total_failures FROM tableb WHERE status > 0 GROUP BY aid, date) b2
     ON b2.aid = a.id
     AND b2.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id AND status > 0)

GROUP BY a.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:27:03.107

像这样的东西应该工作。

```
SELECT a.id, b1.date status_date, b1.status, b2.date latest_failure, 
       (SELECT COUNT(*) FROM tableb WHERE aid = a.id AND status > 0) total_failures

FROM tablea a

     LEFT JOIN tableb b1
     ON b1.aid = a.id
     AND b1.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id)

     LEFT JOIN tableb b2
     ON b2.aid = a.id
     AND b2.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id AND status > 0) 
```

这是假设 tableb.date 字段是日期时间并且是唯一的。否则，您可能希望使用 id 字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:29:49.300

你也可以这样做。不确定哪个更有效。你可以尝试两种方式。

```
SELECT a.id, b1.date status_date, b1.status, 
       (SELECT MAX(date) FROM tableb WHERE aid = a.id AND status > 0) latest_failure, 
       (SELECT COUNT(*)  FROM tableb WHERE aid = a.id AND status > 0) total_failures

FROM tablea a

     LEFT JOIN tableb b1
     ON b1.aid = a.id
     AND b1.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T16:24:17.350

这应该有效。

```
SELECT a.id, MAX(b1.date) status_date, SUM(b1.status) latest_status, 
       (SELECT MAX(date) FROM tableb WHERE aid = a.id AND status > 0) latest_failure,
       (SELECT COUNT(*) FROM tableb  WHERE aid = a.id AND status > 0) total_failures

FROM tablea a

     LEFT JOIN tableb b1
     ON b1.aid = a.id
     AND b1.date = (SELECT MAX(date) FROM tableb WHERE aid = a.id)

GROUP BY a.id; 
```

如果您一天内可能有多次失败，并且希望将状态显示为“1”，请更改此：

SUM(b1.status) 最新状态

至：

MAX(b1.status) 最新状态。

# powershell-2.0 - 无法为“InsertBefore”转换参数“1”，其值为：“”

> ID：12093107
> 
> 赞同：0
> 
> 时间：2012-08-23T13:46:59.663
> 
> 标签：powershell-2.0

我试图将子节点（）添加到 reportserver.config 文件，但我得到了一个错误，我实际上不知道经过所有努力。下面是我所做的。

$webConfigPath = "C:\Program Files\Microsoft SQL Server\MSRS10_50.SNDPRO\Reporting Services\ReportServer\rsreportserver.config"

$xml =[xml] (获取内容 $webConfigPath)

$child = $xml.CreateElement("RSWindowsNegotiate")

$xml.Configuration.Authentication.AuthenticationTypes.InsertBefore($child, "$xml.Configuration.Authentication.AuthenticationTypes.RSWindowsNTLM")

$xml.Save($webConfigPath)

错误是：无法将参数“1”，值：“”转换为“InsertBefore”以键入“System.Xml.XmlNode”：“无法将“”类型的“System.String”值转换为“System” .Xml.XmlNode"。"

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:06:02.353

我认为当使用空的 XML 元素作为属性（在本例中为 RSWindowsNTLM）时，powershell 会做一些奇怪的事情。尝试这个：

```
$RSWindowsNTLM = $xml.Configuration.Authentication.AuthenticationTypes.SelectSingleNode("RSWindowsNTLM");
$xml.Configuration.Authentication.AuthenticationTypes.InsertBefore($child, $RSWindowsNTLM) 
```

# objective-c - 一个对象的多个 glBlendFunc

> ID：12093110
> 
> 赞同：0
> 
> 时间：2012-08-23T13:47:15.507
> 
> 标签：objective-c, opengl

我需要绘制纹理四边形。我的纹理有一些 alpha 像素。所以我需要做`glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);`

没关系。但我需要在该四边形 ( ) 上使用其他一些混合功能`glBlendFunc(GL_DST_ALPHA, GL_ONE_MINUS_DST_ALPHA);`来实现纹理遮罩。我该怎么做？因为如果我同时设置了 glBlendFunc，其中之一将被忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:36:24.327

混合是一种帧缓冲操作，不能按图元设置。如果您需要在单个基元上组合多个纹理层，请在着色器中执行此操作并发出复合颜色/alpha，该复合颜色/alpha 以正确的方式与选择的混合功能交互。如果您需要不同的混合功能，则必须使用单独的绘图调用来执行此操作。

# python - Scapy 会绕过 Dummynet 吗？

> ID：12093116
> 
> 赞同：0
> 
> 时间：2012-08-23T13:47:28.367
> 
> 标签：python, delay, scapy, icmp, ipfw

[Scapy](http://info.iet.unipi.it/~luigi/dummynet/)是否绕过[Dummynet](http://www.secdev.org/projects/scapy/)（一般为 IPFW）？

看起来确实如此。我为每个传出和传入的数据包添加了很大的额外延迟，除了使用 Scapy 发送的数据包之外，一切都变慢了。

```
$ ipfw add pipe 1 from any to any
$ ipfw pipe 1 config delay 500ms
$ ping www.google.com
PING www.l.google.com (173.194.34.18) 56(84) bytes of data.
64 bytes from par03s02-in-f18.1e100.net (173.194.34.18): icmp_req=1 ttl=54 time=1011 ms
64 bytes from par03s02-in-f18.1e100.net (173.194.34.18): icmp_req=2 ttl=54 time=1010 ms 
```

所以看起来还可以。但是，一旦我使用 Scapy 发送数据包，就会发生以下情况：

```
>>> from scapy.all import *
>>> p = IP(dst="www.google.com", ttl=1) / TCP(sport=222, dport=2999)
>>> ans,unans = sr(p*3)
>>> ans[0][1].time - ans[0][0].sent_time
0.0002701282501220703  #usual value for such RTT 
```

有什么办法可以强制它通过dummynet？

**编辑**如果我有另一台机器可供使用，我可以在那里使用 dummynet 并将我的所有流量引导到它，然后再进入 Internet。不过，我更愿意在本地做所有事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T10:32:46.397

Scapy 的作者在 Scapy 的邮件列表中回复我：

> 尝试与此问题相同的解决方案：http: [//trac.secdev.org/scapy/wiki/FAQ#Icantping127.0.0.1.Scapydoesnotworkwith127.0.0.1orontheloopbackinterface](http://trac.secdev.org/scapy/wiki/FAQ#Icantping127.0.0.1.Scapydoesnotworkwith127.0.0.1orontheloopbackinterface) （使用原始套接字）

有效！这是上面链接中的段落：

> **我无法 ping 127.0.0.1。Scapy 不适用于 127.0.0.1 或环回接口**
> 
> loopback接口是一个非常特殊的接口。通过它的数据包并没有真正组装和拆卸。内核将数据包路由到其目的地，同时仍存储内部结构。你用 tcpdump -i lo 看到的只是假的，让你认为一切正常。内核不知道 Scapy 在背后做什么，所以你在 loopback 接口上看到的也是假的。除了这个不是来自本地结构。因此内核永远不会收到它。
> 
> 为了与本地应用程序对话，您需要在上一层构建数据包，使用 PF_INET/SOCK_RAW 套接字而不是 PF_PACKET/SOCK_RAW（或在 Linux 以外的其他系统上的等效项）：

```
>>> conf.L3socket
<class __main__.L3PacketSocket at 0xb7bdf5fc>
>>> conf.L3socket=L3RawSocket
>>> sr1(IP(dst="127.0.0.1")/ICMP())
<IP  version=4L ihl=5L tos=0x0 len=28 id=40953 flags= frag=0L ttl=64 proto=ICMP chksum=0xdce5 src=127.0.0.1 dst=127.0.0.1 options='' |<ICMP  type=echo-reply code=0 chksum=0xffff id=0x0 seq=0x0 |>> 
```

# c++ - 将方法作为回调函数提供（gcc 4.7.1）

> ID：12093118
> 
> 赞同：0
> 
> 时间：2012-08-23T13:47:31.097
> 
> 标签：c++, callback, gcc4.7

我试图将一个看似简单的回调方法指针设置为变量并得到以下错误：

> CSerialSniffer.cpp|11|错误：无法从类型 'Nexus::TReceiveCallback (CSerialSniffer::)(Nexus::CData*, Nexus::IMetaData*)'}' 转换 'CSerialSniffer::AsyncRecieverReceived'| 键入'Nexus::typeAsyncReceiverCallback {aka Nexus::TReceiveCallback ( *)(Nexus::* CData , Nexus::IMetaData*)}'|

这是 set 语句：

```
typeAsyncReceiverCallback l_pPointer = AsyncRecieverReceived; 
```

我定义了以下内容：

```
typedef TReceiveCallback (*typeAsyncReceiverCallback)(CData *a_pData, IMetaData *a_pMetaData);

class CSerialSniffer
{
...
public:
    Nexus::TReceiveCallback AsyncRecieverReceived(Nexus::CData *a_pData, Nexus::IMetaData *a_pMetaData);
...
} 
```

我已经在这几个小时了，有什么想法吗？

**回应答案：** 我在这里有相同的回调机制：

```
typedef void (*EnqueueCallback)( PData *pd );

class SomeClass
{
...
public:
   void enqueue( PData *pd );
...
};

class CSerialSniffer
{
...
public:
    void set_enqueue_callback(EnqueueCallback a_pEnqueueCallback );
...
}

SomeClass::SomeFunction(){
 this->serialSniffer->set_enqueue_callback(this->enqueue);
} 
```

它编译得很好。两者有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T13:55:30.953

你`CSerialSniffer::AsyncRecieverReceived`是一个成员函数。它不能在没有对象的情况下使用，因此要么将其设为自由函数（在类之外），要么设为静态函数：

```
class CSerialSniffer
{
...
public:
    static Nexus::TReceiveCallback AsyncRecieverReceived(
         Nexus::CData *a_pData, 
         Nexus::IMetaData *a_pMetaData);
...
};

typeAsyncReceiverCallback l_pPointer = &CSerialSniffer::AsyncRecieverReceived; 
```

C++11 的一个更好的选择是使用 a`std::function<>`代替：

```
typedef std::function<TReceiveCallback(CData*,IMetaData*)> 
        typeAsyncReceiverCallback; 
```

现在你可以通过绑定一个对象作为成员函数的第一个参数来创建一个自由函数：

```
CSerialSniffer snivver;

auto callback = std::bind( 
     std::mem_fun( &CSerialSniffer::AsyncRecieverReceived ),
     &snivver ); 
```

这些好东西在`<functional>`标题中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T13:55:32.247

你的回调声明

`typeAsyncReceiverCallback`

是常规函数，但是

`AsyncReceiverReceived`

是一种方法（即它需要“this”指针，并且在 c++ 中无法以这种方式获取它）。

要么更改`AsyncReceiverReceived`为静态，要么使用观察者模式。

# sql - 过去 12 小时内没有作业？

> ID：12093120
> 
> 赞同：-1
> 
> 时间：2012-08-23T13:47:36.347
> 
> 标签：sql, sql-server, tsql

我注意到在过去 12 小时内我的服务器上的所有作业都没有运行。SQL Server 代理在线，但我必须“重置”我所有的作业计划（将其更改为新的，然后将计划更改回原来的设置）才能重新开始运行作业。以前有没有人遇到过这个问题并知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:03:37.370

服务器在间隔期间关闭。作业现在按计划运行

# java - 从 Google Calenader API v3 中的重复事件中获取异常

> ID：12093121
> 
> 赞同：3
> 
> 时间：2012-08-23T13:47:39.437
> 
> 标签：java, google-api, google-calendar-api

我一直在开发一个应用程序来从域中的所有用户下载整个日历并将它们保存为 ICS 格式。该应用程序是用 Java 编写的。我使用 2L OAuth 获得访问权限。到目前为止，我能够获取日历的大部分数据，不包括经常性事件的例外情况。谷歌 API 文档说每个重复事件都应该包含一个重复列表，包括 EXRULE。但是当我调用 API 时，我得到的只有经常性规则，没有例外。有什么办法可以得到这些异常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-30T17:22:26.550

您将异常作为常规项目获得，并且

```
event.getOriginalEvent() 
```

将返回对重复事件的引用。

# .net - AccordionPane 嵌套在中继器内？

> ID：12093123
> 
> 赞同：0
> 
> 时间：2012-08-23T13:47:45.333
> 
> 标签：.net, repeater, accordion

我正在尝试创建一个中继器，它将在手风琴控制器中创建多个手风琴窗格，但看起来两者不能嵌套。有解决方法吗？

这就是我想要做的：

```
<asp:Accordion ID="Accordion1" runat="server" >
    <Panes>
      <asp:Repeater runat="server" id="rpPanes">
        <ItemTemplate>
           <asp:AccordionPane ID="AccordionPane1" runat="server">
             <Header>header from db here</Header>
             <Content>content from DB here </Content>
           </asp:AccordionPane>
       </ItemTemplate>
     </Repeater>
    </Panes>
</asp:Accordion> 
```

手风琴窗格的数量需要是动态的，因为它来自数据库，并且总是可以添加或删除一个（在数据库本身内）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:50:23.297

I 而不是使用中继器来重复手风琴，只需使用中继器来重复手风琴。每个窗格都有一个单独的 Accordion。这将产生独立的手风琴。

# ios - iOS 5 ARC 中动态生成的 UIButton 导致释放实例崩溃

> ID：12093126
> 
> 赞同：1
> 
> 时间：2012-08-23T13:47:48.977
> 
> 标签：ios, objective-c, ios5, automatic-ref-counting

我有一个我创建的类来生成我添加到我的 UIView 的 UIButton。这一直很好，直到我昨天转换为 ARC，而不是我收到以下错误：

```
-[OrderTypeButton performSelector:withObject:withObject:]: message sent to deallocated instance 0x12449f70 
```

这是将按钮添加到我的 UIView 的代码（实际上是我的主 UIView 中的子视图）：

```
OrderTypeButton *btn = [[OrderTypeButton alloc]initWithOrderType:@"All Orders" withOrderCount:[NSString stringWithFormat:@"%i",[self.ordersPlacedList count]] hasOpenOrder:NO];
btn.view.tag = 6969;
btn.delegate = self;
[btn.view setFrame:CGRectMake((col * width)+ colspacer, rowHeight + (row * height),  frameWidth, frameHeight)];
[self.statsView addSubview:btn.view]; 
```

这是我的班级标题：

```
#import <UIKit/UIKit.h>

@protocol OrderTypeButtonDelegate
-(void) tapped:(id)sender withOrderType:(NSString*) orderType;
@end

@interface OrderTypeButton : UIViewController {
    id<OrderTypeButtonDelegate> __unsafe_unretained delegate;
    IBOutlet UILabel *lblOrderType;
    IBOutlet UILabel *lblOrderCount;
    NSString *orderType;
    NSString *orderCount;
    BOOL    hasOpenOrder;

}

@property (nonatomic, strong) IBOutlet UIButton *orderButton;
@property (nonatomic, strong) IBOutlet UILabel *lblOrderType;
@property (nonatomic, strong) IBOutlet UILabel *lblOrderCount;
@property (nonatomic, strong) NSString *orderType;
@property (nonatomic, strong) NSString *orderCount;
@property (nonatomic, assign) BOOL hasOpenOrder;
@property (nonatomic, unsafe_unretained) id<OrderTypeButtonDelegate> delegate;

-(id) initWithOrderType: (NSString *) anOrderType withOrderCount: (NSString *) anOrderCount hasOpenOrder: (BOOL) openOrder;
-(IBAction)btnTapped:(id)sender;

@end 
```

执行：

```
#import "OrderTypeButton.h"

@implementation OrderTypeButton
@synthesize orderButton;
@synthesize lblOrderType, lblOrderCount, orderType, orderCount, hasOpenOrder, delegate;

-(id) initWithOrderType: (NSString *) anOrderType withOrderCount: (NSString *) anOrderCount hasOpenOrder: (BOOL) openOrder {
    if ((self = [super init])) {
        self.orderType = anOrderType;
        self.orderCount = anOrderCount;
        self.hasOpenOrder = openOrder;
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.lblOrderType.text =[NSString stringWithFormat:@"%@", self.orderType];
    self.lblOrderCount.text = [NSString stringWithFormat:@"%@", self.orderCount];
    if (self.hasOpenOrder) {
        [self.orderButton setBackgroundImage:[UIImage imageNamed:@"background-order-btn-red.png"] forState:UIControlStateNormal];
        self.lblOrderType.textColor = [UIColor whiteColor];
        self.lblOrderCount.textColor = [UIColor whiteColor];
    }
}

-(IBAction)btnTapped:(id)sender {
    NSLog(@"TAPPED");
    if ([self delegate] ) {
        [delegate tapped:sender withOrderType:self.orderType];
    }
}

- (void)viewDidUnload
{
    [self setOrderButton:nil];
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

@end 
```

我在这里所做的似乎相当简单，不确定 ARC 发生了什么变化导致我出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:03:45.667

也许 ARC 自动释放创建的按钮，尝试将创建的按钮存储在数组中

```
//.h file
@property (nonatomic, strong) NSArray *buttonsArray

//.m file
@synthesize buttonsArray
...
- (void)viewDidLoad {
  buttonsArray = [NSArray array];
...
OrderTypeButton *btn = [[OrderTypeButton alloc]initWithOrderType:@"All Orders"         
                                                  withOrderCount:[NSString stringWithFormat:@"%i",[self.ordersPlacedList count]]
                                                    hasOpenOrder:NO];
btn.view.tag = 6969;
btn.delegate = self;
[btn.view setFrame:CGRectMake((col * width)+ colspacer, rowHeight + (row * height),  frameWidth, frameHeight)];
[self.statsView addSubview:btn.view];
//Add button to array
[buttonsArray addObject:btn]; 
```

如果您想更改按钮或从视图中删除某些特定按钮，这种方法也会有所帮助

# matlab - Matlab：如何求解具有附加参数的非线性方程组？

> ID：12093133
> 
> 赞同：1
> 
> 时间：2012-08-23T13:48:13.960
> 
> 标签：matlab

给定两个时间段的数据，我想创建一个函数来查找巴斯扩散模型的参数 p 和 q。

模型（方程）如下：

```
n(T) = p*m + (q-p)*n(T-1) + q/m*n(T-1)^2 
```

在哪里

```
n(T) = number of addoptions occuring in period T
n(T-1) = number of cumulative adoptions that occured before T
p = coefficient of innovation
q = coefficient of imitation
m = number of eventual adopters 
```

例如，如果 m = 3.000.000 并且以下年份的数据如下：

```
2000: n(T) = 820, n(T-1) = 0
2005: n(T) = 25000, n(T-1) = 18000 
```

然后必须求解以下方程组（以确定 p 和 q 的值）：

```
p*m + (q-p)*0 + q/3.000.000 * 0^2 == 820
p*m + (q-p)*18000 + q/3.000.000 * 18000^2 == 25000 
```

通过遵循[Matlab 文档](http://www.mathworks.com/help/toolbox/optim/ug/fsolve.html)，我尝试创建一个函数 Bass：

```
function F = Bass(m, p, q, cummulativeAdoptersBefore)

F = [p*m + (q-p)*cummulativeAdoptersBefore(1) + q/m*cummulativeAdoptersBefore(1).^2;
    p*m + (q-p)*cummulativeAdoptersBefore(2) + q/m*cummulativeAdoptersBefore(2).^2];

end 
```

应该在 fsolve(@Bass,x0,options) 中使用哪个，但在这种情况下，m、p、q、cummulativeAdoptersBefore(1) 和 cummulativeAdoptersBefore(2) 应该在 x0 中给出，并且所有变量都将被视为未知，而不仅仅是后两者。

有谁知道如何求解上述方程组？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:04:12.680

`fsolve()`试图最小化您作为参数提供的函数。因此，您必须将方程式更改为

```
p*m + (q-p)*0     + q/3.000.000 * 0^2     - 820   == 0
p*m + (q-p)*18000 + q/3.000.000 * 18000^2 - 25000 == 0 
```

并在 Matlab 语法中

```
function F = Bass(m, p, q, cumulativeAdoptersBefore, cumulativeAdoptersAfter)

    F = [p*m + (q-p)*cumulativeAdoptersBefore(1) ...
             + q/m  *cumulativeAdoptersBefore(1).^2 
             - cumulativeAdoptersAfter(1);
         p*m + (q-p)*cumulativeAdoptersBefore(2) ...
             + q/m  *cumulativeAdoptersBefore(2).^2 
             - cumulativeAdoptersAfter(2)];
end 
```

**注意：**您的函数中有错字`Bass`（乘法而不是总和）。

现在你有了一个函数，它接受的参数比未知数多。一种选择是创建一个匿名函数，它只将未知数作为参数，并通过闭包修复其他参数。为了适应未知数`p`和`q`，你可以使用类似的东西

```
cumulativeAdoptersBefore = [0, 1800];
cumulativeAdoptersAfter = [820, 25000];
m = 3e6;
x = [0, 0]; %# Probably, this is no good starting guess.
xopt = fsolve(@(x) Bass(m, x(1), x(2), cumulativeAdoptersBefore, cumulativeAdoptersAfter), x0); 
```

所以`fsolve()`看到一个函数只接受一个参数（一个有两个元素的向量），它还返回一个向量值。

# c# - 使用存储过程的实体框架并发问题

> ID：12093135
> 
> 赞同：3
> 
> 时间：2012-08-23T13:48:19.887
> 
> 标签：c#, asp.net, entity-framework

我正在使用 ASP.NET 为一家零售公司构建应用程序。我使用实体框架（模型优先）作为我的数据访问层。我正在使用存储过程来执行我的 CRUD 操作，并且所有列都已映射，并且似乎是正确的，因为所有 CRUD 功能都按预期工作。

但是我遇到了 DELETE 操作的并发问题。

我在表中添加了一个`TimeStamp`列，我正在对其进行 CRUD 操作。UPDATE 操作工作正常，因为它通过主键和`TimeStamp`值进行更新。因此，如果没有行受到 UPDATE 操作的影响，由于`TimeStamp`值的变化，实体框架会抛出一个`OptimisticConcurrencyException`.

该`DELETE`操作的工作原理与按主键和`TimeStamp`值删除相同。`TimeStamp`但是当实体和数据库之间的值不匹配时，不会抛出异常。

在 C# 删除方法中，我首先检索最新记录，然后将`TimeStamp`属性更新为另一个`TimeStamp`值（它可能与检索到的值不同）。通过使用 SQL Profiler 进行一些调查后，我可以看到`DELETE`存储过程已执行，但`TimeStamp`传递给存储过程的参数是最新`TimeStamp`值**，而不是我将`TimeStamp`属性**设置为的值。因此记录被删除并且实体框架不会抛出异常。

为什么实体框架仍会将检索`TimeStamp`到的值传递给存储过程，而不是我分配给属性的值？这是设计还是我错过了什么？

任何帮助将不胜感激！（当你需要她的时候，朱莉·勒曼在哪里！:-)）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:28:57.270

EF 中的乐观并发运行良好。即使使用存储过程。

`ObjectContext.DeleteObjects`将实体的原始值传递给删除函数。这是有道理的。原始值用于标识要删除的行。当您删除对象时，您（通常）不会对您的实体进行有意义的编辑。那么你希望 EF 做什么呢？写？到什么记录？

将修改后的数据传递给删除函数的一种合法用途是当您想要跟踪其他表中的删除**并且**您需要输入一些在数据库层无法访问的信息时，只能在业务层访问。示例包括应用程序级用户名或删除原因。在这种情况下，您需要将此值*作为原始值*来构造实体。一种方法：

```
var x = db.MyTable.Single(k => k.Id == id_to_delete);
x.UserName = logged_in_user;
x.ReasonForChange = some_reason;
// [...]
db.ObjectStateManager.ChangeObjectState(x, EntityState.Unchanged);
db.MyTable.DeleteObject(x);
db.SaveChanges(); 
```

当然，更好的策略可能是在业务层公开进行。

* * *

我不了解您使用 rowversion/timestamp 的用例。

1.  为避免并发问题，您将*原始*时间戳传递给修改代码。这样就可以将它与数据库中的当前值进行比较，以检测自上次读取后记录是否已更改。将其与新值进行比较毫无意义。

2.  您通常使用数据库自​​动更新的更改标记，例如 SQL Server 中的 rowversion/timestamp、Oracle 中的 rowversion 或 PostgreSQL 中的 xmin。您不会在代码中更改其值。

3.  不过，如果您手动维护行版本，则需要提供：

    a) 要插入和更新要写入的新版本，以及

    b) 旧版本（从数据库中读取）更新和删除以检查并发更改。

    您不会发送要删除的新值。你不需要。此外，在使用存储过程进行修改时，最好在过程中计算新版本并将其返回给应用程序，而不是相反。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T12:04:13.930

很难在没有看到任何代码的情况下判断，但也许当回发发生时，在您的删除方法触发之前页面正在重新绑定？在任何方法数据绑定表单控件（我假设它是 OnLoad 或 OnInit）上，您是否使用 包装了任何数据绑定调用`if ( !this.IsPostBack ) { ... }`？

此外，我不确定是否有理由将并发标志显式存储在视图状态/会话变量中，但更好的方法（imo）是将时间戳添加到 FormView/GridView 的 DataKeyNames 属性中（即：`<asp:FormView ID='blah' runat='server' DataKeyNames='Id, Timestamp'>`。

这样您就不必担心手动存储或更新时间戳。;)

# jquery - struts-jquery 不加载对话框内容

> ID：12093138
> 
> 赞同：0
> 
> 时间：2012-08-23T13:48:24.413
> 
> 标签：jquery, jsp, struts2

有这个代码：

```
<sj:head compressed="false" jqueryui="true" jquerytheme="custom"/>

 <s:url id="link" action="ABC" namespace="/DEF" escapeAmp="false"/>
 <sj:a openDialog="_dialog" cssStyle="float:left;padding:5 0 0 10;">
                Link
 </sj:a> <sj:dialog id="_dialog" href="%{link}" modal="false" resizable="false" 
                position="center" closeOnEscape="true" draggable="false" title="Contact Us" autoOpen="false">
            </sj:dialog> 
```

当我单击链接时 - 它会打开对话框，但内容为空。正如我所见，没有对 /DEF/ABC.action 提出任何请求。

但是，如果我将 autoOpen 属性更改为 true，那么一旦加载页面，对话框就会打开，并且内容就在那里。

可能是什么问题，我怎样才能让它正常工作？

我使用了[http://code.google.com/p/struts2-jquery/wiki/DialogTag中的 struts-jquery 示例](http://code.google.com/p/struts2-jquery/wiki/DialogTag)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:29:41.633

`sj:a`标签应如下所示：`<sj:a href="%{url}" openDialog="_dialog"/>` 您的代码应如下所示：

```
<sj:head compressed="false" jqueryui="true" jquerytheme="custom"/>

<s:url id="link" action="ABC" namespace="/DEF" escapeAmp="false"/>
<sj:a openDialog="_dialog" href="%{link}" cssStyle="float:left;padding:5 0 0 10;">
    Link
</sj:a>
<sj:dialog id="_dialog"  modal="false" resizable="false" position="center" closeOnEscape="true" draggable="false" title="Contact Us" autoOpen="false" /> 
```

你不应该放在`href`标签`sj:dialog`里，它应该在`sj:a`标签里

**更新**

请查看[SHOWCASE](http://struts.jgeppert.com/struts2-jquery-showcase/index.action)

# java - 在带有 ActionBarSherlock 的 Android 姜饼中使用 ViewPager

> ID：12093140
> 
> 赞同：1
> 
> 时间：2012-08-23T13:48:28.953
> 
> 标签：java, android, android-viewpager, actionbarsherlock

我的应用程序我正在使用 ABS 我想浏览选项卡（[Actionbarsherlock + 选项卡 + 多个片段？](https://stackoverflow.com/questions/10082163/actionbarsherlock-tabs-multi-fragments)）当我使用此代码中的第二个答案（完全复制）时，它在我的 Android 4.0 调试设备上工作正常但是当我在我的 GingerBread 设备上测试它会停止。我还导入了支持库，但它一直在 GingerBread 上崩溃。

我无法为任何 logcat 提供错误，因为我无法调试我的 GingerBread 设备。在 Android 4 设备上它运行良好。

```
E/AndroidRuntime(30187): java.lang.RuntimeException: Unable to start activity ComponentInfo{nl.safan.e_app/nl.safan.e_app.ABSTabsViewPagerActivity}: java.lang.IllegalStateException: You must use Theme.Sherlock, Theme.Sherlock.Light, Theme.Sherlock.Light.DarkActionBar, or a derivative.
E/AndroidRuntime(30187):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
E/AndroidRuntime(30187):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
E/AndroidRuntime(30187):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
E/AndroidRuntime(30187):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
E/AndroidRuntime(30187):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(30187):    at android.os.Looper.loop(Looper.java:130)
E/AndroidRuntime(30187):    at android.app.ActivityThread.main(ActivityThread.java:3683)
E/AndroidRuntime(30187):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(30187):    at java.lang.reflect.Method.invoke(Method.java:507)
E/AndroidRuntime(30187):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:875)
E/AndroidRuntime(30187):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:633)
E/AndroidRuntime(30187):    at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(30187): Caused by: java.lang.IllegalStateException: You must use Theme.Sherlock, Theme.Sherlock.Light, Theme.Sherlock.Light.DarkActionBar, or a derivative.
E/AndroidRuntime(30187):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.generateLayout(ActionBarSherlockCompat.java:1007)
E/AndroidRuntime(30187):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.installDecor(ActionBarSherlockCompat.java:919)
E/AndroidRuntime(30187):    at com.actionbarsherlock.internal.ActionBarSherlockCompat.setContentView(ActionBarSherlockCompat.java:872)
E/AndroidRuntime(30187):    at com.actionbarsherlock.ActionBarSherlock.setContentView(ActionBarSherlock.java:668)
E/AndroidRuntime(30187):    at com.actionbarsherlock.app.SherlockFragmentActivity.setContentView(SherlockFragmentActivity.java:261)
E/AndroidRuntime(30187):    at nl.safan.e_app.ABSTabsViewPagerActivity.onCreate(ABSTabsViewPagerActivity.java:34)
E/AndroidRuntime(30187):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
E/AndroidRuntime(30187):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
E/AndroidRuntime(30187):    ... 11 more 
```

# android - 如何在具有多个购买活动的应用程序中绑定计费服务

> ID：12093142
> 
> 赞同：2
> 
> 时间：2012-08-23T13:48:32.760
> 
> 标签：android, binding, android-activity, android-service, in-app-billing

我正在编写应用程序，在我的 MainActivity 中有项目列表。当单击项目时，新的 DetailsActivity 开始显示该项目的详细信息和购买它的按钮。此应用程序基于 Google 的地下城示例。

**我想知道我应该如何管理与 BillingService 的连接？**

**选项 1）**我是否应该像在地下城示例中一样在 MainActivity 中创建 BillingService，然后在请求购买时从每个 ProjectDetailsActivity 绑定到该服务？我不确定绑定到绑定到 IMarketBillingService 的 BillingService 是否不会变得太混乱......

我试图这样做，但我不确定如何从 MainActivity 以外的 Activity 绑定到 BillingService。我是按照您通常绑定到服务的方式完成的：

```
//ProjectDetailsActivity.java
private ServiceConnection billingConnection = new ServiceConnection() {

    @Override
    public void onServiceConnected(ComponentName name, IBinder service) {
        mBillingService = ((BillingService.MyBinder)service).getService();
        if(mBillingService!=null)
            Log.d(tag, "Bound to BillingService");
    }

    @Override
    public void onServiceDisconnected(ComponentName name) {
        mBillingService = null;
    }
};

public void unbind() {
    try {
        unbindService(billingConnection);
    } catch (IllegalArgumentException e) {
        // This might happen if the service was disconnected
    }
}

onCreate(){...}

onStart(){...
billingIntent = new Intent(ProjectDetailsActivity.this, BillingService.class);
bindService(billingIntent, billingConnection, Context.BIND_AUTO_CREATE);
...} 
```

**选项 2）**我是否应该以某种方式将 BillingService 从 MainActivity 传递给 ProjectDetailsActivities？我是的，怎么样？用 Parcelable 什么的？我没有看到这样做的可能性，我认为这不是正确的方法。

**选项 3)**我应该在每个 ProjectDetailsActivity 中创建 BillingService 吗？如上所述，我认为这不行，因为所有这些服务在购买后都是多余的。

**其他选择..？**

我想听听如何解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T00:21:15.810

两种选择都没有。不要考虑“创建”或“传递”服务。您可以通过任何带有意图的活动与服务进行通信。

我为 Android In-app Billing 编写了一个开源[库](https://github.com/robotmedia/AndroidBillingLibrary)来为你处理这个问题。源代码也可能有助于阐明有关服务的一些概念。

# android - 如何在 Android 弹出菜单中设置默认选择选项？

> ID：12093144
> 
> 赞同：9
> 
> 时间：2012-08-23T13:48:38.000
> 
> 标签：android, android-layout

我正在使用以下代码创建菜单：

```
 PopupMenu popup = new PopupMenu(getApplicationContext(), v);
    MenuInflater inflater = popup.getMenuInflater();
    inflater.inflate(R.menu.equalizer, popup.getMenu());
    popup.show(); 
```

均衡器.xml

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <group android:checkableBehavior="single">
        <item android:id="@+id/flat"
              android:title="Flat" />
        <item android:id="@+id/stadium"
              android:title="Stadium" />
        <item android:id="@+id/jazz"
              android:title="Jazz" />
         <item android:id="@+id/rock"
              android:title="Rock" />
         <item android:id="@+id/pop"
              android:title="Pop" />
    </group>
</menu> 
```

比如说，如何设置默认选择的菜单的第三个选项？

* * *

**编辑：** 我想以编程方式更改默认值。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-23T14:00:44.010

已经给出了在 xml 中设置选中项的答案。如果您想在代码中执行此操作，请使用：

```
popup.getMenu().getItem(2).setChecked(true); 
```

选择第 3 项。**当然，在**你膨胀菜单之后......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T13:54:06.960

```
<item android:id="@+id/jazz"
  android:title="Jazz"
  android:checked="true" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T13:57:10.310

`android:checked="true"`在要选择默认的项目中设置。

# java - 如何刷新 html 页面上的特定组件

> ID：12093147
> 
> 赞同：1
> 
> 时间：2012-08-23T13:48:42.547
> 
> 标签：java, html

我的 html 页面上有一个事件监听器，因此当一个组件的值发生变化时，另一个组件将成为必需的。但这仅在您更改组件的值、保存页面并重新加载时才有效

有没有办法做到这一点而不必保存和重新加载整个页面？

```
@EventListener(targets="licensingStatus", events="onchange")
public void onLicenseStatusChange(IRequestCycle cycle){
....
} 
```

**编辑：**

功能可以转吗

```
<input jwcid="licensingApprovalDate@CustomDatePicker"/> 
```

进入这个

```
<input jwcid="licensingApprovalDate@CustomDatePicker" validators="validators:maxDateToday"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:50:54.973

如果组件需要动态生成：

最简单的实现是使用`AJAX`. 您可以为页面上的任何组件设置一个侦听器，当发生更改时，进行`AJAX`调用并让另一个组件出现。

别的：

如果组件已经存在并且最初是不可见的并且只需要使其可见，那么您可以使用此代码

```
document.getElementById('other-component').style.visibility='visible'; 
```

在你的听众中。

**编辑：**

如果您只是希望新字段是强制性的，您可以在 javascript 中为它创建一个检查，以便当您输入提交按钮或其他任何内容时，检查该字段是否为空，如果为空则发出一条消息给用户。像这样的东西：

```
mystring=document.getElementById('other-component').value; 
if(!mystring.match(/\S/)){
alert ('Empty value is not allowed');
return false;
}else{
 alert ("correct input");
 return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T13:49:35.770

您应该使用 Ajax 来实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T13:50:45.637

阿贾克斯。可能值得看看像 jQuery 这样的框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T13:54:03.980

绝对在这里使用Javascript。返回数据时，您可以使用[AJAX](http://www.codecoffee.com/articles/ajax.html)并在单个元素上使用 getElementById 进行更新。

[jQuery](http://jquery.com/)让这变得容易多了。

```
$.ajax({
  url: "test.html",
  context: document.body
}).done(function() { 
  $("#myDiv").html("New data loaded");
  myGlobalMandatoryField = true;
}); 
```

`myGlobalMandatoryField`可以在另一个函数中使用，以确保在字段中输入值。

# django - 在views.py之外访问request.user

> ID：12093151
> 
> 赞同：3
> 
> 时间：2012-08-23T13:48:58.623
> 
> 标签：django, forms, validation

我有一个文件 forms.py，我在其中定义了所有表单。我需要对我的一个表单字段进行密码验证。

在我的 forms.py

```
class ChangePasswordForm(forms.Form):
    old_password = forms.CharField(widget=forms.PasswordInput)
    new_password= forms.CharField(widget=forms.PasswordInput)
    new_password_again= forms.CharField(widget=forms.PasswordInput)

    def clean_old_password(self):
        data = self.cleaned_data['old_password']
        if data != currently_logged_in_user.password:
            raise forms.ValidationError("Password Incorrect")

        return data 
```

我需要访问当前登录的用户，以便我可以`currently_logged_in_user.password`用于验证，但目前正在工作，所以我`forms.py`不`views.py`知道该怎么做？请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:08:34.010

您需要将用户从视图传递到您的表单。你可以这样做：

视图.py

```
my_form = ChangePasswordForm(user=request.user, data=request.POST)
... 
```

表格.py

```
class ChangePasswordForm(forms.Form):
    ...

    def __init__(self, *args, **kwargs):
        self.user = kwargs.pop('user', None)
        super(ChangePasswordForm, self).__init__(*args, **kwargs)

    def clean_old_password(self):
        old_password = self.cleaned_data['old_password']
        if not self.user.check_password(old_password)
            raise forms.ValidationError("Password Incorrect")
        return old_password 
```

# asp.net-mvc-3 - 如何在饼图HighChart中显示json数据？

> ID：12093161
> 
> 赞同：2
> 
> 时间：2012-08-23T13:49:40.797
> 
> 标签：asp.net-mvc-3, highcharts, pie-chart

大家好，我有一个看起来像这样的 json 数据

```
 [ "Data":[ 
 {"Id":"1  ","EmployeeName":Anil},
 ] 
```

我从我的控制器动作中得到的

```
 public ActionResult Index()
    { 
        var data = GetData();
        return View();
    }

    public JsonResult GetData()
    {
        int Param1;
        Param1 = 1;     
       var EmployeeDetails = db.EmployeeDetails.ToList<EmployeeDetail>().Select(e =>  
        new
         {
        id=e.EmployeId,
        Name = e.EmployeeName
       });
        return Json(EmployeeDetails , JsonRequestBehavior.AllowGet);
    } 
```

现在我想要这个 json 数据到饼图..我该怎么做

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T09:43:20.007

在这里，不要在 action 方法中调用您的 jsonresult 方法，而是使用 $.getJSON 方法

```
 public ActionResult Index()
    { 

    return View();
     }

  public JsonResult GetData()
   {
    int Param1;
    Param1 = 1;     
     var EmployeeDetails = db.EmployeeDetails.ToList<EmployeeDetail>().Select(e =>  
    new
     {
    id=e.EmployeId,
    Name = e.EmployeeName
   });
    return Json(EmployeeDetails , JsonRequestBehavior.AllowGet);
  } 
```

在这里，您可以像这样调用您的方法并将其绑定到您的图表

```
 <script type="text/javascript">
  $(function () {
      $.getJSON('<%= Url.Action("YourMethod","YourControllerName") %>', {}, function (data) {
          var json = data;              
          var jsondata = [];              
          for (var i in json) {
             // var serie = new Array(json[i].Projects, json[i].Bugs);
              jsondata.push([json[i].EmployeId, json[i].EmployeeName]);
          }              
      var chart = new Highcharts.Chart({
          chart: {
              renderTo: 'container',
              type: 'pie',
               plotBackgroundColor: null,
               plotBorderWidth: null,
               plotShadow: false
          },
           title: {
               text: 'Resource Reports of BugTracker'
           },

          plotOptions: {
              pie: {
                  showInLegend: true,
                  animation: false,
                  allowPointSelect: true,
                  cursor: 'pointer'
              }
          },
          legend: {
              enabled: true
          },
          series: [{
              type: 'pie',                 
              data: jsondata
          }]
      });
      });
  });
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:50:31.983

无论您拥有什么类型的数据，创建饼图都相当简单。在这里查看一个工作示例：http: [//livecoding.io/3437833](http://livecoding.io/3437833)

```
var chart = new Highcharts.Chart({
  chart: {
    renderTo: 'container',
    plotBackgroundColor: null,
    plotBorderWidth: null,
    plotShadow: false
  },
  plotOptions: {
    pie: {
      animation: false,
      allowPointSelect: true,
      cursor: 'pointer'
    }
  },
  series: [{
    type: 'pie',
    name: 'Browser share',
    data: [
      ['Firefox',   45.0],
      ['IE',       26.8],
      ['Safari',    8.5],
      ['Opera',     6.2],
      ['Others',   0.7]
    ]
  }]
}); 
```

# php - 如何为每个数据库实体提供超链接

> ID：12093165
> 
> 赞同：-1
> 
> 时间：2012-08-23T13:50:11.237
> 
> 标签：php, html, hyperlink

我在数据库中有一个表，由三列和 4 行组成。现在我想为数据库中表的第三列中存在的每个实体设置超链接并显示输出。

我尝试将数组的值打印为

```
echo "<td>", $row['a'], "</td><td>", $row['b'] ,"</td><td>", "<a href=\"http://foo/foo/".$row['link']."\">"."view"."</a>","</td>" ;?> 
```

其中 a,b 和 link 分别是 1,2 和 3 的列名。我想超链接html页面。我该怎么做？当我尝试运行我的代码时，它会转到文件夹`http://foo/foo/`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:55:35.757

删除该`echo`部分并仅输出为 HTML。这样您就不必担心所有那些混乱的连接（您使用的是`,`代替`.`，这*是*有效的，但在这种情况下是不必要的）。

```
<?php

// code here

?>

<td><?= $row['a'] ?></td><td><?= $row['b'] ?></td><td><a href="http://foo/foo/<?= $row['link'] ?>">view</a></td>

<?php

// more code here
.
.
. 
```

# c# - 如何手动编辑 Visual Studio 项目的清单以明确指定引用的程序集？

> ID：12093169
> 
> 赞同：3
> 
> 时间：2012-08-23T13:50:29.693
> 
> 标签：c#, visual-studio-2010, compilation, dependencies, manifest

由于对 log4net 强大的命名和版本控制感到非常头疼，即旧的 1.2.10 名称，新的 1.2.11 名称，以及（上帝保佑我）SAP 制作的 1.2.10 并以自己的强大功能推入 GAC名字，我的应用程序将拒绝在除我自己的机器之外的任何机器上运行。它一直在寻找不存在的强命名 SAP 版本的 1.2.11 版本。

由于我的项目中没有任何东西是强命名的，我想阻止编译器寻找一个强命名的程序集，只加载我放在目录中的那个。由于它抱怨清单不匹配，我试图在我的项目中找到该版本和公钥的引用，但我做不到。似乎这个清单是在编译时创建的。

我怎样才能覆盖它？是否有一个属性或开关或条件编译可以用来准确指定我希望引用的程序集？

最终我想使用 1.2.11 版本的 log4net，并强制程序集忽略 GAC 中的版本，只查看本地 bin 目录。这真的不应该这么痛苦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:34:46.287

### 运行时指令

在运行时，当您不关心存在什么特定版本时，您可以使用它[`AppDomain.AssemblyResolve`](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)来解决**程序集版本控制**问题，您只想加载`/bin`文件夹中的内容。这段代码是[从这里获得灵感](http://dotnetfriendly.blogspot.com/2010/08/how-to-load-assembly-and-its-references.html)而创建的。

```
string[] ignoreAssembyVersions = new string[] { "log4net" };
AppDomain.CurrentDomain.AssemblyResolve += (_, assembly) =>
{
    //ignore the vesion number and return any version that has been loaded
    var name = new AssemblyName(assembly.Name);
    var shortName = name.Name; // retrieve short name
    if (ignoreAssembyVersions.Contains(shortName)) // compare against list of assemblies we ignore revisions for
    {
        // check if this assembly is already loaded under a different version #
        Assembly[] allAss = AppDomain.CurrentDomain.GetAssemblies();
        List<Assembly> list = new List<Assembly>(allAss);
        var loadedAssembly = list.Find(ass => new AssemblyName(ass.FullName).Name == shortName); // check if we have any version loaded yet
        if (loadedAssembly != null)
            return loadedAssembly;
        else // assembly has not yet been loaded in this domain
        {   // probe for assembly by name
            Assembly probedAssembly = Assembly.LoadFrom(string.Format("{0}.dll", shortName)); // probe for any match on assembly.dll 
            return probedAssembly;
        }
    }
    return null; // ignore binding failure -> pass up the stack
}; 
```

处理`AssemblyResolve`事件的另一种方法是[使用自定义`bindingRedirect`策略](http://msdn.microsoft.com/en-us/library/7wd6ex19.aspx)。但是 - 这仅在您知道`/bin`应用程序域中存在或当前加载的版本时才有效。

### 构建时指令

如果您想控制[在构建时使用哪个程序集版本](http://blogs.msdn.com/b/irenak/archive/2005/12/13/503105.aspx)，您可以使用[`Specific Version='true'`](https://stackoverflow.com/a/3298831/175679)添加的程序集引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T13:56:14.190

我希望我已经理解了你的问题。您可以考虑使用[dependentAssembly](http://msdn.microsoft.com/en-us/library/0ash1ksb.aspx)配置来支持每个程序集的自定义绑定策略和程序集位置。这是我用于查找另一个版本的程序集的配置策略的快照`System.Data.SQLite`

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Data.SQLite" publicKeyToken="db937bc2d44ff139" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.0.81.0" newVersion="1.0.81.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

# floating-point - .6 x 100 给出结果为 60.00004 而不是 60

> ID：12093175
> 
> 赞同：-1
> 
> 时间：2012-08-23T13:50:34.717
> 
> 标签：floating-point, multiplication

> **可能重复：**
> [乘以 100 时出现神秘的计算错误](https://stackoverflow.com/questions/6486234/mysterious-calculation-error-when-multiply-by-100)

这是我面临的一个奇怪的问题。我将值 .6 存储到浮点变量中。当我将它乘以 100 时，我得到的答案是错误的 60.000004。这个 .000004 是从哪里来的？这是我的代码

```
 ```
NSlog(@"%f",self.dataHandler.correctPercentage * 100);
if (self.obj.percentage >= (self.dataHandler.correctPercentage * 100) )
{
    //Do something
} 
``` 我存储在 self.dataHandler.correctPercentage 中的值是 0.6。但是当我 NSlog 时，我得到 60.000004。由于这个原因，我的边界条件出错了。

为什么会这样？

            回答 #1

赞同：6

时间：2012-08-23T13:54:12.927

这是一个舍入误差。数字以二进制而不是十进制存储。可以精确编码为有限个二进制数字的分数与可以精确编码为十进制的分数不同。

对于十进制问题的示例，请考虑 1/3。如果我将 1/3 编码为 0.333，则 (1/3)*3 = 0.999。二进制也有同样的问题。

如果您需要以十进制形式准确编码十进制数字，那么您应该使用`NSDecimalNumber`为此设计的。

            回答 #2

赞同：1

时间：2012-08-23T13:54:56.087

计算机无法保存大多数浮点数而不会出现舍入错误。这有几个含义，尤其是对于相等性检查——因为浮点数往往不相等，即使纯数学会让你这么认为。

在数学中，数字有不定式存储空间，可以使用不定式数字。但是计算机无法处理无穷大，因为它的资源有限。

你应该阅读[每个计算机科学家应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)（至少前几段）

我昨天还查看了一个遇到类似问题的代码：[https ://codereview.stackexchange.com/questions/14911/is-there-a-better-way-of-showing-an-image-based-on-the-电池电量/14961#14961](https://codereview.stackexchange.com/questions/14911/is-there-a-better-way-of-showing-an-image-based-on-the-battery-level/14961#14961)

            回答 #3

赞同：-1

时间：2012-08-23T14:02:08.470

%f，浮点变量在点后存储 6 个值。当计算机需要处理浮点数时，它会将它们扔给算术协处理器，并且在使用浮点数时会产生一些影响。

要获得准确答案，请将其转换为 Int 或使用显式舍入函数或浮点蕴涵求解算法。最好的一个取决于您的应用程序。

关于 Objective-C，您可以使用 NSDecimalNumber。

```

# delphi - 如何检查传递的参数是否是类？

> ID：12093176
> 
> 赞同：4
> 
> 时间：2012-08-23T13:50:33.827
> 
> 标签：delphi, class, vmt

我有功能（用 Delphi 7 32 位编写）：

```
函数 GetVMTAddr(var C): 整数；
开始
  结果：=整数（C）；
  尝试
    PVmt(结果)^.SelfPtr := PVmt(C)^.SelfPtr;
  除了
    结果：= 0；
  结尾;
结尾;
```

它返回 VMT 地址（我认为它是 VMT，我不确定）并检查参数是否是一个对象（通过`try...except`，这是恕我直言的糟糕解决方案）。
我有两个问题：
1）这真的是 VMT 地址还是我错了？
2）有没有更好的解决方案来检查参数是一个对象？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T14:05:53.723

`C`如果您传递给它的是类引用（又名元类），则该参数将保存一个 VMT 地址。

您在函数中检查的条件是无用的。它检查某个内存区域是否可写，仅此而已。如果您正在*检查*该`SelfPtr`字段是否等于该值本身，那么您会更接近。像这样的东西：

```
if PVmt(C).SelfPtr = C then
  Result := C; 
```

您要问的问题与几年前在这里提出的问题非常相似，有人想知道[如何检测变量的类型](https://stackoverflow.com/q/554100/33732)。正如我当时解释的那样，如果您认为您需要使用此代码，那么您已经遇到了麻烦。返回并更改您的设计，这样您就可以*知道*您是否有类引用或对象引用，而不必猜测。

如果你真的要猜，那么你可以尝试使用 JCL 提供的功能，`IsClass`并且`IsObject`. 他们做同样的猜测，你的代码试图使用，但他们做对了。

# asp.net-mvc - ASP.NET MVC 4 - API 路由 - 在 URL 中指定操作

> ID：12093182
> 
> 赞同：2
> 
> 时间：2012-08-23T13:50:51.353
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-web-api

我有一个用 ASP.NET MVC 4 框架编写的 Web 服务。它的基本 CRUD 操作可以很好地映射到 REST 动词，但是我需要添加一个不需要添加的操作。

什么是正确的方法来指定有时在 URL 末尾传递一个 ID 的能力，你知道这将是一个 Integer 类型，有时它是一个“动作”，一个 String 类型，后跟一个斜杠和一个 int ID？需要有关正确路由器地图的帮助。

想法？注意：我更关心 WebAPI，而不是 100% REST。

示例 URL
// GET 小部件列表
[http://somedomain.com/api/widget](http://somedomain.com/api/widget)
// GET 特定小部件
[http://somedomain.com/api/widget/1](http://somedomain.com/api/widget/1)
// POST - 对特定小部件执行特殊操作 - 提升
[http://somedomain.com/api/widget/promote/1](http://somedomain.com/api/widget/promote/1)

这是处理它的正确方法吗？

```
 routes.MapHttpRoute(  
            name: "DefaultApi",  
            routeTemplate: "api/{controller}/{id}",  
            defaults: new { id = RouteParameter.Optional }  
        );  

        routes.MapHttpRoute(  
            name: "DefaultApiExtended",  
            routeTemplate: "api/{controller}/{action}/{id}"  
        ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T15:04:22.850

我会尝试将第二个模式*（“操作”一个字符串类型，后跟一个斜杠和一个 int ID）*置于比*（在 URL 末尾传递一个您知道将是整数类型的*ID）更高的优先级.

```
routes.MapHttpRoute(
            name: "ActionWithId",
            routeTemplate: "api/widget/{action}/{id}"
        );

routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        ); 
```

您的操作和您的 ID 不是您所期望的那样可选。如果没有匹配，DefaultApi 规则应该接管处理。

编辑：

只是想，如果您确实希望它是“RESTy”，那么您可以随时切换 ID，因此对于这个小部件，使用这个 ID，执行这个操作。

```
routes.MapHttpRoute(
        name: "ActionWithId",
        routeTemplate: "api/widget/{id}/{action}"
    ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T15:10:39.983

看看[http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api) - 特别是“按动作名称路由”部分

[建议从http://somedomain.com/api/widget/promote/1](http://somedomain.com/api/widget/promote/1) 到 [http://somedomain.com/api/widgets/1/promote](http://somedomain.com/api/widgets/1/promote)进行轻微更改

（如果可能，请使用复数 widget*s*）

您的控制器将需要如下所示：

```
public class WidgetsController : ApiController
{
    [HttpPost]
    /// POST api/widgets/1/promote
    public void Promote(int id)
    {

    }

    // GET api/widgets/1
    public string Get(int id)
    {
        return "value";
    }

} 
```

和路线：

```
public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );

        routes.MapHttpRoute(
           name: "DefaultPromoteActionApi",
           routeTemplate: "api/{controller}/{id}/{action}",
           defaults: new { action = "Promote" }
       );
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:20:03.900

看看[AttributeRouting](https://github.com/mccalltd/AttributeRouting)；它应该能够轻松地做到这一点。

# ios - 在 Ipad2 上运行的应用程序崩溃，没有任何异常

> ID：12093191
> 
> 赞同：0
> 
> 时间：2012-08-23T13:51:04.597
> 
> 标签：ios, ipad, crash

我制作了一个在 iPad 上运行的应用程序。当我在模拟器上启动应用程序时，我没有收到任何错误，但如果我想在某些 iPad 上运行它，它会崩溃而没有任何错误。此外，崩溃仅在 iPad 上随机发生。我的意思是有时它在第二次尝试时崩溃，有时在第五次或第九次时崩溃。为什么会发生这种情况？

# javascript - 如何创建一个 jQuery 函数（一个新的 jQuery 方法或插件）？

> ID：12093192
> 
> 赞同：219
> 
> 时间：2012-08-23T13:51:04.067
> 
> 标签：javascript, jquery, function

我知道在 JavaScript 中的语法如下：

```
function myfunction(param){
  //some code
} 
```

有没有办法在 jQuery 中声明一个可以添加到元素的函数？例如：

```
$('#my_div').myfunction() 
```

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2012-08-23T13:59:26.870

从[文档](http://docs.jquery.com/Plugins/Authoring)：

```
(function( $ ){
   $.fn.myfunction = function() {
      alert('hello world');
      return this;
   }; 
})( jQuery ); 
```

然后你做

```
$('#my_div').myfunction(); 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2012-08-23T14:17:48.473

尽管您已经收到了所有答案，但值得注意的是，您无需编写插件即可在函数中使用 jQuery。当然，如果它是一个简单的一次性功能，我认为编写一个插件是矫枉过正的。**只需将选择器作为参数传递给函数，**就可以更容易地完成。您的代码将如下所示：

```
function myFunction($param) {
   $param.hide();  // or whatever you want to do
   ...
}

myFunction($('#my_div')); 
```

*请注意，`$`变量名`$param`中的 不是必需的。我的一个习惯是让我很容易记住该变量包含一个 jQuery 选择器。你也可以使用`param`。*

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-08-23T13:57:51.157

虽然那里有**大量**的文档/教程，但您的问题的简单答案是：

```
// to create a jQuery function, you basically just extend the jQuery prototype
// (using the fn alias)

$.fn.myfunction = function () {
    // blah
}; 
```

在该函数内部，`this`变量对应于您调用函数的 jQuery 包装集。所以像：

```
$.fn.myfunction = function () {
    console.log(this.length);
};

$('.foo').myfunction(); 
```

... 将向控制台刷新该类的元素数量`foo`。

当然，语义还有比这更多的内容（以及最佳实践和所有爵士乐），因此请务必阅读它。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-08-23T14:00:00.130

为了让一个函数在 jQuery 对象上可用，你将它添加到 jQuery 原型中（fn 是 jQuery 中原型的快捷方式），如下所示：

```
jQuery.fn.myFunction = function() {
    // Usually iterate over the items and return for chainability
    // 'this' is the elements returns by the selector
    return this.each(function() { 
         // do something to each item matching the selector
    }
} 
```

这通常称为[jQuery 插件](http://docs.jquery.com/Plugins/Authoring)。

示例 - [http://jsfiddle.net/VwPrm/](http://jsfiddle.net/VwPrm/)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-08-23T13:58:18.970

```
$(function () {
    //declare function 
    $.fn.myfunction = function () {
        return true;
    };
});

$(document).ready(function () {
    //call function
    $("#my_div").myfunction();
}); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-08-23T13:56:34.850

是的——你描述的是一个 jQuery 插件。

要编写 jQuery 插件，您需要在 JavaScript 中创建一个函数，并将其分配给 object 的一个属性`jQuery.fn`。

例如

```
jQuery.fn.myfunction = function(param) {
    // Some code
} 
```

在您的插件函数中，`this`关键字设置为调用插件的 jQuery 对象。所以，当你这样做时：

```
$('#my_div').myfunction() 
```

然后`this`inside`myfunction`将被设置为返回的 jQuery 对象`$('#my_div')`。

有关完整故事，请参阅[http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-06-27T16:40:15.483

您还可以使用**扩展**（创建 jQuery 插件的方式）：

```
$.fn.extend(
{
    myfunction: function () 
    {
    },

    myfunction2: function () 
    {
    }
}); 
```

用法：

```
$('#my_div').myfunction(); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-08-23T13:57:31.463

您可以编写自己的 jQuery 插件（可以在选定元素上调用的函数），如下所示：

```
(函数($){
    $.fn.myFunc = 函数（参数 1，参数 2）{
        //this - jquery 对象保存您选择的元素
    }
})( jQuery );
```

稍后调用它，如：

```
$('div').myFunc(1, null);
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-08-23T13:53:06.343

是的，您应用于使用 jquery 选择的元素的方法称为 jquery 插件，并且在 jquery 文档中有[大量关于创作的信息。](http://docs.jquery.com/Plugins/Authoring)

值得注意的是，jquery*只是*javascript，因此“jquery 方法”没有什么特别之处。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-09-26T14:18:05.700

创建一个“着色”方法：

```
$.fn.colorize = function custom_colorize(some_color) {
    this.css('color', some_color);
    return this;
} 
```

用它：

```
$('#my_div').colorize('green'); 
```

这个简单的示例结合了jQuery 文档中的[How to Create a Basic Plugin的精华，以及来自](https://learn.jquery.com/plugins/basic-plugin-creation/)[@Candide](https://stackoverflow.com/a/12093389/673991)和[@Michael](https://stackoverflow.com/a/12093344/673991)的答案。

*   [命名函数表达式](https://stackoverflow.com/q/15336347/673991)可以改善堆栈跟踪等。
*   返回的自定义方法`this` [可能是链式](https://stackoverflow.com/a/37992692/673991)的。（感谢@Potheek。）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-11-27T20:11:53.047

你总是可以这样做：

```
jQuery.fn.extend({
   myfunction: function(param){
       // code here
   },
});
OR
jQuery.extend({
   myfunction: function(param){
       // code here
   },
});
$(element).myfunction(param); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-08-23T13:59:55.443

听起来你想通过它的原型来扩展 jQuery 对象（也就是[写一个 jQuery 插件](http://docs.jquery.com/Plugins/Authoring)）。这意味着通过调用 jQuery 函数 ( `$(selector/DOM element)`) 创建的每个新对象都将具有此方法。

这是一个非常简单的例子：

```
$.fn.myFunction = function () {
    alert('it works');
}; 
```

[演示](http://jsfiddle.net/hmJNa/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-03-15T11:53:14.727

在 jQuery 中创建任何函数的最简单示例是

```
jQuery.fn.extend({
    exists: function() { return this.length }
});

if($(selector).exists()){/*do something here*/} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-06T13:36:39.347

```
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Define a function in jQuery</title>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
$(document).ready(function() {
    $.fn.myFunction = function() { 
        alert('You have successfully defined your function!'); 
    }
    $(".call-btn").click(function(){
        $.fn.myFunction();
    });
});
</script> 
</head>
<body>
    <button type="button" class="call-btn">Click Here</button>
</body>
</html> 
```

# windows - Clozure 常见的口齿不清。如何在windows上列出子目录？

> ID：12093200
> 
> 赞同：2
> 
> 时间：2012-08-23T13:51:43.700
> 
> 标签：windows, lisp, ccl

我的文件夹是这样的

```
c:/bar/
c:/bar/dir1
c:/bar/dir2
c:/bar/00.txt
c:/bar/02.txt 
```

我可以列出文件

```
(directory "c:/bar/*.*")
(#P"c:/bar/00.txt" #P"c:/bar/01.txt") 
```

但在列出子目录时遇到问题

```
(directory "c:/bar/*")
NIL

(directory "c:/bar/*/")
NIL 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:10:31.350

`:directories t`在 CCL 中使用：

```
(directory "C:/bar/*.*" :directories t) 
```

但是，如果你想编写独立于实现的代码（例如你想共享的库），你可能应该听从 Vsevolod 的建议，并使用像`cl-fad`.

# c++ - 在小代码中查找段错误

> ID：12093203
> 
> 赞同：1
> 
> 时间：2012-08-23T13:51:47.227
> 
> 标签：c++, cuda, thrust

我无法在这个简短的 cuda 代码中找到分段错误的来源。我正在使用它来测试 Thrust 库与 STL 库对整数进行排序的排序速度。我正在传递要作为命令行参数排序的双精度数组的大小。

这是代码

```
inline void check_cuda_error(char *message)

    {
      cudaThreadSynchronize();
      cudaError_t error = cudaGetLastError();
      if(error != cudaSuccess)
      {
        printf("CUDA error after %s: %s\n", message, cudaGetErrorString(error));
      }
    }

            int main(int argc, char *argv[])
        {
          int  N = atoi(argv[1]);
          double* h = new double[N];
          for (int i = 0; i < N; ++i)
            {
              h[i] = (double)rand()/RAND_MAX; //std::cout << h[i] << " " ;
            }

          clock_t start , stop;

          std::cout << std::endl;

          // Start timing
          start = clock();
          std::sort(h, h+N);
          stop  = clock();  
          std::cout << "Host sorting took " << (stop - start) /(double)CLOCKS_PER_SEC << std::endl ; 

          // Start the GPU work. Initialize to random numbers again.
          for (int i = 0; i < N; ++i)
            {
              h[i] = (double)rand()/RAND_MAX; //std::cout << h[i] << " " ;
            }
          double* d = 0; 
          const size_t num_bytes = N * sizeof( double ); 
          cudaMalloc((void**)&d, num_bytes);
          check_cuda_error("Memory Allocation"); 

          cudaMemcpy(d ,h , N * sizeof(double), cudaMemcpyHostToDevice); // Transfer data
          thrust::sort( d, d+ N ) ;
            return 0;
        } 
```

我收到以下错误

```
[BeamerLatex/Farber]$ nvcc -arch=sm_20 sortcompare.cu  ; ./a.out 16777216

Host sorting took 3.77
[1]    4661 segmentation fault  ./a.out 16777216
[BeamerLatex/Farber]$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:10:54.230

似乎您不能在原始指针上运行推力：：排序，您需要`device_ptr`先将其转换为，即：

```
thrust::device_ptr< double > dv = thrust::device_pointer_cast(d);
thrust::sort( dv, dv+ NN ) ; 
```

这对我来说很好。

# java - 实体无法保存外键实体

> ID：12093221
> 
> 赞同：1
> 
> 时间：2012-08-23T13:52:29.277
> 
> 标签：java, jpa

我`Content`有一个 Map `Footnote`，并且`Footnote`有一`content_id`列是返回的外键`Content`。不幸的是`Content`，使用`footnoteMap`包含 a保存我`Footnote`会引发以下错误：

```
ERROR: Cannot insert the value NULL into column 'content_id', table 'CMT_DEV.dbo.footnote'; column does not allow nulls. INSERT fails.
SEVERE: org.springframework.dao.DataIntegrityViolationException: Cannot insert the value NULL into column 'content_id', table 'CMT_DEV.dbo.footnote'; column does not allow nulls. INSERT fails.; SQL [n/a]; constraint [null]; nested exception is org.hibernate.exception.ConstraintViolationException: Cannot insert the value NULL into column 'content_id', table 'CMT_DEV.dbo.footnote'; column does not allow nulls. INSERT fails. 
```

我必须缺少使这项工作所需的注释，但我无法弄清楚它是什么。

这是我的 JPA 映射：

```
public class Content implements EntityModel, Serializable {
    @OneToMany(mappedBy="contentId", cascade=CascadeType.ALL)
    @MapKey(name="number")
    @OrderBy("number ASC")
    private Map<Integer, Footnote> footnoteMap;

    ....
}

public class Footnote implements EntityModel, Serializable {
    @ManyToOne(cascade=CascadeType.ALL)
    @JoinColumn(name = "content_id", referencedColumnName= "id")
    private Content contentId;

    ....
} 
```

*** 更新 ***

请记住，在`Footnote`添加 a 时，内容项尚未保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:36:39.107

首先，请注意，您有责任将双向关系的双方保持在一致状态，即当您添加 a 时`Footnote`，`Content`您也应该适当地设置它`contentId`。

如果您这样做了但仍然失败，那么可能是数据库模式和 Hibernate 映射之间不匹配。请注意，`content_id`列有一个非空约束，但映射中没有任何内容告诉 Hibernate 存在这样的约束。试试`@ManyToOne(cascade=CascadeType.ALL, optional = false)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:43:16.033

你需要有这样的东西......

```
public void addFootnote(Footnote footnote) {
    if (footnote == null) {
        throw new IllegalArgumentException("Null argument not allowed");
    }
    footnote.setContent(this);
    footNoteMap.put(<KEY_OF_MAP>, footnote);
} 
```

例如，这将确保`content`已填充`Footnote`。

# restkit - Restkit 集成的理想 JSON API 格式是什么？

> ID：12093223
> 
> 赞同：1
> 
> 时间：2012-08-23T13:52:32.843
> 
> 标签：restkit

有没有我可以观看/尝试的模型 API，它与 RestKit 最容易集成（使用最多的默认值）？我说的是 JSON 格式（是否有根，嵌套对象等）以及 POST 之后的预期答案，例如......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T18:01:11.703

我能找到的最好的资源是这里的这篇文章，它通过示例进行教学：

[https://github.com/RestKit/RestKit/blob/master/Docs/Object%20Mapping.md](https://github.com/RestKit/RestKit/blob/master/Docs/Object%20Mapping.md)

从您的模型中表示记录的基本格式似乎类似于：

```
{
    "recordType": {
        "attribute1": "value1",
        "attribute2": "value2",
        "attribute3": "value3"
    }
} 
```

如果您有记录集合，请使用 Javascript 数组，如下所示： [ {...}, {...} ]

该文章还建议采用这种形式，即：

```
{
    "recordType": [
        {
            "attribute1": "value1",
            "attribute2": "value2",
            "attribute3": "value3"
        },
        {
            "attribute1": "value1",
            "attribute2": "value2",
            "attribute3": "value3"
        }
    ]
} 
```

我想你可以映射两种方式。

这个问题可能会有所帮助： [JSON 格式不一致](https://stackoverflow.com/questions/7561730/json-format-inconsistency)

# html - 我的代码中出现未知错误

> ID：12093227
> 
> 赞同：0
> 
> 时间：2012-08-23T13:52:40.510
> 
> 标签：html, css

我错误地使用了这行代码

```
 <style type="text/css"> 
```

进入我的 Top_menu.css 文件（由复制和过去引起）并忘记将其删除。现在当我想删除我所有的代码时会崩溃！！！这是我的 Top_menu.css 文件：

```
 <style type="text/css">
        #centeredmenu {
           float:left;
           width:700px;
           background:#fff;

           overflow:hidden;
           position:relative;

        }
        #centeredmenu ul {
           clear:left; 
           float:left;
           list-style:none;
           margin:0;
           padding:0;
        margin-left:330px;
        margin-top:72px;
           text-align:center;
        }
        #centeredmenu ul li {
           display:block;
           float:left;
           list-style:none;
           margin:0 10px 0 10px;

           padding:0;
           position:relative;

        }
        #centeredmenu ul li a {
           display:block;
           margin:0 0 0 1px;
           padding:20px 10px;

           color:#000;
           text-decoration:none;
           line-height:1.3em;
           border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        }
        #centeredmenu ul li a:hover {
           background:#369;
           background:#212121;
           color:#fff;
           padding-top:15px;
        }
        #centeredmenu ul li a.active,
        #centeredmenu ul li a.active:hover {
           color:#fff;
           background:#212121;
           font-weight:bold;
           padding-top:15px;

        }
        #spread
        {
            position:relative;
            top:128px;

            width:955px;
            height:340px;
            background-color:#212121;
        } 
```

这是我的 style.css 文件：

```
 @charset "utf-8";
    /* CSS Document */
    @import 'reset.css';
    body
    {background:#e8e8e8   url(../images/Back.png) top repeat-x;

    }
    #outer
    {
        width:955px;
        height:1200px;
        margin:0 auto;

    }
    #header
    {
            background:url(../images/header.png) top  no-repeat;
            height:143px;

    }
    #logo h1
    {
        text-indent:-9999px;

    }
    #main_content
    {   
        margin-top:128px;
        height:400px;
        background-color:#ffffff;

    }
        #left_side {width:550px; height:auto; float:left; }
        #left_side h2
        {

            font-size:30px;
            color:#2d5a65;
            padding-top:30px;
            padding-left:30px;

        }
        #left_side span
        {

            font-size:12px;
            font-style:italic;
            color:#bbbaba;
            padding-left:30px;
        }
        #left_side h4
        {

            font-size:12px;
            font-weight:bold;
            color:#6f6f6f;  
            padding-top:30px;
            padding-left:30px;
        }
        #left_side div
        {
                font-size:12px;

            color:#6f6f6f;  
            padding-top:30px;
            padding-left:30px;
            line-height:20px;
        }
        #left_side a
        {
            font-size:12px;

            color:#6f6f6f;  
            padding-top:40px;
            padding-left:30px;
            text-decoration:none;
        }   
        #right_side
        {
            background-color:#f6f6f6;
            width:295px;
            height:300px;
            border:15px solid #e7e7e7;
            float:right;

            margin-top:30px;
            margin-right:40px;

        }
        #inside_right{ height:250px; margin:20px 10px 20px 10px; }
        #inside_right span
        {
            font-size:18px; color:#7c7c7c; 
        }
        #inside_right hr{width:200px; color:#dadada; margin-top:20px;}
        #inside_right img{padding-top:30px; padding-right:10px; float:left;}
        #inside_right div{width:250px; padding-top:25px; line-height:22px; height:150px; font-size:12px;}
        #inside_right a{font-size:12px; font-weight:bold; text-decoration:none; color:#6d6d6d; float:right; padding-right:10px;}

    /*Above footer*/
    #above_footer{height:300px; border-top:10px #5a5a5a solid; border-bottom:10px #666666 solid; background-color:#656565;}
        #f_left{width:230px; height:250px; margin-left:20px; margin-top:20px; float:left;}
        #f_center{width:230px; height:250px;margin-left:100px; margin-top:20px; float:left; ;}
        #f_right{width:230px; height:250px; margin-right:20px; margin-top:20px;  float:right; }
        .header_footer{font-size:20px; color:#ffffff; font-style:italic; margin-bottom:15px;}
        .bold_footer{font-size:11px; color:#ffffff; font-weight:bold; padding-top:10px; clear:left;}
        .reg_footer{font-size:11px; color:#FFF; line-height:15px; padding-top:5px; clear:left;  }
        .footer_line{width:200px; float:left; }
    #below_footer{background-color:#1a1a1a; height:50px;}
        .footer_color{color:#989898; font-size:11px;}
        #copy{  padding:20px; float:left;}
        /*footer menu*/
        #below_footer ul{float:right; padding:20px;}
        #below_footer ul li{float:left; }
        #below_footer ul li a{ text-decoration:none; color:#989898; padding-left:2px; padding-right:2px;} 
```

这是我的html文件：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Untitled Document</title>
            <link rel="stylesheet" href="css/Top_menu.css" />
            <link rel="stylesheet"  href="css/style.css" />
        </head>

        <body>
        <div id="outer">
            <div id="header">
                <div id="logo">
                    <h1>cleanfolio</h1>
                </div><!--End Logo-->
                <div id="centeredmenu">
                    <ul>
                    <li><a href="#" class="active"  >Home</a></li>
                    <li><a href="#" >portfolio</a></li>
                    <li><a href="#" >blog</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Service</a></li>
                    <li><a href="#">Contact Us</a></li>
                  </ul>
                </div>  <!-- end Center menu-->
                 <div id="spread">
                  </div> <!-- End Spread -->

                <div id="content">
                    <div id="main_content">
                        <div id="left_side">
                            <h2>Welcome to our company</h2>
                            <span>Lorem Ipsum is simply dummy text of the printing and typesetting</span>
                            <h4>
                            It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.</h4> 
                           <div>
            It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus 
            PageMaker including versions of Lorem Ipsum.<br/><br/>

            It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using 'Content here, content here', making it look like readable English. 

                            </div><!--end div-->
                            <a href="#">Read More>></a>
                         </div><!--End Left_side-->

                        <div id="right_side">
                            <div id="inside_right">
                                <span>Testimonials:</span>
                                <hr />
                                <img src="images/unknown.png" alt="unknown"/>
                                <div>It is a long established fact that a        
                           reader will be distracted by the readable content of a page when looking at its layout. Content here, content here', making it look like readable English."</div><!--End Div-->
                                 <a href="#">-John Smith, webdesigner</a>
                            </div><!--End Inside right-->
                        </div><!--End right_side -->
                    </div> <!--end main_content-->
                </div><!--End Content-->
            </div><!--End Header-->
            <div id="above_footer">
                <div id="f_left">
                    <div class="header_footer">Events &lt; Updates</div>
                    <hr class="footer_line" />
                    <div class="bold_footer">
                      Posted on 20 May 09
                    </div><!--end div class bold footer-->
                    <div class="reg_footer">Listuem Names ligula a blandit ornare ligula a quis bibendum elit anten ecm etus blandit
                    </div><!--End Div with class reg_footer-->
                     <hr class="footer_line" />
                     <div class="bold_footer">
                      Posted on 24 May 09
                     </div><!--end div with bold footer class-->
                     <div class="reg_footer">
                     Nulla elit porttitor tellus quis bibendum elit ante nec metus.
                    </div><!--end reg footer class-->
                    <hr class="footer_line" />
                </div><!--End Footer left-->
                <div id="f_center">
                        <div class="header_footer">What We Do</div><!--End header footer-->
                        <hr class="footer_line" />

                        <div class="bold_footer">
                                It has survived not only five centuries, but also 
                        the leap into electronic typesetting, remaining essentially unchanged. 
                        </div><!--End bold footered class-->
                        <br />
                        <div class="reg_footer">
                        It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, 
                        and more recently with desktop publishing software 
                        like Aldus PageMaker including versions of Lorem 
                        Ipsum.
                        </div><!--End reg footer-->
                </div><!--End Footer center-->
                <div id="f_right">
                    <div class="header_footer">Get in touch!</div><!--End header_footer class-->
                     <hr class="footer_line" />
                     <div class="reg_footer">
                Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                 </div><!--End reg_footer-->
                    <hr class="footer_line" />
                    <div class="bold_footer">+123456789</div><!--End bold one-->
                    <div class="bold_footer">+123456789</div><!--End bold one-->
                    <div class="bold_footer">company@domainname.com</div><!--End bold one-->
                </div><!--End Footer right-->
            </div><!--End Above footer-->
            <div id="below_footer">
                <div id="copy" class="footer_color">© Copyright 2009\. Your Site Name Dot Com.</div><!--End copy -->
                <ul class="footer_color">
                    <li>All Rights Reserved      </li>
                    <li><a href="#">Home</a><samp>|</samp></li>
                    <li><a href="#">Contact</a><samp>|</samp></li>
                    <li><a href="#">RSS</a></li>
                </ul>
            </div><!--End Below footer-->
        </div> <!--End outer-->
        </body>
        </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:57:05.390

该行不应该在 css 文件中。`<link rel="stylesheet" type="text/css" href="Top_menu.css" />`你应该在你的主 html 文件中包含你的 css 文件`<head>`和`</head>`.

# xslt - XSLT 在 for 循环中转换为多种复杂类型

> ID：12093231
> 
> 赞同：0
> 
> 时间：2012-08-23T13:52:53.510
> 
> 标签：xslt, xsd

我需要使用以下结构转换 XML

```
<CustomerStatements>
 <CustomerStatement>
  <Name>ABC</Name>
  <ID>1</ID>
  <Amt>10</Amt>
 </CustomerStatement>
 <CustomerStatement>
  <Name>ABC</Name>
  <ID>1</ID>
  <Amt>20</Amt>
 </CustomerStatement>
 <CustomerStatement>
  <Name>XYZ</Name>
  <ID>2</ID>
  <Amt>30</Amt>
 </CustomerStatement>
 <CustomerStatement>
  <Name>XYZ</Name>
  <ID>2</ID>
  <Amt>40</Amt>
 </CustomerStatement>
</CustomerStatements> 
```

至

```
<Customers>
 <Customer>
  <Name>ABC</Name>
  <Id>1</Id>
  <Amounts>
   <Amount>10</Amount>
   <Amount>20</Amount>
  </Amounts>
 </Customer>
 <Customer>
  <Name>XYZ</Name>
  <Id>2</Id>
   <Amount>30</Amount>
   <Amount>40</Amount>
 </Customer>
</Customers> 
```

我尝试使用 for 循环并将名称放入变量中以比较下一条记录中的名称，但这不起作用。谁能帮我提供一个示例 XSLT psudo 代码。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:24:32.183

**I. 当这个 XSLT 1.0 解决方案时：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output omit-xml-declaration="no" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:key 
    name="kCustByNameId"
    match="CustomerStatement"
    use="concat(Name, '+', ID)" />

  <xsl:template match="/*">
    <Customers>
      <xsl:apply-templates 
        select="CustomerStatement[
          generate-id() = 
          generate-id(key('kCustByNameId', concat(Name, '+', ID))[1])]" />
    </Customers>
  </xsl:template>

  <xsl:template match="CustomerStatement">
    <Customer>
      <xsl:copy-of select="Name|ID" />
      <Amounts>
        <xsl:for-each select="key('kCustByNameId', concat(Name, '+', ID))/Amt">
          <Amount>
            <xsl:apply-templates />
          </Amount>
        </xsl:for-each>
      </Amounts>
    </Customer>
  </xsl:template>
</xsl:stylesheet> 
```

**...应用于 OP 的原始 XML：**

```
<CustomerStatements>
  <CustomerStatement>
    <Name>ABC</Name>
    <ID>1</ID>
    <Amt>10</Amt>
  </CustomerStatement>
  <CustomerStatement>
    <Name>ABC</Name>
    <ID>1</ID>
    <Amt>20</Amt>
  </CustomerStatement>
  <CustomerStatement>
    <Name>XYZ</Name>
    <ID>2</ID>
    <Amt>30</Amt>
  </CustomerStatement>
  <CustomerStatement>
    <Name>XYZ</Name>
    <ID>2</ID>
    <Amt>40</Amt>
  </CustomerStatement>
</CustomerStatements> 
```

**...产生了想要的结果：**

```
<?xml version="1.0" encoding="UTF-8"?><Customers>
  <Customer>
    <Name>ABC</Name>
    <ID>1</ID>
    <Amounts>
      <Amount>10</Amount>
      <Amount>20</Amount>
    </Amounts>
  </Customer>
  <Customer>
    <Name>XYZ</Name>
    <ID>2</ID>
    <Amounts>
      <Amount>30</Amount>
      <Amount>40</Amount>
    </Amounts>
  </Customer>
</Customers> 
```

这里首先要看的是[Muenchian Grouping](http://www.jenitennison.com/xslt/grouping/muenchian.html)，这是 XSLT 1.0 中普遍接受的对问题进行分组的方法。

**二、这是一个更紧凑的 XSLT 2.0 解决方案：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
   <xsl:output omit-xml-declaration="no" indent="yes"/>
   <xsl:strip-space elements="*"/>

   <xsl:template match="/*">
     <Customers>
       <xsl:for-each-group select="CustomerStatement" group-by="ID">
         <Customer>
           <xsl:copy-of select="current-group()[1]/Name|current-group()[1]/ID" />
           <Amounts>
             <xsl:for-each select="current-group()/Amt">
               <Amount>
                 <xsl:apply-templates />
               </Amount>    
             </xsl:for-each>
           </Amounts>
         </Customer>
       </xsl:for-each-group>
     </Customers>
   </xsl:template>      
</xsl:stylesheet> 
```

在这种情况下，请注意 XSLT 2.0 对[for-each-group](http://www.w3.org/TR/xslt20/#xsl-for-each-group)元素的使用，这消除了对有时冗长且可能令人困惑的 Muenchian Grouping 方法的需要。

# android - Android长按滚动

> ID：12093232
> 
> 赞同：2
> 
> 时间：2012-08-23T13:52:55.197
> 
> 标签：android, scroll, long-press

我想用滚动“连接”长按，所以用户不必释放屏幕并开始滚动。

我已经实现了手势检测器......

```
final GestureDetector gestureDetector = new GestureDetector(new GestureDetector.SimpleOnGestureListener() {
    public void onLongPress(MotionEvent e) {
        // action 1
    }

    public boolean onScroll(MotionEvent event1, MotionEvent event2, float velocityX, float velocityY) {
        // action 2
    }       
}

public boolean onTouchEvent(MotionEvent event) {
    return gestureDetector.onTouchEvent(event);
} 
```

但是现在在动作 1 和动作 2 之间，用户必须释放屏幕......如何在不释放屏幕的情况下连接这些动作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T09:20:21.750

我不认为a`GestureDetector`会做你想做的事，更有可能你必须自己做。我不知道您当前的设置，下面是一个与 a`OnToucListener`绑定的类`ScrollView`，它将考虑这两个事件：

```
public class ScrollTouchTest extends Activity {

    private final int LONG_PRESS_TIMEOUT = ViewConfiguration
            .getLongPressTimeout();
    private Handler mHandler = new Handler();
    private boolean mIsLongPress = false;
    private Runnable longPress = new Runnable() {

        @Override
        public void run() {         
            if (mIsLongPress) {             
                actionOne();
                mIsLongPress = false;
            }
        }

    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.views_scrolltouchtest);
        findViewById(R.id.scrollView1).setOnTouchListener(
                new OnTouchListener() {

                    @Override
                    public boolean onTouch(View v, MotionEvent event) {
                        final int action = event.getAction();
                        switch (action) {
                        case MotionEvent.ACTION_DOWN:
                            mIsLongPress = true;                            
                            mHandler.postDelayed(longPress, LONG_PRESS_TIMEOUT);
                            break;
                        case MotionEvent.ACTION_MOVE:
                            actionTwo(event.getX(), event.getY());
                            break;
                        case MotionEvent.ACTION_CANCEL:
                        case MotionEvent.ACTION_UP:
                            mIsLongPress = false;
                            mHandler.removeCallbacks(longPress);
                            break;
                        }
                        return false;
                    }
                });
    }

    private void actionOne() {
        Log.e("XXX", "Long press!!!");
    }

    private void actionTwo(float f, float g) {
        Log.e("XXX", "Scrolling for X : " + f + " Y : " + g);
    }

} 
```

# debugging - 我可以使用 JDebugTool 调试 Railo CFML 应用程序吗？

> ID：12093234
> 
> 赞同：1
> 
> 时间：2012-08-23T13:53:00.300
> 
> 标签：debugging, coldfusion, railo, cfml

[任何人都可以证明使用JDebugTool](http://www.debugtools.com/index.html)在 Railo 上调试 CFML 应用程序吗？我坚持使用 CF8 和 Eclipse 插件进行开发设置。所以所有的调试都是通过转储和中止完成的，有时我真的很想念正确的调试工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T16:44:15.407

我没有使用过 JDebugTool，但 ColdFusion 8+ 确实有一个可以在 Eclipse 中使用的内置调试器。[http://www.adobe.com/devnet/coldfusion/articles/debugger.html](http://www.adobe.com/devnet/coldfusion/articles/debugger.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T08:10:46.303

如果您愿意，可以查看[Fusion Debug 。](http://www.fusion-debug.com/fd/)与 Railo 一起工作就像一个魅力。

格特

# django - Django注册：注册新用户时出错

> ID：12093235
> 
> 赞同：1
> 
> 时间：2012-08-23T13:53:01.017
> 
> 标签：django, registration

我正在使用 django 注册。我已将其包含在我的项目中。当我尝试注册新用户时，我总是收到一条错误消息。我正在使用开发服务器（runserver）。

我想注册用户并发送激活电子邮件。这是错误：[Errno 10061] 无法建立连接，因为目标机器主动拒绝它位置：C:\Python27\lib\socket.py in create_connection，第 571 行

我想我必须对我的设置做点什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:19:04.073

这是一个生产环境还是只是一个开发环境？

如果是开发环境，可以使用基于文件的邮件后端：[https](https://docs.djangoproject.com/en/dev/topics/email/#file-backend) ://docs.djangoproject.com/en/dev/topics/email/#file-backend 。如果您使用此后端，您的电子邮件将被写入文件。您将能够使用文本编辑器阅读它们。

如果是生产环境，那么您必须正确设置 SMTP 服务器设置。

# java - 如何摆脱 iText XMLWorker 中的 Helvetica？

> ID：12093236
> 
> 赞同：5
> 
> 时间：2012-08-23T13:53:00.517
> 
> 标签：java, pdf, fonts, embed, itext

我们使用 iText 从 Java 代码生成 PDF 文件，这在大多数情况下运行良好。几天前，我们开始生成 PDF/A，而不是需要嵌入所有字体的普通 PDF 文件。iText主要是由我们直接控制字体`Document`的自定义和其他类构建的。`PdfPTable`所有使用的字体都是从通过以下代码加载的 TTF 文件创建的 - 效果很好：

```
 private BaseFont load(String path) {
        try {
            URL fontResource = PrintSettings.class.getResource(path);
            if (fontResource == null) {
                return null;
            }
            String fontPath = fontResource.toExternalForm();
            BaseFont baseFont = BaseFont.createFont(fontPath, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
            baseFont.setSubset(true);
            return baseFont;
        }
        catch (DocumentException ex) {
            Logger.getLogger(PrintSettings.class).warn("...");
        }
        catch (IOException ex) {
            Logger.getLogger(PrintSettings.class).warn("...");
        }
        return FontFactory.getFont(PrintSettings.FONT, "UTF-8", true, 8f, Font.NORMAL, PrintSettings.COLOR_TEXT).getBaseFont();
    } 
```

现在我们在从 HTML 代码生成的 PDF 中使用一种特定的内容类型。我们使用`XMLWorker`来处理那部分。这工作得很好，只要我们没有嵌入字体。但是对于 PDF/A，我们**需要嵌入所有字体，现在我们在与****Helvetica**使用的未知来源作斗争。

我们试图通过使用我们自己的**FontProvider**类来解决这个问题：

```
public class PrintFontProvider extends FontFactoryImp {

    @Override
    public Font getFont(String fontName, String encoding, boolean embedded, float size, int style, BaseColor color, boolean cached) {

        // LiberationSans – http://de.wikipedia.org/wiki/Liberation_(Schriftart) – http://scripts.sil.org/cms/scripts/page.php?item_id=OFL_web
        if (style == Font.NORMAL)     return new Font(this.load("fonts/Liberation/LiberationSans-Regular.ttf"),    size, Font.NORMAL, color);
        if (style == Font.BOLD)       return new Font(this.load("fonts/Liberation/LiberationSans-Bold.ttf"),       size, Font.NORMAL, color);
        if (style == Font.BOLDITALIC) return new Font(this.load("fonts/Liberation/LiberationSans-BoldItalic.ttf"), size, Font.NORMAL, color);
        if (style == Font.ITALIC)     return new Font(this.load("fonts/Liberation/LiberationSans-Italic.ttf"),     size, Font.NORMAL, color);
        return new Font(this.load("fonts/Liberation/LiberationSans-Regular.ttf"), size, style, color);
    }

    private BaseFont load(String path) { ... }
} 
```

它`XMLWorker`使用以下代码连接：

```
HtmlPipelineContext html = new HtmlPipelineContext(null);
html.setTagFactory(Tags.getHtmlTagProcessorFactory());
CSSResolver css = XMLWorkerHelper.getInstance().getDefaultCssResolver(true);

// We need to control the FontProdiver!
html.setCssAppliers(new CssAppliersImpl(new PrintFontProvider()));

Pipeline<?> pipeline = new CssResolverPipeline(css, new HtmlPipeline(html, new PdfWriterPipeline(this.document, writer)));
XMLWorker worker = new XMLWorker(pipeline, true);
XMLParser p = new XMLParser(worker);
p.parse(new ByteArrayInputStream(StringUtils.iTextHTML(string).getBytes())); 
```

大多数简单的 HTML 元素都以这种方式工作......但有些元素似乎忽略了 FontProvider 并继续使用不会嵌入到 PDF/A 中的**Helvetica （我们没有那种字体）。**例如`<ol><li>...</li></ol>`利用这个。

```
Caused by: com.itextpdf.text.pdf.PdfXConformanceException: All the fonts must be embedded. This one isn't: Helvetica
at com.itextpdf.text.pdf.internal.PdfXConformanceImp.checkPDFXConformance(PdfXConformanceImp.java:225)
at com.itextpdf.text.pdf.PdfWriter.addSimple(PdfWriter.java:2192)
at com.itextpdf.text.pdf.PdfContentByte.setFontAndSize(PdfContentByte.java:1444)
at com.itextpdf.text.pdf.PdfDocument.writeLineToContent(PdfDocument.java:1463)
at com.itextpdf.text.pdf.ColumnText.go(ColumnText.java:968)
at com.itextpdf.text.pdf.ColumnText.go(ColumnText.java:841)
at com.itextpdf.text.pdf.ColumnText.showTextAligned(ColumnText.java:1189)
at com.itextpdf.text.pdf.ColumnText.showTextAligned(ColumnText.java:1208)
at com.itextpdf.text.pdf.PdfDocument.flushLines(PdfDocument.java:1193)
at com.itextpdf.text.pdf.PdfDocument.newPage(PdfDocument.java:830)
at com.itextpdf.text.Document.newPage(Document.java:367) 
```

我现在已经没有如何摆脱 Helvetica 的想法了......现在尝试解决这个问题 8 多个小时......还有更多想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T11:09:25.537

我挖得更深了，从`OrderedUnorderedList`过去`ListItem`到`List`...

```
/**
 * Adds an <CODE>Element</CODE> to the <CODE>List</CODE>.
 *
 * @param   o       the element to add.
 * @return true if adding the object succeeded
 * @since 5.0.1 (signature changed to use Element)
 */
@Override
public boolean add(final Element o) {
    if (o instanceof ListItem) {
        ListItem item = (ListItem) o;
        if (this.numbered || this.lettered) {
            Chunk chunk = new Chunk(this.preSymbol, this.symbol.getFont());
            chunk.setAttributes(this.symbol.getAttributes());
            int index = this.first + this.list.size();
            if ( this.lettered )
                chunk.append(RomanAlphabetFactory.getString(index, this.lowercase));
            else
                chunk.append(String.valueOf(index));
            chunk.append(this.postSymbol);
            item.setListSymbol(chunk);
        }
        else {
            item.setListSymbol(this.symbol);
        }
        item.setIndentationLeft(this.symbolIndent, this.autoindent);
        item.setIndentationRight(0);
        return this.list.add(item);
    }
    else if (o instanceof List) {
        List nested = (List) o;
        nested.setIndentationLeft(nested.getIndentationLeft() + this.symbolIndent);
        this.first--;
        return this.list.add(nested);
    }
    return false;
} 
```

此代码指的`this.symbol.getFont()`是在类初始化时设置为未定义...

```
public class List implements TextElementArray, Indentable {

    [...]    

    /** This is the listsymbol of a list that is not numbered. */
    protected Chunk symbol = new Chunk("- "); 
```

我只是使用了另一个`Chunk`构造函数，它采用了`Font`我的一个，瞧……**解决**了。编号列表不再使用**Helvetica**而是我自己的正确嵌入的字体。

这花了我很多时间！另一种方法可能是实现一个自己的 TagProcessor ，`<ol>`但我们已经没有时间了。我会为此提交一个错误报告......我们会看看它是否得到更灵活的修复。

# perl - SQL-HY001 连接失败

> ID：12093240
> 
> 赞同：0
> 
> 时间：2012-08-23T13:53:09.777
> 
> 标签：perl, memory-management, odbc, dbd, pervasive-sql

我在 Ubuntu wheezy 64 位上使用 Perl 5.14.2。

我正在尝试连接到安装在 Windows 2008 机器上的 Pervasive SQL server v9.5。

我测试了与 isql 的连接，它工作正常，我使用以下命令进行了测试：

```
isql -v <db_name> 
```

我使用从 cpan 安装的 DBD:ODBC v1.39（最新版本）perl 模块。

我正在使用以下命令连接到 sql server：

```
use DBI;
my $db = DBI->connect('dbi:ODBC:Moked'); 
```

Moked 是在 odbc.ini 中的 unixodbc v2.2.14 中定义的连接名称。

# /etc/odbc.ini

```
[Moked]
Driver=PERVASIVE_ODBC
Description=Pervasive ODBC Interface: Moked
ServerName=<ip>:<port>
DBQ=MIDA
UID=
PWD=
OpenMode=0
PvTranslate= 
```

当我尝试使用上面显示的命令连接时，我收到错误 SQL-HY001，通过谷歌搜索我了解到它与内存分配有关，通常人们在查询时而不是在尝试连接时得到这些/

似乎 DBI 确实识别了连接，因为如果我键入不同的名称，例如“Moked2”，我会收到错误 SQL-IM002。

有任何想法吗？如何进一步调试此问题？任何有关该问题的信息将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T17:26:13.253

您收到内存分配错误，因为 PSQL v11 客户端无法可靠地连接到 PSQL v9.5 服务器。如果要使用 v11 客户端，还需要 v11 服务器。您可能能够在 Btrieve 级别上使用 v11 客户端，但在 ODBC 端，v9 和 v11 之间存在重大变化。

# jakarta-mail - 在代理服务器中发送 java 邮件

> ID：12093242
> 
> 赞同：4
> 
> 时间：2012-08-23T13:53:19.667
> 
> 标签：jakarta-mail

我正在尝试使用代理服务器中的 java 邮件 API 发送电子邮件。代码如下：

```
import java.security.Security;
import java.util.Date;
import java.util.Properties;
import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class GmailSender {

public static void main(String[] args) throws AddressException, MessagingException {

Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());
final String SSL_FACTORY = "javax.net.ssl.SSLSocketFactory";
// Get a Properties object
Properties props = System.getProperties();
props.setProperty("proxySet","true");
props.setProperty("socksProxyHost","192.168.1.103");
props.setProperty("socksProxyPort","3128");
props.setProperty("mail.smtp.host", "smtp.gmail.com");
props.setProperty("mail.smtp.socketFactory.class", SSL_FACTORY);
props.setProperty("mail.smtp.socketFactory.fallback", "false");
props.setProperty("mail.smtp.port", "465");

props.setProperty("mail.smtp.socketFactory.port", "465");
props.put("mail.smtp.auth", "true");
props.put("mail.debug", "true");
props.put("mail.store.protocol", "pop3");
props.put("mail.transport.protocol", "smtp");
final String username = "proxy_userName";
final String password = "proxy_password";
Session session = Session.getDefaultInstance(props,
new Authenticator(){
protected PasswordAuthentication getPasswordAuthentication() {
return new PasswordAuthentication(username, password);
}});

// -- Create a new message --
Message msg = new MimeMessage(session);

// -- Set the FROM and TO fields --
msg.setFrom(new InternetAddress("xxxxxxx@gmail.com"));
msg.setRecipients(Message.RecipientType.TO,
InternetAddress.parse("xxxxxxx@gmail.com",false));
msg.setSubject("Hello");
msg.setText("How are you");
msg.setSentDate(new Date());
Transport.send(msg);
System.out.println("Message sent.");
}
} 
```

当我运行此代码时，将显示以下消息。

```
DEBUG: JavaMail version 1.4.3
DEBUG: successfully loaded resource: /META-INF/javamail.default.providers
DEBUG: Tables of loaded providers
DEBUG: Providers Listed By Class Name: {com.sun.mail.smtp.SMTPSSLTransport=javax.mail.Provider[TRANSPORT,smtps,com.sun.mail.smtp.S    MTPSSLTransport,Sun Microsystems, Inc],  com.sun.mail.smtp.SMTPTransport=javax.mail.Provider[TRANSPORT,smtp,com.sun.mail.smtp.SMTPTr    ansport,Sun Microsystems, Inc],   com.sun.mail.imap.IMAPSSLStore=javax.mail.Provider[STORE,imaps,com.sun.mail.imap.IMAPSSLSto    re,Sun Microsystems, Inc],  com.sun.mail.pop3.POP3SSLStore=javax.mail.Provider[STORE,pop3s,com.sun.mail.pop3.POP3SSLSto    re,Sun Microsystems, Inc],  com.sun.mail.imap.IMAPStore=javax.mail.Provider[STORE,imap,com.sun.mail.imap.IMAPStore,Sun     Microsystems, Inc],  com.sun.mail.pop3.POP3Store=javax.mail.Provider[STORE,pop3,com.sun.mail.pop3.POP3Store,Sun     Microsystems, Inc]}
DEBUG: Providers Listed By Protocol:  {imaps=javax.mail.Provider[STORE,imaps,com.sun.mail.imap.IMAPSSLStore,Sun Microsystems,  Inc], imap=javax.mail.Provider[STORE,imap,com.sun.mail.imap.IMAPStore,Sun Microsystems,  Inc], smtps=javax.mail.Provider[TRANSPORT,smtps,com.sun.mail.smtp.SMTPSSLTransport,Sun  Microsystems, Inc], pop3=javax.mail.Provider[STORE,pop3,com.sun.mail.pop3.POP3Store,Sun  Microsystems, Inc],  pop3s=javax.mail.Provider[STORE,pop3s,com.sun.mail.pop3.POP3SSLStore,Sun Microsystems,  Inc], smtp=javax.mail.Provider[TRANSPORT,smtp,com.sun.mail.smtp.SMTPTransport,Sun  Microsystems, Inc]}
DEBUG: successfully loaded resource: /META-INF/javamail.default.address.map
DEBUG: getProvider() returning   javax.mail.Provider[TRANSPORT,smtp,com.sun.mail.smtp.SMTPTransport,Sun Microsystems, Inc]
DEBUG SMTP: useEhlo true, useAuth true
DEBUG SMTP: useEhlo true, useAuth true
DEBUG SMTP: trying to connect to host "smtp.gmail.com", port 465, isSSL false
Exception in thread "main" javax.mail.MessagingException: Could not connect to SMTP  host: smtp.gmail.com, port: 465;
  nested exception is:
    java.io.IOException: Couldn't connect using unknown socket factory to host, port: smtp.gmail.com, -1; Exception: java.lang.ClassNotFoundException: false
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1706)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:525)
    at javax.mail.Service.connect(Service.java:313)
    at javax.mail.Service.connect(Service.java:172)
    at javax.mail.Service.connect(Service.java:121)
    at javax.mail.Transport.send0(Transport.java:190)
    at javax.mail.Transport.send(Transport.java:120)
    at GmailSender.main(GmailSender.java:57)
Caused by: java.io.IOException: Couldn't connect using unknown socket factory to host,  port: smtp.gmail.com, -1; Exception: java.lang.ClassNotFoundException: false
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:216)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1672)
    ... 7 more
Caused by: java.lang.ClassNotFoundException: false
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at com.sun.mail.util.SocketFetcher.getSocketFactory(SocketFetcher.java:322)
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:187)
    ... 8 more 
```

问题可能是由于代理服务器的存在。但是，我可以通过使用同一代理服务器中的浏览器登录到 gmail 来发送邮件。

请提出为什么编程方法失败并且浏览器方法有效的原因。

如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T18:17:35.763

如常见问题解答中所述，[JavaMail 不能](http://www.oracle.com/technetwork/java/javamail/faq/index.html#proxy)直接使用 Web 代理服务器，尽管它可以使用 SOCKS 代理服务器。如果你只有一个网络代理服务器，像[Corkscrew](http://en.wikipedia.org/wiki/Corkscrew_%28program%29)这样的程序可以提供帮助。

此外，请参阅 JavaMail 常见问题解答，了解您在程序中犯的几个[常见错误。](http://www.oracle.com/technetwork/java/javamail/faq/index.html#commonmistakes)

# ios - 是否有资源可以让我们学习如何修改不使用情节提要的程序以使用情节提要

> ID：12093248
> 
> 赞同：0
> 
> 时间：2012-08-23T13:53:36.003
> 
> 标签：ios, xcode4.3

从 iOs 5 开始，我们有了这个称为故事板的新功能。viewController 的整个概念也发生了变化。

通常我们通过创建新项目来创建故事板，瞧，iOS 设置了所有内容。

假设我有一个不使用故事板的项目。说我希望它使用故事板。

我应该做出什么样的改变？

了解更多关于使用这个故事板和新的 viewController 范例的最佳 URL 或电子书是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T06:21:32.473

[采用故事板的 Apple iOS 开发人员文档](http://developer.apple.com/library/ios/#releasenotes/Miscellaneous/RN-AdoptingStoryboards/_index.html)

[http://maniacdev.com/ios-5-sdk-tutorial-and-guide/xcode-4-storyboard/](http://maniacdev.com/ios-5-sdk-tutorial-and-guide/xcode-4-storyboard/)

[http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

[http://codingandcoffee.wordpress.com/2011/10/12/iphone-tutorial-one-introduction-to-storyboarding/](http://codingandcoffee.wordpress.com/2011/10/12/iphone-tutorial-one-introduction-to-storyboarding/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T06:23:11.817

[http://kurrytran.blogspot.com/2011/07/simple-ios-5-tutorial-using-storyboard.html](http://kurrytran.blogspot.com/2011/07/simple-ios-5-tutorial-using-storyboard.html)这是另一个来源。巴拉回答也不错。

# symfony - 使用 Doctrine 和 Symfony2 创建多对多关系时出错：“未知属性 'orphanRemoval'”

> ID：12093253
> 
> 赞同：0
> 
> 时间：2012-08-23T13:54:00.580
> 
> 标签：symfony, doctrine-orm

我正在尝试在两个实体之间设置 ManyToMany，但是当尝试使用控制台工具更新我的架构时，我收到以下错误：

> [BadMethodCallException]
> 注释“Doctrine\ORM\Mapping\ManyToMany”上的未知属性“orphanRemoval”。

我的实体如下所示：

```
class Customer implements UserInterface
{
    //...

    /**
     * @ORM\ManyToMany(targetEntity="Acme\CustomerBundle\Entity\Newsletter", inversedBy="subscribers")
     * @ORM\JoinTable(name="customer_newsletter_subscriptions")
     */
    private $newsletterSubscriptions;

    //...
} 
```

另一个：

```
class Newsletter
{
    //...

    /**
     * @ORM\ManyToMany(targetEntity="Acme\CustomerBundle\Entity\Customer", mappedBy="newsletterSubscriptions")
     */
    private $subscribers;
} 
```

我不知道这个属性`orphanRemoval`是从哪里来的。

我正在使用 Doctrine ORM 2.2.3 运行 Symfony v2.0.16。

# iphone - 太多 glDrawElements 导致低 fps？OpenGL ES1.1（iPhone）

> ID：12093265
> 
> 赞同：0
> 
> 时间：2012-08-23T13:54:24.943
> 
> 标签：iphone, c++, objective-c, opengl-es

我正在开发一个基于 2D Tile 的游戏，目前正在努力解决性能问题，因为即使在 iPad 3 上运行时，我的速度也在 10 - 15 FPS 左右。OpenGL ES 帧捕获显示我每帧调用 glDrawElements 689 次！很多吗？会不会是性能低下的情况？

我应该将所有内容堆叠在一个巨大的数组中并执行 1 次绘制调用吗？会有什么不同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:09:23.350

此时，您当前受到命令问题的限制（假设），如果您运行 opengl 性能检测（它在 xcode 下（右键单击，打开开发人员工具），您可能需要通过首选项下载它）。

您的目标是在一天结束时受到填充率的限制，这里有一些提示可以帮助您实现目标

按绘制深度混合模式纹理 ID 对所有精灵进行排序

排序后，将所有精灵打包到一个顶点缓冲区对象和一个索引缓冲区对象中。

当您的绘制深度、混合模式或纹理 ID 发生变化时，是时候进行新的绘制调用并绑定这些资源了。

还要记住，您的精灵应该在 cpu 端（pos x mvp）平展您的顶点，并且您不应该发送矩阵和任何其他属性（例如颜色）应该是顶点的一部分。

典型顶点

```
{
    float pos[3]
    int color
    float uv[2]
} 
```

# xquery - 如何在 Marklogic 中解析 Xquery 中的“>”和“<”？

> ID：12093266
> 
> 赞同：2
> 
> 时间：2012-08-23T13:54:28.833
> 
> 标签：xquery, marklogic

我想在 Marklogic Server 的 xqy 页面中使用`>`和。但是，当我编写和运行查询时，Marklogic 也会转换为 In Query Console ，`<`它`>`会打印输出，但我希望它是only 而不是。我怎样才能做到这一点 ？`&gt;``<``&lt;``>``&gt;``>``&gt;`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T19:23:32.677

在**QConsole 中**，您可以选择`Text`输出格式。如果您对只包含“>”的查询执行此操作，则只会输出**>**。如果您选择`XML`输出格式，它将被**QConsole** `eval`函数转义并包装在结果元素中，以使其格式正确。

如果您使用通用网络浏览器检查您的 xqy 页面，它也可能会转义正确写入的结果，请务必检查页面源。

另请注意，通常以**text/xml**`Marklogic`形式返回**xquery**输出。您可以使用将响应内容类型设置为**text/plain******`xdmp:set-response-content-type("text/plain")`****

 ****高温高压****

# c# - 复选框列表数据绑定到实体框架表

> ID：12093268
> 
> 赞同：0
> 
> 时间：2012-08-23T13:54:34.830
> 
> 标签：c#, asp.net, visual-studio-2010, entity-framework

我在 formview 对象中放置了一个复选框列表。我想将复选框列表的结果存储并加载到实体框架的表中。

我使用 DataSourceID、DataTextField 和 DataValueField 属性为 cbl 填充了来自具有 2 列的表的值和标签，但我似乎找不到如何将 cbl 绑定到实体框架对象以存储检查的值当表单视图处于“编辑”模式时。

任何帮助将不胜感激。谢谢！

```
<asp:FormView ID="formView1" runat="server" DataSourceID="Ods1" 
        Height="203px" Width="495px" 
        onpageindexchanging="formView1_PageIndexChanging">
<EditItemTemplate>
    <asp:CheckBoxList ID="cblProducts" runat="server" RepeatColumns="3" 
                Width="782px" DataSourceID="SqlDataSource1" DataTextField="ProductName" 
                DataValueField="ProductCode">
    </asp:CheckBoxList>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
                ConnectionString="<%$ ConnectionStrings:ApplicationServices %>" 
                SelectCommand="SELECT [ProductCode], [ProductName] FROM [Products]">
    </asp:SqlDataSource>
</EditItemTemplate>
</asp:FormView>
    <asp:ObjectDataSource ID="Ods1" runat="server" 
        DataObjectTypeName="WebApplication1.EDM.Emp" DeleteMethod="DeleteEmp" 
        InsertMethod="CreateNewEmp" OldValuesParameterFormatString="original_{0}" 
        SelectMethod="GetEmpByEmpId" TypeName="WebApplication1.EDM.EmpLogic" 
        UpdateMethod="UpdateEmp" OnSelecting="Ods1_Selecting">
        <SelectParameters>
            <asp:RouteParameter Name="EmpId" RouteKey="EmpId" Type="String" />
        </SelectParameters>
    </asp:ObjectDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:38:27.737

您需要执行以下操作；

```
foreach (ListItem chk in cblProducts.Items)
{
    string productId= chk.Value;
    if (IsProductAvailable(productId) // this method will basically goes to database and return true of false
        chk.Selected = true;
    else
        chk.Selected = false;
}

private void IsProductAvailable(string productId)
{
        string query = "SELECT [ProductId] FROM [Product] ";
        query += "WHERE [ProductId] = @ProductId";
        DbCommand comm = new DbCommand();
        comm.CommandText = query;

        DbParameter param = comm.CreateParameter();
        param.ParameterName = "@ProductId";
        param.Value = productId;
        comm.Parameters.Add(param);

        DataTable table = comm.ExecuteCommand();
        if (table.Rows.Count > 0)
        {
            return true;
        }
        else
            return false;
} 
```

请根据您的需要修改查询和参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:25:48.830

```
<asp:FormView ID="formView1" runat="server" 
     OnItemUpdating="formView1_ItemUpdating" ...>

protected void formView1_ItemUpdating(object sender, FormViewUpdateEventArgs e)
{
   var cblProducts = formView1.FindControl("cblProducts") as CheckBoxList;

   foreach (ListItem item in cblProducts.Items)
   {
       if (item.Selected)
       {
           // Check if item.Value is not in the db for this employee, if so add it
       }
       else
       {
           // Check if item.Value is in the db for this employee, if so delete it
       }
   }

   // save
} 
```

# javascript - 在 pagescroll 上相互滚动 div

> ID：12093270
> 
> 赞同：0
> 
> 时间：2012-08-23T13:54:38.690
> 
> 标签：javascript, jquery, html

我有一个带有多个 DIV 的 HTML 页面和一个名为“fullscreenCSS”的函数，它负责将 DIV 全屏显示。

当我使用滚动条滚动时，我希望当前 DIV 保持在其位置（如果滚动到该 DIV 的末尾）并且下一个滑过它。我认为当前的 DIV 暂时必须有一个“绝对”或“固定”的位置，直到下一个到达屏幕顶部。有谁知道如何做到这一点？

第一次尝试可见：[http ://www.84media.nl/project/couch/](http://www.84media.nl/project/couch/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:25:54.980

这个样子怎么样？

[http://jsfiddle.net/Tgm6Y/2227/](http://jsfiddle.net/Tgm6Y/2227/)

# java - 将它们注入 SystemClassLoader 时如何确定类加载顺序？

> ID：12093271
> 
> 赞同：4
> 
> 时间：2012-08-23T13:54:41.550
> 
> 标签：java, classloader

对于我的检测工具，我想提供一个包装类加载器，用于在检测特定类后启动主方法。我的 ClassLoader 应该加载某些类的检测版本。但是对于 Jetty 和 JUnit，这种方法受到严重限制，因为它们构建了自己的类加载层次结构。

我不想传递 VM 参数，所以我无法更改 SystemClassLoader。`ClassLoader.defineClass(String, byte[], int, int)`但是我可以通过使用反射公开来强制使用我的课程。

```
ClassLoader scl = ClassLoader.getSystemClassLoader();
Method defineClass = ClassLoader.class.getDeclaredMethod(
        "defineClass", String.class, byte[].class, int.class, int.class);
defineClass.setAccessible(true);
for (String binaryName : classNamesToLoad) {
    byte[] bytecode = this.declaredClasses.get(binaryName);
    defineClass.invoke(scl, binaryName, bytecode, 0, bytecode.length);
}
defineClass.setAccessible(false); 
```

这很好——但还有一个问题：如果我的一些类继承自或包含其他类，它们必须以正确的顺序加载，因为 SystemClassLoader 加载当前依赖的所有类——并且会加载未检测的版本.

这是一个示例，其中包含一些（命名不佳的）类以及它们必须加载的顺序：

```
A
A.A extends B.A
B
B.A extends B.C
B.C 
```

必须按顺序加载

```
B
B.C
B.A
A
A.A 
```

如果我只想加载检测版本。

有没有简单的方法——例如我还没有发现的“setSystemClassLoader”方法？

我不需要操作 SystemClassLoader 的解决方法？

还是我真的必须从我想要加载的类开始进行完整的传递依赖分析以确定正确的顺序（在这种情况下：有没有我可以使用的“现有技术”）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T13:34:24.073

看起来没有办法绕过传递依赖分析。

我以这种方式解决了它，我真的希望有人能从这个实现中受益：

```
import java.io.IOException;
import java.util.ArrayDeque;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.objectweb.asm.ClassReader;
import org.objectweb.asm.tree.ClassNode;

public class DependencyDetector {

    private static class Node implements Comparable<Node> {
        private final String binaryName;
        private final Node[] imports;
        private final int score;

        private Node(String binaryName, Node...imports) {
            this.binaryName = binaryName;
            this.imports = imports;
            this.score = calculateScore(imports);
        }

        public int compareTo(Node o) {
            return score - o.score;
        }

        private int calculateScore(Node...imports) {
            int newScore = 0;
            for (Node n : imports) {
                if (n.score >= newScore) {
                    newScore = n.score + 1;
                }
            }
            return newScore;
        }
    }

    private Map<String, Node> nodes = new HashMap<String, Node>();

    public DependencyDetector add(ClassNode node) {
        Node n = nodes.get(node.name);
        if (n == null) {
            n = createNode(node);
        }
        return this;
    }

    private Node createNode(ClassNode node) {
        String binaryName = node.name;
        String[] importNames = extractImportedBinaryNames(node);
        Node[] imports = new Node[importNames.length];
        for (int i = 0; i < imports.length; i++) {
            String importName = importNames[i];
            Node imp = nodes.get(importName);
            if (imp == null) {
                ClassNode cn = new ClassNode();
                String path = importName.replace('.', '/') + ".class";
                try {
                    new ClassReader(
                            ClassLoader.getSystemResourceAsStream(path)
                        ).accept(cn, ClassReader.SKIP_CODE);
                } catch (IOException e) {
                    throw new RuntimeException(
                        "could not read class " + importName);
                }
                imp = createNode(cn);
                nodes.put(importName, imp);
            }
            imports[i] = imp;
        }
        Node result = new Node(binaryName, imports);
        nodes.put(binaryName, result);
        return result;
    }

    private String[] extractImportedBinaryNames(ClassNode node) {
        String binaryName = node.name;
        ArrayList<String> nodesToAdd = new ArrayList<String>();
        int endOfOuter = binaryName.lastIndexOf('$');
        if (endOfOuter >= 0) {
            nodesToAdd.add(binaryName.substring(0, endOfOuter));
        }
        if (node.superName != null) {
            nodesToAdd.add(node.superName);
        }
        if (node.interfaces != null) {
            for (String interf : (List<String>) node.interfaces) {
                if (interf != null) {
                    nodesToAdd.add(interf);
                }
            }
        }
        return nodesToAdd.toArray(new String[nodesToAdd.size()]);
    }

    public String[] getClassesToLoad(String...binaryNames) {
        String[] classNames = binaryNames != null && binaryNames.length > 0
                ? binaryNames.clone()
                : nodes.keySet().toArray(new String[nodes.size()]);
        ArrayDeque<Node> dependencyQueue = new ArrayDeque<Node>();
        for (String className : classNames) {
            Node node = nodes.get(className.replace('.', '/'));
            dependencyQueue.add(node);
            if (node == null) {
                throw new RuntimeException(
                    "Class " + className + " was not registered");
            }
        }
        HashMap<String, Node> dependencyMap = new HashMap<String, Node>();
        while (!dependencyQueue.isEmpty()) {
            Node node = dependencyQueue.removeFirst();
            dependencyMap.put(node.binaryName, node);
            for (Node i : node.imports) {
                dependencyQueue.addLast(i);
            }
        }
        ArrayList<Node> usedNodes =
            new ArrayList<Node>(dependencyMap.values());
        Collections.sort(usedNodes);
        String[] result = new String[usedNodes.size()];
        int i = 0;
        for (Node n : usedNodes) {
            result[i++] = n.binaryName.replace('/', '.');
        }
        return result;
    }

    public boolean contains(String binaryName) {
        return nodes.containsKey(binaryName.replace('.', '/'));
    }
} 
```

它的用法是这样的：在 a 上`DependencyDetector`，您调用`add(ClassNode)`以添加 a`ClassNode`及其所有依赖项（它扩展或实现或包含的所有类）。完成构建依赖关系树后，调用以按必要顺序`getClassesToLoad()`检索所有依赖关系作为包含二进制名称的 a。`String[]`您还可以通过将二进制名称指定为`getClassesToLoad(...)`.

现在，当我检测类时，我还添加了`ClassNode`并且`DependencyDetector`可以检索我需要将其传递给这样的方法的所有内容：

```
/**
 * load the specified classes (or all instrumented classes)
 * and all their dependencies with the specified ClassLoader.
 * @param loader
 * @param binaryNames binary names of all classes you want to load
 *        - none loads all instrumented classes
 */
public void loadIntoClassLoader(ClassLoader loader, String...binaryNames) {
    final String[] classNamesToLoad =
        dependencies.getClassesToLoad(binaryNames);
    Method defineClass = null;
    Method findLoadedClass = null;
    try {
        // crack ClassLoader wide open and force-feed it with our classes
        defineClass = ClassLoader.class.getDeclaredMethod(
                "defineClass", String.class, byte[].class,
                int.class, int.class);
        defineClass.setAccessible(true);
        findLoadedClass = ClassLoader.class.getDeclaredMethod(
                "findLoadedClass", String.class);
        findLoadedClass.setAccessible(true);
        for (String binaryName : classNamesToLoad) {
            if (!binaryName.startsWith("java.")) {
                if (findLoadedClass.invoke(loader, binaryName) == null) {
                    byte[] bytecode = getBytecode(binaryName);
                    defineClass.invoke(loader, binaryName, bytecode,
                        0, bytecode.length);
                } else if (declaredClasses.containsKey(binaryName)) {
                    throw new RuntimeException(
                        "Class " + binaryName + " was already loaded, " +
                        "it must not be redeclared");
                }
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
        throw new RuntimeException(
            "could not load classes into ClassLoader", e);
    } finally {
        rehideMethod(findLoadedClass);
        rehideMethod(defineClass);
    }
}

private void rehideMethod(Method m) {
    if (m != null) {
        try {
            m.setAccessible(false);
        } catch (Exception e) {
        }
    }
} 
```

这依赖于

```
private final DependencyDetector dependencies = new DependencyDetector();
private final Map<String, byte[]> declaredClasses = new HashMap<String, byte[]>();

private byte[] getBytecode(String binaryName) {
    byte[] bytecode = declaredClasses.get(binaryName);
    if (bytecode == null) {
        // asBytes loads the class as byte[]
        bytecode =
            asBytes(binaryName.replace('.', '/') + ".class");
    }
    return bytecode;
} 
```

差不多就是这样，它在我迄今为止遇到的每一种情况下都很有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T12:36:37.673

使用instance of 检查对象是否属于该类。

```
if (aAnimal instanceof Fish){
      Fish fish = (Fish)aAnimal;
      fish.swim();
    }
    else if (aAnimal instanceof Spider){
      Spider spider = (Spider)aAnimal;
      spider.crawl();
    } 
```

# javascript - 比较 2 个数组，以便如果一个数组在另一个数组中有元素，这些元素会从另一个数组中消除？

> ID：12093272
> 
> 赞同：-3
> 
> 时间：2012-08-23T13:54:42.287
> 
> 标签：javascript, jquery

> **可能重复：**
> [JavaScript 数组差异](https://stackoverflow.com/questions/1187518/javascript-array-difference)

使用 jquery 或 javascript 如何比较 2 个数组，以便如果一个数组在另一个数组中有元素，这些元素会从另一个数组中消除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T13:58:06.253

您必须交叉两个数组并将第一个的每个元素与第二个的每个元素进行比较，然后使用该`Array.splice`方法删除一个元素。

```
for (var i in array1) {
    for (var j in array2) {
        if (array2[j] == array1[i]) {
            array2.splice(j, 1);
            break;
        }
    }
} 
```

# c# - MS Visual Studio 2010 C# Express 一直崩溃

> ID：12093275
> 
> 赞同：-7
> 
> 时间：2012-08-23T13:54:51.397
> 
> 标签：c#, visual-studio-2010

VS 通常在我编辑文本时每 10 分钟崩溃一次。已安装 SP1。发生在 Macbook Pro 上的 Windows 7 + Bootcamp 和 Linux 上托管的 Windows XP 虚拟机上。操作系统是最新的。

Visual Studio 或我的安装有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:57:32.523

执行 Visual Studio

```
Devenv.exe /Log 
```

为了获取日志信息

(vcsexpress 为快递版)

# python - python twitter api 最近的结果

> ID：12093276
> 
> 赞同：1
> 
> 时间：2012-08-23T13:54:55.367
> 
> 标签：python, api, twitter

如何获得 1500 条推文？我尝试了 page 参数，发现这不起作用，我现在被 max_id 和 since_id 卡住了。我不知道 max_id 和 since_id。如果进行查询，我想获得自发送查询以来最近的 1500 条推文。这是我的代码：

```
# -*- coding: utf-8 -*-
import urllib
import simplejson

def searchTweets(query):
 search = urllib.urlopen("http://search.twitter.com/search.json?q="+query)
 dict = simplejson.loads(search.read())
 counter = 0
 for result in dict["results"]: 
  print "*",result["text"].encode('utf-8')
  counter += 1
 print "\n",counter," tweets found","\n" 

searchTerm = "steak"
searchTweets(searchTerm+"&rpp=100&page=15") 
```

有谁知道解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:26:11.277

让这个为我工作了 1200 条推文：

```
# -*- coding: utf-8 -*-
import urllib
import simplejson

def searchTweets(query, minimum_tweets):
  results = []
  i=0
  while len(results)<minimum_tweets:
    if i==0: # First time through don't include max id
        response = urllib.urlopen("http://search.twitter.com/search.json?q="+query+"&rpp=100")
    else: # Subsequent times include max id
        response = urllib.urlopen("http://search.twitter.com/search.json?q="+query+"&rpp=100&max_id="+max_id)
    response = simplejson.loads(response.read())
    if not response['results']: break # Break if no tweets are returned
    max_id = str(long(response['results'][-1]['id_str'])-1) # Define max_id for next iteration
    results.extend(response['results']) # Extend tweets to results array
    i += 1

  print "\n",len(results)," tweets found","\n" 

searchTerm = "steak"
searchTweets(searchTerm, 1200) 
```

它的问题是搜索 twitter API 经常中断，并且没有错误处理，或者在这里重试。但它应该向您展示 max_id 背后的逻辑。我使 max_id 比被拉出的最后一条推文的 id 小一，因此没有任何重复。

此外，肯定有更优雅的方式来决定是否在 url 中包含 max_id。这个解决方案是因为[max_id 没有默认值](https://stackoverflow.com/questions/11194539/default-value-for-twitters-max-id-parameter)（我希望：p）

# .net - WPF 转换器的 MultipleBinding... ConvertBack 何时被调用？

> ID：12093282
> 
> 赞同：0
> 
> 时间：2012-08-23T13:55:07.250
> 
> 标签：.net, wpf, xaml, updatesourcetrigger

我有一个带有一组值的组合框。所选值由具有多个双向绑定的 Converter 确定。当用户更改 ComboBox 中的值时，我希望调用 ConvertBack 方法并更改多重绑定中使用的两个属性的值，但这不会发生，即使 ComboBox 失去焦点也是如此。我试图将 UpdateSourceTrigger 属性更改为“LosesFocus”，但这显然对 MultipleBinding 无效。如何在值更改或控件失去焦点时触发 ConvertBack 方法？任何一个都可以满足我的目的。

XAML：

```
<ComboBox ItemsSource="{Binding DescriptionList}" DisplayMemberPath="Description" SelectedValuePath="Description" IsEnabled="{Binding EditMode}">
    <ComboBox.SelectedValue>
        <MultiBinding Converter="{StaticResource DescriptionConverter}">
            <Binding Path="PersonRow.DescriptionType" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" />
            <Binding Path="PersonRow.DescriptionSuccessful" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged" />
        </MultiBinding>
    </ComboBox.SelectedValue>
</ComboBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:59:25.680

您可能需要添加`Mode="TwoWay"`到您的`<MultiBinding>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:15:47.783

杰的建议给了我正确的方向。我还在 MultiBinding 标记中添加了一个 UpdateSourceTrigger="LostFocus" 并且能够触发该事件。

# vim - 如何在 Vim 中显示函数范围？

> ID：12093284
> 
> 赞同：1
> 
> 时间：2012-08-23T13:55:21.233
> 
> 标签：vim

有没有办法在 Vim 中显示函数的范围，我的意思是 {...}？我使用Eclipse ADT，发现它可以做到这一点，这是一个非常好的特性。

![显示 Eclipse 功能的屏幕截图](../Images/64a7410e36a4e56ddc28fac645ee5f0c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:56:21.250

查看函数范围的一种方法是使用折叠 ( `:help fold`)，该`foldcolumn`选项将提供折叠位置的表示。

另一个有用的范围特性是`[``{`and `]``}`，它可以前后跳转到下一级大括号。

如果您无法看到函数范围的限制，另一种有用的方法是使您的函数更小:-)

# javascript - 与脚本连接的日期选择器

> ID：12093287
> 
> 赞同：1
> 
> 时间：2012-08-23T13:55:26.197
> 
> 标签：javascript, function, datepicker

嗨，我有一个日期选择器：

```
 <input class="dmxCalendar2" name="dmxCalendar21" id="dmxCalendar21" />
<script type="text/javascript">

jQuery(document).ready(
function()
 {
 jQuery("#dmxCalendar21").dmxCalendar2(
     {"altFormat": "yy-mm-dd", "condDates": [], "firstDay": 1, "showOn": "both",            
    "duration": "slow", "showOptions": {"direction": "up", "easing": "swing"},"yearRange": "c-  10:c+10", "onSelect": "MM_goToURL(\'parent\',\'allactstest.html\');"}
   );
  }
  );

 </script> 
```

还有一个脚本：

```
<script>
var chosenDate = '2012-08-14'; 
function checkDate(rgn, doIt) {
if (doIt('{dsDates::datebooked}') == chosenDate) {
    Spry.Utils.addClassName('id'+doIt('{dsArtists::@id}'),'hidden');
}
}
</script> 
```

但是我需要它，所以当日期选择器中的日期更改时，脚本的 'var selectedDate 部分会随之更改吗？

# android - 从手机上传视频

> ID：12093290
> 
> 赞同：0
> 
> 时间：2012-08-23T13:55:30.487
> 
> 标签：android, file-upload, upload, android-camera, android-camera-intent

我有一个网站，我的应用程序的用户可以从 Android Gallery 上传视频。我想这样做，以便当用户打开文件选择器时，它可以选择录制视频并从 Androids 库存相机上传。这是可能的还是我必须创建一个可以处理视频录制并将视频发布到文件选择器的应用程序？无论哪种方式，如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T04:36:30.037

我会建议你编写你的应用程序，它会更加定制化，并且可以完全按照你的方式处理。此链接将帮助您进行相关媒体录制[媒体记录器](http://developer.android.com/reference/android/media/MediaRecorder.html)和上传到服务器，您可以查看此[上传视频](https://stackoverflow.com/questions/5017093/upload-video-from-android-to-server)

# css - youtube 视频顶部的 Div 区域

> ID：12093292
> 
> 赞同：0
> 
> 时间：2012-08-23T13:55:32.857
> 
> 标签：css, youtube-api

如何在我的 youtube 视频上放置一个 div 区域，该视频正在使用 youtube api

我在[jsfiddle 上的代码在这里](http://jsfiddle.net/dtjmsy/HR8pX/27/)

我尝试了 z-index 没有成功，我将如何实现这一目标？

为你的帮助干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:00:09.183

我玩过你的小提琴，希望这对你有好处：

[http://jsfiddle.net/HR8pX/32/](http://jsfiddle.net/HR8pX/32/)

它实际上只是添加一个带有位置的容器：相对并绝对定位您的叠加 DIV。

# bash - 启动另一个应用程序的脚本将在退出时将其关闭

> ID：12093300
> 
> 赞同：2
> 
> 时间：2012-08-23T13:55:42.623
> 
> 标签：bash, nohup

我有一个使用 启动另一个应用程序的脚本`nohup my_app &`，但是当初始脚本终止时，启动的进程也会停止。根据我的理解，因为它已经运行，`nohup`所以不应该发生这种情况。原始脚本也使用 nohup 调用。

那里出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:09:29.580

nohup 并不意味着当（父）进程被杀死时（子）进程仍在运行。当您通过 ssh 连接到服务器并在那里启动进程时，使用 nohup 。如果您注销，进程将终止（注销向进程发送信号 SIGHUP 导致进程终止），使用 nohup 避免此行为，并且您在注销时进程仍在运行。

如果您需要一个在后台运行的程序，即使它的父进程已终止，请尝试使用守护进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:12:48.770

一个非常可靠的脚本已经成功使用了多年，并且在调用 nohup 后总是终止使用这个结构：

nohup ${BinDir}/${Watcher} >${DataDir}/${Watcher}.nohup.out 2>&1 &

也许问题是没有管理输出？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:26:39.420

这取决于做什么`my-app`- 它可能会设置自己的信号掩码。您可能知道`nohup`忽略挂机信号 SIGHUP，而这是由目标程序继承的。如果该目标程序进行自己的信号处理，那么它可能会将 SIGHUP 设置为，例如 SIG_DFT - 默认操作（即死亡）。

要检查，运行`strace -f -o out`或`truss -f -o out`命令。这将为您提供名为“out”的文件中的所有内核调用。如果是，您应该能够发现正在更改的信号掩码。

# iphone - XCode断点条件错误

> ID：12093309
> 
> 赞同：2
> 
> 时间：2012-08-23T13:55:57.390
> 
> 标签：iphone, ios, xcode, xcode4.4

我有这个断点条件：

```
[string isEqualToString:@"dummy"] 
```

，但我总是在控制台中收到此错误：

> 错误：没有已知方法'-isEqualToString:'；将消息发送到方法的返回类型

我究竟做错了什么？

XCode 版本是 4.4.1，调试器是 LLDB。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T10:07:25.953

今天试了条件断点，找到了答案。在您的情况下将返回值转换为 BOOL 将解决此问题：

```
 (BOOL)[string isEqualToString:@"dummy"] 
```

（即使`string`是 NSString 也会引发此错误。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:12:24.010

请确保“字符串”是 NSString 类型的对象！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T12:53:08.500

我认为您的“字符串”是字符、数字或网址类型。“字符串”必须是 NSString 类型。

# php - PHP 中的 XML 标头破坏了 VIM、SVN 等中的代码突出显示

> ID：12093313
> 
> 赞同：1
> 
> 时间：2012-08-23T13:56:08.707
> 
> 标签：php, xml, syntax-highlighting

这不是一个严重的问题，而是一个反复出现的烦恼。我有一个 PHP 类，它实现了几个涉及 XML 的例程，在其中一个例程中，我声明了如下标头：

```
$XML_Header = "<?xml version=\"1.0\"?><document></document>"; 
```

这在 VIM 中大约 1/3 的时间会破坏语法高亮，而在 SVN 中则一直如此。出于组织原因，我不想将这部分移到文件的底部，有没有办法我应该转义这段代码？我应该从另一个文件中包含它吗？还有其他/更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T14:50:55.033

将其添加为有效的答案并不漂亮，但可以使事情正常进行。归功于原始海报。

将 ?> 的尾随符号分开

```
$XML_Header = '<?xml version="1.0" encoding="ISO-8859-1"?'.'>'; 
```

# c# - 选项卡控件不刷新

> ID：12093317
> 
> 赞同：1
> 
> 时间：2012-08-23T13:56:18.767
> 
> 标签：c#, refresh, tabcontrol, invalidation, tabpage

我有一个以三个 TabPages 开头的 TabControl。在第一个选项卡上有一个 NumericUpDown（微调器），它显示选项卡的数量并允许用户添加最多 10 个额外的选项卡。一旦他们添加超过大约 5 或 6 个，它就会超出表单的宽度，其余的选项卡可以通过顶部的几个左/右箭头访问。当一直向右移动然后使用微调器返回到 0（删除所有额外的选项卡并保留最开始的三个）时，它会从窗格顶部删除所有选项卡，并且仅通过将微调器设置回 1它是否刷新并显示所有 4 个（从一开始的 3 个加上来自微调器的 1 个）。我尝试了几种组合， `Application.DoEvents()` `this.Refresh()` `this.Invalidate()` `this.Update()` 但似乎没有任何效果。任何人都可以提出它不更新/刷新的原因吗？

```
public partial class Form1 : Form
{

TabPage[] tabs;

    public Form1()
    {
        InitializeComponent();
        tabs = new TabPage[tabControl1.Controls.Count];
        tabs[0] = tabPage1;
    }

    private void numericUpDown1_ValueChanged(object sender, EventArgs e)
    {
        int numTabs = tabControl1.Controls.Count;
        decimal spinnerValue = numericUpDown1.Value;

        if (numTabs < spinnerValue) //add a tab
        {
            TabPage[] newTabs = new TabPage[(int)spinnerValue];
            for (int i = 0; i < numTabs; i++)
            {
                newTabs[i] = tabs[i];
            }

            TabPage tab = new TabPage("Tab " + numTabs);
            newTabs[(int)spinnerValue-1] = tab;
            tabControl1.Controls.Add(tab);
            tabs = newTabs;
        }
        else //remove a tab
        {
            TabPage[] newTabs = new TabPage[(int)spinnerValue];
            for (int i = 0; i < spinnerValue; i++)
            {
                newTabs[i] = tabs[i];
            }
            tabControl1.Controls.Remove(tabs[(int)spinnerValue]);
            tabs = newTabs;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:04:24.160

在没有看到任何代码或不知道这是什么类型的项目的情况下，这是 winforms、WPF、ASP.NET 等。很难给出明确的答案，我将假设这是 WinForms

我不确定你是否可以。以下是来自 MSDN 的引用：

“在显示选项卡页之前不会创建 TabPage 中包含的控件，并且在显示选项卡页之前不会激活这些控件中的任何数据绑定。”

但是，不是让更新代码直接从控件获取值，也许您可​​以创建一个可以保存用于填充控件的数据的类，然后当调用更新代码时，它会向类询问值和类检查控件是否已加载，否则它会从数据中获取值。

# c++ - 为什么 C++ 允许使用这种方法修改私有成员？

> ID：12093319
> 
> 赞同：20
> 
> 时间：2012-08-23T13:56:23.833
> 
> 标签：c++, private-members

几分钟前看到[这个问题后，我想知道为什么语言设计者允许它，因为它允许间接修改私有数据。](https://stackoverflow.com/questions/12092873/explicit-type-casting-of-object-to-int)举个例子

```
 class TestClass {
   private:
    int cc;
   public:
     TestClass(int i) : cc(i) {};
 };

 TestClass cc(5);
 int* pp = (int*)&cc;
 *pp = 70;             // private member has been modified 
```

我测试了上面的代码，确实修改了私有数据。是否有任何解释为什么允许发生这种情况，或者这只是语言的疏忽？它似乎直接破坏了私有数据成员的使用。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-23T14:13:21.740

因为，正如 Bjarne 所说，C++ 旨在防止墨菲，而不是马基雅维利。

换句话说，它应该保护你免受意外——但如果你去任何工作来破坏它（比如使用演员），它甚至不会试图阻止你。

当我想到它时，我想到了一个有点不同的类比：它就像浴室门上的锁。它会警告您，您现在可能*不想*走进那里，但是如果您决定从外面解锁门，那是微不足道的。

编辑：关于@Xeo 讨论的问题，关于为什么标准说“拥有相同的访问控制”而不是“拥有所有公共访问控制”，答案很长而且有点曲折。

让我们回到开头，考虑如下结构：

```
struct X {
    int a;
    int b;
}; 
```

对于这样的结构，C 总是有一些规则。一种是在结构的实例中，结构本身的地址必须等于 的地址`a`，因此您可以将指向该结构的指针转换为指向 的指针`int`，并`a`以明确定义的结果进行访问。另一个是成员在内存中的排列顺序必须与它们在结构中定义的顺序相同（尽管编译器可以自由地在它们之间插入填充）。

对于 C++，有维护这一点的意图，尤其是对于现有的 C 结构。同时，有一个明显的意图是，*如果*编译器想要在运行时强制执行`private`(and `protected`)，这样做应该很容易（相当有效）。

因此，给定以下内容：

```
struct Y { 
    int a;
    int b;
private:
    int c;
    int d;
public:
    int e;

    // code to use `c` and `d` goes here.
}; 
```

应该要求编译器在 和 方面保持与 C 相同的`Y.a`规则`Y.b`。同时，如果要在运行时强制访问，它可能希望将所有公共变量一起移动到内存中，因此布局更像：

```
struct Z { 
    int a;
    int b;
    int e;
private:
    int c;
    int d;
    // code to use `c` and `d` goes here.
}; 
```

然后，当它在运行时强制执行时，它基本上可以做类似的事情`if (offset > 3 * sizeof(int)) access_violation();`

据我所知，从来没有人这样做过，而且我不确定标准的其余部分是否真的允许这样做，但似乎至少有一个想法的半成形胚芽沿着这条线。

为了强制执行这两个，C++98 说`Y::a`并且`Y::b`必须在内存中按照这个顺序，并且`Y::a`必须在结构的开头（即，类似 C 的规则）。但是，由于介入了访问说明符，`Y::c`并且`Y::e`不再必须是相对于彼此的顺序。换句话说，所有在它们之间没有访问说明符的连续变量都被组合在一起，编译器可以自由地重新排列这些组（但仍然必须将第一个变量保留在开头）。

这很好，直到某个混蛋（即我）指出规则的编写方式还有另一个小问题。如果我编写如下代码：

```
struct A { 
    int a;
public:
    int b;
public:
    int c;
public:
    int d;
}; 
```

...你最终有点自相矛盾。一方面，这仍然是正式的 POD 结构，因此应该适用类似 C 的规则——但由于您在成员之间有（诚然没有意义的）访问说明符，它还允许编译器重新排列成员，因此打破了他们想要的 C 类规则。

为了解决这个问题，他们稍微重新措辞了标准，这样它就会谈论所有成员都具有相同的访问权限，而不是关于他们之间是否存在访问说明符。是的，他们本可以下令这些规则只适用于公共成员，但似乎没有人认为可以从中获得任何好处。鉴于这是在修改现有标准，其中包含大量已经使用了很长时间的代码，因此他们选择了他们可以做出的最小更改，但仍然可以解决问题。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-23T14:09:42.663

由于与 C 的向后兼容性，您可以在其中做同样的事情。

* * *

对于所有想知道的人，这就是为什么这不是 UB 并且实际上是标准允许的：

首先，`TestClass`是一个*标准布局类*( `§9 [class] p7`)：

> *标准布局类*是这样的类：
> 
> *   没有非标准布局类（或此类类型的数组）或引用类型的非静态数据成员，**// OK：非静态数据成员的类型为“int”**
> *   没有虚函数 (10.3) 也没有虚基类 (10.1), **// OK**
> *   对所有非静态数据成员具有相同的访问控制（第 11 条），**// OK，所有非静态数据成员 (1) 都是“私有的”**
> *   has no non-standard-layout base classes, **// 好的，没有基类**
> *   要么在派生最多的类中没有非静态数据成员，并且最多有一个具有非静态数据成员的基类，要么没有具有非静态数据成员的基类，并且**// OK，再次没有基类**
> *   没有与第一个非静态数据成员相同类型的基类。**// 好的，又没有基类了**

这样一来，您就可以允许`reinterpret_cast`该类为其第一个成员 ( `§9.2 [class.mem] p20`) 的类型：

> 指向标准布局结构对象的指针，使用 a 进行适当转换`reinterpret_cast`，指向其初始成员（或者如果该成员是位字段，则指向它所在的单元），反之亦然。

在您的情况下，C 样式`(int*)`转换解析为`reinterpret_cast`( `§5.4 [expr.cast] p4`)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T14:22:18.960

一个很好的理由是允许与 C 兼容，但在 C++ 层上有额外的访问安全性。

考虑：

```
struct S {
#ifdef __cplusplus
private:
#endif // __cplusplus
    int i, j;
#ifdef __cplusplus
public:
    int get_i() const { return i; }
    int get_j() const { return j; }
#endif // __cplusplus
}; 
```

通过要求 C-visible`S`和 C++-visible*布局兼容*，`S`可以跨语言边界使用 C++ 端具有更高的访问安全性。访问安全颠覆是一个不幸但必要的必然结果。*`S``reinterpret_cast`*

 *顺便说一句，对所有成员具有相同访问控制的限制是因为允许实现相对于具有不同访问控制的成员重新排列成员。据推测，为了整洁，某些实现将具有相同访问控制的成员放在一起；它也可以用来减少填充，尽管我不知道有任何编译器可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T14:19:20.000

如果您尝试过`int *pp = &cc.cc`，编译器会给您一个错误，编译器会告诉您您无法访问私有成员。

在您的代码中，您将 cc 的地址重新解释为指向 int 的指针。您以 C 风格的方式编写它，而 C++ 风格的方式将是`int* pp = reinterpret_cast<int*>(&cc);`. reinterpret_cast 始终是一个警告，表明您正在两个不相关的指针之间进行强制转换。在这种情况下，您必须确保您做得对。您必须知道底层内存（布局）。编译器不会阻止您这样做，因为如果经常需要这样做。

在进行演员表时，您会丢弃有关该课程的所有知识。从现在开始，编译器只看到一个 int 指针。当然，您可以访问指针指向的内存。在您的情况下，在您的平台上，编译器碰巧将 cc 放在 TestClass 对象的前 n 个字节中，因此 TestClass 指针也指向 cc 成员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T14:26:16.773

`reinterpret_cast`（并且 C 风格的演员表比 a 更强大）的全部目的`reinterpret_cast`是提供绕过安全措施的逃生路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T13:59:44.207

这是因为您正在操作您的类在内存中所在的内存。在您的情况下，它恰好将私有成员存储在此内存位置，因此您可以更改它。这不是一个好主意，因为您现在知道对象将如何存储在内存中。*

# javascript - 使用 javascript 擦除浏览器历史记录（或防止 URL 被记录）

> ID：12093320
> 
> 赞同：1
> 
> 时间：2012-08-23T13:56:24.167
> 
> 标签：javascript, browser, browser-history

我有一个客户（家庭暴力中心）想知道我们是否可以阻止他们的网站出现在浏览器历史记录中，或者在用户退出网站时从浏览器历史记录中删除他们的访问。

我知道一旦有人在网站上，我们可以使用 location.replace 进行导航以防止新页面像普通页面一样加载的方式构建它，但是当有人输入[http://example.org](http://example.org)时的初始页面访问仍然是在历史上。

是否可以在页面加载时阻止页面被记录在历史记录中，或者如果记录存在则删除记录？

我有一种不好的感觉，它不能，但如果有人知道，那就是我在 Stack Overflow 上的所有 smartypants 朋友。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:03:49.313

不幸的是，这是无法做到的。

对于您的客户场景，我最好的建议是让用户了解如何从浏览器历史记录中删除他们的访问，以及如何在以后的访问中使用匿名浏览/私人模式/隐身模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:01:05.640

引用[MDN](https://developer.mozilla.org/en-US/docs/DOM/window.history#Notes)：

> 无法清除会话历史记录或禁用非特权代码的后退/前进导航。最接近的可用解决方案是 location.replace() 方法，它将会话历史记录的当前项替换为提供的 URL。

所以我认为你的客户想要的只是不可能的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T14:02:10.650

添加脚本以识别每个浏览器，并提供浏览器特定的步骤来清除历史记录/使用隐身模式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-24T09:59:10.363

在这种情况下，可能会使用正确配置的代理服务器。

# regex - 带有特殊字符的正则表达式

> ID：12093322
> 
> 赞同：0
> 
> 时间：2012-08-23T13:56:28.660
> 
> 标签：regex, url-rewriting

我正在为我目前正在开发的网站使用一些 url 重写。我对数字、字母和 - 使用这个重写工作正常：

```
 RewriteRule ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)$    characters.php?realm=$1&name=$2 [NC] 
```

但是，我需要规则的第一部分来允许允许 '，并且我需要规则的第二部分来允许特殊字符，例如 ú、æ、ä、ç 以及几乎所有位于[此处](http://www.tedmontgomery.com/tutorial/altchrc.html)的字符类似于一封信。

我知道特殊字符不好，但我不是允许它们用于字符名称的人。我只需要在我的规则中允许它们，以便具有这些名称的字符可以访问我的应用程序。

谢谢。

编辑：第一部分现在有效。目前正在尝试第二部分。

编辑#2：为第二部分（[^/]+）尝试两种解决方案并排除某些字符允许显示信息而不是导致 404 错误。但是它导致我的 CSS 不显示，而是尝试调用 /css/error 而不是 /css。根据 chrome，它会导致 css 文件的重定向循环。

将某些内容重定向到 /error 的唯一方法是字符数据无效。此应用程序用于从暴雪字符 api 中提取字符信息，因此重音字符可以用于重写是必不可少的。

我不确定这是否重要，但是当我只允许 ú 与 az 和 AZ 一起包含时，我收到一个 404 错误，指出无法找到该页面，而不是显示 ú 它显示 Ãº 在它的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:04:06.957

我能想到的最简单的解决方案是 ú 显示为 Ãº 例如，所以我只是简单地将 Ãº 包含在规则中。不确定这是否是最好的方法，但它现在有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:01:00.290

^([a-zA-Z0-9_'-]+)/([^***此处排除字符***]+)$

在第一个括号内添加“'”应该允许它匹配。就第二个而言，您可能想要使用否定字符类，并列出您不允许的**字符**。

编辑以在“-”之前移动单引号。

# iphone - 在 tableView Cell 的 ImageView 中获取 Facebook 个人资料图片

> ID：12093323
> 
> 赞同：-1
> 
> 时间：2012-08-23T13:56:30.627
> 
> 标签：iphone, facebook, uitableview, xcode4.2

我在 facebook 中创建了我的 iphone 应用程序所需的应用程序。
我能够登录到 facebook 帐户，并且我可以允许该应用程序进入我的应用程序。
能够获取已登录用户的个人资料图片 url。

**编辑** 我的问题是我需要将该 url 转换为图像类型并且需要在 tableview 单元格中显示。谁能告诉我这件事。请帮我。非常感谢您提前提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:14:02.730

你需要做这样的请求：

```
[facebook requestWithGraphPath:@"me/picture" andDelegate:self]; 
```

接着：

```
(void)request:(FBRequest *)request didLoad:(id)result {
    imageView.image = [UIImage imageWithData:result];
} 
```

# javascript - 如何在谷歌地图中对齐标记的图标

> ID：12093327
> 
> 赞同：35
> 
> 时间：2012-08-23T13:56:55.067
> 
> 标签：javascript, google-maps, google-maps-markers

在谷歌地图中，​​标记图像的中心底部通常是它必须标记的点的纬度。

想象一下我的标记图标是一个圆圈，我希望它的中心位于给定点的纬度...

**代码：**

```
var image_hotspot = 'img/icons/bank_euro.png';
var marker = new google.maps.Marker({
      map: map,
      position: placeLoc,
      icon: image_hotspot
    }); 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-23T14:07:21.057

您需要的是创建一个`MarkerImage`对象，例如：

```
var markerImage = new google.maps.MarkerImage('img/icons/bank_euro.png',
                new google.maps.Size(30, 30),
                new google.maps.Point(0, 0),
                new google.maps.Point(15, 15)); 
```

其中第一个参数是图像 url，第二个是图像大小，第三个是图像的原点，第四个是图像上标记应该指向的位置。如果您的标记是一个圆圈，则将第四个参数设置为图像的中心。`markerImage`并创建传递给 icon 属性的标记：

```
var marker = new google.maps.Marker({
  map: map,
  position: placeLoc,
  icon: markerImage
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-04-03T16:48:08.307

从文档：

**将 MarkerImage 对象转换为类型 Icon**

```
var image = new google.maps.MarkerImage(
    place.icon,
    new google.maps.Size(71, 71),
    new google.maps.Point(0, 0),
    new google.maps.Point(17, 34),
    new google.maps.Size(25, 25)); 
```

变成

```
var image = {
  url: place.icon,
  size: new google.maps.Size(71, 71),
  origin: new google.maps.Point(0, 0),
  anchor: new google.maps.Point(17, 34),
  scaledSize: new google.maps.Size(25, 25)
}; 
```

[https://developers.google.com/maps/documentation/javascript/markers](https://developers.google.com/maps/documentation/javascript/markers)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-09-20T08:30:22.373

使用谷歌地图 v3，您可以/应该使用：

```
new maps.Marker({
            ...
            icon: {
                url: '.../myimage.png',
                scaledSize: new maps.Size(60, 30),
                anchor: new maps.Point(30, 30),
            },
        }); 
```

[https://developers.google.com/maps/documentation/javascript/reference#Icon](https://developers.google.com/maps/documentation/javascript/reference#Icon)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-29T19:32:37.487

如果您使用 addMarker 并需要使用 Point(x, y) 设置 x,y 坐标

```
let markerInstance = mapInstance.addMarker({
            lat : _lat,
            lng : _lng,
            label: '8',
            icon : {
              url :  'url_image.png',
              origin:  new google.maps.Point(0, 0),
            }
        }); 
```

# javascript - jQuery停止粗体，下划线和其他事件

> ID：12093328
> 
> 赞同：3
> 
> 时间：2012-08-23T13:57:01.120
> 
> 标签：javascript, jquery, html, events, javascript-events

我有这个 jsFiddle：http: [//jsfiddle.net/RGmNz/6/](http://jsfiddle.net/RGmNz/6/)

并试图禁用**CTRL + B**和**CTRL + U**等...

```
 $("iframe").contents().find("body").keydown(function(a,b){

                if(a.which ==32 && a.ctrlKey){
                    a.preventDefault(); 
                   }
            });
        }) 
```

但它仍然使文本加粗！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:07:23.760

你需要做的是`return false;`使用键码的东西，我总是发现当试图禁用某些事件时，你只需要返回 false 并完全阻止一切发生。（它会为你做 preventDefault 和 stopPropogation ）

也刚刚注意到这一点：[关于 keycode #'s 的信息](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

```
 // you want to do 66 (B)
    // with && since you're looking for both events simultaneously

    if (a.which === 66 && a.ctrlKey) {  
       return false;
    } 
```

[**jsFiddle 演示**](http://jsfiddle.net/KnY9A/1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:12:54.893

如果您进行两项更改，它将起作用：（1）为 b 使用正确的键码，即 66 而不是 32，以及（2）添加对 的调用`.stopPropagation()`：

```
if (a.which == 66 && a.ctrlKey) {
    a.preventDefault();
    a.stopPropagation();
} 
```

演示：http: [//jsfiddle.net/RGmNz/7/](http://jsfiddle.net/RGmNz/7/)

或者你可以`return false`，这相当于两者`.preventDefault()`和`.stopPropagation()`。

# javascript - Jinja和javascript语法冲突？

> ID：12093332
> 
> 赞同：6
> 
> 时间：2012-08-23T13:57:05.640
> 
> 标签：javascript, syntax-error, jinja2

我在我的 GAE-python 项目中使用 jinja2 模板语言。我尝试使用[jquery-upload](http://blueimp.github.com/jQuery-File-Upload/)来上传文件。

以下代码引发错误：

```
<!-- The template to display files available for upload -->¬
    152 <script id="template-upload" type="text/x-tmpl">¬
--  153     {% for (var i=0, file; file=o.files[i]; i++) { %}¬
|   154     <tr class="template-upload fade">¬
|   155         <td class="preview"><span class="fade"></span></td>¬
|-  156         <td class="name"><span>{%=file.name%}</span></td>¬ 
```

以上代码直接取自jquery上传库。

错误：

```
line 153, in template
    {% for (var i=0, file; file=o.files[i]; i++) { %}
TemplateSyntaxError: expected token ')', got 'i' 
```

我认为这是由于`{% %}`jinja2 以及 text/x-tmpl js 语法使用的。这个对吗？如果是这样，我该如何解决它？请帮忙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T14:33:13.267

尝试这个：

```
{{ '{% for (var i=0, file; file=o.files[i]; i++) { %}' }} 
```

或者你可以使用 {% raw %} {% endraw %} 块。

[http://jinja.pocoo.org/docs/templates/#escaping](http://jinja.pocoo.org/docs/templates/#escaping)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-21T12:54:27.207

我在使用 Flask 和 Angular 时遇到了问题。这有帮助！认为它可能对其他人有帮助。

[http://flask-triangle.readthedocs.org/en/develop/tutorial/part1.html](http://flask-triangle.readthedocs.org/en/develop/tutorial/part1.html)

# jakarta-ee - maven-ear-plugin 不包含 jarModule 到 application.xml

> ID：12093346
> 
> 赞同：6
> 
> 时间：2012-08-23T13:57:33.133
> 
> 标签：jakarta-ee, maven, ear, application.xml, maven-ear-plugin

我一直在关注 maven-ear-plugin 站点上的示例，该示例[显示了如何将第三方库添加到生成的 application.xml](http://maven.apache.org/plugins/maven-ear-plugin/examples/including-a-third-party-library-in-application-xml.html)中。但是，它似乎没有像我预期的那样工作。同样，web 模块[contextRoot](http://maven.apache.org/plugins/maven-ear-plugin/modules.html#webModule)也被忽略了。

根据[文档](http://maven.apache.org/plugins/maven-ear-plugin/usage.html#Advanced_Configuration)，我正在尝试做的事情应该是完全可能的。

> **可以使用 contextRoot 参数自定义 Web 模块的上下文根。**
> 
> 请注意，第三方库（即 JarModule）不包含在生成的 application.xml 中（只有 ejb-client 应该包含在 java 条目中）。但是，**可以通过指定 includeInApplicationXml 标志将 jar 依赖项包含在生成的 application.xml 中**。

当它在我的 application.xml 中执行构建时，我有以下输出。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE application PUBLIC
    "-//Sun Microsystems, Inc.//DTD J2EE Application 1.3//EN"
    "http://java.sun.com/dtd/application_1_3.dtd">
<application>
  <display-name>MyApp.EAR</display-name>
  <module>
    <ejb>MyApp.jar</ejb>
  </module>
  <module>
    <web>
      <web-uri>MyApp.war</web-uri>
      <context-root>/MyApp.Web</context-root>
    </web>
  </module>
</application> 
```

来自以下 Maven 配置（pom.xml）。

```
...
<modelVersion>4.0.0</modelVersion>
<groupId>com.blah</groupId>
<artifactId>MyApp.EAR</artifactId>
<version>1.0</version>
<packaging>ear</packaging>

<build>
    <plugins>
        <plugin>
            <groupId>maven-ear-plugin</groupId>
            <artifactId>maven-ear-plugin</artifactId>
            <version>2.7</version>
            <configuration>
                <applicationName>MyApp</applicationName>
                <modules>
                    <ejbModule>
                        <groupId>com.blah</groupId>
                        <artifactId>MyApp.EJB</artifactId>
                    </ejbModule>
                    <webModule>
                        <groupId>com.blah</groupId>
                        <artifactId>MyApp.Web</artifactId>
                        <contextRoot>MyApp</contextRoot>
                    </webModule>
                    <jarModule>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-simple</artifactId>
                        <includeLibInApplicationXml>true</includeLibInApplicationXml>
                    </jarModule>
                </modules>
                <archive>
                    <manifestEntries>
                        <WebLogic-Application-Version>${weblogic.version}</WebLogic-Application-Version>
                    </manifestEntries>
                </archive>
            </configuration>
        </plugin>
    </plugins>
</build>

<dependencies>
    <!-- web and ejb modules -->
    <dependency>
        <groupId>com.blah</groupId>
        <artifactId>MyApp.EJB</artifactId>
        <version>1.0</version>
        <type>ejb</type>
    </dependency>
    <dependency>
        <groupId>com.blah</groupId>
        <artifactId>MyApp.Web</artifactId>
        <version>1.0</version>
        <type>war</type>
    </dependency>
</dependencies>
... 
```

很明显 application.xml 没有按我的预期生成。

1.  在 application.xml 中提供的 contextRoot 不正确，而是输出默认名称 MyApp.Web 而不是指定的 MyApp。
2.  application.xml 中完全缺少指定的 org.slf4j jarModule。

我究竟做错了什么？

来自 Maven 的调试如下所示。

```
[DEBUG] -----------------------------------------------------------------------
[DEBUG] Goal:          org.apache.maven.plugins:maven-ear-plugin:2.4.2:generate-application-xml (default-generate-application-xml)
[DEBUG] Style:         Regular
[DEBUG] Configuration: <?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <description>${project.description}</description>
  <displayName>${project.artifactId}</displayName>
  <encoding default-value="UTF-8"/>
  <generatedDescriptorLocation>${project.build.directory}</generatedDescriptorLocation>
  <includeLibInApplicationXml default-value="false"/>
  <project>${project}</project>
  <version default-value="1.3"/>
  <workDirectory>${project.build.directory}/${project.build.finalName}</workDirectory>
</configuration> 
```

PS 我尝试创建 maven-ear-plugin 标签，但它不会让我因为我不够有名！如果有人可以创造，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T15:21:39.820

我像往常一样解决了它，这是用户错误。

奇怪的是，它几乎正确地生成了 EAR 文件，即使我的插件没有正确配置。

我换了...

```
<groupId>maven-ear-plugin</groupId>
<artifactId>maven-ear-plugin</artifactId> 
```

和...

```
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-ear-plugin</artifactId> 
```

然后变了...

```
<includeLibInApplicationXml>true</includeLibInApplicationXml> 
```

到...

```
<includeInApplicationXml>true</includeInApplicationXml> 
```

然后突然间它做了我一开始打算做的事情。

我的最终 pom.xml 看起来像这样，因为我决定要自动包含所有 jar。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.blah</groupId>
    <artifactId>MyApp.EAR</artifactId>
    <version>1.0</version>
    <packaging>ear</packaging>

    <properties>
        <weblogic.version>10.3</weblogic.version>
        <weblogic.version.minor>${weblogic.version}.4</weblogic.version.minor>
        <weblogic.host>***</weblogic.host>
        <weblogic.port>***</weblogic.port>
        <weblogic.username>***</weblogic.username>
        <weblogic.password>***</weblogic.password>
    </properties>

    <build>
        <finalName>MyApp</finalName>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ear-plugin</artifactId>
                <version>2.7</version>
                <configuration>
                    <applicationName>MyApp</applicationName>
          <includeLibInApplicationXml>true</includeLibInApplicationXml>
                    <modules>
                        <ejbModule>
                            <groupId>com.blah</groupId>
                            <artifactId>MyApp.EJB</artifactId>
                        </ejbModule>
                        <webModule>
                            <groupId>com.blah</groupId>
                            <artifactId>MyApp.Web</artifactId>
                            <contextRoot>MyApp</contextRoot>
                        </webModule>
                    </modules>
                    <archive>
                        <manifestEntries>
                            <WebLogic-Application-Version>${weblogic.version}</WebLogic-Application-Version>
                        </manifestEntries>
                    </archive>
                </configuration>
            </plugin>

            <plugin>
                <groupId>com.oracle.weblogic</groupId>
                <artifactId>weblogic-maven-plugin</artifactId>
                <version>10.3.4</version>
                <configuration>
                    <adminurl>t3://${weblogic.host}:${weblogic.port}</adminurl>
                    <user>${weblogic.username}</user>
                    <password>${weblogic.password}</password>
                    <upload>true</upload>
                    <action>deploy</action>
                    <remote>false</remote>
                    <verbose>true</verbose>
                    <source>${project.build.directory}/${project.build.finalName}.${project.packaging}</source>
                    <name>${project.build.finalName}</name>
                </configuration>
                <executions>
                    <execution>
                        <phase>install</phase>
                        <goals>
                            <goal>deploy</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

        </plugins>

        <pluginManagement>
            <plugins>
                <!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.-->
                <plugin>
                    <groupId>org.eclipse.m2e</groupId>
                    <artifactId>lifecycle-mapping</artifactId>
                    <version>1.0.0</version>
                    <configuration>
                        <lifecycleMappingMetadata>
                            <pluginExecutions>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.apache.maven.plugins</groupId>
                                        <artifactId>maven-ear-plugin</artifactId>
                                        <versionRange>[2.7,)</versionRange>
                                        <goals>
                                            <goal>generate-application-xml</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore></ignore>
                                    </action>
                                </pluginExecution>
                            </pluginExecutions>
                        </lifecycleMappingMetadata>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>

    <dependencies>
    <dependency>
      <groupId>com.blah</groupId>
      <artifactId>MyApp.EJB</artifactId>
      <version>1.0</version>
      <type>ejb</type>
    </dependency>
    <dependency>
      <groupId>com.blah</groupId>
      <artifactId>MyApp.Web</artifactId>
      <version>1.0</version>
      <type>war</type>
    </dependency>
    </dependencies>
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T14:18:30.263

非常感谢，几个小时以来一直在寻找解决这个问题的方法。:) 将广告我的 pom 以防万一这也可以帮助其他人。

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>appletree.be-multi</artifactId>
        <groupId>be.appletree</groupId>
        <version>1.0-SNAPSHOT</version>
    </parent>
    <modelVersion>4.0.0</modelVersion>

    <artifactId>appletree.be-ear</artifactId>
    <packaging>ear</packaging>

    <dependencies>

        <dependency>
            <groupId>be.appletree</groupId>
            <artifactId>appletree.be-domain</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>jar</type>
        </dependency>

        <dependency>
            <groupId>be.appletree</groupId>
            <artifactId>appletree.be-ejb</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>ejb</type>
        </dependency>

        <dependency>
            <groupId>be.appletree</groupId>
            <artifactId>appletree.be-web</artifactId>
            <version>1.0-SNAPSHOT</version>
            <type>war</type>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <artifactId>maven-ear-plugin</artifactId>
                <version>2.8</version>
                <configuration>
                    <modules>
                        <jarModule>
                            <groupId>be.appletree</groupId>
                            <artifactId>appletree.be-domain</artifactId>
                            <includeInApplicationXml>true</includeInApplicationXml>
                        </jarModule>
                        <webModule>
                            <groupId>be.appletree</groupId>
                            <artifactId>appletree.be-web</artifactId>
                        </webModule>
                        <ejbModule>
                            <groupId>be.appletree</groupId>
                            <artifactId>appletree.be-ejb</artifactId>
                        </ejbModule>
                    </modules>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project> 
```

# php - PHP WebDAV 服务器无法使用 Windows 执行 PUT 方法

> ID：12093349
> 
> 赞同：0
> 
> 时间：2012-08-23T13:57:37.663
> 
> 标签：php, windows-7, webdav

我正在尝试实现一个基于 PHP 的 WebDAV 服务器，以便能够在 OS Windows（更准确地说是 Windows 7）下使用它。

一切正常，除了 PUT 方法。当我尝试将文件从文件系统上传到 WebDAV 服务器时，请求内容长度为空，这意味着我无法读取要放入服务器的文件。

这是我使用 Windows 拖动文件（简单的 .txt 文件）时收到的内容：

```
[HTTP_USER_AGENT] => Microsoft-WebDAV-MiniRedir/6.1.7601
[HTTP_TRANSLATE] => f
[CONTENT_LENGTH] => 0
[HTTP_VIA] => 1.1 squid.Sole:3128 (squid/2.7.STABLE9), 1.0 squidcache.Proxy6.CCSP:3129 (squid/2.6.STABLE24)
[PATH] => /bin:/usr/bin:/sbin:/usr/sbin
[SERVER_SOFTWARE] => Apache
[SERVER_PORT] => 80
[GATEWAY_INTERFACE] => CGI/1.1
[SERVER_PROTOCOL] => HTTP/1.0
[REQUEST_METHOD] => PUT 
```

使用专用的 webdav 客户端上传相同的文件，我得到一个有效的响应并且文件正在上传。这是我使用 Cyber​​Duck 客户端得到的结果：

```
[HTTP_EXPECT] => 100-continue
[CONTENT_LENGTH] => 263
[CONTENT_TYPE] => text/plain
[HTTP_CONNECTION] => Keep-Alive
[HTTP_USER_AGENT] => Cyberduck/4.2.1 (9350) (Windows 7/6.1) (x86)
[HTTP_ACCEPT_ENCODING] => gzip,deflate
[PATH] => /bin:/usr/bin:/sbin:/usr/sbin
[SERVER_SOFTWARE] => Apache
[SERVER_PORT] => 80
[GATEWAY_INTERFACE] => CGI/1.1
[SERVER_PROTOCOL] => HTTP/1.1
[REQUEST_METHOD] => PUT 
```

CONTENT-LENGTH 字段已更改，并且文件在服务器上在线，就像我应该的那样。我将在这里发布我的代码片段：

```
$options = Array();
$options["path"] = $this->path;
$options["content_length"] = $_SERVER["CONTENT_LENGTH"];
$options["stream"] = fopen('php://input', 'r');

$stat = $this->PUT($options); // In the PUT method I fopen the destination file in "w"

if ($stat === false) {
    $stat = "403 Forbidden";
} else if (is_resource($stat) && get_resource_type($stat) == "stream") {
    $stream = $stat;

    $stat = $options["new"] ? "201 Created" : "204 No Content";
    if (!empty($options["ranges"])) {
        if (0 == fseek($stream, $range[0]["start"], SEEK_SET)) {
            $length = $range[0]["end"]-$range[0]["start"]+1;
            if (!fwrite($stream, fread($options["stream"], $length))) {
                 $stat = "403 Forbidden"; 
            }
        } else {
            $stat = "403 Forbidden"; 
        }
    }else {
        while (!feof($options["stream"])) {
            if (false === fwrite($stream, fread($options["stream"], 4096))) { //The fread reads nothing from the stream...
                $stat = "403 Forbidden"; 
                break;
            }
         }
      }
    fclose($stream);    
} 
```

我能做些什么来解决这个问题？有什么东西可以在 Windows 中设置以使其工作还是只是我的代码缺少一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:31:27.607

Windows 将首先创建一个 0 字节的文件。成功后，它将上传整个文件。

# javascript - 使用 JS 或 Jquery 检测 textarea 中的 url

> ID：12093350
> 
> 赞同：1
> 
> 时间：2012-08-23T13:57:38.583
> 
> 标签：javascript, jquery, regex, textarea

如何检测（在文本区域或其他输入中）用户是否已完成输入 url，就像 Facebook 在其主要形式中所做的那样？

像[这样](https://stackoverflow.com/questions/7705501/jquery-detect-and-validate-an-url)的解决方案仅在用户完成输入并执行操作（例如单击按钮）时才有效。

我希望在整个条目中检测 url，例如检查每个空格后输入的单词。

先感谢您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T14:49:49.137

这是一个有关如何执行此操作的示例：

```
$(function() {
    "use strict";
    var url = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;

    $("#textarea").on("keyup", function( e ) {
        var urls, output = "";
        if ( e.keyCode !== 8 && e.keyCode !== 9 && e.keyCode !== 13 && e.keyCode !== 32 && e.keyCode !== 46 ) {
            // Return is backspace, tab, enter, space or delete was not pressed.
            return;
        }

        while ((urls = url.exec(this.value)) !== null) {
            output += urls[0] + ", ";
        }
        console.log("URLS: " + output.substring(0, output.length - 2));
    });
}); 
```

当然，您必须绑定其他事件[`.blur()`](http://api.jquery.com/blur/)才能使其正常工作。

尝试以下小提琴并在您键入时检查您的控制台：http: [//jsfiddle.net/sQVe/mXQrc/1/](http://jsfiddle.net/sQVe/mXQrc/1/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-11T11:10:31.283

看看这个：[https](https://github.com/stephan-fischer/jQuery-LiveUrl/) ://github.com/stephan-fischer/jQuery-LiveUrl/ - 它干净、简单，并提供了 url 的预览！

![在此处输入图像描述](../Images/09fbf0a859f344437eb5f797a72898d0.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:02:21.847

您正在寻找的是 keypress 事件，您可以在此处查看文档和如何使用它的示例：http: [//api.jquery.com/keypress/](http://api.jquery.com/keypress/)

# javascript - 普通页面上的 window.close() - 或：如何处理已打开页面中的电子邮件链接

> ID：12093355
> 
> 赞同：2
> 
> 时间：2012-08-23T13:57:51.733
> 
> 标签：javascript, browser

为了处理已经打开的 Web 应用程序中的特殊 URL，我使用这种方法：

1.  用户在电子邮件中收到一个特殊的 URL（警报通知）
2.  URL 打开一个小的帮助网页 (H)，其中包含临时设置会话 cookie 的 JavaScript 代码
3.  已在另一个选项卡/窗口中打开的主 Web 应用程序 (M) 识别到这一点并在**删除**cookie后处理请求
4.  帮助网页 (H) 将其识别为成功，现在无用，应关闭。

除了帮助窗口（H）保持打开状态外，这一切都很好。当然有一个小文字说“请立即关闭此窗口”，但如果它可以自动执行此操作就完美了。

`window.close()` 在 IE 中导致确认对话框，而 FireFox 只是忽略该命令。我知道这是因为*没有*使用`window.open()`.

同样，在主窗口中调用`window.focus()`也不做任何事情。

有谁知道如何做到这一点？至少，在不关闭帮助窗口的情况下自动聚焦主窗口总比没有好。

当然，我也愿意接受其他解决方案来处理已经打开的 Web 应用程序中的电子邮件链接...... :)

*请注意，Web 应用程序（当然还有帮助页面）位于 HTTPS 服务器上。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:04:09.140

在某些浏览器中，如果窗口是通过 javascript 打开的，则只能通过 javascript 静默关闭（出于安全目的）。

此代码是绕过此安全措施的黑客：

```
// open a new window, replacing the current one
window.open('', '_self', '');
// close the current window, which was now technically opened via javascript
window.close(); 
```

使用风险自负。这些措施是为了防止您对页面的访问者做烦人/恶意的事情。

# ruby-on-rails - 推荐在使用 Trinidad 的 JRuby on Rails 应用程序中使用哪些消息队列工具？

> ID：12093356
> 
> 赞同：0
> 
> 时间：2012-08-23T13:57:55.893
> 
> 标签：ruby-on-rails, jruby, message-queue, torquebox, trinidad-gem

我是 Torquebox 的长期用户，但现在我想尝试使用 Trinidad 进行 JRuby on Rails 部署。使用 Trinidad 而不是 Torquebox 的最好的事情之一是您可以使用 Heroku :)

但是 Torquebox 具有使用 JMS 的消息队列功能，而 Trinidad 没有任何开箱即用的 MQ 功能。任何人都可以使用 Trinidad 推荐来自 JRuby on rails 的 MQ 工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T19:35:41.023

由于您使用的是 Heroku，我会选择 Heroku 附加组件区域中列出的托管消息代理。如果您决定自己托管，您可以将 ActiveMQ 或其他代理安装到一个或多个 EC2 实例上，并将安全组设置为允许来自 Heroku 的 EC2 实例的连接。无论您选择哪种方法，下一步都是简单地配置您的 JRuby on Rails 应用程序以连接到代理并根据需要发布/订阅。

# mercurial - Mercurial 不断返回错误 400：错误请求

> ID：12093362
> 
> 赞同：8
> 
> 时间：2012-08-23T13:58:14.350
> 
> 标签：mercurial, tortoisehg, http-status-code-400

每当我尝试与服务器进行任何交互时，Mercurial 都会返回“中止：HTTP 错误 400：错误请求”。我们没有使用任何身份验证，所以这不是问题。我们有其他三个开发人员在安装相同版本的 mercurial (2.2.3) 的同一 repo 上工作。他们没有任何问题，所以这让我觉得我正在破坏 .hg 文件夹中的某些东西或其他东西。但我真的一点头绪都没有。

我能够从新目录克隆和工作就好了。然而，大约 4 小时后，它也开始在新目录中再次发生。在那段时间里我唯一做的事情就是提交、拉取和推送。当我在几个小时后提交并尝试拉动时，那是我再次遇到错误的时候。

这是传入的调试日志（hg --debug --traceback incoming）：

```
using http://myserver/myapp
sending capabilities command
comparing with http://myserver/myapp
query 1; heads
sending batch command
searching for changes
taking initial sample
searching: 2 queries
query 2; still undecided: 208, sample size is: 200
sending known command
Traceback (most recent call last):
File "mercurial\dispatch.pyo", line 88, in _runcatch
File "mercurial\dispatch.pyo", line 740, in _dispatch
File "mercurial\dispatch.pyo", line 514, in runcommand
File "mercurial\dispatch.pyo", line 830, in _runcommand
File "mercurial\dispatch.pyo", line 801, in checkargs
File "mercurial\dispatch.pyo", line 737, in <lambda>
File "mercurial\util.pyo", line 472, in check
File "mercurial\extensions.pyo", line 144, in wrap
File "mercurial\util.pyo", line 472, in check
File "hgext\mq.pyo", line 3528, in mqcommand
File "mercurial\util.pyo", line 472, in check
File "mercurial\commands.pyo", line 3894, in incoming
File "mercurial\hg.pyo", line 513, in incoming
File "mercurial\hg.pyo", line 472, in _incoming
File "mercurial\bundlerepo.pyo", line 342, in getremotechanges
File "mercurial\discovery.pyo", line 45, in findcommonincoming
File "mercurial\setdiscovery.pyo", line 184, in findcommonheads
File "mercurial\wireproto.pyo", line 116, in plain
File "mercurial\wireproto.pyo", line 164, in _submitone
File "mercurial\httppeer.pyo", line 170, in _call
File "mercurial\httppeer.pyo", line 118, in _callstream
File "urllib2.pyo", line 406, in open
File "urllib2.pyo", line 519, in http_response
File "urllib2.pyo", line 444, in error
File "urllib2.pyo", line 378, in _call_chain
File "urllib2.pyo", line 527, in http_error_default
HTTPError: HTTP Error 400: Bad Request
abort: HTTP Error 400: Bad Request 
```

正如我之前所说，我可以进行克隆，但如果我尝试运行传入、传出、拉取或推送，我会收到此错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T13:55:55.703

我能够通过运行解决此问题

```
hg rollback 
```

一旦我运行它，它就会取消提交我的文件（但保留更改，所以我可以看到修改后的文件处于 hg 状态）。然后我能够运行传入和拉动。然后我重新提交了我的代码并将其推出，没有任何问题。

所以当我提交时，一定有一些东西被破坏了，只是不知道为什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-28T09:53:32.377

我不知道在这种特定情况下有什么问题。但是我们遇到了相同结果的不同问题 - 传入和拉取命令失败`400 Bad Request`。所以这里是如何调查失败的收据，以防万一`hg -v --debug`没有帮助。

[使用 Fiddler](https://www.wireshark.org/)来捕获和显示 HTTP 流量。然后运行 ​​mercurial 请求，如下所示：

```
hg --config http_proxy.host=127.0.0.1:8888 pull 
```

配置导致请求通过 Fiddler 重定向，它正在侦听端口 8888。然后在 Fiddler 中，您可能会找到红色的 400 回复，并在 Inspectors 窗格中查看整个消息，而不仅仅是代码。

您可以[在此处](http://barahilia.github.io/blog/computers/2014/10/09/hg-pull-via-http-fails-400.html)查看有关我们的问题、调查和解决方案的详细信息。

# python - 大型迭代器的笛卡尔积（itertools）

> ID：12093364
> 
> 赞同：16
> 
> 时间：2012-08-23T13:58:18.920
> 
> 标签：python, memory, itertools, cartesian-product

从[上一个问题](https://stackoverflow.com/questions/12064780/itertools-cartesian-product-of-permutations)中，我学到了一些有趣的东西。如果给 Python`itertools.product`提供了一系列迭代器，这些迭代器将在笛卡尔积开始*之前转换为元组。*[相关](https://stackoverflow.com/questions/10720247/pythons-itertools-product-memory-consumption) [问题](https://stackoverflow.com/questions/8695422/why-do-i-get-a-memoryerror-with-itertools-product)查看源代码得出的`itertools.product`结论是，虽然没有中间结果存储在内存中，但原始迭代器的元组版本是在产品迭代开始之前创建的。

**问题**：当（元组转换的）输入太大而无法保存在内存中时，有没有办法为笛卡尔积创建迭代器？简单的例子：

```
import itertools
A = itertools.permutations(xrange(100))
itertools.product(A) 
```

一个更实际的用例将采用一系列`(*iterables[, repeat])`类似函数的原始实现——上面只是一个例子。看起来你不能使用当前的实现`itertools.product`，所以我欢迎在纯 python 中提交（尽管你无法击败 C 后端`itertools`！）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T14:55:22.853

这是一个调用 callables 并迭代 iterables 的实现，假定它们是可重新启动的：

```
def product(*iterables, **kwargs):
    if len(iterables) == 0:
        yield ()
    else:
        iterables = iterables * kwargs.get('repeat', 1)
        it = iterables[0]
        for item in it() if callable(it) else iter(it):
            for items in product(*iterables[1:]):
                yield (item, ) + items 
```

测试：

```
import itertools
g = product(lambda: itertools.permutations(xrange(100)),
            lambda: itertools.permutations(xrange(100)))
print next(g)
print sum(1 for _ in g) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:42:49.237

如果没有“迭代器再造”，第一个因素可能是可能的。但这只会节省 1/n 的空间（其中 n 是因子的数量）并增加混乱。

所以答案是迭代器再造。该函数的客户端必须确保迭代器的创建是纯的（没有副作用）。像

```
def iterProduct(ic):
    if not ic:
        yield []
        return

    for i in ic[0]():
        for js in iterProduct(ic[1:]):
            yield [i] + js

# Test
x3 = lambda: xrange(3)
for i in iterProduct([x3,x3,x3]):
    print i 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T15:16:18.867

这不能用标准的 Python 生成器来完成，因为某些可迭代对象必须循环多次。您必须使用某种能够“重复”的数据类型。我创建了一个简单的“可重复”类和一个非递归乘积算法。`product`应该有更多的错误检查，但这至少是第一种方法。简单的可重复类...

```
class PermutationsReiterable(object):
    def __init__(self, value):
        self.value = value
    def __iter__(self):
        return itertools.permutations(xrange(self.value)) 
```

而`product`自己...

```
def product(*reiterables, **kwargs):
    if not reiterables:
        yield ()
        return
    reiterables *= kwargs.get('repeat', 1)

    iterables = [iter(ri) for ri in reiterables]
    try:
        states = [next(it) for it in iterables]
    except StopIteration:
        # outer product of zero-length iterable is empty
        return
    yield tuple(states)

    current_index = max_index = len(iterables) - 1
    while True:
        try:
            next_item = next(iterables[current_index])
        except StopIteration:
            if current_index > 0:
                new_iter = iter(reiterables[current_index])
                next_item = next(new_iter)
                states[current_index] = next_item
                iterables[current_index] = new_iter
                current_index -= 1
            else:
                # last iterable has run out; terminate generator
                return
        else:
            states[current_index] = next_item
            current_index = max_index
            yield tuple(states) 
```

测试：

```
>>> pi2 = PermutationsReiterable(2)
>>> list(pi2); list(pi2)
[(0, 1), (1, 0)]
[(0, 1), (1, 0)]
>>> list(product(pi2, repeat=2))
[((0, 1), (0, 1)), ((0, 1), (1, 0)), ((1, 0), (0, 1)), ((1, 0), (1, 0))]
>>> giant_product = product(PermutationsReiterable(100), repeat=5)
>>> len(list(itertools.islice(giant_product, 0, 5)))
5
>>> big_product = product(PermutationsReiterable(10), repeat=2)
>>> list(itertools.islice(big_product, 0, 5))
[((0, 1, 2, 3, 4, 5, 6, 7, 8, 9), (0, 1, 2, 3, 4, 5, 6, 7, 8, 9)), 
 ((0, 1, 2, 3, 4, 5, 6, 7, 8, 9), (0, 1, 2, 3, 4, 5, 6, 7, 9, 8)), 
 ((0, 1, 2, 3, 4, 5, 6, 7, 8, 9), (0, 1, 2, 3, 4, 5, 6, 8, 7, 9)), 
 ((0, 1, 2, 3, 4, 5, 6, 7, 8, 9), (0, 1, 2, 3, 4, 5, 6, 8, 9, 7)), 
 ((0, 1, 2, 3, 4, 5, 6, 7, 8, 9), (0, 1, 2, 3, 4, 5, 6, 9, 7, 8))] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-15T02:54:28.973

我很抱歉提出这个话题，但是在花了几个小时调试一个程序试图迭代递归生成的生成器的笛卡尔积之后。我可以告诉你，如果不使用上面所有示例中的常数，上述解决方案都不起作用。

更正：

```
from itertools import tee

def product(*iterables, **kwargs):
    if len(iterables) == 0:
        yield ()
    else:
        iterables = iterables * kwargs.get('repeat', 1)
        it = iterables[0]
        for item in it() if callable(it) else iter(it):
            iterables_tee = list(map(tee, iterables[1:]))
            iterables[1:] = [it1 for it1, it2 in iterables_tee]
            iterable_copy = [it2 for it1, it2 in iterables_tee]
            for items in product(*iterable_copy):
                yield (item, ) + items 
```

如果您的生成器包含生成器，则需要将副本传递给递归调用。

# php - 新版gapi类

> ID：12093367
> 
> 赞同：2
> 
> 时间：2012-08-23T13:58:21.297
> 
> 标签：php, api

我在我的项目中使用了 gapi 类（1.3 版）来使用谷歌分析。但最近它停止了工作。例如，我无法检索 ga 帐户的项目。我想这是因为谷歌分析的更新而发生的。也许某个地方存在新版本的 gapi 类？有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:17:57.393

我发现这个类[http://code.google.com/p/google-api-php-client/source/browse/trunk/examples/analytics/simple.php](http://code.google.com/p/google-api-php-client/source/browse/trunk/examples/analytics/simple.php)来解决问题。但与 Gapi 类 1.3 版相比，它有完全不同的想法

也许有人知道更好的解决方案...

# c# - 根据文化显示日期

> ID：12093368
> 
> 赞同：1
> 
> 时间：2012-08-23T13:58:25.167
> 
> 标签：c#, javascript, asp.net

我想显示日期时间（我放在母版页上）；在当前文化的基础上使用不同的语言。

我在master上的javascript代码：

```
 <script type="text/javascript">
        var t;
        $(document).ready(function pageLoad() {
            setTimeout('SetTime()', 1000);
        });

        function SetTime() {
            var date = new Date();
            date.format = 'MM.DD.YYYY';
            $get('<%=lbl.ClientID %>').innerHTML = date.toLocaleDateString() + " : " + date.toLocaleTimeString();
            setTimeout("SetTime()", 1000);
        }  

    </script> 
```

即使我设置了不同的文化，它总是以英语显示日期时间字符串：法语或其他任何文化。

我通过母版页的代码隐藏文件尝试了其他方式：

```
 protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    Timer1.Tick += new EventHandler<EventArgs>(Timer1_Tick);
}

void Timer1_Tick(object sender, EventArgs e)
{
    Label2.Text = DateTime.Now.ToLongDateString() + " " + DateTime.Now.ToLongTimeString();
    UpdatePanel1.Update();
} 
```

在这里，我根据选择的文化获取不同语言的日期字符串。但我不想使用定时器。有什么办法，我可以在不使用计时器的情况下实现这一点。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:01:16.497

`toLocaleDateString`使用客户端的语言环境（通常需要重新启动浏览器才能使更改生效），并且不一定与 .NET 线程中使用的文化相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:15:27.977

试试用这个，

```
function SetTime() {
    var date = new Date();
    var dateFormat = '<%=System.Threading.Thread.CurrentThread.CurrentCulture.DateTimeFormat.ShortDatePattern%>';
    var timeFormat = '<%=System.Threading.Thread.CurrentThread.CurrentCulture.DateTimeFormat.LongTimePattern%>';
     var datetimeFormat = dateFormat + " " + timeFormat;
     var cultureSpecificValue= date.toString(datetimeFormat);
    alert(cultureSpecificValue);

   //Your Code

} 
```

我在上面的代码中使用了[Datejs](http://code.google.com/p/datejs/wiki/APIDocumentation)日期时间库的“toString”函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:33:38.410

由于您拥有 ScriptManager 控件和页面，因此您可以使用 Microsoft Ajax Date 对象扩展。为此，将 ScriptManager 的`EnableScriptGlobalization`属性设置为`true`。然后你可以使用这个脚本：

```
var localDate = new Date().localeFormat("F"); 
```

更多关于 Microsoft Ajax 扩展的信息：[Microsoft Ajax JavaScript Base Type Extensions](http://msdn.microsoft.com/en-us/library/bb310818.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T14:08:26.520

您可以在 web.config 文件中定义它，如下所示：

`<globalization enableClientBasedCulture="true" culture="auto:en-GB" uiCulture="auto:en"/>`

这应该启用基于客户端的格式，如果客户端未定义，则选择默认值

为您的 derired 结果修改为 nessecary。

如果您只想在特定页面上设置它，请将`Date.format = 'yyyy-mm-dd';` 您的 javascript 函数放在外部。

//问候

# perl - 根据另一个列表中唯一值的索引从一个列表中获取相应的值 - Perl

> ID：12093369
> 
> 赞同：0
> 
> 时间：2012-08-23T13:58:26.633
> 
> 标签：perl

我想使用 perl 根据我的第一个列表中唯一值的索引值从第二个列表中获取相应的值。

例如：

```
@list1=('a','b','c','a','d');
@list2=('e','f','g','a','i'); 
```

我想创建两个没有重复值的新列表

```
@new_list1=('a','b','c','d');
@new_list2=('e','f','g','i'); 
```

我怎样才能做到这一点？

要从一个列表中获取唯一值，我可以使用：

```
my %temp_hash = map { $_, 0 } @list1;
my @uniq_array = keys %temp_hash;   
print "@uniq_array\n"; 
```

但是如何从另一个列表中获取相应索引处的值。

提前致谢。

编辑：它应该根据某些条件而不是第一次出现找到唯一值。例如：

```
@list1=('a','b','c','a','d');
@list2=('e','f','g','a','i'); 
```

和

```
@list1=('a','b','c','a','d');
@list2=('a','f','g','e','i'); 
```

应该给出相同的值：

```
@new_list1=('a','b','c','d');
@new_list2=('e','f','g','i'); 
```

在给定的示例中，条件可能是不包括两个列表的值相同的公共元素。即有两次出现'a'第一次'a'对应于'e'，第二个'a'对应于'a'。所以要删除第二个而不是第一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:02:59.803

在处理并行数组时，需要处理索引。要查找索引列表，可以从以下查找唯一值的[常用方法开始：](http://perldoc.perl.org/perlfaq4.html#How-can-I-remove-duplicate-elements-from-a-list-or-array?)

```
my %seen;
my @uniq = grep !$seen{$_}++, @dups; 
```

并展开它以将索引列表作为输入：

```
my %seen;
my @indexes = grep !$seen{ $list1[$_] }++, 0..$#list1; 
```

在您更新的问题中，您需要更复杂的东西：

```
my %options;
for (0..$#list1) {
   push @{ $options{ $list1[$_] } }, $_;
}

my %seen;
my @indexes;
for (0..$#list1) {
   next if $seen{$_}++;
   my @options = @{ $options{ $list1[$_] } };
   my $option = pick(\@list1, \@list2, \@options) // $options[0];
   push @indexes, $option;
} 
```

然后您所要做的就是提取所需的元素：

```
my @new_list1 = @list1[ @indexes ];
my @new_list2 = @list2[ @indexes ]; 
```

您描述的可能选择算法的`pick`功能是：

```
sub pick {
   my ($list1, $list2, $options) = @_;
   return ( grep $list1->[$_] ne $list2->[$_], @options )[0];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:17:15.137

```
use strict;
use warnings;
use Data::Dumper;

my @list1=('a','b','c','a','d');
my @list2=('e','f','g','a','i');

my %hash1 = ();
my %hash2 = ();

$hash1{$_}++ for @list1;

my @uniq_list1 = sort keys %hash1;

for (@list2)
{
    next if defined ($hash1{$_});
    $hash2{$_}++;
}
my @uniq_list2 = sort keys %hash2;

print Dumper(\@uniq_list1);
print Dumper(\@uniq_list2); 
```

**输出：**

```
$VAR1 = [
          'a',
          'b',
          'c',
          'd'
        ];

$VAR1 = [
          'e',
          'f',
          'g',
          'i'
        ]; 
```

# php - PHP MySQLi 多查询 - 命令不同步：mysqli_fetch_array

> ID：12093370
> 
> 赞同：0
> 
> 时间：2012-08-23T13:58:27.847
> 
> 标签：php, mysqli

我目前正在用 PHP 创建一个页面，该页面将显示用户及其在我网站的高分中的排名。

我遇到了一个问题，我的 MySQL 查询没有按预期运行，但是，@VladBalmos 在这里解决了我的问题：[MySQL Highscores - User's Personal Ranks: Duplicate Entries Causeing Incorrect Values](https://stackoverflow.com/questions/12091313/mysql-highscores-users-personal-ranks-duplicate-entries-causing-incorrect-va)

现在我相信我的 MySQL 查询正在运行，我需要解决我的 PHP 代码出现的问题。这是我的代码：

```
$userid = (int) $_GET['searched'];
    for ($i = 0; $i < 5; $i++) {
        if ($i == 0) {
            $skill_query = mysqli_query($database, "SELECT uid, overall, overallxp, gamelevel FROM playerstats WHERE uid = ". $userid ." ORDER BY playerstats.overall DESC, playerstats.overallxp DESC") or print(mysqli_error($database));
            $skill_array = mysqli_fetch_array($skill_query);
            //old rank query: $rank_query = mysqli_query($database, "SELECT count(*) + 1 FROM (SELECT uid, overall, overallxp, gamelevel FROM playerstats GROUP BY playerstats.uid) AS x WHERE overall > (SELECT overall FROM playerstats WHERE uid = ". $userid .")") or print(mysqli_error($database));
            $rank_query = mysqli_multi_query($database, "SET @rank=0; SELECT rank, uid, overall, overallxp FROM (SELECT @rank:=@rank + 1 AS rank, uid, overall, overallxp FROM playerstats ORDER BY overall DESC, overallxp DESC) as tmp") or print(mysqli_error($database));
            $rank_array = mysqli_fetch_array($rank_query);
        } else {
            $skill_query = mysqli_query($database, "SELECT uid, ". $skills[$i] .", gamelevel FROM playerstats WHERE uid = ". $userid ." ORDER BY playerstats.". $skills[$i] ." DESC, playerstats.gamelevel DESC") or print(mysqli_error($database));
            $skill_array = mysqli_fetch_array($skill_query);
            $rank_query = mysqli_query($database, "SELECT count(*) + 1 FROM (SELECT uid, ". $skills[$i] .", gamelevel FROM playerstats GROUP BY playerstats.uid) AS x WHERE ". $skills[$i] ." > (SELECT ". $skills[$i] ." FROM playerstats WHERE uid = ". $userid .")") or print(mysqli_error($database));
            $rank_array = mysqli_fetch_array($rank_query);
        }

        echo "<tr class='hs_row'>";
        echo "<td align='center'>";
        echo $rank_array[0]; //rank output
        echo "</td>";
        echo "<td align='center'>";
        echo $skill_array[1]; //skilllevel
        echo "</td>";
        echo "<td align='center'>";
        if ($i == 0) {
            echo number_format($skill_array[2]); //skillxp
        } else {
            echo number_format($skill_array[1]); //skillxp
        }
        echo "</td></tr>";
    } 
```

...我收到的错误是：

> 警告：mysqli_fetch_array() 期望参数 1 为 mysqli_result，布尔值在第 156 行的 [path]/personal.php 中给出
> 
> 命令不同步；你现在不能运行这个命令
> 
> 警告：mysqli_fetch_array() 期望参数 1 为 mysqli_result，布尔值在第 159 行的 [path]/personal.php 中给出
> 
> 命令不同步；你现在不能运行这个命令
> 
> 警告：mysqli_fetch_array() 期望参数 1 为 mysqli_result，布尔值在第 161 行的 [path]/personal.php 中给出
> 
> 命令不同步；你现在不能运行这个命令

所以，我的问题是，我该如何纠正这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:11:55.283

```
$rank_query = mysqli_multi_query($database, $yourQuery);
if($rank_query) {
    while(mysqli_next_result($dabatase)) {
        if($result = mysqli_store_result($database)) {
            while($row = mysqli_fetch_row($result) {
                // do something
            }
        }

    }
} 
```

您必须遍历多个查询的结果，然后访问每个结果集的行。由于第一个查询只是设置了一个变量，因此您必须跳到下一个结果集并获取实际行（这就是我这样做的原因 *while(mysqli_next_result...*) 阅读[php 手册中的文档](http://php.net/manual/en/mysqli.multi-query.php)

# opengl - 使用 Python 完成 NeHe 教程

> ID：12093372
> 
> 赞同：0
> 
> 时间：2012-08-23T13:58:34.053
> 
> 标签：opengl

[http://nehe.gamedev.net/](http://nehe.gamedev.net/)这里写的教程是用 C++ 完成的。但是如果我对OpenGL有正确的理解，那么OpenGL编程可以通过绑定的方式用多种语言完成。这意味着本教程中的所有代码都可以在 Python 中实现。这个对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-18T07:56:21.753

PyOpenGL 是一个与 OpenGL 的 Python 绑定，值得一试。它的主页是[PyOpenGL——Python OpenGL Binding](http://pyopengl.sourceforge.net/)。

该网站包括关于将几个 NeHe 教程示例改编为 Python 的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T17:45:02.623

除了一些窗口和 OpenGL 上下文处理之外，所有代码都应该能够完全移植到 Python。

# java - 如何从 java 访问 ilog 决策变量？

> ID：12093374
> 
> 赞同：2
> 
> 时间：2012-08-23T13:58:37.363
> 
> 标签：java, simulation, cplex, ilog

我有一个在 IBM ILOG CPLEX Optimization Studio 中建模的线性问题，它返回正确的解决方案，即目标值。出于模拟目的，我使用了一个 ILOG 模型模型文件和一个我都从 java 调用的数据文件：

```
IloOplFactory.setDebugMode(false);
IloOplFactory oplF = new IloOplFactory();
IloOplErrorHandler errHandler = oplF.createOplErrorHandler(System.out);
IloOplModelSource modelSource = oplF.createOplModelSource("CDA_Welfare_Examination_sparse2.mod");
IloCplex cplex = oplF.createCplex();
IloOplSettings settings = oplF.createOplSettings(errHandler);
IloOplModelDefinition def=oplF.createOplModelDefinition(modelSource,settings);
IloOplModel opl=oplF.createOplModel(def,cplex);

String inDataFile =  path;
IloOplDataSource dataSource=oplF.createOplDataSource(inDataFile);
opl.addDataSource(dataSource);

opl.generate();
opl.convertAllIntVars(); // converts integer bounds into LP compatible format
if (cplex.solve()){                              
 }
else{
System.out.println("Solution could not be achieved, probably insufficient memory or some other weird problem.");
             } 
```

现在，我想从 java 访问实际的决策变量 match[Matchable]。

在 ILOG CPLEX Optimization Studio 中，我使用以下命名法：

```
tuple bidAsk{
int b;
int a;  
}

{bidAsk} Matchable = ...;

dvar float match[Matchable]; 
```

在 Java 中，我通过以下方式访问目标值（效果很好）：

```
double sol = new Double(opl.getSolutionGetter().getObjValue()); 
```

现在，我如何访问决策变量“match”？到目前为止，我已经开始

```
IloOplElement dVarMatch = opl.getElement("match"); 
```

但我似乎无法更进一步。非常感谢您的帮助！非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T22:30:56.733

你在正确的轨道上。您需要获取表示 Matchable 中每个有效 bidAsk 的元组，然后将元组用作决策变量对象的索引。这是 Visual Basic 中的一些示例代码（我现在正在写的东西，应该很容易翻译成 java）：

```
 ' Get the tuple set named "Matchable"
  Dim matchable As ITupleSet = opl.GetElement("Matchable").AsTupleSet
  ' Get the decision variables named "match"
  Dim match As INumVarMap = opl.GetElement("match").AsNumVarMap

  ' Loop through each bidAsk in Matchable
  For Each bidAsk As ITuple In matchable
     ' This is the current bidAsk's 'b' value
     Dim b As Integer = bidAsk.GetIntValue("b")

     ' This is the current bidAsk's 'a' value
     Dim a As Integer = bidAsk.GetIntValue("a")

     ' this is another way to get bidAsk.b and bidAsk.a
     b = bidAsk.GetIntValue(0)
     a = bidAsk.GetIntValue(1)

     ' This is the decision variable object for match[<b,a>]
     Dim this_variable As INumVar = match.Get(bidAsk)

     ' This is the value of that decision variable in the current solution
     Dim val As Double = opl.Cplex.GetValue(this_variable)
  Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:00:25.693

您可以像这样通过 IloCplex-Object 获取变量值：

```
cplex.getValue([variable reference]); 
```

我从来没有进口过这样的模型。当您在 java 中创建模型时，对决策变量的引用很容易获得，但应该有一种获取变量的方法。您可以查看文档：

[复杂文档](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.ide.help/html/refjavaopl/html/overview-summary.html)

# flash - Flash，SecurityError：错误 #2028：Local-with-filesystem SWF 无法访问 Internet URL

> ID：12093375
> 
> 赞同：0
> 
> 时间：2012-08-23T13:58:39.613
> 
> 标签：flash, security

我的应用程序非常依赖许多 flashfile，不幸的是，当我尝试在与我们一直在开发它的服务器不同的服务器上运行我的应用程序时，我收到以下错误：

```
SecurityError：错误 #2028：Local-with-filesystem SWF 文件 file:///C|/Users/user/Desktop/flash/flash.swf 无法访问 Internet URL rtmp://192.168.1.33/rtmp
```

我尝试将`crossdomain.xml`文件添加到服务器，但是它不起作用。我能做些什么来允许该文件访问该流吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T06:51:43.930

好吧，这对我有用：添加以下内容`crossdomain.xml`：

```
`<?xml version="1.0" ?>
<cross-domain-policy>
<allow-access-from domain="*" />
</cross-domain-policy>` 
```

`即使在我的情况下它不是很安全。`

# ajax - jQuery Masonry 和 Ajax-fetching 追加项目导致图像重叠

> ID：12093378
> 
> 赞同：4
> 
> 时间：2012-08-23T13:58:53.557
> 
> 标签：ajax, append, jquery-masonry, getimagesize

此处使用 Masonry 和 Ajax 在 Wordpress 中附加项目的另一个图像重叠问题。第一次添加更多项目时，图像会重叠。但是，当页面重新加载时，图像不再重叠。在做了一些研究后，我意识到这与计算图像的高度有关。

在 Masonry 网站的帮助页面中，建议使用**getimagesize**函数来指定图像的宽度和高度。

但是，这就是我卡住的地方。由于我对 PHP 的了解有限，我不知道如何使用这个函数或将它放在我的代码中的什么位置，所以我在这里寻找一点方向。谁能帮我弄清楚如何将**getimagesize**函数集成到我的代码中？

这是砌体代码：

```
$(document).ready(function(){

    var $container = $('#loops_wrapper');

    $container.imagesLoaded( function(){
      $container.masonry({
        itemSelector : '.post_box',
        columnWidth: 302

        });
      });
    }); 
```

这是ajax获取代码：

```
$('.load_more_cont a').live('click', function(e) {
    e.preventDefault();
    $(this).addClass('loading').text('Loading...');
    $.ajax({
        type: "GET",
        url: $(this).attr('href') + '#loops_wrapper',
        dataType: "html",
        success: function(out) {
            result = $(out).find('.post_box');
            nextlink = $(out).find('.load_more_cont a').attr('href');

            $('#loops_wrapper').append(result).masonry('appended', result);
            $('.load_more_cont a').removeClass('loading').text('Load more posts');

            if (nextlink != undefined) {
                $('.load_more_cont a').attr('href', nextlink);
            } else {
                $('.load_more_cont').remove();
            }
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:13:46.457

您可以尝试在此处实施 David DeSandro 的计时器方法来附加图像...

“正如入门所推荐的，处理图像的最佳解决方案是在 img 标签中定义尺寸属性，尤其是在使用无限滚动时。这是下面示例中采用的解决方案。

当然，这在某些 CMS 中不是一个可行的选择，尤其是 Tumblr。在这种情况下，需要在新附加的图像完全加载后调用 Masonry。这是通过延迟 Masonry 回调来完成的。”

```
function( newElements ) {
    setTimeout(function() {
    $wall.masonry({ appendedContent: $(newElements) });
    }, 1000);
} 
```

**编辑**：如果您无法实现添加无限滚动项目的常见延迟想法，您可以尝试在添加新项目后重新加载，而不是

```
$('#loops_wrapper').append(result).masonry('appended', result); 
```

那样做

```
$("#loops_wrapper").append(result).masonry('reload'); 
```

# android - 在长时间运行的操作中要求用户输入

> ID：12093379
> 
> 赞同：0
> 
> 时间：2012-08-23T13:59:00.077
> 
> 标签：android, multithreading, android-asynctask

我有一个应用程序，用户可以在其中将文件备份到服务器/从服务器恢复。

在恢复操作期间，在下载每个文件之前，我会检查文件是否已经存在（假设我知道原始路径）。

`boolean fileExists(String path);`

如果文件存在，我想询问用户是否希望下载和重命名、下载和替换，或者跳过当前文件。

例如，这可能是自定义`AlertDialog`的（使用`AlertDialog.Builder`和 xml 布局）。

所以代码将类似于：

```
static final int DECISION_NO_ANSWER = -1;
static final int DECISION_RENAME = 0;
static final int DECISION_REPLACE = 1;
static final int DECISION_SKIP = 2;

int userDecision;

for (RestoreFile file : ListOfFiles) {
    userDecision = DECISION_NO_ANSWER;
    if (fileExists(file.getOriginalPath())){
        OptionsDialog.show();
        // wait for answer
    }

    switch(userDecision){
        // handle different cases and update ProgressBar
    }
} 
```

当然，这段代码应该在单独的线程中运行。

如果我使用`AsyncTask`这里是我将如何等待答案：

```
while(userDecision == DECISION_NO_ANSWER){
    try {
        Thread.sleep(30);
    } catch (InterruptedException e) {}
} 
```

如果我使用a，`Thread`我可以使用wait() 和notify()。我将不得不使用 a`Handler`来更新`ProgressBar`.

那么哪个更好（`AsyncTask`或`Thread`）？还是有第三种更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:11:19.050

一个 asynctask 在一个线程中运行，就像一切一样。您可以使用等待和通知，以及处理程序或 onProgressUpdate 来通知进度条和所有内容。

# iis - 跟踪 HttpModule 调用

> ID：12093384
> 
> 赞同：3
> 
> 时间：2012-08-23T13:59:12.470
> 
> 标签：iis, httpmodule

我正在开发一个 HttpModule。它的一些事件没有被调用，我认为这是因为安装的其他 HttpModules 正在结束请求或类似的东西。

是否可以将 IIS 配置为按顺序生成所有 HttpModule 请求的日志？

例如：

HttpModule1 BeginRequest 被调用。

HttpModule2 BeginRequest 被调用。

所以我会知道在每个 HttpModule 上调用了哪些方法？（并尝试确定请求结束的原因和位置）

**注意：**我不控制所有模块，所以我不能只在所有模块中添加日志......

# c# - 使用 WCF 从 .svc 创建 .cs 文件的正确方法

> ID：12093386
> 
> 赞同：3
> 
> 时间：2012-08-23T13:59:19.600
> 
> 标签：c#, web-services

A 有一个带有 web 服务及其单元测试的 .Net 解决方案。网络服务有它的 .svc 并且从测试项目中我需要 .cs （据我所知，从服务的 url 生成。像这样的东西`svcutil.exe [WebServiceUrl]`）。

为了自动化单元测试，我需要在每个构建中更新测试项目的这个 .cs，所以我添加了一个预构建事件，它调用 svcutil.exe 来获取 wsdl 并生成 .cs。这一步需要服务运行，但我需要从项目本身创建它，我不希望服务运行来创建.cs。有没有办法做到这一点？或另一种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:14:48.397

您可以在仅用于此目的的单独程序集中自行托管 WCF 服务，然后运行 ​​svcutil.exe 以获取 WSDL 输出并从中生成 .cs 文件。

当然，这意味着您必须首先构建 WCF 主机程序集，然后运行 ​​svcutil.exe，然后构建单元测试程序集和解决方案中的其余程序集。这一切都可以通过构建工作流程中的预构建活动来完成。

# java - 我的线程获得了读锁，但是当试图释放它时抛出 IllegalMonitorStateException

> ID：12093391
> 
> 赞同：5
> 
> 时间：2012-08-23T13:59:33.877
> 
> 标签：java, exception, reentrantreadwritelock

我的应用程序部署在带有 java 6 update 30 的 Weblogic 10.3.5 上。执行此代码行时遇到以下错误：

```
 lock.readLock().lock();
    try {
        holder = cache.get(configName);
        // If it exists in the cache, return it
        if (holder != null)
            return holder;
    } finally {
        lock.readLock().unlock();
    } 
```

在类加载期间初始化锁：

```
private final ReentrantReadWriteLock lock = new ReentrantReadWriteLock(); 
```

缓存是：

```
private Map<String, ConfigurationHolder> cache = new HashMap<String,ConfigurationHolder>(); 
```

突然抛出了 IllegalMonitorStateException：

```
Caused by: java.lang.IllegalMonitorStateException
    at java.util.concurrent.locks.ReentrantReadWriteLock$Sync.tryReleaseShared(ReentrantReadWriteLock.java:363)
    at java.util.concurrent.locks.AbstractQueuedSynchronizer.releaseShared(AbstractQueuedSynchronizer.java:1317)
    at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.unlock(ReentrantReadWriteLock.java:745) 
```

我[在这里](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7099601)阅读了与这种情况类似的描述。

有人知道为什么会这样吗？

# ruby - 访问在另一个 rb 文件中声明的变量

> ID：12093394
> 
> 赞同：9
> 
> 时间：2012-08-23T13:59:44.413
> 
> 标签：ruby

这是一个关于包含 .rb 文件的初学者问题。

我想访问在另一个 rb 文件中声明的数组。我的主程序是这样的：

```
#!/usr/bin/env ruby
load 'price.rb'
[...]
max_price = price[az][type] * 2
[...] 
```

这是 price.rb ：

```
price = {'us-east-1' => {'t1.micro' => 0.02, 'm1.small' => 0.08, 'c1.medium' => 0.165, 'm1.large' => 0.320 },
'us-west-1' => {'t1.micro' => 0.02, 'm1.small' => 0.08, 'c1.medium' => 0.165, 'm1.large' => 0.320 },
'eu-west-1' => {'t1.micro' => 0.02, 'm1.small' => 0.085, 'c1.medium' => 0.186, 'm1.large' => 0.340 }
} 
```

当我运行主脚本时，出现此错误：

```
Error: undefined local variable or method `price' for main:Object 
```

你怎么看 ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T17:33:05.283

从一个文件导出数据并在另一个文件中使用它的最佳方式是类或模块。

一个例子是：

```
# price.rb
module InstancePrices
  PRICES = {
    'us-east-1' => {'t1.micro' => 0.02, ... },
    ...
  }
end 
```

在另一个文件中，您可以`require`这样做。使用`load`不正确。

```
require 'price'

InstancePrices::PRICES['us-east-1'] 
```

您甚至可以使用以下方法缩短此时间`include`：

```
require 'price'

include InstancePrices
PRICES['us-east-1'] 
```

不过，您所做的有点难以使用。适当的面向对象设计会将这些数据封装在某种类中，然后为其提供接口。直接公开您的数据与这些原则背道而驰。

例如，您需要一种`InstancePrices.price_for('t1.micro', 'us-east-1')`能够返回正确定价的方法。通过将用于存储数据的内部结构与接口分离，您可以避免在应用程序中创建巨大的依赖关系。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:03:31.043

在一个小而简单的类中声明变量将是更清洁的解决方案恕我直言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T14:22:58.780

来自[Ruby 论坛](http://www.ruby-forum.com/topic/55540)的引述：

> 请记住，使用 load 使局部变量保持在文件内的范围内。

这意味着您只能使用非本地*价格*变量；带有实例变量的示例：

```
@price = {'us-east-1' => {'t1.micro' => 0.02, 'm1.small' => 0.08, 'c1.medium' => 0.165, 'm1.large' => 0.320 }, 'us-west-1' => {'t1.micro' => 0.02, 'm1.small' => 0.08, 'c1.medium' => 0.165, 'm1.large' => 0.320 }, 'eu-west-1' => {'t1.micro' => 0.02, 'm1.small' => 0.085, 'c1.medium' => 0.186, 'm1.large' => 0.340 } } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-10-22T06:02:00.177

您不能从另一个文件访问变量，**但您可以从另一个文件访问函数**：

文件1.rb

```
# in case of script you may use 'global' variables (with $) 
# as they have scope visibility to this whole file 
$foo = 'bar'

def getFoo
    $foo
end 
```

文件2.rb

```
require_relative 'file1.rb'
foo = getFoo
# ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T14:12:19.400

我想忘记文件。

想想类和方法。

几个选项是：

*   将这些方法和变量放在一个类中的一个 .rb 文件中。

*   将变量和方法放在不同的文件`include`中

您需要考虑类和方法以及包含和扩展，以获得有意义的解决方案。

# android - 使用 ActivityInstrumentationTestCase2 通过 Intent 传递输入数据 (NDEF msgs) 来测试 Android 应用程序

> ID：12093401
> 
> 赞同：0
> 
> 时间：2012-08-23T14:00:06.333
> 
> 标签：android, android-intent, junit, instrumentation, ndef

很长一段时间以来，我都可以通过阅读 StackOverflow 上的许多不同帖子来解决我的问题，但现在我的问题变得非常有趣。我被卡住了，也许有人可以给我一些提示：

我想使用**ActivityInstrumentationTestCase2**测试 Android 应用程序。我的测试场景如下：我的 Android 设备上的数据库中有几个测试数据集（十六进制字符串，编码有效和无效的 NDEF 消息）。我为数据库中的每个行条目生成了一个 java 文件，其中包含对我要测试的应用程序的调用。

以下是这些功能之一的示例：

```
public void testNdefPush0() {

    Intent intent = new Intent(NfcAdapter.ACTION_TAG_DISCOVERED);
    NdefMessage[] msg;
    try {
        msg = new NdefMessage[] { new NdefMessage(new byte[] { (byte) 0xD1,
                (byte) 0x02, (byte) 0x1F, (byte) 0x53, (byte) 0x70,
                (byte) 0x91, (byte) 0x01, (byte) 0x0D, (byte) 0x00,
                (byte) 0x6E, (byte) 0x66, (byte) 0x63, (byte) 0x2D,
                (byte) 0x66, (byte) 0x6F, (byte) 0x72, (byte) 0x75,
                (byte) 0x6D, (byte) 0x2E, (byte) 0x6F, (byte) 0x72,
                (byte) 0x67, (byte) 0x51, (byte) 0x01, (byte) 0x0A,
                (byte) 0x55, (byte) 0x67, (byte) 0x6F, (byte) 0x6F,
                (byte) 0x67, (byte) 0x6C, (byte) 0x65, (byte) 0x2E,
                (byte) 0x63, (byte) 0x6F, (byte) 0x6D }) };
    } catch (Exception e) {
        throw new RuntimeException("Failed to create NdefMessage", e);
    }
    intent.putExtra(NfcAdapter.EXTRA_NDEF_MESSAGES, msg);

    setActivityIntent(intent);

    solo = new Solo(getInstrumentation(), getActivity());

} 
```

如您所见，我使用了 Robotium 框架，并按照他们的常见问题解答和教程进行了所有设置（特别是：[https](https://code.google.com/p/robotium/wiki/RobotiumForAPKFiles) ://code.google.com/p/robotium/wiki/RobotiumForAPKFiles ）

我正在使用专门的[Instrumentation Runner](https://code.google.com/p/the-missing-android-xml-junit-test-runner/)，它能够将结果写入 xml 文件，并且似乎适合我的需要；这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="de.nfc"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />

    <uses-permission android:name="android.permission.NFC" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <instrumentation
        android:name="pl.polidea.instrumentation.PolideaInstrumentationTestRunner"
        android:targetPackage="se.anyro.nfc_reader" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <uses-library android:name="android.test.runner" />
    </application>

</manifest> 
```

到目前为止我已经尝试/取得的成就：

*   我想测试的应用程序是第三方应用程序，所以我用我的调试密钥重新签署了它们。（作品）
*   由于我想测试不同的应用程序，我在手机上实现了包含测试用例的 Java 文件的生成；因此，通过按钮单击包含`*.java`我所有测试的文件（构造函数、setUp()、testNdefPush0() ... testNdefPush100()、tearDown()）并`Manifest.xml`在手机上生成一个合适的文件。然后将这些文件拉到PC上，在测试项目中编译（ant clean, ant debug, ant install -r /path/to/target.apk）并安装到手机上
*   我可以使用 adb shell 运行测试：

    adb -d shell am instrument -w -r -e class de.nfc.tests.NfcTestCase -e junitOutputDirectory /mnt/sdcard/ de.nfc/pl.polidea.instrumentation.PolideaInstrumentationTestRunner

*   如果测试数据有效，则仪器工作并生成一个 xml 文件，其中包含 sdcard 上的结果。

*   如果测试数据无效（参见示例） Instrumentation 崩溃并且无法继续进行以下测试：

    INSTRUMENTATION_RESULT：longMsg=java.lang.NullPointerException：无法启动活动 ComponentInfo{se.anyro.nfc_reader/se.anyro.nfc_reader.TagViewer}：java.lang.NullPointerException

**问题**

我怎样才能实现，失败的测试被记录为失败，JUnit 继续进行以下测试。

我在这里发现了一个类似的问题[Android JUnit test suite hangs after Activity throws NullPointerException in one test case](https://stackoverflow.com/questions/10738686/android-junit-test-suite-hangs-after-activity-throws-nullpointerexception-in-one)，但到目前为止没有回复:(

有没有人通过向他们传递测试数据来测试（第三方）应用程序`Intent`并且可以分享/提供一些建议/经验？

我确实希望我把问题说清楚了，因为它的设置非常复杂，我希望我为不熟悉该主题的人提到了所有相关事实（你知道森林和树木；））如果没有，请不要介意问，我会尝试解释：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T21:30:54.317

这是我们处理问题的方式：我们使用python parse来解析“dexdump test.apk”的结果来解析出所有的测试类/方法，我们一个一个地运行它们。

看一下 dexdump 结果，很明显。解析器只需要不到 200 行代码，应该在一天内完成。要求是您没有复杂的测试用例类层次结构，否则您需要从 dexdump 构建层次结构来确定需要运行哪些测试。

# objective-c - bg 线程上没有自动释放池的 ARC 行为

> ID：12093402
> 
> 赞同：2
> 
> 时间：2012-08-23T14:00:08.137
> 
> 标签：objective-c, ios, automatic-ref-counting, autorelease

似乎 ARC 在分配时调用 [[obj retain] autorelease]

```
Foo* foo = [Foo getInstance] 
```

这就是为什么我必须在那里添加一个池，如果它发生在 BG 线程上。

```
@autoreleasepool
{
  Foo* foo = [Foo getInstance]
} 
```

ARC 是否为方法中的任何对象引用执行保留自动释放组合，即未显式创建/复制（初始化/复制）？

# sql - 关于别名的位置和拥有之间的区别

> ID：12093405
> 
> 赞同：6
> 
> 时间：2012-08-23T14:00:11.603
> 
> 标签：sql, group-by, having, having-clause

如果我在子句中创建别名，`select`那么我不能在`where`子句中使用它，因为根据 sql 查询的执行顺序`where`在`select`.

但是我可以在子句中创建一个别名并在`select`子句中使用它，`having`尽管`having`在`select`.

为什么会这样？

前任：

```
select type, (case when number>25 then 1 else 0 end) inc 
from animals
where inc='1'; 
```

这行不通。但，

```
select type, (case when number>25 then 1 else 0 end) inc 
from animals
having inc='1'; 
```

这行得通。为什么这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:15:13.457

基本上是因为它们是为不同目的而定义的。该`WHERE`子句用于记录过滤，该`HAVING`子句设计用于使用**聚合函数**( `GROUP BY`) 进行过滤。`GROUP BY`在您的第二个查询中，正在使用隐式过滤，因此，例如，如果您在`SELECT`子句中添加另一列，您最终会得到不同的结果。

**编辑**基于 Martin Smith 的更正

`HAVING`创建以允许过滤由`GROUP BY`. 指定no 时`GROUP BY`，将整个结果视为一个组。

> 如果既没有指定 a`<where clause>`也没有`<group by clause>`指定 a，则令 T 为前面的结果`<from clause>`

或者

> `<group by clause>`...如果未指定，则该组是整个表

**编辑 2** 现在关于别名：

关于搜索条件中列引用的 WHERE 子句规范说明了这一点：

> `<column reference>`直接包含在 中的每个`<search condition>`都应明确引用T**的列**或作为外部引用。

*参考：7.6 `<where clause>`，​​语法规则 1。*

关于搜索条件中列引用的 HAVING 子句规范说明了这一点：

> `<column reference>`直接包含在 中的 每个`<search condition>`都应明确引用T**的分组列**或作为外部引用。

*参考：7.8 `<having clause>`，语法规则 1。*

**分组列**定义为：

> a 中引用的列`<group by clause>`是分组列。

所以总而言之，`WHERE`必须引用表的列，`HAVING`子句必须引用行组的分组列。

[（第二次非正式审查草案）ISO/IEC 9075:1992，数据库语言 SQL - 1992 年 7 月 30 日](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)

# html - 使用背景图像或 CSS3 渐变更好吗？（电话间隙）

> ID：12093406
> 
> 赞同：2
> 
> 时间：2012-08-23T14:00:11.290
> 
> 标签：html, css, cordova, sencha-touch

假设我正在使用一个 DIV 元素，我可以为其添加背景图像，也可以复制相同的样式来创建 CSS3 渐变。现在，对于 Phonegap 应用程序（所有图像文件都驻留在设备本身中），哪个选项更好。

我问这个是因为我在某处看到渐变需要一些计算时间，而使用图像可能会产生加载时间问题。但对于 Phonegap 应用程序，可能不存在图像加载时间问题。那么，也许在这里使用图像是一个更好的选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T14:02:47.257

根据 Webkit Wiki 上的一篇文章，图像表现更好：

> 有时使用 webkit 的绘图功能（如 -webkit-gradient）很诱人，但实际上并不需要 - 维护图像和处理 Photoshop 和绘图工具可能会很麻烦。但是，将 CSS 用于这些任务会将麻烦从设计者的计算机转移到目标的 CPU。CSS 中的渐变、阴影和其他装饰应仅在必要时使用（例如，当形状根据内容动态时）——否则，静态图像总是更快。在非常低端的平台上，如果可能的话，甚至建议对某些文本使用静态图像。

来源：[https ://trac.webkit.org/wiki/QtWebKitGraphics#Usestaticimages](https://trac.webkit.org/wiki/QtWebKitGraphics#Usestaticimages)

当然，您必须平衡 CPU 时间与从服务器加载图像所需的额外时间。此外，对于 Internet Explorer，过滤器非常慢，尤其是如果您在一页上有很多过滤器。

# java - PDFBox - 将 2 个纵向页面合并到一个并排横向页面上

> ID：12093408
> 
> 赞同：4
> 
> 时间：2012-08-23T14:00:16.280
> 
> 标签：java, pdf, pdfbox

我正在尝试编写一个 pdf 转换，它将采用包含 1-up 纵向页面的 pdf，并创建一个新文档，但将每 2 页合并为一个 2-up 横向页面

IE。

![](../Images/bd59b909974c7496ec3bb0dc3d7cf037.png)

下面的代码会将内容缩小 50%，但我不知道如何制作新页面横向，同时将其他页面作为纵向注入，并注入到左上角和中心的右边

```
public static void main(String[] args) throws IOException, DocumentException, COSVisitorException {
    scalePages("c:/pdf/in.pdf", "c:/pdf/out" + new Date().getTime() + ".pdf", 0.50f);
}

public static void scalePages(String inFile, String outFile, float scale ) throws IOException, COSVisitorException {      
    PDDocument doc1 = null;      
    try {          
        doc1 = PDDocument.load( inFile );  
        List allPages = doc1.getDocumentCatalog().getAllPages();          
        for( int i=0; i<allPages.size(); i++ ) {              
            PDPage page1 = (PDPage)allPages.get(i ); 
            PDRectangle mediaBox = page1.getMediaBox();

            float oldX = mediaBox.getUpperRightX();
            float newX = oldX * scale;

            float oldY = mediaBox.getUpperRightY();
            float newY = oldY * scale;

            mediaBox.setUpperRightX(newX); 
            mediaBox.setUpperRightY(newY);
            PDFStreamParser parser = new PDFStreamParser(page1.getContents());              
            parser.parse();
            List tokens = parser.getTokens();              
            tokens.add(0,new COSFloat(scale));              
            tokens.add(1,new COSInteger(0));
            tokens.add(2,new COSInteger(0));
            tokens.add(3,new COSFloat(scale));             
            tokens.add(4,new COSInteger(0));
            tokens.add(5,new COSInteger(0));
            tokens.add(6,PDFOperator.getOperator("cm"));
            PDStream newContents = new PDStream( doc1 );              
            ContentStreamWriter writer = new ContentStreamWriter( newContents.createOutputStream() );
            writer.writeTokens( tokens );              
            newContents.addCompression();
            page1.setContents(newContents);
            //page1.setRotation(90);
            mediaBox.setUpperRightX(oldX);
            mediaBox.setUpperRightY(oldY);
        }          
        doc1.save( outFile );
    } finally {          
        if( doc1 != null )   {
            doc1.close();    
        }      
    }  
} 
```

所以结果如下

![](../Images/f327e8573ef88fa617e469bbd2c88f1a.png)

任何指针将不胜感激

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-11-18T10:53:07.510

这是一个并排“缝合”两个单页 PDF 并使用 PDFBox 将结果保存在新文件中的示例。享受！

```
function void generateSideBySidePDF() {
    File pdf1File = new File(FILE1_PATH);
    File pdf2File = new File(FILE2_PATH);
    File outPdfFile = new File(OUTFILE_PATH);
    PDDocument pdf1 = null;
    PDDocument pdf2 = null;
    PDDocument outPdf = null;
    try {
        pdf1 = PDDocument.load(pdf1File);
        pdf2 = PDDocument.load(pdf2File);
        outPdf = new PDDocument();

        // Create output PDF frame
        PDRectangle pdf1Frame = pdf1.getPage(0).getCropBox();
        PDRectangle pdf2Frame = pdf2.getPage(0).getCropBox();
        PDRectangle outPdfFrame = new PDRectangle(pdf1Frame.getWidth()+pdf2Frame.getWidth(), Math.max(pdf1Frame.getHeight(), pdf2Frame.getHeight()));

        // Create output page with calculated frame and add it to the document
        COSDictionary dict = new COSDictionary();
        dict.setItem(COSName.TYPE, COSName.PAGE);
        dict.setItem(COSName.MEDIA_BOX, outPdfFrame);
        dict.setItem(COSName.CROP_BOX, outPdfFrame);
        dict.setItem(COSName.ART_BOX, outPdfFrame);
        PDPage outPdfPage = new PDPage(dict);
        outPdf.addPage(outPdfPage);

        // Source PDF pages has to be imported as form XObjects to be able to insert them at a specific point in the output page
        LayerUtility layerUtility = new LayerUtility(outPdf);
        PDFormXObject formPdf1 = layerUtility.importPageAsForm(pdf1, 0);
        PDFormXObject formPdf2 = layerUtility.importPageAsForm(pdf2, 0);

        // Add form objects to output page
        AffineTransform afLeft = new AffineTransform();
        layerUtility.appendFormAsLayer(outPdfPage, formPdf1, afLeft, "left");
        AffineTransform afRight = AffineTransform.getTranslateInstance(pdf1Frame.getWidth(), 0.0);
        layerUtility.appendFormAsLayer(outPdfPage, formPdf2, afRight, "right");

        outPdf.save(outPdfFile);
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            if (pdf1 != null) pdf1.close();
            if (pdf2 != null) pdf2.close();
            if (outPdf != null) outPdf.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-07T22:01:38.630

我最终用 itext 做这个

```
private String createTwoUp(String originalPdfFile) throws IOException, DocumentException {
    String newFilename = FilenameUtils.getBaseName(originalPdfFile) + "_2up." + FilenameUtils.getExtension(originalPdfFile);
    newFilename = FilenameUtils.concat(getPdfFileFolder(), newFilename);
    PdfReader reader = new PdfReader(originalPdfFile);
    Document doc = new Document(new RectangleReadOnly(842f, 595f), 0, 0, 0, 0);
    PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(newFilename));
    doc.open();
    int totalPages = reader.getNumberOfPages();
    for (int i = 1; i <= totalPages; i = i + 2) {
        doc.newPage();
        PdfContentByte cb = writer.getDirectContent();
        PdfImportedPage page = writer.getImportedPage(reader, i); // page #1

        float documentWidth = doc.getPageSize().getWidth() / 2;
        float documentHeight = doc.getPageSize().getHeight();
        if (i > 1) {
            documentHeight = documentHeight - 65f;
        }

        float pageWidth = page.getWidth();
        float pageHeight = page.getHeight();

        float widthScale = documentWidth / pageWidth;
        float heightScale = documentHeight / pageHeight;
        float scale = Math.min(widthScale, heightScale);

        //float offsetX = 50f;
        float offsetX = (documentWidth - (pageWidth * scale)) / 2;
        float offsetY = 0f;

        cb.addTemplate(page, scale, 0, 0, scale, offsetX, offsetY);

        if (i+1 <= totalPages) {

            PdfImportedPage page2 = writer.getImportedPage(reader, i+1); // page #2

            pageWidth = page.getWidth();
            pageHeight = page.getHeight();

            widthScale = documentWidth / pageWidth;
            heightScale = documentHeight / pageHeight;
            scale = Math.min(widthScale, heightScale);

            offsetX = ((documentWidth - (pageWidth * scale)) / 2) + documentWidth;

            cb.addTemplate(page2, scale, 0, 0, scale, offsetX, offsetY);
        }
    }

    doc.close();
    return newFilename;
} 
```

# objective-c - ImageArray 分配给单个图像

> ID：12093409
> 
> 赞同：0
> 
> 时间：2012-08-23T14:00:26.667
> 
> 标签：objective-c, ios, xcode4

我是 iphone 开发的新手。我有一个图像数组，如下所示。

```
NSArray *eyeFrames = [NSArray array];

eyeFrames = [[NSArray alloc] initWithObjects:
                 [UIImage imageNamed:@"eyes1-open.png"],
                 [UIImage imageNamed:@"eyes3-half.png"],
                 [UIImage imageNamed:@"eyes2-empty.png"],
                 nil]; 
```

我有一个 ImageView 如下

```
IBOutlet UIImageView *eyesImage; 
```

现在我想将这个图像数组分配给我的 ImageView 。

到目前为止，我尝试如下：

```
eyesImage.animationImages = eyeFrames; 
```

但它似乎没有提供预期的结果。谁能告诉我该怎么做？

谢谢，拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:21:23.750

对于像图像滑块这样的图像系列动画，代码如下：

```
NSArray *myImages = [NSArray arrayWithObjects:
                             [UIImage imageNamed:@"eyes1-open.png"],
             [UIImage imageNamed:@"eyes3-half.png"],
             [UIImage imageNamed:@"eyes2-empty.png"],                             
                             nil];

        eyesImage.animationImages = myImages;
        eyesImage.animationDuration = 0.9; // seconds
        eyesImage.animationRepeatCount = 1; // 0 = loops forever
        [eyesImage startAnimating];

        [UIView commitAnimations]; 
```

要从数组访问文件并设置为图像视图，您必须这样做

```
IBOutlet UIImageView *eyesImage = [[UIImageView alloc] initWithImage:(UIImage *) [eyeFrames objectAtIndex:1]]; 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:13:41.997

不要忘记设置“animationDuration”和“animationRepeatCount”属性，然后调用“startAnimating”

```
eyesImage.animationDuration=0.1; //seconds
eyesImage.animationRepeatCount=2; 
[eyesImage startAnimating]; 
```

# oracle - 阻止 toad 将 drop 放在视图脚本的顶部

> ID：12093413
> 
> 赞同：0
> 
> 时间：2012-08-23T14:00:38.403
> 
> 标签：oracle, toad

当我使用（示例）创建视图时

```
CREATE OR REPLACE FORCE VIEW MY_VIEW( COL_A, COL_B) AS
SELECT COL_A, COL_B FROM MY_TABLE; 
```

然后使用 toad 生成脚本，它总是将 drop 粘在上面。

```
DROP VIEW MY_VIEW;

CREATE OR REPLACE FORCE VIEW MY_VIEW( COL_A, COL_B) AS
SELECT COL_A, COL_B FROM MY_TABLE; 
```

有没有办法告诉 Toad 停止将水滴放在上面？

因为它无论如何都在做创建或替换，所以没用。如果在视图尚不存在的地方运行 toad 脚本，它会在尝试执行无用的放置时引发错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:18:11.740

当您右键单击对象并选择“创建脚本”时

然后你可以选择

单击“脚本选项”选项卡并取消选中“删除语句”复选框

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:18:55.933

在 Toad 9.7 和许多其他版本中尝试这个

*   单击视图选项卡
*   选择视图
*   在右侧选择脚本选项卡
*   在脚本选项卡的顶部有一个带有工具提示“查看/编辑脚本选项”的磁盘驱动器图标
*   单击此图标，在 Common 选项卡下有 Schema name 和 Drop Statement 选项。取消选中 Drop 语句

# varnish - 配置 Varnish 以读取标题

> ID：12093421
> 
> 赞同：1
> 
> 时间：2012-08-23T14:01:00.273
> 
> 标签：varnish

我正在使用 3scale 来管理任何 API 的前端。我想在请求的标头中包含 API 而不是 URL 字符串（看起来更整洁一些）

目前它被定义为这样。

```
 set req.http.X-3scale-app_id = regsub(req.url,".*[&?](app_id.[^&]*).*","\1");
  set req.http.X-3scale-app_key = regsub(req.url,".*[&?](app_key.[^&]*).*","\1");
  set req.http.X-3scale-user_key = regsub(req.url,".*[&?](user_key.[^&]*).*","\1");
  set req.http.X-3scale-user_id = regsub(req.url,".*[&?](user_id.[^&]*).*","\1");

  if (req.http.X-3scale-app_id != req.url) {
    set req.http.X-3scale-authrep = req.http.X-3scale-authrep + "&" + req.http.X-3scale-app_id;  
  }

  if (req.http.X-3scale-app_key != req.url ) {
    set req.http.X-3scale-authrep = req.http.X-3scale-authrep + "&" + req.http.X-3scale-app_key;  
  }

  if (req.http.X-3scale-user_id != req.url) {
    set req.http.X-3scale-authrep = req.http.X-3scale-authrep + "&" + req.http.X-3scale-user_id;  
  }

  if (req.http.X-3scale-user_key != req.url) {
    set req.http.X-3scale-authrep = req.http.X-3scale-authrep + "&" + req.http.X-3scale-user_key;  
  }

  unset req.http.X-3scale-app_id;
  unset req.http.X-3scale-app_key;
  unset req.http.X-3scale-user_id;
  unset req.http.X-3scale-user_key; 
```

我想做的是从标题中取出钥匙，因为我认为它看起来更好，所以我可以做类似的事情......

设置 req.http.X-3scale-app_key = req.http.x-appid

但是我不能让它工作！我错过了一些东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:43:03.987

您可以尝试使用来自 vmod[标头](https://github.com/varnish/libvmod-header)的 get 方法，如下所示

```
set req.X-3scale-app_id = header.get(req.http.SomeOtherHeader,".*"); 
```

在客户端，您应该以纯文本设置 SomeOtherHeader

但是为什么不直接在客户端设置这个 X-3scale-app_id 呢？

# java - 如何通过spring有条件地初始化一个类

> ID：12093424
> 
> 赞同：1
> 
> 时间：2012-08-23T14:01:05.903
> 
> 标签：java, spring, initialization

如何通过spring有条件地初始化一个类？如果某些条件为真，那么我希望传递一个参数，否则传递一些其他参数

```
<bean id="myFactory" class="Factory">

  if something then
   <constructor-arg>
      <util:map>
        <!-- configure your map here, or reference it as a separate bean -->
        <entry key="java.lang.String" value="key">....</entry>
      </util:map>
   </constructor-arg>
  else
    <constructor-arg>
      <util:map>
        <!-- configure your map here, or reference it as a separate bean -->
        <entry key="java.lang.String" value="key">....</entry>
      </util:map>
   </constructor-arg>
</bean> 
```

如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:23:30.340

Spring Expression Language 可能会为您解决问题。[关联](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/expressions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:33:41.833

您可以完全按照您指定的方式进行操作。以这种方式定义[FactoryBean](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/FactoryBean.html)，例如。生成客户 Bean：

```
public class CustomFactoryBean implements FactoryBean<Customer>{

    private int customProperty;

    public int getCustomProperty() {
        return customProperty;
    }

    public void setCustomProperty(int customProperty) {
        this.customProperty = customProperty;
    }

    @Override
    public Customer getObject() throws Exception {
        if (customProperty==1)
            return new Customer("1", "One");        
        return new Customer("999", "Generic");
    }

    @Override
    public Class<?> getObjectType() {
        return Customer.class;
    }

    @Override
    public boolean isSingleton() {
        return true;
    }
} 
```

基本上就是这样，现在根据你如何注入工厂bean的属性，实际的bean实例化可以在`getObject`上面的方法中控制

# c# - 修复 RegEx Split() 函数 - 空字符串作为第一个条目

> ID：12093427
> 
> 赞同：5
> 
> 时间：2012-08-23T14:01:24.337
> 
> 标签：c#, .net, regex, split

预先编写代码以可视化我面临的问题：

1.  这是需要拆分的文本。

> ```
> :20:0444453880181732
> :21:0444453880131350
> :22:CANCEL/ABCDEF0131835055
> :23:BUY/CALL/E/EUR
> :82A:ABCDEFZZ80A
> :87A:4444655604
> :30:061123
> :31G:070416/1000/USNY
> :31E:070418
> :26F:PRINCIPAL
> :32B:EUR1000000,00
> :36:1,31000000
> :33B:USD1310000,00
> :37K:PCT1,60000000
> :34P:061127USD16000,00
> :57A:ABCDEFZZ80A 
> ```

这是我的正则表达式

```
 Regex r = new Regex(@"\:\d{2}\w*\:", RegexOptions.Multiline);

 MatchCollection matches = r.Matches(Content);
 string[] items = r.Split(Content);

 // ----- Fix for first entry being empty string.
 int index = items[0] == string.Empty ? 1 : 0;

 foreach (Match match in matches)
 {
    MessageField field = new MessageField();

    field.FieldIdExtended = match.Value;
    field.Content = items[index];

    Fields.Add(field);

    index++;
 } 
```

正如您从评论中看到的那样，字符串拆分会出现问题。它作为第一项返回一个空字符串。有什么优雅的方法可以解决这个问题吗？

谢谢，迪米

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:15:12.920

你得到这种行为的原因是你的第一个分隔符之前没有任何东西，第一个条目是空白的。

正确解决此问题的方法可能是在正则表达式中捕获您想要的值，然后从匹配集中获取它。

粗略的第一次猜测你可能想要这样的东西：

```
Regex r = new Regex(@"^:(?<id>\d{2}\w*):(?<content>.*)$", RegexOptions.Multiline);

MatchCollection matches = r.Matches(Content);

foreach (Match match in matches)
{
    MessageField field = new MessageField();

    field.FieldIdExtended = match.Groups["id"].ToString()
    field.Content = match.Groups["content"].ToString();

    Fields.Add(field);

} 
```

使用命名捕获组可以轻松提取内容。您可能需要根据需要调整正则表达式。目前它`20`作为 id 和`0444453880181732`content 获取。我不是 100% 清楚您需要捕获什么，但您使用正则表达式看起来不错，所以我认为这不是问题。:)

从本质上讲，您并不是真的要拆分内容，而是匹配内容并将其拉出。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-23T14:04:09.207

利用：

```
string[] items = r.Split(Content, StringSplitOptions.RemoveEmptyEntries); 
```

删除空条目。

# wpf - WPF绑定棘手问题

> ID：12093432
> 
> 赞同：0
> 
> 时间：2012-08-23T14:01:43.807
> 
> 标签：wpf

我需要一些帮助来实现一些数据绑定。我的视图模型公开了以下属性：

```
public List<string> ChosenFeatures {get;set;}
public Dictionary<string, double> AllFeatureCosts {get;set;} 
```

“ChosenFeatures”将包含“AllFeatureCosts”中存在的字典键子集。

在视图中，我想渲染一系列 TextBlocks，“ChosenFeatures”中的每个项目一个。这是棘手的部分：- 每个 TextBlock 的 Text 属性需要绑定到“AllFeatureCosts”字典中的一个值，使用“ChosenFeatures”中的字符串作为该字典项的键。

我将不胜感激有关如何编写 XAML 来完成此任务的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:30:50.970

首先，我想您应该使用@Jay 的方法并同时制作`ChosenFeatures`Dictionary。

但是，您可以`Converter`在绑定时使用并像参数一样传递字典：

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
  {
  var key = (string)value;
  var dictionary = (Dictionary<string, double>)parameter;

  if (dictionary.ContainsKey(key))
    return dictionary[key];
  else
    return null;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:34:46.903

而不是绑定“ChosenFeatures”绑定“AllFeatureCosts”。我们知道它将显示完整列表，然后我们可以编写一个简单的多绑定可见性转换器来显示被选中的项目（在 ChosenFeatures 中）。

注意：根据字典的大小，它可能会影响应用程序的性能......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:21:45.153

为数据提供一个 ViewModel，这就是首先使用 MVVM 的原因。

```
class FeatureViewModel
{
    public FeatureViewModel(MyViewModel aViewModel, string aKey)
    {
        mParent = aViewModel;
        mKey = aKey
    }
    public string Value
    {
        get{return mParent.AllFeatureCosts[mKey];}
    }
} 
```

将视图模型的集合添加到主视图模型

```
public ObservableCollection<FeatureViewModel> Features{ get; set; } 
```

并在某处初始化它

```
foreach(var feature in ChosenFeatures)
{
    Features.Add(new VisualFeature(this, feature) );
} 
```

如有必要，您也可以从这里开始，并且如果您已正确实施 INotifyPropertyChanged，请在 FeatureViewModels 上提出任何更改。您当然需要使这些集合保持同步，这可能需要一些工作。

当然，您的 DataTemplate 也需要一些调整

```
<DataTemplate DataType="{x:Type FeatureViewModel}">
    <TextBlock Text="{Binding Value}"/>
</DataTemplate> 
```

# java - “新”的范围，没有“免费”的对应部分

> ID：12093435
> 
> 赞同：1
> 
> 时间：2012-08-23T14:01:50.093
> 
> 标签：java, garbage-collection

我注意到 Java 中没有`free`关键字，这让我问为什么。当我创建一个新对象或数组时，该变量的范围是什么？

我熟悉 C++ 和 C。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:04:08.157

对象的寿命与 Java 中局部变量的范围无关。例如

```
File f = new File("a");
f = new File("b"); 
// variable f is still in scope but the first object can be cleaned up. 
```

或者

```
private final List<File> files = ...

{
    File f = new File("a");
    files.add(f);
} // f is out of scope but the object lives on in "files". 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:04:01.177

1.  变量在 Java 中不保存对象，它们保存原始值或对象*引用*（重要区别：仅仅因为您的变量超出范围，并不意味着该对象可以被垃圾收集，它可能仍然可以通过其他方式访问参考 ）
2.  *变量*的作用域与 C/C++ 非常相似
    *   块或方法（用于局部变量）
    *   对象（用于非静态字段）或
    *   类（用于静态字段）
3.  *当对象不再可访问时（不是立即，而是最终），*对象会被垃圾收集。**

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:02:57.097

范围取决于您创建新变量（或）对象的位置。

如果您创建为实例变量/对象，则它的范围是该实例。

如果您创建为类变量/对象（静态），它的范围是类加载器。

如果您创建为局部变量/对象（静态），则它的范围是该方法。

如果一个对象不可访问，那么它就有资格进行 GC（无论范围如何）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T14:04:16.160

变量具有标准范围：方法或块（除非它是实例变量）。变量（我的意思是原语或引用）保存在**堆栈**上，而对象和数组（甚至是原语数组）总是保存在**堆上**。

对象（数组也是一个对象）当然可以从变量范围传递出去并留在那里。对象只要可以到达就存在（有一种方法可以通过参考图来获取它）。它与范围无关。

另一方面，变量**总是**存在于范围内。没有办法将它传递到任何地方并进行修改。引用总是传递给方法并作为副本返回。*

# sql-server-2008 - 计划执行文件夹中的所有 TSQL 脚本

> ID：12093438
> 
> 赞同：0
> 
> 时间：2012-08-23T14:01:55.117
> 
> 标签：sql-server-2008, tsql, jobs, sql-server-agent

我有一堆需要每天执行的 TSQL 脚本。我知道我可以使用 Job Agent 来执行它们，但这需要我更改实际的工作。

我想做的是创建一个简单地说：

```
execute all TSQL-scripts in <some folder> 
```

如果可以根据脚本的文件名使用过滤器，那么一个好处是：这样一个作业将执行名称以“d”开头的所有文件，另一个作业将执行所有名称中带有“w”的文件.

这可以做到吗？如何才能做到这一点？

我阅读了一些关于使用 Windows 调度程序运行 SQLCMD 实用程序的内容。我宁愿让 SQL Server 进行调度和执行。Powershell是要走的路吗？如果是这样，从哪里开始以及如何开始？（从来没有使用过它，所以从来没有给予太多关注：/）

谢谢你和我一起思考！

亨罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:22:46.807

要从文件执行脚本，您可以使用：

```
DECLARE @dir varchar(100) = 'C:\MyDir\'
DECLARE @file varchar(100) = 'myScript.sql'
DECLARE @cmd varchar(100) = 'sqlcmd -S ' + @@SERVERNAME + ' -i ' + @dir + @file

EXECUTE dbo.xp_cmdshell @command_string = @cmd 
```

要从目录中获取文件列表，您可以使用

```
CREATE TABLE #tbl (Name varchar(400))
DECLARE @cmd varchar(100) = 'dir ' + @dir + ' *.sql'
INSERT #tbl EXECUTE dbo.xp_cmdshell @command_string = @cmd

DELETE FROM #tbl WHERE  ISDATE(SUBSTRING(Name,1,10)) = 0
UPDATE #tbl SET Name = SUBSTRING(Name, 40, 100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:21:26.893

我想你可以做一件事：

1.  将所有以名称 'd' 开头的脚本放在一个 sproc 中。在这里，您必须将 Go 放在 sproc 中的每个脚本之后。

2.  同样创建一个所有脚本以字母'w'开头的sproc

3.  然后在 sql server 代理中安排这些作业。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T08:01:03.937

若昂，感谢您的帮助。使用您的代码我生成了这个：set dateformat dmy

```
DECLARE @scripts varchar(100) = 'C:\MYSCRIPTS\'     -- folder with scripts
DECLARE @project varchar(100) = 'PROJECTX'  -- specific folder
DECLARE @Identifier varchar(1) = 'D' -- All files of which the name starts with a 'T'
DECLARE @files  varchar(100) = @scripts + @project + '\' + @Identifier + '*.sql'

CREATE TABLE #tbl1 (Name varchar(400))
DECLARE @cmd varchar(100) = 'dir ' + @files 
INSERT #tbl1 EXECUTE master.dbo.xp_cmdshell @command_string = @cmd
DELETE FROM #tbl1 WHERE  ISDATE(SUBSTRING(Name,1,10))  = 0
UPDATE #tbl1 SET Name = SUBSTRING(Name,37, 100)

CREATE TABLE #tbl2 (Counter smallint Primary Key IDENTITY(1,1), Name varchar(400))
INSERT INTO   #tbl2 (Name)
Select  @scripts + @project + '\' + Name from #tbl1

DECLARE @i int
DECLARE @NumRows int
DECLARE @File2BExecuted varchar(100)

SET @i = 1
SET @NumRows = (SELECT COUNT(*) FROM #tbl2)
IF @NumRows > 0
    WHILE  (@i <= (SELECT MAX(Counter) FROM #tbl2))
    BEGIN
    SELECT @File2BExecuted = Name FROM #tbl2 WHERE Counter = @i
    DECLARE @script varchar(100) = 'sqlcmd -S ' + @@SERVERNAME + ' -i ' + @File2BExecuted
    EXECUTE master.dbo.xp_cmdshell @command_string = @script

    SET @i = @i + 1
    END

drop table #tbl1
drop table #tbl2 
```

# java - 如何让 Java 使用正确的字符集？

> ID：12093445
> 
> 赞同：1
> 
> 时间：2012-08-23T14:02:19.917
> 
> 标签：java, character-encoding, centos, cp1252

我们的服务器在 CentOS 上运行，我们的 Java 后端有时必须处理最初在 Windows 机器上（由我​​们的一个客户端）使用 CP-1252 生成的文件，但是在 95% 以上的用例中，我们正在处理UTF-8 文件。

我的问题：如果我们知道某些文件将*始终*是 UTF-8，而其他文件将*始终*是 CP-1252，是否可以在 Java 中指定用于读取每个文件的字符集？如果是这样的话：

*   我们需要在系统级别做任何事情来将 CP-1252 添加到 CentOS 吗？如果是这样，这涉及什么？
*   我们将使用哪些 Java 对象来对每个文件应用正确的编码？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:05:05.470

您需要做的就是指定在使用`XXXReader(InputStream in, Charset cs)`. 例如看看[InputStreamReader](http://docs.oracle.com/javase/6/docs/api/java/io/InputStreamReader.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:05:46.083

> 我的问题：如果我们知道某些文件将始终是 UTF-8，而其他文件将始终是 CP-1252，是否可以在 Java 中指定用于读取每个文件的字符集？

假设您负责读取文件的代码，那应该没问题。创建一个`FileInputStream`，然后将其包装在一个`InputStreamReader`指定相关的字符编码中。

> 我们需要在系统级别做任何事情来将 CP-1252 添加到 CentOS 吗？如果是这样，这涉及什么？

这取决于 JRE 支持什么。我从来没有使用过 CentOS，所以我不知道它是否可能带有相关编码作为 JRE 的一部分。您可以使用[`Charset.isSupported`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html#isSupported%28java.lang.String%29)来检查，并[`Charset.availableCharsets`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html#availableCharsets%28%29)列出可用的内容。

# c++ - 在网络游戏中正确发送/接收数据的方法（UDP，但为什么不是 TCP）

> ID：12093446
> 
> 赞同：0
> 
> 时间：2012-08-23T14:02:20.630
> 
> 标签：c++, sockets, pthreads

我有一个带有 GUI 的 C++ 应用程序，它像网络游戏一样运行（在 PC 1 上），并以相当固定的时间间隔（如 40 毫秒）通过 WiFi（ad-hoc，因此非常可靠）从另一台计算机（2）接收数据包, 程序 (2) 上的每个循环一次。我使用发送/读取。

这是问题所在：
- 数据包并不总是完全发送（但显然你可以简单地保留`send()`剩余的数据，直到所有数据都发送完毕，这很好）
-**更重要**的是，数据包在（1）的循环期间堆叠在套接字中直到`read()`发生，然后就无法区分大数据流中的数据包，或者知道您是否已经在数据包的中间。

我试图用 ID 头来解决这个问题（你发现一个 ID 作为第一个字节并且你知道数据包的长度），但我经常迷路（未知 ID：我们不在数据包的开头）并且被迫忽略所有剩余的数据。

所以我的问题是：
为什么数据包会堆叠？（通常我有 400B 的数据，而我的数据包长度 <100B 并且 fps (1) 和 (2) 差别不大）
我怎样才能有更可靠的方式来接收实际数据包，比如 80% 的数据包（丢弃数据包丢失，不是UDP/TCP的问题）？

用于接收数据包的**单独线程会起作用吗？**（在 (1) 上，服务器）

**实时网络游戏**如何做到这一点（包括多客户端管理）？

提前致谢。

（对不起，我这里没有代码，但我尽量说清楚）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:08:34.700

好：

1) UDP 传输 MESSAGES，但不可靠。

2) TCP 传输 BYTE STREAMS，并且是可靠的。

UDP 不能可靠地传输消息。任何更可靠的东西都需要基于 UDP 的协议。

TCP 不能传输消息，除非它们是一个字节长。任何更复杂的东西都需要基于 TCP 的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T16:04:53.790

*   数据包为什么要堆叠？（通常我有 400B 的数据，而我的数据包长度小于 100B，fps (1) 和 (2) 差别不大）

因为通过网络发送数据包的时间会有所不同，所以以高速率发送数据包通常没有意义，因此大多数网络库（例如 RakNet）会将数据包排队并每 10 毫秒发送一次。

在 TCP 的情况下，有 Nagle 算法，它是做同样事情的一种更有原则的方法。您可以通过设置 NO_DELAY TCP 标志来关闭 Nagle。

*   我怎样才能有一种更可靠的方式来接收实际的数据包，比如 80% 的数据包（丢弃数据包丢失，这不是 UDP/TCP 的问题）？

如果您使用 TCP，您将按正确的顺序接收所有数据包。使用 TCP 的惩罚是如果一个数据包被丢弃，它之后的数据包会等到该数据包可以在处理之前重新发送。这会导致明显的延迟，因此任何使用 TCP 的游戏都具有复杂的预测技术来隐藏这种延迟和其他技术，以便在丢失的数据包到达时顺利“赶上”。

如果您使用 UDP，您可以在顶部实现一个层，该层为您提供可靠性，但如果数据包的顺序无关紧要，则通过发送每个数据包的计数器并让接收器重复通知发送者计数中的间隙. 你也可以通过做类似的事情来实现排序。当然，如果您同时执行这两种方法，那么您就是在创建自己的 TCP 层。有关详细信息，请参阅[http://www.jenkinssoftware.com/raknet/manual/reliabilitytypes.html 。](http://www.jenkinssoftware.com/raknet/manual/reliabilitytypes.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T20:18:58.840

您所描述的是，如果您使用没有协议的 TCP 来构建传输的数据会发生什么。您使用 ID 标头和数据包长度的想法就是这样一种协议。如果您发送一个 4 字节的 ID，后跟一个 4 字节的长度，然后是 X 个字节，那么接收方知道它必须读取 4 个字节，然后是 4 个字节，然后是 X 个字节才能接收完整的数据包。没有比这更简单的了。您仍然无法使用如此简单的协议读取数据包这一事实表明您的底层套接字读取代码一开始就有缺陷。如果没有看到你的实际代码，很难告诉你你做错了什么。

# objective-c - 将硬币添加到我现有的硬币中

> ID：12093449
> 
> 赞同：-5
> 
> 时间：2012-08-23T14:02:28.383
> 
> 标签：objective-c, ios, cocoa-touch, nsuserdefaults

我以前在添加分数时遇到过这样的问题，但从未解决过，所以我想我现在问它，同时解决了这两个问题。我开了一家商店，人们可以在那里购买硬币，这些硬币将添加到他们已经拥有的硬币中。他们已经拥有的硬币可以通过以下方式加载：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; 
NSString *loadcoins = [defaults objectForKey:@"savedcoins"];
[coinsdisplay setText:loadstring]; 
```

我有一个按钮，你可以在那里购买 100 个硬币

```
-(IBAction)savecoins100:(id)sender { 
    NSString *savecoins = @"100"; 
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; 
    [defaults setObject:savecoins forKey:@"savedcoins"]; 
    [defaults synchronize];
} 
```

我想要的是新字符串不是 @"100" 而是 100 + 以前的硬币现在这将是 loadcoins 但我不知道如何正确编码，有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:11:51.233

那么对于初学者来说，你不应该使用字符串......为什么你不使用整数，因为你在计数？

```
- (void)addCoins:(int)coinsToAdd
{
    int currentCoins = [[NSUserDefaults standardUserDefaults] integerForKey:@"savedcoins"];

    int newCoins = currentCoins + coinsToAdd;

    [[NSUserDefaults standardUserDefaults] setInteger:newCoins forKey:@"savedCoins"];
    [[NSUserDefaults standardUserDefaults] synchronize];
}

- (int)getCoins
{
    return [[NSUserDefaults standardUserDefaults] integerForKey:@"savedcoins"];
} 
```

然后，无论您需要在哪里显示它，您都可以即时创建一个字符串。

```
[coinsDisplay setText:[NSString stringWithFormat:@"Coins: %i",[self getCoins]]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:13:17.147

试试这个：

```
NSString *savecoins = @"100";
NSInteger coins = [savecoins integerValue];
coins += 78;
savecoins = [NSString stringWithFormat:@"%d", coins]; 
```

然后您可以使用`@"178"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:15:10.083

您正在保存`savecoins`到`NSUserDefaults`. 是 100，所以`savecoins`它变成 100 是有道理的。你也说那`loadcoins`是“旧”硬币。所以你在这里有两个数字，`savecoins`和`loadcoins`。您需要做的就是将它们加在一起。请参阅 Ryan 的示例代码。

# templates - 如何在不复制模板的情况下为控件创建样式？

> ID：12093459
> 
> 赞同：0
> 
> 时间：2012-08-23T14:03:05.410
> 
> 标签：templates, styles, expression-blend

对于某些控件，我在 Expression Blend 中的唯一选项是创建模板。我并不总是想创建模板；有时我只是想创造一种风格。我知道我可以将模板从样式中取出并保留样式。但是，如果我想更改样式，我必须直接在资源字典中找到它；我不能再使用“编辑当前”。我必须创建模板的副本才能将样式与控件相关联，这似乎很笨重（而且很浪费）。毕竟，在表达式混合中创建模板会创建样式。看来我应该能够创造一种风格。有没有办法做到这一点？我不能有理由吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:41:27.923

您不能为哪些控件创建样式？您是否尝试过“对象”>“编辑样式”菜单？它具有编辑当前、编辑副本、创建空白和应用资源选项。（确保您选择了正确的对象类型）。

如果这没有帮助，请发布更多细节，我会尽力提供帮助。

# objective-c - 处理视图上的多个手势

> ID：12093460
> 
> 赞同：0
> 
> 时间：2012-08-23T14:03:06.687
> 
> 标签：objective-c, ios5, uiwebview, uibutton, uigesturerecognizer

有什么方法可以检测 UIWebView 上的单击与滚动手势？

我有一个 UIWebView，它包含多次滚动的富文本，如果有很多文本内容。我需要添加一个新功能，允许用户点击 UIWebView 来获取不同的内容。

问题是，我的解决方案是在 UIWebView 顶部放置一个清晰的自定义按钮，它可以处理点击但会终止滚动功能。酷孩子是怎么做这种事情的？

谢谢

![在此处输入图像描述](../Images/972d924f27ffea381bec67508add95b7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:25:23.893

我用手势识别器解决了这个问题。这完全消除了对 UIButton 覆盖的需要。

```
 //Handle taps on the UIWebView
    self.singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(**tapDetected:**)];
    singleTap.numberOfTapsRequired = 1;
    singleTap.delegate = self;
    [self.readAboutItView addGestureRecognizer:singleTap];

   //Set up the event handler
- (IBAction)**tapDetected:**(UIGestureRecognizer *)sender {

   //Do something with the content
   [self webViewTouched:self];

}

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch{

    return YES;

}

-(BOOL) gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer{

    return YES;

} 
```

# jsf-2 - 未调用 action 方法 标签

> ID：12093461
> 
> 赞同：1
> 
> 时间：2012-08-23T14:03:12.780
> 
> 标签：jsf-2, richfaces

```
<a4j:commandLink onclick="return call();" action="#{bean.deleteUser(all_user.userID)}" reRender="viewUserGrid">
<h:graphicImage style="border-style:none;" url="/images/delete.jpg"  height="10px" />
</a4j:commandLink> 
```

问题是在支持bean中没有调用deleteUser方法为什么会这样。但是它正在调用javascript函数请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:48:33.917

问题是您在“onclick”方法中返回了一个值。假设你的`call`js方法返回true或者false，代码必须改成：

```
<a4j:commandLink onclick="if (!call()) return false;"
    action="#{bean.deleteUser(all_user.userID)}"
    reRender="viewUserGrid" limitToList="true">
    <h:graphicImage style="border-style:none;" url="/images/delete.jpg"  height="10px" />
</a4j:commandLink> 
```

进一步说明：

为您的实际代码生成的 HTML 代码将如下所示（或类似的内容）：

```
<a href="#" id="formName:j_id45351"
    name="formName:j_id22"
    onclick="return call(); A4J.AJAX.Submit('formName',event, '');">
<!-- the rest of the HTML generated code... --> 
```

如果您看到，该`return call();`方法位于 的开头`onclick`，因此不会调用 ajax 提交。通过我提供的更新代码，代码将类似于：

```
<a href="#" id="formName:j_id45351"
    name="formName:j_id22"
    onclick="if (!call()) return false; A4J.AJAX.Submit('formName',event, '');">
<!-- the rest of the HTML generated code... --> 
```

通过此更改，如果您的`call`js 方法返回 false，则不会提交 ajax 调用，如果返回 true，则将进行您的 ajax 调用。请注意，如果 javascript 方法不返回任何值，则默认情况下将返回 false。

* * *

更新：建议的代码将适用于 RichFaces 3.x。如果您使用 RichFaces 4.x 您的 commandLink 应如下所示

```
<a4j:commandLink onclick="if (!call()) return false;"
    action="#{bean.deleteUser(all_user.userID)}"
    render="viewUserGrid">
    <h:graphicImage style="border-style:none;" url="/images/delete.jpg"
        height="10px" />
</a4j:commandLink> 
```

# php - 从mysql中删除值等于某事的重复行

> ID：12093462
> 
> 赞同：1
> 
> 时间：2012-08-23T14:03:12.883
> 
> 标签：php, mysql

我一直到互联网的尽头，我被卡住了。虽然我可以找到部分答案，但我无法对其进行修改以使其正常工作。

我有一个名为的表**`myfetcher`**：

```
+-------------+--------------+------+-----+---------+----------------+
| Field       | Type         | Null | Key | Default | Extra          |
+-------------+--------------+------+-----+---------+----------------+
| fid_id      | int(11)      | NO   | PRI | NULL    | auto_increment |
| linksetid   | varchar(200) | NO   |     | NULL    |                |
| url         | varchar(200) | NO   |     | NULL    |                |
+-------------+--------------+------+-----+---------+----------------+ 
```

该`url`字段有时会包含重复项，但不是删除表中的所有重复项，我只需要字段`linksetid`等于`X`.

下面的 SQL 删除了表中的所有重复项（这不是我想要的）......但我想要的只是字段中设定范围内的重复项`linksetid`。我知道我做错了什么，只是不确定是什么。

```
DELETE FROM myfetcher USING myfetcher, myfetcher as vtable 
WHERE (myfetcher.fid>vtable.fid)
  AND (myfetcher.url=vtable.url)
  AND (myfetcher.linksetid='$linkuniq') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:29:45.057

仅删除 linksetid=X 的记录。当所有记录都带有 linksetid=X 时，第一个 EXISTS 检查用例，然后只剩下一个带有 min(fid) 的记录。第二个 EXISTS 检查用例，当有一条带有 linksetid<>X 的记录时，所有带有 linksetid=X 的记录都将被删除：

**注意：**此查询适用于 Oracle 或 MSSQL。对于 MYSql 使用下一个解决方法：

```
DELETE FROM myfetcher 
where (myfetcher.linksetid='$linkuniq')
      and 
      (
      exists
      (select t.fid from myfetcher t where 
                 t.fid<myfetcher.fid 
                 and 
                 t.url=myfetcher.url
                 and 
                 t.linksetid='$linkuniq')

      or 

      exists
      (select t.fid from myfetcher t where 
                 t.url=myfetcher.url
                 and 
                 t.linksetid<>'$linkuniq')
       ) 
```

在 MYSql 中，您[不能将更新/删除命令与目标表的子查询一起使用](https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause)。因此，对于 MySql，您可以使用以下脚本。[SqlFiddle 演示](http://sqlfiddle.com/#!2/1a246/1)：

```
create table to_delete_tmp as 
select fid from myfetcher as tmain 
     where (tmain.linksetid='$linkuniq')
      and 
      (
      exists
      (select t.fid from myfetcher t where 
                 t.fid<tmain.fid
                 and 
                 t.url=tmain.url
                 and 
                 t.linksetid='$linkuniq')

      or 

      exists
      (select t.fid from myfetcher t where 
                 t.url=tmain.url
                 and 
                 t.linksetid<>'$linkuniq')
       ) ;

delete from myfetcher where myfetcher.fid in (select fid from to_delete_tmp);

drop table to_delete_tmp; 
```

# qt - 使用滑块连接组合框

> ID：12093463
> 
> 赞同：0
> 
> 时间：2012-08-23T14:03:17.610
> 
> 标签：qt, slider, qwt, qcombobox

我正在尝试将 qcombobox 与 qwtslider 连接，并且我在组合框上有两个选项，毫米和像素。当我选择该选项时，我想将比例更改为像素或毫米。我创建了一些函数作为插槽工作，它们是：

```
void planevolume::mm()
{
      ui->Slider->setRange(xmin, xmax/(256/3), 1.0/(256/3));
      ui->Slider->setScale(xmin, (xmax+1)/(256/3), ((xmax+1)/16)/(256/3));
      connect(ui->Slider, SIGNAL(valueChanged(double)), ui->lcdNumber, SLOT(display(double)));
}

void planevolume::pixel()
{
      ui->Slider->setRange(xmin, xmax, 1.0);
      ui->Slider->setScale(xmin, xmax+1, (xmax+1)/16);
      connect(ui->Slider, SIGNAL(valueChanged(double)), ui->lcdNumber, SLOT(display(double)));
} 
```

我想我可以使用来自连接盒的信号连接它们。我的连接框是这样的：

```
 ui->comboBox->insertItem( 1, QString("pixel"));
  ui->comboBox->insertItem( 2, QString("mm")); 
```

他们创建了一个可供选择的插槽：

```
void planevolume::currentIndexPixel()
{
    ui->comboBox->currentIndex(1);
}

void planevolume::currentIndexMM()
{
    ui->comboBox->currentIndex(2);
} 
```

他们像这样连接它：

```
connect(this, SIGNAL(currentIndexPixel()),ui->Slider, SLOT(pixel()));
connect(this, SIGNAL(currentIndexMM()),ui->Slider, SLOT(mm())); 
```

但我收到这样的错误，我不确定我做错了什么：

```
error: no matching function for call to ‘QComboBox::currentIndex(int)’
/usr/include/qt4/QtGui/qcombobox.h:184: note: candidates are: int QComboBox::currentIndex() const 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:05:54.997

我认为您的意思是使用`setCurrentIndex()`而不是`currentIndex()`在您的`currentIndexPixel`和`currentIndexMM`功能中

# python-3.x - 如何使用 Python3 检测字节顺序和文件系统

> ID：12093470
> 
> 赞同：0
> 
> 时间：2012-08-23T14:03:37.500
> 
> 标签：python-3.x

我正在对一个项目进行理论化，其中我的 python 脚本查看运行脚本的机器上的文件系统，但也报告它安装的设备、拇指驱动器、移动设备等的文件系统。

有谁知道 python3 中的 BIF 会查看字节序和文件系统。

最后，我想创建一个循环来查看已安装的存储设备，但我不确定如何/whre 在 OSX 或 Linux 上访问它（Linux 上的 fstab？）并查看当前已安装的内容以及是否更改。如果 Fstab 是正确的文件，我会不断地对其进行排序，还是应该定期打开它并将其与文件对象进行比较？我对编程还是很陌生，所以请原谅任何新手的疏忽。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:06:45.557

对于平台的字节顺序：

```
>>> import sys
>>> print(sys.byteorder)
little 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:01:03.897

`[platform][1]`您可以从模块中获得有关平台的大量信息。Endianess 来自`sys.byteorder`虽然。

但是，对于设备列表，事情变得更加依赖于平台。有[各种模块](http://pypi.python.org/pypi?%3aaction=search&term=usb&submit=search)可以为您提供 USB 访问权限，这些模块可以为您提供 USB 设备列表，但没有列出例如硬盘。否则我不知道任何与平台无关的东西。

# php - 无法通过 php 上传文件

> ID：12093472
> 
> 赞同：0
> 
> 时间：2012-08-23T14:03:43.860
> 
> 标签：php, file-upload

我正在将具有以下 html 代码的文件提交到 php 文件。我想做的是在php中获取该文件，然后将该文件设置为cURL的参数值作为postfields，然后执行url，我该怎么做？

这是html：

```
 <form name="frm" id="frm" method="post" action="fileSubmit.php" enctype="multipart/form-data">
      <input type="file" name="file" id="file"/>
      <input type="submit" name="submit" value="submit" />
   </form> 
```

这是php

```
<?php 
if(isset($_REQUEST['submit'])) { 
  $curl = curl_init("myDomain/submitFile";); 
  $file = "file=".file_get_contents($_FILES["file"]["name"]);
  curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
  curl_setopt($curl, CURLOPT_HEADER, 0); 
  curl_setopt($curl, CURLOPT_TIMEOUT, 60); 
  curl_setopt($curl, CURLOPT_POST, 0);
  curl_setopt($curl, CURLOPT_POSTFIELDS, $file); 
  $resp = curl_exec($curl); 
  curl_close($curl); 
} 
?> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:20:33.337

尝试

```
$_FILES["file"]["tmp_name"] 
```

相反，在您移动上传的文件之前，它会存储在临时位置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-30T02:06:24.850

这里有几件事需要修复......将您的代码更改为：

```
$postParams = array(
    "@file" => $_FILES["file"]["tmp_name"],
    "name"  => $_FILES["file"]["name"]
);
$curl = curl_init("http://remote-site.com/upload-script.php"); 
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($curl, CURLOPT_HEADER, 0); 
// curl_setopt($curl, CURLOPT_TIMEOUT, 60); // yes, this must be commented out. It will stop the upload otherwise.
curl_setopt($curl, CURLOPT_POST, 1); // post must be enabled.
curl_setopt($curl, CURLOPT_POSTFIELDS, $postParams); 
$resp = curl_exec($curl); 
curl_close($curl); 
```

在这里测试并完美运行。

# windows - 如何在 Windows 中运行 llvm 通行证？

> ID：12093484
> 
> 赞同：2
> 
> 时间：2012-08-23T14:04:13.493
> 
> 标签：windows, llvm

有人可以告诉我在 Windows 中运行 LLVMHello 传递的步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:17:07.323

windows上没有动态链接，所以需要链接才能传入opt。否则，您可能会尝试将整个 LLVM 编译到共享库中，但这在 Windows 上可能非常重要。

# javascript - 未经许可请求检查用户喜欢 facebook 页面

> ID：12093492
> 
> 赞同：1
> 
> 时间：2012-08-23T14:04:24.920
> 
> 标签：javascript, facebook

有什么方法可以检查用户在未经许可请求的情况下是否喜欢 Facebook 页面？该功能类似于addmefast.com，当用户点击Like按钮时，我需要检查用户是否有喜欢的页面。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:29:07.267

> 有什么方法可以检查用户在未经许可请求的情况下是否喜欢 Facebook 页面？

仅当您的应用程序在该 Facebook 页面上作为页面选项卡应用程序运行时。

如果是这样，则信息包含在`signed_request`参数中。

# qt-jambi - 将简单的 QWebView 示例转换为 Java

> ID：12093494
> 
> 赞同：3
> 
> 时间：2012-08-23T14:04:38.813
> 
> 标签：qt-jambi

您如何使用 QWebView 小部件将以下简单的 C 语言 QT 示例转换为 Java (QtJambi)：

```
int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QWebView view;
    view.load(QUrl("http://www.trolltech.com/"));
    view.show();
    return app.exec();
} 
```

（位于：[http](http://doc.qt.nokia.com/qq/qq26-webplugin.html#qtwebkitbasics) ://doc.qt.nokia.com/qq/qq26-webplugin.html#qtwebkitbasics ）

我可能弄错了，但我想我记得去年 Qt-Jambi javadoc 中有一个这样的例子，但是当我去[http://qt-jambi.org/documentation](http://qt-jambi.org/documentation)时我再也找不到它了“最新建造的（原文如此）的 Apdoc 仍然无法正常工作”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T06:37:00.910

Qt Jambi 中的 API与原始 Qt API*非常*相似，因此几乎可以直接翻译示例。

所以C++版本

```
QWebView view;
view.load(QUrl("http://www.trolltech.com/")); 
```

在Java中被翻译成以下

```
QWebView view = new QWebView();
view.load(new QUrl("http://www.trolltech.com/")); 
```

应用程序的其余部分（创建主窗口、运行应用程序）可以在[hello world 教程](http://doc.qt.nokia.com/qtjambi-4.5.2_01/com/trolltech/qt/qtjambi-tutorial1.html)中找到。

我的家庭 Mac 上没有工作环境，但是这个示例应该可以工作：

```
import com.trolltech.qt.core.*;
import com.trolltech.qt.gui.*;
import com.trolltech.qt.webkit.*;

public class SO12093494 extends QMainWindow {

   private QWebView webView;

   public SO12093494() { this(null); }
   public SO12093494(QWidget parent) {
      super(parent);

      webView = new QWebView();
      setCentralWidget(webView);
   }

   public void loadUrl(String url) {
      webView.load(new QUrl(url));
   }

   public static void main(String[] args) {
      QApplication.initialize(args);

      SO12093494 app = new SO12093494();
      app.loadUrl("http://www.trolltech.com");
      app.show();

      QApplication.exec();
   }
} 
```

# spring - 用于 cron 表达式的 Spring @Scheduled 注解中的 El 表达式或逻辑

> ID：12093502
> 
> 赞同：1
> 
> 时间：2012-08-23T14:05:06.213
> 
> 标签：spring, cron, scheduled-tasks

我正在使用 Spring 3.1.1.RELEASE 版本，并且有一些用@Scheduled 注释的计划任务，例如@Scheduled(cron = "0 0 15 * * 2")*每周二 15:00*

我需要对 cron 表达式进行更细粒度的控制以使其运行，例如：

*   每月第二周和最后一周的星期一
*   每个月的第一个星期一

我怎样才能做到这一点？

也许有一些 EL 表达式计算为同一 bean 中的方法，该方法返回所需的 cron 表达式作为字符串？

或者也许已经有某种方法可以在 cron 表达式中引入这种逻辑？

我试图在没有运气的情况下为这两种解决方案找到一些信息，所以我很感激一个好的指针。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-23T15:01:04.293

> 也许有一些 EL 表达式计算为同一 bean 中的方法，该方法返回所需的 cron 表达式作为字符串？

如果您的主要问题是您想避免对 cron 进行硬编码，那么您可以从属性文件中获取它，如下所示：

```
@Scheduled(cron = "${my-schedule}") 
```

其中*my-schedule*是属性文件中键的名称：

```
my-schedule=0 0 15 * * 2 
```

# c# - 在 Visual Studio 2010、.Net Framework 4、32 位上调试时出现 ConfigurationErrorException

> ID：12093504
> 
> 赞同：1
> 
> 时间：2012-08-23T14:05:10.800
> 
> 标签：c#, .net-4.0, 32-bit, visual-studio-debugging

我在 VS 2010 上调试应用程序时遇到了一个问题。

这是一个简单的命令行应用程序：

```
namespace HttpTest
{
    class Program
    {
        public void testHTTP ()
        {
            Console.WriteLine("Creating HTTP request. Press a key to proceed.");
            Console.ReadKey();
            var request = (HttpWebRequest)HttpWebRequest.Create("http://stackoverflow.com");
            Console.WriteLine("Getting response...");
            var response = (HttpWebResponse)request.GetResponse();
            Console.WriteLine("Done");
            Console.ReadKey();
        }

        static void Main(string[] args)
        {
            Program app = new Program();
            app.testHTTP();
        }
   }
} 
```

如果我从 Visual Studio 2010 启动/调试它，我会在创建 HttpWebRequest 时收到**ConfigurationErrorsException ：**

> 创建“system.net/defaultProxy”配置部分中指定的 Web 代理时出错。

这非常令人惊讶，因为我的 app.config 在 system.net/defaultProxy 中没有条目（我的 devenv.exe.config 也没有）。

通过尝试不同的设置，我发现*只有将目标框架设置为 4.0 并将目标平台设置为 x86 并尝试在 VS 中调试时才会发生错误*

*   如果我构建它并从命令行运行它（无论构建设置如何），我都没有问题。
*   如果我将目标框架设置为 3.5，则错误消失并且应用程序正常调试。
*   如果我将平台目标设置为“x64”或“任何 CPU”，则应用程序会正常调试。
*   如果我在 4.0/x86 上构建，从命令行运行，在等待第一次按键时附加调试器，然后继续，我得到上面提到的错误。
*   我在我的机器上禁用了防火墙
*   以管理员身份运行 VS 对测试没有任何影响。
*   如果我在属于同事的另一台机器、相同的硬件规格和操作系统上尝试这个，我可以在 VS2010 中调试它。

这显然与我机器上的设置有关。但是，我无法确定条件是什么。

其他用户建议将应用程序移至 C: 驱动器。我认为这不适用于我的情况，因为我可以从 D: 驱动器成功运行 int 。只有在 VS 中调试时才会出现问题。

# mysql - Concat 两列和列是通过 SELECT 查询获得的

> ID：12093505
> 
> 赞同：0
> 
> 时间：2012-08-23T14:05:18.687
> 
> 标签：mysql, concat

我需要有关 CONCAT 功能的帮助。我有两个选择查询，每个查询的结果都是一列。我需要将这两列合并为一。那可能吗？因为，即使我尝试使用简单的选择查询，例如：

```
SELECT owner FROM table WHERE number="value1";
SELECT number FROM table WHERE owner="value2" AND number IS NOT null; 
```

这些查询工作并抛出 3 行，如结果。但是，如果我想使用 CONCAT 将它们合并到一列中 - 那是行不通的。你知道为什么吗？

```
SELECT CONCAT(SELECT owner FROM table WHERE number="value1",
SELECT number FROM table WHERE owner="value2" AND number IS NOT null
) as NEW_COLUMN FROM table; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:09:09.740

我想你想要这个：

```
SELECT CONCAT(owner, number) newCol1
FROM yourTable
WHERE number="value1"
    OR (owner="value2" AND number IS NOT null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:08:42.447

```
SELECT
   CONCAT(owner, number) as NEW_COLUMN
FROM
   table
WHERE
   owner = "value2"
   AND number = "value1"
   AND number IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:13:00.830

根本原因是数据库无法连接两个可能具有不同行数的不同 SELECT。

您需要做的是根据 JOIN 重新制定查询。

例如假设我们有这个表：

```
owner    number
John     value1
value2   123456 
```

您的第一个查询：

```
SELECT owner FROM table WHERE number="value1"; 
```

将返回“约翰”。第二个

```
SELECT number FROM table WHERE owner="value2" AND number IS NOT null; 
```

将返回“123456”。

如果你 CONCAT 这两个值，你会得到“John 123456”。

首先，这是您想要的查询的预期行为吗？如果第三行的所有者=Jack 和 number=value1，那么第一个查询返回两行“John”和“Jack”会发生什么情况？

您可以研究的一件事是`CROSS JOIN`语法。

```
SELECT CONCAT (table1.owner, ', ', table2.number) AS new_column
     FROM ( SELECT owner FROM table WHERE number="value1" ) AS tablel1
     CROSS JOIN
     (SELECT number FROM table WHERE owner="value2" AND number IS NOT null ) AS table2; 
```

请注意，如果第一个查询返回三行，第二个查询返回四行，则组合查询将返回 3*4 = 12 行。

# c# - 多选列表框asp mvc

> ID：12093508
> 
> 赞同：3
> 
> 时间：2012-08-23T14:05:20.283
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, entity-framework

我正在开发一个 mvc .net Web 应用程序，并且正在使用实体框架。在我的模型中，我有一个名为“utisateur”（用户）的实体，每个用户都有一个或多个监督他的用户。我想要做的是生成一个包含所有用户列表的多选列表框，以便选择新用户的主管。

我试图这样做，但我得到了这个错误：对象引用未设置为对象的实例。

这是我的模型课：

```
public class util 
{
    public util()
    {
        user = new utilisateur();
        listesups = Getutilisateurs(null);
    }
    public utilisateur user { get; set; }
    public int[] selectedusers;
    public MultiSelectList listesups { get; set; }       
    public MultiSelectList Getutilisateurs(int[] selectedValues)
    {
        var db = new BDGestionEntities();
        List<utilisateur> utilisateurs = db.utilisateurs.ToList();
        return new MultiSelectList(utilisateurs, "id", "login", selectedValues);
    }
} 
```

这是包含列表框的视图部分：

```
 @Html.ListBoxFor(model => model.selectedusers, Model.listesups) 
```

这是控制器

```
 public ActionResult Create2()
    {
        return View();
    }

[HttpPost]
    public ActionResult Create2(util model)
    {
        utilisateur u = new utilisateur();
        if (model.selectedusers != null)
        {
            foreach (var selecteduse in model.selectedusers)
            {
                int selecteduseId = selecteduse;
                utilisateur utilisateur = db.utilisateurs.Where(c => c.id == selecteduseId).FirstOrDefault();
                u.superieur.Add(utilisateur);
            }

        }
        u.nom = model.user.nom;
        u.prenom = model.user.prenom;
        u.solde_conge = model.user.solde_conge;
        u.email = model.user.email;
        u.login = model.user.login;
        u.pwd = model.user.pwd;
        role role = new role();
        //role.nom_role = model.nom_role;

        role = db.roles.Where(c => c.nom_role == model.nom_role).FirstOrDefault();
        u.role = role;
        db.utilisateurs.AddObject(u);
        db.SaveChanges();
        ViewBag.id_role = new SelectList(db.roles, "id", "nom_role", model.user.id_role);
        return RedirectToAction("index");

    } 
```

这是错误消息

```
Server Error in '/' Application.
Object reference not set to an instance of an object.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 
Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 
Line 44:         <tr><td><label><b>Role : </b></label></td><td>@Html.DropDownListFor(model => model.nom_role, values)</td></tr>
Line 45:         <tr>
Line 46:       <td><label><b>Liste des supérieurs : </b></label></td><td>@Html.ListBoxFor(model => model.selectedusers, Model.listesups)</td></tr>
Line 47:         </table>
Line 48:         <p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:18:28.513

我通过像这样编辑我的`Create2()`方法解决了这个问题：

```
public ActionResult Create2()
    {
        string login = User.Identity.Name;
        utilisateur ut = new utilisateur();
        var q = from j in db.utilisateurs where j.login == login select j;
        foreach (var i in q)
            ut = i;
        if ((ut.role.nom_role == "Stagiaire") || (ut.role.nom_role == "Developpeur"))
            return Redirect("~/Erreur");
        util u = new util();
        u.listesups = new MultiSelectList (db.utilisateurs, "id", "login");
        return View(u);
    }

[HttpPost]
    public ActionResult Create2(FormCollection collection, util model)
    {

        var sups = collection["selectedusers"];
        string login = User.Identity.Name;
        utilisateur u = new utilisateur();
        List<int> nums = new List<int>();
        var q = from j in db.utilisateurs where j.login == login select j;
        utilisateur courant = new utilisateur();
        try
        {
            foreach (var i in q)
            {
                courant = i;
            }
            foreach (var s in sups.Split(','))
            {
                nums.Add(int.Parse(s));
            }
        }
        catch(Exception ex)
        {
            Logger.Warning(ex.Message, "aucun superieur selectionné");
        }
        try
        {
            foreach (var selecteduse in nums)
            {
                utilisateur utilisateur = db.utilisateurs.Where(c => c.id == (int)selecteduse).FirstOrDefault();
                u.superieur.Add(utilisateur);
            }
        }
        catch(Exception ex)
        {
            Logger.Error(ex.Message, "Erreur ajout supérieurs");
        }
        //}
        if ((model.user.nom != null) && (model.user.prenom != null) && (model.user.login != null) && (model.user.email != null))
        {
            u.nom = model.user.nom;
            u.prenom = model.user.prenom;
            u.solde_conge = model.user.solde_conge;
            u.email = model.user.email;
            u.login = model.user.login;
            u.pwd = model.user.pwd;
            role role = new role();
            role = db.roles.Where(c => c.nom_role == model.nom_role).FirstOrDefault();
            u.role = role;
            try
            {
                db.utilisateurs.AddObject(u);
                db.SaveChanges();
            }
            catch (Exception ex)
            {
                Logger.Error(ex.Message, "");
            }

                ViewBag.id_role = new SelectList(db.roles, "id", "nom_role", model.user.id_role);
            return RedirectToAction("index");
        } 
```

# jquery - Jquery将css添加到头部

> ID：12093509
> 
> 赞同：20
> 
> 时间：2012-08-23T14:05:26.457
> 
> 标签：jquery, css, asynchronous, head

我正在将一些脚本和样式表异步添加到我正在构建的项目中，并希望将样式表全部组合在 HEAD 中。

```
<head>
  <title>home</title>
  <meta charset="utf-8">
  <link rel="Shortcut Icon" type="image/ico" href="/img/favicon.png">

  <!-- STYLES-->
  <link rel="stylesheet" href="/css/fonts-and-colors.css" type="text/css" media="screen"> 
  <link rel="stylesheet" href="/css/layout.css" type="text/css" media="screen">

  <!-- JS-->
  <script type="text/javascript" async="" src="/js/light-box.js"></script>
  <script type="text/javascript" src="/js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="/js/grade-button.js"></script>
  <script>
    $(document).ready(function() {
        // some code
    });
  </script>
  <link rel="stylesheet" href="/css/masterBlaster.css" type="text/css" media="screen">
</head> 
```

我目前正在使用

```
$("head").append("<link rel='stylesheet' href='/css/masterBlaster.css' type='text/css' media='screen'>"); 
```

效果很好，但是正如您在示例中看到的那样，它会将其添加到我的 HEAD 部分的底部。

我的强迫症想在我的第一个样式链接之前或最后一个样式链接之后添加它。

感谢您的关注。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-08-23T14:08:00.643

这会将新元素放置在元素中`link`的最后一个之后。`link``head`

```
$("head link[rel='stylesheet']").last().after("<link rel='stylesheet' href='/css/masterBlaster.css' type='text/css' media='screen'>"); 
```

但是，如果您还没有适当的`link`位置，则不会添加新的`link`. 因此，您应该先进行检查：

```
var $head = $("head");
var $headlinklast = $head.find("link[rel='stylesheet']:last");
var linkElement = "<link rel='stylesheet' href='/css/masterBlaster.css' type='text/css' media='screen'>";
if ($headlinklast.length){
   $headlinklast.after(linkElement);
}
else {
   $head.append(linkElement);
} 
```

* * *

> 我的强迫症想在我的第一个样式链接之前或最后一个样式链接之后添加它。

您应该决定`link`将要放置的确切位置。不同的位置可能会覆盖现有样式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T14:08:12.960

您可以使用：

> .prepend()

[http://api.jquery.com/prepend/](http://api.jquery.com/prepend/)

# java - Google/Eclipse windowbuilder - 它是如何工作的？

> ID：12093511
> 
> 赞同：0
> 
> 时间：2012-08-23T14:05:33.447
> 
> 标签：java, eclipse, windowbuilder

当您设计一个 GUI 窗口时，它是否会在任何地方为您的 GUI 布局保存自己的定义文件，或者它只是为您的 GUI 创建 JAVA，然后它使用该 JAVA 文件再次加载您的 GUI 布局？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:23:28.180

WindowBuilder 只是使用代码创建一个 .java 文件。如果您在 Eclipse 中打开 GUI 文件，并且无论何时切换到 Design，WindowBuilder 都会解析代码并创建某种预览。然后您可以进行更改，它们将被转移到代码中。据我所知，没有涉及其他文件。

您还可以尝试使用 Open With -> WindowBuilder Editor 打开包含 GUI 代码的现有文件。之后 Eclipse 会意识到它是一个 GUI 文件，您可以随时在 Source 和 Design 视图之间切换。

但是，我不知道它对由多个类/文件组成的 GUI 有何反应。

# java - oracle连接preparedStatement对象打印出要执行的查询

> ID：12093522
> 
> 赞同：0
> 
> 时间：2012-08-23T14:06:08.053
> 
> 标签：java, database, oracle, prepared-statement

在 Java 中，我想打印出将在数据库上提交/查询的查询，以便在查询抛出异常时可以看到错误是什么。

准确定位问题而不是尝试理解 Oracle 异常 ID 并尝试匹配代码中失败的确切位置将很有用。请提供任何帮助。

`PreparedStatement ps = conn.prepareStatement("SELECT * FROM EMPLOYEES where EMPNAME=?");`
`ps.setString(1, "HULK");`
`ps.executeQuery();`

理想情况下，我想做一个 syso(ps) 或 syso(ps.getquery) 并且输出应该是

`SELECT * FROM EMPLOYEES WHERE EMPNAME='HULK'`
或者
`SELECT * FROM EMPLOYEES WHERE EMPNAME=<HASHCODE OF THE OBJECT YOU ARE TRYING TO BIND>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:30:58.333

我遇到了一些有趣的东西，[Log4JDBC](http://code.google.com/p/log4jdbc/)，它允许您记录 SQL 调用。我还没有机会使用它，但我认为能够更改日志记录级别并将 SQL 调用放入日志文件是一个好主意。

这比你要求的要多，但我认为它可能值得扔在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:26:18.420

我认为这已经在[这里](https://stackoverflow.com/questions/2683214/get-query-from-java-sql-preparedstatement)得到了回答。

简短回答：打印 toString() 方法或 PrepareStatement 以查看将绑定变量替换为值的查询。

**但是：这完全取决于实施者。并非所有的 JDBC 驱动程序都添加了这种功能。**

如果您的特定驱动程序不符合这一点，那么唯一的解决方法是通过连接值而不是使用绑定变量来组合 SQL（失去 RDBMS 在使用绑定变量时为您提供的性能优势）。

但为此，您必须将内容转换为字符串等。

这将是自相矛盾的，因为我发现连接的 SQL 最容易出错，并且是最需要打印和检查的。

# mercurial - 推送到 Bitbucket 时如何修复“远程：需要 ssl”？

> ID：12093528
> 
> 赞同：12
> 
> 时间：2012-08-23T14:06:33.023
> 
> 标签：mercurial, tortoisehg

每当我尝试推送我的更改时，我都会收到上述错误。我使用 TortoiseHg 作为客户端。

这是调试输出`hg push`：

```
pushing to https://nulldev@bitbucket.org/nulldev/windows-phone    
using https://bitbucket.org/nulldev/windows-phone    
proxying through http://[proxy - omitted]
http auth: user nulldev, password not set    
sending capabilities command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Looking for password for user nulldev and url https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Keyring password found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
query 1; heads    
sending batch command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
searching for changes    
all remote heads known locally    
sending branchmap command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
sending branchmap command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
preparing listkeys for "bookmarks"    
sending listkeys command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
1 changesets found    
list of changesets:
35b9240f7e7a5eee7936d8559962971e94fab1fc    
bundling: 1/1 changesets (100.00%)    
bundling: 1/1 manifests (100.00%)    
bundling: Key Ring/Controls/BindableApplicationBarIconButton.xaml.cs 1/1 files (100.00%)    
sending unbundle command    
sending 431 bytes    
bitbucket.org certificate successfully verified    
sending: 0 kb    
sending: 0 kb    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
sending: 0 kb    
sending: 0 kb    
remote: ssl required    
preparing listkeys for "phases"    
sending listkeys command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified    
try to push obsolete markers to remote    
checking for updated bookmarks    
preparing listkeys for "bookmarks"
sending listkeys command    
bitbucket.org certificate successfully verified    
[HgKeyring] Keyring URL: https://bitbucket.org/nulldev/windows-phone    
[HgKeyring] Cached auth data found. Url: https://bitbucket.org/nulldev/windows-phone, user: nulldev, passwd: ********    
bitbucket.org certificate successfully verified 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-23T14:22:22.617

这通常是由于服务器端（即 BitBucket 端）的配置问题，如这张[旧票](https://bitbucket.org/site/master/issue/2593/getting-ssl-required-when-pushing-to-wiki)所示（突然有一些新条目，都提到了您的错误）。

```
pushing to https://nulldev@bitbucket.org/nulldev/windows-phone
http authorization required
realm: Bitbucket.org HTTP
user: nulldev
password: 
searching for changes
remote: ssl required 
```

如“[远程仓库](http://mercurial.aragost.com/kick-start/en/remote/)”中所述：

> 默认情况下，Mercurial 的网络服务器不允许您通过纯 HTTP 推送，它要求您使用 HTTPS URL。Alice 可以在为存储库提供服务时通过在命令行上
> 使用来禁用此要求`--config web.push_ssl=No`

所以我想在 BitBucket 方面，他们需要确保 repo 提供：

```
hg serve --config web.push_ssl=No --config "web.allow_push=*" 
```

# iphone - 使用 SDWebImage 到 iPhone

> ID：12093533
> 
> 赞同：1
> 
> 时间：2012-08-23T14:07:00.993
> 
> 标签：iphone, uiimageview, sdwebimage

我正在为我的应用程序使用 SDWebImage。

我从此 [链接下载了 ASWebImage 文件](https://github.com/rs/SDWebImage)

添加到 myapp. 然后我导入了 UIImageView+WebCache.h

当我运行我的应用程序时，我遇到了异常。

这是我的代码

```
self.view.backgroundColor = [UIColor whiteColor];
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)]
[imageView setImageWithURL:[NSURL URLWithString:@"http://mydomain.com/a.jpg"]];
[self.view addSubview:imageView];
[imageView release]; 
```

当我运行这个应用程序时，我得到以下异常。

```
[UIImageView setImageWithURL:]: unrecognized selector sent to instance 0x6e64390
2012-08-23 19:32:14.828 test123[16941:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIImageView setImageWithURL:]: unrecognized selector sent to instance 0x6e64390' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T17:57:59.437

为了解决这个问题，请参考项目安装说明。我遇到了同样的错误，但是按照安装说明进行操作后，问题立即得到了解决。

您可以在此处找到这些说明：[https ://github.com/rs/SDWebImage#installation](https://github.com/rs/SDWebImage#installation)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T07:27:39.857

确保您已导入“ImageIO.framework”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:12:39.727

您是否已将 SDWebImage 库与您的应用程序相关联？链接器标志 -ObjC 怎么样？

# objective-c - 枚举数/语义问题的重新定义

> ID：12093534
> 
> 赞同：3
> 
> 时间：2012-08-23T14:07:01.843
> 
> 标签：objective-c, ios

我现在在使用 XCode 时遇到了严重的问题，我真的不知道该怎么做，甚至不知道出了什么问题。

我正在处理的项目昨天运行良好，但今天当我开始它时，我得到了 20 个“枚举器的重新定义”错误，并且到了“发出太多错误。现在停止”的地步。

奇怪的是，我对项目的所有备份都这样做了。即使是 2,3 或 4 天前的那些也没有改变。

似乎没有其他项目受此影响。

我试过清理构建，删除派生数据，以某种方式检查重复文件（即使这不应该），所有链接器似乎都是有序的。有人对我有任何提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-24T08:31:06.930

你应该进口

`#import "Facebook.h"`
反而

```
#import <FacebookSDK/FacebookSDK.h> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-11T17:05:57.423

我刚刚遇到了关于“重新定义枚举器”错误的确切问题。问题是我不小心（可能是鼠标意外拖动）将其中一个项目目录复制到了另一个目录中，从而复制了它。

另一方面，我使用 git 并且通常使用 'git status -uno' 来隐藏未跟踪的文件。

所以我没有看到在项目中复制枚举的未跟踪的重复目录，从我的角度来看，我有一个干净的 HEAD 有奇怪的错误：S

经验教训：使用 .gitignore 而不是 '-uno' 选项

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-14T10:05:50.630

这个问题在 2019 年仍然发生。如果你得到这个去检查**File->Workspace Settings**并将构建系统设置为**Legacy Build System**。这应该可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-27T19:38:45.020

我有同样的错误，真的被卡住了。但发现项目文件夹 nam 有空格。我改变了它，错误消失了！

> 例如：将文件夹名称**My Project**更改为**MyProject**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-28T02:25:14.460

For anyone has the same problem, who pulled out hair for hours/days. Let's double check and remove redundant **Header Search Paths**, delete **Derived Data** if needed. After that, the issue will be resolved.

# asp.net-mvc-3 - tdd - 如何测试 User.Identity.Name 是否出现在剃刀视图中

> ID：12093537
> 
> 赞同：0
> 
> 时间：2012-08-23T14:07:10.643
> 
> 标签：asp.net-mvc-3, razor, tdd

我正在尝试对剃刀视图（MVC .NET）进行单元测试。我想测试登录的用户名是否出现在网站上。由于 User.Identity.Name，我不确定我将如何做到这一点 - 这是一个静态对象，所以不能被嘲笑。

这个静态对象是否应该在测试中设置？有没有更好的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:51:44.263

您可以创建一个带有模拟 HttpContext 的 ControllerContext，以根据您的喜好返回 IPrincipal。请参阅这篇文章，了解如何做到这一点：

[模拟和 HttpContextBase.get_User()](https://stackoverflow.com/questions/677801/mocking-and-httpcontextbase-get-user)

该示例使用 Rhino Mocks，但很容易适应您使用的任何模拟框架。确保假的 IPrincipal.Identity.Name 返回名称的字符串。如果你认为它不清楚，我可以给你一个 FakeItEasy 或 Rhino Mocks 的例子。

然后，您可以断言放置在 ViewBag 或 ViewModel 中的用户名与您让假 IIdentity 返回的用户名相同。

# javascript - Jquery“大于”符号

> ID：12093538
> 
> 赞同：2
> 
> 时间：2012-08-23T14:07:12.483
> 
> 标签：javascript, jquery, dwr

当我使用下面的符号和 '>' 时

```
$('#tablesorter > tbody') 
```

在代码中

```
var message;
myService.getUsers({ callback : function(str) { 
    message= jQuery.parseJSON(str);
}}); 

$.each(message, function() {

    $('#tablesorter > tbody').append(
    '<tr><td>' + this.name
    + '</td><td>' + this.surname
    + '</td>' + '</tr>');
}); 
```

注：`myservice`是dwr服务，不知道有没有关系

我在 chrome 控制台中有错误

```
Uncaught Error: Syntax error, unrecognized expression: &gt; 
```

`&gt;`方法`>`

当我删除`>`错误消失但它没有按预期工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:12:33.417

大于`>`号用于 CSS 选择器（jQuery 选择器所基于）中，表示“直接后代”。

[文档](http://reference.sitepoint.com/css/childselector)

您发布的代码工作正常，其中的`>`符号不​​会导致任何错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:15:53.857

无论您在哪里输出代码，它都会被转换为自动转义。也许你有一种介于两者之间的模板语言。

You need to either store all of your javascript code in a separate file (the best solution), or find a way with your pages (JSP?) to disable output escaping.

# html - 如何使我的 CSS 代码与所有浏览器兼容？

> ID：12093540
> 
> 赞同：4
> 
> 时间：2012-08-23T14:07:19.763
> 
> 标签：html, css, cross-browser

```
 p {
        margin:0;padding:0;
    }
    p#error {
        color:#FF0000;
        text-align:center;
    }
    p#success {
        color:#3983C2;
        text-align:center;
    }
    div#nav {
        background-image:url('../img/nav.png');
        background-repeat:no-repeat;
        padding-top:5px;
        padding-bottom:5px;
    }
    div#nav, a {
        text-decoration:none;
    }
    body {
        margin:0 auto;
        width:600px;
    }
    div#login, div#register {
        background-image:url('../img/form.png');
        background-repeat:repeat-y;
        padding-top:5px;
        padding-bottom:5px;
    }
    div#login table, div#register table {
        margin:0 auto;
    }
    div#login table td, div#register table td {
        text-align:right;
    }
    div#login input#btn, div#register input#btn {
        background-image:url('../img/btn.png');
        border-style:none;
        width:70px;height:25px;
    }
    div#footer {
        background-image:url('../img/footer.png');
        height:30px;
    } 
```

这是我的 CSS 代码。我不知道如何让这个 CSS 在其他浏览器中工作，目前我在 Chrome 中工作。我已经在网上搜索了很多相关信息的页面，但是这些对我来说更难以理解。需要您的建议等。非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T14:10:31.120

您的 CSS 应该可以在所有浏览器中按原样工作。从浏览器到浏览器的显示可能不同。大多数开发人员使用重置来解决该问题。

**CSS 重置**

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

或者

**标准化**

[http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:10:51.407

问题是每个浏览器为不同的项目添加了不同的默认边距、填充等。这意味着您可以在每个布局中获得轻微或很大不同的布局。

我喜欢做这样的 CSS 休息：

```
*{margin:0; padding:0} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:11:41.983

IE（最大的敌人）：[http](http://css-tricks.com/how-to-create-an-ie-only-stylesheet/)
://css-tricks.com/how-to-create-an-ie-only-stylesheet/ 火狐：[http ://css-tricks.com/snippets/css/css-hacks- target-firefox/](http://css-tricks.com/snippets/css/css-hacks-targeting-firefox/)
Opera：[如何使 CSS 仅对 Opera 可见](https://stackoverflow.com/questions/1120335/how-to-make-css-visible-only-for-opera)

# java - 无法在类中实例化泛型数据类型

> ID：12093541
> 
> 赞同：22
> 
> 时间：2012-08-23T14:07:22.000
> 
> 标签：java, generics

我有一个不可变的类，具有以下布局，

```
public final class A <T> {
    private ArrayList<T> myList;
    private A(){
        myList = new ArrayList<T>();
    }
    public A<T> addData(T t){
        A newOb = // make a new list and instantiate using overloaded constructor
        T newT = new T(); ***********ERROR HERE*************
        newOb.myList.add(newT);
        return newOb;
    }
    .........
} 
```

我在这里得到的错误是`cannot instantiate type T`. 现在，我认为这可能`type erasure`与Java有关。

我该如何克服呢？我想将传递给 addData 的参数的新副本添加到我的列表中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T14:22:23.040

```
T newT = (T) t.getClass().newInstance() // assuming zero args constructor and you'll
                                        // have to catch some reflection exceptions 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-09-27T09:20:15.963

在 Java 8 中，您可以传递一个*工厂 lambda*，它会创建一个所需类型的新实例：

```
public final class A <T> {
    private ArrayList<T> myList;
    private A(){
        myList = new ArrayList<T>();
    }
    public A<T> addData(Supplier<T> factory){
        A newOb = // make a new list and instantiate using overloaded constructor
        T newT = factory.get();
        newOb.myList.add(newT);
        return newOb;
    }
    .........
} 
```

例如像这样使用它：

```
A<Integer> a = new A<>();
a.addData( () -> new Integer(0) ); 
```

内置的无参数[供应商](https://docs.oracle.com/javase/8/docs/api/index.html?java/util/function/Supplier.html)接口可以用作回调的包装器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:09:45.380

在java语言中泛型是通过擦除来实现的，所以不可能实例化一个泛型类型。也不可能创建一个泛型类型的数组等等。

> 我该如何克服呢？我想将传递给 addData 的参数的新副本添加到我的列表中。

您可以尝试使用`Cloneable`接口作为类型绑定或添加自己的类似接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-03T21:46:15.353

我寻找类似问题的解决方案。这是我提出的解决方案：

```
public final class ImmutableA<T> {
private ArrayList<T> myList;
private Class<T> clazz;

public static <E> ImmutableA<E> createEmpty(Class<E> clazz) {
    return new ImmutableA<>(clazz);
}

private ImmutableA(Class<T> clazz) {
    this.myList = new ArrayList<T>();
    this.clazz = clazz;
}

public ImmutableA<T> addData(T t) {
    ImmutableA<T> newOb = new ImmutableA<>(clazz);
    try {
        Constructor<T> constructor = clazz.getDeclaredConstructor(clazz);
        T newT = constructor.newInstance(t);
        newOb.myList.add(newT);
        return newOb;
    } catch (NoSuchMethodException | InvocationTargetException | InstantiationException | IllegalAccessException e) {
        e.printStackTrace();
    }
    return null;
}

public ArrayList<T> getMyList() {
    return myList;
}

public static void main(String[] args) throws InstantiationException, IllegalAccessException {
    ImmutableA<String> immutableA = createEmpty(String.class);
    System.out.print(immutableA.getMyList().toString());
    immutableA = immutableA.addData("a");
    System.out.print(immutableA.getMyList().toString());
    immutableA = immutableA.addData("b");
    System.out.print(immutableA.getMyList().toString());
    immutableA = immutableA.addData("c");
    System.out.print(immutableA.getMyList().toString());
} 
```

}

希望这会对某人有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T14:15:29.320

您可以像这样使用 clone() 方法：

```
public final class A <T extends Cloneable> {
    private ArrayList<T> myList;
    private A(){
        myList = new ArrayList<T>();
    }
    public A<T> addData(T t){
        T newT = t.clone();
        newOb.myList.add(newT);
        return newOb;
    }
    .........
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-01-07T14:14:09.770

你可以得到 T 的类型

```
Type type = new TypeToken<T>(){}.getType(); 
```

然后得到一个 T 的实例

```
type.getClass().newInstance(); 
```

完整示例

```
public T foo() {
    try {
        return (T) type.getClass().newInstance();
    } catch (Exception e) {
        return null;
    }
} 
```

# node.js - Supertest/mocha 错误：检测到全局泄漏：路径

> ID：12093544
> 
> 赞同：0
> 
> 时间：2012-08-23T14:07:28.857
> 
> 标签：node.js, express, mongoose, mocha.js

所以我正在尝试为我的 REST API（建立在 Express 和 Mongoose 之上）编写测试，但我遇到了一些麻烦。

我遵循了很多示例和教程，这表明我下面的解决方案应该可以工作，但事实并非如此——我得到了一个`Error: global leak detected: path`

似乎导致它的线路是`.post( '/api/invoices' )`- 但我不知道为什么。

```
var app = require("../app").app,
    request = require("supertest");

describe("Invoice API", function() {

    it( "GET /api/invoices should return 200", function (done) {
        request(app)
            .get( '/api/invoices' )
            .expect( 200, done );
    });

    it( "GET /api/invoices/_wrong_id should return 500", function (done) {
        request(app)
            .get( '/api/invoices/_wrong_id' )
            .expect( 500, done );
    });

    it( "POST /api/invoices should return 200", function (done) {
        request(app)
            .post( '/api/invoices' )
            .set( 'Content-Type', 'application/json' )
            .send( { number: "200" } )
            .expect( 200, done );
    });

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:36:24.693

发生的事情是您的代码中的某个地方缺少您的`var`声明。Mocha 足够聪明，可以在您的整个项目中检测到这一点，而不仅仅是您的测试文件。

如，您可能正在这样做：

```
path = require('path'); 
```

代替

```
var path = require('path'); 
```

或者甚至...

```
var fs = require('fs')     //<--- notice the missing comma
    path = require('path'); 
```

当您不声明变量时，它们会附加到全局范围。在 Node.js`global`中是`window`.

# java - 在java中绘制椭圆的图形不会增加大小

> ID：12093547
> 
> 赞同：3
> 
> 时间：2012-08-23T14:07:39.340
> 
> 标签：java, swing, graphics, 2d-games

我正在使用`Ovals`和`Graphics`对象在java中编写一个简单的游戏。它被称为病毒，它的工作原理是这样的：中间有一个椭圆，外面有六个椭圆。这些外面的椭圆应该会增加大小，直到被点击，当它们消失并且玩家得分十分时。如果一个椭圆与中央椭圆相接触，中央椭圆的健康度就会下降。当它达到零时，游戏结束。我遇到的问题是外部椭圆的大小不会增加。为什么会这样？

这是我的代码：

```
package virus;

import java.awt.*;
import java.util.Random;
import javax.swing.JPanel;

import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

public class VirusGamePanel extends JPanel implements MouseListener{
    private static final long serialVersionUID = 1L;//serialVersionUID field
    Random colour = new Random();//the outside ovals will always be a random colour
    private int sizeX = 1;//the x size of the outside ovals 
    private int sizeY = 1;//the y size of the outside ovals
    int score = 0;
    static String scorestring = "Score: ";
    Color rand = new Color(colour.nextInt(255),colour.nextInt(255),colour.nextInt(255));//generate the random colour

    public void paint(Graphics g)
    {
        super.paint(g);
        g.setColor(Color.magenta);
        g.drawString(scorestring+score,275,250);
        g.setColor(Color.orange);
        g.drawOval(200,150,200,200);
        g.setColor(rand);
        g.drawOval(270,50,50,50);
        g.drawOval(100,100,50,50);
        g.drawOval(450,100,50,50);
        g.drawOval(100,400,50,50);
        g.drawOval(450,400,50,50);
        g.drawOval(275,450,50,50);
        g.fillOval(270,50,sizeX,sizeY);//these six ovals are supposed to increase in size
        g.fillOval(100,100,sizeX,sizeY);
        g.fillOval(450,100,sizeX,sizeY);
        g.fillOval(100,400,sizeX,sizeY);
        g.fillOval(450,400,sizeX,sizeY);
        g.fillOval(275,450,sizeX,sizeY);
        inc();
    }

    public static void main(String[] args) {
      JPanel panel = new VirusGamePanel();

      JFrame frame = new JFrame("Virus");
      frame.setSize(700, 700);
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(panel);
      frame.setVisible(true);
    }

    private void inc()//increase the size of the ovals
    {
        for(int i = 0; i<25000; i++)
        {
            sizeX++;
            sizeY++;
            repaint();
        }
    } 
```

带线程的新代码：

```
package virus;

import java.awt.*;
import java.util.Random;
import javax.swing.JPanel;

import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

public class VirusGamePanel extends JPanel implements MouseListener,Runnable{
    private static final long serialVersionUID = 1L;
    Random colour = new Random();
    private int sizeX = 1;
    private int sizeY = 1;
    int score = 0;
    Thread thr = new Thread();
    static String scorestring = "Score: ";
    Color rand = new Color(colour.nextInt(255),colour.nextInt(255),colour.nextInt(255));

    public void paint(Graphics g)
    {
        super.paint(g);
        thr.start();
        g.setColor(Color.magenta);
        g.drawString(scorestring+score,275,250);
        g.setColor(Color.orange);
        g.drawOval(200,150,200,200);
        g.setColor(rand);

        g.fillOval(270,50,sizeX,sizeY);
        g.fillOval(100,100,sizeX,sizeY);
        g.fillOval(450,100,sizeX,sizeY);
        g.fillOval(100,400,sizeX,sizeY);
        g.fillOval(450,400,sizeX,sizeY);
        g.fillOval(275,450,sizeX,sizeY);
        inc();
    }

    public static void main(String[] args) {}

    private void inc()
    {
        thr.run();
    }
    public void run(){
        for(int i = 0; i<25000; i++)
        {
            sizeX++;
            sizeY++;
            repaint();
            try
            {
                Thread.sleep(10);
            }
            catch(InterruptedException e)
            {
                e.printStackTrace();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:17:11.223

```
 for(int i = 0; i<25000; i++)
    {
        sizeX++;
        sizeY++;
        repaint();
    } 
```

您的计算机无法像 CPU 增加 sizeX 和 sizeY 一样快地重新绘制。以毫秒为单位添加一些等待时间（特别是如果您绘制像 800x600 这样的大区域）

```
 for(int i = 0; i<25000; i++)
    {
        sizeX++;
        sizeY++;
        repaint();
        try{ sleep(100);} catch(InterruptedException e){}
    } 
```

But, do this from another thread! So, your app. will not freeze.

This is 10 FPS. But you tried 2G FPS. Good day.

Here is an example of a thread.

```
class TEN_FPS extends Thread
{
    public void run()
    {
        while(working)
        {
             //calculations here
             repaint();
             try{sleep(100);}catch(InterruptedException e){}
        }
     }
 } 
```

Then in the main method:

```
working=true;
TEN_FPS.start(); 
```

When you are done with this program:

```
working=false; 
```

will release your daemon thread.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:20:39.357

Your code is recursive. In inc(), you call repaint, which calls VirusGamePanel.paint(), which calls inc() ...

Each call to repaint() will reinvoke the paint() method. So instead of looping in inc() do this:

```
private void inc()// increase the size of the ovals
{
  sizeX++;
  sizeY++;
  repaint();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T14:29:08.723

This works for me:

```
public class VirusGamePanel extends JPanel{
    private static final long serialVersionUID = 1L;//serialVersionUID field
    Random colour = new Random();//the outside ovals will always be a random colour
    private int sizeX = 0;//the x size of the outside ovals 
    private int sizeY = 0;//the y size of the outside ovals
    int score = 0;
    static String scorestring = "Score: ";
    Color rand = new Color(colour.nextInt(255), colour.nextInt(255), colour.nextInt(255)); //generate the random colour

    public void paint(Graphics g)
    {
        super.paint(g);
        g.setColor(Color.magenta);
        g.drawString(scorestring+score,275,250);
        g.setColor(Color.orange);
        g.drawOval(200, 150, 200, 200);
        g.setColor(rand);
        g.fillOval(270 - sizeX / 2, 50 - sizeY / 2, sizeX, sizeY);//these six ovals are supposed to increase in size
        g.fillOval(100 - sizeX / 2,100 - sizeY / 2, sizeX, sizeY);
        g.fillOval(450 - sizeX / 2,100 - sizeY / 2, sizeX, sizeY);
        g.fillOval(100 - sizeX / 2,400 - sizeY / 2, sizeX, sizeY);
        g.fillOval(450 - sizeX / 2,400 - sizeY / 2, sizeX, sizeY);
        g.fillOval(275 - sizeX / 2,450 - sizeY / 2, sizeX, sizeY);
        inc();
    }

    public static void main(String[] args) {
      JPanel panel = new VirusGamePanel();

      JFrame frame = new JFrame("Virus");
      frame.setSize(700, 700);
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(panel);
      frame.setVisible(true);
    }

    private void inc()//increase the size of the ovals
    {
            sizeX++;
            sizeY++;
            repaint();
    }
} 
```

Just fixed the center points of the ovals and removed the loop in the `inc` method. If you want the oval boundaries drawn, just add the `drawOval` commands with the same parameters as the `fillOval` commands.

**EDIT**:

If you want to slow down the growth process, just add the following just before the `inc()` call of the `paint` method:

```
try {
    Thread.sleep(100);
} catch (InterruptedException e) {
    e.printStackTrace();
} 
```

# wpf - 未能以编程方式将非空验证器添加到 WPF 组合框

> ID：12093548
> 
> 赞同：0
> 
> 时间：2012-08-23T14:07:40.760
> 
> 标签：wpf

为什么会失败？

我有一个包含 ComboBox 的 UserControl。

我有一个名为“强制”的属性，如果没有选择，用户可以使用它添加验证。

所以我在用户控件中有这个：

```
public static DependencyProperty MandatoryProperty
  = DependencyProperty.Register("Mandatory", typeof(bool), typeof(CountyPicker),
    new PropertyMetadata((bool)false, OnChangedMandatoryByBinding));

private static void OnChangedMandatoryByBinding
  (DependencyObject d, DependencyPropertyChangedEventArgs e)
{
  var value = (bool)e.NewValue;

  ((CountyPicker)d).OnChangedMandatoryByBinding(value);
}

public bool Mandatory
{
  get { return (bool)GetValue(MandatoryProperty); }
  set { SetValue(MandatoryProperty, value); }
}

public void OnChangedMandatoryByBinding(bool value)
{
  var binding = BindingOperations.GetBinding
    (TheComboBox, ComboBox.SelectedItemProperty);

  binding.ValidationRules.Clear();

  if (value == true) // strange that I need this without getting a warning
  {
    binding.ValidationRules.Add(new NotNullValidator());
  }
} 
```

该 xaml 包含：

```
<UserControl x:Class="Foo.Controls.Pickers.CountyPicker"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ComboBox Name="TheComboBox"
      KeyDown="TheComboBox_KeyDown"
      SelectedItem="{Binding County,Mode=TwoWay}" />
</UserControl> 
```

但是虽然 Mandatory 的值是这样设置的：

```
<p:CountyPicker Mandatory="True"
  CountyCode="{Binding customer.CountyCode, Mode=TwoWay}"/> 
```

...似乎没有进行验证。我在 NotNullValidator:s Validate 方法中设置了一个断点，但没有命中。

# matlab - Matlab 中的错误：输入参数未定义，尽管变量存在

> ID：12093550
> 
> 赞同：0
> 
> 时间：2012-08-23T14:07:53.430
> 
> 标签：matlab, variables

我已经编写了这个函数，并且我已经定义了 rg 和 Lp 的值，但是当我运行这个函数时它仍然返回错误：（输入参数“Lr”未定义。

如果 f(Lr,rg,Xo)*f(Lr,rg,Xf)>0)，则 ==> Bis 在 12 处出错

这是功能：

```
function[Lp,Xo,Xf]=Bis(Lr,rg)

Xo=0;
Xf=10;
Err=0.01;

syms x;
f=inline('(sqrt((2/3)*(((x*Lr)/3)-(x*x)+((2*x*x*x)/Lr)-((2*x*x*x*x)/(Lr*Lr))+(((2*x*x*x*x)/(Lr*Lr))*exp(-Lr/x))))-rg)');

    if f(Lr,rg,Xo)*f(Lr,rg,Xf)>0
        disp('The values you entered are not apropriate !')
        PlotLpFunction;
    Lp='unknown';
    elseif f(Lr,rg,Xo)*f(Lr,rg,Xf)==0
        if f(Lr,rg,Xo)==0
            Lp=Xo;
        elseif f(Lr,rg,Xf)==0
            Lp=Xf;
        end

    elseif f(Lr,rg,Xo)*f(Lr,rg,Xf)<0
        xi=(Xf-Xo)/2;
        while abs(f(Lr,rg,xi))>Err 
            if f(Lr,rg,xi)*f(Lr,rg,Xf)<0
                Xo=xi;
                xi=(Xo+Xf)/2;
            elseif f(Lr,rg,xi)*f(Lr,rg,Xf)>0
                Xf=xi;
                xi=(Xo+Xf)/2;   
            end
        end
        Lp=xi;
    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:20:44.077

代码在最新版本的 Matlab 上为我执行，除了我没有 PlotLpFunction 的事实。

我最初的印象是您忘记将 Lr（和所有其他参数）发送到您的内联 f 函数中，通过将它们作为参数添加到内联函数很容易修复。您将在[官方文档](http://www.mathworks.com/help/techdoc/ref/inline.html)中找到完整的用法。

相关部分是

> `inline(expr,arg1,arg2,...)`构造一个内联函数，其输入参数由字符串 arg1, arg2,.... 指定。可以使用多字符符号名称。

但从上下文来看，它似乎在 Matlab 2011b 和 2008b 上本身就可以很好地形成内联。答案现在被接受了，所以大概这就是问题所在。其他人可以重现他的问题吗？如果是，请提供您的 Matlab 版本或其他情况。

# ajax - asp.net mvc-4：什么应该接收 ajax 调用

> ID：12093552
> 
> 赞同：2
> 
> 时间：2012-08-23T14:08:02.420
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-4

我是 ASP.NET MVC(-4) 的新手。

我想使用 jquery 从我的网站进行 Ajax 调用，并使用返回的 html 在页面上填写一个 div。因为它只是一个 div，所以我不需要带有标题和完整正文等内容的完整 html 页面。

接收端应该是什么？

它应该是普通视图、局部视图、某种特殊类型的资源或处理程序还是其他一些魔法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:20:51.690

**您可以将其与 Post 和 Get 操作一起使用**

脚本

```
 $.ajax({
      url: '@Url.Action("SomeView")',
      type: 'GET',
      cache: false,
      data: { some_id: id},
      success: function(result) {
          $('#container').html(result);
      }
  }); 
```

控制器

```
public ActionResult SomeView(int some_id)
{
    ....
    return PartialView();
} 
```

看法

```
<div id="container">
    @Html.Partial("SomeViewPartial")
</div> 
```

* * *

**或者你可以使用 AjaxActionLink**

看法

```
@Ajax.ActionLink("text", "action", "controller",
new AjaxOptions
{
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "container",
    OnSuccess = "onSuccess",
}) 
```

脚本

```
function onSuccess(result) {
    alert(result.foo);
} 
```

控制器

```
public ActionResult SomeView(int some_id)
{
    return Json(new { foo = "bar" }, JsonRequestBehavior.AllowGet);
} 
```

* * *

**您也**可以使用 Ajax.ActionLink 仅更新内容页面。使用这个：

在`~/Views/ViewStart.cshtml:`

```
@{
    Layout = Request.IsAjaxRequest() ? null : "~/Views/Shared/_Layout.cshtml";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:14:06.350

> 由于它只是一个 div 我不需要带有标题和完整正文的完整 html 页面和内容

你想要一个[PartialView](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.partialview%28v=vs.108%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:11:14.550

您可以返回`Layout`属性值设置为 null的视图

```
public class UserController : Controller
{
    public ActionResult GetUserInfo()
    {
      return View();
    }
} 
```

并且在`GetUserInfo.cshtml`

```
@{
  Layout=null;
}
<h2>This is the UserInfo View :)</h2> 
```

您可以使用 jQuery ajax 方法从任何页面调用它

```
$("#someDivId").load("@Url.Action("User","GetUserInfo")"); 
```

如果您希望 Same Action 方法处理 Ajax 调用和 Normal GET 请求调用（返回 Ajax 上的部分视图，返回 Normal Http GET 请求上的正常视图），您可以使用该`Request.IsAjax`属性来确定。

```
 public ActionResult GetUserInfo()
 {
    if (Request.IsAjaxRequest)
    {
       return View("Partial/GetUserInfo.cshtml");
    }
    return View();  //returns the normal view.
 } 
```

`Views/`*假设您在YourControllerName*`/Partial`文件夹中预设了部分视图（布局设置为 null 的视图）

# c++ - 整体 C++ 内存泄漏检测

> ID：12093553
> 
> 赞同：2
> 
> 时间：2012-08-23T14:08:05.713
> 
> 标签：c++, memory-leaks, memory-leak-detector

我放

```
_CrtMemState and _CrtMemCheckpoint() 
```

正好在`main()`函数之后

```
_CrtMemState, CrtMemCheckpoint(), _CrtMemDifference(), _CrtMemDumpStatistics() 
```

正好在右括号 } 之前`main()`，我得到一些字节泄漏（普通块和 CRT）

在相同的代码中使用`CrtDumpMemoryLeaks()`我不会出现内存泄漏。对于 CrtDumpMemoryLeaks 我使用 _CRTDBG_LEAK_CHECK_DF 所以我相信因为我使用了一些外部库（这是一个大型项目）在程序结束时释放的内存。

因此可以使用 CrtMemDumpStatistics() 实现相同的功能（CrtDumpMemoryLeaks() 和 _CRTDBG_LEAK_CHECK_DF），或者不可能，所以 CrtMemDumpStatistics 仅对本地快照内存测试有用？

谢谢

# charts - JavaFX 2.x：绘制后如何删除 XY 折线图？

> ID：12093556
> 
> 赞同：2
> 
> 时间：2012-08-23T14:08:21.670
> 
> 标签：charts, plot, line, javafx-2

我在 XY 折线图上绘制了一个简单的系列，如下所示

```
public class SimpleXYLineChart extends Application {

@Override
public void start(Stage stage) {        
   stage.setTitle("Line plot");       

   final CategoryAxis xAxis = new CategoryAxis();
   final NumberAxis yAxis = new NumberAxis(1, 22, 0.5);

   yAxis.setTickLabelFormatter(new NumberAxis.DefaultFormatter(yAxis){
        @Override
    public String toString(Number object){
        return String.format("%7.2f", object);
    }
});
    final LineChart<String, Number>lineChart = new LineChart<String, Number>(xAxis, yAxis);

    lineChart.setCreateSymbols(false);
    lineChart.setAlternativeRowFillVisible(false);
    lineChart.setLegendVisible(false);
    lineChart.setTitle("LineChart");

    XYChart.Series series1 = new XYChart.Series();

    series1.getData().add(new XYChart.Data("Jan", 1));
    series1.getData().add(new XYChart.Data("Feb", 1.5));
    series1.getData().add(new XYChart.Data("Mar", 2));
    series1.getData().add(new XYChart.Data("Apr", 2.5));
    series1.getData().add(new XYChart.Data("May", 3));
    series1.getData().add(new XYChart.Data("Jun", 4));
    series1.getData().add(new XYChart.Data("Jul", 6));
    series1.getData().add(new XYChart.Data("Aug", 9));
    series1.getData().add(new XYChart.Data("Sep", 12));
    series1.getData().add(new XYChart.Data("Oct", 15));
    series1.getData().add(new XYChart.Data("Nov", 20));
    series1.getData().add(new XYChart.Data("Dec", 22));

    lineChart.getData().addAll(series1);        

    Scene scene = new Scene(new Group(), 800, 600);
    final VBox vbox = new VBox();
    final HBox hbox = new HBox();

    final Button remove = new Button("Remove Series");
    remove.setOnAction(new EventHandler<ActionEvent>() {
        @Override public void handle(ActionEvent e) {
    if (!lineChart.getData().isEmpty()){ 
        System.out.println("Remove Series");
        lineChart.getData().remove((lineChart.getData().size()-1),0);
        }
    }
    });                

    hbox.setSpacing(10);
    hbox.getChildren().addAll(remove);

    vbox.getChildren().addAll(lineChart, hbox);
    hbox.setPadding(new Insets(10, 10, 10, 50));

    ((Group)scene.getRoot()).getChildren().add(vbox);
    stage.setScene(scene);
    stage.show();
}

public static void main(String[] args) {
    launch(args);
} 
```

}

我想删除绘制的线（通过单击按钮或标记复选框）并具有如下的空场景

![在此处输入图像描述](../Images/34a4066fb498ea592a387b89d0ec65f3.png)

我不知道如何删除线一旦绘制，还没有找到任何 .remove() 或 .delete() 方法。

如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T17:27:12.987

现在问题解决了，看来是JavaFX的一个bug。

我已经通过添加解决了

lineChart.setAnimated(false); 一切正常。在 JIRA Kenai 中，它已通过评论 lineChart.setCreateSymbols(false); 被提议为 bug；

这也有效，但我认为这不是正确的答案，我可以使用 .setCreateSymbols(false) 或 (true) 设置 setAnimated(false);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T16:23:36.637

我遇到了同样的问题并提出了解决方法。为了给出一个概述，我管理一个包含所有系列的 ArrayList。每次应该从图表中删除一个系列时，我都会在 ArrayList 中搜索它并清除该系列的数据（清除，而不是删除，数据对于保持颜色很重要）。

```
final ArrayList<XYChart.Series> serieslist = new ArrayList<>();

--removing--

if(series to remove found){

serieslist.get(i).getData().clear();
addSeries(serieslist);

}

--adding--

XYChart.Series series = new XYChart.Series();
series.getData().add(SERIESDATA);

if(series to add found at i in serieslist){

serieslist.set(i, series);
addSeries(serieslist);

}
else {
serieslist.add(series);
addSeries(serieslist);
}

--method addSeries--

addSeries(ArrayList<XYChart.Series> serieslist) {

chart.getData().clear();

for (int i = 0; i < serieslist.size(); i++) {

            chart.getData().add(serieslist.get(i));
        }
    } 
```

我希望这就是你要找的。

编辑：一个问题仍未解决。当我从图表中删除一个系列时，该系列的名称/描述在图例中保持可见。我的解决方案是禁用图例并为我决定以相应颜色显示/删除系列的按钮着色。颜色可以从线图的默认样式表 (caspian.css) 中提取。它只为系列定义了 8 种颜色。为方便起见，它们是：

```
.default-color0.chart-series-line { -fx-stroke: #f9d900; }
.default-color1.chart-series-line { -fx-stroke: #a9e200; }
.default-color2.chart-series-line { -fx-stroke: #22bad9; }
.default-color3.chart-series-line { -fx-stroke: #0181e2; }
.default-color4.chart-series-line { -fx-stroke: #2f357f; }
.default-color5.chart-series-line { -fx-stroke: #860061; }
.default-color6.chart-series-line { -fx-stroke: #c62b00; }
.default-color7.chart-series-line { -fx-stroke: #ff5700; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T15:07:29.930

你的系列是一个`ObservableList`，你可以用那个列表做任何你想做的事情，它会被反映。

例如，在您的情况下：

```
 series1.getData().clear(); 
```

# javascript - 一旦被javascript检测到，如何使屏幕分辨率数据适应网络

> ID：12093557
> 
> 赞同：0
> 
> 时间：2012-08-23T14:08:22.603
> 
> 标签：javascript, jquery, responsive-design, screen-resolution

我已经浏览并查看了所有互联网的解决方案，但这个问题似乎非常困难。有很多关于如何检测用户屏幕分辨率的教程。这是通过innerWidth 和innerHeight 完成的。我的问题将是下一步。您应该使用哪个代码将此信息适应您的整个网站？！

那么，一旦你有了 innerWidth 和 innerHeight 的值，你如何使用这些信息并将其调整到整个 Web 布局？！？！

我有这个类似的代码，它可以加载图片并使其适应屏幕分辨率，它可以工作。但是我如何转换这段代码以使我的整个网络适应用户的屏幕分辨率呢？我应该将其标记为 html 吗？！？！你怎么做到这一点？！？！

PS 我正在使用分辨率为 1440x900 的计算机。在这个分辨率下看起来不错，但是一旦你有一个更小或更大的分辨率，它就会崩溃......

```
$(window).load(function() {
    var randomImages = ['img1','img2','img3','img4','img5'];
    var rndNum = Math.floor(Math.random() * randomImages.length);

     var $win = $(this);
     var iMac = $(window).width() > 1920 ? '_imac' : '';
     var $img = $('#background').attr('src', '_img/bg/index_rnd/' + randomImages[rndNum] + iMac + '.jpg').css({'position':'fixed','top':0,'left':0});
        function resize() {
            if (($win.width() / $win.height()) < ($img.width() / $img.height())) {
              $img.css({'height':'100%','width':'auto'});
            } else {
              $img.css({'width':'100%','height':'auto'});
            }
        }
        $win.resize(function() { resize(); }).trigger('resize');
    }); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-23T14:12:16.537

设置`document.documentElement.style.maxHeight`和`document.documentElement.style.maxWidth`

* * *

实际上，在重新阅读您的问题时，您要求诸如“缩放”之类的东西，您可以使用`body {transform: scale(sw, sh)}`
where `sw`is`$win.width() / 1440`和`sh`is `$win.height() / 900`（或宽度的方面正确版本，或者`1`如果您不想更改it)
`transform`尚未完全实现，因此您需要`-webkit-transform`, `-moz-transform`,`-o-transform`和`transform`

# c# - ISO语法是否遵循特定格式

> ID：12093559
> 
> 赞同：3
> 
> 时间：2012-08-23T14:08:26.227
> 
> 标签：c#, c++, grammar, iso

以下是 C# 语言规范的语法部分的摘录：

![在此处输入图像描述](../Images/50f9e9e81c1e8807fb35df78634c170b.png)

1.  这是以特定格式编写的吗？我查看了我发现的旧 C++ ISO 中的语法部分，它似乎遵循相同的格式，那么这里是否使用了一些标准来编写这个语法？我问是因为我希望能够创建一个工具，我可以在其中直接粘贴语法并立即拥有一个工作的 C# 解析器。

2.  微软似乎免费发布了他们的 C# 规范，但我在任何地方都找不到 C++11 格式。我要买这个才能看吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:45:49.970

它是 Yacc 使用的 BNF 的变体。Yacc 通常将`;`其作为其语法的一部分，但使用 C# 和 C++ 之类的语言进行更改会使事情变得更简单，其中 C# 和 C++`;`本身就非常重要。与大多数 BNF 变体不同，它有一个`:`BNF 经常使用的地方`=`（另请参阅 Van Wijngaarden 语法，您很快就会知道比这个答案来自的一点点知识要多得多）。

ISO 没有关于必须在其标准中使用哪种语法的规则，因此其他人使用 BNF、ABNF、EBNF、Wirth 语法，也许还有其他语法。

ISO 标准通常起源于国家标准或其他标准，然后由 ISO 采用。由于不同的标准机构使用不同的语法（IETF 在 RFC 中使用 ABNF [它在 RFC 5234 中定义]，BSI 和 W3C 使用 EBNF 的不同变体，等等）ISO 中的语法通常反映了它的起源。

这里就是这种情况。*Kernigan 和 Ritchie 在他们的《C 编程语言*》一书中使用了这种格式。虽然 ANSI 标准和后来的 ISO 标准在语法本身上有所不同，但它们使用相同的格式，并且从那时起它就被用于其他类似 C 的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:10:42.007

每个标准都做自己的事情。但是在编译器编写者中，有一种描述语法的相当标准的方式，这就是您在此处和 C++ 标准中看到的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:12:29.197

这是您在此处看到的[backus naur 语法形式的变体。](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)虽然不完全是标准格式，但它非常相似。这通常是显示应该如何解析语言的标准方式，也是解析器生成器的常见输入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T14:14:09.493

C++ 标准不是免费提供的。您可以在 webstore.ansi.org 上以 30 美元的价格购买一份副本。搜索文档编号 14882，然后查找 C++ 标准。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T14:18:30.010

描述语法的常用方法是使用[Backus-Naur Form (BNF)](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)或[Extended Backus-Naur Form (EBNF)](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form)。如果您希望在 C# 中轻松解析语言，请查看[Irony](http://irony.codeplex.com/)，它是 C# 的语言工具包，它允许您使用与 EBNF 非常相似的东西来描述语法。

除了这些语法之外，还有[Parsing Expression Grammar (PEG)](http://en.wikipedia.org/wiki/Parsing_expression_grammar)，但我认为它不像 BNF 或 EBNF 那样普遍。

# c++ - 在 C++ 中将一维向量转换为二维

> ID：12093568
> 
> 赞同：-5
> 
> 时间：2012-08-23T14:08:49.210
> 
> 标签：c++, vector, stl

我有一个一维向量（Vp_cpp），我想转换为二维向量（声明为 Vp_2D）。但是，我的实现有点不正确，因为它无法到达“从内部循环出来”这一行。

```
std::vector<double> Vp_cpp;
std::vector<std::vector<double> > Vp_2D;

Vp_2D.resize(N_cpp);
for (int i = 0; i < N_cpp; ++i)
    Vp_2D[i].resize(N_cpp);
for (int j = 0; j < N_cpp; j++)
    for (int k = 0; k < N_cpp; k++)
{
    cout << "Beginning inner loop" << endl;
    Vp_2D[i_cpp][i_cpp2] = Vp_cpp[i_cpp2]; 
    cout << "Out from inner loop" << endl;
} 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:16:02.393

这条线对我来说似乎是错误的：

```
Vp_2D[i_cpp][i_cpp2] = Vp_cpp[i_cpp2]; 
```

我会写：

```
Vp_2D[j][k] = Vp_cpp[i++]; 
```

where`i`用于迭代`Vp_cpp`。它应该在`for (int j, ...`循环之前初始化为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:19:06.520

换行

```
Vp_2D[i_cpp][i_cpp2] = Vp_cpp[i_cpp2]; 
```

到

```
Vp_2D[j][k] = Vp_cpp[(j * N_cpp) + k]; 
```

否则，您只会多次重新分配一个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:15:10.727

`Vp_2D[i_cpp][i_cpp2] = Vp_cpp[i_cpp2];`每次您的循环通过此指令时，它都会继续重置值（因为循环内部和内部`Vp_2D[i_cpp][i_cpp2]`没有可见的分配。）`i_cpp``i_cpp2`

您应该将其更改为`Vp_2D[j][k]`.

# pie-chart - 谷歌饼图api字体大小

> ID：12093569
> 
> 赞同：0
> 
> 时间：2012-08-23T14:08:55.417
> 
> 标签：pie-chart

我正在使用使用 PHP 的谷歌饼图 API，并希望增加图表中的字体大小。我发现我们可以使用“chdls”来增加字体大小，但它不起作用......我正在使用这个网址

[http://chart.apis.google.com/chart?chs=300x200&cht=p3&chl=Won|Draw|Lost&chd=t:6.0,3.0,1.0&chtt=Pie+chart+for+TalkPHP's+soccerteam|By+maZtah&chco](http://chart.apis.google.com/chart?chs=300x200&cht=p3&chl=Won|Draw|Lost&chd=t:6.0,3.0,1.0&chtt=Pie+chart+for+TalkPHP) _ =ff0099&chdls=18

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:06:28.767

options.pieSliceTextStyle = {fontSize:11};

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-06T03:04:23.193

您可以使用以下代码增加图表标题的字体大小：

```
chts=FF0000,20,r 
```

（chdls 用于图例大小，仅颜色）

# visual-studio-2010 - U2NETDK VisualStudio 2010 插件

> ID：12093571
> 
> 赞同：0
> 
> 时间：2012-08-23T14:09:07.660
> 
> 标签：visual-studio-2010, universe, u2netdk

Rocket U2 .NET Database Provider (Universe) 是否有任何 Visual Studio 2010 插件可用？我知道有一个 2008 年的工具，但我无法让这个新的 U2 .NET 工具包正常工作并生成 ERM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:01:54.487

还有一件事，我想补充一点，您不再需要“UniObjects for .NET”，因为此功能已添加到“U2 Toolkit for .NET”产品中。我们在安装中有演示“UniObjects for .NET”功能的示例代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T08:59:04.283

你的第一个问题的答案是：是的。

.NET Toolkit 和 UniObjects for .NET 都应该与 VS 2010 无缝协作。

您可以从[Rocket U2](http://www.rocketsoftware.com/u2)网站的“资源/下载”下下载必要的软件

您还可以使用 UniObjects for .NET，它可以在 Rocket 网站上的“u2-Clients”下载中获得。这是一个 DLL，您可以将其作为参考添加到您的 Visual Studio 项目中，并可以与您的 UniVerse 数据库和数据进行交互。有关如何使用这两种产品的文档也可以在此处下载。

如果这没有帮助，请提出一个更具体的问题，说明您收到的确切错误消息，以及您正在使用的 .NET 框架版本以及 UniVerse 平台和版本的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:07:23.447

我想通知您，U2NETDK V 1.2.0 将有一个名为 U2 Database Add-ins for Visual Studio 的新产品。它将允许您集成服务器资源管理器，从而简化 .NET 中的 U2 数据访问。您将在服务器资源管理器中看到 U2 表、视图和子例程，您可以在数据集设计器/实体数据模型设计器等设计器中拖放。我们很快就会去 EAP。

# php - 使用 SimpleXMLElement 访问数组时出现奇怪的行为

> ID：12093572
> 
> 赞同：2
> 
> 时间：2012-08-23T14:09:08.993
> 
> 标签：php, iterator, simplexml

我正在解析 Webserivce 响应，但我的行为很奇怪，

[这是返回给我 WS](http://pastie.org/private/18wq4kezadyfsuroy3x9og)的一个小例子

输出完成`var_dump($results);`

但是如果我这样做`var_dump($results->channel->item);` **而不是有一个包含 9 个元素的数组**，[我有这个](http://pastie.org/private/1kzcjtquoomimu0rboruw)似乎是数组的 1 个元素。

那是什么行为？谢谢。

PS：我在 PHP 5.4.6 和 Xdebug 2.2.1 上运行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:29:40.973

这是完全正常的。`$results->channel->item`是一个迭代器，它意味着在`foreach`循环中使用。这将为您提供所有`item`元素：

```
foreach ($xml->channel->item as $item) {
    var_dump($item);
} 
```

# jquery - MVC 3 从 JSon 获取列表

> ID：12093577
> 
> 赞同：0
> 
> 时间：2012-08-23T14:09:17.003
> 
> 标签：jquery, json, asp.net-mvc-3

我通过 JSON 向控制器发送表单值。我在控制器处获得所有值。但是当我发送列表时，列表项始终为空。我不知道问题是什么。这是我的视图模型：

```
public class PromotionLineViewModel
{
    public string PromotionID { get; set; }
    public ConditionList[] ConditionList { get; set; }
    public string ItemUsageType { get; set; }
    public string PriceCalculationType { get; set; }
    public string PromotionDiscount { get; set; }
    public string LimitCheck { get; set; }
    public string MinQuantity { get; set; }
    public string MinAmount { get; set; }
    public string MaxQuantity { get; set; }
    public string MaxAmount { get; set; }
    public string IsActionActive { get; set; }
    public string ActionQuantity { get; set; }
    public string ActionFixed { get; set; }
    public string BundleGroupNr { get; set; }
    public string PalletQuantity { get; set; }
    public string ProductUsageMultiplier { get; set; }
    public string MaxCapAmount { get; set; }
}

[Serializable]
public class ConditionList
{
    public string check { get; set; }
    public string isExclude { get; set; }
    public string value { get; set; }
} 
```

这是我的jQuery代码：

```
function dataPost(url) {
var formData = form2object('prm-form', '.', true);
$.ajax({
    type: 'POST',
    url: url,
    data: formData,
    contentType: "application/json; charset=utf-8",
    traditional: true,
    success: function (data) {
        alert("done");
    }
});

//$.post(url, formData,"json");
//   document.getElementById('testArea').innerHTML = JSON.stringify(formData, null, '\t');  
//} 
```

这就是我得到的：

[控制器图像](http://img696.imageshack.us/img696/1784/adszbpd.png)

我已经检查了 json 值。他们都来对了。我需要在控制器处获取列表项值。这是我的 json 格式：

```
{
"PromotionID": "000004",
"ConditionList": [
    {
        "check": "12",
        "isExclude": "0",
        "value": "2334"
    },
    {
        "check": "13",
        "isExclude": "1"
    }
],
"ItemUsageType": "1",
"PriceCalculationType": "1",
"PromotionDiscount": "234",
"LimitCheck": "0",
"MinQuantity": "2",
"MinAmount": "2",
"MaxQuantity": "2",
"MaxAmount": "2",
"IsActionActive": "action",
"ActionQuantity": "2",
"ActionFixed": "fix",
"BundleGroupNr": "2",
"PalletQuantity": "2",
"ProductUsageMultiplier": "2",
"MaxCapAmount": "2"
} 
```

控制器动作：

```
[HttpPost]
    public ActionResult JsonResult(PromotionLineViewModel promotionLineViewModel)
    {
        ...
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:29:54.137

尝试使用这个：

```
public List<ConditionList> ConditionList { get; set; } 
```

代替

```
public ConditionList[] ConditionList { get; set; } 
```

如下所示：

```
public class PromotionLineViewModel
{
    public string PromotionID { get; set; }
    public List<ConditionList> ConditionList { get; set; }
    public string ItemUsageType { get; set; }
    public string PriceCalculationType { get; set; }
    public string PromotionDiscount { get; set; }
    public string LimitCheck { get; set; }
    public string MinQuantity { get; set; }
    public string MinAmount { get; set; }
    public string MaxQuantity { get; set; }
    public string MaxAmount { get; set; }
    public string IsActionActive { get; set; }
    public string ActionQuantity { get; set; }
    public string ActionFixed { get; set; }
    public string BundleGroupNr { get; set; }
    public string PalletQuantity { get; set; }
    public string ProductUsageMultiplier { get; set; }
    public string MaxCapAmount { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:44:28.093

尝试[`.serialize()`](http://api.jquery.com/serialize/)直接使用该方法。因此，如果我们假设您有一个包含以下内容的表单`id="prm-form"`：

```
function dataPost(url) {
    $.ajax({
        type: 'POST',
        url: url,
        data: $('#prm-form').serialize(),
        success: function (data) {
            alert("done");
        }
    });
} 
```

在这种情况下，您不需要发送 JSON。这比那更容易。

# java - 可视化 2 个 BufferedImages 的差异

> ID：12093584
> 
> 赞同：0
> 
> 时间：2012-08-23T14:09:29.520
> 
> 标签：java, for-loop, comparison, bufferedimage, graphics2d

我制作了一个函数，通过制作一个新图像来直观地比较 2 个 BufferedImage 的差异，其中第一个图像的每个像素都循环通过，当一个像素等于第二个像素时，在新图像中绘制一个像素。

起初这似乎有效，但是在对该功能进行了一些测试后，我注意到了一些让我现在认为它可能不正确的东西。当我为 img1 输入带有水平渐变条的图像时，对于 img2 输入相同但垂直偏移的图像时，它完全为第一张图像的渐变绘制了蒙版。但是我认为它不应该这样做，因为这些像素不应该匹配。

因此，例如，如果我输入 2 个 BufferedImage，如下所示：

```
@@@@@@@@    @@@@@@@@
@@@@@@@@    --------
---@---@    ---@---@
@@@----@    @@-----@ 
```

它可能会像这样输出一个掩码/BufferedImage：

```
@@@@@@@@
@@@@@@@@
-------@
@@@----@ 
```

但是我希望它会输出这样的东西：

```
@@@@@@@@
--------
---@---@
@@-----@ 
```

当我看它时，我看不出我哪里出错了，但似乎某处有问题。有谁知道我的功能做错了什么？

```
public BufferedImage MatchBIMask(BufferedImage img1, BufferedImage img2, Color background, Color match){
    int w = img1.getWidth();
    int h = img1.getHeight();
    BufferedImage img = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g = img.createGraphics();
    g.setColor(background);
    g.fillRect(0, 0, w, h);
    g.setColor(match);

    for (int row=0; row < h; row++){
        for (int col=0; col < w; col++){
            int rgb1 = img1.getRGB(col, row);
            int rgb2 = img2.getRGB(col, row);
            if (rgb1 == rgb2) {
                // Match code here
                g.drawRect(col, row, 0, 0); // Draw pixel
            } 
        }
    }

    return img;
} 
```

编辑：

我获得我比较的 2 个 BufferedImages 的方式是使用以下代码：

```
BufferedImage img = robot.createScreenCapture(new Rectangle(x, y, w, h)); // Rectangle Area 
```

我不知道该代码是否考虑了 alpha。

# javascript - 如何在不支持 HTML 字符的邮件正文中发送 % 符号？

> ID：12093586
> 
> 赞同：-3
> 
> 时间：2012-08-23T14:09:35.080
> 
> 标签：javascript, html, cordova, sendmail

我真的坚持这一点。

我想做的是发送纯文本邮件。但现在我需要在邮件中发送 %(sign) 但它总是发送垃圾字符。我已经尝试将其转换为“%25”（十六进制代码），但仍然没有运气。

它非常紧急。请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:13:00.383

您将 % 字符转义为

```
&#37; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:14:43.480

如果你真的坚持在它周围包装一个函数

```
String.fromCharCode(37) 
```

使用 Simons 会更整洁。

# asp.net-mvc-3 - 如何使用 dotnet highcharts dll 在 MVC3 中显示 HighCharts？

> ID：12093593
> 
> 赞同：5
> 
> 时间：2012-08-23T14:09:47.327
> 
> 标签：asp.net-mvc-3, highcharts, pie-chart

我正在尝试一种将数据绑定到饼图的方法

```
 Public ActionResult Charts
  {
      Highcharts chart = new Highcharts("chart")
        .InitChart(new Chart { PlotShadow = false })
        .SetTitle(new Title { Text = "Browser market shares at a specific website, 2010" })
        .SetTooltip(new Tooltip { Formatter = "function() { return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %'; }" })
        .SetPlotOptions(new PlotOptions
        {
            Pie = new PlotOptionsPie
            {
                AllowPointSelect = true,
                Cursor = Cursors.Pointer,
                DataLabels = new PlotOptionsPieDataLabels
                {
                    Color = ColorTranslator.FromHtml("#000000"),
                    ConnectorColor = ColorTranslator.FromHtml("#000000"),
                    Formatter = "function() { return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %'; }"
                }
            }
        })
        .SetSeries(new Series
        {
            Type = ChartTypes.Pie,
            Name = "Browser share",
            Data = new Data(new object[]
                                   {
                                       new object[] { "Firefox", 45.0 },
                                       new object[] { "IE", 26.8 },
                                       new DotNet.Highcharts.Options.Point
                                       {
                                           Name = "Chrome",
                                           Y = 12.8,
                                           Sliced = true,
                                           Selected = true
                                       },
                                       new object[] { "Safari", 8.5 },
                                       new object[] { "Opera", 6.2 },
                                       new object[] { "Others", 0.7 }
                                   })
                             });
        }
    }

    public JsonResult GetData()
    {
        int Param1;
        Param1 = 1;     
        var reports = db.ExecuteStoreQuery<ResourceReports>("ResourceReports @EmployeeID", new SqlParameter("@EmployeeID", Param1)).ToList();
        return Json(reports, JsonRequestBehavior.AllowGet);
    } 
```

我想更换

```
 .SetSeries(new Series
    {
        Type = ChartTypes.Pie,
        Name = "Browser share",
        Data = new Data(new object[]
                                   {
                                       new object[] { "Firefox", 45.0 },
                                       new object[] { "IE", 26.8 },
                                       new DotNet.Highcharts.Options.Point
                                       {
                                           Name = "Chrome",
                                           Y = 12.8,
                                           Sliced = true,
                                           Selected = true
                                       },
                                       new object[] { "Safari", 8.5 },
                                       new object[] { "Opera", 6.2 },
                                       new object[] { "Others", 0.7 }
                                   })
        });
    } 
```

我`GetData()`该怎么做，数据`.SetSeries`应该是我返回的数据`GetData method`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:45:24.187

看来您正在使用 Dotnet.Highcharts。您可以创建一个列表`Series`和一个`Point`.

```
List<Series> mySeries = new List<Series>();
List<Point> myPoints = new List<Point>(); 
```

我将遍历您需要创建和生成点数据的每个系列，如下所示：

```
myPoints.Add(new Point {
    X = (detailRec.RecordTime - new DateTime(1970, 1, 1, 0, 0, 0)).TotalMilliseconds,
    Y = detailRec.TotalCount
}); 
```

然后，您可以使用其数据的点列表来创建系列本身，如下所示：

```
mySeries.Add(new Series{
  Name = distinctDistrict.Name,
  Data = new Data(myPoints.ToArray())
}); 
```

然后要设置系列，您可以使用以下语句：

```
.SetSeries(mySeries.Select(s => new Series { 
  Name = s.Name, 
  Data = s.Data 
}).ToArray()) 
```

如果在 Visual Studio 中使用对象浏览器，可以看到`Series`和`Point`类的其他属性和方法。要使用上述代码，您必须包含以下 using 语句：

```
using DotNet.Highcharts;
using DotNet.Highcharts.Enums;
using DotNet.Highcharts.Helpers;
using DotNet.Highcharts.Options;
using Point = DotNet.Highcharts.Options.Point; 
```

# python - 如何使用 Scipy.signal.butter 实现带通巴特沃斯滤波器

> ID：12093594
> 
> 赞同：94
> 
> 时间：2012-08-23T14:09:52.443
> 
> 标签：python, scipy, signal-processing, digital-filter

更新：

我发现了一个基于这个问题的 Scipy 食谱！因此，对于任何感兴趣的人，请直接访问：[目录 » 信号处理 » Butterworth Bandpass](http://scipy-cookbook.readthedocs.io/items/ButterworthBandpass.html)

* * *

我很难实现最初看起来很简单的任务，即为一维 numpy 数组（时间序列）实现巴特沃斯带通滤波器。

我必须包含的参数是 sample_rate、以赫兹为单位的截止频率和可能的顺序（其他参数，如衰减、自然频率等对我来说更模糊，所以任何“默认”值都可以）。

我现在拥有的是这个，它似乎可以用作高通滤波​​器，但我不确定我是否做得对：

```
def butter_highpass(interval, sampling_rate, cutoff, order=5):
    nyq = sampling_rate * 0.5

    stopfreq = float(cutoff)
    cornerfreq = 0.4 * stopfreq  # (?)

    ws = cornerfreq/nyq
    wp = stopfreq/nyq

    # for bandpass:
    # wp = [0.2, 0.5], ws = [0.1, 0.6]

    N, wn = scipy.signal.buttord(wp, ws, 3, 16)   # (?)

    # for hardcoded order:
    # N = order

    b, a = scipy.signal.butter(N, wn, btype='high')   # should 'high' be here for bandpass?
    sf = scipy.signal.lfilter(b, a, interval)
    return sf 
```

![在此处输入图像描述](../Images/be8dfbf387fb19947e1313ea90d8043c.png)

文档和示例令人困惑且晦涩难懂，但我想实现标为“用于带通”的推荐中呈现的表格。评论中的问号显示我只是复制粘贴了一些示例而不了解发生了什么。

我不是电气工程师或科学家，只是需要对 EMG 信号执行一些相当简单的带通滤波的医疗设备设计师。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-09-02T06:41:24.197

您可以跳过使用 buttord，而只需为过滤器选择一个顺序，看看它是否符合您的过滤条件。要为带通滤波器生成滤波器系数，请给 butter() 滤波器阶数、截止频率`Wn=[low, high]`（表示为奈奎斯特频率的分数，即采样频率的一半）和波段类型`btype="band"`。

这是一个脚本，它定义了几个使用 Butterworth 带通滤波器的便利函数。当作为脚本运行时，它会生成两个图。一张显示了相同采样率和截止频率下几个滤波器阶数的频率响应。另一个图展示了过滤器（order=6）对样本时间序列的影响。

```
from scipy.signal import butter, lfilter

def butter_bandpass(lowcut, highcut, fs, order=5):
    nyq = 0.5 * fs
    low = lowcut / nyq
    high = highcut / nyq
    b, a = butter(order, [low, high], btype='band')
    return b, a

def butter_bandpass_filter(data, lowcut, highcut, fs, order=5):
    b, a = butter_bandpass(lowcut, highcut, fs, order=order)
    y = lfilter(b, a, data)
    return y

if __name__ == "__main__":
    import numpy as np
    import matplotlib.pyplot as plt
    from scipy.signal import freqz

    # Sample rate and desired cutoff frequencies (in Hz).
    fs = 5000.0
    lowcut = 500.0
    highcut = 1250.0

    # Plot the frequency response for a few different orders.
    plt.figure(1)
    plt.clf()
    for order in [3, 6, 9]:
        b, a = butter_bandpass(lowcut, highcut, fs, order=order)
        w, h = freqz(b, a, worN=2000)
        plt.plot((fs * 0.5 / np.pi) * w, abs(h), label="order = %d" % order)

    plt.plot([0, 0.5 * fs], [np.sqrt(0.5), np.sqrt(0.5)],
             '--', label='sqrt(0.5)')
    plt.xlabel('Frequency (Hz)')
    plt.ylabel('Gain')
    plt.grid(True)
    plt.legend(loc='best')

    # Filter a noisy signal.
    T = 0.05
    nsamples = T * fs
    t = np.linspace(0, T, nsamples, endpoint=False)
    a = 0.02
    f0 = 600.0
    x = 0.1 * np.sin(2 * np.pi * 1.2 * np.sqrt(t))
    x += 0.01 * np.cos(2 * np.pi * 312 * t + 0.1)
    x += a * np.cos(2 * np.pi * f0 * t + .11)
    x += 0.03 * np.cos(2 * np.pi * 2000 * t)
    plt.figure(2)
    plt.clf()
    plt.plot(t, x, label='Noisy signal')

    y = butter_bandpass_filter(x, lowcut, highcut, fs, order=6)
    plt.plot(t, y, label='Filtered signal (%g Hz)' % f0)
    plt.xlabel('time (seconds)')
    plt.hlines([-a, a], 0, T, linestyles='--')
    plt.grid(True)
    plt.axis('tight')
    plt.legend(loc='upper left')

    plt.show() 
```

以下是此脚本生成的图：

![几个滤波器阶数的频率响应](../Images/96f0c03c9344f3b26777000ba01290f6.png)

![在此处输入图像描述](../Images/4c31b494d609fdc7335f3e7fd8117224.png)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2018-02-08T04:01:15.833

[公认答案](https://stackoverflow.com/a/12233959/1729501)中的滤波器设计方法是正确的，但它有一个缺陷。使用 b, a 设计的 SciPy 带通滤波器[不稳定](https://stackoverflow.com/questions/21862777/bandpass-butterworth-filter-frequencies-in-scipy)，可能会导致**[更高滤波器阶数](https://dsp.stackexchange.com/questions/17235/filtfilt-giving-unexpected-results)**的[错误滤波器](https://stackoverflow.com/questions/41371915/20hz-20000hz-butterworth-filtering-exploding)。

相反，使用滤波器设计的 sos（二阶部分）输出。

```
from scipy.signal import butter, sosfilt, sosfreqz

def butter_bandpass(lowcut, highcut, fs, order=5):
        nyq = 0.5 * fs
        low = lowcut / nyq
        high = highcut / nyq
        sos = butter(order, [low, high], analog=False, btype='band', output='sos')
        return sos

def butter_bandpass_filter(data, lowcut, highcut, fs, order=5):
        sos = butter_bandpass(lowcut, highcut, fs, order=order)
        y = sosfilt(sos, data)
        return y 
```

此外，您可以通过更改来绘制频率响应

```
b, a = butter_bandpass(lowcut, highcut, fs, order=order)
w, h = freqz(b, a, worN=2000) 
```

到

```
sos = butter_bandpass(lowcut, highcut, fs, order=order)
w, h = sosfreqz(sos, worN=2000) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T15:26:15.697

对于带通滤波器，ws 是一个包含上下角频率的元组。这些代表滤波器响应比通带小 3 dB 的数字频率。

wp 是一个包含阻带数字频率的元组。它们代表最大衰减开始的位置。

gpass 是通带中的最大衰减，以 dB 为单位，而 gstop 是阻带中的衰减。

例如，您想设计一个采样率为 8000 个样本/秒的滤波器，其转角频率为 300 和 3100 Hz。奈奎斯特频率是采样率除以二，在本例中为 4000 Hz。等效数字频率为 1.0。两个拐角频率则为 300/4000 和 3100/4000。

现在假设您希望阻带从拐角频率下降 30 dB +/- 100 Hz。因此，您的阻带将从 200 和 3200 Hz 开始，从而产生 200/4000 和 3200/4000 的数字频率。

要创建过滤器，您可以将 buttord 称为

```
fs = 8000.0
fso2 = fs/2
N,wn = scipy.signal.buttord(ws=[300/fso2,3100/fso2], wp=[200/fs02,3200/fs02],
   gpass=0.0, gstop=30.0) 
```

所得滤波器的长度将取决于阻带的深度和响应曲线的陡度，响应曲线由拐角频率和阻带频率之间的差异决定。

# c# - Resharper 数据流分析

> ID：12093596
> 
> 赞同：0
> 
> 时间：2012-08-23T14:09:58.720
> 
> 标签：c#, resharper, dataflow

我广泛使用 TPL Dataflow 库，并且非常喜欢 R# 的 Used-By 功能。最好查看作为 ITargetBlock 目标的方法的使用 by（最有可能是操作块），并返回除任何直接方法调用之外的 ITargetBlock.Post 调用列表。同样，当您控制 ITargetBlock.Post 上的单击（转到声明）时，它应该将您直接带到操作块的目标方法，而不是 ITargetBlock 的定义。

```
ActionBlock<T> ab = new ActionBlock<T>(FuncCall, new ExecutionDataflowBlockOptions {TaskScheduler = taskScheduler}); 
```

设置动作块

```
ab.Post(NewVal); 
```

向操作块发布一个新值，然后将其传递给 FuncCall 方法 - 控制单击 ab / ab.Post 应该会将您带到下面的方法。

```
private void FuncCall(T parameter)
{
    //Do work
} 
```

在上述方法上调用 find 用法应该将您带到 ab.Post(NewVal)，而不是 ab 定义。

我想知道是否有任何方法可以使用 resharper 进行配置。我想通过编写自定义插件是可行的，但我认为其他人可能会遇到这个问题，并想看看是否有一种简单的方法可以首先实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:34:56.013

您需要编写一个自定义插件，因为每种包装器使用的信息都不同；`Action`, `Func`, `ActionBlock`, 等等...

这可能是一种方便（这是 R# 的大部分内容），但它只会为您节省一次击键。

在您的示例中， F12`ab`到 GoToImplementation 然后 Ctrl+单击`FuncCall`

# c# - 每次使用时检查属性是否为空？

> ID：12093599
> 
> 赞同：4
> 
> 时间：2012-08-23T14:10:08.360
> 
> 标签：c#, .net, code-standards

我有一个简单的问题，想看看在制作自己的课程时最佳做法是什么。

假设这个类有一个在构造函数中初始化的私有成员，然后我是否必须检查这个私有成员在另一个公共的非静态方法中是否为空？或者假设变量不会为空，因此不必添加该检查是否可以保存？

例如，像下面这样，检查 null 是绝对必要的。

```
// Provides Client connections.
public TcpClient tcpSocket;

/// <summary>
/// Creates a telnet connection to the host and port provided.
/// </summary>
/// <param name="Hostname">The host to connect to. Generally, Localhost to connect to the Network API on the server itself.</param>
/// <param name="Port">Generally 23, for Telnet Connections.</param>
public TelnetConnection(string Hostname, int Port)
{
        tcpSocket = new TcpClient(Hostname, Port);
}

/// <summary>
/// Closes the socket and disposes of the TcpClient.
/// </summary>
public void CloseSocket()
{
    if (tcpSocket != null)
    {
        tcpSocket.Close();
    }  
} 
```

因此，我根据您的所有答案进行了一些更改，我想知道这是否会更好：

```
private readonly TcpClient tcpSocket;

public TcpClient TcpSocket
{
    get { return tcpSocket; }
}

int TimeOutMs = 100;

/// <summary>
/// Creates a telnet connection to the host and port provided.
/// </summary>
/// <param name="Hostname">The host to connect to. Generally, Localhost to connect to the Network API on the server itself.</param>
/// <param name="Port">TODO Generally 23, for Telnet Connections.</param>
public TelnetConnection(string Hostname, int Port)
{
        tcpSocket = new TcpClient(Hostname, Port);
}

/// <summary>
/// Closes the socket and disposes of the TcpClient.
/// </summary>
public void CloseSocket()
{
    if (tcpSocket != null)
    {
        tcpSocket.Close();
    }  
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T14:14:57.583

您已将该属性公开，因此任何使用此类的代码都可以将引用设置为 null，从而导致对其进行的任何操作都会引发 NullReferenceException。

如果您希望您班级的用户能够忍受（这是可以辩护的）：不，您不必检查 null。

您也可以将属性设为 like `public TcpClient tcpSocket { get; private set; }`，因此外部代码无法将其设置为 null。如果你没有*在*`tcpSocket`你的类中设置为 null ，它永远不会为 null，因为构造函数总是会被调用。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:44:03.550

我不明白为什么你在ctor中打开一个连接然后有公共方法来关闭它。如果您要在 ctor 中创建连接，那么这通常意味着它是您在课程生命周期中想要的连接。

如果您询问如何确保在释放类时关闭连接，请实现 IDisposable。

[IDisposable 接口](http://msdn.microsoft.com/en-us/library/System.IDisposable.aspx)

由于它是私有的，它不应该为空，但您应该检查是否已连接。

```
 if (tcpSocket.Connected)
   {
       tcpSocket.Close();
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:20:29.070

通常，如果您可以*确保字段不为 null* ，则它是安全的。你可以称它为类不变量。但是，在您的代码中，`tcpSocket`它不是私有的，因此任何人都可以将其值设置为`null`.

我建议您使用私有设置器将该字段设为属性（除非您可以将其设为完全私有）。这可以确保没有外部（即无法控制！）代码修改引用。这反过来又使你能够保证`tcpSocket`不是`null`。*

# maven-3 - 如何将我的项目依赖项复制到 Maven 中的远程服务器？

> ID：12093600
> 
> 赞同：1
> 
> 时间：2012-08-23T14:10:21.267
> 
> 标签：maven-3, remote-server, maven-dependency-plugin

如何将所有依赖项复制到远程服务器？我已经尝试过以下一种，但如果我们想将依赖项复制到本地路径，它会很有用。

这是否可以将我所有的项目依赖项移动到远程路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:06:45.737

[wagon-maven-plugin](http://mojo.codehaus.org/wagon-maven-plugin/)允许您这样做。它支持 HTTP、FTP、SSH/SCP 和 WebDAV。要上传所有依赖项，您首先需要将它们复制到具有[maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html)的目录（目标[复制依赖项](http://maven.apache.org/plugins/maven-dependency-plugin/)）。在第二步中，您可以使用 wagon 插件的上传目标将它们复制到您的远程位置。

# c# - 为什么设置 WebOperationContext.Current.OutgoingResponse.StatusCode = HttpStatusCode.Redirect 会导致 SecurityException？

> ID：12093610
> 
> 赞同：1
> 
> 时间：2012-08-23T14:10:53.633
> 
> 标签：c#, rest, exception-handling, http-status-code-301, securityexception

我正在使用 .Net 4 中的 Rest 服务，我需要执行重定向。

对我正在做的事情的一点描述：我有一个包含按钮的 silverlight 应用程序。当我单击该按钮时，我会向我的 REST 服务发送一个带有一些信息的 POST 请求。根据这些信息，我创建了一个 URL 并（尝试）重定向浏览器。这是服务中方法的代码：

```
[WebInvoke(Method = "POST", UriTemplate = "OpenBinder")]
public void OpenBinder(int someId)
{
    string url = getUrl(someId);
    if (WebOperationContext.Current != null)
    {
        WebOperationContext.Current.OutgoingResponse.Location = url;
        WebOperationContext.Current.OutgoingResponse.StatusCode = HttpStatusCode.Redirect;
    }
} 
```

这似乎正确执行，但是当我在客户端上调用 EndGetResponse 时，我看到发生了“安全错误”。这是 System.Security.SecurityException，但我没有得到比这更多的细节。关于这里可能发生什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:22:18.187

如果没有更多信息，我不确定您的具体安全错误是什么，但通常在这种情况下，您的重定向应该发生在响应处理程序的客户端。您可以重组代码以使客户端重定向吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T13:59:18.567

好的，所以我的代码实际上工作正常。当我查看 Fiddler 时，我注意到它正在向 Url 发出正确的请求。问题是 clientacesspolicy.xml 正在阻止它。

# c# - 如何使用 marshal.Copy 函数将数据读入内存？

> ID：12093613
> 
> 赞同：0
> 
> 时间：2012-08-23T14:11:01.653
> 
> 标签：c#, delphi, memory, pointers, encryption

我正在尝试将我在 Delphi 中的解密函数移植到 C#。在 delphi 中，我使用函数 Move 使用指针将数据放入内存中，因此我尝试使用 marshal.copy 函数获得相同的结果，但有时我会遇到访问冲突异常，有时还会出现空格。附上函数的代码。有任何想法吗？非常感谢！

```
 public string prDecode(string s)
    {
        byte[] ArrayMap = new byte[256] {0,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  
                                         0, 0, 0, 62, 0, 0, 0, 63, 52, 53, 54, 55, 56, 57, 58, 59,60,
                                         61, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,  3, 4, 5, 6, 7, 8, 9, 10, 
                                         11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 
                                         0, 0, 0, 0, 0, 0, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 
                                         36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
                                         51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}; 
        int I;
        char[] ArrayS = s.ToCharArray(0, s.Length);
        string resultado = "";
        char[] ArrayR = resultado.ToCharArray(0, resultado.Length);
        switch (s.Length)
        {
            case 2: 
                I = ArrayMap[ArrayS[0]] + (ArrayMap[ArrayS[1]] << 6);
                ArrayR = new char[1];
                Marshal.Copy((IntPtr)I, ArrayR, 0, ArrayR.Length);

                break;
            case 3:
                I = ArrayMap[ArrayS[0]] + (ArrayMap[ArrayS[1]] << 6) + 
                    (ArrayMap[ArrayS[2]] << 12);
                ArrayR = new char[2];
                Marshal.Copy((IntPtr)I, ArrayR, 0, ArrayR.Length);
                break;

            case 4:
                I = ArrayMap[ArrayS[0]] + (ArrayMap[ArrayS[1]] << 6) + 
                    (ArrayMap[ArrayS[2]] << 12) + (ArrayMap[ArrayS[3]] << 18);
                ArrayR = new char[3];
                Marshal.Copy((IntPtr)I, ArrayR, 0, ArrayR.Length);
                break;
        }
        string clave = new string (ArrayR);
        return clave;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:21:10.810

I think the function you're looking for is [Array.Copy](http://msdn.microsoft.com/en-us/library/z50k9bft) or [Buffer.BlockCopy](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx) rather than Marshal.Copy. Marshal.Copy is for copying data to and from unmanaged memory.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:20:26.777

除非您为遗留代码访问非托管内存，否则无需使用 Marshal。托管代码不需要指针，使用托管方法会更快。

我认为您正在寻找的是使用托管代码在数组之间复制的 Array.Copy。

# c# - WPF中标签上的类似滚动条的动画

> ID：12093614
> 
> 赞同：2
> 
> 时间：2012-08-23T14:11:08.887
> 
> 标签：c#, wpf

我有一个简单的应用程序，在单击按钮后，标签的值每秒更新一次。我将其作为我想要开发的进度条控件的 POC。

我想知道是否有一种方法可以将某种滚动动画应用于标签，它将：

1）当标签的内容更新时，它将从顶部滚动新值，旧值将向下滚动并从视图中消失（希望这有意义）。

我知道这可能可以通过某种动画来实现，但是如果有人知道如何做到这一点，我在网上找不到任何有用的示例，请分享您的专业知识：

**看法：**

```
<Window x:Class="WpfApplication1.ScrollerView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Scroller" DataContext="{StaticResource scrollerVM}" Height="150" Width="300">
    <Grid>
        <ListBox ItemsSource="{Binding Messages}" Width="200" Height="50" BorderThickness="0" VerticalAlignment="Top" HorizontalAlignment="Left">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Label Content="{Binding Text}"  />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ListBox>
        <Button Width="70" Height="24" Content="Add new" Command="{Binding AddNew}" HorizontalAlignment="Left" Margin="0,56,0,30" />
    </Grid>
</Window> 
```

**查看型号：**

```
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows.Threading;

namespace WpfApplication1.Scroller
{
    public class Message
    {
        public Message(string _text)
        {
            text = _text;
        }

        private string text;
        public string Text
        {
            get { return text; }
            set {text = value;}
        }
    }

    public class ScrollerViewModel : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;
        public DelegateCommand AddNew { get; protected set; }

        ObservableCollection<Message> _messages = new ObservableCollection<Message>();
        public ObservableCollection<Message> Messages
        {
            get { return _messages; }
            set
            {
                _messages = value;
                OnPropertyChanged("Messages");
            }
        }

        public ScrollerViewModel()
        {
            AddNew = new DelegateCommand(Add);
        }

        private void Add(object parameter)
        {
            DispatcherTimer timer = new DispatcherTimer();
            timer.Tick += new System.EventHandler(timer_Tick);
            timer.Interval = new System.TimeSpan(0, 0, 1);
            timer.Start();
        }

        private void timer_Tick(object sender, EventArgs e)
        {
            Messages.Clear();
            Messages.Add(new Message(DateTime.Now.ToString("ss")));
        }

        protected void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:47:36.387

首先，您需要在 ListBox 上“平滑滚动”：

```
ScrollViewer.CanContentScroll="False" 
```

然后，您可以创建自定义[附加属性](http://msdn.microsoft.com/en-us/library/ms749011.aspx)来指定要滚动的垂直偏移量。然后创建一个与 ListBox 的 ItemsSource 的“ItemsSourceChanged”事件挂钩的自定义行为，该事件将触发您可以在行为内部定义的动画。这至少应该是一个开始。我不确定具体的动画是什么......一些 DoubleAnimation 使用您的偏移量加上新项目的高度的计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:15:58.740

更全面/不同的例子[在这里。](http://www.codeproject.com/Articles/48267/Making-a-Simple-Marquee-Text-Control-Drip-Animatio)

以下将产生一个基本的垂直选取框（滚动文本块）。

XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Loaded="Window_Loaded">
    <Canvas  Name="canvas1" >
        <TextBlock  Name="textBlock1">Hello</TextBlock>
    </Canvas>
</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void BeginAnimation()
    {
        DoubleAnimation doubleAnimation = new DoubleAnimation();
        doubleAnimation.From = -textBlock1.ActualHeight;
        doubleAnimation.To = canvas1.ActualHeight;
        doubleAnimation.RepeatBehavior = RepeatBehavior.Forever;
        doubleAnimation.Duration = new Duration(TimeSpan.FromSeconds(3));
        textBlock1.BeginAnimation(Canvas.TopProperty, doubleAnimation);
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        BeginAnimation();
    }
} 
```

# javascript - JS parseInt() 问题

> ID：12093615
> 
> 赞同：1
> 
> 时间：2012-08-23T14:11:13.603
> 
> 标签：javascript, jquery

我知道我可能做错了什么。谁能指出为什么我会成为对象？

```
$(document).ready(function(){
    topwithpx='0px';
    alert(topwithpx);
    topstr=topwithpx.substr(0,topwithpx.length-2);
    alert(topstr);
    top=parseInt(topstr);
    alert(top);
});​ 
```

[http://jsfiddle.net/kjMs9/](http://jsfiddle.net/kjMs9/)

谢谢大家：'top' 是保留关键字（Window.top）。我的错。接受第一个答案。+1 快速回答。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T14:13:25.843

因为它本质`window.top`上是[Window 对象](https://developer.mozilla.org/en-US/docs/DOM/window.top)。改为使用`var top`以防止将局部变量与全局（=`window`对象的属性）混合。

事实上，让`var`你的函数变量成为一个常见的例程 - 以防止将来出现类似的陷阱。)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T14:14:02.433

您不需要使用`substr`删除`px`. `parseInt`将为您执行此操作：

```
topwithpx='0px';
var top = parseInt(topwithpx);
alert(top);  //alerts "0" 
```

[http://jsfiddle.net/kjMs9/3/](http://jsfiddle.net/kjMs9/3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T14:13:45.663

`window.top`是 DOM 0 的一部分，不能分配数字。

避免使用全局变量。范围他们`var`

```
$(document).ready(function(){
    var topwithpx, topstr, top;
    topwithpx='0px';
    alert(topwithpx);
    topstr=topwithpx.substr(0,topwithpx.length-2);
    alert(topstr);
    top=parseInt(topstr);
    alert(top);
});​ 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-23T14:13:51.873

`top`是`window`对象 ( [MDN](https://developer.mozilla.org/en-US/docs/DOM/window.top) ) 的默认属性。将您的变量命名为其他名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T14:14:11.397

`top`是 的只读属性`window`（[至少对于 Mozilla](https://developer.mozilla.org/en-US/docs/DOM/window.top)来说，但也可能是所有其他大型浏览器）。

只需更改`top`为其他类似`topInt`. 此外，用于`var`声明变量（例如`var topInt = parseInt(...)`。如果您不使用`var`，则`window`默认使用该属性，因此是只读行为。

顺便说一句，使用它会更好一些，`console.log`而不是`alert`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-23T14:15:11.037

`top`是一个`javascript window`属性。您可以通过执行此操作将 top 作为变量

```
var top = ... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-23T14:18:14.250

```
$(document).ready(function(){
    topwithpx='0px';
    alert(topwithpx);
    topstr=topwithpx.substr(0,topwithpx.length-2);
    alert(topstr);
   var top=parseInt(topstr);
    alert(top);
}); 
```

你错过了变量的声明

# python - 无法使用 python 从 FTP 下载文件。[Errno 10054] 现有连接被远程主机强行关闭

> ID：12093621
> 
> 赞同：0
> 
> 时间：2012-08-23T14:11:23.287
> 
> 标签：python, ftp, errno, ftplib

我正在尝试使用 python 2.7 从 FTP 下载文件。在 Windows XP 上

我能够连接 FTP 但出现以下错误

[Errno 10054] 现有连接被远程主机强行关闭

下面是我的代码。

```
import os
from time import strftime
from ftplib import FTP

import smtplib
from email.MIMEMultipart import MIMEMultipart
from email.MIMEBase import MIMEBase
from email.MIMEText import MIMEText
from email import Encoders

def ftp_connect(path):
    link = FTP(host = 'myservername', timeout = 5) #Keep low timeout
    link.login(passwd = 'mypassword', user = 'myusername')
    debug("%s - Connected to FTP" % strftime("%d-%m-%Y %H.%M"))
    link.cwd(path)
    return link

def writeline(line):
    file.write(line + "\n")

downloaded = open('myfile.txtx', 'wb')

def debug(txt):
    print txt

path="mydir"
filename="myfilename"

link = ftp_connect(path)
file_size = link.size(filename)

max_attempts = 5 #I dont want death loops.

while file_size != downloaded.tell():
    try:
        debug("%s while > try, run retrbinary\n" % strftime("%d-%m-%Y %H.%M"))
        if downloaded.tell() != 0:
            link.retrbinary('RETR ' + filename, downloaded.write, downloaded.tell())
        else:
            link.retrbinary('RETR ' + filename, downloaded.write)
    except Exception as myerror:
        if max_attempts != 0:
            debug("%s while > except, something going wrong: %s\n \tfile lenght is: %i > %i\n" %
                (strftime("%d-%m-%Y %H.%M"), myerror, file_size, downloaded.tell())
            )
            link = ftp_connect(path)
            max_attempts -= 1
        else:
            break
debug("Done with file, attempt to download m5dsum") 
```

我单独测试了登录FTP，成功了。但是在执行 retrbinary 或 retrlist 等任何命令时出现错误

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T12:35:14.687

因为 FTPS 需要 diff 实现

使用下面的代码行解决我的问题

```
ftps = FTP_TLS(server)
ftps.debug(3)
ftps.connect(host=server,port=portno,timeout=60)
ftps.auth()
ftps.login(username, password )
ftps.prot_p() 
```

首先连接到 ftps 服务器，然后使用 auth() 和 prot_p() 登录

# coldfusion - 拒绝工作

> ID：12093623
> 
> 赞同：1
> 
> 时间：2012-08-23T14:11:32.653
> 
> 标签：coldfusion, cffile

我在这里扯头发，真的无法弄清楚为什么这段代码不起作用。我需要用来`<cffile action="write">`在服务器上放一个文件。

我已经将代码剥离到最低限度，试图让文件写入服务器，但它仍然不会让步。我正在运行的代码是这样的。

```
<cffile action = "write" 
        file = "test.txt"
        output = "Content"
> 
```

当我在服务器上运行此代码时，它什么也不做。我在屏幕上没有收到任何错误消息，但是服务器上也没有出现文件。

我已经搜索了一段时间，我唯一能想到的就是写绝对文件路径，所以我也试过这个

```
<cffile action = "write" 
        file = "http://www.my_url.com/test.txt"
        output = "Content"
> 
```

这确实给了我一条错误消息（见下文），但是搜索如何对该错误消息进行排序并没有多大用处。

```
An error occurred when performing a file operation write on file 
http://www.my_url.com/test.txt.
The cause of this exception was: java.io.FileNotFoundException:  
http://www.my_url.com/test.txt. 
```

我认为这可能是我的权限问题，但是 FileNotFound 末尾没有“**拒绝访问**”错误，所以我真的不知道该怎么做。

这令人倍感愤怒，因为在这个确切的网站上，我也在使用`<cffile action="upload">`它，它工作得非常好！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T14:32:22.723

如上所述，`cffile`仅对服务器文件系统进行操作。所以你需要使用*物理*文件路径，而不是 url。此外，文档说如果您使用文件写入的相对路径：

> “...（路径）相对于 ColdFusion 临时目录，由 GetTempDirectory 函数返回。”

因此，如果您没有收到错误，则该文件已创建，只是不在您预期的位置。为避免这种混淆，请使用绝对路径：

```
 <cffile action="write" file="c:/path/to/test.txt" output="Content"> 
```

# java - Java - 通过打开按钮的 Android 对话框

> ID：12093629
> 
> 赞同：0
> 
> 时间：2012-08-23T14:11:59.463
> 
> 标签：java, android, dialog, android-alertdialog

所以我有一个带有点击监听器的按钮。它应该打开一个带有选项的对话框窗口......但它没有。

有谁知道问题是什么？

```
seeTexts.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(context);
                builder.setTitle("Pick a color");
                builder.setItems(items, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int item) {
                        Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show();
                    }
                });
                AlertDialog alert = builder.create();
            }
        }); 
```

编辑（更新代码）：

```
seeTexts.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                AlertDialog.Builder builder = new AlertDialog.Builder(context);
                builder.setTitle("Pick a color");
                builder.setItems(items, new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int item) {
                        Toast.makeText(getApplicationContext(), items[item], Toast.LENGTH_SHORT).show();
                    }
                });
                AlertDialog alert = builder.create();
                alert.show();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:15:03.963

你只是不调用`show`你的`AlertDialog`对象的方法

# hibernate - 如何在 JPA 中查询 BigDecimal 范围

> ID：12093633
> 
> 赞同：0
> 
> 时间：2012-08-23T14:12:07.977
> 
> 标签：hibernate, jpa-2.0, criteria-api, bigdecimal

所以我决定将纬度和经度存储为 BigDecimals

但是现在当我查询一个值时，我想留出一点余地，这样如果我们查询相距米的两个点，我们就不会将它们视为不同（我们指定的点总是至少 100m分开）

即使我填充了已知的测试数据，以下条件查询也不会选择任何内容

```
public List<Location> findLocations(BigDecimal latitude, BigDecimal longitude) {
        BigDecmial geoPointDifferenceThreshold = new BigDecimal(0.0001).setScale(12, RoundingMode.HALF_EVEN);
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery<Location> cq =cb.createQuery(Location.class);

        Root<Location> locationRoot = cq.from(Location.class);
        Path<BigDecimal> latitudePath = locationRoot.<BigDecimal>get("latitude");
        Path<BigDecimal> longitudePath = locationRoot.<BigDecimal>get("longitude");

        Predicate latitudeBetweenRange = cb.between(latitudePath, latitude.subtract(geoPointDifferenceThreshold), latitude.add(geoPointDifferenceThreshold));
        Predicate longitudeBetweenRange = cb.between(longitudePath, longitude.subtract(geoPointDifferenceThreshold), longitude.add(geoPointDifferenceThreshold));

        cq.select(locationRoot).where(latitudeBetweenRange); //within 11m
        cq.select(locationRoot).where(longitudeBetweenRange); //within 11m
        return em.createQuery(cq).getResultList();
    } 
```

我毫不怀疑问题出在椅子和键盘之间。但我看不出它是什么。

提前致谢

测试环境是在我的运行 SQL 2008 Express R2 的 Windows 7 开发机器上使用 Hibernate 的 JPA2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:30:22.107

似乎找到愚蠢错误的最佳方法是在 StackOverflow 上发布问题。

我确信有可用的测试数据。但事实证明我必须非常确定，因为我实际上并没有添加任何内容。

当真的*有*测试数据时，上面的查询可以正常工作。

我很想看看关于改进查询的方法的意见，因为它对我的口味来说有点冗长，但是......

# language-agnostic - 单子——它们在哪里是必要的？

> ID：12093638
> 
> 赞同：10
> 
> 时间：2012-08-23T14:12:21.773
> 
> 标签：language-agnostic, functional-programming, monads

前几天我在谈论函数式编程——尤其是 Haskell 和一些 Java/Scala 人，他们问我什么是 Monad，它们在哪里是必要的。

好吧，定义和示例并不那么难 - `Maybe Monad`，`IO Monad`等等`State Monad`，所以每个人至少部分地同意我说 Monads 是一件好事。

但是在哪里需要 Monad -`Maybe`可以通过`-1`设置 of`Integer`或`""`设置中的魔法值来避免`String`。我写了一个没有`State`Monad 的游戏，这一点都不好，但初学者会这样做。

所以我的问题是：**Monads 在哪里是必要的？**——而且根本无法避免。（并且没有混淆 - 我喜欢 Monads 并使用它们，我只是想知道）。

## 编辑

我想我必须澄清一下，我**不认为使用“魔术值”是一个好的解决方案，但是很多程序员都在使用它们，尤其是在****C**等低级语言中或在 SHell 脚本中，通常通过返回来暗示错误`-1`。

我已经很清楚不使用 monads 不是一个好主意。抽象通常很有帮助，但也很复杂，因此很多人都在为 monad 的概念而苦恼。

我的问题的核心是，例如`IO`，是否有可能在没有 monad 的情况下仍然是纯粹的和功能性的。我知道将一个已知的好的解决方案搁置一旁，以及用打火石和火种而不是使用打火机生火，这将是乏味和痛苦的。

@Antal SZ 提到的文章很棒，[你可以发明 monads](http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html)，我略读了一遍，当我有更多时间时一定会阅读它。更具启发性的答案隐藏在@Antal SZ 引用的博客文章的评论中，[我记得在 monads 之前的时间](http://www.free-variable.org/2012/08/i-remember-the-time-before-monads/)，这是我问这个问题时正在寻找的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T18:27:11.653

我认为你永远*不需要*单子。它们只是当您使用某些类型的功能时自然出现的一种模式。我见过的对这种观点的最佳解释是 Dan Piponi (sigfpe) 的优秀博客文章[“你本可以发明单子！（也许你已经有了。）”](http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html)，这个答案的灵感来自。

你说你写了一个没有使用状态单子的游戏。它看起来像什么？很有可能您最终使用的函数类型类似于`openChest :: Player -> Location -> (Item,Player)`（打开一个箱子，可能用陷阱伤害玩家，并返回找到的物品）。一旦你需要组合它们，你可以手动（`let (item,player') = openChest player loc ; (x,player'') = func2 player' y in ...`）或重新实现 state monad 的`>>=`操作符。

或者假设我们正在使用带有哈希映射/关联数组的语言，而我们没有使用 monad。我们需要查找一些项目并使用它们；也许我们正试图在两个用户之间发送消息。

```
send username1 username2 = {
    user1 = users[username1]
    user2 = users[username2]
    sendMessage user1 user2 messageBody
} 
```

但是等等，这行不通；`username1`并且`username2`可能会丢失，在这种情况下，它们将是`nil`or`-1`或其他东西而不是所需的值。或者也许在关联数组中查找一个键会返回一个类型的值`Maybe a`，所以这甚至会是一个类型错误。相反，我们必须写一些类似的东西

```
send username1 username2 = {
    user1 = users[username1]
    if (user1 == nil) return
    user2 = users[username2]
    if (user2 == nil) return
    sendMessage user1 user2 messageBody
} 
```

或者，使用`Maybe`，

```
send username1 username2 =
    case users[username1] of
      Just user1 -> case users[username2] of
                      Just user2 -> Just $ sendMessage user1 user2 messageBody
                      Nothing    -> Nothing
      Nothing    -> Nothing 
```

哎呀！这是混乱和过度嵌套的。所以我们定义了某种函数，它结合了可能失败的动作。也许像

```
(>>=) :: Maybe a -> (a -> Maybe b) -> Maybe b
f >>= Just x  = f x
f >>= Nothing = Nothing 
```

所以你可以写

```
send username1 username2 =
  users[username1] >>= $ \user1 ->
  users[username2] >>= $ \user2 ->
  Just (sendMessage user1 user2 messageBody) 
```

如果你真的不想使用`Maybe`，那么你可以实现

```
f >>= x = if x == nil then nil else f x 
```

同样的原则也适用。

不过，真的，我建议阅读[“你本可以发明单子！”](http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html) 这是我对单子的直觉，并更好，更详细地解释它的地方。当处理某些类型时，Monads 会自然而然地出现。有时你把这个结构明确化，有时你没有，但仅仅因为你克制它并不意味着它不存在。*从不需要使用特定*结构的意义上说，您永远不需要使用 monad ，但通常这是很自然的事情。并且认识到这里的通用模式，就像在许多其他事情中一样，可以让你编写一些很好的通用代码。

（另外，正如我使用的第二个示例所示，请注意，您已经通过替换`Maybe`魔法值将婴儿与洗澡水一起扔了出去。仅仅因为`Maybe`是单子并不意味着您必须像使用单子一样使用它；列表也是单子，函数（形式`r ->`）也是如此，但你不建议摆脱它们！:-)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T18:29:34.320

我可以接受“ **X**在哪里/在哪里是必要和不可避免的？”这句话。其中**X**是计算中的任何东西；重点是什么？

相反，我认为问“ **X**提供什么/提供了什么价值？”更有价值。

最基本的答案是，计算中的大多数**X**都提供了一个有用的抽象，它使得将代码放在一起变得更容易、更不乏味且更不容易出错。

好的，但你*不需要*抽象，对吧？我的意思是，我可以手动输入一个做同样事情的小代码，对吧？是的，当然，这只是一堆 0 和 1，所以让我们看看谁能更快地编写 XML 解析器，我使用 Java/Haskell/C 或者你使用图灵机。

* * *

Re monads：由于 monads 通常处理有效的[计算](http://research.microsoft.com/en-us/um/people/simonpj/papers/history-of-haskell/history.pdf)，因此这种抽象在组合有效函数时最有用。

我对你的“魔法值也许单子”有异议。这种方法为程序员提供了一个非常**不同**的抽象，并且比*实际* `Maybe`的monad 更不安全、更乏味且更容易出错。此外，阅读这样的代码，程序员的意图会不太清楚。换句话说，它忽略了真正的 monad 的全部意义，即提供抽象。

我还想指出，monad 不是 Haskell 的基础：

1.  `do`-notation 只是语法糖，可以完全被替换，`>>=`并且`>>`不会失去任何表现力

2.  它们（以及它们的组合子，例如`join`, `>>=`,`mapM`等）可以用*Haskell*编写

3.  它们可以用任何支持高阶函数的语言编写，甚至可以使用对象用 Java 编写。因此，如果您必须使用没有 monad 的 Lisp，您可以自己在该 Lisp 中实现它们，而不会有太多麻烦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T23:23:51.340

因为 monad 类型返回相同类型的答案，所以该 monad 类型的实现可以强制和保留语义。然后，在您的代码中，您可以使用该类型链接操作并让它执行其规则，而不管它包含的类型如何。

例如，Java 8 中的 Optional 类强制规定所包含的值要么存在且非空，要么不存在。只要您使用 Optional 类，无论是否使用 flatMap，您都会将该规则包装在包含的数据类型周围。没有人可以作弊或忘记并添加 value=null 和 present=true。

因此，在代码之外声明 -1 将是一个标记值并表示某某是可以的，但您仍然依赖自己和代码中工作的其他人来尊重该语义。如果一个新人加入并开始使用 -1000000 来表示同样的事情，那么语义需要在代码之外（可能使用铅管？）而不是通过代码机制来执行。

因此，不必在您的程序中一致地应用某些规则，您可以信任 monad 来保留该规则（或其他语义）——而不是任意类型。

通过这种方式，您可以通过在类型周围包装语义来扩展类型的功能，而不是在代码库中的每个类型中添加“isPresent”。

众多单子实用程序类型的存在表明，这种用语义包装类型的机制是一个非常有用的技巧。如果您有自己想要添加的语义，您可以通过使用 monad 模式编写自己的类来实现，然后将字符串、浮点数或整数或其他任何内容注入其中。

但简短的回答是，monad 是将常见类型包装在流畅或可链接容器中以添加规则和用法的好方法，而不必对底层类型的实现大惊小怪。

# iphone - 更改opengles中一个点的rgb值

> ID：12093644
> 
> 赞同：0
> 
> 时间：2012-08-23T14:12:38.993
> 
> 标签：iphone, ios, opengl-es

我想在运行时制作灰度过滤器我成功通过这段代码制作它

```
NSString *const kGPUImageLuminanceFragmentShaderString = SHADER_STRING
(
  precision highp float;

   varying vec2 textureCoordinate;

    uniform sampler2D inputImageTexture;

    const highp vec3 W = vec3(0.2125, 0.7154, 0.0721);
   void main()
  {     
   float luminance = dot(texture2D(inputImageTexture, textureCoordinate).rgb, W);
    gl_FragColor = vec4(vec3(luminance), 1.0);
  }
 ); 
```

我现在想要的是访问每个点的 rgb 值并将其应用于我的算法，然后根据我的算法更改点 rgb 值

换句话说，我的问题

我想访问一个点的 rgb 值并设置同一点的 rgb 值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:59:38.797

```
vec3 pixel =  texture2D(inputImageTexture, textureCoordinate).rgb;
 float red = pixel.r;
 float green = pixel.g;
 float blue = pixel.b;

    .
    . manipulate the values as needed
    .

    gl_FragColor = vec4(red, green, blue, 1.0); 
```

或者这个来保持原始像素的 alpha：

```
vec4 pixel =  texture2D(inputImageTexture, textureCoordinate).rgba;
.
.
.

    gl_FragColor = vec4(red, green, blue, pixel.a); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:55:03.343

如果您的意思是像素，那么我认为您正在寻找的是帧缓冲区对象（FBO）。它将允许您将场景渲染为图像，然后您可以将其反馈到着色器中以执行您想要的任何操作，然后您可以将其渲染为最终输出。

# android - 如何获取 ListActivity 的光标

> ID：12093649
> 
> 赞同：0
> 
> 时间：2012-08-23T14:12:45.977
> 
> 标签：android, listactivity, simplecursoradapter

我用最简单的布局方式来定义listview：

```
<ListView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:drawSelectorOnTop="true" /> 
```

因为我需要一个检查列表，所以我`CheckedTextView`在 listitem 模板中使用。用户可以根据需要检查列表中的任意数量的项目。它工作正常。

我有一个`ListActivity`根视图：

```
public abstract class ActivityList extends ListActivity {
 protected ListView listView;
 public abstract void renderListView( String filter );
 @Override
 public void onCreate( Bundle savedInstanceState ) {
  super.onCreate( savedInstanceState );
  setContentView( R.layout.commonlist );
  listView = getListView();
 }
} 
```

它是抽象的，因为`ActivitiList`它将是其他视图类的父类，如产品、客户端等。*抽象的 renderlistview()*将由具有 的子类实现`SimpleCursorAdapter`，例如：

```
public class ActivityProductList extends ActivityList {
 @Override
 public void onCreate( Bundle savedInstanceState ) {
  super.onCreate( savedInstanceState );
  ...
  renderListView( null );
 }
 @Override
 public void renderListView( String filter ) {
  listView.setChoiceMode( ListView.CHOICE_MODE_MULTIPLE );
  ...
  SimpleCursorAdapter sca = new SimpleCursorAdapter( this, R.layout.productlistitemchecked, mCursor, from, to );
  setListAdapter( sca );
 }
} 
```

*ActivityProductList*工作正常。用户做他想做的一切，然后单击在父类中定义和实现的 FINISH 按钮，列表视图也在其中。他的事件处理程序如下：

```
protected void getCheckedItems() {
 try {
   String className = this.getListAdapter().getClass().getName();
   Log.e("NanCal", className);
   Class c = this.getListAdapter().getClass();
   ListAdapter la = this.getListAdapter();
   SimpleCursorAdapter ca = ( SimpleCursorAdapter )la;
   Cursor cursor = ca.getCursor();
   SparseBooleanArray selectedItems = listView.getCheckedItemPositions();
   for( int i = 0; i < selectedItems.size(); i++ ) {
    int selectedPosition = selectedItems.keyAt( i );
    cursor.moveToPosition( selectedPosition );
    long rowId = ca.getItemId( selectedPosition );
    Log.d( "", "row id: " + rowId );
   }
  } catch( Exception exception ) {
   Log.e( "NanCalc", exception.getMessage() + "::" + exception.toString() );
  }
} 
```

**概念是：获取所选项目的ID。**

但是，在我用注释标记的行中，程序崩溃并出现错误： ![eclipse截图部分](../Images/878368269e14f70aeab539bdb94af5c6.png)

this.getListAdapter *()*给了我一个`CursorAdapter`比演员表崩溃的结果。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:32:48.350

在没有更多信息的情况下，很难说你为什么会遇到这个问题。您可以调试您的代码并在注释错误行放置一个断点，然后查看适配器的类型。

我还建议，由于您的方法名称是 getCheckedItems()，因此只需使用[getListView().getCheckedItemIds()](http://developer.android.com/reference/android/widget/AbsListView.html#getCheckedItemIds%28%29)，只需确保已将您的choiceMode 设置为单个或多个。

编辑：由于您的方法实际上并不需要光标，为什么不直接使用返回的 listadapter 呢？获取列表适配器（）。[getItemId](http://developer.android.com/reference/android/widget/Adapter.html#getItemId%28int%29) () 将返回您的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T13:25:49.587

我用剑解决了问题...

我试图从父类（ActivityList）访问 SimpleCursorAdapter。这种方式没有奏效。因此，我将基类更改为抽象并添加一个抽象方法，该方法将返回选定的行 ID。抽象方法在子类（ActivityProductList）中实现。

我知道这个解决方案没有提到原始问题。但它的工作...

谢谢大家的回复。

# java - Axis WSDL2Java 生成问题

> ID：12093650
> 
> 赞同：0
> 
> 时间：2012-08-23T14:12:48.077
> 
> 标签：java, apache, wsdl, axis, wsdl2java

我编写了一些由多个文件（wsdl、xsd）组成的简单服务。在 xsd 文件中，我有以下定义：

```
<xs:complexType name="ServerMessage">
    <xs:sequence>
        <xs:element name="type" type="xs:int"/>
        <xs:element name="info" type="xs:string"/>
    </xs:sequence>
</xs:complexType>
<xs:element name="ServerMessage" type="tns:ServerMessage"/> 
```

然后在 wsdl 文件中像这样引用这个元素

```
<wsdl:message name="createItemFault">
    <wsdl:part name="createItemFault" element="tns:ServerMessage"/>
</wsdl:message>

<wsdl:portType name="Service">
    <wsdl:operation name="createItem">
        <wsdl:input message="tns:createItemRequest"/>
        <wsdl:output message="tns:createItemResponse"/>
        <wsdl:fault name="Fault" message="tns:createItemFault"/>
    </wsdl:operation> 
```

最后

```
<wsdl:binding name="ServiceBinding" type="intf:Service">
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>

    <wsdl:operation name="createItem">
        <soap:operation soapAction="http://test.com/createItem"/>
        <wsdl:input>
            <soap:body use="literal"/>
        </wsdl:input>
        <wsdl:output>
            <soap:body use="literal"/>
        </wsdl:output>
        <wsdl:fault name="Fault">
            <soap:fault name="Fault" use="literal"/>
        </wsdl:fault>
    </wsdl:operation> 
```

启动 WSDL2Java 后，我收到以下代码

```
public interface ServerMessage extends org.apache.xmlbeans.XmlObject
{ 
```

ServerMessage 怎么会变成这样定义的？当我使用 Axis1 提供的 WSDL2Java 时，java 文件中的最终定义是这样的

```
 public class ServerMessage extends org.apache.axis.AxisFault  implements java.io.Serializable 
```

在 Axis2 生成后，生成的“项目”大不相同，它甚至不能扔。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:42:51.027

从该 WSDL 中，您应该得到一个`CreateItemFault`（由于`wsdl:message`名称）类似于：

```
public class CreateItemFault extends java.lang.Exception {
    private org.example.www.service.ServerMessageDocument faultMessage;
    ...
} 
```

这`ServerMessageDocument`可能看起来像：

```
public interface ServerMessageDocument extends org.apache.xmlbeans.XmlObject {
    ...
    org.example.www.service.ServerMessage getServerMessage();

    void setServerMessage(org.example.www.service.ServerMessage serverMessage);

    org.example.www.service.ServerMessage addNewServerMessage();
    ...
} 
```

这是我们到达您的地方`ServerMessage`：

```
public interface ServerMessage extends org.apache.xmlbeans.XmlObject {
    ...
} 
```

不过，方法签名应该抛出一个`CreateItemFault`.

# performance - google maps api -> 设置最大巡航速度

> ID：12093652
> 
> 赞同：1
> 
> 时间：2012-08-23T14:12:53.613
> 
> 标签：performance, google-maps, limit

如果我计算一条新路线，如何设置最大巡航速度？

我在我的站点上为卡车使用 Google Maps API，并希望将“最大速度限制”设置为 80 公里/小时。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T22:34:24.440

Google Maps API 不提供限速信息或过滤，因此您不能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-07-08T21:56:56.710

它应该。任何提供时间的旅行指导系统都需要将各种因素纳入计算 - 看看 TomTom IQ 路线有多有效！它不仅使用速度限制，还使用从 Tomtom 用户收集的实际实时速度数据。此外，我拖着一辆大篷车，因此在英国高速公路上的 70 英里/小时速度不适用，但我可以将最高速度设置为 60 英里/小时（英国高速公路上的最高速度，如果拖车的话），这使得运输时间非常接近现实大多数时候。谷歌地图时间毫无意义。KC

# sql - 是否有一种安全的方法来修改表 pg_constraint 以便不再进行检查（暂时）？

> ID：12093654
> 
> 赞同：2
> 
> 时间：2012-08-23T14:12:56.100
> 
> 标签：sql, postgresql, foreign-keys, constraints

为了从转储中恢复数据库，我想暂时禁用我已清空的数据库所有表中的所有约束（postregsql 8.3）。

是否有一种安全的方法来修改 pg_constraint 表中的字段，可以轻松绕过约束？

[当我查看文档pg_constraint](http://www.postgresql.org/docs/8.3/static/catalog-pg-constraint.html)时，我不这么认为。

是否可以删除 pg_constraint 表内容，然后重新填充？

如果没有，人们如何使用充满约束和外键的表来恢复/复制数据库？（我的目标数据库具有架构，但所有列都是空的）。

**编辑：**虽然 Erwin Brandstetter 的回答是对我的精确问题的好回答（带有明智的警告）......我在恢复期间避免外键错误的一般问题的解决方案是在使用 pg_restore 时使用标志 --disable-triggers。

最后，我的两行命令现在是：

```
pg_dump.exe  -h %ipAddress% -p 5432 -U postgres -F c -a -v -f %file% mydb
pg_restore.exe -h localhost -p 5432 -U postgres -d mydb -v %file%  --disable-triggers 
```

它工作正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:30:56.070

你可以 ...

```
ALTER TABLE tbl DISABLE TRIGGER ALL; 
```

这将永久禁用表的所有*触发器*。所以不要忘记稍后运行：

```
ALTER TABLE tbl ENABLE TRIGGER ALL; 
```

[-> 8.3 手册](http://www.postgresql.org/docs/8.3/interactive/sql-altertable.html)

你可以 ...

```
SET CONSTRAINTS ALL DEFERRED; 
```

这使得所有可延迟的约束等到*事务*结束。
[-> 8.3 手册](http://www.postgresql.org/docs/8.3/interactive/sql-set-constraints.html)

除非您是黑客并且确切地知道自己在做什么，否则您**永远不**应该手动修改系统目录中的表。凡人应该专门使用[DDL](http://en.wikipedia.org/wiki/Data_Definition_Language)命令来影响系统目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:28:52.950

如果您的约束是`DEFERRABLE`，那么您可以这样做：

```
SET CONSTRAINTS DEFERRED 
```

然而，这只是将约束检查转移到下一个`COMMIT`- 换句话说，它是每个事务。

通常对于移动数据，部署某种[备份](http://www.postgresql.org/docs/8.3/static/backup.html)策略。

# mysql - 如何使用 find() / 查询仅返回指定字段

> ID：12093655
> 
> 赞同：0
> 
> 时间：2012-08-23T14:12:57.293
> 
> 标签：mysql, sql, cakephp, cakephp-2.0

目前我正在使用

```
$posts = $this->Post->find('all'); 
```

它返回表格帖子的完整条目，但我怎样才能只获得部分条目。就像是

```
SELECT body,title FROM posts 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:19:25.470

传递“字段”选项并指定（在数组中）要检索的字段。

```
$posts = $this->Post->find('all', array(
    'fields' => array('body', 'title')
)); 
```

我讨厌成为写这篇文章的人，因为它通常困扰着我，但我认为这个问题值得“RTM”。

书中的这一页解释了一切： [http ://book.cakephp.org/2.0/en/models/retrieving-your-data.html](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html)

# macos - 如何在 OS X 上使用 Clang 和 MonoDevelop？

> ID：12093658
> 
> 赞同：1
> 
> 时间：2012-08-23T14:13:02.443
> 
> 标签：macos, monodevelop, clang

在 OS X Lion 上使用 MonoDevelop 时，我想使用 Clang++ 而不是 gcc，但 MonoDevelop 选项仅显示 gcc 和 g++。如何在 MonoDevelop 中使用 Clang++？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T23:35:56.047

您将不得不实施一个扩展。您可以在插件中执行此操作，或者在主 C/C++ 插件本身中执行此操作（gcc 编译器支持作为 C/C++ 插件中的扩展实现）。

以下是一些可能有帮助的链接：

*   [创建一个简单的插件](http://monodevelop.com/Developers/Articles/Creating_a_Simple_Add-in)。
*   [gcc 编译器扩展的来源](https://github.com/mono/monodevelop/blob/master/main/src/addins/CBinding/Compiler/GccCompiler.cs)。
*   [gcc 编译器扩展注册为可序列化类的地方](https://github.com/mono/monodevelop/blob/master/main/src/addins/CBinding/CBinding.addin.xml#L225)。
*   [如何从 MacOS X 的源代码构建 MonoDevelop](http://monodevelop.com/Developers/Mac_Support/Building_MonoDevelop_on_OS_X)。

# iphone - 在情节提要中绘制子视图

> ID：12093659
> 
> 赞同：1
> 
> 时间：2012-08-23T14:13:07.450
> 
> 标签：iphone, uiview, storyboard

我想展示我在 Storyboard 中绘制的 modalView（它可以是 viewController）。我不想以编程方式完成整个事情。有没有办法做到这一点而不是全屏视图？

我想问这个问题的另一种方式是：我如何在 InterFaceBuilder/Storyboard 中绘制`[self.view addSubView:mySubView]`？`mySubView`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:20:42.383

要正确执行此操作，您应该查看文档中的 View Controller 包含。基本上，您会`addChildViewController`在从情节提要中实例化 viewController，然后将 viewController 的视图添加到当前视图层次结构中。

然而，为了让它正常工作，以下内容将让你继续前进：

```
UIViewController *childViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"<identifier you set in Interface Builder>"];
[self.view addSubView:childViewController.view]; 
```

请注意，“正确”执行此操作的原因之一是确保将自动旋转和演示回调发送到子视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:24:16.790

覆盖 object-c 类中的 initWithCoder 方法。

```
- (id)initWithCoder:(NSCoder *)aDecoder {
if ((self = [super initWithCoder:aDecoder])) {
    [self addSubview:[[[NSBundle mainBundle] loadNibNamed:@"MyView" owner:self options:nil] objectAtIndex:0]];
}
return self; 
```

}

# python - SimpleXMLRPCServer 不支持方法签名？

> ID：12093662
> 
> 赞同：1
> 
> 时间：2012-08-23T14:13:19.243
> 
> 标签：python

我正在按照“[示例标准 Python 库](http://www.doughellmann.com/PyMOTW/SimpleXMLRPCServer/)”实现 XMLRPCServer 。我希望客户能够看到方法签名，我希望

```
proxy = xmlrpclib.ServerProxy('http://%s:%s' % (host, port))
print proxy.system.methodSignature('list') 
```

（客户端代码）将向我显示方法签名。

但是它返回“不支持的签名”

这是[SimpleXMLRPCServer](http://svn.python.org/projects/python/trunk/Lib/SimpleXMLRPCServer.py)的代码：

```
def system_methodSignature(self, method_name):
    """system.methodSignature('add') => [double, int, int]

    Returns a list describing the signature of the method. In the
    above example, the add method takes two integers as arguments
    and returns a double result.

    This server does NOT support system.methodSignature."""

    # See http://xmlrpc.usefulinc.com/doc/sysmethodsig.html

    return 'signatures not supported' 
```

有没有一种*简单*的方法来启用方法签名？还是 SimpleXMLRPCServer 真的不支持它们？是否有支持方法签名的实现？

很高兴知道：如果服务器不支持，为什么要包含 system_methodSignatures 方法？XMLRPC 规范？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:17:29.927

注册自省函数。

在这里阅读更多：http: [//www.doughellmann.com/PyMOTW/SimpleXMLRPCServer/#introspection-api](http://www.doughellmann.com/PyMOTW/SimpleXMLRPCServer/#introspection-api)

或者查看 Django 的这个解决方案：[http ://code.google.com/p/django-xmlrpc/wiki/MethodSignatures](http://code.google.com/p/django-xmlrpc/wiki/MethodSignatures)

# php - 引导资源加载在 linux 和 windows 中不同

> ID：12093669
> 
> 赞同：4
> 
> 时间：2012-08-23T14:13:30.780
> 
> 标签：php, zend-framework

我有一个 Zend Framework 应用程序，它为我的公司提供了一个自定义库。我在自定义库下创建的资源在我们的开发环境中的 Windows 中加载得很好。我今天早上刚试图把它移到一个 linux 机器上，我收到以下错误：

```
Fatal error: Uncaught exception 'Zend_Application_Bootstrap_Exception' with message 'Resource matching "errorLogger" not found' in /home/nick/Repos/myfirstzend.com/includes/library/Zend/Application/Bootstrap/BootstrapAbstract.php on line 694 
```

我在我的引导程序的构造函数中设置了我的插件路径，如下所示：

```
$this->setOptions(array(
            'pluginPaths' => array('Company_Application_Resource' => 'Company/Application/Resource')
)); 
```

然后我尝试传递以下数组（在引导程序中的不同 _init 方法中）：

```
$resources['errorLogger'] = array(
                'stream' => array(
                    'writerName' => 'db',
                    'writerParams' => array(
                        'db' => array(
                            'dbname' => APPLICATION_PATH . '/logs/errorLog.sqlite'
                        )
                    )
                )
            ); 
```

到以下方法：

```
$this->registerPluginResource($resourceName, $resourceOptions); 
```

`$resourceName`该初始数组的键（'errorLogger'）在哪里，并且是该键`$resourceOptions`处的数组。

我有`ErrorLogger.php`，`library/Company/Application/Resource/`班级名称是`class Company_Application_Resource_ErrorLogger extends Zend_Application_Resource_Log`.

我不知所措。有人看到我做错了什么吗？

我可以做一系列 var_dumps 来解决这个问题吗？我在这里不知所措。

编辑：[引导代码](http://pastebin.com/4QL9a3m0)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T00:42:41.773

尝试使用 Xdebug 以及可以让您以交互方式调试它的东西（例如 Eclipse PDT）来逐步解决问题区域。这应该让您了解为什么事情会出错。

没有转储你所有的库代码，这似乎是我能想出的唯一答案。

另外，我会尝试重命名资源。如果我记得，Zend 对该名称的资源有疑问。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-16T22:27:03.007

您确定您使用了正确的路径吗？我认为您应该使用带有 APPLICATION_PATH 变量的绝对路径构建。如果 ../ 包含在相对于 APPLICATION_PATH 的路径中，请使用 realpath 函数

此外，我会给你一些我使用的关于自动加载器的代码，也许它会有所帮助。

```
 /**
 * Register namespace App_
 * @return Zend_Application_Module_Autoloader
 */
protected function _initAutoload() {
    $autoloader = new Zend_Application_Module_Autoloader ( array ('namespace' => 'App_', 'basePath' => APPLICATION_PATH ) );
    return $autoloader;
} 
```

如果您的库位于默认路径之外的其他包含路径中，则可以在 application.ini 和命名空间中添加自定义库包含路径，如下所示。

```
includePaths.library = APPLICATION_PATH "/../../www_company_library"
autoloaderNamespaces[] = 'Company'; 
```

# android - 设置相机拍摄的图像的分辨率

> ID：12093670
> 
> 赞同：1
> 
> 时间：2012-08-23T14:13:40.780
> 
> 标签：android, android-camera, android-camera-intent

在我的应用程序中，我通过内置的相机活动拍摄图像并将其存储在 SD 卡中。我正在使用 intent.putextras 来获得高分辨率图像。

第一个设备 - 代码成功运行，我得到分辨率为 640X480 的图像。

第二个设备-当内置相机活动要求保存捕获的图像时，它会强制关闭。但是当我明确地将设备的相机分辨率更改为 640X480 并重新运行应用程序时，它工作得非常好。

问题：-

1.  克服这个的方法？？
2.  这可能是与android版本相关的问题。两种设备的安卓版本不同。
3.  是一种将分辨率参数（640,480）传递给内置相机活动的方法吗？还是需要自制相机活动？

这是代码

```
public void onClick(View v) {
    // TODO Auto-generated method stub

    if(v.getId()!=1000){
        imageFile = "bmp"+v.getId()+".png";

        File f = new File (folder,imageFile);
         imageUri = Uri.fromFile(f);
        Intent i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        i.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, imageUri);
        startActivityForResult(i,CAMERA_PIC_REQUEST);   
    }
    if(v.getId()==1000){
        Intent openFinalShow = new Intent("com.integrated.mpr.FINALSHOW");
        startActivity(openFinalShow);
        finish();
    }

}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub

    super.onActivityResult(requestCode, resultCode, data);
    if(resultCode == RESULT_OK){
            return;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:44:15.903

我不相信有可能将分辨率参数传递给库存相机。这里存在关于具有不同摄像头的不同手机以及用户可能拥有不同的默认摄像头应用程序而无法识别所述意图额外内容的问题。

您的问题的解决方案是使用您自己的预览和相机设置编写自定义相机活动。然后您可以正确设置录制的图像/视频的分辨率。以及预览窗口的分辨率和/或大小等。

相机开发者[指南](http://developer.android.com/guide/topics/media/camera.html)和其他搜索自定义 android 相机示例将很有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T13:43:11.130

要么意图让你指定分辨率，要么你无法实现你想要的。此外，您必须确保在通过 Camera.Parameters 对象设置图片大小时，您只能使用 Camera.getSupportedPitureSizes 给出的值中的一个。

# svn - 无法 mvn release:prepare，服务器证书验证失败

> ID：12093680
> 
> 赞同：5
> 
> 时间：2012-08-23T14:14:06.017
> 
> 标签：svn, maven, maven-deploy-plugin

我正在尝试`mvn release:prepare release:perform`在一个项目上运行一个项目，该项目以前在许多场合都没有问题，但是我看到以下输出：

```
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 45.937s
[INFO] Finished at: Thu Aug 23 15:06:01 BST 2012
[INFO] Final Memory: 5M/81M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-release-plugin:2.2.1:prepare (default-cli) on project my-project: Unable to tag SCM
[ERROR] Provider message:
[ERROR] The svn tag command failed.
[ERROR] Command output:
[ERROR] svn: OPTIONS of 'https://<svn url here>': Server certificate verification failed: certificate has expired, issuer is not trusted (https://<svn url here>) 
```

[我已按照此处](http://trumaze.blogspot.co.uk/2011/08/how-to-ignore-self-signed-ssl.html)`~/.scm/svn-settings.xml`的建议包含以下内容

```
<svn-settings>
  <trustServerCert>true</trustServerCert>
</svn-settings> 
```

这包括`--trust-server-cert`svn 标签的命令行选项。

此行为发生在运行 maven 3.0.4 的 Mac 和 Windows 机器上。

关于如何解决这个问题的任何指示？是服务器证书需要重新颁发吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:50:50.777

我刚刚在自己的设置中看到并解决了这个问题。我在连接到两个也在 centos 上运行的构建服务器的 centos 环境上运行 Jenkins 1.478 版本。

我有相同版本的 maven-release-plugin 并添加了 .scm/svn-settings.xml 文件以尝试修复，但没有效果。

当我以 jenkins 使用的同一用户身份登录时，我通过登录每个构建服务器并手动签出代码（并测试来自构建机器的手动提交）解决了这个问题。这迫使我接受服务器上的证书。完成此操作后，我确认问题已经消失。

# php - 如何为每个访问者制作一个唯一的临时文件并存储其他文件路径名

> ID：12093686
> 
> 赞同：-2
> 
> 时间：2012-08-23T14:14:25.103
> 
> 标签：php, mysql, temp

基本上我知道您可以使用 PHP 中的 tempnam 函数制作临时文件（我们称之为 file2）。但是，我想知道当用户离开网站时如何自动删除它们。或者甚至更好地为该用户存储该临时文件并通过 cookie 进行识别。

我手动创建了一个空白文本文件，当用户将项目拖到购物篮中时，该项目的特定路径名将添加到文本文件中，但是，我如何在唯一用户时自动创建的临时文件发生这种情况进入网站。我在网站上有一个基本模板，可以帮助你理解这个想法。但是，当然它目前无法正常运行，因为我遗漏了一些部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:18:48.453

为什么不是会话？

```
session_start();

$_SESSION['basket'] = "Whatever you like"; 
```

[php.net/会话](http://www.php.net/manual/en/book.session.php)

# linux - 多个用户的 Linux 文件夹权限

> ID：12093691
> 
> 赞同：3
> 
> 时间：2012-08-23T14:14:49.080
> 
> 标签：linux, permissions

我有目录/var/app，我已将其设置为用户“isapp”的主目录。文件夹的所有者是“isapp”，组是“isapp”。我正在使用 Amazon 的 EC2 服务，因此当您登录 SSH 时，您使用用户“ec2-user”。我怎样才能做到这一点，以便我可以通过 SSH 访问该目录的内容？目前，无论是否使用 sudo，我都会被拒绝许可。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:18:50.203

你可以

*   为应该能够访问此文件夹的用户创建一个组
*   将 isapp 和 ec2-user 添加到该组
*   chgrp /var/app 文件夹到这个组
*   chmod /var/app 文件夹并允许组的读取和执行访问权限`chmod g+rx /var/app`

您无法使用 sudo 访问此文件夹的事实更奇怪，`sudo cd /var/app`预计不会起作用，但`sudo ls /var/app`应该起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:24:42.397

usermod -G ec2-user isapp

chmod g+rwx /var/app

# android - Android：如何将过滤后的图像保存为文件？

> ID：12093695
> 
> 赞同：1
> 
> 时间：2012-08-23T14:15:01.413
> 
> 标签：android, filter, bitmap, imageview

我只想制作一个过滤器，就像 instagram 的一样。我使用带有 colorFilter 的 ImageView 来完成效果，但我不知道如何将过滤后的图像保存为文件。如果我直接保存位图，原始位图被存储，没有过滤效果。如果我存储图像视图的像素，它的大小与位图不同。而且出于效果原因，我不想逐像素计算新位图。我被这个问题阻止了好几天。有人能帮我吗？谢谢。BR 秋平

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:16:29.440

我想这可能对你有帮助。查看保存内部和保存外部部分。

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

你会想要把你的图像变成一个位图，像这样：

[将位图保存到位置](https://stackoverflow.com/questions/649154/android-bitmap-save-to-location)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T07:01:20.430

我现在找到了更好的解决方案。我在原始位图上使用了 Canvas，并使用 ColorMatrixColorFilter 进行绘制。不同的 ColorMatrixColorFilter 有不同的用途。改变亮度，改变饱和度，改变对比度。进行组合，然后创建过滤器。

# ios - iOS 在 UIWebView 中加载图像

> ID：12093697
> 
> 赞同：3
> 
> 时间：2012-08-23T14:15:08.677
> 
> 标签：ios, image, cocoa-touch, uiwebview

拼命想弄清楚如何通过 UIWebView 将本地图像（保存在本地 xcode 包中）加载到以下 HTML 中。我花了无数个小时跟随其他指南，但似乎没有任何效果，都抛出错误。我正在尝试在我写过 IMAGEGOESHERE 的以下 NSString 中添加本地图像-

```
{
    [super viewDidLoad];

    self.title = _restaurant.title;

    [[self navigationController] setNavigationBarHidden:NO animated:NO];

    self.activityIndicatorView.hidden = NO;
    [self.activityIndicatorView startAnimating];

    [self loadImageInNewThread];

    NSString *webViewContent = [NSString stringWithFormat:@"<html><head><style>* {font-family:   Helvetica}</style></head><body><center>%@ - %@<br><br><b>Restaurant:</b>%@</b><br>IMAGEGOESHERE<br></center></b></body></html>", _restaurant.openingTime,_restaurant.closingTime, _restaurant.name];

    [self.webView loadHTMLString:webViewContent baseURL:nil];
} 
```

我希望你能帮忙，因为它让我发疯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:24:23.687

您需要首先引用图像的路径：

```
 NSString *pathImg = [[NSBundle mainBundle] pathForResource:@"yourimage" ofType:@"png"]; 
```

然后在 webViewContent 中指定您的路径以及图像的大小：

```
NSString* webViewContent = [NSString stringWithFormat:
                                   @"<html>"
                                   "<body>"
                                   "<img src=\"file://%@\" width=\"200\" height=\"500\"/>"
                                   "</body></html>", pathImg]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T09:52:15.770

此代码应该可以工作，只需将 yourFile 替换为 PDF 的名称，将 webView 替换为 webView 的名称。然后将 ofType 替换为图像的扩展名。

```
//PDF View
       //Creating a path pointing to a file.pdf
       NSString *path = [[NSBundle mainBundle] pathForResource:@"yourFile" ofType:@"pdf"];
       //Creating a URL which points towards our path
       NSURL *url = [NSURL fileURLWithPath:path];
       //Creating a page request which will load our URL (Which points to our path)
       NSURLRequest *request = [NSURLRequest requestWithURL:url];
       //Telling our webView to load our above request
       [webView loadRequest:request]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-15T21:14:12.670

```
NSString *pathImg = [[NSBundle mainBundle] pathForResource:@"yourimage" ofType:@"png"];
NSString* webViewContent = [NSString stringWithFormat:
                               @"<html>"
                               "<body>"
                               "<img src=\"file://%@\" width=\"200\" height=\"500\"/>"
[webView loadHTMLString:webViewContent baseURL:nil]; 
```

您必须在最后一行添加基本 url 为 nil

# php - PHP是否有输入字段

> ID：12093706
> 
> 赞同：0
> 
> 时间：2012-08-23T14:15:28.340
> 
> 标签：php, html, ussd

我正在开发一个专为 USSD 平台设计的 php 代码。对于那些不知道这意味着什么的人来说，它是一个基于文本的应用程序，适用于高端和低端手机 ( [http://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data](http://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data) )。该应用程序涉及显示一个简短菜单和一个（表单）输入字段以输入回复。

问题是 USSD 不喜欢 HTML 代码。任何 HTML 代码都显示为不受欢迎的 HTML 代码，因此我的应用程序中的部分假设显示表单输入字段显示为 html 代码，而不是呈现的表单输入字段。有没有其他方法可以在 PHP 中显示表单输入字段而不是包含 html 代码？

```
 <?php

echo "Options \n
1\. Come home
2\. Go to Spena 
4\. Go to Mungono";

echo "
<form>
<input type='text' id='opt' value='Response: '  onchange='opt()' />
</form> ";

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:18:05.383

不，没有。普通的 PHP 没有像 ASP 或 ColdFusion 这样的助手。因此，您必须手动回显您的 html 代码。

但是，您可以尝试使用像[这样](http://code.google.com/p/php-form-builder-class/)的表单构建器类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:18:33.860

PHP 生成 html 或文本输出，可以以任何你喜欢的方式使用，所以问题是你的客户能够读取/处理什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:20:38.063

PHP 有[GTK](http://gtk.php.net/)，但这对你没有多大好处，因为你的问题不是 PHP 支持的，而是 USSD 支持的……除了据我所知（通过阅读[有关该主题的 Wikipedia 页面](http://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data)，USSD 是只是传输协议。

将有另一个协议（可能是 WAP）用于传递给手机的数据，并且您需要以与其支持的格式兼容的格式提出输入请求。

PHP 是一种编程语言。它可以输出任何你喜欢的东西。您需要找出需要输出到手机的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T14:24:39.153

你检查过 PHP 命令行[I/O 流](http://www.php.net/manual/en/features.commandline.io-streams.php)吗？
我不确定与 USSD 合作。

# sql - 从列中计算不同的值

> ID：12093708
> 
> 赞同：0
> 
> 时间：2012-08-23T14:15:32.713
> 
> 标签：sql, sql-server

我编写了一个返回多个列的查询。其中一列包含重复条目。

```
FAULT_SHORT_NAME

ATM DOWN DUE TO LINK PROBLEM
ATM DOWN DUE TO LINK PROBLEM
ALL CASSETTES FAULTED
ALL CASSETTES FAULTED
ATM IS MARK DOWN
ATM IS MARK DOWN 
```

现在我想以这样的方式修改我的查询，它会显示我的值计数为

```
ATM DOWN DUE TO LINK PROBLEM ALL CASSETTES FAULTED  ATM IS MARK DOWN
2                             2                         2 
```

可能有不同的“FAULT_SHORT_NAME”值，所以不能对它们进行硬编码。我的原始查询是

```
 Select * From ATMStatus S Left Join ATM A on S.ATM=A.Code 
          Left Join EventMsg E On S.Fault=E.Code 
          Where A.ATMStatus=0 AND S.TicketBooked <> 0 
```

FAULT_SHORT_NAME 是表“EventMsg”的列

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:21:57.923

看起来您想要 a[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)因为您希望将值作为列而不是行。有两种方法可以做到这一点，静态或动态枢轴。

静态枢轴，您对列的值进行硬编码：

```
SELECT *
FROM
(
    Select * 
    From ATMStatus S 
    Left Join ATM A 
        on S.ATM=A.Code 
    Left Join EventMsg E 
        On S.Fault=E.Code 
    Where A.ATMStatus=0 
        AND S.TicketBooked <> 0
) x
PIVOT
(
    count(*)
    for FAULT_SHORT_NAME in ([ATM DOWN DUE TO LINK PROBLEM], 
        [ALL CASSETTES FAULTED], [ATM IS MARK DOWN])
) p 
```

Dynamic Pivot，列在运行时生成：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(FAULT_SHORT_NAME) 
                    from EventMsg
                    FOR XML PATH(''), TYPE
                    ).value('.', 'NVARCHAR(MAX)') 
                ,1,1,'')
set @query 
      = 'SELECT ' + @cols + ' from 
         (
            Select * 
            From ATMStatus S 
            Left Join ATM A 
                on S.ATM=A.Code 
            Left Join EventMsg E 
                On S.Fault=E.Code 
            Where A.ATMStatus=0 
                AND S.TicketBooked <> 0
         ) x
         pivot 
         (
            count(*)
            for FAULT_SHORT_NAME in(' + @cols + ')
         ) p '

execute(@query) 
```

两者都会产生相同的结果。如果您提供有关表格和一些示例数据的其他详细信息，那么我可以提供一个更准确的示例。

# shopify - 使用 Shopify 预测 WorldPay 交易 ID

> ID：12093711
> 
> 赞同：1
> 
> 时间：2012-08-23T14:15:45.743
> 
> 标签：shopify, worldpay

我们在 Shopify 中使用 WorldPay 支付处理器。

在 WorldPay 中创建交易时，会根据其在 Shopify 中的订单号为其分配一个 ID。例如：

*   #1010.1 用于订单号 1010
*   #1011.1 用于订单号 1011
*   #1013.2 用于订单号 1013

对于大多数订单，点后的数字是“1”。但至少有一个是“2”。有什么方法可以预测这个数字是多少，或者通过 API 获取它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T11:59:39.373

#1013 后面的部分是交易号。如果交易因任何原因失败，则当用户再次尝试交易时，该数字会增加。您可以使用事务端点检索订单的事务。[http://api.shopify.com/transactions.html](http://api.shopify.com/transactions.html)

# c++ - 我可以在 C++ 中的 struct 中定义类吗

> ID：12093713
> 
> 赞同：1
> 
> 时间：2012-08-23T14:15:48.147
> 
> 标签：c++

我对结构和类有疑问。现在我在结构中定义类，然后将结构创建为节点并将节点推入队列。问题是当我弹出队列时，我创建了接收弹出节点的节点，但节点中的类是一个新类，与推送之前不同。按照代码。

```
 struct queueNode {
        Puzzle puzzle;
        queueNode *next;
        short lastMove;
    };

    class Puzzle {

    private :
        short field[4][4];
        short posBlankI;
        short posBlankJ;
    public :
        Puzzle();
        bool isFinish();
        void print();
        void create();
    }

    class Queue {
        private:
            queueNode *first, *last;

        public:
            Queue(){
                first = new queueNode;
                first->next = NULL;
                last = first;
            }
            ~Queue() { delete first; }
            bool isEmpty(){ return (first->next == NULL); }
            void push(queueNode *aux){

                last->next = aux;
                last = aux;

            }
            queueNode pop(){
                queueNode *aux = first;
                first = first->next;
                return *aux;
            }
    };

    //global variable      
    Queue *q = new Queue();

    int main(){
        queueNode *root = new queueNode;
        root->puzzle.create();
        q->push(root);
        q->pop().puzzle.print();
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:42:59.277

是的，您可以在结构中定义一个类。代码示例不这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:44:40.943

该问题与作为结构成员的类无关。

的构造函数`Queue`创建一个具有 1 个空白节点的队列。`q->push(root)`在末尾插入第二个节点。`q->pop()`返回第一个（空白）节点的副本，而不是您期望的第二个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:43:05.207

pop 返回一个对象而不是指针。创建了一个新的 queueNode，并从 *aux 复制了它的内容。您应该修改 pop 以返回 queueNode 的指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T14:57:30.160

当你创建 Queue 时，它​​会使用 new 创建一个 queueNode，并默认将其放入 Queue 中。因此，当您调用 pop() 时，它会返回您未使用 create() 配置的默认节点。

我稍微修改了您的代码并让它编译和运行以说明我在上面提出的观点。（注意：它在 VS2010 上编译，如果您使用其他东西，请删除 #include "stdafx.h"）

希望这可以帮助您准确了解自己在做什么。

我不建议在您关心的实现中使用下面的代码。仅将其用作学习工具。我建议将您的类声明分离到单独的头文件中，并将实现分离到单独的 CPP 文件中。它有助于组织事物。

输出：

```
0000
0000
0000
0000
1111
1111
1111
1111 
```

代码：

```
#include "stdafx.h"
#include <iostream>

class Puzzle {

    private :
        short field[4][4];
        short posBlankI;
        short posBlankJ;
    public :
        Puzzle()
        {
            for(int i = 0; i<4; i++)
            {
                for(int j = 0; j < 4; j++)
                {
                    field[i][j] = 0;
                }
            }
        }
        bool isFinish();
        void print()
        {
            for(int i = 0; i<4; i++)
            {
                for(int j = 0; j < 4; j++)
                {
                    std::cout<<field[i][j];
                }
                std::cout<<std::endl;
            }
        }
        void create()
        {
            for(int i = 0; i<4; i++)
            {
                for(int j = 0; j < 4; j++)
                {
                    field[i][j] = 1;
                }
            }
        }
    };
struct queueNode {
        Puzzle puzzle;
        queueNode *next;
        short lastMove;
    };

    class Queue {
        private:
            queueNode *first, *last;

        public:
            Queue(){
                first = new queueNode;
                first->next = NULL;
                last = first;
            }
            ~Queue() { delete first; }
            bool isEmpty(){ return (first->next == NULL); }
            void push(queueNode *aux){

                last->next = aux;
                last = aux;

            }
            queueNode pop(){
                queueNode *aux = first;
                first = first->next;
                return *aux;
            }
    };

    //global variable      
    Queue *q = new Queue();

    int main(){
        queueNode *root = new queueNode;
        root->puzzle.create();
        q->push(root);
        q->pop().puzzle.print();
        q->pop().puzzle.print();
        system("Pause");
        return 0;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T14:41:37.853

您的推送会将您的节点添加到内部列表的末尾。这不是空的。

标准库有队列、列表和各种漂亮的容器。使用其中之一。

# sql-server - 使用覆盖索引、合并连接、哈希连接的查询

> ID：12093714
> 
> 赞同：3
> 
> 时间：2012-08-23T14:15:49.503
> 
> 标签：sql-server, tsql, sql-server-2005, join, sql-execution-plan

我正在调整 SQL Server 2005 上的查询。请注意，真正的问题在最后。我有以下查询，pto 和 ph 都有大约 3000 万行。查询最初运行速度很慢（3 分钟）。所以我分别在 pto、ph 上添加了两个索引。

```
 SELECT 
            MAX(ph.txn_date_time)
        FROM 
            pto AS pto WITH (NOLOCK) 
            INNER JOIN ph AS ph WITH (NOLOCK) ON ph.receipt_id = pto.receipt_id
        WHERE 
                pto.subtype = 'ff'
            AND pto.Units_No > 0
            AND ph.branch_id = 5

CREATE NONCLUSTERED INDEX [IX_pto_subTypeUnitReceipt] ON [dbo].[pto] 
(
    [SUBTYPE] ASC,
    [Units_No] ASC,
    [RECEIPT_ID] ASC

)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = ON, IGNORE_DUP_KEY = OFF, ONLINE = OFF) ON [Indexes]

CREATE NONCLUSTERED INDEX [IX_ph_branchReceiptTxn] ON [dbo].[ph] 
(
    [BRANCH_ID] ASC,
    [RECEIPT_ID] ASC,
    [TXN_DATE_TIME] ASC
)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF) ON [Indexes] 
```

现在查询在 350 毫秒内运行。伟大的。执行计划也很简单，它使用从两个表中创建的索引并在receipt_id 列上进行哈希连接，然后使用Stream Aggregate 进行MAX(ph.txn_date_time)。所以查询中的每一列都被两个添加的索引覆盖。

问题是为什么它在receipt_id 列上使用哈希连接？我的意思是，由于两个索引中的 RECEIPT_ID 都已排序，因此优化器应该使用合并连接。为了弄清楚为什么我将第一个索引更改为下面（将 RECEIPT_ID 放在 Units_No 之前）。

```
CREATE NONCLUSTERED INDEX [IX_pto_subTypeUnitReceipt] ON [dbo].[pto] 
(
[SUBTYPE] ASC,
[RECEIPT_ID] ASC,
[Units_No] ASC

)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = ON, IGNORE_DUP_KEY = OFF, ONLINE = OFF) ON [Indexes] 
```

现在我在 RECEIPT_ID 列上看到了 Merge 连接。查询也在 170 毫秒内运行。现在显然优化器认为两个索引中的 RECEIPT_ID 都已排序，因此使用了合并连接。但我不明白为什么在第一种情况下它不这么认为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:37:48.103

原因是这`RECEIPT_ID`不是您拥有的索引中的第一个排序项目。你挡`units_no`路了。

想象一下，您有一排书按出版商订购，然后按作者订购，然后按颜色订购。如果您想查找特定颜色的所有书籍，您需要访问每个出版商部分，然后是每个作者部分，然后找到正确颜色的书籍。因此，“索引”不太适合按颜色扫描，即使您可以一口气说书籍是按颜色分类的。

添加最后一个索引时，`RECEIPT_ID`可用排序，因为您将查询限制为`SUBTYPE`. 因此，`RECEIPT_ID`双方的所有值都是简单可用的，成本很低，并且选择了合并连接。

# c++ - 为什么 auto 的旧用法（c++03）不能在 C++11 下编译？

> ID：12093717
> 
> 赞同：4
> 
> 时间：2012-08-23T14:16:01.520
> 
> 标签：c++, c++11, auto, c++03

我知道它`auto`之前有一点用法，因为它是变量的默认值（与静态相反） - 请参阅[问题](https://stackoverflow.com/questions/8272481/what-was-auto-used-for-before) 考虑有效的 C++03 代码，其中可能为了不言自明，使用了这个关键字：

```
auto int foo2 = 8; 
```

它在 C++03 下编译，在 C++11 下不编译。是否有任何理由不与 C++03 向后兼容？没有使用这个关键词的标准委员会意见的来源是什么？有关键字使用的统计数据吗？

顺便说一句，我用 gcc 测试过——也许这是一个编译器错误？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-23T14:18:46.420

众所周知，这会破坏兼容性，并在标准的附录 C 2.3 第 7 条中有所提及。考虑到汽车的无用性以及修复成本真的很容易，人们认为这是可以接受的。

至于关键字统计：一些拥有庞大代码库的公司在委员会中，他们可能知道这是否可以接受，但我无法挖掘任何完整的统计数据。

我做了一些标准考古，谈论的最古老的论文`auto`似乎是 N1478，它指的是第一次讨论汽车的反射器消息（所有后来的论文都没有谈论破坏兼容性或推理）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-23T14:19:53.353

这已从 C++11 中删除，因为它们有一个新的用途 for `auto`，并且允许`auto auto foo2 = 8;`工作会令人困惑。删除这个古老而毫无意义的声明不会失去任何意义。

# ssh - 从 sudo-run 进程中捕获退出代码

> ID：12093721
> 
> 赞同：10
> 
> 时间：2012-08-23T14:16:08.440
> 
> 标签：ssh, sudo

我有一个脚本，我在其中仔细检查错误条件的返回码，以便在发生故障时尽早中止。该脚本的一个步骤涉及`root`在另一个盒子上以用户身份运行命令，通过`ssh`和`sudo`。

考虑：

```
ssh $HOST sudo $CMD
echo $? 
```

`ssh`将返回代码传回就好了，但即使`$CMD`返回非零退出代码，`sudo`运行命令后仍返回 0。

如何将返回码捕获到`$CMD`？我非常倾向于将它作为`ssh`' 的返回代码传回，但如果有另一种简单的方法不会被 的输出混淆`$CMD`，我会全神贯注。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T14:39:05.637

事实证明，正确`sudo` *地*传递了返回码。我的测试用例很可能被`$?`后续执行或条件测试覆盖。我通常使用命名变量来保存`$?`以避免这样的事情，但是你在那里。

# c# - asp.net web api 自托管的功能有多完善？

> ID：12093722
> 
> 赞同：0
> 
> 时间：2012-08-23T14:16:11.857
> 
> 标签：c#, asp.net, asp.net-web-api

我有一个要求，我需要能够拥有一个独立版本的应用程序，以及一个在线版本。一种可能的方法是拥有一个 WPF 版本，它可以满足独立的需求，以及一个 MVC Web 版本。

显然，这将需要两个代码库（尽管除了前端代码之外，它们应该是相同的）。Web API 自托管是否足够稳定，如果需要，我可以在其中托管一个成熟的 Web 应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:37:00.737

如果您可以使用相同的数据库/服务来使用内部/外部应用程序，您可以在 IIS 中托管单个版本的 WebAPI 服务器，并将其用于 API 控制器。

然后，您可以使用两个相同的 ASP.Net MVC 站点（而不是桌面和 Web），它们调用您的 WebAPI 服务。一个托管在 Intranet 上，一个托管在 Internet 上 - 两者都使用您的 WebAPI 来实现业务功能和数据持久性。

这里的目标是减少维护的代码量。本质上，它是两个项目——您的 WebAPI 项目和一个 ASP.Net MVC 站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T11:59:29.963

对于这种情况，不需要有两个或更多的代码库。您需要的是一个为您的应用程序提供 API 的库。该库可以直接在我认为是桌面应用程序的独立应用程序中使用。

然后，您可以创建一个 WCF 或 Web API，甚至两者都对这只不过是同一个库的包装器进行分层。WCF/Web API 合同可以与您的 DTO 相同，因此 WCF 服务实现将是这样的：

```
SomeObject IMyService.DoStuff(string param)
{
  var myLibrary = new MyLibrary();
  var someObject = myLibrary.DoStuff(param);
  return someObject;
} 
```

唯一的开销是当库中的接口更改时，服务接口中的更改也必须重复，但不会复制实际的业务逻辑。您甚至可以共享接口，即如果您不介意在库接口上具有协定属性，API 将公开 WCF 服务所实现的相同接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:22:12.027

Web API 可以运行自托管，但要运行 ASP.NET (MVC)，您需要像[IIS (Express)](http://learn.iis.net/page.aspx/868/iis-express-overview/)这样的服务器。

您可以做的是在机器上安装 IIS Express，在其中托管您的 Web 应用程序，并在需要时自行托管 Web API。当然，如果您已经安装了 IIS Express，您可能只想选择运行其中的所有内容：Web 应用程序和 Web API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-07T11:17:51.677

我使用 Web API 来自托管许多正在生产的项目。网站[http://www.hypermediaapi.com](http://www.hypermediaapi.com)是一个自托管的 Web API。

# c++ - 用条件定义前缀宏的 C 宏

> ID：12093725
> 
> 赞同：0
> 
> 时间：2012-08-23T14:16:31.127
> 
> 标签：c++, c, macros

我编写了一个具有多个日志级别的日志记录机制。

```
LOG_FATAL(s)
LOG_ERROR(s)
LOG_WARN(s)
... 
```

现在我希望能够激活或停用某些模块的日志记录。我现在应该做什么：

```
#ifdef MOUDLE_LOG_ON
  MODULE_LOG_FATAL(s)  LOG_FATAL(s) 
  MODULE_LOG_ERROR(s)  LOG_ERROR(s)
  MODULE_LOG_WARN(s)   LOG_WARN(s)
  ...
#else
  MODULE_LOG_FATAL(s) 
  MODULE_LOG_ERROR(s)
  MODULE_LOG_WARN(s)
  ...
#endif 
```

有没有办法将前缀放在宏中以像这样使用它：

```
SETUPLOGGING(MODULE) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:20:26.073

宏不能定义新的宏。并且在定义宏时，不可能从其他宏构建它的名称，因此您不能使用包含定义您想要的文件的常见解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:28:17.477

我想知道使用宏和内联函数是否可以解决您的问题：

```
void inline LOG_FATAL(const char *s)
{
    printf("%s\n", s);
}

#define SETUPLOGGING(x) \
    void inline x ## _LOG_FATAL(const char *s) { LOG_FATAL(s); }

SETUPLOGGING(MODULE)

int main()
{
    MODULE_LOG_FATAL("hello");
} 
```

预处理后，这将产生：

```
void inline LOG_FATAL(const char *s)
{
 printf("%s\n", s);
}

void inline MODULE_LOG_FATAL(const char *s) { LOG_FATAL(s); }

int main()
{
 MODULE_LOG_FATAL("hello");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:29:58.837

您可以使用宏来定义要使用的包含文件，但是，为什么不使用包含文件并在其中使用宏呢？

# python - 将比初始设置更多的 kwargs 传递给函数

> ID：12093726
> 
> 赞同：11
> 
> 时间：2012-08-23T14:16:33.737
> 
> 标签：python, keyword-argument

有没有办法将更多的 kwargs 发送到函数中，而不是在函数调用中调用？

例子：

```
def mydef(a, b):
    print a
    print b

mydict = {'a' : 'foo', 'b' : 'bar'}
mydef(**mydict)    # This works and prints 'foo' and 'bar'

mybigdict = {'a' : 'foo', 'b' : 'bar', 'c' : 'nooooo!'}
mydef(**mybigdict)   # This blows up with a unexpected argument error 
```

有什么方法可以在`mybigdict`没有错误的情况下通过吗？ `'c'`在我的理想世界中永远不会被使用，`mydef`只会被忽略。

谢谢，我的挖掘还没有找到我想要的东西。

编辑：稍微修正了代码。这`mydef(a, b, **kwargs)`是我正在寻找的形式，但检查函数 args 对我来说是一个新事物，并且绝对适合我的工具箱。感谢大家！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-23T14:17:47.227

不，除非函数定义允许更多参数（使用`**kwargs`catch-all 语法），否则您不能调用具有比定义更多参数的方法。

您*可以*自省该函数并删除它不接受的任何参数：

```
import inspect

mybigdict = {'a2' : 'foo', 'b2' : 'bar', 'c2' : 'nooooo!'}
argspec = inspect.getargspec(mydef)
if not argspec.keywords:
    for key in mybigdict.keys():
        if key not in argspec.args:
            del mybigdict[key]
mydef(**mybigdict) 
```

我正在使用该[`inspect.getargspec()`函数](http://docs.python.org/library/inspect.html#inspect.getargspec)来检查可调用对象是否支持`**kwarg`包罗万象的 via `.keywords`，如果不支持，我将使用该`.args`信息删除该方法不支持的任何内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-23T14:22:06.130

澄清 Martijn Pieters 的答案（为了清楚起见）。如果您将函数签名更改为：

`def mydef(a, b, **kwargs):`

这意味着不更改签名是不可能的。但如果这不是问题，它会起作用。

# asp.net-mvc - 如何将表单中的复选框序列化为Json数据

> ID：12093730
> 
> 赞同：5
> 
> 时间：2012-08-23T14:16:37.747
> 
> 标签：asp.net-mvc, json, checkbox, jsonserializer

我们知道，在 MVC 中，a`CheckBoxFor`会生成 a `checkbox`with a`value="true"`和 a `hidden`with a `value=false`。两个输入控件将共享相同的名称。

这是非常合理的，因为如果未选中该框，表单将能够 POST 错误值。当复选框返回 true 时，模型绑定器将忽略隐藏的输入。

但是现在我已经覆盖了表单提交事件，以便将表单数据以 JSON 格式发送到 WebAPI 控制器。

序列化表单数据时，没有正确解析复选框和隐藏的关系的机制。因此，当未选中时，它会返回 a `false`，这没关系。但是当检查时，它返回 a`{true, false}`而不是`true`，因为该`serializeArray()`函数遍历 every`input`并找到两个值同名。

问题是：纠正它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:18:37.283

我对这个问题的解决方案是编写我自己的 HtmlHelper 方法，该方法呈现单个 <input type="checkbox" /> 标记。任何其他解决方案似乎都太老套了。

如果您需要任何帮助来完成该任务，您可以使用 dotPeek 或 .NET Reflector 查看 Microsoft 团队如何创建 HtmlHelper.CheckboxFor 方法。

当“bool”参数没有匹配的参数发送到控制器（未选中的复选框不发送任何值）时，采用 2 标记方法来防止 MVC 操作参数引发异常。

# javascript - 为什么 mockjax 会向我的 Ajax 使用者返回一个改变的响应？

> ID：12093731
> 
> 赞同：0
> 
> 时间：2012-08-23T14:16:42.783
> 
> 标签：javascript, ajax, json, rest, mockjax

我正在使用[mockjax](https://github.com/appendto/jquery-mockjax)来模拟​​ Ajax 调用，但我发现 Ajax 回调接收到的数据与我传递给 mockjax 的数据不同（通过“responseText”参数）。在此示例中，我选择了响应为“14.0”，但回调接收的是“14”：

```
$.mockjax({
    url: "/test",
    contentType: "text/json",
    responseText: "14.0"
});

$.ajax({
   url: "/test",
   datatype: "json"
}).done(function(data) {
   alert(data);
});​ 
```

为什么接收到的数据与我指定的不同`responseText`？有关工作示例，请参见[this fiddle ；](http://jsfiddle.net/aknuds1/LUHFB/)一个弹出对话框将显示回调接收到的字符串，应该是'14'。

**编辑：**

这是我在运行小提琴时得到的弹出窗口，展示了来自 mockjax 的更改响应。

![小提琴结果](../Images/9397b23c91bdcbc26be09d5c16eebb39.png)

还修复了小提琴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:35:16.793

如果您更改两件小事，上述代码段将按您的预期工作。

在上面的代码片段中，$.mockjax 中提到的 contentType 是“text/json”。在这种情况下，responseText 需要是一个`object`代表 JSON 的。[https://github.com/appendto/jquery-mockjax](https://github.com/appendto/jquery-mockjax)

```
$.mockjax({
    url: "/test",
    contentType: "text/json",
    responseText: { number: 14.0 }
}); 
```

此外，在 $.ajax 调用中，`datatype`键应该是`dataType` [http://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

```
$.ajax({
    url: "/test",
    dataType: "json"
}).done(function(data) {
    console.log(data);
}); 
```

我在以下 jsFiddle [http://jsfiddle.net/elijahmanor/BtuW8/中进行了更改](http://jsfiddle.net/elijahmanor/BtuW8/)

我希望这可以帮助你解决这个问题。

# php - 如何将这 2 个查询合并为一个查询？

> ID：12093739
> 
> 赞同：0
> 
> 时间：2012-08-23T14:17:15.063
> 
> 标签：php, mysql, mysqli

这是我的代码片段：

```
$other_query = $this -> db -> query("SELECT EXISTS(SELECT 1 FROM shops WHERE cid=$cid AND zbid!=0 AND zbid!=$zbid)",__LINE__,__FILE__);
$this -> db -> output_vars["other_shops"] = $this -> db -> get_result($other_query); // 1 = there are other shops, 0 = no other shops
if($group["shop_create"] == 0){
    $my_shop = 3;
} else {            
    $my_shop_query = $this -> db -> query("SELECT EXISTS(SELECT 1 FROM shops WHERE cid=$cid AND zbid=$zbid LIMIT 1)",__LINE__,__FILE__);
    $my_shop = $this -> db -> get_result($my_shop_query) == 1 ? 1 : 2;
} 
```

我想将这两个查询合二为一。这两个查询之间的唯一区别是，一个查询 where 的行，`zbid!=0 AND zbid!=$zbid`而另一个查询 where 的行`zbid=$zbid`。这里的另一个问题是`if`声明。此外，在这种情况下`$group["shop_create"] == 0`（即在这个初始代码中，只会运行一个查询），我不希望组合查询做任何额外的工作。

对于那些好奇的人，`$this -> db -> get_result($query_resource)`基本上返回相当于`mysql_result($query_resource,0)`. 我从 切换`mysql`到时添加了此功能`mysqli`。

我希望这是有道理的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:51:03.700

为什么不这样做：“SELECT zbid FROM stores WHERE cid=$cid”？

然后你需要等效的 mysql_fetch_* 来循环结果。就我个人而言，我会将它们存储在一个数组中，然后再进行测试。

像这样的东西：

```
$res = $this -> db -> query("SELECT zbid FROM shops WHERE cid=$cid",__LINE__,__FILE__);
$arr = array();
while ( $row = mysql_fetch_row($res) ) {
  $arr[] = $row[0];
}
$arr = array_diff($arr, array(0));

$this -> db -> output_vars["other_shops"] = count(array_diff($arr, array($zbid)) > 0 ? 1 : 0;

if($group["shop_create"] == 0){
    $my_shop = 3;
} else {            
    $my_shop = in_array($zbid, $arr) ? 1 : 2;
} 
```

# python - 如何检查有效的 Git 分支名称？

> ID：12093748
> 
> 赞同：20
> 
> 时间：2012-08-23T14:17:31.617
> 
> 标签：python, regex, git, githooks

我正在[`git` `post-receive`用 Python 开发一个钩子](https://github.com/alexchamberlain/githooks/blob/master/post-receive.d/jekyll-build)。数据`stdin`通过类似于以下的行提供

```
ef4d4037f8568e386629457d4d960915a85da2ae 61a4033ccf9159ae69f951f709d9c987d3c9f580 refs/heads/master 
```

第一个哈希是旧引用，第二个是新引用，第三列是正在更新的引用。

我想把它分成 3 个变量，同时也验证输入。**如何验证分支名称？**

我目前正在使用以下正则表达式

```
^([0-9a-f]{40}) ([0-9a-f]{40}) refs/heads/([0-9a-zA-Z]+)$ 
```

这不接受所有可能的分支名称，如[man git-check-ref-format 所述](http://www.kernel.org/pub/software/scm/git/docs/git-check-ref-format.html)。例如，它排除了一个名为 的分支`build-master`，这是有效的。

### 加分

我实际上想排除任何以“build-”开头的分支。这可以在同一个正则表达式中完成吗？

### 测试

鉴于下面的好答案，我编写了一些测试，可以在 [https://github.com/alexchamberlain/githooks/blob/master/miscellaneous/git-branch-re-test.py](https://github.com/alexchamberlain/githooks/blob/master/miscellaneous/git-branch-re-test.py)找到。

**状态：下面的所有正则表达式都无法编译。这可能表明我的脚本有问题或语法不兼容。**

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-23T14:31:12.667

让我们剖析各种规则并从中构建正则表达式部分：

1.  它们可以包含`/`用于分层（目录）分组的斜线，但斜线分隔的组件不能以点开头`.`或以序列结尾`.lock`。

    ```
     # must not contain /.
     (?!.*/\.)
     # must not end with .lock
     (?<!\.lock)$ 
    ```

2.  它们必须至少包含一个`/`. 这会强制存在诸如 head/、tags/ 等类别，但实际名称不受限制。如果`--allow-onelevel`使用该选项，则放弃此规则。

    ```
     .+/.+  # may get more precise later 
    ```

3.  他们不能在`..`任何地方有两个连续的点。

    ```
     (?!.*\.\.) 
    ```

4.  它们不能在任何地方包含 ASCII 控制字符（即值低于`\040`、 或的字节`\177 DEL`）、空格、波浪号`~`、插入符号`^`或冒号`:`。

    ```
     [^\000-\037\177 ~^:]+   # pattern for allowed characters 
    ```

5.  它们在任何地方都不能有问号`?`、星号`*`或左括号`[`。`--refspec-pattern`有关此规则的例外情况，请参阅下面的选项。

    ```
     [^\000-\037\177 ~^:?*[]+   # new pattern for allowed characters 
    ```

6.  它们不能以斜杠开始或结束，也不能`/`包含多个连续的斜杠（请参阅`--normalize`下面的选项以了解此规则的例外情况）

    ```
     ^(?!/)
     (?<!/)$
     (?!.*//) 
    ```

7.  它们不能以点结尾`.`。

    ```
     (?<!\.)$ 
    ```

8.  它们不能包含序列`@{`。

    ```
     (?!.*@\{) 
    ```

9.  它们不能包含`\`.

    ```
     (?!.*\\) 
    ```

将它们拼凑在一起，我们得到了以下怪物：

```
^(?!.*/\.)(?!.*\.\.)(?!/)(?!.*//)(?!.*@\{)(?!.*\\)[^\000-\037\177 ~^:?*[]+/[^\000-\037\177 ~^:?*[]+(?<!\.lock)(?<!/)(?<!\.)$ 
```

如果你想排除那些开始的，`build-`那么只需添加另一个前瞻：

```
^(?!build-)(?!.*/\.)(?!.*\.\.)(?!/)(?!.*//)(?!.*@\{)(?!.*\\)[^\000-\037\177 ~^:?*[]+/[^\000-\037\177 ~^:?*[]+(?<!\.lock)(?<!/)(?<!\.)$ 
```

这也可以通过合并一些寻找常见模式的东西来优化：

```
^(?!@$|build-|/|.*([/.]\.|//|@\{|\\))[^\000-\037\177 ~^:?*[]+/[^\000-\037\177 ~^:?*[]+(?<!\.lock|[/.])$ 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-07-28T08:41:26.620

**`git check-ref-format <ref>`**有`subprocess.Popen`一种可能性：

```
import subprocess
process = subprocess.Popen(["git", "check-ref-format", ref])
exit_status = process.wait() 
```

好处：

*   如果算法发生变化，检查将自动更新
*   你一定会做对，这对于怪物正则表达式来说更难

缺点：

*   较慢，因为子进程。但过早的优化是万恶之源。
*   需要 Git 作为二进制依赖项。但在钩子的情况下，它会一直存在。

[pygit2](https://github.com/libgit2/pygit2)，它使用 C 绑定到[libgit2](https://libgit2.github.com/)，如果暴露在那里，将是一个更好的可能性`check-ref-format`，因为它会比 快`Popen`，但我还没有找到它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-31T12:54:44.103

没有必要用 Perl 编写怪物。只需使用 /x：

```
# RegExp rules based on git-check-ref-format
my $valid_ref_name = qr%
   ^
   (?!
      # begins with
      /|                # (from #6)   cannot begin with /
      # contains
      .*(?:
         [/.]\.|        # (from #1,3) cannot contain /. or ..
         //|            # (from #6)   cannot contain multiple consecutive slashes
         @\{|           # (from #8)   cannot contain a sequence @{
         \\             # (from #9)   cannot contain a \
      )
   )
                        # (from #2)   (waiving this rule; too strict)
   [^\040\177 ~^:?*[]+  # (from #4-5) valid character rules

   # ends with
   (?<!\.lock)          # (from #1)   cannot end with .lock
   (?<![/.])            # (from #6-7) cannot end with / or .
   $
%x;

foreach my $branch (qw(
   master
   .master
   build/master
   ref/HEAD/blah
   /HEAD/blah
   HEAD/blah/
   master.lock
   head/@{block}
   master.
   build//master
   build\master
   build\\master
),
   'master blaster',
) {
   print "$branch --> ".($branch =~ $valid_ref_name)."\n";
} 
```

Joey++ 的一些代码，虽然我做了一些更正。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T14:52:06.033

对于任何来此问题寻找 PCRE 正则表达式以匹配有效 Git 分支名称的人，它如下：

```
^(?!/|.*([/.]\.|//|@\{|\\\\))[^\040\177 ~^:?*\[]+(?<!\.lock|[/.])$ 
```

[这是由Joey](https://stackoverflow.com/users/73070/joey)编写的正则表达式的修正版本。然而，在这个版本中，斜线不是必需的（它用于匹配`branchName`而不是`refs/heads/branchName`）。

请参考他[对这个问题的正确答案](https://stackoverflow.com/a/12093994/1470771)。他提供了正则表达式每个部分的完整细分，以及它与[`git-check-ref-format(1)`手册页](http://www.kernel.org/pub/software/scm/git/docs/git-check-ref-format.html)上指定的每个要求的关系。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T14:33:41.770

直接从链接页面获取规则，以下正则表达式应仅匹配`refs/heads`不以“build-”开头的有效分支名称：

```
refs/heads/(?!.)(?!build-)((?!\.\.)(?!@{)[^\cA-\cZ ~^:?*[\\])+))(?<!\.)(?<!\.lock) 
```

这从`refs/heads`你的开始。

然后`(?!build-)`检查接下来的 6 个字符是否不是`build-`，并`(?!.)`检查分支是否以`.`.

整个组`(((?!\.\.)(?!@{)[^\cA-\cZ ~^:?*[\\])+)`与分支名称匹配。

`(?!\.\.)`检查连续没有两个句点的实例，并`(?!@{)`检查分支不包含`@{`.

然后`[^\cA-\cZ ~^:?*[\\]`通过排除控制字符`\cA-\cZ`和所有其他明确禁止的字符来匹配任何允许的字符。

最后，`(?<!\.)`确保分支名称不以句点结尾，并`(?<!.lock)`检查它不以`.\lock`.

这可以扩展为类似地匹配任意文件夹中的有效分支名称，您可以使用

```
(?!.)((?!\.\.)(?!@{)[^\cA-\cZ ~^:?*[\\])+))(/(?!.)((?!\.\.)(?!@{)[^\cA-\cZ ~^:?*[\\])+)))*?/(?!.)(?!build-)((?!\.\.)(?!@{)[^\cA-\cZ ~^:?*[\\])+))(?<!\.)(?<!\.lock) 
```

这对分支名称的每一部分应用基本相同的规则，但只检查最后一个不是以`build-`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-26T13:57:03.640

如果您想使用[pygit2](https://www.pygit2.org)检查引用是否有效，您可以执行该功能（[从文档复制的代码](https://www.pygit2.org/references.html#functions)）：

```
from pygit2 import reference_is_valid_name
reference_is_valid_name("refs/heads/master") 
```

# scala - Scala 宏：“无法从具有未解析类型参数的类型 T 创建 TypeTag”

> ID：12093752
> 
> 赞同：9
> 
> 时间：2012-08-23T14:17:47.503
> 
> 标签：scala, macros

我正在玩 Scalas 的新宏，并从[akshaal找到了这个](https://gist.github.com/akshaal)[要点](https://gist.github.com/3388753)。因为它接缝我不太明白。给定以下特征（fieldsMacro 或多或少与 akshaal 示例中的相同）

```
case class Field[I <: AnyRef](name: String, get: I => Any)

type Fields[I <: AnyRef] = List[Field[I]]

trait FieldAccess {
import FieldMacors._
    import Field._
    import language.experimental.macros

    def fields[T <: AnyRef]: Fields[T] = macro fieldsMacro[T]

    def field[T <: AnyRef](name: String): Fields[T] = fields[T].headOption <-- does not work!
                                                             ^
}
 object FieldMacors {

import language.experimental.macros
import Field._

def fields[T <: AnyRef]: Fields[T] = macro fieldsMacro[T]

/**
 * Get a list of fiels
 */
def fieldsMacro[T <: AnyRef: c.TypeTag](c: Context): c.Expr[Fields[T]] = {
  import c.universe._
  val instanceT = c.typeOf[T]

  val fields = instanceT.members.filter(member => member.isTerm && !member.isMethod)

  // transform an iterable of expr in a expr of list.
  def foldIntoListExpr[T: c.TypeTag](exprs: Iterable[c.Expr[T]]): c.Expr[List[T]] =
    exprs.foldLeft(reify { Nil: List[T] }) {
      (accumExpr, expr) =>
        reify { expr.splice :: accumExpr.splice }
    }

  val fieldAccessores = for (field <- fields) yield {
    val name = field.name.toString.trim // Why is there a space at the end of field name?!
    val nameExpr = c literal name

    // Construct expression (x : $I) => x.$name
    val getFunArgTree = ValDef(Modifiers(), newTermName("x"), TypeTree(instanceT), EmptyTree)
    val getFunBodyTree = Select(Ident(newTermName("x")), newTermName(name))
    val getFunExpr = c.Expr[T => Any](Function(List(getFunArgTree), getFunBodyTree))
    reify {
      Field[T](name = nameExpr.splice, get = getFunExpr.splice)
    }
  }
  foldIntoListExpr(fieldAccessores)
}
} 
```

编译器抱怨“无法从具有未解析类型参数的类型 T 创建 TypeTag”

我如何设法让 T 进入宏，或者我必须实现另一个使用 fieldsMacro 的宏

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T16:23:30.027

`T: TypeTag`为类型参数绑定的上下文`T`意味着您需要提供代替此参数的类型参数是具体的（即不包含对未标记类型参数或抽象类型成员的引用）。否则会发生错误。

例子：

```
scala> val ru = scala.reflect.runtime.universe
ru @ 6d657803: scala.reflect.api.JavaUniverse = scala.reflect.runtime.JavaUniverse@6d657803

scala> def foo[T: ru.TypeTag] = implicitly[ru.TypeTag[T]]
foo: [T](implicit evidence$1: reflect.runtime.universe.TypeTag[T])reflect.runtime.universe.TypeTag[T]

scala> foo[Int]
res0 @ 7eeb8007: reflect.runtime.universe.TypeTag[Int] = TypeTag[Int]

scala> foo[List[Int]]
res1 @ 7d53ccbe: reflect.runtime.universe.TypeTag[List[Int]] = TypeTag[scala.List[Int]]

scala> def bar[T] = foo[T] // T is not a concrete type here, hence the error
<console>:26: error: No TypeTag available for T
       def bar[T] = foo[T]
                       ^

scala> def bar[T] = foo[List[T]] // T being not concrete renders 
                                 // the entire compound type not concrete
<console>:26: error: No TypeTag available for List[T]
       def bar[T] = foo[List[T]]
                       ^

scala> def bar[T: TypeTag] = foo[T] // to the contrast T is concrete here
                                    // because it's bound by a concrete tag bound
bar: [T](implicit evidence$1: reflect.runtime.universe.TypeTag[T])reflect.runtime.universe.TypeTag[T]

scala> bar[Int]
res2 @ 7eeb8007: reflect.runtime.universe.TypeTag[Int] = TypeTag[Int]

scala> def bar[T: TypeTag] = foo[List[T]]
bar: [T](implicit evidence$1: reflect.runtime.universe.TypeTag[T])reflect.runtime.universe.TypeTag[List[T]]

scala> bar[Int]
res3 @ 1a108c98: reflect.runtime.universe.TypeTag[List[Int]] = TypeTag[scala.List[Int]]

scala> bar[List[Int]]
res4 @ 76d5989c: reflect.runtime.universe.TypeTag[List[List[Int]]] = TypeTag[scala.List[scala.List[Int]]] 
```

有一个在编译时可以强制执行的具体类型的概念是有用的。默认情况下启用具体类型标签很有用，如[https://issues.scala-lang.org/browse/SI-5884](https://issues.scala-lang.org/browse/SI-5884)中所述。

但是，正如您自己所见，宏中的具体类型标签可能会造成混淆，因为通常宏应该适用于具体类型和非具体类型。因此，应该始终使用`c.AbsTypeTag`。由于这个原因，我们不再允许`c.TypeTag`2.10.0-M7 中的上下文边界：[https](https://github.com/scala/scala/commit/788478d3ab) ://github.com/scala/scala/commit/788478d3ab 。

**编辑**. 在 2.10.0-RC1 中，一些`AbsTypeTag`已重命名为`WeakTypeTag`. 关于类型标签的其他一切都保持不变。

# symfony-forms - 来自实体映射元数据的验证规则

> ID：12093754
> 
> 赞同：1
> 
> 时间：2012-08-23T14:17:49.030
> 
> 标签：symfony-forms, symfony-2.1

有人可以给我一些关于 Symfony2 如何使用 ORM 元数据自动构建验证规则的启示吗？我正在使用 Symfony2.1。

例如，如果我们有一个`Foo`具有必需属性的实体`name`，我们有以下 Doctrine 元数据（作为注释）：

```
@ORM\Column(name="name", type="string", length=255, nullable=false) 
```

但是，如果我们希望在服务器端对其进行验证，我们必须重复这些`nullable`信息：`Assert`

```
@Assert\NotBlank() 
```

另一方面，如果我们有一个`number`带有`integer`类型的属性，它会自动用作验证规则，而无需使用任何`@Assert`注释。

```
@ORM\Column(name="number", type="integer", nullable=true)
//@Assert\Type(type="integer") is no needed 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:52:23.250

Basically, you have two different layers:

*   the persistence layer (Doctrine2, Propel, ...);
*   the [Validation layer](http://symfony.com/doc/master/book/validation.html).

The peristence layer adds validation rules to the database using metadata. In Doctrine2, you can use annotations, but with Propel you describe your database using XML. It's mainly used to define SQL statements (basically `nullable=false` is transformed in SQL `NOT NULL`).

The validation layer is used to validate your data at the application level. Doctrine2 metadata are used to construct your database while the Validation layer is used to validate data (from your users for example) before to insert them in the database.

You can add more constraints at the application level using the Validator component like business validation rules. And, you should not rely on the database to validate data.

As you have two different layers with two different concerns, you can't mix them.

# android - 单击gridview的图像获取imageurl

> ID：12093758
> 
> 赞同：0
> 
> 时间：2012-08-23T14:17:57.200
> 
> 标签：android, android-activity

我已经制作了 android 应用程序，其中使用 php 从数据库（MYSQL）中获取图像。我也得到了图像，但问题是我想将图像传递给另一个活动，即从 gridview 到 viewflipper 以便滑动图像。

请任何人都可以帮助我如何传递从数据库中获取的点击图像。

提前致谢。

**显示活动.java**

公共类 DisplayImages 扩展 Activity{

```
ImageView imageview;
JSONObject json1= JSONfunction.getJSONfromURL("http://www.zxxxxcssxxxxxx.com/app/photo.php");
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_display_images);

        JSONArray catgry = null;
    try {
        catgry = json1.getJSONArray("photo");
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

   final GridView gridView=(GridView)findViewById(R.id.gridview);
   ImageAdapter adapter=new ImageAdapter(this,catgry);
   gridView.setAdapter(adapter);

   /**
    * On Click event for Single Gridview Item
    * */

   gridView.setOnItemClickListener(new  OnItemClickListener(){

    public void onItemClick(AdapterView<?> parent, View view, int position,
            long id) {
        // TODO Auto-generated method stub

        Image img=new Image();
        Object imagename=view.getTag();

        if(position==0)
        img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_3.jpg"));
        if(position==1)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_4.jpg"));
        if(position==2)
            img.setImageBitmap(getImageBitmap("http:/www.aaa.com/thumb_photo_5.jpg"));
        if(position==3)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_6.jpg"));
        if(position==4)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_7.jpg"));
        if(position==5)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_8.jpg"));
        if(position==6)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_9.jpg"));
        if(position==7)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_10.jpg"));
        if(position==8)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_11.jpg"));
        if(position==9)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_12.jpg"));
        if(position==10)
            img.setImageBitmap(getImageBitmap("http://www.aaa.com/thumb_photo_13.jpg"));

        Toast.makeText(DisplayImages.this, "" + imagename,
                Toast.LENGTH_SHORT).show(); 

        Intent intent=new Intent(getApplicationContext(),FullSizeImageActivity.class);
        //Create Parcelable object
        ParcelableImage parcelableImage=new ParcelableImage(img);

        //store Parcelable Object in intent
        intent.putExtra("img", parcelableImage);
        startActivity(intent); 
    }

   });
}

private Bitmap getImageBitmap(String url) {
    Bitmap bm = null;
    try {
        URL aURL = new URL(url);
        URLConnection conn = aURL.openConnection();
        conn.connect();
        InputStream is = conn.getInputStream();
        BufferedInputStream bis = new BufferedInputStream(is);
        bm = BitmapFactory.decodeStream(bis);
        bis.close();
        is.close();
   } catch (IOException e) {
       //Log.e(TAG, "Error getting bitmap", e);
   }
   return bm;
} 
```

}

我正在传递gridview中该位置的图像路径onclick。但我想获取图像的图像路径onclick。我如何动态获取图像路径并传递另一个活动。

这是我的图像适配器的代码

公共类 ImageAdapter 扩展 BaseAdapter {

```
public ImageView[] mImages;
String qrimage;
static class ViewHolder{

    ImageView image;
}

JSONObject json1= JSONfunction.getJSONfromURL("http://www.zzzzzxxxxxxxxxx.com/app/photo.php");

private Context context;

public ImageAdapter(Context mcontext,JSONArray imageArrayJson) {
    // TODO Auto-generated constructor stub
    this.context=mcontext;
    this.mImages = new ImageView[imageArrayJson.length()];

    for(int i=0;i<imageArrayJson.length();i++){

        JSONObject image;
        try {
            ImageView imageView;
            imageView = new ImageView(context);

            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setLayoutParams(new GridView.LayoutParams(90, 90));
            image = imageArrayJson.getJSONObject(i);
            qrimage="http://www.aaa.com/"+image.getString("thumbsize");

            //imageView.setImageBitmap(getImageBitmap(qrimage));
            mImages[i]= new ImageView(context);
            mImages[i].setImageBitmap(getImageBitmap(qrimage));
            mImages[i].setTag("Image"+i);

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:21:10.020

如果你想在活动之间传递一些东西，你会想要做这样的事情：

[如何在 Android 上将对象从一个活动传递到另一个活动？](https://stackoverflow.com/questions/2906925/android-how-do-i-pass-an-object-from-one-activity-to-another)

您正在从数据库中获取数据，但没有任何改变。

# netbeans - Netbeans 7.2：禁用语法错误窗口？

> ID：12093760
> 
> 赞同：2
> 
> 时间：2012-08-23T14:18:02.030
> 
> 标签：netbeans, syntax-error, netbeans-7.2

有没有办法在 7.2 中禁用语法错误窗口（黄色弹出窗口）？

到处搜索，但没有找到明确的答案。我不认为这是可能的，但我想我会问。

谢谢！

# java - ORMLite - 具有同一列的多个索引

> ID：12093763
> 
> 赞同：3
> 
> 时间：2012-08-23T14:18:10.630
> 
> 标签：java, android, ormlite

在 ORMLite 中是否可以让同一列参与多个索引？`@DatabaseField(index=...)`注释似乎每个字段只允许一个索引。

例如我可能有一个类：

```
public class PhoneCall{
    @DatabaseField
    public Date timestamp;
    @DatabaseField
    public String from;
    @DatabaseField
    public String to;
} 
```

我的查询总是首先按时间戳完成，然后按“从”或“到”完成。

在这种情况下，我需要两个组合索引：

*   index1：（时间戳，从）
*   index2：（时间戳，到）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-14T09:24:42.190

来自 javadoc[`DatabaseField`](http://ormlite.com/javadoc/ormlite-core/com/j256/ormlite/field/DatabaseField.html)

```
 /**
     * Set this to be a string (default none) to have the database add an index for 
     * this field with this name. You do not need to specify the {@link #index()} 
     * boolean as well. To index multiple fields together in one index, each of
     * the fields should have the same indexName value.
     */
    String indexName() default ""; 
```

但我看不到如何在两个不同的索引中使用相同的字段。

# satellite - PyEphem 中地球卫星的直角坐标

> ID：12093766
> 
> 赞同：5
> 
> 时间：2012-08-23T14:18:15.930
> 
> 标签：satellite, pyephem

我搜索了大量的 PyEphem 网页，下载了代码，研究了对象，但我还没有找到在某个名义上的惯性坐标系中获取地球卫星的地心直角坐标的方法。我错过了什么明显的东西吗？我正在寻找“传统”x、y、z 和 x-dot、y-dot、z-dot。非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T19:28:27.250

好问题！

内部的卫星定位例程在内部`libastro`使用`x` `y` `z`坐标，但`libastro`在 Python 有机会看到它们之前将它们丢弃。我本可以尝试修补`libastro`然后 PyEphem 使数据可用，但是在研究您的问题时，我发现最近完成了出色的工作来更新 SGP4 卫星跟踪算法并为其提供测试套件：

[http://www.celestrak.com/publications/AIAA/2006-6753/](http://www.celestrak.com/publications/AIAA/2006-6753/)

在这个发现的推动下，我做了一些更好的事情：我花了整个周末创建一个`sgp4`基于这个参考实现的新的纯 Python 包！

[http://pypi.python.org/pypi/sgp4](http://pypi.python.org/pypi/sgp4)

很快我将围绕这个卫星预测引擎构建一个名为 Skyfield 的完整天文学库，但目前您应该能够直接从 Python 包索引（上面的链接）下载它并调用它来获取您的传统坐标：

```
from sgp4.earth_gravity import wgs72
from sgp4.io import twoline2rv

line1 = ('1 00005U 58002B   00179.78495062  '
         '.00000023  00000-0  28098-4 0  4753')
line2 = ('2 00005  34.2682 348.7242 1859667 '
         '331.7664  19.3264 10.82419157413667')

satellite = twoline2rv(line1, line2, wgs72)
position, velocity = satellite.propagate(
    2000, 6, 29, 12, 50, 19) 
```

请尝试一下，让我知道它是否适用于您的机器！

# jquery - 使用jquery添加/删除兄弟元素属性

> ID：12093767
> 
> 赞同：2
> 
> 时间：2012-08-23T14:18:15.883
> 
> 标签：jquery

我有这个 html。

```
<tr>
    <td width="75">Mon</td>
    <td class="bn_time" width="60">
        <input id="mon_open" name="mon_open" class="time" placeholder="opening time" />
    </td>
    <td class="bn_time" width="10" align="center">-</td>
    <td class="bn_time" width="100">
        <input id="mon_close" name="mon_close" class="time" placeholder="closing time" />
    </td>
    <td colspan="3" align="center" class="bn_holiday" hidden>Holiday</td>
    <td>
        <input type="checkbox" name="mon_closed" id="mon_closed" class="bn_closed" />
        <label for="mon_closed">Closed</label>
    </td>
</tr> 
```

我想做的是对复选框`add/remove' hidden attribute to``元素使用更改事件。例如。

```
if ('#bn_closed').is(':checked') {
    //hide all <td> element with class bn_time
    //show <td> element with class bn_holiday
} else {
    //show all <td> element with class bn_time
    //hide <td> element with class bn_holiday
} 
```

这就是我尝试使用 jQuery 做的事情。

```
$('.bn_closed').change(function() {
    var element = $(this);
    var id = element.attr('id');
    var day = id.slice(0,-7);
    var day_open = day+'_open';
    var day_close = day+'_close';
    if(element.is(':checked')) {
        //hide all <td> element with class bn_time
        //show <td> element with class bn_holiday
    } else {
        //show all <td> element with class bn_time
        //hide <td> element with class bn_holiday
    }
}); 
```

有一个重要的事情要注意，**有多个元素具有相同的类名。我想修改只是兄弟姐妹元素的属性，而不是表中的所有元素。**

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:24:02.107

```
var checked = element.is(':checked');
var $td = element.closest("td");

$td.siblings(".bn_time").toggle(!checked);
$td.siblings(".bn_holiday").toggle(checked); 
```

# ruby-on-rails - rails 编辑辅助方法

> ID：12093768
> 
> 赞同：1
> 
> 时间：2012-08-23T14:18:17.467
> 
> 标签：ruby-on-rails, ruby, rest, edit, helper

我想在 Rails 中询问 URI 助手，例如在操作编辑中：我们使用了 Helper 方法：`edit_movie_path(@movie)`，（假设 @movie 是实例变量）所以相应的 Restful Route 将是

```
GET /movies/id/edit 
```

我对它如何通过 id 感到困惑！当我们通过@movie（我们没有通过id）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:34:50.820

Rails 利用多态性。每个对象都有`to_param`方法（[这里](http://api.rubyonrails.org/classes/Object.html#method-i-to_param)）。`ActiveRecord::Base`覆盖它以返回记录`id`，请参阅[这些 api 文档](http://apidock.com/rails/ActiveRecord/Base/to_param)。然后，URL 助手依赖于一切都可以转换为参数的事实`to_param`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:25:14.743

电影有一个 id，助手使用它来构造路由字符串。

# ruby - Ruby，删除部分文件路径

> ID：12093770
> 
> 赞同：11
> 
> 时间：2012-08-23T14:18:21.033
> 
> 标签：ruby

```
$local_path_to_css_file = File.expand_path(filename) 
```

给我

```
A/B/C/D/CSS/filename 
```

或者

```
A/B/C/D/CSS/layouts/filename 
```

我希望结果是：

```
css/filename 
```

或者

```
css/layouts/filename 
```

删除所有内容，直到`css/`.

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-23T14:26:07.713

您可以使用`Pathname`

```
require 'pathname'

absolute_path = Pathname.new(File.expand_path(filename))
project_root  = Pathname.new("/A/B/C/D") # you can set up root somewhere else, e.g. at point where script starts
relative      = absolute_path.relative_path_from(project_root)

relative.to_s # => "css/filename" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T14:28:21.487

后视模式将满足您的需求。

```
def my_path(s)
  s[/(?=CSS).*/]
end

my_path "A/B/C/D/CSS/filename"  # => CSS/filename 
```

# ios - 从 iCloud 备份中排除文件

> ID：12093774
> 
> 赞同：3
> 
> 时间：2012-08-23T14:18:34.323
> 
> 标签：ios, backup, icloud

我正在使用 iOS 5.1 我使用这种代码和平

```
[pathURL setResourceValue:[NSNumber numberWithBool:YES]
                   forKey:NSURLIsExcludedFromBackupKey
                    error:nil]; 
```

我放置内容的文件夹是（在应用程序沙箱内）.../Library/Application Support/，而不是 /Documents 文件夹

我没有收到任何错误，setResourceValue: 的结果是 YES

为什么我看到 2 MB 是 Settings -> iCloud -> ... etc. 我可以在其中检查应用程序数据大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:21:27.960

最后我自己找到了解决方案线索是将 NSURLIsExcludedFromBackupKey 应用于根文件夹，而不是应用于要从备份中排除的每个文件

所以一开始你应该用（例如）“图书馆/应用程序支持”文件夹来调用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T13:24:07.377

值得注意的是，您不能只在 NSHomeDirectory() 上设置标志。它必须在该路径的内部。

# php - 如何引入新产品并将它们展示在 Magento 的轮播中？

> ID：12093778
> 
> 赞同：0
> 
> 时间：2012-08-23T14:18:40.213
> 
> 标签：php, javascript, magento, jcarousellite

我有点像 Magento 的菜鸟。我想知道是否有一种方法可以使用 jcarouselLite 在主页上显示新产品？我现在有一个放置器的静态内容。有没有办法拉入新上市的产品并显示在轮播中？如果是这样，我将如何去做？不幸的是，我现在没有可以显示的链接。我感谢任何帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T11:08:28.307

对于任何产品，检查当前日期是否与该产品的新开始日期或新日期匹配，则该产品将被视为新产品。

或者，您可以创建一个类别并将要显示为新的产品与该类别相关联，然后显示与该类别关联的产品

# c# - 在下拉列表中显示 DB 值

> ID：12093789
> 
> 赞同：-3
> 
> 时间：2012-08-23T14:19:08.057
> 
> 标签：c#, asp.net

> **可能重复：**
> [在下拉列表中显示数据库值](https://stackoverflow.com/questions/12088358/display-db-values-in-a-dropdownlist)

我正在获取数据库值并将它们显示在下拉列表中。我有国家和州下拉列表：

```
DropDownList1.Items.Add(new ListItem(Session["country"].ToString()));
DropDownList2.Items.Add(new ListItem(Session["state"].ToString())); 
```

我无法在 DDL 中显示数据库值。我在状态下拉列表中得到--选择一个状态--如何在下拉列表中显示数据库值？

```
<asp:DropDownList ID="DropDownList2" runat="server" AutoPostBack="True">
    <asp:ListItem Value="Select a state" >Select a state</asp:ListItem>
    <asp:ListItem Value="value 1" >Maharastra</asp:ListItem>
    <asp:ListItem Value="value 2" >Goa</asp:ListItem>
    <asp:ListItem Value="value 3" >Kashmir</asp:ListItem>
</asp:DropDownList> 
```

我在这里获取数据库值并将它们发送到下一页

```
 if (dt.Rows.Count > 0)
            {
                DataTable dt1 = new DataTable();
                dt1 = bll.getnewid(TextBox1.Text);

                    if (dt1.Rows.Count > 0)
                    {

                        Session["country"] = dt1.Rows[0]["Country"].ToString();
                        Session["state"] = dt1.Rows[0]["State"].ToString(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:21:24.613

好吧，您必须以某种方式将您的 ddlist 绑定到数据库结果。看起来像这样：

```
ddlist1.DataSource = MyDBAccessClass.GetSomeValues();
ddlist1.DataBind(); 
```

根据更多评论...我将不得不玩一个小轮盘赌，猜猜你的意图是什么。您的代码有多个问题，您显然有一些问题在解释自己。

如果我理解正确，您有 2 个下拉列表。您想用国家填充一个，并根据选择填充第二个下拉列表。

基本原理如下所示：

数据访问类.cs

```
public class DataAccessClass
{
    public static IEnumerable<string> GetCountries()
    {
        // access the database and retrieve all the values
        // returns IEnumerable (a list of items)
    }

    public static IEnumerable<string> GetStates(string selectedCountry)
    {
        // access the database and retrieve all the corresponding states
        // linq2sql: var states = from o in db.States
        //                        where o.country = selectedCountry
        //                        select o;
        // returns IEnumerable (a list of items)
    }
} 
```

你的页面.aspx

```
<asp:DropDownList id="ddlistCountries" runat="server" AutoPostBack="True" /><br />
<asp:DropDownList id="ddlistStates" runat="server" /> 
```

YourPage.aspx.cs

```
public partial class YourPage
{
    protected void Page_Init(object sender, EventArgs e)
    {
         ddlistCountries.SelectedIndexChanged += new EventHandler(ddlist_SelectedIndexChanged);
    } 

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!isPostBack)
        {
            PopulateCountries();
            ddlistStates.Enabled = false; // no country selected yet!
        }
    }

    protected void PopulateCountries()
    {
        ddlistCountries = DataAccessClass.GetCountries();
        ddlistCountries.DataBind();   
        ddlist.Items.Insert(0, "Select a country");
    }

    void ddlist_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (ddlistCountries.SelectedIndex != 0)
        {
             ddlistStates.DataSource = DataAccessClass.GetStates(ddlistCountries.SelectedValue);
             ddlistStates.DataBind();
             ddlistStates.Enabled = true;
        }
        else
        {
            ddlistStates.Items.Clear();
            ddlistStates.Enabled = false;
        }
    }
} 
```

如果你不能理解这一点，要么回到基础，要么完全忘记编程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T14:25:53.090

```
DropDownList2.DataSource = {your data source}; 
DropDownList2.DataTextField = "text column name"; 
DropDownList2.DataValueField = "data column name of id"; 
DropDownList2.DataBind(); 
```

您需要将数据源设置为 DDL，然后设置要显示的值，然后绑定它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T14:23:19.387

我建议像这样使用下拉列表：

```
ddl.DataSource = YourDBSource.Get();
ddl.DataBind(); 
```

然后，您可以决定在此处显示的内容：

```
ddl.DataTextField = ...;

or 

ddl.DataValueField = ...; 
```

首先，没有理由在 .aspx 页面中构建您的 listItem，因为您将以编程方式填充您的 ddl。

其次，我不知道您所说的“我在这里收集数据库值并将它们发送到下一页”是什么意思。只需在数据库上使用适当的查询填充数据源。

如果您想执行更简单的过滤/无论您想要什么，请尝试使用 Linq2SQL。

此外，您需要在 *Page_Load()* 中执行此数据绑定，如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{

        if (!IsPostBack)
        {
            ddlErreur.DataSource = ...;
            ddlErreur.DataTextField = ...;
            ddlErreur.DataBind();
        }
} 
```

# javascript - Ember.js：{{#collection}} 和 {{#each}} 之间的区别？

> ID：12093792
> 
> 赞同：3
> 
> 时间：2012-08-23T14:19:13.980
> 
> 标签：javascript, ember.js, handlebars.js

`{{#collection}}`在 Ember.js 中，使用和有什么区别`{{#each}}`？在什么情况下你会使用哪个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:35:08.267

嗯，嗯……这是一个很好的问题……正如你在这里看到的：[#729](https://github.com/emberjs/ember.js/issues/729)，似乎这个`{{collection}}`助手将被弃用，而倾向于使用 always `{{#each}}`。但此时，所有可用的功能`{{#collection}}`都不在`{{#each}}`.

因此，我建议您在`{{#each}}`适合您的情况下使用，并且仅`{{collection}}`在绝对需要时使用。~~（例如，当您需要定义 itemViewClass 时）。~~

更新：从 1.0.0-pre.2 开始，每个助手的 itemViewClass 属性。`collection`助手唯一剩下的事情`each`是，如果您扩展了 Ember.CollectionView，您可以显式定义要使用的集合类。

# json - Mongoose：将 $in 运算符与 JSON 对象一起使用

> ID：12093802
> 
> 赞同：1
> 
> 时间：2012-08-23T14:20:15.440
> 
> 标签：json, node.js, mongodb, mongoose

我是 Nodejs 和 mongodb 的新手。

我试图获取以下场景的数据。考虑以下 3 个模式配置文件模式

```
var ProfileSchema = new Schema({
username: {type: String, match: /^[a-zA-Z0-9_.-]+$/, unique: true},
name: String}); 
```

帖子架构

```
var PostsSchema = new Schema({
profileid: {type: ObjectId, ref: 'Profile'},
message: {type: String, match: /^.{1,160}$/} }); 
```

遵循架构

```
var FollowSchema = new Schema({
profileid: {type: ObjectId, ref: 'Profile'},
followingid: {type: ObjectId, ref: 'Profile'}}); 
```

这类似于 twitter 层次结构。

为了从我的关注者那里获取所有帖子，我尝试了以下方法

```
Follows.find({'profileid' : '500d18823e792d8814000001'}).select('followingid -_id').limit(20).sort({addedon: 'desc'}).execFind(function (arr,followings) {
    Posts.find({profileid: {$in: followings}}).limit(20).execFind(function (arr,data) {
        console.log(data);
    });
}); 
```

但它不起作用。请指导获得此信息的最佳方法。

谢谢你的支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T18:13:15.147

您没有从关注集合的初始查询中得到任何反馈吗？你传入一个字符串

```
'500d18823e792d8814000001' 
```

作为 profileId，但 MongoDB 以不同的方式存储字符串和 ObjectId。由于 profileid 字段是 ObjectId，因此您必须在执行查询之前将字符串转换为 ObjectId。

尝试查询 Follows 集合

```
'profileid':ObjectId('500d18823e792d8814000001') 
```

# jquery - jQuery 1.8 外部高度/宽度不起作用

> ID：12093806
> 
> 赞同：29
> 
> 时间：2012-08-23T14:20:26.760
> 
> 标签：jquery, height, jquery-1.8

我在很多地方都`outerHeight`用过`outerWidth`。现在，在 jQuery 1.8 发布后，我遇到了很多由对象返回而不是其大小引起的问题。

例如：

```
$('#stackoverflowdiv').Height()      // returns 100 px
$('#stackoverflowdiv').outerHeight() // returns "stackoverflowdiv" div 
```

我发现解决此问题的唯一方法是在函数中使用“真/假”，如下所示，但我得到的结果与标准`width()`和`height()`函数相同：

```
$('#stackoverflowdiv').outerHeight(true)  //  returns 100 px
$('#stackoverflowdiv').outerHeight(false) //  returns 100 px 
```

有谁知道为什么这不再起作用或以其他方式获取元素的高度/宽度+其边距。

编辑：我开始相信这是因为我使用`contents()`函数在 iframe 中选择元素造成的。我会尝试做一个演示。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-25T03:56:37.287

这实际上是一个**已知的 jQuery 错误**，您可以在[此处](http://bugs.jquery.com/ticket/12159)阅读。

我在没有参数的情况下遇到了它，修复是设置参数（即使有默认的 {false}），但我能够通过将 true 参数替换为 1 并将 false 参数替换为 0 来打破 Barlas 的小提琴。所以不要如果您是，请不要这样做。

做这个：

```
alert(jQuery(this).outerHeight(false)); 
```

不要这样做：

```
alert(jQuery(this).outerHeight());
alert(jQuery(this).outerHeight(0)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-06T14:50:38.403

只有当我不这样做时它才`.outerHeight(1);`有效`.outerHeight(true);`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T14:28:46.640

JQuery 1.8 `height()`, `innerHeight()`,`outerHeight()`和`outerHeight(true)`按预期工作：

[**演示**](http://jsfiddle.net/yVq5H/)- 工作高度方法

上面的演示使用了一个 div：

```
<div id="myDiv">My Div</div> 
```

使用以下 CSS：

```
div{
    border: 1px solid blue;
    padding: 5px;
    margin: 10px;
} 
```

使用此脚本：

```
var $div = $("#myDiv");
var height = $div.height();
var heightWithPadding = $div.innerHeight();
var heightWithPaddingAndBorder = $div.outerHeight();
var heightWithPaddingAndBorderAndMargin = $div.outerHeight(true);

var $result = $("#result");
$result.append("height: " + height);
$result.append("<br />height with padding: " + heightWithPadding);
$result.append("<br />height with padding and borders: " + heightWithPaddingAndBorder);
$result.append("<br />height with padding and borders and margin: " + heightWithPaddingAndBorderAndMargin); 
```

结果如下：

```
height: 20
height with padding: 30
height with padding and borders: 32
height with padding and borders and margin: 52 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-08T18:08:58.900

最好的解决方法是传递布尔参数`true`或`false`在调用`outerHeight`或`outerWidth`

**但..**

如果您无权访问调用的文件，`outerHeight`或者您不想编辑`outerHeight`文件中的所有函数，则可以像下面这样覆盖 jQuery`outerHeight`函数以使其始终传递`true`参数

```
var oldOuterHeight =  $.fn.outerHeight;

$.fn.outerHeight = function () { 
    return oldOuterHeight.apply(this, [true]);
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T14:29:28.153

它工作得很好伙伴，我不能确定没有看到你的 html 和 css，但你可以检查[这个例子](http://jsfiddle.net/47Kt6/7/)并检查它在 jQuery 1.8.0 上工作正常

[这是工作的jsFiddle。](http://jsfiddle.net/47Kt6/7/)

**jQuery：**

```
console.log($('#stackoverflowdiv').outerHeight(false));//returns 110
console.log($('#stackoverflowdiv').outerHeight(true));//returns 130 
```

**CSS：**

```
#stackoverflowdiv { 
      height:100px; 
      margin:10px 5px; 
      padding:5px; 
      border 2px solid #fff;
}​ 
```

你确定你忘了使用分号或定义`document.ready`吗？或者更糟糕的是忘记定义`margin`or `border`？

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-08-23T14:28:24.917

`outerHeight`只返回一个整数或`null`根据[jQuery DOCs](http://api.jquery.com/outerHeight/)。

> 返回元素的高度，包括顶部和底部填充、边框和可选的边距，以像素为单位。如果在一组空元素上调用，则返回 undefined（在 jQuery 3.0 之前为 null）。

你的代码中一定有其他东西会影响你的输出并让你看到 div 元素。

# ruby - 块变量中的括号

> ID：12093814
> 
> 赞同：8
> 
> 时间：2012-08-23T14:20:49.767
> 
> 标签：ruby, arrays, ruby-1.9.3, parentheses, splat

给定

```
a = [[:a, :b, :c]] 
```

1）我明白这一点

```
a.each{|(x, y), z| p z} # => :b 
```

有两个变量`(x, y)`和`z`，所以第三个元素`:c`被丢弃，并且`z`匹配`:b`。我明白这一点

```
a.each{|(x, y), z| p y} # => nil 
```

`(x, y)`匹配，`:a`因为它不是一个数组，所以它没有元素，所以`y`匹配`nil`。

但是怎么做

```
a.each{|(x, y), z| p x} # => :a 
```

工作？我期待`nil`被退回。

2）为什么返回值是这样的？

```
a.each{|(x, y)| p x} #=> :a
a.each{|(x, y)| p y} #=> :b 
```

我希望他们都回来`nil`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T14:44:58.950

这是因为*并行赋值*的语法。

```
a = [[:a, :b, :c]] 
```

所以`a.each`只有一个元素要迭代，即`[:a, :b, :c]`.

在第一种情况下：

```
(x, y), z = [:a, :b, :c]
#=> x == :a, y == nil, z == :b 
```

这`(x, y)`是一个匹配第一个元素的数组`:a`，并`x`获取它，然后`z`简单地匹配第二个元素`:b`。

在第二种情况下：

```
(x, y) = [:a, :b, :c]
#=> x == :a, y == :b 
```

这里`(x, y)`作为一个完整的数组匹配数组`[:a, :b, :c]`，所以`x`和`y`get分别是`:a`和`:b`。

这就像要求“args + optional args (keyword args) + rest args”组合匹配提供的参数一样。按顺序接受参数就足够聪明了。

另一个聪明的例子：

```
(a,b) = 1,2
=> [1, 2] # array match
#=> a == 1, b == 2

(a,b)=[1,2]
=> [1, 2] # array match
#=> a == 1, b == 2 
```

在上述任何一种情况下，它都会对应该采取的措施做出最好的猜测。

# git - 如果必须使用“git push --force”来推送有什么问题？

> ID：12093817
> 
> 赞同：0
> 
> 时间：2012-08-23T14:20:55.833
> 
> 标签：git, zend-studio

同事必须使用强制更新选项（在 GIT Zend Studio 插件中）——否则我们不会收到他推送的提交。

我认为这对应于`git push -- force`对我来说看起来很危险：

```
--force
Usually, the command refuses to update a remote ref that is not an ancestor of the local     
ref used to overwrite it. This flag disables the check. This can cause the remote  
repository to lose commits; use it with care. 
```

什么配置需要改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:28:43.093

我相信这不是配置的问题，而是工作流程的问题。当您推送时，Git 只会尝试避免您导致远程丢失历史记录（也就是说，使一些过去可以从 HEAD 访问的提交无法从它访问）。如果您必须强制，则意味着您正在重写远程历史记录，这是存储库历史记录被搞砸或不是最新的症状。

必须的典型解决方案实际上是首先使用or`git push -f`更新远程历史记录之上的本地历史记录，这确保您从远程获取最新条目并入本地历史记录（无论是通过合并还是变基）。`git pull``git pull --rebase`

# jquery - JQuery：.focus（）仅在第一次点击时输入？

> ID：12093819
> 
> 赞同：0
> 
> 时间：2012-08-23T14:21:00.480
> 
> 标签：jquery, html, input, focus

我有一个输入文本框，一旦用户单击按钮就会淡入，然后如果用户再次单击按钮就会淡出。每次用户点击按钮时，输入都是焦点，因为通常他们做的第一件事就是打字。问题是输入有一个占位符，当用户再次单击按钮时，占位符在输入淡出时以非常烦人的方式闪烁一次（这仅在用户再次单击按钮时输入聚焦时才会发生）。

所以我昨天整晚都在尝试做的是让输入焦点只在用户第一次点击按钮时，他们第二次点击淡出时，输入不应该集中。

你能帮我实现这个吗？非常感谢！

```
 //takes care of showing search when clicking on add button
jQuery(".add-button").click(function() {

//shows and hides the textbox input
    jQuery(this).siblings(".search-input-form").fadeToggle(200);

 //triggers a focusing on the textbox input
    jQuery(this).next().children(".search-input").focus();

    return false;

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:30:30.820

您可以使用[$.toggle()](http://api.jquery.com/toggle-event/)函数。它在单击时在提供的功能之间交替。

```
$(".add-button").toggle(function() {
        var $input = $(this);

        //shows the textbox input
        $input.siblings(".search-input-form").fadeIn(200);

       //triggers a focusing on the textbox input
       $input.next().children(".search-input").focus();

       return false;
    },
    function() {
        var $input = $(this);

        //hides the textbox input
        $input.siblings(".search-input-form").fadeOut(200);

       // NO FOCUS HERE

       return false;
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T14:31:06.897

切换和：`fadeToggle`_`fadeIn``fadeOut`

```
 jQuery(".search-input-form").click(function () {

        if (jQuery(".search-input-form").css("visibility") = "hidden")
        {
            jQuery(this).siblings(".search-input-form").fadeIn(200);
            jQuery(this).next().children(".search-input").focus();
        }
        else 
        {
            jQuery(this).siblings(".search-input-form").fadeOut(200);
        }
        return false;

    }); 
```

# php - php jquery json 多值

> ID：12093820
> 
> 赞同：-1
> 
> 时间：2012-08-23T14:21:06.933
> 
> 标签：php, json

我正在学习如何使用 jquery 解析 json

PHP

```
foreach($cars as $car)
{       
    $output['carID'][] = $car->carID;
    $output['carName'][] = $car->carName;
}
echo jsonEncode($output); 
```

JSON

```
{"carID":["1","2"],"carName":["BMW","Mercedez Benz"]} 
```

我的 javascript

```
$.getJSON('/cars.php', { carID: carID }, function(data) {
    $.each(data, function(i,item) {
        for(j=0; j < item[item.carName]; j++) {
            console.log(item[item.carName][j]);
        }
    });
}); 
```

我认为我的代码完全错误，因为它不起作用。

我怎样才能得到里面的价值`["1","2"]`？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:30:01.453

这不是您要寻找的“1 的值”。它是*索引 0*处的值，恰好是“1”。

`["1","2"]`是 的值`carID`，它是`array`。

尝试以这种方式访问​​它：

```
alert(item.carID[0]); // will alert "1"
alert(item.carID[1]); // will alert "2" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:39:50.167

据我所知，数组索引在许多语言中都是从“0”开始的，所以你需要这样的东西来获取代码中的数组值；

```
var data = {"carID":["1","2"],"carName":["BMW","Mercedez Benz"]};

$.each(data.carID, function(key, val){
   var i = 0, id;
   while(id = val[i++]) console.log(id);
});

// or just simply use
console.log(data.carID[0]); 
```

# iphone - 为什么 UIWebView 实例不调用 scrollViewDidScroll？

> ID：12093826
> 
> 赞同：12
> 
> 时间：2012-08-23T14:21:16.067
> 
> 标签：iphone, ios, uiwebview

iOS 文档说，[UIWebView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)类符合 UIScrollViewDelegate。但是 UIWebView 实例不会调用`scrollViewDidScroll`其控制器的方法。代表正好由

```
[webView setDelegate:self]; 
```

并被`webViewDidFinishLoad`成功调用。控制器实现了两个委托，UIWebViewDelegate 和 UIScrollViewDelegate，如下所示：

```
@interface WebviewController : UIViewController<UIWebViewDelegate, UIScrollViewDelegate>{
    UIWebView *webView;
} 
```

浏览 SO 会导致该[类别解决方案](https://stackoverflow.com/a/4060249/200212)：

```
@implementation UIWebView(CustomScroll)
- (void) scrollViewDidScroll:(UIScrollView *)scrollView{
    [self.delegate scrollViewDidScroll: scrollView];
}
@end 
```

该类别方法的作用基本相同：调用委托的 scrollViewDidScroll 方法。那么为什么第一种方法不起作用呢？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-23T14:37:04.347

我的猜测是您仅为 UIWebView 设置委托。尝试设置滚动视图的委托。

```
webView.scrollView.delegate = self 
```

应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-20T09:31:40.727

这是不正确的。如果您将使用：

```
@implementation UIWebView(CustomScroll)
- (void) scrollViewDidScroll:(UIScrollView *)scrollView{
    [self.delegate scrollViewDidScroll: scrollView];
}
@end 
```

尝试在 iOS7 等页面上输入数据时会失去焦点

您需要为 UIWevView 实现自定义类并覆盖 scrollViewDidScroll：

```
- (void) scrollViewDidScroll:(UIScrollView *)scrollView{
[super scrollViewDidScroll:scrollView];
[((id<UIScrollViewDelegate>)self.delegate) scrollViewDidScroll:scrollView];} 
```

# iphone - 加入多个 ALAC 文件。

> ID：12093831
> 
> 赞同：1
> 
> 时间：2012-08-23T14:21:25.370
> 
> 标签：iphone, objective-c, ios, macos, audiotoolbox

我能够加入多个 CAF 文件，其中包含编码的 PCM 音频。首先，我从一个 CAF 文件中读取数据格式。

```
UInt32 size = sizeof(srcFormatDescription);
        status = AudioFileGetProperty(srcAudioFile, kAudioFilePropertyDataFormat, &size, &srcFormatDescription); 
```

PCM 数据格式看起来像这样

```
[Line 7697] mSampleRate: 44100.000000
[Line 7698] mFormatID: 1819304813d
[Line 7699] mFormatFlags: 12d
[Line 7700] mBytesPerPacket: 2d
[Line 7701] mFramesPerPacket: 1d
[Line 7702] mBytesPerFrame: 2d
[Line 7703] mChannelsPerFrame: 1d
[Line 7704] mBitsPerChannel: 16d
[Line 7705] mReserved: 0d 
```

然后我为目标文件设置数据格式，其中将包含所有 CAF。

```
destFormatDescription = srcFormatDescription;
status = AudioFileCreateWithURL(dest, kAudioFileCAFType, &destFormatDescription, kAudioFileFlags_EraseFile, &destAudioFile); 
```

在下一步中，我从 CAF 读取数据

```
status = AudioFileReadBytes(srcAudioFile,
                                    FALSE,
                                    currentStartForReading,
                                    &bytesNumberToRead,
                                    buffer); 
```

并将其写入 destAudioFile

```
status = AudioFileWriteBytes(destAudioFile,
                                     FALSE,
                                     writePosition,
                                     &bytesNumberToWrite,
                                     buffer); 
```

这些步骤是循环完成的。它工作得很好。但是我有一个大问题，现在我尝试对包含 ALAC 格式数据的 CAF 文件执行相同的步骤。它不起作用。不支持 AudioFileWriteBytes 返回错误操作。

对于 ALAC 数据格式看起来像这样

```
[Line 7697] mSampleRate: 44100.000000
[Line 7698] mFormatID: 1634492771d
[Line 7699] mFormatFlags: 1d
[Line 7700] mBytesPerPacket: 0d
[Line 7701] mFramesPerPacket: 4096d
[Line 7702] mBytesPerFrame: 0d
[Line 7703] mChannelsPerFrame: 1d
[Line 7704] mBitsPerChannel: 0d
[Line 7705] mReserved: 0d 
```

有人知道如何加入多个 CAF 文件，里面有 Apple Lossless 数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T07:31:53.157

> 我能够加入多个 CAF 文件，其中包含编码的 PCM 音频。首先，我从一个 CAF 文件中读取数据格式。

如果 ASBD 匹配，那么您的音频文件将是正确的。但是，如果输入文件的示例格式不匹配，那么您的数据将会损坏。这是因为每个 CAF 文件只定义了一个样本数据块和一个音频描述块。

因此，试图将多种格式的样本数据附加到一个音频数据块中是错误的。（未指定是否是您正在尝试的内容）

此外，压缩格式还有一个必须设置的附加字段 - 即魔术 cookie。所有 cookie 都必须相等（顺便说一句，这是一种不透明的数据表示）。

最后，写入压缩数据的正确方法是使用数据包表块。VBR/VFR 格式必须准确指定一个数据包表块。

> 有人知道如何加入多个 CAF 文件，里面有 Apple Lossless 数据吗？

What this all means: There will be a high failure rate using the approach you have chosen in the case of ALAC. As well, there's a lot that goes into keeping these files and their chunks correctly synchronized with all the Packet detail that is involved.

So, let's approach this from another angle:

*   use `ExtAudioFileCreateWithURL` to create a new ALAC file
*   use `ExtAudioFileOpenURL` to open your input files
*   determine a common sample format from your input files
*   use `ExtAudioFileSetProperty` + `kExtAudioFileProperty_ClientDataFormat` to specify the common PCM format
*   Configure the destination/ALAC file's convertor to expect the common PCM format you have chosen.
*   read an input file's sample data, writing to the destination
*   repeat for remaining files
*   close all files

That should be it (but it will probably require a few hundred lines of code, if you are dealing with the raw AudioFile APIs).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T11:02:00.153

I am wondering why you haven't tried using `AVAssetExportSession` ,`AVMutableComposition`, `AVAsset`,`AVMutableCompositionTrack` . I can suggest you to follow below steps to combine/merge different audio files.

1.  Load each audio file using its URL into `AVAsset`.
2.  Initialize `AVMutableComposition` object using below code.

    ```
    AVMutableComposition* mixComposition = [[AVMutableComposition alloc] init]; 
    ```

3.  Add mutable audio track to mutable composition like below.

    ```
    AVMutableCompositionTrack *AudioTrack = [mixComposition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid]; 
    ```

4.  Add asset time range to `AudioTrack` as below.

    ```
    [AudioTrack insertTimeRange:CMTimeRangeMake(kCMTimeZero, CMTimeAdd(firstAsset.duration, secondAsset.duration)) ofTrack:[[audioAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0] atTime:kCMTimeZero error:nil]; 
    ```

5.  Create `AVAssetExportSession` and merge all audio files below code.

    ```
    // Prepare final exporter for merging
    AVAssetExportSession *exporter = [[AVAssetExportSession alloc] initWithAsset:mixComposition AVAssetExportPresetAppleM4A];
    exporter.outputURL = outputURL;
    exporter.outputFileType = AVFileTypeAppleM4A;
    exporter.videoComposition = mainCompositionInst;
    exporter.shouldOptimizeForNetworkUse = YES;

    // Notify caller that merging process is about tro start
    [self.delegate handler:self didStartMergingAtPath:[outputURL path]];

    [exporter exportAsynchronouslyWithCompletionHandler:^ {
         dispatch_async(dispatch_get_main_queue(), ^{
             [self exportDidFinishMerging:exporter];
         });
     }]; 
    ```

6.  Also implement method to check the status of export process.

    ```
    - (void)exportDidFinishMerging:(AVAssetExportSession*)session {
    if(session.status == AVAssetExportSessionStatusCompleted){
    // notify the calling class that merging is finished
    [self.delegate handler:self didFinishMergingAtPath:[session.outputURL path]];
       }
    } 
    ```

NOTE: Please take a note that this is not sample code which you can directly use into your code but this is just for understanding purpose. Hope this may help you.

# sql-server-2008 - 在 SQL Server 存储过程中创建动态 where 子句

> ID：12093834
> 
> 赞同：1
> 
> 时间：2012-08-23T14:21:29.023
> 
> 标签：sql-server-2008

我正在尝试创建一个存储，它将接受两个值，一个列名和一个值。然后它将检查是否存在具有传入值的传入列名的记录。我试过以下

```
CREATE PROCEDURE p_HasActiveReference
     @pi_colName varchar(100)
    ,@pi_colValue varchar(100)
AS
BEGIN
SET NOCOUNT ON      
    declare @sql varchar(1000)

    set @sql = 'IF EXISTS(SELECT TOP 1 p.PaymentId
                FROM Payments p
                WHERE ' + @pi_colName + ' = ' + @pi_colValue +     'AND Active = 1)

                    SELECT ''True'' AS RETVAL
                ELSE
                    SELECT ''False'' AS RETVAL'
    exec(@sql)  
 END 
```

但是，我总是收到此错误

> *将 varchar 值“InternalOr”转换为数据类型 int 时转换失败。*

当我使用以下方法调用该过程时

```
p_HasActiveReference 'InternalOrgCode', '10110' 
```

该`internalOrgCode`列是有价值的`varchar(10)`

我不是 SQL 专家，所以我什至不确定使用该技术是否可以实现我需要实现的目标！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:40:09.980

至少有一个问题：您应该用单引号括住您的字符串值，并且要转义字符串中的那些值，您需要将它们加倍：

```
WHERE ' + @pi_colName + ' = ''' + @pi_colValue + ''' AND ... 
```

您可能还想将您的 @sql 变量声明为大于 100 个字符！看起来你的字符串被截断了。

如果@pi_colName 的可能值是有限的，数据类型始终是字符串，并且列是排序规则兼容的，您可以这样做并避免使用动态 SQL：

```
SELECT ...
WHERE CASE @pi_colName 
  WHEN 'col1' THEN col1
  WHEN 'col2' THEN col2
END = @pi_ColValue; 
```

# html - CSS first-child 和 last-child 在同一个元素上使用时不起作用

> ID：12093836
> 
> 赞同：21
> 
> 时间：2012-08-23T14:21:31.770
> 
> 标签：html, css, css-selectors

我刚刚注意到 CSS在`:first-child`同`:last-child`一个元素上使用时不起作用。只使用一个。我想知道为什么会这样，CSS中是否有任何解决方法？对我来说，这似乎是 CSS 错误——第一个元素也可以是最后一个元素。

我在 Google 上找不到关于该主题的任何内容。每个教程都假定至少有 2 个元素。

我正在寻找类似的东西：“第一个孩子也是最后一个孩子”选择器。它存在吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-23T14:22:45.177

> 我想知道为什么会这样，CSS中是否有任何解决方法？对我来说，这似乎是 CSS 错误——第一个元素也可以是最后一个元素。

这不是一个错误。这就是级联的工作方式：如果一个元素既是第一个子元素又是最后一个子元素，那么如果你有单独的*规则*`:first-child`并且它们都匹配同一个元素，那么后面声明的或更具体的规则中的任何内容都将覆盖另一个。`:last-child`

 *[您可以在此处](https://stackoverflow.com/questions/11537901/last-child-style-over-rides-first-child-style-when-only-one-child-is-available)找到此行为的示例，其中包含`border-radius`速记属性，以及包括使用组件属性而不是速记的解决方法，以及使用以下选择器之一完全指定单独的规则...

> 我正在寻找类似的东西：“第一个孩子也是最后一个孩子”选择器。它存在吗？

从字面上看，您可以像这样链接两个伪类，效果很好：

```
:first-child:last-child 
```

然而，存在一个特殊的伪类，其行为方式相同：

```
:only-child 
```

这两个选择器之间的主要区别（事实上，*唯一*的区别）是特异性：第一个选择器更具体，因为它包含一个额外的伪类。即使在浏览器支持方面也没有区别，因为每个浏览器的完全相同版本都支持`:last-child`和。`:only-child`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-26T01:23:35.233

我意识到我对此很晚了，但你也可以使用 CSS`:first-of-type`和`:last-of-type`. 例如：

```
<blockquote>
  <p>Some text you want to quote</p>
</blockquote> 
```

此 CSS 将在段落中添加引号：

```
blockquote{
  quotes: "“" "”" "‘" "’";
}

blockquote p:first-of-type:before{
  content:open-quote;
}

blockquote p:last-of-type:after{
  content:close-quote;
} 
```*

# ruby-on-rails-3.2 - 使用 Rails 引擎扩展 ActiveAdmin

> ID：12093837
> 
> 赞同：0
> 
> 时间：2012-08-23T14:21:33.133
> 
> 标签：ruby-on-rails-3.2, activeadmin, rails-engines

我正在尝试扩展 ActiveAdmin 界面并使用 Rails 插件向菜单添加另一个可重用资源。

我创建了一个新的完整引擎：

```
# Not mountable because it build up on ActiveAdmin
rails plugin new activeadmin-files --full 
```

然后我在我的引擎中添加了一个文件`lib/activeadmin-files/admin/files.rb`：

```
ActiveAdmin.register_page "Files" do
  menu :label => "File Management"

  content do
    para "Hello File Manager"
  end
end 
```

我按照 ActiveAdmin [Wiki](https://github.com/gregbell/active_admin/wiki/Define-a-resource-inside-an-engine)中的描述将资源添加到引擎。我修改`engine.rb`如下：

```
module ActiveadminFiles
  class Engine < ::Rails::Engine
    initializer :files do
      ActiveAdmin.application.load_paths += Dir[File.dirname(__FILE__) + 'activeadmin-files/admin']
    end
  end
end 
```

唯一的区别是我的引擎是一个完整的引擎，而维基页面上的引擎是一个可安装的引擎。

问题：`files.rb`当我打开 ActiveAdmin 界面时，没有出现中定义的页面。我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:03:39.153

这看起来应该可以工作。我认为它不起作用的唯一原因是初始化程序实际上没有在应用程序启动时运行。

您能否在初始化程序块中输出一些日志记录并确保代码实际运行？

# php - 登录后设置 Symfony2 security.context 用户数据

> ID：12093847
> 
> 赞同：3
> 
> 时间：2012-08-23T14:22:11.743
> 
> 标签：php, symfony

使用 Symfony2 我想`security.content`在登录后使用登录后获得的信息来扩充用户。

因此，在登录成功代码中，我执行以下操作`AccountController`：

```
$user = $this->get('security.context')->getToken()->getUser();

// Get everything we'll ever need for this user
$user->fillDetails($this, $this->container);

$token = new UsernamePasswordToken($user, null, 'main', $user->getRoles());

// Give it to the security context
$this->container->get('security.context')->setToken($token);

return $this->redirect($this->generateUrl('AccountBundle_homepage')); 
```

如果我在调用此信息后立即再次检索用户`setToken()`，则在 User 对象中设置的信息`fillDetails()`仍然存在。

`AccountBundle_homepage`但是在我让用户使用时的控制器操作中

```
$user = $this->get('security.context')->getToken()->getUser(); 
```

我设置的额外信息`fillDetails()`不再存在，或者`0`。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:35:23.270

安全上下文会在每个请求上创建一个令牌，这意味着您不能修改令牌、重定向用户并期望在前一个令牌上获取数据集。如果你不坚持你的用户，它就行不通。用户也会在每个请求上重新加载。

您可以在此处找到有关令牌的更多信息：http: [//symfony.com/doc/current/cookbook/security/custom_authentication_provider.html#the-token](http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html#the-token)

# c - 使用Xcode跳转到StdLib的源代码

> ID：12093855
> 
> 赞同：4
> 
> 时间：2012-08-23T14:22:28.693
> 
> 标签：c, xcode, macos, ctags

当我按住 ctrl 键单击诸如 malloc 之类的 stdlib 函数时，我会转到头文件中的定义。这是我所期望的行为。

[我有从Apple OpenSource](http://www.opensource.apple.com/release/mac-os-x-1074/)下载的 stdlib 的正确 Darwin 源代码- 特别是：

```
Libc-763.13 
```

这些已在 /usr/src 中解压缩。malloc 例程的源代码在这里：

```
Libc-763.13/gen/malloc.c : line 948 
```

所以问题是，当我在我的一个程序中单击 malloc 时，如何教 Xcode 跳转到源代码？

在过去，我生成了用于 Vim 的 ctags 文件，这给了我这个功能。有没有办法用 Xcode 做类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T22:22:21.333

跳转到定义的命令+单击导航应该适用于所有 Xcode 项目中的所有符号。

如果没有，[此答案](https://stackoverflow.com/a/10306634/233201)将描述您如何修复它。

# php - Magento PHP SQL 查询从特定类别（包括儿童）中提取产品

> ID：12093858
> 
> 赞同：0
> 
> 时间：2012-08-23T14:22:38.227
> 
> 标签：php, mysql, magento

我目前处于紧要关头，需要对我网站上的一些现有代码进行调整。有一个 PHP SQL 查询需要修改以从特定类别中提取产品。然后将该列表输入 HTML 产品轮播。无论如何，目前它正在拉入所有带有图像的产品。

```
<?php
 $query = mysql_query("SELECT * FROM `catalog_product_flat_1` WHERE `small_image` != 'no_selection'");
 //$query = mysql_query("SELECT * FROM `catalog_product_flat_1` WHERE `category_ID` = 16");
 while($fins = mysql_fetch_array($query)) {
                ?> 
```

注释的代码行是我试图做的，但没有运气。我在这里在黑暗中拍摄。从任何标准来看，我都不是 Magento 或 PHP 专家。仅供参考，前端显示我想要的类别的类别 ID 为 16。按名称提取它会很好，但为了简单/速度起见，我可以使用 ID。

感谢您的任何帮助。

（更新 8-27）整个 HTML 代码块：

```
<div class="whiteGradientLarge span-10">
    <div class="content">
        <h2>Latest Products</h2>
        <div class="span-10">
            <a href="#" class="prev left"><img src="assets/arrowPrev.png" /></a>
            <ul class="productSlider push-1">

                <?php
                //$query = mysql_query("SELECT * FROM `catalog_product_flat_1` WHERE `small_image` != 'no_selection'");
                //while($products = mysql_fetch_array($query)) {
                $category = new Mage_Catalog_Model_Category();
                $category->load('16'); //your category id here, 16 $catid
                $prodCollection = $category->getProductCollection();
                foreach ($prodCollection as $product) {
                //get all the product information here... //}
                    ?>
                    <li class="roundabout-moveable-item">
                    <h3><a href="http://www.mywebsite.com/store/products/<?php echo $product['url_path']; ?>"><?php echo $product['name']; ?></a></h3> 
                    <img src="https://www.mywebsite.com/store/media/catalog/product<?php echo $product['small_image']; ?>" />
                    <span class="productTitle span-3"><?php  ?></span>
                    </li>
                <?php 
                } ?>
            </ul>
            <a href="#" class="next right"><img src="assets/arrowNext.png" /></a>
        </div>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T15:11:39.047

```
$category = new Mage_Catalog_Model_Category();
$category->load($catid); //your category id here, 16
$prodCollection = $category->getProductCollection();
foreach ($prodCollection as $product) {
    //get all the product information here...

    ?>
    <li class="roundabout-moveable-item">
         <h3><a href="http://www.mywebsite.com/store/products/<?php echo $product->getUrlPath(); ?>"><?php echo $product->getName(); ?></a></h3> 
         <img src="https://www.mywebsite.com/store/media/catalog/product<?php echo $product->getSmallImage(); ?>" />
         <span class="productTitle span-3"><?php  ?></span>
    </li>
 <?php 
} 
```

# unit-testing - Groovy-grails 模拟问题。无法模拟

> ID：12093862
> 
> 赞同：2
> 
> 时间：2012-08-23T14:22:56.470
> 
> 标签：unit-testing, grails, groovy, junit, mocking

我在我的 grails 项目中有一个服务类方法，它使用一个帮助类来获取 xml 的响应。然后将 xml 作为服务类方法的响应发送出去。

服务等级：-

```
class ItemService{
def getItem(Number) {
        def HelperClass helper = new HelperClass()
        def responseXml = helper.getMessage(Number)                 
        return responseXml
    }
} 
```

我为此方法编写了一个测试用例。在我的测试用例中，我希望模拟

```
 def responseXml = helper.getMessage(Number) 
```

到目前为止我写的测试用例是：

```
class ItemServiceTest extends GroovyTestCase {
public final void testFindItem(){
        def service = new ItemService()

        def xml = "<Item><Number>123</Number></Item>"

        def mockJobServiceFactory = new MockFor(HelperClass)
        mockJobServiceFactory.demand.getMessage{ def str ->
            return xml
        }
        service.getItem().HelperClass =  mockJobServiceFactory.proxyInstance()

        def item = service.getItem()("123")
        assertNotNull(item)
    } 
```

但是，模拟仍然没有返回我在测试用例中指定的 xml。您在上述方法中看到的任何问题？...提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:48:25.877

当您使用 模拟对象时[`MockFor`](http://groovy.codehaus.org/gapi/groovy/mock/interceptor/MockFor.html)，您需要将使用模拟的代码包围在一个`use`闭包中。试试这个：

```
def service = new ItemService()

def xml = "<Item><Number>123</Number></Item>"

def mockJobServiceFactory = new MockFor(HelperClass)
mockJobServiceFactory.demand.getMessage{ def str ->
    return xml
}

mockJobServiceFactory.use {
    def item = service.getItem()("123")
    assertNotNull(item)
} 
```

# android - 将文件从文件系统附加到应用程序

> ID：12093866
> 
> 赞同：0
> 
> 时间：2012-08-23T14:23:05.607
> 
> 标签：android, file-management

如何实现将文件从文件系统附加到我的应用程序的功能。我可以使用一些库，还是我应该自己编程？或者我可以实现其他类似应用程序的代码并使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:27:41.177

**文件浏览器：**

[关联](https://stackoverflow.com/questions/4895104/file-browser-in-android)

文件浏览器的示例代码。或者你可以让用户输入位置`EditText`并让应用记住它。

要使用外部存储（如 SD 卡），请参阅[此处](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)

**记住文件位置：**

[使用共享首选项](http://developer.android.com/guide/topics/data/data-storage.html#pref)

它是一种比 SQLite 数据库更简单的方式来保存持久性数据

**发送到服务器：**

[关联](https://stackoverflow.com/questions/4943246/android-post-file-and-text)

这是一个如何使用 HTTP POST 发送到服务器的示例

# android - Android：旋转屏幕和对话框打开时出现WindowLeaked

> ID：12093868
> 
> 赞同：1
> 
> 时间：2012-08-23T14:23:16.090
> 
> 标签：android, dialog

当您单击我活动中的图像时，我会弹出一个对话框。当对话框打开并且用户旋转屏幕时，我的 LogCat 中显示以下内容：

```
08-23 09:47:47.151: E/WindowManager(15589): Activity my.activity.MyActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@43554748 that was originally added here
08-23 09:47:47.151: E/WindowManager(15589): android.view.WindowLeaked: Activity my.activity.MyActivity has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@43554748 that was originally added here
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.ViewRoot.<init>(ViewRoot.java:247)
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.Window$LocalWindowManager.addView(Window.java:424)
08-23 09:47:47.151: E/WindowManager(15589):     at android.app.Dialog.show(Dialog.java:241)
08-23 09:47:47.151: E/WindowManager(15589):     at tip.machine.MyActivity$8.onClick(MyActivity.java:385)
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.View.performClick(View.java:2408)
08-23 09:47:47.151: E/WindowManager(15589):     at android.view.View$PerformClick.run(View.java:8816)
08-23 09:47:47.151: E/WindowManager(15589):     at android.os.Handler.handleCallback(Handler.java:587)
08-23 09:47:47.151: E/WindowManager(15589):     at android.os.Handler.dispatchMessage(Handler.java:92)
08-23 09:47:47.151: E/WindowManager(15589):     at android.os.Looper.loop(Looper.java:123)
08-23 09:47:47.151: E/WindowManager(15589):     at android.app.ActivityThread.main(ActivityThread.java:4627)
08-23 09:47:47.151: E/WindowManager(15589):     at java.lang.reflect.Method.invokeNative(Native Method)
08-23 09:47:47.151: E/WindowManager(15589):     at java.lang.reflect.Method.invoke(Method.java:521)
08-23 09:47:47.151: E/WindowManager(15589):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
08-23 09:47:47.151: E/WindowManager(15589):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
08-23 09:47:47.151: E/WindowManager(15589):     at dalvik.system.NativeStart.main(Native Method) 
```

我所做的是通过编写全局声明对话框`Dialog dialog`，在我的 中`onPause`，我写了这个：

```
@Override
protected void onPause() {
    System.out.println("IN PAUSE!");
    try {
        dialog.dismiss();
        System.out.println("IN TRY!");
    }
    catch   (java.lang.NullPointerException exception)  {System.out.println("IN CATCH!");}
    super.onPause();
} 
```

我想，如果`dialog`没有实例化，catch 块会捕获错误。无论如何，每次我旋转时，无论对话框是否打开，我都只进入 catch 块。当对话框打开并旋转时，我得到与上面相同的堆栈跟踪（它直接进入 catch 块）。因此，它似乎从未尝试过`dialog.dismiss()`，这就是为什么我仍然收到`WindowLeaked`消息的原因。

有任何想法吗？我的变量声明/实例化一定有问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:27:58.163

没关系，我明白了。问题是，我有两个图像都使用相同的对话框变量（在触摸时实例化它并启动它们自己的对话框）。所以第二个图像是通过再次声明它来引用对话框`final Dialog dialog ...`。`dialog`在我创建一个全局变量之前，我就是这样的。

去掉重新声明后，一切都完美了。

顺便说一句，对于只能在不同时间启动的两个不同对话框使用相同的对话框变量是否有任何风险？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-13T20:38:54.310

如果您是屏幕将横向更改为纵向或纵向更改为横向，则此原因在重绘视图之前**重绘**您的视图，您必须关闭您的对话框

因此，请尝试将此属性添加`android:configChanges="orientation"`到 AndroidManifest.xml 文件中的 Activity 元素。

# asp.net - SqlDataSource 在变量后面插入代码

> ID：12093870
> 
> 赞同：4
> 
> 时间：2012-08-23T14:23:25.647
> 
> 标签：asp.net, .net, sqldatasource

我有以下 SqlDataSource

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
        ConnectionString="<%$ ConnectionStrings:orangefreshConnectionString1 %>" 
        InsertCommand="INSERT INTO [Chat] ([Username], [Message]) VALUES (@Username, @Message)" 
        SelectCommand="SELECT [Id], [Username], [Message], [Date] FROM [Chat] ORDER BY [Id]" >
        <InsertParameters>
            <asp:Parameter Name="Message" Type="String" />
            <asp:Parameter Name="Date" Type="DateTime" /> 
            <asp:Parameter Name="Username" Type="String" />
        </InsertParameters>
    </asp:SqlDataSource> 
```

其中控制以下FormView：

```
<asp:FormView ID="FormView1" runat="server" DefaultMode="Insert"
        OnItemInserted="fv_ItemInserted" RenderOuterTable="False" 
            DataSourceID="SqlDataSource1">
        <InsertItemTemplate>
            <asp:Panel ID="Panel1" runat="server" DefaultButton="Button1">
            <asp:TextBox ID="TextBox1" runat="server" CssClass="chattxtbox"
            Text='<%# Bind("Message") %>' autocomplete="off"></asp:TextBox>
        <asp:Button ID="Button1" runat="server" CommandName="insert" style="display:none" Text="Button" OnClick="insertUser"/>
            </asp:Panel>
        </InsertItemTemplate>
        </asp:FormView> 
```

我希望能够将变量的内容放入用户名列，所以在 Button1 上我设置了以下事件： OnClick="insertUser"

```
 protected void insertUser(object sender, EventArgs e)
    {
        string username1 = User.Identity.Name;
        SqlDataSource1.InsertParameters.Add("Username", username1);
        SqlDataSource1.Insert();
    } 
```

但这不起作用，我根本没有收到任何 SQL 错误消息，这是正确的方法吗？我哪里做错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:31:29.987

将插入更改`Parameter`为`SessionParameter`。

```
<InsertParameters>
   <asp:Parameter Name="Message" Type="String" />
   <asp:Parameter Name="Date" Type="DateTime" /> 
   <asp:Parameter Name="Username" Type="String" />
   <asp:SessionParameter Name="Username" SessionField="Username" Type="String" />
</InsertParameters> 
```

在 Page_Load 处理程序中，

```
Session["Username"]=User.Identity.Name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:35:50.607

在这里，您要将参数声明为[控制参数](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter.aspx)，然后您不需要在代码中将值分配给参数。你可以调用插入。

# liferay - 登录 Portlet Hook，找不到类 PwdEncryptor

> ID：12093874
> 
> 赞同：1
> 
> 时间：2012-08-23T14:23:28.850
> 
> 标签：liferay, liferay-6

我为登录 portlet 创建了一个钩子。

我对这行代码有疑问：

```
String encPwd = PwdEncryptor.encrypt(password, user.getPassword()); 
```

找不到类 PwdEncryptor 并且包`com.liferay.portal.security.pwd`不存在

我使用 Liferay 6.0.6 插件创建了一个钩子，我读到了这个：

[开发 CAS](http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/Developing+a+Custom+Authentication+System)（自定义认证系统）

和：

[https://www.liferay.com/es/community/forums/-/message_boards/message/14773767](https://www.liferay.com/es/community/forums/-/message_boards/message/14773767)

> PwdEncryptor 位于 portal-impl.jar 中，因此插件不可见。您可以使用 PortalClassInvoker 来调用它。如果您需要示例，请查看 com.liferay.portal.kernel.struts.PortletActionInvoker 类。

我不知道如何处理这个调用程序，在哪里调用或使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:24:14.693

集成 PwdEncryptor 和 Crypt。

# ajax - 连接到 AJAX 文件。Joomla

> ID：12093882
> 
> 赞同：0
> 
> 时间：2012-08-23T14:24:06.667
> 
> 标签：ajax, plugins, joomla, connect

由于（_JEXEC），我无法连接到 ajax conf.php 文件，然后我使用 jquery 代码：

```
$.ajax
({
type: "POST",
url: "conf.php",
data: dataString,
cache: false,
success: function(html)
{
$("#flash").fadeOut("slow");
$("#content").html(html);
} 
});
}); 
```

如何以其他工作方式连接到该文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:14:54.433

代码`defined( '_JEXEC' ) or die( 'Restricted access' );`通常限制ajax

功能，因此您将需要使用`define('_JEXEC', 1);`

请注意，您需要使用`define`，而不是`defined`

# jquery - 在源 div 上隐藏 appendTo 将项目拖动到其他 div

> ID：12093887
> 
> 赞同：1
> 
> 时间：2012-08-23T14:24:31.060
> 
> 标签：jquery, jquery-ui, drag-and-drop

我有两个 div：*navpane*和*contentpane*。*navpane*包含项目列表。这些项目被标记为可拖动的选项`appendTo:'#contentpane'`。我选择`#contentpane`了此选项而**不是**正文，因为仅在此窗格内滚动以防溢出。

一切正常，但有一个视觉缺陷。在拖动操作期间，拖动的项目仅在内容窗格区域中可见，而在导航窗格区域中也不可见。

有了`appendTo:'body'`它就可以了，但是整个浏览器窗口的滚动条就会出现。

这是代码片段：

```
$(".item").draggable({
    helper: 'clone',
    cursor: 'move',
    scroll: true,
    appendTo: '#contentpane'
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:10:44.117

您可以设置`containment:'document'`可拖动并使用`appendTo:'body'`它应该停止出现滚动条。例如：

```
$(".item").draggable({
    helper: 'clone',
    appendTo: 'body',
    cursor: 'move',
    containment:'document'
}); 
```

出现问题是因为绝对定位的容器正在创建新的、单独的堆叠上下文，并且可拖动对象被附加到具有较低堆叠顺序的东西上。

**编辑：替代解决方案 - [jsFiddle 演示](http://jsfiddle.net/v7a8Y/)**

如果您真的想在*contentpane*上保留滚动条，我能想到的唯一解决方案是必须更改标记以将导航窗格移动到*contentpane**内*，以便它们共享相同的堆叠上下文。所以我不得不牺牲一些语义结构来保持滚动条在*contentpane*上。另一个问题是滚动条会在我使用时在*导航窗格*下消失。我认为这比看到整个窗口底部的滚动要好。***`position:fixed`***

 ***### HTML

```
<div id="contentpane">
    <div id="navpane">
      <div class="item">Item A</div>
      <div class="item">Item B</div>
      <div class="item">Item C</div>
      <div class="item">Item D</div>
    </div>
</div> 
```

### CSS

```
.item {
    border: 1px solid black;
    width:200px;
    margin-top: 5px;
}

#navpane {
    background-color:lightblue;
    width:250px;
    position:fixed;
    top:0;
    bottom:0;
    left:0;
}

#contentpane {
    background-color:lightgreen;
    position:absolute;
    top:0;
    right:0;
    bottom:0;
    left:0;
    overflow-x:auto;
    overflow-y:hidden;
} 
```

### JavaScript

```
$(function () {
  $('.item').draggable({
      helper: 'clone',
      appendTo: '#contentpane',
      cursor: 'move'
  });
}); 
```***

# ravendb - C# RavenDB 删除

> ID：12093891
> 
> 赞同：-1
> 
> 时间：2012-08-23T14:24:42.340
> 
> 标签：ravendb

我有以下对象：WordOccurrence，它有两个属性： - 字符串单词。- int 出现次数。我想执行以下操作，但不会出现异常（-: WordOccurrence w1 = new WordOccurrence() {Word ="Hey", Occurrence = 1}; WordOccurrence w2 = new WordOccurrence() {Word ="Hey", Occurrence = 1};

现在我想存储第一个，w1，但用 w2 删除他。

session.store(w1); session.delete(w2); -> 得到异常...

可能吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:26:36.140

请尝试格式化您问题中的代码，并重新表述您要执行的操作。目前尚不清楚您是否期望 save`w2`应该引用与 相同的对象`w1`，但它们不是——即使 ID 相同，Raven 也不会处理删除。*您需要在调用 SaveChanges 后立即*删除刚刚存储的对象（我不明白您为什么要这样做），或者在更可能的情况下`Load`稍后再调用`Delete`：

```
var w1Id = string.empty;
using(session)
{
  var w1 = new WordOccurrence { Word="Hey", Occurrence=1};
  session.store(w1);
  session.SaveChanges();
  w1Id = w1.Id; 
  //if you aren't declaring the Id property for some reason...
  w1Id = session.Advanced.GetDocumentId(w1);
}

//somewhere else in the code
using(session)
{
  var w1 = session.Load<WordOccurrence>(w1Id);
  session.Delete(w1);
  session.SaveChanges();
} 
```

底线是你不能删除你刚刚告诉会话的东西`Store`，在你打电话之前`SaveChanges`。如果您尝试撤消`Store`操作，可能是因为用户点击了撤消按钮，请不要调用`SaveChanges`（如果它是会话中的唯一操作），或者用于`Session.Advanced.Evict(w1)`从会话中退出该对象。

如果您希望 Word 属性成为文档的 Id，您可以通过[自定义 DocumentStore 约定来实现](https://groups.google.com/forum/#!topic/ravendb/Ly10rvbVrcM)

# android - 拍照然后发邮件

> ID：12093896
> 
> 赞同：0
> 
> 时间：2012-08-23T14:25:13.293
> 
> 标签：android, android-intent, android-camera

我正在尝试创建一个应用程序，您可以在其中拍照然后通过电子邮件将其发送给某人。目前我可以拍照并将我的背景设置为这张照片：

```
public class Camera extends Activity implements View.OnClickListener{

ImageButton ib;
Button b;
ImageView iv;
Intent i;
final static int cameraData = 0;
Bitmap bmp;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.photo);
    initialize();
    InputStream is = getResources().openRawResource(R.drawable.ic_launcher);
    bmp = BitmapFactory.decodeStream(is);
}

private void initialize(){
    ib = (ImageButton) findViewById(R.id.ibTakePic);
    b = (Button) findViewById(R.id.bSetWall);
    iv = (ImageView) findViewById(R.id.ivReturnedPic);
    b.setOnClickListener(this);
    ib.setOnClickListener(this);

}

@Override
public void onClick(View v) {
    File mImageFile;
    // TODO Auto-generated method stub
    switch(v.getId()){
    case R.id.bSetWall:
        try {
            getApplicationContext().setWallpaper(bmp);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    break;
    case R.id.ibTakePic:
        i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        startActivityForResult(i, cameraData);
    break;
    }

}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);
    if(resultCode == RESULT_OK){
        Bundle extras = data.getExtras();
        bmp = (Bitmap)extras.get("data");
        iv.setImageBitmap(bmp);
    }
}

} 
```

我有一个单独的应用程序，我可以在其中接收用户输入并将其通过电子邮件发送到预定义的地址：

```
 public void onClick(View v) {
    // TODO Auto-generated method stub
    convertEditTextVarsIntoStringsAndYesThisIsAMethodWeCreated();
    String emailaddress[] = { "info@sklep.com", "", };
    String message = emailAdd + name + beginning;

    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, emailaddress);

    emailIntent.setType("plain/text");
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message);
    startActivity(emailIntent);

} 
```

如何通过电子邮件发送我拍摄的照片？它保存在哪里以及如何访问它以便我可以通过电子邮件发送它？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:37:39.900

```
 @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);
        if(resultCode == RESULT_OK){
    File dir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);
                File output = new File(dir, "camerascript.png");
                cPath = output.getAbsolutePath();
                Bitmap b =  BitmapFactory.decodeFile(cPath);
                Bitmap out = Bitmap.createScaledBitmap(b, 320, 480, false);
                FileOutputStream fout;
                try{
                    fout = new FileOutputStream(output);
                    out.compress(Bitmap.CompressFormat.PNG, 100, fout);
                    fout.flush();
                    fout.close();
                    b.recycle();
                    out.recycle();
                }catch(Exception e){
                    e.printStackTrace();
                }

        }
    } 
```

之后在您的发送邮件方法中

```
public void sendMail(){
        Log.e("sendMail", "v r in sendMail");

        i = new Intent(Intent.ACTION_SEND);
        i.setType("plain/text");
            i.putExtra(Intent.EXTRA_EMAIL, new String[] {"abc@gmail.com"});
          i.putExtra(Intent.EXTRA_SUBJECT,"subject...");
        i.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(new File(cPath));
        i.putExtra(Intent.EXTRA_TEXT, "Body of Email....");
        startActivityForResult(Intent.createChooser(i, "send mail...."),EMAIL_SUCCESS);

    } 
```

上面的代码将帮助你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:05:53.180

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);
    if(resultCode == RESULT_OK){
     Uri uri=data.getData();
     sendmail(uri); 
```

}

```
and 
  private void sendmail(Uri uri)
  {
    i = new Intent(Intent.ACTION_SEND);
    i.setType("plain/text");
    i.putExtra(Intent.EXTRA_EMAIL, new String[] {"abc@gmail.com"});
    i.putExtra(Intent.EXTRA_SUBJECT,"subject...");
    i.putExtra(Intent.EXTRA_STREAM, uri);
     i.putExtra(Intent.EXTRA_TEXT, "Body of Email....");
   startActivityForResult(Intent.createChooser(i, "send mail...."),EMAIL_SUCCESS);

  } 
```

它可能有效。

# objective-c - 隐藏导航栏，显示导航栏

> ID：12093899
> 
> 赞同：0
> 
> 时间：2012-08-23T14:25:16.130
> 
> 标签：objective-c, ios, xcode, mpmovieplayercontroller

我遇到了一个问题。一开始是来自 AppDelegate 的一些代码。

```
 - (void)HideMainNavigationBar{
navigCtrl.navigationBarHidden = YES;
}

- (void)ShowMainNavigationBar{
navigCtrl.navigationBarHidden = NO;
} 
```

navigCtrl 是我的导航控制器。在我的另一个视图控制器中，我需要隐藏我的导航栏，然后显示它，以正确显示它。

```
- (void) moviePlayerWillExitFullScreen:(id)sender {
   NSLog(@"exitfullscreen");
   AppDelegate *ptr = [AppDelegate SharedAppDelegate];
   [ptr HideMainNavigationBar];
   [ptr ShowMainNavigationBar];
} 
```

在那之后，我看到了返回按钮，而不是我的自定义 tabBarButton：

![在此处输入图像描述](../Images/647afe3cb6434f0bc0214cbb82202c21.png)

点击 ob Back 按钮后，它消失了，我再次看到我的导航栏和我的自定义按钮。在 iOS 5.1 中检测到此“错误”，在 iOS 4.3.2 上一切正常。

这让我疯了，请帮助。

PS我知道，我可以使用：

```
self.navigationController.navigationBar.frame = CGRectMake(0, 20, self.navigationController.navigationBar.frame.size.width, self.navigationController.navigationBar.frame.size.height); 
```

正确显示导航栏，但我需要显示/隐藏导航栏以隐藏它，同时旋转 VideoPlayer。

有任何想法吗？等你的答案，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:33:27.550

因此，经过一些操作后，我决定简单地将 alpha 设置为我的导航栏。

```
if (SYSTEM_VERSION_LESS_THAN(@"5"))  
            [ptr HideMainNavigationBar];
else self.navigationController.navigationBar.alpha = 0; 
```

我希望它对某人有用。拜拜。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-09-27T01:15:53.070

我刚刚在 github 上发布了专门用于 UINavigationBar 外观管理的代码。查看[RRViewControllerExtension](https://github.com/Roen-Ro/RRViewControllerExtension)，它将优雅地解决您的问题。

# python - 有条件地修改全局变量

> ID：12093901
> 
> 赞同：5
> 
> 时间：2012-08-23T14:25:23.583
> 
> 标签：python

我想做这样的事情，但我得到一个 SyntaxWarning 并且它没有按预期工作

```
RAWR = "hi"
def test(bool):
    if bool:
        RAWR = "hello"   # make RAWR a new variable, don't reference global in this function
    else:
        global RAWR
        RAWR = "rawr"    # reference global variable in this function
    print RAWR           # if bool, use local, else use global (and modify global) 
```

我怎样才能让它工作？传入 True 或 False 会修改全局变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:28:31.140

你不能。在范围内，特定名称指的是局部变量或非局部（例如全局，或来自外部函数）变量。不是都。该`global RAWR`行使`RAWR`整个范围成为全局（这就是您收到警告的原因，它不会按照您的想法执行），就像分配给变量使其在整个范围内成为本地一样。编辑：感谢 veredesmarald，我们现在知道这实际上是 Python 2 中的语法错误。我的这一半答案显然仅适用于 Python 3。

您应该只使用一个不同命名的局部变量，并在您想要将其“提升”为全局变量的分支中，设置全局变量*和*局部变量。（或者根本不使用全局变量。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:39:38.230

你可以去的唯一简单的方法是

```
RAWR = "hi"
def test(newone):
    if newone:
        lR = "hello"   # make RAWR a new variable, don't reference global in this function
    else:
        global RAWR
        lR = RAWR      # reference global variable in this function
    print lR           # if bool, use local, else use global (and modify global)
    # modify lR and then
    if not newone:
        RAWR = lR 
```

然而，另一种方式可能是滥用类和对象的概念来达到您的目的。

```
class store_RAWR(object):
    RAWR = "hi"
    def __init__(self, new): self.RAWR = new

def test(newone):
    if newone:
        myR = store_RAWR("hello") # get a (temporary) object with a different string
    else:
        myR = store_RAWR # set the class, which is global.
    # now modify myR.RAWR as you need 
```

但这也需要更改使用全局名称的其他程序部分。

# jquery-mobile - 自定义选择菜单jquery mobile的onChange事件

> ID：12093905
> 
> 赞同：2
> 
> 时间：2012-08-23T14:25:48.987
> 
> 标签：jquery-mobile

我用于 jQuery Mobile 自定义选择菜单的 .change 菜单根本没有触发。我正在尝试动态附加 jQuery Mobile 选择菜单：

**附加 jQuery Mobile 选择菜单**

```
 $('#visSelectionMenu').append('<div data-role="fieldcontain"><label for="visMenu" class="select">Select Visualization:</label><select name="visMenu" id="visMenu" data-native-menu="false" class="visualizationMenu">');

      var visualizationList = ['Triangle','Square'];

      for (var i = 0; i < visualizationList.length; i++) {
        $('#visMenu').append('<option value=\'' + visualizationList[i] + '\'>' + visualizationList[i] + '</option>');
      }

      $('#visMenu').selectmenu();
       $("#visMenu").selectmenu('refresh', true); 
```

**OnChange 方法**

```
$("#visMenu").change(function () {
  console.log("hello");
    var $this = $(this),
        val   = $this.val();
    alert('onChange = ' + val);
}); 
```

# c - 如何为 .ko 程序 Linux 建立一个应用程序（C 程序）

> ID：12093906
> 
> 赞同：-4
> 
> 时间：2012-08-23T14:25:49.470
> 
> 标签：c, linux, linux-kernel, embedded-linux, kernel

我有：

1.  `main.c`具有函数调用的 main 函数的AC 程序。
2.  另一个`test.c`带有函数定义的 C 程序。
3.  标头`test.h`具有公共声明。

**请仔细阅读我的目标** ，我的目标是拥有一个内核对象和一个使用它的应用程序。我需要在运行时为函数提供一些输入并进行处理。

我在终端中使用它。谁能帮帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:49:01.800

为了编译内核模块，你可以编写这个基本的 makefile ：

```
obj-m += <your_obj_file>.o

all:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean 
```

之后，您必须构建和加载您的模块

```
make
insmod <your_module>.ko 
```

但是当我读到你的时候，我猜你真正想做的不是内核模块。我认为您想构建一个共享库（**.so**文件或**.dll**），不是吗？

如果它是您要构建的 linux 共享库，请调用以下命令：

```
gcc -c -fPIC test.c
gcc -shared test.o -o libtest.so

gcc -c main.c
gcc main.o -o <binary name> -ltest 
```

但是，如果您只想以经典方式构建静态二进制文件：

```
gcc -c test.c
gcc -c main.c

gcc test.o main.o -o <binary name> 
```

# java - Intellij 中的 Groovy 插件出错？

> ID：12093909
> 
> 赞同：0
> 
> 时间：2012-08-23T14:26:01.113
> 
> 标签：java, intellij-idea

在 Intellij 中调试代码时出现以下错误。我检查了的地方，`agent\gragent.jar`但它不存在。我通过停用插件暂时解决它，但我想要一个适当的解决方案。

**有谁知道为什么以及如何解决它？**

```
Error occurred during initialization of VM
Error opening zip file: C:\development\tools\IntelliJ IDEA   11.1.2\plugins\Groovy\lib\agent\gragent.jar
agent library failed to init: instrument

Process finished with exit code 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:18:50.490

您可以在 Intellij 10 或 11 的任何其他版本中找到此文件（我从 Intellij 10 中找到）将其复制并粘贴到 IDEA 11.1.3。重新启动 Intellij 一切都会好起来的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:04:07.877

安装[IDEA 11.1.3](http://www.jetbrains.com/idea/download/index.html)，这个文件在我的系统上可用。

# java - 我正在使用 jdbc &hibernate 连接我的数据库 oracle11gr2。我需要将客户端库从 hibernate 3.1.3 升级到 4.1.6

> ID：12093914
> 
> 赞同：0
> 
> 时间：2012-08-23T14:26:23.350
> 
> 标签：java, hibernate, oracle11g, hibernate3, hibernate-4.x

我需要将我的客户端库（即休眠）从 3.1.3 升级到 4.x 我更喜欢 4.1.6。我已经成功地将 jdbc 4 升级到 5。现在问题是我们要从 3.1.6 升级到最新版本。我看到超过 250 个错误。我在添加 jars 时有点困惑。我从 4.1.6 添加了所需的文件夹。可以让我知道我应该在所需文件夹中添加所有 jars 还是只替换我的 jars图书馆

替换：

antlr、commons-collections、dom4j、hibernate jar。

我已经尝试了两种方法来添加所有必需的 jars 文件夹，并且只是替换了与我的库和 4.1.6 相同的 jars。在这两种情况下，我都会遇到相同的错误。

谢谢你的回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:39:25.433

您应该检查项目中 jar 之间的依赖关系。您可以使用一些工具，例如[http://www.jboss.org/tattletale](http://www.jboss.org/tattletale)

# visual-studio-2010 - 我无法使用 ADO/ADOX 获取元数据

> ID：12093915
> 
> 赞同：0
> 
> 时间：2012-08-23T14:26:25.160
> 
> 标签：visual-studio-2010, metadata, ado, adox

我正在尝试根据用户选择获取元数据。我正在使用 ADODB 命名空间来提供与数据库的连接和用于从中检索数据的记录集。我已经建立了一个连接并对其进行了测试，这可以正常工作，但是无法检索数据。

这是主要部分：

```
 con.Open()
                cat.ActiveConnection = con

                Select Case chk.Tag
                Case "Yes"
                    For Each modMainFunctions.tbl In cat.Tables
                        If tbl.Type = "TABLE" Then
                            frmMain.lstTables.Items.Add(tbl.Name)
                        End If
                    Next

            End Select 
```

本质上，我正在检查一个特定的复选框是否已被选中，如果它有“即案例”是“然后我试图从提供的数据库中检索数据库表。但是，编译器没有到达 FOR 循环，我无法理解为什么...

modMainfunctions 是我的模块，其中存储了我的程序的主要功能，在其中我声明了所有必要的变量：

```
Dim dbname As String = ""
Dim dblocation As String = Application.StartupPath
Dim con As New ADODB.Connection
Dim cat As New ADOX.Catalog
Dim tbl As New ADOX.Table
Dim col As ADOX.Column
Dim view As ADOX.View
Dim key As ADOX.Key
Dim index As New ADOX.Index 
```

谁能看到我哪里出错了？我想获取有关数据库的元数据（请不要回答“您需要连接到...”等，因为我已经有一个处理此问题的子程序并且它工作正常，我认为它不是连接问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:14:05.493

问题解决了，而不是将这个过程存储在一个模块中，我只是将它存储在活动表单中，我不确定这是否是“最佳实践”，但只要我的代码按预期工作我很高兴。我意识到这个错误是因为我没有正确拼写世界“是”......它正在寻找“是”这个词，我清楚地输入了“是”，在这里可以了解彻底阅读您的代码的意义！

# performance - Hadoop 中大量多个输出文件的性能

> ID：12093916
> 
> 赞同：4
> 
> 时间：2012-08-23T14:26:27.940
> 
> 标签：performance, hadoop, mapreduce

我正在使用自定义输出格式，每个键的每个映射器输出一个新的序列文件，所以你最终会得到这样的东西..

**输入**

```
Key1     Value
Key2     Value
Key1     Value 
```

**文件**

```
/path/to/output/Key1/part-00000
/path/to/output/Key2/part-00000 
```

我注意到一个巨大的性能损失，通常需要大约 10 分钟来简单地映射输入数据，但是在两个小时之后，映射器甚至还没有完成一半。尽管他们正在输出行。我预计唯一键的数量大约是输入行数的一半，大约 200,000。

有没有人做过这样的事情，或者可以提出任何可能有助于表现的事情？我想将这个密钥拆分过程保留在可能的 hadoop 中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T17:25:53.717

我相信你应该重新审视你的设计。我不相信 HDFS 可以扩展到超过 10M 的文件。我建议阅读更多关于 Hadoop、HDFS 和 Map/Reduce 的内容。一个好的起点是[http://www.cloudera.com/blog/2009/02/the-small-files-problem/](http://www.cloudera.com/blog/2009/02/the-small-files-problem/)。

祝你好运！

**编辑 8/26：**根据@David Gruzman 的评论，我更深入地研究了这个问题。事实上，存储大量小文件的惩罚只针对 NameNode。数据节点没有额外的空间损失。我删除了答案的不正确部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T14:02:14.093

听起来像输出到一些键值存储可能会有很大帮助。
例如，HBASE 可能适合您的需求，因为它针对大量写入进行了优化，并且您将重用部分 hadoop 基础架构。现有的输出格式可以写入 HBase：[http ://hbase.apache.org/apidocs/org/apache/hadoop/hbase/mapreduce/TableOutputFormat.html](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/mapreduce/TableOutputFormat.html)

# php - 在 textarea 上追加新文本

> ID：12093917
> 
> 赞同：0
> 
> 时间：2012-08-23T14:26:34.487
> 
> 标签：php, javascript, jquery, html

我正在编写一个基于[http://jsfiddle.net/joevallender/QyqYW/1/](http://jsfiddle.net/joevallender/QyqYW/1/)的标签系统，但是当我尝试通过输入 textarea 添加新标签时，它工作正常但是当我点击任何标签时，以前的新文本会被移除。

# HTML

```
<textarea id="tags"></textarea>
<div id="tagButtons"></div> 
```

# Javascript

```
var tags = [
  'JavaScript',    
  'jQuery',
  'HTML5',    
  'CSS3'
];

var selectedTags = [];

for(var i = 0; i < tags.length; i++) {
  var el = $('<span>').text(tags[i]);
  $('#tagButtons').append(el);
}

$('#tagButtons span').click(function(){
  var val = $(this).text();
  var index = selectedTags.indexOf(val);
  if(index > -1) {
    var removed = selectedTags.splice(index,1); 
    $(this).removeClass('selected');

  } else {
    selectedTags.push(val);
    $(this).addClass('selected');

  }
  $('#tags').val(selectedTags.join(', '));
});
​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:47:38.293

你的问题在这一行

```
$('#tags').val(selectedTags.join(', ')); 
```

它覆盖了`textarea`之前的内容。

**编辑：**

试试看：http: [//jsfiddle.net/QyqYW/92/](http://jsfiddle.net/QyqYW/92/)

```
var tags = [
  'JavaScript',    
  'jQuery',
  'HTML5',    
  'CSS3',
  'PHP'
],
keys = "";

var selectedTags = [];

for(var i = 0; i < tags.length; i++) {
  var el = $('<span>').text(tags[i]);
  $('#tagButtons').append(el);
}

//changed click event to "on" event.. 
//it seems that click doesn't bind to dynamically added elements
$('#tagButtons').on("click" , "span" , function(){
     //Checks if you've forgot to type "," and then adds your tag
     if(keys != ""){
          selectedTags.push(keys);                                   
          $('#debug').prepend($('<div>').html('Added: ' + keys));
          var newEl = $('<span class="selected">').text(keys);
          $('#tagButtons').append(newEl);
          $('#tags').focus().val(selectedTags.join(', ') + ", ");                                    
          keys = "";
      }

      var val = $(this).text();
      var index = selectedTags.indexOf(val);
      if(index > -1) {
          var removed = selectedTags.splice(index,1); 
          $(this).removeClass('selected');
          $('#debug').prepend($('<div>').html('Removed: ' + removed));
          $('#tags').focus().val(selectedTags.join(', ') + ", ");
      } else {
          selectedTags.push(val);
          $(this).addClass('selected');
          $('#debug').prepend($('<div>').html('Added: ' + val));
          $('#tags').focus().val(selectedTags.join(', ') + ", ");                                    
      }                                                      

});

//adds tag after you type ",".. 
//if you forgot to, look above the first line in the on event
$("#tags").keydown(function(evt){                               
     if(evt.which == 188){
         selectedTags.push(keys);                                   
         $('#debug').prepend($('<div>').html('Added: ' + keys));
         var newEl = $('<span class="selected">').text(keys);
         $('#tagButtons').append(newEl);
         $('#tags').val(selectedTags.join(', '));                                       
         keys = "";
     } else if(evt.which ==8){ 
     //for after adding tag you can't use Backspace to delete it.
     //remove tag from butotns
         if(keys == ""){
         evt.preventDefault();
     } else {
         keys += String.fromCharCode(evt.which).toLowerCase();
     }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:05:17.287

我继续在您的原始问题上处理 jsfiddle [通过 onclick 到 textarea 添加和删除多个标签](https://stackoverflow.com/questions/12087694/add-and-remove-multiple-tag-by-onclick-to-textarea)

见[http://jsfiddle.net/joevallender/QyqYW/14/](http://jsfiddle.net/joevallender/QyqYW/14/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T15:11:09.750

```
$(this).text(); 
```

Abowe，只会返回从 html 原始呈现到 DOM 中的值。无论您在 textarea 中键入什么内容，都还没有，您必须连接`('#tags').on('keyup' function () {});` 并存储键入的内容，以便以后将其包含到 textarea 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T15:19:46.420

老实说，我认为您应该将标签放入单独的 div 或输入中。无论如何，它们应该单独存储在数据库中。

# linux - 在 Linux 上捕获 CPU 使用情况的侵入性较低的方法

> ID：12093924
> 
> 赞同：1
> 
> 时间：2012-08-23T14:26:53.267
> 
> 标签：linux, cpu-usage

**[Net-SNMP 之](http://en.wikipedia.org/wiki/Net-SNMP)**类的工具如何捕获 CPU 使用率？

在 Linux 下，什么是侵入性最小的方式呢？

*为了做到这一点，这样做会消耗最少的机器资源（cpu 和 ram）。最终数据将被保存到一个文件中。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T14:29:31.367

您是否尝试过使用 $top 命令？

事实上，这里有一个方法列表，包括 $top 一个，试试这些 :)

[http://www.cyberciti.biz/tips/how-do-i-find-out-linux-cpu-utilization.html](http://www.cyberciti.biz/tips/how-do-i-find-out-linux-cpu-utilization.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T14:31:04.420

`/proc`除了内核本身之外，没有其他方法可以计算当前 CPU 利用率。所有常用工具（如*ps*、*top*等）也只是读取整体 CPU 使用率或`/proc`每个进程的 CPU 使用率。然而，作为 一个由内核直接提供的虚拟文件系统，在其中读取文件的开销要比普通文件小得多。`/proc/stat``/proc/<pid>/stat``/proc`

如果您不想`/proc`自己阅读，请尝试使用只进行少量额外计算的工具，就像`ps`@deep 提到的那样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T14:57:52.243

试试这个：

```
ps -eo pcpu,pid | less 
```

这将显示 CPU 使用率以及 PID

# html - 背景图像未出现在编译的 CHM 文件中 - Html Workshop

> ID：12093926
> 
> 赞同：0
> 
> 时间：2012-08-23T14:26:56.527
> 
> 标签：html, chm, html-help-workshop

我最近重新编译了一个 .chm 文件，因为需要在每个 html 文件中进行大量更改。

简单地重新编译这些文件时我遇到的主要问题是背景图像。其中一个 html 文件中的代码如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>How to Create a File</title>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" media="screen" type="text/css" title="Design"
  href="design.css" />
  <!--(Style Sheet)===================================================-->
  <style>
body { background-image:url("Background.gif"); background-repeat:repeat; background-attachment:scroll;  }</style>
</head> 
```

之前存在的编译版本可以工作并保留背景。我只是使用 Amaya 更改了 html 文件中的文本，现在它不起作用！

另一个问题是，如果我重命名所有文件并相应地更改索引文件等，我也会松开标题部分等周围的框。所以我不得不求助于旧的命名和严重无组织的文件！

我使用的所有图像都在同一个文件夹中，所以这不是问题。

有谁知道为什么会这样？任何帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:22:44.403

我不确定这对你来说是否仍然是一个问题......但为了让你的背景工作，你的风格**必须**内联 - 即在标签中......在你的情况下，身体标签。背景图像将无法通过链接样式表或放置在标题中的样式在编译的 CHM 中工作。

你需要做：

```
<body style="...attributes here;"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:13:15.877

我认为您使用此方法代替背景图像，然后再考虑背景重复您想要重复 x 或重复 y 或双方重复任何一个选择。

```
<style>
 body {
 background:url(Background.gif); 
 background-attachment:scroll;
 background-repeat:repeat;
 }
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-21T18:36:27.613

您需要将背景图像路径插入**.hhp**文件的**[FILES]**部分。

例如：

```
[FILES]
  index.html
  ...
  background.gif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-22T20:18:16.020

如果您使用的是 Microsoft 文档资源管理器，这将起作用。在右键单击图像并查看其属性时，为图像源路径提供完整的 url：

```
ms-help://MS.VSCC.v80/MS.VSIPCC.v80/something/something/background.gif 
```

但更好的方法是使用 JavaScript 将背景图像动态添加到元素的样式中。您可以使用 jQuery 或纯 JavaScript 来做到这一点。

使用 jQuery：

```
$(document).ready(function() {
    $("#example").css("background-image","url('images/css-background.jpg')");
}); 
```

使用纯 JavaScript：

```
var url = window.location.href;
url = url.substring(0, url.lastIndexOf("/") + 1);
var style = document.createElement('style');
document.getElementsByTagName('head')[0].appendChild(style);
style.setAttribute('type', 'text/css');
style.styleSheet.cssText = '#example {  background: url(' + url + 'images/css-background.jpg) }'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-29T02:53:18.650

首先将图像转换为base 64，然后，

*   用于`<img>`元素：

    ```
    <img src='data:image/png;base64,iVBOR.....'/> 
    ```

*   用作 CSS 背景：

    ```
    url('data:image/png;base64,iVBOR...............' 
    ```

# r - 包装图例文本以适应绘图窗口

> ID：12093927
> 
> 赞同：9
> 
> 时间：2012-08-23T14:27:00.897
> 
> 标签：r, ggplot2

我正在使用 ggplot 绘制一些数据图表，我注意到图例文本很长并且不适合窗口。

```
+ opts(legend.position = 'bottom', legend.direction = 'horizontal', size=0.1)  +
    guides(colour = guide_legend(nrow = 3), size=1) 
```

ggplot 中是否有选项可以包装图例文本以适应窗口。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T15:39:52.150

据我所知，因此我采用了一种解决方法`strwidth()`，它可以计算基本图形中文本的宽度。

```
title <- "This is a really excessively wide title for a plot, especially since it probably won't fit" 
```

用于`par("din")`获取设备的宽度，并`strwidth()`计算文本大小：

```
par("din")[1]
[1] 8.819444
strwidth(title, units="inches")
[1] 11.47222 
```

在函数和绘图中使用它：

```
wrapTitle <- function(x, width=par("din")[1]){
  xx <- strwrap(x, width=0.8 * nchar(x) * width / strwidth(x, units="inches"))
  paste(xx, collapse="\n")
}

wrapTitle(title)
[1] "This is a really excessively wide title for a plot, especially since it\nprobably won't fit, meaning we somehow have to wrap it" 
```

剧情：

```
ggplot(mtcars, aes(wt, mpg)) + geom_point() + opts(title=wrapTitle(title)) 
```

![在此处输入图像描述](../Images/062bb001915138e794c66394c90b929b.png)

* * *

如果要将绘图保存到文件，则可以替换`par("din")`为实际保存的绘图尺寸。

# servlets - 转换 .WAR 以在 karaf/servicemix 中自动部署

> ID：12093933
> 
> 赞同：2
> 
> 时间：2012-08-23T14:27:39.440
> 
> 标签：servlets, osgi, war, apache-servicemix, hotdeploy

我有一个非常简单的 .WAR 包含示例 servlet。我可以使用以下命令在 servicemix 中部署它：

`osgi:install file:///home/seiho/apache-servicemix-4.4.2/deploy/TestServlet.war?Bundle-SymbolicName=TestServlet&Webapp-Context=/TestServlet`

然后在我的浏览器中查看。但只有文件的完整路径，例如：localhost:8080/TestServlet/index.html 或 localhost:8080/TestServlet/TestServlet（我的 servlet 是 TestServlet 类）。
我想在输入后自动启动 index.html 页面：localhost:8080/TestServlet

怎么做？

更重要
的是我需要一种方法来转换 .WAR 文件或 servlet 项目（我有源代码），以便可以通过将新的 .WAR 文件复制到 $SERVICEMIX_HOME/deploy 目录来自动部署它。

我尝试编辑 MANIFEST.MF 文件，但没有成功。可能我做错了什么。

感谢您的任何建议/帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:32:03.030

要被识别为 wab，您需要在清单中添加上下文路径标头：

```
Web-ContextPath: TestServlet 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T07:32:30.160

它现在正在工作！我正在根据这个页面做我的 MANIFEST.MF：http: [//team.ops4j.org/wiki/display/ops4j/Pax+Web+Extender+-+War+-+OSGi-fy](http://team.ops4j.org/wiki/display/ops4j/Pax+Web+Extender+-+War+-+OSGi-fy)

问题是由于某种原因需要“Bundle-Version：1.0”行，而不是该页面上所述的可选行。

老实说，只需添加 Bundle-Version 修复它。

我知道 MANIFEST.MF 出了点问题，在 Holly Cummins 提出问题后，我又玩了一会儿。谢谢霍莉。

我仍然无法手动启动站点（必须手动输入 index.html）。

`http://localhost:8080/TestServlet/`给了我这个：

* * *

HTTP 错误 404

访问 /TestServlet/ 时出现问题。原因：

```
Not Found 
```

由码头提供支持：//

* * *

`http://localhost:8080/TestServlet/index.html`给了我合适的网站。

# google-drive-api - 谷歌驱动器将元数据添加到文件

> ID：12093934
> 
> 赞同：2
> 
> 时间：2012-08-23T14:27:39.953
> 
> 标签：google-drive-api, google-drive-realtime-api

我想使用 googledrive api 来搜索文件。我想向其中添加元数据。

```
 Example:

    File: computers1.pdf
    Brand: brand1

    File: computers2.pdf
    Brand: brand2

    File: computers3.doc
    Brand: brand2 
```

如您所见，文件名对于搜索某个品牌没有用处。有很多文件，所以重命名它们很困难，有时一个文件可以有多个“品牌”。

有没有办法将自定义元数据添加到谷歌的文件/索引中。在此示例中，它将从品牌获取所有文件：x。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T16:25:35.167

Drive API 目前无法做到这一点，但我们了解您的用例，并且我们已经在考虑实施一些可以帮助您解决此问题的方法。敬请期待！

目前，您可能希望使用该`description`字段来存储元数据并对其执行搜索。

另一件重要的事情是 Google Drive 会自动索引 PDF 中的文本，因此如果它们包含在文档正文中，您已经可以搜索这些值。

# python - 在python中以特定顺序读取文件

> ID：12093940
> 
> 赞同：39
> 
> 时间：2012-08-23T14:28:19.127
> 
> 标签：python, file, order-of-execution

假设我在一个文件夹中有三个文件：file9.txt、file10.txt 和 file11.txt，我想按这个特定的顺序阅读它们。谁能帮我这个？

现在我正在使用代码

```
import glob, os
for infile in glob.glob(os.path.join( '*.txt')):
    print "Current File Being Processed is: " + infile 
```

它首先读取file10.txt，然后读取file11.txt，然后读取file9.txt。

有人可以帮我如何获得正确的订单吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-08-23T14:31:19.290

文件系统上的文件未排序。您可以使用以下[`sorted()`函数](http://docs.python.org/library/functions.html#sorted)自己对生成的文件名进行排序：

```
for infile in sorted(glob.glob('*.txt')):
    print "Current File Being Processed is: " + infile 
```

请注意，`os.path.join`代码中的调用是无操作的；只有一个参数，它什么也不做，只是原封不动地返回那个参数。

请注意，您的文件将按字母顺序排序，即`10`放在`9`. 您可以使用自定义键功能来改进排序：

```
import re
numbers = re.compile(r'(\d+)')
def numericalSort(value):
    parts = numbers.split(value)
    parts[1::2] = map(int, parts[1::2])
    return parts

 for infile in sorted(glob.glob('*.txt'), key=numericalSort):
    print "Current File Being Processed is: " + infile 
```

该`numericalSort`函数拆分文件名中的任何数字，将其转换为实际数字，并返回结果进行排序：

```
>>> files = ['file9.txt', 'file10.txt', 'file11.txt', '32foo9.txt', '32foo10.txt']
>>> sorted(files)
['32foo10.txt', '32foo9.txt', 'file10.txt', 'file11.txt', 'file9.txt']
>>> sorted(files, key=numericalSort)
['32foo9.txt', '32foo10.txt', 'file9.txt', 'file10.txt', 'file11.txt'] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-23T14:31:07.823

您可以将`glob.glob( ... )`表达式包装在`sorted( ... )`语句中并对生成的文件列表进行排序。例子：

```
for infile in sorted(glob.glob('*.txt')): 
```

您可以提供`sorted`一个比较函数，或者更好的是，使用该`key= ...`参数为其提供一个用于排序的自定义键。

例子：

有以下文件：

```
x/blub01.txt
x/blub02.txt
x/blub10.txt
x/blub03.txt
y/blub05.txt 
```

以下代码将产生以下输出：

```
for filename in sorted(glob.glob('[xy]/*.txt')):
        print filename
# x/blub01.txt
# x/blub02.txt
# x/blub03.txt
# x/blub10.txt
# y/blub05.txt 
```

现在具有关键功能：

```
def key_func(x):
        return os.path.split(x)[-1]
for filename in sorted(glob.glob('[xy]/*.txt'), key=key_func):
        print filename
# x/blub01.txt
# x/blub02.txt
# x/blub03.txt
# y/blub05.txt
# x/blub10.txt 
```

**编辑：** 可能这个关键功能可以对您的文件进行排序：

```
pat=re.compile("(\d+)\D*$")
...
def key_func(x):
        mat=pat.search(os.path.split(x)[-1]) # match last group of digits
        if mat is None:
            return x
        return "{:>10}".format(mat.group(1)) # right align to 10 digits. 
```

它肯定可以改进，但我想你明白了。没有数字的路径将被单独保留，有数字的路径将被转换为一个 10 位宽并包含数字的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T14:50:28.313

您需要通过隔离文件名中的数字来将排序从“ASCIIBetical”更改为数字。你可以这样做：

```
import re

def keyFunc(afilename):
    nondigits = re.compile("\D")
    return int(nondigits.sub("", afilename))

filenames = ["file10.txt", "file11.txt", "file9.txt"]

for x in sorted(filenames, key=keyFunc):
   print xcode here 
```

您可以在其中使用 glob.glob("*.txt"); 的结果设置文件名；

另外，keyFunc 函数假定文件名中将包含一个数字，并且该数字仅在文件名中。您可以将该功能更改为根据需要隔离您需要排序的数字的复杂程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T14:33:11.530

```
glob.glob(os.path.join( '*.txt')) 
```

返回一个字符串列表，因此您可以使用 pythons [sorted() function](http://wiki.python.org/moin/HowTo/Sorting/)轻松对列表进行排序。

```
sorted(glob.glob(os.path.join( '*.txt'))) 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-08-23T14:31:47.647

```
for fname in ['file9.txt','file10.txt','file11.txt']:
   with open(fname) as f: # default open mode is for reading
      for line in f:
         # do something with line 
```

# java - 在树节点数据中构建和实现聚合（或类似）方法的最佳模式

> ID：12093949
> 
> 赞同：4
> 
> 时间：2012-08-23T14:28:50.460
> 
> 标签：java, design-patterns, generics, tree

在树节点数据的层次结构上实现聚合（或类似）方法时遇到问题。可以看出，泛型在这里有点过度使用，这对我来说并不令人满意，所以我的问题是： **有没有更好的方法来实现它（可能避免在层次结构的聚合方法中从 Object 进行强制转换）？**

目前的情况（去除不相关的细节）：

```
public interface AggregableTreeData<T extends AggregableTreeData> {
  void aggregate(T from);   
}

public abstract class FruitTreeData<T extends FruitTreeData<?>> 
      implements AggregableTreeData<T> {

  private BigDecimal size = BigDecimal.ZERO;

  @Override
  public void aggregate(T from) {
    this.size = this.size.add(from.size);
  }
}

public class OrangeTreeData<T extends OrangeTreeData<?>> 
    extends  FruitTreeData<T> {

  private boolean ripened = false;

  @Override
  public void aggregate(T from) {
    this.ripened = this.ripened || from.ripened;
  }
} 
```

另外我有一个方法，执行树数据聚合，它看起来像：

```
//child.getData() and node.getData() is of type <T extends AggregableTreeData<T>>
void aggregateNode(TreeNode node) {
  for (TreeNode child : node.getChildren()) {
    aggregateNode(child);
    node.getData().aggregate(child.getData());
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T08:00:39.757

看起来很像复合模式的工作。

# ms-access-2003 - 是否可以在 Access 2003 中查询链接表管理器？

> ID：12093952
> 
> 赞同：2
> 
> 时间：2012-08-23T14:28:57.647
> 
> 标签：ms-access-2003, linked-tables

我有一个数据库目录 (*.mdb)，它们链接到其他位置的其他几个 *.mdb。

我们将原始数据库从一个文件拆分为两个分区。目录中的数据库指向原始数据库文件（以及一些其他数据库）。现在我需要将目录中每个数据库的表重新链接到原始（现在拆分）数据库的正确分区。

我一直在手动完成并重新链接每个数据库的链接表管理器中的表，但这非常低效，如果我可以以某种方式查询链接表管理器，我可以很容易地找出我是否更改了正确的数字的表。

有没有办法查询链接表管理器？通过VB甚至使用系统表和SQL使用表名和文件位置？

注意我在 MS Access 2003 中打开文件，但 MS Access 2003 正在打开它们并报告 Access 2000 格式。

Per Remou 的建议是我为重新链接表格而编写的一些代码：

```
Sub RelinkLinks()
    Dim db As Database
    Dim tdf As TableDef

    Dim OldLoc As String
    OldLoc = ";DATABASE=\\lois\_DB\DB\BE.mdb"

    Dim partition1Loc As String
    Dim partition2Loc As String
    partition1Loc = ";DATABASE=\\lois\_DB\DB\Partition 1\BE.mdb"
    partition2Loc = ";DATABASE=\\lois\_DB\DB\Partition 2\BE.mdb"

    Set db = CurrentDb

    For Each tdf In db.TableDefs

        ' Only cycle through the locations
        ' that are equal to the old one...
        If tdf.Connect = OldLoc Then
            ' Debug.Print tdf.Name & ":" & tdf.Connect

            Dim whichLoc As String

            If tdf.Name = "T_PAR_2_TBL_1" Or tdf.Name = "T_PAR_2_TBL_2" Then
            ' Only set the tables to partition 2 that were listed as in Partition 2 by the database splitter
                Debug.Print "Setting linked table " & tdf.Name & " FROM " & tdf.Connect & " TO " & partition2Loc
                whichLoc = partition2Loc
            Else
            ' If the name was not listed as in partition 2, set it to partition 1
                Debug.Print "Setting linked table " & tdf.Name & " FROM " & tdf.Connect & " TO " & partition1Loc
                whichLoc = partition1Loc
            End If

            'We will uncomment this when we take the safety off...
            'tdf.Connect = whichLoc
            'tdf.RefreshLink
        End If
    Next tdf
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:33:11.907

您可以通过 VBA 引用 TableDefs 来更改和更新链接。

```
 Set db = CurrentDB
 For Each tdf In db.Tabledefs
 If tdf.Connect <> Myconnect Then ''the connect property is a string
    tdf.Connect = MyConnect
    tdf.RefreshLink
 End If 
```

您还可以使用 CreateTableDef 将外部数据库中的所有表与 VBA 链接。我通常发现保留一张我想要链接并使用它的表格很有用。

# xml - 如何 使用 xslt 删除标签并保留所有其他标签？

> ID：12093953
> 
> 赞同：0
> 
> 时间：2012-08-23T14:28:57.320
> 
> 标签：xml, xslt

我正在尝试从 xslt1.0 中的字符串中删除中断标记。我尝试使用 translate(s,'<br>','') ，其中 s 是字符串值，但这也删除了粗体标签。还尝试了一个模板，但没有运气。我的问题是如何仅删除中断标签。

所以字符串：

```
<b>trying</b> to remove <br> tags only <br> and not <b>bold tags</b> 
```

将被解析为：

```
<b>trying</b> to remove tags only and not <b>bold tags</b> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:05:22.303

这个 XSLT：

```
 <xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template match="node()|@*">
    <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template>

<xsl:template match=
    "br[not(@*|*|comment()|processing-instruction()) 
    and normalize-space()=''
    ]"/>
</xsl:stylesheet> 
```

应用于这个格式良好、有效的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<list>
<b>trying</b> to remove <br/> tags only <br/> and not <b>bold tags</b>
</list> 
```

给出这个结果：

```
<list>
<b>trying</b> to remove  tags only  and not <b>bold tags</b>
</list> 
```

另请参阅 Dimitre 的解决方案： [Removing empty tags from XML via XSLT](https://stackoverflow.com/questions/6648679/removing-empty-tags-from-xml-via-xslt)

# python - 如何在 Flask Sqlalchemy 中分离主从（数据库读/写）

> ID：12093956
> 
> 赞同：6
> 
> 时间：2012-08-23T14:29:07.727
> 
> 标签：python, sqlalchemy, flask, master-slave, flask-sqlalchemy

我正在尝试通过 Flask Sqlalchemy 分离读取和写入数据库操作。我正在使用绑定连接到 mysql 数据库。我想在主设备中执行写操作并从从设备中读取。似乎没有内置的方法来处理这个问题。

我是 python 新手，很惊讶像这样的急需功能还没有预先内置到 flask-sqlalchemy 中。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2019-02-11T13:02:40.323

没有官方支持，但是可以自定义 Flask-SQLalchemy 会话使用主从连接

```
from functools import partial

from sqlalchemy import orm
from flask import current_app
from flask_sqlalchemy import SQLAlchemy, get_state

class RoutingSession(orm.Session):
    def __init__(self, db, autocommit=False, autoflush=True, **options):
        self.app = db.get_app()
        self.db = db
        self._bind_name = None
        orm.Session.__init__(
            self, autocommit=autocommit, autoflush=autoflush,
            bind=db.engine,
            binds=db.get_binds(self.app),
            **options,
        )

    def get_bind(self, mapper=None, clause=None):
        try:
            state = get_state(self.app)
        except (AssertionError, AttributeError, TypeError) as err:
            current_app.logger.info(
                'cant get configuration. default bind. Error:' + err)
            return orm.Session.get_bind(self, mapper, clause)

        # If there are no binds configured, use default SQLALCHEMY_DATABASE_URI
        if not state or not self.app.config['SQLALCHEMY_BINDS']:
            return orm.Session.get_bind(self, mapper, clause)

        # if want to user exact bind
        if self._bind_name:
            return state.db.get_engine(self.app, bind=self._bind_name)
        else:
            # if no bind is used connect to default
            return orm.Session.get_bind(self, mapper, clause)

    def using_bind(self, name):
        bind_session = RoutingSession(self.db)
        vars(bind_session).update(vars(self))
        bind_session._bind_name = name
        return bind_session

class RouteSQLAlchemy(SQLAlchemy):
    def __init__(self, *args, **kwargs):
        SQLAlchemy.__init__(self, *args, **kwargs)
        self.session.using_bind = lambda s: self.session().using_bind(s)

    def create_scoped_session(self, options=None):
        if options is None:
            options = {}
        scopefunc = options.pop('scopefunc', None)
        return orm.scoped_session(
            partial(RoutingSession, self, **options),
            scopefunc=scopefunc,
        ) 
```

比默认会话是`master`，当你想从slave中选择时，你可以直接调用它，这里的例子：

在您的应用中：

```
from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql:///master'
app.config['SQLALCHEMY_BINDS'] = {
    'slave': 'postgresql:///slave'
}

db = RouteSQLAlchemy(app) 
```

从大师中选择

```
session.query(User).filter_by(id=1).first() 
```

从奴隶中选择

```
session.using_bind('slave').query(User).filter_by(id=1).first() 
```

* * *

## 回答 #2

> 赞同：-7
> 
> 时间：2012-08-24T10:51:34.690

这是文档[http://packages.python.org/Flask-SQLAlchemy/binds.html](http://packages.python.org/Flask-SQLAlchemy/binds.html)

# c# - 连接字符串的 SqlCeConnection 相对路径失败

> ID：12093962
> 
> 赞同：-1
> 
> 时间：2012-08-23T14:29:42.410
> 
> 标签：c#, .net, sql-server-ce

```
SqlCeConnection cs = new SqlCeConnection(@"Data Source=C:\Users\Shahid\Documents\Visual Studio 2010\Projects\DarUlIfta\DarUlIfta\DB.sdf"); 
```

这适用于完整路径

但是当我使用相对路径时我面临的唯一问题是我的数据库停止将数据保存到其中。在运行时，当我关闭应用程序时，它工作正常，数据库中有注释。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:21:31.897

您的连接字符串指向项目源文件夹中的数据库。那是不对的; 当您部署软件时，您不会部署您的源代码。您必须确定已部署数据的路径。有几种方法可以做到这一点，具体取决于您未向我们展示的信息。

作为第一个猜测，试试这个：

```
SqlCeConnection cs = new SqlCeConnection(@"Data Source=|DataDirectory|\DB.sdf"); 
```

如果可行，您必须了解部署属性。如果这不起作用，我们将需要更多关于您正在尝试做什么的信息。

另外，请参阅[Using a database in .NET](https://stackoverflow.com/questions/2525410)。

# javascript - XMLHttpRequestObject.onreadystatechange... 有必要吗？

> ID：12093964
> 
> 赞同：1
> 
> 时间：2012-08-23T14:29:47.217
> 
> 标签：javascript, ajax

我是 AJAX 的新手，我有一个问题，如标题所示。我的意思是，如果我只想将数据发送到服务器（更新数据库等），但不需要响应文本，我会尝试省略它。

```
XMLHttpRequestObject.onreadystatechange = function() {
    if (XMLHttpRequestObject.readyState == 4 && XMLHttpRequestObject.status == 200) {
        // ...
    }
}; 
```

但这似乎不起作用。
谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:42:35.893

您不必使用提供的响应数据，但是您无法确定数据是否已成功发送或正确接收等。由于您没有进行检查，因此可以省略您的`onreadystatechange`定义。

这种技术称为“信标”。由于您不需要检查响应，这也意味着您不需要经历制作 XMLHTTPRequest 的麻烦（无论如何，仅适用于 GET URL）：

```
var beacon = new Image();
beacon.src = "http://example.com/beacon.php?foo=10&bar=20"; 
```

# git - 在获取错误的仓库后修复 Git 历史记录

> ID：12093966
> 
> 赞同：9
> 
> 时间：2012-08-23T14:29:50.317
> 
> 标签：git

我在我的 git repo 上设置了一个遥控器时犯了一个错误，并从一个完全不同的项目中获取。

幸运的是，没有合并，但我现在有 2 个项目的历史在我的仓库中浮动，我试图弄清楚如何让我的仓库恢复到我进行错误提取之前的状态。

我一直在阅读有关`reflog`,和其他试图解决的命令`rebase`，`gc`这将帮助我摆脱我不小心获取的东西，但到目前为止还没有任何地方。

看起来我的回购中有两个项目的历史，但它们是完全独立的。基本上有 2 个独立的提交树彼此并行运行，事实上，这是我在`gitk`查看所有分支时看到的：

![在此处输入图像描述](../Images/187a80c88ee72b6b63011cc278e1fe3b.png)

可以看到中间的commits和history的开头和结尾的commits没有关联。在日期方面，它们是交错的，但`gitk`由于某种原因没有显示它们是交错的。

孤立的提交（在图片中间）是我试图摆脱的那些，它们似乎没有附加到任何分支。我的 repo 中的任何 HEAD 都没有返回到这组提交的路线。

到目前为止，我已经尝试过（以防万一它有所作为）：

```
git remote prune
git prune
git gc
git gc --aggressive --prune=tomorrow
git remote update --prune
git fetch --all 
```

但目前还没有任何帮助。谁能建议我如何从我的仓库中删除这些提交？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T14:32:52.730

您只`0.1.something`需要`something`使用`git tag -d 0.1.something`. 完成此操作后，提交将是 gc-able。

只要有一个标签到达一个提交，这个提交就被认为是可达的，因此将“永远”持续存在，它实际上不受垃圾收集的影响，直到你删除任何指向它的引用（分支、标签、其他引用、. ..)

# python - 如何过滤pexpect的输出

> ID：12093971
> 
> 赞同：2
> 
> 时间：2012-08-23T14:30:01.373
> 
> 标签：python, pexpect

在 python pexpect 中，我想过滤输出。例如，在下面的代码中，我只想打印日期。

```
#!/usr/bin/env python
import pexpect,time
p=pexpect.spawn('ssh myusername@192.168.151.80')
p.expect('Password:')
p.sendline('mypassword')
time.sleep(2)
p.sendline('date')
p.expect('IST')
current_date = p.before
print 'the current date in remote server is: %s' % current_date 
```

**实际输出：**

```
the current date in remote server is:
Last login: Thu Aug 23 22:58:02 2012 from solaris3
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
welcome
-bash-3.00$ date
Thu Aug 23 23:03:10 
```

**预期输出：**

```
the current date in remote server is: Thu Aug 23 23:03:10 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T09:02:28.523

`before`会给你自上次`expect`通话以来的一切。

您可以在换行符上拆分输出：

```
current_date = p.before.split('\n')[-1] 
```

但是，最好期待提示而不是睡 2 秒：

```
p.sendline('mypassword')
p.expect('[#\$] ')
p.sendline('date') 
```

# objective-c - 后台任务似乎没有被取消/结束

> ID：12093974
> 
> 赞同：4
> 
> 时间：2012-08-23T14:30:09.680
> 
> 标签：objective-c, ios, background, location, nsthread

我们目前正在开发一个需要在后台检查位置的 iOS 应用程序。起初，我们尝试使用重大的位置变化，但它们不够准确/触发频率不够。我们考虑过使用区域监控，但根据我在网上阅读的内容，这也不总是准确的，而且您还存在要监控的区域数量有限的问题。（我们最终可能会尝试区域监控。）然而，目前，我们正在尝试使用标准位置更新来在后台跟踪用户位置，并计划每隔 5 分钟左右检查一次。 .

该应用程序在后台注册位置更新（使用“应用程序注册位置更新”作为“必需的后台模式”），我们启动一个后台任务，它检查一次位置，停止位置更新，然后使用`NSThread sleepForTimeInterval:`（目前，而我们正在开发中）暂停任务 10 秒。然后它再次检查位置，停止位置更新，暂停 10 秒等。

这似乎按预期工作......当应用程序进入后台时，我们会每 10 秒收到一个包含位置更新的日志/通知，当应用程序重新打开时，日志/通知会停止。然而，问题是当应用程序第二次进入后台时，原来的后台任务似乎从未取消，并创建了一个新任务，所以现在有两个任务在运行，每个任务在 10 秒时检查位置在间隔上。如果应用程序多次打开/发送到后台，则会为每个应用程序启动一个后台任务。

我考虑过设置一个标志来说明“应用程序是否已至少发送到后台一次？”，并且仅在第一次将其发送到后台时才运行该任务，但这似乎会导致其他问题，并且（如一个相对较新的iOS开发人员）我很好奇为什么当应用程序进入前台时后台任务没有被取消。

AppDelegate.h 文件包含...

```
@interface AppDelegate : UIResponder <UIApplicationDelegate, CLLocationManagerDelegate> {
    UIWindow *window;
    UINavigationController *navigationController;

    UIBackgroundTaskIdentifier bgTask;
    BOOL inBackground;
} 
```

AppDelegate.m 文件包含...

```
- (void)applicationDidEnterBackground:(UIApplication *)application {
    inBackground = YES;

    bgTask = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [[UIApplication sharedApplication] endBackgroundTask:bgTask];
        bgTask = UIBackgroundTaskInvalid;
    }];

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        while (inBackground == YES) {
            NSLog(@"%@", @"Check location...");
            [locationManager startUpdatingLocation];

            [NSThread sleepForTimeInterval:10];
        }

        [[UIApplication sharedApplication] endBackgroundTask:bgTask];
        bgTask = UIBackgroundTaskInvalid;
    });
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.
    inBackground = NO;

    [[UIApplication sharedApplication] endBackgroundTask:bgTask];
    bgTask = UIBackgroundTaskInvalid;
} 
```

位置更新按预期工作，我只是无法弄清楚为什么当应用程序进入前台时后台任务没有被取消/结束。我确实想知道这是否与 . 有任何关系`NSThread sleepForTimeInterval:`，但我不确定是否是，或者如何修复它（如果确实如此）。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:29:36.580

您不会通过睡觉然后请求它们来管理位置更新。您可以通过在（如您所做的那样）中设置“位置”来管理位置更新`UIBackgroundMode`，然后实施`CLLocationManagerDelegate`. 这与`beginBackgroundTaskWithExpirationHandler:`. 那是为了请求额外的时间（最多大约 10 分钟）来完成给定的操作。您根本不应该仅仅为了获取位置更新而调用它。

一旦您在 中注册为位置应用程序`UIBackgroundMode`，只要位置在您为位置管理器指定的精度范围内发生变化，您就会自动获取更新。系统将为您完成所有工作。

* * *

您所描述的内容实际上可能会损害电池寿命，因为它会破坏操作系统管理多个位置传感器（其中 GPS 只是其中之一）的能力。通过设置正确的准确性（如果重大更改太粗略）告诉操作系统您需要什么，然后让它完成它的工作。从 GPS 获得真正准确的位置非常昂贵。您应该先进行电池测试，然后再假设每 5 分钟进行一次比继续开机更便宜。保存功率的最佳方法是降低所需的精度。你可以把它调低到一个粗略的水平，然后当你来到前景时将它移动到一个准确的水平。但是每 5 分钟*准确*跟踪一次用户的位置会很昂贵。很难解决这个问题。

顺便说一句，您在这里真正想做的是每 5 分钟运行一次“某事”。iOS 中没有这种机制。您可以要求或不要求位置服务（并以各种方式进行配置）。你不能要求“我想每五分钟醒来一次，然后……做任何事”。大约 10 分钟后，如果你不打电话，你就会被杀死`endBackgroundTask:`。

关于为什么任务没有被取消的问题，请参阅[How to use beginBackgroundTaskWithExpirationHandler for already running task in iOS](https://stackoverflow.com/questions/12071726/how-to-use-beginbackgroundtaskwithexpirationhandler-for-already-running-task-in/12074879#12074879)。正如我所说，这个“后台任务”不是你想要解决这个问题的工具。这是完全无关的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T14:27:02.353

我相当确定`bgTask`当应用程序返回前台时您的实例变量正在重新分配，因此该值不包含您要杀死的标识符。考虑将此标识符保存在`NSUserDefaults`或更永久的位置，然后再检索它。

# httpwebrequest - 使用 ASP.NET HttpWebRequest 爬取维基百科

> ID：12093976
> 
> 赞同：0
> 
> 时间：2012-08-23T14:30:17.903
> 
> 标签：httpwebrequest, web-crawler, wikipedia

我是新手`Web Crawling`，我正在使用`HttpWebRequest`从网站抓取数据。

到目前为止，我已经成功地从我的 wordpress 网站抓取并获取数据。该数据是一个简单的用户配置文件数据。（如姓名、电子邮件、AIM id 等...）

现在作为一个练习，我想爬取维基百科，我将使用最后输入到文本框中的值进行搜索，然后使用搜索值爬取维基百科并从搜索中获取适当的标题。

现在我有以下疑问/困难。

*   首先，这甚至可能吗？我听说 wiki 有 robots.txt 设置来阻止这个。虽然我只从朋友那里听说过，因此不确定。

*   我正在使用我之前使用的相同程序，但我没有得到所需的结果。

谢谢 ！

**更新：** 经过[@svick](https://stackoverflow.com/users/41071/svick)的一些解释和帮助，我尝试了下面的代码，但仍然无法获得任何值（参见最后一行代码，我期待搜索结果页面的 html 标记）

```
string searchUrl = "http://en.wikipedia.org/w/index.php?search=Wikipedia&title=Special%3ASearch";

var postData = new StringBuilder();
postData.Append("search=" + model.Query);
postData.Append("&");
postData.Append("title" + "Special:Search");

byte[] data2 = Crawler.GetEncodedData(postData.ToString());

var webRequest = (HttpWebRequest)WebRequest.Create(searchUrl);

webRequest.Method = "POST";
webRequest.UserAgent = "Crawling HW (http://yassershaikh.com/contact-me/)";
webRequest.AllowAutoRedirect = false;

ServicePointManager.Expect100Continue = false;

Stream requestStream = webRequest.GetRequestStream();
requestStream.Write(data2, 0, data2.Length);
requestStream.Close();

var responseCsv = (HttpWebResponse)webRequest.GetResponse();
Stream response = responseCsv.GetResponseStream();

// Todo Parsing
var streamReader = new StreamReader(response);
string val = streamReader.ReadToEnd();

// val is empty !! <-- this is my problem ! 
```

这是我的`GetEncodedData`方法定义。

```
public static byte[] GetEncodedData(string postData)
    {
        var encoding = new ASCIIEncoding();
        byte[] data = encoding.GetBytes(postData);
        return data;
    } 
```

请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T15:04:59.643

1.  您可能不需要使用`HttpWebRequest`. 使用`WebClient`（或者`HttpClient`如果您使用的是 .Net 4.5）对您来说会容易得多。
2.  [`robots.txt`](http://en.wikipedia.org/wiki/Robots.txt)实际上并没有阻止任何东西。如果某些东西不支持它（并且.Net 不支持它），它可以访问任何东西。
3.  Wikipedia 确实会阻止未设置[`User-Agent`标头](http://en.wikipedia.org/wiki/User_agent)的请求。[并且您应该在您的联系信息中使用信息丰富的 User-Agent 字符串。](http://meta.wikimedia.org/wiki/User-Agent_policy)
4.  访问 Wikipedia 的更好方法是使用[它的 API](https://www.mediawiki.org/wiki/API)，而不是抓取。这样，您将获得一个专门供自定义应用程序读取的答案，格式为 XML 或 JSON。[还有包含来自维基百科的所有信息的转储可供下载。](http://en.wikipedia.org/wiki/Wikipedia%3aDatabase_download)

**编辑：**您新发布的代码的问题是您的查询返回[302 Moved Temporarily](http://en.wikipedia.org/wiki/HTTP_302)对搜索文章的响应（如果存在）。删除 forbids 的行`AllowAutoRedirect`，或添加`&fulltext=Search`到您的查询中，这意味着您不会被重定向。

# openssl - 当服务器重新启动并且重新启动后无法恢复时，libcurl 失败并出现错误代码 56 (ssl_read) 和错误代码 58

> ID：12093984
> 
> 赞同：1
> 
> 时间：2012-08-23T14:30:50.103
> 
> 标签：openssl, libcurl

如果服务器重新启动，使用 libcurl 句柄（简单接口）从客户端到服务器的通信将失败。

该程序（粘贴在下面的代码）创建一个 curl 句柄，初始化 url、证书、超时、请求等选项。然后在每 2 秒的无限循环中使用 curl 句柄向服务器发送请求。

观察结果如下：

1.  程序启动后，客户端到服务器的通信正确建立，消息交换没有任何错误。
2.  后来我给服务器机器供电。当服务器关闭时，curl_easy_perform 失败，错误代码=28，“已达到超时（connect() 超时！）”。
3.  然后我打开机器，在机器启动时，观察到 curl_easy_perform 失败，错误代码=7，“无法连接到服务器（无法连接到主机）”。
4.  一旦 curl 句柄能够连接到服务器端口，观察到 ssl_read 错误，curl 错误代码 = 56，“从对等方接收数据时失败（SSL 读取：错误：14094412：SSL 例程：SSL3_READ_BYTES：sslv3 警报错误证书，errno 0） "
5.  进一步向前 curl_easy_perform 失败，错误代码=58，“本地 SSL 证书有问题（无法使用客户端证书（未找到密钥或密码错误？））”，此后再也无法恢复。
6.  如果我停止程序并重新启动，则连接建立成功。证书没有变化。

我无法找到为什么会`curl_easy_perform`因 ssl_read 错误而失败以及为什么进一步说错误代码 = 58（无法使用客户端证书）。

由于最初使用相同的证书进行通信，并且在重新启动该过程之后，我认为证书没有问题。

我尝试了 openssl 命令来验证证书是否正确。

```
Linux# openssl x509 -noout -modulus -in /opt/certstore/VcCombined.pem | openssl md5
fe18e9f364d18eba9f39690563aca836

Linux# openssl rsa -noout -modulus -in /opt/certstore/default.key | openssl md5
fe18e9f364d18eba9f39690563aca836

Linux# openssl verify -CAfile /opt/certstore/sslca/CACertificate.pem /opt/certstore/VcCombined.pem
/opt/certstore/VcCombined.pem: OK 
```

我不确定如何进一步调试此问题。如果它与 openssl 或 curl 或我的程序有关。

客户端：

```
curl --version

curl 7.25.0 (i686-pc-linux-gnu) libcurl/7.25.0 OpenSSL/0.9.8f zlib/1.2.1.2 libidn/0.5.6
Protocols: dict file gopher http https imap imaps pop3 pop3s rtsp smtp smtps telnet
Features: IDN IPv6 Largefile NTLM NTLM_WB SSL libz 
```

服务器端：

```
curl --version

curl 7.25.0 (i686-pc-linux-gnu) libcurl/7.25.0 OpenSSL/1.0.0e zlib/1.2.1.2 libidn/0.5.6
Protocols: dict file gopher http https imap imaps pop3 pop3s rtsp smtp smtps telnet
Features: IDN IPv6 Largefile NTLM NTLM_WB SSL libz 
```

程序：

```
using namespace std;

static std::string buffer;

static int writer(char *data, size_t size, size_t nmemb, std::string *buffer)
{
    int result = 0;

    if (buffer != NULL)
    {
        buffer->append(data, size * nmemb);
        result = size * nmemb;
    }

    return result;
}

int main(void)
{
    CURL *curl;
    CURLcode res;
    char request[4096];
    char curl_errbuf[CURL_ERROR_SIZE];
    int bytes_read = 0;

    FILE *lFile = fopen("/tmp/getguid.xml", "r");
    if (lFile == NULL)
    {
        printf("fopen Error: %s\n", strerror(res));
        return 1;
    }

    memset(request, 0, 4096);
    bytes_read = fread(request, sizeof(request), 1, lFile);
    fclose(lFile);

    curl = curl_easy_init();

    struct curl_slist* lcurlHeaders = NULL;
    lcurlHeaders = curl_slist_append(lcurlHeaders, "Content-Type: text/xml");
    curl_easy_setopt(curl, CURLOPT_HTTPHEADER, lcurlHeaders);
    curl_easy_setopt(curl, CURLOPT_URL, "https://10.65.124.221:443/xmlInternal/service-reg/forward");
    curl_easy_setopt(curl, CURLOPT_TIMEOUT, 10);
    char *lUCSInterfaceName = "eth0";
    curl_easy_setopt(curl, CURLOPT_INTERFACE, lUCSInterfaceName);
    curl_easy_setopt(curl, CURLOPT_SSLCERT, "/opt/certstore/VcCombined.pem");
    curl_easy_setopt(curl, CURLOPT_SSLKEY, "/opt/certstore/default.key");
    curl_easy_setopt(curl, CURLOPT_CAINFO, "/opt/certstore/sslca/CACertificate.pem");
    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);
    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 1L);
    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 1L);
    curl_easy_setopt(curl, CURLOPT_NOSIGNAL, 1L);
    curl_easy_setopt(curl, CURLOPT_POST, 1);
    curl_easy_setopt(curl, CURLOPT_POSTFIELDS, (char*)request);
    curl_easy_setopt(curl, CURLOPT_POSTFIELDSIZE, strlen(request));
    curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, curl_errbuf);
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, writer);
    curl_easy_setopt(curl, CURLOPT_WRITEDATA, &buffer);

    while(1)
    {
        memset(curl_errbuf, 0, CURL_ERROR_SIZE);
        res = curl_easy_perform(curl);

        if(CURLE_OK != res)
            printf("curl_easy_perform Error: %s (%s)\n", curl_easy_strerror(res), curl_errbuf);
        else
            printf("curl_easy_perform succes\n");

        sleep(2);
    }

    curl_slist_free_all(lCurlHeaders);
    curl_easy_cleanup(curl);
    return 0;
} 
```

# ios - 用新行替换NSString

> ID：12093986
> 
> 赞同：3
> 
> 时间：2012-08-23T14:30:52.780
> 
> 标签：ios, nsstring, line-breaks

我有一个`NSString`这样的

`NSString *string = @"textTextTextTextText<br>textTextTextText<br>TextTextText"`

我想将此设置`NSString`为 my 的文本，并在字符串上找到的`UICell`每个标签上都有一个新行。
我怎么能那样做？

我试过这个，没有成功：

`cell.textLabel.text = [[text componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]] componentsJoinedByString:@"<br>"];`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T14:36:01.220

怎么样：

```
string = [string stringByReplacingOccurrencesOfString: @"<br>" withString: @"\n"] 
```

或者，如果您使用的是 Swift`Strings`

```
var string = "textTextTextTextText<br>textTextTextText<br>TextTextText"
string = Array(string).reduce("") {$0 + ($1 == "<br>" ? "\n" : $1)} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:35:21.800

```
NSString * result =
  [string stringByReplacingOccurrencesOfString:@"<br>" withString:@"\n"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-28T09:04:33.457

**SWIFT 5：** 如果您使用的是 Swift 字符串（您可以将 NSString 转换为字符串）：

```
var string = "line1<br>line2<br>line3"
string = string..replacingOccurrences(of: "<br>", with: "\n")) 
```

# scripting - 如何使用 AutoHotKey 反转 unicode 字符串并将其粘贴？

> ID：12093990
> 
> 赞同：1
> 
> 时间：2012-08-23T14:31:00.803
> 
> 标签：scripting, autohotkey

我有这个用英语工作的反向功能，

但是它不适用于希伯来语，

```
Reverse(string)
{
length := StrLen(string)
Loop, parse, string
{
loc := Abs(A_Index - length) + 1
revloc%loc% := A_LoopField
}
Loop %length%
final .= revloc%A_index%
return final
}
ReverseByAddress(address,len){
   Loop % (len){
      out.=Chr(NumGet(address+0,len-A_index,"Char"))
   }
   Return out
}

^m::
;ClipSaved := ClipboardAll 
;text.="new line of some text`n"
text= %Clipboard%
clipboard := Reverse(text)
send, ^v 
```

任何有关使用 Unicode 进行这项工作的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T14:36:44.840

无需将数据保存回剪贴板即可解决此问题：

```
^,::
text= %Clipboard%
newText := Reverse(text)
send, %newText% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-03T08:07:41.067

你能得到这样的时间表吗，只有 2 或 3 个字符？

```
2 character ex.  -AutoHotKey -> uAotoHKtYe 
................................uA ot oH Kt Ye 
```

或者

```
3 character ex.  -AutoHotKey -> tuAoHoeKty 
                          ......tuA oHo eKt y 
```

# html - 我应该将排版部分与 HTML 层次结构分开吗？

> ID：12093996
> 
> 赞同：0
> 
> 时间：2012-08-23T14:31:21.640
> 
> 标签：html, css, typography

将 CSS 规则的单独部分仅适用于排版是一种好习惯吗？还是应该成为 HTML 层次结构流的一部分？

这个问题主要是从可读性和可维护性的角度来看的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T14:37:43.223

在我看来，最好的做法是保持模块化。将您的 CSS 放在自己的文件中，如果您有很多样式（非常常见），我会说您可以`typography.css`让规则非常清晰。HTML 应该是有意义的（因为 HTML5 的目的是回到这个想法），这应该超越标签的使用扩展到文件的放置和代码的可读性。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T14:37:19.960

这个问题当然没有正确的答案，但根据我的经验：两者兼而有之。

我觉得我从一个好的 css 重置中获得了很多，而且他们确实倾向于处理一些排版。但除此之外，我还没有从单独的排版样式表中获益。