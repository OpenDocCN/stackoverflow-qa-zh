# StackOverflow 问答 000936000-000936999

# .net - .tif 图像不存在 ProcessStartInfo 打印动词

> ID：936009
> 
> 赞同：0
> 
> 时间：2009-06-01T18:11:53.257
> 
> 标签：.net, vb.net, printing, process

我们有一款软件尝试使用 ProcessStartInfo 对象打印 .tif 图像。它将 Verb 属性设置为“打印”，将 FileName 属性设置为图像的路径。然后它将 UseShellExecute 属性设置为 true 并执行 Process.Start() 方法。

然而，什么也没有发生。我创建了一个小型测试程序来列出与 .tif 图像关联的动词，它只显示“Shell”，但不显示“print”。

我无法修改这个软件，那么有没有办法为 .tif 图像类型定义或注册“打印”动词以允许它们打印？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:23:21.600

首先，您可能正在寻找的动词可能是`printto`

您也可以使用 shell 直接执行 print 命令

```
"%SystemRoot%\System32\rundll32.exe" "%SystemRoot%\System32\shimgvw.dll",ImageView_PrintTo /pt "%1" "%2" "%3" "%4" 
```

参数在[KB224961](http://support.microsoft.com/kb/224961)中解释为：

```
%1  File name
%2  Printer name
%3  Driver name
%4  Port name
/p  Print
pt  Printto 
```

# python - 一种生成满足某些条件的集合子集的算法

> ID：936015
> 
> 赞同：1
> 
> 时间：2009-06-01T18:13:13.033
> 
> 标签：python, algorithm, subset

假设给定一个元素的排序列表，并且我想生成满足某个条件的所有子集，这样如果给定的集合不满足条件，那么更大的子集也将不满足它，并且一个元素的所有集合都满足它。

例如，给定一个小于 100 的所有正整数的列表，确定总和小于 130 的子集：(100,29) (0,1,40)、(0) 等...

我该怎么做（最好在 Python 中）？

谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T18:34:04.747

您可以使用[分支定界](http://en.wikipedia.org/wiki/Branch_and_bound)技术生成所有子集：您可以以增量方式生成所有子集（生成已经确定的子集的超集），使用作为修剪条件“如果根不满足约束”。

如果您想对约束通用，我认为这是最好的策略。

确保以正确的方式编写生成子集的代码，否则您会多次生成相同的子集：为了避免记忆化（由于地图查找和引入内存开销可能会很耗时），您可以生成子集以这种方式：

```
GetAllSubsets(List objects) {
    List generated = {};
    GetAllSubsets(generated, [], objects);
    return generated;
}

GetAllSubsets(List subsetGenerated, List objectFixed, List objectsToFix) {
    GetAllSubsets(subsetGenerated, objectFixed, objectsToFix.sublist(1, objectsToFix.length());
    if (satisfy(toCheck = objectsFixed.add(objectsToFix.get(0)))) {
        subsetGenerated.add(toCheck);
        GetAllSubsets(subsetGenerated, toCheck, objectsToFix.sublist(1, objectsToFix.length());
    }
} 
```

事实上，第一次调用GetAllSubsets添加的子集没有objectsToFix的第一个元素，而第二次调用添加的子集（如果不违反修剪条件）有那个元素，所以两者的交集生成的子集集是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T18:55:35.720

您可以递归地构造集合，从空集合开始并尝试添加更多元素，如果其中一个子集（以及它的所有超集）不满足条件，则放弃递归执行行。这是一些伪代码，假设您想列出一个集合 S 其满足条件的子集。为方便起见，假设 S 的元素可以索引为 x(0), x(1), x(2), ...

```
EnumerateQualifyingSets(Set T)
{
    foreach (x in S with an index larger than the index of any element in T)
    {
            U = T union {x}

            if (U satisfies condition)
            {
                print U
                EnumerateQualifyingSets(U)
            }
    }
} 
```

第一次调用将以 T 作为空集。然后，将打印所有符合条件的 S 子集。这种策略主要依赖于这样一个事实，即不满足条件的 S 子集不能包含在满足条件的子集中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T18:20:22.883

当然有办法做到这一点，但除非你能以某种方式限制条件，否则它将采取 O(2^n) 步骤。例如，如果您考虑在 1-100 上选择所有子集的条件（例如，< Σ *i* for *i* in 1- *n*），那么您最终将枚举所有子集。

你会看着

```
for i in the powerset of {1-n}
    if cond(i)
       note that set 
```

您可以通过简单地生成从 0 到 s *n* -1 的所有二进制数，并在位 i 为 1 时为子集选择元素 i 来获得集合的幂集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T19:13:33.593

我为课程表生成算法做了类似的事情。我们的日程安排类有 2 个元素 - 添加到日程安排的课程列表和可添加的课程列表。

伪代码：

```
queue.add(new schedule(null, available_courses))
while( queue is not empty )
    sched = queue.next()
    foreach class in sched.available_courses
        temp_sched = sched.copy()
        temp_sched.add(class)
        if(temp_sched.is_valid())
            results.add(temp_sched)
            queue.add(temp_sched) 
```

这个想法是从一个空的时间表和可用课程的列表开始，然后在树中搜索有效的时间表（有效的含义符合用户给出的要求，没有时间冲突等）。如果一个时间表无效，它就会被丢弃——我们不能通过添加类（即修剪树）使无效的时间表有效。

修改它以解决您的问题应该很容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T19:26:26.453

这是 akappa 答案的具体示例，使用递归函数生成子集：

```
def restofsubsets(goodsubset, remainingels, condition):
    answers = []
    for j in range(len(remainingels)):
        nextsubset = goodsubset + remainingels[j:j+1]
        if condition(nextsubset):
            answers.append(nextsubset)
            answers += restofsubsets(nextsubset, remainingels[j+1:], condition)
    return answers

 #runs slowly
 easieranswer = restofsubsets([], range(101), lambda l:sum(l)<40)

 #runs much faster due to eliminating big numbers first
 fasteranswer = restofsubsets([], range(100,-1,-1), lambda l:sum(l)<40)

 #runs extremely slow even with big-numbers-first strategy
 finalanswer = restofsubsets([], range(100,-1,-1), lambda l:sum(l)<130) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-14T05:37:54.640

我认为在最坏的情况下，您仍然必须生成所有子集并计算每个集的总和以确定它是否合格。渐近地，它是子集生成过程的成本。

以下是我在 javascript 中实现相同想法的方法。

```
//this is to generate an array to test
var numbers = (function(start, end){
    var result = [],
        i =  start; 
    for(; i <= end; i++){
        result.push(i);
    }
    return result; 
})(1, 12);

//this is the qualifying function to determine if the generated array is qualified
var fn = (function(maxSum){
    return function(set){
        var sum = 0;
        for(var i = 0 ; i< set.length; i++){
            sum += set[i];
            if( sum > maxSum ){
                return false;
            }
        }
        return true;
    }
})(30);

//main function
(function(input, qualifyingFn){
    var result, mask, total = Math.pow(2, input.length);
    for(mask = 0; mask < total; mask++){

        result = [];
        sum = 0;

        i = input.length - 1; 
        do{
            if( (mask & (1 << i)) !== 0){
                result.push(input[i]);
                sum += input[i];
                if( sum > 30 ){
                    break;
                }
            }
        }while(i--);
        if( qualifyingFn(result) ){
            console.log(JSON.stringify(result));
        }
    }

})(numbers, fn); 
```

# c# - 获取 DLL 的函数列表

> ID：936019
> 
> 赞同：1
> 
> 时间：2009-06-01T18:14:05.263
> 
> 标签：c#, .net

我正在建立一个项目。这是一个用户可以添加其扩展（DLL 文件）的应用程序。要管理扩展，我需要获取它的类、函数等列表。有代码吗？

注意：我使用的是 C#。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T18:16:32.717

对于特定的程序集，您可以使用[`Assembly.GetTypes`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)来获取类型，然后为每个类型调用[`Type.GetMethods()`](http://msdn.microsoft.com/en-us/library/system.type.getmethods.aspx)等[`Type.GetProperties()`](http://msdn.microsoft.com/en-us/library/system.type.getproperties.aspx)，或者只是[`Type.GetMembers()`](http://msdn.microsoft.com/en-us/library/system.type.getmembers.aspx).

然而，对于插件功能来说，拥有一个插件必须实现的通用接口通常是一个好主意——这可以减少您需要使用的反射量。用于[`Type.IsAssignableFrom()`](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)检查类型是否与特定接口兼容。

您可能还想查看[Managed Extensibility Framework](http://code.msdn.microsoft.com/mef)，它可以更轻松地实现扩展系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:19:47.237

如果您正在谈论在 C# 中构建一个可扩展的应用程序来加载其他程序集并使用它们的内容来扩展应用程序，请参阅 Stack Overflow 问题*[System with plugins in C#](https://stackoverflow.com/questions/515925/system-with-plugins-in-c/515972#515972)*。

# objective-c - 从 Cocoa 中的文件中读取“N”个字节

> ID：936020
> 
> 赞同：18
> 
> 时间：2009-06-01T18:14:18.197
> 
> 标签：objective-c, cocoa, nsdata

如何从指定文件中仅读取“N”个字节？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-01T20:02:05.647

如果您希望以类似于通过 NSData 加载文件但不实际将所有内容读入内存的方式随机访问文件的内容，则可以使用内存映射。这样做意味着磁盘上的文件被视为虚拟内存的一部分，并且将像常规虚拟内存一样被分页和分页。

```
NSError * error = nil;
NSData * theData = [NSData dataWithContentsOfFile: thePath
                                          options: NSMappedRead
                                            error: &error]; 
```

如果您不关心获取文件系统错误详细信息，则可以使用：

```
NSData * theData = [NSData dataWithContentsOfMappedFile: thePath]; 
```

然后你只需使用 NSData 的`-getBytes:range:`方法来提取特定的数据，实际上只会从永久存储中读取文件的相关部分；他们也将有资格被调出。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-01T19:00:19.330

[-[NSFileHandle readDataOfLength:]](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileHandle/readDataOfLength:)。

```
NSFileHandle *handle = [NSFileHandle fileHandleForReadingAtPath:filePath];
NSData *fileData = [handle readDataOfLength:N];
[handle closeFile]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T18:24:18.103

如果你想避免读取整个文件，你可以使用标准的 CI/O 函数：

```
#include <stdio.h>
...
FILE *file = fopen("the-file.dat", "rb");
if(file == NULL)
    ; // handle error
char theBuffer[1000];  // make sure this is big enough!!
size_t bytesRead = fread(theBuffer, 1, 1000, file);
if(bytesRead < 1000)
    ; // handle error
fclose(file); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T18:18:52.353

打开文件：

```
NSData *fileData = [NSData dataWithContentsOfFile:fileName]; 
```

读取你想要的字节：

```
int bytes[1000];
[fileData getBytes:bytes length:sizeof(int) * 1000]; 
```

# c# - WebClient 多线程响应

> ID：936021
> 
> 赞同：2
> 
> 时间：2009-06-01T18:14:25.997
> 
> 标签：c#, httpwebrequest

我正在使用 WebClient 对我的 Web 服务执行两个并行请求，并使用 ThreadPool 对它们进行多线程处理。但是，我在收到此 WebException 的线程之一中遇到问题：

> 服务器违反了协议。Section=ResponseStatusLine

我做了一些研究，发现这可能是一个不安全的标头验证问题，但请求在单线程模式下工作正常。

所以为了澄清，我正在触发两个线程。一种是对 URI 进行 GET，另一种是对 URI 进行一些数据的 POST。第一个 GET 工作正常，但 POST 失败并出现上面的 WebException。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T23:15:17.893

我通过添加解决了我的问题

```
request.ServicePoint.Expect100Continue = false; 
```

在拨打我的 POST 电话之前。根据wireshark发生的事情是我的HttpWebRequest期待100继续，但得到401未授权，但它在服务器响应后发送数据，而不是发送授权标头。它并非每次都发生，但这似乎可以解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T11:04:27.337

将以下内容添加到 web.config 解决了我的问题。

```
 <system.net>
    <settings>
      <httpWebRequest useUnsafeHeaderParsing="true" />
    </settings>
  </system.net> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T18:17:28.597

请注意，不保证 WebClient 类的实例是线程安全的。您是在线程中使用一个 WebClient 实例，还是每个线程都有自己的实例？应该是后者。

# c++ - 使用 boost accumulators 库的权利包括哪些？

> ID：936025
> 
> 赞同：4
> 
> 时间：2009-06-01T18:15:17.320
> 
> 标签：c++

我正在尝试编译[这个例子](http://boost-sandbox.sourceforge.net/libs/accumulators/doc/html/accumulators/user_s_guide/the_statistical_accumulators_library.html#accumulators.user_s_guide.the_statistical_accumulators_library.weighted_p_square_cumulative_distribution)

但是一个标题是不够的，我已经花了半个小时试图消除所有的错误。为什么没有指定所需的包含？

我这样做了：

```
#include <boost/accumulators/statistics/weighted_p_square_cumulative_distribution.hpp>
#include <vector>
#include <boost/accumulators/accumulators.hpp> 
#include <boost/test/test_tools.hpp>
#include <boost/random/lagged_fibonacci.hpp>
#include <boost/random/normal_distribution.hpp>
#include <boost/random/variate_generator.hpp>
#include <boost/range/iterator_range.hpp>
#include <boost/fusion/support/void.hpp>
#include <boost/accumulators/framework/depends_on.hpp>

using namespace boost::accumulators;
using namespace boost;

int main() {
    // tolerance in %
    double epsilon = 4;

    typedef accumulator_set<double, stats<tag::weighted_p_square_cumulative_distribution>, double > accumulator_t;

    accumulator_t acc_upper(tag::weighted_p_square_cumulative_distribution::num_cells = 100);
    accumulator_t acc_lower(tag::weighted_p_square_cumulative_distribution::num_cells = 100);

    // two random number generators
    double mu_upper = 1.0;
    double mu_lower = -1.0;
    boost::lagged_fibonacci607 rng;
    boost::normal_distribution<> mean_sigma_upper(mu_upper,1);
    boost::normal_distribution<> mean_sigma_lower(mu_lower,1);
    boost::variate_generator<boost::lagged_fibonacci607&, boost::normal_distribution<> > normal_upper(rng, mean_sigma_upper);
    boost::variate_generator<boost::lagged_fibonacci607&, boost::normal_distribution<> > normal_lower(rng, mean_sigma_lower);

    for (std::size_t i=0; i<100000; ++i)
    {
        double sample = normal_upper();
        acc_upper(sample, weight = std::exp(-mu_upper * (sample - 0.5 * mu_upper)));
    }

    for (std::size_t i=0; i<100000; ++i)
    {
        double sample = normal_lower();
        acc_lower(sample, weight = std::exp(-mu_lower * (sample - 0.5 * mu_lower)));
    }

    typedef iterator_range<std::vector<std::pair<double, double> >::iterator > histogram_type;
    histogram_type histogram_upper = weighted_p_square_cumulative_distribution(acc_upper);
    histogram_type histogram_lower = weighted_p_square_cumulative_distribution(acc_lower);

    // Note that applaying importance sampling results in a region of the distribution 
    // to be estimated more accurately and another region to be estimated less accurately
    // than without importance sampling, i.e., with unweighted samples

    for (std::size_t i = 0; i < histogram_upper.size(); ++i)
    {
        // problem with small results: epsilon is relative (in percent), not absolute!

        // check upper region of distribution
        if ( histogram_upper[i].second > 0.1 )    
            BOOST_CHECK_CLOSE( 0.5 * (1.0 + erf( histogram_upper[i].first / sqrt(2.0) )), histogram_upper[i].second, epsilon );
        // check lower region of distribution
        if ( histogram_lower[i].second < -0.1 )    
            BOOST_CHECK_CLOSE( 0.5 * (1.0 + erf( histogram_lower[i].first / sqrt(2.0) )), histogram_lower[i].second, epsilon );
    }
} 
```

我得到了这些错误：

```
In file included from /opt/local/include/boost/accumulators/statistics/weighted_p_square_cumulative_distribution.hpp:17,
                 from a.cc:1:
/opt/local/include/boost/accumulators/framework/extractor.hpp: In instantiation of 'boost::accumulators::detail::accumulator_set_result<boost::accumulators::accumulator_set<double, boost::accumulators::stats<boost::accumulators::tag::weighted_p_square_cumulative_distribution, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na>, double>, boost::accumulators::tag::weighted_p_square_cumulative_distribution>':
/opt/local/include/boost/mpl/eval_if.hpp:38:   instantiated from 'boost::mpl::eval_if<boost::accumulators::detail::is_accumulator_set<boost::accumulators::accumulator_set<double, boost::accumulators::stats<boost::accumulators::tag::weighted_p_square_cumulative_distribution, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na>, double> >, boost::accumulators::detail::accumulator_set_result<boost::accumulators::accumulator_set<double, boost::accumulators::stats<boost::accumulators::tag::weighted_p_square_cumulative_distribution, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na>, double>, boost::accumulators::tag::weighted_p_square_cumulative_distribution>, boost::accumulators::detail::argument_pack_result<boost::accumulators::accumulator_set<double, boost::accumulators::stats<boost::accumulators::tag::weighted_p_square_cumulative_distribution, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na>, double>, boost::accumulators::tag::weighted_p_square_cumulative_distribution> >'
/opt/local/include/boost/accumulators/framework/extractor.hpp:57:   instantiated from 'boost::accumulators::detail::extractor_result<boost::accumulators::accumulator_set<double, boost::accumulators::stats<boost::accumulators::tag::weighted_p_square_cumulative_distribution, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na>, double>, boost::accumulators::tag::weighted_p_square_cumulative_distribution>'
a.cc:47:   instantiated from here
/opt/local/include/boost/accumulators/framework/extractor.hpp:36: error: no type named 'result_type' in 'struct boost::fusion::void_'
a.cc: In function 'int main()':
a.cc:47: error: no match for call to '(const boost::accumulators::extractor<boost::accumulators::tag::weighted_p_square_cumulative_distribution>) (main()::accumulator_t&)'
a.cc:48: error: no match for call to '(const boost::accumulators::extractor<boost::accumulators::tag::weighted_p_square_cumulative_distribution>) (main()::accumulator_t&)' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-30T21:01:43.430

文档中显示的示例是从库的单元测试中提取的。看一眼`libs/accumulators/test/weighted_p_square_cum_dist.cpp`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:18:21.107

不幸的是，你没有显示你得到的编译错误，所以我会在黑暗中尝试一下：

你用过吗

```
using namespace boost::accumulators; 
```

在你的代码中？为简洁起见，大多数示例都需要这样做。

*编辑：*
现在您发布了代码（并且我也检查了链接中的代码示例），在我看来，示例已损坏。关键错误似乎是：

> 错误：“struct boost::fusion::void_”中没有名为“result_type”的类型</p>

但是由于我没有使用*boost::accumulators*的经验，所以我不得不在这里放弃:-(

也许你可以联系*boost::accumulators*的作者，让他知道这个例子不是开箱即用的。他应该能够修正这个例子。你甚至可能会因为发现问题而受到赞誉:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:27:47.717

```
 error: no type named ‘result_type’ in ‘struct boost::fusion::void_’ 
```

很抱歉我无法提供明确的解决方案，但我希望我能帮助找出问题所在。Boost fusion 使您能够构建结构等效的对象，其中可以使用模板参数访问字段。我为什么要告诉你这个？因为您收到的错误通常是您在尝试访问 fusion-struct 中不存在的字段时遇到的错误。

这些错误由以下几行生成：

```
accumulator_t acc_upper(tag::weighted_p_square_cumulative_distribution::num_cells = 100);
accumulator_t acc_lower(tag::weighted_p_square_cumulative_distribution::num_cells = 100); 
```

如果您删除构造函数的参数，我很确定错误会消失

```
accumulator_t acc_upper;
accumulator_t acc_lower; 
```

我对 boost 累加器了解不多，但错误可能来自两个原因：您对 accumulator_set 的定义不正确（您使用的“stats”和 boost 中建议的“features”之间是否存在差异累加器文档？），或者您对构造函数中使用的参数的定义是（不正确的）。找出哪个，您可能已经解决了您的编译错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:43:47.280

使用 boost 的[bcp --list](http://www.boost.org/doc/libs/1_39_0/tools/bcp/bcp.html)列出依赖项，然后您可以确保包含所有依赖项。

# c# - 在 C# 中检测网络状态（连接 - 断开）

> ID：936027
> 
> 赞同：5
> 
> 时间：2009-06-01T18:15:23.547
> 
> 标签：c#, compact-framework, networking, windows-ce, ethernet

我需要一段代码来检测网络连接是连接还是断开。连接状态意味着电缆已插入以太网连接。断开状态意味着没有连接电缆。

由于我在 Windows CE 上运行，我无法使用 WMI 界面。我不介意调用 Win32 API，但请记住我使用的是 Windows CE 并在 Compact Framework 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T19:08:53.087

最简单的方法是使用[OpenNETCF 的 SDF](http://opennetcf.codeplex.com)并查看[OpenNETCF.Net.NetworkInformation.NetworkInterfaceWatcher 类](http://opennetcf.codeplex.com/SourceControl/latest#OpenNETCF.Net/OpenNETCF.Net/NetworkInformation/NetworkInterfaceWatcher.cs)，它会在 NDIS 发出通知时引发事件（如 MEDIA_CONNECT 和 MEDIA_DISCONNECT）。

当然，您可以在没有 SDF 的情况下完成相同的工作。它涉及直接打开 NDIS 驱动程序并使用 P2P 消息队列句柄调用[IOCTL_NDISUIO_REQUEST_NOTIFICATION 。](http://msdn.microsoft.com/en-us/library/aa924905.aspx)这并不太难，但是您必须做很多事情才能使其正常工作并且不会泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T18:19:19.903

查看这篇 MSDN 文章：

[在 .NET Compact Framework 中测试和响应网络连接](http://msdn.microsoft.com/en-us/library/aa446548.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T18:32:44.297

调用[GetAdaptersInfo](http://msdn.microsoft.com/en-us/library/aa916102.aspx)并遍历可用网络适配器列表，直到找到您正在寻找的那个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T18:19:38.843

要记住的一件事是网络连接**不**等于互联网连接。

听起来您已经明白了，因为您将连接定义为“将电缆插入以太网连接”，但它需要重复。

# c# - linq 案例陈述

> ID：936028
> 
> 赞同：51
> 
> 时间：2009-06-01T18:15:38.617
> 
> 标签：c#, sql, linq

我需要一些关于 linq (c#) 中的 CASE 语句的帮助：

```
osc_products.products_quantity =
      CASE 
         WHEN itempromoflag <> 'N' THEN 100000
         WHEN itemcat1 IN ('1','2','31') AND itemsalestatus = 'S' THEN 100000
         WHEN itemsalestatus = 'O' THEN 0
         ELSE cds_oeinvitem.itemqtyonhand - cds_oeinvitem.itemqtycommitted 
      END 
```

我开始转换为 linq，（我还在学习）：

> ```
> cdsDBDataContext db = new cdsDBDataContext();
>   var query = from items in db.cdsItems
>               where items.ItemHandHeldFlag.Equals("Y") && 
>               items.ItemQtyOnHand -  items.ItemQtyCommitted > 0
>   select items; 
> ```

此查询将库存状态从生产更新到商业站点。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-06-01T18:38:28.420

如果它只是你之后的**LINQ中的****CASE**语句（阅读你的评论），那么这方面的一个例子是......

 **```
Int32[] numbers = new Int32[] { 1, 2, 1, 3, 1, 5, 3, 1 };

var numberText =
(
    from n in numbers
    where n > 0
    select new
    {
        Number = n,
        Text = 
        (
            n == 1 ? "One" :
            n == 2 ? "Two" :
            n == 3 ? "Three" : "Unknown"
        )
    }
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T21:27:14.353

这是我到目前为止的进展，还没有工作，但这是一个开始：

```
var query2 = from items in db.cdsItems
             where items.ItemTrackingCode.Equals("A") && (items.ItemQtyOnHand - items.ItemQtyCommitted) > 0
             select new  {
                           items,
                           qty =
                                 (
                                    items.ItemPromoFlag.Equals("1") ? "100000" :
                                    items.ItemCat1.Equals("1") ? "100000" :
                                    items.ItemSaleStatus.Equals("O") ? "0" :
                                    (items.ItemQtyOnHand - items.ItemQtyCommitted).ToString
                                 )
                         }; 
```

这种语法对我来说似乎很尴尬......我可能只是通过 sql。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T18:33:20.910

首先，选择要更新的项目。然后，在常规 C# 中更新它们。提交更改。

```
 var q = from osc in MyDataContext.osc_products
            join cds in cds_oeinvitem on osc.products_model equals cds.itemno into p
            where osc.Itemwebflag == 'Y'
            select p;

    foreach (var item in q)
    {
        if (item.itempromoflag != "N")
            item.products_quantity = 100000;
        else if ((new[] { 1, 2, 31 }.Contains(item.itemcat1)) && (item.itemsalestatus == 'S'))
            item.products_quantity = 100000;
        else if (item.itemsalestatus == 0)
            item.products_quantity = 0;
        else
            item.products_quantity = item.itemqtyonhand - item.itemqtycommitted;
    }

    MyDataContext.SubmitChanges(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T18:35:46.647

在存储过程中使用单个 UPDATE 语句将比在应用程序服务器上执行更新循环更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T18:33:29.617

您正在执行批量更新，但链接纯粹是一个查询和对象选择工具。使用适当的工具来完成这项工作……在这种情况下，它绝对是数据库服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T18:41:33.440

Linq 中没有“更新”语句（无论您使用哪种风格，无论是 LinqToSQL 还是 LinqToEntities）。

Linq 严格提供查询语言。

如果您正在使用 LinqToSQL 并且想要更新数据，您需要首先查询需要更新的项目的上下文，然后遍历它们以更改其属性，最后调用 SubmitChanges 以将更改保存到数据库。

# c - For 循环缺少几个带有段错误的索引

> ID：936029
> 
> 赞同：5
> 
> 时间：2009-06-01T18:15:54.030
> 
> 标签：c, for-loop, segmentation-fault

应用程序的输出（底部）如下：

元素索引号：0 元素内容：22
元素索引号：1 元素内容：22
元素索引号：2 元素内容：22
元素索引号：3 元素内容：22
元素索引号：4 元素内容：22
元素索引号：22元素内容：134513712

为什么标记为 5 - 21 的索引元素会丢失？我知道由于数组的边界溢出，这段代码可能会出现段错误，它旨在做到这一点，我对为什么这段代码不好，只是为什么跳过某些索引不感兴趣。

```
#include <stdio.h>
int main(){

    int array[5];

    int i;
    for(i=0; i<10; ++i) {
        array[i] = 22;
        printf("Element index number: %d Element contents: %d\n", i, array[i]);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T18:18:47.940

一旦溢出分配的内存，您就处于“未定义的区域”。可能数组写入写入了“i”存储在堆栈上的位置。

请注意，与 Java 和 C# 等语言不同，C 不进行运行时边界检查，因此当您超出数组或字符串或分配的内存时，不能保证执行任何有用的操作（如 segfault）。不能保证做任何事情。它可能会崩溃，它可能会继续运行，[它可能会导致恶魔飞出你的鼻子](http://catb.org/jargon/html/N/nasal-demons.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T18:19:00.497

发生的事情是，当您写入数组 [5] 时，您正在写入 i。它们在内存中与堆栈相邻，因此这是您可以预期的行为。

这样想，你做了一个有 5 个元素的数组

```
int array[5]; 
```

实际上，数组只是一个地址。[] 中的数字指定要访问该地址多远。所以：

*   数组 [0] 内存中过去地址“数组”的 0 个整数
*   array[1] 是内存中过去地址“array”的 1 个 int ...
*   array[4] 是内存中过去地址“array”的 4 个整数（您为数组保留的最后一个整数）

因此，如果您一路走来：

*   array[5] 是内存中过去地址“array”的 5 个整数

在 C 中没有自动边界检查，所以很高兴覆盖你自己的记忆。您在堆栈中的数组 [5] 之后放置了“i”，很可能数组 [5] 是 i。

您只需将 array[5] 或*i*设置为 22，因此*i*是 22。现在*i*是 22，您的下一次查找到 array[i] 实际上是 array[22]。这会抓取内存中该位置的任何垃圾，或者，如果幸运的话，会崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T18:26:12.343

@Doug 有，但让我们稍微扩展一下。

您将 array[5] 和 i 作为自动变量，因此它们在入口处分配在堆栈上，因此您分配了 6 个单元：array[0]、array[1]、... array[4]，然后是 i .

当您将 i 设置为 5 时，array[i] 指向堆栈中包含 i 的单元格。然后，您将 22 分配给它。所以现在 i=22，就像你打印的那样。

然后你得到array[i] 或array[22]，它在stck 的末尾；那里的随机值恰好是那个大数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T18:20:43.647

很可能局部变量“i”的存储位于堆栈上“array”之后，因此 &array[5] == &i，这意味着当您将 22 分配给 array[5] 时，您将 22 分配给“i”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-01T18:23:43.453

您已经声明了一个包含 5 个整数的数组，但您的 for 循环将值写入 10 个条目。

改变

```
int array[5]; 
```

至

```
int array[10]; 
```

# c# - System.Threading.Thread 继承

> ID：936034
> 
> 赞同：13
> 
> 时间：2009-06-01T18:18:05.367
> 
> 标签：c#, multithreading

是否可以从 Thread 类继承并覆盖 Start 方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-09T23:34:38.970

关于为什么有人要这样做：许多语言（例如Java）和/或线程API（例如Qt）允许开发人员通过从“线程”基类继承来实现线程，然后重载实现线程的方法常规。

在 Qt 中广泛使用此模型后，我实际上发现它非常方便——而不是让线程以某些函数或方法为目标，这通常会导致奇怪和/或复杂的代码，整个线程都包含在一个对象中。

下面是使用 Qt API 的示例代码：

```
class MyThread : public QThread
{
    Q_OBJECT

protected:
    void run();
};

void MyThread::run()
{
    ...something I need threaded...
} 
```

QThread 是 Qt 的线程基类。要使用 MyThread，请创建线程对象的实例并调用 QThread::start()。run() 重新实现中出现的代码随后将在单独的线程中执行。

这样做的好处是我认为它可以让您真正将线程所需的所有内容包含在单个对象中，并且（根据我的经验），它形成了一个非常连贯的对象模型。我认为它不能满足每个人的需求，但老实说，C# 没有这样一个基本的线程模型，我有点惊讶。

由于内核复杂性，我绝对不相信 C# 的 Thread 类是密封的；如果 Qt 可以提供允许继承 QThread 的跨平台线程库，我认为 MSFT 无法在 C# 中的线程类中提供相同的功能没有真正的原因。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-04-01T08:27:10.700

```
using System.Threading;

namespace NGrubb.Threading {

    public abstract class BaseThread {
        private Thread m_thread;

        public BaseThread() {
            m_thread = new Thread( Run );
        }

        public void Start() {
            m_thread.Start();
        }

        protected abstract void Run();
    }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-01T18:21:44.863

不，`Thread`班级是`sealed`。这个决定背后的基本原理是，它是内核对象的一个​​非常棘手和低级的包装器，你不应该弄乱它。

不过，你要问一个问题，为什么要覆盖 Start 方法？你想达到什么目的？

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-11-28T11:13:26.150

我认为任何继承都不会产生比这更易读的代码：

```
Thread myThread = new Thread(() =>
{
    //Do what you want...
});
myThread.Start(); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-01T18:23:50.240

不知道为什么你可能想要这样做（或者如果可能的话，甚至应该这样做），但有一种方法可以绕过这个`Thread`类的事实`sealed`- 使用扩展方法。从技术上讲，它只是向`Start`方法组添加重载（而不是覆盖），但这在您的上下文中可能仍然有用。

像这样的东西可能是你想要的：

```
public static void Start(this Thread thread, int foo)
{
    // Your code here.

    thread.Start();
} 
```

然后，您可以简单地这样称呼它：

```
var thread = new Thread();
thread.Start(123); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-01T18:21:42.147

Thread 类是密封的，但这里是[学习 Threads 的好网站](http://www.albahari.com/threading/)。另外，看看这里的 Stackoverflow 线程：[多线程参考？](https://stackoverflow.com/questions/601558/multithreading-reference)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T18:20:48.640

不...

Thread 类是密封的...

```
[ComVisibleAttribute(true)]
[ClassInterfaceAttribute(ClassInterfaceType.None)]
public sealed class Thread : CriticalFinalizerObject, 
    _Thread 
```

谢谢

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-01T18:22:34.500

不，它是一个密封的类，这意味着你不能从它继承。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-24T10:56:57.463

我也习惯于在 Java 应用程序中使用相同的逻辑，将线程捆绑到一个对象中，然后进一步将新进程的开始与其父进程分开是非常有意义的。同样，非常失望的 C# 不支持这种方法。戴夫 P

# winforms - 为 WinForm 应用程序设计主窗体（“主菜单”）

> ID：936040
> 
> 赞同：0
> 
> 时间：2009-06-01T18:18:54.087
> 
> 标签：winforms, user-interface, menu

在我们的测试版 WinForm 应用程序启动时当前加载的表单是一个显示大量按钮的表单……“库存”、“客户”、“报告”等。没什么太令人兴奋的。

我通常从查看类似的软件产品开始 UI 以了解它们是如何完成的，但由于这是一个企业应用程序，我真的不能去下载其他企业应用程序。

我很想对这个表格进行一些润色，但我不确定从哪里开始。有什么建议么？

**编辑：**我试图想出多个选项来呈现给用户，但是，我也在画空白。我可以找到大量的 Web 设计理念，但 Windows 窗体设计似乎真的不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:29:03.167

我发现如果没有选择，用户将很难说出他们想要什么。一旦给出选择，他们通常更容易找到要改变的东西。我建议为您的应用程序制作一些潜在用户界面的纸质草图。然后与几个用户坐下来，围绕他们进行讨论。我想你会以这种方式从用户那里获得更具体的想法。

* * *

***更新***

只是一些可能（或可能不会）帮助您前进的想法：

*   不要太拘泥于“公司”的应用程序。我见过的许多相关应用程序看起来很无聊，以至于我为那些需要在一天中度过美好时光的用户感到抱歉。
*   看看你自己喜欢的 UI，问问自己*为什么*喜欢它们。
*   在不拘泥于“企业模板”的同时，也不要太有创意；用户收集的经验来自其他应用程序，如果他们能够在没有培训的情况下猜出事情的运作方式可能会很好。
*   不要忘记从您认为有吸引力且易于使用的网站中汲取灵感。
*   尝试找到一个合乎逻辑的“流程”；以一致的方式可视化具有相同概念功能的事物；这也有助于用户进行成功的“猜测”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T01:29:50.213

坦率地说，带有“大量按钮”的表单需要的不仅仅是一点点润色。专门用于导航的表单通常意味着您给用户带来了不必要的工作。在每个表单上提供下拉菜单或侧边栏菜单，以便导航到任何表单。

起始表单的工作区域应该为用户提供实际完成任务的东西。选项包括：

1.  “仪表板”主窗体，显示有关用户工作的汇总信息（例如，要查看的帐户列表和每个帐户的状态、每个处理阶段的订单数量、待办事项计划）。理想情况下，用户应该能够直接在打开表单中执行他们最常见的任务（例如，将每个帐户标记为“已批准”或未完成）。如果完成任务需要更多信息，链接会导航到填写正确查询结果的详细表格。至少用户应该能够评估他们的工作状态，而无需进一步了解。请注意，不同的用户组可能在他们各自的仪表板上需要不同的东西。

2.  默认表格或表格。企业应用程序的用户通常有特定的任务，通常只涉及所有表单中的一到三个。例如，使用 Inventory 的用户可能几乎不需要查看客户记录，反之亦然。用户还经常处理特定的记录子集。例如，可以为每个销售代表分配数据库中客户总数的一小部分。根据用户通常使用的表单和记录将用户分组。对于每个用户组，通过自动打开填充了其记录查询结果的用户组表单来启动应用程序。用户应该能够在没有任何进一步导航或查询的情况下完成大部分工作。

3.  如果一切都失败了，请打开应用程序以查看用户退出应用程序时上次打开的任何形式和内容。许多企业用户明天将继续从事他们今天正在从事的相同或相似的工作。

分析您的用户的任务以确定要使用上述哪些选项。向用户描述每个选项并询问他们更喜欢哪个选项通常是没有效率的。

顺便说一句，“报告”可能不是一个特别好的导航选项。如果您始终主要通过它们显示的*内容*而不是它们的显示*方式来识别事物，那就更好了*。用户可能不知道他们想看的信息是在“报告”而不是表格中，但他们会知道他们想看什么内容。库存报告可在库存下访问；有关销售的报告可在销售下访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:46:09.213

这里的问题是你需要一些好的用户分析，我猜你只做了功能分析。

因为您的问题是如此抽象，所以很难给出一个很好的例子来说明您需要做什么。我会去[usability.gov](http://www.usability.gov/)并查看可用性方法链接，尤其是卡片分类和上下文访谈。

基本上你想做两件事：

1- 发现您的用户认为信息在页面上的分组方式：这也将有助于充实您的功能需求。将所有信息分组后，您就基本上设置了导航隐喻。此外，您可以不断地进行卡片分类练习，直至页面和功能级别 - 例如，您进行一次卡片分类会话以了解用户需求，然后取出一组卡片并要求用户将其分解为重要性等级。这样做将帮助您了解需要在屏幕的主要区域中显示哪些内容以及可以隐藏哪些内容。

2- 了解他们已经使用了哪些工具：他们喜欢什么，不喜欢什么。您需要获取他们在外部和内部使用的工具/应用程序的列表。内部可能是最重要的，因为您企业中的大多数人很有可能会分享使用它的经验。然而，外部工具可能会帮助您了解用户的想法。

此外，不要害怕拿起铅笔和纸，并与用户一起勾勒想法。人们普遍认为草图是帮助早期设计工作的一种快速而有用的方法，您可以通过简单的草图从中获取大量信息。是的，即使你不擅长素描，也可以这样做——这可能无关紧要。事实上，蹩脚的草图甚至可能对你有利，因为这样就没有人会争论按钮应该是蓝色、红色还是其他。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T18:30:09.793

您可能会查看您的用户熟悉的其他应用程序。Outlook 在我的公司中无处不在，我们能够相对轻松地将应用程序映射到它的界面，因此我们在开发 UI 时使用该应用程序作为模型。

请注意，我并不是专门向您推荐 Outlook，只是您寻找可以使用户的学习曲线更浅的 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T19:23:01.513

一些获得交互设计想法的地方：

**图书**

关于 Face 3 - 交互设计的精髓

Don't Make Me Think（这专注于网页设计，但许多原则都适用于 Windows 设计）

**网站**

[Windows 用户体验交互指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)

此外，许多应用程序都有免费试用版，您可以下载这些试用版以确定它们如何处理用户交互。另外，现在不要在桌面上打折商品。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T18:22:06.950

您是否尝试过询问最终用户他们想要什么？毕竟，他们将使用该系统。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T18:28:50.483

我使用 DevExpress 公司的组件。他们有一些非常酷的控件（例如 Office 2007 功能区），表单皮肤实用程序（具有大量不同的皮肤），以及更多...

如果您想查看它，他们有 60 个免费组件 - 如果它是公司的，虽然您可能需要查看许可证，但您可以在... [DevExpress 60 免费](http://www.devexpress.com/Products/Free/WebRegistration60/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T18:30:50.620

我建议从微软建议的设计原则开始：[Windows 用户体验交互指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T19:37:21.453

对于最常用或最重要的功能可能是什么，您是否有任何统计数据或见解？如果是这样，您可以使用它来减少“大量按钮”并仅突出显示最重要的那些。

这是一个微不足道的例子，但基本的一点是，您对受众的理解应该为您的设计提供信息，至少从功能的角度来看。您可能有过去的使用统计数据、用户故事、记录的工作流程或其他任何东西——即使您现在正在画一个空白，请记住您必须*了解*您的用户，否则您将无法编写软件为他们。

建立在他们已经知道的基础上可以让您的用户轻松。他们住在 Outlook 中吗？然后你可能想模仿它（正如[Michael Petrotta](https://stackoverflow.com/questions/936040/designing-a-main-form-main-menu-for-a-winform-application/936101#936101)建议的那样）。他们每次使用应用程序时是否通常（在给定角色内）做同样的事情？然后寻找一个简单、流线型的界面。他们是高级用户吗？然后他们可能希望能够调整和自定义界面。也许您甚至有针对不同用户角色的不同菜单表单。

在这个阶段，我不会担心它是否正确；放松一下，把东西放在那里。你设计什么几乎无关紧要，因为如果你有参与的用户并且你给他们选择，他们无论如何都会想要改变一些东西（一切？）。;-)

# javascript - 停止正在执行的 jquery，然后从它离开的地方恢复

> ID：936045
> 
> 赞同：1
> 
> 时间：2009-06-01T18:19:28.220
> 
> 标签：javascript, jquery-plugins

好吧，我正在使用[这个 jquery carousel 插件](http://thomlx.free.fr/jquery/jquery_carousel.htm)......它工作得很好（它启用了自动轮播），但是当任何用户在轮播上运行鼠标然后试图恢复它离开的地方时，我试图让它停止, 鼠标退出后。我还没有设法做到这一点，我什至不知道如何继续尝试。这是我的轮播代码（因为它很长，我只是要放置第一部分，毕竟它重复）......

```
<div id="expertos" class="carrusel_expertos">
                                <ul>
                                    <li>
                                        <img class="izq" id="fernandocavazos" height="88px" width="77px" src="assets/img/expertos/equipo7.jpg" alt="Dr. Fernando Cavazos" title="Dr. Fernando Cavazos<br /><br />
                                        Director de Servicios T&eacute;cnicos ABS Am&eacute;rica Latina<br />
                                        Residencia: M&eacute;xico<br />
                                        Email: fernandocavazos@absmexico.com.mx<br />
                                        Medico Veterinario - Universidad Nacional Aut&oacute;noma, M&eacute;xico  <br />
                                        Fisiolog&iacute;a Reproductiva - Universidad de Edimburgo, Escocia<br />
                                        <br />
                                        Fernando esta a cargo de los programas de actualizaci&oacute;n para el equipo de servicios t&eacute;cnicos de Am&eacute;rica Latina. Sus &aacute;reas de especializaci&oacute;n incluyen manejo reproductivo en ganado de leche y carne, procedimientos de orde&ntilde;o y salud de la ubre, evaluaci&oacute;n del confort e instalaciones y salud del hato.
                                        " />    
                                        <ul id="textcontainer_der">
                                          <li><div id="nombre_experto">Dr. Fernando Cavazos</div></li>
                                            <li><div id="residencia_experto">M&eacute;xico</div></li>
                                            <li><div id="mail_experto">fernandocavazos@absmexico.com.mx</div></li>
                                      </ul>
                                  </li>
                                    <li>
                                        <img class="der" height="88px" width="77px" src="assets/img/expertos/equipo8.jpg" alt="Dr. Dr. Hernando L&oacute;pez" />    
                                        <ul>
                                          <li><div id="nombre_experto">Dr. Hernando L&oacute;pez</div></li>
                                            <li><div id="residencia_experto">USA</div></li>
                                            <li><div id="mail_experto">hlopez@absglobal.com</div></li>
                                      </ul>
                                  </li>
                                    <li>
                                      <img class="izq" height="88px" width="77px" src="assets/img/expertos/equipo9.jpg" alt="Dr. Neil Michael" />
                                      <ul id="textcontainer_der">
                                        <li><div id="nombre_experto">Dr. Neil Michael</div></li>
                                            <li><div id="residencia_experto">USA</div></li>
                                            <li><div id="mail_experto">nmichael@absglobal.com</div></li>
                                      </ul>
                                  </li> 
```

这是启动 jCarousel 的 javascript

```
var carousel = $(function(){
    $("div.carrusel_expertos").carousel({
        direction: "vertical",
        loop: true,
        dispItems: 3,
        nextBtn: "<span></span>",
        prevBtn: "<span></span>",
        autoSlide: true,
        autoSlideInterval: 6000,
        delayAutoSlide: 2000,
        effect: "fade"
    });
}); 
```

在这里，我试图阻止已经执行的 jCarousel：

```
$(function() {
    $('#expertos').mouseover(function() {
        //$(this).stop();
               $(this).die("mouseover",carousel);
       }).mouseout(function() {
        //$(this).carousel();
                $(this).live("mouseout",carousel);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T09:41:55.770

您必须自己修改插件以适应它。如果该插件是作为一个 jQuery UI 小部件开发的，那么无需修改它就可以更容易控制。

您应该扩展 params 对象以包含指示轮播应在鼠标悬停时暂停的选项，例如“pauseOnMouseOver”。

此外，您应该使用名为“paused”之类的布尔值扩展“env”对象。

将“mouseover”事件处理程序绑定到 env.$elts.content 元素，该元素会将 env.paused 值设置为 true，并将“mouseout”事件处理程序设置回 false；

查找部分：

```
 // Launch autoslide
            if (env.params.autoSlide){
                window.setTimeout(function(){
                    env.autoSlideInterval = window.setInterval(function(){
                        env.$elts.nextBtn.click();
                    }, env.params.autoSlideInterval);
                }, env.params.delayAutoSlide);
            } 
```

在线上

```
env.$elts.nextBtn.click(); 
```

添加一个 if 语句，如

```
if (!paused) 
```

这应该够了吧。

# php - 并发问题

> ID：936052
> 
> 赞同：3
> 
> 时间：2009-06-01T18:20:17.580
> 
> 标签：php, mysql, pdo, propel

我在使用 MySQL 和 PHP + Propel 1.3 时遇到了似乎是并发问题。下面是一个 Propel 对象的“保存”方法的小例子。

```
public function save(PropelPDO $con = null) {
    $con = Propel::getConnection();
    try {
        $con->beginTransaction();
        sleep(3); // ignore this, used for testing only
        parent::save($con);
        $foo = $this->getFoo(); // Propel object, triggers a SELECT

        // stuff is happening here...

        $foo->save($con);
        $con->commit();
    } catch (Exception $e) {
        $con->rollBack();
        throw $e;
    }
} 
```

问题是 $foo 对象。假设我们在很短的时间内接连两次调用示例方法。在某些情况下，如果第二个事务读取 $foo...

```
$foo = $this->getFoo(); 
```

...在第一笔交易有机会保存之前...

```
$foo->save($con); 
```

...第二个事务读取的 $foo 将过时并且会发生坏事。

如何强制锁定存储 Foo 对象的表，以便后续事务只有在第一个事务完成工作后才能从中读取？

编辑：上下文是一个 Web 应用程序。简而言之，在某些情况下，我希望第一个请求进行一些数据修改（这发生在获取和保存 $foo 之间）。所有后续请求都不应进行修改。是否会发生修改取决于获取的 $foo 状态（表行属性）。如果两个事务获取相同的 $foo，则修改将发生两次，这会导致问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T18:31:44.753

当您将此现有行加载到屏幕/应用程序时，也加载 LastChgDate。保存时，使用“AND LastChgDate= thevalue *”*。检查更新的受影响行数，如果为零，返回错误“其他人已经保存了这条记录”，并回滚等更改。有了这个逻辑，您只能保存与加载时相同的行。对于新行，INSERT，这不是必需的，因为它们是新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:39:34.473

在 MySQL 中，我认为您可以使用 SELECT FOR UPDATE 来完成锁定。

另一种选择是使用 GET_LOCK 和 RELEASE_LOCK MySQL 函数调用来创建命名锁，用于控制对资源的访问。

这些方法有一些缺点。我自己并没有经常使用它们，它们是特定于 MySQL 的，但它们可以为你工作。

# .net - 嵌套的 UpdatePanel 行为

> ID：936060
> 
> 赞同：1
> 
> 时间：2009-06-01T18:21:57.013
> 
> 标签：.net, asp.net, ajax, asp.net-ajax, updatepanel

我在 UpdatePanel 中使用向导控件。某些向导步骤中嵌套了 UpdatePanel。外部和内部 UpdatePanel 都有自己的 Trigger 集合。所有事件都按预期触发。

但是，外部 UpdatePanel 的触发器不会触发 UpdateProgress 控件。内心的都这样。我很困惑为什么我不能让外部触发器显示 ProgressTemplate。它适用于一些导航向导步骤的 ImageButtons。

概括起来，嵌套如下：

```
更新面板
   触发器
   内容模板
      更新进度
      向导
         步骤#n
         更新面板
            触发器
            内容模板
                   .
                   .
            /内容模板
         /更新面板
         /步
                .
                .
      /向导
   /内容模板
/更新面板

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-24T20:15:31.653

您是否将 UpdateProgress 与嵌套的 UpdatePanel 相关联？

您能否提供 UpdatePanels 和 UpdateProgress 的完整标签？看看是否有明显的东西会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-21T00:33:58.760

您的[UpdateProgress](http://www.asp.net/Ajax/Documentation/Live/overview/UpdateProgressOverview.aspx)需要位于最外面的 UpdatePanel 之外，并且不要将其与任何特定的 UpdatePanel 关联。

> 通过设置 UpdateProgress 控件的 AssociatedUpdatePanelID 属性，可以将 UpdateProgress 控件与 UpdatePanel 控件相关联。当回发事件源自 UpdatePanel 控件时，将显示任何关联的 UpdateProgress 控件。如果不将 UpdateProgress 控件与特定的 UpdatePanel 控件相关联，则 UpdateProgress 控件会显示任何异步回发的进度。
> 
> 如果 UpdatePanel 控件的 ChildrenAsTriggers 属性设置为 false，并且异步回发源自该 UpdatePanel 控件内部，则将显示任何关联的 UpdateProgress 控件。

# javascript - Javascript 将“05/27 11:00pm”转换为日期？

> ID：936061
> 
> 赞同：0
> 
> 时间：2009-06-01T18:21:58.700
> 
> 标签：javascript

如何将没有年份的日期字符串转换为 JS Date 对象？以及如何将带有年份和时间的日期字符串转换为 JS Date 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T18:30:49.323

只需将许多不同的日期格式传递给`Date()`构造函数，就可以将它们转换为日期对象：

```
var date = new Date(datestring); 
```

您的示例日期不起作用有两个原因。首先，它没有一年。其次，“pm”之前需要有一个空格（我不知道为什么）。

```
// Wed May 27 2009 23:00:00 GMT-0700 (Pacific Daylight Time)
var date = new Date("2009/05/27 11:00 pm") 
```

如果您收到的日期格式是一致的，您可以通过以下方式修复它们：

```
var datestring = "05/27 11:00pm";
var date = new Date("2009/" + datestring.replace(/\B[ap]m/i, " $&")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T18:31:35.860

我会使用 Datejs 库的 parse 方法。

[http://www.datejs.com/](http://www.datejs.com/)

我试过你的例子，它工作得很好......

**5月27日晚上11:00**

**2009 年 5 月 27 日星期三晚上 11:00:00**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T18:25:24.700

我使用 Dojo 时间解析器来做这样的事情：

看看： [http ://api.dojotoolkit.org/jsdoc/HEAD/dojo.date.locale.parse](http://api.dojotoolkit.org/jsdoc/HEAD/dojo.date.locale.parse)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T15:06:58.350

只是另一种选择，我写道：

[DP_DateExtensions 库](http://www.depressedpress.com/Content/Development/JavaScript/Extensions/DP_DateExtensions/Index.cfm)

它有一个日期/时间解析方法——传入一个掩码，它将验证输入并在它们匹配时返回一个数据对象。

还支持日期/时间格式、日期数学（添加/减去日期部分）、日期比较、专业日期解析等。它是自由开源的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T18:29:41.463

不是最干净的，但有效：

```
var strDate = '05/27 11:00pm';
var myDate = ConvertDate(strDate, '2009');

function ConvertDate(strWeirdDate, strYear)
{
    strWeirdDate = strWeirdDate.replace(/ /, '/' + strYear + ' ');
    return new Date(strWeirdDate);
} 
```

可能也想先修剪字符串。

# html - 确定表中偶数/奇数行的更好方法

> ID：936066
> 
> 赞同：7
> 
> 时间：2009-06-01T18:23:26.327
> 
> 标签：html, css

假设您有一个包含以下示例代码的网页：

```
<tr class="even">
    <td>something1</td>
    <td colspan="1">somthing1.1</td>
</tr>

<tr class="odd">
    <td>something2</td>
    <td><b>something2.1</b></td>
</tr>

<tr class="even">
    <td>something3</td>
    <td><b>something3.1</b></td>
</tr> 
```

这些不在循环中，所以我必须明确地说“偶数”“奇数”。稍后，如果我们决定在 something2 和 something3 之间添加一个新行，那么我们还需要为其余行更改“偶数”“奇数”。

css 有没有办法在 IE6 中自动执行此操作？

目前这是我的 CSS 代码

```
.headerTable tr.even {
    font-weight : bold;
    font-size : 9pt;
    font-family : Arial,Helvetica,sans-serif,Verdana,Geneva;
    background-color: #FFFFFF;
    height: 20px;
    color: #000000;
} 
```

我已经有了 jQuery

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T18:28:09.407

试试 jQuery。然后你可以简单地这样做：

```
 $("#myTable tbody tr:visible:even",this).addClass("even"); 
   $("#myTable tbody tr:visible:odd",this).addClass("odd"); 
```

":visible" 选择器不是必需的，但是当您通过隐藏某些行来过滤表时，该方法仍然可以正常工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-01T18:29:28.890

这样做的方法是使用 nth-child(even) 和 (odd) 规则。不幸的是，这也不足为奇，IE6 不支持这一点。所以你有几个选择：

A) 使用 Javascript，它的明显缺点是它不适用于禁用 JS 的人：

```
var rows = document.getElementById('mytable').getElementsByTagName('tr');
for(var x = 0; x < rows.length; x++) {
    rows[x].className = (x % 2 == 0) ? 'even' : 'odd';
} 
```

如果您希望在您的应用程序上需要更多动态的客户端行为，那么您可以检查像 jQuery 这样的库。为此*，*它是不必要的，但它使跨浏览器使用 Javascript 变得轻而易举。您可以使用 jQuery 执行上述操作，就像此答案中显示的那样。

根据您的受众，Javascript 可能是完全可以接受的。如果不是，那么也许你可以...

B) 简化您的 CSS 并继续手动操作。您只能用类标记奇数行，然后将行默认样式设置为偶数样式。这将在移动物品时为您节省一些工作。

C) 以编程方式生成行。如果您要经常更新它以至于这是一个问题，那么将这样的数据输入到一个固定表中确实是过时的。我显然没有注意到您的情况，但是使用 PHP 之类的简单语言以某种方式在循环中执行此操作应该是微不足道的。

D) 停止使用真正过时的浏览器。:) （这只是半开玩笑，因为我确信它超出了你的控制）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-01T18:29:14.380

最好的方法是[`:nth-child()`伪类](http://www.w3.org/TR/css3-selectors/#nth-child-pseudo)。

但不幸的是，它还没有得到广泛的支持。因此，您可能需要使用 JavaScript 来执行此操作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T18:25:40.970

使用 jQuery 的偶/奇子[实现](http://docs.jquery.com/Selectors/nthChild)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T18:27:02.403

是的。您可以使用 JavaScript 遍历这些元素并根据偶数/奇数重置它们的类。

# c# - 为什么没有静态索引器？

> ID：936096
> 
> 赞同：0
> 
> 时间：2009-06-01T18:28:58.580
> 
> 标签：c#, static-indexers

> **可能的重复：**
> [如何在 C# 注释](https://stackoverflow.com/questions/341118/how-to-reference-an-indexer-member-of-a-class-in-c-comments)
> [静态索引器中引用类的索引器成员？](https://stackoverflow.com/questions/401232/static-indexers)

* * *

就目前而言，我必须像这样编写我的代码

```
internal class ReportMap {

    static internal ReportMap Instance {
        get { return reportMap; }
    }

    internal Type this[char c] {
        get { return data[c]; }
    }

    // private parts
    static Dictionary<char, Type> data =
        new Dictionary<char, Type>();

    ReportMap() {
        data.Add('S', typeof(StatusReport));
        data.Add('Q', typeof(QualityReport));
    }

    static ReportMap reportMap = new ReportMap();
} 
```

并访问索引：

```
Type t = ReportMap.Instance[aChar]; // eww 
```

这种能力被排除在语言之外是否有特定的原因？特别是，它会被认为是糟糕的设计吗？关于这个已经发布的另一个问题，但不幸的是我没有足够的代表发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T18:41:33.533

这是一个很好的欺骗参考。具体来说，查看答案:-) [静态索引器？](https://stackoverflow.com/questions/401232/static-indexers/401275#401275)

# php - PHP：按用户和产品品牌跟踪请求？

> ID：936103
> 
> 赞同：1
> 
> 时间：2009-06-01T18:30:24.300
> 
> 标签：php, mysql, php4, mysql4

我有一个 MySQL 表，其中包含价格请求，它有 date、first、last 和 product_id 字段。产品品牌可以从 product_id 的产品表中找到。

给定一个日期范围，他们想知道该日期范围内每一天的用户和品牌请求总数，以及该日期范围的总数。这是棘手的部分，如果同一个人在一天内多次提出请求，那么它只计为 1 人。但是，如果一个人在 1 天内请求 2 个不同的品牌，则每个品牌当天都会获得 1 个。但是，如果他们在一天内请求多个品牌，则该品牌当天仅计为 1。

例如，假设在给定日期，John Doe 提出了 3 个价格请求，分别是 Burberry 产品和 2 个施华洛世奇产品。人只算 1 个，巴宝莉 1 个，施华洛世奇 1 个。但是，如果另一个人提出了对 burberry 的请求，那么当天将有 2 个 burberry，当天有 2 个人。

我希望这是从那时起。无论如何，最好的方法是什么？我正在使用 PHP4 和 MySQL4

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T09:27:42.997

假设Machine的表定义，试试

```
-- # Shows number of people doing a request per day
SELECT
  Count(DISTINCT userId) AS NumberOfUsers,
FROM
  priceRequestsProducts prp,
  date
GROUP BY
  prp.date;

-- # Shows number of request for a given product per day
SELECT
  Count(DISTINCT userId) AS NumberofUsers,
  productId,
  date
FROM
  priceRequestsProducts prp
GROUP BY
  prp.date, prp.productId; 
```

不希望在查询中使用。对于人，您会期望每天一行，对于产品，您会期望每对一行（产品，天）。如果您真的想这样做，请引入一个不用作 productId 的值（我会将 productId 设为 UNSIGNED INT NOT NULL AUTO_INCREMENT）或使用 NULL，并使用它来指定用户：

```
SELECT
  Count(DISTINCT userId) AS NumberOfUsers,
FROM
  priceRequestsProducts prp,
  NULL,
  date
GROUP BY
  prp.date;
UNION ALL
SELECT
  Count(DISTINCT userId) AS NumberofUsers,
  productId,
  date
FROM
  priceRequestsProducts prp
GROUP BY
  prp.date, prp.productId; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:15:50.857

注意：我制作了这张表，因为您没有为您的表提供 SQL DDL。只要给我一些意见，我会编辑答案，直到我们做对为止。

```
CREATE TABLE priceRequestsProducts AS (
    userId INT NOT NULL,
    productId INT NOT NULL,
    date DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
    INDEX(userId),
    INDEX(productId),
    PRIMARY KEY (userId, productId, date),
    CONSTRAINT fk_prp_users FOREIGN KEY (userId) REFERENCES (Users.id),
    CONSTRAINT fk_prp_products FOREIGN KEY (productId) REFERENCES (Products.id)
) ENGINE=InnoDb;

-- # Shows all dates each user has made a priceRequest for at least one product:
SELECT U.userId, U.firstName, U.lastName, U.username, date
FROM Users U
JOIN priceRequestsProducts as prp ON u.id = prp.id
GROUP BY prp.userId, prp.date;

-- # Shows number of price requests for a product on all dates
SELECT P.id, P.name, count(1) as numRequests, prp.date
FROM Products P
JOIN priceRequestsProducts prp ON prp.productId = P.id
GROUP BY prp.productId, prp.date; 
```

# command-line - How to script FTP upload and download

> ID：936108
> 
> 赞同：39
> 
> 时间：2009-06-01T18:31:30.430
> 
> 标签：command-line, powershell, ftp

I'm attempting to make a batch file to upload a file to an FTP server. If I type it in manually it works fine, but when I run the batch file it halts after it's connected... It says:

```
connected to domain.com.

220 microsoft ftp server

User(domain.com:(none)): 
```

And then nothing else. What is going on here?

Below is my batch file:

```
ftp www.domainhere.com

user useridhere

passwordhere

put test.txt

bye

pause 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-06-01T21:42:08.923

It's a reasonable idea to want to script an FTP session the way the original poster imagined, and that is the kind of thing [Expect](https://en.wikipedia.org/wiki/Expect) would help with. Batch files on Windows cannot do this.

But rather than doing cURL or Expect, you may find it easier to script the FTP interaction with PowerShell. It's a different model, in that you are not directly scripting the text to send to the FTP server. Instead you will use PowerShell to manipulate objects that generate the FTP dialogue for you.

Upload:

```
$File = "D:\Dev\somefilename.zip"
$ftp = "ftp://username:password@example.com/pub/incoming/somefilename.zip"

"ftp url: $ftp"

$webclient = New-Object System.Net.WebClient
$uri = New-Object System.Uri($ftp)

"Uploading $File..."

$webclient.UploadFile($uri, $File) 
```

Download:

```
$File = "c:\store\somefilename.zip"
$ftp = "ftp://username:password@example.com/pub/outbound/somefilename.zip"

"ftp url: $ftp"

$webclient = New-Object System.Net.WebClient
$uri = New-Object System.Uri($ftp)

"Downloading $File..."

$webclient.DownloadFile($uri, $File) 
```

You need PowerShell to do this. If you are not aware, PowerShell is a shell like cmd.exe which runs your .bat files. But PowerShell runs *.ps1* files, and is quite a bit more powerful. PowerShell is a free add-on to Windows and will be built-in to future versions of Windows. [Get it here](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/download.mspx).

Source: [http://poshcode.org/1134](http://poshcode.org/1134)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-01T19:03:00.010

Create a command file with your commands.

I.e., file *commands.txt*:

```
open www.domainhere.com
user useridhere
passwordhere
put test.txt
bye 
```

Then run the FTP client from the command line:

```
ftp -s:commands.txt 
```

Note: This will work for the Windows FTP client.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-01T19:09:51.837

Batch files don't work that way. They don't just "type" everything - they run system commands, in this case `ftp`, wait for them to return, and run the next command... so in this case, the interpreter is simply waiting for `ftp` to exit.

If you **must** use the `ftp` command, then prepare a script file (for example, `commands.txt` and run `ftp -s:commands.txt`.

But using **cURL**, or a PHP/Perl/Python/whatever script may be a better idea.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-04-01T22:36:54.280

I've [done this with PowerShell](https://github.com/ruslander/Nutshells):

```
function DownloadFromFtp($destination, $ftp_uri, $user, $pass){
    $dirs = GetDirecoryTree $ftp_uri $user $pass

    foreach($dir in $dirs){
       $path = [io.path]::Combine($destination,$dir)

       if ((Test-Path $path) -eq $false) {
          "Creating $path ..."
          New-Item -Path $path -ItemType Directory | Out-Null
       }else{
          "Exists $path ..."
       }
    }

    $files = GetFilesTree $ftp_uri $user $pass

    foreach($file in $files){
        $source = [io.path]::Combine($ftp_uri,$file)
        $dest = [io.path]::Combine($destination,$file)

        "Downloading $source ..."
        Get-FTPFile $source $dest $user $pass
    }
}

function UploadToFtp($artifacts, $ftp_uri, $user, $pass){
    $webclient = New-Object System.Net.WebClient 
    $webclient.Credentials = New-Object System.Net.NetworkCredential($user,$pass)  

    foreach($item in Get-ChildItem -recurse $artifacts){ 

        $relpath = [system.io.path]::GetFullPath($item.FullName).SubString([system.io.path]::GetFullPath($artifacts).Length + 1)

        if ($item.Attributes -eq "Directory"){

            try{
                Write-Host Creating $item.Name

                $makeDirectory = [System.Net.WebRequest]::Create($ftp_uri+$relpath);
                $makeDirectory.Credentials = New-Object System.Net.NetworkCredential($user,$pass) 
                $makeDirectory.Method = [System.Net.WebRequestMethods+FTP]::MakeDirectory;
                $makeDirectory.GetResponse();

            }catch [Net.WebException] {
                Write-Host $item.Name probably exists ...
            }

            continue;
        }

        "Uploading $item..."
        $uri = New-Object System.Uri($ftp_uri+$relpath) 
        $webclient.UploadFile($uri, $item.FullName)
    }
}

 function Get-FTPFile ($Source,$Target,$UserName,$Password) 
 { 
     $ftprequest = [System.Net.FtpWebRequest]::create($Source) 
     $ftprequest.Credentials = New-Object System.Net.NetworkCredential($username,$password) 
     $ftprequest.Method = [System.Net.WebRequestMethods+Ftp]::DownloadFile 
     $ftprequest.UseBinary = $true 
     $ftprequest.KeepAlive = $false 

     $ftpresponse = $ftprequest.GetResponse() 
     $responsestream = $ftpresponse.GetResponseStream() 

     $targetfile = New-Object IO.FileStream ($Target,[IO.FileMode]::Create) 
     [byte[]]$readbuffer = New-Object byte[] 1024 

     do{ 
         $readlength = $responsestream.Read($readbuffer,0,1024) 
         $targetfile.Write($readbuffer,0,$readlength) 
     } 
     while ($readlength -ne 0) 

     $targetfile.close() 
 } 

#task ListFiles {
#   
#    $files = GetFilesTree 'ftp://127.0.0.1/' "web" "web"
#    $files | ForEach-Object {Write-Host $_ -foregroundcolor cyan}
#}

function GetDirecoryTree($ftp, $user, $pass){
    $creds = New-Object System.Net.NetworkCredential($user,$pass)

    $files = New-Object "system.collections.generic.list[string]"
    $folders = New-Object "system.collections.generic.queue[string]"
    $folders.Enqueue($ftp)

    while($folders.Count -gt 0){
        $fld = $folders.Dequeue()

        $newFiles = GetAllFiles $creds $fld
        $dirs = GetDirectories $creds $fld

        foreach ($line in $dirs){
            $dir = @($newFiles | Where { $line.EndsWith($_) })[0]
            [void]$newFiles.Remove($dir)
            $folders.Enqueue($fld + $dir + "/")

            [void]$files.Add($fld.Replace($ftp, "") + $dir + "/")
        }
    }

    return ,$files
}

function GetFilesTree($ftp, $user, $pass){
    $creds = New-Object System.Net.NetworkCredential($user,$pass)

    $files = New-Object "system.collections.generic.list[string]"
    $folders = New-Object "system.collections.generic.queue[string]"
    $folders.Enqueue($ftp)

    while($folders.Count -gt 0){
        $fld = $folders.Dequeue()

        $newFiles = GetAllFiles $creds $fld
        $dirs = GetDirectories $creds $fld

        foreach ($line in $dirs){
            $dir = @($newFiles | Where { $line.EndsWith($_) })[0]
            [void]$newFiles.Remove($dir)
            $folders.Enqueue($fld + $dir + "/")
        }

        $newFiles | ForEach-Object { 
            $files.Add($fld.Replace($ftp, "") + $_) 
        }
    }

    return ,$files
}

function GetDirectories($creds, $fld){
    $dirs = New-Object "system.collections.generic.list[string]"

    $operation = [System.Net.WebRequestMethods+Ftp]::ListDirectoryDetails
    $reader = GetStream $creds $fld $operation
    while (($line = $reader.ReadLine()) -ne $null) {

       if ($line.Trim().ToLower().StartsWith("d") -or $line.Contains(" <DIR> ")) {
            [void]$dirs.Add($line)
        }
    }
    $reader.Dispose();

    return ,$dirs
}

function GetAllFiles($creds, $fld){
    $newFiles = New-Object "system.collections.generic.list[string]"
    $operation = [System.Net.WebRequestMethods+Ftp]::ListDirectory

    $reader = GetStream $creds $fld $operation

    while (($line = $reader.ReadLine()) -ne $null) {
       [void]$newFiles.Add($line.Trim()) 
    }
    $reader.Dispose();

    return ,$newFiles
}

function GetStream($creds, $url, $meth){

    $ftp = [System.Net.WebRequest]::Create($url)
    $ftp.Credentials = $creds
    $ftp.Method = $meth
    $response = $ftp.GetResponse()

    return New-Object IO.StreamReader $response.GetResponseStream()
}

Export-ModuleMember UploadToFtp, DownLoadFromFtp 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-04-22T19:28:45.337

You can script the `ftp` command with the `-s:filename` option. The syntax is just a list of commands to pass to the `ftp` shell, each terminated by a newline. [This page](http://www.nsftools.com/tips/MSFTP.htm) has a nice reference to the commands that can be performed with `ftp`.

## Upload/Download Entire Directory Structure

Using the normal `ftp` doesn't work very well when you need to have an entire directory tree copied to or from a FTP site. So you could use something like these to handle those situations.

These scripts work with the Windows `ftp` command and allows for uploading and downloading of entire directories from a single command. This makes it pretty self-reliant when using on different systems.

Basically, they map out the directory structure to be up/downloaded, dump corresponding `ftp` commands to a file, and then execute those commands when the mapping has finished.

**ftpupload.bat**

```
@echo off

SET FTPADDRESS=%1
SET FTPUSERNAME=%2
SET FTPPASSWORD=%3
SET LOCALDIR=%~f4
SET REMOTEDIR=%5

if "%FTPADDRESS%" == "" goto FTP_UPLOAD_USAGE
if "%FTPUSERNAME%" == "" goto FTP_UPLOAD_USAGE
if "%FTPPASSWORD%" == "" goto FTP_UPLOAD_USAGE
if "%LOCALDIR%" == "" goto FTP_UPLOAD_USAGE
if "%REMOTEDIR%" == "" goto FTP_UPLOAD_USAGE

:TEMP_NAME
set TMPFILE=%TMP%\%RANDOM%_ftpupload.tmp
if exist "%TMPFILE%" goto TEMP_NAME

SET INITIALDIR=%CD%

echo user %FTPUSERNAME% %FTPPASSWORD% > %TMPFILE%
echo bin >> %TMPFILE%
echo lcd %LOCALDIR% >> %TMPFILE%

cd %LOCALDIR%

setlocal EnableDelayedExpansion
echo mkdir !REMOTEDIR! >> !TMPFILE!
echo cd %REMOTEDIR% >> !TMPFILE!
echo mput * >> !TMPFILE!
for /d /r %%d in (*) do (
    set CURRENT_DIRECTORY=%%d
    set RELATIVE_DIRECTORY=!CURRENT_DIRECTORY:%LOCALDIR%=!
    echo mkdir "!REMOTEDIR!/!RELATIVE_DIRECTORY:~1!" >> !TMPFILE!
    echo cd "!REMOTEDIR!/!RELATIVE_DIRECTORY:~1!" >> !TMPFILE!
    echo mput "!RELATIVE_DIRECTORY:~1!\*" >> !TMPFILE!
)

echo quit >> !TMPFILE!

endlocal EnableDelayedExpansion

ftp -n -i "-s:%TMPFILE%" %FTPADDRESS%

del %TMPFILE%

cd %INITIALDIR%

goto FTP_UPLOAD_EXIT

:FTP_UPLOAD_USAGE

echo Usage:    ftpupload [address] [username] [password] [local directory] [remote directory]
echo.

:FTP_UPLOAD_EXIT

set INITIALDIR=
set FTPADDRESS=
set FTPUSERNAME=
set FTPPASSWORD=
set LOCALDIR=
set REMOTEDIR=
set TMPFILE=
set CURRENT_DIRECTORY=
set RELATIVE_DIRECTORY=

@echo on 
```

**ftpget.bat**

```
@echo off

SET FTPADDRESS=%1
SET FTPUSERNAME=%2
SET FTPPASSWORD=%3
SET LOCALDIR=%~f4
SET REMOTEDIR=%5
SET REMOTEFILE=%6

if "%FTPADDRESS%" == "" goto FTP_UPLOAD_USAGE
if "%FTPUSERNAME%" == "" goto FTP_UPLOAD_USAGE
if "%FTPPASSWORD%" == "" goto FTP_UPLOAD_USAGE
if "%LOCALDIR%" == "" goto FTP_UPLOAD_USAGE
if not defined REMOTEDIR goto FTP_UPLOAD_USAGE
if not defined REMOTEFILE goto FTP_UPLOAD_USAGE

:TEMP_NAME
set TMPFILE=%TMP%\%RANDOM%_ftpupload.tmp
if exist "%TMPFILE%" goto TEMP_NAME

echo user %FTPUSERNAME% %FTPPASSWORD% > %TMPFILE%
echo bin >> %TMPFILE%
echo lcd %LOCALDIR% >> %TMPFILE%

echo cd "%REMOTEDIR%" >> %TMPFILE%
echo mget "%REMOTEFILE%" >> %TMPFILE%
echo quit >> %TMPFILE%

ftp -n -i "-s:%TMPFILE%" %FTPADDRESS%

del %TMPFILE%

goto FTP_UPLOAD_EXIT

:FTP_UPLOAD_USAGE

echo Usage:    ftpget [address] [username] [password] [local directory] [remote directory] [remote file pattern]
echo.

:FTP_UPLOAD_EXIT

set FTPADDRESS=
set FTPUSERNAME=
set FTPPASSWORD=
set LOCALDIR=
set REMOTEFILE=
set REMOTEDIR=
set TMPFILE=
set CURRENT_DIRECTORY=
set RELATIVE_DIRECTORY=

@echo on 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-07T18:02:53.387

I was having a similar issue - like the original poster, I wanted to automate a file upload, but I couldn't figure out how. Because this is on a register terminal at my family's store, I didn't want to install PowerShell (although that looks like an easy option) and I just wanted a simple .bat file to do this.

This is pretty much what grawity and another user said; I'm new to this stuff, so here's a more detailed example and explanation (thanks also to *[How to Automate FTP Uploads from the Windows Command Line](http://www.howtogeek.com/howto/windows/how-to-automate-ftp-uploads-from-the-windows-command-line/)* who explains how to do it with just one .bat file).

Essentially you need two files - one .bat and one .txt. The .bat tells ftp.exe what switches to use. The .txt gives a list of commands to ftp.exe. In the text file put this:

```
username
password
cd whereverYouWantToPutTheFile
lcd whereverTheFileComesFrom
put C:\InventoryExport\inventory.test (or your file path)
bye 
```

Save that wherever you want. In the BAT file put:

```
ftp.exe -s:C:\Windows\System32\test.txt destinationIP
pause 
```

Obviously change the path after the `-s:` to wherever your text file is. Take out the pause when you're actually running it - it's just so you can see any errors. Of course, you can use "get" or any other `ftp` command in the .txt file to do whatever you need to do.

I'm not positive that you need the `lcd` command in the text file. Like I said, I'm new to using command line for this type of thing, but this is working for me.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-25T19:55:44.033

This script generates the command file then pipes the command file to the ftp program, creating a log along the way. Finally print the original bat file, the command files and the log of this session.

```
@echo on
@echo off > %0.ftp
::== GETmy!dir.bat
>> %0.ftp echo a00002t
>> %0.ftp echo iasdad$2
>> %0.ftp echo help
>> %0.ftp echo prompt
>> %0.ftp echo ascii
>> %0.ftp echo !dir REPORT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo get REPORT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo !dir REPORT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo *************************************************   
>> %0.ftp echo !dir CONTENT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo get CONTENT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo !dir CONTENT.CP1C.ROLLEDUP.TXT
>> %0.ftp echo *************************************************   
>> %0.ftp echo !dir WORKLOAD.CP1c.ROLLEDUP.TXT
>> %0.ftp echo get WORKLOAD.CP1C.ROLLEDUP.TXT
>> %0.ftp echo !dir WORKLOAD.CP1C.ROLLEDUP.TXT
>> %0.ftp echo *************************************************   
>> %0.ftp echo !dir REPORT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo get REPORT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo !dir REPORT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo *************************************************   
>> %0.ftp echo !dir CONTENT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo get CONTENT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo !dir CONTENT.TMMC.ROLLEDUP.TXT
>> %0.ftp echo **************************************************   
>> %0.ftp echo !dir WORKLOAD.TMMC.ROLLEDUP.TXT
>> %0.ftp echo get WORKLOAD.TMMC.ROLLEDUP.TXT
>> %0.ftp echo !dir WORKLOAD.TMMC.ROLLEDUP.TXT
>> %0.ftp echo quit
ftp -d -v -s:%0.ftp 150.45.12.18 > %0.log
type %0.bat 
type %0.ftp 
type %0.log 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-28T17:01:21.833

I had this same issue, and solved it with a solution similar to what [Cheeso provided](https://stackoverflow.com/questions/936108/how-to-script-ftp-upload-and-download/936941#936941).

> "doesn't work, says password is srequire, tried it a couple different ways "

Yep, that's because FTP sessions via a command file don't require the username to be prefaced with the string "user". Drop that, and try it.

Or, you could be seeing this because your FTP command file is not properly encoded (that bit me, too). That's the crappy part about generating a FTP command file at runtime. PowerShell's out-file cmdlet does not have an encoding option that Windows FTP will accept (at least not one that I could find).

Regardless, as doing a WebClient.DownloadFile is the way to go.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-09-02T18:08:37.573

Try manually:

```
$ ftp www.domainhere.com 
> useridhere
> passwordhere
> put test.txt
> bye
> pause 
```

# java - 有没有办法使用 Apache POI 修改 Microsoft Word 页脚？

> ID：936110
> 
> 赞同：0
> 
> 时间：2009-06-01T18:31:40.040
> 
> 标签：java, ms-word, apache-poi

我需要使用 Java API 修改 Word 页脚的内容。

[Apache POI](http://poi.apache.org/)项目似乎[不](http://poi.apache.org/hwpf/quick-guide.html)[支持](http://poi.apache.org/apidocs/index.html) 此功能：

> 警告 - 您不应该更改页眉或页脚，因为偏移量尚未更新！

我的问题是双重的：

1.  有谁知道使用 POI 的 API 来做到这一点的方法？
2.  是否有不同的 java API 提供此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:13:30.347

不能代表 POI，但[Aspose.Words](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)可以让您操作 Doc 文件。不过也不便宜。

# java - 用 Java 编写一次一个锁

> ID：936113
> 
> 赞同：1
> 
> 时间：2009-06-01T18:32:06.263
> 
> 标签：java, concurrency

我正在尝试实现一个 Java 锁类型的东西，它执行以下操作：

1.  默认情况下，线程不传递锁。（与普通锁相反，只要不持有锁就可以获取锁。）
2.  如果只有一个线程在等待锁，则该线程中的执行将停止
3.  如果有多个线程在等待锁，则允许等待时间最长的线程继续执行。

我正在努力在 AbstractQueuedSynchronizer 之上实现它。允许最旧线程通过的转换如下所示：

```
//inner class inside Lock
private static class Sync extends AbstractQueuedSynchronizer {
    public Sync(){
        setState(-1);
    }

    public boolean tryAcquire(int ignore) {
        if (getState() == 1) return false;

        Thread first = getFirstQueuedThread();
        if (first != null &&
            first != Thread.currentThread()) {
            setState(0);
            return false;
        }
        return compareAndSetState(0, 1); 
```

我看到的问题是，当我调用 setState(0) 但返回 false 时，Sync 对象再也没有第一个线程 tryAcquire。我需要使用 SharedMode 吗？这个问题有更好的解决方案吗？

这是我所谓的“阀门”实现的一部分，我想将其用于长轮询 AJAX 响应。我有一个线程等待阀门“加压”的部分——有数据要发送给客户端）但是除非我不使用 AbstractQueuedSynchronizer，否则要释放最旧的线程似乎很困难，我真的不'不想编写一个从头开始的锁实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:21:59.570

看看 ReentrantLock 类（[http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html)）。

您可以将此锁定对象作为私有变量保留在您的类中，并使用它来执行您需要执行的任何操作。我不太确定在没有更多代码知识的情况下如何实现这一点，但是这个 Lock 对象具有提供您在帖子中提到的行为所需的所有方法。

要跟踪线程等待了多长时间，您可能必须将某些东西组合在一起以跟踪它。我不认为 Thread 类提供这种功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:39:06.080

你看过这个[链接吗](http://tutorials.jenkov.com/java-concurrency/starvation-and-fairness.html#fairlock)

> 公平的锁
> 
> 下面显示了之前的 Lock 类变成了一个名为 FairLock 的公平锁。您会注意到，与前面显示的 Lock 类相比，实现在同步和 wait() / notify() 方面发生了一些变化。
> 
> 确切地说，我是如何从上一个 Lock 类开始进行此设计的，这是一个较长的故事，涉及几个增量设计步骤，每个步骤都解决了上一步的问题：嵌套监视器锁定、滑动条件和丢失信号。为了使文本简短，本文本中省略了该讨论，但每个步骤都在有关该主题的适当文本中进行了讨论（请参阅上面的链接）。重要的是，每个调用 lock() 的线程现在都已排队，并且只有队列中的第一个线程被允许锁定 FairLock 实例，如果它被解锁的话。所有其他线程都停在等待，直到它们到达队列的顶部。

# c# - 如何在 C# 中创建字符串中每个字符的字符串数组？

> ID：936114
> 
> 赞同：1
> 
> 时间：2009-06-01T18:32:15.610
> 
> 标签：c#

创建矩阵的最佳方法是什么`C`？

```
 string A;
    char[] B = A.ToCharArray();
    string[] C = new string[B.Length];

    for (int i = 0; i < B.Length ; i++)
    {
        C[i] = B[i].ToString();
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T18:34:11.940

你只是想要一种更好的方式来做你正在做的事情？我想你可以这样做：

```
string   A = "ABCDEFG";
string[] C = A.Select(c => c.ToString()).ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:37:59.653

与 mquander 一样的另一种选择是使用[`Array.ConvertAll()`](http://msdn.microsoft.com/en-us/library/exc45z53.aspx)：

```
string[] C = Array.ConvertAll(A.ToCharArray(), c => c.ToString()); 
```

我通常更喜欢 LINQ 方法，但`ConvertAll`值得了解（对于数组和列表），因为它能够利用它知道开始大小的事实。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T18:40:14.970

```
using System.Text.RegularExpressions;

string[] chars = Regex.Split(s, string.Empty); 
```

# linux - 如何防止用户在 Linux 中创建、删除、重命名目录？

> ID：936116
> 
> 赞同：2
> 
> 时间：2009-06-01T18:32:44.780
> 
> 标签：linux, file-permissions, directory-structure

我对 Linux 文件和目录权限有点迷茫。我想做的是让一个用户能够创建、删除和重命名目录，而其他用户不能这样做，但他们应该能够读取和写入目录以及遍历它们。

所以组'storage'可以访问目录/workspace，这些用户不应该能够创建、删除或重命名目录。组 'storageAdmin' 也可以访问目录 /workspace，但能够在其中创建、删除或重命名目录。

每当“storageAdmin”创建一个新目录时，“storage”应该可以自动访问它，以便他们可以在其中读取和写入文件。

我是否正确认为 /workspace 需要由“storageAdmin”拥有并设置为 chmod 775 才能正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T18:55:38.090

正确的权限是`2775`, 也设置`set gid`位。这会导致新文件和目录继承父级的权限、所有者和组。

但请注意，标准的 unix 权限不允许您在将目录`storage`设置`chgrp`为`storageAdmin`. 现在每个人都可以根据`other`权限集进行访问。

如果您确实需要更细粒度的访问控制，请使用 Posix ACL 或 SE Linux。

# java - java RMI 连接到服务器

> ID：936119
> 
> 赞同：4
> 
> 时间：2009-06-01T18:33:20.990
> 
> 标签：java, rmi

我有一个非常简单的 rmi 客户端/服务器应用程序。虽然我不使用“rmiregistry”应用程序，但我使用它来创建服务器：

```
server = new RemoteServer();
registry = LocateRegistry.createRegistry(PORT);
registry.bind("RemoteServer", server); 
```

客户端部分是：

```
registry = LocateRegistry.getRegistry(IPADDRESS, PORT);
remote = (IRemoteServer) registry.lookup("RemoteServer"); 
```

这是一个有趣的问题：当服务器和客户端都在我的（私有）本地网络中运行时，应用程序可以完美运行。一旦我将服务器放在公共服务器上，应用程序就会挂起一分钟，然后给我以下错误：

```
java.rmi.ServerException: RemoteException occurred in server thread; nested exception is: 
    java.rmi.ConnectException: Connection refused to host: 192.168.x.y; nested exception is: 
    java.net.ConnectException: Connection timed out: connect
    at sun.rmi.server.UnicastServerRef.dispatch(Unknown Source)
    at sun.rmi.transport.Transport$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Unknown Source)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source  ... (the rest is truncated) 
```

我认为的关键是客户端（在我的专用网络上运行）无法连接到*我自己*（我的地址是 192.168.xy，其中 xy 是其他一些数字，但真正的错误消息显示我的 IP 地址在那里列出）

如果我在公共互联网上杀死 rmi 服务器，那么我会立即收到“连接拒绝托管：abcd”）消息，所以我知道服务器端的某些东西至少在工作。

有什么建议么？

编辑：只是为了更清楚一点：192.168.xy 是客户端地址，abcd 是服务器地址。堆栈跟踪显示客户端无法连接到客户端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-10T14:45:04.473

尝试使用此参数为虚拟机运行服务器：

```
-Djava.rmi.server.hostname=hostname_of_the_server 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:41:16.870

192.168.* 包含私有 IP 地址（与 10.* 一样）。这些不会在开放的互联网上路由。您需要确保您使用的是服务器的公共 IP 地址，并且所有防火墙（包括 NAT）都已配置为可以访问。您可以在所需端口上使用 telnet 进行快速检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T23:21:40.363

我相信服务器试图打开一个返回给客户端的套接字并且它失败了，这个例外在它的措辞上有点不清楚。

RMI 对 NAT 不太友好，IIRC。

# java - 在Java程序的标题栏中显示日文字符

> ID：936123
> 
> 赞同：3
> 
> 时间：2009-06-01T18:33:59.617
> 
> 标签：java, internationalization, jframe

除了Java中主窗口（JFrame）的标题栏外，我可以在任何地方显示日文字符。有没有办法改变这个标题栏的字体，让它可以显示日文字符？谢谢

我正在使用 Windows XP。如果这很重要，我也在使用 Java Substance 的外观和感觉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T18:42:06.293

窗口的标题栏由系统窗口管理器而不是 Swing 管理。你没有说你正在使用什么操作系统/GUI。

对于 Windows XP，打开显示控制面板，选择“外观”选项卡，然后单击“高级”按钮；您可以在那里更改标题字体（尽管系统上安装的字体可能没有您需要的字形）。

这里有一些代码检查系统默认字体是否支持你想要的字形（我不知道这个字符是什么；它是片假名集中的一个漂亮的字形）：

```
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;

public class GlyphCheck
{
    public static void main(String[] argv) throws Exception {
        final String title = "Testing: \u30CD";
        SwingUtilities.invokeAndWait(new Runnable() {
            public void run() {
                JFrame frame = new JFrame(title);
                frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                JLabel label = new JLabel(title);
                label.setSize(200, 100);
                frame.setContentPane(label);
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T09:25:12.877

```
JFrame.setDefaultLookAndFeelDecorated(true);
UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());
UIManager.put( "InternalFrame.titleFont", Resources.jaDefault.deriveFont(16.0f) );

Try it ;) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T21:46:58.807

我不熟悉 Java Substance，但我在开发 web 应用程序时遇到过这种情况。基本上日文、中文和韩文字符会显示在页面的内容中，但不会显示在浏览器标题栏中。

这是因为窗口系统控制这个标题栏，而不是浏览器。根据 kdgregory 的评论，听起来这与您的情况相似。

为了让窗口系统理解字符并且不显示不受支持的“框”，您必须确保安装了正确的字符集。对于 Windows XP，以下步骤解决了浏览器标题栏的问题：

1.  在 Windows 开始菜单上，打开控制面板。
2.  单击区域和语言选项图标，然后单击语言选项卡。
3.  在补充语言支持框中，选中为东亚语言安装文件的框。
4.  单击应用和确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T22:01:12.290

为了覆盖 Frame 的字体，您需要告诉外观来照顾它的外观。这可能是可取的，也可能不是可取的，但否则您将受制于系统。有些外观和感觉有相当不错的窗户装饰，有些则不然。物质没问题。告诉 UIManager 还要使用什么字体。

```
// Do this before you display any JFrame.
UIManager.put( "Frame.font", new Font( "Japanese", 12, Font.PLAIN ) );
JFrame.setDefaultLookAndFeelDecorated( true );

JFrame frame = new JFrame( title ); 
```

这种方法（如果它有效 - 对不起，没有测试过！）将意味着您将能够分发您的程序，而无需按照其他答案告诉用户他们需要更改其 Windows 设置。

# javascript - jquery 缓冲区/队列的效果？或者判断一个效果是否正在进行中？

> ID：936125
> 
> 赞同：1
> 
> 时间：2009-06-01T18:34:07.633
> 
> 标签：javascript, jquery, jquery-ui, effects

我有一个点击事件，检查表单是否正确，即填写详细信息..然后我调用一个执行此操作的函数

```
$('#message_text').html(text);
$('#message_system').fadeIn("slow");
$('#message_system').animate({ opacity: 1.0 }, 5000)
                    .fadeOut('slow', function() {
                        $(this).hide();
                    }); 
```

一切正常，只要我等待..如果我双击按钮两次，例如它停止显示...

我想如果它是隐藏的 hide() 那么fadeIn() 会自动显示它吗？

有人有这方面的经验吗？？

我可能想做的是第二次点击然后忽略当前效果并重新显示新消息

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:45:01.030

我不确定这是否是您所追求的，但您是否看过[stop()](http://docs.jquery.com/Effects/stop#clearQueuegotoEnd)方法。您可以通过在重新开始之前调用直接跳到任何当前动画的结尾`$('#message_system').stop(true, true)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:55:38.340

```
if ( ! $(this).is(':animated') ) {
    // Do the animation...
} 
```

# c# - C# Winforms-WPF 互操作

> ID：936134
> 
> 赞同：2
> 
> 时间：2009-06-01T18:37:41.247
> 
> 标签：c#, wpf, winforms, winforms-interop

目前我有一个依赖透明效果的 Winforms 应用程序。然而事实证明，这在过去的背后绝对是一种痛苦！我正在学习的 Winforms 并不能很好地处理透明度问题。

我想知道将WPF组件用于透明度位和winforms用于其余部分是否会更容易（请注意，尽管我想将整个应用程序移至WPF，但这是不可行的！）。我对 WPF 几乎一无所知，因此我在这里！我正在考虑的是：

1) 在 Winforms 用户控件中托管 WPF 组件，例如 WPF 控件示例：

```
<UserControl x:Class="WindowsFormsApplication1.UserControl1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <Grid>
         <Rectangle Name="rectangle1" Stroke="White" Fill="Black" RadiusX="10" RadiusY="10" Opacity="0.7" />
        <Rectangle Margin="57,101,43,99" Name="dialog" Stroke="Gray" Fill="White" RadiusX="10" RadiusY="10" />
    </Grid>
</UserControl> 
```

2) 在 WPF 控件的白色矩形（对话框）内承载一个 Winforms 用户控件（内容）。3) 允许内容（Winforms 用户控件）调用 WPF-Control 父级上的代码。

第一件事首先...

*   这是一个合理的做法还是我吠错了树？
*   这可以以更简单的方式实现吗？
*   有人能帮我一下吗？（示例代码将不胜感激！）
*   最后......有没有任何在线资源可以帮助我a）学习WPF和b）变得更加自给自足？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T18:44:46.490

这当然是可能的，我认为你是对的，这将是实现透明度的最简单方法。

我自己没有尝试过，[但是根据 CodeProject 上的这篇文章](http://www.codeproject.com/KB/WPF/WPF_UserControls.aspx)，它应该很简单。您应该使用[ElementHost 控件](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)来托管您的 WPF 内容。

在 WinForms 控件中托管 WPF 是一种受支持的方案，是框架中内置的一项功能。所以这样做应该没有问题。还有一个 WPF 组件用于另一种方式，将 WinForms 托管在 WPF 应用程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-19T07:13:46.040

这是我用来解决手头问题的解决方案。此解决方案依赖于覆盖控件将其父级呈现为位图图像。然后将其绘制为覆盖控件的背景。

```
public class OverlayingControl : UserControl
{
    /// <summary>
    /// Overrides the c# standard Paint Background to allow the custom background to be drawn 
    /// within the OnPaint function
    /// </summary>
    /// 
    /// <param name="e">Arguements used within this function</param>
    protected override void OnPaintBackground( PaintEventArgs e )
    {
        //Do Nothing 
    }

    protected override void OnPaint( PaintEventArgs e )
    {
        // Render the Parents image to a Bitmap. NB: bitmap dimensions and Parent Bounds can be changed to achieve the desitred effect
        Bitmap background = new Bitmap( Width, Height, PixelFormat.Format64bppArgb );
        Parent.DrawToBitmap( background, Parent.Bounds );

        // Paint background image             
        g.DrawImage( background, 0, 0, new RectangleF( Location, Size ), GraphicsUnit.Pixel );

        // Perform any alpha-blending here by drawing any desired overlay e.g.
        // g.FillRectangle( new SolidBrush( semiTransparentColor ), Bounds);
    }

} 
```

这纯粹在 WinForms 域内执行，但是我相信可以将此位图图像传递给 WPF 控件以根据需要进行渲染。目前没有规定在父项更改时更新 Bitmap，但是，创建一个清除位图并重新绘制 Overlayng 控件的自定义方法应该是微不足道的。我意识到这不是一个优雅的解决方案......但它似乎运作良好。

# java - 删除文件和文件夹问题

> ID：936140
> 
> 赞同：1
> 
> 时间：2009-06-01T18:39:21.977
> 
> 标签：java, file, websphere, directory, icefaces

我的项目是一个使用三种技术构建的 Web 项目：

1.  表示层的 Icefaces。

2.  业务层的弹簧。

3.  数据访问层的休眠。

我的项目部署在 WebSphere 6.1 上，用户可以上传文件，我使用 ice:inputFile 组件来处理上传过程......

**第一个问题是：**

上传过程完成后，我希望在以下路径下找到上传的文件：myWebProjectRoot/upload/"sessionId"/fileName.ext

其中“sessionId”是一个以当前会话 ID 命名的文件夹，fileName.ex 是用户上传的文件...

但我发现：文件夹“sessionId”没有创建，文件直接存储在上传文件夹中。

我的配置就像我将它部署在我的服务器上的 icefaces 库的组件展示的配置，它成功创建了 sessionId 目录....

我不知道该怎么办..请帮助我...

**第二个问题是：**

当会话过期时，我希望 sessionId 文件夹将被删除，我在*InputFileSessionCleaner*类中修改了组件展示的代码，并使其删除了该文件夹，它的子级递归地形成了bottm，但有时我会遇到当前的问题：

使用我的代码无法删除某些文件-可能是它们被另一个进程使用-，因此该文件夹不会被删除，因为它的一个子文件夹没有被删除。那么在这种情况下该怎么办......？

我脑子里有个想法，那就是：有没有办法在服务器端创建一个在后台运行的进程：这个进程检查上传目录，如果找到至少 60 分钟创建的任何文件 - 这是我在 web.xml 中指定的会话超时期限 - 此过程将删除此文件....

任何人都可以帮助我..每一个帮助都会得到满足.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T10:31:01.790

回答你的第二个问题：

WebSphere 具有创建工作线程并安排它们根据计划启动的工具。WebSphere 完全支持这种方法——使用它不会违反任何 Java EE 对线程创建的限制。

在您的 WebSphere 文档中搜索异步 Bean。

WebSphere 中有几种这种能力，其中一种是一种普遍标准化的形式，您也可以在其他供应商的应用服务器中找到它。这里给出了一些描述：http: [//www.ibm.com/developerworks/library/specification/j-commonj-sdowmt/index.html](http://www.ibm.com/developerworks/library/specification/j-commonj-sdowmt/index.html)

# c# - 是否可以从键盘输入切换菜单？

> ID：936142
> 
> 赞同：0
> 
> 时间：2009-06-01T18:39:37.357
> 
> 标签：c#, wpf, xaml, menuitem, key-bindings

我正在为具有绑定到 F1-F10、向上、向下、退格、回车的物理按钮的特殊用途硬件构建仪表板应用程序。该应用程序由几个视图组成（使用 MVVM 模式实现），并且大部分用户交互都是通过在物理按钮附近对齐的菜单完成的。我试图通过按 F 键来切换菜单状态，但我就是无法让该死的东西工作！

我已经（成功地，有点）尝试了一种替代解决方案，该解决方案捕获 F 键并将它们作为常规数字 1-10 发送，并使用 Accesskey 将 Alt+[1-10] 映射到菜单。这不是一个最佳解决方案，因为我必须跟踪菜单是否失去焦点（用户也可以使用触摸屏导航）。除此之外，我还尝试从 menuitem-header 中隐藏 accesskey-text（因为让它不可见似乎是不可能的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T15:49:08.560

老实说，我只是制作一个常规窗口并根据需要隐藏/显示它 - 只需有一个 ItemsControl，其 DataTemplate 是一个 MenuItem。菜单以标准的“菜单”方式管理，因此很难覆盖它并手动管理隐藏/显示状态。

# jquery - 在控制器的get方法中设置div可见fasle

> ID：936146
> 
> 赞同：1
> 
> 时间：2009-06-01T18:41:16.170
> 
> 标签：jquery, html, asp.net-mvc

我正在将 C# 与 MVC 一起使用。我想在Controller的Get方法中根据数据库中的条件设置div可见真/假。

请建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:16:15.460

在控制器中：

```
ViewData["DivIsVisible"] = ...
return View();

// or with ViewModel

public class TheViewModel
{
    public bool DivIsVisible;

    ...
}

...

var model = new TheViewModel { DivIsVisible = true /* false */, ... }
return View(model); 
```

在视图中：

```
<script runat="server">
    protected bool DivIsVisible {
        get {
            return ViewData["DivIsVisible"] != null && (bool)ViewData["DivIsVisible"];
        }
    }
</script>

<div <%= DivIsVisible ? "" : "style='display: none'" %>>
</div>

<% if(DivIsVisible) { %>
    <div>
        ...
    </div>
<% } %>

<!--or with View Model -->

<div <%= Model.DivIsVisible ? "" : "style='display: none'" %>>
</div>

<% if(Model.DivIsVisible) { %>
    <div>
        ...
    </div>
<% } %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T18:58:41.780

```
myDiv.Style["display"] = 'none'; 
```

或者

```
myDiv.Visible = false; 
```

这是你想要的吗 ？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-01T19:07:51.357

将数据库中的结果作为视图模型的一部分发送

那么你可以使用这个语法

```
<% if(Model.Property) == "desired value"{%>  
<% RenderPartial("div")%>
<%}%> 
```

最好的方法是使用 jQuery 分析数据库值来更改 div 的 CSS 属性

$(function(){ if(<%Model.Property == "期望值"%>) $(div).hide(); });

# regex - ColdFusion OR 条件中的正则表达式匹配

> ID：936153
> 
> 赞同：1
> 
> 时间：2009-06-01T18:41:59.473
> 
> 标签：regex, parsing, coldfusion, wiki

我正在尝试编写一个解析[wikiCreole](http://www.wikicreole.org/wiki/Creole1.0)文本的 CF 组件。不过，我无法使用我的一些正则表达式获得正确的匹配。我觉得如果我能把头绕到第一个周围，其余的就会点击。这是一个例子：

以下是示例输入：

```
You can make things **bold** or //italic// or **//both//** or //**both**//.

Character formatting extends across line breaks: **bold,
this is still bold. This line deliberately does not end in star-star.

Not bold. Character formatting does not cross paragraph boundaries. 
```

我的第一次尝试是：

```
<cfset out = REreplace(out, "\*\*(.*?)\*\*", "<strong>\1</strong>", "all") /> 
```

然后我意识到它与没有给出 ** 的地方不匹配，它应该在有两个回车的地方结束。

所以我尝试了这个：

```
<cfset out = REreplace(out, "\*\*(.*?)[(\*\*)|(\r\n\r\n)]", "<strong>\1</strong>", "all") /> 
```

它很接近但由于某种原因它给了你这个：

```
You can make things <strong>bold</strong>* or //italic// or <strong>//both//</strong>* or //<strong>both</strong>*//.

Character formatting extends across line breaks: <strong>bold,</strong>
this is still bold. This line deliberately does not end in star-star.

Not bold. Character formatting does not cross paragraph boundaries. 
```

有任何想法吗？

PS：如果有人对更好的标签或这篇文章的更好标题有任何建议，我会全力以赴。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T19:08:27.487

代表一个字符类，`[...]`所以：

```
[(\*\*)|(\r\n\r\n)] 
```

实际上与此相同：

```
[*|\r\n] 
```

即它匹配单个“*”和“|” 不是交替。

另一个问题是您更换了双换行符。即使您的匹配成功，您最终也会合并段落。您首先需要恢复它或不使用它。我会使用积极的前瞻性来做后者。

在 Perl 我会这样写：

```
$string =~ s/\*\*(.*?)(?:\*\*|(?=\n\n))/<strong>$1<\/strong>/sg; 
```

大胆猜测一下，ColdFusion 可能看起来像这样：

```
REreplace(out, "\*\*(.*?)(?:\*\*|(?=\r\n\r\n))", "<strong>\1</strong>", "all") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:58:16.290

你真的应该改变你的

```
(.*?) 
```

类似于

```
[^*]*? 
```

匹配除 * 之外的任何字符。我不知道这是否是问题，但它可能是 any-character 。正在吃你的一颗星星。在尝试平衡双星或 html 开始/结束标记等匹配字符以明确将它们从内部文本的匹配集中排除时，这也是一种普遍接受的“最佳实践”。

*免责声明，我没有在 ColdFusion 中测试这个正则表达式引擎的细微差别——但这个想法应该是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-21T13:58:05.043

我知道这是一个较老的问题，但在回应 Ryan Guill 所说的“我尝试了 $1 但它在里面放了一个字面的 $1 而不是匹配项”时，你应该使用 ColdFusion`\1`而不是`$1`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T18:48:38.837

我总是使用[正则表达式网页](http://www.regextester.com/)。每次使用正则表达式时，我似乎都是从头开始的。

尝试使用 ' **$1** ' 而不是 \1 这个 - 替换略有不同......但我认为模式是你需要开始工作的。

越来越接近这个：

> **(. *?)**|//(.* ?)//

棘手的部分是 //** 或 **//

> 好的，首先检查**//bold//** 然后 // **bold** // 然后是**粗体**，然后是 //bold//
> 
> **//(. *?)//**|//**(.* ?)**//|**(. *?)**|//(.* ?)//

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-07T23:29:14.873

当我使用正则表达式做任何事情时，我发现这个应用程序非常有用： [http](http://www.gskinner.com/RegExr/desktop/) ://www.gskinner.com/RegExr/desktop/ 仍然对您的实际问题没有帮助，但在未来可能会有用。

# lucene - 生产环境中的 Katta

> ID：936155
> 
> 赞同：4
> 
> 时间：2009-06-01T18:42:09.147
> 
> 标签：lucene, distributed, scalable, katta

据该[网站](http://katta.sourceforge.net/)称， Katta 是一种可扩展的、容错的、分布式的、索引的、数据存储。

我想知道它是否准备好部署到生产环境中。有人已经在使用它并有建议吗？有什么陷阱吗？建议？推荐？请分享。

任何答案将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-04T05:35:32.707

我们已经尝试过使用 katta 并且它的价值 - 发现它非常稳定，相对易于管理（与管理普通香草 lucene 相比）

我能想到的唯一缺陷是缺乏实时更新 - 当我们测试它时（大约 9-10 个月前）更新意味着，使用单独的进程（hadoop 作业或你有什么......）更新索引并替换实时索引，这对我们来说是一个交易破坏者。

如果您正在研究分布式 lucene，您应该尝试[一下 ElasticSearch](http://www.elasticsearch.org/)或[Solandra](https://github.com/tjake/solandra)

# macos - OS X Keychain 的密码助手功能通过终端

> ID：936161
> 
> 赞同：4
> 
> 时间：2009-06-01T18:46:02.727
> 
> 标签：macos, bash, terminal

OS X 的钥匙串有一个密码助手功能，可以根据用户标准（例如长度 = 18 和 FIPS-181 兼容）建议密码。

我想通过 bash 访问此功能。我特别感兴趣的是请求生成具有我想要的长度和复杂性属性的密码，然后将该密码项添加到特定的钥匙串中。

OS X 安全 CLI 应用程序解决了第二部分，但没有解决初始密码生成部分。

man security 没有列出有关密码助手功能的任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T10:24:00.493

您不能使用其他密码生成器，例如[APG](http://www.adel.nursat.kz/apg/)吗？这似乎可以满足您的所有需求，并且可以在 MacPorts 和 Fink 上使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-17T18:46:55.653

虽然似乎不存在官方的 Apple 解决方案，但有一个逆向工程库，可作为命令行工具使用，它重新创建了 GUI 密码助手中可用的所有功能。

请参阅此链接（截至 2014 年 4 月更新）：[https](https://bitbucket.org/anders/sf-pwgen) ://bitbucket.org/anders/sf-pwgen或[https://github.com/anders/pwgen](https://github.com/anders/pwgen)

开发者@anders-bergh 提供了源代码（包括 Xcode 项目），并提供了二进制文件的下载，可以在终端中执行（[https://bitbucket.org/anders/sf-pwgen/downloads](https://bitbucket.org/anders/sf-pwgen/downloads)） .

二进制文件也可以使用 brew: 安装`brew install sf-pwgen`。

从项目页面：

> **sf-pwgen**是一个生成密码的示例 CLI 应用程序：

```
usage: ./sf-pwgen [options]

Option:          Meaning:
  -a, --algorithm  Available algorithms: memorable, random
                   letters, alphanumeric, numbers.
  -c, --count      The number of passwords to generate.
                   The default is `memorable'.
  -l, --length     Desired length of the generated passwords.
  -L, --language   Generate passwords in a specified language.
                   Languages: en, de, es, fr, it, nl, pt, jp.
                   Note that this feature is broken and will
                   produce garbage, bug: rdar://14889281
  -v, --version    Print the version number and exit.
  -h, --help       Prints this message. 
```

# actionscript-3 - 带有动作脚本的程序总监文件？

> ID：936162
> 
> 赞同：0
> 
> 时间：2009-06-01T18:46:19.013
> 
> 标签：actionscript-3, flash, adobe-director

我已经编写 flash/actionscript 多年了；有没有办法可以制作 Flash/AS3 项目并将其导出为 .dir 项目？或者是否有办法使用 AS3 作为 Director 中的语言？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T18:52:08.627

您可以在 AS3 和 Lingo 之间进行调用，尽管它们是异步调用，因此您必须小心不要依赖于立即执行的调用。您可以将 .SWF 文件插入到 Director 文件中，但不能直接在 Director 中修改 .SWF 文件。在两者之间工作可能相当乏味，除非你有充分的理由，否则我不会推荐它。

如果您正在学习有关 Director 的课程，我建议您学习 Director 和 Lingo。这些方面的专业知识有限，如果你知道如何与他们合作，它可以让你更有工作能力。

# c# - 包含和引用 C# 类中的资源文件

> ID：936164
> 
> 赞同：0
> 
> 时间：2009-06-01T18:47:03.740
> 
> 标签：c#, visual-studio

我的 C# 应用程序生成的一些 PDF 文件中使用了一个图像。当图像文件位于我的工作区时，我知道如何引用它，但是当我编译程序时，我在编译目录中的任何地方都看不到图像。

有人可以告诉我该文件发生了什么吗，或者当我将程序发送给用户时，我是否必须手动将文件与我的程序一起打包？我通过拖放到我的一个命名空间的资源目录将图像添加到工作区。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T18:49:31.613

在 Visual Studio 中检查文件的属性。您是否将`CopyToOutputDirectory`属性设置为除此之外的其他内容`Do not copy`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:49:51.520

嗯...我不确定整个拖放业务，但如果一切正常，资源将被嵌入到您的程序集中。

我建议您看一下[Reflector](http://www.red-gate.com/products/reflector/) - 您可以使用它查看嵌入在程序集中的资源。

在解决方案资源管理器中查看项目的构建属性 - 特别是，如果构建操作是嵌入式资源，那么它确实会被构建到程序集中。

# sharepoint - 如何确定 SharePoint 列表的磁盘大小？

> ID：936167
> 
> 赞同：4
> 
> 时间：2009-06-01T18:47:37.077
> 
> 标签：sharepoint, moss, wss

我有一个包含大约 5500 个项目的列表，我想找出磁盘上的大小。有什么办法可以做到这一点吗？如有必要，我不介意在数据库中运行查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T21:51:33.820

导航到[http://[myapplication]/[mySitecollection]/_layouts/storman.aspx](http://[myapplication]/[mySitecollection]/_layouts/storman.aspx)

这将列出网站集的存储空间分配。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T21:56:37.600

如果启用站点配额，站点设置下会出现一个选项，称为**存储空间分配**。当您在管理中心设置配额时，该页面会告诉您当前使用的存储空间是多少，以便您在此之前有所了解。进入**存储空间分配**报告后，您可以看到库的总大小。

不幸的是，如果不启用站点配额，您将无法获得此报告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-10T21:54:06.057

我无法让 Tim Dobrinski 的建议奏效。这个 T-SQL 查询并不处理所有事情，但提供了一个非常好的主意。将其弹出到 Excel 中，然后为“以 MB 为单位的大小”添加一列并添加一个公式。

```
USE [WSS_Content]
GO

SELECT
       [dbo].[Webs].[FullUrl]
      ,[dbo].[Lists].[tp_Title] AS "ListName"
      ,[dbo].[Docs].[DirName]
      ,[dbo].[Docs].[LeafName]
      ,[dbo].[Docs].[Size]
      ,[dbo].[Docs].[MetaInfoSize]
      ,[dbo].[Docs].[Version]
      ,[dbo].[Docs].[TimeCreated]
      ,[dbo].[Docs].[TimeLastModified]
      ,[dbo].[Docs].[MetaInfoTimeLastModified]
      ,[dbo].[Docs].[CheckoutUserId]
      ,[dbo].[Docs].[CheckoutDate]
      ,[dbo].[Docs].[ExtensionForFile]

  FROM [WSS_Content].[dbo].[Docs]
  INNER JOIN [WSS_Content].[dbo].[Webs] ON [dbo].[Webs].[Id] = [dbo].[Docs].[WebId]
  INNER JOIN [WSS_Content].[dbo].[Lists] ON [dbo].[Lists].[tp_ID] = [dbo].[Docs].[ListId]

  WHERE [dbo].[Docs].[Size] > 0     
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.stp')   
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.aspx')
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.xfp')
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.dwp')
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%template%')
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.inf')
  AND ([dbo].[Docs].[LeafName] NOT LIKE '%.css') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:15:37.310

如果您将有问题的列表作为模板保存到文件系统，这应该可以让您大致了解其大小。如果您需要定期执行此操作，则此方法没有那么有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-25T11:45:44.593

站点设置 -> 存储指标

您可以查看每个对象的消耗量，单击**列表**查看每个单独的列表

You don't have to set a site quota

Sharepoint 2013

![Site settings](https://i.stack.imgur.com/7biZW.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-21T08:15:49.563

This is taken from SharePoint 2013:

```
USE [WSS_Content_Intranet]
GO

SELECT 
    (ISNULL(DocSizes,0) + ISNULL(UserDataSize,0)) As TotalSize, 
    nLists.tp_ID,
    nLists.tp_Title,
    nLists.tp_ItemCount,
    Webs.FullUrl
FROM
    Webs
INNER JOIN
    (
    SELECT 
        ALAux.ItemCount as tp_ItemCount, 
        Lists.tp_Title, 
        Lists.tp_ID, 
        Lists.tp_WebID, 
        ALAux.Modified as tp_Modified, 
        Lists.tp_ServerTemplate, 
        Docs.DirName, 
        Docs.LeafName, 
        Lists.tp_ImageUrl
    FROM 
        Lists
    CROSS APPLY
        TVF_AllListsAux_NoLock_ListId(Lists.tp_SiteId, Lists.tp_ID) AS ALAux
    INNER JOIN 
        Docs
    ON 
        Lists.tp_RootFolder = Docs.Id AND 
        Lists.tp_WebId = Docs.WebId 
    WHERE 
        tp_BaseType <> 1 AND
        Lists.tp_SiteId = YOUR_SITE_ID
    ) As nLists
    ON
        Webs.Id = nLists.tp_WebId
    LEFT OUTER JOIN
        (
        SELECT 
            (SUM(CAST((ISNULL(Docs.Size,0)) AS BIGINT))) As DocSizes, 
            Docs.ListId,
            Docs.SiteId
        FROM 
            Docs 
        WHERE
            Docs.Type = 0 AND SiteId = YOUR_SITE_ID
        GROUP BY
            Docs.ListId,Docs.SiteId
        ) As DocsInList
        ON
            DocsInList.ListId = nLists.tp_ID
        LEFT OUTER JOIN
            (
            SELECT 
                (SUM(CAST((ISNULL(tp_Size,0)) AS BIGINT))) As UserDataSize, 
                tp_ListId 
            FROM
                UserData 
            GROUP BY 
                UserData.tp_ListId
            ) AS UserDataInList
            ON
                UserDataInList.tp_ListId = DocsInList.ListId
ORDER BY TotalSize DESC 
```

It returns all lists of all webs, summing the size of the items and the attached documents. Document libraries are not included, use this:

```
SELECT
    Lists.tp_Title,
    Lists.tp_ID as Id,
    SUM(Docs.Size/1024 + Docs.MetaInfoSize/1024)/1024 AS SizeMB,
    COUNT(*) as NumberOfFiles
FROM dbo.Docs
    INNER JOIN Webs ON Webs.Id = Docs.WebId
    INNER JOIN Lists ON Lists.tp_ID = Docs.ListId
WHERE Docs.Size > 0
GROUP BY Lists.tp_Title,Lists.tp_ID 
```

# delphi - 在 devexpress tdxdbgrid 中，有没有办法允许 rowselect 和 keypress 事件同时触发？

> ID：936168
> 
> 赞同：0
> 
> 时间：2009-06-01T18:47:44.720
> 
> 标签：delphi, devexpress

客户希望选择行，以便他可以知道左侧正在处理的记录，同时只能编辑 1 列。

所以，建议如何允许行选择加按键事件触发，或者如何根据是否输入了该行中的另一个单元格来为单元格着色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T08:27:58.290

最好使用带有 OnGetContentStyle 事件的 Styles 集合为不同的 cxGrid 行着色。

```
procedure StylesGetContentStyle(Sender: TcxCustomGridTableView;
  ARecord: TcxCustomGridRecord; AItem: TcxCustomGridTableItem;
  out AStyle: TcxStyle);  
begin    
  if SomeCondition then
    AStyle := SomeTcxStyle;  
end; 
```

另一种方法是使用 OnCustomDrawCell 事件并自己绘制网格。我更喜欢使用样式，它更干净。

# database - 如何封装数据库访问？

> ID：936172
> 
> 赞同：3
> 
> 时间：2009-06-01T18:48:40.880
> 
> 标签：database, hibernate, orm, design-patterns, encapsulation

我正在.NET 中开发一个事务应用程序，并希望获得一些关于如何正确封装数据库访问的意见，以便：

*   我没有到处都有连接字符串
*   从不同的函数多次调用同一个存储过程
*   或更糟糕的是，单个列不同的多个存储过程

我很想知道使用像 NHibernate 这样的 ORM 是否有用，因为它可能只会为快速变化的数据模型增加另一层复杂性，并且需要在紧凑的时间内生成工件。

我对 ORM 包以外的方法或模式更感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:06:57.613

至少有两种被广泛接受的设计模式用于封装数据访问：

*   存储库 (DDD)
*   DAO（数据访问对象）

为了完整起见，我建议您阅读以下书籍：

*   [企业应用架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)(Fowler)
*   [领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321125215)（埃文斯）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:11:07.357

如果看起来这是一个重要的项目，而 DAL 是一个主要的风险因素，请让以前做过的人参与进来。你说得对，在没有扎实经验的情况下第一次尝试做对，有太多的方法会偏离轨道。

有许多模式可以实现这一点，但我会寻找那些拥有一套简单的、定义明确的模式的人，他们完全可以接受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T20:53:53.500

如上所述，检查存储库和工作单元模式。强烈推荐福勒和埃文斯的书。karl seguin 的读者也是如此，它给了我对刚刚提到的书籍的更酷的介绍。[在http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx](http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx)获取它

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-01T21:02:33.433

作为 Java 开发人员，我建议阅读 jdbc 模板，尽管它不是 .NET，但您可以了解 Spring 框架如何封装数据访问层并获得一些想法。

# sql - VarChar(50) 上的 SQL Server 索引 - 这是全文吗？要不然是啥？

> ID：936178
> 
> 赞同：0
> 
> 时间：2009-06-01T18:50:27.400
> 
> 标签：sql, sql-server, tsql, sql-server-2008, full-text-search

当我在我的 SQL Server 2008 数据库中的 VarChar 列上创建索引时，究竟会发生什么。这显然是一个文本列。

它会被自动全文索引还是创建不同类型的索引？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T18:58:36.947

全文索引不同于普通索引。考虑这两个看似等效的 where 子句：

```
WHERE [mycolumn] LIKE '%' + @MyValue + '%'

WHERE CONTAINS([mycolumn], @MyValue) 
```

前者*不会*使用*任何*索引，即使是您在问题中提到的普通索引。它不被认为是**[sargable](http://en.wikipedia.org/wiki/Sargable)**。后者专门告诉服务器使用全文索引。

另一方面，这将适用于普通索引，但会忽略任何可用的全文索引：

```
WHERE [mycolumn] LIKE @MyValue + '%' 
```

正常索引之所以起作用，是因为它们是*有序*的。当您在索引中查找一个值时，您可以使用二分搜索、b*-tree 或类似算法来更快地找到或拒绝您的匹配项，并且在比较连接或范围时，服务器可以“行走”索引以有效地检查多个值。

全文索引不能只是排序，因为您必须能够像在开始时一样快速地在内容中间进行搜索。因此它们要[复杂得多](http://en.wikipedia.org/wiki/Full_text_search)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T18:52:33.900

不，您必须为该类型的搜索创建全文索引列。它不是使用普通索引自动创建的。

# zend-framework - Zend Sessions 问题（初学者）

> ID：936182
> 
> 赞同：1
> 
> 时间：2009-06-01T18:52:17.550
> 
> 标签：zend-framework, session, zend-view, zend-session

我正在自学 Zend am，并且在使用我的会话调用 View Helper 操作时遇到问题。

我的控制器：

```
<?php
class SessionController extends Zend_Controller_Action
{
    protected $session;
    public function init() //Like a constructor
    {
        $this->_helper->viewRenderer->setNoRender(); // Will not automatically go to views/Session
        $this->_helper->getHelper('layout')->disableLayout(); // Will not load the layout
    }       

    public function preDispatch() //Invokes code before rendering.  Good for sessions/cookies etc.
    {
        $this->session = new Zend_Session_Namespace(); //Create session
        if(!$this->session->__isset('view'))
        {
            $this->session->view = $this->view; //if the session doesn't exist, make it's view default
        }

    }
    public function printthingAction()
    {
        echo $this->session->view->tabbedbox($this->getRequest()->getParam('textme'));
    }
}
?> 
```

我的视图助手

```
<?php
class App_View_Helper_Tabbedbox extends Zend_View_Helper_Abstract
{
    public $wordsauce = "";
    public function tabbedbox($message = "")
    {
        $this->wordsauce .= $message;
        return '<p>' . $this->wordsauce . "</p>";
    }
}
?> 
```

我的观点：

```
<p>I GOT TO THE INDEX VIEW</p>

<input id='textme' type='input'/>
<input id='theButton' type='submit'/>

<div id="putstuffin"></div>

<script type="text/javascript">
$(function()
{
    $("#theButton").click(function()
    {
        $.post(
        "session/printthing",
        {'textme' : $("#textme").val()},
        function(response)
        {
            $("#putstuffin").append(response);
        });
    });
});

</script> 
```

我第一次单击按钮时，它会起作用，并按照应有的方式附加我的单词。但是，每次之后，它都会给我这个错误消息：

**警告：call_user_func_array() [function.call-user-func-array]：第一个参数应该是一个有效的回调，'__PHP_Incomplete_Class::tabbedbox' 在 C:\xampp\htdocs\BC\library\Zend\View 中给出\Abstract.php 在第 341 行**

我几乎一行一行地复制了 Zendcasts.com 的视频，但它仍然无法正常工作。好像我的会话被破坏了。我将永远感激任何能告诉我发生了什么的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T16:15:37.560

当您在会话中存储一个对象时，您实际上是在存储它的**序列化表示**。发生 __PHP_Incomplete_Class::tabbedbox 是因为在后续请求中，PHP 忘记了 App_View_Helper_Tabbedbox 是什么。

解决方案：确保在调用 Zend_Session::start() 之前包含 App_View_Helper_Tabbedbox 类文件。

而且，最好的方法是把它放在你的应用程序的开头：

```
require_once 'Zend/Loader.php';
Zend_Loader::registerAutoload(); 
```

# perl - 有可移植的 Perl 吗？

> ID：936185
> 
> 赞同：16
> 
> 时间：2009-06-01T18:53:10.530
> 
> 标签：perl, portability, portable-applications

是否有类似可移植 Python 的可移植 Perl？我可以从我的拇指驱动器中使用的东西（在学习这些东西的同时）？

哦，我说的是Window XP。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-01T18:55:03.473

我可以衷心推荐[Strawberry Perl](http://strawberryperl.com/)。

Portable 版本是 Beta 版（不过 Beta 的真正含义），请单击[此处](http://strawberryperl.com/download/strawberry-perl-5.10.0.4-portable-beta-2.zip)获取。

编辑：便携版已经过测试版（几个月了），请[在此处查看](http://strawberryperl.com/releases.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T19:28:38.087

[PortableApps.com](http://portableapps.com/node/12595)上有一个测试版本，尽管从长远来看，它似乎将被[Strawberry Perl](http://strawberryperl.com/)（这是它所基于的）取代。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T01:17:14.653

我已经使用 Portable Strawberry Perl 5.10 将应用程序部署到敌对的最终用户机器（即我无法控制且没有管理员密码的机器）上，没有任何问题。对于 Windows 中的开发工作，您可能需要[这个](http://szabgab.com/blog/2008/11/1228059107.html)

# css - CSS margin 奇怪的行为，为什么？

> ID：936186
> 
> 赞同：3
> 
> 时间：2009-06-01T18:55:01.587
> 
> 标签：css, margins

有下面的HTML

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<body>
    <div style="width:400px;height:200px;background-color:Gray;margin-bottom:10px;"></div>
    <div style="width:400px;height:200px;background-color:Green;margin-top:10px;"></div>
</body>
</html> 
```

这两个 DIV 之间的空间只有 10 个像素。

为什么？请解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T19:02:13.193

这种行为称为[折叠边距](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)。不添加边距值，但使用较高的值：

> 某些框之间的垂直边距可能会折叠：
> 
> *   正常流程中两个或多个相邻的块框垂直边距折叠。生成的边距宽度是相邻边距宽度的最大值。[…]
> *   […]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:06:30.517

[这是对边距折叠](http://www.dave-woods.co.uk/?p=194)的一个很好的解释。基本上，根据 CSS 规范和所有常识，所有相邻的边距似乎都会相互折叠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T19:12:07.697

如果你想获得想要的效果，你可以使用“填充”，边距总是折叠

# php - 将所有参数传递给另一个函数

> ID：936192
> 
> 赞同：18
> 
> 时间：2009-06-01T18:56:18.447
> 
> 标签：php, syntax

我有两个这样的功能：

```
function mysql_safe_query($format) {
    $args = array_slice(func_get_args(),1);
    $args = array_map('mysql_safe_string',$args);
    $query = vsprintf($format,$args);
    $result = mysql_query($query);
    if($result === false) echo '<div class="mysql-error">',mysql_error(),'<br/>',$query,'</div>';
    return $result;
}

function mysql_row_exists() {
    $result = mysql_safe_query(func_get_args());
    return mysql_num_rows($result) > 0;
} 
```

问题是第二个函数不起作用，因为它将 args 作为数组传递给第一个函数，而它期望它们作为不同的参数。有没有办法解决这个问题，最好不修改`mysql_safe_query`？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-01T18:59:05.837

如何使用：

```
$args = func_get_args();
call_user_func_array('mysql_safe_query', $args); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-09-15T16:30:39.310

注意在 PHP 5.6 中，您现在可以这样做：

```
function mysql_row_exists(...$args) {
    $result = mysql_safe_query(...$args);
    return mysql_num_rows($result) > 0;
} 
```

此外，对于未来的读者，不推荐使用 mysql_* ——不要使用这些函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T10:04:37.843

根据具体情况，以下操作也可能对您有用，并且可能会更快一些。

```
function  mysql_safe_query($format) {
    $args = func_get_args();
    $args = is_array($args[0]) ? $args[0] : $args; // remove extra container, if needed
    // ... 
```

现在允许两种类型的调用，但如果您的**第一个值**应该是实际的**数组**，则可能会出现问题，因为它会以任何一种方式解包。

您还可以检查根数组的长度，因此如果有其他元素，它可能不会被解包，但如前所述：一般来说，它并不是那么“干净”，但可能会有所帮助且快速:-)

# c# - 如何从 UserControl 禁用 Windows 窗体上的“X”按钮？

> ID：936195
> 
> 赞同：2
> 
> 时间：2009-06-01T18:56:41.473
> 
> 标签：c#, winforms

我试过： ParentForm.ControlBox = false;

...但它似乎不起作用... ControlBox 仍处于启用状态！

有任何想法吗？

/我不想使用 Win32 互操作方法禁用“X”。禁用 ControlBox 很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:01:43.990

您是否尝试过使用[FindForm](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.findform.aspx) () 方法？似乎 ParentForm 属性可以返回一个空引用（虽然还不确定在哪种情况下）。当我创建一个空的 UserControl 并将其添加到表单时，它现在对我有用。不过，通过 FindForm 禁用 ControlBox 效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:04:45.000

ParentForm.ControlBox = false，应该可以

在 C# 中只需添加

```
 protected override void OnClosing(CancelEventArgs e)
    {
        e.Cancel = true;
    } 
```

这不会禁用 ControlBox，但会阻止窗口关闭

# webserver - 应用服务器和Web服务器有什么区别？

> ID：936197
> 
> 赞同：845
> 
> 时间：2009-06-01T18:57:26.557
> 
> 标签：webserver, terminology, application-server

应用服务器和Web服务器有什么区别？

* * *

## 回答 #1

> 赞同：676
> 
> 时间：2009-06-01T19:10:07.407

大多数时候，这些术语 Web 服务器和应用程序服务器可以互换使用。

以下是 Web Server 和 Application Server 在功能上的一些主要区别：

*   Web 服务器旨在提供 HTTP 内容。App Server 也可以提供 HTTP 内容，但不仅限于 HTTP。可以提供RMI/RPC等其他协议支持
*   Web 服务器主要设计用于提供静态内容，尽管大多数 Web 服务器都有插件来支持 Perl、PHP、ASP、JSP 等脚本语言，这些服务器可以通过这些插件生成动态 HTTP 内容。
*   大多数应用服务器都将 Web Server 作为其不可或缺的一部分，这意味着 App Server 可以做任何 Web Server 能够做的事情。此外，App Server 具有支持应用程序级服务的组件和功能，例如连接池、对象池、事务支持、消息传递服务等。
*   由于 web 服务器非常适合静态内容和动态内容的应用程序服务器，因此大多数生产环境都将 web 服务器用作应用程序服务器的反向代理。这意味着在处理页面请求时，静态内容（例如图像/静态 HTML）由解释请求的 Web 服务器提供。使用某种过滤技术（主要是请求资源的扩展）Web 服务器识别动态内容请求并透明地转发到应用服务器

此类配置的示例是 Apache Tomcat HTTP Server 和 Oracle（以前称为 BEA）WebLogic Server。Apache Tomcat HTTP Server 是 Web 服务器，Oracle WebLogic 是应用程序服务器。

在某些情况下，服务器是紧密集成的，例如 IIS 和 .NET Runtime。IIS 是网络服务器。当配备.NET 运行环境时，IIS 能够提供应用程序服务。

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2014-06-07T13:17:22.930

这是一些场景的详细答案，可以清楚地了解差异和相似之处，以及两者如何协同工作。

**应用程序服务器**是一个有时与**Web 服务器**混合使用的术语。Web 服务器主要处理**HTTP 协议**，而应用程序服务器处理几种不同的协议，包括但**不限于 HTTP**。

Web服务器的主要工作是**显示网站内容**，应用服务器**负责逻辑**，用户与显示内容的交互。应用程序服务器与 Web 服务器**一起工作**，一个显示，另一个交互。

服务器和客户端之间来回传输的信息不仅限于简单的显示标记，还限于两者之间的交互。

在大多数情况下，服务器**通过组件 API 创建这种交互**，例如*[J2EE](http://searchsoa.techtarget.com/definition/J2EE)（Java 2 平台）*、*[EJB](http://en.wikipedia.org/wiki/Enterprise_JavaBeans)（企业 JavaBean）*和其他不同的应用软件模型。

![在此处输入图像描述](https://i.stack.imgur.com/qCgzQ.gif)

***一个例子：***

*了解应用程序服务器与 Web 服务器一起使用的场景与没有应用程序服务器的场景之间的区别的最佳方法是通过在线商店。*

***场景 1：没有应用程序服务器的 Web 服务器***

您有一个只有 Web 服务器而没有应用程序服务器的在线商店。该网站将提供一个展示，您可以从中选择产品。当您提交查询时，站点会执行查找并将 HTML 结果返回给其客户端。Web 服务器将您的查询直接发送到数据库服务器（请耐心等待，我将在下一篇文章中解释这一点）并等待响应。收到后，Web 服务器会将响应制定为 HTML 文件并将其发送到您的 Web 浏览器。每次运行查询时都会发生服务器和数据库服务器之间的这种来回通信。

***场景 2：带有应用程序服务器的 Web 服务器***

如果您要运行的查询之前已经完成并且此后没有数据更改，则服务器将生成结果而无需将请求发送到数据库服务器。这允许实时查询，其中第二个客户端可以访问相同的信息并接收实时、可靠的信息，而无需向数据库服务器发送另一个重复查询。服务器基本上充当数据库服务器和 Web 服务器之间的中介。这允许在第一种情况下提取的信息可重用，因为此信息嵌入在特定的“自定义”HTML 页面中，这不是可重用的过程。第二个客户端将不得不再次请求信息并接收另一个包含所请求信息的 HTML 嵌入页面 - 效率非常低。

为了支持如此多样的复杂任务，该服务器必须具有内置冗余、强大的处理能力和大量 RAM，以实时处理它正在提取的所有数据。

* * *

## 回答 #3

> 赞同：147
> 
> 时间：2009-06-01T19:30:12.357

这两个术语都非常通用，一个包含另一个，在某些情况下反之亦然。

*   **Web 服务器**：使用 http 协议向 Web 提供内容。

*   **应用服务器**：托管和公开业务逻辑和流程。

我认为主要的一点是Web服务器通过http协议暴露一切，而应用服务器不限于此。

也就是说，在很多场景中，您会发现 Web 服务器被用于创建应用程序服务器的前端，也就是说，它公开了一组网页，允许用户与在其中找到的业务规则进行交互。应用服务器。

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2016-02-12T10:56:12.273

**网络服务器**

运行`python -m 'SimpleHTTPServer'`并转到[http://localhost:8080](http://localhost:8080)。您看到的是一个正在运行的 Web 服务器。服务器只是通过 HTTP 提供存储在您计算机上的文件。关键是这一切都是在 HTTP 协议之上完成的。例如，还存在 FTP 服务器，它们执行完全相同的操作（服务存储的文件），但基于不同的协议。

**应用服务器**

假设我们有一个像下面这样的小应用程序（来自[Flask](http://flask.pocoo.org/)的片段）。

```
@app.route('/')
def homepage():
    return '<html>My homepage</html>'

@app.route('/about')
def about():
    return '<html>My name is John</html>' 
```

小示例程序将 URL 映射`/`到 function`homepage()`和`/about`function `about()`。

要运行此代码，我们需要一个应用服务器（例如 Gunicorn）——一个可以监听来自客户端的请求并使用我们的代码动态返回某些内容的程序或模块。在示例中，我们只是返回了一些非常糟糕的 HTML。

其他人都在谈论的业务逻辑是什么？好吧，由于 URL 映射到我们代码库中的某个特定位置，因此我们假设展示了一些关于我们的程序如何工作的逻辑。

* * *

**重述**

**Web 服务器**- 提供存储在某处的文件（最常见的是 .css、.html、.js）。常见的 Web 服务器是 Apache、Nginx 甚至 Python 的 SimpleHTTPServer。

**应用程序服务器**- 提供动态生成的文件。本质上，大多数 Web 服务器都有某种插件，甚至带有内置功能来做到这一点。也存在严格的应用服务器，如 Gunicorn (Python)、Unicorn (Ruby)、uWSGI (Python) 等。

请注意，您实际上可以使用应用程序服务器的代码构建 Web 服务器。这在开发过程中的某些情况下完成，您不希望在您的计算机上运行大量不同的服务器。

* * *

## 回答 #5

> 赞同：69
> 
> 时间：2009-06-01T19:54:20.453

正如 Rutesh 和 jmservera 所指出的，这种区别是模糊的。从历史上看，它们是不同的，但到 90 年代，这两个先前截然不同的类别融合了特征并有效地融合在一起。此时最好将“App Server”产品类别想象为“Web 服务器”类别的严格超集。

一些历史。在 Mosaic 浏览器和超链接内容的早期，出现了一种称为“网络服务器”的东西，它通过 HTTP 提供网页内容和图像。大多数内容是静态的，HTTP 1.0 协议只是一种传送文件的方式。“Web 服务器”类别很快演变为包括 CGI 功能——有效地在每个 Web 请求上启动一个进程以生成动态内容。HTTP 也变得成熟，产品变得更加复杂，具有缓存、安全和管理功能。随着技术的成熟，我们从 Kiva 和 NetDynamics 那里获得了公司特定的基于 Java 的服务器端技术，最终都合并到了 JSP 中。微软在 Windows NT 4.0 中添加了 ASP，我认为是在 1996 年。静态 Web 服务器学习了一些新技巧，因此它是一个有效的“

在并行类别中，应用服务器已经发展并存在了很长时间。公司为 Unix 提供了 Tuxedo、TopEnd、Encina 等产品，这些产品在哲学上源自大型机应用程序管理和监控环境，如 IMS 和 CICS。Microsoft 的产品是 Microsoft Transaction Server (MTS)，后来演变成 COM+。这些产品中的大多数都指定了“封闭的”特定于产品的通信协议，以将“胖”客户端与服务器互连。（对于 Encina，通信协议是 DCE RPC；对于 MTS，是 DCOM；等等。）在 1995/96 年，这些传统的应用服务器产品开始嵌入基本的 HTTP 通信能力，首先是通过网关。线条开始模糊。

Web 服务器在处理更高的负载、更多的并发性和更好的功能方面变得越来越成熟。应用服务器提供了越来越多的基于 HTTP 的通信能力。

此时，“应用服务器”和“Web 服务器”之间的界限是模糊的。但人们继续以不同的方式使用这些术语，作为强调的问题。当有人说“Web 服务器”时，您通常会想到以 HTTP 为中心、Web UI 和面向应用程序。当有人说“应用服务器”时，您可能会想到“更重的负载、企业功能、事务和队列、多通道通信（HTTP + 更多）。但通常它是同时满足两组工作负载需求的同一个产品。

*   WebSphere，IBM 的“应用服务器”拥有自己的捆绑 Web 服务器。
*   WebLogic，另一个传统的应用服务器，同样如此。
*   Windows 是微软的应用服务器（除了是它的文件和打印服务器、媒体服务器等），它捆绑了 IIS。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2009-11-01T14:26:02.787

正如许多人之前所说，Web 服务器处理 HTTP 请求，而应用程序服务器处理分布式组件的请求。因此，了解差异的最简单方法可能是比较这两种产品提供的编程环境。

## Web 服务器 -> 编程环境

IIS：ASP（.NET）

Tomcat：小服务程序

码头：Servlet

阿帕奇：PHP，CGI

## 应用服务器 -> 编程环境

MTS：COM+

是：EJB

JBoss : EJB

WebLogic 应用服务器：EJB

关键的区别在于应用服务器支持一些**分布式组件**技术，提供远程调用和分布式事务等特性，如Java世界中的**EJB**或微软平台上的**COM+ 。**Http 服务器通常支持一些更简单的编程环境，通常是脚本，例如在 Microsoft 或基于 Servlet 的情况下的 ASP (.NET)，包括 JSP 和许多其他情况下的 Java 或 PHP 和 CGI​​ 情况下的 Apache。

其他功能，如负载平衡、集群、会话故障转移、连接池等，以前属于应用程序服务器领域，现在也可以直接或通过某些第三方产品在 Web 服务器上使用。

最后，值得注意的是，像 Spring Framework 这样的“轻量级容器”进一步扭曲了画面，这些容器通常以更简单的方式补充应用程序服务器的目的，并且没有应用程序服务器基础设施。而且由于应用程序中的分布方面正在从分布式组件转向服务范式和 SOA 架构，因此留给传统应用程序服务器的空间越来越少。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-06-01T19:00:40.327

简而言之，
[Web 服务器](http://en.wikipedia.org/wiki/Web_server)是通过 HTTP 请求为用户提供*静态网页的服务器。*
[应用程序服务器](http://en.wikipedia.org/wiki/Application_server)是托管系统业务逻辑的服务器。
它通常同时托管长时间运行的/批处理进程和/或不适合人类消费的互操作服务（REST/JSON 服务、SOAP、RPC 等）。

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2018-03-05T21:30:13.793

Web 服务器和应用程序服务器之间的主要区别在于，Web 服务器旨在为静态页面提供服务，例如 HTML 和 CSS，而应用程序服务器负责通过执行服务器端代码（例如 JSP、Servlet 或 EJB）来生成动态内容。

**我应该使用哪一个？**
一旦您了解了 Web 和应用程序服务器以及 Web 容器之间的区别，就很容易弄清楚何时使用它们。`web server`如果您提供静态网页，则需要类似 Apache HTTPD。如果您的 Java 应用程序只有 JSP 和 Servlet 来生成动态内容，那么您需要`web containers`Tomcat 或 Jetty。同时，**如果您有使用 EJB、分布式事务、消息传递和其他花哨功能的 Java EE 应用程序，那么**`application server`您需要像 JBoss、WebSphere 或 Oracle 的 WebLogic 这样的完整功能。

Web 容器是 Web Server 的一部分，Web Server 是 Application Server 的一部分。

[![应用服务器](https://i.stack.imgur.com/vdVTy.png)](https://i.stack.imgur.com/vdVTy.png)

Web Server 由 Web 容器组成，而 Application Server 由 Web 容器和 EJB 容器组成。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2011-12-19T14:02:12.703

Web 服务器专门处理 HTTP/HTTPS 请求。它使用 HTTP/HTTPS 协议向 Web 提供内容。

应用服务器通过任意数量的协议（可能包括 HTTP）为应用程序提供业务逻辑。应用程序可以像调用对象的方法一样使用这个逻辑。在大多数情况下，服务器通过组件 API 公开此业务逻辑，例如 Java EE（Java 平台，企业版）应用服务器上的 EJB（企业 JavaBean）组件模型。重点是Web服务器通过http协议暴露一切，而应用服务器不限于此。因此，应用服务器提供的服务比 Web 服务器多得多，后者通常包括：

*   A（专有或非专有）API
*   负载均衡、故障转移...
*   对象生命周期管理
*   状态管理（会话）
*   资源管理（例如到数据库的连接池）

大多数应用服务器都将 Web Server 作为其不可或缺的一部分，这意味着 App Server 可以做任何 Web Server 能够做的事情。此外，App Server 具有支持应用程序级服务的组件和功能，例如连接池、对象池、事务支持、消息传递服务等。

应用程序服务器可以（但不总是）在 Web 服务器上运行以执行程序逻辑，然后由 Web 服务器传递其结果。这是 Web 服务器/应用程序服务器场景的一个示例。Microsoft 世界中的一个很好的例子是 Internet Information Server / SharePoint Server 关系。IIS 是一个网络服务器；SharePoint 是一个应用程序服务器。SharePoint 位于 IIS 的“顶部”，执行特定的逻辑，并通过 IIS 提供结果。例如，在 Java 世界中，Apache 和 Tomcat 也有类似的情况。

由于 web 服务器非常适合静态内容和动态内容的应用程序服务器，因此大多数生产环境都将 web 服务器用作应用程序服务器的反向代理。这意味着在为页面请求提供服务时，图像/静态 html 等静态内容由解释请求的 Web 服务器提供。Web 服务器使用某种过滤技术（主要是请求资源的扩展）识别动态内容请求并透明地转发到应用服务器。

此类配置的示例是 Apache HTTP Server 和 BEA WebLogic Server。Apache HTTP 服务器是 Web 服务器，BEA WebLogic 是应用程序服务器。在某些情况下，服务器紧密集成，例如 IIS 和 .NET 运行时。IIS 是网络服务器。当配备 .NET 运行时环境时，IIS 能够提供应用程序服务

* * *

```
Web Server                               Programming Environment
Apache                                   PHP, CGI
IIS (Internet Information Server)        ASP (.NET)
Tomcat                                   Servlet
Jetty                                    Servlet

Application Server                       Programming Environment
WAS (IBM's WebSphere Application Server) EJB
WebLogic Application Server (Oracle's)   EJB
JBoss AS                                 EJB
MTS                                      COM+ 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2014-08-17T09:02:07.590

这两者之间的界限越来越细。

应用程序服务器向客户端公开业务逻辑。这意味着应用程序服务器由一组方法组成（尽管不完全是，甚至可以是允许许多人在其上运行软件的联网计算机）来执行业务逻辑。所以它只会输出想要的结果，而不是 HTML 内容。（类似于方法调用）。所以它不是严格基于 HTTP 的。

但是 Web 服务器将 HTML 内容传递给 Web 浏览器（严格基于 HTTP）。Web 服务器只能处理静态 Web 资源，但服务器端脚本的出现允许 Web 服务器也可以处理动态内容。Web 服务器接收请求并将其定向到相关脚本（PHP、JSP、CGI 脚本等）以创建要发送到客户端的 HTML 内容。收到内容后，Web 服务器会将 HTML 页面发送给客户端。

但是，现在这两个服务器一起使用。Web 服务器接受请求，然后调用脚本来创建 HTML 内容。然后，该脚本将再次调用应用服务器LOGIC（例如检索交易细节）来填充HTML 内容。

所以这两个服务器都被有效地使用了。

因此....我们可以肯定地说，如今，在大多数情况下，Web 服务器被用作应用程序服务器的子集。但在戏剧上并非如此。

我已经阅读了很多关于这个主题的文章，发现[这篇](http://www.javaworld.com/article/2077354/learn-java/app-server-web-server-what-s-the-difference.html)文章非常方便。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2009-11-08T17:39:48.743

在 Java 术语中，还有一个：**Web 容器**（或更严格地说，是 servlet 容器）。例如，它位于 Web 服务器和应用程序服务器之间。

Java 术语中的 Web 容器是一种应用服务器，基本上*只*实现了 Java EE 的 JSP/Servlet 部分，缺少 Java EE 的几个核心部分，例如 EJB 支持。一个例子是 Apache Tomcat。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2009-06-01T19:00:08.627

应用程序服务器通常被设计和部署以促进运行时间更长的进程，这些进程也将更加资源密集。

Web 服务器通常用于资源密集型的短时间突发。这主要是为了方便提供基于 Web 的流量。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2009-06-01T19:04:57.417

Web 服务器运行 HTTP 协议来提供网页。应用程序服务器可以（但不总是）在 Web 服务器上运行以执行程序逻辑，然后由 Web 服务器传递其结果。这是 Web 服务器/应用程序服务器场景的一个示例。

Microsoft 世界中的一个很好的例子是 Internet Information Server / SharePoint Server 关系。IIS 是一个网络服务器；SharePoint 是一个应用程序服务器。SharePoint 位于 IIS 的“顶部”，执行特定的逻辑，并通过 IIS 提供结果。

例如，在 Java 世界中，Apache 和 Tomcat 也有类似的情况。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-06-01T19:04:23.597

应用程序服务器是一台机器（实际上是在某台机器上运行的可执行进程），它“侦听”（在任何通道上，使用任何协议），接收来自客户端对其提供的任何服务的请求，然后根据这些请求执行某些操作。（可能会或可能不会涉及对客户的回应）

Web 服务器是在一台机器上运行的进程，它使用“互联网”协议之一（http、https、ftp 等）专门在 TCP/IP 通道上“侦听”，并根据这些传入请求执行任何操作。 .. 通常，（如最初定义的那样），它获取/生成一个 html 网页并将其返回给客户端，或者从服务器上的静态 html 文件中获取，或者根据传入的客户端请求中的参数动态构建。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2009-10-31T17:46:21.150

首先，Web 服务器通过 HTTP 协议提供 Web 内容（HTML 和静态内容）。另一方面，应用服务器是一个容器，您可以在其上构建业务逻辑和流程，并通过各种协议（包括 n 层架构中的 HTTP）向客户端应用程序公开业务逻辑和流程。

因此，应用服务器提供的服务比 Web 服务器多得多，后者通常包括：

*   A（专有或非专有）API
*   对象生命周期管理，
*   状态管理（会话），
*   资源管理（例如到数据库的连接池），
*   负载均衡、故障转移...

AFAIK，[ATG Dynamo](http://www.atg.com/en/company/dynamo.jhtml)是 90 年代后期最早的应用服务器之一（根据上面的定义）。2000 年初，[ColdFusion](http://www.adobe.com/products/coldfusion) (CFML AS)、[BroadVision](http://www.broadvision.com/) (Server-side JavaScript AS) 等一些专有应用服务器占据了主导地位，但没有一个真正能够在 Java 应用服务器时代幸存下来。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2009-10-31T15:07:02.930

最大的区别是 Web 服务器处理 HTTP 请求，而应用程序服务器将在任意数量的协议上执行业务逻辑。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2019-05-28T07:15:46.560

基本理解：

**在客户端服务器架构中**

> 服务器 :> 为请求提供服务。
> 
> 客户 :> 哪个消耗服务。

Web 服务器和应用程序服务器都是充当客户端服务器的软件应用程序。

他们的名字是根据他们的使用地点来命名的。

```
Web server :> serve web content
           :> Like Html components
           :> Like Javascript components
           :> Other web components like images,resource files
           :> Supports mainly web protocols like http,https.
           :> Supports web Request & Response formats. 
```

> 用法 -
> 
> ```
>  we require low processing rates,
> 
>       regular processing practices involves. 
> ```
> 
> 例如：所有平面服务器通常都是现成的，仅提供基于 Web 的内容。

```
Application server :> Serve application content/component data(Business data).
                   :> These are special kind which are custom written 
                      designed/engineered for specific
                      purpose.some times fully unique in 
                      their way and stands out of the crowd. 

                   :> As these serves different types of data/response contents
                   :> So we can utilize these services for mobile client,web 
                      clients,intranet clients. 
                   :> Usually application servers are services offered on different 
                      protocols.    
                   :> Supports different Request& Response formats. 
```

> 用法 -
> 
> ```
>  we require multi point processing,
> 
>       specialized processing techniques involves like for AI. 
> ```
> 
> 例如：谷歌地图服务器、谷歌搜索服务器、谷歌文档服务器、微软 365 服务器、微软人工智能计算机视觉服务器。

我们可以将它们假设为 4 层/n 层架构中的层/层次结构。

```
 So they can provide 
                    load balancing,
                    multiple security levels,
                    multiple active points,
                    even they can provide different request processing environments. 
```

请点击此链接了解标准架构类比：

[https://docs.microsoft.com/en-us/previous-versions/msp-np/ee658120(v%3dpandp.10)](https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ee658120(v%3Dpandp.10))

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2012-02-16T05:16:30.100

实际上 Apache 是一个 Web 服务器，而 Tomcat 是一个应用程序服务器。当 HTTP 请求到达 Web 服务器时。然后静态内容通过网络服务器发送回浏览器。是否有逻辑要做，然后将该请求发送到应用程序服务器。处理完逻辑后，将响应发送到 Web 服务器并发送到客户端。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-12-21T14:58:31.310

以上所有只是使非常简单的事情过于复杂。应用程序服务器包含一个 Web 服务器，一个应用程序服务器比标准 Web 服务器具有更多的添加/扩展。如果以 TomEE 为例：

```
CDI - Apache OpenWebBeans
EJB - Apache OpenEJB
JPA - Apache OpenJPA
JSF - Apache MyFaces
JSP - Apache Tomcat
JSTL - Apache Tomcat
JTA - Apache Geronimo Transaction
Servlet - Apache Tomcat
Javamail - Apache Geronimo JavaMail
Bean Validation - Apache BVal 
```

您将看到 Tomcat（Web 容器/服务器）只是应用服务器库中的另一个工具。如果您愿意，您也可以在 Web 服务器中获取 JPA 和其他技术，但应用程序服务器只是为了您的方便而打包了所有这些东西。要完全归类为应用服务器，您基本上需要遵守某些标准规定的工具列表。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-10-31T15:12:24.027

不一定有明确的分界线。如今，许多程序结合了两者的元素 - 服务 http 请求（Web 服务器）和处理业务逻辑（应用程序服务器）

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2018-02-20T05:37:29.303

来自[https://en.wikipedia.org/wiki/Web_server](https://en.wikipedia.org/wiki/Web_server)

**Web 服务器**是一种通过 HTTP 处理请求的计算机系统，HTTP 是用于在万维网上分发信息的基本网络协议。该术语可以指整个系统，或者专门指**接受和监督 HTTP 请求**的软件。

来自[https://en.wikipedia.org/wiki/Application_server#Application_Server_definition](https://en.wikipedia.org/wiki/Application_server#Application_Server_definition)

**应用服务器在 Web 服务器**（例如 Apache 或 Microsoft Internet Information Services (IIS)）之后运行，并且（几乎总是）在 SQL 数据库（例如 PostgreSQL、MySQL 或 Oracle）之前运行。

**Web 应用程序是在应用程序服务器上运行并以应用程序服务器支持的语言编写并调用****应用程序服务器提供**的运行时库和组件的计算机代码。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-08-04T20:11:13.337

应用程序服务器和 Web 服务器都用于托管 Web 应用程序。Web Server 处理 Web 容器，而 Application Server 处理 Web 容器以及 Microsoft dot Net 的 EJB（Enterprise JavaBean）容器或 COM+ 容器。

Web Server 旨在提供 HTTP 静态内容，如 HTML、图像等，动态内容有插件支持 Perl、PHP、ASP、JSP 等脚本语言，并且仅限于 HTTP 协议。以下服务器可以生成动态 HTTP 内容。

**Web 服务器的编程环境：**

IIS：ASP（.NET）

Apache Tomcat：Servlet

码头：Servlet

阿帕奇：PHP，CGI

Application Server 可以做任何 Web Server 能够做的事情，并使用任何协议进行侦听，并且 App Server 具有支持应用程序级服务的组件和功能，例如连接池、对象池、事务支持、消息传递服务等。

**应用服务器的编程环境：**

MTS：COM+

是：EJB

JBoss：EJB

WebLogic 应用服务器：EJB

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2020-06-07T07:25:06.517

*   Web 服务器：对于每个 URL，它都会返回一个文件。这就是它所做的一切。该文件是**静态内容**，这意味着它*在您发出请求之前*存储在服务器中的某个位置。最流行的网络服务器是*apache http*和*nginx*。
*   应用服务器：对于每个 URL，它*运行一些代码，用某种语言编写*，生成响应并返回它。响应不预先存在，它是为您的特定请求生成的，即它是**动态内容**。每种语言的应用程序服务器都不同。一些流行的例子是java的*tomcat/jetty ，python 的**uwsgi/gunicorn*。

几乎您访问的每个页面都使用两者。静态内容（例如，图像、视频）由 Web 服务器提供，其余的（您与其他用户不同的部分）由应用程序服务器生成。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-10-31T15:17:07.817

虽然两者之间可能存在重叠（某些 Web 服务器甚至可以用作应用程序服务器），但恕我直言，最大的区别在于处理模型和会话管理：

在Web服务器处理模型中，重点是处理请求；“会话”的概念几乎是虚拟的。也就是说，“会话”是通过在客户端和服务器之间传输状态表示（因此是 REST）和/或将其序列化到外部持久存储（SQL Server、Memcached 等）来模拟的。

在应用程序服务器中，会话通常更明确，并且通常在“会话”的整个持续时间内以对象的形式存在于应用程序服务器的内存中。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-12-30T19:24:29.670

[IBM 在两者之间做了一个非常好的比较](https://www.ibm.com/cloud/learn/web-server-vs-application-server)：

> 根据严格的定义，Web 服务器是应用程序服务器的公共子集。
> 
> Web 服务器主要响应来自 Web 浏览器的超文本传输​​协议 (HTTP) 请求来提供静态 Web 内容，例如 HTML 页面、文件、图像、视频。
> 
> 应用程序服务器通常也可以交付 Web 内容，但它的主要工作是支持最终用户客户端和服务器端应用程序代码（表示通常称为*业务逻辑*的代码）之间的交互，以生成和交付动态内容，例如事务结果、决策支持或实时分析。应用程序服务器的客户端可以是应用程序自己的最终用户 UI、Web 浏览器或移动应用程序，并且客户端-服务器交互可以通过任意数量的通信协议进行。
> 
> 然而，在实践中，Web 服务器和应用程序服务器之间的界限变得更加模糊，特别是随着 Web 浏览器已成为首选的应用程序客户端以及用户对 Web 应用程序和 Web 应用程序性能的期望不断提高。
> 
> 大多数 Web 服务器支持脚本语言（例如 ASP、JSP、PHP、Perl）的插件，这些插件使 Web 服务器能够基于服务器端逻辑生成动态内容。越来越多的应用服务器不仅包含 Web 服务器功能，而且使用 HTTP 作为它们的主要协议并支持其他协议（例如，CGI 和 CGI​​ 变体）与 Web 服务器连接。它们还允许 Web 应用程序利用反向代理、集群、冗余和[负载平衡](https://www.ibm.com/cloud/learn/load-balancing)等服务——这些服务可以提高性能和可靠性，并允许开发人员减少对基础设施的关注，而更多地关注编码。
> 
> 为了使事情更加混乱，许多 Web 服务器和一些应用程序服务器被称为或称自己为*Web 应用程序服务器*。
> 
> 底线是当今最流行的 Web 服务器和应用程序服务器是两者的混合体。您今天使用的大多数日益丰富的应用程序都具有静态 Web 内容和动态应用程序内容的组合，通过 Web 服务器和应用程序服务器技术的组合交付。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2018-05-13T12:12:23.257

IMO，主要是关于分离关注点。

从纯技术的角度来看，您可以在单个 Web 服务器中完成所有事情（Web 内容 + 业务逻辑）。如果您这样做，那么信息将嵌入到请求的 HTML 内容中。会有什么影响？

例如，假设您有 2 个不同的应用程序，它们在浏览器上呈现完全不同的 HTML 内容。如果您将业务逻辑分离到一个应用程序服务器中，那么您可以提供不同的 Web 服务器通过脚本在应用程序服务器中查找相同的数据。但是，如果您不分离逻辑并将其保留在 Web 服务器中，那么无论何时更改您的业务模型，您最终都会在您拥有的每一个 Web 服务器中更改它，这将花费更多时间，更不可靠并且容易出错。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-10-31T15:08:13.093

这取决于具体的架构。一些应用服务器可能会原生使用 Web 协议（XML/RPC/SOAP over HTTP），因此技术上的差异很小。通常，Web 服务器是面向用户的，通过 HTTP/HTTPS 提供各种内容，而应用程序服务器不是面向用户的，可能使用非标准或不可路由的协议。当然，使用 RIA/AJAX 时，差异可能会更加模糊，仅向提供特定远程访问服务的客户端提供非 HTML 内容 (JSON/XML)。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-10-12T14:08:31.987

从上面令人敬畏的 SO 传播者的帖子中得出我的结论，我得出结论，两者都是驻留在实际金属服务器（物理服务器）上的软件。两者携手合作，为最终用户提供服务。然后，根据设置，我们可以选择如何调用它，这意味着如何描述它取决于实际使用的设置。如果它们都驻留在同一个裸机（物理服务器）上，我们称它为 Web 和应用程序服务器……很简单！如果在不同的机器上，显然，我们手上有两个不同的裸机（物理服务器）。然后我们可以根据它们的功能对这些服务器进行标记：一个 Web 服务器和另一个应用程序服务器。

[![Web 服务器与应用服务器](https://i.stack.imgur.com/lccsd.png)](https://i.stack.imgur.com/lccsd.png)

# php - 存储在 HABTM 关联中的项目的排序顺序 - CakePHP

> ID：936203
> 
> 赞同：3
> 
> 时间：2009-06-01T18:58:56.133
> 
> 标签：php, sql, mysql, activerecord, cakephp

在 ActiveRecord（CakePHP 风格）设置中，我在 Videos 和 Bins 上设置了 HasAndBelongsToMany 关联设置： Bin 可以存储对 Videos 的*n 个*引用，Videos 可以属于*n 个*Bins。

我需要能够手动设置和存储特定 Bin 中视频的显示顺序（以便客户可以在 Bin 中按特定顺序显示他的视频。）我最初的想法是在 Bin 中创建一个字段来存储按需要出现的顺序排列的视频 ID 数组。这是处理这个问题的最有效方法吗？

如果是这样，当我得到 HABTM 查询结果时，重新排序返回的查询以匹配已排序的 ID 数组的最干净/最有效的方法是什么？

与 Bin 关联的 Videos 作为数组返回：

```
[Video] => Array
            (
                [0] => Array
                    (
                        [id] => 49b2de95-0338-48b9-bc88-01ba35664358
                        ...

                    )

                [1] => Array
                    (
                        [id] => 49b1ccad-b770-410e-be46-03a035664358
                        ...
            ) 
```

或者有没有更好的方法可以在不使用 HABTM 关联的情况下实现我想要做的事情？

提前致谢 -

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T07:43:12.943

当HABTM变得复杂时该怎么办？

默认情况下，当保存 HasAndBelongsToMany 关系时，Cake 会在保存新行之前删除连接表上的所有行。例如，如果您有一个关联了 10 个孩子的俱乐部。然后，您使用 2 个孩子更新 Club。俱乐部只有 2 个孩子，而不是 12 个。

另请注意，如果您想向连接添加更多字段（创建时间或元信息），这可以通过 HABTM 连接表实现，但重要的是要了解您有一个简单的选项。

两个模型之间的 HasAndBelongsToMany 实际上是通过 hasMany 和 belongsTo 关联关联的三个模型的简写。

考虑这个例子：

```
Child hasAndBelongsToMany Club 
```

另一种看待这个问题的方法是添加一个会员模型

```
Child hasMany Membership
Membership belongsTo Child, 
ClubClub hasMany Membership. 
```

这两个例子几乎完全相同。他们在数据库中使用相同数量和命名的字段以及相同数量的模型。重要的区别是“join”模型的命名不同，它的行为更可预测。

在您的示例中，您需要一种在不编辑其他用户视频链接的情况下添加和删除的方法，因此标准 habtm 不太适合您。为这个“加入”创建一个类似于上述 Membership 模型的模型。此外，如果您添加了一个权重字段，您可以使用[有序行为](http://bakery.cakephp.org/articles/view/orderedbehavior-2-1)（我写的）对每个 bin 的每组视频进行排序。然后您将使用以下字段

```
id, bin_id, video_id, weight 
```

并在行为配置中将 bin_id 设置为“foreign_key”。祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T02:24:46.330

好吧，我试图解决这个问题，并认为我找到了最简单的解决方案：

保存相关模型的新顺序时，您删除现有关系并按所需顺序添加新关系。这意味着创建的 id 按您的排序顺序运行，您可以简单地按 id 排序以显示顺序。

```
public $hasAndBelongsToMany = array(
    'Item' => array(
        'order' => 'ItemFoldersItem.id ASC, Item.name DESC',
    )
); 
```

很简单不是吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:46:28.123

不知道实现您想要的“最有效”的方式，这取决于您的整个应用程序以及您想要完成的任务。我只想记住，最简单的解决方案通常是最好的。

但是，我可以给你一个排序视频数组的提示！这很容易：

```
$yourData = Set::sort($yourData, '/Video/id', 'asc'); 
```

查看[Set 类](http://api.cakephp.org/class/set)以获得更多糖果。:)

# php - 为什么 PHPUnit 坚持以 OO 的方式做事？

> ID：936204
> 
> 赞同：1
> 
> 时间：2009-06-01T18:59:04.463
> 
> 标签：php, oop, phpunit

冒着被激怒的风险......在上下文是隐式的上下文中，强制调用方法而不是函数有什么好处。

考虑到 PHP 的语法对于调用方法来说是如此丑陋，为什么 PHPUnit 的创建者会强制使用它呢？

如果框架设置了一个全局“currentTestCase”对象，然后将失败的断言与该对象透明地关联起来，我们可以编写：

```
assertEquals("blah", $text); 
```

与等价的相反，但冗长：

```
$this->assertEquals("blah", $text); 
```

在这种情况下使用 OO 到底能得到什么。

请赐教。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T20:35:23.427

因为 PHPUnit 是从 xUnit 派生的，而 xUnit 就是[这样](https://secure.wikimedia.org/wikipedia/en/wiki/XUnit)做的。

为什么 xUnit 会那样做？我很高兴你问。正如 Robert 指出的那样，最初的原因是 xUnit 来自 Smalltalk，并被 Java 中的 JUnit 推广。两者都是 OO-or-nothing 语言，所以他们别无选择。

这并不是说没有其他优势。OO 测试可以被继承。这意味着如果你想测试一个子类，你可以运行所有父类的测试，并为你改变的行为覆盖少数测试方法。这为您提供了出色的子类覆盖率，而无需复制测试代码。

它很容易在 PHPUnit 中添加和覆盖断言方法。只需子类`PHPUnit_Framework_TestCase`，编写您自己的`assert`方法并让您的测试类从您的新子类继承。您还可以编写默认值`setup`和`teardown`方法。

最后，它保证测试框架的方法不会与他们正在测试的东西发生冲突。如果测试框架只是将其功能转储到测试中，并且您想测试具有`setup`方法的东西……那么您就有麻烦了。

也就是说，我听到了你的痛苦。一个大的测试框架可能是烦人的、麻烦的和脆弱的。Perl 不使用 xUnit 样式，它使用带有简短测试函数名称的过程样式。有关示例，请参见[测试::更多。](http://search.cpan.org/perldoc?Test::More)在幕后它只是按照您的建议进行操作，有一个所有函数都使用的单例测试实例对象。还有一个混合过程断言函数与称为[Test::Class](http://search.cpan.org/perldoc?Test::Class)的 OO 测试方法模块，它做到了两全其美。

> 考虑到 PHP 的语法对于调用方法来说是如此丑陋

我猜你不喜欢`->`. 我建议你学会忍受它。OO PHP 比替代方案好得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:20:27.793

一个很好的理由是，`assertXXX`作为方法名称，命名冲突的风险很高。

另一个是它源自*xUnit*家族，该家族通常处理面向对象的语言——最初是 Smalltalk。这使您更容易将自己与来自例如 Java 和 Ruby 的“兄弟姐妹”联系起来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-07T11:39:05.940

不是直接的答案，但从 PHPUnit 3.5 开始，您不必再编写`$this->`了。PHPUnit 3.5 为断言添加了一个函数库，你必须包含它

```
require_once 'PHPUnit/Framework/Assert/Functions.php'; 
```

然后你可以做

```
assertEquals('foo', $bar); 
```

请参阅 Sebastian Bergmann 的博客文章

*   [http://sebastian-bergmann.de/archives/896-PHPUnit-3.5-Less-this-Required.html#content](http://sebastian-bergmann.de/archives/896-PHPUnit-3.5-Less-this-Required.html#content)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-07T05:23:16.000

将测试用例放在类方法中可以节省 PHPUnit 的工作量。由于缺乏内置智能，PHPUnit 无法找到或处理纯测试函数。只需识别 ->assert*() 消息 - 在一个简单的布尔链中 - 再次保存处理逻辑（对于 PHPUnit，而不是测试用例作者）。从 PHPUnit/SimpleTest 的角度来看，这都是节省开销的语法盐。

捕获错误/警告消息、异常或识别 PHP 原生的 assert() 语句都不是技术问题。它没有完成，因为一个困难的 API 看起来更企业化。

# c# - 如何在不平滑的情况下在 C# 中调整图像大小

> ID：936210
> 
> 赞同：0
> 
> 时间：2009-06-01T18:59:53.400
> 
> 标签：c#, .net, asp.net, optimization

如何在不影响平滑的情况下重新调整黑白图像的大小？我有一个条形码，它是一个太大的图像。我需要调整图像大小，但有一个警告。生成的图像需要具有相同的比例大小，并且黑白条不能变成黑色、灰色和白色条（我相信这是由于发生了一些平滑）。如何在 c# 中执行此操作的任何示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:08:04.493

@arul 是正确的。再具体一点，

```
graphics.SmoothingMode = SmoothingMode.None;
graphics.DrawImage( barCodeImage, new Point( 0, 0 ) ); 
```

您可能还想查看 InterpolationMode，以查看更改此值是否会使您的结果更接近您想要的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T19:01:56.767

您可以在底层[Graphics 对象中指定](http://msdn.microsoft.com/en-us/library/system.drawing.graphics(VS.71).aspx)[平滑模式](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.smoothingmode(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-21T20:34:48.893

你可能想要这样的东西：

```
e.Graphics.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.NearestNeighbor; 
```

# auto-increment - SQL Anywhere 自动增量重置

> ID：936214
> 
> 赞同：2
> 
> 时间：2009-06-01T19:00:41.683
> 
> 标签：auto-increment, sqlanywhere

我有一个 SQL Anywhere 9 数据库，我想将我的一个列上的自动增量值重置为特定数字。

我想我需要 SQL-Anywhere 相当于：

`ALTER TABLE foo AUTO_INCREMENT =100`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T00:10:43.507

就这样，答案实际上就在这里，而不仅仅是链接到：

使用`sa_reset_identity`系统过程：

```
sa_reset_identity (
  [ table_name
  [, owner
  [, new_identity_value ] ] ]
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:04:57.057

谷歌搜索出现了[这个](http://books.google.com.mt/books?id=Vf_EgfsFw-8C&pg=PA17&lpg=PA17&dq=SQL+Anywhere+reset+autoincrement&source=bl&ots=ptljEdQRdW&sig=CU7TN7DGbnd6ikjCK7c9epCIOMs&hl=mt&ei=lCUkSo_mL5aasgaw7LnEBg&sa=X&oi=book_result&ct=result&resnum=3)。我从来没有使用过 SQL Anywhere，所以恐怕我已经帮不上忙了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-28T16:40:00.557

正确的系统程序是`sa_reset_identity`

```
CALL sa_reset_identity('table_name', 'user_name', new_start_value -1); 
```

例如，您有一个名为**CITIES**的表，一个用户**DBA**，您希望自动增量从值**1**开始。您的代码将是：

```
CALL sa_reset_identity('cities', 'DBA', 0); 
```

**来源**：[http ://www.sqllines.com/sybase-asa/autoincrement_identity](http://www.sqlines.com/sybase-asa/autoincrement_identity)

# c++ - pthreads 编译但未创建二进制文件

> ID：936218
> 
> 赞同：1
> 
> 时间：2009-06-01T19:01:23.740
> 
> 标签：c++, linux, gcc, compilation, pthreads

我正在尝试编译一个我用 C++ 编写的程序，用于使用 pthread 的赋值。我在 Linux 中使用 Eclipse，在将“-lpthread”添加到编译器参数（到 g++、gcc 和链接器）之后，我没有任何编译问题。但是，当我要运行和调试时，Eclipse 给了我一个错误消息窗口“启动失败。找不到二进制文件。”

我尝试使用 gcc 和 g++ 手动编译它，后缀为 -pthread 和 -lpthread，结果类似 - “gcc: –pthread: No such file or directory”。

不知道出了什么问题，因为它确实可以毫无问题地编译，只是不会生成 exe。我相信我可能需要 apt-get 一些东西。

我应该做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T19:04:07.090

你是怎么编译的？这应该可以正常工作：

`gcc -o foo foo.c -lpthread`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T19:12:28.027

`g++ -pthread -ggdb -Wall -pedantic -o myexe *.cpp -lpthread`应该管用。

# asp.net - 如何实现类似于 Stack Overflow 上的“相关问题”功能？

> ID：936223
> 
> 赞同：1
> 
> 时间：2009-06-01T19:02:03.960
> 
> 标签：asp.net, jquery

我想实现一个类似于在 Stack Overflow 上提问时显示的“相关问题”列表的功能。我喜欢填写标题时如何填充相关问题。

我正在使用 ASP.NET 和 jQuery。我该如何实现这样的事情？谁能指出例子？

我查看了提问页面的来源，没有看到任何 onblur 或 focus 调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:13:42.530

事实上，有一个电话。这段代码负责发送到服务器 ob 'blur' 的#title 输入元素的 GET 请求（它在页面的源代码中，靠近顶部）：

```
$().ready(function() {
    $("#title").blur(function() { QuestionSuggestions(); });
});

function QuestionSuggestions() {
    var s = $("#title").val();            
    if (s.length > 2) {
        document.title = s + " - Stack Overflow";
        $("#question-suggestions").load("/search/titles?like="
+ escape(s));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T19:18:18.810

我正在考虑实现类似的东西，虽然这可能不是你问题的答案，但这是我打算做的：

1.  当一个问题被保存时，解析它并创建一个主题词到唯一ID（帖子的）映射并保存在按词索引的数据库中。
2.  当输入一个新问题并且焦点不在标题上时，使用数据库中的所有相关单词进行 AJAX 调用并匹配所有常见的相似 id（以便至少两个单词具有相同的 id）
3.  填充动态可见的 div。

我很想知道是否有人对此有更深入的了解...

# ruby-on-rails - 如何开始使用 Ruby？如何使用 Ruby？它是什么著名的？DSL 将如何发挥作用？

> ID：936226
> 
> 赞同：0
> 
> 时间：2009-06-01T19:02:59.947
> 
> 标签：ruby-on-rails, ruby, dsl, ironruby

有哪些很棒的学习资源？我用 Ruby 解决了什么样的问题？在 Rails 上学习 Ruby 和 Ruby 一样吗？如果我目前的背景是 Visual Studio 和 microsoft.net 框架，IronRuby 对我来说是最好的方式吗？

问题多多，求指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T19:14:01.237

Ruby on Rails 是一个围绕 ruby​​ 的应用程序框架。

好像说是“Asp.Net MVC”跟学C#一样？

Ruby 是为框架提供动力的语言，但现在许多人已经将其优点应用到其他框架中。

Ruby 是一门有趣的语言。IronRuby 将 Ruby 编译为 MSIL，就像 C#、VB.Net 等一样。所以它是实现 Ruby 的良好开端，因为它将 Ruby 映射为能够在 CLR 中使用。

但如果你想学习语言本身，这里有一种很好（有趣）的方法来获得基础知识：http: [//tryruby.hobix.com/](http://tryruby.hobix.com/)

[更多关于 Ruby 的 Wiki](http://en.wikipedia.org/wiki/Ruby_(programming_language))

有史以来最有趣和最有创意的语言介绍： [Ruby 的Why's (Poignant) Guide](http://poignantguide.net/ruby/chapter-1.html)

至于铁红宝石。这里有更多信息： [Going Ruby: Straight to IronRuby？](https://stackoverflow.com/questions/69443/going-ruby-straight-to-ironruby)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T19:14:50.890

*什么样的问题？*

几乎可以接受动态语言性能的任何东西。它是通用的（如 Java、Python、C++ 等），因此您可以将它用于大多数任何类型的应用程序。

*学习 ROR 和学习 Ruby 一样吗？*

不是。Ruby on Rails 是一组扩展，可让 Ruby 擅长 Web 应用程序开发。要回答您提出的另一个问题，这可能是 Ruby 最出名的地方。它在 Ruby on Rails 中使用，并为 Web 开发人员提供了易于开发的功能。

*DSL 有什么用？*

它很有用，因为它是“特定于域的”。这就是 DSL 中的 DS 所代表的含义。您正在使用适合您正在处理的特定问题领域的结构创建一种语言。用于街机游戏开发的 DSL 可能包含该语言的一部分，以便轻松为多个事物制作动画并启动它们并做出反应到他们之间的碰撞。而用于会计的 DSL 可能具有添加整组数字并将它们与其他组进行比较的功能。

*丰富的学习资源？*

我偏爱视频学习，所以我的选择是[Railscasts.com](http://railscasts.com/)和[PeepCode.com](http://peepcode.com/)。

# xpath - 我可以使用 nokogiri 获取 html 元素吗？

> ID：936232
> 
> 赞同：1
> 
> 时间：2009-06-01T19:04:51.083
> 
> 标签：xpath, nokogiri, elements

我对 nokogiri 有疑问，我需要从页面中获取 HTML 元素，并获取每个元素的 xpath。问题是我无法意识到如何使用 nokogiri 来做到这一点。HTML 代码是随机的，因为我必须解析来自不同网站的多个页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T02:42:24.483

如果您询问如何搜索节点，您可以使用 CSS 或 XPath 表达式，如下所示：

```
require 'rubygems'
require 'nokogiri'
require 'open-uri'

doc = Nokogiri::HTML(open("http://slashdot.com/"))

node_found_by_css = doc.css("h1").first
node_found_by_xpath = doc.xpath("/html/body//h1").first 
```

如果您要问如何，一旦您找到一个节点，您可以检索它的规范 XPath 表达式，您可以`Node#path`像这样使用：

```
puts node_found_by_css.path # => "/html/body/div[3]/div[1]/div[1]/h1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-03T13:52:41.503

如果您询问如何获取页面中每个 HTML 元素的 XPath，那么以下内容应该会有所帮助。这将打开并解析一个页面，然后打印出每个元素的 XPath。

```
require 'rubygems'
require 'nokogiri'
require 'open-uri'

doc = Nokogiri::HTML(open("http://slashdot.com/"))
doc.traverse {|node| puts node.path } 
```

# javascript - 我可以告诉任何有关在 JavaScript 中单击的超链接的信息吗？

> ID：936241
> 
> 赞同：0
> 
> 时间：2009-06-01T19:07:21.047
> 
> 标签：javascript, html, javascript-events

如果我有这样的代码：

```
<script>
function determine()
{
    // ????
}
</script>

<a href="blah1" onclick="determine()">blah1</a>
<a href="blah2" onclick="determine()">blah2</a> 
```

在确定（）中有没有办法查看点击了哪个链接？

（是的，我知道，简单而正确的做法是将“this”传递给确定（）......但在这种情况下，由于遗留代码问题，这并不容易。）

**编辑：**我可能应该在一开始就提到这一点......我们的网站目前没有使用（并且暂时不能使用）JQuery......所以JQuery的答案（虽然对于这类问题通常很有价值）不会' t 实际上帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T19:15:26.613

从 quirksmode查看此[链接。](http://www.quirksmode.org/js/events_properties.html)您可以获得事件目标。

```
function doSomething(e) {
    var targ;
    if (!e) var e = window.event;
    if (e.target) targ = e.target;
    else if (e.srcElement) targ = e.srcElement;
    if (targ.nodeType == 3) // defeat Safari bug
        targ = targ.parentNode;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T19:16:56.440

你可以直接使用 JavaScript，但我更喜欢使用 jQuery 之类的东西：

```
<a href="blah1">blah1</a>

<script type="text/javascript">
  $('a[href=blah1]').click(function() {
    var link = $(this); // here's your link.
    return false; // acts like the link was not clicked. return true to carry out the click.
  });
</script> 
```

假设您正在使用该`$().click()`功能，`$(this)`将为您提供链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T19:44:56.883

如果您无法更改 HTML 中的 onclick="determine()"，但可以更改 determine() 函数，那么我认为您最好的选择是：

将determine() 函数留空，这样它就不会做任何事情。

使用javascript（如其他答案所述）为每个链接添加一个真正的点击处理程序，并使用该事件来确定点击了哪个链接，然后执行所需的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T19:15:56.990

您可以像这样向每个链接添加事件

```
links = document.getElementsByTagName('a');

for (link in links) {

   link.onclick = function() {
      alert(this.id);
      determine(); // or some other important code?
   }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T19:51:14.780

另一种解决方案：

将 onclick 处理程序添加到文档。当用户单击链接时，单击事件将“冒泡”到窗口，您将有权访问该事件以确定单击了哪个链接。

如果您只想为那些已经具有 onclick="determine()" 的链接运行代码，这可能很有用 - 您可以设置 determine() 函数来设置一个变量。然后，当用户单击链接时，determine() 函数运行以设置变量，当文档单击处理程序运行时，您可以检查变量 - 然后您将知道链接具有 onclick="determine()"。

让我知道我是否可以让你更复杂一点...... :-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T20:07:30.863

如果您无法更改`onclick`属性，请通过 JavaScript 对其进行修补：

```
// use a DOMContentLoaded hack or `onload` as fallback
onload = function() {
    var links = document.links;
    for(var i = 0; i < links.length; ++i) {
        // there might be a better way to check which links to modify
        // don't know without further details
        if(/determine\(\)/.test(links[i].onclick))
            links[i].onclick = determine;
    }
};

function determine() {
    // the link is now available as `this`
    alert(this.href);
} 
```

也许更好的解决方案是`event`为符合标准的浏览器修补一个全局的 IE 样式对象：

```
if(document.addEventListener) {
    document.addEventListener('click', function(e) {
        window.event = e;
    }, true);
}

function determine() {
    var src = event.target || event.srcElement;
    alert(src.href);
} 
```

# php - PHP：如何确定循环的每 N 次迭代？

> ID：936242
> 
> 赞同：62
> 
> 时间：2009-06-01T19:07:26.443
> 
> 标签：php, html, loops

我想通过 XML 每隔 3 个帖子回显一个图像，这是我的代码：

```
<?php
// URL of the XML feed.
$feed = 'test.xml';
// How many items do we want to display?
//$display = 3;
// Check our XML file exists
if(!file_exists($feed)) {
  die('The XML file could not be found!');
}
// First, open the XML file.
$xml = simplexml_load_file($feed);
// Set the counter for counting how many items we've displayed.
$counter = 0;
// Start the loop to display each item.
foreach($xml->post as $post) {
  echo ' 
  <div style="float:left; width: 180px; margin-top:20px; margin-bottom:10px;">
 image file</a> <div class="design-sample-txt">'. $post->author.'</div></div>
';

  // Increase the counter by one.
  $counter++;
  // Check to display all the items we want to.
  if($counter >= 3) {
    echo 'image file';
    }
  //if($counter == $display) {
    // Yes. End the loop.
   // break;
  //}
  // No. Continue.
}
?> 
```

这是一个示例，前 3 个是正确的，但现在它不会循环 idgc.ca/web-design-samples-testing.php

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-06-01T19:13:26.650

最简单的方法是使用模除法运算符。

```
if ($counter % 3 == 0) {
   echo 'image file';
} 
```

这是如何工作的：模除法返回余数。当您处于偶数倍时，余数始终等于 0。

有一个问题：`0 % 3`等于 0。如果您的计数器从 0 开始，这可能会导致意外结果。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-09-12T20:28:08.810

离开@Powerlord的回答，

> “有一个问题：0 % 3 等于 0。如果您的计数器从 0 开始，这可能会导致意外结果。”

您仍然可以从 0 开始您的计数器（数组、查询），但要偏移它

```
if (($counter + 1) % 3 == 0) {
  echo 'image file';
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-01T19:11:55.077

[使用 PHP 手册中的](http://uk3.php.net/manual/en/language.operators.arithmetic.php)模算术运算。

例如

```
$x = 3;

for($i=0; $i<10; $i++)
{
    if($i % $x == 0)
    {
        // display image
    }
} 
```

如需更详细地了解模数计算，请单击[此处](http://en.wikipedia.org/wiki/Modulo)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T19:14:01.267

每3个帖子？

```
if($counter % 3 == 0){
    echo IMAGE;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-28T00:22:15.573

您也可以在没有模数的情况下执行此操作。只需在匹配时重置您的计数器。

```
if($counter == 2) { // matches every 3 iterations
   echo 'image-file';
   $counter = 0; 
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-01T19:13:50.067

怎么样： if(($counter % $display) == 0)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-18T23:23:00.870

我正在使用此状态更新来每 1000 次迭代显示一个“+”字符，它似乎运行良好。

```
if ($ucounter % 1000 == 0) { echo '+'; } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-02T10:43:30.653

它不适用于第一位置，因此更好的解决方案是：

```
if ($counter != 0 && $counter % 3 == 0) {
   echo 'image file';
} 
```

自己检查一下。我已经测试了它为每个第 4 个元素添加类。

# postgresql - 编写查询以在 PostgreSQL 中插入 varbinary 值

> ID：936248
> 
> 赞同：2
> 
> 时间：2009-06-01T19:08:06.817
> 
> 标签：postgresql, insert, varbinary

PostgreSQL 中插入`varbinary`值的语法是什么？

SQL Server 的语法使用了类似的常量`0xFFFF`，但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:44:15.700

鉴于 Postgres 中没有“varbinary”数据类型，我相信您的意思是“bytea”。查看有关指定“bytea”文字的方式的[文档。](http://www.postgresql.org/docs/current/static/datatype-binary.html)

根据您使用的语言和绑定，可能会有更复杂的方式来传输二进制数据 - 您可以[在此处](http://npgsql.projects.postgresql.org/docs/manual/UserManual.html)找到一个 .Net/C#/Npgsql 示例（在“使用二进制数据和 bytea 数据类型”下）。

# git - 如何停止跟踪并忽略 Git 中文件的更改？

> ID：936249
> 
> 赞同：1961
> 
> 时间：2009-06-01T19:08:16.037
> 
> 标签：git

我克隆了一个包含一些`.csproj`文件的项目。我不需要/喜欢我的本地`csproj`文件被 Git 跟踪（或在创建补丁时被调出），但显然项目中需要它们。

我已添加`*.csproj`到我的 LOCAL`.gitignore`中，但文件已经在 repo 中。

当我输入 git status 时，它会显示我`csproj`对跟踪或提交补丁不感兴趣的更改。

如何从我的个人存储库中删除这些文件的“跟踪”（但将它们保留在源中以便我可以使用它们），以便在我执行状态（或创建补丁）时看不到更改？

是否有正确/规范的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：2348
> 
> 时间：2009-06-01T19:16:19.810

只需调用`git rm --cached`要从修订控制中删除的每个文件就可以了。只要您的本地忽略模式是正确的，您就不会在 git status 的输出中看到这些文件。

请注意，此解决方案会从存储库中删除文件，因此所有开发人员都需要维护自己的本地（非修订控制）文件副本

为了防止 git 检测到这些文件中的更改，您还应该使用以下命令：

```
git update-index --assume-unchanged [path] 
```

**您可能想要做什么：（**来自[@Ryan Taylor 的回答](https://stackoverflow.com/a/40272289/716435)）

> 3.  这是告诉 git 你想要你自己的独立版本的文件或文件夹。例如，您不想覆盖（或删除）生产/暂存配置文件。
> 
> `git update-index --skip-worktree <path-name>`

完整的答案在这个 URL 中：http: [//source.kohlerville.com/2009/02/untrack-files-in-git/](http://source.kohlerville.com/2009/02/untrack-files-in-git/)

* * *

## 回答 #2

> 赞同：386
> 
> 时间：2016-10-26T21:18:11.993

### 有3个选项；你可能想要#3

1.  这将为您保留本地文件，但会在其他任何人拉取时将其删除。

    `git rm --cached <file-name>`或者`git rm -r --cached <folder-name>`

2.  这是为了优化，就像一个包含大量文件的文件夹，例如可能永远不会改变的 SDK。它告诉 Git 每次都停止在本地检查那个巨大的文件夹是否有变化，因为它不会有任何变化。`assume-unchanged`如果文件/文件夹有上游更改（当您拉取时），索引将被重置并覆盖文件。

    ```
    git update-index --assume-unchanged <path-name> 
    ```

3.  这是告诉 Git 你想要你*自己的独立版本*的文件或文件夹。例如，您不想覆盖（或删除）生产/暂存配置文件。

    ```
    git update-index --skip-worktree <path-name> 
    ```

    重要的是要知道它`git update-index` **不会**随 Git 传播，因此每个用户都必须独立运行它。

* * *

## 回答 #3

> 赞同：257
> 
> 时间：2009-06-01T19:24:13.570

如果你这样做`git update-index --assume-unchanged file.csproj`了，git 不会自动检查 file.csproj 的更改：这将阻止它们在你更改它们时以 git 状态出现。因此，您可以通过这种方式标记所有 .csproj 文件——尽管您必须手动标记上游存储库发送给您的任何新文件。（如果您在`.gitignore`or中有它们`.git/info/exclude`，那么您创建的将被忽略）

我不完全确定 .csproj 文件是什么......如果它们与 IDE 配置类似（类似于 Eclipse 的 .eclipse 和 .classpath 文件），那么我建议它们永远不应该在源代码控制全部。另一方面，如果它们是构建系统的一部分（如 Makefiles），那么显然它们应该——并且一种获取可选本地更改的方法（例如从 local.csproj 和 la config.mk）将很有用：将构建分为全局部分和局部覆盖。

* * *

## 回答 #4

> 赞同：159
> 
> 时间：2011-08-02T14:25:34.060

这是一个两步过程：

1.  删除文件/文件夹的跟踪 - 但将它们保留在磁盘上 - 使用

    ```
    git rm --cached 
    ```

    现在它们没有显示为“已更改”，但仍显示为

    ```
     untracked files in  git status -u 
    ```

2.  将它们添加到`.gitignore`

* * *

## 回答 #5

> 赞同：109
> 
> 时间：2014-09-18T05:44:44.077

接受的答案仍然对我不起作用

我用了

> git rm -r --cached 。
> 
> 混帐添加。
> 
> git commit -m "修复.gitignore"

[从这里](http://www.randallkent.com/development/gitignore-not-working)找到答案

* * *

## 回答 #6

> 赞同：52
> 
> 时间：2015-11-04T10:25:03.193

# 忘记了 .gitignore？

如果您在本地拥有整个项目但忘记添加 git ignore 并且现在正在跟踪一些不必要的文件，请使用此命令删除所有内容

```
git rm --cached -r . 
```

确保您位于项目的根目录。

然后你可以照常做

## 添加

```
git add . 
```

## 犯罪

```
git commit -m 'removed all and added with git ignore' 
```

## 推

```
git push origin master 
```

## 结论

希望这可以帮助那些不得不对其进行更改`.gitignore`或将其全部忘记的人。

*   它删除了整个缓存
*   查看您的 .gitignore
*   添加要跟踪的文件
*   推送到您的仓库

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2015-05-12T11:33:44.787

正如其他答案中指出的那样，所选答案是错误的。

另一个问题的[答案](https://stackoverflow.com/a/13631525/487812)表明可能需要跳过工作树。

```
git update-index --skip-worktree <file> 
```

该[答案](https://stackoverflow.com/a/13631525/487812)链接到一篇文章 ( [http://fallengamer.livejournal.com/93321.html](http://fallengamer.livejournal.com/93321.html) ) 并引用了这篇文章，并对 --assume-unchanged 和 --skip-worktree 之间的区别进行了很好的总结，如下所示：

> **--assume-unchanged**假定开发人员不应该更改文件。此标志旨在提高 SDK 等不更改文件夹的性能。

> **--skip-worktree**当您指示 git 不要碰特定文件时很有用，因为开发人员应该更改它。例如，如果上游的主存储库托管了一些生产就绪的配置文件，并且您不想意外提交对这些文件的更改，那么 --skip-worktree 正是您想要的。

所有的功劳[归功于](https://stackoverflow.com/users/383402/borealid)他们的研究和回答。在这里包含此信息纯粹是为了方便他人。

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2017-04-18T09:41:40.150

防止通过 git 监控文件或路径

```
git update-index --assume-unchanged [file-path] 
```

并将其恢复使用

```
git update-index --no-assume-unchanged [file-path] 
```

参考类似用例的回购[https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)

* * *

## 回答 #9

> 赞同：25
> 
> 时间：2013-11-07T13:18:52.410

为了节省一些时间，您添加到 .gitignore 的规则可用于删除多个文件/文件夹，即

`git rm --cached app/**/*.xml`

或者

`git rm --cached -r app/widgets/yourfolder/`

ETC

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2018-02-20T10:02:49.920

很多人建议你使用`git update-index --assume-unchanged`. 事实上，这可能是一个很好的解决方案，但只是在短期内。

您可能想要做的是：`git update-index --skip-worktree`.

（您可能不想要的第三个选项是：`git rm --cached`。它将保留您的本地文件，但会被标记为从远程存储库中删除。）

**前两个选项之间的区别？**

*   `assume-unchanged`是临时允许您隐藏文件中的修改。如果你想隐藏对文件所做的修改，修改文件，然后签出另一个分支，你将不得不使用`no-assume-unchanged`然后可能隐藏修改完成。
*   `skip-worktree`无论您签出哪个分支，都将跟随您进行修改！

**用例`assume-unchanged`**

它假定不应修改此文件，并在执行`git status`. 但是当签出到另一个分支时，您需要重置标志并在此之前提交或存储更改。如果您在激活此选项的情况下进行拉取，您将需要解决冲突并且 git 不会自动合并。它实际上只隐藏修改（`git status`不会显示标记的文件）。

当我只想暂时停止跟踪更改 + 提交与*同一*修改`git commit -a`相关的一堆文件 ()时，我喜欢使用它。

 ***用例`skip-worktree`**

您有一个设置类，其中包含您的朋友必须根据他们的设置相应地更改的参数（例如，包括密码）。

*   1：创建此类的第一个版本，填写您可以填写的字段并将其他字段留空/null。
*   2：提交并推送到远程服务器。
*   3：`git update-index --skip-worktree MySetupClass.java`
*   4：用你自己的参数更新你的配置类。
*   5：回去工作另一个功能。

无论分支如何，您所做的修改都将跟随您。警告：如果你的朋友也想修改这个类，他们必须有相同的设置，否则他们的修改会被推送到远程仓库。拉动时，文件的远程版本应覆盖您的文件。

*PS：做一个或另一个，但不要同时做，因为你会有不良的副作用。如果你想尝试另一个标志，你应该先禁用后者。*

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2018-06-12T22:10:25.720

要告诉 Git 不要跟踪对本地文件/文件夹的更改（意味着 git status 不会检测到对它的更改），请执行以下操作：

```
git update-index --skip-worktree path/to/file 
```

并告诉 Git 再次跟踪对本地版本的更改（以便您可以提交更改），请执行以下操作：

```
git update-index --no-skip-worktree path/to/file 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-10-02T20:26:29.207

## 将 .gitignore 应用于现在/未来

> 此方法应用标准的 .gitignore 行为，**不需要手动指定需要忽略的文件**。
> 
> 不能再使用`--exclude-from=.gitignore`了：/ - 这是更新的方法：
> 
> 一般建议：**从一个干净的 repo 开始**——所有内容都已提交，工作目录或索引中没有任何待处理的内容，**并进行备份**！

```
#commit up-to-date .gitignore (if not already existing)
#this command must be run on each branch
git add .gitignore
git commit -m "Create .gitignore"

#apply standard git ignore behavior only to current index, not working directory (--cached)
#if this command returns nothing, ensure /.git/info/exclude AND/OR .gitignore exist
#this command must be run on each branch
git ls-files -z --ignored --exclude-standard | xargs -0 git rm --cached

#optionally add anything to the index that was previously ignored but now shouldn't be:
git add *

#commit again
#optionally use the --amend flag to merge this commit with the previous one instead of creating 2 commits.

git commit -m "re-applied modified .gitignore"

#other devs who pull after this commit is pushed will see the  newly-.gitignored files DELETED 
```

如果您还需要从分支的提交历史记录中清除新忽略的文件，**或者如果您不希望从未来的 pulls 中删除新忽略的文件**，请参阅[此答案](https://stackoverflow.com/a/57454176/423125)。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-09-11T17:08:10.577

一行答案 `git update-index --assume-unchanged [path]`

只要您有一个位于中央仓库和本地仓库中的文件，就可以使用它。您需要在该文件中进行更改，但不得暂存/提交到中央仓库。此文件不应添加到`.gitignore`. 因为如果系统管理员引入文件中的新更改，高级开发人员需要分布在所有本地存储库中。

最佳示例：**数据库连接的配置文件**。在中央存储库中，您将拥有所有用户名、密码、主机、端口以及生产数据库服务器的值。但是在本地开发中，您应该只使用本地或任何其他开发数据库服务器（您的团队已经设置）。在这种情况下，您想在配置文件中进行更改，但不应该提交到中央仓库。

最好的

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-08-09T21:06:03.343

`git rm --fileName`

`git ls-files`确保文件被删除或未跟踪

`git commit -m "UntrackChanges"`

`git push`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-04-06T13:47:02.553

我假设您询问如何删除特定文件夹或 bin 文件夹中的**所有文件，而不是单独选择每个文件。**

您可以使用此命令：

`git rm -r -f /<floder-name>\*`

确保您位于该目录的父目录中。
该命令将递归地“删除” bin/ 或 build/ 文件夹中的所有文件。删除这个词我的意思是 git 会假装这些文件被“删除”并且这些文件不会被跟踪。git 确实将这些文件标记为处于删除模式。

请确保您的 .gitignore 已为即将到来的提交做好准备。
[文档：git rm](http://git-scm.com/docs/git-rm)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-03-24T17:05:36.620

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-04-04T17:04:12.653

我假设您正在尝试从 git tacking 中删除单个文件。为此，我建议使用以下命令。

git update-index --assume-unchanged

前 - git update-index --assume-unchanged .gitignore .idea/compiler.xml

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-05-26T00:05:11.433

要忽略对目录中所有文件（特定类型）的任何更改，我必须结合其中一些方法，否则如果文件以前不存在，则会创建这些文件。

在下面，“excludedir”是我不希望看到更改的目录的名称。

首先，从更改跟踪缓存中删除任何现有的新文件（不从文件系统中删除）。

```
git status | grep "new file:" | cut  --complement -d " " -f1-4 | grep "^excludedir" | xargs git rm --cache 
```

您可以对`modified:`. `renamed:`有点复杂，因为您必须查看`->`新文件名的 post 位，并按照下面的说明执行 pre`->`位`deleted:`。

`deleted:`文件证明有点复杂，因为您似乎无法为本地系统上不存在的文件更新索引

```
echo .deletedfiles >> .gitignore
git status | grep "deleted:" | cut  --complement -d " " -f1-4 | grep "^excludedir" > .deletedfiles
cat .deletedfiles | xargs -d '\n' touch
cat .deletedfiles | xargs -d '\n' git add -f
cat .deletedfiles | xargs -d '\n' git update-index --assume-unchanged
cat .deletedfiles | xargs -d '\n' rm 
```

上面列表中的最后一个命令将再次从文件系统中删除文件，因此请随意省略它。

然后，阻止该目录的更改跟踪

```
git ls-files excludedir/ | xargs git update-index --skip-worktree
git update index --skip-worktree excludedir/ 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-12-24T15:06:57.690

在这个[答案](https://stackoverflow.com/a/10177000/3393574)中给出了一种几乎**不需要 git 命令的方法**：

**要忽略****每个本地 repo**的某些文件：

1.  创建一个文件`~/.gitignore_global`，例如`touch ~/.gitignore_global`在您的终端中。
2.  跑`git config --global core.excludesfile ~/.gitignore_global`一次。
3.  将要忽略的文件/目录路径写入`~/.gitignore_global`. 例如`modules/*.H`，将假定它位于您的工作目录中，即`$WORK_DIR/modules/*.H`.

**要忽略****单个本地 repo 的**某些文件：

1.  对 repo中的文件执行上述第三步`.git/info/exclude`，即将要忽略的文件/目录路径写入`.git/info/exclude`. 例如`modules/*.C`，将假定它位于您的工作目录中，即`$WORK_DIR/modules/*.C`.

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2018-12-24T09:13:36.200

找了半天，想办法做到这一点。在 .like android studio 项目中别名一个 git 命令`.gitconfig`，在 checkout 分支之前还原配置文件然后跳过它，在 checkout 分支之后使用`sed`将配置文件更改为我的本地配置。 `checkoutandmodifylocalproperties = !git update-index --no-skip-worktree local.properties && git checkout local.properties && git checkout $1 && git update-index --skip-worktree local.properties && sed -i '' 's/.*sdk.dir.*/sdk.dir=\\/Users\\/run\\/Library\\/Android\\/sdk/g' local.properties && :`

# .net - 加密连接字符串以便其他开发人员无法解密，但应用程序仍然可以访问

> ID：936253
> 
> 赞同：1
> 
> 时间：2009-06-01T19:08:59.843
> 
> 标签：.net, encryption, connection-string

我有一个要通过 .NET Web 应用程序访问的数据库。我可以很容易地加密 web.config 中的连接字符串，但是任何有权访问该框的开发人员都可以使用几行代码对其进行解密 - 他们可以访问该框，因此可以访问存储在机器中的加密密钥。配置。

虽然我可以通过拒绝他们的用户帐户访问来将人们锁定在数据库之外，但网络应用程序拥有众所周知的王国钥匙并没有帮助。任何人都知道一种允许 Web 应用程序访问数据库的好方法，而无需精明的开发人员可以使用 Web 应用程序使用的 SQL 帐户吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T19:20:06.760

这是一个先有鸡还是先有蛋的问题。如果您的应用程序可以访问密钥（加密连接字符串的密钥），那么任何与您的应用程序具有相同权限的人也都拥有它。

管理此问题的最佳方法是根本没有秘密并且不在 SQL Server 连接字符串中使用登录名/密码，而是使用集成安全性 (SSPI)。这样，您的应用程序将使用其 Windows 凭据（代表您的应用程序运行的帐户）对数据库进行身份验证，而无需在线发送任何凭据（常规身份验证意味着每次打开时都会在应用程序和 db 之间传递登录名/密码）连接），您不必存储任何密码。您只需要确保运行帐户的密码不容易被猜到。在那之后，您就和帐户一样安全（这没什么好写的，但这比在进程之间传递凭据要好得多）。

请注意，使用相同凭据运行的任何内容（应用程序中的任何代码）也将使用服务帐户的权限运行。

您还应该将应用程序帐户在数据库上可以做的事情限制在它需要的最低限度（没有管理员/dbo）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T19:13:50.910

如果我知道程序如何加密数据，并且我知道密钥在哪里，那么我就可以解密数据。（“我” == 任何开发者）

保护密钥（Unix 权限、Windows ACL）可能会阻止其中的大多数，但总是可以在程序中添加一行，将密钥（或只是未加密的数据）转储到一个秘密的地方。（或者将加密命令更改为看起来相似的命令，实际上是简单的 XOR 或等效命令......）

总之，如果我可以控制源代码，我可以让程序做任何事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T19:25:55.330

您可能以错误的方式看待这个问题。

在高度安全的情况下，开发人员（就像其他人一样）不应该访问生产数据库。您可以使用防火墙或其他方式来实现这一点。

如果您像 Yann Schwartz 提到的那样使用 SSPI，则只有生产 Web 服务器可以访问数据库。如果这不可行，系统管理员应在部署时手动将（加密的）密码放入 web.config 文件中。

不言而喻（或至少应该），您应该有一个单独的数据库，并为开发/QA 提供不同的身份验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T19:21:32.873

尽管我认为如果您不能信任您的开发人员，您可能会遇到一系列完全不同的问题，但您可能需要查看[aspnet_setreg](http://support.microsoft.com/kb/329290)以查看它是否有帮助。

或者您可以只雇用不精通的开发人员。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-22T09:58:27.257

这里给出的答案并没有回答这个问题。

想要加密配置文件的值的原因有很多。例如确保盒子如果被破坏不会破坏数据库服务器盒子。

如果该数据库不是 sql server，例如 oracle 或 sybase，则上述解决方案将不起作用。

[Encrypting Web.Config Values in ASP.NET 2.0](http://weblogs.asp.net/scottgu/archive/2006/01/09/434893.aspx)中有很多链接可以解决这个问题：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T19:21:26.713

如果你真的相信你的开发人员在这个问题中提出了严重的安全风险，你应该立即解雇他们并雇佣你最终可以信任的开发人员。

不能信任数据库密钥的开发人员也不应该信任代码库。

**旁注**是什么让他们远离 DEL * 。* 在您的文件系统上？

# ruby-on-rails - Rails：如何将字符串表示保存回模型中？

> ID：936258
> 
> 赞同：1
> 
> 时间：2009-06-01T19:10:46.827
> 
> 标签：ruby-on-rails, string, select, object

我有一个`Employee`模型，它有一个`SecurityClearanceLevel`. 当您创建新员工时，系统会要求您`SecurityClearanceLevel`通过从`<select>`列表中选择来设置。问题是当我保存对象时，它是一个字符串，而不是 a `SecurityClearanceLevel`，所以保存失败。

我在哪里处理这种来回转换，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:32:32.290

Rails 为您提供了一些关于执行此操作的变体。你应该能够做这样的事情：

```
<%= collection_select(:employee, :security_clearance_level_id,
                      SecurityClearanceLevel.all, :id, :name) %> 
```

查看[关于 select 和 option 标签的 Rails 指南以](http://user_security_clearance)获取完整的详细信息。

# asp.net-mvc - asp.net mvc复选框不一致

> ID：936267
> 
> 赞同：6
> 
> 时间：2009-06-01T19:12:35.873
> 
> 标签：asp.net-mvc, checkbox

我在 ASP.NET MVC 表单上使用了一个复选框，如下所示：

```
<%=Html.CheckBox("AgreeToRules", Model.AgreeToRules)%> 
```

模型上的 AgreeToRules 属性是一个布尔值。在测试期间，这一切都很好。但是，既然我们已经使用此应用程序，我看到以下消息的错误数量相对较少但数量很大：

> System.Web.HttpUnhandledException：引发了“System.Web.HttpUnhandledException”类型的异常。---> System.InvalidOperationException：从类型“System.String”到类型“System.Boolean”的参数转换失败。有关更多信息，请参阅内部异常。---> System.FormatException: Y 不是布尔值的有效值。---> System.FormatException：字符串未被识别为有效的布尔值。

这似乎发生在视图引擎尝试在发布后呈现表单时，并且从 ValueProvider 返回的复选框的值如下所示：

> 是的，假的

或者

> N,假

以原始形式呈现的 html 如下所示：

```
<input id="AgreeToRules" name="AgreeToRules" type="checkbox" value="true" />
<input name="AgreeToRules" type="hidden" value="false" /> 
```

在测试期间，我预计（并显示）发布的值如下所示：

> 真假

如果检查或

> 错误的

如果没有检查。那么 N 和 Y 是从哪里来的呢？

我将用户代理添加到从错误处理程序返回的信息列表中，并且（到目前为止）似乎所有错误都发生在具有 FF 3.0.10 的 Windows XP 下，但这正是我测试过的，问题没有在测试过程中存在。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T22:06:30.893

我们在我正在处理的项目（MVC 2）中遇到了同样的问题。我们通过用纯 html 代码替换 helper 来解决它：

前： `<%= Html.CheckBox("Credit", false, new {@validate = "required"}) %>`

后：

```
<input type="checkbox" name="Credit" value="true" validate="required" />
<input type="hidden" name="Credit" value="false" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T00:56:25.100

今天我想出了一个类似问题的解决方案，也许可以适应您的特殊需求。它会按照您的要求“完成工作”，但可能不是最可重用的解决方案。

这个想法是您将浏览已发布的表单字段并修复“损坏的”复选框值。您可以创建一个 ValueProviderDictionary aka IDictionary<string, ValueProviderResult> 然后将其交给您的 UpdateModel 方法。

```
public static IDictionary<string, ValueProviderResult> CreateScrubbedValueProvider(NameValueCollection postedForm, string[] checkboxFieldsToScrub)
{
    Dictionary<string, ValueProviderResult> dict = new Dictionary<string, ValueProviderResult>();
    foreach (string key in postedForm.AllKeys) {
        string[] values = postedForm.GetValues(key);
        if (checkboxFieldsToScrub.Contains(key)) {
            // Ensure we have a "true" value instead of "Y" or "YES" or whatever...
            // Note that with a checkbox, only the first value matters, so we will only
            // worry about values[0] and not values[1] (the "unchecked" value, if exists).
            if (values[0] == "Y" || values[0] == "YES") {
                values[0] = "true";
            }
        }
        string value = String.Join(",", values);
        ValueProviderResult vpr = new ValueProviderResult(values, value, null);
        dict.Add(key, vpr);
    }
    return dict;
} 
```

您的控制器需要在其参数中接受 NameValueCollection（或 FormCollection），并且您需要将生成的（“已清理”）值提供程序字典交给 UpdateModel 方法。我还没有完全测试过这个，但我的这个版本对我来说非常相似。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T23:19:10.057

您的网站很可能被提交此值的垃圾邮件机器人攻击，而不是真实用户。我添加自动日志记录和电子邮件的站点越多，我看到的这些类型的“探测”和错误（虽然不完全是您提到的类型，复选框带有“Y”）就越多。您的日志记录是否还捕获其余提交的表单内容？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:36:14.053

好吧，我发现了问题，并认为我会在这里发布以防其他人遇到它。某些表单填充器将使用我使用过的名称检测字段，并尝试通过将值设置为用户先前用于类似名称字段的值来自动“填充它们”。从昨晚开始，我还收到了“未订阅”和“订阅”作为名为“OptIn”的复选框的值。

因此，表单填充器将复选框的值更改为某个值，并且用户选中了该框，导致意外的值被传输到服务器。

任何有关处理此问题的想法将不胜感激。

# asp.net - 使用 ICallbackEventHandler 处理多个请求

> ID：936268
> 
> 赞同：1
> 
> 时间：2009-06-01T19:12:36.777
> 
> 标签：asp.net, icallbackeventhandler

使用 ICallbackEventHandler 时，有什么方法可以向 asp.net 中的回调函数发出多个请求？我需要每个结果的结果，但是，当我遍历并调用函数时，我只得到最后一次调用的结果。有什么方法可以让它为每个调用返回一个结果？

这是我通过 javascript 传递的内容：

```
 function NoPostback() {
        $(".spans").each(function(index, item) {
            CallServer($(item).attr("myattr"));
        });
    } 
```

在此，myattr 是一个包含值 (1..10) 的自定义属性。我想要返回的是类似于 ('you said: ' + id) 为每个调用返回的东西，这样我就可以继续并将它们放在适当的持有者中。

但是，只返回一个项目，即最后一次调用。例如，如果有 4 个项目，它只返回 ('you said: 4')。

关于如何让他们全部归还的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:21:38.490

大多数 Javascript AJAX 框架要么中止任何正在进行的后续请求，要么忽略先前的请求并仅处理最新的请求。AJAX 请求本身将通过浏览器的 XmlHttpRequest 对象，但其余的 javascript 代码在页面线程中运行。目前，没有使用 javascript 的并发编程（但是这[将改变](http://www.whatwg.org/specs/web-workers/current-work/)。）

# wpf - 在 WPF 中对 TabControl 进行数据绑定时，如何使用自定义 TabItem 控件？

> ID：936269
> 
> 赞同：4
> 
> 时间：2009-06-01T19:12:44.547
> 
> 标签：wpf, .net-3.5, user-interface, styles, itemtemplate

我有一个从 派生的自定义控件`TabItem`，我想将该自定义数据绑定`TabItem`到股票`TabControl`。我宁愿避免`TabControl`为这种罕见的情况创建一个新的。

这就是我所拥有的，我没有任何运气来加载正确的控件。在这种情况下，我想使用我的`ClosableTabItem`控件而不是库存`TabItem`控件。

```
<TabControl x:Name="tabCases" IsSynchronizedWithCurrentItem="True" 
            Controls:ClosableTabItem.TabClose="TabClosed" >
    <TabControl.ItemTemplate>
        <DataTemplate DataType="{x:Type Controls:ClosableTabItem}" >
            <TextBlock Text="{Binding Path=Id}" />
        </DataTemplate>
    </TabControl.ItemTemplate>
    <TabControl.ContentTemplate>
        <DataTemplate DataType="{x:Type Entities:Case}">
            <CallLog:CaseReadOnlyDisplay DataContext="{Binding}" />
        </DataTemplate>
    </TabControl.ContentTemplate>
</TabControl> 
```

**编辑：**这就是我最终的结果，而不是尝试绑定自定义控件。我从[上一个问题](https://stackoverflow.com/questions/935043/how-can-i-get-a-close-button-on-a-templated-tabitem-in-wpf)中得到的“ [CloseCommand](https://stackoverflow.com/questions/935043/how-can-i-get-a-close-button-on-a-templated-tabitem-in-wpf) ” 。

```
 <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource {x:Type TabItem}}" >
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Border 
                            Name="Border"
                            Background="LightGray"
                            BorderBrush="Black" 
                            BorderThickness="1" 
                            CornerRadius="25,0,0,0"
                            SnapsToDevicePixels="True">
                        <StackPanel Orientation="Horizontal">
                        <ContentPresenter x:Name="ContentSite"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Center"
                              ContentSource="Header"
                              Margin="20,1,5,1"/>
                            <Button 
                                Command="{Binding Path=CloseCommand}"
                                Cursor="Hand"
                                DockPanel.Dock="Right"
                                Focusable="False"
                                Margin="1,1,5,1"
                                Background="Transparent"
                                BorderThickness="0">
                                <Image Source="/Russound.Windows;component/Resources/Delete.png" Height="10" />
                            </Button>
                        </StackPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="FontWeight" Value="Bold" />
                            <Setter TargetName="Border" Property="Background" Value="LightBlue" />                            
                            <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0" />
                            <Setter TargetName="Border" Property="BorderBrush" Value="DarkBlue" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-05-08T22:02:25.693

找到了一种方法，从 TabControl 派生一个类并覆盖此函数，在我的情况下，我希望选项卡控件的项目（绑定时）为 CloseableTabItems

```
public class CloseableTabControl : TabControl
    {
        protected override DependencyObject GetContainerForItemOverride()
        {
            return new CloseableTabItem();
        }
    } 
```

HTH 某人

山姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:41:52.443

在这种情况下，您不想设置`DataType`of 。每当需要添加新项目时都会使用`DataTemplate`该属性的值，如果是选项卡控件，它将用于创建新的. 您应该在其自身中声明您的类的一个实例：`ItemTemplate``TabItem``DataTemplate`

```
<TabControl x:Name="tabCases" IsSynchronizedWithCurrentItem="True" Controls:ClosableTabItem.TabClose="TabClosed">
    <TabControl.ItemTemplate>
        <DataTemplate>
            <Controls:ClosableTabItem>
                <TextBlock Text="{Binding Path=Id}" />
            </Controls:ClosableTabItem>
        </DataTemplate>
    </TabControl.ItemTemplate>
    <TabControl.ContentTemplate>
        <DataTemplate DataType="{x:Type Entities:Case}">
            <CallLog:CaseReadOnlyDisplay DataContext="{Binding}" />
        </DataTemplate>
    </TabControl.ContentTemplate>
</TabControl> 
```

每当`ClosableTabItem`将新选项卡添加到`TabControl`.

**更新**；从您的评论来看，这听起来像是`ItemTemplate`控制在 中创建的内容`TabItem`，而不是更改`TabItem`本身。做你想做的事，但对于 a `TreeView`，你会设置`HeaderTemplate`. 不幸的是，我没有看到`HeaderTemplate`.`TabControl`

我做了一些搜索，[本教程](http://www.switchonthecode.com/tutorials/the-wpf-tab-control-inside-and-out)通过向`TabItem.Header`. 也许您可以`Style`为您的班级创建一个`TabItems`添加您的班级当前正在添加的关闭按钮？

# java - 在将对象创建为不同类型的数组时如何摆脱类型不匹配错误？

> ID：936291
> 
> 赞同：2
> 
> 时间：2009-06-01T19:16:23.523
> 
> 标签：java, typing

这是我的课：

```
public class Test {     
    Test(){
        new Webshop
            (new Warenkorb[]{"Max", new Artikel[]{new Artikel("AAA",3.0)}, 
                                "Joe", new Artikel[]{new Artikel("BBB",3.0), 
                                new Artikel("CCC",3.0)}
                            },
                new Warenkorb[]{"Sam", new Artikel[]{new Artikel("BBB",3.0), 
                                                      new Artikel("CCC",3.0)}
                                },
            ); 
    }
} 
```

这些是我的构造函数：

```
Artikel(String name, double preis){
    this.name = name;
    verkaufspreis = preis;
    Art = Warengruppe.S;

Warenkorb(String kunde, Artikel[] artikel){
    this.kunde = kunde;
    artikelliste = artikel;
    sessionid = s.nextInt();
    summe = 0;
    for(Artikel preis : artikel){
        summe += preis.verkaufspreis;
    }
} 
```

我在

> 测试类（String[] 无法解析为 Warenkorb[] | Artikel[] 无法解析为 Warenkorb）。

如何解决这些错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T19:21:27.587

您缺少 Warenkorb 元素的构造函数调用。

尝试

```
...
new Warenkorb[]{new Warenkorb("Max", new Artikel[]{new Artikel("AAA",3.0))}, 
                new Warenkorb("Joe", new Artikel[]{new Artikel("BBB",3.0), 
                                                  new Artikel("CCC",3.0))}
... 
```

# validation - 您在哪里进行验证？

> ID：936296
> 
> 赞同：12
> 
> 时间：2009-06-01T19:18:32.193
> 
> 标签：validation, architecture

希望您会在下面的场景中看到我所描述的问题。如果不清楚，请告诉我。

你有一个分为三层的应用程序，

*   前端 UI 层，可以是 asp.net webform，也可以是 window（用于编辑 Person 数据）
*   中间层业务服务层，编译成dll（PersonServices）
*   数据访问层，编译成dll（PersonRepository）

在我的前端，我想创建一个新的 Person 对象，根据用户在 UI 中输入的内容设置一些属性，例如 FirstName、LastName，然后调用 PersonServices.AddPerson，传递新创建的 Person。（AddPerson 不必是静态的，这只是为了简单起见，在任何情况下，AddPerson 最终都会调用存储库的 AddPerson，然后它将持久化数据。）

现在我想听听你的意见的部分是验证。在某个地方，需要验证新创建的 Person 。您可以在客户端执行此操作，这很简单，但如果我想在我的 PersonServices.AddPerson 方法中验证 Person 怎么办。这将确保我要保存的任何人都将得到验证，并消除对 UI 层执行工作的任何依赖。或者，在 UI 和业务服务器层中进行验证。到目前为止听起来不错吧？

因此，为简单起见，我将更新 PersonService.AddPerson 方法以执行以下验证检查 - 检查 FirstName 和 LastName 是否不为空 - 确保此新 Person 不存在于我的存储库中

如果所有验证都通过并且 Person 被持久化，则此方法将返回 True，如果验证失败或 Person 未持久化，则返回 False。

但是 AddPerson 返回的这个布尔值不足以让我在 UI 层向用户明确说明保存过程失败的原因。那么孤独的开发者该怎么办呢？最终，我希望 AddPerson 方法能够确保它要保存的内容是有效的，如果不是，能够将它无效的原因传达给我的 UI 层。

只是为了让你的果汁流动，解决这个问题的一些方法可能是：（在我看来，其中一些解决方案很糟糕，但我只是把它们放在那里，这样你就可以了解我想要解决的问题）

*   AddPerson 不是返回布尔值，而是返回一个 int（即 0 = 成功，非零等于失败，数字表示失败的原因。

*   在 AddPerson 中，当验证失败时抛出自定义异常。每种类型的自定义异常都会有自己的错误消息。此外，每个自定义异常都足够独特，可以在 UI 层中捕获

*   让 AddPerson 返回某种自定义类，该类具有指示验证是通过还是失败的属性，如果确实失败了，原因是什么

*   不确定这是否可以在 VB 或 C# 中完成，但将某种属性附加到 Person 及其基础属性。这个“附加”属性可能包含验证信息等内容

*   **在此处插入您的想法或模式**

*   **也许另一个在这里**

为冗长的问题道歉，但我绝对想听听您对此的看法。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T20:10:15.460

多层验证与多层应用程序相得益彰。

UI 本身可以进行最简单和最快的检查（是否存在所有必填字段，是否使用适当的字符集等），以便在用户输入错误时立即提供反馈。

然而，业务逻辑应该承担大部分的验证责任......如果这是“重复的”，即如果业务层重新检查应该已经在 UI 中检查过的东西，这一次不是问题—— BL 应该检查所有的业务规则（这对 UI 的正确性进行双重检查，启用多个不同的 UI 客户端，这些客户端的检查可能并不完美——例如，智能手机上的特殊客户端可能没有良好的 javascript，等等- 并且，有点，防止恶意黑客攻击的客户端）。

当业务逻辑将“验证”数据保存到数据库时，*该*层应该执行自己的检查——数据库擅长这一点，而且，再次，不要担心重复——这是数据库的工作来强制数据完整性（有一天，您可能需要不同的方式向其提供数据，例如“批量加载程序”以从另一个来源导入大量人员，并且确保所有这些加载数据的方式始终遵守数据完整性规则是关键）；某些规则（例如唯一性和参照完整性）确实在数据库中得到了最好的执行，尤其是出于性能原因。

当数据库向业务层返回错误消息（未作为约束 X 插入的数据将被违反）时，业务层的工作是以业务术语重新解释该错误并将结果提供给 UI 以通知用户；当然，BL 必须同样向 UI 提供关于违反业务规则的清晰完整的信息，再次显示给用户。

因此，“自定义对象”显然是“唯一的方法”（例如，在某些情况下，我只是将其设为 JSON 对象）。当数据库拒绝持久化时，保留 Person 对象（以保持其“验证问题”属性）看起来不像是一种简单明了的技术，所以我不认为这个选项太多；但是如果您需要它（例如，启用“再次告诉我出了什么问题”功能，也许如果客户端在响应准备好之前离开并且需要稍后顺利重新启动；或者，此类对象的列表以供以后审核，&c） ，那么“自定义验证失败对象”也*可以*被附加到该列表...但这是一个“次要问题”，主要是让 BL 使用这样的对象响应 UI（如果插入确实在事实成功）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T15:06:22.313

只是一个快速的（希望有帮助的）评论：当你想知道在哪里放置验证时，试着假装很快，你将使用你还不熟悉的技术完全重新创建你的 UI 层**。尝试将任何您确定必须在新技术中重写的类似验证的业务逻辑排除在该层之外。

你会发现异常——不管怎样，业务逻辑最终都会出现在你的 UI 层中，但这仍然是一个有用的考虑因素。

** 移动开发、Silverlight、Voice XML 等等 - 假装您不了解您的“新”UI 层的技术可以帮助您抽象您的关注点并减少对实现细节的困扰。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T01:27:44.460

唯一重要的点是：

*   从前端的角度来看，中间层必须执行**所有**验证，你永远不知道是否有人会试图通过直接与你的中间层对话来绕过你的前端验证（无论出于何种原因）
*   中间层可以选择将一些验证委托给 DB 层（例如数据完整性约束）
*   您可以选择在 UI 中复制一些验证，但这只是为了提高性能（避免在常见情况下往返中间层，例如缺少必填字段、格式错误的数据等）。这些检查应该**永远不要**代替在中间层做它们

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T15:32:04.570

验证应在所有三个级别上进行。

当我在一个项目中时，我假设我正在制作一个框架，但大多数情况下并非如此。每层都是独立的，在进行操作之前必须检查所有层的输入

每个级别都可以有不同的方法，没有必要它们都使用相同的，但理想情况下，它们都应该使用相同的验证并能够自定义验证。

您永远不想让不良数据进入数据库。所以你永远不能相信你从业务层获得的数据。需要检查。

在业务层中，您永远不能信任 UI 层，您必须检查它以防止对数据库层的不必要调用。UI 层的工作方式相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-16T14:00:19.487

我不同意 David Basarab 的评论，即所有层都应该存在相同的验证。出于一个原因，这违背了层的责任范式。其次，虽然主要目的是使层（或组件）松散耦合，但赋予层一定程度的责任（以及信任）也很重要。尽管可能需要在 UI 和业务层中重复一些验证（因为 UI 层可以被黑客尝试绕过），但是不建议在每一层中重复验证。每一层都应该只执行他们负责的那些验证。在所有层中重复验证的最大缺陷是代码冗余，这可能会导致维护噩梦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T19:46:04.633

其中很多是风格而不是实质。我个人倾向于将返回状态对象作为一种灵活且可扩展的解决方案。我想说我认为有几类验证在起作用，第一类是“这个人的数据是否符合一个人的契约？” 第二个是“这个人的数据是否违反了数据库中的约束？” 我认为第一次验证可以而且应该在客户端完成。第二个应该在中间层完成。通过这种划分，您可能会发现保存失败的唯一原因是 1) 违反唯一性约束，或 2) 某些灾难性事件。然后，您可以为第一种情况返回 false，并为另一种情况抛出异常。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-04T15:17:15.177

如果 R 层比 S 层更靠近用户（或任何您不控制的输入流），则 S 层应该验证从 R 层接收到的所有数据。这并不意味着 R 层不应该验证数据。如果 GUI 在尝试新事务之前警告他犯了错误，对用户来说会更好。但是，无论您的 GUI 中的验证多么安全，下一层都不应该相信任何验证已经发生。

这假设您的数据库完全在您的控制之下。如果没有，你有更大的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-04T15:27:00.070

此外，您可以让 UI 通过某种 PersonBuilder 对象传递构建 Person 对象所需的数据，以便将对象创建合并到域/业务层中，并且您可以将 Person 对象保持在始终一致的状态. 这对于更复杂的实体更有意义，但是即使对于简单的实体，集中对象创建也是很好的，就像集中持久性等一样。

# javascript - 在 Document HEAD 中链接到外部脚本的最佳方式

> ID：936297
> 
> 赞同：0
> 
> 时间：2009-06-01T19:18:59.383
> 
> 标签：javascript, external-script, html-head

我注意到许多网站都使用它，而没有关闭标签。

```
 <script type="text/javascript" src="editor.js"> 
```

也[推荐](http://www.w3schools.com/js/js_whereto.asp)这种风格，但更长：

```
 <script type="text/javascript" src="editor.js"></script> 
```

我可以这样写吗？它有效还是有更好的方法？

```
 <script type="text/javascript" src="editor.js" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T19:23:18.830

你总是想用

```
<script type="text/javascript" src="editor.js"></script> 
```

一些浏览器不允许自闭合脚本标签。

有关更多信息，请参阅[为什么自闭合脚本标签不起作用？](https://stackoverflow.com/questions/69913/why-dont-self-closing-script-tags-work)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:24:09.187

使用第二个选项。[并非所有浏览器都](http://www.phpied.com/ie-script-tag-problem/)支持自关闭样式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T19:58:09.977

```
<script type="text/javascript" src="editor.js"> 
```

这是无效的，并且会破坏事物。

```
<script type="text/javascript" src="editor.js"></script> 
```

这可以。

```
<script type="text/javascript" src="editor.js" /> 
```

只要您使用的是不[兼容 HTML](http://www.w3.org/TR/xhtml-media-types/#C_3)的 XHTML，这很好。这意味着您需要为 XHTML 提供 XML 内容类型（最好是 application/xhtml+xml），而忘记支持 Internet Explorer（除了使用单独的文档）。

# asp.net - jquery 将字符串转换为 json 以发送到我的网络服务？

> ID：936299
> 
> 赞同：1
> 
> 时间：2009-06-01T19:19:47.370
> 
> 标签：asp.net, jquery, ajax, json

试图弄清楚如何将我在 JavaScript（字符串）中的 5 个变量转换为 JSON 以发送到我的 ajax 函数

这是我的 ajax 函数，相对较新，但我相信这应该可以工作.. 但我需要将所有字符串转换为 JSON - 不是吗？

我相信有其他方法可以在没有 json 的情况下发送数据，但这是推荐的方法，不是吗？

```
 $.ajax({
                type: "POST",
                url: "MyService.aspx/SendEmail",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(msg) {
                    alert(msg.d);
                },
                error: function() {
                    alert('error');
                }

            }); 
```

我相信在服务端我需要提取 JSON - 我正在使用 asp.net

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T19:27:05.890

您无需转换为 json 即可传递数据。只需指定您需要传递的数据：

```
$.ajax({
       url: "myUrl",
        data: {
            var1: "some data or var",
            dataItem2: false // or a variable
        },

        success: function(msg) {
            alert(msg.d);
        },
        error: function() {
            alert('error');
        }
    }); 
```

数据将作为请求参数提供，如下所示（在 Asp.Net 中）：

```
Request.Params["var1"] 
```

现在，如果您确实需要在服务器上接收 json，那是另一个问题。如果这是一个要求，我有兴趣了解为什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T11:18:50.087

我建议您将 JSON2.js 包含在您的项目中，您可以在此[链接](http://www.json.org/js.html)中找到它，并使用 JSON.stringify() 函数：

```
...
data: JSON.stringify({ yourVar: "value", var2: "value2" }),
... 
```

如果您的 Web 服务返回 json 数据，您可以使用库解析结果：

```
success: function(json) { json = JSON.parse(json);
                          var o = json.d;
                          ... 
} 
```

它可以向您保证，您的输入数据将从每个非法字符中清除。

# wpf - 绑定到静态属性

> ID：936304
> 
> 赞同：188
> 
> 时间：2009-06-01T19:20:48.663
> 
> 标签：wpf, xaml, data-binding

我很难将简单的静态字符串属性绑定到 TextBox。

这是具有静态属性的类：

```
public class VersionManager
{
    private static string filterString;

    public static string FilterString
    {
        get { return filterString; }
        set { filterString = value; }
    }
} 
```

在我的 xaml 中，我只想将此静态属性绑定到 TextBox：

```
<TextBox>
    <TextBox.Text>
        <Binding Source="{x:Static local:VersionManager.FilterString}"/>
    </TextBox.Text>
</TextBox> 
```

一切都编译，但在运行时，我得到以下异常：

> 无法将属性“源”中的值转换为“System.Windows.Markup.StaticExtension”类型的对象。标记文件“BurnDisk;component/selectversionpagefunction.xaml”第 57 行位置 29 中的对象“System.Windows.Data.Binding”出错。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2009-06-02T09:25:52.533

如果绑定需要双向，则必须提供路径。

如果类不是静态的，则对静态属性进行双向绑定有一个技巧：在资源中声明该类的虚拟实例，并将其用作绑定的源。

```
<Window.Resources>
    <local:VersionManager x:Key="versionManager"/>
</Window.Resources>
...

<TextBox Text="{Binding Source={StaticResource versionManager}, Path=FilterString}"/> 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2009-06-01T19:25:07.157

你不能绑定到这样的静态。绑定基础设施无法获得更新通知，因为不涉及`DependencyObject`（或实现的对象实例`INotifyPropertyChanged`）。

如果该值没有改变，只需放弃绑定并`x:Static`直接在`Text`属性内使用。在下面定义`app`为 VersionManager 类的命名空间（和程序集）位置。

```
<TextBox Text="{x:Static app:VersionManager.FilterString}" /> 
```

如果值确实发生了变化，我建议创建一个单例来包含该值并绑定到该值。

单例的一个例子：

```
public class VersionManager : DependencyObject {
    public static readonly DependencyProperty FilterStringProperty =
        DependencyProperty.Register( "FilterString", typeof( string ),
        typeof( VersionManager ), new UIPropertyMetadata( "no version!" ) );
    public string FilterString {
        get { return (string) GetValue( FilterStringProperty ); }
        set { SetValue( FilterStringProperty, value ); }
    }

    public static VersionManager Instance { get; private set; }

    static VersionManager() {
        Instance = new VersionManager();
    }
} 
```

```
<TextBox Text="{Binding Source={x:Static local:VersionManager.Instance},
                        Path=FilterString}"/> 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2011-09-22T13:54:58.767

在 .NET 4.5 中可以绑定到静态属性，[阅读更多](http://msdn.microsoft.com/en-us/library/bb613588%28v=vs.110%29.aspx#static_properties)

> 您可以使用静态属性作为数据绑定的来源。如果引发静态事件，数据绑定引擎会识别属性值何时更改。例如，如果类 SomeClass 定义了一个名为 MyProperty 的静态属性，那么 SomeClass 可以定义一个静态事件，该事件在 MyProperty 的值更改时引发。静态事件可以使用以下任一签名：

```
public static event EventHandler MyPropertyChanged; 
public static event EventHandler<PropertyChangedEventArgs> StaticPropertyChanged; 
```

> 请注意，在第一种情况下，该类公开了一个名为 PropertyNameChanged 的​​静态事件，该事件将 EventArgs 传递给事件处理程序。在第二种情况下，该类公开了一个名为 StaticPropertyChanged 的​​静态事件，该事件将 PropertyChangedEventArgs 传递给事件处理程序。实现静态属性的类可以选择使用任一方法引发属性更改通知。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-11-22T06:17:52.417

从 WPF 4.5 开始，您可以直接绑定到静态属性，并在属性更改时自动更新绑定。您确实需要手动连接更改事件以触发绑定更新。

```
public class VersionManager
{
    private static String _filterString;        

    /// <summary>
    /// A static property which you'd like to bind to
    /// </summary>
    public static String FilterString
    {
        get
        {
            return _filterString;
        }

        set
        {
            _filterString = value;

            // Raise a change event
            OnFilterStringChanged(EventArgs.Empty);
        }
    }

    // Declare a static event representing changes to your static property
    public static event EventHandler FilterStringChanged;

    // Raise the change event through this static method
    protected static void OnFilterStringChanged(EventArgs e)
    {
        EventHandler handler = FilterStringChanged;

        if (handler != null)
        {
            handler(null, e);
        }
    }

    static VersionManager()
    {
        // Set up an empty event handler
        FilterStringChanged += (sender, e) => { return; };
    }

} 
```

您现在可以像绑定其他任何属性一样绑定您的静态属性：

```
<TextBox Text="{Binding Path=(local:VersionManager.FilterString)}"/> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-01-22T18:08:09.587

`static`绑定属性可能有两种方式/语法。如果**p**是 class 中的一个`static`属性**`MainWindow`**，那么`binding`for`textbox`将是：

**1.**

```
<TextBox Text="{x:Static local:MainWindow.p}" /> 
```

**2.**

```
<TextBox Text="{Binding Source={x:Static local:MainWindow.p},Mode=OneTime}" /> 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-01-23T09:14:23.913

您可以使用`ObjectDataProvider`类及其`MethodName`属性。它看起来像这样：

```
<Window.Resources>
   <ObjectDataProvider x:Key="versionManager" ObjectType="{x:Type VersionManager}" MethodName="get_FilterString"></ObjectDataProvider>
</Window.Resources> 
```

声明的对象数据提供者可以这样使用：

```
<TextBox Text="{Binding Source={StaticResource versionManager}}" /> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-07-04T13:45:12.997

如果您使用的是本地资源，您可以参考它们如下：

```
<TextBlock Text="{Binding Source={x:Static prop:Resources.PerUnitOfMeasure}}" TextWrapping="Wrap" TextAlignment="Center"/> 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-09-01T14:20:55.513

.NET 4.5 + 的正确变体

C# 代码

```
public class VersionManager
{
    private static string filterString;

    public static string FilterString
    {
        get => filterString;
        set
        {
            if (filterString == value)
                return;

            filterString = value;

            StaticPropertyChanged?.Invoke(null, FilterStringPropertyEventArgs);
        }
    }

    private static readonly PropertyChangedEventArgs FilterStringPropertyEventArgs = new PropertyChangedEventArgs (nameof(FilterString));
    public static event PropertyChangedEventHandler StaticPropertyChanged;
} 
```

XAML 绑定（注意大括号是 ()，而不是 {}）

```
<TextBox Text="{Binding Path=(yournamespace:VersionManager.FilterString)}" /> 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-04-30T14:09:30.087

最简单的答案（.net 4.5 及更高版本）：

```
 static public event EventHandler FilterStringChanged;
    static string _filterString;
    static public string FilterString
    {
        get { return _filterString; }
        set
        {
            _filterString= value;
            FilterStringChanged?.Invoke(null, EventArgs.Empty);
        }
    } 
```

和 XAML：

```
 <TextBox Text="{Binding Path=(local:VersionManager.FilterString)}"/> 
```

不要忽视括号

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-11-13T20:23:05.713

看看我的项目[CalcBinding](https://github.com/Alex141/CalcBinding)，它为您提供了在 Path 属性值中编写复杂的表达式，包括静态属性、源属性、Math 等。所以，你可以这样写：

```
<TextBox Text="{c:Binding local:VersionManager.FilterString}"/> 
```

祝你好运！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-21T10:41:22.780

另一种解决方案是创建一个像这样实现 PropertyChanger 的普通类

```
public class ViewProps : PropertyChanger
{
    private string _MyValue = string.Empty;
    public string MyValue
    {
        get { 
            return _MyValue
        }
        set
        {
            if (_MyValue == value)
            {
                return;
            }
            SetProperty(ref _MyValue, value);
        }
    }
} 
```

然后在你不会的地方创建一个类的静态实例

```
public class MyClass
{
    private static ViewProps _ViewProps = null;
    public static ViewProps ViewProps
    {
        get
        {
            if (_ViewProps == null)
            {
                _ViewProps = new ViewProps();
            }
            return _ViewProps;
        }
    }
} 
```

现在将其用作静态属性

```
<TextBlock  Text="{x:Bind local:MyClass.ViewProps.MyValue, Mode=OneWay}"  /> 
```

如果需要，这里是 PropertyChanger 的实现

```
public abstract class PropertyChanger : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected bool SetProperty<T>(ref T storage, T value, [CallerMemberName] string propertyName = null)
    {
        if (object.Equals(storage, value)) return false;

        storage = value;
        OnPropertyChanged(propertyName);
        return true;
    }

    protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
    {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

# asp.net - 文件夹权限

> ID：936306
> 
> 赞同：1
> 
> 时间：2009-06-01T19:21:14.233
> 
> 标签：asp.net, security, directory, file-permissions

如何授予对 NTFS 文件夹 (Win2003) 的访问权限，以便在将文件添加到此文件夹时，它们获得相同的访问权限？我的问题是我已授予对特定文件夹上的“网络服务”的读取访问权限，但是当我将文件添加到该文件夹​​（以编程方式将文件生成到该文件夹​​）时，网络服务没有对​​这些文件的读取访问权限。我会认为权限级联到文件夹中的文件？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T19:25:21.073

文件夹中的子对象是否从父对象继承权限？右键单击文件夹-属性-权限-高级。

您是否正在移动（而不是复制）文件夹中的文件？移动文件也会移动它们的权限。

# asp.net-mvc - 如何将实体键（引用）从视图传递到控制器

> ID：936307
> 
> 赞同：0
> 
> 时间：2009-06-01T19:21:14.513
> 
> 标签：asp.net-mvc, linq-to-entities

我有一个使用 linq to sql 的工作页面，现在我正在将其转换为 linq to entity

我的测试项目包含 2 个表，contact(id,name,email) 和 comments(id,contactid,comment)

当我想创建一个新评论时，我将联系人 ID 放在一个隐藏字段中的视图中，它与提交按钮上的所有其他内容一起提交

它与 linq2sql 一起工作正常，但它不适用于 linq2entity

如何用 linq2entity 做到这一点？

***编辑#1***

实际上问题是，我如何处理一个或多个外键？在那种情况下，我只有一个，是的，我可以使用**eu-ge-ne**的建议，但是如果我有第二个呢？

***编辑#2***

[现在找到了这个](http://blogs.windowsclient.net/joeyw/archive/2009/04/18/asp-net-mvc-entity-framework-amp-silverlight-how-magic-are-the-wizards.aspx)解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:40:08.110

最好将contactId 作为url 的一部分提供。例如（使用“默认”路由）：

```
public CommentController : Controller
{
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Add(int id)
    {
        ...
    }
} 
```

在您看来：

```
<% using (Html.BeginForm(new {
    controller = "comment",
    action = "add",
    id = /* commentId from your Model */ })) { %>
    ...
<% } %> 
```

**更新：**

如果您有 2 个或更多外键：

**S1：**

```
routes.MapRoute("CustomRoute", "{controller}/{action}/{id1}/{id2}",
    new { controller = "home", action = "index", id1 = "", id2 = "" });

...

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Add(int id1, int id2)
{
    ...
}

...

<% using (Html.BeginForm(new {
    controller = "comment",
    action = "add",
    id1 = /* foreighn key 1 */,
    id2 = /* foreighn key 2 */ })) { %>
    ...
<% } %> 
```

**S2：**

在视图中：

```
<% using (Html.BeginForm(new { controller = "comment", action = "add" })) { %>
    ...

    <input id="foreignKeyId1" type="hidden" value="<%= /* foreign key 1 */ %>" />
    <input id="foreignKeyId2" type="hidden" value="<%= /* foreign key 2 */ %>" />
    ...
    <input id="foreignKeyIdN" type="hidden" value="<%= /* foreign key N */ %>" />
<% } %>

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Add(FormCollection form)
{
    var foreignKey1 = form["foreignKeyId1"]
    var foreignKey2 = form["foreignKeyId2"]
    ...
    var foreignKeyN = form["foreignKeyIdN"]

    ...
} 
```

# xml - 如何设置模式感知 XQuery

> ID：936313
> 
> 赞同：1
> 
> 时间：2009-06-01T19:21:50.470
> 
> 标签：xml, xquery

我正在尝试使用类型来选择作为子类型的元素，因此我有一个包含 xs:integer 和 xs:float 子类型的测试文档。

如何告诉 XQuery 使用我的模式中定义的类型？

（我使用 oXygen 和 Saxon-SA 可能是相关的）

输入文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="test-inherit.xsd">
    <int>4</int>
    <rest-int>5</rest-int>
    <rest-float>6</rest-float>
</root> 
```

WXS 架构：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name="root">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="int" type="xs:integer"/>
                <xs:element name="rest-int" type="rest-int"/>
                <xs:element name="rest-float" type="rest-float"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>

    <xs:simpleType name="rest-int">
        <xs:restriction base="xs:integer">
            <xs:maxInclusive value="10"></xs:maxInclusive>
            <xs:minInclusive value="0"></xs:minInclusive>
        </xs:restriction>
    </xs:simpleType>

    <xs:simpleType name="rest-float">
        <xs:restriction base="xs:float">
            <xs:maxInclusive value="10"></xs:maxInclusive>
            <xs:minInclusive value="0"></xs:minInclusive>
        </xs:restriction>
    </xs:simpleType>

</xs:schema> 
```

查询：

```
for $integer in doc("test-inherit.xml")//element(xs:integer)
return <integer>{$integer}</integer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T20:17:33.930

您需要在 XQuery 中导入模式。此外，如果您希望根据该架构（以及相应地分配给文档节点的架构类型）验证加载的文档，则需要使用`validate`表达式：

```
import schema default element namespace "" at "myschema.xsd";
for $integer in (validate { doc("test-inherit.xml") })//schema-element(int)
return <integer>{$integer}</integer> 
```

# c++ - 作业失败

> ID：936320
> 
> 赞同：1
> 
> 时间：2009-06-01T19:23:27.677
> 
> 标签：c++, debugging, visual-studio-2005, variable-assignment

我正在 Visual Studio 2005 中调试一个大型项目的一部分，并逐行执行代码。

```
int speed = this->values.speed;
int ref = this->values.ref_speed; 
```

越过第一行后，values.speed 的值为 61，但由于某种原因，speed 被赋值为 58。在第二行之后，values.ref_speed 的值为 58，但 ref 被赋值为 30 .

暂停时，您可以看到原始值实际上分别为 61 和 58，但存储的值不同。

是什么导致了这种行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T19:43:30.223

如果在头文件中更改了值结构的定义并且并非所有目标文件都重新编译，则可能会发生这种情况。然后，您在此文件中的代码正在使用的结构的“映射”可能与代码的其余部分不匹配。这可以解释为什么其中一个变量似乎具有另一个变量的值。

或者 Visual Studio .pdb 文件由于某种原因没有得到更新，并且 Visual Studio 正在旧位置查找变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:40:18.810

疯狂的。您是否有可能拥有与 this->values 相同类型的局部变量，其名称也是 values（这可以解释为什么您通过 this-> 引用成员）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T19:29:41.720

您是在调试模式还是发布模式下执行此操作？如果您在发布模式下执行此操作，或者启用优化，编译器可能会重新排序以提高性能，这可能会导致看起来很奇怪的结果。这并不意味着实际执行中有任何错误，但单步执行可能会令人困惑。

# sql - SQL：针对表的视图 - 针对视图的查询是否仍在使用表索引？

> ID：936321
> 
> 赞同：4
> 
> 时间：2009-06-01T19:23:45.583
> 
> 标签：sql, tsql, view

我正在对我的表（“用户”）使用视图（“用户活动”）。该视图只有一个过滤器，它检查 DateTime Users.DeletedOn 是否为 NULL；它基本上包含所有未删除的用户。

如果我现在对视图而不是表执行 Linq 查询，它们还会使用表索引还是我需要为视图创建特殊索引？在我的理解中，视图只不过是一个预定义的查询，应该像我直接查询它一样工作：

SELECT * FROM Users WHERE DeletedON = NULL

我假设基础表的索引仍将被使用是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T19:29:08.647

大多数时候，SQL Server 查询优化器足够聪明，可以使用基表上的索引。您可以通过查看查询计划来了解这一点。

如果你有企业版的 SQL Server，你也可以使用索引视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T19:31:40.780

视图对底层 SQL 语句是完全透明的。这是一个很好的可靠设计假设。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T19:42:51.833

索引视图与非索引视图非常不同。

引擎可以有效地内联扩展视图，因此可以使用由优化器确定的任何表索引。

索引视图具体化（并保持最新）索引。这对视图的用户可用，但仍可能不被使用。

基于您的示例的附加说明 - 索引可能不会像在标志或代码列上那样有效地用于 NULL 标准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T21:39:37.993

您很可能需要重写查询：

SELECT * FROM Users WHERE DeletedON IS NULL

即使 DeletedON IS NULL，DeletedON = NULL 也不会为真

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-01T19:30:35.773

如果未编入索引，则每次使用定义它的查询都会重新生成视图。如果该查询中的表已编入索引，则将使用该表的索引。

您还可以索引视图，在这种情况下，数据集将提交到物理磁盘，并且您将拥有两组索引。

# sql - SQL 按组选择计数器

> ID：936322
> 
> 赞同：2
> 
> 时间：2009-06-01T19:23:51.293
> 
> 标签：sql, count

这是我为创建场景而编写的代码：

```
USE tempdb
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'dbo.Emp') AND type in (N'U'))
DROP TABLE Emp
GO
CREATE TABLE Emp(
EmpID Int Identity(10,1) Primary Key,
EmpGroupID Int)
GO
INSERT INTO Emp(EmpGroupID) VALUES(1000)
INSERT INTO Emp(EmpGroupID) VALUES(1000)
INSERT INTO Emp(EmpGroupID) VALUES(1000)
INSERT INTO Emp(EmpGroupID) VALUES(2000)
INSERT INTO Emp(EmpGroupID) VALUES(2000)
INSERT INTO Emp(EmpGroupID) VALUES(2000)
INSERT INTO Emp(EmpGroupID) VALUES(3000)
GO
SELECT * FROM Emp
ORDER BY EmpGroupID,EmpID 
```

我需要的是每个组都有一个计数器变量，以 1 递增，这样第 1000 组的所有行的计数器 = 1，groupid = 2000 的计数器 = 2，groupid = 3000 的计数器 = 3。

```
SELECT ?,EmpID,EmpGroupID 
FROM Emp
ORDER BY EmpGroupID,EmpID
-- The result I'm looking for is:
1,10,1000
1,11,1000
1,12,1000
2,13,2000
2,14,2000
2,15,2000
3,16,3000 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:12:16.297

您正在描述密集的组排名：

```
SELECT
  DENSE_RANK() OVER (ORDER BY EmpGroupID) as Counter,
  EmpID,
  EmpGroupID
FROM Emp
ORDER BY EmpGroupID,EmpID 
```

这里有一些参考资料：http: [//msdn.microsoft.com/en-us/library/ms189798.aspx](http://msdn.microsoft.com/en-us/library/ms189798.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T19:27:55.950

您的意思是，您需要一个使用逗号生成文本输出的查询，如图所示？

尝试：

```
SELECT Counter + ',' + EmpGroupID + ',' + EmpID
FROM Table
ORDER BY EmpGroupID 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T19:26:27.730

ORDER BY 可以有多个子句

尝试

```
SELECT Counter,EmpGroupID, EmpID
ORDER BY Counter,EmpGroupID, EmpID 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T19:27:47.433

根据您的描述猜测，您是否想要类似的东西

SELECT EmpGroupID, EmpID, COUNT(1) AS Counter
FROM some-table-name
GROUP BY EmpGroupID, EmpID
ORDER BY COUNT(1), EmpGroupID, EmpID

这适用于 SQL Server - 在其他情况下，您可能会说

ORDER BY Counter, EmpGroupID, EmpID

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T19:30:12.280

我花了一段时间才明白你在问什么。据我了解，您想根据 EmpGroupID 创建和填充“计数器”列吗？如果是这样，那么是这样的：

```
SELECT EmpGroupID, EmpID,
    (SELECT COUNT(*) +1 
     FROM [table] 
     WHERE t2.EmpGroupID < t1.EmpGroupID GROUP BY t2.EmpGroupID
    ) AS Counter
FROM [table] t1
ORDER BY EmpGroupID, EmpID 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-14T14:34:06.470

试试这个：

```
SELECT DENSE_RANK() OVER (ORDER BY EmpID) as 'counter',GroupID 
FROM Emp
ORDER BY counter, EmpGroupID 
```

# svn - 为什么“匿名”需要 authz 中的读取权限才能让 TortoiseSVN 进行差异或记录？

> ID：936323
> 
> 赞同：1
> 
> 时间：2009-06-01T19:23:56.007
> 
> 标签：svn, tortoisesvn

除非我在 authz 文件中执行以下操作：

```
[/some/path/to/trunk]
* = r 
```

为该中继添加的任何用户都无法进行差异或阅读日志。我不希望团队成员以外的任何人能够从目录中读取，但除非我添加匿名读取访问权限，否则我会从 TortoiseSVN 收到错误消息。有没有办法告诉客户端本身使用读/写用户提供的身份验证凭据来进行差异或读取日志？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T04:03:34.667

这应该可以工作，也许你有一些（旧的）用户登录仍然有效？查看`%APPDATA%\\Subversion\auth\svn.simple`每个文本文件并搜索您的 URL，如果有一个包含您当前 URL 的文件，TSVN（还有 svn cmd-line！）仍然会缓存您的登录凭据。您可以保存删除此文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-05T14:11:49.513

显然 TortoiseSVN 使用读取权限来确定是否可以对日志进行差异或读取。因此，如果没有声明读取权限，那么它就不会发生。但是，我认为这无关紧要，因为即使是只读用户仍然需要在用户文件中有用户名/密码。

# nhibernate - 如何使用 Nhibernate 设置一个枚举列？

> ID：936327
> 
> 赞同：0
> 
> 时间：2009-06-01T19:24:33.460
> 
> 标签：nhibernate

使用 nhibernate，如何将列设置为枚举类型？

例如

用户类有 UserType 这是一个枚举

```
public enum UserType { Normal = 1, Super = 2 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T19:32:00.327

您不会为枚举构建地图。您将枚举添加到对象上的地图中。将类型声明为枚举的类型。db 中的列需要是 int，NHib 会正确映射它。

[请参阅](https://stackoverflow.com/questions/889884/how-to-use-icriteria-with-enum-properties-in-nhibernate)我的答案。

# sql - 在 oracle 中更快地“从 table1 中选择不同的事物 ID、事物名称”

> ID：936328
> 
> 赞同：6
> 
> 时间：2009-06-01T19:24:39.513
> 
> 标签：sql, performance, oracle, select

我有这个查询：

```
select distinct id,name from table1 
```

对于给定的 ID，名称将始终相同。两个字段都被索引。没有单独的表将 id 映射到名称。该表非常大（10 百万行），因此查询可能需要一些时间。

此查询非常快，因为它已编入索引：

```
select distinct name from table1 
```

对于此查询也是如此：

```
select distinct id from table1 
```

假设我无法更改数据库结构（一个非常安全的假设），有什么更好的方法来构建第一个查询以提高性能？

编辑以添加表格的净化描述：

```
名称空类型
------------------ -------- ------------ ----------------
KEY NOT NULL NUMBER
COL1 非空数字
COL2 NOT NULL VARCHAR2(4000 CHAR)
COL3 VARCHAR2(1000 字符)
COL4 VARCHAR2(4000 字符)
COL5 VARCHAR2(60 字符)
COL6 VARCHAR2（150 个字符）
COL7 VARCHAR2（50 个字符）
COL8 VARCHAR2（3 个字符）
COL9 VARCHAR2（3 个字符）
COLA VARCHAR2(50 字符)
COLB 非空日期
COLC 非空日期
冷非空 VARCHAR2（1 个字符）
COLE 非空数字
COLF 非空数字
COLG VARCHAR2(600 字符)
身份证号
名称 VARCHAR2(50 字符)
COLH VARCHAR2（3 个字符）

选择了 20 行

```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T19:34:11.227

[最新编辑]

关于在 (name,id) 上创建适当的索引以替换 (name) 上的索引的我的**原始答案如下。**（这不是对原始问题的回答，该问题不允许任何数据库更改。）

以下是我*尚未*测试的陈述。可能有一些明显的原因这些不起作用。我从来没有真正*建议*写过这样的陈述（冒着因为这种荒谬的建议而被彻底敲打的风险。）

如果这些查询甚至返回结果集，则结果集只会类似于 OP 查询的结果集，这几乎**是偶然**的，利用了Don 提供给我们的数据的**古怪保证。**该语句不等同于原始 SQL，这些语句是为Don 描述的**特殊情况设计的。**

```
 select m1.id
      , m2.name
   from (select min(t1.rowid) as min_rowid
              , t1.id
           from table1 t1
          where t1.id is not null
          group by t1.id
        ) m1
      , (select min(t2.rowid) as min_rowid
             , t2.name from table1 t2
         where t2.name is not null
         group by t2.name
        ) m2
  where m1.min_rowid = m2.min_rowid
  order
     by m1.id 
```

让我们打开包装：

*   **m1**是一个内联视图，它为我们提供不同 id 值的列表。
*   **m2**是一个内联视图，它为我们提供不同名称值的列表。
*   实现视图**m1**和**m2**
*   **匹配m1**和**m2**中的 ROWID`id`以匹配`name`

其他人提出了索引合并的想法。我之前拒绝了这个想法，一个优化器计划匹配数以百万计的 rowid 而不消除它们中的任何一个。

id 和 name 具有足够低的基数，并且具有正确的优化器计划：

```
 select m1.id
      , ( select m2.name
            from table1 m2
           where m2.id = m1.id
             and rownum = 1
        ) as name
   from (select t1.id
           from table1 t1
          where t1.id is not null
          group by t1.id
        ) m1
  order
     by m1.id 
```

让我们打开包装

*   **m1**是一个内联视图，它为我们提供不同 id 值的列表。
*   物化视图**m1**
*   对于**m1**中的每一行，查询 table1 以从单行获取名称值（停止键）

**重要的提示**

这些语句与 OP 查询根本不同。它们旨在返回与 OP 查询不同的结果集。由于对数据的古怪保证，*碰巧返回了所需的结果集。*Don 告诉我们 a`name`由 决定`id`。（反之亦然吗？`id`由以下因素决定`name`？我们是否有一个 STATED GUARANTEE，不一定由数据库强制执行，而是我们可以利用的保证？）对于任何`ID`值，具有该值的每一行都`ID`将具有相同的`NAME`值。（而且我们也保证反过来是正确的，对于任何`NAME`值，具有该值的每一行都`NAME`将具有相同的`ID`值？）

如果是这样，也许我们可以利用这些信息。如果`ID`和`NAME`出现在不同的对中，我们只需要找到一个特定的行。“对”将有一个匹配的 ROWID，它恰好可以从每个现有索引中获得。如果我们得到每个的最小 ROWID `ID`，并得到每个的最小 ROWID `NAME`。难道我们不能根据包含该对的 ROWID 来`ID`匹配吗？`NAME`考虑到足够低的基数，我认为它可能会起作用。（也就是说，如果我们只处理数百个 ROWID 而不是千万个。）

[/最新编辑]

[编辑]

问题现在更新了有关表的信息，它显示`ID`列和`NAME`列都允许 NULL 值。如果 Don 可以在结果集中没有返回任何 NULL 的情况下生存，那么在这两个列上添加 IS NOT NULL 谓词可能会启用索引。（注意：在 Oracle（B-Tree）索引中，NULL 值不会出现在索引中。）

[/编辑]

**原始答案：**

创建适当的索引

```
create index table1_ix3 on table_1 (name,id) ... ; 
```

好的，这**不是****您提出**的问题的答案，但它是解决性能问题的正确答案。（您指定不更改数据库，但在这种情况下，更改数据库是正确的答案。）

请注意，如果您定义了索引 on `(name,id)`，那么您（很可能）不需要 on 索引`(name)`，因为优化器会考虑`name`另一个索引中的前导列。

（更新：作为比我指出的更精明的人，我什至没有考虑现有索引是位图索引而不是 B-tree 索引的可能性......）

* * *

重新评估您对结果集的需求......您是否需要 return `id`，或者 return 就`name`足够了。

```
select distinct name from table1 order by name; 
```

对于特定名称，您可以提交第二个查询以获取关联的`id`，如果以及何时需要它...

```
select id from table1 where name = :b1 and rownum = 1; 
```

* * *

如果你确实*需要*指定的结果集，你可以尝试一些替代方案，看看性能是否更好。我对这些都不抱太大希望：

```
select /*+ FIRST_ROWS */ DISTINCT id, name from table1 order by id; 
```

或者

```
select /*+ FIRST_ROWS */ id, name from table1 group by id, name order by name; 
```

或者

```
select /*+ INDEX(table1) */ id, min(name) from table1 group by id order by id; 
```

更新：正如其他人敏锐地指出的那样，通过这种方法，我们正在测试和比较替代查询的性能，这是一种命中或未命中的方法。（我不同意它是随机的，但我同意它是命中或未命中。）

更新：汤姆建议 ALL_ROWS 提示。我没有考虑过这一点，因为我真正专注于使用 INDEX 获取查询计划。我怀疑 OP 查询正在执行全表扫描，可能不是扫描需要时间，而是排序唯一操作 (<10g) 或哈希操作 (10gR2+) 需要时间。（缺少定时统计和事件 10046 跟踪，我只是在这里猜测。）但话又说回来，也许是扫描，谁知道呢，桌子上的高水位线可能会在一大片空块中消失。

不用说，表上的统计信息应该是最新的，我们应该使用 SQL*Plus AUTOTRACE，或者至少 EXPLAIN PLAN 来查看查询计划。

但建议的替代查询都没有真正解决性能问题。

提示可能会影响优化器选择不同的计划，基本上满足索引中的 ORDER BY，但我对此并不抱太大希望。（我不认为 FIRST_ROWS 提示与 GROUP BY 一起使用，INDEX 提示可能。）我可以看到这种方法在存在大量空且稀疏的数据块并且访问数据的情况下的潜力通过索引块，实际上可以显着减少被拉入内存的数据块......但这种情况将是例外而不是常态。

* * *

更新：正如 Rob van Wijk 所指出的，利用 Oracle 跟踪工具是识别和解决性能问题的最有效方法。

如果没有 EXPLAIN PLAN 或 SQL*Plus AUTOTRACE 输出的输出，我只是在这里猜测。

我怀疑您现在遇到的性能问题是必须引用表数据块才能获得指定的结果集。

无法绕过它，仅通过索引无法满足查询，因为没有包含 the`NAME`和`ID`列的索引，而`ID`or`NAME`列作为前导列。其他两个“快速” OP 查询可以从索引中得到满足，而无需引用行（数据块）。

即使查询的优化器计划使用其中一个索引，它仍然必须从数据块中检索关联的行，以便获取另一列的值。如果没有谓词（没有 WHERE 子句），优化器可能会选择全表扫描，并且可能会执行排序操作（<10g）。（同样，EXPLAIN PLAN 将显示优化器计划，AUTOTRACE 也是如此。）

我在这里也假设（大假设）两列都定义为 NOT NULL。

您还可以考虑将表定义为索引组织表 (IOT)，尤其是当这些是表中仅有的两列时。（物联网不是万能药，它有自己的一系列性能问题。）

* * *

您可以尝试重新编写查询（除非这是一个也被禁止的数据库更改）在我们的数据库环境中，我们认为查询与表和索引一样是数据库的一部分。）

同样，如果没有谓词，优化器可能不会使用索引。通过添加提示，您可以让查询计划使用现有索引之一来快速返回第一行，测试以下组合：

```
select /*+ INDEX(table1) */ ...
select /*+ FIRST_ROWS */ ...
select /*+ ALL_ROWS */ ...

  distinct id, name from table1;
  distinct id, name from table1 order by id;
  distinct id, name from table1 order by name;
  id, name from table1 group by id, name order by id;
  id, min(name) from table1 group by id order by id;
  min(id), name from table1 group by name order by name; 
```

通过提示，您可以影响优化器使用索引，这可能会避免排序操作，但总体而言，返回整个结果集需要更多时间。

（更新：其他人指出优化器可能会选择基于 ROWID 合并两个索引。这是一种可能性，但如果没有谓词来消除某些行，这可能会是一种更昂贵的方法（匹配数百万个 ROWID）来自两个索引，尤其是当没有任何行将基于匹配被排除时。）

但是，如果没有一些性能统计数据，所有这些理论化并不等于蹲下。

* * *

在没有更改数据库中的任何其他内容的情况下，您加快查询速度的唯一希望（我能想到的）是确保调整排序操作，以便（必需的）排序操作可以在内存中执行，而不是在磁盘。但这并不是真正的正确答案。优化器可能根本不进行排序操作，它可能正在执行哈希操作（10gR2+），在这种情况下，应该进行调整。排序操作只是我的猜测，基于过去使用 Oracle 7.3、8、8i、9i 的经验。）

一个严肃的 DBA 会遇到更多的问题，因为你为会话使用`SORT_AREA_SIZE`和/或`HASH_AREA_SIZE`参数，而不是创建正确的索引。（对于 10g 自动内存管理魔法之前的版本，这些会话参数是“老派”。）

**向您的 DBA 显示结果集的规范，让 DBA 调整它。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T22:13:17.957

查询不能通过查看或随机建议一些等效查询来调整，无论它们的含义如何。

您、我们或优化器需要了解有关您的数据的统计信息。然后，您可以使用 EXPLAIN PLAN 或 SQL *Trace/tkprof 等工具进行测量，甚至可以使用 SQL* Plus 中的简单自动跟踪工具进行测量。

你能告诉我们这个的输出吗：

```
set serveroutput off
select /*+ gather_plan_statistics */ distinct id,name from table1;
select * from table(dbms_xplan.display_cursor(null,null,'allstats last')); 
```

你的整个 table1 是什么样子的？请显示描述输出。

问候，罗布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T22:28:33.543

“表非常大（数百万行）”如果您无法更改数据库（添加索引等）。那么您的查询将别无选择，只能读取整个表。因此，首先，确定需要多长时间（即 SELECT ID、NAME FROM TABLE1 的时间）。你不会比这更快得到它。它必须做的第二步是 DISTINCT。在 10g+ 中应该使用 HASH GROUP BY。在此之前，它是一个 SORT 操作。前者更快。如果您的数据库是 9i，那么您可以通过将 1000 万行复制到 10g 数据库并在那里进行操作来获得改进。或者，分配内存（google ALTER SESSION SET SORT_AREA_SIZE）。这可能会损害数据库上的其他进程，但是您的 DBA 并没有给您太多选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T12:37:51.010

如果对于给定的总是返回`id`相同的，您可以运行以下命令：`name`

```
SELECT  (
        SELECT  name
        FROM    table1
        WHERE   id = did
                AND rownum = 1
        )
FROM    (
        SELECT  DISTINCT id AS did
        FROM    table1
        WHERE   id IS NOT NULL
        ) 
```

两个查询都将使用`id`.

如果您仍然需要这些`NULL`值，请运行以下命令：

```
SELECT  (
        SELECT  name
        FROM    table1
        WHERE   id = did
                AND rownum = 1
        )
FROM    (
        SELECT  DISTINCT id AS did
        FROM    table1
        WHERE   id IS NOT NULL
        )
UNION   ALL
SELECT  NULL, name
FROM    table1
WHERE   id IS NULL
        AND rownum = 1 
```

这会降低效率，因为第二个查询不使用索引，但它会在第一次`NULL`遇到时停止：如果它接近表的开头，那么你很幸运。

有关性能详细信息，请参阅我的博客中的条目：

*   [**不同的对**](http://explainextended.com/2009/06/02/distinct-pairs/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:21:04.947

这可能会表现得更好。正如您所说，它假定名称对于给定的 ID 始终相同。

```
WITH id_list AS (SELECT DISTINCT id FROM table1)
SELECT id_list.id, (SELECT name FROM table1 WHERE table1.id = id_list.id AND rownum = 1)
  FROM id_list; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T20:49:45.583

id 是唯一的吗？`DISTINCT`如果是这样，您可以从查询中删除。如果没有 - 也许它需要一个新名称？是的，我知道，无法更改架构...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T21:02:21.750

你可以尝试类似的东西

```
Select Distinct t1.id, t2.name
FROM (Select Distinct ID From Table) As T1
INNER JOIN table t2 on t1.id=t2.id

Select distinct t1.id, t2.name from table t1
inner Join table t2 on t1.id=t2.id 
```

不确定这是否会比原来的速度慢或快，因为我不完全了解您的桌子是如何设置的。如果每个 ID 将始终具有相同的名称，并且 ID 是唯一的，那么我真的看不出不同的意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T19:34:35.250

你可以试试这个：

```
select id, max(name) from table1 group by id 
```

这肯定会使用 id 上的索引，但你必须尝试它是否执行得很快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T19:55:00.810

不想沉迷于将东西扔到墙上直到有东西粘住的做法，试试这个：

```
select id, name from table1 group by id, name 
```

我对 GROUP BY 莫名其妙地比 DISTINCT 快的记忆模糊。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-01T19:57:36.950

如果给定 id 的名称始终相同，为什么您甚至需要在子句中包含“名称”？（nm ...您想要的名称不只是检查是否存在）

```
SELECT name, id FROM table WHERE id in (SELECT DISTINCT id FROM table)? 
```

不知道有没有帮助...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-01T22:41:17.823

真正尝试与 DBA 一起解决问题。真的。尝试传达好处并减轻他们对性能下降的恐惧。

有一个开发环境/数据库来测试这些东西吗？

**数据必须有多及时？**

已经按 id 和 name 分组并带有适当索引的表的副本怎么样？可以将批处理作业配置为每晚刷新一次新表。

但如果这不成功...

将所有 id 和 name 对导出到一个备用数据库，您可以在其中对您的利益进行分组和索引，并让 DBA 保持他们所有自鸣得意的僵化状态，怎么样？

# java - Java - 四舍五入的问题

> ID：936329
> 
> 赞同：1
> 
> 时间：2009-06-01T19:24:51.293
> 
> 标签：java, ruby

我编写了一些 Java 代码来生成伪随机数，但我遇到了我认为舍入问题，使其与 Ruby 中的相同代码匹配。这是我在 Java 中所拥有的：

```
public class randTest {
  private final static Double A = Math.pow(5,13);
  private final static Integer S = 314159265;
  private final static Double minVal = Math.pow(2, -46);
  private final static Double maxVal = Math.pow(2, 46);
  private final static Double newMax = 10.0;

  private static Double r(Integer k) {
    Double powS = Math.pow(A, k) * S;
    Double xk = powS % maxVal.intValue();
    Double result = minVal * xk;
    System.out.println("k = " + k + ", pows = " + powS + ", xk = " + xk + ", result = " + result);
    return result;
  }
} 
```

在 Ruby 中也是如此（我的工作参考实现）：

```
A = 5 ** 13
S = 314159265
MIN_VAL = 2 ** -46
MAX_VAL = 2 ** 46
NEW_MAX = 10

def r(k) # was generate_random
  powS = (A ** k) * S
  xk = powS % MAX_VAL
  result = MIN_VAL * xk
  puts "k = #{k}, pows = #{powS}, xk = #{xk}, result = #{result}"
  return result
end 
```

出于某种原因，输出有很大不同（但 Ruby 是正确的）。这是我调用 r(4)：

爪哇：

```
k = 4, pows = 6.9757369880463215E44, xk = 1.512592341E9, result = 2.1495230001278287E-5 
```

红宝石：

```
k = 4, pows = 697573698804632158498861826956272125244140625, xk = 55279057169489, result = 0.785562650228954 
```

`powS`关于为什么两者都可以正确计算但不能正确计算的任何想法`xk`？请注意，在我需要使用的 Java 版本上，`maxVal.intValue()`而不是`maxVal`，否则它返回零。我也尝试用`Double`s替换`BigDecimal`s 也无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:48:29.903

调用时遇到截断错误`maxVal.intValue()`

查看 BigDecimal 和 BigInteger 以实现与您的 ruby​​ 片段相同的效果。

顺便说一句：如果您使用位于 Java 之上的[groovy](http://groovy.codehaus.org/)，那么这将使用开箱即用的 BigDecimal。

示例代码：

```
public class Rounding {
    private final static BigDecimal A = BigDecimal.valueOf(Math.pow(5, 13));
    private final static int S = 314159265;
    private final static BigDecimal minVal = BigDecimal.valueOf(Math
            .pow(2, -46));
    private final static BigDecimal maxVal = BigDecimal
            .valueOf(Math.pow(2, 46));
    private final static BigDecimal newMax = BigDecimal.valueOf(10);

    public static void main(final String[] args) {
        r(4);
    }

    private static void r(final int k) {
        final BigDecimal powS = A.pow(k).multiply(BigDecimal.valueOf(S));
        final BigDecimal xk = powS.remainder(new BigDecimal(maxVal
                .toBigInteger()));
        final BigDecimal result = minVal.multiply(xk);
        System.out.println("k = " + k + ", pows = " + powS + ", xk = " + xk
                + ", result = " + result);

    }
} 
```

产生：

```
k = 4, pows = 697573698804632158498861826956272125244140625, xk = 55279057169489, result = 0.785562650228953900455100455956 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T19:32:20.480

我的 Java 生锈了，但 intValue() 不是 32 位 int 值吗？2 ^ 46 太大而无法放入其中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T19:32:46.347

当您调用 intValue() 时，双精度值将被转换为 int。

Java 的整数 MAX_VALUE：

> 一个常量，保持 int 可以具有的最大值 2^31-1。

您的 MAX_VAL：

> 2 ** 46

即使是 long 类型也无法容纳足够大的值。我认为正如@toolkit 所说，您需要 java.math 包中的 BigInteger 类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T19:38:02.077

两件事情：

1.  在这种情况下，您将需要[BigInteger](http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html)之类的东西来确保值不会溢出其数据类型。
2.  在相关问题中，`maxVal.intValue()`返回 2147483647，远低于应有的大约 7.03E13。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T19:33:23.270

697573698804632150000000000000000000000000000
and
697573698804632158498861826956272125244140625
are not the same number. You are losing precision in Java by having such a large number, where Ruby has arbitrary precision integer arithmetic. Applying arithmetic operations to numbers that large in Java will result in [pseudo-]unpredictable results.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T19:58:21.397

问题是 Double 无法保存您尝试输入的值，因此它被截断了。

对于像这样的大值，您需要使用[java.math.BigDecimal](http://file:///D:/Documents/JDK-6-JavaDocs/docs/api/java/math/BigDecimal.html)，它允许任意大的十进制值精度。

这是使用 BigDecimal 重做的 Java 示例：

```
public class RandTest {

    private final static BigDecimal A = new BigDecimal(5).pow(13);
    private final static BigDecimal S = new BigDecimal(314159265);
    private final static BigDecimal minVal = 
         new BigDecimal(2).pow(-46, new MathContext(100));
    private final static BigDecimal maxVal = new BigDecimal(2).pow(46);
    private final static BigDecimal newMax = new BigDecimal(10.0);

    private static BigDecimal r(Integer k) {
        BigDecimal powS = A.pow(k).multiply(S);
        BigDecimal xk = powS.remainder(maxVal);
        BigDecimal result = minVal.multiply(xk);
        System.out.println("k = " + k + ", pows = " + powS + ", xk = " + xk
                + ", result = " + result);
        return result;
    }
} 
```

此版本属性返回您正在寻找的正确结果。

# asp.net - 使用接受五个字符串参数的 jquery 调用 web 服务？

> ID：936339
> 
> 赞同：0
> 
> 时间：2009-06-01T19:27:25.203
> 
> 标签：asp.net, jquery, ajax, web-services, soap

是否可以调用接受 5 个字符串参数而不通过 json 发送的 web 服务？（这是推荐的）我创建了一个带有接受 5 个字符串参数的方法的 web 服务。我有我的 jquery

```
 $.ajax({
                type: "POST",
                url: "Service.aspx/CreateClient",
                data: "{}",
                contentType: "application/json; charset=utf-8", //// ERMMM ???
                dataType: "json", // ERMMM?
                success: function(msg) {
                    alert(msg.d);
                },
                error: function() {
                    alert('error');
                }

            }); 
```

不使用 jquery 的旧方法是这样做

```
 this.para.add("Name", name);
            this.para.add("ClientNum", clnum);
            this.para.add("Email", email);
            this.para.add("Register", register);
            this.para.add("Message", message);

            SOAPClient.invoke(this.url, "MyService.aspx/CreateClient", this.para, true, this.completeDone, this); 
```

在另一端着陆并填写所有参数......

推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:29:53.480

为什么不使用查询字符串变量并避免 SOAP 协议的开销？

# windows - Windows 筛选平台标注驱动程序 - 示例、教程、帮助

> ID：936344
> 
> 赞同：9
> 
> 时间：2009-06-01T19:28:38.600
> 
> 标签：windows, language-agnostic, networking, driver

我正在尝试为家长控制程序编写[Windows 过滤平台标注驱动程序。](http://msdn.microsoft.com/en-us/library/ms796358.aspx)不幸的是，我以前从未编写过驱动程序，除非您已经了解基础知识（我猜），否则有关它的 MSDN 文档并没有太大帮助。

有谁知道关于这个主题的任何好的资源？驱动程序开发工具包中的书籍、在线示例、文档、示例？

我没有要求任何人为我进行 Google 搜索。我只需要关于这个问题的建议。如果有人曾经走过这条路或知道一个好的资源，我将不胜感激朝着正确的方向轻推；即使它只是一本关于开发 Windows 驱动程序的好书。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T20:33:30.483

OSR [（这里）](http://www.osronline.com/)是一个很好的信息资源，并且有一些有用的工具。CodeProject [（这里）](http://www.codeproject.com/index.aspx?cat=2)有几个很好的关于 WDM 和 WDF 驱动程序的系列代码。

由于 WFP 似乎适用于 Win2k8、Vista 或更高版本，因此您可以使用 WDF - 当您看到对 UMDF（用户模式）和 KMDF（内核模式）的引用时，这就是他们所说的。使用这些首字母缩略词可能会使谷歌搜索更容易。

使用 WDF 将使事情变得更容易。

在虚拟机中进行任何测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T06:28:51.663

您可以阅读[驱动程序开发](http://www.codeproject.com/Articles/9504/Driver-Development-Part-1-Introduction-to-Drivers)教程并编写一个简单的驱动程序。有我读过的最好的教程。

# php - 让mysql_fetch_assoc 自动检测返回数据类型？

> ID：936350
> 
> 赞同：8
> 
> 时间：2009-06-01T19:30:10.173
> 
> 标签：php, mysql, database, types

在 PHP 中使用 mysql_fetch_assoc 时，如何让它返回正确的数据类型？现在它似乎将所有内容都转换为字符串，我更喜欢将 Ints 保留为 Ints，并以某种方式将 Date/Time 指定为 Object 或与字符串不同。

这样做的原因是我使用 PHP 作为 Flex 应用程序的后端，而 Flex 有一些功能，例如自动检测返回类型，如果所有内容都以字符串形式出现，这些功能就不能很好地工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-09T19:42:16.583

我认为这里的一个好策略是以编程方式确定表中每一列的数据类型，并相应地转换返回的结果。这将允许您以更一致和更简单的方式与数据库交互，同时仍为您提供所需的控制，让您的变量存储正确的数据类型。

**一种可能的解决方案：**您可以使用 mysql_fetch_field() 来获取一个包含有关表列的元数据的对象，然后将您的字符串转换回所需的类型。

```
//run query and get field information about the row in the table
$meta = mysql_fetch_field($result, $i);

//get the field type of the current column
$fieldType = $meta->type 
```

一个完整的例子可以在这里找到：http: [//us2.php.net/manual/en/function.mysql-fetch-field.php](http://us2.php.net/manual/en/function.mysql-fetch-field.php)

由于 PHP 是松散类型的，因此您应该可以相对轻松地使用它。

如果您使用 OO（面向对象）技术，您可以在 setter() 方法中创建一个具有此功能的类，这样您就不必有重复的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-09T00:40:45.803

只是对mastermind202 处理更多数据类型的答案做出了**小的改进。**感谢主脑做繁重的工作！

```
function cast_query_results($rs) {
    $fields = mysqli_fetch_fields($rs);
    $data = array();
    $types = array();
    foreach($fields as $field) {
        switch($field->type) {
            case MYSQLI_TYPE_NULL:
                $types[$field->name] = 'null';
                break;
            case MYSQLI_TYPE_BIT:
                $types[$field->name] = 'boolean';
                break;
            case MYSQLI_TYPE_TINY:
            case MYSQLI_TYPE_SHORT:
            case MYSQLI_TYPE_LONG:
            case MYSQLI_TYPE_INT24:
            case MYSQLI_TYPE_LONGLONG:
                $types[$field->name] = 'int';
                break;
            case MYSQLI_TYPE_FLOAT:
            case MYSQLI_TYPE_DOUBLE:
                $types[$field->name] = 'float';
                break;
            default:
                $types[$field->name] = 'string';
                break;
        }
    }
    while($row=mysqli_fetch_assoc($rs)) array_push($data,$row);
    for($i=0;$i<count($data);$i++) {
        foreach($types as $name => $type) {
            settype($data[$i][$name], $type);
        }
    }
    return $data;
} 
```

示例用法：

```
$db = mysqli_connect(...);
$rs = mysqli_query($db, "SELECT ...");
$results = cast_query_results($rs); 
```

返回具有正确类型字段的关联行数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:01:07.567

您可以围绕 mdb2 构建一个特定于 mysql 的层，该层使用[SHOW COLUMNS](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)命令自动检测字段类型，但这会破坏使用 mdb2 的目的。

请记住，mysql 支持的整数远远超出 PHP 的范围（UNSIGNED BIGINT 是 64 位；PHP 最多支持 64 位有*符号*整数，而在 32 位平台上则更少），因此在某些情况下可能不希望自动转换. 在这些情况下，您真的希望将大整数保留为字符串形式，并使用[bcmath操作它们](http://www.php.net/bc)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-14T21:42:44.087

我想分享一个我为同样的问题编写的函数。传递查询结果`$rs`并获取转换数据的 assoc 数组作为返回：

```
function cast_query_results($rs) {
    $fields = mysqli_fetch_fields($rs);
    $data = array();
    $types = array();
    foreach($fields as $field) {
        switch($field->type) {
            case 3:
                $types[$field->name] = 'int';
                break;
            case 4:
                $types[$field->name] = 'float';
                break;
            default:
                $types[$field->name] = 'string';
                break;
        }
    }
    while($row=mysqli_fetch_assoc($rs)) array_push($data,$row);
    for($i=0;$i<count($data);$i++) {
        foreach($types as $name => $type) {
            settype($data[$i][$name], $type);
        }
    }
    return $data;
} 
```

示例用法：

```
$dbconn = mysqli_connect('localhost','user','passwd','tablename');
$rs = mysqli_query($dbconn, "SELECT * FROM Matches");
$matches = cast_query_results($rs);
// $matches is now a assoc array of rows properly casted to ints/floats/strings 
```

# c# - 无法加载文件或程序集

> ID：936355
> 
> 赞同：11
> 
> 时间：2009-06-01T19:31:02.950
> 
> 标签：c#, .net, nhibernate

我正在开发一个使用`SqlServerCe`with的系统`NHibernate`。从我的驱动程序中，如果我将`System.Data.SqlServerCe`程序集添加为参考，我可以很好地创建和运行对数据库的查询。但是，当尝试使用`NHibernate`时，我得到以下异常：

> mscorlib.dll 中发生了“System.IO.FileNotFoundException”类型的第一次机会异常附加信息：无法加载文件或程序集“System.Data.SqlServerCe”或其依赖项之一。该系统找不到指定的文件。

我已经将异常追溯到对 的调用`Assembly.Load("System.Data.SqlServerCe")`，这似乎应该可以工作。该`System.Data.SqlServerCe`程序集在 GAC 中（我也尝试将其添加为本地引用`CopyLocal=true`，但无济于事），我可以很好地使用它的成员，那么为什么我不能显式加载它呢？当我在 Reflector 中打开程序集时，它无法加载`System.Transactions`引用（我也尝试将其添加为本地引用，但同样无济于事），因此加载该程序集可能是问题所在，而不是`System.Data.SqlServerCe assembly`.

这是个常见的问题吗？可能是系统配置错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T22:42:38.053

显然，这可以通过在 app.config 文件中添加 <qualifyAssembly> 元素来解决。添加以下内容使我的应用程序运行顺利：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <qualifyAssembly partialName="System.Data.SqlServerCe" fullName="System.Data.SqlServerCe, Version=3.5.1.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </assemblyBinding>
</runtime> 
```

谢谢！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-06T18:23:27.287

这很可能与某些系统（错误）配置有关。

但是，按照设计，SQL Server CE 只是一个单独的 DLL，它可能与您的产品一起提供。
这意味着您只需在 的引用属性中设置`Copy local`为，就完成了。`True``System.Data.SqlServerCe`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-02T19:21:43.433

我有一个类似的问题。我犯的错误是我试图执行 ../obj/x86/Release 中的 .exe，而我应该执行 ../bin/Release 中的 .exe。（我是 C# 的绝对新手）。

（我还注意到在这个 ../bin/Release 目录中，引用的 .dll 文件被复制到本地。）

# php - PHP XML 简单加载

> ID：936356
> 
> 赞同：1
> 
> 时间：2009-06-01T19:31:06.177
> 
> 标签：php, jquery, xml, lightbox

我有一个灯箱目前正在工作 www.idgc.ca/web-design-samples.php 但是当我将整个页面转换为简单的 XML www.idgc.ca/web-design-samples-testing.php 时它停止工作。 ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T19:43:09.790

`<a>`在第二个示例中，标签之间有空格`<img>`，灯箱可能正在寻找第一个子`<a>`节点以获取图像 URL，它（在第二个示例中）是文本节点而不是图像标签。

这只是一个猜测。

# jquery - 检查 Jquery ajax 加载成功

> ID：936357
> 
> 赞同：6
> 
> 时间：2009-06-01T19:31:12.107
> 
> 标签：jquery, ajax

我一直在使用[它](http://docs.jquery.com/Ajax/load)来加载另一个页面，并且只是使用他们的示例：

```
$("#links").load("/Main_Page #jq-p-Getting-Started li"); 
```

但是，我想在加载成功时运行一个函数，如果失败则运行另一个函数，不幸的是回调上的描述说：

> ajax 请求完成时调用的函数（不一定成功）。

如何确保加载成功？

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-01T19:36:26.977

检查响应的[文本状态](http://docs.jquery.com/Ajax/load)。

```
$("#links").load("/Main_Page #jq-p-Getting-Started li", 
  function (responseText, textStatus, XMLHttpRequest) {
    if (textStatus == "success") {
         // all good!
    }
    if (textStatus == "error") {
         // oh noes!
    }
  } 
```

为了解决这个问题：

**[`success`](http://jsbin.com/ageju)**和的 JSBin 示例**[`fail`](http://jsbin.com/arite)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T22:15:25.270

您可以尝试使用更详细的 $.ajax() 方法调用。这将使您对 AJAX 调用进行更细粒度的控制（但它也需要比简单的 .load() 更多的工作。）它将允许您根据调用是否返回成功或错误来调用不同的函数。

查看：[http](http://docs.jquery.com/Ajax/jQuery.ajax#options) ://docs.jquery.com/Ajax/jQuery.ajax#options以获取有关此功能的文档。如果单击该页面上的“选项”选项卡，您将获得可以传递给 $.ajax() 函数的参数的完整列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T19:36:47.930

回调的第二个参数是请求的字符串状态值，它将是`"beforeSend"`、`"success"`、`"complete"`和之一`"error"`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-04T06:56:04.350

我使用这个功能，它对我有用：

```
$.ajax({
   url: "demo_test.txt", 
   success: function(result){
       location:reload();
   }
}); 
```

# asp.net - IIS 升级不 向后兼容？

> ID：936367
> 
> 赞同：1
> 
> 时间：2009-06-01T19:33:09.560
> 
> 标签：asp.net, iis, vbscript, iis-5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:55:38.313

我知道 ASP.Net 有一个 ValidateRequest 属性，它不允许某些地方的某些字符来防止某些黑客攻击。这是默认开启的。而且我相信 IIS 7（也可能是 6）在某种程度上将所有站点都视为 ASP.Net 应用程序（使用 web.config 文件）。这不是一个经过验证的事实，但即使我正在测试一个仅包含 .html 文件的站点，我也会显示 web.config 文件。

在 ASP.Net 中，您可以在 web.config 文件中将 ValidateRequest=true（默认）属性更改为 ValidateRequest=false。这可能会阻止服务器端验证的发生并允许您的默认设置通过。

添加`<pages validateRequest="false" />`到 web.config 的 system.web 部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T19:57:42.707

它可能将尖括号视为潜在的跨站点脚本攻击 - 默认情况下，这些天 asp.net（我知道您使用的是 ASP，而不是 ASP.NET）会在您提交时抛出关于“潜在危险回发”的异常带尖括号的字符串。

是否有可能通过安装 VS（以及因此的 DotNet 框架）将托管这些页面的网站设置为使用 ASP.NET？

您是否尝试过从该站点删除 ASP.NET 注册？您可以通过使用“-ua”开关运行 aspnet_regiis 来做到这一点。此命令行工具可在以下位置找到：

> C:\Windows\Microsoft.NET\Framework[vX.YYY]\

其中 X.YYY 是 1.1.4322 或 2.0.50727

# django - 预填充 Django（非模型）表单

> ID：936376
> 
> 赞同：65
> 
> 时间：2009-06-01T19:35:29.227
> 
> 标签：django, django-forms

我正在尝试根据一些信息在我的 django 表单中预填充数据，但不使用 ModelForm，所以我不能只设置实例。

这似乎应该很容易，但由于某种原因，我找不到任何文档告诉我如何做到这一点。这是我的表格：

```
class MyForm(forms.Form):
  charfield1 = forms.CharField(max_length=3)
  charfield2 = forms.CharField(max_length=3)
  choicefield = forms.ModelChoiceField(MyModel.objects.all()) 
```

我试着做：

```
form = MyForm()
form.charfield1 = "foo"
form.charfield2 = "bar"
# a model choice field
form.choicefield = MyModel.objects.get(id=3) 
```

这是行不通的。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-06-01T19:42:34.610

尝试：

```
form = MyForm({'charfield1': 'foo', 'charfield2': 'bar'}) 
```

对象的构造函数`Form`可以采用字段值的字典。这将创建一个绑定表单，可用于验证数据并将表单呈现为 HTML 并显示数据。有关更多详细信息，请参阅[表单 API](https://docs.djangoproject.com/en/1.11/ref/forms/api/#bound-and-unbound-forms)文档。

**编辑：**

为了完整起见，如果您不想绑定表单，而只想为某些字段声明初始值，则可以改用以下内容：

```
form = MyForm(initial={'charfield1': 'foo', 'charfield2': 'bar'}) 
```

[有关详细信息，请参阅初始值](https://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)的文档。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-06-01T20:31:54.887

有两种填充 Django 表单的方法。

第一种是在实例化字典时将字典作为第一个参数传递（或将其作为`data`kwarg 传递，这是同一件事）。当您想使用 POST 数据来填充和验证表单时，您会执行此操作。

```
data_dict = {'charfield1': 'data1', 'charfield2': 'data2', 'choicefield': 3}
form = MyForm(data_dict) 
```

但是，这将触发表单上的*验证*，因此只有在您实际传递有效且完整的数据开始时才有效 - 否则您将从错误开始。

填充表单的另一种方法是使用`initial`参数（[在此处](http://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)记录）。这会为表单字段提供初始值，但不会*触发*验证。因此，例如，如果您不填写所有值，则它是合适的。

```
form = MyForm(initial=data_dict) 
```

要通过 填充选择字段`initial`，请使用 pk 值。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-20T01:52:21.670

您可以使用 model_to_dict() 将实例转换为字典，然后用它填充表单。像这样的东西应该工作：

```
from django.forms.models import model_to_dict
...
my_obj = MyModel.objects.get(abc=123)
form = MyForm(initial=model_to_dict(my_obj)) 
```

注意：我使用的是 django 1.3 版

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-08-27T14:26:54.983

对于它的价值，`FormView`基于类的视图方法将覆盖`FormView`'`get_initial`函数。返回用于实例化表单`get_initial`的初始关键字参数。`get_form_kwargs`

文件：

*   对于`get_initial`,[这里](http://ccbv.co.uk/projects/Django/1.11/django.views.generic.edit/FormView/#get_initial),
*   对于`get_form_kwargs`，[这里](http://ccbv.co.uk/projects/Django/1.11/django.views.generic.edit/FormView/#get_form_kwargs)。

示例代码：

```
from django.views.generic.edit import FormView

class MyFormView(FormView):

    def get_initial(self):
        initial = super(MyFormView, self).get_initial()
        # update initial field defaults with custom set default values:
        initial.update({'charfield1': 'foo', 'charfield2': 'bar'})
        return initial 
```

# java - 泛型类中的静态方法？

> ID：936377
> 
> 赞同：210
> 
> 时间：2009-06-01T19:35:34.233
> 
> 标签：java, generics, static-methods

在Java中，我想要一些东西：

```
class Clazz<T> {
  static void doIt(T object) {
    // ...
  }
} 
```

但我明白了

```
无法对非静态类型 T 进行静态引用
```

除了基本用途之外，我不了解泛型，因此对此没有多大意义。我无法在互联网上找到有关该主题的大量信息，这无济于事。

有人可以通过类似的方式澄清这种使用是否可能吗？另外，为什么我最初的尝试没有成功？

* * *

## 回答 #1

> 赞同：295
> 
> 时间：2009-06-01T21:43:37.347

您不能在静态方法或静态字段中使用类的泛型类型参数。类的类型参数仅在实例方法和实例字段的范围内。对于静态字段和静态方法，它们在类的所有实例之间共享，甚至是不同类型参数的实例，因此显然它们不能依赖于特定的类型参数。

您的问题似乎不需要使用类的类型参数。如果您更详细地描述您正在尝试做的事情，也许我们可以帮助您找到更好的方法来做到这一点。

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-06-01T19:41:18.950

`T`在您实例化一个类型之前，Java 不知道是什么。

也许你可以通过调用来执行静态方法，`Clazz<T>.doit(something)`但听起来你不能。

另一种处理方式是将类型参数放在方法本身中：

```
static <U> void doIt(U object) 
```

这不会让你对 U 有正确的限制，但总比没有好....

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2011-10-25T13:50:00.207

我遇到了同样的问题。`Collections.sort`我通过下载java 框架中的源代码找到了答案。我使用的答案是将`<T>`泛型放在方法中，而不是放在类定义中。

所以这有效：

```
public class QuickSortArray  {
    public static <T extends Comparable> void quickSort(T[] array, int bottom, int top){
//do it
}

} 
```

当然，在阅读了上面的答案后，我意识到如果不使用泛型类，这将是一个可以接受的替代方案：

```
public static void quickSort(Comparable[] array, int bottom, int top){
//do it
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-04-22T13:05:31.440

我认为这种语法还没有被提及（如果你想要一个没有参数的方法）：

```
class Clazz {
  static <T> T doIt() {
    // shake that booty
  }
} 
```

和电话：

```
String str = Clazz.<String>doIt(); 
```

希望这对某人有所帮助。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-05-13T09:25:44.270

在声明方法时，可以使用泛型方法的语法来做你想做的事情`doIt()`（注意在方法签名中添加了`<T>`between`static`和）：`void``doIt()`

```
class Clazz<T> {
  static <T> void doIt(T object) {
    // shake that booty
  }
} 
```

我让 Eclipse 编辑器无错误地接受上述代码`Cannot make a static reference to the non-static type T`，然后将其扩展为以下工作程序（完成了一些适合年龄的文化参考）：

```
public class Clazz<T> {
  static <T> void doIt(T object) {
    System.out.println("shake that booty '" + object.getClass().toString()
                       + "' !!!");
  }

  private static class KC {
  }

  private static class SunshineBand {
  }

  public static void main(String args[]) {
    KC kc = new KC();
    SunshineBand sunshineBand = new SunshineBand();
    Clazz.doIt(kc);
    Clazz.doIt(sunshineBand);
  }
} 
```

当我运行它时，它将这些行打印到控制台：

> 动摇那个战利品'class com.eclipseoptions.datamanager.Clazz$KC'！！！
> 动摇那个战利品'class com.eclipseoptions.datamanager.Clazz$SunshineBand'！！！

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-10-23T10:13:11.593

错误中正确提到了它：您不能对非静态类型 T 进行静态引用。原因是类型参数`T`可以被任何类型参数替换，例如`Clazz<String>`等`Clazz<integer>`。但是静态字段/方法由所有非静态类型共享- 类的静态对象。

以下摘录摘自[文档](https://docs.oracle.com/javase/tutorial/java/generics/restrictions.html)：

> 类的静态字段是类的所有非静态对象共享的类级变量。因此，不允许使用类型参数的静态字段。考虑以下类：
> 
> ```
> public class MobileDevice<T> {
>     private static T os;
> 
>     // ...
> } 
> ```
> 
> 如果允许类型参数的静态字段，那么下面的代码会被混淆：
> 
> ```
> MobileDevice<Smartphone> phone = new MobileDevice<>();
> MobileDevice<Pager> pager = new MobileDevice<>();
> MobileDevice<TabletPC> pc = new MobileDevice<>(); 
> ```
> 
> 因为静态字段os是phone、pager、pc共享的，那么os的实际类型是什么？它不能同时是智能手机、寻呼机和平板电脑。因此，您不能创建类型参数的静态字段。

[正如克里斯在他的回答](https://stackoverflow.com/a/7890292)中正确指出的那样，在这种情况下，您需要将类型参数与方法一起使用，而不是与类一起使用。你可以这样写：

```
static <E> void doIt(E object) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-10T07:21:07.343

像下面这样的东西会让你更接近

```
class Clazz
{
   public static <U extends Clazz> void doIt(U thing)
   {
   }
} 
```

编辑：更详细的更新示例

```
public abstract class Thingo 
{

    public static <U extends Thingo> void doIt(U p_thingo)
    {
        p_thingo.thing();
    }

    protected abstract void thing();

}

class SubThingoOne extends Thingo
{
    @Override
    protected void thing() 
    {
        System.out.println("SubThingoOne");
    }
}

class SubThingoTwo extends Thingo
{

    @Override
    protected void thing() 
    {
        System.out.println("SuThingoTwo");
    }

}

public class ThingoTest 
{

    @Test
    public void test() 
    {
        Thingo t1 = new SubThingoOne();
        Thingo t2 = new SubThingoTwo();

        Thingo.doIt(t1);
        Thingo.doIt(t2);

        // compile error -->  Thingo.doIt(new Object());
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-07-16T09:59:15.990

由于静态变量由类的所有实例共享。例如，如果您有以下代码

```
class Class<T> {
  static void doIt(T object) {
    // using T here 
  }
} 
```

T 仅在创建实例后可用。但是静态方法甚至可以在实例可用之前使用。因此，不能在静态方法和变量中引用泛型类型参数

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-01T19:43:23.687

当你为你的类指定一个泛型类型时，JVM 只知道它有你的类的一个实例，而不是定义。每个定义只有参数化类型。

泛型就像 C++ 中的模板一样工作，因此您应该首先实例化您的类，然后使用指定类型的函数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-05-04T02:00:41.843

简而言之，它的发生是因为泛型的“擦除”属性。这意味着虽然我们定义了`ArrayList<Integer>`and `ArrayList<String>`，但在编译时它仍然是两种不同的具体类型，但在运行时 JVM 会擦除泛型类型和只创建一个 ArrayList 类而不是两个类。因此，当我们为泛型定义静态类型方法或任何东西时，它由该泛型的所有实例共享，在我的示例中，它由`ArrayList<Integer>`和共享。这`ArrayList<String>`就是你得到错误的原因。类的泛型类型参数不是允许在静态上下文中！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-12T16:06:37.550

@BD at Rivenhill：自从去年这个老问题重新引起人们的注意，让我们继续讨论一下，只是为了讨论。您的方法的主体`doIt`根本不做任何`T`特定的事情。这里是：

```
public class Clazz<T> {
  static <T> void doIt(T object) {
    System.out.println("shake that booty '" + object.getClass().toString()
                       + "' !!!");
  }
// ...
} 
```

因此，您可以完全删除所有类型变量，只需编写代码

```
public class Clazz {
  static void doIt(Object object) {
    System.out.println("shake that booty '" + object.getClass().toString()
                       + "' !!!");
  }
// ...
} 
```

好的。但是让我们回到更接近最初的问题。类声明中的第一个类型变量是多余的。只需要方法中的第二个。我们又来了，但这还不是最终的答案：

```
public class Clazz  {
  static <T extends Saying> void doIt(T object) {
    System.out.println("shake that booty "+ object.say());
  }

  public static void main(String args[]) {
    Clazz.doIt(new KC());
    Clazz.doIt(new SunshineBand());
  }
}
// Output:
// KC
// Sunshine

interface Saying {
      public String say();
}

class KC implements Saying {
      public String say() {
          return "KC";
      }
}

class SunshineBand implements Saying {
      public String say() {
          return "Sunshine";
      }
} 
```

但是，这没什么大惊小怪的，因为以下版本的工作方式相同。它所需要的只是方法参数上的接口类型。任何地方都看不到类型变量。这真的是最初的问题吗？

```
public class Clazz  {
  static void doIt(Saying object) {
    System.out.println("shake that booty "+ object.say());
  }

  public static void main(String args[]) {
    Clazz.doIt(new KC());
    Clazz.doIt(new SunshineBand());
  }
}

interface Saying {
      public String say();
}

class KC implements Saying {
      public String say() {
          return "KC";
      }
}

class SunshineBand implements Saying {
      public String say() {
          return "Sunshine";
      }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-16T23:15:36.357

T 不在静态方法的范围内，因此您不能在静态方法中使用 T 。您需要为静态方法定义不同的类型参数。我会这样写：

```
class Clazz<T> {

  static <U> void doIt(U object) {
    // ...
  }

} 
```

例如：

```
public class Tuple<T> {

    private T[] elements;

    public static <E> Tuple<E> of(E ...args){
        if (args.length == 0) 
             return new Tuple<E>();
        return new Tuple<E>(args);
    }

    //other methods
} 
```

# java - Hibernate - 使用集合在多个连接中进行选择

> ID：936380
> 
> 赞同：4
> 
> 时间：2009-06-01T19:35:41.770
> 
> 标签：java, hibernate

当Select包含在许多集合中的连接时，我很难获得Hibernate Select以返回正确填充的对象图。

例如：

```
 String sql = "select distinct changeset " +
            "from Changeset changeset " +
            "join fetch changeset.changeEntries as changeEntry " +
            "join fetch changeEntry.repositoryEntity as repositoryEntity " +
            "join fetch repositoryEntity.repository as repository " +
            "where repository.connectionName = :connectionName"; 
```

*   一个变更集有很多变更条目
*   一个 ChangeEntry 有一个 RepositoryEntity
*   一个 RepositoryEntity 有一个 Repository

上面的语句返回正确的数据，但对象图没有正确填充——即，每个变更集包含每个变更条目，而不仅仅是它自己的子项。

这是这两个类的相关片段：

```
public class Changeset {

    @NotNull
    @OneToMany(mappedBy="changeset", targetEntity=ChangeEntry.class, cascade={CascadeType.ALL }, fetch=FetchType.EAGER )
    private Set<IChangeEntry> changeEntries; 
```

和...

```
public class ChangeEntry {

    @NotNull
    @ManyToOne(targetEntity=Changeset.class)
    @ForeignKey(name="FkChangeEntryChangeset")
    private IScmChangeset changeset;

    @NotNull
    @ManyToOne(targetEntity=RepositoryEntity.class, cascade=CascadeType.ALL,fetch=FetchType.EAGER)
    @ForeignKey(name="FkChangeEntryRepoEntity")
    private IRepositoryEntity repositoryEntity; 
```

非常感谢任何帮助

问候

马蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:24:15.010

马蒂：

我有同样的问题，我找不到合适的解决方案。您可以使用简单的结果转换器来控制返回的对象数量：

```
CriteriaSpecification.ROOT_ENTITY
CriteriaSpecification.DISTINCT_ROOT_ENTITY 
```

但是这些对象将始终包含其子项的完整结果。我确实遇到过一篇优秀的文章，该文章使用了 DTO 模式以及投影和`aliasToBean`变压器。

这里是：[http ://swik.net/Hibernate/Hibernate+GroupBlog/Hibernate+3.2:+Transformers+for+HQL+and+SQL/cmxs](http://swik.net/Hibernate/Hibernate+GroupBlog/Hibernate+3.2:+Transformers+for+HQL+and+SQL/cmxs)

这对我来说效果很好。最大的问题是您必须创建这些扁平化的 DTO 对象。对我来说，这不是什么大问题，因为我专门的 DTO 对象用于搜索结果并且非常可重用，而且我不需要很多。

我知道这并不能直接解决您的问题，如果您确实找到了实现目标的方法，请更新帖子，因为我很想看到解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:12:39.500

按 ID 加载一个实体是否正常工作？如果没有 - 请继续阅读。:-)

我不确定使用`@ForeignKey`是否足够。尝试将 a 添加`@JoinColumn`到关系的多方面。例如

```
@NotNull
@ManyToOne(targetEntity=RepositoryEntity.class, cascade=CascadeType.ALL,fetch=FetchType.EAGER)
@ForeignKey(name="FkChangeSet")
@JoinColumn(name = "CHANGESET_ID", referencedColumnName = "ID")
private Changeset changeset; 
```

注意：我刚刚看到，您正在显示 的映射信息`Repository`，但我认为 for`Changeset`看起来相似。

# python - 是否有支持 xmltype 列的 Python 的 Oracle 包装器？

> ID：936381
> 
> 赞同：5
> 
> 时间：2009-06-01T19:36:17.760
> 
> 标签：python, xml, oracle, xmltype

似乎 cx_Oracle 没有。

任何其他使用 Oracle 和 Python 处理 xml 的建议都值得赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:00:08.393

我设法用 cx_Oracle 做到了这一点。

我在语句中使用了 sys.xmltype.createxml() 函数，该语句将行插入带有 XMLTYPE 字段的表中；然后我使用 prepare() 和 setinputsizes() 来指定我用于 XMLTYPE 字段的绑定变量是 cx_Oracle.CLOB 类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-18T15:13:49.273

我设法通过将 XMLElement 调用包装在对以下内容的调用中来使其工作`XMLType.GetClobVal()`：

例如：

```
select xmltype.getclobval(xmlelement("rowcount", count(1)))
from... 
```

还不知道这些限制，但它让我摆脱了麻烦。在 Oracle 网站上找到相关信息： [掌握 Oracle+Python，第 1 部分：查询最佳实践](http://www.oracle.com/technology/pub/articles/prez-python-queries.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T19:41:55.203

（编辑删除了对非 Oracle Python DB-API 模块的提及，并添加了一些更相关且希望有用的信息）。

不知道有任何替代方案`cx_oracle`（正如 DCOracle2 作者[所说](http://www.zope.org/Members/matt/dco2/)，“DCOracle2 目前未维护，没有可用的支持。”所以它不是真正的替代方案）。

然而，Oracle 自己网站上最近的[一篇文章](http://www.oracle.com/technology/pub/articles/vasiliev-python-persistence.html)断言（至少对于 Oracle 10g XE 等最近的版本——可能还有最近的 cx_oracle 版本）Python 可以使用 Oracle 的 XML 支持——我不知道那篇文章中的示例是否可以帮助您解决问题，但我当然希望如此！

# css - 如何更改 YUI 工具提示的 CSS 样式？

> ID：936385
> 
> 赞同：1
> 
> 时间：2009-06-01T19:36:53.123
> 
> 标签：css, yui, tooltip

我在 YUI 页面上看到了一个关于更改面板样式的示例。但我想更改我网站上所有工具提示（而不是其他面板）的样式。我所有的工具提示都不在一个特定的 DIV 中，因此在 div 中更改 YUI 面板样式对我不起作用。

有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:40:32.757

看起来 YUI 工具提示将该类添加`yui-tt`到所有工具提示中。您可以通过将其用作共同祖先来设置工具提示的样式，即

```
.yui-tt .bd {
    /* Styles here... */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T20:27:50.117

我将配置器的样式表（已经包含默认皮肤（sam.css））加载到我的应用程序的头部，然后是我自己的样式，因此它们可以立即渲染。但是，正如您所提到的，YUI 加载器随后将覆盖您的样式。

如果你加载了很多模块或者做了很多样式声明并且不想在每个之后都写 !important，添加选项

`skin : {defaultSkin: ''}`

到您的装载机配置。这也将为您的用户节省一点带宽并加快渲染速度。

另请注意，IE6 无法识别 !important，因此它不适用于该浏览器。

希望有帮助。

# ruby-on-rails - 型号名称冲突

> ID：936388
> 
> 赞同：3
> 
> 时间：2009-06-01T19:37:20.907
> 
> 标签：ruby-on-rails, model

我有一个名为 Filter 的模型，但由于从 2.0.3 重新组织过滤器的变化，它与

```
ActionController::Filters::Filter (class) 
```

当我尝试找到过滤器时，在我的 filters_controller.rb 中

```
Filter.find(:id) 
```

因为 rails 是在推断`ActionController::Filters::Filter`类而不是我的模型类过滤器。除了重命名我的模型之外，还有其他解决方法吗？

顺便说一句：如果我`ActiveRecord::Base::Filter.find(:id)`用来加载我的过滤器对象，它可以工作，但我不太确定这样做是否有任何不可预见的影响，当 rails 尝试卸载/重新加载常量时。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T11:29:52.923

处理此问题的最安全方法是重命名您的模型。否则，您将冒着“聪明”的风险，并在以后很难调试时被此咬伤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-09T20:27:53.763

我几乎错过了你的评论，所以回答你自己的问题。

```
::Filter.find() 
```

# multithreading - Java EE webapps 中的线程

> ID：936390
> 
> 赞同：2
> 
> 时间：2009-06-01T19:37:39.427
> 
> 标签：multithreading, jakarta-ee

我很好奇以下概念通常如何在 Java EE 容器中执行，是每个请求创建一个实例，还是一个实例服务所有请求？

*   小服务程序
*   标签

我想知道这一点，因为最近我在自定义标签中使用了很多 StringBuffers，避免使用 StringBuilder，因为它不是线程安全的。我想确定这些东西是如何工作的，这样我就可以编写更好的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T19:42:39.367

两者都是正确的。容器可以为新请求重用旧实例，甚至在要处理更多请求时创建新实例。

使用 StringBuilder 应该是安全的，只要它的使用不跨越实例边界（通过静态使用、返回 StringBuilder 等）。因此，如果您在函数/方法中使用它来创建字符串输出，那么这样做是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:41:03.443

一些应用服务器实现了线程池，每个线程将执行一定数量的请求，并根据需要在它们之间切换负载。更简单的引擎将为每个请求假脱机一个线程。但是，如果您从不同时从多个线程访问您的 StringBuilder，那么您应该永远不会遇到线程安全方面的问题。

# windows - 在本地 NTFS 驱动器上查找回收站

> ID：936397
> 
> 赞同：3
> 
> 时间：2009-06-01T19:40:52.273
> 
> 标签：windows, winapi, filesystems, ntfs, recycle-bin

我正在尝试编写一些简单的代码，这些代码将返回本地驱动器上回收站的目录。似乎这很简单——应该是谷歌上的一千个答案。还没找到:(

我发现 FAT 和 NTFS 驱动器具有不同的基本名称（RECYCLED 和 RECYCLER）。我发现'the'回收站是一个虚拟文件夹，它结合了机器上所有驱动器的回收站。

我还没有找到一种找到 C: 驱动器的回收站目录的方法——即使在越南语（或任何其他非英语）机器上也是如此。（我找不到任何帖子表明“回收站”是否国际化）

谁能给我一个明确的答案？

谢谢

更新：了解`CSIDL_BITBUCKET`和使用它的功能。从我读过的所有内容来看，它指向一个*虚拟*目录，该目录是该用户在所有驱动器上删除的所有文件的联合。寻找物理回收站目录（据我所知，在我的 Vista 上，它似乎是 C:\$Recycle.Bin）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T10:07:52.543

Raymond Chen 给出了答案——[我怎么知道一个目录真的是一个回收站](https://blogs.msdn.com/oldnewthing/archive/2008/09/18/8956382.aspx)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:58:59.173

使用 Raymond Chen 的建议和其他人的技术（不记得我在哪里找到它）我提出了一个函数，它将在驱动器上找到回收站目录。该函数循环遍历根目录中的目录，查看隐藏和/或系统目录。当它找到一个时，它会检查子子目录以查找具有 CLSID_Recycle Bin 的子目录。

请注意，我在下面包含了两个 GetFolderCLSID 函数。Raymond Chen 的比较简单，但它不适用于 Windows 2000。另一种实现较长，但似乎可以在任何地方使用。

调用如下： CString recycleDir = FindRecycleBinOnDrive(L"C:\");

```
CString FindRecycleBinOnDrive(LPCWSTR path)
{
    CString search;
    search.Format(L"%c:\\*", path[0]);
    WIN32_FIND_DATA fd = {0};
    HANDLE fHandle = FindFirstFile(search, &fd);
    while(INVALID_HANDLE_VALUE != fHandle)
    {
        if(FILE_ATTRIBUTE_DIRECTORY == (fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) //only check directories
        {
            if(0 != (fd.dwFileAttributes & (FILE_ATTRIBUTE_SYSTEM | FILE_ATTRIBUTE_HIDDEN))) //only check hidden and/or system directories
            {
                //the recycle bin directory itself won't be marked, but a SID-specific child directory will, so now look at them
                CString childSearch;
                childSearch.Format(L"%c:\\%s\\*", path[0], fd.cFileName);
                WIN32_FIND_DATA childFD = {0};
                HANDLE childHandle = FindFirstFile(childSearch, &childFD);
                while(INVALID_HANDLE_VALUE != childHandle)
                {
                    if((FILE_ATTRIBUTE_DIRECTORY == (childFD.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) && //only check directories
                        (childFD.cFileName[0] != L'.')) //don't check . and .. dirs
                    {
                        CString fullPath;
                        fullPath.Format(L"%c:\\%s\\%s", path[0], fd.cFileName, childFD.cFileName);
                        CLSID id = {0};
                        HRESULT hr = GetFolderCLSID(fullPath, id);
                        if(SUCCEEDED(hr))
                        {
                            if(IsEqualGUID(CLSID_RecycleBin, id))
                            {
                                FindClose(childHandle);
                                FindClose(fHandle);
                                //return the parent (recycle bin) directory
                                fullPath.Format(L"%c:\\%s", path[0], fd.cFileName);
                                return fullPath;
                            }
                        }
                        else
                        {
                            Log(logERROR, L"GetFolderCLSID returned %08X for %s", hr, fullPath);
                        }
                    }

                    if(FALSE == FindNextFile(childHandle, &childFD))
                    {
                        FindClose(childHandle);
                        childHandle = INVALID_HANDLE_VALUE;
                    }
                }
            }
        }
        if(FALSE == FindNextFile(fHandle, &fd))
        {
            FindClose(fHandle);
            fHandle = INVALID_HANDLE_VALUE;
        }
    }
    _ASSERT(0);
    return L"";
}

//Works on Windows 2000, and even as Local System account
HRESULT GetFolderCLSID(LPCWSTR path, CLSID& pathCLSID)
{
    LPMALLOC pMalloc = NULL;
    HRESULT hr = 0;
    if (SUCCEEDED(hr = SHGetMalloc(&pMalloc))) 
    {
        LPSHELLFOLDER pshfDesktop = NULL;
        if (SUCCEEDED(hr = SHGetDesktopFolder(&pshfDesktop))) 
        {
            LPITEMIDLIST pidl = NULL;
            DWORD dwAttributes = SFGAO_FOLDER;
            if (SUCCEEDED(hr = pshfDesktop->ParseDisplayName(NULL, NULL, (LPWSTR)path, NULL, &pidl, &dwAttributes))) 
            {
                LPPERSIST pPersist = NULL;
                if (SUCCEEDED(hr = pshfDesktop->BindToObject(pidl, NULL, IID_IPersist, (LPVOID *) &pPersist))) 
                {
                    hr = pPersist->GetClassID(&pathCLSID); 
                    pPersist->Release();
                } 
                pMalloc->Free(pidl);
            } 
            pshfDesktop->Release();
        } 
        pMalloc->Release();
    }
    return hr;
}

//Not supported on Windows 2000 since SHParseDisplayName wasn't implemented then
//HRESULT GetFolderCLSID(LPCWSTR pszPath, CLSID& pathCLSID)
//{
//  SHDESCRIPTIONID did = {0};
//  HRESULT hr = 0;
//  LPITEMIDLIST pidl = NULL;
//  if (SUCCEEDED(hr = SHParseDisplayName(pszPath, NULL, &pidl, 0, NULL))) //not supported by Windows 2000
//  {
//      IShellFolder *psf = NULL;
//      LPCITEMIDLIST pidlChild = NULL;
//      if (SUCCEEDED(hr = SHBindToParent(pidl, IID_IShellFolder, (void**)&psf, &pidlChild))) 
//      {
//          hr = SHGetDataFromIDList(psf, pidlChild, SHGDFIL_DESCRIPTIONID, &did, sizeof(did));
//          psf->Release();
//          pathCLSID = did.clsid;
//      }
//      CoTaskMemFree(pidl);
//  }
//  return hr;
//} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-09T21:59:57.873

有点晚了，但也许迟到总比没有好......

在调试 shell32.dll 之后，我发现对于每个版本的 windows，回收路径都是硬编码的，而且还取决于该驱动器的文件系统。我已经在 Windows XP、Vista 和 Windows7 上对此进行了测试：

设 X: 为我们要获取回收站路径的驱动器，设 SID 为当前用户的 SID，则：

```
 switchif(OsType) {
        case WindowsXP:
        {
            if(PartitionType("X:") == NTFS)
            {
                printf("Path is: X:\\Recycler\\SID\\");
            }
            else
            {
                printf("Path is X:\\RECYCLED\\");
            }
        }

        case WindowsVista:
        case Windows7:
        {
            if(PartitionType("X:") == NTFS)
            {
                printf("Path is: X:\\$Recycle.bin\\SID\\");
            }
            else
            {
                printf("Path is X:\\$RECYCLE.BIN\\");
            }
        }
    } 

```

一篇 wiki 文章提供了相同的事实： [http ://en.wikipedia.org/wiki/Recycle_Bin_%28Windows%29](http://en.wikipedia.org/wiki/Recycle_Bin_%28Windows%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T19:51:30.740

在 Win32 中，使用[SHGetSpecialFolderLocation](http://msdn.microsoft.com/en-us/library/bb762203(VS.85).aspx)。[将CSIDL_BITBUCKET](http://msdn.microsoft.com/en-us/library/bb762494.aspx)作为 CDIL 参数传递。

# javascript - 我应该链接到 Google API 的 JS 库云吗？

> ID：936399
> 
> 赞同：32
> 
> 时间：2009-06-01T19:41:03.757
> 
> 标签：javascript, jquery, dependencies

我正在寻找从 Google API 的云中提取 jQuery 和其他 JS 库的优缺点，而不是直接下载文件和部署。

你说什么？

* * *

### 我的决定

lib 已经缓存在用户系统上的可能性对我来说是最重要的因素，所以我将使用指向 googleapis.com 的永久链接（例如 ajax.googleapis.com/ajax/libs/...）。我在这里同意其他人的观点，即失去对谷歌服务器云的访问权是一个最小的问题。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-01T20:00:39.190

### 骗局

*   被美国禁运的国家（例如伊朗）的用户不会得到谷歌的回应

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-06-01T19:44:30.457

优点：它可能已经缓存在用户的系统上。谷歌有很大的管道。您无需为带宽付费。

缺点：您现在有两种不同的方式使您的网站变得不可用：您的服务器上的服务中断或 Google 的服务器上的一种服务中断。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-01T19:57:16.343

我一直在研究 jQuery 的 Google 加载器的实际性能，特别是，这就是我发现的：

1.  Google 的服务器快速且可靠。
2.  他们从 CDN 提供服务，这意味着如果您有很多海外用户，他们将获得*更好的*加载时间。
3.  他们*不*提供压缩文件。所以他们提供的字节数比他们需要的多得多。

如果你知道你在 Apache、Lighttpd 或任何你正在使用的文件中做什么，你可以像谷歌一样设置你的缓存头，并通过你自己的服务来显着减少最终用户必须下载的数据量服务器。您还可以在此时组合您的脚本并减少您的整体 HTTP 请求。

底线：谷歌的表现不错但不是很好。如果你有很多海外用户，那么谷歌可能会更好，如果你的用户大多是美国的，并且你关心的是最大性能，那么学习缓存、Etags、gzipping 等并自己服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T19:50:06.530

优点：

*   谷歌的连接可能比你的好得多
*   这是一个免费的 CDN（内容分发网络）
*   由于您使用的是 CDN，因此您的 web 应用程序*可能会加载得更快*

缺点：

*   如果/当您需要通过重新打包该第三方 JS 库的子集来进行优化时，您只能靠自己，并且您的 web 应用程序*可能会*加载较慢

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T23:48:19.433

除了其他人提出的观点外，我还要指出两个额外的缺点：

*   一个额外的外部 HTTP 请求，因此假设您有自己的 Javascript 文件（几乎可以肯定），最少两个而不是一个；和
*   恕我直言，因为 jQuery 加载是异步的，您的整个页面可以在库加载之前加载，因此您对文档就绪所做的效果有时在应用时对用户来说是明显可见的。我认为这不是一个很好的用户体验。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-09T14:39:23.367

优点非常明显，并且在其他答案中：

*   你节省带宽
*   google 可能比你的服务器更可靠
*   可能缓存在大多数浏览器中（有人对此进行统计吗？）

但缺点可能非常棘手：

*   如果您使用的是 https，您将在大多数浏览器上收到错误消息，因为您的证书对 google 的域无效，仅对您的域有效。这是https的一个主要问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T19:55:54.787

我认为最酷的做法是运行 A/B 测试，看看从 Google 的服务器与您的服务器加载缩小版 jquery 的延迟是多少。希望这会让事情变得正确。谷歌服务器可能会更快，但就承担停机时间的责任而言，没有什么比自己托管更好了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T22:30:37.800

**临：**

Google 的 Ajaxlibs 为包含的库提供了一个非常细粒度的“版本控制”。您可以强制执行某个版本（例如 JQuery 1.3.2）或自动从某个分支请求最新版本（例如 JQuery 1.3 系列 -> 目前将提供 1.3.2，但可能很快会提供 1.3.3）。

后者肯定有好处：您将从较小的错误修复/性能改进中受益，而不会破坏您的脚本/插件。

自己维护这样一个多库存储库可能会占用大量资源。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-20T11:10:19.500

缺点：

*   如果担心 DNS 中毒，或者担心某些公共无线网络可能不受信任，那么 Google 实际上可能根本不提供非 SSL 版本，从而打开恶意软件的路过[式安装](http://blog.dasient.com/2010/09/continued-growth-in-web-based-malware_9357.html)。（但是：缓存设置[为一整年](http://web-sniffer.net/?url=http%3A%2F%2Fajax.googleapis.com%2Fajax%2Flibs%2Fjquery%2F1.4.4%2Fjquery.min.js)，因此即使许多浏览器`If-Modified-Since`在刷新时会发出对缓存内容的请求，但这可能仍然是一个理论上的问题，因为大多数用户在使用另一个网络时已经缓存了资源。）

*   在特别注意访问者的隐私时，您可能不希望 Google 使用他们的 CDN 记录对您网站的访问。（也是相当理论上的，因为同样适用于缓存。）

# architecture - 如果 SOA 已经消亡，那么取而代之的是什么？

> ID：936400
> 
> 赞同：24
> 
> 时间：2009-06-01T19:41:09.933
> 
> 标签：architecture, soa

如果这个问题很密集，请原谅我。

*背景：*我们有几个集成在数据库中的内部应用程序。我们正在研究如何将其分解，似乎转向一种架构，其中每个应用程序通过服务公开其功能，而不是调用其他应用程序的数据库，这是最有意义的。对我来说，这似乎是一个面向服务的架构。当我四处寻找有关开始使用面向服务架构的信息时，我看到很多关于这篇文章的讨论：[SOA 已死；万岁服务](http://apsblog.burtongroup.com/2009/01/soa-is-dead-long-live-services.html)。我还从 Martin Fowler 和 Jim Webber 那里看到了这一点：[我的巴士在这看起来很大吗？](http://www.infoq.com/presentations/soa-without-esb).

*问题：*

*   SOA 是死了，还是只是围绕它的嗡嗡声？
*   以服务为导向的架构为起点，使其尽可能保持精简和简单的最佳方式是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-01T19:45:02.187

SOA 是一个聪明的想法，但围绕它的巨大炒作使人们写下“SOA 现已死”。这不是真的，就像句子“结构化编程已经死了，现在每个人都在做 OOP！” 也不总是正确的：有时结构代码是唯一的选择，但应该根据评估而不是炒作做出决定。谈到 SOA 时也是如此：有时您需要 SOA，有时您需要服务。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-25T02:56:41.237

我对 SOA 一无所知，但我通常会看到这些技术经历一个循环：

1.  技术出来了。
2.  技术太好了，每个人都向所有人推荐它。
3.  人们试图将技术用于一切。
4.  当人们意识到它*不能*做所有事情时，他们会生气并在他们的博客上发布它已经死了。

我的猜测是 SOA 只是这些技术中的另一种。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T20:31:14.090

SOA 并没有消亡。就像每一个好主意一样，它成为我们景观的一部分。电子商务这个词在早期是一个伟大的想法，现在我们甚至不再使用这个词了。我什至不再使用术语面向对象了，这几乎是假设的。

当前的炒作是云计算。把所有东西都放在云端。

SOA 的最佳实践是在需要的地方编写好的服务。过度使用 SOA 会增加您的延迟。如果您需要有效地执行代码，请在数据库中使用存储过程。如果它也能完成这项工作，你也无法击败一个好的本地服务。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-02T03:47:52.383

我会说它并没有死，但它现在已落入架构师的工具集中，因为它现在知道它可以在哪里提供帮助，如果它可能没有帮助。

使用 SOA 与您的数据库对话是没有意义的，因为您希望该集成是紧密且高性能的。但是在正确的位置使用它可以让您在组织的不同部分之间拥有干净整洁的界面，并且可能允许您升级每个系统而不管其他系统。

但是在现实生活中，如果您的工资系统出现故障，每个人都会非常不高兴，仅仅因为您的应用程序可能会在没有它的任何一个组件的情况下跛行并不意味着它不会影响您的系统。

不可能创建只了解接口但不了解底层系统的系统（我将用以下语句警告该声明：“运行良好且性能良好”）。以网络浏览器为例，每个好的网站都以“他们使用什么浏览器并修复我的网站并利用 xyz 功能”开头。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T21:12:37.580

SOA 是一个典型的例子，说明当一种有用的模式（甚至不是特别新的模式）作为架构的基础出售时会发生什么。如“集成企业的核心设计”。

中间件公司特别容易受到这些概念的影响，因为他们自己在尝试将他们的产品和服务联系在一起时面临挑战，而且他们需要具有潜在大预算的大创意。

一个单一的架构可以包含企业中所有软件的所有集成需求，从表面上看，这不是很可疑吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-25T02:28:26.410

大多数 SOA 都试图简化一个由较少使用的 SOA 子集（称为事件驱动架构 (EDA)）更好地服务的流程。

问题在于，SOA 是作为从 Web 服务构建的东西而普及的，首先要选择底层技术来实现 SOA，这可能是一个艰难的选择。SOAP 不是*必须的，*但通常*用作*紧密耦合的 RPC 机制。即使在内部系统中，这也不能很好地扩展，更不用说跨系统或更糟糕的企业了。

您可以在 SOAP 之上构建 EDA，但通常您最终会在此之上获得一些即席技术。[异步操作和 Web 服务](http://www.ibm.com/developerworks/library/ws-asynch1.html)涉及一些可能的黑客攻击。

即使您已经了解了 RPC Web 服务的紧密耦合特性，您仍然会遇到合作伙伴之间紧密绑定和 WSDL 版本控制的问题。

您仍然可以使用 XML 有效负载和模式，但 SOAP 本身会退化为一个相当愚蠢的传输包装器，该包装器围绕完全在 WSDL 之外定义的有效负载“blob”。

StackOverflow 是一个非常独立的 Web 应用程序。最接近 SOAish 的可能是它使用的 OpenId 机制。它是简单的客户端-服务器，而不是 SOA。你想的太小了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-01T11:06:14.227

是的，SOA 已经死了，但它已经复活成为短暂的东西，参见 - [http://www.soa-manifesto.org/](http://www.soa-manifesto.org/)。现在每个人仍然可以说他们在做 SOA，不管他们做什么，只要他们能宣称遵循 6 条诫命（或原则）：

*   商业价值高于技术战略
*   战略目标高于项目特定收益
*   通过自定义集成的内在互操作性
*   通过特定目的实现共享服务
*   灵活性优于优化
*   超越追求最初完美的进化改进

这对我来说更像是在说，任何花费更多时间和金钱来制造“面向未来”的 IT 解决方案的公司都可以宣称正在做 SOA。这真的是一件好事。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T02:45:08.220

为什么不采用通过接口公开功能的模块化设计，而不是 SOA？

这是同样的事情，只是不那么令人反感。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T19:58:53.547

SOA 的“最佳”示例是 SAP 的 BusinessByDesign 冒险。花费了大量的时间和资源，甚至在使其正常工作之前就开始出售它，然后尝试修复/关闭它。

我建议您不要让这些文章吓跑您或以任何其他方式影响您。考虑你的特殊情况：它是否给你带来了服务的好处？如果是，那就去吧。如果不是，那么行动的过程是显而易见的。

我相信 SOA 背后的思想基本上有一个乌托邦的想法——创建各种服务的世界，这些服务相互发现并互操作，以某种方式自动为您提供高级服务。但那是他在人工智能/科幻小说的方向上的东西。您只能在非常具体的场景中实现接近的目标，您可以使用算法方法进行编程。不仅如此......好吧，不是在这个世纪......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T03:15:13.683

如果您正在使用内部企业范围的应用程序，则可以使用 SOA 来实现它们。如果您正在创建一个面向 Web 的应用程序（我的意思是一个与新的开放堆栈 oAuth、OpenID 等兼容的应用程序），那么将 SOA 替换为 WOA。Stackoverflow.com 就是这种野兽的一个例子。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-17T22:16:47.153

只要企业存在，就会有集成需求，系统总是要说话的。SOA 似乎是解决此类分布式问题的明智方法。但不幸的是，它忽略了性能问题。为了提出一种可能的解决方案，我发表了一篇关于“流体服务”的文章，通过使用面向流的通信作为面向消息的通信的替代方案来利用客户端和服务器之间的并行性。

SOA Maganizine 上的这篇文章描述了这个概念： http: [//www.soamag.com/I41/0710-2.php](http://www.soamag.com/I41/0710-2.php) 这是一篇更实用的文章，其中还包括 CodeProject 上的示例 WCF 代码：'An Experiment on Fluid Services for High Responsive , Scalable and Reusable SOA Services'（抱歉，放不下链接）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-09-17T22:32:01.373

SOA 适用于本质上是“分布式”的架构。如果您只是在谈论基于接口的编程方法，那么您正在走向“基于组件”的技术，例如 COM+、CORBA。或类似 .NET Remoting 的东西。但是，如果您谈论的是在随时间演变并由多个独立组开发的分布式环境上的基于合同的开发，那么您就是在 SOA 范式上。必须分发这些服务。但我并不是说 SOA 概念不能用于本地处理。我是说，这才是它真正针对的地方，其他人都没有。但是，不幸的是，SOA 并不关心性能之类的事情。因为那是它惨败的地方。

# c# - C#：通过通用 RepositoryBase 类访问 SQL 视图？

> ID：936410
> 
> 赞同：1
> 
> 时间：2009-06-01T19:43:21.847
> 
> 标签：c#, sql, asp.net-mvc, tsql, generics

我使用 RepositoryBase<T> 基类作为我的个人存储库（例如 UserRepository）的基础。

它简化了添加新实体等操作，例如：

 `````
public IQueryable<T> SelectAll()
{
     return db.GetTable<T>().AsQueryable<T>();
} 
````  `现在我在我的数据库中添加了一个视图“UserActive”。有没有办法以类似的方式访问视图，例如如果 T = User 那么我想返回 db.UsersActive 视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T19:49:49.150

如果这是一个特殊的一次性案例，您可以这样做：

```
if (typeof(T) == typeof(User))
{
    return db.GetView<UserActive>().AsQueryable<UserActive>();
}
else
{
    return db.GetTable<T>().AsQueryable<T>();
} 
```

这当然假设您将如何使用您的 linq 提供程序访问您的用户活动视图：-P YMMV

# managed-c++ - 托管 C++ 未解析令牌

> ID：936415
> 
> 赞同：6
> 
> 时间：2009-06-01T19:43:50.927
> 
> 标签：managed-c++

我是托管 C++ 的新手。

我在单个 .sln 中有两个托管 C++ 项目，Project Lib 和 Project LibTest。LibTest 使用 Lib。

Lib 编译和链接很好。该项目设置为 .dll。

LibTest 也被编译为 .dll，但是当它进入链接时，我在所有 Lib::methods 上得到“未解析的令牌”。这些方法定义在 Lib .cpp 文件中定义。

如果我将定义移到 Lib.h 文件中，一切正常。

我已经修改了 LibTest 的 Reference 以依赖于 Lib 项目。

我错过了什么？

**编辑**：好的，这正是我所拥有的，但它仍然不起作用。

首先，我使用的是 Visual Studio 2008 SP1。

其次，当我在 C# 中进行类似的练习时，它运行良好。

我创建了一个空的 C++ CLR 项目。我添加了一个 Lib 项目。我添加了一个托管类。VSTD 生成 Lib.h 和 Lib.cpp。构造函数是自动生成的。

然后我在我的解决方案中添加了另一个项目；我称它为 LibTest。我添加了另一个名为 LibTest 的托管类。生成 LibTest.h 和 LibTest.cpp。我试图在 LibTest 构造函数中实例化 Lib，但在链接过程中它只是说：

1>LibTest.obj : 错误 LNK2020: 未解析的令牌 (06000002) Lib::.ctor

这是确切的代码：

**Lib 项目（编译为 .dll 项目）**

```
//Lib.h
#pragma once

ref class Lib
{
public:
  Lib(void);
};

//Lib.cpp
#include "Lib.h"

Lib::Lib(void)
{
} 
```

**LibTest 项目（编译为 application.exe）**

```
// LibTest.h
#pragma once

ref class LibTest
{
public:
  LibTest(void);
};

// LibTest.cpp
#include "LibTest.h"
#include "Lib.h"

LibTest::LibTest(void)
{
  Lib^ lib = gcnew Lib;
}

int main()
{
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T08:32:37.133

对于不同程序集中的类型，托管 C++ 的工作方式与 C# 类似。这意味着您需要将您的`Lib`类声明为`public`：

```
public ref class Lib 
```

而且你不应该包括`Lib.h`在你的`LibTest`项目中。当您添加对`Lib`项目的引用时，编译器将能够解析在那里找到的任何符号。

您当前的代码包括`Lib.h`，因此链接器在程序集中搜索`Lib`类`LibTest`并在那里查找构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:50:05.390

如果您使用的是托管扩展，那么正确设置引用应该是您所需要的。

如果您使用标准 C++ 函数，您可能需要使用`__declspec(dllexport)`和定义您的函数`__declspec(dllimport)`。 [有关详细信息，请参阅 MSDN](http://msdn.microsoft.com/en-us/library/a90k134d.aspx)。

`__declspec(dllexport)`是将特定函数添加到导出库中，并`__declspec(dllimport)`告诉导入库 (LibTest) 它需要从 DLL 导入这些符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-01T01:47:48.467

在项目LibTest中，property->Configuration properties->Linker->Input->set Additional Dependecies，包含Lib.lib

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T20:28:28.763

这是 Bojan 提出的最终修改。谢谢博扬！

注意：不要忘记将“Lib”添加到您的“LibTest”参考！

**Lib 项目（编译为 .dll 项目）**

//lib.h

```
#pragma once

public ref class Lib
{
public:
  Lib(void);
}; 
```

//lib.cpp

```
#include "Lib.h"

Lib::Lib(void)
{
} 
```

**LibTest 项目（编译为 application.exe）**

// LibTest.h

```
#pragma once

ref class LibTest
{
public:
  LibTest(void);
}; 
```

// LibTest.cpp

```
#include "LibTest.h"

LibTest::LibTest(void)
{
  Lib^ lib = gcnew Lib;
}

int main()
{
  return 0;
} 
```

# visual-studio-2008 - 调试附加到存储在设备 ROM 中的二进制文件的 windows mobile DLL

> ID：936416
> 
> 赞同：0
> 
> 时间：2009-06-01T19:43:52.393
> 
> 标签：visual-studio-2008, debugging, com, dll, windows-mobile

我目前正在为 windows mobile 开发一个软输入面板，并且遇到了一些障碍。已编译的 DLL（一旦部署）由存储在 windows mobile 设备的 ROM 中的 devices.exe 加载。这造成了一场噩梦，因为 Visual Studio 2008 拒绝查看 devices.exe 进程（使用附加到进程），从而无法使用调试器。我目前正在使用日志文件输出，它虽然有用，但在实时调试中几乎没有用处。

Google 和 MSDN 对此帮助不大，因为我发现的所有内容都涉及基本的 DLL 调试（即附加到父进程）。**我在某处遗漏了什么吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T20:13:15.623

已经有一段时间了，但过去无法使用 Visual Studio 调试器调试在 device.exe 的上下文中运行的东西，因为它与之通信的存根也在 device.exe 的上下文中运行。您必须在 Windows CE 设备上调试设备驱动程序的方法是使用 Platform Builder，即使那样，您也不会有目标平台的调试映像。您可以使用 CEPC 之类的东西来使驱动程序的基本逻辑正确，但这一切都比它应该的要痛苦得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T22:35:58.973

看看[这个](http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesnative/thread/a80cd238-233d-4c92-82da-779421e5c79b/)论坛帖子，有人建议了一个可能对你有用的解决方法。

# c# - 在 C# 中解析 .eml 文件的建议

> ID：936422
> 
> 赞同：47
> 
> 时间：2009-06-01T19:44:46.667
> 
> 标签：c#, eml

我有一个包含电子邮件对话的 .eml 文件目录。在 C# 中是否有推荐的方法来解析这种类型的文件？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2010-07-24T13:20:54.860

**2017 年 8 月添加：**查看 MimeKit：[https](https://github.com/jstedfast/MimeKit) ://github.com/jstedfast/MimeKit 。它支持 .NET Standard，因此可以跨平台运行。

**原始答案：**我发布了一个示例项目来说明这个[对 Github的答案](https://github.com/riesvriend/CDO-EML-Parsing-Sample)

CDO COM DLL 是 Windows/IIS 的一部分，可以在 .net 中引用。它将提供准确的解析和良好的对象模型。结合对 ADODB.DLL 的引用使用它。

```
public CDO.Message LoadEmlFromFile(String emlFileName)
{
    CDO.Message msg = new CDO.MessageClass();
    ADODB.Stream stream = new ADODB.StreamClass();

    stream.Open(Type.Missing, ADODB.ConnectModeEnum.adModeUnknown, ADODB.StreamOpenOptionsEnum.adOpenStreamUnspecified, String.Empty, String.Empty);
    stream.LoadFromFile(emlFileName);
    stream.Flush();
    msg.DataSource.OpenObject(stream, "_Stream");
    msg.DataSource.Save();

    stream.Close();
    return msg;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-26T17:31:23.853

[请点击此链接以获得良好的解决方案：](http://blog.onderweg.eu/2010/12/parsing-eml-files-in-c/)

文章的总结是4个步骤（下面的第二步在文章中没有但需要）：

1.  添加对“Microsoft CDO for Windows 2000 Library”的引用，该引用可在 Visual Studio 的“添加引用”对话框的“COM”选项卡上找到。这将在您的项目中添加对“ADODB”和“CDO”的 2 个引用。

2.  禁用 2 引用“ADODB”和“CDO”的互操作类型的嵌入。（参考 -> ADODB -> 属性 -> 将“嵌入互操作类型”设置为 False 并对 CDO 重复相同操作）

3.  在您的代码中添加以下方法：

    ```
    protected CDO.Message ReadMessage(String emlFileName)
    {
        CDO.Message msg = new CDO.MessageClass();
        ADODB.Stream stream = new ADODB.StreamClass();
        stream.Open(Type.Missing, 
                       ADODB.ConnectModeEnum.adModeUnknown, 
                       ADODB.StreamOpenOptionsEnum.adOpenStreamUnspecified,                                                                         
                       String.Empty, 
                       String.Empty);
        stream.LoadFromFile(emlFileName);
        stream.Flush();
        msg.DataSource.OpenObject(stream, "_Stream");
        msg.DataSource.Save();
        return msg;
    } 
    ```

4.  通过传递您的 eml 文件的完整路径来调用此方法，它返回的 CDO.Message 对象将包含您需要的所有已解析信息，包括 To、From、Subject、Body。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-15T01:30:14.087

[LumiSoft](http://www.lumisoft.ee/lsWWW/download/downloads/Net/)包括一个[Mime 解析器](http://www.lumisoft.ee/lsWWW/download/downloads/Net/Help/html/4b7385dc-adc3-ca0f-0736-bbd5d5bdc8fe.htm)。

[Sasa](http://sourceforge.net/projects/sasa/)还包括一个 Mime 解析器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T19:53:20.547

您可能需要的是一个电子邮件/MIME 解析器。解析所有标题字段并不难，但分离出各种 MIME 类型，如图像、附件、各种文本和 html 部分等，可能会变得非常复杂。

我们使用第三方工具，但那里有许多 C# 工具/库。在 Google 中搜索免费的 C# 电子邮件 MIME 解析器。就像我得到了这个：

[http://www.codeproject.com/Articles/11882/Advanced-MIME-Parser-Creator-Editor](http://www.codeproject.com/Articles/11882/Advanced-MIME-Parser-Creator-Editor) [http://www.lumisoft.ee/lswww/download/downloads/Net/info.txt](http://www.lumisoft.ee/lswww/download/downloads/Net/info.txt)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-27T18:33:55.977

获得一个像样的 MIME 解析器可能是一种方法。您可以尝试使用免费的 MIME 解析器（例如来自 codeproject 的解析器），但代码作者的评论[如下](http://www.codeproject.com/KB/office/EML_Reader.aspx)

> 我的工作时间与我为 MSG 文件的包装类工作的时间差不多。难度差别很大。EML 包装类可能需要**一天时间来阅读规范并正确**处理，而 MSG 包装类则需要一周时间。

让我对代码质量感到好奇。我相信你可以破解一个 mime 解析器，它可以在几天/几小时内正确解析 95% 的电子邮件。我也确信要做好剩下的 5% 需要几个月的时间。考虑处理 S/MIME（加密和签名的电子邮件）、unicode、由行为不端的邮件客户端和服务器产生的格式错误的电子邮件、几种编码模式、国际化问题，确保故意格式错误的电子邮件不会使您的应用程序崩溃等...

如果您需要解析的电子邮件来自单一来源，那么快速而肮脏的解析器可能就足够了。如果您需要解析来自野外的电子邮件，则可能需要更好的解决方案。

我会推荐我们的[Rebex Secure Mail 组件](http://www.rebex.net/secure-mail.net/)，但我相信您使用其他供应商的组件也会获得不错的结果。

确保您选择的解析器在 Mike Crispin（MIME 和 IMAP RFC 的合著者）准备的臭名昭著的“Mime Torture Sample message”上正常工作。测试[消息显示在 MIME Explorer 示例中](https://www.rebex.net/secure-mail.net/sample-mime-explorer.aspx)，可以在安装包中[下载。](https://www.rebex.net/secure-mail.net/download.aspx)

以下代码显示了如何读取和解析 EML 文件：

```
using Rebex.Mail;

MailMessage message = new MailMessage();
message.Load("file.eml"); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-31T12:53:59.117

我刚刚开始为此使用[Papercut](https://papercut.codeplex.com/)的 Mime 部分。乍一看似乎很体面和简单。

```
 public void ProcessRawContents(string raw)
    {
        // NB: empty lines may be relevant for interpretation and for content !!
        var lRawLines = raw.Split(new []{"\r\n"}, StringSplitOptions.None);
        var lMailReader = new MimeReader(lRawLines);
        var lMimeEntity = lMailReader.CreateMimeEntity();
        MailMessageEx Email = lMimeEntity.ToMailMessageEx();
        // ...
    } 
```

（`MailMessageEx`当然，源自`MailMessage`。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-09T13:23:59.000

**Aspose.Email for .NET**

> Aspose.Email for .NET is a collection of components for working with emails from within your .NET applications. It makes it easy to work with a number of email message formats and message storage files (PST/OST) along with message sending and receiving capabilities.
> 
> Aspose.Email makes it easy to create, read and manipulate a number of message formats such as MSG, *EML*, EMLX and MHT files *without the need of installing Microsoft Outlook*. You can not only change the message contents, but also manipulate (add, extract and remove) attachments from a message object. You can customize message headers by adding or removing recipients, changing the subject or other properties. It also gives you complete control over an email message by providing access to its Mapi properties.

*   [http://www.aspose.com/.net/email-component.aspx](http://www.aspose.com/.net/email-component.aspx)
*   [https://www.nuget.org/packages/Aspose.Email/](https://www.nuget.org/packages/Aspose.Email/)
*   There is an evaluation version with the following limitations: [http://www.aspose.com/docs/display/emailnet/Licensing](http://www.aspose.com/docs/display/emailnet/Licensing)

**C# Outlook MSG file reader without the need for Outlook**

> MSGReader is a C# .NET 4.0 library to read Outlook MSG and EML (Mime 1.0) files. Almost all common object in Outlook are supported.

*   [https://www.nuget.org/packages/MSGReader/](https://www.nuget.org/packages/MSGReader/)
*   [https://github.com/Sicos1977/MSGReader](https://github.com/Sicos1977/MSGReader)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-13T13:20:13.177

尝试：

*   febootimail
*   SMTP快递
*   LinkWS Newsletter Turbo
*   emlBridge - 将 eml 文件导入 Outlook 和几乎任何其他电子邮件客户端
*   时事通讯 2.1 涡轮增压
*   [ThunderStor](http://bitdaddys.com/thunderstor.html) (emlResender)
*   红宝石（使用[eml2mbox](http://www.broobles.com/eml2mbox/)）。参见[jimbob 方法](http://ubuntuforums.org/archive/index.php/t-45838.html)。
*   Evolution - 创建新消息，附加 eml 文件，

编写一个程序：

*   在 C# 中（参见 [this][4] 和[this](http://www.codeproject.com/KB/office/EML_Reader.aspx?msg=2958456)）。请参阅：[源代码](http://www.codeproject.com/KB/office/EML_Reader/EMLReader.zip)。
*   [使用 Rebel Secure Mail 库](http://www.rebex.net/secure-mail.net/tutorial-mail-message.aspx)
*   .NET（见[这个](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=94725)、[这个](http://www.comanswer.com/question/how-to-save-mailmessage-object-to-disk-as-eml-or-msg-file)和[这个](http://www.codeproject.com/KB/IP/smtpclientext.aspx)）

解决方法：

*   $ 猫邮件.eml | mail -s -c 但是标题不会被解析，附件也不会。
*   将它们放入您的 GMail（Firefox 会将它们保存为附件）

# asp.net - 使用 DAAB 4.1 部署项目的运行时错误

> ID：936425
> 
> 赞同：0
> 
> 时间：2009-06-01T19:45:10.360
> 
> 标签：asp.net, exception, daab

在尝试使用 Microsoft Enterprise Library 的 Data Access Application Block 4.1 时，我在部署时遇到了一个奇怪的问题。尝试使用利用 DAAB 的 Web 应用程序元素时，我收到以下未处理异常：

```
Exception information: 
Exception type: BuildFailedException 
Exception message: The current build operation (build key Build Key[Microsoft.Practices.EnterpriseLibrary.Data.Database, DBNAME]) failed: The type initializer for 'Microsoft.Practices.EnterpriseLibrary.Data.Database' threw an exception. (Strategy type ConfiguredObjectStrategy, index 2) 
```

我的 web.config 有以下连接字符串部分：

```
 <connectionStrings configSource="data.config" /> 
```

并且 data.config 包含异常中引用的 DBNAME 条目：

```
<?xml version="1.0"?>

<connectionStrings>`

<add name="dbname"
    providerName="System.Data.SqlClient"
    connectionString="[valid information here]" />

</connectionStrings> 
```

我知道连接字符串是有效的，因为应用程序中未使用 DAAB 进行数据访问的部分正在使用相同的连接字符串，没有任何问题。此外，在我的开发机器以及其他开发人员的机器上一切正常。这仅在部署到生产服务器时发生，甚至不特定于“发布”版本，因为该版本在我的本地机器上也可以正常运行。

我怀疑这可能是生产服务器的配置问题，但我无法弄清楚它可能是什么。关于部署企业库的 MSDN 文章提到程序集的 xcopy 部署应该可以工作，我将它们包含在 /bin 文件夹中，所以我不确定从那里去哪里。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-12T04:29:40.153

好吧，当您添加引用时，它确实会给您一个警告。至少它在我的机器上是这样的。所以你的投诉没有坚实的基础。:)

但是，异常消息完全模棱两可，因此感谢您提供的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:01:27.260

终于想通了。Enterprise Library 4.1 需要 Framework 3.5，尽管我们的应用程序仍然以 Framework 2.0 为目标，但由于使用 Visual Studio 2008，我们的开发机器上安装了 3.5。但是，我们没有在生产服务器上安装 Framework 3.5，并且这样做后问题就消失了。

令人费解的是，我在我的解决方案中的所有项目中都明确将 2.0 编译为目标，包括依赖于企业库的项目，因此您认为引用需要 3.5 的程序集至少会在编译时产生警告。那好吧。

# c# - InfoPath 加载项帮助 - 保存活动表单模板的副本，在设计模式下显示自定义按钮，在表单解决方案中调用方法

> ID：936426
> 
> 赞同：0
> 
> 时间：2009-06-01T19:45:17.693
> 
> 标签：c#, add-in, infopath, vsta

我正在尝试构建一个 InfoPath 加载项，以允许模板编辑器（而不是最终用户）预览填充了示例数据的表单。

首先，我们的环境的一些背景。我们有一个连接到 MOSS 的自定义进程，为给定的表单下载适当的数据源程序集，并调用它们将数据从数据库加载到表单中（例如信件模板中的收件人地址信息）。此过程在下载表单并传递参数（通过 URL）以进行数据检索时启动。我可以通过命令行将参数传递给本地保存的表单模板来近似这种行为。

有了这些知识，我着手构建一个 InfoPath 加载项，它可以执行以下操作：

1.  在设计模式下显示一个自定义工具栏按钮，模板编辑器可以单击该按钮以使用示例数据填充表单（需要传递参数）。
2.  单击按钮时，将活动模板的副本保存到临时文件夹并使用 Shell() 命令将参数传递给表单。然后将在单独的 InfoPath 窗口中启动该表单的副本。

在此过程中，我参考了各种在线教程和 Apress 的 Pro InfoPath 2007 以获得指导，并且像这里以前的帖子一样，发现可用的信息非常有限。我在那里的一部分，但遇到了一些问题：

1.  我能够显示自定义工具栏按钮，但只能在预览模式下显示。我需要按钮以设计模式显示。
2.  Application.ActiveWindow.XDocument.SaveAs() 方法似乎只保存表单，而不是整个模板。也许这是因为我处于预览模式而不是设计模式？也许解决第一个问题也可以解决这个问题。
3.  为了避免上述两个问题，我研究了如何在我的表单模板解决方案中调用 FormEvents_Loading 处理程序。这将允许我将测试参数传递给它，而不必求助于保存副本并通过命令行启动它。我不知道该怎么做。

有什么想法或建议吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T07:02:18.367

您知道**表单选项**->**预览**选项卡吗？在那里，您可以设置预览模板时使用的表单。听起来这就是你想要做的。可能使用插件来修改默认预览表单，然后用户只需单击预览即可查看您的示例数据。

# flash - Flash Bug - 强制屏幕重绘

> ID：936427
> 
> 赞同：1
> 
> 时间：2009-06-01T19:45:40.737
> 
> 标签：flash, actionscript-3, actionscript-2, repaint

我有一个 Flash 项目，它有点独特，因为它是一个加载 AS2 SWF 文件的 AS3 项目。

我使用 JumpEye 桥接器让它们一起播放，但我遇到了一个奇怪的错误。

桥接文件有两个用于加载 SWF 文件的位置。主要部分和预览部分。

第一次加载预览时，它可以正常加载并关闭，但第二次尝试时，加载的 SWF 文件背景消失了，但元素仍保留在屏幕上。

我已经尝试了几乎所有我能想到的技巧，但我的想法已经不多了。我在想，也许我需要告诉 Flash 重新绘制所有内容，但我似乎找不到命令。

此外，以及可能有助于关闭预览电影的建议，除了：

```
 preview.removeMovieClip();
    preview._visible = false;       
    preview._alpha = 0; 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T06:29:08.047

没有命令在 flash 中重绘，因为整个舞台每帧都会重绘。虽然没有办法手动强制加载的 SWF 超出内存，但一旦您在其上调用 removeMovieClip，它就会永远脱离显示树。

当然，您可能有 Flash 错误，但更有可能是内容问题。您能否详细说明“加载的 SWF 文件背景消失”的含义？您是指 SWF 的纯色背景色，还是指 SWF 内容中恰好位于其他元素后面的元素？您使用的是什么 JumpEye 组件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T19:34:37.220

如果有人感兴趣：

此时，它看起来像是 Flash 中的一个已知错误：

[http://kb2.adobe.com/cps/194/tn_19435.html](http://kb2.adobe.com/cps/194/tn_19435.html)

我没有使用 removeMovieClip，而是使用了 unloadMove，这似乎起到了作用。我还有一些测试要做，但这似乎是解决方案。

# c++ - fopen 非 ASCII 字符错误

> ID：936428
> 
> 赞同：2
> 
> 时间：2009-06-01T19:45:53.433
> 
> 标签：c++, c, unicode, fopen

我不能在文件上使用 fopen 在它们的名称中包含一些字符（例如：ş、ç、ı）我如何在这些文件上使用 fopen？我正在使用 vc++ 6（我必须）和 c 语言。当我尝试使用 _wfopen 时，它永远不会打开任何文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T20:23:12.937

将您的路径名转换为 UTF-16（可能使用[`MultiByteToWideChar`](http://msdn.microsoft.com/en-us/library/dd319072.aspx)）并用于[`GetShortPathNameW`](http://msdn.microsoft.com/en-us/library/aa364989.aspx)获取可以传递给`fopen`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:24:18.180

确保您有 wchar_t（它是编译器设置）并确保您将 wchar_t * 而不是 char * 传递给 _wfopen。

# python - 在 Python 中检索网络掩码

> ID：936444
> 
> 赞同：7
> 
> 时间：2009-06-01T19:50:14.063
> 
> 标签：python

如何检索网络设备的网络掩码（最好在 Linux 中，但如果它是跨平台的，那就太酷了）？我知道如何在 Linux 上使用 C，但我在 Python 中找不到方法——也许减去 ctypes。那或解析ifconfig。还有什么办法吗？

```
ioctl(socknr, SIOCGIFNETMASK, &ifreq) // C version 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T20:13:31.193

[这](http://code.activestate.com/recipes/439094/)适用于 Linux 上的 Python 2.2：

```
iface = "eth0"
socket.inet_ntoa(fcntl.ioctl(socket.socket(socket.AF_INET, socket.SOCK_DGRAM), 35099, struct.pack('256s', iface))[20:24]) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-01-07T12:08:37.360

该[`netifaces`](https://pypi.org/project/netifaces/)模块在这里值得一提。直接来自文档：

```
>>> netifaces.interfaces()
['lo0', 'gif0', 'stf0', 'en0', 'en1', 'fw0']

>>> addrs = netifaces.ifaddresses('en0')
>>> addrs[netifaces.AF_INET]
[{'broadcast': '10.15.255.255', 'netmask': '255.240.0.0', 'addr': '10.0.1.4'}, {'broadcast': '192.168.0.255', 'addr': '192.168.0.47'}] 
```

适用于 Windows、Linux、OS X 和可能的其他 UNIX。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T19:57:33.550

你看过这里吗？

[http://docs.python.org/library/fcntl.html](http://docs.python.org/library/fcntl.html)

这适用于 Linux 上的 python 2.5.2。当本领先时正在完成它，但它仍然在这里（可悲的是浪费了努力:-)）：

```
vinko@parrot:~$ more get_netmask.py
# get_netmask.py by Vinko Vrsalovic 2009
# Inspired by http://code.activestate.com/recipes/439093/
# and http://code.activestate.com/recipes/439094/
# Code: 0x891b SIOCGIFNETMASK

import socket
import fcntl
import struct
import sys

def get_netmask(ifname):
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        return socket.inet_ntoa(fcntl.ioctl(s.fileno(), 0x891b, struct.pack('256
s',ifname))[20:24])

if len(sys.argv) == 2:
        print get_netmask(sys.argv[1])
vinko@parrot:~$ python get_netmask.py lo
255.0.0.0
vinko@parrot:~$ python get_netmask.py eth0
255.255.255.0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-15T23:25:03.557

你可以使用这个库：http: [//github.com/rlisgor/pynetlinux](http://github.com/rlisagor/pynetlinux)。注意：我是图书馆的作者。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-13T00:09:12.650

我的想法是依靠子进程使用简单的 ifconfig (Linux) 或 ipconfig (windows) 请求来检索信息（如果 ip 已知）。 ***欢迎评论***：

视窗

```
ip = '192.168.1.10' #Example
proc = subprocess.Popen('ipconfig',stdout=subprocess.PIPE)
while True:
    line = proc.stdout.readline()
    if ip.encode() in line:
        break
mask = proc.stdout.readline().rstrip().split(b':')[-1].replace(b' ',b'').decode() 
```

类 UNIX

```
ip = '192.168.1.10' #Example
proc = subprocess.Popen('ifconfig',stdout=subprocess.PIPE)
while True:
    line = proc.stdout.readline()
    if ip.encode() in line:
        break
mask = line.rstrip().split(b':')[-1].replace(b' ',b'').decode() 
```

使用与 Web 的套接字连接并使用`getsockname()[0]`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T22:57:53.297

在 Windows 中，这段代码可能很有用：

```
import os
import sys
import _winreg

def main():
    adapter_list_key = _winreg.OpenKey(_winreg.HKEY_LOCAL_MACHINE,
        r'SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards')

    adapter_count = _winreg.QueryInfoKey(adapter_list_key)[0]

    for i in xrange(adapter_count):
        sub_key_name = _winreg.EnumKey(adapter_list_key, i)
        adapter_key = _winreg.OpenKey(adapter_list_key, sub_key_name)
        (adapter_service_name, _) = _winreg.QueryValueEx(adapter_key, "ServiceName")
        (description, _) = _winreg.QueryValueEx(adapter_key, "Description")

        adapter_registry_path = os.path.join(r'SYSTEM\ControlSet001\Services',
            adapter_service_name, "Parameters", "Tcpip")
        adapter_service_key = _winreg.OpenKey(_winreg.HKEY_LOCAL_MACHINE,
            adapter_registry_path)
        (subnet_mask, _) = _winreg.QueryValueEx(adapter_service_key, "SubnetMask")
        (ip_address, _) = _winreg.QueryValueEx(adapter_service_key, "IpAddress")

        sys.stdout.write("Name: %s\n" % adapter_service_name)
        sys.stdout.write("Description: %s\n" % description)
        sys.stdout.write("SubnetMask: %s\n" % subnet_mask)
        sys.stdout.write("IpAdress: %s\n" % ip_address)

if __name__ == "__main__":
    main() 
```

`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards`从注册表项中获取网络适配器列表，然后从键中提取有关每个适配器的更多信息`HKLM\SYSTEM\ControlSet001\Services\{adapter_guid}\Parameters\Tcpip`。

我在带有 2 个虚拟适配器的 Windows XP 上对其进行了测试，它工作正常。也应该在 2000、2003 和 Vista 中工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-23T11:36:55.900

使用 python pyroute2 库，您可以获得所有网络元素属性：

```
from pyroute2 import IPRoute
ip = IPRoute()
info = [{'iface': x['index'], 'addr': x.get_attr('IFA_ADDRESS'), 'mask':  x['prefixlen']} for x in ip.get_addr()] 
```

此处提供更多信息：http: [//pyroute2.org/pyroute2-0.3.14p4/iproute.html](http://pyroute2.org/pyroute2-0.3.14p4/iproute.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-01T17:31:24.467

我将原始答案更新为原始代码：

```
struct.pack('256s', iface) 
```

在 Python 3.9 中引发错误，因此这是一个重新审视的版本：

```
 SIOCGIFADDR = 0x8915

    def get_iface_ip(iface: str):
        """
        Get network interface IP using the network interface name
        :param iface: Interface name (like eth0, enp2s0, etc.)
        :return IP address in the form XX.XX.XX.XX
        """
        with socket.socket(socket.AF_INET, socket.SOCK_DGRAM) as s:
            iface_bin = struct.pack('256s', bytes(iface, 'utf-8'))
            packet_ip = fcntl.ioctl(s.fileno(), SIOCGIFADDR, iface_bin)[20:24]
        return socket.inet_ntoa(packet_ip) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-10-05T14:11:15.677

使用[套接字](https://docs.python.org/3/library/socket.html)和[IP 地址](https://docs.python.org/3/library/ipaddress.html)

从文档

> **ipaddress**提供了在 IPv4 和 IPv6 地址和网络上创建、操作和操作的能力。
>  该模块中的函数和类**使处理与 IP 地址相关的各种任务变得简单**......

```
>>> import socket
>>> import ipaddress
>>>
>>> ip_addr = socket.gethostbyname(socket.gethostname())
>>> netmask = ipaddress.IPv4Network(ip_addr).netmask
>>> print(netmask)
255.255.255.255
>>> ... 
```

这个问题可以在[这里](https://stackoverflow.com/questions/50867435/get-subnet-from-ip-address)回答。这不是同一个问题，但也为您的问题提供了解决方案。

# c++ - 是否可以转发声明一个静态数组

> ID：936446
> 
> 赞同：21
> 
> 时间：2009-06-01T19:51:05.247
> 
> 标签：c++

我需要将静态数组放入 .cpp 文件中。这个数组只在这个 .cpp 中使用，所以我想将它声明为静态的。数组定义挺大的，自然要转发声明。

```
static int bigIntArray[5000];

/* other code using bitIntArray */

static int bigIntArray[5000] = {
  0x00, 0x9900, 0xffee,
  ...
}; 
```

VC 9.0 报错：error C2086: 'int bigIntArray[5000]' : redefinition

如果我将“静态”更改为“外部”，问题就会消失，但我不喜欢这种解决方案。

为什么我不能转发声明一个静态变量？这是 C++ 标准所要求的吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-14T20:31:59.487

At the risk of answering a slightly different question (yours was answered well by Charles Bailey), you might want to use an anonymous namespace with an extern. This prevents other translation units from accessing the array variable name.

```
namespace {
    extern int bigIntArray[5000];
}

// Code that uses bigIntArray

namespace {
    int bigIntArray[5000] = { ... };
} 
```

This might meet your need.

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-01T20:24:00.503

`extern`如果您使用关键字并且不指定初始值设定项，则只能在 C++ 中前向声明对象。任何其他声明对象的尝试也将是一个定义。这意味着前向声明的对象将具有外部链接。无法转发声明`static`对象，即具有内部链接的对象。

这与 C 中的任何没有初始值设定项的声明都是暂定定义不同，可以提供后续定义，但它们都必须指定相同的链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-08T10:39:40.247

> 是否可以转发声明一个静态数组

我认为如果你想用静态来做的话，可以用指针来转发声明。

指针声明将作为您的**前向声明**。如果你 `/* other code using bitIntArray */`的函数定义**只有在**你可以分配内存并初始化它们之后才会被调用，你可以以传统的方式访问元素 bigIntArray[index]。

```
static int *bigIntArray;  // pointer to static integer

/*other code using bitIntArray: function definitions using forward declaration */
int func()
{
        printf("\nfunc %d \n",bigIntArray[3]);
}

int allocate()
{
        bigIntArray = new int[5]{1,2,3,4,5};
}

int main()
{
    allocate();
    func();
    return 0;
} 
```

该数组是静态整数，将仅限于您的编译单元。

**警告：**应始终根据您的**优先事项**做出此类决定。这样，您可能会增加代码的可读性或任何其他您想要前向声明的原因，但这将以**堆为代价。**

IMO，正如**DA**所建议的那样，最好的选择是**在定义的命名空间中使用 extern。** extern 通知编译器该变量是在别处定义的，并且定义的命名空间将其范围仅限于将使用命名空间的单元。

```
namespace limited
{
       extern int bigIntArray[];
};
/* other code using bitIntArray */
int func()
{
        using namespace limited;   
        printf("\nfunc %d \n",bigIntArray[3]);
}

namespace limited
{
        int bigIntArray[5] ={1,2,3,4,5};
};

int main()
{
        func();
        return 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T21:22:00.010

将定义（也是声明）放在前面并取消“前向声明”有什么问题？

```
static int bigIntArray[5000] = {  0x00, 0x9900, 0xffee,  ...};

/* other code using bitIntArray */ 
```

* * *

有人说原因是“可读性”。原始海报没有提到这是一个动机。

无论如何，我不认为做“奇怪”的事情可以证明“可读性”。我认为创建一个新的文件类型（例如，下面的“*.def”）很奇怪。

定义事物的位置似乎并不重要（至少对我而言）。

最干净，最清晰。最简单的做法是将定义移到顶部（不要太在意“可读性”）。

其他人说使用“外部”。这样做的问题是它打开了对象名称的范围（可能）超出了一个模块。

* * *

原始发布者也可能没有意识到，在这种情况下，“静态”是一个*范围*修饰符（不是*存储*修饰符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T21:35:01.607

我想你想要这样做的原因是通过将长常量列表放在代码末尾来提高可读性，对吧？另一种选择（恕我直言，既不好也不坏，只是不同）是使用包含定义的预处理器，例如：

```
[main file]
#include <iostream>
#include "bigIntArray.def"

int main()
{
    for( int i = 0; i < 10000 ; ++i)
    {
        std::cout << bigIntArray[i] << std::endl;
    }

    std::cin.ignore();
    return 0;
}

[bigIntArray.def]
static int bigIntArray[10000] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ... }; 
```

更好的是，在设计方面，将数组声明`extern`在头文件中，并将定义放在独立的代码文件中......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-04T16:25:37.337

我遇到了同样的问题，我的解决方案是仅将其转换为一行数字，因为任何格式（空格、换行符等）无论如何都不会使数据可读：

```
static unsigned char XXX_certificate[1376]={
48,130,5,92,48,176,231,119,149,87,108,108,225,239,138,233,91,116,236,200,117,213,130, <cut>
}; 
```

因此，我能够将它放在源文件的开头，请注意它有效，因为我不使用自动换行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-15T14:18:05.923

您可以像这样仅使用 extern 转发声明您的数组：

```
extern int bigIntArray[5000]; 
```

您还可以删除数组大小

```
extern int bigIntArray[]; 
```

这将告诉编译器该数组是在其他地方定义的（稍后或其他翻译单元）。在您的情况下，它将稍后在同一个翻译单元中定义，因为它是静态全局的。

在 VC++ 2010 Express 中为我工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-07T16:47:41.050

这是未定义的行为。

考虑这个线程以获取更多详细信息：

[https://groups.google.com/forum/#!topic/comp.lang.c.moderated/bmiF2xMz51U](https://groups.google.com/forum/#!topic/comp.lang.c.moderated/bmiF2xMz51U)

此链接的报价单：

> 因为 1989 年之前的链接器处理“隐藏”符号的能力各不相同。如果链接器无法在两个不同的翻译单元中处理两个*不是*同一个对象的名为“foo”的符号，那么编译器必须在翻译时解决问题 - 而不是链接时。许多 C 编译器都是一次性的，所以他们需要在第一次看到“foo”时分配地址和空间，或者至少在第一次引用它时。因此限制。
> 
> 正如基本原理所说：“在 C90 之前，实现在具有内部链接的前向引用标识符方面存在很大差异。”
> 
> 顺便说一句，需要在单个文件中为具有外部链接的符号工作的原因是不完整的版本（“int foo[];”）可能位于#included 头文件中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-09T17:08:51.823

@DA 答案是最好的。- 赏金他
在这方面我同意@Leafy。

想要补充一点，如果所有初始化程序都在那里，则在实例化中不需要数组大小。

此外，预先设置数组大小具有能够使用的优势`sizeof(bigIntArray)`

```
namespace {
    extern int bigIntArray[5];
}

// Code that uses bigIntArray
void fred() {
  size_t N = sizeof(bigIntArray)/sizeof(bigIntArray[0]);
}

namespace {
    int bigIntArray[/* 5 not needed */] = { 1, 2, 3, 4, 5 };
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-18T11:09:02.070

`This is different from C where any declaration without an initializer is a tentative definition, subsequent definitions can be supplied but they must all specify the same linkage.`

很高兴知道，这意味着我们不必显式地放入`extern`C 前向声明。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-20T06:54:41.190

我能想出的最佳解决方案：前向声明一个指向数组的指针，然后定义静态静态数组并将其分配给 EOF 处的指针。

```
static int *bigIntArray;

/* other code using bitIntArray */

static int _bigIntArray[5000] = {
  0x00, 0x9900, 0xffee,
  ...
};

static int *bigIntArray = _bigIntArray; 
```

# validation - 需要确定 ActiveDirectory 中的用户是否仍然有效/活跃

> ID：936449
> 
> 赞同：0
> 
> 时间：2009-06-01T19:52:24.467
> 
> 标签：validation, active-directory

我有一个 .NET MVC (1.0) 应用程序，它使用 ActiveDirectoryMembershipProvider 对用户进行身份验证，并且工作正常。成功验证后，我在 SQL 中为该用户创建自定义配置文件（AD 用户名、电子邮件等）。

在应用程序的一部分中，我正在向用户发送电子邮件警报，并且我正在循环访问来自保存 AD 用户名的本地 SQL 表中的用户，如上所述。在发送警报之前，我想验证我们发送给的用户仍然是 AD 中的有效（即活动）用户。如果没有循环中当前用户的密码，如何检查？

我希望做这样的事情......

```
MembershipUser adUser= Membership.GetUser(userName); //I have the username from the loop
bool isValid = adUser.isValid; //I know this is not a real property 
```

我知道没有这样的属性称为“isValid”——但有人知道我应该使用什么属性吗？如果 MembershipUser 没有用，那么我假设我需要编写一些代码来调用 System.DirectoryServices.ActiveDirectory 命名空间？如果是这样，我应该在 AD 中检查什么属性以查看用户是否有效？“有效”是指用户仍然为相关公司工作，并且能够通过 AD 登录。我不关心用户在 AD 中的组成员身份。

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T20:21:20.773

您基本上需要检查用户的`userAccountControl`标志是否有`disabled`标志。

一旦你有你`DirectoryEntry`的问题用户（userAccount），你可以检查帐户禁用和帐户锁定，如下所示：

```
// get the "userAccountControl" property
int uac = Convert.ToInt32(userAccount.Properties["userAccountControl"][0]);

const int ADS_UF_ACCOUNTDISABLE = 0x00000002;
const int ADS_UF_LOCKOUT = 0x00000010;

bool accountIsDisabled = (uac & ADS_UF_ACCOUNTDISABLE) == ADS_UF_ACCOUNTDISABLE;
bool accountIsLockedOut = (uac & ADS_UF_LOCKOUT) == ADS_UF_LOCKOUT; 
```

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:29:22.940

如果您在 AD 中查询用户属性/属性，如果帐户被锁定，则 userAccountControl 属性将为 514，如果准备好登录，则为 512。

花了很长时间才发布我的回复。Marc 的帖子实际上更详细，我会赞成。

# thread-safety - 对未对齐数据的联锁操作

> ID：936451
> 
> 赞同：0
> 
> 时间：2009-06-01T19:52:56.790
> 
> 标签：thread-safety, alignment, atomic, interlocked, multiprocessor

win32 互锁函数为数据的原子操作提供了一种机制。它们应该是线程安全的和多处理器安全的。

如果数据没有对齐会发生什么？联锁操作仍然是原子的？例如：增加一个未对齐的整数。

泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T19:58:17.760

如果您阅读了大多数 Interlocked API 函数，就会发现一些注释指定了以下内容：

“Addend 参数指向的变量必须在 32 位边界上对齐；否则，此函数在多处理器 x86 系统和任何非 x86 系统上的行为将无法预测。请参阅 _aligned_malloc。”

例如，请参阅此[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms683614(VS.85).aspx)。

这基本上说您需要使用 _aligned_malloc 对齐数据以获得正确的结果。

# php - 使用 PHP 批量插入

> ID：936458
> 
> 赞同：1
> 
> 时间：2009-06-01T19:54:53.133
> 
> 标签：php, mysql, mysqli, bulkinsert

Java 有 PreparedStatement addBatch + executeBatch 可以有效地进行多次插入。

使用 php 的 mysqli 扩展进行一批插入的快速方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:27:00.183

MySQL 原生支持一次查询的多次插入。

```
INSERT INTO [Table] ([Column List])
VALUES ([Value List 1])
     , ([Value List 2])
       [...]
     , ([Value List N]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-26T01:05:27.743

我意识到这个问题很老，但是对于遇到这个问题的其他人，我在这里找到了一些关于这个主题的有用信息：[通过 php 数组将多行插入 mysql](https://stackoverflow.com/questions/779986/insert-multiple-rows-via-a-php-array-into-mysql)。

根据您的需要，将数据作为 csv 直接通过管道传输到 LOAD DATA INFILE 可能是最快的。但是，对这种方法要非常谨慎，因为它不提供针对注入攻击的保护。

我过去曾使用过这种方法，在 csv 生成期间验证数据的清洁度。

# asp.net - 是否可以在 ASP.NET ListView 控件中进行自定义分组？

> ID：936459
> 
> 赞同：6
> 
> 时间：2009-06-01T19:55:00.530
> 
> 标签：asp.net, listview

您只能在ListView中定义一个GroupItemCount，但是如果您想根据数据源中项目的属性进行分组怎么办？有点像临时组。数据源按此属性排序。

我已经看到了一些示例，其中有条件地显示 ItemTemplate 中的某些标记，但如果可能，我想利用 GroupTemplate。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T21:19:12.277

当我必须在转发器中添加基本组标题时，我使用 ItemTemplate 中的文字控件来完成此操作：

```
<asp:Literal runat="server" Text='<%# GetGroupHeading(Eval("Group")) %>' /> 
```

代码中的“GetGroupHeading”方法跟踪前一个组标题并返回“<h2>Group Name</h2>”，如果我们与前一个项目在同一个组中，则返回一个空字符串。正如我所说，我是在中继器上执行此操作的，因此不确定它是否能满足您对 ListView 的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-11T00:10:55.880

是的，尼克给了很大的领先优势。这是我的代码隐藏

```
Dim sCategory_Descr As String
Function GetGroupHeading(ByVal sGroupName As String) As String
    Dim sReturn As String
    If sCategory_Descr <> sGroupName Then
        sCategory_Descr = sGroupName
        sReturn = "<H5>Category: " & UCase(sGroupName) & "</H5>"
    Else
        sReturn = ""
    End If
        Return sReturn
End Function 
```

还有我的 item_template

```
<ItemTemplate>                    
    <tr>
        <td style="background-color:#ccc;" colspan="2" id="tdCategory_Placeholder" runat="server" >
            <asp:Label Font-Bold="true"  ID="Literal1" runat="server" Text='<%# GetGroupHeading(Eval("Category_Descr")) %>' /> 
        </td>
    </tr>                                     
    <tr>
        <td > 
            <asp:DynamicControl1 />                     
        </td>                                               
        <td > 
            <asp:DynamicControl2 />
        </td>                     
    </tr>
</ItemTemplate> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-01T21:25:30.643

试试来自 Rolla 的 4 Guys 的这篇文章：[使用 ASP.NET 3.5 的 ListView 和 DataPager 控件：使用 ListView 控件对数据进行分组](http://www.4guysfromrolla.com/articles/010208-1.aspx)

# frameworks - 说一个框架“很好地扩展”是什么意思？

> ID：936461
> 
> 赞同：21
> 
> 时间：2009-06-01T19:55:29.060
> 
> 标签：frameworks, scale

在阅读有关框架（.net. ruby​​ on rails、django、spring 等）的信息时，我一直看到某某某某做或不能很好地扩展。

当有人说一个框架“扩展性很好”是什么意思，说一个框架“不能很好地扩展”是什么意思？

谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-01T20:10:51.590

当您针对并发用户绘制一些资源使用情况（内存、时间、磁盘空间、网络带宽）时，您将获得一个描述应用程序如何在不同比例因子下工作的函数。

小规模——少数用户——使用少量资源。

大规模——大量用户——使用大量资源。

关键问题是“缩放有多接近线性？” 如果它是线性扩展的，那么服务 2000 个并发用户的成本是服务 1000 个用户的 2 倍，是服务 500 个用户的 4 倍。这是一个可扩展的工具/框架/语言/平台/操作系统。它是可预测的，并且预测是线性的。

如果它不是线性扩展的，那么服务 4,000 名用户的成本是服务 2,000 名用户的 1,000 倍，而服务 500 名用户的成本是服务 500 名用户的 100 倍。这没有很好地扩展。随着使用量的增加，出现了问题；它似乎不可预测，也不是线性的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T20:00:05.480

这意味着一个特定的框架确实（或不）满足更多用户对其提出的日益增长的需求。例如，如果您有一个用 VBScript 编写的应用程序，它可能无法很好地处理 Facebook 的 40,000,000 名用户。

[这篇博](http://natishalom.typepad.com/nati_shaloms_blog/2008/05/twitter-as-an-e.html)文解释了 Twitter 在大约一年前经历的一些可扩展性难题。它可以为您的问题的答案提供更多见解。

有时缺乏可扩展性被用来诋毁语言或框架，所以要小心。坚持显示真实指标的研究。这也适用于我在上一段中的 VBScript 示例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T20:01:07.723

如果一个框架或应用程序可以很好地扩展，这意味着它可以处理更大的负载。随着您的网站变得越来越受欢迎，每天有更多的访问者和更多的点击量，一个可扩展的框架将处理较大的负载，就像它处理较小的负载一样。一个可扩展的框架在每小时收到 200,000 次点击时的行为与每小时获得 1 次点击时的行为相同。不仅命中，而且部署在多个服务器上，可能在负载平衡之后，可能与几个不同的数据库服务器一起部署。一个可扩展的框架可以很好地处理这些不断增长的需求。

例如，去年推特几乎在一夜之间爆发。它是使用 Ruby On Rails 开发的，并且在关于 Rails 是否可以很好地扩展的持续争论中成为热门话题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T20:01:23.747

用“句柄扩展”代替“规模”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T20:03:49.153

在我的脑海里有几个元素。第一个是显而易见的——性能扩展。您的框架可以用于构建高容量、高吞吐量的系统，还是仅用于构建较小的应用程序。它会在硬件上垂直扩展（例如并行库）还是水平扩展（例如网络农场）。

第二个是它可以扩展到更大的团队或企业。也就是说，它是否适用于大型代码库？大型开发团队？它有良好的工具支持吗？部署有多容易？你能推广到数十、数百甚至数千名用户吗？一直到很容易雇用有这种技能的人。想想尝试组建一个 20 或 50 人的开发团队，他们都在这个框架上工作。这会很容易还是几乎不可能？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T20:20:08.480

恕我直言，说一个框架“扩展性很好”通常意味着传闻链中的某个人能够使用它来处理大量的音量。

在并行编程中，可伸缩性通常用于描述算法在并行化时如何执行。具有 1:1 加速的算法是一种罕见的野兽，但在两倍的硬件/cpu 上性能会翻倍，在硬件/cpu 的三倍上会翻倍，等等......

以我的经验，只要有足够的专业知识，几乎任何框架都可以扩展。

框架越容易使用，专业知识不足的开发人员遇到可伸缩性问题的机会就越大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T20:24:47.567

这意味着一些受人尊敬的公司正在认真对待它并且没有任何问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-20T21:10:43.367

扩展意味着通过使用更多硬件来满足更多需求是多么容易。

示例：您有一个用某种语言编写的网站，每天有 1000 次访问。您会出现在一些著名杂志中，并且您的用户数量会增加。突然间，你每天有 1000000 次访问，那是 1000 倍。如果您可以多使用 1000 台服务器来满足不断增长的资源需求，那么您的网站可以很好地扩展。另一方面，如果您添加了 2000 台服务器，但用户仍然无法连接，因为您的数据库每天只能处理 1000 个请求，那么您的网站就不能很好地扩展。

# javascript - jQuery Ajax JavaScript 执行

> ID：936465
> 
> 赞同：0
> 
> 时间：2009-06-01T19:56:22.790
> 
> 标签：javascript, jquery, ajax

我有 jQuery ajax 请求一个页面，该页面返回带有`<script>`该 html 内标签的 html，我将 dataType 选项设置为“html”，以便我在`<script>`标签内执行 JS，这工作正常，但问题是它需要浏览器从 2 -3秒评估ajax响应后返回的JS，为什么会有延迟？对于急于尝试在 ajax 响应后立即单击按钮的用户，它会导致 JS 错误。

请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:28:39.680

如果没有看到代码，就不可能说出导致执行延迟的原因。但是，您可以使用 Firebug 的分析器自己分析返回的 JS 代码。

```
console.profile("Returned JS");
//your AJAX call
console.profileEnd(); 
```

这会将执行配置文件输出到 Firebug 的控制台，您将能够看到执行瓶颈发生在哪里。

[http://getfirebug.com/console.html](http://getfirebug.com/console.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:59:41.617

当您使用 jQuery 将 HTML 添加到元素时，首先 jQuery 会搜索 HTML 中的任何 SCRIPT 元素。如果 HTML 包含 SCRIPT SRC=""，则 jquery 会尝试异步获取 javascript 文件。这可能会导致您的延误。

# c++ - 为什么 MSVC++ 认为“std::strcat”是“不安全的”？(C++)

> ID：936468
> 
> 赞同：6
> 
> 时间：2009-06-01T19:57:26.827
> 
> 标签：c++, warnings, strcat, strcat-s

当我尝试做这样的事情时：

```
char* prefix = "Sector_Data\\sector";
char* s_num = "0";
std::strcat(prefix, s_num);
std::strcat(prefix, "\\"); 
```

依此类推，我收到警告

```
warning C4996: 'strcat': This function or variable may be unsafe. Consider using strcat_s instead. 
```

为什么 strcat 被认为是不安全的，有没有办法在不使用 strcat_s 的情况下摆脱这个警告？

此外，如果摆脱警告的唯一方法是使用 strcat_s，它是如何工作的（语法方面：显然它不需要两个参数）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-01T20:33:03.340

如果您使用的是 c++，为什么不避免整个混乱并使用`std::string`. 没有任何错误的相同示例如下所示：

```
std::string prefix = "Sector_Data\\sector";
prefix += "0";
prefix += "\\" 
```

无需担心缓冲区大小和所有这些东西。如果你有一个需要 a 的 API `const char *`，你可以只使用`.c_str()`成员；

```
some_c_api(prefix.c_str()); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-01T20:02:38.843

因为缓冲区前缀可能比您复制到其中的空间少，从而导致缓冲区溢出。因此，黑客可以传入一个特制的字符串，该字符串会覆盖返回地址或其他关键内存，并开始在您的程序上下文中执行代码。

strcat_s 通过强制您传入要复制字符串的缓冲区的长度来解决此问题；如有必要，它将截断字符串以确保缓冲区没有溢出。

google strcat_s 以准确了解如何使用它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-01T20:41:04.290

您可以通过添加以下内容来消除这些警告：

```
_CRT_SECURE_NO_WARNINGS 
```

和

```
_SCL_SECURE_NO_WARNINGS 
```

到您项目的预处理器定义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T20:02:33.370

因为它无法检查您案例中的目标字符串（前缀）是否会超出其范围。strcat 本质上是通过循环将源字符串逐字节复制到目标中来工作的。当它看到一个称为空终端的值“0”（用“\0”表示）时，它会停止。由于 C 没有内置的边界检查，并且 dest str 只是内存中的一个位置，因此 strcat 将继续进行 ad-infinidium，即使它吹过源 str 或 dest。str 没有空终端。

上述解决方案是特定于您的 Windows 环境的平台。如果您想要独立于平台的东西，则必须与 strncat 争吵：

```
strncat(char* dest, const char* src, size_t count) 
```

这是智能使用时的另一种选择。您可以使用 count 指定要复制的最大字符数。为此，您必须弄清楚 dest 中有多少可用空间（分配了多少 - strlen(dest)）并将其作为计数传递。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-01T20:04:10.183

这是 C/C++ 中可能导致缓冲区溢出错误的字符串操作函数之一。

问题是该函数不知道缓冲区的大小。从 MSDN 文档：

> 第一个参数 strDestination 必须足够大以容纳当前的 strDestination 和 strSource 组合以及一个结束的 '\0'；否则，可能会发生缓冲区溢出。

strcat_s 需要一个额外的参数来告诉它缓冲区的大小。这允许它在执行 concat 之前验证大小，并防止溢出。请参阅[http://msdn.microsoft.com/en-us/library/d45bbxx4.aspx](http://msdn.microsoft.com/en-us/library/d45bbxx4.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-01T22:58:16.930

要关闭警告，您可以执行此操作。

```
#pragma warning(disable:4996) 
```

顺便说一句，我强烈建议您使用 strcat_s()。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T21:15:16.250

strcat 有两个问题。首先，您必须在函数之外进行所有验证，所做的工作与函数几乎相同：

```
if(pDest+strlen(pDest)+strlen(pScr) < destSize) 
```

您必须沿着两个字符串的整个长度走，以确保它适合，然后再沿着它们的整个长度走一遍以进行复制。因此，许多程序员会简单地假设它适合并跳过测试。更糟糕的是，可能是在第一次编写代码时，它是保证适合的，但是当有人添加另一个 strcat，或者在程序的其他地方更改缓冲区大小或常量时，你现在遇到了问题。

另一个问题是 pSrc 和 pDst 是否重叠。根据您的编译器，strcat 很可能是一个简单的循环，它一次检查一个字符是否为 pSrc 中的 0。如果 pDst 覆盖了那个 0，那么您将进入一个循环，该循环将一直运行，直到您的程序崩溃。

# java - 蚂蚁元构建

> ID：936482
> 
> 赞同：2
> 
> 时间：2009-06-01T19:59:32.440
> 
> 标签：java, ant

在 ant 中，有没有一种方法可以组合多个 ant 构建以部署到元项目。例如我有

```
workspace/project1/build.xml
workspace/project2/build.xml 
```

我想做

```
workspace/build.xml 
```

这将在 project1 和 project2 中运行特定目标。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T18:59:22.063

我会推荐[subant](http://ant.apache.org/manual/Tasks/subant.html)任务而不是`ant`or `antcall`。对于上面的示例，在 中使用以下内容`workspace/build.xml`：

```
<subant target="target">
    <fileset dir="${basedir}" includes="project*/build.xml"/>
</subant> 
```

根据需要优化文件集以获取所有项目子目录（用于`**/build.xml`获取包含文件的**所有**`build.xml`子目录）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:57:24.227

[蚂蚁](http://ant.apache.org/manual/Tasks/ant.html)任务就是这样做的。此外还有一个[导入](http://ant.apache.org/manual/Tasks/import.html)任务，可以让您将子 Ant 文件作为较大项目文件的一部分。但实际上，如果子项目的 Ant 文件首先是为此构建的，您可能只会这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T20:08:11.937

我认为这是倒退，不是吗？“ant”允许您指定另一个构建文件，而“antcall”仅用于调用特定目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:04:23.413

“antcall”任务可能是您需要的。它允许您调用其他 ant 文件中的特定目标。您可以选择将所有当前定义的属性和引用传输到调用的目标。

请注意，不要与“ant”目标混淆，后者用于调用当前 ant 文件中的目标。

# mysql - NHibernate、MySQL、Windows Server 2003——连接问题

> ID：936486
> 
> 赞同：1
> 
> 时间：2009-06-01T20:01:06.180
> 
> 标签：mysql, windows-server-2003

我们在 Windows 上的 ASP.NET MVC 应用程序中使用 MySQL (5.0.x)。最近，我们开始在很多地方使用 NHibernate，它在 ASP.NET 应用程序中运行良好。

在 Vista 和 Windows Server 2008 上，它在任何地方都运行良好。我们还有几个使用相同代码库的命令行工具，它们可以在任何地方工作，*除了*我们的 Windows Server 2003 机器（否则在我们可以想象的所有方面都与 WS2K8 相同）。似乎无法建立连接：

```
TIMESTAMP_HERE [1] WARN  NHibernate.Util.ADOExceptionReporter - MySql.Data.MySqlClient.MySqlException: Unable to connect to any of the specified MySQL hosts. ---> System.Exception: Exception of type 'System.Exception' was thrown.
   at MySql.Data.MySqlClient.NativeDriver.Open()
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.NativeDriver.Open()
   at MySql.Data.MySqlClient.MySqlConnection.Open()
   at Our.Common.Services.OurConnectionProvider.GetConnection() inc:\OUR_CODE\blah...\OurConnectionProvider.cs:line 99
   at NHibernate.Impl.SessionFactoryImpl.OpenConnection() 
```

这听起来很熟悉吗？W2K3 与 W2K8/Vista 有什么不同会影响 NHibernate 与 MySQL 的连接吗？

# asp.net - 根据其他 DropDownList VB 填充 DropdownList

> ID：936499
> 
> 赞同：2
> 
> 时间：2009-06-01T20:03:43.663
> 
> 标签：asp.net, vb.net, drop-down-menu

我在互联网上找到了几个例子来做到这一点，但真的很难让它在 VB 中工作。（尝试了转换器，但结果好坏参半）

我需要根据第一个下拉列表中的不同值填充下拉列表的选择选项。

任何人都可以在 VB 中提供一个相关的简单示例吗？如果脚本中的值是“硬编码”的，则不会大惊小怪。或从表中提取数据的 SQL 位

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T20:21:18.230

完成的方式是在第一个下拉列表的 SelectedIndexChanged 事件中填充第二个下拉列表

[示例](http://csharpdotnetfreak.blogspot.com/2009/03/populate-dropdown-based-selection-other.html)：

```
Protected Sub ddlCountry_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)
    Dim CountryID As Integer = Convert.ToInt32(ddlCountry.SelectedValue.ToString())
    FillStates(CountryID)
End Sub

Private Sub FillStates(ByVal countryID As Integer)
  Dim strConn As String = ConfigurationManager.ConnectionStrings("DatabaseConnectionString").ConnectionString
  Dim con As New SqlConnection(strConn)
  Dim cmd As New SqlCommand()
  cmd.Connection = con
  cmd.CommandType = CommandType.Text
  cmd.CommandText = "Select StateID, State from State where CountryID =@CountryID"
  cmd.Parameters.AddWithValue("@CountryID", countryID)
  Dim objDs As New DataSet()
  Dim dAdapter As New SqlDataAdapter()
  dAdapter.SelectCommand = cmd
  con.Open()
  dAdapter.Fill(objDs)
  con.Close()
  If objDs.Tables(0).Rows.Count > 0 Then
    ddlState.DataSource = objDs.Tables(0)
    ddlState.DataTextField = "State"
    ddlState.DataValueField = "StateID"
    ddlState.DataBind()
    ddlState.Items.Insert(0, "--Select--")
  Else
    lblMsg.Text = "No states found"
  End If
 End Sub 
```

使用 html 源代码如下：

```
 <asp:DropDownList ID="ddlState" runat="server" AutoPostBack="True">
  </asp:DropDownList>

  <asp:DropDownList ID="ddlCountry" runat="server" 
  AutoPostBack="True" OnSelectedIndexChanged="ddlCountry_SelectedIndexChanged">
 </asp:DropDownList> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:22:41.680

您可以像这样在 ASPX 页面中以声明方式完成此操作：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:myConnString %>" SelectCommand="SELECT id, name FROM planets"></asp:SqlDataSource>
<asp:DropDownList ID="ddlPlanets" AutoPostBack="true" DataTextField="name" DataValueField="id" DataSourceID="SqlDataSource1" runat="server" AppendDataBoundItems="true" />

<asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:myConnString %>" SelectCommand="SELECT planetid, name FROM moons" FilterExpression="planetid = '{0}'">
    <FilterParameters>
        <asp:ControlParameter Name="planetid" ControlID="ddlPlanets" PropertyName="SelectedValue" />
    </FilterParameters>
</asp:SqlDataSource>      
<asp:DropDownList ID="ddlMoons" DataTextField="name" DataValueField="planetid" DataSourceID="SqlDataSource2" runat="server" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:20:15.533

您最好的选择是在第一个**下拉列表**`SelectedIndexChanged`中捕获事件，检查该**下拉**列表的当前值是什么，然后使用它来清除并填充第二个**下拉列表**中的项目。这样做时，请记住将第一个 DropDownList 的属性设置为.******`AutoPostBack``"true"`******

 ******# vim - 让 gVim 始终运行单个实例

> ID：936501
> 
> 赞同：39
> 
> 时间：2009-06-01T20:03:49.653
> 
> 标签：vim, single-instance

有没有办法让 gVim 只运行一个实例，这样当用它打开一个新文件时，它会自动在当前运行实例的新选项卡中打开？

我知道你可以通过传递来做到这一点，`--remote-tab-silent`但我想配置 gvim 以便这成为默认行为。即，我想键入`gvim filename`并使其表现得好像我将`--remote-tab-silent`选项传递给它一样。

gVim 7.2

### 编辑

我在窗户上（vista）

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-01T20:06:23.050

如果您使用的是 bash shell（在 Linux/OS X/使用 Cygwin 上），请添加您的`~/.bashrc`文件：

```
gvim () { command gvim --remote-silent "$@" || command gvim "$@"; } 
```

在 Windows 上，我认为您可以使用`gvim.bat`批处理脚本来实现相同的效果。

```
gvim.exe -p --remote-tab-silent %1 %* 
```

如果 gvim.exe 不在您的路径中

```
Run > Search "Environment" 
```

编辑当前用户或系统的 PATH 变量。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-01T20:08:21.423

这取决于您的操作系统和外壳。使用 linux，您始终可以设置一个别名，例如：

```
alias gvim='gvim --remote-tab-silent' 
```

在你的`.bashrc`（如果你使用 bash 作为你的登录 shell）。

在 Windows 上，请参阅 Vim wiki 以获取解决方案：http: [//vim.wikia.com/wiki/Launch_files_in_new_tabs_under_Windows](http://vim.wikia.com/wiki/Launch_files_in_new_tabs_under_Windows)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-22T00:46:27.937

我发现`--remote-tab-silent`别名中的选项大部分都可以工作，除非我想将选项传递给 gvim（例如`gvim --serverlist`）-在这种情况下，gvim 将选项视为文字文件名，这不好，因为首先那不是什么你想要，其次你必须从你现在被污染的 vim 会话中清理缓冲区。

对于以下某些情况，使用另一个别名或以不同方式解析`vim`/是不切实际的。`gvim`

*   `gvim`
*   `gvim /path/to/files`
*   `gvim --serverlist`
*   `gvim -p /path/to/file1 /path/to/file2`
*   `gvim -t tag filename`

[正如Tom Veiner](https://stackoverflow.com/users/15890/tom-viner)建议的那样，我的解决方案是以下围绕`gvim`( `~/.bin/gvim`)的包装脚本，但如果没有任何参数是选项，这只会使用现有服务器- 否则，将创建一个新服务器。`gvim`

```
#!/usr/bin/perl

use v5.10;

sub gvim { exec { '/usr/bin/gvim' } '/usr/bin/gvim', @_; }

if (scalar @ARGV) {
  unshift @ARGV, '--remote-tab-silent' unless /^--?/ ~~ @ARGV;
  gvim @ARGV 
}
else {
  chomp(my $serverlist = `gvim --serverlist`);
  if (length $serverlist) {
    gvim '--remote-send', '<Esc>:tabnew<CR>'
  } else { gvim }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-28T22:40:41.743

```
alias tvim="gvim --servername `gvim --serverlist | head -1` --remote-tab" 
```

这使 vim 在同一 vim 实例的新选项卡中打开一个新文件。资料来源：[http ://eustaquiorangel.com/posts/477](http://eustaquiorangel.com/posts/477)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-12T14:15:49.947

## 便携式包装脚本：

我有点厌倦了在 cygwin + windows 中解决这个问题，所以我终于做了一些事情。我从上面定义的包装脚本开始，但我最终使它变得更加健壮，并且能够为 *nix 和 Win 提供多环境支持。

* * *

```
#!/bin/bash
#bash wrapper for windows/cygwin gvim

#####################################################################
## Cygwin/*nix and Windows gvim wrapper script, alias friendly, path friendly
## Author: Matt Gregory (skyleach (AT) geemale (dot) com)
## Version: 1.5
## Date: Thu Jun 12 10:02:54 2014
## Known Bugs:
## Changes:
##      Thu Jun 12 10:04:08 2014 : Initital posting to StackOverflow
#####################################################################

[[ -z ${WINVIM} ]] && WINVIM=true
[[ -z ${VIMRUN} ]] && export VIMRUN='' #scoping
if [[ ${WINVIM} = false ]]; then
    [[ ! ${VIMRUN} ]] && VIMRUN='/bin/gvim'
    ANS=$("${VIMRUN}" --serverlist | grep GVIM)
else
    [[ ! "${VIMRUN}" ]] && VIMRUN='/cygdrive/c/Program Files/vim/vim74/gvim'
    ANS=$(ps -Wsl | grep "${VIMRUN}" | sed -e "s/\s\+\([0-9]\+\).*/\1/g")
fi
[[ ! -z ${VIM} && ${WINVIM} = true ]] && export VIM=$(cygpath -wal "${VIM}")
RT="--remote-tab"
[[ $ANS ]] || unset RT
if [ ! -z ${DEBUG} ]; then
    echo "WINVIM: ${WINVIM}"
    echo "VIMRUN: ${VIMRUN}"
    echo "ANS: ${ANS}"
    echo "VIM: ${VIM}"
fi
#process arguments or stdin
if [ ${#} -ne 0 ]; then
    [[ ! -z ${DEBUG} ]] && echo "Got arguments [${#}]:'${@}'"
    for OFILE in "${@}"; do # if [ -f "${OFILE}" ] || [ -d "${OFILE}" ]; then
        [[ -h ${OFILE} ]] && OFILE="$(readlink -f "${OFILE}")"
        [[ ${WINVIM} == true ]] && OFILE=$(cygpath -wal "${OFILE}")
        echo "\"${VIMRUN}\" --servername GVIM $RT \"${OFILE}\""
        "${VIMRUN}" --servername GVIM $RT "${OFILE}" &
        if [[ -z ${RT} ]] || [[ ! "${RT}" ]]; then
            RT="--remote-tab"
            sleep 5 #give gvim time to start up, running too fast messes things up
        else
            sleep .3 #shorter sleep for tabs
        fi
        #fi
    done
else
    while read OFILE; do
        [[ -h ${OFILE} ]] && OFILE="$(readlink -f "${OFILE}")"
        [[ ${WINVIM} == true ]] && OFILE=$(cygpath -wal "${OFILE}")
        echo "\"${VIMRUN}\" --servername GVIM $RT \"${OFILE}\""
        "${VIMRUN}" --servername GVIM $RT "${OFILE}" &
        if [[ -z ${RT} ]] || [[ ! "${RT}" ]]; then
            RT="--remote-tab"
            sleep 3 #give gvim time to start up, running too fast messes things up
        else
            sleep .3 #shorter sleep for tabs
        fi
    done
fi
# vim: set filetype=sh: 
```

* * *

如何有效地使用它：

*   将上面的代码安装到你路径上的某个脚本文件中
*   将 WINVIM 环境变量添加到 windows 或您的 ~/.bashrc 文件以设置默认脚本行为。真实/使用窗户。错误/使用 x11
*   将某些命令别名为 cygwin 和/或 windows gvim，如下所示：

    echo "alias gwrap='WINVIM=false ~/src/localscripts/wgwrap'" >> ~/.bashrc echo "alias wgvim='wgwrap'" >> ~/.bashrc

*   **注意**：如果 gvim 的硬编码路径对您的系统不正确，您可以直接编辑脚本、别名和/或添加环境变量 WINVIM 和/或 VIMRUN。您可以像我在上面对 gwrap 所做的那样在别名中设置它们，或者您可以将它们添加到您的 .bashrc 或 Windows 系统环境中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-06T13:32:18.377

我经常发现我想转到文件中的特定位置。我发现这样做的唯一方法是：

```
gvim --remote-send '^[:tabnew +$lineno $filename ^M' 
```

其中`^[`是 esc（键入 ctrl-v esc）并且`^M`是 enter（ctrl-v enter）。

希望这可以帮助。如果有人知道如何使用--remote-expr，请给我留言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-29T21:27:23.463

我正在使用 TotalCommander 进行文件浏览。它允许您按“F4”来编辑文件。因此，在“F4 编辑器”选项窗口中，您只需执行以下操作：

```
C:\Program Files (x86)\Vim\vim73\gvim.exe --remote-tab-silent 
```

在我的 win7 64 位机器上工作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-02T12:22:41.363

上面的解决方案不会在第一次执行时启动 gvim 服务器，所以我使用：

```
ANS=`pgrep -fx "$VIM"`

# Launch server if needed
if [[ ! $ANS ]]; then
   $VIM
fi

# Now open the file
if [[ $1 ]]; then
    $VIM --remote-tab "$@"
fi 
```

从[https://stackoverflow.com/a/15335004/214686修改](https://stackoverflow.com/a/15335004/214686)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-09-13T16:25:42.030

**不适用于 WINDOWS**

我使用 MacVim（快照 73）。

将此添加到您的 .bash_profile。

它不会生成“NO NAME”和错误消息。

```
vi() {

    if [[ `mvim --serverlist` == 'VIM' ]]; then
        command mvim --remote-tab-silent "$@"
    else
        command mvim "$@"
    fi
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-12-13T08:55:19.950

使用 MacVim，我发现默认的服务器名称只是 VIM。坚持这个主题，我在我的 bashrc 中加入了以下函数，它就像一个魅力：

```
mvim() { ~/bin/mvim --servername VIM --remote-tab-wait-silent $* & } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-01-17T09:11:43.060

```
gvimt () { [ $# -ne 0 ] && command gvim --remote-silent-tab $@ || command gvim $@; } 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-08-05T20:59:31.687

我实际上正在使用

```
 gvim () { 
    if [ "$#" -gt 0 ]
    then
      gvim --remote-tab-silent "$@" &
    else
      gvim "$@" &
    fi
  } 
```

它杀死错误并且仅在有参数时使用标志

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-08T07:54:44.667

更改注册表中的路径

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Applications\gvim.exe\shell\edit\command 
```

"Path2gvim\gvim.exe" "%1" -->
"Path2gvim\gvim.exe" --remote-tab-silent "%1"

# python - Python 和子进程

> ID：936505
> 
> 赞同：0
> 
> 时间：2009-06-01T20:04:33.457
> 
> 标签：python, loops, subprocess, popen

这是我正在处理的脚本。它应该为下面的循环运行一个 .exe 文件。（顺便说一句，不确定它是否可见，但 for el in ('90','52.6223',...) 在循环之外并与其余部分进行嵌套循环）我不确定排序是否正确或什么不是。此外，当 .exe 文件运行时，它会吐出一些东西，我需要在屏幕上打印出某一行（因此您会看到 AspecificLinfe= ... ）。任何有用的答案都会很棒！

```
for el in ('90.','52.62263.','26.5651.','10.8123.'):

    if el == '90.':
        z = ('0.')
    elif el == '52.62263.':
        z = ('0.', '72.', '144.', '216.', '288.')
    elif el == '26.5651':
        z = ('324.', '36.', '108.', '180.', '252.')
    else el == '10.8123':
        z = ('288.', '0.', '72.', '144.', '216.')

        for az in z:

            comstring = os.path.join('Path where .exe file is')
            comstring = os.path.normpath(comstring) 
            comstring = '"' + comstring + '"'

            comstringfull = comstring + ' -el ' + str(el) + ' -n ' + str(z)

            print 'The python program is running this command with the shell:'
            print comstring + '\n'

            process = Popen(comstring,shell=True,stderr=STDOUT,stdout=PIPE)
            outputstring = myprocesscommunicate()

            print 'The command shell returned the following back to python:'
            print outputstring[0]

                AspecificLine=linecache.getline(' ??filename??   ',     # ??
                sys.stderr.write('az', 'el', 'AREA' )           # ?? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:45:47.977

使用`shell=True`是错误的，因为这不必要地调用了 shell。

相反，请执行以下操作：

```
for el in ('90.','52.62263.','26.5651.','10.8123.'):
    if el == '90.':
        z = ('0.')
    elif el == '52.62263.':
        z = ('0.', '72.', '144.', '216.', '288.')
    elif el == '26.5651':
        z = ('324.', '36.', '108.', '180.', '252.')
    else el == '10.8123':
        z = ('288.', '0.', '72.', '144.', '216.')

    for az in z:

        exepath = os.path.join('Path where .exe file is')
        exepath = os.path.normpath(comstring) 
        cmd = [exepath, '-el', str(el), '-n', str(z)]

        print 'The python program is running this command:'
        print cmd

        process = Popen(cmd, stderr=STDOUT, stdout=PIPE)
        outputstring = process.communicate()[0]

        print 'The command returned the following back to python:'
        print outputstring
        outputlist = outputstring.splitlines()
        AspecificLine = outputlist[22]   # get some specific line. 23?
        print AspecificLine 
```

# php - php 命令返回整个 url，包括获取操作

> ID：936507
> 
> 赞同：1
> 
> 时间：2009-06-01T20:04:54.283
> 
> 标签：php

如何返回包括 get 在内的页面的整个 url。

$_SERVER['HTTP_REFERER'] 和 php_self 不这样做。

他们返回 www.domain.com/example 而不是 www.domain.com/example?user=2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T20:07:54.043

尝试：

```
echo $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; 
```

如果您不想返回域，而只希望返回内部 url 和获取变量，则可以省略 $_SERVER['HTTP_HOST']。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:22:25.263

另一件事`$_SERVER`是数组`$_GET`，`$_POST`,`$_SESSION`和`$_COOKIE`

因此，如果您不确定数据是否包含在这些变量中，请尝试类似的方法。

```
echo "<pre>";
print_r($_SERVER);
echo "</pre>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:08:41.063

[`$_SERVER['REQUEST_URI']`](http://docs.php.net/manual/en/reserved.variables.server.php)包含请求的 URL 路径和查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:09:06.490

$_SERVER['REQUEST_URI'] 可能是您要查找的内容，请记住，如果您希望在“GET”中发送它，则需要对其进行编码。

# c# - 如何渲染 HTML 块？

> ID：936508
> 
> 赞同：0
> 
> 时间：2009-06-01T20:05:56.170
> 
> 标签：c#, .net, html

在应用程序中呈现一大块 HTML 的最佳方式是什么？我们在网页中有一个富文本编辑器控件（来自 Karamasoft），需要生成一个 PDF，其中包含从控件保存的记录（带有自定义页眉、页脚和记录页眉），所以我需要能够呈现html 所以它可以被“绘制”到页面上以保存为 pdf ......有没有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:09:05.400

[HTML Renderer](http://htmlrenderer.codeplex.com)是一个 100% 托管代码库，可绘制格式精美的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:11:30.963

在不使用任何库的情况下，您可以使用[Literal](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.literal.aspx)控件来注入您希望向用户显示的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T17:51:51.357

您可以尝试 PURE 以 HTML 格式呈现 JSON 数据：http: [//beebole.com/pure/](http://beebole.com/pure/)

虽然这可能是题外话。

但后来我对如何将 HTML 转换为 PDF 很感兴趣。

涉及哪些技术步骤？

# sql - 使用正则表达式更新字段的 Postgresql 查询

> ID：936513
> 
> 赞同：15
> 
> 时间：2009-06-01T20:07:13.063
> 
> 标签：sql, regex, postgresql

我的“Street_Address_1”列中有以下数据：

> 大街 123 号

使用 Postgresql，我将如何编写查询来更新我的地址表中的“Street_Name”列？换句话说，“Street_Name”是空白的，我想用“Street_Address_1”列中包含的街道名称值填充它。

据我所知，我想使用“regexp_matches”字符串方法。不幸的是，我没有太多的运气。

注意：您可以假设所有地址都采用“StreetNumber StreetName StreetType”格式。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-01T20:26:42.180

就像是...：

```
UPDATE table
SET Street_Name = substring(Street_Address_1 FROM '^[0-9]+ ([a-zAZ]+) ') 
```

请参阅[PGSQL 8.3.7 docs](http://www.postgresql.org/docs/8.3/static/functions-matching.html#FUNCTIONS-POSIX-REGEXP)中的相关部分`substring`，该部分在该部分开始后不久详细说明。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-12-29T16:10:30.370

如果您只想获取 Street_Address_1 并去掉任何前导数字，您可以这样做：

```
UPDATE table
SET street_name = regexp_replace(street_address_1, '^[0-9]* ','',''); 
```

这采用 street_address_1 中的值并将任何前导数字字符串（加上一个空格）替换为空字符串（第四个参数用于可选的正则表达式标志，如“g”（全局）和“i”（不区分大小写））。

这个版本允许像“1212 15th Street”这样的东西正常工作。

# algorithm - 开发算法的人和开发人员之间最有效的工作流程是什么？

> ID：936514
> 
> 赞同：3
> 
> 时间：2009-06-01T20:07:26.230
> 
> 标签：algorithm, language-agnostic, communication

我们正在开发视频模式识别软件。我们有 7 位数学家正在创建算法。另外，我们有 2 名开发人员使用这些算法维护/开发应用程序。问题是数学家正在使用不同的开发工具来创建像 Matlab、C、C++ 这样的算法。同样因为他们不是开发人员，所以不会过多关注内存管理或多线程。这是应用程序的原因之一。有很多错误。

如果你的公司有类似的情况，你会怎么处理？您可以推荐哪些用于创建算法的最佳工具？数学家和开发人员之间应该进行什么样的交流？您认为使用高级工具最有效的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T20:46:08.180

我不确定您的开发人员是否正在重写数学家的东西，或者您是否只需要与之交互，所以我不确定我的答案是否有用。

但是：我与一群博士候选人和博士后一起在机器学习库上工作，我自己也是一名学生。在那个过程中，我开始将很多算法从 python/numpy 翻译成 C++/blas。

这个过程可能非常乏味——尤其是对于数值和随机算法，很难找到错误。

所以这就是我所做的：获取一些示例输入并使用 python 代码计算结果。用这些为 C++ 生成单元测试，然后开始用 C++ 对它们进行编码。

在此设置中，检查具体的样本输入和输出是*必不可少的。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T22:47:53.957

我同意马卡赫的观点。

让创建算法的人使用他们最熟悉的工具。因为在这个项目中有两个独立的（同样重要的）任务需要处理。首先，创建一个高效、优雅和适当的数学上合理的算法，然后是把它翻译成 CPU 语言的艰巨任务。数学家应该专注于他们的第一个任务，为了让他们更容易，让他们使用他们熟悉的工具。就工时而言，编写 MATLAB 代码比让他们学习一门新的编程语言更有效地利用他们的时间。

你的任务是发掘隐藏在乱码中的（大概）出色的数学。

那部分只是对手头问题的看法。这是实际的答案。

沟通、相互尊重和教学/学习。

**沟通与相互尊重**

你必须经常与他们交流。与他们密切合作，并在遇到不确定的事情时向他们提问。当相互尊重时，这会容易得多，这意味着如果你把所有的时间都花在批评他们的编码能力上，那么他们将被迫把所有的时间都花在批评你的数学能力上。相反，尝试快速学习课程。（“午餐和学习”是一种相当常见的策略）

**教学/学习**

传授给他们的第一个也是最重要的智慧是评论。让他们评论代码中的废话。告诉他们评论比代码质量重要得多，只要他们的评论是对的，剩下的就交给你们了。因为他们可以。他们不需要让他们的代码看起来很漂亮，因为要最快，他们只需要它对你们有意义。

为了继续这个相互学习的场景，如果你注意到他们犯了一些非常简单非常常见的错误，（没有什么像多线程那么复杂），请快速提醒他们。“这种方式有效（或无效），但这是一种有点不同的方式，但它会让你的生活更轻松。” 鼓励他们通过尝试注意您和您的团队在算法的哪些细微差别或部分中遇到困难并教一些关于它的小教程来回报。

一旦你们的沟通顺畅，你会发现将他们的编码风格塑造成最适合你的团队的方式变得越来越容易，他们也会更容易理解为什么你不以他们的方式看待它.

此外，正如 Kekoav 所提到的，确保它们提供了一些完全加载的测试用例。这意味着像

A -> B -> C -> D -> 解决方案

他们会为您提供 A 的所有值，然后是 B 的样子，然后是 C 的样子等等。这样你就可以确定它不仅在最后是正确的，而且在每一步都是正确的。尝试让他们提供常规示例，以及其中一些不寻常的示例，以便您可以确定您的代码涵盖了边缘情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T20:13:32.503

我建议开发人员花几个小时习惯 Matlab，尤其是 Matlab 调试器。如果他们的背景是 CS，那么他们在理论上已经熟悉向量和矩阵，如果不是实践的话。除了作为默认数据结构的矩阵之外，Matlab 类似于 C 并且很容易解释为另一种语言的翻译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T20:20:39.667

我最近一直在和一位物理学教授一起工作，并且对此有一点经验（尽管我承认我不是专家）。

我不得不将很多 Matlab 代码翻译成另一种语言。这很困难，因为很多（大多数）操作都不存在，包括在精度方面，以及使用矩阵和向量时。需要找到或创建一个好的数学库以满足您的需求。

我发现的最好方法是执行以下操作：

1.  让算法在新语言中正常工作。
2.  创建一些测试以验证算法是否产生了所需的输出。让您的数学家验证您转换后的解决方案确实有效，并且您的测试涵盖了所有基础。
3.  然后在它工作之后，你可以相信你的测试，优化算法以成为良好的编码风格，具有良好的设计和性能特征。使用你的回归测试来确保你没有破坏任何东西。

我通常从将他们的算法逐字复制到另一种语言开始，然后从那里开始工作，无论我是否进行大量测试。

首先获得一个工作副本很重要，以防性能真的不是问题并且您需要继续做其他事情并且可以稍后再回来以使其更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T20:20:46.857

这是你的工作。您如何处理这就是您作为系统开发人员的标识。

与您的同事沟通。绘图和解释，开会，商定并设定标准要求，按照你的计划和你的项目经理交谈。确保您的相关同事参加会议。进行1-1会谈等

您不能将其归咎于开发人员创建错误的数学家。担心实施是他们的工作，而不是数学家。

# safari - Safari 浏览器不会显示错误 401 页面

> ID：936523
> 
> 赞同：3
> 
> 时间：2009-06-01T20:09:27.083
> 
> 标签：safari, apache2, http-status-code-401, mod-perl2, custom-error-pages

我正在使用 Apache 2 并在 httpd.conf 中有一个自定义 401 页面

```
ErrorDocument 401 /error/unauthorized.html 
```

当我访问受保护的资源时，所有浏览器都会显示基本的 http 身份验证对话框。如果我单击“取消”，除 Safari（v3 和 v4）之外的所有浏览器都将显示自定义 401 页面。Safari 只显示当前页面。

有没有办法让 Safari 通过 Apache 配置和/或 mod_perl 处理程序显示 401 页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T21:42:08.723

天，

我相信这是 Safari 浏览器的一个众所周知的问题。事实上，HTTP 身份验证的几个方面都受制于“特殊”Apple 实现。

对不起，我不能给你一个快速的解决方法。

干杯，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T20:50:42.120

我无法在 Safari 4 Beta 中重现该错误，但请尝试在您的未授权.html 文件中添加一些字节。某些版本的 IE 不会显示自定义错误页面，除非页面超过一定大小，它假定小页面是默认的无用页面，并试图显示更有用的内容（也就是令人困惑的内容）。

# linq - 使用 Linq 时，DbNull 是否等同于 Null？

> ID：936524
> 
> 赞同：6
> 
> 时间：2009-06-01T20:09:53.213
> 
> 标签：linq, tsql, null

这与 DBNull 与 Null**无关。**我明白其中的区别。

我想知道的是，如果我使用 Linq，比如说访问 User.EmailAddress，然后检查 User.EmailAddress == null 是否与User.EmailAddress == DBNull**相同，是否正确？**

我的理由是数据库中没有数据会导致 Linq 不生成对象引用，这意味着 null 在与 Linq 一起使用时实际上等同于 DBNull。

我的推理是否正确？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T20:15:13.873

您不应该将 DBNull 与 LinqToSql 一起使用。重点是语言整合，因此一个概念或名称`null`就足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-08T17:24:55.483

这是适用于 Visual Basic 的 LINQ to SQL 的 select 语句。我认为它在 C# 中是一样的。

```
User.EmailAdress.Equals(Nothing) 
```

例如：

```
Dim EmptyEmailAddressEntries = From User in DC.Users _
    Where User.EmailAddress.Equals(Nothing) select User 
```

将为您提供电子邮件地址中没有任何内容的所有用户。要检查带有空格“”字符的条目，只需添加

或者

```
User.EmailAddress = "" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:17:34.790

在 LINQ to SQL 中，您应该使用 null 而不是 DBNull。LINQ to SQL 是一个 OR 映射器，因此它以本机方式处理对象。L2S 的全部目标是允许您以标准的 .NET 方式处理对象，并让 L2S 为您处理本机和数据库之间的所有映射。您应该避免在任何 L2S 语句中使用 DBNull ......事实上，我什至不确定这是否是一个有效的检查（如果它完全有效，它可能会导致一些奇怪的行为。）

# app-store - MobileStore 的多个帐户？

> ID：936526
> 
> 赞同：0
> 
> 时间：2009-06-01T20:10:49.700
> 
> 标签：app-store, ovistore

如果您正在为客户处理程序的发布，您是否需要为每个人创建一个帐户，或者您可以使用您的帐户并在每个应用程序的基础上更改版权/编辑器/内容？
在 AppStore 上，帐户的所有者似乎自动显示在编辑器部分。
我没有找到可以改变它的地方。所以我想知道 ovistore 是否也一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T07:48:49.147

是的，Ovi 也一样！

# asp.net - IIS 7 上的 ASP.NET 路由不断恢复

> ID：936531
> 
> 赞同：0
> 
> 时间：2009-06-01T20:12:03.530
> 
> 标签：asp.net, iis-7

我已将 ASP.NET MVC Web 应用程序部署到 IIS 7 服务器。它位于 www 文件夹的根目录中。有一个子文件夹不属于需要正常提供的应用程序的一部分。所以我在我的 MVC 应用程序路由中添加了一些代码。

基本上我：

```
 routes.IgnoreRoute(name);
  var ignore_route = string.Concat(name, @"\/(.*)");
  routes.IgnoreRoute("{*path}", new { path = ignore_route }); 
```

这话完美。一阵子。然后它会破裂。具体来说，转到“/subDirectory”（即没有尾部斜杠）会给出“401 - 未经授权：由于凭据无效，访问被拒绝”。这不会打扰我，除了由于野外的名片给 subDirectory url 而没有尾部斜杠这一事实。它必须工作。

它在我的开发机器上总是可以正常工作，但它没有在 IIS 上运行。

我不明白它是如何工作一段时间然后中断的。如果我复制程序集，它会再次开始工作，然后在第二天停止。

一种可能性是，当我第一次部署此 Web 应用程序时，此代码不存在。后来当我们意识到需要有可以正常提供的子目录时，我不得不添加它。所以我的第一个直觉是它以某种方式恢复到旧版本的程序集。不过，我不知道这会如何发生。当我通过 ftp 访问目录时，修改的日期是正确的。我对服务器的唯一访问是通过 ftp，但本应帮助我解决此问题的服务器管理员却令人沮丧地缺席了。我无计可施。有任何想法吗？

编辑：我不知道为什么这被发送到这里堆栈溢出。这显然是服务器问题，不是吗？看第一反应！它在谈论服务器。代码工作正常。我们可以将其引导回它所属的服务器故障吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T20:22:24.687

可能是您的服务器偶尔重新启动 HttpApplication 并且您正在检查一个布尔值以查看它是否已配置并保持为真，因此您不添加路由？

# c# - 清除 SqlDataSource 中的缓存

> ID：936538
> 
> 赞同：12
> 
> 时间：2009-06-01T20:13:48.027
> 
> 标签：c#, .net, caching, sqldatasource

我需要在启用缓存的情况下手动清除 SqlDataSource 上的缓存。我尝试设置 EnableChaching = false 和 CacheDuration = 0（以及 = 1），但似乎没有一个会使缓存中的内容过期 - 尽管它们似乎确实阻止了新的 SELECT 被缓存。

如何手动使该缓存过期？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-11-09T20:23:33.257

我今天刚开始研究这个并遇到了这篇文章，这看起来是最好的解决方案：

[以编程方式使 SqlDataSource 缓存无效的简单方法](http://beatgates.blogspot.com/2009/11/simple-way-to-invalidate-sqldatasource.html)

```
<asp:SqlDataSource ID="x" EnableCaching="True" CacheKeyDependency="MyCacheDependency"/>

protected void Page_Load(object sender, EventArgs e)
{ // Or somewhere else before the DataBind() takes place
  if (!IsPostBack)
  {
      //prime initial cache key value if never initialized
      if (Cache["MyCacheDependency"] == null)
      {
        Cache["MyCacheDependency"] = DateTime.Now;
      }
  }
}

// Evict cache items with an update in dependent cache:
Cache["MyCacheDependency"] = DateTime.Now; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:42:17.203

禁用缓存 (EnableCaching = false)，然后在重新启用缓存之前强制执行新的选择 (SqlDataSourceInstance.Select(new DataSourceSelectArguments())) 会清除选中的 CommandText 和 CommandParameters 的特定组合，因此这是一个开始。

但是，它仍然保留由 SqlDataSource 执行的其他查询组合的缓存，因此这并不能解决所有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:42:57.687

确保您的 CacheExpirationPolicy 是绝对的。使用非零 CacheDuration（0 表示无限缓存持续时间）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-07T09:26:32.873

我遇到了同样的问题，尽管“EnableCaching=false”。
在重负载下，我看到发生了一些缓存。这种缓存导致我错过了很多数据。
我发现它可能与缓存有关。
所以我`Response.Cache.SetCacheability(HttpCacheability.NoCache);`在我的代码后面使用。它似乎有效，12 小时后我没有丢失最少的数据。

# mysql - 如何将我的重写规则存储在数据库中？

> ID：936539
> 
> 赞同：3
> 
> 时间：2009-06-01T20:13:49.290
> 
> 标签：mysql, apache, .htaccess, url-rewriting

我正在开发一个新站点，我想将我的重写规则存储在数据库中，而不是直接存储在 .htaccess 文件中。

我有另一个使用 Opensef ( [http://sourceforge.net/projects/opensef/](http://sourceforge.net/projects/opensef/) ) 和 Joomla 的网站！正在执行此操作的安装，但我什至没有 100% 了解它在引擎盖下是如何工作的。

如何将这些规则存储在数据库中，根据请求查询它们并在找到时重定向到干净的 URL？有没有更好的方法来代替加载 .htaccess 文件（可能有 1000 个条目）？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T20:19:33.850

**您可以让 mod_rewrite从外部源**生成映射，例如执行 PHP 或 Python 文件，这些文件可以从数据库中获取数据并创建 mod_rewrite 映射。

[http://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html) （见右下角）

例如

```
RewriteMap    quux-map       prg:/path/to/map.quux.pl 
```

**祝你好运**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T17:15:42.350

假设所有这些页面最终都在 Joomla 中，我认为使用 .htaccess 或 mod_rewrite 是一个错误。

我认为您最好学习 Openserf 的工作原理。我想它有一小段代码可以在每个查询数据库的请求早期运行，如果有命中则通过 PHP 发出重定向。这种方法的另一个优点是，它甚至可以让 Joomla 在其页面上重写链接以首先指向干净的版本，从而为用户节省不必要的重定向

顺便说一句，这就是 Drupal 中的 Pathauto 模块的工作方式，我一直在一些拥有数千页的大容量网站上使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-10T12:55:40.240

我认为使用存储在数据库中的规则的最佳方法是：

*   通过站点的管理面板将规则存储在数据库中。
*   然后在更新数据库后，使用您的服务器端语言解决方案使用 DB 中的规则生成一个新的 .htaccess。
*   将旧的 .htaccess 替换为新的。

这避免了服务器负载。它类似于 Aiden Bell 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:19:41.883

抓住[UrlRewriteFilter](http://tuckey.org/urlrewrite/)，将其屠宰以使用数据库，并在 Tomcat 而不是 Apache 中使用它。

Tomcat 是一个很好的 Web 服务器，可以做 Apache 可以做的很多事情（比如 PHP 的 FastCGI），与为 Apache 编写类似的东西相比，为它编写这样的东西是微不足道的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-12T19:30:59.950

您可能想要的是一个单一的重写规则来处理传入的每个未知请求，然后将其传递给一个小脚本，该脚本将处理查找并生成重定向。您甚至可以完全跳过重写规则并使用 Apache [ErrorDocument 指令](http://httpd.apache.org/docs/2.0/mod/core.html#errordocument)将未知 URLS 传递到脚本中。

你对这个“新网站”的细节非常了解，但是，你可能想考虑为自己构建一个应用程序的[前端控制器](http://en.wikipedia.org/wiki/Front_controller)并让它处理所有传入的 URL。许多（大多数？）网络应用程序框架采用这种方法。

# c# - Math.Pow 与乘法运算符（性能）

> ID：936541
> 
> 赞同：43
> 
> 时间：2009-06-01T20:14:25.200
> 
> 标签：c#, .net, performance, pow

任何人都知道乘法运算符是否比使用 Math.Pow 方法更快？像：

```
n * n * n 
```

对比

```
Math.Pow ( n, 3 ) 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-01T21:33:54.510

我刚刚重新安装了 Windows，所以没有安装 Visual Studio，代码很丑

```
using System;
using System.Diagnostics;

public static class test{

public static void Main(string[] args){
    MyTest();
    PowTest();
}

static void PowTest(){
    var sw = Stopwatch.StartNew();
    double res = 0;
    for (int i = 0; i < 333333333; i++){
        res = Math.Pow(i,30); //pow(i,30)
    }
    Console.WriteLine("Math.Pow: " + sw.ElapsedMilliseconds + " ms:  " + res);
}

static void MyTest(){
    var sw = Stopwatch.StartNew();
    double res = 0;
    for (int i = 0; i < 333333333; i++){
        res = MyPow(i,30);
    }
    Console.WriteLine("MyPow: " + sw.ElapsedMilliseconds + " ms:  " + res);
}

static double MyPow(double num, int exp)
{
    double result = 1.0;
    while (exp > 0)
    {
        if (exp % 2 == 1)
            result *= num;
        exp >>= 1;
        num *= num;
    }

    return result;
}
} 
```

结果：
csc /o test.cs

测试程序

```
MyPow: 6224 ms:  4.8569351667866E+255  
Math.Pow: 43350 ms:  4.8569351667866E+255 
```

通过平方求幂（参见[https://stackoverflow.com/questions/101439/the-most-efficient-way-to-implement-an-integer-based-power-function-powint-int](https://stackoverflow.com/questions/101439/the-most-efficient-way-to-implement-an-integer-based-power-function-powint-int)）比 Math.Pow 快得多在我的测试中（我的 CPU 是 2 Ghz 的 Pentium T3200）

编辑：.NET 版本是 3.5 SP1，操作系统是 Vista SP1，电源计划是高性能的。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-01T20:16:41.623

基本上，您应该进行**基准测试**。

### 受过教育的猜测（不可靠）：

*如果某些编译器没有针对同一事物进行优化...*

这很可能`x * x * x`比`Math.Pow(x, 3)`在`Math.Pow`一般情况下处理问题、处理分数幂和其他问题要快，而`x * x * x`只需要几个乘法指令，所以它很可能更快。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-06-08T03:07:08.040

10 多年图像处理和科学计算优化的经验法则：

算法级别的优化胜过任何低级别的优化。尽管“写显而易见，然后优化”的传统智慧，这必须在一开始就完成。不是之后。

手工编码的数学运算（尤其是 SIMD SSE+ 类型）通常会优于完全错误检查的通用内置运算。

编译器预先知道需要做什么的任何操作都由编译器优化。其中包括： 1\. 内存操作，例如 Array.Copy() 2\. 给定数组长度的数组上的 For 循环。如 ( `..; i<array.Length;..`)

总是设定不切实际的目标（如果你愿意的话）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-20T12:10:47.950

我昨天碰巧测试了这个，然后现在看到了你的问题。

在我的机器上，运行 1 个测试线程的 Core 2 Duo，使用乘法到 9 倍会更快。在 10 时，Math.Pow(b, e) 更快。

然而，即使是 2 倍，结果也常常不相同。存在舍入误差。

一些算法对舍入误差高度敏感。在我发现这一点之前，我不得不进行超过一百万次随机测试。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-01T20:22:29.943

这太微不足道了，您可能应该针对特定平台对其进行基准测试，我认为 Pentium Pro 的结果不一定与 ARM 或 Pentium II 的结果相同。

总而言之，它很可能完全无关紧要。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-01T20:29:30.617

我检查了，并被`Math.Pow()`定义为采取两个双打。这意味着它不能进行重复乘法，而是必须使用更通用的方法。如果有`Math.Pow(double, int)`，它可能会更有效。

话虽如此，性能差异几乎可以肯定是微不足道的，因此您应该使用更清晰的那个。像这样的微优化几乎总是毫无意义的，几乎可以在任何时候引入，并且应该留到开发过程的最后。那时，您可以检查软件是否太慢，热点在哪里，然后将您的微优化工作花在真正会产生影响的地方。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T20:39:22.797

让我们使用约定 x^n。假设 n 始终是一个整数。

对于较小的 n 值，无​​聊的乘法会更快，因为 Math.Pow（可能取决于实现）使用花哨的算法来允许 n 为非整数和/或负数。

对于较大的 n 值，Math.Pow 可能会更快，但如果您的库不是很聪明，它将使用相同的算法，如果您知道 n 始终是整数，这并不理想。为此，您可以[通过平方](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)或其他一些花哨的算法来编写求幂的实现。

当然，现代计算机速度非常快，您可能应该坚持使用最简单、最容易阅读、最不可能出错的方法，直到您对程序进行基准测试并确定使用不同的算法会获得显着的加速。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-22T09:02:20.413

`Math.Pow(x, y)`通常在内部计算为`Math.Exp(Math.Log(x) * y)`。每个幂方程都需要找到自然对数、乘法并`e`求幂。

正如我在之前的回答中提到的，只有 10 的幂会`Math.Pow()`变得更快，但是如果使用一系列乘法，准确性会受到影响。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-20T18:31:37.077

我不同意手工构建的功能总是更快。余弦函数比我能写的任何东西都更快、更准确。至于 pow()。我做了一个快速测试，看看 Math.pow() 在 javascript 中有多慢，因为 Mehrdad 告诫不要猜测

```
 for (i3 = 0; i3 < 50000; ++i3) { 
      for(n=0; n < 9000;n++){ 
        x=x*Math.cos(i3);
      }
    } 
```

结果如下：

```
Each function run 50000 times 

time for 50000 Math.cos(i) calls = 8 ms 
time for 50000 Math.pow(Math.cos(i),9000) calls = 21 ms 
time for 50000 Math.pow(Math.cos(i),9000000) calls = 16 ms 
time for 50000 homemade for loop calls 1065 ms 
```

如果您不同意，请尝试[http://www.m0ose.com/javascripts/speedtests/powSpeedTest.html上的程序](http://www.m0ose.com/javascripts/speedtests/powSpeedTest.html)

# asp.net - 使用来自 jquery 错误的参数调用 asp.net webmethod

> ID：936542
> 
> 赞同：1
> 
> 时间：2009-06-01T20:14:32.377
> 
> 标签：asp.net, jquery, ajax, web-services, asmx

我设法设置了一个简单的 webmethod，我从 jquery 调用它并确定它返回......然后我在方法上添加了参数并将参数添加到 jquery 但它出错了

```
 Message":"Invalid JSON primitive: one.","StackTrace":" 
```

我在 webmethod 上的签名是这样的

```
 [WebMethod]
    public static string GetDate(string one, string two)
    {
        return "yes";
    } 
```

我的jquery是这样的，我做错了什么？

```
 $.ajax({
                type: "POST",
                url: "MyService.aspx/GetDate",
                data: { one: "value", two: "value" },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(msg) {
                    alert(msg.d);
                },
                error: function(msg) {
                alert('error');
                }

            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T20:17:52.963

尝试用引号将您的数据参数括起来：

```
data: '{ one: "value", two: "value" }', 
```

# c# - 在使用 C# 的 Windows 窗体应用程序中正确使用 OnClick 与 MouseClick 事件

> ID：936544
> 
> 赞同：5
> 
> 时间：2009-06-01T20:15:48.460
> 
> 标签：c#, .net, winforms, events

我目前正在开发一个自定义控件，并意识到我的代码正在运行两次。这并不是一个真正的大问题（它只是一个 Focus 方法调用）。不过，我想理解它。

从阅读[MSDN 描述中单击 | onclick 事件](http://msdn.microsoft.com/en-us/library/ms536913(VS.85).aspx)，它指出：

> 当用户在对象上单击鼠标左键时触发。

所以我添加了 OnClick 事件和 MouseClick 事件来处理左右单击。但是在调试完代码后，我发现 OnClick 同时处理了左右点击事件。

为什么 OnClick 会同时处理这两个事件，出于某种我忽略的原因，我是否需要将这两个事件都保留在我的代码中？

```
protected override void OnClick(EventArgs e)
{

   this.Focus();
   base.OnClick(e);
}

private void CustomControl_MouseClick(object sender, MouseEventArgs e)
{       
   if (e.Button == MouseButtons.Right)
   {
      rightClickMenu(e);
   }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T20:30:04.017

[根据 MSDN](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.click)，Click 事件不仅在单击鼠标时调用，而且在按下 Enter 按钮时调用。如果您只需要处理鼠标点击，我会在 MouseClick 事件中移动您的所有代码。您不能以相反的方式执行此操作，因为 Click 事件不会告诉您单击了哪个鼠标按钮（如果有）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T20:32:39.937

首先，您的链接不正确，它链接到 HTML 和 DHTML 参考，而不是 WinForms :) 正确的链接是[Control.MouseClick 事件](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.mouseclick "Control.MouseClick 事件")
您只需要重写一个方法。如果您只想处理鼠标点击 - 覆盖 OnMouseClick() 并且不处理 MouseClick 事件，否则 - 覆盖 OnClick() 并且不覆盖 OnMouseClick()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:22:12.457

您不需要同时拥有这两个事件......只需保留 OnClick。

另外，我已经有一段时间没有做过 Windows 窗体了，但我认为接受焦点比手动设置点击事件更好的方法，但我不能具体告诉你它是什么......我认为有它的财产或其他东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:23:29.503

在 Winforms 中，单击任一鼠标键时都会引发 Click 事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-02T17:05:34.043

如果我没记错的话，单击鼠标和“Enter”键，甚至使用“Tab”键将焦点设置在控件上，然后使用“Space”或“Enter”“单击”它。

如果这种行为是可以接受/期望的，您可以执行以下操作。

我有一个 DoubleClick 事件的解决方法......

```
void ControlClick(object sender, EventArgs e)
{
    MouseEventArgs mEvt=e as MouseEventArgs; // or (MouseEventArgs)e;

    // now mEvt has the same properties as 'e' in MouseClick event
} 
```

希望这可以帮助。

-努尔赤

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-06-01T20:30:18.320

OnClick 和 CustomControl_MouseClick**是同一个事件**

您可以将多少个方法附加到一个事件（ this.Click += ...）

# ruby-on-rails - apache权限错误

> ID：936549
> 
> 赞同：4
> 
> 时间：2009-06-01T20:16:50.437
> 
> 标签：ruby-on-rails, apache, permissions, passenger

我有一个带有Passenger Phusion 的Ubuntu Hardy 切片，它提供了一个rails 应用程序。我也在使用带有thinking_sphinx插件的sphinx全文搜索

我可以从终端运行这个命令：

sudo rake ts:index RAILS_ENV=production

但如果此命令在 capistrano 部署文件中：

运行“cd #{current_path}; rake thinking_sphinx:index RAILS_ENV=production”

产生以下错误：

*   执行“部署：after_update”
    *   执行“thinking_sphinx:index”
    *   执行“cd /home/kollar/apps/kinfonet/current; rake thinking_sphinx:index RAILS_ENV=production” 服务器：[“173.45.226.102”] [173.45.226.102] 执行命令 *** [err :: 173.45.226.102] rake 中止！*** [err :: 173.45.226.102] 权限被拒绝 - /home/kollar/apps/kinfonet/shared/db/sphinx

假设这是 apache 的权限问题，我关注了关于 slicehost 文档的文章并做了以下操作：

sudo chgrp -R www-data /home/kollar/apps/kinfonet/current

sudo chmod -R 2750 /home/kollar/apps/kinfonet/current

sudo chmod -R 2770 /home/kollar/apps/kinfonet/current/log

sudo chmod -R 2770 /home/kollar/apps/kinfonet/shared

sudo chmod -R 2770 /home/kollar/apps/kinfonet/shared/db

sudo chmod -R 2770 /home/kollar/apps/kinfonet/shared/db/sphinx

sudo chmod -R 2770 /home/kollar/apps/kinfonet/shared/pids

错误仍然存​​在，现在该网站的访问者无法访问他们位于 /home/kollar/apps/kinfonet/shared/system/avatars 中的个人资料图片

如果我在浏览器上调用图像的路径，则会出现 apache/passenger 禁止错误：您无权访问此服务器上的 /system/avatars/48/thumb_BR.jpg

有人可以帮助修复权限 - 即撤消我对 www-data 所做的任何事情并告诉我如何设置适当的权限吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T20:39:40.390

如果您仍然看到 403 Forbidden 错误，那么您需要告诉 Apache 从您的 to 遵循该符号链接是可以`app/current/system`的`app/shared/system`。确保你的虚拟主机定义中有这个：

```
Options FollowSymLinks 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T07:04:39.997

感谢您尝试提供帮助。

1.  “哪个用户在远程服务器上运行部署命令？” -- 用户是 kollar

2.  当您在*没有*sudo 的情况下与该用户运行相同的 rake 任务时会发生什么？

让它工作。在 shared/db 上运行 ls-l 并看到它被设置为 root 作为用户和 root 作为组。将两者都更改为我的用户“kollar”，现在 rake 可以从 cap deploy.rb 文件运行而无需 sudo。

我最大的问题仍然是 apache 在尝试访问存储用户上传图像的共享/系统文件夹时返回了 Forbidden 403 权限错误：

您无权访问此服务器上的 /system/avatars/51/thumb_DSC00010.JPG。Apache/2.2.8 (Ubuntu) Phusion_Passenger/2.2.2 服务器端口 80

从 /home/path/to/app/current/system 到 /home/path/to/app/shared/system 有一个符号链接

在共享/系统上运行 ls -l 会产生：drwxrws--- 7 kollar kollar 4096 Jun 2 06:47 avatars

我尝试在此文件夹中添加 www-data 作为组，但这似乎并不能解决问题。对此的任何帮助将不胜感激。

# python - 如何在python中的线程之间传递异常

> ID：936556
> 
> 赞同：7
> 
> 时间：2009-06-01T20:17:57.987
> 
> 标签：python, multithreading, exception

我需要跨线程边界传递异常。

我正在使用嵌入在非线程安全应用程序中的 python，该应用程序具有一个线程安全调用 post_event(callable)，它从其主线程调用 callable。

我在单独的线程中运行 pygtk gui，因此当单击按钮时，我使用 post_event 发布事件，并等待它完成后再继续。但我需要调用者知道被调用者是否抛出异常，如果是，则引发异常。我不太担心回溯，只是异常本身。

我的代码大致是：

```
class Callback():
    def __init__(self,func,*args):
        self.func=func
        self.args=args
        self.event=threading.Event()
        self.result=None
        self.exception=None
    def __call__(self):
        gtk.gdk.threads_enter()
        try:
            self.result=self.func(*self.args)
        except:
            #what do I do here? How do I store the exception?
            pass
        finally:
            gtk.gdk.threads_leave()
            self.event.set()
    def post(self):
        post_event(self)
        gtk.gdk.threads_leave()
        self.event.wait()
        gtk.gdk.threads_enter()
        if self.exception:
            raise self.exception
        return self.result 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-01T20:41:14.540

> #我在这里做什么？如何存储异常？

使用`sys.exc_info()[:2]`，请参阅[此 wiki](http://pyref.infogami.com/sys.exc_info)

线程之间通信的最佳方式是[Queue](http://docs.python.org/library/queue.html)。让主线程实例化一个`Queue.Queue`实例并将其传递给子线程；当子线程有一些东西要与它`.put`在该队列上使用的主线程进行通信时（例如，具有线程 ID、异常类型、异常值的元组——或者，其他有用的信息，不一定与异常相关，只需确保第一项一个元组标识信息的种类；-)。主机可以`.get`在需要时返回这些信息单元，并提供各种同步选择等。

# c# - LINQ to Entity Framework Many-Many Eager Loading 问题

> ID：936558
> 
> 赞同：2
> 
> 时间：2009-06-01T20:18:33.540
> 
> 标签：c#, .net, linq, entity-framework, eager-loading

我有以下查询：

```
var MyQuery = from e in ContractContext.Equipments.Include("Manufacturers")
              where e.Customers.ID == customer.ID
              select e; 
```

一切正常，我得到了我的设备，它正确（急切地）加载了制造商表。但是当我尝试执行以下多对多查询时：

```
var MyQuery = from e in ContractContext.Equipments.Include("Manufacturers")
              where e.Customers.ID == customer.ID
              from cce in e.ContractEquipments
              where cce.Contracts.EndedOn >= DateTime.Today
              select e; 
```

其中 "ContractEquipments" 是 "Equipments" 和 "Contracts" 之间的多对多查找，但是当此查询运行时，不再容易加载制造商表。知道如何在不执行以下操作的情况下解决此问题：

```
if (MyEntity.Manufacturers.IsLoaded == false) 
   MyEntity.ManufacturersReference.Load() 
```

这个项目需要几个小时执行，我想减少数据库调用的数量。

编辑＃1：

我也试过这个没有成功：

```
var MyQuery = from e in ContractContext.Equipments.Include("Manufacturers")
              where e.Customers.ID == customer.ID
              join cce in ContractContext.ContractEquipments 
                on e.ID equals cce.Equipments.ID
              where cce.Contracts.EndedOn >= DateTime.Today
              select e; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T04:09:02.310

早期包含经常在某些类型的查询中丢失（即额外的连接等）

解决这个问题的方法是进行查询，（然后只要您返回实体，即选择 e 而不是投影，即选择新 {...}），您可以转换为 ObjectQuery 并在外部进行包含：

```
var MyQuery = ((from e in ContractContext.Equipments
              where e.Customers.ID == customer.ID
              from cce in e.ContractEquipments
              where cce.Contracts.EndedOn >= DateTime.Today
              select e) as ObjectQuery<Equipment>).Include("Manufacturers"); 
```

这应该有效。

如果您对这方面的更多信息感兴趣，请查看[提示 22 - 如何使 Include 真正包含](http://blogs.msdn.com/alexj/archive/2009/06/02/tip-22-how-to-make-include-really-include.aspx)

亚历克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:35:40.697

您是否尝试过这样的加入？

```
var MyQuery = from e in ContractContext.Equipments.Include("Manufacturers")
              where e.Customers.ID == customer.ID
              join cce in e.ContractEquipments on e.Id equals cce.EquipmentId
              where cce.Contracts.EndedOn >= DateTime.Today
              select e; 
```

# java - 可以调用可执行的 .jar 文件而不必使用其完整路径吗？

> ID：936569
> 
> 赞同：13
> 
> 时间：2009-06-01T20:20:58.823
> 
> 标签：java, command-line, jar

我有一个 .jar 文件，我希望能够调用它而不必使用指向其位置的完整文件路径。

例如，如果 .jar 文件位于：/some/path/to/thearchive.jar

我希望能够通过以下方式运行它：

```
java -jar thearchive.jar 
```

代替：

```
java -jar /some/path/to/thearchive.jar 
```

当我在目录树的其他地方时。在我的具体情况下，我正在运行安装了 OS X 10.5.7 的 Mac。Java 版本“1.5.0_16”。我尝试将“/some/path/to”添加到 PATH、JAVA_HOME 和 CLASSPATH，但这不起作用。

那么，如何设置从命令行运行 .jar 而无需使用其完整路径？

更新：要处理的另一个项目是参数。例如：

```
java -jar /some/path/to/thearchive.jar arg1 arg2 
```

这可能会影响问题的处理方式，如下面的答案中所述。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:33:16.163

您可以添加一个变量来保存目录：

```
export JARDIR=/some/path/to
java -jar $JARDIR/thearchive.jar 
```

我不确定您是否可以隐式地从环境变量中做到这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T20:35:17.327

不，你不能。

运行 jar`-jar`不涉及任何类型的类路径机制，因为 jar 文件*是*类路径。

或者，使用 shell 别名来启动 jar 或小脚本文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T20:37:46.747

据[孙](http://java.sun.com/docs/books/tutorial/deployment/jar/run.html)说：

```
java -jar app.jar 
```

> 要从其他目录中的 jar 文件运行应用程序，我们需要指定该目录的路径，如下所示：**`java -jar path/app.jar`**
> 
> 其中 path 是此 app.jar 所在的目录路径。

因此，要么在“标准”环境变量中排除路径，要么定义一个包装器，该包装器将在您的 PATH 中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T20:34:29.683

我不相信。如果您在 CLASSPATH 中指定了 jar，则可以只调用 java 并指定主类。(ie java com.test.Main) 或者你可以在你的shell中创建一个别名来执行命令

```
alias execJar="java -jar /some/path/to/thearchive.jar" 
```

或者另一种选择是创建一个包装脚本来执行它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T22:25:30.523

Java 系统本身并没有为您提供指定 JAR_PATH（查找 jar 文件的位置列表）之类的方法。给出的其他答案使用 MAC/Unix shell 功能：

1.  设置环境变量
2.  设置别名
3.  可能使用符号链接（指向文件或目录）。

找出为什么指定整个路径是一个问题可能会有所帮助。这可能会指导我们哪个答案是最好的，或者可能为您的问题找到一个完全不同的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T20:04:15.483

要在不输入完整路径的情况下运行 .jar 文件，您可以将其放在类路径中并通过键入以下命令运行它：

```
java fullclassname arg1 arg2 
```

Mac OSX Developer Library[建议](http://developer.apple.com/library/mac/#qa/qa1170/_index.html)将需要放在系统类路径上的其他 jar 文件放在`/Library/Java/Extensions`文件夹中。您也可以将它们放在您自己的`Library/Java/Extensions`文件夹中，但您可能必须创建`Java`和`Extensions`文件夹。

如果您不知道 .jar 文件中主类的全名，可以将其展开并查看`MANIFEST.MF`文件夹中的`META-INF`文件。`Main-Class:`线路会告诉你。

因此，例如，运行[saxon9he.jar](http://saxon.sourceforge.net/)将其放入`/Library/Java/Extensions`，您可以键入（从您想要的任何文件夹）

```
java net.sf.saxon.Transform arg1 arg2... 
```

几乎和打字一样短`java -jar jarfile.jar arg1 arg2`，而且您不需要更改任何环境变量。

简而言之，如果 jar 在您的类路径中，请使用类名，而您不需要路径名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T13:55:21.003

由于没有用于 jar 位置的额外命令行选项或考虑到环境变量，我也不知道一个简单的解决方案，但也会对它非常感兴趣。

另一种方法可能是使用 zsh 包装脚本来获得这样的行为：

~/.scripts/java # .scripts 在 $PATH 变量中的位置比 java 本身更早

```
#!/usr/bin/env zsh
# get -jar option and remove from $@ (-D option)
zparseopts -D jar:=jarname 
if [ -e $JAR_PATH/$jarname[2] ];
then
    java -jar $JAR_PATH/$jarname[2] $@
elif [ -e $jarname[2] ];
then
    java -jar $jarname[2] $@
else
    java $@
fi 
```

的一个优点`zparseopts`是它可以去掉 -jar 选项，但所有其他选项都保留在 $@ 中。

进一步的改进是为 java 命令选项 -jar 扩展[bash-completion](http://bash-completion.alioth.debian.org)或 zsh-completion。例如 bash-completion of`java -jar`将文件列表限制为 *.jar 文件。为了方便使用，有人不仅可以查看当前路径，还可以查看 $JAR_PATH 来扩展它。作为起点，请参阅以下[unix.sx 问题](https://unix.stackexchange.com/questions/34238/complete-files-from-a-different-directory-in-bash)。

但是这个解决方案看起来也不太好。

# asp.net-mvc - 以 Web 服务为模型的 ASP.Net MVC？

> ID：936570
> 
> 赞同：8
> 
> 时间：2009-06-01T20:21:01.507
> 
> 标签：asp.net-mvc, rest, wcf-data-services

有没有人有关于在 ASP.Net MVC 应用程序中使用 Web 服务作为模型的建议或技巧？我还没有看到有人写过这样做。我想构建一个 MVC 应用程序，但不将其绑定到使用特定数据库，也不将数据库限制为单个 MVC 应用程序。我觉得 Web 服务（RESTful，很可能是 ADO.Net 数据服务）是要走的路。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-03T02:03:49.087

您的 MVC 应用程序与数据库分离的可能性或有用性有多大？在您的应用程序生命周期中，您多久看到一次从 SQL Server 到 Oracle 的更改？在过去 10 年我交付的项目中，它从未发生过。

架构就像洋葱，它们在它们所依赖的事物之上具有抽象层。如果您要使用 RDBMS 进行存储，那是您架构的核心。将自己从数据库中抽象出来以便可以交换它是非常错误的。

现在您可以将您的数据库访问与您的域分离，存储库模式是实现此目的的方法之一。如今，大多数成熟的解决方案都使用 ORM，因此如果您想要一种成熟的技术，您可能想看看 NHibernate，或者 ActiveRecord / linq2sql 在您的数据之上获得更简单的活动记录模式。

既然您已经制定了数据策略，那么您就拥有了某种领域。当您向客户端公开数据时，您可以选择通过 MVC 模式执行此操作，您通常会发送从您的域生成的 DTO 进行渲染，或者您可以决定利用像 REST 这样的架构风格来提供更松散耦合的系统，通过提供链接和自定义表示。

当您走向解决方案的外部层时，您会从紧耦合变为松耦合。

但是，如果您的问题是在 REST 架构或 Web 服务之上构建一个 MVC 应用程序，并将其用作模型……何必呢？如果您要拥有一个域模型，为什么不在您的系统*和*服务中重用它呢？

从 MVC 应用程序生成 UI 和生成 RESTful 架构所需的文档是两个完全不同的上下文，基于彼此之上的上下文只会导致比需要更多的痛苦。而且您正在牺牲性能。

取决于您的确切场景，但是基于远程 XML 的服务作为 MVC 中的模型，从经验来看，这不是一个好主意，它可能是过度设计并且忽略了对域开始的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:34:09.763

编辑 2010-11-27；澄清了我的想法，这是非常需要的。

Web 服务在不同类型的应用程序中公开功能，而不是在单个应用程序中进行抽象，最常见的是。您可能正在考虑更多封装命令的方式，并以不干扰控制器/视图编程的方式读取。

如果您在解耦之后使用服务总线中的服务并在异步页面中执行异步模式。您可以看到 Rhino.ServiceBus、nServiceBus 和 MassTransit 用于 .Net 本机实现，[RabbitMQ](http://www.rabbitmq.com/)用于不同的[http://blogs.digitar.com/jjww/2009/01/rabbits-and-warrens/](http://blogs.digitar.com/jjww/2009/01/rabbits-and-warrens/)。

编辑：我有一些时间尝试将消息推送到我的服务，从而将更新推送到簿记应用程序。RabbitMQ 是一个消息代理，又名 MOM（面向消息的中间件），您可以使用它向您的应用程序服务器发送消息。

您也可以简单地提供服务接口。阅读 Eric Evan 的领域驱动设计以获得更详细的描述。

REST-ful 服务接口处理大量数据，更具体地说，处理可寻址资源。它可以极大地简化您的编程模型，并允许通过 HTTP 协议对输出进行很好的控制。WCF 即将推出的编程模型使用原始论文中定义的真正休息，其中每个文档都应在一定程度上提供用于继续导航的 URI。看看[这个](http://codebetter.com/blogs/glenn.block/archive/2010/11/01/wcf-web-apis-http-your-way.aspx)。（在我这篇文章的第一个版本中，我感叹 REST 的“慢”，不管这意味着什么）基于 REST 的 API 也几乎是[CouchDB](http://wiki.apache.org/couchdb/HTTP_view_API)和[Riak](https://wiki.basho.com/display/RIAK/Building+a+Development+Environment)使用的。

ADO.Net 相当垃圾（！）[由于代码到实现、数据访问泄漏而导致延迟收集的 N+1 个问题 - 您总是需要查询代码所在的数据库上下文等] 与例如 LightSpeed （商业）或NHibernate。Spring.Net 还允许您使用 Web 服务外观将服务接口包装在它们的包含中，但是（暂时没有浏览它）我认为它的配置有点过于 xmly。

编辑 1：在这里使用 ADO.Net，我的意思是默认的“最佳实践”，包括 DataSet、DataAdapter 和从 DataReader 迭代大量行；它产生了相当丑陋且难以调试的代码。N+1 的东西，是的，就是关于实体框架的。

（编辑 2：EntityFramework 也没有给我留下深刻印象！）

编辑 1：在单独的程序集中创建域层 [aka. Core] 并在那里提供所有域和应用程序服务，然后从您的特定 MVC 应用程序中导入此程序集。通过核心程序集中的接口将数据访问包装在某些 DAO/存储库中，然后数据程序集会引用和实现该接口。用 IoC 连接接口和实现。您甚至可以使用上述服务总线对动态服务发现进行编程，以解决接口问题。WCF 使用这样的接口，上面的大多数服务总线也是如此；您可以在 IoC 容器中提供一个子组件解析器来自动执行此操作。

编辑 2：上述的一个很好的组合是 CQRS+EventSourcing+ReactiveExtensions。您的写入模型将接受命令，您的域模型将决定是否接受它们，它将事件推送到反应式扩展管道，也可能通过您的读取模型将使用的 RabbitMQ。

**更新 2010-01-02（编辑 1）**

我的想法的笑话已经被称为 MindTouch Dream 的东西编纂了。他们制作了一个截屏视频，其中他们将 Web 应用程序的几乎所有部分都视为（Web）服务，该服务也通过 REST 公开。

他们创建了一个高度并行的框架，使用协程来处理这个问题，包括他们自己的弹性线程池。

对于这个问题的所有反对者，当面说：p！[收听这个截屏视频，](http://blog.developer.mindtouch.com/2009/11/05/mindtouch-monospace-going-concurrent-keeping-your-sanity/)尤其是在 12 分钟时。

[实际的框架在这​​里。](http://developer.mindtouch.com/Dream)

如果您喜欢这种编程，请查看[monad 的工作原理](http://www.reddit.com/r/programming/comments/64th1/monads_in_python_in_production_code_you_can_and/c02u9mb)及其[在 C# 中的实现](http://blogs.msdn.com/wesdyer/archive/2008/01/11/the-marvels-of-monads.aspx)。您还可以阅读[CoRoutines](http://en.wikipedia.org/wiki/Coroutine)。

新年快乐！

**2010-11-27 更新（编辑 2）**

事实证明，CoRoutines 是使用 Microsoft 的任务并行库产品化的。您的任务现在实现了与实现 IAsyncResult 相同的功能。Caliburn 是一个使用它们的酷框架。

Reactive Extensions 将 monad 理解提升到了异步的下一个级别。

ALT.Net 世界似乎正朝着我第一次写这个答案时所说的方向发展，尽管我对新类型的架构知之甚少。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T20:46:00.770

您应该以与数据访问无关的方式定义模型，例如使用存储库模式。然后，您可以创建由特定数据访问技术（Web 服务、SQL 等）支持的具体实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-30T09:18:13.280

这真的取决于这个 mvc 项目的大小。如果网站将被少数用户（< 5000）使用，我会说将 UI 和域保持在相同的运行环境中。

另一方面，如果您正在计划一个将被数百万人访问的网站，您必须考虑分布式，这意味着您需要以一种可以扩展/扩展的方式构建您的网站。这意味着您可能需要使用额外的服务器（Web、应用程序和数据库）。

为了使其正常工作，您需要将您的 mvc UI 站点与应用程序分离。应用程序层通常包含您的域模型，并且可能通过 WCF 或服务总线公开。我更喜欢服务总线，因为它更可靠并且可能使用像 msmq 这样的持久队列。

我希望这有帮助

# vb.net - 连接到终端服务管理器

> ID：936573
> 
> 赞同：0
> 
> 时间：2009-06-01T20:21:26.653
> 
> 标签：vb.net, terminal-services

有没有人遇到过一种方法来创建一个类似于终端服务管理器在 Windows2003/XP 中所做的应用程序。

我想写一些东西，要么每隔 n 秒去查询一个服务器场，然后给我一个登录的用户列表，那里有进程等，或者可能输入一个用户名，然后它会在场中找到用户，然后返回他们的详细信息。

干杯卢克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T12:42:07.737

我建议使用[Cassia](http://code.google.com/p/cassia/)，这是一个 .NET 库，它在内部使用了 Arnshea 提到的 Wtsapi32 库。例如，列出所有登录到服务器的用户：

```
Dim manager As New TerminalServicesManager()
Using server As ITerminalServer = manager.GetRemoteServer("your-server-name")
    server.Open()
    For Each session As ITerminalServicesSession In server.GetSessions()
        If Not string.IsNullOrEmpty(session.UserName) Then Console.WriteLine(session.UserName)
    Next
End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:33:56.253

我已经使用 qwinsta（查询 winstation 是助记符）和字符串解析/正则表达式破解了这个问题。谨防防火墙和假冒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T22:51:53.840

看看Microsoft 的[psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)和其他 ps* 实用程序（最初来自 SysInternals）。

# sql-server - SQL Server 2000/2005 - 维护开发版和生产版

> ID：936576
> 
> 赞同：1
> 
> 时间：2009-06-01T20:21:56.607
> 
> 标签：sql-server, oracle, ddl

我习惯于通过创建数据库对象定义来使用 Oracle Designer，然后通过连接到数据库实例来创建所需的 DDL SQL。

例如，在向表添加新列时，首先将其添加到表定义中，然后针对开发版本生成 DDL SQL 并运行它，然后在测试后指向生产实例以在生产中创建缺少的列.

鉴于 SQL Server 中没有设计器，将列添加到两个数据库实例的正确过程是什么？是否有保持模式同步的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T21:03:58.970

RedGate 提供了一个名为 SQL Compare 的产品，可用于编写不同数据库之间的差异脚本。

请参阅：[http ://www.red-gate.com/products/SQL_Compare/index.htm](http://www.red-gate.com/products/SQL_Compare/index.htm)

您还可以使用 SQL Server Management Studio 中的数据库图表来设计您的数据库架构，但这将被限制在给定的数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:23:46.993

没有内置工具可以使它们保持同步（据我所知），但 RedGate 有一些商业应用程序可以做到这一点。

SQL Server 中没有设计器是什么意思？您使用的是 SQL Server Management Studio 吗？

# javascript - 关于 Javascript 中引用函数的问题

> ID：936580
> 
> 赞同：12
> 
> 时间：2009-06-01T20:22:17.307
> 
> 标签：javascript, jquery, function

**问题：**我有一个内置管理界面的 jQuery 重页。管理功能仅在设置管理变量时触发。这些功能需要第二个库才能正常工作，并且仅当首次创建页面时用户是管理员时才包含第二个文件。普通用户永远不会触发这些功能，普通用户不会获得第二个库的包含。

引用当前包含的文件中不存在的函数是否很糟糕，即使该函数永远无法调用？（那有意义吗 ：）

**伪代码：**

*标头：（*注意不包括 admin.js）

```
<script type="text/javascript" src="script.js"></script>
<script type="text/javascript" src="user.js"></script> 
```

*script.js：（*引用了管理函数但无法执行）

```
admin = false; // Assume this

$(".something").dblclick(function(){
 if(admin)
  adminstuff(); // Implemented in admin.js (not included)
 else
  userstuff();
}); 
```

**想法：** 我想可以为用户和管理员使用两个单独的文件，但我觉得这将是一个过于复杂的解决方案（不想维护两个只有几行差异的大文件）。我在这个文件中包含对管理函数的引用的唯一原因是我需要将它附加到作为脚本的一部分刷新的页面元素。当 jQuery 刷新页面时，我需要将函数重新附加到交互式元素。

**问题：** 我想让事情变得非常简单，如果用户不使用它们，我不必包含我不需要的文件。这是做到这一点的好方法还是我应该走另一条路？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T20:31:00.410

代码应该可以正常运行，因为不会调用没有实现的管理功能。唯一真正被浪费的是传输未使用的管理代码的带宽。

但是，让我警告通过默默无闻的安全性。如果用户查看此代码并看到他们无法访问的管理功能，他们可能会好奇并尝试下载“admin.js”文件并查看这些功能的作用。如果阻止执行管理功能的唯一障碍是停止包含文件，那么一些狡猾的用户可能会很快找到一种方法来调用管理功能，而他们不应该这样做。

如果您已经对管理函数调用进行服务器端身份验证/权限检查，请忽略我的上一段:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T20:35:12.883

就个人而言，我会在 admin.js 中绑定（或重新绑定）事件：

```
$(function() {

$(".something").dblclick(function(){
  adminstuff();
});

});

function adminstuff()
{
  // ...
} 
```

这样，“普通”用户将看不到 adminstuff() 调用和函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T20:29:56.997

好问题。它不应该导致任何 JavaScript 问题。

其他需要考虑的事情：当你这样做时，你可能会将你的管理能力暴露给世界，这可能对黑客有用。这可能不是什么大问题，但需要注意。

### 也可以看看：

> [为什么我可以在 Javascript 中定义函数之前使用它？](https://stackoverflow.com/questions/261599/why-can-i-use-a-function-before-its-defined-in-javascript)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T20:26:04.583

我不认为这很重要。如果它让你感觉更好，你可以做一个空的存根函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T20:27:23.537

在我看来，我认为对此没有教条的答案。你在做的是……创意。如果您对此不满意，这可能是考虑其他选择的迹象。但是，如果您对那些更不满意，那么这可能表明这是正确的事情（或者可能是最不错误的事情）。最终，您可以通过评论该行之外的内容来减轻混乱。我不会让自己对最佳实践变得虔诚。只要愿意支持你的选择。无论如何，你已经向我证明了这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T20:44:07.217

Javascript 是动态的——它不应该关心函数是否没有定义。

如果您将管理功能放在命名空间对象中（无论如何这可能是一个好习惯），您有几个选择。

1.  检查 admin 对象中是否存在该函数
2.  检查管理对象是否存在（可能替换您的标志）
3.  有一个操作对象，管理文件在加载时替换选择函数。（更好的是，使用原型继承来隐藏它们。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T00:16:36.150

我认为你应该警惕你正在为大规模的安全问题做准备。在 firebug 中将诸如 admin 之类的变量更改为“true”是非常简单的，并且看到 admin.js 是可公开访问的，简单地不将其包含在页面上是不够的，因为添加另一个脚本标签也很简单到带有萤火虫的页面。在这种情况下，知识渊博的用户可以轻松地赋予自己管理员权限。我认为您不应该依赖纯粹的客户端安全模型。

# c# - 在表达式中引用泛型属性

> ID：936584
> 
> 赞同：1
> 
> 时间：2009-06-01T20:23:00.410
> 
> 标签：c#, asp.net-mvc, generics, lambda

假设我有两张桌子，午餐和晚餐。我知道两者都包含 DateTime 属性“时间”。

如果我有一个通用方法 GetTime，我怎么能在 T 是午餐时返回 db.Lunch.Time，在 T 是晚餐时返回 db.Dinner.Time？我试图在不使用 typeof 单独测试 T 的情况下实现这一点，而是一般性地测试。

伪代码：

 `````
public T GetTime<T>(DateTime dt)
{
    return MyDataContext.GetTable<T>().Where(entity => entity.Time == dt);
} 
````  `因此，当我调用 GetTime<Dinner> 时，它会自动在晚餐表中查找属性时间等于我提供的参数 dt 的所有晚餐实体。

问题是我无法在我的表达式中指定**entity.Time**，因为 T 是通用的。我的问题是如何解决这个问题，这样我就可以查找任何 T（知道我的所有实体实际上*都具有*Time 属性），而不必为晚餐和午餐创建特定的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:35:19.217

您必须让两个类都实现如下接口：

```
public interface IMyInterface
{
   DateTime Time{get;set;}
} 
```

然后在您的通用方法中：

```
public void MyMethod<T>(T item) where T: IMyInterface
{
    //here you can access item.Time
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:41:07.940

您可以使用午餐和晚餐实现的接口，该接口具有称为时间的属性

```
 public interface IMealTime
    {
        DateTime Time { get; set; }
    }

    public class Lunch : IMealTime
    {
        #region IMealTime Members

        public DateTime Time { get; set; }

        #endregion
    }

    public class Dinner : IMealTime
    {
        #region IMealTime Members
        public DateTime Time { get; set; }

        #endregion
    }

    public class GenericMeal
    {
        public DateTime GetMealTime<T>(T meal) where T: IMealTime
        {
            return meal.Time;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:31:50.330

当然，您总是可以使用反射。此外，如果这两种类型实现了具有午餐属性的公共接口，则可以使用它。（我不明白这里的“表格”是什么意思。）

# c# - 可空值类型

> ID：936590
> 
> 赞同：0
> 
> 时间：2009-06-01T20:24:09.910
> 
> 标签：c#, .net, nullable, value-type

如果值类型被声明为可为空，我应该如何采取预防措施？即如果在构造函数中我有：

```
public Point3 ( Point3 source )
{
    this.X = source.X;
    this.Y = source.Y;
    this.Z = source.Z;
} 
```

如果源为空，它会失败吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T20:26:38.203

如果它是一种值类型，我看不到存在的可能性`Point3`。`null`你不会错过一个问号吗？如果你真的是说`Point3?`，那么你应该像这样访问它：

```
public Point3 ( Point3? source )
{
    this.X = source.Value.X;
    this.Y = source.Value.Y;
    this.Z = source.Value.Z;
} 
```

在这种情况下，如果`Value`属性是`null`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:28:30.913

此方法的调用者将无法传入可空点，因为该方法采用常规点，而不是可空点。因此，您无需担心 Point 在构造函数代码中为空。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T20:28:06.670

`source`是的，如果为空，那将失败。

`source`如果为空，您必须决定正确的行为应该是什么。你可能只是抛出一个异常。

```
public Point3 ( Point3? source )
{
    if (source == null) 
    {
        throw new ArgumentNullException("source");
    }

    this.X = source.Value.X;
    this.Y = source.Value.Y;
    this.Z = source.Value.Z;
} 
```

或者，如果您不想接受`null`的值`source`，只需保留示例中的方法即可。该方法不接受 a `Nullable<Point3>`，因此在这种情况下您不必担心它`null`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T20:54:59.613

```
 public Point3(Point3? source) { 
       this.X = source.GetValueOrDefault().X; 
        this.Y = source.GetValueOrDefault().Y;
        this.Z = source.GetValueOrDefault().Z; 
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T20:29:25.110

如果`source`是 a`Point3?`就不会是 a 了`Point3`。据我所知，它会在编译时失败。要发送 a`Point3?`你必须使用`.Value`，如果它为空，我相信它会引发异常。

# winapi - WinMain 命令行参数

> ID：936593
> 
> 赞同：5
> 
> 时间：2009-06-01T20:24:30.080
> 
> 标签：winapi

WinMain 的第三个参数将命令行作为未处理的字符串提供。虽然这可能有助于您处理通配符的扩展等问题，但是否有可能潜伏在 Win32 API 中的某个地方，有办法获得通常的 C argc、argv 版本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-25T13:51:53.810

微软专用：

__argc 和 __argv

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T20:33:43.900

您可以使用它[`CommandLineToArgvW()`](http://msdn.microsoft.com/en-us/library/bb776391(VS.85).aspx)来转换为 argv 样式的 Unicode 字符串数组。不幸的是，没有 ANSI 字符串版本。另外，请注意这不会将`argv[argc]`（即最后一个参数之后的元素）设置为 NULL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T20:32:00.860

CommandLineToArgvW()

# vb.net - 如何为多对多关系插入实体？（实体框架）

> ID：936597
> 
> 赞同：5
> 
> 时间：2009-06-01T20:25:26.817
> 
> 标签：vb.net, entity-framework, ado.net, many-to-many

如果我在用户和角色之间存在多对多关系，并且我有一个用户实体的实例和多个角色*ID*，我可以在没有任何其他角色数据且不进行选择的情况下插入这两种类型的实体之间的关系先说角色？

**更新：**

我可能还不够清楚。我没有角色的实例，只有角色 ID。是否可以在不先从数据库中填充 Role 对象的情况下创建 User 和 Role 之间的关系？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T03:51:47.597

是的，如果您有 ID 并且需要关联它们

你应该能够做到这一点（伪代码）

```
// how you get this doesn't matter so long as it is in the Context
User user = ...; 
Role role = new Role {Id = 2}; 
// role 2 is in unchanged state
ctx.AttachTo("Roles", role); 
// role 2 is unchanged + added relationship between user and role 2
user.Roles.Add(role); 
ctx.SaveChanges(); 
```

这里的关键是`AttachTo`将实体放入未更改状态的 ObjectState 管理器中。只要你不需要修改那个实体，只用if来建立关系，你甚至不需要知道所有的属性值，PK就足够了。

一旦你把它连接起来，你就可以建立关系。

希望这可以帮助

干杯亚历克斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T20:30:13.203

如果您不使用数据绑定，当然可以。多对多被映射为相互引用的列表。User.Roles.Add(Role ...) 应该没问题。

# c++ - 从 SAX 解析器事件填充 C++ POD 结构

> ID：936624
> 
> 赞同：1
> 
> 时间：2009-06-01T20:32:02.640
> 
> 标签：c++, xml

我正在尝试使用`StructSerlialiser`指向[成员和成员函数的指针的最佳用途是什么？](https://stackoverflow.com/questions/731208/whats-the-best-use-youve-had-with-pointer-to-members-and-member-functions/733520) 填充后`FieldBinderList`，如何使用基类列表访问指向成员的指针？如果我想使用从 XML 文件中读取的值设置该字段，我需要这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T13:13:57.737

当创建一个 StructSeriliser 时，它会传递一个对应的对象实例，并为每个字段创建序列化器：

```
StructSerialiser (T* data)
    : SerialiserData (data)
{
    if (fieldBinderList_.empty ())
        Serialiser<T>::initialise ();

    typedef FieldBinderList::const_iterator Iter;
    for ( Iter iter = fieldBinderList_.begin ()
        ; iter != fieldBinderList_.end ()
        ; ++iter
        )
    {
        serialisers_.push_back
            ( SerialiserEntry
                ( (*iter)->tags_
                , (*iter)->createSerialiser (*data)
                )
            );
    }
} 
```

然后当序列化器被传递一个起始元素时，它将它传递给下一个适当的字段序列化器。

老实说，最初的代码片段本身并不是为了可用。仅该类的完整代码就超过 500 行，并且还有用于原语、可选和选择的序列化程序。

# python - 在python中创建两台计算机之间的连接

> ID：936625
> 
> 赞同：13
> 
> 时间：2009-06-01T20:32:24.290
> 
> 标签：python, networking

问题：如何创建一个 python 应用程序，它可以通过互联网连接并发送数据包到另一台运行相同应用程序的计算机？我可以使用任何现有的代码/库吗？

背景：我对编程很陌生（HS 高级）。我在 python 中创建了很多简单的东西，但我最近决定开始一个更大的项目。我正在考虑创建一个万智牌补充包草稿模拟器，但鉴于我的技能，我不确定这是否可行，所以我在开始之前四处询问。该应用程序需要在计算机之间发送关于哪些卡被拾取/传递的数据。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-01T20:36:38.010

[Twisted](http://twistedmatrix.com/)是一个在 MIT 授权的 python 事件驱动的网络引擎。意味着一台机器可以与一台或多台其他机器通信，同时在接收和发送数据之间做其他事情，所有这些都是异步的，并在单个线程/进程中运行。

它支持许多开箱即用的协议，因此您也可以使用现有的协议。这更好，因为您可以从 3rd 方软件获得对协议的支持（即使用 HTTP 进行通信意味着使用 HTTP 的中间件软件将兼容：代理等）

如果您想要的话，它还可以轻松创建您自己的通信协议。

[文档](http://twistedmatrix.com/projects/core/documentation/howto/index.html)中充满了示例。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T20:42:17.097

标准库包括 SocketServer（[在此处](http://docs.python.org/library/socketserver.html)记录），它可能会执行您想要的操作。

但是我想知道是否更好的解决方案可能是使用消息队列。许多好的实现已经存在，包括 Python 接口。我以前用过[RabbitMQ](http://www.rabbitmq.com/)。这个想法是计算机都订阅队列，并且可以发布或监听事件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-01T20:41:46.440

[Python 标准库](http://docs.python.org/library/)是一个很好的起点。特别是有几个部分是相关的：

*   [18\. 进程间通信和网络](http://docs.python.org/library/ipc.html)
*   [19\. 互联网数据处理](http://docs.python.org/library/netdata.html)
*   [21\. 互联网协议和支持](http://docs.python.org/library/internet.html)

既然你提到你没有这方面的经验，我建议从基于 HTTP 的实现开始。[HTTP](http://en.wikipedia.org/wiki/Http)协议相当简单且易于使用。此外，还有一些很好的框架来支持这种操作，例如用于服务器的 webpy 和[用于客户端的标准库中的](http://docs.python.org/library/httplib.html)[HTTPLib](http://webpy.org/)。

如果您真的想深入研究网络，那么基于[套接字](http://docs.python.org/library/socket.html)的实现可能具有教育意义。*这将教您在大量*网络代码中使用的基本概念，同时产生类似于文件流的接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T10:45:33.730

另外，请查看[Pyro](http://pyro.sourceforge.net/)（Python 远程处理对象）。请参阅[此答案](https://stackoverflow.com/questions/656933/communicating-with-a-running-python-daemon/658156#658156)以获取更多详细信息。

Pyro 基本上允许您将 Python 对象实例发布为可以远程调用的服务。Pyro 可能是实现 Python 到 Python 进程通信的最简单方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T13:07:58.463

这类事情也值得关注[Kamaelia - 它的原始用例是网络系统，并且使构建此类事物相对直观。](http://www.kamaelia.org/Home)一些链接：[基本 TCP 系统概述](http://www.kamaelia.org/Cookbook/TCPSystems)，[简单聊天服务器](http://yeoldeclue.com/cgi-bin/blog/blog.cgi?rm=viewpost&nodeid=1226574014)，[构建分层协议](http://yeoldeclue.com/cgi-bin/blog/blog.cgi?rm=viewpost&nodeid=1223342651)，[如何演进新组件](http://edit.kamaelia.org/cgi-bin/blog/blog.cgi?rm=viewpost&nodeid=1113495151)。其他极端： P2P 广播系统：[source](http://code.google.com/p/kamaelia/source/browse/trunk/Sketches/MPS/Examples/LUGRadio/SimpleSwarmRadioSource.py) , [peer](http://code.google.com/p/kamaelia/source/browse/trunk/Sketches/MPS/Examples/LUGRadio/SimpleSwarm.py)。

如果有什么不同的话，我们已经通过连续 3 年参与谷歌代码之夏测试了新手是否可以使用该系统，并积极招募有经验和没有经验的开发人员。他们都设法建立了有用的系统。

本质上，如果您曾经使用过 unix 管道，那么这些想法应该很熟悉。

警告：我写了大部分的 Kamaelia :-)

如果你想学习如何做这些事情，尝试几种不同的方法是有意义的，你一定要看看 Twisted（这个问题的标准答案）、Pyro 和标准库工具。每个人都有不同的方法，学习它们一定会让你受益！

However, like nosklo, I would recommend against using the socket library directly and use a library instead - simply because it is much much harder to get sockets programming correct than people tend to realise.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T20:58:48.280

通信将通过套接字以一种或另一种方式进行。只是一个问题，您是使用现有的更高级别的库，还是使用自己的库。

如果您将此作为一种学习体验，可能希望尽可能从低级开始，以了解真正的细节。这意味着您可能希望从[SocketServer](http://docs.python.org/library/socketserver.html)开始，使用 TCP 连接（TCP 基本上可以保证数据的传递；UDP 不是）。

谷歌一些简单的示例代码。设置一个非常容易。但是你必须定义你的通信协议的所有细节：哪一端发送什么时间和什么，哪一端监听以及何时监听，监听器期望什么，它是否回复确认接收等等。

# .net - 如何强制硬刷新（ctrl+F5）？

> ID：936626
> 
> 赞同：27
> 
> 时间：2009-06-01T20:32:24.527
> 
> 标签：.net, asp.net-mvc, http, caching

我们正在积极开发一个使用 .Net 和 MVC 的网站，我们的测试人员正在尝试获取最新的东西进行测试。每次我们修改样式表或外部 javascript 文件时，测试人员都需要进行一次硬刷新（在 IE 中为 ctrl+F5）才能看到最新的内容。

我是否可以强制他们的浏览器获取这些文件的最新版本，而不是依赖他们的缓存版本？我们没有从 IIS 或任何东西做任何类型的特殊缓存。

一旦投入生产，就很难告诉客户他们需要硬刷新才能看到最新的变化。

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-06-22T11:52:21.180

我也遇到了这个问题，发现我认为是一个非常令人满意的解决方案。

请注意，使用查询参数`.../foo.js?v=1`据说意味着文件显然不会被某些代理服务器缓存。最好直接修改路径。

我们需要浏览器在内容更改时强制重新加载。因此，在我编写的代码中，路径包含被引用文件的 MD5 哈希值。如果文件重新发布到 Web 服务器但具有相同的内容，则其 URL 是相同的。更重要的是，使用无限期缓存也是安全的，因为该 URL 的内容永远不会改变。

此哈希在运行时计算（并缓存在内存中以提高性能），因此无需修改构建过程。事实上，自从将这段代码添加到我的网站后，我就不必多想了。

你可以在这个网站上看到它的实际效果：[Dive Seven - 水肺潜水员的在线潜水记录](http://diveseven.com)

### 在 CSHTML/ASPX 文件中

```
<head>
  @Html.CssImportContent("~/Content/Styles/site.css");
  @Html.ScriptImportContent("~/Content/Styles/site.js");
</head>
<img src="@Url.ImageContent("~/Content/Images/site.png")" /> 
```

这会生成类似于以下内容的标记：

```
<head>
  <link rel="stylesheet" type="text/css"
        href="/c/e2b2c827e84b676fa90a8ae88702aa5c" />
  <script src="/c/240858026520292265e0834e5484b703"></script>
</head>
<img src="/c/4342b8790623f4bfeece676b8fe867a9" /> 
```

### 在 Global.asax.cs

我们需要创建一个路由来在这个路径上提供内容：

```
routes.MapRoute(
    "ContentHash",
    "c/{hash}",
    new { controller = "Content", action = "Get" },
    new { hash = @"^[0-9a-zA-Z]+$" } // constraint
    ); 
```

### 内容控制器

这节课很长。它的症结很简单，但事实证明，您需要注意文件系统的更改才能强制重新计算缓存的文件哈希。我通过 FTP 发布我的网站，例如，`bin`文件夹在文件夹之前被替换`Content`。在此期间请求该站点的任何人（人类或蜘蛛）都会导致旧哈希值被更新。

由于读/写锁定，代码看起来比它复杂得多。

```
public sealed class ContentController : Controller
{
    #region Hash calculation, caching and invalidation on file change

    private static readonly Dictionary<string, string> _hashByContentUrl = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);
    private static readonly Dictionary<string, ContentData> _dataByHash = new Dictionary<string, ContentData>(StringComparer.Ordinal);
    private static readonly ReaderWriterLockSlim _lock = new ReaderWriterLockSlim(LockRecursionPolicy.NoRecursion);
    private static readonly object _watcherLock = new object();
    private static FileSystemWatcher _watcher;

    internal static string ContentHashUrl(string contentUrl, string contentType, HttpContextBase httpContext, UrlHelper urlHelper)
    {
        EnsureWatching(httpContext);

        _lock.EnterUpgradeableReadLock();
        try
        {
            string hash;
            if (!_hashByContentUrl.TryGetValue(contentUrl, out hash))
            {
                var contentPath = httpContext.Server.MapPath(contentUrl);

                // Calculate and combine the hash of both file content and path
                byte[] contentHash;
                byte[] urlHash;
                using (var hashAlgorithm = MD5.Create())
                {
                    using (var fileStream = System.IO.File.Open(contentPath, FileMode.Open, FileAccess.Read, FileShare.Read))
                        contentHash = hashAlgorithm.ComputeHash(fileStream);
                    urlHash = hashAlgorithm.ComputeHash(Encoding.ASCII.GetBytes(contentPath));
                }
                var sb = new StringBuilder(32);
                for (var i = 0; i < contentHash.Length; i++)
                    sb.Append((contentHash[i] ^ urlHash[i]).ToString("x2"));
                hash = sb.ToString();

                _lock.EnterWriteLock();
                try
                {
                    _hashByContentUrl[contentUrl] = hash;
                    _dataByHash[hash] = new ContentData { ContentUrl = contentUrl, ContentType = contentType };
                }
                finally
                {
                    _lock.ExitWriteLock();
                }
            }

            return urlHelper.Action("Get", "Content", new { hash });
        }
        finally
        {
            _lock.ExitUpgradeableReadLock();
        }
    }

    private static void EnsureWatching(HttpContextBase httpContext)
    {
        if (_watcher != null)
            return;

        lock (_watcherLock)
        {
            if (_watcher != null)
                return;

            var contentRoot = httpContext.Server.MapPath("/");
            _watcher = new FileSystemWatcher(contentRoot) { IncludeSubdirectories = true, EnableRaisingEvents = true };
            var handler = (FileSystemEventHandler)delegate(object sender, FileSystemEventArgs e)
            {
                // TODO would be nice to have an inverse function to MapPath.  does it exist?
                var changedContentUrl = "~" + e.FullPath.Substring(contentRoot.Length - 1).Replace("\\", "/");
                _lock.EnterWriteLock();
                try
                {
                    // if there is a stored hash for the file that changed, remove it
                    string oldHash;
                    if (_hashByContentUrl.TryGetValue(changedContentUrl, out oldHash))
                    {
                        _dataByHash.Remove(oldHash);
                        _hashByContentUrl.Remove(changedContentUrl);
                    }
                }
                finally
                {
                    _lock.ExitWriteLock();
                }
            };
            _watcher.Changed += handler;
            _watcher.Deleted += handler;
        }
    }

    private sealed class ContentData
    {
        public string ContentUrl { get; set; }
        public string ContentType { get; set; }
    }

    #endregion

    public ActionResult Get(string hash)
    {
        _lock.EnterReadLock();
        try
        {
            // set a very long expiry time
            Response.Cache.SetExpires(DateTime.Now.AddYears(1));
            Response.Cache.SetCacheability(HttpCacheability.Public);

            // look up the resource that this hash applies to and serve it
            ContentData data;
            if (_dataByHash.TryGetValue(hash, out data))
                return new FilePathResult(data.ContentUrl, data.ContentType);

            // TODO replace this with however you handle 404 errors on your site
            throw new Exception("Resource not found.");
        }
        finally
        {
            _lock.ExitReadLock();
        }
    }
} 
```

### 辅助方法

如果您不使用 ReSharper，则可以删除这些属性。

```
public static class ContentHelpers
{
    [Pure]
    public static MvcHtmlString ScriptImportContent(this HtmlHelper htmlHelper, [NotNull, PathReference] string contentPath, [CanBeNull, PathReference] string minimisedContentPath = null)
    {
        if (contentPath == null)
            throw new ArgumentNullException("contentPath");
#if DEBUG
        var path = contentPath;
#else
        var path = minimisedContentPath ?? contentPath;
#endif

        var url = ContentController.ContentHashUrl(contentPath, "text/javascript", htmlHelper.ViewContext.HttpContext, new UrlHelper(htmlHelper.ViewContext.RequestContext));
        return new MvcHtmlString(string.Format(@"<script src=""{0}""></script>", url));
    }

    [Pure]
    public static MvcHtmlString CssImportContent(this HtmlHelper htmlHelper, [NotNull, PathReference] string contentPath)
    {
        // TODO optional 'media' param? as enum?
        if (contentPath == null)
            throw new ArgumentNullException("contentPath");

        var url = ContentController.ContentHashUrl(contentPath, "text/css", htmlHelper.ViewContext.HttpContext, new UrlHelper(htmlHelper.ViewContext.RequestContext));
        return new MvcHtmlString(String.Format(@"<link rel=""stylesheet"" type=""text/css"" href=""{0}"" />", url));
    }

    [Pure]
    public static string ImageContent(this UrlHelper urlHelper, [NotNull, PathReference] string contentPath)
    {
        if (contentPath == null)
            throw new ArgumentNullException("contentPath");
        string mime;
        if (contentPath.EndsWith(".png", StringComparison.OrdinalIgnoreCase))
            mime = "image/png";
        else if (contentPath.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase) || contentPath.EndsWith(".jpeg", StringComparison.OrdinalIgnoreCase))
            mime = "image/jpeg";
        else if (contentPath.EndsWith(".gif", StringComparison.OrdinalIgnoreCase))
            mime = "image/gif";
        else
            throw new NotSupportedException("Unexpected image extension.  Please add code to support it: " + contentPath);
        return ContentController.ContentHashUrl(contentPath, mime, urlHelper.RequestContext.HttpContext, urlHelper);
    }
} 
```

反馈赞赏！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-01T20:36:18.293

您需要修改您引用的外部文件的名称。例如，在每个文件的末尾添加内部版本号，例如 style-1423.css 并将编号作为构建自动化的一部分，以便每次使用唯一名称部署文件和引用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-01T21:12:45.410

以编程方式将文件的最后修改日期作为查询字符串附加到 URL，而不是构建号或随机数。这将防止您忘记手动修改查询字符串的任何意外，并允许浏览器在文件未更改时缓存文件。

示例输出可能如下所示：

```
<script src="../../Scripts/site.js?v=20090503114351" type="text/javascript"></script> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T21:19:02.730

由于您只提到您的测试人员在抱怨，您是否考虑过让他们关闭本地浏览器缓存，以便每次都检查新内容？它会减慢他们的浏览器速度……但是除非您每次都进行可用性测试，否则这可能比后缀文件名、添加查询字符串参数或修改标题要容易得多。

这适用于我们测试环境中 90% 的情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T20:37:15.077

您可能会做的是在每次页面刷新时使用随机字符串调用您的 JS 文件。这样你就可以确定它总是新鲜的。

你只需要这样称呼它“ `<`/path/to/your/file.js?random-number `>`”

示例：jquery-min-1.2.6.js?234266

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T20:39:10.940

在您对 CSS 和 Javascript 文件的引用中，附加一个版本查询字符串。每次更新文件时都会碰到它。这将被网站忽略，但网络浏览器会将其视为新资源并重新加载。

例如：

```
<link href="../../Themes/Plain/style.css?v=1" rel="stylesheet" type="text/css" />
<script src="../../Scripts/site.js?v=1" type="text/javascript"></script> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T21:15:31.973

您可以编辑文件的 http 标头以强制浏览器在每个请求上重新验证

# asp.net - 在 ASP.NET/VB.NET 中获取请求者的登录信息

> ID：936629
> 
> 赞同：0
> 
> 时间：2009-06-01T20:33:02.853
> 
> 标签：asp.net, vb.net, authentication

有没有办法从 vb.net Web 应用程序获取登录用户？IE，如果有人在本地机器上以“foo”/“bar”身份登录访问该站点，我需要代码来获取“foo”/“bar”。这是为了在我们的 Intranet 上进行直通，每个人都使用相同的 Active Directory。

本质上，我需要获取登录用户的用户名，并对照我们的 ActiveDirectory 实例进行检查。如果失败，我需要检查请求变量并检查那些（这部分相当容易）。然后，如果那失败了，我需要显示一个登录屏幕（我也有这个处理）。

对于我遇到问题的部分，我已经遇到并丢弃了几个解决方案：

1.  request.serverVariables("LOGON_USER") - 仅当您在 IIS 中关闭匿名访问时才有效，并且必须打开才能使用表单身份验证（我正在使用）。
2.  [http://www.thescarms.com/dotnet/IsInRole.aspx](http://www.thescarms.com/dotnet/IsInRole.aspx) - 由于某种原因，此解决方案似乎不起作用。我怀疑这行 AppDomain.CurrentDomain.SetPrincipalPolicy( Principal.PrincipalPolicy.WindowsPrincipal) 是问题所在，但是到目前为止，这条线的含义被埋没了，我无法弄清楚它实际上在做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T20:36:30.600

HttpRequest.LogonUserIdentity？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:40:09.893

如果您使用的是表单身份验证，您是否尝试过 System.Web.HttpContext.Current.User.Identity.Name？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T22:56:26.420

Web 浏览器不会将用户的本地凭据发送到 Web 服务器，除非满足以下两个条件：

*   Web 服务器请求它们（即禁用匿名访问，启用 Windows 集成身份验证）。
*   Web 浏览器已配置为在询问时发送本地凭据（Internet Explorer 选项，可通过插件在 FireFox 中使用，不确定其他浏览器）。如果浏览器未配置为发送信息并且 Web 服务器询问，则会在弹出的登录屏幕中提示用户。

# c# - 如何通过我的 Web 服务运行 .exe 文件？

> ID：936631
> 
> 赞同：3
> 
> 时间：2009-06-01T20:33:13.930
> 
> 标签：c#, .net, web-services

> 重复： [是否可以从 Web 服务运行可执行文件？](https://stackoverflow.com/questions/717657/is-it-possible-to-run-an-executable-from-a-web-service)

你好

我有 Web 服务，我想通过这个 Web 服务运行 exe 文件

Webservice 和 exe 文件在同一台计算机上

我该怎么做 ？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T20:34:56.750

进程.开始（）？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T20:35:15.080

您可以使用 System.Diagnostics.Process 对象来启动外部进程。

**编辑**：

[文档](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

[使用一些高级功能](http://blogs.msdn.com/lucian/archive/2008/12/29/system-diagnostics-process-redirect-standardinput-standardoutput-standarderror.aspx)（输入/输出/错误重定向）的示例。它在 VB 中，但应该很容易移植。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T20:35:36.470

```
Process.Start("path of the program"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:35:53.130

```
Process.Start("app.exe") 
```

或者更好的是，将其包装在 Windows 服务中，为其发布架构并通过对总线的异步请求进行使用。

# javascript - 根据文本的存在定位文本并执行操作

> ID：936640
> 
> 赞同：1
> 
> 时间：2009-06-01T20:35:10.650
> 
> 标签：javascript, jquery

我正在尝试学习 jQuery，但它来得很慢，因为我真的不知道任何 JavaScript。

我的网站在 VB.NET 中，我将 jQuery 代码放在我的实际`.ascx` `UserControl`文件和单独的文件中（类似于`myscripts.js`）。这是因为我使用的是 webforms，因为我仍然不太了解 MVC 来实现它，所以我必须在页面上获取 clientID。

我想做的是以下几点：

1.  从文本框中抓取文本并将其全部设为小写
2.  从登录信息中获取用户名。我在我的实际页面上这样做了：

    ```
    var userName = "<%=Split(System.Web.HttpContext.Current.User.Identity.Name.ToLowerInvariant, '|')%>"; 
    ```

3.  检查用户名是否在文本中。如果它在文本中，我想将变量设置为“false”，否则设置为 true。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T20:47:14.293

我完全不知道它的 ASP.NET 方面，但就 jQuery 和 Javascript....

要获取文本字段的值，请使用 jQuery 函数[`val()`](http://docs.jquery.com/Attributes/val)：

```
var value = $('#mytextbox').val(); 
```

要将字符串转换为小写，请使用字符串方法[`toLowerCase()`](http://www.w3schools.com/jsref/jsref_toLowerCase.asp)：

```
var value = $('#mytextbox').val().toLowerCase(); 
```

由于`val()`返回一个字符串，我们可以在最后抛出它。

要检查一个字符串是否在另一个字符串中，请使用 string 方法[`indexOf()`](http://www.w3schools.com/jsref/jsref_IndexOf.asp)：

```
var needle = 'Hello';
var haystack = 'Hello World';
var match = haystack.indexOf(needle); // -1 if no matches, 0 in this case 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:44:09.493

```
var userName = "username as it comes out of your web app";

// stuff happens

var $myTextbox = $('#ID_of_textbox');
var userNameIsContained = $myTextbox.val().toLowerCase().indexOf(userName) >= 0; 
```

简短说明：

```
$('#ID_of_textbox')  // fetches the jQuery object corresponding to your textbox
.val()               // the jQuery function that gets the textbox value
.toLowerCase()       // self explanatory
.indexOf()           // returns the position of a string in a string (or -1) 
```

请参阅[w3schools 上的 JavaScript 字符串对象参考](http://www.w3schools.com/jsref/jsref_obj_string.asp)。

替代方案（检查文本框值是否*等于*用户名）：

```
var userNameIsEqual = $myTextbox.val().toLowerCase() == userName; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:07:00.243

要记住的另一件事是 ASP.NET 会重命名您的所有控件 ID。要在 JavaScript 中访问您的控件，您应该使用以下内容代替控件 ID <%= txtUserName.ClientID %>。

在 jQuery 中，这是我的选择器对于 ID 为“txtUserName”的文本框的外观。

$('#<%= txtUserName.ClientID %>')

享受，

扎克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T20:42:15.020

JQuery 的基本原理是这样的：找到一个 dom 元素列表，并对它们执行操作。

在您的情况下，您应该首先找到作为您的测试框的 dom 元素。例如，我们将选择 $('#userName')。选择器 # 表示“id”，并与名称“userName”一起查找所有 id 为“userName”的元素。（如果您遵循最佳做法，页面上的 ID 应该是唯一的。）

一旦你有了那个列表（在这种情况下，一个元素的列表），你可以问它值是什么。
$('#userName').val()

这将为您获取输入标签的 value="" 属性的值。

然后，您可以将其分配给一个变量并使用标准的 JavaScript 字符串函数来完成其余的工作！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T20:49:15.303

```
function checkLogin(userName){
    return $('#mytextbox').val().toLowerCase() == userName
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T21:06:37.077

```
if ($("#textBoxID").val()) != "") { /*Do stuff*/ } 
```

# debugging - 调试崩溃的 explorer.exe 的最佳方法是什么？

> ID：936646
> 
> 赞同：5
> 
> 时间：2009-06-01T20:35:26.343
> 
> 标签：debugging, crash, explorer, windows-explorer

我为一个在内部运行自定义构建的 Access/SQL 应用程序的组织工作。我们有一个问题 Explorer.exe 引发错误并崩溃。

这是崩溃的图片： [![替代文字](https://i.stack.imgur.com/5mSaE.png)](https://i.stack.imgur.com/5mSaE.png)

开始跟踪此问题并找到解决方案的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T20:38:31.113

确保已安装 WinDBG，将其设置为默认调试器，然后使用分析并获取故障转储。

下次出现该对话框时，单击“确定”以附加到 WinDbg

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T21:37:50.680

请记住，如果将调试器附加到资源管理器，然后中断，则不应尝试在调试器中执行任何调用资源管理器的操作，否则将使调试器死锁。这可能会非常棘手，因为这意味着您无法打开“文件打开”对话框、打印、浏览到另一台计算机以及任何其他事情。

# http - HTTP 引荐来源网址陷阱？

> ID：936652
> 
> 赞同：2
> 
> 时间：2009-06-01T20:35:52.740
> 
> 标签：http, referrer

我需要确保我的网页始终位于第三方拥有的 iframe 中。该第三方使用 src="../index.php" 引用我们的登录页面。

现在我的问题是，如果我使用引荐来源网址来确保该页面是由我自己或第三方请求的，并且如果不强制重新加载第 3 方网站，我应该注意什么大问题？

例如，是否有某些不遵循推荐人规则的常见浏览器？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T09:28:09.130

另外，这是`REFERER`因为它在规范中以某种方式拼写错误。那是我的第一个`REFERER`问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T20:40:03.823

[由于referrer spoofing](http://en.wikipedia.org/wiki/Referrer_spoofing)，您不能使用referrer 来“确保”始终从其他地方调用该网页。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-01T20:42:02.010

不需要推荐人。如果浏览器不提供它，那么您将陷入无休止的重定向循环。与 cookie、java 和 javascript 一样，Referrer 实际上是“自愿的”。

虽然。您可以保留 IP 和上次重定向时间的日志。修剪任何超过 5 分钟的日志，并且每 5 分钟不要重定向超过一次。您应该捕获 99.9% 的用户，但要避免其余的无限重定向循环。日志不能依赖浏览器中的任何内容（这是最初的问题），因此没有 cookie 也没有会话。一个简单的 2 列数据库表就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T20:42:00.963

您可以这样做的唯一方法是**直接授权请求**，因为引用者操纵..

您可以将请求限制为一组 IP 地址，如果您想松懈，或者要求包含的客户端/系统具有iframe 中显示的请求的**身份验证 cookie 。**

**祝你好运**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-08T11:50:45.987

即使是众所周知的格式也可能会改变......

谷歌显然已经改变了它的引荐来源网址。2009 年 4 月 14 日，[即将对 Google.com 搜索推荐进行更改；谷歌分析不受影响](http://analytics.blogspot.com/2009/04/upcoming-change-to-googlecom-search.html)：

> 从本周开始，您可能会开始看到来自 Google 搜索结果页面的访问者的新引荐 URL 格式。到目前为止，例如，对于“花”一词的搜索结果的点击通常是这样的：
> 
> ```
>   http://www.google.com/search?hl=en&q=flowers&btnG=Google+搜索
> ```
> 
> 现在您将开始看到一些如下所示的引荐来源网址字符串：
> 
> ```
>   http://www.google.com/url?
>     sa=t&source=web&ct=res&cd=7
>     &url=http%3A%2F%2Fwww.example.com%2Fmypage.htm
>     &ei=0SjdSa-1N5O8M_qW8dQN&rct=j
>     &q=鲜花
>     &usg=AFQjCNHJXSUh7Vw7oubPaO3tZOzz-F-u_w
>     &sig2=X8uCFh6IoPtnwmvGMULQfw
> ```

（另请参阅[Google 正在将其引荐来源网址从 /search 更改为 /url。任何已知问题？](https://stackoverflow.com/questions/1537469/google-is-changing-its-referrer-urls-from-search-into-url-any-known-issues)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T21:12:27.907

请注意，每当用户通过 JavaScript 导航到链接时，Internet Explorer（所有版本）都会专门省略 HTTP REFERRER。（[错误报告](http://webbugtrack.blogspot.com/2008/11/bug-421-ie-fails-to-pass-http-referer.html)）

例如

```
function doSomething(url){
  //save some data to the session
  //...
  location.href = url;//IE will NOT pass the HTTP REFERRER on this link
} 
```

# mysql - Cocoa MySQL 框架指针和/或建议？

> ID：936660
> 
> 赞同：0
> 
> 时间：2009-06-01T20:38:14.263
> 
> 标签：mysql, cocoa, xcode, frameworks

嘿，我正在为 Cocoa 寻找一个好的 MySQL 框架，我可以在我的 XCode 项目中使用它来访问 Web 上的数据库。你知道任何好的，开源/免费的吗？我看过 http://mysql-cocoa.sourceforge .net/index.html 但还没有机会玩它。我应该从那里开始还是有更好的东西？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T23:07:49.767

你几乎回答了你自己的问题！看看[MySQL-Cocoa](http://mysql-cocoa.sourceforge.net/)。

我在将简单查询包装在 NSOperation 对象中以轻松进行多线程处理方面有很好的经验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T14:12:20.360

尝试：

iPhone 的 MySQL 框架：

[http://www.eval-art.com/2009/06/22/mysqlframework-for-iphone/](http://www.eval-art.com/2009/06/22/mysqlframework-for-iphone/)

# java - 有没有办法使用 Cygwin 运行 shell 脚本并为 java 命令使用正确的路径分隔符

> ID：936662
> 
> 赞同：2
> 
> 时间：2009-06-01T20:38:36.527
> 
> 标签：java, bash, unix, shell, cygwin

我正在尝试使用 Cygwin 测试将在 Linux 环境中运行的 Java 应用程序的启动脚本。

麻烦的是，当我指定一个boothclasspath 或Classpath 时，我需要使用操作系统特定的路径分隔符“;” 用于 Windows，“：”用于 Linux。发生这种情况是因为 Java 仍然是本机 Windows 应用程序并使用本机 OS 路径分隔符（[Cygwin List Path Seperator](http://www.nabble.com/path-separator-td17704083.html)）

shell 脚本中是否有任何方法可以检测我正在使用的操作系统（或者如果我在 CYGWIN 中运行），并指定正确的路径分隔符。

我正在尝试设置以下内容：

```
MAVEN_OPTS="-Xbootclasspath/a:test/resources:live/resources" 
```

在 Windows 上，它需要是： MAVEN_OPTS="-Xbootclasspath/a:test/resources;live/resources"

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T20:40:28.813

在这里找到答案：[Detect OS from a bash script (Using $OSTYPE)](https://stackoverflow.com/questions/394230/detect-os-from-a-bash-script/442641#442641)

```
PATHSEP=":" 
if [[ $OSTYPE == "cygwin" ]] ; then
PATHSEP=";" 
fi

MAVEN_OPTS="-Xbootclasspath/a:test/resources${PATHSEP}live/resources" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T20:41:09.827

您可以[`uname(1)`](http://linux.die.net/man/1/uname)用来测试您是否正在运行 Cygwin，例如：

```
if uname | grep -iq cygwin; then
    # use ; for path separator
else
    # use : for path separator
fi 
```

# c# - 动态加载的程序集显示形式？

> ID：936676
> 
> 赞同：0
> 
> 时间：2009-06-01T20:41:25.803
> 
> 标签：c#, winforms, remoting

有没有办法让动态加载的程序集中的类实例显示表单？

我有这个插件系统，它在不同的域中加载程序集（用于根据需要卸载它们）。这些程序集可能有设置，我希望我可以让每个程序集向最终用户呈现一个表单以允许对其进行编辑。程序集中的每个扩展都需要为此实现一个特殊的接口。但是，在从我的插件管理器类中显示表单时，我得到一个异常，即 Form 类不可序列化。除了从 Form 派生并自己实现 ISerializable 之外，还有其他方法可以做到这一点吗？

发送任何提示、提示和（希望是：D）解决方案！...阿让...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T20:47:37.817

序列化问题是因为 Form 类不是 Marshal 通过引用，并且您试图跨域调用该类的方法。如果他们需要显示的唯一形式是用户设置，那么您最好定义某种在插件之间传递的“设置”类。

# performancecounter - 安装和删除自定义性能计数器问题

> ID：936677
> 
> 赞同：1
> 
> 时间：2009-06-01T20:41:30.997
> 
> 标签：performancecounter

我刚刚在安装了自定义性能计数器的 DLL 上执行了 installutil。我安装了 2 个类别，但后来意识到我遇到了第一个类别的问题，所以我删除了该类别，但在删除之前我运行了一个 asp.net 应用程序以确保它正常工作。

问题是在删除类别然后重新创建应用程序后记录到自定义性能计数器，但值永远不会更新。

第二个自定义类别工作正常，计数器正在填充。我可以在 perfmon 中看到这两个类别，但注意到第一个类别计数器在针对它运行 asp.net 时永远不会更新。

有没有人遇到过这个问题。我需要删除现有实例吗？我试图避免重新启动机器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T22:12:58.897

根据您安装计数器的方式，（假设事务安装让我们说......）性能计数器可能会“孤立”。

恕我直言，这是因为性能计数器似乎安装在 Reg 和“其他地方”<--仍然试图找出性能计数器信息存储在哪里。

在某些情况下，regkeys 得到适当的构建，因此可以适当地注册，但操作系统“其他地方”的位置没有正确构建。几乎就像某处有一个 perfcounter 缓存。（评论有人吗？）

因此，总而言之，安装后使用适当的权限从命令行运行 lodctr /R，这“似乎”解决了大多数安装的问题。我很想看看其他人对此有何看法，因为普遍可用的文档（即 MS）在这个主题上令人难以置信......

呸。

# c++ - 在c ++中将const char []转换为字符串的最简单方法是什么

> ID：936678
> 
> 赞同：2
> 
> 时间：2009-06-01T20:41:41.433
> 
> 标签：c++

有没有一种从 const char[] 创建 std::string 的简单方法？

我的意思是更简单的事情：

```
std::stringstream stream;
stream << const_char;

std::string string = stream.str(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-01T20:43:57.747

`std::string`有多个构造函数，其中之一是`string( const char* str );`.

你可以像这样使用它：

```
std::string myString(const_char);
```

如果您需要在声明变量之后的某个时间设置值，您也可以使用赋值：

```
myString = const_char; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-01T20:43:26.313

std::string 有一个构造函数，它接受一个 const char*，所以你可以这样做：

```
const char* charArray;
std::string str(charArray); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T20:43:30.120

```
std::string str = const_char; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T20:45:23.953

只需使用 std::string 构造函数。您可以将其传递给 char*：

```
char* charArray = "My String";
std::string stdstr( charArray ); 
```

# java - 从Java中的静态方法获取类名

> ID：936684
> 
> 赞同：279
> 
> 时间：2009-06-01T20:42:16.660
> 
> 标签：java, static

如何从该类中的静态方法中获取该类的名称。例如

```
public class MyClass {
    public static String getClassName() {
        String name = ????; // what goes here so the string "MyClass" is returned
        return name;
    }
} 
```

把它放在上下文中，我实际上想将类名作为异常消息的一部分返回。

* * *

## 回答 #1

> 赞同：246
> 
> 时间：2009-06-01T20:44:02.067

为了正确支持重构（重命名类），您应该使用：

```
 MyClass.class.getName(); // full name with package 
```

或（感谢[@James Van Huis](https://stackoverflow.com/questions/936684/getting-the-class-name-from-a-static-method-in-java/936715#936715)）：

```
 MyClass.class.getSimpleName(); // class name and no more 
```

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2015-04-06T18:21:28.227

在 Java 7+ 中，您可以在静态方法/字段中执行此操作：

```
MethodHandles.lookup().lookupClass() 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2009-06-01T20:50:18.593

按照@toolkit 所说的去做。不要做这样的事情：

```
return new Object() { }.getClass().getEnclosingClass(); 
```

（**编辑：**或者，如果您使用的是在最初编写此答案后很好的 Java 版本，@Rein。）

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2017-11-04T15:29:34.370

因此，当我们需要在没有显式使用`MyClass.class`语法的情况下静态获取类对象或类的完整/简单名称时，就会遇到这种情况。

它在某些情况下非常方便，例如[![](https://i.stack.imgur.com/NT6zO.png)kotlin](/questions/tagged/kotlin "显示标记为“kotlin”的问题")上层函数的记录器实例（在这种情况下，kotlin 创建了一个静态 Java 类，无法从 kotlin 代码访问）。

我们有几种不同的变体来获取此信息：

1.  `new Object(){}.getClass().getEnclosingClass();`
    汤姆·霍廷（Tom Hawtin）指出[- tackline](https://stackoverflow.com/a/936724/1816338)

2.  `getClassContext()[0].getName();`来自[克里斯托弗](https://stackoverflow.com/a/936776/1816338)`SecurityManager`
    所 指出的

3.  `new Throwable().getStackTrace()[0].getClassName();`
    路德维希[伯爵](https://stackoverflow.com/a/1577359/1816338)

4.  `Thread.currentThread().getStackTrace()[1].getClassName();`
    来自[凯克西](https://stackoverflow.com/a/2971457/1816338)

5.  最后
    `MethodHandles.lookup().lookupClass();`
    来自[Rein真棒](https://stackoverflow.com/a/29477085/1816338)

我为所有变体准备了一个[jmh](/questions/tagged/jmh "显示标记为“jmh”的问题")基准，结果是：

```
# Run complete. Total time: 00:04:18

Benchmark                                                      Mode  Cnt      Score     Error  Units
StaticClassLookup.MethodHandles_lookup_lookupClass             avgt   30      3.630 ±   0.024  ns/op
StaticClassLookup.AnonymousObject_getClass_enclosingClass      avgt   30    282.486 ±   1.980  ns/op
StaticClassLookup.SecurityManager_classContext_1               avgt   30    680.385 ±  21.665  ns/op
StaticClassLookup.Thread_currentThread_stackTrace_1_className  avgt   30  11179.460 ± 286.293  ns/op
StaticClassLookup.Throwable_stackTrace_0_className             avgt   30  10221.209 ± 176.847  ns/op 
```

### 结论

1.  **使用的最佳变体**，相当干净且速度极快。
    **仅从 Java 7 和 Android API 26 开始可用！**

```
 MethodHandles.lookup().lookupClass(); 
```

2.  如果您需要 Android 或 Java 6 的此功能，您可以使用第二好的变体。它也相当快，**但在每个使用地点创建一个匿名类**:(

```
 new Object(){}.getClass().getEnclosingClass(); 
```

3.  如果您在很多地方都需要它并且不希望您的字节码因大量匿名类而膨胀——`SecurityManager`是您的朋友（第三个最佳选择）。

    但你不能只是调用`getClassContext()`——它在`SecurityManager`类中受到保护。您将需要一些像这样的辅助类：

```
 // Helper class
 public final class CallerClassGetter extends SecurityManager
 {
    private static final CallerClassGetter INSTANCE = new CallerClassGetter();
    private CallerClassGetter() {}

    public static Class<?> getCallerClass() {
        return INSTANCE.getClassContext()[1];
    }
 }

 // Usage example:
 class FooBar
 {
    static final Logger LOGGER = LoggerFactory.getLogger(CallerClassGetter.getCallerClass())
 } 
```

4.  您可能永远不需要使用基于`getStackTrace()`from 异常或`Thread.currentThread()`. **效率非常**低，只能返回类名`String`，而不是`Class<*>`实例。

### 附言

如果你想为静态 kotlin utils 创建一个记录器实例（比如我 :)，你可以使用这个助手：

```
import org.slf4j.Logger
import org.slf4j.LoggerFactory

// Should be inlined to get an actual class instead of the one where this helper declared
// Will work only since Java 7 and Android API 26!
@Suppress("NOTHING_TO_INLINE")
inline fun loggerFactoryStatic(): Logger
    = LoggerFactory.getLogger(MethodHandles.lookup().lookupClass()) 
```

使用示例：

```
private val LOGGER = loggerFactoryStatic()

/**
 * Returns a pseudo-random, uniformly distributed value between the
 * given least value (inclusive) and bound (exclusive).
 *
 * @param min the least value returned
 * @param max the upper bound (exclusive)
 *
 * @return the next value
 * @throws IllegalArgumentException if least greater than or equal to bound
 * @see java.util.concurrent.ThreadLocalRandom.nextDouble(double, double)
 */
fun Random.nextDouble(min: Double = .0, max: Double = 1.0): Double {
    if (min >= max) {
        if (min == max) return max
        LOGGER.warn("nextDouble: min $min > max $max")
        return min
    }
    return nextDouble() * (max - min) + min
} 
```

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2010-06-04T04:09:02.753

该指令工作正常：

```
Thread.currentThread().getStackTrace()[1].getClassName(); 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2011-08-05T21:20:49.533

你可以像这样使用 JNI 来做一些非常棒的事情：

我的对象.java：

```
public class MyObject
{
    static
    {
        System.loadLibrary( "classname" );
    }

    public static native String getClassName();

    public static void main( String[] args )
    {
        System.out.println( getClassName() );
    }
} 
```

然后：

```
javac MyObject.java
javah -jni MyObject 
```

然后：

我的对象.c：

```
#include "MyObject.h"

JNIEXPORT jstring JNICALL Java_MyObject_getClassName( JNIEnv *env, jclass cls )
{
    jclass javaLangClass = (*env)->FindClass( env, "java/lang/Class" );
    jmethodID getName = (*env)->GetMethodID( env, javaLangClass, "getName",
        "()Ljava/lang/String;" );
    return (*env)->CallObjectMethod( env, cls, getName );
} 
```

然后将 C 编译成一个名为的共享库`libclassname.so`并运行 java!

*轻笑

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2009-10-16T10:41:27.150

我使用它在我的类（或注释）顶部初始化 Log4j 记录器。

PRO：Throwable 已经加载，您可以通过不使用“IO 繁重”的 SecurityManager 来节省资源。

CON：关于这是否适用于所有 JVM 的一些问题。

```
// Log4j . Logger --- Get class name in static context by creating an anonymous Throwable and 
// getting the top of its stack-trace. 
// NOTE you must use: getClassName() because getClass() just returns StackTraceElement.class 
static final Logger logger = Logger.getLogger(new Throwable() .getStackTrace()[0].getClassName()); 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2009-06-01T21:03:48.860

滥用 SecurityManager

```
System.getSecurityManager().getClassContext()[0].getName(); 
```

或者，如果未设置，请使用扩展它的内部类（以下示例可耻地从[Real 的 HowTo](http://www.rgagnon.com/javadetails/java-0402.html)复制）：

```
public static class CurrentClassGetter extends SecurityManager {
    public String getClassName() {
        return getClassContext()[1].getName(); 
    }
} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-06-01T20:47:50.250

如果你想要整个包名，请调用：

```
String name = MyClass.class.getCanonicalName(); 
```

如果您只想要最后一个元素，请调用：

```
String name = MyClass.class.getSimpleName(); 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-07-01T03:43:12.773

像实际使用调用者的类一样逐字使用`MyClass.class.getName()`，但如果将此代码传播到需要此类名称的众多类/子类，则容易出现复制/粘贴错误。

而且[汤姆·霍廷的食谱](https://stackoverflow.com/a/936724/972463)其实还不错，只需要用正确的方式烹饪即可：）

如果您有一个带有可以从子类调用的静态方法的基类，并且该静态方法需要知道实际调用者的类，则可以通过以下方式实现：

```
class BaseClass {
  static sharedStaticMethod (String callerClassName, Object... otherArgs) {
    useCallerClassNameAsYouWish (callerClassName);
    // and direct use of 'new Object() { }.getClass().getEnclosingClass().getName()'
    // instead of 'callerClassName' is not going to help here,
    // as it returns "BaseClass"
  }
}

class SubClass1 extends BaseClass {
  static someSubclassStaticMethod () {
    // this call of the shared method is prone to copy/paste errors
    sharedStaticMethod (SubClass1.class.getName(),
                        other_arguments);
    // and this call is safe to copy/paste
    sharedStaticMethod (new Object() { }.getClass().getEnclosingClass().getName(),
                        other_arguments);
  }
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-02-12T14:25:12.143

一个重构安全、剪切和粘贴安全的解决方案，避免了下面的临时类的定义。

编写一个恢复类名的静态方法，注意在方法名中包含类名：

```
private static String getMyClassName(){
  return MyClass.class.getName();
} 
```

然后在您的静态方法中调用它：

```
public static void myMethod(){
  Tracer.debug(getMyClassName(), "message");
} 
```

通过避免使用字符串来提供重构安全性，授予剪切和粘贴安全性，因为如果剪切和粘贴调用方方法，您将不会在目标“MyClass2”类中找到 getMyClassName()，因此您将被迫重新定义和更新它。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-04-20T11:14:58.080

由于这个问题[像 `this.class` 而不是 `ClassName.class`？](https://stackoverflow.com/questions/29492993/something-like-this-class-instead-of-classname-class)被标记为这个重复项（这是有争议的，因为该问题是关于类而不是类名），我在这里发布答案：

```
class MyService {
    private static Class thisClass = MyService.class;
    // or:
    //private static Class thisClass = new Object() { }.getClass().getEnclosingClass();
    ...
    static void startService(Context context) {
        Intent i = new Intent(context, thisClass);
        context.startService(i);
    }
} 
```

`thisClass`定义为**私有**很重要，因为：
1）它不能被继承：派生类必须定义自己的`thisClass`或产生错误消息
2）来自其他类的引用应该作为`ClassName.class`而不是`ClassName.thisClass`.

定义后，对`thisClass`类名的访问变为：

```
thisClass.getName() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-03-26T10:21:47.340

我需要多个类的静态方法中的类名，所以我使用以下方法实现了一个 JavaUtil 类：

```
public static String getClassName() {
    String className = Thread.currentThread().getStackTrace()[2].getClassName();
    int lastIndex = className.lastIndexOf('.');
    return className.substring(lastIndex + 1);
} 
```

希望它会有所帮助！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-12-22T13:55:23.003

我已经将这两种方法用于`static`和`non static`场景：

**主类：**

```
//For non static approach
public AndroidLogger(Object classObject) {
    mClassName = classObject.getClass().getSimpleName();
}

//For static approach
public AndroidLogger(String className) {
    mClassName = className;
} 
```

如何提供类名：

**非静态方式：**

```
private AndroidLogger mLogger = new AndroidLogger(this); 
```

**静态方式：**

```
private static AndroidLogger mLogger = new AndroidLogger(Myclass.class.getSimpleName()); 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2015-06-11T16:11:30.547

如果您使用反射，则可以获取 Method 对象，然后：

```
method.getDeclaringClass().getName() 
```

要获取方法本身，您可以使用：

```
Class<?> c = Class.forName("class name");
Method  method = c.getDeclaredMethod ("method name", parameterTypes) 
```

# c++ - 如何使用 new 在 C++ 中声明二维数组？

> ID：936687
> 
> 赞同：605
> 
> 时间：2009-06-01T20:42:20.013
> 
> 标签：c++, arrays, multidimensional-array, dynamic-allocation

如何使用 new 声明二维数组？

就像，对于“正常”数组，我会：

```
int* ary = new int[Size] 
```

但

```
int** ary = new int[sizeY][sizeX] 
```

a) 不工作/编译和 b) 不完成什么：

```
int ary[sizeY][sizeX] 
```

做。

* * *

## 回答 #1

> 赞同：856
> 
> 时间：2009-06-01T20:45:15.920

如果您的行长是编译时间常数，C++11 允许

```
auto arr2d = new int [nrows][CONSTANT]; 
```

看到[这个答案](https://stackoverflow.com/questions/936687/how-do-i-declare-a-2d-array-in-c-using-new/16239446#16239446)。像 gcc 这样允许可变长度数组作为 C++ 扩展的编译器可以使用`new` [此处所示的](https://stackoverflow.com/a/8837664/224132)方式来获得 C99 所允许的完全运行时可变数组维度功能，但可移植的 ISO C++ 仅限于第一个维度是可变的。

另一个有效的选择是手动将 2d 索引到一个大的 1d 数组中，正如[另一个答案所示](https://stackoverflow.com/questions/936687/how-do-i-declare-a-2d-array-in-c-using-new/28841507#28841507)，允许与真正的 2D 数组相同的编译器优化（例如，证明或检查数组不会相互别名/重叠）。

* * *

否则，您可以使用指向数组的*指针数组*来允许 2D 语法，如连续的 2D 数组，即使它不是有效的单个大分配。您可以使用循环对其进行初始化，如下所示：

```
int** a = new int*[rowCount];
for(int i = 0; i < rowCount; ++i)
    a[i] = new int[colCount]; 
```

以上， for`colCount= 5`和`rowCount = 4`，将产生以下结果：

![在此处输入图像描述](https://i.stack.imgur.com/M75kn.png)

`delete`在删除指针数组之前，不要忘记用循环分别对每一行进行处理。[另一个答案](https://stackoverflow.com/a/936709/224132)中的示例。

* * *

## 回答 #2

> 赞同：331
> 
> 时间：2009-06-01T20:46:22.237

```
int** ary = new int[sizeY][sizeX] 
```

应该：

```
int **ary = new int*[sizeY];
for(int i = 0; i < sizeY; ++i) {
    ary[i] = new int[sizeX];
} 
```

然后清理将是：

```
for(int i = 0; i < sizeY; ++i) {
    delete [] ary[i];
}
delete [] ary; 
```

**编辑：**正如 Dietrich Epp 在评论中指出的那样，这并不是一个轻量级的解决方案。另一种方法是使用一大块内存：

```
int *ary = new int[sizeX*sizeY];

// ary[i][j] is then rewritten as
ary[i*sizeY+j] 
```

* * *

## 回答 #3

> 赞同：233
> 
> 时间：2015-03-03T20:43:09.180

尽管[这个流行的答案](https://stackoverflow.com/a/936702/358475)将为您提供所需的索引语法，但它的效率是双重的：空间和时间都很大而且很慢。有更好的方法。

**为什么这个答案又大又慢**

建议的解决方案是创建一个动态指针数组，然后将每个指针初始化为其自己的独立动态数组。这种方法的**优点**是它为您提供了您习惯的索引语法，因此如果您想在位置 x,y 找到矩阵的值，您可以说：

```
int val = matrix[ x ][ y ]; 
```

这是可行的，因为 matrix[x] 返回一个指向数组的指针，然后用 [y] 索引该数组。分解它：

```
int* row = matrix[ x ];
int  val = row[ y ]; 
```

方便，是吗？我们喜欢我们的 [ x ][ y ] 语法。

但是该解决方案有一个很大的**缺点**，那就是它既胖又慢。

为什么？

既胖又慢的原因其实是一样的。矩阵中的每一“行”都是一个单独分配的动态数组。进行堆分配在时间和空间上都是昂贵的。分配器需要时间来进行分配，有时会运行 O(n) 算法来完成。分配器用额外的字节“填充”每个行数组，以进行簿记和对齐。额外的空间成本......嗯......额外的空间。当您去释放矩阵时，释放器*也将花费额外的时间，煞费苦心地释放每个单独的行分配。*光是想想就让我汗流浃背。

速度慢还有另一个原因。这些单独的分配往往存在于内存的不连续部分。一行可能在地址 1,000，另一行在地址 100,000——你明白了。这意味着当你遍历矩阵时，你就像一个野人一样在记忆中跳跃。这往往会导致缓存未命中，从而大大减慢您的处理时间。

因此，如果您绝对必须拥有可爱的 [x][y] 索引语法，请使用该解决方案。如果您想要快速和小巧（如果您不关心这些，为什么要在 C++ 中工作？），您需要一个不同的解决方案。

**不同的解决方案**

更好的解决方案是将整个矩阵分配为单个动态数组，然后使用（稍微）聪明的索引数学来访问单元格。索引数学只是非常聪明。不，这根本不聪明：很明显。

```
class Matrix
{
    ...
    size_t index( int x, int y ) const { return x + m_width * y; }
}; 
```

给定这个`index()`函数（我想象它是一个类的成员，因为它需要知道`m_width`你的矩阵），你可以访问矩阵数组中的单元格。矩阵数组是这样分配的：

```
array = new int[ width * height ]; 
```

所以在缓慢的胖解决方案中相当于这个：

```
array[ x ][ y ] 
```

...这是在快速、小型的解决方案中吗：

```
array[ index( x, y )] 
```

伤心，我知道。但你会习惯的。你的 CPU 会感谢你的。

* * *

## 回答 #4

> 赞同：124
> 
> 时间：2013-04-26T14:57:10.417

在 C++11 中，可以：

```
auto array = new double[M][N]; 
```

这样，内存不会被初始化。要初始化它，请改为：

```
auto array = new double[M][N](); 
```

示例程序（使用“g++ -std=c++11”编译）：

```
#include <iostream>
#include <utility>
#include <type_traits>
#include <typeinfo>
#include <cxxabi.h>
using namespace std;

int main()
{
    const auto M = 2;
    const auto N = 2;

    // allocate (no initializatoin)
    auto array = new double[M][N];

    // pollute the memory
    array[0][0] = 2;
    array[1][0] = 3;
    array[0][1] = 4;
    array[1][1] = 5;

    // re-allocate, probably will fetch the same memory block (not portable)
    delete[] array;
    array = new double[M][N];

    // show that memory is not initialized
    for(int r = 0; r < M; r++)
    {
        for(int c = 0; c < N; c++)
            cout << array[r][c] << " ";
        cout << endl;
    }
    cout << endl;

    delete[] array;

    // the proper way to zero-initialize the array
    array = new double[M][N]();

    // show the memory is initialized
    for(int r = 0; r < M; r++)
    {
        for(int c = 0; c < N; c++)
            cout << array[r][c] << " ";
        cout << endl;
    }

    int info;
    cout << abi::__cxa_demangle(typeid(array).name(),0,0,&info) << endl;

    return 0;
} 
```

输出：

```
2 4 
3 5 

0 0 
0 0 
double (*) [2] 
```

* * *

## 回答 #5

> 赞同：62
> 
> 时间：2009-06-01T21:13:58.887

我从您的静态数组示例中推测您想要一个矩形数组，而不是锯齿状数组。您可以使用以下内容：

```
int *ary = new int[sizeX * sizeY]; 
```

然后你可以访问元素：

```
ary[y*sizeX + x] 
```

不要忘记在`ary`.

* * *

## 回答 #6

> 赞同：56
> 
> 时间：2015-08-28T20:44:37.143

我会在 C++11 及更高版本中为此推荐两种通用技术，一种用于编译时维度，一种用于运行时。两个答案都假设您想要统一的二维数组（而不是锯齿状数组）。

### 编译时间维度

使用 a `std::array`of`std::array`然后使用`new`把它放到堆上：

```
// the alias helps cut down on the noise:
using grid = std::array<std::array<int, sizeX>, sizeY>;
grid * ary = new grid; 
```

同样，这只适用于在编译时知道尺寸大小的情况。

### 运行时维度

完成仅在运行时才知道大小的二维数组的最佳方法是将其包装到一个类中。该类将分配一个一维数组，然后重载`operator []`以提供第一个维度的索引。这是有效的，因为在 C++ 中，二维数组是行优先的：

[![以逻辑形式和一维形式显示的矩阵](https://i.stack.imgur.com/Jx5kE.png)](https://i.stack.imgur.com/Jx5kE.png)

^(（取自[http://eli.thegreenplace.net/2015/memory-layout-of-multi-dimensional-arrays/](http://eli.thegreenplace.net/2015/memory-layout-of-multi-dimensional-arrays/)）)

连续的内存序列有利于性能，也易于清理。这是一个示例类，它省略了很多有用的方法，但显示了基本思想：

```
#include <memory>

class Grid {
  size_t _rows;
  size_t _columns;
  std::unique_ptr<int[]> data;

public:
  Grid(size_t rows, size_t columns)
      : _rows{rows},
        _columns{columns},
        data{std::make_unique<int[]>(rows * columns)} {}

  size_t rows() const { return _rows; }

  size_t columns() const { return _columns; }

  int *operator[](size_t row) { return row * _columns + data.get(); }

  int &operator()(size_t row, size_t column) {
    return data[row * _columns + column];
  }
} 
```

`std::make_unique<int[]>(rows * columns)`所以我们创建了一个包含条目的数组。我们重载`operator []`它将为我们索引该行。它返回一个`int *`指向行首的 which ，然后可以正常取消引用该列。请注意，`make_unique`首先在 C++14 中发布，但如果需要，您可以在 C++11 中对其进行 polyfill。

这些类型的结构重载也很常见`operator()`：

```
 int &operator()(size_t row, size_t column) {
    return data[row * _columns + column];
  } 
```

^(从技术上讲，我没有`new`在这里使用过，但是从 to 移动`std::unique_ptr<int[]>`并`int *`使用`new`/是微不足道的`delete`。)

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2016-06-06T14:10:58.790

为什么不使用 STL:vector？如此简单，您无需删除矢量。

```
int rows = 100;
int cols = 200;
vector< vector<int> > f(rows, vector<int>(cols));
f[rows - 1][cols - 1] = 0; // use it like arrays 
```

您也可以初始化“数组”，只需给它一个默认值

```
const int DEFAULT = 1234;
vector< vector<int> > f(rows, vector<int>(cols, DEFAULT)); 
```

资料来源：[如何在 C/C++ 中创建 2、3（或多）维数组？](https://helloacm.com/how-to-create-2-3-or-multi-dimensional-arrays-in-c-c/)

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2009-06-02T16:18:04.050

这个问题困扰着我——这是一个很常见的问题，应该已经存在一个好的解决方案，比向量的向量或滚动你自己的数组索引更好。

当 C++ 中应该存在某些东西但不存在时，首先要查看的是[boost.org](http://www.boost.org/)。在那里我找到了[Boost 多维数组库，**`multi_array`**](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/index.html) . 它甚至包括一个`multi_array_ref`可用于包装您自己的一维数组缓冲区的类。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2016-03-09T10:13:47.750

**二维数组基本上是一维指针数组，其中每个指针都指向一个一维数组，该数组将保存实际数据。**

这里N是行，M是列。

**动态分配**

```
int** ary = new int*[N];
  for(int i = 0; i < N; i++)
      ary[i] = new int[M]; 
```

**填**

```
for(int i = 0; i < N; i++)
    for(int j = 0; j < M; j++)
      ary[i][j] = i; 
```

**打印**

```
for(int i = 0; i < N; i++)
    for(int j = 0; j < M; j++)
      std::cout << ary[i][j] << "\n"; 
```

**自由**

```
for(int i = 0; i < N; i++)
    delete [] ary[i];
delete [] ary; 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-12-28T01:01:26.773

这个问题困扰了我 15 年，提供的所有解决方案都不能让我满意。如何在内存中连续创建动态多维数组？今天我终于找到了答案。使用以下代码，您可以做到这一点：

```
#include <iostream>

int main(int argc, char** argv)
{
    if (argc != 3)
    {
        std::cerr << "You have to specify the two array dimensions" << std::endl;
        return -1;
    }

    int sizeX, sizeY;

    sizeX = std::stoi(argv[1]);
    sizeY = std::stoi(argv[2]);

    if (sizeX <= 0)
    {
        std::cerr << "Invalid dimension x" << std::endl;
        return -1;
    }
    if (sizeY <= 0)
    {
        std::cerr << "Invalid dimension y" << std::endl;
        return -1;
    }

    /******** Create a two dimensional dynamic array in continuous memory ******
     *
     * - Define the pointer holding the array
     * - Allocate memory for the array (linear)
     * - Allocate memory for the pointers inside the array
     * - Assign the pointers inside the array the corresponding addresses
     *   in the linear array
     **************************************************************************/

    // The resulting array
    unsigned int** array2d;

    // Linear memory allocation
    unsigned int* temp = new unsigned int[sizeX * sizeY];

    // These are the important steps:
    // Allocate the pointers inside the array,
    // which will be used to index the linear memory
    array2d = new unsigned int*[sizeY];

    // Let the pointers inside the array point to the correct memory addresses
    for (int i = 0; i < sizeY; ++i)
    {
        array2d[i] = (temp + i * sizeX);
    }

    // Fill the array with ascending numbers
    for (int y = 0; y < sizeY; ++y)
    {
        for (int x = 0; x < sizeX; ++x)
        {
            array2d[y][x] = x + y * sizeX;
        }
    }

    // Code for testing
    // Print the addresses
    for (int y = 0; y < sizeY; ++y)
    {
        for (int x = 0; x < sizeX; ++x)
        {
            std::cout << std::hex << &(array2d[y][x]) << ' ';
        }
    }
    std::cout << "\n\n";

    // Print the array
    for (int y = 0; y < sizeY; ++y)
    {
        std::cout << std::hex << &(array2d[y][0]) << std::dec;
        std::cout << ": ";
        for (int x = 0; x < sizeX; ++x)
        {
            std::cout << array2d[y][x] << ' ';
        }
        std::cout << std::endl;
    }

    // Free memory
    delete[] array2d[0];
    delete[] array2d;
    array2d = nullptr;

    return 0;
} 
```

当您使用值 sizeX=20 和 sizeY=15 调用程序时，输出将如下所示：

```
0x603010 0x603014 0x603018 0x60301c 0x603020 0x603024 0x603028 0x60302c 0x603030 0x603034 0x603038 0x60303c 0x603040 0x603044 0x603048 0x60304c 0x603050 0x603054 0x603058 0x60305c 0x603060 0x603064 0x603068 0x60306c 0x603070 0x603074 0x603078 0x60307c 0x603080 0x603084 0x603088 0x60308c 0x603090 0x603094 0x603098 0x60309c 0x6030a0 0x6030a4 0x6030a8 0x6030ac 0x6030b0 0x6030b4 0x6030b8 0x6030bc 0x6030c0 0x6030c4 0x6030c8 0x6030cc 0x6030d0 0x6030d4 0x6030d8 0x6030dc 0x6030e0 0x6030e4 0x6030e8 0x6030ec 0x6030f0 0x6030f4 0x6030f8 0x6030fc 0x603100 0x603104 0x603108 0x60310c 0x603110 0x603114 0x603118 0x60311c 0x603120 0x603124 0x603128 0x60312c 0x603130 0x603134 0x603138 0x60313c 0x603140 0x603144 0x603148 0x60314c 0x603150 0x603154 0x603158 0x60315c 0x603160 0x603164 0x603168 0x60316c 0x603170 0x603174 0x603178 0x60317c 0x603180 0x603184 0x603188 0x60318c 0x603190 0x603194 0x603198 0x60319c 0x6031a0 0x6031a4 0x6031a8 0x6031ac 0x6031b0 0x6031b4 0x6031b8 0x6031bc 0x6031c0 0x6031c4 0x6031c8 0x6031cc 0x6031d0 0x6031d4 0x6031d8 0x6031dc 0x6031e0 0x6031e4 0x6031e8 0x6031ec 0x6031f0 0x6031f4 0x6031f8 0x6031fc 0x603200 0x603204 0x603208 0x60320c 0x603210 0x603214 0x603218 0x60321c 0x603220 0x603224 0x603228 0x60322c 0x603230 0x603234 0x603238 0x60323c 0x603240 0x603244 0x603248 0x60324c 0x603250 0x603254 0x603258 0x60325c 0x603260 0x603264 0x603268 0x60326c 0x603270 0x603274 0x603278 0x60327c 0x603280 0x603284 0x603288 0x60328c 0x603290 0x603294 0x603298 0x60329c 0x6032a0 0x6032a4 0x6032a8 0x6032ac 0x6032b0 0x6032b4 0x6032b8 0x6032bc 0x6032c0 0x6032c4 0x6032c8 0x6032cc 0x6032d0 0x6032d4 0x6032d8 0x6032dc 0x6032e0 0x6032e4 0x6032e8 0x6032ec 0x6032f0 0x6032f4 0x6032f8 0x6032fc 0x603300 0x603304 0x603308 0x60330c 0x603310 0x603314 0x603318 0x60331c 0x603320 0x603324 0x603328 0x60332c 0x603330 0x603334 0x603338 0x60333c 0x603340 0x603344 0x603348 0x60334c 0x603350 0x603354 0x603358 0x60335c 0x603360 0x603364 0x603368 0x60336c 0x603370 0x603374 0x603378 0x60337c 0x603380 0x603384 0x603388 0x60338c 0x603390 0x603394 0x603398 0x60339c 0x6033a0 0x6033a4 0x6033a8 0x6033ac 0x6033b0 0x6033b4 0x6033b8 0x6033bc 0x6033c0 0x6033c4 0x6033c8 0x6033cc 0x6033d0 0x6033d4 0x6033d8 0x6033dc 0x6033e0 0x6033e4 0x6033e8 0x6033ec 0x6033f0 0x6033f4 0x6033f8 0x6033fc 0x603400 0x603404 0x603408 0x60340c 0x603410 0x603414 0x603418 0x60341c 0x603420 0x603424 0x603428 0x60342c 0x603430 0x603434 0x603438 0x60343c 0x603440 0x603444 0x603448 0x60344c 0x603450 0x603454 0x603458 0x60345c 0x603460 0x603464 0x603468 0x60346c 0x603470 0x603474 0x603478 0x60347c 0x603480 0x603484 0x603488 0x60348c 0x603490 0x603494 0x603498 0x60349c 0x6034a0 0x6034a4 0x6034a8 0x6034ac 0x6034b0 0x6034b4 0x6034b8 0x6034bc 

0x603010: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 
0x603060: 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
0x6030b0: 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 
0x603100: 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 
0x603150: 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 
0x6031a0: 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 
0x6031f0: 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 
0x603240: 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 
0x603290: 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 
0x6032e0: 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 
0x603330: 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 
0x603380: 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 
0x6033d0: 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 
0x603420: 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 
0x603470: 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 
```

如您所见，多维数组连续位于内存中，没有两个内存地址重叠。甚至释放数组的例程也比为每一列（或每一行，取决于您如何查看数组）动态分配内存的标准方法更简单。由于阵列基本上由两个线性阵列组成，因此只有这两个必须（并且可以）被释放。

这种方法可以扩展到具有相同概念的两个以上的维度。我不会在这里做，但是当你得到它背后的想法时，这是一个简单的任务。

我希望这段代码对你的帮助和对我的帮助一样多。

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2012-01-12T15:32:32.250

如何在 GNU C++ 中分配一个连续的多维数组？有一个 GNU 扩展允许“标准”语法工作。

看来问题来自运算符 new []。确保您使用 operator new 代替：

```
double (* in)[n][n] = new (double[m][n][n]);  // GNU extension 
```

仅此而已：您将获得一个与 C 兼容的多维数组...

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2009-06-01T20:59:55.030

**typedef 是你的朋友**

在回头查看许多其他答案后，我发现需要进行更深入的解释，因为许多其他答案要么存在性能问题，要么迫使您使用不寻常或繁琐的语法来声明数组，或者访问数组元素（或以上所有元素）。

首先，这个答案假设您在编译时知道数组的维度。如果这样做，那么这是最好的解决方案，因为它既能提供**最佳性能**，又允许您使用**标准数组语法来访问数组元素**。

这提供最佳性能的原因是因为它将所有数组分配为一个连续的内存块，这意味着您可能有更少的页面丢失和更好的空间局部性。在循环中分配可能会导致各个数组最终分散在虚拟内存空间中的多个非连续页面上，因为分配循环可能会被其他线程或进程中断（可能多次），或者仅仅是由于分配器填充它恰好可用的小的空内存块。

其他好处是简单的声明语法和标准的数组访问语法。

在 C++ 中使用新的：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv) {

typedef double (array5k_t)[5000];

array5k_t *array5k = new array5k_t[5000];

array5k[4999][4999] = 10;
printf("array5k[4999][4999] == %f\n", array5k[4999][4999]);

return 0;
} 
```

或使用 calloc 的 C 风格：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv) {

typedef double (*array5k_t)[5000];

array5k_t array5k = calloc(5000, sizeof(double)*5000);

array5k[4999][4999] = 10;
printf("array5k[4999][4999] == %f\n", array5k[4999][4999]);

return 0;
} 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2019-01-05T20:34:17.363

此答案的目的不是添加其他人尚未涵盖的任何新内容，而是扩展@Kevin Loney 的答案。

您可以使用轻量级声明：

```
int *ary = new int[SizeX*SizeY] 
```

访问语法将是：

```
ary[i*SizeY+j]     // ary[i][j] 
```

但这对大多数人来说很麻烦，并且可能导致混乱。因此，您可以按如下方式定义宏：

```
#define ary(i, j)   ary[(i)*SizeY + (j)] 
```

现在您可以使用非常相似的语法访问该数组`ary(i, j) // means ary[i][j]`。这具有简单美观的优点，同时使用表达式代替索引也更简单，更少混乱。

要访问，比如说，ary[2+5][3+8]，你可以写`ary(2+5, 3+8)`而不是看起来很复杂，`ary[(2+5)*SizeY + (3+8)]`即它节省了括号并提高了可读性。

**注意事项：**

*   尽管语法非常相似，但并不相同。
*   如果您将数组传递给其他函数，`SizeY`则必须以相同的名称传递（或者改为声明为全局变量）。

或者，如果您需要在多个函数中使用数组，那么您也可以在宏定义中添加 SizeY 作为另一个参数，如下所示：

```
#define ary(i, j, SizeY)  ary[(i)*(SizeY)+(j)] 
```

你明白了。当然，这会变得太长而无用，但它仍然可以防止 + 和 * 的混淆。

这不是绝对推荐的，它会被大多数有经验的用户谴责为不好的做法，但由于它的优雅，我忍不住分享它。

**编辑：**
如果您想要一个适用于任意数量数组的便携式解决方案，您可以使用以下语法：

```
#define access(ar, i, j, SizeY) ar[(i)*(SizeY)+(j)] 
```

然后您可以使用访问语法将任何大小的数组传递给调用：

```
access(ary, i, j, SizeY)      // ary[i][j] 
```

PS：我已经测试了这些，并且在 g++14 和 g++11 编译器上使用相同的语法（作为左值和右值）。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-06-01T20:45:45.137

尝试这样做：

```
int **ary = new int* [sizeY];
for (int i = 0; i < sizeY; i++)
    ary[i] = new int[sizeX]; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-05-26T17:42:25.377

在这里，我有两个选择。第一个显示了数组数组或指针指针的概念。我更喜欢第二个，因为地址是连续的，如图所示。

[![在此处输入图像描述](https://i.stack.imgur.com/GXAI5.png)](https://i.stack.imgur.com/GXAI5.png)

```
#include <iostream>

using namespace std;

int main(){

    int **arr_01,**arr_02,i,j,rows=4,cols=5;

    //Implementation 1
    arr_01=new int*[rows];

    for(int i=0;i<rows;i++)
        arr_01[i]=new int[cols];

    for(i=0;i<rows;i++){
        for(j=0;j<cols;j++)
            cout << arr_01[i]+j << " " ;
        cout << endl;
    }

    for(int i=0;i<rows;i++)
        delete[] arr_01[i];
    delete[] arr_01;

    cout << endl;
    //Implementation 2
    arr_02=new int*[rows];
    arr_02[0]=new int[rows*cols];
    for(int i=1;i<rows;i++)
        arr_02[i]=arr_02[0]+cols*i;

    for(int i=0;i<rows;i++){
        for(int j=0;j<cols;j++)
            cout << arr_02[i]+j << " " ;
        cout << endl;
    }

    delete[] arr_02[0];
    delete[] arr_02;

    return 0;
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-06-26T04:11:32.163

下面的例子可能会有所帮助，

```
int main(void)
{
    double **a2d = new double*[5]; 
    /* initializing Number of rows, in this case 5 rows) */
    for (int i = 0; i < 5; i++)
    {
        a2d[i] = new double[3]; /* initializing Number of columns, in this case 3 columns */
    }

    for (int i = 0; i < 5; i++)
    {
        for (int j = 0; j < 3; j++)
        {
            a2d[i][j] = 1; /* Assigning value 1 to all elements */
        }
    }

    for (int i = 0; i < 5; i++)
    {
        for (int j = 0; j < 3; j++)
        {
            cout << a2d[i][j] << endl;  /* Printing all elements to verify all elements have been correctly assigned or not */
        }
    }

    for (int i = 0; i < 5; i++)
        delete[] a2d[i];

    delete[] a2d;

    return 0;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-09-04T22:36:00.430

**如果您的项目是 CLI (Common Language Runtime Support)**，那么：

您可以使用数组类，而不是您编写时获得的类：

```
#include <array>
using namespace std; 
```

换句话说，不是你在使用std命名空间和包含数组头时得到的非托管数组类，不是在std命名空间和数组头中定义的非托管数组类，而是CLI的托管类数组。

使用此类，您可以创建所需的任何**等级**的数组。

下面的代码创建了新的 2 行 3 列和 int 类型的二维数组，我将其命名为“arr”：

```
array<int, 2>^ arr = gcnew array<int, 2>(2, 3); 
```

现在您可以通过命名访问数组中的元素并**只写一个**方括号`[]`，然后在其中添加行和列，并用逗号分隔它们`,`。

下面的代码访问我已经在上面的代码中创建的数组的第 2 行和第 1 列中的元素：

```
arr[0, 1] 
```

只写这一行就是读取该单元格中的值，即获取该单元格中的值，但是如果添加`=`等号，则将要写入该单元格中的值，即设置该单元格中的值。当然，您也可以使用 +=、-=、*= 和 /= 运算符，仅用于数字（int、float、double、__int16、__int32、__int64 等），但请确保您已经知道。

如果您的项目**不是**CLI，那么您`#include <array>`当然可以使用 std 命名空间的非托管数组类，但问题是这个数组类与 CLI 数组不同。创建这种类型的数组与 CLI 相同，只是您必须删除`^`符号和`gcnew`关键字。但不幸的是，`<>`括号中的第二个 int 参数指定了数组的**长度（即大小） ，****而不是**它的等级！

无法在这种数组中指定排名，排名只是 CLI 数组的特性**。**.

std 数组的行为类似于 c++ 中的普通数组，您可以使用指针定义，例如`int*`then: `new int[size]`，或不使用指针: `int arr[size]`，但与 c++ 的普通数组不同，std 数组提供了可以与数组元素一起使用的函数，像填充、开始、结束、大小等，但普通数组**什么也不**提供。

但 std 数组仍然是一维数组，就像普通的 c++ 数组一样。但是感谢其他人提出的关于如何将普通的 c++ 一维数组转换为二维数组的解决方案，我们可以将相同的想法应用于 std 数组，例如根据 Mehrdad Afshari 的想法，我们可以编写以下代码：

```
array<array<int, 3>, 2> array2d = array<array<int, 3>, 2>(); 
```

这行代码创建了一个**“jugged array”**，它是一个一维数组，它的每个单元格都是或指向另一个一维数组。

如果一维数组中的所有一维数组的长度/大小都相等，那么您可以将 array2d 变量视为真正的二维数组，另外您可以使用特殊方法来处理行或列，具体取决于您如何查看它请记住，在二维数组中，std 数组支持。

您也可以使用 Kevin Loney 的解决方案：

```
int *ary = new int[sizeX*sizeY];

// ary[i][j] is then rewritten as
ary[i*sizeY+j] 
```

但如果您使用 std 数组，则代码必须看起来不同：

```
array<int, sizeX*sizeY> ary = array<int, sizeX*sizeY>();
ary.at(i*sizeY+j); 
```

并且仍然具有 std 数组的独特功能。

请注意，您仍然可以使用`[]`括号访问 std 数组的元素，并且不必调用该`at`函数。您还可以定义和分配新的 int 变量，该变量将计算并保留 std 数组中的元素总数，并使用其值，而不是重复`sizeX*sizeY`

可以定义自己的二维数组泛型类，定义二维数组类的构造函数接收两个整数来指定新的二维数组的行数和列数，定义get函数接收整数的两个参数访问二维数组中的一个元素并返回它的值，设置函数接收三个参数，第一个是指定二维数组中行和列的整数，第三个参数是新的值元素。它的类型取决于你在泛型类中选择的类型。

您将能够通过使用普通的 c++ 数组（指针或没有指针）或 std 数组来实现所有这一切，**并**使用**其他**人建议的想法之一，并使其易于使用，如 cli 数组或两者您可以在 C# 中定义、分配和使用的维度数组。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-10-01T11:54:26.180

首先使用指针定义数组（第 1 行）：

```
int** a = new int* [x];     //x is the number of rows
for(int i = 0; i < x; i++)
    a[i] = new int[y];     //y is the number of columns 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-11-21T13:49:27.503

如果你想要一个二维整数数组，哪些元素在内存中按顺序分配，你必须像这样声明它

```
int (*intPtr)[n] = new int[x][n] 
```

你可以写任何维度而不是**x ，但****n**在两个地方必须相同。例子

```
int (*intPtr)[8] = new int[75][8];
intPtr[5][5] = 6;
cout<<intPtr[0][45]<<endl; 
```

必须打印 6。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-01-06T15:10:54.120

我不确定是否没有提供以下答案，但我决定为二维数组的分配添加一些局部优化（例如，方阵仅通过一次分配完成）： `int** mat = new int*[n]; mat[0] = new int [n * n];`

但是，由于上述分配的线性，删除是这样的： `delete [] mat[0]; delete [] mat;`

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-06-20T08:33:48.767

这是一个旧答案，但我喜欢为 C++ 声明这样的动态数组

```
int sizeY,sizeX = 10;
 //declaring dynamic 2d array:
    int **ary = new int*[sizeY];
    for (int i = 0; i < sizeY; i++) 
    {
     ary[i] = new int[sizeX];
   } 
```

您可以像这样在运行时更改大小。这是在 c++ 98 中测试的

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-01-09T15:18:29.880

在某些情况下，我为您提供了最适合我的解决方案。特别是如果一个人知道[大小？]数组的一维。对于 chars 数组非常有用，例如，如果我们需要一个不同大小的 char[20] 数组的数组。

```
int  size = 1492;
char (*array)[20];

array = new char[size][20];
...
strcpy(array[5], "hola!");
...
delete [] array; 
```

关键是数组声明中的括号。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-01-29T11:26:24.720

我使用了这个不优雅但快速、简单且有效的系统。我不明白为什么不能工作，因为系统允许创建大尺寸数组和访问部件的唯一方法是不将其切割成部分：

```
#define DIM 3
#define WORMS 50000 //gusanos

void halla_centros_V000(double CENW[][DIM])
{
    CENW[i][j]=...
    ...
}

int main()
{
    double *CENW_MEM=new double[WORMS*DIM];
    double (*CENW)[DIM];
    CENW=(double (*)[3]) &CENW_MEM[0];
    halla_centros_V000(CENW);
    delete[] CENW_MEM;
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-11-14T03:52:11.350

我建议在二维数组上使用二维向量。基本上尽可能多地使用向量，主要是因为

1.  动态内存分配无忧
2.  自动内存管理

这是一个小代码片段，您可以在其中创建动态大小的数组

```
vector<vector<int>> arr;
for (int i=0; i<n; i++)
{    
    vector<int> temp;
    for (int j=0; j<k; j++)
    {
        int val;
        //assign values
        temp.push_back(val);
    }
    arr.push_back(temp);
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2013-09-30T17:20:51.843

动态声明二维数组：

```
 #include<iostream>
    using namespace std;
    int main()
    {
        int x = 3, y = 3;

        int **ptr = new int *[x];

        for(int i = 0; i<y; i++)
        {
            ptr[i] = new int[y];
        }
        srand(time(0));

        for(int j = 0; j<x; j++)
        {
            for(int k = 0; k<y; k++)
            {
                int a = rand()%10;
                ptr[j][k] = a;
                cout<<ptr[j][k]<<" ";
            }
            cout<<endl;
        }
    } 
```

现在在上面的代码中，我们获取了一个双指针并为其分配了一个动态内存并给出了列的值。这里分配的内存仅用于列，现在对于行，我们只需要一个 for 循环并为每一行分配一个动态内存。现在我们可以像使用二维数组一样使用指针了。在上面的例子中，我们将随机数分配给我们的二维数组（指针）。这都是关于二维数组的 DMA 的。

* * *

## 回答 #26

> 赞同：-3
> 
> 时间：2015-03-03T20:20:21.757

我在创建动态数组时使用它。如果你有一个类或结构。这有效。例子：

```
struct Sprite {
    int x;
};

int main () {
   int num = 50;
   Sprite **spritearray;//a pointer to a pointer to an object from the Sprite class
   spritearray = new Sprite *[num];
   for (int n = 0; n < num; n++) {
       spritearray[n] = new Sprite;
       spritearray->x = n * 3;
  }

   //delete from random position
    for (int n = 0; n < num; n++) {
        if (spritearray[n]->x < 0) {
      delete spritearray[n];
      spritearray[n] = NULL;
        }
    }

   //delete the array
    for (int n = 0; n < num; n++) {
      if (spritearray[n] != NULL){
         delete spritearray[n];
         spritearray[n] = NULL;
      }
    }
    delete []spritearray;
    spritearray = NULL;

   return 0;
  } 
```

# linux - Linux ACPI 配置

> ID：936695
> 
> 赞同：1
> 
> 时间：2009-06-01T20:44:00.557
> 
> 标签：linux, shutdown, acpi

在我的 Fedora Core Linux（内核 2.6.16.11）中，我一直在尝试测试与 CPU 温度相关的自动关闭机制。它不会自动正确关闭。

如果我当前的处理器温度为 50 摄氏度，并且我通过在提示符处执行以下命令将我的 ACPI 配置设置为在 55 摄氏度时关闭：

```
echo -n "55:50:45:40:35:30" > /proc/acpi/thermal_zone/THRM/trip_points
echo -n "1" > /proc/acpi/thermal_zone/THRM/polling_frequency
echo -n "0:0" > /proc/acpi/processor/CPU1/limit 
```

然后运行任何使我的温度超过 55 摄氏度的软件，系统不会像我需要的那样自动关闭。

但只要温度在 55 摄氏度以上，如果我再次运行以下命令：

```
echo -n "55:50:45:40:35:30" > /proc/acpi/thermal_zone/THRM/trip_points 
```

然后系统像我想要的那样立即关闭！有谁知道为什么系统不会自行关闭？

请注意，我确实运行了“/usr/sbin/acpid”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T20:23:09.397

运行这些 3 后`echo`，尝试`cat /proc/acpi/thermal_zone/THRM/trip_points`查看它的设置。我的猜测是，在设置其他两个之后它会被重置，所以我建议你运行第一个`echo`你只在其他两个之后编写的，它可能会有所帮助。

# html - 哪些是 HTML/XHTML 表单中的有效控制字符

> ID：936701
> 
> 赞同：0
> 
> 时间：2009-06-01T20:44:36.530
> 
> 标签：html, validation, xhtml, encoding, special-characters

我正在尝试创建表单验证单元，除了“常规”测试之外，它还会检查编码。

根据这篇文章[http://www.w3.org/International/questions/qa-forms-utf-8](http://www.w3.org/International/questions/qa-forms-utf-8)允许的字符是 0-31 范围内的 CR、LF 和 TAB，不允许 DEL=127。

另一方面，在 0x80-0xA0 范围内有控制字符。在不同的来源中，我看到它们是被允许的，而不是被允许的。我也看到这对于 XHTML、HTML 和 XML 是不同的。

有些文章告诉过FF也被允许？

有人可以提供一个很好的答案吗？什么可以给出，什么不能给出？

编辑：即使有[http://www.w3.org/International/questions/qa-controls](http://www.w3.org/International/questions/qa-controls)一些歧义

> 支持 C1 范围

但是表格显示它们是非法的并且之前显示的 UTF-8 验证允许它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-12T00:21:26.783

我认为您正在以错误的方式看待这个问题。您链接的资源指定哪些编码值在**(X)HTML**中有效，但听起来您想验证来自 Web 表单的“响应”——例如，各种表单控件的值，传递回您的服务器. 在这种情况下，您不应该查看 (X)HTML 中的有效内容，而是**application/x-www-form-urlencoded**以及**multipart/form-data**和 MIME 类型中有效的内容。[元素](http://www.w3.org/TR/html401/interact/forms.html#didx-applicationx-www-form-urlencoded)的[HTML 4.01 标准`<FORM>`](http://www.w3.org/TR/html401/interact/forms.html#didx-applicationx-www-form-urlencoded)明确规定，对于 application/x-www-form-urlencoded，“非字母数字字符替换为 '%HH'”：

> 这是默认的内容类型。使用此内容类型提交的表单必须编码如下：
> 
> 1.  控件名称和值被转义。空格字符被 '+' 替换，然后保留字符被转义，如[[RFC1738]](http://www.ietf.org/rfc/rfc1738.txt)第 2.2 节所述：非字母数字字符替换为 '%HH'、一个百分号和两个代表 ASCII 码的十六进制数字特点。换行符表示为“CR LF”对（即，`%0D%0A'）。
> 2.  控件名称/值按照它们在文档中出现的顺序列出。名称与值之间用“=”分隔，名称/值对之间用“&”分隔。

至于包含什么字符编码（即`%A0`是不间断空格还是错误），这是由元素[`accept-charset`](http://www.w3.org/TR/html401/interact/forms.html#adef-accept-charset)上的属性和响应的（嗯，实际上是一个或请求）标头协商的。`<FORM>``GET``POST``Content-Type`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-10T16:13:23.647

> 波斯特定律：做事要保守；对你从别人那里接受的东西要自由。

如果您正在生成文档供其他人阅读，您应该避免/转义所有控制字符，即使它们在技术上是合法的。如果你正在解析文档，你应该努力接受所有的控制字符，即使它们在技术上是非法的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T12:03:14.927

首先，任何八位字节都是有效的。提到的 UTF-8 序列的[正则表达式](http://www.w3.org/International/questions/qa-forms-utf-8)只是省略了其中的一些，因为它们在实践中很少被用户输入。但这并不意味着它们是无效的。他们只是预计不会发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-10T15:22:54.047

您提到的第一个链接与验证 XHTML 中允许的字符没有任何关系......该链接上的示例只是显示了一种通用/通用模式，用于检测原始数据是否采用 utf-8 编码。

这是第二个链接的引用：

> HTML、XHTML 和 XML 1.0 不支持 C0 范围，但 HT（水平制表）U+0009、LF（换行）U+000A 和 CR（回车）U+000D 除外。支持 C1 范围，即您可以直接对控件进行编码或将它们表示为 NCR（数字字符引用）。

我读这个的方式是：

如果您对 C1 范围内的任何控制字符进行编码（使用 base64 或十六进制表示）或将它们表示为 NCR，则支持它们。

C0 范围仅支持 U+0009、U+000A 和 U+000D。无法表示该范围内的其他控制代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-20T03:34:28.813

这些范围内的 Unicode 字符在 HTML 4.01 中有效：

```
0x09..0x0A
0x0D
0x20..0x7E
0x00A0..0xD7FF
0xE000..0x10FFFF    

```

在 XHTML 1.0 中……还不清楚。见[http://cmsmcq.com/2007/C1.xml#o127626258](http://cmsmcq.com/2007/C1.xml#o127626258)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T20:58:36.937

如果已知文档是 XHTML，那么您应该只加载它并根据模式对其进行验证。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-10T09:03:14.063

你使用什么编程语言？至少对于 Java，存在检查字符串（或字节数组）编码的库。我猜其他语言也会存在类似的库。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-10T10:55:33.867

我是否正确理解您的问题：您想检查表单提交的数据是否有效且编码正确？

如果是这样，为什么同时做几件事？恕我直言，将这些检查分开并逐步执行它们会容易得多。

1.  您想检查提交的表单数据是否正确编码（我收集的是 UTF-8）。正如大校长 Ridcully 所说，这在大多数语言中都很[容易检查。](http://en.wikipedia.org/wiki/UTF-8#Invalid_byte_sequences)
2.  然后，如果编码正确，您可以检查它是否是有效的表单数据。
3.  然后，如果表单数据有效，您可以检查数据是否包含您期望的内容。

# c# - c# WPF 对 Winform 控件的透明度

> ID：936708
> 
> 赞同：8
> 
> 时间：2009-06-01T20:46:09.537
> 
> 标签：c#, wpf, winforms, controls, transparency

我有一个想要覆盖到 WinForms 应用程序的 WPF 控件。所以我尽职尽责地创建了一个可以显示以下 WPF 对象的元素主机：

```
<UserControl x:Class="LightBoxTest.LightBox"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300" Background="Transparent">
    <Grid Name="dialogHolder" Background="Transparent" Opacity="1">
        <Rectangle Name="rectangle1" Stroke="White" Fill="Black" RadiusX="10" RadiusY="10" Opacity="0.5" />
        <StackPanel Name="stackPanel1" Background="Transparent" Height="300" VerticalAlignment="Top">
            <Rectangle Name="spacer" Opacity="0" Stroke="Gray" Fill="White" RadiusX="10" RadiusY="10" Height="100" Width="300" />
            <Grid Height="100" Name="contentHolder" Width="250">
                <Rectangle Name="dialog" Stroke="Gray" Fill="White" RadiusX="10" RadiusY="10" Height="100" Width="250" />
            </Grid>
        </StackPanel>
    </Grid>
</UserControl> 
```

问题是 WinForm 窗体上的控件不呈现，而 WPF 只是在屏幕上消除它们。

元素主机的创建方式如下：

```
dialogHost = new ElementHost(); 
dialogHost.Child = dialog;
dialogHost.BackColorTransparent = true;
dialogHost.BringToFront();  
dialogHost.Show(); 
```

有什么我应该做而我没有做的吗？

是否存在关于在 Winforms 上显示透明 WPF 控件的已知问题？

任何可能有帮助的文章？

注意：这个问题与[这个问题有关](https://stackoverflow.com/questions/936134/c-winforms-wpf-interop)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T04:39:32.780

我认为你遇到了[空域问题](http://msdn.microsoft.com/en-us/library/aa970688.aspx)。AFAIK，您不能混合 WPF 透明度和 ElementHost 透明度，因为 ElementHost 拥有空域。

链接中有一个关于创建非矩形 hwnd 来托管 WPF 内容的简短说明，这可能会让您走得更远。

也许您可以考虑将更多的 WinForms 应用程序迁移到 WPF？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-17T20:15:01.633

您应该阅读以下内容：[使用 ElementHost 时加载 wpf 控件之前的黑色背景](https://stackoverflow.com/questions/2087406/black-background-before-loading-a-wpf-controll-when-using-elementhost) 只需隐藏和显示它（不酷但有效）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:55:56.677

这似乎是互操作[空域](http://blogs.msdn.com/pantal/archive/2007/07/31/managed-directx-interop-with-wpf-part-2.aspx)问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-01T20:51:57.700

您可能已经尝试过了，但是如何在用户控件上设置不透明度呢？

# winapi - 在 WinMain 中没有消息循环有多可取？

> ID：936710
> 
> 赞同：6
> 
> 时间：2009-06-01T20:46:23.750
> 
> 标签：winapi

这可能是有史以来最简单的win32程序..

```
#include <windows.h>

int WINAPI WinMain(HINSTANCE hInst, HINSTANCE hPrev, LPSTR cmdLine, int show)
{
    MessageBox(0, "Hello world..", "Salutations!", MB_OK);
    return 0;
} 
```

..它不会对通常的 GetMessage() 调用进行任何调用。我的问题是：如果我的程序不处理任何窗口消息，操作系统可以处理吗？即，它会导致内存泄漏吗？或者除非我运行它 16K 次否则不会出现的其他一些资源？

从更广泛的意义上说，Win32 究竟对处理其消息的应用程序有多“依赖”？我希望当编译器将可执行文件作为 Windows 程序链接时，运行时能够清理任何类型的消息队列，无论它是否被清空。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T21:12:40.233

只是技术性问题，但您确实有一个窗口，并且确实有一个消息循环，只是不在您的代码中。

调用`MessageBox()`创建一个窗口（类#32770）并运行一个本地消息循环，直到消息循环退出时才返回到您的代码，大概是什么时候`WM_NCDESTROY`发送的。我认为这是响应`DialogBox()`.

但是你可以用其他任何真正*不会*`MessageBox()`创建消息循环的东西来代替你的调用，你仍然会没事的。Windows 不关心您是否有消息循环，尽管如果没有它，某些功能（主要是与 UI 相关的）很难或无法使用。事实上，你根本不需要链接到 user32，一些没有用户界面的应用程序也不需要。

 *现在，如果您创建一个窗口并且不以*某种*方式为其处理消息，Windows XP 及更高版本会将您的窗口替换为具有白色客户区的“幽灵”窗口，并且任务管理器将告诉用户该应用程序不是回应。

虽然一开始看起来如此，但消息循环并不是魔术，也不是 Windows 样板文件中严格要求的部分。但是，在大多数 Windows 应用程序中，它作为一种根深蒂固的标准*是*根深蒂固的，因为它是处理窗口消息调度的最佳方式。大多数 Windows 应用程序的“事件驱动”性质有时让我们忘记了 Windows 应用程序最初设计为单线程的，在这个模型中，它是在单线程中运行的代码，而不是操作系统中一些看不见的力量，这必须在我们的代码中进行每个函数调用。多线程的添加在一定程度上改变了这一点，但基本模型仍然保持不变。

**编辑**

关于消息队列的说明：

正如在别处提到的，消息队列仅在该线程创建窗口时创建（并且基于每个线程）。您的示例程序在创建消息框时*确实会*创建一个消息队列。但是当您的应用程序退出时，此队列不必为空。这个队列只是一个内存结构。它是一块内存，可以保存一定数量的消息对象（指定目标 hWnd、消息 id、wParam、lParam、消息发布时的系统时间、消息发布时的鼠标位置，以及一些允许派生键盘和消息发布时的鼠标按钮状态），以及指向队列头部和尾部的指针（我假设它是一个循环队列）。当应用程序退出时，这个内存，就像所有属于进程的内存一样，被立即释放。

当然，在您的流程之外，还有其他必须清理的东西。操作系统必须保留所有现有窗口的表格，例如，连同创建它们的线程和进程。当然，这些也会自动清理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T20:49:27.360

由于您没有窗口，因此不需要消息循环。在 Win32 中，消息被发送到窗口，而不是应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T21:12:19.907

您确实有一个消息循环 - MessageBox 是一个模式对话框，因此其中包含一个消息循环。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T21:11:01.017

您不必创建窗口。但是仍然有一些消息，比如

*   WM_TIMER
*   WM_TIMECHANGE
*   WM_CLIPBOARDUPDATE
*   WM_COPYDATA
*   WM_POWER

您可能需要的。所以，挂个*鬼*窗也不错。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T21:28:08.720

如果您没有窗口，那很好，但如果您有，那么您需要确保为它发送消息。否则系统可能会挂起等待您响应的广播消息。这对于像 COM 这样为消息处理创建隐藏窗口的东西很重要。如果您的主线程不泵送消息（例如，通过调用`WaitForSingleObject`），那么对您的 COM 对象的调用将不会被处理，并且任何发送广播的程序都将出现挂起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T21:29:59.230

我在某处读过（但找不到参考资料）是 Windows 将按需创建消息队列。如果您从不调用查找消息队列的函数，则永远不会创建消息队列。这发生在每个线程的基础上。

# .net - 在用户输入新值时确保 treeView 属性唯一性的最有效方法

> ID：936711
> 
> 赞同：1
> 
> 时间：2009-06-01T20:47:05.603
> 
> 标签：.net, winforms, treeview

我正在寻找一种有效的小算法来遍历 .NET treeView 节点列表的文本属性。当用户完成添加新节点并最终点击保存时，我需要检查文本属性（包含用户输入的友好名称）是否仍然是唯一的。
如果 treeView 键恰好是这个数据，生活会很容易，但它不是（它是一个 GUID，但必须让用户输入一个友好的名称）。

有什么比引入一种带有 foreach 循环的新方法来检查每个节点的文本属性中的重复名称更好的想法吗？顺便说一句 - 我已经在当前代码路径中提供了每个单独的节点......我正在遍历列表一次以寻找其他（更简单的）条件来提供反馈。foreach（treeView.Nodes[0].Nodes 中的 TreeNode 节点）{ ... }

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T20:50:56.580

如果用户从头开始构建树，那么如果您将每个名称插入 Hashtable，您可以通过检查 Hashtable 中名称的存在来快速检查重复项。您必须处理更新，但这很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:55:13.420

我不得不这样做一次。我记得，我对 TreeView 及其节点进行了子类化，然后添加了自己的方法来捕获对文本属性的任何更改，这些更改总是会将新值添加到列表中，如果该文本值已经存在，这当然会引发错误。此外，在添加新值之前，必须首先从列表中删除任何旧/上一个 node.text 值。

这对我来说很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:57:21.807

我不知道您的优雅与可维护性比率是多少，但对于这么简单的事情，我会考虑像 Arnshea 提到的哈希表，甚至像 SortedList 这样简单的东西。

# java - Mac OS X 上的 Java System.getProperty("user.dir")

> ID：936714
> 
> 赞同：0
> 
> 时间：2009-06-01T20:47:48.427
> 
> 标签：java, macos, properties, system

我在桌面上的 Mac OS X 10.4 上有一个应用程序包。我的应用程序查找一个名为“resources”的文件夹，其中保存了要显示的文件（保存在与可运行 JAR 相同的位置）。我知道应用程序包中也有一个名为“Resources”的文件夹，如果这令人困惑，很抱歉，但我从未在 Mac 上编程，也不知道这会是同一个名字。

在 Windows 中，当我调用时，`System.getProperty("user.dir")`我会得到可运行 JAR 文件所在的位置。正是我想要的。

为什么当我运行应用程序包时 getProperty 返回“/”？就这样。我希望它会返回类似“/Users/user_name/Desktop”的东西......这是我的应用程序包所在的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:09:34.037

我改为使用系统属性“user.home”而不是“user.dir”。这样我就不必担心 JVM 在哪里寻找。我让应用程序包直接使用 bash 脚本作为 info.plist 文件调用的可执行文件来引用我的 jar 文件。我总是可以将要由应用程序显示的文件放在用户家中，因为该位置将始终返回路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:54:32.953

那是因为“user.dir”表示JVM运行时有效的当前用户目录；在 Windows 中，这通常是 JAR 的位置，除非您另外指定。在 OSX 中很可能没有当前目录的概念，但更有可能它只是具有不同的默认值。

虽然我从未在 OSX 下专门测试过这段代码，但你可以尝试这个来找到加载任何类的目录：

```
static public File getClassLocation(Class cls, boolean trmjar) {
    ClassLoader                         clsldr;                                                     // class loader
    URL                                 urlobj;                                                     // url object
    String                              exturl;                                                     // external form of URL
    String                              lwrurl;                                                     // lowercase external form of URL
    File                                rtnfil;                                                     // return file

    if((clsldr=cls.getClassLoader())==null) { clsldr=ClassLoader.getSystemClassLoader(); }

    if((urlobj=clsldr.getResource(cls.getName().replace('.','/')+".class"))==null) {
        return null;
        }

    exturl=urlobj.toExternalForm();
    lwrurl=exturl.toLowerCase();
    while(lwrurl.startsWith("jar:") || lwrurl.startsWith("file:/")) {
        if(lwrurl.startsWith("jar:")) {
            if(lwrurl.indexOf("!/")!=-1) { exturl=exturl.substring(4,(exturl.indexOf("!/"))); }     // strip encapsulating "jar:" and "!/..." from JAR url
            else                         { exturl=exturl.substring(4                       ); }     // strip encapsulating "jar:"
            }
        if(lwrurl.startsWith("file:/")) {
            exturl=exturl.substring(6);                                                             // strip encapsulating "file:/"
            if(!exturl.startsWith("/")) { exturl=("/"+exturl); }
            while(exturl.length()>1 && exturl.charAt(1)=='/') { exturl=exturl.substring(1); }
            }
        lwrurl=exturl.toLowerCase();
        }
    exturl=java.net.URLDecoder.decode(exturl,"UTF-8");
    rtnfil=new File(exturl);
    if(lwrurl.endsWith(".class") || (trmjar && lwrurl.endsWith(".jar"))) { rtnfil=rtnfil.getParentFile(); }
    if(rtnfil.exists()) { rtnfil=rtnfil.getAbsoluteFile(); }
    return rtnfil;
    } 
```

自 Java 1 以来，它在 Windows 下的所有 Java 版本中都可靠地工作了多年。

# unit-testing - 通过嵌入式服务器测试 Solr

> ID：936723
> 
> 赞同：16
> 
> 时间：2009-06-01T20:50:06.067
> 
> 标签：unit-testing, solr, solrj

我正在为我的 solr-indexer 应用程序编写一些测试。遵循测试最佳实践，我想编写独立的代码，只需加载`schema.xml`并`solrconfig.xml`为索引搜索测试创建一个临时数据树。由于应用程序大部分是用 java 编写的，我正在处理 SolrJ 库，但我遇到了问题（好吧，我迷失在 corecontainers-coredescriptor-coreconfig-solrcore 的世界中......）任何人都可以在这里放置一些用于创建加载配置并写入参数传递数据目录的嵌入式服务器的代码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T23:23:20.017

您可以从扩展 SolrExampleTestBase 的SolrExampleTests[开始](http://svn.apache.org/repos/asf/lucene/solr/tags/release-1.4.1/src/test/org/apache/solr/client/solrj/SolrExampleTestBase.java)[，](http://svn.apache.org/repos/asf/lucene/solr/tags/release-1.4.1/src/test/org/apache/solr/client/solrj/SolrExampleTests.java)后者扩展[AbstractSolrTestCase](http://svn.apache.org/repos/asf/lucene/solr/tags/release-1.4.1/src/java/org/apache/solr/util/AbstractSolrTestCase.java)。

还有这个[SampleTest](http://svn.apache.org/repos/asf/lucene/solr/tags/release-1.4.1/src/test/org/apache/solr/SampleTest.java)。

还要看看[这个](http://lucene.472066.n3.nabble.com/EmbeddedSolrServer-API-usage-td526739.html)和[这个](http://lucene.472066.n3.nabble.com/EmbeddedSolrServer-in-Single-Core-td475238.html)线程。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-05T08:25:46.623

这是一个简单测试用例的示例。solr 是包含您的 solr 配置文件的目录：

```
导入 java.io.IOException；
导入 org.apache.solr.client.solrj.embedded.EmbeddedSolrServer；
导入 org.apache.solr.util.AbstractSolrTestCase；
导入 org.apache.solr.client.solrj.SolrQuery；
导入 org.apache.solr.client.solrj.SolrServer；
导入 org.apache.solr.client.solrj.SolrServerException；
导入 org.apache.solr.client.solrj.response.QueryResponse；
导入 org.apache.solr.common.SolrInputDocument；
导入 org.apache.solr.common.params.SolrParams；
导入 org.junit.Before；
导入 org.junit.Test；

导入静态 org.junit.Assert.assertEquals；

公共类 SolrSearchConfigTest 扩展 AbstractSolrTestCase {

    私有 SolrServer 服务器；

    @覆盖
    公共字符串 getSchemaFile() {
        返回“solr/conf/schema.xml”；
    }

    @覆盖
    公共字符串 getSolrConfigFile() {
        返回“solr/conf/solrconfig.xml”；
    }

    @前
    @覆盖
    公共 void setUp() 抛出异常 {
        super.setUp();
        server = new EmbeddedSolrServer(h.getCoreContainer(), h.getCore().getName());
    }

    @测试
    公共无效 testThatNoResultsAreReturned() 抛出 SolrServerException {
        SolrParams params = new SolrQuery("找不到的文本");
        QueryResponse 响应 = server.query(params);
        assertEquals(0L, response.getResults().getNumFound());
    }

    @测试
    公共无效 testThatDocumentIsFound() 抛出 SolrServerException，IOException {
        SolrInputDocument 文档 = new SolrInputDocument();
        document.addField("id", "1");
        document.addField("姓名", "我的名字");

        server.add(文档);
        server.commit();

        SolrParams 参数 = new SolrQuery("name");
        QueryResponse 响应 = server.query(params);
        assertEquals(1L, response.getResults().getNumFound());
        assertEquals("1", response.getResults().get(0).get("id"));
    }
}

```

有关更多信息，请参阅此博文：[Solr 集成测试](http://blog.synyx.de/2011/01/integration-tests-for-your-solr-config/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-22T10:38:57.203

首先，您需要设置包含 solr.xml 的 Solr 主目录和包含 solrconfig.xml、schema.xml 等的 conf 文件夹。

之后，您可以为 Solrj 使用这个简单而基本的代码。

```
File solrHome = new File("Your/Solr/Home/Dir/");
File configFile = new File(solrHome, "solr.xml");
CoreContainer coreContainer = new CoreContainer(solrHome.toString(), configFile);
SolrServer solrServer = new EmbeddedSolrServer(coreContainer, "Your-Core-Name-in-solr.xml");
SolrQuery query = new SolrQuery("Your Solr Query");
QueryResponse rsp = solrServer.query(query);
SolrDocumentList docs = rsp.getResults();
Iterator<SolrDocument> i = docs.iterator();
while (i.hasNext()) {
      System.out.println(i.next().toString());
} 
```

我希望这有帮助。

# voip - Asterisk Manager API 事件

> ID：936731
> 
> 赞同：1
> 
> 时间：2009-06-01T20:52:48.087
> 
> 标签：voip, asterisk, asteriskami

我正在使用 Elastix 和 Astmanproxy 服务器来运行我们的呼叫中心桌面应用程序。此应用程序收集诸如来电显示、拨打的号码等信息，以帮助我们的代理获取客户信息等。此应用程序会根据某些事件更改其背景颜色（例如代理接听电话时的绿色）。

我使用 AMI 中的 Dial 事件来获取呼叫的唯一 ID（我使用 DestUniqueID 变量来获取此 ID）。之后，我使用该唯一 ID 跟踪所有事件。当我收到带有该 ID 的 Link 事件时，该应用程序的背景变为绿色，表示呼叫中心代理已接听电话。

问题是，即使代理接听了呼叫，有时我也没有获得具有从 Dial 事件的 DestUniqueID 获得的匹配唯一 ID 的 Link 事件。有谁知道为什么会这样？

基本上，有没有一种万无一失的方法来使用星号管理器 api 事件从头到尾跟踪呼叫？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-02T23:57:30.540

当呼叫得到应答时，尝试捕获一个 NewStateEvent。它具有新旧的唯一 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-02T21:52:40.020

是的。如果您监视所有事件，那么您应该能够跟踪包括拨号计划在内的呼叫。

# asp.net-mvc - 对于在 ASP.Net MVC 中执行身份验证的控件的视图，将身份验证设置为 true

> ID：936732
> 
> 赞同：0
> 
> 时间：2009-06-01T20:53:07.870
> 
> 标签：asp.net-mvc, authentication, forms-authentication, views

在身份验证控件中，我有以下行将用户标记为在系统中已通过身份验证（在签出密码后）：

```
FormsAuth.SignIn(userName, rememberMe); 
```

如果我重定向，这是标准行为，一切都很好。但是，如果我立即显示视图，检查用户是否通过身份验证的常用方法：

```
Page.User.Identity.IsAuthenticated
Request.IsAuthenticated 
```

不工作。他们说用户没有经过身份验证。如何使身份验证立即生效，或者是否有其他方法可以检查用户刚刚登录的时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:30:44.033

`FormsAuth.SignIn`是从 Visual Studio 创建新的 ASP.NET MVC 项目时生成的函数。

该函数只调用[FormsAuthentication.SetAuthCookie](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.setauthcookie.aspx)，根据文档，它在**response**中设置身份验证 cookie 。

这解释了为什么如果您重定向它会起作用（因为客户端将在后续请求中播放 cookie），但不是在调用之后立即起作用。

重定向是执行此操作的正确/传统方式，但如果您绝对坚持在重定向之前检查身份验证，那么您可以在会话状态中创建一个 IsAuthenticated 标志并在检查时引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:57:59.480

在您的控制器上，您应该能够使用以下内容来检查它们是否已通过身份验证。

```
User.Identity.IsAuthenticated; 
```

我会检查以确保您的 AccountController 在您从一个页面移动到另一个页面时正确保存了 Principal 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-11T02:19:20.260

除了使用 FormsAuth.Signin 或 FormsAuthentication.SetAuthCookie 之外，您还可以在登录代码执行时在您的登录控件中手动设置 User.Identity。如上所述，原因是因为 FORmsAuth.SignIn 只是将身份验证 cookie 设置为在 Request_OnAuthenticate 事件中下次拾取。（它只是解码 cookie 并设置 HttpContext.User 属性）

# ms-access - 不允许更新记录 - 写冲突

> ID：936735
> 
> 赞同：0
> 
> 时间：2009-06-01T20:54:03.687
> 
> 标签：ms-access, null, default-value, sql-server-2008-express

这源于我之前问过的一个问题 - 关于与表单的写入冲突，但问题似乎源于我可以更新一个系统 DSN 提供的链接表中的现有记录，但不能更新由一个系统 DSN 提供的另一个链接表另一个 DSN（不同的数据库） - 首先允许我输入记录，但随后阻止我对记录进行任何更改，就好像另一个用户在我之前更改了数据一样。服务器上没有为默认值定义检查约束，没有触发器，没有视图，没有其他用户访问同一个表。

两个 DSN 都设置相同，除了它们打开的默认数据库 - 第一个打开 gtdata_test，而第二个打开 instkeeper_test。SQL Server 实例上的两个数据库都归我所有，我是唯一的登录用户。

我已经对此进行了测试，并且此问题发生在手动更新的表级别（程序中没有编写 VBA，什么都没有）。

如果有帮助，我将包含好表的 CREATE 语句，以及它下面的受影响表。我希望有人可以帮助我，因为我刚刚没有想法。

*在 gtdata_test 中创建 Supplier_Master 表的代码*：

```
USE [gtdata_test]
GO

/****** Object:  Table [dbo].[Supplier_Master]    Script Date: 05/27/2009 15:58:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Supplier_Master](
    [Supplier_Code] [nvarchar](50) NOT NULL,
    [Supplier_Master_Name] [nvarchar](50) NULL,
    [Salutation] [nvarchar](50) NULL,
    [Contact] [nvarchar](50) NULL,
    [Phone] [nvarchar](50) NULL,
    [Fax] [nvarchar](50) NULL,
    [EMail] [nvarchar](50) NULL,
    [Address] [nvarchar](50) NULL,
    [City] [nvarchar](50) NULL,
    [State] [nvarchar](50) NULL,
    [Zip] [nvarchar](50) NULL,
    [Country] [nvarchar](50) NULL,
    [Last_Review] [datetime] NULL,
    [Last_Rating] [datetime] NULL,
    [Last_Received] [datetime] NULL,
    [Last_Reject] [datetime] NULL,
    [Enabled] [int] NULL,
    [User1] [nvarchar](50) NULL,
    [User2] [nvarchar](50) NULL,
    [SupType] [nvarchar](50) NULL,
 CONSTRAINT [Supplier_Master$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [Supplier_Code] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Address$disallow_zero_length] CHECK  ((len([Address])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Address$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$City$disallow_zero_length] CHECK  ((len([City])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$City$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Contact$disallow_zero_length] CHECK  ((len([Contact])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Contact$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Country$disallow_zero_length] CHECK  ((len([Country])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Country$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$EMail$disallow_zero_length] CHECK  ((len([EMail])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$EMail$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Fax$disallow_zero_length] CHECK  ((len([Fax])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Fax$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Phone$disallow_zero_length] CHECK  ((len([Phone])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Phone$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Salutation$disallow_zero_length] CHECK  ((len([Salutation])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Salutation$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$State$disallow_zero_length] CHECK  ((len([State])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$State$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Code$disallow_zero_length] CHECK  ((len([Supplier_Code])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Code$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Master_Name$disallow_zero_length] CHECK  ((len([Supplier_Master_Name])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Master_Name$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$SupType$disallow_zero_length] CHECK  ((len([SupType])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$SupType$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$User1$disallow_zero_length] CHECK  ((len([User1])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$User1$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$User2$disallow_zero_length] CHECK  ((len([User2])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$User2$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Zip$disallow_zero_length] CHECK  ((len([Zip])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Zip$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master] ADD  DEFAULT ((0)) FOR [Enabled]
GO 
```

*在 instkeeper_test 中创建 tblSupplierInfo 的代码*：

```
USE [instkeeper_test]
GO

/****** Object:  Table [dbo].[tblSupplierInfo]    Script Date: 05/27/2009 15:57:30 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tblSupplierInfo](
    [strSupplierID] [nvarchar](50) NOT NULL,
    [bolSupAltShipAddyRep] [bit] NULL,
    [bolSupAltShipAddyCal] [bit] NULL,
    [bolSupInsistNet30] [bit] NULL,
    [bolRMARequireRepair] [bit] NULL,
    [bolRMARequireCalibration] [bit] NULL,
    [bolSupShipOrCourier] [bit] NULL,
    [bolSupRequireMSDS] [bit] NULL,
    [bolSupBlanketPO] [bit] NULL,
    [bolSupRequirePricing] [bit] NULL,
    [bolSupBlankPricing] [bit] NULL,
    [bolSupFaxPOSend] [bit] NULL,
    [bolAdditionalPaperworkRepair] [bit] NULL,
    [bolAdditionalPaperworkCalibration] [bit] NULL,
    [strRMARepairWordage] [nvarchar](100) NULL,
    [strRMACalibrationWordage] [nvarchar](100) NULL,
    [intBlanketPO] [int] NULL,
    [bolUseFedExNumber] [bit] NULL,
    [strFedExNumber] [nvarchar](150) NULL,
    [bolUseUPSNumber] [bit] NULL,
    [strUPSNumber] [nvarchar](150) NULL,
    [bolSupA2LAAccredited] [bit] NULL,
    [bolSupFreightAllow] [bit] NULL,
    [bolSupFreightOnly] [bit] NULL,
    [bolSupUseMiscNum] [bit] NULL,
    [strSupMiscFreightNum] [nvarchar](150) NULL,
 CONSTRAINT [tblSupplierInfo$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [strSupplierID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

*在 instkeeper_test 中创建 tblSupplierNote 的代码*：

```
USE [instkeeper_test]
GO

/****** Object:  Table [dbo].[tblSupplierNote]    Script Date: 06/01/2009 12:34:28 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tblSupplierNote](
    [intSupNoteID] [int] IDENTITY(1,1) NOT NULL,
    [strSupplierID] [nvarchar](50) NULL,
    [datDateNoteEntered] [datetime] NULL,
    [datTimeNoteEntered] [datetime] NULL,
    [strNoteBy] [nvarchar](255) NULL,
    [memSupNote] [nvarchar](max) NULL,
 CONSTRAINT [tblSupplierNote$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [intSupNoteID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[tblSupplierNote]  WITH CHECK ADD  CONSTRAINT [tblSupplierNote$tblSupplierInfotblSupplierNote] FOREIGN KEY([strSupplierID])
REFERENCES [dbo].[tblSupplierInfo] ([strSupplierID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[tblSupplierNote] CHECK CONSTRAINT [tblSupplierNote$tblSupplierInfotblSupplierNote]
GO 
```

只是为了概述 - 我使用第一个 DSN 开发的应用程序中的任何表都是可读/可写的，可以毫无问题地创建、删除和更新记录。使用第二个 DSN，我拉入应用程序的任何表都可以写入 ONCE。任何进一步的更改都将丢失，并且每当更新数据表视图中的表中的数据时，就会出现一个写入冲突对话框。

我正在使用的软件：

*   微软访问 2003
*   SQL Server 速成版 2008
*   Windows XP 专业版 SP3

-- 编辑于 06/03/2009 @ 1307 小时 --

我发现在使用 Yes/No 复选框和 SQL Server with Access 时会出现一个奇怪的问题。显然，Access 会将 NULL 解释为否 - 更改值，但 SQL Server 不会将 NULL 解释为位字段中的否（是/否在转换中变成了），因此当值不是时它会引发写入冲突错误必需，并且为 NULL。解决方案是重新设计表格，以便需要一个值，并且为之前的每个“是/否”复选框分配了一个默认值。这解决了神秘的写入冲突消息，并允许在创建记录后对其进行更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-29T16:05:17.257

Access 处理“是/否”复选框值的方式与 SQL Server 之间存在差异。在将是/否布尔值从 Access 转换为 SQL Server 时，您必须记住定义默认状态并将其标记为需要回答。否则，您每次都会遇到写冲突，并且一旦设置了初始值，它将阻止记录与您的更改一起保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T03:05:42.893

您是否尝试过删除表格链接并重新创建它们？对您链接到的表/视图的更改可能会导致它们变为只读，并且除了删除它们并重新创建它们之外，没有其他方法可以更正它。

此外，我使用 DSN 进行链接，然后使用[Doug Steele 的代码将它们转换为无 DNS 连接字符串。](http://www.accessmvp.com/djsteele/DSNLessLinks.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-22T22:49:52.670

当记录包含 NULL 位数据类型列时，我与 SQL Server 的 Access 前端有类似的“写入冲突”，我注意到您的表包含这些列，即使您没有更新这些列。将位数据类型列设置为默认值 0 并将具有 NULL 位数据类型列的现有记录更新为 0 已为我修复。

# c# - 扩展数据上下文类（接口、新属性等）

> ID：936737
> 
> 赞同：2
> 
> 时间：2009-06-01T20:54:29.817
> 
> 标签：c#, sql, linq

如何扩展我的数据上下文对象（由 Linq To Sql 生成），以便我可以将另一个接口附加到它们，添加其他属性等？下次我从数据库重建类时，我不希望它被覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T20:56:09.687

这就是部分类的用途。只需将您的东西添加到一个新的cs文件中，并声明为partial的同名类。

# linq - 如何使用 LINQ 检索子集合

> ID：936739
> 
> 赞同：0
> 
> 时间：2009-06-01T20:54:42.233
> 
> 标签：linq, nhibernate, collections

从这里开始：

```
public class Customer
{
  public int CustomerID { get; set; }
  public string CustomerName { get; set; }  
  public IList<Order> Orders { get; set; }
}

public class Order
{
  public int OrderID { get; set; }
  public int CustomerID { get; set; }
} 
```

您为检索所有客户的所有订单而编写的 linq 查询是什么？

大意是：

```
IList<Order> orders = new List<Order>();
foreach (Customer c in Customers)
{
    orders.Union(c.Orders);
} 
```

我尝试了以下方法，但它引发了“休眠集合不是关联”异常：

```
var orders = from c in Customers
             select c.Orders; 
```

我知道我错过了一些东西，但我找不到在 linq 中实现这一点的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:01:21.957

```
var orders = from c in db.Customers
    from o in c.Orders
    select o; 
```

或者

```
var orders = db.Customers.SelectMany(c => c.Orders); 
```

它会在 linq 中为 nhibernate 工作吗？我不知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T21:43:15.443

确保在数据库中从 [Order].[CustomerID] 到 [Customer].[ID] 正确设置了外键约束。

# database - 数据库触发器的命名约定

> ID：936741
> 
> 赞同：31
> 
> 时间：2009-06-01T20:55:02.467
> 
> 标签：database, triggers

数据库触发器有任何命名约定吗？

例如“在删除用户之前”将是“bdUsers”或类似的东西。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-01T21:06:07.860

出于排序原因，我建议采用结构化方法：

```
TR_Users_AD
TR_Users_BD
TR_OtherTable_AI 
```

等等。

最后，这取决于您 - 但无论您选择做什么，都要保持一致，至少在同一个数据库中。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-01T21:11:08.533

我同意@tomalak - 但我通常在最后拼出动作而不是缩写它......

```
trig_Users_delete
trig_Users_insert
trig_OtherTable_Insert
trig_OtherTable_InsteadOfInsert 
```

# c++ - C++03 中的标识符中是否允许使用美元符号？

> ID：936744
> 
> 赞同：16
> 
> 时间：2009-06-01T20:55:30.703
> 
> 标签：c++, identifier

C++ 标准对在标识符中使用美元符号有何规定，例如`Hello$World`？他们合法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-01T20:59:17.060

c++ 标识符可以由以下任何一种组成：_（下划线）、数字 0-9、字母 az（大写和小写）并且不能以数字开头。

有许多例外，因为 C99 允许对标准进行扩展（例如[Visual Studio](http://msdn.microsoft.com/en-us/library/565w213d.aspx)）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-01T20:56:56.317

他们是非法的。标识符中唯一合法的字符是字母、数字和_。标识符也不能以数字开头。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-17T08:40:12.293

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-01T21:04:28.923

不合法，但如果不是大多数编译器都支持它们，请注意这可能取决于平台，因此 arm 上的 gcc 由于程序集限制不支持它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T12:55:53.953

相关部分是“2.8 标识符 [lex.name]”。从基本字符集中，唯一有效的字符是 AZ az 0-9 和 _。但是，也允许使用像 é (U+00E9) 这样的字符。不过，根据您的编译器，您可能需要将 é 输入为 \u00e9。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T20:59:07.077

它们在 C++ 中是不合法的。然而，一些 C/C++ 派生语言（如 Java 和 JavaScript）确实允许它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T21:00:23.627

非法的。我认为美元符号和反引号是我键盘上唯一没有在 C++ 中使用的标点符号（“%”符号在格式字符串中，通过引用 C 标准在 C++ 中）。

# r - 在 R 中声明一个常量变量

> ID：936748
> 
> 赞同：42
> 
> 时间：2009-06-01T20:56:30.500
> 
> 标签：r, statistics, constants

我在 R 中工作，我想定义一些我（或我的一位合作者）无法更改的变量。在 C++ 中，我会这样做：

```
const std::string path( "/projects/current" ); 
```

我如何在 R 编程语言中做到这一点？

为清楚起见进行编辑：我知道我可以在 R 中定义这样的字符串：

```
path = "/projects/current" 
```

我真正想要的是一种语言构造，它保证没有人可以更改与名为“path”的变量关联的值。

编辑以回应评论：

const 是编译时保证在技术上是正确的，但在我看来，R 解释器会抛出停止执行并显示错误消息是有效的。例如，看看当您尝试将值分配给数字常量时会发生什么：

```
> 7 = 3
Error in 7 = 3 : invalid (do_set) left-hand side to assignment 
```

所以我真正想要的是一种语言特性，它允许你只赋值一次，当你尝试为声明为 const 的变量赋值时应该会出现某种错误。我不在乎错误是否发生在运行时，尤其是在没有编译阶段的情况下。根据维基百科的定义，这在技术上可能不是 const ，但它非常接近。看起来这在 R 编程语言中也是不可能的。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-09-16T15:47:00.240

See `lockBinding`:

```
a <- 1
lockBinding("a", globalenv())
a <- 2
Error: cannot change value of locked binding for 'a' 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-07-22T14:36:30.120

Since you are planning to distribute your code to others, you could (should?) consider to create a package. Create within that package a NAMESPACE. There you can define variables that will have a constant value. At least to the functions that your package uses. Have a look at [Tierney (2003) Name Space Management for R](http://www.r-project.org/doc/Rnews/Rnews_2003-1.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T09:45:33.960

I'm pretty sure that this isn't possible in R. If you're worried about accidentally re-writing the value then the easiest thing to do would be to put all of your constants into a list structure then you know when you're using those values. Something like:

```
my.consts<-list(pi=3.14159,e=2.718,c=3e8) 
```

Then when you need to access them you have an aide memoir to know what not to do and also it pushes them out of your normal namespace.

Another place to ask would be R development mailing list. Hope this helps.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T01:37:14.160

（为新想法编辑：）这些[`bindenv`](http://stat.ethz.ch/R-manual/R-devel/library/base/html/bindenv.html)功能提供了一个

> 用于调整环境和环境内绑定的实验界面。它们允许锁定环境以及单独的绑定，以及将变量链接到函数。

这似乎是一种可能给人一种错误的安全感的东西（比如`const`指向非`const`变量的指针），但它可能会有所帮助。

(Edited for focus:) `const` is a [compile-time guarantee](http://en.wikipedia.org/wiki/Const_correctness), not a lock-down on bits in memory. Since R doesn't have a compile phase where it looks at all the code at once (it is built for interactive use), there's no way to check that future instructions won't violate any guarantee. If there's a right way to do this, the folks at the [R-help](https://stat.ethz.ch/mailman/listinfo/r-help) list will know. My suggested workaround: fake your own compilation. Write a script to preprocess your R code that will manually substitute the corresponding literal for each appearance of your "constant" variables.

(Original:) What benefit are you hoping to get from having a variable that acts like a C "const"?

Since R has exclusively [call-by-value semantics](http://cran.r-project.org/doc/manuals/R-lang.html#Argument-evaluation) (unless you do some munging with environments), there isn't any reason to worry about clobbering your variables by calling functions on them. Adopting some sort of naming conventions or using some OOP structure is probably the right solution if you're worried about you and your collaborators accidentally using variables with the same names.

The feature you're looking for may exist, but I doubt it given the origin of R as a interactive environment where you'd want to be able to undo your actions.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-22T06:39:40.903

R doesn't have a language constant feature. The list idea above is good; I personally use a naming convention like ALL_CAPS.

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-06-01T21:04:47.207

我从[这个网站上得到了下面的答案](http://www.stat.auckland.ac.nz/~paul/ItDT/HTML/node63.html)

最简单的 R 表达式只是一个常量值，通常是数值（数字）或字符值（一段文本）。例如，如果我们需要指定对应于 10 分钟的秒数，我们指定一个数字。

```
> 600
[1] 600 
```

如果我们需要指定要从中读取数据的文件的名称，我们将名称指定为字符值。字符值必须用双引号或单引号括起来。

```
> "http://www.census.gov/ipc/www/popclockworld.html"
[1] "http://www.census.gov/ipc/www/popclockworld.html" 
```

# gps - 如何从 GPS 设备获取 NMEA？

> ID：936750
> 
> 赞同：1
> 
> 时间：2009-06-01T20:56:41.043
> 
> 标签：gps, nmea

我正在尝试使用诺基亚的 N95 读取 GPS 设备的当前位置。我读到我需要我的设备将 NMEA 线路返回到串行端口，然后我将解析/拆分它以获得我想要的东西，但一直以来我不知道要向串行端口写入什么以使设备返回 NMEA？

就像还有其他用于消息传递等的 AT 命令......是否有任何特定命令要发送到串行端口以获取 NMEA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:54:29.197

我发现这个站点[似乎](http://www.simplehelp.net/2008/10/22/how-to-share-the-gps-in-your-n95-with-your-laptop-via-bluetooth-in-linux/)可以指导您完成您需要做的所有事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T21:13:38.403

我不确定它在 N95 中是如何工作的，但在我的 HTC 手机中，您无法向 GPS 设备发送命令以使其以某种方式运行。一旦我连接到 GPS 设备使用的串行端口，我就可以读取来自它的数据流，这恰好是 NMEA 数据。我发现没有办法向设备发送命令来告诉它如何表现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T09:32:23.113

在 Java ME 中执行此操作的一个好方法是使用[JSR 179：Location API](http://jcp.org/en/jsr/detail?id=179)。您的应用需要创建 LocationListener 的实现，然后将其设置在默认的 LocationProvider 上。当你的监听器的 locationUpdated 方法被调用时，调用：

```
location.getExtraInfo("application/X-jsr179-location-nmea"); 
```

这将提供对 NMEA 语句的访问。

您可以使用 Java ME commports 机制通过串行端口发送它（使用：

```
System.getProperty("microedition.commports"); 
```

[如此处](http://developers.sun.com/mobility/midp/questions/properties/)所述）。

希望这可以帮助，

时髦的兄弟

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T21:30:52.643

我从来没有专门使用过 N95，但大多数 GPS 设备一通电就会开始吐出 NMEA，不管它们是否有锁。我不知道 N95 是如何设计的，但我敢打赌，它可能不是为了让您从 GPS 访问原始 NMEA 数据而设计的。你可能需要一些非常花哨的技巧来让它做到这一点。

如果您不需要使用 N95，您可能会发现只获取 GPS 模块并使用它会更容易。我一直从 SparkFun 购买我的。他们有一些很好的[评估板](http://www.sparkfun.com/commerce/categories.php?c=86)和[教程](http://www.sparkfun.com/commerce/tutorial_info.php?tutorials_id=68)来帮助您入门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T21:10:51.123

我以前没有使用过那个特定的 GPS 设备，但对于我来说，我只需要打开端口并立即开始接收 NMEA 数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T21:15:54.313

我有一个 N82，据我所知，它不直接说 NMEA。我使用[此页面](http://gagravarr.org/code/)中的脚本——特别是标题为“#将带有内置 GPS（例如你的 N95）的 S60 手机变成蓝牙 GPS”的脚本——来获取 NMEA 字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T21:20:47.300

Ahh oki 所以我需要运行一些脚本。Oki 我想我应该为它购买一个特定的 GPS 设备。

哪种设备可以以最便宜的方式完成我的工作？

# java - JVM 外的 Java 崩溃 - 适用于 Windows 而不是 Linux

> ID：936751
> 
> 赞同：3
> 
> 时间：2009-06-01T20:56:41.137
> 
> 标签：java, windows, linux, jvm, crash

我在 Linux (CentOS 5.3,Java 1.6.0_13) 上使用 OpenNLP 和我的英文 NameFinder 一直给我这个错误：

```
An unexpected error has been detected by Java Runtime Environment:

SIGSEGV (0xb) at pc=0x0657e436, pid=3484, tid=2291964816

Java VM: Java HotSpot(TM) Server VM (11.3-b02 mixed mode linux-x86)
Problematic frame:
V  [libjvm.so+0x57e436]

An error report file with more information is saved as:
/home/continuum/workspace/entity-extraction-data-service/hs_err_pid3484.log

If you would like to submit a bug report, please visit:
  http://java.sun.com/webapps/bugreport/crash.jsp
The crash happened outside the Java Virtual Machine in native code.
See problematic frame for where to report the bug. 
```

但是，在 Windows 上它可以正常工作。我在想也许字符编码问题可能是我的问题，但是我想看看其他人是否对此有任何想法或以前遇到过。谢谢。

* * *

更新：其他 Java 应用程序运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T21:13:54.537

[由于libgcj7-jar](http://linux.about.com/cs/linux101/g/libgcj.htm)（使用[GCJ，Gnu Compiler for Java）](http://gcc.gnu.org/java/)的问题[已报告](http://www.mail-archive.com/debian-gcc@lists.debian.org/msg23212.html)了类似的错误，因此更新[此包](http://packages.debian.org/fr/etch-m68k/libgcj7-jar)可能会有所帮助。或者使用 sun jvm 执行它。

```
[..]
[Loaded java.lang.Class from /usr/share/java/libgcj-4.1.jar] 
```

> 该错误独立于任何文件且可重现地发生（删除 libgcj7-jar 会使错误消失，重新安装会使错误再次出现）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T21:15:35.250

这看起来是 Cent OS 和 Java 1.6 的问题（我们也在使用 Sun JVM）。以下测试已完成并全部通过，只有 1.6 的 Cent 是失败的：

*   Fedora Core 5.0 和 Java 1.5 并使用 1.5 作为编译目标。
*   Fedora Core 5.0 和 Java 1.6.0_14
*   使用 Java 1.5.0_10 的 Cent OS 5.3

日志文件： -------------- 线程 ---------------

```
Current thread (0x09059800):  JavaThread "CompilerThread1" daemon [_thread_in_native, id=3497, stack(0x88949000,0x889ca000)]

siginfo:si_signo=SIGSEGV: si_errno=0, si_code=1 (SEGV_MAPERR), si_addr=0x00000000

Registers:
EAX=0x00000000, EBX=0x093134f8, ECX=0x09284b3c, EDX=0x09135c4c
ESP=0x889c6f20, EBP=0x889c6f88, ESI=0x000002c9, EDI=0x09135c4c
EIP=0x0657e436, CR2=0x00000000, EFLAGS=0x00210202

Top of Stack: (sp=0x889c6f20)
0x889c6f20:   00000000 092eae50 09284c44 064f7e96
0x889c6f30:   092eaed8 000004ea 092eaf28 092eaf28
0x889c6f40:   00000002 092eaf28 889c85b4 00000001
0x889c6f50:   092eae50 092eaed8 889c6fb8 06533423
0x889c6f60:   092eaed8 09135c4c 00000001 0915de10
0x889c6f70:   09283938 000004eb 889c73a0 091e3f90
0x889c6f80:   889c7390 00000004 889c7058 0657fc72
0x889c6f90:   889c7390 09284b3c 091e21b0 09283968

Instructions: (pc=0x0657e436)
0x0657e426:   00 00 8b 43 08 8b 04 b0 89 c3 83 e3 fe 8b 43 04
0x0657e436:   8b 00 85 c0 0f 84 6d 06 00 00 8b 55 f0 8d 7b 01

Stack: [0x88949000,0x889ca000],  sp=0x889c6f20,  free space=503k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
V  [libjvm.so+0x57e436]
V  [libjvm.so+0x57fc72]
V  [libjvm.so+0x4b4739]
V  [libjvm.so+0x4b5664]
V  [libjvm.so+0x4ae25f]
V  [libjvm.so+0x2aafaa]
V  [libjvm.so+0x2a8493]
V  [libjvm.so+0x2503a9]
V  [libjvm.so+0x2afa0a]
V  [libjvm.so+0x2af416]
V  [libjvm.so+0x5cde5d]
V  [libjvm.so+0x506929]
C  [libpthread.so.0+0x549b]

Current CompileTask:
C2: 90      opennlp.tools.sentdetect.DefaultSDContextGenerator.previousSpaceIndex(Ljava/lang/CharSequence;I)I (53 bytes)

Java Threads: ( => current thread )
  0x88801000 JavaThread "Low Memory Detector" daemon [_thread_blocked, id=3498, stack(0x887af000,0x88800000)]
=>0x09059800 JavaThread "CompilerThread1" daemon [_thread_in_native, id=3497, stack(0x88949000,0x889ca000)]
  0x09057400 JavaThread "CompilerThread0" daemon [_thread_in_native, id=3496, stack(0x889ca000,0x88a4b000)]
  0x09055c00 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=3495, stack(0x88a4b000,0x88a9c000)]
  0x09045800 JavaThread "Finalizer" daemon [_thread_blocked, id=3494, stack(0x88c9c000,0x88ced000)]
  0x09041000 JavaThread "Reference Handler" daemon [_thread_blocked, id=3493, stack(0x88ced000,0x88d3e000)]
  0x08f99800 JavaThread "main" [_thread_in_Java, id=3487, stack(0xb7f5b000,0xb7fac000)]

Other Threads:
  0x0903d800 VMThread [stack: 0x88d3e000,0x88dbf000] [id=3492]
  0x88802c00 WatcherThread [stack: 0x8872e000,0x887af000] [id=3499]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 PSYoungGen      total 61568K, used 26339K [0xb07b0000, 0xb4d90000, 0xb4e20000)
  eden space 52288K, 49% used [0xb07b0000,0xb2110058,0xb3ac0000)
  from space 9280K, 3% used [0xb3ac0000,0xb3b18e30,0xb43d0000)
  to   space 8832K, 0% used [0xb44f0000,0xb44f0000,0xb4d90000)
 PSOldGen        total 36096K, used 23539K [0x8d420000, 0x8f760000, 0xb07b0000)
  object space 36096K, 65% used [0x8d420000,0x8eb1cce8,0x8f760000)
 PSPermGen       total 26880K, used 26786K [0x89420000, 0x8ae60000, 0x8d420000)
  object space 26880K, 99% used [0x89420000,0x8ae489b8,0x8ae60000)

Dynamic libraries:
00ace000-00ae8000 r-xp 00000000 fd:00 8028192    /lib/ld-2.5.so
00ae8000-00ae9000 r-xp 00019000 fd:00 8028192    /lib/ld-2.5.so
00ae9000-00aea000 rwxp 0001a000 fd:00 8028192    /lib/ld-2.5.so
00af1000-00c2f000 r-xp 00000000 fd:00 8028193    /lib/libc-2.5.so
00c2f000-00c31000 r-xp 0013e000 fd:00 8028193    /lib/libc-2.5.so
00c31000-00c32000 rwxp 00140000 fd:00 8028193    /lib/libc-2.5.so
00c32000-00c35000 rwxp 00c32000 00:00 0
00c37000-00c39000 r-xp 00000000 fd:00 8028200    /lib/libdl-2.5.so
00c39000-00c3a000 r-xp 00001000 fd:00 8028200    /lib/libdl-2.5.so
00c3a000-00c3b000 rwxp 00002000 fd:00 8028200    /lib/libdl-2.5.so
00c3d000-00c62000 r-xp 00000000 fd:00 8028197    /lib/libm-2.5.so
00c62000-00c63000 r-xp 00024000 fd:00 8028197    /lib/libm-2.5.so
00c63000-00c64000 rwxp 00025000 fd:00 8028197    /lib/libm-2.5.so
00c66000-00c79000 r-xp 00000000 fd:00 8028195    /lib/libpthread-2.5.so
00c79000-00c7a000 r-xp 00012000 fd:00 8028195    /lib/libpthread-2.5.so
00c7a000-00c7b000 rwxp 00013000 fd:00 8028195    /lib/libpthread-2.5.so
00c7b000-00c7d000 rwxp 00c7b000 00:00 0
00ce1000-00ce8000 r-xp 00000000 fd:00 8028196    /lib/librt-2.5.so
00ce8000-00ce9000 r-xp 00006000 fd:00 8028196    /lib/librt-2.5.so
00ce9000-00cea000 rwxp 00007000 fd:00 8028196    /lib/librt-2.5.so
00d01000-00d14000 r-xp 00000000 fd:00 8028198    /lib/libnsl-2.5.so
00d14000-00d15000 r-xp 00012000 fd:00 8028198    /lib/libnsl-2.5.so
00d15000-00d16000 rwxp 00013000 fd:00 8028198    /lib/libnsl-2.5.so
00d16000-00d18000 rwxp 00d16000 00:00 0
06000000-06676000 r-xp 00000000 fd:00 4325406    /opt/jdk1.6.0_13/jre/lib/i386/server/libjvm.so
06676000-066bb000 rwxp 00675000 fd:00 4325406    /opt/jdk1.6.0_13/jre/lib/i386/server/libjvm.so
066bb000-06add000 rwxp 066bb000 00:00 0
08048000-08052000 r-xp 00000000 fd:00 4325380    /opt/jdk1.6.0_13/jre/bin/java
08052000-08053000 rwxp 00009000 fd:00 4325380    /opt/jdk1.6.0_13/jre/bin/java
08f94000-093a6000 rwxp 08f94000 00:00 0          [heap]
88200000-88362000 rwxp 88200000 00:00 0
88362000-88400000 --xp 88362000 00:00 0
88400000-88600000 rwxp 88400000 00:00 0
88600000-886ff000 rwxp 88600000 00:00 0
886ff000-88700000 --xp 886ff000 00:00 0
8872e000-8872f000 --xp 8872e000 00:00 0
8872f000-887af000 rwxp 8872f000 00:00 0
887af000-887b2000 --xp 887af000 00:00 0
887b2000-888f9000 rwxp 887b2000 00:00 0
888f9000-88900000 --xp 888f9000 00:00 0
8891d000-8891f000 r-xs 00008000 03:41 13124498   /mnt/IDE500GB/.m2/repository/classworlds/classworlds/1.1-alpha-2/classworlds-1.1-alpha-2.jar
8891f000-88922000 r-xs 0001b000 03:41 13123633   /mnt/IDE500GB/.m2/repository/junit/junit/3.8.1/junit-3.8.1.jar
88922000-88929000 r-xs 00029000 03:41 13140905   /mnt/IDE500GB/.m2/repository/org/codehaus/plexus/plexus-container-default/1.0-alpha-8/plexus-container-default-1.0-alpha-8.jar
88929000-8892c000 r-xs 00020000 03:41 13140959   /mnt/IDE500GB/.m2/repository/org/codehaus/plexus/plexus-archiver/1.0-alpha-7/plexus-archiver-1.0-alpha-7.jar
8892c000-88930000 r-xs 0002f000 03:41 13123831   /mnt/IDE500GB/.m2/repository/commons-lang/commons-lang/2.1/commons-lang-2.1.jar
88930000-88932000 r-xs 0000b000 03:41 13140291   /mnt/IDE500GB/.m2/repository/org/apache/maven/surefire/surefire-api/2.3/surefire-api-2.3.jar
88932000-88936000 r-xs 0002f000 03:41 13123831   /mnt/IDE500GB/.m2/repository/commons-lang/commons-lang/2.1/commons-lang-2.1.jar
88936000-8893c000 r-xs 0004c000 03:41 13124627   /mnt/IDE500GB/.m2/repository/opennlp-tools/opennlp-tools/1.4.3/opennlp-tools-1.4.3.jar
8893c000-88944000 r-xs 00051000 03:41 13124641   /mnt/IDE500GB/.m2/repository/trove/trove/1.0/trove-1.0.jar
88944000-88949000 r-xs 00025000 03:41 13124642   /mnt/IDE500GB/.m2/repository/jwnl/jwnl/1.3.3/jwnl-1.3.3.jar
88949000-8894c000 --xp 88949000 00:00 0
8894c000-889ca000 rwxp 8894c000 00:00 0
889ca000-889cd000 --xp 889ca000 00:00 0
889cd000-88a4b000 rwxp 889cd000 00:00 0
88a4b000-88a4e000 --xp 88a4b000 00:00 0
88a4e000-88a9c000 rwxp 88a4e000 00:00 0
88a9c000-88c9c000 r-xp 00000000 fd:00 3807014    /usr/lib/locale/locale-archive
88c9c000-88c9f000 --xp 88c9c000 00:00 0
88c9f000-88ced000 rwxp 88c9f000 00:00 0
88ced000-88cf0000 --xp 88ced000 00:00 0
88cf0000-88d3e000 rwxp 88cf0000 00:00 0
88d3e000-88d3f000 --xp 88d3e000 00:00 0
88d3f000-88df2000 rwxp 88d3f000 00:00 0
88df2000-88f84000 r-xs 02f34000 fd:00 4325511    /opt/jdk1.6.0_13/jre/lib/rt.jar
88f84000-88f85000 --xp 88f84000 00:00 0
88f85000-89005000 rwxp 88f85000 00:00 0
89005000-89006000 --xp 89005000 00:00 0
89006000-89086000 rwxp 89006000 00:00 0
89086000-89087000 --xp 89086000 00:00 0
89087000-89107000 rwxp 89087000 00:00 0
89107000-89108000 --xp 89107000 00:00 0
89108000-89196000 rwxp 89108000 00:00 0
89196000-891a8000 rwxp 89196000 00:00 0
891a8000-891ba000 rwxp 891a8000 00:00 0
891ba000-892c2000 rwxp 891ba000 00:00 0
892c2000-892d0000 rwxp 892c2000 00:00 0
892d0000-892e2000 rwxp 892d0000 00:00 0
892e2000-892f4000 rwxp 892e2000 00:00 0
892f4000-893fb000 rwxp 892f4000 00:00 0
893fb000-8941f000 rwxp 893fb000 00:00 0
8941f000-8ae60000 rwxp 8941f000 00:00 0
8ae60000-8d420000 rwxp 8ae60000 00:00 0
8d420000-8f760000 rwxp 8d420000 00:00 0
8f760000-b07b0000 rwxp 8f760000 00:00 0
b07b0000-b4d90000 rwxp b07b0000 00:00 0
b4d90000-b4e20000 rwxp b4d90000 00:00 0
b4e20000-b4e23000 r-xs 00027000 03:41 13141073   /mnt/IDE500GB/.m2/repository/org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar
b4e23000-b4e26000 r-xs 0001b000 03:41 13123633   /mnt/IDE500GB/.m2/repository/junit/junit/3.8.1/junit-3.8.1.jar
b4e26000-b4e2d000 r-xs 00051000 03:41 13123679   /mnt/IDE500GB/.m2/repository/log4j/log4j/1.2.12/log4j-1.2.12.jar
b4e2d000-b4e36000 rwxp b4e2d000 00:00 0
b4e36000-b4eed000 rwxp b4e36000 00:00 0
b4eed000-b512d000 rwxp b4eed000 00:00 0
b512d000-b7eed000 rwxp b512d000 00:00 0
b7eed000-b7efc000 r-xp 00000000 fd:00 4325422    /opt/jdk1.6.0_13/jre/lib/i386/libzip.so
b7efc000-b7efe000 rwxp 0000e000 fd:00 4325422    /opt/jdk1.6.0_13/jre/lib/i386/libzip.so
b7efe000-b7f21000 r-xp 00000000 fd:00 4325418    /opt/jdk1.6.0_13/jre/lib/i386/libjava.so
b7f21000-b7f23000 rwxp 00023000 fd:00 4325418    /opt/jdk1.6.0_13/jre/lib/i386/libjava.so
b7f23000-b7f2e000 r-xp 00000000 fd:00 4325417    /opt/jdk1.6.0_13/jre/lib/i386/libverify.so
b7f2e000-b7f2f000 rwxp 0000b000 fd:00 4325417    /opt/jdk1.6.0_13/jre/lib/i386/libverify.so
b7f2f000-b7f37000 rwxs 00000000 fd:00 3768337    /tmp/hsperfdata_continuum/3484
b7f37000-b7f3c000 r-xp 00000000 fd:00 3833971    /lib/libnss_winbind.so.2
b7f3c000-b7f3d000 rwxp 00004000 fd:00 3833971    /lib/libnss_winbind.so.2
b7f3d000-b7f42000 rwxp b7f3d000 00:00 0
b7f42000-b7f4b000 r-xp 00000000 fd:00 3833884    /lib/libnss_files-2.5.so
b7f4b000-b7f4c000 r-xp 00008000 fd:00 3833884    /lib/libnss_files-2.5.so
b7f4c000-b7f4d000 rwxp 00009000 fd:00 3833884    /lib/libnss_files-2.5.so
b7f4d000-b7f4f000 r-xs 0000e000 03:41 13124640   /mnt/IDE500GB/.m2/repository/maxent/maxent/2.5.2/maxent-2.5.2.jar
b7f4f000-b7f51000 r-xs 0000d000 03:41 13124599   /mnt/IDE500GB/.m2/repository/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar
b7f51000-b7f54000 r-xs 00027000 03:41 13141073   /mnt/IDE500GB/.m2/repository/org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar
b7f54000-b7f5a000 r-xp 00000000 fd:00 4325404    /opt/jdk1.6.0_13/jre/lib/i386/native_threads/libhpi.so
b7f5a000-b7f5b000 rwxp 00006000 fd:00 4325404    /opt/jdk1.6.0_13/jre/lib/i386/native_threads/libhpi.so
b7f5b000-b7f5e000 --xp b7f5b000 00:00 0
b7f5e000-b7fae000 rwxp b7f5e000 00:00 0
b7fae000-b7fb5000 r-xp 00000000 fd:00 4325420    /opt/jdk1.6.0_13/jre/lib/i386/jli/libjli.so
b7fb5000-b7fb7000 rwxp 00006000 fd:00 4325420    /opt/jdk1.6.0_13/jre/lib/i386/jli/libjli.so
b7fb7000-b7fb8000 r-xs 00002000 03:41 13140264   /mnt/IDE500GB/.m2/repository/org/apache/maven/surefire/surefire-junit/2.3/surefire-junit-2.3.jar
b7fb8000-b7fba000 r-xs 0000b000 03:41 13140291   /mnt/IDE500GB/.m2/repository/org/apache/maven/surefire/surefire-api/2.3/surefire-api-2.3.jar
b7fba000-b7fbc000 r-xs 00006000 03:41 13140272   /mnt/IDE500GB/.m2/repository/org/apache/maven/surefire/surefire-booter/2.3/surefire-booter-2.3.jar
b7fbc000-b7fbd000 rwxp b7fbc000 00:00 0
b7fbd000-b7fbe000 r-xp b7fbd000 00:00 0
b7fbe000-b7fbf000 rwxp b7fbe000 00:00 0
b7fbf000-b7fc0000 r-xp b7fbf000 00:00 0          [vdso]
bf98b000-bf9a0000 rwxp bffea000 00:00 0          [stack]

VM Arguments:
java_command: org.apache.maven.surefire.booter.SurefireBooter /tmp/surefire5688667027445730448tmp /tmp/surefire7222887966087241055tmp
Launcher Type: SUN_STANDARD

Environment Variables:
JAVA_HOME=/opt/jdk1.6.0_13
PATH=/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/opt/jdk1.6.0_13/bin:/usr/local/apache-maven-2.0.8/bin:/home/continuum/bin
LD_LIBRARY_PATH=/opt/jdk1.6.0_13/jre/lib/i386/server:/opt/jdk1.6.0_13/jre/lib/i386:/opt/jdk1.6.0_13/jre/../lib/i386
SHELL=/bin/bash

Signal Handlers:
SIGSEGV: [libjvm.so+0x6071f0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGBUS: [libjvm.so+0x6071f0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGFPE: [libjvm.so+0x5048b0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGPIPE: [libjvm.so+0x5048b0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGXFSZ: [libjvm.so+0x5048b0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGILL: [libjvm.so+0x5048b0], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGUSR1: SIG_DFL, sa_mask[0]=0x00000000, sa_flags=0x00000000
SIGUSR2: [libjvm.so+0x506d80], sa_mask[0]=0x00000004, sa_flags=0x10000004
SIGHUP: [libjvm.so+0x506b20], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGINT: [libjvm.so+0x506b20], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGTERM: [libjvm.so+0x506b20], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004
SIGQUIT: [libjvm.so+0x506b20], sa_mask[0]=0x7ffbfeff, sa_flags=0x10000004

---------------  S Y S T E M  ---------------

OS:CentOS release 5.3 (Final)

uname:Linux 2.6.18-128.1.6.el5 #1 SMP Wed Apr 1 09:19:18 EDT 2009 i686
libc:glibc 2.5 NPTL 2.5
rlimit: STACK 10240k, CORE 0k, NPROC infinity, NOFILE 1024, AS infinity
load average:0.51 0.29 0.16

CPU:total 4 (1 cores per cpu, 2 threads per core) family 15 model 2 stepping 7, cmov, cx8, fxsr, mmx, sse, sse2, ht

Memory: 4k page, physical 2595696k(2026808k free), swap 4653048k(4653048k free)

vm_info: Java HotSpot(TM) Server VM (11.3-b02) for linux-x86 JRE (1.6.0_13-b03), built on Mar  9 2009 01:16:42 by "java_re" with gcc 3.2.1-7a (J2SE release)

time: Mon Jun  1 16:45:05 2009
elapsed time: 13 seconds

Update: Corv1nus is AAltemus, just registered. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T21:17:22.187

听起来像。

*   您在不受支持的操作系统上运行 JVM。
*   JVM 中的错误（您的其他程序可能不会触发错误）
*   您正在使用的库中的错误正在破坏您的 JVM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T22:40:21.133

Corv1nus 中的转储是否回答了与错误相关的问题？

如果是这样，我们有一个类似的错误，来自 CompilerThread 的段错误。在我们的例子中，一个库要么是用 1.4 编译器编译的，要么是针对 1.4 JVM 的（记不太清了）。此生成的字节码似乎触发了 1.6 Hotspot JIT 编译器中的错误。我们通过使用最新的 1.6 编译器重新编译库解决了这个问题。这会生成不同的字节码，但不会触发错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T15:08:15.953

最终判决是 Cent 上的 Java 安装已损坏。在其他 Cent 服务器和 Fedora 服务器上进行测试很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T16:24:45.340

这里有点死灵法，但我收到了完全相同的错误。相同的 JVM 版本，它试图编译的同一行代码（疯狂的“巧合”是吗？）。不同的发行版，但仍然是 linux。

这似乎是 1.6.0_17 附带的 HotSpot 编译器中的一个错误。

好消息是更新 18 声称可以解决该问题（尚未推出）：

[http://java.sun.com/javase/6/webnotes/6u18.html](http://java.sun.com/javase/6/webnotes/6u18.html)

记录的错误是针对“在编译涉及循环 CharSequence 的方法期间的 SIGSEGV”：

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6855164](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6855164)

有趣的是，这正是 OpenNLP 的方法正在做的，剪切和粘贴：

```
private static final int previousSpaceIndex(CharSequence sb, int seek) {
  seek--;
  while (seek > 0) {
    if (sb.charAt(seek) == ' ') {
      while (seek > 0 && sb.charAt(seek - 1) == ' ')
        seek--;
      return seek;
    }
    seek--;
  }
  return 0;
} 
```

# ruby-on-rails - 绕过与机械师的验证

> ID：936764
> 
> 赞同：1
> 
> 时间：2009-06-01T20:59:54.393
> 
> 标签：ruby-on-rails, ruby, rspec

我正在我的模型事物上编写规范，该模型事物的日期字段应该在创建日期之后，因此我使用*validate_timeliness*插件

```
validate_date :date, :after Time.now 
```

我希望能够添加一些日期较早的东西，但验证失败。我想在使用*机械师*工厂创建一些东西时绕过验证。

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T06:01:46.507

您的验证不应该确保日期在 created_at 属性之后吗？而不是Time.now？？？

您不应该尝试在测试中使用无效数据，您可能应该做的是捏造当时创建的数据。

```
@thing = Thing.make(:created_at => 1.day.ago) 
```

尝试在您的规范中过去的唯一原因肯定应该是测试验证确实有效..

```
@thing = Thing.make_unsaved(:date => 1.day.ago)
@thing.should have(1).error_on(:date) 
```

你有这样做的理由吗？你想测试什么？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T23:03:30.570

如果您使用布尔参数 =true 调用 your_obj.save ，例如：`some_obj.save!(true)`，则将跳过所有验证。这可能是我公司广泛使用的未记录的 ActiveRecord 功能 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T05:01:05.343

嗯，没有直接的方法来处理机械师本身。但是您可以尝试欺骗它……在 spec/spec_helper 中，在加载 Machinist 蓝图之前重新定义 Thing 模型。

```
class Thing

def before_validation
  self.date = 1.hour.from_now
end

end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-20T18:29:35.867

您可以捕获验证引发的异常。如果您在需要机械师之后在您的 spec_helper 中需要以下代码。要使用它，您可以添加一个 false 作为#make 的第一个参数。

```
module Machinist
  module ActiveRecordExtensions
    module ClassMethods
      def make_with_skip_validation(*args, &block)
        validate = !(!args.pop if ( (args.first == true) || (args.first == false) ))
        begin
          make_without_skip_validation(*args, &block)
        rescue ActiveRecord::RecordInvalid => invalid
          if validate
            raise invalid
          else
            invalid.record.save(false)
          end
        end  
      end

      alias_method_chain :make, :skip_validation
    end
  end
end 
```

# javascript - 将js对象作为json传递给jquery？

> ID：936767
> 
> 赞同：13
> 
> 时间：2009-06-01T21:00:24.563
> 
> 标签：javascript, jquery, ajax, json, object

我有以下但它不工作，我在stackoverflow的某个地方读到它像这样工作但我似乎无法让它工作..它错误......我做错了什么吗？

如果我确实传递这样的数据 - 它可以工作 - 所以我知道我的服务正在工作

```
//THIS WORKS
data: "{one : 'test',two: 'test2' }"

// BUT SETTING UP OBJECT doesn't work..

var saveData = {};
saveData.one = "test";
saveData.two = "tes2";

$.ajax({
    type: "POST",
    url: "MyService.aspx/GetDate",
    data: saveData,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        alert(msg.d);
    },
    error: function(msg) {
    alert('error');
    }

}); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-01T21:06:08.123

我相信代码会在您的对象上调用 .value 或 .toString() ，然后通过网络传递。你想传递 JSON。

所以，包括 json javascript 库

[http://www.json.org/js.html](http://www.json.org/js.html)

然后通过...

```
 var saveData = {};
    saveData.one = "test";
    saveData.two = "tes2";

    $.ajax({
        type: "POST",
        url: "MyService.aspx/GetDate",
        data: JSON.stringify(saveData),      // NOTE CHANGE HERE
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(msg) {
            alert(msg.d);
        },
        error: function(msg) {
        alert('error');
        }

    }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-01T21:13:29.420

根据[this blog post](http://encosia.com/2008/06/05/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/ "在 ASP.NET Ajax 中使用 jQuery 时要避免的 3 个错误")，当您尝试传递对象时它不起作用的原因是jQuery试图序列化它。从帖子：

> jQuery 不会将该 JSON 对象传递给 Web 服务，而是自动序列化并将其发送为：
> 
> > ```
> > fname=dave&lname=ward 
> > ```
> > 
> > 对此，服务器将响应：
> > 
> > ```
> > Invalid JSON primitive: fname. 
> > ```
> 
> 这显然不是我们想要发生的。解决方案是确保您向 jQuery 传递数据参数的字符串 [...]

这就是您在有效示例中所做的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T22:43:47.350

我的建议是使用[jquery-json 插件](http://code.google.com/p/jquery-json/)，然后您可以在代码中执行此操作：

```
...
data: $.toJSON(saveData),
... 
```

# nhibernate - 使用 nHibernate，我如何阅读未提交的内容？

> ID：936771
> 
> 赞同：6
> 
> 时间：2009-06-01T21:01:56.150
> 
> 标签：nhibernate

使用 nhibernate，如何将事务级别设置为读取未提交？

使用 SQL，我通常在存储过程的开头设置事务级别或使用内联 (NOLOCK)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:28:25.630

[根据文档，](http://nhibernate.info/doc/nhibernate-reference/session-configuration.html#d0e875)您可以通过`hibernate.connection.isolation`. 如果您需要更精确的控制，请查看 NHibernate 的[悲观锁定](http://nhibernate.info/doc/nhibernate-reference/transactions.html#transactions-locking)机制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T11:52:44.283

您可以`nolock`通过以下步骤将内联 SQL 与 nhibernate 一起使用：

1.  使用以下命令创建 HBM 文件

    ```
    <sql-query name="PersonList">
    return alias="person"  class="Person">
    SELECT * FROM Person WITH(nolock) 
    <sql-query> 
    ```

2.  `AddXmlFile(hbm file path)`在创建休眠会话时使用。

3.  使用`DBSession.GetNamedQuery("PersonList")`获取人员列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T20:48:54.583

这对我有用（特定于 SQL 服务器）

```
 IDbCommand NHCommand;

  NHCommand= NHSession.Connection.CreateCommand();

  NHCommand.CommandText= "SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED";

  NHCommand.ExecuteNonQuery(); 
```

有点直接与 RDBMS 交谈。

# python - 为什么没有纯 Python SSH1（版本 1）客户端实现？

> ID：936783
> 
> 赞同：4
> 
> 时间：2009-06-01T21:06:31.897
> 
> 标签：python, ssh

那里似乎有一些好的纯 Python SSH2 客户端实现，但我还没有找到 SSH1 的实现。除了对这样的项目缺乏兴趣之外，还有什么特定的原因吗？我完全了解许多 SSH1 漏洞，但是对于我们这些想要编写 SSH 客户端来管理仅支持 SSH1 的旧嵌入式设备（例如 Cisco PIX）的人来说，纯 Python SSH1 客户端实现仍然非常有用。我也知道我不是唯一一个在寻找这个的人。

我问的原因是因为我很无聊，我一直在考虑自己写这篇文章。我刚开始犹豫不决，因为我知道有很多人比我聪明得多，而且我认为可能有一些原因为什么还没有人这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T16:25:55.750

SSHv1 在 2001 年被认为已弃用，所以我认为没有人真正愿意为此付出努力。我不确定是否有 SSH1 的 rfc，因此获取完整的协议规范可能需要阅读旧的源代码。

由于存在已知漏洞，它并不比 telnet 好多少，后者几乎在旧设备和/或嵌入式设备上得到普遍支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T21:14:18.577

嗯，主要原因可能是当人们开始对 Python 等 VHLL 中的此类事物产生兴趣时，实施一个他们自己认为无用的标准对*他们来说是没有意义的。*

我不熟悉协议差异，但您是否可以将现有代码库调整为旧协议？

# wpf - WPF SolidColorBrush 困境

> ID：936786
> 
> 赞同：8
> 
> 时间：2009-06-01T21:06:38.170
> 
> 标签：wpf, brush

有谁知道如何将代表颜色的字符串转换为`SolidColorBrush`WPF中的a？

例如：

```
string colorRed = "Red";
SolidColorBrush fromStringToColor = new SolidColorBrush(colorRed); 
```

这就是我想要完成的。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-01T21:23:02.597

您必须将字符串转换为 System.Windows.Media.Color，您可以使用静态 ColorConverter.ConvertFromString 方法执行此操作：

```
string colorRed = "Red";
Color c = (Color)ColorConverter.ConvertFromString(colorRed);
SolidColorBrush fromStringToColor = new SolidColorBrush(c); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-30T08:49:42.373

```
 private SolidColorBrush GetColorFromString(string color)
        {
            if (color.StartsWith("#"))
            {
                if (color.Length == 9)
                    return new SolidColorBrush(
                        Color.FromArgb(
                            Convert.ToByte(color.Substring(1, 2), 16),
                            Convert.ToByte(color.Substring(3, 2), 16),
                            Convert.ToByte(color.Substring(5, 2), 16),
                            Convert.ToByte(color.Substring(7, 2), 16)
                        )
                    );
                else
                    if (color.Length == 7)
                        return new SolidColorBrush(
                            Color.FromArgb(
                                0xff,
                                Convert.ToByte(color.Substring(1, 2), 16),
                                Convert.ToByte(color.Substring(3, 2), 16),
                                Convert.ToByte(color.Substring(5, 2), 16)

                            )
                        );
            }
            else
            {
                Type colorType = (typeof(System.Windows.Media.Colors));
                if (colorType.GetProperty(color) != null)
                {
                    object o = colorType.InvokeMember(color,
                    System.Reflection.BindingFlags.GetProperty, null, null, null); if (o != null)
                    {
                        return new SolidColorBrush((Color)o);
                    }
                }
            }
            return new SolidColorBrush(Colors.Transparent);

        }

SolidColorBrush c1 = GetColorFromString("Red");
SolidColorBrush c2 = GetColorFromString("#ffff0000");
SolidColorBrush c3 = GetColorFromString("#ff0000"); 
```

# c# - 解决一个 COM [out] VARIANT* 包含 parray 作为 C#.net 中 BSTR 的 SAFEARRAY

> ID：936790
> 
> 赞同：0
> 
> 时间：2009-06-01T21:07:31.320
> 
> 标签：c#, c++, com, atl

问题：我有一个带有 IDL 方法的 COM 服务器：

```
 [id(2), helpstring("method ExtractAvailableScanners")]
        HRESULT ExtractAvailableScanners(
              [in] VARIANT scanFilter, [out] VARIANT* scanPresent,
              [out,retval] LONG* retVal); 
```

在头文件中，这变为：

```
STDMETHOD(ExtractAvailableScanners)
  (VARIANT scanFilter, VARIANT* scanPresent, LONG* retVal); 
```

实施：

```
STDMETHODIMP CSBIdentify::ExtractAvailableScanners
  (VARIANT scanFilter, VARIANT* scanPresent, LONG* retVal)
{
      // TODO: Return the available scanners given a scanner lookup filter

      CInternals ints;

      //Find all the device strings
      CComVariant Result;
      ints.CollectDeviceStrings(&Result);

      //Extraction of the wanted ones
      CComVariant* pScanners = new CComVariant;
      pScanners->vt = VT_SAFEARRAY;
      ints.FilterScanners(scanFilter, &Result, pScanners);

      // Cleanup
      // ========
      scanPresent = pScanners;
      return S_OK;
} 
```

//这里添加了CInternals类来补图

int CInternals::CollectDeviceStrings(CComVariant* pList) { HRESULT hr = S_OK; BOOL bRet = FALSE；HRESULT 小时 = S_OK;

```
// Step 3: ---------------------------------------------------
// Obtain the initial locater to WMI -------------------------

IWbemLocator *pLoc = NULL;

hres = CoCreateInstance(
    CLSID_WbemLocator,             
    0, 
    CLSCTX_INPROC_SERVER, 
    IID_IWbemLocator, (LPVOID *) &pLoc);

if (FAILED(hres))
{
    CError::PresetError( "Failed to create IWbemLocator object in SBIdentify::GetDevices", E_FAIL );
    return hres;
}

// Step 4: -----------------------------------------------------
// Connect to WMI through the IWbemLocator::ConnectServer method

IWbemServices *pSvc = NULL;

// Connect to the root\cimv2 namespace with
// the current user and obtain pointer pSvc
// to make IWbemServices calls.
hres = pLoc->ConnectServer(
    _bstr_t(L"ROOT\\CIMV2"), // Object path of WMI namespace
    NULL,                    // User name. NULL = current user
    NULL,                    // User password. NULL = current
    0,                       // Locale. NULL indicates current
    NULL,                    // Security flags.
    0,                       // Authority (e.g. Kerberos)
    0,                       // Context object 
    &pSvc                    // pointer to IWbemServices proxy
    );

if (FAILED(hres))
{
    CError::PresetError( "Could not connect to IWbemServices proxy in SBIdentify::GetDevices", E_FAIL );
    pLoc->Release();     
    return hres;
}

//  CTraceLog::TraceMsg( "Connected to ROOT\\CIMV2 WMI namespace" );

// Step 5: --------------------------------------------------
// Set security levels on the proxy -------------------------

hres = CoSetProxyBlanket(
    pSvc,                        // Indicates the proxy to set
    RPC_C_AUTHN_WINNT,           // RPC_C_AUTHN_xxx
    RPC_C_AUTHZ_NONE,            // RPC_C_AUTHZ_xxx
    NULL,                        // Server principal name 
    RPC_C_AUTHN_LEVEL_CALL,      // RPC_C_AUTHN_LEVEL_xxx 
    RPC_C_IMP_LEVEL_IMPERSONATE, // RPC_C_IMP_LEVEL_xxx
    NULL,                        // client identity
    EOAC_NONE                    // proxy capabilities 
    );

if (FAILED(hres))
{
    CError::PresetError( "Could not set proxy blanket in SBIdentify::GetDevices", E_FAIL );
    pSvc->Release();
    pLoc->Release();     
    return hres;
}

// Step 6: --------------------------------------------------
// Use the IWbemServices pointer to make requests of WMI ----
// Use WBEM_FLAG_BIDIRECTIONAL flag to ensure the enumerator is resettable

IEnumWbemClassObject* pEnumerator = NULL;
hres = pSvc->ExecQuery(
    bstr_t("WQL"), 
    bstr_t("SELECT * FROM Win32_PnPEntity"),
    WBEM_FLAG_BIDIRECTIONAL | WBEM_FLAG_RETURN_IMMEDIATELY, 
    NULL,
    &pEnumerator);

if (FAILED(hres))
{
    CError::PresetError( "Query on Win32_PnPEntity failed in SBIdentify::GetDevices", E_FAIL );
    pSvc->Release();
    pLoc->Release();     
    return hres;
}

// Step 7: -------------------------------------------------
// Get the data from the query in step 6 -------------------
int n = 0;
CComPtr< IWbemClassObject > pclsObj;
ULONG uReturn = 0;

//Read the list to determine its length
while (pEnumerator)
{
    pclsObj = NULL;
    hr = pEnumerator->Next(WBEM_INFINITE, 1, &pclsObj, &uReturn);
    if(0 == uReturn)
        break;
    n++;
}
pEnumerator->Reset();

//The full read mechanism
VARIANT Result;
Result.vt = VT_SAFEARRAY | VT_BSTR;
VARIANT* pResult = &Result;

SAFEARRAYBOUND rgsabound[1];
rgsabound[0].lLbound = 0;
rgsabound[0].cElements = n;
LONG ix[] = {0};
int i = -1;
pResult->parray = ::SafeArrayCreate(VT_BSTR, 1, rgsabound);
if(pResult->parray == NULL)
{
    CError::PresetError( "SafeArrayCreate() failed in SBIdentify::GetDevices", E_OUTOFMEMORY );
    pSvc->Release();
    pLoc->Release();     
    return E_OUTOFMEMORY;
}

while (pEnumerator)
{
    pclsObj = NULL;
    pEnumerator->Next(WBEM_INFINITE, 1, &pclsObj, &uReturn);

    if(0 == uReturn)
        break;

    i++;

    VARIANT vtProp;

    // Get the value of the Name property
    hr = pclsObj->Get(L"Name", 0, &vtProp, 0, 0);
    if(hr != S_OK)
    {
        CError::PresetError( "<Get> failed in SBIdentify::GetDevices", hr );
        pSvc->Release();
        pLoc->Release();
        pEnumerator->Release();
        return hr;
    }
    wcout << " Name : " << vtProp.bstrVal << endl;
    ix[0] = i;
    hr = SafeArrayPutElement(pResult->parray, ix, vtProp.bstrVal);
    if(hr != S_OK)
    {
        CError::PresetError( "SafeArrayPutElement() failed in SBIdentify::GetDevices", hr );
        pSvc->Release();
        pLoc->Release();
        pEnumerator->Release();
        return hr;
    }
    VariantClear(&vtProp);
}
pList->Attach(pResult);
return hr; 
```

}

在 C# 中的 CS 文件中

```
 public void ExtractScanners(ref ListBox listBox1)
    {
        String[] oNames = {"LS1/LiteUe", "Sagem"};

//            object oResult = new IntPtr(Int32);
//            Object oGeneric;// = new object();
//            System.Array oResult;
//            IntPtr i = (IntPtr)8;// 27;
//            Object oResult = Marshal.GetObjectForNativeVariant(i);
//            Object oResult;// = null;
//            String[] oResult;
//            IntPtr oResult;
        try
        {
            iRet = myCom.ExtractAvailableScanners(oNames, out oResult);

            listBox1.Items.Add("GetAvailableDevices ok");
        }
        catch (COMException comEx)
        {
            ReportCOMError(comEx, ref listBox1);
        }
        catch (ArgumentException argEx)
        {
            ReportArgError(argEx, ref listBox1);
        }
    } 
```

关键是“out oResult”对象都不起作用。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:20:07.720

看起来您的 C++ 实现是错误的。您没有在`retVal`任何地方设置，而且您将错误的值复制到`scanPresent`. 调用代码无法知道您使用 分配它`new`，并且由于它是 C#，因此即使这样做也无法释放它。通常，您使用`VariantInit`（这`CComVariant`是对此的包装器）分配 VARIANT，然后直接将字段复制到结果参数中。此外，我看不到您如何为返回创建安全数组。

```
STDMETHODIMP CSBIdentify::ExtractAvailableScanners
  (VARIANT scanFilter, VARIANT* scanPresent, LONG* retVal)
{
      // TODO: Return the available scanners given a scanner lookup filter

      CInternals ints;

      //Find all the device strings
      CComVariant Result;
      ints.CollectDeviceStrings(&Result);

      //Extraction of the wanted ones
      CComVariant Scanners;

      // why set this here?
      pScanners.vt = VT_SAFEARRAY;

      // what does this call do? It should be allocating the new safe array
      // using the normal methods for creating safe arrays
      ints.FilterScanners(scanFilter, &Result, &Scanners);

      // Cleanup
      // ========
      Scanners.Detach(scanPresent);

      // what to put in here?
      *retVal = something;
      return S_OK;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T22:20:39.987

请查看[1800 INFORMATION]的优秀帖子以供参考。

让我澄清几个细节。当他说：

```
 // why set this here?
  scanners.vt = VT_SAFEARRAY; 
```

他之所以这么问，是因为这还不足以创建一个 SAFEARRAY。在这样的不同函数中初始化一个类的片段是非常糟糕的做法。FilterScanners() 无论如何都需要在内部执行此操作，此外还有更多：

```
 // Local dimension bounds
  // 'x' is the number of dimensions, as in this VB6:
  // Dim Abc(a,b,c) 'has three dimensions
  SAFEARRAYBOUND sab[x]; 

  // Set the dimensions, as in:
  // Dim Abc(0 TO TOTAL_BOUND_0, 0 TO TOTAL_BOUND_1, ...) 'VB6
  sab[0].lLbound = 0;
  sab[0].cElements = TOTAL_BOUND_0;
  sab[1].lLbound = 0;
  sab[1].cElements = TOTAL_BOUND_1;
  // ... etc.

  // This API creates the actual SafeArray in the COM Heap.
  // Replace proper VT_VARIANT below with your type
  SAFEARRAY * pSA = SafeArrayCreate(VT_VARIANT, x, sab); // x same as before

  // Fill-in the elements of the array as required.
  // Remember to use SafeArrayAccessData() and SafeArrayUnaccessData()

  // Stuff the pointer to the SAFEARRAY in the VARIANT output argument:
  // "OR" whatever the type of the array is. Think in VB6 terms!
  // Dim scanners(...) As Variant ' VT_SAFEARRAY | VT_VARIANT
  // Dim scanners(...) As String  ' VT_SAFEARRAY | VB_BSTR
  // etc.
  VariantInit(pScanners); // Always recommended to clear the VARIANT before using it
  pScanners->vt    = VT_SAFEARRAY | VT_VARIANT; // set the type
  pScanners->pparray = pSA; 
```

# java - 使用默认值从环境中定义 ant 属性

> ID：936793
> 
> 赞同：55
> 
> 时间：2009-06-01T21:08:19.647
> 
> 标签：java, ant, environment-variables, release, packaging

我希望我的构建脚本能够在发布和开发环境中正常运行。

为此，我想在 ant 中定义一个属性，称之为（例如）`fileTargetName`

`fileTargetName`如果可用，将从环境变量中获取它的值`RELEASE_VER`，如果不可用，它将获取**dev的默认值**

感谢您帮助 ant`<condition><value></condition>`并`<property>`使其正常工作。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-06-01T21:24:46.293

[Ant 文档](http://ant.apache.org/manual/Tasks/property.html#notes-env)中有关如何将环境变量放入属性的示例：

```
<property environment="env"/>
<echo message="Number of Processors = ${env.NUMBER_OF_PROCESSORS}"/>
<echo message="ANT_HOME is set to = ${env.ANT_HOME}"/> 
```

在您的情况下，您将使用`${env.RELEASE_VER}`.

然后对于条件部分，[这里](http://ant.apache.org/manual/Tasks/condition.html)的文档说有三个可能的属性：

```
属性 描述 必填
property 要设置的属性的名称。是的
value 要将属性设置为的值。默认为“真”。不
else 将属性设置为的值 if 条件 否
           评估为假。默认情况下，该属性将
           保持未设置。自蚂蚁 1.6.3

```

把它放在一起：

```
<property environment="env"/>
<condition property="fileTargetName" value="${env.RELEASE_VER}" else="dev">
    <isset property="env.RELEASE_VER" />
</condition> 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-06-02T17:58:48.677

您不需要为此使用 a `<condition>`。Ant 中的属性是[不可变](http://ant.apache.org/manual/Tasks/property.html)的，所以你可以使用这个：

```
<property environment="env"/>
<property name="env.RELEASE_VER" value="dev"/> 
```

如果`RELEASE_VER`设置了环境变量，则属性将从环境中获取其值，第二`<property>`条语句将不起作用。否则，该属性将在第一条语句后取消设置，第二条语句将其值设置为`"dev"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:37:38.310

我敢肯定有比这更简单的方法，但是如何：

```
<project name="example" default="show-props">

    <property environment="env" />

    <condition property="fileTargetName" value="${env.RELEASE_VER}">
        <isset property="env.RELEASE_VER" />
    </condition>

    <condition property="fileTargetName" value="dev">
        <not>
            <isset property="env.RELEASE_VER" />
        </not>
    </condition>

    <target name="show-props">
        <echo>property is ${fileTargetName}</echo>
    </target>

</project> 
```

# css - IE 在浮动 DIV 中消失的子弹错误

> ID：936797
> 
> 赞同：1
> 
> 时间：2009-06-01T21:10:39.300
> 
> 标签：css, internet-explorer-6, internet-explorer-7

论坛上有很多关于这方面的建议，但还没有一个对我来说显示出任何成功的迹象。

我有一个浮动 div，其中包含样式为使用项目符号图像的 UL。所有兼容的浏览器都可以正常显示图像。当我在 IE 6 中刷新页面时，项目符号经常出现，但在页面滚动时再次消失。在 IE 7 中，它们只是没有出现。

页面在这里：

[http://hiv411.org/page.php?pID=13&n=Other_STDs](http://hiv411.org/page.php?pID=13&n=Other_STDs)

相关CSS：

```
#hiv101STDSidebar UL {
width:215px;
}

#hiv101STDSidebar LI {
position:relative;  /* added per some forum post, no effect*/
list-style-image:url(/images/layout/squareBulletBlue.gif);
} 
```

任何建议都非常感谢。不得不将这些 UL 重写为表格将是一种耻辱！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:15:46.313

正如其他人所建议的，使用背景图像而不是项目符号图像。

HTML

```
<div id="floated">
        <ul>
            <li>
                Item
            </li>
            <li>
                Item 2
            </li>
        </ul>
    </div> 
```

CSS

```
div#floated {
    float: left;
}

ul {
    padding: 0;
}

li {
    background: transparent url(squareBulletBlue.gif) no-repeat 0 2px;
    list-style-type: none;
    padding-left: 1.2em;
} 
```

对我来说在 IE6 和 7 中工作，如果不是，那么你的代码还有其他问题:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:14:33.473

尝试使用背景属性设置项目符号的样式。

```
selector li {
    background: transparent url(/images/layout/squareBulletBlue.gif) left center no-repeat;
    paddding-left: 25px; 
} 
```

您可能需要重置选择器上的`padding`and 。`margin``ul`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T07:50:48.793

这在 ie6 和 7 中修复了它：

```
#hiv101STDSidebar ul {
  width: 215px;
  margin: 0 0 0 0; /* resetting margin */
  padding: 0 0 0 40px; /* using padding to position ul */
} 
```

没有时间进行适当的调查，但似乎是侧边栏的继承左边距导致了问题。在 ul 上使用填充可修复 ie6 和 ie7 中的奇怪行为，但它在标准兼容浏览器中效果不佳，因此您需要使用条件 lte ie7 css 添加此样式。

希望这可以帮助。

# c++ - 确定哪些目标文件导致 .dll 大小增加 [C++]

> ID：936799
> 
> 赞同：6
> 
> 时间：2009-06-01T21:10:51.467
> 
> 标签：c++, size

我正在研究一个大型 c++ 构建的库，该库最近增长了很多。由于它的大小，导致这种大小增加的原因尚不清楚。

您对工具（msvc 或 gcc）有什么建议可以帮助确定增长的来源。

*编辑* 我尝试过的事情：Dumpbin 最终的 dll、obj 文件、创建地图文件并翻录它。

*再次编辑* 所以 objdump 和 python 脚本似乎已经完成了我想要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T21:31:20.087

如果是 gcc，[则为 objdump](http://en.wikipedia.org/wiki/Objdump)。如果是视觉工作室，[dumpbin](http://msdn.microsoft.com/en-us/library/c1h23y6c(VS.71).aspx)。

我建议对旧（小）库与新（大）库的工具输出进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:39:49.050

keysersoze 的答案（比较`objdump`or的输出`dumpbin`）是正确的。另一种方法是告诉链接器生成一个映射文件，并比较新旧版本 DLL 的映射文件。

*   MSVC：`link.exe` [`/MAP`](http://msdn.microsoft.com/en-us/library/k7xkk3e2.aspx)
*   GCC 和 binutils：（`ld` [`-M`](http://sourceware.org/binutils/docs-2.19/ld/Options.html#index-g_t_002d_002dprint_002dmap-62)或`gcc -Wl,-M`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:58:20.997

在 Linux 上，应该很容易查看是否添加了带有递归差异的新文件。他们肯定会增加图书馆的规模。然后，您可以在 Linux 上使用*size*命令行工具来获取每个新目标文件的大小并将它们汇总。然后将该总和与您的图书馆增加进行比较，并检查它有多少不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T21:24:47.010

天，

如果您有任何先前版本的目标文件，您可以运行 size 命令查看哪个段增长了吗？

几个问题：

*   您是在 *nix 平台还是 Windows 平台上？
*   您使用的是哪个编译器？
*   编译器最近更改了吗？
*   最近添加了 -g 标志吗？（明显的问题1）
*   该对象之前是否被剥离？（明显的问题2）
*   对象以前是否动态链接？（明显的问题3）

**编辑：**如果代码在 SCM 下，您能否查看为您提供较小对象的源版本。然后比较：

1.  通过在旧的源代码树上执行 du -sk 来确定源代码树的大小，然后在没有构建任何东西的情况下构建新的源代码树。
2.  通过执行类似的操作来获取文件数`find ./tree_top ( -name *.h -o -name *.cpp ) | wc -l`
3.  `find ./tree_top ( -name *.h -o -name *.cpp ) -print | sort > treelist`通过执行 a然后对新的更大的树执行相同的操作来确定增加的文件数量。做一个简单的 sdiff 将显示任何大量的新文件。
4.  代码库的大小，即使是尾随分号的简单计数也会为您提供一个很好的基本机制来比较两者。
5.  Makefiles 或构建环境。让项目查看是否有不同的选项或设置进入了构建本身。

高温高压

**顺便说一句**，请在此处发布您的发现，因为我相信很多人对您的发现感兴趣。

干杯，

# entity-framework - SQLite 与实体框架

> ID：936804
> 
> 赞同：26
> 
> 时间：2009-06-01T21:12:37.410
> 
> 标签：entity-framework, system.data.sqlite

使用 SQLite 时，我在实体框架中遇到主键问题。SQLite 希望在自动递增主键列的 VALUES 列表中显式 NULL。我实际上并没有查看 EF 上下文中生成的 SQL，但我相信它符合通常的 SQL Server 约定，即不为自动增量列提供任何值。

根据 ADO.NET SQLite 提供程序的[站点](http://sqlite.phxsoftware.com/)，完全支持 EF，但我在那里找不到任何帮助。有没有办法强制 EF 为主键值显式插入 NULL？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-04T19:59:53.277

好吧，我终于完成了这项工作：D。您需要将 id 列设置为自动增量，这样它就可以与 EF 一起使用。不要问我为什么在 sqlite 常见问题解答中关于自动增量的问题中没有提到这一点。这是一个例子：

```
create table Persona ( PersonaID integer primary key autoincrement, Nombre text) 
```

另外，我没有找到从 Visual Studio 中设置它的方法，我必须从命令行工具中进行设置。

更新：以下代码工作正常。

```
PruebaDBEntities data = new PruebaDBEntities();

        foreach (int num in Enumerable.Range(1, 1000))
        {
            Persona p = new Persona() { Nombre = "Persona " + num, Edad = num };

            data.AddToPersona(p);

            data.SaveChanges();

            Console.WriteLine(p.PersonaID);
        } 
```

PersonaID 未设置，在保存操作后，它具有由 sqlite 分配的值。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-06-19T21:36:14.957

万岁...我找到了解决方案！

1.  在您的 create table 语句中将 ID 列声明为 INTEGER PRIMARY KEY AUTOINCREMENT。整数主键不起作用！
2.  在 Visual Studio 中更新您的实体框架模型，将 ID 列属性 StoreGeneratedPattern 设置为“Computed”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-10T11:32:42.430

您必须将**自动增量**设置为 True。您可以在设计表窗口中通过单击工具栏中的（管理索引和键）图标**直接从 VS 进行此操作，然后更新您的模型。**

![图片](https://i.stack.imgur.com/j1Z6i.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-07T10:58:09.187

我对 EF 和 SQLite 也有同样的问题。尝试检查第二个帖子： [http ://sqlite.phxsoftware.com/forums/p/1418/6162.aspx](http://sqlite.phxsoftware.com/forums/p/1418/6162.aspx)

我的问题的原因是自动增量被添加到数据库本身，但实体模型没有正确刷新。所以刷新后，我的字段看起来像这样：

```
<Property Name="ID" Type="integer" Nullable="false" StoreGeneratedPattern="Identity" /> 
```

（添加了**StoreGeneratedPattern="Identity"**）

在刷新之前（使用旧模型），我只是尝试将 id 属性设置为 0，效果也很好：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-12T20:20:04.743

在“SQLite 权威指南”一书中，我在主键约束下阅读了以下内容：

“然而，实际上，此列只是 ROWID 的别名。它们都将引用相同的值。”

我相信这就是需要在列定义中设置 AUTOINCREMENT 的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-24T02:16:17.930

SQLite 的 EF 提供程序似乎没有将该列作为标识（自动增量）。

首先对于数据库，右键单击 EDMX 设计器中的列并将其设置`StoreGeneratedPattern`为`Identity`.

# postgresql - 表继承：跨分区强制执行唯一约束？

> ID：936818
> 
> 赞同：4
> 
> 时间：2009-06-01T21:14:33.880
> 
> 标签：postgresql, inheritance, constraints, database-partitioning

我有一个要分区的表，但我不知道如何处理唯一性约束。

是否可以跨多个子表创建唯一约束？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-25T09:27:17.903

不，这目前是不可能的。您可以做的最好的事情是创建一个手动进行验证的触发器。

# asp.net-mvc - ASP.NET MVC 授权属性 - 不工作！

> ID：936820
> 
> 赞同：0
> 
> 时间：2009-06-01T21:15:23.033
> 
> 标签：asp.net-mvc

嘿伙计们，我在这里有点沮丧。我不太确定发生了什么事。我从默认的 MVC 项目模板开始，然后继续添加一个控制器......

```
public class TestTemplatesController : EVController<EvTestTemplate>
{
    //
    // GET: /Tests/
    [Authorize]
    public ActionResult Index()
    {
        ViewData.Model = EntityList;
        return View();
    }
} 
```

我添加了 Authorize 属性，但它似乎并不适用。处理对控制器的 Uauthenticated 请求，而不是重定向到 . 我确定我在这里遗漏了一些简单的东西，但我想我会问。

谢谢，

PK

* * *

网络配置：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
                    <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
                    <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                    <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
                </sectionGroup>
            </sectionGroup>
        </sectionGroup>
    </configSections>
    <appSettings/>
    <connectionStrings>
        <add name="ApplicationServices" connectionString="Data Source=evsql;Initial Catalog=EvTestCases;Persist Security Info=True;User ID=EvTestCaseUser;Password=**********" providerName="System.Data.SqlClient"/>
        <add name="EVTestCases.Data.Properties.Settings.EvTestCasesConnectionString" connectionString="Data Source=evsql;Initial Catalog=EvTestCases;Persist Security Info=True;User ID=EvTestCaseUser;Password=**********" providerName="System.Data.SqlClient"/>
    </connectionStrings>
    <system.web>
        <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.
    -->
        <compilation debug="true">
            <assemblies>
                <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Web.Abstractions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            </assemblies>
        </compilation>
        <authentication mode="Forms">
            <forms loginUrl="~/Account/LogOn" timeout="2880"/>
        </authentication>
        <membership>
            <providers>
                <clear/>
                <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" passwordStrengthRegularExpression="" applicationName="/"/>
            </providers>
        </membership>
        <profile>
            <providers>
                <clear/>
                <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="ApplicationServices" applicationName="/"/>
            </providers>
        </profile>
        <roleManager enabled="false">
            <providers>
                <clear/>
                <add connectionStringName="ApplicationServices" applicationName="/" name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
                <add applicationName="/" name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
            </providers>
        </roleManager>
        <!--
            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
    -->
        <pages>
            <controls>
                <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </controls>
            <namespaces>
                <add namespace="System.Web.Mvc"/>
                <add namespace="System.Web.Mvc.Ajax"/>
                <add namespace="System.Web.Mvc.Html"/>
                <add namespace="System.Web.Routing"/>
                <add namespace="System.Linq"/>
                <add namespace="System.Data.Linq"/>
                <add namespace="System.Collections.Generic"/>
                <add namespace="EVTestCases.Data"/>
            </namespaces>
        </pages>
        <httpHandlers>
            <remove verb="*" path="*.asmx"/>
            <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
            <add verb="*" path="*.mvc" validate="false" type="System.Web.Mvc.MvcHttpHandler, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </httpHandlers>
        <httpModules>
            <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </httpModules>
    </system.web>
    <system.codedom>
        <compilers>
            <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="WarnAsError" value="false"/>
            </compiler>
            <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" warningLevel="4" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <providerOption name="CompilerVersion" value="v3.5"/>
                <providerOption name="OptionInfer" value="true"/>
                <providerOption name="WarnAsError" value="false"/>
            </compiler>
        </compilers>
    </system.codedom>
    <system.web.extensions/>
    <!-- 
        The system.webServer section is required for running ASP.NET AJAX under Internet
        Information Services 7.0\.  It is not necessary for previous version of IIS.
  -->
    <system.webServer>
        <validation validateIntegratedModeConfiguration="false"/>
        <modules runAllManagedModulesForAllRequests="true">
            <remove name="ScriptModule"/>
            <remove name="UrlRoutingModule"/>
            <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        </modules>
        <handlers>
            <remove name="WebServiceHandlerFactory-Integrated"/>
            <remove name="ScriptHandlerFactory"/>
            <remove name="ScriptHandlerFactoryAppServices"/>
            <remove name="ScriptResource"/>
            <remove name="MvcHttpHandler"/>
            <remove name="UrlRoutingHandler"/>
            <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="MvcHttpHandler" preCondition="integratedMode" verb="*" path="*.mvc" type="System.Web.Mvc.MvcHttpHandler, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            <add name="UrlRoutingHandler" preCondition="integratedMode" verb="*" path="UrlRouting.axd" type="System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
        </handlers>
    </system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T21:59:05.943

好吧，我感觉自己像个白痴。如果您在正确的控制器上添加授权属性，它会有所帮助。:) 这是漫长的一天......

# ruby-on-rails - RadRails 试用已过期 - Eclipse 中 Rails 有任何免费选项吗？

> ID：936824
> 
> 赞同：3
> 
> 时间：2009-06-01T21:15:38.540
> 
> 标签：ruby-on-rails, ruby, eclipse, ide

不久前我安装了 RadRails，并在它说我的试用版已过期后将其卸载。

这是在 Eclipse 中进行 Rails 开发的唯一选择是否正确？

Eclipse 还有其他免费选项吗？（我试过“Ruby RDT”，但它不提供任何 Rails 支持，只是基本的 Ruby 编辑。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T22:13:14.243

使用完整的[Aptana Studio](http://www.aptana.com/)，在提示专业版试用结束后，您可以继续使用社区版模式。

似乎不是单独获得社区版的方法，但它只会要求您在 30 天后关闭并重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T22:04:47.070

试试 Aptana IDE - 它基于 Eclipse，完全免费。据我所知，它的 Rails 支持基于 Rad Rails eclipse 插件。

顺便说一句，我正在为 Rails 使用 NetBeans 6.5.1，我已经确信每个人都是我的办公室，它比 Aptana 更好:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T21:29:38.340

我使用 Eclipse 进行了一段时间的 Rails 开发，基于 RDT 以及以下文章中描述的 mods：

www.napcs.com/howto/railsonwindows.html

# c# - MyDataContext.dbml 下的 .cs 文件是做什么用的？

> ID：936828
> 
> 赞同：3
> 
> 时间：2009-06-01T21:16:27.323
> 
> 标签：c#, visual-studio, linq-to-sql, datacontext

MyDataContext.dbml 下的那个单独的（当前为空的）文件是什么？

目录结构：

```
Mydatacontext.dbml
    MyDataContext.cs
    MyDataContext.dbml.layout
    MyDataContext.designer.cs 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:33:39.223

它通常用于添加`MyDataContext`带有自定义代码的部分类，在代码生成期间不会被覆盖。如果您改为编辑 MyDataContext.designer.cs，您的手写代码将被删除。

# active-directory - 我在哪里可以获得 dsquery 和其他对调试 Active Directory 问题有用的工具？

> ID：936829
> 
> 赞同：20
> 
> 时间：2009-06-01T21:16:28.663
> 
> 标签：active-directory, dsquery

关于 Active Directory的`dsquery`几个问题的解决方案中提到了命令行工具。但是，我的工作站没有这个命令行工具。我在哪里得到它？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-08T12:49:28.483

对于 Windows 7，它是远程服务器管理工​​具 (RSAT) 功能包的一部分：

[http://www.microsoft.com/en-us/download/details.aspx?id=7887](http://www.microsoft.com/en-us/download/details.aspx?id=7887)

这可用于 W2003 和 W2008 服务器。
有关如何使用*dism*命令安装这些的信息可以在[我的博客文章](https://www.actualadmins.com/windows-7w2008-managing-features-with-the-command-line-and-installing-the-remote-server-administration-tools-rsat/)中找到。

对于 Windows 8，它开启：

[http://www.microsoft.com/en-us/download/details.aspx?id=28972](http://www.microsoft.com/en-us/download/details.aspx?id=28972)

这个用于管理 W2012 服务器：

[http://www.microsoft.com/en-us/download/details.aspx?id=7887](http://www.microsoft.com/en-us/download/details.aspx?id=7887)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T22:22:04.117

比 dsquery 更好的是[joeware的 adfind 和 admod 工具](http://www.joeware.net/freetools/)

更强大。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-15T21:44:53.840

在 Win2008 和 Win2012 上：

在运行 Windows Server 2008 和 2012 的服务器上安装 Active Directory 域服务工具

控制面板 | 程序和功能 | 添加/删除 Windows 功能

通过向导到“添加角色和功能向导”

挖掘功能

单击下至：远程服务器管理工​​具，| 角色管理工具，| Active Directory 域服务工具，然后单击下一步。

单击安装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:17:58.817

[Windows Server 2003 管理工具包](http://www.microsoft.com/downloads/details.aspx?familyid=C16AE515-C8F4-47EF-A1E4-A8DCBACFF8E3)中提供了该`dsquery`工具和其他用于 Active Directory 的命令行工具。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-02-10T06:49:40.353

我正在处理 Windows 7 x86。安装后（Windows6.1-KB958830-x86-RefreshPkg.msu）。我确实启用了这些功能。 [![程序和功能下的 RSAT](https://i.stack.imgur.com/gdhw1.png)](https://i.stack.imgur.com/gdhw1.png)

# .net - CBT 挂钩在 Windows Vista 中不起作用

> ID：936830
> 
> 赞同：0
> 
> 时间：2009-06-01T21:17:16.713
> 
> 标签：.net, winforms

我正在尝试使用 CBT 挂钩来接收 HCBT_MOVESIZE 通知。当我从桌面上的文件夹运行程序时，它适用于所有应用程序。当我将应用程序安装到“程序文件”或“程序文件（x86”文件夹）时，我只收到我自己的应用程序的通知。.exe 文件已签名并在 Windows XP 中完美运行。我只在 Vista x86 中收到这些错误/x64\. 谁能提供有关如何解决此问题的任何建议？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T22:47:04.270

可能是 UIPI 问题：

> 用户界面特权隔离 (UIPI) 在 windows 子系统中实施限制，以防止较低特权应用程序发送窗口消息或在较高特权进程中**安装挂钩。**

来自微软的[Windows Integrity Mechanism Design](http://msdn.microsoft.com/en-us/library/bb625963.aspx)

# login - 带有 modalpopupextender 的 Dotnetnuke 弹出式登录控件

> ID：936838
> 
> 赞同：0
> 
> 时间：2009-06-01T21:19:35.740
> 
> 标签：login, popup, dotnetnuke, modalpopupextender, wizard

我正在尝试使用 AjaxToolkit 中的 ModalPopupExtender 为 dnn 创建一个模式弹出登录控件。我遇到的一个问题是，当我单击弹出登录表单上的“登录”按钮时，如果由于某种原因登录失败或者用户需要在继续之前更新一些信息，则模式弹出窗口会被清除并且永远不会通知用户他们需要更改信息并且无法继续登录。

ModalPopupExtender 是否以某种方式提供了模仿向导类型界面的能力，以便如果我的登录失败，那么下一个控件将在弹出窗口中呈现（例如“用户必须更改密码”）。有人请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T13:51:42.803

您可以使用 modalpopupextender 内的向导控件。

# c# - 非默认构造函数

> ID：936841
> 
> 赞同：1
> 
> 时间：2009-06-01T21:20:18.907
> 
> 标签：c#, .net, visual-studio, attributes, form-designer

我有一个在 C# 中创建的组件，它以前一直使用默认构造函数，但现在我希望它的父窗体通过传递对自身的引用来创建对象（在设计器中）。

换句话说，而不是 Designer.cs 中的以下内容：

```
 this.componentInstance = new MyControls.MyComponent(); 
```

我想指示表单设计器创建以下内容：

```
 this.componentInstance = new MyControls.MyComponent(this); 
```

是否有可能实现这一点（最好通过一些属性/注释或其他东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:28:28.313

您不能简单地使用[Control.Parent](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.parent.aspx)属性吗？当然，它不会在控件的构造函数中设置，但克服它的典型方法是实现[ISupportInitialize](http://msdn.microsoft.com/en-us/library/system.componentmodel.isupportinitialize.aspx)并在[EndInit](http://msdn.microsoft.com/en-us/library/system.componentmodel.isupportinitialize.endinit.aspx)方法中完成工作。

为什么需要引用回欠控制？

在这里，如果您创建一个新的控制台应用程序，并粘贴此内容以替换 Program.cs 的内容并运行它，您会注意到在[.EndInit](http://msdn.microsoft.com/en-us/library/system.componentmodel.isupportinitialize.endinit.aspx)中，[Parent](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.parent.aspx)属性设置正确。

```
using System;
using System.Windows.Forms;
using System.ComponentModel;
using System.Drawing;

namespace ConsoleApplication9
{
    public class Form1 : Form
    {
        private UserControl1 uc1;

        public Form1()
        {
            uc1 = new UserControl1();
            uc1.BeginInit();
            uc1.Location = new Point(8, 8);

            Controls.Add(uc1);

            uc1.EndInit();
        }
    }

    public class UserControl1 : UserControl, ISupportInitialize
    {
        public UserControl1()
        {
            Console.Out.WriteLine("Parent in constructor: " + Parent);
        }

        public void BeginInit()
        {
            Console.Out.WriteLine("Parent in BeginInit: " + Parent);
        }

        public void EndInit()
        {
            Console.Out.WriteLine("Parent in EndInit: " + Parent);
        }
    }

    class Program
    {
        [STAThread]
        static void Main()
        {
            Application.Run(new Form1());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T23:02:59.527

我不知道实际让设计器发出调用非默认构造函数的代码的任何方法，但这里有一个解决它的想法。将初始化代码放在父窗体的默认构造函数中，并使用 Form.DesignMode 来查看是否需要执行它。

```
public class MyParent : Form
{
    object component;

    MyParent()
    {
        if (this.DesignMode)
        {
            this.component = new MyComponent(this);
        }
    }
} 
```

# c# - String.Replace 似乎没有用空字符串替换括号

> ID：936847
> 
> 赞同：5
> 
> 时间：2009-06-01T21:22:36.797
> 
> 标签：c#, string

以下 C# 代码似乎没有做任何事情：

```
String str = "{3}";
str.Replace("{", String.Empty);
str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

这最终吐出：{3}。我不知道为什么会这样。我一直在用 Java 做这种事情。.NET 字符串处理是否有一些细微差别让我无法理解？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-01T21:25:23.310

String 类是[不可变](http://en.wikipedia.org/wiki/Immutable_object)的；`str.Replace`不会改变`str`，它将返回一个带有结果的新字符串。试试这个：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T21:25:50.953

字符串是不可变的；您不能更改字符串的实例。您的两个 Replace() 调用对原始字符串没有任何作用；他们返回一个修改后的字符串。你想要这个：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

它在 Java 中也以这种方式工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-01T21:25:32.733

Replace 实际上不会修改您调用它的字符串实例。它只是返回一个修改后的副本。

试试这个：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-01T21:25:31.487

Str.Replace 返回一个新字符串。因此，您需要按如下方式使用它：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-01T21:25:24.870

你必须这样做：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

查看[String.Replace](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)参考：

> 返回值类型：System.String
> 
> 与此实例等效的字符串，但 oldValue 的所有实例都替换为 newValue。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-01T21:25:30.707

Replace 函数返回修改后的字符串，因此您必须将其分配回您的`str`变量。

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-01T21:25:53.480

我相信 str.Replace 返回一个必须分配给变量的值。因此，您需要执行以下操作：

```
String str = "{3}";
str = str.Replace("{", String.Empty);
str = str.Replace("}", String.Empty);

Console.WriteLine(str); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-01T21:26:06.540

该`Replace`方法*返回*一个带有替换的字符串。我认为您正在寻找的是：

```
str = str.Replace("{", string.Empty);
str = str.Replace("}", string.Empty);

Console.WriteLine(str); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-01T21:29:57.873

除了到目前为止的所有建议之外 - 您还可以通过使用输出中的内联替换函数来完成此操作而无需更改原始字符串的值...

```
String str = "{3}";

Console.WriteLine(str.Replace("{", String.Empty).Replace("}", String.Empty)); 
```

# css - 表行附加 javascript 后 IE 丢失 css 样式

> ID：936851
> 
> 赞同：0
> 
> 时间：2009-06-01T21:23:36.637
> 
> 标签：css, ajax, internet-explorer

我有一个问题，我正在对一些表行进行 ajax 获取，我用这些行来替换表的主体。

问题是有时 IE(6/7) 决定在这样的附加之后忘记所有页面样式。（也就是说，它恢复为使用页面顶部的css包含中的样式，而不是页面本身定义的样式）

我已经能够找到[其他](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=168932) [人](http://groups.google.com/group/jquery-ui/browse_thread/thread/e2f5ed34386cb782?pli=1) [描述](http://www.dotnetnuke.com/Community/Forums/tabid/795/forumid/111/threadid/208300/scope/posts/Default.aspx)相同的问题，但没有解决方案。有没有人遇到过这个问题，并且能够解决它？

如果解决方案不涉及将页面上的所有 css 外部化，则可以加分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T22:08:25.220

好吧，如果你的意思是你在正文中有样式标签，它们不应该真的存在，所以一些浏览器可能对此反应不佳也就不足为奇了。

如果要替换表中的所有行，请尝试替换整个表。表的结构并不意味着要彻底改变，因此替换整个表很可能会导致页面的不那么激进的重排。这可能会阻止它删除代码中有问题的样式标签。

验证您放入页面的代码是否有效。如果您引入无效的 HTML 代码，可能会迫使浏览器更改呈现模式。反过来，这将需要对代码进行完整的重新检查，这可能是它丢弃内联样式标签的一个可能解释。

您可以尝试使用您安排的 div 标签代替表格，以形成您想要的布局。与替换表格或表格的一部分相比，替换某些 div 元素可能对浏览器造成的混乱更少，这可能会使页面更加稳定。

如果这一切都失败了，除了不将样式标签放在正文中来使页面更健壮之外，我真的没有看到任何其他解决方案。无论如何，从长远来看，这是您应该考虑的事情。

# c# - FormatException 0 不是布尔值的有效值

> ID：936852
> 
> 赞同：1
> 
> 时间：2009-06-01T21:23:40.867
> 
> 标签：c#, .net

我收到以下代码的格式异常。任何人都知道如何让 BooleanConverter 从 0/1 转换为真/假。

```
 bool bVal=true;
 string sVal = "0";
 Console.WriteLine(TypeDescriptor.GetConverter(bVal).ConvertFrom(sVal)); 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:28:08.687

尝试以下

```
public static bool ConvertToBasedOnIntValue(string value) {
  // error checking omitted for brevity
  var i = Int32.Parse(value);
  return value == 0 ? false : true;
} 
```

或者您可以使用以下内容，它不会引发异常，但它会认为所有字面上不是 0 的东西都是真的

```
public static bool ConvertToBasedOnIntValue(string value) {
  if ( 0 == StringComparer.CompareOrdinal(value, "0") ) {
    return false;
  }
  return true;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:25:01.377

只有两种情况，所以可以明确地检查它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T22:51:25.120

如果要使用 Int32.Parse，请改用 Int32.TryParse。如果转换失败，它不会抛出，而是返回 true 或 false。这意味着如果您所做的只是检查您的输入是否是一个值，那么它的性能会更高。例子：

```
public static bool ConvertToBool(string value)
{
    int val = 0;
    return (int.TryParse(value, out val) && val == 0) ? false : true;
} 
```

我倾向于过度使用三元运算符 (x ? y : z)，所以这里有一个更易于阅读的版本：

```
public static bool ConvertToBool(string value)
{
    int val = 0;
    if (int.TryParse(value, out val))
    {
        return val == 0 ? false : true;
    }

    return false;
} 
```

（我对它们都进行了测试。“1”返回真，“0”返回假。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-03T19:30:29.523

我刚刚构建了一个辅助函数来处理布尔值的特殊情况：

```
 Private Shared Function StringConverter(ByVal colValue As String, ByVal propertyType As Type) As Object

    Dim returnValue As Object

    'Convert the string value to the correct type
    Select Case propertyType
        Case GetType(Boolean)
            'Booleans need to be coded separately because by default only "True" and "False" will map to a Boolean
            'value. SQL Server will export XML with Booleans set to "0" and "1". We want to handle these without
            'changing the xml.
            Select Case colValue
                Case "0"
                    returnValue = False
                Case "1"
                    returnValue = True
                Case "False"
                    returnValue = False
                Case "True"
                    returnValue = True
                Case Else
                    Throw New ArgumentException("Value of '" & colValue & "' cannot be converted to type Boolean.")
            End Select
        Case Else
            'Let .Net Framework handle the conversion for us
            returnValue = TypeDescriptor.GetConverter(propertyType).ConvertFromString(colValue)

    End Select

    Return returnValue

End Function 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-03T20:02:58.910

您的原始代码已经足够好了，只是您不能将字符串值设置为“0”和“1”。在您的代码中，TypeConverter.ConvertFrom() 最终将调用 Boolean.TryParse()，其代码如下所示（感谢 Reflector！）

```
public static bool TryParse(string value, out bool result)
{
    result = false;
    if (value != null)
    {
        if ("True".Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            result = true;
            return true;
        }
        if ("False".Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            result = false;
            return true;
        }
        if (m_trimmableChars == null)
        {
            char[] destinationArray = new char[string.WhitespaceChars.Length + 1];
            Array.Copy(string.WhitespaceChars, destinationArray, string.WhitespaceChars.Length);
            destinationArray[destinationArray.Length - 1] = '\0';
            m_trimmableChars = destinationArray;
        }
        value = value.Trim(m_trimmableChars);
        if ("True".Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            result = true;
            return true;
        }
        if ("False".Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            result = false;
            return true;
        }
    }
    return false;
} 
```

因此，对您的代码进行以下更改，您应该会很好：

```
bool bVal = true;
string sVal = "false";
Console.WriteLine(TypeDescriptor.GetConverter(bVal).ConvertFrom(sVal)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-01T04:48:45.437

```
string _sOne = "1";
 string _sTrue = "TrUe";
 bool _bRandom = !Convert.ToBoolean(__sTrue);
 string _sResult = Convert.ToBoolean(_sOne);
 string _sResultB = Convert.ToBoolean(_sTrue);
 string _sResultC = _bRandom.ToString(); 
```

# c - win32如何读写扩展windows文件属性

> ID：936853
> 
> 赞同：5
> 
> 时间：2009-06-01T21:24:06.123
> 
> 标签：c, winapi

我想在 windows 文件中嵌入一些元数据。

我遇到了扩展文件属性的概念，我相信它就是用于此目的。例如，jpgs 中的相机名称，avis 中的剧集名称。

除了一些非常晦涩的未记录内核 API 之外，我找不到如何使用 win32 api 在 c/c++ 中执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T21:34:11.123

扩展属性是文件系统的一个属性，即 NTFS。与 jpeg 和 AVI 关联的标签存储在文件本身中。Win32 API 只会为您提供来自文件系统的 EA，而不是嵌入在文件中的那些。您必须查看第三方库才能检索嵌入的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T23:12:01.270

在一般情况下，元数据可以以您的应用程序易于访问的任何方式进行格式化。[创建RDF](http://www.w3.org/RDF/)规范是为了提供一组标准的元数据功能，涵盖大多数通常有用的信息类型。

然而，问题总是要找到一种方法，将其与真实数据一起存储，并且不会干扰那些认为自己知道如何处理格式的应用程序。这对于众所周知的格式可能特别棘手。

Adobe 已经对这个问题进行了大量研究，并且正在支持他们称为[XMP](http://www.adobe.com/products/xmp/)的技术以取得良好的效果。XMP 包括与 RDF 密切相关的样式的元数据，以及将其打包到许多其他文件格式中的约定，或者在那些没有可移植方式将数据放入其中的情况下的边车文件中。

在所有文件都存储在 NTFS 卷上的 Windows 系统上，可以想象扩展属性和备用数据流可用于存储元数据。最大的问题是便携性。如果将文件复制到不支持它们的媒体（例如任何类型的 FAT 以及 CD 和 DVD 上使用的文件系统），备用流将丢失。

这是一个严重的缺陷，它使得对此类文件进行有效且完整的备份比对大多数用户而言实际更加困难。

有些应用程序使用备用数据流，但他们这样做是知道在复制文件时它们添加的值可能会丢失。

# iphone - iphone编程中的文件上传到HTTP服务器

> ID：936855
> 
> 赞同：58
> 
> 时间：2009-06-01T21:24:33.703
> 
> 标签：iphone, http, file-upload

谁能给我一些链接或示例以使用 iphone API 将文件上传到 HTTP 服务器。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-06-02T00:44:31.863

下面的代码使用 HTTP POST 将 NSData 发布到网络服务器。您还需要对 PHP 有一些了解。

```
NSString *urlString = @"http://yourserver.com/upload.php";
NSString *filename = @"filename";
request= [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];
NSString *boundary = @"---------------------------14737809831466499882746641449";
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];
NSMutableData *postbody = [NSMutableData data];
[postbody appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postbody appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"%@.jpg\"\r\n", filename] dataUsingEncoding:NSUTF8StringEncoding]];
[postbody appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[postbody appendData:[NSData dataWithData:YOUR_NSDATA_HERE]];
[postbody appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[request setHTTPBody:postbody];

NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
NSLog(@"%@", returnString); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-06-02T05:35:52.477

[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/How-to-use)是网络 API 的一个很好的包装器，可以很容易地上传文件。这是他们的示例（但您也可以在 iPhone 上执行此操作 - 我们将图像保存到“磁盘”并稍后上传它们。

```
ASIFormDataRequest *request = [[[ASIFormDataRequest alloc] initWithURL:url] autorelease];
[request setPostValue:@"Ben" forKey:@"first_name"];
[request setPostValue:@"Copsey" forKey:@"last_name"];
[request setFile:@"/Users/ben/Desktop/ben.jpg" forKey:@"photo"]; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-01T06:05:28.757

我使用 ASIHTTPRequest 很像[Jane Sales 的回答](https://stackoverflow.com/a/938025/672989)，但它不再处于开发阶段，作者建议使用其他库，如 AFNetworking。

> [老实说，我认为现在是开始寻找其他地方的时候了。](http://allseeing-i.com/%5Brequest_release%5D;)

[AFNetworking](https://github.com/AFNetworking/AFNetworking)工作得很好，让你经常使用块（这是一个很大的解脱）。

[这是他们在github](https://github.com/AFNetworking/AFNetworking)上的文档页面中的图像上传示例：

```
NSURL *url = [NSURL URLWithString:@"http://api-base-url.com"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
NSData *imageData = UIImageJPEGRepresentation([UIImage imageNamed:@"avatar.jpg"], 0.5);
NSMutableURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST" path:@"/upload" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
    [formData appendPartWithFileData:imageData name:@"avatar" fileName:@"avatar.jpg" mimeType:@"image/jpeg"];
}];

AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
[operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
    NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);
}];
[httpClient enqueueHTTPRequestOperation:operation]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-14T15:54:43.963

这是一个很棒的包装器，但是当发布到**asp.net**网页时，需要设置两个额外的发布值：

```
 ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
    //ADD THESE, BECAUSE ASP.NET is Expecting them for validation
    //Even if they are empty you will be able to post the file
    [request setPostValue:@"" forKey:@"__VIEWSTATE"];
    [request setPostValue:@"" forKey:@"__EVENTVALIDATION"]; 
    ///

    [request setFile:FIleName forKey:@"fileupload_control_Name"];
    [request startSynchronous]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-18T17:49:00.753

这不是替代解决方案；而是对布兰登的流行答案的建议（好像我没有足够的代表来评论那个答案）。如果您要上传大文件；由于必须将文件读入内存才能将其发布到服务器，您可能会遇到 mmap malloc 异常。

您可以通过替换来调整 Brandon 的代码：

```
[request setHTTPBody:postbody]; 
```

和：

```
NSInputStream *stream = [[NSInputStream alloc] initWithData:postbody];
[request setHTTPBodyStream:stream]; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-03-19T12:41:39.930

试试这个..**很容易理解**和实现......

您可以直接在此处下载示例代码[https://github.com/Tech-Dev-Mobile/Json-Sample](https://github.com/Tech-Dev-Mobile/Json-Sample)

```
- (void)simpleJsonParsingPostMetod
{

#warning set webservice url and parse POST method in JSON
    //-- Temp Initialized variables
    NSString *first_name;
    NSString *image_name;
    NSData *imageData;

    //-- Convert string into URL
    NSString *urlString = [NSString stringWithFormat:@"demo.com/your_server_db_name/service/link"];
    NSMutableURLRequest *request =[[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = @"14737809831466499882746641449";
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    //-- Append data into posr url using following method
    NSMutableData *body = [NSMutableData data];

    //-- For Sending text

        //-- "firstname" is keyword form service
        //-- "first_name" is the text which we have to send
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"\r\n\r\n",@"firstname"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"%@",first_name] dataUsingEncoding:NSUTF8StringEncoding]];

    //-- For sending image into service if needed (send image as imagedata)

        //-- "image_name" is file name of the image (we can set custom name)
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [body appendData:[[NSString stringWithFormat:@"Content-Disposition:form-data; name=\"file\"; filename=\"%@\"\r\n",image_name] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    //-- Sending data into server through URL
    [request setHTTPBody:body];

    //-- Getting response form server
    NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];

    //-- JSON Parsing with response data
    NSDictionary *result = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableContainers error:nil];
    NSLog(@"Result = %@",result);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-15T20:39:48.433

我想我会为任何阅读这篇文章并且正在努力弄清楚如何在服务器端接收文件并将文件保存到文件系统的初学者添加一些服务器端 php 代码到这个答案中。

我意识到这个答案并没有直接回答 OP 的问题，但是由于 Brandon 的答案对于 iOS 设备端的上传来说已经足够了，并且他提到了一些 php 知识是必要的，我想我会用这个答案来填补 php 的空白。

这是我与一些示例使用代码放在一起的一个类。请注意，文件存储在基于哪个用户上传它们的目录中。这可能适用于您的使用，也可能不适用，但我想我会把它留在原处以防万一。

```
<?php

class upload
{
    protected $user;

    protected $isImage;
    protected $isMovie;

    protected $file;
    protected $uploadFilename;
    protected $uploadDirectory;
    protected $fileSize;
    protected $fileTmpName;
    protected $fileType;
    protected $fileExtension;

    protected $saveFilePath;

    protected $allowedExtensions;

function __construct($file, $userPointer)
{
    // set the file we're uploading
    $this->file = $file;

    // if this is tied to a user, link the user account here
    $this->user = $userPointer;

    // set default bool values to false since we don't know what file type is being uploaded yet
    $this->isImage   = FALSE;
    $this->isMovie   = FALSE;

    // setup file properties
    if (isset($this->file) && !empty($this->file))
    {   
        $this->uploadFilename   = $this->file['file']['name'];
        $this->fileSize         = $this->file['file']['size'];
        $this->fileTmpName      = $this->file['file']['tmp_name'];
        $this->fileType         = $this->file['file']['type'];
    }
    else
    {
        throw new Exception('Received empty data. No file found to upload.');
    }

    // get the file extension of the file we're trying to upload
    $tmp = explode('.', $this->uploadFilename);
    $this->fileExtension        = strtolower(end($tmp));

}

public function image($postParams)
{
    // set default error alert (or whatever you want to return if error)
    $retVal = array('alert' => '115');

    // set our bool
    $this->isImage = TRUE;

    // set our type limits
    $this->allowedExtensions    = array("png");

    // setup destination directory path (without filename yet)
    $this->uploadDirectory      = DIR_IMG_UPLOADS.$this->user->uid."/photos/";

    // if user is not subscribed they are allowed only one image, clear their folder here
    if ($this->user->isSubscribed() == FALSE)
    {
        $this->clearFolder($this->uploadDirectory);
    }

    // try to upload the file
    $success = $this->startUpload();

    if ($success === TRUE)
    {
        // return the image name (NOTE: this wipes the error alert set above)
        $retVal = array(
                        'imageName' =>  $this->uploadFilename,
                        );
    }

    return $retVal;
}

public function movie($data)
{
    // update php settings to handle larger uploads
    set_time_limit(300);

    // you may need to increase allowed filesize as well if your server is not set with a high enough limit

    // set default return value (error code for upload failed)
    $retVal = array('alert' => '92');

    // set our bool
    $this->isMovie = TRUE;

    // set our allowed movie types
    $this->allowedExtensions = array("mov", "mp4", "mpv", "3gp");

    // setup destination path
    $this->uploadDirectory = DIR_IMG_UPLOADS.$this->user->uid."/movies/";

    // only upload the movie if the user is a subscriber
    if ($this->user->isSubscribed())
    {
        // try to upload the file
        $success = $this->startUpload();

        if ($success === TRUE)
        {
            // file uploaded so set the new retval
            $retVal = array('movieName' => $this->uploadFilename);
        }
    }
    else
    {
        // return an error code so user knows this is a limited access feature
        $retVal = array('alert' => '13');
    }

    return $retVal;
}

//-------------------------------------------------------------------------------
//                          Upload Process Methods
//-------------------------------------------------------------------------------

private function startUpload()
{
    // see if there are any errors
    $this->checkForUploadErrors();

    // validate the type received is correct
    $this->checkFileExtension();

    // check the filesize
    $this->checkFileSize();

    // create the directory for the user if it does not exist
    $this->createUserDirectoryIfNotExists();

    // generate a local file name
    $this->createLocalFileName();

    // verify that the file is an uploaded file
    $this->verifyIsUploadedFile();

    // save the image to the appropriate folder
    $success = $this->saveFileToDisk();

    // return TRUE/FALSE
    return $success;
}

private function checkForUploadErrors()
{
    if ($this->file['file']['error'] != 0)
    {
        throw new Exception($this->file['file']['error']);
    }
}

private function checkFileExtension()
{
    if ($this->isImage)
    {
        // check if we are in fact uploading a png image, if not return error
        if (!(in_array($this->fileExtension, $this->allowedExtensions)) || $this->fileType != 'image/png' || exif_imagetype($this->fileTmpName) != IMAGETYPE_PNG)
        {
            throw new Exception('Unsupported image type. The image must be of type png.');
        }
    }
    else if ($this->isMovie)
    {
        // check if we are in fact uploading an accepted movie type
        if (!(in_array($this->fileExtension, $this->allowedExtensions)) || $this->fileType != 'video/mov')
        {
            throw new Exception('Unsupported movie type. Accepted movie types are .mov, .mp4, .mpv, or .3gp');
        }
    }   
}

private function checkFileSize()
{
    if ($this->isImage)
    {
        if($this->fileSize > TenMB)
        {
            throw new Exception('The image filesize must be under 10MB.');
        }
    }
    else if ($this->isMovie)
    {
        if($this->fileSize > TwentyFiveMB) 
        {
            throw new Exception('The movie filesize must be under 25MB.');
        }
    }
}

private function createUserDirectoryIfNotExists()
{
    if (!file_exists($this->uploadDirectory)) 
    {
        mkdir($this->uploadDirectory, 0755, true);
    }
    else
    {
        if ($this->isMovie)
        {
            // clear any prior uploads from the directory (only one movie file per user)
            $this->clearFolder($this->uploadDirectory);
        }
    }
}

private function createLocalFileName()
{
    $now = time();

    // try to create a unique filename for this users file
    while(file_exists($this->uploadFilename = $now.'-'.$this->uid.'.'.$this->fileExtension))
    {
        $now++;
    }

    // create our full file save path
    $this->saveFilePath = $this->uploadDirectory.$this->uploadFilename;
}

private function clearFolder($path)
{
    if(is_file($path))
    {
        // if there's already a file with this name clear it first
        return @unlink($path);
    }
    elseif(is_dir($path))
    {
        // if it's a directory, clear it's contents
        $scan = glob(rtrim($path,'/').'/*');
        foreach($scan as $index=>$npath)
        {
            $this->clearFolder($npath);
            @rmdir($npath);
        }
    }
}

private function verifyIsUploadedFile()
{
    if (! is_uploaded_file($this->file['file']['tmp_name']))
    {
        throw new Exception('The file failed to upload.');
    }
}

private function saveFileToDisk()
{
    if (move_uploaded_file($this->file['file']['tmp_name'], $this->saveFilePath))
    {
        return TRUE;     
    }

    throw new Exception('File failed to upload. Please retry.');
}

}

?> 
```

这是一些示例代码，演示了如何使用上传类...

```
// get a reference to your user object if applicable
$myUser = $this->someMethodThatFetchesUserWithId($myUserId);

// get reference to file to upload
$myFile = isset($_FILES) ? $_FILES : NULL;

// use try catch to return an error for any exceptions thrown in the upload script
try 
{
    // create and setup upload class
    $upload = new upload($myFile, $myUser);

    // trigger file upload
    $data   = $upload->image();     // if uploading an image
    $data  = $upload->movie();      // if uploading movie

    // return any status messages as json string
    echo json_encode($data);
} 
catch (Exception $exception) 
{
    $retData = array(
            'status'    => 'FALSE',
            'payload'   => array(
                            'errorMsg' => $exception->getMessage()
                            ),
                );

    echo json_encode($retData);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-02T11:32:26.100

我为[github上的 Mobile-AppSales 应用程序制作了一种轻量级备份方法](http://github.com/epatel/AppSales-Mobile)

我在这里写了[http://memention.com/blog/2009/11/22/Lightweight-backup.html](http://memention.com/blog/2009/11/22/Lightweight-backup.html)

在里面找`- (void)startUpload`方法`ReportManager.m`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-23T16:54:04.573

@Brandon 的答案的更新，概括为一种方法

```
- (NSString*) postToUrl:(NSString*)urlString data:(NSData*)dataToSend withFilename:(NSString*)filename
{
    NSMutableURLRequest *request= [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];
    NSString *boundary = @"---------------------------14737809831466499882746641449";
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];
    NSMutableData *postbody = [NSMutableData data];
    [postbody appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [postbody appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"%@\"\r\n", filename] dataUsingEncoding:NSUTF8StringEncoding]];
    [postbody appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
    [postbody appendData:[NSData dataWithData:dataToSend]];
    [postbody appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [request setHTTPBody:postbody];

    NSError* error;
    NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:&error];
    if (returnData) {
        return [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
    }
    else {
        return nil;
    }
} 
```

像这样调用，从字符串发送数据：

```
[self postToUrl:@"<#Your url string#>"
           data:[@"<#Your string to send#>" dataUsingEncoding:NSUTF8StringEncoding]
   withFilename:@"<#Filename to post with#>"]; 
```

# java - 如何在 JPAQL 中转义 SQL 关键字

> ID：936860
> 
> 赞同：1
> 
> 时间：2009-06-01T21:25:09.503
> 
> 标签：java, sql, jpa, escaping, keyword

我想在我的 JPA 设置中有一个名为“GROUP”的实体。现在，当我尝试执行 JPA 查询时遇到问题，例如“从 Group group_ 中选择 count(group_.id)”。

JPA 认为这是一次错误的 GROUP BY 尝试并抱怨。有没有办法可以逃脱“组”，或者我必须重命名我的表？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:30:29.760

**请不要这样做！**

将您的表格重命名为其他名称，从长远来看，您会感谢我的。不要对表名或列名使用任何保留字！

将其命名为 EmployeeGroup、JobGroup 或 ObjectGroup 等...

# asp.net - 使用 ASP.NET 3.5 验证的电子邮件格式验证的最佳正则表达式

> ID：936870
> 
> 赞同：8
> 
> 时间：2009-06-01T21:26:02.437
> 
> 标签：asp.net, regex

我已使用以下两个正则表达式来测试具有 ASP.NET 验证控件的有效电子邮件表达式。我想知道从性能的角度来看哪种表达方式更好，或者是否有人有更好的表达方式。

```
- \w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*
 - ^([0-9a-zA-Z]([-\.\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\w]*[ 0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$

```

我正在尝试避免[BCL 团队博客](https://web.archive.org/web/20140422045050/http://blogs.msdn.com/b/bclteam/archive/2005/02/10/370690.aspx)上描述的“指数缓慢表达”问题。

**更新**

根据反馈，我最终创建了一个函数来测试电子邮件是否有效：

```
Public Function IsValidEmail(ByVal emailString As String, Optional ByVal isRequired As Boolean = False) As Boolean
    Dim emailSplit As String()
    Dim isValid As Boolean = True
    Dim localPart As String = String.Empty
    Dim domainPart As String = String.Empty
    Dim domainSplit As String()
    Dim tld As String

    If emailString.Length >= 80 Then
        isValid = False
    ElseIf emailString.Length > 0 And emailString.Length < 6 Then
        'Email is too short
        isValid = False
    ElseIf emailString.Length > 0 Then
        'Email is optional, only test value if provided
        emailSplit = emailString.Split(CChar("@"))

        If emailSplit.Count <> 2 Then
            'Only 1 @ should exist
            isValid = False
        Else
            localPart = emailSplit(0)
            domainPart = emailSplit(1)
        End If

        If isValid = False OrElse domainPart.Contains(".") = False Then
            'Needs at least 1 period after @
            isValid = False
        Else
            'Test Local-Part Length and Characters
            If localPart.Length > 64 OrElse ValidateString(localPart, ValidateTests.EmailLocalPartSafeChars) = False OrElse _
               localPart.StartsWith(".") OrElse localPart.EndsWith(".") OrElse localPart.Contains("..") Then
                isValid = False
            End If

            'Validate Domain Name Portion of email address
            If isValid = False OrElse _
               ValidateString(domainPart, ValidateTests.HostNameChars) = False OrElse _
               domainPart.StartsWith("-") OrElse domainPart.StartsWith(".") OrElse domainPart.Contains("..") Then
                isValid = False
            Else
                domainSplit = domainPart.Split(CChar("."))
                tld = domainSplit(UBound(domainSplit))

                ' Top Level Domains must be at least two characters
                If tld.Length < 2 Then
                    isValid = False
                End If
            End If
        End If
    Else
        'If no value is passed review if required
        If isRequired = True Then
            isValid = False
        Else
            isValid = True
        End If
    End If

    Return isValid
End Function 
```

笔记：

*   IsValidEmail 对允许的字符比 RFC 更严格，但它不会测试这些字符的所有可能的无效使用

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-02T05:53:22.917

如果您想知道为什么这个问题会产生如此少的活动，那是因为在您开始考虑性能之前还有很多其他问题需要处理。其中最重要的是您是否应该使用正则表达式来验证电子邮件地址——而共识是您不应该这样做。这比大多数人预期的要棘手得多，而且可能毫无意义。

另一个问题是您的两个正则表达式在它们可以匹配的字符串类型上差别很大。例如，第二个锚定在两端，但第一个没有；它将匹配“ `>>>>foo@bar.com<<<<`”，因为其中嵌入了一些看起来像电子邮件地址的东西。也许框架会强制正则表达式匹配整个字符串，但如果是这种情况，为什么要锚定第二个？

另一个区别是第一个正则表达式在所有地方都使用`\w`，而第二个`[0-9a-zA-Z]`在很多地方都使用。在大多数正则表达式风格中，`\w`除了字母和数字之外，还匹配下划线，但在某些（包括 .NET）中，它还匹配来自 Unicode 已知的每个书写系统的字母和数字。

还有许多其他差异，但那是学术上的；这些正则表达式都不是很好。有关该主题的良好讨论以及更好的正则表达式，请参见[此处。](http://www.regular-expressions.info/email.html)

回到最初的问题，我没有看到这两个正则表达式的*性能*问题。除了该 BCL 博客条目中引用的嵌套量词反模式之外，您还应该注意正则表达式的两个或多个相邻部分可以匹配同一组字符的情况——例如，

```
([A-Za-z]+|\w+)@ 
```

您发布的任何一个正则表达式中都没有类似的东西。由量词控制的部分总是被其他未被量化的部分分解。两个正则表达式都会经历一些可以避免的回溯，但是有很多比性能更好的理由来拒绝它们。

编辑：所以第二个正则表达式*会*遭受灾难性的回溯；我应该在开枪之前彻底测试它。仔细看看那个正则表达式，我不明白为什么你需要在第一部分使用外部星号：

```
[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])* 
```

该位所做的只是确保第一个和最后一个字符是字母数字，同时允许在它们之间添加一些额外的字符。这个版本做同样的事情，但是当无法匹配时它会更快地失败：

```
[0-9a-zA-Z][-.\w]*[0-9a-zA-Z] 
```

这可能足以消除回溯问题，但您也可以通过使用原子组使“@”之后的部分更有效：

```
(?>(?:[0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+)[a-zA-Z]{2,9} 
```

换句话说，如果您已经将所有看起来像域组件的子字符串与尾随点相匹配，并且下一部分看起来不像 TLD，则不要费心回溯。你必须放弃的第一个字符是最后一个点，你知道`[a-zA-Z]{2,9}`不会匹配。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-06-22T20:58:31.550

我们使用这个 RegEx，它已经针对 150 万个地址进行了内部测试。它比我们的 98% 都正确识别，但我知道有些格式会出错。

```
^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$ 
```

我们还确保数据中没有 EOL 字符，因为 EOL 可以伪造此 RegEx。我们的职能：

```
Public Function IsValidEmail(ByVal strEmail As String) As Boolean
    ' Check An eMail Address To Ensure That It Is Valid
    Const cValidEmail = "^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$"   ' 98% Of All Valid eMail Addresses
    IsValidEmail = False
    ' Take Care Of Blanks, Nulls & EOLs
    strEmail = Replace(Replace(Trim$(strEmail & " "), vbCr, ""), vbLf, "")
    ' Blank eMail Is Invalid
    If strEmail = "" Then Exit Function
    ' RegEx Test The eMail Address
    Dim regEx As New System.Text.RegularExpressions.Regex(cValidEmail)
    IsValidEmail = regEx.IsMatch(strEmail)
End Function 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T16:03:49.803

我是一个新手，但我尝试了以下操作，它似乎将“.xxx”限制为在符号“@”之后仅出现两次或更少。

```
^([a-zA-Z0-9]+[a-zA-Z0-9._%-]*@(?:[a-zA-Z0-9-])+(\.+[a-zA-Z]{2,4}){1,2})$ 
```

注意：当我在 R 中使用这个 reg expr 时，我必须用双 '\\' 替换单个 '\'。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-11T19:11:27.460

这些不会根据[电子邮件地址 RFC](http://en.wikipedia.org/wiki/E-mail_address#RFC_specification)检查所有允许的电子邮件地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-25T21:37:22.777

我让 MS 为我做这项工作：

```
Public Function IsValidEmail(ByVal emailString As String) As Boolean
    Dim retval As Boolean = True
    Try
        Dim address As New System.Net.Mail.MailAddress(emailString)
    Catch ex As Exception
        retval = False
    End Try
    Return retval
End Function 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-22T23:34:35.580

对于服务器端验证，我发现 Phil Haack 的解决方案是更好的解决方案之一。他的尝试是坚持 RFC：

```
string pattern = @"^(?!\.)(""([^""\r\\]|\\[""\r\\])*""|"
            + @"([-a-z0-9!#$%&'*+/=?^_`{|}~]|(?<!\.)\.)*)(?<!\.)"
            + @"@[a-z0-9][\w\.-]*[a-z0-9]\.[a-z][a-z\.]*[a-z]$";

Regex regex = new Regex(pattern, RegexOptions.IgnoreCase);
return regex.IsMatch(emailAddress); 
```

详情： [http ://blog.degree.no/2013/01/email-validation-finally-a-net-regular-expression-that-works/](http://blog.degree.no/2013/01/email-validation-finally-a-net-regular-expression-that-works/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T21:29:49.697

只是为了贡献，我正在使用这个正则表达式。

```
^([a-zA-Z0-9]+[a-zA-Z0-9._%-]*@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4})$ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-13T18:34:23.193

关于它的事情是规范随着每个引入的域扩展而变化。

你坐在这里修改你的正则表达式、测试、测试、测试和更多测试。你终于得到了你“认为”的东西是准确的，然后规范发生了变化......你更新你的正则表达式来解释新的要求是什么......

然后有人输入 aa@aa.aa，而你做了所有这些工作是为了什么？它会遍历您花哨的正则表达式..真可惜！

您也可以只检查一个 @ 和一个“。” 继续前进。我向您保证，如果他们不想放弃，您将不会收到某人的电子邮件。您会收到垃圾邮件或他们的 hotmail 帐户，他们从不检查，也不在乎。

我在很多情况下都看到这是非常糟糕的错误，客户打电话来是因为他们自己的电子邮件地址由于制作不当的正则表达式检查而被拒绝。如前所述，甚至不应该尝试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-12-22T09:00:03.643

文本框 ：-

```
<asp:TextBox ID="txtemail" runat="server" CssClass="form-control pantxt" Placeholder="Enter Email Address"></asp:TextBox> 
```

必需的归档验证器：

```
<asp:RequiredFieldValidator ID="RequiredFieldValidator9" runat="server" ControlToValidate="txtemail" ErrorMessage="Required"></asp:RequiredFieldValidator> 
```

电子邮件验证的正则表达式：

```
<asp:RegularExpressionValidator ID="validateemail" runat="server" ControlToValidate="txtemail" ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" ErrorMessage="Invalid Email"></asp:RegularExpressionValidator> 
```

在 asp.net 中使用此正则表达式进行电子邮件验证

# php - 如何从具有变量的类中调用方法？

> ID：936875
> 
> 赞同：2
> 
> 时间：2009-06-01T21:27:36.537
> 
> 标签：php, oop, variable-variables

给定这个类：

```
class Tacobell{

    public function order_taco(){
        echo "3 Tacos, thank you.";
    }

    public function order_burrito(){
        echo "Cheesy bean and rice, please";
    }

}

$lunch = new Tacobell;
$lunch->order_burrito();
$lunch->order_taco(); 
```

我该怎么做这样的事情？

```
$myOrder = 'burrito';
$lunch->order_.$myOrder; 
```

显然，该代码是废话——但显示了我正在尝试做的事情，而不是试图解释它。

也许我在做这一切都是错的。我想到了一个带有 switch 语句的方法，传入 burrito 或 taco，然后从那里调用正确的方法。但是我必须从头知道结束，我可能有很多方法，我宁愿不必每次都更新 switch 语句。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T21:50:40.017

这样的事情怎么样？

```
class Tacobell {
    public function order_burrito() {
         echo "Bladibla.\n";
    }

    public function order($item) {
        if (method_exists($this, "order_$item")) {
            $this->{'order_' . $item}();
        } else {
            echo "Go away, we don't serve $item here.\n";
        }
    }
} 
```

您可以使用 $lunch->order('burrito'); 来调用它，这对我来说看起来更干净。它将所有丑陋的东西都放在了 Tacobell::order 方法中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T21:29:12.803

```
$lunch->{'order_' . $myOrder}(); 
```

我同意这个设计有点不确定，但至少是这样做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T21:34:23.823

我认为`call_user_func`这是您正在寻找的：

[http://us3.php.net/call_user_func](http://us3.php.net/call_user_func)

您可以将您建议的字符串传递给它。有关调用类的方法，请参见示例 #3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T00:01:17.147

足够简单

```
$order = 'order_burrito';
$lunch->$order(); 
```

# asp.net - 通过 ASP.NET 在 Web 上对 Word 文档进行富文本编辑

> ID：936883
> 
> 赞同：2
> 
> 时间：2009-06-01T21:28:41.853
> 
> 标签：asp.net, parsing, ms-word, richedit

我的用户将 Word 2007 文档上传到我们的网站，我想将它们加载到某种富编辑控件中，以便用户可以进行修改/评论等。

哪些机制可用于：

*   通过 ASP.NET 加载 Word 文档，以及
*   在丰富的编辑控件中解析/格式化/显示文档？

另外，在这种情况下，最好使用哪种丰富的编辑控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T22:04:04.730

我相信 Telerik 的 Rad 编辑器支持从单词粘贴的功能。

**从网站：**

从 Word 粘贴的七种方法

Telerik ASP.NET 编辑器提供了许多功能，可帮助用户从 Microsoft Word 和其他应用程序粘贴格式化内容，并应用不同类型的格式剥离：

1.  Strip Word-formatting on paste Strip
2.  粘贴时的文字格式（清理字体和大小）
3.  强制格式
4.  剥离粘贴文字内容
5.  剪贴板拦截带
6.  粘贴后的文字格式 粘贴
7.  纯文本粘贴为 HTML

[这是演示](http://demos.telerik.com/aspnet-ajax/editor/examples/cleaningwordformatting/defaultcs.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-11T03:43:50.793

试试 TEEdit。它非常适合 doc 和 docx 文件。也允许保存和打开按钮...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-11T04:13:58.537

对于显示 Word 文档，这是一个结合 Silverlight 和 OpenXML 的有趣项目，值得一看 [http://openxmldeveloper.org/articles/TextGlow.aspx](http://openxmldeveloper.org/articles/TextGlow.aspx)

对于编辑，它会更复杂。目前有[CKEditor](http://ckeditor.com/)，[TinyMCE](http://tinymce.moxiecode.com/)等编辑器，但它们主要用于编辑富文本，但在处理具有非常丰富的页面布局和设备绑定的 word 等文档时并不自然。

# jakarta-ee - ColdFusion 日志记录重新路由到 Log4J

> ID：936889
> 
> 赞同：0
> 
> 时间：2009-06-01T21:29:56.953
> 
> 标签：jakarta-ee, logging, coldfusion, jboss, apache-commons-logging

我目前在 J2EE 环境 (JBoss) 中使用 ColdFusion 8.01，并希望清理写入日志的内容。目前 ColdFusion 将所有内容记录到 STDOUT，而不是使用像 commons 或 log4j 这样的适当记录器。有没有人设法改变这一点？也许您可以设置一些隐藏的属性，或者将 log4j.properties 隐藏在某个位置。由于 ColdFusion 具有 CFLog（输出到 STDOUT），因此我希望尽可能通过 commons 查看该输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T00:38:14.243

嘿 Daniel - CF 实际上确实使用 log4j 作为它的内部日志记录，并且如果你不喜欢它默认的逗号分隔模式，它有一个配置可以让你编辑布局模式。

您可以在“neo-logger.xml”中编辑模式，

```
{your_deployment}/cfusion-war/WEB-INF/cfusion/lib/neo-logger.xml 
```

不幸的是，您可以编辑的其他属性并不多。您也许可以覆盖同一目录下“logger.xml”文件中的根记录器设置，我没有任何运气尝试。在过去，我用它来定义我们用 CF 加载的自定义和第三方 jar 的 log4j 设置。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:16:58.370

我们将 log4j 与 CF 8 一起使用，效果很好。但是，我们使用的是独立配置。不知道这是否会有很大帮助，但无论如何你都去了......

您需要做的就是将`log4j.jar`文件放入 CF`lib`目录或存储在 CF 类路径中适合您的任何其他目录。完成此重启 CF 后，您通常可以执行以下操作：

```
<!--- Create logger --->
<cfset objLoggerCategory = CreateObject("java", "org.apache.log4j.Category") />
<cfset objLogger = objLoggerCategory.getInstance("MY-LOGGER-XML-HOOK") />
<cfset objLogger.debug("Hello World!") /> 
```

显然，您需要配置 Xml 文件，但网上有很多这样的例子。

我还没有重写 CF 日志以通过 log4j 运行。也就是说，如果这有帮助，您可以将 CF 日志定向到您喜欢的任何目录。这在 CF 管理员中可用：调试和日志记录 > 日志记录设置。

干杯。

# c# - 有人能解释一下这个有趣的 ASP.NET HTTP 管道事件行为吗？

> ID：936901
> 
> 赞同：0
> 
> 时间：2009-06-01T21:31:39.477
> 
> 标签：c#, events

很明显，每次刷新页面时，ASP.NET 页面的成员变量都应该失去作用域。

我有以下代码来显示具有编辑功能的“警报”网格：

```
public partial class Alerts : System.Web.UI.Page
{
    private _WikiSyntaxEngine;

    protected void Page_Load(object sender, EventArgs e)
    {
        _WikiSyntaxEngine = new WikiSyntaxEngine();
    }

    protected void gvAlerts_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        var alert = (DataModel.Alert)(e.Row.DataItem);
        // Below is the only line of interest, because only when published
        // to the server would it throw an exception...
        string html = _WikiSyntaxEngine.ConvertWikiTextToHTML(alert.Description);
    }
} 
```

仅在我发布的开发服务器上，此代码在更新行期间失败（即抛出`NullReferenceException`因为`_WikiSyntaxEngine`is ）。`null`

但是，在我的本地机器上，代码运行得很好——行已更新，网格按预期刷新。

从那以后，我已经修复了代码以制作`WikiSyntaxEngine`单例，或者它应该从一开始就设计的方式，因为它不应该在使用它的任何地方都被实例化。

那么我的问题是，如何在我的本地机器上`Page_Load`调用事件`gvAlerts_Databound()`（如预期的那样），而不是在开发机器上调用导致`NullReferenceException`for `_WikiSyntaxEngine`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T02:20:31.000

我假设您的`gvAlerts`GridView 是在页面的 ASP.NET 标记中定义的。如果是这种情况，它可能是事件中的 DataBound `OnInit()`，而不是`Page_Load()`你正在实例化的`WikiSyntaxEngine`。

如果您的 GridView 之前被绑定，您可能应该使用它`OnInit()`来实例化您的。`WikiSyntaxEngine``Page_Load`

至于为什么你在开发和生产中会有不同的行为对我来说仍然是一个谜。

# sql-server - VSTS 数据库版 GDR R2 项目中的哪些文件应从源代码管理中排除？

> ID：936902
> 
> 赞同：6
> 
> 时间：2009-06-01T21:32:33.593
> 
> 标签：sql-server, visual-studio-2008, sql-server-2008, visual-studio-dbpro

我正准备设置一个带有源代码控制的 Visual Studio 数据库版 GDR R2 项目。哪些文件（如果有）应该从源代码管理中排除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T22:00:29.027

这就是我最终得到的。

```
[Bb]in
[Dd]ebug
obj
[Rr]elease
*.aps
*.dbmdl
*.eto
*.ncb
*.suo
*.user
_ReSharper.* 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:38:36.997

我排除的文件/目录是：

```
/obj
/bin
/sql
/*.dbmdl 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-24T20:06:36.223

我还排除了解决方案文件夹中的 .suo 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-09T13:55:19.377

我也避免使用 .dbschema 文件

# python - 为什么“**”比否定绑定更紧密？

> ID：936904
> 
> 赞同：10
> 
> 时间：2009-06-01T21:33:07.773
> 
> 标签：python, operator-precedence

我只是被以下场景咬了一口：

```
>>> -1 ** 2
-1 
```

现在，深入研究 Python 文档，[很明显这是预期的行为](http://docs.python.org/reference/expressions.html#the-power-operator)，但*为什么呢？* 我不使用任何其他具有内置运算符功能的语言，但是没有尽可能紧密地绑定一元否定对我来说似乎是危险的违反直觉的。

这样做是有原因的吗？其他具有幂运算符的语言是否也有类似的行为？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-01T21:37:53.410

这种行为与数学公式中的行为相同，所以我不确定问题是什么，或者为什么它是违反直觉的。你能解释一下你在哪里看到了不同的东西吗？“**”总是绑定多于“-”：-x^2 与 (-x)^2 不同

只需使用 (-1) ** 2，就像您在数学中所做的那样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T21:43:36.643

简短的回答：这是数学中优先级的标准方式。

假设我想评估多项式 3x **3 - x** 2 + 5。

```
def polynomial(x):
    return 3*x**3 - x**2 + 5 
```

它看起来比...

```
def polynomial
    return 3*x**3 - (x**2) + 5 
```

第一种方法是数学家的做法。其他具有幂运算的语言以相同的方式工作。请注意，否定运算符的绑定也比乘法更松散，因此

```
-x*y === -(x*y) 
```

这也是他们在数学中的做法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T21:39:32.067

如果我不得不猜测，那将是因为拥有一个指数运算符可以让程序员轻松地将数字提高到分数幂。负数的分数次幂最终会得到一个虚数分量（通常），因此可以通过将 ** 比一元 - 更紧密地绑定来避免这种情况。大多数语言不喜欢虚数。

最终，当然，这只是一个约定——为了让你的代码对你自己和其他人都可读，你可能想要明确地对你的 (-1) 进行分组，这样其他人就不会被同一个陷阱抓住:) 好运气！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:48:41.797

这对我来说似乎很直观。

拳头，因为它符合数学符号：-2^2 = -4。

其次，运算符**很早以前就被FORTRAN广泛引入。在 FORTRAN 中，-2**2 也是 -4。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-01T21:44:37.140

Ocaml 不做同样的事情

```
# -12.0**2.0
  ;;
- : float = 144. 
```

这有点奇怪...

```
# -12.0**0.5;;
- : float = nan 
```

不过看看那个链接...... [操作顺序](http://en.wikipedia.org/wiki/Order_of_operations)

# .net - .Net：DateRange 无法转换为“日期”类型

> ID：936911
> 
> 赞同：0
> 
> 时间：2009-06-01T21:34:08.177
> 
> 标签：.net

[链接文本](http://forums.asp.net/p/714292/714628.aspx#714628)

我有同样的问题。我的日期格式是 MM/dd/yyyy。如何在我的系统中找出日期格式并用代码更改它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T21:52:08.937

您的问题是您在 aspx 文件中分配日期并期望格式为 mm/dd/yyyy 而它可能是 dd/mm/yyyy 所以它正在爆炸。您是否正在部署到使用不同日期格式的系统？

如果是这样，可以通过代码手动添加范围，并使用期望日期对象的预期格式分配它们。

例如。

```
YourDateValidator.MaximumValue = YourMaxDateTimeObject;
YourDateValidator.MinimumValue = YourMinDateTimeObject; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T21:46:02.053

如果它是一个日期对象，那么您只需要使用 ToString 方法对其进行格式化。

[http://msdn.microsoft.com/en-us/library/system.datetime.tostring.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.tostring.aspx)

代码示例：

```
using System;

public class DateToStringExample
{
   public static void Main()
   {
      DateTime dateValue = new DateTime(2008, 6, 15, 21, 15, 07);
      // Create an array of standard format strings.
      string[] standardFmts = {"d", "D", "f", "F", "g", "G", "m", "o", 
                               "R", "s", "t", "T", "u", "U", "y"};
      // Output date and time using each standard format string.
      foreach (string standardFmt in standardFmts)
         Console.WriteLine("{0}: {1}", standardFmt, 
                           dateValue.ToString(standardFmt));
      Console.WriteLine();

      // Create an array of some custom format strings.
      string[] customFmts = {"h:mm:ss.ff t", "d MMM yyyy", "HH:mm:ss.f", 
                             "dd MMM HH:mm:ss", @"\Mon\t\h\: M", "HH:mm:ss.ffffzzz" };
      // Output date and time using each custom format string.
      foreach (string customFmt in customFmts)
         Console.WriteLine("'{0}': {1}", customFmt,
                           dateValue.ToString(customFmt));
   }
}
// This example displays the following output to the console:
//       d: 6/15/2008
//       D: Sunday, June 15, 2008
//       f: Sunday, June 15, 2008 9:15 PM
//       F: Sunday, June 15, 2008 9:15:07 PM
//       g: 6/15/2008 9:15 PM
//       G: 6/15/2008 9:15:07 PM
//       m: June 15
//       o: 2008-06-15T21:15:07.0000000
//       R: Sun, 15 Jun 2008 21:15:07 GMT
//       s: 2008-06-15T21:15:07
//       t: 9:15 PM
//       T: 9:15:07 PM
//       u: 2008-06-15 21:15:07Z
//       U: Monday, June 16, 2008 4:15:07 AM
//       y: June, 2008
//       
//       'h:mm:ss.ff t': 9:15:07.00 P
//       'd MMM yyyy': 15 Jun 2008
//       'HH:mm:ss.f': 21:15:07.0
//       'dd MMM HH:mm:ss': 15 Jun 21:15:07
//       '\Mon\t\h\: M': Month: 6
//       'HH:mm:ss.ffffzzz': 21:15:07.0000-07:00 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T00:24:14.293

您应该为[当前线程](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentculture.aspx)设置适当的区域性。DateTime.Parse 使用来自当前线程文化的日期设置（顺便说一句，[我爱你，Reflector！](http://www.red-gate.com/products/reflector/)）：

```
public static DateTime Parse(string s)
{
    return DateTimeParse.Parse(s, DateTimeFormatInfo.CurrentInfo, DateTimeStyles.None);
} 
```

其中“DateTimeFormatInfo.CurrentInfo”是：

```
public static DateTimeFormatInfo CurrentInfo
{
    get
    {
        CultureInfo currentCulture = Thread.CurrentThread.CurrentCulture;
        if (!currentCulture.m_isInherited)
        {
            DateTimeFormatInfo dateTimeInfo = currentCulture.dateTimeInfo;
            if (dateTimeInfo != null)
            {
                return dateTimeInfo;
            }
        }
        return (DateTimeFormatInfo) currentCulture.GetFormat(typeof(DateTimeFormatInfo));
    }
} 
```

有很多关于全球化的方法，只需尝试搜索它们（[这种方法的示例](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx):)）

# oracle - 菜鸟 Oracle 变量问题

> ID：936914
> 
> 赞同：0
> 
> 时间：2009-06-01T21:34:27.473
> 
> 标签：oracle, plsql

我有一个在 SQL Server 中完美运行的简单 SQL 语句：

```
DECLARE @ID VARCHAR(10)
SET @ID = '12345'

SELECT *
FROM theTable 
WHERE ID = @ID 
```

有人可以告诉我如何在 Oracle 中做这个非常基本的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:48:43.450

您可以使用 SQL*Plus 界面（命令行中的 sqlplus）执行类似的操作：

```
variable asdf number;
exec :asdf := 10;
select :asdf from dual; 
```

问候 K

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T22:02:55.467

在 SQL*Plus 中几乎相同：

```
SQL> create table thetable (id) as select '01234' from dual union all select '12345' from dual
  2  /

Table created.

SQL> var id varchar2(10)
SQL> exec :id := '12345'

PL/SQL procedure successfully completed.

SQL> select *
  2  from theTable
  3  where id = :id
  4  /

ID
-----
12345

1 row selected. 
```

或在 PL/SQL 中：

```
SQL> declare
  2    l_id varchar2(10) := '12345';
  3    r thetable%rowtype;
  4  begin
  5    select *
  6      into r
  7      from thetable
  8     where id = l_id
  9    ;
 10    dbms_output.put_line(r.id);
 11  end;
 12  /
12345

PL/SQL procedure successfully completed. 
```

问候，罗布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T22:16:09.213

如果您的目标是在脚本顶部设置变量，也许这就是您的解决方案？

```
with IDS as (
    select 1234 from dual
    union all
    select 1235 from dual
)

select * from TABLE where TABLE.ID in (select * from IDS) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T21:41:17.867

不幸的是，没有简单的方法。

您必须在一个块中声明它（我认为它可能必须是一个存储过程，或者至少在一个块中）。然而，这只是问题的一部分。一旦它在一个块中，结果就不再“溢出”到控制台窗口。因此，您必须使用游标，将行信息复制到数组中，然后使用 DMBS_OUTPUT 逐步打印数组中的值。

很容易让你回到 MSSQL。

（Mark Harrison 的注释）这个答案不正确......请参阅您的代码的 oracle 版本的其他答案。

# php - 有没有一种简单的方法可以从 php 中的 SQL 时间戳获取 Unix 时间戳？

> ID：936917
> 
> 赞同：1
> 
> 时间：2009-06-01T21:35:20.763
> 
> 标签：php, sql, mysql, timestamp

我的数据库表有一列包含 SQL 时间戳（例如 2009-05-30 19:43:41）。我的 php 程序中需要等效的 Unix 时间戳（一个整数）。

```
$posts = mysql_query("SELECT * FROM Posts ORDER BY Created DESC");
$array = mysql_fetch_array($posts);
echo $array[Created]; 
```

现在它与 SQL 时间戳相呼应，我想要一个 Unix 时间戳。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T21:36:47.063

[`strtotime()`](http://www.php.net/strtotime)会很高兴地获取一个 SQL 时间戳并将其转换为 UNIX 时间：

```
echo strtotime($array['Created']); 
```

请注意，不要在数组键周围使用引号是不好的做法。[根据文档](http://us.php.net/types.array)：

> 始终在字符串文字数组索引周围使用引号。例如，$foo['bar'] 是正确的，而 $foo[bar] 不是。
> 
> 这是错误的，但它有效。原因是这段代码有一个未定义的常量（bar）而不是字符串（'bar' - 注意引号）。PHP 将来可能会定义常量，不幸的是，对于此类代码，这些常量具有相同的名称。它之所以起作用，是因为 PHP 会自动将一个裸字符串（一个不与任何已知符号对应的未加引号的字符串）转换为包含该裸字符串的字符串。例如，如果没有定义名为 bar 的常量，那么 PHP 将替换字符串 'bar' 并使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T21:57:03.263

给定一个常规的日期时间字段，您可以使用 MySQL 函数[UNIX_TIMESTAMP](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_unix-timestamp) () 在查询中执行此操作：

```
$posts = mysql_query("SELECT *
                             , UNIX_TIMESTAMP(Created)
                      FROM     Posts
                      ORDER BY Created DESC"); 
```

您还应该知道 PHP 函数[mysql_fetch_array](http://php.net/mysql_fetch_array)为查询结果返回两个数字关联键。我觉得这是多余的，所以我喜欢更具体并使用：

```
$array = mysql_fetch_array($posts, MYSQL_ASSOC); 
```

此外，正如@Paolo Bergantino 所指出的，引用您的回声将是一个不错的决定：

```
echo $array['Created']; 
```

最后一条评论，您使用的是“SELECT *”——[值得一读关于“SELECT *”语法优缺点的讨论](https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select)。

# iphone - UIWebView 没有完成加载

> ID：936920
> 
> 赞同：0
> 
> 时间：2009-06-01T21:36:37.437
> 
> 标签：iphone, uiwebview

我已经将一个视图推送到包含 UIWebView 的导航控制器上，这将加载一个 URL。

当它启动时，我启动 networkActivityIndi​​catorVisible，当它完成时，我将其隐藏。

如果用户决定他不想完成加载网页并返回导航控制器，则网络指示器会继续。我该如何摆脱它，因为似乎没有为此的委托方法，并且没有任何 viewdidUnload 被触发....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T05:08:27.627

在 UIWebView 的 ViewController 的 viewWillDisappear: 方法中，执行此操作

```
if([yourWebView isLoading]){
  //hide your network activity indicator
  [yourWebView stopLoading];
} 
```

希望有帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-25T12:10:10.403

我为加载过程做了一个简单的引用计数解决方案：

```
-(void)webViewDidStartLoad:(UIWebView *)webView {

    if (_loadRef == 0) {
        [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];
    }

    _loadRef++;
}

-(void)webViewDidFinishLoad:(UIWebView *)webView {

    _loadRef--;

    if (_loadRef == 0) {
        [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T00:28:27.233

如何让活动指示器在前一个控制器的 viewWillAppear:(BOOL)animated 中不可见？

# c# - C#：在泛型类中添加条件泛型方法（不同的泛型限制）

> ID：936921
> 
> 赞同：4
> 
> 时间：2009-06-01T21:36:46.940
> 
> 标签：c#, linq

我正在尝试对泛型类中的方法添加另一个限制。这可能吗？

伪代码：

 `````
public class MyBaseClass<T> where T: class
{
    public IQueryable<T> ShowThisMethod where T: class, IMyInterface
    {
         // stuff.
    }
} 
````  `ShowThisMethod 应该仅在 T 为 IMyInterface 时可用。然后 IMyInterface 应该返回信息（关于 T），以便我可以访问方法内部 IMyInterface 中定义的属性。

帮助 ：）

**顺便说一句，这编译**（并且似乎“几乎正确”）：

 `````
public class MyBaseClass<T> where T: class
{
    public IQueryable<T> ShowThisMethod<T>() where T: class, IMyInterface
    {
        String X = T.MyInterfaceStringProperty;
    }
} 
````  `**关于我的目标的更多信息**：

我正在使用通用基类来访问公共属性（LINQ 对象*Dinner*上的 DateTime“时间”属性，它也在*午餐*上）。

这两个对象都实现**了 ITimeable**，它公开了 DateTime 属性。

在我的基类中，我想要一个 Select() 方法，它适用于 IQueryable<T> 并且可以根据 Time 属性自动过滤。因为我正在处理通用 T，所以 time 属性对基类不可见，除非我告诉它 T 正在实现**ITimeable**。

我确实希望相同的基类也适用于其他非 ITimeable 对象，这就是为什么我需要对 Select 方法进行接口限制，并且我还需要它才能使用泛型访问 Time 属性。

希望清除目标:)

**PS我主要担心的是IntelliSense等中方法的可见性**。。我只想保持我的基类正常工作，同时能够通过其中的泛型访问接口指定的属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T21:42:11.030

这取决于你想要什么。

由于该类只编译一次，并且泛型的魔力也依赖于运行时，因此无法创建在某些情况下具有某些方法而在其他情况下具有其他方法的类。方法要么存在，要么不存在。

所以基本上，没有办法声明 MyBaseClass 以便发生以下情况：

```
MyBaseClass<Int32>  bc;
bc. <-- intellisense does not show ShowThisMethod here

MyBaseClass<SomeTypeImplementingIMyInterface> bc2;
bc2\. <-- intellisense DOES show ShowThisMethod here 
```

……那是……本身。

您可以“欺骗”编译器和智能感知为您提供所需的内容，但要知道这会给您带来其他可能需要解决的限制和挑战。

基本上，通过向与 MyBaseClass 一起声明的静态类添加扩展方法，您可以使智能感知和编译器表现得好像该方法仅在您要求的 T 具有某些特定规则时出现在 MyBaseClass 中。

但是，由于所讨论的方法将是在 MyBaseClass 之外定义的静态方法，因此您可以访问的 MyBaseClass 内部有多少是有限的，并且您无法访问 MyBaseClass 内部的方法，所以这取决于您想要什么完成以及您是否可以忍受这些限制。

无论如何，这是扩展方法。请注意，您同时将其从 MyBaseClass 中完全删除：

```
public static class MyBaseClassExtensions
{
    public static IQueryable<T> ShowThisMethod<T>(this MyBaseClass<T> mbc)
        where T: class, IMyInterface
    {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:48:36.807

还要注意 ShowThisMethod 是在 ShowThisMethod 的上下文中*重新定义*T。它与类定义的 T 不同。

指定一个不同的 Type 参数，其中新的 Type 参数继承自该类定义的参数，这将是最好的方法，尽管这最终要求调用者必须指定泛型 Type 两次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T21:39:00.477

不，这是不可能的。约束是在声明时定义的。在这种情况下，**方法不是泛型**，类是（它是泛型类的非泛型方法）。所以约束只能在类本身上声明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:44:48.623

这会做你想要的吗？该方法对任何人都可见，但不一定可用...

```
public class MyBaseClass<T> where T: class
{
    public IQueryable<R> ShowThisMethod() where R: T, IMyInterface
    {
         Debug.Assert(typeof(R) == typeof(T));
         // stuff.
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T22:17:52.737

您可以定义另一个继承 MyBaseClass 的类并重新定义约束：

```
public MyOtherClass<T> : MyBaseClass<T> where T : class, IMyInterface
{
    public IQueryable<T> ShowThisMethod()
    {
        // stuff.
    }
} 
```

# c++ - 如何从 C++ 函数返回多个错误代码

> ID：936928
> 
> 赞同：3
> 
> 时间：2009-06-01T21:38:11.320
> 
> 标签：c++

从 C++ 函数返回成功或一个或多个错误代码的好方法是什么？

我有这个叫做save​​()的成员函数，它保存到每个成员变量中，至少有十个这些成员变量被保存到，对于save()的调用，我想知道调用是否失败，如果是，在哪个成员变量上（有些是硬失败，有些是软失败）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T21:41:19.613

您可以返回具有多个错误字段的对象，也可以使用“out”参数。

你如何做到这一点取决于你的设计以及你想要返回的究竟是什么。一种常见的情况是当您需要报告状态代码以及各种消息时。这有时会在函数返回状态码作为返回值，然后通过“out”参数返回消息状态时完成。

如果您只是返回一组“代码”，那么构造一个结构类型并返回它可能更有意义。在这种情况下，我倾向于将它作为输出参数传入，并让方法在内部更新它，而不是每次都分配一个新参数。

你打算这样做一次还是多次？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T21:47:19.367

我知道这并不能真正回答你的问题，但是......

在 C++ 中，您应该使用异常而不是返回错误代码。错误代码最常用于不想强制库用户使用特定错误处理约定的库，但在 C++ 中，我们已经有了 stdexcept。当然，您不使用异常可能是有原因的，例如您正在编写嵌入式代码或内核扩展。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-01T21:54:18.243

我通常使用`boost::tuple`：

```
typedef boost::tuple<int,int> return_value;

return_value r = my_function();

int first_value = boost::get<0>( r );
int second_valud = boost::get<1>( r ); 
```

编辑

您还可以使用`boost::tie`从元组中提取值：

```
boost::tie( first_value, second_value ) = r; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-01T21:42:27.817

返回两个值的最简单方法是使用 std::pair<> 模板：

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T21:42:52.807

您需要将它们作为输出参数返回：

```
 bool function(int& error1, int& error2, stringx& errorText, int& error3); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-01T21:43:53.447

如果您打算纯粹返回错误状态，我会使用[bitset 。](http://www.cppreference.com/wiki/stl/bitset/start)例如

```
const bitset<10> a_not_set(1);
const bitset<10> b_not_set(2);
const bitset<10> c_not_set(4);

...

bitset<10> foo(T& a, T& b, T& c, ...)
{

    bitset<10> error_code = 0;

    ...

    if ( /* a can't be set */ )
    {
        error_code |= a_not_set;
    }

    ...

    if ( /* b can't be set */ )
    {
        error_code |= b_not_set;
    }

    ...

    // etc etc

    return error_code;
}

bitset<10> err = foo(a, b, c, ... );
if (err && a_not_set)
{
   // Blah.
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T21:44:03.103

您可以使用带有位操作（又名标志）的整数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-01T22:31:25.067

我可能会先尝试抛出异常，但这取决于您的编码范例。请查看一些有关 c++ 异常处理可能更好的原因的书籍或文章。

如果我真的需要坚持重新运行错误代码样式，我会定义一个 eunm 类型来指定位操作的错误。

```
enum error
{
   NO_ERROR = 0,

   MEMBER_0_NOT_SAVED = 1,
   MEMBER_1_NOT_SAVED = 1 << 1,
   MEMBER_2_NOT_SAVED = 1 << 2,
   // etc..

};

int save()
{
    int ret = NO_ERROR;

    // fail to save member_0
    ret  |= MEMBER_0_NOT_SAVED;

    // fail to save member_1
    ret  |= MEMBER_1_NOT_SAVED;

    // ....

    return ret; 
}

int main(void)
{
    int ret = save();
    if( ret == NO_ERROR)
    {
       // good.
    }
    else
    {
        if(ret & MEMBER_0_NOT_SAVED)
        {
              // do something
        }

        if(ret & MEMBER_1_NOT_SAVED)
        {
              // do something
        }

        // check the other errors...
    }
} 
```

这只是一个粗略的例子。最好将它放入一个类或使用命名空间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T21:52:15.003

我不熟悉您项目的内部结构和约束，但如果可能，请尝试使用异常而不是错误代码。

原因在此处列出[，在 C++ FAQ lite](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.1)中，它们的结论是：

> 因此，与通过返回码和 if 报告错误相比，使用 try/catch/throw 可能会导致代码错误更少、开发成本更低、上市时间更快。

# python - BoundedSemaphore 在 KeyboardInterrupt 上的线程中挂起

> ID：936933
> 
> 赞同：2
> 
> 时间：2009-06-01T21:40:35.993
> 
> 标签：python, multithreading

如果在尝试获取信号量时引发 KeyboardInterrupt，则也尝试释放相同信号量对象的线程将无限期挂起。

代码：

```
import threading
import time

def worker(i, sema):
    time.sleep(2)
    print i, "finished"
    sema.release()

sema = threading.BoundedSemaphore(value=5)
threads = []
for x in xrange(100):
    sema.acquire()
    t = threading.Thread(target=worker, args=(x, sema))
    t.start()
    threads.append(t) 
```

启动它，然后 ^C 在它运行时启动。它会挂起并且永远不会退出。

```
0 finished
3 finished
1 finished
2 finished
4 finished
^C5 finished
Traceback (most recent call last):
  File "/tmp/proof.py", line 15, in <module>
    sema.acquire()
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/threading.py", line 290, in acquire
    self.__cond.wait()
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/threading.py", line 214, in wait
    waiter.acquire()
KeyboardInterrupt
6 finished
7 finished
8 finished
9 finished 
```

我怎样才能让它让最后几个线程自然死亡然后正常退出？（如果你不尝试打断它，它会这样做）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T23:52:14.823

您可以使用信号模块设置一个标志，告诉主线程停止处理：

```
import threading
import time
import signal
import sys

sigint = False

def sighandler(num, frame):
  global sigint
  sigint = True

def worker(i, sema):
  time.sleep(2)
  print i, "finished"
  sema.release()

signal.signal(signal.SIGINT, sighandler)
sema = threading.BoundedSemaphore(value=5)
threads = []
for x in xrange(100):
  sema.acquire()
  if sigint:
    sys.exit()
  t = threading.Thread(target=worker, args=(x, sema))
  t.start()
  t.join() 
  threads.append(t) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T20:42:05.440

在您的原始代码中，您还可以创建线程守护程序线程。当您中断脚本时，所有守护线程都会按您的预期死亡。

```
 t = ...
  t.setDaemon(True)
  t.start() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T00:09:46.927

在这种情况下，您可能只想使用线程池来控制线程的启动和停止。您可以通过以下方式使用[Chris Arndt 的线程池库](http://www.chrisarndt.de/projects/threadpool/)：

```
pool = ThreadPool(5)
try:
    # enqueue 100 worker threads
    pool.wait()
except KeyboardInterrupt, k:
    pool.dismiss(5)
    # the program will exit after all running threads are complete 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-24T21:25:42.957

```
# importing modules
import threading
import time
# defining our worker and pass a counter and the semaphore to it
def worker(i, sema):
    time.sleep(2)
    print i, "finished"
    # releasing the thread increments the sema value
    sema.release()

# creating the semaphore object
sema = threading.BoundedSemaphore(value=5)
# a list to store the created threads
threads = []
for x in xrange(100):
 try:
   sema.acquire()
   t = threading.Thread(target=worker, args=(x, sema))
   t.start()
   threads.append(t)
 # exit once the user hit CTRL+c
 # or you can make the thead as daemon t.setdaemon(True)
 except KeyboardInterrupt:
   exit() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-30T22:25:45.843

这是错误[#11714](http://bugs.python.org/issue11714)，并且已在较新版本的 python 中进行了[修补。](http://hg.python.org/cpython/rev/2253b8a18bbf)

如果您使用的是较旧的 python，您可以`Semaphore`将该补丁中找到的版本复制到您的项目中并使用它，而不是依赖于`threading`

# box2d - box2d 碰撞组

> ID：936935
> 
> 赞同：11
> 
> 时间：2009-06-01T21:40:49.550
> 
> 标签：box2d, collision

有谁知道身体是否只在 (body1.categoryBits & body2.maskBits) && (body1.maskBits & body2.categoryBits) 发生碰撞？或者当 (body1.categoryBits & body2.maskBits) || 时它们是否已经发生碰撞？（body1.maskBits & body2.categoryBits）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-07-05T17:55:13.670

如果有人还在寻找更多解释，我在这里做了一个详细的教程：http:
[//aurelienribon.wordpress.com/2011/07/01/box2d-tutorial-collision-filtering/](http://aurelienribon.wordpress.com/2011/07/01/box2d-tutorial-collision-filtering/)

![](https://i.stack.imgur.com/b4nXx.jpg)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-02T01:19:26.630

从 Box2D[手册](http://www.box2d.org/manual.html#d0e845)：

> **6.2.3\. 过滤**
> 
> 碰撞过滤是一种防止形状之间碰撞的系统。例如，假设您制作了一个骑自行车的角色。您希望自行车与地形发生碰撞，角色与地形发生碰撞，但您不希望角色与自行车发生碰撞（因为它们必须重叠）。Box2D 支持使用类别和组进行此类碰撞过滤。
> 
> Box2D 支持 16 种碰撞类别。对于每个形状，您可以指定它属于哪个类别。您还可以指定此形状可以与哪些其他类别发生冲突。例如，您可以在多人游戏中指定所有玩家不相互碰撞，怪物不相互碰撞，但玩家和怪物应该碰撞。这是通过屏蔽位完成的。例如：
> 
> ```
> playerShapeDef.filter.categoryBits = 0x0002;
> monsterShapeDef.filter.categoryBits = 0x0004;
> playerShape.filter.maskBits = 0x0004;
> monsterShapeDef.filter.maskBits = 0x0002; 
> ```
> 
> 碰撞组允许您指定一个完整的组索引。您可以让具有相同组索引的所有形状始终碰撞（正索引）或从不碰撞（负索引）。组索引通常用于以某种方式相关的事物，例如自行车的零件。在下面的示例中，shape1 和 shape2 总是发生碰撞，但 shape3 和 shape4 永远不会发生碰撞。
> 
> ```
> shape1Def.filter.groupIndex = 2;
> shape2Def.filter.groupIndex = 2;
> shape3Def.filter.groupIndex = -8;
> shape4Def.filter.groupIndex = -8; 
> ```
> 
> 根据类别和掩码位过滤不同组索引的形状之间的冲突。换句话说，组过滤比类别过滤具有更高的优先级。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-02-03T10:44:30.317

这就是我理解 maskBits 和 categoryBits 如何工作的方式。假设您有 3 个对象：objectA、objectB 和 objectC。

为每个对象定义一个类别：

objectA.categoryBits = 0x0002;
objectB.categoryBits = 0x0004;
objectC.categoryBits = 0x0008;

然后，设置 maskBits，它定义了每个 categoryBits 的碰撞规则：

-> objectA 与所有人碰撞 (0xFFFF) 和 (&) not(~) objectB (0x0004)
objectA.maskBits = 0xFFFF & ~0x0004;

-> objectB 与 objectA (0x0002) 或 (|) objectC (0x0008) 碰撞，但没有其他人
objectB.maskBits = 0x0002 | 0x0008;

-> objectC 与 objectA (0x0002) 碰撞，但没有其他人
objectC.maskBits = 0x0002;

我不知道这是否正确，但它对我有用。

高温高压

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-18T17:43:43.093

查看Box2d的源码，可以看出如果fixture属于不同的组（或者组为0），那么category和mask比较如下：

```
 bool collide = (filterA.maskBits & filterB.categoryBits) != 0 && 
                   (filterA.categoryBits & filterB.maskBits) != 0; 
```

所以看起来只有当两个灯具的掩码都允许碰撞时，灯具才会发生碰撞。（即：与逻辑）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-23T06:07:13.180

我使用过墙壁和许多玩家（我们的玩家和敌人）。我的玩家和敌人会与墙壁发生碰撞，但不会相互碰撞。我已经这样做了，它奏效了。您必须将 groupIndex 设置为负值，以免对象相互碰撞。像这样定义灯具。

```
 /* The categories. */
public static final short CATEGORYBIT_WALL = 1;
public static final short CATEGORYBIT_PLAYERS = 2;

/* And what should collide with what. */
public static final short MASKBITS_WALL = CATEGORYBIT_WALL + CATEGORYBIT_PLAYERS;

public static final FixtureDef WALL_FIXTURE_DEF = PhysicsFactory.createFixtureDef(0, 0.5f, 0.5f, false, CATEGORYBIT_WALL, MASKBITS_WALL, (short)0);
public static final FixtureDef PLAYERS_FIXTURE_DEF = PhysicsFactory.createFixtureDef(1, 0.5f, 0.5f, false, CATEGORYBIT_PLAYERS, MASKBITS_WALL, (short)-1); 
```

并适用于你的身体。

```
AnimatedSprite player, enemy;
Body playerBody, enemyBody;

player= new AnimatedSprite(CAMERA_WIDTH/2, CAMERA_HEIGHT/2,     this.playerRegion, this.getVertexBufferObjectManager());
playerBody = PhysicsFactory.createBoxBody(this.mPhysicsWorld, player,     BodyType.DynamicBody, PLAYERS_FIXTURE_DEF);   
this.mPhysicsWorld.registerPhysicsConnector(new PhysicsConnector(player, playerBody, true, false));

enemy= new AnimatedSprite(CAMERA_WIDTH/4, CAMERA_HEIGHT/2, this.enemyRegion, this.getVertexBufferObjectManager());

enemyBody= PhysicsFactory.createCircleBody(this.mPhysicsWorld, enemy, BodyType.DynamicBody, PLAYERS_FIXTURE_DEF);
this.mPhysicsWorld.registerPhysicsConnector(new PhysicsConnector(enemy, enemyBody, true, false)); 
```

# java - 数据库表中的多语言字段

> ID：936936
> 
> 赞同：4
> 
> 时间：2009-06-01T21:41:02.593
> 
> 标签：java, mysql, hibernate, database-design, internationalization

我有一个应用程序需要支持多语言界面，确切地说是五种语言。对于接口的主要部分，可以使用标准 ResourceBundle 方法来处理这个问题。

然而，该数据库包含许多表格，其元素包含人类可读的名称、描述、摘要等。需要能够以所有五种语言输入其中的每一个。

虽然我想我可以简单地在每个表上都有字段，比如

```
NameLang1
NameLang2
... 
```

我觉得在编写代表每个表的 bean 时，这会导致大量基本相同的代码。

然而，从纯粹面向对象的角度来看，解决方案很简单。每个类都只有一个 Text 对象，其中包含每种语言的相关文本。这进一步有帮助，因为只有一种语言是强制性的，其他语言有回退规则（例如，如果语言 4 缺失，则返回语言 2，它回退到语言 1，这是强制性的）。

不幸的是，将其映射回关系数据库意味着我最终得到一个表，大约有 10-12 个其他表 FK 到（实际上有些表有多个 FK）。

这种方法似乎有效，我已经能够使用 Hibernate 将数据映射到 POJO。您唯一不能做的就是从 Text 对象映射到其父对象（因为您无法知道应该链接到哪个表），但是几乎没有必要这样做。

因此，总体而言，这似乎可行，但是让多个表像这样引用一个表只是感觉不对。有人有更好的主意吗？

如果重要的话，我正在使用 MySQL ......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:59:16.520

我必须这样做一次......某些表格的多语言文本......我不知道我是否找到了最好的解决方案，但我所做的是让表格包含与语言无关的信息，然后是一个包含所有信息的子表格多语言领域。对于默认语言，子表中至少需要一条记录；以后可以添加更多语言。

在 Hibernate 上，您可以将子表中的信息映射为 Map，并获取所需语言的信息，如您所说，在 POJO 上实现回退。您可以为多语言字段设置不同的 getter，它们在内部调用 fallback 方法来获取所需语言的适当子对象，然后只返回所需字段。

这种方法使用更多的表（每个需要多语言信息的表一个额外的表）但性能要好得多，以及我认为的维护......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T22:00:05.753

例如，在[gettext](http://www.gnu.org/software/hello/manual/gettext/Java.html)中使用的标准翻译方法是使用单个字符串来描述概念并调用翻译为目标语言的翻译方法。

这样，您只需在数据库中存储一个字符串（规范表示），然后在您的应用程序中调用 translate 方法以获取翻译后的字符串。没有 FK 和完全的灵活性，代价是一点运行时性能（可能还有更多的维护麻烦，但有些人认为在这种情况下没有必要让维护成为问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T04:32:56.420

根据您的要求，最好为每个需要多语言的表设置一个单独的标签表。例如：您有一个带有 xyz_id 列的 XYZ 表，以及一个带有 xyz_id、language_code、label、other_label 等的 XYZ_Label 表

与拥有一个巨大的标签表相比，这样做的优点是您可以对 XYZ_labels 表进行唯一约束（例如：XYZ 的英文名称必须是唯一的），并且您可以更有效地进行索引查找，因为索引一次只会覆盖一个表（例如：如果您需要按英文名称查找 XYZ 实体）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T22:06:28.563

我在有类似问题的应用程序中看到的方法是我们使用“文本 id”列来存储引用，并且我们有一个包含所有翻译的表。这也为重复使用相同的键以减少所需的翻译量提供了一些灵活性，这是项目中昂贵的部分。

它还提供了数据之间的良好分离，以及在我看来更像是 UI 的翻译。

如果您需要的字符串毕竟不是那么多，那么您可以将它们全部加载到内存中，然后使用某种方法通过检查内存中的数据结构来提供翻译。

使用这种方法，您的 bean 不会有每种语言的 getter，但您会使用其他一些翻译器对象：

```
 MyTranslator.translate(myBean.getNameTextId()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-07T07:12:22.247

这个怎么样： [http](http://rob.purplerockscissors.com/2009/07/24/internationalizing-websites/) ://rob.purplerockscissors.com/2009/07/24/internationalizing-websites/ ...这就是用户“Chochos”在回应 #2 时所说的

# image-processing - 哪个 EXIF 标签存储照片的关键字/标签？

> ID：936937
> 
> 赞同：6
> 
> 时间：2009-06-01T21:41:09.393
> 
> 标签：image-processing, tags, imagemagick, exif, exiftool

我正在开发一个可以读/写 EXIF 标签的照片库。我会将照片标题放在 EXIF 标记 DocumentName 中，将描述放在 EXIF 标记 ImageDescription 中。我还计划使用地理标签。但是照片标签/类别呢？我想在我的系统中存储一个以空格分隔的标签字符串。是否有任何 EXIF 标签通常用于此类信息？我可以编写自己的（即 PhotoTags），但我想除了在我的系统内部（无论如何，这些信息都存储在数据库中）之外，这并没有任何用处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T21:54:47.900

我认为这将需要研究[IPTC](http://en.wikipedia.org/wiki/IPTC_Information_Interchange_Model)和/或[XMP](http://en.wikipedia.org/wiki/Extensible_Metadata_Platform)（不完全清楚它们的关系）以存储有关图像的元数据（例如关键字/标签、标题、描述等）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-29T01:36:41.747

没有 EXIF 标签，但有一个 IPTC“关键字”标签。JPEG 可以处理 IPTC 记录，所以应该没有问题。

# naming-conventions - 我应该如何命名这个表和函数？

> ID：936943
> 
> 赞同：1
> 
> 时间：2009-06-01T21:42:19.737
> 
> 标签：naming-conventions

我有一份受我启发的媒体清单和一份受我启发的清单。在一张表中，我将其命名为inspirer，inspired。我敢肯定，inspirer 不是一个词，所以这是一个问题。

接下来是我有 2 个功能，我想列出我启发过和受过启发的每个人的列表。启发（）和启发（）可能会让人感到困惑，所以我需要启发作为 getInspirer（）。但我相信你们可以看到混乱。getInspirer() 是否应该获取我的启发者或受我启发的每个人的列表？它太令人困惑了。什么是更好的表和方法名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:50:14.273

我会创建一个名为 Inspiration 的表。

```
- InspirationID PK Int Identity
- InspirationDesc Text 
```

然后，我将创建另一个表来跟踪 Inspiration 与 Inspiration 的关系，称为 InspirationSomething...

```
- InspirationParentID FK 
- InspirationChildID FK 
```

然后你可以很容易地从那里得到你的清单......

```
- GetInspirationParents()
- GetInspriationParents(id)
- GetInspirationChildren()
- GetInspirationChildren(id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T21:44:19.530

使用灵感一词而不是 Inspirer。一个人可以成为灵感。

# c# - Outlook Com 加载项部署和可扩展性问题

> ID：936945
> 
> 赞同：0
> 
> 时间：2009-06-01T21:42:35.820
> 
> 标签：c#, com, ms-office, add-in, extensibility

我是一名使用 C#、Visual Studio 2005 为 Outlook2003/2007 编写插件的开发人员。我还在使用 COM 插件向导（不使用 VSTO，我有一个 Connect.cs）。该程序在我的机器上安装了 Visual Studio 后成功运行，但是当我尝试部署该软件时，我遇到了奇怪的行为。

我设置了一个日志记录系统，用于将一些 Extensibility.IDTExtensibility2 事件（OnBeginShutdown、OnDisconnection、OnConnection 和 OnStartupComplete）写入日志文件。当我在部署的机器上运行 Outlook 时，我的加载项没有启动。但是，当我退出 Outlook 时，我确实在日志中看到了数据，但它显示只有事件 OnDisconnection 和 OnBeginShutdown 被触发。为什么 OnConnection 和 OnStartupComplete 没有触发？我担心它是一个引用/DLL 问题，但为什么会触发其他事件而不是这两个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T01:06:47.310

好的，我想通了，对于可能遇到此问题的任何人：我们将托管 dll 设置为注册互操作（在项目属性中）...确保未选中此框！这覆盖了 shim 注册

# ruby-on-rails - 过滤 Rails 中的 ActiveRecord 查询

> ID：936947
> 
> 赞同：25
> 
> 时间：2009-06-01T21:43:03.307
> 
> 标签：ruby-on-rails, ruby, activerecord

我习惯了 Django，你可以在查询集上运行多个过滤器方法，即`Item.all.filter(foo="bar").filter(something="else")`.

然而，这在 Rails 中并不容易做到。`Item.find(:all, :conditions => ["foo = :foo", { :foo = bar }])`返回一个数组，这意味着这将不起作用：

`Item.find(:all, :conditions => ["foo = :foo", { :foo = 'bar' }]).find(:all, :conditions => ["something = :something", { :something = 'else' }])`

所以我认为“堆叠”过滤器的最佳方法是修改条件数组，然后运行查询。

所以我想出了这个功能：

```
 def combine(array1,array2)
   conditions = []
   conditions[0] = (array1[0]+" AND "+array2[0]).to_s
   conditions[1] = {}
   conditions[1].merge!(array1[1])
   conditions[1].merge!(array2[1])
   return conditions
 end 
```

用法：

array1 = ["foo = :foo", { :foo = 'bar' }] array2 = ["something = :something", { :something = 'else' }] 条件 = combine(array1,array2) items = Item.查找（：全部，：条件 => 条件）

这工作得很好。但是我希望能够组合任意数量的数组，或者基本上是写作的简写：

```
conditions = combine(combine(array1,array2),array3) 
```

有人能帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-01T23:07:38.067

你想要的是命名范围：

```
class Item < ActiveRecord::Base
  named_scope :by_author, lambda {|author| {:conditions => {:author_id => author.id}}}
  named_scope :since, lambda {|timestamp| {:conditions => {:created_at => (timestamp .. Time.now.utc)}}}
  named_scope :archived, :conditions => "archived_at IS NOT NULL"
  named_scope :active, :conditions => {:archived_at => nil}
end 
```

在您的控制器中，像这样使用：

```
class ItemsController < ApplicationController
  def index
    @items = Item.by_author(current_user).since(2.weeks.ago)
    @items = params[:archived] == "1" ? @items.archived : @items.active
  end
end 
```

返回的对象是一个代理，并且 SQL 查询将不会运行，直到您真正开始对集合执行一些实际操作，例如迭代（用于显示）或当您在代理上调用 Enumerable 方法时。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-01T21:53:57.450

我不会像你提议的那样做。

由于 find 返回一个数组，您可以使用数组方法对其进行过滤，例如：

```
Item.find(:all).select {|i| i.foo == bar }.select {|i| i.whatever > 23 }... 
```

您还可以使用命名范围来实现您想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-01T21:51:42.760

你可以看看[Searchlogic](http://searchlogic.rubyforge.org/)。
它使得在 `ActiveRecord`集合上使用条件变得更容易，甚至在`Arrays`.

希望能帮助到你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T21:53:36.360

您可以（或至少曾经能够）在 Rails 中像这样进行过滤：

```
find(:all, :conditions => { :foo => 'foo', :bar => 'bar' }) 
```

其中 :foo 和 :bar 是活动记录中的字段名称。似乎您需要做的就是传入 :field_name => 值对的哈希值。

# linux - linux文件系统权限问题

> ID：936957
> 
> 赞同：1
> 
> 时间：2009-06-01T21:44:34.270
> 
> 标签：linux, permissions

我正在部署 nutch。起初我只是将索引文件放在`/root/nutch1.0`. 从命令行运行时，这工作正常。但是，当我从网上搜索时，它总是返回`0 hit`.

我终于找到了原因：是因为索引文件位于下面`/root`导致无法打开文件。当我将索引文件移动到另一个目录时，一切恢复正常。

但我的问题是：

我没有更改索引文件的权限（只是`cp`xxx 另一个目录）。为什么访问权限发生了变化？

```
drwxr-x--- 12 root root    4096 Jun  1 14:49 root
drwxr-xr-x 14 root root    4096 Nov 16  2007 usr 
```

我把文件放在下面`/usr`，它起作用了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T21:57:31.950

要读取文件，您需要文件所在目录的搜索 ('x') 权限，以及文件本身的读取权限。将文件从 Web 服务器没有搜索权限的目录移动到有搜索权限的目录会导致您看到的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T21:49:12.700

因为除非您是 root，否则您无法访问根目录中的任何内容。

查看 /root 的权限，它应该是 700 之类的...执行位已设置为只有 root 才能“执行”该目录。目录的执行权限允许您查看目录中的文件。

这与您以其他人身份登录时不能“ls /root”的原因相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T22:03:13.577

大概您在“root”组中，因此可以使用该目录。使用 Web 界面时，您可能在一个程序中拥有自己的用户（在 Unix/Linux 意义上），该用户可能不在“root”组中。根据您列出的权限，任何人都可以使用“/usr”目录。

# cocoa - 将 NSDate 格式化为年、月、日和小时、分钟、秒的特定样式

> ID：936969
> 
> 赞同：132
> 
> 时间：2009-06-01T21:48:28.350
> 
> 标签：cocoa, cocoa-touch, nsdate, nsdateformatter, date-formatting

我基本上需要分别获取当前日期和时间，格式为：

```
2009-04-26
11:06:54

```

下面的代码来自同一主题的另一个问题，生成

```
现在：|2009-06-01 23:18:23 +0100|
日期字符串：|2009 年 6 月 1 日 23:18|
解析：|2009-06-01 23:18:00 +0100|

```

这几乎是我要找的，但我想将日期和时间分开。

```
NSDateFormatter *format = [[NSDateFormatter alloc] init];
[format setDateFormat:@"MMM dd, yyyy HH:mm"];

NSDate *now = [[NSDate alloc] init];

NSString *dateString = [format stringFromDate:now];

NSDateFormatter *inFormat = [[NSDateFormatter alloc] init];
[inFormat setDateFormat:@"MMM dd, yyyy"];

NSDate *parsed = [inFormat dateFromString:dateString];

NSLog(@"\n"
"now:        |%@| \n"
"dateString: |%@| \n"
"parsed:     |%@|", now, dateString, parsed); 
```

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-06-04T03:01:12.117

这就是我用的：

```
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"yyyy-MM-dd"];

NSDateFormatter *timeFormat = [[NSDateFormatter alloc] init];
[timeFormat setDateFormat:@"HH:mm:ss"];

NSDate *now = [[NSDate alloc] init];

NSString *theDate = [dateFormat stringFromDate:now];
NSString *theTime = [timeFormat stringFromDate:now];

NSLog(@"\n"
      "theDate: |%@| \n"
      "theTime: |%@| \n"
      , theDate, theTime);

[dateFormat release];
[timeFormat release];
[now release]; 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-06-01T22:34:41.190

iPhone 格式字符串是[Unicode 格式](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)。链接后面是一个表格，解释了上面所有字母的含义，因此您可以自己构建。

当然，不要忘记在使用完日期格式化程序后发布它们。上面的代码泄漏`format`,`now`和`inFormat`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-12-18T12:38:44.483

```
 NSDateFormatter *dateformat = [[NSDateFormatter alloc] init];
    [dateformat setDateFormat:@"Your Date Format"]; 
```

设置返回的格式是....

`yyyy-MM-dd`返回`2015-12-17`日期

`yyyy-MMM-dd` 返回`2015-Dec-17`日期

`yy-MM-dd`返回`15-12-17`日期

`dd-MM-yy` 返回`17-12-15`日期

`dd-MM-yyyy` 返回`17-12-2015`日期

`yyyy-MMM-dd HH:mm:ss` 返回`2015-Dec-17 08:07:13`日期和时间

`yyyy-MMM-dd HH:mm` 返回`2015-Dec-17 08:07`日期和时间

[有关更多详细信息，请单击立即](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)获取数据和时间格式。

谢谢.....

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-07-05T12:29:42.197

您可以使用此方法，只需将您的日期传递给它

```
-(NSString *)getDateFromString:(NSString *)string
{

    NSString * dateString = [NSString stringWithFormat: @"%@",string];

    NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"your current date format"];
    NSDate* myDate = [dateFormatter dateFromString:dateString];

    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"your desired format"];
    NSString *stringFromDate = [formatter stringFromDate:myDate];

    NSLog(@"%@", stringFromDate);
    return stringFromDate;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-03T08:41:01.863

没什么新鲜的，但仍然想分享我的方法：

```
+(NSString*) getDateStringFromSrcFormat:(NSString *) srcFormat destFormat:(NSString *)
destFormat scrString:(NSString *) srcString
{
    NSString *dateString = srcString;
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    //[dateFormatter setDateFormat:@"MM-dd-yyyy"];
    [dateFormatter setDateFormat:srcFormat];
    NSDate *date = [dateFormatter dateFromString:dateString];

    // Convert date object into desired format
    //[dateFormatter setDateFormat:@"yyyy-MM-dd"];
    [dateFormatter setDateFormat:destFormat];
    NSString *newDateString = [dateFormatter stringFromDate:date];
    return newDateString;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-01-13T10:02:58.653

**为了迅速**

```
var dateString:String = "2014-05-20";
var dateFmt = NSDateFormatter()
// the format you want
dateFmt.dateFormat = "yyyy-MM-dd"
var date1:NSDate = dateFmt.dateFromString(dateString)!; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-09T15:50:50.390

## 斯威夫特 3

```
extension Date {

    func toString(template: String) -> String {
        let formatter = DateFormatter()
        formatter.dateFormat = DateFormatter.dateFormat(fromTemplate: template, options: 0, locale: NSLocale.current)
        return formatter.string(from: self)
    }

} 
```

## 用法

```
let now = Date()
let nowStr0 = now.toString(template: "EEEEdMMM") // Tuesday, May 9
let nowStr1 = now.toString(template: "yyyy-MM-dd") // 2017-05-09
let nowStr2 = now.toString(template: "HH:mm:ss") // 17:47:09 
```

使用模板来满足您的需求。[此处](https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)的示例和文档可帮助您构建所需的模板。

### 笔记

`DateFormatter`例如，如果您打算使用它，您可能需要缓存它`TableView`。举个例子，使用上述函数循环超过 1000 个日期需要**0.5 秒****，**而使用.`toString(template: String)`**`myFormatter.string(from: Date)`**

 *** * *

## 回答 #8

> 赞同：-5
> 
> 时间：2010-11-26T18:48:25.560

```
NSDate *date         = [NSDate date];
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"yyyy-MM-dd"]
NSString *dateString  = [df stringFromDate:date];
[df setDateFormat:@"hh:mm:ss"];
NSString *hoursString = [df stringFromDate:date]; 
```

就是这样，你得到了你想要的一切。

# artificial-intelligence - 霍普菲尔德神经网络

> ID：936975
> 
> 赞同：1
> 
> 时间：2009-06-01T21:49:45.603
> 
> 标签：artificial-intelligence, neural-network

你知道除了模式识别之外的任何应用程序。为了实现 Hopfield 神经网络模型值得吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T22:36:26.723

循环神经网络（其中 hopfield 网络是一种特殊类型）用于序列学习中的多个任务：

*   序列预测（将库存值的历史映射到下一个时间步的预期值）
*   序列分类（将每个完整的音频片段映射到扬声器）
*   序列标签（将音频片段映射到所说的句子）
*   非马尔科夫强化学习（例如需要深记忆作为 T-Maze 基准的任务）

我不确定您所说的“模式识别”到底是什么意思，因为它基本上是一个完整的领域，可以使用神经网络的每项任务都适合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-10T10:05:11.337

您也可以使用 Hopfield 网络来解决优化问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-12T11:32:24.867

您可以签出此存储库-> [Hopfield Network](https://github.com/yogonza524/HopfieldNetwork)

在离线训练网络后，您有一个测试模式的示例。这是测试

```
 @Test
 public void HopfieldTest(){
     double[] p1 = new double[]{1.0, -1.0,1.0,-1.0,1.0,-1.0,1.0,-1.0,1.0};
     double[] p2 = new double[]{1.0, 1.0,1.0,-1.0,1.0,-1.0,-1.0,1.0,-1.0};
     double[] p3 = new double[]{1.0, 1.0,-1.0,-1.0,1.0,-1.0,-1.0,1.0,-1.0};

     ArrayList<double[]> patterns = new ArrayList<>();
     patterns.add(p1);
     patterns.add(p2);

     Hopfield h = new Hopfield(9, new StepFunction());

     h.train(patterns); //train and load the Weight matrix

     double[] result = h.test(p3); //Test a pattern

     System.out.println("\nConnections of Network: " + h.connections() + "\n"); //show Neural connections
     System.out.println("Good recuperation capacity of samples: " + Hopfield.goodRecuperation(h.getWeights().length) + "\n");
     System.out.println("Perfect recuperation capacity of samples: " + Hopfield.perfectRacuperation(h.getWeights().length) + "\n");
     System.out.println("Energy: " + h.energy(result));

     System.out.println("Weight Matrix");
     Matrix.showMatrix(h.getWeights());
     System.out.println("\nPattern result of test");
     Matrix.showVector(result);

     h.showAuxVector();
 } 
```

运行测试后你可以看到

```
Running HopfieldTest

Connections of Network: 72

Good recuperation capacity of samples: 1

Perfect recuperation capacity of samples: 1

Energy: -32.0

Weight Matrix
 0.0        0.0     2.0    -2.0      2.0       -2.0       0.0       0.0     0.0
 0.0        0.0     0.0     0.0      0.0        0.0      -2.0       2.0    -2.0
 2.0        0.0     0.0    -2.0      2.0       -2.0       0.0       0.0     0.0
-2.0        0.0    -2.0     0.0     -2.0        2.0       0.0       0.0     0.0
 2.0        0.0     2.0    -2.0      0.0       -2.0       0.0       0.0     0.0
-2.0        0.0    -2.0     2.0     -2.0        0.0       0.0       0.0     0.0
 0.0       -2.0     0.0     0.0      0.0        0.0       0.0      -2.0     2.0
 0.0        2.0     0.0     0.0      0.0        0.0      -2.0       0.0    -2.0
 0.0       -2.0     0.0     0.0      0.0        0.0       2.0      -2.0     0.0

Pattern result of test 

 1.0        1.0     1.0     -1.0     1.0       -1.0      -1.0       1.0     -1.0
-------------------------
The auxiliar vector is empty 
```

我希望这可以帮助你

# cocoa - 使用 NSProxy 和 forwardInvocation：

> ID：936976
> 
> 赞同：5
> 
> 时间：2009-06-01T21:50:00.483
> 
> 标签：cocoa, proxy, selector, invoke

我想编写一个代理，通过 TCP 将方法调用转发到另一个对象，*而无需* `NSConnection`其他东西`NSDistanceObject`。我想要的是我自己的协议。

问题是子类化 NSProxy 和覆盖`forwardInvocation:`是不够的。我也必须覆盖`methodSignatureForSelector`

这是我的问题：

```
– (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector
{
    return ??? 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T22:58:49.863

@Brian，这可能没问题，但这`setProtocolForProxy:`只是为了优化。cocoafan 可以为他的解决方案强制使用它，但它不会是替代品。您应该能够自动获得签名。为此，网络协议需要一种请求签名的方法。

我相信这里的解决方案是在网络协议中包含一个“请求方法签名”方法，并让它`methodSignatureForSelector:`在远程对象上运行并编码并返回结果。就是`NSDistantObject`这样。

`setProtocolForProxy:`如果您要经常喋喋不休，提供是一项重要的优化，但它确实将您限制在您拥有协议的对象上，并且在 10.5 之前引入了一些烦人的限制（所有方法都是必需的）。即使在 10.5 上，如果它是获取方法签名的唯一方法，它也可能会引入一些有问题的限制。

@cocoafan，我认为您在 之上从头开始创建它可能是正确的`NSProxy`，但请看一下`NSConnection`，看看您是否可以对它进行子类化以按照您想要的方式管理网络连接。如果你能找到一种方法来做到这一点（虽然我没有看到一个简单的方法），你可能会从`NSDistantObject`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T22:38:21.073

处理这个问题的方法`NSDistantObject`是通过它的`setProtocolForProxy:`方法，它指定一个协议，其中包含连接另一端的对象处理的方法列表。然后，它可以使用这些方法的信息`NSMethodSignature`在进行转发时提供适当的对象。

看起来最直接的做法是通过`protocol_getMethodDescription()`在`<objc/runtime.h>`. 这将返回一个`objc_method_description`包含`types`字段的结构。我相信您应该能够将该值传递给以`+[NSMethodSignature signatureWithObjCTypes:]`获取与协议中声明的内容相匹配的方法签名对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T23:37:52.303

我找到了一个生成对象的[智能解决方案。](http://cocoawithlove.com/2008/03/construct-nsinvocation-for-any-message.html)`NSInvocation`

# c# - 如何使用正则表达式添加换行符？

> ID：936983
> 
> 赞同：0
> 
> 时间：2009-06-01T21:51:57.750
> 
> 标签：c#, regex

我有一个很长的字符串。我想每 80 个字符添加一个换行符。是否有可用于每 80 个字符插入“\r\n”的正则表达式替换模式？如果这很重要，我正在使用 C#。

我想避免使用循环。

我不必担心我会说话。我只想每 80 个字符插入一个换行符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T21:54:15.563

我不知道确切的 C# 名称，但它应该类似于

```
str.Replace("(.{80})", "$1\r\n"); 
```

这个想法是抓取 80 个字符并将其保存在一个组中，然后将其与“\r\n”一起放回（我认为“$1”是正确的语法）。

（**编辑：**原始的正则表达式中有一个`+`，你绝对不想要。这将完全消除除了最后一行和任何剩余部分之外的所有内容——一个绝对次优的结果。）

请注意，这样一来，您很可能会在单词内部进行拆分，因此看起来可能很丑陋。

如果这确实应该是可读的文本，您应该更多地研究自动换行。一点[谷歌搜索](http://www.google.com/search?q=c%23+word+wrap)出现了[几个](http://geekswithblogs.net/gaijin42/archive/2006/01/23/c-sharp-word-wrap-function-dotnet.aspx)[功能](http://www.velocityreviews.com/forums/t20370-word-wrap-line-break-code-and-algorithm-for-c.html)；或者如果这是一个文本框，您可以打开[WordWrap 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.wordwrap(VS.71).aspx)。

此外，请查看regular-expressions.info 的[.Net 页面](http://www.regular-expressions.info/dotnet.html)。这是迄今为止我所知道的正则表达式的最佳参考站点。（Jan Goyvaerts 在 SO，但没有人告诉我这么说。）

# c - Pthread - time.h::sleep() 和 pthread.h::pthread_yield() 有什么区别？

> ID：936993
> 
> 赞同：17
> 
> 时间：2009-06-01T21:54:17.417
> 
> 标签：c, multithreading, pthreads, sleep, yield

我花了很长时间寻找有关 time.h::sleep() 和 pthread.h::pthread_yield() 之间差异的信息，但找不到任何可靠的参考资料，所以我发布了这个问题。

time.h::sleep() 和 pthread.h::pthread_yield() 有什么区别？

*更新：*

我问的原因是因为我使用 sleep() 来 sleep() 每个单独的线程......当有 8 个线程和 4 个线程时，我的应用程序开始出现问题。当我上网查看 sleep() 是否只影响每个线程时，我找不到任何好的参考说明 Sleep() 是影响整个进程还是 sleep() 只影响单个线程。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-01T22:50:45.197

从[pthread_yield](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.basetechref/doc/basetrf1/pthread_yield.htm)：

> pthread_yield 子例程强制调用线程放弃对其处理器的使用，并在再次调度之前在运行队列中等待。如果调用 pthread_yield 子例程时运行队列为空，则立即重新调度调用线程。

从[睡眠手册页](http://linux.die.net/man/3/sleep)：

> sleep() 使调用进程休眠，直到秒秒过去或没有被忽略的信号到达。

如果你不想在你的线程中有一个实时延迟并且只想让其他线程做他们的工作，那么 pthread_yield 比睡眠更适合。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-01T22:07:58.310

sleep() 使您的程序停止执行一段时间。无论系统上发生什么其他事情，您的线程都不会重新启动，直到至少经过 sleep() 的时间长度已经过去。pthread_yield() 通知操作系统您的线程已完成工作，并且它可以将执行切换到另一个线程。但是，如果此时没有更高优先级的线程需要工作，您的线程可能会立即重新启动。

IOWs，在 sleep() 之后，即使没有其他线程需要运行，也保证您的线程停止运行，而 pthread_yield() 只是一种礼貌的方式，可以让其他线程在需要时有机会运行。

针对问题更新进行更新： sleep() 和 pthread_yield() 都只影响调用线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T22:08:58.247

[sleep(s)](http://www.manpagez.com/man/3/Sleep/)获取当前执行线程并将其挂起，直到 s 秒过去（或者它被信号唤醒。）

在更实际的情况下，当您调用 sleep() 时，该线程将停止执行并且只是...等到指定的时间过去。一旦通过，该线程将被放入就绪队列。

[pthread_yield()](http://www.rootr.net/man/man/pthread_yield/3)表示“获取该线程，并将其放入就绪队列”。您的线程将停止执行并处于“等待”状态以由调度程序选择/运行。这并不能保证您的线程不会立即恢复运行。但它让另一个线程有机会在其执行的给定点运行。

我打算出去说 sleep(0) 将完成与 pthread_yield() 相同的事情——停止执行并将线程放入就绪队列中。

# c++ - 带有状态文本的 WTL CListViewCtrl

> ID：936997
> 
> 赞同：2
> 
> 时间：2009-06-01T21:54:54.047
> 
> 标签：c++, wtl

我在报告模式下有一个带有所有者数据集的 Windows 模板库 CListViewCtrl（因此有一个带有 2 列的标题）。此控件显示搜索结果。如果没有返回结果，我想在列表框区域显示一条消息，指示没有结果。是否有捷径可寻？你知道任何现有的控件/示例代码（我找不到任何东西）。

否则，如果我将控件子类化以提供此功能，那将是一个好方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T00:28:28.887

我最终将控件子类化并像这样处理 OnPaint：

```
class MsgListViewCtrl : public CWindowImpl< MsgListViewCtrl, WTL::CListViewCtrl >
{
    std::wstring m_message;
public:
    MsgListViewCtrl(void) {}

    BEGIN_MSG_MAP(MsgListViewCtrl)
        MSG_WM_PAINT( OnPaint )
    END_MSG_MAP()

    void Attach( HWND hwnd )
    {
        SubclassWindow( hwnd );
    }

    void SetStatusMessage( const std::wstring& msg )
    {
        m_message = msg;
    }

    void OnPaint( HDC hDc )
    {
        SetMsgHandled( FALSE );
        if( GetItemCount() == 0 )
        {
            if( !m_message.empty() )
            {
                CRect cRect, hdrRect;
                GetClientRect( &cRect );
                this->GetHeader().GetClientRect( &hdrRect );
                cRect.top += hdrRect.Height() + 5;

                PAINTSTRUCT ps;
                SIZE size;
                WTL::CDCHandle handle = this->BeginPaint( &ps );
                handle.SelectFont( this->GetFont() );
                handle.GetTextExtent( m_message.c_str(), (int)m_message.length(), &size );
                cRect.bottom = cRect.top + size.cy;
                handle.DrawText( m_message.c_str(), -1, &cRect, DT_CENTER | DT_SINGLELINE | DT_VCENTER );
                this->EndPaint( &ps );
                SetMsgHandled( TRUE );
            }
        }
    }
}; 
```

搜索运行后，如果没有结果，我调用 SetStatusMessage 并且消息显示在标题下方居中。这就是我想要的。我是子类化控件的新手，所以我不确定这是否是最好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T08:38:42.140

If you're on Vista or later, handle the `LVN_GETEMPTYMARKUP` notification. For pre-Vista, you'll need to paint the message yourself.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T02:20:33.310

另一个想法是拥有另一个控件，其大小和位置与列表控件相同，但隐藏。可以是编辑控件、静态文本、浏览器控件，或者你有什么。

然后，当您没有任何搜索结果时，您将消息放在此控件中，并取消隐藏它。当用户执行另一个返回结果的搜索时，您隐藏此控件并在列表视图中正常显示结果。

# xml - 在我的一个 xpath 上生成 hexBinary 的 CFXML 代码

> ID：936998
> 
> 赞同：0
> 
> 时间：2009-06-01T21:55:14.170
> 
> 标签：xml, coldfusion

我需要生成以下 xml 数据包以发布到 hudson。日志 xml 项本质上将具有控制台输出行。任何人都可以帮助 ColdFusion/Java 正确编码该项目

```
<run>
  <log encoding='hexBinary'>...hex binary encoded console output...</log>
  <result>... integer indicating the error code. 0 is success and everything else is failure</result>
  <duration>... milliseconds it took to execute this run ...</duration>
</run> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T01:51:30.840

使用`<CFXML>`标签将是在 CFML 中构造 XML 对象的最简单方法。

hexBinary 可以使用以下代码进行编码：`BinaryEncode(yourBinaryData, "Hex")`

`<cftimer>`可用于测量执行标记之间的代码部分所花费的时间。或者`GetTickCount()`

# c++ - C++ 指针的默认构造函数是什么？

> ID：936999
> 
> 赞同：27
> 
> 时间：2009-06-01T21:55:27.743
> 
> 标签：c++, dictionary, pointers, constructor

我有这样的代码：

```
class MapIndex
{
private:
    typedef std::map<std::string, MapIndex*> Container;
    Container mapM;

public:
    void add(std::list<std::string>& values)
    {
        if (values.empty()) // sanity check
            return;

        std::string s(*(values.begin()));
        values.erase(values.begin());
        if (values.empty())
            return;

        MapIndex *&mi = mapM[s];  // <- question about this line
        if (!mi)
            mi = new MapIndex();
        mi->add(values);
    }
} 
```

我主要关心的是，如果将新项目添加到地图中，mapM[s] 表达式是否会返回对 NULL 指针的引用？

[SGI 文档](http://www.sgi.com/tech/stl/Map.html)这样说：*data_type& operator[](const key_type& k) 返回对与特定键关联的对象的引用。如果地图尚未包含此类对象，则 operator[] 插入默认对象 data_type()。*

所以，我的问题是插入**默认对象 data_type()**是否会创建一个 NULL 指针，或者它会创建一个指向内存中某处的无效指针？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-01T21:56:53.903

它将创建一个`NULL`(0) 指针，无论如何这是一个无效的指针:)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-01T23:10:04.067

是的，它应该是一个零（NULL）指针，因为 stl 容器将默认初始化对象，当它们没有显式存储时（即在你正在做的时候访问映射中不存在的键或将向量调整为更大的大小）。

C++ 标准，8.5 第 5 段指出：

> 默认初始化 T 类型的对象意味着：
> 
> *   如果 T 是非 POD 类类型（子句类），则调用 T 的默认构造函数（如果 T 没有可访问的默认构造函数，则初始化是非良构的）
> *   如果 T 是数组类型，则每个元素都是默认初始化的
> *   否则，对象的存储是零初始化的。

您还应该注意，默认初始化与简单地省略构造函数不同。当您省略构造函数并简单地声明一个简单类型时，您将获得一个不确定的值。

```
int a; // not default constructed, will have random data 
int b = int(); // will be initialised to zero 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-09T09:27:14.277

**更新：**我完成了我的程序，而我所询问的那一行有时会导致它崩溃，但在稍后阶段。问题是我正在创建一个新对象而不更改存储在 std::map 中的指针。真正需要的是对该指针的引用或指针。

```
MapIndex *mi = mapM[s];  // <- question about this line
if (!mi)
    mi = new MapIndex();
mi->add(values); 
```

应改为：

```
MapIndex* &mi = mapM[s];  // <- question about this line
if (!mi)
    mi = new MapIndex();
mi->add(values); 
```

我很惊讶没有人注意到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-01T22:27:31.050

表达式`data_type()`值初始化一个对象。对于具有默认构造函数的类类型，调用它；如果它不存在（或默认），例如指针，则该对象被零初始化。

所以是的，你可以依靠你的地图创建一个`NULL`指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-17T00:29:56.367

不确定崩溃，但肯定存在内存泄漏，如下所述：

```
if (!mi) 
    mi = new MapIndex(); 
```

总是返回 true，因为指针`mi`不是对`mapM`特定值的引用`s`。

我还将避免使用常规指针并使用`boost::shared_ptr`或其他在销毁时释放内存的指针。这允许您调用`mapM.clear()`or `erase()`，这应该调用存储在映射中的键和值的析构函数。好吧，如果值是 POD，例如您的指针，那么除非手动删除，否则不会为此调用析构函数，而遍历整个映射将导致内存泄漏。**````*``******``***