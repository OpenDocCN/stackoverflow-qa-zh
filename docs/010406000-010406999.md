# StackOverflow 问答 10406000-10406999

# java - 尝试动态禁用首选项时的空指针

> ID：10406008
> 
> 赞同：0
> 
> 时间：2012-05-02T00:01:34.517
> 
> 标签：java, android

我`mPreference = (Preference)...`在下面的代码中得到一个空指针异常（即调试器打开，`mPreference`显示空；NB 键是非空的，我可以用文字替换它仍然给我同样的异常）：

```
public class SettingsManager extends PreferenceActivity {

    private Preference mPreference;
    private static boolean toggle;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // Load the XML preferences file
        addPreferencesFromResource(R.xml.preferences);
    }

    public void setPrefEnabled(Context context, String key, String enabled) {
        if (enabled.contentEquals("true")) {
            toggle = true;
        } else {
            toggle = false;
        }
        mPreference = (Preference) getPreferenceScreen().findPreference(key);
        mPreference.setEnabled(toggle);
    }
} 
```

该类由以下代码在构造函数中实例化`applySettings`的类的方法中调用：`settingsManager`

```
public class ConfigurationSetter {

    private static Context mContext;
    private static SettingsManager settingsManager;

    public ConfigurationSetter(Context context) {
        mContext = context;
        settingsManager = new SettingsManager();
    }

    private static void applySettings(Context context, String key,
            String value, String enabled) {
        settingsManager.setPrefEnabled(mContext, key, enabled);
    }
} 
```

我一直在摸索这个问题，但可能有点太累了，无法自己解决。任何帮助表示赞赏。

与这个问题相关，我[在这里问了一个](https://stackoverflow.com/questions/10423709/are-intents-required-to-persist-preference-state-in-a-headless-activity)关于意图是否是此活动所需的实例化器的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:10:05.773

您的`onCreate`方法永远不会在此代码中调用（因此`PreferenceScreen`在调用期间未按`addPreferencesFromResource`预期填充）。`onCreate`是`Activity`生命周期的一部分，如果您`Activity`使用`Intent`. 通常不使用创建活动`new`，因为在这种情况下，它们不会链接到正确的`Context`并显示其他形式的未定义行为，例如您的。

# daemon - 守护程序应用程序的最佳语言？

> ID：10406010
> 
> 赞同：1
> 
> 时间：2012-05-02T00:01:46.223
> 
> 标签：daemon

我正在寻找创建一个应用程序来实时跟踪某些 MySQL 数据。即当一个新人注册时，等等。什么是最好的语言来做到这一点？C++、C、Java？我正在寻找内存占用最小的任何语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:07:08.640

如果您正在制作一个用户注册的 Web 应用程序，您的服务器将必须不断运行，并且可能存储到数据库中......所以隐含实时。至于你会用什么来写这样的网站——我认为 Java/J2EE、Ruby 或新的热门 Node.JS 都是可行的，还有许多其他的。

...而且您也可以随时使用 cron 每隔几秒运行一次，呵呵。

这是否解决了您的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-05T01:06:59.157

**当然 Java/J2EE，Ruby 更适合你。**

# ios - 为 Retina 和非 Retina 显示器开发 OpenGL ES

> ID：10406017
> 
> 赞同：7
> 
> 时间：2012-05-02T00:02:50.297
> 
> 标签：ios, cocoa-touch, opengl-es, retina-display

在深入研究下一个项目之前，我正在寻求建议。我想支持 iOS 现在支持的所有各种分辨率（视网膜、非视网膜 iPhone 和所有 3 个 iPad）。

开发人员完成这项工作的最常见方式是什么？我看到过类似的问题，但具有特定的性质。我正在寻找完整的包裹。IE。我想支持不同分辨率的位图字体、图像等。

设备特定的开关或 if 语句是标准的吗？

感谢所有高级帮助。

乙

编辑：我从 Apple 找到了这个：

> Blockquote 如果您的应用程序使用 OpenGL ES 进行渲染，您现有的绘图代码应该继续工作而无需任何更改。但是，当在高分辨率屏幕上绘制时，您的内容会相应地缩放，并且会显得更加块状。出现块状外观的原因是用于支持 OpenGL ES 渲染缓冲区的 CAEAGLLayer 类的默认行为与其他核心动画层对象相同。换句话说，它的缩放因子最初设置为 1.0，这会导致 Core Animation 合成器在高分辨率屏幕上缩放图层的内容。为避免出现这种块状外观，您需要增加 OpenGL ES 渲染缓冲区的大小以匹配屏幕大小。（使用更多像素，您可以增加为内容提供的详细信息量。
> 
> Blockquote 要启用高分辨率绘图，您必须更改用于呈现 OpenGL ES 内容的视图的比例因子。将视图的 contentScaleFactor 属性从 1.0 更改为 2.0 会触发对基础 CAEAGLLayer 对象的比例因子的匹配更改。用于将图层对象绑定到渲染缓冲区的 renderbufferStorage:fromDrawable: 方法通过将图层的边界乘以其比例因子来计算渲染缓冲区的大小。因此，将比例因子加倍会使生成的渲染缓冲区的宽度和高度加倍，从而为您的内容提供更多像素。之后，您可以为这些额外的像素提供内容。

所以我想我更新的问题是如何将上述比例因子加倍？

编辑2：

我快到了...

我正在使用它在我的 EAGLView 中进行缩放：

```
 // Adjust for retina displays
    if ([self respondsToSelector:@selector(setContentScaleFactor:)])
    {
            self.contentScaleFactor = [[UIScreen mainScreen] scale];
    } 
```

现在唯一剩下的问题是起源不知何故搞砸了。显示图像现在根据分辨率缩放，但在较大的分辨率下，图像从屏幕中间开始。

请帮忙！

编辑3：解决了！！！！我在方向上遇到了问题。

您需要确保您的翻译已更新。我用这个：

```
 glTranslatef( width / 2, height /2, 0);
glRotatef(-90, 0, 0, 1);
glTranslatef(-1 * (height / 2),-1 * (width / 2),0); 
```

谢谢你的样子。我希望这可以帮助别人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:44:56.683

请参阅视图编程指南：查看几何和坐标系

[http://developer.apple.com/library/ios/#DOCUMENTATION/WindowsViews/Conceptual/ViewPG_iPhoneOS/WindowsandViews/WindowsandViews.html](http://developer.apple.com/library/ios/#DOCUMENTATION/WindowsViews/Conceptual/ViewPG_iPhoneOS/WindowsandViews/WindowsandViews.html)

> 坐标值使用浮点数表示，无论底层屏幕分辨率如何，都可以精确布局和定位内容

这意味着您指定的点（GCRect 等...）不是像素 - 它是针对视网膜/非视网膜调整的点

最后，正如 Cocoa Priest 所指出的，您可以维护 png 图像和图像的 *@2x.png 版本：

[iPhone 上的 Retina 显示图像](https://stackoverflow.com/questions/4800467/retina-display-images-on-iphone)

[@2x for Retina 显示应用的意义何在？](https://stackoverflow.com/questions/9437940/what-is-the-point-of-the-2x-for-retina-display-apps)

另外，这里有一篇关于视网膜设计的文章：http: [//globalmoxie.com/blog/designing-for-iphone4-retina-display.shtml](http://globalmoxie.com/blog/designing-for-iphone4-retina-display.shtml)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-02T00:09:43.960

你只需要在你的包中有@2x-versions 的图像。如果 iOS 在 Retina 硬件上运行，它会自动采用 @2x-version

# php - 如何在类中扩展 PHP 类

> ID：10406022
> 
> 赞同：0
> 
> 时间：2012-05-02T00:03:25.467
> 
> 标签：php, oop, class, extend, internal

我对 OOP 相当陌生，并且有一个关于如何最好地处理使用一个类名的问题，然后根据传递的参数在内部向该类添加功能。

基本故事是我有一个“项目”类，它接受 2 个参数 $module 和 $id。一些“模块”（但不是全部）将具有“项目”类默认不包含的奇特功能。一些模块还希望覆盖项目类中的一些方法。我的目标是能够从项目类的 __construct 中调用模块的“项目”类扩展。我想有一个单一的“项目”类。

我的第一个想法是在构建项目类时创建模块的项目扩展类的实例，然后，每当我调用项目类中的方法时，我都会检查是否有该模块特定的实例并调用该方法在那个实例上。

例如：

```
class item {
    // Variable where I'll store the instance of the child class
    var $child;
    // Child class may call up item's constuct, I'll use this to avoid an infinite loop
    var $child_initalized;
    // Child called, guess we have to keep track of this so we don't get stuck in infite loops either.
    var $child_called = 0;
    // Example variables
    var $id, $name;

    function __construct($module,$id) {
        if(!$this->child_initialized) {
            $this->child_initialized = 1; // So we don't do this again and get stuck in an infite loop
            $child_class = __CLASS__.'_'.$module;
            if(class_exists($child_class)) {
                $this->child = new $child_class($module,$id);
                return;
            }
        }

        // do normal class construction stuff here, such as setting $this->id and $this->name
        $this->module = $module;
        $this->id = $id;
    }

    // So we can catch child methods not in parent item class
    function __call($name,$arguments) {
        if($this->child) {
            return $this->child->$name();
        }
    }

    function id() {
        $this->child_called = 0;
        if($this->child) {
            $this->child_called = 1;
            return $this->child->id();
        }
        return $this->id;
    }
}

class item_photos extends item {
    function __construct($module,$id) {
        $this->child_initialized = 1;
        parent::__construct($module,$id);
    }

    function id() {
        return "photo-".$this->id;
    }

    function photo_width() {
        return 250; // Just some sample value
    }
}

$item = new item('photos',123);
print $item->id()."<br />"; // photo-123
print $item->photo_width()."<br />"; // 250 
```

无论如何，这只是一个简单的例子。但是，我的方法似乎……嗯，错了。有什么更好的方法来实现这一点，还是我应该重新考虑如何构建所有内容？您可以提供的任何建议或想法都会很棒。

/ ***** ** *** ** *** ** *** ***编辑***** ** *** ** *** ** *** *** /

澄清一下，我的目标实际上是能够调用一个类（在我的示例中为“项目”），并且基于传递给它的一个或多个参数，能够基于这些参数动态加载更多功能（在我的示例中，它是 $module)。但是这种额外的功能并不总是存在（所以我不能总是调用 new item_photos 而不是 new item()）。

这是一个更新的示例。在代码末尾调用 $item = new item('videos',456) 是某些模块没有额外功能的示例。

```
class item {
    // Variable where I'll store the instance of the child class
    public $child;
    // Child class may call up item's constuct, I'll use this to avoid an infinite loop. Also to avoid when calling child class in methods.
    public $child_initalized;
    // Example variables
    public $module, $id, $name;

    function __construct($module,$id) {
        if(!$this->child_initialized) {
            $child_class = __CLASS__.'_'.$module;
            if(class_exists($child_class)) {
                $this->child = new $child_class($module,$id);
                return;
            }
        }

        // do normal class construction stuff here, such as setting $this->id and $this->name
        $this->module = $module;
        $this->id = $id;
    }

    // So we can catch child methods not in parent item class
    function __call($name,$arguments) {
        if($this->child) {
            return $this->child->$name();
        }
    }

    function id() {
        $this->child_initalized = 0;
        if($this->child) {
            $this->child_initalized = 1;
            return $this->child->id();
        }
        return $this->id;
    }
}

class item_photos extends item {
    function __construct($module,$id) {
        $this->child_initialized = 1;
        parent::__construct($module,$id);
    }

    function id() {
        return "photo-".$this->id;
    }

    function photo_width() {
        return 250; // Just some sample value
    }
}

$item = new item('photos',123);
print "photo id: ".$item->id()."<br />"; // photo-123
print "photo size: ".$item->photo_width()."<br />"; // 250

$item = new item('videos',456);
print "video id: ".$item->id()."<br />"; // 456
print "video size: ".$item->photo_width()."<br />"; // nothing (that method doesn't exist here) 
```

/ ***** ** *** ** *** ** *****编辑2 ***** ** *** ** *** ***** /

还是有点挣扎。我研究了抽象工厂，它们似乎不起作用。如果我理解正确，我必须在抽象类中声明所有方法，这很棘手，因为模块会扩展项目类，所以我不会知道所有方法。另外，我似乎不得不调用“item_photos”或“item_videos”，而不仅仅是“item”，这是我试图避免的。更不用说在我的示例中 item_videos 甚至不存在。

鉴于我的目标是调用一个类，然后在该类 __construct 中确定是否需要基于 $module 包含任何额外的功能，我想出了这个。

基本上，“item”类的内容被移至新的“item_core”。旧的项目类现在只决定使用哪个类，要么是模块的项目类（如果存在）（例如：item_photos），要么是核心项目类（item_core）。在初始化其中一个类之后，我存储实例并在调用方法时使用它（通过 __call，让我知道为什么使用 __call 不好）。

```
class item {
    // Instance of the core class or module class
    private $instance;

    function __construct($module,$id) {
        $class = __CLASS__;
        $class_core = $class.'_core';
        $class_module = $class.'_'.$module;

        // Module class
        if(class_exists($class_module)) $this->instance = new $class_module($module,$id);

        // Core class
        else $this->instance = new $class_core($module,$id);
    }
    // Catch all calls, redirect accordingly
    function __call($name,$arguments) {
        if($this->instance) {
            if(method_exists($this->instance,$name)) return $this->instance->$name();
        }
    }
}
class item_core {
    public $module, $id;

    function __construct($module,$id) {
        $this->module = $module;
        $this->id = $id;
    }

    function id() {
        return $this->id;
    }
}

class item_photos extends item_core {
    function __construct($module,$id) {
        parent::__construct($module,$id);
    }

    function id() {
        return "photo-".$this->id;
    }

    function photo_width() {
        return 250; // Just some sample value
    }
}

$item = new item('photos',123);
print "photo id: ".$item->id()."<br />"; // photo-123
print "photo size: ".$item->photo_width()."<br />"; // 250

$item = new item('videos',456);
print "video id: ".$item->id()."<br />"; // 456
print "video size: ".$item->photo_width()."<br />"; // nothing (that method doesn't exist in the videos module) 
```

任何人都认为这有任何问题或无论如何要改进它？对我来说似乎还是有点不对劲。

/ ***** *******编辑 3******* *** ****** /***

 ***好吧，在我看来，我想做的事情是能够返回与我调用的不同的实例。因此，调用 new item($module,$id);，但如果 $module == photos（在我的示例中）我想返回 new item_photos($module,$id); 的实例。到目前为止，我提出了两种可能的解决方案。

首先是我在编辑 2 中概述的内容（见上文）。

第二种选择是简单地调用一个函数（可能是'item'）并在那里返回正确的对象实例（因为函数可以返回您想要的任何对象实例，而类构造函数只返回其自己的类的实例）。所以（基本示例）：

```
function item($module,$id) {
    $class_module = 'item_'.$module;
    // Module class
    if(class_exists($class_module)) return new $class_module($module,$id);
    // Core class
    else return new item($module,$id);
}
class item{..}
class item_photos{..}

$item = item('photos',123);
print $item->id(); // photo-123 
```

不确定我喜欢混合函数/类，但它很简单。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:11:17.410

而不是在内部创建子类，您应该在外部创建它并将其注入到`item`类中（依赖注入是您可能想要查找的东西）。您可能希望在控制器中使用工厂来执行此操作。的使用`__call`也有点阴暗，破坏了界面。我不确定为什么您需要围绕`item_photos`.. 进行一定程度的抽象，您可以只使用该对象本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T03:47:56.147

看起来您尝试实现的内容可以通过工厂设计模式来实现。简而言之，当您想要传递一堆配置选项并获取代表您想要使用的对象的东西时，这种模式是很好的。与其尝试从内部更改您的 Item 类，不如创建一个返回新对象的 ItemFactory 类。例如，您向工厂索要一张照片或视频，它返回一个 Photo 类或一个 Video 类（从通用 Item 类扩展而来），其中只有它需要的东西，没有额外的东西。

这是一篇使用 PHP 示例更详细地解释该模式的文章：http: [//sourcemaking.com/design_patterns/abstract_factory/php/2](http://sourcemaking.com/design_patterns/abstract_factory/php/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T00:12:02.480

我想你都搞错了。

假设您要实现一个 class `A`。还有一个类`B`，它具有一些共同的属性，`A`但具有更多的功能。然后一堂课`C`，等等……

这是我的做法：

*   找出你的类的最小共同属性
*   将它们实现为 - 比方说 - 一个`BasicItem`类。（你甚至可能不使用这个类本身，而只是将它用于你的......“派生”类）
*   将所有其他`A`, `B`, 任何类都建立在它之上（使用继承）。***

# ruby-on-rails - Ruby on Rails Rake 迁移日志 .0030 秒但需要 10 秒？

> ID：10406026
> 
> 赞同：1
> 
> 时间：2012-05-02T00:03:47.370
> 
> 标签：ruby-on-rails, performance, rake, cmd

这是一个相当快速的问题，但我不确定如何命名它以找到相关结果。我在具有所有正常初始设置的 Windows 环境中使 RoR 很有趣。我在输入命令和实际执行之间经历了巨大的减速。

最新的例子是做一个简单的 rake db:migrate，它向一个全新的项目添加了一个非常简单的表，它声明它在 0.0030 秒内创建了表并在 0.0040 秒内迁移。然而，在我按下回车键和这个实际显示大约 10 秒之间。从生成到启动服务器的所有事情都会发生这种情况。

这很常见吗？还是我的系统上有什么东西导致了它？

抱歉，我使用的是 Rails 3.2.1（甚至花了大约 1.5 秒来获取该数据）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:17:00.977

一旦加载了 Rails 环境，计时就会启动......这需要很多时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:41:12.557

Ruby 在 Windows 上比在 linux 上慢。如果您运行的是 1.9.2，请尝试更改为 1.9.3，它对慢速“require”有速度改进。 [http://groups.google.com/group/railsinstaller/browse_thread/thread/58666fec49323310?pli=1](http://groups.google.com/group/railsinstaller/browse_thread/thread/58666fec49323310?pli=1)

# java - 在同步集合上同步-> 性能问题

> ID：10406029
> 
> 赞同：1
> 
> 时间：2012-05-02T00:03:58.863
> 
> 标签：java

基于以下答案：我仍然不清楚： concurrentMap 上的同步构造有什么作用，如果有的话。即在并发映射的情况下，同步（映射）与非同步之间有什么区别。***我对解决方案的正确性或相信的优点不感兴趣***。只是对这个问题的回答： 问：在 concurrentmap 上同步和不同步有什么区别？特别是关于性能..就足够了。请不要再说什么了。
我只对发生的事情感兴趣，没有补充建议。

我有一个理论问题，我正在解决一些心理问题：假设我有一个并发集合类 say=>ConcurrentHashMap 映射；

假设我有三种方法：

```
method1: synchronized(map){
       doSomethingWithThemap(); //Assume put integers 1.. 1000000
}

method2:doSomethingWithThemap(); //Note it is not synchronized 
method3:doSomethingElseWithThemap(); //Assume put integers 2000000.. 3000000 
```

现在假设 2 个测试用例：

* * *

*   TestCase1：产生两个线程A和B。A调用method1，B调用method3。
*   TestCase2：产生两个线程 A' 和 B'。A'调用method2，B'调用method3。

从性能的角度来看，我希望 TestCase2 获胜，因为据我了解，在 TestCase1 中，B 无法添加到地图中，尽管是并发的，因为同步块将持有地图上的锁，而在测试用例 2。

我的单元测试不验证这个假设。

问：我在这里缺少什么。即给定并发集合上的同步块是否会影响性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:10:49.667

> 问：我在这里缺少什么。

您对自身进行内部同步的假设`ConcurrentHashMap`是不正确的：根据[源代码](http://www.docjar.com/html/api/java/util/concurrent/ConcurrentHashMap.java.html)，实现使用`java.util.concurrent.locks`对象，其实例隐藏在集合中，因此您无法锁定/同步它们。

一般来说，这是类库编写者应该遵循的建议：如果您需要在对象上同步，请不要在 上同步`this`；在您的类中创建一个私有对象，然后在该对象上进行同步。否则，您可能会面临其他人在您的对象上同步导致的并发问题，并且无限期地持有锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:14:49.700

您无法保证 ConcurrentHashMap 将其实例用作监视器。它可能非常使用其他一些对象来锁定！

```
private Object lock = new Object();

synchronized(lock) {
   // do some stuff - you can't get my lock because it is private
} 
```

ConcurrentHashMap 甚至有可能不使用锁，而是使用其他一些并发原语，如比较和设置、信号量等。

Java 中的锁是可重入的，所以如果你已经持有锁，你就不会阻塞自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:18:01.423

ConcurrentHashMap 没有使用同步...虽然仍然是线程安全的，但是例如 get 调用并没有锁定任何东西。并发数据结构非常好和有趣。好吧，它在某些情况下确实使用了一些内部锁定，但没有暴露任何东西，当然也不会暴露对象的监视器本身。

顺便一提。像这样测量并发代码性能相当棘手，并且会因运行和计算机而异，但无论如何都存在缺陷。

但是，如果您改用同步的哈希图，理论上它可以像您描述的那样工作。`Collections.synchronizedMap(yourMap);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T10:07:58.347

```
What does the synchronized construct on the concurrentMap do, if anything 
```

它只是浪费时间和空间。`ConcurrentMap`已经体现了处理并发的替代方法。

# c - MIPS32：递归子程序在“jr ra”行崩溃

> ID：10406031
> 
> 赞同：2
> 
> 时间：2012-05-02T00:04:39.837
> 
> 标签：c, merge, mips

我写了一个实现归并排序算法的 MIPS 子程序（代码在文章的最后）。它接收指向数组的指针及其大小。排序，不要返回任何东西。

我一直在调试它，修复了一些错误，并且由于子例程在达到基本情况（大小为 1 的数组）之前似乎运行良好，现在我正在使用 gdb 和这段 C 代码来针对特定情况对其进行调试：

```
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

extern void merge_sort(char*, int);

int main(int argc,char **argv){

    char* vector;
    vector = (char*)malloc(sizeof(char));
    if(vector == NULL) printf("error");

    size_t vector_size = 1;
    memcpy(vector,"5",vector_size);

    merge_sort(vector, vector_size);

    int i;
    for(i = 0; i < vector_size; i++){
            printf("%c ", vector[i]);
    }

    printf("\n");
    return 0;
} 
```

我的问题是，当我单步执行子程序行时，当我到达倒数第二行（jr ra）时，它崩溃并以代码 060 退出，并且 gdb 显示此消息：

```
Warning: GDB can't find the start of the function at 0x400730.
    GDB is unable to find the start of the function at 0x400730
    and thus can't determine the size of that function's stack 
    frame. This means that GDB may be unable to access that stack
    frame, or the frames below it.

    This problem is most likely caused by an invalid program 
    counter or stack pointer.  However, if you think GDB should
    simply search farther back from 0x400730 for code which looks
    like the beginning of a function, you can increase the range 
    of the search using the `set heuristic-fence-post' command. 
0x004008a0 in _start 
```

我不明白为什么会这样。我认为这可能是存储在 中的地址有问题，`ra`堆栈分配错误，或者 C 和 MIPS 代码之间的链接错误，但我不知道我做错了什么。

下面是 merge_sort 的 MIPS 代码：
对于基本情况，代码运行到 行`beq t1, zero, SALIDA`，然后跳转到`SALIDA`，并结束。所以我只是粘贴那部分代码（SALIDA 意味着退出西班牙语：P）。

```
#include <mips/regdef.h>
#include <sys/syscall.h>

#define     SSIZE   (56)
#define     O_RA    (48)
#define     O_FP    (44)
#define     O_GP    (40)
#define     O_S3    (36)
#define     O_S2    (32)
#define     O_S1    (28)
#define     O_S0    (24)
#define     O_ARG0  (SSIZE)
#define     O_ARG1  ((SSIZE) + 4)

.text
.align  2
.globl  merge_sort
.ent    merge_sort

merge_sort:
.frame $fp, SSIZE, ra
.set noreorder
.cpload t9
.set reorder     

subu    sp,sp,SSIZE

sw  s0, O_S0(sp)
sw  s1, O_S1(sp)
sw  s2, O_S2(sp)
sw  s3, O_S3(sp)

sw  gp, O_GP(sp)
sw  $fp, O_FP(sp)
sw  ra, O_RA(sp) 
move    $fp, sp

sw  a0, O_ARG0($fp)
sw  a1, O_ARG1($fp)

lw  t0, O_ARG1($fp)
addi    t1, t0, -1

beq     t1, zero, SALIDA

SALIDA:     
lw  s0, O_S0($fp)
lw  s1, O_S1($fp)
lw  s2, O_S2($fp)
lw  s3, O_S3($fp)

move    sp, $fp
lw  gp, O_GP($fp)
lw  $fp, O_FP($fp)
lw  ra, O_RA($fp) 

addiu   sp, sp, SSIZE

jr  ra

.end    merge_sort 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:03:57.613

我认为您的问题是在子例程接近尾声时出现以下问题：

```
lw  $fp, O_FP($fp)    // restores $fp
lw  ra, O_RA($fp)     // restore ra, but $fp isn't pointing to our frame anymore 
```

我认为如果你颠倒这些指令可能会更好。

# jakarta-ee - Java EE 6 注入抽象类

> ID：10406032
> 
> 赞同：9
> 
> 时间：2012-05-02T00:04:47.413
> 
> 标签：jakarta-ee, glassfish, ejb-3.1

在我正在处理的 Java EE 6 项目中，有一个用 @EJB 注释的单独字段没有被注入。注射在其他任何地方都可以正常工作。

作为 Java EE 的新手，我不知道它是否与抽象类中的字段有关，也找不到 Glassfish（3.1.2）关于为什么没有发生这种注入的任何输出。

在发生 NullPointerException 之前，服务器日志中没有错误或警告，因为 dataSourceControl 字段为空。我已经通过将日志记录到它的构造函数中来验证 DataSourceControl Singleton 正在被实例化。

据我所知，没有注入 dataSourceControl 字段，但是日志没有给我任何理由。

```
public abstract class AbstractDataMap<T> {
  @EJB
  private DataSourceControl dataSourceControl; // This is not being injected

  DataSourceControl getDataSourceControl() {
    return dataSourceControl;
  }
  // Other methods
}

public abstract class AbstractDataMapDBProd<T> extends AbstractDataMap<T> {
  @Override
  protected Connection getDBConnection() {
    return getDataSourceControl().getConnectionX(); // NullPointerException here
  }
  // Other methods
}

@Stateless
public class CountryMap extends AbstractDataMapDBProd<Country> {
  public boolean update(final Country current, final Country legacy) {
    Connection connection = getDBConnection();
    // More code 'n stuff
  }
} 
```

关于抽象类中定义的注入，我是否遗漏了任何规则？

还有什么叫“菜鸟”的吗？

如果没有明显的错误，关于如何调试的任何想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T13:01:45.483

注入适用于任何类（基类、超类、抽象超类等）。`CountryMap`但是，只有当您从容器（即注入或查找）而不是通过获取实例时，注入才会起作用`new CountryMap`。你如何获得一个实例`CountryMap`？

# android - Android Layout 将高度设置为其容器的特定百分比？

> ID：10406040
> 
> 赞同：0
> 
> 时间：2012-05-02T00:05:51.087
> 
> 标签：android

我想将包含在相对布局中的内部布局设置为其包含的布局的特定百分比。如何将布局高度设置为特定百分比。另一个例子假设我有一个 ImageView，我希望它恰好占据它所在容器的 60%。我该如何指定？我确实看到了：[Android Layout Percentage/Proportion Resize](https://stackoverflow.com/questions/9693787/android-layout-percentage-proportion-resize)这在一定程度上解释了这一点。但是，如果我想说 48%，我不确定调整重量是否有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:14:38.497

您需要使用`LinearLayout`属性`android:layout_weigth`.

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:weightSum="5"
    android:orientation="vertical" >
    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="2" >

    <!-- Other elements here -->

    </RelativeLayout>
    <ImageView
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="3" />
</LinearLayout> 
```

嵌套`RelativeLayout`将占用 2 / (2 + 3) = 0.4 (40%) 和`ImageView`3 / (2 + 3) = 0.6 (60%)。

# mysql - 数据库设计：如何允许对等订单又名棒球交易卡交易模型

> ID：10406043
> 
> 赞同：2
> 
> 时间：2012-05-02T00:06:12.390
> 
> 标签：mysql, database, relational-database

当谈到如何处理数据库设计时，我很困惑。我环顾四周，发现了像[http://www.tomjewett.com/dbdesign/dbdesign.php?page=manymany.php](http://www.tomjewett.com/dbdesign/dbdesign.php?page=manymany.php)这样的例子，这对于销售商品的商店来说效果很好，但我想建立一个跟踪销售的数据库（或交易）两个用户之间。

前约翰用卡片 x1、x2、x3、x4 换取 Jane's (4 * y1)、y2 和 5.00 美元。（在这个例子中，约翰用四张牌交换了 5 张名为 x1、x2、x3、x4 的牌，换了 4 张名为 y1 的牌，1 张名为 y2 和 5.00 美元。）

我还希望简能够向约翰提供额外的卡片，或者她可能想要平衡的任何东西。

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:15:30.337

这是关系数据库设计的一个有趣示例。本质上，我的建议是创建一个尽可能标准化的结构。这基本上意味着您想要创建表格以便您可以填写空白：“此表格中的一行代表一个唯一的***_* _** ”。

对于您的特定应用，我建议：

*   用户表，每个用户 1 行
*   一张卡片表，每张卡片 1 行（无论世界上有多少该卡片的实例 - 例如 Topps 的 1984 年迈克尔乔丹新秀卡片的一行）
*   一张交易表，每笔交易一行。您可能希望交易行包含参与交易的 user1 和 user2 的列，使用他们在 users 表中的 ID。如果您想要还价的能力，我建议还价只是此表中的另一行，其中“original_offer”列引用了还价所基于的报价。
*   贸易项目表。在这里，交易中涉及的每个项目都有 1 行，其中包含数量。每一行都有一个映射到交易表的交易ID、一个映射到卡表的卡ID、一个数量列以及“从”和“到”列，每个列都映射到所涉及的用户ID。

# clojure - 如何使用 leiningen 引用其他文件中的函数？

> ID：10406044
> 
> 赞同：15
> 
> 时间：2012-05-02T00:06:16.593
> 
> 标签：clojure, classpath, leiningen

我对 Clojure 还是很陌生，所以如果这是一个完全新手的问题，我深表歉意，但我无法在网上找到足够的答案。

基本上，我的问题是，每当我尝试运行我的项目时，都会收到如下错误：

```
Exception in thread "main" java.lang.RuntimeException: java.io.FileNotFoundException: Could not locate greeter__init.class or greeter.clj on classpath: 
```

在这种情况下，greeter.clj 与包含我的 main 函数的文件在同一目录中的项目中。

出于说明目的，我创建了一个具有如下目录树的项目：

![在此处输入图像描述](../Images/43a1e68b558c137e3901374b64422ae5.png)

我的 core.clj 代码如下：

```
(ns omg.core
(require [greeter]))

(defn -main[] (greet)) 
```

我的 greeter.clj 代码是：

```
(ns greeter)

(defn greet [] println("Hello world")) 
```

每当我输入时`lein run -m omg.core`，我都会得到上面提到的异常。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-02T00:15:08.110

迎宾名称空间它在错误的级别

```
(ns omg.greeter) 
```

命名空间中的名称对应于路径中的文件夹，因此要使用 /src/omg/greeter.clj 中的文件，该文件应包含`omg.greeter`命名空间。如果您只想调用`greeter`它，请将其移到一个文件夹中

使用时，`require`您需要拼出您正在调用的函数的名称空间，在这种情况下为`(omg.greeter/greet)`. 由于这很痛苦，因此该`use`函数需要一个命名空间并将其所有函数添加到当前命名空间。另一个更具选择性的选项是在命名空间定义中使用 require 和 :refer 选项

```
(ns omg.core
    (require [omg.greeter :refer :all])) 
```

或者

```
(ns omg.core
    (require [omg.greeter :refer [greet]])) 
```

大多数人将命名空间要求放在`ns`文件顶部的调用中。

快速阅读[http://clojure.org/namespaces](http://clojure.org/namespaces)希望能有所帮助

# web - 提供离线网站的最佳方式

> ID：10406046
> 
> 赞同：1
> 
> 时间：2012-05-02T00:06:34.330
> 
> 标签：web, offline, presentation

对于我正在开发的网站，我需要能够将其交付给客户，以便他们可以轻松地运行它以进行演示。理想情况下，他们会在本地运行它以避免互联网问题，但我们总是必须向人们提供有关如何解压缩文件的说明，而不是将它们解压缩到临时文件，等等。有没有一种聪明的方法来交付离线网络应用程序并或多或少地创建一个“运行”按钮？还是一个非常轻量级的程序，可以在他们选择的位置重建站点？他们想要一个类似幻灯片的东西，你可以在其中双击它。

该文件是一个 HTML 文件，可能包含 20 个外部文件（图像、JS、CSS），但没有服务器端代码。

我猜不是，但你们很聪明，我认为这是工作要求。

**更新**

你们想通了。这是我在完成我需要的自我安装程序之后运行的批处理脚本。

这是我最终使用的代码：`

```
@echo off
MD "%USERPROFILE%\Desktop\SMBInfographic"
MOVE /Y ".\infographic" "%USERPROFILE%\Desktop\InstallFolder"

start /d "C:\Program Files\Internet Explorer" iexplore.exe "%USERPROFILE%\Desktop\InstallFolder\infographic\launch.html"

EXIT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:00:02.707

如果您不介意您的团队养成运行其他人发送的可执行文件的坏习惯，您可以使用 WinZip 的自解压可执行文件创建器；它将提供一个`.exe`包含足够 Zip 算法的文件来解压缩文件中包含的数据。

[如果您购买昂贵的版本，您甚至可以在完成后让它运行特定命令](http://kb.winzip.com/kb/?View=entry&EntryID=184)——这可能会启动一个正在运行的程序，`start index.html`该程序应该启动浏览器......（我没有*尝试*过专业的版本，距离我上次制作自解压 Zip 已经有好几年了，但 WinZip 团队可能不会让我失望。）

[7zip](http://www.7-zip.org/)还提供了一个自解压器输出；由于使用了不同的压缩技术，输出可能会更小。它也是免费的。但我没有尝试过，甚至几年前也没有:)，所以它在我的回答中得到了第二次计费。

# java - 广泛的更新声明

> ID：10406050
> 
> 赞同：1
> 
> 时间：2012-05-02T00:06:50.140
> 
> 标签：java, android, database

我有一个存储在数据库中的大约 4000 个烹饪食谱应用程序，当用户打开应用程序时，我有一个 ViewPager 显示单个食谱，并且在滚动时他将获得新食谱，如果用户关闭应用程序并重新打开它我想要什么展示他以前没见过的食谱。

到目前为止我尝试过的

在我的食谱表中， `( _id , name , content , view_rank)`我将`view_rank`字段以值开头，`0`因此如果当 viewpager 显示此食谱时，它将增加`view_rank` 我的查询中的所以我做这个

`SELECT * FROM RECIPES ORDER BY view_rank ASC`所以我有了新的。任何方式每个增量都会导致应用程序触发一个新线程来更新数据库，我正在考虑的是实现一个自定义缓冲区，其中包含需要增量的配方的 id，所以如果缓冲区达到它的限制，可以说 100 id i将启动一个新线程并进行事务以更新这 100 个 id's 。有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:01:35.230

当用户滚动浏览您`ArrayList`的. 我假设您正在使用按钮滚动页面，因此当您单击该按钮时，将 添加到，还使用该方法检查 的大小是否为 100 。如果大小为 100，则遍历列表并更新数据库。`_id``ViewPager``_id``ArrayList``ArrayList``size()`

API 在`ArrayList`这里[Array List](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)

--EDIT--
当你这样做时，不要忘记在关闭应用程序时将结果更新到数据库。否则，如果计数器没有达到 100，则数据库更新永远不会发生，并且在下一次启动时，您将再次看到访问过的记录..

# c# - GC.Collect() 和 PerformanceCounter

> ID：10406054
> 
> 赞同：8
> 
> 时间：2012-05-02T00:07:25.723
> 
> 标签：c#, .net, memory-leaks, odp.net, performancecounter

我的一位同事确信 Oracle 的 odp.net ado.net 实现中存在内存泄漏。他编写了一个测试程序来测试这个理论，并在对每个对象调用 dispose 后执行以下操作以确定释放了多少内存：

```
PerformanceCounter p = new PerformanceCounter("Memory", "Available Bytes");

GC.Collect();
GC.WaitForPendingFinalizers();

float mem = p.NextValue(); 
```

然后将得到的性能值与在处理对象之前检索到的值进行比较。这会产生准确的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:00:32.343

我认为最好的方法是使用[`GC.GetTotalMemory(true)`](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx). 您可以在分配对象之前调用它来记录当时分配了多少内存。然后你创建你的对象，也许对它执行一些操作，处理它，确保没有对它的引用（可能只是将局部变量设置为`null`），然后再次调用它。

请注意，返回的值可能不完全准确，根据文档，该方法将返回：

> 一个数字，它是托管内存中当前分配的字节数的最佳可用近似值。

之后，您可以比较这两个值。如果您重复执行此操作，您可以查看对象是否实际上正在泄漏托管内存。

当然，如果对象泄漏非托管内存，这将无济于事。

另一种选择是使用内存分析器，但如果您知道内存可能泄漏的确切位置，这可能有点过头了。

# jquery - 如何从 USB 秤读取重量

> ID：10406055
> 
> 赞同：0
> 
> 时间：2012-05-02T00:07:29.250
> 
> 标签：jquery, ajax

我有一个体重秤，我正在尝试通过和/或服务器端（经典 asp）`USB`将读数导入 HTML 表单。`Ajax/Js``VBScript`

有人对我应该从哪里开始搜索有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:45:55.727

**概念错误。**

浏览器是**安装**在计算机上的软件。Javascript 只是在浏览器中运行的脚本。Javascript 无法访问浏览器未向其显示的任何内容。

如果浏览器为 Javascript 提供了对随机连接硬件的访问权限，那么一个简单的网页就可以复制您的硬盘驱动器、启动您的网络摄像头或摧毁核电站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:13:02.180

我将首先查看设备随附的文档。您可能需要一些真正为您读取值的驱动程序，然后您才能将其传递

# git - 不检查分支

> ID：10406056
> 
> 赞同：0
> 
> 时间：2012-05-02T00:07:33.697
> 
> 标签：git, branch, commit

我尝试多次运行：

```
git checkout mygithub/master 
```

不幸的是，它没有检查这个分支：

```
git status
# Not currently on any branch.
nothing to commit (working directory clean) 
```

那么我该怎么做才能签出分支并推送提交呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:09:30.837

```
git clone git@github.com:myusername/myrepo.git
cd myrepo
git checkout master 
```

然后编辑你的文件

```
git status
git add .
git commit
git push origin master 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:29:09.193

> 不幸的是，它没有检查这个分支

问题实际上是它*确实*检查了那个分支（或者更确切地说，那个分支头部的提交），但这不是你想要它做的。

一些背景知识：当您将远程 ( `github`) 添加到本地存储库时，您的本地存储库会`github/master`为该远程的所有分支创建“远程分支”( )。当您说 时`git checkout github/master`，您是在告诉 git 让您离开任何本地分支，并将您的工作副本更新为该时间点远程仓库的状态。您只能在本地分支上提交，因此会出现问题。有关详细信息，请参阅文档[`git checkout`](http://schacon.github.com/git/git-checkout.html)。

通过这样做`git checkout master`，您正在做两件事：首先，最重要的是，创建一个名为的本地分支`master`，默认情况下设置为跟踪它可以找到的具有相同名称的任何远程分支（希望`github/master`在这种情况下），然后让您使用分支并使用其内容更新您的工作副本。请参阅文档[`git branch`](http://schacon.github.com/git/git-branch.html)（因为第一步是创建分支）和[`git config`](http://schacon.github.com/git/git-config.html)下面的文档`branch.autosetupmerge`以了解幕后发生的事情。

# .net - 在 WPF 文档查看器中使用文本框或下拉列表中的百分比添加分页控件和缩放

> ID：10406062
> 
> 赞同：0
> 
> 时间：2012-05-02T00:08:29.233
> 
> 标签：.net, wpf, xaml, controls, customization

关于如何扩展 WPF 的 Document Viewer 控件，我已经在网上搜索了很长一段时间，但什么都没有。

我想通过文本框/下拉列表中的百分比添加分页功能以及缩放效果。这可能吗？如何？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:56:51.123

终于想通了！我扩展了文档查看器的样式，以包括用于缩放的寻呼机和组合框，因为它是 xaml。然后处理两个控件的 textchanged 和 selected item changed 以手动更新文档查看器。documentViewer.GotToPage(n) 和 documentViewer.Zoom。

# c++ - 正在使用“！！” 在 C/C++ 良好实践中，它很常见吗？

> ID：10406063
> 
> 赞同：8
> 
> 时间：2012-05-02T00:08:57.870
> 
> 标签：c++, c

> **可能重复：**
> [C++ 代码中的双重否定](https://stackoverflow.com/questions/248693/double-negation-in-c-code)

据我所知，没有 C/C++ 书籍教程或手册提到这种技术。可能因为只是一件小事，不值一提。

我使用它是因为 C/C++ 将 bool 类型与 int、long、pointer、double 等...混合在一起。需要将非布尔值转换为布尔值是很常见的。使用 (bool)value 这样做是不安全的，所以我习惯`!!`这样做。

例子：

```
bool bValue = !!otherValue; 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T00:11:40.027

很好，任何 C 或 C++ 程序员都应该识别它，但我更喜欢更明确的东西

```
(x != 0) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-02T00:15:12.443

我认为`!!`与其他一些选择相比非常清楚，例如：

```
if (foo)
  bar = 1;
else
  bar = 0; 
```

或者`bar = foo ? 1 : 0;`

由于`!!`只做一件事，我觉得它非常明确。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-02T00:11:16.963

在这种确切的情况下：

```
bool bValue = !!otherValue; 
```

你不需要写`!!`。没有它们它会正常工作：

```
bool bValue = otherValue; 
```

我认为在大多数情况下隐式转换会很好。

# scala - scala中的插入排序实现

> ID：10406064
> 
> 赞同：5
> 
> 时间：2012-05-02T00:09:03.523
> 
> 标签：scala, insertion-sort

我正在尝试 Scala，我想看看如何在 scala 中实现插入排序，并满足以下要求：

1.  嵌套 for 循环
2.  Array[Int] 用于输入
3.  如果可能，可以通过引用方式在调用中修改函数内容，否则返回 Array[Int]

如果这不是实现插入排序的 Scala 方式，您仍然可以提供上述代码并解释该方法有什么问题。编辑：这是使用 while 循环的尝试（确实有效），不，这不是家庭作业问题，为什么会有敌意？

```
def insert_sort(a:Array[Int]):Array[Int]={
for(i <- 0 until a.length)
{
  var j=i+1

  while(j>1&&a(j)<a(j-1)&&j<a.length)
  {
      var c=a(j)
      a(j)=a(j-1)
      a(j-1)=c
      j-=1
  }
}
return a
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-09-17T10:41:19.307

这就是我想出的，它似乎是功能性的、通用的、尾递归的（`foldLeft`是尾递归的）......：

```
def insertionSort[A](la: List[A])(implicit ord: Ordering[A]): List[A] = {
  def insert(la: List[A], a: A) = {
    val (h, t) = la.span(ord.lt(_, a))
    h ::: (a :: t)
  }

  la.foldLeft(List[A]()) {(acc, a) => insert(acc, a)}
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-07-05T17:52:36.340

迄今为止我见过的最优雅的插入排序算法实现：

```
val rand = List(5,3,1,2)

def isort(xs: List[Int]): List[Int] =
  if (xs.isEmpty) Nil
  else insert(xs.head, isort(xs.tail))

def insert(x: Int, xs: List[Int]): List[Int] =
  if (xs.isEmpty || x <= xs.head) x :: xs
  else xs.head :: insert(x, xs.tail)

isort(rand) // Produces List(1,2,3,5) 
```

算法实现取自这本好书：[https ://www.artima.com/shop/programming_in_scala_3ed](https://www.artima.com/shop/programming_in_scala_3ed)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-15T09:37:38.803

我的插入排序过程版本如下。它由两个函数组成，`isort`具有`insert`以下签名：

*   `isort(xs: List[int]) : List[int]`: 接受一个整数列表并输出一个整数列表。
*   `insert(x: Int, xs: List[int]) : List[int]`接受一个排序的输入列表和一个整数`x`，并添加`x`到列表中的正确位置以保持列表排序的不变性。例子：`insert(3, [1, 2]) = [1, 2, 3]`

首先让我们编写`insert`函数。

1.  如果列表为空，则返回要添加的整数列表。
2.  否则，有两种可能的情况。列表的头部大于或等于给定的输入整数，在这种情况下，我们只需将输入整数附加到列表的开头并返回它。另一种情况是输入整数大于输入列表的头部。在这种情况下，我们递归地将输入整数插入到列表的尾部。

    ```
    def insert(x : Int, xs : List[Int]) : List[Int] = {

    xs match{
        case Nil => List(x)
        case y :: xs1 =>
            if(y >= x) x :: xs
            else y :: insert(x,  xs1)
     }

    } 
    ```

第二个函数是`isort`，它接受一个输入列表并对其进行排序。算法如下：

1.  如果输入列表等于`Nil`，则返回`Nil`。
2.  否则，递归排序列表的尾部，并将头部添加到（排序的）尾部的正确位置（使用`insert`过程）

    ```
     def isort(xs : List[Int]) : List[Int] = {
      xs match{
        case Nil => Nil
        case x :: xs1 => insert(x, isort(xs1))

       }

     } 
    ```

我们可以对此进行测试，`isort(List(1, 6, 4, -2, 5, 12))`并得到正确的预期输出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-02T02:07:20.527

嵌套 for 循环可能不是 Scala 中的答案，无论是什么问题。它们在 for 循环代表“重复直到条件，每次迭代都改变它”的语言中是有意义的，这*不是*Scala 中的 for 循环或 for 理解（for 理解是一个 for 循环，它为每次迭代产生一些东西）。

在 Scala 中，for 循环和 for 推导是对集合元素的迭代（或者对于非集合 monad 来说更奇怪的事情），但是对于插入排序，您想要*找到*一个位置，要么将位置交换到该位置，要么插入元素在那个位置。不应该使用 for 循环或 for 理解来查找内容。

此外，Scala 中没有传递引用。而且，事实上，`Array`它甚至不是一个 Scala 集合，而是一个 Java 的东西，它具有 JVM 赋予它的独特特性，这些特性不能用类重现，所以它不能被替换。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-11T05:58:05.727

这是插入排序的另一个通用版本：

```
 def less[T <: Comparable[T]](i: T, j: T) = i.compareTo(j) < 0

  def swap[T](xs: Array[T], i: Int, j: Int) { val tmp = xs(i); xs(i) = xs(j); xs(j) = tmp }

  def insertSort[T <: Comparable[T]](xs: Array[T]) {
    for { i <- 1 to xs.size
          j <- List.range(1, i).reverse
          if less(xs(j),xs(j - 1)) } swap(xs, j, j -1)
  } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-04T11:37:58.327

你需要它做什么？
如果您只想要一个排序的数组，我更喜欢：`def sortArray(a: Array[Int]): Array[Int] = a.sortWith(_ < _)`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-30T15:00:57.943

在开始时不要忘记添加：

```
import scala.util.control.Breaks._ 
```

这是我的解决方案，使用列表作为输入

```
def insertionSortLoop(list :List[Int]) : List[Int] = {
      val intArray: Array[Int] = list.toArray
      for ( j <- 1 until intArray.length ) {
          breakable {
            for ( i <- (1 to j).reverse ) {
              if (intArray(i-1) < intArray(i)) {
                break
              } else {
                  val temp = intArray(i)
                  intArray(i) = intArray(i-1)
                  intArray(i-1) = temp
              }
            }
        }
      }
      intArray.toList
    } 
```

我在[github](https://github.com/moxi/scala-algorithms/blob/master/sorting/InsertionSort.scala)有实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-08-06T17:10:46.270

这是使用 foldLeft 编写的代码示例。

```
def insertionSort(input: List[Int]): List[Int] = {

  input.foldLeft(List[Int]())( (acc, element) => {

    val (firstHalf, secondHalf) = acc.span(_ < element)

    //inserting the element at the right place
    firstHalf ::: element :: secondHalf
  })
} 
```

这个例子可以在这个[github](https://github.com/ChandraAddala/functional-programming-scala/blob/master/src/main/scala/examples/NestedLoops.scala) repo 中找到。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-02T01:11:03.247

[维基百科文章](http://en.wikipedia.org/wiki/Insertion_sort)中给出的实现符合您的要求。在这里，复制、粘贴并转换为 Scala 语法：

```
def insertionSort(a: Array[Int]): Array[Int] = {
  for (i <- 1 until a.length) {
    // A[ i ] is added in the sorted sequence A[0, .. i-1]
    // save A[i] to make a hole at index iHole
    val item = a(i)
    var iHole = i
    // keep moving the hole to next smaller index until A[iHole - 1] is <= item
    while (iHole > 0 && a(iHole - 1) > item) {
      // move hole to next smaller index
      a(iHole) = a(iHole - 1)
      iHole = iHole - 1
    }
    // put item in the hole
    a(iHole) = item
  }
  a
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-27T20:04:17.940

尽管在编写 Scala 时，我习惯于更喜欢函数式编程风格（通过组合器或递归）而不是命令式编程风格（通过变量和迭代），这一次，对于这个特定问题，老派的命令式嵌套循环导致更简单的代码读者。对于某些类型的问题（例如排序算法，它通常会改变作为输入传递的项目缓冲区，而不是产生新的排序集合），我不认为回退到命令式样式是错误的

这是我的解决方案：

```
package bitspoke.algo

import scala.math.Ordered
import scala.collection.mutable.Buffer

abstract class Sorter[T <% Ordered[T]] {

  // algorithm provided by subclasses
  def sort(buffer : Buffer[T]) : Unit

  // check if the buffer is sorted
  def sorted(buffer : Buffer[T]) = buffer.isEmpty || buffer.view.zip(buffer.tail).forall { t => t._2 > t._1 }

  // swap elements in buffer
  def swap(buffer : Buffer[T], i:Int, j:Int) {
    val temp = buffer(i)
    buffer(i) = buffer(j)
    buffer(j) = temp
  }
}

class InsertionSorter[T <% Ordered[T]] extends Sorter[T] {
  def sort(buffer : Buffer[T]) : Unit = {
    for {
      i <-  1 until buffer.length
      j <-  i until 0 by -1
      if (buffer(j) < buffer(j - 1))
    }
    swap(buffer, j, j - 1)
  }
} 
```

如您所见，`java.lang.Comparable`我更喜欢`scala.math.Ordered`Scala View Bounds 而不是Upper Bounds，而不是使用。这肯定是有效的，这要归功于原始类型到丰富包装器的许多 Scala 隐式转换。

您可以编写一个客户端程序，如下所示：

```
import bitspoke.algo._
import scala.collection.mutable._

val sorter = new InsertionSorter[Int]
val buffer = ArrayBuffer(3, 0, 4, 2, 1)
sorter.sort(buffer)

assert(sorter.sorted(buffer)) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-30T00:02:07.903

[Github 链接到 Scala 实现](https://github.com/brodderickrodriguez/Scala-Sort-Methods-and-Data-Structures/blob/master/src/main/scala/sort/InsertionSort.scala)

伪代码：

```
Algorithm Insertion-Sort-Descending(A)
    for j <- 2 to length[A]
        key <- A[j]                 // element we wish to insert
        i <- j - 1                  // position to the left side
        while i > 0 and A[i] < key  // while has not found correct position <-- difference between Ascending and Descending
            A[i + i] = A[i]         // right shift element
            i = i - 1               // decrement i
        A[i + 1] = key              // found position, place key 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-22T19:39:04.507

考虑到您想要一个不可变的插入排序实现，[adijo](https://stackoverflow.com/questions/10406064/insertion-sort-implementation-in-scala#answer-27960477)和[@RB_](https://stackoverflow.com/questions/10406064/insertion-sort-implementation-in-scala#answer-44932945)的答案大多是正确的。

但是，对于大于约 50.000 个条目的列表，这些实现会因 StackOverflow 错误而炸毁堆栈。这是因为那里使用的递归方法不是@tailrec。

一种可能的解决方案是使用[CPS](https://www.youtube.com/watch?v=9edE_4yvNOI&t=1666s)制作方法 tailrec，如下：

```
object Sort {
    def apply[A: Ordering](list: List[A]): List[A] = {

        @tailrec
        // In order to make this code tailrec, we are using CPS (continuation passing style)
        def insert(entry: A, list: List[A])(k: List[A] => List[A]): List[A] =
          list match {
            case Nil                       => k(List(entry))
            case head :: _ if entry < head => k(entry :: list)
            case head :: tail              => insert(entry, tail)(r => k(head :: r))
          }

        @tailrec
        def inner(sorted: List[A], rest: List[A]): List[A] =
          rest match {
            case Nil          => sorted
            case head :: tail => inner(insert(head, sorted)(identity), tail)
          }

        inner(Nil, list)
    }
} 
```

值得注意的是，不可变的实现总是比可变的慢。

从我所做的[基准测试结果来看，插入排序在可变实现下的执行速度提高了大约 2.5 倍。](https://github.com/umbreak/algorithm#benchmarks)

# php - 在 PHP 中，我们如何返回一个大数组？

> ID：10406067
> 
> 赞同：6
> 
> 时间：2012-05-02T00:09:21.090
> 
> 标签：php

说如果这是代码：

```
function bar() {
    $result = array();
    for ($i = 0; $i < 1000; $i++) {
        $result[] = $i * 10;
    }
    return $result;
}

$ha = bar();
print_r($ha); 
```

因为它是“按值返回”，所以返回这样的大数组是否效率不高？（假设不是 1000 而是 1000000）。因此，为了改进它，我们是否将第一行更改为：

```
function &bar() { 
```

也就是说，只需`&`在函数名称前添加一个 - 如果返回一个大数组，这是一种正确且首选的方式吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T00:15:58.187

关于 PHP 如何处理变量存储存在很多误解。由于 PHP 是“写入时复制”，因此无需创建“引用”（实际上是符号表别名）来节省空间或时间。事实上，这样做会伤害你。如果您想将其用作某事物的别名，您应该*只在 PHP 中创建一个引用。*我运行了你的两个片段，看起来第二个实际上使用*了更多*的内存（虽然不是很多）。

顺便说一句，1000 个整数的数组*很小*。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T00:15:40.930

由于 COW，它们消耗的**内存**量[完全相同](http://www.research.ibm.com/trl/people/mich/pub/200901_popl2009phpsem.pdf)

1.  [http://ideone.com/bZgm7](http://ideone.com/bZgm7)
2.  [http://ideone.com/e3Jfr](http://ideone.com/e3Jfr)

PS：要通过引用获得“真实”传递，您还需要在作业中添加它：

```
$ha =& bar(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-02T00:16:07.513

如果你在`memory_get_peak_usage()`函数内外都抛出 a ，你会看到返回数组并不会增加内存。

PHP 在写入时复制。在这种情况下，即使你写了也没有什么可复制的，因为原始变量超出了范围。所以不，没有理由这样做。

事实上，在 PHP 中，通常没有理由使用引用，除非您需要它们提供的*功能*：更改原始变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T00:20:03.097

官方手册页说：当您想使用函数查找应该将引用绑定到哪个变量时，通过引用返回很有用。不要使用按引用返回来提高性能。引擎会自行自动优化。仅在您有正当的技术理由时才返回参考资料

[http://it2.php.net/manual/en/language.references.return.php](http://it2.php.net/manual/en/language.references.return.php)

所以，在你的情况下，不要使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T00:16:06.280

那这个呢？

```
function bar($result) {
    $result = array();
    for ($i = 0; $i < 1000; $i++) {
        $result[] = $i * 10;
    }
}

bar(&$ha);
print_r($ha); 
```

# ruby-on-rails - 为什么我的 gem 列表在我的 gem 列表中显示 gem，但不允许我在 Ruby on Rails 中卸载它？

> ID：10406070
> 
> 赞同：0
> 
> 时间：2012-05-02T00:09:37.277
> 
> 标签：ruby-on-rails, gem

目前在我的控制台中我输入`gem list`，它显示了`diff-lcs`gem 的两个版本：
`diff-lcs (1.1.3, 1.1.2)`

当我运行时，`gem uninstall diff-lcs`我收到以下错误：
`INFO: gem "diff-lcs" is not installed`

我目前正在运行 RVM。当我跑步时，`rvm current`我得到：
`ruby-1.9.2-p290`

为什么会这样？我不应该能够卸载它吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T12:14:43.183

RVM 使用全局 gemset，在尝试从中卸载 gem 之前，我已经看到了类似的行为。您可以通过更改为该 gemset 然后卸载它们来卸载此 gem：

```
rvm gemset use global
gem uninstall diff-lcs 
```

# javascript - 在javascript中的window.open之前暂停

> ID：10406073
> 
> 赞同：2
> 
> 时间：2012-05-02T00:09:44.833
> 
> 标签：javascript, window.open

> **可能重复：**
> [如何告诉浏览器停留在当前窗口](https://stackoverflow.com/questions/10491349/how-to-tell-browser-to-stay-on-current-window)

在这段代码中，我有一个 onclick，它调用一个函数`load_window()`来执行 window.open。

这是HTML

```
<div id="id01" class="channel" onclick="load_window('http://www.ewtn.com')"><a>EWTN.com</a></div><br/>EWTN television network</div> 
```

该函数的代码是这样的。

```
function load_window(url) {
    $.ajax({ 
        url : "fileinfo.php", 
        dataType: "html", 
        success : function (data) { 
            $('#layer').css('visibility','hidden');
        } 
    });

    // Pause first then open window
    function pause_first (url) {
        var external_window = window.open(url,'_blank');
        external_window.focus();
        alert ('window first');
    }

    var pause_ret = setTimeout( function() { pause_first(url); }, 1500);

} 
```

因为浏览器识别出 window.open 不是来自用户操作，所以它不会执行该操作。有没有不同的方法来做到这一点。

在此 url，您将找到我要执行此操作的页面：[webfiles.comze.com](http://webfiles.comze.com)。

单击 EWTN，浏览器应将您带到该网页。我希望浏览器在这样做之前暂停 2 秒，以告诉用户他要离开网站并向他显示 EWTN 的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:14:21.960

浏览器将此检测为弹出窗口，并执行浏览器对弹出窗口所做的任何操作。我试图为非常相似的问题找到答案，但看起来没有办法解决。

[window.open(url) 不同的行为 - 相同的代码，不同的时间](https://stackoverflow.com/questions/9793774/window-openurl-different-behavior-same-code-different-timing)

# java - 创建 Web 界面以编辑 plist 文件

> ID：10406079
> 
> 赞同：0
> 
> 时间：2012-05-02T00:10:42.337
> 
> 标签：java, php, ajax, plist

我正在开发一个 iOS 应用程序，该应用程序需要检索有关当前正在为舞蹈比赛进行不同阶段的比赛的信息。我需要创建一个 Web 界面来编辑我的服务器上的 plist 文件，该应用程序将下载该文件以自动更新 iDevice 上的此信息。该页面基本上是一个按钮网格，每个阶段只有一列。按钮将在“TRUE”和“FALSE”之间切换竞争值。

我的问题是我真的不知道使用什么语言来做到这一点。我从 PHP 开始为程序创建一个基本的网页。我知道 PHP 只在页面加载时运行。所以我现在正在考虑使用 AJAX，（因为我可以在不刷新页面的情况下更新用户界面。）我发现 PHP 有一个不错的 plist 编辑器，但 AJAX 没有。对我来说做这样的事情的最佳方式是什么？PHP、AJAX、Java？我可以让 AJAX 或 Java 运行 PHP 脚本吗？

plist 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Arena Hall</key>
<dict>
    <key>1 : Round 1</key>
    <true/>
    <key>2 : Round 1</key>
    <true/>
    <key>3 : Round 1</key>
    <false/>
</dict>
<key>Sycamore Hall</key>
<dict>
    <key>4 : Round 1</key>
    <true/>
    <key>4 : Round 2</key>
    <false/>
</dict> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:14:12.447

这对我来说听起来**太**复杂了。

你为什么不：

*   在 Mac 上编辑 .plist
*   上传到您的服务器

一个简单问题的简单解决方案...... :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T02:03:48.753

我学习了 java 和 php，并发现了做这种事情的最佳方法。我使用 jQuery 将 plist 文件加载到字符串中。使用 TheGoldenMule 的“Plist Parser”，我将 plist 转换为 JSON 对象。然后我使用 jQuery 创建了一个按钮表。每个按钮将运行一个 javascript 函数。此函数发送一个 AJAX 查询，其中包含要更改为 php 文件的信息。使用 Christian Kruse 和 Rodney Rehm 的 CFPropertyList，我更改了值并将 plist 文件保存回服务器。

# jquery - 如果另一个字段有值，则 jQuery 验证插件需要字段，反之亦然

> ID：10406089
> 
> 赞同：44
> 
> 时间：2012-05-02T00:11:40.307
> 
> 标签：jquery, jquery-validate

我正在使用 jQuery 验证插件来验证我的表单。我想将几对字段绑定在一起，这样如果一个字段有一个值，另一个字段也需要有一个值。本质上，两个字段（两个文本输入）要么都具有值，要么都没有值。有人知道实现这一目标的好方法吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-05-02T01:59:04.710

如果您查看[文档页面](http://docs.jquery.com/Plugins/Validation/validate)`depends`中“规则”部分的示例代码，您可以设置一个字段。

类似于以下内容（这是我的想法，未经测试）：

```
...
secondInput: {
    required: function(element){
            return $("#firstInput").val()!="";
        }
}
.... 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-05-04T21:31:53.647

只是为了澄清，这就是我根据 Erico 的回答最终做的事情：

```
 firstInput: {
        required: function(element){
            return $("#secondInput").val().length > 0;
        }
    },
    secondInput: {
        required: function(element){
            return $("#firstInput").val().length > 0;
        }
    } 
```

每个输入现在都依赖于另一个，并且只有在另一个有值时才需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-03-27T04:52:31.653

如果您想在没有插件的情况下进行验证

```
if ((field1 && !field2) || (!field1 && field2)) {

   // error message

} 
```

# git - Git 合并问题

> ID：10406090
> 
> 赞同：1
> 
> 时间：2012-05-02T00:11:58.310
> 
> 标签：git, version-control, merge, git-merge

我对 git 很陌生，所以我仍然对这个工具有所了解。

我有一个涉及合并的“小”问题。基本上时间线如下：

1.  使用 git-svn 桥从 SVN 进行变基
2.  有我合并但从未提交过的冲突
3.  做了其他工作...很多并提交了许多其他更改
4.  试图推动并得到“致命的：你还没有结束你的合并 MERGE_HEAD 存在”
5.  [我按照http://www.btaz.com/scm/git/git-fatal-you-have-not-concluded-your-merge-merge_head-exists/](http://www.btaz.com/scm/git/git-fatal-you-have-not-concluded-your-merge-merge_head-exists/)的建议做了一个“git reset --merge ORIG_HEAD”
6.  修复了合并问题
7.  愚蠢地提交更改并推送

现在我意识到上次合并中丢失了一堆更改，我想知道如何最好地撤消合并并让 git 允许我将更改推送到原点？

我希望我已经把问题说清楚了......如果不是打败我的话

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:20:34.553

我不清楚如何修复它，但它`git reflog`是一个非常强大的工具。它将向您展示 repo 发生的一切。然后，例如，您可以从历史记录中挑选提交，即使它们不在工作的主分支中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-02T13:07:05.837

使用前面提到的[git reflog](http://www.git-scm.com/docs/git-reflog)命令查找您的“丢失”提交。您可以使用[git show](http://www.git-scm.com/docs/git-show)来查看每个提交。然后，我建议将这些提交挑选到您当前的分支中，一次完成一个合并。显然，您应该随时进行测试（您确实有单元测试，不是吗？:-)。一旦你选择了所有的提交，你就可以自由地推送你的更改。

# jquery - jQuery - 检查子 div 是否可见

> ID：10406094
> 
> 赞同：11
> 
> 时间：2012-05-02T00:12:15.410
> 
> 标签：jquery

我正在尝试查看 li 的子 div 是否可见，如果是，则将类应用于 li。这是我得到的，但它不起作用。

```
if(jQuery('#menu li').children('div').css('display') != 'none') {
    jQuery('li', this).addClass('dropHover');
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-02T00:14:40.370

```
if (jQuery('#menu li > div').is(':visible')){
    //...
    jQuery('li', this).addClass('dropHover');
} 
```

我不知道 DOM 结构是什么或`this`指的是什么，但这也可以解决问题：

```
jQuery('#menu li:has(div:visible)').addClass('dropHover'); 
```

    它将类“dropHover”添加到所有`<li>`具有可见的元素`<div>`
并且它们需要是具有菜单 ID 的元素的子元素。

# sql - 为什么在向表中添加外键约束时会出错？

> ID：10406095
> 
> 赞同：1
> 
> 时间：2012-05-02T00:12:25.163
> 
> 标签：sql, wordpress, foreign-keys, foreign-key-relationship

表 wp_users wordpress 具有以下语法：

```
CREATE TABLE `wp_users` (
  `ID` bigint(20) unsigned NOT NULL auto_increment,
  `user_login` varchar(60) NOT NULL default '',
  `user_pass` varchar(64) NOT NULL default '',
  `user_nicename` varchar(50) NOT NULL default '',
  `user_email` varchar(100) NOT NULL default '',
  `user_url` varchar(100) NOT NULL default '',
  `user_registered` datetime NOT NULL default '0000-00-00 00:00:00',
  `user_activation_key` varchar(60) NOT NULL default '',
  `user_status` int(11) NOT NULL default '0',
  `display_name` varchar(250) NOT NULL default '',
  PRIMARY KEY  (`ID`),
  KEY `user_login_key` (`user_login`),
  KEY `user_nicename` (`user_nicename`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=6 ; 
```

我想集成一个已经为 wordpress 实现的系统，但是我在连接表 wp_users 时遇到了外键问题。

我有这张桌子：

```
CREATE TABLE attach (
  attach_id int unsigned NOT NULL auto_increment,     
  email varchar(60) NOT NULL default '',
  PRIMARY KEY  (attach_id),
  FOREIGN KEY (email) REFERENCES wp_users(user_login_key) 
  ON UPDATE CASCADE ON DELETE CASCADE
)Engine=INNODB; 
```

我想从 wp_users 连接到 user_email，但是 user_login 和 user_email 将是相同的。由于其他表中的其他情况，完全不可能将 attach_id 定义为 wp_users 到 ID 的 FK。

当我提交时给出错误＃1005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:03:51.177

在表的第二个创建语句中`CREATE TABLE attach`，您有这样的外键引用

```
FOREIGN KEY (email) REFERENCES wp_users(user_login_key) 
```

在上面的语句中，名称**user_login_key**引用 table 中的约束`wp_users`。创建外部约束时，您需要引用另一个表中要创建关系的字段名称，而不是约束名称。*如下更改CREATE TABLE 附件*中的引用语句以解决该问题。该语句中**user_login**指的是同名列

```
FOREIGN KEY (email) REFERENCES wp_users(user_login) 
```

[**点击这里查看SQL Fiddle中两个表都创建成功。**](http://sqlfiddle.com/#!2/f601a)

*脚本*：

```
 CREATE TABLE attach 
(
        attach_id   int unsigned NOT NULL auto_increment
    ,   email varchar(60) NOT NULL default ''
    ,   PRIMARY KEY  (attach_id)
    ,   FOREIGN KEY (email) REFERENCES wp_users(user_login) 
        ON UPDATE CASCADE ON DELETE CASCADE
)Engine=INNODB; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T13:45:55.783

请检查您的父子列数据类型是否必须相同？

例如：

在您的父表中有类似的列

```
 Fb_user_id INT(4) NOT NULL, 
```

在您的子表中，您还必须提供相同的数据类型，例如
ID INT(4) NOT NULL，

不要添加任何额外的属性，如 unsigned 那样。

# c++ - 重载模板运算符*

> ID：10406098
> 
> 赞同：1
> 
> 时间：2012-05-02T00:13:11.460
> 
> 标签：c++, templates, operator-overloading

```
// vec2.h
template<class v_float=float>
class vec2
{
public:
    v_float m[2];
};

template<class v_float>
vec2<v_float> operator* (v_float & f, vec2<v_float> & v);

template<class v_float>
vec2<v_float> vec2<v_float>::operator* (v_float & f, vec2 & v)
{
    return vec2(v.m[0]*f, v.m[1]*f);
} 
```

我想为上面的模板类 vec2 重载 operator*，但是上面的代码给了我以下错误： vec2.cpp:68: error: 'vec2 vec2::operator*(v_float&, vec2&)' must take either zero or一个论点

如何为模板类重载 operator*(float, vec2)？注意 operator* 的参数个数必须是两个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:17:16.000

我认为问题出在这个模板成员函数中：

```
template<class v_float>
    vec2<v_float> vec2<v_float>::operator* (v_float & f, vec2 & v)
{
    return vec2(v.m[0]*f, v.m[1]*f);
} 
```

由于您在`operator *`此处定义为成员函数，因此 C++ 自动假定接收器对象是操作数之一。这意味着如果你想定义乘法，你应该只定义一个带有一个参数的函数，即乘法的右侧（因为左侧将是接收器对象）。

我认为您打算将此作为免费功能，如下所示：

```
template<class v_float>
    vec2<v_float> operator* (v_float & f, vec2<v_float> & v)
{
    return vec2(v.m[0]*f, v.m[1]*f);
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:00:40.743

您使用了一个未声明的构造函数，并且使用成员函数和非成员函数重载了 *。最佳实践通常是使用非会员好友功能。

像这样的东西：

```
template<typename v_float=float>
class vec2
{
    v_float m[2];

public:
    vec2(const v_float &f1, const v_float &f2) { m[0] = f1; m[1] = f2; }

    template<typename T, typename Y>
    friend vec2<Y> operator*(T f, const vec2<Y> & v);
};

template <typename T, typename v_float>
vec2<v_float> operator*(T f, const vec2<v_float> & v)
{
    return vec2<v_float>(v.m[0]*f, v.m[1]*f);
} 
```

# jquery - 如何捕获点击事件 添加

> ID：10406100
> 
> 赞同：0
> 
> 时间：2012-05-02T00:13:31.347
> 
> 标签：jquery, jquery-ui

希望从嵌入在 div 中的锚点捕获单击事件。锚点实际上调用了一个模态对话框表单，我需要抑制该调用，以免弹出窗口出现。

```
<div id="whatever"><a class=" modal-dialog button action-add" href="/x/y/z">add</a></div>

<script type="text/javascript">
    $("#whatever").click(function (e) {
        alert('hello');
        e.preventDefault();
    });
</script> 
```

上面的代码被调用，但它弹出一个模态表单/弹出窗口，我想以某种方式抑制该锚点单击时的弹出窗口。我以为 e.preventDefault 会这样做，但弹出窗口仍在出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:17:51.510

问题是您的处理程序仅在它从锚点击传播后才被调用，这意味着锚的默认行为仍在发生。

如果您只有在 div 内有锚点，这将起到作用：

```
<script type="text/javascript">
    $("#whatever a").click(function (e) {
        alert('hello');
        e.preventDefault();
    });
</script> 
```

如果您还有其他事情：

```
<script type="text/javascript">
   $("#whatever a").click(function (e) {
        e.preventDefault();
    });
    $("#whatever").click(function (e) {
        alert('hello');
    });
</script> 
```

# batch-file - 批处理文件将文件名包含未来日期 (YYYYMMDD) 的所有文件移动到单独的文件夹

> ID：10406104
> 
> 赞同：1
> 
> 时间：2012-05-02T00:13:49.373
> 
> 标签：batch-file, dos

我需要一个批处理文件，它将获取给定文件夹中的任何文件，其名称中的值为 YYYYMMDD **，大于今天的日期**（对于未来的某个合理范围）并将它们移动到另一个文件夹。

```
set MainFolder=..\
set FutureFolder=.\
set FutureDaysToCount=90
set today=%DATE:~10,4%%DATE:~4,2%%DATE:~7,2% 
```

上面示例中的 %today% 将给我（2012 年 5 月 30 日）：20120530

我想做的是从 %today% TO %today% + %FutureDaysToCount%循环**日期并执行：**

```
move *yyyymmdd*.txt .\SomeOtherFolder 
```

...对于 90 天范围内的每一天，其中**yyyymmdd**将是正在处理的当前日期的数值等价物。所以：

```
move *20120530*.txt .\SomeOtherFolder
move *20120531*.txt .\SomeOtherFolder
move *20120601*.txt .\SomeOtherFolder  REM note new month here! 
```

有没有办法在循环中增加天数来实现这一点？

## 笔记

这与以下类似，但不同：
[将具有 YYYYMMDD 格式的日期的文件从一个文件夹移动到另一个文件夹的批处理过程](https://stackoverflow.com/questions/8937944/batch-process-to-move-file-having-date-in-yyyymmdd-format-from-one-folder-to-ano)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:32:50.767

使用 WMIC 获取今天的日期（无论语言环境如何）。

[然后使用http://www.dostips.com/DtTipsDateTime.php](http://www.dostips.com/DtTipsDateTime.php)上的julian 日期函数在循环中计算您的日期字符串。

```
@echo off
setlocal enableDelayedExpansion
for /f "skip=1" %%D in ('wmic os get localdatetime') do set dt=%%D&goto :break
:break
call :date2jdate jdStart %dt:~0,4% %dt:~4,2% %dt:~6,2%
set /a jdEnd=jdStart+90
for /l %%N in (%jdStart% 1 %jdEnd%) do (
  call :jdate2date %%N yyyy mm dd
  move "*!yyyy!!mm!!dd!*.txt" ".\SomeOtherFolder"
)
exit /b

:date2jdate JD YYYY MM DD -- converts a gregorian calender date to julian day format
::                        -- JD   [out] - julian days
::                        -- YYYY [in]  - gregorian year, i.e. 2006
::                        -- MM   [in]  - gregorian month, i.e. 12 for december
::                        -- DD   [in]  - gregorian day, i.e. 31
:$reference http://aa.usno.navy.mil/faq/docs/JD_Formula.html
:$created 20060101 :$changed 20080219 :$categories DateAndTime
:$source http://www.dostips.com
SETLOCAL
set "yy=%~2"&set "mm=%~3"&set "dd=%~4"
set /a "yy=10000%yy% %%10000,mm=100%mm% %% 100,dd=100%dd% %% 100"
if %yy% LSS 100 set /a yy+=2000 &rem Adds 2000 to two digit years
set /a JD=dd-32075+1461*(yy+4800+(mm-14)/12)/4+367*(mm-2-(mm-14)/12*12)/12-3*((yy+4900+(mm-14)/12)/100)/4
ENDLOCAL & IF "%~1" NEQ "" (SET %~1=%JD%) ELSE (echo.%JD%)
EXIT /b

:jdate2date JD YYYY MM DD -- converts julian days to gregorian date format
::                     -- JD   [in]  - julian days
::                     -- YYYY [out] - gregorian year, i.e. 2006
::                     -- MM   [out] - gregorian month, i.e. 12 for december
::                     -- DD   [out] - gregorian day, i.e. 31
:$reference http://aa.usno.navy.mil/faq/docs/JD_Formula.html
:$created 20060101 :$changed 20080219 :$categories DateAndTime
:$source http://www.dostips.com
SETLOCAL ENABLEDELAYEDEXPANSION
set /a L= %~1+68569,     N= 4*L/146097, L= L-(146097*N+3)/4, I= 4000*(L+1)/1461001
set /a L= L-1461*I/4+31, J= 80*L/2447,  K= L-2447*J/80,      L= J/11
set /a J= J+2-12*L,      I= 100*(N-49)+I+L
set /a YYYY= I,  MM=100+J,  DD=100+K
set MM=%MM:~-2%
set DD=%DD:~-2%
( ENDLOCAL & REM RETURN VALUES
    IF "%~2" NEQ "" (SET %~2=%YYYY%) ELSE echo.%YYYY%
    IF "%~3" NEQ "" (SET %~3=%MM%) ELSE echo.%MM%
    IF "%~4" NEQ "" (SET %~4=%DD%) ELSE echo.%DD%
)
EXIT /b 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T06:23:09.240

下面的批处理文件做你想做的事：

```
@echo off
setlocal EnableDelayedExpansion
set FutureDaysToCount=90

rem Get parts of current date and set number of days by month
set year=%DATE:~10,4%
set MM=%DATE:~4,2%
set DD=%DATE:~7,2%
set /A month=1%MM% %% 100, day=1%DD% %% 100
set i=0
for %%d in (31 28 31 30 31 30 31 31 30 31 30 31) do (
   set /A i+=1
   set days[!i!]=%%d
)
if %month% lss 3 (
   rem Check if current year is leap
   set /A leapYear=year %% 4
) else (
   rem Check if next year is leap
   set /A "leapYear=(year+1) %% 4"
)   
if %leapYear% equ 0 set days[2]=29
set daysThisMonth=!days[%month%]!

rem Loop through the dates for the number of days
for /L %%i in (1,1,%FutureDaysToCount%) do (
   rem Advance the date to next day
   set /A day+=1
   if !day! gtr !daysThisMonth! (
      rem Advance the date to next month
      set /A month+=1, day=1
      if !month! gtr 12 (
         rem Advance the date to next year
         set /A year+=1, month=1
      )
      call :setElem daysThisMonth=days[!month!]
      set MM=!month!
      if !month! lss 10 set MM=0!month!
   )
   set DD=!day!
   if !day! lss 10 set DD=0!day!

   rem Execute the desired command:
   ECHO move *!year!!MM!!DD!*.txt SomeOtherFolder
)
goto :EOF

:setElem var=vector[!index!]
set %1=!%2!
exit /B 
```

[可以使用本文中描述的方法轻松修改此](https://stackoverflow.com/questions/10207723/vbscript-how-to-sort-files-in-subfolders-by-modified-date-and-print-it-with-the/10222334#10222334)批处理文件以独立于区域设置日期设置

# ajax - 使用ajax关闭div时重置表单

> ID：10406110
> 
> 赞同：0
> 
> 时间：2012-05-02T00:14:28.967
> 
> 标签：ajax, django, forms, reset

关闭 div 时如何将表单重置为原始状态

我正在使用 ajax 和 django

一项建议是在我的表单中使用 reset_recipe 字段，如果设置为 true 将重置配方

这是我的 disablePopup 函数：

```
function disablePopup($contact_selector){
//disables popup only if it is enabled
if(popupStatus==1){
    $("#backgroundPopup").fadeOut("fast");
    $contact_selector.fadeOut("fast");
    popupStatus = 0;
    var form = $("form#createrecipeform");
    console.log(form);
    form.submit(function(e) {
    e.preventDefault();
    console.log('ajax form submission function called successfully.');
    form = $(this);
    console.log(form);
    var serialized_form = form.serialize();
        $.ajax({ type: "POST", 
            url: $(this).attr('action'),
            data: serialized_form, 
            success: (function(data) { 
                console.log('ajax success function called successfully.');
                data = $.parseJSON(data);
                if (data.success) {
                    console.log('success');
                    var newForm = data.form;
                    form.replaceWith(newForm);
                } else {
                    console.log('failure');
                    var newForm = data.form;
                    form.replaceWith(newForm);  
                }
            })
        });
        return false;
    });

} 
```

}

这是我创建食谱的观点

```
def createrecipe(request):
        print "entering createrecipeview"
        if request.method == 'POST':
            print "form is a post"
            form = RecipeForm(request.POST)
            if form.is_valid():
                print "form is valid"
                form = RecipeForm(initial = {'original_cookbook' : request.user.cookbooks.all()[0]})
                form = form.save()
                if form.cleaned_data['reset_recipe'] == "True"://here is the line that uses the reset_recipe function but right ow it is not working 
                    print "reset recipe"
                    form = RecipeForm(initial = {"original_cookbook": request.user.cookbooks.all()[0]})
                    t = loader.get_template('cookbook/create_form.html')
                    c = RequestContext(request, {
                    'form': form,
                    })

                    data = {
                    'replace': True,
                    'form': t.render(c),
                    'success': False,
                    }

                    json = simplejson.dumps(data)
                    return HttpResponse(json,mimetype='text/plain')
                t = loader.get_template('cookbook/create_form.html')
                c = RequestContext(request, {
                'form': form,
                })

                data = {
                'replace': True,
                'form': t.render(c),
                'success': True,
                }

                json = simplejson.dumps(data)
                return HttpResponse(json, mimetype='text/plain')
            else:
                print "form is invalid"
                form = RecipeForm(request.POST)
                t = loader.get_template('cookbook/create_form.html')
                c = RequestContext(request, {
                    'form':form,
                })

                data ={
                    'form': t.render(c),
                    'success': False,
                }

                json = simplejson.dumps(data)
                return HttpResponse(json, mimetype='text/plain') 
```

现在，当我尝试关闭 div 时，它会重定向到一个页面并给我以下代码：

```
{"success": false, "form": "<form action=\"/cookbook/createrecipe/\" method=\"POST\" id=\"createrecipeform\">\n\t<table>\n\t\t<div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='3fb6b9952f50edbe7654666ef20a6900' /></div>\n\t\t<tr><th><label for=\"id_name\">Name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"200\" /></td></tr>\n<tr><th><label for=\"id_author\">Author:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input id=\"id_author\" type=\"text\" name=\"author\" maxlength=\"100\" /></td></tr>\n<tr><th><label for=\"id_picture\">Picture:</label></th><td><input type=\"file\" name=\"picture\" id=\"id_picture\" /></td></tr>\n<tr><th><label for=\"id_ingredients\">Ingredients:</label></th><td><ul class=\"errorlist\"><li>This field cannot be null.</li></ul><textarea id=\"id_ingredients\" rows=\"10\" cols=\"40\" name=\"ingredients\"></textarea></td></tr>\n<tr><th><label for=\"id_steps\">Steps:</label></th><td><ul class=\"errorlist\"><li>This field cannot be null.</li></ul><textarea id=\"id_steps\" rows=\"10\" cols=\"40\" name=\"steps\"></textarea></td></tr>\n<tr><th><label for=\"id_prep_time\">Prep time:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"prep_time\" id=\"id_prep_time\" /></td></tr>\n<tr><th><label for=\"id_type\">Type:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><select name=\"type\" id=\"id_type\">\n<option value=\"\" selected=\"selected\">---------</option>\n<option value=\"SW\">Sandwich</option>\n<option value=\"AP\">Appetizers</option>\n<option value=\"SD\">Sauces and Dressings</option>\n<option value=\"SS\">Soups and Salads</option>\n<option value=\"VG\">Vegetables</option>\n<option value=\"RG\">Rice, Grains and Beans</option>\n<option value=\"PA\">Pasta</option>\n<option value=\"BR\">Breakfast</option>\n<option value=\"MT\">Meat</option>\n<option value=\"SF\">Seafood</option>\n<option value=\"BP\">Bread and Pizza</option>\n<option value=\"DT\">Desserts</option>\n</select><input type=\"hidden\" name=\"reset_recipe\" value=\"False\" id=\"id_reset_recipe\" /></td></tr>\n\t</table>\n\t<p><input type=\"submit\" value=\"Submit\"></p>\n</form>"} 
```

另一件需要注意的是页面重定向到表单操作页面

对不起这么多代码，但这一切似乎都是相关的

谢谢

凯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:20:19.333

```
$("#createrecipeform").attr('reset_recipe', "True"); 
```

只会向表单元素添加一个属性：

```
<form reset_recipe="True" id="createrecipeform"> 
```

您需要在名为 reset_recipe 的表单中添加一个输入元素。

在表单中添加隐藏字段：

```
reset_recipe = forms.CharField(widget=django.forms.widgets.HiddenInput, required=False) 
```

并将其值设置为 True （而不是向表单添加属性）：

```
$("#id_reset_recipe").val("True"); 
```

看起来您只是在提交表单（没有 AJAX）：

```
$("#createrecipeform").submit(); 
```

您需要通过 XHR 提交：

```
$("#createrecipeform").submit(function(event){
    /* stop form from submitting normally */
    event.preventDefault(); 

    /* get form field values */
    var serialized_data = $( this ).serialize();

    /* Send the data using post and put the results in the form */
    $.post( url, serialized_data,
      function( data ) {
          $("#createrecipeform").replace( data.form );
      }
    );
 }); 
```

还要为 json 使用正确的 mime 类型：

```
return HttpResponse(json, mimetype='application/json') 
```

但是，如果您只想重置表单，通常可以使用：

```
$("#createrecipeform").reset() 
```

# javascript - 将功能连接在一起 - 更简洁的代码

> ID：10406114
> 
> 赞同：-1
> 
> 时间：2012-05-02T00:14:50.057
> 
> 标签：javascript, jquery

有没有办法缩短我的代码。我需要添加大约 15 个更多功能，它们都做同样的事情。

```
$(document).ready(function() {
    $('.map-highligh').maphilight({

    });

    //north roll over
    $('#hilightlink').mouseover(function(e) {
        $('#north').mouseover();
    }).mouseout(function(e) {
        $('#north').mouseout();
    }).click(function(e) { e.preventDefault(); });

    //Wellington roll over
    $('#hilightlink-wel').mouseover(function(e) {
        $('#wellington').mouseover();
    }).mouseout(function(e) {
        $('#wellington').mouseout();
    }).click(function(e) { e.preventDefault(); });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:22:00.477

您可以使用一些组合来清理代码。

```
function makeTrigger(id, eventName) {
    return function(e) {
        $('#' + id).trigger(eventName);
    };
}

function prevent(e) {
    e.preventDefault();
}

$('#hilightlink')
.mouseover(makeTrigger("north", "mouseover"))
.mouseout(makeTrigger("north", "mouseout"))
.click(prevent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:26:02.123

```
$.fn.rollOver = function(selector) {
    this.on('mouseover mouseout', function(e) { $(selector).trigger(e.type); });
    this.on('click', function(e) { e.preventDefault(); });
    return this;
}
$('#hilightlink').rollOver('#north');
$('#hilightlink-wel').rollOver('#wellington'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:28:47.820

在没有看到我们可以利用哪些 DOM 关系来利用它的情况下，我将数据放在一个表中并遍历该表，因此只有一个代码副本，您可以在不更改执行代码的情况下添加/删除/修改标识符：

```
var hoverItems = [
    "highlightlink", "north",
    "highlightlink-wel", "wellington"
];

for (var i = 0; i < hoverItems.length; i+= 2) {
    (function(item$) {
        $("#" + hoverItems[i]).hover(function() {
            item$.mouseover();
        }, function() {
            item$.mouseout();
        }).click(function(e) {e.preventDefault();});
    })($(hoverItems[i+1]));
} 
```

或者，稍微不同的方式，使用查找表：

```
var hoverItems = {
    "highlightlink": "north",
    "highlightlink-wel": "wellington"
};

$("#" + Object.keys(hoverItems).join(", #")).hover(function() {
    $("#" + hoverItems[this.id]).mouseover();
}, function() {
    $("#" + hoverItems[this.id]).mouseout();
}).click(function(e) {e.preventDefault();}); 
```

第二种方法需要 ES5 或ES5[垫片](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)。`Object.keys()`

要使用其中任何一种方法添加更多项目，只需将更多项目添加到数据表 - 您无需编写新的一行执行代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T00:20:07.203

您可能想要重新考虑您的 UI，但您可以执行以下操作：

```
function mouseBind(bound, affected) {
   $('#' + bound)
      .mouseover(function () {
         $('#' + affected).mouseover();
      })
      .mouseout(function () {
         $('#' + affected).mouseout();
      })
      .click(function (e) { e.preventDefault(); })
   ;
}

mouseBind('hilightlink', 'north');
mouseBind('hilightlink-wel', 'wellington'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T00:20:18.393

您可以在不更改 HTML 代码的情况下使用此功能：

```
function bind_block(button, element) {
  button.mouseover(function(e) {
    element.mouseover();
  }).mouseout(function(e) {
    element.mouseout();
  }).click(function(e) { e.preventDefault(); });
}

bind_block($('#hilightlink'), $('#north'));
bind_block($('#hilightlink-wel'), $('#wellington')); 
```

如果您需要为 15 个不同的元素绑定此事件，最好使用 CSS 类。请提供您的 HTML 以获得更多帮助。

# configuration - 无法在提琴手中更改网关信息

> ID：10406121
> 
> 赞同：0
> 
> 时间：2012-05-02T00:15:34.123
> 
> 标签：configuration, fiddler

是否可以更改提琴手中的网关信息？在 Fiddler 中，当我查看 Help > About Fiddler 链接时，我看到网关信息与我的 IE 不同；但是我不确定如何更改 Fiddler 中的网关信息。

我认为因此；我在提琴手中看不到任何网络会话。

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:31:24.750

好的，今天我偶然发现了如何启动 fiddler 来跟踪我的 http 请求。这是我必须做的，

步骤 1\. 通过转到 IE > 工具 > Internet 选项 > 连接 > LAN 设置来更改代理设置 这里通过取消选中两个代理选项来禁用“自动配置”，然后转到“代理服务器”部分并选中“使用代理”选项局域网服务器”选项。在地址文本字段中输入 127.0.0.1，在端口字段中输入 8888。

步骤 2\. 以管理员身份启动 Fiddler。

提琴手开始工作。这是在您位于防火墙后面的情况下。

高温高压

# google-visualization - Google Charts API 折线图问题

> ID：10406122
> 
> 赞同：0
> 
> 时间：2012-05-02T00:15:34.200
> 
> 标签：google-visualization

当我创建一个包含一行的 Google Charts 折线图时，它不显示任何内容：

[http://jsfiddle.net/bensinclair/zyMSd/2/](http://jsfiddle.net/bensinclair/zyMSd/2/)（请原谅凌乱的代码，我能让它工作的唯一方法是将 JavaScirpt 放入 HTML 框中）

但是使用完全相同的代码并向图表添加另一行，它可以工作：

[http://jsfiddle.net/bensinclair/KnVQh/](http://jsfiddle.net/bensinclair/KnVQh/)

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T15:10:41.820

除非您添加 pointSize 以显示数据点的圆点，否则谷歌折线图不会显示单个数据点。

# algorithm - 刚果 TM1 中的稀疏合并算法

> ID：10406127
> 
> 赞同：0
> 
> 时间：2012-05-02T00:16:06.767
> 
> 标签：algorithm, cognos, sparse-matrix, consolidation, cognos-tm1

稀疏合并算法如何帮助提高 Cognos TM1 性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T00:11:21.943

我在这里找到了一个简洁的描述：

[Cognos TM1 规则——它们是如何工作的？](http://blogs.perficient.com/businessintelligence/2012/05/02/cognos-tm1-rules-how-do-they-really-work/)

> 在合并期间，TM1 使用稀疏合并算法跳过包含零或为空的单元格。该算法加快了高度稀疏的多维数据集中的合并计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-06T05:33:00.123

关于 TM1 规则和合并的综合帖子：TM1 [中的 Skipcheck Feeders](http://tm1up.com/skipcheck-feeders-in-tm1.html)

它逐步介绍了规则和合并在 TM1 中的工作原理以及如何使用 skipcheck 和 feeder 来提高计算速度。

# css - css3 媒体查询正在调整浏览器大小，但在我的 iPhone 上它们似乎不起作用

> ID：10406129
> 
> 赞同：1
> 
> 时间：2012-05-02T00:16:18.397
> 
> 标签：css, media-queries, responsive-design

我正在构建我的 WordPress 博客（用 scss 做 css）。我为所有类型的浏览器大小创建了媒体查询，您可以在此处查看：http: [//pastie.org/3846370](http://pastie.org/3846370)

当我调整笔记本电脑浏览器的大小时，它们工作得非常好。但是，当我在我的 Iphone 上测试该网站时，他们只是看不到工作。

我还应该提到我确实在标题中包含了正确的元标记

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T10:03:23.583

好的，所以我解决了这个问题。

问题是我首先加载最小设备的媒体查询，最后加载最大的，这应该是相反的。您应该从最大的设备宽度开始，以最小的设备宽度结束。

此外，您应该删除 min-width 属性，只保留 max-width。

# python - 检查 Python 列表中是否有（不）某些东西

> ID：10406130
> 
> 赞同：404
> 
> 时间：2012-05-02T00:16:19.420
> 
> 标签：python, list, conditional, membership

我有一个[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中的元组列表，并且我有一个条件，只有当元组不在列表中时，我才想采用分支（如果它在列表中，那么我不想采用 if 分支）

```
if curr_x -1 > 0 and (curr_x-1 , curr_y) not in myList: 

    # Do Something 
```

不过，这对我来说并不适用。我做错了什么？

* * *

## 回答 #1

> 赞同：643
> 
> 时间：2012-05-02T00:18:42.737

该错误可能在您的代码中的其他地方，因为它应该可以正常工作：

```
>>> 3 not in [2, 3, 4]
False
>>> 3 not in [4, 5, 6]
True 
```

或者使用元组：

```
>>> (2, 3) not in [(2, 3), (5, 6), (9, 1)]
False
>>> (2, 3) not in [(2, 7), (7, 3), "hi"]
True 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2019-01-30T09:33:18.560

> ### 如何检查 Python 列表中是否有（不）某些东西？

最便宜和最易读的解决方案是使用[`in`](https://docs.python.org/3/reference/expressions.html#membership-test-operations)运算符（或在您的特定情况下，`not in`）。如文档中所述，

> 运算符`in`和`not in`成员资格测试。如果是 的成员，则`x in s`计算 结果，否则。返回 的否定。`True``x``s``False``x not in s``x in s`

此外，

> 运算符`not in`被定义为具有 的反真值`in`。

`y not in x`逻辑上与 相同`not y in x`。

这里有一些例子：

```
'a' in [1, 2, 3]
# False

'c' in ['a', 'b', 'c']
# True

'a' not in [1, 2, 3]
# True

'c' not in ['a', 'b', 'c']
# False 
```

这也适用于元组，因为元组是可散列的（因为它们也是不可变的）：

```
(1, 2) in [(3, 4), (1, 2)]
#  True 
```

如果 RHS 上的对象定义了一个[`__contains__()`](https://docs.python.org/3/reference/datamodel.html#object.__contains__)方法，`in`则会在内部调用它，如文档[比较](https://docs.python.org/3/library/stdtypes.html?highlight=__contains__#comparisons)部分的最后一段所述。

> ...`in`和`not in`, 由可迭代或实现该 `__contains__()`方法的类型支持。例如，您可以（但不应该）这样做：

```
[3, 2, 1].__contains__(1)
# True 
```

`in`短路，因此如果您的元素位于列表的开头，则`in`评估速度更快：

```
lst = list(range(10001))
%timeit 1 in lst
%timeit 10000 in lst  # Expected to take longer time.

68.9 ns ± 0.613 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
178 µs ± 5.01 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each) 
```

如果您想做的不仅仅是检查项目是否在列表中，还有以下选项：

*   `list.index`可用于检索项目的索引。如果该元素不存在，`ValueError`则引发 a。
*   `list.count`如果要计算出现次数，可以使用。

* * *

### XY问题：你考虑过`set`s吗？

问自己这些问题：

*   您是否需要多次检查一个项目是否在列表中？
*   这个检查是在循环内完成的，还是在重复调用的函数内完成的？
*   您存储在列表中的项目是否可散列？IOW，你能拜访`hash`他们吗？

如果您对这些问题的回答是“是”，那么您应该使用 a`set`代替。对 s的`in`成员资格测试`list`是 O(n) 时间复杂度。这意味着 python 必须对列表进行线性扫描，访问每个元素并将其与搜索项进行比较。如果您重复执行此操作，或者列表很大，则此操作将产生开销。

`set`另一方面，对象对它们的值进行散列以进行恒定时间成员资格检查。检查也使用`in`：

```
1 in {1, 2, 3} 
# True

'a' not in {'a', 'b', 'c'}
# False

(1, 2) in {('a', 'c'), (1, 2)}
# True 
```

如果你很不幸，你正在搜索/不搜索的元素位于列表的末尾，python 将扫描到列表的末尾。从下面的时间可以看出这一点：

```
l = list(range(100001))
s = set(l)

%timeit 100000 in l
%timeit 100000 in s

2.58 ms ± 58.9 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
101 ns ± 9.53 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each) 
```

提醒一下，只要您存储和查找的元素是可散列的，这是一个合适的选项。IOW，它们要么必须是不可变类型，要么必须是实现`__hash__`.

# jquery - 动态jquery ui选择菜单没有样式

> ID：10406131
> 
> 赞同：0
> 
> 时间：2012-05-02T00:16:28.077
> 
> 标签：jquery, jquery-ui, jquery-ui-selectmenu

我正在使用[http://wiki.jqueryui.com/w/page/12138056/Selectmenu](http://wiki.jqueryui.com/w/page/12138056/Selectmenu)使用多个选择菜单。它们在使用页面初始化时效果很好，但动态选择菜单的样式并不像普通的选择标签。我的代码..（defquestion 也是一个选择框，带有是/否选项）

```
 $('select').selectmenu({ 
     style: 'popup',
     width: 100
});
$('#defquestion').livequery(function(){
$(this).change(function(){
    var selected = $('#defquestion').val();
    if(selected == 'Yes'){
$('#defresult').append('<p class = "idp">Points allowed = 0:<select id = "pa0"><br><option value = "12">12</option></select><br></p>'); 
```

我排除了更多选项标签..但我怀疑这是问题所在.. Livequery 在其他动态用途中效果很好，但不是在这里。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:31:58.533

首先，我会确保您正确关闭标签，您拥有的代码最后缺少此：

```
 }     // close if argument
 });   // close .change()
 });   // close .livequery() 
```

如果那不能解决它，请尝试不使用`livequery`，像这样..

```
$('#defquestion').change(function(){
    var selected = $(this).val();
    if(selected == 'Yes'){
        $('#defresult').append('<p class = "idp">Points allowed = 0:<select id = "pa0"><br><option value = "12">12</option></select><br></p>');
    }
}); 
```

# javascript - window.location() 在 .aspx 页面中不起作用

> ID：10406134
> 
> 赞同：-2
> 
> 时间：2012-05-02T00:17:08.683
> 
> 标签：javascript

我有一个aspx 页面和一个具有ajax autoCompleteExtender 的asp 文本框控件。我希望根据自动完成列表中的选定元素将页面重定向到另一个页面。但是当我使用

```
window.location() 
```

什么都没有发生，只是刷新了相同的页面。这是我的javascript；

```
<script type="text/javascript">
    function selectCity() {
        var str = document.getElementById('<%= txtSearchForDestination.ClientID %>').value;
        var array = str.split(",");
        var city = array[0].replace(/^\s\s*/, '').replace(/\s\s*$/, '');
        city = city.replace(/ /g, "+")
        var country = array[1].replace(/^\s\s*/, '').replace(/\s\s*$/, '');
        country = country.replace(/ /g, "+")
        window.location.href("City.aspx?city=" + city + "-" + country);
    }
</script> 
```

该脚本正在运行，我尝试过类似

> alert("City.aspx?city=" + city + "-" + country)

没有问题。但是当我想重定向到该页面时，它不起作用。我也试过

> window.location("http://www.google.com")

它也不能正常工作。

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:21:11.003

它不是一个函数，它是一个属性。

```
window.location.href = "City.aspx?city=" + city + "-" + country; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:19:40.163

你有没有尝试过：

```
 window.location = 'City.aspx?city=' + city + '-' + country; 
```

?

# python - UnicodeDecodeError：“ascii”编解码器无法解码位置 2 中的字节 0xd1：序数不在范围内（128）

> ID：10406135
> 
> 赞同：119
> 
> 时间：2012-05-02T00:17:08.873
> 
> 标签：python, django, utf-8

我正在尝试使用一个非常大的数据集，其中包含一些非标准字符。根据工作规范，我需要使用 unicode，但我很困惑。（而且很可能做错了。）

我使用以下方法打开 CSV：

```
 15     ncesReader = csv.reader(open('geocoded_output.csv', 'rb'), delimiter='\t', quotechar='"') 
```

然后，我尝试使用以下代码对其进行编码：

```
name=school_name.encode('utf-8'), street=row[9].encode('utf-8'), city=row[10].encode('utf-8'), state=row[11].encode('utf-8'), zip5=row[12], zip4=row[13],county=row[25].encode('utf-8'), lat=row[22], lng=row[23]) 
```

我正在对除 lat 和 lng 之外的所有内容进行编码，因为它们需要发送到 API。当我运行程序将数据集解析为我可以使用的内容时，我得到以下 Traceback。

```
Traceback (most recent call last):
  File "push_into_db.py", line 80, in <module>
    main()
  File "push_into_db.py", line 74, in main
    district_map = buildDistrictSchoolMap()
  File "push_into_db.py", line 32, in buildDistrictSchoolMap
    county=row[25].encode('utf-8'), lat=row[22], lng=row[23])
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd1 in position 2: ordinal not in range(128) 
```

我想我应该告诉你我正在使用 python 2.7.2，这是基于 django 1.4 构建的应用程序的一部分。我已经阅读了有关此主题的几篇文章，但似乎没有一篇直接适用。任何帮助将不胜感激。

您可能还想知道导致问题的一些非标准字符是 Ñ 并且可能是 É。

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2012-05-02T00:21:01.067

Unicode 不等于 UTF-8。后者只是前者的*编码*。

你做错了。您正在*读取*UTF-8*编码*的数据，因此您必须将 UTF-8 编码的字符串*解码为 un​​icode 字符串。*

所以只需替换`.encode`为`.decode`，它应该可以工作（如果你的 .csv 是 UTF-8 编码的）。

不过也没什么好丢脸的。我敢打赌，五分之三的程序员一开始都很难理解这一点，如果不是更多的话；）

更新：如果您的输入数据*不是*UTF-8 编码的，那么您当然必须`.decode()`使用适当的编码。如果没有给出任何内容，python 假定 ASCII，这显然在非 ASCII 字符上失败。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2016-10-31T17:00:11.207

只需将此行添加到您的代码中：

```
import sys
reload(sys)
sys.setdefaultencoding('utf-8') 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2017-10-20T14:29:26.610

对于 Python 3 用户。你可以做

```
with open(csv_name_here, 'r', encoding="utf-8") as f:
    #some codes 
```

它也适用于烧瓶:)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-07-11T14:35:17.430

错误的主要原因是python假设的默认编码是ASCII。因此，如果要编码的字符串数据`encode('utf8')`包含超出 ASCII 范围的字符，例如对于像“hgvcj터파크387”这样的字符串，python 会抛出错误，因为该字符串不是预期的编码格式。

如果您使用的 python 版本早于 3.5 版，可靠的解决方法是将 python 假定的默认编码设置为`utf8`：

```
import sys
reload(sys)
sys.setdefaultencoding('utf8')
name = school_name.encode('utf8') 
```

这样，python 将能够预测字符串中超出 ASCII 范围的字符。

但是，如果您使用的是 python 3.5 或更高版本，则 reload() 函数不可用，因此您必须使用 decode 来修复它，例如

```
name = school_name.decode('utf8').encode('utf8') 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-03-29T23:58:35.407

对于 Python 3 用户：

将编码从“ascii”更改为“latin1”有效。

此外，您可以尝试通过使用以下代码段读取前 10000 个字节来自动查找编码：

```
import chardet  
with open("dataset_path", 'rb') as rawdata:  
            result = chardet.detect(rawdata.read(10000))  
print(result) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-12-11T19:39:05.207

我的电脑设置了错误的语言环境。

我第一次做

```
>>> import locale
>>> locale.getpreferredencoding(False)
'ANSI_X3.4-1968' 
```

[`locale.getpreferredencoding(False)`](https://docs.python.org/3/library/locale.html#locale.getpreferredencoding)[`open()`是您不提供编码时](https://docs.python.org/library/functions.html#open)调用的函数。输出应该是`'UTF-8'`，但在这种情况下，它[是 ASCII 的一些变体](https://stackoverflow.com/questions/48743106/whats-ansi-x3-4-1968-encoding)。

然后我运行了 bash 命令[`locale`](https://linux.die.net/man/1/locale)并得到了这个输出

```
$ locale
LANG=
LANGUAGE=
LC_CTYPE="POSIX"
LC_NUMERIC="POSIX"
LC_TIME="POSIX"
LC_COLLATE="POSIX"
LC_MONETARY="POSIX"
LC_MESSAGES="POSIX"
LC_PAPER="POSIX"
LC_NAME="POSIX"
LC_ADDRESS="POSIX"
LC_TELEPHONE="POSIX"
LC_MEASUREMENT="POSIX"
LC_IDENTIFICATION="POSIX"
LC_ALL= 
```

因此，我使用了默认的 Ubuntu 语言环境，这会导致 Python 以 ASCII 而不是 UTF-8 格式打开文件。我必须[将我的语言环境设置](https://askubuntu.com/questions/162391/how-do-i-fix-my-locale-issue)为`en_US.UTF-8`

```
sudo apt install locales 
sudo locale-gen en_US en_US.UTF-8    
sudo dpkg-reconfigure locales 
```

如果您无法在系统范围内更改语言环境，则可以像这样调用所有 Python 代码：

```
PYTHONIOENCODING="UTF-8" python3 ./path/to/your/script.py 
```

或者做

```
export PYTHONIOENCODING="UTF-8" 
```

将其设置在您运行它的外壳中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-12T08:21:58.757

如果您在创建或更新证书时运行 certbot 时遇到此问题，请使用以下方法

`grep -r -P '[^\x00-\x7f]' /etc/apache2 /etc/letsencrypt /etc/nginx`

该命令在评论的一个 .conf 文件中发现了有问题的字符“´”。删除它（您可以根据需要编辑评论）并重新加载 nginx 后，一切都恢复了。

来源：[https ://github.com/certbot/certbot/issues/5236](https://github.com/certbot/certbot/issues/5236)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-17T20:13:12.640

由于纬度和经度，使用编码 UTF 16 打开。

```
with open(csv_name_here, 'r', encoding="utf-16") as f: 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-02T22:33:44.580

或者当您在 Python 中处理文本时，如果它是 Unicode 文本，请记下它是 Unicode。

设置`text=u'unicode text'`而不是`text='unicode text'`.

这在我的情况下有效。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-23T11:05:12.523

它只通过使用参数'rb'读取二进制而不是'r'读取来工作

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-15T13:03:44.653

在 Docker 容器中处理这个问题。可能是这种情况（对我而言），您只需要生成语言环境而无需执行任何其他操作：

```
sudo locale-gen en_US en_US.UTF-8 
```

在某些情况下，这对我来说已经足够了，因为已经安装和配置了语言环境。如果您必须安装语言环境并对其进行配置，请将以下部分添加到您的 Dockerfile 中：

```
RUN apt update && apt install locales && \
    sed -i -e 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen && \
    echo 'LANG="en_US.UTF-8"'>/etc/default/locale && \
    dpkg-reconfigure --frontend=noninteractive locales && \
    update-locale LANG=en_US.UTF-8

ENV LANG en_US.UTF-8
ENV LANGUAGE en_US.UTF-8
ENV LC_ALL en_US.UTF-8 
```

我是这样测试的：

```
cat <<EOF > /tmp/test.txt
++*=|@#|¼üöäàéàè!´]]¬|¢|¢¬|{ł|¼½{}}
EOF

python3
import pathlib; pathlib.Path("/tmp/test.txt").read_text() 
```

# php - 可选的正则表达式模式不产生任何价值

> ID：10406139
> 
> 赞同：3
> 
> 时间：2012-05-02T00:17:53.187
> 
> 标签：php, xml, regex, pcre

我为我的项目做的一些正则表达式有点问题（请记住，我是正则表达式的初学者，这在以下示例中显示）。我在尝试使用关联模式从中提取某些部分的 xml 代码时遇到了一点问题。

```
<banner piclink="pic" urlactive="url_active" urltarget="globaltgt" urllink="globallink" timevar="globaldelay" swf="0" smooth="1" name="name" alt="alternate" /> 
```

我正在使用以下正则表达式来获取使用 preg_match_all 的 piclink、urlactive、urltarget、urllink 和 timevar：

```
/piclink=\"(?<pic>.+)\".+urltarget=\"(?<target>.+)\".+urllink=\"(?<url>.*)\".+timevar=\"(?<delay>.*)\"/iU 
```

到目前为止一切正常，但是，我现在尝试通过关联来捕获可选的名称和 alt 标签，因为它们并不总是出现。我试图将它们放在括号中，后跟一个？表示它们是可选的，如下所示：

```
(name=\"(?<name>.*)\")? 
```

但是 $matches['name'] 数组总是空的，我不知道我在哪里搞砸了，但我尝试了各种组合，除了我放 (?: 在结束并封装从 swf= 开始的所有内容，然后它确实在数组中返回 115 个结果，这是不可接受的，因为结果类似于 $matches['name'][X] = result，其中 x 有时是 1 次，其他时间是 109由于某些原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:40:17.317

我同意类似的东西`SimpleXML`会更好，但如果你想弄脏，你可以使用前瞻来尝试匹配剩余的字符。

```
/piclink=\"(?<pic>.+)\".+urltarget=\"(?<target>.+)\".+urllink=\"(?<url>.*)\".+timevar=\"(?<delay>[^"]*)\"(?=(.*name=\"(?<name>[^"]*)\")?)(?=(.*alt=\"(?<alt>[^"]*)\")?).*/iU 
```

# spring - Spring静态资源servlet请求

> ID：10406146
> 
> 赞同：0
> 
> 时间：2012-05-02T00:19:17.063
> 
> 标签：spring, servlets

我英文不太好。请理解。

我负责维护一个使用 Spring、tile 和 ibatis 框架构建的网站。

问题是所有的 gif、js 等……都要经过**DispatcherServlet**，因为大多数静态资源的地址都像**/home/images/hbg_01.gif**。资源路径由**homeServlet**映射。

但我希望任何用 Web.xml 编写的 Dispatcher servlet 都忽略我的静态资源。

我是 J2EE 的新手。所以如果它缺乏信息。请发表评论。如果需要，我会给你任何东西

这是我的**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0" metadata-complete="true">

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/xml/root-context.xml
            /WEB-INF/xml/security.xml
        </param-value>
    </context-param>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/app/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>adminServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/adminServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>adminServlet</servlet-name>
        <url-pattern>/admin/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>homeServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/homeServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>homeServlet</servlet-name>
        <url-pattern>/home/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>monitorServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/monitorServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>monitorServlet</servlet-name>
        <url-pattern>/monitor/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>monitorDemoServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/monitorDemoServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>monitorDemoServlet</servlet-name>
        <url-pattern>/monitor_demo/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>projectServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/xml/projectServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>projectServlet</servlet-name>
        <url-pattern>/project/*</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>log4jConfigLocation</param-name>
        <param-value>/WEB-INF/log4j.properties</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <filter>
        <description></description>
        <display-name>encodingFilter</display-name>
        <filter-name>encodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>EUC-KR</param-value>
        </init-param>
       <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
       </init-param>
    </filter>

    <filter-mapping>
        <filter-name>encodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/home/*</url-pattern>
        <url-pattern>/project/*</url-pattern>
        <url-pattern>/admin/*</url-pattern>
        <url-pattern>/monitor/*</url-pattern>
        <url-pattern>/monitor_demo/*</url-pattern>
    </filter-mapping>

    <session-config>
        <session-timeout>180</session-timeout>
    </session-config>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:15:08.397

mvc-static-resources 可以提供帮助。PL。参考 ：

[http://static.springsource.org/spring/docs/3.0.5.RELEASE/spring-framework-reference/html/mvc.html#mvc-static-resources](http://static.springsource.org/spring/docs/3.0.5.RELEASE/spring-framework-reference/html/mvc.html#mvc-static-resources)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T12:54:55.493

正如你所说 `/home/images/hbg_01.gif`。资源路径由 映射`homeServlet`。

更改 url 模式`/home/*`以避免映射到`homeServlet`类似：

```
<servlet-mapping>
    <servlet-name>homeServlet</servlet-name>
    <url-pattern>/home/anything/*</url-pattern>
</servlet-mapping> 
```

# php - 通过 __get() 魔术方法访问属性/方法

> ID：10406156
> 
> 赞同：1
> 
> 时间：2012-05-02T00:20:12.290
> 
> 标签：php, oop

我如何访问此语句中的第二个属性或方法

```
$this->test->hello(); 
```

在我的`__get()`我只能弄清楚如何弄清楚`test`属性是什么。我还希望能够捕获“hello”方法调用。并用它做一些动态的事情。

所以简而言之，如果我输入

```
$this->test->hello() 
```

我要`echo`每个段

```
echo $propert // test
echo $method //hello 
```

问题是我的测试被用来从外部类实例化一个新的类对象。该方法`hello`属于`test`类对象。

我想在我的`__get()`.

我怎样才能做到这一点？

编辑：

```
public function __get($name)
        {
            if ($name == 'system' || $name == 'sys') {

                $_class = 'System_Helper';

            } else {

                foreach (get_object_vars($this) as $_property => $_value) {

                    if ($name == $_property)
                        $_class = $name;
                }
            }

            $classname = '\\System\\' . ucfirst($_class);
            $this->$_class = new $classname();

            //$rClass = new \ReflectionClass($this->$_class);
            $rClass = get_class_methods($this->$_class);
            foreach($rClass as $k => $v)
            echo $v."\n";
            //print_r($rClass);

            return $this->$_class; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:35:58.963

看来您正在追求某种代理课程，这可能适合您的需求。

```
class ObjectProxy {
    public $object;

    public function __construct($object) {
        $this->object = $object;
    }

    public function __get($name) {
        if (!property_exists($this->object, $name)) {
            return "Error: property ($name) does not exist";
        }
        return $this->object->$name;
    }

    public function __call($name, $args) {
        if (!method_exists($this->object, $name)) {
            return "Error: method ($name) does not exist";
        }
        return call_user_func_array(array($this->object, $name), $args);
    }
}

class A {
    public $prop = 'Some prop';

    public function hello() {
        return 'Hello, world!';
    }
}

class B {
    public function __get($name) {
        if (!isset($this->$name)) {
            $class_name = ucfirst($name);
            $this->$name = new ObjectProxy(new $class_name);
        }
        return $this->$name;
    }
}
$b = new B();
var_dump($b->a->hello());
var_dump($b->a->prop);
var_dump($b->a->foo);
var_dump($b->a->bar()); 
```

输出：

```
string 'Hello, world!' (length=13)
string 'Some prop' (length=9)
string 'Error: property (foo) does not exist' (length=36)
string 'Error: method (bar) does not exist' (length=34) 
```

例子：

[http://ideone.com/dMna6](http://ideone.com/dMna6)

它可以很容易地扩展到其他魔术方法，如`__set`, `__callStatic`, `__isset`,`__invoke`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:22:10.243

我认为您想使用`__call`而不是`__get`. 另外，不要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:30:50.230

您实例化的对象`$this`将使用`__get`魔术方法创建对象（作为属性）`test`。存储的对象`$this->test`需要实现`__call`魔术方法才能使用`hello()`，如果它没有定义

# java - 下载音频文件

> ID：10406157
> 
> 赞同：0
> 
> 时间：2012-05-02T00:20:12.690
> 
> 标签：java

也许我是盲人或愚蠢，但浏览 30 分钟后，我没有发现任何有用的东西......

[我想从freedicitonary](http://www.thefreedictionary.com/word)下载一个音频文件（带有单词的发音 - 当您单击左侧的这两个标志之一时播放） 它以这种方式嵌入（如果我理解正确）作为 flash 对象：

```
<object codebase="http://fpdownload.macromedia.com...>
<param name="movie" value="http://img.tfd.com/m/sound.swf"><param name="menu" value="false">
<param name="wmode" value="transparent">
<param name="FlashVars" value="sound_src=http://img2.tfd.com/pron/mp3/en/US/dg/dgsysksfdyht.mp3&amp;image_src=http://img.tfd.com/m/flags/18_US.jpg">
<embed style="margin:0 0 0 3px;" src="http://img.tfd.com/m/sound.swf" flashvars="sound_src=http://img2.tfd.com/pron/mp3/en/US/dg/dgsysksfdyht.mp3&amp;image_src=http://img.tfd.com/m/flags/18_US.jpg" menu="false" width="28" height="18" wmode="transparent" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"></object> 
```

，所以当我下载 HTML 文件时，没有任何 mp3 链接的迹象 :)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:24:25.027

1.  它似乎嵌入在 Flash 中。这就是为什么没有直接链接。

2.  它似乎`http://img2.tfd.com/pron/mp3/en/US/dg/dgsysksfdyht.mp3`在`embed`标签 `flashvars`属性中。你可以解析那个:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:50:36.593

```
<td id=MainTitle nowrap><h1>word <script>playV2('en/US/dg/dgsysksfdyht');playV2('en/UK/dg/dgsysksfdyht')</script> </h1></td> 
```

## 代码

```
class SoundURL {

    public static void main(String[] args) throws Exception {
        // let us assume you are able to trim it down to this..
        String script = "playV2('en/US/dg/dgsysksfdyht')";

        String prefix = "http://img2.tfd.com/pron/mp3/";
        String suffix = ".mp3";

        int start = script.indexOf("'");
        int end = script.indexOf("'", start+1);

        String path = script.substring(start+1,end);
        String urlString = prefix + path + suffix;

        System.out.println(urlString);
    }
} 
```

## 输出

```
http://img2.tfd.com/pron/mp3/en/US/dg/dgsysksfdyht.mp3
Press any key to continue . . . 
```

## 笔记

您将需要：

1.  使用 HTML 解析器解析 HTML。使用`String`操作方法仅适用于非常简单的字符串。
2.  ***检查网站是否允许此类使用或其资源。***

# c# - Page_load 上的 Gridview 文本框启用编辑

> ID：10406163
> 
> 赞同：0
> 
> 时间：2012-05-02T00:21:03.527
> 
> 标签：c#, asp.net, gridview, textbox

```
using Visual.Web.Developer.2010.Express;
using SQL.Server.Management.Studio.2008.R2; 
```

N00b 这里，

我已经让 gridview 看起来像我想要的那样（里面的一个文本框`ItemTemplate`）。文本框的类有一些客户端JS，可以在文本框的事件触发`asp:LinkButton`后使保存按钮（一组看起来像Jquery UI保存图标）变得可见.. 现在我的问题..我到处都看过，但我可以'不知道如何让 gridview 将 Sql server db 内容放在 Page_load 上的那个文本框中（一个文本框 +每行）。我只将 Sql server db 中的一列打印到 Gridview 中。另外，如何将保存按钮绑定到 gridview 的保存事件？如果有更有效的方法来做到这一点？如果您对我有一些见解，请给我您的意见/！`.keypress`

`<br />``asp:LinkButton`

*我的 .aspx 代码*

```
 <asp:TemplateField >
            <ItemTemplate>

                <asp:TextBox ID="TextBox1" class="hexen" runat="server" DataField="TbValue" SortExpression="TbValue">

                </asp:TextBox>
            </ItemTemplate>
        </asp:TemplateField>
     </Columns>
    </asp:GridView>

<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:FluxConnectionString %>" 
    SelectCommand="SELECT [TbValue] FROM [InvestigateValues]">
</asp:SqlDataSource> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:06:38.260

将您的文本框更改为

```
<asp:TextBox ID="TextBox1" class="hexen" runat="server" text='<%#Bind("TbValue")%>' /> 
```

这将启用双向数据绑定。

这是一篇帮助您入门的文章：http: [//www.devx.com/DevX/Article/35058](http://www.devx.com/DevX/Article/35058)。

网格视图和 SqlDataSource 公开插入、更新和删除事件/方法。这些是**在行**级别，而不是网格级别。

我解决您的问题的方法是为您的链接按钮设置一个 onclick 事件，该事件遍历 gridview，从每个文本框中获取数据，然后在后面的代码中执行适当的数据库操作。

# android - 在测试用例之后保持检测的 Activity 活动

> ID：10406166
> 
> 赞同：3
> 
> 时间：2012-05-02T00:21:19.700
> 
> 标签：android, robotium

假设您正在使用带有如下签名的类为 Android 平台构建测试用例：

```
public class AccountTest extends ActivityInstrumentationTestCase2<MainActivity> { ... } 
```

假设我们有一个使用 Robotium 框架的测试方法：

```
public void testCreateAccount() {
    solo.clickOnButton("Add Account");
    solo.clickOnButton("Next");

    ...
} 
```

当测试用例完成时，被检测的活动被迅速杀死。有没有办法让它在终止时保持活力，至少是为了确定你接下来要做什么并编码接下来的几行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:28:41.413

Android JUnit Test 建立在 JUnit 之上，因此它遵循 JUnit 测试生命周期的基本规则：

*   调用测试用例的 setUp() 方法
*   调用测试方法
*   调用测试用例的 tearDown( ) 方法

> 当测试用例完成时，被检测的活动被迅速杀死。

[原因见ActivityInstrumentationTestCase2](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/test/ActivityInstrumentationTestCase2.java#ActivityInstrumentationTestCase2.tearDown%28%29)的源码：

```
@Override
protected void tearDown() throws Exception {
  // Finish the Activity off (unless was never launched anyway)
  Activity a = super.getActivity();
  if (a != null) {
    a.finish();
    setActivity(null);
  }

  // Scrub out members - protects against memory leaks in the case where someone 
  // creates a non-static inner class (thus referencing the test case) and gives it to
  // someone else to hold onto
  scrubClass(ActivityInstrumentationTestCase2.class);

  super.tearDown();
} 
```

> 有没有办法让它在终止时保持活力，至少是为了确定你接下来要做什么并编码接下来的几行？

可能的解决方法是：

1.  完全覆盖 AccountTest 类（扩展 ActivityInstrumentationTestCase2 类）中的 teardown() 方法，而不调用 super.tearDown();
2.  创建自定义的 ActivityInstrumentationTestCase3 类（扩展 ActivityTestCase 类）以避免在 teardown() 方法中完成活动。

在任何一种方法中，您都应该仔细实现您的 teardown() 方法以避免内存泄漏。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T19:21:22.657

事实证明，使用 Nativedriver 库很容易实现我想要的：

[http://code.google.com/p/nativedriver/](http://code.google.com/p/nativedriver/)

在测试用例结束时省略`driver.quit()`可以使活动保持活动状态，这在最初开发测试用例时非常方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-31T13:19:12.787

我有同样的问题。最后我使用`Sleep().`

```
while(true)
{
   Thread.Sleep(1000);
   // do other things when the main thread wake
} 
```

您可以将上述代码放入任意测试方法中，仪器`Activity`不会结束。

希望它可以帮助你。

# c# - 通用委托存储和使用

> ID：10406171
> 
> 赞同：2
> 
> 时间：2012-05-02T00:21:52.777
> 
> 标签：c#, generics, delegates

```
delegate IEnumerable<T> GetFromSQLDelegate<T>(...);
public GetFromSQLDelegate myFunctionToCall; 
```

上面没有编译，因为 myFunctionToCall 没有指定类型。我正在尝试“存储”一个泛型委托，以便以后可以将其作为常规泛型函数调用：

```
// ... somewhere in another code base ...
return MyObject.myFunctionToCall<string>(...); 
```

C# 抱怨是因为我没有在委托存储属性上指定具体类型。有没有一种（好的）方法来“存储”能够调用通用函数而不实现各种具体类型委托场景的委托？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:30:42.340

您可以将值存储为`System.Delegate`、 make it `private`，并定义一个`GetDelegate<T>`将存储的委托转换为适当类型的函数：

```
private Delegate storedDelegate;

public myFunctionToCall<T> GetDelegate<T>() {
    return (myFunctionToCall<T>)storedDelegate;
} 
```

然后你可以这样称呼它：

```
return MyObject.GetDelegate<string>()(...); 
```

语法有点丑陋`()(...)`，但它应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:31:20.480

在 C# 中你的拼图没有碎片：

*   你不能有非指定类型的泛型类型的非泛型变量
*   您无法创建与此类虚构签名匹配的函数
*   您不能调用函数并指定类型。

所以答案是否定的。有多种不同的方法可以实现类似的行为，所以如果你指定你的实际目标是什么，有人会想出一个方法。

# javascript - jQuery 翻页动画

> ID：10406176
> 
> 赞同：0
> 
> 时间：2012-05-02T00:22:27.723
> 
> 标签：javascript, jquery

我正在使用一个名为 Moleskine Notebook 的翻页脚本。在 jquery.booklet.1.1.0.js 文件中有一个名为 next 的函数，它可以翻页。我想从我的 html 文件中调用这个函数。

我试过“$mybook.next();” 但它没有用，我想我必须对 jQuery.data() 做一些事情，因为它在 jquery.booklet.1.1.0.js 文件中说明（第 100-103 行）

```
//store data for api calls
b.data('booklet',true);
b.data('id', id);
b.data('total', src.children().length); 
```

这是脚本： [http ://tympanus.net/Tutorials/MoleskineNotebook/](http://tympanus.net/Tutorials/MoleskineNotebook/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:32:40.230

阅读[API 文档](http://builtbywill.com/code/booklet/options)：

```
$('#mybook').booklet('next'); 
```

# jsf - 从 backing bean 调用 Session Bean 的 asynchornize 方法

> ID：10406180
> 
> 赞同：3
> 
> 时间：2012-05-02T00:22:47.150
> 
> 标签：jsf, asynchronous, ejb

我正在为 web 控制长期运行的过程进行概念验证。为了模拟，我创建了一个计数器来每 1 秒计数一次。我有一个带有开始/停止按钮的 JSF 页面。当我按下开始时，我可以在日志中检查计数器开始计数，但是当我关闭停止时，我遇到了超时异常。

这是 Count.xhtml

```
<f:view
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core">   
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>

<h:form>
  <h:commandButton value="Start" action="#{counter.start}" />
  <h:commandButton value="End" action="#{counter.end}" />
</h:form>

</body>
</html>
</f:view>
```

这是 CounterFace.java

```
package nawa.bean;

import javax.ejb.EJB;
import javax.faces.bean.*;

@ManagedBean(name="counter")
@ApplicationScoped
public class CounterFace
{

    @EJB
    private Counter counter;

    public void start()
    {
        counter.startCounting();
        System.out.println(counter.toString());
    }

    public void stop()
    {
        counter.endCounting();
        System.out.println(counter.toString());
    }
}
```

这是 Counter.java

```
package nawa.bean;

import javax.ejb.*;

/**
 * Session Bean implementation class Counter
 */
@Stateful
@LocalBean
public class Counter
{

    private int count = 0;

    volatile boolean isRunning = false;

    @EJB
    private Logger logger;

    private void count()
    {
        this.count++;
        this.logger.addMessage("Counter(" + this.count + ")");
    }

    public boolean isRunning()
    {
        return this.isRunning;
    }

    @Asynchronous
    public void startCounting()
    {
        this.isRunning = true;
        while (this.isRunning)
        {
            this.count();
            try
            {
                Thread.sleep(1000);
            }
            catch (InterruptedException e)
            {
                // TODO: handle exception
            }
        }
    }

    @Asynchronous
    public void endCounting()
    {
        this.isRunning = false;
        this.logger.addMessage("EndCounting(" + this.count + ")");
    }

}
```

这是一个例外：

```
18:15:55,418 ERROR [org.jboss.as.ejb3] (EJB default - 3) JBAS014102: Asynchronous invocation failed: javax.ejb.ConcurrentAccessTimeoutException: JBAS014360: EJB 3.1 FR 4.3.14.1 concurrent access timeout on org.jboss.invocation.InterceptorContext@3a552b48 - could not obtain lock within 5000 MILLISECONDS
    at org.jboss.as.ejb3.component.stateful.StatefulSessionSynchronizationInterceptor.processInvocation(StatefulSessionSynchronizationInterceptor.java:117) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InitialInterceptor.processInvocation(InitialInterceptor.java:21) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.interceptors.ComponentDispatcherInterceptor.processInvocation(ComponentDispatcherInterceptor.java:53) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.stateful.StatefulComponentInstanceInterceptor.processInvocation(StatefulComponentInstanceInterceptor.java:66) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:228) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.required(CMTTxInterceptor.java:304) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.processInvocation(CMTTxInterceptor.java:190) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.CurrentInvocationContextInterceptor.processInvocation(CurrentInvocationContextInterceptor.java:41) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
```

谁能指导我？这里发生了什么？我正在使用 JBoss 7.1。

谢谢

# gtk - 窗口调整大小后不重绘 Gtk Widget

> ID：10406183
> 
> 赞同：2
> 
> 时间：2012-05-02T00:23:19.027
> 
> 标签：gtk

我有 Gtk.Grid 并且在调整窗口大小后，它不会刷新（事件列和所有设置都正确），但是当您再次调整它的大小或单击项目时，它会重绘。

Gtk.main_iteration() 导致 python3 中的段错误

```
from gi.repository import GLib, Gtk

class Grid(Gtk.Grid):
    min_width = 400
    min_height = 300
    min_spacing = 20

    def __init__(self):
        Gtk.Grid.__init__(self, name='feed_grid',
            row_spacing=20, column_spacing=20)

        self.set_column_homogeneous(True)
        self.set_size_request(self.min_width, self.min_height)

        self.connect('size-allocate', self._on_size_allocate)

        self._cols = 2

    def _on_size_allocate(self, widget, allocation):
        self.set_width(allocation.width)

    def set_width(self, width):
        self._cols = (width + self.min_spacing) // self.min_width
        self._rebuild_grid()

    def get_columns(self):
        return self._cols

    def add_feed(self, feed):
        feed.set_order(len(self.get_children()))
        self._attach_feed(feed)
        feed.show_all()

    def _rebuild_grid(self):
        for feed in self.get_children():
            self.remove(feed)
            self._attach_feed(feed)

    def _attach_feed(self, feed):
        y, x = divmod(feed.get_order(), self.get_columns())
        self.attach(feed, x, y, 1, 1) 
```

**错误报告** [https://bugs.launchpad.net/ubuntu/+source/gtk+3.0/+bug/987565](https://bugs.launchpad.net/ubuntu/+source/gtk+3.0/+bug/987565)

**视频** [https://launchpadlibrarian.net/102937139/floaty%20resize.ogv](https://launchpadlibrarian.net/102937139/floaty%20resize.ogv)

# javascript - 在 Rails 中的 select_tag 和 text_field_tag 之间动态更改

> ID：10406186
> 
> 赞同：0
> 
> 时间：2012-05-02T00:24:22.747
> 
> 标签：javascript, ruby-on-rails, haml

我在我的网站上实现了一个简单的搜索，想法是“选择您要搜索的字段，然后输入您的搜索查询”。但是，至少有一个搜索选项应该限制在下拉菜单中，而不是具有文本字段的自由度。

我一直在阅读和测试一些选项，看到了一些关于`:on_change`和一些深入的 javascript 解决方案的帖子，但我就是不知道该怎么做。

我当前的视图有 a`select_tag`后跟 a `text_field_tag`，但我想检查它的值`select_tag`并使用它来决定下一个字段是 a`text_field_tag`还是 a `select_tag`。我正在使用 Haml，我认为这是：

```
#simple-search-options
  =form_tag packages_path, :method=>'get' do
    Search by:
    = select_tag :search_option, options_for_select(@search_options, @option)
    = text_field_tag :search_string, @s_string
    = submit_tag 'Search' 
```

请注意，我正在使用在先前搜索中输入的任何值来设置`select_tag`和 的默认值`text_field_tag`，这就是变量`@option`和`@s_string`的来源。这可能会使解决方案复杂化，因为这意味着在第一次生成页面时，我希望已经根据`@option`.

我希望在第一个和将由一些控制器和一些视图填充的那个`div`之间坚持一个，但我不知道如何跟进。`select_tag``submit_tag`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:28:09.390

您应该在模板中添加`select_tag`和`text_field_tag`，然后使用 JavaScript 隐藏和显示它们。最好为这两个字段设置不同的名称，因为它们的类型不同。

# apache-flex - Flex 新手关于使用 HGroup 和 VGroup 控制布局

> ID：10406189
> 
> 赞同：0
> 
> 时间：2012-05-02T00:24:36.587
> 
> 标签：apache-flex

我正在尝试使用 VGroup 和 HGroup 学习 Flex 布局。作为一个简单的练习，我想控制按钮对的像素位置。下面的代码尝试将 3 对按钮分别放置在两行中。例如，第一行有一个按钮对，距离顶部和左侧 20 个像素；另一个按钮对，距顶部 20 像素并居中；和另一个按钮对，距离顶部和右侧 20 像素。第二行的所有按钮都向左对齐 20 像素。

它应该看起来像：

```
button button                     button button                   button button
button button button button button button 
```

但是代码在两行之间没有产生任何差异。谁能帮我理解如何像我想要的那样控制布局？

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" 
           minWidth="955" 
           minHeight="600">

<s:VGroup top="20" left="20" right="20">

    <s:HGroup top="20" left="20" right="20">

        <s:Button label="row1 left1"/>
        <s:Button label="row1 left2"/>

        <s:HGroup  horizontalAlign="center">
            <s:Button label="row1 middle1"/>
            <s:Button label="row1 middle2"/>
        </s:HGroup>

        <s:HGroup right="20">
            <s:Button label="row1 right1"/>
            <s:Button label="row1 right2"/>
        </s:HGroup>

    </s:HGroup>

    <s:HGroup top="50" left="20">
        <s:Button label="row2 left1"/>
        <s:Button label="row2 left2"/>
        <s:Button label="row2 middle1"/>
        <s:Button label="row2 middle2"/>
        <s:Button label="row2 right1"/>
        <s:Button label="row2 right2"/>
    </s:HGroup>

</s:VGroup>

</s:Application> 
```

更新：根据下面 Dom 的回答，这是我想要的正确代码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" 
           minWidth="955" 
           minHeight="600">

<s:HGroup left="20" right="20" top="20">
    <s:HGroup>
        <s:Button click=""/>
        <s:Button click=""/>
    </s:HGroup>
    <s:Spacer width="100%"/>
    <s:HGroup>
        <s:Button click=""/>
        <s:Button click=""/>
    </s:HGroup>
    <s:Spacer width="100%"/>
    <s:HGroup>
        <s:Button click=""/>
        <s:Button click=""/>
    </s:HGroup>
</s:HGroup>
<s:VGroup left="20" right="20" top="50">
    <s:HGroup width="100%">
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
    </s:HGroup>
</s:VGroup>

</s:Application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:11:03.973

我看到两个选项：

1：不要使用HGroup的

2：使用 HGroup 并将项目与

```
<s:Spacer width="x"/> 
```

其中 x 可以是 % 或精确像素。

编辑：正确格式化我的答案，以便 s:spacer 显示

编辑2：在下面添加代码：

```
<s:VGroup width="100%" height="100%">
    <s:HGroup width="100%">
        <s:HGroup>
            <s:Button click=""/>
            <s:Button click=""/>
        </s:HGroup>
        <s:Spacer width="100%"/>
        <s:HGroup>
            <s:Button click=""/>
            <s:Button click=""/>
        </s:HGroup>
        <s:Spacer width="100%"/>
        <s:HGroup>
            <s:Button click=""/>
            <s:Button click=""/>
        </s:HGroup>
    </s:HGroup>
    <s:HGroup width="100%">
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
        <s:Button click=""/>
    </s:HGroup>
</s:VGroup> 
```

这看起来与您上面的示例完全相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:53:26.343

我真的尽量避免使用垫片。我想我曾经用过一个*东西*来破解一些东西……但感觉很脏。

第一行不应该是 a `HGroup`，而是`Group`由三个`HGroup`s 组成。像这样，但没有任何垫片：

```
<s:VGroup top="20" left="20" right="20">

    <s:Group width="100%">

        <s:HGroup left="0">
            <s:Button label="row1 left1"/>
            <s:Button label="row1 left2"/>
        </s:HGroup>

        <s:HGroup horizontalCenter="0">
            <s:Button label="row1 middle1"/>
            <s:Button label="row1 middle2"/>
        </s:HGroup>

        <s:HGroup right="0">
            <s:Button label="row1 right1"/>
            <s:Button label="row1 right2"/>
        </s:HGroup>

    </s:Group>

    <s:HGroup top="50" left="20">
        <s:Button label="row2 left1"/>
        <s:Button label="row2 left2"/>
        <s:Button label="row2 middle1"/>
        <s:Button label="row2 middle2"/>
        <s:Button label="row2 right1"/>
        <s:Button label="row2 right2"/>
    </s:HGroup>

</s:VGroup> 
```

# android - 使用 4.0 android 任务管理器关闭应用程序后的通知？

> ID：10406190
> 
> 赞同：0
> 
> 时间：2012-05-02T00:24:44.263
> 
> 标签：android, notifications, android-c2dm, android-4.0-ice-cream-sandwich

我在我的应用程序中使用 C2DM，并且我有一个接收器，它将数据发送到应用程序中的一个类。该类创建一个通知并通知通知管理器发布它。

问题是，当应用程序通过设置手动关闭时，这不起作用，因为这也（显然）关闭了广播接收器。

我得到的是，当一个应用程序被 android 4.0 的新任务管理器（类似于 3.0 但用户也可以向左或向右滑动应用程序以将其关闭）关闭时，它的行为会有所不同：广播接收器仍在工作，因为我从 C2DM 消息中获得了意图，但由于某种原因，我的手机仍在播放通知噪音，而托盘中没有出现通知。

我无法弄清楚发生了什么，因为没有通知出现就无法播放声音，因为声音附加到通知并在发布时播放，没有其他方式。但没有出现任何通知。

任何关于为什么会发生这种情况的见解都会很棒，或者当您将应用程序从列表中滑出时，新的 4.0 任务管理器实际上对应用程序做了什么。

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-10T03:20:06.320

弄清楚了，广播接收器仍在响应，但只是失败了，因为它正在从属于主应用程序的类中检索东西，现在已经死了，所以现在它需要的东西存储在 sharedprefs 中，并在收到通知之前检索发送。

所以要回答这个问题，在 4.0 中没有从任务管理器中滑动应用程序不会“强制终止”该应用程序，就像设置中应用程序菜单中的强制终止按钮一样。它确实会杀死应用程序，这样下次打开它时，所有活动都会从头开始重新启动，就像您在最后一个剩余活动中并按下回，从而在最后一个活动任务上调用完成（）并关闭应用程序。广播恢复器（和我假设的服务）之后仍在运行。

# vb.net - 从哪里开始傅立叶分析

> ID：10406191
> 
> 赞同：1
> 
> 时间：2012-05-02T00:25:01.370
> 
> 标签：vb.net, signal-processing, fft

我正在从麦克风读取数据并想对其进行一些分析。我正在尝试生成一个类似这样的频谱分析仪：

![频谱分析仪](../Images/d242a060aad202521d0a91c15349d2c7.png)

我目前拥有的是这样的：

![从麦克风输入](../Images/d2946a63831bd244a654faa422597aed.png)

我的理解是我需要执行傅立叶分析 - 快速傅立叶变换？- 提取分量频率及其幅度。

有人可以确认我的理解是正确的以及我需要应用什么类型的傅立叶变换吗？

目前，我正在从麦克风（使用[NAudio](http://opensebj.blogspot.co.uk/2009/03/naudio-tutorial-4-sample-reversing.html)）获取包含 4k 样本的帧。我得到的缓冲区是 16 位/样本（有符号短）。作为参考，上图显示了大约半帧

我在 VB 中编码，因此任何 .Net 库/示例（最好在 NuGet 上）都将是最有用的。我相信实现会有很大差异，所以我对数据的处理越少越好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:36:31.877

上图是光谱图，其中每条垂直时间线根据输入波形的时间切片（可能重叠）的 FFT（可能加窗）结果的大小进行着色。要绘制的垂直点数（频率分辨率）与 FFT 的长度有关。几乎任何 FFT 都可以。如果您使用最常见的复数到复数 FFT，只需将每个复数输入样本的虚部设置为零，将输入波形样本的时间片复制到“实部”部分 FFT，然后取幅值或记录每个复杂结果箱的大小，然后根据您的喜好将这些值映射到颜色。

# html - 如何使用jsp获取所选选项的ID？

> ID：10406192
> 
> 赞同：0
> 
> 时间：2012-05-02T00:25:10.123
> 
> 标签：html, jsp, html-select

我在 HTML 中有这样的东西：

```
<select name="selection">
    <option id="1">First Option</option>
    ...
</select> 
```

我想在 JSP 中获取所选选项的 ID。request.getParameter("selection") 给了我选项的文本，但我想要 id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:35:36.670

保持不变对你`id`有用。`value`

例如

```
<option id="1" value="1">First Option</option> 
```

# php - Json 数据怪异行为

> ID：10406193
> 
> 赞同：2
> 
> 时间：2012-05-02T00:25:13.430
> 
> 标签：php, jquery, html, ajax, json

当通过 ajax 加载 json 数据时，我遇到了一些奇怪的行为。数据加载正常，只有在几个间隔之后数据才会打乱并在间隔之间保持运行。这甚至会导致浏览器崩溃

html页面

 ````
<script id="source" language="javascript" type="text/javascript">
$(function ahitRate() 
{
    $.ajax({
    cache: false,
    url: 'average.php',
    data: 'jsonData',
    dataType: 'json',
    processData: false,
    success: function(data)
            {
                var ahr = data[0];              //get id
                var hitRate = data[1];           //get name
                $('#output').html("<b>id: </b>"+ahr+"<b> name:   </b>"+hitRate); 
                setInterval(ahitRate, 5000);
                }           
    });
}); 
</script> 
````  `生成随机数据的json php代码

```
`// Session
session_start();

// Set the JSON header
header("Content-type: text/json");
header('Cache-Control: no-cache, must-revalidate');

$y = rand(0, 100);

// Create a PHP array and echo it as JSON
$ret = array("Average", $y);
echo json_encode($ret);
?>` 
```

 `任何建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:30:48.767

我的天啊！

您正在递归调用它！

```
setInterval(ahitRate, 5000); 
```

编辑：只需将 setInterval(...) 更改为 setTimeout(ahitRate, 5000);

每次执行的时候，老的一直在运行，又会添加一个新的，所以它会使用越来越多的内存！

```
$(function() {
    function ahitRate() 
    {
         $.ajax({
         cache: false,
         url: 'average.php',
         data: 'jsonData',
         dataType: 'json',
         processData: false,
         success: function(data)
                    {
                         var ahr = data[0];              //get id
                         var hitRate = data[1];           //get name
                         $('#output').html("<b>id: </b>"+ahr+"<b> name:   </b>"+hitRate); 
                         }           
         });
    } 

    setInterval(ahitRate, 5000);

}); 
```

唯一不同的是我：

1.  从 ajax 成功函数中删除了 setInterval(...) 方法
2.  在闭包结束时恰好调用了一次（“$(function() { ... } );”

这将导致您的“ahitRate()”函数每 5 秒被调用一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:31:53.760

setInterval 不断触发 - 每次收到新响应时，您都会启动一个新计时器。因此，五秒钟后，第一个计时器触发并启动另一个计时器。然后在十秒钟后，两个计时器都会启动，然后再启动两个。

我想你可以看到这是怎么回事。

我认为您正在寻找 setTimeout() 方法，或者只是在成功函数之外启动间隔计时器，因此它永远不会被再次调用。``

# c - 为什么不一样：char dog[1000]; 和 char *dog = (char*)malloc(1000 * sizeof(char));

> ID：10406196
> 
> 赞同：1
> 
> 时间：2012-05-02T00:25:59.687
> 
> 标签：c

当我“打印” sizeof(dog) 时

```
char dog[1000];// i get size of 1000
char *dog = (char*)malloc(1000 * sizeof(char));// i get size of 8 ? why? 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:28:25.997

第一个变量的类型`char[1000]`是 1000 个字符的数组。

第二个变量的类型`char *`是指针。在您的系统上，指针的大小似乎为 8（可能是因为您有 64 位指针）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:32:51.233

因为`char *dog`只是一个指针，而`char dog[1000]`一个字符数组。

需要注意的重要一点是，`sizeof` `dog[1000]`确定在编译时是已知的，而动态数组 ( `char *dog`) 是未知的。

# java-3d - java3d翻译对象的简单方法

> ID：10406197
> 
> 赞同：1
> 
> 时间：2012-05-02T00:26:00.270
> 
> 标签：java-3d

我正在使用 Java3D 制作我的第一个程序。我已经设置了一些我现在需要在计算的方向上移动的变换组。当我查找此内容时，我发现了插值器、alpha 对象和波形，却一个字也听不懂。我过去在 OpenGL 中使用简单的向量和帧刷新完成了此操作。Java3d中是否有类似的简单方法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T13:04:30.600

在 Java3D 中也没有理由不能用矢量和帧刷新来做到这一点。

一种简单的方法是使用 WakeupOnElapsedFrames(0) 条件将行为附加到场景图，然后让它每帧更新所需的变换。

最简单的就是插值器为你做的事情。一旦你得到它的工作，它可能会更有意义你如何使用插值器来做到这一点。

# python - Python GUI 换行符

> ID：10406200
> 
> 赞同：0
> 
> 时间：2012-05-02T00:26:13.963
> 
> 标签：python, user-interface, button

我在 Python 中有一个 GUI 应用程序，它有两个按钮都与左侧对齐，代码如下所示：

```
Button(root, text="blah").pack(side=LEFT)
Button(root, text="blah").pack(side=LEFT) 
```

这段代码很好用，但是在 GUI 中，如何将这两个按钮放在不同的行上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:37:38.557

（假设您使用的是 Tkinter）我认为您只需打包它......

例如

```
Button(root,text="blah").pack() 
```

请注意，通常，最好先制作按钮，然后将其打包在单独的行中。

这种几何形状也可以用网格来完成。

```
b1=Button(root,text="blah")
b2=Button(root,text="blah")
b1.grid(row=0,column=0)
b2.grid(row=1,column=0) 
```

但是，您不应该混合使用网格和包几何管理器......（选择一个并坚持使用它）

# uiwebview - 使用 theos，我如何下载 HTML 文件并覆盖现有文件（objective-c）？

> ID：10406201
> 
> 赞同：0
> 
> 时间：2012-05-02T00:26:16.050
> 
> 标签：uiwebview, nsdata, nsurl, nsurlrequest, writetofile

我正在尝试制作一个简单的应用程序（*在我的设备上使用 theos，所以没有 xcode/mac，只有 ifile*），它显示一个 HTML 文件并在导航栏中有一个按钮，通过从服务器下载新版本来更新本地 HTML 文件并覆盖现有的。**我的问题是**没有下载新版本的 HTML 文件，而现有的文件保持不变。

当按下按钮时，这是我必须尝试更新本地 HTML 文件的代码：

```
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"blank" ofType:@"html"]isDirectory:NO]]];

NSData *theData = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://mydomain.com/index.html"]];
[theData writeToFile:[NSBundle pathForResource:@"index" ofType:@"html" inDirectory:[[NSBundle mainBundle] bundlePath]] atomically:NO];

[webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"]isDirectory:NO]]]; 
```

blank.html 是一个空白的 HTML 文件。我把它放在那里，这样我就可以刷新 index.html 并且还有 index.html 未使用 白色它会被新版本覆盖。我不确定这是否会发生或什至是必要的，但它之前没有工作，我认为这可能会解决它，但它没有。

更多信息：

```
<*RootViewController.h*>

@interface RootViewController: UIViewController {
    UINavigationBar*navBar;
    UIWebView*webView;
}
@property (nonatomic, retain) UIWebView*webView;
@end 
```

和

```
<*RootViewController.mm*>

#import "RootViewController.h";
@implementation RootViewController
- (void)loadView {
    //this is where I set up the webview, navigation bar, and button
}

@synthesize webView;

- (void)theButtonPressed {
    //this is where I try to update the index.html file
} 
```

请让我知道我做错了什么以及如何解决它，或者您是否需要更多信息。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T03:25:13.960

捆绑包不是只读的，您正在尝试写入它。

# jquery - 如何将数组从ajax传递到后面的代码

> ID：10406202
> 
> 赞同：0
> 
> 时间：2012-05-02T00:26:17.657
> 
> 标签：jquery, asp.net, ajax

我的 jQuery 中有一个字符串 myArray[] 数组，该值是动态生成的。我的代码后面还有一个方法，它有 string[] myArray。

我在我的 jQuery 中使用以下代码

```
$.ajax({
  type: "POST",
  url: "myurl/MyMethod",
  data: "{'strArray' :" + myArray + ", 'id':" + x + "}",
  dataType: "json",
  success: function(response){
  // DO SOME STUFF WITH THE RESPONSE...
  }
}); 
```

我的代码中有以下内容

```
[WebMethod]
public static bool MyMethod(string[] strArray, int id)
{
  // DO SOME STUFF WITH THE PARAMETERS
} 
```

现在的问题是 ajax 没有调用 MyMethod。任何点...

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T02:07:37.457

问题解决了...

jQuery 中的字符串数组可以在后面的代码中作为整个字符串读取。例子：

```
var myArray[] = {"string 1", "string 2", "string 3"}; 
```

将会

```
string myValue = "string 1,string 2,string 3"; 
```

在服务器端代码中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T06:00:13.247

试试这个：

```
var myParam = {'strArray' : myArray, 'id' : x };

$.ajax({
  type: "POST",
  url: "myurl/MyMethod",
  data: $.param(myParam),
  dataType: "json",
  success: function(response){
  // DO SOME STUFF WITH THE RESPONSE...
  }
}); 
```

如果您使用的是 MVC，并且您的输入元素与您传回的值匹配，则您可以序列化所有输入：`data: $('form').serialize(),`

# ruby-on-rails - gmaps4rails1.5.1-地理编码不起作用

> ID：10406204
> 
> 赞同：1
> 
> 时间：2012-05-02T00:26:51.370
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, google-maps, gmaps4rails

位置已添加到表中。但缺少纬度/经度。所以没有标记添加到地图上。

```
class Location < ActiveRecord::Base
  validates :priority,:addr,:presence=>true
  validates :priority,:numericality=>{:greater_than_or_equal_to =>1,:less_than_or_equal_to =>6}
  default_scope :order=>'priority'
  acts_as_gmappable :lat=>'lat',:lng=>'lng'

  def gmaps4rails_address
    self.addr
  end

  def gmaps4rails_infowindow
    "<h4>Target priority: #{priority}</h4>" << "<h4>Address: #{addr}</h4>" << "<h4>Latitude: #{lat}</h4>" << "<h4>Longitude: #{lng}</h4>"
  end

 def gmaps4rails_marker_picture
  {
      "picture" => "/images/#{priority%7}.jpg",
      "width" => "30",
      "height" => "30"
  }
  end
end 
```

![添加新位置后](../Images/93d76f2dba4724215268232c71156924.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:32:02.587

只需设置`gmaps`为`false`触发地理编码（如文档所述）

# php - 使用 PHP 对象设置递归属性是否安全？

> ID：10406207
> 
> 赞同：2
> 
> 时间：2012-05-02T00:28:00.247
> 
> 标签：php, oop, object, properties, recursion

我到处寻找，似乎找不到答案。我想知道的是在 PHP 中使用递归对象是否安全或良好的做法。要将对象创建为另一个对象的属性，该对象包含一个引用包含对象的属性...

```
<?php

    class User
    {
        public $database;

        public function __construct() {
            $this->database = new Database($this);
        }
    }

    Class Database
    {
        private $user;

        public function __construct(User $user) {
            $this->user = $user;
        }

        public function doSomethingForUser() {
            // Call db or get info for this user
        }
    } 
```

然后按如下方式使用它...

```
 <?php
        $bar = new User();
        $bar->database->doSomethingForUser();
    ?> 
```

我只是注意到在尝试对对象数组进行排序时，我在使用某些函数时遇到了问题，例如 array_multisort（特别是“PHP 致命错误：嵌套级别太深 - 递归依赖？”），当我使用 var_dump 时，它显示一些属性是递归的......

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:34:08.690

在 PHP 5.3 之前，这可能会导致问题。PHP 用于进行引用计数，循环引用用于防止对象被 GC。

现在 5.3 实现了一个像样的垃圾收集器，这不是什么大问题。但是，如果函数没有意识到这种可能性并准备好处理它，那么将这些对象传递给遍历对象图的任何函数仍然可能导致无限递归。（我认为`var_dump`可以很好地处理递归，但是递归排序这些对象可能会导致各种麻烦。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:34:32.920

请注意，这`bar->database->any_method()`不起作用，因为`database`它是私有的。

当您在 PHP 中创建对对象的递归引用时，它实际上非常好——它只是使用现有的引用并且显然不会创建更多的内存。在这种情况下，您并没有创建一个不确定的递归级别——它只是一组对象，因此除非您创建大量这些对象（并且可能出于不同的原因），否则不太可能发生溢出.

如果您执行`var_dump`on `User`，您将看到：

```
object(User)#1 (1) {
  ["database:private"]=>
  object(Database)#2 (1) {
    ["user:private"]=>
    object(User)#1 (1) {
      ["database:private"]=>
      object(Database)#2 (1) {
        ["user:private"]=>
        *RECURSION*
      }
    }
  }
} 
```

...所以 PHP 注意到递归。

我还不得不问*为什么*在这种情况下你会这样做。

# c# - JQuery 无法识别点击表格行

> ID：10406208
> 
> 赞同：2
> 
> 时间：2012-05-02T00:28:03.747
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3

我正在将 JQuery 模板用于我的表的数据......并且 CSS 可以识别查询模板脚本中的表行并按照我想要的方式设置它们的样式......但由于某种原因，我不能调用 $()。使用相同的标识符单击这些相同的行。这是表格代码：

```
<script id="donorTemplate" type="text/x-jquery-tmpl">
<tr id="indexTR">
    <td>${Person.LastName}, ${Person.FirstName}</td>
    <td>${Address.Address1}</td>
    <td>${PhoneContact.PhoneNumber}</td>
    <td>${EmailContact.EmailContactx}</td>
    <td>${Company.CompanyName}</td>
    <td><a href="/Donation/Index?id=${Person.PersonID}">Add Donation</a></td>
    <td> <a href="/Person/Edit?id=${Person.PersonID}">Edit</a> &nbsp; <a href="/Person/Delete?    
id=${Person.PersonID}">Delete</a> &nbsp;
        <input type="hidden" id="hiddenField" value="${Person.PersonID}"/>
    </td> 
</tr>
</script>

<div id="searchresults">
<table id="donor-list">
<thead>
<tr>
    <th id="f" width="150">Name: </th>
    <th width="180">Address: </th>
    <th width="85">Phone: </th>
    <th width="150">Email: </th>
    <th width="100">Company: </th>
    <th width="100"></th>
    <th id="l" width="100"></th>
</tr>
</thead>
<tbody id="tableBody">

</tbody>
</table> 
```

和 JQuery....

```
$("#donorSearch").submit(function (event) {
        event.preventDefault();
        var form = $(this);
        $.getJSON(form.attr("action"), form.serialize(), function (data) {
            $("#tableBody #indexTR").remove();
            $("#donorTemplate").tmpl(data).appendTo("#tableBody");
        });
    }); 
```

这都是花花公子......但这不起作用：

```
$("#indexTR").click(function () {
       alert('test');
    }); 
```

这就是我在 TR 点击时尝试做的事情：

```
var val = $("#hiddenField").val();
var personID = parseInt(val);
location.href = "/Person/Details?id=" + personID; 
```

在我切换到 JQuery 模板之前，它一直有效。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:31:29.250

准备好后 DOM中`<tr id= "#indexTR">`不存在 ，因此使用委托事件应该可以解决问题：

```
$('#donor-list').on('click', '#indexTR', function(){
    alert('test');
}); 
```

**对于 jQuery 1.5：**

```
$('#donor-list').delegate('#indexTR', 'click', function(){
    alert('test');
}); 
```

**或者在每行新创建时附加回调。**

```
$.getJSON(form.attr("action"), form.serialize(), function (data) {
        $("#tableBody #indexTR").remove();
        $("#donorTemplate").tmpl(data).appendTo("#tableBody");
        // Now attach the event:
        $("#indexTR").click(function () {
           alert('test');
        });
    }); 
```

你遇到了多个元素相同的问题`id`。正如您问题的评论中所讨论的那样。

# jakarta-ee - 编译java测试问题

> ID：10406213
> 
> 赞同：1
> 
> 时间：2012-05-02T00:28:26.427
> 
> 标签：jakarta-ee

当我在 java 中编译我的测试时出现这个错误 - `package org.mockito does not exist` 和

`class Mock does not exist`

虽然`org`包已经导入。

这样做的具体原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:29:20.700

这意味着包含这些类的 JAR 不在您的测试 CLASSPATH 中。添加它们，它会工作。

`import`与加载类完全无关。它所做的只是节省您的输入：您可以在代码 `java.lang.String`中引用。`String`

# objective-c - 为什么 arc4random 返回古怪的值？

> ID：10406216
> 
> 赞同：3
> 
> 时间：2012-05-02T00:29:00.503
> 
> 标签：objective-c

我在我的 iOS 应用程序的一个函数中调用 arc4random 来生成从 -5 到 6 的随机值。

```
double num;
for (int i = 0; i < 3; i++) {
    num = (arc4random() % 11) - 5;
    NSLog(@"%0.0f", num);
} 
```

我从控制台得到以下输出。

```
2012-05-01 20:25:41.120 Project32[8331:fb03] 0
2012-05-01 20:25:41.121 Project32[8331:fb03] 1
2012-05-01 20:25:41.122 Project32[8331:fb03] 4294967295 
```

0 和 1 是范围内的值，但是哇，4294967295 是从哪里来的？

更改`arc4random()`以`rand()`解决问题，但是`rand()`，当然，需要播种。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T00:48:22.483

`arc4random()`返回一个`u_int32_t`-- 这是一个无符号整数，不代表负值。每次`arc4random() % 11`得出一个数字 0 ≤ n < 5，你减去 5 并环绕到一个非常大的数字。

`double`当然， s*可以*表示负数，但你不会转换为，`double`直到为时已晚。在里面放一个演员表：

```
 num = (double)(arc4random() % 11) - 5; 
```

在减法之前提升模的结果，一切都会好起来的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T00:32:40.797

尝试使用

```
arc4random_uniform(11) - 5; 
```

反而。

从手册页：

```
arc4random_uniform() will return a uniformly distributed random number
 less than upper_bound.  arc4random_uniform() is recommended over con-
 structions like ``arc4random() % upper_bound'' as it avoids "modulo bias"
 when the upper bound is not a power of two. 
```

# android - ListView 性能缓慢

> ID：10406217
> 
> 赞同：1
> 
> 时间：2012-05-02T00:29:02.160
> 
> 标签：android, listview, simplecursoradapter

我已经使用 Listview/customcursoradapter 创建了一个食谱列表。自定义布局包括食谱的照片，现在我在查看和滚动的性能方面遇到了一些问题，`ListView`尽管它只有 10 条记录（目标是 150 条）。有时我会收到此错误`java.lang.OutOfMemoryError: bitmap size exceeds VM budget`，我尝试实现`AsyncTask`但未能做到。有什么办法可以克服这个问题吗？

非常感谢您的帮助！

这是我的`getView`方法

```
public View getView(int position, View convertView, ViewGroup parent) {
    View row = super.getView(position, convertView, parent);
    Cursor cursbbn  = getCursor();
    if (row == null)
    {
        LayoutInflater inflater = (LayoutInflater) localContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        row = inflater.inflate(R.layout.listtype, null);
    }

    String Title = cursbbn.getString(2);
    String SandID=cursbbn.getString(1);
    String Readyin = cursbbn.getString(4);
    String Faovoites=cursbbn.getString(8);

    TextView titler=(TextView)row.findViewById(R.id.listmaintitle);
    TextView readyinr=(TextView)row.findViewById(R.id.listreadyin);

    int colorPos = position % colors.length;
    row.setBackgroundColor(colors[colorPos]);

    titler.setText(Title);
    readyinr.setText(Readyin);

    ImageView picture = (ImageView) row.findViewById(R.id.imageView1);

    Bitmap bitImg1 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0001);
    Bitmap bitImg2 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0002);
    Bitmap bitImg3 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0003);
    Bitmap bitImg4 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0004);
    Bitmap bitImg5 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0005);
    Bitmap bitImg6 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0006);
    Bitmap bitImg7 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0007);
    Bitmap bitImg8 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0008);
    Bitmap bitImg9 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0009);
    Bitmap bitImg10 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0010);

    if(SandID.contentEquals("0001"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg1));

    if(SandID.contentEquals("0002"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg2));

    if(SandID.contentEquals("0003"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg3));

    if(SandID.contentEquals("0004"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg4));

    if(SandID.contentEquals("0005"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg5));

    if(SandID.contentEquals("0006"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg6));
    if(SandID.contentEquals("0007"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg7));
    if(SandID.contentEquals("0008"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg8));
    if(SandID.contentEquals("0009"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg9));

    if(SandID.contentEquals("0010"))
        picture.setImageBitmap(getRoundedCornerImage(bitImg10));

    return row;
} 
```

这是错误：

```
05-02 03:11:55.898: E/AndroidRuntime(376): FATAL EXCEPTION: main
05-02 03:11:55.898: E/AndroidRuntime(376): java.lang.OutOfMemoryError: bitmap size exceeds VM budget
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:460)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:336)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:359)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:385)
05-02 03:11:55.898: E/AndroidRuntime(376):  at master.chef.mediamaster.AlternateRowCursorAdapter.getView(AlternateRowCursorAdapter.java:83)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.AbsListView.obtainView(AbsListView.java:1409)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.ListView.makeAndAddView(ListView.java:1745)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.ListView.fillUp(ListView.java:700)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.ListView.fillGap(ListView.java:646)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.AbsListView.trackMotionScroll(AbsListView.java:3399)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.AbsListView.onTouchEvent(AbsListView.java:2233)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.widget.ListView.onTouchEvent(ListView.java:3446)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.View.dispatchTouchEvent(View.java:3885)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:903)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
05-02 03:11:55.898: E/AndroidRuntime(376):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1691)
05-02 03:11:55.898: E/AndroidRuntime(376):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1125)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.app.Activity.dispatchTouchEvent(Activity.java:2096)
05-02 03:11:55.898: E/AndroidRuntime(376):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1675)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2194)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1878)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.os.Looper.loop(Looper.java:123)
05-02 03:11:55.898: E/AndroidRuntime(376):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-02 03:11:55.898: E/AndroidRuntime(376):  at java.lang.reflect.Method.invokeNative(Native Method)
05-02 03:11:55.898: E/AndroidRuntime(376):  at java.lang.reflect.Method.invoke(Method.java:507)
05-02 03:11:55.898: E/AndroidRuntime(376):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-02 03:11:55.898: E/AndroidRuntime(376):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-02 03:11:55.898: E/AndroidRuntime(376):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:06:47.503

首先，你没有使用 convertView，你应该开始，

```
View view = convertView;
if (view == null) {
  // inflate
} 
```

这是一篇关于使用 convertView 的博客文章，

> [http://android-er.blogspot.com/2010/06/using-convertview-in-getview-to-make.html](http://android-er.blogspot.com/2010/06/using-convertview-in-getview-to-make.html)

其次，您应该只解码您知道将使用的位图。所以改变你的方法，

```
if(SandID.contentEquals("0001"))
    Bitmap bitImg1 = BitmapFactory.decodeResource(localContext.getResources(), R.drawable.rec0001);
    picture.setImageBitmap(getRoundedCornerImage(bitImg1));
... 
```

第三，您可以将它们解码一次，并在此方法之外使用它们吗？例如，在构造函数中对它们进行一次解码并将它们作为实例成员存储在适配器类中，然后在`getView()`.

第四，你在回收你的位图吗？位图的分配方式与其他对象不同，并且需要`recycle()`在使用完它们后调用它们的方法。如果您可以实现上面的第三项，则可以在很大程度上避免这种复杂性，尽管您仍然应该在活动停止时释放它们，在活动开始时重新分配它们。

关于 SO 有很多很好的信息`Bitmap.recycle()`，我建议您花一些时间研究它。解释其中的复杂性超出了此处的帖子所能完成的范围。这是一篇涵盖该主题的好帖子，

> [Bitmap、Bitmap.recycle()、WeakReferences 和垃圾回收](https://stackoverflow.com/questions/4959485/bitmap-bitmap-recycle-weakreference-and-garbage-collector)

# mysql - Rails 3.2.2 SQL 查询生成器

> ID：10406218
> 
> 赞同：2
> 
> 时间：2012-05-02T00:29:16.583
> 
> 标签：mysql, sql, ruby-on-rails

我试图避免在这里重新发明轮子。我正在寻找一个 GEM，它将采用现有模型并允许用户选择他们想要在视图中显示的字段以及所选字段的过滤条件。然后，此输入将使用结果构建通用数据网格。2009 年[在 Rails 中的 SQL 查询构建器中](https://stackoverflow.com/questions/1846055/sql-query-builder-in-rails)提出了类似的问题，我想知道是否有人知道在此期间是否创建了任何东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:00:38.210

您可以尝试其中一种：

[https://github.com/lunich/table_for](https://github.com/lunich/table_for)

[https://github.com/bogdan/datagrid](https://github.com/bogdan/datagrid)

# xslt - 基于 Umbraco 中的标签生成内容

> ID：10406222
> 
> 赞同：0
> 
> 时间：2012-05-02T00:29:54.880
> 
> 标签：xslt, umbraco, umbraco-tags

当我尝试基于特定标签生成内容节点列表时，Umbraco，或者更确切地说是 xslt，似乎给了我错误。

考虑宏中的以下代码：

```
<xsl:stylesheet version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:msxml="urn:schemas-microsoft-com:xslt"
xmlns:tagsLib="urn:tagsLib"
xmlns:umbraco.library="urn:umbraco.library" xmlns:Exslt.ExsltCommon="urn:Exslt.ExsltCommon"     xmlns:Exslt.ExsltDatesAndTimes="urn:Exslt.ExsltDatesAndTimes" xmlns:Exslt.ExsltMath="urn:Exslt.ExsltMath" xmlns:Exslt.ExsltRegularExpressions="urn:Exslt.ExsltRegularExpressions" xmlns:Exslt.ExsltStrings="urn:Exslt.ExsltStrings" xmlns:Exslt.ExsltSets="urn:Exslt.ExsltSets" 
exclude-result-prefixes="msxml tagsLib umbraco.library Exslt.ExsltCommon Exslt.ExsltDatesAndTimes Exslt.ExsltMath Exslt.ExsltRegularExpressions Exslt.ExsltStrings Exslt.ExsltSets ">
<xsl:output method="xml" omit-xml-declaration="yes"/>

<xsl:param name="currentPage"/>

<xsl:variable name="location"  select="$currentPage/othertag" />

<xsl:template match="/">
<div class="more-news">
  <xsl:value-of select="$currentPage/location"/>
  <h4>More news from <span class="capitalize"><xsl:value-of select="$location"/></span></h4>
  <ul>
    <xsl:for-each select="tagsLib:getEverythingWithTags('somalia')/root/node">
      <li><a href="#"><xsl:value-of select="@nodeName"/></a></li>
      <xsl:value-of select="@nodeUrl"/>
    </xsl:for-each>
  </ul>
</div>
</xsl:template>

</xsl:stylesheet> 
```

我在这里尝试做的是查找所有带有在当前页面上定义的标签（位置）的内容。上述设置适用于查找所有带有位置标签“索马里”的页面。

该行：

```
<xsl:for-each select="tagsLib:getEverythingWithTags('somalia')/root/node"> 
```

*应该*（我认为）是：

```
<xsl:for-each select="tagsLib:getEverythingWithTags($location)/root/node"> 
```

但是像这样保存代码会给我以下错误：

```
umbraco.DataLayer.SqlHelperException: Umbraco Exception (DataLayer): SQL helper exception in ExecuteReader ---> System.Data.SqlClient.SqlException: Incorrect syntax near ')'. 
at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) 
at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() 
at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 
at System.Data.SqlClient.SqlDataReader.ConsumeMetaData() 
at System.Data.SqlClient.SqlDataReader.get_MetaData() 
at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) 
at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) 
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) 
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) 
at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) 
at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior) 
at Microsoft.ApplicationBlocks.Data.SqlHelper.ExecuteReader(String connectionString, CommandType commandType, String commandText, SqlParameter[] commandParameters) 
at umbraco.DataLayer.SqlHelpers.SqlServer.SqlServerHelper.ExecuteReader(String commandText, SqlParameter[] parameters) 
at umbraco.DataLayer.SqlHelper`1.ExecuteReader(String commandText, IParameter[] parameters) 
--- End of inner exception stack trace --- 
at umbraco.DataLayer.SqlHelper`1.ExecuteReader(String commandText, IParameter[] parameters) 
at umbraco.cms.businesslogic.Tags.Tag.GetNodesWithTags(String tags) 
at umbraco.editorControls.tags.library.getEverythingWithTags(String tags) 
```

任何帮助和想法表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T12:44:08.737

您是否使用此行代码检查了“$currentPage/othertag”的内容：

```
<xsl:value-of select="$currentPage/othertag" /> 
```

之后，您应该将此代码行放在 xslt 而不是 foreach 循环中：

```
<xsl:value-of select="tagsLib:getEverythingWithTags($location)" /> 
```

并检查标签的内容。

# java - Java 并发和任务

> ID：10406226
> 
> 赞同：3
> 
> 时间：2012-05-02T00:31:02.840
> 
> 标签：java, multithreading, concurrency

当涉及到 Java 领域的多线程和并发时，共识是将您想要多线程的代码隔离为“任务”，并将该任务提交给某种执行程序服务或线程池。

我想知道的是：

*   任务可以是*任何对象的**任何*方法，还是必须是特殊的（如果是，是什么）？
**   您如何确定此任务是否受 CPU、IO 限制或其他限制？什么是“死的赠品”或其他决定因素？*

 *在此先感谢您的澄清！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:38:22.540

看看[`ExecutorService`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)：

*   `submit(Callable)`
*   `submit(Runnable)`

您的任务可能应该是两个接口之一（始终可以调用其他方法）。

如果您在其中执行任何输入/输出操作，您的任务可能是 IO 绑定的：IE、读取文件、写入文件、从套接字读取、写入套接字等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:32:48.157

`Threads`通常执行他们在实现`Runnable`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:01:48.163

> 任务可以是任何对象的任何方法，还是必须是特殊的（如果是，是什么）？

它可以是任何东西。最大的问题是您的任务可能会包含一些与其他线程共享的对象。您必须确保对这些对象的访问是线程安全的。这是一个复杂的话题；Goetz 等人的“Java Concurrency in Practice”是一本非常好的书。*

# javascript - 在javascript中需要帮助包装一个函数并正确处理“this”

> ID：10406230
> 
> 赞同：2
> 
> 时间：2012-05-02T00:31:15.177
> 
> 标签：javascript, function, this

我开始尝试创建一个计时器函数，它可以让我包装一个回调函数，以便以后可以动态地改变行为。

这导致了一个普遍的认识，即我真的不了解函数，并且绝对不了解“this”发生了什么

我在[jsfiddle上有一个测试环境设置](http://jsfiddle.net/gxxaxx/DYNke/10/)

```
myns = {};
myns.somefunc = function(txt) {
    this.data = txt;
    this.play = function() {
        alert(this.data + ' : '+dafunc.data);
    };
};

var dafunc = new myns.somefunc('hello world');

myns.Timer = function(msec, callback) {
    this.callback = null;
    this.timerID = null;

    this.ding = function() {
        this.callback();
    };

    this.set1 = function( msec, callback ) {
        this.stop();
        this.callback = callback;
        this.timerID = setTimeout(this.ding, msec );
    };

    this.set2 = function( msec, callback ) {
        this.callback = callback;
        var wrappedDing = (function(who) {
            return function() {
                who.ding();
            };
        })(this);
        this.timerID = setTimeout(wrappedDing, msec );
    };
    //this.set1(msec, callback);
    this.set2(msec, callback);    
};

var ttimer = new myns.Timer(1000, dafunc.play); 
```

如果我使用 set1 方法，则回调不起作用。所以我正在尝试 set2 方法。这让我了解了 play 方法，但“this”并不是指 somefunc 的实例。

我以为我走在正确的轨道上，但是“这个”的混淆让我感到困惑。

任何线索都会受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:35:33.397

问题是，与 python 之类的语言不同，当您将 dafunc.play 传递给其他地方（回调 = dafunc.play）时，它会忘记它与 dafunc 相关联，儿子您需要使用另一个包装函数，就像您在 set2 函数中所做的那样。

```
var ttimer = new myns.Timer(1000, function(){ return dafunc.play(); }); 
```

* * *

自己制作所有额外的功能很烦人。您可以改用较新浏览器中可用的 bind 方法：

```
var wrappedDing = this.ding.bind(this);

new myns.Timer(1000, dafunc.play.bind(dafunc) ); 
```

或者，如果您也需要支持旧版本的 IE，您也可以使用类似的 shim。

* * *

最后，如果您不打算利用某种形式的继承或动态绑定，您可以改写代码以使用闭包。由于所有内容都是词法范围的，因此您不必再担心`this`：

（顺便说一句，我最终简化了过程中的代码......）

```
myns = {};

myns.somefunc = function(txt) {
    var obj = { data : txt };
    obj.play = function() {
        alert(obj.data);
    };
    return obj;
};

var dafunc = myns.somefunc('hello world');

myns.timer = function(msec, callback) {
    var timerID = null;

    var set = function(){
        stop();
        timerID = setTimeout(callback, msec);
    };

    set();

    return { 
         set: set
    };
};

var ttimer = myns.timer(1000, dafunc.play); 
```

* * *

最后一件事：如果您不讨厌自己，请使用 console.log 以及浏览器的调试器和开发控制台，而不是使用警报进行输出。

# c - 为什么打印这个字符串时我做错了？

> ID：10406237
> 
> 赞同：1
> 
> 时间：2012-05-02T00:32:11.620
> 
> 标签：c, arrays, string, data-structures

我正在尝试将 char 数组设置到结构中，但是当我尝试将其打印出来时。我得到一个分段错误。我究竟做错了什么？

```
typedef struct buckets_{
  char *key;
  data *next;
}buckets;

typedef struct hash_table_ {
  int (*hash_func)(char *);
  int (*comp_func)(void*, void*);
  buckets **buckets_array;
} hash_table, *Phash_table;

table_p -> buckets_array[0] = malloc(sizeof(buckets));
table_p -> buckets_array[1] = malloc(sizeof(buckets));

 char word2[5] = "Hieo";

table_p -> buckets_array[1] -> key = malloc(sizeof(word2));
table_p -> buckets_array[1] -> key = word2;
printf("%s",table_p -> buckets_array[i] -> key);  /*Getting segmitation falut here*/ 
```

Opp 忘了提到我有一个分配数组的函数。假设我分配了数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:36:28.497

这是我能看到的：

1.  ~~你没有分配`buckets_array`。~~
2.  您为 分配了内存`key`，但随后通过分配立即泄漏`key = word2`。我猜你的意思是使用`strcpy`or `memcpy`。
3.  您使用了一个可能未初始化的变量，名为`i`. 我想这就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:34:26.490

你从不初始化`bucket_array`，所以它是一个无效的指针。你需要先初始化它：

```
table_p->buckets_array = malloc(number_of_elements * sizeof(buckets*));
// now that the top level pointer is initialize
// you can initialize each element that it points to. 
```

# c - 在 C 中读取 .png 文件并通过套接字发送

> ID：10406239
> 
> 赞同：0
> 
> 时间：2012-05-02T00:32:23.523
> 
> 标签：c, sockets, segmentation-fault

我目前正在使用 C 实现的简单服务器。处理 jpg 文件工作正常，btu png 给我一个分段错误。我从来没有通过这段代码。为什么会这样？

```
fseek (file , 0 , SEEK_END);
lSize = ftell (file);
rewind (file); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:18:13.733

您更有可能以有问题的方式访问这些数组。检查缓冲代码中的逻辑。确保您的缓冲区大小#define'd 在中心位置，而不是硬编码大小和偏移量。你让它不再崩溃，但如果你错过了一个潜在的逻辑错误，当你改变其他东西时，你可能会遇到神秘的问题。可能值得您花时间故意再次破坏程序并弄清楚它为什么会被破坏。正如其他人所建议的那样，此时调试器将是一个绝妙的主意。或发布更完整的代码示例。

# javascript - 使用 KnockoutSortable 取消删除

> ID：10406241
> 
> 赞同：1
> 
> 时间：2012-05-02T00:32:30.967
> 
> 标签：javascript, knockout.js, knockout-sortable

我正在尝试让 cancelDrop 选项与 Knockout 可排序绑定一起使用。现在，只是为了调试，我正在尝试取消所有动作。

这是我的标记

```
<ol class="toc-child" 
     data-bind="sortable: {template: 'listTemplate', data:children, isEnabled: $root.allowEditing, beforeMove: beforeMove }"></ol> 
```

这是我的 beforeMove 功能

```
this.beforeMove = function(arg, b, c){
    //debugger;
    arg.cancelDrop = true;
}; 
```

当我取消注释调试器语句时，我可以看到函数命中，我可以看到 cancelDrop 属性被设置，我什至看到

```
if (arg.cancelDrop) {
    $(ui.sender).sortable('cancel');
    return;
} 
```

按理执行。但动作仍然存在。

特别奇怪的是 beforeMove 函数似乎在被移动的项目被放置在新位置之后被调用。我应该期望在此之前看到这个被调用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:51:26.027

看起来我有旧版本的绑定。线

```
$(ui.sender).sortable('cancel'); 
```

应该

```
$(arg.sourceParent === arg.targetParent ? this : ui.sender).sortable('cancel'); 
```

哪个修复它。

# android - 使用onDraw将背景图像添加到画布？

> ID：10406242
> 
> 赞同：0
> 
> 时间：2012-05-02T00:32:33.683
> 
> 标签：android

我正在尝试用自定义图像替换标准黑色背景，但不确定如何实现它......

代码（onDraw 方法）：

```
 @Override
    protected void onDraw(Canvas c) {
        //c.drawARGB(255, 0, 0, 0);

        if ( overlay.tick() )
            if ( !todraw.tick() )
                mintercept.endGame();
        todraw.draw(c, Layer.BACKGROUND);
        todraw.draw(c, Layer.CITIES);
        todraw.draw(c, Layer.TRAILS);
        todraw.draw(c, Layer.EXPLOSIONS);
        todraw.draw(c, Layer.MISSILES);
        todraw.draw(c, Layer.CHROME);
        overlay.draw(c, Layer.CHROME);
    }

    public abstract void reset();
} 
```

注释行负责黑色背景（或者我相信......）；空白空间是为我实现自定义背景图像而保留的。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:47:29.137

Canvas 有一个[`drawBitmap`](http://developer.android.com/reference/android/graphics/Canvas.html#drawBitmap%28int%5B%5D,%20int,%20int,%20float,%20float,%20int,%20int,%20boolean,%20android.graphics.Paint%29)方法：使用 a`BitmapFactory`从资源中获取您的图像并绘制它，您应该一切顺利。

# mysql - 让 Rails 只对一些请求使用 ActiveRecord

> ID：10406248
> 
> 赞同：1
> 
> 时间：2012-05-02T00:33:01.873
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord, rack

我有一个 Rails 应用程序，其中绝大多数请求不以任何方式使用 ActiveRecord。如果 MySQL 不可用时应用程序的其余部分可以无缝运行，那就太好了。但是，似乎在每个请求上，ActiveRecord::Base.verify_active_connections！叫做。这意味着每个端点都会中断，而实际上只有使用 ActiveRecord 的端点需要中断。我该如何配置，以便不需要 ActiveRecord 的操作在没有 MySQL 的情况下可以正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:21:16.490

覆盖它！

```
class ActiveRecord::Base
  def self.verify_active_connections!
    begin
       super
    rescue
      puts "Do something"
    end
   end
 end 
```

仅仅做一个毯子开始/救援可能不是最好的主意，但你明白了。有关更多信息，请查看以下问题：[Ruby on Rails 中的“MySQL 服务器已消失”](https://stackoverflow.com/questions/100631/mysql-server-has-gone-away-with-rails)

# ios - ios 阻止潜在的内存泄漏

> ID：10406249
> 
> 赞同：2
> 
> 时间：2012-05-02T00:33:12.757
> 
> 标签：ios, memory-management, automatic-ref-counting, cftypes

```
- (NSString*)encodeURL:(NSString *)string
{
    NSString *newString = (__bridge NSString *)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (__bridge CFStringRef)string, NULL, CFSTR(":/?#[]@!$ &'()*+,;=\"<>%{}|\\^~`"), CFStringConvertNSStringEncodingToEncoding(NSUTF8StringEncoding));

    if (newString) 
    {
        return newString; // <-- potential leak here
    }

    return @"";
} 
```

我不熟悉 CFTypes（除了知道它们是什么）。这是我从互联网上获得的代码，我不得不费力地让它在 ARC 中工作。我收到了潜在的泄漏警告，但不知道如何解决。建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T00:40:39.167

是的，这是内存泄漏。你的意思是使用`CFBridgingRelease()`而不是`__bridge`.

由创建的对象`CFURLCreateStringByAddingPercentEscapes`有一个额外的保留，因为它包含`Create`. 您需要将该对象传输到 ARC，让它知道添加一个额外的版本，这就是这样`CFBridgingRelease()`做的。

```
NSString *newString = 
    CFBridgingRelease(
        CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, 
                                               (__bridge CFStringRef)string, 
                                               NULL,
                                               CFSTR(":/?#[]@!$ &'()*+,;=\"<>%{}|\\^~`"),           
                                               kCFStringEncodingUTF8)); 
```

您确实使用`__bridge`了传入的字符串，因为您没有将其传输到 Core Foundation。您只是要求 Core Foundation 使用它，而 ARC 继续拥有它。当您“转让”所有权时，您通常的意思是“这个对象曾经是 Core Foundation，现在是 ARC”（反之亦然）。这就是正在发生的事情`newString`。

我用结果交换了长的 NS-to-CF 编码函数，只是为了让它更短。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:39:55.270

返回字符串的自动释放版本，`CFStringRef`可以转换为`NSString`，反之亦然，这也意味着您可以将其视为普通版本`NSString`，从而自动释放它（如果您对此感兴趣，您应该阅读有关部分之间的免费桥接`Foundation`和`Core Foundation`)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-23T03:29:26.463

另一种方法是使用 __bridge_transfer 而不是 __bridge ，如下所示：

```
NSString *newString = (__bridge_transfer NSString *)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (__bridge CFStringRef)string, NULL, CFSTR(":/?#[]@!$ &'()*+,;=\"<>%{}|\\^~`"), CFStringConvertNSStringEncodingToEncoding(NSUTF8StringEncoding)); 
```

请参阅此问题中的更多信息：[ARC 的正确桥接？](https://stackoverflow.com/questions/6822473/correct-bridging-for-arc)

# jquery - 如何使用 jQuery Mobile 显示全屏谷歌地图？

> ID：10406252
> 
> 赞同：7
> 
> 时间：2012-05-02T00:33:43.510
> 
> 标签：jquery, google-maps, jquery-mobile, google-maps-api-3

以下代码显示奇怪的输出。我应该看到全屏移动地图。但由于某种原因，它只显示在屏幕的一部分上。我正在使用**jquery.ui.map**进行映射。

```
<!DOCTYPE html> 
<html> 
    <head> 
    <title>My Page</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="css/jquery.mobile-1.1.0.min.css" />
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script src="js/jquery-1.7.1.min.js"></script>
    <script src="js/jquery.mobile-1.1.0.min.js"></script>
    <script type="text/javascript" src="js/jquery.ui.map.min.js"></script>
</head> 
<body> 

<div data-role="page">

    <div data-role="header">
        <h1>My Title</h1>
    </div><!-- /header -->

    <div data-role="content" id="map_canvas"  name="contentMain">   

    </div><!-- /content -->

</div><!-- /page -->
<script>

    $('#map_canvas').gmap().bind('init', function() { 
    // This URL won't work on your localhost, so you need to change it
    // see http://en.wikipedia.org/wiki/Same_origin_policy
    $.getJSON( 'http://jquery-ui-map.googlecode.com/svn/trunk/demos/json/demo.json', function(data) { 
        $.each( data.markers, function(i, marker) {
            $('#map_canvas').gmap('addMarker', { 
                'position': new google.maps.LatLng(marker.latitude, marker.longitude), 
                'bounds': true 
            }).click(function() {
                $('#map_canvas').gmap('openInfoWindow', { 'content': marker.content }, this);
            });
        });
    });
});
</script>
</body>
</html> 
```

输出：

![在此处输入图像描述](../Images/064f51a823ca421fa49c56da937f7f22.png)

提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-02T00:48:26.967

我的移动网站的解决方案是`position:absolute; width:100%; height:100%;`为画布 div 设置样式。您可以使用`top`和`bottom`样式为工具栏留出空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T17:02:06.747

**如果您使用 jQuery，**页眉和页脚是不可避免的。**我设置`{data-position="fixed" data-fullscreen="true"}`了页眉和页脚，也设置`html { height: 100% } body { height: 100%; margin: 0; } #map { position:absolute; width: 100%; height: 100%; padding: 0; }`了，以便菜单和地图在移动设备上完美地协同工作。**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-01T11:49:09.633

容器和地图画布需要 100% 的宽度和高度。

从 jQuery 移动网站，它们的结构是：

```
<div data-role="page" id="map-page" data-url="map-page">
    <div data-role="header" data-theme="c">
        <h1>Maps</h1>
    </div>
    <div data-role="content" id="map-canvas">
        <!-- map loads here... -->
    </div>
</div> 
```

和CSS：

```
#map-page, #map-canvas { width: 100%; height: 100%; padding: 0; } 
```

从这里：http: [//view.jquerymobile.com/master/demos/examples/maps/geolocation.php](http://view.jquerymobile.com/master/demos/examples/maps/geolocation.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-19T19:22:00.657

我已经搞砸了一段时间，并设法找到了完美的解决方案。它适用于有或没有标题的页面。对于任何分辨率和任何页眉高度，它都会将地图完美地定位在页眉和页面底部之间的空间中（如果没有页眉，则在整个页面上）。

如果页面有标题，此解决方案需要 CSS 和 JS，仅当页面没有标题时才需要 CSS。

**HTML**

```
<div data-role="page" id="mapPage">
    <div data-role="header"`>
        <!-- your header HTML... -->
    </div>

    <div data-role="content">
        <div id="map-canvas"></div>
        <p id="nogeolocation"></p>
    </div>
</div> 
```

**CSS**

```
#map-canvas {
    position: absolute;
    width: 100%; 
    height: 100%;
    top: 0;
    left: 0;
}

/* eliminates scrollbars in map infowindow (optional) */
#mappopup {
    line-height: 1.35;
    overflow: hidden;
    white-space: nowrap;
} 
```

**JS**

```
var mapPageHeader = $("#mapPage .ui-header").eq(0);
if(mapPageHeader.length > 0) {
    var headerHeight = mapPageHeader.outerHeight();
    $("#map-canvas").css({
        'height': ($(window).height() - headerHeight + 1) + 'px',
        'top': headerHeight - 1
    });
} 
```**

# python - 使用 subprocess.Popen() 时，stderr 和 stdout 没有输出

> ID：10406257
> 
> 赞同：8
> 
> 时间：2012-05-02T00:34:33.047
> 
> 标签：python, svn, subprocess

我正在使用 Python 自动执行 SVN 提交，并且我想将 SVN 命令的输出写入日志文件。我拥有的代码可以使 SVN 运行，但问题是在成功提交时，`subprocess`调用不会为我的日志返回任何输出。

相比之下，当我手动运行 SVN 时，我得到的输出显示了命令的进度并显示了正在提交的文件。这就是我想要的日志文件。SVN 是否将该数据输出到缓冲区而不是 stdout 或 stderr？如何为我的日志捕获该数据？

这是我正在使用的代码：

```
cmd = "svn commit --non-interactive --no-auth-cache -m 'Automatic commit' ./"
process = subprocess.Popen(cmd,
                           shell=True,
                           stdout=subprocess.PIPE,
                           stderr=subprocess.PIPE,
                           universal_newlines=True)
result = process.wait()

# Output
out = process.stdout.read()
err = process.stderr.read() 
```

当我运行此代码并且提交成功时，`out`和`err`变量都是空的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T00:37:28.250

不要`wait()`在使用 PIPE 时使用。使用通信（）

```
process = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE,
          stderr=subprocess.PIPE, universal_newlines=True)

out, err = process.communicate() 
```

从[子流程文档](http://docs.python.org/library/subprocess.html#subprocess.Popen.wait)：

> 警告
> 使用communicate() 而不是.stdin.write、.stdout.read 或.stderr.read 以避免由于任何其他操作系统管道缓冲区填满并阻塞子进程而导致的死锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-02T12:40:26.510

它在我的解决方案中起作用：

```
svn_commit_t = 'svn commit "%s" -m "ticket #%s automerge"' % (directory, tic)

svn_co = subprocess.Popen(svn_commit_t, shell=True, stdout=subprocess.PIPE,stderr=subprocess.PIPE, universal_newlines=True)

out, err = svn_co.communicate() 
```

# validation - 将不变量与 Dexterity 表单和字段集一起使用

> ID：10406262
> 
> 赞同：0
> 
> 时间：2012-05-02T00:35:26.910
> 
> 标签：validation, plone, dexterity

我有一个从 plone.directives.form.Schema 派生的内容类型；它在四个字段集中有几十个字段。我正在尝试创建一个 zope.interface.invariant 来查看来自两个不同字段集的字段。

从跟踪行为来看，似乎*每个*字段集都调用了一次不变量，而不是整个表单。

我知道我可以提供自己的处理程序并在那里执行我需要的所有检查，但与明确定义的不变量相比，这感觉很笨重。虽然显而易见的解决方案是将相关字段移动到同一字段集，但当前设置反映了最终用户合乎逻辑的布局。

是否有一个现有的钩子，我可以在其中跨字段集对多个字段执行验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T21:56:03.840

答案似乎是否定的：为每个组/字段集`z3c.form.group.Group.extractData`调用`z3c.form.form.BaseForm.extractData`一次，并且该调用已经包含不变验证。

除了注册自己的*处理程序*之外，您还可以覆盖*extractData*：

```
from plone.directives import form, dexterity
from z3c.form.interfaces import ActionExecutionError,WidgetActionExecutionError
# ...

class EditForm(dexterity.EditForm):
  grok.context(IMyEvent)

  def extractData(self, setErrors=True):
    data, errors = super(EditForm, self).extractData(setErrors)

    if not None in(data['start'], data['end']):
      if data['end'] < data['start']:
        raise WidgetActionExecutionError('end', Invalid(_(u"End date should not lie before the start date.")))
      if data['end'] - data['start'] > datetime.timedelta(days=7):
        raise WidgetActionExecutionError('end', Invalid(_(u"Duration of convention should be shorter than seven (7) days.")))

    return data, errors 
```

请注意，此类派生自 dexterity.EditForm，其中包括 Dexterity 的默认处理程序，而不是 form.SchemaForm。

`WidgetActionExecutionError`但是，不能可靠地工作。对于某些字段，它会产生“KeyError”。

# html - 让孩子决定父母Div的大小

> ID：10406268
> 
> 赞同：0
> 
> 时间：2012-05-02T00:36:56.567
> 
> 标签：html, css

我有一个分隔线，我希望它的最小高度为 126 像素，但是当我使用 javascript 让内容出现在其中时，我希望它随着内容扩展......（因为我在父 div 周围有一个寄宿生，我实际上需要它改变大小不只是显示内部内容）

这应该很容易，但我无法得到任何建议？

我添加了 min-height:126px; 到 div 的样式

但是，当我添加新元素时，我让它的大小相同，并且滚动条出现在两侧，而不是像我想要的那样实际增加大小的元素

这是我的 css（对不起，我将制作 l8ter 类）：

```
#login {
    position:absolute;
    left:661px;
    top:130px;
    width:162px;
    min-height:126px;
    border: 1px solid black;

}

 #username {
    position:absolute;
    left:9px;
    top:5px;
    width:144px;
    height:17px;
    font-family: "Times New Roman", Times, serif;
}

#usernameInput {
    position:absolute;
    left:9px;
    top:23px;
    width:101px;
    height:17px;
}
#password {
    position:absolute;
    left:10px;
    top:40px;
    width:101px;
    height:17px;
    font-family: "Times New Roman", Times, serif;
}
#passwordInput {
    position:absolute;
    left:9px;
    top:59px;
    width:101px;
    height:17px;
}
#signUp {
    position:absolute;
    left:741px;
    top:108px;
    width:83px;
    height:14px;
}
#loginBttn {
    position:relative;
    left:71px;

    width:37px;
    height:16px;
    background-color: #000000;
    color: #FFF;
    font-size: 11px;
    text-align: center;
    font-family: Tahoma, Geneva, sans-serif;
    cursor:pointer;
    font-weight: bold;
}
#CreateAcc {
    position:relative;
    left:12px;
    width:119px;
    height:18px;
    z-index:1;
}
#createAccText {
    position:absolute; /*fix positioning so it looks good in browsers probably use float or something similar */
    left:20px;
    top:4px;
    width:88px;
    height:11px;
    z-index:2;
    font-size: 9px;
    font-family: "MS Serif", "New York", serif;
}

#optional {
    position:absolute;
    left:75px;
    top:8px;
    width:70px;
    height:14px;
    z-index:1;
    font-size: 11px;
    color: #999;
    display: none;  
}
#relativeHolder {
    position:absolute;
    left:0px;
    top:77px;
    width:162px;
    height:auto;
    z-index:1;
}
#email {
    position:relative;
    left:12px;
    top:-2px;
    width:101px;
    height:17px;
    font-family: "Times New Roman", Times, serif;
    display:none;

}
#emailIn {
    position:relative;
    left:10px;
    width:101px;
    height:17px;
    font-family: "Times New Roman", Times, serif;
    display:none;
} 
```

我在 body 标签内的 html ：

```
<div id="login">

<div id="username">Username</div> <div id="optional">(Optional)</div>
<form name="loginForm">
<div id="usernameInput">
<input name="username" type="text" size="20" value="">
</div>
<div id="password">Password</div>
<div id="passwordInput">
<input name="password" type="password" size="20" value="">
</div>
<div id="relativeHolder"> 

<div id="email">Email</div>
<div id="emailIn"><input name="email" type="text" size="20" value=""></div>

<div id="CreateAcc"> 
 <input name='newAcc' type='checkbox' value='newAcc' onClick='signUp()'  >
<div id="createAccText">Create new Account</div>
</div>

<div id="loginBttn" onclick="login()">Login</div>
</div>
</form>

</div>

<div id="signUp" ></div> 
```

javascript:

js没有任何问题，所以我认为我不需要在这里发布它所做的只是将emailIn div的显示样式从隐藏更改为内联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:42:07.777

像这样的东西应该工作：

[http://jsfiddle.net/cvtfS/1/](http://jsfiddle.net/cvtfS/1/)

它使用`min-width`和`min-height`

**编辑：**

所以看起来你使用了很多`absolute`定位，应该避免。

您应该按照以下方式重构您的代码：

[http://jsfiddle.net/PzF4Z/](http://jsfiddle.net/PzF4Z/)

```
<form id="login">
    <label>Username</label>
    <input type="text"  />
    <label>Password</label>
    <input type="password" />
    <div>
        <input type="checkbox" />
        <label>Create new Account</label>
    </div>
    <button>Login</button>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:40:40.343

在父级上设置最小宽度或高度`<div>`

```
min-width:126px; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:39:55.167

```
<div style='min-width:100px; width:100px;'>
     <!-- the content -->
</div> 
```

随着内容的增加，这将扩大。基于父母 - 不是吗？

# knockout.js - Knockout.js - 如何限制自定义绑定

> ID：10406269
> 
> 赞同：5
> 
> 时间：2012-05-02T00:37:11.627
> 
> 标签：knockout.js, ko-custom-binding

我有一个自定义绑定来处理自动完成，当用户从自动完成中选择一个项目时，我与服务器交谈并用缩短的名称替换 text_field。问题是这会再次触发我的自定义绑定的“更新”功能。

Knockout.js 代码（编辑：注意以下是 CoffeeScript）：

```
ko.bindingHandlers.ko_autocomplete =
  init: (element, params) ->
    $(element).autocomplete(params())

  update: (element, valueAccessor, allBindingsAccessor, viewModel) ->
    unless task.name() == undefined
      $.ajax "/tasks/name",
        data: "name=" + task.name(),
        success: (data,textStatus, jqXHR) ->
          task.name(data.short_name)

  Task = ->
    @name = ko.observable()
    @name_select = (event, ui) ->
      task.name(ui.item.name)
      false  

  task = Task.new() 
```

看法

```
= f.text_field :name, "data-bind" => "value: name, ko_autocomplete: { source: '/autocomplete/tasks', select: name_select }" 
```

有没有办法对自定义绑定应用限制？

当我将 task.name 设置为从服务器发回的 short_name 时，我只想阻止自定义绑定“更新”功能再次触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T00:27:09.727

一般来说，我发现这样的模式适合我

```
ko.bindingHandlers.gsExample = 
    update: (element, valueAccessor, allBindingsAccessor, viewModel) ->
        args = valueAccessor()

        # Process args here, turn them into local variables
        # eg.
        span = args['span'] || 10

        render = ko.computed ->
            # Put your code in here that you want to throttle
            # Get variables from things that change very rapidly here

            # Note: You can access variables such as span in here (yay: Closures)
            some_changing_value = some_observable()

            $(element).html(some_changing_value)

        # Now, throttle the computed section (I used 0.5 seconds here)
        render.extend throttle : 500

        # Cause an immediate execution of that section, also establish a dependancy so 
        #  this outer code is re-executed when render is computed.
        render() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:48:07.970

如果你不想违反隔离，那么你可以使用自动完成的延迟选项和它的选择事件，扔掉更新功能。

以这种方式修改您的init：

```
 var options = $.extend(params(), { 
      select: function(ev, ui) {
        var name = ui.item ? ui.item.short_name : this.value
        task.name(name);
      }
    })
   $(element).autocomplete(options) 
```

您的更新被称为第二次，因为（为了简化）更新本身就是某种计算。所以它订阅了它内部访问的每个 observable。在这一行`unless task.name() == undefined`中，您订阅更新到`task.name()`. 然后，当您使用成功的 ajax 请求更新您的 observable 时`task.name(data.short_name)`，更新会得到通知并重新计算。

# vb.net - 在不同形式之间切换

> ID：10406272
> 
> 赞同：0
> 
> 时间：2012-05-02T00:37:38.883
> 
> 标签：vb.net, winforms

我的应用程序中有一些表单，需要在它们之间切换。我不想在其他表单上打开另一个表单，简而言之，我希望用户感觉他只在一个表单上工作。现在我正在做这样的事情，但这不是我想要的

```
 Public Class Form1

    Dim fo As Form2

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Form2.TopLevel = False

        Me.Panel1.Controls.Add(Form2)

        Form2.Show()

    End Sub
End Class 
```

我还需要将数据发送到其他形式，例如某个类的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:47:46.323

查看[UserControls(Composite Controls)](http://msdn.microsoft.com/en-us/library/c316f119.aspx)。它们将允许您创建带有事件和属性的自定义布局并将其添加到您的面板中。我用它来换入/换出我的应用程序的编辑页面。

这是一个*非常*简单的例子：（1个表单，2个面板，2个用户控件）

**表格1**

```
Public Class Form1

    Public Sub New()
        ' This call is required by the designer.
        InitializeComponent()
        ' Add any initialization after the InitializeComponent() call.
    End Sub

    Private Sub UserControl11_SendText(value As String) Handles UserControl11.SendText
        UserControl12.SetText(value)
    End Sub

    Private Sub UserControl12_SendText(value As String) Handles UserControl12.SendText
        UserControl11.SetText(value)
    End Sub
End Class 
```

**用户控制**

```
Public Class UserControl1
    Public Event SendText(ByVal Text As String)

    Public Sub SetText(value As String)
        Label1.Text = value
    End Sub

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        RaiseEvent SendText(TextBox1.Text)
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:38:56.353

您是否考虑过使用[TabControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.tabcontrol.aspx)？这将让您创建不同的屏幕，并且您（或用户）可以轻松地在它们之间切换。

# java - “静态”关键字有什么作用？

> ID：10406273
> 
> 赞同：0
> 
> 时间：2012-05-02T00:37:55.647
> 
> 标签：java, static

我有一个程序，其中有两个形状 Player1 和 Player2，它们都由类 Player 继承。

```
Public class Player{

    public int xPos;
    public int yPos;

    // more code

} 
```

player1类：

```
Public class Player1 extends Player{

    public Player(){
        xPos = 200;
        yPos = 200;
    }
    // more code
} 
```

Player2 类：

```
Public class Player2 extends Player{

    public Player2(){

        xPos = 400;
        yPos = 200;
    }
// more code
} 
```

在这种情况下，我应该对 Player 类中的 xPos 和 yPos 使用 static 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:39:23.337

不，静态变量是类的成员，您希望位置变量成为对象的成员（非静态）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T00:40:54.177

如果 xPos 和 yPos 是静态的，则 Player 的每个实例都将具有相同的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T00:40:29.673

变量前面的`static`关键字表示所讨论的变量属于“类本身”，而不是单个实例。换句话说，用一个实例改变它会改变所有实例。所以在这种情况下，你不应该做你所要求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T00:41:13.390

不，

`static`作为Java中的关键字意味着该字段是`Class`字段而不是`instance`字段。这些应该用于在类的实例之间使用并且对给定实例没有任何意义的字段。在您的情况下，`xPos`and`yPos`是针对该类的每个实例的。

看看这个[静态教程](http://www.javatutorialhub.com/wiki/All_about_%22static%22)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-02T00:44:26.480

简短的回答是**否定**的。

`static`变量或方法意味着不需要该对象的实例来使用它（例如，我们在创建类的新实例时不会创建`System`）`System.out.println`。也意味着我们每次调用对象的状态都是一致的；也就是说，如果我们在具有静态字段的类中设置某个值，则该值将在该类的*所有*实例中保持一致。

对于`Player`对象的每个实例，每个 x 和 y 位置都是唯一的。你*不想*使用`static`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T00:56:06.107

当您希望其所有引用中的值相同时，您可以使用静态。在您的情况下，我猜您希望`xPos`and`yPos`对不同的玩家有所不同。换句话说，对于您为您想要的 Player 类创建的每个对象`xPos`，`yPos`它们都是不同的。所以你不要将它们声明为静态的。

附加信息：如果您将某个变量声明为静态，则使用它的方法也应声明为静态。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-02T01:45:28.203

不，在这种情况下不要使用静态属性，因为 xPos 和 yPos 是每个 Player 的属性（属性）。创建的每个玩家（实例）都必须有自己的 x 和 y。

`static`关键字用于创建属于类而不是类实例的东西。

例如，如果 xPos 是静态的，您可以调用 Player.xPos 来获取 xPos 的值，而无需类的实例，并且所有 Player 将具有相同的 xPos 和 yPos。

# windows - 如何将指向 Perl 函数的指针作为回调传递给在 Windows DLL 中以指针作为参数的函数？

> ID：10406277
> 
> 赞同：0
> 
> 时间：2012-05-02T00:38:45.680
> 
> 标签：windows, perl, api, callback

### Perl 脚本

```
use Win32::API;  
use Win32::API::Callback;  

my $callback = Win32::API::Callback->new(Perl_Func,"PN", "N");  

 #Import 'C_Func' Function from dll  
my $test = Win32::API->new('dll_test','C_Func','KP','N');  
my $buf = pack('i*', (1, 2, 3));  
 #Calling the C dll Function 'C_Func' with arguments as pointer to 'Perl_Func' and integer array  
my $ret = $test->Call( $callback, $buf);  
print "final value=".$ret."\n"; 
```

### 定义“Perl_Func”

```
sub Perl_Func
{  

        ($a,$b)=@_;  
        print "entered into Perl Function"."\n";  
        print "int variable from dll=".$b."\n";  
        print "array first element from dll=".$a[0]."\n";  **#unable to access the value**  
        $res=$a[0]+$a[1]+$a[2]; **# unable to access the values here** 
        return $res;  
} 
```

### C Dll“dll_test”

```
int __stdcall C_Func( int (*PerlExpFunc)( int *, int ), int *d)  
{  

        int res,c[3]; 
        c[0]=d[0]; c[1]=d[1]; c[2]=d[2];   
        res=PerlExpFunc(c,10);  
        return(res);  
} 
```

所以这里的输出看起来像这样

```
    输入 Perl 函数  
    来自 dll=10 的 int 变量  
    来自 dll 的数组第一个元素 =    
    最终值=0  
```

所以程序正在进入从 dll 调用的“Perl_Func”。但是在这个函数内部，它无法访问从 dll 作为指针传递的数组中的值（`c`在 dll 和`$a`'Perl_Func' 中的变量）。因此，没有显示任何值`$a[0]`，最终值（即 1,2 和 3 的总和）为零。**我想我没有在 Perl 部分正确地从 C 部分传递的指向数组的指针中提取值。**请告诉我这样做的正确方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:55:12.880

您可以使用[Win32::API](http://search.cpan.org/perldoc/Win32%3a%3aAPI)和[Win32::API::Callback](http://search.cpan.org/perldoc/Win32%3a%3aAPI%3a%3aCallback)来做到这一点。如需更多帮助，您将需要提供更多信息。

以下是目前的进展：

### 我的dll.c

```
#include <stdlib.h>
#include <windows.h>

__declspec(dllexport)
int __cdecl C_Func(LONG (*PerlExpFunc)(PLONG, LONG), PLONG c) {
    int result;
    result = PerlExpFunc(c, 10);
    return result;
} 
```

编译使用：

```
C:\Temp> cl mydll.c /LD /Gd /W3
```

### 测试.pl

```
use strict; use warnings;
use Win32::API;
use Win32::API::Callback;
use YAML;

my $C_Func = Win32::API->new('mydll', 'C_Func', 'KP', 'N', '_cdecl');

my $callback = Win32::API::Callback->new(sub {
        my ($x, $y) = @_;
        print Dump \@_;
        return 42;
    }, ['P', 'N'], 'N'
);

my $array = pack 'L*', 0x41, 0x42, 0x43;

my $ret = $C_Func->Call($callback, $array);

print "final value= $ret\n"; 
```

输出是：

```
---
- 一个
- 10
最终值= 42
```

显然，回调正在接收传递给它的数组的第一个元素。所有三个值都使它成为`C_Func`. 我不确定接收端是怎么回事。

## 更新：

这是问题（来自`Win32-API-0.68/Callback/Callback.xs`）。在`PerformCallback`中，我们有：

```
for(i=0; i < nparams; i++) {
    switch(params[i].t) {
    case T_STRUCTURE:
        itoa(i, ikey, 10);
        XPUSHs(sv_2mortal(*(hv_fetch((HV*)SvRV(self), ikey, strlen(ikey), 0))));
        break;
    case T_POINTER:
        XPUSHs(sv_2mortal(newSVpv((char *) params[i].p, 0)));
        break;
    case T_INTEGER:
    case T_NUMBER:
        XPUSHs(sv_2mortal(newSViv((int) params[i].l)));
        break;
    }
} 
```

查看 的情况`T_POINTER`，很清楚为什么我们只返回数组的第一个元素（您可以通过在输出的十六进制转储中传递`0xdeadbeef`和观察来验证这一点）。`efbeadde`

# java - 温度阵列，可能是二维的？

> ID：10406279
> 
> 赞同：1
> 
> 时间：2012-05-02T00:39:11.333
> 
> 标签：java

手头的任务如下：

编写一个程序，使用一个数组来存储五天对象的温度。
每个对象必须封装它的日期名称（例如：星期一，星期二...等）和温度控制程序将显示该周的平均温度。

现在我了解了数组的基本原理以及它们的使用方式，但是我对两件事感到困惑：

```
public class TemperatureAndDay {
    public static void main(String[] args) {

    double [] temperature = new double [4];

    temperature[0] = 45.24;
    temperature[1] = 67.30;
    temperature[2] = 55.23;
    temperature[3] = 49.20;
    temperature[4] = 50.22;

    }
 } 
```

谁能给我一些提示/提示/代码示例，让我更好地理解我的教授想让我做什么？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:43:37.317

根据问题陈述，我认为您应该创建一个`Day`具有数据字段`name`（String）和`temp`（double）的类。然后，您可以将五个这样的对象存储在一个数组中以表示一周，并编写一个循环遍历该数组以确定平均温度的方法。

```
public static double avgTemp(Day[] week) {
    double avg = 0;
    for (Day d : week) avg += d.temp();
    return avg / week.length;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:43:46.120

1.  编写一个包含日期和温度的类（将属性公开或使用 getter 和 setter）。
2.  制作该类的 5 个元素（而不是您的示例中的 4 个）的数组。
3.  遍历数组以计算平均温度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:46:43.120

1.  创建一个名为 Day（或其他）的类。
2.  创建属性：double temperature，String dayName
3.  创建构造函数：Day(String dayName, double temperature)
4.  例如，在其他一些类中，将其命名为 TestProgram，创建一个 Day 对象数组：

例子：

```
Day[] days = new Day[4];
days[0] = new Day("Monday", 22.44);
... 
```

现在清楚了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T00:46:52.900

我同意@m0skit0 并想补充：

不，您的标题状态不需要二维数组。您需要一个像示例代码一样保存测量结果的一维数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T01:02:22.417

> 编写一个程序，使用一个数组来存储五天对象的温度。

我在想你需要一个数组 in `main()`，但别处没有。

> 每个对象都必须封装它的日期名称（例如：星期一、星期二...等）和温度。控制程序将显示该周的平均温度。

所以...简而言之，您需要做什么：

1.  创建类型的对象`TempDay`或您希望调用的任何对象（希望有意义）。
2.  在对象中有当天温度的字段。您可以通过构造函数或修改器以任何方式填充它们。
3.  将这些对象保存在一个数组中`main()`（很可能）。
4.  其余的只是“平均”的原始数学定义。

> 谁能给我一些提示/提示/代码示例，让我更好地理解我的教授想让我做什么？谢谢你。

我希望你能从仅仅分解问题而不是仅仅接收代码中获得更多的理解。代码可以由任何人在任何地方以任何理由编写；*解决以所要求的语言提出的问题*的真正机械过程是您需要得到的。

**编辑：**`ArrayIndexOutOfBoundsException`当您尝试将五个元素放入大小为 4 的数组中时，您 当前的代码也会引发。

# google-app-engine - 使用 Struts 2 在 Google App Engine 中开发控制台

> ID：10406283
> 
> 赞同：1
> 
> 时间：2012-05-02T00:39:26.333
> 
> 标签：google-app-engine, struts2

[我按照http://www.mkyong.com/google-app-engine/google-app-engine-struts-2-example](http://www.mkyong.com/google-app-engine/google-app-engine-struts-2-example)的示例在 Google App Engine 中尝试了 Struts 2

它工作得很好，但我无法访问应该在[http://localhost:8888/_ah/admin中访问的开发控制台](http://localhost:8888/_ah/admin)

和过滤器有关吗？如何修复它？

下面是web.xml的内容

```
<?xml version="1.0" encoding="utf-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">
    <filter>
        <filter-name>struts2</filter-name>
        <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>struts2</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <listener>
        <listener-class>com.mkyong.listener.Struts2ListenerOnGAE</listener-class>
    </listener>
    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>
</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:58:42.590

是的，`<url-pattern>/*</url-pattern>`将所有内容映射到 Struts 过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T09:03:29.000

我通过将下面的代码附加到 struts.xml 来解决它

```
<constant name="struts.action.excludePattern" value="/_ah/admin"/> 
```

# c# - nunit 和 log4net

> ID：10406284
> 
> 赞同：0
> 
> 时间：2012-05-02T00:39:27.673
> 
> 标签：c#, unit-testing, nunit, log4net

我无法使用 nunit 测试我的 log4net 库。我阅读了谷歌返回的搜索结果，但无法理解。

这是我得到的错误。

> System.IO.FileNotFoundException：无法加载文件或程序集“log4net，版本=1.2.10.0，文化=中性，PublicKeyToken=692fbea5521e1304”或其依赖项之一。该系统找不到指定的文件。

在我的 nunit 测试项目中，我添加了对其余项目正在使用的正确 log4net dll 的引用，并添加了配置文件，但没有运气。

我的控制台应用程序和使用 log4net libaray 的测试 Web 应用程序工作正常。

我似乎只有 log4net nunit 测试项目有问题。

如何开始使用涉及 log4net 库的简单 nunit 测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:33:26.400

无论您尝试测试什么，您都应该接受 ILog。然后你应该模拟它并将它传递给你试图测试的任何东西。log4net 的版本根本不重要。你的测试甚至不应该知道 log4net 的存在。

使用 Rhinomocks，这将是：

```
MockRepository mocks = new MockRepository();
ILog mockLog = mocks.DynamicMock<ILog>(); 
```

或者，您可以使用存根：

```
ILog mockLog = MockRepository.GenerateStub<ILog>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T07:39:13.283

检查`Version`您的测试项目和测试引用的项目的 log4net.dll 是否相同（顺便说一句，log4net 的最新版本是 1.2.11.0）。还要验证`Copy Local`是否设置为 true。

如果您涉及 log4net 库，那么这可能是集成测试，而不是单元测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T17:00:10.670

仔细检查您包含的运行时 log4net.dll 文件。看起来它与您项目的 .NET 运行时 CLR 不匹配。检查应用程序的目标 NET 版本（项目 -> 属性），并确保它与 log4net.dll 的目标版本匹配。注意 log4net 的 1.2.11 版本包括最高版本 4.0 的二进制文件，还请注意客户端配置文件版本与完整版本不同，需要它们自己的特定 dll 文件。

# jquery - Jquery Filter（keyup bind..函数）很简单，但它不起作用

> ID：10406293
> 
> 赞同：0
> 
> 时间：2012-05-02T00:40:45.650
> 
> 标签：jquery, html

这是应该隐藏文本输入中不包含匹配值的 li > a 的 Jquery 代码。有一个函数可以检查输入的 keyup 并查看 div(s) 是否存在？匹配值。

然后它应该隐藏输入中没有包含值的那些。

```
<input type="text" id="targety" placeholder="Filter Items..." />
<ul id="ded">
<li><a href="#">Acura</a></li>
<li><a href="#">Audi</a></li>
<li><a href="#">BMW</a></li>
<li><a href="#">Cadillac</a></li>
<li><a href="#">Ferrari</a></li>
</ul>

</div>

<script>
$('#targety').bind('keyup', function() { 
if($("#targety").val() == ""){
$("#ded > li > a").show();
}else{

$("#ded > li > a:visible:not(:contains('"+$("#targety").val()+"')").hide("fast");
}

 } );
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:57:38.427

我让它按如下方式工作：

```
$(function(){
    var $targety = $("#targety"),
        $anchors = $("#ded >li a");
    $targety.on('keyup', function() {
        var val = $targety.val();
        $anchors.show();
        if (val !== "") {
            var pattern = new RegExp('^' + val, 'i');
            $anchors.not(function(index) {
                return $(this).text().match(pattern);
            }).hide();
        }
    });
}); 
```

见[小提琴](http://jsfiddle.net/PR8ZB/)

笔记：

*   Keyup 处理程序的效率很重要。它的效率是我能做到的。特别是，其中没有创建任何 jQuery 对象。
*   可以通过使用`.toLowerCase()`and`.indexOf()`来避免 RegExp。（是[的，它更快](http://jsfiddle.net/PR8ZB/1/)）
*   我放弃了`:visible`，并`hide("fast")`赞成`hide()`使代码完全同步。否则，打字速度可能（并且很可能会）破坏原始逻辑。
*   无条件`.show()`允许在逐步删除输入字符串时重新显示元素。

编辑：

*更正*-`.not()`返回一个新的 jQuery 对象，所以我的第一个注释的最后一句话不正确。但是，`$anchors.not(...)`它将比 $(...) 更有效，后者将从整个 DOM 作为其基线工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:45:03.837

看起来您只是在选择器中缺少括号：

```
... :contains('" + $("#targety").val() + "'))") ...
                                            ^ 
```

顺便说一句，您可以在回调中使用`this`而不是使用。`"#targety"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:44:40.933

需要注意的一件事是“：contains”区分大小写您可以在此处找到解决“未来”问题的功能：[https ://stackoverflow.com/a/2196683/1220302](https://stackoverflow.com/a/2196683/1220302)

至于你的代码，我建议你在输入框上设置一个最小长度。这是一个例子 - 这对于学习来说有点冗长。如您所见，我也隐藏了“父”“li”。

```
<script type="text/javascript">
    $(document).ready(function () {
        var $container = $("#ded"); //Set the container
        $('#targety').bind('keyup', function () {
            var value = $(this).val();
            if (value.length >= 3) {
                var filter = "> li a:visible:not(:contains('" + value + "'))";
                console.log("Found: " + $(filter).length); console.log(filter); //Debug logging - remove 
                $(filter, $container).hide("fast").parent().hide("fast"); //hide "a" and "li"
            } else {
                $("> li > a", $container).show().parent().show();//show"a" and "
            }
        });
    });
</script> 
```

# actionscript-3 - 获取组中的所有元素

> ID：10406294
> 
> 赞同：0
> 
> 时间：2012-05-02T00:40:51.027
> 
> 标签：actionscript-3, apache-flex, flex4.5, getelementbyid

在此示例中如何访问 TextInput 值？

我正在使用 Flex 4.5

```
<s:VGroup id="qItems" width="100%" styleName="qMain">
  <s:HGroup id="id_1"><s:TextInput id="total_1" width="100" text="1.00"/></s:HGroup>
  <s:HGroup id="id_2"><s:TextInput id="total_2" width="100" text="1.00"/></s:HGroup>
  <s:HGroup id="id_3"><s:TextInput id="total_3" width="100" text="1.00"/></s:HGroup>
</s:VGroup> 
```

我只能访问 HGroup id，但我不知道如何深入 TextInput 以添加总文本的值。

这是我用来访问 HGroups 的功能

```
protected function viewElements(event:MouseEvent):void{
  var messageText:String = "There are " + qItems.numElements + " elements in the MX Panel.";

  for (var i:int = 0; i < qItems.numElements; i++)
  {
    var stringName:String = qItems.getElementAt(i) + "";
    if (stringName.indexOf(".") > 1)
    {
      stringName = stringName.substr(stringName.lastIndexOf(".")+1, stringName.length);
    }
    messageText += "\n" + (i+1) + ". " + stringName;
  }
  Alert.show(messageText, "Show Elements", Alert.OK);
} 
```

谢谢，罗伯特

+++++++++++++++++++++++++++++++++++++++++++++++++

多姆，非常感谢。那效果很好。现在我正在尝试添加这些值，但我使用此函数得到了 NaN 结果

```
protected function viewElements(event:MouseEvent):void{
  var totalField:Number;
  var sum:Number;
  for (var i:int = 0; i < qItems.numElements; i++)
  {
    var parentGroup:Object = qItems.getElementAt(i);
    for (var j:int = 0; j < parentGroup.numElements; j++) 
    {
      var childGroup:Object = parentGroup.getElementAt(j);
      totalField = childGroup.getElementAt(4).text;
    }
    sum += totalField;
  }
  Alert.show(sum.toFixed(2).toString());
} 
```

你能帮我解决这个问题吗？再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T09:58:40.567

只需添加另一个 for 循环就可以了

```
for (var i:int = 0; i < qItems.numElements; i++)
{
    var currentGroup:Object = qItems.getElementAt(i);

    for(var j:int = 0; j < currentGroup.numElements; j++)
    {
        Alert.show(currentGroup.getElementAt(j).text);
    }
} 
```

# jquery - bootstrap 2.0通过标签内容中的url激活标签和数据

> ID：10406297
> 
> 赞同：1
> 
> 时间：2012-05-02T00:41:03.673
> 
> 标签：jquery, html, css, twitter-bootstrap

我已经看到了很多涉及这个主题的问题，我确切地知道需要做什么，但我对 jQuery 并不“流利”，因此，我无法成功地做到这一点。

```
 <ul class="nav nav-pills" id="activate">
    <li><a href="#tab1" data-toggle="tab">Tab 1</a></li>
    <li class="active"><a href="#tab2" data-toggle="tab">Tab 2</a></li>
 </ul>

 <div class="tab-content">
     <div id="tab1"><h1>Data for Tab 1</h2></div>
     <div id="tab2">
         <a href="#tab1" rel="taburl" data-toggle="tab">Take me to tab content #1</a>
     </div> 
```

理想情况下，该选项卡的数据切换到#tab1，但是，该选项卡不会切换到`active`类`href="#tab1"`（保持活动状态`#tab2`但显示来自 的数据`#tab1`）

我想我可以使用该`.first()`方法并将第一次出现的`href="#tab1`and定位`.addClass('active')`到这个 li。但我不知道如何为我链接到它的任何链接选择 li 以直接定位该`href`ID

我真的不知道这是否可以做到。我可以`href`从链接中注入数据（使用 jQuery），然后将其添加到选项卡链接并使其处于活动状态。

再次，`data-toggle="tab"`切换到正确的内容，但不会更新导航栏上的活动选项卡，

那么有没有办法选择那个确切的“标签”并`.addClass('active')`在`<li>`我触发链接时选择。

感谢您的时间。

## JSFIDDLE 示例

[http://jsfiddle.net/epiceon/M6NQJ/1/](http://jsfiddle.net/epiceon/M6NQJ/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T13:55:18.733

如果您在这样的选项卡之间切换，您将需要`tab('show')`在您希望该按钮转到的选项卡上再次调用。

附带说明一下，如果您使用选项卡，您应该考虑将您的版本更新到 2.0.3。他们修复了一些错误（主要是左侧或右侧的选项卡），但即使放入新的 navs.less 文件也可能会让您在路上头疼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T07:40:02.983

我在尝试手动关闭标签时遇到了类似的情况。

这是工作的jsFiddle：

[http://jsfiddle.net/WnQvF/8/](http://jsfiddle.net/WnQvF/8/)

请注意，我只是从我的项目中复制粘贴。因此，对于您的问题，该解决方案可能不是最干净的，但您将了解它是如何工作的。请记住在选项卡 3 中命名选项卡按钮和按钮。

# javascript - jQuery indexOf 函数？

> ID：10406300
> 
> 赞同：10
> 
> 时间：2012-05-02T00:41:12.877
> 
> 标签：javascript, jquery

我正在尝试获取 jQuery 集中元素的位置。

**[这是我到目前为止所尝试的。](http://jsfiddle.net/xz9dW/)**

我希望能够做这样的事情：

```
$('ul').find('a').indexOf('.active'); 
```

并获取's`.active`集合中的位置。`a`

有没有类似`indexOf()`jQuery 的函数？该`index()`方法不起作用

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T00:57:07.137

如果您将 jQuery set ( `$searchFor`) 作为参数传递给`index`另一个 jQuery set ( `$searchIn`) 的方法，即

```
$searchIn.index($searchFor) 
```

它将返回`$searchFor`集合中的索引`$searchIn`

在您的示例中：

```
$('ul a').index($('ul a.active')); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:30:29.417

你只需要给`index`函数一个 jQuery 对象：

```
var elements = $('ul a'); 
var index = elements.index(elements.filter('.active')); // 2

alert(index); 
```

[**现场演示**](http://jsfiddle.net/gdoron/xz9dW/18/) ​</p>

* * *

~~开箱即用没有这样的功能~~，可以像这样轻松完成：

```
var index = -1;
$('ul a').each(function(i){
    if ($(this).hasClass('active')){
        index = i;
        return false;
    }
});

alert(index); 
```

[**现场演示**](http://jsfiddle.net/gdoron/xz9dW/17/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T05:53:31.737

你的逻辑是合理的，你只是抓住了错误的元素：http: [//jsfiddle.net/xz9dW/19/](http://jsfiddle.net/xz9dW/19/)

```
var index = $('ul a.active').closest('li').index(); 
```

该`a`链接没有`index()`价值，因为它没有兄弟姐妹；你必须抓住`li`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-02T00:44:12.117

[您可以通过在选择器](http://api.jquery.com/category/selectors/)中询问它来做到这一点：

```
 $('ul a.active') 
```

但是，获取位置是什么意思？你是说位置吗？或网址？

如果你想知道你`click`在哪一个可以说..你会`$(this)`在你的事件函数中使用。这是一个示例，如果该类有多个，则返回您单击的元素的当前位置`.active`：

要获得职位：

```
 $('ul a.active').click(function(){
     alert( $(this).position() );
 }) 
```

要获取 URL 位置：

```
 $('ul a.active').click(function(){
     alert( $(this).attr('href') );
 }) 
```

# css - 页面忽略样式表但在标题中读取相同的样式

> ID：10406306
> 
> 赞同：0
> 
> 时间：2012-05-02T00:42:08.857
> 
> 标签：css

此页面没有从样式表中获取表格样式。如果我在页面本身中放置相同的样式，它们就会被应用。什么可能导致这种情况？css文件名正确，被其他页面读取。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Pagelinks | Known Issues</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>  

<link rel="stylesheet" type="text/css" href="pagelinks_windows.css" />

<!-- style>
#known_issues th, #known_issues td {
    font-size: 13px;
    text-align: left;
}

</style -->

</head>
<body>
<h1>Known Issues</h1>

<p>
Known bugs and issues are listed here.</p>

<table id="known_issues">
<tr><th>Tracking No.</th><th>Category</th><th>Description</th><th>Status</th><th>Workaround</th></tr>
<tr><td>plt001</td><td>Site</td><td>Site navigation broken on Internet Explorer 8</td><td>Closed</td><td>None. That browser version has a major bug involving javascript objects. Users must upgrade to Internet Explorer 9.</td></tr>
<tr><td>plt002</td><td>Site</td><td>Saints and feasts do now show description</td><td>Open</td><td>None. The description data for the Saints and the feasts is being compiled.</td></tr>
</table>
<br/>
<br/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:47:57.727

测试css文件的内容是否可见。尝试在浏览器中打开它。

当文件名中的字母大小写（A\a 等）不同时，常见的可能错误 - 这在 *nix 托管服务器上不起作用，即使它在 Windows 上本地工作。

另一种常见情况：从当前文件目录到文件的路径何时出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T03:00:24.567

您的样式表是否与此`html`文件位于同一根目录中？常见的做法是将样式表、js、includes 等放到不同的目录中。也许您遵循此约定而只是忘记了`href="css/pagelinks_windows.css"`？如果没有更多信息，很难找到问题的答案，但这通常是您遗漏的一些小东西。一旦你找到它，你就会得到一个前额耳光:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:25:34.767

你的样式表是什么样的？我认为您可能有一些冲突的 css，请尝试在 pagelinks_windows.css 的最底部添加您的表格样式

# iis - IIS 重定向文件

> ID：10406308
> 
> 赞同：0
> 
> 时间：2012-05-02T00:42:26.300
> 
> 标签：iis, asp-classic

IIS 带有 asp 文件，可以根据请求是本地的还是外部的来帮助重定向请求。认为我将这些保存在另一个位置，我从包含我的网站的文件夹中删除了它们。有谁知道在哪里可以得到它们或如何让它们回来？我已经尝试再次运行安装，但这似乎没有做任何事情。这些文件的名称与本地和外部有关；我不记得确切的名字。

# api - 甚至为网站本身使用网站的 API？

> ID：10406310
> 
> 赞同：3
> 
> 时间：2012-05-02T00:42:35.243
> 
> 标签：api, rest, soap

这个问题在我脑海里已经有一段时间了。

假设我有一个 PHP 网站，它有一个 API（SOAP、REST 等），而这个 API 提供的内容几乎与页面中可用的内容相同（*例如*博客文章、评论、统计信息等）。

为了避免代码冗余/重复，我正在考虑对站点本身使用 API，因为尽管大多数代码分解已经通过使用 MVC 模型完成，但如果站点必须提供 API，某些逻辑仍然是双重的.

## 访问者检索给定博客帖子的示例：

### 经典图形用户界面：

1.  HTTP 请求：由浏览器发送
2.  PHP 控制器：读取用户输入
3.  PHP模型：从数据库中获取帖子
4.  PHP 控制器：填充视图
5.  PHP 视图：呈现 HTML
6.  HTTP 响应：发送到浏览器

### 使用 API 的图形用户界面：

1.  HTTP 请求：由浏览器发送
2.  PHP“帖子”控制器：读取用户输入
3.  HTTP API 请求：由 PHP 控制器发送到站点的 API URL
4.  PHP“api”控制器：读取 API 请求
5.  PHP模型：从数据库中获取帖子
6.  PHP“api”控制器：填充“api”视图
7.  PHP“api”视图：渲染（XML、JSON 等）
8.  HTTP API 响应：发送到第 2 点的 PHP 控制器。
9.  PHP 控制器：填充视图
10.  PHP 视图：呈现 HTML
11.  HTTP 响应：发送到浏览器

我的观点是 GUI**应该**是一个消耗 API 的层（一个新层），但我担心性能问题，因为在 PHP 网站中，API 调用通过 HTTP 请求需要时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:10:54.283

通常，您不希望服务器对其自身进行类似的“内部”调用。相反，让初始 HTML 包含驱动交互的 Javascript：

1.  GUI 的 HTTP 请求：由浏览器发送
2.  HTTP 响应：静态 HTML（大量缓存）

3.  HTTP API 请求：通过 AJAX 发送到站点的 API URL

4.  PHP“api”控制器：读取 API 请求
5.  PHP模型：从数据库中获取帖子
6.  PHP“api”控制器：将“api”视图填充为 JSON
7.  HTTP API 响应：发送到第 3 点的浏览器。

8.  Javascript：改变 DOM

“额外”调用需要时间，但 RESTful 架构努力通过缓存（通常导致根本没有网络活动）与分块一样优化用户感知性能。有关更多分析，请参阅[我以前的答案。](https://stackoverflow.com/questions/4409877/url-design-for-an-api/4411929#4411929)

# ruby-on-rails - 在其他视图中查看

> ID：10406314
> 
> 赞同：0
> 
> 时间：2012-05-02T00:43:01.137
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

在 Rails 应用程序中，我有一个视图 index.html.erb 和一个控制器 posts_controller.rb。在控制器中，我定义了一个变量：

```
def index
@posts = TableName.find... 
```

在我看来，我有：

```
<% @posts.each do |post| %> 
```

如果我通过 localhost/posts/index 访问它，它工作正常。但我真正想要的是在其他视图中显示这个视图，所以我正在使用`<%= render :template => 'posts/index' %>`，但我收到这个错误消息：“NoMethodError - 你有一个 nil 对象，但你没想到它！你可能期望一个 Array 的实例。评估 nil.each 时发生错误”

我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:04:58.733

当您尝试调用未定义对象的方法时，会触发 NoMethodError。换句话说，您在其他视图中呈现帖子/索引，但 @posts 实例变量未在其他视图中定义。渲染模板不路由控制器。

# git - 如何在 Git 中“退出”功能分支合并？

> ID：10406315
> 
> 赞同：7
> 
> 时间：2012-05-02T00:43:33.057
> 
> 标签：git

我对 Git 比较陌生，我想知道这样做是否正确，以及是否有其他方法可以删除合并到主分支的功能分支。让我用一个例子来解释：

让我们假设我们正在处理三张票（错误/增强功能），并且每张票有三个功能分支，每个都从标签 v2.0.21 分支出来。在对每张工单进行开发工作并经过充分的测试后，我们将其合并到主分支并将此分支标记为 v2.0.22 并将其发布到生产环境。

在产品发布之后，假设我们发现其中一张票 (Ticket2) 失败，应该删除。这就是我的想法，我想知道这是否是删除与 Ticket2 关联的提交的好方法。

比如说，

1.  从 v2.0.21 创建一个新分支
2.  在这个新分支上合并 Ticket1 (Branch1) 和 Ticket3 (Branch3)
3.  强制将新分支推送到 master。
4.  标记master为V2.0.23
5.  将代码从 v2.0.23 发布到生产环境。

我希望有人可以帮助我验证这种方法，并提出更好的方法来删除已经合并到 master 的功能分支。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-02T00:50:56.680

如果您的合并创建了一个“合并提交”，由于这个原因，这通常是一个好主意，那么您可以使用[`git revert`](http://schacon.github.com/git/git-revert.html)带有该分支的合并提交的提交 ID 的命令来反转来自特定功能分支的更改。

Git 文档包含有关[如何恢复错误合并](https://github.com/git/git/blob/master/Documentation/howto/revert-a-faulty-merge.txt)的详细说明，其中包含您可能会发现有用的更多信息。

# ruby - 需要一个简单、干燥、通用的检查点机制

> ID：10406329
> 
> 赞同：0
> 
> 时间：2012-05-02T00:45:03.543
> 
> 标签：ruby, ruby-on-rails-3, checkpoint

背景：我正在做的许多操作都需要长时间的网络访问。有时 Web 访问失败，需要重新启动该过程。从头开始重新启动过程很痛苦。

因此，我编写了许多用于检查点的临时方法：当您重新启动进程时，它会查看检查点数据是否可用并从中重新初始化状态，否则它会创建新状态。在操作过程中，进程会定期将检查点数据写入某处（写入文件或数据库）。完成后，它会清理检查点数据。

我想要一个简单、干燥、通用的检查点机制。你会怎么写？还是有一个模块已经这样做了？（虽然这还不是问题，但线程安全实现会获得额外的星星！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:02:39.300

你本质上描述的是一个[状态机](http://en.wikipedia.org/wiki/Finite-state_machine)。Web 服务是无状态的，但是当您在服务器端提供更新时，状态会更新，充当“检查点”，因此可以在事务或“Web 访问”之间持久保存，如您所说.

如果您以前从未使用过状态机，这可能有点学习曲线，但您可以查看[此页面](https://www.ruby-toolbox.com/projects/aasm)，提供“检查点”或“状态”宝石列表。[AASM](http://rubygems.org/gems/aasm)可能会起作用，并且正在积极开发中，但根据您需要多少功能，您可能会查看屏幕右侧的替代列表，以了解最适合您的选项。

我知道 aasm 的一种生产用途是通过多步骤过程自动保存一个人的进度，允许他们下车、断开连接或稍后再回来完成它。流程中的步骤必须以某种顺序完成，并且在大多数情况下都有定义的“完成”状态。[AASM](http://rubygems.org/gems/aasm)应该能够为您处理这些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T05:06:59.917

在仔细考虑之后，我决定我愿意将它专门用于 ActiveRecord。通过利用 ruby​​ 的`ensure`功能以及 ActiveRecord 中的`destroyed?`和`changed?`方法，设计变得简单：

## 使用 :name 和 :state 定义检查点模型

```
# file db/migrate/xyzzy_create_checkpoints.rb
class CreateCheckpoints < ActiveRecord::Migration
  def change
    create_table :checkpoints do |t|
      t.string :name
      t.string :state
    end
    add_index :checkpoints, :name, :unique => true
  end 
end

# file app/models/checkpoint.rb
class Checkpoint < ActiveRecord::Base
  serialize :state
end 
```

## 定义 WithCheckpoint 模块

```
# file lib/with_checkpoint.rb
module WithCheckpoint

  def with_checkpoint(name, initial_state, &body)
    r = Checkpoint.where(:name => name)
    # fetch existing or create fresh checkpoint
    checkpoint = r.exists? ? r.first : r.new(:state => initial_state)
    begin
      yield(checkpoint)
    ensure
      # upon leaving the body, save the checkpoint iff needed
      checkpoint.save if (!(checkpoint.destroyed?) && checkpoint.changed?)
    end
  end
end 
```

## 样品使用

这是一个有些人为的例子，在经过一定次数的迭代后随机爆炸。更常见的情况可能是冗长的网络或文件访问可能随时失败。注意：我们将状态存储在一个数组中只是为了表明“状态”不必是一个简单的整数。

```
class TestCheck
  extend WithCheckpoint

  def self.do_it
    with_checkpoint(:fred, [0]) {|ckp|
      puts("intial state = #{ckp.state}")
      while (ckp.state[0] < 200) do
        raise RuntimeError if rand > 0.99
        ckp.state = [ckp.state[0]+1]
      end
      puts("completed normally, deleting checkpoint")
      ckp.delete
    }
  end

end 
```

当您运行 TestCheck.do_it 时，它可能会在一些迭代后随机爆炸。但是您可以重新启动它，直到它正确完成：

```
>> TestCheck.do_it
intial state = [0]
RuntimeError: RuntimeError
        from sketches/checkpoint.rb:40:in `block in do_it'
        from sketches/checkpoint.rb:22:in `with_checkpoint'
        ...
>> TestCheck.do_it
intial state = [122]
completed normally, deleting checkpoint
=> #<Checkpoint id: 3, name: "fred", state: [200]> 
```

# php - 多次保存上传加上保存数据库错误

> ID：10406332
> 
> 赞同：-1
> 
> 时间：2012-05-02T00:45:40.467
> 
> 标签：php

我有一系列问题，当多次保存数据库时，您是否遇到过一些问题？我的问题是，我有一个名为“album”的数据库，其中字段是“album_id，album_title，album_user”。

html 输出将有一个登录部分，其中有一个输入类型文件，您希望在其中添加更多内容，并且一旦您上传了它。并且将存储一组名称的数组，并且该数组将成为我们以多种格式保存文件的问题。它说数据库上的错误是两次指定的sql。你知道如何使用php保存多个吗？

代码将是这样的。

```
 <?php
class Album extends olib{

    function __construct(){
        parent::olib();
    }       

    function upload_submit() {
        $allow = array("jpg","png","gif");
        $directory = "upload";
        $pictures = array();
        $counter = 0;
        $error = '';
        if($this->jpost('upload')) {
            for($getupload = 0;$getupload<count($_FILES['uploadpictures']['name']);$getupload++){           
                $extension = end(explode(".",$_FILES['uploadpictures']['name'][$getupload]));
                if(in_array(strtolower($extension),$allow)){
                    if(move_uploaded_file($_FILES['uploadpictures']['tmp_name'][$getupload],$directory."/".$_FILES['uploadpictures']['name'][$getupload])){
                        $pictures[$getupload] = $_FILES['uploadpictures']['name'][$getupload];
                        $counter++;
                    //  $this->save_user_album($_FILES['uploadpictures']['name'][$getupload],$this->setSession('user_id'));
                    }else{
                        $error[$getupload] = "Sorry seems some of the data invalid";
                    }
                }else{
                    $error = '1';
                }
            }       
            print_r($pictures);
            print_r($error);
            foreach($pictures as $urpics){
                $this->save_user_album($urpics,$this->setSession('user_id'));
            }
        }
    }

    function save_user_album($albumtitle,$session){
        $_firewall = ($this->setSession('user_id') !=="") ? $this->setSession('user_id') : "";  
            $this->jfields('album_pics_title',$albumtitle);
        //  $this->jfields('album_pics_user',$session);
        return $this->jSave('album_pics');
    }

} 
```

任何回应将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T00:42:23.550

嗨我很抱歉似乎我有一个解决方案我在保存后取消设置.. `unset($this->jfields);`问题已经解决

# java - 流式传输 7-zip 存档中的文件

> ID：10406336
> 
> 赞同：1
> 
> 时间：2012-05-02T00:46:20.037
> 
> 标签：java, python, compression, 7zip

我想编写一个 Python 或 Java 应用程序来遍历 7-zip (.7z) 存档中的所有许多小文件。是否有一种方便的方法可以以流式传输和高效的方式执行此操作，即无需重复运行`7z`以提取单个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:07:28.767

[您是否考虑过像pylzma](http://www.joachim-bauch.de/projects/pylzma/)这样的第三方库？它包括一个用于读取和写入 7-zip 档案的[模块。](https://github.com/fancycode/pylzma/blob/master/py7zlib.py)

# android - 触摸外部后避免弹出窗口关闭

> ID：10406339
> 
> 赞同：17
> 
> 时间：2012-05-02T00:46:45.533
> 
> 标签：android

我想使用具有以下行为/功能的 PopupWindow：

*   它是可聚焦的（例如按钮内部有交互式控件）
*   View 'under' popupwindow 必须正确消耗弹出窗口之外的触摸
*   ..但即使在外面点击后，弹出窗口也必须留在屏幕上

我发现了一堆关于 PopupWindow 的帖子，但没有人问过如何处理这种情况。

我想我尝试了 setOutsideTouchable()、setFocusable()、setTouchable() 的所有可能组合，但我被卡住了。弹出窗口可以正确处理点击它，但在触摸外部时它总是被解雇。

我当前的代码是：

```
View.OnTouchListener customPopUpTouchListenr = new View.OnTouchListener(){

    @Override
    public boolean onTouch(View arg0, MotionEvent arg1) {
        Log.d("POPUP", "Touch false");
        return false;
    }

};

LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
LinearLayout layout= (LinearLayout)inflater.inflate(R.layout.insert_point_dialog, null);
PopupWindow pw = new PopupWindow(layout,400,200,true);
pw.setOutsideTouchable(true);
pw.setTouchable(true);
pw.setBackgroundDrawable(new BitmapDrawable());
pw.setTouchInterceptor(customPopUpTouchListenr);
pw.showAtLocation(frameLayout, Gravity.BOTTOM, 0, 0); 
```

我的总体目标是创建一个浮动窗口，其行为类似于 gimp 等软件中的“工具调色板”：内部有一些控件，保持在顶部直到被“X”按钮关闭，并允许与外部控件交互。也许有一些更好的方法可以做到这一点，而不是 PopupWindow？但是我还没有找到更合适的控件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2019-04-10T01:05:08.240

这里或其他地方没有任何建议似乎对我有用。所以我这样做了：

```
popupWindow.setTouchInterceptor(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View view, MotionEvent motionEvent) {
                if (motionEvent.getX() < 0 || motionEvent.getX() > viewWidth) return true;
                if (motionEvent.getY() < 0 || motionEvent.getY() > viewHight) return true;

                return false;
            }
        }); 
```

如果触摸在 popupWIdow 的范围内，则不消耗触摸事件（因此按钮或滚动视图将起作用）。如果触摸超出范围，则触摸被消耗并且不会传递给 popupWindow，因此不会被关闭。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-10T12:40:34.010

为时已晚，但对于谷歌这些东西的人来说只是改变行的顺序

```
pw.showAtLocation(frameLayout, Gravity.BOTTOM, 0, 0);
pw.setOutsideTouchable(true);
pw.setTouchable(true);
pw.setBackgroundDrawable(new BitmapDrawable());
pw.setTouchInterceptor(customPopUpTouchListenr); 
```

代替

```
pw.setOutsideTouchable(true);
pw.setTouchable(true);
pw.setBackgroundDrawable(new BitmapDrawable());
pw.setTouchInterceptor(customPopUpTouchListenr);
pw.showAtLocation(frameLayout, Gravity.BOTTOM, 0, 0); 
```

在 showatlocation 方法之后放置任何东西都会让它像什么都没有

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-09T06:09:25.593

只需删除`pw.setBackgroundDrawable(new BitmapDrawable());`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-02T02:46:41.623

pw.setOutsideTouchable(false);

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-04T08:41:39.667

尝试

```
pw.setBackgroundDrawable(null); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-13T08:36:30.100

解决方案是：

popupWindow.setFocusable(true);

popupWindow.update();

感谢： [http ://android-er.blogspot.ch/2012/04/disable-outside-popupwindow-by.html](http://android-er.blogspot.ch/2012/04/disable-outside-popupwindow-by.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-02T02:35:35.100

首先，您必须弄清楚为什么当您触摸外部时弹出窗口会被关闭。

看完PopupWindow的源码和资源文件styles.xml，

```
<style name="Widget.PopupWindow">
    <item name="popupBackground">@drawable/editbox_dropdown_background_dark</item>
    <item name="popupAnimationStyle">@style/Animation.PopupWindow</item>
</style>
 <style name="Widget">
    <item name="textAppearance">?textAppearance</item>
</style> 
```

所以没有什么像对话框主题：

```
<style name="Theme.Dialog">
<item name="windowCloseOnTouchOutside">@bool/config_closeDialogWhenTouchOutside</item>
</style name="Theme.Dialog"> 
```

但是当调用 PopupWindow.setBackgroundDrawable() 时会发生一些事情，

```
private void preparePopup(WindowManager.LayoutParams p) {
    if (mContentView == null || mContext == null || mWindowManager == null) {
        throw new IllegalStateException("You must specify a valid content view by "
                + "calling setContentView() before attempting to show the popup.");
    }

    if (mBackground != null) {
        final ViewGroup.LayoutParams layoutParams = mContentView.getLayoutParams();
        int height = ViewGroup.LayoutParams.MATCH_PARENT;
        if (layoutParams != null &&
                layoutParams.height == ViewGroup.LayoutParams.WRAP_CONTENT) {
            height = ViewGroup.LayoutParams.WRAP_CONTENT;
        }

        // when a background is available, we embed the content view
        // within another view that owns the background drawable
        PopupViewContainer popupViewContainer = new PopupViewContainer(mContext);
        PopupViewContainer.LayoutParams listParams = new PopupViewContainer.LayoutParams(
                ViewGroup.LayoutParams.MATCH_PARENT, height
        );
        popupViewContainer.setBackgroundDrawable(mBackground);
        popupViewContainer.addView(mContentView, listParams);

        mPopupView = popupViewContainer;
    } else {
        mPopupView = mContentView;
    }
    mPopupViewInitialLayoutDirectionInherited =
            (mPopupView.getRawLayoutDirection() == View.LAYOUT_DIRECTION_INHERIT);
    mPopupWidth = p.width;
    mPopupHeight = p.height;
} 
```

创建了一个容器视图“PopupViewContainer”。

```
 private class PopupViewContainer extends FrameLayout {
    private static final String TAG = "PopupWindow.PopupViewContainer";

    public PopupViewContainer(Context context) {
        super(context);
    }

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        if (mTouchInterceptor != null && mTouchInterceptor.onTouch(this, ev)) {
            return true;
        }
        return super.dispatchTouchEvent(ev);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        final int x = (int) event.getX();
        final int y = (int) event.getY();

        if ((event.getAction() == MotionEvent.ACTION_DOWN)
                && ((x < 0) || (x >= getWidth()) || (y < 0) || (y >= getHeight()))) {
            dismiss();
            return true;
        } else if (event.getAction() == MotionEvent.ACTION_OUTSIDE) {
            dismiss();
            return true;
        } else {
            return super.onTouchEvent(event);
        }
    } 
```

}

现在你知道重要的原因了。因此，有两种方法可以避免在触摸外部后关闭 PopupWindow。1.就像@Raaga 所做的那样。删除 pw.setBackgroundDrawable(new BitmapDrawable());

2.  您可以实现一个 OnTouchListener 来过滤 PopupWindow 之外的触摸事件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-01-04T05:15:17.570

有一个非常规的解决方案：重写`dismiss`来阻止它调用`super.dismiss`，然后创建一个自定义方法来控制dismiss，这里是示例代码：

```
class XXXPopupWindow(
    val context: Context
) : PopupWindow() {

    init {
        //some your own logic initialization
        isOutsideTouchable = true
        isTouchable = true
        isFocusable = false
    }

    override fun dismiss() {
        //avoid click outside will dismiss this, use close when want to dismiss this
    }

    fun close(){
        super.dismiss()
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-26T21:39:29.387

可以为 PopupWindow 设置焦点（假）

按钮仍然可以点击，但没有视觉点击行为（一些自定义处理程序强制显示点击？）

下面是带有“始终在顶部”选项的浮动窗口的示例

浮动窗口附近的原始布局在这两种情况下都是完全可操作的，此外，当窗口仍处于浮动状态时，可以使用对话框和其他弹出窗口

窗户也是可重复使用的

```
final static int buttonAlpha = 0xDF;
final static float buttonTextSize = 12f;

public final void addPopupButton(LinearLayout linearLayout, String title, android.view.View.OnClickListener onClickListener)
{
    Button button = new Button(this.getContext());
    button.setText(title);
    button.setTextSize(buttonTextSize);
    button.getBackground().setAlpha(buttonAlpha);
    button.setOnClickListener(onClickListener);
    linearLayout.addView(button, LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
}

public final Button addPopupCheckbox(LinearLayout linearLayout, String title, boolean isChecked, android.view.View.OnClickListener onClickListener)
{
    final Button button = new Button(getContext());
    button.setText(title);
    button.setTextSize(buttonTextSize);
    final int buttonHeight = button.getHeight();
    setButtonChecked(button, isChecked);
    button.setHeight(buttonHeight);
    button.getBackground().setAlpha(buttonAlpha);
    button.setOnClickListener(onClickListener);
    linearLayout.addView(button, LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
    return button;
}

public final void setButtonChecked(Button button, boolean isChecked)
{
    button.setCompoundDrawablesWithIntrinsicBounds(Resources.getSystem().getIdentifier(isChecked ? "android:drawable/btn_check_on" : "android:drawable/btn_check_off", null, null), 0, 0, 0);
}

private boolean isMenuAlwaysOnTop = true;
private PopupWindow popupWindowMenuV2 = null;

public final void popupMenuNav2()
{
    if (popupWindowMenuV2 == null)
    {
        // [start] layout

        ScrollView scrollView = new ScrollView(this.getContext());

        final LinearLayout linearLayoutNavigation = new LinearLayout(this.getContext());
        linearLayoutNavigation.setOrientation(LinearLayout.VERTICAL);
        linearLayoutNavigation.setBackgroundColor(0x7FFFFFFF);
        linearLayoutNavigation.setPadding(20, 10, 20, 10);

        scrollView.addView(linearLayoutNavigation, LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);

        popupWindowMenuV2 = new PopupWindow(this);
        popupWindowMenuV2.setBackgroundDrawable(new BitmapDrawable());
        popupWindowMenuV2.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);
        popupWindowMenuV2.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);
        popupWindowMenuV2.setTouchable(true);
        popupWindowMenuV2.setOutsideTouchable(!isMenuAlwaysOnTop);
        popupWindowMenuV2.setFocusable(!isMenuAlwaysOnTop);
        popupWindowMenuV2.setTouchInterceptor(new OnTouchListener()
        {
            @Override
            public boolean onTouch(View v, MotionEvent event)
            {
                if ((event.getAction() & MotionEvent.ACTION_MASK) == MotionEvent.ACTION_OUTSIDE)
                {
                    if (!isMenuAlwaysOnTop)
                        popupWindowMenuV2.dismiss();
                    else
                        return false;
                    return true;
                }
                return false;
            }
        });
        popupWindowMenuV2.setContentView(scrollView);

        // [end] layout

        // [start] always on top checkbox

        final Button buttonMenuAlwaysOnTop = addPopupCheckbox(linearLayoutNavigation, "always on top", isMenuAlwaysOnTop, null);
        buttonMenuAlwaysOnTop.setOnClickListener(
                new OnClickListener()
                {
                    @Override
                    public void onClick(View vv)
                    {
                        isMenuAlwaysOnTop = !isMenuAlwaysOnTop;
                        setButtonChecked(buttonMenuAlwaysOnTop, isMenuAlwaysOnTop);
                        popupWindowMenuV2.dismiss();
                        popupWindowMenuV2.setOutsideTouchable(!isMenuAlwaysOnTop);
                        popupWindowMenuV2.setFocusable(!isMenuAlwaysOnTop);
                        popupWindowMenuV2.showAtLocation(((Activity) getContext()).getWindow().getDecorView(), Gravity.CENTER_VERTICAL + Gravity.RIGHT, 0, 0);
                    }
                });

        // [end] always on top checkbox

        addPopupButton(linearLayoutNavigation, "some button",
                new OnClickListener()
                {
                    @Override
                    public void onClick(View vv)
                    {
                        if (!isMenuAlwaysOnTop)
                            popupWindowMenuV2.dismiss();
                        someAction();
                    }
                });

    }

    popupWindowMenuV2.showAtLocation(((Activity) getContext()).getWindow().getDecorView(), Gravity.CENTER_VERTICAL + Gravity.RIGHT, 0, 0);
}

// somewhere in handler:
            if (someCondition)
            {
                if (popupWindowMenuV2 != null && popupWindowMenuV2.isShowing())
                    popupWindowMenuV2.dismiss();
                else
                    popupMenuNav2();
                return true;
            } 
```

# php - 在什么情况下，如果我们将排序后的数字作为键添加到哈希表中，我们可以期望哈希是有序的？

> ID：10406341
> 
> 赞同：2
> 
> 时间：2012-05-02T00:47:27.250
> 
> 标签：php, python, ruby, perl, hash

在 PHP 中，当我们使用排序后的数字作为键将元素插入到新的哈希表中时，是否也会对生成的哈希进行排序？

那么当我们拿到钥匙时，它们会被排序，并且`$a[0], $a[1], $a[2]`也会遵循原来的顺序吗？（当然，键将是那个顺序，但值不一定是）。

在 PHP 中，我们真的可以指望它吗？Perl、Python 或 Ruby 中没有这种行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:50:19.447

Python 有[`OrderedDict`](http://docs.python.org/library/collections.html). 其他语言也有等价物。

然而，对于基本的散列类型（例如 Python 的），通常不能保证这种行为，`dict`因为它需要额外的簿记。

PHP 的数组是一片特殊的雪花；最好不要养成依赖基本哈希排序的习惯，即使您使用的是 PHP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:11:08.083

Perl 中的行为记录在[keys](http://perldoc.perl.org/functions/keys.html)中：

> 哈希的键以明显随机的顺序返回。实际的随机顺序在 Perl 的未来版本中可能会发生变化，但它保证与值或每个函数产生的顺序相同（假设哈希没有被修改）。从 Perl 5.8.1 开始，出于安全原因，即使在 Perl 的不同运行之间，排序也可能不同（请参阅[perlsec 中的算法复杂性攻击](http://perldoc.perl.org/perlsec.html#Algorithmic-Complexity-Attacks)）。

您可以使用[Tie::IxHash](http://search.cpan.org/perldoc/Tie%3a%3aIxHash)：

> 这个 Perl 模块实现了 Perl 哈希，它保留了添加哈希元素的顺序。更改与现有键对应的值时，顺序不受影响`IxHash`。元素也可以设置为任意提供的顺序。熟悉的 Perl 数组操作也可以在`IxHash`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T01:06:19.520

正如 Amber 所指出的，*collections.OrderedDict*是保证保留插入顺序的 Python 工具。

也就是说，我发现标题中提出的问题很有趣。Python 的一个实现细节是整数的哈希值就是值本身。由于常规字典（通常是无序的）只是哈希表，因此有时可以将已排序的数字添加到字典中，使其保持排序：

```
>>> from random import sample
>>> dict.fromkeys(range(5)).keys()
[0, 1, 2, 3, 4]
>>> dict.fromkeys(range(25)).keys()
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>> dict.fromkeys(range(0,25,2)).keys()
[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24]
>>> dict.fromkeys(sorted(sample(range(50), 40))).keys()
[0, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 15, 16, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 47, 49] 
```

这个结果是脆弱的，不是保证的行为。它依赖于以下属性：

*   键根据它们的哈希值以字典大小为模（从 8 开始）定位
*   整数的哈希值是整数本身
*   当哈希表已满三分之二时，它的大小会向上调整四倍（然后开始加倍时高达 50,000），并且重新插入现有的键/值对。

> 问题：在什么情况下，如果我们将排序后的数字作为键添加到哈希表中，我们可以期望哈希是有序的？

回答：排序的数字键在常规字典中保持排序当且仅当这些值在对字典的大小取模时保持排序*，并且**如果*该条件对于添加元素时创建的每个较小的字典也成立：

 **   当取模 8 时，前五个元素 (8 * 2 // 3) 必须排序。
*   当取模 32 时，前 21 个元素 (32* 2 // 3) 必须进行排序。
*   取模块 128 时，前八十五个元素 (128 * 2 // 3) 必须排序。
*   等等 ...

在代码中：

```
def will_remain_sorted(seq):
    i, n = 0, 8
    while i < len(seq):
        i = n * 2 // 3
        if not sorted(seq[:i], key=lambda x: x%n) == seq[:i]:
            return False
        n *= 4 if n < 50000 else 2
    return True 
```*

# php - 无限循环 - 为什么？

> ID：10406343
> 
> 赞同：0
> 
> 时间：2012-05-02T00:47:32.697
> 
> 标签：php, loops, switch-statement, infinite

```
for($i=0; $i<5; $i++) {
    switch($i) {
        case 0:
            echo "<div class=\"darkgrey topdarkgrey\">";
            break;
        case 1:
        case 3:
            echo "<div class=\"lightgrey\">";
            break;
        case 2:
        case 4:
            echo "<div class=\"darkgrey\">";
            break;
        case 5:
            echo "<div class\"darkgrey bottomdarkgrey\">";
            break;
    }
    if($i=$idagInt) 
        echo "<div id=\"idag\">" . $dag[$i] . "<br>";
    else
        echo "<div class=\"dag\"><span class=\"veckoDag\">" . $dag[$i] . "</span><br>";

    echo "<span class=\"month\">" . $datumDay[$i] . " " . $month[$i] . "</span></div>";
    echo "<div class=\"mat\">" . strip_tags($mat[$i], "<p>") . "</div></div>";
} 
```

这是我用来将内容打印到网站的代码，经过一些故障排除后，我的结论是 switch 语句有问题，但我看不到什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T00:48:45.893

这是你的问题。您正在分配而不是比较它`$i`的值。`$idagInt`结果`$i`永远不会达到5。

```
if($i=$idagInt) 
```

将其更改为：

```
if($i==$idagInt) 
```

# magento - 当 qty = '0'（缺货）时，Magento 将产品状态设置为 'Disabled'

> ID：10406346
> 
> 赞同：1
> 
> 时间：2012-05-02T00:48:19.833
> 
> 标签：magento

我正在尝试使用 CE 1.6.2 构建 Magento 商店，当数量 = '0'（缺货）时，我需要将产品状态设置为“已禁用”。一旦产品售罄，我需要它自动将状态更改为禁用，因为我永远不会再销售该产品。此外，一旦达到某个数据/时间，我还需要它来自动禁用产品。

我知道 Magento 提供了在产品售罄后不显示产品的选项，但这不是我想要的。我真的需要它来禁用产品。

或者....

如果当产品缺货时，不是禁用产品，而是有办法清除该产品的所有客户购物车。

我看到的问题是，如果一个客户在他们的购物车中有这个项目，而另一个客户刚刚购买了最后一个可用的产品，那么第一个客户仍然会在他们的购物车中看到这个项目，即使它不允许他们结帐（因为它们不再可用）。清空购物车的唯一方法是客户必须手动移除产品。

那么有没有一种方法可以设置当商品缺货时从所有客户购物车中删除该产品？

我是 Magento 的新手，所以如果有人可以向我展示代码以及如何解决这个问题，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T15:38:13.370

您需要为此任务开发扩展。为事件 sales_order_save_after 创建一个观察者并检查数量就足够了。如果为 0，您可以禁用您的产品。

好吧，我会告诉你怎么做。创建以下文件并清除缓存以使其工作（代码未经测试，但应该可以工作）。

/app/code/local/Sebi/DeactivateOnOutOfStock/etc/config.xml

```
<?xml version="1.0"?>
<config>
    <modules>
        <Sebi_DeactivateOnOutOfStock>
            <version>0.1.0</version>
        </Sebi_DeactivateOnOutOfStock>
    </modules>

    <frontend>
        <events>
            <sales_order_save_after>
                <observers>
                    <deactivateonoutofstock>
                        <type>singleton</type>
                        <class>Sebi_DeactivateOnOutOfStock_Model_Observer</class>
                        <method>salesOrderSaveAfter</method>
                    </deactivateonoutofstock>
                </observers>
            </sales_order_save_after>
        </events>
        <routers>
            <Sebi_DeactivateOnOutOfStock>
                <use>standard</use>
                <args>
                    <module>Sebi_DeactivateOnOutOfStock</module>
                    <frontName>DeactivateOnOutOfStock</frontName>
                </args>
            </Sebi_DeactivateOnOutOfStock>
        </routers>
    </frontend>
</config> 
```

/app/code/local/Sebi/DeactivateOnOutOfStock/Model/Observer.php

```
<?php
class Sebi_DeactivateOnOutOfStock_Model_Observer
{
    public function salesOrderSaveAfter($observer)
    {
        $storeId = 0; //the admin store view, change this if you want to disable only for the store view from which the order came
        $order= $observer->getEvent()->getOrder();

        foreach ($order->getItemsCollection() as $item) {
            $stockQty = (int)Mage::getModel('cataloginventory/stock_item')->loadByProduct($item->getProductId())->getQty();

            if ($stockQty == 0) {
                Mage::getModel('catalog/product_status')->updateProductStatus($item->getProductId(), $storeId, Mage_Catalog_Model_Product_Status::STATUS_DISABLED);
            }
        }

    }
} 
```

/app/etc/modules/Sebi_DeactivateOnOutOfStock.xml

```
<?xml version="1.0"?>
<config>
    <modules>
        <Sebi_DeactivateOnOutOfStock>
            <active>true</active>
            <codePool>local</codePool>
        </Sebi_DeactivateOnOutOfStock>
    </modules>
</config> 
```

祝你好运！不要忘记刷新缓存！

编辑：现在看到你的编辑。售罄时，我不会从客户的购物车中删除商品，因为他们会想到错误并尝试在您的商店中找到它。但他们不能。这将非常令人沮丧。如果他们尝试订购并且在订购时产品已售罄，Magento 会通知他们该产品不再有库存。这必须足够了。

# php - 在 Windows 上使用 PHP 的服务器模式下的 OpenOffice

> ID：10406353
> 
> 赞同：0
> 
> 时间：2012-05-02T00:49:17.943
> 
> 标签：php, windows, openoffice.org, docx

我正在做一个项目，该项目需要我将文档生成为 docx，然后转换为 doc 和 pdf。

这个项目是用 PHP 编写的（使用 Zend 框架）并在 Windows 上的 IIS 上运行（客户端要求 - 绝对不是我的选择！）。

*   视窗服务器
*   IIS 7.5
*   PHP 5.3
*   开放式办公室 3.2

我正在研究执行文档转换的方法（包括 LiveDocx 服务），目前正在研究使用作为服务运行的 OpenOffice 来转换文档。

我有一个有效的 PHP 脚本——它类似于这篇文章中的代码[如何使用 OpenOffice 从我的 PHP 网页将 RTF 转换为 PDF？](https://stackoverflow.com/questions/1040780/how-do-i-convert-rtf-to-pdf-from-my-php-web-page-using-openoffice)- 但我想知道这将如何扩展。PHP 脚本基本上是使用 PHP 的 COM 函数的 PyOD 转换器的 PHP 版本。在此页面 ( [http://code.google.com/p/jodconverter/wiki/GettingStarted](http://code.google.com/p/jodconverter/wiki/GettingStarted) ) 上，它特别指出 PyOD 脚本不适用于多个并发连接。因此，我假设 PHP 脚本同样不合适。

仔细阅读后，似乎正在运行的 OpenOffice 进程一次只支持一个连接。这绝对正确吗？如果是这样，那么我认为这根本不是一个可行的解决方案是否正确？我预计该产品的使用率很高，因此必须进行并发转换。有没有人在生产环境中有这方面的经验？

最后，是否有人对进行转换有任何其他建议？如果没有，我将重新使用 LiveDocx 服务。我唯一真正的抱怨是速度和转换的一些不准确。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T07:50:31.173

您可能可以扩展 OpenOffice 来满足您的需求。过去曾直接使用 OpenOffice UNO api 完成工作，但您可能会发现有很多工作要做。试图以多线程方式使用单个 OpenOffice 进程只会让我感到悲伤。但是，您可以生成多个 OpenOffice 进程并且每个进程都是单线程的。这取决于您的性能标准是否足够可扩展......

[JODReports](http://sourceforge.net/projects/jodreports/)和[Docmosis](http://www.docmosis.com)位于 OpenOffice 之上，因此在使用特定技术自行投入任何开发工作之前，可能值得尝试其中一个系统，看看您是否可以*潜在地扩展到所需的内容。*你也可以看看 LibreOffice，它最近比 OpenOffice 发展得更远一些。

希望有帮助。

# android - 自定义视图不响应触摸

> ID：10406354
> 
> 赞同：5
> 
> 时间：2012-05-02T00:49:27.737
> 
> 标签：android, android-layout, android-widget, custom-controls, touch

我创建了一个自定义视图，当按下、突出显示或禁用时，它应该改变它的背景图像。应用程序运行，但按钮不会改变它的背景。

这是我的代码：

```
public class CustomImageButton extends View {

public CustomImageButton(Context context) {
super(context);
setFocusable(true);
setClickable(true);
}

public CustomImageButton(Context context, AttributeSet attrs) {
super(context, attrs);
setFocusable(true);
setClickable(true);
}
public CustomImageButton(Context context, AttributeSet attrs, int defStyle) {
super(context, attrs, defStyle);
setFocusable(true);
setClickable(true);
}

protected Drawable background = super.getBackground();

@Override
public void setBackgroundDrawable(Drawable d) {
// Replace the original background drawable (e.g. image) with a LayerDrawable that
// contains the original drawable slightly edited.

CustomImageButtonBackgroundDrawable layer = new CustomImageButtonBackgroundDrawable(d);
super.setBackgroundDrawable(layer);
}

public void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
 int drawableWidth = super.getBackground().getMinimumWidth();
 int drawableHeight = super.getBackground().getMinimumHeight();
 setMeasuredDimension(drawableWidth, drawableHeight);
}

protected class CustomImageButtonBackgroundDrawable extends LayerDrawable { 

    protected Drawable lowerlayer;
    protected Drawable _highlightedDrawable;

    protected int _disabledAlpha = 100;
    protected Drawable _pressedDrawable;

    public CustomImageButtonBackgroundDrawable(Drawable d) {
          super(new Drawable[] { d });
    }

    @Override
    protected boolean onStateChange(int[] states) {
      boolean enabled = false;
      boolean highlighted = false;
      boolean pressed = false;

      for (int state : states) {
        if (state == android.R.attr.state_enabled)
            enabled = true;
        else if (state == android.R.attr.state_selected)
            highlighted = true;
        else if (state == android.R.attr.state_pressed)
            pressed = true;
      }

      mutate();
      if (enabled && highlighted) {
        ColorFilter colourFilter = new LightingColorFilter(Color.YELLOW, 1);
        ScaleDrawable resizedImage = new ScaleDrawable(background, 0, 1.25f, 1.25f);

        lowerlayer = resizedImage.getDrawable();
        lowerlayer.setColorFilter(colourFilter);

        Drawable[] aD = new Drawable[2];
        aD[0] = lowerlayer;
        aD[1] = background;
        LayerDrawable _highlightedDrawable = new LayerDrawable(aD);

        setBackgroundDrawable(_highlightedDrawable); // buttons need transparent backgrounds

      } else if (!enabled) {
        setColorFilter(null);
        setAlpha(_disabledAlpha);

      } else if (enabled && pressed){
        ScaleDrawable smaller = new ScaleDrawable(background, 0, 0.75f, 0.75f);

        setBackgroundDrawable(smaller.getDrawable());

      } else if(enabled){
        setBackgroundDrawable(background);  
        setColorFilter(null);
      }

      invalidateSelf();

      return super.onStateChange(states);
    }

}

} 
```

这是我的xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#ffffff">

<ImageButton
    android:id="@+id/title"
    android:layout_width="250dp"
    android:layout_height="58dp"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_margin ="25dp"
    android:background="@drawable/skintonetitle" />

<custombuttons.CustomImageButton
    android:id="@+id/skina1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/title"
    android:layout_below="@+id/title"
    android:layout_marginTop="35dp"
    android:background="@drawable/test_circle"
    android:clickable="true"
    android:focusable="true" />

</RelativeLayout> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T01:01:06.077

它从视图扩展，而不是按钮，因此默认情况下它不可点击或聚焦。调整

```
android:clickable="true"
android:focusable="true" 
```

在您的 XML 中。

如果您想在 java 中进行，您也可以在 View 类的构造函数中设置这些：

```
setFocusable(true);
setClickable(true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-03-04T14:12:31.717

在我的例子中，我使用了一个以约束布局为根的自定义视图。我没有在我的自定义视图的 setOnClickListener 上获得点击事件，事实证明我需要`android:clickable="false"`在我的 xml 的根目录中设置自定义视图。显然，单击事件被分派到我的自定义视图 xml 的根而不是它自己的自定义视图（即自定义视图的 setOnClickListener）

# c# - 在循环中访问对象属性

> ID：10406355
> 
> 赞同：3
> 
> 时间：2012-05-02T00:49:29.757
> 
> 标签：c#, object, properties

首先将对象属性分配给变量而不是直接在循环中使用它会更好吗？

假设我有一个位图`Bitmap img = new Bitmap("image.jpg")`，我需要遍历所有像素以进行一些处理。对于大约 200 万像素的 1080p 图像。我`data.Stride`首先使用或将它们分配给变量有关系`int dataStride = data.Stride`吗？我每次都需要访问它来计算偏移量，但 dataStride 是图像的常量。

```
data = editImage.LockBits(new Rectangle(0, 0, editWidth, editHeight), ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
byte* dataPtr = (byte*)data.Scan0;
dataStride = data.Stride; 
```

我首先将它们分配给一个变量，因为我认为它必须首先访问对象（每次），然后从对象（每次）访问更慢的整数。而且由于它是一个大循环......它加起来。因此，首先将属性分配给变量会更快，因为它可以直接访问 int 值。它是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:54:43.093

是的。不管属性多么简单，访问它仍然有函数调用的开销。变量更快，尤其是当您执行 200 万次时。

# linux - 在 shell 脚本中重定向标准输出

> ID：10406359
> 
> 赞同：1
> 
> 时间：2012-05-02T00:50:18.850
> 
> 标签：linux, unix

对我来说已经很晚了，或者我在这里错过了一些天真的东西。

这是一个人为的例子

```
#!/bin/bash
command="ls -al > check.txt"
$command 
```

当我在 shell 上运行这个脚本时，它给了我错误，我猜是由于 ">" 运算符。无论如何，我可以从 shell 脚本中重定向输出。我认为这很简单：

```
ls -la > temp.txt
ls: cannot access >: No such file or directory
ls: cannot access temp.txt: No such file or directory 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T00:52:04.950

```
#!/bin/bash
command="ls -al" 
$command > check.txt 
```

`>`是 Bash（和大多数 shell）中的特殊字符。它不属于命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:55:45.743

这是另一种使用方法`eval`，

```
#!/bin/bash
command="ls -al > check.txt"
eval $command 
```

# php - .php 在外部站点上以 .jpg 形式提供的随机图像

> ID：10406363
> 
> 赞同：2
> 
> 时间：2012-05-02T00:50:32.723
> 
> 标签：php, image, random

我发布的一个论坛只允许从外部 URL 加载 .jpg、.png 和 .gif 图像。我想解决这个问题，并从我的服务器上的目录中随机选择一个动态头像，但我无法让它工作（可能是由于在外部站点上执行了额外的检查，或者我的代码中有错误） .

到目前为止，我已经在我的服务器上创建了一个名为“avatar.jpg”的文件夹，该文件夹中我的 index.php 文件中的代码如下：-

```
<?php
$arr=array();
for($i=1;$i<6;$i++){
$arr[$i]=$i.".jpg";
}
$random=rand(1,6);
echo $arr[$random];
?> 
```

我在 avatar.jpg 文件夹中有 6 张图片，分别命名为 1.jpg、2.jpg 等。

当我运行 mydomain.com/avatar.jpg 时，它会正确显示随机图像源，例如。5.jpg，但是当我在论坛上输入此 URL 作为我的头像 URL 时，它无法加载并且 Firebug 报告“无法加载给定的 URL”。

我是否从我的代码中遗漏了一些东西以使这项工作按预期进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:01:37.360

您似乎正在使用文本字符串“$name.jpg”作为 .jpg 文件的响应！您必须设置正确的内容类型标头并提供实际图像文件的位和字节。

就像是：

```
header("Content-type: image/jpeg");
echo file_get_contents($randomFilepath); 
```

# php - 如果“单词”存在，PHP / MySQL首先排序项目，然后是其余的ASC？

> ID：10406364
> 
> 赞同：2
> 
> 时间：2012-05-02T00:50:33.270
> 
> 标签：php, mysql

我有一个食品数据库，我正在尝试实现一个简单的搜索，该搜索将放置“原始”或“最少加工”的第一个项目。

例如，当我搜索“胡萝卜”时，我真的不想将所有加工食品（胡萝卜蛋糕等）、快餐（温迪的胡萝卜巨无霸等）都分类。我希望第一个项目是“胡萝卜，生的”，“胡萝卜，煮的”，“胡萝卜冷冻”，“胡萝卜，罐头”等。

有没有办法在 MYSQL 中做到这一点，以便我首先按“关键字的存在”对我的项目进行排序（比如说：“raw”、“fresh”、“boiled”、“frozen”......）然后所有其他出现后？

笔记 ：

*   关键字可能存在也可能不存在
*   关键字可能在任何地方
*   我还必须单独找到搜索关键字，在此示例中为“carrot”，以便“carrot cake”仍在我的结果中。

非常感谢！

乔尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:55:04.987

这可能对您有用：

```
SELECT * FROM foods
WHERE foods.title LIKE '%carrot%'
ORDER BY foods.title LIKE '%raw%' DESC, foods.title 
```

原因`DESC`是它会返回 0 或 1，并且您希望首先对返回 1 的结果进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:51:56.767

自然词搜索会根据相关性按顺序返回记录，因此如果您将 FULLTEXT 索引添加到 foods.title 列，您可以简单地执行如下搜索：

```
SELECT *
FROM foods
WHERE MATCH (title) AGAINST ('carrot raw fresh frozen canned')
  AND title LIKE 'carrot%' 
```

附加的 LIKE 标准会过滤掉开头没有单词胡萝卜的结果，例如“鱼，罐头”。

FULLTEXT 索引目前只能与 MyISAM 表一起使用，不过很快（v5.6+）您也可以将它们与 InnoDB 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:06:37.030

如果食物经过加工，为什么不设置一个名为“已加工”的附加字段来存储 1。然后只需按已处理和名称排序。

# c# - 使用 AllowPartiallyTrustedCallers 'proxy' 程序集从低信任程序集调用完全信任程序集

> ID：10406366
> 
> 赞同：0
> 
> 时间：2012-05-02T00:50:47.853
> 
> 标签：c#, .net, .net-3.5

如果您有一个第三方程序集需要完全信任才能进行日志记录操作（此程序集没有`AllowPartiallyTrustedCallers`）。

您可以通过自定义程序集使用此程序集，`AllowPartiallyTrustedCallers`然后将其部署到 GAC。

当依赖项（第三方程序集）出现安全要求时，如何使用来自低信任代码的自定义程序集？

注意：上下文是共享点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:24:24.637

最佳猜测：缺少安全要求的断言。查看[MSDN 教程](http://msdn.microsoft.com/en-us/library/aa288469%28v=VS.71%29.aspx#vcwlksecuritytutorialsuppressingsecurity)以开始使用。以及Assert 方法的[SecurityPermission](http://msdn.microsoft.com/en-us/library/z15f82t9.aspx)类。

# php - Android 应用无法连接到 MySQL 数据库

> ID：10406370
> 
> 赞同：0
> 
> 时间：2012-05-02T00:51:06.253
> 
> 标签：php, android, mysql, android-listview

我有以下代码，用于访问本地数据库并返回单个值（出于测试目的，该值是“千层面”。它应该返回它并使其成为列表中项目的名称。应用程序崩溃时活动被访问。

我真的卡住了，任何帮助都会很棒。

```
public class RecipeMethodActivity extends ListActivity {

Intent myIntent;
String value;
TextView editvalue;
TextView buttonPressed;
Intent intent;
String result = null;
InputStream is = null;
StringBuilder sb=null;
String result2 = null;

final Recipe[] mRecipesArray = {    new Recipe("Lasagna",  new String[]{"1 Brown lean ground beef in skillet until lightly browned and cooked through. Put a few layers of paper towels in large bowl. With slotted spoon, remove browned beef from skillet draining off excess beef fat and put on top of blotting towels. After all the browned beef has been removed from the skillet, drain off and dispose of excess beef fat. Wipe skillet clean with paper towel. (If your ground beef is sufficiently lean, there will not be any excess fat to drain.)Add diced green pepper and onion to skillet. Brown for a few minutes on medium high heat. Add the garlic and cook for 30 seconds more. Add browned beef back to the skillet, lower the heat to low and continue to cook for 5 more minutes stirring frequently.", 
                                                "2 Transfer browned beef, green pepper and onions to 3 Qt. pot. Add tomato sauce, tomato paste. Open stewed tomatoes and dice, then add to 3 Qt. pot. Add oregano, parsley, Italian Spice Mix to taste, probably 2 teaspoons of each. Add a pinch of garlic powder and a pinch of garlic salt, to taste. Add a dash of white wine vinegar. Add sugar a tablespoon at a time, until desired level of sweetness, no more than 1/4 cup of sugar. Note that it is hard to follow a pure recipe when it comes to pasta sauce. One Italian spice mix is not like the other, nor is one can of tomato sauce not like the other. So you really do need to taste the sauce as you are adding the spices, sugar and vinegar. Stir and allow sauce to simmer 15-45 minutes to thicken (do not scorch bottom, stir frequently). Remove from heat.",
                                                "3 Cook lasagna noodles in 6 Qt. Pot per cooking directions (al dente). (Note noodles may be cooked in advance.) Stir often to prevent from sticking and be sure that water remains at a boil during the entire cooking to prevent noodles from sticking. I add Tbsp of salt to the water so the noodles are more flavorful. Drain in colander and place in a cool water filled pan to keep from drying out and sticking together.",
                                                "4 In dry lasagna pan, ladle one cup of sauce and spread along the bottom of the pan. Apply a layer noodles 3 length wise (edges overlapping). Ladle in sauce sparingly into center trough of 3 noodles. Apply a layer of mozzarella cheese slices on top of lasagna sauce. Place ricotta cheese dollops every 2 inches in center of noodles on top of mozzarella cheese slices, sprinkle grated parmesan cheese in thin even layer on top of ricotta cheese. Apply second layer of noodles, topping again with sauce and cheese. Finish with another layer of noodles. If you have extra sauce and cheese you can spread that over the top. Tent lasagna pan with aluminum foil (not touching noodles or sauce). Bake at 375°F for 45 minutes. Allow to cool before serving."}),
                                    new Recipe(result, new String[]{"GlaDOS' wit","Is a lie"}),
                                    new Recipe("EarthDestruction", new String[]{"Asteroid", "Kinetic energy"})};

public class Recipe{
    public String name;
    public String[] steps;

    Recipe(String name, String[] steps){
        this.name = name;
        this.steps = steps;
    }
}

public ArrayList<String> FetchRecipesRawArray(Recipe[] recipes){
    ArrayList<String> ret = new ArrayList<String>();
    for(int i=0;i<recipes.length;i++){
        ret.add(recipes[i].name);
    }
    return ret;
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);    

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, FetchRecipesRawArray(mRecipesArray));
    setListAdapter(adapter); 

    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

    try{
                    HttpClient httpclient = new DefaultHttpClient();
                    HttpPost httppost = new HttpPost("http://127.0.0.1/index.php");
                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                    HttpResponse response = httpclient.execute(httppost);
                    HttpEntity entity = response.getEntity();
                    is = entity.getContent();
                }catch(Exception e){
                    Log.e("log_tag", "Error in http connection"+e.toString());
                }
                //convert response to string
                try{
                    BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
                    sb = new StringBuilder();
                    sb.append(reader.readLine() + "\n");
                    String line="0";
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    result=sb.toString();
                    Toast.makeText(getBaseContext(), result, Toast.LENGTH_LONG).show();
                }catch(Exception e){
                    Log.e("log_tag", "Error converting result "+e.toString());
                }
                //paring data
                String fd_name;
                try{
                    JSONArray jArray = new JSONArray(result);
                    JSONObject json_data=null;
                    for(int i=0;i<jArray.length();i++){
                        json_data = jArray.getJSONObject(i);
                        fd_name=json_data.getString("recipename");
                    }
                }catch(JSONException e1){
                    Toast.makeText(getBaseContext(), "No Food Found", Toast.LENGTH_LONG).show();
                }catch (ParseException e1){
                    e1.printStackTrace();
                }

}

protected void onListItemClick(ListView l, View v, int position, long id){
    Intent intent = new Intent(this, MethodActivity.class);
    intent.putExtra(MethodActivity.EXTRA_RECIPEARRAY, mRecipesArray[position].steps);
    startActivity(intent);

}
} 
```

即使数据库中有数据，我也会收到未检索数据的错误。问题可能是什么？

我的PHP是：

```
<?php
mysql_connect("localhost","root","michael2020");
mysql_select_db("finalyearproject");

$q=mysql_query("SELECT recipename FROM recipes WHERE     recipename>'".$_REQUEST['value']."'");
while($e=mysql_fetch_assoc($q))
    $output[]=$e;

print(json_encode($output));

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T07:14:43.033

试试这个。

```
$q=mysql_query("SELECT recipename as recipe FROM recipes WHERE     recipename>'".$_REQUEST['value']."'");

while($e=mysql_fetch_assoc($q))
    $output=$e['recipe'];

print(json_encode($output)); 
```

# php - array_search 带空格的字符串

> ID：10406373
> 
> 赞同：1
> 
> 时间：2012-05-02T00:51:34.880
> 
> 标签：php

我已经正确创建了一个数组并有一个数组项：

```
$array[2] = "Automotive Repairs and Servicing"; 
```

我尝试在 $array 上搜索汽车维修和服务，它返回 false：

```
array_search('Automotive Repairs and Servicing', $array); 
```

我发现它返回 false 因为我在搜索字符串中有一个空格，即 Automotive(space)Repairs(space)and(space)Servicing。

有谁知道我怎样才能让我的搜索成功返回密钥？我曾尝试将空格设为 %20、\n，如下所示：

```
array_search('Automotive%20Repairs%20and%20Servicing', $array);
array_search('Automotive\nRepairs\nand\nServicing', $array);
array_search('Automotive&nbsp;Repairs&nbsp;and&nbsp;Servicing', $array); 
```

我将继续尝试解决这个问题，如果我解决了它，我会发布我的答案。

...感谢您在下面的回答。我试过你的代码，它也对我有用。

我的真实数组实际上是由使用 mysql 查询的数据库中的数据构成的，并将结果直接放入数组中。所以现在不太确定问题出在哪里。

...

**我的答案：**

感谢大家回复并帮助我解决这个问题。

我发现了我的问题……我非常**尴尬**。

原来在我的数据库中字符串“汽车维修和服务”的末尾有一个我没有看到的空格。我以前遇到过这个问题，我的 mysql 数据库有时就像这样弄乱我的脑袋。

因此，对于其他任何获得 mysql 结果并将其粘贴到数组中然后遇到类似问题的人，请确保您的 mysql 不会在您的数据中使用空格（人眼不可见）“恶作剧”您。

我要出去抽支烟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:56:02.710

我真的看不出有什么问题...

但这**正是我尝试过的**：

```
<?php
$array[0] = "noo";
$array[1] = "DONE";
$array[2] = "Automotive Repairs and Servicing";

$index = array_search('Automotive Repairs and Servicing', $array);

echo "Index = $index";

?> 
```

这是**输出**：

```
Index = 2 
```

# ios - 在所有设备上发布 uilocalnotification

> ID：10406377
> 
> 赞同：1
> 
> 时间：2012-05-02T00:52:28.167
> 
> 标签：ios, cocoa-touch

本地通知可以通过 iCloud 同步吗？我知道本地意味着本地，但那里有一个日历属性，所以我想也许有办法？

# javascript - 是否可以将 onclick 事件附加到文档中的特定坐标？

> ID：10406378
> 
> 赞同：3
> 
> 时间：2012-05-02T00:52:28.513
> 
> 标签：javascript, jquery

我想知道是否可以将 onclick 事件附加到文档中的特定坐标。也许类似于图像地图中的“区域坐标”的东西，可以让我创建一个矩形或圆形区域，单击该区域会执行一些代码。整个早上都在努力寻找解决方案，希望有更好的编码知识的人可以为我澄清这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:05:16.257

您可以将单击事件附加到文档本身，而不是任何特定元素。事件数据应包含单击时鼠标的坐标（clientX 和 clientY）。

假设没有其他元素拦截并取消传播或返回 false，则该事件应该冒泡到文档中，并且您的数据将在那里为您服务。

```
$(document).click(function(ev){
    console.log(ev.clientX, ev.clientY)
}) 
```

这将为您提供窗口中的鼠标指针位置。如果您希望它相对于文档的顶部，则需要使用文档的滚动位置进行一些数学运算。

您还可以编写一些代码来过滤掉属于或不属于给定坐标集的点击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:55:33.447

简短的回答：**没有**。

长答案：

您可能可以编写一个插件来执行此操作，但我只是要解释一下功能。

基本上，您像往常一样绑定到 click 事件。*确保您绑定到的元素是可访问的。*

然后，循环遍历一个坐标数组，如果事件位置落在任何坐标中，则调用关联的事件处理程序。

**编辑：**如果不是很明显，你可以用一个函数替换“一堆坐标”，或者更准确地说，一个数学计算。您可以将方程传递给处理程序，该处理程序适用于您想要的任何类型的 2d 形状。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T00:54:01.167

不，除非你有一个占据这些坐标的元素。相反，您可以将事件绑定到占据该坐标空间的任何元素，并简单地检查事件对象中单击的坐标。

# html - 适合语言学习者的 HTML 页面的语言标签？

> ID：10406380
> 
> 赞同：1
> 
> 时间：2012-05-02T00:52:43.927
> 
> 标签：html, markup

假设我正在写一份*关于*某种语言（比如西班牙语）的文档，但它是用英语写*的*。你在“自学西班牙语”一书中看到的那种东西。

我可以看到将页面作为一个整体标记：

`<html lang=en>...</html>`

或者：

`<html lang=es>...</html>`

这种材料有最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:57:37.603

您示例中的主要内容是英语，并且针对说英语的访问者，所以我会这样做

```
<html lang=en>...</html> 
```

lang 属性通常用于通知客户端（浏览器、搜索引擎）主要内容的语言。搜索引擎将使用它来帮助更好地定位他们的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:59:06.660

W3 推荐以下内容：

```
<p title="Swedish"><a xml:lang="sv" lang="sv" href="index.sv.html">svenska</a></p> 
```

根据[http://www.w3.org/TR/i18n-html-tech-lang/#ri20050128.175100333](http://www.w3.org/TR/i18n-html-tech-lang/#ri20050128.175100333)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T04:41:45.770

推荐的方法（参见[WCAG 2.0 指南 3.1](http://www.w3.org/TR/WCAG/#meaning)和相关技术文档）是指定文档的默认语言，这里使用`<html lang=en>`or ，并使用其他元素中的属性`<html lang=en-US>`指定任何部分的任何不同语言，例如。`lang``<span lang=es>¡Comprendo!</span>`

在这种情况下，这通常不太现实。您不想手动添加此类标记，而且很少有创作程序有方便的工具。但是，如果您例如在 MS Word 中编写文本，使用 Word 的工具在其中指定部分的语言，以使拼写检查正常工作，那么您可以将内容导出为 HTML 格式并进行大量编辑，删除大部分由 Word 生成但保留`lang`属性的标记。

如果您希望西班牙文文本的样式与英文文本不同，那么`lang`标记很有用，即使您需要手动输入也可以使用它。但是使用`class`属性会稍微跨浏览器（一些旧浏览器不支持 CSS 中的语言选择器）。

除此之外，您无法通过使用`lang`属性获得太多收益。如果您只在元素上使用它，是否应该使用它是值得怀疑的，因为您`<html>`知道很大一部分内容不是指定的语言。

# css - 未知数量儿童的 CSS3 渐进式变换

> ID：10406382
> 
> 赞同：2
> 
> 时间：2012-05-02T00:53:10.143
> 
> 标签：css

我一直在使用 CSS 中的渐进式变换和过渡。到目前为止它看起来还不错，但我想知道如何让它通用——也就是说，对于任何数量的孩子。

dabblet/gist 在[这里](http://dabblet.com/gist/2572679)- 你可以立即看到这是为少数孩子硬编码的。我不想写`div+div+div+div....`如下规则 - 可能有一种巧妙的方法来实现这一点，但欢迎任何想法。

```
.fan:hover div {
    -webkit-transform: rotate(10deg);
    top: -10px;
    left: 5px;
    box-shadow: 0 2px 10px rgba(128,128,128,0.3);
}
.fan:hover div+div {
    -webkit-transform: rotate(20deg);
    top: -15px;
    left: 10px;
}
.fan:hover div+div+div {
    -webkit-transform: rotate(30deg);
    top: -20px;
    left: 15px;
} 
```

编辑：我意识到它们现在也只是 webkit 规则；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:28:59.850

快速浏览您的代码：

[http://dabblet.com/gist/2574800](http://dabblet.com/gist/2574800)

对于第二个，修改后的风扇，只有`.fan:hover div`规则适用，但由于嵌套变换规则在您的 div 上多次应用，所以第一个 div 旋转 10 度，第二个 10 + 10 度等等......你可能不得不进一步调整规则，但我认为原则是明确的。

# php - 我应该如何在我的应用中存储 Gmail 身份验证？

> ID：10406384
> 
> 赞同：-2
> 
> 时间：2012-05-02T00:53:47.370
> 
> 标签：php, mysql, gmail, email-client, hotmail

我正在为一个客户用 PHP 开发一个邮件客户端，他们希望能够从这个单一的客户端处理他们所有的各种电子邮件帐户。

用户不必在每次想要使用该服务时都输入所有密码，这就是我的问题。有没有办法在不输入邮件帐户密码的情况下通过 Gmail 检索和发送邮件？还有其他方法吗？或者我是否必须通过某种加密将密码保存在我的数据库中并使用“隐藏”密钥对其进行解密？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:03:04.297

[https://developers.google.com/google-apps/gmail/](https://developers.google.com/google-apps/gmail/)阅读 OAuth 部分。

OAuth 为您提供令牌，而不是密码。即使用户更改了他的 gmail 密码，该令牌也会允许您访问他的收件箱等。

至于 Hotmail ......我认为没有 OAuth API 存在，遗憾的是。

请阅读以防万一：http: [//msdn.microsoft.com/en-us/library/live/hh826535](http://msdn.microsoft.com/en-us/library/live/hh826535)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:14:07.297

使用电子邮件服务器进行身份验证需要您传递密码，因此您对将密码存储在应用程序数据库中的加密和解密机制（密码）是正确的。如果有人获取您的数据，这将防止电子邮件密码被读取，但您需要小心应用程序如何存储要解密的密钥。以下是 PHP 中的一些密码扩展[http://www.php.net/manual/en/refs.crypto.php](http://www.php.net/manual/en/refs.crypto.php)

# c++ - 如何在 MFC 应用程序中替换全局运算符 new 和 delete（仅限调试）

> ID：10406386
> 
> 赞同：7
> 
> 时间：2012-05-02T00:53:51.150
> 
> 标签：c++, memory-management, memory-leaks, mfc

多年来，我一直避免尝试对 operator new 做任何事情，因为我觉得它在 Windows 上是一个泥潭（尤其是使用 MFC）。更不用说，除非有一个非常令人信服的理由来搞乱全局（甚至类）new 和 delete，否则不应该这样做。

但是，我有一个令人讨厌的小内存损坏错误，我非常想追踪它。我从 CRT 调试分配器收到消息，表明先前释放的内存已被覆盖。此消息仅在稍后的分配调用期间显示，当它尝试重用一个块时（我相信这就是它的工作方式，无论如何）。

由于有问题的代码部分，错误消息和损坏点非常不相关。我所知道的是“某处某处覆盖了一些以前用单个空字节释放的内存”。（我通过使用调试器并在几次不同的运行中观察调试堆引用的内存来确定这一点）。

在用尽了关于罪魁祸首可能在哪里的明显想法之后，我只能尝试做一些更严格的事情。我突然想到，如果我能让每个被释放的块变成一个不可访问的内存页面，这样写者就会立即被 CPU 的 MMC 捕获，那将是理想的！后来稍微搜索了一下，我发现有人按照这些思路实现了一些东西：

[http://www.codeproject.com/Articles/38340/Immediate-memory-corruption-detection](http://www.codeproject.com/Articles/38340/Immediate-memory-corruption-detection)

他的代码隐藏在大量重复发明的代码中，但提取核心概念非常容易，我已经做到了。

我现在遇到的问题是 MFC 将 new 重新定义为 DEBUG_NEW，然后进一步定义了一系列到 CRT 的调试接口。此外，它确实定义了全局运算符 new 和 delete。因此，就 C++ 而言，“用户”试图替换全局运算符 new 并删除两次，因此我得到一个链接器错误，其效果为“符号已定义”。

环顾互联网，SO，我看到了一些有前途的文章，但没有一个最终对替换全球运营商 new/delete 为 MFC 有任何积极的看法。

[如何正确替换全局新和删除运算符](https://stackoverflow.com/questions/8186018/how-to-properly-replace-global-new-delete-operators)
[是否可以在 MFC 应用程序的调试版本中替换内存分配器？](https://stackoverflow.com/questions/2198401/is-is-possible-to-replace-the-memory-allocator-in-a-debug-build-of-an-mfc-applic)

我已经意识到：

*   MFC/CRT 已经为内存分配提供了丰富的调试工具。

好吧，它提供了它所提供的东西——比如让我一开始就沿着这条路走下去的信息。我现在知道正在发生腐败，但这是非常弱的酱汁！

我想提供的是保护分配（甚至只是保护释放）。这显然可以通过使用大量虚拟地址空间并将每个分配隔离起来，这非常浪费内存。好的，是的，当这是对像现在这样的特殊用途的时刻有用的仅调试代码时，看不到不利的一面。

**因此，我正在拼命寻求以下解决方案**

1.  尽管 CRT/MFC 提供了一个，但强制编译器与我的全局运算符 new/delete 合作。
2.  找到另一种方法来挂钩 MFC/CRT _heap_alloc_dbg 链，以使用我自己的代码代替他们的代码，以进行倒数第二次分配（即，我将通过操作系统的 VirtualAlloc/VirtualFree 分配以为 new 和/或马尔洛克）。

**有没有人知道答案，或者阅读的好文章可能会阐明如何实现这些？**

其他想法：

1.  使用 thunk 技术在运行时替换 CRT 的 new/delete。
2.  完全是其他一些方法？！

**进一步的调查：**

*   这篇文章很酷……它为我提供了一种在运行时修补全局 new/delete 运算符的方法。但是，正如文章指出的那样，它有点骇人听闻（但是，因为我只需要它来进行调试构建，这没什么大不了的）[http://zeuxcg.blogspot.com/2009/03/fighting-against-crt- heap-and-winning.html](http://zeuxcg.blogspot.com/2009/03/fighting-against-crt-heap-and-winning.html)
    *   因此，尽管这达到了我想要的效果（一种替换 CRT 内存分配函数的机制），但这个实现已经过时了，到目前为止，我试图让它工作的尝试遇到了无数问题。我认为它对最初创建的版本太黑了，仅用于相对简单的控制台使用（即 C，甚至不是 C++，并且放弃了 microsoft CRT 提供的大多数调试功能）。因此，尽管这是一个非常酷的想法，但最终将花费大量时间来与当前的 VS2010 开发工作室合作，因此不值得（对我而言）。
*   显然，这个想法有一个众所周知的版本：[http](http://en.wikipedia.org/wiki/Electric_Fence) ://en.wikipedia.org/wiki/Electric_Fence不幸的是，即使是 Windows 端口，我也找到了[http://code.google.com/p/electric-fence-win32 /](http://code.google.com/p/electric-fence-win32/)未能正确覆盖 CRT，但要求您修改所有源代码以访问电子围栏堆分配代码。:(

**2012 年 5 月 3 日更新：**

*   现在我发现 Windows 已经提供了 Electric Fence 的实现，可以通过 GFLAGS 调试工具[访问 http://support.microsoft.com/kb/286470](http://support.microsoft.com/kb/286470) 这可以在被测试的应用程序外部打开和关闭。它本质上与我感兴趣的技术相同，并且具有 DUMA 项目（电子围栏的一个分支 - [http://duma.sourceforge.net/](http://duma.sourceforge.net/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T16:11:26.690

MSVCRT 调试堆实际上非常好，并且有一些您可以使用的有用功能，例如第 n 次分配的断点等。

[http://msdn.microsoft.com/en-us/library/974tc9t1(v=VS.80).aspx](http://msdn.microsoft.com/en-us/library/974tc9t1(v=VS.80).aspx)

除其他外，您可以插入一个分配挂钩，该挂钩输出可用于调试此类问题的调试信息等。

[http://msdn.microsoft.com/en-us/library/z2zscsc2(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/z2zscsc2(v=vs.80).aspx)

在您的情况下，您真正​​需要做的就是输出每个分配的地址、文件和行。然后当你遇到一个损坏的块时，找到地址紧接在它之前的那个块，几乎可以肯定是那个被溢出的块。您可以使用 Visual Studio 调试器中的内存视图来查看已损坏的内存地址并查看前面的块。这应该告诉你所有你需要知道的，以找出它何时被分配。

调试堆在每个分配的块上也有一个数字分配 ID，并且可以在第 n 次中断！分配，因此，如果您可以获得合理一致的重现，因此每次都损坏相同的数字块，那么您应该能够使用“第 n 次中断”功能来获得分配时的完整调用堆栈。

您还可能会发现`_CrtCheckMemory`了解腐败是否发生得更早很有用。只需定期调用它，一旦您将错误括起来（错误没有发生在一个中，确实发生在另一个中），将它们越来越靠近。

# android - 如何制作平板电脑不会翻转屏幕？

> ID：10406393
> 
> 赞同：-2
> 
> 时间：2012-05-02T00:54:53.533
> 
> 标签：android, landscape

即使我的应用程序的用户将其侧向倾斜，如何使平板电脑始终保持横向而不是纵向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:59:30.830

在应用程序下的清单中添加 android:screenOrientation="landscape"

# php - 在 wordpress 主题中翻译几个词

> ID：10406401
> 
> 赞同：0
> 
> 时间：2012-05-02T00:56:51.163
> 
> 标签：php, wordpress, translate

我目前正在制作一个 wordpress 网站，我的客户可以在其中输入帖子的标题，并且在我的主题中我想将帖子的标题翻译成意大利语，但只有标题，我想在我的主题中进行。我尝试使用 GTranslate，但我的猜测是它不再有效，因为谷歌现在对该 api 收费。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:32:58.257

很遗憾 Google Translate API 不再免费，但它仍然是我用过的最好的。

有一些免费的替代品，包括微软的翻译服务。

[http://msdn.microsoft.com/en-us/library/ff512404.aspx](http://msdn.microsoft.com/en-us/library/ff512404.aspx)

# java - 使用 Weka 的 Evaluation.areaUnderROC 时出现 Java NullPointerException

> ID：10406406
> 
> 赞同：3
> 
> 时间：2012-05-02T00:57:58.127
> 
> 标签：java, weka

所以我试图评估分类器在测试实例上的性能，当我尝试获取 ROC 下的区域时，会引发以下错误：

> Java.lang.NullPointerException at weka.classifiers.evaluation.ThresholdCurve.getROCArea(ThresholdCurve.java:268) at weka.classifiers.Evaluation.areaUnderROC(Evaluation.java:382) at Classifier_Search.runAda(Classifier_Search.java:74) at Classifier_Search .acrossTest(Classifier_Search.java:142) 在 Sun.reflect.NativeMethodAccessorImpl 的 Classifier_Search.main(Classifier_Search.java:511) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl .invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at edu.rice.cs.drjava.model.compiler.JavacCompiler.runCommand(JavacCompiler.java:271)

引发错误的代码是这样的：

```
Evaluation eval = new Evaluation(train);
String[] options = {"-P 100", "-S 1", "-I " + it, "-W weka.classifiers.trees.DecisionStump"};
AdaBoostM1 cls = new AdaBoostM1(); 
cls.setOptions(options);
cls.buildClassifier(train);
eval.evaluateModel(cls, test);
int index = test.classIndex();
return eval.areaUnderROC(index); 
```

当我查找用于评估的 javadoc（用于评估的[javadoc](http://weka.sourceforge.net/doc.dev/weka/classifiers/Evaluation.html)）时，它说 areaUnderROC 需要由 evaluateClassifier 方法设置。不存在这样的方法。其他类似的方法（例如 falsePositive）也可以正常工作。有没有人遇到过这个问题？我在 OldNabble（Weka 的帮助网站）上找不到任何东西。

谢谢！

编辑：澄清一下，测试和训练都是使用以下代码创建的 Instances 对象：

```
private static Instances readFile(File filename) throws IOException
{
CSVLoader loader = new CSVLoader();
loader.setSource(filename);
Instances data = loader.getDataSet();
data.setClassIndex(data.numAttributes() - 1);
return data;
} 
```

它们是从 .csv 文件中读取的。通常，如果测试或训练有问题，则会在此处抛出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T14:02:46.453

再一次，我有自己问题的答案。如果有人不同意这个答案，请告诉我。areaUnderROC 的 weka 文档已经有一个错字（它引用了一个方法，evaluateClassifier，它不存在），导致我走错了方向。我认为还有一个误导性解释形式的错误。areaUnderROC 对两个值有效（不抛出异常）：0 和 1。因此，与其采用类索引（我使用的属性的索引作为 Instances 对象中的类），它真正想要的是哪个类（的两个类）认为是积极的。鉴于文档中的变量名称，我认为乍一看不理解这一点是合理的。*我*也认为，因为它的解释与方法的解释是平行的*取类索引（而不是 0 或 1），这也是一种误导。*

# javascript - 为什么此功能在页面加载时不执行？（如何在页面加载时使用 JavaScript 创建 HTML 选项）

> ID：10406407
> 
> 赞同：0
> 
> 时间：2012-05-02T00:58:06.370
> 
> 标签：javascript

我想填写一个下拉列表，并编写了以下代码：

```
<script language="JavaScript1.2">
window.onload = fillDropDown();

function fillDropDown() {

        var ddl = document.getElementById("dia");
    var theOption = new Option;
    var x;
    var i;

    for(i = 1; i < 32; i++) {
        x = i + 1;
        theOption.text = x;
        theOption.value = x;
        ddl.options[i] = theOption;
    }

}

</script>
   <body>
    <form>
           <select id=dia></select>
    </form>
   <body> 
```

它不起作用，知道为什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T01:00:28.880

您的代码中有一些错误。

**1.**第一个*常见*错误如下：

```
window.onload = fillDropDown(); 
```

前面的代码是注册被调用函数的结果`fillDropDown`，然后将其结果分配给`window.onload`. 因此，这*永远*不会做某事。要注册一个事件，您必须*分配一个函数*，而不是*调用函数的结果*。区别在于：

```
window.onload = fillDropDown; // Without the parentheses. 
```

**2.**我发现的另一个错误是关于`option`元素的创建。在 JavaScript 中创建 HTML 元素的**更好方法是使用***几乎标准的* `document.createElement`函数。

**3.**您的 HTML 标记也有错误。你`select`是这样写的：`<select id=dia></dia>`它应该是`<select id="dia"></select>`;

因此，突出显示所有这些更改后，生成的代码将如下所示：

```
window.onload = fillDropDown;

function fillDropDown() {

    var ddl = document.getElementById("dia");
    var theOption;
    var x;
    var i;

    for (i = 1; i < 32; i++) {
        x = i + 1;
        theOption = document.createElement('option');
        theOption.label = x;
        theOption.value = x;
        ddl.add(theOption, null);
    }

}​ 
```

它就像一个魅力。您可以在此现场演示中看到它的实际效果：http: [//jsfiddle.net/dyjLS/](http://jsfiddle.net/dyjLS/)

**注意：**我**强烈建议**使用 JavaScript 库`jQuery`来执行此操作，因为它可以处理几乎所有跨浏览器的不一致。如果您使用它，您的代码将如下所示：

```
<script type="text/javascript">
  jQuery( document ).ready( function($) {
    var $select = $('#dia');
    for ( var i = 1 ; i < 32 ; i++) {
      var x = i + 1;
      $select.append('<option value='+ x +'>'+ x +'</option>');
    }
  });
</script> 
```

¡瞧！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T01:02:44.077

`<script language="JavaScript1.2">`应该`<script type="text/javascript">`
也`window.onload = fillDropDown();`应该`window.onload = fillDropDown;`

# ios - iOS App Beta Distribution（大规模）

> ID：10406408
> 
> 赞同：0
> 
> 时间：2012-05-02T00:58:07.207
> 
> 标签：ios, distribution, ad-hoc-distribution, beta-testing

我正在开发一个 iOS 应用程序，我的客户希望大约 50 人对其进行 beta 测试。但是，我不想每次都将 UDID 添加到我的开发人员门户帐户并生成新的配置文件。有没有一种方法可以让我分发测试版，而不必经历前面提到的添加新用户的痛苦过程？我在想一些自动的东西！

期待听到您的回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:07:22.927

开发人员门户有一个选项，您可以在其中上传用户的 UDID 列表（查看设备选项卡并单击“上传文件”）。只需准备您的 beta 用户的 UDID 并上传一次，然后您就可以生成一个临时配置文件并以无线方式分发它。

请注意文件格式应为（制表符分隔）：

```
device_id_hex_40_chars    description_text
...                       ... 
```

文件的第一行被忽略，因此您可以添加标题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:53:17.900

使用标准的个人开发者注册，在现有的 OS iOS 设备上测试任何应用程序都需要使用每个设备的 UDID 生成配置文件。没有例外。

因此，您必须继续将 UDID 添加到您的开发人员门户中（或者让 testflight 为您收集它们），或者不再告诉客户。（我会考虑向客户收取足够多的额外费用，以便在初始批次之后添加每个额外的设备，您会很乐意这样做，而不是“痛苦”的任务。）

企业计划只能用于注册开发人员的员工，而不是客户或客户。如果您的客户有 D&B 评级，那么他们可能能够自己注册参加此计划，以便在不收集 UDID 的情况下分发给他们的员工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:22:54.703

如果您愿意支付 299 美元，那么您可以加入 iOS Enterprise Developer 计划并使用 iOS Enterprise 分发版分发应用程序。这使您可以分发给无限数量的用户。

[https://developer.apple.com/programs/ios/enterprise/](https://developer.apple.com/programs/ios/enterprise/)

否则我会建议Testflight。

# c# - IEnumerable 列出

> ID：10406410
> 
> 赞同：4
> 
> 时间：2012-05-02T00:58:32.020
> 
> 标签：c#, c#-4.0

好的，我环顾四周，找不到答案。我有一个返回的方法

```
IEnumerable<ICar> 
```

并且调用方法将方法的结果存储在

```
List<ICar> 
```

但我收到以下错误。

```
System.Collections.Generic.IEnumerable<Test.Interfaces.ICar> to 
System.Collections.Generic.List<Test.Interfaces.ICar>. An explicit conversion exists   
(are you missing a cast?) 
```

我在msdn上看了

```
IEnumerable<T> interface and List<T> class. 
```

以下行来自 msdn。

```
public class List<T> : IList<T>, ICollection<T>, IEnumerable<T>, IList, ICollection,   
IEnumerable 
```

我只是不明白为什么我不能分配

```
IEnumerable<ICar> to List<ICar>. 
```

有人可以向我解释一下吗。我错过了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T01:00:30.690

并非所有`IEnumerable<T>`都是`List<T>`. 反之亦然。

您可以尝试将`List<T>`其转换为不好的做法，如果它确实不是列表，则可能会失败，或者您可以从枚举中创建一个新列表

```
new List<T>(yourEnumerable); 
```

或使用 Linq

```
yourEnumerable.ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T01:01:11.983

`List<ICar>`工具`IEnumerable<ICar>`- 你是对的。但这意味着您可以将 a 隐式转换`List<ICar>`为`IEnumerable<ICar>`-*而不是*相反。要解决您的问题，只需调用`ToList()`将`IEnumerable`其转换为`List`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T01:00:54.813

您可以调用`ToList`将您的转换`IEnumerable<Car>`为`List<Car>`.

```
IEnumerable<ICar> cars = ...;
List<ICar> list = cars.ToList(); // OK 
```

这不会自动发生，因为尽管您可以尝试向下转换`IEnumerable<Car>` 为`List<Car>`：

```
IEnumerable<ICar> cars = ...;
List<ICar> list = (List<ICar>)cars; // Compiles, but could fail at runtime. 
```

没有[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2.aspx)转换运算符，因此 C# 编译器不允许在没有强制转换的情况下进行赋值。向下转型可能会在运行时失败，因此最好`ToList`在大多数情况下使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T01:01:17.797

一个可以`IEnumerable<T>`是一个`List<T>`，但不一定是一个。您可以使用 LINQ`IEnumerable<T>.ToList<T>()`将任何转换`IEnumerable<T>`为`List<T>`

```
IEnumerable<T> foo = ThatMethodYouWereTalkingAbout();
List<T> bar;
if (foo is List<T>)
    bar = (List<T>)foo;
} else {
    bar = new List<T>(foo);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T01:10:13.177

所有列表都是 IEnumerable，但所有 Innumerable 都不是列表。根据[MSDN](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx) IEnumerable

> 公开枚举器，它支持对非泛型集合的简单迭代。

所有 IEnumerable 向您承诺的是您可以获得下一个元素。List 承诺更多：例如，按索引访问，并且它是有限长度的。

这不是 IEnumerable 的情况。例如下面的代码实际上并没有创建一个列表，事实上，你不能从中创建一个列表。每次你要求一个新元素时，它都会给你一个。但它只在被问到时才计算它。：

```
IEnumerable<int> Numbers() {
    int i=0;
    while(true) {
        yield return unchecked(i++);
    }
} 
```

您想调用[ToList](http://msdn.microsoft.com/en-us/library/bb342261.aspx)以获取列表。请注意，这可能会在上述情况下终止。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T02:22:34.973

我们不能通过变量赋值将派生程度较低的类型分配给派生程度较高的类型。那不是类型安全的。

在语言规范中。说话，与 .`List<ICar>`不兼容的分配`IEnumerable<ICar>`。但是，反之亦然。 `IEnumerable<ICar>`是与 兼容的赋值`List<ICar>`。

如果您将分配兼容性可视化为关系，则更有意义。如果 x <= y 为真，则 x >= y 不为真（除非 y = x）。（具体来说，2 < 3 = true 所以 2 > 3 不正确。）

在您的情况下，我们可以将 List of cars 的值分配给 type 的变量`IEnumerable<ICar>`。

如果我们可以将关系表示为

`List<ICar>`<= `IEnumerable<ICar>`= 真。

然后它遵循

`List<ICar>`>= `IEnumerable<ICar>`= 假

这是错误的，因为我们知道的第一个关系是正确的。

# perl - Perl 中 nCk 的高效内联实现

> ID：10406411
> 
> 赞同：-1
> 
> 时间：2012-05-02T00:58:37.557
> 
> 标签：perl, math

是否有任何现有的实现可以在 Perl 中计算这个？

```
 nCk (n choose k), or n!/(k!*(n-k!)) 
```

那只返回一个数字，而不是组合列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T01:00:52.707

[Math::Counting](http://search.cpan.org/perldoc/Math%3a%3aCounting)定义了必要的函数。您可以复制并粘贴以下内容并在没有任何外部模块的情况下使用它：

```
sub combination {
    my( $n, $r ) = @_;
    return unless defined $n && $n =~ /^\d+$/ && defined $r && $r =~ /^\d+$/;
    my $product = 1;
    while( $r > 0 ) {
        $product *= $n--;
        $product /= $r--;
    }
    return $product;
} 
```

但是，对于任意精度，您应该使用[Math::BigInt](http://search.cpan.org/perldoc/Math%3a%3aBigInt)。同样，您可以使用[Math::Counting](http://search.cpan.org/perldoc/Math%3a%3aCounting)中的函数：

```
sub bcomb {
    my( $n, $k ) = @_;
    $n = Math::BigInt->new( $n );
    $k = Math::BigInt->new( $k );
    my $r = $n - $k;
    return $n->bfac() / ($k->bfac() * $r->bfac());
} 
```

# macos - 是否可以从 DTrace 隐藏 OS X 应用程序？

> ID：10406419
> 
> 赞同：0
> 
> 时间：2012-05-02T00:59:36.130
> 
> 标签：macos, dtrace

我正在开发一个 OS X 应用程序，我想隐藏它以防止 DTrace 检查。我知道这个`P_LNOATTACH`标志，但我读过的所有内容都告诉我有办法绕过它。可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T22:52:07.427

如前所述，您可以将 ptrace(2) 与 PT_DENY_ATTACH 一起使用，但 DTrace 或调试器可以拦截这些调用并禁用它们。此外，您希望您的用户在您的程序中使用 DTrace。如果有问题，让他们帮你诊断。唯一真正专有的软件可以在设备和云等受控环境中执行——一旦你把你的比特交给用户，唯一能理解你在做什么的方式就是时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:29:44.107

是的，这是可能的。尝试对 iTunes 运行 DTrace；它不起作用。

您必须使用 PT_DENY_ATTACH 调用 ptrace 函数。

[http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/ptrace.2.html](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/ptrace.2.html)

但是，有各种方法可以使用各种 kext。谷歌周围，你会找到其中的一些。

对于 10.6 和 10.7： [https ://github.com/dwalters/pt_deny_attach](https://github.com/dwalters/pt_deny_attach)

[嗯，由于 ASLR： Detecting and Shirking Off, the Debugger](https://stackoverflow.com/questions/14515042/detecting-and-shirking-off-the-debugger)，看起来它在 10.8 中被破坏了

# jquery - 使用 jQuery 在按钮鼠标悬停时滚动 div

> ID：10406420
> 
> 赞同：0
> 
> 时间：2012-05-02T00:59:47.487
> 
> 标签：jquery, html

当鼠标悬停在另一个上时，我想连续滚动浏览 jQuery 上的一个 div。换句话说，我希望能够有一个名为 right_scroll_bar 的 div 滚动 div scrolling_list：

```
 $('.right_scroll_button').hover(function(){
     $('.scrolling_list').//something to make it scroll continuously    
}); 
```

我尝试设置一个 jsfiddle，但 javascripts 似乎运行不正确.. [http://jsfiddle.net/fjnXn/2/](http://jsfiddle.net/fjnXn/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:09:34.963

听起来您正在尝试创建轮播？如果是这样，不要尝试重新发明轮子，那里有几个不错的免费 jQuery 轮播。其中一个比较流行的似乎是[jCarousel Lite](http://www.gmarwaha.com/jquery/jcarousellite/)。只需[Google](https://www.google.com/search?sourceid=chrome&ie=UTF-8&q=jQuery%20carousel#hl=en&gs_nf=1&tok=J01H0gOnRGisuGKSxJ4J9g&pq=jcarousel%20lite&cp=9&gs_id=1z&xhr=t&q=jquery%20carousel&pf=p&sclient=psy-ab&oq=jquery%20ca&aq=0&aqi=g4&aql=&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.,cf.osb&fp=af35eef1e8b7fba5&biw=1355&bih=784) jQuery Carousel，您就会获得几个感兴趣的主题。

# java - 作为抽象模板方法的类工厂方法

> ID：10406421
> 
> 赞同：1
> 
> 时间：2012-05-02T00:59:48.510
> 
> 标签：java, generics

假设我有一个抽象基类，它有一个生成`Foo`对象的方法（就像工厂方法一样）。现在我的课程看起来像这样：

```
public class Foo
{
}

public class FooBar extends Foo
{
}

public abstract class MyBaseClass
{
    abstract public Foo createObject();
}

public class MyDerivedClass extends MyBaseClass
{
    @Override
    public Foo createObject()
    {
        return new FooBar();
    }
} 
```

这是次优的，因为代码调用`MyBaseClass#createObject`需要将返回值转换回原来的值，即：

```
FooBar fooBar = (FooBar)myDerivedClass.createObject(); 
```

这就像脱下裤子重新穿上一样。

我已经有一段时间没有使用 Java 泛型了，但我希望我可以将抽象方法转换为模板化方法，例如：

```
public abstract class MyBaseClass
{
    abstract public <T extends Foo> T createObject();
} 
```

但是当我尝试在派生类中实现该方法时，我从 Eclipse 收到以下错误：

```
public class MyDerivedClass extends MyBaseClass
{
    @Override
    public <FooBar extends Foo> FooBar createObject() // The type parameter FooBar is hiding the type FooBar
    {
        return new FooBar(); // Cannot instantiate the type FooBar
    }
} 
```

我不认为我正在为减少不必要的演员阵容的问题应用正确的解决方案。有任何想法吗？

这是Java 1.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:03:18.240

您可能正在寻找一个泛型类（而不是泛型方法）：

```
public abstract class MyBaseClass<T extends Foo> {
    public abstract T createObject();
}

public class MyDerivcedClass extends MyBaseClass<FooBar> {
    public FooBar createObject() {
        return new FooBar();
    }
} 
```

要了解有关 Java 泛型的更多信息，我强烈建议您阅读[泛型教程](http://docs.oracle.com/javase/tutorial/java/generics/index.html)。

# c# - 定时器、单击、mousedown、mouseup 事件不能一起工作

> ID：10406422
> 
> 赞同：3
> 
> 时间：2012-05-02T01:00:09.300
> 
> 标签：c#, timer, click, mousedown, mouseup

就我遇到的问题寻求帮助

抱歉，如果这个问题已经被问过，我找不到类似的东西。

这个想法是当点击图片框时将图像更改为ON。

如果按住图片框超过 2 秒以打开新表单并将图片框保持为关闭状态。

但是，如果单击图片框然后按住 2 秒钟然后返回，我需要图片框状态保持打开。

这是我到目前为止所尝试的。

我相信要让它正常工作，我需要阻止 MouseUp 事件的发生。

有没有办法在 Tick 发生时停止 MouseUp？

有没有更简单/更好的方法来做到这一点？

任何帮助，将不胜感激。

```
 private void time_HoldDownInternal_Tick(object sender, EventArgs e)
    { 
        time_HoldDownInternal.Enabled = false;
        time_HoldDownInternal.Interval = 1000;
        form1show.Visible = true;
    }

    private void pb_pictureBoxTest_MouseDown(object sender, MouseEventArgs e)
    {
        mainMenuVariables.mousedown = true;
        time_HoldDownInternal.Enabled = true;
    }

    private void pb_pictureBoxTest_MouseUp(object sender, MouseEventArgs e)
    {
        mainMenuVariables.mousedown = false;
        //MessageBox.Show("mouse up");
        time_HoldDownInternal.Enabled = false;
        time_HoldDownInternal.Interval = 1000;
    }

    private void pb_pictureBoxTest_Click(object sender, EventArgs e)
    {
        if (mainMenuVariables.mousedown == true)
        {
            if (mainMenuVariables.pictureBox == false)
            {
                mainMenuVariables.pictureBox = true;
                pb_pictureBoxTest.Image = new Bitmap(mainMenuVariables.pictureBoxOn);
                return;
            }
            if (mainMenuVariables.pictureBox == true)
            {
                mainMenuVariables.pictureBox = false;
                pb_pictureBoxTest.Image = new Bitmap(mainMenuVariables.pictureBoxOff);
                return;
            }
        }
        if (mainMenuVariables.mousedown == false)
        {
            //nothing
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T01:03:38.350

无需启动计时器，只需在鼠标按下时记录当前时间。然后在鼠标上，检查是否已经 2 秒。例如：

```
private void pb_pictureBoxTest_MouseDown(object sender, MouseEventArgs e)
{
    mainMenuVariables.mousedown = true;
    mainMenuVariables.mousedowntime = DateTime.Now;
}

private void pb_pictureBoxTest_MouseUp(object sender, MouseEventArgs e)
{
    mainMenuVariables.mousedown = false;
    var clickDuration = DateTime.Now - mainMenuVariables.mousedowntime;

    if ( clickDuration > TimeSpan.FromSeconds(2))
    {
        // Do 'hold' logic (e.g. open dialog, etc)
    }
    else
    {
        // Do normal click logic (e.g. toggle 'On'/'Off' image)
    }
} 
```

# php - 如何通过来自 php 的变量更改 jQuery 中的数值

> ID：10406423
> 
> 赞同：0
> 
> 时间：2012-05-02T01:00:18.340
> 
> 标签：php, jquery, mysql

我需要为来自 php.php 的变量替换值 17：

```
$(function() {
 $("#test").paginate({
  count    : 17,
  start    : 1,
  display  : 12,
  border   : true
  ...
 });
}); 
```

我试过这个（没用）：

```
$(function(){
$("#test").paginate({
 count   : $.post("php.php",function(result){ console.log(result['count']) }),
 start   : 1;
 display : 12;
 border  : true
 ...
}); 
```

php.php

```
$query = mysql_query("SELECT * FROM test");
$count = mysql_num_rows($query);
json_encode($count); 
```

我正在尝试这种方式，但我不知道这是否是最好的方式。我感谢任何建议和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:03:15.177

jQuery Ajax 函数是异步的，或者换句话说，立即返回，然后在完成时调用回调。您需要在回调中设置计数，如下所示：

```
$(function(){
    $.post("php.php",function(result){ 
        $("#test").pag({
            count : result
        });
    });
}); 
```

根据我们的评论，对于多个值，您需要类似

```
$(function(){
    $.post("php.php",function(result){ 
        $("#test").pag({
            count : result.count,
            start : result.start,
            display : result.display
        });
    });
}); 
```

PHP：

```
$query = mysql_query("SELECT * FROM test");
$count = mysql_num_rows($query);
echo json_encode(array(
    'count' => $result,
    'start' => 7,
    'display' => 10,
)); 
```

# android - Admob 广告未在 Android 上的黑莓节目中显示

> ID：10406426
> 
> 赞同：0
> 
> 时间：2012-05-02T01:00:33.143
> 
> 标签：android, blackberry-playbook

我将 .apk for android 转换为 .bar。游戏中一切正常，但 admob 广告根本没有显示。谁能告诉我我可以改变什么以使广告在 .bar 文件上可用？我在网上看了，但找不到任何答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T06:53:30.617

我也有同样的问题。似乎只有 mobfox 有 PlayBook 的内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T09:52:57.870

很可能请求已发送，但 Admob 没有任何内容可在 Playbook 上显示。

# ruby-on-rails - 使用 Httparty 将表单数据发送到远程 Rails 应用程序

> ID：10406428
> 
> 赞同：0
> 
> 时间：2012-05-02T01:00:39.723
> 
> 标签：ruby-on-rails, ruby, forms, httparty

我是 Httparty 的新手。我有一个简单的 rails 应用程序，它的默认方法 new，create 用于创建新的 Model 对象。所以基本上如果你以文章控制器为例。第一个新方法通过 Model.new 实例化模型，然后调用部分表单，该表单向用户询问数据，并在提交时调用控制器创建方法。但我的问题是我想使用 Httparty 从不同的 Rails 应用程序远程调用这些方法。所以我首先调用新方法，然后实例化远程模型并将其返回给远程应用程序。在远程应用程序中，我将实例作为 json 获取，但无法将其作为对象模型获取。因此，当我在那里调用 form_for 时，它给了我错误，因为它接受了对我来说位于远程应用程序上并且不是本地的对象模型。有什么解决办法吗？提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T17:41:10.880

好的，我使用 Httparty 本身解决了它。给我带来问题的一件事是 form_for，它与 rails 模型有关。因此，我使用了另一种形式，然后使用 Httparty 发布了数据，在远程应用程序（服务器端）上，我只是检索了每个字段并将其持久化。很简单。现在我是 Httparty 的粉丝了！

# django - Django 中的 Dojo 富编辑器：正确的 admin.py 设置？

> ID：10406434
> 
> 赞同：1
> 
> 时间：2012-05-02T01:01:34.963
> 
> 标签：django, dojo, django-admin, rich-text-editor

我正在建立一个博客，模型“Post”和“Image”如下所示：

```
class Post(models.Model):
    title = models.CharField(max_length=1000)
    author = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    text = models.TextField(max_length=10000)

class Image(models.Model):
    post = models.ForeignKey(Post, related_name='images')
    image = models.ImageField(upload_to='photos/%Y/%m/%d')
    caption = models.CharField(max_length=1000,blank=True) 
```

我一直在尝试按照此处的示例在我的管理站点中实现 Dojo 富编辑器：

[http://lazutkin.com/blog/2011/mar/13/using-dojo-rich-editor-djangos-admin/](http://lazutkin.com/blog/2011/mar/13/using-dojo-rich-editor-djangos-admin/)

但是，我的 admin.py 文件中的设置之间存在某种干扰，这使我无法注册富编辑器和 ModelAdmin 类来上传与“Post”实例关联的图像。如果我在 admin.py 文件中使用以下代码：

```
from django.contrib.admin import site, ModelAdmin
import models

class CommonMedia:
    js = (
      'https://ajax.googleapis.com/ajax/libs/dojo/1.6.0/dojo/dojo.xd.js',
      'editor.js',
    )
    css = {
      'all': ('editor.css',),
    }

site.register(models.Post,
    Media = CommonMedia,
) 
```

富文本编辑器显示良好。但是，如果我为图像上传字段添加一些代码，如下所示：

```
from blogs.models import Post,Image
from django.contrib import admin
from django.contrib.admin import site, ModelAdmin
import models

class CommonMedia:
  js = (
    'https://ajax.googleapis.com/ajax/libs/dojo/1.6.0/dojo/dojo.xd.js',
    'editor.js',
  )
  css = {
    'all': ('editor.css',),
  }

class PostImageInline(admin.TabularInline):
    model = Image
    extra = 5

class PostAdmin(admin.ModelAdmin):
    inlines = [PostImageInline]

site.register(models.Post,
    list_display = ('text',),
    search_fields = ['text',],
    Media = CommonMedia,
)

admin.site.unregister(Post)

admin.site.register(Post, PostAdmin) 
```

富编辑器没有出现。我猜这是由于“admin.site.unregister(Post)”行，但如果我不使用它，我会收到错误消息，“模型 Post 已注册。” 相反，如果我从“admin.site.register(Post, PostAdmin)”中删除该行和“Post”，我会收到错误：“'MediaDefiningClass' object is not iterable”。有谁知道如何解决这个问题，以便我可以在同一页面上同时拥有我的 PostAdmin 和富编辑器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T04:32:19.687

`/home/guillaume/mysite/blogs/static/editor.js`不正确，您应该在此处提供 URL。大概，`/static/editor.js`

此外，使用 chrome/safari 的 web 检查器或 firefox 的 firebug 来捕获控制台中的一些错误。

# c - C、Open MPI：调用 MPI_Finalize() 的分段错误。段错误并不总是发生，尤其是在进程数量较少的情况下

> ID：10406438
> 
> 赞同：4
> 
> 时间：2012-05-02T01:01:46.483
> 
> 标签：c, c99, openmpi

我正在编写一个简单的代码来学习如何定义 MPI_Datatype 并将其与 MPI_Gatherv 结合使用。我想确保我可以在一个进程上组合可变长度、动态分配的结构化数据数组，这似乎工作正常，直到我调用 MPI_Finalize()。我已经确认这是通过使用打印语句和 Eclipse PTP 调试器（后端是 gdb-mi）开始出现问题的地方。我的主要问题是，我怎样才能摆脱分段错误？

每次运行代码时都不会发生段错误。例如，2 或 3 个进程不会发生这种情况，但当我使用大约 4 个或更多进程运行时往往会定期发生。

此外，当我使用 valgrind 运行此代码时，不会发生分段错误。但是，我确实收到了来自 valgrind 的错误消息，尽管当我使用 MPI 函数时输出对我来说很难理解，即使有大量的目标抑制也是如此。我还担心如果我使用更多的抑制，我会忽略一个有用的错误消息。

我使用这些标志编译正常代码，因此在这两种情况下我都使用 C99 标准：-ansi -pedantic -Wall -O2 -march=barcelona -fomit-frame-pointer -std=c99 和调试代码：-ansi -pedantic -std=c99 -Wall -g

两者都使用 gcc 4.4 mpicc 编译器，并在使用 Red Hat Linux 和 Open MPI v1.4.5 的集群上运行。如果我遗漏了其他重要信息，请告诉我。这是代码，在此先感谢：

```
//#include <unistd.h>
#include <string.h>
#include <stdio.h>
#include <math.h>
#include <stdlib.h>
//#include <limits.h>

#include "mpi.h"

#define FULL_PROGRAM        1

struct CD{

    int int_ID;
    double dbl_ID;
};

int main(int argc, char *argv[]) {

    int numprocs, myid, ERRORCODE;

#if FULL_PROGRAM
    struct CD *myData=NULL;             //Each process contributes an array of data, comprised of 'struct CD' elements
    struct CD *allData=NULL;            //root will dynamically allocate this array to store all the data from rest of the processes
    int *p_lens=NULL, *p_disp=NULL;     //p_lens stores the number of elements in each process' array, p_disp stores the displacements in bytes
    int MPI_CD_size;                    //stores the size of the MPI_Datatype that is defined to allow communication operations using 'struct CD' elements

    int mylen, total_len=0;             //mylen should be the length of each process' array
                                        //MAXlen is the maximum allowable array length
                                        //total_len will be the sum of mylen across all processes

    // ============ variables related to defining new MPI_Datatype at runtime ====================================================
    struct CD sampleCD = {.int_ID=0, .dbl_ID=0.0};
    int blocklengths[2];                //this describes how many blocks of identical data types will be in the new MPI_Datatype
    MPI_Aint offsets[2];                //this stores the offsets, in bytes(bits?), of the blocks from the 'start' of the datatype
    MPI_Datatype block_types[2];        //this stores which built-in data types the blocks are comprised of
    MPI_Datatype  myMPI_CD;             //just the name of the new datatype
    MPI_Aint myStruct_address, int_ID_address, dbl_ID_address, int_offset, dbl_offset;  //useful place holders for filling the arrays above
    // ===========================================================================================================================
#endif
    // =================== Initializing MPI functionality ============================
    MPI_Init(&argc, &argv);
    MPI_Comm_size(MPI_COMM_WORLD, &numprocs);
    MPI_Comm_rank(MPI_COMM_WORLD, &myid);
    // ===============================================================================
#if FULL_PROGRAM
    // ================== This part actually formally defines the MPI datatype ===============================================
    MPI_Get_address(&sampleCD, &myStruct_address);          //starting point of struct CD
    MPI_Get_address(&sampleCD.int_ID, &int_ID_address);     //starting point of first entry in CD
    MPI_Get_address(&sampleCD.dbl_ID, &dbl_ID_address);     //starting point of second entry in CD
    int_offset = int_ID_address - myStruct_address;         //offset from start of first to start of CD
    dbl_offset = dbl_ID_address - myStruct_address;         //offset from start of second to start of CD

    blocklengths[0]=1;  blocklengths[1]=1;                  //array telling it how many blocks of identical data types there are, and the number of entries in each block
    //This says there are two blocks of identical data-types, and both blocks have only one variable in them

    offsets[0]=int_offset;  offsets[1]=dbl_offset;          //the first block starts at int_offset, the second block starts at dbl_offset (from 'myData_address'

    block_types[0]=MPI_INT; block_types[1]=MPI_DOUBLE;      //the first block contains MPI_INT, the second contains MPI_DOUBLE

    MPI_Type_create_struct(2, blocklengths, offsets, block_types, &myMPI_CD);       //this uses the above arrays to define the MPI_Datatype...an MPI-2 function

    MPI_Type_commit(&myMPI_CD);     //this is the final step to defining/reserving the data type
    // ========================================================================================================================

    mylen   = myid*2;       //each process is told how long its array should be...I used to define that randomly but that just makes things messier

    p_lens  = (int*)        calloc((size_t)numprocs,    sizeof(int));       //allocate memory for the number of elements (p_lens) and offsets from the start of the recv buffer(d_disp)
    p_disp  = (int*)        calloc((size_t)numprocs,    sizeof(int));

    myData  = (struct CD*)  calloc((size_t)mylen,       sizeof(struct CD));         //allocate memory for each process' array
    //if mylen==0, 'a unique pointer to the heap is returned'

    if(!p_lens) {   MPI_Abort(MPI_COMM_WORLD, 1); exit(EXIT_FAILURE);   }
    if(!p_disp) {   MPI_Abort(MPI_COMM_WORLD, 1); exit(EXIT_FAILURE);   }
    if(!myData) {   MPI_Abort(MPI_COMM_WORLD, 1); exit(EXIT_FAILURE);   }

    for(double temp=0.0;temp<1e6;++temp) temp += exp(-10.0);
    MPI_Barrier(MPI_COMM_WORLD);                                //purely for keeping the output organized by give a delay in time

    for (int k=0; k<numprocs; ++k) {

        if(myid==k) {

            //printf("\t ID %d has %d entries: { ", myid, mylen);

            for(int i=0; i<mylen; ++i) {

                myData[i]= (struct CD) {.int_ID=myid*(i+1), .dbl_ID=myid*(i+1)};            //fills data elements with simple pattern
                //printf("%d: (%d,%lg) ", i, myData[i].int_ID, myData[i].dbl_ID);
            }
            //printf("}\n");
        }
    }

    for(double temp=0.0;temp<1e6;++temp) temp += exp(-10.0);
    MPI_Barrier(MPI_COMM_WORLD);                            //purely for keeping the output organized by give a delay in time

    MPI_Gather(&mylen,  1, MPI_INT, p_lens, 1, MPI_INT, 0, MPI_COMM_WORLD);     //Each process sends root the length of the vector they'll be sending

#if 1
    MPI_Type_size(myMPI_CD, &MPI_CD_size);          //gets the size of the MPI_Datatype for p_disp
#else
    MPI_CD_size = sizeof(struct CD);                //using this doesn't change things too much...
#endif

    for(int j=0;j<numprocs;++j) {

        total_len += p_lens[j];

        if (j==0)   {   p_disp[j] = 0;                                      }
        else        {   p_disp[j] = p_disp[j-1] + p_lens[j]*MPI_CD_size;    }
    }

    if (myid==0)    {

        allData = (struct CD*)  calloc((size_t)total_len,   sizeof(struct CD));     //allocate array
        if(!allData)    {   MPI_Abort(MPI_COMM_WORLD, 1); exit(EXIT_FAILURE);   }
    }

    MPI_Gatherv(myData, mylen, myMPI_CD, allData, p_lens, p_disp, myMPI_CD, 0, MPI_COMM_WORLD); //each array sends root process their array, which is stored in 'allData'

    // ============================== OUTPUT CONFIRMING THAT COMMUNICATIONS WERE SUCCESSFUL=========================================
    if(myid==0) {

        for(int i=0;i<numprocs;++i) {
            printf("\n\tElements from %d on MASTER are: { ",i);
            for(int k=0;k<p_lens[i];++k)    {   printf("%d: (%d,%lg) ", k, (allData+p_disp[i]+k)->int_ID, (allData+p_disp[i]+k)->dbl_ID);   }

            if(p_lens[i]==0) printf("NOTHING ");
            printf("}\n");
        }
        printf("\n");       //each data element should appear as two identical numbers, counting upward by the process ID
    }
    // ==========================================================================================================

    if (p_lens) {   free(p_lens);   p_lens=NULL;    }       //adding this in didn't get rid of the MPI_Finalize seg-fault
    if (p_disp) {   free(p_disp);   p_disp=NULL;    }
    if (myData) {   free(myData);   myData=NULL;    }
    if (allData){   free(allData);  allData=NULL;   }       //the if statement ensures that processes not allocating memory for this pointer don't free anything

    for(double temp=0.0;temp<1e6;++temp) temp += exp(-10.0);
    MPI_Barrier(MPI_COMM_WORLD);                            //purely for keeping the output organized by give a delay in time
    printf("ID %d: I have reached the end...before MPI_Type_free!\n", myid);

    // ====================== CLEAN UP ================================================================================
    ERRORCODE = MPI_Type_free(&myMPI_CD);           //this frees the data type...not always necessary, but a good practice

    for(double temp=0.0;temp<1e6;++temp) temp += exp(-10.0);
    MPI_Barrier(MPI_COMM_WORLD);                                //purely for keeping the output organized by give a delay in time

    if(ERRORCODE!=MPI_SUCCESS)  {   printf("ID %d...MPI_Type_free was not successful\n", myid); MPI_Abort(MPI_COMM_WORLD, 911); exit(EXIT_FAILURE); }
    else                        {   printf("ID %d...MPI_Type_free was successful, entering MPI_Finalize...\n", myid);       }
#endif
    ERRORCODE=MPI_Finalize();

    for(double temp=0.0;temp<1e7;++temp) temp += exp(-10.0);        //NO MPI_Barrier AFTER MPI_Finalize!

    if(ERRORCODE!=MPI_SUCCESS)  {   printf("ID %d...MPI_Finalize was not successful\n", myid);  MPI_Abort(MPI_COMM_WORLD, 911); exit(EXIT_FAILURE); }
    else                        {   printf("ID %d...MPI_Finalize was successful\n", myid);      }

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T15:45:05.987

k 上的外部循环是假的，但在技术上并没有*错*——它只是没用。

真正的问题是您对 MPI_GATHERV 的位移是错误的。如果你通过 valgrind 运行，你会看到如下内容：

```
==28749== Invalid write of size 2
==28749==    at 0x4A086F4: memcpy (mc_replace_strmem.c:838)
==28749==    by 0x4C69614: unpack_predefined_data (datatype_unpack.h:41)
==28749==    by 0x4C6B336: ompi_generic_simple_unpack (datatype_unpack.c:418)
==28749==    by 0x4C7288F: ompi_convertor_unpack (convertor.c:314)
==28749==    by 0x8B295C7: mca_pml_ob1_recv_frag_callback_match (pml_ob1_recvfrag.c:216)
==28749==    by 0x935723C: mca_btl_sm_component_progress (btl_sm_component.c:426)
==28749==    by 0x51D4F79: opal_progress (opal_progress.c:207)
==28749==    by 0x8B225CA: opal_condition_wait (condition.h:99)
==28749==    by 0x8B22718: ompi_request_wait_completion (request.h:375)
==28749==    by 0x8B231E1: mca_pml_ob1_recv (pml_ob1_irecv.c:104)
==28749==    by 0x955E7A7: mca_coll_basic_gatherv_intra (coll_basic_gatherv.c:85)
==28749==    by 0x9F7CBFA: mca_coll_sync_gatherv (coll_sync_gatherv.c:46)
==28749==  Address 0x7b1d630 is not stack'd, malloc'd or (recently) free'd 
```

表明 MPI_GATHERV 以某种方式获得了错误信息。

（还有其他来自 Open MPI 中的 libltdl 的 valgrind 警告，不幸的是，这是不可避免的——这是 libltdl 中的一个错误，另一个来自 PLPA，不幸的是，这也是不可避免的，因为它是故意这样做的[出于没有兴趣讨论的原因这里]）

看着你的位移计算，我明白了

```
 total_len += p_lens[j];                                                              

    if (j == 0) {                                                                        
        p_disp[j] = 0;                                                                   
    } else {                                                                             
        p_disp[j] = p_disp[j - 1] + p_lens[j] * MPI_CD_size;                             
    } 
```

但是 MPI 聚集位移以数据类型为单位，而不是字节。所以它真的应该是：

```
p_disp[j] = total_len;
total_len += p_lens[j]; 
```

进行此更改使 MPI_GATHERV valgrind 警告对我来说消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T15:27:41.593

'k' 循环上的这个外部是假的。它的主体仅针对 k=myid 执行（对于每个正在运行的进程来说都是一个常量）。k 永远不会在循环内被引用（除了与几乎恒定的 myid 的比较）。此外，该行`mylen = myid*2;`不赞成。我建议您将其更改为常量。

```
 for (int k=0; k<numprocs; ++k) {

    if(myid==k) {

        //printf("\t ID %d has %d entries: { ", myid, mylen);

        for(int i=0; i<mylen; ++i) {

            myData[i]= (struct CD) {.int_ID=myid*(i+1), .dbl_ID=myid*(i+1)};            //fills data elements with simple pattern
            //printf("%d: (%d,%lg) ", i, myData[i].int_ID, myData[i].dbl_ID);
        }
        //printf("}\n");
    }
} 
```

，因此（假设 myid 介于 0 和 numprocs 之间）整个愚蠢的构造可以简化为：

```
for(int i=0; i<mylen; ++i) {
        myData[i].int_ID=myid*(i+1);
        myData[i].dbl_ID=myid*(i+1);  
        } 
```

# validation - UPS 地址验证 API 是否适用于移动应用程序？

> ID：10406442
> 
> 赞同：0
> 
> 时间：2012-05-02T01:02:43.450
> 
> 标签：validation, street-address, ups

我正在为我的 PHP 应用程序学习 UPS 地址验证 API。将使用 Web 服务版本进行我的集成。但是，我不确定 UPS 地址验证是否适用于移动应用程序，如 iPhone 或 Android 应用程序。有人可以详细回答我这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:36:13.137

为了补充 Matt 的评论，UPS 地址验证和官方邮政（例如 USPS、加拿大邮政）地址可能不同，因此除了服务条款外，请确保您从正确的数据中提取。

# c# - 将表保存到 XML 文件

> ID：10406448
> 
> 赞同：1
> 
> 时间：2012-05-02T01:03:22.450
> 
> 标签：c#, xml, asp.net-mvc-3, sql-server-2008

我目前正在做一个网站。我被要求允许管理员将数据库中的表保存为 XML 文件（以便他们可以从浏览器下载）。

我什至不知道从哪里开始。我已经进行了多个小时的研究，但这个过程似乎没有很好的记录。我会很感激一些正确方向的指示，或者如果可能的话，更深入的解释。

我将如何设置我的文件？如何让他们下载该文件而不是将其保存到我的应用程序中？我什至如何将其保存到 XML 文件中以启动？

我在网上看到了一些关于将数据库备份到 XML 文件中的内容，但我觉得这是不同的，因为它允许用户下载数据库文件而不是开发人员制作数据库文件。

**编辑**

为清楚起见，XML 应该类似于数据库。因此，如果我有一个产品（或多个产品），我希望 XML 看起来类似于以下内容：

```
<product>
     <title>
          My Product
     </title>
     <price>
          5.00
     </price>
     <quantity>
          4
     </quantity>
     <description>
          This is my product!
     </description>
</product> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T01:15:12.400

您可能想要的查询是：

```
SELECT col1, col2, col3 etc.
  FROM dbo.TableName
  FOR XML AUTO, ELEMENTS; 
```

在 Management Studio 中运行它以查看它返回的内容。我认为您需要将问题分成多个部分。这就是从表中生成 XML 的方式。另一个问题是如何从 C# 中使用它并将其保存到文件中。这些问题可能会给您一个良好的开端，但我不知道您是否需要在 MVC3 中做一些不同的事情（我知道如何拼写，但其他不多）：

[如何将此字符串保存到 XML 文件中？](https://stackoverflow.com/questions/4721735/how-to-save-this-string-into-xml-file)

[以缩进格式将 xml 字符串或 XmlNode 保存到文本文件？](https://stackoverflow.com/questions/816109/save-xml-string-or-xmlnode-to-text-file-in-indent-format)

# .htaccess - mod_rewrite：从 url URL 的末尾删除查询字符串

> ID：10406450
> 
> 赞同：2
> 
> 时间：2012-05-02T01:03:32.553
> 
> 标签：.htaccess, mod-rewrite, redirect

我正在尝试仅对 mp3、jpg、jpeg、png 和 gif 文件使用 .htaccess 进行以下重定向 (301)。

`http://website.com/file.jpg?c=XXXX`被替换为`http://website.com/file.jpg`

基本上，我想从媒体网址的末尾删除查询（即“？c = XXXX”）。我想阻止任何人访问 URL 末尾带有“?c=XXXX”的图像或 mp3，而是将他们定向到相同的文件 url 减去“?c=XXXX”。

有没有一种快速的方法来做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:15:45.067

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{QUERY_STRING} !^$
RewriteRule \.(mp3|jpe?g|png|gif)$ %{REQUEST_URI}? [L,R] 
```

# google-analytics - 哈希信号和谷歌分析

> ID：10406454
> 
> 赞同：2
> 
> 时间：2012-05-02T01:03:47.630
> 
> 标签：google-analytics

我目前正在一个使用哈希信号进行页面加载的网站上工作。这意味着页面“加载”很少，但有很多 ajax 内容更改和模板操作。

我的问题是：我如何使用谷歌分析来跟踪这个？有没有办法可以在我的代码中触发 GA 调用来捕获整个 url，包括哈希和任何其他参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T11:22:00.947

当页面更新时，Hashsignaling`hashsignal.hashchange`在对象上触发一个事件：`window`

```
$(window).trigger('hashsignal.hashchange', [subhash]); 
```

因此，您可以使用以下内容将 Google Analytics 跟踪调用绑定到此事件：

```
$(window).on('hashsignal.hashchange', function(event, subhash){
    _gaq.push(['_trackPageview', subhash]);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:37:49.520

这取决于您希望如何在 GA 中表示您的网站活动，但您可以决定您希望将什么限定为“页面浏览”，并在活动发生时随时调用包含 URL 作为参数的[_trackPageview()方法：](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiBasicConfiguration#_gat.GA_Tracker_._trackPageview)

```
_gaq.push(['_trackPageview', 'YOUR URL HERE']); 
```

# c# - DrEdit 示例无法打开 txt 文件

> ID：10406456
> 
> 赞同：1
> 
> 时间：2012-05-02T01:03:54.463
> 
> 标签：c#, google-drive-api

我将一个 .txt 文件复制到我的 google 驱动器并尝试使用 DrEdit C# 示例打开它。当我尝试打开文件时，ASP.NET 服务器从服务器收到 403 禁止响应。响应正文说：

`The authenticated user has not installed the app with client id 229016086359-m19r73ngg9pr863m5h7eso151kcc2uut.apps.googleusercontent.com [403]`

我也无法使用示例保存新文件。我想我很接近，但不确定是什么导致了这个问题。文档对配置设置并不完全清楚，所以我可能弄错了其中一个，这就是我正在做的事情：

1.  ClientCredentials.cs - CLIENT_ID - 设置为“API 访问”页面上“Drive SDK 的客户端 ID”部分中的“客户端 ID”值
2.  ClientCredentials.cs - CLIENT_SECRET - 设置为“API 访问”页面上“Drive SDK 的客户端 ID”部分中的“客户端密码”值
3.  ClientCredentials.cs - REDIRECT_URI - 设置为我的 ASP.NET 应用程序的基本 URL
4.  dredit.js - 第 104 行的 setAppId('') - 在 Drive SDK 页面上设置为“App Id:”的值
5.  manifest.json - app_console_project_id - 在 Drive SDK 页面上设置为“App Id:”的值

我确实通过 chrome 网上商店上传了该应用程序，发布到测试帐户并从 chrome 网上商店安装了该应用程序。这是我正在做的事情：

1.  启动应用程序（从网上商店或通过 URL）。
2.  在请求权限屏幕上允许访问
3.  关闭 untitled.txt 的编辑详细信息对话框
4.  单击打开按钮 - 它显示了我从 Windows 处理到谷歌驱动器的文本文件
5.  双击文本文件，它会显示空白的编辑屏幕，顶部有一个“加载”按钮。网络流量显示我收到 500 内部服务器错误，响应正文显示 403 正在从谷歌驱动器返回到 ASP.NET 应用程序

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T16:37:43.587

我认为您使用了错误的客户端 ID 和密钥。

复制 API 控制台中“Web 应用程序的客户端 ID”部分中的值，而不是“Drive SDK 的客户端 ID”部分中的值。

我们正在更新我们的文档以使这一步更加清晰，谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:58:08.580

请检查您是否已在 API 控制台中启用了 Google Drive API 和 SDK。

更多建议，[为什么我在本地使用 Google Drive API 时收到“经过身份验证的用户没有安装带有客户端 ID 的应用程序”错误？](https://stackoverflow.com/questions/10345904/why-am-i-getting-the-authenticated-user-has-not-installed-the-app-with-client-i)和[Google Drive 身份验证问题](https://stackoverflow.com/questions/10362853/google-drive-authentication-issues)

# azure - 我应该使用哪个 Azure 角色？

> ID：10406463
> 
> 赞同：3
> 
> 时间：2012-05-02T01:05:56.067
> 
> 标签：azure, azure-worker-roles, azure-web-roles

我正在计划一个将移动应用程序作为前端的应用程序（也许还有一个执行不同目的的 Web 前端）。Runkeeper 或 Runtastic 之类的东西，如果您熟悉这些应用程序的话。移动设备是用户交互的主要方式，网站有统计数据和仪表板，用户之后可以查看。

我希望主应用程序驻留在 Windows Azure 中。不过，我对如何构建应用程序感到困惑——业务逻辑应该驻留在 Web 角色还是工作者角色中？如果主用户界面是移动应用程序，它是连接到辅助角色以保存或检索数据，还是连接到 Web 角色，或者两者都不连接？我了解一个典型的场景，其中 Web 角色提供了一个用户界面，该界面可以将数据直接保存到存储中，或者将数据传递到队列或表格以供辅助角色获取，但是移动应用程序的存在让我感到厌烦。

有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T04:27:46.920

安迪的回答很好，但让我添加一个不同的味道。Web 角色和辅助角色之间的*唯一*区别是 Web 角色会自动打开和配置 IIS。一个好的经验法则是，如果您需要 IIS，请使用 Web 角色。如果您不需要 IIS，请使用辅助角色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:12:14.080

对于托管移动应用程序连接的服务器组件，我认为最简单的方法是托管 ASP.NET Web 应用程序的 Web 角色。Web 应用程序可用于服务以及 Web 前端 (HTML) 网站。

[ASP.NET MVC](http://www.asp.net/mvc)和[Web API](http://www.asp.net/web-api)使设置 Web 服务变得非常容易，并且很容易使用非 HTML 数据格式，例如 JSON 或 XML。您的移动应用程序可以使用 REST JSON API 与 Web 应用程序进行通信，或者如果您愿意，也可以使用 XML/SOAP 或任何您想要的格式。以 JSON 作为传输格式的 REST API 可能是目前最流行的。考虑 Web 应用程序的一种方式是，它只是一种从客户端发送和接收数据的方式。如果客户端是 Web 浏览器，您可以将内容作为 HTML 页面提供，或者如果您的客户端是移动应用程序，您可以将数据作为 JSON 提供，并让客户端根据需要显示它。基本上，您的网络应用程序既可以是您的网站 (HTML)，也可以是非网络浏览器客户端的“API”。

您可以将工作角色想象成类似于 Windows 服务的角色。它们主要用于进行后端处理等。工作者角色可能会提供一些能力来托管面向公众的 API，但您必须自己管理连接、消息管道、回收以及所有这些；而 Web 角色将提供一个 Web 服务器 (IIS) 来管理连接等。如果您要引入消息队列之类的东西，则将面向公众的 API 设置为 Web 角色是有意义的，并且消息处理组件一个工作者角色。Web 应用程序可以通过 REST JSON API 接收来自客户端的消息，然后将消息传递到队列，由工作角色接收。

# javascript - 在 Google Maps Javascript API v2（适用于营业执照）中，如何正确调用 Maps API？

> ID：10406474
> 
> 赞同：0
> 
> 时间：2012-05-02T01:08:53.047
> 
> 标签：javascript, api, google-maps

我正在使用 Google Maps API for Business 版本。所以，按照这个文件。 [https://developers.google.com/maps/documentation/business/clientside#v2](https://developers.google.com/maps/documentation/business/clientside#v2) （当然，我在 Google Maps Admin 中注册了我的网站 URL。）

但是，我在下面得到了这个错误。

> Google Maps API 服务器拒绝了您的请求。请求中指定的“client”参数无效。

当我使用 javascript API v3 时，没有问题。

在营业执照中，我不能使用 javascript API v2 吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:55:41.323

V2 应用程序需要许可证密钥或客户端参数。根据您的 Maps API for Business 许可，将客户端参数分配给贵公司的特定 URL。如果您有一个客户端参数，但它不起作用，您应该联系 Google Enterprise 支持：

[http://support.google.com/enterprisehelp/bin/answer.py?hl=en&answer=142858&rd=1](http://support.google.com/enterprisehelp/bin/answer.py?hl=en&answer=142858&rd=1)

# jquery - jquery自动完成显示id而不是标签

> ID：10406476
> 
> 赞同：5
> 
> 时间：2012-05-02T01:09:32.210
> 
> 标签：jquery, autocomplete

我正在使用 jquery 的自动完成功能，它工作得很好，除了当我从下拉列表中选择某些内容时，输入字段会填充值而不是标签。

我的代码如下：

```
 <?php
   $query =     mysql_query("SELECT users.* FROM users JOIN peers ON peers.peer = users.user_id WHERE peers.user_id = '".$_SESSION['id']."'")or  die(mysql_error());
   $count   =   mysql_num_rows($query);
   $i   =   0;

   while($row = mysql_fetch_assoc($query))
   {
       $first[$i]   =   $row['first_name'];
       $last[$i]    =   $row['last_name'];
       $user_id[$i] = $row['user_id'];

       $i++;
   }

$data = "";

for($i=0;$i<$count;$i++)
{
    if($i != ($count-1))
    {
        $data .= '{ value: '.$user_id[$i].', label: "'.$first[$i].' '.$last[$i].'" }, ';
    } else
    {
        $data .= '{ value: '.$user_id[$i].', label: "'.$first[$i].' '.$last[$i].'" }';
    }
}
?>
<script type="text/javascript">
$("#auto").autocomplete({ 
    source: data,
    select: function(event, ui)
    {
        var id = ui.item.value;
        var name = ui.item.label;
    }
  });
  </script>

  <input type="text" value="Enter a connection's name" id="auto" /> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-18T11:03:48.207

select 事件的默认行为是使用 ui.item.value 更新输入。此代码在您的事件处理程序之后运行。

只需返回 false 或调用 event.preventDefault() 即可防止这种情况发生。试试这个，

```
<script type="text/javascript">
    $("#auto").autocomplete({ 
        source: data,
        select: function(event, ui)
        {
           var id = ui.item.value;
           var name = ui.item.label;
           $("#auto").val(name);
           return false;
        },
        focus: function(event, ui){
          return false;
        }
   });
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:14:06.533

您可以尝试将第`label`一个放在数组中，也可以在[.autocomplete() 上使用自定义结果](http://jqueryui.com/demos/autocomplete/#custom-data)`value`查看 jQuery 文档中的此代码：

```
<script>
$(function() {
    var projects = [
        {
            value: "jquery",
            label: "jQuery",
            desc: "the write less, do more, JavaScript library",
            icon: "jquery_32x32.png"
        },
        {
            value: "jquery-ui",
            label: "jQuery UI",
            desc: "the official user interface library for jQuery",
            icon: "jqueryui_32x32.png"
        },
        {
            value: "sizzlejs",
            label: "Sizzle JS",
            desc: "a pure-JavaScript CSS selector engine",
            icon: "sizzlejs_32x32.png"
        }
    ];

    $( "#project" ).autocomplete({
        minLength: 0,
        source: projects,
        focus: function( event, ui ) {
            $( "#project" ).val( ui.item.label );
            return false;
        },
        select: function( event, ui ) {
            $( "#project" ).val( ui.item.label );
            $( "#project-id" ).val( ui.item.value );
            $( "#project-description" ).html( ui.item.desc );
            $( "#project-icon" ).attr( "src", "images/" + ui.item.icon );

            return false;
        }
    })
    .data( "autocomplete" )._renderItem = function( ul, item ) {
        return $( "<li></li>" )
            .data( "item.autocomplete", item )
            .append( "<a>" + item.label + "<br>" + item.desc + "</a>" )
            .appendTo( ul );
    };
});
</script>

<div class="demo">
<div id="project-label">Select a project (type "j" for a start):</div>
<img id="project-icon" src="/demos/autocomplete/images/transparent_1x1.png"  class="ui-state-default"//>
<input id="project"/>
<input type="hidden" id="project-id"/>
<p id="project-description"></p>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-04T15:58:38.507

自动完成选择事件的默认行为是用值而不是文本填充输入字段

但是您可以使用以下代码使用选择文本以及向下滚动选项来更新输入字段。

```
<script type="text/javascript">
    $("#auto").autocomplete({ 
        source: data,
        select: function(event, ui)
        {
           var id = ui.item.value;
           var text = ui.item.label;
           $("#auto").val(name);
           return false;
        },
        focus: function (event, ui) {
                $("#auto").val(ui.item.label);
                return false;
            }
    });
</script> 
```

# java - 动态加载的 JAR/等。在同一个 JVM 容器中

> ID：10406482
> 
> 赞同：0
> 
> 时间：2012-05-02T01:10:38.637
> 
> 标签：java, tomcat, jvm

我有一个有点奇怪的问题，我可能措辞不正确，但想法是：我将 WAR 部署在与少数第三方系统集成的 Tomcat 容器中。

我希望每个第三方系统的实现都部署在同一个 Tomcat（JVM 容器）中。可能是一个 JAR。我希望 WAR 真正有效地使用这个 JAR（速度、负载、内存使用等）。我不想在添加新 JAR 时重新启动 Tomcat。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:54:44.137

您不能在不重新加载的情况下安全地动态添加/更新 JAR。在某些非常特殊的情况下，您可能会通过添加新的 JAR 来侥幸成功，但这种情况很偶然。

您能做到的最好的方法是将 JAR 添加到 WEB-INF/lib 并重新加载 Web 应用程序（而不是重新启动 Tomcat）。最终用户可能会在 Web 应用程序重新启动时看到请求处理暂停，但您应该不会看到任何丢弃的请求。请注意，这只适用于更新使用 Web 应用程序部署的类和 JAR。如果您更改 WEB-INF/web.xml 或 META-INF/context.xml，应用程序仍将重新加载，但可能会丢弃请求。

# api - Facebook API 在没有 Oauth 的页面上发布

> ID：10406488
> 
> 赞同：1
> 
> 时间：2012-05-02T01:11:09.157
> 
> 标签：api, facebook-graph-api

Facebook 是否提供 API 以在不使用 Oauth 的情况下发布到 Facebook 页面？

例如，如果有人在我的网站上提交了一些东西，我想自动发布到我的 Facebook 页面上提及它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:50:18.863

您不能，您需要页面的活动访问令牌才能发布此类帖子；让其中一位管理员授予您的应用 manage_pages 权限并获取页面的页面访问令牌 - 将其存储在您的代码中并使用它进行更新。当它过期时，让管理员回到你的应用程序，你可以检索一个新的令牌

[https://developers.facebook.com/docs/authentication/pages/](https://developers.facebook.com/docs/authentication/pages/)有完整的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:21:04.310

如果您有一个应用程序，您可以跳过每个用户的身份验证，只需使用应用程序的令牌即可。

请参见：

[http://developers.facebook.com/docs/authentication/applications/](http://developers.facebook.com/docs/authentication/applications/)

“我想自动发布到我的 Facebook 页面上提及它。” 您可能必须让您的应用使用您的身份验证才能发布到您的墙/页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:35:37.180

Coracast 有一个 API，基本上可以让你做到这一点，你可以通过简单的表单发布/获取请求发布到他们的 API，然后他们从他们身边推送到 Facebook。

# javascript - 如何确定 div 之间是什么？

> ID：10406490
> 
> 赞同：0
> 
> 时间：2012-05-02T01:11:38.640
> 
> 标签：javascript, jquery

听起来像一个简单的问题：

我们必须类似的div：

*   `<div class='child'></div>`
*   `<div class='child'>SMTH SMTH</div>`

如何确定第一个具有 0 值而第二个已填充？是否有任何特定的 jQuery 或 JS 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:15:20.630

使用[`empty`选择器](http://api.jquery.com/empty-selector/)，可能结合使用[`is`](http://api.jquery.com/is/)来确定是否*至少有一个*匹配的元素满足给定的选择器。

```
var empty = $(".child:empty"); // gets empty elements with class child
var isEmpty $(".child").first().is(":empty"); // determines if the first .child div is empty. 
```

**示例：http:** [//jsfiddle.net/andrewwhitaker/txeEE/](http://jsfiddle.net/andrewwhitaker/txeEE/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:16:39.693

是的，您可以使用`test()`jQuery 或`innerHTML`DOM`textContent`指定的 API。

```
<div class="child"><b>test</b> content</div>

<script>
    var child = document.querySelector('.child');
    alert(child.innerHTML); // <b>test</b> content
    alert(child.textContent); // test content

    var $child = $('.child');
    alert($child.text()); // test content
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:39:18.053

支持 W3C DOM 核心方法的浏览器中有[textContent](http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#Node3-textContent)属性，支持 IE 模型的浏览器有[innerText属性。](http://msdn.microsoft.com/en-us/library/ms533899%28v=vs.85%29.aspx)一些浏览器同时支持两者。

所以你可以这样做：

```
if (!(el.textContent || el.innerText)) {
  // element has no text content
} 
```

# c++ - 为什么g ++在完全相同的文件上失败，但在不同的计算机上

> ID：10406491
> 
> 赞同：0
> 
> 时间：2012-05-02T01:12:02.427
> 
> 标签：c++, g++

我确定我做错了什么，但是...我在一台计算机上处​​理了一个 c++ 项目，安装了相同版本的 Ubuntu，相同版本的 g++，它在那里编译得很好。我将文件放入 DropBox 文件夹中，这样我就可以在家中处理它，这里有完全相同的文件，并且完全相同的 g++ 命令会导致错误。它给了我几个“' *_* '的多重定义”错误。

有谁知道我在这里做错了什么？

示例错误：

```
g++ -o*.C *.cpp

/tmp/ccdFZtkq.o:(.bss+0x718): multiple definition of `done' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:07:48.030

问题是 DropBox 正在将后缀附加到我最能描述为处于“中间”状态的文件中。DropBox 还创建了没有处于中间状态的后缀的文件。我仍然不确定发生了什么，但有时当 g++ 运行时，它同时使用了中间文件和非中间文件，因此遇到了多次加载基本相同文件的问题。

我通过从 DropBox 文件夹中删除文件并重新编译来解决我的问题，然后工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:32:55.447

做一个干净的构建。删除所有旧的目标文件并再次编译。

```
rm -rf *.o
g++ -o *.C *.cpp 
```

我的*猜测引擎*没油了。除非您显示有关 DropBox 中的文件、声明和定义`done`等的一些代码和信息，否则无法给出更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:19:00.700

你在你的 shell 中输入这个：

```
g++ -o*.C *.cpp 
```

但这会导致您的 shell 生成命令。最有可能的是，在这两个实例中生成了不同的命令。如果您采用在有效的情况下发出的实际命令并在无效的情况下重复*该*命令，我敢打赌它会起作用。

您可以通过转到它工作的机器并输入以下命令来找到该命令：

```
echo g++ -o*.C *.cpp 
```

这将向您显示 shell 为您生成的命令。如果您在另一台机器上尝试该命令，我敢打赌它会起作用。

（另外，你的命令没有意义。`-o*.C`应该是什么？你的意思是`-o something *.C`？）

# unix - System V IPC 限制

> ID：10406492
> 
> 赞同：2
> 
> 时间：2012-05-02T01:12:02.233
> 
> 标签：unix, networking

在阅读有关 System V IPC 的信息时，我发现它们不能在跨机器的进程之间使用。为什么呢？有没有办法跨机器使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:49:33.767

它们是本地内核 IPC 原语。我看不出它们如何联网。

SysV IPC 并没有真正为您提供任何革命性的东西，除了一组可靠且由内核提供的同步和通信原语（因此您不需要第三方依赖项）。它们也很容易使用我独立产生的多个进程..

我认为下一个问题是：您希望通过网络使用哪些（SysV）IPC 原语？

对于正常的消息传递，有第三方解决方案，如 zeromq 等。对于分布式锁管理和信号量，事情变得有点复杂（编写 DLM 并不容易）——你可以通过使用文件系统、使用支持锁定的分布式数据库、OpenMPI（如果这是你的东西）等来摆脱困境。

不幸的是，没有简单的解决方案（如果有人可以分享他们的成功故事，我也会很高兴听到）。

# ocaml - OCaml Printf.sprintf

> ID：10406493
> 
> 赞同：13
> 
> 时间：2012-05-02T01:12:08.153
> 
> 标签：ocaml, printf, type-systems

为什么会出现这种行为？

```
# Printf.sprintf ("Foo %d %s") 2 "bar";;
- : string = "Foo 2 bar"

# Printf.sprintf ("Foo %d" ^ " %s") 2 "bar";;
  Printf.sprintf ("Foo %d" ^ " %s") 2 "bar";;
Error: This expression has type string but an expression was expected of type
         ('a -> 'b -> 'c, unit, string) format =
           ('a -> 'b -> 'c, unit, string, string, string, string) format6 
```

我希望首先评估字符串连接，所以一切都会正常进行。这是否与 Printf 使用的类型系统技巧有关？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T01:19:22.763

是的，它与类型系统技巧有关。如果要创建格式字符串，则需要使用 (^^) 运算符：

```
# Printf.sprintf ("Foo %d" ^^ " %s") 2 "bar";;
- : string = "Foo 2 bar" 
```

我对这个技巧没有深入了解，但我相信如果键入上下文需要，编译器愿意将字符串*常量提升为 printf 格式。*但是，结果`("Foo %d" ^ " %s")`不是字符串常量，因此不会被提升。(^^) 运算符创建一个键入上下文，如果两个操作数都是字符串常量，则可以在其中提升它们。

您可以看到为什么它必须是字符串常量：否则无法确定（要打印的值的）关联类型。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-03T08:03:34.610

这个问题发生的范围比操作员要广泛得多`^`。基本上，OCaml 编译器需要知道您的格式字符串是文字字符串，并且需要在编译时知道文字字符串。否则，OCaml 无法在编译时将您的字符串转换为这种`BLAHBLAH format6`类型。该`Printf`模块仅适用于在编译时完全已知的格式字符串，或已转换为该`BLAHBLAH format`类型的格式字符串。

通常，您可以通过使用运算符并在代码中使用这些字符串*之前*`^^`将所有文字字符串显式转换为`BLAHBLAH format`类型来解决此问题。

 *这是另一个例子：

```
 # Printf.sprintf (if true then "%d" else "%d ") 2;;
  Error: This expression has type string but an expression was expected of type
     ('a -> 'b, unit, string) format =
       ('a -> 'b, unit, string, string, string, string) format6
  (* define a type abbreviation for brevity *)
  # type ('a,'b) fformat = ('a ->'b, unit, string) format;;
  type ('a, 'b) fformat = ('a -> 'b, unit, string) format
  # Printf.sprintf (if true then ("%d":('a,'b)fformat) else ("%d ":('a,'b)fformat)) 2;;
  - : string = "2" 
```

OCaml 系统无法识别`if ... then "a" else "b"`可以转换为`BLAHBLAH format`. 如果您自己将*每个文字字符串*`BLAHBLAH format`转换为，那么一切正常。`if/then/else`（注意：如果您尝试将整个转换为，则它不起作用`BLAHBLAH format`，因为 OCaml 无法验证您的字符串是否为文字。）

问题的根源是类型安全的要求：OCaml 要求每个等都有一个正确类型的参数`%d`，并在*编译时*`%s`保证这一点。*除非在编译时*知道整个格式字符串，否则不能保证类型安全。因此，不可能使用通过复杂算法计算的格式字符串，例如通过随机选择和。*`Printf`*`Printf``%s``%d`**

 **当我们`if/then/else`用来计算格式字符串时，然后是 OCaml 的东西，哎呀，这是一个复杂的算法，在编译时验证类型安全是没有希望的。`^^`运算符了解类型并在`BLAHBLAH format`连接格式字符串时产生正确的结果。但是`if/then/else`不知道`BLAHBLAH format`，并且没有内置的替代方法`if/then/else`（但我想你可以自己定义这样的东西）。***

# php - 使用 PHP 查找和提取字符串

> ID：10406495
> 
> 赞同：2
> 
> 时间：2012-05-02T01:12:47.190
> 
> 标签：php, string

我正在开发一个小功能，用于从我的 twitter rss 提要中获取和显示项目。但我以这种格式得到它：
标题[http://t.co/xxx](http://t.co/xxx)

我想要的是从我得到的那个字符串中提取[http://t.co/xx （url）。](http://t.co/xx)所以我可以将其用作链接等。
感谢您的帮助：}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:48:40.177

可能也是学习正则表达式的好时机:)

试试这个

```
<?php
$s = '
Title http://t.co/xxx
Title http://t.co/yyy

';

$s2 = preg_replace( '@(Title |http://t.co/)@i', '', $s );
echo nl2br( $s2 );
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:19:13.753

尝试 ：

```
$title = Title http://t.co/xxx

$final = str_replace("Title ","",$title); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:36:53.640

```
$item = "Title http://t.co/xxx";
preg_match( "/http\S+/", $item, $matches );
$url = $matches[0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T01:22:59.843

```
$str = 'Title http://t.co/xxx';
echo substr($str, strpos($str, 'http')); 
```

# iphone - 使用自定义 UIBarButton 进行推送

> ID：10406497
> 
> 赞同：1
> 
> 时间：2012-05-02T01:13:10.923
> 
> 标签：iphone, ios, xcode, uibarbuttonitem, segue

我有这段代码可以让我创建一个自定义 UIBarButton，它位于我的 viewDidLoad 中。

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done"
                                                               style:UIBarButtonItemStyleDone
                                                              target:nil
                                                              action:nil];
    self.navigationItem.rightBarButtonItem = doneButton; 
```

现在，我希望在按下 UIBarButton 时调用下面的此方法，以便完成对下一个视图控制器的 segue。

```
- (void) didPressDone {

    PointsResultsViewController *pointsResults = [self.storyboard instantiateViewControllerWithIdentifier:@"resultsPointsVC"];

    [self.navigationController pushViewController:pointsResults animated:YES];
} 
```

我已经对此进行了一些研究。然而，我看到的都是关于从对象库中将 UIBarButton 拖到 ViewController，然后将其连接到下一个 VC，使用方法 prepareForSegue，完成，就这么简单。就我而言，情况完全不同。

请指教:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:53:34.637

您可以将目标设置为 self 并将操作设置为您的 didPressDone 选择器：

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done"
                                                               style:UIBarButtonItemStyleDone
                                                              target:self
                                                              action:@selector(didPressDone:)]; 
```

选择器应该有这样的签名：

```
- (void)didPressDone:(id)sender 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-10T21:34:56.980

这个怎么样-

第1步：

在您的 Viewcontroller.h 文件中，只需像这样创建 UIBarButton 的 IOBOutlet -

```
@property(nonatomic, strong) IBOutlet UIBarButton *doneButton; 
```

以及它的 IBAction 方法-

```
-(IBAction)didPressDone:(id)sender; 
```

第2步：

通过情节提要连接 UIBarButton 并附加操作方法。

第 3 步：

现在让我们转到 Viewcontroller.m 文件并在`-(void)viewDidLoad`方法中，按照您想要的方式初始化 UIBarButton -

```
self.doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done"
                                                               style:UIBarButtonItemStyleDone
                                                              target:nil
                                                              action:nil];
    self.navigationItem.rightBarButtonItem = self.doneButton; 
```

除了方法签名之外，“didPressDone”方法实现将是相同的——

```
-(IBAction)didPressDone:(id)sender {

    PointsResultsViewController *pointsResults = [self.storyboard instantiateViewControllerWithIdentifier:@"resultsPointsVC"];

    [self.navigationController pushViewController:pointsResults animated:YES];
} 
```

希望，这会有所帮助。

# sql - ActiveRecord 在 Rspec 测试中导致 SQLException

> ID：10406503
> 
> 赞同：3
> 
> 时间：2012-05-02T01:15:09.327
> 
> 标签：sql, ruby-on-rails, testing, rspec

**更新：**我的问题肯定与[这个](https://github.com/rails/rails/issues/5885)有关- 这是 ActiveRecord 的问题。还是没有解决。

我正在尝试通过 rspec 进行测试，但无法弄清楚出了什么问题......这就是我得到的：

```
Running: spec/models/user_spec.rb
.
.
.
........F

Failures:

  1) User when email address is already taken 
     Failure/Error: user_with_same_email.save
     ActiveRecord::StatementInvalid:
     SQLite3::SQLException: near "SAVEPOINT": 
     syntax error: SAVEPOINT active_record_1
     # ./spec/models/user_spec.rb:64:in `block (3 levels) in <top (required)>'

Finished in 0.22908 seconds
9 examples, 1 failure 
```

这是我测试中的相关行：

```
user_with_same_email.save 
```

尝试写入数据库时​​它会中断。发展很好 - 没有问题。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T07:07:40.410

问题是旧版本的 sqlite。我安装了 Homebrew 并运行`brew install sqlite3` 了由于文件已经存在而出现的一些错误。我只是将它们重命名`*.old`并运行`brew link sqlite3`。问题解决了！

# ssas-2012 - 需要 SSAS 表格服务器的硬件大小调整指南

> ID：10406505
> 
> 赞同：2
> 
> 时间：2012-05-02T01:15:12.977
> 
> 标签：ssas-2012

对于运行 SSAS 表格的服务器，是否有任何良好的硬件尺寸指南来源？类似于“如果您的模型估计有这么大（就内存而言）并且您期望同时连接的平均 x 数......这就是您应该开始的内容”。

显然，它们需要比大多数其他系统更多的内存来保存数据......但我也希望它们能够利用更多的内核和更高的时钟速度......一旦它在内存中，它真的只是一个问题撕开它并计算数字。更多的核心来处理更多的并发，更高的时钟速度更快的“处理”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:31:47.660

您的目标应该是原始数据库内存大小的 40%。1tb 数据 = SSAS 表格的 400gb 内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T16:47:53.247

FWIW，微软刚刚发布了一份白皮书（2013 年 1 月），解决了这个问题

[确定表格解决方案的硬件大小 (SQL Server Analysis Services)](http://msdn.microsoft.com/en-us/library/jj874401.aspx)

# php - 重置 phpMyAdmin

> ID：10406507
> 
> 赞同：1
> 
> 时间：2012-05-02T01:15:48.360
> 
> 标签：php, passwords, phpmyadmin, account

我正在运行 3.3.9 版，并且在尝试恢复我的管理员密码以及重置 root 密码时遇到了问题。通过地址栏 登录**localhost/xampp/phpMyAdmin时出现以下弹出窗口：**![PHPmyadmin 登录](../Images/c63bb45b727f35186445bf461ff23154.png)

我应该怎么做才能重置我的root密码？

注意我已经尝试通过`config.inc`文件夹设置密码，但没有任何改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:19:37.563

（虽然这个问题是题外话，所以...）

**从你的命令行**试试这个：

```
mysqladmin -u root -p 'oldpassword' password newpass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-30T13:13:32.347

```
mysqladmin -u root -p 'oldpassword' password newpass 
```

我认为这段代码应该通过 index.php 文件的脚本标签来实现它，这样 xammp 数据库就会识别代码！

# c++ - 如何从 C++ 中的“公共引用类”创建公共变量？

> ID：10406508
> 
> 赞同：1
> 
> 时间：2012-05-02T01:16:27.010
> 
> 标签：c++, class, visual-c++, public, ref

您如何允许变量处于“公共引用类”的公共/全局范围内？
Visual C++ [2010]
在我的主 DLL main.h 中：

```
namespace fdll {

 public ref class foo
 {
   public:
     int bar(int num);
  };

} 
```

在我的 DLL main.cpp 中：

```
#include "main.h"
int fdll::foo::bar(int num)
{
  return num;
} 
```

在另一个项目中：

```
#using <main.dll>
#include "main.h"
fdll::foo f; <--- error wtf
int main()
{
  Console::WriteLine(fdll.bar(2));
  return 0;
} 
```

给出的错误：
错误 C3145：“f”：全局或静态变量可能没有托管类型“fdll::foo”
可能没有声明全局或静态变量，或者引用 gc 堆中对象的本机类型的成员

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:32:39.927

CLR 对象不支持全局变量，如此[处](https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-2/compiler-error-c3145)所述。

创建一个全局类并使用static来模拟全局变量或只在函数范围内声明CLR变量。

# android - Android- SQLite 查询以使用查询生成器按天排序结果

> ID：10406514
> 
> 赞同：2
> 
> 时间：2012-05-02T01:16:56.490
> 
> 标签：android, sqlite, sql-order-by, query-builder

目前我正在使用查询生成器从我的数据库中提取我的所有记录，它们目前按天组织，但是我按字母顺序排列，

```
 public Cursor fetchAll() {

      return mDb.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_MODULECODE,
        KEY_DAY, KEY_TIME, KEY_DURATION, KEY_TYPE, KEY_ROOM},null, null, null, null,"Day");
   } 
```

经过一番谷歌搜索后，我知道我需要用自定义搜索顺序替换最后一部分。类似于：

```
 select _id, busnum, 
    case cast (strftime('%w', servdate) as integer)
        when 0 then 'Sunday'
        when 1 then 'Monday'
        when 2 then 'Tuesday'
        when 3 then 'Wednesday'
        when 4 then 'Thursday'
         when 5 then 'Friday'
        else 'Saturday' end as servdayofweek
   from tb1
   where ...

   From:
   http://stackoverflow.com/questions/4319302/sqlite-return-as-day-of-week 
```

到目前为止，我一直无法弄清楚如何将两者结合起来，并且在正确方向上的任何帮助都会非常有用。

编辑解决方案感谢您帮助我声明字符串并在查询中为任何需要简单的人链接到它这是我的最终代码

```
public Cursor fetchAll() {
   String OrderBy ="case Day"+
      " when 'Monday' then 0 "+ 
      " when 'Tuesday' then 1"+
      " when 'Wednesday' then 2"+
      " when 'Thursday' then 3"+
      " when 'Friday' then 5"+
      " end";
 return mDb.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_MODULECODE,
        KEY_DAY, KEY_TIME, KEY_DURATION, KEY_TYPE, KEY_ROOM},null, null, null, null,OrderBy );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:24:17.090

如果您无法弄清楚如何传递复杂查询，`SQLiteDatabase.query(... lots of variables...)`只需将您的 select 语句作为字符串传递给[`SQLiteDatabase.rawQuery()`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery%28java.lang.String,%20java.lang.String%5b%5d%29).

例如：

```
String query = "select _id, busnum, " +
               " case cast cast (strftime('%w', servdate) as integer) " +
               ...
String[] selectionArgs = new String() { yada, yada, yada }
mDb.rawQuery(query, selectionArgs); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:27:00.203

如果您的`Day`值是日期名称，那么您需要这样的内容：

```
order by case Day
        when 'Sunday' then 0
        when 'Monday' then 1
        when 'Tuesday' then 2
        ...
        when 'Saturday' then 6
    end 
```

在 SQL 中；请记住，您几乎可以提交 SQL ORDER BY 任何表达式。to的`orderBy`参数[`query`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query%28java.lang.String,%20java.lang.String%5b%5d,%20java.lang.String,%20java.lang.String%5b%5d,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)可以是任何 SQL ORDER BY 子句（没有`order by`），所以你想要这个丑陋的大字符串：

```
"case Day when 'Sunday' then 0 when 'Monday' then 1 ... when 'Saturday' then 6 end" 
```

作为`query`. 当然，您必须正确填写`...`。

# android - 解析PDF时出现UnsupportedEncodingException Android

> ID：10406515
> 
> 赞同：1
> 
> 时间：2012-05-02T01:16:59.710
> 
> 标签：android, pdf

每次尝试在 Android 中解析 pdf 时，我都会收到 UnsupportedEncodingException 错误。有谁知道为什么？我很肯定我的编码是正确的。大多数错误是 Unicode Big Unmarked 或 MacRoman。

这是代码...

```
public void parsePdf(URL pdf) throws IOException {
    PdfReader reader = new PdfReader(pdf.openStream());
    PdfTextExtractor pdfEx = new PdfTextExtractor(reader);
    try{
    System.out.println(pdfEx.getTextFromPage(1));
    }catch(Exception e){
        System.out.println(e.getLocalizedMessage());
        System.out.println(e.toString());

    } 
```

这是例外... 05-02 01:12:57.735: I/System.out(299): ExceptionConverter: java.io.UnsupportedEncodingException: UnicodeBigUnmarked

# jquery - 用于处理不同大小元素的两列 jQuery UI 可排序列表网格的 CSS

> ID：10406516
> 
> 赞同：3
> 
> 时间：2012-05-02T01:17:04.723
> 
> 标签：jquery, css, jquery-ui, jquery-ui-sortable

我正在尝试创建一个拖放式两列可排序列表。我已经设置了 jQuery UI 的 SortableList ，其中有一个`<ul>`and`<li>`是`float:left`宽度的一半`<ul>`

这是代码和示例：http: [//jsfiddle.net/elidickinson/hjnkg/](http://jsfiddle.net/elidickinson/hjnkg/)

基本上我想消除那个jsfiddle链接中item3和item5之间的差距。我希望能够拖动任何这些元素而不留下任何内部间隙。

我在 CSS 中没有看到任何明显的方法来解决这个问题，所以我最好的想法是编写一些 JS 来查找出现在右侧列中的任何“高”项目并将它们切换到`float:right`. 那应该可以解决问题，但我希望有一个更优雅的解决方案。

我也对任何替代方法持开放态度，例如使用两个没有浮动的单独列。这解决了“高项目”的问题，但我认为处理占用两列的“宽”项目需要一些 CSS 魔法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:04:24.190

现有的插件都不允许可拖动排序。我能找到的最接近的东西是[http://isotope.metafizzy.co/index.html](http://isotope.metafizzy.co/index.html)，它确实有一个按按钮排序的选项。这是一个非常复杂的问题，我认为还没有人承担过，至少没有公开。这是 Isotope 的创建者的帖子：http: [//metafizzy.co/blog/mythical-drag-drop-multi-column-grid-plugin/](http://metafizzy.co/blog/mythical-drag-drop-multi-column-grid-plugin/)

Bututtttt，如果您想让占位符大小相同，请执行以下操作：

```
$('#list').sortable({ 
        placeholder: "ui-state-highlight",
        tolerance:'pointer',
        start: function (event, block) { 
            // set the placeholder size to the block size
            $('.ui-state-highlight').css({
                'width':$(block.helper).outerWidth(),
                'height':$(block.helper).outerHeight()
            });             
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T06:21:16.760

我们使用该函数的`change`选项成功解决了类似（但不相同）的问题。`sortable`我们的问题是我们在两列列表中有一些“高”的 LI 元素，当这些高元素在第一列时，其他项目会堆积在与高元素相邻的第二列中，因为所有 LI 元素都是`float: left`. 这会在排序时产生非常奇怪的交互。

为了解决这个问题，您可以应用`clear: both`到第一列中的所有 LI 元素（所有奇数元素），但是在排序中间会出现问题，因为列表中有一个额外的 LI 元素具有绝对定位（一个被拖动），它会抛出偶数和奇数选择器。

解决方案是使用`change`在排序期间每次 DOM 更改时调用的回调。然后，您可以使用 jquery 准确找出哪些是实际在第一列中的 LI 元素并应用于`clear: both`这些元素。

```
 function setClearsOnFirstColumn() {
        var colNum = 0;
        $(".myList").find( "li:not(.ui-sortable-helper)" ).each( function() {
            var thisLiEl = $(this);

            if( colNum == 0 )
                thisLiEl.css( "clear", "both" );
            else
                thisLiEl.css( "clear", "none" );

            colNum ++;
            if( colNum == 2 ) colNum = 0;
        } );
    }

    $(".myList").sortable( { change: setClearsOnFirstColumn, stop: setClearsOnFirstColumn } ); 
```

选择器的一部分用于在确定第一列中的 LI 元素是哪些时`not`忽略被拖动的 LI 元素（由其类标识）。`.ui-sortable-helper`（也可以通过使用偶数和奇数的 jquery 选择器来缩短它——这里不是这样做的，只是因为片段是从更一般的情况改编的，以支持列表中的两列以上。）

请注意，您还需要`setClearsOnFirstColumn`在列表最初呈现后调用。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T16:02:19.523

这是我在问题中建议的 javascript 解决方案的一个非常复杂的版本。它似乎工作，但它肯定不漂亮。这是在 jsFiddle 中：http: [//jsfiddle.net/elidickinson/tRjDM/](http://jsfiddle.net/elidickinson/tRjDM/)

```
function update_columns() {
    var column = 1;
    var orient_1past = '';
    var orient_2past = '';
    $("#dashboard-layout .item").each(function() {
        var $item = $(this);
        var orient_current = 'normal';
        if ($item.hasClass('wide')) {
            orient_current = 'wide';
        }
        if ($item.hasClass('tall')) {
            orient_current = 'tall';
        }

        if ((orient_2past == 'tall') || (orient_1past == 'wide') || orient_1past == '') {
            // do nothing
        }
        else {
            // move to next column
            column = (column == 1) ? 2 : 1;
        }

        // remove any existing columns classes
        $item.removeClass('column1').removeClass('column2');

        // add class for calculated column
        $item.addClass('column' + column)

        // keep track of previous two item orientations                
        orient_2past = orient_1past;
        orient_1past = orient_current;
    });
} 
```

加上一些 CSS 规则，例如：

```
.item.column1 { float: left; }
.item.column2 { float: right; } 
```

# oracle9i - 如何更改 Oracle 9i 中的索引更改表空间？

> ID：10406517
> 
> 赞同：2
> 
> 时间：2012-05-02T01:17:10.120
> 
> 标签：oracle9i

我是 Oracle DBMS 的新手，我的任务是更改 Oracle 中的索引表空间，例如从`MYDB_DATA_SPACE`到`MYDB_INDX_SPACE`。

我曾尝试在 Google 上搜索可能的解决方案，并找到了这样的 SQL：

```
ALTER INDEX idx_city_state
REBUILD TABLESPACE sales_us; 
```

我可以请检查这是否达到目的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T03:34:25.690

是的，这将重建表空间`idx_city_state`中的索引`sales_us`。您可以编写一些动态 SQL 来重建所有索引

```
DECLARE
  l_sql_stmt VARCHAR2(1000);
BEGIN
  FOR i IN (SELECT owner,
                   index_name
              FROM all_indexes
             WHERE tablespace_name = 'MYDB_DATA_SPACE')
  LOOP
    l_sql_stmt := 'ALTER INDEX ' || i.owner || '.' || i.index_name ||
                  '  REBUILD TABLESPACE MYDB_INDX_SPACE';
    EXECUTE IMMEDIATE l_sql_stmt;
  END LOOP;
END; 
```

# php - 理解为什么 php 会以这种方式递增字符

> ID：10406521
> 
> 赞同：3
> 
> 时间：2012-05-02T01:18:17.673
> 
> 标签：php, character, arithmetic-expressions

PHP 手册指出：PHP 在处理字符变量而不是 C 的算术运算时遵循 Perl 的约定。例如，在 PHP 和 Perl 中将`$a = 'Z'; $a++;`$a 转换为 'AA'，而在 C 中将`a = 'Z'; a++;`a 转换为 '['（'Z' 的 ASCII 值是 90，'[' 的 ASCII 值是 91）。

如果PHP在处理字符的算术运算时将字符转换为ascii值（假设），它不应该打印'['而不是AA吗？PHP为什么以及如何以这种方式增加字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:26:51.637

> 如果 PHP 在处理字符的算术运算时将字符转换为 ascii 值（假设）......

您的假设是错误的，因为它将`"0"`and`0`视为平等，而不是`"0"`and `48`。

```
$ php
<?php
echo "0" == 0 ; echo "\n";
echo "0" == 48 ; echo "\n";
1
​ 
```

# objective-c - Objective-C - 在“初始化链”之后遇到问题

> ID：10406523
> 
> 赞同：2
> 
> 时间：2012-05-02T01:18:48.093
> 
> 标签：objective-c, initialization, xcode4.2, initializer

好的。很难在这里找到最佳起点。Lion 中的错误 XCode (4.3.2) 对我来说是：

```
Redefinition of 'a' with a different type 
```

作者说当我们声明这一行时（在本页底部附近，主要）......

```
OwnedAppliance *a = [[OwnedAppliance alloc] init]; 
```

...它应该运行良好。它没有。它踢回了上面的错误。我理解，因为 OwnedAppliance 在其实现中没有 init 方法，所以编译器将在层次结构上向上到 OwnedAppliance 的超类，即 Appliance，并在那里搜索一个 init 方法。它找到被覆盖的 init，它只包含以下行...

```
[self initWithProductName:@"Unknown"]; 
```

...并运行它。明白了。

啊。对不起大家。我只是试图解释我认为可能发生的事情。花了十几行，我只是划伤了表面。与其让你对我*认为*正在发生的事情感到厌烦，我只想问：

这段代码是怎么回事？由于缺乏更好的术语，初始化“路径”在哪里结束？重新定义（错误）发生在哪里？

```
/********************  Appliance.h  ********************/

#import <Foundation/Foundation.h>

@interface Appliance : NSObject
{
    NSString *productName;
    int voltage;
}

@property (copy) NSString *productName;
@property int voltage;

-(id)init;
// Designated initializer
-(id)initWithProductName:(NSString *)pn;
...
@end

/********************  Appliance.m  ********************/

#import "Appliance.h"

@implementation Appliance

@synthesize productName, voltage;

-(id)init
{
    return [self initWithProductName:@"Unknown"];
}

-(id)initWithProductName:(NSString *)pn
{
    self = [super init];

    if (self) {    
    [self setProductName: pn];
    [self setVoltage: 120];
    }

    return self;
...

@end

/********************  OwnedAppliance.h  ********************/

#import "Appliance.h"

@interface OwnedAppliance : Appliance
{
    NSMutableSet *ownerNames;
}

// Designated initializer
-(id)initWithProductName:(NSString *)pn
          firstOwnerName:(NSString *)n;
...

@end

/********************  OwnedAppliance.m  ********************/

#import "OwnedAppliance.h"

@implementation OwnedAppliance

-(id)initWithProductName:(NSString *)pn
          firstOwnerName:(NSString *)n
{
    self = [super initWithProductName:pn];

    if (self) {
        ownerNames = [[NSMutableSet alloc] init];

    if (n) {
        [ownerNames addObject:n];
        }
    }
    return self;
}

-(id)initWithProductName:(NSString *)pn
{
    return [self initWithProductName:pn
                      firstOwnerName:nil];
}
...
@end

/********************  main.m  ********************/

#import <Foundation/Foundation.h>
#import "Appliance.h"
#import "OwnedAppliance.h"

int main(int argc, const char * argv[])
{
    @autoreleasepool {
    //  Previously omitted problematic code:
        Appliance *a = [[Appliance alloc] init];
        NSLog(@"a is %@", a);
        [a setProductName:@"Washing Machine"];
        [a setVoltage:240];
        NSLog(@"a is %@", a);

    //  The following line is where the error occurs:
        OwnedAppliance *a = [[OwnedAppliance alloc] init];
        ...
    }
    return 0;
} 
```

关于这个问题以及如何提出这个问题，我想了很多。我不认为这是一个*非常*愚蠢的。:) 但是我的大脑因为 9 个小时的研究而被烧毁，所以如果这是一个完全明显的问题，我深表歉意。TIA

编辑： main() 现在包含实际导致错误的代码。感谢 Jacques 尽管有遗漏，但他仍然足够出色地捕捉到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:44:43.627

编译器实际上告诉你变量本身 ,`a`已经被声明了两次；该错误与分配无关。在其他地方，在范围内，您有另一个名为 的变量`a`，它的类型不同于`OwnedAppliance *`. 更改一个（或两个）的名称，错误就会消失。

# c++ - 如何处理长时间溢出

> ID：10406529
> 
> 赞同：2
> 
> 时间：2012-05-02T01:21:00.273
> 
> 标签：c++

我正在使用一个 API，它在 long 类型的变量中提供一些数据。这个变量的值在增加，会多次翻转，遗憾的是没有办法修改API。我正在尝试使用类似于我在下面包含的测试工具的代码来检测和补偿溢出，最终我会将数据转换为 unsigned long long，然后转换为 double：

```
void DetectRolloverOneNumber(long val)
{
static unsigned __int64 prevVal = 0;
//store value in an unsigned long
unsigned long newVal = val;

//we will eventually store in a long long
unsigned __int64 uiBigVal = newVal;

//max value for a 32 bit long
unsigned __int64 maxInt = 0xFFFFFFFF;
bool rollover = false;

//we will be adding max long + 1
maxInt++;

//detect the rollover
unsigned __int64 modVal = prevVal% maxInt;

if (newVal < modVal)
{
    //account for the rollover
    uiBigVal += maxInt;
    rollover = true;
}

cout<< val << "\t" << newVal << "\t" << modVal << "\t" <<
        uiBigVal << "\t" << prevVal << "\t" << rollover << "\n";

//cache the value so we can check for rollover next time
prevVal = uiBigVal; 
```

所以这行得通，但我的长期价值是多次滚动，我没有正确处理。为了测试这段代码，我用以下方式调用它

```
first =2147483647;
for (int i = 0; i < 100000; i ++)
{

    DetectRolloverOneNumber(first);
    first += 1000000; 
```

这是我的输出

```
 val (long)       newVal (ulong) modVal           uiBigVal       prevVal    
   2147483647      2147483647      0               2147483647      0       
   -2146483649     2148483647      2147483647      2148483647      2147483647
   -2145483649     2149483647      2148483647      2149483647      2148483647
   -2144483649     2150483647      2149483647      2150483647      2149483647
   -2143483649     2151483647      2150483647      2151483647      2150483647
   -2142483649     2152483647      2151483647      2152483647      2151483647 
```

到目前为止一切顺利，即使我们通过了有符号 32 位长的最大值，值也按预期增加了 100000。

..进一步向下...

```
 -2483649        4292483647      4291483647      4292483647      4291483647
   -1483649        4293483647      4292483647      4293483647      4292483647
   -483649         4294483647      4293483647      4294483647      4293483647      
   516351          516351          4294483647      4295483647      4294483647   (rollover detected here and we are still good)
   1516351         1516351         516351          1516351         4295483647      
   2516351         2516351         1516351         2516351         1516351 //oops!!!
   3516351         3516351         2516351         3516351         2516351 
```

所以我弄错了。有人对如何正确处理翻转有任何提示吗？任何意见，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:41:41.963

只是好奇，但是您的系统的 long 有多大？我猜是 64 位，但你的问题暗示它们是 32 位。另外，为什么要考虑加倍？双打并没有你想象的那么大。[52 到 53 位](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)，主要来自我使用过的系统。如果它是有符号类型（我相信），则其他位用于指数和符号。由于您使用的是 C++，我会使用 boost::uint64_t [integer.hpp](http://www.boost.org/doc/libs/1_49_0/boost/integer.hpp)来便携地存储大数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T13:59:53.297

感谢您的回答。Longs 在我的系统上是 32 位，不幸的是我不能使用 boost，因为我正在一个非常锁定的框架中工作。

如前所述，我没有处理多次翻转。正如雷蒙德所说，我可以通过跟踪我之前测试过并且确实有效的方式来处理这个问题。另一种处理方法是跟踪我看到的翻转次数，执行如下操作。

```
 //the rest of the code is the same as above
   if ((newVal < modVal && prevVal > 0))
  {
    //rollover has occurred, increment our rollover counter
    rolloverCount ++;
  }

  //account for the rollover
  uiBigVal =newVal + (maxInt * rolloverCount); 
```

感谢您的输入。

# python - Windows上的Python子进程输出？

> ID：10406532
> 
> 赞同：8
> 
> 时间：2012-05-02T01:21:10.460
> 
> 标签：python, windows, subprocess

我在从子进程标准输出管道获取输出时遇到了一些困难。我正在通过它启动一些第三方代码，以提取日志输出。直到最近更新第三方代码，一切正常。更新后，python 开始无限期阻塞，实际上并没有显示任何输出。我可以手动启动第三方应用程序并查看输出。

我正在使用的代码的基本版本：

```
import subprocess, time
from threading import Thread

def enqueue_output(out):
    print "Hello from enqueue_output"
    for line in iter(out.readline,''):
        line = line.rstrip("\r\n")
        print "Got %s" % line
    out.close()

proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, bufsize=1)
thread = Thread(target=enqueue_output, args=(proc.stdout,))
thread.daemon = True
thread.start()

time.sleep(30) 
```

如果我将此脚本替换为third_party.exe，这将非常有效：

```
import time, sys

while True:
    print "Test"
    sys.stdout.flush()
    time.sleep(1) 
```

所以我不清楚需要做些什么才能让这个与原始命令一起工作。

这些都是 subprocess.Popen 行的所有变体，我尝试过但没有成功：

```
proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, bufsize=0)
proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, shell=True)
proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, creationflags=subprocess.CREATE_NEW_CONSOLE)
si = subprocess.STARTUPINFO()
si.dwFlags = subprocess.STARTF_USESTDHANDLES | subprocess.STARTF_USESHOWWINDOW
proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, startupinfo=si) 
```

编辑 1：在这种情况下，我实际上不能使用 .communicate() 。我正在启动的应用程序会长时间运行（几天到几周）。我可以实际测试 .communicate() 的唯一方法是在应用程序启动后不久将其杀死，我认为这不会给我有效的结果。

即使是非线程版本也失败了：

```
import subprocess, time
from threading import Thread

proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, stderr=subprocess.PIPE)

print "App started, reading output..."
for line in iter(proc.stdout.readline,''):
    line = line.rstrip("\r\n")
    print "Got: %s" % line 
```

编辑2：感谢jdi，以下工作正常：

```
import tempfile, time, subprocess

w = "test.txt"
f = open("test.txt","a")
p = subprocess.Popen("third_party.exe", shell=True, stdout=f,
                        stderr=subprocess.STDOUT, bufsize=0)

time.sleep(30)

with open("test.txt", 'r') as r:
    for line in r:
        print line
f.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T01:37:17.317

首先，我建议您简化此示例以确保您可以实际阅读任何内容。从混合中删除线程的复杂性：

```
proc = subprocess.Popen("third_party.exe", stdout=subprocess.PIPE, bufsize=1)
print proc.communicate() 
```

如果这行得通，那就太好了。那么您可能在如何直接或可能在您的线程中读取标准输出时遇到问题。

如果这不起作用，您是否尝试过将 stderr 也通过管道传输到 stdout？

```
proc = subprocess.Popen("third_party.exe", 
                        stdout=subprocess.PIPE, 
                        stderr=subprocess.STDOUT, bufsize=1) 
```

**更新**

既然你说`communicate()`是死锁，这是另一种方法，你可以尝试看看它是否与子进程的内部缓冲区有问题......

```
import tempfile
import subprocess

w = tempfile.NamedTemporaryFile()
p = subprocess.Popen('third_party.exe', shell=True, stdout=w, 
                        stderr=subprocess.STDOUT, bufsize=0)

with open(w.name, 'r') as r:
    for line in r:
        print line
w.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T05:55:19.713

```
args = ['svn','log','-v']

def foo(info=''):
    import logging
    import subprocess
    import tempfile
    try:
        pipe = subprocess.Popen(args,bufsize = 0,\
            stdout = subprocess.PIPE,\
            stderr=subprocess.STDOUT)
    except Exception as e:
        logging.error(str(e))
        return False
    while 1:
        s = pipe.stdout.read()
        if s:
            print s,
        if pipe.returncode is None:
            pipe.poll()
        else:
            break
    if not 0 == pipe.returncode:
        return False
    return True

print foo() 
```

这个应该可以工作，而不是线程，临时文件魔术。

# java - Java“新建”窗口

> ID：10406537
> 
> 赞同：1
> 
> 时间：2012-05-02T01:22:35.797
> 
> 标签：java, user-interface, jframe

我对使用 Java 的 GUI 比较陌生，我有一个带有简单菜单栏的 JFrame，带有典型的创建新按钮（比如创建新文件和东西）。我想要它，所以当我选择这个按钮时，会弹出另一个窗口，它有几件事要填写，然后你选择一个确定按钮或一个取消按钮。然后焦点返回到主JFrame。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:23:54.547

这听起来像是一个完美的工作[`JDialog`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html)。[对话教程](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)。

# objective-c - Core Plot - 如何在带有对数轴的绘图空间中将触摸点转换为绘图点

> ID：10406539
> 
> 赞同：3
> 
> 时间：2012-05-02T01:22:38.800
> 
> 标签：objective-c, ios, core-plot

我有一个带有线性 y 轴和对数 x 轴的散点图，所有这些都很好。但是当我尝试将触摸点转换为绘图空间坐标时，我遇到了问题。

我已经看到类似以下建议的各个地方：

```
- (BOOL)plotSpace:(CPTPlotSpace *)space shouldHandlePointingDeviceUpEvent:(id)event atPoint:(CGPoint)point
{
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)space;

CPTScatterPlot *scatterPlot = [[[plotSpace graph] allPlots] objectAtIndex:0]; 
CGPoint plotAreaPoint = [[plotSpace graph] convertPoint:point toLayer:scatterPlot];

NSLog(@"PlotAreaPoint : %.1f, %.1f", plotAreaPoint.x, plotAreaPoint.y);

NSDecimal dataPoint[2];
NSDecimalNumber *xCoordinate, *yCoordinate;

[plotSpace plotPoint:dataPoint forPlotAreaViewPoint:plotAreaPoint];

xCoordinate = [NSDecimalNumber decimalNumberWithDecimal:dataPoint[0]];
yCoordinate = [NSDecimalNumber decimalNumberWithDecimal:dataPoint[1]];

NSLog(@"DataPoint : %.1f, %.1f", [xCoordinate floatValue], [yCoordinate floatValue]);

return YES;
} 
```

当我运行它时， plotAreaPoint 似乎是正确的，并且 yCoordinate 是正确的。如果我在左边缘 (5.0) 或右边缘 (500.0) 上点击，xCoordinate 是正确的，但如果我在中间点击，它的行为就像一个线性轴。如果我在中间点击，我会得到 250.0 左右，而不是 50.0。我错过了什么，还是有其他方法可以做到这一点？

谢谢，蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T01:42:22.900

那是一个错误。请在[Core Plot 问题跟踪器](http://code.google.com/p/core-plot/issues/list)上报告。

# ruby - 了解 Ruby 代码？

> ID：10406545
> 
> 赞同：1
> 
> 时间：2012-05-02T01:23:30.013
> 
> 标签：ruby, twitter, hashtag

我想知道是否有人可以帮助我理解下面的 Ruby 代码？我对 Ruby 编程很陌生，并且无法理解每个函数的含义。

当我使用我的 twitter 用户名和密码作为参数运行它时，我会得到一个 twitter 提要样本流。我需要对此代码做什么才能仅显示主题标签？

我试图每 30 秒收集一次主题标签，然后从主题标签的出现次数最少到最多进行排序。

不是在寻找解决方案，而是在寻找想法。谢谢！

```
require 'eventmachine'
require 'em-http'
require 'json'

usage = "#{$0} <user> <password>"
abort usage unless user = ARGV.shift
abort usage unless password = ARGV.shift

url = 'https://stream.twitter.com/1/statuses/sample.json'

def handle_tweet(tweet)
  return unless tweet['text']
  puts "#{tweet['user']['screen_name']}: #{tweet['text']}"
end

EventMachine.run do
  http = EventMachine::HttpRequest.new(url).get :head => { 'Authorization' => [ user, password ] }

  buffer = ""

  http.stream do |chunk|
    buffer += chunk
    while line = buffer.slice!(/.+\r?\n/)
      handle_tweet JSON.parse(line)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:44:29.983

```
puts "#{tweet['user']['screen_name']}: #{tweet['text']}" 
```

该行显示用户名，后跟推文的内容。

让我们退后一步。

散列标签出现在推文的内容中——这意味着它们在推文['text'] 中。哈希标记始终采用 # 后跟一堆非空格字符的形式。使用正则表达式真的很容易掌握。Ruby 的核心 API 通过[String#scan](http://ruby-doc.org/core-1.9.3/String.html#method-i-scan)实现了这一点。例子：

```
"twitter is short #foo yawn #bar".scan(/\#\w+/) # => ["#foo", "#bar"] 
```

你想要的是这样的：

```
def handle_tweet(tweet)
  return unless tweet['text']
  # puts "#{tweet['user']['screen_name']}: #{tweet['text']}" # OLD
  puts tweet['text'].scan(/\#\w+/).to_s
end 
```

**tweet['text'].scan(/#\w+/)**是一个字符串数组。你可以用这个数组做任何你想做的事情。假设您是 Ruby 新手，并且想要将哈希标签打印到控制台，这里有一个关于使用 puts 打印数组的简要说明：

```
puts array      # => "#foo\n#bar"
puts array.to_s # => '["#foo", "#bar"]' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:53:05.590

```
#Load Libraries
require 'eventmachine'
require 'em-http'
require 'json'

# Looks like this section assumes you're calling this from commandline.
usage = "#{$0} <user> <password>"  # $0 returns the name of the program
abort usage unless user = ARGV.shift  # Return first argument passed when program called
abort usage unless password = ARGV.shift

# The URL
url = 'https://stream.twitter.com/1/statuses/sample.json'

# method which, when called later, prints out the tweets
def handle_tweet(tweet)
  return unless tweet['text']  # Ensures tweet object has 'text' property
  puts "#{tweet['user']['screen_name']}: #{tweet['text']}"  # write the result
end

# Create an HTTP request obj to URL above with user authorization
EventMachine.run do
  http = EventMachine::HttpRequest.new(url).get :head => { 'Authorization' => [ user, password ] }

  # Initiate an empty string for the buffer
  buffer = ""

  # Read the stream by line
  http.stream do |chunk|
    buffer += chunk
    while line = buffer.slice!(/.+\r?\n/)  # cut each line at newline
      handle_tweet JSON.parse(line)   # send each tweet object to handle_tweet method
    end
  end
end 
```

这是来源正在做什么的评论版本。如果您只想要主题标签，则需要将 handle_tweet 重写为如下内容：

```
handle_tweet(tweet)
  tweet.scan(/#\w/) do |tag|
    puts tag
  end
end 
```

# objective-c - 点击推送通知时不显示正确的视图控制器

> ID：10406548
> 
> 赞同：1
> 
> 时间：2012-05-02T01:24:02.983
> 
> 标签：objective-c, ios, xcode

我已经实现了推送通知，并试图在用户点击通知时将用户带到另一个视图控制器（而不是只打开应用程序）。我离开了苹果网站的例子，但还没有运气。

似乎它甚至从未按应有的方式进入我的代码。我尝试放置一个 NSLog 来证明这一点，我是对的。

有谁知道为什么？我想要实现的视图控制器称为 statsViewController。

谢谢

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {  

NSDictionary *remoteNotif = [launchOptions objectForKey: UIApplicationLaunchOptionsRemoteNotificationKey];

if (remoteNotif) {      

    NSLog (@"We are here now");
    [self handleRemoteNotification:application userInfo:remoteNotif]; //custom method where View controller will be implemented
    return YES;
}

[window addSubview:tabBarController.view];
[window makeKeyAndVisible];

return YES;
}

-(void) handleRemoteNotification:(UIApplication *)application userInfo:(NSDictionary *)userInfo {
application.applicationIconBadgeNumber = 0;

statsViewController* viewController = [[statsViewController alloc] init];
[navController pushViewController:viewController animated:YES]; //Don't think this is right since I never use it in didFinishLaunching... I simply just declared it delegate.h
[viewController release];

 } 
```

# javascript - 将使用“new”关键字的 Javascript 函数表达式视为“静态”是否正确

> ID：10406552
> 
> 赞同：27
> 
> 时间：2012-05-02T01:24:43.103
> 
> 标签：javascript

我只是想更深入地理解 Javascript。

我创建了一个“类” `gameData`，我只想要一个，不需要构造函数或实例化。

所以我就这样创造了它......

```
var gameData = new function () {

    //May need this later 
    this.init = function () { 
    };

    this.storageAvailable = function () {
        if (typeof (Storage) !== "undefined") {
            return true;
        }
        else {
            return false;
        }
    };
} 
```

意识到“new”关键字不允许实例化它并使其可用，就像 C# 中的静态类一样。

我是否正确地考虑了这一点？作为静态的？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-02T01:31:47.070

不，它不是静态的，因为它仍然有一个`constructor`指向您的“匿名”函数的属性。在您的示例中，您可以使用

```
var gameData2 = new (gameData.constructor)(); 
```

重新实例化第二个对象，因此“类”（实际上是实例）并不是真正的“静态”。您基本上是在*泄漏*构造函数，可能还有绑定到它的数据。此外，确实会创建一个*无用*的原型对象 ( `gameData.constructor.prototype`) 并插入到 的原型链中`gameData`，这不是您想要的。

相反，您可以使用

*   一个单一的、简单的对象文字（如[Daff 的回答](https://stackoverflow.com/a/10406569/1048572)）。这意味着您没有构造函数，没有闭包范围的私有变量（无论如何您都没有使用过），也没有（自定义）原型。
*   （揭示）模块模式（如[jAndy 的回答](https://stackoverflow.com/a/10406568/1048572)）。在那里，您将有一个[IIFE](https://stackoverflow.com/q/8228281/1048572)来创建闭包范围的变量，并且可以返回任何类型的对象。
*   一个实际的构造函数（“类”），可以在以后（需要时）实例化，并始终产生相同的单例对象。

这就是单例模式的样子：

```
function GameData() {
    if (this.constructor.singleton)
        return this.constructor.singleton;
    else
        this.constructor.singleton = this;

    // init:
    // * private vars
    // * public properties
    // ...
}
GameData.prototype.storageAvailable = function () {
    if (typeof (Storage) !== "undefined") {
        return true;
    }
    else {
        return false;
    }
};

var gameData = new GameData();
var gameData2 = new GameData();
gameData === gameData2 === GameData.singleton; // true 
```

然而，原型毫无用处，因为您只有一个`GameData`. 只有继承才会变得有趣。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-02T01:28:05.793

ECMAscript中没有*Class*，只有*Object*。

当`new`用于调用函数时，我们称其为*构造函数*。一旦完成，这个函数有点自动返回一个新对象。`this`使用（引用新创建的对象）存储在该对象中的任何数据都作为该对象的属性返回。除此之外，`new`将一个名为*构造*函数的属性设置为该函数。

在您的情况下，您甚至不需要使用`new`，您可以轻松地重写代码，如下所示：

```
var gameData = (function () {
    var public = { },
        private = { }; // any private data can get stored here

    //May need this later 
    public.init = function () { 
    };

    public.storageAvailable = function () {
        if (typeof (Storage) !== "undefined") {
            return true;
        }
        else {
            return false;
        }
    };

    return public;
}()); 
```

这称为*工厂模式*、*单例模式*、*模块模式*，可能还有其他名称。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-02T01:28:09.367

我认为您正在寻找的只是一个简单的 JavaScript 对象：

```
var gameData = {
    //May need this later 
    init : function () { 
    },

    storageAvailable : function () {
        if (typeof (Storage) !== "undefined") {
            return true;
        }
        else {
            return false;
        }
    }
} 
```

如果您想使用私有变量，请创建一个显示模块模式样式的包装器。这基本上是 jAndy 的建议：

```
var gameData = (function() {
    var private = 'private variable';

    return {
        //May need this later 
        init : function () { 
        },

        storageAvailable : function () {
            if (typeof (Storage) !== "undefined") {
                return true;
            } else {
                return false;
            }
        }
    }
})(); 
```

# python - App Engine 批次放得太大？

> ID：10406553
> 
> 赞同：2
> 
> 时间：2012-05-02T01:24:44.673
> 
> 标签：python, google-app-engine, google-cloud-datastore

当我进行批量放置时，我偶尔会收到此错误。

> RequestTooLargeError：对 API 调用 datastore_v3.Put() 的请求太大。

触发此操作的`db.put`调用对 1000 多个实体的列表进行调用。每个实体都有一个`db.TextProperty`字段，填充了大约 20,000 个字符。每个实体也有一个父实体，尽管列表中没有一个实体被传递来`db.put`共享一个共同的父实体。每个父实体存储大约 10 个整数并且不是很大。

我的第一直觉是拆分传递给的实体的数量`db.put`，但是

关于这个原因的任何想法？

**编辑：**拆分实体确实有效。例如，我可以这样做：

```
for entity in entities: entity.put() 
```

但是[这个问题](https://stackoverflow.com/questions/9351835/batch-put-limits)的答案表明，放置的实体数量应该无关紧要。所以还是一头雾水。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T16:17:24.117

请记住，查找实体大小的快速测试是尝试将其写入内存缓存。如果它超过 memcache 的 1 meg 限制，则写入将失败，您可以捕获异常。如果您按照尼克的建议隔离问题，可能会有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-13T10:18:31.217

到目前为止，我一直使用 StringProperty 并且遇到了同样的问题，当时存储在该属性中的数据最终变得太大（它刚刚超过 1 MB）。我现在可以使用 JsonProperty where 修复它`compressed=True`。可能是一种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T19:07:25.257

此批更新是否在事务中？[如果是这样，请记住事务大小](https://developers.google.com/appengine/docs/python/datastore/overview#Quotas_and_Limits)有 10 MB 的限制

# sql - 有什么可能的方法可以在我的 cakephp 模型关联中操作外键？

> ID：10406555
> 
> 赞同：1
> 
> 时间：2012-05-02T01:24:57.863
> 
> 标签：sql, cakephp, model

我现在正在我的代码中建立一对多的关系。下面是我的数据库：

```
TABLE: categories
FIELDS: category_id (primary)
        categoryName

TABLE: products
FIELDS: id (primary)
        productName
        category_id 
```

我希望 products.category_id 与 categories.category_id 通信，以便它选择具有相应 category_id 的产品。但是在我的代码中实际发生的是它通过我的产品中的 id 选择 category_id ，这是我的主键，它是这样的：

```
SELECT `Category`.`category_id`, `Category`.`categoryName`, `Category`.`description`, `Category`.`picture` FROM `categories` AS `Category` WHERE `Category`.`category_id` IN (3, 5, 6) 
```

值：3,5,6 是我的产品表中三个产品的主键。但应该是这样的

```
SELECT `Category`.`category_id`, `Category`.`categoryName`, `Category`.`description`, `Category`.`picture` FROM `categories` AS `Category` WHERE `Category`.`category_id` IN (1, 2, 3) 
```

其中值： 1,2,3 是我的产品表中的 category_id 对应于我的类别表中的 category_id

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:24:22.293

确保您的模型关联设置正确：

```
//Category model
public $hasMany = array('Product');

//Product model
public $belongsTo = array('Category'); 
```

并将`Category.category_i`d 更改为 just `Category.id`。

# ios - 如何在 iOS 应用程序的工具栏中添加空间填充分段控件？

> ID：10406564
> 
> 赞同：7
> 
> 时间：2012-05-02T01:27:20.130
> 
> 标签：ios, uitoolbar, uisegmentedcontrol

我有一个分段控制。每当视图完成出现时，我都会创建一个条形按钮项来保存它并将其设置为工具栏项。我遇到的问题是分段控件不会填充工具栏中的空间，即使它设置为具有空间填充行为。

如何在 iOS 应用程序的工具栏中有一个填充空间的分段控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T01:51:29.590

听起来您正试图从 UIToolbar 中获取非标准工具栏行为。为什么不直接放一个 UIView 并以正常方式用 UISegmentedControl 填充它？您需要 UIToolbar 的某些特定功能吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T11:38:19.747

UIView 通常没有“空间填充行为”。他们得到分配给他们的大小。你所能做的就是：

1.  设置他们的自动调整掩码以控制如果他们的父视图改变其大小，他们如何调整大小
2.  设置他们的 UIViewContentMode 来控制他们如何调整他们的内容（例如对 UIImageViews 很重要）

在您的情况下，您可以执行以下操作来获取包含与工具栏一样宽的 UISegmentedControl 的 UIToolbar：

```
(void)viewDidLoad
{
    [super viewDidLoad];

    //  Create the toolbar; place it at the bottom of the view.
    UIToolbar *myToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, self.view.bounds.size.height-44, self.view.bounds.size.width, 44)];
    myToolbar.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin;
    [self.view addSubview:myToolbar];

    //  Create the UISegmentedControl with two segments and "Bar" style. Set frame size to that of the toolbar minus 6pt margin on both sides, since 6pt is the padding that is enforced anyway by the UIToolbar.
    UISegmentedControl *mySegmentedControl = [[UISegmentedControl alloc] initWithFrame:CGRectInset(myToolbar.frame, 6, 6)];
    //  Set autoresizing of the UISegmentedControl to stretch horizontally.
    mySegmentedControl.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleBottomMargin;
    [mySegmentedControl insertSegmentWithTitle:@"First" atIndex:0 animated:NO];
    [mySegmentedControl insertSegmentWithTitle:@"Second" atIndex:1 animated:NO];
    mySegmentedControl.segmentedControlStyle = UISegmentedControlStyleBar; 

    //  Create UIBarButtonItem with the UISegmentedControl as custom view, and add it to the toolbar's items
    UIBarButtonItem *myBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:mySegmentedControl];
    myToolbar.items = [NSArray arrayWithObject:myBarButtonItem];
} 
```

# php - 如何对包含 csv 文件数据的表进行排序

> ID：10406566
> 
> 赞同：1
> 
> 时间：2012-05-02T01:27:43.917
> 
> 标签：php, usort

我必须根据用户选择的排序方式对表中的文件数据进行排序（只有选项是升序和降序）

这是我的代码：

```
if($submit=="Display"){
    if ($headings=="0"){echo "<h2>Error</h2>";}
    elseif ($search==""){echo "<h2>Error</h2>";}
    else {

        if($headings==$headings_array[0])
            echo "<table border='1'>";
            $f = fopen("data.csv", "r");

            while ($line = fgetcsv($f)){
            echo "<tr>";
                foreach ($line as $cell) {
                    echo "<td><center>".$cell."</center></td>";
                }
            echo "<tr>";
            }   
            fclose($f);

            function my_sort($a, $b){
                if ($a == $b) return 0;
                return ($a > $b) ? -1 : 1;
                }

            $arr = $cell;

            usort($arr, "my_sort");

            print_r ($arr);
            echo "</table>";
    }
} 
```

但这不是排序。有人可以发现它有什么问题吗？如果你有更有效的方法，请让我知道，因为我有 15 个，为每个标题`headings`做这件事会很痛苦。`if statements`

**要清楚，这是我必须做的：**

对于用户选择的每个排序字段（即标题），我必须根据该标题安排显示

IE`if($headings==$headings_array[0])`

`$headings_array[0]`等于`Names`因此，表格应按字母（或反字母）顺序显示值`Names`

**额外信息：**

`$headings`是选择框的名称 是选择框
`$headings_array`的数组值
`$search`是单选按钮，包含表格是否应该按升序或降序排序

*PHP only*

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:06:28.620

我认为您的排序功能是错误的。它的作用与 sort() 或 rsort() 相同。

usort 只是比较两个数组元素并根据您返回的值确定它们是否需要交换。您发送的 $a 和 $b 应该是 csv 行。然后你比较你需要的索引并相应地交换行。

您需要按标题给出的数组索引对其进行排序。也许尝试这样的事情：

```
global $headings;

...
$arrayToBeSorted = array();

// send in an array of lines
while ($line = fgetcsv($f)){
    $arrayToBeSorted[] = $line;
}

usort($arrayToBeSorted, 'my_sort');

function my_sort($lineA, $lineB){
    // set this to the column that needs to be sorted
    global $headings;

    $linePartsA = explode(',' $lineA);
    $linePartsB = explode(',' $lineB);
    if ($linePartsA[$headings] == $linePartsB[$heading) return 0;
        return ($linePartsA[$headings] > $linePartsB[$heading]) ? -1 : 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:47:33.720

为什么你只想使用 php 。我使用了非常高效的 jquery 表排序器。这里是链接[表排序器](http://tablesorter.com/docs/)

# ios - 另一个内存管理问题

> ID：10406567
> 
> 赞同：1
> 
> 时间：2012-05-02T01:28:00.683
> 
> 标签：ios, memory-management

我的应用程序运行良好，直到我停止它并重新启动 - 于是存档文件 - highScores.archive 存在。然后，应用程序停止编码 - 我在第一行得到一个 EXC_BAD_ACCESS（很长一段时间，直到我到达我正在编码的日期对象才发生。

我的猜测是我需要在几个地方放置一个保留，但我不知道在哪里。

编码：

FlipHighScores.h

...

```
@interface FlipHighScores : NSObject <NSCoding> {
//NSString *themeChosen;
NSInteger newHighScore;
NSInteger newScoreStartLevel;
NSInteger newScoreFinishLevel;
NSDate *scoreDateCreated;}

@property (copy, nonatomic) NSString *themeChosen;
@property (nonatomic) NSInteger highScore;
@property (nonatomic) NSInteger scoreStartLevel;
@property (nonatomic) NSInteger scoreFinishLevel;
@property (nonatomic, readonly, strong) NSDate *scoreDateCreated; 
```

...

FlipHighScores.m ...

```
@synthesize themeChosen = _themeChosen;
@synthesize highScore = _highScore;
@synthesize scoreStartLevel = _scoreStartLevel;
@synthesize scoreFinishLevel = _scoreFinishLevel;
@synthesize scoreDateCreated = _scoreDateCreated; 
```

...

```
-(void)encodeWithCoder:(NSCoder *)aCoder {
[aCoder encodeObject:_themeChosen forKey:@"_themeChosen"];
NSLog(@"Theme Chosen is %@", _themeChosen);
[aCoder encodeInt:_highScore forKey:@"_highScore"];
[aCoder encodeInt:_scoreStartLevel forKey:@"_scoreStartLevel"];
[aCoder encodeInt:_scoreFinishLevel forKey:@"_scoreFinishLevel"];
NSLog(@"Date Created in encodeWithCoder is %@", _scoreDateCreated);
[aCoder encodeObject:_scoreDateCreated forKey:@"_scoreDateCreated"];}

-(id)initWithCoder:(NSCoder *)aDecoder {
if (self) {
    _themeChosen = [aDecoder decodeObjectForKey:@"_themeChosen"];
    _highScore = [aDecoder decodeIntForKey:@"_highScore"];
    _scoreStartLevel = [aDecoder decodeIntForKey:@"_scoreStartLevel"];
    _scoreFinishLevel = [aDecoder decodeIntForKey:@"_scoreFinishLevel"];
    _scoreDateCreated = [aDecoder decodeObjectForKey:@"_scoreDateCreated"];
}
return self;}

-(NSString *)description {
NSDate *date = _scoreDateCreated;
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
[dateFormatter setDateStyle:NSDateFormatterShortStyle];
NSString *dateString = [dateFormatter stringFromDate:date];
//NSLog(@"dateString from description is %@", dateString);
NSString *descriptionString = [[NSString alloc] initWithFormat:@"%d %@ S:%d F:%d D:%@", _highScore, _themeChosen, _scoreStartLevel, _scoreFinishLevel, dateString];
return descriptionString:} 
```

我发现令人困惑的是，如果我删除保存文件 - highScores.archive 并运行该应用程序，它可以毫无问题地运行。我停止并终止应用程序，然后重新启动它 - 第一次编码称为崩溃。

在我对 themeChosen 对象进行编码的那一行。我已经阅读了一些关于通过“保留”或更改为 . 格式（为什么会有帮助，我不太明白）。但这是编码。解码可能是下一个问题......

我没有在这个项目上使用 ARC。也许当我从头开始重建整个事情时......

哦，我忘了提到在我添加跟踪主题变量之前，一切都运行顺利，直到我测试过。然后事情变得有点不对劲，就像这里提到的那样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T03:32:35.077

我认为您的问题出在您的`-initWithCoder`. 您正在获取结果`-decodeObjectForKey:`并将其直接分配给合成的 ivar。通常假定名称中没有“复制”一词的方法返回自动释放的对象。

如果您直接将自动释放的对象分配给变量，则该对象将在下一个运行循环中释放，将自行释放，现在您的变量指向垃圾内存。当您尝试访问它时，您将获得一个`exec_bad_access`.

您*应该*做的是利用`@synthesize`为您创建的访问器方法。代替

`_themeChosen = [aDecoder decodeObjectForKey:@"_themeChosen"];`

你应该写

`[self setThemeChosen:[aDecoder decodeObjectForKey:@"_themeChosen"]];`

或者，如果你肯定*必须*使用等号，你可以使用“点符号”的语法糖：

`self.themeChosen = [aDecoder decodeObjectForKey:@"_themeChosen"]`

这最终将被翻译成接近相同的东西。

关键是：合成的 setter 不仅仅是将对象分配给 ivar。它还保留对象（实际上，在这种情况下，它*复制*对象，因为您`copy`在`@property`声明中指定）。这只是您永远不应该直接访问 ivars 并*始终使用访问器的**众多*原因之一——尤其是现在它们基本上是由/自动为您编写的。*`@property``@synthesize`*

 ***更新：**
你会发现你在`scoreDateCreated`看到你`readonly`在声明中声明它时遇到了麻烦`@property`。为什么是只读的？它似乎不是派生值，因此您显然必须为其分配一些东西。

如果您希望它在您的对象中读/写，但只想公开一个只读接口，您可以`@property`在`FlipHighScores.m`. 因此，它*看起来*只对包含标头的任何内容都是只读的，但*实际上*在对象的实现中是读/写的。*

# jquery - 单击 jquery 按钮 + 发送没有表单的数据 - 书签

> ID：10406571
> 
> 赞同：9
> 
> 时间：2012-05-02T01:28:44.273
> 
> 标签：jquery, ajax, codeigniter, codeigniter-2

我正在开发一个书签功能，用户单击 jQueryui 按钮并将某些信息发送到数据库。但我没有使用表格，因为没有信息供用户输入。

我正在从会话数据中提取用户 ID，并且正在发送一个 URI 段（URL 的一部分）

使用 codeigniter/php。

我试图弄清楚在 ajax/post 函数的数据部分中放入什么，因为没有输入表单/没有数据，以及如何处理控制器的“提交”部分。

**控制器**

```
function addBookmark(){

        if ($this->input->post('submit')) {

            $id = $this->session->userdata('id');               
            $bookmark = $this->uri->segment(3, 0);

            $this->bookmarks_model->postBookmark($id, $bookmark);
        }

    } 
```

**模型**

```
function postBookmark() {

     $data = array(
            'user_id' => $user_id,
            'bookmark_id' => $bookmark,
    );

    $this->db->insert('bookmarks', $data);

    } 
```

**HTML**

```
<button class="somebutton">Add bookmark</button> 
```

**jQuery**

```
$('.somebutton').click(function() { 

            $.ajax({
                url: 'controller/addBookmark',
                type: 'POST',
                data: ???,
                success: function (result) {
                  alert("Your bookmark has been saved");
                }
            });  

    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T01:38:18.690

您的问题是您正在检查args`submit`中的键。`POST`您可以通过发送`data: {submit:true}`或删除 if 语句并仅处理 POST 请求来伪造它

```
$('.somebutton').click(function() { 

        $.ajax({
            url: 'controller/addBookmark',
            type: 'POST',
            data: {'submit':true}, // An object with the key 'submit' and value 'true;
            success: function (result) {
              alert("Your bookmark has been saved");
            }
        });  

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:32:35.573

而不是使用`.ajax()`use[`.get()`](http://api.jquery.com/jQuery.get/)或[`.post()`](http://api.jquery.com/jQuery.post/)

使用`.get()`

```
 $.get('controller/addBookmark',function(data){ 
     alert('Your bookmark has been saved'); 
 }); 
```

使用`.post()`

```
 $.post('controller/addBookmark', function(data) {
     alert('Your bookmark has been saved, The contents of the page were:' + data); 
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:47:01.010

来自[jQuery.ajax()的文档](http://api.jquery.com/jQuery.ajax/)

> 要发送到服务器的数据。如果还不是字符串，则将其转换为查询字符串。它附加到 GET 请求的 url。

如果您不知道为数据添加什么内容，您可能应该删除该选项吗？在您的控制器函数 addBookmark() 中，您可以通过删除 if 检查来减少代码。试试这个，看看它是否适合你。

# objective-c - 获取断点检索地址簿数据

> ID：10406572
> 
> 赞同：1
> 
> 时间：2012-05-02T01:28:46.567
> 
> 标签：objective-c, ios, xcode, abaddressbook

我正在检索`phoneNumbers`，我得到一个断点。我花了过去几个小时试图修复它，但仍然没有运气。

```
-(void)textMessage{
ABAddressBookRef addressBook = ABAddressBookCreate();
NSMutableArray *array =[[NSMutableArray alloc]init];
NSMutableArray *temp;
NSMutableArray *temp2 = [[NSMutableArray alloc]init];
for(int i =0;i<[savedPeople count];i++){

    NSString *temp = (NSString*) ABAddressBookCopyPeopleWithName(addressBook, (CFStringRef)[savedPeople objectAtIndex:i]);
    NSLog(@"%@",temp);
    [temp2 addObject:temp];
    ABRecordRef thisPerson = (ABRecordRef)[temp2 objectAtIndex:i];
    ABMultiValueRef phoneProperty = ABRecordCopyValue(thisPerson, kABPersonPhoneProperty);
    NSLog(@"%@",phoneProperty);
}

array = temp2;
NSLog(@"%@",array);
CFRelease(addressBook);
} 
```

![1] [http://min.us/mQOzL3w5V](http://min.us/mQOzL3w5V)

有人知道它有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:32:29.810

断点是您设置的东西，而不是错误。转到断点检查器： ![在此处输入图像描述](../Images/a14443e6e437533942b90e0b874fe8a8.png)

并删除您在那里找到的任何条目。您还可以使用 Breakpoints 按钮暂时关闭断点：

![在此处输入图像描述](../Images/12ef428f4fa7c73ee568b8b1a900c4e6.png)

或通过菜单命令 Product>Debug>Deactivate Breakpoints。

# javascript - Format.js 和渲染 json 在 Rails 中组合？

> ID：10406574
> 
> 赞同：3
> 
> 时间：2012-05-02T01:28:52.860
> 
> 标签：javascript, ruby-on-rails, model-view-controller, render

我需要从 Rails 控制器传递 json 对象和 format.js .. 如果我这样做

```
 respond_to do |format|
     format.js 
    end 
```

我让 javascript 文件 (controllername.js) 运行。如果我做

```
 respond_to do |format|
     format.js {render json: @thing} 
    end 
```

我得到了json..

有没有办法两者兼得？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:36:02.243

```
respond_to do |format|
  format.json { render json: @thing }
  format.js
end 
```

它将根据请求同时响应。

# oracle - 我可以为索引和表设置默认表空间吗？

> ID：10406579
> 
> 赞同：6
> 
> 时间：2012-05-02T01:30:46.447
> 
> 标签：oracle, indexing

目前，默认情况下创建表和索引 DDL 会将表放置在 中`MYDB_DATA_TABLE_SPACE`，我想为表数据中的索引指定不同的默认表空间，这样我就不必总是在我的创建索引 DDL 中明确提及这一点。这可能吗？

当前的：

```
Table -> MYDB_DATA_TABLE_SPACE 
```

必需的：

```
Table -> MYDB_DATA_TABLE_SPACE
Index -> MYDB_INDX_TABLE_SPACE 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T03:08:21.850

您不能为索引和表指定不同的默认表空间。每个用户只能获得一个默认表空间。

希望您不会出于性能原因尝试维护单独的表空间。有一个相对常见的神话，您可以通过将数据和索引存储在单独的表空间中来提高性能。我个人不太喜欢将索引和数据放在不同的表空间中——没有性能差异，在没有索引表空间的情况下运行应用程序的可能性极小，因此没有任何可恢复性优势。我知道它可以吸引一些人的组织感，所以我不会断然反对。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T03:04:51.870

对不起，没有办法做到这一点。

可以为每个用户设置一个默认表空间，但它适用于所有段的创建：表、索引、物化视图等。

希望有帮助。

# java - java：中断线程是绝对必要的吗

> ID：10406581
> 
> 赞同：6
> 
> 时间：2012-05-02T01:31:11.823
> 
> 标签：java, multithreading, interrupt

我是 Java 新手，使用某人给出的代码。在那里，在代码的末尾，如果线程还没有完成，他们会中断它。我正在测量代码的时间。

问题是 Java 代码首先发出所有线程，然后在最后中断。有必要打断吗？我们不能等到所有线程真正完成吗？或者可能只是跳过中断（这些线程正在使用 process exec 命令运行进程，它们无论如何都会完成）。这是相关的代码。首先是单个线程的代码：

```
 String commandString = "./script.scr ";
  process = Runtime.getRuntime().exec(commandString);
  BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
  while ((lsString = bufferedReader.readLine()) != null)
        {
            System.out.println(lsString);
        }       
        try
        {
            process.waitFor();
        } 
```

现在分派这些线程的部分的代码：

```
public void stopWhenAllTaskFinished()
{
    while(notFinished) {sleep(50);} //notFinished is class variable and somewhere else it will set to false. 
    //now finished.
  //Interrupt all the threads
    for (int i=0; i<nThreads; i++) {
        threads[i].interrupt();
    }
} 
```

这个函数是从主类调用的，例如：

```
 obj.stopWhenAllTaskFinished() 
```

我非常感谢任何见解或答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:43:12.993

Oracle 在 javadocs 中提供的以下代码是大多数人所做的。AFAIK，这旨在杀死拒绝在给它们关闭的机会后正常关闭的线程。

[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)

```
 void shutdownAndAwaitTermination(ExecutorService pool) {
   pool.shutdown(); // Disable new tasks from being submitted
   try {
     // Wait a while for existing tasks to terminate
     if (!pool.awaitTermination(60, TimeUnit.SECONDS)) {
       pool.shutdownNow(); // Cancel currently executing tasks
       // Wait a while for tasks to respond to being cancelled
       if (!pool.awaitTermination(60, TimeUnit.SECONDS))
           System.err.println("Pool did not terminate");
     }
   } catch (InterruptedException ie) {
     // (Re-)Cancel if current thread also interrupted
     pool.shutdownNow();
     // Preserve interrupt status
     Thread.currentThread().interrupt();
   }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:05:58.997

目前尚不清楚您发布的代码是否需要中断。

*   如果`notFinished`设置为`false`当所有线程都完成时，则不需要中断。

*   如果`notFinished`设置为`false`某些线程可能尚未完成时，则*可能有*必要。是否真的有必要取决于其他事情：

    *   您是否准备好让应用程序等待线程自然完成？
    *   你能确定线程*会*完成吗？（他们可以永远挂起/阻塞吗？）
    *   你需要他们活动的结果吗？
    *   他们会响应中断吗？（在这种情况下，我认为答案是“是”。）
    *   把线留在那里有什么害处吗？（例如，它会阻止应用程序关闭吗？）

# richfaces - 富脸下拉选择

> ID：10406582
> 
> 赞同：2
> 
> 时间：2012-05-02T01:31:15.163
> 
> 标签：richfaces, drop-down-menu

我的下拉列表中显示了一长串项目。那么这可以限制richface下拉选择列表中的项目数量吗？将启用首选分页。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T16:58:55.560

作为替代解决方案，您可以使用自动完成组件

请参阅此处的示例[http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=autocomplete](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=autocomplete)

# delphi - 将 TScrollBox 内的 TImage 放大/缩小到特定焦点？

> ID：10406584
> 
> 赞同：6
> 
> 时间：2012-05-02T01:31:45.710
> 
> 标签：delphi, controls, zooming, delphi-xe2, mousewheel

我正在制作一个基于 a `TScrollingWinControl`（以及从 a 复制的代码`TScrollBox`）和一个控件的简单`TImage`控件。我有点让缩放工作，但它不一定缩放到焦点 - 滚动条不会相应地改变以保持中心点在焦点上。

我希望能够告诉这个控件`ZoomTo(const X, Y, ZoomBy: Integer);`告诉它将焦点缩放到哪里。因此，当它缩放时，我传递的坐标将保持“居中”。同时，我还需要一个`ZoomBy(const ZoomBy: Integer);`告诉它在当前视图中保持居中的方法。

例如，会有一种情况，鼠标指向图像的特定点，当按住控件并向上滚动鼠标时，它应该放大焦点在鼠标指针上。另一方面，另一种情况是滑动控件来调整缩放级别，在这种情况下，它只需要保持当前视图的中心（不一定是图像的中心）聚焦。

问题是我的数学在这一点上迷路了，我想不出正确的公式来调整这些滚动条。我尝试了几种不同的计算方法，似乎没有任何效果。

这是我的控制的剥离版本。我只删除了大部分相关的东西，原始单元超过 600 行代码。下面最重要的程序是`SetZoom(const Value: Integer);`

```
unit JD.Imaging;

interface

uses
  Windows, Classes, SysUtils, Graphics, Jpeg, PngImage, Controls, Forms,
  ExtCtrls, Messages;

type
  TJDImageBox = class;

  TJDImageZoomEvent = procedure(Sender: TObject; const Zoom: Integer) of object;

  TJDImageBox = class(TScrollingWinControl)
  private
    FZoom: Integer; //level of zoom by percentage
    FPicture: TImage; //displays image within scroll box
    FOnZoom: TJDImageZoomEvent; //called when zoom occurs
    FZoomBy: Integer; //amount to zoom by (in pixels)
    procedure MouseWheel(Sender: TObject; Shift: TShiftState;
      WheelDelta: Integer; MousePos: TPoint; var Handled: Boolean);
    procedure SetZoom(const Value: Integer);
    procedure SetZoomBy(const Value: Integer);
  public
    constructor Create(AOwner: TComponent); override;
  published
    property Zoom: Integer read FZoom write SetZoom;
    property ZoomBy: Integer read FZoomBy write SetZoomBy;
    property OnZoom: TJDImageZoomEvent read FOnZoom write FOnZoom;
  end;

implementation

{ TJDImageBox }

constructor TJDImageBox.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  OnMouseWheel:= MouseWheel;
  ControlStyle := [csAcceptsControls, csCaptureMouse, csClickEvents,
    csSetCaption, csDoubleClicks, csPannable, csGestures];
  AutoScroll := True;
  TabStop:= True;
  VertScrollBar.Tracking:= True;
  HorzScrollBar.Tracking:= True;
  Width:= 100;
  Height:= 100;
  FPicture:= TImage.Create(nil);
  FPicture.Parent:= Self;
  FPicture.AutoSize:= False;
  FPicture.Stretch:= True;
  FPicture.Proportional:= True;
  FPicture.Left:= 0;
  FPicture.Top:= 0;
  FPicture.Width:= 1;
  FPicture.Height:= 1;
  FPicture.Visible:= False;
  FZoom:= 100;
  FZoomBy:= 10;
end;

destructor TJDImageBox.Destroy;
begin
  FImage.Free;
  FPicture.Free;
  inherited;
end;

procedure TJDImageBox.MouseWheel(Sender: TObject; Shift: TShiftState;
  WheelDelta: Integer; MousePos: TPoint; var Handled: Boolean);
var
  NewScrollPos: Integer;
begin
  if ssCtrl in Shift then begin
    if WheelDelta > 0 then
      NewScrollPos := Zoom + 5
    else
      NewScrollPos:= Zoom - 5;
    if NewScrollPos >= 5 then
      Zoom:= NewScrollPos;
  end else
  if ssShift in Shift then begin
    NewScrollPos := HorzScrollBar.Position - WheelDelta;
    HorzScrollBar.Position := NewScrollPos;
  end else begin
    NewScrollPos := VertScrollBar.Position - WheelDelta;
    VertScrollBar.Position := NewScrollPos;
  end;
  Handled := True;
end;

procedure TJDImageBox.SetZoom(const Value: Integer);
var
  Perc: Single;
begin
  FZoom := Value;
  if FZoom < FZoomBy then
    FZoom:= FZoomBy;
  Perc:= FZoom / 100;
  //Resize picture to new zoom level
  FPicture.Width:= Trunc(FImage.Width * Perc);
  FPicture.Height:= Trunc(FImage.Height * Perc);
  //Move scroll bars to properly position the center of the view
  //This is where I don't know how to calculate the 'center'
  //or by how much I need to move the scroll bars.
  HorzScrollBar.Position:= HorzScrollBar.Position - (FZoomBy div 2);
  VertScrollBar.Position:= VertScrollBar.Position - (FZoomBy div 2);
  if assigned(FOnZoom) then
    FOnZoom(Self, FZoom);
end;

procedure TJDImageBox.SetZoomBy(const Value: Integer);
begin
  if FZoomBy <> Value then begin
    FZoomBy := EnsureRange(Value, 1, 100);
    Paint;
  end;
end;

end. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T23:18:24.270

在传递给“ZoomBy()”时，不清楚您想为 X、Y 指代什么。我假设您已经为图像放置了一个“OnMouseDown”处理程序，并且坐标指的是您单击图像的位置，即它们与滚动框坐标无关。如果不是这样，您可以自己调整它。

让我们暂时忘记缩放，让我们的任务以单击滚动框中图像的点为中心。很简单，我们知道滚动框的中心在 (ScrollBox.ClientWidth/2, ScrollBox.ClientHeight/2)。考虑水平，我们想向上滚动到一个点，如果我们将 ClientWidth/2 添加到它，它将是我们的点击点：

```
procedure ScrollTo(CenterX, CenterY: Integer);
begin
  ScrollBox.HorzScrollBar.Position := CenterX - Round(ScrollBox.ClientWidth / 2);
  ScrollBox.VertScrollBar.Position := CenterY - Round(ScrollBox.ClientHeight / 2);
end; 
```

现在考虑缩放。我们所要做的就是相应地计算 X、Y 位置，滚动框的大小不会改变。`CenterX := Center.X * ZoomFactor`. 但要注意，这里的'ZoomFactor'不是有效缩放，它是我们点击图像时将应用的缩放。我将使用图像的前后尺寸来确定：

```
procedure ZoomTo(CenterX, CenterY, ZoomBy: Integer);
var
  OldWidth, OldHeight: Integer;
begin
  OldWidth := FImage.Width;
  OldHeight := FImage.Height;

  // zoom the image, we have new image size and scroll range

  CenterX := Round(CenterX * FImage.Width / OldWidth);
  ScrollBox.HorzScrollBar.Position := CenterX - Round(ScrollBox.ClientWidth / 2);

  CenterY := Round(CenterY * FImage.Height / OldHeight);
  ScrollBox.VertScrollBar.Position := CenterY - Round(ScrollBox.ClientHeight / 2);
end; 
```

当然，您可以将它们重构为一行，以便仅调用 Round() 一次以减少舍入误差。

我相信你可以从这里自己锻炼。

# javascript - 为什么我的画布不绘制？

> ID：10406587
> 
> 赞同：1
> 
> 时间：2012-05-02T01:31:51.173
> 
> 标签：javascript, html, canvas

我的画布元素无法正常工作。它不会画一个矩形。请帮我诊断问题。我不知道问题出在哪里，是我的css、javascript还是html？我是否正确设置了所有内容，因为当我运行调试器并将其放在服务器上时没有出现错误？

索引.html

```
<!DOCTYPE html>
<html>
<head>
<title>Paco Developement</title>
<link rel="stylesheet" href="style.css" />
<script src="game.js"></script>
</head>
<body>
<canvas id="canvasBg" height="500" width="800"></canvas>
<canvas id="character" height="500" width="800"></canvas>
</body>
</html> 
```

样式.css

```
* {
padding:0px;
margin:0px;
}

header, section, footer, aside, nav, article, figure, hgroup{
    display:block;
}

body {
background:#BADA55;
width:100%;
height:100%;
}

#canvasBg {
display:block;
background:#fff;
margin:100px auto 0px;
}

#character {
display:block;
margin:-500px auto 0px;
} 
```

游戏.js

```
var canvasBg = document.getElementById('canvasBg');
var bgCtx = canvasBg.getContext("2d");

document.addEventListener('load',drawRect,false);

function drawRect(){
bgCtx.fillStyle="#FF0000";
bgCtx.fillRect(0,0,150,75);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:48:36.943

**[现场演示](http://jsfiddle.net/8HgVU/)**

更改`document`为`window`您的事件侦听器，它应该适合您。

```
window.addEventListener('load',drawRect,false); 
```

# http - API 需要查询字符串中的 POST 参数？

> ID：10406588
> 
> 赞同：16
> 
> 时间：2012-05-02T01:32:19.973
> 
> 标签：http, rest, twitter, http-post

我正在使用 Twitter API 并注意到一些有趣的事情——对于更新，它们需要 POST 方法，但需要查询字符串中的参数。（例如，请参阅[此处](https://dev.twitter.com/console)的开发者控制台中的状态/更新调用。）

显然这在技术上是可行的，但为什么有人会那样做呢？POST 参数不属于正文吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-02T01:54:30.040

任何一个选项都同样有效。我最喜欢在 POST 的 URL 中使用参数的示例是在地图上设置航点的应用程序。例如

```
 POST /map/route/45/waypoints?lat=35&long=74 
```

在这种情况下，参数在 URI 中作为位置标识符更有意义，而不仅仅是在正文中传递给通用资源的参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T06:59:47.663

在 REST 架构中，GET 和 POST 只是动词，它们告诉检索或创建/更新资源。URI 定义资源的标识。

例子：

```
POST /student?name=Tom&age=12 >> It will create a new student with name Tom and age 12.
POST /student/10?name=Tom&age=12 >> It will update student with id 20 with name Tom and age 12. 
```

没有规定数据应绑定到正文有效负载或 URI。这与在 POST 中发送 HTML 表单数据的 WEB 1.0 概念不同。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-30T10:26:51.117

WEB API 的参数是否在正文或查询中取决于您在 POST 中发送的 Content-Type 标头。

例如，如果是 Content-Type: application/json; charset=UTF-8 那么参数在正文中应为 json。如果是Content-Type：application/x-www-form-urlencoded；charset=UTF-8 那么参数应该在查询字符串中

# c# - 查找/替换功能 RichTextBox

> ID：10406594
> 
> 赞同：2
> 
> 时间：2012-05-02T01:32:57.853
> 
> 标签：c#

我想为我的 RichTextBox 进行查找和查找和替换功能。到目前为止，我发现 .Find() 函数非常方便，但我想不出让它跳到文本框中的下一个单词的好方法。

到目前为止，我有这个：

```
BeginIndex = txtDocument.Find(str, BeginIndex + WordLength, RichTextBoxFinds.None);
WordLength = str.Length; 
```

BeginIndex 是一个公共变量，从 0 开始，与 WordLength 相同。这样，它将开始查看第一个字符，而下一次它将找不到相同的字符。但是有一个很大的故障，让我试着描述一下：“Hello blablab hello blablaal balbalbla hello blabla” 如果我在这句话中寻找“hello”，它会选择第一个 hello，然后是第二个，然后是第三个，然后又是第三个。之后它会一遍又一遍地找到第二个和第三个。因为 WordLength 仍然 > 0。

所以我需要一种新的方法来告诉 Find() 方法它不允许找到已经找到的那个，而是继续前进，当找到最后一个时，回到第一个。有没有更干净、更好的方法来做到这一点？

编辑：它几乎是固定的，我现在使用它：

```
BeginIndex = txtDocument.Find(str, BeginIndex, RichTextBoxFinds.None);

if(BeginIndex == -1) {
    BeginIndex = 0;
    SearchString(str, heelwoord, casesensitive);
}

BeginIndex += str.Length; 
```

现在，这个循环非常好，而不是调用自己（int if），我还可以制作一个 MessageBox，上面写着“End is reached！”。但如果它什么也没找到，它会给我一个错误。我使用带有 2 个复选框的函数，一个执行 MatchCase，一个执行 WholeWord，但是当我在“asdasdasd”中查找“a”并检查 WholeWord 时，它会出错，因为它无法找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T11:59:02.890

您可能最好实现 Knuth-Morris Pratt 的算法，它可能比内部 .NET 解决方案更快，并且它可以让您准确知道字符串的位置。之后您可以执行子字符串连接魔术，将结果分配给 rtf 的文本，然后一切就绪。

[http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)

# android - 如何使用自定义适配器在 RelativeLayout 单击上打开 ContextMenu

ID：10406596

赞同：3

时间：2012-05-02T01:33:01.023

标签：android, contextmenu, android-fragments, android-relativelayout

# cassandra - 有什么方法可以为 cassandra 或 hector 使用 astyanax 进行异步放置？

> ID：10406597
> 
> 赞同：2
> 
> 时间：2012-05-02T01:33:06.340
> 
> 标签：cassandra, hector, astyanax

我想将一些文件流入和流出 cassandra，因为我们已经使用它而不是设置完整的 hadoop 分布式文件系统。是否有任何异步放置在 atyanax 或 hector 中，我在完成时提供回调，这样我可以避免 1000 次调用的 1 毫秒网络延迟，因为我写了 1000 个条目（在几行和几列之间拆分，所以它是流式传输的并行到几台服务器，然后所有响应/回调在完成流式传输时返回）。Hector 或 astyanax 是否支持这一点？

看起来 astyanax 支持查询回调，所以我想我可以使用主键将文件流回 astyanax？

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:02:00.973

Cassandra 实际上并不支持通过 thrift API 进行流式传输。此外，将文件分解为单个突变批次，将数据分布在多行和多列中可能非常危险。这可能会导致 cassandra 上的堆被炸毁，或者您也可能遇到 1MB 套接字写入缓冲区限制，在某些错误情况下，这实际上会导致您的 thrift 连接无限期挂起（尽管我认为这可能在最新版本的 cassandra 中得到修复） .

Astyanax (https://github.com/Netflix/astyanax/wiki/Chunked-Object-Store) 中的新分块对象存储配方建立在我们在 Netflix 在 Cassandra 中存储大型对象的经验之上，并提供了一个简单的 API 来处理所有为您分块和并行化。它仍然可以对 cassandra 进行 1000 次调用（取决于您的文件大小和块大小），但也可以为您处理所有重试和并行化。读取文件也是如此。API 将读取这些块并将它们按顺序重新组合成一个 OutputStream。

# jquery - 在 TBODY 中的第一个 TR 的最后一个 TD 中定位锚点 href

> ID：10406598
> 
> 赞同：3
> 
> 时间：2012-05-02T01:33:06.680
> 
> 标签：jquery, redirect, targeting

我想使用 jQuery 将到达此页面的人重定向到 TBODY（不是 THEAD）中第一个 TR 的最后一个 TD 的锚点中包含的链接：

```
<table id="allprogs" class="tablesorter">
<thead>
  <tr>
    <th>Date</th>
    <th>Speaker(s)</th>
    <th>Program Title</th>
    <th>MP3</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>2012: 05/01</td>
    <td>Speaker</td>
    <td><a href="/products/page">Title</a></td>
    <td><a href="http://www.dummy.com">Download</a></td>
  </tr>
  <tr>
    <td>2012: 04/01</td>
    <td>Speaker2</td>
    <td><a href="/products/page2">Title2</a></td>
    <td><a href="http://www.dummy2.com">Download</a></td>
  </tr> 
```

到目前为止，我的代码是：

```
$(document).ready(function() {
  var url = $('#allprogs tbody tr:first td:last a').attr('href');
  window.location.replace(url);
}); 
```

加载页面应重定向到[http://www.dummy.com](http://www.dummy.com)。但看来我没有正确定位锚。建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:40:34.987

jquery 定位实际上是正确的，

*   [示例 jsfiddle](http://jsfiddle.net/d8c2B/)

这是错误的行`window.location.replace(url);`，之后需要一个空格*`.replace`才能使重定向起作用。

您的新代码将如下所示：

```
$(document).ready(function() {
  var url = $('#allprogs tbody tr:first td:last a').attr('href');
  window.location.replace (url);
}); 
```

*编辑：

事实证明，空间不是必需的，而是更多的良好实践。除此之外，尽管您的其余代码都在工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:44:20.083

你的代码似乎没问题。不确定您到底想实现什么，看到看起来不错，最初应该做您想做的事情。您可以尝试提醒变量 url 并查看是否获得了正确的 url 地址。

警报（网址）；

[点击查看结果：](http://jsfiddle.net/Uwudr/1/)

# sqlalchemy - 将一个模型与单个关系中的多个其他模型相关联

> ID：10406604
> 
> 赞同：3
> 
> 时间：2012-05-02T01:34:53.117
> 
> 标签：sqlalchemy, flask, flask-sqlalchemy

我有一个模型`Thing`，它可以由几种类型的`Thing`like`PointyThing`和`TastyThing`. 我有第二个模型，`Instance`它与 s 一对多相关`Thing`（一个`Instance`可能是 single 的类型，但给定的 s`Thing`会有很多）。然后 s 与带有 backref 的 a （每个都有一个但 a有很多s）相关联，以便 a可以调用它的属性来查看它拥有什么。`Instance``Thing``Instance``Player``instance``Player``player``Instance``Player``.inventory`

一切都很好，但我也有一个模型`Place`。我希望`Place`s 也拥有`Instance`s ，就像 a`Player`拥有 an一样`instance`。

最好创建一个`Owner`与模型链接的`Instance`模型，然后将其子类化以获取`Player`s 和`Place`s 或我还不知道的 SQLAlchemy 中的一些迄今为止未知的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T11:44:30.637

我认为`best`您要求的解决方案取决于许多因素。

从技术上讲，如果我孤立地看你的例子，这个解决方案看起来像一个很好的下降**`hack`**，它避免了创建另一个`relationship`表。而且，如果您永远不会使用多态支持进行查询，那么这可能会很好。然而，它仍然是一个黑客。想象一下，稍后你`Player`用更多的子类扩展你的模型，你可能会开始使用多态查询，你总是要问自己`"how will it impact my hack"?`。即使一切仍然可以正常工作（现在我无法提出会破坏您的逻辑的示例），您仍然需要小心。
但是让我们看看这个黑客有什么好处？我们保存在一个`relationship`表上，但实际上您为`Owner`模型引入了另一个表（我假设[具体表继承](http://docs.sqlalchemy.org/en/rel_0_7/orm/inheritance.html#concrete-table-inheritance))，那么真正的收获是什么？

另一方面，我想知道您的`Instance`表是否实际上不应该是`ternary`关系？我假设 的每个实例`Thing`都存储在 some 中`Place`并且可能属于 a `Player`，所以它可能只是一个看起来像这样的表：

```
Instance[
    ID primary_key, 
    Thing_ID (FK) NOT NULL, 
    Place_ID (FK) NOT NULL, 
    Person_ID (FK) NULL
] 
```

请注意，这`Person_ID`是可以为空的，因为我假设 Thing 的实例在分配之前可能不属于任何人。但它可能总是`NOT NULL`在你的情况下。

*希望这可以帮助。了解你决定走哪条路以及为什么走会很好。*

# c++ - CoCreateInstance：创建在 .NET 库中定义的 COM 实例？

> ID：10406605
> 
> 赞同：1
> 
> 时间：2012-05-02T01:35:06.103
> 
> 标签：c++, .net, com, com-interop

我创建了一个在 IDL 中定义的 COM 库，它有一个名为 IFoo 的“入口点”：

```
[
    object,
    uuid(789b4d46-4028-4196-8412-4c5c8ef86caa),
    nonextensible,
    pointer_default(unique)
]
interface IFoo: IUnknown
{
    HRESULT HelloWorld();
}; 
```

我已经在我的 C# 库中实现了这个，如下所示：

```
[ComVisible(true)]
[Guid("45b50f1e-d551-4be0-b52a-7ec075840114")]
[ClassInterface(ClassInterfaceType.None)]
[ComDefaultInterface(typeof(IFoo))]
class Foo: IFoo
{
    public void HelloWorld()
    {
        Console.WriteLine("Hello world");
    }
} 
```

我编译了这个，并注册了它：

```
regasm.exe foo.dll 
```

到目前为止，一切看起来都很好。

现在，如何在我的 C++ 程序中创建它的实例？我认为正确的函数是 ::CoCreateInstance：

```
::CoInitializeEx(NULL, COINIT_MULTITHREADED); 
IUnknown *pUnk = 0;
HRESULT hr = ::CoCreateInstance(???, 
                                NULL, 
                                CLSCTX_INPROC_SERVER, 
                                __uuidof(IFoo), 
                               (void**)&pUnk); 
```

这是创建此类实例的正确方法吗？如果是这样，“？？？”中的内容是什么 以上？

我*认为*类的 UUID（上面的“45b50f1e-d551-4be0-b52a-7ec075840114”）应该放在那里，但我不知道如何从这个 GUID 字符串手动创建 IID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:13:34.510

事实证明，我是对的，类的 UUID 就在那里，但得到它是我没想到的：

```
struct __declspec(uuid("45b50f1e-d551-4be0-b52a-7ec075840114")) Cls; 
```

然后：

```
HRESULT hr = ::CoCreateInstance(__uuidof(Cls), 
                                NULL, 
                                CLSCTX_INPROC_SERVER, 
                                __uuidof(IFoo), 
                               (void**)&pUnk); 
```

这解决了问题并正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:12:46.613

只需使用`MIDL`将您的 IDL 文件编译成一组 C++ 文件并将它们包含到您的 C++ 程序中。请记住，接口不是“入口点”，您也将需要 IDL 中的类对象。

在 C++ 中创建 COM 客户端的另一种方法是 Microsoft 特定`#import`指令，但我不确定它是否与基于 .NET 的组件兼容。如果你可以为你的 .NET 组件创建一个 .tlb 文件，你可以像这样添加需要的东西：

```
#import "MyLibrary.tlb" 
```

该指令有很多选项。查看此[MSDN 文章](http://msdn.microsoft.com/en-us/library/298h7faa.aspx)了解详细信息。

# django - Django - AttributeError => 'set' 对象没有属性 'get'

> ID：10406606
> 
> 赞同：1
> 
> 时间：2012-05-02T01:35:20.903
> 
> 标签：django, attributes, django-forms, django-templates

我正在阅读 Django 1.0 网站开发这本书，您可以在其中构建一个小型社交书签应用程序。我在第 5 章中创建了一个表单来添加书签，尽管我已经按照说明进行操作，并且几天来一直在努力解决这个错误。我得到错误：

```
AttributeError at /save/
'set' object has no attribute 'get' 
```

该错误在模板 {{ form.as_p }} 的第 6 行引发

views.py 代码是：

```
def bookmark_save_page(request):
    if request.method == 'POST':
        form = BookmarkSaveForm(request)
        if form.is_valid():
            # create or get link.
            link, dummy = Link.objects.get_or_create(
                url=form.cleaned_data['url']
            )
            # create or get bookmark.
            bookmark, created = Bookmark.objects.get_or_create(
                user=request.user,
                link=link
            )
            # if bookmark is being updated, clear the old tag list
            if not created:
                bookmark.tag_set.clear()
            # create new tag list
            tag_names = form.cleaned_data['tags'].split()
            for tag_name in tag_names:
                tag, dummy = Tag.objects.get_or_create(name=tag_name)
                bookmark.tag_set.add()
            # save bookmark to database
            bookmark.save()
            return HttpResponseRedirect(
                '/user/%s/' % request.user.username
            )
        else:
            form = BookmarkSaveForm()
            variables = RequestContext(request, {
                'form' : form
            })
            return render_to_response('bookmark_save.html', variables) 
```

模板代码是：

```
{% extends "base.html" %}
{% block title %}Save Bookmark{% endblock %}
{% block head %}Save Bookmark{% endblock %}
{% block content %}
<form method="post" action=".">{% csrf_token %}
    **{{ form.as_p }}**
    <input type="submit" value="save" />
</form>
{% endblock %} 
```

任何帮助将不胜感激，因为我被困在书中的这一点上，似乎找不到答案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T05:01:41.050

这对你来说是一个错误吗？

```
for tag_name in tag_names:
    tag, dummy = Tag.objects.get_or_create(name=tag_name)
    bookmark.tag_set.add()  # not adding the tag? 
```

不应该是： `bookmark.tag_set.add(tag)`？这`.add()` 实际上不会导致错误，但我知道您没有添加标签。

没有看到追溯，我猜。

我的另一个猜测是您可能错误地使用了 RequestContext？

```
return render_to_response('bookmark_save.html',
                              {'form': form},
                              context_instance=RequestContext(request)) 
```

我相信您现在使用它的方式是用于使用 HttpResponse() 的非快捷方式

# c# - 从实体模型轻松创建 MVC ViewModel？

> ID：10406609
> 
> 赞同：1
> 
> 时间：2012-05-02T01:35:52.997
> 
> 标签：c#, asp.net-mvc-3, viewmodel

在 ASP.NET MVC 中工作时，我经常发现自己定义了一个基本的 ViewModel，它的所有属性只是实际实体模型的一小部分。然后，我使用[AutoMapper](http://automapper.codeplex.com/)将我的对象正确地转换为实体模型和从实体模型中转换出来。这很好用，并且很好地分离了我的关注点。但是，我认为现在有人已经制作了一个工具来简化这个过程！在创建我的 ViewModel 时所有重复的输入不可避免地会导致拼写错误和一些挫败感。

您使用什么工具（如果有）来解决这个问题？

谢谢！

编辑：我不介意用适当的 UI 提示、验证器等来装饰我的属性。我只是讨厌一次又一次地定义相同的属性名称！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:46:13.523

您可以考虑使用 T4 模板，请参阅[此 MSDN 杂志文章](http://msdn.microsoft.com/en-gb/magazine/hh882448.aspx)以开始使用。您可以创建一个使用反射来获取模型属性的模板，并从中生成 ViewModel。

# asp.net-mvc-3 - 温莎城堡中带参数的 DI

> ID：10406611
> 
> 赞同：1
> 
> 时间：2012-05-02T01:36:04.043
> 
> 标签：asp.net-mvc-3, inversion-of-control, castle-windsor, controlleractioninvoker

我正在尝试解决这样的依赖：

```
controller.ActionInvoker = kernel.Resolve<IActionInvoker>(controller.GetType()); 
```

之前是这样注册的：

```
container.Register(
    Component
        .For<IActionInvoker>()
        .ImplementedBy<WindsorActionInvoker>()
        .UsingFactoryMethod(metho)
        .LifestylePerWebRequest()
);

internal IActionInvoker metho(IKernel kernel,ComponentModel model, CreationContext context)
{
    // here just for debugging and watching the variables in the factory method, 
    // I would instance WindsorActionInvoker passing the filters to inject.
    throw new InvalidOperationException();
} 
```

但是我不知道如何获取我传递给工厂方法中的解析调用的参数。

我需要将`Type`我作为参数传递给注入到具体类型的构造函数中的依赖项之一。

我究竟做错了什么？

* * *

如果您必须知道，这样做的目的是将动作过滤器直接注入动作调用程序（以及控制器），而不是要求它们装饰控制器或基本控制器，此外，这让我可以动态注入参数，我不能与属性有关。

```
public class WindsorActionInvoker : ControllerActionInvoker
{
    private readonly IList<IActionFilter> actionFilters;
    private readonly IList<IAuthorizationFilter> authorizationFilters;
    private readonly IList<IExceptionFilter> exceptionFilters;
    private readonly IList<IResultFilter> resultFilters;

    public WindsorActionInvoker(IList<IActionFilter> actionFilters, IList<IAuthorizationFilter> authorizationFilters, IList<IExceptionFilter> exceptionFilters, IList<IResultFilter> resultFilters)
    {
        if (actionFilters == null)
        {
            throw new ArgumentNullException("actionFilters");
        }
        if (authorizationFilters == null)
        {
            throw new ArgumentNullException("authorizationFilters");
        }
        if (exceptionFilters == null)
        {
            throw new ArgumentNullException("exceptionFilters");
        }
        if (resultFilters == null)
        {
            throw new ArgumentNullException("resultFilters");
        }
        this.actionFilters = actionFilters;
        this.authorizationFilters = authorizationFilters;
        this.exceptionFilters = exceptionFilters;
        this.resultFilters = resultFilters;
    }

    protected override FilterInfo GetFilters(ControllerContext controllerContext, ActionDescriptor actionDescriptor)
    {
        FilterInfo filterInfo = base.GetFilters(controllerContext, actionDescriptor);
        foreach (IActionFilter filter in actionFilters)
        {
            filterInfo.ActionFilters.Add(filter);
        }
        foreach (IAuthorizationFilter filter in authorizationFilters)
        {
            filterInfo.AuthorizationFilters.Add(filter);
        }
        foreach (IExceptionFilter filter in exceptionFilters)
        {
            filterInfo.ExceptionFilters.Add(filter);
        }
        foreach (IResultFilter filter in resultFilters)
        {
            filterInfo.ResultFilters.Add(filter);
        }
        return filterInfo;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:08:26.023

解决了，我需要传递字典或匿名类型，而不仅仅是任何对象。

更换：

```
controller.ActionInvoker = kernel.Resolve<IActionInvoker>(controller.GetType());} 
```

和

```
controller.ActionInvoker = kernel.Resolve<IActionInvoker>(new { loggerType = controller.GetType() }); 
```

解决它。

:)

# css - Caroufredsel 仅干扰下拉菜单 IE

> ID：10406614
> 
> 赞同：1
> 
> 时间：2012-05-02T01:36:21.190
> 
> 标签：css, wordpress, drop-down-menu, z-index, caroufredsel

我一直在一个网站上工作，并且在 IE 中遇到了一个问题，只要我在其下运行 Caroufredsel，下拉菜单就不起作用......

如果您在此处加载这两个站点，您可以看到发生了什么：

在 IE7+ [http://rjgraphics.com.au/test/amstest](http://rjgraphics.com.au/test/amstest)中工作 （这是在放入 caroufred sel 之前的早期版本）

[在 IE http://rjgraphics.com.au/test/ams](http://rjgraphics.com.au/test/ams)中不起作用 （“产品”项目应该有下拉菜单）

似乎对 Caroufredsel 和阻止菜单下拉的 css 有一些干扰......

如何解决 Caroufredsel 和下拉菜单之间的冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T05:40:21.847

我认为可能存在 jQuery 冲突，所以为了避免此类问题，您为什么不使用[twitter bootstrap](http://twitter.github.com/bootstrap/javascript.html)

# objective-c - Objective-C JSON 类型

> ID：10406616
> 
> 赞同：1
> 
> 时间：2012-05-02T01:36:36.463
> 
> 标签：objective-c, ios, json, macos, nsjsonserialization

我[`NSJSONSerialization JSONObjectWithData:options:error:`](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html#//apple_ref/occ/clm/NSJSONSerialization/JSONObjectWithData%3aoptions%3aerror%3a)在 iOS 5 项目中使用读取 JSON 字符串并将其转换为 Foundation 对象。有没有一种简单的方法可以确定对象或其某些子对象是数组、字典、数字还是字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:58:43.073

可以通过该方法检查返回的对象是否是某个类`-isKindOfClass:`。例如，要检查它是否是一个数组：

```
id jsonObj = [NSJSONSerialization JSONObjectWithData:...]
if ([jsonObj isKindOfClass:[NSArray class]] {
    // Do array stuff...
} 
```

其他基础类型也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:59:30.997

所有对象都可以回答它们的类。更有用的是，您可以询问某物是否是某个类或其任何子类的成员：

```
id jsonParse;

if ([jsonParse isKindOfClass:[NSArray self]]) {
    for (id element in (NSArray *)jsonParse) {

        // and so on
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T01:39:56.803

请谨慎使用`NSJSONSerialization`，因为它仅支持 iOS 5.0+ 和 Mac OS X 10.7+。

我认为您也可以尝试使用第三方库，例如：

*   [JSONKit](https://github.com/johnezang/JSONKit)（比`NSJSONSerialization`它的介绍更快）
*   [SBJson](http://stig.github.com/json-framework/)

两者都易于使用且灵活。

# jquery - 如何让 $(this) 在通过 jquery “单击时”从

> ID：10406621
> 
> 赞同：0
> 
> 时间：2012-05-02T01:36:54.560
> 
> 标签：jquery, html-lists, onclicklistener, jquery-events

我有一个动态创建的`<ul>`样式菜单，我想找出`<li>`点击了哪个。

经过多次尝试，我无法让它识别出哪个`<li>`被点击了。我已经尝试将“点击”附加到每个`<li>`和`<ul>`. 我还参加了 Lynda.com 上的两门 Javascript 和一门 jQuery 课程。

我最好的结果是使用 Javascript 获得一个空的警报框。因此，在经历了令人沮丧的三天之后，我再次来到这里寻求帮助。

```
<script>$(".qmli").on('click', function() { 
        alert($(this).text());
    });
</script>

<ul id="qm0" class="qmmc">
    <li><a class="qm-startopen qmparent" href="javascript:void(0)">Top menu</a>
        <ul>
            <li><a class="qmparent" href="javascript:void(0)">Plants</a>
                <ul>
                    <li>class='qmli" <a href="javascript:void(0)">Flowers</a></li>
                    <li>class='qmli" <a href="javascript:void(0)">Trees</a></li>
                </ul>
            </li>
            <li><a class="qmparent" href="javascript:void(0)">Animals</a>
                <ul>
                    <li>class='qmli" <a href="javascript:void(0)">Lions</a></li>
                    <li>class='qmli" <a href="javascript:void(0)">Tigers</a></li>
                </ul>
            </li>
    <li>class='qmli" <a href="#">Overview</a></li>
    <li>class='qmli" <a href="javascript:void(0)">Publicity</a></li>
        </ul>
    </li>
    <li class="qmclear">&nbsp;</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:44:04.090

1）摆脱`href="javascript:void(0)"`。这是不好的做法。改为使用`href="#"`。

2) 怎么了`<li>class='qmli"`？应该是`<li class="qmli">`。

3）你想要获取`<a>`元素，你还应该把你的代码放在一个 DOMReady 函数中。像这样：

```
$(document).ready(function() {
    $(".qmli a").click(function(e) { 
        alert($(this).text());
        e.preventDefault(); //Essentially the equivalent of javascript:void(0); 
    });
}); 
```

为了获得最佳效果，应该放在`<head>`.

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:44:14.227

您粘贴的标记绝对无效。我很确定任何一个

```
<li>class='qmli" <a href="javascript:void(0)">Lions</a></li> 
```

应该是这样的

```
<li class="qmli"><a href="javascript:void(0)">Lions</a></li> 
```

然后你的代码就可以正常工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T01:57:43.450

**问题**

修复类并删除`javascript:void(0)`'s 是很好的第一步，但是您还需要记住将 jquery 包装在 $(document).ready() 函数中。（阅读我附在底部的参考资料）

我已经修复了你的 html 和你的 jquery，并通过修复你的标记和代码中的所有问题，我已经产生了你想要达到的结果。

*   [jsfiddle 示例](http://jsfiddle.net/ZnAQa/1/)

* * *

**编码**

html:

```
<ul id="qm0" class="qmmc">
    <li><a class="qm-startopen qmparent" href="#">Top menu</a>
        <ul>
            <li><a class="qmparent" href="#">Plants</a>
                <ul>
                    <li class="qmli"><a href="#">Flowers</a></li>
                    <li class="qmli"><a href="#">Trees</a></li>
                </ul>
            </li>
            <li><a class="qmparent" href="#">Animals</a>
                <ul>
                    <li class="qmli"><a href="#">Lions</a></li>
                    <li class="qmli"> <a href="#">Tigers</a></li>
                </ul>
            </li>
    <li class="qmli"><a href="#">Overview</a></li>
    <li class="qmli"> <a href="#">Publicity</a></li>
        </ul>
    </li>
    <li class="qmclear">&nbsp;</li>
</ul>​ 
```

jQuery：

```
$(document).ready(function() {

    $(".qmli").click(function() {

        alert($(this).text())
        preventDefault()
    });

});​ 
```

* * *

**参考**

*   [document.ready()](http://www.learningjquery.com/2006/09/introducing-document-ready)

*   [html类](http://www.w3.org/TR/html401/struct/global.html#h-7.5.2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T01:57:56.497

两个错误

1.`<li class='qmli'>`不是`<li>class='qmli'`

2.您将脚本放在标记之上，因此您必须将其包装在 ready() 处理程序中

```
<script>
$(document).ready(){
$(".qmli").on('click', function() { 
        alert($(this).text());
    });
    });

</script> 
```

# ssl - 保护具有 cname 记录的 url

> ID：10406626
> 
> 赞同：13
> 
> 时间：2012-05-02T01:37:55.947
> 
> 标签：ssl, dns, cname

我有一个站点，其中包含每个用户的子域和通配符 SSL 证书

[https://user1.mysite.com](https://user1.mysite.com)

[https://user2.mysite.com](https://user2.mysite.com)

问题是有人可以设置一个 cname 记录，例如 user1.theirsite.com -> user1.mysite.com 并让它仍然使用 https 吗？

如果他们在服务器上安装 SSL 证书以保护连接，它会起作用吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-04T11:11:57.720

实现此目的的最佳方式是，如果他们*与您安排让您的 SSL 证书在**您的*X.509 证书中包含其“别名”作为`Subject Alternate Name`扩展名。

 *这是一些 CDN 在`https`为客户端托管站点时使用的方法 - 他们将托管在一台服务器上的所有已知站点名称放在一个大型 SSL 证书中，然后客户端使用 CNAME 将其域指向正确的 CDN 服务器.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-02T01:46:06.367

主机名和证书验证（实际上，检查是否使用了 SSL）完全由客户端负责。

主机名验证将由客户端完成，如[RFC 2818](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)中所指定，基于他们在其 URL 中请求的主机名。主机名 DNS 解析是基于 CNAME 条目还是其他任何内容都无关紧要。

如果用户`https://user1.theirsite.com/`在他们的浏览器中输入，则目标站点上的证书应该对`user1.theirsite.com`.

如果他们有自己的服务器`user1.theirsite.com`，与 不同`user1.mysite.com`，DNS CNAME 条目将没有意义。假设这两个主机实际上是不同的，它们可以拥有自己的有效证书`user1.theirsite.com`并重定向到`https://user1.theirsite.com/`. 重定向也将在地址栏中可见。

如果您真的想拥有一个来自`user1.theirsite.com`to的 CNAME `user1.mysite.com`，他们也许可以给您他们的证书和私钥，以便您也可以在您的站点上托管它，使用服务器名称指示（假设相同的端口，当然还有相同的 IP 地址，因为您'正在使用 CNAME）。这适用于支持 SNI 的客户端。然而，他们给你他们的私钥会有一定的风险（通常不推荐）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-19T18:24:14.620

以下设置和工作：

`a.corp.com`-> CNAME `b.corp2.com`-> A 的DNS 条目`1.2.3.4`

haproxy`1.2.3.4`将提供证书，`a.corp.com`并且网站可以从网络服务器后端正常加载。

因此，在您的服务器上，您将需要`user1.theirsite.com`证书并且它会起作用。*

# haskell - 修改并返回带有修改元素的列表

> ID：10406628
> 
> 赞同：1
> 
> 时间：2012-05-02T01:38:01.133
> 
> 标签：haskell

我正在尝试修改数据库列表中的一个元素以添加到评分中，我想返回一个修改后的数据库，其中包含新元素。我知道 Haskell 有不可变的东西，但同时我不能完全掌握如何去做。

以下是类型：

```
data Film = Film Director Title Year Ratings
     deriving (Show,Ord,Eq, Read)

testDatabase :: [Film] 
```

我唯一的代码是：

```
--addRating :: Rating -> Film -> Film
--addRating rating (Film name director year ratings)= (Film name director year [(ratings : rating)])

--findFilm name = head $ filter (\(Film n _ _ _) -> n == name) testDatabase 
```

查找电影效果很好，但我无法让 addRating 工作，即使它确实工作我仍然不明白如何将它们全部组合在一起以调用函数以返回具有元素的电影列表新的评级就可以了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:52:47.127

你几乎说对了：

```
addRating rating (Film name director year ratings)
    = (Film name director year [(ratings : rating)]) 
```

目前你有代码：

```
[(ratings : rating)] 
```

`:`运算符具有 type `a -> [a] -> [a]`，它需要一个元素并将其附加到列表的开头*，*而不是列表的末尾，因此您需要切换参数。

此外，语法`[x]`，当像您一样使用时，会创建一个由一个元素组成的列表。如果您在此处使用它，它将获取您创建的列表并将其包装在另一个列表中，这不是您想要的。

您只需要制作一个列表，其中包含`rating`前面的其余部分`ratings`：

```
(rating : ratings) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T02:46:34.050

正如 Porges 所说，你得到`rating`了`ratings`错误的顺序。您可能会发现记录语法方法更符合您的喜好：

```
data Film = Film {director :: Director, title :: Title, year :: Year, ratings :: Ratings}
                deriving (Show,Ord,Eq, Read)

addRating :: Rating -> Film -> Film
addRating rating film = film {ratings = rating : ratings film} 
```

在这里，`film {director = "Martin Scorsese"}`'updates'`director`字段，即表达式引用了`Film`一个不同的导演，但其他一切都相同。但是，在当前情况下，您需要旧`ratings`字段的内容，因此您需要`rating`在`ratings film`. 这种声明类型的方式使派生`Show`具有不同的外观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T03:13:21.813

> ...我无法让 addRating 工作，即使它确实工作我仍然不明白如何将它们全部组合在一起以调用一个函数来返回一个包含新评级元素的电影列表在上面。

似乎您想要一个返回新数据的函数，以一种可以“在旧数据所在的位置”访问的方式。

这里要理解的关键是*，*仅此一项就会使其成为可变数据。

函数式编程提供的一件事是保证数据始终相同。在命令式（非函数式）语言中，如果您有多个可能会更改数据的进程，则必须小心它们不会以意想不到的方式修改彼此的数据。不可变的数据使这不是问题。

如果您真的想要破坏性更新，有办法做到这一点。但是，您可能正在寻找的是[State monad](http://learnyouahaskell.com/for-a-few-monads-more#state)，这是一种很好的方式来“携带”状态而无需破坏性更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T04:19:27.827

对“不可变事物”的关键理解是，您不需要*修改*给定的事物，您只需创建一个稍微不同的“副本”并将其作为结果返回。例如，您有一个`l`包含`[1,2,3]`. 当你这样做时`l ++ [4]`，你会回来`[1,2,3,4]`，*但价值`l`没有改变*。

对你的电影记录使用同样的原则——你已经很接近了。

正如其他人指出的那样，您在`(ratings : rating)`表达式中混淆了您的类型。要使用`:`，元素在前面，列表在后面。您可以切换您的类型，但这会将新评级放在前面，这可能是您不想要的。另一种方法是使用`++`，它附加*两个列表*。因此，要使用`++`，您需要从单个元素中创建一个列表，并将其附加到现有评级中。

```
addRating :: Rating -> Film -> Film
addRating rating (Film name director year ratings) =
    (Film name director year (ratings ++ [rating])) 
```

# javascript - 如何以编程方式抓取网页并“单击”javascript 按钮？

> ID：10406631
> 
> 赞同：1
> 
> 时间：2012-05-02T01:38:20.690
> 
> 标签：javascript, screen-scraping

我正在尝试抓取一个网页以进行工作，其中有数百个带有复选框的表格行，并提交我需要单击一个调用 javascript 函数的按钮的表单。html 中的按钮如下所示：

```
<a onclick="JavaScript: return verifyChecked('Resend the selected request for various approvals?');"
id="_ctl0_cphMain_lbtnReapprove"
title="Click a single request to send to relevant managers for reapproval."
class="lnkDBD" href="javascript:__doPostBack('_ctl0$cphMain$lbtnReapprove','')"
style="border-color:#0077D4;border-width:1px;border-style:Solid;text-decoration: overline;">&nbsp;Resend&nbsp;</a> 
```

我知道对于美丽汤之类的库，您可以通过将帖子数据添加到 url 来提交表单，但是我如何选中复选框并“单击”这个 javascript 按钮？该网站是各种各样的帮助台，对于这个特定的按钮，我们一次只能检查一个请求，当有数百个请求需要重新提交时，这会花费很长时间。

当我选中复选框时，还会弹出一条消息，验证我想要这样做，我不知道这是否会影响以编程方式提交它。

编辑：我忘了包括 doPostBack 方法。

```
<script type="text/javascript"> 
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:45:57.560

获取 Firefox 和**Firebug**，打开**Firebug**加载页面，然后在控制台选项卡中查看它实际发送到服务器的内容。

然后只需使用您喜欢的任何工具重复发送的内容。

![在此处输入图像描述](../Images/d805a25287b44a55752e73a3f88a1665.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-05T08:54:08.040

你可能最好使用像 selenium 这样的浏览器自动化库来做这样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-06T13:56:23.597

尝试 Imacros。对于简单的浏览器自动化来说，它非常棒。您可以记录您的会话，并以此为基础编写代码。如果有更多的逻辑，非复杂文档中的标准编程可以让你走得更快。您也可以调用外部语言/脚本。例如，我将其用于一些项目：

1) 收集业务线索：一个站点有一个所有零售商店的列表，但不会将它们全部提供给用户输入的邮政编码。在电子表格中放置大量邮政编码，当运行时，将从 csv 中遍历每个邮政编码并抓取信息以存储在 csv 文件中。每 5 分钟会在 pc 上打开 VPN 程序并更改 ip。拿。20分钟制作。

我会安排你的编程然后好的，但我发现这是最好的方法，因为如果站点发生更改，它更容易调试，它们的“代码”非常简单，你可以轻松调用其他脚本和文件。Firefox 插件是最稳定和免费的。

# javascript - 如何使网页跟随浏览器窗口的大小，并且在调整大小时，布局不会失真？

> ID：10406632
> 
> 赞同：1
> 
> 时间：2012-05-02T01:38:51.453
> 
> 标签：javascript, html, css, jsp

我目前正在开发一个网页，并且通过在我的 CSS 的宽度和高度属性中使用百分比（％）值，我已经实现了在整个浏览器窗口中的拟合。现在的问题是，当我调整窗口大小时，所有内容都会被打乱和扭曲（例如标签、链接等）。有没有办法设置最小高度和宽度，以便在调整窗口大小时，这些属性是有限制的以防止布局被扭曲？

谢谢是提前！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:40:50.317

你实际上自己回答了这个问题。您可以使用 CSS 属性[`min-width`](http://reference.sitepoint.com/css/min-width)并[`min-height`](http://reference.sitepoint.com/css/min-height)分别为像容器这样的块级元素设置最小宽度和高度。

不过，更好的解决方案是使用[响应式设计](http://en.wikipedia.org/wiki/Responsive_Web_Design)，它会随着窗口的增长和缩小而不断调整自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T01:43:38.417

查看 css 属性 min-height：

[http://reference.sitepoint.com/css/min-height](http://reference.sitepoint.com/css/min-height)

和最小宽度：

[http://reference.sitepoint.com/css/min-width](http://reference.sitepoint.com/css/min-width)

您还可以查看一个简单的 CSS 框架，例如 StackLayout：

[http://stacklayout.com/](http://stacklayout.com/)

# android - SensorManager 上的应用程序崩溃

> ID：10406633
> 
> 赞同：0
> 
> 时间：2012-05-02T01:39:01.813
> 
> 标签：android, sensormanager

我正在开发一个我想在其中使用加速度计的 android 应用程序。但是每当我调用该方法时：

```
SensorManager sm = (SensorManager)context.getSystemService(Context.SEARCH_SERVICE); 
```

我的应用程序崩溃。

我的代码是：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    context = getApplicationContext();
    SensorManager sm = (SensorManager)context.getSystemService(Context.SEARCH_SERVICE);
    if(sm.getSensorList(Sensor.TYPE_ACCELEROMETER).size()!=0)
    {

        Sensor s = sm.getSensorList(Sensor.TYPE_ACCELEROMETER).get(0);
        sm.registerListener(this, s, SensorManager.SENSOR_DELAY_NORMAL);
    }

    x = y = sensorX = sensorY = 0;

} 
```

我在网上搜索过，但找不到任何解决方案。我在手机上而不是在模拟器上调试我的应用程序。请在这方面帮助我了解它为什么会崩溃以及如何修复它。

以下是日志猫错误：05-02 06:40:04.299: W/dalvikvm(9525): threadid=1: 线程退出未捕获异常 (group=0x40018578)

```
 05-02 06:40:04.309: E/AndroidRuntime(9525): FATAL EXCEPTION: main
   05-02 06:40:04.309: E/AndroidRuntime(9525): java.lang.RuntimeException: Unable to     start activity ComponentInfo{com.accelerometer/com.accelerometer.AccelerometerActivity}: java.lang.ClassCastException: android.app.SearchManager

   05-02 06:40:04.309: E/AndroidRuntime(9525):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.app.ActivityThread.access$1500(ActivityThread.java:117)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.os.Handler.dispatchMessage(Handler.java:99)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.os.Looper.loop(Looper.java:123)

  05-02 06:40:04.309: E/AndroidRuntime(9525):   at android.app.ActivityThread.main(ActivityThread.java:3687)

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at java.lang.reflect.Method.invokeNative(Native Method)

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at java.lang.reflect.Method.invoke(Method.java:507)

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at dalvik.system.NativeStart.main(Native Method)

 05-02 06:40:04.309: E/AndroidRuntime(9525): Caused by: java.lang.ClassCastException: android.app.SearchManager

 05-02 06:40:04.309: E/AndroidRuntime(9525):    at com.accelerometer.AccelerometerActivity.onCreate(AccelerometerActivity.java:24)

05-02 06:40:04.309: E/AndroidRuntime(9525):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)

05-02 06:40:04.309: E/AndroidRuntime(9525):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T01:49:37.000

```
SensorManager sm = (SensorManager)context.getSystemService(Context.SEARCH_SERVICE); 
```

这将返回一个 SearchManager，`getSystemService()`并且您无法将 SearchManager 转换为 SensorManager，关闭但不完全相同...

要获取 SensorManager，请尝试以下操作：（取自[开发指南](http://developer.android.com/reference/android/hardware/SensorManager.html)）

```
 public SensorActivity() {
     mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
     mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
 } 
```

# c# - 通过主网站的 URL 访问子 Web 应用程序中的页面

> ID：10406634
> 
> 赞同：-2
> 
> 时间：2012-05-02T01:39:04.643
> 
> 标签：c#, asp.net-mvc-3

我们有一个主要的经典 ASP 网站“www.main.com”。我们有一个通过“www.main.com/app”访问的 ASP.NET MVC3 Web 应用程序。

是否可以在 Web 应用程序中创建一个页面并通过“www.main.com/page-from-app”访问它？

如果主网站不需要更改，或者最多只进行很少的更改，这也是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:12:32.250

您是否尝试过[URL 重写](http://www.iis.net/download/URLRewrite)？

# java - Seam 2.3, JSF 2.0 - 对话传播

> ID：10406636
> 
> 赞同：2
> 
> 时间：2012-05-02T01:39:28.227
> 
> 标签：java, ajax, jsf, jboss, seam

我正在将我们的主要应用程序从 Seam 2.2 迁移到 Seam 2.3beta1，以便获得 JSF 2.0 和 JPA 2.0 的一些好处。在大多数情况下，它进展顺利。然而，JSF 2.0 和 Richfaces 4.x 中的一些 Ajax 更改被证明在移植代码时存在问题。

我有一系列根据其他内容填充的组件。例如，第一个菜单选择项目类别。选择值后，从数据库中检索该类别的子类别，并充当第二菜单的选择项目。这整个过程是对话范围的。目前，代码如下所示：

```
<h:selectOneMenu value="#{newObjAction.category}"
            required="true"
            requiredMessage="You must select a category"
            style="width:300px;">
        <s:selectItems var="cat"
            value="#{newDesignAction.designCategories}" label="#{cat.name}"
            noSelectionLabel="Select a category..."
            hideNoSelectionLabel="true" />
        <s:convertEntity />

        <a:support event="onchange" reRender="subCategoryPanel"
            limitToList="true" ajaxSingle="true" status="subCategoryStatus" />
</h:selectOneMenu> 
```

这在带有 JSF 1.2 的 Seam 2.2 中没有问题。但是，已从 JSF 2.0 中删除。我已经尝试过这样的事情：

```
<f:ajax listener="#{newObjAction.handleCategoryChange}"> 
```

它按预期触发事件，但有一个大问题：它没有传播对话。结果，当即将调用侦听器对象时，它被拦截，用户被重定向到定义`no-conversation-view-id`的 from `pages.xml`。使用时有什么方法可以传播对话`<f:ajax />`吗？有没有更好的方法来实现这一点？此时，整个迁移处于静止状态，因为这是应用程序中的主要组件。

我真的很感激任何帮助或建议。

# ruby - 编程 Ruby 老虎机游戏

> ID：10406637
> 
> 赞同：4
> 
> 时间：2012-05-02T01:39:31.947
> 
> 标签：ruby

我正在尝试用 Ruby 制作一个老虎机游戏，这就是我所得到的。它仍然无法运行，并说最后一行有错误，我不知道是什么或如何修复它。

我需要它有类似这样的输出：

> 你今天想玩多少钱？25
> 总现金：$ 25
> 您想下注多少？10
> 樱桃 - 橙子 - 橙子
> 你赢了 20 美元
> 你想继续吗？（是继续） 是
> 总现金：$ 35
> 您想下注多少？等等……</p>

我已经在那里设置了奖金，比如如果你得到两个，你赢了两倍的赌注，如果你得到三个，你赢了三倍的赌注。

但我得到了错误：`33: syntax error, unexpected $end, expecting kEND cash += cash + winnings`

我的代码有什么问题，我该如何解决？

```
 def multiplier(s1, s2, s3)

          if s1 == s2 and s2 == s3:
            multiplier = 3
          elsif s1 == s2 or s2 == s3 or s1 == s3:
            multiplier = 2
          else
            multiplier = 0;

          return multiplier

    def main()

    slotImageList = ['Cherry', 'Orange', 'Plum', 'Bell', 'Melon', 'Bar']

    cash = gets
    puts "How much total money would you like to play with today? " +cash
    while True:
        puts("Total cash:  $", cash)
        bet = gets
        puts "How much would you like to bet? " +bet

    cash = (cash - bet)

    slotImage1 = slotImageList.sample
    slotImage2 = slotImageList.sample
    slotImage3 = slotImageList.sample

    puts "slotImage1", " - ", "slotImage2", " - ", "slotImage3"

    winnings = bet * multiplier(slotImage1, slotImage2, slotImage3)
    puts "You have won $" +winnings

    cash = cash + winnings

    cont = gets
    puts "Would you like to continue? (yes to continue) " +cont
    if cont != "yes":
        puts "You have ended with $" +cash
    else
        puts " "
    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:47:57.407

当您看到消息时：

> 意外的 $end，期待 kEND

你可以把它翻译成*“我到达了文件结尾（“$end”），但我没想到，因为我还在等着看一个`end`声明。”* 这意味着您忘记输入至少一个 pair `end`，并且您需要检查您的代码并确保它正确缩进，以便您可以直观地匹配语句。

以下是修复代码正确的结果。在某些地方，您似乎使用缩进来关闭一个块（如 Python）而不是正确的语法。

```
def multiplier(s1, s2, s3)
  if s1==s2 && s2==s3
    3
  elsif s1==s2 || s2==s3 || s1==s3
    2
  else
    0
  end
end

def run_slots!
  slotImageList = %w[Cherry Orange Plum Bell Melon Bar]

  print "How much total money would you like to play with today? "
  cash = gets.chomp.to_i
  loop do
    puts "Total cash:  $#{cash}"
    print "How much would you like to bet? "
    bet = gets.chomp.to_i

    cash -= bet

    slotImage1 = slotImageList.sample
    slotImage2 = slotImageList.sample
    slotImage3 = slotImageList.sample

    puts "#{slotImage1} - #{slotImage2} - #{slotImage3}"

    winnings = bet * multiplier(slotImage1, slotImage2, slotImage3)
    puts "You have won $#{winnings}"

    cash += winnings

    print "Would you like to continue? (yes to continue) "
    unless gets.chomp=="yes"
      puts "You have ended with $#{cash}"
      break
    end
  end
end

run_slots! if __FILE__==$0 
```

如果我对它有更多的自由，我可能会这样写：

```
class SlotGame
  SLOT_COUNT = 3
  TOKENS     = %w[Cherry Orange Plum Bell Melon Bar]
  KEEP_PLAYING_RESPONSES = %w[y yes sure ok go]

  def initialize(cash=nil)
    unless cash
      begin
        print "How much total money would you like to play with today? "
        cash = gets.to_i
        puts "You must have a positive bank account to play!" if cash<=0
      end until cash > 0
    end
    @cash = cash
  end

  def play_forever
    begin
      # Using begin/end ensures one turn will be played
      # before asking the player if they want to go on
      play_one_turn
    end while @cash>0 && keep_playing?
    puts "You have ended with $#{@cash}; goodbye!"
  end

  def play_one_turn
    puts "Total cash: $#{@cash}"

    begin
      print "How much would you like to bet? "
      bet = gets.to_i
      puts "You only have $#{@cash}!" if bet > @cash
    end until bet <= @cash
    @cash -= bet

    results = SLOT_COUNT.times.map{ TOKENS.sample }
    puts results.join(' - ')
    winnings = bet * multiplier(results)

    if winnings>0
      @cash += winnings
      puts "You just won $#{winnings}!"
    else
      puts "Sorry, you're not a winner."
    end
  end

  def keep_playing?
    print "Would you like to continue? "
    KEEP_PLAYING_RESPONSES.include?(gets.chomp.downcase)
  end

  private # Don't let anyone outside run our magic formula!
    def multiplier(*tokens)
      case tokens.flatten.uniq.length
        when 1 then 3
        when 2 then 2
        else 0
      end
    end
end

SlotGame.new.play_forever if __FILE__==$0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T02:15:52.113

行！！！我想我已经从你的代码中弄清楚了，@Phrogz ！！！

为了从数组中随机选择，就像老虎机一样，我使用`slotImageList.shuffle.first`了 ，它对数组进行打乱，并获取打乱数组的第一个元素。

```
def multiplier(s1, s2, s3)
  if s1==s2 && s2==s3
    3
  elsif s1==s2 || s2==s3 || s1==s3
    2
  else
    0
  end
end

def run_slots!
  slotImageList = %w["Cherry", "Orange", "Plum", "Bell", "Melon", "Bar"]
  print "How much total money would you like to play with today? "
  cash = gets.chomp.to_i
  loop do
    puts "Total cash:  $#{cash}"
    print "How much would you like to bet? "
    bet = gets.chomp.to_i

    cash -= bet

    slotImage1 = slotImageList.shuffle.first
    slotImage2 = slotImageList.shuffle.first
    slotImage3 = slotImageList.shuffle.first

    puts "#{slotImage1} - #{slotImage2} - #{slotImage3}"

    winnings = bet * multiplier(slotImage1, slotImage2, slotImage3)
    puts "You have won $#{winnings}"

    cash += winnings

    print "Would you like to continue? (yes to continue) "
    unless gets.chomp=="yes"
      puts "You have ended with $#{cash}"
      break
    end
  end
end

run_slots! if __FILE__==$0 
```

非常感谢大家！！！:D

# android - 按钮中的冷却计时器

> ID：10406639
> 
> 赞同：1
> 
> 时间：2012-05-02T01:40:14.737
> 
> 标签：android, button, timer, progress-bar

我的应用程序中有一个按钮，我希望每 60 秒只能点击一次。一旦它被点击，它将被禁用，我想要某种冷却计时器，就像按钮内的进度条随着下一次点击的剩余时间减少而减少。

我`CountdownTimer`目前正在使用a，但我想知道如何在按钮内实现进度条，如上所述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:45:15.417

您应该使用 TimerTask。[这](http://developer.android.com/resources/articles/timed-ui-updates.html)是我认为与您的问题完美匹配的示例

# java - Hibernate：以列的值作为“键”获取映射，并将包含“键”的行列表 作为“值”

> ID：10406640
> 
> 赞同：2
> 
> 时间：2012-05-02T01:40:33.310
> 
> 标签：java, hibernate

下午好，

我有以下实体：

```
@Entity(name = "t_test")
public class Test {
    private int id;
    private String name;
    private String type;
.... 
```

我基本上想创建一个只返回一个 Map 的查询/条件，其中键是 Test.type 的不同值，而映射的值是具有相应类型属性的 Test 对象列表。例如：地图>

这可以在一个查询中完成吗？现在我只是获取所有内容并通过代码创建地图。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:24:19.490

您可以编写一个 ResultTransformer 来创建和返回地图，但这与您现在所做的并没有太大的不同。代码只是在不同的地方。

要生成`Map<String, List<Test>>`，无论如何您都需要从数据库中加载所有测试条目。除了按`type`. 您基本上必须在代码中制作地图。

# javascript - 从 iframe 中打开 iframe fancybox，使其在父级中打开

> ID：10406642
> 
> 赞同：0
> 
> 时间：2012-05-02T01:40:37.333
> 
> 标签：javascript, iframe, fancybox, parent

我可以让它工作，从 iframe 中打开一个花哨的图像

```
<a href="javascript:parent.$.fancybox.open({href : 'myurl'});">Open something</a> 
```

我的问题是我需要打开一个fancybox IFRAME。示例代码或任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T08:51:03.543

简单地说，设置类型`iframe`：

```
<a href="javascript:parent.$.fancybox.open({href : 'myurl', type: 'iframe'});">Open something in iframe</a> 
```

但是只有在需要不同选项时才应该这样做，因为您可以使用 iframe 打开其他页面，例如：

```
<a href="myurl">Open something in iframe</a> 
```

# c++ - 使用 tree.hh STL 填充 n 叉树

> ID：10406644
> 
> 赞同：0
> 
> 时间：2012-05-02T01:41:02.890
> 
> 标签：c++, tree

我如何使用[tree.hh：一个类似 STL 的 C++ 树类](http://tree.phi-sci.com/index.html)来填充我的树并获得下面的树。一些帮助将不胜感激。A 和 G 是根节点谢谢

```
 A            G
      ______|____        |
     /      |    \       |
    B       C     D      H
    |       |     |      |
    |       E     |      |
     \_____/      |      |
        |         |      |
        F         |      |
        |_________|______|
           |
           I
           |
           J 
```

在上面的代码中，我使用深度优先搜索来枚举列表中的项目。我很少有像这样格式化的数据

```
typedef tree<std::string> TreeNode;
typedef struct
{
    int   nBases;
    char * name;
} BASES;
BASES rgbases[] =
{
    {0xB, "J"},
    {0xA, "I"},
    {0x1, "H"},{0x0, "G"},
    {0x5, "F"},{0x2, "E"},{0x1, "C"},{0x0, "A"},
    {0x1, "D"},{0x0, "A"},
    {0x1, "B"},{0x0, "A"}
};

//here i'm trying to populate my tree
void populateTree(TreeNode &tr, BASES *pBaseArray, int numBase)
{
    int n = 0;
    while ( n < numBase )
    {
        BASES *pBase = &pBaseArray[n];
        if ( pBase->nBases > 0) // Check for children of the new node
            populateTree(tr, pBaseArray + (n + 1),pBase->nBases);
        // i suppose i need to insert tree code part here
        n += pBase->nBases + 1;
    }
}
void BuildTree(TreeNode &tr)
{
    populateTree(tr, rgBases, _countof(rgBases));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:59:58.467

在删除连接节点 A 与 B 和 D 的边（或者可能是连接节点 A 与 C 和 D 的边）时，可以获得一棵跨越所呈现的原始图的树。然后树类将适用：

```
 A            G                                   A            G 
            |            |                             ______|            |
            |            |                            /                   |
    B       C     D      H                           B       C     D      H 
    |       |     |      |                           |       |     |      | 
    |       E     |      |                           |       E     |      | 
    \______/      |      |                           \______/      |      |
        |         |      |                              |          |      |
        F         |      |                              F          |      |
        |_________|______|                              |__________|______| 
           |                                                | 
           I                                                I
           |                                                |
           J                                                J 
```

上述树中引起循环的边缘，可以单独记录，即 AB 和 AD，可以在树类之外的结构中记录。用这种结构合并树将恢复原始图。

# google-api - 替代 ClientLogin 进行身份验证

> ID：10406645
> 
> 赞同：11
> 
> 时间：2012-05-02T01:41:12.907
> 
> 标签：google-api, gdata-api

由于 Google 将 ClientLogin API 列为已弃用，因此推荐的替代方案是什么？就我而言，我需要一个服务器来使用我拥有的凭据进行身份验证和发布内容。OAuth 之类的替代方案在这种情况下不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T16:16:31.857

身份验证方法因应用程序的场景而异。[谷歌文档](https://developers.google.com/accounts/docs/OAuth2)报告的场景是：

*   登录
*   Web 服务器应用程序
*   客户端应用程序
*   已安装的应用程序设备
*   服务帐号

在您的情况下，Web 服务器应用程序场景可能很有用（如果您详细说明“在我的情况下我需要服务器进行身份验证”的含义，我可以更准确地说明这一点）。

但是，ClientLogin 的推荐替代方案是[OAuth2](https://developers.google.com/accounts/docs/OAuth2Login)。

# c++ - 矢量类成员不会被复制

> ID：10406647
> 
> 赞同：0
> 
> 时间：2012-05-02T01:41:38.680
> 
> 标签：c++, class, vector, copy, member

我正在尝试为我要编写的一个小程序实现一个菜单结构。

MenuItem 包含一个标签、一个关联函数、一个到其父级的链接和一个包含对其子级的引用的向量。然后是Menu，主要负责选择一个新的MenuItem，并跟踪当前哪个Item处于活动状态。不幸的是，当我在 Menu 中使用 MenuItem 并将当前的 MenuItem 更改为它的一个子项时，我无法再进一步，因为以下子项列表为空。似乎向量没有被正确复制。我试图实现一个复制构造函数，但这没有帮助。这是我的来源如下。

```
#include <iostream>
#include <sstream>
#include <string>
#include <vector>

typedef void (*fptr)(int);

using namespace std;

void test(int i)
{
    cout << "test function called with argument: " << i << endl;
}

class MenuItem
{
private:
    vector<MenuItem*> children;
    string label;
    fptr f;
    MenuItem* parent;
public:
    MenuItem(string newLabel, fptr newFunction = NULL):label(newLabel),f(newFunction)
    {
    }

    void addChild(MenuItem& mi)
    {
        mi.parent = this;
        children.push_back(&mi);
    }

    MenuItem* getChild(int i)
    {
        return children[i];
    }

    MenuItem* getParent()
    {
        return parent;
    }

    string getLabel()
    {
        return label;
    }

    int countChildren()
    {
        return children.size();
    }

    void list()
    {
        vector<MenuItem*>::iterator i;
        for(i = children.begin(); i < children.end(); ++i)
        {
            MenuItem* m = *i;
            label = m->label;
            stringstream s;
            s << (i - children.begin());
            cout << s.str() << ": " << label << endl;
        }
    }

    void invoke(int i)
    {
        f(i);
    }
};

class Menu
{
private:
    MenuItem* current;
public:
    Menu(MenuItem* m)
    {
        current = m;
        open(0);
    }

    void open(int i)
    {
        current = current->getChild(i);
        if(current->countChildren() > 0)
        {
            cout << "[" << current->getLabel() << "]" << endl;
            current->list();
        }
        else
            current->invoke(i);
    }

    void back(int i)
    {
        current = current->getParent();
    }
};

int main() {
    MenuItem m1("Root");
        MenuItem m2("List Media");
            MenuItem m6("List Movies",&test);
            MenuItem m7("List Music",&test);
            MenuItem m8("List Games",&test);
            MenuItem m9("List Books",&test);
        MenuItem m3("Find Media");
            MenuItem m10("Find Movies",&test);
                MenuItem m14("Find by title",&test);
                MenuItem m15("Find by genre",&test);
            MenuItem m11("Find Music",&test);
                MenuItem m16("Find by title",&test);
                MenuItem m17("Find by genre",&test);
            MenuItem m12("Find Games",&test);
                MenuItem m18("Find by title",&test);
                MenuItem m19("Find by genre",&test);
            MenuItem m13("Find Books",&test);
                MenuItem m20("Find by title",&test);
                MenuItem m21("Find by genre",&test);
        MenuItem m4("Add Media");
            MenuItem m22("Add Movie",&test);
            MenuItem m23("Add Music",&test);
            MenuItem m24("Add Game",&test);
            MenuItem m25("Add Book",&test);
        MenuItem m5("Delete Media");
            MenuItem m26("Add Movie",&test);
            MenuItem m27("Add Music",&test);
            MenuItem m28("Add Game",&test);
            MenuItem m29("Add Book",&test);

    m1.addChild(m2);
        m2.addChild(m6);
        m2.addChild(m7);
        m2.addChild(m8);
        m2.addChild(m9);
    m1.addChild(m3);
        m3.addChild(m10);
            m10.addChild(m14);
            m10.addChild(m15);
        m3.addChild(m11);
            m11.addChild(m16);
            m11.addChild(m17);
        m3.addChild(m12);
            m12.addChild(m18);
            m12.addChild(m19);
        m3.addChild(m13);
            m13.addChild(m20);
            m13.addChild(m21);
    m1.addChild(m4);
        m4.addChild(m22);
        m4.addChild(m23);
        m4.addChild(m24);
        m4.addChild(m25);
    m1.addChild(m5);
        m5.addChild(m26);
        m5.addChild(m27);
        m5.addChild(m28);
        m5.addChild(m29);

    Menu m(&m1);

    int option;
    while(1){
        cout << "Media Library> ";
        cin >> option;
        m.open(option);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:17:49.157

这个问题似乎`open(0);`在 Menu 的构造函数中。这当然会导致您自动进入“列表媒体”部分，该部分没有进一步的子部分。

这可能应该替换为`current->list();`

# javascript - 延迟表单提交，直到检索到位置

> ID：10406648
> 
> 赞同：8
> 
> 时间：2012-05-02T01:41:41.763
> 
> 标签：javascript, jquery, geolocation, jquery-callback

我有一个尝试从浏览器获取位置设置的应用程序，这往往需要一些时间，所以我希望它在页面加载时运行。但是，如果您在位置回调运行之前单击提交按钮，则您没有位置数据。我的问题很简单，如何在提交表单之前等待我的位置成功回调完成？（没有像睡眠声明这样愚蠢的东西）。
理想情况下，我想闪烁一个繁忙的指示器并等待数据。这可能吗？我有代码可以让繁忙的指示器可见，但我不确定如何优雅地等待数据可用。

```
$(document).ready(function(){
    var lat = "";
    var lng = "";
    var accuracy = "";
    var locationFound = false;

    if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(function positionSuccess(loc){
            lat = loc.coords.latitude;
            lng = loc.coords.longitude;
            accuracy = loc.coords.accuracy;
            locationFound = true;               
        });
    }else{
        alert("I'm sorry, your jerk browser doesn't support geolocation");
        locationFound = true;
    }

$('#locForm').submit(function(e){  

        $('#lat').val(lat);
        $('#lng').val(lng);
        $('#boundary').val($('#boundary-select').val());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:50:08.207

禁用提交按钮，直到传递了位置数据。

```
$('input[type="submit"]').attr('disabled','disabled'); 
```

然后启用提交按钮

```
$('input[type="submit"]').removeAttr('disabled'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T01:51:33.410

如果您使用的位置插件没有可用的回调函数，那么您需要以某种方式将结果绑定到页面并在用户提交之前对其进行检查。

一种方法是将位置的结果绑定到表单，然后仅当那里有位置时才允许表单提交。这是一个使用[`.data()`](http://api.jquery.com/jQuery.data/)来完成此操作的示例。

```
 $(document).ready(function(){
        var lat = "";
        var lng = "";
        var accuracy = "";
        var locationFound = false;

        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(function positionSuccess(loc){
                lat = loc.coords.latitude;
                lng = loc.coords.longitude;
                accuracy = loc.coords.accuracy;
                locationFound = true;  

                //bind the results to the form object using data()
                $("#locForm").data('lat' , lat)
                $("#locForm").data('lng' , lng)
                $("#locForm").data('accuracy' , accuracy)
                $("#locForm").data('locationFound' , locationFound)

            });
        }else{
            alert("I'm sorry, your jerk browser doesn't support geolocation");
            locationFound = true;
        }

    $('#locForm').submit(function(e){  

            e.preventDefault(); //prevents the normal submit

            if ( $("#locForm").data('lat') == "" || 
                 $("#locForm").data('lng') == "" || 
                 $("#locForm").data('accuracy') == "" || 
                 $("#locForm").data('locationFound') == ""
                ) {
             alert("Please wait for the browser to detect your location.");   
             return false;
                }
            else {       
              $.post( $(this).attr('action'),  $(this).serialize(), function(data){ 
                       // your callback data from the submit here
               } ); 
            }

    } 
```

添加了此代码，它每秒检查您的位置插件中的值：

```
 function wait4location() {

            if ( $("#locForm").data('lat') == "" || 
                 $("#locForm").data('lng') == "" || 
                 $("#locForm").data('accuracy') == "" || 
                 $("#locForm").data('locationFound') == ""
                ) {
                   x = setTimeout('wait4location()',1000) //every second
              } else { 
                  $("#loading").hide();
                  return false; 
                }
  }

  $("#loading").show();
  wait4location(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T05:44:29.340

使用两个信号量：

```
var geoLoaded = false,
    submittingForm = false;

function LoadGeoData() {
    // .. your load code
    geoLoaded = true;
    ReallySubmitForm();
}

$('form').submit(function(e) {
    // .. your code
    submittingForm = true;
    ReallySubmitForm();
})

function ReallySubmitForm() {
    if (submittingForm && geoLoaded) {
        // .. your submit code
    } else {
        // .. trigger loading code
    }
} 
```

这样，只有在提交表单时地理数据尚未完全加载时，用户才会看到加载图像。您会注意到，首先触发哪个事件并不重要，只有在两者都完成后才会通过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-20T02:50:17.603

您可以在返回位置后向表单添加提交功能。

这是一段对我有用的代码。

HTML

```
<form id="form" action="" method="POST"> 
```

JavaScript

```
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else { 
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}
function showPosition(position) {
    x.innerHTML = "<input type=hidden name=lat id=lat value=" + 
        position.coords.latitude + "><input type=hidden name=lng id=lng value=" 
        + position.coords.longitude + ">";
    document.getElementById("form").submit();
} 
```

# jquery - Easypaginate jQuery 插件在 IE9 中不起作用

> ID：10406651
> 
> 赞同：1
> 
> 时间：2012-05-02T01:42:28.487
> 
> 标签：jquery, internet-explorer

不幸的是，我没有 Windows 机器，所以我目前无法自己调试，但似乎这个插件[http://cssglobe.com/post/9801/easy-paginate-jquery-plugin-for-分页](http://cssglobe.com/post/9801/easy-paginate-jquery-plugin-for-pagination)在每个浏览器中都能正常工作——包括 IE7,8 但不包括 IE9。有没有人遇到过这种情况或找到合适的解决方案？您可以在我的网站[http://www.goodgreenfight.com上查看结果](http://www.goodgreenfight.com)

谢谢。

# java - Polynomial.java zeros 方法的问题

> ID：10406652
> 
> 赞同：0
> 
> 时间：2012-05-02T01:42:32.053
> 
> 标签：java, polynomial-math

[这](https://www.dropbox.com/s/35wcsqhf6szkvl4/Polynomial.java)是源代码的位置（使用 Dropbox）。

问题在于它没有正确评估零。

例如：`x^2-2x-8`应该等于 的零点`{-4, 2}`，但我得到一个长的指数值，如`-4+34534....E-25<i>i</i>`.

它确实适用于具有单根的多项式`(such as x<sup>2</sup>+4x+4, root = {-2})`

谁能发现这个问题，这让我沮丧了好几个星期。这**不是**家庭作业，这是我在空闲时间做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:52:31.920

我以前遇到过这样的问题，并决定改用另一种（面向数学的）语言。您可以尝试使用浮点数而不是双精度数，这可能会奏效，但可能会遇到自己的问题。或者您可以编写一个过滤掉任何小于 1E-10 或类似的东西的方法。另一种选择（在这里可能相关也可能不相关）是使用[JLink](http://reference.wolfram.com/mathematica/JLink/tutorial/Overview.html)。

# cocoa - 如何制作 NSImage 网格？

> ID：10406654
> 
> 赞同：0
> 
> 时间：2012-05-02T01:43:22.387
> 
> 标签：cocoa, nsimage

在 NSWindow 上制作 4 x 5 NSimage 网格的最简单方法是什么？

我正在尝试将 NSTableView 与图像单元格一起使用，但每列似乎不能超过 1 个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T01:49:11.800

最简单的方法是将 NSImageView 拖到窗口上，然后使用 IB 中编辑器菜单下的“嵌入矩阵”菜单项。然后设置矩阵的行数和列数

# ruby-on-rails - Rails 3.2 rake assets：预编译错误

> ID：10406656
> 
> 赞同：0
> 
> 时间：2012-05-02T01:43:41.457
> 
> 标签：ruby-on-rails, jqgrid

我在 rails 3.2 中预编译资产管道时不断收到错误消息。我在 rake assets:precompile 中看到的内容如下。

```
2012-05-02T00:47:08+00:00 app[web.1]: => Rails 3.2.3 application starting in production on http://0.0.0.0:3847
2012-05-02T00:47:08+00:00 app[web.1]: => Call with -d to detach
c:/Ruby193/bin/rake:32:in `<main>'
c:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:45:in `call'
c:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:45:in `sh'
c:/Ruby193/lib/ruby/1.9.1/rake/file_utils_ext.rb:39:in `sh'
c:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:80:in `ruby'
c:/Ruby193/lib/ruby/1.9.1/rake/file_utils_ext.rb:39:in `ruby'
c:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:12:in `ruby_rake_task'
c:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task'
c:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.3/lib/sprockets/assets.rake:29:in `block (2 levels) in <top (required)>'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `call'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `block in execute'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `each'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `execute'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:158:in `block in invoke_with_call_chain'
c:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:151:in `invoke_with_call_chain'
c:/Ruby193/lib/ruby/1.9.1/rake/task.rb:144:in `invoke'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:116:in `invoke_task'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block (2 levels) in top_level'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `each'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block in top_level'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:88:in `top_level'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:66:in `block in run'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
c:/Ruby193/lib/ruby/1.9.1/rake/application.rb:63:in `run'
c:/Ruby193/bin/rake:32:in `<main>'
Tasks: TOP => assets:precompile 
```

我的 application.css 和 .js 分别有以下内容；.css

```
>*= require overcast
>* =require jqgrid
>*= require_self
>*= require_tree . 
```

.js

```
>//= require jquery
>//= require jquery_ujs
>//= require jquery-ui
>//= require jqgrid-ja
>//= require bootstrap
>//= require_directory . 
```

我的宝石文件

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'
gem 'bootstrap-sass', '2.0.2'
gem 'bcrypt-ruby', '3.0.1'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

group :development, :test do
#  gem 'sqlite3', '1.3.5'
  gem 'pg', '0.12.2'
  gem 'rspec-rails', '2.9.0'
  gem 'guard-rspec', '0.5.5'
  gem 'annotate', '~> 2.4.1.beta'
end
group :test do
  gem 'rspec-rails', '2.9.0'
  gem 'capybara', '1.1.2'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
  gem 'factory_girl_rails', '1.4.0'
  gem 'cucumber-rails', '1.2.1', require: false
  gem 'database_cleaner', '0.7.0'
end
group :production do
  gem 'pg', '0.12.2'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
  gem "rails-asset-jqueryui"
  gem "rails-asset-jqgrid"
end

gem 'jquery-rails', '2.0.0' 
```

有人知道为什么我不能成功预编译吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:11:12.897

将 rake 添加到您的 gemfile。Ruby 的 stdlib 包含一个旧版本的 rake。

```
gem 'rake', '~> 0.9.2' 
```

调用 rake with`bundle exec`以确保使用正确的版本。

```
bundle exec rake assets:precompile 
```

# javascript - 是否有在 C++ 和 Javascript 中实现的高级进程间通信 API

> ID：10406660
> 
> 赞同：7
> 
> 时间：2012-05-02T01:44:11.497
> 
> 标签：javascript, c++, sockets, network-programming, websocket

我正在开发需要在 C++ 应用程序和 Javascript Web 应用程序之间传递消息的应用程序。

当然，我可以自己用任何一种语言编写套接字代码，而且我过去在必要时也这样做过。

我真正想要的是一个更高级别的消息发布或消息队列 API，它为我做了很多工作。有谁知道这样的API？

我看过 ICE，它似乎没有 Javascript 绑定。我还查看了 Boost 消息队列，但它仅适用于 C++ 方面。如有必要，我可能会为这些技术中的任何一种滚动我自己的 Javascript 绑定。

更新：抱歉之前应该提到过，我想在浏览器中运行它。

为了给出一个更完整的故事，我想要一个简单的基于浏览器的应用程序，用于配置和显示 C++ 应用程序的日志记录。

我知道还有其他方法可以做到这一点，但我对 C++ 和基于浏览器的 Javascript 中的高级库特别感兴趣，它在套接字 API 之上构建一个消息队列（如果没有，那么我可能会考虑自己实现它并写一篇代码项目文章）。

ALSO：我不关心网络浏览器的可移植性。例如，如果有一个只能在 Chrome 中运行的高级 IPC Javascript 库，我会很高兴的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T01:47:44.897

简单回答您的问题：不，ECMAscript 中没有开箱即用的 IPC 实现。

但你实际上已经回答了你的问题。如果您尝试与在浏览器中运行的 Javascript 进行通信，您确实应该使用 (web-)sockets 连接在任一方向上管道日期。当然，你可以用 C++ 编写一个简单的 HTTP 服务器，但我想这太过分了，而且不具备双向套接字的能力。

从头开始在 C++ 中实现 web-socket 连接仍然需要一些工作（规范在很长一段时间内都在变化），但我想已经有一些库了。

如果您尝试与*node.js*通信，那么使用真正的套接字/管道这是一项几乎微不足道的任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T01:48:02.367

使用 JavaScript，我假设您在浏览器中运行它？在这种情况下，您的 C++ 应用程序需要提供一个 Web 服务器和某种您可以调用的基于 JSON 的 Web 服务。在 JavaScript 方面，您只需使用 AJAX 与该 Web 服务进行通信。

另一种方法是 websockets，尽管在 C++ 端实现起来可能会有点困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-05T02:16:06.363

我找到了满足我需求的解决方案。它并不完全完美，但我认为它运作良好。

有人建议使用 HTTP 和 ajax。结果证明这是一个有用的想法，经过一些原型设计后，我认为它解决了我相当基本的需求。

更具体地说，我正在使用嵌入在我的 C++ 应用程序中的 Mongoose HTTP 服务器，并且我正在使用 jQuery ajax 函数从服务器中提取数据。jQuery 客户端不断地轮询服务器以获取新数据，效率不是特别高，但我认为它对我来说足够好。

一旦我的实现完成，我将写一篇文章详细解释如何做到这一点，然后我会更新这个答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T03:04:52.003

你可以试试 DBus，它有非常简单的机制来定义、查询和使用接口，并且有一些用于 XPCOM 和基于 webkit 的浏览器的组件（例如[http:](http://sandbox.movial.com/wiki/index.php/Browser_DBus_Bridge) //sandbox.movi​​al.com/wiki/index.php/Browser_DBus_Bridge和[http://code.google.com/p/v8-dbus/](http://code.google.com/p/v8-dbus/)）。DBus 也是开源和跨平台的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T01:50:46.283

对于服务器端或非浏览器实现，命名管道如何？

是的，它是老式技术，其用法取决于您使用的操作系统，但只要您的服务器端 js 环境能够读取和写入文件，它就可以工作，并且它符合“高级”进程间通信的描述。

# javascript - 如何使用 node-mongodb-native 连接到 Heroku？

> ID：10406668
> 
> 赞同：5
> 
> 时间：2012-05-02T01:44:52.367
> 
> 标签：javascript, node.js, mongodb, heroku

我对如何在 Heroku 上连接到 MongoLab 感到非常困惑。要使用 uri 连接到 Heroku，我试图按照以下示例进行操作： http: [//experiencecraftsmanship.wordpress.com/2012/01/06/heroku-node-js-mongodb-featuring-the-native-driver/](http://experiencecraftsmanship.wordpress.com/2012/01/06/heroku-node-js-mongodb-featuring-the-native-driver/)

我查看了他的 web.js 和 deep.js。他们都做类似的事情：

```
connect.createServer(
    require( 'connect-jsonrpc' )( contacts )
).listen( port ); 
```

但是只有“联系人”中的数据库查询才会传递到该服务器？我可以为每个数据库访问方法执行多个 connect.createServer 吗？

以下是我在本地连接到 MongoDB 时的部分代码。我不确定如何修改它以连接到 Heroku 上的 MongoLab。

有人可以教我如何修改我的代码以进行连接吗？或者解释其中的一些概念？我不知道为什么我发布的那个网站的作者使用这么多回调来进行数据库调用，而我下面的方法似乎很简单（我是 JavaScript 新手，不擅长回调）。

```
var app = module.exports = express.createServer(
  form({ keepExtensions: true })
);

var Db = require('mongodb').Db;
var Server = require('mongodb').Server;
var client = new Db('blog', new Server('127.0.0.1', 27017, {}));

var posts;
var getAllPosts = function(err, collection) {
  collection.find().toArray(function(err, results) {
    posts = results;
    console.log(results);
    client.close();
  });
}

app.get('/', function(req, response) {
  client.open(function(err, pClient) {
    client.collection('posts', getAllPosts);
  });

  // some code
  response.render('layout', { posts: posts, title: 'Raymond', contentPage: 'blog' });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:24:48.543

使用“connect”连接mongo，而不是定义db、server、client：

```
var connect = require('connect');
var mongo = require('mongodb');
var database = null;

var mongostr = [YOUR MONGOLAB_URI];

mongo.connect(mongostr, {}, function(error, db)
    {       
            console.log("connected, db: " + db);

            database = db;

            database.addListener("error", function(error){
            console.log("Error connecting to MongoLab");

            });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-05T08:40:36.763

您连接到您的 mongolab 数据库（因此您无法创建新的“博客”数据库）。process.env.MONGOLAB_URI 也包括数据库名称。查看您的 mongolab uri：

```
heroku config | grep MONGOLAB_URI 
```

看起来像：`mongodb://heroku_app123456:password@dbh73.mongolab.com:27737/heroku_app123456`

在 github 上有[一个示例如何从 mongolab 数据库连接和检索数据](https://github.com/p15martin/BlogMongoDbNativeDriver/blob/master/web.js)。

# wordpress - 短代码出现在内容的顶部，而不是在我需要的地方

> ID：10406673
> 
> 赞同：8
> 
> 时间：2012-05-02T01:45:13.693
> 
> 标签：wordpress, shortcode

我知道这可能是退货问题。所以我把内容分开了，一个在一个被调用的函数`thelist`中，另一个是一个返回它的实际函数。代码跟在问题后面。

实际的短代码有效，除了内容出现在其余内容之前的顶部。我认为`now_include_post`退货会解决它，但事实并非如此。有人可以帮忙吗？

```
function thelist() {
if (have_posts()) : while (have_posts()) : the_post();
?>  
        <div id="post-<?php the_ID(); ?>"  <?php post_class('thumb'); ?>>
            <a href="<?php the_permalink() ?>" class="thumb-link">
            <?php
    if (!post_password_required())  {
                    if (has_post_thumbnail()) {
                        the_post_thumbnail();
                    }
                } else {
                    ?>
                    <img src="<?php bloginfo('template_url') ?>/img/locked.png"  />
        <?php } ?>
            </a>
            <h2>
                <a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php the_title(); ?>"><?php the_title(); ?></a>
            </h2>
        </div>
<?php /* end post */ ?>
<?php
    endwhile;
    endif;
    wp_reset_query();
    }
    ?>
    <?php

function now_include_post($atts) {
$thepostid = intval($atts[id]);
query_posts("p=$thepostid");
$output .= thelist();
return $output;
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-02T02:40:41.537

当您转义 PHP 时，您希望返回所有文本，而不是当场输出。

在您的 thelist() 函数的开始处启动一个输出缓冲区

```
ob_start(); 
```

然后最后关闭此缓冲区并返回其内容

```
return ob_get_clean(); 
```

这将返回内容而不是立即回显它，这是您在 WP 短代码的情况下想要做的

[关于输出缓冲函数的 PHP 信息](http://www.php.net/manual/en/ref.outcontrol.php)

# javascript - 提取 -webkit-transform matrix3d 值

> ID：10406676
> 
> 赞同：6
> 
> 时间：2012-05-02T01:45:46.760
> 
> 标签：javascript, html, graphics, css, 3d

我正在尝试使用`<canvas>`（2d 上下文）渲染 3D 形状，这意味着我必须执行一些手动投影变换。

能够从 CSS 中检索 3D 转换矩阵值对我有很大帮助。

这可以做到吗？

如果没有，我该如何构建由-webkit-perspective-origin 执行的转换？我已经计算出仅针对透视的转换，但是透视原点位于 x=y=0，但情况并非总是如此。

我意识到这种特定情况（在某个点 x、y、z 的原点透视）可能会变成简单的 x、y、z 平移，然后是透视变换（或相反），但理想的答案是是一种提取实际 4x4 3D 矩阵的方法。如果我有矩阵，我不再需要重新跟踪我为转换 CSS3 元素所做的步骤，以便将相同的转换应用于我打算使用`<canvas>`.

我在这里（[http://www.w3.org/TR/css3-3d-transforms/](http://www.w3.org/TR/css3-3d-transforms/)）查看以供参考，但看起来它们并没有描述在应用不同的可能转换时分配给矩阵的实际值。我认为应该有一些规格表可以详细说明。我似乎记得我什至在某处瞥见了它（具有大量三角函数的矩阵定义）。

[编辑：我在这里](http://dev.w3.org/csswg/css3-transforms/#transform-3d-rendering)找到了浏览器执行转换步骤的更深入概述。没有回答我的问题，但它确实让我离我的临时目标更近了一步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T10:25:07.153

可以通过 getComputedStyle 检索元素的变换矩阵。这是一个例子：http: [//jsfiddle.net/Kxxwu/](http://jsfiddle.net/Kxxwu/)

另一种方法是使用 WebKitCSSMatrix 接口。它非常方便，它提供了一个具有矩阵值的对象以及一些方法：http: [//developer.apple.com/library/safari/#documentation/AudioVideo/Reference/WebKitCSSMatrixClassReference/WebKitCSSMatrix/WebKitCSSMatrix.html](http://developer.apple.com/library/safari/#documentation/AudioVideo/Reference/WebKitCSSMatrixClassReference/WebKitCSSMatrix/WebKitCSSMatrix.html)

不好的部分是 WebKitCSSMatrix 没有在其他浏览器中实现......

想看看您如何将 3d 转换为画布。偷看的好地方是three.js。他们已经做到了，您可以在那里看到各种矩阵函数。

祝你好运！

# love2d - 执行 Love2D 脚本

> ID：10406679
> 
> 赞同：2
> 
> 时间：2012-05-02T01:46:03.647
> 
> 标签：love2d

我发现使用 Love2d 框架执行脚本的唯一方法是压缩所有脚本，然后将 zip 重命名为 love。这种小修改需要很多时间。有更快的方法吗？我试图命令行，我得到这个错误

```
'love' is not recognized as an internal or external command,
operable program or batch file. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T02:01:06.023

如果文件夹中有 main.lua，LÖVE 也会执行文件夹 - 您可以将文件夹拖放到应用程序上，或者如果您愿意，可以使用文件夹作为参数从命令行调用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-24T16:57:40.313

如果 LÖVE 可以在其中找到 main.lua（如 Bill 所说），则 LÖVE 会运行文件夹的内容。
[请注意，它不检查子文件夹]。

运行love2D程序有三种方式，你可以：

**a) 将文件夹拖到 love.exe 二进制文件/链接上（这适用于 Win 和 *Nix，我不了解 OS X）。**

**b) 导航到文件夹上一级的目录并键入 `love [folder containing main.lua]`**

或者

**c) 将其压缩并将 .zip 重命名为 .love。然后双击 .love 文件**

* * *

### 如果二进制文件不在`%PATH%`(Windows) 或`$PATH`(*Nix) 变量中，选项“b”将失败

（它会像`'love' is not recognized as an internal or external command, operable program or batch file.`在 windows 和`bash: love: command not found`linux 上一样发出错误消息）。

***有两种方法可以解决这个问题：（***
都需要 ADMIN/root 权限，）
1) 将 love 二进制文件添加到`PATH`变量中。这是[在 Windows](https://love2d.org/forums/viewtopic.php?f=4&t=9372#p57980)和[linux](http://home.ubalt.edu/abento/linux/terminal/addtopath.html)中执行此操作的方法（在 linux 中您想做这样的事情`PATH=$PATH:$HOME/where/ever/you/put/love/`：）

`C:\WINDOWS\system32`2) 您可以在或中添加 love2D 二进制文件的链接`/usr/bin/`。
在 Windows 中，您创建 love.exe 的快捷方式（无论您将其安装到何处），然后将其拖到 C:\WINDOWS\system32 中。在linux中你可以运行这个：
`sudo link /path/to/love/binary /usr/bin/love && sudo chmod ugo+rwx /usr/bin/love`

我希望这有帮助！

资料来源：谷歌（上面的链接）、Love2D 和我的知识：D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-26T20:49:45.210

If you're using Mac OS, you should run using:

```
open -a love xxx.love 
```

To recreate a file as .love, you can run in command line:

```
zip xxx.love file1.lua file2 
```

If you just want to replace a file in .love:

```
zip -r xxx.love file1.lua 
```

I think this will make your work easier.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-29T00:32:07.600

当我开始时，我发现这非常有帮助。希望这可以帮助

[Love2d 入门指南](http://nova-fusion.com/2011/06/14/a-guide-to-getting-started-with-love2d/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-26T02:27:33.650

simple way:

*   create folder /path/to/Game
*   put your files (main.lua, conf.lua, ...) in folder /path/to/Game

you can run script like this:

```
love /path/to/Game/ 
```

or if you use Linux, you can go in folder (cd /path/to/Game) and type just:

```
love . 
```

(dot means that you want to run it form in folder

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-10T09:51:17.830

我找到了一个简单的解决方案来节省时间。您必须使用这个简单的命令创建一个文件**.bat ：**

```
del Project.love
7z.exe a Project.zip ..\Project\*
ren Project.zip Project.love 
```

为此，您需要下载 7zip 并将此文件 (file.bat) 插入到项目的文件夹中。像这样：

![例子](../Images/73debf06f308f9c97241c9c93ab6d13b.png)

干得好！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-25T08:55:16.427

如果你使用 Sublime Text，你可以构建一个运行你的应用程序的构建。 [https://love2d.org/wiki/Sublime_Text](https://love2d.org/wiki/Sublime_Text)

在 Sublime Text 中按 CMD + B 或 Ctrl + B

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-19T00:50:45.707

如果您使用 Notepad++ 编写代码，只需打开您的 main.lua 文件，然后转到运行并在其中添加此文本，包括引号：

```
"Path" "$(CURRENT_DIRECTORY)" 
```

其中 Path 是 love.exe 的完整路径。将其保存为组合键，现在您可以在 Notepad++ 的任何脚本中使用此组合来测试您的代码。

# c - 以前的堆栈变量

> ID：10406681
> 
> 赞同：4
> 
> 时间：2012-05-02T01:46:11.490
> 
> 标签：c, gcc, assembly, x86

我有这个问题，我在 C 中递归调用一个函数，而 C 是词法范围的，所以我只能访问当前的堆栈帧。我想从前一个堆栈帧中提取参数和局部变量，该堆栈帧是在前一个函数调用下创建的，而我在当前堆栈帧上

我知道上一个递归调用的值仍在堆栈上，但我无法访问这些值，因为它们被“埋”在活动堆栈框架下？

我想从前一个堆栈中提取参数和局部变量并将它们复制到copy_of_buried_arg和copy_of_buried_loc；

使用 GAS 使用内联汇编来提取变量是一个要求，这是我到目前为止所拥有的，我尝试了一整天，我似乎无法弄清楚，我在纸上画了堆栈并进行了计算，但什么都不是工作时，我还尝试删除对 printf 的调用，这样堆栈会更干净，但我无法找出正确的算法。这是到目前为止的代码，我的函数在第二次迭代时停止

```
#include <stdio.h>

char glo = 97;   // just for fun 97 is ascii lowercase 'a'
int copy_of_buried_arg;
char copy_of_buried_loc;

void rec(int arg) {
  char loc;

  loc = glo + arg * 2; // just for fun, some char arithmetic
  printf("inside rec() arg=%d loc='%c'\n", arg, loc);

  if (arg != 0) {
    // after this assembly code runs, the copy_of_buried_arg and
    // copy_of_buried_loc variables will have arg, loc values from
    // the frame of the previous call to rec().
    __asm__("\n\
            movl 28(%esp), %eax #moving stack pointer to old ebp (pointing it to old ebp)\n\
            addl $8, %eax       #now eax points to the first argument for the old ebp \n\
            movl (%eax), %ecx   #copy the value inside eax to ecx\n\ 
            movl %ecx, copy_of_buried_arg   # copies the old argument\n\
    \n\

");

    printf("copy_of_buried_arg=%u copy_of_buried_loc='%c'\n",
       copy_of_buried_arg, copy_of_buried_loc);
  } else {
      printf("there is no buried stack frame\n");// runs if argument = 0 so only the first time
  }

  if (arg < 10) {
    rec(arg + 1);
  }
}

int main (int argc, char **argv) {
  rec(0);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:10:59.757

我可以尝试提供帮助，但 GAS 中没有 Linux 或程序集。但计算应该类似：

这是几次调用后的堆栈。典型的堆栈帧设置会创建堆栈帧的链接列表，其中 EBP 是当前堆栈帧，并指向其旧值用于前一个堆栈帧。

```
 +-------+
ESP-> |loc='c'|     <- ESP currently points here.
      +-------+
EBP-> |oldEBP |--+  <- rec(0)'s call frame
      +-------+  |
      |retaddr|  |  <- return value of rec(1)
      +-------+  |
      |arg=1  |  |  <- pushed argument of rec(1)
      +-------+  |
      |loc='a'|  |  <- local variable of rec(0)
      +-------+  |
   +--|oldEBP |<-+  <- main's call frame
   |  +-------+
   |  |retaddr|     <- return value of rec(0)
   |  +-------+ 
   |  |arg=0  |     <- pushed argument of rec(0)
   |  +-------+
  \|/ 
to main's call frame 
```

这是由以下序列创建的：

1.  首先推送参数最后一个 arg。
2.  调用函数，推送返回地址。
3.  推送即将成为旧的 EBP，保留先前的堆栈帧。
4.  将 ESP（栈顶，包含 oldEBP）移动到 EBP，创建新的栈帧。
5.  为局部变量减去空间。

这会影响 32 位堆栈，该堆栈`EBP+8`始终是调用的第一个参数，`EBP+12`第二个参数等 `EBP-n`始终是局部变量的偏移量。

获取前一个的代码，`loc`然后`arg`是（在 MASM 中）：

```
mov ecx,[ebp]              // get previous stack frame
mov edx,[ecx]+8            // get first argument
mov copy_of_buried_arg,edx // save it
mov dl,[ecx]-1             // get first char-sized local variable.
mov copy_of_buried_loc,dl  // save it 
```

或者我对 GAS 的最佳猜测（我不知道，但知道它倒退到 MASM）：

```
movl (%ebp),ecx
movl 8(%ecx),edx
movl edx,copy_of_buried_arg
movb -1(%ecx),dl
movb dl,copy_of_buried_loc 
```

在 Windows 上使用 VS2010 使用我的 MASM 输出您的代码：

```
inside rec() arg=0 loc='a'
there is no buried stack frame
inside rec() arg=1 loc='c'
copy_of_buried_arg=0 copy_of_buried_loc='a'
inside rec() arg=2 loc='e'
copy_of_buried_arg=1 copy_of_buried_loc='c'
inside rec() arg=3 loc='g'
copy_of_buried_arg=2 copy_of_buried_loc='e'
inside rec() arg=4 loc='i'
copy_of_buried_arg=3 copy_of_buried_loc='g'
inside rec() arg=5 loc='k'
copy_of_buried_arg=4 copy_of_buried_loc='i'
inside rec() arg=6 loc='m'
copy_of_buried_arg=5 copy_of_buried_loc='k'
inside rec() arg=7 loc='o'
copy_of_buried_arg=6 copy_of_buried_loc='m'
inside rec() arg=8 loc='q'
copy_of_buried_arg=7 copy_of_buried_loc='o'
inside rec() arg=9 loc='s'
copy_of_buried_arg=8 copy_of_buried_loc='q'
inside rec() arg=10 loc='u'
copy_of_buried_arg=9 copy_of_buried_loc='s' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T04:55:06.497

使用我的编译器（gcc 3.3.4）我最终得到了这个：

```
#include <stdio.h>

char glo = 97;   // just for fun 97 is ascii lowercase 'a'
int copy_of_buried_arg;
char copy_of_buried_loc;

void rec(int arg) {
  char loc;

  loc = glo + arg * 2; // just for fun, some char arithmetic
  printf("inside rec() arg=%d loc='%c'\n", arg, loc);

  if (arg != 0) {
    // after this assembly code runs, the copy_of_buried_arg and
    // copy_of_buried_loc variables will have arg, loc values from
    // the frame of the previous call to rec().
    __asm__ __volatile__ (
            "movl 40(%%ebp), %%eax #\n"
            "movl %%eax, %0 #\n"
            "movb 31(%%ebp), %%al #\n"
            "movb %%al, %1 #\n"
            : "=m" (copy_of_buried_arg), "=m" (copy_of_buried_loc)
            :
            : "eax"
    );

    printf("copy_of_buried_arg=%u copy_of_buried_loc='%c'\n",
       copy_of_buried_arg, copy_of_buried_loc);
  } else {
      printf("there is no buried stack frame\n");// runs if argument = 0 so only the first time
  }

  if (arg < 10) {
    rec(arg + 1);
  }
}

int main (int argc, char **argv) {
  rec(0);

  return 0;
} 
```

这是相关部分的反汇编（用 获取`gcc file.c -S -o file.s`）：

```
_rec:
        pushl   %ebp
        movl    %esp, %ebp
        subl    $8, %esp
        movl    8(%ebp), %eax
        addl    %eax, %eax
        addb    _glo, %al
        movb    %al, -1(%ebp)
        subl    $4, %esp
        movsbl  -1(%ebp),%eax
        pushl   %eax
        pushl   8(%ebp)
        pushl   $LC0
        call    _printf
        addl    $16, %esp
        cmpl    $0, 8(%ebp)
        je      L2
/APP
        movl 40(%ebp), %eax #
movl %eax, _copy_of_buried_arg #
movb 31(%ebp), %al #
movb %al, _copy_of_buried_loc #

/NO_APP
        subl    $4, %esp
        movsbl  _copy_of_buried_loc,%eax
        pushl   %eax
        pushl   _copy_of_buried_arg
        pushl   $LC1
        call    _printf
        addl    $16, %esp
        jmp     L3
L2:
        subl    $12, %esp
        pushl   $LC2
        call    _printf
        addl    $16, %esp
L3:
        cmpl    $9, 8(%ebp)
        jg      L1
        subl    $12, %esp
        movl    8(%ebp), %eax
        incl    %eax
        pushl   %eax
        call    _rec
        addl    $16, %esp
L1:
        leave
        ret 
```

与（40 和 31）的偏移量`ebp`最初被设置为任意猜测值（例如 0），然后通过观察拆解和一些简单的计算进行改进。

请注意，该函数在递归调用自身时使用额外的 12+4=16 字节的堆栈进行对齐和参数：

```
 subl    $12, %esp
        movl    8(%ebp), %eax
        incl    %eax
        pushl   %eax
        call    _rec
        addl    $16, %esp 
```

返回地址也有4个字节。

然后该函数使用 4+8=12 字节作为 old`ebp`及其局部变量：

```
_rec:
        pushl   %ebp
        movl    %esp, %ebp
        subl    $8, %esp 
```

因此，每次递归调用，堆栈总共会增长 16+4+12=32 个字节。

现在，我们知道如何获得我们的本地`arg`和`loc`通过`ebp`：

```
 movl    8(%ebp), %eax ; <- arg
        addl    %eax, %eax
        addb    _glo, %al
        movb    %al, -1(%ebp) ; <- loc 
```

因此，我们只需在偏移量 8 和 -1 上加上 32，就可以得到 40 和 31。

做同样的事情，你会得到你的“隐藏”变量。

# magento - 如何在 Magento 的页面中添加规范标签？

> ID：10406683
> 
> 赞同：0
> 
> 时间：2012-05-02T01:46:29.697
> 
> 标签：magento, seo, canonical-link

我为标签页安装了一个 SEO 友好的 URL 模块。现在，人们可以从 2 个不同的 URL 访问我网站上的任何标签页：

[http://www.princessly.com/tag/product/list/tagId/3/](http://www.princessly.com/tag/product/list/tagId/3/)

[http://www.princessly.com/tag/royal/](http://www.princessly.com/tag/royal/)

我的问题是如何将规范标签添加到 /tag/product/list/tagId/3/ 以便它在语义上指向 /tag/royal/？

重定向也可以，但这将涉及编辑 /app/code/core/Mage/Tag/controllers/ProductController.php 中的一个核心文件，我不想这样做，因为它不是升级证明。有没有办法在不编辑任何核心文件的情况下做到这一点？

可能编辑布局 XML 以在 /tag/product/list/tagId/3/ 的标题中添加规范标签？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T04:26:46.920

取决于你想让谷歌索引哪一个，听起来你想要 <link rel="canonical" href="http://www.princessly.com/tag/royal/"/> 在你的[http://www.princessly .com/tag/product/list/tagId/3/](http://www.princessly.com/tag/product/list/tagId/3/)文件。参考： http: [//support.google.com/webmasters/bin/answer.py ?hl=en&answer=139394](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T02:36:24.050

我使用了第 3 方扩展来实现这一点。只需在 Google 中搜索“Magento seo 友好标签”即可。

# asp.net-mvc-4 - webApi 与 SPA .NET MVC 4 控制器

> ID：10406686
> 
> 赞同：1
> 
> 时间：2012-05-02T01:47:13.567
> 
> 标签：asp.net-mvc-4, asp.net-web-api, single-page-application

所以我即将使用 .NET MVC4 创建我的第一个 SPA 项目。但在我开始之前，我需要做一点澄清。从一些教程看来，SPA 是基于 WebAPI 架构构建的。

1.  说 SPA = WebAPI + knockout.js + history.js + upshot.js 是否安全，它们一起充当可以离线运行的 Web 应用程序？所以以后如果我们想构建一个原生手机应用程序，我们总是可以从 SPA DataServiceController 中调用它？

2.  *webAPI 控制器（继承自 ApiController）* **VS** *SPA 控制器（继承自 DbDataController<..>）有*什么区别？

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T12:49:37.297

1.  SPA 与 WebAPI、history.js、upshot.js 一起使用。不一定需要淘汰（即您可以选择自己的客户端框架。据我了解，您也需要使用实体框架。

2.  DbDataController 是一种泛型类型，需要指定要公开的 DataContext。ApiController 不需要这样做。似乎 SPA 需要使用 EF，在我看来这似乎是限制性的。*

# actionscript-3 - 将溢出的链接集成到菜单列表末尾的动态下拉菜单中

> ID：10406688
> 
> 赞同：2
> 
> 时间：2012-05-02T01:47:23.143
> 
> 标签：actionscript-3, apache-flex, overflow, flex4.5, fluid-layout

我应该如何创建链接的水平列表，以便通过列表末尾的动态下拉菜单仍然可以使用溢出的链接？

我希望能够创建一个链接（或按钮）列表，以便在有足够的水平空间时显示所有链接。当水平空间不足时，溢出的链接将出现在链接列表末尾的下拉菜单中。我正在使用 Flex SDK 4.5.1。

这种期望的行为如下所示。

![在此处输入图像描述](../Images/bb8ec19800e52a93283f4f59f5736bcd.png)

在尝试创建多部分自定义组件、使用自定义布局以及在互联网上进行相当广泛但不成功的研究之后，我还没有接近可行的解决方案。

我应该如何创建链接的水平列表，以便可以通过主列表末尾的下拉列表获得溢出的链接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T14:59:44.383

经过大量研究、阅读和许多原型后，我完成了一个解决方案，该解决方案在这个特定场景中运行得足够好；虽然，组件和皮肤之间的耦合比我想要的要高一些。

我基于 spark 创建了一个自定义组件`BorderContainer`。组件布局大致为：

```
-- BorderContainer
  -- Scroller
    -- Group
      -- DataGroup
      -- Button
      -- PopUpAnchor
        -- Group
        -- Rect
        -- DataGroup 
```

第一个`DataGroup`包含项目的主要列表。这些是水平显示的。通过覆盖`updateDisplayList`自定义组件，我可以测量其中的每个项目`DataGroup`并确定它是否适合可用区域。那些不适合的将被隐藏（不删除）并添加到不显示列表中。

不显示列表中的那些项目被添加到第二个`DataGroup`。这是下拉列表。将其`DataGroup`包含在 a 中`PopUpAnchor`允许我添加类似行为的下拉菜单。`Button`用于弹出和关闭第二个`DataGroup`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T23:19:35.350

*   [计算可见宽度加上可滚动宽度](https://stackoverflow.com/questions/2670280/canvas-total-width-visible-width-hidden-scrollable-part)

*   [将可滚动宽度除以每个链接的宽度加上分隔符来决定要移动多少项目](https://stackoverflow.com/questions/5715341/changin-the-default-width-and-height-of-the-dropdownlist)

*   [从列表 dataProvider 中弹出隐藏项以移除滚动条](https://stackoverflow.com/questions/1428597/how-to-get-flex-3-combobox-width-to-adjust-based-on-bound-dataprovider-contents)

*   [并将它们推送到 popupMenu dataProvider](http://blog.flexexamples.com/2008/01/28/setting-the-width-on-a-flex-popupbutton-controls-pop-up-menu/)

# linux - 如何计算 meminfo 中的所有内存？

> ID：10406691
> 
> 赞同：4
> 
> 时间：2012-05-02T01:47:56.230
> 
> 标签：linux, memory, operating-system

我试图了解如何`meminfo`跟踪内存。这是我正在查看的内容：

```
MemTotal:         341596 kB
MemFree:          147288 kB
Buffers:              56 kB
Cached:            46752 kB
SwapCached:            0 kB
Active:            86928 kB
Inactive:          41384 kB
Active(anon):      81532 kB
Inactive(anon):      288 kB
Active(file):       5396 kB
Inactive(file):    41096 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:         81532 kB
Mapped:            87648 kB
Shmem:               316 kB
Slab:              11568 kB
SReclaimable:       2580 kB
SUnreclaim:         8988 kB
KernelStack:        3232 kB
PageTables:         5480 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:      170796 kB
Committed_AS:    2692436 kB
VmallocTotal:     327680 kB
VmallocUsed:       59244 kB
VmallocChunk:     259076 kB 
```

以下是我的问题：

1）我怎样才能占到所有 341596kB 的内存？显然 147288 是免费的。如何计算剩余内存？（没有写一个问题来解决零子集和问题，我的意思是......）

2) 总非活动/活动文件内存为 46492，但`Mapped`为 87648。但是，根据[手册](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;f=Documentation/filesystems/proc.txt;hb=HEAD#l451)，它是

```
Mapped: files which have been mmaped, such as libraries 
```

所以.. 专门用于映射文件的页面怎么可能比文件本身多？

**尽职调查**我已经看到其他与此主题相关的 SO[帖子](https://stackoverflow.com/questions/658411/entries-in-proc-meminfo)，但没有一个解释如何解释如何在这里解释所有“使用”内存......另外，我发现[Linux 内核文件](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;f=Documentation/filesystems/proc.txt;hb=HEAD#l451)解释`/proc/meminfo`- 它只是没有似乎没有我想要的完整信息。

# php - PHP 数学（编号）

> ID：10406696
> 
> 赞同：1
> 
> 时间：2012-05-02T01:48:32.087
> 
> 标签：php, math

`$temp`目前是 6。但是变量结果每次都可以更改为不同的数字，因此它不是固定值。

无论如何，为此`$temp * 1.1666666`，结果将是`6.99999996`。由于我使用了 floor 函数，因此将四舍五入为 6。

有没有什么办法当价值大于`>*.49999`它会停留在`*.5`而不是`*`？

示例：`6.51111111`, `6.78948123`,`6.9747124`

**预期输出：** 6.5

示例：`6.49999999`, `6.12412431`,`6.33452361`

**预期产出：** 6

请注意，$temp 值会不断变化……谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T01:50:59.500

使用[`round($number, 1)`](http://us2.php.net/manual/en/function.round.php). 这将四舍五入到最接近的小数点。

```
$number = round(.1666666 * $temp, 1); 
```

如果你想四舍五入到最接近的一半，你可以这样做：

```
function round_to_half($num)
{
  if($num >= ($half = ($ceil = ceil($num))- 0.5) + 0.25) return $ceil;
  else if($num < $half - 0.25) return floor($num);
  else return $half;
}

$number = round_to_half(.1666666 * $temp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T06:04:55.373

试试这个代码...

```
<?php 

    $temp = 6.94444;
    echo myRound($temp);

   function myRound($temp)
    {
        $frac = $temp - floor($temp);
        $frac = ($frac >= .5) ? .5 : 0;
        return ( floor($temp) + $frac );
    }

?> 
```

希望这是你想要的。

# ios - 检测跨设备删除iCloud中文档的正确方法？

> ID：10406697
> 
> 赞同：3
> 
> 时间：2012-05-02T01:48:32.347
> 
> 标签：ios, icloud, uidocument

我找不到一种明显的方法来检测我正在监视的文档的删除（我缓存了我的应用程序关心的文档列表）。

在 Device1 上：当我删除一个文档时，我调用

```
 [fileCoordinator coordinateWritingItemAtURL:fileURL options:NSFileCoordinatorWritingForDeleting
          error:&err byAccessor:^(NSURL* writingURL) {
             [fileManager removeItemAtURL:writingURL error:nil]; 
```

这在 Device1 上运行良好，一切都保持同步。在 Device2 上：我试图依靠`NSMetadataQuery`通知：

初始文件列表在`NSMetadataQueryDidFinishGatheringNotification` 文档添加/更改中正常通过`NSMetadataQueryDidUpdateNotification`

当我删除 Device1 上的文件时，我得到一个奇怪的结果：`NSMetadataQueryDidUpdateNotification`列出了我的所有文档（除了已删除的文档）的更新我不确定我应该如何检测丢失的文件已被删除或更新通知就是为了这个目的

**问题1：**我应该检查什么？

我尝试了另一条路线，即注册为`NSFilePresenter`iCloud URL：

```
- (NSURL *)iCloudDocumentsURL
{
    return [[NSFileManager defaultManager] URLForUbiquityContainerIdentifier:nil] URLByAppendingPathComponent:@"Documents"];
} 
```

现在，`NSFilePresenter`当该 URL 中的文件发生更改时，我会通过协议进行调用，但是由于回调是模糊的，因此运行逻辑以确定丢失的文档是非常缓慢的。我得到的唯一电话是我希望通过 但从未调用过此方法`- (void)presentedItemDidChange;` 来获得回调。`- (void)accommodatePresentedSubitemDeletionAtURL:(NSURL *)url completionHandler:(void (^)(NSError *errorOrNil))completionHandler`

**问题2：**知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T15:33:20.170

由于您正在跟踪*以前从 iCloud 报告的文件，因此**当前*iCloud 列表中不存在已删除的文件，因此您只需比较两个列表即可找到已删除的文件。

这就是我在“文件管理器”视图控制器中所做的事情，因为我保留了文件条目的 NSMutableDictionary，其中包括在我的主视图中文件“图标”位置的键。当我收到更新通知并且该更新导致文件更多或更少时，我会根据这些文件更改为图标更改设置动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T20:58:09.430

tobinjim 是正确的，因为 NSMetadataQuery 每次都返回整个结果集。我曾期望只发送更改以节省带宽，但我没有正确地 RTFM。

一旦我弄清楚了，我就在 iOS 库中遇到了一个错误。这是当我在一台设备上删除文档并且 iCloud 查询更新遇到我的另一台设备时发生的崩溃：

```
 2012-06-25 13:15:12.343 app[19779:707] *** -[NSMutableIndexSet indexGreaterThanOrEqualToIndex:]: message sent to deallocated instance 0xdaae2c0
    (gdb) bt
    #0  0x31937870 in ___forwarding___ ()
    #1  0x31892650 in __forwarding_prep_0___ ()
    #2  0x373cc676 in __NSIndexSetEnumerate ()
    #3  0x373a1ee8 in -[NSIndexSet enumerateIndexesWithOptions:usingBlock:] ()
    #4  0x371c1f08 in -[LBQuery _processUpdates] ()
    #5  0x373571a6 in -[NSObject(NSThreadPerformAdditions) performSelector:onThread:withObject:waitUntilDone:modes:] ()
    #6  0x3737ffa4 in -[NSObject(NSThreadPerformAdditions) performSelector:onThread:withObject:waitUntilDone:] ()
    #7  0x371c2274 in -[LBQuery processUpdates] ()
    #8  0x373a88d6 in -[NSMetadataQuery _update] () 
```

我相信我已经找到了这个问题的原因。我正在从 Luke the Hiesterman 的演示文稿中查看新的 IOS 6 示例代码。我注意到没有像以前的 iCloud 示例应用程序那样调用 NSMetadataQuery disable/enableUpdates。我删除了对这些的所有调用。我还更改了处理 NSMetadataQueryDidUpdateNotification 调用的方法以异步但以排队方式运行。

NSMetadataQuery 的线程之间似乎存在竞争条件。在某些调用中，查询的结果很好，但在其他时候，它们已被释放并且结果显示为 NSZombie 的（感谢 gdb，它比当前的 lldb 好得多）。所以跨线程启用和禁用查询会导致 LBQuery 通过调用已释放的对象而崩溃。

取消所有对 NSMetadataQuery 的启用和禁用似乎也加快了我的应用程序的速度，而且 iCloud 似乎更加稳定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-27T21:45:53.020

由于 iOS 8`NSMetadataQuery`扩展`NSMetadataQueryDidUpdateNotification`了 userInfo `NSMetadataQueryUpdateRemovedItemsKey`，您可以使用它来检测哪些文件被删除。

[https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSMetadataQuery_Class/#//apple_ref/doc/constant_group/Keys_for_Use_with_a_Notification_Info_Dictionary](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSMetadataQuery_Class/#//apple_ref/doc/constant_group/Keys_for_Use_with_a_Notification_Info_Dictionary)

# android - 加载和滚动时 Listview 行颜色混合

> ID：10406701
> 
> 赞同：1
> 
> 时间：2012-05-02T01:49:02.917
> 
> 标签：android, android-listview, adapter, baseadapter

我正在根据其中一个子项的文本值设置行的背景颜色。但是，无论其文本值如何，都会设置多个背景。上下滚动时会变得更糟。适配器的代码：

```
package com.test.app;

import java.util.ArrayList;

import android.content.Context;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;

public class MyBaseAdapter extends BaseAdapter {

    private LayoutInflater mInflater = null;
    private ArrayList<String[]> mItems = new ArrayList<String[]>();

    public MyBaseAdapter(Context context, ArrayList<String[]> items) {
         mItems = items;
         mInflater = LayoutInflater.from(context);
    }

    public void addItem(String[] it) {
        mItems.add(it);
    }

    public void setListItems(ArrayList<String[]> lit) {
        mItems = lit;
    }

    @Override
    public int getCount() {
        return mItems.size();
    }

    @Override
    public Object getItem(int position) {
        return mItems.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    static class ViewHolder {
        public TextView tv0,tv1;
    }

    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {

        View rowView = null;
        ViewHolder viewHolder;

        if(convertView == null)
        {
            rowView = mInflater.inflate(R.layout.history_row, null);
        }
        else
        {
            rowView = convertView;
        }

        viewHolder = new ViewHolder();

        viewHolder.tv0 = (TextView)rowView.findViewById(R.id.textView0);
        viewHolder.tv1 = (TextView)rowView.findViewById(R.id.textView1);

        rowView.setTag(viewHolder);

        ViewHolder holder = (ViewHolder) rowView.getTag();

        holder.tv0.setText(mItems.get(position)[0].toString());
        holder.tv1.setText(mItems.get(position)[1].toString());

        if(holder.tv1.getText().equals("0"))
        {
            rowView.setBackgroundColor(0xAA777777);
            // Only the row containing "0" should be colored, yet it colors multiple, random rows.
        }

        return rowView;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T06:28:15.787

如果你只是使用：

```
if(holder.tv1.getText().equals("0")) {
            rowView.setBackgroundColor(0xAA777777);
            // Only the row containing "0" should be colored, yet it colors multiple, random  rows.
} 
```

这确实会使包含的行`0`具有该特定颜色，但是当您上下滚动列表时，具有这种颜色的这个特定行将被回收并最终出现在不应该出现的地方。正确的方法是为不包含的行提供默认颜色，`0`以便覆盖可能回收视图的错误颜色：

```
if(holder.tv1.getText().equals("0")) {
            rowView.setBackgroundColor(0xAA777777);
            // Only the row containing "0" should be colored, yet it colors multiple, random  rows.
} else {
   rowView.setBackgroundColor(/*Here the default color will be*/)
   // This row doesn't contain 0 so it must have the default color.
  // Because you could be dealing with a recycled view(that has the above color)
 // then we must revert the color to the default to be sure we end up with the correct color.
} 
```

该`ViewHolder`模式的正确代码也是：

```
 View rowView = convertView;
    ViewHolder viewHolder;

    if(rowView == null) {
        rowView = mInflater.inflate(R.layout.history_row, parent, false);
        viewHolder = new ViewHolder();
        viewHolder.tv0 = (TextView)rowView.findViewById(R.id.textView0);
        viewHolder.tv1 = (TextView)rowView.findViewById(R.id.textView1);
        rowView.setTag(viewHolder);
    } else {
        viewHolder = (ViewHolder) rowView.getTag();    
    } 
```

然后您使用该`viewHolder`对象来设置该行的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:07:16.490

你可以试试，设置为ListView：`android:cacheColorHint="#00000000"`

# arrays - 坐标纹理数组不适用于立方体

> ID：10406702
> 
> 赞同：0
> 
> 时间：2012-05-02T01:49:08.487
> 
> 标签：arrays, opengl, coordinates, textures

我的程序的目的是在每个面上加载和显示一个具有相同纹理的简单立方体。问题是前两个面（前，后）都很好。我在纹理数组中尝试了几种顶点组合，但它不起作用。我不知道是否需要在纹理数组中添加更多顶点或更改顺序或更改索引数组。

```
#define OFFSET_BUFFER(bytes) ((GLfloat *)NULL + bytes)

float vertices[] =
{
    -1.0f, -1.0f, 1.0f, // 0 
    1.0f, -1.0f, 1.0f,  // 1 
    -1.0f, 1.0f, 1.0f,  // 2 
    1.0f, 1.0f, 1.0f,   // 3 

    -1.0f, -1.0f, -1.0f,// 4 
    1.0f, -1.0f, -1.0f, // 5 
    -1.0f, 1.0f, -1.0f, // 6 
    1.0f, 1.0f, -1.0f,  // 7 
}; 

GLubyte indices[] =
{
    0,1,2, 1,3,2, //front face
    6,7,5, 6,5,4, //rear face
    1,5,3, 5,7,3, //problem on the right face
    //2,3,6, 3,6,7,
    //2,4,0, 2,4,6
    0,5,1, 5,4,0
}; 

float textures[] =
{
    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3
}; 

int main(int argc, char *argv[])
{
    SDL_Init(SDL_INIT_VIDEO);
    SDL_WM_SetCaption("Texture Mapping",NULL);
    SDL_SetVideoMode(500, 500, 32, SDL_OPENGL);

    bool continuer = true;
    SDL_Event event;
    GLuint texCube;

    glClearDepth(1.0f);
    glClearColor(0.1f, 0.1f, 0.1f, 0.1f);
    glEnable(GL_DEPTH_TEST);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(70.0f, (float)500.0f / (float)500.0f, 1.0f, 3000.0f);
    glewInit();

    texCube = loadTexture("caisse.jpg");
    glBindTexture(GL_TEXTURE_2D, texCube);

    glEnable(GL_TEXTURE_2D);

    while (continuer)
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        SDL_WaitEvent(&event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = false;
        }

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();

        gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);

        //Draw Cube ---------------------------------------

        glPushMatrix();
        glRotatef(90.0f, 1.0f, 1.0f, 0.0f);

        glEnableClientState(GL_VERTEX_ARRAY);
        glVertexPointer(3, GL_FLOAT, 0, vertices);

        glEnableClientState(GL_TEXTURE_COORD_ARRAY);
        glTexCoordPointer(2, GL_FLOAT, 0, textures);

        glDrawElements(GL_TRIANGLES, 24, GL_UNSIGNED_BYTE, indices);

        glDisableClientState(GL_VERTEX_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);

        //-------------------------------------------------

        glPopMatrix();

        glFlush();
        SDL_GL_SwapBuffers();
    }

    glDisable(GL_TEXTURE_2D);
    SDL_Quit();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:34:18.913

你的角落正在共享纹理坐标，这是行不通的。每个面应该有 4 个顶点，因为每个角的纹理坐标会因面而异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T11:56:08.547

我的问题的解决方案是以下代码：

```
#define OFFSET_BUFFER(bytes) ((GLfloat *)NULL + bytes)

float angle = 0.0f;

float vertices[72] =
{
    -1.0f, -1.0f, 1.0f,//VO - 0
    1.0f, -1.0f, 1.0f,//V1 - 1
    -1.0f, 1.0f, 1.0f,//V2 - 2
    1.0f, 1.0f, 1.0f,//V3 - 3

    -1.0f, -1.0f, -1.0f,//V4 - 4
    1.0f, -1.0f, -1.0f,//V5 - 5
    -1.0f, 1.0f, -1.0f,//V6 - 6
    1.0f, 1.0f, -1.0f,//V7 - 7

    -1.0f, 1.0f, 1.0f,//V2 - 8
    1.0f, 1.0f, 1.0f,//V3 - 9
    -1.0f, 1.0f, -1.0f,//V6 - 10
    1.0f, 1.0f, -1.0f,//V7 - 11

    -1.0f, -1.0f, 1.0f,//VO - 12
    1.0f, -1.0f, 1.0f,//V1 - 13
    -1.0f, -1.0f, -1.0f,//V4 - 14
    1.0f, -1.0f, -1.0f,//V5 - 15

    -1.0f, -1.0f, 1.0f,//VO - 16
    -1.0f, 1.0f, 1.0f,//V2 - 17
    -1.0f, -1.0f, -1.0f,//V4 - 18
    -1.0f, 1.0f, -1.0f,//V6 - 19

    1.0f, -1.0f, 1.0f,//V1 - 20
    1.0f, 1.0f, 1.0f,//V3 - 21
    1.0f, -1.0f, -1.0f,//V5 - 22
    1.0f, 1.0f, -1.0f,//V7 - 23
}; 

GLubyte indices[36] =
{
    0,1,2, 1,3,2,
    6,7,5, 6,5,4,
    8,9,10, 9,10,11,
    12,13,14, 13,14,15,
    17,16,18, 17,18,19,
    20,21,22, 21,22,23
}; 

float textures[48] =
{
    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3
}; 

int main(int argc, char *argv[])
{
    SDL_Init(SDL_INIT_VIDEO);
    SDL_WM_SetCaption("Texture Mapping",NULL);
    SDL_SetVideoMode(500, 500, 32, SDL_OPENGL);

    bool continuer = true;
    SDL_Event event;
    GLuint texCube;

    glClearDepth(1.0f);
    glClearColor(0.1f, 0.1f, 0.1f, 0.1f);
    glEnable(GL_DEPTH_TEST);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(70.0f, (float)500.0f / (float)500.0f, 1.0f, 3000.0f);
    glewInit();

    texCube = loadTexture("caisse.jpg");
    glBindTexture(GL_TEXTURE_2D, texCube);

    glEnable(GL_TEXTURE_2D);

    while (continuer)
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        SDL_WaitEvent(&event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = false;
        }

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();

        gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);

        //Draw Cube ---------------------------------------

        glPushMatrix();
        glRotatef(angle, 1.0f, 1.0f, 0.0f);

        glEnableClientState(GL_VERTEX_ARRAY);
        glVertexPointer(3, GL_FLOAT, 0, vertices);

        glEnableClientState(GL_TEXTURE_COORD_ARRAY);
        glTexCoordPointer(2, GL_FLOAT, 0, textures);

        glDrawElements(GL_TRIANGLES, 48, GL_UNSIGNED_BYTE, indices);

        glDisableClientState(GL_VERTEX_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);

        //-------------------------------------------------

        angle += 1.0f;

        glPopMatrix();

        glFlush();
        SDL_GL_SwapBuffers();
    }

    glDisable(GL_TEXTURE_2D);
    SDL_Quit();

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T12:17:26.633

以及 VBO 的解决方案：

```
#define OFFSET_BUFFER(bytes) ((GLfloat *)NULL + bytes)

float angle = 0.0f;

float vertices[72] =
{
    -1.0f, -1.0f, 1.0f,//VO - 0
    1.0f, -1.0f, 1.0f,//V1 - 1
    -1.0f, 1.0f, 1.0f,//V2 - 2
    1.0f, 1.0f, 1.0f,//V3 - 3

    -1.0f, -1.0f, -1.0f,//V4 - 4
    1.0f, -1.0f, -1.0f,//V5 - 5
    -1.0f, 1.0f, -1.0f,//V6 - 6
    1.0f, 1.0f, -1.0f,//V7 - 7

    -1.0f, 1.0f, 1.0f,//V2 - 8
    1.0f, 1.0f, 1.0f,//V3 - 9
    -1.0f, 1.0f, -1.0f,//V6 - 10
    1.0f, 1.0f, -1.0f,//V7 - 11

    -1.0f, -1.0f, 1.0f,//VO - 12
    1.0f, -1.0f, 1.0f,//V1 - 13
    -1.0f, -1.0f, -1.0f,//V4 - 14
    1.0f, -1.0f, -1.0f,//V5 - 15

    -1.0f, -1.0f, 1.0f,//VO - 16
    -1.0f, 1.0f, 1.0f,//V2 - 17
    -1.0f, -1.0f, -1.0f,//V4 - 18
    -1.0f, 1.0f, -1.0f,//V6 - 19

    1.0f, -1.0f, 1.0f,//V1 - 20
    1.0f, 1.0f, 1.0f,//V3 - 21
    1.0f, -1.0f, -1.0f,//V5 - 22
    1.0f, 1.0f, -1.0f,//V7 - 23
}; 

GLubyte indices[36] =
{
    0,1,2, 1,3,2,
    6,7,5, 6,5,4,
    8,9,10, 9,10,11,
    12,13,14, 13,14,15,
    17,16,18, 17,18,19,
    20,21,22, 21,22,23
}; 

float textures[48] =
{
    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3

    0.0f, 1.0f,//0
    1.0f, 1.0f,//1
    0.0f, 0.0f,//2
    1.0f, 0.0f,//3
}; 

int main(int argc, char *argv[])
{
    SDL_Init(SDL_INIT_VIDEO);
    SDL_WM_SetCaption("Texture Mapping",NULL);
    SDL_SetVideoMode(500, 500, 32, SDL_OPENGL);

    bool continuer = true;
    SDL_Event event;
    GLuint texCube;
    GLuint VBO[3];

    glClearDepth(1.0f);
    glClearColor(0.1f, 0.1f, 0.1f, 0.1f);
    glEnable(GL_DEPTH_TEST);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(70.0f, (float)500.0f / (float)500.0f, 1.0f, 3000.0f);
    glewInit();

    texCube = loadTexture("caisse.jpg");

    glGenBuffers(2, VBO);

    glBindBuffer(GL_ARRAY_BUFFER, VBO[0]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, VBO[1]);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);

    glBindBuffer(GL_ARRAY_BUFFER, VBO[2]);
    glBufferData(GL_ARRAY_BUFFER, sizeof(textures), textures, GL_STATIC_DRAW);

    glEnable(GL_TEXTURE_2D);

    while (continuer)
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        SDL_WaitEvent(&event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = false;
        }

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();

        gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);

        //Draw Cube ---------------------------------------

        glPushMatrix();
        glRotatef(angle, 1.0f, 1.0f, 0.0f);

        glBindTexture(GL_TEXTURE_2D, texCube);

        glBindBuffer(GL_ARRAY_BUFFER, VBO[0]);
        glVertexPointer(3, GL_FLOAT, 0, OFFSET_BUFFER(0));
        glBindBuffer(GL_ARRAY_BUFFER, VBO[2]);
        glTexCoordPointer(2, GL_FLOAT, 0, OFFSET_BUFFER(0));

        glEnableClientState(GL_VERTEX_ARRAY);
        glEnableClientState(GL_TEXTURE_COORD_ARRAY);

        glDrawElements(GL_TRIANGLES, 48, GL_UNSIGNED_BYTE, OFFSET_BUFFER(0));

        glDisableClientState(GL_VERTEX_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);

        //-------------------------------------------------

        angle += 1.0f;

        glPopMatrix();

        glFlush();
        SDL_GL_SwapBuffers();
    }

    glDisable(GL_TEXTURE_2D);
    SDL_Quit();

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T15:07:25.457

如果你真的想节省几个字节，你仍然可以分解几个顶点（16 个顶点而不是 24 个）。您考虑没有两个相对面的立方体，并分别添加这两个面。这是一个 IQM 模型，它就是这样做的：

```
# Inter-Quake Export 

mesh "Cube" 

material "cube.tga" 

vp 1 1 -1 
vn 1 1 -1 
vt 0 0 

vp 1 -1 -1 
vn 1 -1 -1 
vt 0 1 

vp -1 -1 -1 
vn -1 -1 -1 
vt 1 1 

vp -1 1 -1 
vn -1 1 -1 
vt 1 0 

vp 1 1 1 
vn 1 1 1 
vt 1 0 

vp -1 1 1 
vn -1 1 1 
vt 0 0 

vp -1 -1 1 
vn -1 -1 1 
vt 0 1 

vp 1 -1 1 
vn 1 -1 1 
vt 1 1 

vp 1 1 -1 
vn 1 1 -1 
vt 0 0 

vp -1 1 -1 
vn -1 1 -1 
vt 1 0 

vp -1 1 1 
vn -1 1 1 
vt 1 1 

vp 1 1 1 
vn 1 1 1 
vt 0 1 

vp 1 1 -1 
vn 1 1 -1 
vt 0 0 

vp -1 1 -1 
vn -1 1 -1 
vt 1 0 

vp -1 1 1 
vn -1 1 1 
vt 1 1 

vp 1 1 1 
vn 1 1 1 
vt 0 1 

fm 0 1 2 
fm 0 2 3 
fm 0 4 7 
fm 0 7 1 
fm 4 6 7 
fm 4 5 6 
fm 5 2 6 
fm 5 3 2 
fm 8 9 10 
fm 8 10 11 
fm 12 15 14 
fm 12 14 13 
```

# java - 防止存储在 ArrayList 中的对象被覆盖

> ID：10406703
> 
> 赞同：0
> 
> 时间：2012-05-02T01:49:10.900
> 
> 标签：java

基本上我必须编写一个简单的联系人管理器，并将对象存储在数组列表中。

令我沮丧的是，我有 newContact 方法，该方法在调用时会创建 Contact 的新实例，并将其存储在 ArrayList 中。问题是每次我调用该方法时，列表中的所有其他对象都会被覆盖。

```
import java.util.ArrayList;
public class ContactManager {

  public static ArrayList<Contact> contactList = new ArrayList<Contact>();
  public static Contact[]c = {};

  public static void main(String[]args){
    newContact();
    newContact();

    System.out.println(contactList.get(1).getName());
    System.out.println(contactList.get(0).getName());
  }

  public static void newContact(){
    Contact c = new Contact();
    contactList.add(c);
  }
} 
```

在 Contact 类构造函数中，有一段代码使用 Scanner 类初始化对象的属性。

如果在第一次调用中我输入“John”，在第二次函数调用中我输入“Peter”，上面的代码将打印出来：

彼得彼得。

为什么它不打印出 John Peter？

我能想到的唯一一件事是，Java 可能只存储对数组列表中对象的引用，并且与变量不同，对象在函数执行后不会被销毁。

有什么办法解决这个问题吗？

我希望这能解释我想要达到的目标。

PS。我知道人们讨厌那些作为家庭作业问题的人。但我这样做是为了学习新东西。原始分配几乎不要求实例化 5 个对象并将它们存储在 ArrayList 中。我已经完成了，现在我只是想看看我是否能想出更动态的解决方案。

联系类代码：

```
import java.util.Scanner; 
```

公共类联系人{

```
private static String name, number;

//constructor will ask to enter contact details
public Contact(){
    Scanner in = new Scanner(System.in);

    System.out.println("Enter name:");
    name = in.next();

    System.out.println("Enter number:");
    number = in.next();
}

//getters and setters

public static String getName(){
    return name;
}

public static String getNumber(){
    return number;
}

public static void setName(String newName){
    name = newName;
}

public static void setNumber(String newNumber){
    number = newNumber;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T08:38:16.950

这是因为`Contact`类中的成员是静态的。这意味着所有`Contact`实例共享相同的`name`and `number`。您应该使它们成为实例成员，以便每次您都`new Contact`获得这些变量的新副本。

# ruby-on-rails-3 - Arel 和 pgAdmin 从具有时间戳条件的相同查询中返回不同的数据

> ID：10406706
> 
> 赞同：1
> 
> 时间：2012-05-02T01:49:23.937
> 
> 标签：ruby-on-rails-3, postgresql, timezone, arel, postgresql-9.1

这是我在使用 PostgreSQL 9.1 和 Rails 3.0.7 时遇到的最令人费解的问题。我在同一个 Ubuntu 10.04 vbox 客户机上运行 Postgres 和 Rails 3：

```
"PostgreSQL 9.1.3 on i686-pc-linux-gnu, compiled by gcc-4.4.real (Ubuntu 4.4.3-4ubuntu5) 4.4.3, 32-bit" 
```

可能应用程序需要运行一个基于 created_at 时间戳的简单查询，该时间戳是基于服务器的时区的一天。就我而言，东部时间。我尝试了“with time zone”和“at time zone”的不同变体，并让它在 pgAdmin 中正常工作，但在 Rails 网站中却没有。

这是带有 ARel 查询的类方法。

```
def self.transactions2(business_id, begin_date, end_date )
trans = LogVouchers.select( %{
      created_at
  } ).
where( %{
     created_at >= ( TIMESTAMP WITH TIME ZONE ? at time zone 'utc')::timestamp
    and created_at < (TIMESTAMP WITH TIME ZONE ? at time zone 'utc')::timestamp
  },
     begin_date,
    end_date  )

end 
```

这是控制器代码：

```
 def voucher_transactions
    default_date = Time.zone.now.beginning_of_day

    @end_date = params[:end_date].blank? ? \
      Date.new(default_date.year, default_date.month,  default_date.day )  : \
        Date.new(params[:end_date][:year].to_i, params[:end_date][:month].to_i, \
        params[:end_date][:day].to_i)

    @begin_date = params[:begin_date].blank? ? \
      Date.new(default_date.year, default_date.month,  default_date.day )   : \
        @begin_date = Date.new(params[:begin_date][:year].to_i, \
        params[:begin_date][:month].to_i, params[:begin_date][:day].to_i)

    @data2  = LogVouchers.transactions2(business_id, @begin_date, @end_date + 1.day)
    ...
    end 
```

这是 rails 日志文件中的实际 SQL 代码和调试检查：

```
 LogVouchers Load (0.7ms)  SELECT 
 created_at
 FROM "log_vouchers" WHERE (
 created_at >= ( TIMESTAMP WITH TIME ZONE '2012-04-28' at time zone 'utc')::timestamp
 and created_at < (TIMESTAMP WITH TIME ZONE '2012-04-29' at time zone 'utc')::timestamp
 )

  ### 2012-05-01 21:18:04 -0400  voucher_transactions() @data2 =[
  #<LogVouchers created_at: "2012-04-28 03:14:29">
, #<LogVouchers created_at: "2012-04-28 03:15:24">
, #<LogVouchers created_at: "2012-04-28 03:18:19">
, #<LogVouchers created_at: "2012-04-28 03:38:35">
, #<LogVouchers created_at: "2012-04-28 03:58:08">
, #<LogVouchers created_at: "2012-04-28 15:44:46">
, #<LogVouchers created_at: "2012-04-28 17:12:20">
, #<LogVouchers created_at: "2012-04-28 18:46:45">
, #<LogVouchers created_at: "2012-04-28 18:55:47">
, #<LogVouchers created_at: "2012-04-28 18:57:52">
, #<LogVouchers created_at: "2012-04-28 19:02:15">
, #<LogVouchers created_at: "2012-04-28 19:02:50">
, #<LogVouchers created_at: "2012-04-28 19:46:36">
, #<LogVouchers created_at: "2012-04-28 19:47:17">
, #<LogVouchers created_at: "2012-04-28 19:50:22">
, #<LogVouchers created_at: "2012-04-28 19:50:56">] 
```

但是，如果我直接在 pgAdmin 的查询窗口上运行 SQL 代码，我会得到正确的结果：

```
"2012-04-28 15:44:46.641305"
"2012-04-28 17:12:20.615641"
"2012-04-28 18:46:45.277561"
"2012-04-28 18:55:47.40109"
"2012-04-28 18:57:52.616501"
"2012-04-28 19:02:15.542964"
"2012-04-28 19:02:50.888847"
"2012-04-28 19:46:36.16556"
"2012-04-28 19:47:17.084047"
"2012-04-28 19:50:22.672805"
"2012-04-28 19:50:56.376571" 
```

请注意，UTC 时间“2012-04-28 03:14:29”附近的 created_at 的 5 条记录不在正确的结果集中。

现在最令人费解的问题是：
Rails 如何将相同的 SQL 语句发送到 Postgres 数据库并得到不同的结果？

我显然在这里遗漏了一些东西。有大神可以帮忙吗？

### 附加说明 2012-5-2

背景：默认情况下，rails 3.0 在所有 db 表中生成 created_at 列作为 Postgres 中的“没有时区的时间戳”。我需要根据我的服务器时区“美国/纽约”运行每日报告。由于涉及的表数量，我使用 ARel select 方法来连接多个表并传入 begin_date 和 end_date 时间戳。我很难得到正确的结果集返回。它应该返回带有 UTC 时间戳的记录：

```
2012-04-28 04:00:00    to   2012-04-29 04:00:00 
```

但它返回了带有 UTC 时间戳的记录：

```
2012-04-28 00:00:00    to   2012-04-29 00:00:00 
```

我能想到的是改变类方法：

```
def self.transactions2(business_id, begin_date, end_date )

st_tz_offset      =   Time.zone.now.formatted_offset(true)
st_begin_date_tz  =   "#{begin_date} 00:00:00#{st_tz_offset}"
st_end_date_tz    =   "#{end_date} 00:00:00#{st_tz_offset}"

trans = LogVouchers.select( %{
      created_at
  } ).
where( %{
     created_at >= ( TIMESTAMP WITH TIME ZONE ? at time zone 'utc')
    and created_at < (TIMESTAMP WITH TIME ZONE ? at time zone 'utc')
  },
     st_begin_date_tz  ,
    st_end_date_tz  )

end 
```

实际上，它告诉 Postgres 在比较之前将其转换`timestamp with time zone`为`timestamp without time zone`。这对我有用。我知道这太复杂了。我非常感谢有人指出实现这一目标的更好方法。

### 附加说明 2

*   如果可能，我会避免更改 Ubuntu/Linux 服务器、Postgres 服务器中的默认设置，因为它往往会导致其他副作用。
*   将来，这些每日截止时间戳将基于服务器的`TimeZone`设置`current_user`而不是`TimeZone`服务器的设置。因为同一个 Web 应用程序的用户可以跨越多个时区，并且每日报告必须对各自的登录用户有意义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:13:55.870

您的表达取决于当地时间设置。这：

```
SET  timezone = 'EST';
SELECT TIMESTAMP WITH TIME ZONE '2012-04-29' AT TIME ZONE 'UTC'; 
```

返回与此不同的时间戳：

```
SET  timezone = '-2';
SELECT TIMESTAMP WITH TIME ZONE '2012-04-29' AT TIME ZONE 'UTC'; 
```

显然，您在来自 pgAdmin 的连接中的时间设置与在来自 ARel 的连接中的时间设置不同。通过以下方式了解：

```
SHOW timezone; 
```

`timezone`在 中定义`postgresql.conf`，但可以随时设置为不同的值。您可以使用以下命令将其重置为默认值：

```
RESET timezone; 
```

[我在最近的回答中更详细地](https://stackoverflow.com/a/9576170/939860)解释了 PostgreSQL 对时间戳和时区的处理。[手册中有关时区的](http://www.postgresql.org/docs/9.1/static/datatype-datetime.html#DATATYPE-TIMEZONES)
更多信息。

* * *

如果您想要“UTC 午夜”，请改用以下表达式：

```
SELECT TIMESTAMP '2012-04-29' AT TIME ZONE 'UTC'; 
```

或者简单地说：

```
SELECT '2012-04-29 0:0 +0'::timestamptz; 
```

无论设置如何，这都会返回相同的内部值`timezone`。不过，它将根据当地时区显示。因此，使用 EST，您将看到：

```
2012-04-28 19:00:00-05 
```

* * *

### 无时区

根据您的附加信息，您的表包含类型的数据`timestamp without time zone`- 或者简单地说`timestamp`，默认为`without time zone`. 这些时间戳隐含地基于`EST`.

如果您想检索一天的数据，从午夜开始，在午夜结束，与您当前**所在的时区无关**，请不要使用数据类型`timestamp with time zone`（或`timestamptz`）。只需使用`timestamp`，一切都很时髦。服务器应该得到：

```
WHERE created_at >= timestamp '2012-04-28 0:0'
AND   created_at <  timestamp '2012-04-29 0:0' 
```

或者：

```
WHERE created_at >= '2012-04-28 0:0'::timestamp
AND   created_at <  '2012-04-29 0:0'::timestamp 
```

甚至只是：

```
WHERE created_at >= '2012-04-28 0:0'
AND   created_at <  '2012-04-29 0:0' 
```

如果您想要**根据当前时区**的不同数据片段，那么服务器应该得到这个：

```
WHERE created_at >= '2012-04-28 0:0'::timestamptz AT TIME ZONE 'EST'
AND   created_at <  '2012-04-29 0:0'::timestamptz AT TIME ZONE 'EST' 
```

该术语`'2012-04-28 0:0'::timestamptz AT TIME ZONE 'EST'`在当地午夜时计算纽约的时间（没有时区）。

或者，您可以相应地计算应用程序中的时间戳，并使用上述不带时区的查询。

# php - 使用 PHP 根据以前的调查 q 显示调查问题的方法

> ID：10406707
> 
> 赞同：0
> 
> 时间：2012-05-02T01:49:33.703
> 
> 标签：php

所以我们有一个我正在建立的调查，对于这个例子 - 假设 Q1 有 50 个选择，他们可以选择一个（单选按钮）

现在在第二季度，我们显示相同的 50，减去在第一季度选择的那个。

我最初的想法是写一个无穷无尽的 if 语句链，比如

如果 $_REQUEST['q1'] != 1 ，回显答案的 html 代码 如果 $_REQUEST ['q1'] != 2，回显答案 #2 的 html 代码

ETC

正如您所看到的，这可能有点矫枉过正，因为 Q1 是一个单选按钮，所以只有一个答案。

我什至不知道如何谷歌或搜索这个答案 - 所以任何建议或建议将不胜感激。我确定我错过了一些非常简单的东西：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:21:23.647

我会将答案存储在一个带有键的数组中，作为某种答案ID。例如`$answers=array(0=>"answer 1",1=>"answer 2")`

然后，将选择的答案传播到另一个包含请求的键（无论值是什么）的数组中。

当渲染应该出现时，使用 array_diff_key($answers,(array)$_REQUEST['chosenAnswers']) 函数并渲染结果数组。（此函数将根据键返回两个数组之间的差异，并且先前选择的答案不会在结果数组中）...您可以选择将 HTML 直接存储在数组中，或者只存储答案，渲染时，在 while 语句中添加 HTML。

像这样的东西：

```
$answers=array(0=>"answer 1",1=>"answer 2",...,50=>"answer 49");
$chosen=(array)$_request['chosenAnswers'];
$result=array_diff_key($answers,$chosen);
$html="";
while ($answer = current($result)) {

    $html.="<label><input type="radio" name="grp1" value='".key($result)."'/>".$answer."</label>";

next($result);
}
echo $html; 
```

我可能在代码中犯了一些错误，但你明白了:)

# php - gzencode php 到目标 c nsdata

> ID：10406710
> 
> 赞同：1
> 
> 时间：2012-05-02T01:49:38.983
> 
> 标签：php, objective-c, gzip

我的问题类似于这里：

[iPhone 和 GZip](https://stackoverflow.com/questions/2159575/iphone-and-gzip)

只是，我没有得到任何结果。

我在 PHP 中压缩了数据：

```
$gztext = gzcompress($text,9);
var_dump(base64_encode($gztext)); 
```

并尝试在 iOS 中解码：

```
NSString *encodedGzippedString = @"K0ktLlFIzSspqlTQ09MDYTCloKcApWEEGBkaGZuYAAA=";
NSData *decodedGzippedData     = [NSData dataByBase64DecodingString:encodedGzippedString];
NSData *unGzippedJsonData = [decodedGzippedData gzipInflate];
if(unGzippedJsonData){
    NSString* unGzippedJsonString  = [[NSString alloc] initWithData:unGzippedJsonData encoding:NSASCIIStringEncoding];       
    if(unGzippedJsonString)
         NSLog(@"Result: %@", unGzippedJsonString);
    else
       NSLog(@"string error");
}
else NSLog(@"gzip error"); 
```

结果是“gzip 错误”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:05:16.747

这按预期工作：

```
NSString* base64Str = @"eJwrSS0uUShJrQARxSUAKVwFhg==";
NSData* gzData = [NSData dataFromBase64String:base64Str];
NSData* flatData = [gzData gzipInflate];
NSString* result = [NSString stringWithUTF8String:(const char*) flatData.bytes]; 
```

具有[NSData+Base64](http://projectswithlove.com/projects/NSData_Base64.zip)和[NSData+Compression](https://github.com/geoffgarside/Git.framework/tree/develop/Source/Category/NSData)类别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T04:09:32.393

我的情况是我想解码一个 gzip 文件。按照@sigman 的回答，我可以解码gzip 文件。
例如， `NSString * gfile = [documentDirectory stringByAppendingPathComponent:@"randomgzip.c.gz"]; NSData * gdata = [[NSData alloc] initWithContentsOfFile:gfile]; NSData * flatData = [gdata gzipInflate];`

# ruby-on-rails - 指南针未在某些文件中导入扩展名

> ID：10406711
> 
> 赞同：4
> 
> 时间：2012-05-02T01:50:01.863
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, compass-sass

这对我来说有点奇怪。

我在 Cedar 堆栈上使用带有 compass-rails 1.8.6 的 Rails 3.2.3。

将扩展导入到 .sass 文件的主“应用程序”文件夹中时，扩展在 Heroku 中运行良好。

我在其中创建了第二个样式表文件夹`/app/assets/stylesheets/mobile`和一个`/app/assets/stylesheets/mobile.scss`文件。

在开发模式下一切正常，但在 Heroku 上，它无法识别此文件夹中文件的扩展名。它看起来很奇怪，因为它似乎适用于应用程序文件夹文件。

```
2012-05-02T01:42:36+00:00 app[web.1]: Load path: /app
2012-05-02T01:42:36+00:00 app[web.1]: ActionView::Template::Error (File to import not found or unreadable: compass/css3/box-shadow.
2012-05-02T01:42:36+00:00 app[web.1]:   (in /app/app/assets/stylesheets/mobile/header.css.sass)):

#app/assets/stylesheets/mobile/header.css.sass
@import "compass/css3/box-shadow"

# Gemfile
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'compass-rails'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T08:02:49.117

默认情况下仅`application.css`预编译。其他顶级文件将需要显式添加`config/environments/production.rb`

例如

```
config.assets.precompile += ["mobile.css"] 
```

# vim - vim：用 vim-surround 插入单词

> ID：10406718
> 
> 赞同：3
> 
> 时间：2012-05-02T01:50:54.820
> 
> 标签：vim, vim-plugin, surround

我使用[环绕](https://github.com/tpope/vim-surround)vim 插件。当我写一个乳胶源来制作一个`\bf`类似于

```
hello w*orld 
```

（ * 是光标位置）我使用

```
ysiw}a\bf<space> 
```

并得到

```
hello {\bf *world} 
```

存在更简单的方法吗？或者我如何`\bf`自动插入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T02:17:51.983

我解决了在我的 ~/.vimrc 中添加了这个

```
let g:surround_42 = "{\\bf \r}" 
```

并在正常模式下调用单词

```
ysiw* 
```

### 编辑

对完整行有效

```
yss* 
```

# java - 使用 Twitter API 访问 Twitter 流 - 在 Java 中

> ID：10406720
> 
> 赞同：0
> 
> 时间：2012-05-02T01:51:01.537
> 
> 标签：java, twitter

这是我第一次使用 Twitter API。我正在编写一个基本应用程序，当用户键入一个短语时，它会返回带有该短语的最后 15 条推文。如果他们键入用户名并单击“搜索用户”按钮，它会返回该用户最近 15 条左右的推文。

我相信我已经完成了第一部分，但是在弄清楚如何从特定用户那里调出推文时有点卡住了。非常感谢任何进一步的指导。

```
package twitter;

import java.awt.Button;
import java.awt.TextArea;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;

import java.util.List;

import twitter4j.Query;
import twitter4j.QueryResult;
import twitter4j.Tweet;
import twitter4j.Twitter;
import twitter4j.TwitterException;
import twitter4j.TwitterFactory;
import twitter4j.TwitterStream;

public class SearchListener extends KeyAdapter implements ActionListener {
    private Button searchButton;
    private Button searchUserButton;
    private TextField searchText;
    private TextArea results;

    private Twitter twitter;

    public SearchListener(Button searchButton, Button searchUserButton,
            TextField searchText, TextArea results) {
        this.searchButton = searchButton;
        this.searchUserButton = searchUserButton;
        this.searchText = searchText;
        this.results = results;

        results.setText("(ready for search)");

        twitter = (new TwitterFactory()).getInstance();
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        doSearch();
    }

    private void doSearch() {
        String searchStr = searchText.getText();
        results.setText("searching for:  " + searchStr + "\n");
        if (searchStr == null || searchStr.length() == 0) {
            return;
        }

        try {

            QueryResult result = twitter.search(new Query(searchStr));
            List<Tweet> tweets = result.getTweets();
            int i = 0;
            for (Tweet tweet : tweets) {
                results.append("" + i + ":  ");
                results.append("@" + tweet.getFromUser() + " - "
                        + tweet.getText());
                results.append("\n\n");
                i++;
            }
            results.append("" + i + " total tweets found\n");

        } catch (TwitterException te) {
            te.printStackTrace();
            results.append("Failed to search tweets: " + te.getMessage());
            System.exit(-1);
        }
    }

    @Override
    public void keyTyped(KeyEvent e) {
        // results.append(e.getKeyChar() + "\n");
        if (e.getKeyChar() == '\n') {
            doSearch();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T04:24:22.637

首先，您需要查找用户的 ID，使用他们的屏幕名称作为键。您可以使用以下 twitter4j 方法来执行此操作：

[查找用户（字符串 []）](http://twitter4j.org/en/javadoc/twitter4j/api/UserMethods.html#lookupUsers%28java.lang.String%5b%5d%29)

获得用户 ID 后，您可以使用以下方法获取用户最近的 20 条推文。请注意，转推将不包括在内。

[获取用户时间线（长）](http://twitter4j.org/en/javadoc/twitter4j/api/TimelineMethods.html#getUserTimeline%28long%29)

# mysql - mysql 中带有过程、触发器和信号的语法错误

> ID：10406722
> 
> 赞同：2
> 
> 时间：2012-05-02T01:51:14.410
> 
> 标签：mysql, syntax-error

我感到很尴尬，我必须来寻求帮助，但正如我之前的许多人所了解的那样，mySQL 语法错误消息似乎与灰熊的教皇帽子一样有用。附件是我第一次尝试为汽车公司数据库编写触发器。表 can_lease 将员工的 id 和汽车型号的 id 关联起来。触发器预计会执行两条规则：1) 最多可以有 10 个汽车模型与 1 名员工相关联，以及 2) 员工必须是租赁类型（“租赁”列必须等于“Y”）。

因此，目标是让触发器捕获违反此规则的行为并发送信号和解释违规的消息。我只是不确定错误是什么，但我也会附上相关的错误消息。

```
create procedure can_lease_check (eid int)
begin
        declare can_lease_too_many_models condition for sqlstate '90001';
        if ((select count(rent_model_id) from can_lease where emp_id = eid) >= 10)
        then signal sqlstate '90001' set message_text = 'employee can lease at most 10 rent models.';

        declare can_lease_not_leaser for sqlstate '90002';                                                                                           
        if not (select leasing from employer where employer.emp_id = eid) == 'Y'                                                                     
        then signal sqlstate '90002' set message_text = 'employee must be of type "leasing"';
end;

delimiter $$
create trigger can_lease_insert_trigger
after insert on can_lease
for each row begin
    call can_lease_check(new.emp_id);
end;
$$

create trigger can_lease_update_trigger
after update on can_lease
for each row begin
    call can_lease_check(new.emp_id);
end;
$$ 
```

以下是错误消息：

```
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 3
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'if ((select count(rent_model_id) from can_lease where emp_id = eid) >= 10)
    then' at line 1
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'end' at line 1 
```

感谢您的帮助！我也很感激人们对一般调试这类事情的任何建议。来自 gcc 至少告诉我为什么我的代码是错误的，这是一个非常陌生的过程*！*

编辑：我意识到我也应该将分隔符更改移到程序上方。我不明白，但这消除了除一个错误之外的所有错误。目前，错误是

```
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'if (select count(rent_model_id) from can_lease where emp_id = eid) == 10
    then s' at line 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:56:56.277

第一个和关键字之间的分号 ( `;`)是罪魁祸首。只需用 将原始块括起来，如下所示。我在示例中使用分隔符，并且我知道您使用，尽管不会产生任何差异。`begin``end``create``DELIMITER``#``$$`

```
DELIMITER #
create procedure can_lease_check (eid int)
begin
    declare can_lease_too_many_models condition for sqlstate '90001';
    if ((select count(rent_model_id) from can_lease where emp_id = eid) >= 10)
    then signal sqlstate '90001' set message_text = 'employee can lease at most 10 rent models.';

    declare can_lease_not_leaser for sqlstate '90002';                                                                                           
    if not (select leasing from employer where employer.emp_id = eid) == 'Y'                                                                     
    then signal sqlstate '90002' set message_text = 'employee must be of type "leasing"';
end# 
```

另外，如果你像我一样（）结束它，或者像你一样，在关键字`end#`后面加上分号，也没有区别：`end`

```
end;
# 
```

# php - 使用 codeigniter 使 LI 成为锚链接

> ID：10406726
> 
> 赞同：-1
> 
> 时间：2012-05-02T01:52:02.360
> 
> 标签：php, html, codeigniter

我试图了解如何将 UL 的 LI 元素转换为与 codeigniter 的链接，但我在文档中没有看到任何可以解释其外观的地方。我还尝试进行谷歌搜索，但没有找到我想要的结果。

我正在寻找类似的东西：

```
<UL>
    <LI><a href="whatever.php">Test Link</a><LI>
    <LI><a href="whatever.php">Test Link</a><LI>
</UL> 
```

这是我到目前为止所拥有的：

```
<?php 
                    $list = array(
                            'Login',
                            'Forgot Password'
                        );
                        $attributes = array(
                            'class' => 'uibutton-group'
                        );
                        echo ul($list, $attributes);
                    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:54:51.443

[URLHelper 救援！](http://codeigniter.com/user_guide/helpers/url_helper.html)

如果你想创建一个锚点，你可以使用“锚点”，如下所示：

`<ul><li><? echo anchor('news/local/123', 'My News', 'title="News title"'); ?></li></ul>`

如果您尝试使用HTML_Helper的**ul方法创建锚点列表，请尝试以下操作：**

```
<?php 
    $list = array(
        anchor('/login', 'Login', 'title="Login"'),
        anchor('/forgot-password', 'Forgot Password', 'title="Forgot Password"')
    );
    $attributes = array(
        'class' => 'uibutton-group'
    );
    echo ul($list, $attributes);
?> 
```

或者将该“锚”标记的结果分别放在 $login、$forgotPassword 变量中，然后将其放入数组中。**ul**的 HTML_Helper根据数组中的内容输出值。放置锚标签的“字符串”（或锚方法给你的东西），你应该很好。

# java - Java：执行器与队列的关系

> ID：10406730
> 
> 赞同：1
> 
> 时间：2012-05-02T01:53:16.293
> 
> 标签：java, multithreading, concurrency

所以在 Java 并发中，有一个*任务*的概念，它实际上是任何实现`Runnable`或`Callable`（更具体地说，是该接口的重写`run()`或`call()`方法）。

我很难理解以下之间的关系：

*   一个任务（`Runnable`/ `Callable`）；和
*   任务`ExecutorService`提交给；和
*   底层的并发工作队列或列表结构，由`ExecutorService`

我*相信*这种关系是以下几点：

*   作为开发人员，您必须选择`ExecutorService`最适合手头任务的工作结构
*   您使用要使用的基础结构初始化`ExecutorService`（例如，作为 a ）（例如， an ）（如果是，**如何？！？！**）`ScheduledThreadPool``ArrayBlockingQueue`
***   您将任务提交给`ExecutorService`，然后使用其线程/池策略用任务的副本填充给定的结构（ABQ 或其他）*   现在，每个衍生/池化线程都从工作结构中提取任务副本并执行它**

 **首先，如果我不符合上述任何假设，请更正/澄清上述任何假设！

其次，如果任务只是在底层工作结构中一遍又一遍地*复制*/复制（例如，列表的每个索引中的相同副本），那么您如何将一个大问题分解为更小的（并发）问题？换句话说，如果任务只是执行步骤 A - Z，并且您有一个包含 1,000 个这些任务的 ABQ，那么每个线程不会也只执行 A - Z 吗？你怎么说“一些线程应该在 A - G 上工作，而其他线程应该在 H 上工作，而其他线程应该在 I - Z 上工作”等等？

对于第二个，我可能需要一个代码示例来可视化它们是如何组合在一起的。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:32:08.660

您的最后一个假设并不完全正确。`ExecutorService`不会拉取任务的副本。程序必须单独提供由`ExecutorService`. 当一个任务完成后，队列中的下一个任务将被执行。

An`ExecutorService`是用于处理线程池的接口。您通常在池上执行多个任务，每个任务都针对问题的不同部分进行操作。作为开发人员，您必须在创建任务时指定每个任务应处理的问题的哪些部分，然后再将其发送到`ExecutorService`. 每个任务的结果（假设他们正在解决一个常见问题）应该添加到一个`BlockingQueue`或其他并发集合中，另一个线程可以使用结果或等待所有任务完成。

这是一篇您可能想阅读的关于如何使用的文章`ExecutorService`：[http ://www.vogella.com/articles/JavaConcurrency/article.html#threadpools](http://www.vogella.com/articles/JavaConcurrency/article.html#threadpools)

更新： 的一个常见用途`ExecutorService`是实现生产者/消费者模式。这是我快速整理的一个示例以帮助您入门——它仅用于演示目的，为简单起见，省略了一些细节和关注点。线程池包含多个生产者线程和一个消费者线程。正在执行的工作是将 0...N 中的数字相加。每个生产者线程对较小的数字区间求和，并将结果发布到`BlockingQueue`. 消费者线程处理添加到`BlockingQueue`.

```
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class NumberCounter {

    private final ExecutorService pool = Executors.newFixedThreadPool(2);
    private final BlockingQueue<Integer> queue = new ArrayBlockingQueue(100);

    public void startCounter(int max, int workers) {
        // Create multiple tasks to add numbers. Each task submits the result
        // to the queue.
        int increment = max / workers;
        for (int worker = 0; worker < workers; worker++) {
            Runnable task = createProducer(worker * increment, (worker + 1) * increment);
            pool.execute(task);
        }

        // Create one more task that will consume the numbers, adding them up
        // and printing the results.
        pool.execute(new Runnable() {

            @Override
            public void run() {
            int sum = 0;

            while (true) {
                try {
                Integer result = queue.take();
                sum += result;
                System.out.println("New sum is " + sum);
                } catch (InterruptedException e) {
                e.printStackTrace();
                }
            }

            }
        });

    }

    private Runnable createProducer(final int start, final int stop) {
        return new Runnable() {

            @Override
            public void run() {
            System.out.println("Worker started counting from " + start + " to " + stop);
            int count = 0;
            for (int i = start; i < stop; i++) {
                count += i;
                }
                queue.add(count);
            }

        };
    }

    public static void main(String[] args) throws InterruptedException {
        NumberCounter counter = new NumberCounter();
        counter.startCounter(10000, 5);
    }

} 
```**

# ruby - rails 3动态填充下拉列表

> ID：10406731
> 
> 赞同：0
> 
> 时间：2012-05-02T01:53:16.963
> 
> 标签：ruby, ruby-on-rails-3, model-view-controller, ruby-on-rails-3.1

我在视图中有 2 个下拉菜单。当视图加载选项列表时，会自动填充第一个下拉列表。选择项目时，我想填充下拉＃2。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:59:36.387

有几种方法可以做到这一点。您可以进行 AJAX 调用（响应下拉列表 #1 中的值选择）。这样做的缺点是它需要对服务器进行往返调用，然后用结果更新下拉列表#2 的值。

另一种方法是在页面首次加载时为下拉列表#2 预加载所有可能的值，并在值更改后立即在浏览器中使用 JavaScript 更改它（而不是一直调用回服务器获取值）。

无论哪种方式，您很可能都在修改 DOM，因此这将是某种 JavaScript 解决方案。无论您选择 AJAX，还是预加载并立即更改它，可能取决于它如何影响原始页面加载速度、您想要加载到客户端的数据量等。如果它是下拉列表中可能的相对较少的选项 #2 ，那么预加载可能是您最好的选择。

# linux - awk 搜索文件中的字符串

> ID：10406735
> 
> 赞同：0
> 
> 时间：2012-05-02T01:53:39.863
> 
> 标签：linux, scripting, awk

我已经实现了一个在文件中的列中搜索字符串的函数，它运行良好。我想知道如何修改它以搜索字符串的所有列？

```
awk -v s=$1 -v c=$2 '$c ~ s { print $0 }' $3 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:55:08.790

如果“所有列”表示“整个文件”，则：

```
grep $string $file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:44:56.043

这是修改当前脚本以在两个不同列中搜索两个不同字符串的一种方法示例。您可以将它扩展到您希望的任意数量，但是对于更多的人来说，以另一种方式来做会更有效。

```
awk -v s1="$1" -v c1="$2" -v s2="$3" -v c2="$4"  '$c1 ~ s1 || $c2 ~ s2 { print $0 }' "$5" 
```

如您所见，这种技术无法很好地扩展。

另一种技术将列号和字符串视为一个文件，并且应该可以更好地扩展：

```
awk 'FNR == NR {strings[++c] = $1; columns[c] = $2; next}
     {
         for (i = 1; i <= c; i++) {
             if ($columns[i] ~ strings[i]) {
                 print
             }
         }
     }' < <(printf '%s %d\n' "${searches[@]}") inputfile 
```

该数组`${searches[@]}`应包含交替的字符串和列号。

有几种填充方法`${searches[@]}`。这是一个：

```
#!/bin/bash
# (this is bash and should precede the AWK above in the script file)
unset searches
for arg in "${@:1:$#-1}"
do
    searches+=("$arg")
    shift
done
inputfile=$1   # the last remaining argument
# now the AWK stuff goes here 
```

要运行脚本，您可以这样做：

```
$ ./scriptname foo 3 bar 7 baz 1 filename 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:33:41.893

```
awk -v pat="$string" '$0 ~ pat' infile 
```

# perl - 失去与 Net::SSH::Perl 的连接

> ID：10406736
> 
> 赞同：3
> 
> 时间：2012-05-02T01:53:48.807
> 
> 标签：perl, ssh

**下面的解决方案**

我们有一个 ETL 系统，它将数据提取到 CSV 中，将其上传到另一台服务器，然后需要连接到另一台服务器并调用 java jar 将 csv 加载到 memcache 中。我有一个脚本可以执行此步骤的每一步，但在最后一步会丢失 SSH 连接。远程计算机上的过程继续并完成。

我为此使用 Net::SSH::Perl，它在运行一小段时间后收到“连接失败：对等连接重置”错误。我已经将脚本归结为这个并复制了结果：

```
#!/usr/bin/perl

use strict;
use Net::SSH::Perl;
use Log::Log4perl;

my ($stdout, $stderr, $exit, $ssh);

$ssh = Net::SSH::Perl->new('sshost',
        identity_files => ['/path/to/key.rsa'],
        protocol => 2,
        debug => 1);

$ssh->login('user');

my $cmd = "java -Xms4096m -Xmx4096m -DetlDate=20120427 -DmemcacheHosts=host1,host2 -cp etl-0.1-SNAPSHOT.jar com.nnn.platform.service.etl";

$ssh->register_handler("stdout", sub {
        my($channel, $buffer) = @_;
        print "STDOUT: ", $buffer->bytes;
});

$ssh->register_handler("stderr", sub {
        my($channel, $buffer) = @_;
        print "STDERR: ", $buffer->bytes;
});

$ssh->cmd("cd /usr/local/loader; $cmd"); 
```

我得到的 SSH 调试信息是：

```
localhost: Reading configuration data /home/user/.ssh/config
localhost: Reading configuration data /etc/ssh_config
localhost: Connecting to sshost, port 22.
localhost: Remote protocol version 2.0, remote software version OpenSSH_4.3
localhost: Net::SSH::Perl Version 1.34, protocol version 2.0.
localhost: No compat match: OpenSSH_4.3.
localhost: Connection established.
localhost: Sent key-exchange init (KEXINIT), wait response.
localhost: Algorithms, c->s: 3des-cbc hmac-sha1 none
localhost: Algorithms, s->c: 3des-cbc hmac-sha1 none
localhost: Entering Diffie-Hellman Group 1 key exchange.
localhost: Sent DH public key, waiting for reply.
localhost: Received host key, type 'ssh-dss'.
localhost: Host 'sshost' is known and matches the host key.
localhost: Computing shared secret key.
localhost: Verifying server signature.
localhost: Waiting for NEWKEYS message.
localhost: Send NEWKEYS.
localhost: Enabling encryption/MAC/compression.
localhost: Sending request for user-authentication service.
localhost: Service accepted: ssh-userauth.
localhost: Trying empty user-authentication request.
localhost: Authentication methods that can continue: publickey,gssapi-with-mic.
localhost: Next method to try is publickey.
localhost: Trying pubkey authentication with key file '/path/to/key.rsa'
localhost: Login completed, opening dummy shell channel.
localhost: channel 0: new [client-session]
localhost: Requesting channel_open for channel 0.
localhost: channel 0: open confirm rwindow 0 rmax 32768
localhost: Got channel open confirmation, requesting shell.
localhost: Requesting service shell on channel 0.
localhost: channel 1: new [client-session]
localhost: Requesting channel_open for channel 1.
localhost: Entering interactive session.
localhost: Sending command: cd /usr/local/loader; java -Xms4096m -Xmx4096m -DetlDate=20120427 -DmemcacheHosts=host1,host2 -cp etl-0.1-SNAPSHOT.jar com.nnn.platform.service.etl
localhost: Sending command: cd /usr/local/loader; java -Xms4096m -Xmx4096m -DetlDate=20120427 -DmemcacheHosts=host1,host2 -cp etl-0.1-SNAPSHOT.jar com.nnn.platform.service.etl
localhost: Requesting service exec on channel 1.
localhost: channel 1: open confirm rwindow 0 rmax 32768 
```

然后将 jar 的输出打印到 STDERR，我看到它返回了。9 秒后它停止，我最终通过对等错误重置连接。STDERR 处理程序按预期工作。

我不确定这是否是 Net::SSH::Perl 处理命令的问题，这些命令需要一段时间才能通过 STDERR 或其他方式运行/返回。我一直在考虑切换到 Net::SSH2，因为它似乎是一个功能更齐全的库，但我真的很想知道为什么会失败。

**解决方案**

问题在于输出只到 STDERR。我编辑了我的命令以添加`2>&1`并因此将 STDERR 重定向到 STDOUT，突然一切都按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T08:01:06.343

Net::SSH::Perl 不再维护，并且有一长串已知未解决的错误。如今，CPAN 提供了更好的模块，如[Net::SSH2](https://metacpan.org/module/Net%3a%3aSSH2)或[Net::OpenSSH](https://metacpan.org/module/Net%3a%3aOpenSSH)。

例如：

```
my $ssh = Net::OpenSSH->new($sshost,
                            user => $user,
                            key_path => '/path/to/key.rsa');
my ($out, $err) = $ssh->capture2($cmd); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:44:05.910

问题在于输出只到 STDERR。我编辑了我的命令以添加 2>&1 ，从而将 STDERR 重定向到 STDOUT ，突然一切都按预期工作了。

```
my $cmd = "java -Xms4096m -Xmx4096m -DetlDate=20120427 -DmemcacheHosts=host1,host2 -cp etl-0.1-SNAPSHOT.jar com.nnn.platform.service.etl 2>&1"; 
```

# django - django-haystack 2.0.0beta 构面示例 - 不显示构面计数

> ID：10406737
> 
> 赞同：1
> 
> 时间：2012-05-02T01:53:59.520
> 
> 标签：django, solr, django-haystack

我一直在研究 Haystack 2.0.0beta 的文档，并使用 solr3.6.0 作为我的后端。我已经完成了入门示例。现在使用构面示例。

search_indexes.py

```
import datetime
from haystack import indexes
from bsmain.models import Note

class NoteIndex(indexes.SearchIndex, indexes.Indexable):
    text = indexes.CharField(document=True, use_template=True)
    author = indexes.CharField(model_attr='user', faceted=True)
    pub_date = indexes.DateTimeField(model_attr='pub_date')

def get_model(self):
    return Note

def index_queryset(self):
    """Used when the entire index for model is updated."""
    return self.get_model().objects.filter(pub_date__lte=datetime.datetime.now()) 
```

网址.py

```
from django.conf.urls.defaults import *
from django.conf import settings

from django.conf.urls.defaults import *
from haystack.forms import FacetedSearchForm
from haystack.query import SearchQuerySet
from haystack.views import FacetedSearchView
sqs = SearchQuerySet().facet('author')

urlpatterns = patterns('haystack.views',
    url(r'^$', FacetedSearchView(form_class=FacetedSearchForm,searchqueryset=sqs),
        name='haystack_search'),
) 
```

我已经在 python shell 中进行了测试并获得了构面和计数，但是当我触发 /search url（使用示例中为构面提供的 html）时，我得到了表单，但没有构面或计数。任何人都可以在上面的代码中看到任何错误，或者我还缺少其他东西吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:02:16.933

您是否重建了索引 ( `./manage.py rebuild_index`)？

完成后，创建 schema.xml ( `./manage.py build_solr_scema > schema.xml`)

然后将 shcema.xml 复制到您的 solr conf 目录并重新启动 solr。

那应该可以解决您的问题。

# ironmq - 使用 IronMQ PHP 客户端的 Http 异常代码 0

> ID：10406739
> 
> 赞同：1
> 
> 时间：2012-05-02T01:54:20.633
> 
> 标签：ironmq

我正在尝试 IronMQ 的 php 客户端。我正在尝试使用库提供的示例，但是对于所有请求，我都会收到带有代码 0 且没有消息的 http 异常。客户端配置正确，具有正确的令牌和项目 ID。

例如，我尝试将获取消息的 url 粘贴到浏览器中，我得到一个空数组的响应，这没关系，因为我无法将任何消息发布到队列中。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T16:48:41.370

如果您使用的是 Windows，则需要禁用 ssl_verifypeer。

1) 确保您拥有来自[https://github.com/iron-io/iron_worker_php/blob/master/IronWorker.class.php的最新库](https://github.com/iron-io/iron_worker_php/blob/master/IronWorker.class.php)

2）像这样禁用ssl验证对等点：

```
$worker = new IronWorker(....);
$worker->ssl_verifypeer = false; 
```

让我知道这是否有效。

# iphone - 使用 NSData 发送链接列表

> ID：10406741
> 
> 赞同：1
> 
> 时间：2012-05-02T01:54:50.423
> 
> 标签：iphone, objective-c, linked-list, nsdata

我目前正在实施我的多人游戏的网络端。到目前为止，我通过将我的对象序列化为 NSData 来发送类。问题在于我的类中有引用相同类型的其他对象的链接列表。如果我使用 initWithCoder: (NSCoder *) 解码器传输所有对象并在接收端解码，那么类中的对象是否仍然持有正确的引用？如果没有，有人可以推荐一个干净的解决方案来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:08:01.350

NSCoder 应该可以正常工作。编码时，对列表的头部进行编码，并使用列表结构本身来指导其余部分。假设列表有一个字符串作为它的数据和一个简单的前向链接。只需对头部进行编码...

```
// in ListNode.m

- (void)encodeWithCoder:(NSCoder*)encoder {

    [encoder encodeObject:self.theString forKey:@"thisIsMyListsData"];
    if (self.nextNode) {
        [encoder encodeObject:self.nextNode forKey:@"nextNode"];
    }
} 
```

# php - PHP/MYSQL 评论-回复表结构

> ID：10406744
> 
> 赞同：0
> 
> 时间：2012-05-02T01:55:10.170
> 
> 标签：php, mysql, comments

我有一个用 PHP 编写的评论脚本运行良好。它将评论保存在 mysql 评论表中，其中包含 commentid、subjectid、userid 和 timecreated 字段。我现在想实现一个回复功能。我是否应该使用用户 ID、创建时间、回复和评论字段创建一个新的回复表。

或者最好将评论表中的回复作为评论包含在内，但有两个额外的字段，一个表示此特定评论是回复，另一个表示它是回复的评论。

倾向于第一个选项，但这意味着额外的查询。

希望有经验的人给点建议！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T02:00:01.753

我会为`referenceid`和增加两列`parentid`。这样，您可以拥有嵌套评论，如果您愿意的话。比在查询中加入多个表更容易、更高效。如果评论不是回复，`referenceid`则为 0（或 null）。无需创建另一列来标记它是否是回复。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T14:40:29.327

这不是您最初问题的答案，但我确实想向您展示一种快速而肮脏的嵌套评论方法，如果这是我的项目，我会使用这种方法。几乎可以肯定还有更优雅的方法，这里的另一位成员可能会有建议。

```
<?php

// Retrieve ALL comments related to this subject (including all replies and nested comments)
$rs = mysql_query( 'SELECT * FROM `comments` WHERE subjectid = '7' ORDER BY timecreated ASC' );

// Process ALL comments and place them into an array based on their parent id
// Thus we end up with something like:
// $data[ 0 ][ 0 ] = array( 'commentid' => 1, 'subjectid' => 7, 'userid' => 1, 'timecreated' => '2012-05-01 12:00:00', 'parentid' => 0 );
// $data[ 0 ][ 1 ] = array( 'commentid' => 2, 'subjectid' => 7, 'userid' => 5, 'timecreated' => '2012-05-01 14:00:00', 'parentid' => 0 );
// $data[ 2 ][ 0 ] = array( 'commentid' => 3, 'subjectid' => 7, 'userid' => 1, 'timecreated' => '2012-05-01 16:00:00', 'parentid' => 2 ); This is a reply to commentid #2
// $data[ 2 ][ 1 ] = array( 'commentid' => 4, 'subjectid' => 7, 'userid' => 5, 'timecreated' => '2012-05-01 16:30:00', 'parentid' => 2 ); This is another reply to commentid #2
// $data[ 3 ][ 0 ] = array( 'commentid' => 5, 'subjectid' => 7, 'userid' => 3, 'timecreated' => '2012-05-01 17:00:00', 'parentid' => 3 ); This is a reply to the reply with commentid #3

while ( $row = mysql_fetch_assoc( $rs ) ){
    $data[ $row['parentid'] ][] = $row;
}

function output_comments( &$data_array, $parentid ){

    // Loop through all comments with matching $parentid

    foreach ( $data_array[ $parentid ] as $k=>$v ){
        // Output all comments, open .comment DIV but do not close (for nesting purposes)
        echo '<div class="comment"><strong>' . $v['username'] . ':</strong> ' . $v['message'];

        // If there are any replies to this comment, output them by recursively calling this function
        if ( count( $data_array[ $v['commentid'] ] > 0 ){
            output_comments( $data_array, $v['commentid'] );
        }

        // Close the open DIV
        echo '</div>';
    }
}

// Call the output_comments() function, which will recursively run to support unlimited nesting

output_comments( $data, 0 ); 
```

然后，您可以通过缩进任何具有父 DIV.comment 的 DIV.comment 来非常简单地设置嵌套注释的样式

```
<style type="text/css">
.comment .comment {
    padding-left: 30px;
}
</style> 
```

# spring - HibernateOptimisticLockingFailureException 将连接标记为“关闭”？

> ID：10406746
> 
> 赞同：7
> 
> 时间：2012-05-02T01:55:17.373
> 
> 标签：spring, hibernate, exception-handling, database-connection, optimistic-locking

我得到以下堆栈跟踪：

```
org.springframework.orm.hibernate3.HibernateOptimisticLockingFailureException: Object of class [com.btfin.wrapcore.request.MFRequest] with identifier [2850448]: optimistic locking failed; nested exception is org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [com.btfin.wrapcore.request.MFRequest#2850448]
  at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:672)
  at org.springframework.orm.hibernate3.HibernateTransactionManager.convertHibernateAccessException(HibernateTransactionManager.java:793) 
```

这是由于乐观锁定异常。我可以解决这个问题的根本原因。

我的问题是 - 在这种情况下 - 异常处理将数据库连接设置为“关闭”。（这会导致我的连接池出现问题）。

处理数据库异常的模式是什么，比如`HibernateOptimisticLockingFailureException`通过 spring 和 hibernate 冒泡并返回一个关闭的连接？

您知道 Spring/Hibernate 代码中将连接设置为关闭的部分吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T07:43:58.623

[Hibernate Docs](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html)明确指出，如果在使用 Session 时发生*任何*异常，则以后不能重用 Session。此外，每个 Session 可以包含多个事务，并且在每个事务提交后 - 同样发生，连接被关闭。

但是在使用连接池时，连接并没有真正关闭，当调用 close() 方法时，[连接返回池而不物理关闭](http://docs.oracle.com/javase/6/docs/api/javax/sql/PooledConnection.html)：

> 当应用程序关闭其连接时，底层物理连接会被回收而不是被关闭。

因此，如果您在物理上关闭连接时遇到问题，我宁愿更多地关注池，而不是 Hibernate 或 Spring——它们只能调用 close() ，这应该像我之前描述的那样工作。

# templates - Playframework 1.2.4：将 render() 的结果作为字符串获取？

> ID：10406748
> 
> 赞同：4
> 
> 时间：2012-05-02T01:55:36.877
> 
> 标签：templates, playframework, playframework-1.x

在 play framework 1.2.4 Controller 中，是否可以在输出到浏览器之前将模板或标签的内容作为 String 获取？

我希望能够做到这一点：

```
String json = renderAsString("/path/to/template.json", var1, var2);

//then use json as the body of a Play.WS request body. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:14:22.387

**该解决方案基于您正在谈论 PlayFramework 1.x 的假设**

如果您使用的是[Groovy 模板引擎](http://www.playframework.org/documentation/1.2.4/templates)：

```
Map<String, Object> args = ...
Template template = TemplateLoader.load("path/to/template.suffix");
String s = template.render(args); 
```

[如果您使用的是Rythm 模板引擎](http://www.playframework.org/modules/rythm)，那么您有一个捷径：

```
String s = Rythm.render("path/to/template.suffix", param1, param3...); 
```

或者你也可以使用命名参数：

```
Map<String, Object> args = ...
String s = Rythm.render("path/to/template.suffix", args); 
```

**请注意**，如果您的模板文件放在`app/rythm`文件夹下，则 Groovy 方式也适用于 Rythm。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T10:22:46.377

*除了[绿色回答](https://stackoverflow.com/a/10406860/595223)*。

如果创建 json 是您想要的，那么您最好使用 gson 而不是使用 groovy 模板构建自己的字符串。Gson 包含在 Play Framework 1.2.X 中。

[您可以在此处](https://sites.google.com/site/gson/gson-user-guide)找到更多信息。来自 Gson 文档的示例：

```
class BagOfPrimitives {
    private int value1 = 1;
    private String value2 = "abc";
    BagOfPrimitives() {
        // no-args constructor
    }
}

BagOfPrimitives obj = new BagOfPrimitives();
Gson gson = new Gson();
String json = gson.toJson(obj);  
//json is {"value1":1,"value2":"abc"} 
```

您也可以使用 Flexjson 代替 gson。

# java - Graphics2D 不清除透明图像

> ID：10406750
> 
> 赞同：3
> 
> 时间：2012-05-02T01:56:13.740
> 
> 标签：java, transparency, repaint

我有以下代码片段，它*应该*在第一台显示器的透明背景上增加一个计数器。当图像显示为 0 时，它渲染得很好，但在那之后（一旦击中 1），窗口就会用不透明的背景重绘。

我知道实践中的愚蠢示例，只是将一个真实的用例分解为一段更简单的代码。

看来关键可能在 TestCanvas 的 paintComponent 方法中：

```
g.setColor(new Color(0, 0, 0, 0));
g.clearRect(0, 0, getWidth(), getHeight()); 
```

据我所知，这两条线应该将绘图颜色设置为完全透明，然后用该颜色清除给定区域 - 但这似乎不适用于第一次重绘。

编辑：使用 fillRect 而不是 clearRect 不起作用，因为它只是在现有图像之上绘制透明矩形，因此它永远不会被清除。1 覆盖在 0 上，然后 2 覆盖在 1 上，依此类推。

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.GraphicsEnvironment;
import java.awt.Rectangle;
import javax.swing.JPanel;
import javax.swing.JWindow;
import javax.swing.SwingUtilities;

public class LyricWindow extends JWindow {

    private final TestCanvas canvas;

    public LyricWindow(Rectangle area, boolean stageView) {
        setBackground(new Color(0, 0, 0, 0));
        setArea(area);
        canvas = new TestCanvas();
        canvas.setPreferredSize(new Dimension((int) (area.getMaxX() - area.getMinX()), (int) (area.getMaxY() - area.getMinY())));
        add(canvas);
        new Thread() {

            public void run() {
                for(int i = 0; true; i++) {
                    final int ii = i;
                    SwingUtilities.invokeLater(new Runnable() {

                        @Override
                        public void run() {
                            canvas.setText(Integer.toString(ii));
                        }
                    });
                    try {
                        Thread.currentThread().sleep(200);
                    }
                    catch(InterruptedException ex) {}
                    System.out.println(ii);
                }
            }
        }.start();
    }

    public final void setArea(final Rectangle area) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                if(canvas != null) {
                    canvas.setPreferredSize(new Dimension((int) (area.getMaxX() - area.getMinX()), (int) (area.getMaxY() - area.getMinY())));
                }
                setSize((int) (area.getMaxX() - area.getMinX()), (int) (area.getMaxY() - area.getMinY()));
                setLocation((int) area.getMinX(), (int) area.getMinY());
            }
        });
    }

    public static void main(String[] args) {
        LyricWindow w = new LyricWindow(GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices()[0].getConfigurations()[0].getBounds(), false);
        w.setVisible(true);
    }
}

class TestCanvas extends JPanel {

    private String text;

    @Override
    public void paintComponent(Graphics g) {
        g.setColor(new Color(0, 0, 0, 0));
        g.clearRect(0, 0, getWidth(), getHeight());
        g.setColor(Color.RED);
        g.drawString(text, 100, 100);
    }

    public void setText(String s) {
        text = s;
        repaint();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T11:09:26.683

原来我必须在绘画之前设置正确的合成值。添加

```
((Graphics2D)g).setComposite(AlphaComposite.getInstance(AlphaComposite.SRC)); 
```

到`paintComponent()`方法的开始，然后使用`fillRect()`，成功了！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T02:02:57.083

~~尝试使用 g.fillRect(...) 而不是 g.clearRect(...)。我想我曾经遇到过类似的问题，这可能已经为我解决了。~~

我找到了用于解决问题的原始解决方案`BufferedImages`。不知道为什么白色可能会起作用而黑色不起作用，但试一试：

```
g.setBackground(new Color(255, 255, 255, 0));
g.clearRect(0, 0, width, height); 
```

从`Color`类的Javadoc：

> alpha 值 1.0 或 255 表示颜色完全不透明，alpha 值 0 或 0.0 表示颜色完全透明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-01T03:31:48.747

我知道这有点老了，但是你为什么不直接使用 JPanel 已经构建的功能来通过调用超类中的函数来为你清除画布呢？

```
@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.setColor(new Color(0, 0, 0, 0));
    g.clearRect(0, 0, getWidth(), getHeight());
    g.setColor(Color.RED);
    g.drawString(text, 100, 100);
} 
```

这应该会给您留下一个完全空白的图形对象来绘制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T02:04:05.933

如果你的颜色是完全透明的，那么清除实际上有什么作用吗？

尝试将 alpha 值设置为 255，而不是 0。问题是，这会将矩形“清除”为 black `(0, 0, 0)`，但我不确定是否可以将其“清除”为透明`clearRect`. 你可以试试`fillRect`。

# gwt - GWT/JSNI 这个。不替换为对实例的引用

> ID：10406769
> 
> 赞同：2
> 
> 时间：2012-05-02T01:59:51.700
> 
> 标签：gwt, jsni

我在 GWT 类中有以下代码：

```
private native JavaScriptObject getRequest() /*-{
    var request = ...;

    request.onOpen = function(response) {
this.@com.mdarveau.fnp.client.Client::onOpen(Lcom/mdarveau/fnp/client/Response;)(response);
    };

    return request;
}-*/;

void onOpen( Response response ) {
    Window.alert( "Got response " + response );
} 
```

但是，当调用与关联的函数时`request.onOpen`，“this 变量”不会替换为对已编译 GWT 类的引用。使用 chrome javascript 控制台和调试器，我看到它看起来像是对`request`对象的引用。

知道为什么吗？我也加载了jquery，会不会有冲突？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-05T03:08:08.853

明白了：您需要`this`在本机代码中获取对的引用，然后在`function`块中使用它：

```
var theInstance = this; 
```

进而

```
request.onOpen = function(response) {
    theInstance.@com.mdarveau.fnp.client.Client::onOpen(Lcom/mdarveau/fnp/client/Res‌​ponse;)(response);
}; 
```

# ember.js - 在 emberjs 中创建特定于视图实例的绑定的理想方法是什么？

> ID：10406771
> 
> 赞同：1
> 
> 时间：2012-05-02T01:59:56.617
> 
> 标签：ember.js

我有一个在 {{#each}} 块中实例化的视图，因此有多个实例。每个视图都需要有一个绑定到特定于该视图实例的对象的属性。所以通常声明绑定的方式：

```
App.hash = Ember.Object.create({
   item1: "one",
   item2: "two"
});
App.MyView = Ember.View.extend({
   itemBinding: "App.hash.itemN"
}); 
```

不起作用，因为当我定义绑定映射到 ( `App.hash.itemN`) 时，我还不知道它应该是 item1 还是 item2（在上面的代码中由 itemN 表示）。

我找到了解决这个问题的方法，这似乎有点笨拙，并且很好奇是否有合适的方法。这是我的解决方案：

```
App.MyView = Ember.View.extend({
   didInsertElement: function() {
      this.set('stub', Ember.Object.create({
        itemBinding: "App.hash."+this.get('content')}))
   }
}) 
```

然后在我的模板中，我可以执行以下操作：

```
{{#each App.itemController}}
   {{#view App.MyView contentBinding="this"}}
      {{stub.item}}
   {{/view}}
{{/each}} 
```

有一个更好的方法吗？我的抱怨是我觉得我在创造一个不必要的对象。此外，如果我希望我的视图的其他属性依赖于这个特定于实例的对象，我可以说`.property(stub.item)`哪个会起作用，尽管在声明它时，stub.item 还不存在。

我认为可能有某种方法涉及手动创建绑定，但我无法弄清楚。

谢谢！

更新：

我已经确认 Christopher Swasey 的解决方案有效。我在这个 Gist 中充实了它：

[https://gist.github.com/2606979](https://gist.github.com/2606979)

这非常有帮助，因为我了解了更多关于观察和回调的知识。虽然最后，我不确定这个解决方案有多简单。尽管如此，它至少也可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:37:49.200

您可以使存根成为计算属性：

```
hashBinding: 'App.hash',
stub: function() {
    return this.get('hash').get(this.get('content'))
}.property('hash', 'content').cacheable() 
```

更新：

```
contentWillChange: function() {
    this.removeObserver('hash.' + this.get('content'), this, 'stubDidChange');
}.observesBefore('content'),

contentDidChange: function() {
    this.addObserver('hash.' + this.get('content'), this, 'stubDidChange');
    this.stubDidChange();
}.observes('content'),

stubDidChange: function() {
    this.notifyPropertyChange('stub');
},

stub: function() {
    return this.get('hash').get(this.get('content'))
}.property().cacheable() 
```

# javascript - Javascript：同时启用 2 个文本框，单击复选框

> ID：10406775
> 
> 赞同：0
> 
> 时间：2012-05-02T02:00:26.623
> 
> 标签：javascript

我对下面的代码有疑问：

```
<input id="myCheckBox" type="checkbox" name="alamatCat" 
       onClick="apply(this.checked, 'textBox3', 'textBox4')"> OT Date
</td>
<td>
From <input  id="textBox3" type="text" name="alamat" disabled="disabled"> 
To <input id="textBox4" type="text" name="alamat" disabled="disabled"> 
```

如果单击复选框，我希望同时启用 2 个文本框。

有什么建议吗？

修订 ：

如果我有下面的js怎么办：

```
<script language="javascript">
function enableDisable(bEnable, textBoxID)
{
     document.getElementById(textBoxID).disabled = !bEnable
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:04:35.517

```
function foo(isChecked){
    document.getElementById('textBox3').disabled = isChecked ? "" : "disabled";
    document.getElementById('textBox4').disabled = isChecked ? "" : "disabled";
}

<input id="myCheckBox" type="checkbox" name="alamatCat" 
       onchange="foo(this.checked);" /> 
```

**请注意，不推荐使用内联代码。**

您可以`addEventHandler`改用：

```
document.getElementById('myCheckBox').addEventHandler('change', foo); 
```

并将 foo 更改为：

```
function `foo`(){
    var disableAttribute = this.checked ? "" : "disabled";
    document.getElementById('textBox3').disabled = disableAttribute;
    document.getElementById('textBox4').disabled = disableAttribute;
} 
```

请注意，对于`IE`< 9，您需要在[**MDN**](https://developer.mozilla.org/en/DOM/element.addEventListener)`attachEvent`上使用read more[](https://developer.mozilla.org/en/DOM/element.addEventListener)

# sdk - 为什么每次重启电脑都要重新安装 Kinect SDK

> ID：10406777
> 
> 赞同：1
> 
> 时间：2012-05-02T02:00:32.647
> 
> 标签：sdk, kinect

我目前`Kinect for Windows SDK version 1`在 Win7、VS2010、C#.NET 下工作。

Kinect 连接到我的 PC 后，演示`Microsoft Kinect for Windows SDK Sample Browser`无法正常运行。

*   *Kinect Explorer*（在**C#**中）说**Kinect 尚未准备好**（这不同于**请插入 Kinect...**如果 Kinect 未连接）。
*   *形状游戏*（在**C#**中）说**糟糕... Kinect 出了点问题**
*   *骨骼查看器*（**C++**中）可以运行，但只有深度图像可以正常运行。彩色图像的帧率小于 1！骨架视图只显示黑色背景。

这是我尝试过的：

*   如果重新安装 SDK 并且不重新启动 PC，则不会发生上述情况（这意味着一切正常）。所以...**每次我重新启动我的电脑时，我都必须重新安装 Kinect SDK ！！！**
*   在将Kinect USB 插入我的 PC 后，我检查了*资源管理器。*奇怪的是，如果重装SDK后不重启PC，Kinect有4个设备：Audio、Speech、NUI和Security。但是重启电脑后，Kinect 连接到电脑后，**安全设备将不会显示。**
*   我尝试了 2 种不同的 Kinect（一次一个）并且遇到了相同的情况。
*   使用不同的 USB 插槽没有区别。

我不知道我的电脑出了什么问题或下一步该怎么做。我唯一知道的是，我不想每次重新启动 PC 时都重新安装 Kinect SDK！那么有人会提供一些解决方案吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T17:17:47.770

刚刚遇到这个问题，终于解决了。我不小心在任务管理器中杀死了进程名称“KinectManagementService”，然后我无法再连接 Kinect。看看任务管理器有没有进程。

打开 Windows 服务，并启动服务“Kinect 管理”。就是这样！

# java - SWIGTPYE_p 数据类型 Java

> ID：10406778
> 
> 赞同：1
> 
> 时间：2012-05-02T02:00:33.470
> 
> 标签：java, c++, types, type-conversion, swig

在将 C++ 中的本机库包装到 Java 的过程中，我遇到了 SWIGTYPE_p_ 类。阅读 SWIG 文档，并按照[这里](https://stackoverflow.com/questions/8235313/how-to-use-swig-generated-c-structures-in-java-as-input-to-c-functions-via-swig)的答案，我或多或少地理解 SWIG 会在它不知道如何处理 C++ 数据类型时生成这些类。它尝试创建指向数据类型的指针，但这些 SWIGTYPE 类似乎在功能上无用。

我已放入`%include typemaps.i`.i 文件，并将类型映射用于指针，例如：

```
%apply char * {unsigned char *};
%apply float * {float *};
%apply int * {int *};
%apply int * {unsigned long *};
%apply short * {unsigned short *};
%apply byte * {byte *};
%apply long * {unsigned long long *}; 
```

我也尝试使用 float[] { float[] }。

出错的一个例子：

```
typedef union CAN_PKT_ {
   unsigned long long   all;
   float                f[2];
   unsigned long        ul[2];
   unsigned short       us[4];
   unsigned char        uc[8];
} CAN_PKT; 
```

生成具有方法 set_all、set_f 等的 CAN_PKT 类，但 set_f 接受 SWIGTYPE_p_float 作为输入，并且 SWITYPE_p_float 除了 swigCptr 和 swigCMemOwn 之外没有其他内容。

我想我没有正确地键入 float[]，但我真的不明白应该怎么做，为什么？

**编辑：**`short`这个联合是唯一使用数据类型的地方。我可以通过在 .i 文件中忽略此文件运行 swig 来显示这一点，SWIGTYPE_p_unsigned_short 没有创建。但是，如果我注释掉联合的内容，以便`unsigned short`根本不在任何地方使用，并将这个文件包含到 swig 中，它仍然会创建 SWIGTYPE_p_unsigned_short。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:16:42.683

SWIG 已将您的数组类型包装为指针，但它无法在高级语言中非常有意义地公开指针的概念，因此它被包装为不透明类型。

如果您想使用数组，那么您可以通过执行以下操作来使用[SWIG 对 Java 数组的支持](http://www.swig.org/Doc1.3/Java.html#c_arrays)：

```
%module test

%include "arrays_java.i"

typedef union CAN_PKT_ {
   unsigned long long   all;
   float                f[2];
   unsigned long        ul[2];
   unsigned short       us[4];
   unsigned char        uc[8];
} CAN_PKT; 
```

这会生成您希望的代码。（与其他一些包装数组的方法相比，这很有效，因为数组的大小在编译时是固定的）

# javascript - 模拟 touchstart 和 touchend 事件？

> ID：10406783
> 
> 赞同：12
> 
> 时间：2012-05-02T02:00:52.407
> 
> 标签：javascript, jquery, touch, touch-event

我正在开发一个主要用于 ipad 的 jquery 组件。那么无论如何要在桌面上模拟“touchstart”和“touchend”事件，而不是让设备本身来检查事件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T02:23:49.167

您可以在 jQuery 中编写自己的自定义事件：

```
var event = $.Event( "touchstart", { pageX:200, pageY:200 } ); 
```

您可以针对 DOM 中的任何元素发出它们：

```
$("body").trigger( event ); 
```

演示： http: [//jsbin.com/ezoxed/edit#javascript,html](http://jsbin.com/ezoxed/edit#javascript,html)
进一步阅读：[http ://api.jquery.com/category/events/event-object/](http://api.jquery.com/category/events/event-object/)

请记住，现在市场上有各种其他类型的接口不支持`touchstart`和`touchend`事件。例如，Windows 8 已经在移动市场上占领了平板电脑，它使用了由指针组成的更抽象的事件模型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-09T21:35:37.333

Chrome 浏览器中的 Chrome 开发工具允许您模拟触摸事件。请参阅[https://developers.google.com/chrome-developer-tools/docs/mobile-emulation](https://developers.google.com/chrome-developer-tools/docs/mobile-emulation)。

从文档...

> 模拟触摸事件
> 
> 触摸是一种很难在桌面上测试的输入法，因为大多数桌面没有触摸输入。必须在移动设备上进行测试会延长您的开发周期，因为您所做的每一项更改都需要推送到服务器然后加载到设备上。
> 
> 解决此问题的方法是在您的开发机器上模拟触摸事件。对于单点触控，Chrome DevTools 支持单点触控事件模拟，以便更轻松地在桌面上调试移动应用程序。

要从 Chrome 浏览器（从版本 29.0.1547.65 开始）使用：

1.  选择浏览器窗口右上角的 Chrome 菜单（三行堆叠）。
2.  选择工具 > 开发人员工具。（快捷键 Shift+Control+I）
    底部会出现一个工具窗口，其中选择了控制台选项卡。
3.  在右下角单击设置齿轮（看起来像一个齿轮）。
    将出现一个设置面板，顶部显示“常规”。
4.  单击左侧的“覆盖”以选择覆盖面板。
5.  向下滚动并选中“启用触摸事件”
6.  重新加载您的页面

您的鼠标现在将显示为一个模糊的圆圈。点击“触摸”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-22T09:36:33.133

截至 2018 年，Chrome DevTools 完全支持设备模拟，无需任何覆盖设置。只需切换设备工具栏 (Ctrl + Shift + M) 使浏览器进入移动模式，然后鼠标即可触发触摸事件。

# java - eclipse 项目属性

> ID：10406784
> 
> 赞同：1
> 
> 时间：2012-05-02T02:00:56.723
> 
> 标签：java, eclipse

我正在`IResource`通过. 在这种情况下，属性值保存在文件夹中。这不是很好，因为财产与文件断开了连接。`IProject``IResource.setPersistenceProeprty``.metadata``.project`

如何将项目属性保存在`.project`文件中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T06:17:31.147

一个常见的解决方案是使用[项目范围内的首选项](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/guide/resInt_preferences.htm)，这些首选项存储*在项目内的文件中*（在*<project>/.settings*文件夹中）。

```
ProjectScope ps = new ProjectScope(projectResource);
IEclipsePreferences prefs = ps.getNode("my.plugin.id");
prefs.put("key", "value");
prefs.flush(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T04:47:33.547

eclipse .project 内容通过 IProjectDescription 接口公开。

```
IProjectDescription description = IProject.getDescription() 
```

请阅读：-

[http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Fguide%2FresInt_filesystem.htm](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Fguide%2FresInt_filesystem.htm)

[http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIProject.html](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIProject.html)

[http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIProjectDescription.html](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIProjectDescription.html)

# c# - RichTextBox 帮助保存*自定义*链接

> ID：10406786
> 
> 赞同：0
> 
> 时间：2012-05-02T02:01:24.077
> 
> 标签：c#, hyperlink, richtextbox, customization

我已经使用[此处](http://www.codeproject.com/Articles/9196/Links-with-arbitrary-text-in-a-RichTextBox)找到的 CodeProject 在我的 rtb 中实现了任意链接。链接不是真正的链接，而是单击时查找的数据并返回有关单击的项目的扩展信息。

这一切都很好。问题是当我尝试使用 RichTextBox1.Rtf 方法将数据保存到数据库时，链接会丢失。我最终得到了文本的值，但是 Rtf 中没有保存链接数据。是否没有超链接的 Rtf 代码？没有办法解决这个问题吗？

我正在考虑将我的方法调整为更符合[这个问题](https://stackoverflow.com/questions/2567618/custom-links-in-richtextbox)的方法，但如果我能找到一种方法来保存我的自定义超链接，我不想改变一切。

任何建议都会很棒！

- - - - - - - -更新 - - - - - - - -

在提交之前，我做了更多的挖掘和挖掘[这篇博客文章](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/313fdc5e-de8f-4de2-a4cf-44e838795384)，其中讨论了 RTB 不保存超链接，所以我想我是 SOL。解决这个问题的唯一方法是保存隐藏文本框中的文本并将该版本保存到数据库，但这种方式会变得笨拙。我想我会选择我找到的[第二个选项](https://stackoverflow.com/questions/2567618/custom-links-in-richtextbox)，我想我还是会发布这个，因为 StackOverflow 中的数据在这个主题上似乎很渺茫。现在我知道为什么了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-01T14:30:56.017

**由于这是一个旧线程，我将其发布仅供参考：**

[这是在CodeProject](http://www.codeproject.com/Articles/9196/Links-with-arbitrary-text-in-a-RichTextBox)上同一篇文章的[评论](http://www.codeproject.com/Articles/9196/Links-with-arbitrary-text-in-a-RichTextBox?msg=4855954#xx4855954xx)中找到的（有点）最近的解决方案：

代码：

```
/// <summary>
/// This additional code block checks the locations of links
/// and desc. it via a string which contains informations of how many links are there
/// .Split('&')-1 and the select information .Select(.Split('&')[i].Split('-')[0],.Split('&')[i].Split('-')[1])
/// After we select the links we can SetSelectionLink(true) to get our links back.
/// </summary>
public string getLinkPositions()
{
string pos = "";
for (int i = 0; i < this.TextLength; i++)
{
this.Select(i, 1);
int isLink = GetSelectionLink();
if (isLink == 1)
{
//the selected first character is a part of link, now find its last character
for (int j = i + 1; j <= this.TextLength; j++)
{
this.Select(j, 1);
isLink = GetSelectionLink();
if (isLink != 1 || j == this.TextLength)
{
//we found the last character's +1 so end char is (j-1), start char is (i)
pos += (i) + "-" + ((j - 1) - (i - 1)) + "&"; //j-1 to i but i inserted -1 one more so we can determine the right pos
i = j; //cont. from j+1
break; //exit second for cont. from i = j+1 (i will increase on new i value)
}
}
}
}
this.DeselectAll();
return pos;
}
/// <summary>
/// This method generates the links back only created via InsertLink(string text)
/// and overloaded InsertLink(string text,int position)
/// </summary>
/// <param name="pos">the pos string from getLinkPositions</param>
public void setLinkPositions(string pos)
{
string[] positions = pos.Split('&');
for (int i = 0; i < positions.Length - 1; i++)
{
string[] xy = positions[i].Split('-');
this.Select(Int32.Parse(xy[0]), Int32.Parse(xy[1]));
this.SetSelectionLink(true);
this.Select(Int32.Parse(xy[0]) + Int32.Parse(xy[1]), 0);
}
this.DeselectAll();
} 
```

如何使用代码[原文]：

> 当你要保存 rtf 时，将 getLinkPositions() 的返回字符串保存到，当你想加载 rtf 时，只需按照你的方式加载它，然后使用第一种方法的返回字符串来获取链接 bak
> 
> 前任 ：
> 
> 节省：
> 
> > 一些保存 var = richtext.rtf
> > 
> > 附加保存值 =richtext.getLinkPositions();
> 
> 加载回
> 
> > richtext.rtf = 一些流获取 rtf
> > 
> > richtext.setLinkPositions（来自某个流的额外保存值）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T00:26:23.510

总而言之，富文本框不会在 .Rtf 字段（也不是文本）中保存超链接。显示的值被保存，但不是实际的链接。似乎对 RTB 的恕我直言的限制很差。

有一些方法可以解决这种情况，像[这个家伙一样](https://stackoverflow.com/questions/2567618/custom-links-in-richtextbox)创建自定义链接，或者在负载搜索关键字时重新评估你的数据（我采取的路线，因为数据永远不会太大而导致冻结）。

我用来执行此操作的代码如下并在加载时调用：

```
 foreach (ListViewItem keyword in Keywords.Items)
            {
                System.Text.RegularExpressions.Regex oKeyword = new System.Text.RegularExpressions.Regex(@"\b" + keyword.Text + @"\b");

                foreach (System.Text.RegularExpressions.Match match in oKeyword.Matches(rtb.Text))
                {
                    int index = match.Index;
                    int length = match.Length;

                    rtb.Select(index, length);
                    //This next bit is made available through the use of http://www.codeproject.com/Articles/9196/Links-with-arbitrary-text-in-a-RichTextBox
                    rtb.InsertLink(match.Value);  
                }
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-23T20:40:30.437

好吧，另一个问题是，它`hyperlink`被“保存”了，但是点击事件和目标丢失了......只有格式和行为（光标更改）被恢复。如果你对这个恢复的文本块进行操作，它就会变得一团糟。因此，在进行任何“恢复”操作之前，您需要清理掉这些`<hyperlink>`东西。

Prajakta Joshi 做了一个自动检测超链接的例子——它还包含一个清理例程：http: [//blogs.msdn.com/b/prajakta/archive/2006/10/17/autp-detecting-hyperlinks-in-richtextbox-part- i.aspx](http://blogs.msdn.com/b/prajakta/archive/2006/10/17/autp-detecting-hyperlinks-in-richtextbox-part-i.aspx)

干杯，斯蒂芬

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-24T13:47:51.800

由于`Hyperlink`保存时标签不会丢失，另一种方法是扫描加载的文档以查找这些标签并重新应用它的属性——点击事件和导航 uri。

```
void restoreHyperlinks()
{
    TextRange tr = new TextRange(_richTextBox.Document.ContentStart, _richTextBox.Document.ContentEnd);
    TextPointer tp = tr.Start;
    bool bFound = false;
    foreach (System.Text.RegularExpressions.Match match in UrlRegex.Matches(tr.Text))
    {
        if (tp == null)
            tp = tr.Start;
        bFound = false;
        while (tp != null && !bFound)
        {

            if (tp.GetPointerContext(LogicalDirection.Forward) == TextPointerContext.Text)
            {
                string textRun = tp.GetTextInRun(LogicalDirection.Forward);
                int indexInRun = textRun.IndexOf(match.Value);
                if (indexInRun > -1)
                {
                    bFound = true;
                    Inline parent = tp.Parent as Inline;
                    while (parent != null && !(parent is Hyperlink))
                    {
                        parent = parent.Parent as Inline;
                    }
                    if (parent is Hyperlink)
                    {
                        Hyperlink hyperlink = (Hyperlink)parent;
                        if (isHyperlink(match.Value))
                        {
                            Uri uri = new Uri(match.Value, UriKind.RelativeOrAbsolute);
                            if (!uri.IsAbsoluteUri)
                            {
                                uri = new Uri(@"http://" + match.Value, UriKind.Absolute);
                            }
                            if (uri != null)
                            {
                                hyperlink.NavigateUri = uri;
                                hyperlink.Click += Hyperlink_Click;
                            }
                        }
                    }
               }

            }
            tp = tp.GetNextContextPosition(LogicalDirection.Forward);
        }
    }

} 
```

正则表达式是：

```
private static readonly System.Text.RegularExpressions.Regex UrlRegex = new System.Text.RegularExpressions.Regex(@"(?#Protocol)(?:(?:ht|f)tp(?:s?)\:\/\/|~/|/)?(?#Username:Password)(?:\w+:\w+@)?(?#Subdomains)(?:(?:[-\w]+\.)+(?#TopLevel Domains)(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|travel|[a-z]{2}))(?#Port)(?::[\d]{1,5})?(?#Directories)(?:(?:(?:/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|/)+|\?|#)?(?#Query)(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&amp;(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?#Anchor)(?:#(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)?"); 
```

`isHyperlink`是另一种检查 URL 的方法 - 代码取自： http: [//marcangers.com/detect-urls-add-hyperlinks-wpf-richtextbox-automatically/](http://marcangers.com/detect-urls-add-hyperlinks-wpf-richtextbox-automatically/)

希望这可以帮助！干杯，斯蒂芬

# playframework - playframework流文件上传“通过”播放不使用他们的Blob？

> ID：10406787
> 
> 赞同：0
> 
> 时间：2012-05-02T02:01:31.803
> 
> 标签：playframework

我需要通过playframework将文件流式传输到cassandra，希望使用Astyanax，如果我给它一个输入流，它看起来支持流式传输端。我看到有人试图做多个文件（我以后可能也需要这样做），但与此同时，如何在不使用 Blob 的情况下在 playframework 1.2.4 中流式传输这样的文件？

发布多个未答复的文件 :( [使用 PlayFramework 的多个上传文件](https://stackoverflow.com/questions/8880607/multiple-upload-file-with-playframework)

有一个很好的下载示例，用于将文件流回 [http://www.playframework.org/documentation/1.2.4/asynchronous#HTTPresponsestreaming](http://www.playframework.org/documentation/1.2.4/asynchronous#HTTPresponsestreaming)

但我找不到流式上传的示例:(。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T13:11:21.190

对于 Play 1.x，我最接近的答案是查看[https://github.com/jimmyy/Plupload](https://github.com/jimmyy/Plupload)模块。它声称可以进行分块上传。对此没有明确的文档，并且它不在官方存储库中，但它可能为您提供一个良好的开端。

如果做不到这一点，Play 2.x 支持分块上传（如果您进行搜索，它将是第一个响应之一）。

# ios5 - iOS NSUserDefaults。它们在后台/前台应用程序的上下文中如何表现？

> ID：10406789
> 
> 赞同：0
> 
> 时间：2012-05-02T02:02:14.410
> 
> 标签：ios5, nsuserdefaults, multitasking

我在我的应用程序中使用 NSUserDefaults，但我不清楚 NSUserDefaults 在多任务处理方面的表现。目前，我在第一次安装和启动应用程序时从项目中的 settings.plist 文件创建我的 NSUserDefaults。连续的应用程序启动完全依赖于 NSUserDefaults。

问题：即使用户从多任务停靠栏中丢弃应用程序图标，NSUserDefaults 是否仍然存在。请注意，我**并不是**说他们已经卸载了该应用程序。刚刚从多任务处理中删除它。

谢谢，
道格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:05:54.870

NSUserDefaults 将在这种情况下持续存在，只要它们已使用 synchronize 方法进行同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:06:14.797

`NSUserDefaults`从多任务处理中删除应用程序后，数据确实会保留。

见链接

[https://stackoverflow.com/a/4771560/716216](https://stackoverflow.com/a/4771560/716216)

# c# - 数据绑定到控件时出错

> ID：10406790
> 
> 赞同：0
> 
> 时间：2012-05-02T02:02:18.840
> 
> 标签：c#, asp.net, data-binding, datasource

我无法通过此代码将我的数据源链接到我的转发器

```
protected void Page_Load(object sender, EventArgs e)
{
    //HiddenField used as a placholder
    HiddenField username = list.FindControl("username") as HiddenField;
    //list is a DataList containing all of the user names
    list.DataSource = Membership.GetAllUsers();
    list.DataBind();
    //Creates a string for each user name that is bound to the datalist
    String user = username.Value;
    //profilelist is a repeater containing all of the profile information
    //Gets the profile of every member that is bound to the DataList
    //Repeater is used to display tables of profile information for every user on
    // the site in a single webform
    profilelist.DataSource = Profile.GetProfile(user);
    profilelist.DataBind();

} 
```

我收到错误消息

```
An invalid data source is being used for profilelist. A valid data source must implement either IListSource or IEnumerable. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:24:57.310

那么它不起作用的原因是因为`Profile.GetProfile`返回`ProfileCommon`。由于错误说明您设置的类型`profilelist.Datasource`等于，必须是`IListSource`or `IEnumerable`。

我建议不要使用中继器，因为您没有要显示的实际重复数据。

**编辑**

我认为这就是你想要做的。

```
 IEnumerable<ProfileCommon> myProfileList = new IEnumerable<ProfileCommon>();

        foreach(var user in userlist)
        {
             myProfileList.Add(Profile.GetProfile(user));
        }

        profilelist.datasource = myProfileList; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:34:37.087

你做错了。正如 Etch 所说，中继器用于*列出*事物。GetProfile 不返回列表。

你最好把你的控件放在一个面板中，然后在数据绑定事件的“列表”控件中分配它们。

换句话说，这里不需要中继器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T16:45:53.397

我忘了把这个贴出来，但对于任何需要做类似事情的人来说，背后的代码都是有效的

```
protected void Page_Load(object sender, EventArgs e)
{
    List<MembershipUserCollection> usernamelist = new List<MembershipUserCollection>();
    usernamelist.Add(Membership.GetAllUsers());
    List<ProfileCommon> myProfileList = new List<ProfileCommon>();
        foreach (MembershipUser user in usernamelist[0])
        {
            string username = user.ToString();
            myProfileList.Add(Profile.GetProfile(username));
            Label emailLabel = profilelist.FindControl("EmailLabel") as Label;
        }
} 
```

目前，这显示了大约 15 个用户名，并提供了链接到这些用户各自个人资料的能力。

# javascript - 如何将 Jquery 对象从父 iframe 注入到嵌入式 iframe？

> ID：10406793
> 
> 赞同：2
> 
> 时间：2012-05-02T02:02:37.887
> 
> 标签：javascript, jquery

我在网页中嵌入了一个 iframe，我想在这个框架中注入 jquery。

我试过类似的东西：

```
frame.contentWindow.$ = window.$ 
```

虽然这可行，但 iframe 的 $ 仍然在父级的范围内运行，而不是它自己的独立副本。

有没有办法将独立的 jquery 对象注入 iframe 而无需`<script src="/path/to/jquery.js"></script>`在框架中注入 a？

**更新**

解决了。jquery.js 通过在匿名函数中接受 window 对象方便地为范围定义 jQuery：

```
function(windowObject){ .... define jquery }(window) 
```

所以我所要做的就是为这个函数命名，例如 jQuerify 并为父窗口对象调用一次，然后为子窗口对象调用它。

```
jQuerify = function(windowObject){ .... define jquery }
jQuerify(window)
jQuerify(iframe.contentWindow) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-03T23:48:17.833

解决了。jquery.js 通过在匿名函数中接受 window 对象方便地为范围定义 jQuery：

function(windowObject){ .... define jquery }(window) 所以我所要做的就是命名这个函数，例如 jQuerify 并为父窗口对象调用一次，然后为子窗口对象调用它。

```
jQuerify = function(windowObject){ .... define jquery }
jQuerify(window)
jQuerify(iframe.contentWindow) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T04:33:30.543

您可以尝试克隆 jQuery 对象：

[请参阅this answer](https://stackoverflow.com/a/6772678/111934)或[this one](https://stackoverflow.com/a/2540983/111934) on how to implement a .clone function，然后调用：

```
iframe.contentWindow.$ = window.$.clone(); 
```

或者

```
iframe.contentWindow.$ = window.$.bind({}); 
```

...取决于您选择如何克隆该功能。

# c# - 为什么 JIT 顺序会影响性能？

> ID：10406796
> 
> 赞同：34
> 
> 时间：2012-05-02T02:02:58.190
> 
> 标签：c#, .net, performance, compiler-construction, jit

为什么 .NET 4.0 中的 C# 方法的即时编译顺序会影响它们的执行速度？例如，考虑两种等效方法：

```
public static void SingleLineTest()
{
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.Start();
    int count = 0;
    for (uint i = 0; i < 1000000000; ++i) {
        count += i % 16 == 0 ? 1 : 0;
    }
    stopwatch.Stop();
    Console.WriteLine("Single-line test --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
}

public static void MultiLineTest()
{
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.Start();
    int count = 0;
    for (uint i = 0; i < 1000000000; ++i) {
        var isMultipleOf16 = i % 16 == 0;
        count += isMultipleOf16 ? 1 : 0;
    }
    stopwatch.Stop();
    Console.WriteLine("Multi-line test  --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
} 
```

唯一的区别是引入了一个局部变量，它会影响生成的汇编代码和循环性能。为什么会这样，这本身就是一个[问题](https://stackoverflow.com/questions/10369421/why-does-adding-local-variables-make-net-code-slower)。

可能更奇怪的是，在 x86（但不是 x64）上，调用方法的顺序对性能有大约 20% 的影响。调用这样的方法...

```
static void Main()
{
    SingleLineTest();
    MultiLineTest();
} 
```

...而且`SingleLineTest`速度更快。（使用 x86 Release 配置编译，确保启用“优化代码”设置，并从 VS2010 外部运行测试。）但是颠倒顺序...

```
static void Main()
{
    MultiLineTest();
    SingleLineTest();
} 
```

...并且两种方法都需要相同的时间（几乎，但不完全是，只要`MultiLineTest`以前）。`SingleLineTest`（运行此测试时，添加一些额外的调用并获取额外的样本很有用`MultiLineTest`。多少和什么顺序无关紧要，除了首先调用哪个方法。）

最后，为了证明 JIT 顺序很重要，`MultiLineTest`先离开，但强制先 JIT `SingleLineTest`...

```
static void Main()
{
    RuntimeHelpers.PrepareMethod(typeof(Program).GetMethod("SingleLineTest").MethodHandle);
    MultiLineTest();
    SingleLineTest();
} 
```

现在，`SingleLineTest`又快了。

如果在VS2010中关闭“Suppress JIT optimization on module load”，可以在里面放一个断点，`SingleLineTest`看到不管JIT顺序，循环中的汇编代码都是一样的；但是，方法开头的汇编代码会有所不同。但是，当大部分时间都花在循环中时，这有多重要是令人困惑的。

[演示此行为](https://github.com/breyed/PerfTest)的示例项目在 github 上。

目前尚不清楚这种行为如何影响实际应用程序。一个问题是它可能使性能调整变得不稳定，这取决于恰好首先调用方法的顺序。使用分析器很难检测到此类问题。一旦你找到了热点并优化了它们的算法，如果不进行大量猜测，就很难知道是否可以尽早通过 JITing 方法来实现额外的加速。

**更新：**另请参阅有关此问题的[Microsoft Connect 条目](https://connect.microsoft.com/VisualStudio/feedback/details/742527/jit-optimizer-does-not-perform-loop-top-alignment)。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-02T03:32:39.213

请注意，我不信任“在模块加载时抑制 JIT 优化”选项，我在没有调试的情况下生成进程，并在 JIT 运行后附加调试器。

在单行运行速度更快的版本中，这是`Main`：

```
 SingleLineTest();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  call        dword ptr ds:[0019380Ch] 
            MultiLineTest();
00000009  call        dword ptr ds:[00193818h] 
            SingleLineTest();
0000000f  call        dword ptr ds:[0019380Ch] 
            MultiLineTest();
00000015  call        dword ptr ds:[00193818h] 
            SingleLineTest();
0000001b  call        dword ptr ds:[0019380Ch] 
            MultiLineTest();
00000021  call        dword ptr ds:[00193818h] 
00000027  pop         ebp 
        }
00000028  ret 
```

请注意，`MultiLineTest`已放置在 8 字节边界和`SingleLineTest`4 字节边界上。

这是`Main`两者以相同速度运行的版本：

```
 MultiLineTest();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  call        dword ptr ds:[00153818h] 

            SingleLineTest();
00000009  call        dword ptr ds:[0015380Ch] 
            MultiLineTest();
0000000f  call        dword ptr ds:[00153818h] 
            SingleLineTest();
00000015  call        dword ptr ds:[0015380Ch] 
            MultiLineTest();
0000001b  call        dword ptr ds:[00153818h] 
            SingleLineTest();
00000021  call        dword ptr ds:[0015380Ch] 
            MultiLineTest();
00000027  call        dword ptr ds:[00153818h] 
0000002d  pop         ebp 
        }
0000002e  ret 
```

令人惊讶的是，JIT 选择的地址在最后 4 位数字中是**相同**的，尽管据称它以相反的顺序处理它们。不确定我是否相信了。

更多的挖掘是必要的。我认为有人提到循环之前的代码在两个版本中并不完全相同？要去调查。

这是“慢”版本`SingleLineTest`（我检查过，函数地址的最后一位数字没有改变）。

```
 Stopwatch stopwatch = new Stopwatch();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  push        edi 
00000004  push        esi 
00000005  push        ebx 
00000006  mov         ecx,7A5A2C68h 
0000000b  call        FFF91EA0 
00000010  mov         esi,eax 
00000012  mov         dword ptr [esi+4],0 
00000019  mov         dword ptr [esi+8],0 
00000020  mov         byte ptr [esi+14h],0 
00000024  mov         dword ptr [esi+0Ch],0 
0000002b  mov         dword ptr [esi+10h],0 
            stopwatch.Start();
00000032  cmp         byte ptr [esi+14h],0 
00000036  jne         00000047 
00000038  call        7A22B314 
0000003d  mov         dword ptr [esi+0Ch],eax 
00000040  mov         dword ptr [esi+10h],edx 
00000043  mov         byte ptr [esi+14h],1 
            int count = 0;
00000047  xor         edi,edi 
            for (uint i = 0; i < 1000000000; ++i) {
00000049  xor         edx,edx 
                count += i % 16 == 0 ? 1 : 0;
0000004b  mov         eax,edx 
0000004d  and         eax,0Fh 
00000050  test        eax,eax 
00000052  je          00000058 
00000054  xor         eax,eax 
00000056  jmp         0000005D 
00000058  mov         eax,1 
0000005d  add         edi,eax 
            for (uint i = 0; i < 1000000000; ++i) {
0000005f  inc         edx 
00000060  cmp         edx,3B9ACA00h 
00000066  jb          0000004B 
            }
            stopwatch.Stop();
00000068  mov         ecx,esi 
0000006a  call        7A23F2C0 
            Console.WriteLine("Single-line test --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
0000006f  mov         ecx,797C29B4h 
00000074  call        FFF91EA0 
00000079  mov         ecx,eax 
0000007b  mov         dword ptr [ecx+4],edi 
0000007e  mov         ebx,ecx 
00000080  mov         ecx,797BA240h 
00000085  call        FFF91EA0 
0000008a  mov         edi,eax 
0000008c  mov         ecx,esi 
0000008e  call        7A23ABE8 
00000093  push        edx 
00000094  push        eax 
00000095  push        0 
00000097  push        2710h 
0000009c  call        783247EC 
000000a1  mov         dword ptr [edi+4],eax 
000000a4  mov         dword ptr [edi+8],edx 
000000a7  mov         esi,edi 
000000a9  call        793C6F40 
000000ae  push        ebx 
000000af  push        esi 
000000b0  mov         ecx,eax 
000000b2  mov         edx,dword ptr ds:[03392034h] 
000000b8  mov         eax,dword ptr [ecx] 
000000ba  mov         eax,dword ptr [eax+3Ch] 
000000bd  call        dword ptr [eax+1Ch] 
000000c0  pop         ebx 
        }
000000c1  pop         esi 
000000c2  pop         edi 
000000c3  pop         ebp 
000000c4  ret 
```

而“快速”版本：

```
 Stopwatch stopwatch = new Stopwatch();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  push        edi 
00000004  push        esi 
00000005  push        ebx 
00000006  mov         ecx,7A5A2C68h 
0000000b  call        FFE11F70 
00000010  mov         esi,eax 
00000012  mov         ecx,esi 
00000014  call        7A1068BC 
            stopwatch.Start();
00000019  cmp         byte ptr [esi+14h],0 
0000001d  jne         0000002E 
0000001f  call        7A12B3E4 
00000024  mov         dword ptr [esi+0Ch],eax 
00000027  mov         dword ptr [esi+10h],edx 
0000002a  mov         byte ptr [esi+14h],1 
            int count = 0;
0000002e  xor         edi,edi 
            for (uint i = 0; i < 1000000000; ++i) {
00000030  xor         edx,edx 
                count += i % 16 == 0 ? 1 : 0;
00000032  mov         eax,edx 
00000034  and         eax,0Fh 
00000037  test        eax,eax 
00000039  je          0000003F 
0000003b  xor         eax,eax 
0000003d  jmp         00000044 
0000003f  mov         eax,1 
00000044  add         edi,eax 
            for (uint i = 0; i < 1000000000; ++i) {
00000046  inc         edx 
00000047  cmp         edx,3B9ACA00h 
0000004d  jb          00000032 
            }
            stopwatch.Stop();
0000004f  mov         ecx,esi 
00000051  call        7A13F390 
            Console.WriteLine("Single-line test --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
00000056  mov         ecx,797C29B4h 
0000005b  call        FFE11F70 
00000060  mov         ecx,eax 
00000062  mov         dword ptr [ecx+4],edi 
00000065  mov         ebx,ecx 
00000067  mov         ecx,797BA240h 
0000006c  call        FFE11F70 
00000071  mov         edi,eax 
00000073  mov         ecx,esi 
00000075  call        7A13ACB8 
0000007a  push        edx 
0000007b  push        eax 
0000007c  push        0 
0000007e  push        2710h 
00000083  call        782248BC 
00000088  mov         dword ptr [edi+4],eax 
0000008b  mov         dword ptr [edi+8],edx 
0000008e  mov         esi,edi 
00000090  call        792C7010 
00000095  push        ebx 
00000096  push        esi 
00000097  mov         ecx,eax 
00000099  mov         edx,dword ptr ds:[03562030h] 
0000009f  mov         eax,dword ptr [ecx] 
000000a1  mov         eax,dword ptr [eax+3Ch] 
000000a4  call        dword ptr [eax+1Ch] 
000000a7  pop         ebx 
        }
000000a8  pop         esi 
000000a9  pop         edi 
000000aa  pop         ebp 
000000ab  ret 
```

只是循环，左边快，右边慢：

```
00000030  xor         edx,edx                 00000049  xor         edx,edx 
00000032  mov         eax,edx                 0000004b  mov         eax,edx 
00000034  and         eax,0Fh                 0000004d  and         eax,0Fh 
00000037  test        eax,eax                 00000050  test        eax,eax 
00000039  je          0000003F                00000052  je          00000058 
0000003b  xor         eax,eax                 00000054  xor         eax,eax 
0000003d  jmp         00000044                00000056  jmp         0000005D 
0000003f  mov         eax,1                   00000058  mov         eax,1 
00000044  add         edi,eax                 0000005d  add         edi,eax 
00000046  inc         edx                     0000005f  inc         edx 
00000047  cmp         edx,3B9ACA00h           00000060  cmp         edx,3B9ACA00h 
0000004d  jb          00000032                00000066  jb          0000004B 
```

指令是*相同*的（作为相对跳转，机器码是相同的，即使反汇编显示不同的地址），但对齐方式不同。有三个跳跃。`je`加载常量在`1`慢速版本中对齐，而不是在快速版本中对齐，但这并不重要，因为该跳转只占用了 1/16 的时间。其他两个跳转（`jmp`在加载一个常量零并`jb`重复整个循环之后）需要数百万次，并在“快速”版本中对齐。

我认为这是确凿的证据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:39:02.363

所以为了一个明确的答案......我怀疑我们需要深入研究拆卸。

不过，我有一个猜测。的编译器`SingleLineTest()`将方程的每个结果存储在堆栈上，并根据需要弹出每个值。但是，它们`MultiLineTest()`可能正在存储值并且必须从那里访问它们。这可能会导致错过几个时钟周期。从堆栈中获取值会将其保存在寄存器中。

有趣的是，改变函数编译的顺序可能就是调整垃圾收集器的动作。因为`isMultipleOf16`是在循环中定义的，所以处理起来可能很有趣。您可能希望将定义移到循环之外，看看会发生什么变化......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T03:59:12.033

我在 i5-2410M 2,3Ghz 4GB ram 64bit Win 7 上的时间是 2400 和 2600。

这是我的输出：单优先

启动进程然后附加调试器后

```
 SingleLineTest();
            MultiLineTest();
            SingleLineTest();
            MultiLineTest();
            SingleLineTest();
            MultiLineTest();
--------------------------------
SingleLineTest()
           Stopwatch stopwatch = new Stopwatch();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  push        edi 
00000004  push        esi 
00000005  push        ebx 
00000006  mov         ecx,685D2C68h 
0000000b  call        FFD91F70 
00000010  mov         esi,eax 
00000012  mov         ecx,esi 
00000014  call        681D68BC 
            stopwatch.Start();
00000019  cmp         byte ptr [esi+14h],0 
0000001d  jne         0000002E 
0000001f  call        681FB3E4 
00000024  mov         dword ptr [esi+0Ch],eax 
00000027  mov         dword ptr [esi+10h],edx 
0000002a  mov         byte ptr [esi+14h],1 
            int count = 0;
0000002e  xor         edi,edi 
            for (int i = 0; i < 1000000000; ++i)
00000030  xor         edx,edx 
            {
                count += i % 16 == 0 ? 1 : 0;
00000032  mov         eax,edx 
00000034  and         eax,8000000Fh 
00000039  jns         00000040 
0000003b  dec         eax 
0000003c  or          eax,0FFFFFFF0h 
0000003f  inc         eax 
00000040  test        eax,eax 
00000042  je          00000048 
00000044  xor         eax,eax 
00000046  jmp         0000004D 
00000048  mov         eax,1 
0000004d  add         edi,eax 
            for (int i = 0; i < 1000000000; ++i)
0000004f  inc         edx 
00000050  cmp         edx,3B9ACA00h 
00000056  jl          00000032 
            }
            stopwatch.Stop();
00000058  mov         ecx,esi 
0000005a  call        6820F390 
            Console.WriteLine("Single-line test --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
0000005f  mov         ecx,6A8B29B4h 
00000064  call        FFD91F70 
00000069  mov         ecx,eax 
0000006b  mov         dword ptr [ecx+4],edi 
0000006e  mov         ebx,ecx 
00000070  mov         ecx,6A8AA240h 
00000075  call        FFD91F70 
0000007a  mov         edi,eax 
0000007c  mov         ecx,esi 
0000007e  call        6820ACB8 
00000083  push        edx 
00000084  push        eax 
00000085  push        0 
00000087  push        2710h 
0000008c  call        6AFF48BC 
00000091  mov         dword ptr [edi+4],eax 
00000094  mov         dword ptr [edi+8],edx 
00000097  mov         esi,edi 
00000099  call        6A457010 
0000009e  push        ebx 
0000009f  push        esi 
000000a0  mov         ecx,eax 
000000a2  mov         edx,dword ptr ds:[039F2030h] 
000000a8  mov         eax,dword ptr [ecx] 
000000aa  mov         eax,dword ptr [eax+3Ch] 
000000ad  call        dword ptr [eax+1Ch] 
000000b0  pop         ebx 
        }
000000b1  pop         esi 
000000b2  pop         edi 
000000b3  pop         ebp 
000000b4  ret 
```

多优先：

```
 MultiLineTest();

            SingleLineTest();
            MultiLineTest();
            SingleLineTest();
            MultiLineTest();
            SingleLineTest();
            MultiLineTest();
--------------------------------
SingleLineTest()
            Stopwatch stopwatch = new Stopwatch();
00000000  push        ebp 
00000001  mov         ebp,esp 
00000003  push        edi 
00000004  push        esi 
00000005  push        ebx 
00000006  mov         ecx,685D2C68h 
0000000b  call        FFF31EA0 
00000010  mov         esi,eax 
00000012  mov         dword ptr [esi+4],0 
00000019  mov         dword ptr [esi+8],0 
00000020  mov         byte ptr [esi+14h],0 
00000024  mov         dword ptr [esi+0Ch],0 
0000002b  mov         dword ptr [esi+10h],0 
            stopwatch.Start();
00000032  cmp         byte ptr [esi+14h],0 
00000036  jne         00000047 
00000038  call        682AB314 
0000003d  mov         dword ptr [esi+0Ch],eax 
00000040  mov         dword ptr [esi+10h],edx 
00000043  mov         byte ptr [esi+14h],1 
            int count = 0;
00000047  xor         edi,edi 
            for (int i = 0; i < 1000000000; ++i)
00000049  xor         edx,edx 
            {
                count += i % 16 == 0 ? 1 : 0;
0000004b  mov         eax,edx 
0000004d  and         eax,8000000Fh 
00000052  jns         00000059 
00000054  dec         eax 
00000055  or          eax,0FFFFFFF0h 
00000058  inc         eax 
00000059  test        eax,eax 
0000005b  je          00000061 
0000005d  xor         eax,eax 
0000005f  jmp         00000066 
00000061  mov         eax,1 
00000066  add         edi,eax 
            for (int i = 0; i < 1000000000; ++i)
00000068  inc         edx 
00000069  cmp         edx,3B9ACA00h 
0000006f  jl          0000004B 
            }
            stopwatch.Stop();
00000071  mov         ecx,esi 
00000073  call        682BF2C0 
            Console.WriteLine("Single-line test --> Count: {0}, Time: {1}", count, stopwatch.ElapsedMilliseconds);
00000078  mov         ecx,6A8B29B4h 
0000007d  call        FFF31EA0 
00000082  mov         ecx,eax 
00000084  mov         dword ptr [ecx+4],edi 
00000087  mov         ebx,ecx 
00000089  mov         ecx,6A8AA240h 
0000008e  call        FFF31EA0 
00000093  mov         edi,eax 
00000095  mov         ecx,esi 
00000097  call        682BABE8 
0000009c  push        edx 
0000009d  push        eax 
0000009e  push        0 
000000a0  push        2710h 
000000a5  call        6B0A47EC 
000000aa  mov         dword ptr [edi+4],eax 
000000ad  mov         dword ptr [edi+8],edx 
000000b0  mov         esi,edi 
000000b2  call        6A506F40 
000000b7  push        ebx 
000000b8  push        esi 
000000b9  mov         ecx,eax 
000000bb  mov         edx,dword ptr ds:[038E2034h] 
000000c1  mov         eax,dword ptr [ecx] 
000000c3  mov         eax,dword ptr [eax+3Ch] 
000000c6  call        dword ptr [eax+1Ch] 
000000c9  pop         ebx 
        }
000000ca  pop         esi 
000000cb  pop         edi 
000000cc  pop         ebp 
000000cd  ret 
```

# delphi - VirtualQueryEx / ReadProcessMemory

> ID：10406798
> 
> 赞同：0
> 
> 时间：2012-05-02T02:03:04.957
> 
> 标签：delphi, delphi-2010

一周前，我开始制作一个项目来扫描另一个进程的内存。首先，我想将一个 DLL 注入进程，然后访问它的内存，但由于种种困难，我开始使用 VirtualQueryEx / ReadProcessMemory API 进行此操作。我的脑海中出现了一些疑问，下面是代码：

```
var
  Form1: TForm1;
  PIDHandle: THandle;
  PID: dword;
  MemInfo: MEMORY_BASIC_INFORMATION;
  SysInfo: SYSTEM_INFO;
  PageSize, MemStart, ReceivedBytes: cardinal;
  Buff: PChar;
  IsWow64Process: TIsWow64Process;
  IsWow64: BOOL;

    while (VirtualQueryEx(PIDHandle, Pointer(MemStart), MemInfo, SizeOf(MemInfo)) > 0) do
      begin
        if ((MemInfo.State = MEM_COMMIT) and (not (MemInfo.Protect = PAGE_GUARD)
            or (MemInfo.Protect = PAGE_NOACCESS))) then
          begin
            if (0<>MemInfo.Protect and PAGE_READWRITE) then
              begin
                GetMem(Buff, MemInfo.RegionSize);
                if (ReadProcessMemory(PIDHandle, Pointer($00636ED0), Buff,
                                        MemInfo.RegionSize, ReceivedBytes)) then
                  begin
                    Memo1.Lines.Append(PAnsiChar(Buff));
                  end;
                FreeMem(Buff);
              end;
          end;
      MemStart:= MemStart + MemInfo.RegionSize;
    end;
  CloseHandle(PIDHandle);
  end; 
```

首先 - 这个while方法：

```
while (VirtualQueryEx(PIDHandle, Pointer(MemStart), MemInfo, SizeOf(MemInfo)) > 0) do
...
 MemStart:= MemStart + MemInfo.RegionSize; 
```

我在扫描所有的内存地址吗？还是只是在不阅读的情况下“跳转”地址？？！第二个也是最重要的问题 - 我正在使用记事本进行测试，我的目标是阅读那里写的一些字符串。如果我这样做：

```
 if (0<>MemInfo.Protect and PAGE_READWRITE) then
              begin
                GetMem(Buff, MemInfo.RegionSize);
                if (ReadProcessMemory(PIDHandle, Pointer($00636ED0), Buff,
                                        MemInfo.RegionSize, ReceivedBytes)) then
                  begin
                    Memo1.Lines.Append(PAnsiChar(Buff));
                  end;
                FreeMem(Buff);
              end; 
```

直接在 ReadProcessMemory 中传递地址，它可以工作并获取我的字符串的第一个字母（或第一个字节）。记住 Buff 是 PChar ......但如果我做同样的事情，但 ReadProcessMemory 是这样的：

```
if (ReadProcessMemory(PIDHandle, MemInfo.BaseAddress, Buff,
  MemInfo.RegionSize, ReceivedBytes)) then
      begin
          Memo1.Lines.Append(PAnsiChar(Buff));
      end;
   FreeMem(Buff);
   end; 
```

它在备忘录上添加了一堆中文和无效字符。如何自动扫描每个内存地址并将我的字符串写入那里？有关代码的任何问题，只要问我...等待您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:45:38.983

如果您正在寻找 dll 注入（和其他有趣的技术），也许您应该看看这里？ [https://sites.google.com/site/delphibasics/system/app/pages/search?scope=search-site&q=dll+injection](https://sites.google.com/site/delphibasics/system/app/pages/search?scope=search-site&q=dll+injection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:32:22.117

在 Buff 中分配一个额外的字符并将其初始化为零。我猜 Memo1.Lines.Append 想要一个以空结尾的字符串，垃圾字符可能是 Buff 之后发生在内存中的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T06:27:16.663

To get the first memory address do this :

```
var
sysinfo : TSystemInfo;
GetSystemInfo(sysinfo);
start : DWORD;
begin
start := DWORD(sysinfo.lpMinimumApplicationAddress);
end; 
```

You are getting garbage because an 0 occurss in the string before all memory is shown so do this use

```
var
   mybuffer : String;
begin
   SetLength(mybuffer,MemInfo.RegionSize);
   CopyMemory(@mybuffer[1],Buff,MemInfo.RegionSize);
   Memo1.Lines.Add(mybuffer);

end; 
```

# .net - 在 64 位进程中调用 DhcpGetClientInfo 失败

> ID：10406801
> 
> 赞同：3
> 
> 时间：2012-05-02T02:03:44.817
> 
> 标签：.net, 64-bit, pinvoke, 32-bit

我正在尝试在编译为 64 位的 .net 进程中调用[DhcpGetClientInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363286%28v=vs.85%29.aspx) 。

```
[DllImport(@"dhcpsapi.dll", CharSet = CharSet.Unicode, SetLastError = true)]
internal static extern UInt32 DhcpGetClientInfo(
    String ServerIpAddress,
    ref DHCP_SEARCH_INFO SearchInfo,
    out IntPtr ClientInfo); 
```

需要注意的几点

*   当进程编译为 32 位时，它可以工作。
*   返回的错误代码是 20013。根据[错误代码](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363378%28v=vs.85%29.aspx)是“访问 DHCP JET 数据库时发生错误。有关此错误的更多信息，请查看 DHCP 服务器事件日志。” 但是，服务器上的事件日志中没有任何内容。我还确保启用了所有 DHCP 特定日志，并且那里也没有出现任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:58:23.153

您的问题很可能是使用 UInt32。顺便说一句，我相信 UInt32 已被弃用（不符合 CLS）。

# ruby-on-rails - 如何自定义 validates_length_of 消息以包含属性长度？

> ID：10406804
> 
> 赞同：1
> 
> 时间：2012-05-02T02:04:33.447
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想自定义 a 上的错误消息`validates_length_of`以包含被检查属性的长度。我知道我们可以做`"%{value}"`或`"%{attribute}"`在消息中获得这些值。有没有我们可以用来获取属性长度的标志？我希望避免创建自定义验证只是为了获得漂亮的消息。此外，当验证器已经在做的时候，对一个字符串做两次计数似乎是一种浪费。

这是我想要的：

```
validates_length_of :a, :b,:c, :d, :e, :maximum => 1000, :message=>"is to long, maximum length is` %{count}, current length is %{actual length here} " 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:46:52.210

您可以使用 Proc 来获取属性

```
validates_length_of :a, maximum: 1000,
    message: proc { |p, v| "is to long, " +
                           "maximum length is #{v[:count]}, " +
                           "current length is #{v[:value].length}" } 
```

# windows - Visual C++ 可执行文件和缺少 MSVCR100d.dll

> ID：10406807
> 
> 赞同：37
> 
> 时间：2012-05-02T02:04:53.770
> 
> 标签：windows, visual-studio-2010, visual-c++, msvcrt, msvcr100.dll

我知道这已经在其他地方被问过并得到了回答，但是我遇到了 MS Visual Studio 2010 的问题。我已经开发了一个 C++ 可执行文件，但是如果我在没有 VC++ 运行时库的机器上运行 Release 版本（即 msvcr100d.dll），我得到“程序无法启动，因为您的计算机中缺少 msvcr100d.dll”错误。

这很奇怪，原因有两个：

*   为什么它试图与可再发行组件的调试版本链接？
*   我尝试应用[此修复程序](http://www.rhyous.com/2010/09/16/avoiding-the-msvcr100-dll-or-msvcr100d-dll/)，将运行时库设置设置为 /MT 而不是 /MD（多线程 DLL），但这只会使问题变得更糟（如果我手动复制 msvcr100d.dll，它会说找不到 msvcp110 .dll）。

如何将运行时库与我的可执行文件打包，以便我可以在没有安装 MS VC 2010 或可再发行组件的机器上运行它？

我知道包含 DLL 的副本被认为是一种安全风险，因为它永远不会被更新，但我的目标只是在短期内将此可执行文件发送给几个朋友。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-02T02:13:08.800

如果您在“发布”模式下编译，则绝对不需要 CRT 的调试版本。您可以说它们是 DLL 的调试版本，因为它们以`d`.

更重要的是，调试版本是*不可*再分发的，因此它不像将其与可执行文件“打包”或压缩这些 DLL 一样简单。

检查以确保您正在“发布”模式下编译应用程序的*所有*组件，并且您正在链接正确版本的 CRT 和您使用的任何其他库（例如，MFC、ATL 等）。

当然，如果尚未安装，您*将*`msvcr100.dll`需要（注意没有后缀）和其他一些。`d`指导您的朋友下载[Visual C++ 2010 Redistributable](http://www.microsoft.com/en-us/download/details.aspx?id=8328)（或[x64](http://www.microsoft.com/en-us/download/details.aspx?id=13523)），或通过构建安装程序自动将其包含在您的应用程序中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-20T10:02:52.663

对我来说，问题出现在这种情况下：

我安装了 VS2012，不再需要 VS2010。我想清理我的计算机并删除 VS2010 运行时可执行文件，认为没有其他程序会使用它。然后我想通过将我的 DLL 附加到一个程序（我们称之为程序 X）来测试我的 DLL。我得到了同样的错误信息。我以为我在编译 DLL 时做错了什么。然而，真正的问题是我将 DLL 附加到程序 X，而程序 X 是在 VS2010 中使用调试信息编译的。这就是引发错误的原因。我在VS2012中重新编译了程序X，错误消失了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-28T13:04:21.467

这个问题在[MSDN Library](https://msdn.microsoft.com/en-us/library/vstudio/abx4dbyh%28v=vs.100%29.aspx)中有解释，据我了解，安装 Microsoft 的 Redistributable Package 会有所帮助。

但有时可以使用以下解决方案（作为开发人员的解决方案）：

在您的 Visual Studio 中，打开选项`Project properties -> Configuration properties -> C/C++ -> Code generation` 并将其更改`Runtime Library`为`/MT``/MD`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-10T17:24:49.737

通常，缺少 .dll 的应用程序会指示您需要的版本——如果一个不工作，只需从此链接下载 Microsoft Visual C++ 2010 x86 或 x64：

对于 32 位操作系统：[这里](http://www.microsoft.com/download/en/details.aspx?id=5555)

对于 64 位操作系统：[这里](http://www.microsoft.com/download/en/details.aspx?id=14632)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-23T20:34:31.837

我得到了同样的错误。

我在 VS2012 项目中引用了 VS2010 DLL。

刚刚在VS2012上重新编译了DLL，现在一切都很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-10T13:50:08.303

vc++ 库 dll 的调试版本并不意味着重新分发！

> 应用程序的调试版本不可再分发，Visual C++ 库 DLL 的调试版本不可再分发。您只能将调试版本的应用程序和 Visual C++ DLL 部署到您的其他计算机，其唯一目的是在未安装 Visual Studio 的计算机上调试和测试应用程序。有关详细信息，请参阅重新分发 Visual C++ 文件。

我也会提供链接：http: [//msdn.microsoft.com/en-us/library/aa985618.aspx](http://msdn.microsoft.com/en-us/library/aa985618.aspx)

# git - 除了 Git 本身之外，任何实现 Git 协议的服务器？

> ID：10406809
> 
> 赞同：1
> 
> 时间：2012-05-02T02:05:31.960
> 
> 标签：git

我有一个[内容存储服务器软件](http://www.alfresco.com/)，客户端可以使用他们最喜欢的协议列出/读取/编辑他们的文件：FTP/WebDAV/CIFS/...

我想知道实现 Git 接口是否有意义（我将实现 Git 协议的服务器端，Git 客户端将连接到它）。

问题：有没有实现 Git 协议的服务器端软件？（除了[Torvalds 开发的 Git 服务器](http://git-scm.com/download)）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:53:17.517

你几乎肯定不想自己实现一个 git 服务器。Git 的设计不适合 lib 化，因此一直存在的问题是 git 的一流库版本不可用。

尽管如此，还是有很多选择，取决于您的需求：

1.  [libgit2](http://libgit2.github.com/)，关于真正的 C git 库的最新工作，以及它与其他语言的各种绑定
2.  [GitPython](https://github.com/gitpython-developers/GitPython)以及用于 Python 和其他语言的类似库，它们包装了 git 可执行文件本身
3.  [jgit](http://eclipse.org/jgit/) , git 的原生 Java 实现

如果你想做的是为你的内容提供一个透明的类似 git 的界面，你需要仔细考虑这意味着什么以及你想要提供什么。Git 是一个 DVCS，因此它保留了所有事物的全部历史。这意味着您必须保留并提供整个历史记录，以便人们对您的存储库做任何有用的事情。因此，如果您只是尝试为一次性视图导出数据，那么这没有多大意义。我认为只有当您实际上将所有后端数据存储在 git 中的版本控制之下时，这种方法才最有意义。

最后，请注意，本身没有“git 服务器”。Git 利用现有的传输方式，如 ssh、http 等，可以发送简单的 git 命令来发送和检索数据。

# sql - SQL*Plus 不执行 SQL Developer 执行的 SQL 脚本

> ID：10406810
> 
> 赞同：11
> 
> 时间：2012-05-02T02:05:36.933
> 
> 标签：sql, oracle, oracle11g, sqlplus, oracle-sqldeveloper

我面临一个非常烦人的问题。我已经（在 Notepad++ 中）编写了一些 SQL 脚本。现在，当我尝试通过 SQL*Plus（在 Windows 7 上通过命令行）执行它们时，我收到了类似`ORA-00933: SQL command not properly ended`.

然后我将脚本复制并粘贴到 SQL Developer 工作表窗口中，点击运行按钮，脚本执行时没有任何问题/错误。

经过长时间的调查，我开始认为 SQL*Plus 存在一些它不理解的空格（包括换行符和制表符）的问题。

因为我假设 SQL Developer 知道如何摆脱奇怪的空格，所以我尝试了以下方法：将脚本粘贴到 SQL Developer 工作表窗口中，然后从那里复制并粘贴回 SQL 脚本中。这解决了某些文件的问题，但不是所有文件。某些文件无缘无故地在某些地方不断显示错误。

你有过这个问题吗？我应该怎么做才能通过命令行通过 SQL*Plus 运行这些脚本？

**更新：**

一个不能与 SQL*Plus 一起使用但可以与 SQL Developer 一起使用的脚本示例：

```
SET ECHO ON;

INSERT INTO MYDB.BOOK_TYPE (
    BOOK_TYPE_ID, UNIQUE_NAME, DESCRIPTION, VERSION, IS_ACTIVE, DATE_CREATED, DATE_MODIFIED
)
SELECT MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, 'Book-Type-' || MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, 'Description-' || MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, A.VERSION, B.IS_ACTIVE, SYSDATE, SYSDATE FROM

    (SELECT (LEVEL-1)+0 VERSION FROM DUAL CONNECT BY LEVEL<=10) A,
    (SELECT (LEVEL-1)+0 IS_ACTIVE FROM DUAL CONNECT BY LEVEL<=2) B

; 
```

我得到的错误：

```
SQL> SQL> SET ECHO ON;
SQL>
SQL> INSERT INTO MYDB.BOOK_TYPE (
  2      BOOK_TYPE_ID, UNIQUE_NAME, DESCRIPTION, VERSION, IS_ACTIVE, DATE_CREATED, DATE_MODIFIED
  3  )
  4  SELECT MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, 'Book-Type-' || MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, 'Description-' || MYDB.SEQ_BOOK_TYPE_ID.NEXTVAL, A.VERSION, B.IS_ACTIVE, SYSDATE, SYSDATE FROM
  5  
SQL>         (SELECT (LEVEL-1)+0 VERSION FROM DUAL CONNECT BY LEVEL<=10) A,
  2          (SELECT (LEVEL-1)+0 IS_ACTIVE FROM DUAL CONNECT BY LEVEL<=2) B
  3  
SQL> ;
  1     (SELECT (LEVEL-1)+0 VERSION FROM DUAL CONNECT BY LEVEL<=10) A,
  2*    (SELECT (LEVEL-1)+0 IS_ACTIVE FROM DUAL CONNECT BY LEVEL<=2) B 
```

如您所见，错误已打开`(SELECT (LEVEL-1)+0 IS_ACTIVE FROM DUAL CONNECT BY LEVEL<=2) B`（由于某种原因，在所有出现此错误的文件中，错误出现在最后一行结束分号之前。）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-02T05:17:46.363

删除空行。
在 sqlplus 中，空行意味着停止前一个语句并开始一个新语句。

或者您可以设置空行：

```
set sqlbl on 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-14T00:38:14.803

或者，您可以在 sqldeveloper 中使用“Ctrl F7”来格式化您的脚本。我有一个类似的问题，并尝试删除空白等，但我显然错过了一些东西。找到 Ctrl F7 功能并且脚本有效。

# web-services - 无法使用 Grails 和 CXF 插件创建 Web 服务 bean

> ID：10406814
> 
> 赞同：1
> 
> 时间：2012-05-02T02:06:11.470
> 
> 标签：web-services, grails, groovy, cxf

我正在尝试使用 Grails 和 Apache CXF 创建一个 Web 服务，自然而然地使用 CXF-Grails 插件。我创建了一个名为 Test Service 的简单服务

```
package testcxf

class TestService {

    static expose = ['cxf']

    String echoString(String str) {
        return str
    }

    String reverseString(String str) {
        return str.reverse()
    }
} 
```

该服务完全按预期工作，并且测试客户端成功调用了 echo 和 reverse 方法。接下来我创建了一个名为 Person 的简单域类

```
package testcxf

class Person {

    String name
    String city
    int age

    static constraints = {
    }
} 
```

并用一些基本功能修改了服务以与域交互。

```
package testcxf

class TestService {

    static expose = ['cxf']

    String echoString(String str) {
        return str
    }

    String reverseString(String str) {
        return str.reverse()
    }

    void addPerson(Person person) {
        person.save()
    }

    Person getPerson(String name) {
        return Person.findByName(name)
    }

    List<Person> getAllPeople() {
        return Person.findAll()
    }
} 
```

就在那时，一切都崩溃了。调用 grails run-app 时，我收到以下异常。应用程序确实完成了启动，但生成的 wsdl 不完整，并且缺少复杂类型 Person 的所有定义。

```
| Error 2012-05-01 20:51:03,504 [pool-7-thread-1] ERROR [localhost].[/TestCxf]  - StandardWrapper.Throwable
Message: Error creating bean with name 'testServiceBean': Instantiation of bean failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Factory method [public org.apache.cxf.endpoint.Server org.apache.cxf.frontend.ServerFactoryBean.create()] threw exception; nested exception is org.apache.cxf.service.factory.ServiceConstructionException
    Line | Method
->>  578 | createApplicationContext in grails.spring.BeanBuilder
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|     57 | loadAdditionalConfig     in org.grails.cxf.GrailsCXFServlet
|     40 | init . . . . . . . . . . in     ''
|    334 | innerRun                 in java.util.concurrent.FutureTask$Sync
|    166 | run . . . . . . . . . .  in java.util.concurrent.FutureTask
|   1110 | runWorker                in java.util.concurrent.ThreadPoolExecutor
|    603 | run . . . . . . . . . .  in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run                      in java.lang.Thread

Caused by BeanDefinitionStoreException: Factory method [public org.apache.cxf.endpoint.Server org.apache.cxf.frontend.ServerFactoryBean.create()] threw exception; nested exception is org.apache.cxf.service.factory.ServiceConstructionException
->>  578 | createApplicationContext in grails.spring.BeanBuilder
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|     57 | loadAdditionalConfig     in org.grails.cxf.GrailsCXFServlet
|     40 | init . . . . . . . . . . in     ''
|    334 | innerRun                 in java.util.concurrent.FutureTask$Sync
|    166 | run . . . . . . . . . .  in java.util.concurrent.FutureTask
|   1110 | runWorker                in java.util.concurrent.ThreadPoolExecutor
|    603 | run . . . . . . . . . .  in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run                      in java.lang.Thread

Caused by ServiceConstructionException: null
->>  341 | initialize               in org.apache.cxf.jaxb.JAXBDataBinding
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|     86 | initializeDataBindings   in org.apache.cxf.service.factory.AbstractServiceFactoryBean
|    442 | buildServiceFromClass .  in org.apache.cxf.service.factory.ReflectionServiceFactoryBean
|    505 | initializeServiceModel   in     ''
|    242 | create . . . . . . . . . in     ''
|    101 | createEndpoint           in org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory
|    148 | create . . . . . . . . . in org.apache.cxf.frontend.ServerFactoryBean
|    578 | createApplicationContext in grails.spring.BeanBuilder
|     57 | loadAdditionalConfig . . in org.grails.cxf.GrailsCXFServlet
|     40 | init                     in     ''
|    334 | innerRun . . . . . . . . in java.util.concurrent.FutureTask$Sync
|    166 | run                      in java.util.concurrent.FutureTask
|   1110 | runWorker . . . . . . .  in java.util.concurrent.ThreadPoolExecutor
|    603 | run                      in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . . . . . . . .  in java.lang.Thread

Caused by IllegalAnnotationsException: 5 counts of IllegalAnnotationExceptions
->>  102 | check                    in com.sun.xml.bind.v2.runtime.IllegalAnnotationsException$Builder
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    472 | getTypeInfoSet           in com.sun.xml.bind.v2.runtime.JAXBContextImpl
|    302 | <init> . . . . . . . . . in     ''
|   1140 | build                    in com.sun.xml.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder
|    154 | createContext . . . . .  in com.sun.xml.bind.v2.ContextFactory
|    121 | createContext            in     ''
|    248 | newInstance . . . . . .  in javax.xml.bind.ContextFinder
|    235 | newInstance              in     ''
|    432 | find . . . . . . . . . . in     ''
|    637 | newInstance              in javax.xml.bind.JAXBContext
|    564 | createContext . . . . .  in org.apache.cxf.jaxb.JAXBDataBinding
|    504 | createJAXBContextAndSchemas in     ''
|    324 | initialize . . . . . . . in     ''
|     86 | initializeDataBindings   in org.apache.cxf.service.factory.AbstractServiceFactoryBean
|    442 | buildServiceFromClass .  in org.apache.cxf.service.factory.ReflectionServiceFactoryBean
|    505 | initializeServiceModel   in     ''
|    242 | create . . . . . . . . . in     ''
|    101 | createEndpoint           in org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory
|    148 | create . . . . . . . . . in org.apache.cxf.frontend.ServerFactoryBean
|    578 | createApplicationContext in grails.spring.BeanBuilder
|     57 | loadAdditionalConfig . . in org.grails.cxf.GrailsCXFServlet
|     40 | init                     in     ''
|    334 | innerRun . . . . . . . . in java.util.concurrent.FutureTask$Sync
|    166 | run                      in java.util.concurrent.FutureTask
|   1110 | runWorker . . . . . . .  in java.util.concurrent.ThreadPoolExecutor
|    603 | run                      in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . . . . . . . .  in java.lang.Thread
| Error 2012-05-01 20:51:03,570 [pool-7-thread-1] ERROR [localhost].[/TestCxf]  - Servlet /TestCxf threw load() exception
Message: 5 counts of IllegalAnnotationExceptions
    Line | Method
->>  102 | check                       in com.sun.xml.bind.v2.runtime.IllegalAnnotationsException$Builder
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    472 | getTypeInfoSet              in com.sun.xml.bind.v2.runtime.JAXBContextImpl
|    302 | <init> . . . . . . . . . .  in     ''
|   1140 | build                       in com.sun.xml.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder
|    154 | createContext . . . . . . . in com.sun.xml.bind.v2.ContextFactory
|    121 | createContext               in     ''
|    248 | newInstance . . . . . . . . in javax.xml.bind.ContextFinder
|    235 | newInstance                 in     ''
|    432 | find . . . . . . . . . . .  in     ''
|    637 | newInstance                 in javax.xml.bind.JAXBContext
|    564 | createContext . . . . . . . in org.apache.cxf.jaxb.JAXBDataBinding
|    504 | createJAXBContextAndSchemas in     ''
|    324 | initialize . . . . . . . .  in     ''
|     86 | initializeDataBindings      in org.apache.cxf.service.factory.AbstractServiceFactoryBean
|    442 | buildServiceFromClass . . . in org.apache.cxf.service.factory.ReflectionServiceFactoryBean
|    505 | initializeServiceModel      in     ''
|    242 | create . . . . . . . . . .  in     ''
|    101 | createEndpoint              in org.apache.cxf.frontend.AbstractWSDLBasedEndpointFactory
|    148 | create . . . . . . . . . .  in org.apache.cxf.frontend.ServerFactoryBean
|    578 | createApplicationContext    in grails.spring.BeanBuilder
|     57 | loadAdditionalConfig . . .  in org.grails.cxf.GrailsCXFServlet
|     40 | init                        in     ''
|    334 | innerRun . . . . . . . . .  in java.util.concurrent.FutureTask$Sync
|    166 | run                         in java.util.concurrent.FutureTask
|   1110 | runWorker . . . . . . . . . in java.util.concurrent.ThreadPoolExecutor
|    603 | run                         in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . . . . . . . . . . in java.lang.Thread 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T03:59:23.600

查看 cxf 插件信息页面，我发现了这个：

```
 Note that any classes being returned or passed as parameters 
    must be annotated with @XmlAccessorType(XmlAccessType.FIELD)

    @XmlAccessorType(XmlAccessType.FIELD)
    class Person {
       ....
    } 
```

----- EDIT----- 这个让我很困扰，因为它应该很简单。我不知道你是否让它工作，但这是我必须做的：

```
 package testcxf
    import javax.xml.bind.annotation.*

    @XmlRootElement(name="person")
    @XmlAccessorType(XmlAccessType.NONE)
    @XmlType(propOrder = ["name","city","age"])

    class Person {
        @XmlElement
        String name

        @XmlElement
        String city

        @XmlElement
        int age

        static constraints = {
        }
    } 
```

除了 NONE 之外，它会抛出与任何 XmlAccessorType 相同的错误。然后为了获得可用的字段，我必须添加 @XmlElement 注释。

现在它运行没有错误，并且 WSDL 包含 Person 对象的详细信息：

```
 <xs:element name="person" type="tns:person"/>
    <xs:complexType name="person">
      <xs:sequence>
        <xs:element minOccurs="0" name="name" type="xs:string"/>
        <xs:element minOccurs="0" name="city" type="xs:string"/>
        <xs:element name="age" type="xs:int"/>
      </xs:sequence>
    </xs:complexType> 
```

# java - Java 文件 IO + 相对路径 + NetBeans

> ID：10406821
> 
> 赞同：0
> 
> 时间：2012-05-02T02:07:04.473
> 
> 标签：java, netbeans, file-io

很简单：

```
File account = new File("./data/account");
account.createNewFile(); 
```

给我：

```
java.io.IOException: No such file or directory
  at java.io.UnixFileSystem.createFileExclusively(Native Method)
  at java.io.File.createNewFile(File.java:900)
  ... 
```

为什么 file.createNewFile() 会给我一个`IOException`消息`No such file or directory`？我告诉它创建文件。

在 NetBeans 之外运行这段代码似乎没有问题，NetBeans 不能处理相对文件链接吗？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:15:36.583

如果`./data`不存在，则该调用将失败。

```
File f = new File("./data/account");
if(!f.getParentFile().exists()) { // if the directories don't exist
    if(!f.getParentFile().mkdirs()) { // if making the directories fails
        // directories weren't created, throw exception or something
    }
}
f.createNewFile(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:11:07.133

`dist`Netbeans 正在从该文件夹运行 java 程序。您需要在`data`其中创建文件夹。但是，我相信在某些情况下，Netbeans 会清除整个文件夹并因此将其删除。我会使用绝对路径。

# drupal - 如何为 Drupal 中的数字字段创建增量视图过滤器？

> ID：10406823
> 
> 赞同：0
> 
> 时间：2012-05-02T02:07:14.043
> 
> 标签：drupal, filter, drupal-7, drupal-views

在我的 Drupal 7 中，我正在构建一个带有“最低租金”和“最高租金”过滤器的房屋/物业视图 - 这样人们就可以根据他们的预算找到房屋。

租金（每月）基本上是一个整数字段，可以是任何数字（475 英镑或 677 英镑或其他）。但在我暴露的“最低租金”和“最高租金”过滤器中，我希望它是一个 100 英镑、200 英镑、300 英镑、400 英镑、500 英镑等的下拉列表 - 递增。正如我们在 www.rightmove.co.uk 或 www.zoopla.com 等网站或任何其他房产列表网站上看到的那样。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T15:43:11.143

不要以为没有自定义编码就可以做到这一点。我会这样做：

*   改变暴露的形式
*   添加一个带有增量值的新下拉列表：100、200 等。
*   在页面上，隐藏 Min Rent 和 Max Rent（来自 css）。
*   使用 javascript 代码将您的下拉菜单与 MinRent 和 MaxRent 同步。For example, when 100 is selected, set MinRent=100 and MaxRent=199.

当用户从 DropDown 中选择一个值并提交时，视图将获取 100-199 的值并相应地过滤结果。

# php - 如何在过滤器上仅指定一个选项，例如 FILTER_INT

> ID：10406824
> 
> 赞同：0
> 
> 时间：2012-05-02T02:07:14.637
> 
> 标签：php, filter, options

我已经看到了数万亿（好吧，也许不是数万亿，但肯定是数十亿）使用各种 PHP 过滤器和一系列选项的示例，但我没有看到您如何只指定一个选项。

例如：

在[http://www.w3schools.com/php/filter_validate_int.asp](http://www.w3schools.com/php/filter_validate_int.asp)的页面上它说：

> 注意：在数组中指定选项时。选项必须位于名为“options”的关联多维数组中。请参阅下面的示例示例
> 
> ?php $var=300;
> 
> $int_options = array("options"=> array("min_range"=>0, "max_range"=>256));
> 
> var_dump(filter_var($var, FILTER_VALIDATE_INT, $int_options)); ?>

在[http://www.w3schools.com/php/func_filter_var.asp](http://www.w3schools.com/php/func_filter_var.asp)的页面上有：

> 选项 可选。指定标志/选项的关联数组或 **单个标志/选项**。检查每个过滤器以获取可能的选项和标志

那么 - 你如何只指定一个选项？

假设您想检查一个整数并且只指定允许的最大值。你如何编码 filter_var 选项？

```
filter_var($var, FILTER_VALIDATE_INT, ????????) 
```

你会用什么代码代替????????? 指定最大允许值？

有没有办法做到这一点，或者即使您只使用一个选项，您是否总是必须创建并传递一个关联数组？

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:09:21.270

1.  [不要将 w3schools 用于任何事情](http://w3fools.com/)
2.  使用[php.net](http://php.net)作为 PHP 参考
3.  如果你做了#1 和#2，你会看到[第三个参数是可选的，可能会被排除](http://us2.php.net/manual/en/function.filter-var.php)。如果您希望只有一个选项，那么您只需在数组中只传递一个选项：

    $int_options = array("options"=> array("max_range"=>256));

# jquery - 我无法让 jQuery-UI 的自动完成功能显示返回的项目

> ID：10406826
> 
> 赞同：0
> 
> 时间：2012-05-02T02:07:42.123
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我无法使用 jQuery-UI 的自动完成小部件从服务器获取返回的数据以显示在我的表单上。（输入元素下方形成一个狭窄的“返回框”，但未填充）

我正在运行最新版本的 jQuery 和 jQuery-UI，并且我返回的数据是经过验证的 JSON (http://jsonlint.com/)。验证器插件（可能导致类似问题）不是我页面的一部分。

任何帮助将不胜感激。

谢谢/布鲁斯

我的js是：

```
var ac_config = {
    source: "scripts/ajax_studentroll.asp?id=do_name",
    select: function(event, ui){
        $("#s_name2").val(ui.item.sname);
    },
    minLength:2
};
$("#s_name2").autocomplete(ac_config); 
```

我的html是：

```
<form action="scripts/ajax_studentroll.asp?id=getinfo" id="getStudentInfo" method="post">
    <p>
        <label class="label20" for="s_name">Enter the user's first name or surname,</label>
        <input id="s_name2" name="s_name2" value="" type="text" />&nbsp;
        <button class="fg-button_s ui-state-default ui-corner-all" type="submit">Get!</button>
    </p>
</form> 
```

返回的 JSON 格式如下：

```
[{"sname":"David Jones"},{"sname":"David McKay"},{"sname":"David Perry"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:18:48.680

来自[精美手册](http://docs.jquery.com/UI/Autocomplete#overview)：

> **预期数据格式**
> 
> 来自本地数据、url 或回调的数据可以有两种变体：
> 
> *   字符串数组：
>     `[ "Choice1", "Choice2" ]`
> *   具有标签和值属性的对象数组：
>     `[ { label: "Choice1", value: "value1" }, ... ]`

因此，您的 JSON 不会以小部件期望的格式返回，您可能只想调整服务器以返回一个简单的匹配字符串数组：

```
["David Jones","David McKay","David Perry"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:19:18.573

小`autocomplete`部件需要一个值数组。

如果您要使用自定义数据格式（您需要这样做），则需要覆盖`_renderItem`自动完成实例上的 ，如[http://jqueryui.com/demos/autocomplete/#custom-data](http://jqueryui.com/demos/autocomplete/#custom-data)所示（单击“查看源代码”该页面上的链接并注意他们如何从输入中获取实例`.data()`并覆盖`_renderItem`）

# networking - 虚拟盒子来宾操作系统不工作

> ID：10406833
> 
> 赞同：-3
> 
> 时间：2012-05-02T02:09:40.360
> 
> 标签：networking

我有window server 2003作为虚拟机上的主机，两个window 7作为guest os我试图同时运行两个window 7但它显示错误“运行虚拟机时发生严重错误并且机器执行有停了”。我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:18:43.730

出现此错误的原因是因为您的 Ram 用完了，或者您的处理器无法跟上两台机器，而 virtualbox 有一个内置触发器来保证您的计算机安全，解决这个问题的唯一方法不是软件而是硬件

# c - 使用信号量的一些问题

> ID：10406834
> 
> 赞同：3
> 
> 时间：2012-05-02T02:09:47.480
> 
> 标签：c, synchronization, semaphore

现在我正在做我的项目，我有一个关于信号量初始化的问题。实际上我在 Mac OS X 上编程，但我试图在 Linux 上编译我的项目，但它没有编译。在 OS X 上，它可以编译，但每次都在初始化时崩溃。

```
sem_t *mutex_1, *mutex_2, *mutex_3, *reader, *writer;

int initialization_semaphores (void) 
{
    int ERROR = EOK;
    if ((mutex_1 = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, 0, 0)) == MAP_FAILED)
        ERROR = ESEM;
    if ((mutex_2 = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, 0, 0)) == MAP_FAILED)
        ERROR = ESEM;
    if ((mutex_3 = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, 0, 0)) == MAP_FAILED)
        ERROR = ESEM;
    if ((reader = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, 0, 0)) == MAP_FAILED)
        ERROR = ESEM;
    if ((writer = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_ANON | MAP_SHARED, 0, 0)) == MAP_FAILED)
        ERROR = ESEM;

    if (ERROR == EOK) {
        if (sem_init(mutex_1, 1, 1) == -1)
            ERROR = ESEM;
        if (sem_init(mutex_2, 1, 1) == -1)
            ERROR = ESEM;
        if (sem_init(mutex_3, 1, 1) == -1)
            ERROR = ESEM;
        if (sem_init(reader, 1, 1) == -1)
            ERROR = ESEM;
        if (sem_init(writer, 1, 1) == -1)
            ERROR = ESEM;
    }
} 
```

当我尝试在 linux 上编译它时，我看到了这个：

```
/tmp/ccmkN9G7.o: In function `initialization_semaphores':
readerWriter.c:(.text+0x1a2): undefined reference to `sem_init'
readerWriter.c:(.text+0x1cb): undefined reference to `sem_init'
readerWriter.c:(.text+0x1f4): undefined reference to `sem_init'
readerWriter.c:(.text+0x21d): undefined reference to `sem_init'
readerWriter.c:(.text+0x246): undefined reference to `sem_init'
readerWriter.c:(.text+0x275): undefined reference to `shm_open' 
```

这样对吗？：

```
int ERROR = EOK;
mutex_1 = sem_open("mutex1", O_CREAT, S_IRUSR | S_IWUSR, 1);   
mutex_2 = sem_open("mutex2", O_CREAT, S_IRUSR | S_IWUSR, 1);  
mutex_3 = sem_open("mutex3", O_CREAT, S_IRUSR | S_IWUSR, 1); 
reader = sem_open("reader", O_CREAT, S_IRUSR | S_IWUSR, 1); 
writer = sem_open("writer", O_CREAT, S_IRUSR | S_IWUSR, 1); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T02:14:53.807

Mac OSX 不符合标准，不支持`sem_init`. 该功能存在，但它默默地失败或更糟，留下一个不工作的信号量。

我鼓励您向 Apple 提交错误，因为这是一个严重影响应用程序可移植性的长期存在的真实问题。抱怨的人越多，解决问题的希望就越大。

至于解决它，您可以尝试查找/编写所有 POSIX 信号量函数的替代实现并将您的程序链接到该实现，或者您可以切换到 using`sem_open`而不是`mmap`and `sem_init`。

（只要您已经经历了为每个信号量映射整个页面的开销，`sem_open`实际上并不会花费您更多的成本。当您想将信号量包含在现有的`struct`.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-06T03:30:15.813

Mac OSX 上有一个解决方法。

```
#include <dispatch/dispatch.h>

typedef dispatch_semaphore_t sem_t;

void sem_init(sem_t* sem, bool is_pshared, unsigned value)
{
    *sem = dispatch_semaphore_create(value);
}

static void sem_destroy(sem_t* sem)
{
    dispatch_release(*sem);
}

static void sem_post(sem_t* sem)
{
    dispatch_semaphore_signal(*sem);
}

static void sem_wait(sem_t* sem)
{
    dispatch_semaphore_wait(*sem, DISPATCH_TIME_FOREVER);
} 
```

但是，我不知道该怎么做`sem_getvalue()`-如果有人知道，请告诉我。

# windows-phone-7 - Live Connect API - 创建子文件夹

> ID：10406836
> 
> 赞同：5
> 
> 时间：2012-05-02T02:09:52.650
> 
> 标签：windows-phone-7, onedrive

我正在尝试使用 Windows Phone 7 的 Live Connect API 创建一个子文件夹。

我已经成功创建了一个文件夹，但我也想创建一个子文件夹。我一直在看这里：http: [//msdn.microsoft.com/en-us/library/live/hh826550.aspx](http://msdn.microsoft.com/en-us/library/live/hh826550.aspx)但我一直无法找到创建子文件夹的方法。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T11:53:28.510

而不是打电话 `client.PostAsync("me/skydrive", folderData);`

调用这样的东西： `client.PostAsync(folderId, folderData);`

您可以通过调用skydrive 上的list files/directories 来获取文件夹ID。

希望能帮助到你

# java - 无法在 HTML 中使用小程序

> ID：10406837
> 
> 赞同：2
> 
> 时间：2012-05-02T02:10:18.233
> 
> 标签：java, applet, embedded-resource, japplet

我有这个代码：

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class MainApp extends JApplet implements ActionListener {
    private static final long serialVersionUID = -7076767216192554828L;
    JButton begin = new JButton(new ImageIcon("splash.png"));
    @Override
    public void init() {
        setSize(300, 300);
        setLayout(new BorderLayout());
    begin.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            begin();
        }

    });
    add(begin);
    setVisible(true);
}
private void begin() {
    remove(begin);
    repaint();
}
@Override
public void actionPerformed(ActionEvent e) {
          //to be used later
}
} 
```

在 Eclipse 的小程序查看器中查看时，它可以完美运行。但是，在 HTML 中，它失败了：

```
<html>
<head>
<title> Test </title>
<body>
<APPLET code="MainApp.class" width="300" height="300"> Applet unavailable </APPLET> <br>
<a href="essay.docx"> Essay </a> (right click, Save Target As, in the menu under the name change it to "All Files," save as "essay.docx")
</body>
</html> 
```

当我运行它时，它给出了一个`java.lang.reflect.InvocationTargetException`！我查找了异常，发现没有任何帮助。

在我使用`.png`for 按钮之前。一切都很好。我还添加了`repaint()`，但这并没有什么不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:14:04.277

小程序找不到`splash.png`文件，你把它包含在小程序Jar中了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T11:27:10.957

> 该图像位于包含 HTML 文件的文件夹中。

```
// called from somewhere in the methods (e.g. init()) of the applet class 
URL urlToImage = new URL(getDocumentBase(), "splash.png");
begin = new JButton(new ImageIcon(urlToImage));
// ... 
```

# .net - 从 .net 访问 FAST ESP 管理服务（字典和部署管理器）

> ID：10406840
> 
> 赞同：1
> 
> 时间：2012-05-02T02:11:00.177
> 
> 标签：.net, performance, fast-esp

我正在寻找一种从我的 .net 代码中访问 FAST ESP 管理服务的方法。情况是，我们在 FAST 中部署了用于自动完成、拼写检查等的词典，我们正在寻求构建一个应用层来维护和操作这些词典。

通过阅读 FAST ESP 应用程序集成指南，似乎有一个 ESP 管理服务层，应用程序可以连接它来执行诸如此类的操作。我特别希望能够连接到 Dictionary 服务和 Deployment Manager 服务。

我尝试在 baseport+3089/adminserver/dictionaryService.jws 使用 Dictionary webservice，并且该服务的合同充其量似乎非常粗略，输入参数如 in0、in1 - 不确定这些是什么意思？

有人可以就如何做到这一点提供任何指导或指示吗？

# htmlpurifier - 使用 HTMLpurifier，如何向默认白名单添加几个属性，例如“onclick”

> ID：10406841
> 
> 赞同：3
> 
> 时间：2012-05-02T02:11:00.597
> 
> 标签：htmlpurifier

两个问题：

我一直在阅读文档和 SO 帖子..并且知道如何做到这一点（自己定义每个元素和属性），但我想要做的就是在默认白名单中添加 2 或 3 个属性.. 这样我不必不断地查找和添加更多元素/属性，例如`HTML.AllowedElements`和/或`HTML.AllowedAttributes`。

具体来说，现在（对于内部受信任的用户）我需要允许 javascript 属性（来自 tinymce 的输入）。问题#1。）有没有办法只添加一个属性（HTMLpurifier 允许的）而不导致整个默认的允许元素/属性集被有效地清除（**仅**被明确写入`HTML.AllowedElements`或覆盖的内容覆盖`HTML.AllowedAttributes`）？

对于我*现在*需要的东西（javascript 属性），当我在这个线程中看到时我很兴奋：

[HTML Purifier 配置中的白名单表单](https://stackoverflow.com/questions/3189396/whitelist-forms-in-html-purifier-configuration)

... Edward Z. Yang 说：“... [ `$config->set('HTML.Trusted', true);`] 允许 JavaScript。”

...但即使在设置了 this: 之后`$config->set('HTML.Trusted', true);`，HTMLpurifier 4.4.0 仍在剥离例如任何输入`onclick="dostuff();"`属性。为什么？问题 #2.) 有没有一种快速的方法可以将 javascript 属性添加到允许列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T14:55:11.330

1.  您正在丢失 onclick，因为 HTML Purifier 不知道该属性，并且如果 HTML Purifier 在您打开 %HTML.Trusted 时通过了所有内容，那么您可能根本不使用 HTML Purifier。

2.  HTML Purifier 有针对这种情况的属性集合；'Common' 可能是插入它们的正确选择。

但为什么？%HTML.Trusted 的真实名称应该是 %HTML.UnsafeMakeMyApplicationVulnerable

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-10T09:22:59.810

HTMLPurifier 不支持任何 HTML 元素的 onClick 和类似的 java 脚本相关属性作为默认行为。因此，如果您希望以任何方式允许此类属性，您可以通过以下方式将此类属性添加到特定元素。

```
$config = HTMLPurifier_Config::createDefault();
$def = $config->maybeGetRawHTMLDefinition()
$def->addAttribute('a', 'onclick', 'Text'); 
```

但要小心，这可能会导致 xss 攻击，因为您允许任何 java 脚本代码存在于该属性中。

# windows - 如何使用脚本创建包含目录 C:\sample\ 中所有文件名的文本文件？

> ID：10406844
> 
> 赞同：0
> 
> 时间：2012-05-02T02:11:11.317
> 
> 标签：windows, batch-file

如何使用脚本创建包含目录 C:\sample\ 中所有文件名的文本文件？

我在 stackoverflow 上看到过类似的主题，但它们是在 Perl 或 VB6 中......这可能在 Windows 7 的批处理文件中实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:15:07.990

一个简单的命令就可以了：

```
dir /b c:\sample > out.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:13:46.157

`dir /s/b c:\sample\*.* > somefile.txt`可能是你正在寻找的。

# jquery - Ajax - 限制列表的加载，然后在滚动时加载其余部分

> ID：10406845
> 
> 赞同：3
> 
> 时间：2012-05-02T02:11:26.603
> 
> 标签：jquery, ajax, scroll, dynamic-loading

我有一家商店，在一个页面上显示一个类别的所有产品（这就是所有者喜欢它的方式，所以分页不是一种选择）。

为了改善某些繁重类别的加载时间，我希望实现一个脚本，该脚本将加载许多产品`<li>s`，然后在页面滚动时加载另一组产品。

页面是用这种结构生成的

```
<div id="CategoryContent">
  <ul class="ProductList">
       <li class="Odd">Product</li>
       <li class="Even">Product</li>
       <li class="Odd">Product</li>
       <li class="Even">Product</li>
  </ul> 
```

理想情况下我愿意。加载前 25 个`<li>Products</li>`，当用户滚动到底部时，加载下一个 20，直到加载整个页面。

我以前从未玩过 AJAX，所以我不确定：

*   目前的设置是可以的*   将改善加载时间*   影响这些页面的 SEO

我已经查看了一些示例和演示，例如[这个 JQUERY 示例](http://www.webresourcesdepot.com/load-content-while-scrolling-with-jquery/)- 但这需要特定的 id 等，我不确定这是否会改善页面加载？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T02:12:54.600

虽然它不能解决加载时间问题，但我为无限滚动创建了一个相当简单的 jquery 解决方案，无需插件。

```
$("#CategoryContent li").slice(20).hide(); 
```

它隐藏了列表中除前 20 个产品之外的所有产品。

```
var mincount = 20;
var maxcount = 40;

$(window).scroll(function() 
                    {
                    if($(window).scrollTop() + $(window).height() >= $(document).height() - 400) {
                            $("#CategoryContent li").slice(mincount,maxcount).fadeIn(800);

mincount = mincount+20;
maxcount = maxcount+20

}
}); 
```

Waits for the user to scroll past 400px from the bottom of the page, then fades in the next 20, and repeats until all of the products are loaded.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T02:34:06.973

这是一个称为无限滚动的概念。谷歌，你会找到你要找的。

[infinite-scroll-jquery-plugin](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)是一个 jQuery 插件，它将支持你正在尝试做的事情，还有其他的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:21:20.153

除非您在链接中找到类似的插件，否则您最有可能需要以 JSON 格式返回您的 Ajax，然后通过然后将值从那里处理到您的页面中。

我建议您阅读有关[`$.get()`](http://api.jquery.com/jQuery.get/)或的文档以[`$.getJSON()`](http://api.jquery.com/jQuery.getJSON/)获得更多帮助。您应该在此处找到有关如何解析 JSON 数据以及这些链接的示例。

如果您一次只加载 20 条记录而不是一次加载 100 条记录，它应该会缩短加载时间。

Ajax 和 SEO，人们使用某些技术来实现这一点，但我不确定它对 SEO 是否像普通的非 ajax 内容对网络蜘蛛一样积极。这是我在网上找到的关于这个主题的资源：[http ://www.searchenginejournal.com/seo-for-ajax/19138/](http://www.searchenginejournal.com/seo-for-ajax/19138/)

# vb.net - 在 VB.Net 上按索引查找数组上的值

> ID：10406846
> 
> 赞同：-1
> 
> 时间：2012-05-02T02:11:40.473
> 
> 标签：vb.net, arrays, indexing

如何通过 VB.Net 上的索引查找数组中的值？

```
// INDEX:                       0    1    2    3    4
Dim DataArray(4) as Integer = {"A", "B", "C", "D", "E"} 
```

然后，我将一个数字从 0 随机化到 4。例如，当我得到 3 时，我将`D`根据随机化数字在数组上获取值。我怎样才能做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:16:59.390

您可以通过在数组名称后面加上索引来访问该值

```
Dim letter As String = DataArray(YourRandNumber) 
```

您的数组也存在问题，DataArray 被声明为整数数组但存储字母，因此您应该将其更改为

```
Dim DataArray(5) As String = {"A", "B", "C", "D", "E"} 
```

或者

```
Dim DataArray(5) As Char= {"A"c, "B"c, "C"c, "D"c, "E"c} 
```

“A”后面的小c表示它是一个字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T16:26:57.833

我认为您的意思是，您应该有一些代码，例如（*例如以控制台样式的形式*）：

```
Randomize()
Console.writeline(DataArray(math.ceiling(Rnd() * [upperbound))) 
```

这将返回一个随机字符。

# r - 绘制固定地块区域

> ID：10406848
> 
> 赞同：0
> 
> 时间：2012-05-02T02:12:15.553
> 
> 标签：r, graphics, plot, area

我有一个简单的问题，我如何绘制固定高度的条形图，即拉伸绘图区域只会改变边距而不是条形区域，如下所示：

```
> A <- 4
> plot (A)

> barplot(A, col = "green4") 
```

![在此处输入图像描述](../Images/0e904a5a2be62b6d18bc791372e75458.png)

当我伸展时，酒吧面积也会增加。

![在此处输入图像描述](../Images/91e56d278c3e4379c1fcb2156798bf4e.png)

编辑：即使情节被拉伸，我也想保持盒子大小不变。

![在此处输入图像描述](../Images/497f4aab807e9106726e5f089dc3cc55.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:50:41.343

通过将屏幕分成多个部分，您可以部分实现：

```
split.screen(c(3,1))
A <- 4
barplot(A, col="green4") 
```

![在此处输入图像描述](../Images/8146eb26049917f254b30c3534a3ddbf.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:25:21.490

您是否只想扩展 y 轴。看看`ylim`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T13:41:27.670

您可能正在寻找的是修复您的纵横比。这可以通过以下方式实现`asp`：

```
barplot(A, col = "green4", asp = 1) 
```

另请参阅[R-help 的这篇文章](http://tolstoy.newcastle.edu.au/R/help/05/04/2900.html)。

从更哲学的角度来看，当条的高度发生变化时，表面积没有变化。`barplot`仅绘制一系列条形图，其中`x`轴是序数（有序分类）变量，因此无法计算表面积。条的高度是唯一变化的变量。我建议使用简单的线图绘制这些时间序列。

所以而不是：

```
a = runif(100)
b = 1:100
barplot(a) 
```

![在此处输入图像描述](../Images/f070c60e27c2343f1d84680c2f02fbe7.png)

采用：

```
plot(b, a, type = "l") 
```

![在此处输入图像描述](../Images/6536f69e1efa02ac93b34fb2be054d43.png)

或切换到我最喜欢的绘图包，`ggplot2`：

```
require(ggplot2)
theme_set(theme_bw())
qplot(b, a, geom = "line") 
```

![在此处输入图像描述](../Images/b7b2eb1ab9af0abc5ab9a890deab745c.png)

# ios - 后台 iCloud 处理减慢 gui 和损坏视图控制器堆栈-如何停止多次触摸

> ID：10406851
> 
> 赞同：0
> 
> 时间：2012-05-02T02:12:49.027
> 
> 标签：ios, uinavigationcontroller, icloud

我偶尔会从 NSMetadataQueryDidUpdateNotification 获取更新。这些在后台异步线程中运行，但仍然偶尔会减慢应用程序的速度。

问题是这会减慢我的 TableView 速度，以至于如果您单击一行，它有时不会立即推动它。这是 tableView 内部的一个简单调用：(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath

```
[[self navigationController] pushViewController:detailViewController animated:YES];
[detailViewController release]; 
```

如果您多次触摸该行（沮丧），应用程序视图控制器堆栈就会混乱：

```
nested push animation can result in corrupted navigation bar
nested push animation can result in corrupted navigation bar
nested push animation can result in corrupted navigation bar
Finishing up a navigation transition in an unexpected state. Navigation Bar subview tree might get corrupted.
Finishing up a navigation transition in an unexpected state. Navigation Bar subview tree might get corrupted.
Finishing up a navigation transition in an unexpected state. Navigation Bar subview tree might get corrupted.
Unbalanced calls to begin/end appearance transitions for <DetailViewController: 0xdabc0c0> 
```

我如何阻止这种情况发生并且只接受对行的第一次触摸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T18:06:07.607

我现在已经部分解决了这个问题。我尝试使用：

```
[self.view setUserInteractionEnabled:NO]; 
```

在我的添加按钮方法和 tableView didSelectRowAtIndexPath 但它没有解决多次按下问题。所以我不得不单独禁用它们：

添加按钮的创建：

```
 UIBarButtonItem *bbi = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:@selector(addNew:)];
    self.addBtn = bbi;
    [[self navigationItem] setRightBarButtonItem:bbi]; 
```

在我的 addNew: 方法的开头

```
[self.addBtn setEnabled:NO]; 
```

在我的 tableView didSelectRowAtIndexPath 方法的开头

```
[self.myTable setAllowsSelection:NO]; 
```

在视图中会出现：

```
[self.addBtn setEnabled:YES];
[self.myTable setAllowsSelection:YES]; 
```

# linux - moosefs chunkserver 崩溃，如何修复？

> ID：10406853
> 
> 赞同：0
> 
> 时间：2012-05-02T02:13:22.553
> 
> 标签：linux, moosefs

我的设置是这样的：1 主服务器 4 块服务器

现在其中一台chunk server出现故障，数据无法恢复。我可以修复主服务器的所有数据吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T08:38:16.373

我认为损坏的块服务器上的数据可以分为两种不同的类型。

*   首先，`goal`丢失数据的 为 1。
*   其次，`goal`丢失数据的 大于 1。

如果是第一种情况，则无法修复数据。

如果是第二种情况，丢失的可以在其他chunk server中找到。您可以在 mfs 集群中添加一个新的 chunk server，master 可以决定 chunk server 之间的复制。

# css - CSS文本消失

> ID：10406855
> 
> 赞同：-1
> 
> 时间：2012-05-02T02:13:35.870
> 
> 标签：css

我编写了这个 css，为什么“搜索”消失了？谢谢

```
<h2 class="domain_header">Search</h2>

.domain_header {
    cursor: pointer;
    display: block;
    padding: 5px;
    color: #fff;
    position: relative;
    text-transform: uppercase;
    font-size: 12px;
    letter-spacing: 2px;
    border-left: 0px solid #06f;
    border-bottom: 2px solid #0066FF;
    font-weight:bold;
    margin:0 0 3px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:14:55.213

可能是因为您在白色背景上有白色文字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:21:06.843

尝试将文本更改为不同的颜色。

```
.domain_header {
    cursor: pointer;
    display: block;
    padding: 5px;
    color: #000;
    position: relative;
    text-transform: uppercase;
    font-size: 12px;
    letter-spacing: 2px;
    border-left: 0px solid #06f;
    border-bottom: 2px solid #0066FF;
    font-weight:bold;
    margin:0 0 3px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T02:26:13.827

尝试按 Ctrl+A，如果“搜索”可见，那么您知道这是因为正如@John 所说，您在白色背景上有白色文本，如果没有，那么我们将需要查看更多代码。

# templates - 在模板播放 2.0 模板中在 Scala 中将字符串转换为 Long

> ID：10406859
> 
> 赞同：12
> 
> 时间：2012-05-02T02:14:22.340
> 
> 标签：templates, scala, playframework-2.0

如何在 Scala play 2.0 模板中从字符串转换为长字符串？

我想在我有行动的地方执行以下操作`Application.profile(Long user_id)`：：

```
<a href='@routes.Application.profile((Long) session.get("user_id"))'>@session.get("username")</a> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-02T02:19:58.967

转换在 Scala 中不是这样工作的。

你要：

```
session.get("user_id").toLong 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-04T21:13:48.820

开始`Scala 2.13`您可能更喜欢[`String::toLongOption`](https://www.scala-lang.org/files/archive/api/2.13.x/scala/collection/StringOps.html#toLongOption:Option[Long])安全地处理`String`无法转换为的 s `Long`：

```
"1234".toLongOption.getOrElse(-1L) // 1234L
"lOZ1".toLongOption.getOrElse(-1L) // -1L
"1234".toLongOption                // Some(1234L)
"lOZ1".toLongOption                // None 
```

在你的情况下：

```
session.get("user_id").toLongOption.getOrElse(-1L) 
```

* * *

对于早期版本，您可以选择混合使用`String::toLong`and `Try`：

```
import scala.util.Try

Try("1234".toLong).getOrElse(-1L) // 1234L
Try("lOZ1".toLong).getOrElse(-1L) // -1L 
```

# jquery - 我想知道如何在 jquery 中制作这个 .live()

> ID：10406862
> 
> 赞同：0
> 
> 时间：2012-05-02T02:14:51.373
> 
> 标签：jquery

我想知道我怎样才能让它活起来？我有一个通过 ajax 获取的文本框，它不包括已加载的脚本，这是我假设的 dom 的原因。任何人，我都玩过 .live() 但我通常有一个元素可以将它连接到 ex/ `$('blah').live();`，但我发现自己在这个问题上摸不着头脑，哈哈

```
(function($) {

$.fn.charCount = function(options){

    // default configuration properties
    var defaults = {    
        allowed: 140,       
        warning: 25,
        css: 'counter',
        counterElement: 'span',
        cssWarning: 'warning',
        cssExceeded: 'exceeded',
        counterText: ''
    }; 

    var options = $.extend(defaults, options); 

    function calculate(obj){
        var count = $(obj).val().length;
        var available = options.allowed - count;
        if(available <= options.warning && available >= 0){
            $(obj).next().addClass(options.cssWarning);
        } else {
            $(obj).next().removeClass(options.cssWarning);
        }
        if(available < 0){
            $(obj).next().addClass(options.cssExceeded);
        } else {
            $(obj).next().removeClass(options.cssExceeded);
        }
        $(obj).next().html(options.counterText + available);
    };

    this.each(function() {              
        $(this).after('<'+ options.counterElement +' class="' + options.css + '">'+ options.counterText +'</'+ options.counterElement +'>');
        calculate(this);
        $(this).keyup(function(){calculate(this)});
        $(this).change(function(){calculate(this)});
    });

};

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:27:53.707

jQuery “live”（已弃用）或“on”仅适用于 click、dblclick、keydown、keypress、keyup、mousedown、mousemove、mouseout、mouseover 和 mouseup 事件。

如果你只需要`$('selector').live()`使用这个库：

实时查询：[https ://github.com/brandonaaron/livequery](https://github.com/brandonaaron/livequery)

```
$('selector').livequery(function(){}); 
```

# bash - 尝试使用 egrep 从数据库中仅提取匹配的十六进制字符

> ID：10406863
> 
> 赞同：0
> 
> 时间：2012-05-02T02:14:53.540
> 
> 标签：bash, sed, pcre, grep

十六进制字符的形式为`<9F>`. 它们周围有很多数据，但我只对正确使用正则表达式感兴趣，因此我可以从表中删除这些`sed`数据，然后重新导入数据库。

这是我到目前为止所尝试的：

```
egrep -io '\<[0-9A-Fa-f]{2}\>' /root/database.sql 
```

和几个变化。我似乎无法让它工作，我不知道为什么。我也尝试过双重/三重转义和分组。它找到了字符对，但没有找到`< >`'s

所以它给出这样的输出：

```
39
48
69
6F
B9 
```

但我需要它来获得完整的

```
<39>
<48>
<69>
<6F>
<B9> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T09:07:11.617

我敢打赌，这些字节超出了终端可以显示的范围（控制字符或多字节字符串）。

首先，我必须问您是否绝对确定要从数据库中清除它（毕竟有人可能会想要插入一条带有“über”或其他词的记录）。此外，我还看到一些数据库在 DB 转储文件中使用控制字符作为分隔符（我想到了 Ingres）

如果您仍然想清理数据，那么可以试试这个：

perl -npe 'tr/\001-\177/cd'

我在平板电脑上输入这个，所以我不能仔细检查，但这应该会删除 7 位 ASCII 范围之外的任何字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:21:28.987

这对我有用：

```
$cat testfile
<39> <48>
<60><6F><a4>

$egrep -io '<[0-9A-Fa-f]{2}>' testfile

<39>
<48>
<60>
<6F>
<a4> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:58:25.317

转义小于和大于符号使匹配查找单词的开头和单词的结尾边界。如果您想匹配这些文字字符，请使用未转义的字符。

此外，您可以使用字符类来简化正则表达式。

```
grep -E '<[[:xdigit:]]{2}>' 
```

您可能还有其他不匹配的非打印字符。正如亚当建议的那样，使用`od`or`hexdump`来查看可能隐藏的其他内容。二进制文件有时被表示为输出使用，例如， `<EF>`这些字符实际上并不存在。什么*会有*一个具有值的字节`0xEF`。像这样的二进制数据不适用于`sed`or `grep`。

# php - 如何在 PHP 中为 $_SESSION 组成一个唯一的名称？

> ID：10406870
> 
> 赞同：3
> 
> 时间：2012-05-02T02:16:04.273
> 
> 标签：php, session, networking, ip

作为我正在制作的登录系统的一部分，我在以每个客户端命名的唯一会话中跟踪失败的登录尝试：

```
if($login_failed) {

            // update failed login attempts
            $session_name = 'failed_attempts'.$_SERVER['REMOTE_ADDR'];

            if(!isset($_SESSION[$session_name])) {
                $_SESSION[$session_name] = 1;               
            }
            else {
                $_SESSION[$session_name] += 1;  
            }

} 
```

如您所见，为了确定每个会话的唯一名称，我将用户的 IP 地址附加到字符串“failed_login_attempts”的末尾。

如果用户达到 5 次失败尝试，我需要在每次后续尝试时填写验证码。

我只是担心可能存在一些网络，其中许多用户被分配了相同的 IP 地址，在这种情况下，如果 1 个用户无法登录，他们都会开始看到验证码，即使只有 1 个用户需要显示验证码。

这是合理的还是从来没有两个用户可以拥有相同 IP 的情况，例如他们可能有相同的前 3 个八位字节但最后一个数字会不同，在这种情况下我不必担心。

如果多个用户有可能共享同一个 IP，那么确定会话名称的唯一标识符以将未登录用户链接到会话的好方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T02:18:13.830

该会话**已经是唯一的**，因为它与该特定浏览器上该特定用户的 cookie 相关联。您无需担心它会泄露给其他用户。

[会话 ID](http://php.net/manual/en/function.session-id.php)将所有这些联系在一起。

幕后实际发生的是，PHP 在浏览器上存储了一个带有唯一 ID（会话 ID）的 cookie，该 ID 与存储在服务器上的数据结构相关联。除了那个 id 之外，没有任何实际的会话数据离开服务器。它实际上是一个文件，如果你在你的 php 文件夹中四处寻找，你可以看到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:18:41.650

在大多数学校、家庭和办公室网络中，您的用户*将*共享 IP 地址，因为他们将从 NAT 内部或通过出站防火墙访问更广泛的 Internet。用于[`uniqid()`](http://php.net/manual/en/function.uniqid.php)生成与每个故障相关联的唯一值。但这并不是完全必要的，因为[`session_id()`](http://us3.php.net/manual/en/function.session-id.php)已经为每个用户会话拥有一个唯一的值。

要跟踪会话中的故障，您真正需要做的就是在该会话中增加一个变量。

```
if (failed_login) {
  $_SESSION['failed_logins']++;
}

$threshold = 5;
if ($_SESSION['failed_logins'] >= $threshold) {
   // Do whatever is needed when too many failures occur
} 
```

但是请注意，这不能阻止用户简单地重新启动浏览器以获取新会话。您可以添加更多的箍来跳过，例如还记录用户代理，但这也可能导致同一网络上的其他用户的潜在冲突，并且仍然可以被聪明的最终用户欺骗或更改以绕过您的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-01T14:32:06.263

更好的解决方案是在用户表中标记/增加一列，当它达到 5 时，触发验证码。成功登录后，将值重置为 0。

# objective-c - 应用程序在后台时中断后恢复执行代码

> ID：10406874
> 
> 赞同：4
> 
> 时间：2012-05-02T02:16:51.770
> 
> 标签：objective-c, ios, xcode, avaudioplayer, avaudiosession

我花了几天时间在 SO 和其他网站上研究这个问题的答案，但没有任何运气。

从本质上讲，我为自己设定的挑战是为 iOS 创建一个无论用户在哪里（前景或背景）都能发出声音的闹钟应用。我已经通过使用 AVAudioPlayer 实例并在用户设置警报时开始播放空声音文件以使应用程序继续在后台运行来实现这一点。当警报响起时（即当 NSTimer 被触发时），已经启动并准备播放的第二个播放器开始播放用户醒来的铃声。

此外，我还通过实现 AVAudioSessionDelegate 方法 beginInterruption 和 endInterruptionWithFlags 来处理电话、系统计时器或闹钟的中断。它可以在后台和前台模式下工作，但最奇怪的事情发生了：

当中断结束时，AVAudioPlayer 会继续播放，但除非我再次将应用程序置于前台，否则我无法在我的应用程序中执行任何其他代码。

为了深入了解这一点，我尝试了一个更简单的项目，我将在下面发布。这个应用程序所做的是，一旦您进入应用程序，AVAudioPlayer 类的一个实例就会开始循环播放某种声音。然后当你把它带到后台时，播放器会继续循环播放声音。当发生中断时，我暂停播放器，当它结束时，我使用调度等待几秒钟，然后它调用两个方法，即 (void)playPlayer，一个包含恢复播放文件的代码的方法和 (void)tester ，一种包含计时器的方法，该计时器设置为在中断结束后 5 秒（或准确地说是 7 秒）停止播放器。这两种方法都被调用，正如我在它们中放入的 NSLogs 所示，但计时器永远不会被触发，玩家会继续无限期地玩。

这是 .h 文件的代码：

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>
#import <AudioToolbox/AudioToolbox.h>

@interface InterruptionTest3ViewController : UIViewController <AVAudioSessionDelegate,      AVAudioPlayerDelegate>
{
    AVAudioSession *mySession;
    AVAudioPlayer *myPlayer;
}

-(void) playPlayer;
-(void) pausePlayer;
-(void) tester;

@end 
```

这是 .m 文件的代码：

```
#import "InterruptionTest3ViewController.h"

@interface InterruptionTest3ViewController ()

@end

@implementation InterruptionTest3ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    mySession = [AVAudioSession sharedInstance];
    NSError *setActiveError = nil;
    [mySession setActive:YES withFlags:AVAudioSessionSetActiveFlags_NotifyOthersOnDeactivation error:&setActiveError];
    if (setActiveError) {
        NSLog(@"Session failed to activate within viewDidLoad");
    }
    else {
        NSLog(@"Session was activated within viewDidLoad");
    }
    NSError *setCategoryError = nil;
    [mySession setCategory:AVAudioSessionCategoryPlayback error:&setCategoryError];
    if (setCategoryError) {
        NSLog(@"Category failed to be set");
    }
    else {
        NSLog(@"Category has been set");
    }

    [mySession setDelegate:self];

    NSString *path = [[NSBundle mainBundle] pathForResource:@"headspin" ofType:@"wav"];
    NSError *initMyPlayerError = nil;
    myPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path]     error:&initMyPlayerError];
    if (initMyPlayerError) {
        NSLog(@"myPlayer failed to initiate");
    }
    else {
        NSLog(@"myPlayer has been initiated");
    }

    [myPlayer prepareToPlay];
    [self playPlayer];

    OSStatus propertySetError = 0;
    UInt32 allowMixing = true;

    propertySetError = AudioSessionSetProperty (
                                                kAudioSessionProperty_OverrideCategoryMixWithOthers, 
                                                sizeof (allowMixing),                                 
                                                &allowMixing                                          
                                                );

    [myPlayer setNumberOfLoops:-1];
    [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
}

-(void) beginInterruption
{
    [myPlayer pause];
}

-(void) endInterruptionWithFlags:(NSUInteger)flags
{
    if (flags) {
        if (AVAudioSessionInterruptionFlags_ShouldResume) 
        {
            {
                dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 2 * NSEC_PER_SEC),dispatch_get_main_queue(), ^{

                    [self playPlayer];
                    [self tester];
                });
}
        }
    }
}

-(void) tester
{
    [NSTimer timerWithTimeInterval:5.0 target:self selector:@selector(pausePlayer) userInfo:nil repeats:NO];
    NSLog(@"tester method has been called");
}

-(void) playPlayer
{
    [NSTimer timerWithTimeInterval:5.0 target:myPlayer selector:@selector(stop) userInfo:nil repeats:NO];
    [myPlayer play];
    NSLog(@"playPlayer method has been called");
}

-(void) pausePlayer
{
    [myPlayer pause];
}

//viewDidUnload etc not listed. 
```

所以，这就是伙计们。同样，为什么在应用程序处于后台时中断后计时器没有被触发？我需要在 applicationDidEnterBackground 方法中设置一些东西吗？

非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T03:44:56.683

请使用“[NSTimer scheduleTimerWithTimeInterval:5.0 target:myPlayer selector:@selector(stop) userInfo:nil repeats:NO]”；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T03:54:32.427

不是为了回避这个问题，而是在后台播放空声音位是一种技巧。提供了在后台播放声音的功能，以便您可以播放音乐或其他声音以使用户受益，而不是保持后台进程处于活动状态。

如果您想在特定时间播放声音或以其他方式提醒用户，请考虑[使用本地通知。](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW31)

> 为什么在应用程序处于后台时中断后计时器没有被触发？

如果我没记错的话，当您的应用程序进入后台时，计时器会被暂停或取消。该文档明确指出，当您的应用程序被中断时，即当它被发送到后台时，您应该[“停止计时器和其他周期性任务” 。](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW17)

# php - 如何在 MySQL 中实现事务安全的随机序列

> ID：10406880
> 
> 赞同：3
> 
> 时间：2012-05-02T02:18:01.717
> 
> 标签：php, mysql, transactions, innodb, sequence

所以我的应用需要让用户生成*随机*的字母数字代码，如 A6BU31、38QV3B、R6RK7T。目前它们由 6 个字符组成，而 I 和 O 没有被使用（所以我们得到了 34^6 种可能性）。然后将这些代码打印出来并用于其他用途。

我现在必须确保许多用户每次请求最多可以“保留” 100 个代码，因此用户 A 可能想要获得 50 个代码，用户 B 想要生成 10 个，依此类推。这些代码在所有用户中必须是唯一的，因此用户 A 和用户 B 可能不会同时收到代码 ABC123。

我目前的方法（使用 PHP 和 MySQL）是为此设置两个 InnoDB 表：

*   一个（“存储库”）包含大量预先生成的代码（因为冲突的可能性会随着时间的推移而增加，我不想采用 try-insert-if-fails-try-another-code 方法）。存储库只包含代码和一个自动递增的 ID（所以我可以对它们进行排序，见下文）。
*   另一个表保存保留的键（即代码+拥有用户）。

每当用户想要保留 N 个密钥时，我计划执行以下操作

```
BEGIN;
INSERT INTO revered_codes (code,user_id)
  SELECT code FROM repository WHERE 1 ORDER BY id LIMIT N;
DELETE FROM repository WHERE 1 ORDER BY id LIMIT N;
COMMIT; 
```

这*应该*有效，但我不确定。好像我正在构建一个 WTF 解决方案。

插入后，我必须选择刚刚保留的代码以将它们显示给用户。这是棘手的部分，因为在我的交易完成后，我真的不知道如何识别刚刚保留的代码。我当然可以在我的`reserved_codes`表中添加另一列，持有某种随机令牌，但这似乎更WTFy。

我最喜欢的解决方案是有一个随机数序列，这样我就可以在表中执行`INSERT`操作。`reserved_codes`

那么，如何在 MySQL 中实现这个独特的、随机的和事务安全的序列呢？一个想法是在`reserved_codes`表上定期自动递增并从该数字列中获取随机代码值，但我想知道是否有更好的方法。

**更新：**我忘了提到拥有一个相当小的保留代码表是有利的，因为我以后必须再次找到单个代码来更新它们（`reserved_codes`它有几个属性）。所以让保留表缓慢增长是好的（而不是在大约 1mio 预生成代码上拥有巨大的索引）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:27:48.853

如果您已经有一个存储库表，我只需添加一个用户列，然后运行此查询：

```
UPDATE repository SET user_id = ? WHERE user_id IS NULL LIMIT N; 
```

之后，您可以再次选择记录。这有两个明显的缺点：

*   你需要一个索引`user_id`
*   除了将其绑定到用户之外，您不能将表中的代码用于其他任何事情。

# ms-access - 在访问表单中传递值

> ID：10406882
> 
> 赞同：1
> 
> 时间：2012-05-02T02:18:12.800
> 
> 标签：ms-access, ms-access-2007, vba

我在 Microsoft Access 数据库中有两个表和一个表单。让第一个表 tblCUSTOMERS 和第二个表 tblINVOICES。tblCUSTOMERS 包含名为 CustomerID（主键）、FirstName 和 LastName 的字段。tblINVOICES 包含名为 InvoiceID（主键）、CustomerID（外键）和 Amount 的字段。该表单称为 frmInvoices，包含 tblINVOICES 中字段的文本框。

我要做的是创建允许我搜索客户表，从该表中选择客户记录，然后将该记录的 CustomerID 返回到 frmInvoices 的功能。理想情况下，搜索将采用类似于数据网格的格式，允许按 FirstName、LastName 和 CustomerID 进行搜索。

具体来说，你能告诉我最简单的方法吗： 1\. 插入一个表单（让我们称之为新表单 frmCUSTOMERS），其中包含类似数据网格控件的东西来显示客户记录。2\. 更新 frmCUSTOMERS 上的数据网格以仅显示匹配 tblCUSTOMER 查询的记录（例如仅显示名字以“B”开头的客户） 3\. 将来自 frmCUSTOMERS 的 CustomerID 传递给 frmINVOICES。

非常感谢，

布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T03:11:57.180

您可以在打开表单时将值作为开始参数传递给表单。

```
DoCmd.OpenForm "frmFormName", , , , , ,"B" 
```

或者你可以传入一个条件语句：

```
DoCmd.OpenForm "frmFormName", , , "FirstName LIKE 'B*'" 
```

如果你走第一条路线，你会做这样的事情：

```
Private Sub Form_Load()
    Me.Filter = "FirstName LIKE '" & Nz(Me.OpenArgs, "") & "*'"
    'or
    Me.Subform1.Form.Filter = "FirstName LIKE '" & Nz(Me.OpenArgs, "") & "*'"
End Sub 
```

要从搜索表单中返回诸如 CustomerID 之类的值，有许多选项。您可以将值放在全局变量中。或者，您可以通过在调用表单上使用公共变量或公共函数让搜索表单将值返回给调用表单。

可以说，一个更正确和更简洁的方法是设计一个类来处理打开搜索表单并传递入站和出站值。课程确实需要更多的知识和技能来编写，而且对于您正在尝试做的事情可能会有点矫枉过正。当然不需要一个类来完成这项工作。它只会更干净一点。实际上，如果您确实为此编写了一个类，您将使用我上面列出的许多相同的技术。

# linux - awk 用多列返回结果

> ID：10406888
> 
> 赞同：1
> 
> 时间：2012-05-02T02:18:59.453
> 
> 标签：linux, scripting, awk

我有一个在一列中搜索一个字符串的函数，我将如何允许它为我的脚本提供多列以使用多个搜索字符串进行搜索？

```
awk -v s=$1 -v c=$2 '$c ~ s { print $0 }' $3 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T03:36:47.963

您可以在模式中使用 or 子句：

```
awk -v s=$1 -v c=$2 '$c ~ s || $3 == "foo"' $3 
```

将打印文件 $3 中的所有行，其中列 $2 匹配字符串 $1 或 $3 匹配字符串“foo”。请注意，“print $0”操作是多余的，如果没有给出任何操作，它是默认操作。

# io - 为什么我替换了 CALayer 的位置隐式动画，它仍然在我自己的位置之前启动？

> ID：10406892
> 
> 赞同：1
> 
> 时间：2012-05-02T02:19:48.947
> 
> 标签：io, core-animation, calayer, caanimation

我正在做这样的事情：

```
 CABasicAnimation* translateA = [CABasicAnimation animation];
  translateA.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
  translateA.fillMode = kCAFillModeBoth;
  translateA.duration = 1;

  CALayer* nextLayer = <some layer...>
  [nextLayer addAnimation:translateA forKey:@"position.y"];
  newPos = nextLayer.position;
  newPos.y += someDelta;
  nextLayer.position = newPos; 
```

发生的情况是我看到图层几乎“跳”到它的最终位置，然后我的动画开始了。我的猜测是“几乎跳”实际上是“位置”的原始隐含动画（持续时间非常短）。我还尝试替换位置而不是 position.y 并尝试替换图层中的整个动作字典（只是添加此动画）。但我总是得到相同的结果。

我将如何做才能有效地只看到图层平移 1 秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T00:02:56.090

你能显示更多代码吗？我在使用自定义属性时遇到了这个问题`drawInContext:`

我在自己的层中有这个：

```
+ (BOOL)needsDisplayForKey:(NSString *)key
{
    if ([key isEqualToString:@"progress"])
        return YES;
    else
        return [super needsDisplayForKey:key];
} 
```

当这样做时：

```
[self.layer setValue:@1 forKey:@"progress"]; 
```

接着：

```
[self.layer addAnimation:animation forKey:@"progress"]; 
```

`drawInContext:`在动画开始之前以进度 1 调用。结果问题是我正在用 . 合成属性（进度）`@dynamic`。删除它实际上解决了我的问题:-)

# php - 关于 mysqli_real_escape_string 的说明：存储在数据库中

> ID：10406895
> 
> 赞同：1
> 
> 时间：2012-05-02T02:20:40.340
> 
> 标签：php, mysqli, sql-injection, mysql-real-escape-string

为了避免 SQL 注入攻击，我希望在将我的网站用户输入的所有文本（和大多数其他数据）发送到数据库进行存储之前对其进行清理。

我的印象是该函数在所有可能是恶意的字符（ \n 、 ' 、 " 等）之前插入了反斜杠（ \ ），并期望返回的字符串包含新添加的反斜杠。

我对包含此类潜在恶意字符的组成字符串进行了简单测试，并将其回显到文档中，完全符合我的预期：带有反斜杠的字符串转义了这些字符。

因此，我继续在数据中添加清理功能，然后再存储到数据库中。我将它 (mysqli_real_escape_string( $link , $string)) 插入到我为数据存储而构建的查询中。测试脚本时，我很惊讶（有点懊恼）注意到存储在数据库中的数据似乎不包含反斜杠。我测试，测试，测试，但都无济于事，我很茫然......

有什么建议么？我错过了什么吗？我期望然后必须使用 stripslashes($string) 函数删除反斜杠，但似乎没有任何东西可以剥离......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:35:45.887

当您在成功插入后查看数据库中的数据时，使用 转义它`mysql_real_escape_string()`，您*将*看不到数据库中的反斜杠。这是因为转义反斜杠仅在 SQL 查询语句中需要。 `mysql_real_escape_string()`为插入（或更新，或其他查询输入）清理它，但在存储时不会导致数据的永久修改版本。

通常，您*不想*在数据库中存储修改或清理过的数据，而应该将数据存储在其原始版本中。例如，最好的做法是存储完整的 HTML 字符串，而不是存储使用 PHP 的`htmlspecialchars()`.

当您从数据库中检索它时，不需要`stripslashes()`或其他类似的转义。PHP 有一些遗留（错误）功能，例如[`magic_quotes_gpc`](http://php.net/manual/en/security.magicquotes.php)旨在通过自动向带引号的字符串添加反斜杠来保护程序员免受自身侵害，要求在输出中使用`stripslashes()，但这些功能已被弃用，现在大部分已被删除.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:38:00.747

MySQL 存储不带斜线的数据（尽管它通过斜线传递给 RDBMS）。所以你以后不需要使用 stripslashes() 。

您可以确定该字符串已被转义，否则查询将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T07:01:11.063

> 我正在寻找清除我网站用户输入的所有文本（和大多数其他数据）

这就是你做错了。

1.  mysqli_real_escape_string 不会“清理”任何东西。它的名字中没有“净化”二字。
2.  您应该格式化，而不是“清理”您的数据。不同的数据需要不同的格式。
3.  您应该格式化所有数据，而不仅仅是我网站用户输入的数据

在当前形式下，您的网站极易受到攻击和错误的攻击。

> 我的印象是该函数在所有可能是恶意的字符（ \n 、 ' 、 " 等）之前插入了反斜杠（ \ ），

让您知道，任何角色都没有恶意。有一些服务字符，在某些情况下可能会被误解。
但是添加反斜杠不会使您的数据自动“安全”。有些注入不需要任何特殊字符。所以，你需要正确地格式化你的数据，而不仅仅是使用某种魔法来让你神奇地安全

# c# - 为什么我需要双击按钮让 JQuery 呈现局部视图

> ID：10406905
> 
> 赞同：0
> 
> 时间：2012-05-02T02:21:49.810
> 
> 标签：c#, jquery, asp.net-mvc-3, load, asp.net-mvc-partialview

想知道为什么它不是一次点击加载，而是两次加载..................... ...................................?

```
<input id="btnPaymentAdd" type="button" value="Add Payment Info" />
</p>
<div id="paymentSection"></div>
<br />    

....

$("#btnPaymentAdd").click(function () {
    $("#paymentSection").load('/Donation/AddPaymentInfo');
    $("#paymentSection").show('slow');
});

....

public ActionResult AddPaymentInfo()
{

    var vModel = new PaymentViewModel();
    vModel.Payment = new Payments();
    vModel.PaymentType = new WCCDentalApp.Models.PaymentType();

    ViewBag.PaymentTypes = new SelectList(dbEntities.PaymentTypes.OrderBy(pt => pt.PaymentTypeID),
    "PaymentTypeID", "PaymentType1", vModel.Payment.PaymentTypeID);

    return PartialView("PaymentPView", vModel);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:23:56.377

您需要`.show()`在页面加载后绑定您的功能...

```
$("#btnPaymentAdd").click(function(){
    $("#paymentSection").load('/Donation/AddPaymentInfo', function(){
         $(this).show('slow');
    });
}); 
```

或者你可以使用`.get()`，像这样：

```
$("#btnPaymentAdd").click(function(){
    $.get('/Donation/AddPaymentInfo', function(data){
         $("#paymentSection").html(data).show('slow');
    });
}); 
```

否则，你拥有它的方式只会在`.show()`不等待页面加载的情况下完成，会让你觉得点击它两次就可以了。

# javascript - Chrome 浏览器开发者工具：脚本多次出现

> ID：10406908
> 
> 赞同：5
> 
> 时间：2012-05-02T02:22:00.997
> 
> 标签：javascript, macos, google-chrome

当使用 Chrome 的开发人员工具调试 Javascript 时，“脚本”列表往往会在我更改/重新加载/测试代码时添加每个脚本的多次出现。Safari 使用相同的基本工具集，但不这样做。脚本在此列表中出现 10 次并非未知。发生这种情况时，我唯一能想到的就是杀死标签并重新加载它。这是一个已知的错误？

Chrome 版本 18.0.1025.168（撰写本文时为最新版本）

Mac OSX 版本 10.7.3 (Lion)

干杯!

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T08:09:43.863

我认为您正在使用 Chrome 扩展程序。某些扩展会导致此问题，请通过禁用其中一些来检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:09:57.293

是的，这可能是一个错误。看：

[https://code.google.com/p/chromium/issues/detail?id=113490](https://code.google.com/p/chromium/issues/detail?id=113490)

您可以尝试查看是否有多个帧使用相同的脚本并一次测试一个帧...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T19:09:12.863

仔细检查您的源代码中是否多次调用脚本。根据我的经验，我多次意外地包含 js 文件，直到在 Chrome 的开发人员工具中检查最终源 HTML 时才意识到这一点。

# mysql - MySQL：如何以这种方式获得不同的数字？

> ID：10406910
> 
> 赞同：0
> 
> 时间：2012-05-02T02:22:04.393
> 
> 标签：mysql

在我的 MySQL 数据库中，我有一个带有 mac 地址和时间的表（例如 T）（例如，2012-4-30 23:00:00）。我想过滤掉本周出现的那些mac地址，但上周没有出现。

我怎么能用一句话做到这一点？我尝试使用多项选择，但没有找到方法。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:30:04.453

您可以使用[`YEARWEEK`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_yearweek).

要获取本周的记录：

```
SELECT * FROM T WHERE YEARWEEK(your_datetime_column) = YEARWEEK(NOW()); 
```

仅获取前几周的记录：

```
SELECT * FROM T WHERE YEARWEEK(your_datetime_column) < YEARWEEK(NOW()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:30:11.157

如果没有表结构，我建议如下：

```
SELECT [DISTINCT] Mac FROM table t
WHERE 
t.Time BETWEEN '2012-01-09 00:00:00' AND '2012-01-16 23:59:59'
AND 
NOT EXISTS (SELECT * FROM FROM table t2 WHERE t2.Mac = t.Mac AND T2.Time BETWEEN '2012-01-01 00:00:00' AND '2012-01-08 23:59:59' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:40:22.600

要获取本周有时间但前一周没有时间的 Mac 地址，您可以使用以下内容：

```
SELECT *
FROM T
WHERE YEARWEEK(T.Time) = YEARWEEK(NOW())
AND T.MacAddress NOT IN (
    SELECT MacAddress
    FROM T AS T2
    WHERE YEARWEEK(T2.Time) = YEARWEEK(TIMESTAMPADD(WEEK, -1, NOW()))); 
```

这使用了bfavaretto已经建议的[YEARWEEK函数，以及](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_yearweek)[TIMESTAMPADD](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timestampadd)函数来计算前一周。

# c# - Windows Azure：blob 的长度保持为 0

> ID：10406911
> 
> 赞同：9
> 
> 时间：2012-05-02T02:22:15.467
> 
> 标签：c#, azure, azure-storage, azure-table-storage, azure-blob-storage

我对如何在 Windows Azure 中获取 blob 的大小感到困惑。

在我的例子中，我首先得到 blob 引用`CloudBlockBlob blob = container.GetBlockBlobReference(foo);`（这里 foo 是 blob 的名称，我确定 blob 存在）。然后我尝试获取 blob 大小`blob.Property.Length;`但是，它总是返回`0`. 我在此语句处设置断点并跟踪其中的内容`blob`：`uri`blob 是正确的，我可以推断出该 blob 是从中正确检索的吗？虽然中的所有字段`Properties`都是`null`或`0`。我想不出解决办法。是因为我目前在本地模拟应用程序`Storage Emulator`并且部署后就可以了吗？

谢谢和最好的问候。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-02T04:32:26.353

打电话`blob.FetchAttributes()`。`GetBlockBlobReference`实际上并没有对 blob 服务进行任何调用。它只是构造一个表示 blob 的本地对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T04:52:55.313

大约 4 天前，我写了一篇关于完全相同问题的博客：

[http://blogs.msdn.com/b/avkashchauhan/archive/2012/04/27/windows-azure-blob-size-return-0-even-when-blob-is-accessible-and-downloaded-without-任何问题.aspx](http://blogs.msdn.com/b/avkashchauhan/archive/2012/04/27/windows-azure-blob-size-return-0-even-when-blob-is-accessible-and-downloaded-without-any-problem.aspx)

# php - 如何在php中将字符串存储在数组中

> ID：10406913
> 
> 赞同：2
> 
> 时间：2012-05-02T02:22:21.770
> 
> 标签：php

我有一个字符串，我首先修剪它以删除多余的字符并将其存储到一个变量中。

样本输出：

```
 variable: place1 place2 
```

现在我想做的是将它存储到一个数组中。但我该怎么做呢？是否有一个功能可以检测是否有空格？因为它检测到的每个空格我都希望将字符串存储在数组中。

非常感谢任何方法或帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:23:25.210

使用[`explode()`](http://us2.php.net/manual/en/function.explode.php)：

```
$array_of_parts = explode(' ', 'place1 place2');
echo $array_of_parts[0]; // place1
echo $array_of_parts[1]; // place2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T02:30:56.640

[explode()](http://us2.php.net/manual/en/function.explode.php)是您正在寻找的功能。

```
$string = 'place1 place2';
$arr = explode(' ', $string); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-11T09:44:36.473

你可以使用explode()函数：

```
$yourString = 'place1 place2';
$exploded = explode (' ', $yourString);
echo $exploded[0];
echo $exploded[1]; 
```

# sql - 按条件跨行访问分组

> ID：10406916
> 
> 赞同：2
> 
> 时间：2012-05-02T02:22:57.553
> 
> 标签：sql, ms-access, ms-access-2007, transpose

我有下表，并试图根据 id 跨行分组。我希望访问返回类型包含相同 ID 的 S 和 A 的所有情况（a19），但不返回 S 或 A 彼此不存在的实例（a22 和 a33）。

最简单的方法是什么？

```
+---+----+--------------+
|id |type|    text      |
+---+----+--------------+
 a19   S     S1
 a19   A     A1
 a19   A     A1
 a22   Y     A1
 a33   S     S1
+---+----+--------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T06:56:04.570

这是一个返回所有具有 A 和 S 类型的 id 的查询：

```
SELECT subQuery.id
FROM (SELECT group_table.id
FROM group_table
WHERE (((group_table.type) IN ("A","S")))
GROUP BY group_table.id, group_table.type)  AS subQuery
GROUP BY subQuery.id
HAVING Count(subQuery.id) = 2 
```

您可以通过将**“...IN ("A", "S")..."**替换为**"SELECT FilterType FROM FilterTable"**并更改**"...Count(subQuery.id) = 2\. .."**到例如**"...Count(subQuery.id) = SELECT COUNT(FilterType) FROM FilterTable..."**

# python - 如何更改默认的 virtualenv 提示？

> ID：10406926
> 
> 赞同：55
> 
> 时间：2012-05-02T02:24:25.910
> 
> 标签：python, bash, virtualenv, command-prompt, virtualenvwrapper

如何更改默认的 Virtualenvwrapper 提示？默认情况下，使用类似命令在特定虚拟环境中工作时，`workon <_name_of_env_>`会在提示符前添加 virtualenv 的名称。如果您不使用默认命令提示符，这可能效果不佳。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-11-17T03:53:09.600

如果您正在使用自定义 PS1（当我发现这个问题时），我建议您禁用提示更改，使用`export VIRTUAL_ENV_DISABLE_PROMPT=1`（请参阅[virtualenv 文档](https://virtualenv.pypa.io/en/latest/reference.html#envvar-VIRTUAL_ENV_DISABLE_PROMPT)），并制作自己的 virtualenv 提示以添加到您的 PS1。

请参阅我使用过的这个片段：

```
function virtualenv_info(){
    # Get Virtual Env
    if [[ -n "$VIRTUAL_ENV" ]]; then
        # Strip out the path and just leave the env name
        venv="${VIRTUAL_ENV##*/}"
    else
        # In case you don't have one activated
        venv=''
    fi
    [[ -n "$venv" ]] && echo "(venv:$venv) "
}

# disable the default virtualenv prompt change
export VIRTUAL_ENV_DISABLE_PROMPT=1

VENV="\$(virtualenv_info)";
# the '...' are for irrelevant info here.
export PS1="... ${VENV} ..." 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-09T03:24:18.200

默认情况下，当您使用命令“workon < name_of_env >”切换到 virtualenv 时，virtualenvwrapper 会在您的命令提示符前添加一个字符串“(< name_of_env >)”。问题是我用以下行设置了我的 Bash 提示：

```
PROMPT_COLOR1='0;36m'
PROMPT_COLOR2='1;34m'
PS1='\n\[\033[$PROMPT_COLOR1\](\t)\[\033[$PROMPT_COLOR2\] \u @ \w \n\[\033[$PROMPT_COLOR1\]$ \[\033[0;39m\]' 
```

这会产生一个命令提示符，如下所示：

```
< old_line >

(19:11:05) kevin @ ~/research 
$ 
```

使用“workon < name_of_env >”切换到新的虚拟环境将命令提示符变为：

```
< old_line >
(< name_of_env >)
(19:11:05) kevin @ ~/research 
$ 
```

这比我想要的更杂乱，而且启动的颜色也不对。我希望有类似的东西：

```
< old_line >

(< name_of_env >) (19:11:05) kevin @ ~/research 
$ 
```

Ian Bicking 之前曾指出[virtualenvwrapper 的钩子是解决方案](https://stackoverflow.com/questions/3646014/changing-the-prompt-style-of-a-virtualenv-instance-with-zsh)，但我想我会发布我的实际代码，以节省其他人一分钟的时间。

我只是编辑了文件 $WORKON_HOME/postactivate 以包含这些行：

```
# color virtualenv name properly and put it after the \n if there is one at the start of the prompt
if [ ${_OLD_VIRTUAL_PS1:0:2} == '\n' ]; then
    PS1="\n\[\033[$PROMPT_COLOR1\](`basename \"$VIRTUAL_ENV\"`) ${_OLD_VIRTUAL_PS1:2:${#_OLD_VIRTUAL_PS1}}"
else
    PS1="\[\033[$PROMPT_COLOR1\](`basename \"$VIRTUAL_ENV\"`) $_OLD_VIRTUAL_PS1 "
fi 
```

瞧！颜色和位置是正确的，当您直接从一个虚拟环境切换到另一个虚拟环境时它甚至可以工作（这是我没想到的）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-03T14:23:42.230

我认为以下是最简单的解决方案：

添加到`~/.virtualenvs/postactivate`以下内容：

```
PS1="\[\e[1;33;45m\] (`basename \"$VIRTUAL_ENV\"`) \[\e[0m\]$_OLD_VIRTUAL_PS1" 
```

取自：[http ://wiki.hackzine.org/development/python/virtualenv.html](http://wiki.hackzine.org/development/python/virtualenv.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-05-30T02:15:31.113

我通过精简功能来采用[@ivanalejandro0 的解决方案](https://stackoverflow.com/a/20026992/1666398)：

```
function virtualenv_info {
    # Get Virtual Env
    if [[ -n "$VIRTUAL_ENV" ]]; then
        # Strip out the path and just leave the env name
        echo "(venv:${VIRTUAL_ENV##*/})"
    fi 
```

或者，如果你感觉很老套：

```
function virtualenv_info {
    [[ -n "$VIRTUAL_ENV" ]] && echo "(venv:${VIRTUAL_ENV##*/})"
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-11-20T23:47:09.007

可以通过使用“替代值”参数扩展来减少[@ivanalejandro0 解决方案中的功能。](https://stackoverflow.com/a/20026992/1666398)此外，正如@crimson-egret 评论的那样，在没有 VENV 中间体的情况下，调用可以在 PS1 中正确：

```
function __virtualenv_ps1 {
    echo "${VIRTUAL_ENV:+(venv:${VIRTUAL_ENV##*/})}"
}

# disable the default virtualenv prompt change
export VIRTUAL_ENV_DISABLE_PROMPT=1

# the '...' are for irrelevant info here.
export PS1="... \$(__virtualenv_ps1) ..." 
```

# jquery - colorbox bug - 从链接或按钮关闭 colorbox

> ID：10406927
> 
> 赞同：8
> 
> 时间：2012-05-02T02:24:43.853
> 
> 标签：jquery, colorbox

我通过调用打开弹出窗口

```
$.colorbox({ href: "notification.aspx" }); 
```

在 notification.aspx 我有

```
<script type="text/javascript" src="/scripts/colorbox/jquery.colorbox-min.js"></script>
...
<a id="btnClose">OK</a> 
```

弹出窗口显示得很好，但是当我单击该按钮时，它给出了一个 JavaScript 错误。

在主页的 javascript 我有

```
$('#btnClose').live('click', function () {
  alert('closing...'); // Alert shown as expected
  $.colorbox.close(); // Nothing happens, no JavaScript error
  //$.fn.colorbox.close(); // same
  //parent.$.fn.colorbox.close(); // same
  //$.colorbox.remove(); // same
  //$('#cboxClose').click(); // same
  //$('#cboxOverlay').click(); // same
}); 
```

我只是想关闭弹出窗口。

我错过了什么？提前致谢。

编辑：我让它以某种方式工作，我会找出它的工作原理。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-04T04:55:40.127

`$.colorbox.close()`是关闭彩盒的正确方法，不要听这些其他评论。问题是您第二次加载颜色框。从 中删除`jquery.colorbox.js`脚本块`notification.aspx`。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-31T13:26:26.623

尝试

```
<a href='#' onclick='parent.$.colorbox.close(); return false;'>Close</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T02:49:29.067

```
$(document).ready(function(){

$.colorbox({

                inline:true,
                href:'notification.aspx',

                onClosed:function(){ alert('closing');                  

                    $.colorbox.remove();
                }
            });
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-02T03:13:17.307

谢谢大家的意见。

这真的很奇怪，但是在摆弄之后我发现这样做了

```
$('#btnClose').live('click', function () {
  $.colorbox.remove(); // You have to remove it first (don't know why)
  $('#cboxClose').click(); // Then this will close the box, $.colorbox.close() still doesn't work
  $.colorbox.init(); // Re-init, otherwise colorbox stops working
}); 
```

希望它可以帮助某人。

编辑：虽然这解决了问题，但问题的原因是我两次包含 jquery ！（谢谢杰克）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-28T09:13:38.967

这可能对某人有所帮助。我创建了一个自定义关闭按钮。我的自定义关闭按钮位于右上角，也可以关闭。我的代码：

```
 jQuery(document).ready(function(){
        jQuery('<div id="close" style="cursor: pointer; position: absolute; top: 0; right: 30px;"><img src="../img/close.png" alt="close"/></div>').appendTo('.yourparentDiv');

        $("#close").click(function() {
            jQuery('#cboxClose').click();
        });
    }); 
```

我在关闭彩盒时遇到了问题。它帮助了我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T02:28:32.583

在 notification.aspx 你应该有

```
<a id="btnClose" href="javascript:closeBox();">OK</a> 
```

在主页的 javascript 你应该有

```
<script type="text/javascript" src="/scripts/colorbox/jquery.colorbox-min.js"></script>
...
function closeBox() {
  $.colorbox.close();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-26T21:30:33.153

这对我有帮助

// 3\. 处理对话框取消按钮：

```
$("#CancelDeleteButton").click(function()
{
 $.fn.colorbox.close();
  return false;
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-02T06:56:43.330

如果您有以下条件，大多数答案都会起作用： 1\. 同一域中的父级和子级 2\. 子级具有 JQuery

如果您想关闭子框并且您有这两个条件中的任何一个，请执行以下操作：

在父母这样做：

```
$('document').ready(
    function () {
        window.addEventListener("message", function (event) {
            $.colorbox.close();

        });
    }); 
```

在子项中添加一个关闭按钮，单击时带有以下 js

```
 <input type="button" value="close" onclick="parent.postMessage('child frame', '*');" /> 
```

# websocket - 如何构造相对于页面 URI 的 WebSocket URI？

> ID：10406930
> 
> 赞同：108
> 
> 时间：2012-05-02T02:25:02.530
> 
> 标签：websocket, uri, relative-path

我想在浏览器端构造一个相对于页面 URI 的 WebSocket URI。说，在我的情况下转换 HTTP URIs

```
http://example.com:8000/path
https://example.com:8000/path 
```

到

```
ws://example.com:8000/path/to/ws
wss://example.com:8000/path/to/ws 
```

我目前正在做的是将前4个字母“http”替换为“ws”，并将“/to/ws”附加到它上面。有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-05-02T16:39:02.513

如果您的 Web 服务器支持 WebSockets（或 WebSocket 处理程序模块），那么您可以使用相同的主机和端口，并像您展示的那样更改方案。有很多选项可以同时运行 Web 服务器和 Websocket 服务器/模块。

我建议您查看 window.location 全局的各个部分并将它们重新组合在一起，而不是进行盲字符串替换。

```
var loc = window.location, new_uri;
if (loc.protocol === "https:") {
    new_uri = "wss:";
} else {
    new_uri = "ws:";
}
new_uri += "//" + loc.host;
new_uri += loc.pathname + "/to/ws"; 
```

请注意，某些 Web 服务器（即基于 Jetty 的服务器）当前使用路径（而不是升级标头）来确定是否应将特定请求传递给 WebSocket 处理程序。因此，您可能会受限于是否可以按照您想要的方式转换路径。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-11-23T11:06:00.843

这是我的版本，它添加了 tcp 端口，以防它不是 80 或 443：

```
function url(s) {
    var l = window.location;
    return ((l.protocol === "https:") ? "wss://" : "ws://") + l.hostname + (((l.port != 80) && (l.port != 443)) ? ":" + l.port : "") + l.pathname + s;
} 
```

编辑 1：根据@kanaka 的建议改进版本：

```
function url(s) {
    var l = window.location;
    return ((l.protocol === "https:") ? "wss://" : "ws://") + l.host + l.pathname + s;
} 
```

编辑2：现在我创建了`WebSocket`这个：

```
var s = new WebSocket(((window.location.protocol === "https:") ? "wss://" : "ws://") + window.location.host + "/ws"); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2017-11-24T11:59:44.353

使用 Window.URL API - [https://developer.mozilla.org/en-US/docs/Web/API/Window/URL](https://developer.mozilla.org/en-US/docs/Web/API/Window/URL)

适用于 http(s)、端口等。

```
var url = new URL('/path/to/websocket', window.location.href);

url.protocol = url.protocol.replace('http', 'ws');

url.href // => ws://www.example.com:9999/path/to/websocket 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-07-09T16:24:01.740

假设您的 WebSocket 服务器正在侦听与请求页面的端口相同的端口，我建议：

```
function createWebSocket(path) {
    var protocolPrefix = (window.location.protocol === 'https:') ? 'wss:' : 'ws:';
    return new WebSocket(protocolPrefix + '//' + location.host + path);
} 
```

然后，对于您的情况，按如下方式调用它：

```
var socket = createWebSocket(location.pathname + '/to/ws'); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-05-07T23:35:09.670

简单的：

```
location.href.replace(/^http/, 'ws') + '/to/ws'
// or if you hate regexp:
location.href.replace('http://', 'ws://').replace('https://', 'wss://') + '/to/ws' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-25T18:30:38.583

在本地主机上，您应该考虑上下文路径。

```
function wsURL(path) {
    var protocol = (location.protocol === 'https:') ? 'wss://' : 'ws://';
    var url = protocol + location.host;
    if(location.hostname === 'localhost') {
        url += '/' + location.pathname.split('/')[1]; // add context path
    }
    return url + path;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-12-02T17:51:03.350

在打字稿中：

```
export class WebsocketUtils {

    public static websocketUrlByPath(path) {
        return this.websocketProtocolByLocation() +
            window.location.hostname +
            this.websocketPortWithColonByLocation() +
            window.location.pathname +
            path;
    }

    private static websocketProtocolByLocation() {
        return window.location.protocol === "https:" ? "wss://" : "ws://";
    }

    private static websocketPortWithColonByLocation() {
        const defaultPort = window.location.protocol === "https:" ? "443" : "80";
        if (window.location.port !== defaultPort) {
            return ":" + window.location.port;
        } else {
            return "";
        }
    }
} 
```

用法：

```
alert(WebsocketUtils.websocketUrlByPath("/websocket")); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-14T17:24:39.430

# 非常简单的解决方案，ws 和 port，经过测试：

```
var ws = new WebSocket("ws://" + window.location.host + ":6666");

ws.onopen = function() { ws.send( .. etc 
```

# mysql - 选择具有相同字段名称的MYSQL行并添加前缀

> ID：10406931
> 
> 赞同：3
> 
> 时间：2012-05-02T02:25:03.503
> 
> 标签：mysql

我正在尝试进行 mysql 查询以选择多个表并 LEFT 加入它们，但是它们都有相同的列名“用户”等。我想以这种方式重命名所有字段。所以我尝试了以下查询

```
SELECT mod_backup_accounts . * AS account . * , mod_backup_subscriptions . *
FROM `mod_backup_accounts`
LEFT JOIN `mod_backup_subscriptions` ON `mod_backup_accounts`.subscription_id = `mod_backup_subscriptions`.package_id 
```

然而，`mod_backup_accounts . * AS account . *`它失败了，有没有办法做到这一点？所以它将名称作为帐户。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T02:27:06.577

您不能为列别名提供简写，您必须为每个列名显式地执行此操作。无论如何，通常建议在`SELECT`列表中显式命名所有列而不是使用`SELECT *`，因为它允许您确定性地指定列顺序，并防止您以后意外拉入一个大 BLOB，如果有一个被添加到表（或任何其他架构更改）。

```
SELECT
  mod_backup_accounts.user AS account_user,
  mod_backup_subscriptions.user AS subscription_user,
  ...
  ...
FROM
  mod_backup_accounts
  LEFT JOIN `mod_backup_subscriptions` ON `mod_backup_accounts`.subscription_id = `mod_backup_subscriptions`.package_id 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-22T05:37:47.353

我完全理解您关于重复字段名称的问题。

在我编写自己的函数来解决它之前，我也需要它。如果您使用的是 PHP，则可以使用它，或者如果您有以下设施，则可以使用您正在使用的语言编写您的代码。

这里的技巧是`mysql_field_table()`返回表名和`mysql_field_name()`结果中每一行的字段（如果有的话），`mysql_num_fields()`这样您就可以将它们混合在一个新数组中。

您还可以修改该功能以仅添加“列”。字段名称重复时的前缀。

问候，

```
function mysql_rows_with_columns($query) {
    $result = mysql_query($query);
    if (!$result) return false; // mysql_error() could be used outside
    $fields = mysql_num_fields($result);
    $rows = array();
    while ($row = mysql_fetch_row($result)) { 
        $newRow = array();
        for ($i=0; $i<$fields; $i++) {
            $table = mysql_field_table($result, $i);
            $name = mysql_field_name($result, $i);
            $newRow[$table . "." . $name] = $row[$i];
        }
        $rows[] = $newRow;
    }
    mysql_free_result($result);
    return $rows;
} 
```

# python - Python if 语句继续前进

> ID：10406933
> 
> 赞同：0
> 
> 时间：2012-05-02T02:25:56.763
> 
> 标签：python, if-statement, for-loop

我有以下代码，其中 frag 是被切割（按顺序）DNA序列数据的字符串列表：

```
for a in frag:
    length_fragment = len(a)
    if  (a[0:5] == 'CCAGC')       and (a[-1:] == 'C'):
        total_length.append(length_fragment) 
```

但是，我想跳到 for 循环中的下一个 a ，看看下一个片段的第一个字母是否是 CCAGC ......这在 python 中是否可行。

所以我想将 a[-1:] =='C' 更改为下一个 a[0:5] =='ACGAG' 的语句。关键字是 for 循环中的下一个 a。所以我想在 for 循环中简单地跳过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T02:33:58.930

```
for a, next_a in zip(frag, frag[1:]): 
```

如果 frag 很大，使用 itertools.islice 而不是`[1:]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:37:47.533

用于`continue`跳过循环的其余部分`for`并在下一次迭代的开头重新开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:43:23.357

（我不是 100% 清楚你的意图，所以我会解释：你想找到以 CCAGC 开头的序列，但前提是以下序列以 ACGAG 开头。在那个假设下......）

如果方便，将数据存储为包含所有序列的单个字符串，每行一个，然后使用正则表达式：

```
ccagc_then_acgag = re.compile('(CCAGC.*)\n(?=ACGAG)')
sum( len(seq) for seq in ccagc_then_acgag.findall(sequences) ) 
```

我不能说这是否会比迭代字符串列表更快或更慢（正则表达式库有一些很好的优化，整个循环在本机代码中运行，但字符串列表的优点是不必扫描整个行来查找 ACGAG 匹配），但值得测试。

# iphone - 如何在 iOS 的 CGContext 中显示黑色空白区域

> ID：10406934
> 
> 赞同：0
> 
> 时间：2012-05-02T02:25:59.287
> 
> 标签：iphone, draw, cgcontext, fill

我有一个 640x480 像素的图像，我需要将其裁剪并居中到 596x596 像素的 UIImage 中。任何空白区域都应为黑色（图像上方和下方应为黑色）。现在我正在像这样裁剪它......

```
-(UIImage*)cropImage:(UIImage *)theImage toFitSize:(CGSize)theSize
{
CGFloat CROP_X = floorf((theImage.size.width-theSize.width)/2);
CGFloat CROP_Y = floorf((theImage.size.height-theSize.height)/2);

CGRect imageRect = CGRectMake(CROP_X, CROP_Y, theSize.width, theSize.height);

UIGraphicsBeginImageContext(imageRect.size);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetRGBFillColor(context, 0, 0, 0, 1);
CGRect drawRect = CGRectMake(-imageRect.origin.x, -imageRect.origin.y, theImage.size.width, theImage.size.height);
CGContextClipToRect(context, CGRectMake(0, 0, imageRect.size.width, imageRect.size.height));
[theImage drawInRect:drawRect];
UIImage *finalImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return finalImage;
} 
```

我也试过

```
- (UIImage *)croppedImage:(CGRect)bounds 
{
CGImageRef imageRef = CGImageCreateWithImageInRect([self CGImage], bounds);
UIImage *croppedImage = [UIImage imageWithCGImage:imageRef];
CGImageRelease(imageRef);
return croppedImage;
} 
```

但是空白的空间是透明的。我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:48:05.870

你真的需要改变图像吗？如果您只是要呈现剪裁后的图像，您可以配置 UIImageView backgroundColor 属性以获得所需的效果。

```
CGRect largerRect = CGRectMake(/* larger rect */);
CGRect smallerRect = CGRectMake(/* smaller rect */);

UIImage *croppedImage = [self cropImage:largerImage toFitSize:smallerRect];

// make the view the original size
UIImageView *imageView = [[UIImageView alloc] initWithFrame:largerRect];
imageView.image = croppedImage;

// center the cropped image and give it a loud background color
imageView.contentMode = UIViewContentModeCenter;
imageView.backgroundColor = [UIColor redColor]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T10:07:49.540

这是调整图像大小的工作代码，您只使用 resizeimage 函数，并且图像根据需要调整大小宽度高度

```
-`-(UIImage *)resizeImage:(UIImage *)image{
float width = image.size.width;
float height = image.size.height;

float maxSide = 310;

if (width >= height && width > maxSide)
{
    width = maxSide;
    height = (height*(width/image.size.width));

}
else{
    if (height > maxSide)
    {
        height = maxSide;
        width = (width * (height/image.size.height));
    }
}

if ((int)width % 2 != 0)
{
    width-- ;
}
if ((int)height %2 !=0)
{
    height-- ;
}

UIImage *newImage;

if (width != image.size.width)
    newImage = [self scaleImage:image ToSize:CGSizeMake(width,height)];
else
    newImage = image;
return newImage;}- (UIImage*)scaleImage:(UIImage*)image ToSize:(CGSize)targetSize{
if (image == nil)
    return nil;

UIImage *sourceImage = image;
UIImage *newImage = nil;        
CGSize imageSize = sourceImage.size;
CGFloat width = imageSize.width;
CGFloat height = imageSize.height;
CGFloat targetWidth = targetSize.width;
CGFloat targetHeight = targetSize.height;
CGFloat scaleFactor = 0.0;
CGFloat scaledWidth = targetWidth;
CGFloat scaledHeight = targetHeight;
CGPoint thumbnailPoint = CGPointMake(0.0,0.0);

if (CGSizeEqualToSize(imageSize, targetSize) == NO) 
{
    CGFloat widthFactor = targetWidth / width;
    CGFloat heightFactor = targetHeight / height;

    if (widthFactor > heightFactor) 
        scaleFactor = widthFactor; // scale to fit height
    else
        scaleFactor = heightFactor; // scale to fit width
    scaledWidth  = width * scaleFactor;
    scaledHeight = height * scaleFactor;

    // center the image
    if (widthFactor > heightFactor)
    {
        thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5; 
    }
    else 
        if (widthFactor < heightFactor)
        {
            thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;
        }
}       

UIGraphicsBeginImageContext(targetSize); // this will crop

CGRect thumbnailRect = CGRectZero;
thumbnailRect.origin = thumbnailPoint;
thumbnailRect.size.width  = scaledWidth;
thumbnailRect.size.height = scaledHeight;

[sourceImage drawInRect:thumbnailRect];

newImage = UIGraphicsGetImageFromCurrentImageContext();
if(newImage == nil) 
{

}

UIGraphicsEndImageContext();
return newImage; 
```

}

`

# python - 如何提取 *.txt 文件中的数据并在 Python 中使用？

> ID：10406936
> 
> 赞同：2
> 
> 时间：2012-05-02T02:26:12.230
> 
> 标签：python, import, text-files

我有一个将 (u,v) 转换为 (s,d) 的 Python 代码：

```
def d2r(d):
  r = d * math.pi / 180.0
  return (r)

def r2d(r):
  d = r * 180.0 / math.pi
  return (d)

def sd2uv(s,d):
  r = d2r(d)
  u = s * math.sin(r)
  v = s * math.cos(r)
  return (u,v)  

def uv2sd(u,v):
  s = math.sqrt((u*u)+(v*v))
  r = math.atan2(u,v)
  d = r2d(r)
  if d < 0:
    d = 360 + d
  return (s,d) 
```

u数据存放在u.txt中，每一行有一个数字；v 数据存储在 v.txt 中，每一行也有一个数字。我的问题是如何从这两个文件中提取数据，然后在 Python 代码中使用它们来打印 (s,d)？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:33:46.117

我认为应该这样做：

```
with open('u.txt') as uf, open('v.txt') as vf:
    for u,v in zip(uf,vf):
        print uv2sd(float(u),float(v)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:39:03.887

```
from itertools import izip, imap
with open('u.txt') as u_data, open('v.txt') as v_data:
    for u,v in imap(float, izip(u_data, v_data)):
        print uv2sd(u, v) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:48:38.453

我可以想象两种方法：

1.  将每个文件中的所有数据读取到两个单独的列表中。遍历两个列表并计算每个值，直到到达其中一个列表的末尾。
2.  一次从每个文件中读取一行。计算您正在寻找的值。重复直到你用尽了这两个文件。

第一点的优点是可以保存数据以供后续使用（如果需要），而无需再次打开和读取文件。如果文件中有非常大的数据集，这可能根本无法正常工作。

如果您只需要在程序中使用一次数据，那么第二点的好处是可以节省一些内存。如果您需要一遍又一遍地使用数据，这可能会更慢。

第一种方式可能如下所示：

```
with open('u.txt') as u_file, open('v.txt') as v_file:
    u_values = u_file.readlines()
    v_values = v_file.readlines()

for u, v in zip(u_values, v_values):
    print uv2sd(float(u), float(v))

# We can use u_values and v_values again if we need to now 
```

第二种方法是 Akavall 和 gnibbler 想出的。

# python - 如何清理这个 jinja2 和/或布尔表达式

> ID：10406939
> 
> 赞同：2
> 
> 时间：2012-05-02T02:26:40.313
> 
> 标签：python, filter, config, jinja2, webapp2

```
{% block content %}
    {% for blog_dict in blogs|sort(reverse=True,attribute='date') if ((not file_name_filter) or blog_dict.filename==file_name_filter) and ((not category_filter) or blog_dict.category==category_filter) %}
        <div id="post{{blog_dict.post_number}}-{{blog_dict.link_name}}">
            {{blog_dict.date.strftime("%Y-%m-%d")}}
            <a href="/posts/{{blog_dict.filename}}"><h1>{{blog_dict.heading}}</h1></a>
            <!-- Place this tag where you want the +1 button to render -->
            <div class="g-plusone" data-href="/posts/{{blog_dict.filename}}"></div>
            {{blog_dict.post|safe}}
        </div>
        <br />
        <br />
        <br />
        <img src="/images/page_divider.gif"><br />
    {% endfor %}
{% endblock %} 
```

如您所见，表达式变得混乱：

```
{% for blog_dict in blogs|sort(reverse=True,attribute='date') if ((not file_name_filter) or blog_dict.filename==file_name_filter) and ((not category_filter) or blog_dict.category==category_filter) %} 
```

我尝试的另一个选项是在循环中放置两个嵌套的 if 语句来处理两个过滤器，但是嵌套变得很大。

什么是最优雅的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T01:43:36.543

正如 John Keyes 在评论中提到的，我添加了一个过滤器：

```
def blog_filter(blogs, file_name_filter, category_filter):
    if file_name_filter:
        blogs = (d for d in blogs if d['filename'] == file_name_filter)
    if category_filter:
        blogs = (d for d in blogs if d['category'] == category_filter)
    return blogs 
```

这被添加到 jinja2 environment.filters 字典

```
myconfig = {}
myconfig['webapp2_extras.jinja2'] =  {'template_path': ['templates','blog_posts'],
                                      'filters': {'blog_filter': blog_filter}}

app = webapp2.WSGIApplication(_routes,
    debug=True,
    config = myconfig) 
```

表达式变为：

```
{% for blog_dict in blogs|blog_filter(file_name_filter,category_filter)|sort(reverse=True,attribute='date') %} 
```

我也可以在其他地方使用这个过滤器，比如我的侧边菜单：

```
{% for month, blog_dicts in blogs|blog_filter(False, category_filter)|groupby('date.month')|sort(reverse=True,attribute='grouper') %} 
```

注意我使用了 jinja2 包装器（来自 webapp2_extras import jinja2），它是我的 basehandler 中的一个缓存属性

```
class BaseHandler(webapp2.RequestHandler):
    @webapp2.cached_property
    def jinja2(self):
        return jinja2.get_jinja2(app=self.app)

    def render_template(self, filename, **kwargs):
        #call self.response.write(self.jinja2.render_template(..) 
```

# java - 删除 TreeSet 中的重复项

> ID：10406942
> 
> 赞同：1
> 
> 时间：2012-05-02T02:27:24.813
> 
> 标签：java, collections, arraylist, treeset

我一直在为我的项目使用 ArrayList 来存储板球队球员并订购他们。我开始考虑使用 TreeSet，因为它具有删除重复项的优势。但是我遇到的问题是，例如，如果我创建了以下两个播放器：

```
P p1 = new P("Jack","Daniel",33(age),180(height),78(weight),41(games played),2300
(runs scored),41(dismisses))
P p2 = new P("Jack","Daniel",37(age),185(height),79(weight),45(games played),2560
(runs scored),45(dismisses)) 
```

请注意，这两个玩家的名字和姓氏相同，但其他一切都不同。当我尝试将这两个玩家添加到 TreeSet 时，由于名称相似，它认为它们是重复的，并删除了第二个。显然我不希望这种情况发生，并且我希望 Set 仅在他拥有的一切都与另一名球员相同的情况下移除一名球员，而不仅仅是名字和姓氏。

有没有办法实现这一目标？

我的 TreeSet 也需要一个 Player 对象。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-02T02:29:18.260

最初，这个答案忽略了一个事实，即 a`TreeSet`基于`compareTo()`，而不是进行比较`equals()`。已进行编辑以解决此问题。

您需要为您的对象正确定义`equals()`,`hashCode()`和。（由于它是 a而不是 a ，因此实施并不那么重要 - 但这是一种很好的做法。）`compareTo()``Player``TreeSet``HashSet``hashCode()`

Equals 和 hashCode 需要考虑所有的字段。Eclipse 可以为您自动生成一个看起来与此类似的内容（*Source > Generate hashcode and equals*）。

如果您已经有一个不使用所有字段的*自然排序顺序*`TreeSet`，那么您可以为您的. 但是，即使您真的只想按字段的子集进行排序，也没有什么能阻止您按所有字段进行排序（不感兴趣的字段只扮演部分有趣的部分是相同的）。这里要注意的重要一点是 a`TreeSet`不是通过方法确定相等性`equals()`，而是通过`compareTo() == 0`.

这是一个equals()的例子：

```
@Override
public boolean equals(Object obj)
{
  if (this == obj) {
    return true;
  }
  if (obj == null) {
    return false;
  }
  if (getClass() != obj.getClass()) {
    return false;
  }

  Player that = (Player) obj;
  return this.age == that.age &&
         this.height == that.height &&
         this.weight == that.weight &&
         this.games == that.games &&
         this.runs == that.runs &&
         this.dismisses == that.dismisses &&
         this.given.equals(that.given) &&
         this.family.equals(that.family);
} 
```

这是哈希码：

```
@Override
public int hashCode() {
  final int prime = 31;
  int result = 1;
  result = prime * result + this.age;
  result = prime * result + this.dismisses;
  result = prime * result + this.family.hashCode());
  result = prime * result + this.games;
  result = prime * result + this.given.hashCode());
  result = prime * result + this.height;
  result = prime * result + this.runs;
  result = prime * result + this.weight;
  return result;
} 
```

最后，这是一个 compareTo：

```
public int compareTo(Player that)
{
  int result;

  result = this.family.compareTo(that.family); 
  if (result != 0)                              // is the family name different?
  {
    return result;                              // yes ... use it to discriminate
  }

  result = this.given.compareTo(that.given);
  if (result != 0)                              // is the given name different?
  {
    return result;                              // yes ... use it to discriminate
  }

  result = this.age - that.age;                 // is the age different?
  if (result != 0)
  {
    return result;                              // yes ... use it to discriminate
  }

  ... (and so on) ...
  ... with the final one ...

  return this.dismisses - that.dismisses;       // only thing left to discriminate by
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T11:08:52.800

```
class Student implements Comparable<Student> {

    String name;

    public Student(String name) {
       this.name=name;

    }

    public String toString(){
       return name;
    }

   public int compareTo(Student gStudent) {
       if(!this.name.equals(gStudent.getName())) 
          return 1;
       return 0;
   }

   private String getName() {
       return name;
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-20T12:12:26.430

> TreeSet 实例使用其 compareTo（或 compare）方法执行所有元素比较，因此从集合的角度来看，此方法认为相等的两个元素是相等的。一个集合的行为是明确定义的，即使它的顺序与equals不一致；它只是不遵守 Set 接口的一般约定。

来自 Java Platform Standard Edition 8 文档`TreeSet`部分。

# android - 如何在 Android 的 Facebook API 中更改“X 分钟前通过 SO AND SO”

> ID：10406951
> 
> 赞同：0
> 
> 时间：2012-05-02T02:30:02.030
> 
> 标签：android, facebook, api, upload, photo

我正在尝试更改句子中出现的名称

**“X 分钟前通过 NAME_HERE”**

当您在 Facebook 上的 Wall 中上传图片时（使用 Android API）。

我认为这与 Facebook ID 有关。但是，我不想创建另一个 Facebook ID 只是为了更改该名称。是否可以在不创建另一个 FACEBOOK ID 的情况下更改该名称？？？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:48:28.100

转到[https://developers.facebook.com/apps](https://developers.facebook.com/apps)并在基本设置页面中编辑您的应用名称

# linq - C#/ Html 敏捷包，有没有更雄辩的屏幕抓取方式？

> ID：10406956
> 
> 赞同：0
> 
> 时间：2012-05-02T02:31:08.817
> 
> 标签：linq, c#-4.0, html-agility-pack

我正在使用 C# 开发一个应用程序，该应用程序每天从几个不同的页面收集 Web 数据并将其保存在 SQL Server 中。我正在使用 html 敏捷包...目前我为数据库中的每个字段/列都有一个 xpath。表中有 62 列，通过检查正确的值和格式，下面的代码非常冗长和重复（特别是 xpath 表达式和相关块）。我想知道是否有更好，更简洁的方式，也许使用 LINQ？（我还没有使用太多但想使用）这只是下面设置的前几个字段，重复...... 62 cols。我不是在寻找重写，只是我能得到的任何建议。

```
List<IDataPoint> list = new List<IDataPoint>();
HtmlWeb hwObject = new HtmlWeb();
HtmlDocument htmlDoc = hwObject.Load(AddressString);

if (htmlDoc.DocumentNode != null && !htmlDoc.DocumentNode.InnerHtml.Contains("There is no key statistics data available"))
{
      var symbolNode = htmlDoc.DocumentNode.SelectSingleNode("/html/body/div[3]/div[4] /div/div/div/div/div/div/h2");
      if (symbolNode != null)
      {
            KeyStatsDP keyStatsDp = new KeyStatsDP();
            String symb = "";
            symb = symbolNode.InnerHtml;
            symb = symb.Substring(symb.LastIndexOf("(") + 1);
            symb = symb.Substring(0, symb.Length - 1);
            keyStatsDp.Symbol = symb;

            String mktCapXPath = "//*[@id=\"yfs_j10_" + symb.ToLower() + "\"]";
            var mktCapNode = htmlDoc.DocumentNode.SelectSingleNode(mktCapXPath);
            if (mktCapNode != null)
            {
                  String mktCap = mktCapNode.InnerHtml;
                  keyStatsDp.MarketCapIntraDay = ConvertMoneyInStrToInt(mktCap);
            }

            var entValNode = htmlDoc.DocumentNode.SelectSingleNode("//html/body/div[3]/div[4]/table[2]/tr[2]/td/table[2]/tr/td/table/tr[2]/td[2]");
            if (entValNode != null)
            {
                  if (!entValNode.InnerHtml.Contains("N"))
                  {
                        String entVal = entValNode.InnerHtml;
                        keyStatsDp.EntValue = ConvertMoneyInStrToInt(entVal);
                   }
            } 
```

# android - ADT18、App Engine Connected Android 项目和 noclassdeffounderror

> ID：10406957
> 
> 赞同：2
> 
> 时间：2012-05-02T02:31:19.753
> 
> 标签：android, google-app-engine, adt

免责声明...我*想*我已经浏览了关于这个主题的所有相关帖子，到目前为止，没有一个能解决我的问题。话虽如此，如果我错过了什么，请随时指出正确的方向。

环境：

- 新配置的 Eclipse Indigo

-ADT 18

-GWT 2.4

-App 引擎 SDK 1.6.4

我正在尝试创建一个标准的、简洁的样板“App Engine Connected Android Project”，以开始了解 App Engine 和 Android 之间的处理方式。

完成 File > New > App Engine Connected Android 项目（使用功能性 C2DM 角色电子邮件和密码）后，我在 Eclipse 中获得了 MyTasks-Android 和 MyTasks-AppEngine 项目。

了解 ADT17+ 的整个 lib 与 libs 问题后，我将 MyTasks-Android 项目中的 lib 文件夹更改为 libs 并更新三个 jar 的构建路径（c2dm.jar、requestfactory-client.jar 和 validation-api-1.0.0 .GA.jar）。我还将 MyTasks-AppEngine 项目添加到构建路径中。

完成后，我尝试在我的设备上运行 App-Android 项目。

我可以选择我的 Android 帐户，“允许”它访问我的帐户，然后我看到“问好”按钮。单击按钮后，我在 Eclipse 中收到以下错误：

```
05-01 22:13:22.965: E/dalvikvm(17457): Could not find class 'com.mytasks.client.MyRequestFactory', referenced from method com.mytasks.MyTasksActivity$2$1.doInBackground
05-01 22:13:22.965: W/dalvikvm(17457): VFY: unable to resolve const-class 315 (Lcom/mytasks/client/MyRequestFactory;) in Lcom/mytasks/MyTasksActivity$2$1;
05-01 22:13:22.965: D/dalvikvm(17457): VFY: replacing opcode 0x1c at 0x000a
05-01 22:13:22.973: W/dalvikvm(17457): threadid=11: thread exiting with uncaught exception (group=0x40a291f8)
05-01 22:13:22.989: E/AndroidRuntime(17457): FATAL EXCEPTION: AsyncTask #1
05-01 22:13:22.989: E/AndroidRuntime(17457): java.lang.RuntimeException: An error occured while executing doInBackground()
05-01 22:13:22.989: E/AndroidRuntime(17457):    at android.os.AsyncTask$3.done(AsyncTask.java:278)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.lang.Thread.run(Thread.java:856)
05-01 22:13:22.989: E/AndroidRuntime(17457): Caused by: java.lang.NoClassDefFoundError: com.mytasks.client.MyRequestFactory
05-01 22:13:22.989: E/AndroidRuntime(17457):    at com.mytasks.MyTasksActivity$2$1.doInBackground(MyTasksActivity.java:145)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at com.mytasks.MyTasksActivity$2$1.doInBackground(MyTasksActivity.java:1)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at android.os.AsyncTask$2.call(AsyncTask.java:264)
05-01 22:13:22.989: E/AndroidRuntime(17457):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305) 
```

我整天都在做这件事，到目前为止，没有运气。因此，如果有人有任何建议，我绝对会感谢您的帮助。

谢谢！

编辑 - 2012 年 5 月 2 日 - 从 MyTasksActivity 类中添加了 setHelloWorldScreenContent。具体来说，失败：*MyRequestFactory requestFactory = Util.getRequestFactory(mContext, MyRequestFactory.class);*

同样，这是一个香草向导生成的 App Engine Connected Android 项目 - 我所做的唯一更改是将 MyTasks-AppEngine 添加到 MyTasks-Android 构建路径并将 lib 更改为 libs，然后将三个 jar 读取到构建路径。

```
private void setHelloWorldScreenContent() {
    setContentView(R.layout.hello_world);

    final TextView helloWorld = (TextView) findViewById(R.id.hello_world);
    final Button sayHelloButton = (Button) findViewById(R.id.say_hello);
    sayHelloButton.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            sayHelloButton.setEnabled(false);
            helloWorld.setText(R.string.contacting_server);

            // Use an AsyncTask to avoid blocking the UI thread
            new AsyncTask<Void, Void, String>() {
                private String message;

                @Override
                protected String doInBackground(Void... arg0) {
                    MyRequestFactory requestFactory = Util.getRequestFactory(mContext, MyRequestFactory.class);
                    final HelloWorldRequest request = requestFactory.helloWorldRequest();
                    Log.i(TAG, "Sending request to server");
                    request.getMessage().fire(new Receiver<String>() {
                        @Override
                        public void onFailure(ServerFailure error) {
                            message = "Failure: " + error.getMessage();
                        }

                        @Override
                        public void onSuccess(String result) {
                            message = result;
                        }
                    });
                    return message;
                }

                @Override
                protected void onPostExecute(String result) {
                    helloWorld.setText(result);
                    sayHelloButton.setEnabled(true);
                }
            }.execute();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T06:47:31.620

我遇到了同样的问题。我也只是将文件夹名称从 lib 更改为 libs 并在 andorid 项目的构建路径中添加了 3 个 jar 并且它起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T12:57:06.583

我只花了 4 个小时，标准的 lib->libs 对我没有帮助，最后解决方案是用 jdk 1.6 而不是 1.7 编译，这意味着你甚至必须编译来自 appengine 的共享库（逻辑上）用 1.6 编译

# licensing - 没有网站和文档的商业项目的 Carrot2 许可证

> ID：10406959
> 
> 赞同：0
> 
> 时间：2012-05-02T02:31:43.953
> 
> 标签：licensing, cluster-analysis, carrot2

根据carrot2 FAQ，我们应该感谢项目用户使用Carrot2。

> 我可以在商业项目中使用 Carrot2 吗？是的。唯一的要求是您正确地承认 Carrot2 的使用（在项目的网站和文档上）并让我们知道您的项目。还请记住阅读许可证。

但是我们没有站点或文档，因为我们正在构建封闭的项目。在这种情况下，我们如何整合carrot2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:50:51.460

我已经修改了许可证和常见问题页面上的文本，使确认成为可选的，但您仍然需要在二进制发行版中包含 Carrot2 许可证文件。一种常见的做法是将许可证文件放在相关的 JAR 文件旁边。

# php - 如何在 php 上从 plsql 打开自定义类型？

> ID：10406960
> 
> 赞同：4
> 
> 时间：2012-05-02T02:31:45.297
> 
> 标签：php, database, oracle, plsql, oci8

我在 Oracle 上创建了一个类型

```
CREATE OR REPLACE TYPE  myType as object (
id number,rol varchar(16) );​ 
```

然后我有这个函数，它返回一个 myType 类型的对象

```
create or replace FUNCTION myFunction(...) RETURN myType IS
.... 
END; 
```

在 plsql 上，我可以访问返回对象的属性，只需这样做：

```
var := myFunction(...);
dbms_output.put_line(var.rol); 
```

但是我怎样才能使用 OCI8 从 php 访问对象属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T10:29:58.497

首先创建该对象的类型，以便能够将其作为表返回。

```
CREATE TYPE tableType AS TABLE OF myType 
```

然后，使用 Oracle 的 table() 函数，您可以将输出作为 PHP 上的普通选择处理

```
select *
from   table(myFunction(...)) 
```

很简单吧？:)

（根据要求进行编辑以确保完整性）

# replace - 替换第一列文本中的特定字符

> ID：10406961
> 
> 赞同：5
> 
> 时间：2012-05-02T02:31:45.317
> 
> 标签：replace, awk

我有一个文本文件，我正在尝试将第一列中的特定字符 (.) 替换为另一个字符 (-)。每个字段都用逗号分隔。有些行的最后 3 列是空的，所以最后有 3 个逗号。

文本文件示例：

```
abc.def.ghi,123.4561.789,ABC,DEF,GHI
abc.def.ghq,124.4562.789,ABC,DEF,GHI
abc.def.ghw,125.4563.789,ABC,DEF,GHI
abc.def.ghe,126.4564.789,,,
abc.def.ghr,127.4565.789,,, 
```

我尝试的是使用 awk 替换 '.' 在第一列中带有'-'，然后打印出内容。

ETA：尝试了 sarnold 的建议并得到了我想要的输出。

ETA2：我可以有更长的第一列。有没有办法只改变前 3 个“。” 在第一列到'-'，所以我得到了输出

```
abc-def-ghi-qqq.www,123.4561.789,ABC,DEF,GHI
abc-def-ghq-qqq.www,124.4562.789,ABC,DEF,GHI
abc-def-ghw-qqq.www,125.4563.789,ABC,DEF,GHI
abc-def-ghe-qqq.www,126.4564.789,,,
abc-def-ghr-qqq.www,127.4565.789,,, 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T02:41:49.457

`.`是“任何字符”的正则表达式。逃避它，`\`这意味着`.`：

```
$ awk -F, '{gsub(/\./,"-",$1); print}' textfile.csv 
abc-def-ghi 123.4561.789 ABC DEF GHI
abc-def-ghq 124.4562.789 ABC DEF GHI
abc-def-ghw 125.4563.789 ABC DEF GHI
abc-def-ghe 126.4564.789   
abc-def-ghr 127.4565.789   
$ 
```

默认情况下，输出字段分隔符是空格。设置`OFS = ","`为：

```
$ awk  -F, 'BEGIN {OFS=","} {gsub(/\./,"-",$1); print}' textfile.csv 
abc-def-ghi,123.4561.789,ABC,DEF,GHI
abc-def-ghq,124.4562.789,ABC,DEF,GHI
abc-def-ghw,125.4563.789,ABC,DEF,GHI
abc-def-ghe,126.4564.789,,,
abc-def-ghr,127.4565.789,,, 
```

这仍然允许更改多个字段：

```
$ awk  -F, 'BEGIN {OFS=","} {gsub(/\./,"-",$1); gsub("1", "#",$2); print}' textfile.csv 
abc-def-ghi,#23.456#.789,ABC,DEF,GHI
abc-def-ghq,#24.4562.789,ABC,DEF,GHI
abc-def-ghw,#25.4563.789,ABC,DEF,GHI
abc-def-ghe,#26.4564.789,,,
abc-def-ghr,#27.4565.789,,, 
```

我不知道是什么`-OFS,` *，*但它不是受支持的命令行选项；使用它来设置输出字段分隔符是我的一个错误。`OFS`程序中的设置`awk`效果很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T06:56:20.753

这可能对您有用：

```
awk -F, -vOFS=, '{for(n=1;n<=3;n++)sub(/\./,"-",$1)}1' file
abc-def-ghi-qqq.www,123.4561.789,ABC,DEF,GHI
abc-def-ghq-qqq.www,124.4562.789,ABC,DEF,GHI
abc-def-ghw-qqq.www,125.4563.789,ABC,DEF,GHI
abc-def-ghe-qqq.www,126.4564.789,,,
abc-def-ghr-qqq.www,127.4565.789,,, 
```

# javascript - 褪色（）功能不起作用

> ID：10406963
> 
> 赞同：2
> 
> 时间：2012-05-02T02:32:17.147
> 
> 标签：javascript

我正在通过“JavaScript: The Good Parts”一书学习 javascript。其中一个示例是淡入淡出功能，如下所示：

```
 1 var fade = function (node) {
  2     var level = 1;
  3     var step = function () {
  4         var hex = level.toString(16);
  5         node.style.backgroundColor = '#FFFF' + hex + hex;
  6         if (level < 15) {
  7             level += 1;
  8             setTimeOut(step, 100);
  9         }
 10     };
 11     setTimeOut(step, 100);
 12 };
 13 
 14 fade(document.body); 
```

但是我没有得到想要的效果。知道可能会出什么问题吗？

PS 这是我的 .html 文件。我不知道这是否有用。

```
 1 <?xml version="1.0" encoding="utf-8"?>
  2 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  3     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  4 <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  5     <head>
  6         <title>My program</title>
  7     </head>
  8     <body>
  9         <pre>
 10             <script type = "text/javascript" src = "program.js"></script>
 11         </pre>
 12     </body>
 13 </html> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:37:09.847

你有一个错字。它是`setTimeout`，带有小写的“o”。记住要经常看案例。[你可以在http://jsbin.com/ezoxed/2/edit](http://jsbin.com/ezoxed/2/edit)看到你的效果。

确保在调试 JavaScript 时使用浏览器的开发者控制台。通常可以通过按键盘上的 F12 来访问它。如果您查看那里，您会看到以下消息：

> 未捕获的 ReferenceError：未定义 setTimeOut

话虽如此，享受这本书。这是一本很棒的书！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T02:41:35.127

是的，你有一个错字。请查看以下网址以获得实时效果：

[http://jsfiddle.net/4HVQw/](http://jsfiddle.net/4HVQw/)

# ruby-on-rails - Rails：redirect_to '#{user.role}_url' 我该如何做到这一点？

> ID：10406964
> 
> 赞同：2
> 
> 时间：2012-05-02T02:32:21.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在 rails/ruby 中有没有一种方法可以将我的路由代码简化为优雅的，例如：

重定向到 user.role + _url

这样，如果用户是管理员，他们将被路由到管理页面，依此类推，其他用户类型...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T02:53:44.977

***当然！***

```
redirect_to send("#{user.role}_url") 
```

在 ruby​​ 中，发送将在接收器上执行该方法，这正是您想要的。通常，这看起来像：

```
@receiver_object.send(:admin_url) 
```

但是 url-helpers 在全局命名空间中工作，所以你可以发送到全局并让它工作。

**简单的测试方法**：将其添加到控制器并观看它重定向您的家：

```
redirect_to send("root_path") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T02:45:22.333

可能最好的方法是使用[url_for](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-url_for)助手。例如。

```
redirect_to url_for( :controller => users, :action => user.role ) 
```

这将生成路径`/users/admin`等`/users/guest`。

如果您想以一种骇人听闻的方式进行操作，则可以使用

```
redirect_to eval("#{user.role}_url") 
```

不过要小心。您的字符串不起作用的原因是它没有被评估，所以`redirect_to "admin_url"`什么都不做，它只是一个无意义的字符串，redirect 期望字符串是一个 URL。

如果您评估该字符串，它将起作用，因为`redirect_to eval("#{user.role}_url")`将首先转换`"admin_url"`为调用该`admin_url`方法，该方法返回一些类似 的路径`users/admin`，并且该字符串可用于重定向方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:40:18.437

您可以使用`render "#{user.role}"`. 只需确保具有名称为 admin.html.erb' 等的相应视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T02:44:23.100

您可以做几件事，但没有什么是内置的，也没有什么比`send("#{user.role}_url")`. 请务必使用 send() - 否则它将重定向到 URL“/admin_url”，而不是调用 admin_url 帮助程序。

另一个这样的解决方案是创建一个名为“home”的操作，该操作将重定向到 current_user 的角色页面。这会增加一个额外的重定向（稍微增加页面加载时间），但它会使你的重定向更简单

```
redirect_to home_url 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T02:54:32.933

我真的很喜欢安德鲁的回答，但你也可以做类似的事情

```
redirect_to send(user.role.to_s + '_url') 
```

# winapi - 如何在长时间任务之前更改光标？

> ID：10406966
> 
> 赞同：1
> 
> 时间：2012-05-02T02:32:25.077
> 
> 标签：winapi, mfc

我想在长时间任务之前更改光标。我用setcursor改变了它，但光标没有改变。

这是我的代码：

```
 HCURSOR hWait  =  AfxGetApp()->LoadStandardCursor(IDC_WAIT) ;
    HCURSOR hDefault = AfxGetApp()->LoadStandardCursor(IDC_ARROW);
    ::SetCursor(hWait);

    //a long procedure

    ::SetCursor(hDefault); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T06:23:18.867

一个非常方便的方法是在长任务的开始（或之前）创建一个[CWaitCursor的实例。](http://msdn.microsoft.com/en-us/library/wc7bzytb%28v=vs.80%29.aspx)它设置游标，当它超出范围时，它会恢复它（在析构函数中）：

```
{
    CWaitCursor wait;  

    // Long task

} // The cursor is restored here 
```

# java - MyBatis 设置参数时出错

> ID：10406969
> 
> 赞同：1
> 
> 时间：2012-05-02T02:32:55.690
> 
> 标签：java, ibatis, mybatis, postgresql

使用 PostgreSQL 在 MyBatis 中运行 select 时出现此错误：

```
### The error may exist in data/mapper.xml
### The error may involve Transaccion.selectDeFraude-Inline
### The error occurred while setting parameters
### SQL: SELECT transaction_id, card_number, transaction_date, fraud FROM transactions.? ORDER BY card_number, transaction_date ASC;
### Cause: org.postgresql.util.PSQLException: ERROR: error de sintaxis en o cerca de «$1» 
```

我在 mapper.xml 中得到错误：

```
<select id="selectDeFraude" parameterType="String" resultMap="result">
    SELECT transaction_id, card_number, transaction_date, fraud FROM transactions.#{tabla} ORDER BY card_number, transaction_date ASC;
</select> 
```

这是调用选择的方法：

```
public List<Transaccion> selectDeFraude(String tabla){

    SqlSession session = sqlSessionFactory.openSession();

    try {
        List<Transaccion> list = session.selectList("Transaccion.selectDeFraude", tabla);
        return list;
    } finally {
        session.close();
    }
} 
```

如果我将 #{tabla} 替换为表的名称，它就可以正常工作。所有映射器方法都不起作用，但如果我将 #{something} 替换为适当的值，它们都会起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T23:50:04.233

这不完全是问题的答案，但我现在开始工作了。当使用 myBatis 映射表名时，您应该使用`${table_name}`而不是`#{table_name}`，并且它应该是您作为参数传递的对象的属性。

我将代码更改为如下所示：

```
<select id="selectDeFraude" parameterType="Transaccion" resultMap="result">
    SELECT transaction_id, card_number, transaction_date, fraud FROM transactions.${tabla} ORDER BY card_number, transaction_date ASC;
</select> 
```

我向它添加了属性表，并且知道它工作得很好。

# ios - nsmutablearray 遇到 NSGenericException '集合在被枚举时发生了变异'

> ID：10406970
> 
> 赞同：-1
> 
> 时间：2012-05-02T02:33:23.137
> 
> 标签：ios, exception, nsmutablearray

我昨天遇到了一个叫做“集合在被枚举时发生了变异”的异常，并看到了一些解决方案。我有另一个想法。如果我设置一个名为“锁定”的参数，并且每次我枚举我锁定它，然后在枚举后解锁它。每个有时间我会操作它，比如枚举或添加对象，我先锁定它，然后在操作后解锁它。有人可以告诉我它是否会起作用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T03:08:44.007

我解决了。问题之一是关于线程安全。使用

```
 @synchronized (yourobject)
    {
    //do something with your object
    } 
```

这将起作用。这意味着它将锁定“您的对象”，以便其他线程无法修改它。然后在“}”之后解锁它

另一个是关于删除数组中的对象的一些代码。如果你立即删除，你会遇到名为'Collection was mutated while being enumerated'的异常。创建一个临时数组以包含要删除的对象，然后在删除后将它们全部删除for 循环。

```
 NSMutableArray *toDestroy = [NSMutableArray arrayWithCapacity:_contactor.count];
    for(Man *sprite in self.contactor)
    {
        if (sprite.hp<=0 && sprite.stat == stat_attack)
        {
            [sprite stopAllActions];
            [sprite animDead];
            [toDestroy addObject:sprite];
        }
    }
    [self.contactor removeObjectsInArray:toDestroy]; 
```

代替

```
for(Man *sprite in self.contactor)
{
    if (sprite.hp<=0 && sprite.stat == stat_attack)
    {
        [sprite stopAllActions];
        [sprite animDead];
        [self.contactor removeObject:sprite];
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T03:18:12.463

你应该复制它。如果它是一个数组，请执行以下操作：

```
NSArray *arrayToEnumerate = [myMutableArray copy]; 
```

现在枚举，您将不必担心在您之下更改非可变数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T17:14:11.817

枚举时不能更改数组。作为一种解决方法，您应该在临时数组中累积新对象并在枚举后添加它们：

```
NSArray *tempArray = [yourArray copy];

for(id obj in tempArray) {
    //It's safe to remove objects from yourArray here.

}
[tempArray release]; 
```

# wcf - WCF 响应中的 MustUnderstand 属性导致 Java/Axis 客户端出错

> ID：10406972
> 
> 赞同：3
> 
> 时间：2012-05-02T02:33:28.330
> 
> 标签：wcf, soap, axis

我们开发了一个带有 usernameToken 身份验证的 WCF4 服务，该服务正在被 Java/Axis 客户端（我们无法控制）使用。

我可以看到进来的请求的主体看起来像这样......

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header>
    <wss:Security xmlns:wss="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <wss:UsernameToken>
        <wss:Username>username</wss:Username>
        <wss:Password>password</wss:Password>
      </wss:UsernameToken>
    </wss:Security>
  </soapenv:Header>
  <soapenv:Body>
    {snipped}
  </soapenv:Body>
</soapenv:Envelope> 
```

我们返回的响应看起来像这样......

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
  <s:Header>
    <o:Security s:mustUnderstand="1" xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <u:Timestamp u:Id="_0">
        <u:Created>2012-05-02T01:23:12.711Z</u:Created>
        <u:Expires>2012-05-02T01:28:12.711Z</u:Expires>
      </u:Timestamp>
    </o:Security>
  </s:Header>
  <s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    {snipped}
  </s:Body>
</s:Envelope> 
```

问题是响应中的 s:mustUnderstand="1" 属性。这会在 Java/Axis 客户端中导致“必须理解检查失败”错误。

有谁知道如何配置 WCF 以删除此 s:mustUnderstand 属性或至少将其设置为“0”而不是“1”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:50:36.953

我们想出的解决此互操作问题的解决方案是更改为自定义绑定并指定 includeTimestamp="false" 属性。通过这样做，时间戳（创建和过期）没有添加到响应中，因此整个安全标头消失了 - 包括导致所有问题的 mustUnderstand 属性。

```
<customBinding>
    <binding name="customBindingConfig">
        <security authenticationMode="UserNameOverTransport" includeTimestamp="false" />
         <textMessageEncoding messageVersion="Soap11" />
         <httpTransport />
   </binding>
</customBinding> 
```

所以现在的响应看起来像这样......

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        {snipped}
    </s:Body>
</s:Envelope> 
```

# c# - 如何在asp.net中没有html响应

> ID：10406973
> 
> 赞同：6
> 
> 时间：2012-05-02T02:33:31.473
> 
> 标签：c#, asp.net

也许是简单的问题。

好的，我的页面上有一个帖子，需要回复一个字符串。

在 php 中，您可以简单地执行以下操作：

```
<?php
die ("test"); 
```

然后您可以将此页面放在网络服务器上并像这样访问它：

```
localhost/test.php 
```

所以，我需要在 c# 中做完全相同的事情。

当我尝试回应时：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("test");
        Response.End();
    } 
```

我得到：`"<html><head><style type="text/css"></style></head><body>test</body></html>"` 作为回应。

我怎样才能让 asp.net 只返回准确的响应，没有 html？

我知道我可能缺少一些基本知识，但在网上找不到任何东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-02T02:37:14.577

您可以清除先前的响应缓冲区并写入新的输出。

```
Response.Clear(); // clear response buffer
Response.Write("test"); // write your new text
Response.End(); // end the response so it is sent to the client 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T02:39:42.330

确保在您的`*.aspx`文件顶部`AutoEventWireup="true"`，如果它为 false（或不存在？），`Page_Load`则不会调用您的事件处理程序。

另外，请确保您编译了您的页面。

另一个建议是使用`Generic Handler`(ie `*.ashx`)，它们不使用典型的网络表单生命周期，并且可能更适合您正在做的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-02T02:38:34.310

我想你正在寻找：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.ContentType = "text/plain";
        Response.Write("test");
        Response.End(); 

    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-02T04:50:20.460

对我来说，它只在 response.write(); 中生成实际文本；陈述。为了清楚起见，我正在上传完整的代码。

视觉工作室：2010

**代码背后：**

```
public partial class Default2 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("I CAN ONLY SEE THIS NO OTHER HTML TAG IS INCLUDED");
        Response.End();
    }
} 
```

**代码**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default2.aspx.cs" Inherits="Default2" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    </form>
</body>
</html> 
```

**输出和 HTML 来源：**

我只能看到这个没有包含其他 HTML 标记

我得到了想要的结果。我已经用 Master-Page 尝试过这段代码，我也得到了相同的结果。

请确保您的**AutoEventWireup="true"**如果我​​将此设置为 false 则 HTML SOURCE 更改为此

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title></head>
<body>
    <form method="post" action="Default2.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2MTY2ODcyMjlkZGivF0fgbeE6VebNR51MYSu3yJdsZ9DwEtIPDBVRf4Vy" />
</div>

    <div>

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-15T20:22:12.043

正如上面前面的答案所暗示的那样，您需要`AutoEventWireup="true"`以及`Response.End()`后面的代码。

# asp.net-mvc - 在学习 ASP.NET MVC 之前我应该 学习什么？

> ID：10406974
> 
> 赞同：1
> 
> 时间：2012-05-02T02:33:32.437
> 
> 标签：asp.net-mvc, linq

我曾使用 C# 处理过 ASP.NET webforms 和 windows 应用程序，但由于我工作性质的变化，我已经有 2 年没有使用过 ASP.NET 了。现在，我想回到 ASP.NET，而 MVC 已经存在。我正在关注 www.asp.net 上的教程。

我应该学习 LINQ 和 EntityFramework 来学习 MVC 吗？在学习 MVC 之前，还有其他基础知识需要学习吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T02:59:38.170

帮自己一个忙，学习 HTTP，然后你就会对任何框架都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:42:02.670

> 现在，我想回到 ASP.NET 并且 MVC 已经存在

没关系！开始使用 MVC！

> 我应该学习 LINQ 和 EntityFramework 来学习 MVC 吗？

这不一定是先决条件。也许您需要习惯 lambdas（因为 MVC 中的许多方法都使用它们），因此学习 LINQ 将指导您。

充分了解 AJAX 和 jQuery（因为它包含在 MVC 堆栈中），您就可以开始了！

# php - MongoDB + PHP：如何查询对象大小？

> ID：10406975
> 
> 赞同：0
> 
> 时间：2012-05-02T02:33:38.647
> 
> 标签：php, mongodb, mongodb-php, mongodb-query

MongoDB + PHP：如何查询存储在 mongodb 对象中的文档的大小？在撰写本文时（最近从 4MB 提高）的文档限制为 16MB。

如何使用 ObjectId 查询文档的大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-02T03:38:41.907

`Object.bsonsize(document)`是你追求的功能。我正在阅读[这个线程](http://groups.google.com/group/mongodb-user/browse_thread/thread/9e66eac1f781763c)并找到一些关于如何在 php 中执行此操作的建议。最简单的可能是查询文档对象并`strlen`在`bson_encode`'d 对象上运行，为您提供以字节为单位的大小。

```
$byteSize = strlen( bson_encode( $yourDocument ) ); 
```

如果您想对大量文档进行此检查，比如说在一个循环中，而不读回您需要运行命令执行的每个文档（[Mardix](http://groups.google.com/groups/profile?enc_user=z3iwJxEAAAA19_XwokdR-2YeoPzCNrxekdEasx1kiYTQavV7mdW13Q)发布了这个小功能来做到这一点 - 注意：它可以很容易改写好一点，以避免硬编码和全局变量）：

```
$DBName = "MyDBName"; 
$MongoDB = new MongoDB(new Mongo(),$DBName); 

function documentSize(Array $Criteria){ 
  global $MongoDB; 
  $collectionName = "MyCollection"; 
  $jsonCriteria = json_encode($Criteria); 
  $code = "function(){ 
    return Object.bsonsize(db.{$collectionName}.findOne({$jsonCriteria})) 
  }"; 

  $resp = $MongoDB->execute($code); 
  return $resp["retval"]; 
} 
```

$id 是文档 ID 的 PHP 示例

```
$myDocSize = documentSize(array("_id"=>$id)); 
```

# c++ - 优化器会根据编译时常量推导出数学表达式吗？

> ID：10406979
> 
> 赞同：5
> 
> 时间：2012-05-02T02:33:55.523
> 
> 标签：c++, gcc, compiler-optimization

如果我有一些数学方程依赖于可以是零或非零的输入（模板参数，在编译时已知），优化器是否会评估方程并优化它知道将评估为 0 或 1 的表达式。

例如：

```
double x = y * Eval<type>::value; 
```

如果`Eval<type>::value`是`0`，`x`将永远是`0`。

```
double x = exp(y * Eval<type>::value); 
```

如果`Eval<type>::value`是`0`，`x`将永远是`1`。

优化器能否解决这个问题并用代码中的或其他地方替换`x`，或者这些计算是否会在运行时执行？`0``1`

我正在使用 gcc 4.7`-O3`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T03:06:06.877

**编辑：我错了，编译器在使用浮点数时按预期工作。**

好吧，gcc 4.6.3`-03`确实似乎这样做了，只要表达式是整数相关的。

示例代码：

```
#include <cstdio>
inline int x(double y)
{
   if (y == 0)
      printf("Hello bob3\n");
   else
      printf("Why do I bother\n");

};

const int c = 0;

int main()
{
   int f;
   scanf("%d",&f);

   x(f * c);
} 
```

结果组装

```
 .file   "foo.cpp"
    .section    .rodata.str1.1,"aMS",@progbits,1
.LC0:
    .string "%d"
.LC1:
    .string "Hello bob3"
    .section    .text.startup,"ax",@progbits
    .p2align 4,,15
    .globl  main
    .type   main, @function
main:
.LFB13:
    .cfi_startproc
    subq    $24, %rsp
    .cfi_def_cfa_offset 32
    movl    $.LC0, %edi
    xorl    %eax, %eax
    leaq    12(%rsp), %rsi
    call    scanf
    movl    $.LC1, %edi
    call    puts
    xorl    %eax, %eax
    addq    $24, %rsp
    .cfi_def_cfa_offset 8
    ret
    .cfi_endproc
.LFE13:
    .size   main, .-main
    .ident  "GCC: (Debian 4.6.3-1) 4.6.3"
    .section    .note.GNU-stack,"",@progbits 
```

# c++ - 插入 MenuItem 时如何获取要使用的下一个命令 ID？

> ID：10406984
> 
> 赞同：0
> 
> 时间：2012-05-02T02:34:44.557
> 
> 标签：c++, windows, explorer

我实现`IContextMenu2`并希望在悬停菜单时填充菜单。在`QueryContextMenu`我得到论点`idCmdFirst`。然而`HandleMenuMsg2`，我没有得到这个论点。因此，我应该`InsertMenu`为 id 参数传递什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:23:04.100

我基本上存储了`idCmdFirst`from`QueryContextMenu`并在`HandleMenuMsg2`.

# tinymce - Rails 的 TinyMCE 和 ActiveAdmin

> ID：10406987
> 
> 赞同：6
> 
> 时间：2012-05-02T02:35:43.873
> 
> 标签：tinymce, activeadmin

我重新认识了 Rails，我真的很喜欢 Active Admin。我想让 tinyMCE 与它一起用于文本区域。但是，我发现的任何说明都不完整。出于某种原因，我认为我在这里遗漏了一些非常简单的东西。

因此，例如，我安装了 tinymce-rails (3.4.9) 并按照说明进行操作 (https://github.com/sophlenz/tinymce-rails)。然而，这就是我认为我失败的地方：实际上启动了 tinyMCE。根据文档，我有两个选择：

1.  使用 <%= tinymce %> 帮助器或...
2.  像下面这样初始化它`tinyMCE.init({ mode: 'textareas', theme: 'advanced' });`

我尝试将后者添加到我的 active_admin.js 文件中，但无济于事。

如果有人可以指导我，我将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-18T17:35:11.833

我让它在做以下事情（在[repo](https://github.com/spohlenz/tinymce-rails)中描述的安装之外）

在 admin/my_class.rb 中：

```
ActiveAdmin.register MyClass do
  form do |f|
    f.inputs do 
      f.input :body, :input_html => { :class => "tinymce" }
    end
  end
end 
```

在初始化程序/active_admin.rb 中：

```
...
config.register_javascript 'tinymce.js' 
```

这实际上是让 tinymce.js 脚本出现在管理布局的头部的原因。

在 javascripts/active_admin.js 中：

```
//= require active_admin/base
//= require tinymce

$(document).ready(function() {
  tinyMCE.init({
     mode: 'textareas',
     theme: 'advanced'
   });
}); 
```

完成这些操作后，该正文输入（文本区域）上有一个功能齐全的编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T15:28:17.290

您的 textarea 输入是否具有“类”属性或 tinyMCE 可以挂钩的属性？它可以从 javascript 控制台（firefox/chrome）工作吗？您是否在页面的头部（源）中检查了 tinymce.js 的存在。

我让它与一个部分表单一起工作，我必须为输入元素提供一个类，以便 tinymce 可以连接到它。

```
<%= f.input :literature_nld, :input_html => { :class => 'tinymce', :size => "80x4" } %> 
```

祝你好运

# objective-c - 如何使用 ARC 在 Objective C 中分配字符串值？

> ID：10406989
> 
> 赞同：0
> 
> 时间：2012-05-02T02:36:25.840
> 
> 标签：objective-c, automatic-ref-counting

使用 ARC，现在可以像这样分配一个字符串值：

```
 self.userName = [[NSString alloc] initWithString:self.currentParsedCharacterData]; 
```

或者这仍然会导致内存泄漏，因此需要我像这样分配它：

```
NSString *tmpString = [[NSString alloc] initWithString:self.currentParsedCharacterData];
self.userName = tmpString; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:41:38.843

第一个片段在 ARC 下很好，并且是两种方式中更好的一种。Apple 在[Transitioning to ARC](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html%23//apple_ref/doc/uid/TP40011226)指南中有一个这样的例子：

```
- (void)contrived {
    Person *aPerson = [[Person alloc] init];
    [aPerson setFirstName:@"William"];
    [aPerson setLastName:@"Dudney"];
    [aPerson setYearOfBirth:[[NSNumber alloc] initWithInteger:2011]];
    NSLog(@"aPerson: %@", aPerson);
} 
```

并说：

> ARC 负责内存管理，因此既`Person`不会`NSNumber`泄漏对象也不会泄漏对象。

`setYearOfBirth:`带有`alloc`ed的消息`NSNumber`对应于您的代码段。

编译器理解，在第一种情况下，`aPerson`超出范围，需要在此之前释放，在第二种情况下，没有明确引用`NSNumber`对象，必须释放或放入自动释放池。它代表您处理这两个要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:38:30.783

是的，使用 ARC 就可以了。事实上，我会推荐你​​实现它的第一种方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T02:38:56.307

你的任何一个例子都很好。就内存管理/ARC而言，两者之间没有区别。

# facebook - Facebook 图形 API 的“好友”请求现在每页只返回 25 个好友？这是怎么回事？

> ID：10406990
> 
> 赞同：12
> 
> 时间：2012-05-02T02:37:05.710
> 
> 标签：facebook, facebook-graph-api

我的应用程序（游戏）已经在 Facebook 上运行了一段时间。我首先通过图形 API 调用请求朋友列表：my-uid/friends 询问用户名和个人资料图片。

通常我会返回一个包含我所有朋友的列表，最多有几千个，直到它开始将朋友放到下一页。这很好，因为我的大多数用户通过 1 个电话就能结交朋友。

然而，突然之间，应用程序没有任何变化。大约 40 分钟前（周二 18:40 (PDT) - 2012 年 5 月 2 日）我开始收到每个“页面”只有 25 个朋友的回复！

我仍然可以通过多次调用来获取我的整个朋友列表，但游戏目前尚未设置为正确执行此操作。谁能告诉我为什么突然改变？其他任何人都看到过类似的问题，我如何获得列表，以便像以前一样每页最多给我 5000 个朋友。

可使用 Graph API Explorer 重现

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T02:42:41.643

我不知道还能告诉你什么；也许返回的默认号码已经改变，但是当我尝试时，调用会`/me/friends?limit=5000`为我返回完整列表（但我的朋友列表是 >500 和 < 1000 ，所以它可能会在途中中断）

（旁注：[已发现平均好友数约为 190](https://www.facebook.com/notes/facebook-data-team/anatomy-of-facebook/10150388519243859)，因此大概大多数用户的好友数将少于 500，而不得不在 500 以上的页面上将是一个极端情况

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-29T09:07:36.083

在 SDK 4.7 中，您需要传入包含您想要返回的好友数量的捆绑包，我已将其设置为 5000，因为这是您可以在 Facebook 上拥有的最大好友数量。

您还需要在 facebook 开发控制台中将您的应用设置为游戏，并使用邀请好友来获取完整的好友列表

创建您的捆绑包

```
Bundle bundle = new Bundle(); 
```

将参数添加到您的捆绑包

```
bundle.putInt("limit", 5000); 
```

然后将其传递给您的 GraphRequest

```
new GraphRequest(
            AccessToken.getCurrentAccessToken(),
            "/me/invitable_friends",
            bundle,
            HttpMethod.GET,
            new GraphRequest.Callback() {
                public void onCompleted(GraphResponse response) {
                   //Do something with the response
                }
            }
    ).executeAsync(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-02T04:44:09.253

似乎 facebook 在其他 api 调用（提要、帖子、朋友等）中也将其限制更改为 25 个结果，如果您请求不带参数的朋友，则 JSON 响应显示以下内容：

```
"paging": {
    "next": "https://graph.facebook.com/USER_ID/friends?format=json&limit=25&offset=25&__after_id=LAST_ID"
} 
```

无论如何，您可以/应该始终设置限制和偏移参数来防止这种事情，~~**limit = 0**将返回您所有的朋友列表。~~

~~[https://graph.facebook.com/USER_ID/friends?limit=0](https://graph.facebook.com/USER_ID/friends?limit=0)~~

如果您只向普通用户请求朋友，则允许的最大数量为 5,000，因此如果您从 facebook 页面或其他类型的 api 调用（如帖子或提要）请求信息，则限制应为 0 或 5,000，此限制可能会~~增加~~~~或~~减少。

 ~~（更新）Facebook 修复了这个错误，因此将限制设置为 0 会返回 0 个朋友，您应该设置一个正数限制，感谢 Dinuz

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-02T03:40:53.693

我认为你能做的最好的事情就是像 Igy 所说的那样添加 limit=5000 参数。
但是我发布[了一个错误报告](https://developers.facebook.com/bugs/291554087597981)，因为文档中没有注意到或描述此更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-17T11:10:11.563

**从/v2.2/me/friends**端点返回的结果数现在默认为 25。

好友列表现在仅返回也使用您的应用的好友：通过**/me/friends**端点返回的好友列表现在仅限于已授权您的应用的好友列表。

查看 Facebook 更改 [Facebook API 更改日志](https://developers.facebook.com/docs/apps/changelog)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-07T17:51:56.830

如果您正在使用 `GraphRequest()`（例如在 React Native 中），您可以直接将其放在字符串字段中，如下所示：

```
new GraphRequest(
  '/me',
  {
    accessToken,
    parameters: {
        fields: {
          string: 'id,email,first_name,last_name,friends.limit(5000)'
        }
    }
    ... 
```~~

# javascript - 使用滑块控制器更新地图数据/阴影？包含示例

> ID：10406993
> 
> 赞同：0
> 
> 时间：2012-05-02T02:37:25.370
> 
> 标签：javascript, interactive

如何在不使用 Flash 的情况下创建类似的地图？ [地图示例在这里](http://visual.ly/salubrious-nation?view=true)

我有一张美国地图，每个州都根据年度数据（热图）着色。例如，从 2000 年到 2010 年的肥胖率（每个州每年都有不同的值）。我希望用户使用滑块滑动以更新每年的地图，类似于上面的示例。

我对 Javascript 很陌生，所以我想知道是否有一个库可以提供帮助。我知道 raphael.js，但没有看到任何这种特殊行为的例子。感谢您的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:51:36.133

是的，您可以使用 OpenLayers API 创建类似的热图，而无需使用 Flash。OpenLayers API 基于 javascript，使用起来非常简单。首先，您需要了解基础知识：

[http://openlayers.org/](http://openlayers.org/)

OpenLayers 热图示例：

[http://maps.seai.ie/wind/](http://maps.seai.ie/wind/)

[http://dev.openlayers.org/sandbox/camptocamp/canvas/openlayers/examples/heatMap.html](http://dev.openlayers.org/sandbox/camptocamp/canvas/openlayers/examples/heatMap.html)

[http://sloweb.org.uk/ollie/heatmap/](http://sloweb.org.uk/ollie/heatmap/)

# asp.net-mvc-3 - ModelState.AddModelError 没有显示在我的视图中

> ID：10406998
> 
> 赞同：50
> 
> 时间：2012-05-02T02:37:57.657
> 
> 标签：asp.net-mvc-3, razor

我有以下视图，它创建了 10 个 ajax.beginform ，但是我面临的问题是，如果在创建对象期间发生错误，那么尽管我已经设置了 ModelState.AddModelError 将不会显示在视图上该`@Html.ValidationSummary(true)` 视图如下所示

```
@model Medical.Models.VisitLabResult

@for (int item = 0; item < 10; item++)
{
    <tr id = @item>
    @using (Ajax.BeginForm("CreateAll", "VisitLabResult", new AjaxOptions
    {
        HttpMethod = "Post",
        UpdateTargetId = item.ToString() + "td",
        InsertionMode = InsertionMode.Replace,
        LoadingElementId = "progress2",
        OnSuccess = string.Format(
            "disableform({0})",
            Json.Encode(item)),
    }))
    {  
        @Html.ValidationSummary(true)

        @Html.AntiForgeryToken()
        <td>
            @Html.DropDownList("LabTestID", String.Empty)
            @Html.ValidationMessageFor(model => model.LabTestID)
        </td>
        <td>
            @Html.EditorFor(model => model.Result)
            @Html.ValidationMessageFor(model => model.Result)
        </td>

        <td>
            @Html.EditorFor(model => model.DateTaken)
            @Html.ValidationMessageFor(model => model.DateTaken)
        </td>

        <td>
            @Html.EditorFor(model => model.Comment)
            @Html.ValidationMessageFor(model => model.Comment)
        </td>

        <td>
            <input type="submit" value="Create" />
        </td>

        <td id = @(item.ToString() + "td")>
        </td>
    }
    </tr>
    }
</table> 
```

我定义 ModelState.AddModelError 的操作方法如下所示：-

```
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult CreateAll(VisitLabResult vlr, int visitid = 28)
{
    try
    {
        if (ModelState.IsValid)
        {
            var v = repository.GetVisit(visitid);
            if (!(v.EligableToStart(User.Identity.Name))){ 
                return View("NotFound"); 
            }
            vlr.VisitID = visitid;
            repository.AddVisitLabResult(vlr);
            repository.Save();

            return Content("Addedd Succsfully");
        }
    }
    catch (DbUpdateException)
    {
        JsonRequestBehavior.AllowGet);
        ModelState.AddModelError(string.Empty, "The Same test Type might have been already created,, go back to the Visit page to see the avilalbe Lab Tests");
    }
} 
```

**那么我如何在我的视图上显示 ModelState.AddModelError 。**

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-05-09T22:29:20.390

我会敦促你改变你的`try{ } catch(){ }`

首先检查是否存在对给定 id 的访问，如果存在，则简单地返回带有添加模型错误的模型

```
 if (visitExists)
    {
         ModelState.AddModelError("CustomError", "The Same test Type might have been already created,, go back to the Visit page to see the avilalbe Lab Tests");
         return View(vlr);    
    }
    //Other code here 
```

将您的 AddModelError 更改为

```
ModelState.AddModelError("CustomError", "The Same test Type might have been already created,, go back to the Visit page to see the avilalbe Lab Tests"); 
```

在您看来，只需添加一个

```
@Html.ValidationMessage("CustomError") 
```

然后，当您返回模型时，错误将显示在您放置 @Html.ValidationMessage 的位置...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-16T16:26:00.813

`@Html.ValidationSummary(true)` shows only the error message about model's propertys, if you want to show also the added message, added with

```
ModelState.AddModelError(
    "CustomError", 
    "The Same test Type might have been already created, go back to the Visit page to see the avilalbe Lab Tests"); 
```

you need to set `@Html.ValidationSummary(false)` If you need to display the validation's message near your input fields you need to set `@Html.ValidationSummary(true)` and to follow the steps suggested by Syneryx

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-10T10:26:26.237

您可以在 View 中使用 from `ViewData`dictionary 来访问`ModelState`数据。

例如：

在行动：

```
ModelState.AddModelError("CustomError", "Error 1");
ModelState.AddModelError("CustomError", "Error 2"); 
```

并获得“错误 1”消息：

```
ViewData.ModelState["CustomError"].Errors[0].ErrorMessage 
```