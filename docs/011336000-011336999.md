# StackOverflow 问答 11336000-11336999

# bash - 如何检查 Mailx 是否在过去的时间范围内使用？

> ID：11336004
> 
> 赞同：0
> 
> 时间：2012-07-04T22:27:26.050
> 
> 标签：bash, unix, mailx

我有一个 mailx 语句作为 shell scipt 的一部分。它是条件声明的一部分，如果系统出现故障，它将每分钟发送一封电子邮件。

有没有办法让 mailx 检查邮件是否在最后一小时内发送，并且仅在结果为假时发送？

```
tail -1 "/location/of/file.txt" | mail -s "Warning" test@testing.com; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:31:19.340

使用文件来标记您发送的时间。例如

```
dowork() {
    tail -1 "/location/of/file.txt" | mail -s "Warning" test@testing.com;
    touch ./checked.txt
}
if [[ -f ./checked.txt ]] ; then
    if [[ $(expr $(date '+%s') - $(stat -c '%Y' ./checked.txt )) -gt 3600 ]]; then
            dowork
    fi
else
    dowork
fi 
```

# c# - DateTime 对象列表上的 DataType 注释（ASP.NET MVC/Entity Framework）

> ID：11336005
> 
> 赞同：0
> 
> 时间：2012-07-04T22:27:56.417
> 
> 标签：c#, asp.net-mvc, entity-framework

有没有办法在对象列表（IEnumerable）上使用 DataType 注释，这样当我在模板中使用 DisplayFor 时，它会正确格式化日期？

模型：

```
public class CallOverview
{

    [DataType(DataType.Date), DisplayFormat(DataFormatString = @"{0:dddd dd MMMM yyyy}")]
    public IEnumerable<DateTime> Days { get; set; }

} 
```

看法：

```
@foreach (var day in Model.Days)
{

    <p>@Html.DisplayFor(modelItem => day)</p>

} 
```

输出：

```
31/07/2012 00:00:00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T04:03:35.470

我认为您看到这种行为的原因是因为您将 DataType 属性应用于枚举，而不是应用于其各个值。像这样的东西应该可以工作：

模型：

```
public class CallOverview
{
    public IEnumerable<DateTimeWrapper> Days { get; set; }

    public class DateTimeWrapper
    {
        [DataType(DataType.Date), DisplayFormat(DataFormatString = @"{0:dddd dd MMMM yyyy}")]
        public DateTime Value { get; set; }
    }
} 
```

看法：

```
@foreach (var day in Model.Days)
{
    <p>@Html.DisplayFor(m => day.Value)</p>    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-16T21:57:08.577

你可以做你想做的事。您需要引入一个新类型以通过 EF 持久化集合。

有关详细信息，请参阅此答案：[https ://stackoverflow.com/a/43773647/1742393](https://stackoverflow.com/a/43773647/1742393)

```
public class CallOverview
{

    [DataType(DataType.Date), DisplayFormat(DataFormatString = @"{0:dddd dd MMMM yyyy}")]
    public PersistableDateTimeCollection<DateTime> Days { get; set; }

} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-09T03:27:19.320

答案是做不到。

# ruby-on-rails - 什么是在 Ruby on Rails 中为组建模的好方法

> ID：11336012
> 
> 赞同：0
> 
> 时间：2012-07-04T22:28:43.377
> 
> 标签：ruby-on-rails, sqlite, postgresql

我最近开始学习 Rails，并在[http://ruby.railstutorial.org](http://ruby.railstutorial.org)完成了示例应用程序。我正在尝试将用户创建的组添加到示例社交网络。我已经陷入了我应该如何为团队建模的问题。我知道应该有一个拥有该组的用户 ID，并且应该有名称和描述的字符串。除此之外，我不知道组数据模型的其余部分应该是什么样子。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:48:45.377

如果您希望用户在多个组中，您的关系应该是这样的

```
class Group < ActiveRecord::Base
  belongs_to :owner, :class_name => "User"
  has_many :memberships
  has_many :members, :through => :memberships
end

class Membership < ActiveRecord::Base
  belongs_to :member, :class_name => "User" 
  belongs_to :group
end

class User < ActiveRecord::Base
  has_many :memberships
  has_many :groups, :through => :memberships
  has_many :owned_groups, :class_name => "Group", :foreign_key => "owner_id"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:41:27.673

这样的事情呢？

```
class Group < ActiveRecord::Base
  has_many :users
end

class User < ActiveRecord::Base
  belongs_to :group
end 
```

# php - PHP 在 MySQL 数据库中存储/检索图像名称

> ID：11336014
> 
> 赞同：1
> 
> 时间：2012-07-04T22:28:50.930
> 
> 标签：php

我目前正在开发一个带有文件目录的多图像上传器。我想将文件名存储在我的 MySQL 中。

如何通过 php 将这些变量（图像名称）存储在我的表中？

如何通过 php 检索变量？

**URL 由上传者生成：**

*   [http://www.website.com/imageupload/index.php?i=4ff4bfd02c241.jpg](http://www.website.com/imageupload/index.php?i=4ff4bfd02c241.jpg)
*   [http://www.website.com/imageupload/index.php?i=4ff4bfd02c242.jpg](http://www.website.com/imageupload/index.php?i=4ff4bfd02c242.jpg)

**文件名：**

*   4ff4bfd02c241.jpg
*   4ff4bfd02c242.jpg

**表名：** urlimage

```
id: autoincrement
image_name 
```

**我可以通过以下方式回显路径和名称：**

```
$images = explode(',', $_GET['i']);

$path = Configuration::getUploadUrlPath('medium', 'target');

foreach ($images as $image) {

    echo '<div><p>' . $path . $image . '</p><img src="' . $path . $image . '" /></div>';
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:44:34.580

```
$images = explode(',', $_GET['i']);

$path = Configuration::getUploadUrlPath('medium', 'target');

if(is_array($images)){

  $sql = "INSERT INTO `urlimage` (`image_name`) VALUES ";

  foreach ($images as $image) {

    //echo '<div><p>' . $path . $image . '</p><img src="' . $path . $image . '" /></div>';
    $value[] = "(".$path.$image.")"; // collect imagenames
  }

  $sql .= implode(',', $value).";"; //build query

  //don't know how you send queries, you should use a kind of mysqli-functionality
  queryfunction($sql);   
} 
```

另外：您应该考虑使用 $_POST 而不是 $_GET 因为浏览器的长度限制（其中一些会在 255 个字符后剪切 URL）。
也永远不要将用户定义的内容直接放入您的数据库中。你需要某种转义（[http://php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)）。

# spring-security - Spring Framework 基于角色的方法安全性在 Apache CXF webservice 中不起作用

> ID：11336015
> 
> 赞同：1
> 
> 时间：2012-07-04T22:28:52.733
> 
> 标签：spring-security, authorization, cxf

我有一个带有以下 beans.xml 文件的简单 Apache CXF 网络服务：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans 
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns="http://www.springframework.org/schema/security"
    xmlns:ssec="http://cxf.apache.org/spring-security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jaxws="http://cxf.apache.org/jaxws"
    xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd    
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd   
    http://cxf.apache.org/spring-security 
    http://cxf-spring-security.googlecode.com/svn/trunk/cxf-spring-security/src/main/resources/schemas/spring-security.xsd
    http://cxf.apache.org/jaxws 
    http://cxf.apache.org/schemas/jaxws.xsd">

    <beans:import resource="classpath:META-INF/cxf/cxf.xml" />

    <http auto-config='true' >
        <http-basic/>
        <anonymous enabled="false"/>                
    </http>

    <beans:bean id="methodSecurityInterceptor"
          class="org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor">            

          <beans:property name="authenticationManager" ref="authenticationManager"/>                      
          <beans:property name="accessDecisionManager" ref="accessDecisionManager"/>                                          
          <beans:property name="securityMetadataSource">
            <beans:value>
                org.mycompany.com.CxfSpringSecuredService.HelloWorldImpl.sayHi=ROLE_OPERATOR
                org.mycompany.com.CxfSpringSecuredService.HelloWorldImpl.sayHiAdmin*=ROLE_ADMIN,ROLE_SUPERVISOR
                org.mycompany.com.CxfSpringSecuredService.HelloWorldImpl.deleteAccounts*=ROLE_SUPERVISOR
            </beans:value>
          </beans:property>                                                 
    </beans:bean>

    <beans:bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
       <beans:property name="decisionVoters">
          <beans:list>
              <beans:bean class="org.springframework.security.access.vote.RoleVoter" />                          
          </beans:list>
       </beans:property>
    </beans:bean>

    <authentication-manager alias="authenticationManager">
        <authentication-provider>
            <user-service>          
                <user name="operator" password="operator" authorities="ROLE_OPERATOR" />
                <user name="admin" password="admin" authorities="ROLE_ADMIN" />
                <user name="sup" password="sup" authorities="ROLE_SUPERVISOR" />                  
            </user-service>
        </authentication-provider>
    </authentication-manager>       

    <jaxws:endpoint 
      id="helloWorld" 
      implementor="org.mycompany.com.CxfSpringSecuredService.HelloWorldImpl" 
      address="/HelloWorld" />  

</beans:beans> 
```

我的 webservice 实现是以下三个简单的方法：

```
@WebService(endpointInterface = "org.mycompany.com.CxfSpringSecuredService.HelloWorld")
public class HelloWorldImpl implements HelloWorld {

    public String sayHi(String text) {          

        SecurityContext context =  SecurityContextHolder.getContext();
        if (context != null){
            Authentication authentication = context.getAuthentication();
            if (authentication != null){
                Collection<GrantedAuthority> roles = authentication.getAuthorities();

                if (roles != null){  
                    GrantedAuthority[] authorities = new GrantedAuthority[roles.size()];
                    roles.toArray(authorities);                 
                    for (int i = 0; i < authorities.length; i++)                    
                        text = text + " " + authorities[i];
                }
            }
        }               

        return "Hello " + text;
    }

    public String sayHiAdmin(){    

        return "Hello admin";
    }

    public String deleteAccounts(String name){
        return "Accounts deleted by " + name;
    }
} 
```

我有一个 C# 客户端，它调用 Web 服务并在 SOAP 标头中传递身份验证信息。我知道我的客户正在传递身份验证信息，因为我在异常中收到以下消息：

```
The HTTP request is unauthorized with client authentication scheme 'Anonymous'. The authentication header received from the server was 'Basic realm="Spring Security Application"'. 
```

如果我发出无效的凭据。我发出正确的凭据，我得到每个 Web 服务调用的正确响应。到目前为止，一切都很好。

如果我为操作员传递凭据信息，并调用方法 deleteAccounts，我预计会出现与上述相同的授权错误，但 Web 服务方法被正确调用。

我查看了[Spring Framework](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#authz-arch)此处的文档，但无法确定可能缺少什么。

有任何想法吗？

TIA。

**编辑：更正了用户配置。**

# outline - 大纲：无；不工作 - 只有 -webkit-appearance:none; 正在工作 - 这里有什么问题？

> ID：11336017
> 
> 赞同：12
> 
> 时间：2012-07-04T22:29:23.333
> 
> 标签：outline

编辑：我担心的是移动网站。

让我直奔主题。不管我做什么，大纲：无；不会使用 Ipod Touch/Iphone 从输入表单元素中删除任何默认突出显示/发光。

我到处看，人们说要使用：

```
input:focus {
outline:none;
} 
```

或者

```
input {
outline:none;
} 
```

....这将消除辉光....好吧，它没有。

另一个主要问题是没有默认发光。我创建了一个没有样式的空白页面，只有一个表单输入，通过 IOS 手机查看页面，输入元素上没有发光/轮廓......它只是空白。

唯一有效的是使用 -webkit-appearance:none; - 这只是让我在输入元素上设置一个盒子阴影。如果我不使用 -webkit-appearance:none; - 那么盒子阴影将无法正确显示。

然而，当在桌面浏览器上查看时，即使没有 webkit，盒子阴影也能正常工作。

所以我的问题是：为什么大纲：无；对输入元素没有任何作用？我看到有些人说他们只在锚标签上工作，而另一些人说他们在输入元素上工作。谁在这里？因为到目前为止，无论我做什么，大纲：无；在输入元素上毫无价值。

这是一个JSfiddle：

[http://jsfiddle.net/QQGnj/4/show/](http://jsfiddle.net/QQGnj/4/show/)

在 iOS 移动设备上查看此页面，一开始没有“发光”或默认样式。每个人都在哪里看到需要轮廓的默认发光行为：无；工作（它不工作）？这让我发疯！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-05T14:50:09.560

如果您使用`outline:none;`请添加焦点样式。请参阅[http://outlinenone.com/](http://outlinenone.com/)。

当不使用鼠标时，此功能非常有用。Outline 提供了一个重要的可访问性功能，因此，如果您必须删除它，请为您的链接焦点和活动状态添加一个样式。请帮助用户了解链接存在的位置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-28T15:10:05.660

试试这个：-webkit-tap-highlight-color: rgba(0, 0, 0, 0);

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-17T21:12:57.643

利用`-webkit-appearance: none;`

```
#yourElement:focus {
    -webkit-appearance: none;
}

#yourElement:hover {
    -webkit-appearance: none;
} 
```

它会成功的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T18:04:35.537

```
a, :visited{ 
    outline: 0;
    outline: none;
}
:hover, :active, :focus{
    outline: 0;
    outline: none;
} 
```

在 Chrome/osx、iphone/mobile safari、firefox/osx [http://jsfiddle.net/toniehock/QQGnj/6/show上为我移除了聚焦的光晕](http://jsfiddle.net/toniehock/QQGnj/6/show)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-03T13:55:09.043

在我的 Magento2 中，它是一个边框和框阴影，而不是上面的这些东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T23:01:27.057

Mobile Safari 显然没有默认`outline`样式，因此您不必担心。不过，为了保证所有浏览器、桌面和移动设备的外观一致，我建议`outline: none`无论如何设置。

# mysql - 如何使用 Zend Adapter 从数据库中检索信息

> ID：11336018
> 
> 赞同：1
> 
> 时间：2012-07-04T22:29:35.780
> 
> 标签：mysql, database, zend-framework, adapter

我试图弄清楚 Zend Adapter 的基本要素。教程和解释令人困惑，需要更多澄清。谁能给我简单的例子来完全理解如何使用 SQL 查询以及如何获得所需的 SQL 结果？

特别是，我有兴趣学习如何获得

-- 列名

-- 表名

-- 获取所有条目

等等。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T06:58:04.390

像许多其他人一样，您似乎对快速入门有困难，请尝试[Rob Allen](http://akrabat.com/zend-framework-tutorial/)的教程，它帮助我入门。

对于如何连接到表，您有多种选择，与 Zend_Db 的混淆通常从这里开始。

使用一个 DB 时最简单的方法是，在您的`application.ini`文件中至少添加以下行：

```
resources.db.adapter = "pdo_Mysql"
resources.db.params.username = "user_name"
resources.db.params.password = "password"
resources.db.params.dbname = "db_name" 
```

或者，您可以使用[Zend_Db_Adapter](http://framework.zend.com/manual/en/zend.db.adapter.html)在代码中的几乎任何地方连接到数据库：

```
//using a normal constructor
$db = new Zend_Db_Adapter_Pdo_Mysql(array(
    'host'     => '127.0.0.1',
    'username' => 'webuser',
    'password' => 'xxxxxxxx',
    'dbname'   => 'test'
));

//using factory
$db = Zend_Db::factory('Pdo_Mysql', array(
    'host'     => '127.0.0.1',
    'username' => 'webuser',
    'password' => 'xxxxxxxx',
    'dbname'   => 'test'
)); 
```

[支持的数据库列表](http://framework.zend.com/manual/en/zend.db.adapter.html)

在您的应用程序中使用它可以很简单：

```
//fetchAll using Zend_Db_Adapter and plain SQL
$sql = 'SELECT * FROM bugs WHERE bug_id = ?';

$result = $db->fetchAll($sql, 2); 
```

您可以列出数据库中的表：

```
$tables = $db->listTables(); 
```

或者您可以获得完整的表描述（包括列名），我在 Zend_Db_Adapter_Abstract 中包含了函数中的注释块：

```
 /**
     * Returns the column descriptions for a table.
     *
     * The return value is an associative array keyed by the column name,
     * as returned by the RDBMS.
     *
     * The value of each array element is an associative array
     * with the following keys:
     *
     * SCHEMA_NAME => string; name of database or schema
     * TABLE_NAME  => string;
     * COLUMN_NAME => string; column name
     * COLUMN_POSITION => number; ordinal position of column in table
     * DATA_TYPE   => string; SQL datatype name of column
     * DEFAULT     => string; default expression of column, null if none
     * NULLABLE    => boolean; true if column can have nulls
     * LENGTH      => number; length of CHAR/VARCHAR
     * SCALE       => number; scale of NUMERIC/DECIMAL
     * PRECISION   => number; precision of NUMERIC/DECIMAL
     * UNSIGNED    => boolean; unsigned property of an integer type
     * PRIMARY     => boolean; true if column is part of the primary key
     * PRIMARY_POSITION => integer; position of column in primary key
     *
     * @param string $tableName
     * @param string $schemaName OPTIONAL
     * @return array
     */
$describTable = $db->describeTable('myTable'); 
```

这些信息应该可以帮助您入门，但是我发现 Zend_Db 的许多真正强大之处在于[Zend_Db_Table](http://framework.zend.com/manual/en/zend.db.table.html)、[Zend_Db_Table_Row](http://framework.zend.com/manual/en/zend.db.table.row.html)，尤其是[Zend_Db_Select](http://framework.zend.com/manual/en/zend.db.select.html)类。

我敦促您花一些时间弄清楚它们。

作为一个例子，你可能对 Zend_Db_Table 和 Zend_Db_select 有什么期望（当不使用更高级的映射器和域对象时，希望以后会出现）：

```
//When using DbTable models that extend Zend_Db_Table_Abstract the model already 
//knows the name of the table and has full access to the Db adapter, allowing your code to
//be very brief and descriptive.
class Application_Model_DbTable_Weekend extends Zend_Db_Table_Abstract
{
    //name of table, required if classname is not the same as the table name
    protected $_name = 'weekend';
    //primary key column of table, a good idea especially if primary key is not 'id'
    protected $_primary = 'weekendid';

    public function getWeekend($weekendId) {
        //create select object
        $select = $this->select();
        $select->where('weekendid = ?', $weekendId);//placeholder syntax

        $result = $this->fetchRow($select);       
        if (!$result) {
            throw new Exception('Could not find weekend ID ' . $weekendId);
        }
        return $result;//returns a single row object
    }
    public function fetchAllWeekend() {

        $select = $this->select();

        $result = $this->fetchAll($select);

        return $result; //returns array of row objects (rowset object)
    }
} 
```

Rob Allen 的 Zf 教程将解释如何设置 DbTable 模型以及它们如何工作。

希望这可以帮助...

# tomcat - 在应用服务器上运行 maven 项目

> ID：11336021
> 
> 赞同：0
> 
> 时间：2012-07-04T22:29:42.410
> 
> 标签：tomcat, web-applications, maven, m2eclipse

我想创建一个可以在应用程序服务器上运行的 Web 项目。那么我必须选择什么原型和组ID？

提前谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T06:46:56.833

包含示例 Maven Webapp 项目的原型。

```
archetypeGroupId: org.apache.maven.archetypes
archetypeArtifactId :maven-archetype-webapp 
```

如果您偏爱某些框架/应用服务器，则可以使用以下命令获得更多选项。

```
mvn archetype:generate 
```

# haskell - 为什么将 sq 改为 point-free 会改变类型

> ID：11336031
> 
> 赞同：2
> 
> 时间：2012-07-04T22:31:07.917
> 
> 标签：haskell, pointfree, monomorphism-restriction

> **可能重复：**
> [这个 ghci 会话中的类型是怎么回事？](https://stackoverflow.com/questions/11003535/what-is-going-on-with-the-types-in-this-ghci-session)

为了尝试练习一些haskell并了解无点，我正在玩一个对数字求平方的函数

所以我开始定义

```
>let dup f x = f x x 
```

所以我可以用 dup 重写 sq （现在不用担心让 dup 点免费）

```
>let sq x = dup (*) x 
```

并检查 sq 的类型，我看到了我期望看到的

```
>:t sq
>sq :: Num t => t -> t 
```

所以我删除了x并得到

```
>let sq = dup (*)
>:t sq
sq :: Integer -> Integer 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:20:04.570

您遇到了单态性限制。Haskell 不会推断函数的多态类型，除非它们以“函数”样式（不是无点）给出。这意味着`let sq = dup (*)`不会进行类型检查，但 Haskell 对标准数值类有所谓的“默认规则”，这意味着它默认为单态类型“整数->整数”

```
Prelude> :set -XNoMonomorphismRestriction
Prelude> let dup f x = f x x
Prelude> let sq = dup (*)
Prelude> :t sq
sq :: Num t => t -> t 
```

# c - c中va_arg函数中的变量参数类型

> ID：11336032
> 
> 赞同：6
> 
> 时间：2012-07-04T22:31:14.893
> 
> 标签：c

我收到 gcc 编译器的警告，如果执行以下代码，程序将中止我不明白为什么？如果有人澄清它会很有帮助。

```
#include<stdio.h>
#include<stdarg.h>
int f(char c,...);
int main()
{
   char c=97,d=98;
   f(c,d);
   return 0;
}

int f(char c,...)
{
   va_list li;
   va_start(li,c);
   char d=va_arg(li,char); 
   printf("%c\n",d);
   va_end(li);
} 
```

GCC 告诉我这个：

```
warning: 'char’ is promoted to ‘int’ when passed through ‘...’ [enabled by default]
note: (so you should pass ‘int’ not ‘char’ to ‘va_arg’)
note: if this code is reached, the program will abort 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T22:36:16.370

可变参数函数的参数经过*默认参数提升*；任何小于 an `int`（例如`char`）的东西都会首先转换为 an `int`（然后`float`再转换为`double`）。

所以`va_arg(li,char)`永远不正确；改为使用`va_arg(li,int)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-22T16:45:08.153

是的，这似乎是 C 标准中的一个怪癖。但是，看起来这仅与`va_arg()`.

您可以查看各种实现`printf()`以了解如何克服此问题。例如，[klibc](http://git.kernel.org/cgit/libs/klibc/klibc.git/tree/usr/klibc/vsnprintf.c)中的那个很容易阅读。

# linux - 模拟内核socket编程中select()和poll()的效果

> ID：11336034
> 
> 赞同：12
> 
> 时间：2012-07-04T22:31:27.193
> 
> 标签：linux, sockets, networking, kernel, system-calls

我正在开发的 Linux 内核驱动程序之一是在内核中使用网络通信（`sock_create()`、`sock->ops->bind()`等）。

问题是会有多个套接字来接收数据。所以我需要一些可以模拟`select()`或`poll()`在内核空间中的东西。由于这些函数使用文件描述符，除非我使用系统调用来创建套接字，否则我不能使用系统调用，但这似乎没有必要，因为我在内核中工作。

所以我正在考虑将默认`sock->sk_data_ready`处理程序包装在我自己的处理程序（`custom_sk_data_ready()`）中，这将解锁一个信号量。然后我可以编写自己的`kernel_select()`函数来尝试锁定信号量并阻塞等待直到它打开。这样内核函数就会进入休眠状态，直到信号量被`custom_sk_data_ready()`. 一旦`kernel_select()`获得锁，它就会解锁并调用`custom_sk_data_ready()`重新锁定它。所以唯一的额外初始化是`custom_sk_data_ready()`在绑定套接字之前运行，这样第一次调用就`custom_select()`不会错误地触发。

我看到一个可能的问题。如果发生多次接收，则多次调用`custom_sk_data_ready()`将尝试解锁信号量。因此，为了不丢失多个调用并跟踪`sock`正在使用的调用，必须有一个指向正在使用的套接字的表或指针列表。并且`custom_sk_data_ready()`必须在表/列表中标记它通过了哪个套接字。

这个方法好听吗？或者我应该在使用标准系统调用时解决用户/内核空间问题吗？

**初步发现：**

结构中的所有回调函数`sock`都在中断上下文中调用。这意味着他们无法入睡。为了允许主内核线程在准备好的套接字列表上休眠，使用互斥锁，但`custom_sk_data_ready()`必须像互斥锁上的自旋锁一样（`mutex_trylock()`重复调用）。这也意味着任何动态分配都必须使用该`GFP_ATOMIC`标志。

* * *

额外的可能性：

对于每个打开的套接字，将每个套接字替换`sk_data_ready()`为自定义的 ( `custom_sk_data_ready()`) 并创建一个工作 ( `struct work_struct`) 和工作队列 ( `struct workqueue_struct`)。`process_msg()`每个工人都将使用一个通用功能。创建一个内核模块级全局列表，其中每个列表元素都有一个指向套接字的指针并包含工作结构。当一个socket上的数据准备好时，`custom_sk_data_ready()`会执行并找到与同一个socket匹配的list元素，然后`queue_work()`用list元素的工作队列和worker调用。然后`process_msg()`调用该函数，既可以通过`struct work_struct *`参数的内容（地址）找到匹配的列表元素，也可以使用`container_of()`宏获取保存工作结构的列表结构的地址。

哪种技术最可靠？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T04:21:24.347

你的第二个想法听起来更像是可行的。

CEPH 代码看起来像是在做类似的事情，请参阅`net/ceph/messenger.c`.

# objective-c - 使用 NSMutableSet 填充 TableView

> ID：11336037
> 
> 赞同：2
> 
> 时间：2012-07-04T22:31:49.853
> 
> 标签：objective-c, core-data, tableview, nsmutableset

我正在使用核心数据并尝试`UITableView`用`NSMutableSet`. 我有两个实体，**Teams**和**Players**。在我的`addTeamsController`我正在将一名球员保存到球队中，如下所示

```
-(void)saveButtonWasPressed {
    self.team =[NSEntityDescription insertNewObjectForEntityForName:@"Team" inManagedObjectContext:self.managedObjectContext];

    Player *newPlayer = (Player *)[NSEntityDescription insertNewObjectForEntityForName:@"Player" 
                                                                inManagedObjectContext:self.managedObjectContext];
    team.schoolName = _schoolName.text;
    team.teamName = _teamName.text;
    team.teamID = _teamName.text;
    team.season =  _season.text;
    team.headCoach = _headCoach.text;
    team.astCoach = _assistantCoach.text;

    [self.team addPlayers:_tempSet];

    [self.managedObjectContext save:nil];
    [self.navigationController popViewControllerAnimated:YES];    
} 
```

在另一个视图控制器上，我试图用该团队的球员填充一个表格视图。为此，我正在执行以下操作

```
 NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"firstName" ascending:NO];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];
_array = [[_team.players allObjects] sortedArrayUsingDescriptors:sortDescriptors]; 
```

然后在我的单元格的行和索引路径上，我正在执行以下操作

```
 cell.textLabel.text = [_array objectAtIndex:indexPath.row]; 
```

我得到了错误

```
[Player  isEqualToString:]: unrecognized selector sent to instance 
```

我想知道填充按玩家名字排序的表格视图的最佳方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:24:19.027

从核心数据存储中填充表的最佳方法是使用`NSFetchedResultController`. 但这并不能解决您遇到的问题，问题是您尝试设置`cell.textLabel.text`为`NSManagedObject`，这是行不通的。你可以设置

```
cell.textLabel.text = Player.someStringAttribute 
```

# javascript - 为什么 Eclipse 将有效的 JavaScript 标记为错误？

> ID：11336039
> 
> 赞同：3
> 
> 时间：2012-07-04T22:32:07.340
> 
> 标签：javascript, eclipse

JavaScript：

```
[a,b] = [b,a]; 
```

Eclipse 错误：

> 赋值的左边必须是变量

为了让 Eclipse 正确检查 JavaScript，我需要一些插件或其他东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:36:05.763

它仅在 Mozilla 的 JavaScript 实现中有效，例如在 Firefox 中。

从技术上讲，根据这个词的更技术定义，这是实际的*“JavaScript” ，但它目前不是有效的**“ECMAScript” ，这通常是人们在使用**“JavaScript”*这个词时所谈论的。

# delphi - 如何使用 ICompiledBinding 评估包含“Pi”常量的表达式？

> ID：11336047
> 
> 赞同：3
> 
> 时间：2012-07-04T22:34:20.897
> 
> 标签：delphi, delphi-xe2

我正在使用该`ICompiledBinding`接口来评估简单的表达式，如果我使用类似的文字`(2*5)+10`可以正常工作，但是当我尝试编译类似`2*Pi`代码的内容时会失败并出现错误：

> EEvaluatorError: 找不到 Pi

这是我当前的代码

```
{$APPTYPE CONSOLE}

uses
  System.Rtti,
  System.Bindings.EvalProtocol,
  System.Bindings.EvalSys,
  System.Bindings.Evaluator,
  System.SysUtils;

procedure Test;
Var
  RootScope : IScope;
  CompiledExpr : ICompiledBinding;
  R : TValue;
begin
  RootScope:= BasicOperators;
  //Compile('(2*5)+10', RootScope); //works
  CompiledExpr:= Compile('2*Pi', RootScope);//fails
  R:=CompiledExpr.Evaluate(RootScope, nil, nil).GetValue;
  if not R.IsEmpty then
   Writeln(R.ToString);
end;

begin
 try
    Test;
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

那么如何`Pi`使用 ICompiledBinding 接口评估包含常量的表达式呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:45:39.480

据我所知存在两种选择

1）您可以使用传递和范围的类来初始化[`IScope`](http://docwiki.embarcadero.com/Libraries/en/System.Bindings.EvalProtocol.IScope)接口。`TNestedScope``BasicOperators``BasicConstants`

**（BasicConstants 范围定义 nil、true、False 和 Pi。）**

```
Var
  RootScope : IScope;
  CompiledExpr : ICompiledBinding;
  R : TValue;
begin
  RootScope:= TNestedScope.Create(BasicOperators, BasicConstants);
  CompiledExpr:= Compile('2*Pi', RootScope);
  R:=CompiledExpr.Evaluate(RootScope, nil, nil).GetValue;
  if not R.IsEmpty then
  Writeln(R.ToString);
end; 
```

2）您可以使用这样的句子手动将 Pi 值添加到范围。

```
TDictionaryScope(RootScope).Map.Add('Pi', TValueWrapper.Create(pi)); 
```

代码看起来像这样

```
Var
  RootScope : IScope;
  CompiledExpr : ICompiledBinding;
  R : TValue;
begin
  RootScope:= BasicOperators;
  TDictionaryScope(RootScope).Map.Add('Pi', TValueWrapper.Create(pi));
  CompiledExpr:= Compile('2*Pi', RootScope);
  R:=CompiledExpr.Evaluate(RootScope, nil, nil).GetValue;
  if not R.IsEmpty then
  Writeln(R.ToString);
end; 
```

# closures - 我如何在 Go 中使用 Filepath.Walk？

> ID：11336048
> 
> 赞同：20
> 
> 时间：2012-07-04T22:34:27.203
> 
> 标签：closures, go

该`filepath.Walk`函数接受函数回调。这是没有上下文指针的直接函数。当然，一个主要的用例`Walk`是遍历一个目录并基于它采取一些行动，参考更广泛的上下文（例如，将每个文件输入到一个表中）。

如果我在 C# 中编写此代码，我将使用一个对象（具有可以指向上下文中的对象的字段）作为其上的回调（具有给定的回调方法），以便该对象可以封装`Walk`从中调用的上下文。

（编辑：用户“ [usr](https://stackoverflow.com/users/122718/usr) ”建议关闭方法也出现在 C# 中）

如果我在 C 中编写这个，我会要求一个函数和一个上下文指针，`void *`这样函数就有一个上下文指针，它可以传递给`Walk`函数并将其传递给回调函数。

但是 Go 只有函数参数，没有明显的上下文指针参数。

（如果我设计了这个函数，我会将对象作为回调而不是函数，符合接口`FileWalkerCallback`或其他，并`callback(...)`在该接口上放置一个方法。然后消费者可以在传递之前将任何上下文附加到对象到`Walk`。）

我能想到的唯一方法是在回调函数中捕获外部函数的闭包。这是我使用它的方式：

```
func ScanAllFiles(location string, myStorageThing *StorageThing) (err error) {
    numScanned = 0

    // Wrap this up in this function's closure to capture the `corpus` binding.
    var scan = func(path string, fileInfo os.FileInfo, inpErr error) (err error) {
        numScanned ++

        myStorageThing.DoSomething(path)
    }

    fmt.Println("Scan All")

    err = filepath.Walk(location, scan)

    fmt.Println("Total scanned", numScanned)

    return
} 
```

在此示例中，我创建了回调函数，因此它的闭包包含变量`numScanned`和`myStorageThing`.

这对我来说感觉不对。我认为这感觉很奇怪是对的，还是我只是习惯了写 Go？如何`filepath.Walk`以回调引用更广泛的上下文的方式使用该方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-05T16:32:04.723

你这样做是对的。您可以考虑两种小变化。一种是您可以用下划线替换未使用参数的名称。因此，在您仅使用路径的示例中，签名可以读取

```
func(path string, _ os.FileInfo, _ error) error 
```

它节省了一点打字，清理了一点代码，并清楚地表明您没有使用该参数。此外，特别是对于小型函数，通常跳过将函数文字分配给变量，而直接将其用作参数。您的代码最终会阅读，

```
err = filepath.Walk(location, func(path string, _ os.FileInfo, _ error) error {
    numScanned ++

    myStorageThing.DoSomething(path)
}) 
```

这稍微清理了范围，清楚地表明您只使用了一次闭包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:39:15.377

作为一名 C# 程序员，我可以说这正是 .NET 中这样一个 API 的*用途*。鼓励您使用闭包，不鼓励创建带有字段的显式类，因为这只会浪费您的时间。

由于 Go 支持闭包，我会说这是使用此 API 的正确方法。我看不出有什么问题。

# vb.net - 通过 VB.net 2010 将 csv 文件快速导入 access 数据库

> ID：11336052
> 
> 赞同：1
> 
> 时间：2012-07-04T22:35:07.517
> 
> 标签：vb.net, ms-access, tsv

在将大约 30,000 行数据从制表符分隔文件导入 Access 数据库时，我无法获得所需的速度。文件导入由我编写的 VB.net 2010 程序管理。

该程序当前循环遍历每一行并为每一行发出一个 SQL 插入语句。然而，这需要大约 2 小时才能完成。如果我使用 Get External Data 手动将同一个文件直接导入访问，大约需要 30 秒。

我在想我可能能够创建一个链接到 MS 访问的 datagridview 并以某种方式运行本机 .net 命令将文件导入到 datagridview 中，然后快速写入要访问的数据，但我不确定这是否可能。

顺便说一句，手动导入不是一种选择，由于各种原因，它需要通过 vb.net 应用程序。

任何人都可以就我如何加快速度提供任何建议吗？

谢谢西蒙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T09:24:18.093

您可以针对您的 MS Access 连接运行 SQL 语句以导入 text/csv。导入新表：

```
cmd.CommandText =
    "SELECT F1 AS id, F2 AS firstname " &
    "INTO MyNewTable " &
    "FROM [Text;FMT=Delimited;HDR=No;CharacterSet=850;DATABASE=C:\__tmp].table1.csv;" 
```

要导入现有表：

```
cmd.CommandText =
    "INSERT INTO MyExistingTable " &
    "SELECT F1 AS id, F2 AS firstname " &
    "FROM [Text;FMT=Delimited;HDR=No;CharacterSet=850;DATABASE=C:\__tmp].table1.csv;" 
```

您还可以将 schema.ini 文件用于非标准分隔符。（[将数据导出到预先格式化的文件](https://stackoverflow.com/questions/13255004/exporting-data-into-a-preformatted-file/13255522#13255522)中，[从访问中创建逗号分隔文件 (csv) - 每天从 Windows 安排](https://stackoverflow.com/questions/13482242/create-comma-separated-file-csv-from-access-scheduled-daily-from-windows/13483597#13483597)）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T08:27:32.107

问题是为什么要使用.Net？如果您使用较新版本的 Access，它将在 SQL 上完整运行。这允许您使用 SQL[批量插入](http://msdn.microsoft.com/en-us/library/ms188365.aspx)。批量插入使 SQL 中所有其他数据插入方法都大吃一惊。

如果您需要操作数据，您可以将原始数据批量插入堆表中（只是文件中数据的原始转储），然后使用 SQL 将相关数据更新/移动到正确的表中。

# c++ - C 包装器的成员函数的 c++ const-ness

> ID：11336055
> 
> 赞同：4
> 
> 时间：2012-07-04T22:35:29.240
> 
> 标签：c++, class, constants

我有一个对象，在最基本的层面上，它看起来像这样：

```
#include <X11/Xlib.h>

class x_link {
    public:
        x_link()
        {
            display_ = XOpenDisplay(NULL);
        }

        ~x_link()
        {
            XCloseDisplay(display_);
        }

        Display* display_ptr() const
        {
            return display_;
        }

    private:
        Display* display_;
}; 
```

我想知道在这种情况下“const”`x_link::display_ptr()`应该如何。

这个较老的问题，[如果成员函数影响逻辑状态而不是按位状态，它们应该是“const”吗？](https://stackoverflow.com/questions/5208184/should-member-functions-be-const-if-they-affect-logical-state-but-not-bitwise)，给我的印象是，由于我的方法（本身）不会影响对象的逻辑或按位状态，因此`const`是要走的路。

但同时，提供`Display*`允许用户破坏对象（例如，通过调用`XCloseDisplay()`自己），这将是非常非常规的事情。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:03:49.413

这个类看起来像一个简单的包装类，其目的主要是包装一个 C 接口。在这种情况下，我建议您根本不要使用 const 使程序复杂化。

对于对象或函数是只读的明确情况，我保留使用 const。

Const 是许多 C++ 特性之一，它经常欺骗程序员使他们的程序变得不必要地复杂。

# python - 如何将 txt 中的浮点数作为字符串转换为 Python 列表

> ID：11336056
> 
> 赞同：0
> 
> 时间：2012-07-04T22:35:30.113
> 
> 标签：python, string, list

我对编程很陌生。我有以下问题。

我想从 .txt 文件中获取一些浮点数，并将它们作为字符串添加到 Python 列表中，它们之间使用逗号，如下所示：

```
。TXT：
194220.00 38.4397984 S 061.1720742 W 0.035
194315.00 38.4398243 S 061.1721378 W 0.036

```

Python：

```
myList = ('38.4397984,061.1720742','38.4398243,061.1721378') 
```

有人知道怎么做这个吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:48:09.017

您需要三个关键部分来执行此操作。你需要知道如何[打开文件](http://docs.python.org/library/functions.html#open)，你需要知道如何在打开文件的情况下[遍历行](https://stackoverflow.com/questions/1478697/for-line-in-openfilename)，你需要知道如何[拆分列表](http://docs.python.org/library/stdtypes.html#str.split)。

一旦你知道了所有这些事情，它就像连接你想要的部分并将它们添加到你的列表中一样简单。

```
my_list = []
with open('path/to/my/file.txt') as f:
    for line in f:
        words = line.split()
        my_list.append(words[1] + words[3])
print mylist 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:45:47.427

Python 有一个方法 open(fileName, mode) 返回一个文件对象。fileName 是一个带有文件名的字符串。mode 是另一个字符串，它说明文件将如何使用。Ex 'r' 用于阅读，'w' 用于写作。

```
f = open(file.txt, 'r') 
```

这将在变量 f 中创建文件对象。f 现在有不同的方法可以用来读取文件中的数据。最常见的是 f.read(size)，其中 size 是可选的

```
text = f.read() 
```

将数据保存在变量文本中。

现在您要拆分字符串。String 是一个对象，并且有一个名为 split() 的方法，该方法从由空格分隔的字符串创建单词列表。

```
myList = text.split() 
```

在您的代码中，您给了我们一个元组，从变量名中我不确定它是否是您要查找的。确保阅读元组和列表之间的区别。查找元组的过程有点不同。

# mysql - SQL 查询具有唯一值的列

> ID：11336060
> 
> 赞同：2
> 
> 时间：2012-07-04T22:35:48.650
> 
> 标签：mysql, unique

我有一张看起来像这样的桌子

```
 courseid     session_date     title                 published
    1            2012-07-01       Training Course A     0
    1            2012-07-02       Training Course A     0
    2            2012-07-04       Training Course B     1
    2            2012-07-07       Training Course B     1
    3            2012-07-05       Training Course C     1
    3            2012-07-06       Training Course C     1
    4            2012-07-07       Training Course D     1
    4            2012-07-10       Training Course D     1 
```

该表对于每个 ID 和 Title 都有两个条目，因为 session_date 列显示了课程的开始日期和结束日期。

我正在尝试创建一个查询，该查询将提取接下来的五门课程，而不显示过去的任何课程。

我已经走到这一步了

```
 SELECT session_date, title, courseid
    FROM table
    WHERE published = 1 AND session_date > DATE(NOW())
    ORDER BY session_date ASC LIMIT 0,5 
```

这会从表中提取接下来五个会话日期的行，但它包括开始日期和结束日期，而我需要按开始日期排序的接下来的五个课程。

我需要创建一个查询，该查询将为每个 courseid 提取最早的 session_date，但忽略同一 courseid 具有最新 session_date 的行，但我完全不知道如何执行此操作。

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:38:04.107

如果您按课程分组结果并选择`MAX(session_date)`，您将获得与每门课程相关的最新日期（即完成日期）：

```
SELECT   courseid, MIN(session_date) AS start_date
FROM     `table`
WHERE    published = 1
GROUP BY courseid
HAVING   start_date > CURRENT_DATE
ORDER BY start_date ASC
LIMIT    5 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/cc5e3/6/0)上查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:47:09.637

您需要做的是仅检索`session_date`每个`courseid`组中具有最小值的行并按该结果集排序：

```
SELECT
    b.*
FROM
    (
        SELECT courseid, MIN(session_date) AS mindate
        FROM tbl
        GROUP BY courseid
    ) a
INNER JOIN
    tbl b ON a.courseid = b.courseid AND a.mindate = b.session_date
WHERE
    b.session_date > NOW() AND
    b.published = 1
ORDER BY
    b.session_date
LIMIT 5 
```

但是更好的设计是每行只有一行，`courseid`并且有两列指定开始和结束日期：

```
tbl
------------------
courseid [PK]
start_date
end_date
title
published 
```

然后你可以简单地做：

```
SELECT *
FROM tbl
WHERE start_date > NOW() AND published = 1
ORDER BY start_date
LIMIT 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T22:50:57.543

由于 SELECT 子句中所有列的值都是重复的，因此只需使用 DISTINCT

`SELECT distinct session_date, title, courseid FROM table WHERE published = 1 AND session_date > DATE(NOW()) ORDER BY session_date ASC LIMIT 0,5`

# javascript - 使用 Javascript 检测屏幕的宽度

> ID：11336061
> 
> 赞同：0
> 
> 时间：2012-07-04T22:35:57.743
> 
> 标签：javascript, width, screen

```
if(screen.availWidth > 850){
    //Do this
} else {
    //Do this   
} 
```

这就是我现在所拥有的。我现在的问题是如果有人要放大页面，我希望改变宽度，因为它会影响页面的显示方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:38:52.017

您不应该更担心有人调整浏览器窗口的大小吗？不是每个人都保持浏览器最大化。

去做这个：

```
if( (window.innerWidth || document.documentElement.clientWidth) > 850) {
    // do something
}
else {
    // do other thing
} 
```

我相当肯定这考虑了缩放，但我从未测试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:53:36.773

将事件处理程序绑定到[window.onresize 事件](http://www.w3schools.com/jsref/event_onresize.asp)：

```
window.onresize = function(event) {
    if (screen.availWidth > 850) { ... }
}; 
```

如果你使用 jQuery：

```
$(window).resize(function(){
    if ($(window).width() > 850) { ... }
}); 
```

此外，如果您想创建响应式设计，请考虑使用[CSS 媒体查询](http://www.css3.info/preview/media-queries/)。如果用户缩放或调整浏览器窗口大小，这会自动调整页面，并且如果用户停用了 JavaScript，它也可以工作。

```
/* CSS */
@media (min-width: 850px) {
    /* style */
} 
```

# c# - 如何使用反射和输出参数进行通用转换

> ID：11336070
> 
> 赞同：0
> 
> 时间：2012-07-04T22:37:14.107
> 
> 标签：c#, reflection

我有一个大字典（字符串，对象）。字典中的值具有不同的类型。只有在运行时，我才能在 (string, int) 或 (string, string) 的字典中找到确切的值类型。在运行时，我必须将字典中的值分配给它们对应的强类型对象。这是简化的问题。我正在尝试使用进行强制转换的类型化类。我有这段代码不起作用：

```
static void Main(string[] args)
{
    var values = new Dictionary<string, object> 
    { 
        { "123", "test"},
        {"12", 123}
    };
    var result = new Dictionary<string, object> ();

    Type dict = values.GetType();
    Type typedCast = typeof(TypedClass<>).MakeGenericType(new [] { dict });
    MethodInfo method = typedCast.GetMethod("GetTypedValue", 
        BindingFlags.Static | BindingFlags.Public, 
        null, 
        new[]
            {
                  typeof(object), 
                  typeof(object).MakeByRefType()
            },
        null);

    method.Invoke(null, new[]{values, result});
}

public class TypedClass<T>
{
    public static void GetTypedValue(object value, out object obj)
    {
        obj = (T)Convert.ChangeType(value, typeof(T));
    }
} 
```

在 GetTypedValue 方法中，我看到了具有正确类型的 obj 值，但在此方法之外， out 变量没有值。请让我知道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:44:17.493

将 out object obj 参数的类型更改为 out T obj

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:53:54.650

尝试更换：

```
method.Invoke(null, new[]{values, result}); 
```

和

```
var invokeArgs = new[]{values, result};
method.Invoke(null, invokeArgs);
//here you can check the invokeArgs[1] for the actual result of the conversion 
```

无论如何，我不确定您为什么要将 Dictionary 的类型转换为另一个 Dictionary，因为您的代码似乎就是这样做的...

# c++ - 具有高概率数的随机数？

> ID：11336074
> 
> 赞同：2
> 
> 时间：2012-07-04T22:38:26.723
> 
> 标签：c++, random

> **可能重复：**
> [有偏随机数生成器](https://stackoverflow.com/questions/2775578/biased-random-number-generator)

有一次，我需要一个随机数生成器，其中至少有两个数字的概率比其他数字高。

即例如：1000 序列中的随机 1->10。数字 A=3 和 B=7。

A - 应该重复大约。至少 20% 的时间。B - 应该重复大约。至少 30% 的时间。

这应该至少涵盖 1000 序列的 50%。此外，A 和 B 的插入本身应该有点可能/随机。不只是每第 N 步添加 A 和 B。不需要完全/精确控制。

有任何想法吗？

我是一个菜鸟 - c++ 风格的代码将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:49:51.013

一种方法是随机生成一个介于 0.0 和 1.0 之间的数字，然后根据该数字选择要生成的数字。例如，要实现您的示例场景（伪代码）：

```
let "result" be an array of 1000 integers
let "i" be an integer
for i = 1 to 1000:
    let "j" be a random number between 0.0 and 1.0
    if j < 0.2:
        let result[i] be 3
    else if j < 0.5:
        let result[i] be 7
    else:
        let "k" be an integer
        do, while k = 3 or k = 7:
            let "k" be a random number in the range 1 to 10
        let result[i] be k
end 
```

基本上，`j`用于将范围 1 到 10 划分为三个部分 - 一部分覆盖范围的 0% 到 20%（第一个`if`），第二个覆盖范围的 20% 到 50%（即 30% 宽，第二个`if`)，最后一个覆盖剩余的 50%。根据我们随机落入的部分，我们选择适当的数字来生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:34:18.723

您应该为此使用该`<random>`库。

```
#include <random>

#include <iostream>
#include <algorithm>
#include <iterator>

int main() {
    // create a discrete distribution where the third object has 20% probability and
    //   the seventh has 30%
    std::vector<double> probabilities(10, 5.0/8.0);
    probabilities[2] = 2.0;
    probabilities[6] = 3.0;
    std::discrete_distribution<int> dist(begin(probabilities),end(probabilities));

    // our underlying source of randomness
    std::random_device r;
    std::seed_seq seed{r(), r(), r(), r(), r(), r(), r(), r()};
    std::mt19937 eng(seed);

    // create a function object that uses the distribution and source of randomness to
    //   produce values from 1 to 10
    auto rand = [&]{ return dist(eng) + 1; };

    std::vector<int> x;

    // store 1000 random values
    for (int i=0;i<1000;++i)
        x.push_back(rand());

    // count how many of each value, to verify that 3 comes out ~200 times and 7 comes
    //   out ~300 times
    for (int i=1;i<=10;++i)
        std::cout << i << ": " << count(begin(x),end(x),i) << '\n';

    // print all the values
    copy(begin(x),end(x),std::ostream_iterator<int>(std::cout, " "));
} 
```

# mysql - 如何：查找并更新一列中的值多次显示的所有条目

> ID：11336077
> 
> 赞同：3
> 
> 时间：2012-07-04T22:38:47.237
> 
> 标签：mysql, sql

我有一个包含以下列的表格：

*   subid - 资源的 ID
*   authorid - 作者的 ID
*   排序 - 引文中作者的顺序

对于用户可以提交资源并引用多个作者的应用程序。作者可以在提交的文章中引用主要作者和次要作者，而且通常会这样做。

有一种情况，用户（称他为用户 111）提交了所有条目，将他自己列为主要作者，将实际作者列为次要作者。不幸的是，那个人已经离开了这个项目，所以我必须解决这个问题（我必须纯粹在 sql 中完成）。

我试图弄清楚如何构建查询来执行以下操作：

*   查找所有条目
*   subid 值在表中多次出现的位置
*   其中至少一个授权值是 111
*   其中 111 的排序大于任何不是 111 的用户的排序并更新它们
*   not(111) 作者的排序为“0”
*   并且 111 作者订购了“1”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:47:28.990

试试这个解决方案：

```
UPDATE tbl a
INNER JOIN
    (
        SELECT subid
        FROM tbl
        GROUP BY subid
        HAVING COUNT(*) > 1 AND SUM(author_id = 111) > 0
    ) b ON a.subid = b.subid
SET a.ordering = (a.author_id = 111) 
```

替换`tbl`为您的实际表名。

# ssis - 如何将插入和选择 sql 脚本转换为 SSIS 包源和目标？

> ID：11336083
> 
> 赞同：1
> 
> 时间：2012-07-04T22:40:31.487
> 
> 标签：ssis

我有一个存储过程，它从父过程中获取目标表和列列表并加载目标表。一切都在 proc 本身中完成。如何将 proc 的加载部分转换为 SSIS 包。这是proc中插入的部分。

* * *

```
 SET @sql_query = 'TRUNCATE TABLE [snaps].' + QUOTENAME(@table_dst)
  EXEC (@sql_query)

  --Build the query to load from SQL Server source.
  IF @src_type = 'sql_server'
    SET @sql_query = 'INSERT INTO [snaps].' + QUOTENAME(@table_dst) + ' (' + @columns_dst_real + ') '
                     + 'SELECT ' + @columns_dst_converted + ' '
                       + 'FROM ' +
                           + '(' +
                           + 'SELECT [' + REPLACE(REPLACE(@columns_src, '''', ''''''), ',', '],[') + '] '
                             + 'FROM ' + ISNULL(QUOTENAME(NULLIF(@link,'')) + '.', '') + ISNULL(QUOTENAME(NULLIF(@database,'')) + '.', '') + ISNULL(QUOTENAME(NULLIF(@schema,'')) + '.', '') + QUOTENAME(@table_src) + ' WITH (NOLOCK)'
                             + ISNULL(' WHERE ' + @where_clause, '') +
                           + ') a'

  --Build the query to load from Oracle source.
  ELSE IF @src_type = 'oracle'
    SET @sql_query = 'INSERT INTO [snaps].' + QUOTENAME(@table_dst) + ' (' + @columns_dst_real + ') '
                     + 'SELECT ' + @columns_dst_converted + ' '
                       + 'FROM OPENQUERY(' + QUOTENAME(@link) + ', '''
                         + 'SELECT ' + REPLACE(@columns_src, '''', '''''') + ' '
                           + 'FROM ' + @schema + '.' + @table_src
                           + ISNULL(' WHERE ' + REPLACE(@where_clause,'''',''''''), '') + ''')'

  --Build the query to load from a query source.
  ELSE IF @src_type = 'pass_query'
    SET @sql_query = 'INSERT INTO [snaps].' + QUOTENAME(@table_dst) + ' (' + @columns_dst_real + ') '
                     + 'SELECT ' + @columns_dst_converted + ' '
                       + 'FROM OPENQUERY(' + QUOTENAME(@link) + ', ''' + REPLACE(@query_src,'''','''''') + ''')' 
```

# objective-c - Cocoa中的菜单栏按钮面板？

> ID：11336084
> 
> 赞同：0
> 
> 时间：2012-07-04T22:40:43.717
> 
> 标签：objective-c, macos, cocoa, user-interface

当我点击菜单栏中的按钮（如“关于程序”）时，程序运行时会弹出一个新窗口显示信息。如何编辑与按钮关联的窗口？

在界面生成器中，我设法加载“主菜单”，它允许我自定义菜单栏，但它不允许我使用与按钮关联的窗口。**我将如何编辑这些窗口？**

Mac OSX 雪豹，Xcode 3.2.6

编辑：我*并不是*专门要求“关于面板”的步骤。我正在寻找用于编辑与菜单栏中的按钮关联的面板的一般过程。除了“关于”面板，我还想使用“帮助”面板等面板。**“关于”面板只是一个例子。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:07:02.313

标准的“关于”面板不在您的笔尖中；它是在框架内生成的。

您可以通过编写 Credits.rtf 或 Credits.html 文件并将其包含在您的应用程序包中来更改面板的文本。（您可能已经有项目模板提供的 Credits.rtf。如果是这样，您应该编辑它。）

如果您想进行更彻底的更改，您需要创建自己的面板并更改“关于”菜单项以显示它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T04:15:49.670

至于一般程序...不，没有单一程序可以让您以相同的方式自定义任何标准面板。它们都有自己的机制（例如，有些可以在安装插件组件时显示更多窗格；有些提供 API 来隐藏或显示某些部分；有些，例如“关于”框，使用捆绑文件名约定来决定做什么）。

特别是对于帮助面板...除了网页（即帮助内容）之外，您无法更改任何内容。工具栏等全部由苹果处理。我建议查看此文档以获取更多信息，该文档还链接到其他重要文档： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/OnlineHelp/Concepts/ComprehenHelp.html%23//apple_ref /doc/uid/20000017-BBCCFHAC](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/OnlineHelp/Concepts/ComprehenHelp.html%23//apple_ref/doc/uid/20000017-BBCCFHAC)

# ios - 单击纯 html 链接时，Apple 如何检测是否安装了 iphone 应用程序？

> ID：11336085
> 
> 赞同：2
> 
> 时间：2012-07-04T22:40:49.827
> 
> 标签：ios, url

我试图在访问我的网站时检测我的 ipad 应用程序是否安装在设备上，以便向访问者建议不同的操作。

感谢这篇文章： [https ://stackoverflow.com/a/8310348/1128754](https://stackoverflow.com/a/8310348/1128754)

我发现iphone上的“商店”应用程序似乎已经实现了检测应用程序是否安装在设备上。当您单击商店链接时，它会启动应用程序，而不是转到移动网络版本。

例如，如果您 使用安装了苹果商店应用程序的 iphone访问： [http ://store.apple.com/xc/anythinghere (](http://store.apple.com/xc/anythinghere) [http://itunes.apple.com/app/id375380948](http://itunes.apple.com/app/id375380948) )

它会自动启动商店应用程序，而不是网页。

我尝试使用 mitmproxy 跟踪堆栈调用，但 safari 在启动应用程序之前似乎没有询问查询。

所以，我猜他们使用`http://`链接进行了自定义 url 方案识别。

你认为有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:23:34.660

您无法检测应用程序是否是从 HTML 安装的，但您可以启动应用程序。比如热门游戏《涂鸦跳跃》可以通过 来启动`doodlejump://`，但是如果你没有安装，链接就失效了。如前所述，这是通过自定义 URL 方案完成的，需要将其编码到您的应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:47:43.800

这是通过 URL 协议处理程序完成的：

[http://www.iphonedevfaq.com/index.php?title=URL_schemes#URL_Protocol_Handlers](http://www.iphonedevfaq.com/index.php?title=URL_schemes#URL_Protocol_Handlers)

# javascript - 从外部页面上的元素加载属性

> ID：11336087
> 
> 赞同：0
> 
> 时间：2012-07-04T22:40:59.863
> 
> 标签：javascript, ajax, attributes, load, element

我的页面有一个链接列表，每个链接都使用 ajax 加载新页面。这些新页面包含一个图像库和一个主图像。我的目标是从主图像中获取源 URL，以在链接页面上的相应链接上显示为缩略图。

我不知道该怎么做。如果有人能指出我正确的方向，也许给我一些代码可以遵循，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:08:11.583

您可以使用 jQuery.get 加载外部页面。

```
$.get('my_external_page.html', function(data) {
  // data is the pages contents.
}); 
```

然后把它塞进一个div

```
$.get('my_external_page.html', function(data) {
  // data is the pages contents.
  var haystack = $('<div>').html(data);
  var needle = haystack.find('.image-we-want');

  var imageSrc = needle.attr('src');
}); 
```

这是一个开始。当然，它假定您可以使用 jquery，并且您要搜索的元素具有类或 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T23:49:33.410

得到它的工作。可能不是最聪明的方法，但它确实有效。

我有一个充满链接的页面（）。我在被调用的底部也有一个空的 div。代码将图标加载到这些链接。链接指向包含多个图像的新页面。这些图标是页面标准图像的缩小版本。

```
function iconPicHandler(){  
   var aTags = $('#linkpage a');
   for(var i = 0;  i < aTags.length; i++){
      $('#invisible').load('page3.html #standardImage',function(aLink){
         return function(){
            $('<img src="'+ $('#standardImage').attr("href") +'" />')
            .prependTo(aLink);
         }
      }
    ($(atags[i])));             
    }
    $('#invisible').hide();
} 
```

所以我做的第一件事就是获取链接页面中的所有链接。我将其余代码放入 for 循环中，因此我可以对所有链接执行相同操作。然后我将“#standardImage”从 page3.html 加载到“#invisible”中。#standardImage" 是一个空 div，其中包含一个指向 page3 的标准图像的缩小版本的 url。该 url 被保存为 div 的 href 属性。然后是棘手的部分。我不确定我在这里做了什么。但作为一个回调函数，我做了一个函数，它接受一个参数，在末尾指定（$（atags [i]））。这个函数然后返回一个新函数！这使我能够访问 atags（链接）和新加载的$('#standardImage')。在函数内部，我从 $('#standardImage') 中提取 href 并将其用作附加到链接的图像的 src。

如前所述，这不是一种非常聪明的方法，但它可以完成工作。谁知道呢，也许它可以帮助下一个碰巧遇到类似问题的初学者。

# php - php sql查询生成器

> ID：11336089
> 
> 赞同：1
> 
> 时间：2012-07-04T22:41:11.967
> 
> 标签：php, jquery, mysql

对于一个客户，我正在使用一个带有 Web 界面的 mysql php 数据库，我需要有一个部分，他们可以在其中构建报告并保存它们。有人对我如何使用具有 3 或 4 个连接的表执行此操作有任何建议吗？用 php 构建 pdf 的最佳方法是什么？

我的意思是向用户显示以及要问什么问题 - 我正在考虑办公室访问查询向导，也许会做类似的事情。询问他们想要显示哪些字段，什么顺序等。我只是在寻找合适的方法来做到这一点以及如何做到这一点。

感谢您对 PDF 写作的两个建议，我会研究它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:00:11.673

要在 php 中生成 pdf，我使用[fpdf](http://www.fpdf.org/)。它比某些替代方案简单、免费且功能更多。有关您的其余问题的更多帮助，我真的需要更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:00:26.670

PHP 中有一些相当不错的 PDF 库...... TCPD 非常易于使用，可以将 HTML 和呈现/输出为 PDF。

至于您关于数据库的问题，如果表总是要连接相同的 3 或 4 个表，我通常将表名或别名放在字段名的前面。如果我使用多选来允许用户选择该字段，我会这样做：

```
 <option value="mytable.first_name">First Name</option> 
```

我显然在这里做了很多假设，如果有可变数量的连接会更难，因为您必须管理表和连接条件并在适当的时候应用它们。如果我必须处理可变数量的连接，我可能会创建一个带有连接条件的数组；遍历我在上面选择的所有字段并将表格拉出。然后使用我的连接数组中的表来获取连接指令。

# php - 从 mysql 查询创建数组。Column2 作为键 Column 1 作为值

> ID：11336095
> 
> 赞同：4
> 
> 时间：2012-07-04T22:41:41.820
> 
> 标签：php, mysql

我有一张包含

```
column 1 = state  column 2 = link
Alabama             auburn.alabama.com
Alabama             bham.alabama.com
Alabama             dothan.alabama.com 
```

我需要从我的数据库表中抓取并放入一个我可以通过 array_walk() 的数组中。他们需要像这个数组一样被访问。

```
$arraytable = array(
"auburn.alabama.com"=>"Alabama",
"bham.alabama.com"=>"Alabama",
"dothan.alabama.com"=>"Alabama",
); 
```

我已经尝试了一切，但不确定如何使用 php 来打印这样的数组。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:51:48.243

**注意**您的问题标题与您的示例不一致。在标题中，您要求将第 1 列作为键，但您的示例使用第 2 列作为键。我在这里使用了第 2 列...

目前尚不清楚您使用什么 MySQL API 来获取，但无论是哪个，使用关联 fetch 方法并使用 pattern 创建新的数组键`$arraytable[$newkey] = $newvalue`。此示例将在面向对象的 MySQLi 中：

```
$arraytable = array();

while($row = $result->fetch_assoc()) {
  // Create a new array key with the 'link' and assign the 'state'
  $arraytable[$row['link']] = $row['state'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-06T01:59:31.883

您可以为此使用 array_column，因为 PHP5.5 ( [http://php.net/array_column](http://php.net/array_column) )

> 描述
> 
> 数组 array_column ( 数组 $array , 混合 $column_key [, 混合 $index_key = null ] )
> 
> array_column() 从数组的单个列中返回值，由 column_key 标识。或者，您可以提供一个 index_key 来通过输入数组中 index_key 列中的值对返回数组中的值进行索引。

对于 PHP < 5.5： [https ://github.com/ramsey/array_column/blob/master/src/array_column.php](https://github.com/ramsey/array_column/blob/master/src/array_column.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-06T00:34:56.517

为了实施 AcidReign 的建议，这里是片段：

代码：（[演示](https://3v4l.org/BBFGt)）

```
$resultset = [
    ['state' => 'Alabama', 'link' => 'auburn.alabama.com'],
    ['state' => 'Alabama', 'link' => 'bham.alabama.com'],
    ['state' => 'Alabama', 'link' => 'dothan.alabama.com']
];

var_export(array_column($resultset, 'state', 'link'));
//                                            ^^^^-- use this column's data for keys
//                                   ^^^^^-- use this column's data for values 
```

输出：

```
array (
  'auburn.alabama.com' => 'Alabama',
  'bham.alabama.com' => 'Alabama',
  'dothan.alabama.com' => 'Alabama',
) 
```

# javascript - Jquery iterate throw json

> ID：11336097
> 
> 赞同：0
> 
> 时间：2012-07-04T22:42:01.917
> 
> 标签：javascript, json, jquery

I have the following json response from server:

```
 $data=[[

    {"left":{"p1":{"x":0,"y":0},"p2":{"x":0,"y":15}},
     "right":{"p1":{"x":15,"y":0},"p2":{"x":15,"y":15}},
     "up":{"p1":{"x":0,"y":0},"p2":{"x":15,"y":0}},
     "bottom":{"p1":{"x":0,"y":15},"p2":{"x":15,"y":15}}},

    {"left":{"p1":{"x":0,"y":15},"p2":{"x":0,"y":30}},
     "right":{"p1":{"x":15,"y":15},"p2":{"x":15,"y":30}},
     "up":{"p1":{"x":0,"y":15},"p2":{"x":15,"y":15}},
     "bottom":{"p1":{"x":0,"y":30},"p2":{"x":15,"y":30}}}

    ],
[

{"left":{"p1":{"x":0,"y":0},"p2":{"x":0,"y":15}},
 "right":{"p1":{"x":15,"y":0},"p2":{"x":15,"y":15}},
 "up":{"p1":{"x":0,"y":0},"p2":{"x":15,"y":0}},
 "bottom":{"p1":{"x":0,"y":15},"p2":{"x":15,"y":15}}},

{"left":{"p1":{"x":0,"y":15},"p2":{"x":0,"y":30}},
 "right":{"p1":{"x":15,"y":15},"p2":{"x":15,"y":30}},
 "up":{"p1":{"x":0,"y":15},"p2":{"x":15,"y":15}},
 "bottom":{"p1":{"x":0,"y":30},"p2":{"x":15,"y":30}}}

]
] 
```

I would like to alert every x of p1 point in left.

```
$.getJSON("jetData",
          function(data) {
      $.each(data, function(i,item){
          alert(data[i].left.p1.x);

        }); 
      }); 
```

I'm getting

```
Uncaught TypeError: Cannot read property 'p1' of undefined 
```

How to do it correct?

**Update:**

I'm sorry I posted wrong example it just took me some time to realize that we are talking about 2x2 matrix. so I need to print value in 2 loops.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:45:01.573

Well, your data is double-enclosed in the array structure. That would require you to use `data[0][i].left.p1.x` to iterate through it (or something smarter -- hard to tell without more information about what is being serialized and how).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:45:10.750

For your updated question, you'll need a nested loop to loop both the outer and inner loops.

```
$.getJSON("jetData", function(data) {
   $.each(data, function(i,item) {
       $.each(item, function(j, inner_item) {
           alert(inner_item.left.p1.x);
        // alert(data[i][j].left.p1.x);  // same thing
       });
   }); 
}); 
```

* * *

You have 2 outer Arrays.

change this...

```
$.each(data, function(i,item){ 
```

to this...

```
$.each(data[0], function(i,item){ 
```

...so that `$.each` is iterating the array that directly contains the objects.

* * *

Not directly related, but this...

```
alert(data[i].left.p1.x); 
```

can be written as this...

```
alert(item.left.p1.x); 
```

Same thing, but a little shorter.

# ctags - Ctags - 项目和库文件的标签（具有绝对路径的多个目录）

> ID：11336101
> 
> 赞同：1
> 
> 时间：2012-07-04T22:42:42.810
> 
> 标签：ctags, exuberant-ctags

下面的目录层次结构来自 [ctags faq](http://ctags.sourceforge.net/faq.html)

我可以创建一个标签文件，绝对文件路径为

```
cd ~/project
ctags --file-scope=no -R `pwd` 
```

如何创建一个搜索我的项目的标记文件和标准库函数。例如，假设我的项目是`/sysint/client`，而库位于`/misccomp`。如何创建一个同时搜索这些目录和子目录的标记文件。（我不想在 / 下搜索所有内容）。

你认为分成 2 个标签文件更好吗？

```
`-----misccomp
  |       `...
  `-----sysint
          `-----client
          |       `-----hdrs
          |       `-----lib
          |       `-----src
          |       `-----test
          `-----common
          |       `-----hdrs
          |       `-----lib
          |       `-----src
          |       `-----test
          `-----server
                  `-----hdrs
                  `-----lib
                  `-----src
                  `-----test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:37:01.420

我认为拆分成 2 个标签文件更好。为什么：

*   我认为，您有时需要更新标签。更新较小的标签文件比更新较大的标签文件更快。因此，当您编辑项目时，只有项目的标签会更新，当您编辑 lib 时 - 只会更新 lig 的标签。而不是每次都更新所有标签；
*   在我编写插件[索引器](http://goo.gl/VTAer)时，我发现几个标签文件的工作速度并不比单个标签文件慢。

我也建议你使用这个插件[Indexer](http://goo.gl/VTAer)，它会自动完成所有工作。它提供了无痛的自动标签生成，并使标签保持最新。标签文件在后台生成，因此您不必等待。如果需要，请检查它。

**UPD：**有关详细信息，请参阅文章：[Vim：为您的项目提供方便的代码导航](http://dmitryfrank.com/articles/vim_project_code_navigation)，其中详细解释了 Indexer + Vimprj 的用法。除此之外，还解释了库的标签，这正是您想要的。

# css - 谷歌浏览器的字体

> ID：11336103
> 
> 赞同：1
> 
> 时间：2012-07-04T22:42:46.843
> 
> 标签：css, google-chrome, font-face

几天以来，我的 Google Chrome 浏览器没有显示特殊字体：CSS with font-face。

```
@font-face {
    font-family: 'Babel Sans';
    src: url('../fonts/babelsans.eot');
    src: url('../fonts/babelsans.eot?#iefix') format('eot'),
         url('../fonts/babelsans.woff') format('woff'),
         url('../fonts/babelsans.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

在 Safari、Firefox 和 IE 上一切正常，上周运行良好。有人有同样的问题，有人知道我该如何解决？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:17:49.803

它现在可以工作了，我认为谷歌已经更新了浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T13:27:05.523

自 Chrome 20 更新以来，我遇到了同样的问题。这件事发生在 Windows Xp 和 Mac Os X 10.6.8 中。Safari 和 Mobile Safari（与 Chrome 共享 WebKit 引擎）的工作方式与 Firefox 和 IE 非常相似。我的css代码和你的一模一样。查看检查器似乎没有下载字体。有时在我的网站中导航不同的页面（共享相同的 css 外部文件）时，字体会加载并正确显示。

还在努力解决这个...

编辑：

我设法解决了这个问题。我不知道为什么，但使用这个有效： [http ://www.fontsquirrel.com/fontface/generator/](http://www.fontsquirrel.com/fontface/generator/)

我上传了我的字体，得到了 css 和转换后的文件，将它们上传到我的服务器并替换了 font-face 声明......bling！有用！希望这也对你有用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T23:25:15.717

由于 Chrome 更新了大约一周，您可以尝试使用旧版本来确定它是否是一个错误（我自己没有发现任何问题）。[在http://www.oldapps.com/google_chrome.php](http://www.oldapps.com/google_chrome.php)获取一份。
除了其他与字体相关的 CSS 值之外，还要检查您是否使用此字体（如果是，请停用它们）。过去有一些问题实际上已经解决了，但你永远不知道......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-16T11:10:26.530

**首先：按照**[Stefano](https://stackoverflow.com/users/1343683/stefano) 先生的建议，使用此[服务](http://www.fontsquirrel.com/fontface/generator/)转换您的字体：

稍后使用此 CSS 代码在项目中使用您的字体：

```
@font-face {
    font-family: 'aljazeeraregular';
    src: url('aljazeera-webfont.eot');
    src: url('aljazeera-webfont.eot?#iefix') format('eot'),
         url('aljazeera-webfont.woff') format('woff'),
         url('aljazeera-webfont.ttf') format('truetype'),
         url('aljazeera-webfont.svg') format('svg');
    font-weight: normal;
    font-style: normal;

}

body {
    background-color: #eaeaea;
    font-family: 'Aljazeera';
    font-size: 14px;
} 
```

请注意，当您调用`font-family`您的站点时，您必须使用它的原始名称，而不是像您在`@font-face`.

# perl - Perl 替换以更改文件路径

> ID：11336112
> 
> 赞同：1
> 
> 时间：2012-07-04T22:45:37.207
> 
> 标签：perl, substitution

我对此感到很生气，我正在尝试更改代码中显示的目录路径，但它不起作用，我做错了什么？

我期待`$fulltitle`成为`\\mynas\data\music\FABRICLive\17 - Rhodes For D - Furney.mp3`

```
my $find = 'C:\Users\Bell';
my $replace = '\\mynas\data\music';
my $fulltitle = 'C:\Users\Bell\FABRICLive\17 - Rhodes For D - Furney.mp3';
$fulltitle =~ s/$find/$replace/;
print ("$fulltitle\n"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:50:23.203

[引用元](http://perldoc.perl.org/functions/quotemeta.html)

```
use warnings;
use strict;

my $find      = quotemeta 'C:\Users\Bell';
my $replace   = '\\mynas\data\music';
my $fulltitle = 'C:\Users\Bell\FABRICLive\17 - Rhodes For D - Furney.mp3';
$fulltitle =~ s/$find/$replace/;
print("$fulltitle\n");

__END__

\mynas\data\music\FABRICLive\17 - Rhodes For D - Furney.mp3 
```

[警告](http://perldoc.perl.org/warnings.html)会为您提供有关问题所在的线索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T04:26:33.560

用正则表达式操作路径很糟糕。

```
use Path::Class::Dir qw();
use Path::Class::File qw();
my $old = Path::Class::Dir->new_foreign('Win32', 'C:\Users\Bell');
my $new = Path::Class::Dir->new_foreign('Win32', '\\\\mynas\data\music');
my $file = Path::Class::File->new_foreign('Win32', 'C:\Users\Bell\FABRICLive\17 - Rhodes For D - Furney.mp3');
$file->relative($old)->absolute($new)->stringify
# '\\mynas\data\music\FABRICLive\17 - Rhodes For D - Furney.mp3' 
```

[您在使用UNC 路径](http://enwp.org/UNC_path)的目录的符号中犯了一个错误。字符串文字中的双反斜杠必须用反斜杠转义，这就是[语法的](http://p3rl.org/op#q%2fSTRING%2f)工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T23:18:20.293

```
my $find      = 'C:\Users\Bell';
my $replace   = '\\mynas\data\music';
my $fulltitle = 'C:\Users\Bell\FABRICLive\17 - Rhodes For D - Furney.mp3';

$fulltitle    =~ s/\Q$find\E/${replace}/;
print "$fulltitle\n"; 
```

* * *

您需要在匹配中使用`\Q`和`\E`禁用反斜杠元字符。
[键盘示例](http://codepad.org/tO4yud5m)

* * *

***注意：**替换将转换`\\`为`\`*

# c++ - D3D 文本占用了太多 RAM ..？

> ID：11336116
> 
> 赞同：0
> 
> 时间：2012-07-04T22:46:07.083
> 
> 标签：c++, text, directx, ram

我有一个 VC++ DirectX 应用程序，它可以渲染一个 3D 立方体，相机可以用 W、A、S、D 键和鼠标四处移动。在左上角，一个文本显示了当前的相机坐标；但是，在 10-15 秒后，分配的 RAM 和 CPU 增加到*1.6Gb*，几乎占总数的*50%*。只有当我启用文本时才会发生这种情况（即使移动仍然是“基于 FLOPS”的，所以无论如何有时有点“生锈”，有或没有文字打印）。

我猜想一遍又一遍地渲染文本会导致 RAM 填满，因为它不会“释放”之前写的..？

这是我的代码（有点长，我包含了所有内容，因为可能是其他内容 - 但是，我不建议您运行它，因为在最坏的情况下，它可能会冻结所有 RAM！）：

```
#include <windows.h> // form header
#include <windowsx.h> // form header 2
#include <d3d9.h> // Direct3D9 header
#include <d3dx9.h> // DirectX9 header
#include <conio.h>
#include <dinput.h> // DirectInput header
#include <math.h>
#include <string>
using namespace std;

const double PI = 3.1415926;

// include the Direct3D Library file
#pragma comment (lib, "d3d9.lib")
#pragma comment (lib, "d3dx9.lib")

// include the DirectInput8 Library file
#pragma comment (lib, "dinput8.lib")
#pragma comment (lib, "dxguid.lib")

// define the screen resolution
#define SCREEN_WIDTH  1024
#define SCREEN_HEIGHT 768

// global declarations
LPDIRECT3D9 d3d;    // the pointer to our Direct3D interface
LPDIRECT3DDEVICE9 d3ddev;    // the pointer to the device class
LPDIRECT3DVERTEXBUFFER9 v_buffer = NULL;    // the pointer to the vertex buffer
LPDIRECT3DINDEXBUFFER9 i_buffer;    // the pointer to an index buffer
LPDIRECT3DTEXTURE9 texture;    // declare a texture
LPDIRECT3DTEXTURE9 bump;

LPDIRECTINPUT8 din;    // the pointer to our DirectInput interface
LPDIRECTINPUTDEVICE8 dinkeyboard;    // the pointer to the keyboard device
LPDIRECTINPUTDEVICE8 dinmouse;    // the pointer to the mouse device
BYTE keystate[256];    // the storage for the key-information
DIMOUSESTATE mousestate;    // the storage for the mouse-information
ID3DXFont *dxfont;

VOID* pVoid;    // a void pointer

// function prototypes
void initD3D(HWND hWnd);    // sets up and initializes Direct3D
void render_frame(void);    // renders a single frame
void cleanD3D(void);    // closes Direct3D and releases memory
void init_graphics(void);    // 3D declarations
void init_light(void);    // sets up the light and the material
void initDInput(HINSTANCE hInstance, HWND hWnd);    // sets up and initializes DirectInput
void detect_input(void);    // gets the current input state
void cleanDInput(void);    // closes DirectInput and releases memory
void PrintText(char* str, int size, int x, int y, DWORD color);

inline DWORD F2DW( FLOAT f ) { return *((DWORD*)&f); } 

struct CUSTOMVERTEX {FLOAT X, Y, Z; D3DVECTOR NORMAL; FLOAT U,V;};
#define CUSTOMFVF (D3DFVF_XYZ | D3DFVF_NORMAL | D3DFVF_TEX1)

// the WindowProc function prototype
LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam);

// the entry point for any Windows program
int WINAPI WinMain(HINSTANCE hInstance,
                   HINSTANCE hPrevInstance,
                   LPSTR lpCmdLine,
                   int nCmdShow)
{
    HWND hWnd;
    WNDCLASSEX wc;

    ZeroMemory(&wc, sizeof(WNDCLASSEX));

    wc.cbSize = sizeof(WNDCLASSEX);
    wc.style = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc = WindowProc;
    wc.hInstance = hInstance;
    wc.hCursor = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)COLOR_WINDOW;
    wc.lpszClassName = L"WindowClass";
    RegisterClassEx(&wc);

    hWnd = CreateWindowEx(NULL,
                          L"WindowClass",
                          L"Our First Direct3D Program",
                          WS_OVERLAPPEDWINDOW,    // non-fullscreen values
                          0, 0,    // the starting x and y positions should be 0
                          SCREEN_WIDTH, SCREEN_HEIGHT,    // set window to new resolution
                          NULL,
                          NULL,
                          hInstance,
                          NULL);

    ShowWindow(hWnd, nCmdShow);

    // set up and initialize Direct3D
    initD3D(hWnd);
    initDInput(hInstance, hWnd);    // initialize DirectInput

    // enter the main loop:

    MSG msg;

    while(TRUE)
    {
        while(PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }

        if(msg.message == WM_QUIT)
            break;

        detect_input();    // update the input data before rendering
        render_frame();

        if(keystate[DIK_ESCAPE] & 0x80)
            PostMessage(hWnd, WM_DESTROY, 0, 0);
    }

    // clean up DirectX and COM
    cleanD3D();
    cleanDInput();    // release DirectInput

    return msg.wParam;
}

// this is the main message handler for the program
LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch(message)
    {
        case WM_DESTROY:
            {
                PostQuitMessage(0);
                return 0;
            } break;
    }

    return DefWindowProc (hWnd, message, wParam, lParam);
}

// this function initializes and prepares Direct3D for use
void initD3D(HWND hWnd)
{
    d3d = Direct3DCreate9(D3D_SDK_VERSION);    // create the Direct3D interface

    D3DPRESENT_PARAMETERS d3dpp;    // create a struct to hold various device information

    ZeroMemory(&d3dpp, sizeof(d3dpp));    // clear out the struct for use
    d3dpp.Windowed = TRUE;    // program fullscreen, not windowed
    d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;    // discard old frames
    d3dpp.hDeviceWindow = hWnd;    // set the window to be used by Direct3D
    d3dpp.BackBufferFormat = D3DFMT_X8R8G8B8;    // set the back buffer format to 32-bit
    d3dpp.BackBufferWidth = SCREEN_WIDTH;    // set the width of the buffer
    d3dpp.BackBufferHeight = SCREEN_HEIGHT;    // set the height of the buffer
    d3dpp.EnableAutoDepthStencil = TRUE;
    d3dpp.AutoDepthStencilFormat = D3DFMT_D16;

    // create a device class using this information and the info from the d3dpp stuct
    d3d->CreateDevice(D3DADAPTER_DEFAULT,
                      D3DDEVTYPE_HAL,
                      hWnd,
                      D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                      &d3dpp,
                      &d3ddev);

    d3ddev->SetRenderState(D3DRS_LIGHTING, TRUE);    // turn off the 3D lighting
    d3ddev->SetRenderState(D3DRS_ZENABLE, TRUE);    // turn on the z-buffer
    d3ddev->SetRenderState(D3DRS_AMBIENT, D3DCOLOR_XRGB(50, 50, 50));    // ambient light

    init_graphics();    // call the function to initialize the triangle
    init_light();    // call the function to initialize the light and material

    d3ddev->SetRenderState(D3DRS_LIGHTING, TRUE);    // turn on the 3D lighting
    d3ddev->SetRenderState(D3DRS_ZENABLE, TRUE);    // turn on the z-buffer
    d3ddev->SetRenderState(D3DRS_AMBIENT, D3DCOLOR_XRGB(50, 50, 50));    // ambient light
    d3ddev->SetRenderState(D3DRS_NORMALIZENORMALS, TRUE);    // handle the normal lenght
    d3ddev->SetRenderState(D3DRS_ALPHABLENDENABLE, TRUE);    // turn color blending on

    // set filters and samples
    d3ddev->SetSamplerState(0, D3DSAMP_MAXANISOTROPY, 8);
    d3ddev->SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_ANISOTROPIC);
    d3ddev->SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);
    d3ddev->SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);

    //d3ddev->SetRenderState(D3DRS_BLENDOP, D3DBLENDOP_ADD);    // set the blending operation
    //d3ddev->SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA);    // set the source blending
    //d3ddev->SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA);    // set the destination blending

    D3DXCreateTextureFromFile(d3ddev,    // the Direct3D device
                          L"brick.bmp",    // the filename of the texture
                          &texture);    // the address of the texture storage

    D3DXCreateTextureFromFile(d3ddev,
                          L"bump.bmp",
                          &bump);

    //d3ddev->SetRenderState(D3DRS_TEXTUREFACTOR, D3DCOLOR_XRGB(200, 200, 200));
//d3ddev->SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_DOTPRODUCT3);
//d3ddev->SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
//d3ddev->SetTextureStageState(0, D3DTSS_COLORARG2, D3DTA_TFACTOR);
//d3ddev->SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);
//d3ddev->SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_DIFFUSE);

//d3ddev->SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);
//d3ddev->SetTextureStageState(1, D3DTSS_COLORARG1, D3DTA_CURRENT);
//d3ddev->SetTextureStageState(1, D3DTSS_COLORARG2, D3DTA_TEXTURE);
//d3ddev->SetTextureStageState(1, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);
//d3ddev->SetTextureStageState(1, D3DTSS_ALPHAARG1, D3DTA_DIFFUSE); 

d3ddev->SetTextureStageState(2, D3DTSS_COLOROP, D3DTOP_DISABLE);
d3ddev->SetTextureStageState(2, D3DTSS_ALPHAOP, D3DTOP_DISABLE);

//D3DXAssembleShaderFromFile("shader1.fx", 0 , NULL, &pCode, NULL );

}

// Hypotenuse function
float hypo(float x,float y)
{
float hypo=sqrt(x*x+y*y);
return hypo;
}

// this is the function used to render a single frame
void render_frame(void)
{
    // clear the window to a specified color
    d3ddev->Clear(0, NULL, D3DCLEAR_TARGET, D3DCOLOR_XRGB(0, 0, 0), 1.0f, 0);
    d3ddev->Clear(0, NULL, D3DCLEAR_ZBUFFER, D3DCOLOR_XRGB(0, 0, 0), 1.0f, 0);

    d3ddev->BeginScene();    // begins the 3D scene     

    d3ddev->SetFVF(CUSTOMFVF);    // tells Direct3D what FVF code we are using currently

        // set the texture
    d3ddev->SetTexture(1, bump);
    d3ddev->SetTexture(0, texture);

    ///////

    D3DXMATRIX matTranslateA;    // a matrix to store the translation for triangle A
    D3DXMATRIX matTranslateB;    // a matrix to store the translation for triangle B
    D3DXMATRIX matRotate;    // a matrix to store the rotation for each triangle
    D3DXMATRIX matRotate2;
    D3DXMATRIX matScale;
    static float index = 0.0f; // left movement (A)
    static float index2 = 10.0f; // upward movement (PRIOR)
    static float index3 = 18.0f; // backward movement (S) -- 1.0f
    static float index4 = 0.0f; // left lookAt
    static float index5 = 10.0f; // upward lookAt
    static float index6 = 18.0f; // backward lookAt

    // camera variables
    static float radius = 30.00f;
    static float theta  = (3.0f * D3DX_PI) / 2.0f;
    static float phi = D3DX_PI/2;
    float Cx, Cy, Cz;
    static int field = 45;
    float slide = 0.001f;
    static float dist1 = fabs(index-index4);
    static float dist2 = fabs(index2-index5);
    static float dist3 = fabs(index3-index6);

    // player movements

    // mouse movements
    field -= 0.01 * mousestate.lZ;
    theta += slide * mousestate.lX;
    phi -= slide * mousestate.lY;

    if(phi >= (D3DX_PI/9) * 8)
    {           
        phi = (D3DX_PI/9) * 8;
    }
    if(phi <= (D3DX_PI/9))
    {           
        phi = (D3DX_PI/9);
    }

    Cx = radius * cosf(theta) * sinf(phi);
    Cy = radius * cosf(phi);
    Cz = radius * sinf(theta) * sinf(phi);

    float mov = radius*0.012;
    float mov1 = Cz*0.012;
    float mov2 = -Cx*0.012;

    // previous index. values
    float indexb = index;
    float index3b = index3;

    //if (GetAsyncKeyState(VK_SHIFT))    // --- 0.06f/0.03f
    //{
        if (keystate[DIK_A] & 0x80)
        {
            index=index-mov1;
            index3=index3+mov2;
        }
        if (keystate[DIK_D] & 0x80)
        {
            index=index+mov1;
            index3=index3-mov2;
        }
        if (keystate[DIK_PRIOR] & 0x80)  // up +
        {
            index2+=0.22f;
        }
        if (keystate[DIK_NEXT] & 0x80)  // down -
        {
            index2-=0.22f;
        }
        if (keystate[DIK_W] & 0x80) // prior
        {
            index3=index3+mov1;
            index=index+mov2;
        }
        if (keystate[DIK_S] & 0x80)  // next
        {
            index3=index3-mov1;
            index=index-mov2;
        }
        if (keystate[DIK_SPACE] & 0x80)  // next
        {
            // JUMP!!!!!!!!!!!!
        }

        if (hypo(index-indexb,index3-index3b)>mov)
        {
            index=indexb+0.7071*(index-indexb);
            index3=index3b+0.7071*(index3-index3b);
        }

        // print a text
        char msg1[64], msg2[64], msg3[64];
        sprintf (msg1, "X axis: %f", index);
        sprintf (msg2, "Z axis: %f", index3);
        PrintText(msg1, 20, 30, 30, D3DCOLOR_XRGB(255,255,255));
        PrintText(msg2, 20, 30, 60, D3DCOLOR_XRGB(255,255,255));

    //}
    /*else

    if (GetAsyncKeyState(VK_LEFT))
    {
        index+=0.06f;
        index4+=0.06f;
    }
    if (GetAsyncKeyState(VK_RIGHT))
    {
        index-=0.06f;
        index4-=0.06f;
    }
    if (GetAsyncKeyState(VK_PRIOR))
    {
        index2-=0.06f;
        index5-=0.06f;
    }
    if (GetAsyncKeyState(VK_NEXT))
    {
        index2+=0.06f;
        index5+=0.06f;
    }
    if (GetAsyncKeyState(VK_UP))
    {
        index3-=0.03f;
        index6-=0.06f;
    }
    if (GetAsyncKeyState(VK_DOWN))
    {
        index3+=0.03f;
        index6+=0.06f;
    }*/

    // build MULTIPLE matrices to translate the model and one to rotate
    D3DXMatrixTranslation(&matTranslateA, 0.0f, 0.0f, 0.0f);
    //D3DXMatrixTranslation(&matTranslateB, 0.0f, 0.0f, -3.0f);
    D3DXMatrixRotationY(&matRotate, 0.0f);    // the front side --- index
    D3DXMatrixRotationX(&matRotate2, 0.0f);    // index2
    D3DXMatrixScaling(&matScale, 1.0f, 1.0f, 1.0f);    // index3

    ///////

    D3DXMATRIX matView;    // the view transform matrix

    D3DXMatrixLookAtLH(&matView,
                       &D3DXVECTOR3 (index, index2, index3),    // the camera position --- (0.0f, 10.0f, 18.0f)
                       &D3DXVECTOR3 (index-Cx, index2-Cy, index3+Cz),    // the look-at position --- (0.0f, 0.0f, 0.0f)
                       &D3DXVECTOR3 (0.0f, 1.0f, 0.0f));    // the up direction

    d3ddev->SetTransform(D3DTS_VIEW, &matView);    // set the view transform to matView

    D3DXMATRIX matProjection;     // the projection transform matrix

    D3DXMatrixPerspectiveFovLH(&matProjection,
                               D3DXToRadian(field),    // the horizontal field of view
                               (FLOAT)SCREEN_WIDTH / (FLOAT)SCREEN_HEIGHT, // aspect ratio
                               1.0f,    // the near view-plane
                               100.0f);    // the far view-plane

    d3ddev->SetTransform(D3DTS_PROJECTION, &matProjection);    // set the projection

     // tell Direct3D about each world transform, and then draw another triangle

    d3ddev->SetTransform(D3DTS_WORLD, &(matTranslateA * matRotate * matRotate2 * matScale));

    ///////

    /// select the vertex and index buffers to use
    d3ddev->SetStreamSource(0, v_buffer, 0, sizeof(CUSTOMVERTEX));
    d3ddev->SetIndices(i_buffer);

    // draw the cube
    d3ddev->DrawIndexedPrimitive(D3DPT_TRIANGLELIST, 0, 0, 24, 0, 12);

    d3ddev->EndScene();    // ends the 3D scene

    d3ddev->Present(NULL, NULL, NULL, NULL);   // displays the created frame on the screen
}

// this is the function that cleans up Direct3D and COM
void cleanD3D(void)
{
    v_buffer->Release();    // close and release the vertex buffer
    //i_buffer->Release();    // close and release the index buffer
    texture->Release();    // close and release the texture
    d3ddev->Release();    // close and release the 3D device
    d3d->Release();    // close and release Direct3D
}

// this is the function that puts the 3D models into video RAM
void init_graphics(void)
{
    // create the vertices using the CUSTOMVERTEX struct
    CUSTOMVERTEX vertices[] =
    {
        { -3.0f, -3.0f, 3.0f, 0.0f, 0.0f, 1.0f, 0.0f, 0.0f },    // side 1
        { 3.0f, -3.0f, 3.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f },
        { -3.0f, 3.0f, 3.0f, 0.0f, 0.0f, 1.0f, 0.0f, 1.0f },
        { 3.0f, 3.0f, 3.0f, 0.0f, 0.0f, 1.0f, 1.0f, 1.0f },

        { 3.0f, -3.0f, -3.0f, 0.0f, 0.0f, -1.0f, 0.0f, 0.0f },    // side 2
        { -3.0f, -3.0f, -3.0f, 0.0f, 0.0f, -1.0f, 1.0f, 0.0f },
        { 3.0f, 3.0f, -3.0f, 0.0f, 0.0f, -1.0f, 0.0f, 1.0f },
        { -3.0f, 3.0f, -3.0f, 0.0f, 0.0f, -1.0f, 1.0f, 1.0f },

        { -3.0f, 3.0f, -3.0f, 0.0f, 1.0f, 0.0f, 0.0f, 0.0f },    // side 3
        { -3.0f, 3.0f, 3.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f },
        { 3.0f, 3.0f, -3.0f, 0.0f, 1.0f, 0.0f, 0.0f, 1.0f },
        { 3.0f, 3.0f, 3.0f, 0.0f, 1.0f, 0.0f, 1.0f, 1.0f },

        { -3.0f, -3.0f, -3.0f, 0.0f, -1.0f, 0.0f, 0.0f, 0.0f },    // side 4
        { 3.0f, -3.0f, -3.0f, 0.0f, -1.0f, 0.0f, 1.0f, 0.0f },
        { -3.0f, -3.0f, 3.0f, 0.0f, -1.0f, 0.0f, 0.0f, 1.0f },
        { 3.0f, -3.0f, 3.0f, 0.0f, -1.0f, 0.0f, 1.0f, 1.0f },

        { 3.0f, -3.0f, 3.0f, 1.0f, 0.0f, 0.0f, 0.0f, 0.0f },    // side 5
        { 3.0f, -3.0f, -3.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f },
        { 3.0f, 3.0f, 3.0f, 1.0f, 0.0f, 0.0f, 0.0f, 1.0f },
        { 3.0f, 3.0f, -3.0f, 1.0f, 0.0f, 0.0f, 1.0f, 1.0f },

        { -3.0f, -3.0f, -3.0f, -1.0f, 0.0f, 0.0f, 0.0f, 0.0f },    // side 6
        { -3.0f, -3.0f, 3.0f, -1.0f, 0.0f, 0.0f, 1.0f, 0.0f },
        { -3.0f, 3.0f, -3.0f, -1.0f, 0.0f, 0.0f, 0.0f, 1.0f },
        { -3.0f, 3.0f, 3.0f, -1.0f, 0.0f, 0.0f, 1.0f, 1.0f },
    };

    // create a vertex buffer interface called v_buffer
    d3ddev->CreateVertexBuffer(24*sizeof(CUSTOMVERTEX),
                               0,
                               CUSTOMFVF,
                               D3DPOOL_MANAGED,
                               &v_buffer,
                               NULL);

    VOID* pVoid;    // a void pointer

    // lock v_buffer and load the vertices into it
    v_buffer->Lock(0, 0, (void**)&pVoid, 0);
    memcpy(pVoid, vertices, sizeof(vertices));
    v_buffer->Unlock();

    // create the indices using an int array
    short indices[] =
    {
        0, 1, 2,    // side 1
        2, 1, 3,
        4, 5, 6,    // side 2
        6, 5, 7,
        8, 9, 10,    // side 3
        10, 9, 11,
        12, 13, 14,    // side 4
        14, 13, 15,
        16, 17, 18,    // side 5
        18, 17, 19,
        20, 21, 22,    // side 6
        22, 21, 23,
    };

    // create an index buffer interface called i_buffer
    d3ddev->CreateIndexBuffer(36*sizeof(short),
                              0,
                              D3DFMT_INDEX16,
                              D3DPOOL_MANAGED,
                              &i_buffer,
                              NULL);

    // lock i_buffer and load the indices into it
    i_buffer->Lock(0, 0, (void**)&pVoid, 0);
    memcpy(pVoid, indices, sizeof(indices));
    i_buffer->Unlock();
}

// this is the function that sets up the lights and materials
void init_light(void)
{
    D3DLIGHT9 light;    // create the light struct
    D3DMATERIAL9 material;    // create the material struct

    ZeroMemory(&light, sizeof(light));    // clear out the light struct for use
    light.Type = D3DLIGHT_POINT;    // make the light type 'point light'
    light.Diffuse = D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f);    // set the light's color
    //light.Specular = D3DXCOLOR(5.5f, 5.5f, 5.5f, 1.0f);
    light.Position = D3DXVECTOR3(10.0f, 10.0f, 5.0f);
    light.Range = 100.0f;
    //light.Direction = D3DXVECTOR3(-1.0f, -0.3f, -1.0f);

    light.Attenuation0 = 0.0f;    // constant attenuation
    light.Attenuation1 = 0.0f;    // inverse attenuation
    light.Attenuation2 = 0.01f;    // square inverse attenuation

    d3ddev->SetLight(0, &light);    // send the light struct properties to light #0
    d3ddev->LightEnable(0, TRUE);    // turn on light #0

    ZeroMemory(&material, sizeof(D3DMATERIAL9));    // clear out the struct for use
    material.Diffuse = D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f);    // set diffuse color
    material.Ambient = D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f);    // set ambient color

    d3ddev->SetMaterial(&material);    // set the globably-used material to &material
}

// this is the function that initializes DirectInput
void initDInput(HINSTANCE hInstance, HWND hWnd)
{
    // create the DirectInput interface
    DirectInput8Create(hInstance,    // the handle to the application
                       DIRECTINPUT_VERSION,    // the compatible version
                       IID_IDirectInput8,    // the DirectInput interface version
                       (void**)&din,    // the pointer to the interface
                       NULL);    // COM stuff, so we'll set it to NULL

    // create the keyboard device
    din->CreateDevice(GUID_SysKeyboard,    // the default keyboard ID being used
                      &dinkeyboard,    // the pointer to the device interface
                      NULL);    // COM stuff, so we'll set it to NULL
    din->CreateDevice(GUID_SysMouse,
                      &dinmouse,
                      NULL);

    // set the data format to keyboard format
    dinkeyboard->SetDataFormat(&c_dfDIKeyboard);
    dinmouse->SetDataFormat(&c_dfDIMouse);

    // set the control you will have over the keyboard
    dinkeyboard->SetCooperativeLevel(hWnd, DISCL_NONEXCLUSIVE | DISCL_FOREGROUND);
    dinmouse->SetCooperativeLevel(hWnd, DISCL_EXCLUSIVE | DISCL_FOREGROUND);
}

// this is the function that gets the latest input data
void detect_input(void)
{
    // get access if we don't have it already
    dinkeyboard->Acquire();
    dinmouse->Acquire();

    // get the input data
    dinkeyboard->GetDeviceState(256, (LPVOID)keystate);
    dinmouse->GetDeviceState(sizeof(DIMOUSESTATE), (LPVOID)&mousestate);
}

// this is the function that closes DirectInput
void cleanDInput(void)
{
    dinkeyboard->Unacquire();    // make sure the keyboard is unacquired
    dinmouse->Unacquire();    // make sure the mouse in unacquired
    din->Release();    // close DirectInput before exiting
}

void PrintText(char* str, int size, int x, int y, DWORD color)
{
    static RECT textbox;
    SetRect(&textbox, x, y, SCREEN_WIDTH, SCREEN_HEIGHT);
    D3DXCreateFont(d3ddev,    // the D3D Device
                   size,    // font height
                   0,    // default font width
                   FW_NORMAL,    // font weight
                   1,    // not using MipLevels
                   false,    // italic font
                   DEFAULT_CHARSET,    // default character set
                   OUT_DEFAULT_PRECIS,    // default OutputPrecision,
                   DEFAULT_QUALITY,    // default Quality
                   DEFAULT_PITCH | FF_DONTCARE,    // default pitch and family
                   L"Arial",    // use Facename Arial
                   &dxfont);    // the font object
    dxfont->DrawTextA(NULL,
                      str,
                      strlen(str),
                      &textbox,
                      DT_LEFT | DT_TOP,
                      color);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T07:47:10.160

不要在每次打印文本时都创建新的字体对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T11:18:20.610

正如 stefan 所发布的，每次`PrintText`调用该函数时都会创建一个新字体。

解决此问题的一种方法是将 D3DXCreateFont 函数调用移动到函数中，并向`initD3D`函数添加匹配项。`dxfont->Release();``cleanD3D`

# android - 如何单击 TableLayout 中的特定 TableRow

> ID：11336117
> 
> 赞同：2
> 
> 时间：2012-07-04T22:46:13.647
> 
> 标签：android, xamarin.android, tablelayout, tablerow

我制作了自己的复合控件，该控件使用 TableLayout 显示数据网格，并根据绑定到它的对象数组以编程方式在循环中添加 Tablerows，现在我想选择具有特定数据的特定行以供使用一个方法。那么我怎样才能选择一个特定的行来检索它的数据来委托一个方法呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T03:08:50.287

嗨，你可以尝试这样的事情，

```
 // create a new TableRow

    TableRow row = new TableRow(this);
    row.setClickable(true);  //allows you to select a specific row

    row.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            v.setBackgroundColor(Color.GRAY);
            System.out.println("Row clicked: " + v.getId());

           //get the data you need
           TableRow tablerow = (TableRow)v.getParent();
           TextView sample = (TextView) tablerow.getChildAt(2);
           String result=sample.getText().toString();
        }
    }); 
```

有关更多信息，请参阅[Android TableRow](http://developer.android.com/reference/android/widget/TableRow.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-02T14:54:29.600

我尝试了 Parth Doshi 的答案，发现它不太正确。in的`view`参数`onClick`是 a `TableRow`，所以`v.getParent()`调用的时候会返回一个`TableLayout`对象，所以转换成 的时候会抛出异常`TableRow`。因此，对我有用的代码是：

```
tableRow.setClickable(true);  //allows you to select a specific row

tableRow.setOnClickListener(new OnClickListener() {
      public void onClick(View view) {
        TableRow tablerow = (TableRow) view; 
        TextView sample = (TextView) tablerow.getChildAt(1);
        String result=sample.getText().toString();

        Toast toast = Toast.makeText(myActivity, result, Toast.LENGTH_LONG);
        toast.show();
    }
}); 
```

# asp.net-mvc - 如何从 MVC 4 中的 ExceptionContext 加载关联实体？

> ID：11336118
> 
> 赞同：0
> 
> 时间：2012-07-04T22:46:27.123
> 
> 标签：asp.net-mvc, exception-handling, asp.net-mvc-4

我有一个异常过滤器，用于检查并发问题 ( `DbUpdateConcurrencyException`)。

我想向用户显示存储在数据库中的当前值，如果他们继续保存，他们将覆盖这些值。

当我处理`ExceptionContext`我的方法的参数时，我`OnException`只有一个分离的实体，`exception.Entries.Single()`因此对于外键列，我可以显示的最佳消息是

```
The current value for PersonId is 23123\. 
```

如何获取相关实体并显示

```
'The current value for Person is John Smith'. 
```

即显示 的性质`Person.Name`。

# iphone - 何时调用 gainPermanentIDsForObjects:？

> ID：11336120
> 
> 赞同：19
> 
> 时间：2012-07-04T22:46:41.417
> 
> 标签：iphone, objective-c, ios, core-data

我目前遇到一个问题，即在后台子线程（其父线程是主 UI 线程上下文）上创建一个新对象并保存导致我`NSFetchedResultsController`显示两个新对象：一个带有临时对象`objectID`，一个带有永久对象`objectID`。这似乎是某种错误，除非我遗漏了什么。

所以我想我会为我创建的任何新对象手动获取永久 ID。这修复了重复行问题，但引入了新的随机错误（例如“无法满足对象的错误”，指的是我创建的新对象）。如果有人对前面提到的任何事情发生的原因有任何想法，请分享。

我猜`obtainPermanentIDs`这是朝着正确方向迈出的一步。但是我什么时候调用这个方法呢？在保存到子上下文之前？在救了孩子之后，在父母之前？在父母之后？目前我的设置是这样的：

```
masterMOC - private queue tied to the persistent store, so physical saves happen here
----mainMOC - main queue tied to the UI, child of masterMOC
-------backgroundMOC - private queue, child of mainMOC 
```

因此，如果我在 上创建一个新对象`backgroundMOC`，并且打算立即保存到磁盘（这意味着我必须在所有三个上下文中调用 save:），我应该在哪里调用`obtainPermanentIDs`？

（或者如果有人有不同的解决方案，而不是调用获取永久 ids？这个方法是为了解决什么问题？我为什么要调用这个方法？）

**更新：** 我想我知道发生了什么（虽然这只是一个理论），但不知道如何解决它。当对象物理保存到磁盘时，Core Data 显然会为对象生成永久 ID。所以在我的情况下，直到我在 masterMOC 上调用 save 才会发生这种情况。目前我在 backgroundMOC 上创建新对象时所做的是：

1.  保存在 backgroundMOC 上（以便将更改向上推送到 mainMOC 并且我的表格视图可以插入新行）
2.  保存在 mainMOC 上（以便我可以准备保存到磁盘）
3.  保存在 masterMOC 上（最终保存到磁盘）

这里发生的情况是，在 backgroundMOC 上调用 save 会触发 UI 更新，并导致获取的结果控制器插入一个仍然只有一个临时 ID 的新对象。但是随后在 masterMOC 上调用 save 会导致所有对象都获得分配的永久 ID，这会导致另一个 UI 更新，为这个“新”对象插入另一行！通过注释掉最后一次 masterMOC 保存，我不再看到重复的条目。我在这里做错了什么，还是这是某种错误？

**另一个更新：**我想我已经基本确认了这个错误。我在 backgroundMOC 上调用 save ，然后设置一个计时器在 5 秒后在 mainMOC 和 masterMOC 上调用 save 。保存到 backgroundMOC 后，立即在我的表中插入了一个新行。5 秒后（保存 main 和 master），插入另一个新行。（首先插入的行具有临时 ID，最新插入的行具有永久 ID）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T19:57:14.080

我遇到了完全相同的问题，当然，在调试所有内容以发现问题是临时 ID 的特别困难和令人沮丧的一天之后。:)

我和你有完全相同的结构，我也有 NSManagedObjectContext 的子类来编码我期望在后台和主上下文中保存的行为——即，在后台上下文中保存应该保存主上下文（主上下文应该同步任何与外部服务更改的对象，这无关紧要，但值得一提，以解释为什么我有两个子类），并且在主上下文中保存应该保存主上下文。

在我的 RFSImportContext 子类（相当于你的 backgroundMOC）中，我实现`- save:`调用`[super save:]`，然后调用`[self.parentContext performBlock:]`（这里的 self.parentContext 相当于你的 mainM）C，其中块调用`obtainPermanentIDsForObjects:`主上下文`- updatedObjects`和`- insertedObjects`数组的内容，然后我保存主语境。

正如您所描述的，我不再将临时对象泄漏到我的 NSFetchedResultsController 中。稍微改善这种情况的一种方法是使用 RFSMainContext 子类（同样，相当于您的 mainMOC）来实现`- save:`获取永久对象 ID，保存自身，然后保存主上下文。这规定了我们总是希望主上下文在保存时具有其中对象的永久 ID 的行为。

# multithreading - 多线程程序在 _multiple_ CPU 上变得无响应，但在单个 CPU 上正常（更新 ListView 时）

> ID：11336123
> 
> 赞同：7
> 
> 时间：2012-07-04T22:47:33.987
> 
> 标签：multithreading, winapi, visual-c++, icons, deadlock

### 更新：我已经重现了这个问题！向下滚动以查看代码。

### 快速笔记

*   我的 Core i5 CPU 有 2 个内核，超线程。

*   如果我打电话`SetProcessAffinityMask(GetCurrentProcess(), 1)`，**一切都很好**，*即使*程序仍然是多线程的。

*   如果我*不*这样做，*并且*程序在 Windows XP 上运行（在 Windows 7 x64 上*很好*！），我的 GUI 在我滚动列表视图和加载图标时开始锁定几秒钟。

### 问题

基本上，当我在 Windows XP（Windows 7 很好）上运行下面发布的程序（我的原始代码的简化版本）时，*除非*我为所有线程强制使用*相同的逻辑 CPU* ，否则程序 UI 开始滞后半秒或者。

（**注意**：这里对这篇文章进行了很多编辑，因为我进一步调查了这个问题。）

请注意，线程数是相同的——*只是关联掩码*不同。

我已经尝试过使用两种不同的消息传递方法：内置的`GetMessage`以及我自己的`BackgroundWorker`.

结果？`BackgroundWorker` *受益*于 1 个逻辑 CPU 的亲和性（几乎没有延迟），而`GetMessage`完全受此*伤害（延迟现在长达几秒）。*

我无法弄清楚为什么会发生这种情况——多个 CPU 不应该比单个 CPU工作*得更好吗？！*
当线程数相同时，为什么会有这样的延迟？

* * *

### 更多统计：

`GetLogicalProcessorInformation`返回：

```
0x0: {ProcessorMask=0x0000000000000003 Relationship=RelationProcessorCore ...}
0x1: {ProcessorMask=0x0000000000000003 Relationship=RelationCache ...}
0x2: {ProcessorMask=0x0000000000000003 Relationship=RelationCache ...}
0x3: {ProcessorMask=0x0000000000000003 Relationship=RelationCache ...}
0x4: {ProcessorMask=0x000000000000000f Relationship=RelationProcessorPackage ...}
0x5: {ProcessorMask=0x000000000000000c Relationship=RelationProcessorCore ...}
0x6: {ProcessorMask=0x000000000000000c Relationship=RelationCache ...}
0x7: {ProcessorMask=0x000000000000000c Relationship=RelationCache ...}
0x8: {ProcessorMask=0x000000000000000c Relationship=RelationCache ...}
0x9: {ProcessorMask=0x000000000000000f Relationship=RelationCache ...}
0xa: {ProcessorMask=0x000000000000000f Relationship=RelationNumaNode ...} 
```

* * *

### 编码

下面的代码应该在 Windows XP SP3 上显示此问题。（至少，它可以在我的电脑上！）

比较这两个：

*   正常运行程序，然后滚动。你应该看到滞后。

*   `affinity`使用命令行参数运行程序，*然后*滚动。它应该几乎完全光滑。

为什么会发生这种情况？

```
#define _WIN32_WINNT 0x502

#include <tchar.h>
#include <Windows.h>
#include <CommCtrl.h>

#pragma comment(lib, "kernel32.lib")
#pragma comment(lib, "comctl32.lib")
#pragma comment(lib, "user32.lib")

LONGLONG startTick = 0;

LONGLONG QPC()
{ LARGE_INTEGER v; QueryPerformanceCounter(&v); return v.QuadPart; }

LONGLONG QPF()
{ LARGE_INTEGER v; QueryPerformanceFrequency(&v); return v.QuadPart; }

bool logging = false;
bool const useWindowMessaging = true;   // GetMessage() or BackgroundWorker?
bool const autoScroll = false;   // for testing

class BackgroundWorker
{
    struct Thunk
    {
        virtual void operator()() = 0;
        virtual ~Thunk() { }
    };
    class CSLock
    {
        CRITICAL_SECTION& cs;
    public:
        CSLock(CRITICAL_SECTION& criticalSection)
            : cs(criticalSection)
        { EnterCriticalSection(&this->cs); }
        ~CSLock() { LeaveCriticalSection(&this->cs); }
    };
    template<typename T>
    class ScopedPtr
    {
        T *p;
        ScopedPtr(ScopedPtr const &) { }
        ScopedPtr &operator =(ScopedPtr const &) { }
    public:
        ScopedPtr() : p(NULL) { }
        explicit ScopedPtr(T *p) : p(p) { }
        ~ScopedPtr() { delete p; }
        T *operator ->() { return p; }
        T &operator *() { return *p; }
        ScopedPtr &operator =(T *p)
        {
            if (this->p != NULL) { __debugbreak(); }
            this->p = p;
            return *this;
        }
        operator T *const &() { return this->p; }
    };

    Thunk **const todo;
    size_t nToDo;
    CRITICAL_SECTION criticalSection;
    DWORD tid;
    HANDLE hThread, hSemaphore;
    volatile bool stop;
    static size_t const MAX_TASKS = 1 << 18;  // big enough for testing

    static DWORD CALLBACK entry(void *arg)
    { return ((BackgroundWorker *)arg)->process(); }

public:
    BackgroundWorker()
        : nToDo(0), todo(new Thunk *[MAX_TASKS]), stop(false), tid(0),
        hSemaphore(CreateSemaphore(NULL, 0, 1 << 30, NULL)),
        hThread(CreateThread(NULL, 0, entry, this, CREATE_SUSPENDED, &tid))
    {
        InitializeCriticalSection(&this->criticalSection);
        ResumeThread(this->hThread);
    }

    ~BackgroundWorker()
    {
        // Clear all the tasks
        this->stop = true;
        this->clear();
        LONG prev;
        if (!ReleaseSemaphore(this->hSemaphore, 1, &prev) ||
            WaitForSingleObject(this->hThread, INFINITE) != WAIT_OBJECT_0)
        { __debugbreak(); }
        CloseHandle(this->hSemaphore);
        CloseHandle(this->hThread);
        DeleteCriticalSection(&this->criticalSection);
        delete [] this->todo;
    }

    void clear()
    {
        CSLock lock(this->criticalSection);
        while (this->nToDo > 0)
        {
            delete this->todo[--this->nToDo];
        }
    }

    unsigned int process()
    {
        DWORD result;
        while ((result = WaitForSingleObject(this->hSemaphore, INFINITE))
            == WAIT_OBJECT_0)
        {
            if (this->stop) { result = ERROR_CANCELLED; break; }
            ScopedPtr<Thunk> next;
            {
                CSLock lock(this->criticalSection);
                if (this->nToDo > 0)
                {
                    next = this->todo[--this->nToDo];
                    this->todo[this->nToDo] = NULL;  // for debugging
                }
            }
            if (next) { (*next)(); }
        }
        return result;
    }

    template<typename Func>
    void add(Func const &func)
    {
        CSLock lock(this->criticalSection);
        struct FThunk : public virtual Thunk
        {
            Func func;
            FThunk(Func const &func) : func(func) { }
            void operator()() { this->func(); }
        };
        DWORD exitCode;
        if (GetExitCodeThread(this->hThread, &exitCode) &&
            exitCode == STILL_ACTIVE)
        {
            if (this->nToDo >= MAX_TASKS) { __debugbreak(); /*too many*/ }
            if (this->todo[this->nToDo] != NULL) { __debugbreak(); }
            this->todo[this->nToDo++] = new FThunk(func);
            LONG prev;
            if (!ReleaseSemaphore(this->hSemaphore, 1, &prev))
            { __debugbreak(); }
        }
        else { __debugbreak(); }
    }
};

LRESULT CALLBACK MyWindowProc(
    HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    enum { IDC_LISTVIEW = 101 };
    switch (uMsg)
    {
        case WM_CREATE:
        {
            RECT rc; GetClientRect(hWnd, &rc);

            HWND const hWndListView = CreateWindowEx(
                WS_EX_CLIENTEDGE, WC_LISTVIEW, NULL,
                WS_CHILDWINDOW | WS_VISIBLE | LVS_REPORT |
                LVS_SHOWSELALWAYS | LVS_SINGLESEL | WS_TABSTOP,
                rc.left, rc.top, rc.right - rc.left, rc.bottom - rc.top,
                hWnd, (HMENU)IDC_LISTVIEW, NULL, NULL);

            int const cx = GetSystemMetrics(SM_CXSMICON),
                cy = GetSystemMetrics(SM_CYSMICON);

            HIMAGELIST const hImgList =
                ImageList_Create(
                    GetSystemMetrics(SM_CXSMICON),
                    GetSystemMetrics(SM_CYSMICON),
                    ILC_COLOR32, 1024, 1024);

            ImageList_AddIcon(hImgList, (HICON)LoadImage(
                NULL, IDI_INFORMATION, IMAGE_ICON, cx, cy, LR_SHARED));

            LVCOLUMN col = { LVCF_TEXT | LVCF_WIDTH, 0, 500, TEXT("Name") };
            ListView_InsertColumn(hWndListView, 0, &col);
            ListView_SetExtendedListViewStyle(hWndListView,
                LVS_EX_DOUBLEBUFFER | LVS_EX_FULLROWSELECT | LVS_EX_GRIDLINES);
            ListView_SetImageList(hWndListView, hImgList, LVSIL_SMALL);

            for (int i = 0; i < (1 << 11); i++)
            {
                TCHAR text[128]; _stprintf(text, _T("Item %d"), i);
                LVITEM item =
                {
                    LVIF_IMAGE | LVIF_TEXT, i, 0, 0, 0,
                    text, 0, I_IMAGECALLBACK
                };
                ListView_InsertItem(hWndListView, &item);
            }

            if (autoScroll)
            {
                SetTimer(hWnd, 0, 1, NULL);
            }

            break;
        }
        case WM_TIMER:
        {
            HWND const hWndListView = GetDlgItem(hWnd, IDC_LISTVIEW);
            RECT rc; GetClientRect(hWndListView, &rc);
            if (!ListView_Scroll(hWndListView, 0, rc.bottom - rc.top))
            {
                KillTimer(hWnd, 0);
            }
            break;
        }
        case WM_NULL:
        {
            HWND const hWndListView = GetDlgItem(hWnd, IDC_LISTVIEW);
            int const iItem = (int)lParam;
            if (logging)
            {
                _tprintf(_T("@%I64lld ms:")
                    _T(" Received: #%d\n"),
                    (QPC() - startTick) * 1000 / QPF(), iItem);
            }
            int const iImage = 0;
            LVITEM const item = {LVIF_IMAGE, iItem, 0, 0, 0, NULL, 0, iImage};
            ListView_SetItem(hWndListView, &item);
            ListView_Update(hWndListView, iItem);
            break;
        }
        case WM_NOTIFY:
        {
            LPNMHDR const pNMHDR = (LPNMHDR)lParam;
            switch (pNMHDR->code)
            {
            case LVN_GETDISPINFO:
                {
                    NMLVDISPINFO *const pInfo = (NMLVDISPINFO *)lParam;
                    struct Callback
                    {
                        HWND hWnd;
                        int iItem;
                        void operator()()
                        {
                            if (logging)
                            {
                                _tprintf(_T("@%I64lld ms: Sent:     #%d\n"),
                                    (QPC() - startTick) * 1000 / QPF(),
                                    iItem);
                            }
                            PostMessage(hWnd, WM_NULL, 0, iItem);
                        }
                    };
                    if (pInfo->item.iImage == I_IMAGECALLBACK)
                    {
                        if (useWindowMessaging)
                        {
                            DWORD const tid =
                                (DWORD)GetWindowLongPtr(hWnd, GWLP_USERDATA);
                            PostThreadMessage(
                                tid, WM_NULL, 0, pInfo->item.iItem);
                        }
                        else
                        {
                            Callback callback = { hWnd, pInfo->item.iItem };
                            if (logging)
                            {
                                _tprintf(_T("@%I64lld ms: Queued:   #%d\n"),
                                    (QPC() - startTick) * 1000 / QPF(),
                                    pInfo->item.iItem);
                            }
                            ((BackgroundWorker *)
                             GetWindowLongPtr(hWnd, GWLP_USERDATA))
                                ->add(callback);
                        }
                    }
                    break;
                }
            }
            break;
        }

        case WM_CLOSE:
        {
            PostQuitMessage(0);
            break;
        }
    }
    return DefWindowProc(hWnd, uMsg, wParam, lParam);
}

DWORD WINAPI BackgroundWorkerThread(LPVOID lpParameter)
{
    HWND const hWnd = (HWND)lpParameter;
    MSG msg;
    while (GetMessage(&msg, NULL, 0, 0) > 0 && msg.message != WM_QUIT)
    {
        if (msg.message == WM_NULL)
        {
            PostMessage(hWnd, msg.message, msg.wParam, msg.lParam);
        }
    }
    return 0;
}

int _tmain(int argc, LPTSTR argv[])
{
    startTick = QPC();
    bool const affinity = argc >= 2 && _tcsicmp(argv[1], _T("affinity")) == 0;
    if (affinity)
    { SetProcessAffinityMask(GetCurrentProcess(), 1 << 0); }

    bool const log = logging;  // disable temporarily
    logging = false;

    WNDCLASS wndClass =
    {
        0, &MyWindowProc, 0, 0, NULL, NULL, LoadCursor(NULL, IDC_ARROW),
        GetSysColorBrush(COLOR_3DFACE), NULL, TEXT("MyClass")
    };
    HWND const hWnd = CreateWindow(
        MAKEINTATOM(RegisterClass(&wndClass)),
        affinity ? TEXT("Window (1 CPU)") : TEXT("Window (All CPUs)"),
        WS_OVERLAPPEDWINDOW | WS_VISIBLE, CW_USEDEFAULT, CW_USEDEFAULT,
        CW_USEDEFAULT, CW_USEDEFAULT, NULL, NULL, NULL, NULL);

    BackgroundWorker iconLoader;
    DWORD tid = 0;
    if (useWindowMessaging)
    {
        CreateThread(NULL, 0, &BackgroundWorkerThread, (LPVOID)hWnd, 0, &tid);
        SetWindowLongPtr(hWnd, GWLP_USERDATA, tid);
    }
    else { SetWindowLongPtr(hWnd, GWLP_USERDATA, (LONG_PTR)&iconLoader); }

    MSG msg;
    while (GetMessage(&msg, NULL, 0, 0) > 0)
    {
        if (!IsDialogMessage(hWnd, &msg))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }

        if (msg.message == WM_TIMER ||
            !PeekMessage(&msg, NULL, 0, 0, PM_NOREMOVE))
        { logging = log; }
    }

    PostThreadMessage(tid, WM_QUIT, 0, 0);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T17:34:17.713

根据您在[http://ideone.com/fa2fM](http://ideone.com/fa2fM)上发布的线程间时间，这里似乎存在公平问题。仅基于此假设，以下是我对感知滞后的明显原因和问题的潜在解决方案的推理。

看起来window proc在一个线程上生成和处理了大量`LVN_GETDISPINFO`消息，虽然后台工作线程能够跟上并以相同的速率将消息发布回窗口，但它发布的WM_NULL消息排在队列中很远，以至于需要时间才能得到处理。

`LVN_GETDISPINFO`当您设置处理器关联掩码时，您会在系统中引入更多公平性，因为同一个处理器必须为两个线程提供服务，这将限制相对于非关联情况生成消息的速率。这意味着当您发布 WM_NULL 消息时，window proc 消息队列可能没有那么深，这反过来意味着它们将被“更快”处理。

看来您需要以某种方式绕过排队效应。使用`SendMessage`,`SendMessageCallback`或`SendNotifyMessage`代替`PostMessage`可能是执行此操作的方法。在这种`SendMessage`情况下，您的工作线程将阻塞，直到窗口 proc 线程完成其当前消息并处理发送的 WM_NULL 消息，但您将能够更均匀地将 WM_NULL 消息注入消息处理流。有关排队与非排队消息处理的说明，请参阅[此页面。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644927%28v=vs.85%29.aspx#routing)

如果您选择使用`SendMessage`，但由于 的阻塞性质，您不想限制获取图标的速率`SendMessage`，那么您可以使用第三个线程。您的 I/O 线程会将消息发布到第三个线程，而第三个线程用于`SendMessage`将图标更新注入 UI 线程。通过这种方式，您可以控制满意的图标请求队列，而不是将它们交错到窗口 proc 消息队列中。

至于 Win7 和 WinXP 之间的行为差​​异，可能有很多原因导致您在 Win7 上看不到这种效果。可能是列表视图公共控件的实现方式不同，并限制了生成 LVN_GETDISPINFO 消息的速率。或者也许 Win7 中的线程调度机制更频繁或更公平地切换线程上下文。

**编辑：**

根据您的最新更改，尝试以下操作：

```
...

                struct Callback 
                { 
                    HWND hWnd; 
                    int iItem; 
                    void operator()() 
                    { 
                        if (logging) 
                        { 
                            _tprintf(_T("@%I64lld ms: Sent:     #%d\n"), 
                                (QPC() - startTick) * 1000 / QPF(), 
                                iItem); 
                        } 
                        SendNotifyMessage(hWnd, WM_NULL, 0, iItem); // <----
                    } 
                }; 

...

DWORD WINAPI BackgroundWorkerThread(LPVOID lpParameter) 
{ 
    HWND const hWnd = (HWND)lpParameter; 
    MSG msg; 
    while (GetMessage(&msg, NULL, 0, 0) > 0 && msg.message != WM_QUIT) 
    { 
        if (msg.message == WM_NULL) 
        { 
            SendNotifyMessage(hWnd, msg.message, msg.wParam, msg.lParam); // <----
        } 
    } 
    return 0; 
} 
```

**编辑2：**

在使用而不是确定`LVN_GETDISPINFO`消息被放入队列后，我们不能使用自己绕过它们。`SendMessage``PostMessage``SendMessage`

仍然假设在从工作线程发回图标结果之前，wndproc 正在处理大量消息，我们需要另一种方法来在这些更新准备好后立即处理它们。

这是想法：

1.  工作线程将结果放入一个同步的类似队列的数据结构中，然后发布（使用`PostMessage`）一条 WM_NULL 消息到 wndproc（以确保 wndproc 在将来的某个时间执行）。

2.  在 wndproc 的顶部（在 case 语句之前），UI 线程检查同步的类似队列的数据结构以查看是否有任何结果，如果有，则从类似队列的数据结构中移除一个或多个结果并处理他们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T23:49:36.693

该问题与线程亲和性关系不大，而与告诉列表视图每次更新时它都需要更新列表项有关。因为您没有在处理程序中添加`LVIF_DI_SETITEM`标志，**并且**因为您手动调用，所以当您调用 时，列表视图会使仍然设置为的任何项目无效。`pInfo->item.mask``LVN_GETDISPINFO`**`ListView_Update``ListView_Update``iImage``I_IMAGECALLBACK`**

 **您可以通过以下两种方式之一（或两者结合）来解决此问题：

1.  `WM_NULL`从您的处理程序中删除 ListView_Update 。当您设置它们时，列表视图将自动重绘您在`WM_NULL`处理程序中为其设置图像的项目，并且它不会尝试重绘您多次未设置图像的项目。

2.  在您的处理程序中设置`LVIF_DI_SETITEM`标志并设置为 not 的值。`pInfo->item.mask``LVN_GETDISPINFO``pInfo->item.iImage``I_IMAGECALLBACK`

我重现了在 Vista 上进行整页滚动的类似可怕行为。执行上述任一操作都可以解决问题，同时仍异步更新图标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-15T01:27:45.850

*   有理由认为这与 XP 的超线程/逻辑核心调度有关，我将支持 IvoTops 的建议，在禁用超线程的情况下尝试此操作。请试试这个并告诉我们。

    为什么？因为：

    a) 逻辑内核为 CPU 密集型任务提供了糟糕的并行性。在同一个物理内核上的两个逻辑 HT 内核上运行多个 CPU 绑定线程会损害性能。例如，请参阅[这篇 intel 论文](http://software.intel.com/en-us/articles/hyper-threading-be-sure-you-know-how-to-correctly-measure-your-servers-end-user-response-time-1/)- 它解释了启用 HT 可能如何导致典型的服务器线程导致每个请求的延迟或处理时间*增加（同时**提高*净吞吐量。）

    b) Windows 7 确实有一些 HT/SMT（对称多线程）调度改进。[Mark Russinovich 的幻灯片在这里](http://channel9.msdn.com/Events/TechEd/NorthAmerica/2010/WCL404)简要提到了这一点。尽管他们声称 XP 调度程序支持 SMT，但事实上 Windows 7 明确修复了一些问题，这意味着 XP 可能缺少一些东西。所以我猜测操作系统没有适当地将线程关联设置为第二个核心。（可能是因为第二个核心在调度第二个线程的那一刻可能不会空闲，因此推测）。

*   您写道“我只是尝试将进程（甚至单个线程）的 CPU 亲和性设置为我能想到的所有可能的组合，在相同和不同的逻辑 CPU 上”。

    一旦你设置了这个，我们可以尝试验证执行实际上是在第二个核心上吗？

    您可以在任务管理器或 perfmon/perf 计数器中直观地检查这一点

    也许发布您设置线程亲和性的代码（我注意到您没有检查 SetProcessorAffinity 上的返回值，也请检查。）

    如果 Windows 性能计数器没有帮助，英特尔的 VTune 性能分析器对这类东西很有帮助。

    我认为您可以使用任务管理器手动强制线程关联。

还有一件事：您的核心 i5 是 Nehalem 或 SandyBridge 微架构。Nehalem 和后来的 HT 实现与前一代架构（Core 等）有很大不同。事实上，Microsoft 建议禁用 HT 以在 Nehalem 之前的系统上运行 Biztalk 服务器。所以也许 Windows XP 不能很好地处理新的 HT 架构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T18:09:34.770

这可能是一个超线程错误。要检查这是否是导致它在关闭超线程的情况下运行错误程序的原因（在 bios 中，您通常可以将其关闭）。在过去五年中，我遇到了两个问题，只有在启用超线程时才会出现。**

# php - 根据点击事件向url添加变量

> ID：11336129
> 
> 赞同：0
> 
> 时间：2012-07-04T22:48:49.017
> 
> 标签：php, html, css, url, variables

让我先简要概述一下我的目标：我希望建立一个基于颜色的密码。更详细地说，有一个 750x150 像素的框，其中填充了两行 150x150 的正方形。这些方块中的每一个都被随机分配了 10 种颜色中的一种。目标是让用户以与预设相同的顺序单击这些颜色。

我已经构建了css和html，并且确定每个div背景颜色的php已经完成。我现在遇到的问题是如何确定用户选择的 div（以及颜色）以及它们被选择的顺序。

我的目标是必须将颜色代码添加到 url，但我不知道该怎么做。有人可以解释如何做到这一点或另一种方法来组织用户对颜色的选择吗？

此外，发生的另一个问题是，我将如何确保显示每种颜色，但在随机 div 中？目前有些不会显示，因为其他人最终会出现在两个 div 中。

目前我的整个文档都在一页中，因此 div 颜色的变量可以用于索引中的某些 if 语句

因此，如果您对我有任何建议或代码，请提供帮助！

索引.php：

```
 <?php "session_start" ?>
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>colorlock</title>
 </head>

 <style media="screen" type="text/css">

 <?php

 $background_colors = array(
 "#FFFF00",
 "#FF3399",
 "#FF0000",
 "#990099",
 "#66FFFF",
 "#339900",
 "#000000",
 "#000033",
 "#FFFFCC",
 "#FF3399", 
 );

 $rand_background1 = $background_colors[array_rand($background_colors)];
 $rand_background2 = $background_colors[array_rand($background_colors)];
 $rand_background3 = $background_colors[array_rand($background_colors)];
 $rand_background4 = $background_colors[array_rand($background_colors)];
 $rand_background5 = $background_colors[array_rand($background_colors)];
 $rand_background6 = $background_colors[array_rand($background_colors)];
 $rand_background7 = $background_colors[array_rand($background_colors)];
 $rand_background8 = $background_colors[array_rand($background_colors)];
 $rand_background9 = $background_colors[array_rand($background_colors)];
 $rand_background10 = $background_colors[array_rand($background_colors)];

 ?>  

  #full {  
  height: 300px;
  width: 750px;

 } 

 #boxone1 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background1?>; 
 float: left;
 } 

 #boxone2 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background2?>; 
 float: left;
 } 
 #boxone3 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background3?>; 
 float: left;
 } 
 #boxone4 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background4?>; 
 float: left;
 } 
 #boxone5 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background5?>; 
 float: left;
 } 

 #boxtwo1 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background6?>; 
 float: left;
 } 

 #boxtwo2 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background7?>; 
 float: left;
 } 
 #boxtwo3 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background8?>; 
 float: left;
 } 
 #boxtwo4 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background9?>; 
 float: left;
 } 
 #boxtwo5 {  
 height: 150px;
 width: 150px;
 background: <?=$rand_background10?>; 
 float: left;
 } 

 </style>

  <body>

  <div id="full">

  <div id="boxone1" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxone2" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxone3" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxone4" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxone5" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxtwo1" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxtwo2" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxtwo3" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxtwo4" onclick="window.location='?name='+this.id" style=""></div>

  <div id="boxtwo5" onclick="window.location='?name='+this.id" style=""></div>
  </div>
  </div>

  <?php

  if( $rand_background5 == $rand_background6)
{
  echo ("that was lucky!");
}
  else 
  {
  echo ("that was expected!");
  }

  ?>

  </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:14:35.530

您是否特别需要跟踪 URL 中的点击？如果没有，最好在 JS 数组中静默跟踪进度

```
var sequence = [];
$('#full > div').on('click', function() {
    sequence.push($(this).attr('id'));
}); 
```

然后，单击 3 次后，数组中将有 3 个条目`sequence`- 3 个 DIV 的 ID。

至于确保每种颜色只输出一次，这里的技巧不仅是从数组中拉出一个随机条目，而是在之后将其从数组中删除，这样就不会再次被选中。

因此，如果您稍后需要引用颜色数组，您可能需要先获取它的副本。

```
$cols = array('#f00', '#00f', '#0f0', '#d70');
function getRandomColour() {
    global $cols;
    $num_cols = count($cols);
    $rand = array_rand($cols);
    $rand_col = $cols[$rand];
    echo $rand_col;
    unset($cols[$rand]);
}

echo getRandomColour(); 
```

# javascript - getElementsByTag 不起作用

> ID：11336132
> 
> 赞同：0
> 
> 时间：2012-07-04T22:49:02.260
> 
> 标签：javascript, xml, xml-parsing

嗨，所以我在桌面上的文件夹中有一个 XML 文档，我正在尝试读取标签名称为“cuisine”的所有元素。

这是我的代码：

```
if(window.XMLHttpRequest){
    xmlhttp = new XMLHttpRequest();
}else{
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

xmlhttp.open("GET","data.xml", false);
xmlhttp.send()
xmlData = xmlhttp.responseXML;

cuisineList = xmlData.getElementsByTagName("cuisine");
document.getElementById("test").innerHTML = cuisineList.length; 
```

当我打印出它的长度时`cuisineList`它说它为零。

这是我的 XML 文档：

```
<?xml version="1.0" encoding"ISO-8859-1"?>
<food>
    <cuisine type="Chinese">
    </cuisine>
    <cuisine type="Indian">

    </cuisine>
</food> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:02:47.527

我认为您的文档中有错误（编码属性中缺少“=”）。

# solr - 其中一台从属服务器上的 SOLR 复制失败

> ID：11336134
> 
> 赞同：0
> 
> 时间：2012-07-04T22:49:29.980
> 
> 标签：solr, indexing, replication

我们在 tomacat 上的 Windows 2008 环境中有 4 个从属服务器，并且复制工作正常有一段时间了，它开始在其中一个节点上失败，我首先看到以下错误，看起来像是权限问题，但我比较了两个节点，它们似乎是相同，此节点上没有任何变化。

```
SEVERE: SnapPull failed 
org.apache.solr.common.SolrException: Unable to rename: D:\solr\core0\conf\compoundwords-de.txt to: D:\solr\core0\conf\compoundwords-de.txt.20120703165100
SEVERE: SnapPull failed 
org.apache.solr.common.SolrException: Failed to create temporary config folder: conf.20120705004320 
```

我什至尝试重新启动节点以删除任何挂起的锁，但它没有解决问题，我可以做任何事情来解决问题并找到真正的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-07T05:40:20.027

我面临同样的问题：

`SEVERE: SnapPull failed org.apache.solr.common.SolrException: Failed to create temporary config folder: conf.20120705004320`

`catalina.out`在试图弄清楚为什么 Solr 管理 UI 显示在复制期间正在传输的文件之后，我碰巧注意到了 tomcat 中的这个错误，但是从属服务器上的索引版本和生成在复制后没有得到更新。事实上，在我的例子中，slave 的 version 和 gen 比 master 上的更高（Solr 4.2.1）！

问题是 solr `conf`dir 的父目录的所有者（包含 schema.xml、solrconfig.xml 等的那个）。Solr 想在 dir`conf.20120705004320`所在的位置创建一个临时的 conf 目录，其名称与 dir 完全相同`conf`。

一旦我将父文件夹的所有者更改为`tomcat6`复制开始工作正常。我使用了`chown -R tomcat6:tomcat6 /var/solr`/var/solr 是我的`${solr.home}`. 在此修复之后，从站的版本和生成开始跟随主站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T21:02:35.137

经过一些故障排除后，我终于解决了这个问题，我们发现从那时起复制开始失败，Java 更新失败。这是我们为解决此问题所做的工作

1.  重新安装 JRE
2.  尝试重新启动 Solr，并删除了所有索引文件，但它不起作用
3.  我们继续删除核心并再次设置核心，它开始像以前一样工作

# android - 适用于标准类兼容 USB 设备的 Android USB 主机模式“软模式”驱动程序

> ID：11336135
> 
> 赞同：37
> 
> 时间：2012-07-04T22:49:40.213
> 
> 标签：android, usb, driver, device-driver

现在[Android API 支持直接使用 USB 设备](http://developer.android.com/guide/topics/connectivity/usb/host.html)（自 3.1 起），我很好奇是否有任何工作为一些更流行的类兼容设备（如音频或 HID）创建“软模式”驱动程序.

换句话说，是否有任何开源项目可以将与特定设备类的更有用的通信封装到可以添加到 Android 项目中的 Java 类中？

就我的目的而言，我对 USB 音频特别感兴趣，但似乎社区构建的一组源自 Linux 内核模块源的类可能对许多项目有益。我希望其他人也有同样的想法并且已经开始工作。任何指向这个方向的指针都将不胜感激。

* * *

我偶然发现的其他一些资源：

*   [从设备到主机的用户模式 ​​USB 同步传输](https://stackoverflow.com/questions/7964315/user-mode-usb-isochronous-transfer-from-device-to-host)
*   [Audio Evolution](http://www.extreamsd.com/)似乎以某种方式构建了自己的用户区驱动程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T15:40:02.207

我已经开始在用户空间中通过 USB 开发 IRDA 驱动程序堆栈。我正在研究基本的管道，但据我所知，如果我可以创建与 linux 内核驱动程序（例如 STIR4200 驱动程序）等效的用户空间驱动程序，那么我“应该”然后能够移植现有的 IRDA 协议栈，例如作为 JIR。

我们会看到...

# ruby-on-rails - 搜索类似匹配的哈希结果 rails 3

> ID：11336137
> 
> 赞同：0
> 
> 时间：2012-07-04T22:50:01.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, search, hash

我正在使用 Facebook API 来提取我所有朋友的列表。但是，我不想将结果存储在数据库中。我只想获取我返回的结果哈希并对结果执行选择。

但是，我很难做到这一点......

我得到这样的结果......

```
[{"name"=>"John Smith", "id"=>"12345"}, {"name"=>"Jane Doe", "id"=>"23456"}, {"name"=>"Samuel Jackson", "id"=>"34567"}, {"name"=>"Kate Upton", "id"=>"45678"}] 
```

它们存储在@friends

我的选择是：

```
@friends.select{|key, hash| hash["name"] == "John Smith" } 
```

但我不断收到错误“nil:NilClass 的未定义方法 `[]'”

两个问题： 1\. 如何让哈希搜索返回 John Smith（不存储在数据库中，并且不修改初始 Facebook API 查询） 2\. 是否可以使用“Like”而不是“==”以便它返回包含单词的结果？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:01:03.990

你得到`"undefined method [] for nil:NilClass"`是因为你错误地使用了方法[选择](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-select)。尝试这样做：

```
 @friends.select{ |hash| hash["name"] == "John Smith" } 
```

所以我相信这回答了你的第一个问题。您不需要在数据库中存储任何内容，而是在实例变量中存储任何内容`@friends`，并正确使用 select。

关于第二个问题，我相信你应该研究正则表达式，因为它真的取决于你所说的“喜欢”是什么意思，但如果你说你想要：

> 它返回包含单词的结果？

好吧，如果你想检查一个特定的词（比如说**Smith**），你可以这样选择：

```
@friends.select{ |hash| hash["name"].include? "Smith" } 
```

这将为您提供数组中**名称中包含****Smith**一词的所有元素。

# c# - 处理隧道自定义路由事件

> ID：11336140
> 
> 赞同：1
> 
> 时间：2012-07-04T22:50:21.870
> 
> 标签：c#, wpf, events, tunnel, routed

我目前正在尝试 C# WPF 自定义路由事件，但遇到了问题。这就是我想要做的：我想从我的主窗口触发一个自定义路由事件，该事件通过堆栈面板隧道到由 Button 类派生的自定义控件。然后自定义控件处理路由事件。

我的问题是当我触发事件时，处理程序从未被调用过。

我的代码：

```
 public partial class MainWindow : Window
        {

        public static readonly RoutedEvent MyRoutedEvent = EventManager.RegisterRoutedEvent("MyRoutedEvent", RoutingStrategy.Tunnel, typeof(RoutedEventHandler), typeof(UIElement));

        public static void AddMyRoutedEventHandler(DependencyObject d, RoutedEventHandler handler)
        {
            UIElement uie = d as UIElement;
            if (uie != null)
            {
                uie.AddHandler(MainWindow.MyRoutedEvent, handler);
            }
        }

        public static void RemoveMyRoutedEventHandler(DependencyObject d, RoutedEventHandler handler)
        {
            UIElement uie = d as UIElement;
            if (uie != null)
            {
                uie.RemoveHandler(MainWindow.MyRoutedEvent, handler);
            }
        }

        public MainWindow()
        {
            InitializeComponent();
        }

        private void keyClassButton1_MyRoutedEvent(object sender, RoutedEventArgs e)
        {
            Console.Write("\nMyRoutedEvent!");
        }

        private void Window_MouseDown(object sender, MouseButtonEventArgs e)
        {
            RoutedEventArgs newEventArgs = new RoutedEventArgs(MyRoutedEvent, this);
            RaiseEvent(newEventArgs);
        }
    } 
```

XAML 代码：

```
<Window x:Class="RoutedEvent_Test.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:RoutedEvent_Test"
        Title="MainWindow" Height="350" Width="525" MouseDown="Window_MouseDown">
    <Grid>
        <StackPanel Name="stackPanel1">
            <local:KeyClass x:Name="keyClass1" Content="key class button" Height="30" local:MainWindow.MyRoutedEvent="keyClassButton1_MyRoutedEvent"></local:KeyClass>
        </StackPanel>
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T18:57:23.907

好的，我自己想出来了：虽然我已经读了一千遍了，但它在 MSDN 描述中清楚地说明了：

> 隧道：最初，调用元素树根处的事件处理程序。**然后，路由事件沿着路由穿过**连续的子元素，到达作为路由事件源的节点元素（**引发路由事件的元素**）。[...]

我对隧道路由事件的第一个想法是：我从主窗口触发一个事件，它通过堆栈面板到达按钮元素。 **但改为：** 您必须已经从按钮触发它 - 然后它从根元素（主窗口）开始，并通过控制层到达首先触发事件的按钮元素。

我所做的是：我从主窗口触发了事件，所以它不能去其他任何地方

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:26:14.670

此注册似乎不正确：

```
public static readonly RoutedEvent MyRoutedEvent = EventManager.RegisterRoutedEvent("MyRoutedEvent", RoutingStrategy.Tunnel, typeof(RoutedEventHandler), typeof(UIElement)); 
```

您需要`public event ReoutedEventHandler MyRoutedEvent`在此处注册的类中添加 。这应该是非静态类实例级处理程序。我在你的代码上没有看到。

你需要在 MainWindow 上这样的东西：

```
public event RoutedEventHandler MyRoutedEvent; 
```

[请参阅此处的 MSDN 示例。](http://msdn.microsoft.com/en-us/library/system.windows.routedevent.aspx)

# android - 禁止“您希望浏览器记住...”-WebView 窗口吗？

> ID：11336147
> 
> 赞同：3
> 
> 时间：2012-07-04T22:51:23.710
> 
> 标签：android, webview

我使用`WebView`. 一旦表单被（自动）提交，通常的“你想让浏览器记住这个密码吗？” 出现，我想禁止，因为登录应该自动发生。

我试过 无济于事。
`webView.getSettings().setSavePassword(true);
webView.getSettings().setSaveFormData(true);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:29:53.203

我通过使用解决了这个问题

`webView.getSettings().setSavePassword(false);
webView.getSettings().setSaveFormData(false);`

这（在我看来）非常违反直觉，但可以完成工作，因为它特别*不*要求用户保存表单数据（也不会保存它）。

# ruby-on-rails-3 - Rails 3 中的身份验证系统。设计/omniauth 还是自编码？

> ID：11336148
> 
> 赞同：1
> 
> 时间：2012-07-04T22:51:27.933
> 
> 标签：ruby-on-rails-3, authentication

我是 ROR 开发的新手。我正在尝试在 Ruby on Rails 教程第 2 版的帮助下创建自己的应用程序。我做了很多研究。我需要您对设计或任何其他身份验证系统的评论，或者这本书提供我们编写自己的身份验证系统。

你有什么想法？编写自己的身份验证系统是否浪费时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:09:21.033

我自己对 RoR 很陌生，但到目前为止我使用的是 Devise（根据我目前正在阅读的书，这是值得的）。

如果你想了解它，你可以使用关于 Devise 的 Railscasts：

[http://railscasts.com/episodes/209-introducing-devise](http://railscasts.com/episodes/209-introducing-devise)

而且由于它很容易学习并且功能强大，我会说自己编写它是相当过分的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T01:19:16.777

我是 Devise 的忠实拥护者，也是不重新创造轮子的人。我的反驳问题是，为什么要费力创建自己的身份验证解决方案，只需几个简短的 bash 命令，Devise 就会安装并运行。单是配置选项就足以选择Devise，更何况引擎的几乎每个部分都可以用自己的代码覆盖。

有数百篇博客文章可以帮助您轻松开始运行 Devise。与任何 gem 一样，我建议从浏览[源代码](https://github.com/plataformatec/devise)开始，然后转向[wiki](https://github.com/plataformatec/devise/wiki)寻找您寻求的答案。正如@krizz 提到的，当您需要查看设置时，Ryan Bates 的 Railscasts 总是一个不错的选择。

当然，当你被卡住时，你总是可以回到堆栈。

# ruby-on-rails - Ruby on rails 的标签

> ID：11336151
> 
> 赞同：0
> 
> 时间：2012-07-04T22:52:26.140
> 
> 标签：ruby-on-rails

> **可能重复：**
> [在 Ruby on Rails 中为帖子添加标签](https://stackoverflow.com/questions/2050133/adding-tags-to-posts-in-ruby-on-rails)

我有一个简单但棘手的问题（至少对我来说）......在我的示例应用程序博客中创建标签的最佳方法是什么？我正在使用 act-as-taggable 添加标签，但我可以让它们可点击，这样当人们点击它时，所有带有该标签的帖子都会显示出来？我不太明白O___o

任何帮助都非常感谢！

这是我到目前为止所做的：

在我的帖子控制器中

```
def tagged
  @posts = Post.all(:order => 'created_at DESC')
  @tags = Post.tag_counts_on(:tags)
  @tagged_posts = Post.tagged_with(params[:tags])  
  respond_to do |format|
    format.html # index.html.erb
    format.json { render :json => @posts }
  end
end 
```

然后在我的帖子/显示视图中

```
<% unless @post.tags.empty? %>
<div class="category">Category: 
<% @post.tags.each do |t| %>
    <%= link_to t.name, {:tag => t.name, :action => "tagged", :controller => 'posts'} %>
<% end %> 
```

在我的帖子/标记视图中

```
<% @tagged_posts.each do |post| %>
  <div class="entry">
    <h2><%= link_to post.title, post %></h2>
    <div class="content"><%= sanitize blog_truncate(post.content, :words => 100),:tags =>  %w(strong, b, a) %><br /><%= link_to "[read more]", post %>
      </div>
  </div>
<% end %> 
```

我有点松散地遵循本指南： http: [//gp.si/posts/tagging-with-acts-as-taggable-on](http://g-p.si/posts/tagging-with-acts-as-taggable-on)

我的问题是标签在我的帖子/显示页面上是可点击的，我被重定向到我的标签页面，并且 url 看起来像 mysite/tagged?tag=ruby 但我的标签页面是空白的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:58:15.737

用户点击的标签的每个链接都应该有一个类似的href：

```
/posts?tag=my_tag_name 
```

然后在帖子控制器中

```
class PostsController
  def index
     if params[:tag].present? 
       @posts = Post.where(tag: params[:tag])
     else 
       @posts = Post.all
     end
  end
end 
```

请注意，此代码未经测试，我从未使用过可标记的行为，因此您应首先确定如何查询已标记的帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:14:22.170

差不多了，谢谢指点！你必须使用

```
@posts = Post.tagged_with(params[:tag]) 
```

代替

```
@posts = Post.where(tag: params[:tag]) 
```

它就像魔术一样工作！:)

# python - 通过 pip 安装时 Python GDAL 包缺少头文件

> ID：11336153
> 
> 赞同：24
> 
> 时间：2012-07-04T22:53:00.463
> 
> 标签：python, gdal

我正在尝试`pip install gdal`在虚拟环境（Ubuntu）中从 pip 安装 gdal。它失败了，因为它找不到`cpl_port.h`

```
extensions/gdal_wrap.cpp:2853:22: fatal error: cpl_port.h: No such file or directory
compilation terminated 
```

但是 GDAL 安装正确，头文件位于`/usr/include/gdal/cpl_port.h`. 为了让 pip 找到头文件，是否需要设置 GDAL 的一些环境变量？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-06-26T03:26:51.553

正如[另一个线程](https://gis.stackexchange.com/a/64244/13609)中所建议的，在运行 pip 之前导出一些 shell 变量可以完美地工作。`*_INCLUDE_PATH`可以使用 找到路径`gdal-config --cflags`。

```
# GDAL library must have been installed
sudo apt-get install libgdal-dev

# Set up pip and/or virtualenv stuff
...

# Now install Python binding for GDAL
export CPLUS_INCLUDE_PATH=/usr/include/gdal
export C_INCLUDE_PATH=/usr/include/gdal
pip install GDAL 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-13T10:20:29.373

Tomyun 的回答对我有用，但前提是您必须确保安装的 GDAL-dev`apt-get`版本与`pip`.

对于 Ubuntu 14.04，命令是：

```
# GDAL library must have been installed
sudo apt-get install libgdal-dev

# Set up pip and/or virtualenv stuff
...

# Now install Python binding for GDAL
export CPLUS_INCLUDE_PATH=/usr/include/gdal
export C_INCLUDE_PATH=/usr/include/gdal
pip3 install GDAL=1.10.0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-23T08:03:21.187

**使用画中画**：

```
pip install --no-install GDAL 
```

然后 cd 进入 ENV/build/GDAL

```
python setup.py build_ext --include-dirs=/usr/include/gdal
pip install --no-download GDAL 
```

（来源：[http](http://ubuntuforums.org/showthread.php?t=1769445) ://ubuntuforums.org/showthread.php?t=1769445 ）

**使用构建**：

```
[gdal-bindings]
recipe = zc.recipe.egg:custom
egg = GDAL==1.9.1
include-dirs = /usr/include/gdal
library-dirs = /usr/lib 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-08-28T12:17:38.967

取自此[评论](https://stackoverflow.com/questions/11336153/python-gdal-package-missing-header-file-when-installing-via-pip#comment98474609_25283651)，它直接解决了我的问题

```
pip3 install GDAL==$(gdal-config --version) 
```

显式版本号应与您现有的 libgdal 版本匹配。——</p>

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-07T08:53:14.370

在虚拟环境中测试安装我的依赖于 GDAL 的包时，我也遇到了这个错误。在这种情况下，解决方案是将参数中的依赖关系从更改`GDAL`为。像这样：`pygdal``install_requires``setup.py`

`install_requires=['pygdal'],`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-05T14:28:22.367

这对我有用：

为了通过 pip 安装 gdal 2.2.4，我必须获得最新的听者版本：

```
sudo apt-add-repository ppa:ubuntugis/ubuntugis-unstable
sudo apt update
sudo apt install libgdal-dev 
```

`extensions/gdal_wrap.cpp:3172:27: fatal error: cpl_vsi_error.h: No such file or directory`在此之前，即使包含正确的“包含”pip 路径，我也得到了 .

pip 安装（在 virtualenv 中）：

```
 pip install --global-option=build_ext --global-option="-I/usr/include/gdal" gdal 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-11-05T17:13:29.133

尝试做： brew install gdal

之后再试一次。

# java - 使用来自 Java 的重定向标准输入和标准输出运行外部程序

> ID：11336157
> 
> 赞同：5
> 
> 时间：2012-07-04T22:53:16.853
> 
> 标签：java, exec, stdout, stdin

我正在尝试从 Java 程序运行外部程序，但遇到了麻烦。基本上我想做的是：

```
 Runtime.getRuntime().exec("./extprogram <fileIn >fileOut"); 
```

但是我发现这不起作用 - Java 明显需要使用 a`Process`输入和输出流以及其他我没有经验的东西。

我查看了互联网上的许多示例（其中许多来自 SO），似乎没有一个简单的标准方法可以做到这一点，对于那些不完全了解发生了什么的人来说，可能非常令人沮丧。

我在尝试根据其他人的代码示例构建自己的代码时也遇到了麻烦，因为通常大多数其他人似乎 1\. 对重定向不感兴趣`stdin`，并且 2\. 不一定重定向`stdout`到文件，而是`System.out`.

那么，任何人都可以向我指出任何用于调用外部程序和重定向的简单代码模板的方向`stdin`吗`stdout`？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T23:09:34.697

你可以尝试这样的事情：

```
ProcessBuilder pb = new ProcessBuilder();
pb.redirectInput(new FileInputStream(new File(infile));
pb.redirectOutput(new FileOutputStream(new File(outfile));
pb.command(cmd);
pb.start().waitFor(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-04T23:33:30.923

如果你必须使用`Process`，那么这样的东西应该可以工作：

```
public static void pipeStream(InputStream input, OutputStream output)
   throws IOException
{
   byte buffer[] = new byte[1024];
   int numRead = 0;

   do
   {
      numRead = input.read(buffer);
      output.write(buffer, 0, numRead);
   } while (input.available() > 0);

   output.flush();
}

public static void main(String[] argv)
{
   FileInputStream fileIn = null;
   FileOutputStream fileOut = null;

   OutputStream procIn = null;
   InputStream procOut = null;

   try
   {
      fileIn = new FileInputStream("test.txt");
      fileOut = new FileOutputStream("testOut.txt");

      Process process = Runtime.getRuntime().exec ("/bin/cat");
      procIn = process.getOutputStream();
      procOut = process.getInputStream();

      pipeStream(fileIn, procIn);
      pipeStream(procOut, fileOut);
   }
   catch (IOException ioe)
   {
      System.out.println(ioe);
   }
} 
```

笔记：

*   一定要去`close`溪流
*   将其更改为使用缓冲流，我认为原始`Input/OutputStreams`实现可能一次复制一个字节。
*   进程的处理可能会根据您的特定进程而改变：`cat`是管道 I/O 的最简单示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T00:11:13.360

你试过 System.setIn 和 System.setOut 吗？自 JDK 1.0 以来一直存在。

```
public class MyClass
{
    System.setIn( new FileInputStream( "fileIn.txt" ) );
    int oneByte = (char) System.in.read();
    ...

    System.setOut( new FileOutputStream( "fileOut.txt" ) );
    ... 
```

# cocoa - 阻止所有键盘访问、鼠标访问和键盘快捷键事件

> ID：11336160
> 
> 赞同：3
> 
> 时间：2012-07-04T22:53:33.500
> 
> 标签：cocoa, events, keyboard, keyboard-shortcuts

为了在我的一个项目中阻止所有键盘访问、鼠标访问和键盘快捷键事件，我：

1.  创建了一个全屏透明无边框窗口，在其他窗口前面，但不可见。
2.  `return;`使用简单的窗口本身处理所有键盘和鼠标事件。
3.  制作`window`模式`[NSApp runModalForWindow:myWindow]`以阻止键盘快捷键。
4.  `window`仅从触摸板的手势事件中释放。

但是这个家伙在一个小应用程序中让它看起来很简单 - [MACIFIER](http://macifier.com/)：

他是怎么做到的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T18:28:11.777

我相信你可以使用[Quartz Event Services](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html)。特别是，看看[CGEventTapCreate](https://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/c/func/CGEventTapCreate)，并注意第 4 个参数，它允许您指定要拦截的事件类型。可用的事件类型在[CGEventType](https://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/c/tdef/CGEventType)枚举中列出。

如果您将点击设置为活动过滤器，`NULL`则从回调返回将删除该事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T19:28:08.200

不确定这是否可用，但您可以使用程序 hotkeynet（通常用于游戏，但我已经使用其他方法取得了成功）并映射每个键/鼠标操作以不执行任何操作。我通过在大约 20 到 30 分钟内阻止对特定程序的访问来做了类似的事情。

不确定是否有帮助；但这可能是您需要的解决方案？

# r - 从字符串中删除两个字符

> ID：11336163
> 
> 赞同：10
> 
> 时间：2012-07-04T22:53:47.280
> 
> 标签：r, stringr

相关问题[在这里](https://stackoverflow.com/questions/6639713/how-do-i-strip-dollar-signs-from-data-escape-special-characters-in-r)。

所以我有一个包含美元符号和逗号的货币值的字符向量。但是，我想尝试在同一步骤中同时删除逗号和美元符号。

这将删除美元符号 =

```
d = c("$0.00", "$10,598.90", "$13,082.47")
gsub('\\$', '', d) 
```

这将删除逗号 =

```
library(stringr)
str_replace_all(c("10,0","tat,y"), fixed(c(","), "") 
```

我想知道是否可以一步删除这两个字符。

我意识到我可以将 gsub 结果保存到一个新变量中，然后在该变量上重新应用该（或另一个函数）。但我想我想知道一个步骤可以做到这两点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-05T00:38:12.920

由于在评论中回答不好：

```
gsub('\\$|,', '', d) 
```

用空字符串替换`$`或 ( `|`) 。`,`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T23:05:03.410

查看`?regexp`其他特殊的正则表达式符号：

```
> gsub('[[:punct:]]', '', d)
[1] "000"     "1059890" "1308247" 
```

# java - 从自上而下的 2-3-4 左倾红黑树中删除需要什么额外的旋转？

> ID：11336167
> 
> 赞同：48
> 
> 时间：2012-07-04T22:54:15.830
> 
> 标签：java, algorithm, data-structures, red-black-tree, 2-3-4-tree

[我一直在实现一个 LLRB 包，它应该能够在Sedgewick 描述的](http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf "PDF 警告")自下而上 2-3 或自上而下 2-3-4 两种模式中的任何一种模式下运行（[代码](http://www.cs.princeton.edu/~rs/talks/LLRB/Java/RedBlackBST.java)- 改进的代码，虽然只处理 2-[这里](http://algs4.cs.princeton.edu/33balanced/RedBlackBST.java.html)有3 棵树，感谢 RS 的指针）。

Sedgewick 对 2-3 模式的树操作提供了非常清晰的描述，尽管他花了很多时间谈论 2-3-4 模式。他还展示了在插入过程中对颜色翻转顺序的简单更改如何改变树的行为（在 2-3-4 中向下拆分或在 2-3 向上拆分）：

```
private Node insert(Node h, Key key, Value value)
{
    if (h == null)
        return new Node(key, value);

    // Include this for 2-3-4 trees
    if (isRed(h.left) && isRed(h.right)) colorFlip(h);

    int cmp = key.compareTo(h.key);

    if (cmp == 0)     h.val = value;
    else if (cmp < 0) h.left = insert(h.left, key, value);
    else              h.right = insert(h.right, key, value);

    if (isRed(h.right) && !isRed(h.left))    h = rotateLeft(h);
    if (isRed(h.left) && isRed(h.left.left)) h = rotateRight(h);

    // Include this for 2-3 trees
    if (isRed(h.left) && isRed(h.right)) colorFlip(h);

    return h;
} 
```

然而，他用以下内容掩盖了 2-3-4 LLRB 中的删除：

> 下一页的代码是 LLRB 2-3 树的 delete() 的完整实现。它基于在自顶向下的 2-3-4 树中插入方法的逆向：我们在沿着搜索路径向下的途中执行旋转和颜色翻转，以确保搜索不会在 2 节点上结束，这样我们就可以删除底部的节点。我们使用方法 fixUp() 在 insert() 代码中的递归调用之后共享颜色翻转和旋转的代码。使用 fixUp()，我们可以在搜索路径上留下右倾的红色链接和不平衡的 4 节点，确保这些条件在向上树的过程中得到修复。（**该方法对 2-3-4 树也是有效的，但是当搜索路径之外的右节点是 4 节点时需要额外的旋转。**）

他的 delete() 函数：

```
private Node delete(Node h, Key key)
{
    if (key.compareTo(h.key) < 0)
        {
            if (!isRed(h.left) && !isRed(h.left.left))
            h = moveRedLeft(h);
            h.left = delete(h.left, key);
        }
    else
        {
            if (isRed(h.left))
                h = rotateRight(h);
            if (key.compareTo(h.key) == 0 && (h.right == null))
                return null;
            if (!isRed(h.right) && !isRed(h.right.left))
                h = moveRedRight(h);
            if (key.compareTo(h.key) == 0)
                {
                    h.val = get(h.right, min(h.right).key);
                    h.key = min(h.right).key;
                    h.right = deleteMin(h.right);
                }
            else h.right = delete(h.right, key);
        }
    return fixUp(h);
} 
```

我的实现为 2-3 树上的所有树操作正确维护 LLRB 2-3 不变量，但对于 2-3-4 树上的右侧删除子类失败（这些失败的删除导致右倾斜的红色节点，但滚雪球到树不平衡，最后是空指针取消引用）。从对讨论 LLRB 树并包括在任一模式下构建树的选项的示例代码的调查来看，似乎没有一个正确实现从 2-3-4 LLRB 中删除（即没有一个提到额外的旋转，例如 Sedgewick 的 java上面和[这里](http://www.teachsolaisgames.com/articles/balanced_left_leaning.html)）。

我很难弄清楚他所说的“当搜索路径之外的正确节点是 4 节点时额外旋转”是什么意思；大概这是向左旋转，但是在何时何地？

如果我在调用 fixUp() 之前或在 fixUp 函数结束时向左旋转通过 4 节点等效项（即 RR 节点）或右倾斜 3 节点等效项（BR 节点），我仍然会得到相同的不变矛盾.

这是我发现的最小失败示例的树状态（通过从 0 到相应最大值的顺序插入元素生成）。

第一对树显示了从删除元素 15 之前的不变一致性状态到之后的明显破坏状态的转换。

![一个包含 0..15 的 2-3-4 LLRB](../Images/67a8c5c775f8798b8580f5a131c5c407.png)

![删除第 15 项后的状态](../Images/8682f15604e0c7704a5f5fa8065c074b.png)

第二个与上面基本相同，但删除了 0..16 的 16 个（删除 15 个导致相同的拓扑）。请注意，不变矛盾设法跨越根节点。

![包含 0..16 的 2-3-4 LLRB](../Images/5e61b8e1df5b3529d7f281bbc56f3cb2.png)

![删除第 16 项后的状态](../Images/b7709d091e2993b10208ca1a2a151aee.png)

关键是要了解如何将在树向下遍历到目标节点期间产生的违规恢复。以下两棵树分别显示了上面的第一棵树在分别向左和向右走之后的样子（没有删除，在使用 fixUp() 向上走之前）。

尝试在不使用 fixUp 的情况下删除“-1”后： ![尝试在没有 fixUp 的情况下删除“-1”后](../Images/a829eaef11bdd80f8421aa8b60914d15.png)

尝试在不使用 fixUp 的情况下删除“16”后： ![尝试在没有 fixUp 的情况下删除“16”后](../Images/c971f4f61c90693f7976b024dec0f7ff.png)

当节点只有一个红色的右孩子时，尝试向左旋转似乎是解决方案的一部分，但它不能正确处理连续的两个红色右孩子，当两个孩子都是红色时，在此之前使用 FlipColor似乎进一步改善了这种情况，但仍然违反了一些不变量。

如果我进一步检查右孩子的右孩子在其兄弟姐妹为黑色时是否为红色，如果这是真的，我只失败一次，但此时我觉得我需要一个新的理论而不是一个新的本轮.

有任何想法吗？

作为参考，我的实现在[这里](http://code.google.com/p/biogo/source/browse/llrb.go?repo=llrb "llrb.go")可用（不，它不是 Java）。

跟进：

我对此感兴趣的部分原因是为了证实许多人声称 2-3 LLRB 树比 2-3-4 LLRB 树更有效。我的基准测试已经证实了插入和删除的这一点（2-3 大约快 9%），但我发现 2-3-4 树的检索速度要快得多。

以下时间在运行中具有代表性且一致：

```
BU23:
BenchmarkInsert        1000000        1546 ns/op
BenchmarkDelete        1000000        1974 ns/op
BenchmarkGet           5000000         770 ns/op

TD234:
BenchmarkInsert        1000000        1689 ns/op
BenchmarkDelete        1000000        2133 ns/op
BenchmarkGet           5000000         753 ns/op 
```

第一列是工作台名称，第二列是操作数，第三列是结果。i5M 2.27 上的基准测试。

我已经查看了 2-3 树和 2-3-4 树的分支长度，其中几乎没有解释检索差异（从根到节点的平均距离和 1000 棵树的 SD，每棵树都有 10000 个随机插入）：

```
Means:
TD234 leafs  BU23 leafs 
 12.88940     12.84681 
TD234 all    BU23 all 
 11.79274     11.79163 

StdDev:
TD234 leafs  BU23 leafs 
 1.222458     1.257344 
TD234 all    BU23 all 
 1.874335     1.885204 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T07:58:28.603

**更新和验证**

测试这一点的关键是该实现不支持删除不存在或以前删除的节点！我花了太长时间试图弄清楚为什么我的工作解决方案被“破坏”了。这可以通过对键进行初步搜索来解决，如果它根本不在树中，则返回 false，并且该解决方案已在底部的链接代码中使用。

Sedgewick 似乎没有为公开的 2-3-4 删除写删除。他的结果专门针对 2-3 树（他只是粗略地提到了 2-3-4 树，因为它们的平均路径长度（以及搜索成本）以及其他红黑树的平均路径长度与2-3 例）。似乎也没有其他人容易找到，所以这是我在调试问题后发现的：

首先，获取 Sedgewick 的代码并修复过时的位。[在此处](http://www.cs.princeton.edu/~rs/talks/LLRB/08Penn.pdf)的幻灯片（第 31 页）中，您可以看到他的代码仍然使用 4 个节点的旧表示，它是通过连续两个左红色而不是平衡来完成的。那么，编写 2-3-4 删除例程的第一步是修复这个问题，以便我们可以进行健全性检查，这将有助于我们稍后验证我们的修复：

```
private boolean is234(Node x)
{         
   if (x == null)
      return true;
   // Note the TD234 check is here because we also want this method to verify 2-3 trees
   if (isRed(x.right))
      return species == TD234 && isRed(x.left);

   if (!isRed(x.right))
      return true;

   return is234(x.left) && is234(x.right);
} 
```

一旦我们有了这个，我们就会知道一些事情。一，从论文中我们看到，当使用 2-3-4 树时，不应该在向上的过程中破坏 4 个节点。第二，搜索路径上有一个右 4 节点的特殊情况。还有第三种没有提到的特殊情况，那就是当你倒退一棵树时，你可能会在你`h.right.left`原来是红色的地方结束，这会让你只需要向左旋转就无效。这是本文第 4 页插入描述的案例的镜子。

您需要的 4 节点的旋转修复如下：

```
 private Node moveRedLeft(Node h)
    {  // Assuming that h is red and both h.left and h.left.left
       // are black, make h.left or one of its children red.
       colorFlip(h);
       if (isRed(h.right.left))
       { 
          h.right = rotateRight(h.right);

          h = rotateLeft(h);
          colorFlip(h);

          if (isRed(h.right.right) )
             h.right = rotateLeft(h.right);
       }
      return h;
    } 
```

这消除了 2-3-4 上的拆分，并添加了对第三种特殊情况的修复

```
private Node fixUp(Node h)
{
   if (isRed(h.right))
   {      
      if (species == TD234 && isRed(h.right.left))
         h.right = rotateRight(h.right);
      h = rotateLeft(h);
   }

   if (isRed(h.left) && isRed(h.left.left))
      h = rotateRight(h);

   if (species == BU23 && isRed(h.left) && isRed(h.right))
      colorFlip(h);

   return setN(h);
} 
```

最后，我们需要对此进行测试并确保它有效。它们不一定是最有效的，但正如我在调试过程中发现的那样，它们必须实际使用预期的树行为（即不插入/删除重复数据）！我用一个测试辅助方法做到了这一点。当我调试时，注释行就在那里，我会打破并检查树是否有明显的不平衡。我已经用 100000 个节点尝试过这种方法，并且它表现完美：

```
 public static boolean Test()
   {
      return Test(System.nanoTime());
   }
   public static boolean Test(long seed)
   {
      StdOut.println("Seeding test with: " + seed);
      Random r = new Random(seed);
      RedBlackBST<Integer, Integer> llrb = new RedBlackBST<Integer,Integer>(TD234);
      ArrayList<Integer> treeValues = new ArrayList<Integer>();
      for (int i = 0; i < 1000; i++)
      {
         int val = r.nextInt();
         if (!treeValues.contains(val))
         {
            treeValues.add(val);
            llrb.put(val, val);
         }
         else
            i--;
      }
      for (int i = 0; i < treeValues.size(); i++)
      {
         llrb.delete(treeValues.get(i));
         if (!llrb.check())
         {
            return false;
         }
//         StdDraw.clear(Color.GRAY);
//         llrb.draw(.95, .0025, .008);
      }
      return true;
   } 
```

完整的源代码可以在[这里](http://tawnos.com/programming/RedBlackBST.java)找到。

# objective-c - 第一次打开应用程序？

> ID：11336168
> 
> 赞同：1
> 
> 时间：2012-07-04T22:54:34.897
> 
> 标签：objective-c, macos, cocoa

第一次下载并打开我的应用程序时，我希望“帮助”窗口自动打开。

我将如何继续这样做？注意我只希望它在**第**一次启动应用程序时自动打开。

Mac OS X 雪豹，Xcode 3.2.6

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:58:04.777

执行此操作的方法有很多，其中一种是`NSUserDefaults`用于存储值“ `firstRun`”并将其设置为`YES`首次运行时。显然，如果您没有找到 的值`firstRun`或它被设置为`NO`，那么它是您的第一次运行。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)

# r - R ggplot2 函数不起作用

> ID：11336169
> 
> 赞同：-1
> 
> 时间：2012-07-04T22:55:03.840
> 
> 标签：r, package, ggplot2

> **可能重复：**
> [错误：在 R 中找不到函数...](https://stackoverflow.com/questions/7027288/error-could-not-find-function-in-r)

# 问题：为什么我的 ggplot2 函数不起作用？

*   背景：Ubuntu 12.04，Gnome 桌面，R 2.15.1，镜像：[http ://cran.stat.ucla.edu/](http://cran.stat.ucla.edu/)

*   首先，它说下载的源包在“/tmp/Rtmp2GMNV8/downloaded_pa​​ckages”中。没有'/tmp/Rtmp2GMNV8/downloaded_pa​​ckages.'

*   其次，安装了ggplot2。为什么然后“找不到函数“qplot””？？？

我已经找了几个小时，在网上找不到任何答案。有人知道发生了什么吗？

读数：

```
emilio@dog:~/R$ sudo R

R version 2.15.1 (2012-06-22) -- "Roasted Marshmallows"

# I've taken the liberty of omitting a few lines

> install.packages("ggplot2", dependencies=TRUE)
Installing package(s) into ‘/usr/local/lib/R/site-library’
[...]
* DONE (SparseM)
* DONE (sp)
* DONE (mvtnorm)
* DONE (evaluate)
* DONE (Hmisc)
* DONE (maps)
* DONE (hexbin)
* DONE (gpclib)

* installing *source* package ‘ggplot2’ ...
** package ‘ggplot2’ successfully unpacked and MD5 sums checked
** R
** data
**  moving datasets to lazyload DB
** inst
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded

* DONE (ggplot2)
* DONE (quantreg)
* DONE (mapproj)
* DONE (maptools)
* DONE (multcomp)
* DONE (testthat)

The downloaded source packages are in
    ‘/tmp/Rtmp2GMNV8/downloaded_packages’
> help(qplot)
No documentation for ‘qplot’ in specified packages and libraries:
you could try ‘??qplot’
> help(ggplot)
No documentation for ‘ggplot’ in specified packages and libraries:
you could try ‘??ggplot’
> data(diamonds, package="ggplot2")
> head(diamonds)
  carat       cut color clarity depth table price    x    y    z
1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
5  0.31      Good     J     SI2  63.3    58   335 4.34 4.35 2.75
6  0.24 Very Good     J    VVS2  62.8    57   336 3.94 3.96 2.48
> qplot(carat, price, data = diamonds)
Error: could not find function "qplot"

emilio@dog:~$ cd /tmp/Rtmp2GMNV8/downloaded_packages
bash: cd: /tmp/Rtmp2GMNV8/downloaded_packages: No such file or directory 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T23:03:10.290

您需要先加载包。请参阅 joran 在评论中给出的链接，但是：

```
library(ggplot2)

qplot(caret, price, data=diamonds) 
```

# c++ - 静态常量成员初始化和模板（与静态函数相比） - 这是如何工作的？

> ID：11336173
> 
> 赞同：3
> 
> 时间：2012-07-04T22:55:27.033
> 
> 标签：c++, compilation, static-members

我知道 C++ 标准说（第 9.4.2 节第 4 段）整数或枚举类型的静态成员变量可以在类内部提供初始化程序，但这需要在类外部定义该成员（在编译单元中）。即，您需要执行以下操作：

```
class A
{
public:
    static const int X = 10;
};

// this is required by the standard
const int A::X; 
```

我已经看到（并且我已经看到它在其他地方说过）某些编译器会让您在没有类外定义的情况下逃脱。这适用于 OS X 上的 gcc 4.2.1：

```
#include <iostream>    

class A
{
public:
    static const int X = 10;
};

int main(int argc, char** argv)
{
    std::cout << A::X << std::endl;
    return 0;
} 
```

我最近遇到了一个错误，有人这样做了，但是他们在模板函数中使用了成员变量（`std::max`准确地说），它不会编译，抱怨未定义的符号 A::XIe，这不起作用：

```
#include <iostream> 
#include <algorithm>   

class A
{
public:
    static const int X = 10;
};

int main(int argc, char** argv)
{
    std::cout << std::max(1, A::X) << std::endl;
    return 0;
} 
```

添加回类外定义使其工作。

这是一个学术问题，但我想知道*为什么*会这样。尤其是如果我们用静态函数（`static const int X = 10;`变成`static int X()`，`A::X`变成`A::X()`）替换静态成员变量，那么它将在没有类外定义的情况下编译。我提到模板的原因是因为`std::max`是模板化的，而其他模板化函数重现了相同的行为。它可能与模板没有具体关系，但我想了解为什么模板会导致它们的行为。我认为这一定与模板和静态成员的编译/实现方式有关？

[PS - 我在github](http://github.com/dantswain/StaticConstUndefinedSymbol)上发布了一些最小的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:06:50.890

它将在没有定义的情况下编译。

*如果静态成员变量是odr-used*，则在链接时需要定义。（如果编译器每次引用它时都设法替换它的实际值，它就不会被*odr-used 使用*。另一方面，获取它的地址肯定会使其成为*odr-used*）

这是完整的规则（第 9.4.2 节`[class.static.data]`）：

> 如果非易失性`const static`数据成员是整数或枚举类型，则其在类定义中的声明可以指定一个*大括号或等式初始化器*，其中 作为*赋值表达式*的每个*初始化器子句*都是一个常量表达式。字面量类型的数据成员可以用说明符在类定义中声明；如果是这样，它的声明应指定一个*大括号或等式初始化器*，其中作为*赋值表达式*的每个*初始化器子句*都是一个常量表达式。[ 注意：在这两种情况下，成员都可能出现在常量表达式中。——尾注]*`static``constexpr`******如果该成员在程序中被 odr-used 并且命名空间范围定义不应包含初始化*程序，则该成员仍应在命名空间范围内定义。******

 **并从第 3.2 节`[basic.def.odr]`：

> 名称显示为潜在求值表达式的变量是*odr-used*的，除非它是一个满足出现在常量表达式中的要求并且立即应用左值到右值转换的对象。

满足出现在常量表达式中的要求，所以一切都取决于它是用作*左值*还是*右值*。

`std::max`接受左值引用，因此不会立即进行左值到右值的转换。

* * *

与模板的唯一交互是可能有多个等效定义，链接器将选择任何一个。在您的情况下，没有模板，因此多个定义会产生“符号多重定义”类型的错误。

当您忘记提供定义时，两种情况（模板类成员和普通类成员）都会给出相同的错误：“未定义符号”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T23:12:33.903

让我们以您的第一个示例为例：

```
std::cout << A::X << std::endl; 
```

因为`A::X`是类型`const int`，所以调用`cout.operator<<(int value)`。请注意，在此调用`int value`中是按*值*获取的。我相信编译器会执行[常量折叠](http://en.wikipedia.org/wiki/Constant_folding)，只是用`A::X`值替换。但是，在 C++03 中*不需*要这样做。但是，在 C++11 中，规则发生了变化，这已成为这句话的要求：（`unless it is an object that satisfies the requirements for appearing in a constant expression and the lvalue-to-rvalue conversion is immediately applied.`如 Ben Voigt 所述）。

现在让我们看一下 的定义`std::max(1, A::X)`：

```
template< class T >
const T& max( const T& a, const T& b ); 
```

该`std::max`函数通过*引用*获取它的参数，换句话说，`A::X`必须知道的地址才能完成调用。`A::x`必须知道的地址，这需要定义。**

# wpf - 在 DataGrid hello world 中显示 DataView

> ID：11336174
> 
> 赞同：0
> 
> 时间：2012-07-04T22:56:32.633
> 
> 标签：wpf, wpfdatagrid, wpftoolkit

简单的 hello world - 试图显示`DataView`在`DataGrid`. 我需要添加什么？结果窗口中的 DataGrid 没有任何内容。

MainWindow.xaml.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Data;

namespace WpfApplication3
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public DataView Displayed
        {
            get
            {
                DataTable table = new DataTable();
                table.Columns.Add("Col1", typeof(string));
                table.Columns.Add("Col2", typeof(string));
                table.Columns.Add("Col3", typeof(string));

                for (int i = 0; i < 100; i++)
                {
                    DataRow row = table.NewRow();
                    row["Col1"] = i.ToString() + "col1";
                    row["Col2"] = i.ToString() + "col2";
                    row["Col3"] = i.ToString() + "col3";
                    table.Rows.Add(row);
                }

                return table.DefaultView;
            }
        }

        public MainWindow()
        {
            InitializeComponent();
        }
    }
} 
```

MainWindow.xaml：

```
<Window x:Class="WpfApplication3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:toolkit="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <toolkit:DataGrid ItemsSource="{Binding Path=Displayed, Mode=OneWay}"> 
        </toolkit:DataGrid>
    </StackPanel>
</Window> 
```

输出窗口：

```
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_32\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\xxx\documents\visual studio 2010\Projects\WpfApplication3\WpfApplication3\bin\Debug\WpfApplication3.vshost.exe', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_32\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xaml\v4.0_4.0.0.0__b77a5c561934e089\System.Xaml.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\WindowsBase\v4.0_4.0.0.0__31bf3856ad364e35\WindowsBase.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_32\PresentationCore\v4.0_4.0.0.0__31bf3856ad364e35\PresentationCore.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\PresentationFramework\v4.0_4.0.0.0__31bf3856ad364e35\PresentationFramework.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
The thread 'vshost.NotifyLoad' (0x1dac) has exited with code 0 (0x0).
The thread '<No Name>' (0x1990) has exited with code 0 (0x0).
The thread 'vshost.LoadReference' (0x824) has exited with code 0 (0x0).
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\xxx\documents\visual studio 2010\Projects\WpfApplication3\WpfApplication3\bin\Debug\WpfApplication3.exe', Symbols loaded.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
Step into: Stepping over non-user code 'WpfApplication3.App.App'
Step into: Stepping over non-user code 'WpfApplication3.App.InitializeComponent'
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'c:\users\xxx\documents\visual studio 2010\Projects\WpfApplication3\WpfApplication3\bin\Debug\WPFToolkit.dll'
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\PresentationFramework.Aero\v4.0_4.0.0.0__31bf3856ad364e35\PresentationFramework.Aero.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.
'WpfApplication3.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\PresentationFramework-SystemXml\v4.0_4.0.0.0__b77a5c561934e089\PresentationFramework-SystemXml.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled. 
```

结果：

![显示空 DataGrid 的结果屏幕截图](../Images/ef4c0fb522386457dd92cde043158476.png)

我想查看`Displayed`此处定义的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:03:04.173

您应该将`DataContext`of设置`MainWindow`为自身。否则`Displayed`将找不到。

```
public MainWindow()
{
    InitializeComponent();
    this.DataContext = this;
} 
```

在 XAML 中相同

```
<Window DataContext="{Binding RelativeSource={RelativeSource Self}}" 
```

# c# - 生成 DbContext 后如何修改数据库？

> ID：11336175
> 
> 赞同：3
> 
> 时间：2012-07-04T22:57:19.900
> 
> 标签：c#, asp.net-mvc, entity-framework, ef-code-first, dbcontext

现在我已经通过以下方式从现有数据库生成了 19 个代码优先类：

*   创建模型优先实体，并选择“从数据库生成”
*   右键单击并选择“添加代码生成项”
*   EF 4.x DbContext 生成器

我想要的所有类都生成了，我对它们很满意......

现在我的问题

*   为什么它们所有生成的 .cs 文件都嵌套在密封的 .tt 集合中？
*   为什么我不能将它们复制粘贴到我喜欢的任何文件夹中，并将它们视为普通类？
*   只是我，还是当您这样做时无法使用迁移“更新数据库”？

我想我的总体问题是，为什么它们位于 .tt 文件夹中？我现在应该如何更新我的数据库？通过手动编辑数据库然后更新Model，然后再次生成dbContext？或者是否有从 .tt 文件夹中获取 .cs 文件的技巧？

生成 DbContext 后如何修改数据库**？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T03:51:29.163

> *   为什么它们所有生成的 .cs 文件都嵌套在密封的 .tt 集合中？

您的代码优先类不是代码优先类。它们是根据您的数据库模式生成的。因此，这是一种数据库优先的方法。使用数据库优先，您的实体类是基于数据库生成的。换句话说，数据库在前，代码在*后*。.tt 文件是一个 T4 模板，它决定如何根据数据库生成类。您可以更改数据库，然后重新生成实体类。

> *   为什么我不能将它们复制粘贴到我喜欢的任何文件夹中，并将它们视为普通类？

因为它们是基于 T4 模板生成的文件。

> *   只是我，还是当您这样做时无法使用迁移“更新数据库”？

你的这部分问题我不能肯定回答，必须推迟。但是，在我看来，您想要混合和匹配方法。听起来您想从基于数据库生成代码类开始，然后根据添加到模型项目的新实体类更改数据库。是对的吗？

您可以放弃代码生成部分，只使用纯代码优先的方法，现在您已经了解了实体 POCO 的外观。我之前尝试过这种 T4 代码生成（EF 4.1 之前）并立即放弃它，因为正如您所见，由于生成了实体和 DbContext 类，您就失去了对面向对象模型的控制。

# mysql - SELECT 中的 MySQL 性能问题

> ID：11336176
> 
> 赞同：0
> 
> 时间：2012-07-04T22:57:28.667
> 
> 标签：mysql, performance

一个简单的数据库：

```
CREATE TABLE data (
  id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  code VARCHAR(50),
  value VARCHAR(10),
); 
```

目前有大约 200 万行。

查询如：

```
SELECT value FROM data WHERE `code`='12345'; 
```

执行 10-12 秒。

提高简单`select`查询性能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:58:34.137

在列上创建索引`code`：

```
ALTER TABLE data ADD INDEX (code) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T23:01:19.947

为代码添加索引。此外，代码是否总是数字（使其类型为 int）和/或它是否唯一（使其唯一或主键）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T23:28:05.223

在某些情况下，您可能会发现在`code`列上添加索引是不够的，因此如果这对您不起作用，您需要为 the`code`和`value`列添加（单个）索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T00:15:37.553

您可以使用`EXPLAIN SELECT ...`询问 MySQL 以获取有关它将如何执行您的查询的信息。这将告诉您它需要检查每一行。改进这一点是在您的子句`code`中使用的列上添加一个索引。`WHERE`

`EXPLAIN` [http://dev.mysql.com/doc/refman/5.0/en/explain-output.html](http://dev.mysql.com/doc/refman/5.0/en/explain-output.html)

`CREATE INDEX` [http://dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

# delphi - 德尔福悖论

> ID：11336183
> 
> 赞同：2
> 
> 时间：2012-07-04T22:58:22.900
> 
> 标签：delphi, delphi-xe2

我有一个使用 Borland 数据库引擎成功运行了近 20 年的旧 Paradox 应用程序。许多不同的订单接受者将数据输入到主程序中，然后他们每天将数据存储到记忆棒上，供许多服务卡车的笔记本电脑使用，这些卡车也使用 Paradox。

我刚刚使用 Delphi XE2 Professional 和 TClientDataSet（公文包模型）重写了曾经在笔记本电脑上运行的 Paradox 程序。

现在我需要使用 Firebird 服务器将主应用程序升级为客户端-服务器模型。问题是，什么是最好的方法，因为我没有企业版。我看到很多不同的 3rd 方工具可用，或者专业版中提供的工具是否足够？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T07:32:56.717

专业版中提供的工具应该可以很好地使用。我假设，您已使用 BDE 组件（如 TTable、TQuery 等）来访问 Paradox 数据库。您可以通过 ODBC 连接使用相同的...最好的解决方案是从使用 BDE 组件转移到 ADO /其他组件...

[http://edn.embarcadero.com/article/37538](http://edn.embarcadero.com/article/37538)提供了 Firebird 的驱动信息

# javascript - 如果发生超时隐藏div？

> ID：11336186
> 
> 赞同：0
> 
> 时间：2012-07-04T22:58:25.867
> 
> 标签：javascript, jquery

在使用 HTML 和 jQuery 开发应用程序时，我有一个覆盖整个页面的加载屏幕，然后在内容加载后淡出，如下所示：

```
google.maps.event.addListenerOnce(map, 'tilesloaded', function(){
    $(".loading").delay(2600).fadeOut({
        useTranslate3d: true,
    });
}); 
```

（如果有人想知道为什么淡入淡出会有延迟，那就是加载动作和淡出之间有一点缓冲时间）

我想要完成的是，当 div 在一定秒数后没有淡出时，比如一分钟（或建议更好的时间），然后 div 淡出并出现错误消息，说资源失败装载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:02:29.903

```
var failedTimeout = setTimeout(function() {
    alert('resources failed to load');
}, 60000);

google.maps.event.addListenerOnce(map, 'tilesloaded', function(){
    clearTimeout(failedTimeout);
    $(".loading").delay(2600).fadeOut({
        useTranslate3d: true,
    });
}); 
```

# mysql - OS X Lion 上的 RoR 应用程序缺少 mysql.sock

> ID：11336192
> 
> 赞同：0
> 
> 时间：2012-07-04T22:59:09.500
> 
> 标签：mysql, ruby-on-rails-3, osx-lion

我使用两台 OS X 机器来开发我的 Ruby on Rails 应用程序。我的桌面工作正常，我的笔记本电脑工作正常，直到几天前本地服务器在页面加载时运行时出现此错误：

```
ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2) 
```

当我尝试从终端运行 mysql 时，我得到了同样的错误。

我检查了其他一些线程，但他们的解决方案都没有解决我的问题：

[Ruby on Rails 3 无法通过 OSX 上的套接字“/tmp/mysql.sock”连接到本地 MySQL 服务器](https://stackoverflow.com/questions/5499035/ruby-on-rails-3-cant-connect-to-local-mysql-server-through-socket-tmp-mysql-s)

[无法通过套接字连接到本地 MySQL 服务器](https://stackoverflow.com/questions/4732213/cant-connect-to-local-mysql-server-through-socket)

那个家伙的最后一个链接似乎和我遇到了完全相同的问题，但是该页面上的答案对我没有帮助，因为我无法运行 mysql。我一直在网上看到这个问题，人们修复了它，因为他们的 .sock 文件位于错误的位置，所以我跑了

```
$ ln -s /var/lib/mysql/mysql.sock /tmp 
```

尝试创建一个别名，但看起来 mysql.sock 在这两个地方都不存在。当我尝试运行时：

```
$ mysqladmin variables | grep socket 
```

我收到了这个错误：

```
Check that mysqld is running and that the socket: '/tmp/mysql.sock' exists! 
```

最后，我打开了不可见文件并环顾了我的计算机，在上述任何目录中都找不到 mysql.sock 文件或 mysql 文件夹。再一次，mysql 一周前在这台计算机上工作正常，现在由于某种原因莫名其妙地停止工作。

如何为这台计算机恢复或重新创建我的 .sock 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T03:51:47.197

我猜你之前已经使用自制软件安装了 mysql。请注意，您的 mysqld 已经在运行

```
/usr/local/Cellar/mysql/5.5.24/bin/mysqld 
```

但是，您当前的 mysql 命令链接到

```
/usr/local/bin/mysql 
```

相反，它应该是

```
/usr/local/Cellar/mysql/5.5.24/bin/mysql 
```

您可以尝试将别名添加到指向正确命令的 bashrc。

`mysql`在新窗口中运行之前尝试杀死所有其他 mysqld_safe 进程。它现在应该读取正确的 mysql sock 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T18:23:34.057

原因可能是您的 Gemfile 中指定的套接字路径可能是错误的。

首先，找到你的套接字文件：

```
mysqladmin variables | grep socket 
```

对我来说，这给出了：

```
| socket  /var/run/mysqld/mysqld.sock 
```

然后，将此行添加`/var/run/mysqld/mysqld.sock` 到套接字字段中的 config/database.yml 中。请参阅以下示例

**例子：** `socket: /var/run/mysqld/mysqld.sock`

# 发展模式

```
development:
  adapter: mysql2
  host: localhost
  username: root
  password: xxxx
  database: xxxx
  socket: /var/run/mysqld/mysqld.sock #  this line 
```

# 生产模式

```
production:
  adapter: mysql2
  host: localhost
  username: root
  password: xxxx
  database: xxxx
  socket: /var/run/mysqld/mysqld.sock  #  this line 
```

# 测试模式

```
test:
  adapter: mysql2
  host: localhost
  username: root
  password: xxxx
  database: xxxx
  socket: /var/run/mysqld/mysqld.sock  #  this line 
```

# java - 是否可以从 Selenium 代码中禁用 Firefox 插件

> ID：11336200
> 
> 赞同：1
> 
> 时间：2012-07-04T23:01:21.913
> 
> 标签：java, webdriver, selenium-webdriver

> **可能重复：**
> [如何在使用 selenium 时禁用 Firefox 中的附加组件](https://stackoverflow.com/questions/10578108/how-do-i-disable-add-ons-in-firefox-when-using-selenium)

如果有办法，我想知道如何在使用 RemoteWebdriver 的测试之前或期间禁用部分或全部 Firefox 插件。

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-05T08:37:06.587

试试这段代码，

```
FirefoxProfile profile = new FirefoxProfile();
profile.AddExtension("location xpi of plugin");
DesiredCapabilities desiredCapabilities = DesiredCapabilities.Firefox();
desiredCapabilities.SetCapability("firefox_profile", profile);
driver = new RemoteWebDriver(desiredCapabilities); 
```

我希望它有效

# jquery - Jquery下拉菜单双下拉

> ID：11336206
> 
> 赞同：0
> 
> 时间：2012-07-04T23:02:05.983
> 
> 标签：jquery, html, css

我有一个 jquery 下拉菜单，效果很好。只有 1 个问题它会滑动 2 个元素，但我只想下拉悬停的元素。

网站链接：[这里](http://www.nedwebdesign.nl/dvl/)

jQuery

```
$(document).ready(function () { 

        $('.sub_menu').hide(); //hiding the element

        $('.trigger').mouseenter(function() {
            $('.sub_menu').slideDown(350); 
        }).mouseleave(function() {
            $('.sub_menu').slideUp(350); 
        });   
}); 
```

HTML

```
<div id="nav">
            <ul class="main_menu">
                <li><a href="#">Home</a></li>
                <li class="trigger">
                    <a href="#">Hypotheken</a>
                    <ul class="sub_menu">
                        <li><a href="#">Hypotheekvormen</a></li>
                        <li><a href="#">Hyporheek rente</a></li>
                        <li><a href="#">Nationale hypotheek garantie</a></li>   
                    </ul>
                    <div class="clear"></div>                       
                </li>
                <li><a href="#">Verzekeringen</a></li>
                <li class="trigger">
                    <a href="#">Downloads</a>
                    <ul class="sub_menu">
                        <li><a href="#">Hypotheekvormen</a></li>
                        <li><a href="#">Hyporheek rente</a></li>
                        <li><a href="#">Nationale hypotheek garantie</a></li>   
                    </ul>
                </li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div><!-- nav --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:10:33.547

试试这个

```
$(document).ready(function () { 

        $('.sub_menu').hide(); //hiding the element

        $('.trigger').mouseenter(function() {
            $(this).children('.sub_menu').slideDown(350); 
        }).mouseleave(function() {
            $(this).children('.sub_menu').slideUp(350); 
        });   
}); 
```

在您的代码中，当您将鼠标移到菜单项上时，所有具有类的元素`.sub_menu`都会被选中并设置动画。但你只需要当前的孩子。

# javascript - Jquery替换每个

> ID：11336207
> 
> 赞同：3
> 
> 时间：2012-07-04T23:02:11.013
> 
> 标签：javascript, jquery, replace, each

我想用 span 标签替换每个链接中的每个“新”。

这样对吗？

```
$("a:contains('New')").each(function () {
                 $(this).html($(this).html().replace("New", "<span class='new'>New</span>"));
        }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T23:05:49.103

正则表达式：**工作演示** [http://jsfiddle.net/WujTJ/](http://jsfiddle.net/WujTJ/)

g = /g 修饰符确保所有出现的“替换”

i - /i 使正则表达式匹配不区分大小写。

**一个很好的阅读：**如果你喜欢：[http ://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)

请试试这个：

希望这有帮助`:)`

另请注意，您可能不需要检查它是否包含`New`，因为如果需要，正则表达式会更改：

```
 // $("a:contains('New')").each(function () { // NOT sure if you need this
                     $(this).html($(this).html().replace(/New/g, "<span class='new'>New</span>"));
      //      }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T23:33:12.207

你试过你的代码吗？
正如您[在此处](http://jsfiddle.net/ricardolohmann/zZyLp/1/)看到的，它运行良好，唯一的问题是您忘记使用`g`修饰符来替换所有`"New"`出现。

另一个问题是你不需要每个循环，因为你可以看到下面的代码做同样的事情。
不同之处在于**不必循环并获取项目 html 两次**。

```
$("a:contains('New')").html(function(i, text) {
    return text.replace(/New/g, '<span class="new">New</span>');
}); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/zZyLp/3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T23:14:03.077

这也是一个非常简单的方法：

```
$("a:contains('New')").each(function() {
    $(this).html(function(index, text) {
        return text.replace('New', '<span class="new">New</span>');
    });
}); 
```

从这里开始：[JavaScript/jQuery：替换部分字符串？](https://stackoverflow.com/questions/6177200/javascript-jquery-replace-part-of-string)

编辑：

[Ricardo Lohmann](https://stackoverflow.com/a/11336366/1339786)的答案更好，杀死了 each() 函数：

```
$("a:contains('New')").html(function(i, text) {
    return text.replace(/New/g, '<span class="new">New</span>');
}); 
```

# image - 快速简单的图像哈希算法

> ID：11336209
> 
> 赞同：12
> 
> 时间：2012-07-04T23:02:26.967
> 
> 标签：image, algorithm, hash

我需要一个（最好是简单快速的）图像散列算法。哈希值用于查找表，而不是用于密码学。

一些图像是“计算机图形”——即纯色填充的矩形、光栅化文本等，而也有“摄影”图像——包含丰富的色谱，大部分是平滑的，具有合理的噪声幅度。

我还希望散列算法能够应用于特定的图像部分。我的意思是，图像可以划分为一个网格单元格，每个单元格的哈希函数应该只取决于这个单元格的内容。因此，如果两个图像具有共同区域（以防它们正确对齐），则可以快速发现。

**注意：**我只需要知道两个图像（或它们的部分）是否**相同**。也就是说，我不需要匹配相似的图像，不需要特征识别、相关和其他DSP技术。

我想知道首选的哈希算法是什么。

对于“摄影”图像，只需对网格单元内的所有像素进行异或运算或多或少都可以。不同图像的相同哈希值的概率非常低，特别是因为（近乎白）噪声的存在破坏了所有潜在的对称性。加上这种散列函数的频谱看起来不错（任何值都可能具有几乎相同的概率）。

但这种幼稚的算法可能不适用于“人造”图形。相同像素、重复图案、几何偏移不变性对于此类图像非常常见。对于具有偶数个相同像素的任何图像，对所有像素进行异或运算将为 0。

使用像 CRT-32 之类的东西看起来很有希望，但我想更快地找出一些东西。我想到了迭代公式，每个新像素都会改变当前的哈希值，如下所示：

```
hashValue = (hashValue * /*something*/ | newPixelValue) % /* huge prime */ 
```

做模素数可能会产生良好的分散性，所以我倾向于这个选项。但我想知道是否有更好的变体。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T13:50:43.930

如果你想让它变得非常快，你应该考虑随机抽取像素子集来避免读取整个图像。接下来，在这些像素的值序列上计算哈希函数。随机子集应由具有固定种子的确定性伪随机数生成器选择，以便相同的图像产生相同的子集并因此产生相同的哈希值。

即使对于人造图像，这也应该可以很好地工作。但是，如果您的图像彼此相差少量像素，则会产生散列冲突。更多的迭代提供更好的可靠性。如果是这种情况，例如，如果您的图像集可能具有具有一个不同像素的对，则您必须读取每个像素以计算散列值。即使对于人工图像，使用伪随机系数进行简单的线性组合也足够了。

一个简单算法的伪代码

```
Random generator = new generator(2847)  // Initialized with fixed seed
int num_iterations = 100

int hash(Image image) {
    generator.reset()   //To ensure consistency on each evaluation
    int value = 0
    for num_iteration steps {
        int nextValue = image.getPixel(generator.nextInt()%image.getSize()).getValue()
        value = value + nextValue*generator.nextInt()
    }
    return value
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-05T14:00:54.257

看看这个关于 phash 算法的教程[http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html](http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html)用于查找紧密匹配的图像。

# php - 显示动态添加的多阵列元素

> ID：11336216
> 
> 赞同：0
> 
> 时间：2012-07-04T23:03:03.420
> 
> 标签：php

我有一个创建两种类型元素的 javascript。PHP 代码是在提交表单时添加的，但我在上面显示了它。

第一种类型如下所示：

```
<tr class="disc">
    <span><?php echo $disc_number ?></span>.
</tr> 
```

第二种类型如下所示：

```
<tr class="track">
    <input name="trackNumbers[]" value="<?php echo $track_number ?>" />
    <input name="discNumbers[]" value="<?php echo $disc_number ?>" />
</tr> 
```

对于一个“盘”元素，“轨道”元素可以是多个。

例如：

```
<tr class="disc">
    <span>1</span>.
</tr>
<tr class="track">
    <input name="trackNumbers[]" value="1" />
    <input name="discNumbers[]" value="1" />
</tr>
<tr class="track">
    <input name="trackNumbers[]" value="2" />
    <input name="discNumbers[]" value="1" />
</tr>
<tr class="disc">
    <span>2</span>.
</tr>
<tr class="track">
    <input name="trackNumbers[]" value="1" />
    <input name="discNumbers[]" value="2" />
</tr>
<tr class="track">
    <input name="trackNumbers[]" value="2" />
    <input name="discNumbers[]" value="2" />
</tr> 
```

为了在提交时显示每个“track”元素，我使用了“for”命令。

```
for ($track_i = 0; $track_i < $total_tracks; $track_i++) 
```

但是“圆盘”元素呢？如何使我的“光盘”元素在提交时也显示，并在它们之后显示它们的“轨道”元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:09:23.843

如果我正确理解您的意思，您需要将轨道元素与光盘编号相关联......所以使用多维数组：

```
<tr class="track">
    <input name="trackNumbers[<?php echo $disc_number ?>][]" value="<?php echo $track_number ?>" />
</tr> 
```

如果我没记错的话，这将产生（在提交时在 PHP 中）一个数组数组，其中每个第一级数组（每个磁盘一个）包含一个轨道数组（每个轨道一个）。

```
foreach($_POST['trackNumbers'] as $discNumber => $tracksArray) {
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:09:38.927

你现在设置它的方式是你有两个单独的数组轨道和光盘，为了获得与正确光盘关联的轨道号，我会像这样设置输入元素：

```
 <input name="trackNumbers[1][]" value="2"> 
```

其中 1 是光盘编号，您可能希望传入一次光盘编号，然后在后端使用它们循环并拉出与光盘编号对应的所有轨道。

# ruby-on-rails - 什么阶段添加认证？

> ID：11336224
> 
> 赞同：1
> 
> 时间：2012-07-04T23:04:20.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authentication, database-design, authorization

我即将开始构建一个 Rails 应用程序，该应用程序最终需要按用户更改 CRUD 访问权限（即他们看到哪些页面，他们可以编辑哪些页面等）。

是否有开发周期的最佳阶段来整合这一点？

我的一部分感觉它应该是第一件事，因为几乎每一部分界面都会以某种方式依赖于检查用户的 ID，这将是数据库结构的固有部分。

另一部分人认为这会使开始的事情变得过于复杂，我应该构建应用程序的核心部分，然后再在身份验证/授权上分层。

有没有围绕这类事情的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:15:38.487

我会说，如果您的系统将依赖某种身份验证...为什么要等待？

假设您开始在没有身份验证层的情况下开发应用程序，但同时您知道**在某些时候**您必须这样做。这意味着在某些时候您将开发身份验证层，并且很可能您将不得不**重构**您已经构建的内容以使其适应这个新层。

另外，为了说服你多一点……当你说：

> 相反，我应该构建应用程序的核心部分

您应该考虑到身份验证模块也可能是应用程序的核心部分......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:12:38.097

我更喜欢早点做，但不管你什么时候做，你面前的工作量都差不多。这真的是一个意见问题，你喜欢什么时候做。

# algorithm - 停止二分搜索证明

> ID：11336225
> 
> 赞同：0
> 
> 时间：2012-07-04T23:04:22.333
> 
> 标签：algorithm, binary-search

```
l = -1; u = n;
while l+1 != u
    m = l + (u-l)/2;
    if x[m] < t
        l = m;
    else
        u = m;
p = u;
if p >= n || x[p] != t
     p = -1; 
```

在上面的代码中，我们假设 x[-1] < t 和 x[n] >= t 和 n >= 0。上面的代码是一个修改过的二分查找，它可以返回整数数组 x[0..n-1] 中*第一次*出现的整数*t*，而不是返回一个随机的。

我的问题是这样的：

为什么上面的代码总是停止？任何人都可以解释或证明吗？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:09:54.903

因为在每次迭代中，在整数运算的约束范围内，两者之间`l`的差距减半。`u`所有（正）整数减半的序列最终都必须达到 1，这是终止条件。

# python - Python 消歧义

> ID：11336231
> 
> 赞同：1
> 
> 时间：2012-07-04T23:05:20.883
> 
> 标签：python, disambiguation

我目前正在为 rpg 游戏构建 MUD（多用户域）。完全用 Python 做这件事，既可以制作我喜欢的游戏，又可以学习 Python。我遇到的一个问题，由于问题的极端特殊性，我一直无法找到正确的答案。

所以，简而言之，这就是我需要的。我没有一个很好的代码片段来完全显示我需要什么，因为我必须粘贴大约 50 行才能使我使用的 5 行有意义。

```
targetOptions = ['Joe', 'Bob', 'zombie', 'Susan', 'kobold', 'Bill'] 
```

我们游戏中的命令是攻击，我们输入“僵尸”，然后我们继续杀死僵尸。但是，我只想输入“a z”。我们在代码中尝试了一些不同的东西，但它们都不稳定并且经常出错。我们的一项尝试返回了类似 ['sword', 'talisman'] 的内容作为 'get Sword' 的匹配项。那么，有没有办法搜索这个列表并让它返回一个匹配的值？

如果房间里有 2 个僵尸，我还需要返回 value[0]，然后我输入“a z”。感谢您提前提供的所有帮助，我希望我对我正在寻找的内容足够清楚。如果需要更多信息，请告诉我。不要担心整个攻击的事情，我只需要发送'zo'并获得'zombie'或类似的东西。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:36:59.087

欢迎使用 SO 和 Python！我建议您查看[官方 Python 文档](http://docs.python.org/)并花一些时间查看[Python 标准库](http://docs.python.org/library/index.html)中包含的内容。

difflib模块包含一个可以帮助您进行近似字符串比较的[函数。](http://docs.python.org/library/difflib.html)`get_close_matches()`这是它的样子：

从 difflib 导入 get_close_matches

```
def get_target_match(target, targets):
    '''
    Approximates a match for a target from a sequence of targets,
    if a match exists.
    '''
    source, targets = targets, map(str.lower, targets)
    target = target.lower()

    matches = get_close_matches(target, targets, n=1, cutoff=0.25)

    if matches:
        match = matches[0]
        return source[targets.index(match)]
    else:
        return None

target = 'Z'
targets = ['Joe', 'Bob', 'zombie', 'Susan', 'kobold', 'Bill']
match = get_target_match(target, targets)
print "Going nom on %s" % match # IT'S A ZOMBIE!!! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:10:21.597

```
>>> filter(lambda x: x.startswith("z"), ['Joe', 'Bob', 'zombie', 'Susan', 'kobold', 'Bill'])
['zombie']
>>> cmd = "a zom"
>>> cmd.split()
['a', 'zom']
>>> cmd.split()[1]
'zom'
>>> filter(lambda x: x.startswith(cmd.split()[1]), ['Joe', 'Bob', 'zombie', 'Susan', 'kobold', 'Bill'])
['zombie'] 
```

这有帮助吗？

`filter`为第一个参数接受的内容过滤列表（第二个参数）。 `cmd`是您的命令，并`cmd.split()[1]`获得空格之后的部分。 `lambda x: x.startswith(cmd.split()[1])`是一个函数（一个 lambda 表达式），它询问“是否`x`以空格后的命令开头？”

对于另一个测试，如果`cmd`是“a B”，那么有两个匹配项：

```
>>> cmd = "a B"
>>> filter(lambda x: x.startswith(cmd.split()[1]), ['Joe', 'Bob', 'zombie', 'Susan', 'kobold', 'Bill'])
['Bob', 'Bill'] 
```

# c# - 如何禁用向上/向下键在 Visual Studio 中滚动方法重载？

> ID：11336233
> 
> 赞同：7
> 
> 时间：2012-07-04T23:05:25.987
> 
> 标签：c#, c++, visual-studio-2010, visual-studio, keyboard-shortcuts

在 Visual Studio 2010 C++/C#（以及几乎每个版本的 VS）中，当工具提示处于活动状态时，向上/向下箭头键将滚动浏览工具提示方法重载（通过键入方法名称或按 Ctrl+Shift+Space 同时在方法内）。

有什么办法可以禁用此功能？当这些工具提示出现时，我在尝试使用键盘导航文件时经常挂断电话。如果有办法使用 Ctrl+Up/Down 来滚动方法重载，那就太好了，但完全禁用该功能就足够了。

我只想让我的文本编辑器让我导航和编辑文本并停止劫持我的箭头键。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T12:52:11.303

这可能是 Resharper 的事情。将此选项从“箭头键”设置为“显示参数信息”给了我我的箭头键：

![在 Visual Studio 的 Resharper 中禁用黄色工具提示上的箭头键](../Images/7552e1495dcb8f94088734f20f90ee6e.png)

# google-maps-api-3 - 如何使用 gmap3 插件删除渲染的路线？

> ID：11336234
> 
> 赞同：2
> 
> 时间：2012-07-04T23:05:32.787
> 
> 标签：google-maps-api-3, jquery-gmap3

我使用 GMAP3 插件来渲染行车方向。并且想添加一个清除按钮，以便它可以清除但我无法在 GMAP3 中找到正确的语法。这是我的 js 代码，从 gmap3.net 中的示例修改而来。我已经绘制了标记，并且从绘制的标记而不是从地图上的点击位置检索 latlng。

```
function removePath() {
    $(mapID).gmap3({
        action: 'clear',
        name: 'directionRenderer'
        // tag: 'path'  // works too with tag instead of name
});

function updatePath() {
$(mapID).gmap3({
    action: 'getRoute',
    options: {
            origin: m1.getPosition(),
            destination: m2.getPosition(),
            travelMode: google.maps.DirectionsTravelMode.DRIVING
    },
    callback: function (results) {
            if (!results) return;
            $(mapID).gmap3({ 
                action: 'setDirections', 
                directions:results,

            });
    }
});
};

function updateDirection(mm) { // Directions between m1 and m2
var mmID = $(mm).prop('id');
...
if (mmID == 'clearDirection') {
...
    removePath();
    return;
};
...
if (m1 && m2) { updatePath(); };    
};

function initmap() {
    $(mapID).gmap3(
        {
        action: 'init',
        options: defaultMapOptions
        },
    // add direction renderer to configure options (else, automatically created with default options)
        {   action: 'addDirectionsRenderer',
        preserveViewport: true,
        markerOptions: { visible: false },
        options: {draggable:true},
        tag: 'path'
        },
    // add a direction panel
        {   action: 'setDirectionsPanel',
        id: 'directions'
        }
    ); 
```

};

A 在 HTML 文档中作为方向面板放置。它有一个包装器，当使用 jquery css 属性更改清除路由时，它会被隐藏。每当将值分配给 m1 或 m2 时，包装器 div 的显示属性都会更改回“块”。

```
<body> 
...
<div id="direction_container" class="shadowSE">
    ....
    <div id="directions"></div>
    ....
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T09:19:16.953

它绝对工作正常。

```
$map.gmap3({ action: 'clear', name: 'directionRenderer' }); 
```

*说明 - 如果您稍后绘制路线，那么您必须在下面编写代码，否则不会显示方向。

```
$map.gmap3({ action: 'addDirectionsRenderer', preserveViewport: true, 
markerOptions: { visible: false} }, 
{ action: 'setDirectionsPanel', id: 'directions' }); 
```

谢谢...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T12:55:02.537

用这个：

```
$(mapID).gmap3({action:"clear", name:"directionRenderer"}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-12T20:44:21.813

上面选择的答案对我不起作用。我不确定它是否与版本相关，但我使用的解决方案更简单：

```
$(your-selector).gmap3({clear: {}}); 
```

之后，您可以绘制一条新路线，而无需重新连接使用地图呈现的方向。

# css - LESS CSS 伪类可以将选择器的属性传递给函数吗？

> ID：11336235
> 
> 赞同：1
> 
> 时间：2012-07-04T23:05:48.930
> 
> 标签：css, css-selectors, less, pseudo-class

我目前正在尝试在 LESS CSS 中为我​​的渐变创建单点定义。我创建了一个为我编写跨浏览器 CSS 代码的函数，但有一个问题我无法解决。

我想指定一次渐变并有一个单独的函数（监听参数“flip”）在悬停时交换两个颜色变量。我在下面发布了一个示例：

```
 selector { .background-gradient(rgba(27, 117, 185, .35), 48%, rgba(22, 97, 154, .35), 52%); }
    selector:hover { .background-gradient(flip); } 
```

我一直在寻找解决方案，但当然，一无所获。总结一下：我想要一个函数来读取选择器的渐变值并使用它们通过交换颜色来创建悬停样式。我希望这是可能的。

提前致谢！

PS：创建监听“翻转”（模式匹配）的功能不是问题，但我认为它可以让您更好地了解我实际想要实现的目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T04:55:04.980

它不是 100% 清楚你想要什么，但为什么不拥有这样的东西

```
.selector {
  @startCol: rgba(27, 117, 185, .35);
  @startPercentage: 48%;
  @endCol: rgba(22, 97, 154, .35)
  @endPercentage: 52%;
  .gradient(@startCol, @startPercentage, @endCol, @endPercentage);
  &:hover {
    .gradient(@endCol, @endPercentage, @startCol, @startPercentage);
  }
} 
```

如果在悬停时翻转很常见，您可以将上面的内容设置为 mixin，然后您只需为每个类/渐变定义调用一次。

mixin 无法知道先前传递给函数的参数或调用带有值数组的 mixin。

# php - 带有 Facebook API 的 php 和 javascript 中的 Access_token

> ID：11336238
> 
> 赞同：1
> 
> 时间：2012-07-04T23:06:44.173
> 
> 标签：php, facebook, actionscript-3, facebook-graph-api, fbjs

我在将我的游戏集成到 Facebook 时遇到问题。在阅读文档后，我了解到从 Flash 与 FB 进行通信的最佳和最新方式是通过 JavaScript 上的 Facebook API。我称之为获取所有 ui 对话框和基本登录信息。现在，我的 Flash 游戏连接到 php 以发送和接收高分，如下所示：

score.php?action=NEWSCORE&userId=123123123&score=100

score.php?action=VIEW

score.php?action=VIEWFRIENDS&userId=123123123

现在，在 score.php 中，当我设置 VIEWFRIENDS 操作时，我希望 php 创建 facebook 查询。我通过添加来做到这一点

```
// Init the Facebook SDK
$facebook = new Facebook(array(
'appId'  => $app_id,
'secret' => $app_secret,
));

// Get the current user
$user = $facebook->getUser();

$access_token = $facebook->getAccessToken();
$fbresponse = $facebook->api("/me/friends?fields=installed", array('access_token'=>$access_token.$access_token,));

if ($fbresponse)
{
    $friendsData = $fbresponse['data'];
    $friendsString = '';
    $friendCount = 0;
    for ($i = 0; $i < sizeof($friendsData); $i++)
    {
        $friend = $friendsData[$i];

        if ($friend['installed'])
        {
            if ($friendCount > 0)
                $friendsString = $friendsString . ",";

            $friendsString = $friendsString . "'" . $friend['id'] . "'";                    $friendCount++;
        }
    }
    // Get the friends highscores
    $sql = "SELECT * FROM Highscores WHERE FacebookId IN (" . $friendsString . ") ORDER BY Score DESC LIMIT " . $scoresize ;
    $result = mysql_query($sql);
} 
```

执行此操作时，如果我在 Facebook 之外对其进行测试，一切似乎都可以正常工作，但是当我将其集成到我的应用程序中时，它会引发以下错误：

> ```
> <br />
> <b>Fatal error</b>:  Uncaught OAuthException: Invalid access token signature.
>   thrown in <b>/home/public_html/mysite.org/games/myGameFacebook/fb-php-sdk/base_facebook.php</b> 
> ```
> 
> 在线**1106**

我正在尝试检查发生了什么，但我还没有弄清楚该怎么做。我了解访问令牌是在通过此代码登录时在 Javascript 上生成的。

```
getLoginStatus:function() {
    log("getLoginStatus");
    FB.getLoginStatus(function(response) {
        if (response.status === 'connected') {

            log("Logged in.");
            F.token = response.authResponse.accessToken;
            F.getCurrentUserInfo();
        } else if (response.status === 'not_authorized') {
            log("User did not authorize app");
        } else {
            log("Not logged in.");
            FB.login(function(response) {
                if(response.session) {
                    log("Logging successful.");
                    F.token = response.session.access_token;
                    F.getCurrentUserInfo();
                } else {
                    log("Logging failed.");
                }
            });
        }
    });
}, 
```

我该如何解决这个问题？我一直试图了解如何做到这一点，但我读过它要么不可能，要么链接到一些从未起作用的未知会话变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:36:43.253

您在调用 $facebook->api 时将访问令牌与自身连接起来

```
array('access_token'=>$access_token.$access_token,) 
```

应该看起来像：

```
array('access_token'=>$access_token,) 
```

但我想您应该使用应用访问令牌来检索您需要的内容，其功能如下：

```
 // Helper function to get an APP ACCESS TOKEN
 function get_app_access_token($app_id, $app_secret) {
   $token_url = 'https://graph.facebook.com/oauth/access_token?'
     . 'client_id=' . $app_id
     . '&client_secret=' . $app_secret
     . '&grant_type=client_credentials';

   $token_response =file_get_contents($token_url);
   $params = null;
   parse_str($token_response, $params);
   return  $params['access_token'];
 } 
```

您需要将您可以在 Facebook 开发者应用页面上阅读的应用密码传递给它。

# c++ - 我应该使用内存地址作为 C++ 中的应用程序级标识符吗？

> ID：11336243
> 
> 赞同：1
> 
> 时间：2012-07-04T23:07:47.103
> 
> 标签：c++

我正在学习 C++，我想知道使用对象的分配内存地址作为临时应用程序级别标识符是否是个好主意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:11:21.770

这可能不是最好的主意。如果不出意外，它会严重限制您未来移动/克隆对象的能力。如果您依靠它从 ID 中查找对象，也会增加风险——过时的引用可能会导致崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T00:23:45.727

你不应该这样做。因为除了这里已经提到的内容之外，地址会被重用，并且您的 id（本质上是一个指针）可以在旧对象被释放后被其他对象重用。例如，如果此 ID 将用于访问某些会话信息，那么您很可能正在访问/修改其他用户的会话 - 这不是一件好事。但是，您可以将地址与其他一些信息结合使用，例如线程 ID、当前系统时间等...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T23:40:09.630

好吧，如果您使用 new() 创建对象，则返回的对象实例指针实际上就是该对象。它成为应用程序标识符，直到显式 dispose()d。我尽量不在堆栈上构建对象——我写了太多的多线程代码，所以它太危险了。

显然，您不能将地址作为 ID 做很多事情 - 例如，您不能递减/递增 1 以指向具有前/后 ID 的对象。

# c# - 当数据源增加时，DataGrid 不会扩展以容纳更多项目

> ID：11336245
> 
> 赞同：0
> 
> 时间：2012-07-04T23:08:04.033
> 
> 标签：c#, datagrid, compact-framework, datasource

我在.net compact framework C#中有一个数据网格，我将它的数据源设置为一个列表，我的问题是当列表大小增加时，网格没有添加新的内容，我必须通过退出表单重新创建网格并返回它以查看新条目。可见行数保持不变，因此例如，如果我从列表中的 10 到 20 个条目，数据网格仍然只显示 10 个可见行，如果我退出并重新输入表单，相同的列表最终会给出数据网格所有20 可见行..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:30:23.007

您的清单需要实施`INotifyCollectionChanged`。一种方法是使用[ObservableCollection<T>](http://msdn.microsoft.com/en-us/library/ms668604.aspx)。当您绑定到支持 的对象`INotifyCollectionChanged`时，网格将在添加或删除记录时更新。

如果当对象的属性发生变化时网格单元需要更新，那么您的对象需要实现`INotifyPropertyChanged`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T01:46:51.620

实际上没有办法做到这一点，我最终每次发生变化时手动重新填充数据库，然后刷新它以确保更改变得可见。

# mysql - MySQL MIN GROUP BY 在大表上（> 8000 行）

> ID：11336246
> 
> 赞同：2
> 
> 时间：2012-07-04T23:08:09.520
> 
> 标签：mysql, group-by, min

我有以下查询：

```
SELECT contact_purl, contact_firstName, contact_lastName, MIN( contact_id ) AS MinID
FROM contacts
WHERE contact_client_id = 1
GROUP BY contact_purl
HAVING COUNT( contact_id ) > 1 
```

目的是查找具有重复“contact_purl”的任何联系人并返回第一个条目。

我遇到了一个非常奇怪的问题......如果表的行数少于 8,000，则查询将在不到 1 秒的时间内呈现。但是，如果表的行数超过 8,000 行，则查询将持续平均持续 338 秒。

这是大约 5000 行的表的查询计划： ![在此处输入图像描述](../Images/5c5c3db818d2edadf2b7aeb2361510f9.png)

对于约 8000 行： ![在此处输入图像描述](../Images/02a683804395de9f84be59658991752f.png)

桌子...

```
 CREATE TABLE IF NOT EXISTS `contacts` (
  `contact_id` int(11) NOT NULL AUTO_INCREMENT,
  `contact_client_id` int(11) DEFAULT NULL,
  `contact_sales_id` int(11) DEFAULT NULL,
  `contact_campaign_id` int(11) DEFAULT NULL,
  `contact_purl` varchar(100) NOT NULL,
  `contact_purl1` varchar(50) DEFAULT NULL,
  `contact_purl2` varchar(50) DEFAULT NULL,
  `contact_firstName` varchar(50) NOT NULL,
  `contact_lastName` varchar(50) NOT NULL,
  `contact_organization` varchar(100) DEFAULT NULL,
  `contact_url_organization` varchar(200) DEFAULT NULL,
  `contact_position` varchar(50) DEFAULT NULL,
  `contact_email` varchar(100) DEFAULT NULL,
  `contact_phone` varchar(20) DEFAULT NULL,
  `contact_fax` varchar(20) NOT NULL,
  `contact_address1` varchar(100) DEFAULT NULL,
  `contact_address2` varchar(100) DEFAULT NULL,
  `contact_city` varchar(100) DEFAULT NULL,
  `contact_state` varchar(20) DEFAULT NULL,
  `contact_zip` varchar(10) DEFAULT NULL,
  `contact_IP` varchar(50) DEFAULT NULL,
  `contact_timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `contact_pw` varchar(200) NOT NULL,
  `contact_subscribed` varchar(1) NOT NULL DEFAULT 'Y',
  `contact_import` varchar(200) DEFAULT NULL,
  `contacts_c_1` varchar(500) DEFAULT NULL,
  `contacts_c_2` varchar(500) DEFAULT NULL,
  `contacts_c_3` varchar(500) DEFAULT NULL,
  `contacts_c_4` varchar(500) DEFAULT NULL,
  `contacts_c_5` varchar(500) DEFAULT NULL,
  `contacts_c_6` varchar(500) DEFAULT NULL,
  `contacts_c_7` varchar(500) DEFAULT NULL,
  `contacts_c_8` varchar(500) DEFAULT NULL,
  `contacts_c_9` varchar(500) DEFAULT NULL,
  `contacts_c_10` varchar(500) DEFAULT NULL,
  `contacts_c_11` varchar(500) DEFAULT NULL,
  `contacts_c_12` varchar(500) DEFAULT NULL,
  `contacts_c_13` varchar(500) DEFAULT NULL,
  `contacts_c_14` varchar(500) DEFAULT NULL,
  `contacts_c_15` varchar(500) DEFAULT NULL,
  `contacts_c_16` varchar(500) DEFAULT NULL,
  `contacts_c_17` varchar(500) DEFAULT NULL,
  `contacts_c_18` varchar(500) DEFAULT NULL,
  `contacts_c_19` varchar(500) DEFAULT NULL,
  `contacts_c_20` varchar(500) DEFAULT NULL,
  `contacts_c_21` varchar(500) DEFAULT NULL,
  `contacts_c_22` varchar(500) DEFAULT NULL,
  `contacts_c_23` varchar(500) DEFAULT NULL,
  `contacts_c_24` varchar(500) DEFAULT NULL,
  `contacts_c_25` varchar(500) DEFAULT NULL,
  `contacts_c_26` varchar(500) DEFAULT NULL,
  `contacts_c_27` varchar(500) DEFAULT NULL,
  `contacts_c_28` varchar(500) DEFAULT NULL,
  `contacts_c_29` varchar(500) DEFAULT NULL,
  `contacts_c_30` varchar(500) DEFAULT NULL,
  `contacts_c_31` varchar(500) DEFAULT NULL,
  `contacts_c_32` varchar(500) DEFAULT NULL,
  `contacts_c_33` varchar(500) DEFAULT NULL,
  `contacts_c_34` varchar(500) DEFAULT NULL,
  `contacts_c_35` varchar(500) DEFAULT NULL,
  `contacts_c_36` varchar(500) DEFAULT NULL,
  `contacts_c_37` varchar(500) DEFAULT NULL,
  `contacts_c_38` varchar(500) DEFAULT NULL,
  `contacts_c_39` varchar(500) DEFAULT NULL,
  `contacts_c_40` varchar(500) DEFAULT NULL,
  `contacts_c_41` varchar(500) DEFAULT NULL,
  `contacts_c_42` varchar(500) DEFAULT NULL,
  `contacts_c_43` varchar(500) DEFAULT NULL,
  `contacts_c_44` varchar(500) DEFAULT NULL,
  `contacts_c_45` varchar(500) DEFAULT NULL,
  `contacts_c_46` varchar(500) DEFAULT NULL,
  `contacts_c_47` varchar(500) DEFAULT NULL,
  `contacts_c_48` varchar(500) DEFAULT NULL,
  `contacts_c_49` varchar(500) DEFAULT NULL,
  `contacts_c_50` varchar(500) DEFAULT NULL,
  `contacts_i_1` varchar(100) DEFAULT NULL,
  `contacts_i_2` varchar(100) DEFAULT NULL,
  `contacts_i_3` varchar(100) DEFAULT NULL,
  `contacts_i_4` varchar(100) DEFAULT NULL,
  `contacts_i_5` varchar(100) DEFAULT NULL,
  `contacts_i_6` varchar(100) DEFAULT NULL,
  `contacts_i_7` varchar(100) DEFAULT NULL,
  `contacts_i_8` varchar(100) DEFAULT NULL,
  `contacts_i_9` varchar(100) DEFAULT NULL,
  `contacts_i_10` varchar(100) DEFAULT NULL,
  `contacts_i_11` varchar(100) DEFAULT NULL,
  `contacts_i_12` varchar(100) DEFAULT NULL,
  `contacts_i_13` varchar(100) DEFAULT NULL,
  `contacts_i_14` varchar(100) DEFAULT NULL,
  `contacts_i_15` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`contact_id`),
  KEY `contact_campaign_id` (`contact_campaign_id`),
  KEY `contact_client_id` (`contact_client_id`),
  KEY `contact_purl2` (`contact_purl2`),
  KEY `contact_purl1` (`contact_purl1`),
  KEY `contact_purl` (`contact_purl`)
) 
```

我最近也对表格进行了优化和碎片整理。

关于什么会导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:09:40.783

首先，感谢您在问题中发布表结构、查询和`EXPLAIN`输出。我认为您正在跨越内存/磁盘临时表大小边界，因此性能发生了很大变化。如果您在contact_purl 列上放置唯一索引，MySQL 将不允许插入重复项。这将使您的查询变得不必要。否则，我会在 (contact_client_id, contact_purl) 上创建一个索引，以便 MySQL 可以直接从索引中找出您想要的行。您还可以尝试分离对列的搜索并使用子查询检索它们。可能是这样的：

```
SELECT contact_purl, contact_firstName, contact_lastName, contact_id
FROM contacts, (SELECT MIN(contact_id) AS MinID
FROM contacts
WHERE contact_client_id = 1
GROUP BY contact_purl
HAVING COUNT( contact_id ) > 1) nodups WHERE nodups.MinID = contacts.contact_id 
```

# cocoa - 从 WebBackForwardList 中删除条目

> ID：11336249
> 
> 赞同：1
> 
> 时间：2012-07-04T23:08:40.130
> 
> 标签：cocoa, list, webkit

我正在尝试从Cocoa 应用程序中`WebBackForwardList`的 a中删除一个条目。`WebView`有没有办法做到这一点？还是首先防止将特定条目添加到列表中的方法？

# facebook - 使用 Facebook Connect 作为唯一的登录解决方案 + 墙贴

> ID：11336250
> 
> 赞同：0
> 
> 时间：2012-07-04T23:08:46.433
> 
> 标签：facebook, facebook-wall

我有一个即将改造的庭院销售网站，而不是使用我自己的用户数据库，我想使用 Facebook 连接来验证人们进入我的网站，这是我需要他们这样做的唯一原因首先是在我的网站上发布庭院销售后，我希望能够在他们的墙上发布他们正在进行庭院销售的信息。

所以，我的两个问题是：

是否可以在没有我自己的用户数据库的情况下使用 Facebook Connect？我知道我必须将 facebook ID 等存储在数据库表中，这没问题，我只是不想给出“单击此处创建帐户”+“单击此处”这样令人困惑的选项使用您的用户名和密码登录”+“或单击此处使用 facebook 登录”。我只喜欢最后一个选项。

第二个问题是，有没有办法强迫用户允许我在他们的墙上发帖？我知道他们可以在使用 facebook 登录时取消选中该选项，但我可以验证该权限并要求他们在选中该选项的情况下重新登录吗？我不是想成为一个刺头，我提供的是一项完全免费的出色服务，作为交换，我只是希望能够将他们的销售发布在他们自己的墙上，这样我就可以传播这个词。我希望这不是可选的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:42:41.553

要回答你的第一个问题，是的。您不需要自己的用户数据库，但是您需要保存您的用户身份验证密钥和 ID，以便能够随时发布。如果您不需要能够随时发布（例如当用户不在线时），而只是在您网页上的用户操作（这可能是最常见的）上发布，则可以选择将数据保存在会话中。因此，根据您的需求，您根本不需要数据库。

第二个问题，您可以随时检查用户是否已使用 API 授予权限。所以你可以做的是有一个页面，上面写着他必须批准才能进入你的页面，以及一个指向身份验证对话框的链接。虽然，我不推荐它，但我怀疑它会对你有什么好处，而且 Facebook 甚至可能不赞成这一点。删除扩展权限的可能性可能是有原因的。

有关使用 REST API 在此处检查授予权限的更多信息：http: [//developers.facebook.com/docs/reference/rest/users.hasAppPermission/](http://developers.facebook.com/docs/reference/rest/users.hasAppPermission/)

# javascript - 从基准访问 d3.js 元素属性？

> ID：11336251
> 
> 赞同：48
> 
> 时间：2012-07-04T23:08:54.173
> 
> 标签：javascript, svg, d3.js

我正在尝试使用 d3.js 的 .data() 函数访问我已经在屏幕上绘制的一些特定 svg 圆圈的 cx 和 cy 属性，有人可以帮忙吗？尝试访问它的代码如下。

```
d3.selectAll(".mynode").each( function(d, i){
  if(d.someId == targetId){
    console.log( d.attr("cx") );    // just trying to demo my point, doesn't work
  }
} 
```

我对 d3.js 和 javascript 还是很陌生，所以我不确定我是否要从头到尾处理这个问题，或者我可能错过了内置的解决方案？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-07-05T00:25:42.240

您的代码正在尝试从数据项中获取 svg 属性，而您真正想要的是从 svg DOM 元素中获取该属性，如下所示：

```
console.log(d3.selectAll(".mynode").attr("cx")); 
```

这只会给你选择的第一个非空元素的属性；您还可以[过滤](https://github.com/mbostock/d3/wiki/Selections#wiki-filter)您的选择以获取您正在寻找的 DOM 元素：

```
console.log(d3.selectAll(".mynode").filter(_conditions_).attr("cx")); 
```

或者，如果您想访问所有选定元素的属性，`this`请在每个函数中使用：

```
d3.selectAll(".mynode").each( function(d, i){
  if(d.someId == targetId){
    console.log( d3.select(this).attr("cx") );
  }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-29T23:38:08.090

还有更简单的方法：（提供索引`i`）

```
d3.selectAll("circle")[0][i].attributes.cx.value 
```

可以在[这里](http://tributary.io/inlet/5817382)看到。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-05-21T16:25:06.627

接受答案中的过滤方法是正确的。接受答案中的第二种方法（使用 .each）是不正确的，并且包含与提问者相同的错误：如果未调用 .data() （这里就是这种情况），则第一个参数 d 传递给 .each将是未定义的（而不是“当前的 dom 节点”，正如包括我自己在内的所有新手所期望的那样）；您通过 d3.select(this) 获得的当前 dom 节点，这在最后的 if 语句中是正确的 - 错误在 if 测试条件中。正确版本如下。

```
d3.selectAll(".mynode").each(function(d,i){
    var elt = d3.select(this);
    if (elt.attr("id") == "yourTargetIdGoesHere"){
        console.log( elt.attr("cx") );
    }
}); 
```

小提琴：[小提琴](http://jsfiddle.net/mathheadinclouds/RhmLA/)（包含两个版本的代码，即过滤器和每个）

更新：我的回答是假设您没有使用 .data()，因为您没有为此提供代码；后来我看到你写道你确实使用了 .data()

在这种情况下，根据您的数据结构，将 d.attr("cx") 替换为普通的 d.cx 可能会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-05T23:36:23.190

这里最简单的是给每个节点一个唯一的 id，然后选择具有目标 id 的节点来运行你的转换。

# jquery - 使用 Jquery 为多个文本阴影设置动画

> ID：11336253
> 
> 赞同：3
> 
> 时间：2012-07-04T23:09:14.783
> 
> 标签：jquery, jquery-ui, css

我正在尝试创建改变颜色的霓虹灯效果。为此，我正在使用（仅适用于 Chrome、FF、Safari 和 Opera）4 个文本阴影，它们都具有相同的颜色但具有不同的模糊大小。静态效果看起来很棒，但我似乎无法更改它的颜色，因为 jquery UI 不支持更改文本阴影颜色，而且我发现的唯一 jquery 插件明确表示它只能为一个文本阴影设置动画.. .

所以我希望你们所有的 JS 策划者已经解决了这个问题，因此可以帮助我！

我在这里看到了这种效果（以一种很棒的方式）：http: [//metafizzy.co/](http://metafizzy.co/)

有人愿意向我解释它是如何实现的吗？我不需要任何花哨的东西...

提前致谢！

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:32:05.987

我认为可以使用 jQuery 函数来完成，`.animate()`如下所示：

```
$('span#your-neon').animate({
    step : function(now,fx){
         // generate values based on the now parameter (0 < now < 2000)
         // $(this).css('text-shadow','...multiple text-shadows based on the generated values....')
    },
    duration : 2000
}) 
```

# c - 在调试期间尝试进行不需要的附加

> ID：11336265
> 
> 赞同：0
> 
> 时间：2012-07-04T23:10:41.157
> 
> 标签：c, debugging, dll, configuration-files

我在 VS2010 解决方案中有 2 个项目。项目 A 生成一个 exe，项目 B 生成一个 DLL。解决方案中的项目 A 以及第 3 方程序都使用项目 B DLL。在发布模式下，Project A 正常工作。但是当我在调试模式下运行项目 A 时，它告诉我它正在尝试（但没有成功）附加到第 3 方程序……这与它无关。我已经搜索了项目 A 的配置文件，但在任何地方都看不到这个第 3 方程序被引用的地方。有任何想法吗？

编辑：消息是：

> “无法附加。进程“...exe”未在戴尔 [我的计算机] 上运行。在尝试另一个附加之前刷新进程列表。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T04:47:44.487

如果您尝试调试项目 A，请检查它是否设置为默认项目并检查调试命令行或选项。

# php - 在没有 cron 的 PHP 中调度任务

> ID：11336270
> 
> 赞同：2
> 
> 时间：2012-07-04T23:11:33.093
> 
> 标签：php, ruby-on-rails, django

是否可以使用 PHP 安排任务？比如，我想用 jQuery datepicker 选择一个日期，然后提交。例如，当该日期等于今天的日期时，将发送一封电子邮件（或任何其他 PHP 脚本）。日期会因用户而异，此外，每个用户都可以有许多计划任务要运行。

**编辑**

操作系统是 Linux，网站托管在 godaddy.com 上。此外，最终用户将选择何时运行这些任务，因此他们可以使用命令行。

**编辑**

也欢迎任何 Ruby on Rails 或 Django 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:17:11.153

如果您使用的是 Unix 服务器，请尝试`at`.

[http://www.manpagez.com/man/1/at/](http://www.manpagez.com/man/1/at/)

它的工作方式与 cron 类似，因为它与 PHP 完全分开，您需要 shell_exec() 一个外部命令。但是，它有一个简单的命令行界面。与 cron 作业一样，`at`作业在重新启动后仍然存在。

如果您使用`at`，则必须编写一个单独的脚本来执行您想要安排的任务。

例子：

```
shell_exec("echo 'php script.php' | at -t 201208011234.56"); 
```

将在 2012 年 8 月 1 日 12:34:56 运行 script.php。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:30:33.000

您需要服务器端的一些进程在预定时间运行任务。

一种流行的方法是将任务信息存储在某个数据库中，并让一个 cron 作业不时检查任务队列 - 这是非常可靠和安全的。

如果没有关于将要部署的环境的更多信息，就不可能给出更好的答案。例如：

*   目标操作系统
*   托管类型（专用、共享、云）
*   你有管理员权限吗？
*   它暴露在互联网上吗？

无论如何，您很可能无法在共享托管环境中执行此操作，但我必须说，从安全角度来看，拥有一个调用 shell_exec 的网站并不是很明智，所以如果该网站暴露在互联网上，我会避免这种情况.

一个好的托管服务提供商应该有某种可用的后台任务调度程序，即使它不是 crontab。如果您的托管服务提供商没有，那么试图通过一些噱头来填补空白可能是个坏主意。

[更新]

> 正如我在原帖的编辑部分所说，我将它托管在 godaddy.com 上，我不能让客户端运行这些命令行等。还有其他语言的解决方案吗？

我不再在 godaddy 托管，但他们曾经在他们的控制面板上有一个“Cron Manager”。我认为正确的 goDaddy cron 设置是

```
/usr/bin/wget -O - -q "http://yoursite.com/cron.php" > /dev/null 2>&1 
```

在 Cron 管理器的命令选项中。这个“cron.php”将检查任务队列以查看是否有任何电子邮件要发送（任务队列是数据库中的一个简单表，您将在其中记录客户安排的任何任务）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T23:19:40.500

您可以在没有 cron 的情况下执行此操作，只需在主索引页面或标准包含文件中添加一个检查 - 但这仅适用于您确实无法访问 cron（例如共享主机）的情况。在此检查中，您将获取未完成操作的列表并执行它们，可能通过使用

```
if (time_since_last_run > 5*60) // minutes
    shell_exec("/usr/bin/php /var/www/check-tasks.php &"); 
```

最好的解决方案是使用 cron 启动一个 PHP 脚本，该脚本将检查系统中的计划项目并执行它们。您可以通过 wget 或直接通过调用 PHP 来执行此操作。

[我拥有的一个共享托管站点是通过 cron 和 wget http://othersite.example.com](http://othersite.example.com)从我的另一台服务器外部安排的。

crontab 条目示例：

```
0 * * * * wget -O - -q -t 1 http://othersite.example.com/cron.php 
```

# javascript - MongoDB shell：在没有尾随换行符的情况下打印到控制台？

> ID：11336274
> 
> 赞同：10
> 
> 时间：2012-07-04T23:12:48.283
> 
> 标签：javascript, shell, mongodb, stdout

有没有办法在没有来自 Mongo shell 的尾随换行符的情况下写入 STDOUT？`print()`除了可用之外，我似乎找不到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T00:01:06.937

这与我关于[从控制台读取一行的](https://stackoverflow.com/questions/11333248/mongodb-shell-reading-a-line-from-the-console)SO 问题有关。根据@Stennie 的评论，在当前 (2.0.6) 版本的 Mongo shell 中是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-15T21:37:23.047

可能有办法解决它。您可以将结果累积在一个中间变量（可以是数组、字符串或任何其他数据结构）中，然后在一行中打印整个内容。下面的示例说明了使用数组从查询结果中捕获值，然后将数组转换为以逗号作为分隔符的字符串。就我而言，我只对这个`_id`领域感兴趣：

```
var cursor = db.getCollection('<collection name>').find(<your query goes here>)
let values = []
cursor.forEach((doc) => values.push(doc._id))
print(values.join(',')) 
```

根据您期望的结果数量，不确定中间数据结构消耗的空间是否会压倒内存。如果是这种情况，则可以制作查询以返回较小的数据子集，这些数据子集在相加时构成您想要的完整结果集。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2016-10-21T11:57:28.327

这是一个很老的问题，但仍然相关，所以回答。

可以使用 printjsononeline()。

# teamcity - 工件依赖路径必须指定两次？

> ID：11336275
> 
> 赞同：0
> 
> 时间：2012-07-04T23:13:02.207
> 
> 标签：teamcity

我是 TeamCity 的新手，所以也许我在这里没有得到任何东西，但是当我设置配置时，我指定了其工件的路径。当我设置依赖于第一个配置的第二个配置时，我必须在工件依赖项中再次指定工件路径（见图）。这是为什么？还是我错过了什么？这是一个带注释的屏幕截图：![Artifact Dependency 窗口的带注释的屏幕截图](../Images/c7fabdc17360ed7068f372d3f91f2c14.png)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T16:53:12.483

工件路径行允许您从多个工件中进行选择，或从您在“依赖”字段中指定的构建中深入了解特定工件。例如，我们有输出多个工件的构建。然后，我们有依赖于它们的构建，这些构建使用了一个特定的工件。这可能是一个奇怪的数据重复。我们通过将要发布的工件指定为构建参数（如 %"SetupArtifact%"）在某种程度上解决了这个问题，然后您可以在构建中使用工件将其引用为“%dep..SetupArtifact%”您正在从中使用工件的构建的构建类型 ID。

# eclipse - Eclipse 项目中添加了 Ivy 管理，然后呢？

> ID：11336288
> 
> 赞同：0
> 
> 时间：2012-07-04T23:16:19.633
> 
> 标签：eclipse, ivy

已将 Ivy 管理添加到我的一个 Eclipse 项目中。之后什么也没发生。

我有一个指南可以添加一些东西到`ivy.xml`and `ivysettings.xml`，那又怎样？如何创建这些文件的空版本？把它们放在哪里？

我凭直觉在项目根目录中创建了一些，然后将所告知的内容添加到文件中。

没啥事儿。新图书馆在哪里？如何强迫 Ivy 做某事？

版本：Apache IvyDE 2.2.0.beta1-201203282058-RELEASE Eclipse Helios Service Release 2

常春藤指南适用于 xuggler：[http ://www.xuggle.com/downloads](http://www.xuggle.com/downloads)

我已经创建并添加`ivy.xml`了`File New`没有省略号的内容。`icysettings.xml`只是没有省略号的样本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T16:57:29.713

是的 ivy.xml 应该在根目录中（对于默认配置）。尝试这个：

```
<ivy-module 
    version="2.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:noNamespaceSchemaLocation="http://ant.apache.org/ivy/schemas/ivy.xsd"
    xmlns:e="http://ant.apache.org/ivy/extra"> 

       <info organisation="com.organisation" module="stackoverflow" revision="1.0.0" status="integration" >
       </info>

       <configurations>
           <conf name="default" />
       </configurations>

       <dependencies>
                    <dependency org="xuggle" name="xuggle-xuggler" rev="5.2" />
    </dependencies>
</ivy-module> 
```

在根目录中创建 ivysettings.xml 文件。这个适合您的需要

```
<ivysettings> <
    settings defaultResolver="default" />
    <include url="${ivy.default.settings.dir}/ivysettings.xml" />

    <resolvers>
        <url m2compatible="true" name="xugglecode">
            <ivy
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[organization]/[artifact]/[revision]/ivy-[revision].xml" />
            <ivy
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[organization]/[artifact]/ivy-[revision].xml" />
            <artifact
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[organisation]/[artifact]/[revision]/[artifact](-[revision]).[ext]" />
            <artifact
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[organisation]/[artifact]/[artifact](-[revision]).[ext]" />
            <artifact
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[organisation]/[artifact](-[revision]).[ext]" />
            <artifact
                pattern="http://xuggle.googlecode.com/svn/trunk/repo/share/java/[artifact](-[revision]).[ext]" />
            <artifact
                pattern="http://build.xuggle.com/view/Stable/job/red5_jdk6_stable/lastSuccessfulBuild/artifact/workingcopy/dist/[artifact].[ext]" />
        </url>
        <chain name="default" changingPattern=".*SNAPSHOT">
            <resolver ref="xugglecode" />
        </chain>
    </resolvers>
</ivysettings> 
```

现在，当您添加 ivy 管理时，在 Main 选项卡中您应该会看到 Ivy File: ivy.xml 作为默认值。现在转到设置选项卡。选中“启用项目特定设置”复选框。在 Ivy 设置路径中，使用“工作区按钮”更容易选择您刚刚在根项目中创建的路径。导航和选择。

按确定。它将立即开始解决。我应该告诉你，即使文件存在，我也无法检索它。ivy 控制台似乎卡住了。我收到状态码 403。我正在下班。

也许你有更好的运气解决它。如果没有，请将此视为如何设置 IvyDE 的迷你示例。

# ios - 如何使用 MGTwitterEngine 检查重复的推文

> ID：11336289
> 
> 赞同：1
> 
> 时间：2012-07-04T23:16:21.433
> 
> 标签：ios, twitter, mgtwitterengine

我在我的 iOS 应用程序中使用 MGTwitterEngine。

我使用此回调检查是否成功发布了我的消息。

```
- (void)requestSucceeded:(NSString *)connectionIdentifier 
```

但是我如何检查我是否已经发布了我的推文并且我不想复制它。

例如，如果我使用 iOS 5.0 作为响应，我会得到 UIAlertView：

**无法发送推文**

**推文“bla bla bla”是重复的，无法发送。**

如何使用 MGTwitterEngine 创建相同的验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T07:10:02.883

如果您尝试发布重复的消息，Twitter API 将响应

```
403: Status is a duplicate. 
```

检查返回状态代码和消息，这将告诉您推文是否成功。

# python - 使用 QtWebKit 在内存中渲染多个网页会在第二页中断，为什么？

> ID：11336290
> 
> 赞同：1
> 
> 时间：2012-07-04T23:16:33.337
> 
> 标签：python, pyqt4, qtwebkit

我正在使用 PyQt4 的 QtWebKit 在内存中呈现网页，因为我需要执行 javascript，因为我需要检索嵌入式 Flash 视频元素。目前我使用的代码如下所示：

```
import sys
from PyQt4.QtGui import *
from PyQt4.QtCore import *
from PyQt4.QtWebKit import QWebSettings, QWebPage

class Render(QWebPage):
    def __init__(self, url):
        self.app = QApplication(sys.argv)
        QWebPage.__init__(self)

        # Settings
        s = self.settings()
        s.setAttribute(QWebSettings.AutoLoadImages, False)
        s.setAttribute(QWebSettings.JavascriptCanOpenWindows, False)
        s.setAttribute(QWebSettings.PluginsEnabled, True)

        self.loadFinished.connect(self._loadFinished)
        self.mainFrame().load(QUrl(url))
        self.app.exec_()

    def _loadFinished(self, result):
        self.frame = self.mainFrame()
        self.app.quit()

def get_page_source(url):
    r = Render(url)
    html = r.frame.toHtml()
    return html 
```

现在这可以正常工作，尽管初始化非常慢（需要 5-30 秒才能启动），但它只适用于单个页面。这意味着在第一个网页上，我的最终输出如下所示：

```
<div>
    <embed type="application/x-shockwave-flash" src="/player.swf" width="560" height="440" style="undefined" id="mediaplayer" name="mediaplayer" quality="high" allowfullscreen="true" wmode="opaque" flashvars="width=560&amp;height=440&amp;autostart=true&amp;fullscreen=true&amp;file=FILELINK"></embed>
</div> 
```

但是在连续的尝试中，它看起来像这样：

```
<div>
    <font>
        <u>
            <b>
                <a href="http://get.adobe.com/flashplayer/">ATTENTION:<br>This video will not play. You currently do not have Adobe Flash installed on this computer. Please click here to download it (it's free!)
                </a>
            </b>
        </u>
    </font>
</div> 
```

这里发生了什么我不知道的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:45:04.233

看起来您的 javascript 解释器只在第一页启动；第二个页面加载但永远不会运行它的javascript；但这与您的真正问题无关，即视频文件的名称隐藏在看起来像的代码块中

```
<script type="text/javascript">
    var googleCode = 'czEuYWRkVmFyaWFibGUoImZpbGUiLCJodHRwOi8vd2lsbGlhbS5yaWtlci53aW1wLmNvbS9sb2FkdmlkZW8vMDA5YzUwMzNkZmYyMDQ3MmJiYzBjMjk2NmJjNzI2MjIvNGZmNGQ2ZDYvd2ViLXZpZGVvcy9iZTVjYWI2YjcxNmU0OWExZjFiYzc3NGNlMjVlZDg0Yl93YWtlci5mbHYiKTs=';
    eval(lxUTILsign.decode(googleCode));
</script> 
```

如果你调用一个 javascript 控制台并运行`lxUTILsign.decode(googleCode);`你会得到

```
"s1.addVariable(\"file\",\"http://worf.wimp.com/loadvideo/2e368b70f8577ad167087530fc73748d/4ff4f5df/web-videos/35e78d1932b24f80ae3a9210fce008c4_titanic.flv\");" 
```

*坏*消息是 lxUTILsign 被彻底混淆了。好消息*是*，这无关紧要，因为它只是一个 base64 解码器，而 Python 已经有了一个（包括电池，宝贝！）。

```
import base64
import urllib2
import re

def get_video_url(page_url):
    html = urllib2.urlopen(url).read()
    match = re.search("googleCode = '(.*?)'", html)
    if match is None:
        raise ValueError('googleCode not found')
    googleString = base64.b64decode(match.group(1))
    match = re.search('","(.*?)"', googleString)
    if match is None:
        raise ValueError("didn't find video url")
    return match.group(1)

url = 'http://www.wimp.com/titanicpiano/'
print get_video_url(url) 
```

返回

```
http://worf.wimp.com/loadvideo/8656607f77689f759d54b4ec7207152d/4ff4ff9c/web-videos/35e78d1932b24f80ae3a9210fce008c4_titanic.flv 
```

# c - 从C中的typedef枚举获取数组，索引处的值

> ID：11336292
> 
> 赞同：0
> 
> 时间：2012-07-04T23:16:36.847
> 
> 标签：c, arrays, enums, typedef

如果有这样的枚举：

```
typedef enum {
    ValueOne = /* some arbitrary number, NOT necessarily 0 */,
    ValueTwo = /* another number, NOT necessarily consecutive */
} MyEnumeration; 
```

我想知道是否有任何方法可以从中获取数组并在不这样做的情况下访问特定索引处的值：

```
int array[2] = {ValueOne, ValueTwo};
MyEnumeration value = array[provided_index]; 
```

我的问题是，在我的项目中，枚举有 10-15 个值，我宁愿不要从它们中的每一个中创建一个数组。

[编辑]：我可以看到这是*不可能*的，因为`typedef`并且`enum`根本没有捆绑在一起，但我认为如果我错过了一些东西，问它不会有什么坏处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T23:18:34.663

不。

您将不得不为枚举和数组编写代码，或者使用一些技术来自动生成代码以减少维护负担。

您可能会对这篇文章感兴趣：[*新的 C:X 宏*](http://www.drdobbs.com/the-new-c-x-macros/184401387)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-04T23:56:45.583

我会完全取消枚举。如果您必须将它存储在数组和枚举中，那么它真的没有任何意义。枚举是宏，它们并不真正存储任何信息，它们只是为数字创建名称，我相信这些名称在编译时会被替换。您最好记住在脑海中为某些名称使用哪些数字或使用#define。

# html - 停用正文的滚动但保留滚动条

> ID：11336300
> 
> 赞同：7
> 
> 时间：2012-07-04T23:18:27.860
> 
> 标签：html, css, scroll

如何禁用`body`的滚动条，但让它在屏幕上保持可见？以 facebook 的剧院模式为例：

![脸书屏幕](../Images/faaf19e461725fc258c95c2ae6284524.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T23:50:27.520

这是您将需要强制滚动条的唯一 CSS：

```
html{
    overflow-y: scroll;
} 
```

如果内容小于窗口，滚动条将被禁用，因此您必须使用一些脚本将主体调整为至少`1px`小于窗口高度：

```
$("body").css({ "height" : ($(window).height() - 1) + 'px', "overflow": "hidden" }); 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-07-04T23:32:20.207

```
overflow-y: scroll; 
```

这应该是你正在寻找的。

# java - 克隆基类的列表

> ID：11336303
> 
> 赞同：0
> 
> 时间：2012-07-04T23:18:58.643
> 
> 标签：java, netbeans, clone

我有一个名为 AddressType 的基类

我还有两个子类，分别称为 HouseholdAddressType、PersonalAddressType。（所以这两个都扩展了 AddressType）

我传递了一个地址类型列表：

```
List<AddressType> addresses 
```

对于许多方法，并且执行不同的任务，因此我想在执行这些任务之前克隆此列表..

我试过这个：

```
List<AddressType> copyOfAddress = new ArrayList<AddressType>(addresses.size());
    for (AddressType addressType: addresses) {
        copyOfAddress.add((AddressType)addressType.clone());         
    } 
```

但是它不起作用，说明：“克隆具有受保护的访问权限”

如何克隆此列表？我的班级名称的例子会很好..非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:21:20.883

类`AddressType`必须实现`Cloneable`接口，

```
import java.util.ArrayList;
import java.util.List;

public class Foo {
    public static void main(String[] args) {

        List<Person> oldList = new ArrayList<Person>(1);
        oldList.add(new Person("Harry", "Potter"));

        List<Person> newList = new ArrayList<Person>();
        for(Person person : oldList)
        {
            newList.add(person.clone()); // Deep copy of each person too.
        }

        Person person = newList.get(0);
        person.setFirstName("James");

        System.out.println("Old list = " + oldList);
        System.out.println("New list = " + newList);
    }

    static class Person implements Cloneable
    {
        private String firstName;
        private String lastName;

        Person(String firstName, String lastName)
        {
            this.firstName = firstName;
            this.lastName = lastName;
        }

        private Person(Person person)
        {
            this.firstName = person.firstName;
            this.lastName = person.lastName;
        }

        public void setFirstName(String firstName)
        {
            this.firstName = firstName;
        }

        public String getFirstName()
        {
            return firstName;
        }

        public void setLastName(String lastName)
        {
            this.lastName = lastName;
        }

        public String getLastName()
        {
            return lastName;
        }

        @Override
        public String toString()
        {
            StringBuilder sb = new StringBuilder();

            sb.append(firstName);
            sb.append(" ");
            sb.append(lastName);

            return sb.toString();
        }

        @Override
        public Person clone()
        {
            return new Person(this);
        }
    }
} 
```

输出

```
Old list = [Harry Potter]
New list = [James Potter] 
```

# c# - 访问数据表中的下一行

> ID：11336305
> 
> 赞同：1
> 
> 时间：2012-07-04T23:19:04.423
> 
> 标签：c#, asp.net, .net, datatable

我正在尝试使用 for 循环访问和更改数据表中下一行的值，但出现错误：

```
System.IndexOutOfRangeException: There is no row at position 247. 
```

我知道在最后一个循环中，它不会找到下一行。但是我检查它是否存在，然后只修改值，但它不起作用。
这是我的代码：

```
for (int i = 0; i < dt.Rows.Count; i++)
{
  DataRow _row = dt.Rows[i];
  if (_row[1].ToString() != "" && _row[0].ToString() != "")
  {
    int temp = i + 1;
    if (dt.Rows[temp].GetType() == typeof(DataRow))
    {
        dt.Rows[temp][0] = _row[0].ToString();
     }
   }
 } 
```

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:22:41.350

这失败了，因为没有要获取的行，所以它甚至在调用之前就失败了`GetType`：

```
if (dt.Rows[temp].GetType() == typeof(DataRow))
//  ^^^^^^^^^^^^^  <-- throws an IndexOutOfRangeException here 
```

相反，您可以迭代到比行数少一：

```
for (int i = 0; i < dt.Rows.Count - 1; i++)
{
    DataRow row = dt.Rows[i];
    DataRow nextRow = dt.Rows[i + 1];
    // ...
} 
```

如果你想对最后一行做一些特别的事情，你可以在循环之后做。

# java - Java 源文件夹 Eclipse

> ID：11336309
> 
> 赞同：0
> 
> 时间：2012-07-04T23:19:48.573
> 
> 标签：java, eclipse, apache-flex

我最近在一家使用 Flash Builder Eclipse IDE for Flex 和 Java 的公司找到了一份工作。我已经习惯了他们在布局方面实现源文件夹的方式。

正如您可以看到的数字 2 所示，新包 'flexmonster.data' 显示为一个单独的文件夹，而不是具有 'flexmonster'，然后在一个新的行上，'flexmonster.data'。

![在此处输入图像描述](../Images/b9332758195b646b217f03b15d5f7da9.png)

我想知道这种类型的数据结构是否可以格式化为 Eclipse Juno。我更喜欢代码的简洁性以及由大量程序包创建的“垃圾邮件”数量的减少。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:41:30.983

我没有运行那个版本的 Eclipse，但它可能是一样的。

[ 1 ] 箭头附近是一个向下箭头图标。从那里你可以找到“包演示” - 你想要“分层”。

![分层包](../Images/9b0dcbb2e390fd5b9035f7af461c88d1.png)

# ruby-on-rails - 污损，如何向按钮添加类

> ID：11336313
> 
> 赞同：2
> 
> 时间：2012-07-04T23:20:21.403
> 
> 标签：ruby-on-rails, twitter-bootstrap, overriding, spree

再会。
我想将参数“btn btn-primary”添加到 Spree 应用程序中的按钮。
我也尝试使用 Deface 来实现这个目标。
但是下面的代码不起作用。

应用程序/overirdes/add_class_btn.rb

```
Deface::Override.new(:virtual_path => %q{spree/products/_cart_form},
                     :name => %{add_class_thumbnails_to_products},
                     :set_attributes => %q{button#add-to-cart-button},
                     :disabled => false,
                     :attributes => {:class => 'btn btn-primary'}) 
```

大礼包部分位于那里[https://github.com/spree/spree/blob/master/core/app/views/spree/products/_cart_form.html.erb](https://github.com/spree/spree/blob/master/core/app/views/spree/products/_cart_form.html.erb)

结果应该在下面的图片上：
localhost:3000/products/product1

![按钮](../Images/dd8d5cd07757403572d2874638256517.png) ![div](../Images/43756f62a2acbb9f89ed104da2ee417a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:42:20.237

通常，当覆盖对我不起作用时，是因为我引用了错误版本的 Spree。例如，我的项目使用 spree 1.0，但我在 github 上引用了 1.1，所以我正在寻找的`data-hook`名称或我正在寻找的文件不存在。

所以现在，我没有在 github 上查看，而是直接查看我的项目正在使用的 Spree gem。为此，请使用`bundle show spree`. 您可以像这样进入该目录：

```
cd my_spree_project     # make sure you're in your spree project
cd `bundle show spree` 
```

另一个非常有用的工具是`rake deface:get_result`.

> **deface:get_result** - 将列出部分或模板的原始内容、已为该文件定义的覆盖以及生成的标记。get_result 接受一个参数，它是模板/部分的虚拟路径：

运行它以验证您的覆盖实际上是否引用了某些东西。

```
rake deface:get_result['spree/products/_cart_form'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T07:39:47.163

```
Deface::Override.new(:virtual_path => "spree/products/_cart_form",
:name => 'replace_add_to_cart_button',
:replace => "code[erb-loud]:contains('add-to-cart-button')",
:text => "<%= button_tag :class => 'large primary btn btn-primary', :id => 'add-to-cart-button', :type => :submit do %>",
:original => "<%= button_tag :class => 'large primary', :id => 'add-to-cart-button', :type => :submit do %>") 
```

这会将“btn btn-primary”标签应用于按钮。我不知道为什么我的第一个例子不想工作。但目标是得到。

# c# - 更改文件夹视图，可能是命名空间扩展？

> ID：11336314
> 
> 赞同：2
> 
> 时间：2012-07-04T23:20:35.770
> 
> 标签：c#, windows-shell

我们正在开发一个应用程序，并且遇到了集成到 Windows 资源管理器中的 Sharepoint 的屏幕截图。我想知道如何为我们的应用程序创建这样的文件夹。

在这个特殊文件夹中，它实际上不会显示真实文件，它会连接到我们的服务器软件并提取记录列表（与文件相关）。在这个屏幕上，我们将能够从我们的服务器打开文件，并将文件保存到我们的服务器。我们服务器上的文件不存储为常规文件结构，并且不允许任何类型的标准用户凭据 - 所有这些都由我们的服务器软件处理。

我正在查看名称空间扩展，但找不到合适的示例。我最好在 C# (.Net 4) 中寻找示例。

任何帮助或想法（或可能的替代方案）将不胜感激。

这是我要重新创建的共享点功能的屏幕截图的链接：

![分享点截图](../Images/c73945d047777f0c7f2a00176d586bc9.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:38:13.477

不确定外壳扩展是否是您需要的最佳选择，但这里有一些关于如何在 .NET 4.0 中编写的信息：

> [http://blogs.msdn.com/b/codefx/archive/2010/09/14/writing-windows-shell-extension-with-net-framework-4-c-vb-net-part-1.aspx](http://blogs.msdn.com/b/codefx/archive/2010/09/14/writing-windows-shell-extension-with-net-framework-4-c-vb-net-part-1.aspx)。

值得一提的是，在 .NET 4.0 之前，Windows 以前不支持此功能（由于此处描述的各种原因：

> [http://blogs.msdn.com/b/oldnewthing/archive/2006/12/18/1317290.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2006/12/18/1317290.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T05:19:13.610

[您可以使用shell 命名空间扩展](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144090%28v=vs.85%29.aspx)来实现这一点。

看看[EZNamespaceExtensions.Net](http://www.ssware.com/eznamespaceextensions/eznamespaceextensions.htm)，它使这个过程变得更容易。

免责声明：我为 EZNamespaceExtensions.Net 的开发商 LogicNP Software 工作。

# java - 在 Android 中使用 OpenCV 将 NV21 转换为 RGB

> ID：11336315
> 
> 赞同：6
> 
> 时间：2012-07-04T23:20:38.963
> 
> 标签：java, android, opencv

我正在尝试在 Android 中使用 OpenCV。所以我首先通过并排放置两个 SurfaceView 来测试 OpenCV。一个 SurfaceView 用于预览来自相机的输出（输出格式显然是 NV21）。另一个SurfaceView通过OpenCV后显示相同的预览，如下代码所示：

```
public void onPreviewFrame(byte[] data, Camera camera) {
    // TODO Auto-generated method stub

    if( mYuv != null ) mYuv.release();
    mYuv = new Mat( height + height/2, width, CvType.CV_8UC1 );
    mYuv.put( 0, 0, data);
    Mat mRgba = new Mat();

    Imgproc.cvtColor( mYuv, mRgba, Imgproc.COLOR_YUV2RGB_NV21, 4 );

    Bitmap map = Bitmap.createBitmap( width, height, Bitmap.Config.ARGB_8888 );

    Utils.matToBitmap( mRgba, map );

    preview.setBackgroundDrawable( new BitmapDrawable( map ));
    mRgba.release();

} 
```

但是通过 OpenCV 后生成的图像是绿色的、静态的……东西：

![绿色，静态的东西](../Images/97be104651b3ac4ec1ede546868b7b1b.png)

有任何想法吗？

编辑：

根据评论稍微修改了代码。

```
public void onPreviewFrame(byte[] data, Camera camera) {
    // TODO Auto-generated method stub

    if( mYuv != null ) mYuv.release();
    mYuv = new Mat( height + height/2, width, CvType.CV_8UC1 );
    mYuv.put( 0, 0, data );
    Mat mRgba = new Mat();

    Imgproc.cvtColor( mYuv, mRgba, Imgproc.COLOR_YUV2RGBA_NV21, 4 );

    Bitmap map = Bitmap.createBitmap( width, height, Bitmap.Config.ARGB_8888 );

    Utils.matToBitmap( mRgba, map );

    preview.setBackgroundDrawable( new BitmapDrawable( where.getResources(), map ));
    mRgba.release();

} 
```

结果是：![又是丑陋的绿色东西。](../Images/7575af477053c310219acbc7ec2c3bb4.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T18:41:57.087

好吧，我知道我哪里出了问题。

我最初做了这样的事情：

```
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {

    this.width = width; this.height = height;
    params.setPreviewSize( width, height );
    camera.setParameters( params );
    camera.startPreview();

} 
```

问题是，android 上的相机只支持特定的预览分辨率。因此，我设置的特定分辨率不起作用。所以，我把它改成这样：

```
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {

    Size size = params.getPreviewSize();
    this.height = size.height;
    this.width = size.width;
    camera.setParameters( params );
    camera.startPreview();

} 
```

然后一切正常！老实说，这不是我预期的错误所在，所以这不是一个格式正确的问题。

# c - 未在 C 中传递完整数组

> ID：11336317
> 
> 赞同：5
> 
> 时间：2012-07-04T23:21:16.950
> 
> 标签：c, algorithm, insertion-sort

我正在处理插入排序，而我在 main() 中的数组似乎只部分传递给了 sort()。下面的代码片段显示`test`在 main() 中有 value `{2, 1, 3, 1, 2}`，但`arr`在 sort() 中有 value `{2, 1}`。这里发生了什么？

```
 #include <stdio.h>

 int sort(int* arr) {
      int i = 0;
      int j, key;
      int count = 0;

      printf("Inside sort(): ");
      for (j = 0; j < sizeof(arr)/sizeof(int); ++j)
           printf("%d ", arr[j]);
      printf("\n");

      for (j = 1; i < sizeof(arr)/sizeof(int); ++j) {
           key = arr[j];
           i = j - 1;
           while (i >= 0 && arr[i] > key) {
                arr[i + 1] = arr[i];
                --i;
                ++count;
           }
           arr[i + 1] = key;
      }
      return count;
 }

 int main(int argc, char* argv) {
      int test[] = {2, 1, 3, 1, 2};
      int i = 0;
      printf("Inside main(): ");
      for (i = 0; i < sizeof(test)/sizeof(int); ++i)
           printf("%d ", test[i]);
      printf("\n");
      int count = sort(test);
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T23:23:58.327

该习语`sizeof(arr)/sizeof(int)`仅适用于静态分配的数组，并且仅在定义它们的范围内。

换句话说，您可以将它用于以下数组：

```
int foo[32]; 
```

...在定义它们的范围内。但不是其他地方，也不是简单地作为指针传递的数组。对于其他情况，您需要传递指示数组中预期元素数量的额外信息。

# ruby - 按字段的字母顺序对数组中的哈希进行排序

> ID：11336321
> 
> 赞同：5
> 
> 时间：2012-07-04T23:21:38.580
> 
> 标签：ruby

我认为这很容易，并且已经非常努力地搜索了这个，但似乎无法让它发挥作用。

我有以下哈希：

```
@friends = [{"name"=>"John Smith", "id"=>"12345"}, {"name"=>"Jane Doe", "id"=>"23456"}, {"name"=>"Samuel Jackson", "id"=>"34567"}, {"name"=>"Kate Upton", "id"=>"45678"}] 
```

我正在尝试按名称的字母顺序对其进行排序。

现在我正在这样做：

```
@friends.sort{|a,b| a[0]<=>b[0]} 
```

但是，它只是以非字母顺序输出完整结果。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T23:33:04.123

问题是a和b是哈希，所以你必须使用“名称”作为键或索引而不是0。所以应该这样做

```
@friends.sort{|a,b| a['name']<=>b['name']} 
```

还记得使用排序！修改 @friends 变量或将其设置为结果

```
@friends.sort!{|a,b| a['name']<=>b['name']} 
```

或者

```
@friends = @friends.sort{|a,b| a['name']<=>b['name']} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-04T23:32:50.400

可以按键排序，只是在执行此操作时要注意键是字符串还是符号。

```
@friends.sort_by { |f| f['name'] } 
```

如果你想让它不区分大小写，那么你总是可以这样做：

```
@friends.sort_by { |f| f['name'].downcase } 
```

当然，您可以随时使用`!`将其保存回`@friends`

```
>> @friends.sort_by! { |f| f['name'] }
>> @friends # now returns the sorted array of hashes 
```

# javascript - 按名称将文本替换为 JavaScript 属性的内容

> ID：11336322
> 
> 赞同：0
> 
> 时间：2012-07-04T23:22:17.157
> 
> 标签：javascript, regex

我有这个正则表达式：

```
/\{([a-zA-Z\.]*)\ 
```

我想用它来替换一些这样的文本：

```
{identifier} 
```

带有值的对象属性与括号中的值的名称。在这种情况下，它会是`object.identifier`。就像是：

```
html.replace(/\{([a-zA-Z\.]*)\}/g, object.$1); 
```

感谢您的快速响应这里是最终代码

```
html = html.replace(/\{([a-zA-Z\.]*)\}/g, $.proxy(function (match, contents, offset, s) {
    return objx.get(this.response[object.attr("data-index")],contents);
},this)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:24:54.767

您可以为 指定回调`.replace`：

```
html.replace(/{([a-zA-Z.]*)}/g, function(x, a) {
    return object[a];
}); 
```

# c# - RenderTransform 后更新边距

> ID：11336324
> 
> 赞同：2
> 
> 时间：2012-07-04T23:22:22.090
> 
> 标签：c#, wpf

我已经应用`TranslateTransform`了一个控件，但控件的边距保持不变。

```
var margin = this.Margin;
this.RenderTransform = new TranslateTransform(diff.X, diff.Y);
if (diff.X != 0 && diff.Y != 0)
{
    if (margin == this.Margin)
        MessageBox.Show("Margins are equal");            
} 
```

我希望边距在变换后“更新”。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:34:30.863

您不能自动执行此操作，因为`RenderTransform`不会影响任何 Layout 属性。

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms750596.aspx#transformClassesSection)

> RenderTransform – 修改元素外观但在布局传递完成后应用的变换。通过使用 RenderTransform 属性而不是 LayoutTransform 属性，您可以获得性能优势。

而且您不能使用 a`LayoutTransform`代替。

> 请注意，当它们与 LayoutTransform 属性一起使用时，TranslateTransform 对象似乎对元素没有影响。

# scala - 模式匹配类型作为函数、方法等的参数

> ID：11336327
> 
> 赞同：1
> 
> 时间：2012-07-04T23:23:01.833
> 
> 标签：scala

在我尝试创建一个动态函数来匹配“实例”之前，我在 Scala 的模式匹配方面取得了很好的进展（顺便说一句），并且将来作为对象的一部分可能会保存该 [type] 以供以后使用。现在我了解了如何使用模式类匹配

案例 X:Int => ....

但是为什么这（下）似乎对传递给它的任何东西都有效？此外，我似乎真的无法使用 [TYPE] ，它是一个对象吗？我无法打印它或 val = 等。我想过尝试使用相关的 java.Class ，但这似乎不正确。任何建议表示赞赏，谢谢！

```
class Parent

class Child extends Parent

object TestTypes {

  def testRelate[TYPE](o:Any) = {

     o match {
       case o:TYPE => println(" o is a matching type")
       case _  => println(" o fails")
     }

     // val save = [TYPE]  .. why can't I do this?
  }

  def main(args: Array[String]): Unit = {

    val p = new Parent
    val c = new Child
    testRelate[Int](c)   // why does this Match???
    testRelate[Parent](c)   // 

  }

} 
```

---更新只是为了澄清（并感谢您的回答）但是有人如何在运行时动态地完成类类型的模式匹配？似乎 scala 有一个静态类型匹配（在上面的例子中要分解的生物），但是 instanceOf() 是我选择的动态检查吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T00:20:18.193

类型参数在运行时被擦除，因此`TYPE`实际上等同于`Object`，这意味着任何东西。

类型参数也是类型，而不是值，因此您不能将其分配给变量。最多，你可以这样做：

```
type save = TYPE 
```

但是，它也被删除了，所以它没有保存任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T14:35:13.577

对于更强大的运行时类型检查，您可能需要查看`scala.reflect.Manifest[T]`. 它包装了 a`java.lang.Class[T]`并添加了一些不错的方差检查运算符。

这是一个使用示例：[EnMAS POMDP 状态类](https://github.com/ConnorDoyle/EnMAS/blob/master/src/main/scala/org/enmas/pomdp/State.scala)

# ios - 播放 youtube 视频时如何摆脱变暗？

> ID：11336333
> 
> 赞同：0
> 
> 时间：2012-07-04T23:24:39.773
> 
> 标签：ios, xcode, youtube

我正在使用以下代码启动 youtube 视频。它工作得很好，除了每 30 秒屏幕变暗。点击屏幕会再次使其变亮（并且还会按预期调出视频控件。）即使我为我的 iPod touch 关闭了自动锁定，也会发生这种情况。到底是怎么回事？

```
NSString* embeddedCode =@"<html><body bgcolor='#008080'><center><iframe width='212' height='172' src='http://www.youtube.com/embed/[VIDEOID]?rel=0' frameborder='0'></iframe><p style='color: yellow;'>YouTube Video</p><p style='color: yellow;'>(Requires Internet access.)</p></center><body></html>";    
UIWebView* videoView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 320,350)]; 
[videoView loadHTMLString:embeddedCode baseURL:nil];
[self.view addSubview:videoView]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:44:22.870

没关系，我找到了我故意调暗屏幕的代码部分。只是不想在这种情况下这样做。

# php - 对表行进行排序并通过 ajax 传递排序索引

> ID：11336335
> 
> 赞同：0
> 
> 时间：2012-07-04T23:24:48.913
> 
> 标签：php, jquery, ajax, jquery-ui-sortable

这是一个jsfiddle：http: [//jsfiddle.net/vT67Q/](http://jsfiddle.net/vT67Q/)

该表如下所示：

```
table_products
----------------
id
sort_order
product_name
view_count
model_num
price
shipp_sep 
```

此表包含 100 多个产品，每个产品都与一个类别相关联。他们没有 sort_order 值，每个字段都为空。我的问题是如何传递排序索引？我会让 jquery 计算每一行并将一个值附加到隐藏的文本框中吗？或者如何在没有排序值冲突并始终保持唯一且有序的情况下完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:57:11.427

这是我的做法：

*   使用（隐藏）字段（例如该行的自定义 HTML 属性）加载表，告诉您该行的 sort_index，仅当它不为 NULL 时
*   在 PHP 中对表进行排序，知道您可能会在设置的行之后处理 NULL sort_order 行
*   在 drop 事件上，访问 first 之前的行：
    *   获取最高的非 NULL 行并将所有那些（到你丢弃的）设置为它们各自的顺序
    *   现在，如果下一行不是 NULL，则增加下所有非 NULL 的 sort_order （您将表向下移动一行）
    *   在另一种情况下也是如此，如果刚刚结束的行具有更高的排序顺序，则将所有从原始行位置减少到最后一个位置（现在向上移动一行）
*   当然，将删除的行设置为正确的 sort_order

这看起来很复杂，我相信在这种情况下，您应该定义表行的 sort_order`NON NULL AUTO_INCREMENT`以摆脱那个丑陋的 NULL 值。

另一种方法可能是创建一个自定义 SQL 函数`INSERT_ROW(index)`来执行所有递增和递减操作。在 Ajax 中这样做似乎很残酷。

# shell - 为 MongoDB shell 设置默认数据库

> ID：11336346
> 
> 赞同：38
> 
> 时间：2012-07-04T23:28:35.967
> 
> 标签：shell, mongodb, terminal

当我在终端中进入 mongo shell 时，它总是以数据库测试开始，这是错误的数据库。您可以将 mongo 设置为在特定数据库中启动吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-04T23:34:31.387

### 命令行

您可以在[mongo 命令行](http://www.mongodb.org/display/DOCS/Overview+-+The+MongoDB+Interactive+Shell#Overview-TheMongoDBInteractiveShell-RunningtheShell)上选择要使用的数据库，例如“mydb”：

```
mongo mydb 
```

如果未提供数据库名称，将使用“test”。

### 在 .mongorc.js 中

如果要设置默认数据库而不每次都在命令行中指定，可以[`.mongorc.js`](http://docs.mongodb.org/manual/reference/program/mongo/#mongo-mongorc-file)在主目录中的文件中添加一行：

```
db = db.getSiblingDB("mydb") 
```

该`.mongorc.js`文件在`mongo`shell 启动后执行，因此如果您在此处设置默认值，它将覆盖在命令行上指定的数据库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-04T20:08:04.457

完全有可能以一种有点奇怪的方式设置默认值。这是我在 .mongorc.js 中对管理员使用自动身份验证所做的工作：

```
// Persist the database selected
var selectedDB = db

// Authenticate
db = db.getSiblingDB("admin")
db.auth('admin','adminpass')

// Switch back to selected DB
db = selectedDB

// Universally allow read queries on secondaries from shell. 
rs.slaveOk() 
```

要直接回答这个问题，我认为完成此问题的方法是简单地执行检查以查看当前加载的数据库是否为“测试”，并且仅在这种情况下进行更改，所以。

```
if (db.name == 'test')
  db.getSiblingDB('yourdefaultdb') 
```

这允许在命令行选择数据库并设置默认值。自然，它会阻止您从命令行覆盖和使用“测试”数据库，但我认为考虑到这个问题，这有点奇怪。干杯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-10T15:07:58.893

目前（看 2.6.4）没有办法为客户端普遍设置默认数据库。它似乎硬编码为`test`. 在我的愤怒中，我否决了 Stennie 的答案 [1]，因为如果您的用户没有访问测试数据库的权限，它就不起作用。但是，如果您的情况不是这样，那么它可能会足够好。

[1] 除非编辑答案，否则我现在不能撤销我的投票

# sql-server - 从 ViewModel 显示图像

> ID：11336347
> 
> 赞同：1
> 
> 时间：2012-07-04T23:28:59.590
> 
> 标签：sql-server, asp.net-mvc-3, image, viewmodel

在我的 .Net MVC3 应用程序中，我将一些图像存储到 SQL Server 数据库中（它们是 .png 文件）。如果可能的话，我真的很想坚持使用这种方法，因为我更喜欢使用数据库而不是使用文件系统（它是一个小页面，没有人会注意到性能问题）。

将图像存储到数据库中似乎没有问题。检索数据也不是问题。我遇到的问题是在视图中显示图像。

图像作为 Varbinary(max) 存储在 SQL Server 数据库中。View Model 使用 Byte[] 来保存信息。视图模型中存储了其他数据，但就图像而言，这是我所做的：

控制器：

```
ViewModel data = Repository.GetData();

//data now holds all of the information that I need for my view
//data.Image is of type Byte[], and it holds the image I am having trouble displaying.

return View(data); 
```

看法

```
@model = data
@Html.DisplayFor(model => model.x)  @*works*@
@Html.DisplayFor(model => model.Image)  @*no good*@ 
```

**是否需要将图像存储为临时文件才能使其正常工作？** 如果是这样，将图像存储在数据库中似乎只是浪费时间。

如果我返回一个 FileStreamResult 作为我的模型：

```
FileStream fs = new FileStream(path, Open, Read);
return View(new FileStreamResult(fs, "image/png")); 
```

....我将 View 的模型更改为“FileStreamResult”，但我仍然找不到显示图像的方法。

但是，如果我像这样返回 FileStreamResult：

```
FileStream fs = new FileStream(path, Open, Read);
return new FileStreamResult(fs, "image/png"); 
```

然后显示图像（但我认为这只是浏览器“打开”该文件，而不是“呈现”为 html）。

我知道关于这个话题已经有很多问题了，但我已经看过了。我想我缺少对 web 或 mvc 或其他东西的一些基本理解。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:39:24.500

*   选项 1) [ASP.NET MVC 自定义图像操作](http://blog.maartenballiauw.be/post/2008/05/ASPNET-MVC-custom-ActionResult.aspx)

*   选项 2) 在您看来

    `< img src="loadimage?id=@Model.Id"/>`

和你的控制器：

```
 public ActionResult LoadImage(int id)
    {
        // load the image from the database and return the filestream
    } 
```

# asp.net-mvc-3 - 如何从控制器刷新@html.Action

> ID：11336349
> 
> 赞同：2
> 
> 时间：2012-07-04T23:30:01.197
> 
> 标签：asp.net-mvc-3

我有一个页面，左侧是资产的菜单列表，当您单击资产时，右侧会出现一个表单来编辑该资产。我需要能够在编辑资产后刷新资产列表，以便名称的任何更改也出现在菜单列表中。

这是我的页面

```
 </head>
    <body>
        <div id="leftHandMenu">
        <h2>assets</h2>
        @Ajax.ActionLink("Create Asset", "CreateAsset", new AjaxOptions() { UpdateTargetId = "FormContainer", InsertionMode = InsertionMode.Replace })
        @Html.Action("Assets")
        </div>
        <div id="FormContainer">
        </div>
    </body>
</html> 
```

使用 @html.Action("Assets") 调用创建的资产列表。这是资产列表的视图

```
 @model IList<CasWeb.Models.DataContext.Asset>
 @if (Model != null && Model.Any())
 {
     <ul>
         @foreach (var asset in Model)
         {

             <li> @Ajax.ActionLink(asset.Name, "EditAsset", new { id = asset.Id }, new AjaxOptions() { UpdateTargetId = "FormContainer", InsertionMode = InsertionMode.Replace }) </li>
         }
     </ul> 
    }else
         {
             <h1> no assets</h1>
         } 
```

这是我的编辑资产视图

```
 @using System.Collections
@model CasWeb.Models.DataContext.Asset

<script type="text/javascript">

    $(function () {

        $('form').submit(function () {
            if ($(this).valid()) {
                $.ajax({
                    url: this.action,
                    type: this.method,
                    data: $(this).serialize(),
                    success: function (result) {
                        $('#FormContainer').html(result);
                    }
                });
            }
            return false;
        });
    });
</script>

@using (Html.BeginForm())
    {
        @Html.ValidationSummary()

        <fieldset>

            <legend>Asset</legend>
            <div class="editor-label">
                @Html.LabelFor(model => model.Name)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Name)
                @Html.ValidationMessageFor(model => model.Name)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.ModelId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(m => m.ModelId, new SelectList((IEnumerable)ViewData["AssetModels"], "Id", "Model"))
                @Html.ValidationMessageFor(model => model.ModelId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.SizeId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(m => m.SizeId, new SelectList((IEnumerable)ViewData["AssetSizes"], "Id", "Size"))
                @Html.ValidationMessageFor(model => model.SizeId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.TypeId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(m => m.TypeId, new SelectList((IEnumerable)ViewData["AssetTypes"], "Id", "Type"))
                @Html.ValidationMessageFor(model => model.TypeId)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.DeptId)
            </div>
            <div class="editor-field">
                @Html.DropDownListFor(m => m.DeptId, new SelectList((IEnumerable)ViewData["Depts"], "Id", "Name"))
                @Html.ValidationMessageFor(model => model.DeptId)
            </div>
            <p>
                <input type="submit" value="Save" />
            </p>
        </fieldset>
    } 
```

这是我的控制器

```
[ChildActionOnly]
public PartialViewResult Assets()
{
    var assets = _assetRepo.GetAll();
    return PartialView(assets);
}

public PartialViewResult EditAsset(Guid id)
{
    SetUpViewDataForComboBoxes();

    var asset = _assetRepo.Get(id);
    return asset == null
               ? PartialView("NotFound")
               : PartialView("EditAsset", asset);
}

[HttpPost]
public PartialViewResult EditAsset(Asset asset)
{

    if (ModelState.IsValid)
    {
        _assetRepo.Update(asset);
        return PartialView("EditAssetSuccess");
    }

    SetUpViewDataForComboBoxes();

    return PartialView("EditAsset", asset);
} 
```

我希望能够在保存后刷新控制器中 EditAsset post 方法中的资产视图，因为这更可测试，但据我所知，我可能需要在编辑表单 java 的成功回调中执行此操作脚本提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T05:08:07.120

对于 Edit Assest，使用 Ajax 表单并调用以下方法 OnSuccess 事件。您还需要在页面加载时调用以下方法。

```
$.get("/ControllerName/Assets", { random: '@DateTime.Now.Ticks' }, function (response) {
                $("#ListOfAssestDiv").html(response);                
            }); 
```

对于显示资产列表，我的意思是（@Html.Action("Assets")）放入另一个 div。所以你的代码变成了这样

```
 </head>
    <body>
        <div id="leftHandMenu">
        <h2>assets</h2>
        @Ajax.ActionLink("Create Asset", "CreateAsset", new AjaxOptions() { UpdateTargetId = "FormContainer", InsertionMode = InsertionMode.Replace })
<div id="ListOfAssestDiv">
        @Html.Action("Assets")
</div>
        </div>
        <div id="FormContainer">
        </div>
    </body>
</html> 
```

如果您有任何疑问，请告诉我。

# c++ - std::string::c_str() 如何返回不会导致内存泄漏或未定义的 c-string 内容的 c-string？

> ID：11336351
> 
> 赞同：6
> 
> 时间：2012-07-04T23:30:35.417
> 
> 标签：c++, string, memory, cstring

我正在为家庭作业编写一个类似于 std::string 的字符串类，但我无法弄清楚如何返回一个不会导致内存泄漏并保证保持不变的 c 字符串，直到它没有使用时间更长。我目前有：

```
const char* string::c_str()
{
    char c[_size+1];
    strncpy(c,_data,_size);
    c[_size]='\0';
    return c;
} 
```

但内容在调用后不久就会被覆盖。如果我进行动态分配，我会出现内存泄漏，或者在任何时候给定字符串中只能存在一个 c 字符串。我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T23:33:03.830

但是 指向的字符串只有在下一次修改（或销毁）`c_str`之前是明确定义的。`std::string`

实现这一点的一种方法可能是简单地返回一个指向您的内部缓冲区的指针（假设它是空终止的）。请记住，符合标准的`c_str`必须在 O(1) 时间内运行；所以不允许复制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T23:33:43.950

来自[http://www.cplusplus.com/reference/string/string/c_str/](http://www.cplusplus.com/reference/string/string/c_str/)：

> 返回的数组指向一个内部位置，该位置具有该字符序列所需的存储空间加上其终止的空字符，但该数组中的值不应在程序中修改，并且只能保证在下一次调用之前保持不变字符串对象的非常量成员函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T23:37:10.063

c_str() 返回的缓冲区不能保证在不再使用之前保持不变甚至有效。

仅保证在 std::string 以任何方式更改之前保持有效。

实现是直截了当的：只需始终保持字符串的内部表示以 null 结尾，并从 c_str() 返回指向内部表示的指针。

# django - Django i18n_patterns 不匹配具有不同语言代码的链接

> ID：11336356
> 
> 赞同：1
> 
> 时间：2012-07-04T23:31:29.940
> 
> 标签：django, localization, internationalization, url-pattern

我已经花了几个小时试图了解我错过了什么。我在项目设置文件中定义了语言。

```
LANGUAGE_CODE = 'en-us'

LANGUAGES = (
    ('en', 'English'),
    ('fr', 'French'),
) 
```

然后我的 MIDDLEWARE_CLASSES 中列出了 LocaleMiddleware。

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    ...
) 
```

最后在我的 urls.py 我有以下

```
from django.conf.urls import patterns, include, url
from django.conf.urls.i18n import i18n_patterns

...
urlpatterns += i18n_patterns('',
    url(r'^about/$', 'about.view', {'template_name': {'en':'contact_en.html', 'fr':'contact_fr.html',},}, name='about'),
) 
```

现在链接 /en/about 运行良好，但是 /fr/about 链接失败并出现以下错误：

```
Using the URLconf defined in XXX.urls, Django tried these URL patterns, in this order: 
...
2\. ^en/

The current URL, fr/about/, didn't match any of these. 
```

谁能帮我理解我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T13:14:11.713

Finally I resolved the problem. Everything above is correct for regular project. However I forgot the fact that I wrote a middleware that patches the `request.urlconf` field dynamically to replace with the right URL conf. After looking into `LocaleMiddlware` code I found out that the middleware instead uses the `settings.ROOT_URLCONF` and thus was not looking into correct `urls.py`!

So if anybody does patch the `urls.py` don't forget to patch also the `ROOT_URLCONF`

# ios - 试图将 UIImageView 设置为视图

> ID：11336357
> 
> 赞同：0
> 
> 时间：2012-07-04T23:31:32.257
> 
> 标签：ios, uiview

我的搜索视图控制器`searchVC`有一个`UIImageView* backgroundImage`
我想将 backgroundImage 设置为我的视图图像。
为什么这段代码不起作用？

```
[searchVC.backgroundImage initWithImage:[UIImage imageNamed:@"someimage.png"]];
[searchVC.view addSubview:searchVC.backgroundImage]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:42:58.867

我认为应该是：

```
//If backgroundImage is not created yet, create it.
searchVC.backgroundImage = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"someimage.png"]] autorelease];

// If it is already created then you should just set the image
searchVC.backgroundImage.image = [UIImage imageNamed:@"someimage.png"];

[searchVC.view addSubview:searchVC.backgroundImage]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:35:45.490

你需要给`searchVC.backgroundImage`一个`frame`. 告诉视图在`frame`哪里以及它有多大。

由于您希望它充当背景图像，请尝试：

```
[searchVC.backgroundImage setFrame:CGRectMake(0, 0, searchVC.view.frame.size.width, searchVC.view.frame.size.height]; 
```

此外，如果`searchVC.view`有其他子视图（正如我想象的那样），请确保您`searchVC.backgroundImage`在其他任何内容之前添加为子视图，因此它将转到视图的最后面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T07:14:48.753

您可以使用以下代码：

```
searchVC.backgroundImage.image = [UIImage imageNamed:@"someimage.png"];

[searchVC.view addSubview:searchVC.backgroundImage]; 
```

# android - 组合多个drawable

> ID：11336358
> 
> 赞同：10
> 
> 时间：2012-07-04T23:31:52.610
> 
> 标签：android, drawable

我有多个可绘制对象并希望将其组合为一个可绘制对象（例如，4 个正方形来创建一个大正方形，如 Windows 徽标 :)）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-04T23:47:02.947

您可以使用 a`TableLayout`或 some `LinearLayout`s 来做到这一点。但是，如果您想要创建单个图像以在 a 中使用`ImageView`，则必须`Bitmap`手动创建；这并不难：

```
Bitmap square1 = BitmapFactory.decodeResource(getResources(), R.drawable.square1);
Bitmap square2 = BitmapFactory.decodeResource(getResources(), R.drawable.square2);
Bitmap square3 = BitmapFactory.decodeResource(getResources(), R.drawable.square3);
Bitmap square4 = BitmapFactory.decodeResource(getResources(), R.drawable.square4);

Bitmap big = Bitmap.createBitmap(square1.getWidth() * 2, square1.getHeight() * 2, Bitmap.Config.ARGB_8888);
Canvas canvas = new Canvas(big);
canvas.drawBitmap(square1, 0, 0, null);
canvas.drawBitmap(square2, square1.getWidth(), 0, null);
canvas.drawBitmap(square3, 0, square1.getHeight(), null);
canvas.drawBitmap(square4, square1.getWidth(), square1.getHeight(), null); 
```

我什至没有编译上面的代码；我只是向你展示如何做到这一点。我还假设您有所有尺寸相同的方形可绘制对象。请注意，所调用的位图`big`可以在您想要的任何地方使用（例如`ImageView.setImageBitmap()`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-30T23:57:23.493

您可以使用[LayerDrawable](http://developer.android.com/reference/android/graphics/drawable/LayerDrawable.html)来做到这一点。

# maven - 找不到 application.xml 中定义的子模块 [portal-service-ejb-1.4-SNAPSHOT.jar]

> ID：11336359
> 
> 赞同：3
> 
> 时间：2012-07-04T23:31:57.340
> 
> 标签：maven, netbeans, deployment, glassfish, glassfish-3

我正在使用 Maven 和 NetBeans。我能够部署和运行我的应用程序。但现在它抛出一个错误：

> 部署期间发生错误：部署应用程序 [portal-ear-1.4-SNAPSHOT] 时出现异常：找不到 application.xml 中定义的子模块 [portal-service-ejb-1.4-SNAPSHOT.jar]。

当我转到 target/portal-ear-1.4-SNAPSHOT 时，我可以看到 portal-service-ejb-1.4-SNAPSHOT.jar 但它仍然给我这个错误。

我的 application.xml ：

```
<?xml version="1.0" encoding="UTF-8"?>
   <application xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd" version="6">
  <display-name>e2e-portal-ear</display-name>
      <module>
    <web>
      <web-uri>portal-war-1.4-SNAPSHOT.war</web-uri>
      <context-root>/portal</context-root>
    </web>
  </module>
  <module>
    <ejb>portal-repository-ejb-1.4-SNAPSHOT.jar</ejb>
  </module>
  <module>
    <ejb>portal-service-ejb-1.4-SNAPSHOT.jar</ejb>
  </module>
     <library-directory>lib</library-directory>
</application> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T16:49:58.010

最后我解决了这个错误。

所以这是一个文件`C:\Program Files\glassfish-3.1.2\glassfish\domains\domain1\applications\portal-ear-1.4-SNAPSHOT`

这里有一个文件。我认为它可以保存应用程序的状态或其他东西。我刚刚删除了它，现在一切正常。

# javascript - outerWidth(true) 连续两次返回不同的值，不重新加载页面

> ID：11336377
> 
> 赞同：3
> 
> 时间：2012-07-04T23:35:40.133
> 
> 标签：javascript, jquery, html, css

我很困惑。

[http://jsfiddle.net/pyn8s/](http://jsfiddle.net/pyn8s/)

单击登录按钮。等待弹出窗口出现。注意它的位置。再次单击登录按钮。看着它向左移动。（正确位置）再次单击登录按钮。请注意，它不再移动。

我不知所措，甚至不确定如何描述这种奇怪的行为。我注意到 note.outerWidth(true) 上的警告，它在前两次登录单击时报告了不同的宽度，但该对象永远不会不可见，并且应该在调用 outerWidth 之前设置它的宽度......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:33:09.777

当 jQuery 第一次评估 note.outerWidth() 时，它会得到它的父宽度（loginForm = **250px**），因为在 css 中没有定义 note 的宽度（只定义了 max-width）。

浏览器在 .append() 之后呈现新的笔记内容，但它的新宽度是在 .offset() 之后计算的：

查看控制台日志：http: [//jsfiddle.net/HighKickX/QSsV6/](http://jsfiddle.net/HighKickX/QSsV6/)

```
max-width + 2 * (padding + border-width) 
```

= 300像素 + 2 * (5 像素 + 1 像素) = **312 像素**

再次单击时，偏移量将根据 312px 而不是 250px 计算。这就是为什么音符会移动到另一个位置的原因。

**解决方案 1**：删除“位置：绝对” [http://jsfiddle.net/HighKickX/wjeGF/](http://jsfiddle.net/HighKickX/wjeGF/)

说明：如果您设置 position: absolute，则注释会从流程中取出，并且不再从 loginForm 继承 250px 的宽度。所以它的宽度不限于250px，而是最大宽度为300px + padding + border = 312px。如果你不设置 position: absolute，note 的宽度将被继承并且等于 250px（一直）。

**解决方案 2**：设置默认宽度[http://jsfiddle.net/HighKickX/Ex3Bp/](http://jsfiddle.net/HighKickX/Ex3Bp/)

# python - Python中的HTML转义

> ID：11336384
> 
> 赞同：0
> 
> 时间：2012-07-04T23:37:10.713
> 
> 标签：python, escaping

> **可能重复：**
> [在 Python 中转义 HTML 的最简单方法是什么？](https://stackoverflow.com/questions/1061697/whats-the-easiest-way-to-escape-html-in-python)

在 Python 中 HTML 转义字符的最简单方法是什么？我想获取一个项目列表并对其进行迭代，将它们更改为 HTML 转义字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:23:35.627

Python标准库有`cgi`模块，提供`escape`功能。

请参阅：[http ://docs.python.org/library/cgi.html#functions](http://docs.python.org/library/cgi.html#functions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:41:12.360

模板引擎倾向于使您的代码更简洁，更易于维护。例如，您可以将列表传递给模板引擎并在模板内进行迭代：

```
t = Template('{% for item in items %}{{ item }}\n{% endfor %}')
result = t.render(dict(items=some_list)) 
```

大多数模板引擎默认会转义 html。有很多可供选择，当我不使用 Django 时，可能最喜欢的是 jinja2。

有关其他替代方案，请参见[http://wiki.python.org/moin/Templating](http://wiki.python.org/moin/Templating)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T00:43:41.610

尝试这样的事情（未经测试，只是一个示例）：

```
html_convert = {"<": "&lt;", ">": "&gt;", "\"": "&quot;", "&": "&amp;"} #Etc.
html_text = "<div id=\"idk\">Something truly interesting & fun...</div>"
html_list = [char for char in html_text]

for char in html_list:
    if char in html_convert:
        char = html_convert[char]

html_escaped_text = "".join(html_list) 
```

# jquery - 更改动画调用的顺序

> ID：11336386
> 
> 赞同：0
> 
> 时间：2012-07-04T23:37:46.837
> 
> 标签：jquery, animation, fadein

我有以下 jquery 来制作所有对象，但悬停的对象会淡出然后淡出。但是，我希望悬停的元素立即淡化为完全不透明，而不是等待其他元素淡出。

```
$('a').bind('mouseenter',function(){
        $(this).fadeTo(0,1);
        $('a').not($(this)).fadeTo('fast', 0.25);
    }).bind('mouseleave',function(){
        $('a').fadeTo('slow', 1.0);
    });​ 
```

[http://jsfiddle.net/cutcopypaste/jQmZ3/1/](http://jsfiddle.net/cutcopypaste/jQmZ3/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:47:50.020

如果您只需要“自动聚焦”悬停的元素，请使用`$.show()`将元素直接带到前台。这主要是因为你不能再`fade in`有这个数量，因此你有你想要的效果。

```
$('a').bind('mouseenter',function(){
    $(this).show();
    $('a').not($(this)).fadeTo('fast', 0.25);
}).bind('mouseleave',function(){
    $('a').fadeTo('slow', 1.0);
}); 
```

[http://jsfiddle.net/userdude/jQmZ3/2/](http://jsfiddle.net/userdude/jQmZ3/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:15:49.577

尝试[http://jsfiddle.net/jQmZ3/3/](http://jsfiddle.net/jQmZ3/3/) ...在所有“a”元素的效果队列上使用停止。

```
$('a').bind('mouseenter',function(){
    $('a').stop();                
    $(this).fadeTo(0,1);
    $('a').not($(this)).fadeTo('fast', 0.25);
}).bind('mouseleave',function(){
    $('a').fadeTo('slow', 1.0);  
});​ 
```

# jquery - $(this) 在 jquery 自动完成源中 - 为什么它不起作用，但解决方法呢？

> ID：11336389
> 
> 赞同：0
> 
> 时间：2012-07-04T23:39:07.650
> 
> 标签：jquery, autocomplete

我在使用以下代码时遇到了一些问题。$(this) 似乎未定义。

```
$('.version-autocomplete').autocomplete({
    source: '/ajax/versions.json?procedure_name=' + $(this).attr('procedure_name')
}) 
```

我发现这行得通，我想知道为什么会这样。有人知道吗？

```
$('.version-autocomplete').each(function(i, el) {      
    $(el).autocomplete({
        source : '/ajax/versions.json?procedure_name=' + $(el).attr('procedure_name')
    })  
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:44:47.707

在第二个版本中，您处于`each`回调中，但在第一个版本中，`$(this)`立即评估并且不指向您想要的元素。顺便说一句，您也可以`this`在 中正确使用`each`：

```
$('.version-autocomplete').each(function() {      
    $(el).autocomplete({
        source: '/ajax/versions.json?procedure_name=' + $(this).attr('procedure_name')
    });
}); 
```

# windows - 估计 NTFS 卷上的 USN 记录数

> ID：11336390
> 
> 赞同：4
> 
> 时间：2012-07-04T23:39:13.730
> 
> 标签：windows, ntfs, journal, usn

首次使用 USN 日志时，必须使用 FSCTL_ENUM_USN_DATA 控制代码枚举该卷的整个 USN 记录集。这通常是一个漫长的操作。

有没有办法在运行之前估计卷上的记录数，以便显示进度？

我猜整个卷的 USN 数据是从 MFT 生成的，每个文件有一条记录（大约）。因此，也许一种估计 MFT 中活动文件数量的方法会起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T04:36:25.060

您可以使用 FSCTL_GET_NTFS_VOLUME_DATA 来获取 MFT 的字节长度。如果将此与选择的代表性卷上的记录数进行比较，您可以估计单个 MFT 记录的平均长度，并使用它来计算特定卷上记录数的估计值。

因为 MFT 包含（例如）每个文件的安全信息，平均长度会因卷而异，所以我认为你只会获得数量级的准确性，但在大多数情况下它可能已经足够好了.

另一种方法是假设文件参考编号线性增加，这大致是正确的。您可以使用 FSCTL_ENUM_USN_DATA 来查明是否有任何文件的参考编号高于特定猜测；您需要不超过 128 次猜测来确定实际的最大参考数。这至少会在任何给定点为您提供 0 到 100 之间的完成百​​分比，它不会完全一致，但进度条永远不会。:-)

***额外的：***

仔细观察，在 Windows 7 x64 上，FSCTL_ENUM_USN_DATA（在第一个 USN_RECORD 结构之前返回的四字）返回的“下一个 id”字段毕竟不是文件引用号，而是文件记录段号。因此，正如您所观察到的，返回的最后一个 ID 号乘以 BytesPerFileRecordSegment (1024) 等于 MftValidDataLength。

文件参考号似乎由两部分组成。低六字节包含文件记录段号。从每个请求返回的第一条记录总是有一个 FRN，其段号与输入 StartFileReferenceNumber 的“下一个 id”相同，除了 StartFileReferenceNumber 为零时的第一次调用。高两个字节包含未指定的附加信息，它从不为零。

似乎 FSCTL_ENUM_USN_DATA 接受文件记录段号（在这种情况下，前两个字节为零）*或*文件引用号（在这种情况下，前两个字节非零）。

一个奇怪的是，我找不到具有相同记录段号的两条记录。这表明每个文件记录在 MFT 中至少使用了 1K，这似乎不合理。

无论如何，结果是，将“下一个 id”乘以 BytesPerFileRecordSegment 并将其除以 MftValidDataLength 以获得完成的百分比可能是明智的，只要您在返回无意义的结果时优雅地应对。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-01T04:00:58.563

实际上，/结构的`MftValidDataLength`字段对将/将由其返回的**USN**记录的数量设置了上限（即，假设在您测量估计的时间*之间*没有将其他记录添加到日志中和枚举...）`NTFS_VOLUME_DATA_BUFFER``NTFS_EXTENDED_VOLUME_DATA`**`FSCTL_ENUM_USN_DATA`**

 ***在下面的**C#**示例中，我将`vd.MftValidDataLength`值除以`vd.BytesPerFileRecordSegment`，确保在除之前先加法进行***四舍五入****`dividend - 1`*。至于除数，我相信它的价值`1,024`在任何平台或系统上总是通用的，以防你更喜欢硬编码。

```
[Serializable, StructLayout(LayoutKind.Sequential)]
public struct NTFS_EXTENDED_VOLUME_DATA
{
    public VOLUME_ID     /**/ VolumeSerialNumber;
    public long          /**/ NumberSectors;
    public long          /**/ TotalClusters;
    public long          /**/ FreeClusters;
    public long          /**/ TotalReserved;
    public uint          /**/ BytesPerSector;
    public uint          /**/ BytesPerCluster;
    public int           /**/ BytesPerFileRecordSegment;   // <--
    public uint          /**/ ClustersPerFileRecordSegment;
    public long          /**/ MftValidDataLength;          // <--
    public long          /**/ MftStartLcn;
    public long          /**/ Mft2StartLcn;
    public long          /**/ MftZoneStart;
    public long          /**/ MftZoneEnd;
    public uint          /**/ ByteCount;
    public ushort        /**/ MajorVersion;
    public ushort        /**/ MinorVersion;
    public uint          /**/ BytesPerPhysicalSector;
    public ushort        /**/ LfsMajorVersion;
    public ushort        /**/ LfsMinorVersion;
    public uint          /**/ MaxDeviceTrimExtentCount;
    public uint          /**/ MaxDeviceTrimByteCount;
    public uint          /**/ MaxVolumeTrimExtentCount;
    public uint          /**/ MaxVolumeTrimByteCount;
}; 
```

典型常数，为清楚起见进行了删节：

```
public enum FSCTL : uint
{
    // etc...     etc...
    FILESYSTEM_GET_STATISTICS   /**/ = (9 << 16) | 0x0060,
    GET_NTFS_VOLUME_DATA        /**/ = (9 << 16) | 0x0064,  // <--
    GET_NTFS_FILE_RECORD        /**/ = (9 << 16) | 0x0068,
    GET_VOLUME_BITMAP           /**/ = (9 << 16) | 0x006f,
    GET_RETRIEVAL_POINTERS      /**/ = (9 << 16) | 0x0073,
    // etc...     etc...
    ENUM_USN_DATA               /**/ = (9 << 16) | 0x00b3,
    READ_USN_JOURNAL            /**/ = (9 << 16) | 0x00bb,
    // etc...     etc...
    CREATE_USN_JOURNAL          /**/ = (9 << 16) | 0x00e7,
    // etc...     etc...
}; 
```

伪代码如下，因为每个人都有自己喜欢的 P/Invoke 方式......

```
// etc..

if (!GetDeviceIoControl(h_vol, FSCTL.GET_NTFS_VOLUME_DATA, out NTFS_EXTENDED_VOLUME_DATA vd))
    throw new Win32Exception(Marshal.GetLastWin32Error());

var c_mft_estimate = (vd.MftValidDataLength + (vd.BytesPerFileRecordSegment - 1))
                                                        / vd.BytesPerFileRecordSegment; 
```

太好了，那么你能用这个值做什么呢？**不幸的是，知道将返回的USN**记录数的最大上限`FSCTL_ENUM_USN_DATA`无助于为`DeviceIoControl/FSCTL_ENUM_USN_DATA`调用本身选择缓冲区大小，因为`USN_RECORD`每次迭代中返回的结构的大小会根据报告的文件名的长度而变化。

因此，虽然确实，如果您碰巧为***所有***结构提供了足够大的缓冲区`USN_RECORD`，那么`DeviceIoControl`确实会尽职尽责地在一次调用中将*它们全部提供*给您（从而避免迭代调用循环的复杂性，这简化了代码），上面的小计算并没有给出*对该*缓冲区大小的任何原则性估计，除非你愿意接受使用它来进行某种严重的高估。

相反，该值*的*用途是在枚举操作之前预先分配***您自己的固定大小的***数据结构，您肯定会需要它。`FSCTL_ENUM_USN_DATA`因此，如果您有自己的值类型，您将为每个 USN 条目创建（例如，虚拟结构......）

```
[StructLayout(LayoutKind.Sequential)]
public struct MFT_IX_REC
{
    public ushort seq;
    public ushort parent_ix_hi;
    public uint parent_ix;
}; 
```

然后，使用上面的估计，您可以在迭代之前预先分配这些数组，`DeviceIoControl`而不必担心在迭代期间调整大小。

```
var med = new MFT_ENUM_DATA { ... };
// ...

var rg_mftix = new MFT_IX_REC[c_mft_estimate];
// ... ready to go, without having to check whether the array needs resizing within the loop

for (int i=0; DeviceIoControl(h_vol, FSCTL.ENUM_USN_DATA, in med, out USN_RECORD usn, ...); i++)
{
    // etc..
    rg_mftix[i].parent_ix = (uint)usn.ParentId;
    // etc..
} 
```

`memcpy`当您事先不知道条目数量时，通常需要这种动态数组调整大小的消除，这是一项不平凡的性能优势，因为它避免了从旧数据复制现有数据所需的昂贵的巨型操作每次调整大小时，数组都会变成一个更大的新数组。***

# c - 即时编译算术运算序列

> ID：11336398
> 
> 赞同：1
> 
> 时间：2012-07-04T23:41:23.850
> 
> 标签：c, math, compiler-construction

我用 C 语言编写了一个程序来使用公式生成分形，但是速度很慢。基本上，您向渲染函数传递一堆无符号字符数，这些数字指示函数将值推入堆栈或将其弹出并执行算术运算并将结果推回堆栈（有点像反向波兰符号）。问题是，程序正在读取这些函数编号，通过 if...else if...else if...else if...elseif... 找到要执行的正确操作，并推送和弹出每个像素中每次迭代的一堆值。通常只有一个公式（如 Mandelbrot）硬编码到渲染函数中，但这个程序是一个 DLL，我正在编写一个通用分形渲染器。有什么办法可以编写一个小型迷你编译器，在渲染开始之前读取公式并即时编译一个函数，然后渲染例程可以有效地重用该函数？毕竟，冯诺依曼架构的全部意义在于计算机可以修改自己的代码。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T00:48:51.227

如果使用 C++ 是一个选项，我建议您尝试使用 LLVM - 使用他们的 IRBuilder 将函数转换为 LLVM IR，运行优化传递，然后使用 LLVM JIT 在运行时编译函数

[http://llvm.org/docs/tutorial/LangImpl4.html](http://llvm.org/docs/tutorial/LangImpl4.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:51:37.880

C 中没有自修改代码的概念。任何将控制权传递给“数据”内存中的数据块的尝试，例如，通过将数据指针转换为函数指针，都是未定义的行为。该模型可让您使用 C 语言为非 vov-neuman 计算机编程。

这就是说，您可以通过用函数指针或 switch 语句替换 if-then-else 语句序列来优化 RPN 代码以更快地运行。您还可以将目标函数编程到动态库中，在运行时读取它，然后在渲染中使用它。

# ruby-on-rails - 引号内的引号

> ID：11336400
> 
> 赞同：0
> 
> 时间：2012-07-04T23:41:51.267
> 
> 标签：ruby-on-rails, ruby, string

我正在尝试在输入字段中创建一个值数组。但是，这些值需要有引号，而且我很难将引号相互抵消。

这是我的代码：

```
<input type="text" data-provide="typeahead"
       data-source='[<% @results.each do |result| %>"<%= result['name'] %>",<% end %>]'> 
```

我的问题是我有两组`"`或`'`. 当我尝试`result[name]`不带引号之类的东西时，我得到错误：未定义的局部变量或方法“名称”。

更新，因为我需要数据源来拥有 ''s 和数据里面有 ""s

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:52:24.170

尝试这个

```
<input type="text" data-provide="typeahead" data-source="[<%= @results.map { |r| "'#{r['name']}'" }.join(',') %>]"> 
```

在 IRB 这就是发生的事情

```
>> results = [{'name' => "abc"}, {'name' => "fds"}]
=> [{"name"=>"abc"}, {"name"=>"fds"}]
>> results.map { |r| "'#{r['name']}'" }.join(',')
=> "'abc','fds'" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T03:55:52.593

```
<input type="text" data-source='<%= @results.collect(&:name).to_json %>' data-provide="typeahead"> 
```

在 html5 中，属性周围的引号是可选的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T23:55:03.850

您应该将其重写为如下所示：

```
 <input type="text" data-provide="typeahead" data-source="[<%= @results.each {|result| result['name']} %>"> 
```

请注意，此代码未经测试。

本质上，评估 beestings 内的 ruby​​ 块的结果应该是所需的字符串 - 您不需要对 beestings 进行任何嵌套。

# javascript - JavaScript 可以与不同的服务器通信吗？

> ID：11336402
> 
> 赞同：4
> 
> 时间：2012-07-04T23:42:22.937
> 
> 标签：javascript, ajax, client-server, client-side

JavaScript 可以与位于不同服务器上的数据库交互吗？

即涉及三台计算机

*   一个服务器：它提供一个带有 JavaScript 的 HTML 页面
*   客户端：运行想要与之交谈的页面
*   第二个服务器：向/从客户端发送和接收数据

这是否违反[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)？如果不是为什么不呢？如果是这样，有没有办法解决它？

我的背景 - 我是一位称职的计算机科学家，但我从未处理过客户端编程。虽然回答时可以随意使用复杂的想法，但请假设我对 JavaScript 语言或客户端编程背后的特定政策一无所知。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:47:03.620

每当您的 html 来自服务器 1 并且 AJAX 请求转到服务器 2 时，它确实违反了同源。

查看[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)。它是专门为处理这种情况而设计的标准。它在大多数现代浏览器中实现。

或者，您可以使用[JSONP](http://en.wikipedia.org/wiki/JSONP)来提供数据，或者如果您无法控制第二台服务器，则使用反向代理将请求通过第一台服务器代理到第二台服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T00:42:11.360

是的，这违反了 SOP。有很多方法可以解决它，但值得强调一个关键点：

**客户端访问远程服务器的任何尝试都需要该服务器的同谋。**

那么有哪些选择呢？

**JSON-P**

JSON-P 涉及让服务器返回一个包含在对回调函数的调用中的响应。它是这样工作的：

*   一个新的脚本标签被 DOM 脚本化到页面中，或者一个现有的被重用
*   脚本标签的`src`属性设置为请求路径（脚本标签可以从任何地方加载脚本——它们不受 SOP 约束）
*   带有数据的服务器响应，通常（但不一定）编码为 JSON，并将其打印为回调函数调用的参数（必须在您的 JS 中定义）

因此，用原生 JS 编写的 JSON-P 请求如下所示：

```
callback = function(response) { console.log(response); };
var script = document.createElement('script');
script.src = 'http://www.some-request.com/here.php?callback=callback'; //the example happens to use the same name; the callback parameter tells the some-request domain what function to wrap JSON in 
document.body.appendChild(script); 
```

然后，如果服务器的响应是

```
callback({"foo": "bar"}); 
```

...我们会在控制台中得到响应。请注意，我明确地将函数设为全局，因为它必须是可访问的并且不能被范围隐藏。（从这个意义上说，它必须是全局*可访问*的，但不一定是传统意义上的全局 - 例如，它可以是全局命名空间的静态方法）。

许多符合 JSON-P 的 Web 服务器允许您指定您希望它调用的函数的名称，通常通过将此信息附加到请求 URL 中`&callback=func_name`。

更多信息在[这里](http://www.mitya.co.uk/blog/2012/Mar/JSON-P-what-what-s-not-and-how-works-205)。

**CORS / XHR2**

在 CORS 中，也就是 XHR（即 AJAX）v2 背后的跨域思想，这将意味着服务器发送一个标头，表示哪些域可以向它发出跨域请求 - 或所有域。例如，在 PHP 中，我们可以允许任何调用者域发出请求：

```
header("Access-Control-Allow-Origin: *"); 
```

更多信息在[这里](http://www.html5rocks.com/en/tutorials/file/xhr2/)。

**EasyXDM***

[EasyXDM](http://easyxdm.net/wp/2010/03/17/sending-and-receiving-messages/)整理了许多特定于供应商和更新的 HTML5 到达方式，用于在域之间发布和接收基于文本的消息，值得一看。

**非 JS**

如果您需要从不玩球的服务器获取某些东西，您唯一的选择是中间服务器端脚本，因为这些可以触发 cURL 请求，可以在不受 SOP 限制的情况下抓取远程资源。

```
$curl = curl_init("http://www.example.com/");
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($curl); 
```

更多关于 cURL[的信息](http://uk3.php.net/curl)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T23:46:18.917

是的，这违反了同源政策。

[您可以使用JSONP](http://en.wikipedia.org/wiki/JSONP)绕过此限制，它利用`script`标签的行为从第二个（数据库）主机获取数据。这假设您可以以非常特殊的方式从第二个主机提供数据：将 JSON 响应包装在回调中。它还需要使用 GET 来提供响应。

另一种选择是[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，它还需要对服务器发送数据的方式进行一些控制，并将限制您使用更新的网络浏览器。

# android-layout - 为多个按钮单击维护数据全局状态

> ID：11336404
> 
> 赞同：0
> 
> 时间：2012-07-04T23:42:42.050
> 
> 标签：android-layout, android-intent, global-variables, bundles

我有一个 Android 平板电脑的检查表，它有 5 个活动页面和大约 30 次按钮点击。每个按钮单击都会生成一个 TextView 值，然后在应用程序结束时对其进行编译以创建报告。

我的问题是：是否有任何其他方式来维护活动之间的状态并将数据从所有活动传送到报告阶段，而不使用 Intent 和 Bundles。

我已经阅读了有关 Intent 和 Bundles 的所有内容，这似乎是一种尴尬的做事方式。作为一名 C++ 程序员，我习惯于使用地址和指针来获取我想要的任何数据值，即使在某些情况下使用全局指针来维护状态。

当您已经拥有一个按钮 ID 和一个保存在应用程序内存地址中的值时，拥有 30 个按钮来创建 30 个 Bundle 变量（然后需要通过 switch 语句检索到这些变量）似乎有点矫枉过正。

有什么建议么？

问候，

鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T09:24:23.017

您不需要扩展 Application 类。您可以使用静态（类）变量声明自己的类。像这样：

```
public class Globals {
    public static String text1;
    public static String text2;
    ...
} 
```

您可以从代码中的任何位置访问这些变量，如下所示：

```
Globals.text1 = "stuff"; 
```

或者

```
String text1 = Globals.text1; 
```

# google-maps-api-3 - Google Maps API v3 - 多个地理编码器请求后的 fitBounds

> ID：11336405
> 
> 赞同：4
> 
> 时间：2012-07-04T23:42:56.883
> 
> 标签：google-maps-api-3

我想要做的是使用 AJAX 和 JSON 加载一堆地址，找出每个地址的纬度和经度，在地图上放置标记，然后使用`fitBounds()`放大，以便所有标记都可见。听起来很简单。

我已经把大部分东西都打包好了，但我的问题是`fitBounds()`部分。

基本上似乎正在发生的事情是在遍历每个地址并找到纬度和经度时，它似乎`fitBounds()`在循环下方加载了函数。

所以它正在调用，但数组中还`fitBounds()`没有任何内容。`marker_bounds`我原以为它会在到达`fitBounds()`函数之前完成循环，但我猜`geocoder.geocode()`函数必须使它在确定纬度和经度时继续加载 JavaScript 的其余部分。

我的代码如下：

```
var geocoder;
var map;
var marker_bounds = [];

var myOptions = {
    zoom: 12,
    mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);    

$.post('addresses.php', function(data) {

    var next_filter = '';           
    for(var x=0;x<data.addresses.length;x++) {

        geocoder.geocode( { 'address': data.addresses[x].address}, function(results, status) {

            if (status == google.maps.GeocoderStatus.OK) {

                marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });

                var latLng = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
                marker_bounds.push(latLng);             
            }

        });             
    }

    var latlngbounds = new google.maps.LatLngBounds();
    for ( var i = 0; i < marker_bounds.length; i++ ) {
       latlngbounds.extend(marker_bounds[i]);
    }
    map.setCenter(latlngbounds.getCenter());
    map.fitBounds(latlngbounds); 

}, 'json'); 
```

在所有地理编码完成后，我可以调用一个函数吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T02:27:59.240

好的，这就是我所学到的。

1.  geocode 方法进行异步调用，因此 geocode 方法所在的页面将在地理编码器在该过程中完成查找地址之前很久就完成。
2.  您需要在`addressBounds`运行地理编码方法后调用一个函数 ( ) 并计算它已地理编码的地址数 ( `address_count`)。
3.  每次`addressBounds`调用该函数时，检查是否已查找所有地址 ( `if (total_addresses == address_count)`)，然后运行该`fitBounds()`函数。

我的最终代码

```
var geocoder;
var map;
var markerBounds = [];  

var myOptions = {
    zoom: 4,
    mapTypeId: google.maps.MapTypeId.ROADMAP
}   
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);    

google.maps.event.addListenerOnce(map, 'idle', function(){

    $.post('addresses.php', function(data) {

        var total_addresses = data.addresses.length;            
        var address_count = 0;
        for(var x=0;x<total_addresses;x++) {    

            geocoder.geocode( { 'address': data.addresses[x].address }, function(results, status) {

                address_count++;        

                if (status == google.maps.GeocoderStatus.OK) {

                    marker = new google.maps.Marker({
                        map: map,
                        position: results[0].geometry.location
                    });

                    var infowindow = new google.maps.InfoWindow();
                    infowindow.setContent(address);
                    google.maps.event.addListener(marker, 'click', function() {
                        infowindow.open(map, marker);
                    });

                    var myLatLng = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());                      
                    addressesBounds(total_addresses, address_count, myLatLng);  

                }

            });

        }

    }, 'json');

});

function addressesBounds(total_addresses, address_count, myLatLng) {

    markerBounds.push(myLatLng);

    // make sure you only run this function when all addresses have been geocoded
    if (total_addresses == address_count) {
        var latlngbounds = new google.maps.LatLngBounds();
        for ( var i = 0; i < markerBounds.length; i++ ) {
           latlngbounds.extend(markerBounds[i]);
        }
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T07:12:42.513

*使用其他变量在顶部*的全局范围内定义边界对象的简单方法，然后使用找到的每个结果构造它（在地理编码器回调中）。

基本上，您想要对回调数据执行的所有操作都需要在回调中或由回调触发的函数中（如您所见）。但在这种情况下，您不需要单独的功能。浏览器应该存储所有的`fitBounds`操作并且只做最后一个。

```
var latLng = new google.Maps.LatLng(
                          results[0].geometry.location.lat(),
                          results[0].geometry.location.lng());
marker_bounds.push(latLng);
latlngbounds.extend(latLng);
map.fitBounds(latlngbounds); 
```

如有必要（因为您的浏览器速度足够快，可以`fitBounds`对每个地址`address_count`执行`fitBounds`. 也就是说，您的辅助函数可以合并到地理编码器回调中。

```
var latLng = new google.Maps.LatLng(
                          results[0].geometry.location.lat(),
                          results[0].geometry.location.lng());
marker_bounds.push(latLng);
latlngbounds.extend(latLng);
address_count++;
if (address_count == data.addresses.length) map.fitBounds(latlngbounds); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:07:37.497

我知道以下内容并不严格相关，但我已经为此苦苦挣扎了一段时间，我认为值得分享。在使用 DirectionsRenderer 渲染多个方向请求后，地图通常集中在最后一个渲染命令的结果上，尽管我在发出最后一个渲染命令后发出 map.fitBounds 并带有边界框以包含所有方向请求结果视口。行为不是确定性的，有时视口集中在整个地图上，有时集中在最后一个方向请求结果上。解决方案是为渲染器设置 preserveViewport:true，这样它就不会在显示方向请求结果后改变地图的焦点，所以现在我可以用 fitbounds 改变焦点。

# javascript - 如何在javascript中找出对象中的空值？

> ID：11336410
> 
> 赞同：0
> 
> 时间：2012-07-04T23:44:12.140
> 
> 标签：javascript, jquery, arrays

我试图找到一种方法在对象中有空值时发出警报，如果它存在，它应该警报失败，如果没有，它会继续另一个动作。目前我能够提醒每个键。使用此代码：

```
var ave = {
 'a': '02',
 'b': '04',
 'c': '',
 'd': '',
 'f': '07'
 };

var total = 0
$.each(ave, function(key, value) {
  var numbersA = total + value.length;
    if (numbersA === 0) {
       alert("Fail!");
     } else {
       alert("Pass!");
     }
}); 
```

它弹出失败！两次并通过 3 次。即使对象中存在单个空值，我也希望它警告失败。有办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:56:43.877

我会使用`for in`循环；jQuery`jQuery.each`不太适合这种情况。

```
var ave = {
 'a': '02',
 'b': '04',
 'c': '',
 'd': '',
 'f': '07'
};

var success = true;

for(var x in ave) {
    if(ave.hasOwnProperty(x)) {
        if(ave[x] === '') {
            success = false;
            break;
        }
    }
}

if(success) {
    alert('Pass!');
} else {
    alert('Fail!');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:54:01.913

`failed`如果任何属性为空，只需设置一个名为的全局变量并更改其值：

```
var ave = {
 'a': '02',
 'b': '04',
 'c': '',
 'd': '',
 'f': '07'
 };

var failed = false;
var total = 0;
$.each(ave, function(key, value) {
  var numbersA = total + value.length;
    if (numbersA === 0) {
       failed = true;
    }
});
if (failed)
    alert("Fail!"); 
```

另外，请注意，我正在使用您的方法来检查`null`值，这是不正确的。如果你想实际检查`null`值，你会改变

```
if (numbersA === 0) {
    failed = true;
} 
```

到

```
if (numbersA === null) {
    failed = true;
} 
```

然后，如果您想`ave`失败，您还需要将空字符串更改`null`为：

```
 var ave = {
 'a': '02',
 'b': '04',
 'c': null,
 'd': null,
 'f': '07'
 }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T00:01:24.887

[你可以在这里](http://jsfiddle.net/HighKickX/yFmW5/)测试下面的代码，玩弄两组数据。请注意，默认值为“ave_success”，因此警报“成功！” 打开链接时会弹出。

将 "$.each(ave_success" 更改为 "$.each(ave_fail" 以验证拒绝错误数据。

请注意，空字符串 '' 不被视为 null

```
'' === null 
```

将返回 false

```
var ave_fail = {
  'a': '02',
  'b': '04',
  'c': '',
  'd': '',
  'f': '07'
};

var ave_success = {
  'a': '02',
  'b': '04',
  'f': '07'
};

var total = 0
var success = true;

$.each(ave_success, function(key, value) {
  var numbersA = total + value.length;
  if (numbersA === 0) {
    alert("Fail on index " + key + ' !');
    success = false;
    return false;
  }
});

if (success) alert("Success !"); 
```

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T00:23:42.840

我错过了，但最短的一个

```
var ave = {
  'a': '1',
  'b': '04',
  'c': '4',
  'd': '',
  'f': '1'
};

(function(){
    var v='Success';    
    for(var x in ave) if(!ave[x]) { v='Fail'; break;}
    alert(v);    
})(); 
```

[**演示。**](http://jsfiddle.net/wssGs/2/)

**或者**

```
function is_falsy(arg){
  var what=true;    
  for(var x in arg) if(!arg[x]) { what=false; break;}
  return what;    
}
alert(is_falsy(ave)); 
```

[**演示。**](http://jsfiddle.net/wssGs/3/)

# javascript - o.bind.apply（参数）；

> ID：11336417
> 
> 赞同：0
> 
> 时间：2012-07-04T23:45:58.943
> 
> 标签：javascript

我正在查看 JQuery Tiny Pub/Sub，它看起来像这样：

```
(function($){
  var o = $({});

  $.subscribe = function() {
    o.bind.apply( o, arguments );
  };

  ...

})(jQuery); 
```

我不明白的是，由于代码调用了 o.bind，bind 中的“this”无论如何都是 o，因此没有理由使用 apply。

换句话说，

```
o.bind(arguments) 
```

和

```
o.bind.apply(o, arguments) 
```

这里应该是相同的，不是吗？为什么 o.bind.apply(o, 争论)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:48:12.197

`.apply`需要一*组*参数来传递，所以它们不是一回事。考虑一下：

```
function foo(a, b, c) {
    console.log(a);
    console.log(b);
    console.log(c);
}

foo.apply(null, [1, 2, 3]);
// Prints:
// 1
// 2
// 3

foo([1, 2, 3]);
// Prints:
// [1,2,3]
// undefined
// undefined 
```

您可能会将其与 混淆`.call`，这肯定是多余的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:52:50.233

`bind`和之间有区别`apply`。Bind 接受参数，而 apply 获得一个范围和一个带有参数的数组。

为了更清楚地说明这一点。这将是相同的：

```
o.bind(1,2,3);

o.apply(o, [1,2,3]); 
```

# c# - Visual C# - 运行程序时如何将文件从资源复制到磁盘中的文件夹？

> ID：11336418
> 
> 赞同：0
> 
> 时间：2012-07-04T23:46:02.333
> 
> 标签：c#, process, resources, backgroundworker

我无法在 Visual C# 中创建一个简单的应用程序，该应用程序执行以下操作：

1.  坚持寻求一个具体的过程。
2.  当该进程开始运行时，将资源复制到文件夹中。
3.  当该过程结束时，将另一个资源复制到该文件夹​​。

我尝试使用计时器+线程，但没有成功。我认为 BackgroundWorker 在这里会有所帮助，但文档还不清楚。这是我当前的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Resources;
using System.Text;
using System.Threading;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace ResourceCopyApp
{
    public partial class MainWindow : Window {
        BackgroundWorker bw;
        bool pcRunning = false;
        public MainWindow() {
            InitializeComponent();
            bw = new BackgroundWorker();
            bw.DoWork += new DoWorkEventHandler(Loop);
            bw.RunWorkerAsync();
        }

        private void Window_Loaded(object sender, RoutedEventArgs e) {
            cfgInstall.Text = Properties.Settings.Default.pcLocation;
            cfgLag.Value = Properties.Settings.Default.lag;
        }

        private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e) {
            Properties.Settings.Default.pcLocation = cfgInstall.Text;
            Properties.Settings.Default.lag = (int)cfgLag.Value;
            Properties.Settings.Default.Save();
        }

        public void Loop(object sender, DoWorkEventArgs e) {
            pcRunning = false;
            bool pcWasRunning = pcRunning;
            if (pcRunning && !pcWasRunning) {
                MessageBox.Show("Process found");
                pcWasRunning = true;
                Swap(true);
            }
            foreach (Process p in Process.GetProcesses()) {
                if (p.ProcessName.Equals("Process")) {
                    pcRunning = true;
                }
            }
            if (!pcRunning && pcWasRunning) {
                MessageBox.Show("Process lost");
                Swap(false);
            }
        }
        public void Swap(bool v) {
            byte[] file;
            Thread.Sleep(new TimeSpan((long)cfgLag.Value));
            if (v) {
                file = Properties.Resources.NewRes;
            } else {
                file = Properties.Resources.BackupRes;
            }
            string path = cfgInstall.Text;
            if (!cfgInstall.Text.EndsWith("/") && !cfgInstall.Text.EndsWith("\\")) {
                path = cfgInstall.Text + "/test.txt";
            }
            File.WriteAllBytes(path, file);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:56:10.607

正如我在评论中提到的，您当前的代码只运行一次检查，然后 BackgroundWorker 完成。您可以：

*   使用计时器间歇性地（比如每分钟）查找进程，按照您当前在`Loop`. 当进程开始时，您可以使用`Process.WaitForExit()`暂停代码直到进程完成。要继续让您的程序响应，这部分应该在`BackgroundWorker`. 当然，这种方法存在一个风险，即进程在计时器滴答之间快速启动和完成。

*   `ManagementEventWatcher`在 WMI 中使用。[CodeProject 上的这篇](http://www.codeproject.com/Articles/12138/Process-Information-and-Notifications-using-WMI)文章定义了一个类，该类简化了使用 WMI 在进程启动和停止时收到通知：

    ```
    notePad = new ProcessInfo("notepad.exe");
    notePad.Started +=
        new Win32Process.ProcessInfo.StartedEventHandler(this.NotepadStarted);
    notePad.Terminated +=
        new Win32Process.ProcessInfo.TerminatedEventHandler(this.NotepadTerminated); 
    ```

他们使用的底层代码如下：

```
 string queryString =
    "SELECT *" +
    "  FROM __InstanceOperationEvent " +
    "WITHIN  " + pol +
    " WHERE TargetInstance ISA 'Win32_Process' " +
    "   AND TargetInstance.Name = '" + appName + "'";

  // You could replace the dot by a machine name to watch to that machine
  string scope = @"\\.\root\CIMV2";

  // create the watcher and start to listen
  watcher = new ManagementEventWatcher(scope, queryString);
  watcher.EventArrived +=
          new EventArrivedEventHandler(this.OnEventArrived);
  watcher.Start(); 
```

# sql - sql server 防火墙端口

> ID：11336420
> 
> 赞同：1
> 
> 时间：2012-07-04T23:46:16.027
> 
> 标签：sql, sql-server-2012

通过我的路由器防火墙连接到 SQL Server 2012 时遇到问题。我为 SQL 浏览器打开了 2382 端口，为 SQL Server 打开了 1433 端口。我可以使用 LAN IP 地址从服务器连接到自身，但不能使用外部路由器 IP。我从这个问题中得到了一些很好的信息。

[为服务器实例打开端口](https://stackoverflow.com/questions/10539900/opening-ports-sql-server-instances)

我正在使用他们提到的实例端口，它也可以工作，但前提是我使用...从服务器连接到自身。

> 数据源=192.168.1.2,49867；网络库=DBMSSOCN；初始目录=字符；

我也无法从 LAN 上的另一台 PC 连接。这似乎很奇怪。为了以防万一，我已经禁用了服务器上的 Windows 防火墙。

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T03:59:18.773

检查是否在 SSMS 的“服务器属性 -> 连接”下启用了“允许远程连接到此服务器”

# javascript - Javascript 注入不适用于 chrome 扩展

> ID：11336423
> 
> 赞同：2
> 
> 时间：2012-07-04T23:46:55.760
> 
> 标签：javascript, google-chrome, dom, google-chrome-extension, code-injection

我正在尝试创建一个 Google Chrome 扩展程序。我有实际注入的代码，但我得到的只是警报对话框。

`manifest.json`：

```
{
  "name":"Xpress Test Extension",

  "manifest_version": 2,

  "version":"0.2",
  "icons": {
    "16": "icon_16.png",      
    "20": "icon_20.png",
    "128": "icon_128.png"
  },

  "background": { 
    "scripts":  ["background.js","content_script.js"]
  },

  "browser_action": {
    "default_popup": "popup.html",
    "default_icon": "icon_20.png"
  },
  "content_scripts": [
    { 
      "matches": ["https://stackoverflow.com/*"],
      "js" : [ "content_script.js","script.js" ]
    }
  ],

  "content_security_policy": "default-src 'self'",
  "permissions": [
    "tabs",

    "https://stackoverflow.com/*",
    "contextMenus",     "unlimitedStorage"
  ],

  "web_accessible_resources": [
    "icon_20.png",
    "icon_128.png",
    "background.html",
    "content_script.js",
    "popup.html",
    "popup.js",
    "script.js",
    "background.js"
  ]
} 
```

`content_script.js`（当然是偷来的……）：

```
alert('content script!');
var port = chrome.extension.connect();
var rootnode=document.getElementById('topbar');
if (null==rootnode) {
  alert ('could not find div#id topbar');
} else {
  rootnode.addEventListener("click", function() {
    var s = document.createElement('script');
    s.src = chrome.extension.getURL("script.js");
    s.onload = function() {
      this.parentNode.removeChild(this);
    };
    (document.head||document.documentElement).appendChild(s);

    alert( "Hello");
  }, false);
} 
```

`script.js` （从示例代码中厚颜无耻地复制）：

```
 // JS script injection, so that we can read the JS class 'InternalJSVariable'
 var postFriendMap = function() {
 var textarea = document.getElementById('transfer-dom-area');
 textarea.value = JSON.stringify(InternalJSVariable);
 };

 // Create a dummy textarea DOM.
 var textarea = document.createElement('textarea');
 textarea.setAttribute('id', 'transfer-dom-area');
 textarea.style.display = 'none';
 document.body.appendChild(textarea);

 // Start injecting the JS script.
 var script = document.createElement('script');
 script.appendChild(document.createTextNode('(' + postFriendMap + ')();'));
 document.body.appendChild(script);
 alert('injection');

 var textNode=document.createTextNode("CLICK ME");
 var buttonElem=  document.createElement( "button");
 buttonElem.setAttribute("id","extraButton001");
 buttonElem.appendChild(textNode);
 document.getElementById('logo').appendChild(buttonElem); 
```

从我的`background.js`（更多盗窃样本）：

```
function genericOnClick(info, tab) {
  console.log("item " + info.menuItemId + " was clicked");
  console.log("info: " + JSON.stringify(info));
  console.log("tab: " + JSON.stringify(tab));
  chrome.tabs.executeScript(null, {file: "content_script.js"});
  console.log('sent to content script...');
}
// Create one test item for each context type.
var contexts = ["page","selection","link","editable","image","video",
             "audio"];
for (var i = 0; i < contexts.length; i++) {
   var context = contexts[i];
   var title = "Test '" + context + "' menu item";
   var id = chrome.contextMenus.create({"title": title, "contexts":[context],
                                    "onclick": genericOnClick});
   console.log("'" + context + "' item:" + id);    
}

// Create a parent item and two children.
var parent = chrome.contextMenus.create({"title": "Test parent item"});
var child1 = chrome.contextMenus.create(
    {"title": "Child 1", "parentId": parent, "onclick": genericOnClick});
var child2 = chrome.contextMenus.create(
    {"title": "Child 2", "parentId": parent, "onclick": genericOnClick});
console.log("parent:" + parent + " child1:" + child1 + " child2:" + child2); 
```

*   [http://code.google.com/chrome/extensions/manifestVersion.html](http://code.google.com/chrome/extensions/manifestVersion.html)
*   [使用内容脚本将代码插入页面上下文](https://stackoverflow.com/questions/9515704/building-a-chrome-extension-inject-code-in-a-page-using-a-content-script)
*   [Chrome 扩展 - 消息传递](https://stackoverflow.com/questions/2998775/chrome-extension-message-passing?rq=1)
*   [http://code.google.com/chrome/extensions/examples/api/contextMenus/basic/sample.js](http://code.google.com/chrome/extensions/examples/api/contextMenus/basic/sample.js)
*   [Google Chrome 扩展 - 访问 DOM](https://stackoverflow.com/questions/2063015/google-chrome-extension-accessing-the-dom)
*   [http://code.google.com/chrome/extensions/contentSecurityPolicy.html#H2-3](http://code.google.com/chrome/extensions/contentSecurityPolicy.html#H2-3)

# api - 如何定期检索网页内容

> ID：11336431
> 
> 赞同：0
> 
> 时间：2012-07-04T23:48:26.087
> 
> 标签：api, web

我有一个有趣的小服务的想法，它依赖于来自两个 Web 源的数据，并且需要定期检查它们的更新。

首先，我需要每 5 分钟检查 30-40 个推特帐户以查找新推文。

如果我检测到一条新推文，我想点击一个现有的（不是我的）php 地址，看看该页面自上次检查以来是否发生了变化。

问题是，我的背景完全是应用程序开发。我不知道应该研究哪些技术、语言或框架。

我真的很感激一些关于从哪里开始的建议。

一些可能有帮助也可能没有帮助的注释 - 我在 Mac 上开发，并且到目前为止一直专门使用 xcode。我很高兴在开发过程中在本地运行服务/脚本/任何内容，但最终希望托管它。我的背景是 Objective-C 和其他 OO 语言。我没有针对 API、Web 开发、unix 脚本或其他任何东西进行开发的经验，但我已经准备好迎接挑战。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:54:55.573

您可以通过设置 cron 作业轻松实现此目的。Cron 作业是定期调用的任务，例如每天、每周甚至每分钟。

如果你想做的不仅仅是检查这两个地址，例如显示一些网页，我建议你使用像 PHP Zend Framework 这样的 web 框架。

# mysql - Roambi ES4和mysql无法连接

> ID：11336447
> 
> 赞同：0
> 
> 时间：2012-07-04T23:51:05.443
> 
> 标签：mysql

我在 mac os x lion 10.7 上安装 Roambi ES4

经过很多步骤后，我开始使用 apache tomcat 连接到 roambi 应用程序，但我收到了这条消息。

数据库连接错误

连接到数据库时发生故障。请确保存在给定主机和连接字符串名称的数据库，或者更正位于以下配置文件的“db”条目中的连接字符串：/Users/jorgediaz/.roambi/config.json

我安装了 mysql 并创建了一个数据库，但我没有任何名为 .rombi 的目录，也没有名为 config.json 的文件

我能做些什么 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T11:52:01.053

请检查 /Users/jorgediaz/.roambi/config.json 文件是否包含 mysql 的连接字符串。

例如：

```
{"roambi-data":"0.2.0","db":"mysql://localhost/roambi?user=root&password=XXXXX","setup_complete":true} 
```

如果不存在，请重新启动您的 roambi 服务器。然后再试一次。

# asp.net-mvc - 使用 Html.Routelink 链接文本的 ViewBag 属性

> ID：11336448
> 
> 赞同：2
> 
> 时间：2012-07-04T23:51:11.533
> 
> 标签：asp.net-mvc, razor, html-helper, viewbag

`ViewBag`调用时尝试使用`Html.RouteLink`：

```
@{                             
    <li>@Html.RouteLink("Inbox (" + ViewBag.NewMessageCount + ")", 
                          "ViewInbox", 
                          new { pseudoName = User.Identity.Name }) | </li>
} 
```

这会导致错误：

> System.Web.Mvc.HtmlHelper' 没有名为 'RouteLink' 的适用方法，但似乎具有该名称的扩展方法。扩展方法不能动态调度。考虑强制转换动态参数或在没有扩展方法语法的情况下调用扩展方法。

如何`ViewBag`在链接文本中的值上使用属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:54:34.107

正如错误消息告诉您的那样，您不能将`dynamic`操作与扩展方法一起使用。

将`ViewBag.`表达式转换为非`dynamic`类型将解决问题。

```
(string)(ViewBag.MyProperty) 
```

# windows-phone-7 - Visual Studio 是否有可以为 wp7 开发应用程序的 html/javascript sdk

> ID：11336456
> 
> 赞同：0
> 
> 时间：2012-07-04T23:52:38.987
> 
> 标签：windows-phone-7

我希望将我的 ios 应用程序迁移到 wp7

我发现我需要更多地了解c#。我熟悉javascript/html。

Visual Studio 是否有 html/javascript SDK 可以为 wp7（而不是 wp8）开发应用程序？

欢迎任何评论

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:46:33.983

看看[Windows Phone 的 PhoneGap](http://docs.phonegap.com/en/1.9.0/guide_getting-started_windows-phone_index.md.html#Getting%20Started%20with%20Windows%20Phone)

# mysql - 在 MySQL+ 中显示第二个表中不存在的记录

> ID：11336461
> 
> 赞同：1
> 
> 时间：2012-07-04T23:53:35.430
> 
> 标签：mysql, sql, database, mysql++

```
SELECT C.COURSE_ID, TITLE, A.STUDENT_ID, COMPANY_ID, AD.ADDRESS
FROM COURSE C, STUDENT S, ADDRESS AD, ATTENDANCE A
WHERE C.COURSE_ID = AD.COURSE_ID
AND AD.ADDRESS = A.ADDRESS
AND A.STUDENT_ID = S.STUDENT_ID
AND COMPANY_ID IS NOT NULL; 
```

我有 4 个表，这个查询完成了它所需要的一切，除了我必须包含出勤表中不存在的地址。例如

```
ADDRESS TABLe          ATTENDANCE table
Address                  Address
  a                         a
  b                         b
  c
  d 
```

所以我希望最终结果显示：

```
COURSE ID    TITLE   STUDENT_ID   COMPANT_ID   ADDRESS
   BLA        BLA      BLA         BLA           a
   BLA        BLA      BLA         BLA           b
   BLA        BLA      BLA         BLA           c
   BLA        BLA      BLA         BLA           d 
```

虽然上面的查询显示了相同的结果，但不包括“地址”列中的 c 和 d。

对不起，如果我不够清楚。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:57:03.793

如果您将查询更改为使用[`LEFT JOIN`](http://dev.mysql.com/doc/refman/5.0/en/join.html)连接`ATTENDANCE`表，它将*排除*`ADDRESS`表中不存在的所有记录

# iphone - 使用 TWTweetComposeViewController 发送推文时以编程方式设置位置

> ID：11336462
> 
> 赞同：1
> 
> 时间：2012-07-04T23:53:55.027
> 
> 标签：iphone, objective-c, ios, twitter, tweets

我存储了一个位置（地址和纬度/经度坐标）以及一些我想使用 Twitter 框架发布的附加信息（名称、描述、图像、网址等）。如何将位置信息传递到推文表？我不想依赖用户点击 twitter 控制器上的“设置位置”按钮，除了点击这将位置设置为用户当前位置，而不是我想要使用的预存储位置鸣叫...

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T07:43:03.097

不可能的。没有 API 来设置推文的位置，系统将始终使用用户的位置。

# javascript - 在放置事件时启动引导模式

> ID：11336467
> 
> 赞同：1
> 
> 时间：2012-07-04T23:54:51.353
> 
> 标签：javascript, jquery, ruby-on-rails-3, twitter-bootstrap

我有这个 javascript，试图在将类附加到可放置元素后打开引导模式。但是可拖动项目只是冻结在可放置而不是启动模式。

```
$( ".draggable" ).draggable({revert: true, opacity: 0.75}); // DRag and drop function
        $( ".droppable" ).droppable({
            drop: function( event, ui ) {

                $( this )
                    .addClass( "ui-state-highlight" )
                    .append("<div class='node well'><a href='#'>linka</a></div>");
        $('#myModal').modal({keyboard: false});
            }
        }); 
```

模态的html：

```
 <div class="modal hide fade" id="myModal">
          <div class="modal-body">
            <p>One fine body…&lt;/p>
          </div>
          <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">Close</a>
            <a href="#" class="btn btn-primary">Save changes</a>
          </div>
    </div> 
```

当我通过按钮启动模式时，如引导演示中的示例所示，它工作正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:18:12.633

问题是我没有通过我的 gemfile 包含 JQuery UI 库，一些文件被包含在其他 Javascript 中，但我没有在我的应用程序中包含 GEM。

# iphone - 我的 iPhone 应用程序的菜单

> ID：11336470
> 
> 赞同：-2
> 
> 时间：2012-07-04T23:55:16.780
> 
> 标签：iphone, ios, xcode

我正在尝试为我的 iPhone pong 应用程序制作一个菜单，当我在网上查看时，所有内容要么在旧的 Xcode 上，要么在不同的菜单上，要么不在我想要的空应用程序中。当我制作我的应用程序时，我使用了一个空应用程序，并且需要制作一个带有类似播放按钮的菜单，以便在不同的视图中打开我的游戏。告诉我您是否需要我的任何代码寻求帮助，仅供参考，我是制作应用程序的初学者。谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T09:51:58.503

1.  [具有漂亮动画效果的开源弹出式饼形菜单 iOS 控件](http://maniacdev.com/2012/02/tutorial-how-to-add-a-rotating-pie-menu-to-your-ios-apps/)
2.  [iOS 上的饼图菜单](http://mattgemmell.com/2011/09/08/pie-menus-on-ios/)
3.  [教程：如何为您的 iOS 应用程序添加旋转饼图菜单](http://maniacdev.com/2012/02/tutorial-how-to-add-a-rotating-pie-menu-to-your-ios-apps/)

和类似的问题：

1.  [iphone facebook侧边菜单使用objective c](https://stackoverflow.com/questions/7991034/iphone-facebook-side-menu-using-objective-c)
2.  [开发像 Facebook 新 iOS 应用程序中的侧滑菜单的最佳方法是什么？](https://stackoverflow.com/questions/7989020/whats-the-best-way-to-develop-a-sideswipe-menu-like-the-one-in-facebooks-new-i)

这是一个很棒的菜单列表，请查看此站点：

1.  [iOS 开源 Facebook/Path 喜欢的侧边栏菜单实现](http://bitly.com/bundles/o_27ukkruo5l/1)

在那里，下一次，在搜索上多费心一点:) 希望这会有所帮助。

# c# - 当表达式中的变量在方法范围内时如何将表达式传递给方法

> ID：11336472
> 
> 赞同：0
> 
> 时间：2012-07-04T23:55:50.433
> 
> 标签：c#, c#-4.0, lambda, dry, argument-passing

我一定错过了 lambda 和委托的一些基础知识。来了。。

我有两个功能“几乎”相同的事情。我需要通过将它们写入一个函数并传递“必要”参数来对它们进行 OOP。

这两个函数大致是这样的：

```
private static bool Populate1(int yPoint)
{
    //---------------------------------
    //--------------------------------
    int xPoint = 0;

    foreach (var item in collection)
    {
        ComboBox cb = AddControl_Combo(item, xPoint, yPoint);

        xPoint += cb.Width + 12;
        yPoint = 0;
    }

    //-------------------------------
    //-------------------------------

    return true;
}

private static bool Populate2(int yPoint)
{
    //---------------------------------
    //--------------------------------
    int xPoint = 0;

    foreach (var item in collection)
    {
        ComboBox cb = AddControl_Combo(item, xPoint, yPoint);

        yPoint += cb.Height + 12;
    }

    //---------------------------------
    //--------------------------------

    return true;
} 
```

这些函数要冗长得多，所以我真的想把它们干掉。可以注意到，这两个函数的唯一区别是两个定位函数

```
xPoint += cb.Width + 12;
yPoint = 0; 
```

和

```
yPoint += cb.Height + 12; 
```

如何通过将上述表达式作为参数将上述两个函数合二为一？我发现的问题是变量`xPoint`和`cb`是函数范围内的变量！

这是我尝试并成功的方法，但在我看来并不优雅：

```
private static bool Populate(ref int xPoint, ref int yPoint, ref ComboBox cb, 
                              Action positioningFunc)
{
    foreach (var item in collection)
    {
        cb = AddControl_Combo(item, xPoint, yPoint);

        positioningFunc();
    }

    return true;
} 
```

并称之为：

```
int xPoint = 0;
int yPoint = 0;
ComboBox cb = null;
return Populate(ref xPoint, ref yPoint, ref cb, () =>
{
    xPoint += cb.Width + 12;
    yPoint = 0;
}); 
```

和

```
int xPoint = 0;
int yPoint = 19;
ComboBox cb = null;
return Populate(ref xPoint, ref yPoint, ref cb, () =>
{
    yPoint += cb.Height + 12;
}); 
```

有没有更好的方法来 OOP 他们？

**编辑：**我试图传递位置的两个表达式是一些动态控件（水平、垂直、对角线、之字形等）。该函数已经从 4 个不同的地方调用并且可以扩展。为了获得表达式本身，我们从调用类中进行了大量计算。所以在函数`if else`内部做一个逻辑`Populate`（在一个单独的实用程序类中）不是我想要的。所有方法中唯一的变化是foreach中的那些定位表达式。所以我正在寻找在这种情况下如何传递参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T00:19:21.670

如果您需要通过 Lambdas 完成，这里有一个替代方案：

```
 private static bool Populate(int yPoint, Func<ComboBox, Point, Point> modifier)
 {
    var point = new Point (0, yPoint);
    foreach (var item in collection)
    {
        ComboBox cb = AddControl_Combo(item, point.X, point.Y);
        point = modifier(cb, point);
    }
    return true;
} 
```

这两个电话将是：

```
Populate(0, (cb, point) => new Point(point.X + cb.Width + 12, 0));
Populate(0, (cb, point) => new Point(0, point.Y + cb.Height + 12)); 
```

您也可以使用`Tuple<int, int>`但`Point`更简洁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:04:22.623

简单的逻辑

```
private static bool Populate(int yPoint, bool flag)
{
    int xPoint = 0;

    foreach (var item in collection)
    {
        var ComboBox cb = AddControl_Combo(item, xPoint, yPoint);

        if(flag)
        {
            xPoint += cb.Width + 12;
            yPoint = 0;
        }
        else
        {
            yPoint += cb.Height + 12;
        }
    }

    return true;
} 
```

当您需要 Populate1 时，请调用`Populate(valueofypoint, true)`并`Populate(valueofypoint, false)`为 Populate2 调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T00:40:14.390

这应该完全按照您的需要工作：

```
private static bool Populate(int yPoint,
    Func<int, ComboBox, int> xStep,
    Func<int, ComboBox, int> yStep)
{
    int xPoint = 0;

    foreach (var item in collection)
    {
        ComboBox cb = AddControl_Combo(item, xPoint, yPoint);

        xPoint = xStep(xPoint, cb);
        yPoint = yStep(xPoint, cb);
    }

    return true;
} 
```

你只是这样称呼它：

```
Populate(42, (x, cb) => x + cb.Width + 12, (y, cb) => 0);
Populate(42, (x, cb) => 0, (y, cb) => y + cb.Width + 12); 
```

这是你所期待的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T00:13:44.630

结合您的想法和 Nikhil 的建议：

```
private static bool Populate(int yPoint, int position)
{
    int xPoint = 0;

    ComboBox cb;

    Action positionFunction;
    if (position == 1)
    {
            positionFunction = () => { 
                    xPoint += cb.Width + 12;
                    yPoint = 0;
            };
    }
    else if (position ==2)
    {
            positionFunction = () => { yPoint += cb.Height + 12; };
    }
    else
    {
            throw new Exception("Invalid position");
    }

    foreach (var item in collection)
    {
        cb = AddControl_Combo(item, xPoint, yPoint);

        positionFunction();
    }

    return true;
} 
```

# javascript - 仅替换 iframe src 的一部分

> ID：11336474
> 
> 赞同：0
> 
> 时间：2012-07-04T23:56:00.530
> 
> 标签：javascript, jquery

我需要使用 javascript 来更改 iframe src 的一部分，有没有办法在 iframe src 中将“500”更改为“800”？我尝试了以下代码，但没有成功。如果有人可以提供帮助，将不胜感激。

```
 function bigPhotosets() {
            $('iframe.photoset').each(function(){
                $(this).attr('src').replace('500','800');
                $(this).attr('width').replace('500','800');
            });
        }

        bigPhotosets(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T23:57:50.643

`.replace()`返回一个新的字符串，你没有做任何事情。

您需要将 设置`src`为这个新字符串：

```
var newSrc = $(this).attr('src').replace('500','800');   
$(this).attr('src', newSrc); 
```

还有更快的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:58:42.530

这段代码只是在 src 属性中返回，替换了一些文本，什么也不做。尝试这个：

```
$(this).attr('src', $(this).attr('src').replace('500','800') ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T01:28:26.077

我相信 SLaks 的回答是正确的。当我在您的 tumblr 页面的控制台中使用他的代码时，它正确地更改了源代码。但是宽度没有改变，需要调整高度。

我将以下代码粘贴到[http://jtestblog1.tumblr.com/post/26387860417/aquaticwonder-dancing-alone-portraits-by-caiti](http://jtestblog1.tumblr.com/post/26387860417/aquaticwonder-dancing-alone-portraits-by-caiti)上的控制台（在 Chrome 上） ，它按照您所说的需要工作。

```
function bigPhotosets() {
    $('iframe.photoset').each(function(){
        var newSrc = $(this).attr('src').replace('500','800');
        $(this).attr('src', newSrc).width(800).height(912);
    });
}

bigPhotosets(); 
```

我会担心`500`您的网址中存在另一个。这会弄乱 URL。如果它总是在 URL 的末尾，您可能希望使用一个正则表达式，如果它只出现在 URL 的末尾，它将只替换 500。

即将第三行改为

```
var newSrc = $(this).attr('src').replace(/500$/,'800'); 
```

仅当 500 在 URL 的末尾时才有效（如果大小总是在 URL 的末尾，那是一件好事）。在您的 tumblr 上，大小*位于*URL 的末尾，因此此正则表达式有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T10:27:57.600

最简单的方法。将旧的 src 替换为相同的 src，但将 500 替换为 800。

```
$(this).attr('src', $(this).attr('src').replace('500','800') ); 
```

**在第一个答案的评论中的链接中，它不起作用，因为 iframe src 中没有*500*，而是*600*。**

另请注意，您必须同时注意 width 属性和 css 宽度。

哪个会给你

```
$(this).attr('width', 800);
$(this).css('width', 800); 
```

在此之后，唯一剩下的就是根据您更改宽度的方式按比例调整 iframe 的高度。这是 oldHeight*800/500 （或在您的实际情况下为 800/600）。

# c - gcc 不会正确包含 math.h

> ID：11336477
> 
> 赞同：29
> 
> 时间：2012-07-04T23:56:37.980
> 
> 标签：c, gcc, linker, static-libraries

这是一个概述我的问题的最小示例

**测试.c：**

```
#include <stdio.h>
#include <math.h>

main ()
{
   fmod ( 3, 2 );
} 
```

这是我要编译的命令`test.c`

```
gcc -lm test.c -o test 
```

这是我发出上述命令时得到的输出

```
/tmp/ccQmRk99.o: In function `main':
test.c:(.text+0x3e): undefined reference to `fmod'
collect2: ld returned 1 exit status 
```

如果改为使用`cc`. 我正在使用以下版本的 gcc

```
gcc-4.6.real (Ubuntu/Linaro 4.6.1-9ubuntu3) 4.6.1 
```

任何想法为什么我的程序无法编译？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-07-05T00:24:00.530

问题来自链接器，`ld`而不是 gcc（因此出现退出状态消息）。通常 ld 要求按顺序指定对象和库`user` `supplier`，其中`user`是使用库函数`supplier`的对象并且是提供它的对象。

当你`test.c`被编译成一个对象时，编译器声明 fmod 是一个未定义的引用

```
$ gcc -c test.c
$ nm test.o
                 U fmod
0000000000000000 T main 
```

（nm 列出了目标文件引用的所有函数）

链接器将未定义的引用更改为已定义的引用，查找引用以查看它们是否在其他文件中提供。

```
$ gcc -lm test.o
$ nm a.out
0000000000600e30 d _DYNAMIC
0000000000600fe8 d _GLOBAL_OFFSET_TABLE_
00000000004006a8 R _IO_stdin_used
                 w _Jv_RegisterClasses
0000000000600e10 d __CTOR_END__
...
0000000000601018 D __dso_handle
                 w __gmon_start__
...
                 U __libc_start_main@@GLIBC_2.2.5
0000000000601020 A _edata
0000000000601030 A _end
0000000000400698 T _fini
0000000000400448 T _init
0000000000400490 T _start
00000000004004bc t call_gmon_start
0000000000601020 b completed.7382
0000000000601010 W data_start
0000000000601028 b dtor_idx.7384
                 U fmod@@GLIBC_2.2.5
0000000000400550 t frame_dummy
0000000000400574 T main 
```

其中大部分是指在 main 之前和之后运行以设置环境的 libc 函数。您可以看到 fmod 现在指向 glibc，它将由共享库系统解析。

我的系统默认设置为使用共享库。如果我改为强制静态链接，我会得到您看到的订单依赖项

```
$ gcc -static -lm test.o
test.o: In function `main':
test.c:(.text+0x40): undefined reference to `fmod'
collect2: ld returned 1 exit status 
```

稍后`-lm`在链接器命令中，*after* `test.o`，允许它成功链接。检查符号 fmod 现在应该被解析为实际地址，确实是

```
$ gcc -static test.o -lm
$ nm a.out | grep fmod
0000000000400480 T __fmod
0000000000402b80 T __ieee754_fmod
0000000000400480 W fmod 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-06T14:21:57.343

从 gcc(1) 联机帮助页：“-l 选项的位置很重要。”

具体来说：

> ```
>  -llibrary
>    -l library
>        Search the library named library when linking.  (The second alternative with the library as a
>        separate argument is only for POSIX compliance and is not recommended.)
> 
>        It makes a difference where in the command you write this option; the linker searches and processes
>        libraries and object files in the order they are specified.  Thus, foo.o -lz bar.o searches library z
>        after file foo.o but before bar.o.  If bar.o refers to functions in z, those functions may not be
>        loaded.
> 
>        The linker searches a standard list of directories for the library, which is actually a file named
>        liblibrary.a.  The linker then uses this file as if it had been specified precisely by name.
> 
>        The directories searched include several standard system directories plus any that you specify with
>        -L.
> 
>        Normally the files found this way are library files---archive files whose members are object files.
>        The linker handles an archive file by scanning through it for members which define symbols that have
>        so far been referenced but not defined.  But if the file that is found is an ordinary object file, it
>        is linked in the usual fashion.  The only difference between using an -l option and specifying a file
>        name is that -l surrounds library with lib and .a and searches several directories. 
> ```

# javascript - 使用 chrome 扩展在后台自动进行条件浏览

> ID：11336482
> 
> 赞同：0
> 
> 时间：2012-07-04T23:57:28.563
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在研究是否可以使用 Chrome 扩展程序来自动浏览和导航（有条件地）。我希望扩展程序可以加载远程页面（在后台）并注入 javascript 来评估可点击链接并点击（通过调用 click 方法）适当的（由一些 javascript 逻辑评估）链接，然后对结果重复过程页。

我的 javascript 能力不是问题 - 但我正在努力辨别（或不） chrome 扩展是否可以在后面加载页面*并将*脚本注入其中（使 DOM 可访问）。

如果有人能证实（或否认）这样做的能力，我会很高兴——如果是这样，我会在接下来的研究方向上提供一些有用的指示。

@Rob W - 实验功能似乎完全符合要求。但我的第一次测试似乎表明这些功能仍然非常实验性......即。回调没有返回任何对象：

背景.html

```
function getAllosTabs(osTabs){
 var x = osTabs;
 alert(x.length); // error: osTabs is undefined
}

function createOffScreenTabCallback(offscreenTab){
 document.write("offscreen tab created");
 chrome.experimental.offscreenTabs.getAll(getAllosTabs);
 alert(offscreenTab); // error: offscreenTab is undefined
}

var ostab = chrome.experimental.offscreenTabs.create({"url":"http://www.google.com"}, createOffScreenTabCallback)
alert(ostab); // error: ostab is undefined 
```

对 github 上的 chromium 源代码的进一步挖掘揭示了从后台创建 offscreenTab 的限制：

> 请注意，您不能从背景页面创建屏幕外选项卡，因为它们没有关联的 WebContents。屏幕外标签的生命周期与其创建标签相关联，因此需要可见标签作为父标签有助于防止屏幕外标签泄漏。

到目前为止，我似乎不太可能创建一个在后台（自动和有条件地）浏览的扩展，但我仍然会继续尝试——也许从弹出窗口中的脚本创建它可能会起作用。它不会在计算机启动时自动运行，但会在浏览器打开并且用户单击浏览器操作时运行。

任何进一步的建议都非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T01:41:34.950

一些澄清：

*   除了扩展程序的背景页面（带有 iframe）之外，没有“背景”选项卡，但是在 iframe 中加载的页面可以知道它们是在框架中加载的，并且即使是最好的反框架破坏器脚本也可能会中断或中断
*   offscreenTab 仍然是实验性的并且非常明显，因为它的预期用途与您需要的不同
*   内容脚本，并且`chrome.tabs.update()`是处理自动导航部分的唯一方法；除了对程序极其苛刻之外，问题和限制也很多，包括 CSP（Content-Security-Policy），它们隔离的上下文隔离事件数据等。

替代品……真的不多。问题是你正在使用用户的计算机和浏览器来做你的事情，不管它们有多脏，chrome 的开发团队仍然不会喜欢它，并且会在你和你的扩展程序上做很多事情（比如 v2 清单） .

您可以使用 NPAPI 启动另一个实例`chrome.exe --load-extension=iMacros.`

# django - django 管理列表中的子目录

> ID：11336483
> 
> 赞同：0
> 
> 时间：2012-07-04T23:57:42.650
> 
> 标签：django, django-models, django-admin

我有一个将资产（策略）发布到 html 页面的应用程序。每个页面都有一个工作编号（例如 AC14245）和几个策略。此外，还有几个客户端，每个客户端都有许多页面。为了促进这一点，我有一个简单的模型，如下所示：

```
class TacticEntry(models.Model):
    client = models.CharField(max_length=50, choices=CLIENT_CHOICES)
    job_number = models.CharField(max_length=30, unique=False, blank=False, null=False)
    cell_number = models.CharField(max_length=4, unique=False, blank=True, null=True)
    posting_page = models.ForeignKey(TacticPage)
    post_title = models.CharField(max_length=64, unique=False, blank=True, null=True)
    date = models.DateField(("Date"), default=datetime.date.today)
    post_type = models.CharField(max_length=64, choices=POST_CHOICES)
    docfile = models.FileField(upload_to=content_file_name, blank=True, null=True)
    add_pdf = models.NullBooleanField()
    link_pdf = models.FileField(upload_to=content_file_name, blank=True, null=True)
    add_html = models.NullBooleanField()
    link_html = models.FileField(upload_to=content_file_name, blank=True, null=True)
    add_report = models.NullBooleanField()
    link_report = models.FileField(upload_to=content_file_name, blank=True, null=True)
    add_zip = models.NullBooleanField()
    link_zip = models.FileField(upload_to=content_file_name, blank=True, null=True)

    def __unicode__ (self):
            return u'%s %s' % (self.client, self.job_title) 
```

正如预期的那样，在管理员中，这将返回一个 TacticEntry 列表，其中列出了如下策略：

```
ACME AC111111
ACME AC111112
ACME AC111113
... 
```

由于大量记录，这很快就会成为问题。有没有一种方法可以配置管理员或模型中的 return 语句以在管理员中创建子目录/文件夹，以便将每个客户端策略分组在自己的文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:04:22.373

基本上，我正在寻找的是一种组织记录的机制。管理员过滤器功能正是如此。

# mobile - 是否可以仅通过手机呼叫来获取用户的位置？

> ID：11336484
> 
> 赞同：-5
> 
> 时间：2012-07-04T23:57:45.843
> 
> 标签：mobile, geolocation

是否可以仅通过手机呼叫来获取用户的位置？是否有任何 API 或技术可以实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:00:36.993

是的，但仅用于紧急呼叫。

出于隐私原因，没有其他人可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T04:29:55.113

我理解你的问题的方式，你不是在问 GPS 位置，而是更像是像州或国家这样的大区域？如果是这样，这是可能的。每个号码都有一个国家和（至少在美国）一个区号。你可以从中得到它。ICS 默认使用来自不同区号的号码执行此操作。

# optimization - 转换透明PNG图像文件时Webp质量非常低

> ID：11336490
> 
> 赞同：1
> 
> 时间：2012-07-04T23:58:44.647
> 
> 标签：optimization, image-processing, png, pageload, webp

我想使用 Webp 并让我的图像变得更小，最后将它们提供给 chrome 浏览器。我已经下载了许多类型的转换工具，包括官方的。我试图用 Alpha 透明度转换 PNG 并得到糟糕的结果。见下图。。

![在此处输入图像描述](../Images/e7bba9187b68236909cc956de02c01aa.png)

根据我在许多网站上看到的情况，它可以很好地处理透明度。我想知道你是否知道我为什么会得到这些结果，我需要做什么，或者我需要什么工具来生成高质量的 webp 透明图像来代替我的 png 图像。

其次，我想知道可比性。我应该只为 chrome 使用这些图像吗？- 当然最重要的问题是图像质量输出。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:18:01.540

您可能正在使用旧版本的 WebP 库/二进制文件，它不支持 alpha。因此，您看到的图像已剥离 Alpha 通道。

使用最新版本 v0.2.0 重试： [http ://code.google.com/p/webp/downloads/list](http://code.google.com/p/webp/downloads/list)

# android - TextView 缩小 TableLayout

> ID：11336491
> 
> 赞同：0
> 
> 时间：2012-07-04T23:58:59.043
> 
> 标签：android, android-layout, textview, android-tablelayout

我想创建一个简单的旗帜游戏。你得到了国家名称，然后你必须猜出正确的国旗。在我的播放屏幕上，我有一个 TextView 和一个 TableLayout，其中 2 行中有 4 个图像。这些图像是相同的维度。

问题是：TextView “缩小”了第二个 TableRow，因此图像不再同样大。如果我删除 TextView，一切都很好。

我尝试在 Hierachy Viewer 中调试，它告诉我第二个 TableRow 的属性 mMeasuredHeight 的值非常高（16777526）

我的游戏活动 xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="4dp"
    tools:context=".PlayTimeModeActivity" >

    <TextView
        android:id="@+id/tvFlagName"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:text="Hello"
        android:textSize="50dp" />

    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="center_horizontal" >

        <TableRow>

            <ImageView
                android:id="@+id/ivFlag1"
                android:layout_margin="4dp"
                android:contentDescription="@string/cdFlag1" />

            <ImageView
                android:id="@+id/ivFlag2"
                android:layout_margin="4dp"
                android:contentDescription="@string/cdFlag2" />
        </TableRow>

        <TableRow>

            <ImageView
                android:id="@+id/ivFlag3"
                android:layout_margin="4dp"
                android:contentDescription="@string/cdFlag3" />

            <ImageView
                android:id="@+id/ivFlag4"
                android:layout_margin="4dp"
                android:contentDescription="@string/cdFlag4" />
        </TableRow>
    </TableLayout>
</LinearLayout> 
```

您需要更多信息吗？

我想知道这种图像布局是否可以做得更好？

编辑：图像非常高分辨率

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:44:32.327

试试这个：

使您的布局的根 ( `LinearLayout`) 具有以下属性`android:layout_width="match_parent"`和`android:layout_height="match_parent"`

设置你`TableLayout`有`android:layout_height="wrap_content"`。这将使它在放置文本后占用屏幕上的任何剩余空间，而不是挤压 Hello 文本。

对于每个`TableRow`添加`android:layout_weight="1"`. 这将使每一行在`TableLayout`.

对于`ImageView`表中的每个，设置`android:layout_weight="1"`. 同样，这将为您的每个标志设置均匀的空间。

标志应相应缩放。如果缩放不正确，请尝试 for 中的不同`ImageView`值`android:scaleType`。

# c# - 复选框控件以启用表单上的其他控件

> ID：11336493
> 
> 赞同：2
> 
> 时间：2012-07-04T23:59:59.637
> 
> 标签：c#, winforms

我正在构建一个用于在我的应用程序中搜索数据库的表单，并且我只想添加一个控件的输入，`WHERE`如果它启用的话。我发现最好的方法是在每组控件旁边设置一组复选框来启用它们。

![在此处输入图像描述](../Images/f8d7d54a1968e380c58e0d7b42411ea1.png)

现在，我可以`CheckedChanged`为每个复选框添加逻辑，但我有几种不同类型的控件——文本框、日期选择器、组合框。所以他们必须单独完成——导致相当多的样板代码。

```
private void ChartCheckBox_CheckedChanged(object sender, EventArgs e)
{
    ClassComboBox.Enabled = ChartCheckBox.Checked;
} 
```

有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:05:51.990

如果该字段中文本的长度> 0，为什么不只包含特定字段的 WHERE 子句？例如 `if (txtArtist.Text.Length > 0) { ...`

这样您就可以摆脱复选框并且表单将更加自我维护......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:09:08.043

我会使用[复合控件](http://msdn.microsoft.com/en-us/library/a6h7e207.aspx)来执行此操作- 这正是您所需要的。

# java - JSP 日期到 PostgreSQL 日期 JasperException

> ID：11336494
> 
> 赞同：0
> 
> 时间：2012-07-05T00:00:07.780
> 
> 标签：java, jsp, postgresql

这是第二周试图找到我的问题的答案......一切都很好，除了将日期字段插入数据库问题......我相信有人可以帮助我！谢谢你 ！

数据库列是：campstart，它是一个“没有时区的时间戳”

++++++++++ JSP 页面如下：

...（一些代码）//格式化日期：

`SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy HH:mm");`

...（一些代码）//从网页获取输入

```
<input name="start" type="text" value="<%= defaultCampaign.getCampstart() != null ? dateFormat.format(defaultCampaign.getCampstart()) : dateFormat.format(new java.util.Date()) %>"> 
```

...（更多代码）

++++++++++ 在 Java 上：

...（一些代码）//声明变量

`private java.util.Date campstart = null;`

...（一些代码）//分配数据

```
public void setCampstart(java.util.Date aCampstart) {   
this.campstart = aCampstart;  } 

public java.util.Date getCampstart() {
  return this.campstart; } 
```

...（一些代码）//写入 PostgreSQL +下面是有问题的行+

```
pst.setTimestamp(10, new Timestamp(this.getCampstart().getTime())); 
```

...（更多代码）

+++++++++

当我将代码行更改为以下（用于调试）时，它工作正常：

`pst.setTimestamp(10, new Timestamp(new java.util.Date().getTime()));`

日期插入完美，它写入数据库没有错误。但是，当我更改代码以插入用户日期时，它给了我以下错误：

*org.apache.jasper.JasperException：无法将字符串“04/07/2012 19:12”转换为属性“campstart”的类“java.util.Date”：属性编辑器未向 PropertyEditorManager 注册*

有人可以帮我弄清楚我做错了什么......

谢谢你 ！！

抢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T22:02:09.650

当我更改日期格式时，它就可以工作了。出于某种原因，它在“7”而不是“07”之类的月份发送。

# maven - 在maven中生成javadoc，然后通过scp上传？

> ID：11336496
> 
> 赞同：1
> 
> 时间：2012-07-05T00:00:23.550
> 
> 标签：maven, javadoc, maven-javadoc-plugin, maven-wagon-plugin

我的 Maven javadoc 插件现在运行良好，但我不知道如何通过 scp 将它添加到远程目录。

如何通过 scp 传输 javadoc 文件，但在它们生成之后？当我调用 site:site 时，这会自动发生吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:42:01.150

maven-javadoc-plugin 默认不附加到任何阶段/目标，您需要在 pom.xml 中手动配置它。

请参阅[将 Javadocs 作为项目报告的一部分生成](http://maven.apache.org/plugins/maven-javadoc-plugin/usage.html)：

> 要生成 javadocs 作为站点生成的一部分，您应该在 pom 的部分中添加 Javadoc 插件：
> 
> ```
>  <project>
>     ...
>     <reporting>
>       <plugins>
>         <plugin>
>           <groupId>org.apache.maven.plugins</groupId>
>           <artifactId>maven-javadoc-plugin</artifactId>
>           <version>2.8.1</version>
>           <configuration>
>             ...
>           </configuration>
>         </plugin>
>       </plugins>
>       ...
>     </reporting>
>     ...
>   </project> 
> ```
> 
> 当您执行 mvn site 时，将生成 javadocs 并将其包含在生成的站点中。指向 javadocs 的链接将添加到 Project Reports 菜单中。

* * *

或者，如果您使用 maven-release-plugin，默认情况下会自动处理 javadoc 生成（和上传），请参见[此处](http://maven.apache.org/guides/mini/guide-releasing.html)：

> 在 release:perform 目标执行完成后，将创建以下可交付成果并将其部署到本地和远程存储库。
> 
> *   artifact id-version.jar
>     项目当前版本的二进制文件。
>     
>     
> *   工件 id-version-javadoc.jar
>     解释当前版本中类的当前功能的 javadoc。
>     
>     
> *   artifact id-version-source.jar
>     用于构建项目当前版本的源代码修订版。
>     
>     
> *   artifact id-version.pom
>     用于创建项目当前版本的 pom.xml 文件的内容。

* * *

如果您想将 javadoc 生成附加到站点以外的某个阶段/目标，请查看[如何部署 Javadoc jar 文件？](http://maven.apache.org/plugins/maven-javadoc-plugin/faq.html#How_to_deploy_Javadoc_jar_file)

# eclipse - 自动跳过没有附加源代码的类型

> ID：11336498
> 
> 赞同：4
> 
> 时间：2012-07-05T00:00:48.623
> 
> 标签：eclipse, debugging

在调试并按住 F5 时，如果源代码不存在，eclipse 将打开一个新窗口，声明源代码未找到。

如果源代码存在并且如果它不存在，我怎样才能让 eclipse 只尝试单步执行代码（当我一直按 F5 时），它会自动跨过它而不是这个“找不到源页面”。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T02:06:35.363

您可以做的最好的事情是使用**Step Filters**。单步过滤器可防止调试器在单步执行代码时暂停在指定的类和包中。步骤过滤器是通过 Java > Debug > Step Filtering 首选项页面建立的。=> 即您需要手动排除您没有来源的类型或包。

一种快速添加步骤过滤器的方法 - 在“调试”视图中，通过从堆栈框架的上下文菜单中选择“过滤器类型”或“过滤器包”，可以将所选堆栈框架的包或声明类型快速添加到过滤器列表中。

# jquery - 在浮动（粘性）元素上需要帮助

> ID：11336504
> 
> 赞同：0
> 
> 时间：2012-07-05T00:02:26.383
> 
> 标签：jquery, html, css

客户要求将某些模板上的侧边栏设置为粘性。然而，问题是有问题的侧边栏有时会太高而无法容纳在浏览器窗口中。

我们的想法是，当侧边栏超出可视区域时，它会正常滚动，但只要底部可见，它就会停止。当用户向上滚动时，它将再次启动。

我似乎找不到任何发生这种情况的例子。我的 google-fu 让我失望了。

有人对如何实施有任何想法吗？我想我可以使用一些相当简单的 jQuery，但是很难确定要使用哪些钩子。

任何教程、示例或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:46:13.383

我会这样处理它：

我假设您的侧边栏容器的 ID 为“侧边栏”

```
$(document).ready(function() {
    if($('#sidebar').height() < $(window).height()) {
        $('#sidebar').addClass('sticky');
    }
}); 
```

然后使用你想要的任何属性创建一个名为 sticky 的 css 类，当它没有屏幕那么高时，例如：

```
.sticky {
   position:fixed;
   left:0;
   top:0;
} 
```

编辑：`position:fixed !important;`如果粘性类没有覆盖您在#sidebar 上设置的css，则使用。

再次编辑：对不起，我重新阅读了这个问题。我将从上面开始，然后你会想要绑定到窗口滚动事件并运行一些测试 - 尝试这样的事情：

```
$(window).bind("scroll", function(){
    if($('#sidebar').offset().top - $("html").scrollTop() < 0) {
        //the top of the sidebar has scrolled above the top of the viewport
    } else {
        //the top of the sidebar is still below the top of the viewport
    }
}); 
```

希望这对您有所帮助。

# c++ - 访问成员模板的模板参数

> ID：11336507
> 
> 赞同：3
> 
> 时间：2012-07-05T00:03:37.867
> 
> 标签：c++, templates, template-specialization

我的第一个代码片段可以编译并且工作正常：

```
template <class x> struct B1
{
    template <class x> struct B2     { int getX() { return(16); } };
    template <class x> struct B2<x*> { int getX() { return(20); } };
};

void main(int argc, char* argv[])
{
    B1<int>::B2<int>  a1;
    B1<int>::B2<int*> a2;
    printf("a1=%d, a2=%d.\r\n", a1.getX(), a2.getX());
} 
```

请注意，模板参数的名称`x`在两个模板中，这不会混淆编译器。第二个示例因编译器崩溃（MSVC 2008）而失败，即没有给出任何语法错误：

```
template <class x> struct B1
{
    template <class x> struct B2 { int getX() { return(16); } };
    template <class x> struct B2<x*>;
};

template <class x> template <class x>
struct B1<x>::B2<x*>
{
    int getX() { return(3); }
}; 
```

我的问题**不是关于如何修复这个例子**，这很明显。

我查看了有关访问模板头参数的规则的标准（C++ 2003），但找不到任何相关内容。也许我错过了一些东西。

在处理`B1<x>`时，编译器是否应该只考虑第一个模板头中的参数？更有可能是的。那么在处理`B2<x>`时，是否应该同时考虑两者？当 B1/B2 的参数本身包含限定标识符并且这些标识符想要访问模板头的参数时，更复杂的情况特别有趣。为简单起见，我没有给出完整的例子。

如果有人遇到这个并且可以评论或知道一些文章/书籍、YouTube 视频等，我很想听听这个。

**更新**：我刚刚使用 MSVC 尝试了以下操作：

```
template <class x> struct B1
{
    x qq1;

    struct B2
    {
        int x;
    };
}; 
```

这可以按预期编译和工作。我还尝试了一个访问内部数据字段的 exe `x`。这表明 MS 编译器在内部范围内实现了隐藏模板参数。对我来说，即使这不符合标准，这也是合乎逻辑的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T09:41:46.293

尽管评论已考虑回答该问题，但我将在下面提供更多详细信息。请注意，我的答案仅基于 C++11 (ISO/IEC 14882-2011)。

**第 1 部分：模板参数可以重新用作嵌套成员模板的模板参数吗？**

标准中有两个关于**模板参数状态的**关键语句（特别是类型参数——这是唯一与问题相关的类型）。第一条**语句将它们描述为与****typedef-names**具有相同的状态：

> (§14.1/3) 标识符不跟在省略号后面的类型参数将其标识符定义为模板范围内的 typedef-name（如果使用 class 或 typename 声明）或 template-name（如果使用 template 声明）宣言。[...]

关于 typedef-names 的可能重新声明，我们有：

> （第 7.1.3/6 节）在给定范围内，不应使用 typedef 说明符重新定义在该范围内声明的任何类型的名称以引用不同的类型。[...]

*（备注：上述规则似乎只适用于 typedef 说明符的使用，尽管别名声明（§7.1.3/2）和模板参数声明（§14.1/3）也可用于声明 typedef-names。也就是说，上面的规则并没有明确排除使用别名声明或模板参数来重新声明同一范围内的 typedef-name，尽管这显然是预期的含义。措辞应该是“没有 typedef-name 声明应使用”而不是“不应使用 typedef 说明符”。）*

这意味着您不能这样做：

```
{
  typedef int   T;
  typedef float T;
} 
```

因为第二个声明发生在`T`最初声明的相同范围内。然而，这：

```
{
  typedef int   T;
  {
    typedef float T;
  }
} 
```

根据上述规则完全合法，因为第二个声明位于块范围内（尽管第一个声明在`T`那里仍然有效）不是`T`最初声明的范围。

由于上面引用的 §14.1/3，我们必须假设该规则也适用于模板参数声明，因此类似于

```
template <typename X> template <typename X>
struct Outer<X>::Inner<X> {

}; 
```

即使在简单的基础上也是非法的，它意味着在同一范围内两次声明相同的 typedef-name。

但是，在这样的情况下

```
template <typename X>
struct Outer {

  template <typename X>
  struct Inner {
  };

}; 
```

有人可能会争辩说，第二个声明`template <typename X>`适用于嵌套范围。幸运的是，该标准确实提供了以下关于模板参数状态的**第二条声明**：

> （§14.6.1/6）不应在其范围内重新声明模板参数（包括嵌套范围）。模板参数的名称不得与模板名称相同。[例子：

```
template<class T, int i> class Y {
  int T; // error: template-parameter redeclared

  void f() {
    char T; // error: template-parameter redeclared
  }
};

template<class X> class X; // error: template-parameter redeclared 
```

> —结束示例]

如明确所述，适用于声明范围内的任何 typedef-name 的不重新声明规则也适用于**嵌套范围**以及模板参数的情况。

这是一个例子来激发我为什么认为该规则实际上也很有用。考虑：

```
template <typename T1>
struct Outer
{
  static const int outerID = 5;

  template <typename T2>
  struct Inner
  {
    int id1() { return Outer<T1>::outerID; }
    int id2() { return Outer::outerID; }
    int id3() { return outerID; }
  };
}; 
```

内部模板的三个函数都引用外部类的同一个静态成员，但是以三种不同的方式。`id2()`并`id3()`这样做是因为 §14.6.2.1/4 要求`Outer::outerID`并被`outerID`解释为引用*当前实例化*，即`Outer<T1>::outerID`.

如果我们现在将内部模板的模板参数替换`T1`为 ，与外部模板相同，则 的含义`id1()`将会改变（因为`Outer<T1>`现在将引用内部模板中的任何定义`T1`），但是`id2()`并且`id3()`- 最自然 -仍然是指模板`outerID`所属的当前实例化。因此，可能会返回与and`id1()`不同的值，这将是最尴尬的。`id2()``id3()`

**第 2 部分：在成员模板的部分特化中，成员的模板参数是否可以用作封闭类的模板参数，反之亦然？**

该问题解决的另一个问题是成员模板的专业化或类外定义，例如

```
template <typename A> template <typename B>
struct Outer<A>::Inner<B> {
  // ...
}; 
```

外部模板（即在这种情况下）的模板参数列表`<A>`可以使用为内部模板（即`B`在这种情况下）定义的参数，反之亦然。

让我们首先考虑问题中给出的特殊情况，其中两个参数相同：

```
template <typename A> template <typename A>
struct Outer<A>::Inner<A> {
  // ...
}; 
```

尽管由于重新声明问题，我们已经在第 1 部分中排除了这一点，但我们仍然可以考虑此语法的*预期含义*，即： 定义内部类模板的显式特化，其中模板参数假定为与外部模板相同。语法正确的写法是

```
template <typename A> template <>
struct Outer<A>::Inner<A> {
  // ...
}; 
```

即第二个参数列表将为空。不幸的是，这相当于成员模板的*显式特化，这是非法的，除非封闭模板也被显式特化（第 14.7.3/16 节）。*

但是，如果我们考虑具有两个或多个参数的成员模板的部分而不是显式特化，则声明变得合法：

```
// Primary declaration
template <typename A>
struct Outer {
  template <typename A, typename B>
  struct Inner {
    // ...
  };
};

// Partial specialization of member template
template <typename A> template <typename B>
struct Outer<A>::Inner<B,A> {
  // ...
}; 
```

我们现在也使用封闭模板的模板参数`A`作为内部模板的专用第二个参数。对外部类的模板参数以及内部类的第二个模板参数使用相同数据类型的模板的任何实例化，例如

```
Outer<int>::Inner<float,int> myvar; 
```

将实例化上面定义的特化。

因此，在成员模板的模板参数列表中使用封闭类的模板参数是没有问题的，原因是在`Inner<B,A>`评估时，`A`已经具有在范围级别定义的 typedef-name 的状态`Outer`。

但是反过来做，例如

```
template <typename A> template <typename B>
struct Outer<B>::Inner<B,A> {
  // ...
}; 
```

将不起作用，因为它只是范围`B`的 typedef-name `Inner`。该标准规定：

> （§14.5.2/1）[...] 在其类模板定义之外定义的类模板的成员模板应指定类模板的模板参数，后跟成员的模板参数模板。[例子：

```
 template<class T> struct string {
      template<class T2> int compare(const T2&);
      template<class T2> string(const string<T2>& s) { /∗ ... ∗/ }
    };
    template<class T> template<class T2> int string<T>::compare(const T2& s) {
    } 
```

> —结束示例]

我将此解释为意味着两个模板参数列表（*一个后跟另一个*）是分开保存的，不被视为模板参数的一个组合列表。因此在

```
template <typename A> template <typename B>
struct Outer<B>::Inner<B,A> 
```

的解释`Outer<B>`不能使用第二个模板参数列表，并且`B`将是未定义的，而在前一种情况下

```
template <typename A> template <typename B>
struct Outer<A>::Inner<B,A> 
```

的解释`Inner<B,A>`是可能的，因为在**属于****的范围内声明**`A`了 typedef-name 的状态，即它将被成功解释为，而这又与.**`Inner`**`Inner<B,Outer::A>``Inner<B,Outer<A>::A>`

# c++ - 为什么 C++ MFC“空”项目占用 142MB 和 6MB 可执行文件？（视觉工作室 2010）

> ID：11336508
> 
> 赞同：1
> 
> 时间：2012-07-05T00:03:45.357
> 
> 标签：c++, sql, visual-studio-2010, visual-studio, mfc

作为比较，从 VS2010 C# 制作相同的基本 Windows 窗体应用程序实际上是 600 KB。对于下面的#1 和#2，我创建了一个新的基于对话框的 MFC 应用程序，名为“hello”。合并后的项目文件夹大小为 142MB。

所以我想这个问题是两部分：

1）为什么这些“必要”和如此巨大，对于一个很小的，基本上没有功能的程序：

```
hello.sdf - 61MB
hello.pch - 32MB
hello.pbd - 24MB
hello.ilk - 14MB
hello.exe - 6MB 
```

2) 最终我的目标是分发一个静态 exe，它将在 XP/2000/7/8 上运行以及在 Wine 中运行（对于 Mac/Linux 系统）——MFC 或 Win32 会更好吗？

这将是一个 Forms & Dialogs 应用程序（而不是图形和其他东西），并且主要只是读取和写入文本文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:56:54.197

这些文件与您的可执行文件大小无关。您不会将它们分发给您的用户。您正在测量智能感知数据库文件、预编译的头文件、SQL 数据库文件和链接器使用的文件。构建发布版本并查看您的 .exe 文件。这才是最重要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:12:31.997

`hello.sdf`是一个内部 visual-studio 数据库文件，用于保留源的所有交叉引用 - 它包括您的示例源所连接的 SDK 中的所有 .h 标头。

尝试使用共享库构建非 Unicode 版本。

# vtiger - vTigerCRM 5.4 新实体和字段行为

> ID：11336510
> 
> 赞同：0
> 
> 时间：2012-07-05T00:04:04.657
> 
> 标签：vtiger

我是 vTiger 开发的新手，我想知道这个功能是否可以实现：我想在 vTiger 上为邮政编码创建一个新实体。该实体将具有邮政编码、街道名称、社区、城市和州。

我想将联系人模块上的邮政编码链接到这个新实体，当有人从选择列表中选择邮政编码时，它将自动填写联系人上的街道、城市、州字段。

这应该适用于新记录或编辑记录。

对此有任何线索吗？

在此先感谢并致以最诚挚的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:11:42.047

在 vtiger 中轻松创建模块。检查 vtiger 支付模块。再见了这个示例模块，您将了解模块开发。还可以查看开发人员指南

# c# - 如何保护签名密钥？

> ID：11336511
> 
> 赞同：0
> 
> 时间：2012-07-05T00:04:21.693
> 
> 标签：c#, xml, encryption, encryption-asymmetric, integrity

我需要验证设置文件的完整性。该文件是一个 xml 文档。[我知道您可以使用此 stackoverflow 帖子](https://stackoverflow.com/questions/1974233/integrity-and-authenticity)中讨论的现成功能。但是，我无法理解如何保护签名密钥。如果我签署一个 xml 文件以作为对其内容的完整性检查，用户可以轻松地反汇编我的可执行文件并获取密钥和/或生成密钥的方式。我有哪些方法可以轻松保护密钥？密钥容器似乎是一种选择，但我看不出它们如何保护密钥和/或用于生成所述密钥的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:10:45.310

当您将密钥加载到容器中时，您可以指定它是不可导出的。这将有助于保护它，但无论如何您仍然需要将文件存储在某个地方，以防万一，例如，您有一台新计算机。

顺便说一句，我确实提到将其标记为不可导出将**有助于**保护它，而不是保证它的保护。仍然可以提取不可导出的密钥。

唯一可靠的方法是确保没有人可以物理访问计算机。物理访问意味着您可以做任何事情。

在您的情况下，这意味着私钥必须位于安全的地方，因为它是您的数字签名。验证签名的公钥已加载到您的程序中。是否反编译您的代码并提取公钥并不重要，因为它可以用来验证某些内容是否由您的私钥签名。

如果有人不厌其烦地反编译您的代码以规避设置文件的验证，他们只会更改您的代码以跳过验证。

# objective-c - Objective-C Twitter API 150 个请求

> ID：11336513
> 
> 赞同：1
> 
> 时间：2012-07-05T00:04:42.343
> 
> 标签：objective-c, ios, twitter

我正在尝试使用 NSURLConnection 从 twitter 获取推文，并且我一直在达到每小时的最大请求数（150）。我切换到使用经过身份验证的获取推文的方式，如下所示，但仍然达到最大 API 调用 - 150。我如何能够在每台设备上发出超过 150 个推特请求？

```
ACAccountStore *store = [[ACAccountStore alloc] init];
ACAccountType *twitterAccountType = 
[store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

//  Request permission from the user to access the available Twitter accounts
[store requestAccessToAccountsWithType:twitterAccountType 
                 withCompletionHandler:^(BOOL granted, NSError *error) {
                     if (!granted) {
                         // The user rejected your request 
                         NSLog(@"User rejected access to the account.");
                     } 
                     else {
                         // Grab the available accounts
                         NSArray *twitterAccounts = 
                         [store accountsWithAccountType:twitterAccountType];

                         if ([twitterAccounts count] > 0) {
                             // Use the first account for simplicity 
                             ACAccount *account = [twitterAccounts objectAtIndex:0];

                             // Now make an authenticated request to our endpoint
                             NSMutableDictionary *params = [[NSMutableDictionary alloc] init];
                             [params setObject:@"1" forKey:@"include_entities"];

                             //  The endpoint that we wish to call
                             NSURL *url = 
                             [NSURL 
                              URLWithString:@"https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=%@&count=5",someTwitterUserName];

                             //  Build the request with our parameter 
                             TWRequest *request = 
                             [[TWRequest alloc] initWithURL:url 
                                                 parameters:params 
                                              requestMethod:TWRequestMethodGET];

                             // Attach the account object to this request
                             [request setAccount:account];

                             [request performRequestWithHandler:
                              ^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
                                  if (!responseData) {
                                      // inspect the contents of error 
                                      NSLog(@"%@", error);
                                  } 
                                  else {
                                      NSError *jsonError;
                                      NSArray *timeline = 
                                      [NSJSONSerialization 
                                       JSONObjectWithData:responseData 
                                       options:NSJSONReadingMutableLeaves 
                                       error:&jsonError];            
                                      if (timeline) {                          
                                          // at this point, we have an object that we can parse and grab tweet information from
                                          NSLog(@"%@", timeline);
                                      } 
                                      else { 
                                          // inspect the contents of jsonError
                                          NSLog(@"%@", jsonError);
                                      }
                                  }
                              }];

                         } // if ([twitterAccounts count] > 0)
                     } // if (granted) 
                 }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:22:22.887

试试看这个帖子

[解决方案](http://www.snorkl.tv/2011/04/understanding-the-twitter-rate-limit-and-how-it-can-impact-your-flash-apps/)

您的推特应用程序中的问题，默认情况下有限制

# javascript - 超大的 jQuery 插件如何生成 Image 标记

> ID：11336519
> 
> 赞同：0
> 
> 时间：2012-07-05T00:06:03.910
> 
> 标签：javascript, jquery

前几天我试图了解超大插件的工作原理，我很期待使用它。

我从以下 URL 下载了插件：

[http://buildinternet.com/project/supersized/](http://buildinternet.com/project/supersized/)

我正在使用 Firebug 对其进行调试，但我不明白图像标记是如何生成的。我在任何 js、css 或 html 文件中都找不到它的标记...

有人可以看看它，并给我一些方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:36:56.557

放入 DOM 的 HTML 是在 javascript 文件/插件中生成的，我在[https://github.com/buildinternet/supersized/blob/master/core/js/supersized.core.3.2.1中突出显示的代码.js#L67-L76](https://github.com/buildinternet/supersized/blob/master/core/js/supersized.core.3.2.1.js#L67-L76)

# javascript - 基于Javascript组件的游戏设计

> ID：11336520
> 
> 赞同：1
> 
> 时间：2012-07-05T00:06:06.573
> 
> 标签：javascript, inheritance, prototypal-inheritance

我正在 node.js 服务器上开发基于浏览器的游戏。我正在尝试实现基于组件的继承结构，但我不确定有关 javascript 继承的概念。

据我所知，如果我想从两个组件对象继承，例如`function Moves(){}`and `function IsVisible(){}`，通常的原型继承不起作用：

```
gameObject.prototype = new Moves;
gameObject.prototype = new IsVisible; 
```

is`IsVisible`对象将对象覆盖`Moves`为`gameObject`原型。

下面是我尝试创建一个继承函数，该函数接受一个目标对象和任意数量的组件对象作为参数。然后目标对象从这些组件继承行为和变量。

我不熟悉 javascript 继承，想知道下面的方法是否是在 javascript 中实现多重继承类型结构的好方法？

是否有任何其他完善的做法来处理这个问题？（*如果有问题...*）

任何帮助将非常感激。

```
function inherit(o){

    var proto = o;
    for(var i = 1; i < arguments.length; i++){
        var component =  new arguments[i]();
        for(var x in component){
            proto[x] = component[x];
        }
    }
}

function Player(name){

    var o = {};
    o.name = name;
    inherit(o, WorldSpace, Active);
    return o;

}

function WorldSpace(){
    this.pos = {x:0, y:0};
    this.orientation=0;
}

function Active(){
    this.acceleration = 1;
    this.velocity = {x:0,y:0};
    this.rotation = 0;
    this.rotationSpeed = (Math.PI*2)/30;
    this.throttle = false;
    this.currentSpeed = 0;
    this.maxSpeed = 10;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T03:52:12.320

从我在您的代码中看到的内容，您实际上并不需要多重继承。您只是试图将来自不同构造函数的代码混合为一个。这是可能的，实际上在 JavaScript 中实现起来非常简单。

首先让我们重写你的代码`Player`：

```
function Player(name) {
    this.name = name;
    WorldSpace.apply(this);
    Active.apply(this);
} 
```

就是这样。简单吧？让我解释一下这个[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply "申请 - MDN")函数是如何工作的：

1.  JavaScript 中的每个函数都有一个特殊的指针，称为`this`.
2.  当您调用一个函数时，通常`this`通常指向全局对象（例如`window`）。
3.  当您调用以关键字开头的函数时，`new`JavaScript 会创建该函数的一个实例并`this`指向该实例。
4.  JavaScript 也有两个函数`call`，它们是每个函数的方法，允许您使用指针`apply`的任何值调用该函数。`this`

所以本质上，当我调用`WorldSpace.apply`with`this`作为第一个参数时，函数中的`this`指针指向in 。您本质上是使用and构造函数作为[mixins](http://en.wikipedia.org/wiki/Mixin "Mixin - 维基百科，免费的百科全书")。`WorldSpace``this``Player``WorldSpace``Active`

如果您想了解更多关于继承在 JavaScript 中的工作原理，我建议您阅读这个[答案](https://stackoverflow.com/a/8096017/783743 "JavaScript继承和构造函数属性 - 代码日志")。您是否考虑过使用[框架](https://github.com/javascript/augment "javascript/增强")来简化您的生活？

# perl - Perl 模块破坏了我的 windows xampp 安装

> ID：11336525
> 
> 赞同：1
> 
> 时间：2012-07-05T00:07:02.673
> 
> 标签：perl, apache, windows-7, xampp, cpan

问题：在尝试在 Windows7 机器上安装 gitstat 的过程中，我破坏了我的 xampp Apache 安装。现在我无法让 gitstat 或 apache 工作。

阿帕奇错误：

```
[error] Can't load Perl file: C:/xampp/apache/conf/extra/startup.pl for server localhost:80, exiting...` 
```

其他人报告此问题是由 PERL5LIB 环境变量引起的，但我的机器上不存在该变量。

我做了什么/GITSTAT 错误：

我需要安装 SOAP::Lite 模块，所以我在这里按照 Windows 指南进行操作：http: [//soaplite.com/install.html](http://soaplite.com/install.html)

据我所知，我成功安装了模块，控制台输出如下

```
cpan[1]> install SOAP::Lite
CPAN: Storable loaded ok (v2.21)
Going to read '\xampp\perl\bin\.cpan\Metadata'
  Database was generated on Wed, 27 Jun 2012 02:47:03 GMT
SOAP::Lite is up to date (0.714). 
```

我在 perl/site/lib 中看到了一个 SOAP 目录（对我而言）这意味着该模块应该可用。当我查看我的 perllocal.pod 文件时，SOAP:Lite 就在那里。

gitstat 安装说明的一部分说将 Lite.pm 文件从 perl/site/lib/SOAP 复制到 gitstat\gstat_pl\lib

但是，当我尝试执行 gitstat 安装的第九步（perl gitstat.pl HEAD）时，我得到以下信息：

```
C:\xampp\htdocs\gitstat\gstat_pl>perl gitstat.pl HEAD
 Supported versions:

BEGIN failed--compilation aborted at C:/xampp/perl/site/lib/SOAP/Lite.pm line 34
86.
Compilation failed in require at C:/xampp/perl/site/lib/SOAP/Constants.pm line 1
3.
BEGIN failed--compilation aborted at C:/xampp/perl/site/lib/SOAP/Constants.pm li
ne 13.
Compilation failed in require at lib/Lite.pm line 3444.
BEGIN failed--compilation aborted at lib/Lite.pm line 3444.
Compilation failed in require at gitstat.pl line 30. 
```

如果我不从 perl/site/lib/SOAP 复制文件，那么我会得到

```
C:\xampp\htdocs\gitstat\gstat_pl>perl gitstat.pl HEAD
Can't locate lib/Lite.pm in @INC (@INC contains: C:/xampp/perl/lib C:/xampp/perl
/site/lib .) at gitstat.pl line 30. 
```

我不明白为什么 CPAN 没有在 @INC 路径中安装 Lite.pm 模块，或者为什么当模块可用时编译可能会失败，或者最重要的是为什么我的 Apache 安装被破坏了。此外，我对 Perl 和 CPAN 非常陌生，而且我对 Apache 的理解是原始的，因此非常感谢简单的解释。

# php - PHP 文件上传器

> ID：11336526
> 
> 赞同：0
> 
> 时间：2012-07-05T00:07:03.037
> 
> 标签：php, html, file, file-upload

我想通过 PHP 上传文件。我希望这是一个下拉选择，而不仅仅是上传到“上传”目录。所以基本上，我希望表单有一个下拉菜单，无论我选择什么目录，它都可以。那么，我怎样才能让它有下拉菜单？

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<?php
$max_no_img=4; // Maximum number of images value to be set here

echo "<form method=post action='' enctype='multipart/form-data'>";
echo "<table border='0' width='400' cellspacing='0' cellpadding='0' align=center>";
for($i=1; $i<=$max_no_img; $i++){
echo "<tr><td>Images $i</td><td>
<input type=file name='images[]' class='bginput'></td></tr>";
}

echo "<tr><td colspan=2 align=center><input type=submit value='Add Image'></td></tr>";
echo "</form> </table>";
while(list($key,$value) = each($_FILES['images']['name']))
{
    //echo $key;
    //echo "<br>";
    //echo $value;
    //echo "<br>";
if(!empty($value)){   // this will check if any blank field is entered
$filename =rand(1,100000).$value;    // filename stores the value

$filename=str_replace(" ","_",$filename);// Add _ inplace of blank space in file name, you can remove this line

$add = "upload/$filename";   // upload directory path is set
//echo $_FILES['images']['type'][$key];     // uncomment this line if you want to display the file type
//echo "<br>";                             // Display a line break
copy($_FILES['images']['tmp_name'][$key], $add); 
echo $add;
    //  upload the file to the server
chmod("$add",0777);                 // set permission to the file.
}
}
?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:13:11.090

在表单中添加一些 HTML，如下所示：

```
Upload Directory: 
<select name="uploadDir">
  <option value="uploads">Uploads/</option>
  <option value="uploads2">Uploads2/</option>
</select> 
```

通过将 $add 更改为：

```
$add = "{$_POST['uploadDir']}/$filename"; 
```

瞧！:D 一定要对目录进行某种验证，因为它非常不安全，但会给你如何做的概念；）

祝你好运！

# c# - Monotouch：获取 NSDictionary 值

> ID：11336527
> 
> 赞同：2
> 
> 时间：2012-07-05T00:07:21.297
> 
> 标签：c#, ios, mono, xamarin.ios, push-notification

我有远程通知字典，但如何取出 AlertBody？

```
NSDictionary remoteNotification = options 
     [UIApplication.LaunchOptionsRemoteNotificationKey] as NSDictionary; 
```

从远程通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:50:53.687

```
 var k = new Object[] {"key"};
        var v = new Object[] {"value"};
        NSDictionary a = NSDictionary.FromObjectsAndKeys(v,k);
        NSObject value = a[NSObject.FromObject("key")]; 
```

你可以试试这个它对我有用....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:47:55.643

这对我有用：

发送推送通知：

```
oPushService.QueueNotification(NotificationFactory.Apple()
    .ForDeviceToken("YourDeviceTokenASDASD!@#SDF")
    .WithCustomItem("MyCustomItem","Item 3")
    .WithAlert("Alert pop message")
    .WithSound("default")
    .WithBadge(7))); 
```

在客户端：

```
void processNotification(NSDictionary options, bool fromFinishedLaunching) {                   
(options != null && options.ContainsKey(new NSString("aps"))) {    
    NSDictionary alertMsg = options; 
    NSObject codeCustomValue = alertMsg[NSObject.FromObject("MyCustomItem")];
    // .... and continue your code....  } 
```

希望能帮助到你！

阿曼多

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T12:37:22.777

这取决于您发送给应用程序的内容。基本上，它是您发送的转换为 NSDictionary 形式的 JSON 请求。

# perl - perl 严格引用错误

> ID：11336528
> 
> 赞同：2
> 
> 时间：2012-07-05T00:07:35.327
> 
> 标签：perl

我收到以下 perl 错误。

```
Can't use string ("") as a symbol ref while "strict refs" in use at test173 line 30. 
```

粘贴下面的代码。第 30 行是打开语句。它在公开声明中失败了。我有`use strict;`和`use warnings;`在脚本中。错误表示什么？如何更改代码以解决此错误。

```
my $file = 'testdata';
open($data, '<', $file) or die "Could not open '$file'\n";
print "file data id:$data\n"; 
@iu_data = <$data>;
$totalLineCnt = @iu_data;
print "total line cnt: $totalLineCnt". "\n"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T00:17:05.650

确保您之前没有为 $data 赋值。我只需三行即可重现您的问题：

```
use strict;
my $data = ''; 
open($data, '<', 'test.txt'); 
```

例如，您可以通过创建新范围来解决问题：

```
use strict;
my $data = ''; 
{
  my $data;
  open($data, '<', 'test.txt');
  close($data);
} 
```

或者，您可以`$data`在使用它之前取消定义：

```
use strict;
my $data = '';
undef $data; 
open($data, '<', 'test.txt');
close($data); 
```

等等等等……</p>

# iphone - Xcode 4.3.3 -[__NSArrayM 长度]：无法识别的选择器发送到实例 0x6b6dc60

> ID：11336533
> 
> 赞同：0
> 
> 时间：2012-07-05T00:09:02.310
> 
> 标签：iphone, xcode, nsstring, nsurlconnection, exc-bad-access

我有一个 iPhone 应用程序，我从互联网下载信息并将其放入`NSString`. 它工作正常，直到我下载大文件并将其放入那个字符串中，然后我得到错误

> -[__NSArrayM 长度]：无法识别的选择器发送到实例 0x6b6dc60

有一次我遇到了`EXC_BAD_ACCESS`错误，但现在没有出现。我猜这是一个内存问题，但我不知道如何解决它。字符串变量的大小是否有限制？有什么建议么？我还应该提到，错误有时不会出现，但大多数时候会出现。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T00:38:53.987

好吧，看起来您正在尝试通过调用对数组调用的方法`length`来获取数组的长度，但是要获取数组的长度，您可以使用如下`count`方法：

```
NSInteger numberOfElements = [someArray count]; 
```

希望这可以帮助！

PS 该`length`方法存在，但它用于 NSString 对象以获取字符串中的字符数。

- - 更新 - - -

来自 Ray Wenderlich 的“[我的应用程序崩溃了，现在该怎么办？](http://www.raywenderlich.com/10209/my-app-crashed-now-what-part-1) ”教程：

> 错误消息“unrecognized selector sent to instance XXX”表示应用正在尝试调用不存在的方法。

因此，在您的代码中的某处，您正在调用`length`NSArray 类型的对象上的方法。

您实际上是`length`在 NSMutableArray 类型的对象上调用该方法，并且您从错误中知道这一点，因为它`__NSArrayM`代表一个 NSMutableArray 对象；一个常规的 NSArray 对象将被表示为`__NSArrayI`（后缀“​​M”代表“可变”，而后缀“I”代表“不可变”）。

我什至发现了一个与我的答案非常相似的问题：

> **[NSArrayM 长度：发送到实例的无法识别的选择器](https://stackoverflow.com/questions/6086127/nsarraym-length-unrecognized-selector-sent-to-instance)**
> 
> *   呵呵，我以前也有过。您正在执行此操作的某个地方：[数组长度]；但数组使用“计数”，而不是“长度”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T13:10:39.507

发生这种情况是因为您尝试强制`NSMutableArray`转换为`NSString`，您只需使用 即可删除此错误`objectAtIndex:0`。

当我们使用时`objectAtIndex:0`，它会返回对象，在您的情况下，该对象是您的`NSString`，因此会消除错误。例如

```
self.quizTextView.text=[questionTexts objectAtIndex:0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T00:11:37.277

尝试打开[僵尸](https://stackoverflow.com/questions/5386160/how-to-enable-nszombie-in-xcode)以获得更好的错误消息。这可能是在您预期之前被释放的东西。您还可以尝试在“分配”或“泄漏”工具中运行您的应用程序，以追踪为什么您的对象在您预期之前被释放。

# isabelle - 是否可以不在伊莎贝尔中导入任何理论？

> ID：11336535
> 
> 赞同：8
> 
> 时间：2012-07-05T00:09:29.520
> 
> 标签：isabelle

我想在名为 的理论中定义我自己的列表类型`List`，但已经有一个具有该名称的理论。有比 更轻量级的理论`Main`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T21:21:37.107

请注意，这`$ISABELLE_HOME/src/HOL/ex/Seq.thy`给出了一个定义您自己的列表数据类型以进行实验的最小示例，而不涉及如何在其`Main`入口点下方使用系统的微妙问题。（初学者会感到困惑，专家不会这样做。）

从理论上讲，您可以导入的最原始的理论是`Pure`，但这只是最基本的逻辑框架，还没有任何像 HOL 这样的对象逻辑。只是出于好奇，您可能会查看从`$ISABELLE_HOME/src/HOL/ex/Higher_Order_Logic.thy`哪个开始`Pure`并在其之上定义了 HOL 的最小版本，但没有任何您期望从完整的 Isabelle/HOL 获得的高级理论和工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T23:44:04.740

您不能在 Isabelle 中导入任何内容（因为即使对于基本逻辑也需要导入）。Isabelle 中 HOL 的实现具有三个受支持的入口点：`Main`、`Complex_Main`（`Main`加上一些分析）和`Plain`，但只有前两个是用于常规使用的。

Plain 已经包含基本逻辑，但在标准库方面几乎没有（例如没有列表）。但也缺少 QuickCheck、Sledgehammer 和代码生成器等重要工具。此外，如果您从 Plain 开始能够命名您自己的理论列表，请注意您的理论将与 Main 上的任何工作（几乎所有内容）都不兼容。

因此，除非您有充分的理由这样做，否则我建议您遵循 Raphael 的评论并为您的列表理论重新命名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T06:12:35.527

您只能导入`HOL`，如

```
theory Test_Theory
imports HOL
begin
  …
end 
```

我经常这样做是为了测试和调查伊莎贝尔。

但是，您将缺少数据类型定义，并且可能需要导入`Datatype`（甚至可能是`Record`），以便能够编写您的`List`理论。

```
theory Test_Theory
imports HOL Datatype Record
begin
  …
end 
```

作为两者`Datatype`和`Record`imports `HOL`，您可能只需要：

```
theory Test_Theory
imports Datatype Record
begin
  …
end 
```

没有理论`Main`，这并不容易，但并非不可能。请注意，您将不得不放弃许多广泛使用的定理，并且可能必须编写并证明您自己的定理。

# python - 这两种初始化数组的方式有什么区别？

> ID：11336541
> 
> 赞同：1
> 
> 时间：2012-07-05T00:10:56.590
> 
> 标签：python, list, initialization

```
matrix = [[0]*1005]*1005 
```

和

```
matrix = [[0 for _ in range(1005)] for _ in range(1005)] 
```

我发现如果我使用前者作为初始数组，并运行`matrix[1][1] = 1`它将每行中的第二列设置为 1。第二列按我的意愿执行。我想不通为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T00:12:33.870

`[[0] * 1005] * 1005`将创建一个包含 1005个对具有 1005 个零的数组的*引用的数组。*它们都是相同的参考，所以改变一个会改变所有其他的。但是，您可以将工作代码缩短为此：

```
matrix = [[0] * 1005 for _ in range(1005)] 
```

[实际上，这几乎是任何人给你的关于列表乘法语法的唯一警告：)]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T00:20:40.610

只是为了扩展已经说过的内容

```
a = [[0]] * 5
print a # [[0], [0], [0], [0], [0]]
a[0][0] = 1
print a # [[1], [1], [1], [1], [1]] 
```

# python - Django - 从 POST 请求中获取值

> ID：11336548
> 
> 赞同：91
> 
> 时间：2012-07-05T00:11:58.987
> 
> 标签：python, django, post

我有以下 django 模板（http://IP/admin/start/ 分配给一个名为 view 的假设视图）：

```
{% for source in sources %}
  <tr>
    <td>{{ source }}</td>

    <td>
    <form action="/admin/start/" method="post">
      {% csrf_token %}
      <input type="hidden" name="{{ source.title }}">
      <input type="submit" value="Start" class="btn btn-primary">
    </form>
    </td>

  </tr>
{% endfor %} 
```

`sources`是`objects.all()`视图中引用的 Django 模型的 。每当单击“开始”提交输入时，我希望“开始”视图`{{ source.title}}`在返回呈现页面之前使用函数中的数据。如何将发布的信息（在这种情况下，在隐藏输入中）收集到 Python 变量中？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2012-07-05T00:18:01.650

阅读您的视图收到的请求对象： [https ://docs.djangoproject.com/en/dev/ref/request-response/#httprequest-objects](https://docs.djangoproject.com/en/dev/ref/request-response/#httprequest-objects)

此外，您的隐藏字段需要一个可靠的名称，然后是一个值：

```
<input type="hidden" name="title" value="{{ source.title }}"> 
```

然后在一个视图中：

```
request.POST.get("title", "") 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-05T00:17:03.513

如果您需要在前端做一些事情，您可以响应表单的 onsubmit 事件。如果您只是发布到管理员/开始，您可以通过请求对象访问视图中的发布变量。request.POST 是 post 变量的字典

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-08-12T02:10:22.913

对于 django 表单，您可以这样做；

```
form = UserLoginForm(data=request.POST) #getting the whole data from the user.
user = form.save() #saving the details obtained from the user.
username = user.cleaned_data.get("username") #where "username" in parenthesis is the name of the Charfield (the variale name i.e, username = forms.Charfield(max_length=64)) 
```

# c# - XAML 中的公共静态控件

> ID：11336549
> 
> 赞同：3
> 
> 时间：2012-07-05T00:12:04.417
> 
> 标签：c#, wpf, xaml

有谁知道我如何`public static RichTextBox`在 XAML 中创建，比如说，a？如果我在代码中声明它很容易：

```
 public static RichTextBox r; 
```

但是在 XAML 中呢？似乎应该是可能的，但我无法做到：

```
 <RichTextBox x:Name="convBox" Margin="29.333,26,39.333,95" VerticalScrollBarVisibility="Visible"> 
```

是否可以从 XAML 将其设为公开和静态？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-18T17:41:04.563

正如@MikeKulls 的回答所解释的那样，这是可能的。这是实际的实现：

应用程序.xaml：

```
<Application.Resources>
    <RichTextBox x:Key="convBox" Margin="29.333,26,39.333,95" VerticalScrollBarVisibility="Visible"/>
</Application.Resources> 
```

ViewUsingStaticControl.xaml

```
<Grid>
    <ContentControl Content="{StaticResource convBox}"/>
</Grid> 
```

**重要提示：** 正如@HB 的回答中提到的，元素只能有一个父级。以这种方式使用静态控件的结果是，如果静态控件当前正在一个视图中显示，然后显示包含该静态控件的不同视图，则该静态控件将从第一个视图中删除并添加到最近加载的视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T00:15:17.533

不，这应该是**不可能**的，因为它将在该控件/窗口/等的所有实例之间共享，这不能用一个实例来完成，因为它会有多个父级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T03:55:02.227

您可以将其定义为 App.xaml 中的资源。静态变量实际上只是全局变量，而 App.xaml 中定义的资源实际上也只是全局变量。当然有各种不同。我不确定这将通过富文本框实现什么，但确实以一种方式回答了您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T00:25:59.577

这是不可能的。您唯一的选择是`FieldModifier`可以使控件公开，而不是静态的。

```
<RichTextBox x:Name="convBox" x:FieldModifier="public" Margin="29.333,26,39.333,95" VerticalScrollBarVisibility="Visible" /> 
```

# mysql - Django mysql connectio 没有名为 mysql.base 的模块

> ID：11336557
> 
> 赞同：0
> 
> 时间：2012-07-05T00:12:44.710
> 
> 标签：mysql, django, installation

我尝试从 AWS 中的 django 应用程序服务器连接 MySQL，但它引发了一个有趣的错误：**错误是：没有名为 mysql.base 的模块**

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'try',
        'USER': 'root',
        'PASSWORD': 'pwd',
        'HOST': '',
        'PORT': '3306',
    }
} 
```

MySQLdb 已经安装。`import MySQLdb`在 python 命令行中运行。

我可以连接MySQL。我已经通过 sudo apt-get install mysql-server mysql-common mysql-client libmysqlclient15-dev 安装了它

我真的被这个错误困住了。你能帮忙解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T04:54:01.723

似乎您的 Python PATH 有问题。确保 python-mysql 数据库驱动程序位于 PATH 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:10:06.280

在我看来，您还没有为 python 安装 mysql。 [http://pypi.python.org/pypi/MySQL-python/1.2.3](http://pypi.python.org/pypi/MySQL-python/1.2.3)

或者

```
sudo apt-get install python-mysqldb 
```

# c# - 在没有 base64 编码的情况下通过 https 发送字节数组的方法？

> ID：11336561
> 
> 赞同：1
> 
> 时间：2012-07-05T00:13:46.073
> 
> 标签：c#, encoding, httphandler

我的 Outlook 插件通过 https 发送大文件。目前，我在客户端使用 Convert.ToBase64String()，在 IIS 端的 http 处理程序上使用 Convert.FromBase64String()。

这涉及到一些性能问题，而且我也在通过 SSL 保护数据，所以我真的在问是否有任何方法可以通过 https 转换字节数组，而不使用会降低接收端 CPU 性能的编码。

我的客户代码：

```
string requestURL = "http://192.168.1.46/websvc/transfer.trn";
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestURL);
request.Method = "POST";
request.ContentType = "application/x-www-form-urlencoded";

// Chunk(buffer) is converted to Base64 string that will be convert to Bytes on  the handler.
string requestParameters = @"fileName=" + fileName + @"&secretKey=testKey=" + @"&currentChunk=" + i + @"&totalChunks=" + totalChunks + @"&smGuid=" + smGuid +
                            "&data=" + HttpUtility.UrlEncode(Convert.ToBase64String(bytes));

// finally whole request will be converted to bytes that will be transferred to HttpHandler
byte[] byteData = Encoding.UTF8.GetBytes(requestParameters);

request.ContentLength = byteData.Length;

Stream writer = request.GetRequestStream();
writer.Write(byteData, 0, byteData.Length);
writer.Close();
// here we will receive the response from HttpHandler
StreamReader stIn = new StreamReader(request.GetResponse().GetResponseStream());
string strResponse = stIn.ReadToEnd();
stIn.Close(); 
```

我有性能问题的服务器代码：

```
byte[] buffer = Convert.FromBase64String(context.Request.Form["data"]); // 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T00:25:45.977

您不必使用 contentType 发送`application/x-www-form-urlencoded`。为什么不直接设置为`application/octet-stream`，设置内容长度并将数据直接复制到请求流中？只要您在另一端正确解释它，就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:18:32.960

如果您使用 WCF 数据服务，您可以通过单独的二进制流发送二进制数据

> [可以发送数据] 作为单独的二进制资源流。这是访问和更改可能表示照片、视频或任何其他类型的二进制编码数据的二进制大对象 (BLOB) 数据的推荐方法。

[http://msdn.microsoft.com/en-us/library/ee473426.aspx](http://msdn.microsoft.com/en-us/library/ee473426.aspx)

您还可以使用 HttpWebRequest 上传二进制数据

[通过 HttpWebRequest 传递二进制数据](https://stackoverflow.com/questions/8911362/passing-binary-data-through-httpwebrequest)

[使用 HTTPWebrequest (multipart/form-data) 上传文件](https://stackoverflow.com/questions/566462/upload-files-with-httpwebrequest-multipart-form-data)

# asp.net - 以编程方式创建 GridView 但单击更新时回发会阻止调用 RowUpdating

> ID：11336564
> 
> 赞同：2
> 
> 时间：2012-07-05T00:14:27.597
> 
> 标签：asp.net, ajax, gridview, postback

我只是有一个问题，我希望有人能给我一些指点。我有一个 asp 页面，它以编程方式在同一个 aspx 页面上创建多个网格视图，具体取决于从数据库中检索到的一组变量值。

由于我在后面的代码中以编程方式创建 GridView，我必须在每次页面加载、回发、oninit 等时创建 gridview gridviews。我目前在页面的 OnInit 函数中创建 gridviews。除了当用户进入行编辑模式然后单击更新（行更新）按钮/链接外，这一切都很好。这会强制在网格上进行回发，在更新它们的值之前从数据库重新加载网格值，从而防止 RowUpdating 事件启动。我该如何解决这个问题？我已尝试捕获通过 RowCommand 事件选择的命令，但此事件仅在回发后被触发，因此 oninit 函数在 Rowcommand 之前首先被调用，因此我捕获的命令名称对我几乎没有用处。

我在 Oninit 函数中按如下方式创建 GridView

```
 GridViewLineItem = New GridView
    If bEnableEdit = True Then
        GridViewLineItem.AutoGenerateEditButton = True
    End If

    If bEnableDelete = True Then
        GridViewLineItem.AutoGenerateDeleteButton = True
    End If

    GridViewLineItem.AutoGenerateColumns = False
    GridViewLineItem.EnableViewState = True
    GridViewLineItem.Font.Name = "Arial"
    GridViewLineItem.Font.Size = 8
    GridViewLineItem.ForeColor = Drawing.Color.Black
    GridViewLineItem.BackColor = Drawing.Color.White
    GridViewLineItem.BorderColor = Drawing.Color.LightGray
    GridViewLineItem.BorderStyle = BorderStyle.None
    GridViewLineItem.BorderWidth = 1
    GridViewLineItem.CellPadding = 4
    GridViewLineItem.AlternatingRowStyle.BackColor = Drawing.Color.White
    GridViewLineItem.FooterStyle.BackColor = Drawing.Color.BurlyWood
    GridViewLineItem.HeaderStyle.BackColor = Drawing.Color.DarkGray
    GridViewLineItem.HeaderStyle.Font.Bold = True
    GridViewLineItem.HeaderStyle.ForeColor = Drawing.Color.Black
    GridViewLineItem.PagerStyle.BackColor = Drawing.Color.Beige
    GridViewLineItem.PagerStyle.ForeColor = Drawing.Color.Black
    GridViewLineItem.PagerStyle.HorizontalAlign = HorizontalAlign.Right
    GridViewLineItem.RowStyle.BackColor = Drawing.Color.Beige
    GridViewLineItem.ID = "LineItemGridView" + strItemID

    strCBItemID = strItemID

    AddHandler GridViewLineItem.RowEditing, AddressOf GridViewLineItem_RowEditing
    AddHandler GridViewLineItem.RowCancelingEdit, AddressOf GridViewLineItem_RowCancelingEdit
    AddHandler GridViewLineItem.RowDataBound, AddressOf GridViewLineItem_RowDataBound
    AddHandler GridViewLineItem.RowUpdating, AddressOf GridViewLineItem_RowUpdating
    AddHandler GridViewLineItem.PageIndexChanging, AddressOf GridViewLineItem_PageIndexChanging
    AddHandler GridViewLineItem.PreRender, AddressOf GridViewLineItem_PreRender
    AddHandler GridViewLineItem.PageIndexChanged, AddressOf GridViewLineItem_PageIndexChanged
    AddHandler GridViewLineItem.RowDeleting, AddressOf GridViewLineItem_OnDeleting
    AddHandler GridViewLineItem.RowCommand, AddressOf GridViewLineItem_RowCommand

    'bind data source
    dt = New DataTable
    oda = New OleDb.OleDbDataAdapter
    oda.Fill(dt, rsGroup)
    GridViewLineItem.DataSource = dt
    GridViewLineItem.DataBind()

    'Add gridview to page    

    tCell.Controls.Add(GridViewLineItem)
    tRow.Cells.Add(tCell)
    TableLineItem.Rows.Add(tRow)

    LineItemPanel.Controls.Add(TableLineItem)
    LineItemPanel.BorderStyle = BorderStyle.Solid
    LineItemPanel.BorderWidth = 3
    LineItemPanel.BorderColor = Drawing.Color.DarkGray

    tGroupRow = New TableRow
    tGroupCell = New TableCell

    tGroupCell.ColumnSpan = TableGroupDetails.Rows.Item(0).Cells.Count
    tGroupCell.Controls.Add(LineItemPanel)

    tGroupRow.Cells.Add(tGroupCell)

    TableGroupDetails.Rows.Add(tGroupRow) 
```

当用户单击行更新时，有人可以给我一些指示如何跳过gridview的数据绑定吗？我不能不分青红皂白地将 Gridview 的 Databind 绑定在页面周围。IsPostback = false 就像我这样做一样，网格只会加载一次，而另一个其他有效的回发，例如当用户单击进入行编辑模式时会导致空网格。

谢谢

感谢一百万 SomeGuy！将 GridView 绑定移动到 Page.PreRender 解决了这个问题。我的事件流曾经是 Page.Oninit（在运行时创建 gridview）-> Page.Load（gridview 绑定）-> GridView.RowUpdating（我将更改提交到数据库）。现在是 Page.OnInit (gridview 创建) -> GridView.RowUpdating (提交对数据库的更改) -> Page.PreRender (gridview 被绑定的地方)。不过现在唯一的问题是我正在通过 iTemplate 为 gridview 的编辑模式渲染一个 ajaxcombobox。调用 GridView.RowUpdating 事件时，用户对此的选择会丢失。所有其他字段（例如文本框）都保留用户输入值。将深入研究这一点，看看我能找到什么。

PS 由于某种原因，我无法将此作为评论发布在您的帖子下...

PPS 修复了 gridview 编辑模式下 Ajax Combobox 的问题。必须将 enableviewstate 设置为 true

将 AjaxComb 调暗为新的 AjaxControlToolkit.ComboBox

AjaxComb.EnableViewState = True

这有点奇怪......你会认为它的默认值是真的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T04:13:40.373

在 PostBack 事件处理例程之后绑定 GridView`Page.LoadComplete`或事件。`Page.PreRender`您还可以尝试让 GridView 将自身与 DataSourceID 和一些 DataSourceControl 绑定。

# javascript - 立即起作用并将所有英文数字替换为阿拉伯数字的功能

> ID：11336565
> 
> 赞同：1
> 
> 时间：2012-07-05T00:14:29.600
> 
> 标签：javascript, unicode, arabic

我有这个功能

```
var map =
[
"&\#1632;","&\#1633;","&\#1634;","&\#1635;","&\#1636;",
"&\#1637;","&\#1638;","&\#1639;","&\#1640;","&\#1641;"
];

function getArabicNumbers(str)
{
    var newStr = "";

    str = String(str);

    for(i=0; i<str.length; i++)
    {
        newStr += map[parseInt(str.charAt(i))];
    }

    return newStr;
} 
```

取自[How can I view Arabic/Persian numbers in a HTML page with strict doctype?](https://stackoverflow.com/questions/5635939/how-can-i-view-arabic-persian-numbers-in-a-html-page-with-strict-doctype)

这个函数只有在`getArabicNumbers()`你调用它时在括号之间加上一些东西才会起作用。

我想在文档上从头到尾应用这个功能！我怎样才能做到这一点？在javascript中可以吗？你推荐它吗？

使用javascript将英文数字替换为阿拉伯数字的任何其他方式（在整个页面上而不是在字符串上）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T00:21:20.443

您需要[遍历 DOM 树](http://snipplr.com/view/19815/)并将每个 textnode 调用[替换](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)为 getArabicNumbers。

我可能会将 getArabicNumbers 函数更改为正则表达式；您需要做的就是匹配 0-9，然后使用回调对其进行映射。

**编辑：** [这是我为了好玩而拼凑起来的一个小小提琴](http://jsfiddle.net/zEenn/)，并展示了我在说什么，虽然我对从右到左的部分有点不确定，但它似乎工作得很好......

**Edit2:** D'oh... 你甚至可以[不用 map[] array](http://jsfiddle.net/zEenn/1/)。

# wordpress - 是否有适用于 Google Cloud Messaging (GCM) 的 Wordpress 插件

> ID：11336566
> 
> 赞同：3
> 
> 时间：2012-07-05T00:14:41.263
> 
> 标签：wordpress, google-cloud-messaging

我正在寻找适用于 Google Cloud Messaging 的 Wordpress 环境的插件。有一个可用的还是很难创建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-06T08:35:45.553

查看 WordPress 存储库。有一个名为 WP GCM 的插件，它非常棒，并且有一些很棒的附加功能！

[http://wordpress.org/plugins/wp-gcm/](http://wordpress.org/plugins/wp-gcm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T03:08:03.287

是的，pushappmaker.com 上有我写的它可以向 iPhone 和 Android 设备发送消息

# mysql - mysql insert 语句正在插入一个空白行而不是数据

> ID：11336571
> 
> 赞同：0
> 
> 时间：2012-07-05T00:15:39.223
> 
> 标签：mysql

我正在尝试将新用户添加到我的数据库中。出于某种原因，在两个不同的脚本中使用相同的确切语句并尝试调试时，如果我尝试从需要运行它的 php 脚本运行查询，mysql 会插入一个空白行而不是实际数据。

另一方面，当我尝试从随机 php 脚本中运行该确切查询，将相同的确切变量（使用会话变量）传递给数据库时，它会将数据插入数据库，因为它应该没有问题。我不知道如何解决这样的问题，并且已经尝试了很长时间。我将不胜感激任何关于我可以做些什么来解决这个问题的建议。

```
$usr_email = $_SESSION['email'];
$usr_company_name = $_SESSION['compame'];
$usr_city = $_SESSION['city'];
$usr_state = $_SESSION['state'];
$usr_phone = $_SESSION['phone'];
$usr_password = $_SESSION['password'];
$usr_first = $_SESSION['first'];
$usr_last = $_SESSION['last'];

mysql_query("INSERT INTO users (id, email, compname, city, state, phone, password, first, last)
        VALUES('','$usr_email','$usr_company_name','$usr_city','$usr_state','$usr_phone','$usr_password','$usr_first','$usr_last')",$conn); 
```

# java - 定义抽象类方法参数 Enum 对于多个值

> ID：11336572
> 
> 赞同：0
> 
> 时间：2012-07-05T00:15:43.527
> 
> 标签：java, enumeration, abstract

我有个问题。如何为具有不同对象的多个静态类定义 Enum 类型作为 Enum？

例子：

```
public abstract class AbstractClass
{
    public Enum<?> AbstractMethod();
}

public class StaticClass extends AbstractClass
{
    public enum en
    {
        FOO3,
        FOO4
    }

    @Override
    public Enum<en>[] AbstractMethod()
    {
        return en.values();
    }
}

public class StaticClass2 extends AbstractClass
{

    public enum en
    {
        FOO1,
        FOO2
    }

    @Override
    public Enum<en>[] AbstractMethod()
    {
        return en.values();
    }
} 
```

但是该代码会引发错误：该方法`public boolean AbstractMethod(Enum<ObjectX> en1)`在 AbstractClass 中不存在（X 是对象的编号）

这样做是可行的，但会引发 RawTypes 警告：

```
public abstract class AbstractClass
{
    public Enum[] AbstractMethod();
}

public class StaticClass extends AbstractClass
{
    public enum en
    {
        FOO3,
        FOO4
    }

    @Override
    public Enum[] AbstractMethod()
    {
        return en.values();
    }
}

public class StaticClass2 extends AbstractClass
{

    public enum en
    {
        FOO1,
        FOO2
    }

    @Override
    public Enum[] AbstractMethod()
    {
        return en.values();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T03:51:49.450

你是这个意思吗？

枚举：

```
public enum Fruits {
    APPLE, ORANGE;
} 
```

课程：

```
public static abstract class Parent {

    public abstract <E extends Enum<?>> void printEnum(final E e);

}

public static class Child extends Parent {

    @Override
    public <E extends Enum<?>> void printEnum(final E e) {
        System.out.println(e.name());
    }

} 
```

用法：

```
new Child().printEnum(Fruits.ORANGE); // Prints ORANGE 
```

# flash - 如何在不移动舞台的情况下旋转图形（动作脚本）

> ID：11336574
> 
> 赞同：2
> 
> 时间：2012-07-05T00:16:13.140
> 
> 标签：flash, actionscript

```
package  {
    import flash.display.MovieClip;
    import flash.events.Event;
    public class Bullet extends MovieClip {
        private var mc:MovieClip;
        public function Bullet() {

            mc = new MovieClip();
            mc.graphics.beginFill(0);
            mc.graphics.drawRect(120, 120, 40, 40);
            mc.graphics.endFill();
            addChild(mc);
            addEventListener(Event.ENTER_FRAME, onEnterFrame);
        }

        private function onEnterFrame(e:Event):void{

            mc.rotation += 10;

        }

    }

} 
```

我怎样才能在不让他在舞台上移动的情况下进行圆圈的旋转，只是停留在他之前的位置并旋转，而不是在任何地方移动是可能的？

如果您尝试此代码，您会看到圆圈在舞台上旋转和移动，所以我不想要，我该如何更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:24:51.423

通过围绕要旋转的对象中心的注册点旋转。

[Yahoo Astra](http://developer.yahoo.com/flash/astra-flash/)有一个[动态注册](http://developer.yahoo.com/flash/astra-flash/classreference/com/yahoo/astra/utils/DynamicRegistration.html)类来处理这样的事情。

这可以实现为：

```
package
{
    import com.yahoo.astra.utils.DynamicRegistration;

    import flash.display.MovieClip;
    import flash.events.Event;
    import flash.geom.Point;

    public class Bullet extends MovieClip
    {
        private var mc:MovieClip;
        private var currentRotation:uint = 0;

        public function Bullet()
        {
            mc = new MovieClip();
            mc.graphics.beginFill(0);
            mc.graphics.drawRect(120, 120, 40, 40);
            mc.graphics.endFill();
            addChild(mc);
            addEventListener(Event.ENTER_FRAME, onEnterFrame);
        }

        private function onEnterFrame(e:Event):void
        {
            currentRotation = (currentRotation + 10) % 360;
            DynamicRegistration.rotate(mc, new Point(140, 140), currentRotation);
        }

    }
} 
```

Yahoo Astra DynamicRegistration 类：

```
/*
Copyright (c) 2008 Yahoo! Inc.  All rights reserved.  
The copyrights embodied in the content of this file are licensed under the BSD (revised) open source license
*/
package com.yahoo.astra.utils
{
        import flash.geom.Point;
        import flash.display.DisplayObject;

        /**
         * Allows you to manipulate display objects based on a registration point other
         * than the standard (0,0).
         * 
         * @author Josh Tynjala
         */
        public class DynamicRegistration
        {
                /**
                 * Moves a <code>DisplayObject</code> to a new position (x,y) based on a registration point. The
                 * true position of the object will be (x - registration.x, y - registration.y).
                 * 
                 * @param       target                          the DisplayObject to move
                 * @param       registration            the registration point of the DisplayObject
                 * @param       x                                       the new x position, in pixels
                 * @param       y                                       the new y position, in pixels
                 */
                public static function move(target:DisplayObject, registration:Point, x:Number = 0, y:Number = 0):void
                {
                        //generate the location of the registration point in the parent
                        registration = target.localToGlobal(registration);
                        registration = target.parent.globalToLocal(registration);

                        //move the target and offset by the registration point
                        target.x += x - registration.x;
                        target.y += y - registration.y;
                }

                /**
                 * Rotates a <code>DisplayObject</code> based on a registration point. 
                 * 
                 * @param       target                          the DisplayObject to move
                 * @param       registration            the registration point of the DisplayObject
                 * @param       rotation                        the new rotation angle
                 */
                public static function rotate(target:DisplayObject, registration:Point, degrees:Number = 0):void
                {
                        changePropertyOnRegistrationPoint(target, registration, "rotation", degrees);
                }

                /**
                 * Scales a <code>DisplayObject</code> based on a registration point. 
                 * 
                 * @param       target                          the DisplayObject to move
                 * @param       registration            the registration point of the DisplayObject
                 * @param       scaleX                          the new x scaling factor
                 * @param       scaleY                          the new y scaling factor
                 */
                public static function scale(target:DisplayObject, registration:Point, scaleX:Number = 0, scaleY:Number = 0):void
                {
                        changePropertyOnRegistrationPoint(target, registration, "scaleX", scaleX);
                        changePropertyOnRegistrationPoint(target, registration, "scaleY", scaleY);
                }

                /**
                 * @private
                 * Alters an arbitary property based on the registration point.
                 * 
                 * @param       target                          the DisplayObject to move
                 * @param       registration            the registration point of the DisplayObject
                 * @param       propertyName            the property to change
                 * @param       value                           the new value of the property to change
                 */
                private static function changePropertyOnRegistrationPoint(target:DisplayObject, registration:Point, propertyName:String, value:Number):void
                {
                        //generate the location of the registration point in the parent
                        var a:Point = registration.clone();
                        a = target.localToGlobal(a);
                        a = target.parent.globalToLocal(a);

                        target[propertyName] = value;

                        //after the property change, regenerate the location of the registration
                        //point in the parent
                        var b:Point = registration.clone();
                        b = target.localToGlobal(b);
                        b = target.parent.globalToLocal(b);

                        //move the target based on the difference to make it appear the change
                        //happened based on the registration point
                        target.x -= b.x - a.x;
                        target.y -= b.y - a.y;
                }

        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T05:03:48.600

默认情况下，注册点（或对象旋转的点）设置为`(0, 0)`即显示对象的左上角。

当你这样做

```
mc.graphics.drawRect(120, 120, 40, 40); 
```

绘制矩形时，其左上角位于坐标处`(120, 120)`，其中心位于`(140, 140)`

您可以简单地绘制矩形，使其中心位于`(0, 0)`并在其父级中移动此影片剪辑（以便最终结果相同）

```
mc.graphics.drawRect(-20, -20, 40, 40);
mc.x=140;
mc.y=140; 
```

然后，`mc.rotation+=10`将围绕其中心旋转矩形。

# php - wp_enqueue 的 WP_debug 错误

> ID：11336578
> 
> 赞同：2
> 
> 时间：2012-07-05T00:17:31.243
> 
> 标签：php, jquery, wordpress, debugging

我遇到了两种我不知道如何解决的错误。

你可以在这里看到错误： [http ://www.brainbuzzmedia.com/themes/vertex/](http://www.brainbuzzmedia.com/themes/vertex/)

第一种类型出现两次，如下所示：

```
Notice: wp_enqueue_script was called incorrectly. Scripts and styles should not be registered or enqueued until the wp_enqueue_scripts, admin_enqueue_scripts, or init hooks. Please see Debugging in WordPress for more information. (This message was added in version 3.3.) in /home/admin/buzz/themes/vertex/wp-includes/functions.php on line 3587 
```

我在functions.php中有一个调用：

```
function my_init() {
if (!is_admin()) {
    wp_enqueue_script('jquery');
}
}
add_action('init', 'my_init'); 
```

第二个错误类型是这样的：

```
Notice: Undefined property: stdClass::$slider_height in /vertex/wp-content/themes/vertex/slider_settings.php on line 32 
```

无论我在哪里（在 if 语句内部或外部或两者）定义这些变量，它们仍然给我这个错误。

***更新

我在主题文件的子文件夹中排队了一些其他脚本，主要用于管理区域。

$path = get_template_directory_uri() 。'/includes/metabox/smart_meta_box/smart_meta_fields/layout-editor/';

wp_enqueue_script('mcolorpicker', $path . 'js/mColorPicker.js', array('jquery'));

wp_enqueue_style('chosen', $path . 'css/chosen.css');

wp_enqueue_style('content-layout', $path . 'css/content-layout.css');

wp_enqueue_script('jquery-json', $path . 'js/jquery.json.js', array('jquery'));

wp_enqueue_script('chosen-jquery', $path . 'js/chosen.jquery.min.js', array('jquery'));

wp_enqueue_script('content-layout-js', $path . 'js/content-layout.js', array('jquery', 'jquery-ui-sortable'));

我认为前端显示也可能需要它们。我将如何以正确的方式将这些排入队列？

*   更新 2

这是发生两个未定义属性错误的代码：

[链接到txt](http://www.brainbuzzmedia.com/themes/vertex/slider_settings.txt)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:24:32.263

> 使用 wp_enqueue_scripts 操作调用此函数，或使用 admin_enqueue_scripts 在管理员端调用它。

要将其加载到前端，请使用

```
add_action('wp_enqueue_scripts', 'my_scripts_method');
function my_scripts_method() {
    wp_enqueue_script('jquery');
} 
```

要为管理员加载它，请使用

```
add_action('admin_enqueue_scripts', 'my_admin_scripts_method');
function my_admin_scripts_method() {
    wp_enqueue_script('jquery');
} 
```

**参考：** [**法典**](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)。

发生第二个错误是因为`jQuery`未加载。

**更新：**

如果你有任何`wp_register_script(xxx)`或直接`wp_enqueue_style(xxx)`调用你的`functions.php`或你的任何`plugin file`然后在处理程序中使用它们`wp_enqueue_script`，如下所示

```
add_action('wp_enqueue_scripts', 'my_scripts_method');
function my_scripts_method() {
    wp_register_script('xxx'); // replace the xxx with valid script name
    wp_enqueue_script('jquery');
    wp_enqueue_style(xxx) // if you have any
} 
```

# iphone - 访问关系的计数是否会引发错误？

> ID：11336579
> 
> 赞同：1
> 
> 时间：2012-07-05T00:17:38.343
> 
> 标签：iphone, objective-c, ios, core-data

假设我获取一个名为 Department 的对象，该对象与Employees 有一对多关系（即，一个部门在一个 中有许多员工`NSSet`）。默认情况下，首先将关系作为故障获取。如果我想通过`department.employees.count`(employees is an `NSSet`) 获取员工人数，这是否会导致故障触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:29:02.340

我做了一些测试，答案是**YES**，询问关系的计数确实会触发对象的错误。我启用了 SQLite 调试日志，当我进行正常提取并且没有查询关系计数时，它只输出了几行。当我查询每个关系的计数时，我看到了几个`CoreData: annotation: to-many relationship fault "employees"`。

# ruby-on-rails - 将功能附加到rails 3中的按钮

> ID：11336583
> 
> 赞同：3
> 
> 时间：2012-07-05T00:19:30.690
> 
> 标签：ruby-on-rails, button

我的网页上显示了一组按钮。单击其中一个按钮的效果需要是调用外部 API（可能是接收到的响应，并更新页面上的某些内容）。

一些附加信息：这些按钮被部分放置在页面上，并构成用户列表的一部分。这些按钮旨在激活和停用列出的用户。我不确定这个设置是否会影响做我想做的事情的最佳方法，所以我认为值得一提。

这应该怎么做？这些按钮是否应该链接到我的 Rails 应用程序中的某个控制器？按下按钮时不需要重新加载页面吗？我可以将该请求卸载到 ajax 吗？等。

我不知道解决这个问题的最佳方法，任何指导都将证明是无价的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T22:55:34.753

好的。我相信我已经找到了一个很好的实现。

诀窍是创建一个封装按钮的表单，以便在单击按钮时点击正确的控制器。在我的例子中，我使用 rails`form_tag`函数在我的开发者控制器的部分视图中生成我的按钮`_list_item.html.erb`，如下所示：

```
<div id=<%= list_item.id %>>
    <%= form_tag "/Developer/toggle", :method => "get", :remote => true do %>
    <p>
        <% if list_item.inactive? %>
        <%= submit_tag "Activate", :name => nil %>
        <input type="hidden" name="act" value="activate" />
        <% else %>
        <%= submit_tag "Deactivate", :name => nil %>
        <input type="hidden" name="act" value="deactivate" />
        <% end %>
    </p>
    <input type="hidden" name="dev_id" value=<%=list_item.id%> />
    <% end %>
</div> 
```

在这个部分中有两件事应该引起注意。

1.  由于这是作为列表的一部分呈现的部分内容，因此您希望为每个列表项提供一个唯一的 id，以便您的 javascript 仅作用于该元素。这是在第一行完成的`<div id=<%= list_item.id %>>`，我知道这将是唯一的，因为列表中的每个 Developer 都必须具有唯一的 ID。
2.  `:remote => true`是`form_for`函数的必要参数，这是导致在后台发出请求而不是加载新页面的原因。

此表单在提交时会`Developer#toggle`使用两个参数触发我的操作：`act`，它是`activate`or `deactivate`，`id`它是我们正在操作的 Developer 的 id。这两个参数都是表单中的隐藏字段。

提交表单后，在控制器内部，我只需获取正确 Developer 的实例（在我的情况下，这样做相当复杂，但在大多数情况下可能类似于`@dev = Developer.find(id)`），并执行激活/停用所需的步骤开发商。

最后，我在`toggle.js.erb`View 目录中为我的 Developer 控制器创建了一个文件，一旦控制器完成其任务就会呈现该文件。该文件简单地获取元素（通过我们在部分中提供的唯一 id）并通过重新渲染部分来替换内部 html，如下所示：

```
document.getElementById("<%=escape_javascript(@dev.id)%>").innerHTML="<%=escape_javascript(render :partial => 'developer/list_item', :object => @dev) %>"; 
```

结果是在开发人员活动状态发生变化后重新渲染部分，从而产生适当的`Activate`或`Deactivate`按钮。

我意识到这个答案高度关注我的特定应用程序，特别是需要处理活动与非活动的切换，但是我相信它很容易简化并适应可能需要较少复杂性的其他情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:32:34.670

您可以使用 Rails 完成此任务，但必须完成页面刷新。如果您使用 Javascript/AJAX，则不应刷新页面。示例（jQuery）：

```
$(":button").click(function(){ 
  //Your Code here..
}); 
```

编辑：上面是 jQuery 代码。你想要做的是当你点击按钮时发生的一些动作。如果你想调用外部 API，那么你可以使用 ajax。在 jQuery 中查找 POST 和 GET 的文档：http: [//api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)和[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)。Google for rails jquery 教程。

# objective-c - 对 NSDictionary 键进行排序

> ID：11336589
> 
> 赞同：1
> 
> 时间：2012-07-05T00:21:28.987
> 
> 标签：objective-c, xcode

我用这些数据创建了一个字典：

```
NSString *fileContentMap = [[NSString alloc] initWithContentsOfFile:MapPath];  

SBJsonParser *parserMap = [[SBJsonParser alloc] init];

NSDictionary *dataMap = (NSDictionary *) [parserMap objectWithString:fileContentMap error:nil];

NSArray *MaparrayLongitude = [dataMap objectForKey:@"longitude"];
NSArray *MaparrayLatitude = [dataMap objectForKey:@"latitude"];

NSDictionary* DictionaryMap = [NSDictionary dictionaryWithObjects:MaparrayLatitude forKeys:MaparrayLongitude]; 
```

..然后我用这段代码阅读它：

```
 NSArray *allKeys2 = [DictionaryMap allKeys];

    NSString *key2 = [allKeys2 objectAtIndex:i];
    NSObject *obj2 = [DictionaryMap objectForKey:key2]; 
```

...但是键没有排序，我希望它们按原始顺序排序。我怎样才能做到这一点？？

# python - 第一次使用课程 - 我做错了什么？

> ID：11336590
> 
> 赞同：0
> 
> 时间：2012-07-05T00:21:33.967
> 
> 标签：python, class, methods

```
class Parser():
        html_escape_table = {
            "&": "&amp;",
            '"': "&quot;",
            "'": "&apos;",
            ">": "&gt;",
            "<": "&lt;",
            }
        def html_escape(text):
            return "".join(html_escape_table.get(c,c) for c in text)
        def query():
            database = [x, y, z, etc, etc2]
            for x in database:
                html_escape(x)
                print x #for testing purposes
                return
test = Parser()

test.query() 
```

我这样做正确吗？我不断收到错误消息：

```
TypeError: query() takes no arguments (1 given) 
```

我没有看到将参数传递给查询甚至解析器的任何地方。

有人可以解释我在这里做错了什么吗？

我尝试只调用 Parser.query() 并收到此错误（这是在将 self 参数添加到我的所有函数和 object 参数到我的 Parser 类之后）

```
 Parser.query()
TypeError: unbound method query() must be called with Parser instance as first argument (got nothing instead) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T00:26:05.130

类中的方法需要参数`self`，这与将实例解析为python如何执行实例方法的方法有关。

例如

```
class Test(object):
    def say_hello(self):
        print "Hi there" 
```

如果您想将参数解析为您仍然需要的实例方法，只需对此进行扩展`self`

```
class Test(object):
    def say_hello(self, name):
        print "Hi %s" % name 
```

编辑：

好吧，进一步解释它你必须知道python如何处理实例，python以非常详细和清晰的方式处理实例，`self`总是用来引用它自己或这个当前实例，就像`this`在Java中一样。因此，当 python 调用`my_instance.method()`它的实际调用时`TheObject.method(my_instance)`，为什么 self 指的`my_instance`是方法内部。这允许您在方法内部使用实例，而实例本身在参数内部传递。

编辑2：

即使您将 self 作为方法的参数，您也需要从这样的实例中调用它

```
my_parser = Parser()
my_parser.method() 
```

编辑3：

这不是Java，您不必将函数作为类中的方法绑定在一起，只需将它们作为自由漫游函数保留在 parser.py 文件中即可

```
import parser
parser.do_this() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T00:26:41.133

在 Python 中，类方法的第一个参数必须是`self`

```
class Parser(): # Creates a class that contain all of the functions that parse the mood based on tweets
    html_escape_table = {
            "&": "&amp;",
            '"': "&quot;",
            "'": "&apos;",
            ">": "&gt;",
            "<": "&lt;",
    }
    def html_escape(self, text):
        return "".join(html_escape_table.get(c,c) for c in text)
    def query(self):
        database = [x, y, z, etc, etc2]
        for x in database:
            html_escape(x)
            print x #for testing purposes
            return

test = Parser()

test.query() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T00:30:10.017

一件小事：如果你开始在 Python 中使用类（至少在 Python 2.x 中，Python 3 不同），你可能想要使用新的样式类，它继承自`object`.

Python 2.x 类，新风格：

```
class MyClass(object):
    def __init__(self, args):
        # some code here

    # more methods here 
```

`object`在 Python 2 的当前版本中不应再使用旧样式类（不带）。

如果您使用的是 Python 3，情况就不同了。类是在 Python 3 中进行清理的概念之一，因此不再需要继承`object`。因此，如果您正在学习在 Python 中使用类，请确保您获得的说明适用于正确的版本（主要是 2 vs 3）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T00:53:48.533

在任何面向对象的语言中，方法都必须能够访问调用它们的对象。在某些语言中，这是隐式完成的。在 Python 中，必须使用显式的第一个`self`参数声明方法。

在这里，我已将您的代码修复为具有`self`参数。

```
class Parser():
    """A class that contain all of the functions that parse the mood based on tweets."""
    html_escape_table = {
        "&": "&amp;",
        '"': "&quot;",
        "'": "&apos;",
        ">": "&gt;",
        "<": "&lt;",
        }
    def html_escape(self, text):
        return "".join(self.html_escape_table.get(c,c) for c in text)

    def query(self):
        database = [x, y, z, etc, etc2]
        for x in database:
            self.html_escape(x)
            print x #for testing purposes
            return

test = Parser()    
test.query() 
```

当您调用类似`test.query()`的`query`方法时，会调用该方法，并作为参数`test`传入。`self`此外，在您的方法中，当您想要引用对象时，您必须使用`self`参数显式访问属性。

最后一点：在您的`query()`方法中，您在 for 循环中返回，因此您只会执行循环的一次迭代，而不是遍历所有`database`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T00:28:20.697

啊！

您正在调用类型`query`为 的对象（称为`test`）`Parser`。在引擎盖下，python 正在做的是调用`Parser.query(test)`.

这就是为什么在类中编写方法时，应始终将`self`其作为第一个参数包含在内。

正如其他人所提到的，将您的函数签名更改为`def query(self)`可以解决此问题

希望有帮助

# java - aspectj 切入点/建议仅适用于 *

> ID：11336594
> 
> 赞同：1
> 
> 时间：2012-07-05T00:22:16.150
> 
> 标签：java, aop, aspectj

我在让我的方面正常工作时遇到了一些麻烦。出于某种原因，它们似乎仅在我对应用方面的位置非常通用时才起作用。在四个切入点/建议中，只有最后一个匹配并输出任何内容。我在这里想念什么？

```
public aspect VerboseAspect
{
    after(Game game) returning:
            call(* Game.addPlayer(Player))
            && target(game) {
        System.out.println("addPlayer(Player): player has been added");
    }

    after(Game game) returning:
            call(* Game.addPlayer(..))
            && target(game) {
        System.out.println("addPlayer(..): player has been added");
    }

    after(Game game) returning:
            call(* Game.*(Player))
            && target(game) {
        System.out.println("*(Player):player has been added");
    }

    after(Game game) returning:
            call(* Game.*(..))
            && target(game) {
        System.out.println("*(..):player has been added");
    }
} 
```

Java类：

```
public class Game {
    public void addPlayer(Player player) {
        System.out.println("inside class");
        this.players.add(player);
    }
} 
```

输出：

```
inside class
*(..):player has been added 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T01:44:25.570

（评论，但太长了。）

您使用的是哪个版本的 AspectJ？你怎么建？蚂蚁？马文？其他？

它在 IntelliJ 中对我来说很好用；运行这个：

```
public static void main(String[] args) {
    Game g = new Game();
    g.addPlayer(new Player());
} 
```

产生：

```
inside class
addPlayer(Player): player has been added
addPlayer(..): player has been added
*(Player):player has been added
*(..):player has been added 
```

# xlib - XChangeProperty() 总是失败

> ID：11336596
> 
> 赞同：5
> 
> 时间：2012-07-05T00:22:24.133
> 
> 标签：xlib

我正在学习使用 xlib，但无法`XChangeProperty()`为我工作。

我有一个简单的程序可以成功显示一个窗口。但是调用`XChangeProperty()`总是失败并显示错误代码`error 1 (BadRequest)`。

有人可以告诉我我做错了什么吗？

这是我更改属性的代码。

```
static void
change_prop(Display *display, Window window)
{
    unsigned char some_text[40] = "hello world!";
    int retval;
    Atom my_atom;

    my_atom = XInternAtom(display, "PERSONAL_PROPERTY", False);
    if (my_atom == None)
    {
          printf("### failed to create atom with name PERSONAL_PROPERTY\n");
          return;
    }

    retval = XChangeProperty(display,   /* connection to x server */
                             window,    /* window whose property we want to change */
                             my_atom,   /* property name */
                             XA_STRING, /* type of property */
                             8,         /* format of prop; can be 8, 16, 32 */
                             PropModeReplace,
                             some_text, /* actual data */
                             10         /* number of elements */
                            );

    printf("###### XChangeProperty() reted %d\n", retval);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T01:00:54.490

大多数 xlib 函数总是返回 1，您应该[使用错误处理程序](http://tronche.com/gui/x/xlib/event-handling/protocol-errors/default-handlers.html)来检查错误。请参阅[XChangeProperty 实现](https://gist.github.com/3057356)-`return 1`最后附注。

你的代码工作得很好：

```
#include <stdio.h>
#include <stdlib.h>
#include <X11/Xlib.h>
#include <X11/Xutil.h>
#include <X11/Xos.h>
#include <X11/Xatom.h>
#include <X11/keysym.h>

static void
change_prop(Display *display, Window window)
{
    unsigned char some_text[40] = "hello world!";
    int retval;
    Atom my_atom;

    my_atom = XInternAtom(display, "PERSONAL_PROPERTY", False);
    if (my_atom == None)
    {
          printf("### failed to create atom with name PERSONAL_PROPERTY\n");
          return;
    }

    retval = XChangeProperty(display,   /* connection to x server */
                             window,    /* window whose property we want to change */
                             my_atom,   /* property name */
                             XA_STRING, /* type of property */
                             8,         /* format of prop; can be 8, 16, 32 */
                             PropModeReplace,
                             some_text, /* actual data */
                             10         /* number of elements */
                            );

    printf("###### XChangeProperty() reted %d\n", retval);
}

int main() 
{

  Display *dis;
  Window win;

  dis = XOpenDisplay(NULL);
  win = XCreateSimpleWindow(dis, RootWindow(dis, 0), 1, 1, 500, 500, \
    0, BlackPixel (dis, 0), BlackPixel(dis, 0));
  XMapWindow(dis, win);
  printf("window %i\n", (int)win);
  change_prop(dis, win);

  XFlush(dis);
  sleep(50);
  return(0);
} 
```

结果：

```
09:48 tmp $ g++ prop.cpp /usr/X11/lib/libX11.dylib
09:48 tmp $ ./a.out 
window 6291457
###### XChangeProperty() reted 1 
```

[xprop](http://www.xfree86.org/current/xprop.1.html)结果：

```
09:48 tmp $ xprop -id 6291457
WM_STATE(WM_STATE):
        window state: Normal
        icon window: 0x0
_NET_WM_STATE(ATOM) = 
_NET_WM_ALLOWED_ACTIONS(ATOM) = _NET_WM_ACTION_MOVE, _NET_WM_ACTION_RESIZE, _NET_WM_ACTION_MINIMIZE, _NET_WM_ACTION_MAXIMIZE_HORZ, _NET_WM_ACTION_MAXIMIZE_VERT, _NET_WM_ACTION_FULLSCREEN, _NET_WM_ACTION_CLOSE
PERSONAL_PROPERTY(STRING) = "hello worl" 
```

# asp.net-mvc-3 - 列表 来自 url 参数行为的参数默认绑定

> ID：11336598
> 
> 赞同：1
> 
> 时间：2012-07-05T00:22:53.200
> 
> 标签：asp.net-mvc-3

为什么我们会有这种行为？

控制器动作：

```
public ActionResult TestProc(List<int> list)
{
  return new ContentResult();
} 
```

要求：

/TestProc 导致一个空列表。好的

/TestProc?list=[] 导致一个空列表。好的

/TestProc?list= 导致一个包含一项 0 的列表。不正常。我假设活页夹看到查询字符串存在，它没有任何值，因此它将默认 int 值推送到列表中，即它将 list= 视为与 list=0 相同。我觉得这很混乱。我会认为 list= 在这种情况下根本没有 list 是相同的，我希望 list 为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T05:45:26.227

> 我觉得这很混乱

我同意。在这种情况下，您可以使用可为空的整数：

```
public ActionResult TestProc(List<int?> list) 
```

这一次，模型绑定器将推送一个元素，如果你必须这样做`null`，你将能够消除歧义。`/TestProc?list=``/TestProc?list=0`

# ios - MKMapKit iOS 5\. 我可以在需要时设置所需的委托吗？

> ID：11336599
> 
> 赞同：0
> 
> 时间：2012-07-05T00:23:01.887
> 
> 标签：ios

我有一个关于地图和委托的问题。我正在做一本书的练习，它告诉我要使用该方法

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation
{
    //CLLocationCoordinate2D loc = [userLocation coordinate];
    self.coord2D = [userLocation coordinate];

    //MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(loc, 250, 250);
    MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(self.coord2D, 250, 250);

    [worldView setRegion:region animated:YES];
} 
```

这意味着每次我将手机从我所在的位置移开时，它都会在屏幕上显示我自己。我还创建了一个调用此方法的按钮。因此，如果我滚动我的地图，我可以看到我在哪里。

问题是：如果我在车里并且想要滚动我的地图，这将成为一项艰巨的任务，因为这个方法会在我改变我的位置时一直被调用。

是否有任何其他方法，或者我是否可以选择激活和停用委托？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:46:09.850

据我所知，这很简单。只需一个按钮即可激活和停用它。

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation
{
    //CLLocationCoordinate2D loc = [userLocation coordinate];
    self.coord2D = [userLocation coordinate];

    if (self.trackUserLocation) {
        //MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(loc, 250, 250);
        MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(self.coord2D, 250, 250);

        [worldView setRegion:region animated:YES];
    }
} 
```

物业：

```
@property (nonatomic, assign) BOOL trackUserLocation; 
```

按钮动作：

```
self.trackUserLocation = !self.trackUserLocation; 
```

你不必让它比这更难。

# css - 如何在应用程序布局控件的中间部分使图形居中？

> ID：11336601
> 
> 赞同：0
> 
> 时间：2012-07-05T00:23:11.953
> 
> 标签：css, xpages, xpages-extlib

我有几张图片要排列，然后放在应用程序布局控件的中间部分。我已经做了几次尝试，但显然我太麻木了，无法弄清楚。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T06:55:39.360

您需要研究 CSS。

例如，您可以在图像周围添加一个 div，然后为该 div 分配一个 CSS 类。使用 CSS，您可以根据自己的喜好为该 div 居中和控制大小等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T07:26:09.333

我会说。看看[W3C Centering 的东西。](http://www.w3.org/Style/Examples/007/center.en.html)

# php - 导出大量 Magento 目录的最佳方式是什么

> ID：11336604
> 
> 赞同：5
> 
> 时间：2012-07-05T00:23:21.947
> 
> 标签：php, magento, export

我正在阅读大量关于 Magento 的 API、Magento 的模型和直接 SQL 调用的文档。当我读到的时候，第一个结论是直接 sql 调用会非常快，但我必须特别注意安全性，模型的使用使开发更快更容易，但另一方面，它会损失大量的性能操作目录。

我将不得不处理一个拥有大约 50k 产品和大量流量的商店，我必须将它们导出到另一个具有类别层次结构、sku、描述、图像、产品名称、url_path 的服务器，然后每小时只获取一次更新的. 最好的方法是直接调用 sql，但是用模型来实现它会是自杀吗？您是否认为将其与 SOAP API 集成将是另一种自杀，我应该在单独的 PHP 中进行此操作吗？

提前超级感谢，我对此感到非常迷茫，并为我糟糕的英语维尼修斯感到抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T12:10:41.550

1）50K产品的实时服务器上的soap api会很慢。
2) 由于 EAV 结构，直接 sql 调用编写起来非常麻烦
3) 为了防止实时服务器的占用，获取数据库的只读副本，使用它在本地/另一台服务器上安装 magento。并为此努力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T12:22:29.130

这里有很多考虑。我说这个是因为我有类似的问题。我目前正在使用 SQL 将数据从 magento 存储到 xml。确实，只有在您知道要获取的属性的情况下，使用 sql 才能使其更快。例如。如果您的产品有 15 个属性，这意味着使用 sql 有 50k x 15 个属性。但至少您不会遇到版本问题，因为您使用的是 sql 语句。

另一方面...使用模型和 API 会带来很多版本问题，特别是如果您正在为多个 magento 版本进行开发。另一个问题也是关于 magento 自定义属性的。例如。如果我添加另一个名为“US SPECIAL SHIPPING”的属性，API 会变得非常困难。

如果您不介意...您只需对所有属性进行直接 sql 调用并将它们保存到 xml。这意味着您需要非常非常快的机器来执行此操作。

magento connect 上有一个扩展，它服务于比较引擎。它可能适合您的出口需求。尝试一下。[价格比较脚本](http://www.magentocommerce.com/magento-connect/feed-manager-version-1-1-3.html)

```
<?php 

set_time_limit(3000);
ini_set('memory_limit', '-1');
include_once 'app/Mage.php';
umask(0);
Mage::app();
$products = Mage::getModel('catalog/product')->getCollection();
$products->addAttributeToSelect('*');
$products->load(); 
$baseUrl = Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB);                       
    $output = '<?xml version="1.0" encoding="utf-8"?>
    <products>';
if (count($products)): 

  foreach ($products as $id => $product):

  $url = $product->getProductUrl();
  $output .= '
  <product>
  <id>'. $product['entity_id'].'</id>
  <name><![CDATA['. $product['name'] .']]></name>
  <sku>'. $product['sku'] .'</sku>
  <description><![CDATA['. $product['description'] .']]></description>
  <shortdescription><![CDATA['. $product['short_description'] .']]></shortdescription>
  <price><![CDATA['. $product['price'] .']]></price>
  <minimalprice>'. $product['minimal_price'] .'</minimalprice>   
  <weight><![CDATA['. $product['weight'] .']]></weight>
  <categories><![CDATA['. $product['categories'] .']]></categories>
  <color><![CDATA['. $product['color'] .']]></color>
  <condition><![CDATA['. $product['condition'] .']]></condition>
  <availability><![CDATA['. $product['availability'] .']]></availability>
  <shipping><![CDATA['. $product['shipping'] .']]></shipping>
  <url><![CDATA['. $url.']]></url>
  <meta><![CDATA['. $product['meta_keyword'] .']]></meta>
  <metadescription><![CDATA['. $product['meta_description'] .']]></metadescription>
  <manufacturer><![CDATA['. $product['manufacturer'] .']]></manufacturer>
  <brand><![CDATA['. $product['brand'] .']]></brand>
  <upc><![CDATA['. $product['upc'] .']]></upc>
  <mpn><![CDATA['. $product['mpn'] .']]></mpn>
  <image><![CDATA['. $baseUrl ."media/catalog/product". $product['image'] .']]>        </image>';
  if (isset($attributes[$product['entity_id']])) {
  $output .= '
  <attributes>';  
  foreach ($attributes[$product['entity_id']] as $attribute => $values)
   $output .= '
    <attribute>
     <name>'. $attribute .'</name>
      <values>'.  join(', ', $values) . '</values>
     </attribute>';  
   $output .= '
 </attributes>';
  }

$output .= '
</product>';
endforeach;
endif;
header ("Content-Type: text/xml; charset=ISO-8859-1");
print $output .= '
 </products>'; 
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-26T23:39:28.727

将 Magento 产品导出到 Google 购物时，我遇到了完全相同的问题。它总是超时（可能是由于我的提要中有太多产品）。

[在对magento exporting](http://www.internetmarketing.net/2014/blog/how-to-export-magento-product-feed-for-google-shopping.html)进行了一些研究后，我尝试将 php.ini 设置更改为以下值：

```
ini_set(’max_execution_time’,’1800’);
ini_set(’memory_limit’,’1024M’); 
```

它工作得很好！

# c# - 位图数据在哪里？

> ID：11336608
> 
> 赞同：-2
> 
> 时间：2012-07-05T00:23:43.480
> 
> 标签：c#, silverlight, windows-phone-7, image-processing

今天我开始将我的 C# 桌面应用程序移植到 Windows Phone 7.5。

在我的应用程序中，我进行图像处理。我需要使用`BitmapData`、和`LockBits`，但它们似乎不适用于 Windows Phone。什么是等价物？`UnlockBits``Scan0.ToPointer()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:47:58.740

手机支持紧凑型框架——“紧凑型”意味着并非完整框架中的所有内容都可用。

对于手机上的图像处理，我建议您查看 nuget 和 codeplex 上的 writablebitmapex 和 imagetools 库。

*   [http://writeablebitmapex.codeplex.com/](http://writeablebitmapex.codeplex.com/)
*   [http://imagetools.codeplex.com/](http://imagetools.codeplex.com/)

# java - 涉及继承的映射的 Hibernate 查询标准

> ID：11336611
> 
> 赞同：0
> 
> 时间：2012-07-05T00:24:36.633
> 
> 标签：java, hibernate, hibernate-criteria

假设类'X'映射到表'X'，类'A'映射到表'A'，类'B'映射到表'B'。

表 X 结构：（X_ID，一些其他列） 表 A 结构：（A_Id，X_Id，一些其他列）表 B 结构：（A_Id，一些其他列）...表 B 也有 A_Id

**“B”类扩展了“A”类。**我们有它们的映射文件：

**“A”类父映射文件：**

```
@Entity
@Table(name = 'A')
@Inheritance(stratergy=InheritanceType.Joined)
public abstract class A {
@Id @Clumns(name = "A_Id)
@GeneratedValue
protected Long aId;
-- some more A specific fields
} 
```

**“B”类映射文件：**

```
@Entity
@Table(name= 'B')
Public class B extends A{
---- B specific fields
} 
```

现在，我有一个如下的 SQL 查询，我需要使用休眠条件 API 编写它。

```
select * from X
INNER JOIN A 
ON X.id = A.id
INNER JOIN B
ON A.id = B.id
where B.name = 'XYZ'
   and B.Sex = 'M' 
```

我想出了：

```
Criteria c = session.createCriteria(x.class, "x");
                    .createAlias("x.a", "a")
                    .createAlias("a.b", "b")          
                    .add(Restrictions.eq("b.sex", "M"))
                    .add(Restrictions.eq("b.name", "XYZ")); 
```

但是，如果我们检查映射文件，A 中没有 B 的直接引用。因此 hibernate 抛出“B 与 A 无关”实体。

有什么方法可以在查询条件中映射这种继承

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:35:09.330

您根本不需要`A`在标准中引用或使用任何别名。

```
Criteria c = session.createCriteria(B.class);
                    .add(Restrictions.eq("sex", "M"))
                    .add(Restrictions.eq("name", "XYZ")); 
```

会给你你需要的结果。

由于`InheritanceType.Joined`，这可能会生成包含`A`表连接的 SQL（与您显示的 sql 接近），但没有必要在条件中指定该连接。

条件中看起来像列的东西实际上是对 Java 对象中字段的（反射性）引用。Hibernate 从您的注释中找出要放入 sql 的列，如果需要，应该根据继承注释连接到 A 表。

为了在您的上下文中确定这一点，并更好地理解这一切，我建议尝试它并打开生成的 sql 的日志记录，如对另一个 SO hibernate 问题的[回答中所述。](https://stackoverflow.com/questions/2536829/hibernate-show-real-sql/2538954#2538954)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T11:14:19.190

试试这个方法： Criteria rootCrit = session.createCriteria(A.class); rootCrit.createAlias("B", "B"); rootCrit.add(Restrictions.eq("B.sex", "M")); rootCrit.add(Restrictions.eq("B.name", "XYZ"));

# html - 支持 html5 的设备的 oauth

> ID：11336612
> 
> 赞同：2
> 
> 时间：2012-07-05T00:25:16.477
> 
> 标签：html, mobile, cookies, oauth

我正在为 iOS 和 Android 设备构建一个 web 应用程序，它要求用户使用他们的 Facebook 或 Twitter 帐户登录。我进行了设置，以便最初将它们重定向到适当的登录页面，并在成功完成后触发我提供的回调 URL。

因为我想实现单点登录，所以我会将收到的访问令牌存储在用户的设备上，这样他们就可以轻松访问 web 应用程序，而无需下次再次登录。

我的问题是：从服务器端将其存储为 html4 cookie 是否更好？还是将其作为隐藏输入插入主页并让客户端上的 javascript 抓取它并将其与新的本地/会话存储一起存储是否更好？如果是后者，对于我想要保存的这种类型的数据，哪种类型的存储会更好？

# django - 无法使用 django-pipeline 和 YUI 压缩文件

> ID：11336613
> 
> 赞同：3
> 
> 时间：2012-07-05T00:25:17.113
> 
> 标签：django, yui-compressor, django-compressor

当我运行**python manage.py collectstatic**时，我得到：

```
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/Users/fceruti/Development/Arriendas.cl/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/core/management/base.py", line 371, in handle
    return self.handle_noargs(**options)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/collectstatic.py", line 163, in handle_noargs
    collected = self.collect()
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/collectstatic.py", line 119, in collect
    dry_run=self.dry_run)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/storage.py", line 30, in post_process
    packager.pack_stylesheets(package)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/packager.py", line 90, in pack_stylesheets
    variant=package.variant, **kwargs)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/packager.py", line 100, in pack
    content = compress(paths, **kwargs)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/compressors/__init__.py", line 72, in compress_css
    css = self.concatenate_and_rewrite(paths, output_filename, variant)
  File "/Users/fceruti/Development/Arriendas.cl/venv/lib/python2.7/site-packages/pipeline/compressors/__init__.py", line 135, in concatenate_and_rewrite
    content = self.read_file(path)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/compressors/__init__.py", line 208, in read_file
    file = default_storage.open(path, 'rb')
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/django/core/files/storage.py", line 33, in open
    return self._open(name, mode)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/storage.py", line 114, in _open
    storage = self.find_storage(name)
  File "/Users/fceruti/Development/xxxxx/venv/lib/python2.7/site-packages/pipeline/storage.py", line 111, in find_storage
    raise ValueError("The file '%s' could not be found with %r." % (name, self))
ValueError: The file 'css/960_24_col.css' could not be found with <pipeline.storage.PipelineFinderStorage object at 0x101da4d50>. 
```

当我运行**python manage.py findstatic css/960_24_col.css**时，我得到

```
Found 'css/960_24_col.css' here:
  /Users/fceruti/Development/xxxxxxx/Arriendas/static/css/960_24_col.css 
```

我的设置是：

```
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static')

STATICFILES_DIRS = (
    ('css', os.path.join(STATIC_ROOT, 'css')),
    ('img', os.path.join(STATIC_ROOT, 'img')),
    ('js', os.path.join(STATIC_ROOT, 'js')),
    ('fonts', os.path.join(STATIC_ROOT, 'fonts')),
)

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)
PIPELINE = True
PIPELINE_CSS = {
    'app': {
        'source_filenames': (
            'css/960_24_col.css',
            'css/base.scss',
        ),
        'output_filename': 'css/app.css',
        'extra_context': {
            'media': 'screen,projection',
        },
    },
}
PIPELINE_CSS_COMPRESSOR = 'pipeline.compressors.yui.YUICompressor'
PIPELINE_JS_COMPRESSOR = 'pipeline.compressors.yui.YUICompressor'
PIPELINE_YUI_CSS_ARGUMENTS = ''
PIPELINE_YUI_JS_ARGUMENTS = ''
PIPELINE_YUI_BINARY = os.path.join(PROJECT_ROOT, 'libs/yuicompressor-2.4.7/build/yuicompressor-2.4.7.jar')

STATICFILES_STORAGE = 'pipeline.storage.PipelineCachedStorage'
PIPELINE_SASS_BINARY = '/usr/bin/sass' 
```

当我添加

```
PIPELINE_COMPILERS = (
    'pipeline.compilers.sass.SASSCompiler',
) 
```

运行网页，我得到：

```
Exception Type: CompilerError
Exception Value:    
Unable to apply SASSCompiler compiler 
```

我究竟做错了什么？

编辑：

我使用的软件有：

*   Sass 3.1.19（聪明的贝蒂）
*   YUI 压缩器 2.4.7
*   django-管道==1.2.11
*   姜戈 1.4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T08:11:11.950

首先，你不应该把jar作为`PIPELINE_YUI_BINARY`，而是你应该指向一个用java调用jar的脚本（大多数时候，它在打包时与它捆绑在一起）。它看起来像这样：

```
#!/bin/sh
java -jar "/path/to/yuicompressor-2.4.7.jar" $@ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-10T02:41:51.903

我认为您希望您的 STATICFILES_DIRS 看起来像这样：

```
STATICFILES_DIRS = ('./static/') 
```

如果这不起作用，请尝试类似的方法。

```
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__)[0: (os.path.dirname(__file__).rindex(os.sep + 'src' + os.sep))])
STATICFILES_DIRS = (os.path.join(PROJECT_ROOT, 'static/' )) 
```

（想法是将 PROJECT_ROOT 设置为您的应用程序的顶级目录）

您设置它的方式将在您的每个子目录中查找“css/960_24_col.css” 换句话说，它将查找

*   STATIC_ROOT/ **css/css/** 960_24_col.css
*   STATIC_ROOT/img/css/960_24_col.css
*   STATIC_ROOT/js/css/960_24_col.css
*   STATIC_ROOT/fonts/css/960_24_col.css

它不会找到它，因为文件位于

```
STATIC_ROOT/css/960_24_col.css 
```

* * *

通常，STATICFILES_DIRS 是包含在不同应用程序中的 /static/ 目录的集合。如果 yourApp 包含 myApp，并且 myApp 有一个静态目录，则您会将 yourApp 的静态目录和 myApps 静态目录都放在列表中。Collectstatic 会将它们组合到 STATIC_ROOT 中，然后在其上运行 Pipeline。

# ios - iOS中的假名（不是汉字）手写识别

> ID：11336615
> 
> 赞同：3
> 
> 时间：2012-07-05T00:25:44.380
> 
> 标签：ios, input, kana

Daijirin 字典应用程序 (http://itunes.apple.com/us/app/da-ci-lin/id299029654?mt=8) 允许通过我无法弄清楚如何访问的界面进行手写平假名和片假名输入任何其他应用程序。

这是一张照片：[http ://twitpic.com/a3ynft](http://twitpic.com/a3ynft)

他们如何做到这一点？

在我看来，它是本土的......但我想要这样的东西。关于如何实现的任何参考？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:01:35.210

我想我明白你在问什么（不是 100% 肯定），但无论如何我都会尝试回答。用户可以通过转到 来指定他们希望键盘使用的`Settings > General > International > Keyboard > Add New Keyboard > Japanese - 10-Key`语言，但你不能以编程方式更改键盘语言.

请参阅这些问题的答案以获得进一步的证明：

> **[根据用户输入以不同语言显示 iPhone 键盘](https://stackoverflow.com/questions/3032116/showing-iphone-keyboard-in-different-languages-based-on-user-input)**
> 
> *   不幸的是，您无法控制键盘的语言。用户通过设置应用程序选择他们希望使用的键盘，并可以使用键盘上的地球图标在它们之间切换。打开键盘时，它将打开最近使用的键盘。
> 
> **[设置 iPhone 键盘语言](https://stackoverflow.com/questions/330542/setting-the-iphone-keyboard-language)**
> 
> *   不幸的是，这是用户定义的设置，不能被程序员弄乱。

所以基本上，**你是正确的，因为它是本土的。**

但是，我可以为您指明从哪里开始的正确方向。我在 iPhone 上识别日语手写输入时发现了这个问题，这是最佳答案（关于汉字的答案，但不是假名）：

> **[iOS日文手写输入代码请帮忙](https://stackoverflow.com/questions/6379729/ios-japanese-handwriting-input-code-help-please)**
> 
> 我们在大学进行了类似的练习。
> 
> 由于笔画的顺序是用汉字很好地定义的，并且只有 8 个（？）不同的笔画。基本上每个汉字都是有序的笔画序列。像 te （手）是序列“向后落下的短划”，然后是“从左到右划”的两倍，最后是“底部有小尖的长向下划”。有数据库可以为您提供这些信息。
> 
> 现在问题几乎减少到识别正确的笔划。您仍然会遇到一些模棱两可的问题，您必须考虑某些笔画与其他笔画的空间关系。
> 
> 对于笔画识别，我们将徒手书写的角度设为 45 度（键盘上的小圆圈符号在哪里？），从而将其转换为沿其中一个方向的向量序列。假设方向 0 是从下到上，方向 1 是从右下到左上，方向 2 从右到左，依此类推。
> 
> 那么 te (手) 的第一个笔画是 [23]+（有些人写它是下降的，有些是水平的）第二个和第三个笔画是 6+，最后一个是 4+[123]（就像小提示一样，每个作家使用不同的方向）
> 
> 这种粗略的捕捉实际上足以让我们识别汉字。也许还有更复杂的方法，但这个简单的解决方案设法识别了大约 90% 的汉字。它不能只掌握一位教授的字迹，但问题是除了他自己之外，没有人能读懂他的字迹。
> 
> 重要的是您的用户“打印”汉字而不是用书法书写，因为在书法中，许多笔画被合并为一个。就像在书法中用“稻田”的部首写汉字一样，这个部首变成了完全不同的东西。或者带有很多水平破折号的部首（例如“speech” iu 的部首）只是变成一条长长的蠕动线。

另外，我发现了一个名为 Tegaki 的开源项目，用于中文和日文字符识别。您可以在此处下载并[在](http://tegaki.org/userdoc/)[此处](http://tegaki.org/)查看文档。我不太确定它是否支持假名，但无论如何你应该检查一下。

最后，您可以查看这些其他问题以获取有关一般手写识别的信息：

*   [iOS：如何实现手写识别？](https://stackoverflow.com/questions/9108507/how-to-implement-handwriting-recognition-in-ipad)
*   [是否有适用于 iPhone 的手写识别库？](https://stackoverflow.com/questions/3607827/are-there-any-handwriting-recognition-libraries-available-for-the-iphone)
*   [iOS 的手写识别应用程序如何识别我的笔迹？](https://stackoverflow.com/questions/7947744/how-does-handwriting-recognition-apps-for-the-ios-recognize-my-handwriting)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:50:18.773

是的，它是国产的。您可以像通常创建 UIView 一样创建此视图，然后将其设置为文本字段的`inputView`. 至于实际的认可，那是另一回事。我什至不知道从哪里开始。

# ios - Cordova/PhoneGap：childBrowser UI 图像低分辨率/大块（iOS）

> ID：11336616
> 
> 赞同：0
> 
> 时间：2012-07-05T00:25:44.383
> 
> 标签：ios, plugins, cordova, childbrowser

我刚刚在 iOS 的 Cordova(PhoneGap) 上安装了 childBrowser 插件，它工作正常，但是用于插件导航的图像显示为大分辨率或低分辨率（在 iPhone 3gs、4 和 iPad 2 上）。

想知道是否有人知道纠正此问题的方法？

谢谢！

![大的、低分辨率的图标](../Images/1604abb1c6f8e55c390983d7b8723d8d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T12:06:37.550

Randy McMillan 已更新插件以解决此问题：[https ://github.com/phonegap/phonegap-plugins/commit/b2adead8c70fb0f5ed174b96d5c93a9650a38b6c](https://github.com/phonegap/phonegap-plugins/commit/b2adead8c70fb0f5ed174b96d5c93a9650a38b6c)

# php - Oracle 过程输出参数从 PHP 返回 -1

> ID：11336623
> 
> 赞同：3
> 
> 时间：2012-07-05T00:27:46.663
> 
> 标签：php, oracle, stored-procedures, oracle11g

我正在尝试从我的 PHP 程序中执行 Oracle 程序。我创建了一个简单的测试程序：

```
CREATE OR REPLACE PROCEDURE "JKJ3"."GetUserLogin"
{
    userlogin_in in varchar2,
    userid_out out numeric,
    pass_out out varchar2
}
IS 
BEGIN
    SELECT user_id, password
    INTO userid_out, pass_out
    FROM "JKJ3"."USERS"
    WHERE login = userlogin_in;
END; 
```

我使用 Aqua Data Studio 测试了该过程：

```
DECLARE
    userid_out number;
    password_out number;
BEGIN
    "JKJ3"."GetUserLogin"('UserName', userid_out, password_out);
    dbms_enable(10000);
    dbms_put_line(userid_out);
    dbms_put_line(password_out);
END; 
```

这工作正常，返回用户 ID 和密码值。到现在为止还挺好！

我尝试从 PHP 执行该程序，但我无法让该程序运行以挽救我的生命！PHP代码：

```
PutEnv("ORACLE_HOME=/afs/cad/solaris/oraclient10.2");   
$this->conn=oci_connect($this->ucid, $this->dbpassword, $this->db);

// Check if connection was sucessful.
if ( !$this->conn ) {
    echo "Unable to connect: " . var_dump( OCIError() );
    die("Unable to connect: " . var_dump( OCIError() ));
}

$query = 'BEGIN "JKJ3"."GetUserLogin"(:login_in, :userid_out, :password_out); END;';

// Execute stored procedure to add new user and return the new users ID        
$command = oci_parse($this->conn, $query) or die('Cannot parse query');

$userid;
$password_out;

// bind the input variables and out put variables.
oci_bind_by_name($command, ':login_in', $login, 30) or die('cannot bind login');        
oci_bind_by_name($command, ':userid_out', $userid) or die('cannot bind userid');
oci_bind_by_name($command, ':password_out', $password_out, 300) or die('cannot bind password');              

oci_execute($command);
echo 'userid = ' . $userid . ' password = ' . $password_out;
oci_close($this->conn); 
```

当我执行此操作时，我得到一个 null 的用户 ID 和密码。

**编辑** 我与其他过程有相同的结果，哎呀，我什至创建了一个过程，该过程采用静态值并将其分配给返回变量，但我仍然没有得到任何回报（包括没有错误）。
[http://www.oracle.com/technetwork/articles/fuecks-sps-095636.html（sayHello](http://www.oracle.com/technetwork/articles/fuecks-sps-095636.html)示例）。再一次，该过程在 Aqua Data Studio 中有效，但在 PHP 中无效。不抛出异常，不返回变量。

Oracle 是否有类似 SQL SERVER Profiler 的工具，可以让您查看针对 Oracle 执行的查询？（虽然我没有服务器的管理员权限）。

似乎它不是基于许可的，因为它适用于 ADS。

我可以毫无问题地对数据库运行查询，因此我确信我的连接正常。

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T05:58:33.930

我不熟悉 PHP，但根据 oci_bind_by_name 的[手册](http://www.php.net/manual/en/function.oci-bind-by-name.php)页：

> 使用 OUT 绑定时必须指定 maxlength，以便 PHP 分配足够的内存来保存返回的值。

此外，您的 PL/SQL 块中至少存在一个小语法错误。引用时需要始终使用双引号`GetUserLogin`。（尽管我怀疑这是您的主要问题。如果是，您应该会收到一条错误消息。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T23:25:12.563

在与此作斗争之后，我犯了许多错误（不是总是这样吗？）：

1.  PL/SQL 块中的过程没有引号（并标记了问题的答案）。

    `$query = 'BEGIN "JKJ3"."GetUserLogin"(:login_in, :userid_out, :password_out); END;';`

2.  没有打开错误报告（并查看问题所在）。

`error_reporting(E_ALL); ini_set('display_errors', true);`

1.  没有输出尺寸。

2.  传递了错误的变量，因为我将登录名和密码变量转置了（*羞愧地垂头丧气*）。

# jquery - 这怎么不是咖啡脚本中的功能？

> ID：11336625
> 
> 赞同：0
> 
> 时间：2012-07-05T00:28:37.177
> 
> 标签：jquery, coffeescript

似乎相对简单：

```
_.each words, (val, key) -> $(".word_choice")[key].html val 
```

返回：

```
$(".word_choice")[key].html is not a function
[Break On This Error]   

return $(".word_choice")[key].html(val); 
```

想不通这个。我正在使用这个参考：

[http://autotelicum.github.com/Smooth-CoffeeScript/literate/underscore.html#each](http://autotelicum.github.com/Smooth-CoffeeScript/literate/underscore.html#each)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T00:32:21.707

在 jQuery 对象中通过索引访问元素时，您会得到一个纯 HTML 元素，而不是另一个 jQuery 对象。改用[`.eq`](http://api.jquery.com/eq)：

```
_.each words, (val, key) -> $(".word_choice").eq(key).html val 
```

# java - 使用布局管理器或 null 制作标签

> ID：11336626
> 
> 赞同：1
> 
> 时间：2012-07-05T00:28:58.343
> 
> 标签：java

我必须创建一个用于交付的标签。目前，因为它被推送为需要一个快速的解决方案，我正在创建一个 JFrame 放置所有组件，然后将内容保存为图像并处理框架，使其瞬间闪烁然后消失，准备打印出来。如果我知道标签将始终为 X 乘 Y，将布局管理器设置为 null 并将组件放置在我需要它们的位置会更好，还是使用布局管理器会更好？

我目前正在使用流程布局管理器，并且必须将发送者面板的首选大小设置为大一点，以便它向下移动到下一部分（在条形码下方）。是否有特定的 LayoutManager 对此有好处？

* * *

[![目标布局](../Images/0c4712c0ba8de15a5233b6990a65af68.png)](https://i.stack.imgur.com/AZfD3.png)

**^^^以上是目标布局^^^**

* * *

**vvv 下面是我目前实现的 vvv**

[![当前布局](../Images/312884e5e2e89d26ca12299648a1f617.png)](https://i.stack.imgur.com/Pjj3N.png)

* * *

**^^^ 目前实现的布局^^^**

还有一种简单的方法可以像第一张图片那样画线吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:42:18.963

很多人使用 JasperReports 进行此类工作。制作条码很容易。

图书馆可以在这里下载

[http://sourceforge.net/projects/jasperreports/?source=directory](http://sourceforge.net/projects/jasperreports/?source=directory)

该报告是使用[iReports创建的](http://sourceforge.net/projects/ireport/?source=directory)

您将标签视为您将数据注入其中的报告。

学习曲线可能有点飞跃，但是当你开始使用它时，它是一个非常强大的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T00:41:29.520

我想您应该能够将框架绘制到 BufferedImage 的图形上，而无需在屏幕上实际显示它。简单地打包它以使 id 可显示就足够了。

就是说，我相信你会通过根本不生成 UI 组件，而是直接在图形设备上创建整个图像来最灵活（在字体、分隔线、可能重叠、文本换行或截断等方面） . 显然没有布局管理器。

# javascript - 如何以最简单的方式在 jQuery 中进行调试？

> ID：11336627
> 
> 赞同：3
> 
> 时间：2012-07-05T00:28:59.750
> 
> 标签：javascript, jquery, debugging

例如，如果我使用此代码：`$('#iddoesnotexist').remove();`如果此 id 不在页面中，我将不会收到错误，**如何显示错误？**

默认情况下选择了这种行为，因为否则 jQuery 会定期抛出`NullReference`异常，但这是我正在寻找的......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T00:35:20.163

我想你可以创建自己的 jQuery 扩展。我会*把它写成一个断言：

```
$.fn.mustExist = function() {
    if(!this.length) {
        throw new Error("Collection was empty.");
    }

    return this;
}; 
```

在开发过程中：

```
$('#iddoesnotexist').mustExist().remove(); 
```

[* 实际上，我不会使用 jQuery；`document.getElementById`也保护你免受这种事情`;)`]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:44:16.153

如果您希望此行为成为所有 DOM 选择的默认行为，您可以为该函数创建一个包装`jQuery`函数。

```
var my_$ = function(selector) {
    var result = jQuery.apply(this, arguments);

    if (typeof selector === "string" && !result.length)
        throw new Error("No matches found");

    return result;               
};

my_$("#foobar"); // No matches found 
```

请务必使用您自己的引用，而不是覆盖`jQuery`or`$`标识符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T00:35:22.877

看：

[jQuery 调试](https://stackoverflow.com/questions/9356116/jquery-debugging) 和 [http://jqueryfordesigners.com/debugging-tools/](http://jqueryfordesigners.com/debugging-tools/) 和 [http://www.jquery4u.com/utilities/live-jquery-debugging-firebug/](http://www.jquery4u.com/utilities/live-jquery-debugging-firebug/) 和 [http://samdutton.wordpress.com/2010/09 /16/jquery-debugging-tips/](http://samdutton.wordpress.com/2010/09/16/jquery-debugging-tips/) 和 [http://trainofthoughts.org/blog/2007/03/16/jquery-plugin-debug/](http://trainofthoughts.org/blog/2007/03/16/jquery-plugin-debug/)

用于 jQuery 调试文章。而且，正如评论中提到的，最简单的调试方法是使用`console.log`.

# c# - C# 图像生成器 - 性能缓慢

> ID：11336637
> 
> 赞同：5
> 
> 时间：2012-07-05T00:32:14.367
> 
> 标签：c#, asp.net, performance, image-processing

我最近一直在用 C# 开发一个 aspx 动态图像生成器，它最基本的功能是从“t”中获取一个查询字符串值并将该字符串写入图像，然后返回一个 JPG。

它在本地和测试服务器上完美运行 - 图像立即返回。

但是当在负载平衡的实时服务器上时，有时它可以正常工作。但是通常它会超时/最多需要一分钟才能返回图像。

我想我会在这里询问我的代码中是否有任何明显的东西会导致问题，然后我转向服务器操作员询问为什么这不能正常工作。

下面是一个非常精简的生成器版本（也有完全相同的超时问题）

```
protected void Page_Load(object sender, EventArgs e)
{

    // Set global stage dimensions
    const int stageWidth = 500;
    const int stageHeight = 200;

    // Create Bitmap placeholder for new image       
    Bitmap createdImage = new Bitmap(stageWidth, stageHeight);

    // Draw new blank image
    Graphics imageCanvas = Graphics.FromImage(createdImage);

    // Add text
    if (!string.IsNullOrEmpty(Request.QueryString["t"]))
    {
        string imageText = Uri.UnescapeDataString(Request.QueryString["t"]).Trim();
        Font font = new Font("Arial", 22);
        imageCanvas.DrawString(imageText, font, Brushes.White, 0, 0);            
    }

    // Save
    MemoryStream memStream = new MemoryStream();
    createdImage.Save(memStream, ImageFormat.Jpeg);
    imageCanvas.Dispose();
    createdImage.Dispose();

    // Set filename / image format
    Response.AppendHeader("content-disposition", "filename=MyImage");
    Response.ContentType = "image/jpeg";        

    // Send output to client
    memStream.WriteTo(Response.OutputStream);
    memStream.Dispose();
    Response.Flush();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T19:17:36.373

有一些事情我会改变：

*   使用关键字包围流`using`。
*   请改用 ashx 处理程序。好像您正在使用 aspx 文件。对于这种情况，最好使用 http 处理程序，因为它的生命周期更短。我已经多次使用它来提供图像的缩略图。
*   使用一些缓存。或许你可以利用asp.net的缓存特性，你可以找出t是否有重复值，这样你就可以将生成的图像存储在缓存中，避免每次都写入和创建一些steam
*   最后但同样重要的是，尝试检查服务器是否有最新的 sp 和更新。在某些情况下，如果缺少某些更新，应用程序会表现得很奇怪，

它也可以与网络场本身相关联。您可以查看服务器的性能计数器以查看是否报告了一些异常情况。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T19:59:59.083

您可以通过直接保存到输出流而不是使用内存流来节省一些内存并可能获得性能：

```
createdImage.Save(Response.OutputStream, ImageFormat.Jpeg); 
```

另一个问题可能是您的代码位于 .aspx 页面中。它可能会经常重新编译。我会建议一个http处理程序：

```
public class MyHttpHandler : IHttpHandler
{
   public void ProcessRequest(HttpContext context)
   {
      // prepare image like you did
      memStream.WriteTo(context.Response.OutputStream);
   }

   // Override the IsReusable property.
   public bool IsReusable
   {
      get { return true; }
   }
} 
```

# vtiger - vTiger 最好的方法是什么，自定义联系人或开发新模块？

> ID：11336639
> 
> 赞同：0
> 
> 时间：2012-07-05T00:32:22.853
> 
> 标签：vtiger

我正在寻找可以给我一些关于我的 vTigerCRM 实施中的最佳方法的提示的人。

我查看了联系人模块，那里存在的大多数字段都不符合我的需求。我知道我可以创建自定义字段，但自定义字段的数量将大于 30 个字段。

一些现有的领域，我想改变它的使用方式。例如：在我们的场景中，联系人姓名将只有 1 个字段。该模块有 2 个字段：名字和姓氏。

我找不到禁用“名字”字段的方法。

联系人模块上的一些现有字段将使用某些语言文件进行更改（重命名标签），尽管这适用于用户视角，但在我的开发人员视角中听起来不合适。

我也担心 vTiger 版本的演变。如果我更改/自定义联系人模块，我认为在将 vTiger 更新/迁移到较新版本时会遇到问题。

新实体将具有 Contacts 实际具有的大部分关系，即活动（监控发送的邮件、传入呼叫、传出呼叫）、潜在客户转换、机会等。

我真的很担心该走哪条路。如果有人可以对此发表评论，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:24:37.923

我正在为 vTiger 的实施工作 3 个月，我要告诉你的第一件事是尽可能使用现有的模块。

您可以通过更改 uitype 来修改 vtiger_field 中需要自定义的字段类型。大多数情况下，这很容易，例如，如果您需要将文本字段更改为选项列表，则在 vtiger 论坛上有一些帮助。然后您可以通过更改 displaytype = 0 来隐藏不需要的字段，再次在 vtiger_field 中。

我从 5.3 迁移到 5.4，在此过程中您提供了旧数据库，因此保存了此类更改。我不能告诉你 php 代码的变化。

希望能帮助到你

# google-maps - D7 - 是否有检测用户位置的模块？

> ID：11336640
> 
> 赞同：0
> 
> 时间：2012-07-05T00:32:24.047
> 
> 标签：google-maps, drupal, drupal-7, location, drupal-modules

是否有贡献/核心模块来检测用户的物理位置（可能是基于IP的？）。

我最终要做的是： 1\. 检测用户位置 2\. 计算从用户当前位置到附加到节点的位置数据的距离（我的节点有位置数据） 3\. 根据距离过滤结果（即显示选择性节点）

任何方向都会有所帮助。

我正在使用D7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T10:52:21.120

有两个模块（据我所知）为 Drupal 7 提供 IP - 位置检测：

*   [IP2国家](http://drupal.org/project/ip2country)
*   [主机](http://drupal.org/project/hostip)

我认为[Location 模块](http://drupal.org/project/location)将是您之后的下一站：

> 目前，它是唯一提供实现基于位置的搜索所需的视图集成的模块，旨在在用户提供的位置附近的地图上查找点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T11:17:31.883

[1-您可以使用 jQuery 和这个很棒](http://www.geoplugin.net/javascript.gp)的脚本检索使用位置。

使用示例：

```
jQuery.getScript('http://www.geoplugin.net/javascript.gp', function()
{
    $('#results').html("Your location is: " + geoplugin_countryName() + ",
    " + geoplugin_region() + ", " + geoplugin_city());
}); 
```

2-您可以计算用户位置与知道每个位置纬度和经度的另一个位置之间的距离。

例子：

```
jQuery.getScript('http://www.geoplugin.net/javascript.gp', function()
{
    var source_longitude = 30.049999;
    var source_latitude = 31.250000;
    var user_longitude = geoplugin_longitude();
    var user_latitude = geoplugin_latitude();
    var earth_radius = 6371; // in Kilo Meters

    var dLat = (source_latitude - user_latitude).toRad();
    var dLon = (source_longitude - user_longitude).toRad();

    source_latitude = source_latitude.toRad();
    user_latitude = user_latitude.toRad();

    var x = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(source_latitude ) * Math.cos(user_latitude ); 
    var y = 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x));

    var distance = earth_radius * y;
}); 
```

3-要过滤结果，您可以使用距离和[hook_node_access](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_node_access/7)（）根据距离更改节点查看权限。

希望这会有所帮助……穆罕默德。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T07:48:37.967

[Smart IP 模块](http://drupal.org/project/smart_ip)会将用户的IP 地址转换为经纬度坐标。以下函数将返回两对坐标之间的球面距离（以英里为单位）。

```
function _get_spherical_distance($s_pd, $s_ld, $f_pd, $f_ld) {
  $s_pr = deg2rad($s_pd);
  $f_pr = deg2rad($f_pd);
  $lr = deg2rad($s_ld - $f_ld);

  return 3960 * acos(sin($s_pr) * sin($f_pr) + cos($s_pr) * cos($f_pr) * cos($lr));
} 
```

例如，乔治亚州亚特兰大 (33.7489, -84.3879) 到华盛顿州雷德蒙德 (47.6739, -122.1214)：

```
print _get_spherical_distance(33.7489, -84.3879, 47.6739, -122.1214); 
```

输出：

> 2170.4293537864

那是2,170英里。如果您需要将地址转换为经纬度坐标，您可以使用[Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/v2/)。

```
$address_string = "1600 Pennsylvania Avenue, Washington, DC 20500";
$geo_html = file_get_contents('http://maps.google.com/maps/geo?sensor=false&oe=utf8&output=csv&q='. urlencode($address_string));

print_r($geo_html); 
```

输出：

> 200,8,38.8987149,-77.0376555

这是一个逗号分隔的四个值的字符串。第一个是[HTTP 状态码](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)。您应该看到 200。第二个值是转换[精度](https://developers.google.com/maps/documentation/geocoding/v2/#GeocodingAccuracy)的近似值。如果您要根据用户与地址的距离来过滤内容，您可能需要至少 6 的准确度值。第三个和第四个值显然是纬度和经度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-31T22:09:12.417

您正在寻找的模块是 IP 地理定位视图[https://drupal.org/project/ip_geoloc](https://drupal.org/project/ip_geoloc) 您可能还想查看这个问题和答案：[https ://drupal.stackexchange.com/questions/54873/geofield-proximity -in-views](https://drupal.stackexchange.com/questions/54873/geofield-proximity-in-views)

# android - 从嵌入网站的地图中读取信息

> ID：11336645
> 
> 赞同：0
> 
> 时间：2012-07-05T00:34:43.287
> 
> 标签：android, google-maps

我的大学公交系统在其网站（使用谷歌地图）上有公交车当前位置的实时视图，我希望能够从该网站获取该信息，以便我可以将其显示在移动应用程序上（在Android 平台，特别是）。有没有办法做到这一点，如果有，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:40:18.900

是的，可以这样做。您将需要了解地图叠加层。

请参阅：http: [//developer.android.com/guide/topics/location/index.html](http://developer.android.com/guide/topics/location/index.html)

# mysql - 向已经很庞大的查询添加子查询

> ID：11336651
> 
> 赞同：0
> 
> 时间：2012-07-05T00:35:42.443
> 
> 标签：mysql, relational-database, relational

这个问题是我一个月前提出的[这个问题](https://stackoverflow.com/questions/11006025/complex-if-statement-with-3-tables)的后续。

这是我的三张桌子。

战士

```
fighter_id |  name
-----------------------
1          | John
2          | Steve
3          | Bill
4          | Bobby 
```

活动

```
event_id  |  event_name  |  event_date
-------------------------------------------
1          | MMA         |  01/01/2010
2          | Cool        |  02/20/2010
3          | Yeaa!       |  04/15/2010 
```

打架

```
fight_id  |  fighter_a  |  fighter_b  |  winner  |  method  |  event
-----------------------------------------------------------------------
1         | 1           |  2          |  1       | Sub      | 1
2         | 4           |  1          |  4       | KO       | 2
3         | 1           |  3          |  NULL    | Draw     | 3 
```

所以这些是当前的结果（还有很多其他列，但它们与问题无关）

```
result  |  opponent  |  method  |  event  |  date        
----------------------------------------------------------
Draw    | Bill       |  Draw    |  Yeaa!  |  04/15/2010  
Loss    | Bobby      |  KO      |  Cool   |  02/20/2010 
Win     | Steve      |  Sub     |  MMA    |  01/01/2010 
```

我想要两个额外的列。一个是拳手的记录，一个是他的对手的记录，两者都基于事件的日期。所以记录到那个日期，包括那个日期，但不要超过那个日期。基本上 <= 到当前行的日期。

期望的结果

```
result  | record   |  opponent  | opp. record |  method  | event  |  date        
-----------------------------------------------------------------------------
Draw    | 1-1-1    | Bill       |  0-0-1      |  Draw    | Yeaa!  |  04/15/2010  
Loss    | 1-1      | Bobby      |  1-0        |  KO      | Cool   |  02/20/2010 
Win     | 1-0      | Steve      |  0-1        |  Sub     | MMA    |  01/01/2010 
```

所以这是获取当前结果的代码：

```
SELECT
    (
        CASE
            WHEN a.winner = a.f_a THEN "Win"
            WHEN a.winner = a.f_b THEN "Loss"
            WHEN a.winner IS NULL THEN a.method
        END
    ) AS result,
    b.name AS opponent,
    b.fighter_id AS opponent_id,
    b.fighting_out_of_country AS opponent_country,
    a.method AS method,
    a.method_type AS method_type,
    a.round AS round,
    a.time AS time,
    c.event_id AS event_id,
    c.event_name AS event,
    c.event_date AS date,
    c.event_city AS event_city,
    c.event_state AS event_state,
    c.event_country AS event_country
FROM
    (
        SELECT 
            IF(fighter_b = :fighter_id_0, fighter_b, fighter_a) AS f_a,
            IF(fighter_b = :fighter_id_1, fighter_a, fighter_b) AS f_b,
            winner,
            method,
            method_type,
            round,
            time,
            event
        FROM 
            fights
        WHERE
            :fighter_id_2 IN (fighter_a, fighter_b)
    ) a
INNER JOIN
    fighters b ON a.f_b = b.fighter_id
INNER JOIN
    events c ON a.event = c.event_id
ORDER BY
    c.event_date DESC 
```

这是我用来获取一名战士记录的查询，但我不确定如何将它集成到这个主要查询中以获取战士和他的对手的记录。当然，我最终得到了 4 个值，因此我可以稍后使用 PHP 和 HTML/CSS 操作它们。（赢/输/平局/no_contests）

```
SELECT 
SUM(if(winner = :fighter_id_3, 1, 0)) AS wins,
SUM(if(winner <> :fighter_id_4, 1, 0)) AS losses,
SUM(if(method = "Draw", 1, 0)) AS draws,
SUM(if(method = "No Contest", 1, 0)) AS no_contests

FROM fights
WHERE :fighter_id_5 IN (fighter_a, fighter_b) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:25:36.767

试试这个：

```
SELECT
    (
        CASE
            WHEN a.winner = a.f_a THEN "Win"
            WHEN a.winner = a.f_b THEN "Loss"
            WHEN a.winner IS NULL THEN a.method
        END
    ) AS result,
    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner <=> a.f_a) AS fighter_wincount,
    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner <> a.f_a) AS fighter_losscount,
    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = 'Draw') AS fighter_drawcount,
    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = 'No Contest') AS fighter_nocontestcount,
    b.name AS opponent,
    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner <=> a.f_b) AS opponent_wincount,
    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner <> a.f_b) AS opponent_losscount,
    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = 'Draw') AS opponent_drawcount,
    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = 'No Contest') AS opponent_nocontestcount,
    b.fighter_id AS opponent_id,
    b.fighting_out_of_country AS opponent_country,
    a.method AS method,
    a.method_type AS method_type,
    a.round AS round,
    a.time AS time,
    c.event_id AS event_id,
    c.event_name AS event,
    c.event_date AS date,
    c.event_city AS event_city,
    c.event_state AS event_state,
    c.event_country AS event_country
FROM
    (
        SELECT 
            fight_id,
            IF(fighter_b = :fighter_id, fighter_b, fighter_a) AS f_a,
            IF(fighter_b = :fighter_id, fighter_a, fighter_b) AS f_b,
            winner,
            method,
            method_type,
            round,
            time,
            event
        FROM 
            fights
        WHERE
            :fighter_id IN (fighter_a, fighter_b)
    ) a
INNER JOIN
    fighters b ON a.f_b = b.fighter_id
INNER JOIN
    events c ON a.event = c.event_id
LEFT JOIN
    (
        SELECT 
            a.fighter_a,
            a.fighter_b,
            a.winner,
            a.method,
            b.event_date
        FROM
            fights a
        INNER JOIN
            events b ON a.event = b.event_id
    ) d ON 
        (a.f_a IN (d.fighter_a, d.fighter_b) OR a.f_b IN (d.fighter_a, d.fighter_b)) AND
        d.event_date < c.event_date
GROUP BY
    a.fight_id
ORDER BY
    c.event_date DESC 
```

# google-maps - 实时定位

> ID：11336655
> 
> 赞同：1
> 
> 时间：2012-07-05T00:36:12.417
> 
> 标签：google-maps, google-maps-api-3, location, mapkit, real-time

我正在开发一个应用程序，我需要应用程序内的地图显示拥有此应用程序的人，您还应该看到该人的实时移动，例如Apple“查找我的iPhone”或“myTaxi”的应用程序查看在哪里所有在地图上实时运行的出租车。为此，我使用 MapKit 或谷歌地图？（我认为google maps api for javascript）但我不知道我要去哪里，我会开始一个

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:57:48.857

你的想法会是这样的： ![在此处输入图像描述](../Images/1ac46be1e19b7755e74366db469650c0.png)

以下是我自己制作的一些示例：

希望对你有帮助

# php - preg_match() 没有找到结束分隔符

> ID：11336658
> 
> 赞同：0
> 
> 时间：2012-07-05T00:37:26.043
> 
> 标签：php, preg-match

我已经阅读[了这个](https://stackoverflow.com/questions/9689825/warning-preg-match-function-preg-match-no-ending-delimiter-found)和[这个](https://stackoverflow.com/questions/6445133/no-ending-delimiter-found-error)，[这个](http://www.php.net/preg_match)，以及关于 SO 的六个其他问题`preg_match`，但我仍然无法弄清楚这个。

我从 CodeReview 问题中使用[此](https://codereview.stackexchange.com/questions/6077/browser-and-os-detection-script)代码并收到错误消息，指出`preg_match()`没有找到分隔符“/”。

有人可以帮我解决吗？有问题的代码是以下语句：

```
if (preg_match($regex, $user_agent)) { 
```

您可以通过转到问题本身中新的、已编辑的代码版本的底部并计算大约 12 行（不包括空白行）来找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:45:27.660

查看 Code Review 上发布的代码，在 $os_array 中有以下行：

```
'/win16'                =>  'Windows 3.11', 
```

它缺少该`/i`行正则表达式末尾的 ，这可能导致您的错误。上面的行也缺少，`i`但这不会破坏任何东西。

正如 paxdiablo 建议的那样，在循环中打印我们的`$regex`变量应该很快就发现了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:40:59.577

这是调试 101 的东西。在以下内容之后立即插入语句：

```
foreach ($browser_array as $regex => $value) { 
```

打印出 和 的当前`$regex`值`$value`。

这应该（希望）向您展示它在抱怨什么。

这也应该对早期的数组扫描进行，您会在其中找到错误的`'/win16'`，正如 JohnC 所拾取的。

# c# - Razor 动态查询和 WebCache

> ID：11336659
> 
> 赞同：1
> 
> 时间：2012-07-05T00:37:45.673
> 
> 标签：c#, caching, dynamic, razor, webmatrix

我在 Razor 视图中创建了以下代码。

```
var Db= Database.Open("db");
var results = from t in Db.Query("up_rpt_hourlysales_today")
  group t by t["Channel"]; 
```

我正在使用带有以下代码的数据...

```
@foreach (var c in results ){ 
    var htmlKey = Server.UrlEncode(c.Key);
  <p><a href="@htmlKey" data-role="button">@c.Key</a></p>
} 
```

我想使用 WebCache，所以我添加了以下代码。

```
var cacheItemKey = "Sales"; 
var cacheHit = true; 
var results = WebCache.Get(cacheItemKey); 

if (results == null) { 
    cacheHit = false; 
} 

if (cacheHit == false) { 
    var Db= Database.Open("db");
    results = from t in Db.Query("up_rpt_hourlysales_today")
                    group t by t["Channel"];

    WebCache.Set(cacheItemKey,results, 5,false);
} 
```

缓存代码运行良好，但在对结果进行交互时，在尝试访问项目的动态属性时出现错误。

*“对象”不包含“键”的定义*

我认为这是因为初始返回结果类型为 Null，并且当我使用 LINQ 查询将结果设置为动态类型时，动态类型未更新。

除了设置*结果*类型之外，还有其他方法吗？

谢谢

布伦特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T05:22:34.240

WebMatrix.Data 建立在.net的[动态特性之上。](http://msdn.microsoft.com/en-us/library/dd264741.aspx)在您的第一个示例中，该`Db.Query`方法返回一个动态对象的集合，这就是为什么在您的循环`c.Key`中将动态解析并工作的原因。

但是，当您将结果放入时，`WebCache`它`results`会将`object`. 所以当你写

`var results = WebCache.Get(cacheItemKey);`

的静态类型`results`将是`object`，但运行时类型仍将是原始集合，这就是为什么`foreach`仍然有效，但`c.Key`调用将失败，因为不涉及动态调度。

要启用/强制动态调度声明`results`为`dynamic`或`dynamic`在您的 foarch 中使用：

```
@foreach (dynamic c in results ){ 
    var htmlKey = Server.UrlEncode(c.Key);
  <p><a href="@htmlKey" data-role="button">@c.Key</a></p>
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T06:30:41.020

您的`Database.Query`方法调用的结果是一个`IEnumerable<IGrouping>object, object>>`序列（因为 group by 操作），其中的每个元素都有一个`Key`属性。WebCache 是`object`类型的集合，就像 Session 等一样，它们没有`Key`属性，因此您需要将项目转换回其原始类型：

```
var cacheItemKey = "Sales"; 
var cacheHit = true; 
var results = (IEnumerable<IGrouping<object, object>>)WebCache.Get(cacheItemKey); 

if (results == null) { 
    cacheHit = false; 
} 

if (cacheHit == false) { 
    var Db= Database.Open("db");
    results = Db.Query("up_rpt_hourlysales_today").GroupBy(t => t.Channel);
    WebCache.Set(cacheItemKey,results, 5,false);
} 
```

# ruby-on-rails - 如何使用新应用创建 3 个默认对象？

> ID：11336660
> 
> 赞同：0
> 
> 时间：2012-07-05T00:37:54.800
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我不确定这是否是正确的方法，但在开发过程中我经常做 rake db:drop 和 rake db:migrate 从头开始​​重建我的数据库（所以我没有 100000 个迁移文件）

我想知道如何创建 3 个默认对象（我的应用程序的 3 个类别对象）。也是管理员用户，所以我不需要每次都通过 Rails 控制台添加它们。当我将它部署到生产环境时，如果让它更流畅就好了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T01:08:52.350

您正在寻找的是`rake db:seed`. 在 db 目录中有一个名为`seeds.rb`. 您可以根据需要使用尽可能多的代码填充此文件，以使用您想要的任何内容来创建和填充数据库。Ryan Bates 的 Railscasts，[第 179 集](http://railscasts.com/episodes/179-seed-data/)非常详细地介绍了这个主题。

附带说明一下，我经常发现创建 bash 别名很有用，因此我不必每次都通过所有三个命令。在您的 bash 个人资料中，只需添加：

```
alias migrate='rake db:drop && rake db:migrate && rake db:seed' 
```

然后在您的终端中，您只需键入`migrate`即可恢复并运行。

# c# - WPF 纯代码应用程序给出“未将对象引用设置为对象的实例。”

> ID：11336661
> 
> 赞同：0
> 
> 时间：2012-07-05T00:37:54.923
> 
> 标签：c#, wpf

我正在尝试创建一个纯代码 WPF 应用程序，但是当我在文本框中键入时出现上述错误。这是虽然我的所有变量都已初始化。

windows1.xaml 是这样的：

```
<?xml version="1.0" encoding="utf-8"?>

<Window>

    x:Class="BlendCatalogue.Window1" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="BlendCatalogue"
    Height="300"
    Width="300">
</Window> 
```

后面的代码是这样的：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;

namespace BlendCatalogue
{

    public partial class Window1 : Window
    {
            private TextBlock textBlock;
            private TextBox textBox;

        public Window1()
        {
            InitializeComponent();
            Initialization();
        }

        public void Initialization()
        {

            this.Width=300;
            this.Height=200;
            this.Background =Brushes.Aquamarine;
            this.Title = "Only the best!";

            Grid layoutGrid = new Grid();
            StackPanel stackpanel = new StackPanel();
            layoutGrid.Children.Add(stackpanel);
            this.AddChild(layoutGrid);

            TextBlock textBlock = new TextBlock();
            textBlock.Margin = new Thickness(6);
            textBlock.Height = 20;
            textBlock.TextAlignment = TextAlignment.Center;
            textBlock.Text = "Hello my World!";
            stackpanel.Children.Add(textBlock);

            TextBox textBox = new TextBox();
            textBox.Margin = new Thickness(5);
            textBox.Width = 150;
            textBox.TextAlignment = TextAlignment.Center;
            textBox.Text = "";
            textBox.TextChanged += OnTextChanged;
            stackpanel.Children.Add(textBox);

            Button btnColor = new Button();
            btnColor.Margin = new Thickness(5);
            btnColor.Width = 150;
            btnColor.Content = "Change Text Color";
            btnColor.Click += btnChangeColor_Click;
            stackpanel.Children.Add(btnColor);

            Button btnSize = new Button();
            btnSize.Margin = new Thickness(5);
            btnSize.Width = 150;
            btnSize.Content = "Change Text Color";
            btnSize.Click += btnChangeSize_Click;
            stackpanel.Children.Add(btnSize);
        }

        private void OnTextChanged(object sender, TextChangedEventArgs e)
        {

            textBlock.Text = textBox.Text;
        }

        private void btnChangeColor_Click(object sender, RoutedEventArgs e)
        {
            if (textBlock.Foreground == Brushes.Black)
                textBlock.Foreground = Brushes.Red;
            else
                textBlock.Foreground = Brushes.Black;
        }
        private void btnChangeSize_Click(object sender, RoutedEventArgs e)
        {
            if (textBlock.FontSize == 11)
                textBlock.FontSize = 42;
            else
                textBlock.FontSize = 11;
        }

    }
} 
```

这个新手根本不知道做错了什么，非常感谢任何帮助。谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:43:34.967

您两次声明一些变量：

```
private TextBlock textBlock;
private TextBox textBox;

TextBlock textBlock = new TextBlock();
TextBox textBox = new TextBox(); 
```

您初始化那些作用域`Initialize()`但访问事件处理程序中的类级别变量的变量。

改变

```
TextBlock textBlock = new TextBlock();
TextBox textBox = new TextBox(); 
```

到

```
textBlock = new TextBlock();
textBox = new TextBox(); 
```

请注意，您应该已经收到编译器警告，例如

> 警告 CS0649：字段“BlendCatalogue.Window1.textBlock”从未分配给，并且始终具有其默认值 null

编译器试图帮助你...... :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:52:59.280

您正在创建两个`TextBlock's`和两个，`TextBox's`一个具有模块级别范围，一个具有本地范围。然后，您使用 Local 范围初始化一个，并尝试使用具有模块级别范围的那个，从而导致您的错误。

尝试将初始化方法中的代码更改为：

```
textBlock = new TextBlock();
textBlock.Margin = new Thickness(6);
textBlock.Height = 20;
textBlock.TextAlignment = TextAlignment.Center;
textBlock.Text = "Hello my World!";
stackpanel.Children.Add(textBlock);

textBox = new TextBox();
textBox.Margin = new Thickness(5);
textBox.Width = 150;
textBox.TextAlignment = TextAlignment.Center;
textBox.Text = "";
textBox.TextChanged += OnTextChanged;
stackpanel.Children.Add(textBox); 
```

# javascript - 如何使浏览器显示“另存为对话框”，以便用户可以将字符串的内容保存到系统上的文件中？

> ID：11336663
> 
> 赞同：69
> 
> 时间：2012-07-05T00:38:07.380
> 
> 标签：javascript, save, savefiledialog

如何使浏览器显示“另存为对话框”，以便用户可以将字符串的内容保存到他系统上的文件中？

例如：

```
var myString = "my string with some stuff";
save_to_filesystem(myString,"myString.txt"); 
```

导致这样的事情：

![例子](../Images/fad7b64553bf86ec397a023bfc487b48.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-03-20T10:54:46.407

万一有人还在想...

我是这样做的：

```
<a href="data:application/xml;charset=utf-8,your code here" download="filename.html">Save</a> 
```

不记得我的来源，但它使用以下技术\功能：

1.  html5下载属性
2.  数据 URI

找到参考：

[http://paxcel.net/blog/savedownload-file-using-html5-javascript-the-download-attribute-2/](http://paxcel.net/blog/savedownload-file-using-html5-javascript-the-download-attribute-2/)

* * *

编辑：正如您可以从评论中收集的那样，这**不起作用**

1.  Internet Explorer（但适用于 Edge v13 及更高版本）
2.  歌剧迷你

[http://caniuse.com/#feat=download](http://caniuse.com/#feat=download)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2020-05-01T13:03:31.600

有一个名为[Native File System API](https://wicg.github.io/native-file-system/)的新规范允许您像这样正确地执行[此](https://wicg.github.io/native-file-system/#api-choosefilesystementries)操作：

```
const result = await window.chooseFileSystemEntries({ type: "save-file" }); 
```

[这里](https://googlechromelabs.github.io/text-editor/)有一个演示，但我相信它正在使用原始试用版，因此它可能无法在您自己的网站上运行，除非您注册或启用配置标志，而且它显然[只能在 Chrome 中运行](https://caniuse.com/#search=native%20file)。如果你正在制作一个 Electron 应用程序，这可能是一个选择。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-04-15T13:00:16.550

有一个 javascript 库，请参阅[Github 上的 FileSaver.js](https://github.com/eligrey/FileSaver.js)

但是该`saveAs()`函数不会将纯字符串发送到浏览器，您需要将其转换为`blob`：

```
function data2blob(data, isBase64) {
  var chars = "";

  if (isBase64)
    chars = atob(data);
  else
    chars = data;

  var bytes = new Array(chars.length);
  for (var i = 0; i < chars.length; i++) {
    bytes[i] = chars.charCodeAt(i);
  }

  var blob = new Blob([new Uint8Array(bytes)]);
  return blob;
} 
```

然后调用`saveAs`blob，如下所示：

```
var myString = "my string with some stuff";
saveAs( data2blob(myString), "myString.txt" ); 
```

当然记得在你的网页上使用上面提到的 javascript 库`<script src=FileSaver.js>`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-05-28T13:17:25.260

这可以使用 HTML5`saveAs`函数的跨浏览器 javascript 实现：[https ://github.com/koffsyrup/FileSaver.js](https://github.com/koffsyrup/FileSaver.js)

如果您只想保存文本，那么上述脚本适用于所有浏览器（包括所有版本的 IE），只使用 JS。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-10-14T00:49:49.250

仅使用 javascript 的解决方案

```
function saveFile(fileName,urlFile){
    let a = document.createElement("a");
    a.style = "display: none";
    document.body.appendChild(a);
    a.href = urlFile;
    a.download = fileName;
    a.click();
    window.URL.revokeObjectURL(url);
    a.remove();
}

let textData = `El contenido del archivo
que sera descargado`;
let blobData = new Blob([textData], {type: "text/plain"});
let url = window.URL.createObjectURL(blobData);
//let url = "pathExample/localFile.png"; // LocalFileDownload
saveFile('archivo.txt',url); 
```

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2015-04-01T22:24:35.590

使用执行命令：

```
<input type="button" name="save" value="Save" onclick="javascript:document.execCommand('SaveAs','true','your_file.txt')"> 
```

在下一个链接中： [execCommand](https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand)

# cocoa - Cocoa：访问事件队列？

> ID：11336670
> 
> 赞同：0
> 
> 时间：2012-07-05T00:39:20.660
> 
> 标签：cocoa, event-handling, dock, nsmenu

我有一个应用程序在单击停靠图标 ( `- (BOOL)applicationShouldHandleReopen:(NSApplication *)theApplication hasVisibleWindows:(BOOL)flag`)时会打开一个菜单

菜单“停止”当前线程的执行，直到它关闭。因此，我只接到`applicationShouldHandleReopen:`菜单关闭后的电话。

我认为使用计时器可以检查队列中是否存在此类方法调用。但这可能吗？还是有其他方法可以解决我的问题？（我想在第二次单击停靠图标时关闭我的菜单）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:36:01.880

我发现我的问题的解决方案：

我使用这段代码[使用 Cocoa 的 Accessibility API](https://stackoverflow.com/questions/6684278/getting-the-position-of-my-applications-dock-icon-using-cocoas-accessibility-a)获取我的应用程序的停靠图标的位置来访问我的停靠图标的位置和大小。

`+ (id)addGlobalMonitorForEventsMatchingMask:(NSEventMask)mask handler:(void (^)(NSEvent*))block`然后使用带有掩码的 NSEvent `NSLeftMouseUp`，我设法捕捉到屏幕上的每一次点击

最后，我只需要检查我的点击是否与我的 dockIcon 的 CGRect 一起。（我不得不骗一点，因为菜单被关闭后，`applicationShouldHandleReopen:`因为我点击它而被调用）

# django - 来自 Apache 上 Django 应用程序的 POST/GET 请求的日志

> ID：11336672
> 
> 赞同：2
> 
> 时间：2012-07-05T00:39:30.307
> 
> 标签：django, apache, apache2, django-dev-server

Django 开发服务器非常好，它实时显示所有 POST/GET 请求以及其他事件的日志。来自 Django 开发服务器的日志示例：

```
[04/Jul/2012 19:23:27] "GET /static/images/sprites/submit_url_hover.png HTTP/1.1" 200 7088
[04/Jul/2012 19:23:42] "POST /validate_link HTTP/1.1" 200 0
[04/Jul/2012 19:23:44] "POST /download_link HTTP/1.1" 200 0 
```

它对于调试、找出 500 个错误的来源等非常有用。我最近在 Apache 上部署了我的 Django 应用程序，并在 Apache 上寻找类似于 Django Dev Server 的日志。显然有 Apache 错误日志（片段如下）：

```
[Wed Jul 04 18:37:45 2012] [error] [u'microsoft', u'design', u'logos']
[Wed Jul 04 23:51:01 2012] [error] [client 140.180.6.212] File does not exist: /srv/my_project/app/portnoy/site_media/favicon.ico 
```

但这不是我想要的。我的网站有一个简单的链接提交功能，可以在本地工作（在 Django 开发服务器上），但不能在实际网站上工作（运行 Apache）。因此，在 Apache 上查看 Django 开发服务器样式日志将非常有帮助。知道我可以在哪里看吗？提前致谢，第四次快乐！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T04:40:44.833

检查 apache 的 access.log，您将在其中看到处理的每个请求和发送的响应。

另外，如果您还没有尝试过，`DEBUG=True`请在设置文件中进行设置，以便 django 向您显示详细的错误、跟踪和其他有用信息。

# ruby-on-rails - 当我只想更新关联时，ActiveScaffold 更新显示关联的记录字段

> ID：11336685
> 
> 赞同：1
> 
> 时间：2012-07-05T00:42:39.303
> 
> 标签：ruby-on-rails, activescaffold

在我的应用程序的管理界面中，我使用 ActiveScaffold 来轻松编辑记录：

```
class Admin::InspectionsController < ApplicationController
  require_role :staff
  protect_from_forgery :only => [:create, :update, :destroy]

  active_scaffold :inspections do |config|
    [:create, :delete].each {|a| config.actions.exclude a}
    config.actions.exclude :nested

    config.update.columns = [ :name, :activity_status, :inspector, :report, :note, :time_window, :inspection_type ]
  end
end 
```

在这种情况下，`:activity_status`和`:inspector`是关联列，指的是关联对象。在我的脚手架中，我希望编辑器能够更改外键指向的对象，但上面的配置显示了这一点：

![当前暂存视图](../Images/1ef4f8ebc75782989269b35f3c808466.png)

我只想更新检查器*本身*，而不是它的字段！

将列更改为`:inspector_id`仅允许直接编辑 ID 本身。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:02:08.623

# haskell - 我可以将模式传递给函数吗？

> ID：11336687
> 
> 赞同：12
> 
> 时间：2012-07-05T00:42:56.447
> 
> 标签：haskell

我想要一个像下面这样的功能，这可能吗？事实上，我不知道 Pattern 类型是否存在。

```
fun1 a :: Pattern a -> a -> Bool
fun1 pattern a = case a of
    pattern -> True
    _ -> False 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-05T01:20:34.340

我认为这在 Haskell 中是不可能的。

但是，在您的情况下，模式实际上只是 type 的函数`a -> Bool`。因此，不要接受模式，而是接受来自`a`to的任何函数`Bool`。您的示例等效于`a -> Bool`在`a`.

现在，如果您想做一些更通用的事情，例如能够使用 的主体中的模式中的匹配符号`fun1`，您将无法使用函数来做到这一点。然而，我怀疑这对 Haskell 来说是不可能的——它需要对类型系统进行奇怪的扩展才能有意义。Haskell 中的模式匹配根本不是一等公民，所以你不能真正像那样传递模式。

如果您想要这种行为，请查看[*Pattern Calculus*](https://rads.stackoverflow.com/amzn/click/com/3540891846)一书，作者在其中开发和形式化了一种具有比 Haskell 更通用的模式匹配特性的语言。与 Haskell 不同，它使模式成为一等公民。我还没有真正完成这本书，但我很确定这样的代码正是你能够编写的，除此之外。

作者围绕他关于模式匹配的想法构建了一种语言，称为[bondi](http://bondi.it.uts.edu.au/)；它可能也值得一试，特别是如果您不想打扰这本书。我不知道它是否准备好实际使用，但它肯定很有趣。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-05T04:37:42.460

查看 Functional Pearl，[Type Safe Pattern Combinators](http://www.itu.dk/people/mir/typesafepatterns.pdf)。一些谷歌搜索表明还有一个基于它的[Hackage 包。](http://hackage.haskell.org/package/first-class-patterns/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T00:10:04.720

我很确定您正在寻找**View Patterns**。

（参见[trac/ghc/wiki](http://hackage.haskell.org/trac/ghc/wiki/ViewPatterns)或[ghc/user-manual/syntax-extensions](http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#view-patterns)）

* * *

每个函数都是一个“模式”：

```
case "string that ends with x" of
    (last->'x') -> True
    _ -> False

case "foo" of
    (elemIndex 'g'->Just i) -> i+5
    (elemIndex 'f'->Nothing) -> 23
    _ -> 42

do
  x <- fmap foo bar
=
do
  (foo->x) <- bar 
```

# jquery - jQuery.inArray 坏了吗？

> ID：11336688
> 
> 赞同：2
> 
> 时间：2012-07-05T00:43:11.940
> 
> 标签：jquery

这就是我使用 Xubuntu、Google Chrome 18.0.1025.162 和 Firefox 13.0.1 得到的。[在这里](http://jsfiddle.net/g4u3D/16/)拉小提琴。

![在此处输入图像描述](../Images/a5460c90aa8d33bfd3fb1abc39593a32.png)

是 jQuery.inArray 坏了还是我犯了一个愚蠢的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:44:42.860

jQuery 方法返回一个索引，`inArray()`就像`indexOf()`.

如果您`if`将 jQuery API 测试更改为与另一个测试相同，它们匹配。

所以，**不**，它没有坏:-)

# slider - Jquery幻灯片建议

> ID：11336690
> 
> 赞同：0
> 
> 时间：2012-07-05T00:43:26.817
> 
> 标签：slider, slideshow

任何建议我在哪里可以找到具有这些条件的 jquery 插件：

*   从缩略图中弹出图像的画廊/幻灯片
*   图库将具有下一个/上一个按钮、自动播放按钮、标题和编号的图像标记。

我发现有一些但不是全部的好插件。它们不能完全满足我的需求。

我希望你能帮我找到一个。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T00:39:34.487

我不明白你在说什么，但你可以试试 jquery lightbox。可能满足你的需求。我个人喜欢花式盒子 --> (http://fancybox.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-05T22:34:48.730

试试 jQuery 花式框。让生活变得轻松

# android - 无法将谷歌帐户添加到 android 模拟器

> ID：11336693
> 
> 赞同：11
> 
> 时间：2012-07-05T00:43:44.593
> 
> 标签：android, android-emulator

我在**将我的 android 模拟器连接到 gmail 时遇到问题**。即使我可以浏览网页，我也无法添加我的 gmail 帐户。

我去，`Accounts and Sync/add account/google/sign in`输入我的 gmail 地址和密码，然后在漫长的等待后收到以下消息 - **“无法建立与服务器的可靠数据连接”**

我正在通过*公司代理*，所以我怀疑这可能是问题所在。如果我尝试创建新选项，也会发生这种情况。

有谁知道这个活动需要打开哪个端口，如果这确实是问题？
或者，如果有人有任何替代解释，我会很想听听他们的，因为我很难过。

我正在使用 google api 运行 Android 2.2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T08:39:11.777

自 API 16 或 17 以来，以下解决方案不再有效（不确定数字）

*   单击添加帐户、电子邮件。
*   输入您的 gmail 地址和密码
*   点击手动设置
*   选择交易所
*   对于域\用户名，输入 \yourEmail@gmail.com（不要忘记开头的反斜杠和结尾的 @gmail.com）
*   服务器：m.google.com（不是 gmail.com）
*   检查使用 SSL（应该已经检查）
*   点击下一步，下一步，下一步

而已 ！

# mongodb - Mongo从现有日期字段添加时间戳字段

> ID：11336694
> 
> 赞同：4
> 
> 时间：2012-07-05T00:43:59.160
> 
> 标签：mongodb, timestamp

我目前有一个包含以下文档的集合：

```
{ foo: 'bar', timeCreated: ISODate("2012-06-28T06:51:48.374Z") } 
```

我现在想为`timestampCreated`这个集合中的文档添加一个键，以便更轻松地按时间查询。

我能够使用`update`and`$set`操作添加新列，并设置时间戳值，但我似乎正在使用以下方法设置当前时间戳：

```
db.reports.update({}, { 
    $set : { 
        timestampCreated : new Timestamp(new Date('$.timeCreated'), 0) 
    } 
}, false, true); 
```

但是，我还没有找到添加此列并将其值设置为现有“timeCreated”字段的时间戳的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:00:33.000

查找所有文档，仅限于 id 和 timeCreated 字段。然后循环并生成 timestampCreated 值，并对每个值进行更新。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-11-14T20:04:23.123

使用[`updateMany()`](https://docs.mongodb.com/master/reference/method/db.collection.updateMany/)which 可以接受[聚合管道](https://docs.mongodb.com/master/reference/method/db.collection.updateMany/#update-many-method-agg-pipeline)（从 MongoDB 4.2 开始），从而利用[`$toLong`](https://docs.mongodb.com/manual/reference/operator/aggregation/toLong/)将 Date 转换为自纪元以来的毫秒数的运算符。

还使用[`$type`](https://docs.mongodb.com/manual/reference/operator/query/type/)更新[过滤器](https://docs.mongodb.com/master/reference/method/db.collection.updateMany/#update-many-filter)中的查询来限制具有`timeCreated`字段和日期类型的文档：

```
db.reports.updateMany(
    { 'timeCreated': {
        '$exists': true,
        '$type': 9
    } },
    [
        { '$set': { 
            'timestampCreated': { '$toLong': '$timeCreated' } 
        } }
    ]
) 
```

# mysql - 有效处理当前账户余额

> ID：11336707
> 
> 赞同：1
> 
> 时间：2012-07-05T00:47:27.370
> 
> 标签：mysql, performance, database-design, concurrency

我一直在开发一个应用程序来处理帐户和通过这些帐户进行的交易。

目前，应用程序使用的表按以下方式建模：

```
帐户
+----+-----------------+---------+-----+
| 编号 | 当前余额 | 版本 | ... |
+----+-----------------+---------+-----+
| 1 | 1000 | 48902 | ... |
| 2 | 2000 | 34933 | ... |
| 3 | 100 | 103 | ... |
+----+-----------------+---------+-----+

account_transaction
+--------+-------------+----------+----- --+------------------+--+
| 编号 | account_id | 日期 | 价值 | 结果金额 | ... |
+--------+-------------+----------+----- --+------------------+--+
| 101 | 1 | 2012 年 5 月 3 日 10:13:33 | 1000 | 2000 | ... |
| 102 | 2 | 2012 年 5 月 3 日 10:13:33 | 500 | 1500 | ... |
| 103 | 1 | 2012 年 5 月 3 日 10:13:34 | -500 | 1500 | ... |
| 104 | 2 | 2012 年 5 月 3 日 10:13:35 | -50 | 1450 | ... |
| 105 | 2 | 2012 年 5 月 3 日 10:13:35 | 550 | 2000 | ... |
| 106 | 1 | 2012 年 5 月 3 日 10:13:35 | -500 | 1000 | ... |
+--------+-------------+----------+----- --+------------------+--+

```

*每当应用程序处理一个新事务时，它都会在account_transaction*中插入一个新行，并且在*account*表中，它会更新存储帐户当前余额的列*current_balance*以及用于乐观锁定的列*版本。*如果乐观锁定有效，则提交事务，否则回滚事务。

作为一个粗略的例子，在处理事务 102 时，应用程序执行了以下伪 SQL/JAVA：

```
设置自动提交 = 0；

插入 account_transaction
（account_id、日期、值、结果金额）
价值观
(2, sysdate(), 550, 2000);

更新帐户集
    current_balance = 2000,
    版本 = 34933  
在哪里
    id = 2 和
    版本 = 34932；

if (ROW_COUNT() != 1) {
    回滚；
}
别的 {
    犯罪;
}

```

但是，某些帐户非常活跃，并且会同时接收许多事务，这会导致 MySQL 在更新*帐户*表中的行时出现死锁。这些死锁给应用程序带来了严重的性能损失，因为当数据库发生死锁时，它会导致重新处理事务。

如何有效地处理账户的当前余额？当前余额用于授权/拒绝新交易，并用于各种报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T17:26:29.177

> 如何有效地处理账户的当前余额？

我认为整个模型都被过度设计了。

放弃乐观锁定`version`并拥有一个简单的...

```
UPDATE account SET current_balance = current_balance + value WHERE id = ... 
```

...在插入新的事务**结束**`account_transaction`时应该非常快。为了数据完整性，请考虑将其放入`account_transaction`¹上的 AFTER INSERT 触发器中。

*   首先，你是在事务结束时做的，所以即使事务很长，这一行的锁竞争也应该很短。
*   SQL 保证单个语句中的数据视图一致，因此不需要单独的`SELECT ... FOR UPDATE`.
*   此外，由于您要**添加**一个值，而不是直接设置总和，因此这些操作的执行顺序并不重要 - 加法是可交换的（因此较短的事务可以“超越”较长的事务）。

* * *

*¹但要注意不要太早触发它 - 只有`account_transaction`在它完全“煮熟”时才插入新的，不要（例如）早插入但`resulting_amount`稍后更新。*

# c# - 使用 Roslyn 将自动实现的属性添加到类

> ID：11336712
> 
> 赞同：12
> 
> 时间：2012-07-05T00:48:38.517
> 
> 标签：c#, automatic-properties, roslyn

我试图通过从头开始构建一个现有但简单的应用程序来学习 Roslyn，这似乎是一种有效的学习方式。无论如何，我有以下代码：

```
var root = (CompilationUnitSyntax)document.GetSyntaxRoot();

    // Add the namespace
    var namespaceAnnotation = new SyntaxAnnotation();
    root = root.WithMembers(
        Syntax.NamespaceDeclaration(
            Syntax.ParseName("ACO"))
                .NormalizeWhitespace()
                .WithAdditionalAnnotations(namespaceAnnotation));
    document = document.UpdateSyntaxRoot(root);

    // Add a class to the newly created namespace, and update the document
    var namespaceNode = (NamespaceDeclarationSyntax)root
        .GetAnnotatedNodesAndTokens(namespaceAnnotation)
        .Single()
        .AsNode();

    var classAnnotation = new SyntaxAnnotation();
    var baseTypeName = Syntax.ParseTypeName("System.Windows.Forms.Form");
    SyntaxTokenList syntaxTokenList = new SyntaxTokenList()
        {
            Syntax.Token(SyntaxKind.PublicKeyword)
        };

    var newNamespaceNode = namespaceNode
        .WithMembers(
            Syntax.List<MemberDeclarationSyntax>(
                Syntax.ClassDeclaration("MainForm")
                    .WithAdditionalAnnotations(classAnnotation)
                    .AddBaseListTypes(baseTypeName)
                    .WithModifiers(Syntax.Token(SyntaxKind.PublicKeyword))));

    root = root.ReplaceNode(namespaceNode, newNamespaceNode).NormalizeWhitespace();
    document = document.UpdateSyntaxRoot(root);

    var attributes = Syntax.List(Syntax.AttributeDeclaration(Syntax.SeparatedList(Syntax.Attribute(Syntax.ParseName("STAThread")))));

    // Find the class just created, add a method to it and update the document
    var classNode = (ClassDeclarationSyntax)root
        .GetAnnotatedNodesAndTokens(classAnnotation)
        .Single()
        .AsNode();

        var syntaxList = Syntax.List<MemberDeclarationSyntax>(
                Syntax.MethodDeclaration(
                    Syntax.ParseTypeName("void"), "Main")
                    .WithModifiers(Syntax.TokenList(Syntax.Token(SyntaxKind.PublicKeyword)))
                    .WithAttributes(attributes)
                    .WithBody(
                        Syntax.Block()));
        syntaxList.Add(Syntax.PropertyDeclaration(Syntax.ParseTypeName("System.Windows.Forms.Timer"), "Ticker"));
        var newClassNode = classNode
            .WithMembers(syntaxList);

    root = root.ReplaceNode(classNode, newClassNode).NormalizeWhitespace();
    document = document.UpdateSyntaxRoot(root); 
```

在 IDocument 中输出以下代码。

```
namespace ACO
{
    public class MainForm : System.Windows.Forms.Form
    {
        [STAThread]
        public void Main()
        {
        }
    }
} 
```

虽然它应该看起来更像这样（注意我尝试添加 Timer 属性）

```
namespace ACO
{
    public class MainForm : System.Windows.Forms.Form
    {
    public System.Windows.Forms.Timer Ticker {get; set;}

        [STAThread]
        public void Main()
        {
        }
    }
} 
```

此外，我为这样一个简单的过程编写的代码似乎过分了。除了我的主要问题之外，人们能否就我如何以更优雅的方式解决这个问题提出建议？也许是博客的链接，或者代码片段之类的？

* * *

事实证明，我需要更改这一行：

```
syntaxList.Add(Syntax.PropertyDeclaration(Syntax.ParseTypeName("System.Windows.Forms.Timer"), "Ticker")); 
```

到这一行：

```
syntaxList = syntaxList.Add(Syntax.PropertyDeclaration(Syntax.ParseTypeName("System.Windows.Forms.Timer"), "Ticker")); 
```

但是，现在我得到了这个输出：

```
namespace ACO
{
    public class MainForm : System.Windows.Forms.Form
    {
        [STAThread]
        public void Main()
        {
        }

        System.Windows.Forms.Timer Ticker
        {
        }
    }
} 
```

现在我没有得到“get; set;” 属性中的文本。有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T08:03:38.643

我认为没有添加该属性的原因是`SyntaxList`s 与 Roslyn 中的其他所有内容一样，是不可变的。不`Add()`返回更新的`SyntaxList`？（我现在无法验证，我还没有切换到新的 CTP。）

在 Roslyn 中这样的代码可能非常冗长，但是你让它变得比必要的更复杂。如果从下向上构建语法树，则不必`root`在每次更改后进行更新：首先创建类的成员，然后创建类，然后创建命名空间。如果你这样做，你根本不需要处理所有的注释。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-16T20:14:48.430

使用新的 fluent API（.With...() 方法），您现在可以使用：

```
Syntax.PropertyDeclaration(Syntax.ParseTypeName("int"), "MyProperty")
      .WithAccessorList(
          Syntax.AccessorList(
              Syntax.List(
                  Syntax.AccessorDeclaration(SyntaxKind.GetAccessorDeclaration)
                        .WithSemicolonToken(Syntax.Token(SyntaxKind.SemicolonToken)),
                  Syntax.AccessorDeclaration(SyntaxKind.SetAccessorDeclaration)
                        .WithSemicolonToken(Syntax.Token(SyntaxKind.SemicolonToken))))); 
```

# c# - 如何为运行时排序创建表达式树？

> ID：11336713
> 
> 赞同：12
> 
> 时间：2012-07-05T00:49:04.177
> 
> 标签：c#, entity-framework-4, lambda

使用 Entity Framework 4，我试图实现基于成员名称集合的动态排序。基本上，用户可以选择要排序的字段和排序的顺序。我已经查看了表达式树示例，但无法将其拼凑在一起。以下是一些细节：

列名集合：

```
public List<string> sortColumns;
sortColumns = new List<string>();

/// Example subset of video fields.  The collection will vary.
sortColumns.Add("Width");
sortColumns.Add("Height");
sortColumns.Add("Duration");
sortColumns.Add("Title"); 
```

视频类定义如下：

```
public class Video
{
    public string Title { get; set; }
    public int Width { get; set; }
    public int Height { get; set; }
    public float Duration { get; set; }
    public string Filename { get; set; }
    public DateTime DateCreated { get; set; }
    .
    .
    .
}
public List<Video> Videos; 
```

我想做的是枚举 sortColumns 集合以在运行时构建表达式树。此外，用户可以指定升序或降序排序，表达式树应该处理任何一个。

我尝试了 VS 2008 的动态 LINQ 库，但它似乎在 VS 2010 中不起作用。（我可能做错了什么。）

底线是我需要一个表达式树来根据用户输入对视频集合进行动态排序。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-05T03:17:22.763

首先你需要`OrderBy`@Slace 在[这里](https://stackoverflow.com/questions/307512/how-do-i-apply-orderby-on-an-iqueryable-using-a-string-column-name-within-a-gene)写的扩展方法。所有功劳归功于[Slace](https://stackoverflow.com/users/11388/slace)一段很棒的代码，也是迄今为止解决方案中最困难的部分！我对其进行了轻微修改以适应您的具体情况：

```
public static class QueryableExtensions
{
    public static IQueryable<T> OrderBy<T>(this IQueryable<T> source, string sortProperty, ListSortDirection sortOrder)
    {
        var type = typeof(T);
        var property = type.GetProperty(sortProperty);
        var parameter = Expression.Parameter(type, "p");
        var propertyAccess = Expression.MakeMemberAccess(parameter, property);
        var orderByExp = Expression.Lambda(propertyAccess, parameter);
        var typeArguments = new Type[] { type, property.PropertyType };
        var methodName = sortOrder == ListSortDirection.Ascending ? "OrderBy" : "OrderByDescending";
        var resultExp = Expression.Call(typeof(Queryable), methodName, typeArguments, source.Expression, Expression.Quote(orderByExp));

        return source.Provider.CreateQuery<T>(resultExp);
    }
} 
```

创建一个对列表进行排序的方法。以下方法中需要注意的几点：

1.  由于运算符不采用表达式树，因此`List<string>`将转换为 a 。`IQueryable<string>``Enumerable`
2.  该方法以相反的顺序遍历排序列的列表（假设您要为列表中的第一项赋予最高排序优先级）

.

```
private void PrintVideoList(IEnumerable<string> sortColumns, ListSortDirection sortOrder)
{
    var videos = this.GetVideos();
    var sortedVideos = videos.AsQueryable();

    foreach (var sortColumn in sortColumns.Reverse())
    {
        sortedVideos = sortedVideos.OrderBy(sortColumn, sortOrder);
    }

    // Test the results
    foreach (var video in sortedVideos)
    {
        Console.WriteLine(video.Title);
    }
} 
```

然后你应该能够使用这样的方法：

```
// These values are entered by the user
var sortColumns = new List<string> { "Width", "Title", "Height" };
var sortOrder = ListSortDirection.Ascending;

// Print the video list base on the user selection
this.PrintVideoList(sortColumns, sortOrder); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-02T17:46:45.490

正是我需要凯文。我注意到的是，如果您使用 orderby，它只需要最后一次 orderby 选择。

我将此方法（ThenBy）添加到我的，它似乎运作良好

```
public static IQueryable<T> ThenBy<T>(this IQueryable<T> source, string sortProperty, ListSortDirection sortOrder)
    {
        var type = typeof(T);
        var property = type.GetTypeInfo().GetDeclaredProperty(sortProperty);
        var parameter = Expression.Parameter(type, "p");
        var propertyAccess = Expression.MakeMemberAccess(parameter, property);
        var orderByExp = Expression.Lambda(propertyAccess, parameter);
        var typeArguments = new Type[] { type, property.PropertyType };
        var methodName = sortOrder == ListSortDirection.Ascending ? "ThenBy" : "ThenByDescending";
        var resultExp = Expression.Call(typeof(Queryable), methodName, typeArguments, source.Expression, Expression.Quote(orderByExp));

        return source.Provider.CreateQuery<T>(resultExp);
    } 
```

# javascript - 为什么窗口的宽度为空？

> ID：11336714
> 
> 赞同：1
> 
> 时间：2012-07-05T00:49:28.077
> 
> 标签：javascript, jquery, css

我试图提醒窗口的大小和元素的大小，以便将元素放在我想要的位置。

```
<script type="text/javascript"></script>
<script type="text/javascript">
  $(document).ready(function(){
    var element=$(".element").width();
    var window=$(window).width();
    alert("Element: "+element+" "+"Window: "+window);
  });
</script> 
```

当我在浏览器中打开它时，我得到了元素的宽度，但窗口的宽度为空。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-05T00:52:07.177

您正在隐藏`window`全局变量。重命名变量：

```
var windowWidth = $( window ).width(); 
```

# macos - 在mac中使用终端跨目录复制文件

> ID：11336715
> 
> 赞同：4
> 
> 时间：2012-07-05T00:49:29.787
> 
> 标签：macos, shell

如何将具有特定扩展名的所有文件`.SAV`从一个目录（包括该目录中的所有子目录）复制到另一个目录？我正在使用mac的终端。我试过了

```
 /Users/tournillon/my_directory/research_projects/dissertation_related/inequality
    Antonio-P-Tournillon-Ramoss-iMac:inequality tournillon$ ls
    Brazil              dhs_dados           imr201101app.pdf
    GHME_Education_final.pptx   dhs_sav_files
    Antonio-P-Tournillon-Ramoss-iMac:inequality tournillon$ dhs_dados /*.SAV/ dhs_sav_files/ 
```

我认为这是一项微不足道的任务，但我就是无法正确使用语法。

非常感谢，

安东尼奥·佩德罗。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-05T01:00:59.880

`find /source/directory -iname \*.sav -exec cp {} /destination/directory/ \;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T00:59:33.310

如果您的意思是 UNIX 副本，

```
cp -R <dirA>/*.sav <dirB>/ 
```

我不确定您的问题中的 dhs_dados 是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T01:01:00.437

为什么不直接使用 cp *.SAV 目录

# javascript - .click 后使用 replaceWith 的问题

> ID：11336720
> 
> 赞同：0
> 
> 时间：2012-07-05T00:51:18.600
> 
> 标签：javascript, jquery, button, click

可能是一个简单的菜鸟错误，但我无法弄清楚。我有一个提交按钮，在用户单击它后，我希望它消失并替换为“感谢提交您的信息”。

这是我所拥有的：

```
<script>

$(document).ready(function() {

$('#emailsubmit').onClick(function() {
$(this).replaceWith('<p>Thanks for signing up!</p>');

)};
)};

</script>

<input id="emailsubmit" name="submit" type="submit" value="Send " /> 
```

对我来说看起来不错，但点击时，什么也没有发生。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:52:49.817

你最好使用`click`而不是`onClick`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T00:55:08.233

该函数的名称是`click`, not `onClick`，并且您有几个语法错误要引导。

```
$(document).ready(function() {
    $('#emailsubmit').click(function() {
        $(this).replaceWith('<p>Thanks for signing up!</p>');
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T00:55:31.957

您将内联的 DOM 零事件 ( `onClick`) 与 jQuery 的别名事件方法混淆了。

jQuery 有一个`click`方法（简称`on('click...`）但没有`onClick()`方法。这会引发错误，这意味着您应该始终先咨询浏览器控制台。

```
$('#emailsubmit').on('click', function() {... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T00:58:31.960

该方法名为`click`not `onClick`。

此外，删除提交按钮将使表单无法发布。改为隐藏它：

```
$(this).hide().after('<p>Thanks for signing up!</p>'); 
```

# database - 局域网中的visual studio 2010数据库

> ID：11336722
> 
> 赞同：0
> 
> 时间：2012-07-05T00:51:25.990
> 
> 标签：database

我有 2 台计算机，一台在 Windows XP SP3 中，另一台在 WINdows 7 Ultimate 中。

所以我正在尝试创建一个 Windows 应用程序和一个数据库来存储项目。装有 Windows XP 的 PC 将使用相同的 Windows 应用程序，但我将如何连接到在 Windows 7 中创建的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T01:18:49.890

您可能只需要打开防火墙的相应端口，并使用ip和端口访问数据库即可。

# c++ - BGL dijkstra_shortest_path 算法方法不接受我的颜色图外部属性

> ID：11336723
> 
> 赞同：4
> 
> 时间：2012-07-05T00:51:31.673
> 
> 标签：c++, boost-graph

我一直试图让 boost graph lib 的 dijkstra_shortest_paths 编译大约一个星期，但无济于事。我正在尝试将外部属性映射用于模板化方法所需的不同命名参数。我的图使用了顶点和边的捆绑属性，并且我已经能够成功地构建图。我将向您展示我所拥有的代码：

```
// vertex bundled properties
struct BusStop
{
    unsigned int id; //used for creating vertex index property map
    string name;
    Location* pLocation;
};

// edge bundled properties:
struct Route
{
    string routeName;
    BusType type;
    float distance; 
}; 
```

这是我的图表声明：

`typedef boost::adjacency_list<boost::vecS, boost::setS, boost::undirectedS, BusStop, Route> BusRouteGraph;`

这是我尝试在给定图上执行dijkstra最短路径的方法：

```
template<typename Graph>
bool shortestPathSearch(Graph& g, typename   
  boost::graph_traits<Graph>::vertex_descriptor src,
  typename boost::graph_traits<Graph>::vertex_descriptor dest)
{
    bool bPathFound = false;
    VertexIndexMap index_map = get(&BusStop::id, g);

    // Initialize index_map
    typedef typename graph_traits<Graph>::vertex_iterator V_Iter;
    V_Iter v_iter, v_iter_end;
    int c = 0;
    for( boost::tie(v_iter, v_iter_end) = vertices(g); v_iter != v_iter_end; 
         ++v_iter, ++c)
    {
    index_map[*v_iter] = c;
    }

    // Create exterior properties for these
    vector<int> predecessor(num_vertices(g));
    vector<float> distances(num_vertices(g), 0.0f);
    vector<default_color_type> colors(num_vertices(g));

    dijkstra_shortest_paths(g, src, weight_map(get(&Route::distance, g))
    .color_map (make_iterator_property_map(colors.begin(), index_map))
        .distance_map(make_iterator_property_map(distances.begin(), 
                           index_map)));

    return bPathFound;
} 
```

我得到这些编译时错误：（只有下面的第一个错误）

```
\src\BusRouteFinder.cpp:461:2:   instantiated from 'bool shortestPathSearch  (Graph&, typename boost::graph_traits<Graph>::vertex_descriptor, typename boost::graph_traits<Graph>::vertex_descriptor) [with Graph = boost::adjacency_list<boost::vecS, boost::setS, boost::undirectedS, BusStop, Route>, typename boost::graph_traits<Graph>::vertex_descriptor = void*]'
..\src\BusRouteFinder.cpp:91:39:   instantiated from here
C:\boost\boost_1_48_0/boost/graph/two_bit_color_map.hpp:86:3: error: invalid cast from type 'boost::default_property_traits<boost::adj_list_vertex_property_map<boost::adjacency_list<boost::vecS, boost::setS, boost::undirectedS, BusStop, Route>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >::value_type {aka boost::detail::error_property_not_found}' to type 'std::size_t {aka unsigned int}'
C:\boost\boost_1_48_0/boost/graph/two_bit_color_map.hpp:88:30: error: no match for 'operator/' in 'i / elements_per_char'
C:\boost\boost_1_48_0/boost/graph/two_bit_color_map.hpp:88:30: note: candidates are:
C:\boost\boost_1_48_0/boost/concept_archetype.hpp:316:3: note: template<class Base> boost::dividable_archetype<Base> boost::operator/(const boost::dividable_archetype<Base>&, const boost::dividable_archetype<Base>&)
C:\boost\boost_1_48_0/boost/concept_archetype.hpp:344:3: note: template<class Return, class BaseFirst, class BaseSecond> Return boost::operator/(const boost::divide_op_first_archetype<Return, BaseFirst>&, const boost::divide_op_second_archetype<Return, BaseSecond>&)
C:\boost\boost_1_48_0/boost/graph/two_bit_color_map.hpp:89:58: error: no match for 'operator%' in 'i % elements_per_char'
C:\boost\boost_1_48_0/boost/graph/two_bit_color_map.hpp:89:58: note: candidates are:
C:\boost\boost_1_48_0/boost/concept_archetype.hpp:317:3: note: template<class Base> boost::modable_archetype<Base> boost::operator%(const boost::modable_archetype<Base>&, const boost::modable_archetype<Base>&)
C:\boost\boost_1_48_0/boost/concept_archetype.hpp:346:3: note: template<class Return, class BaseFirst, class BaseSecond> Return boost::operator%(const boost::mod_op_first_archetype<Return, BaseFirst>&, const boost::mod_op_second_archetype<Return, BaseSecond>&) 
```

我已经为此苦苦挣扎了很长时间，但似乎没有找到解决方案。在我放弃 BGL 之前，我想我会在这里问一些人 :(

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-31T22:14:38.293

错误消息说编译器没有找到正确的 vertex_index_t 属性——这是 Boost.Graph 中所有搜索算法的关键元素。定义一个类 VertexIndexMap 是不够的，你还必须告诉 Boost 这是你的“vertex_index”。

您可以尝试添加类似于以下的声明：

```
class VertexIndexMap //maps vertex to index
{
public:
    typedef boost::readable_property_map_tag category; 
    typedef size_t  value_type;
    typedef value_type reference;
    typedef BusRouteGraph::vertex_descriptor key_type; 

    VertexIndexMap(const BusRouteGraph& g): _g(&g) {} 

    const BusRouteGraph * _g;
};

namespace boost {

template<>
struct property_map<BusRouteGraph, vertex_index_t > {
    typedef VertexIndexMap const_type;
    //typedef type const_type ; //-- we do not define type as "vertex_index_t" map is read-only 
};

VertexIndexMap get(boost::vertex_index_t, const BusRouteGraph & g )
{
    return VertexIndexMap(g);
}

VertexIndexMap::value_type get(VertexIndexMap map, VertexIndexMap::key_type vertex)
{
    return (*map._g)[vertex].id;
}

} //namespace boost 
```

之后，您可以删除初始化 index_map 的循环；相反，我们使用标准的“Boost-ish”方式来获取索引图

```
VertexIndexMap index_map = get(boost::vertex_index, g); ///replaces get(&BusStop::id, g); 
```

然后一切都应该正常。

祝你好运！

# javascript - 尝试从 txt 中获取数据时，不显示带有 Django 的 Google Maps API

> ID：11336726
> 
> 赞同：0
> 
> 时间：2012-07-05T00:52:13.633
> 
> 标签：javascript, python, google-maps

我有以下问题。我使用 Google Maps 的 API 嵌入了一张地图。我的意图是从 .txt（坐标）中获取一些值，将它们放入列表中，然后在地图中显示它们，每个点之间都有线。如果我将值手动放入列表中，我这样做没有问题。但是当我尝试从 .txt 文件中获取它们时，地图没有显示在我的页面中（它应该是空白的地方）。但是如果我签入脚本的源代码，它似乎没有任何问题......每个点都显示为它应该在脚本内部。这是我的观点的一部分：

def 基础（请求）：

```
 analyze_results('testing')
 with open('data.txt') as f:
     for line in f:
        words = line.split()
        points.append(words[1]+','+words[3])
 return render_to_response('base.html', {'points': points, 'user_data': user_data}) 
```

点= []

如果我手动分配积分列表，并拿走

使用 open('data.txt') 作为 f：

```
 for line in f:
        words = line.split()
        points.append(words[1]+','+words[3]) 
```

它完美地工作。

你知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:21:38.210

我查看了您的问题历史记录以了解有关您在做什么的更多信息，看起来您必须在将文本数据传递给 Google 地图之前对其进行清理。正在发生的事情是 LatLng 被创建为：

```
new google.maps.LatLng(38.4397984,061.1720742) 
```

请注意，在 61.1720742 之前有一个“0”，这在我测试 Chrome 时给了我“意外数字”错误。您需要删除该零。此外，坐标为“南”和“西”，因此您需要添加减号“-”以符合 Google 地图的 LatLng 格式。

PS你可以尝试`strip('0')`去掉0，例如`'061.172000'.strip('0')`-> '61.172'

# php - PHPMailer 警告

> ID：11336732
> 
> 赞同：1
> 
> 时间：2012-07-05T00:53:58.910
> 
> 标签：php, smtp, phpmailer

我目前对这个错误的愚蠢性感到震惊和困惑。老实说，这对我来说毫无意义。

所以我有一个由 4 个网站组成的网络，它们都使用相同的 contact.php 脚本，该脚本是粘贴的。

因此，在其中三个站点上，该脚本运行良好。但是在其中一个站点上，它不断弹出错误。根本不应该有任何错误，因为它们在同一台服务器上并且使用完全相同的 html 文件，除了不同的内容。

```
Warning: include(../../vip/boss/mailer/class.phpmailer.php) [function.include]: failed to open stream: No such file or directory in /home/aap/public_html/justevents.net.au/quickcontact.php on line 2

Warning: include(../../vip/boss/mailer/class.phpmailer.php) [function.include]: failed to open stream: No such file or directory in /home/aap/public_html/justevents.net.au/quickcontact.php on line 2

Warning: include() [function.include]: Failed opening '../../vip/boss/mailer/class.phpmailer.php' for inclusion (include_path='.:/usr/lib/php:/usr/local/lib/php') in /home/aap/public_html/justevents.net.au/quickcontact.php on line 2

Warning: include(../../vip/boss/mailer/class.smtp.php) [function.include]: failed to open stream: No such file or directory in /home/aap/public_html/justevents.net.au/quickcontact.php on line 3

Warning: include(../../vip/boss/mailer/class.smtp.php) [function.include]: failed to open stream: No such file or directory in /home/aap/public_html/justevents.net.au/quickcontact.php on line 3

Warning: include() [function.include]: Failed opening '../../vip/boss/mailer/class.smtp.php' for inclusion (include_path='.:/usr/lib/php:/usr/local/lib/php') in /home/aap/public_html/justevents.net.au/quickcontact.php on line 3

Fatal error: Class 'PHPMailer' not found in /home/aap/public_html/justevents.net.au/quickcontact.php on line 27 
```

请帮我

```
<?php
include("../../vip/boss/mailer/class.phpmailer.php");
include("../../vip/boss/mailer/class.smtp.php");
function heal($str) {
$injections = array('/(\n+)/i',
'/(\r+)/i',
'/(\t+)/i',
'/(%0A+)/i',
'/(%0D+)/i',
'/(%08+)/i',
'/(%09+)/i'
);
$str= preg_replace($injections,'',$str);
return str_replace('@','-AT-',$str);
} 
$name = heal($_POSTname);
$email = str_replace('-AT-','@',heal($_POSTemail));
$message = heal(str_replace("\n",'<br>',$_POSTmessage));
$category = heal($_POSTcategory);
if(substr_count($email,'@')==1){
$mail=new PHPMailer();
$mail->IsSMTP();
$mail->SMTPAuth   = true;                
$mail->Host       = "localhost";  
$mail->SMTPSecure = "ssl";     
$mail->Port       = 465;   
$mail->Username   = "autonote@justevents.net.au";  
$mail->Password   = "REDACTED";          
$mail->From       = "autonote@justevents..net.au";
$mail->FromName   = $name;
$mail->Subject    = $category.' Enquiry';
$mail->Body       = $message;           
$mail->WordWrap   = 50;
$mail->AddAddress("admin@justevents..net.au","justevents. Enquiry");
$mail->AddReplyTo($email,$name);
$mail->IsHTML(true);
if(!$mail->Send()) {
echo "Mailer Error: " . $mail->ErrorInfo;
}else{
header("LOCATION:quicksuccess.html");
} 
}else{
echo 'There was an error, please try again. '.substr_count($email,'@');
} 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:05:08.483

**在调用文件上使用[`getcwd()`](http://php.net/manual/en/function.getcwd.php)以调试此类错误。**

从日志中可以看出，文档不在预期的路径中。
只有一种方法可以确定，使用绝对路径。

`getcwd()`然后用...调试情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:59:37.330

显然找不到您尝试包含的文件。所以问题不仅在于您是否在所有四个中都使用相同的 php 脚本，而且它们是否在同一个目录中？如果不是，它们上面的目录结构是否相同？您在那里为您的包含使用相对路径，所以我猜您只是在子目录或其他东西中有这个版本，所以它无法从其工作目录中找到要包含的文件。

# ruby-on-rails - 对数据库中的用户进行排序，所以我不必每次查询时都执行 order_by

> ID：11336738
> 
> 赞同：0
> 
> 时间：2012-07-05T00:55:16.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid

我可以在数据库中对我的用户进行排序，这样我每次查询时都不必说 order_by("created_at desc") 吗？

听起来对我来说是一件合乎逻辑的事情，但我不知道这是否可能以及它是否是最佳实践？

解决方案

我已经在使用 default_scope 并且据我所知，这是最好的方法吗？非常感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:32:30.787

*如果您在按create date desc*排序的结果之后，[反向自然顺序](http://www.mongodb.org/display/DOCS/Sorting+and+Natural+Order)将接近此（但不保证相同）。

如果您需要特定的排序，添加`order_by()`到索引查询是确保这一点的最佳方式。

如果您使用默认生成的[ObjectId](http://www.mongodb.org/display/DOCS/Object+IDs#ObjectIDs-BSONObjectIDSpecification)，前 4 个字节实际上是一个 unix 时间戳（自纪元以来的秒数）..除了文档中提到的一些例外情况外，该`_id`字段[默认为索引。](http://www.mongodb.org/display/DOCS/Object+IDs#ObjectIDs-The%5CidField)

因此，在 mongo shell 中创建的最近 50 个用户（基于 ObjectId）的查询将是：

```
db.users.find().sort({_id:-1}).limit(50) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:22:55.277

关于默认范围有不同的看法，但要实现您的要求：

[http://apidock.com/rails/ActiveRecord/Base/default_scope/class](http://apidock.com/rails/ActiveRecord/Base/default_scope/class)

```
class User < ActiveRecord::Base
  default_scope order('created_at DESC')
  ### other model code here ###
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T01:14:10.333

您应该能够向您的数据库表添加一个或多个索引。在实时系统上运行它时要小心，因为在大表上创建索引的开销可能会被禁用。

编辑：应该扩大。

通过创建索引，您仍然需要订购，但您的订购/排序会更有效率。

ref:[是否可以将数据库索引添加到已经有数据的数据库中？](https://stackoverflow.com/questions/3903914/is-it-okay-to-add-database-indexes-to-a-database-that-already-has-data)

# ruby-on-rails - 嵌套路由和 form_for 和 NoMethodError

> ID：11336741
> 
> 赞同：3
> 
> 时间：2012-07-05T00:55:35.260
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller, form-for, nested-resources

正如下面所述的错误消息，我不使用“user_profiles_path”作为复数，因为我在嵌套资源中定义了“resource :profile”。

```
NoMethodError in Profiles#new 
```

显示 /home/smileymike/rails_projects/bffmapp_v2/app/views/profiles/new.html.erb 其中第 20 行提出：

```
undefined method `user_profiles_path' for #<#<Class:0x90266ac>:0xa041294> 
```

模型：

```
class User < ActiveRecord::Base
  has_one :profile

class Profile < ActiveRecord::Base
  attr_accessible :name, :surname
  belongs_to :user 
```

路线.rb：

```
 resources :users do
    resource :profile  (note: has_one)
  end 
```

查看：profiles/new.html.erb

```
<div class="row">
  <div class="span6 offset3">
    <%= form_for([@user, @profile]) do |f| %>
      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :surname %>
      <%= f.text_field :surname %>

      <%= f.submit "Create my profile", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

路线

```
 user_profile POST   /users/:user_id/profile(.:format)      profiles#create
 new_user_profile GET    /users/:user_id/profile/new(.:format)  profiles#new
edit_user_profile GET    /users/:user_id/profile/edit(.:format) profiles#edit
                  GET    /users/:user_id/profile(.:format)      profiles#show
                  PUT    /users/:user_id/profile(.:format)      profiles#update
                  DELETE /users/:user_id/profile(.:format)      profiles#destroy
            users GET    /users(.:format)                       users#index
                  POST   /users(.:format)                       users#create
         new_user GET    /users/new(.:format)                   users#new
        edit_user GET    /users/:id/edit(.:format)              users#edit
             user GET    /users/:id(.:format)                   users#show
                  PUT    /users/:id(.:format)                   users#update
                  DELETE /users/:id(.:format)                   users#destroy
         sessions POST   /sessions(.:format)                    sessions#create
      new_session GET    /sessions/new(.:format)                sessions#new
          session DELETE /sessions/:id(.:format)                sessions#destroy
             root        /                                      static_pages#home
           signup        /signup(.:format)                      users#new
           signin        /signin(.:format)                      sessions#new
          signout DELETE /signout(.:format)                     sessions#destroy
             help        /help(.:format)                        static_pages#help
            about        /about(.:format)                       static_pages#about
          contact        /contact(.:format)                     static_pages#contact 
```

控制器：

```
class ProfilesController < ApplicationController
    def show
    end

  def new
    @user = current_user
    @profile = current_user.build_profile()
  end

  def edit
  end

  def create
  end

  def update
  end

  def destroy
  end
end 
```

下面是profiles_controller.rb 中current_user 的说明

```
module SessionsHelper
    def sign_in(user)
    cookies.permanent[:remember_token] = user.remember_token
    self.current_user = user
  end

  def signed_in?
    !current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end

  def sign_out
    self.current_user = nil
    cookies.delete(:remember_token)
  end
end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T01:55:57.193

使用这样的多态路由的表单将始终使用复数路径来获取新记录。您需要在表单中明确：

```
form_for([@user, @profile], :url => user_profile_path(@user)) 
```

不过好消息是，`create`路线与路线相同`update`。

# jqgrid - 具有类似网格的 JQGrid 有没有办法重用您的 javascript 代码，而不是再次设置每个选项？

> ID：11336742
> 
> 赞同：1
> 
> 时间：2012-07-05T00:55:41.090
> 
> 标签：jqgrid, jqgrid-asp.net, jqgrid-formatter

当我在同一页面或整个网站上使用多个网格时，有没有办法抽象出常见网格组件的设置？例如 colModel 部分，或两个网格之间相同的其他组件，同时让我可以选择使每个网格唯一，例如名称、标题等。

基本上，这归结为我想避免设置高度相似的多个网格所带来的文本墙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T16:17:26.540

我能够实现一些我正在寻找的东西。

我能够获取最大的重复代码 colModel:[..] 并将其转换为变量然后调用它。

前任

```
var colModelForReuse = [{name: 'exName', index: 'exIndex' ..... }, 
                        {.......................................}]; 
```

然后在我的网格设置中

```
colNames: [ 'exName', .....],
colModel: colModelForReuse,
pager: pagerName,
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T18:45:41.077

是的，您可以创建一个创建实际网格的函数，然后将选项传递给它以控制每个网格之间不同的方面。传递参数的一个好方法是使用[jQuery.extend](http://api.jquery.com/jQuery.extend/)，它允许您轻松提供默认参数值。

例如：

```
function myFunction(options) {
    options = jQuery.extend(
        {
            myOption1:         'Default Vaule',
            myOption2:         'Default Vaule',
        },
        options || {});
    ...
} 
```

# javascript - linkedin js 如何成为有效的 javascript

> ID：11336743
> 
> 赞同：5
> 
> 时间：2012-07-05T00:55:47.177
> 
> 标签：javascript, linkedin

LinkedIn Javascript 集成通过以下方式完成：

```
<script src="http://platform.linkedin.com/in.js" type="text/javascript">
   api_key: 9XXXXXXX
   authorize: true
</script> 
```

我不明白，这是一个有效的javascript吗？为什么没有引用 api_key。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T01:00:41.240

带有 a 的脚本标签的主体`src`永远不会被执行。但是，加载的脚本可以像访问任何其他元素的内容一样访问其内容。因此，它是存储与已加载脚本相关的元数据的好地方。

实际上，在引入属性之前，它*是*一个不错的地方。`data-`使用它们会更合适，但是linkedin api可能比`data-`属性更老，或者他们只是想保持简单。

访问标签的一种可能方法是将以下代码放入`.js`文件中：

```
var scripts = document.getElementsByTagName('script');
var thisScriptTag = scripts[scripts.length - 1]; 
```

^([资源](https://stackoverflow.com/questions/403967/how-may-i-reference-the-script-tag-that-loaded-the-currently-executing-script))

然后，您可以使用`textContent`or`innerText`属性访问标签中的任何内容。

# objective-c - 添加委托协议后，应用程序在 main 中崩溃；没有错误代码

> ID：11336749
> 
> 赞同：2
> 
> 时间：2012-07-05T00:56:51.580
> 
> 标签：objective-c, xcode, ipad

在我的应用程序中，可以将一个视图中的图形拖到第二个视图中，以便新图形替换第二个视图（例如具有拖放功能的复制/粘贴效果）。如果委托协议被取出，则应用程序可以工作，以便第二个视图处理函数本身的更改。添加协议后，应用程序在主文件中崩溃

```
return UIApplicationMain(argc, argv, nil, NSStringFromClass([Load_CreatorAppDelegate class]));. 
```

除了标准（lldb）之外，没有任何错误输出。即使我取消对委托的调用（保留在代码中），应用程序也会崩溃。不过，我知道它必须与协议代码相关，因为在此之前它运行良好。

这是第二个视图（BeamView）的部分代码：

```
[self drawSupportsAtLeftPoint:self.beamBottomLeft rightPoint:self.beamBottomRight inContext:context :leftPin :rightPin];   

BOOL pt = NO;
if (self.tempLoad) {
    //self.loadGraph = [self.dataSource changeToTempLoad:self]; NOTE #1
    //if (self.tempPtLoad.x != 0 || self.tempPtLoad.y != 0) pt = YES;
    pt = [self changeLoad];
    [self drawLoadWithFunction:self.loadGraph inContext:context fromPoint:self.beamTopLeft toPoint:self.beamTopRight withAlpha:0.3 isPointLoad:pt inBlack:YES];
}
else {
    self.loadGraph = ^(int x) {return x/15;};
    [self drawLoadWithFunction:self.loadGraph inContext:context fromPoint:self.beamTopLeft toPoint:self.beamTopRight withAlpha:1 isPointLoad:pt inBlack:NO];
}

self.tempLoad = NO; 
```

注意＃1：这些被注释掉的行是调用委托的行。这两种方法及其实现是我所做的唯一更改。

我完全困惑，任何帮助将不胜感激。应用程序在主文件中崩溃的可能原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:28:35.030

行！我觉得有点愚蠢，但事实证明，崩溃与委托没有任何关系（嗯，有点）。我删除了 ViewController.m 文件中的插座，而没有在 IB 中断开它们，这导致了崩溃。

我忘记了我已经这样做了，所以我花了一段时间才想到它——直到我回到一个较旧的保存版本，我才看到了不同之处。

# python - 实例化时带有 datetime.now() 的 Python 类

> ID：11336751
> 
> 赞同：5
> 
> 时间：2012-07-05T00:57:04.233
> 
> 标签：python, class, datetime

我想要一个 Class 属性，它`datetime.now()`在实例化类的新实例时设置。使用此代码，`MyThing.created`似乎总是何时`MyThing`导入，而不是何时`mt`实例化。

```
from datetime import datetime

class MyThing:
    __init__(self, created=datetime.now()):
        self.created = created

MyThing.created
datetime.datetime(2012, 7, 5, 10, 54, 24, 865791)

mt = MyThing()
mt.created
datetime.datetime(2012, 7, 5, 10, 54, 24, 865791) 
```

我该怎么做才能实例化，`created`而`mt`不是`MyThing`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T01:01:14.070

函数参数的默认值在定义函数时计算一次。调用函数时不会重新评估它们。通常，您会使用`None`默认值，并在正文中对其进行测试：

```
def __init__(self, created=None):
    self.created = created or datetime.now() 
```

更好的是，看起来您可能不想将创建日期传递给构造函数，在这种情况下：

```
def __init__(self):
    self.created = datetime.now() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T00:59:47.847

不要在参数中设置它，因为它们是函数本身的成员，因为一切都是第一类对象。

```
class MyThing:
    __init__(self, created=None):
        self.created = created
        if created is None:
            self.created = datetime.now() 
```

# c# - 通过 White 从批处理文件启动应用程序

> ID：11336756
> 
> 赞同：0
> 
> 时间：2012-07-05T00:57:40.823
> 
> 标签：c#, batch-file, cmd, white-framework

我试图让 White 检测从批处理文件启动的应用程序。我目前的代码是：

```
Application application = Application.Launch(@"C:\WINNT\system32\calc.exe"); 
```

这适用于从其 .exe 打开应用程序，但是当我尝试时：

```
Application application = Application.Launch(@"C:\WINNT\system32\test.bat"); 
```

它没有启动 .bat。我假设即使 bat 运行，应用程序也会被分配给 cmd.exe，而不是批处理中的实际应用程序。我有什么方法可以设置应用程序，以便从进程树中搜索应用程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T01:00:10.397

尝试使用此命令行启动：

```
@"C:\WINNT\system32\cmd.exe /c C:\WINNT\system32\test.bat" 
```

Cmd.exe 是解释 .bat 或 .cmd 脚本文件的 EXE。

# c# - 本土化。扩展 ASP.NET Resx 资源提供程序

> ID：11336763
> 
> 赞同：4
> 
> 时间：2012-07-05T00:59:22.920
> 
> 标签：c#, asp.net, localization, globalization

对于我的网站，我有一个用于本地化目的的自定义资源提供程序（本地化字符串存储在数据库中）。它工作得很好，但我希望它与默认的 Resx 资源提供程序一起工作：在 resx 资源中查找本地化字符串，如果不存在则从数据库中提取它。

但看起来，只要我将 IIS 全球化设置更改为使用我自己的资源提供程序工厂，默认的 resx 资源提供程序工厂就会被忽略。

我想解决方案是扩展我自己的资源提供者，但我找不到如何从我的资源提供者内部引用 resx 资源。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:15:24.480

**编辑**

正如评论中所指出的，我在下面的回答是错误的。您可以使用反射获取*ResXResourceProviderFactory*，如下所示。

```
IResourceProvider resxProvider;
string typeName = "System.Web.Compilation.ResXResourceProviderFactory, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
ResourceProviderFactory factory = (ResourceProviderFactory)Activator.CreateInstance(Type.GetType(typeName));
resxProvider = factory.CreateGlobalResourceProvider(classKey); 
```

（获取*本地*资源提供者的类似方法。）

然后，要获取资源，只需调用*GetObject*：

```
object resource = p.GetObject("ResourceKey", new System.Globalization.CultureInfo("en")); 
```

* * *

您可以使用[GetGlobalResourceObject](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.getglobalresourceobject.aspx)和[GetLocalResourceObject](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.getlocalresourceobject.aspx)方法（*HttpContext*类的一部分）来处理自定义本地化类中的 .ResX 文件。

例如，要从“MyResxFile.resx”（在 *App_GlobalResources* 下）获取名为“ResourceKey”的资源，对于当前区域性，您可以使用以下命令：

```
HttpContext.GetGlobalResourceObject(
    "MyResxFile", 
    "ResourceKey", 
    System.Threading.Thread.CurrentThread.CurrentCulture
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:45:56.307

好的，看起来使用默认 resX 资源提供程序扩展自定义资源提供程序并不能完全解决问题，因为隐式本地化表达式 ( `meta:resourcekey`) 没有被本地化。

[我在这里](http://msdn.microsoft.com/en-us/library/aa905797.aspx#exaspnet20rpm_topic6)找到的可能解决方案是使用自定义 ResourceExpressionBuilder：

> 配置自定义提供程序非常适合所有资源将存储在备用位置的情况，并且您不打算分别利用位于 App_LocalResources 和 App_GlobalResources 中的资源。如果您想支持本地和全局资源的标准实现（默认提供程序），同时还可以选择从其他来源（自定义提供程序）提取一些资源，该怎么办？您可以通过实现以自定义资源提供者为目标的自定义表达式来实现这一点。

这将允许将 resX 资源提供程序用于自定义资源提供程序的隐式和显式本地化和自定义表达式：

```
<%-- Local ResX --%>
<asp:Localize ID="locLocal" runat="server" Text="DefaultLocal" meta:resourcekey="locLocal" />
<%-- Global ResX --%>
<asp:Localize ID="locGlobal" runat="server" Text="<%$ Resources:GlobalResourceStrings, locGlobal %>" />
<%-- Custom Resource Provider --%>
<asp:Localize ID="locCust" runat="server" Text="<%$ ExternalResources:MyResources|CustomResourceStrings, locCust %>" meta:localize="false" /> 
```

或在代码中：

```
string s = (string)ExternalResourceExpressionBuilder.GetGlobalResourceObject("MyResources|CustomResourceStrings", "locCust"); 
```

# iphone - 使用重复本地通知的 iPhone 警报

> ID：11336764
> 
> 赞同：6
> 
> 时间：2012-07-05T00:59:31.867
> 
> 标签：iphone, objective-c, ios, uilocalnotification, alarm

我正在尝试将后台闹钟功能添加到我正在开发的应用程序中。

我已经阅读了该`UILocalNotification`对象及其用途，并且知道它仅限于 30 秒的音频。

我正在考虑安排间隔 30 秒的多个通知（例如，其中 5 个）以模拟连续播放，但这种方法的问题是，如果用户点击`Close`，我将无法取消任何后续通知。

据我所知，如果`Close`不完全隐藏通知（即，将`alertBody`属性设置为`Nil`），就不可能删除或隐藏按钮。

所以，我想我可能会使用该`repeatInterval`属性使通知每 30 秒弹出一次，但似乎我只能将间隔设置为一分钟或一秒，而两者之间什么也没有。

该功能旨在允许用户在音乐和哔哔声之间进行选择以获取警报音频；看来我可能已经找到了发出哔哔声的方法 - 将哔声设置`repeatInterval`为一秒，创建一秒钟的哔哔声（需要定时干净地重复）并将其用作通知声音。

但是，对于音乐，这种方法限制我播放 30 秒的音频，然后是 30 秒的间隙，然后是 30 秒的音频，依此类推。

根据我对其他帖子和资源的阅读，我知道这里没有直接的解决方案；没有第三方应用程序可以访问与内置闹钟相同的功能。我希望有人找到了解决方法或想到了一些非常聪明的方法。

更新：我发现`repeatInterval`在这种情况下对我没有帮助，因为我无法在不启动应用程序的情况下取消重复。

目前，我决定不将通知本身用作警报，而是将功能更改为提醒（更符合通知的用途）。

如果我想出一种方法来为应用程序实现用户友好、可靠的警报功能，我会更新这篇文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T20:20:45.583

恐怕您无法完成此操作。原因正如您所说的“关闭”按钮。如果点击关闭按钮，您将不会在应用程序中收到任何回电。此外，即使您每 30 秒显示一次通知，屏幕上也会有多个通知，用户必须查看或关闭这些通知。所以用户体验会很糟糕。我建议让用户清楚他们不能使用超过 30 秒的自定义声音设置警报。

# ruby - do_two_simple_things 的 Ruby 习语 if something_is_true

> ID：11336767
> 
> 赞同：3
> 
> 时间：2012-07-05T00:59:37.527
> 
> 标签：ruby

例如，这需要 4 行，对于这样一个简单的操作来说空间太大了：

```
if something_is_true
  puts 'error'
  return
end 
```

这个是单线的，但看起来很尴尬。

```
if something_is_true; puts 'error'; return; end 
```

我们可以做类似的事情吗

```
# it would be great if this would work because it is short and readable
puts 'error' and return if something_is_true 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T01:03:17.797

我不确定为什么您认为空间如此宝贵，以至于您的原始代码“太多”。给你的代码空间来呼吸，让它占据它需要的空间。为了“节省空间”而变得过于棘手是一种虚假的经济。最重要的是你的代码是可读和可理解的。您的原始代码对我来说看起来很棒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T01:54:53.577

我同意@NedBatchelder 的观点，即您的原始代码可能是最好的。其他人指出，在您的特定示例中，您可以使用`return puts 'error'`.

尽管如此，为了学习，您*可以*用括号将多个语句分组，因此在您只能使用一个语句的地方使用少量语句。你说：

```
# it would be great if this would work because it is short and readable
puts 'error' and return if something_is_true 
```

你可以这样做：

```
(puts 'error'; return) if something_is_true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T01:04:14.033

这有点糟糕，但我认为它会起作用，因为 puts 返回 nil：

```
puts 'error' || return if something_else 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T01:46:19.650

在这种特定情况下，`return`没有值将返回`nil`; 因为这恰好也是 的返回值`puts`，所以您可以通过以下方式获得相同的效果：

```
return puts "error" if something_else 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T01:06:35.610

有一天，您可能会不太关心在一行代码中可以花费多少个周期。我会使用这个`if-end`块，因为它简单、清晰，而且......你知道，这就是它的用途。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-05T07:13:47.897

我建议永远不要使用`;`加入语句，它往往是不可读的。但是还有其他方法，两个想法：第一个，join`error(msg, return_value = nil)`和`return`：

```
return(error("Message")) if something_is_true

return(error("Message", value_to_be_returned)) if something_is_true 
```

第二个，在 Ruby 中，使用异常来表示问题是惯用的，因此您可以编写这个非常惯用的单行代码：

```
raise MyException.new("human explanation of the error") if condition 
```

作业中使用的相同想法：

```
link = doc.at_css(".content a.link") or raise MyException.new("msg") 
```

# asp.net-mvc-3 - VS Express MVC3 新手重定向问题

> ID：11336780
> 
> 赞同：0
> 
> 时间：2012-07-05T01:01:43.337
> 
> 标签：asp.net-mvc-3, visual-studio

我是 MVC 的新手（已经做了很多年的经典 ASP）。我不确定我知道如何问这个问题。基本上，我希望一个控制器的操作能够无缝地传输/重定向到另一个视图/控制器。我努力了

```
 public class SetupController : Controller
    {
        ...
        public ActionResult Bicycles()
        {
            return RedirectToAction("Index", "Bicycles");
        }
    } 
```

但问题是这将我带到 localhost/Bicycles （不存在）。我想要的是去 localhost/Setup/Bicycles。我试过这个（将“设置”父文件夹添加到控制器名称）：

```
 public class SetupController : Controller
    {
        ...
        public ActionResult Bicycles()
        {
            return RedirectToAction("Index", "Setup/Bicycles");
        }
    } 
```

但这创建了一个无限重定向循环，浏览器正确地拒绝这样做。

希望我正在尝试做的事情是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:41:18.487

我相信您正在寻找的是：

```
 public ActionResult Bicycles()
    {
        return RedirectToAction("Bicycles", "Setup");
    } 
```

第一个参数是Action，第二个参数是Controller。

由于您已经在自行车操作中的 SetupController 中，因此您将获得无限重定向。但是，从您提到的内容来看，这就是您尝试重定向到的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T03:43:38.470

```
protected internal RedirectToRouteResult RedirectToAction(
    string actionName,
    string controllerName
) 
```

因此，您的第一个示例重定向到 Bicycles 控制器中的 Index 操作，因此是 localhost/Bicycles。

# java - FlexJSON 更改属性名称 - 在日期字段上

> ID：11336781
> 
> 赞同：0
> 
> 时间：2012-07-05T01:01:55.940
> 
> 标签：java, json, flexjson

我从这里找到了这段代码：[Change property name with Flexjson](https://stackoverflow.com/questions/7652231/flexjson-change-prop-name)

它适用于字符串数据类型，但似乎没有其他数据类型。有任何想法吗？

```
public class FieldNameTransformer extends AbstractTransformer {

    private String transformedFieldName;

    public FieldNameTransformer(String transformedFieldName) {
        this.transformedFieldName = transformedFieldName;
    }

    public void transform(Object object) {
    boolean setContext = false;

    TypeContext typeContext = getContext().peekTypeContext();

    //Write comma before starting to write field name if this
    //isn't first property that is being transformed
    if (!typeContext.isFirst())
        getContext().writeComma();

    typeContext.setFirst(false);

    getContext().writeName(getTransformedFieldName());
    getContext().writeQuoted((String) object);

    if (setContext) {
        getContext().writeCloseObject();
    }
}

/***
 * TRUE tells the JSONContext that this class will be handling 
 * the writing of our property name by itself. 
 */
@Override
public Boolean isInline() {
    return Boolean.TRUE;
}

public String getTransformedFieldName() {
    return this.transformedFieldName;
}
} 
```

这适用于文本字段，但如果我尝试将其应用于日期字段，则会非常不高兴。例如：

```
 String JSON = new JSONSerializer()
        .include("type", "createDate")
        .exclude("*")
        .transform(new DateTransformer("MM/dd/yyyy"), Date.class)
        .transform(new FieldNameTransformer("new_json_property_name"),"createDate")
        .serialize(stuff); 
```

发生 JSONException 失败：尝试 deepSerialize 时出错

当我注释掉 transform new Field... 行时它工作正常，当我尝试更改类型字段时它工作正常，它是一个字符串。

尝试修改和 Int 时它也会失败，我希望其他所有内容都不是字符串。

如果有人熟悉 FlexJSON API 并且可以在这里为我指明正确的方向，我将非常感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-23T07:50:39.623

您只需要更改这部分代码：

```
getContext().writeQuoted((String) object); 
```

对于大多数类型，如果您将其更改为：

```
getContext().writeQuoted(object.toString()); 
```

如果这不适用于 Date 值 - 只需重写集成 SimpleDateFormat ，如下所示：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd-MM-yyyy");
getContext().writeQuoted(sdf.format(object)); 
```

这应该够了吧。

# ruby-on-rails - 仅向用户显示异常消息

> ID：11336783
> 
> 赞同：0
> 
> 时间：2012-07-05T01:02:16.100
> 
> 标签：ruby-on-rails, ruby

我创建了这段代码来向用户显示特定的错误消息：

### application_controller.rb

```
class ApplicationController < ActionController::Base
  rescue_from Exception do |exception|
    message = exception.message
    message = "default error message" if exception.message.nil?

    render :text => message
  end
end 
```

### room_controller.rb

```
class RoomController < ApplicationController
  def show
    @room = Room.find(params[:room_id]) # Can throw 'ActiveRecord::RecordNotFound'
  end

  def business_method
    # something
    raise ValidationErros::BusinessException("You cant do this") if something #message "You cant do this" should be shown for user
    #...
  end

  def business_method_2
    Room.find(params[:room_id]).do_something
  end
end 
```

### 房间.rb

```
class Room < ActiveRecord::Base
  def do_something
    #...
    raise ValidationErrors::BusinessException("Invalid state for room") if something #message "Invalid state for room" should be shown for user
    #...
  end
end 
```

### 应用程序/模型/错误/validation_errors.rb

```
module ValidationErrors
  class BusinessException < RuntimeError
    attr :message
    def initialize(message = nil)
      @message = message
    end
  end
end 
```

### 例子.js

```
$.ajax({
        url: '/room/show/' + roomId,
        success: function(data){
            //... do something with data
        },
        error: function(data){
            App.notifyError(data) //show dialog with message
        }
    }); 
```

但我不能使用 BusinessException 类。当应引发 BusinessException 时，消息

> 未初始化的常量 Room::ValidationErrors

显示给用户。

如果我更改此代码：

```
raise ValidationErrors::BusinessException("Invalid state for room") if something 
```

这样：

```
raise "Invalid state for room" if something 
```

有用。

此代码的哪些更改适用于带有消息的 BusinessException。我需要这个来`rescue_from`在 ApplicationController 中创建具体的方法。

**编辑：**

感谢您的评论！我的错误是它不知道 ValidationErrors 模块。如何将此模块导入我的班级？

我已经测试将这些行添加到行中：

`require 'app/models/errors/validation_errors.rb'`

`require 'app/models/errors/validation_errors'`

但随后引发错误：

`cannot load such file -- app/models/errors/validation_errors`

**解决方案：**

[https://stackoverflow.com/a/3356843/740394](https://stackoverflow.com/a/3356843/740394)

```
config.autoload_paths += %W(#{config.root}/app/models/errors) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T04:23:09.757

```
raise ::ValidationErrors::BusinessException("Invalid state for room") 
```

# php - 应该如何调试 preg_match

> ID：11336797
> 
> 赞同：2
> 
> 时间：2012-07-05T01:06:06.963
> 
> 标签：php, debugging, preg-match

这个问题与我大约 15 分钟前提出的[这个](https://stackoverflow.com/questions/11336658/preg-match-no-ending-deliminator-found)SO 问题直接相关。这并不是要成为该帖子的重复帖子，而是希望这更多是一种学习体验。

在提出的问题中，我试图找出导致 preg_match no deliminator found 错误的原因。代码（**不是我**的）可[在此处](https://codereview.stackexchange.com/questions/6077/browser-and-os-detection-script)获得。该错误最终成为 Windows 3.11 数组中缺少的“/i”。

重要的是要注意，为了这个问题，我**不**使用浏览器部分。

第一个问题，理所当然地提出了 $regex 的价值是什么。但是，我仍然无法找到获得该值的方法。

我最初尝试的是在函数外部声明一个全局变量，并且在 preg_match 行之前将全局变量设置为正则表达式。然后我尝试回显全局变量。迎接我的是一个空白页。

我还应该提到我（在提出原始问题时）删除了这段代码：

```
$user_agent     =   getBrowserOS();
$device_details =   "<strong>Browser: </strong>".$user_agent['browser']."<br />    <strong>Operating System: </strong>".$user_agent['os_platform']."";
print_r($device_details);
echo("<br /><br /><br />".$_SERVER['HTTP_USER_AGENT'].""); 
```

因此我唯一应该看到的是全局变量的值。相反，我什么也没看到。

有人可以解释这应该如何调试吗？

编辑：根据 John C 的回答

```
<?php
$user_agent     =   $_SERVER['HTTP_USER_AGENT'];
function getOS() { 
global $user_agent;
$os_platform    =   "Unknown OS Platform";
$os_array       =   array(
                        '/windows nt 6.2/i'     =>  'Windows 8',
                        '/windows nt 6.1/i'     =>  'Windows 7',
                        '/windows nt 6.0/i'     =>  'Windows Vista',
                        '/windows nt 5.2/i'     =>  'Windows Server 2003/XP x64',
                        '/windows nt 5.1/i'     =>  'Windows XP',
                        '/windows xp/i'         =>  'Windows XP',
                        '/windows nt 5.0/i'     =>  'Windows 2000',
                        '/windows me/i'         =>  'Windows ME',
                        '/win98/i'              =>  'Windows 98',
                        '/win95/'               =>  'Windows 95',
                        '/win16'                =>  'Windows 3.11',
                        '/macintosh|mac os x/i' =>  'Mac OS X',
                        '/mac_powerpc/i'        =>  'Mac OS 9',
                        '/linux/i'              =>  'Linux',
                        '/ubuntu/i'             =>  'Ubuntu',
                        '/iphone/i'             =>  'iPhone',
                        '/ipod/i'               =>  'iPod',
                        '/ipad/i'               =>  'iPad',
                        '/android/i'            =>  'Android',
                        '/blackberry/i'         =>  'BlackBerry',
                        '/webos/i'              =>  'Mobile'
                    );

foreach ($os_array as $regex => $value) { 
var_dump($regex);
var_dump($value);
    if (preg_match($regex, $user_agent)) {
        $os_platform    =   $value;
    }

}   
return $os_platform;
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:25:12.417

我将尝试专注于这个实例而不是一般调试，因为我确信有更好的指南可以帮助您入门。

**1.查看错误信息。** 大多数时候，PHP 在告诉你哪里出了问题和哪里（在几行之内）方面并不算太差。在这种情况下，你会有一些类似的东西

```
Warning: preg_match() [function.preg-match]: No ending delimiter '/' found in /var/www/html/whatever.php on line 36 
```

所以问题是第 36 行缺少斜线。第 36 行（属于`getOS()`）：

```
if (preg_match($regex, $user_agent)) { 
```

我们可以推断这是 $regex 的问题 - 在这种情况下，快速查看有问题的数组会发现`/`其中一行缺失，但可能数据在数据库中或无法轻松检查。

**2\. 开始转储变量** 如果有什么不对劲的地方，检查你的变量是一个好的开始。您希望*尽可能接近*错误地执行此操作，这样您就知道两者之间没有发生任何事情。我们知道问题`$regex`出在上面，所以就在问题行的上方：

```
var_dump($regex);
if (preg_match($regex, $user_agent)) { 
```

新结果：

```
...
string '/win95/' (length=7)
string '/win16' (length=6)

Warning: preg_match() [function.preg-match]: No ending delimiter '/' found in /var/www/html/whatever.php on line 36 
```

一旦我们得到错误，PHP 就会停止，所以最后转储的行将显示问题变量。你好，一个缺少斜杠的正则表达式！

**关于您的方法：** PHP 在遇到错误时会停止，这就是为什么我建议尽可能接近问题转储变量的部分原因。在您的情况下，脚本从未达到您的回声语句。

**奖金笔记！**

*   I prefer `var_dump()` for checking variables because it is better at showing an empty/null variable (echo will just print a blank) plus it handles arrays and objects.
*   If you find yourself doing a lot of debugging, have a look at getting [XDebug](http://xdebug.org/) running. Immensely useful.

# asp.net - 在 ASP.NET 中转换 HTML 特殊字符

> ID：11336801
> 
> 赞同：3
> 
> 时间：2012-07-05T01:07:16.000
> 
> 标签：asp.net, html

我绑定到 DropDownList 如下；

```
Sub bindGalleries(ByVal catID As Integer)
    ddlGalleries.DataSource = Galleries.GetGalleries(catID)
    ddlGalleries.DataTextField = "GalleryName"
    ddlGalleries.DataValueField = "GalleryID"
    ddlGalleries.DataBind()
End Sub 
```

列表中的一项是：“Kültür & Sanat”，它正好显示在下拉列表中。但是当我查看页面的来源时，它是：`K&#252;lt&#252;r &amp; Sanat`

如何使源与原始字符串完全相同？

注意：我的元标记是：在母版页中..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:38:55.707

这应该给你你需要的东西：

```
Server.HtmlDecode("K&#252;lt&#252;r &amp; Sanat"); 
```

编写一个方法来“清理” DDL 中的项目并将它们存储在一个数组中。然后只需绑定到数组。

您可以以类似的方式填充 DDL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:11:32.767

您也许可以使用反斜杠转义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T01:37:11.877

您看到这些字符的原因是因为这些字符在保存到您的源代码时被 htmlencoded。

IE

```
YourSource = server.htmlEncode(value) 
```

或者

```
YourSource = server.urlEncode 
```

`server.htmlDecode`您可以通过使用或省略 server.htmlEncode将其保存为原始形式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T01:51:29.417

尝试将正确的字符集放在页面的标题部分。

例子：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-16"/> 
```

# c++ - 二进制数组的快速 Popcount 指令或汉明距离？

> ID：11336802
> 
> 赞同：1
> 
> 时间：2012-07-05T01:07:43.210
> 
> 标签：c++, performance, bit-manipulation, hamming-distance

我在 Visual Studio 2010 C++ 上实现

我有两个二进制数组。例如，

```
array1[100] = {1,0,1,0,0,1,1, .... }
array2[100] = {0,0,1,1,1,0,1, .... } 
```

要计算和之间的[汉明距离](http://en.wikipedia.org/wiki/Hamming_distance)， 存储 和的结果。`array1``array2``array3[100]``xor``array1``array2`

然后我必须计算`1`. `array3`为此，我知道我可以使用该`__popcnt`指令。

现在，我正在做如下的事情：

```
popcnt_result = 0;
for (i=0; i<100; i++) {
    popcnt_result = popcnt_result + __popcnt(array3[i]);
} 
```

它显示了一个很好的结果，但速度很慢。我怎样才能让它更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T02:02:02.597

`array3`似乎有点浪费，你正在访问一个你不需要的额外 400 字节的内存。我会尝试将您拥有的内容与以下内容进行比较：

```
for (int i = 0; i < 100; ++i) {
    result += (array1[i] ^ array2[i]);   // could also try != in place of ^
} 
```

如果这有帮助，那么我将它作为练习留给读者如何应用此更改*和*黄昏的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T01:13:24.310

实施后，该`__popcnt`电话无济于事。它实际上是在减慢你的速度。

`__popcnt`计算其参数中设置的位数。您只传入一个元素，看起来它保证为 0 或 1，因此结果（也是 0 或 1）没有用。这样做会稍微快一些：

```
popcnt_result += array3[i]; 
```

根据阵列的布局方式，您可能会也可能不会以`__popcnt`更聪明的方式使用。具体来说，如果您的数组由单字节元素组成（例如 、`char`、`bool`或`int8_t`类似元素），您可以一次对四个元素执行填充计数：

```
for(i = 0; i < 100; i += 4) {
    uint32_t *p = (uint32_t *) &array3[i];
    popcnt_result += __popcnt(*p);
} 
```

（请注意，这取决于 100 可以被 4 整除的事实。否则，您必须为最后几个元素添加一些特殊情况处理。）

但是，如果数组包含较大的值，例如`int`，那么您就不走运了，并且仍然不能保证这会比上面的幼稚实现更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T12:10:41.520

如果您的数组仅包含两个值（`0`或`1`），则汉明距离只是对应值不同的位置数。这可以使用`std::inner_product`标准库一次性完成。

```
#include <iostream>
#include <functional>
#include <numeric>

int main()
{
    int array1[100] = { 1,0,1,0,0,1,1, ... };
    int array2[100] = { 0,0,1,1,1,0,1, ... };

    int distance = std::inner_product(array1, array1 + 100, array2, 0, std::plus<int>(), std::not_equal_to<int>());

    std::cout << "distance=" << distance << '\n';

    return 0;
} 
```

# html - 第一次按下下一个按钮时，jQuery循环滑块重叠

> ID：11336803
> 
> 赞同：0
> 
> 时间：2012-07-05T01:08:22.943
> 
> 标签：html, css, jquery-cycle

这是网址：

[http://teothemes.com/wp/nam-fermentum-suscipit-metus-at/](http://teothemes.com/wp/nam-fermentum-suscipit-metus-at/)

当您第一次单击下一个箭头时，它会与内容重叠，我想它是关于边距的，但我不确定。我也注意到只有当我使用 fx:scrollHorz 时，我真的很喜欢那个，所以我想使用它。

还有一件事，有没有办法让循环插件在到达最后一张幻灯片时回到第一个项目而不是向右滚动我希望它可以将 2 张幻灯片返回到第一个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T09:55:34.023

通过将包含内容的 .panel div 的宽度设置为 100% 来修复它

# android - 如何将方法从 ac Activity 传递给 OnClickListener

> ID：11336804
> 
> 赞同：0
> 
> 时间：2012-07-05T01:08:30.727
> 
> 标签：android

您好，我有 2 个记忆游戏课程：一个是有方法的 NV1，例如：

```
 public class Nv1 extends Activity{

protected int cardsUp;

protected int currentIndex = -1;

protected int lastIndex = -1;

protected int cardEquals = 0;

protected int lifes = 3;
protected TextView lifes_txt;

protected Handler handler;

protected int [] imgIds = {
        R.id.img_1,
        R.id.img_2,
        R.id.img_3,
        R.id.img_4,
}; 
```

另一个实现 OnClickListener 的类 NVListener。

```
 public class CardsListener implements OnClickListener{
   @Override
   public void onClick(View v) { 
```

## ------------

**我需要从我的 Activity 调用 CardsListener 的方法。我怎么能那样做？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:35:22.637

方法A：将监听器抽象化，在Activity中实现抽象方法onClick（推荐，监听器可以方便复用，更容易调试）

例子：

在 SampleActivity.java 中

```
public class SampleActivity extends Activity {
    Button b;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //Your code here.....
        // findViewById()..... etc.

        b.setOnClickListener(new SomeListener(){
            @Override
            public void onClick(View v) {
                someMethod();   
            }
        });

    }

     public void someMethod(){
        Log.d("Log Tag","Some Message");
     }

} 
```

在 SomeListener.Java

```
//make it abstract
public abstract class SomeListener implements OnClickListener{
//put your own method,variables inside
//do not override onClick()

} 
```

方法 B：创建一个以 Activity 作为输入参数的构造函数。保存活动实例并自由调用其方法（不太推荐：不灵活，不符合逻辑 IMO）

在 SomeListener.Java

```
public class SomeListener implements OnClickListener {
    private SampleActivity mAct;

    public SomeListener(SampleActivity act){
        mAct = act;
    }
    @Override
    public void onClick(View v) {
         mAct.someMethod();
    }

} 
```

# java - UIWebView 风格的 Java 组件

> ID：11336810
> 
> 赞同：3
> 
> 时间：2012-07-05T01:09:19.687
> 
> 标签：java, cocoa-touch, swing

我是 Java 和 Java Swing 的新手，我正在创建一个需要展示网页的应用程序。我为 iOS 编程了很多，这里的简单解决方案是将页面加载到`UIWebView`. Java Swing 有简单的组件吗？或者，有没有一种简单的方法可以在 Swing 内部或外部创建类似的东西？

我基本上是在寻找您在 URL 中输入的内容，然后在应用程序中加载的页面看起来就像 Web 浏览器中的普通页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:20:42.273

没有单一有用的解决方案。有这个`JEditorPane`类，但它只支持 HTML 4，我对它的体验很糟糕。例如，HTML 注释显示为纯文本。

但是，如果您将搜索范围扩大到 Swing 之外的内容，那么有很多组件可以很好地完成这项工作。有关这些的详细讨论，请参阅此[相关问题](https://stackoverflow.com/questions/145863/best-java-swing-browser-component)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T03:05:37.223

如果您的 Java 程序是桌面应用程序，则接受 a的[`browse()`](http://docs.oracle.com/javase/7/docs/api/java/awt/Desktop.html#browse%28java.net.URI%29)方法可以从 a 获得。该功能是在 Java SE 6 中添加的。它不是嵌入式的，但用户选择的浏览器可能更具吸引力。[`java.awt.Desktop`](http://docs.oracle.com/javase/7/docs/api/java/awt/Desktop.html)[`URI`](http://download.oracle.com/javase/7/docs/api/java/net/URI.html)[`URL`](http://download.oracle.com/javase/7/docs/api/java/net/URL.html)

附录：另请参阅[*如何在默认浏览器中打开 URL*](http://johnbokma.com/mexit/2008/08/19/java-open-url-default-browser.html)。

# css - 如何使用 CSS3 实现类似 Windows Phone 的“平铺”3D 转换

> ID：11336812
> 
> 赞同：2
> 
> 时间：2012-07-05T01:09:39.927
> 
> 标签：css, microsoft-metro, css-transitions, css-transforms

我正在尝试使用 3D 转换/过渡的 CSS3 动画效果。我有一个 HTML 容器，它被有效地分成“图块”，另一层位于顶部。我想做的是在单个图块上创建“翻转”效果。

像[这样](http://jsfiddle.net/KwRX7/8/)，除非其中一层是纯 HTML（例如，文本）。

```
.sub {
    -webkit-transition: -webkit-transform 0.6s linear;
}
.flip {
    -webkit-transform: rotate3d(1,0,0,90deg);
}​ 
```

在考虑了一段时间之后，我不确定这是否可能。这是我尝试的。

*   带有一些文本作为底层的容器。
*   在顶部铺设瓷砖；将一个图块的不透明度设置为零，创建一个“窗口”。
*   现在将转换应用到背面层。
*   在顶部添加第三层，与第一层相同。

这几乎可行，但不是真的；“窗口”应该会翻转，但当然顶层仍然在窗口上方可见，[破坏了效果](http://jsfiddle.net/FpRnn/5/)。

有没有办法实现这种部分翻转效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:15:16.710

我不确定，但我认为这-> [http://ryanlowdermilk.com/2012/03/windows-8-metro-tiles-with-html-css3-and-javascript/](http://ryanlowdermilk.com/2012/03/windows-8-metro-tiles-with-html-css3-and-javascript/)是你需要的......

# javascript - WSDL 解析错误 无法解析 WSDL Xml

> ID：11336821
> 
> 赞同：1
> 
> 时间：2012-07-05T01:11:42.303
> 
> 标签：javascript, ios, xml, parsing, titanium

```
var soapRequest = "<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:glob="http://sap.com/xi/SAPGlobal20/Global">
 <soapenv:Header/>
   <soapenv:Body>
      <glob:EmployeeLeaveRequestByParticipantQuery>
         <EmployeeLeaveRequestSelectionByParticipant>
            <EmployeeLeaveRequestParticipantRoleCode listVersionID="?">2</EmployeeLeaveRequestParticipantRoleCode>

            <!--Zero or more repetitions:-->
            <EmployeeLeaveRequestParticipantWorkAgreementIDInterval>
               <IntervalBoundaryTypeCode>1</IntervalBoundaryTypeCode>
               <!--Optional:-->
               <LowerBoundaryWorkAgreementID schemeID="?" schemeAgencyID="?">1009</LowerBoundaryWorkAgreementID>
        </EmployeeLeaveRequestParticipantWorkAgreementIDInterval>
            <!--Zero or more repetitions:-->
         </EmployeeLeaveRequestSelectionByParticipant>
      </glob:EmployeeLeaveRequestByParticipantQuery>
   </soapenv:Body>
</soapenv:Envelope>"; 
```

我是否需要为我的 wsdl 文件添加任何 xml:scheema 前缀，否则它将直接解析！

如何在 JavaScript 中解析 WSDL

@提前致谢！

# javascript-events - 去掉里面P元素的事件处理函数

> ID：11336824
> 
> 赞同：0
> 
> 时间：2012-07-05T01:12:38.947
> 
> 标签：javascript-events, event-handling, jquery

我有一个外侧 div，里面有很多 P 元素，它绑定事件处理程序：

```
$("#container").on("click","div",showNext) 
```

并且这个click事件绑定成功，但是里面的所有元素都绑定到这个事件处理程序，如何删除？

在这里查看所有代码：[Jsfiddle](http://jsfiddle.net/strangeline/cYKeX/)

我想要的只是单击 div 并隐藏当前一个并显示下一个，但问题是当我单击它隐藏的 ap 元素时，既不...

所以我错过了什么，我对 Js 真的很陌生.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:28:21.547

试试这个：

```
$(".con").on("click",showNext)
 .children().on('click',function(e){e.stopPropagation();}) 
```

它可以防止 .con 子级中的点击事件冒泡。

[http://jsfiddle.net/doktormolle/KL4uw/](http://jsfiddle.net/doktormolle/KL4uw/)

# azure - 使用 SharedAccessSignature 创建 blob

> ID：11336830
> 
> 赞同：0
> 
> 时间：2012-07-05T01:14:43.893
> 
> 标签：azure, azure-storage, azure-blob-storage

这可能之前已经回答过，但我找不到它..

sharedAccessSignature（使用容器上的写入策略创建）可以允许客户端将“新”blob 上传到容器吗？新的意思是容器中尚不存在的 blob，名称/大小等由客户端提供。

此外，如果可能的话，有人可以指向一些链接，列出“使用”SAS（而不是创建一个）的整个过程。如果之前已经回答了这个问题，那么有人可以将我指向相同的链接吗？

我经历了[这个](http://msdn.microsoft.com/en-us/library/windowsazure/ee395415.aspx)，他们展示了对容器中已经存在的 blob 的写入，但他们没有展示如何创建新的 blob。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T05:16:22.297

是的，用户可以创建新的 blob

请访问此链接：http: [//msdn.microsoft.com/en-us/library/microsoft.windowsazure.storageclient.sharedaccesspolicy.aspx](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storageclient.sharedaccesspolicy.aspx)

问候，维杰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T14:46:53.673

我没有尝试创建新的 blob，但我有[一个简单的演示应用程序](https://bmspublic.blob.core.windows.net/codesamples/SharedKey.zip)，它展示了如何允许用户上传到 blob。我今天没有时间，但它可能适应容器级别。

同时，您仍然可以使用这种方法，如果将其创建为页面 blob，则可以将其设置为 1tb，但除非实际使用，否则不会对空间收费。因此，如果用户只上传 1mb，这就是您需要支付的全部费用。

# jquery - 由于 jquery onebyone 滑块，网站不在 IE 中居中

> ID：11336832
> 
> 赞同：1
> 
> 时间：2012-07-05T01:15:19.447
> 
> 标签：jquery, html, css, internet-explorer, slider

我在我网站的索引页面上放了一个 jquery 滑块。在 IE 中，此滑块使我的网站显示在屏幕的左侧，而不是仅在此页面的中心。

不知道为什么 - 我有一个测试页面，如果有人有任何想法，那就太好了，因为我已经尝试修复一个多星期了。

[http://www.coverforce.com.au/index-bu.php](http://www.coverforce.com.au/index-bu.php)

另外，仅供参考，滑块的样式尚未完成，所以请不要判断我丑陋的测试幻灯片哈哈。

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:17:17.897

移动：

```
<script src="/js/jquery-1.6.4.min.js"></script>
<script src="/js/jquery.onebyone.min.js"></script>   
<script src="/js/jquery.touchwipe.min.js"></script> 
<script type="text/javascript" charset="utf-8"> 
     $(document).ready(function() { 

        $('#banner').oneByOne({
            className: 'oneByOne1',              
            easeType: 'random',
            slideShow: true
        });  

     });

    </script> 
```

进入`<head>`或就在结束`</body>`标记之前。现在 IE 处于 quirks 模式，因为 DOCTYPE 不是文档中的第一件事。

在怪癖模式下，`auto`水平边距的工作方式与标准不同，这可能是问题所在。

# asp.net-mvc - MVC - 将参数从视图传递到弹出窗口

> ID：11336834
> 
> 赞同：0
> 
> 时间：2012-07-05T01:15:47.163
> 
> 标签：asp.net-mvc, view, parameters, popup, viewdata

我在将参数从视图传递到弹出窗口时遇到问题。

在我看来，我有以下剃须刀代码来呈现一个动作链接，当我单击它时，会出现一个弹出窗口：

```
@Html.ActionLink("[Edit Product]", "Edit", "Products", new { ProductCode = @Model.ProductCode}, new { @class = "editLink" }) 
```

我不太确定这是否正确或该部分`new { ProductCode = @Model.ProductCode}`是否有意义（请向我解释该部分的作用，任何人都好）。

无论如何，我的弹出代码接受这样的参数：

`@model MySuperStore.Models.ViewModel.ProductsModel`

每当我尝试通过 显示 ProductCode 时`@Mode.ProductCode`，我总是收到一条错误消息，指出引用未设置为对象的实例。

我尝试`ViewData`通过 MainView 将 ProductCode 放在 a 中并在弹出窗口中访问它，但这似乎也不起作用。

有人能帮帮我吗？谢谢。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:20:00.127

您的代码看起来不错：

```
@Html.ActionLink(
    "[Edit Product]", 
    "Edit", 
    "Products", 
    new { ProductCode = Model.ProductCode }, 
    new { @class = "editLink" }
) 
```

只需确保您放置此代码的视图是强类型的，并且呈现它的控制器操作将实际模型传递给它。

就`Edit`操作而言，您还应该确保您正在调用您正在将非空模型传递给视图：

```
public ActionResult Edit(int productCode)
{
    ProductsModel model = ... fetch your model using the productCode
    return View(model);
} 
```

现在在您的`Edit.cshtml`视图中（或部分视图，如果您使用 jQuery UI 对话框或*弹出窗口中的*内容打开它），您可以使用模型的属性：

```
@model ProductsModel 
@Html.DisplayFor(x => x.ProductCode) 
```

# python - 要求窗口管理器将 matplotlib 绘图窗口“始终位于顶部”？

> ID：11336835
> 
> 赞同：1
> 
> 时间：2012-07-05T01:15:57.427
> 
> 标签：python, matplotlib, window-managers, x11, xfce

这个问题听起来很简单，我目前在 Linux 下使用 Xfce4，我希望所有从 python/matplotlib 脚本中弹出的交互式绘图都出现在所有其他窗口的**顶部**

基本上我希望*XWindows*能够识别那些图形窗口，然后应用常见的窗口操作。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T15:36:17.003

可能不是您所追求的，但如果您正在生成自己的 GTK gui，您可以使用：

```
win.set_keep_above(True) 
```

如：

```
import gtk
from matplotlib.figure import Figure
from matplotlib.backends.backend_gtkagg import FigureCanvasGTKAgg as FigureCanvas

win = gtk.Window()
win.connect("destroy", lambda x: gtk.main_quit())
win.set_default_size(400,300)
win.set_title("Some Window")

f = Figure(figsize=(5,4), dpi=100)
a = f.add_subplot(111)
a.plot([1,2,3,4,5])

canvas = FigureCanvas(f)
win.add(canvas)
win.set_keep_above(True)

win.show_all()
gtk.main() 
```

# java - 验证（单位测量）

> ID：11336839
> 
> 赞同：0
> 
> 时间：2012-07-05T01:16:29.290
> 
> 标签：java, javascript, json, jsp

我有一个文本框，允许用户键入他们想要的单位，我必须验证这个单位是否存在。

示例 1：KM/H（正确）
示例 2：KA/H（错误）

我知道可以使用 C#、JavaScript 等代码来验证电子邮件地址。
有什么方法可以通过任何代码、Web 服务等来验证（计量单位）吗？使用Javascript，JSON？

Ps 我正在处理一个 JSP 页面 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:22:43.103

JavaScript 完全能够进行验证（尽管出于安全原因，它不应该以牺牲服务器端验证为代价来进行验证）。您可以通过简单的字符串检查（如下所示，这似乎适合您的情况）或对于更复杂的基于模式的验证，正则表达式进行验证。

**假定的 HTML：**

```
<form id='unit_form'>
    <input type='text' name='unit' />
    <input type='submit' value='go' />
</form> 
```

然后，当单击按钮时（使用 jQuery ...）

**JS**

```
$(function() {
    var valid_units = ['KM/H', 'KM']; //etc...
    $('#unit_form').on('submit', function() {
        var unit = $('input[name=unit]').val();
        if ($.inArray(unit, valid_units) == -1) {
            alert('bad unit!');
            return false; //cancel form submission
        }
    });
}); 
```

[JS小提琴](http://jsfiddle.net/Lc9zA/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:21:41.300

GNU 发布了一个名为[Units](http://www.gnu.org/software/units/)的漂亮小程序。它整齐地做你想做的事。

# smarty - 缩短 smarty if 语句

> ID：11336840
> 
> 赞同：1
> 
> 时间：2012-07-05T01:17:08.430
> 
> 标签：smarty, smarty3

我有一个聪明的 if 语句如下：

```
<{if $page->getURLName() eq 'big-issues' or $page->getURLName() eq 'polls' or $page->getURLName() eq 'what-we-do' or $action eq 'events' or $action eq 'blogs' or $action eq 'news'}> 
```

我必须在模板中多次比较相同的语句。多次重复这个陈述真的很乏味。我知道我可以缓存一个语句并多次重用它，但我正在寻找是否有可能做这样的事情：

```
<{if $page->getURLName() eq 'big-issues' or 'polls' or 'what-we-do' or 'events' or $action eq 'blogs' or 'news'}> 
```

就像在 PHP 中一样，我们可以这样做：

```
$url = array ("big-issues","polls","what-we-do");
$needle = $page->getURLName();
if(in_array($needle, $centered)) {
    //Do something
} 
```

请注意，我无法访问模板的 php 代码，因此只能使用 smarty。任何建议将不胜感激。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T02:45:53.673

实际上，这是我想出的解决方案。

注意：在我的模板中，我必须使用 <{}> 而不是 {} 来启动 smarty。它只是模板的设置方式。

```
 <{$urlName = ['big-issues','polls','what-we-do']}>
        <{$actionType = ['news','blogs','events']}>

        <{foreach item="url" from=$urlName}>
            <{if $page->getURLName() eq $url}>
                <{assign var=showBlock value=1}>
            <{/if}>
        <{/foreach}>

        <{foreach item="act" from=$actionType}>
            <{if $action eq $act}>
                <{assign var=showBlock value=1}>
            <{/if}>
        <{/foreach}> 
```

现在我可以在我的 HTML 中多次检查相同的语句而不会弄乱代码。

```
<{if $showblock}>
    <div class="block">
<{else}>
    <{div class="regular"}>
<{/if}> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:23:08.397

检查这个： [http ://www.smarty.net/forums/viewtopic.php?p=48466](http://www.smarty.net/forums/viewtopic.php?p=48466)

这用于分配给模板中的数组： [How to assign an array within a smarty template file?](https://stackoverflow.com/questions/2244319/how-to-assign-an-array-within-a-smarty-template-file)

应该是这样的：

```
{assign var='pages' value=','|explode:"big-issues,polls,what-we-do,events"}
{assign var='actions' value=','|explode:"blogs,news"}

{if in_array($page->getURLName(), $pages) or in_array($action, $actions)}
do something
{/if} 
```

# maven - 如何找到 Maven 插件的 -Dparameters 的文档

> ID：11336841
> 
> 赞同：0
> 
> 时间：2012-07-05T01:17:08.507
> 
> 标签：maven, plugins, configuration

据我所知，我们可以通过将参数放在 pom.xml 的配置部分或命令行中的 -Dparameter 来设置 maven 插件的参数。我认为 -Dparameter 将覆盖 pom.xml 中的相同参数。我可以在插件的参考文档中找到可用的参数列表。但是如何获得 -Dparameter 列表呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:47:08.233

从您要配置的插件目标的文档开始。页面顶部列出了必需参数和可选参数。如果您向下滚动页面（或单击参数名称）以查看参数详细信息，其中许多都列出了“表达式”；这是您在命令行上指定的属性。

例如，以[jar:jar](http://maven.apache.org/plugins/maven-jar-plugin/jar-mojo.html)目标为例。如果我想将`forceCreation`标志设置为 true，我可以添加`<forceCreation>true</forceCreation>`插件配置。该属性的[详细信息](http://maven.apache.org/plugins/maven-jar-plugin/jar-mojo.html#forceCreation)将`forceCreation`表达式显示为 ${jar.forceCreation}，因此我可以添加

`-Djar.forceCreation=true`

在我的 Maven 命令行上完成同样的事情。

# c# - 将 DataTable 更新为 MySql 数据库 C#

> ID：11336843
> 
> 赞同：2
> 
> 时间：2012-07-05T01:17:37.760
> 
> 标签：c#, mysql

我有一个如下所示的 DataTable MyDT：

```
string MyConString = "SERVER=" + sConfig_hostname + ";" +
                "DATABASE=" + sConfig_dbname + ";" +
                "UID=" + sConfig_dbusername + ";" +
                "PASSWORD=" + sConfig_dbpassword + ";Allow Zero Datetime=true;";
            MySqlConnection connection = new MySqlConnection(MyConString);
            string sQuery="Select * from Table";
            connection.Open();
            MySqlDataAdapter myDA = new MySqlDataAdapter(sQuery, connection);
            myDA.SelectCommand.ExecuteNonQuery();
            DataTable MyDT=new DataTable()// <- My DataTable
            myDA.Fill(MyDT);
            connection.Close();
...
...
// do something with MyDT
...
... 
```

用 MyDT 做某事后，我想将它更新到数据库，我该怎么做？我已经在谷歌搜索页面，但几乎通过循环数据表进行更新。有没有办法在没有循环的情况下更新整个数据表？请帮忙！谢谢阅读

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T02:21:59.587

您需要配置DataAdapter的`SelectCommand`、`DeleteCommand`和属性。您可以使用填充三个命令对象（选择、删除、更新）。`UpdateCommand``InsertCommand``MySqlCommandBuilder`

```
MySqlConnection connection = new MySqlConnection(MyConString);
string sQuery="Select * from Table";

MySqlDataAdapter myDA = new MySqlDataAdapter(sQuery, connection);
MySqlCommandBuilder cmb = new MySqlCommandBuilder(myDA);

DataTable MyDT = new DataTable()// <- My DataTable
myDA.Fill(MyDT);

//Add new rows or delete/update existing one
//and update the DataTable using 

myDA.Update(MyDT); 
```

# winapi - CopyIcon（）与 DuplicateIcon（）？

> ID：11336844
> 
> 赞同：3
> 
> 时间：2012-07-05T01:17:42.367
> 
> 标签：winapi

[`CopyIcon`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648058.aspx)和有什么区别[`DuplicateIcon`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648066.aspx)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:22:16.740

**更新：**显然，[**CopyIcon**和**DuplicateIcon**实际上做相同](http://blogs.msdn.com/b/oldnewthing/archive/2013/10/04/10454223.aspx)的事情（除了函数签名。下面的信息是在那篇特定博客文章之前一年多写的，但是它基于官方文档。虽然 Raymond Chen 是专家，[他的博客明确不是官方文档](http://blogs.msdn.com/b/oldnewthing/archive/2007/08/10/4315707.aspx)。但是，使用这两个函数应该没有什么坏处。

* * *

根据MSDN 文档中[**关于图标**](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648050.aspx)[文章中的](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648050.aspx)[**图标复制**部分](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648050.aspx#_win32_Icon_Duplication)[](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648050.aspx)

 **> CopyIcon**函数**复制图标句柄。这使应用程序或 DLL 能够获得对另一个模块拥有的图标的自己的句柄。然后，如果其他模块被释放，复制图标的应用程序仍然可以使用该图标。
> 
> ...
> 
> **DuplicateIcon**函数制作图标的实际副本。

从这些描述中可以看出，`CopyIcon()`当您不需要修改图标但需要处理它时应该使用它。`DuplicateIcon()`如果您打算修改它，请使用它。

* * *

MSDN 的疯狂其实是有办法的。几乎所有 MSDN 文档都分为三个部分：

*   关于*[主题]*
*   使用*[主题]*
*   *[主题]*参考

例如，其中*[topic]*可能是 Icons 之类的东西。

“ *[topic]参考”部分是与**[topic]*相关的所有功能和结构的摘要。如果他们没有回答您关于函数的问题，您可能会在“关于*[topic]* ”和/或“使用*[topic]* ”中获得更好的运气，其中更详细地介绍了*[topic]*。**

# c++ - 编译器标志更改时自动重新编译

> ID：11336847
> 
> 赞同：3
> 
> 时间：2012-07-05T01:17:57.910
> 
> 标签：c++, c, makefile, gnu-make

当我调试和优化我的一个 C/C++ 项目时，我经常禁用并启用`-p -g -pg`我的 Makefile 中的分析标志和一些优化标志，以便更好地了解正在发生的事情。

但是，`GNU make`没有检测到这种变化，也没有重新编译。

如何在不手动执行的情况下正确重建带有一些新标志（或删除一些标志）的整个软件项目`make clean`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T01:31:00.667

作为对 Stefan 上述响应的建议调整，您可以将构建配置分解到单独的文件中。您可以将此配置文件的名称列为您用于构建代码的所有 makefile 规则的先决条件（即在冒号右侧），而不是以某种方式将这个文件强制包含在您的代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:17:58.690

必须做的基本事情是让每个对象都依赖于一个配置文件。

作为 c/c++ 的一个稍微疯狂的解决方案，可以使用如下文件，该文件对于 makefile 和 c/c++ 都是正确的语法。

我没有在 Makefile 本身中包含所有编译器标志，而是创建了以下文件“Makefile_flags”：

```
#undef DUMMY
#define DUMMY /*
PROFILING_FLAGS = -p -g -pg
OPTIMIZATION_FLAGS = -O3
COMPILE_FLAGS = -Wall -Wextra -Wuninitialized -Wmissing-declarations \
                -Wshadow -ftrapv -Wfloat-equal -Wundef -Wpointer-arith \
                -Wcast-align -Wunreachable-code -Wold-style-cast \
                -Wformat=2 -Winit-self -Werror-implicit-function-declaration \
                -Wredundant-decls -Wunsafe-loop-optimizations \
                -pedantic -MD -MP
CPP_STD_FLAGS = -std=c++0x
COMPILE_FLAGS += $(CPP_STD_FLAGS)
COMPILE_FLAGS += $(PROFILING_FLAGS)
COMPILE_FLAGS += $(OPTIMIZATION_FLAGS)
LINKING_FLAGS = $(COMPILE_FLAGS)
#foo */ 
```

现在写入`-include Makefile_flags`您的 Makefile 和`#include "Makefile_flags"`您想要更新的源代码的每个文件（例如，在每个 *.c / *.cpp 文件中）。

此解决方案的优点：Makefile`#`用作注释的符号，因此`#undef DUMMY`,`#define DUMMY /*`并`#foo */`在此处无效。然而，在 C/C++ 中，`/*`用于多行注释。因此，编译器会忽略整个非 C 代码，并且`/*`Makefile 看不到未知符号。此外，预处理器指令`#undef DUMMY`注意不执行`#define DUMMY`两次，并且该`#foo`语句位于多行注释内。

然而，缺点是，必须将它包含在每个文件中。

确保您的文件“Makefile_flags”具有正确的相对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T16:07:38.097

这个问题的解决方案内置于[makepp](http://makepp.sourceforge.net/ "可靠的 GNU 替代品")中。这会自动检测并考虑所有依赖项，更改的命令当然就是其中之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T16:16:16.667

如果可能的话，您可以使用更智能的构建系统。我使用[SCons](http://www.scons.org/)，它有这样的东西构建它。它还具有很好的功能，例如自动扫描文件以查找标题依赖项，因此您不必手动保持最新或运行 20 个自动工具。

# c# - 如何区分 C# 4.0 中的硬盘型号

> ID：11336855
> 
> 赞同：2
> 
> 时间：2012-07-05T01:19:28.257
> 
> 标签：c#, wmi, hard-drive

我目前正在使用 WMI 查询来返回连接到计算机的所有硬盘的制造商名称。不幸的是，这并没有专门返回“Intel”或“Western Digital”，所以我使用 string.Contains() 来比较制造商是谁。我的简单形式的代码是：

```
 //*** Declare Management Class
        ManagementClass clsMgtClass = new ManagementClass("Win32_DiskDrive");
        ManagementObjectCollection colMgtObjCol = clsMgtClass.GetInstances();

        //*** Loop Over Objects

        foreach (ManagementObject objMgtObj in colMgtObjCol)
        {
            MessageBox.Show(objMgtObj.Properties["Manufacturer"].Value.ToString());
        } 
```

这可能在 60% 的情况下有效，因为它依赖于 WMI 来返回整个名称。因此，例如，我的硬盘驱动器返回为“SanDisk SDSSDX240GG25 ATA 设备”，这很好，因为我可以很容易地找到“SanDisk”。同样，西部数据的产品会显示为“WD3000USB”或类似的东西，我可以清楚地找到“WD”。然而，在另一台使用希捷硬盘的计算机上，它有 SE1000GXB 等等，并且没有任何真正的制造商指示。所以我的问题是，我怎样才能可靠地找到硬盘制造商，并且能够轻松区分制造商，而不必费力通过谷歌脚本或数据库查询型号。谢谢。另一个编辑：使用成员“Caption”，它将返回上面的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T02:29:16.393

ST-希捷

您可以从每个现在合并的硬盘公司下载型号前缀列表，并根据型号制作一个表格，如果您愿意，该表格也可以包含实际容量。

型号中通常包含足够的信息，1986 年后磁盘设备上的序列号通常包含型号信息。

最重要的是，您可能必须创建一个表格以以人类友好的方式查找信息。

[http://www.robvanderwoude.com/files/listhdds_2k.txt](http://www.robvanderwoude.com/files/listhdds_2k.txt)

这将帮助您了解合并的内容 [http://en.wikipedia.org/wiki/List_of_defunct_hard_disk_manufacturers](http://en.wikipedia.org/wiki/List_of_defunct_hard_disk_manufacturers)

这是 Windows [http://www.robvanderwoude.com/sourcecode.php?src=listhdds_2k的批处理文件](http://www.robvanderwoude.com/sourcecode.php?src=listhdds_2k)

# algorithm - 元组数据集上的二进制分类

> ID：11336856
> 
> 赞同：2
> 
> 时间：2012-07-05T01:19:42.627
> 
> 标签：algorithm, dataset, machine-learning, classification

我有一个 2 类数据集，我应该在其上应用二进制分类算法。数据集如下所示：

a1，a2，a3，……+1
……
b1，b2，b3，…………-1
…………

其中每个特征/属性值都是一个 2 元组。例如，a1 是 (a1_1, a1_2)。a1_1 和 a1_2 之间存在依赖关系（尽管此时我不确定它们是如何相关的）并且它们的顺序并不重要。类似的情况也适用于负类实例。

我正在寻找对这些实例进行分类的某种方法。请让我知道是否存在这样的算法。

首先，我尝试拆分元组 - a1_1 和 a1_2 为一个实例形成两个单独的列，导致每个实例的特征值数量增加一倍 - 并使用 LIBSVM (C/C++) 库，但结果并不好。我认为拆分元组并因此寻找合适的方法是没有意义的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:20:34.453

在所有条件相同的情况下，我想如果您的数据实际上包含成对的事物，那么将这一事实传达给学习算法将会很有用。 **将您的整体对拆分为单独的特征可以让您的分类算法有机会了解两个特征之间可能存在的任何有用关系**。

然而，这只是一般的经验法则。您可能无法获得良好的分类结果有几个原因：

1.  一对的两个特征之间可能没有有用的关系。如果是这样的话，那么分成两个特征会使你的问题变得更加困难：现在分类算法有[一个额外的维度需要探索](http://en.wikipedia.org/wiki/Curse_of_dimensionality)。
2.  也许你还没有找到合适的学习算法。不同的算法有不同的优势，如果您使用正确的分类算法，使用多个特征可能是一个好主意。我建议尝试像[Weka](http://www.cs.waikato.ac.nz/ml/weka/)这样的监督学习包，它提供了一种非常简单的方法来比较单个问题上的一堆学习算法。只需将您的数据转换为`.arff`格式，您就可以立即使用 SVN、决策树、神经网络等进行分类。
3.  您可能没有提供足够的功能。当您拆分`a1, a2, ...`为单独的特征`[a1_1, a1_2], [a2_1, a2_2], ...`时，您还可以包含反向数据，例如，您还可以通过为每个数据包含非拆分版本来`[a1_1, a1_2], [a1_2, a1_1], [a2_1, a2_2], [a2_2, a2_1], ...` 使用*三个*`[a1, a1_1, a1_2], [a2, a2_1, a2_2], ...`特征，例如， 这有点像“让我们抛出我们的每个特征能想到的问题”的办法。
4.  可能是您遇到了一个非常困难的分类问题。您是否有任何证据表明您的输入中实际上存在一些信号，分类器可以使用该信号将数据分为两组？

# python - 将本机 Git 二进制文件打包到应用程序中

> ID：11336860
> 
> 赞同：3
> 
> 时间：2012-07-05T01:20:50.797
> 
> 标签：python, windows, git, package, libgit2

我正在编写一个需要调用一些 Git 命令的 Python 应用程序。我首先查看了 libgit2 和 pygit2，但它们缺少一些我需要的功能，例如`git remote`. 相反，我现在想找到一种在我的应用程序中包含本机 Git 二进制文件的方法，而不是使用 Git 库。此外，虽然该应用程序稍后可能会成为跨平台，但我目前关心的是首先创建一个可靠的 Windows 版本。

**如何将本机 Git 二进制文件打包到基于 Windows Python 的应用程序中？**这是否需要我将 Git 安装程序与我的应用程序一起提供，或者是否有可以直接捆绑的便携式 Git 版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T06:00:17.960

[Dulwich](http://www.samba.org/~jelmer/dulwich/)是 Git 文件格式和协议的纯 Python 实现，可以在这里提供帮助。
你可以[在 GitHub 上找到它的 repo](https://github.com/jelmer/dulwich)。

# grails - 在 groovy 中显示名称而不是 id

> ID：11336861
> 
> 赞同：1
> 
> 时间：2012-07-05T01:21:15.603
> 
> 标签：grails, groovy

我正在开发一个项目，其中有两个表，`region`并且`district`. 在`region`我有：

```
+-------------+------------+------+-----+---------+----------------+
| Field       | Type       | Null | Key | Default | Extra          |
+-------------+------------+------+-----+---------+----------------+
| id          | bigint(20) | NO   | PRI | NULL    | auto_increment |
| name        | blob       | YES  |     | NULL    |                |
+-------------+------------+------+-----+---------+----------------+ 
```

在`district`我有：

```
+-------------+------------+------+-----+---------+----------------+
| Field       | Type       | Null | Key | Default | Extra          |
+-------------+------------+------+-----+---------+----------------+
| id          | bigint(20) | NO   | PRI | NULL    | auto_increment |
| name        | blob       | YES  |     | NULL    |                |
| region_id   | bigint(20) | NO   | MUL | NULL    |                |
+-------------+------------+------+-----+---------+----------------+ 
```

在 District 视图中，将显示该地区的名称，但不显示 Region 名称：

```
Id  1
Name    Community College
Description Community College
Homepage    
Logo    
Region  ctv.Region : 1
Streams 
```

这是`show`在`DistrictController`：

```
def show = {
        def districtInstance = District.get(params.id)

        if(!districtInstance){
            flash.message = "${message(code: 'default.not.found.message', args: [message(code: 'district.label', default: 'District'), params.id])}"
            redirect(action : "list")
        }
        else{
            [districtInstance : districtInstance]
        }
    } 
```

如何修改我的`show`闭包而不是显示`Region.id`我有的`region.name`？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T03:08:02.030

我假设您只是使用脚手架？所以尝试在 Region 中覆盖 toString()，例如

```
public String toString() {
   name
} 
```

# unit-testing - 在单元测试的 Row 属性中传递对象

> ID：11336862
> 
> 赞同：0
> 
> 时间：2012-07-05T01:21:36.417
> 
> 标签：unit-testing, c#-4.0, mbunit, gallio

我正在尝试将对象与单元测试的 Row 属性中的其他参数一起传递。

```
 [Row("Test1", new CustomField(), 3)]  // parameters MUST be string, object and int    
    public void Test_Constructor(string testType, CustomField customField, int num)
    {
       .....
    } 
```

但这会返回一个错误：

```
 An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter type. 
```

我怎样才能做到这一点....

# css - SASS - 如果浏览器是 IE，如何更改代码

> ID：11336864
> 
> 赞同：2
> 
> 时间：2012-07-05T01:21:40.160
> 
> 标签：css, internet-explorer, twitter, twitter-bootstrap, sass

我正在学习 SASS 并使用 twitter bootstrap

[http://twitter.github.com/bootstrap/base-css.html#buttons](http://twitter.github.com/bootstrap/base-css.html#buttons)

twitter 引导程序使用的是 Less，但我找到了 SASS 的翻译。

对于 .btn 有

```
 *border: 0; // Remove the border to prevent IE7's black border on input:focus 
```

但边框仍然存在，如果你看到 twitter 引导按钮，它们在 IE 下是可以的。他们是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T12:54:40.110

如果将边框从 1px 更改为 0px，则必须将 line-height 增加 2px。

```
.btn{
  *line-height: 20px;
 } 
```

你需要更精确：

*   “我找到了 SASS 的翻译。” 哪一个？
*   “...按钮他们在IE下没问题”哪个IE？

如果您尝试在 IE6 上设置透明边框，这可能会有所帮助：[IE6 问题 - 边框颜色：透明不工作](https://stackoverflow.com/questions/5714356/ie6-issue-border-colortransparent-not-working)

# c# - 如何使用c#以编程方式选择excel中的选项卡

> ID：11336869
> 
> 赞同：0
> 
> 时间：2012-07-05T01:22:59.323
> 
> 标签：c#, excel, com

当我在 excel 中打开工作簿时，它会转到我打开的最后一个选项卡和滚动位置。我想编写一些 c# 代码来打开 excel 工作簿并选择第一个选项卡，然后滚动到单元格 A1，所以当它打开时它将在那个工作表上。到目前为止我尝试的所有解决方案都产生了异常：

```
worksheet.Select(Type.Missing)
(worksheet as Excel._Worksheet).Activate();
excelApp.Goto(worksheet.get_range("A1", Type.Missing), true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T06:53:58.997

尝试：

```
Microsoft.Office.Interop.Excel.Worksheet firstSheet = (Microsoft.Office.Interop.Excel.Worksheet)excelApp.ActiveWorkbook.Worksheets[1];
firstSheet.Select(System.Reflection.Missing.Value);
excelApp.get_Range("$A1", hmissing).Select(); 
```

# c++ - 如何在 WTL 中删除指向无模式对话框的指针

> ID：11336873
> 
> 赞同：4
> 
> 时间：2012-07-05T01:23:23.387
> 
> 标签：c++, windows, user-interface, wtl

在 MainDlg 函数中

```
LRESULT CMainDlg::OnDo(WORD wNotifyCode, WORD wID, HWND hWndCtl, BOOL& bHandled)
{

    CMyDlg* dlg = new CMyDlg;// it could be CMainDlg member var
    //dlg.pMain = this; // i want to SendMessage(pMain.m_hWnd...) in CMyDlg...but it don't     
    //  work...
    dlg->Create(m_hWnd);
    dlg->ShowWindow(SW_SHOW);
    return 0;

} 
```

在 CMyDlg

```
 class CMyDlg : public CDialogImpl<CMyDlg>, public CUpdateUI<CMyDlg>,
public CMessageFilter, public CIdleHandler, 
public CWinDataExchange<CMyDlg>,
public CDialogResize<CMyDlg>

LRESULT CMyDlg::OnCancel(WORD /*wNotifyCode*/, WORD wID, HWND /*hWndCtl*/, BOOL&   /*bHandled*/)
{
    DestroyWindow();

 } 
```

所以 CMyDlg* dlg 指针将丢失......（内存泄漏）

我用谷歌搜索模型对话框。请注意 msdn.com 中的消息

[http://msdn.microsoft.com/en-us/library/zhk0y9cw(VS.80).aspx](http://msdn.microsoft.com/en-us/library/zhk0y9cw(VS.80).aspx)

注意：这个示例使用了一个非常简单的机制：它在 PostNcDestroy 中执行 delete this——一个在盒子的非客户区被销毁后调用的函数。

但那是在 MFC 中。我将它用于 WTL 。什么时候删除这个；它将被断言

```
virtual ~CWindowImplRoot()
{
  #ifdef _DEBUG
    if(m_hWnd != NULL)  // should be cleared in WindowProc
    {
        ATLTRACE(atlTraceWindowing, 0, _T("ERROR - Object deleted before window was destroyed\n"));
        ATLASSERT(FALSE);
    }
  #endif //_DEBUG
} 
```

所以：

删除指向无模式对话框的指针的正确方法是什么？

谢谢你的帮助！

完毕：

[http://tech.groups.yahoo.com/group/wtl/message/4444](http://tech.groups.yahoo.com/group/wtl/message/4444)

OnFinalMessage 是 WTL 的等价于 MFC 的 PostNCDestroy，你可以安全地让你的框架窗口“自杀”在那里 :)

```
void CSetRecordInfoDlg::OnFinalMessage( HWND /*hWnd*/ )
{
    delete this;
 } 
```

这样可行！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:52:23.527

OnFinalMessage 相当于 WTL 的 MFC 的 PostNCDestroy，你可以放心地让你的框架窗口“自杀”在那里。

参考： [http ://tech.groups.yahoo.com/group/wtl/message/4444](http://tech.groups.yahoo.com/group/wtl/message/4444)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:40:26.520

根据 MSDN 文档：

> *   [http://msdn.microsoft.com/en-us/library/6ex01tfy%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/6ex01tfy%28v=vs.80%29.aspx)
> 
> “默认处理程序调用 EndDialog 成员函数来关闭对话窗口。您也可以从自己的代码中调用 EndDialog...
> 
> “要安排关闭和删除无模式对话框，请覆盖 PostNcDestroy 并在 this 指针上调用 delete 运算符。”

# google-maps - 放大谷歌地图 API - 城市与国家不同

> ID：11336876
> 
> 赞同：3
> 
> 时间：2012-07-05T01:23:37.897
> 
> 标签：google-maps, google-maps-api-3

所以..我遇到了一个可能非常普遍的问题。

刚刚开始实施 google maps api，以下是我将城市解析为 lat/lang 并将地图居中的代码：

```
function SetMapAddress(address) {  // "London, UK" for example 
  var geocoder = new google.maps.Geocoder();
  if (geocoder) {
     geocoder.geocode({ 'address': address }, function (results, status) {
     if (status == google.maps.GeocoderStatus.OK) {
        var loc = results[0].geometry.location;
        document.map.setCenter(new google.maps.LatLng(loc.lat(),loc.lng(), 13));
     } 
```

问题是我正在通过静态缩放（13）。

如果有人键入一个国家/地区的名称，我想缩小更多。如果它是一个城市，我想放大更多等等。

我唯一能想到的就是为每个城市和国家找出适当的缩放，将它们存储在一些哈希中，并尝试找出正在使用的，以通过适当的缩放。

也许谷歌想到了一种更智能的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T02:37:13.047

地理编码器返回[“推荐”视口](https://developers.google.com/maps/documentation/javascript/reference#GeocoderGeometry)

您可以在 SetMapAddress 函数中使用它，如下所示：

```
 function SetMapAddress(address) {  // "London, UK" for example 
   var geocoder = new google.maps.Geocoder();
   if (geocoder) {
      geocoder.geocode({ 'address': address }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          document.map.fitBounds(results[0].geometry.viewport);
        }
      });
   }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:46:00.243

地理编码结果提供了包含查询的[地址组件类型](https://developers.google.com/maps/documentation/javascript/geocoding#GeocodingAddressTypes)`address_components`的数组。

从我非常有限的测试来看，查询中添加的信息越多，这个 address_components 数组就越长。进入“法国”时，只有以下几点：

```
> Object
long_name: "France"
short_name: "FR"

types: Array[2]
> 0: "country"
> 1: "political" 
```

添加城市时，有一个名为“locality”的类型。因此，您可以遍历此数组，检查 long_names 与用户输入的内容之间是否匹配，如果只输入城市或国家，这很容易，但可能有很多变化，例如罗马/罗马意大利（拼写差异） ，如果用户同时输入了城市和国家，则必须优先输入城市。

最后，这听起来像是一个非常模糊的搜索和匹配，即使您构建了自己的哈希来将用户输入与可能的地点表示相匹配。

这是我的懒惰方法：

创建`var mapZoom = 13;`（假设它是一个城市）

检查整个用户输入是否实际上是一个国家名称：如果它匹配一个 long_name 并且条目的类型是“国家”，则将 mapZoom 降低到 5。

使用此 mapZoom 变量应用 setCenter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-05T11:45:05.533

另一个（有时是有问题的）解决方案是计算 address_components 数组的长度。

正如 Tina CG Hoehr 在另一个答案中所提到的，places 对象有一个 address_components 数组。该数组包含地址的不同部分。

您可以测试 address_components 数组的长度并适当地设置缩放级别。

基于您的代码示例，

```
function SetMapAddress(address) {  // "London, UK" for example 
    var geocoder = new google.maps.Geocoder();
    if (geocoder) {
        geocoder.geocode({ 'address': address }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var loc = results[0].geometry.location;

            // Test address_components
            var ac_length = results[0].address_components.length;

            if (ac_length == 1) {
                // Assume country
                document.map.setCenter(new google.maps.LatLng(loc.lat(),loc.lng(), 3));

            } else if (ac_length == 2) {
                // Assume city
                document.map.setCenter(new google.maps.LatLng(loc.lat(),loc.lng(), 7));

            } else {
                // Everything else can have a standard zoom level
                document.map.setCenter(new google.maps.LatLng(loc.lat(),loc.lng(), 13));
            }

        }
    }
} 
```

这种方法*似乎*工作正常。在澳大利亚地址上对其进行测试，我发现一些郊区有邮政编码，而有些则没有——改变了数组的长度。那些没有邮政编码的人似乎在人口较少的地区，但因此对这些人进行较低的缩放对我的目的来说是合适的。

# php - 如何验证 Zend_Form_Element_File 或 Zend_Form_Element_Text 不为空。

> ID：11336877
> 
> 赞同：1
> 
> 时间：2012-07-05T01:23:43.623
> 
> 标签：php, forms, zend-framework, validation, zend-form

在我的表单中，我希望用户选择一个文件或输入它的 URL。两个选项之一。

我知道如何为两个 Zend_Form_Element_Text 元素之一编写验证器，但由于来自 Zend_Form_Element_File 的数据不在 $_POST 但在 $_FILES 我不知道从哪里开始 - 我无法从 Zend_Form_Element_File 获取数据我的自定义验证器的 isValid($value, $context = null) 方法中的 $context。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T19:17:00.933

如果文件已作为附加上下文上传到表单的验证方法，我能想到的一种可能方法是传递信息：

形式

```
$file = new Zend_Form_Element_File('file');

$text = new Zend_Form_Element_Text('text');
$text->setAllowEmpty(false);
$text->addValidator(new TextOrFileValidator());

$this->addElement($file);
$this->addElement($text); 
```

控制器

```
$request = $this->getRequest();

// provide additional context from the form's file upload status
$context = array_merge(
    $this->getRequest()->getPost(),
    array("isUploaded" => $form->file->isUploaded())
);

if ($request->isPost() && $form->isValid($context)) {
} 
```

验证器

```
class TextOrFileValidator extends Zend_Validate_Abstract
{

    const ERROR = 'error';

    protected $_messageTemplates = array(
        self::ERROR      => "You either have to upload a file or enter a text",
    );

    function isValid( $value, $context = null ) {

        $hasText = !empty($context['text']);
        $hasFile = $context['isUploaded'];

        if (($hasText && !$hasFile)
            || (!$hasText && $hasFile)
        ) {
            return true;
        }

        $this->_error(self::ERROR);
        return false;

    }
} 
```

# php - 带有 PHP 类的 HTTP 基本授权

> ID：11336879
> 
> 赞同：0
> 
> 时间：2012-07-05T01:24:00.067
> 
> 标签：php, class, curl

> **可能重复：**
> [如何使用带有 PHP curl 的 HTTP 基本身份验证发出请求？](https://stackoverflow.com/questions/2140419/how-do-i-make-a-request-using-http-basic-authentication-with-php-curl)

我正在使用 PHP Curl 类，`http://query7.com/php-curl`并且需要从具有基本身份验证的第三方服务提供商获取内容。

我不知道如何将我的身份验证详细信息（即用户名和密码）传递给上面指定的 curl 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:28:11.010

将最后一行添加到您的选项数组中：

```
public $options = array(
    CURLOPT_RETURNTRANSFER => true,     // return the web page
    CURLOPT_HEADER         => false,    // don't return the headers
    CURLOPT_FOLLOWLOCATION => true,     // follow redirects
    CURLOPT_USERAGENT      => "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.0.3705; .NET CLR 1.1.4322; Media Center PC 4.0)", // set a normal looking useragent
    CURLOPT_AUTOREFERER    => true,     // set referer on redirect
    CURLOPT_CONNECTTIMEOUT => 120,      // timeout
    CURLOPT_TIMEOUT        => 120,      // timeout
    CURLOPT_MAXREDIRS      => 10,       // stop after 10 redirects
    CURLOPT_USERPWD        => $username . ":" . $password // Basic auth
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:26:10.883

通常，您可以像这样将用户名和密码传递给域：

```
http://username:password@query7.com/php-curl 
```

# c++ - C++ - 文件 I/O 和字符数组

> ID：11336880
> 
> 赞同：0
> 
> 时间：2012-07-05T01:24:08.267
> 
> 标签：c++, io, arrays

以下是问题描述：

> 您学校的历史老师在对真/假测试评分时需要帮助。学生的 ID 和测试答案存储在一个文件中。文件中的第一个条目包含以下形式的测试答案：
> 
> TFFTFFTTTTFFTFTFTFTT
> 
> 文件中的每个其他条目都是学生 ID，后跟一个空白，然后是学生的回答。例如，条目：
> 
> ABC54301 TFTTFTTFTTFTTFTTFTTFT
> 
> 表示学号为 ABC54301，第 1 题的答案为真，第 2 题的答案为假，以此类推。这位学生没有回答第 9 题。考试有 20 道题，班级有 150 多个学生。每答对一题得两分，答错一题扣一分，不答题得零分。编写一个处理测试数据的程序。输出应该是学生的 ID，然后是答案，然后是考试成绩，然后是考试成绩。假设以下等级等级：90%–100%，A；80%–89.99%，乙；70%–79.99%，C；60%–69.99%，D；和 0%–59.99%，F。

这是我制作的程序：

```
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

int main()
{
//declaring variables
ifstream file("grading.txt");
char key[21];
char id[9];
char student[21];
int score = 0, i;

//initializing arrays
for(i=0; i<21; i++)
{
    key[i]=0;
    student[i]=0;
}
for(i=0; i<9; i++)
    id[i]=0;

//processing the key
file >> key;
file.ignore(100, "\n");

//processing student grades
while(file.good())
{

    file >> id;
    file.ignore();
    getline(file, student);
    file.ignore(100, "\n");

    //comparing key and student answer
    for(i=0; i<21; i++)
    {
        if(strcmp(student[i], key[i])
            score += 2;
        else
            score -= 1;
    }

    //outputing student id, score and grade
    cout << "Student ID: " << id;
    cout << "Score: " << score;
    score = (score/(40))*100;
    if(score >= 90 && score <= 100)
        cout << "Grade: A" << endl << endl;
    else if(score >= 80 && score <= 89.99)
        cout << "Grade: B" << endl << endl;
    else if(score >= 70 && score <= 79.99)
        cout << "Grade: C" << endl << endl;
    else if(score >= 60 && score <= 69.99)
        cout << "Grade: D" << endl << endl;
    else if(score >= 0 && score <= 59.99)
        cout << "Grade: F" << endl << endl;
    else
        cout << "Invalid percentage" << endl;
}

//closing file
file.close();

return 0;
} 
```

我似乎收到以下编译错误： http: [//pastebin.com/r0Y1xX8M](http://pastebin.com/r0Y1xX8M)（无法在此处正确编辑错误，抱歉）

编译错误以及有关如何解决此问题的任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:30:07.267

您应该将其`'\n'`用作分隔符 - 字符常量，而不是字符串文字`"\n"`。

的第二个参数的分隔符[`ignore`](http://www.cplusplus.com/reference/iostream/istream/ignore/)是 类型`int`的，可以隐式转换成字符常量；相反，字符串文字不能转换为`int`，所以这就是编译器告诉你的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:31:07.643

始终查找具有源文件和行号的位置。在这种情况下，您可以看到其中几个：

```
c:\users\haxtor\desktop\projects\lab 8 part 2 prob 6\lab 8 part 2 prob 6\problem 6.cpp(34) 
```

重要的部分是第`(34)`34 行有问题的说法。在这种情况下，第 34 行的问题是 student 是一个`char`数组而不是一个字符串，而第 35 行的问题是`"\n"`应该是`'\n'`. 可能还有更多问题。尝试找到其他提到行号的地方并自己修复它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T16:59:08.657

你的第一个问题是

```
file.ignore(100, "\n"); 
```

我相信您想使用`'\n'`单引号而不是双引号。单引号代表一个字符。双引号代表一个数组或字符（一个字符串）

其次，我认为iostream包含一个`string`类，它封装了字符数组。我相信`getline`使用那个字符串类。对于使用字符数组，我个人的偏好是[fscanf](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/)，但您的大部分代码似乎都基于 iostream，因此将字符数组更改为字符串可能是最简单的更改。

此外，您的`if(strcmp(student[i], key[i])`行正在传递字符而不是字符数组。我相信这`if(student[i] == key[i])`就是你想要做的。

您的编译错误会告诉您错误在哪一行代码，因此对于其余的代码，您可以查看您的代码并自己考虑问题。

# amazon-ec2 - 亚马逊 cron 时间不正确

> ID：11336886
> 
> 赞同：2
> 
> 时间：2012-07-05T01:24:58.220
> 
> 标签：amazon-ec2, amazon-web-services, crontab

我在 us-east-1 区域上运行带有**64 位 Amazon Linux的亚马逊 EC2 实例，并且****我已将用户 ec2-user 的 TZ 设置为 Australia/Sydney**。时间显示正确。然后我设置了 2 个 cron 任务来启动和停止东京的另一个亚马逊实例：

```
crontab -l
0 9 * * 1-5 python /home/ec2-user/scripts/instance.py demo ap-northeast-1 test-machine start > start.log
0 23 * * 1-5 python /home/ec2-user/scripts/instance.py demo ap-northeast-1 test-machine stop > stop.log 
```

我认为他们应该在**悉尼时间**周一至周五上午 9 点和晚上 11 点运行。但是今天早上我检查了日志，发现**start.log 的日期是 4 Jul 19:00 而 stop.log 是 5 Jul 9:00**。这看起来很奇怪。谁能给我一些建议？该脚本已经过测试，可以手动正确执行，只需几秒钟即可运行。

问候，布鲁斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:06:10.877

看起来您的脚本在正确的时间运行，**但**考虑到 UTC。7 月 4 日 9:00 GMT == 7 月 4 日 19:00 在悉尼 (GMT +10)，对吧？请验证您的 cron 设置。[这里](https://askubuntu.com/questions/54364/how-do-you-set-the-timezone-for-crontab)有一些提示。

# login - Jomsocail 成功登录

> ID：11336889
> 
> 赞同：1
> 
> 时间：2012-07-05T01:25:24.213
> 
> 标签：login, joomla, social, joomla2.5

只想问我在哪里可以找到确定Jomsocial 登录的php 文件。我想添加一个简短的脚本以在成功登录后运行。我找到了默认的 Joomla 登录，但它与 Jomsocial 登录不同（显然）。

```
 Can someone please help me. Much appreciated. 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T07:08:42.550

我们有同样的问题，我找到了！

通过对模块、插件和 JomSocial 组件的所有窥探，我认为这种访问应该是某种模型。我想我是对的。

该文件可以在`root\components\com_users\controllers\`目录中找到，php 文件是`user.php`. 那里有一个函数调用`login()`，并且在第 58 行附近的底部有一个 if 语句，用于确定登录是否成功。所以我在那里插入了我的代码。

# python - 提取一定数量字符之间的所有完整单词

> ID：11336890
> 
> 赞同：1
> 
> 时间：2012-07-05T01:25:27.953
> 
> 标签：python, string

我想提取一段文本并从给定数量的字符中提取尽可能多的单词。我可以使用哪些工具/库来完成此任务？

例如，在[给定](http://www.engadget.com/2012/07/04/nikon-d4-firmware-1-02/)的文本块中：

```
Have you managed to get your hands on Nikon's elusive D4 full-frame DSLR? 
It should be smooth sailing from here, with the occasional firmware update being 
your only critical acquisition going forward. D4 firmware 1.02 brings a handful of 
minor fixes, but if you're in need of any of the enhancements listed below, it's 
surely a must have: 
```

如果我将它分配给一个字符串，然后 make `string = string[0:100]`，那将得到前 100 个字符，但是“sailing”这个词将被截断为“sailin”，我希望文本被截断在“航行”之前的空格之前或之后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:33:34.070

使用正则表达式：

```
>>> re.match(r'(.{,100})\W', text).group(1)
"Have you managed to get your hands on Nikon's elusive D4 full-frame DSLR? It should be smooth" 
```

这种方法可以让您搜索单词之间的任何标点符号（不仅是空格）。它将匹配 100 个或更少的字符。

为了处理小字符串，以下正则表达式更好：

```
re.match(r'(.{,100})(\W|$)', text).group(1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:33:27.123

如果您真的只想在空格上断开字符串，请使用以下命令：

```
my_string = my_string[:100].rsplit(None, 1)[0] 
```

但请记住，您实际上可能想要的不仅仅是空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T01:28:35.353

如果有的话，这将在前 100 个字符的最后一个空格处将其切断。

```
lastSpace = string[:100].rfind(' ')
string = string[:lastSpace] if (lastSpace != -1) else string[:100] 
```

# javascript - 延迟在 JavaScript 中加载，Jquery 'ready()' 在加载 JQuery 之前运行

> ID：11336894
> 
> 赞同：1
> 
> 时间：2012-07-05T01:26:25.303
> 
> 标签：javascript, jquery, deferred-loading

我正在加载两个 JS 文件，一个包含许多插件，包括 Jquery。'ready()' JQuery 函数在第二个文件中。

代码：

```
 function downloadJSAtOnload() {

       var element = document.createElement("script");
       element.src ='<%= deferJsAll %>';
       document.body.appendChild(element);

      // second JS file load with isReady goes here
   }

   // Check for browser support of event handling capability
   if (window.addEventListener)
       window.addEventListener("load", downloadJSAtOnload, false);
   else if (window.attachEvent)
       window.attachEvent("onload", downloadJSAtOnload);
   else window.onload = downloadJSAtOnload; 
```

您可以看到我何时还加载了第二个文件（请参阅代码中的注释）。

问题是我无法控制执行顺序，即便如此，'ready()' 在加载 JQuery 之前运行，我得到一个错误。是否可以选择使用延迟加载并确保首先加载 Jquery 文件，然后执行第二个文件（具有 ready() 函数的那个​​）？

我正在使用“<%= deferJsAll %>”，因为我正在决定从 CDN、gzip 或纯文本 JS 文件提供哪个文件。

进展：我想把：

```
var elementApp = document.createElement("script");
elementApp.src = 'js/app.js';
document.body.appendChild(elementApp); 
```

在第一个文档的末尾。所以当第一个文档完成加载后，它会将第二个依赖的 JS 代码嵌入到文档的正文中。你认为这是个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:34:09.103

您可以使用 onload 和 onreadystatechange（对于 IE）来检测脚本何时完成加载。

```
function loadScript(callback){
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src = '<%= deferJsAll %>';
  document.body.appendChild(script);

  // exit on jQuery load.
  script.onload = function(){ callback(); };
  script.onreadystatechange = function() {
    if (this.readyState == 'complete') callback();
  }
}

loadScript(function(){
  $.getScript('<% jquery-dependent.js %>', function(){
     // jquery-dependent.js is loaded
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:40:20.787

这是我需要等到页面上的某个 var 存在时使用的解决方案。它需要一个名称（例如`jQuery`，具有任意深度的名称空间`twttr.widgets`）和其他不言自明的属性。当我需要等到 Facebook 和 Twitter 小部件加载时，可以在[http://www.vitalmtb.com/上进行生产。](http://www.vitalmtb.com/)

```
// Wait till JS object is loaded. It can be a chanined variable name.
window.whenAvailable = function (name, callback, interval, max_wait) {
    interval || (interval = 50); // ms
    max_wait || (max_wait = 5000); // ms
    var timer,
        findVarByName = function(name) {
        var index = 0,
            parts = name.split('.'),
            result = window;

        index = 0;
        try {
            while (typeof result !== "undefined" && result !== null && index < parts.length) {
                result = result[parts[index++]];
            }
        }
        catch (e) {}
        if (index < parts.length || (typeof result == 'undefined' && result === undefined)) return false;
        else return true;
    };

    timer = window.setTimeout(function() {
        if (findVarByName(name)) {
            return callback();
        } else {
            window.setTimeout(arguments.callee, interval);
        }
    }, interval);

    window.setTimeout(function() {
        clearTimeout(timer);
    }, max_wait);
} 
```

采用：

```
whenAvailable('FB', $j.spotlights.a.show_social_buttons);
whenAvailable('twttr.widgets', $j.spotlights.b.show_social_buttons); 
```

# ios - 如何将商店中的 iOS 应用程序限制为仅限 4S 和 iPad 3

> ID：11336896
> 
> 赞同：6
> 
> 时间：2012-07-05T01:27:27.503
> 
> 标签：ios, app-store

我的 iOS 应用程序很耗 CPU。它在 iPhone 4S 上运行良好，在新 iPad 上运行更好。但在 iPhone 4 上，它提供了糟糕的用户体验，我想以某种方式禁用 4S 下的任何东西以从应用商店下载我的应用。我已经强制要求 amrv7 但这意味着任何拥有 3GS 及以上的人都可以安装它。我想强制要求双核 Cortex A9，因为我使用两个线程来获得所需的速度。

[http://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW3](http://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW3)似乎没有列出我想要的东西。最接近的是`bluetooth-le`，我相信它只存在于较新的设备上。有更好的想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:47:15.243

不确定是否有办法在包含 4S 的同时排除 iPhone 4，但您可以通过`front-facing-camera`Info.plist 中的要求将您的应用程序配置为仅在 iPhone 4 及更高版本和 iPad 2 及更高版本上运行。

当然，这样的更改只能对新应用程序进行，因为 Apple 禁止限制 App Store 中已有应用程序的硬件要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T17:08:33.527

Apple 似乎不鼓励那些 CPU 如此饥渴以至于它们不能在仍在销售的高端设备上运行的应用程序。因此，如果您的应用不需要它们，列出蓝牙或前置摄像头，可能会导致应用被拒绝。

最好的办法可能是提高您的应用程序的性能，或者编辑您的应用程序的描述，并在突出位置列出良好性能的要求，并吃掉无法阅读的客户的差评和评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T17:20:11.743

也许尝试限制旧设备不支持的新 iOS 版本。这仍然不适用于所有设备。在上传您的应用程序时，您必须写下它是一个要求苛刻的应用程序。并且只能在新设备上使用

# jquery - jQuery Animate 和“easeOutBounce”的问题

> ID：11336898
> 
> 赞同：1
> 
> 时间：2012-07-05T01:27:53.620
> 
> 标签：jquery, jquery-animate

我希望有人可以帮助我使用以下脚本：

```
jQuery(document).ready(function($) {
  $(".infoBoxBtn a").click(function(e){
      e.preventDefault();
      $("#info-box").animate({marginTop: '67px'}, 2000, 'easeOutBounce');

      $(".infoBoxBtn a").addClass("active");
  });

  $(".infoBoxBtn a.active").click(function(e){
      e.preventDefault();
      $("#info-box").animate({marginTop: '-434px'}, 2000, 'easeOutBounce');

      $(".infoBoxBtn a").removeClass("active");
  });

});//end 
```

这是我在 Safari 中遇到的错误：

```
TypeError: 'undefined' is not a function (evaluating 'f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration)') 
```

我在 jQuery API 网站上阅读了有关 jQuery Animate 的文章，但我不知道我在这里做错了什么。

谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T01:48:44.797

关于您的原始答案 - 您需要加载[jQuery UI 效果](http://jqueryui.com/download/)库。

关于结束动画，我会重构您的代码以检查每次单击锚点以检查当前状态。

考虑这段代码：

```
$(function() {
  $('.infoBoxBtn a').on('click', function (e) {
    e.preventDefault();
    t = $(this);
    if (t.hasClass('active')) {
      margin_top = '-434px';
    }
    else {
      margin_top = '67px';
    }

    $('#info-box').stop(true, true).animate({ marginTop : margin_top }, 2000, 'easeOutBounce');
    t.toggleClass('active');
  });
}); 
```

我改变了几件事：

*   使用[.on()](http://api.jquery.com/on/)而不是 bind()/click()
*   使用 .hasClass() 和 .toggleClass()
*   使用[.stop()](http://api.jquery.com/stop/)清除之前的动画并跳转到最后。

# zend-framework - Doctrine 2 单次计算异常错误

> ID：11336911
> 
> 赞同：3
> 
> 时间：2012-07-05T01:30:05.927
> 
> 标签：zend-framework, doctrine, doctrine-orm

我一直在尝试使我的学说 2 设置为模块化结构。尝试创建实体时收到此错误：

```
Entity has to be managed for single computation Entities\User@0000000078d19339000000004266cb59 
```

代码：

```
/* Test Doctrine */
        $em = Zend_Registry::get('em');
        $user = new Entities\User();
        $user->name = "Bob";
        $user->username = "bob";
        $user->email = "bob@live.com";
        $user->password = "test";
        $user->activation = "";
        $em->flush($user);
        $em->persist(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T02:39:54.323

可恶...

我自己都尴尬了！这是一个黄金法则问题...

修复：

```
/* Test Doctrine */
        $em = Zend_Registry::get('em');
        $user = new Entities\User();
        $user->name = "Bob";
        $user->username = "bob";
        $user->email = "bob@live.com";
        $user->password = "test";
        $user->activation = "";
        $em->persist($user); // The other way around :D
        $em->flush(); 
```

# symfony - AzureDistributionBundle 能否与 AsseticBundle 配合使用？

> ID：11336917
> 
> 赞同：0
> 
> 时间：2012-07-05T01:31:43.697
> 
> 标签：symfony, azure, azure-web-roles

我非常有兴趣亲自动手在 Windows Azure 上运行 Symfony2 应用程序。我试过但没有运气。最近我发现了 AzureDistributionBundle，它可以自动配置 Symfony2 以与 Windows Azure 配合使用。

但我很怀疑，如果我将它与 Assetic、Lesscss、yuicompressor 等一起使用它会不会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:58:18.350

默认情况下，打包过程配置为从本地网络服务器提供资产（例如图像、样式表、javascript），您的答案是**YES**。如果配置 Azure Blob 存储帐户，则可以将其更改为自动部署到 Azure Blob。

这为您的资产提供了更好的性能 (CDN) 和更好的流量条件。

若要使用 Azure 博客存储，请将以下配置添加到 config.yml：

```
windows_azure_distribution:
    assets:
        type: blob
        accountName: acc
        accountKey: pw1 
```

在打包过程中，Azure 分发包会将所有资产复制到 Azure Blob 存储中，并按当前内部版本号进行版本控制。这样，暂存/生产中不同版本之间的不同资产将永远不会相互影响。

如果您不再需要这些旧版本容器，请确保清理您的存储帐户并删除它们。

可以在以下位置找到更多信息：http: [//beberlei.github.com/AzureDistributionBundle/](http://beberlei.github.com/AzureDistributionBundle/)

# spring - web.xml 中的 PropertyPlaceholders

> ID：11336918
> 
> 赞同：2
> 
> 时间：2012-07-05T01:31:51.617
> 
> 标签：spring, configuration, java-ee-6, placeholder

我正在使用以下内容：

*   春天 3.1
*   Java EE 6 (GlassFish 3.1.2)
*   用于项目构建等的 Maven
*   Ant 实时部署

我们有一堆工作环境：DEV、UAT、TRAINING、PROD 等。在我们的 TRAINING 环境中，已向我提出了将会话超时时间延长到 8 小时的请求。在所有其他环境中为 2 小时。我想做的只是在`web.xml`. 但我认为这是不可能的：

```
<session-config>
    <session-timeout>${session.timeout}</session-timeout>
</session-config> 
```

我想到的解决方案是：

1.  使用 Maven 过滤——我**真的**不想这样做。这将意味着一场单独的训练战。
2.  删除会话超时`web.xml`并将 TRAINING 中的 GlassFish 配置为 8 小时后超时 - 我不太喜欢这样，因为我更愿意让我们所有的环境保持纯净和同步。
3.  在一些初始化代码中手动设置它。呸。

我应该提到我们使用`<env>.properties`文件来配置网络应用程序。使用 VM 参数选择属性文件。

谁能想到另一个更好的解决方案？

在此先感谢，穆尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T09:33:16.660

如果你可以在一些初始化代码中设置它，那么你就可以从 spring 中获取它。web.xml 是首先读取的内容，因此无法对其进行预处理。

那么为什么不这样做创建一些“手动初始化代码”，这些代码与从 spring 加载会话超时的战争一起部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T09:50:20.437

在 SO 上查看这个[问题](https://stackoverflow.com/questions/2960764/how-to-set-session-timeout-dynamically-in-java-web-applications)，可以有两种方法，但不确定 -

1.  您可以为每个环境使用不同的 web.xml 文件，并使用相应的 web.xml 构建 war 文件。这是完全可能的。

2.  您可以使用自定义`HttpSessionListener`，如上面的链接所示。虽然它从硬编码值设置了会话超时，但我会尝试从 servlet 访问上下文初始化参数，例如

    ```
    Session().getServletContext().getInitParameter("paramName"); 
    ```

并将为不同的环境定义具有不同会话超时值的初始化参数。我没有测试过这段代码，所以不确定你是否得到上下文参数。

# r - 查找向量中重复或不在另一个向量中的元素

> ID：11336921
> 
> 赞同：4
> 
> 时间：2012-07-05T01:32:38.917
> 
> 标签：r, match

我有以下情况：

```
vec1  <- c("A", "B", "D", "C", "E", "A", "C")
vec2 <- c("A", "B", "C", "D", "F") 
```

第一个问题：哪个是重复的？- 对 vec1 回答“A”和“C”，对 vec2 回答 0

第二个问题：确定哪个是 vec1 但不在 vec2 中，无论顺序如何（答案“E”）

反之亦然（回答“F”）

```
which(vec1 !=vec2)
which(vec2 !=vec1)

[1] 3 4 5 7
Warning message:
In vec1 != vec2 :
  longer object length is not a multiple of shorter object length 
```

这不是我所期望的......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:40:49.583

对于第一个问题，尝试`?duplicated`

```
vec1.dup <- duplicated(vec1)
unique(vec1[vec1.dup])

[1] "A" "C" 
```

对于第二个，尝试`?setdiff`. 您想要 vec2 的值不在 vec1 中。

```
setdiff(vec2, vec1)
[1] "F" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T01:38:51.383

vec1 中重复的元素：

```
vec1[duplicated(vec1)]

[1] "A" "C" 
```

vec1 中不在 vec2 中的元素：

```
vec1[is.na(match(vec1,vec2))]

[1] "E" 
```

反之亦然：

```
vec2[is.na(match(vec1,vec2))]

[1] "F" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T02:58:03.897

看来您的（第二个）问题是..为什么？（我确实看到你已经得到了正确的答案......如何？）

```
which(vec1 !=vec2)
which(vec2 !=vec1) 
```

两者都返回

```
[1] 3 4 5 7 
```

答案主要在您未包含的警告消息中：

```
Warning message:
In vec1 != vec2 :
  longer object length is not a multiple of shorter object length 
```

当像“！=”这样的二元运算符在向量上工作时，回收规则会接管，因此两个向量中较长的向量决定了比较的“范围”，而较短的向量通过回收得到扩展。你最终测试：

```
> c("A", "B", "C", "D", "F", "A", "B") != c("A", "B", "D", "C", "E", "A", "C")
                                         #.... extending shorter one ^^^^^^^
[1] FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
> c("A", "B", "D", "C", "E","A", "C") !=  c("A", "B", "C", "D", "F", "A", "B")
#.... extending shorter one ^^^^^^^
[1] FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE 
```

# caching - Backbone.Collection 预取和缓存

> ID：11336922
> 
> 赞同：1
> 
> 时间：2012-07-05T01:33:09.433
> 
> 标签：caching, backbone.js, prefetch

是否有任何推荐的库、模式或示例说明如何在 a 上实现预取和/或缓存`Backbone.Collection`？例如，我想在具有不同视图模式（例如日、周、月）的日历中显示事件。我认为最好一次查询一次数据库/API，比如 1-3 个月，以避免太多的网络请求，即使我在周视图中也是如此。

然后我认为缓存接收到的数据是有益的（当用户不断分页时，它会更快），这很容易，但我还需要以某种方式确定要清除什么以及在什么时候清除。在 PHP 中有 PHP APC、XCache 等想知道 JS 中是否有类似的东西。还是我在服务器端这样做？对于工作，它是一个 Java 服务器，但我现在对 NodeJS 也很感兴趣

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:36:24.270

[这](http://ricostacruz.com/backbone-patterns/)可能会回答您的一些问题。收集构建主干应用程序的良好实践以及应避免的陷阱。根据主题分组（模型、视图、模板...）

# git - 如果我意识到我应该在五次提交前提交编辑怎么办？

> ID：11336925
> 
> 赞同：1
> 
> 时间：2012-07-05T01:33:28.247
> 
> 标签：git, debugging, commit

这对我来说是一个常见的问题。我做了五次左右的提交，然后发现一些变得无关紧要的调试代码或来自先前使用的算法的垃圾代码仍然存在。将它们修改为 HEAD 并不总是有意义的，并且为单行后期更改做出新的提交会让人感到无序。

我知道的解决方案包括上述内容并再次检查以前的提交、分支、编辑和合并。这很好用，但我想知道是否存在更惯用或更优雅的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:45:23.680

您可以使用交互式变基返回并编辑特定的提交，只要重写历史是可以的（基本上，只要您没有与其他任何人/公众共享提交）。

为此，首先找到要编辑的提交的哈希。然后，告诉 Git 从之前的提交中进行交互式变基：

```
git rebase -i <SHA>~1 
```

这`~1`很重要 - 它告诉 Git 在您指定的 SHA 之前引用提交。

这将打开一个编辑器，其中包含从您要编辑的提交开始的每个提交。将该提交更改`pick`为`edit`，然后保存并退出编辑器。

Git 将应用该提交，然后暂停。然后，您可以编辑文件以删除调试代码，`git add`然后`git commit --amend`编辑提交。

之后，使用`git rebase --continue`按顺序应用其他提交，最终回到您开始的位置（但使用一组没有您的调试代码的新提交）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:37:30.453

如果您还没有推送或拉出，您可以使用 rebase。

[用 rebase 压扁](http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html)

# git - Xcode 中的源代码库可靠吗？

> ID：11336932
> 
> 赞同：1
> 
> 时间：2012-07-05T01:34:59.337
> 
> 标签：git, xcode4

当我向我的项目添加一些新文件时（我已经为这个项目创建了一个源存储库），这些文件根本不会添加到源存储库中。我浏览了整个项目，发现有些文件在存储库中，但有些不在。为什么这样？如何解决问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T01:45:26.417

Xcode 使用 git（默认）来管理版本控制。默认情况下，git 不会跟踪新添加的文件。要将它们添加到 git，请右键单击它们，然后单击 Source Control>Add。要提交更改，请转到 File>Source Control>Commit...（或 Command-Option-C）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T05:58:41.597

查看[XCode 文档](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/Xcode4UserGuide/SCM/SCM.html)，同时检查那些非版本化文件的状态。

![状态](../Images/dd61d2fe1f428bd4be1938c00523c4ef.png)

其中一些可能会被您的源代码控制工具（SVN 或 git）忽略，例如，[`.gitignore`您可以添加到您的项目中](https://stackoverflow.com/questions/3258638/apply-git-gitignore-rules-to-an-existing-repository)（或像[这个](http://www.codedifferent.com/2011/05/01/coding-gitignore-for-xcode-4/)）。

# c# - C#结构的自动深拷贝

> ID：11336935
> 
> 赞同：15
> 
> 时间：2012-07-05T01:35:52.850
> 
> 标签：c#, struct, deep-copy, default-copy-constructor

我有一个结构，`MyStruct`它有一个私有成员`private bool[] boolArray;`和一个方法`ChangeBoolValue(int index, bool Value)`。

我有一个类，`MyClass`有一个字段`public MyStruct bools { get; private set; }`

当我从现有对象创建新的 MyStruct 对象，然后应用方法 ChangeBoolValue() 时，两个对象中的 bool 数组都发生了更改，因为引用而不是引用的内容被复制到了新对象。例如：

```
MyStruct A = new MyStruct();
MyStruct B = A;  //Copy of A made
B.ChangeBoolValue(0,true);
//Now A.BoolArr[0] == B.BoolArr[0] == true 
```

有没有办法强制副本实现更深的副本，或者有没有办法实现这个不会有同样的问题？

我专门将 MyStruct 设为结构，因为它是值类型，并且我不希望引用传播。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-05T02:09:21.933

运行时执行结构的快速内存复制，据我所知，不可能为它们引入或强制您自己的复制过程。您可以引入自己的`Clone`方法，甚至是复制构造函数，但您不能强制他们使用它们。

如果可能的话，您最好的选择是使您的结构不可变（或不可变类）或重新设计以避免此问题。如果您是 API 的唯一消费者，那么也许您可以保持额外的警惕。

Jon Skeet（和其他人）已经描述了这个问题，尽管可能有例外，但一般来说：可变结构是邪恶的。 [结构可以包含引用类型的字段吗](https://stackoverflow.com/questions/945664/can-structs-contain-references-to-reference-types-in-c-sharp/945708#945708)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T01:39:51.610

制作（深度）副本的一种简单方法，虽然不是最快的（因为它使用反射），但用于`BinaryFormatter`将原始对象序列化为 a `MemoryStream`，然后将其反序列化为`MemoryStream`new `MyStruct`。

```
 static public T DeepCopy<T>(T obj)
    {
        BinaryFormatter s = new BinaryFormatter();
        using (MemoryStream ms = new MemoryStream())
        {
            s.Serialize(ms, obj);
            ms.Position = 0;
            T t = (T)s.Deserialize(ms);

            return t;
        }
    } 
```

适用于类和结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T01:58:02.800

作为一种解决方法，我将执行以下操作。

结构中有 2 个方法可以修改`BoolArray`. 而不是在复制结构时创建数组，而是在调用更改它时重新创建 BoolArray，如下所示

```
public void ChangeBoolValue(int index, int value)
{
    bool[] Copy = new bool[4];
    BoolArray.CopyTo(Copy, 0);
    BoolArray = Copy;

    BoolArray[index] = value;
} 
```

尽管这对于涉及 BoolArray 的大量更改的任何用途都是不利的，但我对结构的使用是大量的复制，并且几乎没有更改。这只会在需要更改时更改对数组的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T20:31:49.363

为了避免奇怪的语义，任何包含可变引用类型字段的结构都必须做以下两件事之一：

1.  应该非常清楚的是，从它的角度来看，字段的内容不是用来“持有”一个对象，而只是识别一个对象。例如，`KeyValuePair<String, Control>` 将是一个完全合理的类型，因为尽管 `Control` 是可变的，但这种类型引用的控件的*标识*将是不可变的。
2.  可变对象必须是由值类型创建的，永远不会暴露在它之外。此外，任何将对不可变对象执行的突变都必须在对该对象的引用存储到结构的任何字段之前执行。

正如其他人所指出的那样，允许结构模拟数组的一种方法是让它保存一个数组，并在修改元素时制作该数组的新副本。当然，这样的事情会非常缓慢。另一种方法是添加一些逻辑来存储最后几个突变请求的索引和值；每当尝试读取数组时，检查该值是否是最近写入的值之一，如果是，则使用存储在结构中的值而不是数组中的值。一旦结构中的所有“槽”都被填满，就复制一个数组。如果更新触及许多不同的元素，这种方法充其量“仅”提供恒定的加速而不是重新生成数组，但如果绝大多数更新触及少数元素，则可能会有所帮助。

当更新可能具有很高的特殊集中度，但命中太多元素以使它们完全适合结构时，另一种方法是保留对“主”数组的引用，以及“更新”数组以及一个整数，指示“更新”数组代表主数组的哪一部分。更新通常需要重新生成“更新”数组，但这可能比主数组小得多；如果“更新”数组变得太大，则可以重新生成主数组，其中包含由“更新”数组表示的更改。

任何这些方法的最大问题是，虽然`struct`可以以呈现一致的值类型语义同时允许有效复制的方式进行设计，但看一下结构的代码很难看出这一点（与普通旧的相比） -data 结构，其中结构有一个称为公共字段的事实`Foo`非常清楚`Foo`将如何表现）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-31T16:12:58.163

通过时复制结构吗？所以：

```
public static class StructExts
{
    public static T Clone<T> ( this T val ) where T : struct => val;
} 
```

用法：

```
var clone = new AnyStruct ().Clone (); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-08T23:29:55.647

我正在考虑与值类型相关的类似问题，并找到了一个“解决方案”。您会看到，您*不能*像在 C++ 中那样更改 C# 中的默认复制构造函数，因为它旨在实现轻量级且无副作用。但是，您可以做的是等到您实际访问该结构，然后检查它是否被复制。

这样做的问题是，与引用类型不同，结构没有真正的身份。只有按值相等。但是，它们仍然必须存储在内存中的某个位置，并且该地址可用于标识（尽管是暂时的）值类型。GC 在这里是一个问题，因为它可以移动对象，因此会更改结构所在的地址，因此您必须能够应对这种情况（例如，将结构的数据设为私有）。

在实践中，结构的地址可以从`this`引用中获得，因为它`ref T`在值类型的情况下很简单。我留下了从对我的库的引用中获取地址的[方法](https://github.com/IllidanS4/SharpUtils/blob/49fe353facb12ded8ad3c1d4f4e06b800ed4bad4/Unsafe/UnsafeTools.cs#L230)，但是为此发出自定义 CIL 非常简单。在这个例子中，我创建了一个本质上是一个 byval 数组的东西。

```
public struct ByValArray<T>
{
    //Backup field for cloning from.
    T[] array;

    public ByValArray(int size)
    {
        array = new T[size];
        //Updating the instance is really not necessary until we access it.
    }

    private void Update()
    {
        //This should be called from any public method on this struct.
        T[] inst = FindInstance(ref this);
        if(inst != array)
        {
            //A new array was cloned for this address.
            array = inst;
        }
    }

    //I suppose a GCHandle would be better than WeakReference,
    //but this is sufficient for illustration.
    static readonly Dictionary<IntPtr, WeakReference<T[]>> Cache = new Dictionary<IntPtr, WeakReference<T[]>>();

    static T[] FindInstance(ref ByValArray<T> arr)
    {
        T[] orig = arr.array;
        return UnsafeTools.GetPointer(
            //Obtain the address from the reference.
            //It uses a lambda to minimize the chance of the reference
            //being moved around by the GC.
            out arr,
            ptr => {
                WeakReference<T[]> wref;
                T[] inst;
                if(Cache.TryGetValue(ptr, out wref) && wref.TryGetTarget(out inst))
                {
                    //An object is found on this address.
                    if(inst != orig)
                    {
                        //This address was overwritten with a new value,
                        //clone the instance.
                        inst = (T[])orig.Clone();
                        Cache[ptr] = new WeakReference<T[]>(inst);
                    }
                    return inst;
                }else{
                    //No object was found on this address,
                    //clone the instance.
                    inst = (T[])orig.Clone();
                    Cache[ptr] = new WeakReference<T[]>(inst);
                    return inst;
                }
            }
        );
    }

    //All subsequent methods should always update the state first.
    public T this[int index]
    {
        get{
            Update();
            return array[index];
        }
        set{
            Update();
            array[index] = value;
        }
    }

    public int Length{
        get{
            Update();
            return array.Length;
        }
    }

    public override bool Equals(object obj)
    {
        Update();
        return base.Equals(obj);
    }

    public override int GetHashCode()
    {
        Update();
        return base.GetHashCode();
    }

    public override string ToString()
    {
        Update();
        return base.ToString();
    }
} 
```

* * *

```
var a = new ByValArray<int>(10);
a[5] = 11;
Console.WriteLine(a[5]); //11

var b = a;
b[5]++;
Console.WriteLine(b[5]); //12
Console.WriteLine(a[5]); //11

var c = a;
a = b;
Console.WriteLine(a[5]); //12
Console.WriteLine(c[5]); //11 
```

如您所见，此值类型的行为与每次复制对数组的引用时都将底层数组复制到新位置一样。

**警告！！！**使用此代码需要您自担风险，最好不要在生产代码中使用。这种技术在很多层面上都是错误和邪恶的，因为它假定了不应该拥有它的东西的身份。尽管这试图为这个结构“强制”值类型语义（“最终证明手段”），但在几乎*任何*情况下，对于实际问题肯定有更好的解决方案。另请注意，尽管我已尝试预见任何可预见的问题，但在某些情况下，这种类型会表现出非常意外的行为。

# java - 我只需要将它插入数据库一次

> ID：11336936
> 
> 赞同：0
> 
> 时间：2012-07-05T01:35:58.683
> 
> 标签：java, mysql, database, jdbc

这是我的代码。问题是它根据循环中的行数插入数据库，而不是只插入一次。如代码所示，它从文件中获取行数，并尝试提取一些信息以存储在数据库中。例如，如果该行有 5 行，则它将该信息在数据库中存储 5 次。

```
import java.io.File;
import java.io.IOException;
import java.sql.*;
import java.util.List;
import org.apache.commons.io.FileUtils;

public class Movie_Info {

    private static String user = "root";
    private static String pw = "";
    private static String dbUrl = "jdbc:mysql://127.0.0.1/NLD";
    private static String dbClass = "com.mysql.jdbc.Driver";

    public static String scraped_commentsInsert 
        = "INSERT INTO scraped_comments (id, movie_title,user_comments) VALUES (?,?,?)";

    private Connection con;
    private Statement st;
    private PreparedStatement multiInsert; 

    public Movie_Info(String id, String movie) throws IOException, SQLException{

        try {
            Class.forName(dbClass);
            con = DriverManager.getConnection(dbUrl, user, pw);
            //con.setAutoCommit(false);
            st=con.createStatement();
        } catch (Exception e) {
            System.out.println(e.getMessage());
            return;
        }

        List lines = null;

        try{
            lines = FileUtils.readLines(new File(movie+"_S1.txt"), "UTF-8");
        } catch(Exception ex) {
            System.out.println("movie file does not exist: " + movie + " id: " + id);
            return;
        }

        for (Object line : lines) {
            String Synopsis = line.toString();
            String Released = line.toString();
            String Runtime = line.toString();
            String Genre = line.toString();
            String Director = line.toString();
            String Actors = line.toString();

            if (String.valueOf(line).startsWith("Synopsis ") ) {
                // for quotes
                Synopsis = Synopsis.replace(":", " storyline goes like this. ");
                Synopsis = Synopsis.replace("'", "  ");
                // remove comment
                Synopsis = Synopsis.replace("Synopsis  ", "");
                System.out.println(Synopsis);
            }

            if ( String.valueOf(line).startsWith("Released: ") ) {
                Released = Released.replace("'", "''");
                Released = Released.replace("Released:  ", "");
                System.out.println(Released);
            }

            if (String.valueOf(line).startsWith("Runtime: ")) { 
                Runtime = Runtime.replace("'", "''");
                Runtime = Runtime.replace("Runtime:  ", "");
                System.out.println(Runtime);
            }

            if (String.valueOf(line).startsWith("Genres: ") ) { 
                Genre = Genre.replace("'", "''");
                Genre = Genre.replace("Genre:  ", "");
                System.out.println(Genre);
            }

            if (String.valueOf(line).startsWith("Director: ") ) { 
                Director = Director.replace("'", "''");
                Director = Director.replace("Director:  ", "");
                System.out.println(Director);
            }

            if (String.valueOf(line).startsWith("Actors: ") ) { 
                Actors = Actors.replace("'", " ");
                Actors = Actors.replace("Actors:  ", "");
                System.out.println(Actors);
            } // end if

            // int k= st.executeUpdate("INSERT INTO Movie_Infor ( Release_Date,movie_title,Synopsis, Runtime, Genres, Director, Actors) values('"+Released+"','"+movie+"','"+Synopsis+"','"+Runtime+"','"+Genre+"','"+Director+"','"+Actors+"')");
        } // end for

        con.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:53:33.250

首先，请尝试发布一个*简洁*的代码示例......整个课程真的没有必要。

问题在于您的 for 循环：

```
for (Object line : lines) {
    String Synopsis = line.toString();
    String Released = line.toString();
    String Runtime = line.toString();
    String Genre = line.toString();
    String Director = line.toString();
    String Actors = line.toString();
    ...
} 
```

在这里，您将*同一行*的字符串值分配给每个变量 Synopsis、Release 等。由于您似乎是从文件中读取这些行，因此不知道您的数据是什么样的——例如。字符串是什么`line`样子的——我无法建议一种从中提取您想要的信息的方法。

您将同一事物多次插入数据库的原因是因为这一行：

```
st.executeUpdate("INSERT INTO Movie_Infor ( Release_Date,movie_title,Synopsis, Runtime, Genres, Director, Actors) values('"+Released+"','"+movie+"','"+Synopsis+"','"+Runtime+"','"+Genre+"','"+Director+"','"+Actors+"')"); 
```

包含*在*您的 for 循环中。（我假设你在你的真实程序中没有注释掉它；如果它实际上被注释掉了，那么我不知道任何东西是如何插入你的数据库的。）无论如何，如果你把这条线移出的for循环，那么你应该只插入一次。

最后，根据 Java 编码风格约定，您应该以小写字母开头命名变量。所以不是 a `String Synopsis`，你应该有`String synopsis`，等等。

# emacs - 如何修复 emacs 24 中的 javascript 模式更改？

> ID：11336938
> 
> 赞同：6
> 
> 时间：2012-07-05T01:36:27.073
> 
> 标签：emacs

我最近从 emacs 23 升级到 emacs 24。使用默认的 js-mode 使用 JavaScript，我注意到 emacs23 与 emacs24 中的 js-mode 之间存在细微但令人讨厌的差异。为了确保它不是我的设置之一，我使用该`--no-init-file`选项启动了 emacs23 和 emacs24，我看到了同样的问题，即：

在 js 模式下的 emacs23 中，当您键入右大括号时`}`，它会暂时将光标跳回到匹配的左大括号，然后将右大括号**缩进**到适当的缩进级别。

当我在 emacs24 中执行此操作时，临时光标会按预期跳转到匹配的左大括号，但它不会**缩进**右大括号，这让我按了 Tab 键来完成工作。

有其他人看到这种差异吗？如果是这样，关于如何解决它的任何想法？在我的 init.el 中的某个位置是否有很好的“缩进闭合卷曲”类型的变量？

我在 Xubuntu Linux 上使用 emacs（我从源代码安装）。我还没有在其他平台上比较 23 和 24。

*注意*：有人可能会建议改用 Yegge 的 js2-mode，但我通常不喜欢使用它，希望让 js-mode 正常工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T12:44:58.927

由于我找到了令人满意的答案并且没有收到其他人的消息，因此我将发布我的答案并接受它，以防它对其他人有所帮助。

我没有找到 js-mode 在 emacs 23 和 emacs 24 中表现不同的确切原因，但是`electric-indent-mode`在你的 .emacs 或 init.el 中设置会给出我想要的行为。有了这个，它实际上会在你输入右大括号*之前*缩进，但这对我有用。这是 emacs 24 中的新设置。您的 .emacs 条目将是：

```
(electric-indent-mode t) 
```

我遇到的一个问题是org-mode不喜欢electric-indent-mode，所以你可以专门为javascript/java/c/etc设置electric-indent-mode。模式或专门为组织模式取消设置。我选择了后者：

```
(defun my-org-mode-hooks ()
  (electric-indent-mode -1))

(add-hook 'org-mode-hook 'my-org-mode-hooks) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T06:13:29.900

谢谢你，midpeter444。(electric-indent-mode t) 就像一个魅力。我用谷歌搜索过，有人建议将 js-auto-indent-flag 设置为非 nil，它在我的 Emacs 24.3 上不起作用，即使确实有一个 js-auto-indent-flag 变量可以通过'customize-组js'，它没有效果。我发现 java.el 没有使用它，尽管它是在源代码中声明的。

# ruby-on-rails - Rails calendar_date_select 无法在浏览器上显示日历

> ID：11336942
> 
> 赞同：0
> 
> 时间：2012-07-05T01:38:02.177
> 
> 标签：ruby-on-rails, ruby

我通过以下步骤安装了 calendar_date_select

添加到gemfile

```
# To use calendar_date_select
gem 'calendar_date_select', :git => 'git://github.com/paneq/calendar_date_select.git' 
```

捆绑安装

```
bundle install 
```

我的 application.html.erb 看起来像

```
<head>
  <title><%= full_title(yield(:title)) %></title>
  <%= stylesheet_link_tag    "application", media: "all" %>
  <%= javascript_include_tag "prototype" %>
  <%= javascript_include_tag :defaults %> 
  <%= calendar_date_select_includes "silver" %>     
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <%= render 'layouts/shim' %>
</head> 
```

然后我用这条线从日历中获取数据。

```
<%= calendar_date_select_tag "startdate", nil, :embedded => true, :year_range =>  10.years.ago..0.years.ago %> 
```

这就是页面源的样子

```
<input id="startdate" name="startdate" type="hidden" /><span id="cds_placeholder_89036" style="display: none; position: absolute;"></span><script type="text/javascript"> 
```

//

但我根本看不到我的浏览器上的插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:00:19.797

页面上可能没有加载 javascript。您可能需要`<%= calendar_date_select_includes %>`在布局的头部添加。

编辑 1：对不起，我现在在您的来源中看到它。

编辑2：`<%= calendar_date_select_includes "silver" %>`应该在之后`<%= javascript_include_tag "application" %>`

# sql-server - 优化 SQL Server 查询

> ID：11336943
> 
> 赞同：1
> 
> 时间：2012-07-05T01:38:12.273
> 
> 标签：sql-server

是否可以优化此查询？

```
SELECT 
    tr.transferfrom, tr.transferto, br.id as 'BR_ID',tr.refno, 
    br.name as 'BR_NAME', br.code as 'BRANCH_CODE', tr.docno, tr.transdate,
    stk.stockno,stk.salescat,tr.qty, tr.sprice,tr.qty*tr.sprice as 'GROSS_SALES' 
FROM 
    TRANSFER tr 
JOIN 
    branch br on tr.branchid = br.id 
JOIN 
    stocks stk on tr.stockid=stk.id 
WHERE 
    RIGHT(tr.refno,7) = 'ST00576' AND LEFT(tr.refno,2) = 89 
    AND stk.stockno = 'NS4370 CR - L'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T05:02:12.917

1.  创建索引`tr.refno`并替换`LEFT(tr.refno,2) = 89`为`tr.refno LIKE '89%'`
2.  创建复合索引`stk.id + stk.stockno`
3.  确保`br.id`被索引覆盖
4.  如果确实有很多记录（数亿）并且如果经常执行此查询 - 可能将最后 7 个`tr.refno`字符存储在单独的字段中以避免`RIGHT(tr.refno,7) = 'ST00576'`（不确定 sql server 是否支持反向索引）

# ide - IntelliJ Idea 最强大的功能是什么？

> ID：11336945
> 
> 赞同：2
> 
> 时间：2012-07-05T01:38:35.847
> 
> 标签：ide, intellij-idea

我最近刚从 Eclipse 和 JDeveloper 切换到 IntelliJ Idea，我听到很多程序员同行称赞付费版本是最好的 IDE，但就我能够使用它而言（现在几天）我还没有找到那种感觉，所以我显然遗漏了一些东西，或者没有足够地使用 IDE，因此我的问题是：

IntelliJ Idea 最强大的功能是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T12:02:16.527

如果您刚刚从 Eclipse 切换到 IntelliJ，您可能想做的一件事是启用 Eclipse 快捷方式。不要落入陷阱，因为 IntelliJ 中有更多标准快捷键，并且通过更改键盘映射，您肯定会错过一些很酷的东西。

我在这里放了一些我最喜欢的： [第 1](http://arhipov.blogspot.com/2011/06/whats-cool-in-intellijidea-part-i.html)部分、 [第 2](http://arhipov.blogspot.com/2011/07/whats-cool-in-intellijidea-part-ii-live.html)部分、 [第 3 部分](http://arhipov.blogspot.com/2011/08/whats-cool-in-intellijidea-part-iii.html)

这是一种主观感觉，但在 IntelliJ 中导航看起来非常强大，并且实时模板使用起来更方便一些。与 Eclipse 相比，Debugger 有其自身的缺点。在 IntelliJ 中开箱即用地很好地实现了许多其他小东西，但最大的不同可能是 IntelliJ 如何处理*上下文*：[为什么 IDEA 比 Eclipse 更好](http://java.dzone.com/articles/why-idea-better-eclipse)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T01:47:39.853

IntelliJ 的老用户（约 12 年以上）。这确实是一件私人的事情，所以对我来说，它是快捷方式、自动格式化、实时模板、主题（我更喜欢深色编辑器）和一个不错的调试器（带有监视和评估）。我最近使用的较新的 intellij 功能是能够在不同的窗口中运行两个项目（以前不能这样做）。它只是一个整洁的包装，从来没有改变的冲动。

# ruby-on-rails - has_one 嵌套路由和路由错误消息：“没有路由匹配 [POST]“/users/3/profiles””

> ID：11336948
> 
> 赞同：2
> 
> 时间：2012-07-05T01:39:00.230
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, form-for

提交“创建我的个人资料”后出现错误

路由错误

没有路线匹配 [POST] "/users/3/profiles"

其次，我重新启动了 webbrick cli = "rails s"，并且在输入“http://localhost:3000/users/1/profile/new”后收到错误消息“未定义的方法 `user_profiles_path'”。显然我使用了“resource :profile”非嵌套资源。我正在撕扯我的头发，这些错误发生了什么？

```
<h1>About You</h1>
<div class="row">
  <div class="span6 offset3">
    <%= form_for ([@user, @profile]) do |f| %>
      <%= f.label :name, "First name:" %>
      <%= f.text_field :name %>
      <%= f.label :surname, "Surname:" %>
      <%= f.text_field :surname %>
      <%= f.submit "Create my profile", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div>

  resources :users do
    resource :profile
  end

     user_profile POST   /users/:user_id/profile(.:format)      profiles#create
 new_user_profile GET    /users/:user_id/profile/new(.:format)  profiles#new
edit_user_profile GET    /users/:user_id/profile/edit(.:format) profiles#edit
                  GET    /users/:user_id/profile(.:format)      profiles#show
                  PUT    /users/:user_id/profile(.:format)      profiles#update
                  DELETE /users/:user_id/profile(.:format)      profiles#destroy
            users GET    /users(.:format)                       users#index
                  POST   /users(.:format)                       users#create
         new_user GET    /users/new(.:format)                   users#new
        edit_user GET    /users/:id/edit(.:format)              users#edit
             user GET    /users/:id(.:format)                   users#show
                  PUT    /users/:id(.:format)                   users#update
                  DELETE /users/:id(.:format)                   users#destroy
         sessions POST   /sessions(.:format)                    sessions#create
      new_session GET    /sessions/new(.:format)                sessions#new
          session DELETE /sessions/:id(.:format)                sessions#destroy
             root        /                                      static_pages#home 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T02:06:11.343

据我了解，rails 无法知道`form_for ([@user, @profile])`（假设`@profile`是一条新记录）是否要使用动词 POST 路由到`/users/:user_id/profile`or `/users/:user_id/profiles`。一般来说，它会采用复数形式，所以如果你想要单数形式，你必须通过写作明确告诉它

```
form_for @profile, url: user_profile_path(@user) 
```

# gtk - gtk+ 在窗口级别使用按键信号，但在子窗口小部件级别阻止特定按键信号

> ID：11336949
> 
> 赞同：0
> 
> 时间：2012-07-05T01:39:03.203
> 
> 标签：gtk, signals

我正在使用 vte 在 gtk+ 中创建一个终端应用程序。当我创建一个选项卡并使用 ctrl+t 组合键将其添加到笔记本时，它会按预期在选项卡中添加一个带有新终端的选项卡。但是，按键信号也会通过终端并在命令提示符之前显示为“^T”以及系统哔声。如何在窗口级别使用按键信号，以便添加选项卡，然后在终端级别阻止此特定按键信号？这是一段代码，显示了它是如何组装的：

```
 window_main = gtk_window_new (GTK_WINDOW_TOPLEVEL);

  vte = vte_terminal_new();
  terminal = VTE_TERMINAL (vte);

  notebook = gtk_notebook_new ();

  vbox = gtk_vbox_new(FALSE,0);
  gtk_container_add (GTK_CONTAINER (window_main), vbox);
  gtk_box_pack_start (GTK_BOX (vbox), notebook, TRUE, TRUE, 0);  

  scrollwin[0] = gtk_scrolled_window_new (NULL, terminal->adjustment);
  gtk_container_add(GTK_CONTAINER(scrollwin[0]),vte);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrollwin[0]), GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);

  label = gtk_label_new ("term1");
  gtk_notebook_append_page (GTK_NOTEBOOK (notebook), scrollwin[0], label); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T20:03:03.487

Windows 在按键事件中首先得到破解，然后它们沿着焦点链上升。任何返回的信号处理程序都会`true`停止这种传播。因此，如果您`true`在处理`ctrl-t`（或您不想传播的任何其他按键）时从按键信号处理程序返回，它应该阻止它进入术语小部件。

# sql - 使用 HiveQL(Hadoop) 在 Hive 中连接两个表

> ID：11336950
> 
> 赞同：5
> 
> 时间：2012-07-05T01:39:12.180
> 
> 标签：sql, hadoop, mapreduce, hive, hiveql

> **可能重复：**
> [SQL Query JOIN with Table](https://stackoverflow.com/questions/11386368/sql-query-join-with-table)

```
CREATE EXTERNAL TABLE IF NOT EXISTS TestingTable1   (This is the MAIN table through which comparisons need to be made)
(
BUYER_ID BIGINT,
ITEM_ID BIGINT,
CREATED_TIME STRING
) 
```

这是上面第一个表中的数据

```
**BUYER_ID**  |  **ITEM_ID**     |      **CREATED_TIME**   
--------------+------------------+-------------------------
 1015826235      220003038067       *2001-11-03 19:40:21*
 1015826235      300003861266        2001-11-08 18:19:59
 1015826235      140002997245        2003-08-22 09:23:17
 1015826235     *210002448035*       2001-11-11 22:21:11 
```

这是 Hive 中的第二张表 - 它还包含有关我们正在购买的物品的信息。

```
CREATE EXTERNAL TABLE IF NOT EXISTS TestingTable2
(
USER_ID BIGINT,
PURCHASED_ITEM ARRAY<STRUCT<PRODUCT_ID: BIGINT,TIMESTAMPS:STRING>>
) 
```

这是上面第二个表（`TestingTable2`）中的数据-

```
**USER_ID**    **PURCHASED_ITEM**
1015826235     [{"product_id":220003038067,"timestamps":"1004941621"},    {"product_id":300003861266,"timestamps":"1005268799"},    {"product_id":140002997245,"timestamps":"1061569397"},{"product_id":200002448035,"timestamps":"1005542471"}] 
```

**比较以便满足以下场景`TestingTable2`。`TestingTable1`**

在比较 from 之后，找到与 TestTable1 对应的AND不`PRODUCT_ID`匹配的AND 。`TIMESTAMPS``TestingTable2``ITEM_ID``CREATED_TIME``BUYER_ID(USER_ID)``TestingTable1`

因此，如果您查看`TestingTable2`此（最后）`ITEM_ID 210002448035`来自`TestingTable1`的数据与数据不匹配，`TestingTable2` `PRODUCT_ID- 200002448035` 并且与时间戳类似。所以我想使用 HiveQL 查询显示以下结果。

```
**BUYER_ID**  |  **ITEM_ID**     |      **CREATED_TIME**          |  **PRODUCT_ID**    |     **TIMESTAMPS** 
--------------+------------------+--------------------------------+------------------------+----------------------
1015826235          *210002448035*           2001-11-11 22:21:11            200002448035           1005542471 
1015826235       220003038067           *2001-11-03 19:40:21*           220003038067          1004941621 
```

谁能帮我这个。因为我是 HiveQL 的新手，所以有很多问题。

**更新：-**

我已经写了这个查询，但它没有按照我想要的方式工作。

```
select * from 
  (select * from 
     (select user_id, prod_and_ts.product_id as product_id, prod_and_ts.timestamps as timestamps 
      from testingtable2 LATERAL VIEW
      explode(purchased_item) exploded_table as prod_and_ts)
      prod_and_ts 
      LEFT OUTER JOIN testingtable1 
  ON ( prod_and_ts.user_id = testingtable1.buyer_id AND testingtable1.item_id =    prod_and_ts.product_id
     AND prod_and_ts.timestamps = UNIX_TIMESTAMP (testingtable1.created_time)
  )
  where testingtable1.buyer_id IS NULL) 
  set_a LEFT OUTER JOIN testingtable1 
  ON (set_a.user_id = testingtable1.buyer_id AND  
  ( set_a.product_id = testingtable1.item_id OR set_a.timestamps = UNIX_TIMESTAMP(testingtable1.created_time) )
 ); 
```

**又一更新**

根据`user1166147`评论。我根据他的查询写了我的查询。在蜂巢中，我猜`INNER JOIN`是简单地写的`JOIN`。

这是我的以下查询。

```
select * from (select t2.buyer_id, t2.item_id, t2.created_time as created_time, subq.user_id, subq.product_id, subq.timestamps as timestamps 
from
(select user_id, prod_and_ts.product_id as product_id, prod_and_ts.timestamps as timestamps from testingtable2 lateral view explode(purchased_item) exploded_table as prod_and_ts) subq JOIN testingtable1 t2 on t2.buyer_id = subq.user_id 
AND subq.timestamps = unix_timestamp(t2.created_time)
WHERE (subq.product_id <> t2.item_id)
union all
select t2.buyer_id, t2.item_id as item_id, t2.created_time, subq.user_id, subq.product_id as product_id, subq.timestamps
from 
(select user_id, prod_and_ts.product_id as product_id, prod_and_ts.timestamps as timestamps from testingtable2 lateral view explode(purchased_item) exploded_table as prod_and_ts) subq JOIN testingtable1 t2 on t2.buyer_id = subq.user_id 
    and subq.product_id = t2.item_id 
    WHERE (subq.timestamps <> unix_timestamp(t2.created_time))) unionall; 
```

运行上述查询后，我得到的结果为零。

**最后一次更新：-**

我的错，我在表格中没有准确的数据，所以这就是我没有得到结果的原因。是的，它正在执行上述实际查询。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T16:09:19.543

**编辑 - 第 1 部分** 好的 - 出于某种原因，我要解释一下自己 - 所以首先我偶然发现了这个问题，因为 SQL 标签，看到了 Hive，开始不看，只是跳过它。但后来我注意到已经过去一天了，你还没有得到任何答案。我看了看 - 我在发布的原始查询中看到了一个 SQL 逻辑更正，我知道这将是必要的并且会有所帮助，所以我发布只是因为没有人回答。我将尝试解决最后一个问题——但在那之后我会保留我的建议，因为我可能会给出不好的建议。祝你好运！我试过了！你现在似乎得到了答案，所以...

**在 TSQL 中，我可以使用以下单个查询来解决整个问题**：

```
SELECT * 
FROM SO_Table1HIVE A
FULL OUTER JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND (B.t1time = A.Created_TIME OR B.PRODUCTID = A.ITEM_ID) 
```

它将返回所有内容，仅包括您的匹配购买者 ID/用户 ID。它不会匹配在另一个表中的 time 或 product 中没有匹配项的 buyer_id/user_id 行，但它会在另一个表的字段中将其作为单独的行返回，并带有 NULLS。我不会以任何方式匹配这些 - 没有提供准确的信息来做到这一点，如下所述。

**结束编辑第 1 部分**

如果不能在 Hive 中`FULL OUTER JOIN`使用`OR`，满足原始条件的最简单方法是`UNION ALL`2 `INNER JOIN`s。在其中一个查询中，除了加入匹配的 user_id 之外，还加入 PRODUCT_ID 并在您的`WHERE`查找中查找与 CREATED_TIME 不匹配的 TIMESTAMPS。在第二个查询中，除了加入匹配的 user_ids 之外，还加入时间 AND 以`WHERE`查找不匹配的产品。

**编辑第 2 部分 - 评论问题附加标准的更新**

如果我了解最后一个条件，则它是任一表中具有匹配的 user_id = Buyer_id 的任何记录，但没有其他匹配项。`FULL OUTER JOIN`with条件将`OR`返回它们，但提供的信息不足以将记录相互关联。我们可以很容易地识别它们，但无法将它们相互联系起来。如果您这样做并且在任一或两个表中都有多个不匹配的记录，则每个表将有多个条目。

*我写的任何查询都试图在没有更多信息（可能还有）的情况下将它们联系起来，这都是猜测和不准确的。*

例如，在第一个表中，如果有这 2 条（假样本）记录，除了 user_id 之外，第二个中没有任何匹配项：

```
1015826235  420003038067    2011-11-03 19:40:21.000
1015826235  720003038067    2004-11-03 19:40:21.000 
```

表 2 中的 AND - 这些不匹配：

```
1015826235  {"product_id":520003038067,"timestamps":"10...
1015826235  {"product_id":620003038067,"timestamps":"10... 
```

您可以识别它们，但如果您在没有更多条件的情况下匹配它们，您会得到 4 而不是 2：

```
1015826235  420003038067    2011-11-03 19:40:21.000 1015826235 520003038067
1015826235  420003038067    2011-11-03 19:40:21.000 1015826235 620003038067
1015826235  720003038067    2004-11-03 19:40:21.000 1015826235 520003038067
1015826235  720003038067    2004-11-03 19:40:21.000 1015826235 620003038067 
```

我的建议是简单地识别它们并显示它们，如下所示。

```
BUYER_ID        ITEM_ID      CREATED_TIME           USER_ID PRODUCTID   timestamps  
----------------------------------------------------------------------
NULL            NULL         NULL                   1015826235  520003038067    2009-11-11 22:21:11.000
NULL            NULL         NULL                   1015826235  620003038067    2008-11-11 22:21:11.000
1015826235      420003038067 2011-11-03 19:40:21.000    NULL    NULL    NULL    
1015826235      720003038067 2004-11-03 19:40:21.000    NULL    NULL    NULL 
```

**结束编辑第 2 部分 - 评论问题附加标准的更新 - 第 1 部分**

我正在使用 TSQL，所以我无法用你的语法为你测试一个精确的查询，但是连接的概念是相同的，这将返回你想要的。我确实接受了您的查询并尝试了您的语法，并根据需要进行了修改。我在 TSQL 中测试过。您也许可以使用 HiveQL 中的功能并对其进行改进。还有其他方法可以做到这一点 - 但这是最​​直接的，这将转化为 HiveQL。

**已移除，您得到了这部分，稍后包含**

（*再次根据需要修改语法*）**

```
SELECT *
FROM (
    SELECT BUYER_ID,ITEM_ID,CREATED_TIME,PRODUCT_ID,TIMESTAMPS 
    FROM testingtable2 LATERAL VIEW
        explode(purchased_item) exploded_table as prod_and_ts)
        prod_and_ts 
    INNER JOIN table2 A  ON A.BUYER_ID = prod_and_ts.[USER_ID] AND prod_and_ts.timestamps = UNIX_TIMESTAMP (table2.created_time) 
    WHERE prod_and_ts.product_id <> A.ITEM_ID
    UNION ALL
    SELECT BUYER_ID,ITEM_ID,CREATED_TIME,PRODUCT_ID,TIMESTAMPS 
    FROM testingtable2 LATERAL VIEW
            explode(purchased_item) exploded_table as prod_and_ts)
            prod_and_ts 
    INNER JOIN table2 A  ON A.BUYER_ID = prod_and_ts.[USER_ID] AND prod_and_ts.product_id = A.ITEM_ID
    WHERE  prod_and_ts.timestamps <> UNIX_TIMESTAMP (table2.created_time) 
) X 
```

这是我**测试过的 TSQL 版本，其中包含我的表名供参考：**

```
SELECT * 
FROM(
    SELECT *
    FROM SO_Table1HIVE A
    INNER JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND B.t1time = A.Created_TIME 
    WHERE B.PRODUCTID <> A.ITEM_ID
    UNION ALL
    SELECT * 
    FROM SO_Table1HIVE A
    INNER JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND B.PRODUCTID = A.ITEM_ID  
    WHERE B.t1time <> A.Created_TIME  
 ) X 
```

***编辑第 3 部分 - 评论问题附加标准的更新 - 第 2 部分**

在 TSQL 中，整个查询（无联合）可以使用`FULL OUTER JOIN`连接`OR`条件运行

```
SELECT * 
FROM SO_Table1HIVE A
FULL OUTER JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND (B.t1time = A.Created_TIME OR B.PRODUCTID = A.ITEM_ID) 
```

如果您不能简单地执行上述操作，对于新条件的 SQL 逻辑 - 从两个表中获取不匹配的那些并像`NULL`在另一个表中一样显示它们，使用`RIGHT JOIN`and `LEFT JOIN`。 `RIGHT JOIN`将抓取第一个表中的任何内容，匹配第二个和第二个中的所有内容，并`LEFT`执行相反的操作。将新查询添加到您的`UNION`.

TSQL 示例 - 针对 HIVE 进行修改

```
SELECT * 
FROM SO_Table1HIVE A
RIGHT JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND (B.t1time = A.Created_TIME    OR B.PRODUCTID = A.ITEM_ID)
WHERE A.BUYER_ID IS NULL 
UNION ALL
SELECT * 
FROM SO_Table1HIVE A
LEFT JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] AND (B.t1time = A.Created_TIME OR    B.PRODUCTID = A.ITEM_ID)
WHERE B.[USER_ID] IS NULL 
```

或者，如果您想抓取它们并将它们匹配为重复项，请添加到`UNION`：

TSQL

```
SELECT * 
FROM SO_Table1HIVE A
JOIN SO_Table2HIVE B ON A.BUYER_ID = B.[USER_ID] 
WHERE B.t1time NOT IN(SELECT Created_TIME FROM SO_Table1HIVE)
AND A.Created_TIME  NOT IN(SELECT t1time FROM SO_Table2HIVE) 
AND B.PRODUCTID NOT IN(SELECT ITEM_ID FROM SO_Table1HIVE)
AND A.ITEM_ID NOT IN(SELECT PRODUCTID FROM SO_Table2HIVE) 
```

***再次，祝你好运！***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T23:09:31.410

您可能需要使用[Hive 转换功能](https://cwiki.apache.org/Hive/languagemanual-transform.html)并有一个自定义减速器来匹配两个表中的记录： t1 和 t2 其中 t1 只是 TestingTable1 和 t2 是

```
 SELECT
      user_id,
      prod_and_ts.product_id as product_id,
      prod_and_ts.timestamps as timestamps
   FROM 
      TestingTable2 
      LATERAL VIEW explode(purchased_item) exploded_table as prod_and_ts 
```

[正如我在你的另一个问题中所解释的那样](https://stackoverflow.com/questions/11373543/explode-the-array-of-struct-in-hive#comment15007330_11373543)。

```
FROM (
   FROM (
      SELECT
         buyer_id,
         item_id,
         created_time,
         id 
      FROM (
         SELECT
            buyer_id,
            item_id,
            created_time,
            't1' as id
         FROM
            TestingTable1 t1
         UNION ALL
         SELECT
            user_id as buyer_id,
            prod_and_ts.product_id as item_id,
            prod_and_ts.timestamps as created_time,
            't2' as id
         FROM 
            TestingTable2
            LATERAL VIEW explode(purchased_item) exploded_table as prod_and_ts
         )t
      )x
      MAP
         buyer_id,
         item_id,
         created_time,
         id
      USING '/bin/cat'
      AS
         buyer_id,
         item_id,
         create_time,
         id
      CLUSTER BY
         buyer_id
      ) map_output
   REDUCE 
      buyer_id,
      item_id,
      create_time,
      id
   USING 'my_custom_reducer'
   AS
      buyer_id,
      item_id,
      create_time,
      product_id,
      timestamps; 
```

上面的查询有 2 个不同的部分。第一部分是“MAP”，另一部分是“REDUCE”。在这两个部分之间是一个称为*shuffle*的阶段（由 表示`CLUSTER BY buyer_id`），它会自动处理我的 Hive。查询的 Map 部分从表中读取数据并传递一个标识符（称为*id*，表示记录来自哪些表）。Shuffle 阶段将所有记录分组到每个*buy_id*。Reduce 阶段将接收给定*buyer_id的所有记录*并仅发出满足匹配条件的记录。您必须根据匹配标准自己编写减速器。您可以用您选择的任何语言编写它。保证具有相同buyer_id 的所有记录都将进入相同的reducer 脚本。

可能有更简单的方法，但这是我现在能想到的方法。祝你好运！要进一步了解我选择这种方法的原因，[请在此处查看我最近的回答](https://stackoverflow.com/questions/11387543/performance-tuning-a-hive-query/11405841#11405841)。

# java - 从 Web 应用程序执行需要 sudo 的 shell 脚本

> ID：11336952
> 
> 赞同：1
> 
> 时间：2012-07-05T01:39:55.130
> 
> 标签：java, shell, sudo, elevated-privileges

鉴于 Web 应用程序没有 su 权限，我想执行一个需要 sudo 的 shell 脚本。我还想避免让用户输入密码。我有哪些选择？这基本上就是我想要做的。

## 检票申请（更改IP表格）

```
@Override
protected void onSubmit() {
    System.out.println("Submitted");            
    try {
        Shell.updateIp("eth0", "192.168.217.129");
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

## 壳牌.java

```
public static void updateIp(String ethernetInterface, String ip) throws IOException {
    ProcessBuilder builder = new ProcessBuilder("/home/keeboi/Desktop/iptool.sh", ethernetInterface, ip);
    Process child = builder.start();
    Network.readOutput(child);
    child.destroy();
} 
```

iptool.sh 执行一个可运行的 jar。

## iptool.sh

```
#!/bin/sh
sudo java -jar changeip.jar $1 $2 
```

我得到：

```
sudo: no tty present and no askpass program specified
Sorry, try again.
sudo: no tty present and no askpass program specified
Sorry, try again.
sudo: no tty present and no askpass program specified
Sorry, try again.
sudo: 3 incorrect password attempts 
```

再次强调，网络应用程序没有被赋予任何 su 权限，并且我想避免向用户询问密码。

**编辑：**

我已经尝试添加`keeboi ALL = NOPASSWD: /home/keeboi/Desktop/iptool.sh`到我的`/etc/sudoers`，但它仍然需要密码。

**更新**

也加`keeboi ALL = NOPASSWD: /home/keeboi/Desktop/changeip.jar`了，没有骰子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:42:53.727

只需添加`NOPASSWD`/etc/sudoers：

```
user     ALL = NOPASSWD: /home/keeboi/Desktop/iptool.sh 
```

这会关闭密码检查。

# wordpress - WordPress自定义帖子类型类别顺序

> ID：11336961
> 
> 赞同：2
> 
> 时间：2012-07-05T01:41:42.137
> 
> 标签：wordpress, plugins, custom-post-type

我正在寻找一种方法来手动重新排序自定义帖子类型的类别列表，是否有任何插件已经这样做了？

我可能可以自己编写代码，但我不确定从哪里开始，您可以将自定义字段添加到可用于订购它们的类别中吗？

任何能指出我正确方向的东西都会很棒！

* * *

## 编辑 [已解决]

经过一番挖掘后，我发现了这一点：

[http://wordpress.org/support/topic/plugin-my-category-order-custom-taxonomy-order-and-code-improvements](http://wordpress.org/support/topic/plugin-my-category-order-custom-taxonomy-order-and-code-improvements)

与此相关的：

[http://snipplr.com/view/48599/mycategoryorder-custom-taxonomy-mod/](http://snipplr.com/view/48599/mycategoryorder-custom-taxonomy-mod/)

一旦您将第 51 行更改为您的自定义分类类型，它就像一个魅力，例如：

```
$tax = ($_GET['mytax'])? $_GET['mytax'] : 'category'; 
```

变成

```
$tax = ($_GET['mytax'])? $_GET['mytax'] : 'my_custom_taxonomy'; 
```

与@Ajay Patel 链接的“类型”插件完美配合，干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:03:42.213

无法完美地让你提问。但是使用这个插件[类型 - 自定义字段和自定义帖子类型管理](http://wordpress.org/extend/plugins/types/)

类型使自定义 WordPress 管理员变得容易。使用自定义帖子类型和自定义分类定义您自己的内容。使用自定义字段重新设计编辑屏幕。

# wordpress - 处理 wordpress 页面的最佳方式——插件还是手册？

> ID：11336968
> 
> 赞同：1
> 
> 时间：2012-07-05T01:44:18.340
> 
> 标签：wordpress

好的，我一直在寻找一种简单的方法来为我的客户实现这一点..？

这是我想要完成的： [http ://www.trails2000.org/site/trail_conditions.html](http://www.trails2000.org/site/trail_conditions.html)

不知道该怎么办？？我可以轻松地制作一张桌子并让它们更新.. ?

或者我在看 GD Star 评级并进行 Multi-set ？但也不确定..

有什么我忽略的吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T04:36:45.290

手动编码最适合这种情况，因此您可以更好地控制所需的功能。

并考虑使用 Post 类型构建它

```
 http://codex.wordpress.org/Post_Types 
```

要了解有关自定义帖子类型的更多信息，请查看此幻灯片

```
http://www.slideshare.net/williamsba/custom-post-types-and-taxonomies-in-wordpress 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T05:33:55.120

不要手动操作（我通过“手动”收集，您指的是硬编码，还是让用户通过 WYSIWYG 编辑器编辑表格？）。

正如每个人所说，做它定制。您需要使用自定义帖子类型、自定义分类法和自定义字段。

如果您使用插件，您应该寻找一个管理自定义帖子类型、自定义分类法和自定义字段的插件，例如： http: [//magicfields.org/](http://magicfields.org/)

话虽如此，在没有插件的情况下手动编码并不是很困难，并且应该让您更好地了解它们是如何组合在一起的。

'Trail' 应该是自定义帖子类型。“Trail”帖子类型应该有一个自定义分类“Trail System”，它将包含“Colorado Trail System”、“Fort Lewis Trail System”等。“Trail”帖子类型应该有“condition”的自定义字段，以及可能是“评论”。虽然“评论”可以存储在帖子正文中。

客户将能够通过 Wordpress 管理界面添加“Trails”和“Trail Systems”来自行更新网站，类似于他们添加“Posts”和“Categories”的方式。

有道理？

编辑：下面解释如何使用原始代码设置上述内容（即，没有插件）

下面是一些示例代码，应该放在functions.php 中。一旦此代码在functions.php 中，“Trails”应该出现在“Posts”下方的管理界面中。“Trail Systems”应该出现在“Trails”的下拉菜单中，就像“Categories”对“Posts”所做的那样。当您添加新的“Trail”时，下面应该有“comments”和“condition”的自定义字段。

```
<?php 

// CREATE YOUR CUSTOM POST TYPE
add_action( 'init', 'create_custom_post_type_trail');
function create_custom_post_type_trail() {

    // Set all the labels for your custom post type, as they will appear in the wordpress admin interface.
    $labels = array( 
        'name' => _x( 'Trails', 'trail' ),
        'singular_name' => _x( 'Trail', 'trail' ),
        'add_new' => _x( 'Add New', 'trail' ),
        'add_new_item' => _x( 'Add New Trail', 'trail' ),
        'edit_item' => _x( 'Edit Trail', 'trail' ),
        'new_item' => _x( 'New Trail', 'trail' ),
        'view_item' => _x( 'View Trail', 'trail' ),
        'search_items' => _x( 'Search Trails', 'trail' ),
        'not_found' => _x( 'No Trails found', 'trail' ),
        'not_found_in_trash' => _x( 'No Trails found in Trash', 'trail' ),
        'parent_item_colon' => _x( 'Parent Trail:', 'trail' ),
        'menu_name' => _x( 'Trails', 'trail' ),
    );

    // Set all the options for your custom post type - you may need to change some of these
    $args = array( 
        'labels' => $labels,
        'hierarchical' => false,

        'supports' => array( 'title', 'editor', 'custom-fields' ),
        'taxonomies' => array(),
        'public' => true,
        'show_ui' => true,
        'show_in_menu' => true,
        'menu_position' => 5,

        'show_in_nav_menus' => true,
        'publicly_queryable' => true,
        'exclude_from_search' => false,
        'has_archive' => true,
        'query_var' => true,
        'can_export' => true,
        'rewrite' => array('slug' => 'trails', 'with_front' => false),
        'capability_type' => 'post'
    );

    register_post_type( 'trail', $args );
}

// ADD CUSTOM FIELDS TO THE TRAIL CUSTOM POST TYPE
add_action('wp_insert_post', 'add_custom_trail_fields');

function add_custom_trail_fields($post_id) {
    if ( isset($_GET['post_type']) and $_GET['post_type'] == 'trail' ) {
        add_post_meta($post_id, 'condition', '', true);
        add_post_meta($post_id, 'comments', '', true);
    }
    return true;
}

// ADD CUSTOM TAXONOMY TO THE TRAIL CUSTOM POST TYPE
add_action( 'init', 'create_trail_taxonomies' );
function create_trail_taxonomies(){

    // Set all the labels for your custom taxonomy, as they will appear in the wordpress admin interface.
    $labels = array(
        'name' => _x( 'Trail Systems', 'taxonomy general name' ),
        'singular_name' => _x( 'Trail System', 'taxonomy singular name' ),
        'search_items' =>  __( 'Search Member Categories' ),
        'all_items' => __( 'All Member Categories' ),
        'parent_item' => __( 'Parent Trail System' ),
        'parent_item_colon' => __( 'Parent Trail System:' ),
        'edit_item' => __( 'Edit Trail System' ), 
        'update_item' => __( 'Update Trail System' ),
        'add_new_item' => __( 'Add New Trail System' ),
        'new_item_name' => __( 'New Trail System Name' ),
        'menu_name' => __( 'Trail System' ),
    ); 

    // Set all the options for your custom taxonomy - you may need to change some of these
    $args = array(
        'labels' => $labels,
        'label'=>'Trail Systems',
        'hierarchical'=>true, // this makes them behave like 'categories' as opposed to like 'tags'
        'rewrite' => array('slug' => 'trail_system', 'with_front' => false),
    );
    register_taxonomy('trail_system', 'trail', $args);

}

/*
// This is for if you make a mistake, and have to unregister a taxonomy and register it with a new name
add_action( 'init', 'unregister_taxonomy');
function unregister_taxonomy(){
    global $wp_taxonomies;
    $taxonomy = 'XXXXXXXXX'; // name of your taxonomy goes here.
    if ( taxonomy_exists( $taxonomy))
        unset( $wp_taxonomies[$taxonomy]);
}
*/

?> 
```

您可能会发现其他一些有用的东西：

您可以通过[http://www.example.com/?post_type=trail](http://www.example.com/?post_type=trail)或[http://www.example.com/trail](http://www.example.com/trail)或类似的网址访问您的足迹，具体取决于您的永久链接的设置方式。

在您的主题中，您可以创建文件archive-trail.php 和single-trail.php 来为存档/单个“Trail”帖子制作自定义模板。

在 The Loop 内部，您可以像这样访问自定义帖子字段：

```
<?php
$fields = get_post_meta( get_the_ID()); // get all custom fields
echo $fields['comments'][0]; // display 'comments' field
echo $fields['condition'][0]; // display 'condition' field
?> 
```

再次在 The Loop 内部，获取您的自定义分类，如下所示：

```
<?php 
$trail_system = get_the_terms( $post->ID, 'trail_system');
echo $trail_system;
?> 
```

最后，我不知道您是否需要对 Trails 进行搜索，但如果需要，请查看：[http ://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls /](http://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T03:02:34.097

根据我的经验，定制要好得多 - 提供更大的灵活性。我经常使用插件，因为最初它为我节省了一些时间，然后 70% 的项目我不得不进行一些小的修改，最终浪费了更多的时间来弄清楚如何以及在哪里制作我本可以自己编写整个该死的东西的那些变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T04:18:13.380

您可以为他们创建一个管理页面，专门为每个跟踪保存变量（“好”“坏”或其他），允许编辑或以上的用户更新它。我认为这里的自定义解决方案肯定是最好的。

如果您登录[http://myego.org](http://myego.org)，然后转到“我的 EGO”页面，您会看到那种管理页面（尽管您的页面全是下拉菜单，而这个全是字段）。

# google-chrome-extension - 在 Google Chrome 扩展中使用 AngularJS

> ID：11336969
> 
> 赞同：22
> 
> 时间：2012-07-05T01:44:22.000
> 
> 标签：google-chrome-extension, angularjs

我正在尝试在扩展弹出窗口中使用 Google 开发人员 AngularJS 库，但出现错误。

> 错误：在函数（未知来源）在 Jb（chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:74:18）在 k（chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/ angular.js:62:357) 在 Jc (chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:64:37) 在 Lc (chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:69:166)在 chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:74:241 在 chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:51:270 在 F (chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular .js:47:339) 在 X (chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:39:390) 在 t (chrome-extension://jambnlbfljcfpomlclcgphfmkjfiphkb/lib/angular.js:38:286)

为 Google Chrome 插件清单文件编写以下 content_security_policy 指令的正确方法是什么？：

```
"content_security_policy": "default-src 'self'; script-src 'unsafe-eval' 'unsafe-inline'; style-src 'unsafe-inline'", 
```

目前它正在抛出一个错误......

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-05T17:07:38.063

您必须在 Angular 中使用 CSP 模式才能进入 Chrome 扩展程序。见：[https ://github.com/angular/angular.js/issues/893](https://github.com/angular/angular.js/issues/893)

基本上你必须将你的应用声明为：

```
<html ng-app="" ng-csp> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-14T16:22:30.870

`<html ng-app="" ng-csp>`在 chrome-extension://*.xhtml 文件中导致 Chrome stable M21 出错。

`<html ng-app="" ng-csp="">`似乎工作。

# magento - Magento：获取当前商店/网站的父类别

> ID：11336972
> 
> 赞同：-1
> 
> 时间：2012-07-05T01:44:41.617
> 
> 标签：magento, categories, product

我正在使用[此代码](http://www.magentocommerce.com/boards/viewthread/176389/P15/#t369242)在面包屑中显示产品的父类别。

不幸的是，这不适用于多商店设置，其中将产品另外分配给当前商店中不存在的类别。示例：在[此产品页面上](http://www.geschenkhexe.ch/kugelschreiber-kamera.html)，面包屑链接到“Minikameras”类别，该类别实际上是另一个网站/商店的类别。

仅显示活动网站/商店类别的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T06:51:34.487

使用以下代码获取当前商店的根类别。

```
<?php Mage::app()->getStore()->getRootCategoryId() ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T11:56:21.660

```
 <?
       Mage::app('store', 'website');//enter your store and website here
       $products = Mage::getModel('catalog/product')->getCollection();
       $categories = $product->getCategoryIds();
       foreach($categories as $k => $_category_id): 
       $_category = Mage::getModel('catalog/category')->load($_category_id);
       $cat_name = $_category->getName();
       $cat_url =  $_category->getUrl();
       endforeach;
       ?> 
```

这是另一种方法。它将列出类别名称和类别网址。您所要做的就是进入商店和网站。希望能帮助到你。

# spring - 如何在 Spring 中预处理对所有控制器的请求？验证 CSRF 令牌

> ID：11336973
> 
> 赞同：0
> 
> 时间：2012-07-05T01:44:44.987
> 
> 标签：spring, rest, spring-mvc, csrf

我正在开发一个提供 REST 接口的 Spring-MVC 后端（和 GWT 前端）。出于安全原因，它应该在每个请求上验证一个令牌。现在的问题是：我怎样才能检查那个令牌而不在每个控制器中写它应该检查它？我想到了一个类，它的方法在请求到达负责的控制器之前运行并检查令牌，如果它有效，它将把数据传递给控制器​​。

通过网络发送的 JSON 数据将如下所示：

```
{
    "data":
    {
        "id":1,
        "firstName":"firstExample",
        "lastName":"lastExample"
    },
    "csrf":"myCSRFToken"
} 
```

我的 Spring 设置的其余部分如下所示：

网页.xml：

```
<context-param>
    <param-name>contextClass</param-name>
    <param-value>org.springframework.web.context.support.AnnotationConfigWebApplicationContext</param-value>
</context-param>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>myapp.server.AppConfig</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<servlet>
    <servlet-name>dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

调度程序-servlet.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

    <context:component-scan base-package="myapp.server.controller" />

    <mvc:annotation-driven />

</beans> 
```

AppConfig.java：

```
@Configuration
@EnableWebMvc
public class AppConfig {
    //
} 
```

个人控制器：

```
@Controller
@RequestMapping("/persons")
public class PersonController {
    @ResponseBody
    @RequestMapping(method = RequestMethod.GET)
    public Collection<Person> list() {
        //
    }
} 
```

所以基本思想是，我的 CSRFCheck.java 类将首先接收每​​个请求。它将检查 CSRF 令牌并将 JSON 的“数据”部分的内容转发给负责的控制器。所以控制器只会收到：

```
{
    "id":1,
    "firstName":"firstExample",
    "lastName":"lastExample"
} 
```

我对 Spring 完全陌生，我想知道我必须在哪里修改我的配置才能使其按预期工作。

谢谢！

* * *

它现在在 dispatcher-servlet.xml 中使用此代码：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<context:component-scan base-package="myapp.server.controller" />

<mvc:annotation-driven />

<mvc:interceptors>  
     <bean class="myapp.server.XSRFInterceptor" />
</mvc:interceptors>

</beans> 
```

但是为什么它不能与这个 AppConfig.java 一起工作？：

```
@Configuration
@EnableWebMvc
@ComponentScan(basePackages="myapp.server.controller") 
public class AppConfig extends WebMvcConfigurerAdapter {
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new XSRFInterceptor());
    }
} 
```

还有一个问题：如何修改传递给控制器​​的 JSON？

**问题 1 的解决方案（xml 与 java）：**

调度程序-servlet.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

</beans> 
```

AppConfig.java 同上

CSRFInterceptor.java：

```
@Component
public class CSRFInterceptor extends HandlerInterceptorAdapter {
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {

        // Some code

        return true;
    }
} 
```

**尚待解决：如何在拦截器中处理 JSON 数据？**

# python - a.insert(0,x) 是 o(n) 函数吗？a.append 是一个 O(1) 函数吗？Python

> ID：11336978
> 
> 赞同：1
> 
> 时间：2012-07-05T01:45:32.290
> 
> 标签：python, list, insertion

我试图将数组中的偶数移动到数组的前面，将奇数移动到数组的后面。问题要求在线性算法中执行此操作并就地执行此操作。

我想出了这个：

```
 def sort(a):
    for i in range(0,len(a)-1):
        if a[i]%2==0:
            a.insert(0,a.pop(i))
    return a 
```

问题是，有人告诉我，从技术上讲，a.insert 是一个 o(n) 函数，所以从技术上讲，这将被视为非线性算法（当包括`for i in range`函数的一部分时）。由于提出这个问题的论坛已有几个月的历史，我无法要求解释。

基本上我相信他说的是“技术上”，因为因为这会将它插入到前面，所以它不会检查数组中的另外 N 个元素，因此使它在 O(n) 而不是 O(n^2) 时出于实际目的而运行. 这是一个正确的评估吗？

另外，论坛上的某个人曾经`a.append`修改过上述内容并将其更改为查找奇数。没有人回答，所以我想知道， a.append 不是 o(n) 函数，因为它将它移动到最后吗？是o（1）吗？

感谢您的解释和澄清！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T01:49:07.450

`insert`在列表的第 0 个索引处需要移动每个其他元素，这使其成为 O(N) 操作。但是，如果您使用[`deque`](http://docs.python.org/library/collections.html#collections.deque)此操作是 O(1)。

`append`是一个摊销的 O(1) 操作，因为它只需要将项目添加到列表的末尾并且不进行移位。有时列表需要增长，所以它并不总是 O(1) 操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-05T01:49:31.540

这是正确的 - 在 Python 标准列表的前面插入是 O(n)。Python 列表被实现为数组，因此在列表的前面插入一些东西需要将整个内容转移到一个位置。另一方面，追加不需要任何移位，因此摊销 O(1)。

**但是请注意，这`a.pop(i)`也是一个 O(n) 操作***，因为它需要将弹出项目之后的所有内容移动到一个位置***。***因此，简单地修改您的代码以使用`append()`而不是`insert()`仍然不会产生线性算法。*

 *不会使用线性时间算法，`pop()`而是会执行诸如交换元素之类的操作，以便不必修改列表的其余部分。例如，考虑一下：

```
def even_to_front(a_list):
    next_even = 0
    for idx in xrange(len(a_list)):
        if not a_list[idx] % 2:
            # a_list[idx] is even, so swap it towards the front
            a_list[idx], a_list[next_even] = a_list[next_even], a_list[idx]
            next_even += 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T02:38:04.617

这是在没有附加/插入或出列的情况下如何完成的

```
def sort(L):
    i, j = 0, len(L)-1
    while i<j:
        # point i to the next odd number from the start
        while i<j and not L[i]%2: i+=1
        # point j to the next even number from the end
        while i<j and L[j]%2: j-=1
        L[i],L[j] = L[j],L[i] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T01:49:22.410

检查这个[复杂度表](http://wiki.python.org/moin/TimeComplexity)

*   插入 - O(n)
*   追加 - O(1)（列表过度分配）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T01:51:12.067

每次`pop`从列表中获取元素时，都必须*复制*列表的尾随部分以将其移动到一个索引上，以填补被移除元素留下的空洞。这在弹出元素和列表尾部之间的距离是线性的。

每次`insert`将元素放入列表时，都必须*复制*列表的尾随部分以将其移动到一个索引上以创建插入新元素的位置。这在插入元素的位置与列表尾部之间的距离是线性的。

如果使用`collections.deque`，则可以及时追加和弹出到前面和后面`O(1)`。但是，从中间删除一个元素仍然是线性的（我认为您必须自己编写）。*

# android - 多个文本视图在线性布局中未正确对齐

> ID：11336983
> 
> 赞同：0
> 
> 时间：2012-07-05T01:47:15.453
> 
> 标签：android, layout, textview, alignment

我正在尝试在我相当简单的布局中添加 8 个文本视图。我想每行有两个文本视图和四个这样的行。我的挑战是在此布局中排列第 2、第 4、第 6 和第 8 个文本视图。第 1、3、5 和 7 个文本视图的文本长度不同。

我无法将每行中的 seocnd 文本视图排列成垂直对齐。

基本上，这些文本视图需要从垂直对齐的同一行开始，无论该行中第一个文本视图的长度是多少：

有人可以帮忙吗？

这是我的 XML。

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/productDetailsLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/white"
android:orientation="vertical" >

<include
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    layout="@layout/logo_logout" />

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="10dp" >

    <TextView
        android:id="@+id/ProductDetailsTitle"
        android:layout_width="wrap_content"
        android:layout_height="43dp"
        android:layout_marginTop="10dp"
        android:background="@color/Navy"
        android:gravity="center"
        android:text="@string/ProductDetailsTitle"
        android:textColor="@color/white"
        android:textSize="20dp"
        android:textStyle="bold" />

    <Button
        android:id="@+id/ProductDetailsEditButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:layout_weight="0.36"
        android:text="Edit"
        android:textSize="20dp" />
</LinearLayout>

<include
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    layout="@layout/product_details_mainpage_part1" />

<include
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    layout="@layout/product_details_mainpage_part2" />

<include
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    layout="@layout/product_details_mainpage_part3" />

<include
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    layout="@layout/product_details_mainpage_part44" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T05:23:28.697

也许这会有所帮助。您可以使用`background color`, 和`top padding`每个`TextView`来使其成为您想要的样子。希望这可以帮助。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:baselineAligned="false"
    android:id="@+id/RelativeLayout"
    android:background="#ffffffff"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
        android:id="@+id/background"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="vertical" >

    <TextView
        android:id="@+id/ProductDetailsTitle"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello, I am tired" />

    <TextView
        android:id="@+id/ProductDetailsTitle2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello" />

    <TextView
        android:id="@+id/ProductDetailsTitle3"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello" />

    <TextView
        android:id="@+id/ProductDetailsTitle4"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello" />
   </LinearLayout>

   <LinearLayout
       android:id="@+id/background2"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:layout_weight="1"
       android:orientation="vertical" >

    <TextView
        android:id="@+id/ProductDetailsTitle5"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"            
        android:background="#ffffffff"
        android:paddingTop="50dp"
        android:gravity="center"
        android:text="Hello" />

    <TextView
        android:id="@+id/ProductDetailsTitle6"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello" />

    <TextView
        android:id="@+id/ProductDetailsTitle7"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello" />

    <TextView
        android:id="@+id/ProductDetailsTitle8"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#ffffffff"
        android:gravity="center"
        android:paddingTop="50dp"
        android:text="Hello, something" />

    </LinearLayout>
</LinearLayout> 
```

![在此处输入图像描述](../Images/d81bb532e62746eebed4a9aa18a8c4d5.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-23T15:07:59.057

我知道这是一个旧帖子，但我也一直在努力解决这个问题。我发现最有效的是膨胀视图，然后设置新的线性布局参数。这将导致两行和单行文本视图正确地垂直居中对齐。

```
 LayoutInflater inflater = (LayoutInflater) this.getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    TextView textView = (TextView) inflater.inflate(R.layout.workout_summary_textview, null);
    inflater = null;

    LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(width, height);
    params.gravity = Gravity.CENTER;

    textView.setLayoutParams(params); 
```

# opencv - 用 opencv 显示 gstreamer

> ID：11336984
> 
> 赞同：1
> 
> 时间：2012-07-05T01:47:17.717
> 
> 标签：opencv, gstreamer

我想知道是否可以使用 gstreamer 捕获帧并使用 opencv 显示它，或者是否有人有技巧在 gstreamer（或其他一些库）中执行等效于 cvWaitKey 的任何帮助将不胜感激！

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T18:52:08.803

您可以在管道中使用 Appsink 来获取缓冲区（最终使用 tee ！queue ！appsink）。然后，如果您愿意，可以将缓冲区中的图像与 opencv 函数一起使用。

# ios - 为什么 UIImageJPEGRepresentation 方法会改变 imageData 大小

> ID：11336986
> 
> 赞同：1
> 
> 时间：2012-07-05T01:47:57.240
> 
> 标签：ios

如上所述，当我使用 UIImageJPEGRepresentation 到 NSData *imageData = UIImageJPEGRepresentation(self.selectedPic, 1.0); imageData变得比第一个大？比如从100KB到300KB这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:53:15.490

这可能是因为您正在创建最高质量（或最小压缩）的 jpeg。第二个参数`UIImageJPEGRepresentation`指定从 0 到 1 范围内的输出图像质量。尝试将其设置为不同的值，例如 0.5，看看它如何减小图像数据的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:53:26.573

可能是因为您使用的是“完美质量”（或 1.0 压缩设置）。把它调低一个档次。另外，接受您以前的一些答案。13 个问题且不接受是不可接受的。

# ios - 子类 UIView 错误

> ID：11336987
> 
> 赞同：0
> 
> 时间：2012-07-05T01:47:59.823
> 
> 标签：ios, uiview, core-animation

当我将 xib 类设置为 UIView 的子类然后`animateWithDuration`在 UIView 上我得到

```
No visible @interface for 'UIView' declares the selector
'animateWithDuration:delay:options:animations:completion:' 
```

错误窗格显示这是一个 ARC 问题

![在此处输入图像描述](../Images/33575efc030d0a8a9f9d63771976398c.png)

我正在尝试在 UIView 上运行动画。

编辑：导致错误的代码

```
 [sampleSourceView.view animateWithDuration:1
                                             delay:1.0
                                           options: UIViewAnimationCurveEaseOut
                                        animations:^{
                                            sampleSourceView.view.frame = sampleSourceFrame;
                                        } 
                                        completion:^(BOOL finished){
                                            NSLog(@"Done!");
                                        }];

        [self.view addSubview:sampleSourceView.view]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-05T02:07:13.333

您收到错误是因为您试图在 UIView 的实例上使用类方法。查看方法签名：

```
+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion 
```

加号表示它是一个类方法。实例方法将有一个减号。

试试这个：

```
[UIView animateWithDuration:1
                     delay:1.0
                   options: UIViewAnimationCurveEaseOut
                animations:^{
                    sampleSourceView.view.frame = sampleSourceFrame;
                } 
                completion:^(BOOL finished){
                    NSLog(@"Done!");
                }]; 
```

# python - 元素在容器中或容器内的容器中。（Python）

> ID：11336991
> 
> 赞同：0
> 
> 时间：2012-07-05T01:49:11.800
> 
> 标签：python, simplification

有没有更好的编码方法？

```
def __contains__(self, e):
    return e in self.segments or True in [e in x for x in self.segments] 
```

如果 e 在 self.segments 中或如果 e 在 self.segments 中的任何段中，此函数应返回 true。

我仍在尝试学习如何使用 [a for a in b if c] 符号，我希望 StackOverflow 的某个人可以帮助我简化该代码段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T01:53:11.020

```
def __contains__(self, e):
    return e in self.segments or any(e in x for x in self.segments) 
```

`any`在计算结果为的第一个元素上停止，`True`并且没有方括号，Python 不会创建中间列表。

阅读[生成器表达式与列表理解](https://stackoverflow.com/questions/47789/generator-expressions-vs-list-comprehension)

# php - 网站超时而不是单个网页

> ID：11336993
> 
> 赞同：0
> 
> 时间：2012-07-05T01:49:23.083
> 
> 标签：php, javascript, jquery, cookies

我正在开发一个网站，如果我出于某种原因需要引入安全性，我的网站会在 10 分钟不活动后自动将用户注销。行为是，在大约 8 分钟不活动时，会弹出一个 jquery ui 对话框，警告用户他们即将超时。用户可以选择保持登录状态、立即退出或什么都不做，然后在 10 分钟结束时强制退出。我通过一个超时（没有鼠标/键盘事件）的javascript代码片段来实现这一点，并在用户执行我认为的“活动”时重置。

我的问题是我可以让这个东西为我的单个网页运行，但不知道如何将它用于完整的域。我也想过用 cookie 来实现这一壮举，但不太确定。如果有人能建议我为我的任务采取什么方法，那将是很好的选择。bly 与代码示例

让这个超时脚本在我的完整域而不是单个网页上运行。可能使用 cookie 或其他东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:56:20.753

我建议不要使用 javascript 并创建一个完整的 PHP 解决方案。

这可以通过在每个 PHP 页面上为用户提供一个 10 分钟后过期的 cookie 来实现。这样，每次访问都会更新 cookie，如果他们在十分钟后回来，cookie 就会消失，系统将不再识别它们。

我还建议不要使用会话，它们很容易变得混乱，并且如果您想扩展到多台机器以进行负载平衡，则几乎无法管理。这不是一个现实的生产工具。

每个页面都调用这个 - 这将检查他们是否已经有一个 cookie，如果有，它将用相同的值更新它十分钟（60 秒乘以十分钟）。您可以将“用户”的 cookie 名称更改为您想要的任何名称。

```
if(isset($_COOKIE['user'])){
     setcookie('user', $_COOKIE['user'], time()+60*10);

     //put your user validation code here to make sure the cookie is real
     //then you can put your logged in specific data under it.
} 
```

要首先授权用户，很可能是在他们登录时，您可以这样做：

```
setcookie('user', $value, time()+60*10); 
```

如果你想注销某人，你可以这样做：

```
setcookie('user', '', 0); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:55:27.513

您可以通过将他们的会话 cookie 设置为 10 分钟后过期来做到这一点。用于[`session_set_cookie_params()`](http://us.php.net/manual/en/function.session-set-cookie-params.php)设置 cookie 的持续时间（第一个参数）。

```
session_set_cookie_params(600, '/', 'www.example.com', false, false);
session_start(); 
```

确保你之前调用它`session_start()`。

然后，您将使用 JavaScript 检查 cookie 的 expires 参数。如果它接近过期时间，那么您将使用相同的 JavaScript 向他们显示对话框警告他们的会话即将过期

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T01:58:18.927

您可以为此使用会话和/或 cookie。您使用它们的方式是，在您网站的每个页面中，您首先检查 cookie/会话，然后才继续。因此，如果您的用户已注销一次，并尝试转到网站上的另一个页面，他/她将首先必须登录，然后才能继续，因为该会话不再可供该用户使用。

这种东西——

```
<?php

if( $this->session->userdata('logged_in') == FALSE )
{
    // Login again 
}
else
{
    // Display the page
}

?> 
```

# postgresql - 从 Node / Postgres 中的 pg 模块输出行

> ID：11336994
> 
> 赞同：0
> 
> 时间：2012-07-05T01:49:24.633
> 
> 标签：postgresql, node.js

在我的 Node 应用程序中，我想连接到 postgresql 数据库以对实体进行一些工作。但我无法让它与 Node.js 一起使用。我已经使用 psycopg2 从 Python 脚本成功连接并查询了数据库，所以我知道连接部分可以工作。

```
var DB_URL = "postgres://admin@localhost/mydb_development"
var db = new pg.Client(DB_URL);
db.connect();

.... more stuff here ....    

app.get('/test', function(request, response) {
  response.setHeader('Content-Type', 'text/plain');
  response.write("First!\n");
  var i = 0;
  var query = db.query("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'", []);
  query.on('row', function(row) {
    console.log(row['table_name']);
    i++;
    response.write(String(row['table_name']) + "\n");
  });
  response.write("\nHello db; variable i=" + i + "!");
  response.end();
}); 
```

我发现 console.log(row['table_name']) 成功地将表名输出到控制台。但是，看起来响应变量和 i 在闭包内都不可用......那么我到底应该如何获得查询的结果来处理它？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:21:23.793

`response`变量可用但不可写，因为您已经`end`对其进行了编辑。 `i`也应该可用，但是在您将其写入响应时，它尚未增加。

在获得所有行之后，您可能想要`end`它（并写最后一行）。可以这样实现：

```
var DB_URL = "postgres://admin@localhost/mydb_development"
var db = new pg.Client(DB_URL);
db.connect();

.... more stuff here ....    

app.get('/test', function(request, response) {
  response.setHeader('Content-Type', 'text/plain');
  response.write("First!\n");
  var i = 0;
  var query = db.query("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'", []);
  query.on('row', function(row) {
    console.log(row['table_name']);
    i++;
    response.write(String(row['table_name']) + "\n");
  });
  query.on('end', function () {
      response.write("\nHello db; variable i=" + i + "!");
      response.end();
  });
}); 
```

# coding-style - 从新项目中的外部库子类化时的样式一致性？

> ID：11336998
> 
> 赞同：1
> 
> 时间：2012-07-05T01:50:15.123
> 
> 标签：coding-style

添加到现有项目时，保持一致的风格很重要。但是，当项目的标准和库的标准之间存在明显差异时，如果在新项目中从库中大量继承，该怎么办？

我正在开发一个具有特定编码风格的项目，特别是在涉及如何命名这些类中的类和方法时。然而，该项目的一个模块 UI 严重依赖外部库，并且该模块中的*大多数*类将重载该库。在这种情况下，它是 Qt，但它可以是任何东西。

在这种情况下，是坚持 API 使用的风格还是使用项目风格的新功能更好？例如，Qt 使用`camelCase`它的函数声明，而这个项目使用`UpperCase`. 考虑这样的事情：

```
class MyNewWidget : public QWidget {
    Q_OBJECT
public:
    void setVisible(bool visible); // QWidget override
    void SetNewFeature(std::string feature_key); // New function

    bool visibility() const; // I know you can't override that, but bear with me
    std::string GetNewFeature() const; // propertyName() vs GetPropertyName()
}; 
```

这感觉与从使用`lower_case`. 在这种情况下，至少在某些情况下有一些很好的理由遵循约定，例如，当 typedef'ing`iterator`类型时，或者如果您希望您的`begin`/ `end`/`swap`函数可以被`<algorithm>`et al 使用。

但我在这个墙上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T01:31:01.957

在可能的情况下，我会努力为每个类/文件/模块保持单一样式。当你试图想一个方法的名字时，困难就来了，你越少让别人停下来思考越好。当然，一个好的 IDE/编辑器应该纠正你的情况。

另一种选择是支持组合而不是继承。这意味着您将使用在内部委托给 Qt 方法的项目样式编写新方法。如果这完全是一个问题，它将为您提供不与 Qt API 绑定的额外好处。