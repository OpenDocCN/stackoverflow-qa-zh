# StackOverflow 问答 000927000-000927999

# svn - 使用 SharpSvn 编写预提交挂钩。它是否缺少 svnlook propget？

> ID：927005
> 
> 赞同：2
> 
> 时间：2009-05-29T16:48:37.830
> 
> 标签：svn, hook, sharpsvn, pre-commit

我正在重写一个旧的颠覆预提交钩子。在我们公司，我们需要确保只有在提交前设置了属性 svn:needs-lock 时才允许提交二进制文件。

我开始编写钩子，看起来钩子的每个部分都有效，但是如果设置了属性，我找不到如何阅读。

我会假设，SvnLookClient 会有 SvnLookClient.GetProperty 方法，但我看到的唯一一个是 SvnLookClient.GetRevisionProperty。不幸的是 GetRevisionProperty 不允许传递有问题的文件。我在这里想念什么？

毕竟，svnlook propget 确实允许传递存储库、事务、属性名和存储库中的路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T12:19:12.883

请参阅此[SharpSvn 用户邮件列表线程](http://sharpsvn.open.collab.net/ds/viewMessage.do?dsForumId=728&dsMessageId=323605)。

该功能于周二添加到 Subversion 主干中，并于昨天向后移植到 1.500x。

# linq-to-sql - LINQ to SQL - 无法修改存储过程的返回类型

> ID：927006
> 
> 赞同：21
> 
> 时间：2009-05-29T16:48:39.373
> 
> 标签：linq-to-sql, stored-procedures, asp.net-3.5

当我将一个特定的存储过程拖到 VS 2008 dbml 设计器中时，它会显示返回类型设置为“无”，并且它是只读的，所以我无法更改它。设计器代码将其显示为返回一个 int，如果我手动更改它，它只会在下一次构建时撤消。

但是使用另一个（几乎相同的）存储过程，我可以很好地更改返回类型（从“自动生成的类型”到我想要的。）

我在两台不同的机器上遇到了这个问题。知道发生了什么吗？

这是有效的存储过程：

```
USE [studio]
GO
/****** Object:  StoredProcedure [dbo].[GetCourseAnnouncements]    Script Date: 05/29/2009 09:44:51 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[GetCourseAnnouncements]
    @course int
AS
SELECT * FROM Announcements WHERE Announcements.course = @course
RETURN 
```

而这个没有：

```
USE [studio]
GO
/****** Object:  StoredProcedure [dbo].[GetCourseAssignments]    Script Date: 05/29/2009 09:45:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[GetCourseAssignments]
    @course int
AS
SELECT * FROM Assignments WHERE Assignments.course = @course ORDER BY date_due ASC
RETURN 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-08-28T05:44:13.743

我也多次看到这个问题，虽然我不知道是什么原因造成的，但我遇到了一个非常简单的方法来解决它。它涉及手动编辑 .dbml 文件中的 xml，但这是一个非常简单的编辑。

右键单击`.dbml`解决方案资源管理器中的数据上下文文件（不是 .layout 文件或 Designer.cs 文件），然后使用 XML 编辑器打开它。**`<Function> ... </Function>`**您应该会在一个块中找到您的存储过程。您还应该找到要设置为**`<Type> ... </Type>`**块中列出的返回类型的自定义类。

第一步是给你的自定义类一个标识符。您可以像这样添加一个“Id”标签，确保它在 dbml 文件中是唯一的：

```
<Type Name="MyCustomClass" Id="ID1"> 
```

第二步是告诉你的函数使用新的 ID 类型作为返回类型。您可以通过*替换*`<Function>`块中看起来像的行来做到这一点

```
<Return Type="System.Int32" /> 
```

和

```
<ElementType IdRef="ID1" /> 
```

保存文件，退出并重建。完毕。在设计模式下重新打开 .dbml 文件以验证：您的过程现在将自定义类设置为返回类型。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-11-25T16:19:15.373

我有一个类似的映射问题，但我发现了我的罪魁祸首。

如果您的过程或任何被调用的子过程具有临时对象，例如

```
CREATE TABLE #result (
   ID INT,
   Message VARCHAR(50)
) 
```

那么你就有麻烦了，即使你没有选择这些临时的任何东西。

映射器对这些临时对象有一个普遍的问题，因为可以在会话上下文中的过程之外更改类型。临时对象对映射器来说不是类型安全的，他拒绝使用它们。

用表变量替换它们，您就可以重新开始工作了

```
DECLARE @result AS TABLE (
   ID INT,
   Message VARCHAR(50)
) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-03-30T08:46:16.040

我按照[托尼提供的链接](http://tonesdotnetblog.wordpress.com/2010/06/02/solution-my-generated-linq-to-sql-stored-procedure-returns-an-int-when-it-should-return-a-table/)寻求更好的解决方案（与阿拉什的答案相同）

*   请阅读博客，尤其是最后一部分，因为在存储过程中添加**SET FMTONLY OFF**时需要考虑一件事。

当你添加

```
 SET FMTONLY OFF 
```

在存储过程开始并将其加载到 DBML 时，
LINQ2SQL 将执行实际的存储过程。

为了获得正确的返回表对象类型，
所述存储过程在调用无参数时必须返回一些内容。
这意味着：
1\. 为所有输入参数设置默认值
2\. 确保 SP 至少返回一行数据——这是我偶然发现的地方

```
create table #test ( text varchar(50) );
insert into #test (text) values ('X'); -- w/o this line, return type would be Int32
select * from #test; -- SP returns something, proper object type would be generated
return; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-29T21:50:50.313

好吧，我发现了问题……有点。我更改了“Assignments”表的名称，忘记更新存储过程，所以 DBML 设计者很困惑。但是即使在我更新了存储过程，从 DBML 设计器中删除它并读取它之后，它仍然无法正常工作！

这与此处讨论的问题几乎相同：[http](http://forums.asp.net/t/1231821.aspx) ://forums.asp.net/t/1231821.aspx 。

只有当我从数据库中删除存储过程并重新创建它，然后从 DBML 设计器中删除它，重新编译，重新启动 Visual Studio 并再次添加它时，它才有效。这是我第二次遇到 Visual Studio DBML 设计器的“刷新”问题......

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-11-21T20:32:24.830

我设法找到了一种更简单的方法，这在当时并不明显，但写下来时听起来很直接：

1.  从 .dbml 文件的设计图面上删除存储过程
2.  单击保存所有文件
3.  在存储过程列表上单击服务器资源管理器中的刷新
4.  将存储过程添加（拖动）回 .dbml 文件的设计图面上
5.  点击全部保存
6.  点击构建
7.  检查 Designer.cs 代码文件，您将获得新版本存储过程的更新 C# 代码

检查[http://www.high-flying.co.uk/C-Sharp/linq-to-sql-can-t-update-dbml-file.html](http://www.high-flying.co.uk/C-Sharp/linq-to-sql-can-t-update-dbml-file.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-29T16:20:44.033

我有同样的问题，但只有当我的 sp 使用 FTS 时才会发生，我所做的是“欺骗”dbml 设计器，我删除了 fts 语言的东西并且工作得很好，现在我可以更改返回类型。后来我去 sp 并再次添加 fts 并完美地工作！希望这有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-16T03:56:40.330

解决这个问题的方法是：

1.  添加“设置 fmtonly 关闭；” 到存储过程的开头。
2.  添加该语句后，获取 DBML 为您的存储过程生成代码。

如果您的存储过程的返回类型在您的 DBML 代码中仍然是“int”，请注释整个存储过程代码，创建一个新的 SELECT 语句，其返回字段类型和名称与原始的 SELECT 语句匹配，并让 DBML 重新生成代码。它必须工作！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-02T09:16:14.700

感谢@Rubenz，我还在存储过程中使用了 FTS（全文搜索）并且您的步骤有效。

我从存储过程中注释了 FTS 部分，将存储过程添加到 .dbml，然后将 FTS 部分取消注释为原始部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-23T05:25:51.267

在存储过程中使用 sql 用户定义类型作为参数时也会发生这种情况

[http://alejandrobog.wordpress.com/2009/09/23/linq-to-sql-%e2%80%94-can%e2%80%99t-modify-return-type-of-stored-procedure/](http://alejandrobog.wordpress.com/2009/09/23/linq-to-sql-%e2%80%94-can%e2%80%99t-modify-return-type-of-stored-procedure/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-07T03:13:32.517

在这里找到更好的解决方案：http: [//tonesdotnetblog.wordpress.com/2010/06/02/solution-my-generated-linq-to-sql-stored-procedure-returns-an-int-when-it-should-return -一张桌子/](http://tonesdotnetblog.wordpress.com/2010/06/02/solution-my-generated-linq-to-sql-stored-procedure-returns-an-int-when-it-should-return-a-table/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-13T08:52:52.177

好的，我不想更改我的 Designer.cs 代码中的任何内容，我知道有一个不同的问题，它与我的存储过程无关（无论如何我没有使用临时表）。

简单地从数据库中删除 sp 并更新模型根本没有帮助。创建的新模型仍然存在相同的问题...

我发现由于某种原因，我的 sp 副本是在 DatabaseModel -> Function Imports 中创建的。

我所做的是，我删除了 Function Imports 中的重复对象并更新了模型。有效！

问候，克里斯

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-31T14:26:51.050

我意识到这是一个老问题，但上述建议为我指明了正确的方向，但在我的情况下不起作用。如上所述，我最终在 Visual Studio 中使用 XML 编辑器编辑了 dbml 文件。

进入文件后，查找存储过程的 Function 部分。您很可能看不到定义返回类型的元素类型部分。我开始从另一个Function（存储过程）编辑字段，发现这太繁琐了，可能会引入问题。

我决定从 ElementType 中删除所有 Column 定义 - 但保留 ElementType 部分并保存文件。然后我从设计器中删除了存储过程并重新添加了它。然后它在 ElementType 中填写正确的列。工作得很漂亮。

# apache-flex - 如何将影片剪辑漂浮在文本区域上以使其看起来像是文本的一部分？

> ID：927015
> 
> 赞同：0
> 
> 时间：2009-05-29T16:49:50.573
> 
> 标签：apache-flex, flash, actionscript

看看[这个演示](http://www.textflow.com/testdrive/)，他们是如何完成 Inline Changes 功能的？对我来说，他们看起来像是在 textarea 上浮动一个电影剪辑。

我想不通的是他们如何将影片剪辑固定在正确的位置。如果您在影片剪辑之前键入一些内容，它会随着文本移动位置，当文本换行时，影片剪辑甚至会移动到下一行。有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T16:56:45.947

我认为他们正在做的是跟踪精灵所代表的索引。然后他们有一个很好的功能，可以根据文本框和字体的大小将精灵移动到正确的位置。之后您需要做的就是将定位功能绑定到对文本框所做的更改，然后您就获得了这种效果。似乎不太复杂，因为已经有可用的字体大小/位置功能。

编辑：请注意您如何不能在重叠区域之间键入代码。

# sharepoint - SharePoint 列表列今天的日期

> ID：927021
> 
> 赞同：4
> 
> 时间：2009-05-29T16:51:09.667
> 
> 标签：sharepoint

全部，

有谁知道如何在 SharePoint 列表中创建一个在呈现时始终显示今天日期的列？我见过需要每天修改列表/项目的技巧，但这不是我想要的。我只想要一列，每当查看列表时，它都会显示当前日期。

感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T18:59:17.430

我想说您使用计算列，但不幸的是，根据[此链接](http://office.microsoft.com/en-us/sharepointtechnology/HA011609491033.aspx)TODAY 函数作为默认值受支持，但在计算列中不受支持。

因此，在默认值之外，唯一的方法可能是通过更多的努力。我看到两个选项：

*   使用 SharePoint Designer 和[数据表单 Web 部件](http://masteringsharepoint.com/blogs/beagle/archive/2008/08/13/DFWP1.aspx)将视图显示到列表中，其中包含具有今天日期的附加列。

*   执行此操作的正确方法可能是计算字段，因为它不涉及存储任何附加信息，而只是显示附加信息。我没有找到一个只讨论计算域的好链接，但是[这个链接](http://office.microsoft.com/en-us/sharepointdesigner/HA102390461033.aspx)确实有点深入。

# python - 将 mx:RemoteObject 与 web2py 的 @service.amfrpc 装饰器一起使用

> ID：927028
> 
> 赞同：2
> 
> 时间：2009-05-29T16:52:51.193
> 
> 标签：python, apache-flex, flex3, web2py, pyamf

我正在使用 web2py (v1.63) 和 Flex 3。web2py v1.61 引入了 @service 装饰器，它允许您使用 @service.amfrpc 标记控制器功能。然后，您可以使用远程调用该函数`http://..../app/default/call/amfrpc/[function]`。请参阅[http://www.web2py.com/examples/default/tools#services](http://www.web2py.com/examples/default/tools#services)。有没有人举例说明如何设置 Flex 3 来调用这样的函数？这是我到目前为止所尝试的：

```
<mx:RemoteObject id="myRemote" destination="amfrpc" source="amfrpc"
    endpoint="http://{mysite}/{myapp}/default/call/amfrpc/">
    <mx:method name="getContacts"
        result="show_results(event)"
        fault="on_fault(event)" />
</mx:RemoteObject> 
```

在我的场景中，目标和源属性的值应该是什么？我已经阅读了几篇关于非 web2py 实现的文章，例如[http://corlan.org/2008/10/10/flex-and-php-remoting-with-amfphp/](http://corlan.org/2008/10/10/flex-and-php-remoting-with-amfphp/)，但他们使用 .../ gateway.php 文件，而不是直接映射到函数的 URI。

或者，我已经能够使用 flash.net.NetConnection 成功调用我的远程函数，但我发现的大多数文档都认为这是旧的、Flex 3 之前的 AMF 方式。请参阅[http://pyamf.org/wiki/HelloWorld/Flex](http://pyamf.org/wiki/HelloWorld/Flex)。这是网络连接代码：

```
gateway = new NetConnection();
gateway.connect("http://{mysite}/{myapp}/default/call/amfrpc/");
resp = new Responder(show_results, on_fault);
gateway.call("getContacts", resp); 
```

-抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:37:12.250

我还没有找到将 RemoteObject 与 @service.amfrpc 装饰器一起使用的方法。但是，我可以使用 NetConnection（类似于我最初发布的内容）使用较旧的 ActionScript 代码，并将其与 web2py 端的 @service.amfrpc 函数配对。这似乎工作正常。您想要在我最初共享的 NetConnection 代码中更改的一件事是为连接状态添加一个事件侦听器。如果您觉得需要，您可以添加更多侦听器，但我发现 NetStatusEvent 是必须的。如果服务器没有响应，将触发此状态。您的连接设置如下所示：

```
gateway = new NetConnection();
gateway.addEventListener(NetStatusEvent.NET_STATUS, gateway_status);
gateway.connect("http://127.0.0.1:8000/robs_amf/default/call/amfrpc/");
resp = new Responder(show_results, on_fault);
gateway.call("getContacts", resp); 
```

-抢

# c# - 当整个团队离开时，如何维护一个项目？

> ID：927031
> 
> 赞同：3
> 
> 时间：2009-05-29T16:53:13.643
> 
> 标签：c#, maintenance

在我们公司管理一个项目的整个程序员团队已经离开公司开始自己的事业。

我该如何继续？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-29T16:54:46.963

新公司招人了吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-29T16:59:15.180

第一步是收集他们项目当前可用的所有信息，并确保它得到适当的保护——源代码控制、文档等。

如果您发现该信息丢失，我建议您与离开的开发人员联系。大多数专业开发人员都对维护他们留下的代码感兴趣，而那些离开组建自己的公司的人很可能对与您的公司保持良好关系有既得利益。

一旦您掌握了您以前的开发人员正在从事的项目的状态，将其提交给管理层并要求必要的资源（新开发人员等）。他们知道该项目需要很多人来支持过去。这个数字并没有因为人们离开而下降。事实上，它几乎总是会上涨。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-29T17:08:20.737

我讨厌提出法律方面的问题，但如果他们离开去创办一家新公司，而这家公司是你的竞争对手，那么你应该寻求法律建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T17:04:13.440

首先想到的是——他们是否提供了任何类型的过渡信息（文档、与将接手的人的会议等？）作为承包商，我编写的代码将成为其他人的责任。在项目结束时，通常会有一个交接期，客户可以在此查看代码并提出问题。

尽管在您的情况下是前雇主的内部项目，但似乎会遵循类似的过程。如果不是这种情况，有什么方法可以向前员工提出问题吗？他们肯定不会像他们还在你的办公室那样响应迅速，但他们可能愿意帮助这个过程......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T17:08:52.967

不知道您的具体情况，目前很难超越一些一般性。

您需要能够回答的问题：

源代码是否受源代码控制？

你甚至有源代码吗？

软件当前版本的状态如何？

有文件吗？

它应该做什么？你对大局有清晰的认识吗？

您处于构建/发布周期的哪个阶段？

您内部还有谁可以帮助评估情况？

您是否有合同义务尽快交付某些东西？您与客户的关系如何？他们了解情况吗？

当整个团队跳槽时，如果需要大量的领域专业知识和知识，或者如果内部开发人员不具备必要的技能来开始工作以接手旧团队离开的地方，那么项目可能会死亡离开。

另一个问题是“你能在顾问的基础上得到前开发人员的任何时间来帮助新团队加快速度吗？” 那可能是你拯救项目的一击。如果可以的话，我会追求这个角度。

祝你好运！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-29T17:18:19.320

我们倾向于利用减员作为引进更好人才的机会。并不是说这不是挫折，而是让您的公司变得更强大的绝佳机会。一定要弄清楚团队离开的原因，这样你就可以为新员工解决问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-29T17:34:31.330

就像其他人提到的那样，除了希望

*   有文档
*   代码在源代码控制中
*   你有机会雇用新人等。

我会把这当作一个新的机会，把它当作一个挑战，从过去的错误中吸取教训并继续前进。如果你是积极的，你很可能会成功。

否则，另一种选择是检查您是否可以考虑在他们的新公司中担任任何职位，如果他们喜欢您，他们可能会雇用您担任相同或不同的角色，或者他们可能不会。

我会选择第一个选项。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-29T16:56:47.677

他们有没有写任何文件？如果是这样，您可能还有机会。我认为这完全取决于他们留下的代码的质量。如果它真的是高质量的代码，你可能会毫无问题地找到人来继续工作。

如果代码是废话......好吧......祝你好运。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-29T17:22:30.377

我给你的建议是开始大量饮酒。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-29T17:33:03.203

您需要获取在项目中可以找到的尽可能多的文档。然后我会尝试在公司的其他开发人员之间划分项目的模块，让他们尽快升级，然后报告回来，这样每个人都能很好地了解产品。

祝你好运。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-03T21:06:18.430

也有可能他们中的一个或多个愿意收费并与您的新开发人员讨论他们需要知道的内容（取决于他们离开公司的专业程度（这表明您是否真的需要他们的帮助）和当他们宣布辞职时，你对他们的待遇如何（这是他们是否愿意不惜一切代价回来的一个指标）。尽管如此，预计要支付他们之前每小时工资的 3 或 4 倍。

如果他们在某些国家/地区未经通知就离开了，您可能有追索权。咨询公司律师。如果您在他们试图发出通知时终止了他们，那么您应该得到什么，因为在他们离开之前没有机会挑选他们的大脑。

如果该项目尚未投入生产，并且取决于当前的截止日期，那么重新开始可能比试图找出他们的垃圾更容易。如果他们在截止日期前离开，没有通知也没有记录他们在做什么，那么如果你能提供帮助，你可能不想使用他们的代码，因为他们显然对公司很生气，也可能对你很生气，他们可能他们留下了定时炸弹，或者他们离开了，因为他们知道项目会失败。

如果您在公司内有其他开发人员，至少要坚持让管理层分配其中一些人，而不是雇用所有新人。有人知道您的系统和数据库以及源代码控制等是如何设置的，这会有所帮助。

让这成为你对待下一批员工的一个教训。如果他们把事情放在这样一种状态，没有人知道从哪里开始，你可能要么在对待员工的方式上犯了错误，要么在雇用他们的方式上犯了错误，如果不是两者兼而有之。真正反思是什么导致了这件事出错，并尽量不要再犯同样的错误。

# linux - 确定另一个程序的工作目录

> ID：927033
> 
> 赞同：1
> 
> 时间：2009-05-29T16:53:42.813
> 
> 标签：linux, bash, shell

有没有办法确定 Linux 中已经运行的程序的当前工作目录？

我想要实现的是我希望能够在终端中工作，然后设置一个键盘快捷键，该快捷键将运行我正在编写的工具，该工具显示一个包含一些信息和几个按钮的小弹出窗口来执行行动。该工具需要一个工作目录，以便它知道要处理哪些数据，并且我希望能够对其进行设置，以便它可以在我在终端中工作的目录上工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T16:55:16.650

/proc/PID/cwd 是 PID 工作目录的符号链接：

```
jesperes@virtual-ubuntu $ ls /proc/self/cwd
lrwxrwxrwx 1 jesperes 0 2009-05-29 18:56 /proc/self/cwd -> /home/jesperes/hacks
jesperes@virtual-ubuntu $ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T16:59:03.730

看看[getcwd()](http://linux.die.net/man/3/getcwd)

在 /proc/[pid]/cwd 中还有一个指向 cwd 的符号链接

# c# - 行更新命令上的自定义多选网格视图中断

> ID：927035
> 
> 赞同：0
> 
> 时间：2009-05-29T16:54:25.950
> 
> 标签：c#, asp.net, gridview

我有一个扩展的 GridView 类，GridViewEx，它继承自基本的 ASP.NET gridview。我重写了 CreateColumns 方法来拦截列集合并注入我自己的列，其中包含一个修改过的 CheckBoxField。

（旁注：我尝试寻找一些其他方法来存储和更新哪些行被选中，并仅使用复选框作为显示机制，但最终复选框是处理所有内容的最简单方法。）

CheckBoxField 在创建时将其 ReadOnly 属性设置为 true（并且在将其添加到列集合时保持为 true），这应该防止它作为针对 gridview 数据源的更新请求的参数传递。

正如你可能推断的那样，这并没有发生。当我尝试执行行编辑和更新时，我收到一个“参数过多”警告，其中包含一个没有名称的参数。如果我关闭多选功能，它就会消失。所以我知道我的复选框字段没有被视为只读字段。但我不知道如何解决它！

关于我需要在何处、何时或如何设置此字段以使其不会作为参数自动传递给我的更新的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T17:10:12.107

好的，想通了。

我还有一个自定义 CheckBoxField 覆盖 InitializeDataCell 并写入我自己的复选框。如果设置了 Readonly，我需要添加一个额外的检查，以便在编辑期间禁用该字段。这似乎解决了这个问题。希望这可以帮助其他可能进行自定义 GridView 编辑的人。

```
 internal class InputCheckBoxField : CheckBoxField
    {
        //... Some boilerplate for ID and other properties here

        protected override void InitializeDataCell(DataControlFieldCell cell, DataControlRowState rowState)
        {
            base.InitializeDataCell(cell, rowState);

            if (cell.Controls.Count == 0)
            {
                CheckBox chk = new CheckBox();
                chk.ID = CheckBoxID;
                chk.AutoPostBack = true;
                cell.Controls.Add(chk);

                //This was the needed check
                if(ReadOnly && rowState == DataControlRowState.Edit)
                    chk.Enabled = false;
            }
        }
    } 
```

# c++ - 有没有办法确定顶级 Qt 窗口是否已被移动？

> ID：927043
> 
> 赞同：1
> 
> 时间：2009-05-29T16:55:12.593
> 
> 标签：c++, qt, window-management

我正在尝试确定我的应用程序的主窗口何时被移动。主窗口是一个标准的 QMainWindow，我们在 QApplication 上安装了一个 eventFilter 来寻找 QMainWindow 的 moveEvents，但没有一个被触发。由于各种原因，子类化 QMainWindow 并不是一个真正的选择。

除了启动 QTimer 来不断检查位置之外，对此的任何想法都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T17:09:26.197

我想最好将事件过滤器安装在顶级窗口，而不是应用程序。但是，如果您仍然没有得到`QMoveEvent`s 并且您在 Windows 上工作，您可能可以覆盖`winEventFilter()`并等待`WM_MOVE`. 类似的功能可能适用于 Linux 和 Mac。

我通常不建议打破平台独立性，但有时它可能是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T18:16:03.087

子类化确实是最好的解决方案：-/

在实现顶层窗口的类中，您只需重载此函数：

```
virtual void moveEvent ( QMoveEvent * event ) 
```

从文档中：

> 此事件处理程序可以在子类中重新实现，以接收在事件参数中传递的小部件移动事件。当小部件收到此事件时，它已经在新位置。
> 
> 旧位置可通过 QMoveEvent::oldPos() 访问。

这应该允许您检测主窗口是否已移动。**为什么不能子类？**您是否直接使用实例`QMainWindow`？通常的用例是无论如何都要对其进行子类化。

# ruby - 在 Ruby 中为 STDOUT 格式化文本

> ID：927049
> 
> 赞同：4
> 
> 时间：2009-05-29T16:56:04.200
> 
> 标签：ruby, formatting, stdout

我正在编写一个将在 CLI 中运行的小型 Rub​​y 脚本。

为了改进界面，我需要为我输出的一些元素添加颜色/粗体。

那可行吗？如果是这样，我几乎可以肯定这是，如何？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-29T17:51:31.777

在许多终端（但不是 Windows）上，您可以使用这样的序列：`"\e[#{code}m"`，其中代码基于[这些表](http://en.wikipedia.org/wiki/ANSI_escape_code#Codes)。如果使用多个代码，则必须用分号分隔。主要代码如下：

## 强度：

```
1  Bold Intensity
4  Underline
5  Slow blink
6  Fast blink
22 Normal Intensity 
```

## 颜色：

```
Foreground 3X
Background 4X

Where X is:
-----------
0 Black
1 Red
2 Green
3 Yellow
4 Blue
5 Magenta
6 Cyan
7 White 
```

因此，例如，对于蓝色背景上缓慢闪烁的粗体绿色文本，您可以使用`"\e[5;1;32;44mWOW!\e[0m"`. 将`\e[0m`所有内容重置为终端默认值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-29T18:24:57.793

有一个 gem`rainbow`可以很容易地设置终端输出的样式。

```
sudo gem install rainbow 
```

安装后，您可以执行以下操作：

```
puts 'some text'.underline 
```

*   [https://rubygems.org/gems/rainbow](https://rubygems.org/gems/rainbow)
*   [http://github.com/sickill/rainbow/tree/master](http://github.com/sickill/rainbow/tree/master)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-18T15:41:14.100

**亲爱的鲁比人！** 我更喜欢在 Ruby 中找到默认的集成支持。在这里我找到了一些，无需安装任何 gem 就可以工作：

```
def red(mytext); "\e[31m#{mytext}\e[0m"; end
def light_red(mytext); "\e[1;31m#{mytext}\e[0m"; end
def green(mytext); "\e[32m#{mytext}\e[0m"; end
def light_green(mytext); "\e[1;32m#{mytext}\e[0m"; end
def yellow(mytext); "\e[1;33m#{mytext}\e[0m"; end
def blue(mytext); "\e[34m#{mytext}\e[0m"; end
def light_blue(mytext); "\e[1;34m#{mytext}\e[0m"; end

puts red("hello world. I don't need no color.")
puts light_red("hello world. I don't need no color.")
puts green("hello world. I don't need no color.")
puts light_green("hello world. I don't need no color.")
puts blue("hello world. I don't need no color.")
puts light_blue("hello world. I don't need no color.")
puts yellow("hello world. I don't need no color.") 
```

它适用于*puts*和*print*。

# ruby - 将 Ruby 处理程序与 Apache 集成

> ID：927056
> 
> 赞同：0
> 
> 时间：2009-05-29T16:57:15.867
> 
> 标签：ruby, .htaccess

如果您使用 Webrick，您可以使用 ruby​​ 实现一个 servlet 和服务 http 请求。现在我有代码可以做我想做的一切，但我想转移到 Apache。有没有办法修改 .htaccess 文件以通过 ruby​​ 处理程序发送所有请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T22:47:23.323

你要求[mod_ruby](http://www.modruby.net/)。

几年前放弃了，转而在 Mongrel 下的单独进程中运行 Ruby 代码，并且只使用 Apache mod_proxy（或另一个充当代理的 Web 服务器）。

现在可以使用Passenger，很多人（包括我自己）都在采用它而不是Mongrel，因为它更简单。

只是接受你第一次做错了，然后咬紧牙关。将您的代码重写为[Rack](http://rack.rubyforge.org/doc/SPEC.html)服务，并通过 Passenger 运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T17:10:01.827

你应该检查一下[phusion 乘客](http://www.modrails.com/)。它使您可以轻松地在 apache 中部署任何基于 ruby[​​ Rack的 Web 应用程序。](http://rack.rubyforge.org/)然后，您可以使用apache 中的[rails](http://rubyonrails.org/)、[sinatra](http://www.sinatrarb.com/)、[wave](http://rubywaves.com/)等。

# javascript - 在Javascript中排队并停止将点击事件传播到div内部

> ID：927058
> 
> 赞同：1
> 
> 时间：2009-05-29T16:57:23.777
> 
> 标签：javascript, html, queue

我正在尝试实现“等待 3 秒以执行此操作” `<div>`。

所以，我有一个`<div>`里面有一堆元素，我想在 3 秒内无法点击（计时器或其他事件），但以某种方式捕获队列中的事件，然后在一段时间后触发它们（或我选择的某些事件）已经过去/执行？

我认为这是一个问题，有点像建立一个模态对话框，然后在它下面没有任何可点击的东西。我这样想对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T23:27:43.633

一种可能性是让 DIV 的单击处理程序在事件冒泡时响应对其子元素的单击。该处理程序将执行排队，直到延迟过去。这是一个粗略的示例（为方便起见，使用 jQuery 事件处理）：

```
(function() {
    var isReady = false, queue = [];

    setTimeout(function() {
        isReady = true;
        processQueue()
    }, 3000);

    $("#mainDiv").click(function(ev) {
        if (isReady) {
            //code to handle the click based on which child was clicked (ev.srcElement)
        } else {
            queue.push(ev.srcElement);
        }
    });

    function processQueue() {
        var i, elem;
        for (i = 0; elem = queue[i]; i++) {
            $(elem).click(); //re-trigger the click event
        }
        queue.length = 0;
    }
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T17:01:17.687

给 div 一个 onclick 函数，它在前 3 秒开始，因为它只是持有一系列调用及其事件......然后在你的 3000 毫秒计时器完成后，运行一个改变 div 的 onclick 的函数，允许事情是编辑并运行事件数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T18:05:19.393

我发现另一件有用的事情是函数。

```
setTimeout("alert('hello')",1250); 
```

因此，使用第二种方法围绕所有元素 onclick 方法，只要您需要，该方法将存储该调用。

```
<div onclick=registerClick("normallyDoThis()")></div> 
```

然后您可以在时间开始时设置一个计时器来更改 Div 并执行所有命令。可能使用 eval 命令？

```
setTimeout("changeTheDiv()", 3000);

function changeTheDiv()
{
/*eval() all the items in a list of onclicks youve been storing up */
/*Then go through and parse out the register() from all the onclick methods*/
} 
```

我希望这有帮助

# sql - 升级数据库表以添加新列

> ID：927061
> 
> 赞同：0
> 
> 时间：2009-05-29T16:58:56.693
> 
> 标签：sql

我需要将现有的数据库表转换为添加新列的新数据库表。我有以下 sql 代码将此列的默认值设置为 -1。

```
// Insert new column for holding appWidgetIds
db.execSQL("ALTER TABLE favorites " +
   "ADD COLUMN appWidgetId INTEGER NOT NULL DEFAULT -1;"); 
```

但是如何将列的默认值设置为每行一个一个递增？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T17:09:39.020

这取决于您的 DBMS。**MySQL**使用[`AUTO_INCREMENT`](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)：

```
ALTER TABLE favorites ADD COLUMN appWidgetId INTEGER
  NOT NULL DEFAULT -1 AUTO_INCREMENT 
```

**PostgreSQL**使用[`CREATE SEQUENCE`](http://www.phpbuilder.com/board/showthread.php?t=626300)：

```
CREATE SEQUENCE favorites_seq;
ALTER TABLE favorites ADD COLUMN appWidgetId INTEGER
  NOT NULL DEFAULT -1 nextval('favorites_seq') 
```

**SQL Server**使用[`IDENTITY`](http://msdn.microsoft.com/en-us/library/aa933196(SQL.80).aspx)：

```
ALTER TABLE favorites ADD COLUMN appWidgetId INTEGER
  IDENTITY(1,1) NOT NULL DEFAULT -1 
```

作为旁注，我不知道您为什么将默认设置为-1。如果整数总是正数，你为什么要让它们有符号？您应该将默认值设为 0 以提高效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:03:36.297

这取决于您使用的 DBMS。对于 MySQL，您可以使用：

```
ALTER TABLE x ADD COLUMN y INTEGER NOT NULL DEFAULT -1 AUTO_INCREMENT 
```

见[http://dev.mysql.com/doc/refman/5.0/en/alter-table.html](http://dev.mysql.com/doc/refman/5.0/en/alter-table.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T17:06:13.547

转换后新行的值是否也会自动增加？如果没有，您可以执行 3 个步骤：

1.  ALTER 具有 NULLable 列的表
2.  使用您拥有的任何规则更新新列
3.  再次 ALTER 设置 NOT NULL。

# c++ - 将 C++ 源代码构建为库 - 从哪里开始？

> ID：927063
> 
> 赞同：4
> 
> 时间：2009-05-29T16:59:06.317
> 
> 标签：c++, entity-framework, dynamic-linking

几个月来，我编写了一些很好的通用功能，我想将其构建为库并动态链接，而不是导入 50 多个头文件/源文件。

该项目在 Xcode 和 Dev-C++ 中维护（我知道我可能必须使用命令行来做我想做的事情）并且必须链接到 OpenGL 和 SDL（在 SDL 的情况下是动态的）。目标平台是 Windows 和 OS X。

我到底在看什么？

*   如果需要，我的图书馆的入口点是什么？
*   我必须在我的代码中更改什么？（调用约定？）
*   我该如何释放它？我的理解是，头文件和编译的库（.dll、.dylib（、.framework），无论它是什么）都需要可用于项目 - 特别是因为模板功能本质上不能包含在库中。
*   我还需要注意什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-29T17:55:17.433

我建议构建为 statc 库而不是 DLL。如果您这样做，很多导出 C++ 函数和类的问题都会消失，前提是您只打算与构建库时使用的同一编译器生成的代码链接。

构建静态库非常简单，因为它只是 .o/.obj 文件的集合——有点像 ZIP 文件，但没有压缩。无需导出任何内容 - 只需将库包含在应用程序链接的文件列表中即可。要访问特定的函数或类，只需包含相关的头文件。请注意，您无法摆脱头文件 - C++ 编译模型，尤其是模板，取决于它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T17:10:55.523

从动态库中导出 C++ 类库可能会有问题，但这是可能的。
您需要标记要从 DLL 导出的每个函数（语法取决于编译器）。我正在四处寻找是否可以从 xcode 中找到如何做到这一点。在 VC 中是 __declspec(dllexport) 而在 CodeWarrior 中是 #pragma export on/#pragma export off。

如果您只在内部使用二进制文件，这是完全合理的。但是，一个问题是不同的编译器对 C++ 方法的命名不同。这意味着使用不同编译器的任何人都无法使用您的 DLL，除非您只导出 C 函数。

此外，您需要确保 DLL 和 DLL 客户端中的调用约定匹配。这要么意味着您应该将相同的*默认*调用约定标志传递给 DLL 或客户端的编译器，或者更好的是，在 DLL 中的每个导出函数上显式设置调用约定，这样默认值无关紧要是给客户的。

这篇文章解释了命名问题： [http ://en.wikipedia.org/wiki/Name_decoration](http://en.wikipedia.org/wiki/Name_decoration)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T18:14:05.617

C++ 标准没有定义标准 ABI，这对于试图构建 C++ 库的人来说是个坏消息。这意味着您从编译的代码中获得不同的行为，具体取决于用于编译它的标志，这可能会导致编译和链接正常的代码中出现神秘的错误。

这不仅限于不同的调用约定——可以编译 C++ 代码以支持或不支持 RTTI、异常处理，以及可以影响 C++ 代码所依赖的类实例的内存布局的各种优化。

所以，你可以做什么？我会在我的源代码树中构建 C++ 库，并确保它们是作为项目构建的一部分构建的，并且所有库和链接到它们的代码都使用相同的编译器标志。

请注意，名称修改至少应该阻止您链接使用不同编译器/编译器标志编译的目标文件，但大多数情况下，您可以做一些事情，尤其是使用 GCC，这将导致代码链接很好，在运行时失败。

您必须格外小心供应商提供的动态 C++ 库（例如，大多数 Linux 发行版上的 QT。）例如，某些 Redhat Linux 版本（可能全部）禁用 QT 中的异常，如果异常在 QT 回调中抛出，则无法在 main() 中捕获异常。乐趣。

# visual-studio-2008 - 在 VSTestHost 下运行 WatiN 测试的线程问题

> ID：927064
> 
> 赞同：2
> 
> 时间：2009-05-29T16:59:09.827
> 
> 标签：visual-studio-2008, testing, tfs, watin, vstesthost

我已经在我的开发环境上运行了一个简单的 WatiN Web 测试，并试图让它在 TFS 构建服务器上运行。WatiN 正在引发异常：

```
System.Threading.ThreadStateException：CurrentThread 需要拥有它
ApartmentState 设置为 ApartmentState.STA 以便能够自动化 Internet Explorer。

```

测试运行器 VSTestHost 默认使用 STA 线程。我还尝试通过 .testrunco​​nfig 文件明确地将其强制为 STA。WatiN 仍然不高兴。我在 Windows Server 2008 上使用 Visual Studio/TFS 2008。

有没有其他人遇到这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-04T05:05:22.160

您可能想要检查/使用`[STAThread]`WatiN 测试方法的属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T21:59:37.563

按照您的建议编辑 testrunco​​nfig 应该是解决方案。你尝试了什么语法？据我所知，2008 年是

```
 <ExecutionThread apartmentState="1" /> 
```

2005 年是

```
<apartmentState type="System.Threading.ApartmentState">
  <value__ type="System.Int32">1</value__>
</apartmentState> 
```

# asp.net - 关于类型比较 ASP.NET 和 DBNull 的问题

> ID：927088
> 
> 赞同：1
> 
> 时间：2009-05-29T17:04:11.727
> 
> 标签：asp.net, vb.net, dbnull

我有一个从 MSSQL 数据库中提取文章记录的函数。有些是 PDF 的 URL，有些是存储在 SQL 中的实际文章。存储的文章在记录中没有 URL (DBNull)，所以我希望能够解析它。我尝试了一个简单的测试：

```
If Row.Item("url").GetType Is GetType(DBNull) Then
    //' do something here....
End If 
```

但是，我得到了“ `Conversion from type 'DBNull' to type 'String' is not valid.`”异常。有趣的是，当我对上述条件进行观察时，它返回`True`or `False`。

任何人都知道为什么会发生这种情况和/或解决此问题的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T17:12:17.847

我总是在记录中使用这个测试：

```
If IsDBNull(strSQLTiggRes("url")) Then
     'Do something                   .
Else
     'do something else
end if 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:09:45.523

我喜欢

```
if (DBNull.Value.Equals(Row.Item("url"))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:16:40.507

为什么不直接使用：

```
If Row.IsNull("url") Then
    //' do something here....
End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T17:07:32.283

尝试

```
If Row.Item("url") = DBNull.Value 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T17:08:07.943

错误告诉你那`Row.Item("url")`是 a`System.String`所以此时的值不会是`DbNull`。

尝试这样的事情：

```
If Row.Item("url") Is Nothing Then
    //' do something here....
End If 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T17:09:55.727

你不能就这样吗

```
If Row.Item("url") = DBNull.Value Then

End If 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T17:13:43.103

我的偏好是：

```
If Not Object.Equals(DBNull.Value, Row.Item("url")) Then
  'Hooray!
End If 
```

在VB中，你也可以直接使用`IsDBNull`函数（`Microsoft.VisualBasic`免责声明）：

```
If Not IsDBNull(Row.Item("url")) Then
  'Hooray!
End It 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-29T17:40:19.943

用这个。

```
if row("ColumnName") is DBNull.value Then
     'do something
end if 
```

你会发现在这种情况下你必须使用 is 并且你需要比较值而不仅仅是类型。您可能还想将它放入一个可重用的函数中，您可以使用该函数不返回任何内容，而不是返回 dbnull

```
function checkvalue(item as object)
     if item is dbnul.value then
          return nothing
     else
          return item
     end if
 end function 
```

# bash - 如何检查 bash 脚本是否正在运行并退出

> ID：927091
> 
> 赞同：10
> 
> 时间：2009-05-29T17:04:36.047
> 
> 标签：bash, scripting

我有一个每 15 分钟运行一次的脚本，但有时如果盒子很忙，它会挂起，下一个过程将在第一个过程完成创建雪球效果之前开始。如何在 bash 脚本中添加几行以检查是否有东西在开始之前先运行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-29T17:08:28.460

`pidof -x`如果您知道进程名称或`kill -0`知道 PID ，则可以使用。

例子：

```
if pidof -x vim > /dev/null
then
    echo "Vim already running"
    exit 1
fi 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T17:07:19.663

为什么不设置锁定文件？

就像是

> 你的app.lock

处理完成后只需将其删除，并在启动之前检查它。

可以使用

```
if [ -f yourapp.lock ]; then
echo "The process is already launched, please wait..."
fi 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-29T17:06:28.617

```
pgrep -f yourscript >/dev/null && exit 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-29T20:22:12.847

代替 pidfiles，只要您的脚本具有唯一可识别的名称，您就可以执行以下操作：

```
#!/bin/bash
COMMAND=$0
# exit if I am already running
RUNNING=`ps --no-headers -C${COMMAND} | wc -l`
if [ ${RUNNING} -gt 1 ]; then
  echo "Previous ${COMMAND} is still running."
  exit 1
fi
... rest of script ... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-18T10:55:39.710

这就是我在一项 cron 工作中的做法

```
lockfile=~/myproc.lock
minutes=60
if [ -f "$lockfile" ]
then
  filestr=`find $lockfile -mmin +$minutes -print`
  if [ "$filestr" = "" ]; then
    echo "Lockfile is not older than $minutes minutes! Another $0 running. Exiting ..."
    exit 1
  else
    echo "Lockfile is older than $minutes minutes, ignoring it!"
    rm $lockfile
  fi
fi

echo "Creating lockfile $lockfile"
touch $lockfile 
```

并在脚本末尾删除锁定文件

```
echo "Removing lock $lockfile ..."
rm $lockfile 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-01T04:50:03.420

对于不受解析错误和竞争条件影响的方法，请查看：

*   [BashFAQ/045 - 如何确保一次只运行一个脚本实例（互斥）？](http://mywiki.wooledge.org/BashFAQ/045)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-09T08:48:43.877

我最近有同样的问题，从上面发现 kill -0 最适合我的情况：

```
echo "Starting process..."
run-process > $OUTPUT &
pid=$!
echo "Process started pid=$pid"
while true; do
    kill -0 $pid 2> /dev/null || { echo "Process exit detected"; break; }
    sleep 1
done
echo "Done." 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-29T17:10:52.793

为了扩展@bgy 所说的内容，如果锁定文件尚不存在则创建锁定文件并失败的安全*原子方法是创建一个临时文件，然后将其硬链接到标准锁定文件。*这可以防止在您测试文件和创建文件之间创建文件的另一个进程。

这是我的每小时备份脚本中的锁定文件代码：

```
echo $$ > /tmp/lock.$$
if ! ln /tmp/lock.$$ /tmp/lock ; then 
        echo "previous backup in process"
        rm /tmp/lock.$$
        exit
fi 
```

完成后不要忘记删除锁定文件和临时文件，即使您因错误而提前退出。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-29T17:11:27.830

使用这个脚本：

```
FILE="/tmp/my_file"
if [ -f "$FILE" ]; then
   echo "Still running"
   exit
fi
trap EXIT "rm -f $FILE"
touch $FILE

...script here... 
```

此脚本将创建一个文件并在退出时将其删除。

# sql-server - SQL Server：如何中止查询分析器中的一系列批处理？

> ID：927102
> 
> 赞同：5
> 
> 时间：2009-05-29T17:08:58.007
> 
> 标签：sql-server, sql-server-2005, sql-server-2000, query-analyzer

我有一系列由特殊查询分析器批处理分隔符关键字分隔的 T-SQL 语句：

```
GO 
```

如果一个批次失败，我需要查询分析器不尝试后续批次 - 我希望它停止处理一系列批次。

例如：

```
PRINT 'This runs'
go

SELECT 0/0, 'This causes an error'
go

PRINT 'This should not run'
go 
```

输出：

```
This runs
Server: Msg 8134, Level 16, State 1, Line 2
Divide by zero error encountered.
This should not run 
```

可能的？

* * *

## 更新

实际使用中的一个例子可能是：

```
 sp_rename 'Shelby', 'Kirsten'
 go

 DROP VIEW PeekAView
 go

 CREATE VIEW PeekAViewAS 
 SELECT * FROM Kirsten
 go 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T06:46:52.757

这是我的做法：

```
PRINT 'This runs'
go

SELECT 0/0, 'This causes an error'
go
if (@@error <> 0)
    Begin
    set nocount on
    set noexec on
    End
GO

PRINT 'This should not run'
go

set noexec off
set nocount off
GO 
```

“noexec”模式使 SSMS 处于一种仅编译 T-SQL 而实际上并不执行它的状态。这类似于意外按下 Parse 工具栏按钮 (Ctrl+F5) 而不是 Execute (F5)。

不要忘记在脚本末尾关闭 noexec。否则用户会被永久的“命令成功完成”弄糊涂。消息。

我在后续批次中使用了对 @@error 的检查，而不是使用 TRY CATCH 块。在下一批中使用@@error 将捕获编译错误，例如“表不存在”。

除了 noexec 模式，我还切换了 nocount 模式。在 noexec 模式打开和 nocount 关闭的情况下，您的查询仍将报告消息“（0 行受影响）”。该消息始终报告零行，因为您处于 noexec 模式。但是，打开 nocount 会抑制这些消息。

另请注意，如果运行 SQL Server 2005，如果您正在跳过的命令引用一个不存在的表，并且如果该命令引用批处理中的第一个命令，则它可能仍会给出错误消息。使用伪造的 Print 语句强制命令成为批处理中的第二个命令可以抑制这种情况。有关详细信息，请参阅[MS 错误 #569263](http://connect.microsoft.com/SQLServer/feedback/details/569263/set-noexec-on-does-not-flag-up-invalid-object-name-errors)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-13T02:41:39.913

您可以激活“查询，SQLCMD 模式”菜单选项并将以下内容放在脚本的开头：

```
:on error exit 
```

这将在发生错误时停止执行，即使有后续批次也是如此。

只要确保您不会在没有开启 SQLCMD 模式的情况下意外运行脚本，因为您将获得忽略错误的典型行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-13T02:52:45.430

当我需要执行此操作时，我会发出严重性为 20 的 RAISERROR。这将终止当前连接，并阻止后续的“GO 批处理”执行。是的，这可能很尴尬，但它确实有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T17:15:53.800

创建临时表；并在每一步之后更新它（如果成功）；然后通过对表进行验证来检查上一步是否成功。

```
create table #ScriptChecker (SuccessfullStep int)

-- Do Step One
Insert into #ScriptChecker
Select 1

-- Step 2
If exists (select * from #ScriptChecker where SuccessfullStep = 1)
-- Do Step 2 ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T17:32:08.040

基于@u07ch 的想法，但仅在失​​败时插入...

```
create table #test (failure  int)

if not exists (select * from #test)
BEGIN
    print 'one' --sql here
END
go

if not exists (select * from #test)
BEGIN
    print 'two'--sql here
END
go

if not exists (select * from #test)
BEGIN
    print 'three' ---SQL SERVER 2000 version
    --error--
    SELECT 0/0, 'This causes an error'
    IF @@ERROR!=0
    BEGIN
        insert into #test values (1)
        PRINT 'ERROR'
    END
end 
go

if not exists (select * from #test)
BEGIN
    print 'three'  ---SQL SERVER 2005/2008 version
    BEGIN TRY
    --error--
        SELECT 0/0, 'This causes an error'
    END TRY
    BEGIN CATCH
        insert into #test values (1)
        PRINT 'ERROR'
    END CATCH
END
go

if not exists (select * from #test)
BEGIN
    --sql here
    print 'four'
END
go 
```

输出 2000：

```
one
two
three

----------- --------------------
Msg 8134, Level 16, State 1, Line 7
Divide by zero error encountered.

(1 row(s) affected)

ERROR 
```

2005/2008年产出：

```
one
two
three

----------- --------------------

(0 row(s) affected)

(1 row(s) affected)

ERROR 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T18:13:51.617

microsoft.public.sqlserver.programming 组中的 Erland Sommarskog 有一个非常好的主意：

> 在您发布的更改脚本中，您需要采取防御措施，并以 IF @@trancount > 0 开始每个批次。

使用

```
IF @@trancount > 0 
```

干净多了。

# asp.net - 为什么 Visual Studio 会在新的 ASPX 页面中放置 div 标签？

> ID：927105
> 
> 赞同：1
> 
> 时间：2009-05-29T17:09:35.510
> 
> 标签：asp.net, visual-studio

默认情况下，新的 ASPX 页面包含以下内容：

```
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    </form>
</body> 
```

我很好奇——有什么理由我应该把那个 div 标签留在里面吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T17:13:00.327

没有真正的意义，但我认为在`<form>`标签之后直接写文本不符合标准，但它会在`<div>`. 随意删除它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-29T17:11:25.570

把东西放进去？这不是必需的，但它可以防止您在开始 Web 布局时创建 div 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:11:31.967

为什么？因为说DIV是模板的一部分。不，没关系，您可以随意摆脱它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T17:16:39.760

也许他们在巧妙地鼓励设计师摆脱这种[`<TABLE>`心态，转向`<DIV>s`](http://www.sitepoint.com/article/websites-tables-parts-1-2/). ;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-29T22:12:44.730

如果您不喜欢它，您可以随时编辑默认模板以永久删除它们：

> C:\Program Files\Microsoft Visual Studio 9.0\Web\WebNewFileItems\CSharp\WebForm.aspx
> 
> C:\Program Files\Microsoft Visual Studio 9.0\Web\WebNewFileItems\VB\WebForm.aspx

只需从您的项目的相关之一中删除 <div> </div> 标记。

# google-analytics - 有人乐意在大型网站上使用 Google Analytics（分析）吗？（百万+页，百万+每月访问者）

> ID：927113
> 
> 赞同：8
> 
> 时间：2009-05-29T17:10:16.820
> 
> 标签：google-analytics

从 Urchin 时代开始，我就是 Google Analytics 的快乐客户。但是几个月前发生了一些奇怪的事情，GA 开始显示一个名为“（其他）”的虚假 URL，该 URL 占所有网站流量的 5% 到 45%。我尝试过滤掉一些 URL 参数以减少页面数量。目前 GA 在我的网站上仅显示 150,000 个页面，这远低于某些人所说的 50 万个限制。尽管如此，“（其他）”页面仍显示为我网站上最受欢迎的页面。

还有其他人在为这个问题苦苦挣扎吗？我想知道这是否可能是可扩展性问题。我的网站多年来一直在增长，目前每月有 125 万独立访问者和超过 1000 万的网页浏览量。该网站本身有大约一百万页。如果您成功地将 GA 用于比我更大的网站，请分享您的故事。您是否在使用他们跟踪脚本的采样功能？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T17:14:12.507

对于像这样的大型网站，我不会使用免费分析。我会使用诸如[Web 趋势](http://www.webtrends.com/)或其他一些付费分析之类的东西。毕竟这是一项免费服务，我们不能为此责怪 GA ;-)

GA 也有页面浏览量限制。（500 万页浏览量）

只是好奇。您花了多长时间将分析代码添加到您的页面？;-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T07:09:29.480

在*[Google Analytics 的 Advanced Web Metrics 中，](http://www.advanced-web-metrics.com/blog/2008/04/07/book-launch-advanced-web-metrics-with-google-analytics/)* Brian Clifton 写道，超过一定数量的页面浏览量，Google Analytics 不再能够列出所有单独的页面浏览量，并开始在“（其他）”条目下聚合少量的页面浏览量。

> 默认情况下，Google Analytics 会收集每位访问者的综合浏览量数据。对于流量非常大的网站，数据量可能会很大，导致报告中缺少大部分“长尾”信息，这仅仅是因为它们在报告表中的位置太靠后了。您可以通过创建访问者细分的单独配置文件来减少此问题，例如 /blog、/forum、/support 等。但是，另一种选择是对[访问者进行抽样](http://code.google.com/apis/analytics/docs/gaJS/gaJSApiBasicConfiguration.html#_gat.GA_Tracker_._setSampleRate)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:35:09.470

我使用 GA 在我的一个网站上每月获得大约 350 万次点击。我没有看到（其他）在任何地方列出。具体来说，您正在查看什么报告？是（其他）页面的标题或 URL？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-16T07:08:34.613

您可以在 Google Analytics 上获得 loooonnnngggg 方式。我有一个网站做大约 25 毫米独特/月。它对我们工作得很好。当您达到特定的浏览量/等限制时，“其他”存储桶就会填满。解决这个问题的方法是在数据上创建不同的过滤器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-04T11:04:17.247

对于一个巨大的网站（每天数百万的页面浏览量），您应该尝试 SnowPlow：

[https://github.com/snowplow/snowplow](https://github.com/snowplow/snowplow)

这将为您提供细化到单个页面 URL 的细粒度数据（与该数量的 Google Analytics 不同），并且由于它基于 Hadoop/Hive/Infobright，因此它可以很高兴地扩展到数十亿的页面浏览量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-26T16:25:05.253

它更多地与他们将报告的指标的唯一值的每日限制有关。如果您的网站使用查询字符串参数，则所有这些唯一值和参数变体都将被视为单独的页面，并导致报告超出指标一天 50,000 个唯一值的限制。为了消除这种情况，您应该添加所有要忽略的罪魁祸首查询字符串名称，但确保在打开搜索时不添加任何搜索查询字符串名称。

在配置文件设置上，将它们添加到排除 URL 查询参数文本框字段，以逗号分隔。一旦我这样做了，（其他）就离开了报告。它在添加时生效，前几天仍然有（其他）显示。

# vb6 - VB6 中的逻辑函数 IMP 和 EQV 做了什么？有没有人发现它们在现实世界中的用途？

> ID：927119
> 
> 赞同：11
> 
> 时间：2009-05-29T17:10:56.740
> 
> 标签：vb6, boolean-logic

[`And`](https://msdn.microsoft.com/en-us/library/aa242751(v=vs.60).aspx), [`Or`](https://msdn.microsoft.com/en-us/library/aa242850(v=vs.60).aspx),我明白了[`Xor`](https://msdn.microsoft.com/en-us/library/aa242859(v=vs.60).aspx)。[`Not`](https://msdn.microsoft.com/en-us/library/aa242842(v=vs.60).aspx)我没有得到的是[`Imp`](https://msdn.microsoft.com/en-us/library/aa242794(v=vs.60).aspx)and [`Eqv`](https://msdn.microsoft.com/en-us/library/aa242780(v=vs.60).aspx)。他们的意思是什么？他们是怎么进去的？它们有什么实际用途吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-29T17:18:07.340

IMP 是“物质蕴涵”“a 蕴涵 b”或“if a then b”，相当于 NOT a OR b。EQV 是“等价”或“当且仅当”，所以 a EQV b 与 (a IMP b) AND (b IMP a) 相同。

他们到达那里是因为有人想要完整。它们可以缩短一些逻辑表达式，但您始终可以使用 NOT 和 AND、NOT 和 OR 或单独使用 XOR 来表达相同的内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-17T23:38:46.677

这是所有运算符的真值表，包括布尔运算符和位运算符。使用它们的最佳时间是当你映射你的逻辑并意识到你有一个函数需要两个输入，并且具有与这些运算符相同的输出:)

```
------------------------------------------------------------------------------------------------------------------
|AND  |     |     |     |OR   |     |     |     |XOR  |     |     |     |IMP  |     |     |     |EQV  |     |     |
------------------------------------------------------------------------------------------------------------------
|In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |
------------------------------------------------------------------------------------------------------------------
|False|False|False|     |False|False|False|     |False|False|False|     |False|False|True |     |False|False|True |
------------------------------------------------------------------------------------------------------------------
|False|True |False|     |False|True |True |     |False|True |True |     |False|True |True |     |False|True |False|
------------------------------------------------------------------------------------------------------------------
|False|Null |False|     |False|Null |Null |     |False|Null |Null |     |False|Null |True |     |False|Null |Null |
------------------------------------------------------------------------------------------------------------------
|True |False|False|     |True |False|True |     |True |False|True |     |True |False|False|     |True |False|False|
------------------------------------------------------------------------------------------------------------------
|True |True |True |     |True |True |True |     |True |True |False|     |True |True |True |     |True |True |True |
------------------------------------------------------------------------------------------------------------------
|True |Null |Null |     |True |Null |True |     |True |Null |Null |     |True |Null |Null |     |True |Null |Null |
------------------------------------------------------------------------------------------------------------------
|Null |False|False|     |Null |False|Null |     |Null |False|Null |     |Null |False|Null |     |Null |False|Null |
------------------------------------------------------------------------------------------------------------------
|Null |True |Null |     |Null |True |True |     |Null |True |Null |     |Null |True |True |     |Null |True |Null |
------------------------------------------------------------------------------------------------------------------
|Null |Null |Null |     |Null |Null |Null |     |Null |Null |Null |     |Null |Null |Null |     |Null |Null |Null |
------------------------------------------------------------------------------------------------------------------
|     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
------------------------------------------------------------------------------------------------------------------
|In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |     |In1  |In2  |Out1 |
------------------------------------------------------------------------------------------------------------------
|001  |001  |001  |     |001  |001  |001  |     |001  |001  |000  |     |001  |001  |111  |     |001  |001  |111  |
------------------------------------------------------------------------------------------------------------------
|001  |010  |000  |     |001  |010  |011  |     |001  |010  |011  |     |001  |010  |110  |     |001  |010  |100  |
------------------------------------------------------------------------------------------------------------------
|001  |011  |001  |     |001  |011  |011  |     |001  |011  |010  |     |001  |011  |111  |     |001  |011  |101  |
------------------------------------------------------------------------------------------------------------------
|001  |100  |000  |     |001  |100  |101  |     |001  |100  |101  |     |001  |100  |110  |     |001  |100  |010  |
------------------------------------------------------------------------------------------------------------------
|010  |001  |000  |     |010  |001  |011  |     |010  |001  |011  |     |010  |001  |101  |     |010  |001  |100  |
------------------------------------------------------------------------------------------------------------------
|010  |010  |010  |     |010  |010  |010  |     |010  |010  |000  |     |010  |010  |111  |     |010  |010  |111  |
------------------------------------------------------------------------------------------------------------------
|010  |011  |010  |     |010  |011  |011  |     |010  |011  |001  |     |010  |011  |111  |     |010  |011  |110  |
------------------------------------------------------------------------------------------------------------------
|010  |100  |000  |     |010  |100  |110  |     |010  |100  |110  |     |010  |100  |101  |     |010  |100  |001  |
------------------------------------------------------------------------------------------------------------------
|011  |001  |001  |     |011  |001  |011  |     |011  |001  |010  |     |011  |001  |101  |     |011  |001  |101  |
------------------------------------------------------------------------------------------------------------------
|011  |010  |010  |     |011  |010  |011  |     |011  |010  |001  |     |011  |010  |110  |     |011  |010  |110  |
------------------------------------------------------------------------------------------------------------------
|011  |011  |011  |     |011  |011  |011  |     |011  |011  |000  |     |011  |011  |111  |     |011  |011  |111  |
------------------------------------------------------------------------------------------------------------------
|011  |100  |000  |     |011  |100  |111  |     |011  |100  |111  |     |011  |100  |100  |     |011  |100  |000  |
------------------------------------------------------------------------------------------------------------------ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T17:24:09.937

IIRC，它们都对两个输入执行按位 !XOR 并返回结果。

它们不存在于任何 .Net 代码库中（除非您计算 VB6 兼容层库），因此应将其视为已弃用并因此被忽略。

我不能说我曾经使用过它们。

# nhibernate - 通过配置管理器无法获取休眠配置部分

> ID：927131
> 
> 赞同：0
> 
> 时间：2009-05-29T17:14:22.743
> 
> 标签：nhibernate, memcached, app-config

我正在尝试设置 Memcached 二级缓存。我遵循了我能找到的文档，包括从 SVN 下载项目并查看它在他们的测试项目中是如何配置的，最后在我的 app.config 中得到了这个。

```
<configuration>
  <configSections>
    <section name="memcache" type="NHibernate.Caches.MemCache.MemCacheSectionHandler,NHibernate.Caches.MemCache" />
  </configSections>
  <memcache>    
    <memcached host="xx.xx.xx.xx" port="11211" weight="10" />
  </memcache>
</configuration> 
```

但是，当`NHibernate.Caches.MemCache`调用 MemCache 提供程序代码时`configurationmanager.getsection("memcache")`，会返回 null，这会导致它出错。

我有三个项目，.UI、.Core 和 .Data - app.config 用于 .UI，.Data 是`SessionFactory`构建的地方，并且启动了想要加载此配置部分的代码。.Data 有`Nhibernate.Caches.Memcache`参考，我尝试将它添加到 .UI，但这并没有解决问题。

此配置有什么不正确之处？或者也许是关于我的项目的东西？有没有人有任何经验`NHibernate.Caches.MemCache`？没有太多关于它的信息可以通过谷歌找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-23T12:35:40.787

问题最终是我的 app.config 出现了一些损坏。一切都是正确的，但它没有被程序集加载。我删除并重新添加它，然后它工作正常。

# data-structures - 队列操作/API 的术语/命名约定？

> ID：927141
> 
> 赞同：7
> 
> 时间：2009-05-29T17:16:32.257
> 
> 标签：data-structures, naming-conventions, queue, terminology

“队列”或 FIFO 是最常见的数据结构之一，在许多语言和框架中都有本机实现。然而，对于如何命名基本队列操作似乎几乎没有共识。对几种流行语言的调查显示：

*   Python：放置/获取
*   C#，Qt：入队/出队
*   Ruby、C++ 标准：推送/弹出
*   Java：添加/删除

如果需要实现一个队列（例如，在一些还没有本地队列实现的嵌入式平台中），什么命名约定最好？入队/出队似乎是最明确的，但冗长；put/get 很简洁，但没有提供任何关于操作的 FIFO 特性的提示；push/pop 似乎是建议堆栈操作而不是队列操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T17:25:00.670

我是一个书呆子，所以我会去`enqueue/dequeue`。

虽然`add/next`有一定的吸引力。

只是为了让这个问题更加模糊，在 Perl 中它是`push/shift`. :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T17:31:19.257

push/pop 对于 fifo 来说是完全错误的，因为它们是堆栈（先进后出）操作。

queue 既可以引用对象也可以引用操作，因此有点重载，并且 dequeue 可能会引起混淆，因为它通常用于引用双端队列。

put/get - 简短、明显和通用（不假设实现，可用于各种队列/列表/集合） - 不喜欢什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:20:53.560

我可能会将其命名为`push_back`and `pop_front`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T17:21:06.447

添加/删除听起来像是最合乎逻辑的使用方法，尤其是如果您打算让不熟悉结构或语言的人阅读它（更容易理解）。

由于个人喜好，Push/Pop 将在我的排名中排在第二位。

接下来是 Put/Get。

Enqueue/Dequeue 是最后一个，因为我真的很讨厌字母 Q。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T17:36:00.170

添加/删除的优点是您可以轻松地从队列更改为另一个数据结构。

例如，将状态存储在队列与堆栈中会产生广度优先搜索和深度优先搜索之间的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-18T02:44:38.713

我喜欢入队和出队，但打字很糟糕。因此，在我的队列结构（C++ 和 Java）中，我将函数命名为 enQ 和 deQ :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-28T21:33:18.937

Pop / push 听起来是错误的，因为它建议使用堆栈数据结构而不是队列。

在建议中添加一些新内容：我的老师总是在黑板上使用`in`和。`out`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-24T20:54:20.267

我喜欢继承和斩首。虽然不适合所有人。或“以新入”、“以旧出”。然后对我们西南人来说，有 berattle 和 defang。但我最喜欢的是图形。右箭头输入，然后右箭头输出。

# java - Java Struts 列表listKey listValue listClass？

> ID：927146
> 
> 赞同：0
> 
> 时间：2009-05-29T17:17:27.653
> 
> 标签：java, jsp, struts

Java 的新手，在为这个 SELECT 选项分配类属性时遇到了麻烦。想知道 listClass 是否正确？我想要完成的是将类属性添加到 SELECT 下拉列表的选项中

是）我有的：

```
<select>
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="ford">F150</option>
</select> 
```

我想要什么：

```
<select>
  <option class="car" value="volvo">Volvo</option>
  <option class="car" value="saab">Saab</option>
  <option class="car" value="mercedes">Mercedes</option>
  <option class="truck" value="ford">F150</option>
</select> 
```

这是JSP代码：

```
<s:select id="theSelectId" 
   name="theDto.id" 
   value="#attr.theDto.field_id" 
   list="theDtoList" 
   listKey="field_id" 
   listValue="field_value"/> 
```

有列表类吗？或以其他方式提取我需要的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T17:42:58.287

我刚刚快速检查了 Struts 标记库 API，看起来 Struts 选择标记的 styleClass 属性将创建一个类属性。

[http://struts.apache.org/1.x/struts-taglib/tlddoc/html/select.html](http://struts.apache.org/1.x/struts-taglib/tlddoc/html/select.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T20:46:20.397

为此，我怀疑您将不得不滚动自己的标签。您可以创建一个新的 myselect 标记，该标记接受一个 optionClass 参数，该参数将该类设置为每个选项元素。

# python - 带有传感器和 xprofile 模块的诺基亚 N95 和 PyS60

> ID：927150
> 
> 赞同：0
> 
> 时间：2009-05-29T17:18:52.190
> 
> 标签：python, symbian, nokia, s60, pys60

我制作了一个 python 脚本，它应该根据手机位置修改手机的配置文件。在 ScriptShell 下运行，效果很好。

问题是它挂起，无论是在“启动”时运行的“sis”脚本，还是没有它。

所以我的问题是代码有什么问题，以及是否需要将特殊参数传递给 ensymble？

```
import appuifw, e32, sensor, xprofile
from appuifw import *

old_profil = xprofile.get_ap()

def get_sensor_data(status):
    #decide profile

def exit_key_handler():
    # Disconnect from the sensor and exit
    acc_sensor.disconnect()
    app_lock.signal()

app_lock = e32.Ao_lock()

appuifw.app.exit_key_handler = exit_key_handler
appuifw.app.title = u"Acc Silent"
appuifw.app.menu = [(u'Close', app_lock.signal)]
appuifw.app.body = Canvas()
# Retrieve the acceleration sensor
sensor_type= sensor.sensors()['AccSensor']
# Create an acceleration sensor object
acc_sensor= sensor.Sensor(sensor_type['id'],sensor_type['category'])
# Connect to the sensor
acc_sensor.connect(get_sensor_data)

# Wait for sensor data and the exit event
app_lock.wait() 
```

该脚本在启动时启动，使用 ensymble 和我的开发人员证书。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-08T16:36:05.687

我经常在我的脚本顶部使用类似的东西：

```
import os.path, sys
PY_PATH = None
for p in ['c:\\Data\\Python', 'e:\\Data\\Python','c:\\Python','e:\\Python']:
    if os.path.exists(p): 
        PY_PATH = p
        break
if PY_PATH and PY_PATH not in sys.path: sys.path.append(PY_PATH) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-05T13:00:15.650

xprofile 不是标准库，请确保添加路径。我的猜测是，当作为 SIS 运行时，它找不到 xprofile 并挂断。发布您的 SIS 时，请指示用户单独安装或包含在您的 SIS 中。

你会把它安装在哪里，使用那个路径。这是 python 默认目录作为示例：

```
 # PyS60 1.9.x and above
    sys.path.append('c:\\Data\\Python')
    sys.path.append('e:\\Data\\Python')
    # Pys60 1.4.x or below
    sys.path.append('c:\\Python')
    sys.path.append('e:\\Python') 
```

顺便说一句，干净退出，这样做：

```
 appuifw.app.menu = [(u'Close', exit_key_handler)] 
```

# java - 尊重/阅读 Gnome (Linux) 中的“首选应用程序”设置

> ID：927151
> 
> 赞同：4
> 
> 时间：2009-05-29T17:18:53.907
> 
> 标签：java, gnome

如果他们使用 Gnome 桌面环境，我如何找出用户的“首选网络浏览器”？（我想打开一个网页，我不需要知道用户喜欢哪个浏览器。）

一些背景知识：我正在尝试使用我的 Java 应用程序打开一个浏览器窗口（我的主页）。

1.  如果 Java 版本是 1.6+，请使用 Desktop.browse(url)；
2.  否则，请使用[BareBonesBrowserLaunch.openURL(url)](http://www.centerkey.com/java/browser/) - 这意味着检查环境并使用 Runtime.getRuntime().exec() 启动浏览器

方法 2 在 Windows 上运行良好；并在 Linux 上打开浏览器。但是，它是它找到的第一个浏览器（在我的例子中，首先查找 Firefox）。在 Gnome 桌面环境中（例如 Ubuntu Linux 默认情况下），您可以为电子邮件、www 浏览等设置“首选应用程序”；我相信这些信息在*某个地方*是可以访问的。如何找出用户的首选浏览器？

换句话说：**Gnome 将“首选浏览器”设置存储在哪里**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-18T14:10:05.233

在 Linux 桌面中打开文件或 URL 的最便携方式是`xdg-open`.

[http://portland.freedesktop.org/xdg-utils-1.0/xdg-open.html](http://portland.freedesktop.org/xdg-utils-1.0/xdg-open.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T17:22:48.910

“默认浏览器”设置在`~/.gconf/desktop/gnome/url-handlers/http/%gconf.xml`Here's mine 中：

```
<?xml version="1.0"?>
<gconf>
    <entry name="command" mtime="1243616896" type="string">
    <stringvalue>opera %s</stringvalue>
    </entry>
</gconf> 
```

这`<stringvalue/>`是我正在寻找的命令。

（一段时间后发现了这个 - 忘记发布问题了。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T21:28:13.573

考虑使用[`gnome-open`](http://manpages.unixforum.co.uk/man-pages/unix/solaris-10-11_06/1/gnome-open-man-page.html).

我在 Gnome 和[`kfmclient`](http://pwet.fr/man/linux/commandes/kfmclient)KDE 上使用它。

# .net - .NET 即时超出范围通知？

> ID：927162
> 
> 赞同：2
> 
> 时间：2009-05-29T17:22:47.863
> 
> 标签：.net, scope

在 .NET 中，是否有一种简单的方法可以让类在超出范围时得到通知？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T17:24:38.547

不。

如果您需要清理内存以外的资源，请实现 IDisposable 并使用`using`块创建对象。如果你需要清理内存，你真的可以把它留给垃圾收集器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T18:25:22.973

是的，有一些语言。当 IDisposable 的非堆分配超出范围时，C++/CLI 将为 IDisposable 实现者发出 Dipose 调用（有效地为它们提供与普通 C++ 中的堆栈分配资源相同的语义）。此外，~Classname 的 C++/CLI 析构函数语法成为 Dispose 的实现（并使类实现 IDisposable）。

随着时间的推移，我希望其他具有传统确定性破坏的语言能够采用这种策略。正如其他人所提到的，您可以在 C# 中使用“使用”来模拟它，但并不完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:24:34.617

如果它实现了 IDisposable 并且您正在使用 using 块，那么当然可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T17:24:41.730

不，没有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T17:24:52.760

不，任何 .NET 语言都没有确定性的终结。垃圾收集器负责最终确定在应用程序中没有根的对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T17:25:01.980

如果它实现 IDisposable，您的 Dispose() 方法会发现：

```
using (var c = new YourClassImplementsIDisposable() )
{
    // Stuff happens
}
// c.Dispose has been called 
```

否则不会，因为您的对象只是“闲逛”直到 GC

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T18:19:50.753

你可以使用终结器。一旦收集到垃圾就会调用它，但不会在离开作用域后立即调用。

[http://www.switchonthecode.com/tutorials/csharp-tutorial-object-finalizers](http://www.switchonthecode.com/tutorials/csharp-tutorial-object-finalizers)

# c# - 可拖动的 WinForm 问题

> ID：927167
> 
> 赞同：1
> 
> 时间：2009-05-29T17:24:21.933
> 
> 标签：c#, .net, winforms, winapi, wndproc

我有一个 Windows 窗体，可以通过单击并拖动窗体的任何部分来移动它。我使用了覆盖 WndProc 的方法，并将 NCHITTEST 函数的结果设置为 HTCAPTION，以使表单误以为我单击了标题-因此它可以拖动。

此代码效果很好，如下所示：

```
protected override void WndProc(ref Message msg)
    {
      if (msg.Msg == (int)WinAPI.NCHITTEST)
            {
                DefWndProc(ref msg);
                if ((int)msg.Result == (int)MousePositionCodes.HTCLIENT)
                {
                   msg.Result = (IntPtr)MousePositionCodes.HTCAPTION;
                   return;
                }
            }
        }
        base.WndProc(ref msg);
    } 
```

当我将 ToolStripPanel 停靠在表单中时会出现问题（这充当可拖动的工具栏）。我需要 ToolStrip 未覆盖的 ToolStripPanel 的任何部分来传递使整个表单进入拖动模式所需的消息。

我创建了自己的 ToolStripContainer 类来覆盖 WndProc 函数，并尝试使用与上述相同的函数，但它导致 ToolStripContainer在表单*内*进入拖动模式，这不是所需的功能。

我还尝试将 NCHITTEST 消息传递给父级，以及使用当前鼠标坐标构造一条新消息，并使用 WinAPI 和父级的窗口句柄将其发送给父级。

我必须在这里遗漏一些简单的东西......有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T17:30:38.417

尝试在您自己的 ToolStripContainer 的 WndProc 中测试 WM_NCHITTEST 返回 HTTRANSPARENT (-1) 以用于您想要拖动的区域。这将导致消息在您处理它的表单中链式上升并返回 HTCAPTION 以便发生拖动。

希望这可以帮助。

# wpf - 设置 WPF 扩展器的样式，使其看起来像 Outlook ListView 组标题

> ID：927171
> 
> 赞同：0
> 
> 时间：2009-05-29T17:24:38.610
> 
> 标签：wpf, listview, expander

如何将 WPF Expander 图像设置为 +/- 例如看起来像 Outlook ListView 组标题，如下图所示：

**打开** [![替代文字](https://i.stack.imgur.com/YZ8Cr.png)](https://i.stack.imgur.com/YZ8Cr.png)

**关闭** [![替代文字](https://i.stack.imgur.com/fTsIY.png)](https://i.stack.imgur.com/fTsIY.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T13:06:48.580

不完全但足够接近，请查看[Karl Shifflet](http://karlshifflett.wordpress.com/)关于WPF 示例系列的这篇文章 - **WPF LOB 旅游材料**中的[列表框分组、排序、小计和可折叠区域](https://web.archive.org/web/20090615091958/http://karlshifflett.wordpress.com/2009/06/10/wpf-sample-series-listbox-grouping-sorting-subtotals-and-collapsible-regions/)

 **[![ListBox 分组、排序、小计和可折叠区域](https://i.stack.imgur.com/gqeCw.jpg)](https://i.stack.imgur.com/gqeCw.jpg)
[（来源：[wordpress.com](http://karlshifflett.files.wordpress.com/2009/06/listboxtwojpg.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T23:27:33.003

您必须覆盖 Expander 的 ControlTemplate，并使用您的标题内容更改 ContentControl 与 Header 的 TemplateBinding（这通常是一个 ToggleButton）。

在您的情况下，这是 +/- 图像/几何图形和文本。

但是，我会采用与使用扩展器不同的方法。由于您使用的是非常特定的方向，因此我将借用默认 Expander ContentControl 组合的 ToggleButton+ContentControl 交互，并为 ToggleButton 创建一个新的 Style/ControlTemplate。

我推荐这个而不是覆盖 Expander 的 ControlTemplate 的主要原因是 Expander 有一个非常大的默认 ControlTemplate 定义，您不必处理覆盖所有 ExpandDirection 选项。

或者，您可以忽略 Expander 的 ExpandDirection 属性并删除处理该问题的 ControlTemplate 触发器代码和相关联的样式。

# c# - 使用 c# 编辑音乐元数据

> ID：927175
> 
> 赞同：2
> 
> 时间：2009-05-29T17:24:57.050
> 
> 标签：c#, .net, file-io, metadata

如何访问音乐文件（任何格式）等文件的摘要并对其进行编辑，尤其是该文件的插图（文件中包含的照片）并对其进行编辑？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T17:55:29.290

我可以推荐[TagLib Sharp](http://developer.novell.com/wiki/index.php/TagLib_Sharp)用于 mp3 标签编辑。非常强大且易于使用，文档清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:28:58.170

您可能需要阅读您使用的任何音乐文件格式的规范。每种音乐格式都有不同的元数据格式和压缩/编码方案。某些格式可能具有可用于操作文件的库，而某些格式可能必须手动操作。

例如，尝试在 Google 上搜索“mp3 规格”或“mp3 文件格式”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:29:41.273

[SourceForge 上](http://sourceforge.net/projects/csid3lib)有一个项目允许您编辑 MP3 文件的 ID3 标签，但我从未使用过它，所以我不能保证它有多好。

# c# - 不可变集合？

> ID：927181
> 
> 赞同：26
> 
> 时间：2009-05-29T17:25:29.843
> 
> 标签：c#, .net, immutability

我在我的应用程序中使我的大部分基本类型都是不可变的。但是集合也应该是不可变的吗？对我来说，这似乎是一个巨大的开销，除非我错过了什么。

我说的是保存 Point3 值等的集合，这些集合可以在不同时间添加。因此，如果一个集合中有 1M 个值，而您需要删除其中的 1 个，则必须重新创建相同的集合，对吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-29T17:32:33.780

Eric Lippert 有一个关于 C# 中的不可变性的系列，如果你通读它，他实现了几个不同的不可变集合：

1.  [C# 中的不变性第 1 部分：不变性的种类](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-one-kinds-of-immutability)
2.  [C# 中的不变性第二部分：一个简单的不可变堆栈](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-two-a-simple-immutable-stack)
3.  [C# 中的不可变性第三部分：协变不可变堆栈](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-three-a-covariant-immutable-stack)
4.  [C# 中的不可变性第四部分：不可变队列](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-four-an-immutable-queue)
5.  [C# 中的不变性第五部分：大声笑！](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-five-lolz)
6.  [C# 中的不变性第 6 部分：简单的二叉树](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-six-a-simple-binary-tree)
7.  [C# 中的不变性第 7 部分：关于二叉树的更多信息](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-seven-more-on-binary-trees)
8.  [C# 中的不变性第八部分：关于二叉树的更多内容](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-eight-even-more-on-binary-trees)
9.  [C# 中的不变性第 9 部分：学术？加上我的 AVL 树实现](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-nine-academic-plus-my-avl-tree-implementation)
10.  [C# 中的不变性第 10 部分：双端队列](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-10-a-double-ended-queue)
11.  [C# 中的不变性第 11 部分：一个工作的双端队列](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/immutability-in-c-part-eleven-a-working-double-ended-queue)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-24T16:24:41.827

不可变集合很棒，特别是如果您的应用程序已经利用不可变类型或语义。

.NET 刚刚发布了他们的第一个[不可变集合](http://blogs.msdn.com/b/bclteam/archive/2012/12/18/preview-of-immutable-collections-released-on-nuget.aspx)，我建议您尝试一下。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-29T17:31:57.773

我最喜欢的收藏技巧就是永远不要传递它们。如果它们只存在于单个对象中，那么使它们不可变几乎是无关紧要的（只要您的包含对象不改变它们，它们就不会改变）。

通常你的收藏代表了一些东西，对吧？它是一组狗或一组发票......

通常，您可以对一组狗（牧群？中性？）或一组发票（支付？）做一些事情，实际上总是有适用于整个对象列表的操作 - 具有超出单数功能的操作invoice.pay() （例如，确保首先支付最重要的发票），如果没有围绕您的集合的类，则实际上没有放置这些操作的地方。

将一些变量与您的集合相关联通常也很有意义——同样，如果没有包装器，您最终总是将这些变量放在一些奇怪的不自然的位置。

起初它可能看起来很奇怪，但在你判断之前尝试几次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T17:28:40.557

如果您只从开头或结尾添加/删除，您可能会作弊 - 但一般来说；是的：这意味着您需要为每次更改创建一个新集合。

那么：你需要（有效地）改变集合吗？如果是这样，并且考虑到它们的大小：我很想查看同步访问（而不是使它们正确地不可变）。看`lock`（又名`Monitor`）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T18:05:02.920

我同意 Eric 关于为问题选择正确工具的评论。当您的目标包括提供清晰的身份语义或使您的实现更易于在并行计算环境中使用时，不变性会增加价值。不变性还可以通过允许缓存或透明代理等优化来帮助提高性能。

另一方面，不变性也会产生性能成本——尤其是当您使用“写时复制”模式来模拟“更改”时。

你必须决定***为什么***你希望你的实体/集合是不可变的——这将有助于你决定是否这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T17:28:38.153

查找表将构成一个体面的不可变集合。它不需要改变大小，并且您希望它是静态的，因此可以快速查找棘手的计算。如果您以后需要添加一些东西，那么我就不会为不变性而烦恼，它会破坏目的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T17:48:27.353

这取决于您的程序编写/设计的风格。

不可变集合只有在您以受函数式编程影响的风格进行编程时才有意义（命令式设计的程序不应该使用它们）。

就像在函数式语言中一样，您应该使用链接列表，然后可以在每个元素 ( `cons`) 中构建 O(1) 并以功能方式处理它们（递归，从列表构建新列表）。

当您的程序需要命令式集合（数组、向量/列表）时，请保持它们是可变的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-11T08:16:57.273

您可以将您的公共接口定义为 IEnumerable，但仍然在您的实现中使用可变集合。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-29T17:26:38.233

这完全取决于谁同时使用这些集合。字符串是不可变的，以防止 boo-boo 像两个线程试图同时删除第一个字符。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-29T17:26:39.420

如果您有一个可以在构建后添加项目的集合，则它不是不可变的

# jquery - jQuery 选择器在 jQuery 事件中不起作用

> ID：927182
> 
> 赞同：0
> 
> 时间：2009-05-29T17:25:45.177
> 
> 标签：jquery, asp.net-mvc

以下代码产生

```
function (value) {
    if (value === undefined) {
        var elem = this[0];
        if (elem) {
            if (jQuery.nodeName(elem, "option")) {
                return (elem.attributes.value || {}).specified ? elem.value : elem.text;
            }
            if (jQuery.nodeName(elem, "select")) {
                var index = elem.selectedIndex, values = [], options = elem.options, one = elem.type == "select-one";
                if (index < 0) {
                    return null;
                }
                for (var i = one ? index : 0, max = one ? index + 1 : options.length; i < max; i++) {
                    var option = options[i];
                    if (option.selected) {
                        value = jQuery(option).val();
                        if (one) {
                            return value;
                        }
                        values.push(value);
                    }
                }
                return values;
            }
            return (elem.value || "").replace(/\r/g, "");
        }
        return undefined;
    }
    if (typeof value === "number") {
        value += "";
    }
    return this.each(function () {if (this.nodeType != 1) {return;}if (jQuery.isArray(value) && /radio|checkbox/.test(this.type)) {this.checked = jQuery.inArray(this.value, value) >= 0 || jQuery.inArray(this.name, value) >= 0;} else if (jQuery.nodeName(this, "select")) {var values = jQuery.makeArray(value);jQuery("option", this).each(function () {this.selected = jQuery.inArray(this.value, values) >= 0 || jQuery.inArray(this.text, values) >= 0;});if (!values.length) {this.selectedIndex = -1;}} else {this.value = value;}});
} 
```

当警报被调用时。我期待看到“你好”。无论出于何种原因，我都可以使用选择器触发 jQuery 事件，但是当我尝试使用该事件中的任何 DOM 元素时，它会失败。有什么想法吗？

```
<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">

    <script type="text/javascript">
        $(function() {

            $("#myButton").click(function() { alert("clicked!"); alert($("#myHTML").val ); });

        }
    );
</script>

    <h2><%= Html.Encode(ViewData["Message"]) %></h2>
    <p>
        To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
    </p>
    <button id="myButton" style="height:50px; width:200px;" >Click Me!</button>
    <div id="myHTML">
    hello
    </div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T17:29:45.187

`$("#myHTML").val()`应该管用。确保包含括号。

另外，对于提醒一个DIV的内容，`.text()`还是`.html()`会更好。

# sql-server-2008 - 如何禁用 SQL Reporting Services 并从 IIS 中删除 Reports 目录？

> ID：927185
> 
> 赞同：3
> 
> 时间：2009-05-29T17:26:43.663
> 
> 标签：sql-server-2008, iis-7, reporting-services, report

我试图摆脱似乎与 SQL 报告服务 2008 集成的 /reports 目录。我无法卸载 SQL 服务器的那个元素，并且在尝试重新配置 ReportBuilderLaunchURL 时我没有运气。有谁知道我怎样才能摆脱这个愚蠢的功能？我会理解它是否只是 localhost 实例上的一个虚拟目录，但是当它应用于我的所有站点时，我感到非常沮丧，想知道微软的谁决定这将是默认设置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-24T04:54:23.510

备查：

使用“报告服务配置管理器”。

在报表管理器 URL 选项卡中插入一个新的虚拟目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T17:30:47.807

我相信您可以通过 SQL Server 本身的安装过程并选择删除某个组件（在本例中为 SSRS）来卸载 SSRS。

或者（可能更好）是转到添加/删除程序菜单并选择 SQL Server 并点击“更改”按钮。从那里您可以选择要修复/安装/卸载/等的组件。

**编辑**：这是我发现的一篇文章，它试图描述如何[卸载 SSRS 2008](http://icu-mscrm.blogspot.com/2009/02/how-to-uninstall-sql-server-2008.html)。它似乎同意我所说的关于添加/删除程序的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-04T16:06:39.973

我们刚刚遇到了这个问题，我们想出的解决方法是将它链接到一个特定的主机头，而不是让它指向所有 IP 地址上的所有站点。（您可以通过单击@Luis 提到的 URL 选项卡中的高级按钮来执行此操作。）这实际上已将事物隔离到一个网站，因为它是一个主机标头，首先不在任何公共站点上，它极大地限制了甚至可以找到它的人数。

# iphone - 学习使用 Xcode 和 Objective-C 基础知识进行 Iphone 开发的最佳地点是什么？

> ID：927186
> 
> 赞同：1
> 
> 时间：2009-05-29T17:27:00.307
> 
> 标签：iphone, objective-c

当我说最好的地方时，我的意思是物理课程、研讨会、讲习班等......它可能在世界各地

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T17:29:42.583

我会避免在神学院学习Objective-C。

我听说过关于[Big Nerd Ranch](http://www.bignerdranch.com/)课程的好消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:44:07.237

这是一个很好的[网络资源](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)，您可以从世界上任何可以访问网络的地方访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T17:47:52.597

我最近发现的一件事是可以在 iTunes 上免费获得的所有斯坦福德讲座。有大量免费发布的讲座，其中包含非常详细的信息。

编辑：我想我应该提一下，iTunes 上也有一整学期的 iPhone 开发课程。细节决定成败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T19:34:16.437

几个月前，我参加了实用程序员的 iPhone 工作室。该课程由 Bill Dudney 和 Daniel Steinberg 教授。他们都是优秀的老师，在讲座和实验时间之间取得了很好的平衡（并且非常耐心地一遍又一遍地向我解释同样的事情，直到我明白了！）。

# apache-flex - URLLoader 随机失败，不会引发错误或调度任何事件

> ID：927189
> 
> 赞同：3
> 
> 时间：2009-05-29T17:28:08.263
> 
> 标签：apache-flex, actionscript-3, air

在 Adob​​e AIR 1.5 中，我使用 URLLoader 上传 1 MB 块的视频。它上传 1 MB，等待 Event.COMPLETE 事件，然后上传下一个块。服务器端代码知道如何从这些块构建视频。

通常，它工作正常。然而，有时它只是停止而没有抛出任何错误或调度任何事件。这是我创建的日志中显示的示例：

```
Uploading chunk of size: 1000000
HTTP_RESPONSE_STATUS dispatched: 200
HTTP_STATUS dispatched: 200
Completed chunk 1 of 108

Uploading chunk of size: 1000000
HTTP_RESPONSE_STATUS ... 
```

ETC...

大多数时候，它可以很好地完成所有的块。但是，有时，它只是在中间失败：

```
Completed chunk 2 of 108
Uploading chunk of size: 1000000 
```

...没有别的，也没有网络活动。

通过调试，我知道它确实成功地调用了 urlLoader.load()。当它失败时，它似乎只是停止，调用 load()，然后调用 UIComponent 的 callLaterDispatcher()，然后什么也没有。

有谁知道为什么会发生这种情况？我正在像这样设置我的 URLLoader：

```
urlLoader.dataFormat = URLLoaderDataFormat.BINARY;
urlLoader.addEventListener(Event.COMPLETE, chunkComplete);
urlLoader.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
urlLoader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);
urlLoader.addEventListener(HTTPStatusEvent.HTTP_RESPONSE_STATUS, responseStatusHandler);
urlLoader.addEventListener(HTTPStatusEvent.HTTP_STATUS, statusHandler);
urlLoader.addEventListener(ProgressEvent.PROGRESS, progressHandler); 
```

我正在为每个块重新使用它。不成功时不会调用任何事件，并且 urlLoader.load() 不会引发任何异常。成功时，将调度 HTTP_RESPONSE_STATUS、HTTP_STATUS 和 PROGRESS 事件。

谢谢！

编辑：可能有帮助的一件事是，我们在 .NET 中实现了相同的上传功能。在 .NET 中，request.GetResponse() 方法有时会抛出异常，抱怨连接意外关闭。如果发生这种情况，我们会捕获异常，并再次尝试该块，直到它成功。我希望在这里实现类似的东西，但是没有抛出异常或调度错误事件。

下面更详细的代码示例。URLLoader 的设置如上所述。readAgain 变量只是让它跳过读取文件流中的一组新字节（即：它尝试再次发送旧字节）......但是，它永远不会捕获任何异常，因为没有抛出任何异常。

```
private function uploadSegment():void
{
    .... prepare byte array, setup url ...

    // Create a URL request
    var urlRequest:URLRequest = new URLRequest();
    urlRequest.url = _url + "?" + paramStr; 
    urlRequest.method = URLRequestMethod.POST;
    urlRequest.data = byteArray;
    urlRequest.useCache = false;
    urlRequest.requestHeaders.push(new URLRequestHeader('Cache-Control', 'no-cache'));

    try
    {
        urlLoader.load(urlRequest);
    }
    catch (e:Error)
    {
        Logger.error("Failed to upload chunk. Caught exception. Trying again.");
        readAgain = true;
        uploadSegment();
        return;
    }

    readAgain = false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T20:40:16.413

您是否尝试注册“Event.OPEN”以查看连接是否正确打开？如果您按块执行此操作-也许该事件或缺少该事件会有所帮助？

[编辑]

您还可以尝试在 URLRequest 上将 useCache 设置为 false 吗？

[编辑]

我假设你的 urlLoader 是全局引用的......如果不是，当你等待异步行为时，像 GC 这样的邪恶可能会伤害你......但是 - 如果你在等待的时候调用 'bytesTotal' 就跳过它发生*某*事 - 它总是返回零吗？

[更多的]

另外 - 在没有发生任何事情的情况下检查 URL - 因为在网上我发现有人提到如果服务器无法访问，则不会触发任何事件（尽管有一些争论）......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-14T21:40:31.093

我在 Flex 中遇到了类似的问题，只是在 Safari 中。URLloader 有时什么也不返回，甚至没有返回 OPEN 事件。我确保这不是缓存问题。

经过大量试验和错误，我发现的唯一补救方法是在 url 中使用 https 协议。我不确定这对 Safari 有什么影响，但现在问题消失了。

# java - 将两个 xa 数据源与 Jbpm 一起使用时出现问题

> ID：927190
> 
> 赞同：2
> 
> 时间：2009-05-29T17:28:28.077
> 
> 标签：java, database, jboss, seam, jbpm

我正在使用 Seam、JBoss Jbpm 和 Resteasy。我有一个非常简单的流程定义：

```
<start-state name="create">
    <transition name="send" to="inbox" />
</start-state>
<node name="inbox">
    <action expression="#{test.sayHello}" />
    <transition name="acknowledge" to="acknowledged" />
</node>
<end-state name="acknowledged" /> 
```

这是应该启动该过程的类

```
 @Name("webservice")
@Path("/webservice")
@AutoCreate
public class WebService
{
    @GET
    @CreateProcess(definition="Blah")
    @Transactional
    public String getSomething() throws Exception
    {
        ...
    }

} 
```

流程定义也很简单：http://docs.jboss.org/jbpm/xsd/jpdl-3.2.xsd" name="Blah">

```
<start-state name="create">
    <transition name="send" to="inbox" />
</start-state>
<node name="inbox">
    <action expression="#{test.sayHello}" />
    <transition name="acknowledge" to="acknowledged" />
</node>
<end-state name="acknowledged" /> 
```

然后，当我尝试调用 WebService 时，我得到以下堆栈跟踪：

```
 10:38:41,443 ERROR [STDERR] Caused by: org.jbpm.JbpmException: couldn't find process definition 'Blah'
10:38:41,443 ERROR [STDERR]     at org.jbpm.db.GraphSession.findLatestProcessDefinition(GraphSession.java:158)
10:38:41,443 ERROR [STDERR]     at org.jbpm.JbpmContext.newProcessInstanceForUpdate(JbpmContext.java:417)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.bpm.BusinessProcess.createProcess(BusinessProcess.java:134)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.bpm.BusinessProcess.createProcess(BusinessProcess.java:123)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.bpm.BusinessProcessInterceptor.afterInvocation(BusinessProcessInterceptor.java:108)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.bpm.BusinessProcessInterceptor.aroundInvoke(BusinessProcessInterceptor.java:51)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.transaction.TransactionInterceptor$1.work(TransactionInterceptor.java:95)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.util.Work.workInTransaction(Work.java:47)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.transaction.TransactionInterceptor.aroundInvoke(TransactionInterceptor.java:89)
10:38:41,444 ERROR [STDERR]     at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68)
10:38:41,445 ERROR [STDERR]     at org.jboss.seam.core.MethodContextInterceptor.aroundInvoke(MethodContextInterceptor.java:44)
10:38:41,445 ERROR [STDERR]     at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68)
10:38:41,445 ERROR [STDERR]     at org.jboss.seam.intercept.RootInterceptor.invoke(RootInterceptor.java:107)
10:38:41,445 ERROR [STDERR]     at org.jboss.seam.intercept.JavaBeanInterceptor.interceptInvocation(JavaBeanInterceptor.java:185)
10:38:41,445 ERROR [STDERR]     at org.jboss.seam.intercept.JavaBeanInterceptor.invoke(JavaBeanInterceptor.java:103)
10:38:41,445 ERROR [STDERR]     at com.locaweb.infra.gridserver.resources.ServerResource_$$_javassist_5.getServerResource(ServerResource_$$_javassist_5.java)
10:38:41,445 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
10:38:41,445 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
10:38:41,447 ERROR [STDERR]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
10:38:41,447 ERROR [STDERR]     at java.lang.reflect.Method.invoke(Method.java:585)
10:38:41,447 ERROR [STDERR]     at org.resteasy.MethodInjectorImpl.invoke(MethodInjectorImpl.java:72)
10:38:41,447 ERROR [STDERR]     ... 28 more
10:38:41,448 ERROR [STDERR] Caused by: org.hibernate.exception.GenericJDBCException: Cannot open connection
10:38:41,449 ERROR [STDERR]     at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:103)
10:38:41,449 ERROR [STDERR]     at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:91)
10:38:41,449 ERROR [STDERR]     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
10:38:41,449 ERROR [STDERR]     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:29)
10:38:41,449 ERROR [STDERR]     at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:426)
10:38:41,449 ERROR [STDERR]     at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:144)
10:38:41,449 ERROR [STDERR]     at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1547)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.doQuery(Loader.java:673)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.doList(Loader.java:2220)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.Loader.list(Loader.java:2099)
10:38:41,450 ERROR [STDERR]     at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)
10:38:41,451 ERROR [STDERR]     at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)
10:38:41,451 ERROR [STDERR]     at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)
10:38:41,451 ERROR [STDERR]     at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)
10:38:41,451 ERROR [STDERR]     at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
10:38:41,451 ERROR [STDERR]     at org.hibernate.impl.AbstractQueryImpl.uniqueResult(AbstractQueryImpl.java:811)
10:38:41,451 ERROR [STDERR]     at org.jbpm.db.GraphSession.findLatestProcessDefinition(GraphSession.java:154)
10:38:41,451 ERROR [STDERR]     ... 49 more
10:38:41,452 ERROR [STDERR] Caused by: org.jboss.util.NestedSQLException: Could not enlist in transaction on entering meta-aware object!; - nested throwable: (javax.transaction.SystemException: java.lang.Throwable: Unabled to enlist resource, see the previous warnings. tx=TransactionImple < ac, BasicAction: 7f000101:d2f8:4a1fe246:4e status: ActionStatus.ABORT_ONLY >); - nested throwable: (org.jboss.resource.JBossResourceException: Could not enlist in transaction on entering meta-aware object!; - nested throwable: (javax.transaction.SystemException: java.lang.Throwable: Unabled to enlist resource, see the previous warnings. tx=TransactionImple < ac, BasicAction: 7f000101:d2f8:4a1fe246:4e status: ActionStatus.ABORT_ONLY >))
10:38:41,453 ERROR [STDERR]     at org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:95)
10:38:41,453 ERROR [STDERR]     at org.hibernate.connection.DatasourceConnectionProvider.getConnection(DatasourceConnectionProvider.java:69)
10:38:41,453 ERROR [STDERR]     at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:423)
10:38:41,453 ERROR [STDERR]     ... 64 more
10:38:41,455 ERROR [STDERR] Caused by: org.jboss.resource.JBossResourceException: Could not enlist in transaction on entering meta-aware object!; - nested throwable: (javax.transaction.SystemException: java.lang.Throwable: Unabled to enlist resource, see the previous warnings. tx=TransactionImple < ac, BasicAction: 7f000101:d2f8:4a1fe246:4e status: ActionStatus.ABORT_ONLY >)
10:38:41,459 ERROR [STDERR]     at org.jboss.resource.connectionmanager.TxConnectionManager.managedConnectionReconnected(TxConnectionManager.java:358)
10:38:41,460 ERROR [STDERR]     at org.jboss.resource.connectionmanager.BaseConnectionManager2.reconnectManagedConnection(BaseConnectionManager2.java:524)
10:38:41,460 ERROR [STDERR]     at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:405)
10:38:41,460 ERROR [STDERR]     at org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:849)
10:38:41,460 ERROR [STDERR]     at org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:89)
10:38:41,460 ERROR [STDERR]     ... 66 more
10:38:41,461 ERROR [STDERR] Caused by: javax.transaction.SystemException: java.lang.Throwable: Unabled to enlist resource, see the previous warnings. tx=TransactionImple < ac, BasicAction: 7f000101:d2f8:4a1fe246:4e status: ActionStatus.ABORT_ONLY >
10:38:41,462 ERROR [STDERR]     at org.jboss.resource.connectionmanager.TxConnectionManager$TxConnectionEventListener$TransactionSynchronization.checkEnlisted(TxConnectionManager.java:759)
10:38:41,462 ERROR [STDERR]     at org.jboss.resource.connectionmanager.TxConnectionManager$TxConnectionEventListener.enlist(TxConnectionManager.java:592)
10:38:41,462 ERROR [STDERR]     at org.jboss.resource.connectionmanager.TxConnectionManager.managedConnectionReconnected(TxConnectionManager.java:352)
10:38:41,462 ERROR [STDERR]     ... 70 more 我正在使用带有驱动程序 net.sourceforge.jtds.jdbcx.JtdsDataSource 的带有两个 xa 数据源（一个用于我的数据库，一个用于 Jbpm 的数据库）的 SQLServer 数据库。Web 服务确实使用非 jbpm 数据库。

当我在没有 getSomething() 方法访问非 jbpm 数据库的休眠会话的情况下尝试此操作时，它可以正常工作。但是，如果我注入会话并尝试相同的事情，大多数情况下它都不起作用。

有谁知道发生了什么？

    c# - C# - 获取 ASPNET WindowsIdentity

ID：927194

赞同：0

时间：2009-05-29T17:28:46.577

标签：c#, impersonation, file-permissions, windows-identity

我想让 ASPNET 用户完全控制几个文件，但看起来我需要先获取帐户的令牌。有谁知道如何在桌面应用程序中模拟 ASPNET 帐户？

谢谢！

            回答 #1

赞同：2

时间：2009-05-29T17:40:46.167

下面是一个使用[WindowsIdentity.Impersonate](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.impersonate(VS.71).aspx)模拟另一个用途的示例和[另一个示例](http://www.codeproject.com/KB/cs/cpimpersonation1.aspx)。您必须有一个[已知的进程标识](http://msdn.microsoft.com/en-us/library/dwc1xthy.aspx)，ASP.NET 才能在其下运行。

        java - Java-将文件复制到新文件或现有文件

ID：927203

赞同：6

时间：2009-05-29T17:30:20.007

标签：java, file

我想写一个函数 copy(File f1, File f2) f1 总是一个文件。f2 是文件或目录。
如果 f2 是一个目录，我想将 f1 复制到这个目录（文件名应该保持不变）。
如果 f2 是一个文件，我想将 f1 的内容复制到文件 f2 的末尾。
因此，例如，如果 F2 具有以下内容：

2222222222222

F1有内容

1111111111111

我做 copy(f1,f2) 然后 f2 应该变成

2222222222222

1111111111111

谢谢！

            回答 #1

赞同：17

时间：2009-05-29T17:35:44.930

[Apache Commons IO 来救援！](http://commons.apache.org/io/)

扩展艾伦的帖子：

```
 File f1 = new File(srFile);
  File f2 = new File(dtFile);

  InputStream in = new FileInputStream(f1);
  OutputStream out = new FileOutputStream(f2, true); // appending output stream

  try {
     IOUtils.copy(in, out);
  }
  finally {
      IOUtils.closeQuietly(in);
      IOUtils.closeQuietly(out);
  } 
```

使用 Commons IO 可以简化很多流式的工作。

            回答 #2

赞同：5

时间：2009-05-29T18:00:40.340

使用 Alllain Lolande 的答案中的代码并对其进行扩展，这应该可以解决您问题的两个部分：

```
File f1 = new File(srFile);
File f2 = new File(dtFile);

// Determine if a new file should be created in the target directory,
// or if this is an existing file that should be appended to.
boolean append;
if (f2.isDirectory()) {
    f2 = new File(f2, f1.getName());
    // Do not append to the file. Create it in the directory, 
    // or overwrite if it exists in that directory.
    // Change this logic to suite your requirements.
    append = false;
} else {
    // The target is (likely) a file. Attempt to append to it.
    append = true;
}

InputStream in = null;
OutputStream out = null;
try {
    in = new FileInputStream(f1);
    out = new FileOutputStream(f2, append);

    byte[] buf = new byte[1024];
    int len;
    while ((len = in.read(buf)) > 0) {
        out.write(buf, 0, len);
    }
} finally {
    if (out != null) {
        out.close();
    }
    if (in != null) {
        in.close();
    }
} 
```

            回答 #3

赞同：2

时间：2009-05-29T17:34:40.237

FileOutputStream 有一个构造函数，允许您指定追加而不是覆盖。

您可以使用它将 f1 的内容复制到 f2 的末尾，如下所示：

```
 File f1 = new File(srFile);
  File f2 = new File(dtFile);

  InputStream in = new FileInputStream(f1);
  OutputStream out = new FileOutputStream(f2, true);

  byte[] buf = new byte[1024];
  int len;
  while ((len = in.read(buf)) > 0){
    out.write(buf, 0, len);
  }
  in.close();
  out.close(); 
```

            回答 #4

赞同：1

时间：2009-05-29T17:34:39.627

查看下面的链接。它是一个使用 NIO 将文件复制到另一个文件的源文件。

[http://www.java2s.com/Code/Java/File-Input-Output/CopyafileusingNIO.htm](http://www.java2s.com/Code/Java/File-Input-Output/CopyafileusingNIO.htm)

        asp.net-mvc - 使用 ASP.NET MVC 设置 Spring.NET 验证框架

ID：927211

赞同：0

时间：2009-05-29T17:30:59.523

标签：asp.net-mvc, spring.net

我正在开始一个新的工作项目，我决定给 MVC 一个机会。这是一个用于通勤挑战的小型内部站点。  

我想使用 Spring.NET 进行验证。我之前在 Web 窗体中使用过 Spring.NET，但是没有像传统 ASP.NET 中那样的代码，如何使用 Spring.NET 提供的页面验证框架？

编辑1：

为了自己尝试，这就是我所拥有的：

网络配置

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <sectionGroup name="spring">
            <section name="context" type="Spring.Context.Support.WebContextHandler, Spring.Web" />
            <section name="objects" type="Spring.Context.Support.DefaultSectionHandler, Spring.Core"/>
            <section name="parsers" type="Spring.Context.Support.NamespaceParsersSectionHandler, Spring.Core"/>
        </sectionGroup>
    </configSections>
    <appSettings>
        <add key="RouteValidator" value="RouteValidator"/>
        <add key="UserValidator" value="UserValidator"/>        
    </appSettings>
    <spring>
        <context>
            <resource uri="config://spring/objects"/>
            <resource uri="~/Config/Spring.Web.cfg.xml" />
            <resource uri="~/Config/Spring.Validation.cfg.xml" />
        </context>
        <parsers>
            <parser type="Spring.Validation.Config.ValidationNamespaceParser, Spring.Core" />
        </parsers>
    </spring>
    <system.web>
            <httpModules>
                <add name="Spring" type="Spring.Context.Support.WebSupportModule, Spring.Web" />
            </httpModules>
    </system.web>   
</configuration> 
```

Spring.Web.Cfg.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<objects xmlns="http://www.springframework.net"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="http://www.springframework.net http://www.springframework.net/xsd/spring-objects.xsd">

    <description>
        Foo MVC Controller declarations.
    </description>

    <object id="HomeController" type="Foo.MVC.Web.Controllers.HomeController, Foo.MVC.Web"></object>
    <object id="AccountController" type="Foo.MVC.Web.Controllers.RouteController, Foo.MVC.Web"></object>
    <object id="RouteController" type="Foo.MVC.Web.Controllers.RouteController, Foo.MVC.Web"></object>

    <object id="Spring.Web.UI.Controls.ValidationError" abstract="true">
        <property name="Renderer">
            <object type="Spring.Web.UI.Validation.IconValidationErrorsRenderer, Spring.Web">
                <property name="IconSrc" value="validation-error.gif"/>
            </object>
        </property>
    </object>

    <object id="Spring.Web.UI.Controls.ValidationSummary" abstract="true">
        <property name="Renderer">
            <object type="Spring.Web.UI.Validation.DivValidationErrorsRenderer, Spring.Web">
                <property name="CssClass" value="validationError"/>
            </object>
        </property>
    </object>

    <object id="standardPage" abstract="true">
        <property name="MasterPageFile" value="~/Views/Shared/Site.master"/>
        <property name="CssRoot" value="~/Content/"/>
        <property name="ImagesRoot" value="~/Content"/>
    </object>
</objects> 
```

我的验证文件非常标准，基本上是从另一个项目复制和粘贴的，因此我没有包含它。

现在我遇到的问题是如何使用它？如何获取应用程序上下文？我的 web 表单项目 users `Spring.Web.UI.Page`，但我很担心，因为 MVC 中的默认页面派生自`System.Web.Mvc.ViewPage`，所以这不起作用。

还是我还不能使用 Spring.NET 的 MVC 框架？

谢谢！

感谢您的任何帮助。

            回答 #1

赞同：0

时间：2009-06-08T12:36:24.540

您绝对可以将 Spring 与 ASP.Net MVC 一起使用。您需要在 Global.ascx 类中注册您正在使用它，然后框架将根据您在配置文件中定义的内容创建控制器。

```
public class MvcApplication : System.Web.HttpApplication
{

    ...Routes stuff...

    protected void Application_Start()
    {
       ControllerBuilder.Current.SetControllerFactory(typeof(ControllerFactory));

       RegisterRoutes(RouteTable.Routes);    
    }
}
public class ControllerFactory : IControllerFactory
{
    public IController CreateController(RequestContext requestContext, string controllerName)
    {
        return IoC.Resolve<IController>(controllerName);
    }

    public void ReleaseController(IController controller)
    {
        //This is a sample implementation 
        //If pooling is used write code to return the object to pool 
        if (controller is IDisposable)
        {
            (controller as IDisposable).Dispose();

        }
        controller = null;
    }
}
public static class IoC
{
    static readonly IObjectFactory Factory
        = new XmlObjectFactory(new FileSystemResource
            (HttpContext.Current.Server.MapPath("~/Config/Spring.config")));

    public static T Resolve<T>(string name)
    {
        return (T)Factory.GetObject(name);
    }
} 
```

只要确保你的 spring 配置文件的路径是正确的！这是改编自此[链接](http://www.pnpguidance.net/Post/SetDefaultControllerFactoryIControllerFactoryASPNETMVCFramework.aspx)。

更广泛地说，这种方法不允许您对页面类进行 Spring，并且作为一种 MVC 架构，其中视图是非常愚蠢的类，并不真正支持以您建议的方式在视图本身中进行丰富的验证。查看在 JQuery 中的模型（回发）中包含验证。

            回答 #2

赞同：0

时间：2009-11-12T17:33:35.190

据我所知，最新版本的 ASP.NET MVC (1.0) 和 Spring.NET 框架 (1.3) 不支持 Spring 验证。

至于将 Spring.NET 与 MVC 结合，您可以使用 MvcContrib 项目并使用 Colin Desmond 发布的相同代码库（但您不必自己做这些脏活）。

        iphone - UINavigationController 视图作为子视图的 iPhone 旋转

ID：927213

赞同：0

时间：2009-05-29T17:31:43.970

标签：iphone, cocoa-touch

当 UITableview 是子视图时，我在让 UINavigationController 在自动旋转后正确放置其表格时遇到问题。  

发生的情况是，导航栏向下移动了大约 20 像素，并且表格在横向上变得太短太宽，或者在纵向上变得太窄。

有人有什么建议吗？在过去的一个月里，这一直让我发疯......

            回答 #1

赞同：0

时间：2009-05-29T18:31:23.273

这听起来像是 iPhone 3.0 测试版的一个已知问题。由于它在 NDA 下，因此不能在这里公开讨论。但是，Apple 讨论论坛上有与此问题相关的讨论[。](https://devforums.apple.com/message/69293)您需要成为付费 iPhone 开发人员计划的一部分才能访问该线程，因为它在 3.0 部分中。

        php - 如何解决 PHP 中缺少 finally 块的问题？

ID：927214

赞同：56

时间：2009-05-29T17:31:43.983

标签：php, exception, resource-cleanup

5.5 版之前的 PHP 没有 finally 块 - 即，在大多数明智的语言中，您可以这样做：

```
try {
   //do something
} catch(Exception ex) {
   //handle an error
} finally {
   //clean up after yourself
} 
```

PHP 没有 finally 块的概念。  

任何人都有解决语言中这个相当恼人的漏洞的经验吗？

            回答 #1

赞同：61

时间：2009-05-29T17:36:58.233

解决方案，没有。烦人的繁琐解决方法，是的：

```
$stored_exc = null;
try {
    // Do stuff
} catch (Exception $exc) {
    $stored_exc = $exc;
    // Handle an error
}
// "Finally" here, clean up after yourself
if ($stored_exc) {
    throw($stored_exc);
} 
```

恶心，但应该工作。

**请注意**：PHP 5.5 finally（咳咳，抱歉）添加了 finally 块：[https](https://wiki.php.net/rfc/finally) ://wiki.php.net/rfc/finally （只花了几年时间......在 5.5 RC 中可用将近四年自我发布此答案以来的日期...）

            回答 #2

赞同：9

时间：2012-02-11T22:48:30.473

[RAII](https://stackoverflow.com/questions/2321511/)习惯用法为块提供代码级替代`finally`。创建一个包含可调用对象的类。在析构函数中，调用可调用对象。

```
class Finally {
    # could instead hold a single block
    public $blocks = array();

    function __construct($block) {
        if (is_callable($block)) {
            $this->blocks = func_get_args();
        } elseif (is_array($block)) {
            $this->blocks = $block;
        } else {
            # TODO: handle type error
        }
    }

    function __destruct() {
        foreach ($this->blocks as $block) {
            if (is_callable($block)) {
                call_user_func($block);
            } else {
                # TODO: handle type error.
            }
        }
    }
} 
```

协调

请注意，PHP 没有变量的块范围，因此`Finally`在函数退出或（在全局范围内）关闭序列之前不会启动。例如，以下内容：

```
try {
    echo "Creating global Finally.\n";
    $finally = new Finally(function () {
        echo "Global Finally finally run.\n";
    });
    throw new Exception;
} catch (Exception $exc) {}

class Foo {
    function useTry() {
        try {
            $finally = new Finally(function () {
                echo "Finally for method run.\n"; 
            });
            throw new Exception;
        } catch (Exception $exc) {}
        echo __METHOD__, " done.\n";
    }
}

$foo = new Foo;
$foo->useTry();

echo "A whole bunch more work done by the script.\n"; 
```

将导致输出：

```
最后创建全局。
Foo::use 尝试完成。
最后用于方法运行。
脚本完成了一大堆工作。
Global 终于运行了。

```

$这个

PHP 5.3 的闭包无法访问`$this`（在 5.4 中已修复），因此您需要一个额外的变量来访问某些 finally 块中的实例成员。

```
class Foo {
    function useThis() {
        $self = $this;
        $finally = new Finally(
            # if $self is used by reference, it can be set after creating the closure
            function () use ($self) {
               $self->frob();
            },
            # $this not used in a closure, so no need for $self
            array($this, 'wibble')
        );
        /*...*/
    }

    function frob() {/*...*/}
    function wibble() {/*...*/}
} 
```

私有和受保护的字段

可以说，PHP 5.3 中这种方法的最大问题是 finally-closure 无法访问对象的私有和受保护字段。与访问一样`$this`，这个问题在 PHP 5.4 中得到解决。目前，可以使用引用访问[私有和受保护的属性](https://stackoverflow.com/q/3722394/90527)，正如 Artefacto 在他对本网站其他地方有关此主题的问题的[回答中所显示的那样。](https://stackoverflow.com/a/3722429/90527)

```
class Foo {
    private $_property='valid';

    public function method() {
        $this->_property = 'invalid';
        $_property =& $this->_property;
        $finally = new Finally(function () use (&$_property) {
                $_property = 'valid';
        });
        /* ... */
    }
    public function reportState() {
        return $this->_property;
    }
}
$f = new Foo;
$f->method();
echo $f->reportState(), "\n"; 
```

可以使用反射访问[私有和受保护的方法。](https://stackoverflow.com/q/6386733/90527)您实际上可以使用相同的技术来访问非公共属性，但引用更简单、更轻量级。[在匿名函数](http://www.php.net/manual/en/functions.anonymous.php#98384)的 PHP 手册页的评论中，Martin Partel 给出了一个`FullAccessWrapper`类的示例，该类将非公共字段开放给公共访问。我不会在这里复制它（参见前面的两个链接），但这里是你如何使用它：

```
class Foo {
    private $_property='valid';

    public function method() {
        $this->_property = 'invalid';
        $self = new FullAccessWrapper($this);
        $finally = new Finally(function () use (&$self) {
                $self->_fixState();
        });
        /* ... */
    }
    public function reportState() {
        return $this->_property;
    }
    protected function _fixState() {
        $this->_property = 'valid';
    }
}
$f = new Foo;
$f->method();
echo $f->reportState(), "\n"; 
```

`try/finally`

`try`块至少需要一个`catch`. 如果您只想`try/finally`添加一个`catch`块来捕获非`Exception`（PHP 代码不能抛出任何不是从 派生的东西`Exception`）或重新抛出捕获的异常。在前一种情况下，我建议`StdClass`将 catch 作为一个成语，意思是“不要抓到任何东西”。在方法中，捕获当前类也可以用来表示“不捕获任何东西”，但是`StdClass`在搜索文件时使用更简单，更容易找到。

```
try {
   $finally = new Finally(/*...*/);
   /* ... */
} catch (StdClass $exc) {}

try {
   $finally = new Finally(/*...*/);
   /* ... */
} catch (RuntimeError $exc) {
    throw $exc
} 
```

            回答 #3

赞同：2

时间：2012-05-30T18:43:52.333

这是我对缺少 finally 块的解决方案。它不仅为 finally 块提供了解决方法，它还扩展了 try/catch 以捕获 PHP 错误（以及致命错误）。我的解决方案如下所示（PHP 5.3）：

```
_try(
    //some piece of code that will be our try block
    function() {
        //this code is expected to throw exception or produce php error
    },

    //some (optional) piece of code that will be our catch block
    function($exception) {
        //the exception will be caught here
        //php errors too will come here as ErrorException
    },

    //some (optional) piece of code that will be our finally block
    function() {
        //this code will execute after the catch block and even after fatal errors
    }
); 
```

您可以从 git hub 下载带有文档和示例的解决方案 - 
 [https://github.com/Perennials/travelsdk-core-php/tree/master/src/sys](https://github.com/Perennials/travelsdk-core-php/tree/master/src/sys)

            回答 #4

赞同：1

时间：2009-05-29T19:08:06.523

由于这是一种语言结构，因此您不会找到简单的解决方案。您可以编写一个函数并将其作为 try 块的最后一行和最后一行调用，然后再重新抛出 try 块中的异常。

好书反对将 finally 块用于释放资源之外的任何其他内容，因为如果发生令人讨厌的事情，您无法确定它是否会执行。称其为令人讨厌的漏洞是一种夸大其词的说法。相信我，很多非常好的代码都是用没有 finally 块的语言编写的。:)

finally 的重点是无论 try 块是否成功都执行。

            回答 #5

赞同：1

时间：2013-07-14T10:43:57.797

```
function _try(callable $try, callable $catch, callable $finally = null)
{
    if (is_null($finally))
    {
        $finally = $catch;
        $catch = null;
    }

    try
    {
        $return = $try();
    }
    catch (Exception $rethrow)
    {
        if (isset($catch))
        {
            try
            {
                $catch($rethrow);
                $rethrow = null;
            }
            catch (Exception $rethrow) { }
        }
    }

    $finally();

    if (isset($rethrow))
    {
        throw $rethrow;
    }
    return $return;
} 
```

使用闭包调用。第二个参数`$catch`, 是可选的。例子：

```
_try(function ()
{
    // try
}, function ($ex)
{
    // catch ($ex)
}, function ()
{
    // finally
});

_try(function ()
{
    // try
}, function ()
{
    // finally
}); 
```

正确处理任何地方的异常：

*   `$try`: 异常将被传递给`$catch`.  `$catch`将首先运行，然后`$finally`. 如果没有`$catch`，运行后会重新抛出异常`$finally`。
*   `$catch`:`$finally`将立即执行。异常将在`$finally`完成后重新抛出。
*   `$finally`: 异常会畅通无阻地分解调用堆栈。任何其他计划重新抛出的异常都将被丢弃。
*   **None** : 返回值 from`$try`将被返回。

            回答 #6

赞同：0

时间：2012-07-31T08:05:55.470

如果有人仍在跟踪这个问题，您可能有兴趣查看（全新的）[RFC 以了解 PHP wiki 中的 finally 语言功能](https://wiki.php.net/rfc/finally)。作者似乎已经有了工作补丁，我相信该提案将从其他开发人员的反馈中受益。

            回答 #7

赞同：0

时间：2013-05-04T19:23:11.370

我刚刚写完一个更优雅的 Try Catch finally 类，它可能对你有用。有一些缺点，但可以解决。

[https://gist.github.com/Zeronights/5518445](https://gist.github.com/Zeronights/5518445)

        python - FIFO（命名管道）消息传递障碍

ID：927233

赞同：2

时间：2009-05-29T17:35:45.397

标签：python, linux, unix, pipe, named-pipes

我计划使用 Unix 命名管道 (mkfifo) 进行简单的多进程消息传递。一条消息将只是一行文本。

你会劝阻我吗？我应该期待什么障碍？

我注意到了这些限制：

1.  在收到消息之前，发件人无法继续。
2.  接收器被阻塞，直到有一些数据。当我们需要停止读取时，将需要非阻塞 IO。例如，另一个线程可能会要求这样做。
3.  接收者可以在一次读取中获得许多消息。这些必须在退出前处理。
4.  原子消息的最大长度限制为 4096 字节。这是 Linux 上的 PIPE_BUF 限制（参见 man 7 pipe）。

我将在 Python 中实现消息传递。但障碍普遍存在。

            回答 #1

赞同：5

时间：2009-05-29T17:53:36.173

1.  缺乏可移植性——它们主要是 Unix 的东西。插座更便携。
2.  难以扩展到多个系统（另一个套接字+）
3.  另一方面，对于同一台机器上的进程，我相信管道比套接字更快（通信开销更少）。

至于你的限制，

1.  您可以在管道上“[选择](http://docs.python.org/library/select.html)”，以进行非阻塞读取。
2.  我通常（在 perl 中）在由“\n”分隔的管道上打印出我的消息，并从中读取一行以一次获取一条消息。
3.  请注意原子长度。

我发现[perlipc](http://search.cpan.org/~nwclark/perl-5.8.9/pod/perlipc.pod)是各种选项之间的一个很好的讨论，尽管它有 perl 特定的代码。

            回答 #2

赞同：3

时间：2009-05-29T18:11:45.280

发送方和接收方的阻塞都可以通过非阻塞 I/O 解决。

FIFO 的进一步限制：

*   一次只有一个客户。
*   客户端关闭 FIFO 后，服务器需要重新打开其端点。
*   单向。

我会改用[UNIX 域套接字](http://en.wikipedia.org/wiki/Unix_domain_socket)，它没有上述限制。

作为一个额外的好处，如果你想扩展它以在多台机器之间进行通信，它几乎没有任何变化。例如，只需将 Python 文档页面上的[socket](http://docs.python.org/library/socket.html#socket-example)替换`socket.AF_INET`为`socket.AF_UNIX`, `(HOST, PORT)`with `filename`,*就可以了*。

`SOCK_STREAM`会给你类似流的行为；也就是说，两个发送可以合并为一个接收，反之亦然。  `AF_UNIX`还支持`SOCK_DGRAM`：保证数据报作为一个单元发送和读取，或者根本不读取。（类似地，`AF_INET`+ `SOCK_STREAM`=TCP，`AF_INET`+ `SOCK_DGRAM`=UDP。）

        ruby - 将字符串数组转换为浮点数数组

ID：927242

赞同：6

时间：2009-05-29T17:40:37.197

标签：ruby, arrays, string, floating-point

我正在编写一个围绕从文件中获取数值数据集的应用程序。但是，由于数据是以字符串形式获取的，所以我必须将其转换为浮点数，这就是有趣的开始。我的代码的相关部分如图所示（第 65-73 行）：

```
 ft = []
    puts "File Name: #{ARGV[0]}"
    File.open(ARGV[0], "r") do |file|
        file.each_line do |line|
            ft << line.scan(/\d+/)
        end
    end

ft.collect! {|i| i.to_f} 
```

这在 irb 中工作得很好，也就是说，最后一行将数组更改为浮点数。

```
irb(main):001:0> ft = ["10", "23", "45"]
=> ["10", "23", "45"]
irb(main):002:0> ft.collect! {|i| i.to_f}
=> [10.0, 23.0, 45.0] 
```

但是，当我运行我的应用程序时，出现此错误：

```
ruby-statistics.rb:73:in `block in <main>': undefined method `to_f' for #<Array:
0x50832c> (NoMethodError)
        from ruby-statistics.rb:73:in `collect!'
        from ruby-statistics.rb:73:in `<main>' 
```

对此的任何帮助将不胜感激。

            回答 #1

赞同：12

时间：2009-05-29T17:56:42.080

`line.scan`返回一个数组，因此您将一个数组插入到一个数组中。`flatten`最简单的做法是在将字符串转换为浮点数之前调用数组。

```
ft = []
puts "File Name: #{ARGV[0]}"
File.open(ARGV[0], "r") do |file|
    file.each_line do |line|
            ft << line.scan(/\d+/)
    end
end

ft = ft.flatten.collect { |i| i.to_f } 
```

            回答 #2

赞同：6

时间：2009-05-29T17:51:29.157

阅读文件后，您应该查看“ft”的格式。

每一行都存储在另一个数组中，所以实际上“ft”看起来像这样：

```
[["1","2"],["3","4"]] 
```

所以你必须做这样的事情：

```
ft = []
puts "File Name: #{ARGV[0]}"
File.open(ARGV[0], "r") do |file|
    file.each_line do |line|
            ft << line.scan(/\d+/)
    end
end

tmp = []

ft.each do |line|
    line.each do |number|
        tmp << number.to_f
    end
end

puts tmp 
```

这只是一个猜测，因为我不知道您的文件格式是什么样的。

编辑：

这里作为一个单行：

```
ft.flatten!.collect! { |i| i.to_f } 
```

        java - Maven Surefire插件的格式是什么
陈述？

ID：927249

赞同：4

时间：2009-05-29T17:42:35.120

标签：java, maven-2

我正在尝试使用以下包含语句运行[Maven ](http://en.wikipedia.org/wiki/Apache_Maven) [Surefire ：](http://maven.apache.org/plugins/maven-surefire-plugin/)

```
<include>**/[A-R]*SeleniumTest.java</include>
<include>**/[A-R]**SeleniumTest.java</include>
<include>**/[A-R].*SeleniumTest.java</include> 
```

但它似乎不支持任何这些符号。这个表达式的语法是什么？（文档链接将不胜感激）

            回答 #1

赞同：6

时间：2009-05-29T18:22:38.097

Maven Surefire 插件遵循与 Maven 的 FileSets 相同的语义来配置包含和排除。

您可以通过[Maven: The Definitive Guide (Section 12.7)](http://www.sonatype.com/books/maven-book/reference/assemblies-sect-filesets.html#ex-explicit-fileSet)找到有关其工作原理的一些详细信息：

包含部分使用包含路径模式的包含元素列表。这些模式可能包含通配符，例如`**`匹配一个或多个目录的' `*`'或匹配文件名的一部分的''，以及`?`匹配文件名中的单个字符的''

            回答 #2

赞同：2

时间：2009-05-29T18:01:42.943

maven 的 include 标签使用的模式遵循 Ant 的[Pattern](http://ant.apache.org/manual/dirtasks.html#patterns)表示法的行为。

不支持您示例中的 [AR] 表示法，但您可以使用包含和排除的组合来缩小运行的测试集。

        wpf - WPF：扩展主题的样式 - StackOverflowException

ID：927251

赞同：4

时间：2009-05-29T17:42:59.690

标签：wpf, themes, styles

除了 Royale 主题样式，我希望每个按钮都有 5 点边距。

Window1.xaml：

```
<Window x:Class="_styles.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/PresentationFramework.Royale;component/themes/royale.normalcolor.xaml" />
      </ResourceDictionary.MergedDictionaries>
      <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Margin" Value="5"/>
      </Style>
    </ResourceDictionary>
  </Window.Resources>
  <StackPanel>
    <Button Content="Button A"/>
    <Button Content="Button B"/>
  </StackPanel>
</Window> 
```

它编译但我得到：

PresentationFramework.dll 中出现“System.StackOverflowException”类型的未处理异常

```
public Window1() {
    InitializeComponent(); // <-- getting exception here
} 
```

没有例外细节，因为：

{无法计算表达式，因为当前线程处于堆栈溢出状态。}

            回答 #1

赞同：5

时间：2009-10-09T09:32:21.270

这似乎是您的样式与 PresentationFramework.Royale 中定义的样式之间的循环引用。一种解决方法是将资源放置在不同的级别：

```
<Window x:Class="_styles.Window1" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"    Title="Window1" Height="300" Width="300">
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/PresentationFramework.Royale;component/themes/royale.normalcolor.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources>
<StackPanel>
    <StackPanel.Resources>
        <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Margin" Value="5"/>
        </Style>
    </StackPanel.Resources>
    <Button Content="Button A"/>
</StackPanel>
</Window> 
```

            回答 #2

赞同：0

时间：2009-05-29T18:02:20.460

我会删除 BasedOn 属性 - 这不是必需的。这样想，合并 Royale 主题将应用按钮主题，而您只想更改边距 - 样式本质上是相加的，因此它将结合 Royale 主题*和*您自己的按钮主题而不指定 BasedOn 属性 - 确实有道理？

干杯!

            回答 #3

赞同：0

时间：2010-06-23T07:26:14.053

请参阅[此问题](https://stackoverflow.com/questions/2901664/how-do-i-alter-the-default-style-of-a-button-without-wpf-reverting-from-aero-to-c)和[我](https://stackoverflow.com/questions/2901664/how-do-i-alter-the-default-style-of-a-button-without-wpf-reverting-from-aero-to-c/3093183#3093183)对另一个解决方案的回答，该解决方案不需要您在每个窗口中指定资源字典并允许您动态解析 BasedOn 样式。

        nhibernate - Fluent NHibernate Automap 加入子类设置键

ID：927252

赞同：0

时间：2009-05-29T17:43:11.547

标签：nhibernate, fluent-nhibernate, primary-key, automapping

在流利的 nhibernate 中自动映射连接的子类时，我不知道如何为连接的子类提供主键。

```
public class Address:Entity {
    public virtual string Address1 { get; set; }
    public virtual string Address2 { get; set; }
    public virtual string City { get; set; }
    public virtual string State { get; set; }
    public virtual string Zip { get; set; }
    public virtual string Phone { get; set; }
    public virtual string Fax { get; set; }
    public virtual IList<Location> Locations { get; set; }
}

public class Location:Address {
    public virtual Address BillingAddress { get; set; }
    public virtual string OfficeHours { get; set; }
    public virtual string PatientAgeRestrictions { get; set; }
    public virtual bool WheelchairAccess { get; set; }
    public virtual string ContactPerson { get; set; }
    public virtual string ContactEmail { get; set; }
    public virtual string ContactPhone { get; set; }
    public virtual string ContactFax { get; set; }
    public virtual string TaxId { get; set; }
} 
```

我希望 Location 有它自己的 id “location_id”和它自己的序列。然后我希望通过 address_id 列映射到地址。  

现在它正在生成以“addressid”为主键的位置，这不是我想要的。如何通过自动映射更改此设置？

            回答 #1

赞同：0

时间：2009-05-29T19:44:07.323

我不确定你是否有加入子类的关系。也就是说，根据定义，连接的子类与其父类具有相同的 ID。例如，您可能`Person`在数据库中存储了一个实体，用于存储通用“人”信息，如姓名/年龄/等，然后是一个`Employee`子类实体，该实体存储在不同的表中并保存职位、薪水和就业日期等数据。所以 an`Employee`是一个子类型，`Person`并且要获得完整的“Employee-Person”对象，您必须在两个表的主键上连接它们（例如`SELECT * FROM Employee INNER JOIN Person ON Employee.Employee_id = Person.Person_id`）。

你*确定*你的关系模型在这里吗？真的`Location`是 的亚型`Address`吗？从您的财产名称中推断出一点，在我看来，这不是您想要的。`Address`看起来你可能在 an和 an之间有一个多对多`Organization`（也就是说，同一个地址可能有许多“组织”，一个“组织”可能有许多地址），有一个“联系人”在特定地址组织。`Address`在这种情况下，您应该映射“组织”、“联系人”以及定义与“组织”之间关系的另一个实体。

        ms-access - 是否有一种简单的方法可以在此 Access 数据库架构中填充下拉列表？

ID：927256

赞同：4

时间：2009-05-29T17:44:11.857

标签：ms-access, schema, drop-down-menu

我有 3 个表格，如下所示：

```
Location                Node                 Sektor
-----                   -------              -------
PK: ID - Autonumber     PK: ID - Autonumber  PK: ID - Autonumber
Name                    NodeName             Sektor
Height                  Aksess               Frequency
Latitude                Tag                  Coverage
Longtitude              IP 
```

每个位置都与多个节点相连，这些节点又与多个扇区相连。

现在有趣的部分。在 Microsoft Access 中，您可以制作允许用户轻松添加数据的架构。我的最终表格看起来像这样，我想使用我的模式将数据插入：

```
Customers
-------
PK: CustID
Name
Subscribtion
Sektor 
```

这就是我想要施展魔法的地方。我希望用户能够首先选择一个位置，然后显示可用节点（最好在下拉列表中），最后他可以为他添加的客户选择正确的 sektor。

任何人都知道这样做的一个相当简单的方法？我开始为此制作宏，但我对宏的记忆真的很糟糕，而且我没有正确的文献来查找它。

任何帮助appriciated =）

            回答 #1

赞同：5

时间：2009-05-29T19:01:38.750

给任何东西命名确实是一个非常糟糕的主意。

在我看来，您需要级联组合框。您将需要一点 VBA。

两个组合框叫做 cboLocation 和 cboNodes，在一个叫做 frmForm 的窗体上

cbo位置

```
RowSource: SELECT ID, [Name]
FROM Locations
ORDER BY [Name]

ColumnCount: 2

ColumnWidths: 0;2.00cm  ''The second column can be any suitable width

LimitToList: Yes 
```

事件：

```
Private Sub cboLocation_AfterUpdate()
    Me.cboNode.Requery
End Sub 
```

CboNode

```
RowSource: SELECT ID, NodeName
FROM Nodes
WHERE IP=[Forms]![frmForm]![cboLocation]
ORDER BY NodeName

ColumnCount: 2

ColumnWidths: 0;2.00 ''Ditto

LimitToList: Yes 
```

事件：

```
Private Sub cboNode_GotFocus()
    If Trim(Me.cboLocation & "") = vbNullString Then
        MsgBox "Please select location"
        Me.cboLOcation.SetFocus
    End If
End Sub 
```

您还需要一个表单事件：

```
Private Sub Form_Current()
    Me.cboNode.Requery
End Sub 
```

        jquery - 使用 jQuery 和 LINQ-to-Entities 在 ASP.NET MVC 客户端视图中对 jqGrid 进行排序

ID：927257

赞同：5

时间：2009-05-29T17:44:36.037

标签：jquery, asp.net-mvc, linq, jqgrid

我是一个 jQuery 菜鸟，所以我确定我在这里遗漏了一些简单的东西。

我让 jqGrid 使用从 LINQ-to-Entities 操作创建 JSON 数据的操作。但是当我在浏览器中单击列标题时，行不会排序。上升/下降指标出现，但没有其他反应。

必要的 JavaScript 和 CSS 链接位于母版页标题中：

```
<script src="/Scripts/jquery-1.3.2.min.js" type="text/javascript"></script>
<!-- 用于 jqGrid 的 CSS 和 JavaScript 文件显示在详细信息页面上 -->
<link rel="stylesheet" type="text/css" href="/scripts/jQuery/jqGrid-3.4.4/themes/green/grid.css" title="green" media="screen" />
<script src="/Scripts/jQuery/jqGrid-3.4.4/jquery.jqGrid.js" type="text/javascript"></script>
<script src="/Scripts/jQuery/jqGrid-3.4.4/js/jqModal.js" type="text/javascript"></script>
<script src="/Scripts/jQuery/jqGrid-3.4.4/js/jqDnR.js" type="text/javascript"></script>

```

这是我的初始化代码：

```
// jqGrid 设置。
$("#gridlist").jqGrid({
    url: '/联系人/GridData',
    数据类型：'json'，
    mtype: 'GET',
    colNames: ['ID', 'First Name', 'Last Name', 'Organization'],
    col型号：[
        { 名称：'id'，索引：'id'，宽度：40，对齐：'left'，可调整大小：true }，
        { name: 'first_name', index: 'first_name', width: 200, align: 'left', resizable: true, sortable: true, sorttype: "text" },
        {名称：'last_name'，索引：'last_name'，宽度：200，对齐：'left'，可调整大小：true，可排序：true，sorttype：“text”}，
        { 名称：“组织”，索引：“组织”，宽度：300，对齐：“左”，可调整大小：true，可排序：true，排序类型：“文本”}]，
    寻呼机：jQuery（'#pager'），
    行号：5，
    行列表：[5, 10, 20, 50],
    重复项：错误，
    观看记录：真实，
    imgpath: '/scripts/jQuery/jqGrid-3.4.4/themes/green/images',
    标题：“联系人”
});                  

```

这是HTML：

```
    <h3>我的网格数据</h3>
    <table id="gridlist" class="scroll" cellpadding="0" cellspacing="0">
    </table>
    <div id="pager" class="scroll" style="text-align:center;">
    </div>

```

而且，为了完整起见，操作方法：

```
公共 ActionResult GridData()
{
    var page = 新 { page = 1 };

    IEnumerable 联系人 = _db.ContactSet;
    诠释 i = 0;
    var rows = new object[contacts.Count()];

    foreach（联系人中的联系人）
    {
        rows[i] = new { id = contact.ID, cell = new[] { contact.ID.ToString(), contact.First_Name, contact.Last_Name, contact.Organization } };
        我++；
    }

    var 结果 = 新的 JsonResult();
    result.Data = new { page = 1, records = 2, rows, total = 1 };

    返回结果；
}

```

任何想法我在这里缺少什么明显的设置？

            回答 #1

赞同：4

时间：2009-05-29T19:43:45.093

有两种基本方法可以处理这个问题。网格可以对数据本身进行排序。我不记得如何打开它，因为我从不使用这个选项。通常，我使用的数据集太大而无法返回页面，因此我使用网格的分页功能。这需要在服务器上进行这种排序，因为网格不会看到整个数据集。

要在服务器上进行分页，请将 sidx 和 sord（均为字符串）参数添加到您的操作中。sidx 将是要排序的列的名称。sord 将是方向，asc 或 desc。

我有[一个演示项目](http://blogs.teamb.com/craigstuntz/2009/04/27/38243/)，它展示了如何做到这一点（使用 LINQ to Objects）。但是使用 LINQ to Entities 几乎是相同的；我在生产/非演示代码中使用 LINQ to Entities。下载演示解决方案并自行查找。

            回答 #2

赞同：2

时间：2009-06-15T21:58:45.203

```
 I think below example should do it. 2 important points make sure your sort column has "it" keyword as prefix. (thats for linq to know). second you load only the number of objects array element as the rows the query can read.

  var context = new HaackOverflowDataContext();

    int pageIndex = Convert.ToInt32(page) - 1;
    int pageSize = rows;
    int totalRecords = context.Question.Count();
    int totalPages = (int)Math.Ceiling((float)totalRecords / (float)pageSize);

    var questions = context.Question.OrderBy("it."+ sidx + " " + sord).Skip(pageIndex * pageSize).Take(pageSize);

    int i = 0;
    var rowsObj = new object[pageSize>totalRecords ?  totalRecords : pageSize];

    foreach (Question q in questions)
    {
        rowsObj[i] = new { id = q.Id, cell = new object[] { q.Id, q.Votes, q.Title } };
        i++;
    }

    var result = new JsonResult();
    result.Data = new
    {
        total = totalPages,
        page = page,
        records = totalRecords,
        rows = rowsObj
    };

    return result; 
```

谢谢 Anuj Pandey www.anuj.co.in

嘿嘿...这是否意味着我知道编程:)

            回答 #3

赞同：1

时间：2009-06-16T14:34:09.100

好的，我应该在我弄清楚时发布这个，但我最终陷入了其他任务。这是我为报表实体实现的 LINQ to Entities 所做的工作。首先，使用默认搜索加载 jqGrid 的代码很简单（一旦我弄清楚我错过了什么）：

```
 $(document).ready(function() {

    // Set up jqGrid for the report search results table.
    // This is displayed in a tab in the bottom section of the master page.
    $("#searchResultList").jqGrid({
        url: '/Report/GetResultsL2E/',
        datatype: 'json',
        mtype: 'GET',
        colNames: ['', 'ID', 'Title', 'Post_Date', 'Start_Date', 'End_Date', 'Summary'],
        colModel: [
          { name: 'act', index: 'act', width: 75, sortable: false },
          { name: 'ID', index: 'ID', width: 40, align: 'left', hidden: true },
          { name: 'Title', index: 'Title', width: 150, align: 'left' },
          { name: 'Post_Date', index: 'Post_Date', width: 80, align: 'left', formatter: 'date' },
          { name: 'Start_Date', index: 'Start_Date', width: 80, align: 'left', formatter: 'date' },
          { name: 'End_Date', index: 'End_Date', width: 80, align: 'left', formatter: 'date' },
          { name: 'Summary', index: 'Summary', width: 240, align: 'left' }
        ],
        pager: jQuery('#searchResultPager'),
        rowNum: 10,
        rowList: [5, 10, 20, 50],
        sortname: 'Title',
        sortorder: "asc",
        viewrecords: true,
        imgpath: '/Scripts/jqGrid/themes/green/images',
        caption: 'Report Search Results', 
        editurl: "/Report/Edit",
        scroll: true,
        height: 'auto',
        recordtext: ' Reports',
        pgtext: ' of ',
        multiselect: true, 
        multiboxonly: true, //adds check box column
        altRows: true,
        loadComplete: function() {
            var ids = jQuery("#searchResultList").getDataIDs();
            for (var i = 0; i ";
                se = "";
                ce = "";
                jQuery("#searchResultList").setRowData(ids[i], { act: be + se + ce })
            }
        }
    }).navGrid('#searchResultPager',
    { edit: false, add: false, del: false, search: false }, //options 
    {height: 280, reloadAfterSubmit: false }, // edit options 
    {height: 280, reloadAfterSubmit: false }, // add options 
    {reloadAfterSubmit: false }, // del options 
    {} // search options 
    );
}); 
```

加载默认搜索集的方法返回可用报告的总集的第一页：

```
///
/// 查询 ReportSet 以返回一个分页、排序的报表实体属性集，以响应来自视图的调用。
///
/// 用于排序的列的名称。
/// 排序的顺序（升序或降序）。
/// 返回调用进程的页数。
/// 要为页面返回的行数。
/// 此 ActionResult 返回一个 JSON 结果，供使用 jQuery 库的 jqGrid 使用。
/// jQuery 需要一个脚本标签来链接 jQuery.js 脚本。
/// jqGrid 需要指向以下脚本和样式表的样式表链接：
///
/// jQuery/themes/base/ui.all.css
/// jqGrid/themes/green/grid.css（或其他主题CSS文件）
/// jqGrid/jquery.jqGrid.js
/// jqGrid/grid.base.js
/// jqGrid/js/jqModal.js
/// jqGrid/js/jqDnR.js
///
public ActionResult GetResultsL2E(string sidx, string sord, int page, int rows)
{
    int pageIndex = Convert.ToInt32(page) - 1;
    int pageSize = 行；
    int totalRecords = _db.ReportSet.Count();
    int totalPages = (int)Math.Ceiling((float)totalRecords / (float)pageSize);
    int startRecord = pageIndex * pageSize;

    列表 rowStrings = new List();
    // 以固定顺序获取模型中的所有报表（用于比较）。
    //var reports = from item in _db.ReportSet
    // orderby item.Start_Date, item.Title
    // 选择新的 { item.ID, item.Title, item.Post_Date,
    // item.Start_Date, item.End_Date, item.Summary };
    // 以从 jqGrid 传递的动态顺序获取模型中的所有报表。
    字符串 orderBytext = "";
    orderBytext = string.Format("it.{0} {1}", sidx, sord);
    var 报告 = _db.ReportSet
                   .OrderBy(orderBytext);

    列表 stringList = new List();

    int 计数器 = 报告.Count();
    foreach（报告中的 var 报告）
    {
        var 行字符串 = 新
        {
            id = 报告.ID,
            细胞 = 新 [] {
                    "",
                    报告.ID.ToString(),
                    报告.标题,
                    报告.Post_Date.ToShortDateString(),
                    report.Start_Date.ToShortDateString(),
                    报告.End_Date.ToString(),
                    报告.Summary.ToString()}
        };
        stringList.Add(rowString);
    }

    var rowsOut = 新对象[计数器];
    对于 (int i = 0; 我
```

我后来添加了另一种方法来响应用户选择要排序的列，使用从 Albaharis 的书 C# 中讨论的 PredicateBuilder 在 Nutshell 的[动态组合表达式谓词](http://www.albahari.com/nutshell/predicatebuilder.aspx)部分。我在一个问题中讨论了我的解决[方案](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/25d5654a-fe63-405c-b0ce-934c1df0ac59)

            回答 #4

赞同：0

时间：2010-09-01T07:23:19.460

我在 jqGrid 框架出现但行没有出现的地方遇到了同样的问题。我的解决方案是添加以下代码。

```
**jsonData.JsonRequestBehavior = JsonRequestBehavior.AllowGet;**
         return jsonData; 
```

        wpf - 在 XAML 中使用 ObjectDataProvider 绑定属性崩溃 VS

ID：927260

赞同：0

时间：2009-05-29T17:46:47.217

标签：wpf, visual-studio-2008, xaml

抱歉，有一个非常具体的问题，为什么 VS2008 和 VS2010 会因这段代码崩溃？我虽然使用 ObjectDataProvider 来绑定属性是很常见的。我在网络上的很多地方都看到了示例，但是当我尝试使用它时，我得到了异常并且我的 VS 关闭了。

那么，我的代码有什么问题？我应该为 VS 注册一个错误吗？

```
<Window x:Class="ShortcutsManagementAddin.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:ShortcutsManagementAddin"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <ObjectDataProvider x:Key="Window1" ObjectType="{x:Type local:Window1}" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
            <RowDefinition Height="30" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="30" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="30" />
        </Grid.ColumnDefinitions>

        <TreeView ItemsSource="{Binding Source={StaticResource Window1}, Path=Categories}"></TreeView>
    </Grid>
</Window>

namespace ShortcutsManagementAddin
{
    public class Shortcut
    {
        public string CategoryName;
    }

    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        private List<Shortcut> categories = new List<Shortcut>();
        public List<Shortcut> Categories
        {
            get { return categories; }
        }

        public Window1()
        {
            categories.Add(new Shortcut { CategoryName = "Category 1" });
            categories.Add(new Shortcut { CategoryName = "Category 2" });
            categories.Add(new Shortcut { CategoryName = "Category 3" });
            categories.Add(new Shortcut { CategoryName = "Category 4" });
            categories.Add(new Shortcut { CategoryName = "Category 5" });

            InitializeComponent();
        }
    }
} 
```

            回答 #1

赞同：0

时间：2009-05-29T17:59:06.363

从您的代码示例看来，您正试图`Window1`从`Window1`. 鉴于这会导致无限循环，我可以看到应用程序或 Visual Studio 崩溃。

如果要将集合的成员绑定到`TreeView`，最好创建一个单独的类（它将包含列表），并将该类的实例设置为`DataContext`窗口的实例。`ItemsSource`然后，您可以通过将属性名称指定为 将的绑定`TreeView`到该类的成员`Path`。

            回答 #2

赞同：0

时间：2010-05-05T09:37:17.660

确认。在 Visual Studio 2010 RTM 上发生同样的崩溃。我也尝试使用Window1。问题是，有时设计师显示绑定没有任何问题。

似乎必须有一种使用Window1的方法。

        css - 带有填充的 div 内的 Internet Explorer 边距问题

ID：927261

赞同：2

时间：2009-05-29T17:47:12.490

标签：css, internet-explorer, cross-browser

在这种情况下，Internet Explorer 似乎没有提供适当的保证金。看起来它从盒子顶部测量边距并忽略填充。为什么是这样？有没有好的解决方法？这是一个例子：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>

        <style type="text/css">
            .messagebox
            {
                border: solid 2px black;
                background: blue;
                color: white;
                padding: 10px; /* Problem only when padding set */
            }

            h1, h2, h3, h4 
            {
               margin-top: 12px;
            }

        </style>
    </head>
    <body>
        <div class="messagebox" style="width: 300px">
            <h4 style="text-align: center">In IE, this text is 10px higher than in FF.</h4>
        </div>
    </body>
    </html> 
```

我在 IE7 和 FF3 中工作。谢谢。

            回答 #1

赞同：2

时间：2009-05-29T17:54:35.920

欢迎来到[IE 框模型 bug](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)

            回答 #2

赞同：0

时间：2009-05-29T17:50:54.103

你可以试试

```
body{
zoom:1;
} 
```

我不确定这是否会有所帮助，但如果确实如此，它可能是一个快速修复！

            回答 #3

赞同：0

时间：2009-05-29T17:54:46.110

我没有具体的答案，但我一直在努力解决 IE 和 FF 之间的差异，因为它与边距和填充有关。

您可能需要明确地放入文档类型标签。特别是严格模式。这应该让他们强制他们进入相同的布局模型。从那里开始，你正在处理一门艺术而不是一门科学。

祝你好运。

        iphone - 查询iphone可用存储空间

ID：927268

赞同：4

时间：2009-05-29T17:50:16.257

标签：iphone, objective-c, cocoa-touch

是否可以使用 iphone sdk 确定 iphone 上剩余多少可用存储空间？我想根据实际剩余的空间来调整缓存大小。

            回答 #1

赞同：3

时间：2009-05-29T17:56:26.433

是的你可以。这是一个示例：[Mac/iPhone：显示可用的可用磁盘空间](http://kdbdallas.com/2008/12/27/maciphone-show-availble-useable-diskspace/)。它们还提供了一个您可以插入的类，但其中很多只是格式化结果。

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
struct statfs tStats;
statfs([[paths lastObject] cString], &tStats);
availableDisk = (float)(tStats.f_bavail * tStats.f_bsize); 
```

            回答 #2

赞同：1

时间：2011-10-03T00:32:50.707

错误检查...

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
struct statfs tStats;
float availableDisk = 0;
if (statfs([[paths lastObject] cString], &tStats) != -1)
    availableDisk = (float)(tStats.f_bavail * tStats.f_bsize); 
```

        ms-access - 自动填充组合框

ID：927273

赞同：1

时间：2009-05-29T17:51:21.967

标签：ms-access, combobox, auto-populate

我又来了。我的表单上有 3 个组合框，即 cmbPart_number、cmbPart_name 和 cmbEOnumber。

我只想知道当用户从 cmbPart_number 中进行选择时，如何自动填充 cmbPart_name 和 cmbEO_number 框。到目前为止，我尝试的是在行源 SQL 查询和 cmbpart_name 的控制源中添加 part_name 和 EO_number 我尝试过 cmbpart_name(value)=cmbpart_number.column(1)

对此的任何帮助都非常感谢

            回答 #1

赞同：3

时间：2009-05-29T18:00:54.240

您应该可以通过在 AfterUpdate 事件中设置 RowSource 来做到这一点

```
Private Sub cmbPart_number_AfterUpdate()

   cmbPart_name.RowSource = "...WHERE [PartNumber] = '" & _
                                                   cmbPart_number.value & "'; "
   cmbPart_name.Requery

End Sub 
```

[这是在 Access 中实现级联组合框的](http://www.fontstuff.com/access/acctut10.htm)不同方法的演练

            回答 #2

赞同：0

时间：2009-05-29T19:42:32.287

我知道必须有一种简单的方法来做到这一点，而无需深入研究 VB。我的第一个组合框，即 cmbPart_number，我进行了如下修改 - 行源在 SQL 查询中具有所有 3 个字段，即 SELECT part_number、part_name、EO_number from parts ORDER BY...；我已将列数修改为 2，因为 Access 始终将表中的第一列计为数字 0。因此，所有 3 个字段的列 0,1 和 2。我的列宽是 1";0"

接下来我将 cmbPart_name 的控制源修改为 =cmbpart_number.column(1)。它的行源有一个 SELECT 语句 SELECT part_number, part_name FROM parts, ORDER BY... Column Count is 1 and Column Width is 0";1"

最后对于 cmbEO_number，控制源是 =cmbpart_number.column(2)。行源选择语句为 SELECT part_number, EO_number FROM parts ORDER BY...列数为 1 列宽为 0";1"

现在可以正常工作，并且在 cmbPart_number 框中选择的任何条目都会自动填充其他 2。谢谢大家的帮助。

        algorithm - 为什么在 Adler-32 校验和算法中取模 65521？

ID：927277

赞同：17

时间：2009-05-29T17:52:15.193

标签：algorithm, math, checksum, adler32

Adler-32 校验和算法以 65521 为模求和。我知道 65521 是适合 16 位的最大素数，但为什么在该算法中使用素数很重要？

[（我敢肯定，一旦有人告诉我，答案似乎很明显，但我大脑中的数论部分无法正常工作。即使没有校验和算法方面的专业知识，也是一个阅读http://en.wikipedia](http://en.wikipedia.org/wiki/Fletcher%27s_checksum)的聪明人。 [org/wiki/Fletcher%27s_checksum](http://en.wikipedia.org/wiki/Fletcher%27s_checksum)可能可以向我解释。）

            回答 #1

赞同：20

时间：2009-06-09T02:52:29.287

**为什么 Adler32 使用 mod prime？**
来自 Adler 自己的网站[http://zlib.net/zlib_tech.html](http://zlib.net/zlib_tech.html)

然而，Adler-32 已被构建为通过使用显着大于字节的总和以及使用素数 (65521) 作为模数，最大限度地减少对数据进行微小更改而导致相同校验值的方法。**正是在这方面，值得进行一些分析，但尚未完成。**

Adler-32 的主要原因当然是软件实现的速度。

Adler-32 的替代方案是 Fletcher-32，它将 65521 的模替换为 65535。本文表明 Fletcher-32 对于低速率随机误码的信道具有优势。

使用它是因为素数往往具有更好的混合特性。到底有多好还有待商榷。
**其他说明**
该线程中的其他人提出了一个有些令人信服的论点，即模数素数更适合检测位交换。但是，这很可能**不是这种情况**，因为位交换极为罕见。两个最普遍的错误是：

1.  随处可见的随机位翻转 (1 <-> 0)。
2.  网络中常见的位移（1 2 3 4 5 -> 2 3 4 5 或 1 1 2 3 4 5）

那里的大多数位交换是由碰巧看起来像位交换的随机位翻转引起的。
事实上，纠错码被设计成能承受 n 位的偏差。来自阿德勒的网站：

正确构造的 CRC-n 具有很好的特性，即始终可以检测到少于 n 位的错误。Adler-32 并非总是如此——它可以检测到所有一字节或两字节错误，但可能会漏掉一些三字节错误。

**使用素数模数的有效性**
我对基本相同的问题做了很长的文章。为什么要对素数取模？
[http://www.codexon.com/posts/hash-functions-the-modulo-prime-myth](http://www.codexon.com/posts/hash-functions-the-modulo-prime-myth)
**简短的回答**
我们对素数的了解远少于合数。因此，像 Knuth 这样的人开始使用它们。
虽然素数与我们散列的大部分数据的关系可能确实较少，但增加表/模大小也会降低冲突的可能性（有时比四舍五入到最接近的素数所获得的任何好处都多）。
这是每个桶的冲突[图，其中包含 1000 万个加密随机整数，比较 mod 65521 与 65535。](https://web.archive.org/web/20090619095900/http://www.codexon.com/wp-content/uploads/2009/06/hash.png)

            回答 #2

赞同：4

时间：2009-06-09T03:39:57.783

Adler-32 算法是计算

```
A = 1 + b1 + b2 + b3 + ... 
```

和

```
B = (1 + b1) + (1 + b1 + b2) + (1 + b1 + b2 + b3) + ... = 1 + b1 + 2 * b2 + 3 * b3 + ... 
```

并以 m 为模报告它们。当 m 是素数时，以 m 为模的数字形成数学家所说的*域*。域有一个方便的性质，即对于任何非零 c，我们有 a = b 当且仅当 c * a = c * b。比较时间表模 6（不是素数）与时间表模 5（即：

```
* 0 1 2 3 4 5
0 0 0 0 0 0 0
1 0 1 2 3 4 5
2 0 2 4 0 2 4
3 0 3 0 3 0 3
4 0 4 2 0 4 2
5 0 5 4 3 2 1

* 0 1 2 3 4
0 0 0 0 0 0
1 0 1 2 3 4
2 0 2 4 1 3
3 0 3 1 4 2
4 0 4 3 2 1 
```

现在，每当我们交换两个字节时，A 部分就会被愚弄——加法毕竟是可交换的。B 部分应该检测这种错误，但是当 m 不是素数时，更多的位置容易受到攻击。考虑一个 Adler 校验和 mod 6

```
1 3 2 0 0 4 
```

我们有 A = 4 和 B = 1。现在考虑交换 b2 和 b4：

```
1 0 2 3 0 4 
```

A 和 B 不变，因为 2 * 3 = 4 * 0 = 2 * 0 = 4 * 3（模 6）。也可以将 2 和 5 交换为相同的效果。这更有可能在时间表不平衡时（模 5）检测到这些变化。事实上，唯一一次质数模数无法检测到单个交换是两个相等的索引 mod m 交换时（如果 m 很大，它们必须相距很远！）。^ 这个逻辑也可以应用于交换的子字符串。

使用较小模数的缺点是它在随机数据上失败的频率会稍高一些；然而，在现实世界中，腐败很少是随机的。

^ 证明：假设我们用值 a 和 b 交换索引 i 和 j。那么 a *i + b* j = a *j + b* i，所以 a *i - a* j + b *j - b* i = 0 且 (a - b)*(i - j) = 0。由于域是一个积分域，它遵循 a = b（值是全等的）或 i = j（索引是全等的）。

编辑：Unknown 链接到的网站 ( [http://www.zlib.net/zlib_tech.html](http://www.zlib.net/zlib_tech.html) ) 清楚地表明 Adler-32 的设计根本没有原则。由于 DEFLATE 流中的 Huffman 代码，即使是小的错误也可能会改变帧（因为它依赖于数据）并导致输出中的大错误。考虑这个答案是一个稍微人为的例子，说明为什么人们将某些属性归因于素数。

            回答 #3

赞同：3

时间：2009-05-29T18:42:17.277

长话短说：

素数的模具有最好的位混洗特性，这正是我们想要的哈希值。  

            回答 #4

赞同：1

时间：2009-06-09T19:13:13.477

对于完全随机的数据，桶越多越好。

假设数据在某种程度上是非随机的。现在，非随机性可能影响算法的唯一方法是创建一种情况，即某些存储桶比其他存储桶被使用的概率更高。

如果模数不是素数，则影响构成模数之一的任何模式都可能影响散列。因此，如果您使用 15，则每 3 或 5 次以及每 15 次的模式可能会导致冲突，而如果您使用 13，则模式必须每 13 次才会导致冲突。

65535 = 3*5*17*257，因此涉及 3 或 5 的模式可能会使用此模数导致冲突——例如，如果由于某种原因 3 的倍数更常见，那么只有 3 的倍数的桶才会善用。

现在我不确定这是否真的会成为一个问题。使用想要散列的类型的实际数据而不是随机数凭经验确定冲突率会很好。（例如，涉及 http://en.wikipedia.org/wiki/Benford's_law">本福德定律或某些此类不规则性的数值数据是否会导致影响该算法的模式？如何将 ASCII 代码用于现实文本？）

            回答 #5

赞同：0

时间：2011-08-26T17:32:23.333

校验和通常用于检测两件事不同，尤其是在两件事在同一时间和地点不可用的情况下。它们可能在不同的地方可用（例如，发送的信息包与接收的信息包）或不同的时间（例如，存储时的信息块，与回读时的信息块） . 在某些情况下，可能需要检查两个独立存储在两个不同位置的东西是否可能匹配，而不必将实际数据从一个设备发送到另一个设备（例如比较加载的代码图像或配置）。

如果被比较的事物不匹配的唯一原因是其中之一的随机损坏，那么对 Adler-32 校验和使用素数模数可能不是特别有用。但是，如果其中一件事可能对其进行了一些“故意”更改，则使用非素数模数可能会导致某些更改被忽视。例如，将一个字节从 00 更改为 FF，并将另一个早于或晚于 257 个字节的倍数的另一个字节从 FF 更改为 00，在使用 Fletcher 校验和时会抵消，但在使用 Adler-32 校验和时不会。随机损坏不太可能发生这种情况，但是在更改程序时可能会发生这种抵消变化。他们不太可能

            回答 #6

赞同：0

时间：2013-11-26T08:00:21.673

答案在于场论。具有运算加和时间的集合 Z/Z_n 是当 n 是素数时的字段（即，模数为 n 的加法和乘法）。

换句话说，以下等式：

```
m * x = (in Z/Z_n) 
```

对于 m 的任何值（即 x = 0）只有一个解

考虑这个例子：

```
2 * x = 0 (mod 10) 
```

这个方程有两个解，x = 0 和 x = 5。那是因为 10 不是素数，可以写成 2 * 5。

此属性负责更好地分布散列值。

        python - 如何解析python的windows inf文件？

ID：927279

赞同：3

时间：2009-05-29T17:52:31.340

标签：python, windows, parsing, file, drivers

请帮我。示例 inf 文件：

```
;=============================================================================
;
; Copyright (c) Intel Corporation (2002).
;
; INTEL MAKES NO WARRANTY OF ANY KIND REGARDING THE CODE.  THIS CODE IS
; LICENSED ON AN "AS IS" BASIS AND INTEL WILL NOT PROVIDE ANY SUPPORT,
; ASSISTANCE, INSTALLATION, TRAINING OR OTHER SERVICES.  INTEL DOES NOT
; PROVIDE ANY UPDATES, ENHANCEMENTS OR EXTENSIONS.  INTEL SPECIFICALLY
; DISCLAIMS ANY WARRANTY OF MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR ANY
; PARTICULAR PURPOSE, OR ANY OTHER WARRANTY.  Intel disclaims all liability,
; including liability for infringement of any proprietary rights, relating to
; use of the code. No license, express or implied, by estoppel or otherwise,
; to any intellectual property rights is granted herein.
;
;=============================================================================

; Installation inf for the Intel Corporation graphics adapter.

[Version]
Signature="$WINDOWS NT$"
Provider=%Intel%
ClassGUID={4D36E968-E325-11CE-BFC1-08002BE10318}
Class=Display
CatalogFile=i830mnt5.cat

DriverVer=08/20/2004,6.14.10.3889

[DestinationDirs]
DefaultDestDir   = 11
ialm.Miniport  = 12  ; drivers
ialm.Display   = 11  ; system32
Help.Copy = 11
CUI.Copy = 11
Uninstall_Copy = 11

OpenGL.Copy    = 11  ; OpenGL Drivers in System32

;
; Driver information
;

[Manufacturer]
%Intel%   = Intel.Mfg

[Intel.Mfg]
;830
;%i830M% = i830M, PCI\VEN_8086&DEV_3577
%i830M% = i830M, PCI\VEN_8086&DEV_3577&SUBSYS_00C81028
%i830M% = i830M, PCI\VEN_8086&DEV_3577&SUBSYS_01221028
%i830M% = i830M, PCI\VEN_8086&DEV_3577&SUBSYS_00B81028
%i830M% = i830M, PCI\VEN_8086&DEV_3577&SUBSYS_00B91028
%i830M% = i830M, PCI\VEN_8086&DEV_3577&SUBSYS_00F51028

;845
;%iBKDG% = i845G, PCI\VEN_8086&DEV_2562
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_013D1028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01471028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_03011028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_013A1028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01481028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01381028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01261028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01271028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01331028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_014B1028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01601028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01611028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01291028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_01461028
%iBKDG% = i845G, PCI\VEN_8086&DEV_2562&SUBSYS_03031028

;845GM
%iBKDGM% = i845GM, PCI\VEN_8086&DEV_2562&SUBSYS_01491028 
```

如何解析和格式化“%iBKDGM% = i845GM, PCI\VEN_8086&DEV_2562&SUBSYS_01491028”这一行？

            回答 #1

赞同：10

时间：2009-05-29T17:57:35.400

你可以试试内置的 ConfigParser

[http://docs.python.org/library/configparser.html](http://docs.python.org/library/configparser.html)

以及 ConfigObj

[http://code.google.com/p/configobj/](http://code.google.com/p/configobj/)

两者都声称能够处理 Windows INI 文件。

        wpf - 为什么 VS.NET 尝试为 WPF 和 ClickOnce 包含 Microsoft.Windows.Design.Extensibility？

ID：927282

赞同：4

时间：2009-05-29T17:54:00.103

标签：wpf, clickonce

我使用 ClickOnce 部署在 VS.NET 2008 中构建了一个 WPF 应用程序。它在任何安装了 VS.NET 的机器上运行良好，但我的业务用户收到错误：“无法安装或运行该应用程序。该应用程序要求在首先是全局程序集缓存 (GAC)。”

我惊讶地发现这个 dll 不是标准 .NET 3.5 SP1 客户端安装的一部分，但不知何故，我的应用程序认为它是必需的。我检查了项目的“发布”选项卡，它显示为先决条件。

奇怪的是，我能够删除这个（以及所有其他 Microsoft.Windows.Design.* dll）并且它在任何地方都可以正常工作。我将它们完全从我的项目中删除，一切都很好。

有人可以解释为什么 VS.NET 2008 项目向导强制将这些包含在项目中，更重要的是，为什么 ClickOnce 认为它们需要在客户端计算机上运行？

这只是一个好奇的问题，但我相信我不是第一个被它咬的。希望这篇文章至少可以避免其他人的头痛。

            回答 #1

赞同：6

时间：2011-03-02T11:57:26.523

尝试删除对 *.Design.dll 的所有引用。就我而言，它是 WPFToolkit.Design.dll。

            回答 #2

赞同：3

时间：2010-08-23T18:08:27.877

这是旧的并且 OP 已经消失了，但是我今天遇到了这个问题，所以我想我会提到我的解决方案是删除对 WPFToolkit 引用之一的引用，该引用以`.Design`.

我引用了`System.Windows.Controls.Input.Toolkit`，但也引用了`System.Windows.Controls.Input.Toolkit.Design`，它不应该存在。删除它，世界又恢复了正常。

            回答 #3

赞同：1

时间：2010-05-26T21:43:54.890

此处解释了一种查找正在加载程序集的代码的方法：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/755272f6-0e79-4a6d-ae50-4412d0f2bc4c](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/755272f6-0e79-4a6d-ae50-4412d0f2bc4c)

            回答 #4

赞同：0

时间：2009-07-31T00:06:56.127

我发现我正在使用 Microsoft.Windows.Design.Extensibility Version dll 内的 Microsoft.Windows.Design.Interaction 命名空间内的 SelectionCommands.Clear 属性。

Beats 是 .NET 3.5 安装中不包含此 dll 的原因。

        html - 窄换行符

ID：927294

赞同：0

时间：2009-05-29T17:56:08.493

标签：html, css

有没有比这更有效的方法

```
<div style="height: 6px;"></div> 
```

进行“窄”换行？即比

```
text text text<br/><br/> 
```

??

            回答 #1

赞同：7

时间：2009-05-29T17:57:57.193

采用

```
margin-bottom : 6px; 
```

在所需中断上方的元素上。所以，像

```
<p style="margin-bottom : 6px;">
    text text text
</p> 
```

            回答 #2

赞同：0

时间：2011-04-29T13:31:18.250

我认为最好的方法是整理边距，所以继续输入：

```
margin-bottom:6px;

<p style="margin-bottom:6px;">
     Whatever text you want </p> 
```

祝你好运！

        javascript - 如何通过javascript将css类附加到元素？

ID：927312

赞同：51

时间：2009-05-29T17:58:23.510

标签：javascript, css

假设一个 HTML 元素`id`是已知的，那么可以使用以下方法引用该元素：

```
document.getElementById(element_id); 
```

是否存在可用于将 CSS 类附加到该元素的本机 Javascript 函数？

            回答 #1

赞同：93

时间：2009-05-29T17:59:41.293

```
var element = document.getElementById(element_id);
element.className += " " + newClassName; 
```

瞧。这几乎适用于所有浏览器。前导空格很重要，因为该`className`属性将 css 类视为单个字符串，它应该与`class`HTML 元素上的属性匹配（其中多个类必须用空格分隔）。

顺便说一句，您最好使用像[原型](http://www.prototypejs.org/)或[jQuery](http://jquery.com/)这样的 Javascript 库，它们具有执行此操作的方法，以及可以首先检查元素是否已经分配了类的函数。

例如在原型中：

```
// Prototype automatically checks that the element doesn't already have the class
$(element_id).addClassName(newClassName); 
```

看看有多好？！

            回答 #2

赞同：27

时间：2018-08-28T07:37:08.670

使用元素的[classList](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList)属性添加类：

```
element.classList.add('my-class-name'); 
```

删除：

```
element.classList.remove('my-class-name'); 
```

            回答 #3

赞同：10

时间：2014-02-04T12:21:08.913

**classList**是访问元素的类列表的便捷替代方法。请参阅[http://developer.mozilla.org/en-US/docs/Web/API/Element.classList](http://developer.mozilla.org/en-US/docs/Web/API/Element.classList)。

IE < 10 不支持

            回答 #4

赞同：3

时间：2009-05-29T20:47:10.270

当一个元素已经定义了一个类名时，它对元素的影响取决于它在类名字符串中的位置。如果有冲突，后面的类会覆盖前面的类。

将类添加到元素应该将类名移动到列表的尖端，如果它已经存在的话。

```
document.addClass= function(el, css){
    var tem, C= el.className.split(/\s+/), A=[];    
    while(C.length){
        tem= C.shift();
        if(tem && tem!= css) A[A.length]= tem;
    }
    A[A.length]= css;
    return el.className= A.join(' ');   
} 
```

            回答 #5

赞同：2

时间：2009-05-29T18:00:10.793

您应该能够设置元素的 className 属性。你可以做一个 += 来追加它。

            回答 #6

赞同：0

时间：2016-09-02T14:45:31.097

```
addClass=(selector,classes)=>document.querySelector(selector).classList(...classes.split(' ')); 
```

这将添加一个类或多个类：

```
addClass('#myDiv','back-red'); // => Add "back-red" class to <div id="myDiv"/>
addClass('#myDiv','fa fa-car') //=>Add two classes to "div" 
```

            回答 #7

赞同：-1

时间：2018-04-14T15:17:15.300

你可以使用`setAttribute`.

示例：添加一个类：

```
 document.getElementById('main').setAttribute("class","classOne"); 
```

对于多个类：

```
 document.getElementById('main').setAttribute("class", "classOne classTwo"); 
```

        xml - StringBuilder 和 XML 文字的问题

ID：927317

赞同：0

时间：2009-05-29T17:59:58.453

标签：xml, vb.net, visual-studio-2008, stringbuilder, literals

我在 VB 2008 中使用带有 StringBuilder 的 XML 文字时遇到问题。如果我使用此代码，一切都很好。

```
Dim html As New System.Text.StringBuilder

html.Append(<html><body></body></html>)

MsgBox("hello") 
```

现在的问题是我想将 HTML 包装在代码中生成的东西上。

```
html.Append(<html><body>)

msgbox("nothing happens") 
```

当 HTML 没有相应的结束标记时，它的行为就像超出 ) 并继续寻找它。

我在这里做错了什么吗？

            回答 #1

赞同：2

时间：2009-05-29T18:18:58.587

我从未使用过 VB 的 XML 文字，但我已经建立了很多 XML。我喜欢使用 StringWriter/XMLTextWriter 类：

```
StringBuilder sb = new StringBuilder();
using (StringWriter sw = new StringWriter(sb))
{
    XmlTextWriter xw = new XmlTextWriter(sw);
    xw.WriteStartElement("html");
    xw.WriteStartElement("body");
    xw.WriteRaw(contentExp);
    ...
    wr.WriteEndElement();   // body
    wr.WriteEndElement();   // html
}
// do something with sb.ToString()? 
```

            回答 #2

赞同：1

时间：2009-05-29T18:11:20.897

明显的预感是 XML 文字需要格式良好的 XML。如果您想包装东西，请放入嵌入式表达式，如...

```
html.Append(<html><body><%= contentExp %></body></html>) 
```

            回答 #3

赞同：1

时间：2009-05-29T18:35:20.737

因为您没有在 XML Literal 语句中形成正确的 XML（在您的情况下，您没有关闭标签），所以您不能在此处使用 XML Literal。您要么需要让您的 XML 文字是正确的 XML，要么将您的代码转换为将它们用作字符串。因此：

```
html.Append("<html><body>")

msgbox("nothing happens") 
```

            回答 #4

赞同：1

时间：2009-05-29T18:51:24.963

不是答案，而是向你提问。将 XML Literals 与字符串生成器一起使用会有什么价值。至少在我看来，这有悖常理。使用文字创建 XML，然后如果需要字符串，只需使用 .ToString() 方法调用获取其字符串表示。

        c# - 单击控件并使其着色

ID：927321

赞同：2

时间：2009-05-29T18:00:39.153

标签：c#, .net, winforms, windows-themes

在 Windows 中，当您单击桌面上的图标时，该图标会变暗，并带有基于您当前使用的 Windows 主题的阴影。

我有一个显示图像的自定义控件。我希望具有与单击 Windows 图标相同的功能。如何通过选择我的自定义控件在 WinForms 中获得相同的结果？

            回答 #1

赞同：1

时间：2009-06-20T19:48:32.853

自 Windows XP 以来，Windows 为选定的图标实现了 alpha 混合。如果您想获得类似的外观，您必须使用 alpha 混合绘制图像：

```
public static void DrawBlendImage(Graphics canvas, Image source, Color blendColor, float blendLevel, int x, int y)
{
  Rectangle SourceBounds = new Rectangle(x, y, source.Width, source.Height);

  ColorMatrix MaskMatrix = new ColorMatrix();
  MaskMatrix.Matrix00 = 0f;
  MaskMatrix.Matrix11 = 0f;
  MaskMatrix.Matrix22 = 0f;
  MaskMatrix.Matrix40 = (float)blendColor.R / byte.MaxValue;
  MaskMatrix.Matrix41 = (float)blendColor.G / byte.MaxValue;
  MaskMatrix.Matrix42 = (float)blendColor.B / byte.MaxValue;
  ImageAttributes MaskAttributes = new ImageAttributes();
  MaskAttributes.SetColorMatrix(MaskMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap);

  ColorMatrix TransparentMatrix = new ColorMatrix();
  TransparentMatrix.Matrix33 = blendLevel;
  ImageAttributes TransparentAttributes = new ImageAttributes();
  TransparentAttributes.SetColorMatrix(TransparentMatrix, ColorMatrixFlag.Default, ColorAdjustType.Bitmap);

  canvas.DrawImage(source, SourceBounds, 0, 0, source.Width, source.Height, GraphicsUnit.Pixel, MaskAttributes);
  canvas.DrawImage(source, SourceBounds, 0, 0, source.Width, source.Height, GraphicsUnit.Pixel, TransparentAttributes);
} 
```

在您的情况下，您可以使用**SystemColors.Highlight**作为 blendColor。

            回答 #2

赞同：0

时间：2009-05-29T18:52:56.723

您可以使用[System.Drawing.KnownColor](http://msdn.microsoft.com/en-us/library/system.drawing.knowncolor.aspx)为用户的主题获取正确的颜色。

            回答 #3

赞同：0

时间：2009-07-07T18:58:06.290

现在我正在使用以下代码......如果有人有更好的东西，我会很高兴改变它！

```
 private void drawAndShadeTheImage(Graphics g)
  {
     //if the image is null then there is nothing to do.
     if (Image != null)
     {
        Bitmap bitMap = new Bitmap(Image);

        //if this control is selected, shade the image to allow the user to
        //visual identify what is selected.
        if (ContainsFocus)
        {               
           //The delta is the percentage of change in color shading of 
           //the image.
           int delta = 70;

           //zero is the lowest value (0 - 255) that can be represented by
           //a color component.
           int zero = 0;

           //Get each pixel in the image and shade it.
           for (int y = 0; y < bitMap.Height; y++)
           {
              for (int x = 0; x < bitMap.Width; x++)
              {
                 Color oColor = bitMap.GetPixel(x, y);

                 //Lime is the background color on the image and should
                 //always be transparent, if this check is removed the
                 //background will be displayed.
                 if (oColor.ToArgb() != Color.Lime.ToArgb())
                 {
                    int oR = oColor.R - delta < zero ? zero : 
                       oColor.R - delta;
                    int oG = oColor.G - delta < zero ? zero : 
                       oColor.G - delta;
                    int oB = oColor.B - delta < zero ? zero : 
                       oColor.B - delta;
                    int oA = oColor.A - delta < zero ? zero : 
                       oColor.A - delta;

                    Color nColor = Color.FromArgb(oA, oR, oG, oB);

                    bitMap.SetPixel(x, y, nColor);
                 }
              }
           }
        }

        //Make the background of the image transparent.
        bitMap.MakeTransparent();

        g.DrawImage(bitMap, this.ClientRectangle);            
     }
  } 
```

        c# - 理想情况下，应用程序日志应该包含什么？

ID：927328

赞同：4

时间：2009-05-29T18:02:07.933

标签：c#

理想情况下，应用程序日志应包含哪些信息？它与错误日志有何不同？

            回答 #1

赞同：3

时间：2009-05-29T18:11:20.367

对于这个问题，你会得到很多不同的意见......

最终，它应该包含您认为与您的应用程序相关的任何信息。它还应该包含有助于您确定应用程序正在发生什么的信息。这并不是说它应该包含错误，但是如果您想以这种方式使用它，则可以。

我建议您至少包括：

*   应用程序开始/停止时间    
*   应用名称
*   通过/失败信息（如果适用）

可选项目是：

*   呼叫处理（如果不是太密集）
*   如果您决定合并应用程序和错误日志，则会出现错误
*   消息传递（如果不是太密集）

您要记住的一件事是，您不希望将太多信息写入日志以影响应用程序性能。此外，要确保您的日志文件不会变得太大而导致磁盘空间不足。

            回答 #2

赞同：2

时间：2009-05-29T18:12:20.660

一个真正的错误日志应该真正包含：

*   错误发生位置的堆栈跟踪
*   出现在错误点的局部变量。
*   错误发生时间的时间戳。
*   抛出异常的详细信息（如果是异常）。

用于跟踪事件等的通用应用程序日志文件应该包含较少的内部信息，并且可能对用户更友好。

老实说，答案实际上取决于日志用于什么软件。

            回答 #3

赞同：2

时间：2009-05-29T18:12:50.097

理想情况下，它应该包含诊断应用程序问题或分析其过去行为的特定方面所需的准确信息。唯一让这件事变得困难的是，您事先不知道究竟会发生什么问题，或者您将来会对应用程序行为的哪些方面感兴趣。您无法记录应用程序状态的每一次更改，但您必须记录足够多的日志。多少才够？这很难说并且非常依赖于应用程序。我怀疑桌面计算器会记录任何内容。

错误日志只会记录发生的任何错误。意外异常和其他意外情况。

            回答 #4

赞同：1

时间：2009-05-29T18:09:07.157

与通常仅包含错误和严重警告的错误日志不同，应用程序日志通常包含错误、警告、事件和非关键信息。

            回答 #5

赞同：1

时间：2009-05-29T18:09:52.117

应用程序日志应包含审计所需的所有信息。这可能包括成功/不成功的登录和任何特定操作等。错误日志可以是应用程序日志的子集，也可以是仅包含与应用程序中的错误相关的信息的单独日志。

        sql - 为什么我们关心数据类型？

ID：927331

赞同：15

时间：2009-05-29T18:02:39.790

标签：sql, database, theory

具体来说，在关系数据库管理系统中，为什么我们需要在创建时知道列的数据类型（更有可能是对象的属性）？

对我来说，数据类型感觉像是一种优化，因为一个数据点可以通过多种方式实现。将语义角色和约束分配给数据点，然后让引擎在内部检查和优化哪种数据类型最适合用户，不是更好吗？

我怀疑这就是繁重的工作所在，以及为什么只询问用户而不是做工作更容易。

你怎么看？我们将走向何方？这是一个现实的期望吗？还是我有一个错误的假设？

            回答 #1

赞同：30

时间：2009-05-29T18:05:58.347

该类型表示对列值的期望约束。

            回答 #2

赞同：16

时间：2009-05-29T18:06:31.357

答案是存储空间和固定大小的行。

固定大小的行比可变长度的行搜索要快得多，因为如果您知道您想要哪个记录号和字段，您可以直接查找正确的字节。

编辑：话虽如此，如果您在数据库表中使用正确的索引，那么固定大小的行就不像以前那么重要了。

            回答 #3

赞同：11

时间：2009-05-29T18:06:56.363

**SQLite**不在乎。

其他**RDBMS**的使用原则是在**80**年代初设计的，当时它对性能至关重要。

**例如， Oracle**不区分 a`NULL`和空字符串，并将其`NUMBER`'s 保留为百分位数的集合。

这在今天几乎没有意义，但在开发**Oracle**时，这些都是非常聪明的解决方案。

但是，在我开发的一个数据库中，使用了非索引值，这些值存储为`VARCHAR2`'，根据几个条件动态转换为适当的数据类型。

不过，这是一件非常特别的事情：它用于在一次使用集合的数据库调用中批量加载键值对。

动态`SQL`语句用于解析数据并根据键名将它们放入适当的表中。

所有值都按原样加载到临时`VARCHAR2`列，然后转换为`NUMBER`'s 和`DATETIME`'s 放入它们的列中。

            回答 #4

赞同：10

时间：2009-05-29T18:08:30.230

显式数据类型对于效率和存储非常重要。如果它们是隐含的，则必须“弄清楚”它们，因此会产生速度成本。索引也很难实现。

我会怀疑，虽然不是肯定的，但具有显式类型平均也会产生更少的存储空间。特别是对于数字，二进制 int 和一串数字字符之间没有比较。

            回答 #5

赞同：6

时间：2009-05-29T18:15:42.620

嗯......你的问题有点令人困惑。

如果我理解正确，您会问我们为什么要为表列指定数据类型，以及为什么“引擎”会自动确定用户需要什么。

数据类型充当约束——它们保护数据的完整性。int 列中永远不会有字母，这是一件好事。数据类型不会自动为您决定，您在创建数据库时指定它 - 几乎总是使用 SQL。

            回答 #6

赞同：4

时间：2009-05-31T08:23:02.587

你是对的：为列分配数据类型是一个实现细节，与数据库引擎背后的集合论或微积分无关。作为一个理论模型，数据库应该是“无类型的”并且能够存储我们扔给它的任何东西。

但是我们必须在具有实际约束的真实计算机上实现数据库。从性能的角度来看，让计算机动态地尝试找出如何最好地存储数据是不切实际的。

例如，假设您有一个表，其中存储了几百万个整数。计算机可以正确地计算出它应该将每个数据存储为一个整数值。但是如果有一天你突然尝试在那个表中存储一个字符串，数据库引擎是否应该停止一切，直到将所有数据转换为更通用的字符串格式？

不幸的是，指定数据类型是必要的。

            回答 #7

赞同：3

时间：2009-05-31T19:27:47.343

如果您知道某些数据项应该是数字整数，并且您故意选择不让 DBMS 执行此操作，那么您有责任确保诸如数据完整性之类的各种事情（确保没有 value '列中可以输入A，保证列中不能输入值1.5），例如系统行为的一致性（保证值'01'被认为等于值'1'，不是您从 String 类型获得的行为），...

类型会为您处理所有这些事情。

            回答 #8

赞同：2

时间：2009-05-29T18:07:38.593

我不确定数据库中数据类型的历史，但对我来说，了解字段的数据类型是有意义的。

你什么时候想对一些完全是 varchar 的字段求和？如果我知道一个字段是一个整数，那么做一个 sum、avg、max 等是非常有意义的。

            回答 #9

赞同：2

时间：2009-05-29T18:16:23.070

并非所有数据库都以这种方式工作。前面提到过 SQLite，但一组更老的数据库也可以做到这一点，多值数据库。

考虑 UniVerse（现在是 IBM 的财产）。它不进行任何数据验证，也不要求您指定它是什么类型。搜索仍然（相对）快，它占用的空间更少（由于它动态存储数据的方式）。

您可以使用元数据（字典项）来描述数据的外观，但这是您限制数据的限制。

请参阅有关[UniVerse的维基百科文章](http://en.wikipedia.org/wiki/UniVerse "宇宙")

            回答 #10

赞同：2

时间：2009-05-29T18:52:16.257

当您在上线后的 5 个月内推送 50 亿行时，每个字节都很重要（在我们的系统中）

数据库设计中没有“过早优化”这样的反模式。

磁盘空间当然很便宜，但是您使用的是内存中的数据。

            回答 #11

赞同：1

时间：2009-05-29T18:12:43.217

当涉及到过滤（WHERE 子句）或排序（ORDER BY）时，您应该关心数据类型。例如，如果这些值是字符串，则“200”低于“3”，而当它们是整数时则相反。

我相信迟早您将不得不对数据进行排序或过滤（“200”>“3”？）或在报告中使用一些聚合函数（如 sum() 或 (avg()）。在此之前，您对文本很熟悉数据类型 ：）

            回答 #12

赞同：1

时间：2009-05-31T21:51:53.433

我一直在阅读的一本关于数据库理论的书告诉我，SQL 标准定义了一个*域*的概念。例如，高度和宽度可能是两个不同的域。尽管两者都可以存储为 numeric(10,2)，但如果不进行强制转换，就无法比较高度和宽度列。这允许与实现无关的“类型”约束。

不过，总的来说，我喜欢这个想法，因为我从未见过它实现，所以我不知道使用它会是什么样子。我可以看到，当它们的概念域完全不同时，它会减少使用实现恰好相同的值时出错的机会。例如，它还可能有助于防止人们比较厘米和英寸。

            回答 #13

赞同：1

时间：2009-06-04T12:28:57.043

约束可能是这里提到的最重要的事情。存在数据类型以确保数据的正确性，因此您可以确定可以正确操作它。有两种方法可以存储日期。在日期类型或字符串“1893 年 1 月 4 日”中。但该字符串也可能是“4/1 1893”、“1/4 1893”或类似的。数据类型对此进行了约束并定义了日期的规范形式。

此外，数据类型具有可以接受检查的优点。字符串“1975 年 2 月 0 日”被接受为字符串，但不应作为日期。“1983 年 2 月 30 日”怎么样？糟糕的数据库，如 MySQL，默认情况下不会进行这些检查（尽管您可以配置 MySQL 来执行此操作——而且您应该这样做！）。

数据类型将确保您的数据的一致性。这是最重要的概念之一，因为保持数据健全将使您免于精神错乱。

            回答 #14

赞同：0

时间：2009-05-31T22:04:01.693

RDBM 通常需要定义列类型，以便快速执行查找。如果你想在一个巨大的数据集中获得每一行的第 5 列，那么定义列是一个巨大的优化。

RDBMs 可以只在 sizeOf(column1 - 4(bytes)) + sizeOf(column5(bytes)) 处获取项目，而不是扫描每一行以查找某种形式的分隔符来检索第 5 列（如果列宽不是固定宽度） . 想象一下这在一个有 10,000,000 行的表上会快多少。

或者，如果您不想指定每列的类型，您有两个我知道的选项。将每一列指定为 varchar(255) 并决定在调用程序中要对它执行什么操作。或者，您可以使用其他使用键值对的数据库系统，例如[Redis](http://antoniocangiano.com/2009/03/11/introducing-redis-a-key-value-database/)。

            回答 #15

赞同：-2

时间：2009-05-29T18:05:41.953

数据库是关于物理存储的，数据类型定义这个！！！

        bash - 在 Bash 中混合单引号和双引号

ID：927332

赞同：0

时间：2009-05-29T18:04:10.927

标签：bash, scripting, syntax, arguments

好的，我有一个脚本，它接受一些参数，运行数据，然后将数据同步到不同的服务器。问题是要运行数据，我必须采用其中一个参数，然后使用它运行报告，这对 bash 非常不友好（例如 [3023.2<>1]、[5111.3$]="5" 等）。  

因此，如果我要运行该命令，我需要将参数放在单引号中，这样就不会将参数拉入其中。  

因此，如果我要运行脚本...

```
arg1 = [5111.3$]="5"

runjob specfile.spx '$arg1' 
```

这是行不通的，但如果我用双引号运行它，那么传入的参数很有可能带有双引号。关于如何解决这个问题的任何想法？

            回答 #1

赞同：2

时间：2009-05-29T19:56:23.180

设置值时使用单引号，然后在扩展变量时使用双引号：

```
$ arg1='[5111.3$]="5"'
$ echo "$arg1"
[5111.3$]="5" 
```

            回答 #2

赞同：0

时间：2009-05-29T18:12:31.300

报价转义。尝试

```
[5111.3$]=\"5\" 
```

Advanced Scripting Guide 有一个关于[引用](http://tldp.org/LDP/abs/html/quoting.html)的好部分。

        version-control - 有人可以解释 perforce 集成选项吗？

ID：927336

赞同：23

时间：2009-05-29T18:05:17.337

标签：version-control, merge, integration, perforce

具体来说：

*   为什么我需要一直显式启用“启用无根据的合并”？我正在从我的分支集成到主干。

*   “启用对已删除目标的集成”是什么意思？默认情况下不应该这样做吗？如果该文件不存在，并且您与该文件集成到该分支，它应该创建该文件，对吧？

*   “不获取所选文件的最新版本”与集成有什么关系？我应该选择一个源版本和一个目标（创建一个新的目标版本）。

*   “忽略间接整合历史”是什么意思？我从来没有用过它，因为它听起来很吓人。

我会很高兴知道，因为当我尝试执行从我们的主干到各个分支的各种集成任务时，我有点不确定要启用哪些选项，反之亦然。（我不是 buildmaster，但是，嘿，我想知道他知道什么）。

            回答 #1

赞同：9

时间：2009-05-29T20:21:39.120

为什么我需要一直显式启用“启用无根据的合并”？我正在从我的分支集成到主干。

在这里帮不了你。有什么不对劲。

“启用对已删除目标的集成”是什么意思？

如果目标文件已被删除并且源文件已更改，则将在目标文件之上重新分支源文件。如果没有此选项，将不允许将已在分支上更改并在主干上删除的分支上的文件重新集成到主干中。

默认情况下不应该这样做吗？

如果您将文件集成回主干，您从主干分支，然后在主干上删除，则不会。通常，“p4 集成”会避免将未完成的编辑与已删除的文件混合在一起。您必须使用高级选项来告诉它如何处理已删除的文件。

如果该文件不存在，并且您与该文件集成到该分支，它应该创建该文件，对吗？

当集成一个以前从未存在过的文件（即，它被添加到分支）时，从一个位置到另一个位置，是的，Perforce 将简单地在您要集成的位置创建它。但是，如果文件最初来自主干，在主干上被删除，现在您正尝试将其从分支集成回主干，您必须通过这些集成选项告诉它要做什么。以下是这些选项对应的命令行开关：

*   启用围绕已删除修订的集成 = **-d**
*   整合已删除的目标 = **-Dt** 
*   删除源时删除目标文件 = **-Ds**
*   删除并重新添加源时尝试集成更改=   **-Di**

您可以在集成命令帮助中了解有关它们的更多信息（在命令行中键入“p4 help integration”）。

“不获取所选文件的最新版本”与集成有什么关系？

这告诉 Perforce 使用目标文件的工作区版本。默认情况下，目标文件的头版本会在集成之前自动检索到工作区中。假设您对分支文件进行了一次修订并将其重新集成到主干中。主干和分支现在有此文件的两个修订版。您提交了对分支文件的更改，因此它现在有 3 个修订版。您将分支文件同步回修订版 2。如果您现在要进行常规集成，Perforce 会假设您想要将所有内容集成到主要修订版，并将分支文件的修订版 3 集成到主干中。如果您要选择此选项，它会显示“所有修订版已集成”，因为您的工作区中有修订版 2。这与试图与“

“忽略间接整合历史”是什么意思？我从来没有用过它，因为它听起来很吓人。

我无法弄清楚，也找不到任何关于它的作用的信息。

            回答 #2

赞同：8

时间：2009-05-29T18:13:32.670

1.  一般来说，要合并两个文件，perforce 会寻找一个“基础”，即最接近两个文件的修订版，并使用它来提供比直接运行两个文件的差异更好的差异。请参阅[知识库文章](http://kb.perforce.com/UserTasks/CodelinesAndBranching/MergingChang..edCodelines)。在不知道你的 perforce 设置的情况下，我不能说出了什么问题，但是，p4win 有一些很好的图形工具来可视化分支，你也许能够确定为什么 perforce 无法为你找到一个基础。这也是“忽略间接集成历史”所做的：阻止它寻找基础。

2.  对于“不同步到头”：集成时，您的“目标”是本地客户端中的文件，您没有为其指定修订版；相反，perforce 将同步您的修订头（如果您不使用“-h”），或者将使用您当前拥有的那个。您不能指定任意版本，因为您的本地客户端只有一个特定版本。

            回答 #3

赞同：2

时间：2009-05-29T18:09:52.117

如果盲目地执行“启用对已删除目标的集成”可能会导致问题。这是一个示例：假设您在下一个发布分支中重构代码，并因此删除了一个源文件——该功能被合并到其他一些源文件中。然后，您可以在先前版本的维护分支中修复该原始源文件中的错误。如果您在默认情况下集成 over delete，死源文件会返回，但它不会被构建并且错误不会被修复。最好警告这发生了，以便您可以手动将修复程序合并到其他源文件中。

        php - 通过 PHP FTP 上传整个目录

ID：927341

赞同：16

时间：2009-05-29T18:05:46.913

标签：php, upload, ftp, directory

我正在尝试编写一个脚本，该脚本将通过 ftp 将存储在我的服务器上的目录的全部内容上传到其他服务器。

我一直在阅读[www.php.net 上的文档](http://php.net/ftp/)，但似乎找不到一次上传多个文件的方法。

有没有办法做到这一点，或者是否有一个脚本可以索引该目录并创建要上传的文件数组？

在此先感谢您的帮助！

            回答 #1

赞同：12

时间：2009-05-29T18:25:50.943

打开连接后，串行上传目录的内容很简单：

```
foreach (glob("/directory/to/upload/*.*") as $filename)
    ftp_put($ftp_stream, basename($filename) , $filename, FTP_BINARY); 
```

并行上传所有文件会更加困难。

            回答 #2

赞同：6

时间：2014-07-09T09:40:22.170

因此，我采用了@iYETER 的代码，并将其包装为一个类对象。

您可以通过以下几行调用此代码：

```
$ftp = new FtpNew("hostname");

$ftpSession = $ftp->login("username", "password");

if (!$ftpSession) die("Failed to connect.");

$errorList = $ftp->send_recursive_directory("/local/dir/", "/remote/dir/");
print_r($errorList);

$ftp->disconnect(); 
```

它递归地爬取本地目录，并将其放在远程目录相对。如果遇到任何错误，它会为每个文件及其异常代码创建一个数组层次结构（到目前为止我只捕获了 2 个，如果是另一个错误，它现在会抛出默认路由）

这被包装到的类：

```
<?php
//Thanks for iYETER on http://stackoverflow.com/questions/927341/upload-entire-directory-via-php-ftp

class FtpNew {
private $connectionID;
private $ftpSession = false;
private $blackList = array('.', '..', 'Thumbs.db');
public function __construct($ftpHost = "") {
    if ($ftpHost != "") $this->connectionID = ftp_connect($ftpHost);
}

public function __destruct() {
    $this->disconnect();
}

public function connect($ftpHost) {     
    $this->disconnect();
    $this->connectionID = ftp_connect($ftpHost);
    return $this->connectionID;
}

public function login($ftpUser, $ftpPass) {
    if (!$this->connectionID) throw new Exception("Connection not established.", -1);
    $this->ftpSession = ftp_login($this->connectionID, $ftpUser, $ftpPass);
    return $this->ftpSession;
}

public function disconnect() {
    if (isset($this->connectionID)) {
        ftp_close($this->connectionID);
        unset($this->connectionID);
    }
}

public function send_recursive_directory($localPath, $remotePath) {
    return $this->recurse_directory($localPath, $localPath, $remotePath);
}

private function recurse_directory($rootPath, $localPath, $remotePath) {
    $errorList = array();
    if (!is_dir($localPath)) throw new Exception("Invalid directory: $localPath");
    chdir($localPath);
    $directory = opendir(".");
    while ($file = readdir($directory)) {
        if (in_array($file, $this->blackList)) continue;
        if (is_dir($file)) {
            $errorList["$remotePath/$file"] = $this->make_directory("$remotePath/$file");
            $errorList[] = $this->recurse_directory($rootPath, "$localPath/$file", "$remotePath/$file");
            chdir($localPath);
        } else {
            $errorList["$remotePath/$file"] = $this->put_file("$localPath/$file", "$remotePath/$file");
        }
    }
    return $errorList;
}

public function make_directory($remotePath) {
    $error = "";
    try {
        ftp_mkdir($this->connectionID, $remotePath);
    } catch (Exception $e) {
        if ($e->getCode() == 2) $error = $e->getMessage(); 
    }
    return $error;
}

public function put_file($localPath, $remotePath) {
    $error = "";
    try {
        ftp_put($this->connectionID, $remotePath, $localPath, FTP_BINARY); 
    } catch (Exception $e) {
        if ($e->getCode() == 2) $error = $e->getMessage(); 
    }
    return $error;
}
} 
```

            回答 #3

赞同：2

时间：2009-05-29T18:22:10.983

循环执行，遍历文件夹中的所有文件

```
$servername = $GLOBALS["servername"];
    $ftpUser = $GLOBALS["ftpUser"];
    $ftpPass = $GLOBALS["ftpPass"];
$conn_id = ftp_connect($servername) or die("<p style=\"color:red\">Error connecting to $servername </p>");

if(ftp_login($conn_id, $ftpUser, $ftpPass))
{
    $dir_handle = @opendir($path) or die("Error opening $path");

         while ($file = readdir($dir_handle)) {
            ftp_put($conn_id, PATH_TO_REMOTE_FILE, $file)
        }
} 
```

            回答 #4

赞同：1

时间：2011-11-18T02:52:14.490

我对其进行了编码，脚本上传了整个文件夹及其子文件夹和文件。

我希望它会帮助你。

```
<?php 
ob_start(); 
set_time_limit(0); 
//r10.net fatal

$anadizin="uploadedeceginizdizin"; //this is the folder that you want to upload with all subfolder and files of it.

$ftpsunucu="domain.com"; //ftp domain name
$ftpusername="ftpuser";  //ftp user name 
$ftppass="ftppass"; //ftp passowrd
$ftpdizin="/public_html"; //ftp main folder

$arkadaslarlabardaydik = ftp_connect($ftpsunucu); 
$ictikguldukeglendik = ftp_login($arkadaslarlabardaydik, $ftpusername, $ftppass); 

if((!$arkadaslarlabardaydik) || (!$ictikguldukeglendik))  
{ 
  echo "cant connect!"; 
  die(); 
} 

function klasoruoku($dizinadi) 
{ 
  global $nerdeyiz,$fulldizin,$ftpdizin,$arkadaslarlabardaydik,$ftpdizin; 

  chdir($dizinadi."\\"); 
  $dizin = opendir("."); 

  while($bilgi=readdir($dizin))  
  { 
    if ($bilgi!='.' and $bilgi!='..' and $bilgi!="Thumbs.db") 
    {  
        $tamyol="$dizinadi\\$bilgi"; 

        $lokalkla=str_replace("".$nerdeyiz."\\","",$dizinadi).""; 
        $lokaldosya="$lokalkla\\$bilgi"; 
        $ftpyeyolla=str_replace(array("\\\\","\\"),array("/","/"),"$ftpdizin\\".str_replace("".$fulldizin."","",$dizinadi)."\\$bilgi"); 

        if(!is_dir($bilgi)) 
        { 
          $yükleme = ftp_put($arkadaslarlabardaydik, $ftpyeyolla, $tamyol, FTP_BINARY); 

          if (!$yükleme)  
          { 
              echo "$lokaldosya <font color=red>uploaded</font>"; echo "<br>";  fls(); 
          }  
          else  
          { 
              echo "$lokaldosya <font color=green>not uploaded</font>"; echo "<br>"; fls(); 
          } 
        } 
        else 
        {  
          ftp_mkdir($arkadaslarlabardaydik, $ftpyeyolla); 
          klasoruoku("$dizinadi\\$bilgi"); 
          chdir($dizinadi."\\"); 
          fls(); 
        } 
    } 
  } 
  closedir ($dizin); 
} 

function fls() 
{ 
    ob_end_flush(); 
    ob_flush(); 
    flush(); 
    ob_start(); 
} 

$nerdeyiz=getcwd(); 
$fulldizin=$nerdeyiz."\\$anadizin"; 
klasoruoku($fulldizin); 
ftp_close($arkadaslarlabardaydik); 

?> 
```

            回答 #5

赞同：0

时间：2009-05-29T18:21:01.813

如果您想一次上传多个文件，则需要使用 thread 或 fork。

我不确定 PHP 中的线程实现，但你应该看看[PHP SPL](http://fr3.php.net/manual/en/book.spl.php)和/或[PEAR](http://pear.php.net/)

**编辑：**感谢 Frank Farmer 让我知道 PHP 中有一个名为[pcntl_fork()的 fork() 函数](http://fr2.php.net/pcntl_fork)

您还必须递归获取整个内容目录才能上传给定目录的所有文件。

        macos - 使用 C（Carbon，标准 C/C++）在 OSX 上将文件标记为可执行文件

ID：927345

赞同：0

时间：2009-05-29T18:06:17.037

标签：macos, macos-carbon

我正在寻找一种以编程方式在 OS X 上的文件上设置“可执行”位的方法。我不想调用“chmod a+x”，但我想要与 chmod 调用相同的效果。有什么建议么？碳 API 或任何其他 C/C++ 函数都可以工作......

            回答 #1

赞同：2

时间：2009-05-29T18:08:37.093

请参阅 chmod(2)，例如[http://www.manpagez.com/man/2/chmod/osx-10.4.php](http://www.manpagez.com/man/2/chmod/osx-10.4.php)（我认为它在 10.5 中没有变化）。

            回答 #2

赞同：1

时间：2009-05-29T18:08:31.760

有一个“chmod”C 库调用。转到终端窗口并输入“man 2 chmod”。

        vba - 从 Excel VBA 创建 SQL 表

ID：927349

赞同：7

时间：2009-05-29T18:06:57.050

标签：vba, excel

问题是我无法获取输入到变量“tblName”中的表名来使用，而是获得了一个正确命名的数据库，其中包含一个名为“tblName”的表。

是否有某种方法可以在“tblName”中获取名称，或者在使用用户输入的名称创建名称后更改名称？

```
Private Sub CreateDatabaseFromExcel()

    Dim dbConnectStr As String
    Dim Catalog As Object
    Dim cnt As ADODB.Connection
    Dim dbPath As String
    Dim tblName As String

    'Set database name in the Excel Sheet
    dbPath = ActiveSheet.Range("B1").Value 'Database Name
    tblName = ActiveSheet.Range("B2").Value 'Table Name

    dbConnectStr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & dbPath & ";"

    'Create new database using name entered in Excel Cell ("B1")
    Set Catalog = CreateObject("ADOX.Catalog")
    Catalog.Create dbConnectStr
    Set Catalog = Nothing

    'Connect to database and insert a new table
    Set cnt = New ADODB.Connection
    With cnt
        .Open dbConnectStr
        .Execute "CREATE TABLE tblName ([BankName] text(50) WITH Compression, " & _
                 "[RTNumber] text(9) WITH Compression, " & _
                 "[AccountNumber] text(10) WITH Compression, " & _
                 "[Address] text(150) WITH Compression, " & _
                 "[City] text(50) WITH Compression, " & _
                 "[ProvinceState] text(2) WITH Compression, " & _
                 "[Postal] text(6) WITH Compression, " & _
                 "[AccountAmount] decimal(6))"
    End With
    Set cnt = Nothing

End Sub 
```

            回答 #1

赞同：14

时间：2009-05-29T18:09:52.770

更改此行：

```
.Execute "CREATE TABLE tblName ([BankName] text(50) WITH Compression, " & _ 
```

对此：

```
.Execute "CREATE TABLE " & tblName & " ([BankName] text(50) WITH Compression, " & _ 
```

        c# - LINQ to XML 新手：将节点从一个节点移动到另一个节点

ID：927350

赞同：4

时间：2009-05-29T18:07:15.490

标签：c#, linq, linq-to-xml

问候！

我有一个包含以下内容的 XElement 对象：

```
<Root>
    <SubSections>
        <SubSection id="A">
            <Foo id="1">
                <Bar />
                <Bar />
                <Bar />
            </Foo>
            <Foo id="2">
                <Bar />
                <Bar />
            </Foo>
            <Foo id="3">
                <Bar />
            </Foo>
        </SubSection>
        <SubSection id="B">
            <Foo id="4">
                <Bar />
                <Bar />
                <Bar />
            </Foo>
            <Foo id="5">
                <Bar />
                <Bar />
            </Foo>
         </SubSection>
        <SubSection id="C">

        </SubSection>
    </SubSections>
</Root> 
```

我想将 Foo 的 2 和 3 移动到 id 为“C”的 SubSection，结果是：

```
<Root>
    <SubSections>
        <SubSection id="A">
            <Foo id="1">
                <Bar />
                <Bar />
                <Bar />
            </Foo>
        </SubSection>
        <SubSection id="B">
            <Foo id="4">
                <Bar />
                <Bar />
                <Bar />
            </Foo>
            <Foo id="5">
                <Bar />
                <Bar />
            </Foo>
        </SubSection>
        <SubSection id="C">
            <Foo id="2">
                <Bar />
                <Bar />
            </Foo>
            <Foo id="3">
                <Bar />
            </Foo>
        </SubSection>
    </SubSections>
</Root> 
```

将 Foo 部分“2”和“3”移动到“C”子部分的最佳方法是什么？

            回答 #1

赞同：4

时间：2009-05-29T18:50:17.103

您需要使用以下查询获取 Foo 第 2 和 3 节：

```
var foos = from xelem in root.Descendants("Foo")
           where xelem.Attribute("id").Value == "2" || xelem.Attribute("id").Value == "3"
           select xelem; 
```

然后迭代该列表并将它们从他们的父母中删除

```
xelem.Remove(); 
```

然后只需将它们添加到正确的节点：

```
parentElem.Add(xelem); 
```

第一个查询将为您提供两个部分，然后将每个部分删除并添加到树上的正确位置。

这是一个完整的解决方案：

```
var foos = (from xElem in xDoc.Root.Descendants("Foo")
                   where xElem.Attribute("id").Value == "2" || xElem.Attribute("id").Value == "3"
                   select xElem).ToList();

        var newParentElem = (from xElem in xDoc.Root.Descendants("SubSection")
                            where xElem.Attribute("id").Value == "C"
                            select xElem).Single();

        foreach(var xElem in foos)
        {
            xElem.Remove();
            newParentElem.Add(xElem);
        } 
```

之后，您的 xDoc 应该有正确的树。

        git - 如何撤消 Git 中最近的本地提交？

ID：927358

赞同：24007

时间：2009-05-29T18:09:14.627

标签：git, version-control, git-commit, undo

我不小心**将错误的文件**提交给了[Git](https://en.wikipedia.org/wiki/Git)，但还没有将提交推送到服务器。
如何**从本地存储库撤消这些提交**？
唯一的方法似乎是在某种 GUI 文本编辑器中复制编辑，然后擦除整个本地克隆，然后重新克隆存储库，然后重新应用编辑。然而，

*   这可能会导致数据丢失。
*   当只运行意外时，很难做到这一点`git commit`。

有没有更好的办法？

            回答 #1

赞同：26050

时间：2009-05-29T18:13:42.373

撤消提交并重做

```
$ git commit -m "Something terribly misguided" # (0: Your Accident)
$ git reset HEAD~                              # (1)
[ edit files as necessary ]                    # (2)
$ git add .                                    # (3)
$ git commit -c ORIG_HEAD                      # (4) 
```

1.  该命令负责**撤消**。它将撤消您的最后一次提交，同时**保持您的工作树（磁盘上文件的状态）不变。**您需要再次添加它们，然后才能再次提交它们）。

2.  更正工作树文件。

3.  `git add`您想包含在新提交中的任何内容。

4.  提交更改，重用旧的提交消息。`reset`将旧头复制到`.git/ORIG_HEAD`；`commit`with`-c ORIG_HEAD`将打开一个编辑器，该编辑器最初包含来自旧提交的日志消息，并允许您对其进行编辑。如果您不需要编辑消息，则可以使用该`-C`选项。

**或者，要编辑先前的提交（或只是其提交消息）**，`commit --amend`会将当前索引中的更改添加到先前的提交中。
**要删除（不恢复）已推送到服务器的提交，**需要重写历史记录`git push origin master --force`。

延伸阅读
[如何将 HEAD 移回之前的位置？（分离的头）和撤消提交](https://stackoverflow.com/questions/34519665/how-to-move-head-back-to-a-previous-location-detached-head/34519716#34519716)
上面的答案将向您显示`git reflog`，您可以使用它来确定您希望恢复到的提交的 SHA-1。获得此值后，请使用上述命令序列。

`HEAD~`是一样的`HEAD~1`。文章[什么是 git 中的 HEAD？](https://stackoverflow.com/a/46350644/5175709)如果您想取消提交多个提交，这很有帮助。

            回答 #2

赞同：11780

时间：2011-07-28T22:22:20.757

如果您不知道它是如何工作的，那么撤消提交有点可怕。但是，如果您确实了解，这实际上非常容易。我将向您展示撤消提交的 4 种不同方式。
选项1：`git reset --hard`
假设你有这个，其中 C 是你的 HEAD 并且 (F) 是你的文件的状态。

```
 (F)
A-B-C
    ↑
  master 
```

你想**核对提交 C 并且再也看不到它并丢失本地修改文件中的所有更改**。你来做这件事：

```
git reset --hard HEAD~1 
```

结果是：

```
 (F)
A-B
  ↑
master 
```

现在 B 是 HEAD。因为您使用`--hard`了 ，所以您的文件在提交 B 处被重置为它们的状态。
选项2：`git reset`
啊，但是假设提交 C 不是一场灾难，只是有点偏离。您想撤消提交，但在进行更好的提交之前**保留您的更改以进行一些编辑。**从这里重新开始，以 C 作为你的 HEAD：

```
 (F)
A-B-C
    ↑
  master 
```

你可以做到这一点，离开`--hard`：

```
git reset HEAD~1 
```

在这种情况下，结果是：

```
 (F)
A-B-C
  ↑
master 
```

在这两种情况下， HEAD 只是指向最新提交的指针。当你执行 a`git reset HEAD~1`时，你告诉 Git 将 HEAD 指针移回一个提交。但是（除非你使用`--hard`）你让你的文件保持原样。所以现在`git status`显示您已签入 C 的更改。您没有丢失任何东西！
选项 3：`git reset --soft`
为了最轻松的接触，您甚至可以**撤消您的提交，但保留您的文件和[索引](https://git.wiki.kernel.org/index.php/WhatIsTheIndex)**：

```
git reset --soft HEAD~1 
```

这不仅会留下您的文件，甚至会留下您的*索引*。当你这样做时`git status`，你会看到索引中的文件和以前一样。事实上，在这个命令之后，你可以做`git commit`并且你会重做你刚刚做的同样的提交。
选项 4：您确实`git reset --hard`并且需要取回该代码
还有一件事：假设您像第一个示例一样**销毁了一个提交，****但后来发现您毕竟需要它**？运气不好，对吧？
不行，*还是*有办法找回来的。键入`git reflog`，您将看到已移动的（部分）提交[shas](https://en.wikipedia.org/wiki/SHA-1#Data_integrity)（即哈希）列表。找到您销毁的提交，然后执行以下操作：

```
git checkout -b someNewBranchName shaYouDestroyed 
```

您现在已经恢复了该提交。提交实际上不会在 Git 中被销毁大约 90 天，因此您通常可以返回并拯救一个您不想摆脱的提交。

            回答 #3

赞同：2461

时间：2011-06-16T17:27:23.360

有两种方法可以“撤消”您的最后一次提交，具体取决于您是否已经公开提交（推送到远程存储库）：
如何撤消本地提交
假设我在本地提交，但现在我想删除该提交。

```
git log
    commit 101: bad commit    # Latest commit. This would be called 'HEAD'.
    commit 100: good commit   # Second to last commit. This is the one we want. 
```

要将所有内容恢复到上次提交之前的状态，我们需要`reset`在提交之前进行`HEAD`：

```
git reset --soft HEAD^     # Use --soft if you want to keep your changes
git reset --hard HEAD^     # Use --hard if you don't care about keeping the changes you made 
```

现在`git log`将显示我们的最后一次提交已被删除。
如何撤消公共提交
如果您已经公开了您的提交，您将需要创建一个新的提交，它将“恢复”您在之前的提交（当前的 HEAD）中所做的更改。

```
git revert HEAD 
```

您的更改现在将被还原并准备好提交：

```
git commit -m 'restoring the file I removed by accident'
git log
    commit 102: restoring the file I removed by accident
    commit 101: removing a file we don't need
    commit 100: adding a file that we need 
```

有关更多信息，请查看*[Git 基础知识 - 撤消操作](https://git-scm.com/book/en/v2/Git-Basics-Undoing-Things)*。

            回答 #4

赞同：1860

时间：2009-05-29T18:16:26.470

添加/删除文件以按照您想要的方式获取内容：

```
git rm classdir
git add sourcedir 
```

然后修改提交：

```
git commit --amend 
```

先前的错误提交将被编辑以反映新的索引状态 - 换句话说，就像您从一开始就没有犯过错误一样。

请注意，只有在尚未推送时才应该这样做。如果您已推送，那么您只需正常提交修复即可。

            回答 #5

赞同：1166

时间：2009-05-29T18:13:07.773

```
git rm yourfiles/*.class
git commit -a -m "deleted all class files in folder 'yourfiles'" 
```

或者

```
git reset --hard HEAD~1 
```

**警告：上述命令将永久删除对`.java`您要提交的文件（和任何其他文件）的修改。**

`hard reset`to会将您的`HEAD-1`工作副本设置为错误提交之前的提交状态。

            回答 #6

赞同：881

时间：2010-07-31T09:39:13.780

更改最后一次提交
替换索引中的文件：

```
git rm --cached *.class
git add *.java 
```

然后，如果它是私有分支，请**修改**提交：

```
git commit --amend 
```

或者，如果它是共享分支，则进行新的提交：

```
git commit -m 'Replace .class files with .java files' 
```

*（**要更改以前的提交**，请使用很棒的[交互式变基](https://stackoverflow.com/a/28421811/405550)。）*

ProTip™：添加`*.class`到[gitignore](https://help.github.com/articles/ignoring-files)以阻止这种情况再次发生。

恢复提交
如果您需要更改最后一次提交，修改提交是理想的解决方案，但更通用的解决方案是`reset`.
您可以使用以下命令将 Git 重置为任何提交：

```
git reset @~N 
```

`N`之前的提交次数在哪里`HEAD`，并`@~`重置为上一次提交。
您可以使用以下命令，而不是修改提交：

```
git reset @~
git add *.java
git commit -m "Add .java files" 
```

查看`git help reset`，特别是 和 上的部分`--soft` `--mixed`，`--hard`以便更好地理解它的作用。
重新登录
如果你搞砸了，你总是可以使用 reflog 来查找丢弃的提交：

```
$ git reset @~
$ git reflog
c4f708b HEAD@{0}: reset: moving to @~
2c52489 HEAD@{1}: commit: added some .class files
$ git reset 2c52489
... and you're back where you started 
```

            回答 #7

赞同：781

时间：2012-05-25T16:04:29.480

使用`git revert <commit-id>`.

要获取提交 ID，只需使用`git log`.

            回答 #8

赞同：632

时间：2013-01-31T07:06:10.373

如果您打算完全撤消本地提交，无论您在提交上做了什么更改，如果您对此不担心，只需执行以下命令。

```
git reset --hard HEAD^1 
```

（此命令将忽略您的整个提交，并且您的更改将从您的本地工作树中完全丢失）。如果您想撤消您的提交，但您希望在暂存区域中进行更改（在提交之前就像 after 一样`git add`），请执行以下命令。

```
git reset --soft HEAD^1 
```

现在您提交的文件进入暂存区。假设如果你想升级文件，因为你需要编辑一些错误的内容，那么执行以下命令

```
git reset HEAD 
```

现在提交的文件从暂存区进入非暂存区。现在文件已准备好编辑，所以无论您更改什么，您都想编辑并添加它并进行全新/新提交。
[更多（链接断开）](http://madhan-tech-updates.blogspot.in/2013/01/how-to-undo-your-local-git-commit.html)（[存档版本](https://web.archive.org/web/20170410191943/http://madhan-tech-updates.blogspot.in/2013/01/how-to-undo-your-local-git-commit.html)）

            回答 #9

赞同：577

时间：2011-12-13T10:18:31.987

如果您安装了[Git Extras](https://github.com/visionmedia/git-extras)，您可以运行`git undo`以撤消最新的提交。`git undo 3`将撤消最后三个提交。

            回答 #10

赞同：538

时间：2012-04-06T13:58:52.667

我想撤消我们共享存储库中最近的五个提交。我查找了要回滚到的修订 ID。然后我输入了以下内容。

```
prompt> git reset --hard 5a7404742c85
HEAD is now at 5a74047 Added one more page to catalogue
prompt> git push origin master --force
Total 0 (delta 0), reused 0 (delta 0)
remote: bb/acl: neoneye is allowed. accepted payload.
To git@bitbucket.org:thecompany/prometheus.git
 + 09a6480...5a74047 master -> master (forced update)
prompt> 
```

            回答 #11

赞同：512

时间：2012-10-25T03:41:20.030

我更喜欢使用`git rebase -i`这项工作，因为会弹出一个不错的列表，我可以在其中选择要摆脱的提交。它可能不像这里的其他一些答案那么直接，但*感觉是对的*。

选择要列出的提交数量，然后像这样调用（争取最后三个）

```
git rebase -i HEAD~3 
```

样品清单

```
pick aa28ba7 Sanity check for RtmpSrv port
pick c26c541 RtmpSrv version option
pick 58d6909 Better URL decoding support 
```

然后 Git 将删除您删除的任何行的提交。

            回答 #12

赞同：480

时间：2013-04-23T17:27:45.043

如何修复之前的本地提交

使用 git-gui（或类似的）来执行`git commit --amend`. 在 GUI 中，您可以在提交中添加或删除单个文件。您还可以修改提交消息。

如何撤消先前的本地提交

只需将您的分支重置到以前的位置（例如，使用`gitk`or `git rebase`）。然后从保存的副本重新应用您的更改。在本地存储库中进行垃圾收集后，就像从未发生过不需要的提交一样。要在一个命令中完成所有这些操作，请使用`git reset HEAD~1`.

**警告语**：*粗心的使用`git reset`是让你的工作副本陷入混乱状态的好方法。我建议 Git 新手尽可能避免这种情况。*

如何撤消公共提交

执行[反向樱桃选择](https://stackoverflow.com/a/1624724/86967)（[git-revert](http://git-scm.com/docs/git-revert.html)）以撤消更改。

如果您还没有将其他更改拉到您的分支上，您可以简单地...

```
git revert --no-edit HEAD 
```

然后将更新后的分支推送到共享存储库。

*提交历史将分别显示这两个提交*。

高级：更正公共存储库中的*私有*分支

*这可能很危险——请确保您有要重新推送的分支的本地副本。*

*另请注意：如果其他人可能在分支上工作，您不希望这样做。*

```
git push --delete (branch_name) ## remove public version of branch 
```

在本地清理您的分支，然后重新推送...

```
git push origin (branch_name) 
```

*在正常情况下，您可能不必担心您的私有分支提交历史是原始的。只需推送后续提交（请参阅上面的“如何撤消公共提交”），然后执行[squash-merge](https://stackoverflow.com/a/22417539/86967)以隐藏历史记录。*

            回答 #13

赞同：396

时间：2013-05-17T13:02:13.293

如果您想永久撤消它并且您已经克隆了一些存储库。
提交 ID 可以通过以下方式查看：

```
git log 
```

然后你可以这样做：

```
git reset --hard <commit_id>

git push origin <branch_name> -f 
```

            回答 #14

赞同：390

时间：2014-09-03T07:15:30.257

如果你犯了垃圾但没有被推送，

```
git reset --soft HEAD~1 
```

**HEAD~1**是 head 之前提交的简写。或者，如果您想重置为，您可以参考哈希的**SHA-1 。***--soft*选项将删除提交，但它将保留所有更改的文件“要提交的更改”，就像 git status 所说的那样。

如果您想摆脱自 head 之前的提交以来对工作树中跟踪文件的任何更改，请改用“ **--hard** ”。

或者

如果你已经推了有人拉了，这通常是我的情况，你不能使用*git reset*。但是，您可以执行*git revert*，

```
git revert HEAD 
```

这将创建一个新的提交，它会反转由意外提交引入的所有内容。

            回答 #15

赞同：335

时间：2013-06-28T10:18:29.890

在[SourceTree](https://www.atlassian.com/software/sourcetree/overview)（GitHub 的 GUI）上，您可以右键单击提交并执行“反向提交”。这应该撤消您的更改。

在终端上：

您也可以使用：

```
git revert 
```

或者：

```
git reset --soft HEAD^ # Use --soft if you want to keep your changes.
git reset --hard HEAD^ # Use --hard if you don't care about keeping your changes. 
```

            回答 #16

赞同：309

时间：2014-03-05T13:55:35.533

一个命令：

```
git reset --soft 'HEAD^' 
```

撤消最后一次本地提交非常有用！

            回答 #17

赞同：290

时间：2017-06-21T09:33:19.620

只需使用以下命令重置它`git`：

```
git reset --soft HEAD~1 
```

**解释：**做什么`git reset`，它基本上`reset`是你想要返回的任何提交，然后如果你将它与`--soft`key 结合，它会返回，但将更改保留在你的文件中，所以你回到舞台刚刚添加的文件是`HEAD`分支的头，如果你结合`~1`（在这种情况下你也使用`HEAD^`），它只会返回一个你想要的提交......

我为您更详细地创建了下图中的步骤，包括在实际情况中可能发生的所有步骤并提交代码：

[![如何撤消 Git 中的最后一次提交？](https://i.stack.imgur.com/7zrzb.jpg)](https://i.stack.imgur.com/7zrzb.jpg)

            回答 #18

赞同：268

时间：2014-04-23T11:21:20.787

**如何撤消最后一次 Git 提交？**

要将所有内容恢复到上次提交之前的状态，我们需要重置为 HEAD 之前的提交。

1.  如果您不想保留所做的更改：

    ```
    git reset --hard HEAD^ 
    ```

2.  如果您想保留更改：

    ```
    git reset --soft HEAD^ 
    ```

现在检查你的 git 日志。它将显示我们的最后一次提交已被删除。

            回答 #19

赞同：249

时间：2013-10-03T12:43:57.403

“将工作树重置为最后一次提交”

```
git reset --hard HEAD^ 
```

“从工作树中清除未知文件”

```
git clean 
```

请参阅 - [Git 快速参考](https://web.archive.org/web/20210515091636/http://jonas.nitro.dk/git/quick-reference.html)
注意：**此命令将删除您之前的提交**，因此请谨慎使用！`git reset --hard`更安全。

            回答 #20

赞同：215

时间：2014-01-06T22:34:06.847

使用 reflog 找到正确的状态

```
git reflog 
```

![重新登录之前](https://i.stack.imgur.com/c7e7D.png)
*重置前重新记录*

选择正确的 reflog（在我的例子中是 f3cb6e2）并输入

```
git reset --hard f3cb6e2 
```

之后，repo HEAD 将重置为该 HEADid
 ![重置效果](https://i.stack.imgur.com/GdnDT.png)
*LOG AFTER RESET*

最后 reflog 如下图所示

![重新登录后](https://i.stack.imgur.com/Fhhub.png)
*重新记录决赛*

            回答 #21

赞同：189

时间：2013-10-11T14:41:16.647

第一次运行：

```
git reflog 
```

它将显示您对存储库执行的所有可能操作，例如，提交、合并、拉取等。

然后做：

```
git reset --hard ActionIdFromRefLog 
```

            回答 #22

赞同：178

时间：2016-03-06T11:53:22.997

撤消上次提交：

`git reset --soft HEAD^`或者`git reset --soft HEAD~`

这将撤消最后一次提交。

这里`--soft`的意思是重置为登台。

`HEAD~`或`HEAD^`表示在 HEAD 之前进行提交。

将上次提交替换为新提交：

```
git commit --amend -m "message" 
```

它将用新的提交替换最后一次提交。

            回答 #23

赞同：175

时间：2013-05-13T17:12:25.717

另一种方式：

签出您要恢复的分支，然后将本地工作副本重置回您希望成为远程服务器上最新的提交（之后的一切都会再见）。为此，在 SourceTree 中，我右键单击并选择“将 BRANCHNAME 重置为此提交”。

然后导航到存储库的本地目录并运行以下命令：

```
git -c diff.mnemonicprefix=false -c core.quotepath=false push -v -f --tags REPOSITORY_NAME BRANCHNAME:BRANCHNAME 
```

这将删除本地存储库中当前提交之后的所有提交，但仅针对那个分支。

            回答 #24

赞同：164

时间：2013-05-15T13:12:29.717

键入`git log`并找到最后一次提交哈希码，然后输入：

```
git reset <the previous co> 
```

            回答 #25

赞同：159

时间：2013-07-18T06:41:16.423

就我而言，我不小心提交了一些我不想提交的文件。所以我做了以下事情，它奏效了：

```
git reset --soft HEAD^
git rm --cached [files you do not need]
git add [files you need]
git commit -c ORIG_HEAD 
```

使用 gitk 或 git log --stat 验证结果

            回答 #26

赞同：153

时间：2016-01-06T14:10:12.213

很简单，在命令行中运行它：

```
git reset --soft HEAD~ 
```

            回答 #27

赞同：142

时间：2014-09-12T14:51:01.113

主要有两种情况

**你还没有推送提交**

如果问题是您提交的额外文件（并且您不希望这些文件在存储库中），您可以使用删除它们`git rm`然后提交`--amend`

```
git rm <pathToFile> 
```

您还可以使用 删除整个目录`-r`，甚至可以与其他[Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)命令结合使用

```
git rm -r <pathToDirectory>
git rm $(find -name '*.class') 
```

删除文件后，您可以使用**--amend**选项提交

```
git commit --amend -C HEAD # the -C option is to use the same commit message 
```

这将重写您最近的本地提交，删除额外的文件，因此，这些文件将永远不会在推送时发送，并且也会被 GC 从您的本地 .git 存储库中删除。

**你已经推送了提交**

您可以应用与其他方案相同的解决方案，然后`git push`使用该`-f`选项，但**不建议**这样做，因为它会用不同的更改覆盖远程历史记录（它可能会弄乱您的存储库）。

相反，您必须在没有的情况下进行提交`--amend`（请记住关于 -amend 的这一点：该选项会重写上次提交的历史记录）。

            回答 #28

赞同：140

时间：2014-03-04T04:35:18.140

对于本地提交

```
git reset --soft HEAD~1 
```

或者如果你不记得它是在哪个提交中，你可以使用

```
git rm --cached <file> 
```

对于推送的提交

从存储库历史记录中删除文件的正确方法是使用`git filter-branch`. 那是，

```
git filter-branch --index-filter 'git rm --cached <file>' HEAD 
```

但我建议您谨慎使用此命令。*[在git-filter-branch(1) 手册页](https://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html)*上阅读更多内容。

            回答 #29

赞同：138

时间：2014-08-28T16:03:04.120

要重置到以前的版本，永久删除所有未提交的更改：

```
git reset --hard HEAD~1 
```

            回答 #30

赞同：138

时间：2016-07-28T07:24:22.693

用什么，`reset --soft`或者`reset --hard`？

我只是为@Kyralessa 的回答加两分钱：

如果你不确定要使用什么`--soft`（我用这个约定来记住它——为了安全起见）**。**

为什么 ？

如果您`--hard`错误地选择，您将**丢失**以前没有的更改。如果您选择错误，您可以通过应用其他命令`--soft`来获得相同的结果`--hard`

```
git reset HEAD file.html
git checkout -- file.html 
```

完整示例

```
echo "some changes..." > file.html
git add file.html
git commit -m "wrong commit"

# I need to reset
git reset --hard HEAD~1 (cancel changes)
# OR
git reset --soft HEAD~1 # Back to staging
git reset HEAD file.html # back to working directory
git checkout -- file.html # cancel changes 
```

致谢@Kyralessa。

            回答 #31

赞同：137

时间：2016-02-18T03:27:38.440

有很多方法可以做到：

Git命令撤消最后一次提交/以前的提交：

**警告：**如果您不知道自己在做什么，请不要使用 --hard。--hard 太**危险**了，它可能会**删除你的文件。**

**在 Git 中恢复提交的基本命令是：**

```
$ git reset --hard <COMMIT -ID> 
```

或者

```
$ git reset --hard HEAD~<n> 
```

**COMMIT-ID** : 提交的 ID

**n：**  是您要恢复的最后提交的数量

您可以获取提交 id，如下所示：

```
$ **git log --oneline**

d81d3f1 function to subtract two numbers

be20eb8 function to add two numbers

bedgfgg function to mulitply two numbers 
```

其中**d81d3f1**和**be20eb8**是提交 ID。

**现在让我们看一些案例：**

*假设您想恢复最后一次提交“d81d3f1”。这里有两个选项：*

```
$ git reset --hard d81d3f1 
```

或者

```
$ git reset --hard HEAD~1 
```

*假设您要恢复提交“be20eb8”：*

```
$ git reset --hard be20eb8 
```

有关更多详细信息，您可以参考并尝试一些其他命令来将 head 重置为指定状态：

```
$ git reset --help 
```

            回答 #32

赞同：129

时间：2013-08-29T16:18:39.390

使用[SourceTree](https://www.atlassian.com/software/sourcetree/overview)（Git 的图形工具）查看您的提交和树。您可以通过右键单击它直接手动重置它。

            回答 #33

赞同：98

时间：2016-11-18T08:57:39.593

认为我们有***code.txt***文件。我们对其进行了一些更改并提交。
**我们可以通过三种方式撤消此提交**，但首先您应该知道暂存文件是什么...暂存文件是准备提交的文件，如果您运行`git status`此文件，则该文件将显示为绿色，如果未暂存for commit 将显示为红色：

[![在此处输入图像描述](https://i.stack.imgur.com/ymNKl.png)](https://i.stack.imgur.com/ymNKl.png)

这意味着如果您提交更改，则不会保存您对此文件的更改。您可以将此文件添加到您的阶段，`git add code.txt`然后提交您的更改：

[![在此处输入图像描述](https://i.stack.imgur.com/36Yag.png)](https://i.stack.imgur.com/36Yag.png)

**撤消上次提交：**

1.  现在，如果我们只想撤消提交而不进行任何其他更改，我们可以使用

    `git reset --soft HEAD^` 

    [![在此处输入图像描述](https://i.stack.imgur.com/Tx6x1.png)](https://i.stack.imgur.com/Tx6x1.png)

2.  如果我们想撤消提交及其更改（***这很危险，因为您的更改将丢失***），我们可以使用

    `git reset --hard HEAD^`

    [![在此处输入图像描述](https://i.stack.imgur.com/8NDBS.png)](https://i.stack.imgur.com/8NDBS.png)

3.  如果我们想撤消提交并从阶段删除更改，我们可以使用

    `git reset --mixed HEAD^`或简写形式`git reset HEAD^`

    [![在此处输入图像描述](https://i.stack.imgur.com/jg8g0.png)](https://i.stack.imgur.com/jg8g0.png)

            回答 #34

赞同：81

时间：2014-11-18T19:11:08.957

通常，您想要**撤消**提交，因为您犯了一个错误并且您想要修复它 - 本质上是 OP 在他提出问题时所做的。真的，你真的想**重做**一个提交。
这里的大多数答案都集中在命令行上。虽然命令行是在您熟悉 Git 时使用它的最佳方式，但对于那些从其他版本控制系统到 Git 的人来说，它可能有点陌生。
以下是使用 GUI 执行此操作的方法。如果您安装了 Git，则您已经拥有了遵循这些说明所需的一切。
**注意：**我在这里假设您在推送之前意识到提交是错误的。如果你不知道推动是什么意思，那么你可能还没有推动。继续按照说明进行。如果你推送了错误的提交，风险最小的方法就是用一个新的提交来修复错误的提交，就像你在不允许你重写历史的版本控制系统中那样。
也就是说，这里是如何使用 GUI 修复最近的错误提交：

1.  在命令行上导航到您的存储库并使用以下命令启动 GUI`git gui`
2.  选择“修改上次提交”。你会看到你最后的提交信息，你暂存的文件和你没有暂存的文件。
3.  现在将内容更改为您希望它们的外观，然后单击提交。

            回答 #35

赞同：79

时间：2016-06-29T06:28:26.010

您可以使用：

```
git reset HEAD@{1} 
```

此命令将在没有 Git 日志的情况下删除您的错误提交。

            回答 #36

赞同：75

时间：2017-09-14T04:33:52.033

**撤消最后一次提交**

在很多情况下，您真的想撤消对代码的最后一次提交。例如，因为您想对其进行广泛的重组——甚至完全放弃它！

在这些情况下，“reset”命令是你最好的朋友：

```
$ git reset --soft HEAD~1 
```

上面的命令（reset）会将你当前的 HEAD 分支倒回到指定的版本。在上面的示例中，我们希望返回到当前版本之前的版本——有效地使我们的最后一次提交撤消。

注意`--soft`标志：这确保保留未完成的修订中的更改。运行命令后，您会在工作副本中发现更改为未提交的本地修改。

如果您不想保留这些更改，只需使用`--hard`标志。确保仅在确定不再需要这些更改时才执行此操作。

```
$ git reset --hard HEAD~1 
```

[![在此处输入图像描述](https://i.stack.imgur.com/hqetQ.png)](https://i.stack.imgur.com/hqetQ.png)

            回答 #37

赞同：68

时间：2017-01-28T00:10:13.057

在回答之前，让我们添加一些背景知识，解释一下这是什么`HEAD`。

***`First of all what is HEAD?`***

`HEAD`只是对当前分支上的当前提交（最新）的引用。

在任何给定时间只能有一个`HEAD`。（不包括`git worktree`）

的内容`HEAD`存储在里面`.git/HEAD`，它包含当前提交的 40 字节 SHA-1。

***`detached HEAD`***

如果您不在最新提交上 - 意思`HEAD`是指向历史上的先前提交，则称为***`detached HEAD`***.

[![在此处输入图像描述](https://i.stack.imgur.com/OlavO.png)](https://i.stack.imgur.com/OlavO.png)

在命令行上，它看起来像这样 - SHA-1 而不是分支名称，因为`HEAD`它没有指向当前分支的尖端

[![在此处输入图像描述](https://i.stack.imgur.com/qplvo.png)](https://i.stack.imgur.com/qplvo.png)

[![在此处输入图像描述](https://i.stack.imgur.com/U0l3s.png)](https://i.stack.imgur.com/U0l3s.png)

关于如何从分离的 HEAD 中恢复的一些选项：

[`git checkout`](https://git-scm.com/docs/git-checkout)

```
git checkout <commit_id>
git checkout -b <new branch> <commit_id>
git checkout HEAD~X // x is the number of commits t go back 
```

这将签出指向所需提交的新分支。

此命令将检出给定的提交。

此时，您可以创建一个分支并从这一点开始工作。

```
# Checkout a given commit. 
# Doing so will result in a `detached HEAD` which mean that the `HEAD`
# is not pointing to the latest so you will need to checkout branch
# in order to be able to update the code.
git checkout <commit-id>

# create a new branch forked to the given commit
git checkout -b <branch name> 
```

[`git reflog`](https://git-scm.com/docs/git-reflog)

您也可以随时使用`reflog`。

`git reflog`将显示更新的任何更改，`HEAD`并检查所需的 reflog 条目将设置`HEAD`回此提交。

**每次修改 HEAD 都会在`reflog`**

```
git reflog
git checkout HEAD@{...} 
```

这将使您回到所需的提交

[![在此处输入图像描述](https://i.stack.imgur.com/atW9w.png)](https://i.stack.imgur.com/atW9w.png)

***[`git reset --hard <commit_id>`](https://git-scm.com/docs/git-reset)***

将您的 HEAD “移动”回所需的提交。

```
# This will destroy any local modifications.
# Don't do it if you have uncommitted work you want to keep.
git reset --hard 0d1d7fc32

# Alternatively, if there's work to keep:
git stash
git reset --hard 0d1d7fc32
git stash pop
# This saves the modifications, then reapplies that patch after resetting.
# You could get merge conflicts if you've modified things which were
# changed since the commit you reset to. 
```

*   注意：（[从 Git 2.7 开始](https://github.com/git/git/blob/master/Documentation/RelNotes/2.7.0.txt)）

    你也可以使用`git rebase --no-autostash`。

***[`git revert <sha-1>`](https://git-scm.com/docs/git-revert)***

“撤消”给定的提交或提交范围。

重置命令将“撤消”在给定提交中所做的任何更改。

将提交带有撤消补丁的新提交，而原始提交也将保留在历史记录中。

```
# add new commit with the undo of the original one.
# the <sha-1> can be any commit(s) or commit range
git revert <sha-1> 
```

这个模式说明了哪个命令做什么。

如您所见，`reset && checkout`修改`HEAD`.

[![在此处输入图像描述](https://i.stack.imgur.com/NuThL.png)](https://i.stack.imgur.com/NuThL.png)

            回答 #38

赞同：67

时间：2015-05-08T08:04:23.427

只需撤消最后一次提交：

```
git reset --soft HEAD~ 
```

或者撤销上次提交前的时间：

```
git reset --soft HEAD~2 
```

或撤消任何先前的提交：

```
git reset --soft <commitID> 
```

（您可以使用 获取 commitID `git reflog`）

当您撤消先前的提交时，请记住使用

```
git clean 
```

更多细节可以在文档中找到：[git-reset](http://git-scm.com/docs/git-reset)

            回答 #39

赞同：65

时间：2021-08-18T12:35:37.170

如果您想恢复最后一次提交，但仍想在本地保留在提交中所做的更改，请使用以下命令：

```
git reset HEAD~1 --mixed 
```

            回答 #40

赞同：64

时间：2018-02-15T07:08:15.987

**撤消最后一次提交：**

```
git reset --soft HEAD^ or git reset --soft HEAD~ 
```

**这将撤消最后一次提交。**

这里`--soft`的意思是重置为登台。

`HEAD~ or HEAD^`表示在 HEAD 之前移动到提交。

将上次提交替换为新提交：

```
git commit --amend -m "message" 
```

它将用新的提交替换最后一次提交。

            回答 #41

赞同：61

时间：2015-08-11T14:11:14.850

就我而言，我提交并推送到了错误的分支，所以我想要恢复所有更改，以便我可以将它们提交到新的正确分支，所以我这样做了：
在您提交和推送的同一个分支上，如果您输入“git status”，您将看不到任何新内容，因为您已提交和推送，现在输入：

```
 git reset --soft HEAD~1 
```

这将使您的所有更改（文件）回到舞台区域，现在要将它们恢复到工作目录（unstage）中，您只需键入：

```
git reset FILE 
```

其中“文件”是您要再次提交的文件。现在，这个 FILE 应该在工作目录中（未暂存），其中包含您所做的所有更改。现在您可以更改到您想要的任何分支并在该分支中提交更改。当然，您提交的初始分支仍然存在所有更改，但在我的情况下没关系，如果它不适合您 - 您可以寻找在该分支中恢复该提交的方法。

            回答 #42

赞同：61

时间：2016-07-29T10:14:28.000

如果您正在使用**[SourceTree](https://www.sourcetreeapp.com/)**，这将对您有所帮助。

**右键单击**提交，然后**选择**“ *Reset (current branch)/master to this commit* ”，最后**选择**  *“Soft”reset*。

[![在此处输入图像描述](https://i.stack.imgur.com/BSMo2.png)](https://i.stack.imgur.com/BSMo2.png)

            回答 #43

赞同：58

时间：2017-05-07T01:01:06.270

假设您在本地进行了错误的提交并将其推送到远程存储库。您可以使用以下两个命令撤消混乱：

首先，我们需要通过返回到我们想要的提交来更正我们的本地存储库：

```
git reset --hard <previous good commit id where you want the local repository  to go> 
```

现在我们使用以下命令将这个好的提交强制推送到远程存储库：

```
git push --force-with-lease 
```

force 选项的“with-lease”版本将防止意外删除您不知道的新提交（即自上次拉取后来自另一个来源）。

            回答 #44

赞同：57

时间：2016-01-03T23:59:42.523

要撤消本地提交，请使用`git reset <commit>`. [该教程](https://www.atlassian.com/git/tutorials/undoing-changes/git-reset)也非常有助于向您展示它是如何工作的。

或者，您可以使用`git revert <commit>`: [reverting](https://www.atlassian.com/git/tutorials/undoing-changes/git-revert/)当您想要添加另一个回滚更改的提交时使用（但将它们保留在项目历史记录中）。

            回答 #45

赞同：51

时间：2016-04-26T21:35:53.467

**视觉工作室用户（2015 年等）**

如果您无法在 Visual Studio 中同步，因为您不允许推送到像“开发”这样的分支，那么正如我所尝试的那样，在 Visual Studio 中，**REVERT**或**RESET**（硬或软）都不会起作用。

根据大量投票的答案：

在项目根目录的命令提示符下使用它来消除任何试图被推送的东西：

```
git reset --hard HEAD~1 
```

备份或压缩文件以防万一您不希望丢失任何工作等...

            回答 #46

赞同：50

时间：2015-12-31T14:34:25.867

一个典型的 Git 循环
在谈到之前答案中与 Git 相关的命令时，我想与所有可能有帮助的读者分享我的典型 Git 周期。这是我使用 Git 的方式，

1.  第一次从远程服务器克隆

    `git clone $project`

2.  从远程拉取（当我没有待推的本地提交时）

    `git pull`

3.  将新的本地文件 1 添加到 $to_be_committed_list 中（想象一下 $to_be_committed_list 表示`staged`区域）

    `git add $file1`

4.  从 $to_be_committed_list 中删除错误添加的 file2 （假设 file2 像第 3 步一样添加，这是我不想要的）

    `git reset $file2`

5.  提交 $to_be_committed_list 中的 file1

    `git commit -m "commit message description"`

6.  在推送之前将本地提交与远程存储库同步

    `git pull --rebase`

7.  解决发生冲突时[的先决条件配置合并工具](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration)

    `git mergetool #resolve merging here, also can manually merge`

8.  添加解决冲突的文件，假设`file1`：

    `git add $file1`

9.  继续我之前的变基命令

    `git rebase --continue`

10.  推送就绪且已同步的最后一次本地提交

    `git push origin head:refs/for/$branch # branch = master, dev, etc.`

            回答 #47

赞同：50

时间：2020-01-07T00:26:01.780

每个人都以如此复杂的方式发表评论。
如果要从分支中删除最后一次提交，最简单的方法是：

```
git reset --hard HEAD~1 
```

现在要真正推动该更改以摆脱您的最后一次提交，您必须

```
git push --force 
```

就是这样。这将删除您的最后一次提交。

            回答 #48

赞同：48

时间：2020-06-17T09:32:22.430

在这些情况下，“reset”命令是你最好的朋友：

```
git reset --soft HEAD~1 
```

重置会将您当前的 HEAD 分支倒回到指定的修订版。在上面的示例中，我们希望返回到当前版本之前的版本——有效地使我们的最后一次提交撤消。

请注意 --soft 标志：这可确保保留未完成的修订中的更改。运行命令后，您会在工作副本中发现更改为未提交的本地修改。

如果您不想保留这些更改，只需使用 --hard 标志。确保仅在确定不再需要这些更改时才执行此操作。

```
git reset --hard HEAD~1 
```

            回答 #49

赞同：45

时间：2015-12-04T17:20:50.603

**删除已经推送到 Github 的错误提交**

```
git push origin +(previous good commit id):(branch name) 
```

请指定您想在 Github 中重置的最后一个良好的提交 ID。

例如。如果最新的提交 ID 错误，则在上面的 git 命令中使用分支名称指定上一个提交 ID。

您可以使用获取先前的提交 ID`git log`

            回答 #50

赞同：41

时间：2016-11-06T03:38:42.360

为了摆脱（所有更改）最后一次提交、最后 2 次提交和最后 n 次提交：

```
git reset --hard HEAD~1
git reset --hard HEAD~2
...
git reset --hard HEAD~n 
```

而且，要在特定提交后摆脱任何东西：

```
git reset --hard <commit sha> 
```

例如，

```
git reset --hard 0d12345 
```

小心使用 hard 选项：它也会删除你的 repo 中的本地更改并恢复到前面提到的提交。仅当您确定自己在上次提交中搞砸了并且想及时返回时，才应该运行此命令。
附带说明一下，提交哈希的大约 7 个字母就足够了，但在更大的项目中，您可能需要多达 12 个字母才能使其唯一。如果您愿意，也可以使用整个提交 SHA。
上述命令也适用于 Windows 的 GitHub。

            回答 #51

赞同：40

时间：2016-03-16T15:41:50.260

我从那里得到了提交 ID `bitbucket`，然后做了：

```
git checkout commitID . 
```

例子：

```
git checkout 7991072 . 
```

并将其恢复为该提交的工作副本。

            回答 #52

赞同：38

时间：2015-05-24T21:09:04.653

你需要做的简单快速

```
 git commit --amend 
```

如果它是私人分支机构或

```
 git commit -m 'Replace .class files with .java files' 
```

如果它是共享或公共分支。

            回答 #53

赞同：33

时间：2019-07-05T06:26:14.553

执行以下步骤。
**步骤1**
打`git log`
从日志列表中，找到最后一次提交的哈希码，然后输入：
**第2步**

```
git reset <hash code> 
```

            回答 #54

赞同：32

时间：2015-07-06T08:30:20.303

使用此命令

```
git checkout -b old-state 0d1d7fc32 
```

            回答 #55

赞同：31

时间：2016-12-27T18:42:51.433

使用这个命令：

```
git checkout -b old-state number_commit 
```

            回答 #56

赞同：30

时间：2015-12-10T07:17:15.357

您始终可以执行`git checkout <SHA code>`  以前的版本，然后使用新代码再次提交。

            回答 #57

赞同：29

时间：2017-08-02T08:58:34.197

您可以通过两种方式撤消 Git 提交：首先，您可以使用`git revert`，如果您想保留提交历史记录：

```
git revert HEAD~3
git revert <hashcode of commit> 
```

其次是你可以使用`git reset`，它会删除你所有的提交历史并把你的头带到你想要的地方。

```
git reset <hashcode of commit>
git reset HEAD~3 
```

`--hard`如果其中任何一个开始表现不同，您也可以使用该关键字。但是，我只会推荐它，直到它非常必要。

            回答 #58

赞同：29

时间：2019-03-11T07:19:44.820

```
git reset --soft HEAD~1 
```

重置会将您当前的 HEAD 分支倒回到指定的修订版。

**注意**标志：这确保保留未完成的`--soft`修订中的更改。运行命令后，您会在工作副本中发现更改为未提交的本地修改。

如果您不想保留这些更改，只需使用`--hard`标志。确保仅在确定不再需要这些更改时才执行此操作。

```
 git reset --hard HEAD~1 
```

撤消多个提交

```
git reset --hard 0ad5a7a6 
```

但是请记住，使用 reset 命令会撤消您返回到的提交之后的所有提交：

[![在此处输入图像描述](https://i.stack.imgur.com/slheG.png)](https://i.stack.imgur.com/slheG.png)

            回答 #59

赞同：26

时间：2016-12-15T16:21:28.530

我发现[这个](http://ohshitgit.com/)站点描述了如何撤消您已提交到存储库中的内容。

一些命令：

```
git commit --amend        # Change last commit
git reset HEAD~1 --soft   # Undo last commit 
```

            回答 #60

赞同：26

时间：2018-03-06T12:26:13.547

您可以从本地存储库撤消提交。请遵循以下场景。

在下图中，我检查了“测试”分支（使用 Git 命令`git checkout -b test`）作为本地分支，并检查`git status`本地分支的状态（使用 Git 命令）是否没有要提交的内容。

[![在此处输入图像描述](https://i.stack.imgur.com/kQ0Ds.png)](https://i.stack.imgur.com/kQ0Ds.png)

在下一张图片中，您可以在这里看到我在**Filter1.txt**中进行了一些更改，并将该文件添加到暂存区域，然后使用一些消息提交我的更改（使用 Git 命令`git commit -m "Doing commit to test revert back"`）。

**“-m 用于提交信息”**

[![在此处输入图像描述](https://i.stack.imgur.com/OpWzO.png)](https://i.stack.imgur.com/OpWzO.png)

在下一张图片中，您可以看到您的提交记录了您所做的任何提交（使用 Git 命令`git log`）。

[![在此处输入图像描述](https://i.stack.imgur.com/2keAh.png)](https://i.stack.imgur.com/2keAh.png)

因此，在上图中，您可以看到每次提交的提交 id 以及您的提交消息，无论您想要恢复什么提交或撤消复制该提交 id 并点击下面的 Git 命令，
 `git revert {"paste your commit id"}`. 例子：

```
git revert 9ca304ed12b991f8251496b4ea452857b34353e7 
```

[![在此处输入图像描述](https://i.stack.imgur.com/mi04t.png)](https://i.stack.imgur.com/mi04t.png)

我已经恢复了我的最后一次提交。现在，如果您检查您的 Git 状态，您可以看到已修改的文件**Filter1.txt**尚未提交。

[![在此处输入图像描述](https://i.stack.imgur.com/dfdMu.png)](https://i.stack.imgur.com/dfdMu.png)

            回答 #61

赞同：26

时间：2018-12-21T02:02:27.650

git reset --mixed、--soft 和--hard 的区别

先决条件：对存储库中的现有文件进行修改时，此更改最初被视为未暂存。为了提交更改，它需要暂存，这意味着使用`git add`. 在提交操作期间，暂存的文件被添加到索引中。

举个例子：

```
- A - B - C (master) 
```

`HEAD`指向`C`和索引匹配`C`。

- 柔软的

*   当我们执行**删除提交 C**并将**master/HEAD 指向 B**`git reset --soft B`的意图时。 *****   master/HEAD 现在将指向 B，但**索引仍然从 C 更改**。
*   执行时`git status`，您可以看到在**提交 C**中索引的文件为**staged**。
*   此时执行 a将创建一个与**C 具有相同更改**`git commit`的新提交**** ****## --混合

*   执行`git reset --mixed B`。

*   在执行时，master/HEAD 将指向 B，并且由于使用了混合标志  ，**索引也被修改以匹配 B。**

*   如果我们此时运行 git commit ，则不会发生任何事情，因为**索引匹配 HEAD**。

*   我们仍然在工作目录中有更改，但由于它们不在索引中，**git status 将它们显示为 unstaged**。

*   要提交它们，您需要`git add`然后像往常一样提交。

## - 难的

*   执行`git reset --hard B`

*   执行时，master/HEAD 将指向 B**并修改您的工作目录**

*   **在 C 中添加**的更改和**所有未提交的更改**将被**删除**。

*   工作副本中的文件将匹配提交 B，这将导致永久丢失提交 C 中所做的所有更改以及未提交的更改

希望这种可用于`git reset`命令的标志的比较将有助于人们明智地使用它们。有关详细信息，请参阅这些[链接 1](https://gist.github.com/tnguyen14/0827ae6eefdff39e452b)和[链接2](https://stackoverflow.com/questions/3528245/whats-the-difference-between-git-reset-mixed-soft-and-hard)

* * *

## 回答 #62

> 赞同：26
> 
>             
> 
> 时间：2018-02-28T08:34:58.993

这里是网站：[`Oh shit, git!`](http://ohshitgit.com/)。

这里有很多关于如何在 Git 中撤消操作的方法。他们中有一些：

> 哦，该死，我需要在上次提交时更改消息！

```
git commit --amend
# follow prompts to change the commit message 
```

> 哦该死，我不小心提交了一些应该在一个全新分支上的东西！

```
# Create a new branch from the current state of master
git branch some-new-branch-name
# Remove the commit from the master branch
git reset HEAD~ --hard
git checkout some-new-branch-name
# Your commit lives in this branch now :) 
```

* * *

## 回答 #63

> 赞同：25
> 
>             
> 
> 时间：2018-12-10T07:05:41.613

撤消最后一次提交的最简单方法是

```
git reset HEAD^ 
```

这将在您提交之前带来项目状态。

* * *

## 回答 #64

> 赞同：24
> 
>             
> 
> 时间：2020-11-22T13:38:12.297

为了从 Git 提交中删除一些文件，请使用带有“-soft”选项的“git reset”命令并在 HEAD 之前指定提交。

```
$ git reset --soft HEAD~1 
```

运行此命令时，您将看到最近提交 (HEAD) 中的文件，您将能够提交它们。

现在您的文件位于暂存区域，您可以再次使用“git reset”命令删除它们（或取消暂存）。

```
$ git reset HEAD <file> 
```

注意：这一次，您正在从 HEAD 重置，因为您只是想从暂存区域中排除文件

如果您对该文件不再感兴趣，可以使用“git rm”命令从索引（也称为暂存区）中删除该文件。

```
$ git rm --cached <file> 
```

完成修改后，您只需使用“–amend”选项再次提交更改即可。

```
$ git commit --amend 
```

要验证文件是否已从存储库中正确删除，您可以运行“git ls-files”命令并检查文件是否未出现在文件中（当然，如果它是新文件）

```
$ git ls-files

 <file1>
 <file2> 
```

### 使用 Git 还原从提交中删除文件

从 Git 2.23 开始，有一种从提交中删除文件的新方法，但您必须确保您使用的 Git 版本大于或等于 2.23。

```
$ git --version 
```

Git 版本 2.24.1

注意：Git 2.23 于 2019 年 8 月发布，您的计算机上可能还没有此版本。

要安装较新版本的 Git，您可以查看本教程。要从提交中删除文件，请使用“git restore”命令，使用“–source”选项指定源以及要从存储库中删除的文件。

例如，为了从 HEAD 中删除名为“myfile”的文件，您将编写以下命令

```
$ git restore --source=HEAD^ --staged  -- <file> 
```

例如，假设您在“master”分支上的最新提交中编辑了一个文件。

该文件已正确提交，但您想将其从 Git 存储库中删除。

要从 Git 存储库中删除您的文件，您首先要恢复它。

```
$ git restore --source=HEAD^ --staged  -- newfile

$ git status 
```

### 在分支“主人”上

您的分支领先于 'origin/master' 1 次提交。（使用“git push”发布你的本地提交）

要提交的更改：

```
 (use "git restore --staged <file>..." to unstage)
    modified:   newfile 
```

未为提交暂存的更改：

```
 (use "git add <file>..." to update what will be committed)
 (use "git restore <file>..." to discard changes in working directory)
      modified:   newfile 
```

如您所见，您的文件已回到暂存区。

从那里，您有两个选择，您可以选择编辑您的文件以便再次重新提交它，或者只是从您的 Git 存储库中删除它。

### 从 Git 存储库中删除文件

在本节中，我们将描述从 Git 存储库中删除文件的步骤。

首先，您需要取消暂存文件，因为如果已暂存，您将无法将其删除。

要取消暂存文件，请使用“git reset”命令并将 HEAD 指定为源。

```
$ git reset HEAD newfile 
```

当您的文件正确取消暂存时，使用带有“–cached”选项的“git rm”命令从 Git 索引中删除该文件（这不会删除磁盘上的文件）

```
$ git rm --cached newfile 
```

rm'新文件'

现在，如果您检查存储库状态，您将能够看到 Git 执行了删除提交。

```
$ git status 
```

### 在分支“主人”上

您的分支领先于 'origin/master' 1 次提交。（使用“git push”发布你的本地提交）

要提交的更改：

```
 (use "git restore --staged <file>..." to unstage)
    deleted:    newfile 
```

现在您的文件已暂存，只需使用“git commit”和“–amend”选项即可修改存储库中的最新提交。

```
`$ git commit --amend

 [master 90f8bb1] Commit from HEAD
  Date: Fri Dec 20 03:29:50 2019 -0500
  1 file changed, 2 deletions(-)
  delete mode 100644 newfile 
```

`如您所见，这不会创建新的提交，但它本质上会修改最近的提交以包含您的更改。

### 从 Git 提交中删除特定文件

在某些情况下，您不希望所有文件都被再次暂存：您只需要修改存储库中一个非常具体的文件。

为了从 Git 提交中删除特定文件，请使用带有“–soft”选项的“git reset”命令，指定 HEAD 之前的提交和要删除的文件。

```
$ git reset HEAD^ -- <file> 
```

完成修改后，您的文件将回到暂存区。

首先，您可以选择使用“git reset”命令从暂存区域中删除文件，并指定要从 HEAD 重置。

```
$ git reset HEAD <file> 
```

注意：这并不意味着您将丢失对此文件的更改，只是该文件将从暂存区中删除。

如果要从索引中完全删除文件，则必须使用带有“–cached”选项的“git rm”命令。

```
$ git reset HEAD <file> 
```

为了确保您的文件已正确地从暂存区域中删除，请使用“git ls-files”命令列出属于索引的文件。

```
$ git ls-files 
```

当您完全完成修改后，您可以使用带有“–amend”选项的“git commit”命令来修改您从中删除文件的提交。

```
$ git commit --amend 
```

* * *

## 回答 #65

> 赞同：22
> 
>             
> 
> 时间：2017-07-18T11:05:17.500

**头：**

在重置提交之前，我们应该了解 HEAD... HEAD 只不过是您在工作目录中的当前状态。它由提交号表示。

**Git 提交：**

在由唯一标记表示的提交下分配的每个更改。不能删除提交。因此，如果您想要最后一次提交，您可以简单地使用`git reset`.

您可以使用两种方法深入了解最后一次提交：

**方法1：（**如果您不知道提交号，但想移到第一个）

```
git reset HEAD~1  # It will move your head to last commit 
```

**方法 2：（**如果您知道提交，则只需将其重置为已知提交）

`git reset 0xab3`# 提交编号

**注意：**如果您想知道最近的提交，请尝试`git log -p -1`

这是图形表示：

[![在此处输入图像描述](https://i.stack.imgur.com/boiKO.png)](https://i.stack.imgur.com/boiKO.png)

* * *

## 回答 #66

> 赞同：22
> 
>             
> 
> 时间：2017-06-27T21:34:27.600

为了完整起见，我将给出一个明显被先前答案忽略的方法。

由于未推送提交，因此远程未更改，因此：

1.  删除本地存储库。

2.  克隆远程存储库。

如果您喜欢 Git 客户端再见，这有时是必要的。（例如`non-fast-forward`错误）

不要忘记重新提交自上次推送以来*保存的更改。*

* * *

## 回答 #67

> 赞同：22
> 
>             
> 
> 时间：2017-03-30T20:56:59.483

参考：[如何撤消 Git 中的最后一次提交？](https://web.archive.org/web/20210414042516/http://www.coding-issues.com/2017/03/how-to-undo-or-revert-last-commits-in-git.html)

如果您安装了 Git 扩展，您可以轻松撤消/恢复任何提交（您可以从[此处](https://gitextensions.github.io)下载 Git 扩展）。

打开 Git Extensions，右键单击要还原的提交，然后选择“还原提交”。

[![Git 扩展屏幕截图](https://i.stack.imgur.com/j2fK1.png)](https://i.stack.imgur.com/j2fK1.png)

将打开一个弹出窗口（请参见下面的屏幕截图）

[![恢复提交弹出窗口](https://i.stack.imgur.com/Skufo.jpg)](https://i.stack.imgur.com/Skufo.jpg)

如果您想直接提交恢复的更改，或者如果您想手动提交恢复的更改，请选择“自动创建提交”，保持未选中该框并单击“恢复此提交”按钮。

* * *

## 回答 #68

> 赞同：21
> 
>             
> 
> 时间：2016-05-29T14:21:17.433

只需用于`git reset --hard <last good SHA>`重置您的更改并提供新的提交。您也可以使用`git checkout -- <bad filename>`.

* * *

## 回答 #69

> 赞同：18
> 
>             
> 
> 时间：2018-05-22T23:52:17.443

当您希望在向公共分支等提出补丁时保持历史清洁有用时，重新设置和删除提交是最好的。

如果您必须放弃最顶层的提交，那么以下单行代码会有所帮助

```
git rebase --onto HEAD~1 HEAD 
```

但是如果你想放弃你确实说过的许多提交中的 1 个

a -> b -> c -> d -> 主

你想放弃提交'c'

```
git rebase --onto b c 
```

这将使'b'成为'd'消除'c'的新基础

* * *

## 回答 #70

> 赞同：18
> 
>             
> 
> 时间：2017-06-20T10:05:21.747

在 IntelliJ IDEA 中，您只需按`Alt`+打开 Git 存储库日志`9`，鼠标右键单击提交列表中的某个标签，然后选择：*“将当前分支重置到此处...”*。

* * *

## 回答 #71

> 赞同：18
> 
>             
> 
> 时间：2020-04-17T06:36:49.350

```
git reset --soft HEAD~1

git status 
```

### 输出

> 在分支 master
> 
> 上，您的分支领先于 'origin/master' 1 个提交。
> 
> （使用“git push”发布你的本地提交）
> 
> 要提交的更改：（
> 
> 使用“git restore --staged ...”取消暂存）新文件：file1

```
git log --oneline --graph 
```

### 输出

> *   90f8bb1 (HEAD -> master) 第二次提交 \
> 
> *   7083e29 初始存储库提交 \

* * *

## 回答 #72

> 赞同：18
> 
>             
> 
> 时间：2017-03-16T21:20:51.087

如果您想消除错误的文件，您应该这样做

`git reset --soft <your_last_good_commit_hash_here>`
在这里，如果您这样做`git status`，您将看到暂存区中的文件。您可以选择错误的文件并将它们从暂存区域中删除。

像下面这样。

`git reset wrongFile1 wrongFile2 wrongFile3`

你现在可以只添加你需要推送的文件，

`git add goodFile1 goodFile2`

提交他们

`git commit -v`或者`git commit -am "Message"`

并推

`git push origin master`

但是，如果您不关心更改的文件，您可以硬重置到以前的良好提交并将所有内容推送到服务器。

经过

```
git reset --hard <your_last_good_commit_hash_here> 
```

`git push origin master`

如果您已经将错误的文件发布到服务器，您可以使用该`--force`标志推送到服务器并编辑历史记录。

 `git push --force origin master`

* * *

## 回答 #73

> 赞同：17
> 
>             
> 
> 时间：2020-07-31T06:18:58.220

我验证了一种有效的方法，这是一个使用它的具体示例：

如果您想永久撤消/取消您的最后一次提交（依此类推，一个一个，任意多个）三个步骤：

1：当然，获取您想要到达的提交的 id = SHA

```
$ git log 
```

2：删除你以前的提交

```
$ git reset --hard 'your SHA' 
```

3：使用选项强制将新的本地历史记录到您的源 GitHub 上`-f`（最后的提交轨道将从 GitHub 历史记录中删除）

```
$ git push origin master -f 
```

### 例子

```
$ git log 
```

最后一次提交取消

```
commit e305d21bdcdc51d623faec631ced72645cca9131 (HEAD -> master, origin/master, origin/HEAD)
Author: Christophe <blabla@bla.com>
Date:   Thu Jul 30 03:42:26 2020 +0200

U2_30 S45; updating files package.json & yarn.lock for GitHub Web Page from docs/CV_Portfolio... 
```

提交我们现在想要的 HEAD

```
commit 36212a48b0123456789e01a6c174103be9a11e61
Author: Christophe <blabla@bla.com>
Date:   Thu Jul 30 02:38:01 2020 +0200

First commit, new title 
```

### 通过删除最后一个到达之前的提交

```
$ git reset --hard 36212a4

HEAD is now at 36212a4 First commit, new title 
```

### 检查没问题

```
$ git log

commit 36212a48b0123456789e01a6c174103be9a11e61 (HEAD -> master)
Author: Christophe <blabla@bla.com>
Date:   Thu Jul 30 02:38:01 2020 +0200

    First commit, new title

$ git status

On branch master
Your branch is behind 'origin/master' by 1 commit, and can be fast-forwarded.
 (use "git pull" to update your local branch)

nothing to commit, working tree clean 
```

### 在 Git(Hub) 上更新您的历史记录

```
$ git push origin master -f

Total 0 (delta 0), reused 0 (delta 0), pack-reused 0
To https://github.com/ GitUser bla bla/React-Apps.git
 + e305d21...36212a4 master -> master (forced update) 
```

### 检查一切正常

```
$ git status

On branch master
Your branch is up to date with 'origin/master'.

nothing to commit, working tree clean 
```

* * *

## 回答 #74

> 赞同：16
> 
>             
> 
> 时间：2021-10-05T13:26:47.930

### 撤消一系列本地提交

> OP：如何撤消 Git 中最近的本地提交？我不小心提交了错误的文件 [作为几个提交的一部分]。

#### 开始案例

有几种方法可以“撤消”作为一系列提交，具体取决于您所追求的结果。考虑下面的开始情况`reset`，`rebase`和`filter-branch`都可以用来重写你的历史。

[![明星案例](https://i.stack.imgur.com/CtqYJ.png)](https://i.stack.imgur.com/CtqYJ.png)

***如何撤消*C1*和*C2*`tmp.log`以从每次提交中删除文件？***

在下面的示例中，使用了绝对提交引用，但如果您更习惯于相对引用（即`HEAD~2`或`HEAD@{n}`），它的工作方式相同。

#### 备选方案 1：`reset`

```
$ git reset --soft t56pi 
```

[![使用重置](https://i.stack.imgur.com/UEmaO.png)](https://i.stack.imgur.com/UEmaO.png)

使用`reset`，可以将分支重置为先前的状态，并将任何复合更改还原到*暂存区域*，然后可以丢弃任何不需要的更改。

**注意：**由于`reset`将所有先前的更改聚集到*Staging Area*中，单个提交元数据会丢失。如果这对您不利，那么您可能会`rebase`更好`filter-branch`。

#### 备选方案 2：`rebase`

```
$ git rebase --interactive t56pi 
```

[![使用变基](https://i.stack.imgur.com/h4IuR.png)](https://i.stack.imgur.com/h4IuR.png)

使用交互式`rebase`每个分支中的违规提交都可以重写，允许您修改和丢弃不需要的更改。在上面的信息图中，右侧的源代码树说明了 state post `rebase`。

**一步步**

1.  选择 rebase 应该基于哪个提交（例如`t56pi`）

2.  `pick`通过替换为选择您想要更改的提交`edit`。保存并关闭。

3.  Git 现在将在每个选定的提交上停止，允许您重置`HEAD`、删除不需要的文件并创建全新的提交。

**注意：**与上面的替代方案`rebase`相比，保留了大部分提交元数据。`reset`如果您想保留大部分历史记录但只删除不需要的文件，这很可能是首选选项。

#### 备选方案 3：`filter-branch`

```
$ git filter-branch --tree-filter 'rm -r ./tmp.log' t56pi..HEAD 
```

`./tmp.log`上面的命令将从所需范围内的所有提交中过滤掉文件`t56pi..HEAD`（假设我们从上面开始的初始情况）。为清楚起见，请参见下图。

[![使用过滤器分支](https://i.stack.imgur.com/K0CSV.png)](https://i.stack.imgur.com/K0CSV.png)

类似于`rebase`,`filter-branch`可用于从分支的子部分擦除不需要的文件。无需通过变基过程手动编辑每个提交，而是`filter-branch`可以在每个提交上自动执行所需的操作。

**注意：**就像`rebase`,`filter-branch`将保留提交元数据的其余部分，仅丢弃所需的文件。请注意*C1*和*C2*是如何被重写的，并且每次提交都丢弃了日志文件。

#### 结论

就像与软件开发相关的任何事情一样，有多种方法可以针对给定问题实现相同（或相似）的结果。您只需要选择最适合您的特定情况的一种。

#### 最后 - 一个友好的建议

请注意，上述所有三个替代方案都完全重写了历史记录。除非您确切地知道自己在做什么并且在团队中进行良好的沟通 - 只重写尚未远程发布的提交！

***资料来源：***以上所有示例均来自此[博客](https://blog.git-init.com/)。

* * *

## 回答 #75

> 赞同：16
> 
>             
> 
> 时间：2021-09-26T17:50:46.827

在回答之前，让我们添加一些背景，解释这`HEAD`是什么。

# ***`First of all what is HEAD?`***

`HEAD`只是对当前分支上的当前提交（最新）的引用。在任何给定时间

只能有一个（不包括）。`HEAD``git worktree`

的内容`HEAD`存储在里面`.git/HEAD`，它包含当前提交的 40 字节 SHA-1。

* * *

# ***`detached HEAD`***

如果您不在最新的提交上 - 意思`HEAD`是指向历史上的先前提交，则称为***`detached HEAD`***.

[![在此处输入图像描述](https://i.stack.imgur.com/OlavO.png)](https://i.stack.imgur.com/OlavO.png)

在命令行上，它看起来像这样 - SHA-1 而不是分支名称，因为`HEAD`它没有指向当前分支的尖端：

[![在此处输入图像描述](https://i.stack.imgur.com/qplvo.png)](https://i.stack.imgur.com/qplvo.png)

[![在此处输入图像描述](https://i.stack.imgur.com/U0l3s.png)](https://i.stack.imgur.com/U0l3s.png)

* * *

### 关于如何从分离的 HEAD 中恢复的一些选项：

* * *

### [`git checkout`](https://git-scm.com/docs/git-checkout)

```
git checkout <commit_id>
git checkout -b <new branch> <commit_id>
git checkout HEAD~X // x is the number of commits to go back 
```

这将签出指向所需提交的新分支。

此命令将检出给定的提交。

此时，您可以创建一个分支并从这一点开始工作。

```
# Checkout a given commit.
# Doing so will result in a `detached HEAD` which mean that the `HEAD`
# is not pointing to the latest so you will need to checkout branch
# in order to be able to update the code.
git checkout <commit-id>

# Create a new branch forked to the given commit
git checkout -b <branch name> 
```

* * *

### [`git reflog`](https://git-scm.com/docs/git-reflog)

您也可以随时使用`reflog`。

`git reflog` 将显示更新的任何更改，`HEAD`并检查所需的 reflog 条目将设置`HEAD`回此提交。

**每次修改 HEAD 都会在`reflog`**

```
git reflog
git checkout HEAD@{...} 
```

这将使您回到所需的提交

[![在此处输入图像描述](https://i.stack.imgur.com/atW9w.png)](https://i.stack.imgur.com/atW9w.png)

* * *

### ***[`git reset --hard <commit_id>`](https://git-scm.com/docs/git-reset)***

将您的 HEAD “移动”回所需的提交。

```
# This will destroy any local modifications.
# Don't do it if you have uncommitted work you want to keep.
git reset --hard 0d1d7fc32

# Alternatively, if there's work to keep:
git stash
git reset --hard 0d1d7fc32
git stash pop
# This saves the modifications, then reapplies that patch after resetting.
# You could get merge conflicts if you've modified things which were
# changed since the commit you reset to. 
```

*   注意：（[从 Git 2.7 开始](https://github.com/git/git/blob/master/Documentation/RelNotes/2.7.0.txt)）你也可以使用`git rebase --no-autostash`。

[![在此处输入图像描述](https://i.stack.imgur.com/iyaGj.png)](https://i.stack.imgur.com/iyaGj.png)

* * *

### ***[`git revert <sha-1>`](https://git-scm.com/docs/git-revert)***

“撤消”给定的提交或提交范围。

重置命令将“撤消”在给定提交中所做的任何更改。

将提交带有撤消补丁的新提交，而原始提交也将保留在历史记录中。

```
# Add a new commit with the undo of the original one.
# The <sha-1> can be any commit(s) or commit range
git revert <sha-1> 
```

* * *

这个模式说明了哪个命令做什么。

如您所见，`reset && checkout`修改`HEAD`.

[![在此处输入图像描述](https://i.stack.imgur.com/NuThL.png)](https://i.stack.imgur.com/NuThL.png)

* * *

## 回答 #76

> 赞同：16
> 
>             
> 
> 时间：2019-10-23T09:19:37.753

要撤消最后一次本地提交，而不丢弃其更改，我有这个方便的别名`~/.gitconfig`

```
[alias]
  undo = reset --soft HEAD^ 
```

然后我简单地使用`git undo`它是超级容易记住的。

* * *

## 回答 #77

> 赞同：15
> 
>             
> 
> 时间：2017-06-03T19:32:16.893

通过查看日志找到最后一次提交的哈希码：

```
git log 
```

然后

```
git reset <the previous co> 
```

* * *

## 回答 #78

> 赞同：14
> 
>             
> 
> 时间：2018-09-16T08:36:23.923

每次我需要撤消提交/提交时我会做的是：

1.  `git reset HEAD~<n>`  // 我需要撤消的最后一次提交的数量

2.  `git status`// 可选的。所有文件现在都显示为红色（未暂存）。

3.  现在，我可以只添加和提交我需要的文件：

*   `git add <file names> & git commit -m "message" -m "details"`

4.  可选：如果需要，我可以通过结帐将其余文件的更改回滚到以前的状态：

*   `git checkout <filename>`

5.  如果我之前已经将其推送到远程源：

*   `git push origin <branch name> -f`// 使用 -f 强制推送。

* * *

## 回答 #79

> 赞同：14
> 
>             
> 
> 时间：2016-11-15T21:07:52.260

[![在此处输入图像描述](https://i.stack.imgur.com/ueFVY.png)](https://i.stack.imgur.com/ueFVY.png)

假设您在 Visual Studio 中工作，如果您进入分支历史记录并查看所有提交，只需选择要撤消的提交之前的事件，右键单击它，然后选择`Revert`. 就这么简单。

* * *

## 回答 #80

> 赞同：13
> 
>             
> 
> 时间：2019-02-10T21:25:37.353

替换您的本地版本，包括您对服务器版本所做的更改。这两行代码将强制 Git 拉取并覆盖本地。

打开命令提示符并导航到 Git 项目根目录。如果您使用 Visual Studio，请单击*Team*、*Sync*并单击下面的“打开命令提示符”（见图）。

[![视觉工作室](https://i.stack.imgur.com/sezIw.png)](https://i.stack.imgur.com/sezIw.png)

进入 Cmd 提示符后，继续执行以下两个指令。

```
git fetch --all 
```

然后你做

```
git reset --hard origin/master 
```

这将用 Git 服务器上的本地版本覆盖现有的本地版本。

* * *

## 回答 #81

> 赞同：12
> 
>             
> 
> 时间：2018-04-17T15:41:15.010

试试这个，硬重置到未添加这些文件的先前提交，然后：

```
git reset --hard <commit_hash> 
```

确保备份更改以防万一，因为这是硬重置，这意味着它们会丢失（除非你之前隐藏了）

* * *

## 回答 #82

> 赞同：12
> 
>             
> 
> 时间：2019-07-08T15:20:23.000

在我自己遇到同样的问题之后，我在很久以前写过这个：

*[如何删除/恢复 Git 提交](https://ao.ms/how-to-delete-revert-a-git-commit/)*

基本上你只需要这样做：

`git log`，获取 SHA 哈希的前七个字符，然后执行 a`git revert <sha>`后跟`git push --force`.

您也可以使用 Git revert 命令恢复它，如下所示：`git revert <sha> -m -1`然后`git push`.

* * *

## 回答 #83

> 赞同：11
> 
>             
> 
> 时间：2018-09-24T11:58:21.127

## 如果您想撤消仓库中的第一次提交

你会遇到这个问题：

```
$ git reset HEAD~
fatal: ambiguous argument 'HEAD~': unknown revision or path not in the working tree.
Use '--' to separate paths from revisions, like this:
'git <command> [<revision>...] -- [<file>...]' 
```

发生错误是因为如果最后一次提交是存储库的初始提交（或没有父级），则没有 HEAD~。

## 解决方案

**如果你想重置“master”分支上的唯一提交**

```
$ git update-ref -d HEAD
$ git rm --cached -r . 
```

* * *

## 回答 #84

> 赞同：10
> 
>             
> 
> 时间：2018-11-29T20:44:46.720

如果您只是想丢弃所有本地更改/提交并使您的本地分支看起来像您开始的原始分支......

```
git reset --hard origin/branch-name 
```

* * *

## 回答 #85

> 赞同：10
> 
>             
> 
> 时间：2018-11-12T00:49:14.060

使用此命令获取最后一次提交 ID（在顶部的日志中是最新的）：

```
git log 
```

获取提交 ID (GUID) 并运行以下命令：

```
git revert <commit_id> 
```

* * *

## 回答 #86

> 赞同：8
> 
>             
> 
> 时间：2019-05-23T09:52:15.273

您可以使用`git revert <commit-id>`.

而要获取提交 ID，只需使用`git log`.

* * *

## 回答 #87

> 赞同：8
> 
>             
> 
> 时间：2018-09-27T13:12:11.097

### 如何*编辑*较早的提交

一般来说，我不想撤销一堆提交，而是编辑一个较早的提交，以我希望我首先提交它的方式。

我发现自己经常修复过去的提交，以至于我为它编写了一个脚本。

这是工作流程：

1.  ```
    git commit-edit <commit-hash> 
    ```

    这将使您进入要编辑的提交。

    提交的更改将**取消**暂存，准备好按您希望的第一次暂存。

2.  修复并按您希望的方式暂存提交。

    （您可能想用来`git stash save --keep-index`存储您未提交的任何文件）

3.  用 重做提交`--amend`，例如：

    ```
    git commit --amend 
    ```

4.  完成变基：

    ```
    git rebase --continue 
    ```

* * *

调用以下内容`git-commit-edit`并将其放入您的`$PATH`：

```
#!/bin/bash

# Do an automatic git rebase --interactive, editing the specified commit
# Revert the index and working tree to the point before the commit was staged
# https://stackoverflow.com/a/52324605/5353461

set -euo pipefail

script_name=${0##*/}

warn () { printf '%s: %s\n' "$script_name" "$*" >&2; }
die () { warn "$@"; exit 1; }

[[ $# -ge 2 ]] && die "Expected single commit to edit. Defaults to HEAD~"

# Default to editing the parent of the most recent commit
# The most recent commit can be edited with `git commit --amend`
commit=$(git rev-parse --short "${1:-HEAD~}")

# Be able to show what commit we're editing to the user
if git config --get alias.print-commit-1 &>/dev/null; then
  message=$(git print-commit-1 "$commit")
else
  message=$(git log -1 --format='%h %s' "$commit")
fi

if [[ $OSTYPE =~ ^darwin ]]; then
  sed_inplace=(sed -Ei "")
else
  sed_inplace=(sed -Ei)
fi

export GIT_SEQUENCE_EDITOR="${sed_inplace[*]} "' "s/^pick ('"$commit"' .*)/edit \\1/"'
git rebase --quiet --interactive --autostash --autosquash "$commit"~
git reset --quiet @~ "$(git rev-parse --show-toplevel)"  # Reset the cache of the toplevel directory to the previous commit
git commit --quiet --amend --no-edit --allow-empty  #  Commit an empty commit so that that cache diffs are un-reversed

echo
echo "Editing commit: $message" >&2
echo 
```

* * *

## 回答 #88

> 赞同：7
> 
>             
> 
> 时间：2018-09-03T13:19:28.480

```
git revert commit 
```

这将从您想要恢复的提交中生成相反的更改，然后只需提交该更改。我认为这是最简单的方法。

[https://git-scm.com/docs/git-revert](https://git-scm.com/docs/git-revert)

* * *

## 回答 #89

> 赞同：6
> 
>             
> 
> 时间：2021-01-01T21:47:17.767

我通常首先找到我最近提交的提交哈希：

```
git log 
```

它看起来像这样：`commit {long_hash}`

复制`long_hash`并重置它（返回到该提交时的相同文件/状态）：

```
git reset --hard {insert long_hash without braces} 
```

* * *

## 回答 #90

> 赞同：6
> 
>             
> 
> 时间：2020-09-03T19:44:51.150

```
$ git commit -m 'Initial commit'
$ git add forgotten_file
$ git commit --amend 
```

重要的是要了解，当您修改上一次提交时，与其说是修复它，不如说是用一个新的、改进的提交完全替换它，将旧的提交推到一边，并把新的提交放在它的位置上。实际上，就好像以前的提交从未发生过，并且它不会显示在您的存储库历史记录中。

修改提交的明显价值是对您的上次提交进行微小的改进，而不会因为“糟糕，忘记添加文件”或“该死，修复上次提交中的错字”等形式的提交消息而使您的存储库历史变得混乱。

*[2.4 Git 基础——撤消操作](https://git-scm.com/book/en/v2/Git-Basics-Undoing-Things)*

* * *

## 回答 #91

> 赞同：5
> 
>             
> 
> 时间：2021-07-16T05:16:20.200

```
#1) $ git commit -m "Something terribly misguided" 
#2) $ git reset HEAD~ 
```

[根据需要编辑文件]

```
 #3) $ git add .
#4) $ git commit -c ORIG_HEAD 
```

* * *

## 回答 #92

> 赞同：4
> 
>             
> 
> 时间：2021-06-11T21:58:37.820

Visual Studio Code 使这变得非常容易。

[![VS 代码](https://i.stack.imgur.com/QXTef.png)](https://i.stack.imgur.com/QXTef.png)

* * *

## 回答 #93

> 赞同：4
> 
>             
> 
> 时间：2020-11-17T07:50:22.097

`git reset HEAD@{n}`将重置您最近的*n 个*操作。

对于重置，对于最后一个操作，使用`git reset HEAD@{1}`.

* * *

## 回答 #94

> 赞同：4
> 
>             
> 
> 时间：2018-05-18T07:00:35.230

```
git push --delete (branch_name) //this will be removing the public version of your branch

git push origin (branch_name) //This will add the previous version back 
```

* * *

## 回答 #95

> 赞同：4
> 
>             
> 
> 时间：2021-01-06T14:42:36.147

如果存储库已在本地提交且尚未推送到服务器，则另一种粗略/外行的解决方法是：

1.  Git 将存储库克隆到另一个位置。

2.  将原始存储库中的修改（文件/目录）复制到这个新存储库中。然后提交并推送新的更改。

3.  用这个新的替换旧的存储库。

* * *

## 回答 #96

> 赞同：2
> 
>             
> 
> 时间：2021-05-26T07:14:05.547

首先，运行此命令以重置*提交*：

```
git reset --hard HEAD~1 
```

其次，运行这个命令来推送新的*提交*：

```
git push upstream head -f 
```

* * *

## 回答 #97

> 赞同：1
> 
>             
> 
> 时间：2021-11-25T11:15:48.613

**如果您想恢复到最后一次提交并删除日志历史记录**

使用下面的命令，假设您想转到具有 commitID SHA - **71e2e57458bde883a37b332035f784c6653ec509**
的上一个提交，您可以指向此提交，在此提交之后它不会显示任何日志消息，之后所有历史记录都将被删除。

**git 推送来源 +71e2e57458bde883a37b332035f784c6653ec509^:master**

* * *

## 回答 #98

> 赞同：1
> 
>             
> 
> 时间：2021-06-04T18:00:40.197

您可以将该`git reset unwanted_file`命令与您不想暂存的文件一起使用。通过使用此命令，我们可以将更改的文件从暂存区移动到工作目录。

*[如何在本地和远程撤消 Git 中的提交？](https://codeburst.io/how-to-undo-commits-in-git-locally-remotely-10078152c239)*

# java - JDialog打开时如何暂停执行

> ID：927364
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T18:11:08.947
> 
>         
> 
> 标签：java, swing

当我打开自定义 JDialog 并关闭对话框以再次继续时，如何让我的应用程序暂停。

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-05-29T18:14:22.980

只需使用：

```
setModal(true); 
```

我通常从`JDialog`.

请参阅`setModal(boolean)`. 

[http://java.sun.com/javase/6/docs/api/java/awt/Dialog.html#setModal(boolean)](http://java.sun.com/javase/6/docs/api/java/awt/Dialog.html#setModal(boolean))

这将导致执行在当前线程上阻塞，直到对话框关闭。

或者，您可以使用：

```
setModalityType(Dialog.DEFAULT_MODALITY_TYPE); 
```

它等同于`setModal(true)`并且在技术上是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:16:35.580

[请参阅JDialog](https://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JDialog.html#JDialog(java.awt.Dialog,%20java.lang.String,%20boolean))的构造函数。您可以设置此对话框的**模式**。设置 modal=true 将暂停您的应用程序。您也可以使用[setModal](https://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Dialog.html#setModal(boolean))方法。

# google-gadget - 谷歌小工具刷新

> ID：927369
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:11:29.240
> 
>         
> 
> 标签：google-gadget

我正在创建一个测试 Google 小工具。它是一个简单的 hello world 小工具。但是，在我第一次将小工具添加到 iGoogle 之后，我对服务器上的文件所做的任何后续更改都不会影响小工具！如果我更改 xml 文件的名称然后读取它，那么我会看到更改。但是，再多的更改、删除和重新添加小工具都不会影响我在服务器上的任何修改。有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
>             
> 
> 时间：2009-06-30T09:44:21.537

[http://www.google.com/ig/modules/developer.xml](http://www.google.com/ig/modules/developer.xml)
添加该小工具，然后关闭测试小工具的缓存

# ruby-on-rails - 使用 Rails 应用程序强制域的最佳方法是什么？例如：example.com 而不是 www.example.com

> ID：927382
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:13:25.853
> 
>         
> 
> 标签：ruby-on-rails, apache

我的 rails 应用程序在 www.example.com 上回答时似乎崩溃了，以前它只在 example.com 上运行良好......但是我最近移动了服务器，想知道重定向所有 www.example 的最佳方式.com 请求访问[http://example.com/.../](http://example.com/.../)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:51:58.337

这应该可以解决问题，假设您启用了 mod_rewrite

```
 RewriteEngine on

    RewriteCond %{HTTP_HOST} ^www.example\.com
    RewriteRule ^(.*)$ http://example.com$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:17:41.647

这取决于您的服务器设置，并且有不同的方法。您可以在 DNS 中将 www 命名为根域，这是一种方式。如果您在 Apache 后面运行 Rails，那么您可以在 Apache 中使用 mod_rewrite 执行此操作。如果您使用例如 mongrel（或 webbrick）将网络请求直接发送到 Rails，那么您可能必须配置这些服务器，或者可能必须使用 Rails 路由？

希望有帮助，

网络

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:37:15.413

根据[Apache 的基于名称的虚拟主机文档](http://httpd.apache.org/docs/2.2/vhosts/name-based.html)，第一个虚拟主机是默认主机。我使用它来使第一个条目成为一个包罗万象的条目，将每个“未定义”请求重定向到主站点：

```
# Default catch-all
<VirtualHost *:80>
    # Note the lack of a ServerName
    RewriteRule ^(.*)$ http://www.example.com$1 [redirect=permanent]
</VirtualHost>

# Site 1 - www.example.com
<VirtualHost *:80>
    ServerName www.example.com

  [ the rest of the site config ]

</VirtualHost> 
```

对于额外的信用，您可以设置一个通配符 DNS 条目，以便每个未定义的主机（例如 asdfasdfasdfas.example.com）都被重定向到 www.example.com。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T11:54:50.870

您可能不想听到它，但我建议修复中断的内容。您已经在应用程序的某个位置（可能在您的路由中）对您的域进行了硬编码，但是如果没有错误的具体情况就无法判断，您需要将其删除，以便您或其他一些维护者不会将来必须再次处理它。

# c# - C# 网格数据源多态性

> ID：927383
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T18:13:32.420
> 
>         
> 
> 标签：c#, winforms, datagridview

我有一个网格，我将其设置`DataSource`为`List<IListItem>`. 我想要的是让列表绑定到基础类型，并显示这些属性，而不是`IListItem`. 所以：

```
public interface IListItem
{
    string Id;
    string Name;
}

public class User : IListItem
{
    string Id { get; set; };
    string Name { get; set; };
    string UserSpecificField { get; set; };
}

public class Location : IListItem
{
    string Id { get; set; };
    string Name { get; set; };
    string LocationSpecificField { get; set; };
} 
```

如何绑定到网格，以便如果我`List<IListItem>`包含用户，我将看到特定于用户的字段？编辑：请注意，我想绑定到 Datagrid 的任何给定列表都将由一个基础类型组成。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-06-05T07:49:58.507

对列表的数据绑定遵循以下策略：

1.  数据源是否实现`IListSource`？如果是这样，转到 2，结果为`GetList()`

2.  数据源是否实现`IList`？如果不是，则抛出错误；预期清单

3.  数据源是否实现`ITypedList`？如果是这样，将其用于元数据（退出）

4.  数据源是否有非对象索引器`public Foo this[int index]`（对于某些`Foo`）？如果是这样，`typeof(Foo)`用于元数据

5.  清单上有什么吗？如果是这样，请使用第一项 ( `list[0]`) 作为元数据

6.  没有可用的元数据

`List<IListItem>`属于上面的“4”，因为它有一个类型为类型的索引器`IListItem`- 因此它将通过`TypeDescriptor.GetProperties(typeof(IListItem))`.

所以现在，你有三个选择：

*   写一个`TypeDescriptionProvider`返回属性的`IListItem`- 我不确定这是否可行，因为你不可能知道具体类型是什么`IListItem`

*   使用正确类型的列表（`List<User>`等） - 只是作为获取`IList`非对象索引器的简单方法

*   写一个`ITypedList`包装器（很多工作）

*   使用类似的东西`ArrayList`（即没有公共的非对象索引器） - 非常hacky！

我的偏好是使用正确的类型`List<>`......这是一种**无需知道类型**（使用示例）即可`AutoCast`为您执行此操作的方法；

 **请注意，这只适用于同质数据（即所有对象都相同），并且它需要列表中至少有一个对象来推断类型...

```
// infers the correct list type from the contents
static IList AutoCast(this IList list) {
    if (list == null) throw new ArgumentNullException("list");
    if (list.Count == 0) throw new InvalidOperationException(
          "Cannot AutoCast an empty list");
    Type type = list[0].GetType();
    IList result = (IList) Activator.CreateInstance(typeof(List<>)
          .MakeGenericType(type), list.Count);
    foreach (object obj in list) result.Add(obj);
    return result;
}
// usage
[STAThread]
static void Main() {
    Application.EnableVisualStyles();
    List<IListItem> data = new List<IListItem> {
        new User { Id = "1", Name = "abc", UserSpecificField = "def"},
        new User { Id = "2", Name = "ghi", UserSpecificField = "jkl"},
    };
    ShowData(data, "Before change - no UserSpecifiedField");
    ShowData(data.AutoCast(), "After change - has UserSpecifiedField");
}
static void ShowData(object dataSource, string caption) {
    Application.Run(new Form {
        Text = caption,
        Controls = {
            new DataGridView {
                Dock = DockStyle.Fill,
                DataSource = dataSource,
                AllowUserToAddRows = false,
                AllowUserToDeleteRows = false
            }
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-06-02T16:12:37.653

只要您确定 List<IListItem> 的成员都将属于相同的派生类型，那么这里就是如何做到这一点，并带有“在我的机器上工作”的批准印章。

首先，下载[BindingListView](http://blw.sourceforge.net/)，它可以让您将通用列表绑定到您的 DataGridViews。

对于这个示例，我只是使用 DataGridView 制作了一个简单的表单，并随机调用代码以在 Form1_Load() 中加载用户或位置列表。

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using Equin.ApplicationFramework;

namespace DGVTest
{
    public interface IListItem
    {
        string Id { get; }
        string Name { get; }
    }

    public class User : IListItem
    {
        public string UserSpecificField { get; set; }
        public string Id { get; set; }
        public string Name { get; set; }
    }

    public class Location : IListItem
    {
        public string LocationSpecificField { get; set; }
        public string Id { get; set; }
        public string Name { get; set; }
    }

    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void InitColumns(bool useUsers)
        {
            if (dataGridView1.ColumnCount > 0)
            {
                return;
            }

            DataGridViewCellStyle gridViewCellStyle = new DataGridViewCellStyle();

            DataGridViewTextBoxColumn IDColumn = new DataGridViewTextBoxColumn();
            DataGridViewTextBoxColumn NameColumn = new DataGridViewTextBoxColumn();
            DataGridViewTextBoxColumn DerivedSpecificColumn = new DataGridViewTextBoxColumn();

            IDColumn.DataPropertyName = "ID";
            IDColumn.HeaderText = "ID";
            IDColumn.Name = "IDColumn";

            NameColumn.DataPropertyName = "Name";
            NameColumn.HeaderText = "Name";
            NameColumn.Name = "NameColumn";

            DerivedSpecificColumn.DataPropertyName = useUsers ? "UserSpecificField" : "LocationSpecificField";
            DerivedSpecificColumn.HeaderText = "Derived Specific";
            DerivedSpecificColumn.Name = "DerivedSpecificColumn";

            dataGridView1.Columns.AddRange(
                new DataGridViewColumn[]
                    {
                        IDColumn,
                        NameColumn,
                        DerivedSpecificColumn
                    });

            gridViewCellStyle.SelectionBackColor = Color.LightGray;
            gridViewCellStyle.SelectionForeColor = Color.Black;
            dataGridView1.RowsDefaultCellStyle = gridViewCellStyle;
        }

        public static void BindGenericList<T>(DataGridView gridView, List<T> list)
        {
            gridView.DataSource = new BindingListView<T>(list);
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            dataGridView1.AutoGenerateColumns = false;

            Random rand = new Random();

            bool useUsers = rand.Next(0, 2) == 0;

            InitColumns(useUsers);

            if(useUsers)
            {
                TestUsers();
            }
            else
            {
                TestLocations();
            }

        }

        private void TestUsers()
        {
            List<IListItem> items =
                new List<IListItem>
                    {
                        new User {Id = "1", Name = "User1", UserSpecificField = "Test User 1"},
                        new User {Id = "2", Name = "User2", UserSpecificField = "Test User 2"},
                        new User {Id = "3", Name = "User3", UserSpecificField = "Test User 3"},
                        new User {Id = "4", Name = "User4", UserSpecificField = "Test User 4"}
                    };

            BindGenericList(dataGridView1, items.ConvertAll(item => (User)item));
        }

        private void TestLocations()
        {
            List<IListItem> items =
                new List<IListItem>
                    {
                        new Location {Id = "1", Name = "Location1", LocationSpecificField = "Test Location 1"},
                        new Location {Id = "2", Name = "Location2", LocationSpecificField = "Test Location 2"},
                        new Location {Id = "3", Name = "Location3", LocationSpecificField = "Test Location 3"},
                        new Location {Id = "4", Name = "Location4", LocationSpecificField = "Test Location 4"}
                    };

            BindGenericList(dataGridView1, items.ConvertAll(item => (Location)item));
        }
    }
} 
```

重要的代码行如下：

```
DerivedSpecificColumn.DataPropertyName = useUsers ? "UserSpecificField" : "LocationSpecificField"; // obviously need to bind to the derived field

public static void BindGenericList<T>(DataGridView gridView, List<T> list)
{
    gridView.DataSource = new BindingListView<T>(list);
}

dataGridView1.AutoGenerateColumns = false; // Be specific about which columns to show 
```

最重要的是这些：

```
BindGenericList(dataGridView1, items.ConvertAll(item => (User)item));
BindGenericList(dataGridView1, items.ConvertAll(item => (Location)item)); 
```

如果已知列表中的所有项目都属于某个派生类型，则只需调用 ConvertAll 将它们强制转换为该类型。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:27:21.597

为此，您需要使用 Grid 模板列。在模板字段中，您需要检查对象的类型，然后获取正确的属性 - 我建议在您的代码隐藏中创建一个方法来处理这个问题。因此：

```
<asp:TemplateField HeaderText="PolymorphicField">
    <ItemTemplate>
        <%#GetUserSpecificProperty(Container.DataItem)%>
    </ItemTemplate>
</asp:TemplateField> 
```

在您的代码隐藏中：

```
protected string GetUserSpecificProperty(IListItem obj) {
    if (obj is User) {
        return ((User) obj).UserSpecificField
    } else if (obj is Location) {
        return ((Location obj).LocationSpecificField;
    } else { 
        return "";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T00:18:50.060

我尝试了投影，并尝试使用 Convert.ChangeType 来获取基础类型的列表，但 DataGrid 不会显示字段。我最终决定在每种类型中创建静态方法以返回标题，实例方法以返回显示字段（作为字符串列表）并将它们一起放入 DataTable，然后绑定到它。相当干净，它保持了我想要的数据类型和显示之间的分离。

这是我用来创建表的代码：

```
 DataTable GetConflictTable()
    {
        Type type = _conflictEnumerator.Current[0].GetType();
        List<string> headers = null;
        foreach (var mi in type.GetMethods(BindingFlags.Static | BindingFlags.Public))
        {
            if (mi.Name == "GetHeaders")
            {
                headers = mi.Invoke(null, null) as List<string>;
                break;
            }
        }
        var table = new DataTable();
        if (headers != null)
        {
            foreach (var h in headers)
            {
                table.Columns.Add(h);
            }
            foreach (var c in _conflictEnumerator.Current)
            {
                table.Rows.Add(c.GetFieldsForDisplay());
            }
        }
        return table;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-04T15:49:13.750

当您使用 autogeneratecolumns 时，它不会自动为您执行此操作吗？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-06-05T07:56:59.723

我的建议是在网格中为额外的属性动态创建列，并在 IListItem 中创建一个函数来提供可用列的列表 - 或者使用对象检查来识别该类型可用的列。

然后，GUI 将更加通用，并且您不会对额外的列进行太多的 UI 控制 - 但它们将是动态的。

未经检查/编译的“伪代码”；

```
public interface IListItem
{
    IList<string> ExtraProperties;

    ... your old code.
}

public class User : IListItem
{
   .. your old code
    public IList<string> ExtraProperties { return new List { "UserSpecificField" } }
} 
```

并在表单加载中

```
foreach(string columnName in firstListItem.ExtraProperties)
{
     dataGridView.Columns.Add(new DataGridViewTextBoxColumn { DataPropertyName = columnName, HeaderText = columnName );
} 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-06-05T08:58:51.363

如果您愿意使用基于 ListView 的解决方案，数据绑定版本[ObjectListView](http://objectlistview.sourceforge.net)将允许您这样做。它读取 DataSource 的公开属性并创建列来显示每个属性。您可以将其与 BindingListView 结合使用。

它看起来也比网格更好:)

# c# - 从 .Net (C#) 进行 DB2 批量加载？

> ID：927390
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:14:57.613
> 
>         
> 
> 标签：c#, .net, db2

是否有用于将大量非事务性行直接加载到 DB2 表中的 API？

我知道有一些 CLI 命令可以执行此操作，但不清楚 .Net API 直接支持什么。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-14T05:23:07.150

查看 ADMIN_CMD 存储过程，它使 SQL 应用程序可以访问 LOAD 实用程序和许多其他管理命令。以下是 DB2 9.5 的相关信息：http: [//publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.sql.rtn.doc/doc/r0023577.html](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.sql.rtn.doc/doc/r0023577.html)

# c# - 为什么 C# 中的字节减法需要强制转换？

> ID：927391
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-05-29T18:15:08.220
> 
>         
> 
> 标签：c#, .net, casting, integer, byte

我必须使用 WinForms 在 VS2008 .net 3.5 中遵循代码：

```
byte percent = 70;
byte zero = 0;

Bitmap copy = (Bitmap)image1.Clone();
...

Color oColor = copy.GetPixel(x, y);
byte oR = (byte)(oColor.R - percent < zero ? zero : oColor.R - percent); 
```

当我将“ **`(byte)`**”从最后一行代码中删除时，我收到一个编译器错误，提示“无法将类型 ' `int`'隐式转换为 ' ' `byte`”。如果一切都是类型`byte`并且`byte`是整数类型......那我为什么需要演员？

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-05-29T18:19:28.930

因为减法强制转换为整数。我记得，字节是 C# 中的无符号类型，因此减法可以带您脱离字节域。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T18:20:43.497

那是因为字节减法的结果不适合一个字节：

```
byte - byte = (0..255) - (0..255) = -255..255 
```

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2009-05-29T18:18:49.617

[默认情况下，对字节进行算术运算](http://msdn.microsoft.com/en-us/library/5bdb6693(VS.71).aspx)会产生一个 int 值。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T18:19:19.133

因为字节算术默认返回整数，所以在两种可能的赋值中，较窄的零（字节）类型被提升为 int（oColor.r - percent）。因此，操作的类型是 int。如果没有强制转换，编译器将不允许您将更宽的类型分配给更窄的类型，因为这是一个有损操作。因此你会得到错误，除非你明确地说“我知道我丢失了一些数据，这很好”。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:18:34.627

这是因为`byte`减法返回一个`int`. 实际上，任何二进制算术运算`bytes`都会返回一个`int`，因此需要强制转换。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:24:27.763

因为对 sbyte、byte、ushort 和 short 的算术运算会自动转换为 int。最合理的原因是这样的操作很可能上溢或下溢。

因此，在您的三元运算中，最终的 oColor.R - percent 实际上会产生一个 int，而不是一个字节。所以操作的返回类型是int。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:24:05.567

因为赋值运算符右侧的算术表达式默认计算为 int。在您的示例`percent`中默认为`int`. [您可以在MSDN 页面](http://msdn.microsoft.com/en-us/library/5bdb6693.aspx)上阅读有关它的更多信息。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-07-04T00:39:20.807

尝试运行此 C# 代码： object o = (byte)(1); o = (int)o; 你能指望什么？现在试试:)

我认为这是对的：

> > Eric Lippert 说：“我不认为字节是“数字”；我认为它们是可以解释为数字、字符、颜色或其他内容的位模式。如果你要在它们并将它们视为数字，然后将结果移动到更通常被解释为数字的数据类型中是有意义的。”

也许 byte 更接近于 char 而不是 int。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-06-02T20:19:15.707

FWIW，java也将字节提升为int。

# delphi - 德尔福的俄耳甫斯 2009

> ID：927394
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:16:00.823
> 
>         
> 
> 标签：delphi, delphi-2009

我是俄耳甫斯的用户。没有比表处理更好的了，f.ex。我已经下载了你的 D2009 版本。你如何让它为你工作，里面有所有的 CHAR，而不使用 H- 作为字符串？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-10T03:08:49.803

我认为该项目由 sourceforge [TurboPower Orpheus](http://sourceforge.net/projects/tporpheus/)维护。[名为 4.07 Unicode 的版本可能支持 Delphi 2009。SongBeamer](http://www.songbeamer.com/delphi/)在 2009 年 5 月 22 日还发布了另一个版本。[主题：在 D2009 中禁用 Unicode？](https://forums.codegear.com/thread.jspa?threadID=17311)提到它。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-10-02T19:41:59.003

FWIW，Nick Hodges 现在是 sourceforge 项目的管理员。它应该很快更新以支持 2009/2010。

# data-structures - 我应该如何修改我的 Queue 类以允许用户在 F# 中创建未指定类型的空队列？

> ID：927400
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T18:17:09.153
> 
>         
> 
> 标签：data-structures, f#

我`Queue`在 F# 中创建了一个不可变对象，如下所示：  

```
type Queue<'a>(f : 'a list, r : 'a list) =    
    let check = function
        | [], r -> Queue(List.rev r, [])
        | f, r -> Queue(f, r)

    member this.hd =
        match f with
        | [] -> failwith "empty"
        | hd :: tl -> hd

    member this.tl =
        match f, r with
        | [], _ -> failwith "empty"
        | hd::f, r -> check(f, r)

    member this.add(x) = check(f, x::r)

    static member empty : Queue<'a> = Queue([], []) 
```

我想创建一个 empty 的实例`Queue`，但是我得到一个值限制异常：

```
> let test = Queue.empty;;

  let test = Queue.empty;;
  ----^^^^ 
```

> C:\Documents and Settings\juliet\Local Settings\Temp\stdin(5,5)：错误 FS0030：值限制。值 'test' 已被推断为具有泛型类型 val test：Queue<'_a> 将 'test' 定义为一个简单的数据项，使其成为具有显式参数的函数，或者，如果您不打算使其成为泛型，添加类型注释。

基本上，我希望在`Set`模块中看到相同的功能，它允许我编写：

```
> let test = Set.empty;;

val test : Set<'a> 
```

如何修改我的`Queue`类以允许用户创建空队列？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T18:31:09.700

您需要使用 GeneralizableValueAttribute，例如：

```
type Queue<'a>(f : 'a list, r : 'a list) =  // '
    let check = function
        | [], r -> Queue(List.rev r, [])
        | f, r -> Queue(f, r)

    member this.hd =
        match f with
        | [] -> failwith "empty"
        | hd :: tl -> hd

    member this.tl =
        match f, r with
        | [], _ -> failwith "empty"
        | hd::f, r -> check(f, r)

    member this.add(x) = check(f, x::r)
module Queue =    
    [<GeneralizableValue>]
    let empty<'T> : Queue<'T> = Queue<'T>([], []) // '

let test = Queue.empty
let x = test.add(1)       // x is Queue<int>
let y = test.add("two")   // y is Queue<string> 
```

[您可以在语言规范](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec2.aspx)中阅读更多关于它的信息。

# c - C 中 switch 语句的开销

> ID：927403
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-29T18:18:06.670
> 
>         
> 
> 标签：c, switch-statement, overhead

我是一个相当称职的 Java 程序员，对 C 语言非常陌生。我正在尝试优化一个具有四种操作模式的例程。

我遍历图像中的所有像素并根据传递的“模式”计算新的像素值。

我的问题是关于两个嵌套 for 循环中 switch 语句的开销。我会对任何有关基本 C 语句、数学和逻辑运算的相对效率的文档链接感兴趣。

代码如下；

```
for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             switch (mode)                  /* select the type of calculation */
             {
                case 0:
                weight = dCentre / maxDistanceEdge;
                case 1: 
                    weight = (float)x/width;             
                    break;
                case 2: 
                    weight = (float)y/height;
                    break;
                case 3: 
                    weight = dBottomLeft / maxDistanceCorner;
                    break;
                case 4: 
                    weight = dTopRight / maxDistanceCorner;
                    break;
                default: 
                weight = 1;
                break;
            }
             // Calculate the new pixel value given the weight
             ...
            }             

    } 
```

如果这是超过 5000 x 5000 像素的图像，您会期望看到很多开销吗？我试图做一些测试，但我的结果到处都是，因为系统（移动设备）有各种各样的东西在后台运行，可能会扭曲结果。

另一种选择是为每种模式设置一个单独的方法，每个模式都有自己的四个循环。这显然会引入冗余代码，但效率是这里的游戏名称。

提前致谢！

加夫

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-05-29T18:30:29.547

Switch 语句针对连续值编译为跳转表，针对稀疏值编译为一堆 if-else 语句。无论如何，如果您关心性能，您不希望在内部循环中使用 switch 语句进行图像处理。您想要如下所示。

另外，请注意，我将权重计算移出内部循环（并为案例 2 交换了循环以实现此目的）。这种类型的思维，将东西移出内部循环，会让你从 C 中获得你想要的性能。

```
switch (mode)                  /* select the type of calculation */
{
case 0:
    weight = dCentre / maxDistanceEdge;
    for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;
case 1:
    for (x = 0; x < width; x++) {
        weight = (float)x/width;
        for (y = 0; y < height; y++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;
case 2:
    // note - the loops have been swapped to get the weight calc out of the inner loop
    for (y = 0; y < height; y++) {
        weight = (float)y/height;
        for (x = 0; x < width; x++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;
case 3:
    weight = dBottomLeft / maxDistanceCorner;
    for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;
case 4:
    weight = dTopRight / maxDistanceCorner;
    for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;
default:
    weight = 1;
    for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             // Calculate the new pixel value given the weight
             ...
        }
    }
    break;

// etc..
} 
```

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T18:21:17.163

如果效率比代码大小更重要，那么是的，您应该创建冗余例程。case 语句是您可以在 C 中执行的开销较低的事情之一，但它不是零 - 它必须根据模式进行分支，因此需要时间。如果您真的想要最大性能，请让案例脱离循环，即使以复制循环为代价。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T18:20:50.703

Switch 语句尽可能高效。它们被编译成一个跳转表。事实上，这就是为什么 switch 如此有限的原因：你只能编写一个 switch，你*可以*为它编译一个基于固定值的跳转表。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T18:20:34.683

与您在循环中进行的数学运算相比，切换的开销可能很小。话虽如此，唯一可以确定的方法是为两种不同的方法创建不同的版本，并为它们计时。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:31:02.420

与 if/else 的等效项相比，switch/case 非常快：它通常实现为跳转表。然而，它仍然是有代价的。

在优化事物时：

1）尝试遍历行，而不是列（切换 x 和 y “for”循环），由于缓存内存管理，一种解决方案可能比另一种解决方案快得多。

2）用（预先计算的）逆的乘法替换所有除法会给你带来显着的收益，并且可能是可接受的精度损失。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:17:32.420

为了效率起见，您最好移到`switch`循环之外。

我会使用这样的函数指针：

```
double fun0(void) { return dCentre/maxDistanceEdge; }
double fun1(void) { return (float)x/width; }
/* and so on ... */

double (*fun)(void);

switch (mode)                  /* select the type of calculation */
{
    case 0: fun = fun0;
            break;
    case 1: fun = fun1;
            break;
    case 2: fun = fun2;
            break;
    case 3: fun = fun3;
            break;
    case 4: fun = fun3;
            break;
    default : fun = fun_default;
            break;
}

for (x = 0; x < width; x++) {
        for (y = 0; y < height; y++) {
             weight = fun();
             // Calculate the new pixel value given the weight
             ...
        }
} 
```

它增加了函数调用开销，但它不应该太大，因为你没有向函数传递任何参数。我认为这是性能和可读性之间的良好权衡。

**编辑：**如果您使用 GCC，为了摆脱函数调用，您可以使用`goto`和[标签作为值：](http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html)在开关中找到正确的标签，然后每次都跳转到它。我认为它应该节省更多的周期。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:21:14.760

开关不应该产生任何显着的开销，它们在低端被编译成一种指针数组，那么这是一个有效的例子：

jmp {基地址}+switchcasenum

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:21:47.847

这可能取决于您的 CPU 的分支预测器有多好，以及您的编译器如何为开关生成代码。对于这么少的情况，它可能会生成一个决策树，在这种情况下，正常的 CPU 分支预测应该能够消除大部分开销。如果它生成一个开关表，情况可能会更糟......

也就是说，找出答案的最佳方法是对其进行分析并查看。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:24:59.903

除了 Jim 的建议，尝试交换循环的顺序。循环交换是否适合案例 1 需要测试，但我怀疑它是。您几乎总是希望您的 x 坐标在您的内部循环中以提高分页性能，因为这会导致您的函数在每次迭代时更倾向于保持在相同的通用内存区域中。并且资源有限的移动设备可能具有足够低的内存来强调这种差异。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2010-09-08T03:31:28.127

很抱歉碰到这个线程，但在我看来，这个开关与问题相差甚远。

在这种情况下，效率的真正问题是部门。在我看来，除法运算的所有分母都是常数（宽度、高度、最大值......），并且这些在整个图像过程中都不会改变。如果我的猜测是正确的，那么这些是可以根据加载的图像更改的简单变量，因此可以在运行时使用任何大小的图像，现在这允许加载任何图像大小，但这也意味着编译器无法优化它们如果将它们声明为“const”，则可以执行更简单的乘法运算。我的建议是预先计算这些常数的倒数并相乘。据我所知，乘法运算大约需要 10 个时钟周期，而除法大约需要 70 个时钟周期。每像素增加 60 个周期，

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:21:58.020

取决于芯片和编译器以及代码的细节，而且……但这通常会以跳转表的形式实现，应该很快。

顺便说一句——理解这种事情是一个很好的论据，可以在你职业生涯的某个阶段花几个星期学习一些组装......

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:22:21.263

对于速度和程序员时间来说，使用开关可能更好。您正在减少冗余代码，并且可能不需要新的堆栈帧。

开关是如此高效，以至于它们可以用于非常奇怪和令人困惑[的黑魔法](http://en.wikipedia.org/wiki/Duff%27s_device)。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:10:02.607

> 但效率是这里的游戏名称。

迭代图像缓冲区以计算新的像素值听起来像是一个典型的令人尴尬的并行问题，从这个意义上说，您可能需要考虑将一些工作推入工作线程，这应该比微优化更显着地加快您的操作例如开关/案例问题。

此外，您可以从函数指针数组中调用函数指针，而不是每次都执行分支指令，其中索引用作您的模式标识符。

这样您最终会遇到以下呼叫：

```
computeWeight[mode](pixel); 
```

对于 5000x5000 像素，函数调用开销也可以通过为一系列像素而不是单个像素调用函数来减少。

您还可以使用循环展开和通过引用/指针传递参数，以进一步优化这一点。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T21:11:50.143

许多优点已经给出。我能想到的唯一补充就是将最常见的情况移到交换机中，将最不频繁的情况下移。

因此，如果案例 4 比案例 1 更频繁地发生，它应该在它之上：

```
switch (mode) {
    case 4:
        // ..
        break;
    case 1:
        // ..
        break;
} 
```

太糟糕了，你没有使用 c++，因为这样 switch 语句可以被多态性替换。

干杯！

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2012-04-23T15:34:01.193

在这个线程中有很多创造性的建议，不必编写 5 个单独的函数。

除非您从文件或键入的输入中读取“模式”，否则可以在编译时确定计算方法。作为一般规则，您不希望将计算从编译时移到运行时。

无论哪种方式，代码都会更容易阅读，并且没有人会对您是否打算在第一种情况下放入 break 语句感到困惑。

此外，当您在周围的代码中遇到错误时，您不必查找枚举是否设置为错误的值。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2019-02-25T02:50:48.513

关于内部循环... 0->var 最好完成 var->0 因为 var-- 触发零标志（6502 天）。这种方法也意味着“宽度”被加载到 x 中并且可以被忘记，“高度”也是如此。内存中的像素通常是左->右，上->下，所以肯定有 x 作为你的内循环。

```
for (y = height; y--;) {
    for (x = width; x--;) {
         weight = fun();
         // Calculate the new pixel value given the weight
         ...
    }
} 
```

另外......非常重要的是您的 switch 语句只有 2 种使用 x 或 y 的情况。其余的都是常数。

```
 switch (mode)                  /* select the type of calculation */
 {
     case 0:
        weight = dCentre / maxDistanceEdge;
        break;
     //case 1: 
     //  weight = (float)x/width;             
     // break;
     //case 2: 
     //     weight = (float)y/height;
     //     break;
     case 3: 
          weight = dBottomLeft / maxDistanceCorner;
          break;
      case 4: 
           weight = dTopRight / maxDistanceCorner;
           break;
      default: 
           weight = 1;
           break;
 } 
```

所以基本上除非在循环之前计算模式 1 或 2 的权重。

```
... Y loop code here

    if (mode == 2) { weight = (float)y/height; } // calc only once per Y loop

    ... X loop here

        if (mode == 1) { weight = (float)x/width; } // after this all cases have filled weight
        calc_pixel_using_weight(weight); 
```

如果数据稀疏，我发现 switch 语句非常不友好。对于 < 4 个元素，我会选择 if-then-else 并确保最常见的情况排在最前面。如果第一个条件涵盖了 90% 的情况，那么您基本上已经击中了本垒打。同样，如果其他一些条件 < 1%，则将其放在最后。

# asp.net-mvc - 哪个数据框架更适合 ASP.NET MVC 站点 - LINQ to SQL 或 NHibernate

> ID：927409
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-29T18:19:06.183
> 
>         
> 
> 标签：asp.net-mvc, nhibernate, linq-to-sql

我们即将开始一些 ASP.NET MVC 开发，并且多年来一直在使用我们自己的实体框架。然而，我们需要支持的不仅仅是我们的实体框架所能提供的，所以我想获得一些关于将 MVC 与更健壮的框架一起使用的意见。我们已经缩小或选择 NHibernate（使用 Fluent API）或 LINQ to SQL。

哪个框架最适合 MVC 风格的开发（我知道 SO 使用 LINQ to SQL）？

如果我们想支持 SQL Server、Oracle、MySQL - 是否排除 LINQ to SQL？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-06-02T18:21:17.860

作为刚刚从[LINQ 切换到 SQL](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_SQL_.28formerly_called_DLINQ.29)到 (Fluent) NHibernate 的人，这里有一些我注意到的事情。

1.  LINQ to SQL 花了很长时间才弄清楚如何做相当于一个连接子类。经过多次修改，我在某处读到这是不可能的。如果所有列都在同一个表中，它只能映射继承。如果有几列，那就太好了，但在我的情况下有很多，子类是其他子类的父类，依此类推。为了我的 ORM，我为什么要把它们都放在一张桌子上？

2.  从经验来看，NHibernate 一直很健壮（有时对于小型快速项目来说太多了），虽然通过小型项目熟悉它，但我觉得它可能太多了，并且走 LINQ 到 SQL 的路线，因为我可以生成一个[DBML](http://en.wikipedia.org/wiki/ColdFusion#Acronyms)文件并进入分钟。

3.  流畅的 NHibernate。两全其美（在我的情况下）。我可以按照我想要的方式映射并拥有我想要的数据库，而不必在我的域或数据模型中妥协。还有一个词：自动映射...锦上添花。

一旦我发现限制并使用 LINQ to SQL 遇到一些障碍，我将不得不使用另一个 ORM，但是 Fluent NHibernate 使这个选择变得容易，我认为我不会离开它，除非有什么事情发生工作更好。

所以，就像 Rob Scott 所说，问题是你如何抽象你的领域 => 数据模型？您是从域还是数据库开始？关系有多复杂？如果您有任何继承，我会说只是使用更丰富的 ORM 框架并为自己省去烦恼。

Fluent NHibernate 有一些我发现过的最好的文档，并且有如此多的支持、注释、博客和资源，以至于我讨厌做任何更少的事情...... IMO！我在不到 24 小时内启动并运行。

哦，如果您是 NHibernate 的新手，请拿起 NHibernate in Action 这本书来帮助润滑轮子，尽管该框架也有很多帮助。

一个工具不工作的最好迹象是当你必须使用这个工具时......我正在定制、阅读白皮书、各种疯狂的 LINQ to SQL，它拒绝生成适当的查询，就在我很想去的时候修改我的表和域，我说让我试一试 Fluent，我很高兴我做到了。

祝你好运。抱歉，回复太长了；这一切都在过去五天左右，所以我想我仍然赶上了:-)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:28:40.723

我在 MVC 中使用 Fluent NHibernate 和依赖注入（在我的例子中是 Ninject）取得了巨大的成功。

在我看来，任何成熟的 ORM 都应该与 MVC 一起工作。由于 MVC（模型/视图/控制器）的性质将这三个关注点分开，因此任何 ORM 都应该非常适合“模型”角色。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:27:03.627

LINQ to SQL 用于 SQL Server。Entity Framework 也支持其他一些数据库。

NHibernate 是不错的选择。[如果您正在做基于数据的应用程序或Sharp Architecture](http://www.codeplex.com/SharpArchitecture)进行项目指导，您可以使用[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)（它构建在 NH 之上） 。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:30:37.660

Entity Framework 与 MVC 很好地集成并支持其他数据库。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-06-01T13:02:22.173

简短（但不是很有帮助）的答案是您提到的两个 ORM 都可以与 MVC 一起使用。更长的答案是您应该考虑如何使用模型对象。例如，您是想先进行领域对象开发（也就是领域驱动设计方法），还是要实现“数据上的表单”类型的应用程序，您可能希望从现有数据库生成数据访问层？您对指定映射的偏好是什么？您想使用流畅的界面还是对映射文件（或域对象上的属性）感到满意？

这些是您在选择 ORM 时需要调查的问题类型——它们大多与您使用的是 MVC 还是 Winforms 无关。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-05-13T11:44:26.163

[实体框架](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)使事情变得复杂。使用 Fluent NHibernate，具有存储库模式和控制器中[的控制反转](http://en.wikipedia.org/wiki/Inversion_of_control)。

NHibernate 将使很多事情变得更容易。我们最近从 Entity Framework 迁移到 Fluent Nhibernate，Fluent NHibernate 绝对是更好的选择。

# http - 谷歌网络抓取机器人遇到了哪些 HTTP 签名？

> ID：927425
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T18:21:06.383
> 
>         
> 
> 标签：http, sockets, seo

  有了所有可用的 HTTP 数据，

您可以寻找哪些“迹象”来识别 Google 的搜索引擎机器人？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:23:03.977

[如何验证 googlebot](http://googlewebmastercentral.blogspot.com/2006/09/how-to-verify-googlebot.html) - 官方方法。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:22:10.500

据我所知，谷歌的爬虫将用户代理设置为“Googlebot”。

其他搜索引擎提供商通常会在用户代理中使用可识别的名称；有各种知名代理列表，例如[http://www.jafsoft.com/searchengines/webbots.html](http://www.jafsoft.com/searchengines/webbots.html)上的列表。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:24:53.270

[User-Agent](http://en.wikipedia.org/wiki/User-Agent)标头应该足以检测到 Google 机器人

查看[user-agents.org](http://www.user-agents.org/)网站以获取已知 se bot 的列表

如果您想确定这是来自 google 的真正 googlebot，那么您可以查看始终存在的 ip/host

> c[nn].googlebot.com

其中 [nn] 是一个数字。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-01-26T10:51:09.813

好吧，我不太确定为 IP 地址进行 DNS 反向查找的可维护性如何。如果您担心有人欺骗 google 的用户代理字符串，我只会这样做，这是极不可能的。正如文章指出的那样，它本身也可以被欺骗。

你最好只匹配他们已知的用户代理：

```
Regex.IsMatch(ua, @"googlebot|mediapartners-google|adsbot-google", RegexOptions.IgnoreCase); 
```

# javascript - 别名 DOM 函数 (Document.Write) 和其他域上的脚本

> ID：927441
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T18:23:07.550
> 
>         
> 
> 标签：javascript, dom, document.write

当我将它们加载到我的域中时，我想强制外部 3rd 方脚本（在单独的域上）使用我自己的 document.write 自定义实现。

IE：

```
document.write = function(args) {
    // My custom Function
    } 
```

这适用于同一域上的脚本，但其他域上的脚本使用浏览器默认值。我可以覆盖这个吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:58:01.090

给你：

```
(window.HTMLDocument ? HTMLDocument.prototype : document).write = function(s) {
    this.title = s;
} 
```

在 IE 和非 IE 中，“this”对象都是浏览器文档对象。

# apache - 将目录重定向到 Apache 上的脚本

> ID：927444
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:24:25.067
> 
>         
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

所以我正在玩一个脚本，它可以非常容易地从网络上镜像图像。该脚本运行良好（基于旧的 imgred.com 源代码，如果您已经看到的话）问题是，使用它时看起来有点笨拙。

目前，为了使用该脚本，您可以访问如下网址：

```
http://mydomain.com/mirror/imgred.php?Image=http://otherdomain.com/image.jpg _
```

我想做的是能够去：

```
http://mydomain.com/mirror/ http://otherdomain.com/image.jpg
```

并让它重定向到以前的 URL，最好对用户透明。

我有理由确定这可以通过 .htaccess 和某种 MOD_REWRITE 来完成，但我很沮丧试图让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:08:27.800

在自己搞砸了这个之后，我发现apache将查询部分之前的URL中的任何双斜杠折叠成一个斜杠，并将结果传递给mod_rewrite。也许这给你带来了问题？

这可能对您有用（目录中的.htaccess `mirror`）：

```
RewriteEngine On
RewriteBase /mirror
RewriteRule ^http(s?):/(.*) imgred.php?Image=http$1://$2 [L] 
```

不知道您的脚本是否也接受 https 地址，所以我将其包括在内只是为了确定

# asp.net - 客户端验证后的 RegisterOnSubmitStatement

> ID：927446
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-05-29T18:24:44.050
> 
>         
> 
> 标签：asp.net, javascript, ajax

在提交 Web 表单时，我需要在流程中插入一些 Javascript，但在客户端验证发生之后。

RegisterOnSubmitStatement 似乎将 javascript 放在验证之前。

任何人都知道如何让它渲染后？

找到的解决方案：在 web 控件中，我放了这样的东西：

```
protected override OnInit(EventArgs e) { 
   Page.SaveStateComplete += new EventHandler(RegisterSaveStuff); 
   base.OnInit(e); 
} 

void RegisterSaveStuff(object sender, EventArgs e) { 
   Page.ClientScript.RegisterOnSubmitStatement(typeof(Page), "name", "JS code here"); 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-08-17T16:08:12.020

没错，RegisterOnSubmitStatement 在 init 函数中不起作用。它应该在页面 lige 循环之后调用。我认为正确的地方是：

“预渲染完成”

```
protected override OnInit(EventArgs e) 
{ 
   Page.PreRenderComplete+= new EventHandler(Page_PreRenderComplete); 
   base.OnInit(e); 
} 

void Page_PreRenderComplete(object sender, EventArgs e) 
{ 
   Page.ClientScript.RegisterOnSubmitStatement(typeof(Page), "name", "JS code here"); 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-06-01T17:54:31.490

经过一些在线研究并使用它，我发现您可以通过挂钩 Page 的 SaveStateComplete 事件来做到这一点。我猜验证提交语句是在 PreRender 事件期间注册的，所以如果你在那之后注册它（在 SaveStateComplete 事件中）你可以在之后得到它。

您确实必须重新注册它，但这没什么大不了的，因为我的 JS 并不依赖 ViewState。

# c# - 应用程序的业务层是否应该能够访问 Session 对象？

> ID：927448
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T18:24:53.397
> 
>         
> 
> 标签：c#, session, business-logic

假设您有 3 层：UI、业务、数据。

如果业务层需要访问会话，这是否表明设计不佳？感觉有些不对劲。是否有任何专门针对 Web 应用程序需要遵循的准则？

我使用 c# 2.0 .net

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T18:50:13.547

不。如果你有一个“控制器”层，你应该在那里访问它。从 Session 中获取您需要的内容并将其交给您的业务层。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-30T01:33:58.817

*叹。*

广泛的共识将是不。业务层和控制器/Web 层应该以不同的方式维护，因为它们是独立的关注点。

事实是，您似乎将此标记为“纯粹与现实”的问题，这是非常短视且略显令人讨厌的问题。它也违背了提出问题的意义；如果您不考虑提出的意见，那为什么要征求他们的意见？

确实，预先更仔细地将事物分开需要更多的前期努力，更多的时间，最终可能会花费更多。确实，您可能无法从中感受到任何直接的好处。然而，几十年来大量程序员分享的大量啜泣故事表明，在可能的情况下，你所谓的“纯洁性”会在五年后减少痛苦；天哪；你真的必须认真地做一些重构，这并不令人愉快，因为你的责任正在渗透。

为 Web 应用程序设想层的更好方法可能是考虑表示、交互、业务规则和数据；从上到下。您的数据是数据库、数据访问等，业务规则对该数据实施任何额外的约束、处理验证、计算等。然后交互在表示层（基本上是您的用户界面）和业务逻辑之间分支，执行驱动您的应用程序的用例。

到目前为止，用户界面都是无关紧要的。用户是否在命令行应用程序中输入客户数据，或者使用存储在会话中的数据浏览一些多页 Web 表单并不重要。假设您选择后者；在上面粘贴一个网络前端。现在您关心的是编写相对简单的代码来处理检索请求的数据并将其呈现给用户。关键是，您的 Web 应用程序；前端，**那个**是您的整个用户界面；会议和所有。只有在您准备说“嘿，让我们将客户数据存入数据库”时，您才会去调用那些精心设计的服务层，传递您的 Web 应用程序获得的每一点信息藏匿；用户输入，进行更改的用户的姓名；所有这些废话。您的服务层会处理它。或者，或者，婊子，因为你忘记了必填字段。

因为您已经将事物清晰地分离出来，所以您的应用程序的核心可以像其他人建议的那样被改造（或“借用”）以在任何其他应用程序中使用，并且服务层保持无状态、干净并准备好处理事物。它会进行您的验证，因此您的验证在任何地方都是一致的。但它不知道谁登录了 Web 前端、控制台应用程序或在终端上运行的花哨的富客户端应用程序，它也不在乎，因为这些细节只对那些应用程序很重要。

需要添加新的验证规则？没问题; 让服务层进行验证，并根据需要在链的更高层处理用户界面问题。需要改变计算方式吗？在业务层进行更改。没有其他东西需要受到影响。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:29:12.340

我闻起来很有趣。也许您需要一个表示层来管理会话和任何其他状态信息？

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:46:22.883

我认为业务逻辑不应该与表示选择绑定，如果 Session 位于该层，它将被绑定。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:47:14.287

我认为 Session 的不必要使用通常是一种代码异味，通常查询字符串、cookie 和视图状态更轻量级并且具有更好的“范围”

至于 Sessions 在业务层中的角色，这取决于您目前正在阅读的架构大师。如果业务逻辑层是代码独立于 UI 的地方，那么 Session 就不是引入业务层的东西。

例如，在控制台应用程序、ASP.NET Web 应用程序、Windows 服务和 Windows 窗体应用程序中，只有 ASP.NET 具有会话。

也就是说，能够支持多个 UI 是一个被高度高估的功能，并且不需要完美的远见来估计您是否会将您的应用程序移植到不同的用户界面。如果您非常确信您的逻辑从现在到永远只会在 ASP.NET 应用程序中运行，那么没关系。

一个例外是单元测试。nUnit 测试运行器构成不同的 UI，很难模拟请求、响应、会话、应用程序等。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:30:07.533

我的感觉是业务层是唯一放置会话数据访问的地方，因为它确实是您逻辑的一部分。如果您将其烘焙到表示层中，那么如果您更改该数据的存储位置（假设您不再想使用会话状态），那么进行更改会更加困难。  

我要做的是对于所有会话状态的数据，我会创建一个类来封装对该数据的检索。这将允许未来的变化。

编辑：UI 应该只用于执行以下操作： 1\. 调用业务层。2\. 与用户交互（消息和事件）。3\. 操作屏幕上的视觉对象。

我听说人们将会话数据访问视为数据层的一部分，这是语义上的，取决于您对数据层的看法。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:30:44.070

如果您保留列出的三层，“业务”层可能最适合处理 Session 对象。

由于会话更多地与将应用程序绑定在一起的实际框架有关，而不是与任何实际业务逻辑有关，因此您可能希望创建一个控制层，将数据从 Session 对象转换为业务数据输入到业务层。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:19:31.740

我认为这取决于使用情况，但是是的，我们一直从业务层访问会话。这里也有“纯粹与现实”的争论。

例如，在我们的应用程序中，每个客户端都有一个数据库，但只有一个代码库。因此，我们在会话中为每个用户提供了客户端信息。当然，我们可以将这些数据从 Web 层的会话中提取出来，然后将其传递给业务层。当然，业务层甚至不关心它，但是数据层需要它来连接正确的数据库。因此，业务层需要将其传递给数据层。似乎有很多参数传递没有很好的商业理由。在我们的例子中，我们的数据层检查连接字符串的会话对象并从那里运行。如果它不是 Web 应用程序（并且我们有 Windows 服务和 .exe 帮助应用程序），我们围绕没有会话的问题进行了编码，如下所示：

```
protected virtual string GetConnectionString()
{
string connectionString;
string connectionStringSource;

//In app.config?
if (ConfigurationManager.AppSettings[_ConnectionStringName] != null &&
   ConfigurationManager.AppSettings[_ConnectionStringName] != "")
{
   connectionString = ConfigurationManager.AppSettings[_ConnectionStringName];
   connectionStringSource = "Config settings";
}
//Nope? Check Session
else if (null != HttpContext.Current && null != HttpContext.Current.Session &&
   null != HttpContext.Current.Session[_ConnectionStringName])
{
  connectionString = (string)HttpContext.Current.Session[_ConnectionStringName];
  connectionStringSource = "Session";
}
//Nope? Check Thread
else if (null != System.Threading.Thread.GetData(
      System.Threading.Thread.GetNamedDataSlot(_ConnectionStringName)))
{
   connectionString = (string)System.Threading.Thread.GetData(
          System.Threading.Thread.GetNamedDataSlot(_ConnectionStringName));
   connectionStringSource = "ThreadLocal";
}
else
{
   throw new ApplicationException("Can't find a connection string");
}

if (debugLogging)
   log.DebugFormat("Connection String '{0}' found in {1}", connectionString, 
          connectionStringSource);

return connectionString;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:41:27.817

从业务层访问会话绝对是代码异味。  

如果您需要按所述“切换”业务层，则您的表示层或控制器只需要担心会话变量是什么。  

例如，假设您想将一组对象用于一个会话变量，而将另一组对象用于另一个变量。您的控制器可以调用服务层并传入变量。然后服务层将返回适当的业务对象。

您的业​​务层不知道任何关于会话的事情，就像您的表示层不知道您如何连接到数据库一样。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T01:15:03.647

会话对象与特定的 UI 实现相关联，因此让您的业务层因会话而死是一种味道。

另外，您可能应该能够对您的业务层进行单元测试——如果会话存在依赖关系，您将如何做到这一点？

# sql - 根据单个数据库查询中的条件递增值

> ID：927451
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T18:25:09.480
> 
>         
> 
> 标签：sql, sql-server-2005

我有一个表，其中有一列标有“排序顺序”，用于允许客户手动更改每个项目的顺序。该表还有一个标记为“CategoryId”的列。  

我很好奇，如果我要批量导入一组我知道所有数据（包括 CategoryId）的数据，我如何在查询中指定“SortOrder”的递增值，以便它在每个唯一的 CategoryId 中从 1 变为 X .

谢谢大家。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-29T18:31:07.487

我不确定我是否理解您的问题，但我*认为*您要问的是如何在插入表格期间合成适当的 SortOrder。您应该使用 ROW_NUMBER() 按 CategoryId 进行分区。当然，您需要定义一个排序标准，给出“1 到 X”的属性顺序：

```
INSERT INTO myTable (SortOrder, CategoryId, <other columns> ...)
SELECT ROW_NUMBER() OVER (PARTITION BY CategoryId ORDER BY mySortCriteria)
  , CategoryId
  , <other columns> ...
  FROM SourceTable; 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:32:33.847

听起来您需要在导入中使用 row_number 函数。

```
INSERT MyTable(SortOrder, ...)
SELECT  SortOrder = row_number() over (partition by CatgoryID order by SomeOtherField), ...
FROM    MyTable 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:49:44.280

对于以后可能出现在 SQL Server 2000 中的任何人，这里是完成任务的另一种方法。

使用某种临时表来修复批量插入的数据。确保它有一个名为 sortorder 的列，该列最初填充了一个 1 和一个基于身份的 id 列。

然后你可以用一个自我加入来更新它，比如

```
update t
set sortorder = t1.sortorder +1
from test t
join Test t1 on t.id = t1.id+1 
```

然后将数据放入您的产品表中。

# c - 在 C/C++ 中创建库 - ld 找不到我的库

> ID：927469
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:31:03.400
> 
>         
> 
> 标签：c, compilation

我正在尝试学习如何在 linux 环境中创建 C/C++ 库，但我遇到了在线教程无法解决的问题（可能是一个微不足道的问题）。

为了明确起见，假设我有一个 foo.c 文件，其中包含以下代码：

```
//file: foo.c
#include <stdio.h>
void hello(void)
{
  printf("hello!\n");
} 
```

一个foo.h：

```
//file: foo.h
void hello(void); 
```

以及一个使用 foo.c 中的函数 hello() 的程序，名为 prog.c：

```
//file: prog.c

#include "foo.h"

int main(void)
{
  hello();
  return 0;
} 
```

这三个文件都在同一个目录下。然后我编译了 foo.c：

```
gcc -fPIC -c foo.c 
```

并得到一个 foo.o 文件。然后我使用 ld 创建库文件：

```
ld -G foo.o -o libfoo.so 
```

但是当我尝试编译 prog.c 时：

```
gcc -o prog prog.c -lfoo 
```

我收到一条错误消息：

```
/usr/bin/ld: cannot find -lfoo
collect2: ld returned 1 exit status 
```

我确信这是某种微不足道的路径问题，但我找不到解决方案。所以我的问题是，如果上面的过程是错误的，或者我是否必须将 libfoo.so 文件放在一个特殊的路径中。

另一个问题是，如果我使用 g++ 而不是 gcc，这将如何变化。

谢谢。

编辑：

我知道我可以将 prog.c 和 foo.c 都编译为 prog.o 和 foo.o，然后将它们链接成可执行文件。但是在我最初的问题中，我想编译 foo.c 以将其分发给将在他们自己的程序中使用我的函数的人。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T18:35:53.887

`ld`默认不搜索当前目录。如果你想让它这样做，你需要使用`-L`命令行选项，所以如果你的库在当前目录中，你需要添加`-L.`到最后一个 gcc 调用。如果库是动态链接的，您还需要将当前目录添加到环境变量中`LD_LIBRARY_PATH`（我假设您在 linux 上）。

当然，如果您的库位于任何其他非标准路径中，则需要使用该路径而不是当前目录。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:33:44.673

尝试

```
gcc -o prog prog.c -lfoo -L. 
```

-L 开关将其参数添加到 ld 查找库文件的路径集。g++ 的语法是相同的。

# c# - 在用户控件中检查 Page.IsPostBack

> ID：927470
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:31:04.833
> 
>         
> 
> 标签：c#, asp.net, postback

是否建议在用户控件 Page_Load 事件中检查 Page.IsPostBack，例如

```
 protected void Page_Load(object sender, EventArgs e)
    {

        if (!Page.IsPostBack)
        {

        }

    } 
```

我得到了奇怪的结果

编辑〜这是事情。加载主表单后，我使用 Request.QueryString 获取客户 ID，然后将其放入 SESSION 变量中。

在控件 Load 事件中，我读取 SESSION 变量以获取该客户的数据。那么，我需要在控制级别检查 PostBack 吗？

编辑~这里是控件的加载事件

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            //Getting and storing the customer account number 
            if (string.IsNullOrEmpty((string)Session["CustomerNumber"]))
            {
                Session["CustomerNumber"] = cust.GetCustomerNumber(myHelper.GetCustomerIDFromQueryString());
                LoadProductData();
            }
        }

    } 
```

这是 myHelper 类

```
static class myHelper
{
    public static Guid GetCustomerIDFromQueryString()
    {
        //Getting the GUID (used as customerid in CRM) from the URL request of the selected account.  
        return Sql.ToGuid(System.Web.HttpContext.Current.Request["ID"]);
    }

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:32:17.437

只是无缘无故地检查？绝对不。如果您应该只在第一次加载时而不是在随后的回帖中执行某些操作，那么这就是应该使用的模式。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:33:49.603

您确定在您访问您的页面时，您将始终在会话中存储一个“客户编号”吗？关于何时获取数据以及何时不获取数据，您是否可以找到任何押韵或理由？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-03T14:37:13.447

如果您在页面加载中使用“！IsPostBack”，当用户单击其他控件时，它会执行 postBack，因此您不会获取数据。我希望这对你有帮助。

# php - 任何能让我开心的 netbeans 功能？

> ID：927474
> 
>         
> 
> 赞同：44
> 
>         
> 
> 时间：2009-05-29T18:31:20.043
> 
>         
> 
> 标签：php, netbeans

由于 XDebug 集成，我最近非常喜欢[netbeans用于我的 php 工作。](http://www.netbeans.org/)这让我几乎忘记了[textmate](http://www.macromates.com)（恕我直言，在小事上它仍然击败了netbeans）

您认为我应该了解的一个很棒的 netbeans 功能是什么，更重要的是为什么以及如何使用它？

我要求这样做是为了优化我在使用 IDE 方面的技能，并且基于这样的想法，即对其他人有用的东西可能对我（希望对其他人）也有用。

* * *

## 回答 #1

> 赞同：42
> 
>             
> 
> 时间：2009-10-02T19:36:35.617

我发现了另一个很棒的天才片段，我想分享：

您可以进行自定义代码折叠（与 php 无关，仅与 netbeans 相关）

只需将其放入代码文件中：

```
// <editor-fold defaultstate="collapsed" desc="getters and setters">

some boring code you don't need to see every time here

// </editor-fold> 
```

这将类似于`#region`Visual Studio中`pragma mark`的 s 或 xcode 中的 s。但与`region`s 不同的是，它不会破坏您的代码的工作，它实际上只是一个注释！

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2009-05-29T18:34:00.537

直接在 IDE 上的[Subversion 集成和](http://subversion.netbeans.org/)[本地历史记录](http://blogs.oracle.com/plamere/entry/saved_by_netbeans_local_history)是我必须使用的、最喜欢的功能。

* * *

## 回答 #3

> 赞同：19
> 
>             
> 
> 时间：2009-07-04T19:17:30.737

我发现 Netbeans 中用于 PHP 工作的一个最有用的特性是它理解[PHPDoc](http://manual.phpdoc.org/HTMLSmartyConverter/PHP/phpDocumentor/tutorial_tags.return.pkg.html)（与理解 Javadoc 的方式相同），并将其用于类型提示。

在函数定义之前键入`/**`，按回车键，它将创建一个 PHPDoc 模板。

```
/**                              <-- I typed this one line
 * @param <type> $otherObj       <-- Netbeans added these 3 lines
 * @return <type>                <--
 */                              <--
public function exampleFunction($otherObj)
{
    $myObj = new MyClass($otherObj);
    return $myObj;
} 
```

`<type>`用适当的类型替换地标：

```
/**      
 * @param OtherClass $otherObj
 * @return MyClass
 */
public function exampleFunction($otherObj)
{
    $myObj = new MyClass($otherObj);
    return $myObj;
} 
```

瞧，您将使用 Ctrl-space 获得类型完成（和弹出文档）。

* * *

## 回答 #4

> 赞同：17
> 
>             
> 
> 时间：2009-05-29T19:14:43.030

[通过jVi 插件](http://jvi.sourceforge.net/)实现的很棒的 Vi 绑定。

* * *

## 回答 #5

> 赞同：13
> 
>             
> 
> 时间：2010-03-21T16:51:13.340

```
if ($x instanceof SomeClass) {
  $x->.... // now it has code completion with SomeClass' methods.
} 
```

* * *

## 回答 #6

> 赞同：11
> 
>             
> 
> 时间：2010-07-23T15:58:44.553

**具有高级输入的**宏**和**代码模板！****

 ****参数化代码模板**（尝试在 netbeans 中键入 fnc，然后立即按 Tab，然后继续按 Tab 以查看发生了什么，它如何在函数名称和函数参数之间循环 - 查看代码模板内部以了解这是如何完成的）。（选项 > 编辑器 > 代码模板）

一些简单的例子（一些是我做的，一些来自 netbeans）：

*   [forek] 展开为： [foreach ($array as $key => $value) { }] （这个是netbeans自带的，其余的我自己做）

*   [arr] + Tab 扩展为：[array();]

*   [kv] +Tab 扩展为： ['key' => "val", ] (key 和 val 是我可以循环使用的参数并使用 tab 编辑。代码模板如下所示： ['${key}' = > "${val}", ] 其中 [${something}] 是一个模板参数，它会打印 [something]。如果你想要它打印 [$something] 我认为你必须使用三个 ]$] 字符：[ $$${key}])

**编辑：**您可以为带有单个字母的箭头制作代码模板（例如“m”代表 ex），但是当您输入代码时，您必须在字母前放置一个空格，否则它不会识别它。例如：$obj m[press Tab]，展开为 [$obj ->]。中间的空间可以正常工作，并且不是 sintax 错误。
**/编辑**

每次我希望有一个模板时，我实际上插入模板，然后立即使用它并继续进行其余的 php 编程。

**带有快捷方式的**宏****作为迷你代码模板**！（Netbeans > 菜单 > 编辑 > 开始/停止宏录制）**

 **我为 php 制作的最佳***宏***  实际上是代码模板（因为 ' + Tab 由于某种原因不能用作代码模板，只有当模板以字母开头时才有效）（[快捷方式]插入[文本]）：

*   快捷方式 [Ctrl + ;] 插入 [->] （不再有键盘体操，不再羡慕其他语言的 dot sintax :)）

*   快捷方式 [Ctrl + Shift + ;] 插入 [ => ]

* * *

## 回答 #7

> 赞同：9
> 
>             
> 
> 时间：2009-06-04T12:31:46.883

[这个链接](http://netbeans.org/files/documents/40/1935/file_1935.dat?filename=Keyboard%2520Shortcuts%2520Card%25206.1.pdf)有很多方便的键盘快捷键。我有一份打印出来并钉在我电脑旁边的墙上。遗憾的是，我没有看到任何特殊的 PHP 快捷方式。

更新：[http](http://netbeans.org/project_downloads/usersguide/shortcuts60.pdf) : 
//netbeans.org/project_downloads/usersguide/shortcuts60.pdf更新2：http: [//netbeans.org/project_downloads/www/shortcuts.pdf](http://netbeans.org/project_downloads/www/shortcuts.pdf)（7.0）

* * *

## 回答 #8

> 赞同：8
> 
>             
> 
> 时间：2010-03-21T23:00:40.920

我会添加**任务**集成。没有时间完成某事？添加一个 NetBeans 将为您跟踪的简单任务。您可以自定义在 Tasks in 中跟踪的内容`Options -> Miscellaneous -> Tasks`，但我发现下面的格式最有用，因为它与 PHPDoc 注释非常一致（请参阅此处*的*注释）：

```
/**
 * @todo Create public setters and __toString() for this class.
 */ 
```

* * *

## 回答 #9

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T19:09:51.590

Ctrl + Space 是我在 java 编程时最喜欢和最常用的功能，我认为它也适用于 PHP。但是，如果您喜欢网豆，您很可能已经知道它，如果不尝试，请尝试了解它的作用。

此外，通过 Ctrl + 单击从变量到方法调用到类引用的任何内容，导航到相关源代码也是一个不错的功能。

此外，右键单击源代码时显示的弹出菜单包含许多有用的工具，可用于从重构到代码生成的所有内容。

* * *

## 回答 #10

> 赞同：6
> 
>             
> 
> 时间：2010-01-18T21:36:47.853

这听起来微不足道，但我在 Netbeans 中做的一件事是代码格式化。它的代码格式（source->format）很震撼。

它的 SVN 集成也很棒，但这已经说过了。

* * *

## 回答 #11

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T18:50:59.613

快速创建宏的能力。  

例如，这里将在当前行的末尾放置一个分号，并将光标放回宏开始之前的位置。  

“;” 删除前一个插入符号结束行“;” jump-list-last-edit jump-list-last-edit （我知道默认情况下这存在于其他语言实现中。但默认情况下它在 PHP Netbeans 中不起作用。）

作为一个长期坚持使用 IDE 的人，我喜欢能够定制一些小东西来提高效率。

* * *

## 回答 #12

> 赞同：5
> 
>             
> 
> 时间：2009-06-03T10:42:58.723

如果您考虑 Netbeans 6.7，它的同步功能有点像 Dreamweaver

通过添加自定义 ftp 的方式，将其导入项目，当您在本地保存文件时，它们也会上传到服务器，这样您就有了一个半备份系统。

（相信我，这比直接在 ftp 树上工作并意识到当前 tmp 文件和服务器文件之间的传输以某种方式失败并且您因为关闭文件窗口而丢失了工作要好:)）

* * *

## 回答 #13

> 赞同：4
> 
>             
> 
> 时间：2011-04-08T15:34:30.093

NetBeans 还允许您**完全取消停靠各个窗口**。

*操作方法：*

右键单击要移动的窗口的工具栏并选择`Undock window`。选定的窗口变为浮动窗口，允许您将其移到 NetBeans 主窗口之外。

*强调：*

*   您可以将浮动窗口固定到屏幕边框或不同的浮动窗口（不过只是来自 NetBeans 的那些）

*   如果您远离浮动窗口，浮动窗口可以使自己半透明（可通过杂项/外观中的主要设置进行配置）

*   如果您将不同的应用程序移动到任何浮动窗口上，它们会在您再次开始使用 NetBeans 后重新回到顶部

*   记住您的工作区布局，因此所有浮动窗口在各个编码会话之间保持各自的位置（NetBeans 重新启动）

如果您有第二台监视器，这尤其有用，因为它允许您通过将任何补充窗口（文件浏览器、单元测试结果等）从主屏幕移开来最大化源代码的可用空间。好消息是 NetBeans 可以解决通常出现在多窗口应用程序中的大多数烦恼（例如，不同的应用程序覆盖 GIMP 中的各个工具栏）。

* * *

注意：也许这是众所周知的功能，但我今天才设法发现它。它还没有在列表中，所以我添加了它，尽管我前段时间已经用不同的功能回答了它。

* * *

## 回答 #14

> 赞同：3
> 
>             
> 
> 时间：2011-04-28T14:43:43.083

未使用的私有类成员下的波浪线。

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2009-06-04T12:28:33.753

也许是搜索框，在源代码中查找任何内容？

* * *

## 回答 #16

> 赞同：2
> 
>             
> 
> 时间：2009-06-04T12:33:23.603

一些绝对值得关注的功能，包括上面提到的那些：

1.  版本控制集成，包括本地历史

2.  IDE 范围的搜索框

3.  与 Tomcat/Apache 集成，当您希望使用 PHP 和其他服务器端技术（如 JSP）时，GlassFish 会很有帮助

4.  与 MySQL 的良好集成——对 wAMP/LAMP 开发至关重要

* * *

## 回答 #17

> 赞同：2
> 
>             
> 
> 时间：2009-06-08T15:31:59.367

TextMate 是我在 Mac 上一直使用的一款很棒的漂亮小编辑器，但不是 IDE。我不太喜欢 Mac 上的 Netbeans 如此非本地，但在 Windows 或 Linux 上，我更喜欢它而不是 Eclipse。

*   使用 Java 的 Swing GUI 设计器在快速完成项目方面发挥了巨大作用。

*   其他人已经说过了，但是集成的 Subversion 很棒。如果我一直在 Linux 的终端上处理一个项目，它会发现我已经在该目录上签出了 SVN 并且可以很好地处理它。

*   我喜欢代码格式（在编辑器中单击鼠标右键），尤其是当团队成员使用 nano、xemacs 或类似的东西编写间距/缩进很差的代码时。

* * *

## 回答 #18

> 赞同：2
> 
>             
> 
> 时间：2011-05-07T14:10:34.413

令人惊讶的是，没有人谈论过这个很酷的插件。

[http://code.google.com/p/zen-coding/](http://code.google.com/p/zen-coding/)

我发现它对 html 非常有用。PHP 开发人员确实需要它。它添加了很多这样的模板。

下载 netbeans 的 zen-coding 并在工具>选项>代码模板>导入中导入 zip 文件。

* * *

## 回答 #19

> 赞同：2
> 
>             
> 
> 时间：2011-10-31T14:59:22.413

我最喜欢这个：phpunit + 代码覆盖率

* * *

## 回答 #20

> 赞同：1
> 
>             
> 
> 时间：2009-06-08T20:57:04.310

几年前我亲自使用 Eclipse 进行 Java 开发，自从我在 3.5 版中了解 Netbeans 后，它在集成服务器技术方面变得非常好，例如用于 J2EE 应用程序部署、颠覆、uml 和大量插件的 TomCat -ins 适用于不同的技术，而不仅仅是现在的 java。

*   数据库集成（MySQL、Jdb、SQL 编辑器）。

*   PHP 集成和功能的不断进步。

*   Subversion 集成...确实有很大帮助！

*   代码缩进，自定义颜色高亮。

*   如果您是 PHP 开发人员，如果您想扩展 Web 应用程序的专业知识，Ruby on Rails 集成也会有所帮助。

* * *

## 回答 #21

> 赞同：1
> 
>             
> 
> 时间：2009-10-22T14:52:32.877

Netbeans 一直以提供对实验性（尚未发布）技术的支持而闻名，例如 Java 6 EE 预览版、JDK7 支持……

*而且，颠覆支持开箱即用。这与必须使用插件的 Eclipse 有很大不同。使用 Eclipse，我只在 Linux 下遇到问题（JavaHL 问题，blabla ...）。我不记得是谁说的，也不记得它是在哪里写的，但是“开箱即用的支持对用户来说比使用某些插件的能力更重要”。*

# c - 从另一个 C 进程创建一个新的独立进程

> ID：927478
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T18:31:38.653
> 
>         
> 
> 标签：c, process, sockets, exec, fork

存在两个 C 可执行文件 A 和 B。A 和 B 通过套接字相互通信。

B可以独立启动，也可以通过A启动。

1.  如果先启动 B，然后再启动 A，则 A 和 B 可以正常启动而不会出现问题。即使A重新启动，也没有问题。

2.  如果 B 通过 A 启动，则 A 和 B 正常启动。但是这里的通讯口绑定了A和B。这里如果A重启了，那么A就启动失败了。

由于 B 是通过 A 启动的，因此进程 A 是进程 B 的父进程。

那么，有没有什么方法可以让进程 B 独立于进程 A 启动呢？

我们尝试使用fork，但是当我们尝试启动exe时使用fork，正在启动两个进程而不是一个。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:38:17.597

您是否尝试过使用分叉两次的“包装器”可执行文件——一次用于 A，一次用于 B——然后自杀？这将使 A 和 B 作为单独的进程处于活动状态，然后由 init 进程继承，并且应该可以安全地重新启动。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-31T19:38:56.230

您使用的是 Unix 域套接字还是常规网络套接字？

哪个进程，A 或 B，正在侦听套接字（被动打开），哪个正在执行主动打开？

当您决定 A 应该运行 B 时，代码如何确定这是必要的？

你在分叉和执行之前打开套接字吗？

我对所提供信息的印象是：

*   您使用网络套接字

*   B 是听众

但我很容易误会。

我想知道您是否遇到问题，因为 A 在您分叉和执行 B 之前已经创建了活动套接字，所以当 A 终止时，套接字的活动端没有干净地关闭，因为 B 有一个套接字副本打开以供写入以及A. 当你 fork 时，子进程应该在执行另一个进程之前清理不需要的文件描述符（例如套接字）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T23:49:11.587

您确定您正在正确检查**fork()**的返回值吗？

喜欢：

```
pid_t pid;
if (pid == 0) {
    /* child */
}
else if (pid > 0) {
    /* parent */
}
else {
    /* error */
} 
```

# php - 在 PHP 中，如何将参数名称转换为字符串

> ID：927482
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:32:44.457
> 
>         
> 
> 标签：php, string, arguments

我的目标是回显传递给函数的参数。例如，如何做到这一点？

```
$contact_name = 'foo';

function do_something($some_argument){
// echo 'contact_name'  .... How???
}

do_something($contact_name); 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T18:38:18.830

你不能。如果你想这样做，你还需要传递名称，例如：

```
$contact_name = 'foo';
$contact_phone = '555-1234';

function do_something($args = array()) {
    foreach ($args as $name => $value) {
        echo "$name: $value<br />";
    }
}

do_something(compact('contact_name', 'contact_phone')); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:09:04.023

直接从 PHP.net[变量](http://us2.php.net/manual/en/language.variables.php#49997)页面：

```
<?php
  function vname(&$var, $scope=false, $prefix='unique', $suffix='value')
  {
    if($scope) $vals = $scope;
    else $vals = $GLOBALS;
    $old = $var;
    $var = $new = $prefix.rand().$suffix;
    $vname = FALSE;
    foreach($vals as $key => $val) {
      if($val === $new) $vname = $key;
    }
    $var = $old;
    return $vname;
  }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:37:44.557

不可能。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:46:26.287

变量只是寻址内存中的值或区域的手段。您无法获取已将值传递给函数的变量名称。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:53:16.223

**免责声明：仅当您将变量而不是值传递给函数时，这才有效，并且仅当您不在函数或类中时才有效。所以只有 GLOBAL 范围有效:)**

```
Good funct($var)
Bad funct(1) 
```

你可以做到与普遍认为的相反^_^。但它涉及一些使用 $GLOBALS 变量的查找技巧。

你这样做：

```
$variable_name = "some value, better if its unique";

function funct($var) {
   foreach ($GLOBALS as $name => $value) {
      if ($value == $var) {
         echo $name; // will echo variable_name
         break;
      }
   }
} 
```

这种方法不是万无一失的。因为如果两个变量具有相同的值，该函数将获取它找到的第一个变量的名称。不是您想要的：P 如果您想要变量名称的准确性，最好事先使变量值唯一

另一种方法是像这样使用参考来准确

```
$variable_name = 123;

function funct(&$var) {

   $old = $var;
   $var = $checksum = md5(time());  // give it unique value

   foreach ($GLOBALS as $name => $value) {
      if ($value == $var) {
         echo $name; // will echo variable_name
         $var = $old; // reassign old value
         break;
      }
   }
} 
```

所以完全有可能:)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:45:52.810

基于 PTBNL 的（绝对正确）的答案，我想出了一个更具可读性（至少我认为如此）的方法：

```
/**
 * returns the name of the variable posted as the first parameter.
 * If not called from global scope, pass in get_defined_vars() as the second parameter
 *
 * behind the scenes:
 *
 *   this function only works because we are passing the first argument by reference.
 *   1\. we store the old value in a known variable
 *   2\. we overwrite the argument with a known randomized hash value
 *   3\. we loop through the scope's symbol table until we find the known value
 *   4\. we restore the arguments original value and
 *   5\. we return the name of the symbol we found in the table
 */
function variable_name( & $var, array $scope = null )
{
    if ( $scope == null )
    {
        $scope = $GLOBALS;
    }

    $__variable_name_original_value = $var;
    $__variable_name_temporary_value = md5( number_format( microtime( true ), 10, '', '' ).rand() );
    $var = $__variable_name_temporary_value;

    foreach( $scope as $variable => $value )
    {
        if ( $value == $__variable_name_temporary_value && $variable != '__variable_name_original_value' )
        {
            $var = $__variable_name_original_value;
            return $variable;
        }
    }
    return null;
}

// prove that it works:

$test = 1;
$hello = 1;
$world = 2;
$foo = 100;
$bar = 10;
$awesome = 1;

function test_from_local_scope()
{
    $local_test = 1;
    $local_hello = 1;
    $local_world = 2;
    $local_foo = 100;
    $local_bar = 10;
    $local_awesome = 1;

    return variable_name( $local_awesome, get_defined_vars() );
}
printf( "%s\n", variable_name( $awesome, get_defined_vars() ) ); // will echo 'awesome'
printf( "%s\n", test_from_local_scope() ); // will also echo awesome; 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-06-01T19:06:26.680

桑德有正确的答案，但这里正是我正在寻找的东西：

```
$contact_name = 'foo';

function do_something($args = array(), $another_arg) {
    foreach ($args as $name => $value) {
        echo $name;
        echo '<br>'.$another_arg;
    }
}

do_something(compact(contact_name),'bar'); 
```

* * *

## 回答 #8

> 赞同：-3
> 
>             
> 
> 时间：2009-05-29T18:54:17.813

```
class Someone{
  protected $name='';
  public function __construct($name){
    $this->name=$name;
  }

  public function doSomthing($arg){
     echo "My name is: {$this->name} and I do {$arg}";
  }
}

//in main
$Me=new Someone('Itay Moav');
$Me->doSomething('test'); 
```

# gimp - 脚本-fu IDE？

> ID：927485
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:33:51.660
> 
>         
> 
> 标签：gimp, script-fu

在 Gimp 2.6 方案中编程的最佳编程环境是什么？Guile 是否与 Gimp 很好地集成？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-11-14T22:37:00.460

我知道这个问题很老，但我不相信它得到了很好的回答。GIMP 不**使用**Guile。当前的 GIMP 使用 TinyScheme，旧版本使用 SIOD。你最好的开发选择是 Emacs + Quack + TinyScheme。如果您尝试使用 Guile 开发脚本，您将遇到麻烦，因为 TinyScheme 没有提供 Guile 所做的一切。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:36:25.977

当然，EMACS。这是最好的*环境*。

说真的，最好*怎么*做？GIMP方案是Guile，所以EMACS和VIM都应该做的不错；我记得 Eclipse 有一个方案插件；当然还有 PLT Scheme/MzScheme 等。

# architecture - 使用 NServiceBus 时如何跨应用程序共享消息类？

> ID：927490
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T18:35:33.857
> 
>         
> 
> 标签：architecture, messaging, nservicebus

所以我有两个独立的应用程序，我想在它们之间发送消息。我碰巧在使用 NServiceBus，但这并不重要。如何从应用程序 A 向应用程序 B 发送消息并让他们都知道同一个合同？

所以应用 A 有一个 SecretMessage 类...

```
public class SecretMessage : IMessage
{
     public string Title { get; set; }
     public string Body { get; set; }
} 
```

这是将被序列化并通过线路发送到应用程序 B 的对象。

现在在应用程序 B 中，我如何侦听该类型的消息，然后能够将它们反序列化到同一类？所以我可以使用发送的数据，而不会成为维护的噩梦。

应用 B 是否只需要拥有该课程的副本？这是否应该通过每个应用程序都引用的消息类的共享 dll 来处理（我希望不是）？是否应该在每个应用程序中将它们重新创建为具有相同属性的完全独立的 DTO？

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-06-01T14:11:41.690

这可能不是您想要的答案，但这里的灵丹妙药很少。

您实际上只有几个选择，因此取决于您希望消息类中的功能级别和类型强化：

1.  共享 DLL 的好处是它可以是代码 + 结构，例如有用的构造函数、复杂的枚举器、调试 ToString 实现等。强大的版本控制。DLL 需要单独的项目和分发。

2.  共享模式和代码生成。为您的类型声明架构并使用代码生成来创建类。这里有很多不同的策略 - 一些示例：[T4 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)、[自定义代码生成](http://msdn.microsoft.com/en-us/library/aa302301.aspx)、工具和库，例如[CodeSmith](http://www.codesmithtools.com/)或[Proto.Bufs](http://groups.google.com/group/protobuf/)。搜索会发现您加载更多。可以非常强大 - 知道许多代码商店，它们通过使用 CodeGen 从 DB 到 UI 的快速原型设计来启动所有项目。您仍然需要分发架构。

3.  以足够的保真度序列化消息以通过 Code DOM 生成类型。每条消息都会产生携带足够类型元数据以代表它的所有消息实例的成本。例如可空字段的表示。生成消息包装器类型也会有内在的第一次“发现”成本。

4.  以弱结构（例如名称/值对）序列化数据，然后生成类似字典的包装类。弱类型 - 易于扩展。

这些真的是唯一的选择。恕我直言，按此顺序排列的 #2 和 #1 通常是最有用的模式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-06-02T20:03:17.300

正如[Juval Lowy 在 Programming .NET Components 中](https://rads.stackoverflow.com/amzn/click/com/B0026OR34E)所建议的那样，在它们自己的共享 DLL 中分离纯接口。

[http://arcanecode.com/2007/02/14/more-oop-interfaces-in-c-part-2/](http://arcanecode.com/2007/02/14/more-oop-interfaces-in-c-part-2/)

# php - 在单独的服务器上，我可以期望 PHP 和 MySQL 之间有多少个连接？

> ID：927491
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T18:35:35.747
> 
>         
> 
> 标签：php, performance, networking, sockets

试图将我的 LAMP 应用程序分成两台服务器，一台用于 php，一台用于 mysql。到目前为止，应用程序通过文件套接字在本地连接并且工作正常。

我担心如果通过网络可以建立的号码连接。我一直在为基准测试目的在 unix 上测试 tcp 连接，我**知道**你不能超过每秒一定数量的连接，否则它会由于缺乏资源（无论是套接字、文件句柄或其他什么）而停止。*我也知道 php 没有实现连接池，因此对于每个页面加载，必须通过网络建立一个新连接。我还研究了 pconnect for php，它似乎带来了更多问题。* 

我知道这是一个非常常见的设置（php + mysql），任何人都可以提供一些他们从服务器中获得的典型用法和统计数据吗？谢谢！

* * *

该问题与我的 MySQL 允许的连接用完无关。主要问题是 unix**不能**很快地创建和拆除 tcp 连接。套接字以 TIME_WAIT 结束，您必须等待一段时间才能释放更多套接字以再次连接。这两个屏幕截图清楚地显示了这种模式。MySQL 确实工作到某个点然后暂停，因为 Web 服务器用完了套接字。经过一定时间后，Web 服务器能够建立新的连接。

[替代文字 http://img35.imageshack.us/img35/3809/picture4k.png](http://img35.imageshack.us/img35/3809/picture4k.png)

[替代文字 http://img35.imageshack.us/img35/4580/picture2uyw.png](http://img35.imageshack.us/img35/4580/picture2uyw.png)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:38:24.133

我认为限制是 65535。所以你必须同时有 65535 个连接才能达到这个限制，因为常规的 mysql 连接会自动关闭。

[mysql_connect()](http://is.php.net/manual/en/function.mysql-connect.php)

> 注意：一旦脚本执行结束，到服务器的链接将关闭，除非它通过显式调用 mysql_close() 提前关闭。

但是如果你使用的是[持久的 mysql 连接](http://is.php.net/manual/en/function.mysql-pconnect.php)，那么你可能会遇到麻烦。

> 使用持久连接可能需要对 Apache 和 MySQL 配置进行一些调整，以确保不超过 MySQL 允许的连接数。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:15:18.113

每个 MySQL 连接实际上为各种缓冲区使用了几兆内存，并且需要一段时间来设置，这就是 MySQL 默认限制为 100 个并发打开连接的原因。您可以提高该限制，但最好花时间尝试通过各种方法限制并发连接。  

谨防将连接限制提高得太高，因为您可能会耗尽内存（我相信这会使 mysql 崩溃），或者您可能会将重要的事情从内存中推出。例如，MySQL 的性能高度依赖于操作系统自动缓存从磁盘读取的数据到内存中；如果您将连接限​​制设置得太高，您将与缓存竞争内存。

如果您没有提高连接限制，那么在您用完套接字/文件句柄/等之前很久就会用完连接。如果您确实增加了连接限制，那么在您用完套接字/文件句柄/等之前很久就会用完 RAM。

关于限制并发连接：

1.  使用连接池解决方案。没错，PHP 没有内置的，但有很多独立的可供选择。这节省了昂贵的连接设置/拆除时间。

2.  仅在绝对需要时才打开数据库连接。在我当前的项目中，我们会在发出第一个查询时自动打开数据库连接，而不是之前；在我们完成所有数据库工作之后，但在实际生成页面的 HTML 之前，我们也会释放连接。保持连接打开的时间越短，同时打开的连接就越少。

3.  在像 memcached 这样的轻量级解决方案中缓存您可以缓存的内容。我当前的项目临时缓存显示给匿名用户的页面（因为每个匿名用户最终都会获得相同的 HTML——为什么还要在几毫秒后再次运行相同的数据库查询？），这意味着不需要数据库连接全部。这对于匿名流量的爆发特别有用，例如首页挖掘。

# .net - 使用 WCF 让大量并发用户安全地访问 MS-Access 或 Sqlite 或其他基于文件的数据库？

> ID：927496
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:37:28.410
> 
>         
> 
> 标签：.net, wcf, concurrency

我想为数据驱动网站后面的基于文件的数据库编写数据访问层。会有很多并发的更新和读取，我至少希望访问被序列化，这样页面请求就会排成一个很好的有序行。

哪些 WCF 配置可以满足我的需求？PerSession 并发可以让我到达那里吗？

我是不是找错了树，我应该依靠数据库驱动程序来为我处理文件锁定吗？

编辑：我正在尝试组建一个不需要用户处理 MySql 或 SqlServer 的开源日历网站——换句话说，它应该是一个 xcopy 部署。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:42:31.067

您可能希望使用具有单一并发性的单一实例：

```
[ServiceBehavior(
    InstanceContextMode = InstanceContextMode.Single,
    ConcurrencyMode = ConcurrencyMode.Single)] 
```

这将确保所有呼叫“排队”。如果您使用 PerSession 实例上下文，那么您最终会同时调用后端文件。您还需要确保设置自定义限制行为。您可以在配置中或通过代码执行此操作：

```
ServiceThrottlingBehavior throttlingBehavior = new ServiceThrottlingBehavior()
{
    MaxConcurrentCalls = 200,
    MaxConcurrentInstances = 200,
    MaxConcurrentSessions = 200,
};
ServiceHost host = ...
host.Description.Behaviors.Add(throttlingBehavior); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:01:58.577

马修，

你的用例是什么？您是否允许用户临时插入数据库？如果是这样，您最好编写一些代码来获取他们的数据并将其导入 SQL Server 数据库。这样做更好。

如果您担心成本，可以使用 SQL Server Express 或 Postgres。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:10:18.297

Sqlite 可以处理并发读取，因此您不必序列化您的读取。然而，写入是另一回事，它们锁定了完整的 sqlite 数据库。

我不知道 ms-access 如何处理并发。

你在建什么样的网站？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:55:18.590

序列化“大量并发更新和读取”将导致用户性能非常差。我认识到这并不是您问题的真正答案（对前提更具挑战），但是转向更适合 SQL Server 等此类活动的资源管理器会好得多。从架构上讲，试图让用户通过一根稻草查看他们的数据是错误的做法——它通常会导致用户不高兴。

# ldap - 与列表进行比较的 LDAP 查询语法

> ID：927499
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T18:38:10.250
> 
>         
> 
> 标签：ldap

有没有一种方法可以使用类似于 SQL 中的“IN”语句的语法来查询 LDAP？我的意思是提供一个值列表，而不是一次又一次地重复字段名称。

让我解释：）

我有一个类似的查询：  

```
(|(name=joe)(name=bill)(name=mark)(name=john)(name=rob)) 
```

有没有办法缩小这个查询得到这样的东西：  

```
(name=joe,bill,mark,john,rob) 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T18:45:45.880

不幸的是没有。ldapsearch 过滤器必须符合[RFC2254](http://www.faqs.org/rfcs/rfc2254.html)标准。  

但是您始终可以编写自己的包装器（例如调用 ldapsearch 的 shell 脚本），它将您的类似列表的语法重写为正确的 RFC2254 语法:)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-06-25T10:48:38.027

不，但是您想要的结果可以通过多种方式实现。一种是以某种方式将条目组合在一起。可以合理地假设“joe”、“bill”、“mark”和其他人有一些共同点。使用`groupOfUniqueNames`对象类，目录管理员可以将“joe”、“bill”、“mark”和其他人放在一个组中，以便可以检索它们。

或者，如果“joe”、“bill”、“mark”等具有共同的属性，则可以使用动态组，其中组的内容由过滤器确定。例如，如果“joe”、“bill”、“mark”和其他人向同一个经理报告，并且经理的条目是`name=matthew,ou=managers,dc=example,dc=com`，“joe”、“bill”、“mark”，其他人可能有一个属性`managersDn`与价值`name=matthew,ou=managers,dc=example,dc=com`。目录管理员可以使用过滤器创建一个动态组`managerDn=name=matthew,ou=managers,dc=example,dc=com`。动态组的优点是每次作为搜索的一部分时都会更新组，不需要手动更新。

或者，一些专业质量的目录服务器支持使用*虚拟属性*，这些属性会导致基于其他条件为条目生成属性。

可以这么说，假设您搜索的条目以某种方式相关，请使用目录服务器分组机制将它们分组在一起。如果它们不相关，则 then 过滤器必须与您列出的一样，但使用 a`|`而不是 a `&`。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-07-16T22:25:17.463

另外，我猜您希望使用该查询 | 代替 ＆。

# iphone - UITableViewCellEditingStyleInsert 还是 UITableViewCellEditingStyleNone？

> ID：927507
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:41:41.973
> 
>         
> 
> 标签：iphone, cocoa-touch, user-interface

我有类似于`EditableDetailView`SDK 示例的数据编辑控制器。该视图仅在非编辑模式下显示具有值的字段，在编辑模式下，它也将未填充的字段添加为占位符。与 SDK 示例不同，字段集是固定的，因此在编辑期间无需添加新的占位符。

我的问题是是否

*   我应该将绿色 + Insert 放在我的空字段占位符旁边吗？（或者）

*   单击 + 将填充它旁边的占位符，但不会添加新的空占位符。

HIG 在这个话题上并不清楚。

如果我添加 + 看起来会更好，因为所有字段都有一个指示符（红色 - 或绿色 +），但我担心 '+' 操作实际上并没有添加新的占位符。如果我把 + 去掉，它看起来很奇怪，因为有些字段是红色的 - 而其他字段什么都没有。

# asp.net-mvc - MVC 授权 - 多个登录页面

> ID：927509
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T18:42:11.677
> 
>         
> 
> 标签：asp.net-mvc

我在 MVC 控制器中有以下方法，当用户未登录时重定向到登录页面。

```
[Authorize]
public ActionResult Search() {
  return View();
}

[Authorize]
public ActionResult Edit() {
  return View();
} 
```

是否有一种快速/简单/标准的方法可以将第二个操作重定向到与 web.config 文件中定义的页面不同的登录页面？

还是我必须做类似的事情

```
public ActionResult Edit() {
  if (IsUserLoggedIn)
    return View();
  else 
     return ReturnRedirect("/Login2");
} 
```

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-05-29T19:07:13.903

我认为可以通过创建自定义授权过滤器：  

```
public class CustomAuthorization : AuthorizeAttribute
{
    public string LoginPage { get; set; }

    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
        {
            filterContext.HttpContext.Response.Redirect(LoginPage);
        }
        base.OnAuthorization(filterContext);
    }
} 
```

在你的行动中：  

```
[CustomAuthorization(LoginPage="~/Home/Login1")]
public ActionResult Search() 
{
  return View();
}

[CustomAuthorization(LoginPage="~/Home/Login2")]
public ActionResult Edit() 
{
  return View();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:46:22.103

`Web.config`基于表单的身份验证没有内置这样的功能（这适用于 WinForms 和 MVC）。您必须自己处理（通过 HttpModule 或 ActionFilter、您提到的方法或任何其他方法）

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2019-04-12T14:11:47.397

我实现了 user434917 接受的答案，即使我被正确重定向，我也收到错误“发送 HTTP 标头后服务器无法设置状态”。在服务器日志中。经过搜索，我找到了解决问题的[这篇文章](https://stackoverflow.com/questions/2472578/is-it-possible-to-use-redirecttoaction-inside-a-custom-authorizeattribute-clas)（Mattias Jakobsson 的回答）。我结合了答案来获得这个解决方案。

创建自定义授权过滤器：

```
using System.Web.Mvc;
using System.Web.Routing;

namespace SomeNamespace.CustomFilters
{
    public class CustomAuthorization : AuthorizeAttribute
    {
        public string ActionValue { get; set; }
        public string AreaValue { get; set; }
        public string ControllerValue { get; set; }

        public override void OnAuthorization(AuthorizationContext context)
        {
            base.OnAuthorization(context);

            if (context.HttpContext.User.Identity.IsAuthenticated == false)
            {
                var routeValues = new RouteValueDictionary();
                routeValues["area"] = AreaValue;
                routeValues["controller"] = ControllerValue;
                routeValues["action"] = ActionValue;
                context.Result = new System.Web.Mvc.RedirectToRouteResult(routeValues);
            }
        }
    }
} 
```

然后在您的控制器上，使用客户属性。

```
[CustomAuthorization(ActionValue = "actionName", AreaValue = "areaName", ControllerValue = "controllerName")]
public class SomeControllerController : Controller
{
    //DO WHATEVER
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2020-08-10T18:15:04.960

是的很容易！假设您有 2 种不同类型的用户。第一种是普通用户，另一种是管理员。您想让他们从不同的页面登录。您还希望他们能够访问不同的 ActionResult。

首先，您添加了两个不同的方案。在这些方案中，您将定义您想要的不同登录页面和其他选项。

在启动.cs

```
 services.AddAuthentication("UserSceheme").AddCookie("UserScheme", config =>
       {
            config.LoginPath = "/UsersLogin/Login/";
            config.Cookie.Name = "UsersCookie";
        });

        services.AddAuthentication("AdminScheme").AddCookie("AdminScheme", config =>
        {
            config.LoginPath = "/AdminLogin/Login/";
            config.Cookie.Name = "AdminsCookie";
        }); 
```

然后，您将定义两个策略。这里我称它们为**UserAccess**和**AdminAccess**每个策略都将使用我指出的方案。在 startup.cs 中，在方案之后添加以下内容。

```
 services.AddAuthorization(options =>
        {
            options.AddPolicy("UserAccess", policy =>
            {
                policy.AuthenticationSchemes.Add("UserScheme");
                policy.RequireAuthenticatedUser();
            });
            options.AddPolicy("AdminAccess", policy =>
            {
                policy.AuthenticationSchemes.Add("AdminScheme");
                policy.RequireAuthenticatedUser();
            });
        }); 
```

我们要做的最后一件事是再次告诉我们登录时要使用的方案。

```
 var userPrincipal = new ClaimsPrincipal(new[] {
            new ClaimsIdentity(loginClaims, "ServiceCenter")
     });
     HttpContext.SignInAsync("AdminScheme",userPrincipal); 
```

就是这样！现在我们可以像这样使用它们；这会将您重定向到用户登录页面。

```
 [Authorize(Policy = "UserAccess")]
    public IActionResult Index()
    {

        return View();
    } 
```

如果您有一些地方希望两种用户类型都能够访问您所要做的一切；

```
 [Authorize(Policy = "AdminAccess")]        
    [Authorize(Policy = "UserAccess")]
    public IActionResult Index()
    {

        return View();
    } 
```

最后，对于注销，您还必须指出该计划

```
 public async Task<IActionResult> Logout()
    {
        await HttpContext.SignOutAsync("AdminScheme");
        return View();

    } 
```

就是这样！

# visual-studio-2008 - C#/VS2008 中 WCF 项目上的 F5 产生 WcfSvcHost.exe 错误

> ID：927514
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:43:23.700
> 
>         
> 
> 标签：visual-studio-2008, wcf

我的项目在 VS2008/C# 和一个 WCF 服务库中。尝试测试服务，按 F5。获取 WcfSvcHost.exe 错误，这是下面的更多详细信息

```
Error Signature:
AppName: wcfsvchost.exe  AppVer: 9.0.622.1152    ModName: mscorwks.dll
ModVer: 2.0.50727.3082   Offset: 00080012 
```

IDE 回到正常代码模式，并且 WcfTestClient.exe 通过我的服务调用启动，但当然我可以调用任何服务，因为我的服务无法启动。

我不得不删除 spybot 和 teatimer.exe 并重新启动我的系统，现在我收到了这个错误

附加错误：

```
An unhandled win32 exception occured in WcfSvcHost.exe[5132] 
```

附加信息：我认为它与 VS2008 无关。我尝试自行启动我的 WcfSvcHost.exe，但出现以下错误

```
Unhandled exception at 0x01e30430 in WcfSvcHost.exe: 0xC0000005: Access violation reading location 0x01e30430. 
```

从事件查看器记录

```
Faulting application wcfsvchost.exe, version 9.0.622.1152, stamp 488f124d, faulting module ntdll.dll, version 5.1.2600.5755, stamp 49901d48, debug? 0, fault address 0x00011129. 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:04:42.960

在查看错误的详细信息后，我认为这不是`wcfsvchost`问题，而是`ntdll.dll`文件损坏的问题。

请阅读**[此信息](http://pcsupport.about.com/od/fixtheproblem/a/ntdlldll.htm)**以获取有关如何解决此问题的详细信息。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T02:21:31.797

不确定其中哪一个解决了它，但这就是我所做的 1\. 删除了 IE 的谷歌工具栏

2.  删除了 Git 扩展

3.  重启机器

4.  从 sart->run 运行 sfc /scannow

这似乎已经完成了现在的伎俩，但是......

# svn - 单个开发人员是否值得从 SVN 转到 Git？

> ID：927515
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2009-05-29T18:43:48.397
> 
>         
> 
> 标签：svn, git

**--- 这个线程很可能在 2013 年就已经过时了 ---**

当存储库主要由单个开发人员访问时，是否值得从 SVN 转到 GIT？我有几台机器用于开发，而不是主要用 C# 开发。但我的存储库中混合了 VB、VB.Net、PHP、C#、C++、HTML、Batch、BASH 等等。从 SVN 迁移到 GIT 会得到什么（如果有的话）？现在使用 TortoiseSVN + VisualSVN 服务器和一组中央存储库和几台客户端机器。虽然我已授予一些朋友访问我的存储库的权限，但他们并不经常更新或提交（如果有的话）。

还有一种方法可以让我使用 VisualSVN Server + TortiseSVN 和 Git 获得灵活性和易于维护吗？

（（（我会咬一口......对于单个开发人员/小组来说，还有哪些其他平台和技巧会引人注目？）

请列出优点和缺点，而不仅仅是片面的意见。

当前工具链... Visual Studio 2008 (C#/VB.Net) + TortoiseSVN + VisualSVN

主要关注点... XNA 游戏、WCF/Socket 服务、Web 开发

* * *

## 回答 #1

> 赞同：23
> 
>             
> 
> 时间：2009-05-29T19:07:03.700

我可以给你三个好处：

1.  您可以有多个备份存储库。Git 不是集中式的，因此您可以将您的存储库保存在您正在使用的任何机器上，并将更改推送到您拥有的任何备份位置。我将我的存储库保存在[github](http://github.com)和其他两个位置。

2.  分支，合并，变基，修改提交，git bisect。仅仅因为你是一个单一的开发者，没有理由不使用最好的工具。

3.  git-svn - 你可以在你下定决心的同时尝试一下你的颠覆回购。

有一个缺点；那就是 Windows 上可用的可视化工具不像其他平台上可用的那样用户友好。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-05-29T19:41:57.437

是的当然。

你误解了 git 是什么。我的意思是，你为什么认为它只对团队有用？

如果你是一个开发者，git 就更值得了。

## 优点：

*   svn 需要一个服务器在后台运行。另一方面，git 是一个简单的实用程序，您只需像运行`grep`或`ls`任何其他简单的命令行实用程序一样运行它。您不需要设置任何服务器或类似的东西。

*   .git 文件夹是整个存储库，您可以随身携带它（例如，在 USB 记忆棒上），它会始终包含您的存储库。你的整个回购，连同它的历史，以及其他一切，它实际上压缩得很好，所以它不会占用太多空间。（提示：这就是 git 不需要服务器的原因；当您运行 git 命令时，git 只会更改 .git 文件夹的内部结构）。

*   分支和合并非常容易。您可以在单独的分支上处理实验性新功能，并且仅在其稳定时才合并。同时，您可以在主分支上进行维护工作（例如错误修复），同时您可以轻松地将主分支中的错误修复合并到您的实验（主题）分支中。

*   这一点是主观的，但我发现它比svn容易得多。我尝试使用 svn 有一段时间，但发现它太复杂了，而且经常妨碍我（我不完全记得是什么以及为什么是，我只知道这不是一次愉快的体验）。例如，重命名文件不是问题。您可以重命名文件，git 不会大惊小怪，它只是不关心文件名。唯一的事情是，你必须记住在重命名后添加它，就好像你创建了一个新文件一样。

## 缺点：

*   视觉工具不多。有一个 git-gui，还不错，（我没怎么用过）但你不想依赖它。您需要习惯从命令行使用它。如果你习惯于使用 svn 的可视化工具，这可能是一个缺点，但在我看来，唯一的缺点是你必须走出你的舒适区来学习它；但相信我，这是值得的。

*   windows上的行尾可能存在一些问题，如果你是唯一的开发人员，这不是一个大问题，但是如果你在windows上开发而其他人在linux上开发，你需要确保所有文件都使用unix-样式行结束而不是 windows'，以避免任何问题。

*   由于缺乏可视化工具，解决冲突（当它们出现时）一开始可能会有些麻烦。我个人使用 WinMerge，并`winmergeu <conflictfile>`在每个冲突文件上调用该命令来解决冲突。（注意：WinMerge 不是一个命令行合并工具，它是一个可视化的合并工具，带有一个普通的 gui）。

*   这让我想到了另一点。虽然开始使用 git 真的很容易，但可能有一些学习曲线来处理稍后出现的问题（例如冲突解决）。如果你不分支和合并，那么你甚至不会遇到冲突，但是你也会错过一个非常强大的功能。

### 更新：

我没注意到你在几台不同的机器上工作。

这没有什么区别，你只需要记住每次切换到另一台机器时都要推拉，但你已经用 svn: commit/update 做到了。

您将获得分支/合并的力量。不要低估这种力量。

你有多少次想过实现一些疯狂的想法，但因为不想弄乱你的代码而不敢去做？git 可以让你摆脱这些烦恼。只需在分支中执行，如果可行，将其合并到主分支，如果没有，则删除分支并忘记它。

当然，你可能会说你可以对 进行同样的操作`svn revert`，在你开始这个疯狂的想法之前恢复到修订版。但是，如果您同时应用了错误修复怎么办？如果您恢复您的疯狂想法，您将失去在尝试您的疯狂想法时所做的所有错误修复/维护工作。

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2009-05-29T19:42:15.907

除了已经说过的，如果你是一个单一的开发人员并且没有遇到过 SVN 的麻烦，我认为没有理由切换。svnserve（守护进程）在本地运行良好（我有 OS X）。

与 Git 工具相比，TortoiseSVN 是一种优势……您有什么特别的原因想要放弃 Subversion 吗？

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2009-05-29T19:03:02.507

这真的取决于你的工作流程。您是否经常在无法访问 svn 服务器的地方工作？您的项目是否有大量分支，因为您喜欢同时处理多个（大）事情？您是否在机器之间复制工作副本？您是否从现有分支中分离出新分支？您是否有时在主干上工作，并且在进行大量更改时认为“我应该在分支中完成”？如果是这样，那么它可能很有用。

从单个开发人员的角度来看，像 svn 这样的中央系统和像 git 这样的分散系统之间的主要区别在于，在 svn 中，修订是线性的。使用 git 它是一棵树。当您处理想要在多个提交中完成的更大功能时，这很有用。

示例：您有一个大特征 F，它由更改 a、b、c 和 d 组成。使用 Subversion，您要么在主干上分别提交 a、b、c 和 d，要么创建一个分支，这意味着您必须进行大量合并。使用 git，您可以检查工作副本，并在其上提交 a、b、c 和 d。然后你会把它作为一个单一的变化 F 推送给你的主人。因此，您在主干上只看到一个提交，而不是四个提交。这使得从日志中更容易看到正在发生的事情。

你也可以用 svn 分支来做到这一点。但是现在假设 a 部分也由多个部分组成，例如 a1 和 a2。

这样的开发模型可以用 Subversion 来完成。例如，Python Twisted 就是这样完成的。所有开发都在分支上完成，没有人在主干上工作。但是 git 使这样的工作流程更容易。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T19:32:10.560

我已经按照您描述的方式在 Windows 下使用 Visual Studio 2008 使用了这些系统：

*   视觉源安全

*   颠覆

*   水银

*   吉特

如果你珍惜你的生命，**永远***不要* 使用 Visual Source Safe...

 **### 颠覆

*   优点：优秀的工具，无论是在服务器端还是客户端。[VisualSVN](http://www.visualsvn.com)和[TortoiseSVN](http://tortoisesvn.tigris.org/)。

*   缺点：它不能很好地处理合并。

### 吉特

*   优点：出色的合并支持，速度快。

*   缺点：Windows 工具几乎不存在，确实存在的 GUI 工具太可怕了，我希望我不必再使用它们了。*（我的意见）*

### 水银

*   优点：出色的合并支持，不错的工具。[TortoiseHG](http://bitbucket.org/tortoisehg/stable/wiki/Home)和[VisualHG](http://sharesource.org/project/visualhg/)，基于 Python 的挂钩脚本可以用 Python 编写，直接挂钩到 HG api。

*   缺点：工具不如 SVN。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:00:06.757

Git 可能引人注目的一件事是您可以继续工作并离线提交。因此，当您在飞机上时，请带上您的笔记本电脑并像往常一样提交。当您重新上线时，您可以推送回您的主仓库。

如果你发现你做了很多分支，你可能会更喜欢 Git，因为它的设计目的是让分支/合并变得容易和司空见惯。

**更新：**请注意，您无需提交即可测试 Git，因为[Git 可以与 SVN repos 对话](http://utsl.gen.nz/talks/git-svn/intro.html)。所以试一试，如果你不喜欢它，什么都没有！

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:11:13.427

试试看，安装[msysgit](http://code.google.com/p/msysgit/)，然后

```
git svn clone svn://mysvn/repo/ 
```

[Git 初学者的](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide)一些资源：权威的实用指南应该有所帮助（尤其是[Gitcasts](http://www.gitcasts.com/)和[Git Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)）

就我个人而言，我发现 git 通常使用起来更愉快。大约两年前，我将我的个人 SVN 存储库切换到 git，并且从未遇到过任何问题

不必担心您的 SVN 服务器很好（无需持续的网络访问），因此能够轻松创建存储库（它们只是包含另一个文件夹的`.git`文件夹），执行任何操作（提交、分支等等） )，然后决定用一两个简单的命令将代码放到 Github 上。

它通常更“敏捷”（几乎每个动作基本上都是即时的），一切都“离线”工作，克隆是完整的备份..但我继续使用它的主要原因是[Github](http://github.com)

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:58:34.840

不，至少对我来说不是。为单个开发人员提供非集中式存储库有什么意义？

此外，Git Windows 工具还不能满足 TortoiseSVN 的要求。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:08:20.423

看看集市（bzr）。说真的，这太神奇了。我见过的最好的合并能力。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2011-05-19T19:51:51.607

前段时间我做了从 svn 到 Git 的迁移。我同意上面关于 Git 分布式架构优于 svn 的几个答案（比如能够在记事本上随身携带我的 repo），但令人信服的原因要平凡得多。

*   svn相当麻烦，它把他的东西（.svn文件夹）到处乱放。这使得很难在 .svn 存储库上使用常见的命令行工具，如 grep（和许多其他工具）。在我的项目中，我还有一些安装过程需要将完整的资源树复制到某个系统路径。使用 svn 时，我必须编写额外的代码（或导出存储库），以避免我的安装过程也复制 .svn。使用 Git 后，这类问题完全消失了。一切都在存储库根目录下的**一个.git 目录中。**

如今（2/2013）根文件夹中只有一个 .svn 文件夹！

*   我在 Linux 上使用 svn 客户端有过几次糟糕的体验，看似简单的操作，例如移动文件，然后在提交之前修改它，导致系统挂起，使用 100% CPU！（不，这不是导致崩溃的其他原因，我可以随意重复它）。使用 Git 工具从未遇到过此类问题。

*   在我的旧 svn 存储库上合并主干和稳定分支之间的代码时，我也遇到了一些糟糕的情况。使用 Git 真的很容易。

现在，我采取了这一举措，因为使用 svn 真的让我感觉很糟糕，如果它对你有用，那么真的没有必要改变。程序员的真正任务是处理代码，存储库只是至少不应该妨碍他的工具。这正是为什么 svn 对我不起作用的原因。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:28:48.727

如果您习惯于 Tortoise SVN，那么您应该尝试 Mercurial，它有一个 Windows 包，具有​​类似的外壳扩展[Tortoise HG](http://www.selenic.com/mercurial/wiki/TortoiseHg)。Joel Spolsky 也在 Fog Creek 使用 Mercurial（根据他在他的一个播客中的说法）。

该软件包是完全独立的，我可以立即安装和使用 Mercurial（甚至不需要服务器！）

# sql - 从 vb.net 导入数据库的问题

> ID：927523
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:46:30.310
> 
>         
> 
> 标签：sql, vb.net, shell

我正在尝试使用 vb.net 将表导入安全的 sql 数据库，但它似乎超时（或者我认为）并且没有正确导入（空值），我截断表以保存字段类型，然后调用shell() 函数来导入文件和

'清除验证导入表中已有的数据

```
cmd.CommandText = "TRUNCATE TABLE HedgeFileBuilders.dbo.HedgeInput_" & strProduct & "_VALIDATOR;"
cmd.ExecuteNonQuery()

're-import the inforce file to validate it

Try
    If chkSQLServerSource Then
    Shell(SQLLOCALDIR & "Prog\bcp.exe FileBuilders.dbo.Input_" & strProduct   & "_VALIDATOR in " & strFileName & "  -c -t , -r \n -S server -U user -P passkey -F 2 -h TABLOCK", AppWinStyle.Hide, True)
    Else
    Shell(SQLLOCALDIR & "Prog\bcp.exe FileBuilders.dbo.Input_" & strProduct & "_VALIDATOR in " & strFileName & "  -c -t , -r \n -S pcname -T -F 2 -h TABLOCK", AppWinStyle.Hide, True)
    End If
Catch ex As Exception
    MessageBox.Show("ERROR: An error occurred while re-importing the new business file.  Contact the system administrator.  " & ex.Message, "Contact System Administrator", MessageBoxButtons.OK, MessageBoxIcon.Error)
    Exit Sub
End Try 
```

'这不会返回和错误，但结果为空。我在 SQL 中手动进行导入，它可以工作（所有数据都在那里）。我什至使用上面 vb 代码中指示的 strFilename 和 Table 名称来确保在手动导入时我没有弄错名称。

我究竟做错了什么？

PS我在上面的布尔值'True'之后尝试了超时整数参数'-l'，但它没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T07:43:39.817

我建议将您正在执行的字符串（在本地变量中构建）与已知良好工作批处理/cmd文件中的类似字符串进行比较。

此外，如果您的 bcp.exe 目录有空格，则需要在字符串中的整个可执行路径周围使用双引号。strFilename 也是如此。

基本上，验证您的代码中是否正在生成对同一文件的已知良好的手动命令行导入。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-06-10T19:31:05.917

我尝试导入的表中的数据类型与被截断并添加导入数据（null 和非 null 等）的 SQL 表不同，我修复了要匹配的数据类型，并且 shell 命令行按预期工作。

# jquery - 从隐藏的 Div 表单中删除值

> ID：927525
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:46:46.003
> 
>         
> 
> 标签：jquery, forms, input, hidden

隐藏 div 时有没有办法删除表单输入/选择值？

示例：假设我有一个要填写的表格。我有几个不同的选择，每个都会以不同的形式显示不同的 div 并隐藏其余部分。但是当我提交时，它仍然提交那些表单值，即使 div 被隐藏。

是否可以删除所有隐藏的表单值？

如果可能的话，我更喜欢 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:49:39.930

```
$(divyoujusthid).find(':input').attr('disabled', true); 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:51:38.333

您可以使用[:hidden](http://docs.jquery.com/Selectors/hidden)选择器并禁用所有隐藏输入。

前任：

```
$(':input:hidden').attr('disabled', true); 
```

编辑：从 null 更改为禁用，根据 Chaos 的建议简化选择器

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:50:21.380

您可以遍历隐藏 div 的所有输入元素并禁用它们。禁用的表单输入不提交任何内容。

# sql-server - 在 SQL Server 2005 中查找多个数据库的大小

> ID：927526
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T18:46:50.903
> 
>         
> 
> 标签：sql-server, database, sql-server-2005, size

我想知道是否有一条 sql 语句来获取服务器上所有数据库的当前大小，而不是右键单击并转到每个数据库的属性。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T18:55:19.247

如果您可以使用存储过程，这应该可以工作：

```
exec sp_msforeachdb 'use ? exec sp_spaceused' 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T18:54:52.430

查看[sys.master_files](http://msdn.microsoft.com/en-us/library/ms186782.aspx)表。

此查询将为您提供实例中所有内容的总大小：

```
SELECT SUM(size*8192.0) AS totalsize
FROM sys.master_files; 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-09-23T11:41:04.027

最简单的方法是使用：

```
exec [sys].[sp_databases]
go 
```

这会产生类似的东西：

```
Name        Size  Remarks
mydatabase1 29888 NULL
mydatabase2 13760 NULL
mydatabase3 11776 NULL
master      5376  NULL
model       3008  NULL
msdb        7616  NULL
tempdb      2560  NULL 
```

对于与数据库关联的事务日志的大小，请使用：

```
dbcc sqlperf(logspace)
go 
```

这会产生类似的东西：

```
Name        Log Size (MB) Log Space Used (%) Status
master      1.242188      50.9434            0
tempdb      0.7421875     61.25              0
model       0.7421875     38.94737           0
msdb        1.992188      35.88235           0
mydatabase1 5.554688      18.55661           0
mydatabase2 2.742188      32.9594            0
mydatabase3 8.992188      26.58015           0 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-09-23T12:14:59.977

```
exec sp_helpdb 
```

在一张漂亮的表中列出服务器上所有数据库的数据大小、所有者、创建日期等。

然后，如果您想深入研究特定数据库以查看可以使用的各个表大小

```
use MyFunkyDb
go
EXECUTE sp_MSforeachtable 'EXECUTE sp_spaceused [?]' 
```

# svn - 在源代码管理中，每个项目拥有一个大存储库还是一个存储库更好？

> ID：927530
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:48:38.090
> 
>         
> 
> 标签：svn

> **可能重复：**
> 
>   [一个 SVN 存储库还是多个？](https://stackoverflow.com/questions/252459/one-svn-repository-or-many)

我觉得不言自明。我得到了相关问题的列表，但我认为没有人真正回答这个问题

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T18:51:30.080

这是一个有争议的话题，之前已经在 SO 上提出了许多类似的问题：

*   [一个 SVN 存储库还是多个？](https://stackoverflow.com/questions/252459/one-svn-repository-or-many)

*   [跨多个项目的 Subversion 修订号](https://stackoverflow.com/questions/15674/subversion-revision-number-across-multiple-projects)

*   [SVN：一个工作副本，两个存储库？](https://stackoverflow.com/questions/580443/svn-one-working-copy-two-repositories)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T18:53:13.480

我认为这取决于项目的规模。如果你有很多小项目，你应该使用一个 repo，但是，真正的大项目可能会从拥有多个存储库中受益。

它还可能取决于有多少人在项目上工作，如果您有多个部门在一个项目上工作，等等。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T18:54:29.280

我投票支持大型回购，Apache 就是这样做的，他们的软件 ROCKS！这对我来说是一个很好的成功证明。

立即查看[他们的 repo](http://svn.apache.org/repos/asf/)，修订版 780066！

# asp.net - 显示网页中的表单

> ID：927537
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:50:54.483
> 
>         
> 
> 标签：asp.net, vb.net

我有一个问题，我正试图以一种优雅的方式解决。我有一个我创建的 .net 应用程序。我正在尝试从网页中显示其中一种形式。我承认这听起来很奇怪，所以这是背景故事

我们有一些大型显示器在工作，可以显示有关它们的信息。我无法控制信息的显示方式。目前，他们只是使用浏览器并在浏览器中使用选项卡在屏幕上显示每条不同的信息。他们显示的大部分信息只是标准的 html 内容、文本和图像。

现在出现了我的 winforms 应用程序。我需要展示的应用程序部分是图形显示。这个显示器上的所有东西都是使用 GDI+ 绘制的，如果这很重要的话。我需要把这个表格变成我可以展示的格式。以下是我自己的解决方案，但我很确定这不是最好的方法，但它可能是我可以使用的唯一方法

创建一个控制台应用程序。应用程序将执行以下操作 1\. 在服务器上作为服务运行 2\. 在内存中创建显示，并每隔一段时间将其保存到位图 3\. 将位图保存到网络上的某个位置。4.有一个HTML文件，链接可以在浏览器中显示的图像

我想和客户一起做点什么，但是客户并不总是在工作，所以我可能会有一段时间不会更新图像。我也在考虑一个 ASP.net 解决方案，但这需要我学习 ASP.net，而且我还没有准备好接受这个挑战

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T22:52:07.037

在 IE 中，您可以将 winforms 应用程序/控件作为 ActiveX 控件托管，如下所示：

```
<object id="DateTimePicker" height="31" width="177" 
  classid="bin/Web.Controls.DateTime.dll#Web.Controls.DateTime.DateTimePicker" VIEWASTEXT>
</object> 
```

有关详细信息，请参阅本文：http: [//www.codeproject.com/KB/miscctrl/htmlwincontrol.aspx](http://www.codeproject.com/KB/miscctrl/htmlwincontrol.aspx)

现在，我并不是说这比您的解决方案更优雅，但它是一种替代方案。

我认为使用 Asp.Net 使用 HttpHandler 提供动态图像将是最好的方法，但根据您的技能和时间，这可能不是一个选择。这是一个很好的教程： http: [//www.codeguru.com/columns/dotnet/article.php/c11013](http://www.codeguru.com/columns/dotnet/article.php/c11013)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T23:17:53.087

恕我直言，构建它的最佳方式是作为浏览器插件，就像 Flash 的工作方式一样。[Microsoft 创建了一个名为SpicIE](http://code.msdn.microsoft.com/SpicIE)的插件框架，它允许您为 IE 开发托管插件。这可能是你最好的选择。

旧的非托管方式是构建您的 WinForms dll 应用程序，然后将其打包到签名的 cab 文件中，然后使用 HTML 对象标记引用该 cab 文件（代码库 arg 是您需要的那个）。

IE，

```
document.write("<object CLASSID='clsid:DC187740-46A9-11D5-A815-00B0D0428C0C' CODEBASE='/MyFormsApp/MyFormsApp.cab#Version=1,00,0000' />"); 
```

用户第一次点击页面时，他们将被要求允许安装程序加载其有效负载（dll）。一旦他们这样做，他们将拥有一个通过浏览器窗口运行的完全成熟的 WinForms 桌面应用程序。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-02T12:29:41.103

我在这个上采取了简单的路线。我创建了一个小型 winform 应用程序，将 GDI 对象转换为位图，然后将位图保存到网络共享。此文件在监视器上显示的简单 HTML 文件中引用。

我选择了 winform 应用程序，因为它让我很容易在任务管理器中进行设置，并且每 10 分钟运行一次以进行更新。

# xml - XmlSlurper - 列出 xhtml 文档的文本和常规节点

> ID：927545
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T18:52:24.340
> 
>         
> 
> 标签：xml, parsing, groovy

我正在使用 Groovy 的 XmlSlurper 来解析 xhtml 文档（或 sudo xhthml 之一），并且我正在尝试获取文档的文本节点但不知道如何，这里是代码：

```
import groovy.util.*

xmlText = '''
<TEXTFORMAT INDENT="10" LEADING="-5">
  <P ALIGN="LEFT">
    <FONT FACE="Garamond Premr Pro" SIZE="20" COLOR="#001200" LETTERSPACING="0" KERNING="0">
      Less is more! this 
      <FONT COLOR="#FFFF00">should be all</FONT>
      the 
      <FONT COLOR="#00FF00"> words OR should some </FONT>
      OTHER WORDS will be there?
    </FONT>
  </P>
</TEXTFORMAT>
'''
records = new XmlSlurper().parseText(xmlText)
records.P.FONT.children().eachWithIndex {it, index -> println "${index} - ${it}"} 
```

打印以下输出：

```
0 - should be all 
1 -  words OR should some 
```

但我希望它也打印文本节点内容，因此所需的输出是：

```
0 - Less is more! this
1 - should be all
2 - the 
3 - words OR should some
4 - OTHER WORDS will be there? 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T21:41:59.987

看起来 XmlSlurper 没有单独的方法来检索“混合内容”

这里有一个打开的项目来添加支持混合内容的方法 -> [Groovy JIRA](http://jira.codehaus.org/browse/GROOVY-2115)

# python - 解析 HTTP 用户代理字符串

> ID：927552
> 
>         
> 
> 赞同：53
> 
>         
> 
> 时间：2009-05-29T18:53:46.723
> 
>         
> 
> 标签：python, http, http-headers, user-agent

在 Python 中解析用户代理字符串以可靠检测的最佳方法是什么

1.  浏览器

2.  浏览器版本

3.  操作系统

或者可能是任何帮助库

* * *

## 回答 #1

> 赞同：74
> 
>             
> 
> 时间：2009-07-20T06:24:40.673

我终于决定自己写了，我对结果很满意。请随时使用/修改/向我发送补丁等。

它在这里： http: [//pypi.python.org/pypi/httpagentparser](http://pypi.python.org/pypi/httpagentparser)

使用示例：

```
>>> import httpagentparser
>>> s = "Mozilla/5.0 (X11; U; Linux i686; en-US) AppleWebKit/532.9 (KHTML, like Gecko) \
        Chrome/5.0.307.11 Safari/532.9"
>>> print(httpagentparser.simple_detect(s))
('Linux', 'Chrome 5.0.307.11')
>>> print(httpagentparser.detect(s))
{'os': {'name': 'Linux'},
 'browser': {'version': '5.0.307.11', 'name': 'Chrome'}}

>>> s = "Mozilla/5.0 (Linux; U; Android 2.3.5; en-in; HTC_DesireS_S510e Build/GRJ90) \
        AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1"
>>> print(httpagentparser.simple_detect(s))
('Android Linux 2.3.5', 'Safari 4.0')
>>> print(httpagentparser.detect(s))
{'dist': {'version': '2.3.5', 'name': 'Android'},
'os': {'name': 'Linux'},
'browser': {'version': '4.0', 'name': 'Safari'}} 
```

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-08-27T09:10:50.527

[Hicro Kee 的 UASparser for Python](http://user-agent-string.info/download/UASparser-for-Python) 
。通过版本检查从远程服务器自动更新数据文件和缓存。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2012-06-21T23:25:03.523

Werkzeug 内置了用户代理解析。

新链接（2018 年 6 月）
 [http://werkzeug.pocoo.org/docs/0.14/utils/#module-werkzeug.useragents](http://werkzeug.pocoo.org/docs/0.14/utils/#module-werkzeug.useragents)

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2014-12-24T21:08:03.497

对这个问题的其他回答现在已经相当老了。我相信浏览器用户代理解析的新标准是 Browserscope 的[用户代理解析器](https://github.com/ua-parser/uap-python/)。

*   [UA解析器pypi包](https://pypi.python.org/pypi/ua-parser) 

*   [github上的UA解析器](https://github.com/ua-parser/uap-python)

在[许多其他语言](https://github.com/ua-parser)中也可以方便地使用*完全相同的匹配模式*。有一天，您可能还想在 JavaScript 中解析一些 UA 字符串，而不必担心解析不一致。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2012-04-11T16:25:00.467

[在针对Firefox User Agents 的完整语料库](http://www.useragentstring.com/pages/Firefox/)运行这些建议后，我发现用于比较的版本号解析非常差。

如果这是您需要的，我建议您查看[UAparser](https://github.com/dinomite/uaParser)，它曾经是[browserscope](http://code.google.com/p/browserscope/)项目的一部分。[文档在这里。](http://code.google.com/p/browserscope/wiki/UserAgentParsing)

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-05-30T05:28:49.337

浏览[器上限解析器](http://www.djangosnippets.org/snippets/267/)应该可以工作。不过可能有点慢。。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:25:27.500

但是，如果您希望在 Python 端解析所有这些，您可以使用[http://browsers.garykeith.com/downloads.asp](http://browsers.garykeith.com/downloads.asp)提供的 XML/INI 文件在用户代理上进行查找。这与 php 的 get_browser() 函数中使用的文件相同。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2020-10-27T17:38:20.783

由于这不是关于开源解决方案，我怀疑这将成为第一个答案。无论如何，当涉及到 User-Agent 分析时，事实上的标准是 WURFL（现在是商业产品。

这是对技术文档的参考。

[https://docs.scientiamobile.com/documentation/infuze/infuze-python-module-user-guide](https://docs.scientiamobile.com/documentation/infuze/infuze-python-module-user-guide)

除此之外，[WURFL 微服务可在主要的云提供商市场上使用，并且还支持 Python 客户端](https://www.scientiamobile.com/products/wurfl-microservice/)：

# msmq - 监控 MSMQ

> ID：927561
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:56:07.123
> 
>         
> 
> 标签：msmq, cluster-computing

我正在尝试使用 MSMQ 本地管理 API 和 mgmtinfo.exe 实用程序监视 Server 2003 群集中的远程私有 msmq。我可以使用以下命令列出集群资源上的队列：

```
mgmtinfo.exe server-name machine 
```

但无法获取有关各个队列的信息。我很难制作正确的格式名称：

```
mgmtinfo.exe queue=<FORMAT NAME> 
```

私有（集群）队列的格式名称是什么？我已经看到了对 guid 的引用，但我找不到与队列相关的一个……有人有建议吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:26:24.117

尝试

> FormatName:DIRECT=OS:servername\private$\queuename

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:45:41.190

如果队列是私有队列： .\private$\YourCustomQueue

我认为其他队列是 .\system$\ 和 .\outgoing$ 。

# php - 当 mkdir 从 PHP 失败时如何找到原因？

> ID：927564
> 
>         
> 
> 赞同：24
> 
>         
> 
> 时间：2009-05-29T18:56:47.467
> 
>         
> 
> 标签：php, error-reporting, mkdir

PHP 的 mkdir 函数只返回 true 和 false。问题是当它返回 false 时。

如果我在启用错误报告的情况下运行，我会在屏幕上看到错误消息。我还可以在 Apache 日志中看到错误消息。但我想获取消息的文本并用它做其他事情（例如通过 IM 发送给我自己）。如何获取错误文本？

**更新：**按照艾曼的想法，我得出了这个结论：

```
function error_handler($errno, $errstr) {
    global $last_error;
    $last_error = $errstr;
}

set_error_handler('error_handler');
if (!mkdir('/somedir'))
    echo "MKDIR failed, reason: $last_error\n";
restore_error_handler(); 
```

但是，我不喜欢它，因为它使用全局变量。对更清洁的解决方案有任何想法吗？

* * *

## 回答 #1

> 赞同：66
> 
>             
> 
> 时间：2009-05-30T10:22:55.317

您可以[抑制警告](http://us.php.net/manual/en/language.operators.errorcontrol.php)并使用[`error_get_last()`](http://us.php.net/manual/en/function.error-get-last.php)：

```
if (!@mkdir($dir)) {
    $error = error_get_last();
    echo $error['message'];
} 
```

* * *

## 回答 #2

> 赞同：19
> 
>             
> 
> 时间：2009-05-30T10:31:08.683

你可以使用例外：

像这样设置一些代码：

```
function exception_error_handler($errno, $errstr, $errfile, $errline ) {
    throw new ErrorException($errstr, 0, $errno, $errfile, $errline);
}
set_error_handler("exception_error_handler"); 
```

然后做：

```
try {
   mkdir('/somedir');
} catch(ErrorException $ex) {
   echo "Error: " . $ex->getMessage();
} 
```

那应该做你想做的事。

如果你想保留 php 错误处理程序，那么在 try catch 块之后，只需调用：

```
restore_error_handler() 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2013-03-24T21:01:10.927

我使用如下内容：

```
if(! @mkdir('$fileLocation', 0777, $recursive = true)){
    $mkdirErrorArray = error_get_last();
    throw new Exception('cant create directory ' .$mkdirErrorArray['message'], 1);
} 
```

# php - PHP Soap 问题：服务器无法处理请求。---> 对象引用未设置为对象的实例

> ID：927566
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T18:57:03.160
> 
>         
> 
> 标签：php, web-services, soap

我将 PHP 5.2.5.5 与 Moodle 1.9 一起使用。

当我进行不带参数的简单 SOAP 调用时，它可以工作。但是，一旦我使用带参数的调用，它就会失败。如果我使用 Fiddler 捕获 SOAP 请求，我发现它根本没有将参数添加到 soap 请求中。

这是我的示例代码：

```
$WSDL = 'http://www.nanonull.com/TimeService/TimeService.asmx?WSDL';
$client = new SoapClient($WSDL);
$response = $client->getUTCTime(); // WORKS
$response = $client->getTimeZoneTime('ZULU');  // SOAP FAULT 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:18:04.677

您还需要传递该参数的名称（并传入一个数组）：

```
$WSDL = 'http://www.nanonull.com/TimeService/TimeService.asmx?WSDL';
$client = new SoapClient($WSDL);
$response = $client->getUTCTime(); // WORKS

$response = $client->getTimeZoneTime(array('timezone'=>'ZULU')); //works
print_r( $response); 
```

见：[http ://www.nanonull.com/TimeService/TimeService.asmx?op=getTimeZoneTime](http://www.nanonull.com/TimeService/TimeService.asmx?op=getTimeZoneTime)

和： http: [//www.nanonull.com/TimeService/TimeService.asmx](http://www.nanonull.com/TimeService/TimeService.asmx)

杰克

# c# - 在 C# 中，确定数据库是否已启动并正在运行的最佳方法是什么？

> ID：927567
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T18:57:14.437
> 
>         
> 
> 标签：c#, .net, database, ado.net

我想出了以下方法来确定数据库是否已启动并正在运行。这会尝试打开一个数据库连接，如果失败则返回 false。

```
private static bool IsDatabaseConnectionUp(string connectionString)
{
    System.Data.SqlClient.SqlConnection conn = null;

    try
    {
        conn = new SqlConnection(connectionString);

        conn.Open();

        return conn.State == System.Data.ConnectionState.Open;
    }
    catch (SqlException)
    {
        // There was an error in opening the database so it is must not up.
        return false;
    }
    finally
    {
        if (conn != null)
        {
            if (conn.State == System.Data.ConnectionState.Open)
            {
                conn.Close();
            }

            conn.Dispose();
        }
    }
} 
```

这是确定该数据库是否已启动的最佳方法吗？我不喜欢这种方法的原因是它依赖于超时值，并且只要设置了超时值就可以了。  

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:00:34.620

这实际上取决于您要确定的内容。如果您真的想确定“服务器是否正在运行，并且能够被访问”，那么我会说这很可能是最有效的方式。我这么说的原因是服务器本身可能已启动，但它可能不接受连接，或者应用程序正在使用的连接可能无效（用户名/密码不正确）。

因此，鉴于此，超时是必要的，因为您想验证真正的连接。如果您想简单地查看服务器是否在那里，您可以尝试 ping，但这只是告诉您设备是否处于活动状态，不一定告诉您 SQL Server 是否完全启动并运行并且可用。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:07:01.050

由于您专门查看 SQLServer 连接，因此将连接字符串放入 SqlConnectionStringBuilder 对象并更改超时值。

```
SqlConnectionStringBuilder csb = 
   new SqlConnectionStringBuilder(connectionString);
csb.ConnectTimeout = 5;
string newConnectionString = csb.ToString(); 
```

这样您就可以控制超时值。请记住，不要将其设置得太低，否则您会得到误报。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:06:10.613

您的模式很接近，但存在一个问题。因为 SQLConnection 实现了 IDisposable，所以您确实应该在返回测试连接之前对其进行处理。

```
try
    {
        using (System.Data.SqlClient.SqlConnection conn = new SqlConnection(connectionString))
        {

            conn.Open();

            return conn.State == System.Data.ConnectionState.Open;
        }
    }
    catch (SqlException)
    {
        // There was an error in opening the database so it is must not up.
        return false;
    } 
```

至于其他张贴者所说的，如果您只想查看数据库实例是否正在运行，您可以枚举系统上的进程，或者使用命令行访问来测试数据库，但是这些选项中的任何一个完全依赖于数据库供应商。您的方法通常适用于大多数应用程序。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:00:14.777

如果您对该特定数据库（而不是整个数据库服务器）的状态感兴趣，那么是的，那将是最好的方法。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:08:25.647

如果您担心超时，您可以尝试一些事情......

您可以尝试 ping 服务器。除非禁止 ICMP 数据包，否则如果您的服务器已关闭，这将更快地告诉您。如果无法ping通，则无法连接。显然，不能保证你可以连接，但是当你不能连接时，它会让事情变得更快。

您可以为服务器启动连接测试使用不同的连接字符串。您通常不需要完整的默认时间来建立连接，因此您可能会大大降低它。

如果您可以允许稍微陈旧的数据，您可以有一个服务每隔 X 分钟（5 或 10 分钟或其他任何时间）检查一次连接，然后向该服务询问最新信息。这更像是[见证人](http://msdn.microsoft.com/en-us/library/ms175191.aspx)的行为方式。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:10:01.277

这可能是一个简化的代码片段，但您不应该有 conn.Dispose() 或 using(...) {...} 语句吗？

编辑：没关系，我看到了评论。

# c# - 如何从 .NET 调用 C 库

> ID：927569
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T18:57:22.283
> 
>         
> 
> 标签：c#, .net, asp.net, c

我有一个需要从 ASP.NET / C# 应用程序调用的 C 库，我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T19:01:28.190

[DLL导入]

看看[http://pinvoke.net/](http://pinvoke.net/) - 这应该会让你继续前进！祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:01:51.963

P/Invoke 在这里是你的朋友，假设你的意思是一个真正的“原始”DLL，而不是一个用 C 实现的 COM 对象。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:02:18.297

如果是 DLL，您可以使用[P/Invoke](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)对其进行函数调用。

# asp.net - asp.net 未处理的异常

> ID：927571
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T18:57:51.240
> 
>         
> 
> 标签：asp.net, vb.net, exception

我有一个应用程序已经在生产中运行了一段时间，它时不时地抛出一个我在 global.asax 会话错误事件中捕获的异常异常。此过程会发送一封电子邮件，其中包含错误消息、错误来源和堆栈，这些信息通常足以让我们找到问题。但是，此特定错误没有整个堆栈。它显然在到达堆栈中的我的应用程序之前就死了。

以下是通过电子邮件发送给我的信息。通过我的应用程序中的一些其他日志记录，我可以找到它正在发生的页面，但是如果堆栈没有显示我的应用程序的任何代码，我真的不知道从哪里开始。在这里的任何帮助将不胜感激。

错误信息：

消息：对象引用未设置为对象的实例。

来源：System.Web

堆：

在 System.Web.UI.WebControls.ImageButton.RaisePostBackEvent（字符串 eventArgument）

在 System.Web.UI.WebControls.ImageButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent（字符串 eventArgument）

在 System.Web.UI.Page.RaisePostBackEvent（IPostBackEventHandler sourceControl，字符串 eventArgument）

在 System.Web.UI.Page.RaisePostBackEvent（NameValueCollection postData）

在 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:01:35.397

有没有抱怨的用户？

否则不会打扰 - 这可能是由机器人浏览器触发的，或者用户在意外点取消他的请求，以及许多其他原因。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:02:21.980

我会开始查看引发错误的页面，然后查看您拥有的各种图像按钮控件。我的猜测是动态加载的控件，没有重新加载。

在看到代码之前我们不能说太多

# c++ - 编译 C++ 程序导致“致命错误 LNK1104”

> ID：927574
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T18:57:58.820
> 
>         
> 
> 标签：c++, visual-studio, compilation

我正在尝试在命令提示符下使用以下命令编译 c++ 应用程序：

```
cl -I"c:\Program files\Java\jdk1.5.0_07\include" -I"c:\program files\java\jdk1.5.0_07\include\win32" -MD -LD HelloWorld.cpp -FeHelloWorld.dll 
```

但是，这会产生以下错误：

> 链接：致命错误 LNK1104：无法打开文件“MSVCRT.lib”

您对导致此问题的原因以及如何解决此问题有任何想法吗？

我在 Windows 上安装了 Visual Studio 2005。

谢谢，

-皮特

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-29T19:02:00.793

> 链接：致命错误 LNK1104：无法打开文件“MSVCRT.lib”
> 
> 关于是什么原因以及如何解决它的任何想法？

链接器需要指向 MSVCRT.lib 的位置，因为它似乎不在您的 LIBPATH 中。

它应该在这里：**C:\Program Files\Microsoft Visual Studio 7\VC\lib**

添加`-link -LIBPATH:"C:\Program Files\Microsoft Visual Studio 8\VC\lib"`

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2011-03-03T06:20:04.513

在 MS Visual Studio 2008 中解决此问题。

1.  转到菜单项目-> 属性 (Alt+F7)

2.  配置属性

3.  链接器 -> 常规 -> 附加库目录 -> C:\Program Files\Microsoft Visual Studio 9.0\VC\lib

....执行上述步骤并享受

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2017-05-18T14:54:04.023

在命令提示符下运行以下命令“C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat”

然后在相同的命令提示符下工作。

# postgresql - 架构补丁实践

> ID：927578
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T18:59:27.553
> 
>         
> 
> 标签：postgresql, schema, patch

我们在 Postgres 中有一个模式，我们想建立一个很好的方法来应用模式补丁。

目前，我们有一系列创建模式、表、序列、函数等的 DDL 文件。我们还有一个用于测试环境的填充脚本。这些文件都用于重新创建我们的数据库环境，用于开发、测试等。

我们还有许多与我们系统版本相对应的“补丁”文件。IE。patch/1.0.0.sql、patches/1.0.1.sql 等。这些文件用于更新我们的暂存和生产数据库。

到目前为止，这个过程对我们有效，但内部存在一些关于如何最好地修补模式的争论。

我很好奇其他人有什么作为一个过程来修补登台和生产模式以及如何管理数据库的版本。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-30T00:41:05.040

在工作中，对于 SQL Server，我们编写架构更改脚本，首先回滚要进行的更改（幂等，因此即使架构更改尚未应用，回滚部分也可以正常运行），然后是应用更改的部分. 在 TSQL 中，很容易在系统目录或其他表中查看表/列/索引/行是否已经存在，如果不存在则不执行任何操作。

在 PostgreSQL 中，您可以简单地发送到服务器的命令受到更多限制——但另一方面，DDL 是事务性的，因此不应该发生半应用模式更改。我已经将我在工作中习惯的方案很好地用于我自己的小项目（矫枉过正？但即使在这里我也有一个开发/测试数据库和一个“真实”数据库），例如：

```
\echo Rolling back schema change #35

BEGIN;

DELETE FROM schema_version WHERE schema_id = 35;

DROP TABLE IF EXISTS location_coordinates;
DROP FUNCTION IF EXISTS location_coordinates_populate();

END;

\echo Applying schema change #35

BEGIN;

INSERT INTO schema_version(schema_id, description) VALUES(35, 'Add location_coordinates table');

CREATE TABLE location_coordinates(
 location_id INT PRIMARY KEY REFERENCES location(location_id),
 latitude FLOAT NOT NULL,
 longitude FLOAT NOT NULL,
 earth_coordinates earth NOT NULL,
 box_10miles cube NOT NULL
);

GRANT SELECT, INSERT, UPDATE, DELETE ON location_coordinates TO ui;

CREATE FUNCTION location_coordinates_populate() RETURNS TRIGGER LANGUAGE 'plpgsql' AS $$
BEGIN
  new.earth_coordinates := ll_to_earth(new.latitude, new.longitude);
  new.box_10miles := earth_box(new.earth_coordinates, 10 * 1609.344);
  RETURN new;
END
$$;

CREATE TRIGGER location_coordinates_populate BEFORE INSERT OR UPDATE ON location_coordinates
 FOR EACH ROW EXECUTE PROCEDURE location_coordinates_populate();

INSERT INTO location_coordinates(location_id, latitude, longitude)
 SELECT location_id, latitude, longitude FROM location WHERE latitude IS NOT NULL AND longitude IS NOT NULL;

CREATE INDEX location_coordinates_10miles ON location_coordinates USING gist (box_10miles);

END;

\echo Done 
```

只需使用“psql -f schema-changes/35.sql”即可在数据库上运行此脚本。通过只删除“正在应用...”消息，我可以获得将其回滚的命令。如您所见，更改维护了一个元数据表“schema_version”，因此我可以看到应用了哪些更改。整个更改以事务、数据迁移等方式完成。在这里，我使用了 DROP 命令的“IF EXISTS”功能来使回滚部分快乐，即使更改未应用。Istr 我们为 Oracle 所做的一件事是将模式更改编写为 PL/SQL——您也许可以在 plpgsql 中提供一些函数来帮助进行更改？

请注意，在上面的更改中，我将“纬度”和“经度”列（可以为空）从“位置”迁移到单独的“位置坐标”关系（并添加了 earthdistance 的东西），我没有t 删除旧列。我们必须注意的一件事是尽可能使模式更改向后兼容。因此，我可以在更新应用程序以使用新表*之前应用此架构更改。*我将进行第二次更改以删除旧列以*在之后应用*更新应用程序。在工作中，这些将在两个不同的发布周期中完成，因此在发布 X 期间，我们仍然可以选择回滚应用程序以发布 X-1，而不必先回滚所有架构更改；以及能够在应用程序之前在单独的窗口中部署架构更改。（从技术上讲，我应该编写一个触发器，以便对旧表的更新同步到新表，但我没有，因为这太像工作了 :)）

我们还有一个应用程序，它可以爬取我们所有的数据库以查看`schema_version`表中的内容并跟踪更改，因此人们甚至可以在无需连接的情况下查看进行了哪些更改，并了解每个更改的历史记录（我们跟踪“在开发中回滚”、“在开发中应用”等）。在工作中，我们的 schema_version 表还包括作者信息等。从版本控制中应用版本信息的一种神奇方式会很酷 - 我们遇到的一个问题是，例如，如果在 QA 中应用 SC，然后在 Perforce 中进行更改，则可能不会-一个通知。因此，跟踪应用了架构更改 35 修订版 #4 的方法会很好。

需要注意的一件事——对我们来说，架构更改的编号与应用程序版本无关。显然它们是相关的——这是蜘蛛应用程序允许人们进入的另一件事——但我们尝试进行很多小的更改，而不是一个巨大的“这里是发布 X 的所有内容”补丁。架构更改也用于添加新索引之类的事情，因此可能根本不是应用程序驱动的。通常，模式更改由开发人员“拥有”，而不是 DBA - 尽管在上面的“创建索引”示例中，DBA 基本上扮演开发人员角色并拥有模式更改。是的，我们坚持要求开发人员具备高水平的 SQL 能力——尽管公司中的其他团队的工作方式有所不同，并且将更多的工作交给了 DB 团队。

# c# - 在 .NET 中创建 Open XML 文件 - 架构

> ID：927582
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:00:21.420
> 
>         
> 
> 标签：c#, xml, visual-studio-2005, schema

我正在尝试为我的老板在 C# 应用程序中创建一个报告生成器，我遇到了这个页面并查看了 RichTextBoxes，并认为我可以基于这个想法来做我老板正在寻找的东西。[http://openxmldeveloper.org/articles/OpenXMLDocFromDotNet.aspx](http://openxmldeveloper.org/articles/OpenXMLDocFromDotNet.aspx)

我遇到的问题是他们的 XML 部分示例代码，假设您在 Office 2007 测试版中创建应用程序。此处列出的架构不适用于零售 Office 2007。谁能告诉我在哪里可以找到有关架构的更多信息，或者解释代码在此处执行的操作？或者，如果有人对基于富文本框的内容创建 .docx 文件有不同的建议，我们将不胜感激。我发现不同的资源提供了与此类似的建议：http: [//nishantrana.wordpress.com/2007/11/03/creating-word-document-using-c/](http://nishantrana.wordpress.com/2007/11/03/creating-word-document-using-c/)

但我一直无法让它识别 WordApp 是什么。

这是第一个链接中包含架构问题的代码。

```
private void GenerateDocument_Click(object sender, EventArgs e)
{
    string _nameSpaceURI = "http://schemas.microsoft.com/office/word/2005/10/wordml";
    string docFileName = GetSavePath();

    //-- Step 1 - Creating the document xml
    XmlDocument doc = new XmlDocument();
    XmlElement _wWordDoc = doc.CreateElement("w:wordDocument", _nameSpaceURI);
    doc.AppendChild (_wWordDoc);
    XmlElement _wbody = doc.CreateElement("w:body",_nameSpaceURI);
    _wWordDoc.AppendChild(_wbody);
    // Check if the string contains a line feed
    string[] _SplitStr = mleTextForDocument.Text.Split('\n');
    // if it contains line feed then each entry with a line feed goes to a new paragraph.
    for (int row = 0; row < _SplitStr.Length; row++)
    {
         XmlElement _wp1 = doc.CreateElement("w:p",_nameSpaceURI);
         _wbody.AppendChild(_wp1);
         XmlElement _wr1 = doc.CreateElement("w:r", _nameSpaceURI);
         _wp1.AppendChild(_wr1);
         XmlElement _wt11 = doc.CreateElement("w:t", _nameSpaceURI);
         _wr1.AppendChild(_wt11);
         XmlNode _wt1 = doc.CreateNode(XmlNodeType.Text, "w:t",_nameSpaceURI);
         _wt1.Value = _SplitStr[row];
         _wt11.AppendChild(_wt1);
    }

    //-- Step 2 - Creating the Package
    Package package = null;
    package = Package.Open(docFileName, FileMode.Create, FileAccess.ReadWrite);

    //-- Step 3 - Create the main document part (document.xml)
    Uri uri = new Uri("/word/document.xml", UriKind.Relative);
    PackagePart part = package.CreatePart(uri, "application/vnd.ms-word.main+xml");
    StreamWriter partWrt = new StreamWriter(part.GetStream(FileMode.Create, FileAccess.Write));
    doc.Save(partWrt);
    partWrt.Close();
    package.Flush();

    //-- Step 4 - Create the relationship file
    uri = new Uri("/word/document.xml", UriKind.Relative);
    PackageRelationship rel = package.CreateRelationship(uri, TargetMode.Internal, "http://schemas.microsoft.com/office/2006/relationships/officeDocument", "rId1");
    package.Flush();

    //-- Step 5- Close the document.
    package.Close();
 } 
```

很抱歉没有明确的问题，但我真的不知道要问什么问题。我以前从未使用过模式，从未使用过 XML，也从未向我的项目添加引用。任何意见或建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-30T00:52:10.290

忽略这个模棱两可的问题，显然它来自我的 bizzaro 邪恶双胞胎 (nwonknu) (elgoog)，开个玩笑。

[无论如何，我之前](https://stackoverflow.com/questions/231323/convert-xmlnode-to-xnode/828179#828179)已经说过，我会再说一遍XML/OpenXML*质量*建议*的*来源是[Eric White](http://blogs.msdn.com/ericwhite/default.aspx)。他是一个非常活跃的博主，看起来 4 年多以来一直在发帖（有时好的资源会消失），无论如何，他的博客轻而易举地浏览了几分钟，我相信你对 OpenXML + Linq 2 XML 的掌握会有点更坚实。

 *# python - str.startswith() 没有按我的预期工作

> ID：927584
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:00:37.443
> 
>         
> 
> 标签：python, string, python-3.x

我正在尝试测试 /t 或空格字符，但我不明白为什么这段代码不起作用。我正在做的是读取文件，计算文件的位置，然后记录文件中存在的每个函数的名称以及它们各自的代码行。下面的代码是我尝试计算函数的位置的地方。

```
import re

...
    else:
            loc += 1
            for line in infile:
                line_t = line.lstrip()
                if len(line_t) > 0 \
                and not line_t.startswith('#') \
                and not line_t.startswith('"""'):
                    if not line.startswith('\s'):
                        print ('line = ' + repr(line))
                        loc += 1
                        return (loc, name)
                    else:
                        loc += 1
                elif line_t.startswith('"""'):
                    while True:
                        if line_t.rstrip().endswith('"""'):
                            break
                        line_t = infile.readline().rstrip()

            return(loc,name) 
```

输出：

```
Enter the file name: test.txt
line = '\tloc = 0\n'

There were 19 lines of code in "test.txt"

Function names:

    count_loc -- 2 lines of code 
```

如您所见，我对该行的测试打印显示了 /t，但 if 语句明确表示（或者我认为）它应该只在不存在空白字符的情况下执行。

这是我一直在使用的完整测试文件：

```
def count_loc(infile):
    """ Receives a file and then returns the amount
        of actual lines of code by not counting commented
        or blank lines """

    loc = 0
    for line in infile:
        line = line.strip()
        if len(line) > 0 \
        and not line.startswith('//') \
        and not line.startswith('/*'):
            loc += 1
            func_loc, func_name = checkForFunction(line);
        elif line.startswith('/*'):
            while True:
                if line.endswith('*/'):
                    break
                line = infile.readline().rstrip()

    return loc

 if __name__ == "__main__":
    print ("Hi")
    Function LOC = 15
    File LOC = 19 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-29T19:03:30.430

`\s``re`在进行模式匹配时只是包的空白。

因为`startswith`，普通字符串的普通方法，`\s`没什么特别的。不是模式，只是字符。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T21:04:44.133

您的问题已经得到解答，这有点离题，但是......

如果要解析代码，使用解析器通常更容易且不易出错。如果您的代码是 Python 代码，Python 会附带几个解析器（[tokenize](http://docs.python.org/library/tokenize.html)、[ast](http://docs.python.org/library/ast.html)、[parser](http://docs.python.org/library/parser.html#module-parser)）。对于其他语言，您可以在 Internet 上找到很多解析器。[ANTRL](http://www.antlr.org/)是一个有名的 Python[绑定](http://www.antlr.org/wiki/display/ANTLR3/Example)。

例如，以下几行代码打印 Python 模块中不是注释和文档字符串的所有行：

```
import tokenize

ignored_tokens = [tokenize.NEWLINE,tokenize.COMMENT,tokenize.N_TOKENS
                 ,tokenize.STRING,tokenize.ENDMARKER,tokenize.INDENT
                 ,tokenize.DEDENT,tokenize.NL]
with open('test.py', 'r') as f:
    g = tokenize.generate_tokens(f.readline)
    line_num = 0
    for a_token in g:
        if a_token[2][0] != line_num and a_token[0] not in ignored_tokens:
            line_num = a_token[2][0]
            print(a_token) 
```

如上`a_token`已解析，您也可以轻松检查函数定义。您还可以通过查看当前列 start 来跟踪函数的结束位置`a_token[2][1]`。如果你想做更复杂的事情，你应该使用 ast。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:05:08.463

您的字符串文字不是您认为的那样。您可以像这样指定空格或 TAB：

```
space = ' '
tab = '\t' 
```

# c# - 使用 MDF SQL Server 文件而不是“数据库”是否会影响性能？

> ID：927598
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:03:03.333
> 
>         
> 
> 标签：c#, asp.net, sql-server, asp.net-mvc

目前我的网站是使用 SQL Server 数据库以 ASP.NET Webforms 编写的。我计划构建一个 ASP.NET MVC 应用程序不是因为它更好，而是因为我想学习这项技术。我的问题更具体到数据库。我可以创建数据库并通过 Web 界面的导入功能将我的 SQL 表导入 SQL 数据库，或者我可以使用“本地”数据库 MDF 文件。我喜欢使用 MDF 文件的想法，因为它更容易备份和处理。我的网站没有得到很多流量...事实上我可能是唯一的用户。:) 现在问题来了。

使用本地 SQL Server MDF 文件代替我的数据库将获得多少性能损失？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:06:46.057

实际上没有。或者实际上只是让数据库与网站在同一个盒子上运行。它仍然是一个 Sql Server Express 数据库。生产方面，您可能希望数据库在专用于服务数据库的单独盒子上运行。但在代码方面，唯一的区别是您的连接字符串。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:07:27.240

SQL Server 对其服务器上的每个数据库都使用一个 MDF 文件。MDF 文件和“数据库”之间没有区别，因为“数据库”无论如何都存储在 MDF 文件中。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:11:12.507

性能方面，您不应该看到差异。

最大的问题是生产部署和管理。管理标准数据库比动态附加的 .mdf 容易得多。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:20:58.290

另外，不要忘记您的虚拟主机也必须支持这一点。由于 SQL Server Express 是唯一支持“用户实例”数据库的 SKU，主机必须安装 Express 才能按原样使用它。OTOH，您可以通过这种方式进行开发，然后只需部署数据库并在部署到 Web 主机时更改连接字符串。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:36:25.763

除了 SQL Server Express 版本的正常资源限制之外，唯一的区别是启动成本可以忽略不计，而 SQL Express 引擎连接到 MDF 文件，执行文件完整性和事务日志内容的例行检查。  

这应该只发生在应用程序启动时，而不是每个请求。

# html - 有什么方法可以将一些样式繁重的 HTML 与网站的其他样式隔离开来？

> ID：927604
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T19:04:50.960
> 
>         
> 
> 标签：html, css, email

我正在尝试找出一种在我客户的网站上显示电子邮件通讯存档的方法。问题是时事通讯充满了无数的内联样式，这非常适合在 Outlook 或任何地方看到它们，但它们在其他样式精美的网站中看起来并不太热。  

我的目标是让我的客户能够复制生成的时事通讯的整个源代码（她的列表管理公司* 允许她访问）并将其粘贴到 CMS（drupal，如果它有所作为）。

*经常联系？邮件黑猩猩？我忘了。其中之一。

然后我想在她的网站上显示它，在网站其余部分的基本结构（标题、导航等）内。如果这是 1997 年，我会说“iframe！” 并完成它，但是A）这似乎是一个蹩脚的解决方案，并且B）代码本身实际上并不存在于页面上，我认为这是iframe所必需的。

我可以在这块 HTML 周围放置某种标签，以将其与网站的其他样式隔离开来吗？还是有另一种方法可以完全解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:45:10.570

IFrame 是我能找到的唯一方法。唯一的替代方法是覆盖新闻通讯显示区域的父页面 CSS 中的每个样式。

正如您所指出的，使用 iframe 可能需要您将新闻通讯托管在一个独立的文件中。我知道的唯一替代方法是您可以使用 JavaScript 动态创建和/或填充 iframe。

如果您使用此方法，您可以将时事通讯显示在具有特定类的 div 中，然后使用 JavaScript 将 div 移动到 iframe 中。最大的缺点是对于没有启用 JavaScript 的用户不会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2018-08-22T14:15:47.980

9年后，仍然没有更好的解决方案。

如果您没有外部源（您不能手动将 html 添加到框架中），则需要使用 js 插入杂乱的 html/css（在我的情况下，我使用它来查看电子邮件）

```
<iframe class="my-frame" width="100%" height="100%" src="about:blank"></iframe> 
```

和js：

```
const frame = document.querySelector('.my-frame');

frame.contentWindow.document.open('text/html', 'replace');
frame.contentWindow.document.write(hereGoesYourMessyHtmlCss);
frame.contentWindow.document.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:54:00.597

有没有你不能使用模态的原因？这将允许您强制一个新请求并通过不应用您的通用样式表来使页面呈现您想要的方式，同时让您的用户保持在所需的页面上。当然，可以这么说，它不会显示元素内联，但它在功能上几乎是等效的。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-31T22:19:48.590

在我看来，剪切和粘贴原始 HTML 会带来太多的安全问题。永远不要相信用户的输入。即使内容完全是良性的，下周时事通讯的设计者也可能会决定更改其格式或合并一些 JavaScript，而您将对任何可能出错的事情负责。

因此，我将实现一个解析器，它会删除除内容部分之外的任何内容，只留下 b、a、h*、blockquote 和类似的简单元素，如论坛帖子中允许的元素，以及它们的样式。之后，您可以将其显示为 CMS 中的普通帖子。我看不出有什么理由看起来会有所不同。

至于如何将其与其他 CSS 隔离开来，如果您注意 CMS 的所有 CSS 规则都适用于具有特定类的元素，则实际上不需要这样做。或者，对您的帖子进行 CSS 重置：

```
.post p {
     margin: 0;
     ... 
.post /* all the standard CSS reset rules preceded with .post */ 
```

接着

```
<div class="post"> content parsed from your CMS </div> 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2020-08-25T12:16:44.857

我自己没有使用过但希望在类似情况下使用的另一个选项是使用[Shadow DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM)，它是[Web Components](https://developer.mozilla.org/en-US/docs/Web/Web_Components)规范的一部分。我主要担心的是我们仍然有一些用户在使用 IE 11，虽然似乎支持 polyfills，但根据我在[其他地方读到](https://stackoverflow.com/questions/47902255/are-web-components-actually-useable-in-ie11-and-edge)的内容，覆盖所有浏览器似乎并不是真正直接的。

可以在[此处](https://css-tricks.com/styling-a-web-component/)和[此处](https://css-tricks.com/encapsulating-style-and-structure-with-shadow-dom/)找到有关如何使用 Shadow DOM 实现此效果的一些详细信息。我还创建[了一个小要点](https://gist.github.com/jpierson/95d21a3233a93f51bbe9c7faa8a7c81f)，以展示我在了解 Shadow DOM 如何工作时一直在制定的基本想法，随着我了解更多，我将对其进行更新。您可以在下面看到该要点内容的快照。

```
<!doctype html>
<html>

<head>
    <style>
        .row {
            display: flex;
        }

        .column {
            flex: 50%;
            padding: 10px;
            height: 300px;
        }

        * {
            color: Red;
        }
    </style>
</head>

<body>
    <div class="row">
        <div class="column" style="background-color:#aaa;">
            <h2>Column 1</h2>
            <div id="content1">
                SOME CONTENT FROM CMS
            </div>
        </div>
        <div class="column" style="background-color:#bbb;">
            <h2>Column 2</h2>
            <div id="content2">
                SOME MORE CONTENT FROM CMS
            </div>
        </div>
    </div>

    <script>
        document
            .getElementById("content1")
            .attachShadow({ mode: 'open' })
            .innerHTML = `
                <style>
                    *{all:initial} 
                    style{display: none}
                    div{display: block}
                </style>
                <h3>This text is not red</h3>
                <div>slot content: <slot></slot></div>`;

        document
            .getElementById("content2")
            .attachShadow({ mode: 'open' })
            .innerHTML = `
                <style>
                    *{all:initial} 
                    style{display: none}
                    div{display: block}
                </style>
                <h3>This text is not red</h3>
                <div>slot content: <slot></slot></div>`;
    </script>
</body>

</html> 
```

# database - 在数据库或应用程序中实现外键？

> ID：927611
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:05:49.023
> 
>         
> 
> 标签：database, foreign-keys

如果我想实现 Category 和 Classified 之间的关系，是否需要数据库级可为空的外键，或者应用程序是否可以/建议在不使用数据库约束的情况下定义这种类型的关系？

[注：由于白点表示“可选”，黑点表示“必需”，因此对于每个类别，可能存在或可能不存在对应的分类。此外，它们之间的鱼尾纹表明这是多对多的关系。]

[![替代文字](https://i.stack.imgur.com/buqPI.png)](https://i.stack.imgur.com/buqPI.png)

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:09:45.880

由于它是多对多关系，因此您需要一个交叉引用表而不是简单的外键列。

所以 Category 表没有 FK to Classified，而 Classified 也没有 FK to Category。相反，您可以有一个新表：

```
XrefCategoryClassified
  FK to Category NOT NULL
  FK to Classified NOT NULL 
```

这是实现多对多关系的典型方式。现在，如果两条记录不相关，您不必担心可空字段，您只需关心外部参照记录的存在与否

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:07:06.367

为什么不两者都用？

出于某种原因，外键、检查约束等被称为“声明性引用完整性”。他们保护您的数据。如果您在下个月添加批量加载，或者您必须运行 SQL 脚本来更改数据怎么办？

另一点是数据库引擎是正确的工具。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:19:53.627

如果没有令人信服的理由不这样做，我会在数据库级别强制执行引用完整性；毕竟这（部分）是 RDBS 的优点。

而且由于您可能会有某种映射表来定义 Category 和 Classified 之间的多对多关系，因此将约束放在那里似乎很容易。您的查询将在以后感谢您。

# django - Django Formset.is_valid() 额外表单失败

> ID：927619
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-05-29T19:07:12.843
> 
>         
> 
> 标签：django, django-forms, formset

在我的 Django 应用程序应用程序中，我有一个从简单（非模型）表单创建的表单集，其中 extra=1（以允许 javasript 稍后添加更多表单）。

```
class SomeForm(forms.Form):
    #some fields with required=False
    length = forms.IntegerField(required=False)

    # An example of one of the fields with choices i have
    A = 0
    B = 1
    C = 2
    D = 3

    choices = ((A, 'Aah'), (B, 'Baa'), (C, 'Caa'), (D, 'Daa'))

    # This is a required choice field
    pickme = forms.ChoiceField(choices=choices)

SomeFormset = formset_factory(SomeForm, can_delete=True, extra=1) 
```

现在，当我在 POST 请求的视图中创建并尝试验证它时：

```
my_formset = SomeFormset(request.POST, request.FILES)

if(my_formset.is_valid()):
    # FAIL 
```

**如果额外**呈现的表单提交为空，它总是无法通过上述检查。

如果我检查[`form.changed_data`](http://code.djangoproject.com/browser/django/trunk/django/forms/forms.py#L293)最后一个空的额外表单，我会得到可以选择的字段（如上面的*pickme*）。换句话说，当需要一些选择字段时，表单集还不够聪明，无法确定应该忽略提交的空表单。

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-06-01T13:04:47.660

谢谢卡尔，你让我发现了我的问题的根源。

在创建带有选项字段的表单时，这是必需的，我们必须设置一个**初始**值，否则表单将认为该字段已*更改*。

所以对于这样的表格：

```
class SomeForm(forms.Form):

    A = 0
    B = 1
    C = 2
    D = 3

   choices = ((A, 'Aah'), (B, 'Baa'), (C, 'Caa'), (D, 'Daa'))

    # This is a required choice field
    pickme = forms.ChoiceField(choices=choices) 
```

我们这样做：

```
pickme = forms.ChoiceField(choices=choices, initial=A) 
```

然后当一个表单集检查额外的表单时，它会看到 pickme 的初始值是 A，现在也是 A，并且会认为它没有改变。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-05-30T02:38:03.150

这不是表单集的常见行为。  [表单集将 empty_permitted=True 传递给所有“额外”表单](https://github.com/django/django/blob/1.4.3/django/forms/formsets.py#L132)，并且[未修改的带有 empty_permitted 的表单应始终通过验证](https://github.com/django/django/blob/1.4.3/django/forms/forms.py#L268)。请注意，这在 Django 管理员中工作得很好（如果您使用内联）。

您必须在代码中执行其他操作，从而在某处破坏此行为。贴出相关表格的完整代码？

# php - 我想让我的 txt 文件安全

> ID：927621
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:07:23.527
> 
>         
> 
> 标签：php, permissions

当前状态。我必须为我的 foobaa.txt 设置 606。

我写了一个 php 代码，读取和写入 foobaa.txt，

我想将 foobaa.txt 的权限设为 600。

但是当我测试600时，PHP代码无法读写foobaa.txt。

所以我把foobaa.txt改成606，然后我的PHP代码就可以读写foobaa.txt了。

这是问题，因为

当有人放

ttp://blabla.foobaa.com/foobaa.txt

直接，然后他就可以看到foobaa.txt的内容了。

这是安全漏洞。

所以我想为foobaa.txt的权限做600，但是如果我这样做，那么php代码就不能读写foobaa.txt。

我认为管理员可以修改一些 apatch 设置，因为我们可以将 txt 文件的权限设置为 600。

还是我必须做一些其他事情？

像 .htaccess 什么的。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-29T19:12:21.723

您的 PHP 代码作为 Web 服务器运行，而不是作为 SSH 进入帐户并更改权限的用户。因此，如果脚本可以读取文本文件，则服务器可以读取它。您将希望通过以下几种方法之一来控制外部用户对文件的访问。

1.  把文件放在你的外面`DocumentRoot`，以便脚本可以访问它，但不可能通过 HTTP 请求。

2.  将文件放在一个目录中，该目录的`.htaccess`文件内容为`Deny From All`. 您也可以单独保护文件，但您可能会有其他应该保密的相关文件。您可以将它们放在同一目录中。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:11:05.173

您可以通过 .htaccess 限制访问：

```
<Files foobaa.txt>
    Deny from all
</Files> 
```

或类似的东西。但这并不完美......最好将文件移动到您的 public_html （或等效）文件夹之外。

# windows - 来自 SetNamedSecurityInfo 的 ERROR_BAD_INHERITANCE_ACL？

> ID：927624
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:07:30.173
> 
>         
> 
> 标签：windows, winapi, acl

`ERROR_BAD_INHERITANCE_ACL`SetNamedSecurityInfo 返回的含义是什么？在这种情况下，我将用户添加到目录的 ACL。我已经查看了有问题的目录，在通话之前它的权利似乎是合理的。但通话失败。  

有什么想法吗？

这是执行工作的代码片段（当我将其粘贴到此处时，我想知道该`NO_MULTIPLE_TRUSTEE`值）：

```
pAAP is a pointer to a structure with the following members:
CString objName;          // name of object
SE_OBJECT_TYPE ObjectType;  // type of object
CString trustee;            // trustee for new ACE (explicit user name)
CString targetComputer;
bool bNeedWrite;

    DWORD dwRes = 0;
    PACL pOldDACL = NULL, pNewDACL = NULL;
    PSECURITY_DESCRIPTOR pSD = NULL;
    EXPLICIT_ACCESS ea = {0};
    CSID trusteeSID;

    bool bGotSID = false;
    if(0 == wcsncmp(pAAP->trustee, L"SID:", 4)) //4 = len of SID: //GLOK
        bGotSID = CSID::FromString((LPWSTR)((LPCWSTR)pAAP->trustee + 4), trusteeSID);
    else
        bGotSID = CSID::FromAccount(pAAP->targetComputer, pAAP->trustee, trusteeSID);

    if(false == bGotSID)
    {
        Log(logDEBUG, L"CSID::FromAccount failed for [%s] on [%s].  GLE=%s", pAAP->trustee, pAAP->targetComputer, GetSystemErrorMessage(GetLastError()));
        _ASSERT(0);
        goto Cleanup;
    }

    // Get a pointer to the existing DACL.
    dwRes = GetNamedSecurityInfo(pAAP->objName.LockBuffer(), pAAP->ObjectType, DACL_SECURITY_INFORMATION,
                                NULL, NULL, &pOldDACL, NULL, &pSD);
    pAAP->objName.UnlockBuffer();
    if (ERROR_SUCCESS != dwRes)
    {
        Log(logDEBUG, L"GetNamedSecurityInfo failed on [%s] for [%s] on [%s].  GLE=%s", pAAP->objName, pAAP->trustee, pAAP->targetComputer, GetSystemErrorMessage(dwRes));
        //_ASSERT(ERROR_FILE_NOT_FOUND == dwRes);
        goto Cleanup; 
    }  

    // Initialize an EXPLICIT_ACCESS structure for the new ACE. 
    ea.grfAccessPermissions = pAAP->bNeedWrite ? GENERIC_ALL : GENERIC_READ;
    ea.grfAccessMode = GRANT_ACCESS;
    ea.grfInheritance= CONTAINER_INHERIT_ACE | OBJECT_INHERIT_ACE;
    ea.Trustee.TrusteeForm = TRUSTEE_IS_SID;
    ea.Trustee.TrusteeType = TRUSTEE_IS_USER;
    ea.Trustee.ptstrName = (LPWSTR)(PSID)trusteeSID;
    ea.Trustee.MultipleTrusteeOperation = NO_MULTIPLE_TRUSTEE;

    // Create a new ACL that merges the new ACE into the existing DACL.
    dwRes = SetEntriesInAcl(1, &ea, pOldDACL, &pNewDACL);
    if (ERROR_SUCCESS != dwRes)  
    {
        Log(logDEBUG, L"SetEntriesInAcl failed on [%s] for [%s] on [%s].  GLE=%s", pAAP->objName, pAAP->trustee, pAAP->targetComputer, GetSystemErrorMessage(dwRes));
        //_ASSERT(0);
        goto Cleanup; 
    }  

    // Attach the new ACL as the object's DACL.
    dwRes = SetNamedSecurityInfo(pAAP->objName.LockBuffer(), pAAP->ObjectType, DACL_SECURITY_INFORMATION,
                                NULL, NULL, pNewDACL, NULL);
    if (ERROR_SUCCESS != dwRes)  
    {
        Log(logDEBUG, L"SetNamedSecurityInfo failed on [%s] for [%s] on [%s].  GLE=%s", pAAP->objName, pAAP->trustee, pAAP->targetComputer, GetSystemErrorMessage(dwRes));
        //_ASSERT(dwRes == ERROR_BAD_INHERITANCE_ACL);
        goto Cleanup; 
    }  

Cleanup:
    if(pSD != NULL) 
        LocalFree((HLOCAL) pSD); 
    if(pNewDACL != NULL) 
        LocalFree((HLOCAL) pNewDACL); 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T03:24:54.940

代码示例肯定会有所帮助。很容易获得构建和设置 ACL 的逻辑错误。

我面前没有代码，但基本逻辑是：

1.  获取具有足够访问掩码的进程令牌

2.  获取命名安全信息

3.  为新的 ACE 分配一个足够大的新 ACL，从旧的复制到新的，并调用 AddAccessAllowedAceEx 添加用户的 SID

4.  设置命名安全信息

# html - 你如何处理 Internet Explorer？

> ID：927626
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2009-05-29T19:07:36.477
> 
>         
> 
> 标签：html, css, internet-explorer, portability

我知道关于这个话题可能还有其他问题。我想每个 Web 开发人员都会使用 IE 来解决这个问题。

* * *

### 我的问题：

我正在开发一个完全基于 Javascript 的基于 Web 的应用程序。我是 Mac 用户。我真的很高兴在 Safari、Firefox 和 Opera 中一切正常。然后我请一位使用 Windows 的朋友使用 Internet Explorer 进行检查，但结果并不好。我的应用程序对 HTML 标准非常敏感。

主要问题是 CSS 布局。由于 jQuery 的可移植性，JavaScript 本身似乎工作正常。

* * *

### 我的问题：

你如何处理 Internet Explorer？我应该创建一个只在 Internet Explorer 上加载的新 CSS 吗？我应该只为 Internet Explorer 创建一个新版本的应用程序吗？您通常如何处理这个问题？该应用程序在功能设计和布局设计方面都相当大。

* * *

### 编辑：

使用 Nosredna 建议的 CSS 重置，已经消除了几乎一半的问题。我想这确实是一个好习惯。我注意到 SO 也使用它。

* * *

## 回答 #1

> 赞同：57
> 
>             
> 
> 时间：2009-05-29T19:28:18.867

您是否指定了有效的文档类型？您可以通过将 Internet Explorer 切换到标准模式来使其更加兼容。[http://msdn.microsoft.com/en-us/library/bb250395.aspx#cssenhancements_topic2](http://msdn.microsoft.com/en-us/library/bb250395.aspx#cssenhancements_topic2)

您是否使用浏览器重置 CSS 文件？这可以帮助将版本组合在一起。[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

注意 IE 的 CSS 错误：[http ://www.positioniseverything.net/explorer.html](http://www.positioniseverything.net/explorer.html)

对于布局的骨架，考虑使用已知有效的标记，例如[http://matthewjamestaylor.com/blog/perfect-multi-column-liquid-layouts](http://matthewjamestaylor.com/blog/perfect-multi-column-liquid-layouts)或[http://960.gs/](http://960.gs/)用于液体或固定布局，分别。

跟上浏览器之间的 JavaScript 差异。jQuery 处理其中的一些，但不是全部。[http://www.impressivewebs.com/7-javascript-differences-between-firefox-ie/](http://www.impressivewebs.com/7-javascript-differences-between-firefox-ie/)

是的，IE 很痛苦。如果你想让它在 IE 中工作，你真的想每隔几天在 IE 中测试一次。你不想把痛苦留到最后——你想一次处理一个噩梦。

* * *

顺便说一句，如果您认为 IE 很痛苦，请尝试用手机查看您的页面。前几天，我带着 iPhone 去了 REI.com，屏幕中间的五分之一或更多的地方被一堆呈现为文本的乱码占据了。

* * *

## 回答 #2

> 赞同：25
> 
>             
> 
> 时间：2009-05-29T19:39:30.407

[有条件的评论。](http://en.wikipedia.org/wiki/Conditional_comment)

```
<!--[if IE 6]>
  <link rel="stylesheet" href="ie6.css">
<![endif]-->
<!--[if IE 7]>
  <link rel="stylesheet" href="ie7.css">
<![endif]-->
<!--[if IE 8]>
  <link rel="stylesheet" href="ie8.css">
<![endif]-->
<!--[if !IE]-->
  <link rel="stylesheet" href="normal.css">
<!--[endif]--> 
```

在 IE 文件中，您可以使用`@import`导入`normal.css`，然后根据需要覆盖样式。

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2009-05-29T19:13:01.583

首先，我不会等到项目完成后才考虑浏览器兼容性。

大多数情况下，对于 CSS 问题，有一些方法可以做一些不需要加载特定于浏览器的样式表的事情，所以我尽可能尝试使用这些解决方案。例如 - 如果您的大多数问题都与框模型问题有关，则使用嵌套 div 代替填充可以帮助确保一切看起来正确，而无需针对不同浏览器使用单独的样式表和模板。

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T19:31:48.830

浏览器重置以启动。尽可能平衡游戏环境并取消浏览器默认设置。从头开始构建您的 CSS。（见： http: [//meyerweb.com/eric/thoughts/2007/04/12/reset-styles/](http://meyerweb.com/eric/thoughts/2007/04/12/reset-styles/)）

在开发过程中尽早并经常在所有主要浏览器上进行测试。

尽量在没有浏览器特定黑客的情况下完成。有时您需要使用一些特定于浏览器的 CSS，但它应该验证（使用 W3C 验证工具）。有时虽然它只是有条件的（甚至可能是一些 JavaScript），例如修复 IE6 中的透明 PNG（参见： http: [//nettuts.com/videos/screencasts/5-easy-ways-to-tackle- ie6s-透明度问题/](http://nettuts.com/videos/screencasts/5-easy-ways-to-tackle-ie6s-transparency-issues/)）。

如果您无法在其中一台开发机器上运行 IE，请尝试[http://browsershots.org](http://browsershots.org)。至少你可以通过这种方式得到一些反馈。

使用 debug.css 突出显示或概述 div 和其他元素。如果在开发过程中需要的话，把它扔到你的 HTML 头中。这可能是一个巨大的帮助。

在可用的情况下使用“开发人员工具栏”（IE、Firefox）。

预计 IE 会很痛苦，并在 6、7 和 8 中进行测试。

玩得开心！

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T19:40:12.370

首先，阅读[On Have Layout](http://www.satzansatz.de/cssd/onhavinglayout.html)，它解释了 IE 渲染引擎如何在内部工作。IE的渲染引擎是CSS之前的。它没有像您期望的那样正确区分内联元素和块元素。相反，在 IE 中，元素 hasLayout。或不。这是 99% 的 IE CSS 错误的来源。所以，多读几遍那篇文章。

至于修复，我通常使用条件注释。几个原因：

*   它们是面向未来的，而不是 CSS hack。如果 IE9 修复了 hack 但没有修复您使用它解决的错误怎么办？

*   它是有效的 (X)HTML （条件评论只是对其他人的普通评论）

*   它不需要javascript。您会惊讶于有多少人关闭了 javascript。

关于条件注释的一句话：永远不要使用开放式匹配。也就是说，永远不要做类似的事情：

```
<!--[if IE]> <load css> <![endif]-->
<!--[if gte IE 7]> <load css> <![endif]--> 
```

原因与 hacks 相同：使其面向未来。如果下一个版本的 IE 修复了这个 bug，而您不再需要修复了怎么办？或者更糟糕的是，现在的“修复”实际上会在新的 IE 版本中弄乱你的布局？通常最好假设下一个版本的 IE 已经修复了您正在解决的错误。当 IE 8 出现时，我已经[写过一些](http://www.jejik.com/articles/2008/04/martian_headsets_for_earth_people_how_to_fix_internet_explorer_8/)关于它的内容。

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T19:46:42.340

以下是我尝试减少处理 IE 的痛苦的方法：

1.  使用 reset.css - [Yahoo! YUI 重置](http://developer.yahoo.com/yui/reset/)或[Eric Meyer 的重置 CSS](http://meyerweb.com/eric/tools/css/reset/)

2.  小心浮动，清除 - 它们通常会引起很多诅咒。

3.  请注意 IE 中的 hasLayout 错误，通常添加 zoom: 1 或 height 属性有助于解决此问题。阅读[有布局](http://www.satzansatz.de/cssd/onhavinglayout.html)。

4.  让布局在 Firefox、Safari、Chrome 等中工作，同时保持 IE 大约 80% 的路径。

5.  如果需要，使用条件注释实现 IE6.css 样式和 IE7.css 样式。

6.  啤酒、白酒或其他成人饮料。

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T19:35:59.163

我认为为 IE 编写一个特定的 css 文件是可以的。我知道这很痛苦，但由于一些定位问题，IE6 看起来与所有其他浏览器不同。

将此行用于新创建的 css 文件：

```
<!--[if ie6]><link rel="stylesheet" type="text/css" media="screen" href="ie6_style.css" /><![endif]--> 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:34:49.697

由于[IE 获得了大约 65% 的流量](http://en.wikipedia.org/wiki/Usage_share_of_web_browsers#Present_to_1999)，我认为您不能将其视为事后的想法。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:13:16.903

总的来说，我尽量不为 IE 制作单独的 CSS 文件。如果需要，我将使用条件格式来专门针对它。总的来说，您最多可能需要做一个仅 IE 的样式表才能使其工作。

请确保您使用适合您的受众的正确版本的 IE 进行测试，因为 IE 6、7 和 8 非常普遍。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:16:16.007

作为最后的手段，当调整 CSS 并不能解决问题时，我喜欢使用[Rafael Lima 的 CSS 选择器](http://rafael.adm.br/css_browser_selector/)脚本。虽然它依赖于 JavaScript（我构建的大多数网站都是这样做的），但它提供了一种方便的方法来调整不同浏览器和版本的 CSS，而无需单独的样式表。

你可以有 ：

```
.someClass {
  margin-left:1px
}

.ie6.someclass {
  margin-left:2px
} 
```

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:17:36.363

```
<script>
  if (internetExplorer) {
    window.location = "http://getfirefox.com";
 }
 </script> 
```

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:30:45.807

使标记尽可能简单。做些小改动。测试每一个变化。

* * *

## 回答 #13

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:35:04.470

我删除它

* * *

## 回答 #14

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:43:03.800

我认为开发一个用于 IE 的新 CSS 文件会比重写您的应用程序要容易得多，但我不知道您的应用程序有多大的规模和范围，这甚至会使这样做成为一个相当大的选择。我想这可能取决于您希望支持的 IE 版本。  

我们现在已经到了大多数用户应该已经完全迁移出 IE6 的地步了。IE7 仍然很麻烦，但远没有 6 那样糟糕。对于我的项目，我出售的默认设置是 IE7 与代码的兼容性，以指导 IE6 及以下用户进行升级。如果客户希望我将 IE6 兼容性整合到网站中，我通常会将报价提高 50%，因为支持浏览器是一件多么令人头疼的事情，而且必须编写多少额外的可视化代码才能使其正常工作。  

* * *

## 回答 #15

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:48:55.910

我知道这可能属于“太少、太晚”的类别。也就是说，我将投资于 VMWare 或 Parallels，并创建一个带有 IE6 的 Windows VM。

随着您的开发，您应该在您关心的浏览器中逐步检查您的进度。

也就是说，对于现有的应用程序，我首先要确保我的 HTML 是有效的（有多种验证服务可供您使用）然后，根据布局，我逐节尝试让布局正确，使用评论来“隐藏”您没有积极处理的部分。

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:41:19.793

我通常会尽我所能避免创建单独的 CSS 文件。有很多 CSS 和 HTML 技巧和提示可以让您在 IE6 及更高版本以及所有其他常见浏览器中工作。只是需要时间来弄清楚这一切。不幸的是，有时使用复杂的布局可能会花费很多时间，尤其是当您不进行测试时。

* * *

## 回答 #17

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:49:09.420

我让别人为我解决问题。我使用 Yahoo 优秀的 CSS 文件，这些文件包含在他们的 YUI 库中。他们有一个文件来删除现有标签的现有格式（例如，IE 中的 H1 看起来不像 Firefox 中的 H1），他们有另一个文件可以为我提供一组默认格式，在浏览器中看起来确实相同，他们还有另一个要标准化字体大小，其中最重要的是它们的网格文件。它使我能够非常快速轻松地在页面上构建区域和子区域的分层格式，并且我知道它可以在任何主要的现代浏览器上运行（雅虎对其进行了测试以确保它确实有效）。

它可能不是完美的解决方案，但对于我的需求来说已经绰绰有余了。

* * *

## 回答 #18

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:27:27.937

我在我的开发中遇到了同样的问题：IE6，FFetc + LAMP + 自定义 MVC，基于 Rasmus Lerdorf 的文章，当时他建议使用 noMVC 类处理它，使用包含页眉、页脚和排序。我编写了 CSS 代码，被 FF 卡住了，不能很好地渲染它。我不得不去修改我的 CSS 知识——我发现单个 CSS 实现可以在 std.xml 中正确呈现。兼容模式（FF）和IE6。我喜欢那个。我很高兴使用单个 CSS 文件处理任何更改。我的建议：

1.  我知道你有一台 Mac，去旧货出售（报纸会告诉你它们在哪里），花 10 美元买一台旧电脑（到目前为止我已经找到了很多）。这将使您有机会尽早测试 IE6，同时您还可以获得 KVM 切换器，以便在需要时访问机器。

2.  我沉迷其中的一件事是 IE6 的设置 - 禁用所有 ActiveX 脚本 - 无论如何，在没有广告的情况下浏览网页会变得非常棒 - 测试你的应用程序是否有 ActiveX 设置，看看你的网站表现如何。这确实为我节省了我上面提到的几个小时的“痛苦”时刻。

3.  你知道如何在有和没有脚本的情况下测试 FF/Opera/Safari

4.  最后 - 无论您的网站使用多繁重的 Javascript，请确保没有编写核心功能（我相信您有很多）可以正确加载。

我不是专家，但希望我的评论对您有所帮助。

Cheery-O

* * *

## 回答 #19

> 赞同：1
> 
>             
> 
> 时间：2012-02-08T06:36:55.850

我确保我的网站在 ie9 中本地和完美地运行，并在 ie8 中运行（可能缺少功能）。我提示所有使用旧版本的人获取镀铬框架。我从不把时间浪费在 ie7 和更老版本上，因为使用 6 岁的浏览器是可悲的，不应该被鼓励。

* * *

## 回答 #20

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T10:23:25.440

正如 nosredna 所说，使用有效的 doctype（请参阅[http://www.alistapart.com/articles/doctype/ ）然后在 w3c 验证器（](http://www.alistapart.com/articles/doctype/) [http://validator.w3.org/](http://validator.w3.org/) ）中检查您的网站。如果它没有显示错误（或只有几个），那么 IE 应该正确呈现它。

我不会花太多精力让它与 IE6 兼容，而只是接受网站在各种浏览器中看起来可能不同的事实。

# c++ - C++ 中是否有一个堆类支持更改除头部之外的元素的优先级？

> ID：927631
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-29T19:08:20.733
> 
>         
> 
> 标签：c++, stl, boost, heap, priority-queue

我有一个事件优先级队列，但有时事件优先级会发生变化，所以我想将事件请求者的迭代器维护到堆中。如果优先级发生变化，我希望在 log(n) 时间内调整堆。我将始终只有一个迭代器指向堆中的每个元素。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T19:30:44.917

看看 Boost 的[可变堆](http://www.boost.org/doc/libs/1_39_0/boost/pending/mutable_heap.hpp)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2012-03-01T20:41:08.173

我很高兴地报告 Boost 现在添加了一个带有一些[出色数据结构的](http://www.boost.org/doc/libs/1_49_0/doc/html/heap/data_structures.html)[Boost.Heap 库](http://www.boost.org/doc/libs/1_49_0/doc/html/heap.html)。

这样做的好处是斐波那契堆支持在恒定摊销时间内更改优先级。

不幸的是，所有可变堆都是基于节点的（换句话说，它们具有@wilx 所建议的额外间接性）。@Feruccio 对 Boost 的“可变堆”的回答有代码，如果您愿意在值类型中包含指向句柄的指针，则可以编写基于向量的可变堆。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:17:26.613

这听起来像你需要更多的间接性。而是将指向事件的指针存储在优先级队列中。当队列中某些元素的优先级发生变化时，将其删除并重新插入。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:39:07.270

这里的一个警告是你最终会得到不稳定的事件排序，即具有相同优先级的事件的排序是未定义的（阅读“它们将被重新排序”。）

# .net - 在（64位）citrix中运行时没有系统托盘ToolbarWindow32窗口句柄

> ID：927636
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:09:32.930
> 
>         
> 
> 标签：.net, system-tray, citrix

我们编写了一个 C# 命令行应用程序，它作为脚本的第一步运行，当用户在 citrix 上启动我们的 CRM 系统时执行该脚本（它是一个已发布的应用程序）。命令行的目的是找到系统托盘上的outlook图标并将其隐藏。我们通过对各种 WIN32 方法的 PInvoke 调用来做到这一点，并且在非 citrix 环境中进行测试时效果很好。

当我们将它推广到我们的 Citrix 测试服务器并通过发布的应用程序脚本运行时，我们的代码没有找到我们希望在系统托盘中看到的 SysPager 和（更重要的是）ToolbarWindow32 窗口的窗口。有谁知道为什么？  

示例代码：

```
IntPtr shellTrayHwnd = Win32.FindWindow("Shell_TrayWnd", null);
IntPtr sysPagerHwnd = Win32.FindWindowEx(shellTrayHwnd, IntPtr.Zero, "SysPager", null); //returns 0
IntPtr toolbarNotifyHwnd = Win32.FindWindowEx(shellTrayHwnd, IntPtr.Zero, "ToolbarWindow32", null);  //returns 0 
```

正如我所说，这段代码在非 citrix 会话中运行时效果很好，但是一旦我们在 citrix 中运行，我们似乎就失去了获取这些句柄的能力。

仅供参考：这里的最终目标是在运行依赖于后台运行 Outlook 的 CRM 软件时隐藏发送到客户系统托盘的 Outlook 图标。如果我们不抑制图标，我们会在最终用户的托盘中获得两个 Outlook 图标。一个来自他们的本地 Outlook，另一个来自在后台运行在 citrix 上以使 CRM 软件工作的 Outlook（CRM 软件不使用嵌入式模式下的 Outlook，因为我们需要能够运行 VSTO 插件 - 这不以嵌入模式加载）。如果有人知道更简单的方法，我会全神贯注。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-07-08T15:21:40.503

你可能想检查你的第一行。您需要通过`IntPtr.Zero`而不是 Null - 这通常是获取桌面的最佳方式。Shell Services Service 也应该运行（通常使用完全不同的名称）并且 Explorer 也需要运行......之后，我会考虑看看运行 Spy++ 是否会启发。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-09-25T00:44:01.700

在我的系统上，层次结构是

Shell_TrayWnd -> TrayNotifyWnd -> SysPager -> ToolbarWindow32

# xaml - 有没有办法在 XAML 中对 TextBlock 进行投影效果？

> ID：927642
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T19:10:34.693
> 
>         
> 
> 标签：xaml, formatting

我有一个 XAML TextBlock，我想将其呈现为投影。那是黑色层之上的白色文本层。我这样做是为了使文字站立。目前我有两个 TextBlocks 向右和下方偏移两个像素。顶层是白色的，底层是黑色的。

在 XAML 中是否有一种简单的方法可以做到这一点？如果是这样，你能举个例子吗？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-06-01T14:13:48.350

位图效果已弃用。请改用新的 GPU 加速[DropShadowEffect](http://msdn.microsoft.com/en-us/library/system.windows.media.effects.dropshadoweffect.aspx)。

```
<TextBlock>
    <TextBlock.Effect>
        <DropShadowEffect />
    </TextBlock.Effect>
    Drop.
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:17:12.480

```
<TextBlock
 Text="Shadow Text"
 Foreground="Teal">
<TextBlock.BitmapEffect>
<DropShadowBitmapEffect
  ShadowDepth="4"
  Direction="330"
  Color="Black"
  Opacity="0.5"
  Softness="0.25" />
</TextBlock.BitmapEffect>
</TextBlock> 
```

[MSDN](http://msdn.microsoft.com/en-us/library/ms748273.aspx)上还有很多其他示例

# javascript - 你如何用 Javascript 编写一个类？

> ID：927651
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T19:12:07.917
> 
>         
> 
> 标签：javascript, class

> **可能重复：**
> 
>   [在 javascript 中定义类的最佳方法是什么](https://stackoverflow.com/questions/387707/whats-the-best-way-to-define-a-class-in-javascript)

你如何用 Javascript 编写一个类？甚至可能吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T19:19:27.933

好吧，JavaScript 是一种基于原型的语言，它没有类，但您可以通过对象克隆和原型设计来拥有经典继承和其他行为重用模式。

推荐文章：

*   [面向对象 JavaScript 简介](https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript)

*   [JavaScript 经典继承](http://javascript.crockford.com/inheritance.html)

*   [JavaScript 私有成员](http://www.crockford.com/javascript/private.html)

*   [基于类与基于原型的语言](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Class-Based_vs._Prototype-Based_Languages)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:14:20.830

```
function Foo() {
   // constructor
}

Foo.prototype.bar = function() {
    // bar function within foo
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:14:16.400

Javascript 默认使用基于原型的 OO。

但是，如果您使用原型库，例如，您可以使用 Class.create()。

[http://prototypejs.org/api/class/create](http://prototypejs.org/api/class/create)

它可以让你创建（或继承）一个类，然后你可以用 new 实例化它的实例。

其他图书馆可能也有类似的设施。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:18:08.810

如果您使用原型或 jQuery 之类的库，它会容易得多，但传统的方法是这样做。

```
function MyClass(){
}
MyClass.prototype.aFunction(){ 
}

var instance = new MyClass();
instance.aFunction(); 
```

您可以在此处阅读更多信息[http://www.komodomedia.com/blog/2008/09/javascript-classes-for-n00bs/](http://www.komodomedia.com/blog/2008/09/javascript-classes-for-n00bs/)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:16:25.897

JavaScript 基于对象，而不是类。它使用原型继承，而不是经典继承。

JavaScript 具有延展性并且易于扩展。因此，有许多库为 JavaScript 添加了经典继承。但是，通过使用它们，您可能会编写大多数 JavaScript 程序员难以遵循的代码。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:14:48.910

这是“有点”可能的。  [Prototype](http://www.prototypejs.org/)对用 JS 编写类有一些内置帮助。看看这个关于如何做到这一点的[详尽描述。](http://javascript.crockford.com/inheritance.html)

```
var namedClass = Class.create({
    initialize: function(name) {
        this.name = name;
    }

    getName: function() {
        return this.name;
    }
});
var instance = new namedClass('Foobar'); 
```

# c# - 为什么 Encoding.Default.GetBytes() 在 VB.NET 和 C# 中返回不同的结果？

> ID：927652
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T19:12:17.467
> 
>         
> 
> 标签：c#, vb.net, encoding

我们最近遇到了一些来自供应商的示例代码，用于对 Web 服务调用的密钥进行哈希处理，他们的示例位于 VB.NET 中，我们将其转换为 C#。这导致散列产生不同的输入。事实证明，他们生成加密密钥的方式是将 char 数组转换为字符串，然后再转换回字节数组。这让我发现 VB.NET 和 C# 的默认编码器对某些字符的工作方式不同。

C＃：

```
Console.Write(Encoding.Default.GetBytes(new char[] { (char)149 })[0]); 
```

VB：

```
Dim b As Char() = {Chr(149)}
Console.WriteLine(Encoding.Default.GetBytes(b)(0)) 
```

C# 输出是 63，而 VB 是正确的字节值 149。如果您使用任何其他值，如 145 等，则输出匹配。

通过调试，VB 和 C# 的默认编码器都是 SBCSCodePageEncoding。

有人知道为什么是这样吗？

我已经通过直接初始化一个字节数组来更正示例代码，它应该首先是，但我仍然想知道为什么不应该特定于语言的编码器似乎就是这样。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T19:22:25.183

如果您使用 ChrW(149)，您将得到不同的结果 - 63，与 C# 相同。

```
Dim b As Char() = {ChrW(149)}
Console.WriteLine(Encoding.Default.GetBytes(b)(0)) 
```

阅读[文档](http://msdn.microsoft.com/en-us/library/613dxh46.aspx)以查看差异 - 这将解释答案

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T19:25:24.320

VB Chr 函数采用 0 到 255 范围内的参数，并使用当前默认代码页将其转换为字符。如果您传递超出此范围的参数，它将引发异常。

ChrW 将采用 16 位值并在不使用编码的情况下返回相应的 System.Char 值 - 因此将给出与您发布的 C# 代码相同的结果。

在不使用 VB Strings 类（即包含 Chr 和 ChrW 的类）的情况下，C# 中的 VB 代码的近似等价物是：

```
char[] chars = Encoding.Default.GetChars(new byte[] { 149 });
Console.Write(Encoding.Default.GetBytes(chars)[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:16:33.603

[默认编码](http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx)取决于机器和线程，因为它使用当前代码页。您通常应该使用像 Encoding.UTF8 这样的东西，这样您就不必担心当一台机器使用 unicode 而另一台机器使用 1252-ANSI 时会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:18:37.907

> 不同的操作系统可能使用不同的编码作为默认值。因此，从一个操作系统流式传输到另一个操作系统的数据可能会被错误地转换。为确保正确解码编码字节，您的应用程序应使用带有前导码的 Unicode 编码，即 UTF8Encoding、UnicodeEncoding 或 UTF32Encoding。另一种选择是使用更高级别的协议来确保编码和解码使用相同的格式。

来自[http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx](http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx)

当您使用 utf8 显式编码时，您可以检查每种语言产生的内容吗？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:25:31.090

我相信 VB 中的等价物是 ChrW(149)。

所以，这个VB代码......

```
 Dim c As Char() = New Char() { Chr(149) }
    'Dim c As Char() = New Char() { ChrW(149) }
    Dim b As Byte() = System.Text.Encoding.Default.GetBytes(c)
    Console.WriteLine("{0}", Convert.ToInt32(c(0)))
    Console.WriteLine("{0}", CInt(b(0))) 
```

产生与此 C# 代码相同的输出...

```
 var c = new char[] { (char)149 };
    var b = System.Text.Encoding.Default.GetBytes(c);
    Console.WriteLine("{0}", (int)c[0]);  
    Console.WriteLine("{0}", (int) b[0]); 
```

# database - 在哪里可以找到 CeCreateDatabaseWithProps 的定义

> ID：927655
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:12:50.943
> 
>         
> 
> 标签：database, embedded, windows-ce

根据 msdn，它应该在 windbase.h 但它不可用，而是在 windbase_edb.h 但 cordll.lib 仅与 windabase.h 链接。所以，我想知道是否有任何方法可以将 CeCreateDatabaseWithProps 与适当的库链接？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-06T12:34:17.060

首先， coredll.lib 没有与*任何*头文件链接。

CeCreateDatabaseWithProps 在 SDK 的 windbase_edb.h 中定义，因此您可以从那里包含声明。如果您使用 dumpbin 查看 coredll.lib，您会看到链接器定义在其中（序号为 1897）。  

如果您的链接器首先没有找到它，请确保您的目标是正确的 SDK（仅限 WinMo 6）。如果它仍然拒绝链接，则在代码页顶部手动将其声明为 extern。

# jquery - jQuery 通过一个操作在三个 SELECT 下拉菜单上选择相同的 OPTION

> ID：927656
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:12:53.737
> 
>         
> 
> 标签：jquery

我有 3 SELECT 下拉菜单

选择 1

```
<select>
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select> 
```

选择 2

```
<select type="hidden">
  <option value="Sadan">Volvo</option>
  <option value="Sadan">Saab</option>
  <option value="Sport">Mercedes</option>
  <option value="Sport">Audi</option>
</select> 
```

选择 3

```
<select>
  <option value="1000">Sport</option>
  <option value="2000">Sadan</option>
</select> 
```

SELECT 2 隐藏在后台（这是由于 JSP/Struts 的限制）。

我需要的是一种方法，如果用户选择 SELECT 1 选项，将选择 SELECT 2 对应选项，然后选择 SELECT 3 对应选项。

例子：

用户选择 SELECT 1 选项**`<option value="mercedes">Mercedes</option>`**

预期成绩：

SELECT 2 自动选择的选项**`<option value="Sport">Mercedes</option>`**

和

SELECT 3 自动选择的选项**`<option value="1000">Sport</option>`**

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T19:18:13.133

这差不多。我会举一个例子。

```
$('#select1').change(function() {
   $('#select2').val($('#select1').val());
   $('#select3').val($('#select2').val());
}); 
```

**编辑：**示例：http: [//jsbin.com/ahema](http://jsbin.com/ahema)

而且TSamper有一个很好的点，一定要输入ID，不然就不行了。（您可以在示例中看到）

```
<select --> id="select2" <-- type="hidden">
  <option value="Sadan">Volvo</option>
  <option value="Sadan">Saab</option>
  <option value="Sport">Mercedes</option>
  <option value="Sport">Audi</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:19:20.557

您可以将一个类添加到“组”相应的选项，然后在选择时使用 JQuery 选择器选择这些选项。从那里您可以将选择框设置为所需的索引。

# sql-server-2008 - 使用 SQL Profiler 的最佳方法是什么

> ID：927672
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:16:41.950
> 
>         
> 
> 标签：sql-server-2008

我是一名具有平均 SQL 技能的 .NET 开发人员。我正在开发一个“数据库繁重”的网络应用程序。我一直在使用分析器来调试查询和过程。有没有办法使用这个工具来查看查询/过程的性能。

如何充分利用 SQL Profiler？

我正在使用 SQL Server 2008。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:22:33.390

每个人都没有硬性规定，因为这取决于您使用的数据库系统的类型。

作为 SQL Server 性能调整的一般起点，您会发现以下参考资料确实非常有用。它包含各种注意事项和说明。

[http://www.brentozar.com/sql-server-performance-tuning/](http://www.brentozar.com/sql-server-performance-tuning/)

另请查看以下文章“使用 SQL Server Profiler 识别性能问题”

[http://vyaskn.tripod.com/analyzing_profiler_output.htm](http://vyaskn.tripod.com/analyzing_profiler_output.htm)

如果您需要更多帮助，请给我留言。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:22:42.623

我不熟悉 sql serer 2008，但在 sql server 2005 中，您最好的选择是“显示执行计划”功能。我会让您知道查询的哪些部分占用的时间最多。通常添加索引会有很大帮助，这个工具将帮助您确定最需要它们的位置。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2015-03-10T00:40:47.483

它是一个美妙而强大的工具。但要小心，不要做以下“

1）不要捕捉一切。您可以拥有如此多的事件/对象，以至于您将无法找到任何东西。您可以按应用程序/用户/数据库设置过滤器。

2）不要在生产机器上运行分析器。

3) 不要将跟踪信息保存在生产数据库中。将其保存到与生产文件分开存储的文件中。

# client-server - 什么是维护与添加新功能？

> ID：927675
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T19:17:08.907
> 
>         
> 
> 标签：client-server, maintenance

维护和新功能之间的界线应该在哪里？

牛津英语词典将维护定义为：

> (7.a) 使某物处于工作状态、维修等状态；通过提供设备等手段来维持建筑物、机构、部队等；如此保持的状态或事实；维持的手段或规定。

我正在使用客户端-服务器应用程序并维护客户端。根据定义，我希望执行：

*   错误修复

*   API 适配（客户端继续使用服务器所需的微小更改）

*   针对已识别的性能问题进行优化

我不希望执行：

*   新开发（添加新功能）

维基百科[软件维护](http://en.wikipedia.org/wiki/Software_maintenance)页面引用了纠正性、自适应性、完善性和预防性维护，这似乎符合我的预期，但客户端-服务器的性质使事情变得复杂。

**编辑**：对于没有依赖关系的独立应用程序，如果软件工作，它应该继续工作。对于客户端-服务器应用程序，客户端可能会在服务器更改时中断。尽管这不会改变维护的定义，但它意味着有更多的机会和场合需要对客户端应用程序进行更改。

如果两方要就维护合同达成一致，则必须满足对什么是合格和维护以及什么是新功能的相互理解，因此是这个问题。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T19:23:18.037

错误修复和功能之间的界限可能会变得模糊。我会考虑可用性增强和次要功能作为维护。我的经验法则：如果不值得向您的客户吹嘘（或收费），那么它就是维护。

例如，添加允许用户打印的功能将是新的发展。修改该功能以允许用户打印特定范围的页面将是维护（这是次要的，并且可能从一开始就应该以这种方式工作）。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:26:44.723

我想说维护是您为确保产品按最初设计工作而做的任何事情。

那里的症结通常是“设计的”。如果您没有从某种形式的详细设计文档开始指定软件会做什么和不会做什么，那么事情就需要解释了。当事情留待解释时，通常客户的解释是软件应该做*他们想让*它做的一切，而不是*他们为它付出的一切*。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2012-12-20T18:54:41.380

基于 SO/IEC 14764 软件维护规范和我在网站和移动应用程序上工作的经验，我写了一篇专门针对数字产品的维护与新功能开发的文章：[http ://www.rajiv.com/blog /2012/12/19/维护与新开发/](http://www.rajiv.com/blog/2012/12/19/maintenance-vs-new-development/)

本文的目的是帮助回答以下问题：*维护工作是什么意思？什么应该被视为维护与新功能开发？有行业标准定义吗？我们的选择标准是什么？你能给我一些例子吗？维护与新功能开发工作的比例是我们行业的最佳实践？我们组织的组合与此相比如何？*

在我从事的大多数工作中，我都被问到过这些问题。这篇文章帮助我回答了针对我公司的具体问题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:24:04.773

对于错误修复，大部分情况下很容易将它们归类为维护。

但是，根据您的软件产品，您可能会遇到需要在持续的应用程序维护中加入的“新功能”。

对我们而言，这通常是由于客户或第三方法规的业务要求而发生的。客户可能希望修复一些错误，但与此同时，我们需要支持处理新的政府法规，该法规在法律上要求我们“立即解决！”。

该特定更改是一项“新功能”，但将作为常规应用程序维护版本的一部分进行安装。

我想说这真的取决于您的商店希望采用的模型，即使如此，您总是会遇到它们重叠的情况。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:31:02.530

错误修复绝对是维护。

提高性能（速度）就是维护。

添加一个应该包含在最后一个版本中但没有或没有工作的功能是维护（在我看来）。

添加一个全新的功能，我不认为是维护。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:36:47.510

我在一个地方（供应商）工作，每次修改都会与客户抗争，它们都是新功能！他们会告诉客户他们购买了这些虫子。那是一个有趣的工作场所！他们会屈服，但每个月当他们发送账单时，他们都会与客户“谈判”。请记住，我们销售的是大型定制系统，客户很难跳槽，管理层知道这一点。作为开发人员，这很麻烦。

我认为维护是保持系统运行，修复错误，使其与操作系统和其他可能发生变化的所需软件兼容。新功能是他们以前没有的功能。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:33:30.620

对我来说，错误是维护，而增强不是。

但根据我的经验，非编码人员通常很难区分错误和增强。对他们来说，错误是任何不能按照他们想要的方式工作的东西。对我来说，bug 是不能像指定或设计的那样工作的东西。

如果功能应该在原始规范中但不是，并且客户签署了规范，那么在我看来它就像增强（因此是额外的付费工作）。

当然，也有一些“软”的考虑——为了保持良好的关系，通常谨慎的做法是在维护中免费提供一些请求的增强功能，特别是如果它们相对较小并且您能够公平地管理这种期望好。

# c# - 如何在多行文本框中添加文本？

> ID：927679
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-29T19:17:56.253
> 
>         
> 
> 标签：c#

我必须将文件的详细信息添加到多行文本框中。但是所有细节都被添加到文本框中的一行中，而不是垂直顺序。我使用了 Environment.NewLine，也使用了“\r\n”，但这没有任何帮助。我在 Windows 窗体表单中勾选了多行文本框，并将其设置为 true，但无济于事。

我的代码行是这样的：

```
m_Txt.Multiline = true;

m_Txt.Text = fileInfo.m_Title + "\r\n" + 
             fileInfo.m_Identifier + Environment.NewLine + 
             fileInfo.m_TotalTime; 
```

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2012-04-17T14:56:04.277

一个更干净的答案是：

假设 txtStatus 是一个文本框：

```
txtStatus.Multiline = True;
txtStatus.Clear();
txtStatus.Text += "Line 1" + Environment.NewLine;
txtStatus.Text += "Line 2" + Environment.NewLine; 
```

使用内置枚举意味着更简洁的代码。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-05-29T19:19:13.660

[Shift+Enter](http://jasonrshaver.com/blog/how-to-make-a-new-line-n-in-the-vs-resource-editor/)

```
In the Visual Studio resource editor, you can hit "Shift + Enter" 
to create a new line, as doing something like "\r\n" will get escaped 
out.  You will also need to increase the cell height to see both 
lines as it does not auto-size. 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:00:53.093

如果您以编程方式执行此操作，请将新行附加到 m_Txt.Lines，它是一个字符串 []。

```
m_Txt.Lines = new string[]{ fileInfo.m_Title, fileInfo.m_Identifier, fileInfo.m_TotalTime}; 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:55:43.477

不知道为什么除非发生其他事情，否则您的代码将无法工作。

我刚刚使用 C# 创建了一个 WinForms 项目，添加了一个文本框，将其设置为多行并添加了以下代码 - 很有魅力。

```
textBox1.Text = "a\r\nb"; 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2015-01-05T20:59:25.570

我刚刚写了这段代码，似乎工作正常。

```
public void setComments(String comments)
        {
            String[] aux;
            if(comments.Contains('\n')) //Multiple lines comments
            {
                aux = comments.Split('\n');
                for (int i = 0; i < aux.Length; i++)
                    this.textBoxComments.Text += aux[i] + Environment.NewLine;  
            }
            else //One line comments
                this.textBoxComments.Text = comments;
        } 
```

# flash - 如何从 Flash 或 Javascript 填写 Web 表单？

> ID：927685
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:19:06.280
> 
>         
> 
> 标签：flash, scripting, selenium, imacros

我正在寻找一种从 Flash 或 javascript 填写 Web 表单的解决方案。“填充”应该以非视觉方式完成。“填充”应该从用户计算机启动，因为我需要访问本地网络资源。

仅通过查看 Selenium 和 iMacros，我就可以看出创建足够智能的播放器是一个相当大的项目。我也不想构建“记录器”部分，所以我正在寻找一种可以使用一些标准宏（Selenium 或 iMacros，或其他东西）的解决方案

**理想情况下，我想要一个可以播放 iOpus iMacros 脚本或 Selenium 脚本的“flash 播放器”或“javascript 播放器”。**

预期行为

*   用户打开我的网站

*   用户点击我网站中的按钮

*   在后台（在用户的 PC 上）一些脚本打开另一个网站（本地网站），填写一些编辑并按下“确定”按钮。

**那可能吗？是否有任何现有的图书馆可以提供帮助？**

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:48:41.183

我认为 JavaScript 的相同源限制可以防止这种情况（如果我理解正确的话）。基本上，JavaScript 不允许访问除托管其内容的服务器之外的任何服务器。这主要是为了防止访问防火墙内的内容（即防火墙内的计算机连接到防火墙外托管的某个站点，上面有一些脚本 - 如果 JavaSCript 可以从主机访问不同的站点，则该站点的服务器可以访问信息防火墙后面）。

我不确定 Flash 是如何处理事情的，但如果不存在相同的限制，我会感到惊讶。  

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:24:02.013

您可以通过 document.forms[i] 访问表单元素，但允许一个网站对另一个网站执行此操作将是一个很大的安全漏洞。（想象一下：你打开 veryfunnyvideos.com，它会在后台打开 Gmail 并做一些事情。）

# visual-studio-2010 - F# 2010 Seq.generate_using

> ID：927687
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T19:19:19.760
> 
>         
> 
> 标签：visual-studio-2010, f#

在 Visual Studio 2010 中是否有 Seq.generate_using 的替代/解决方法？FSharp.PowerPack.dll 不适用于 2010 AFAIK

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T21:42:31.390

（抱歉，PowerPack 仍然无法在 2010 年推出。）

我不记得 CTP 更新是否已经如此，但在内部位中我收到警告：

> 此构造已弃用。此功能将在未来的版本中删除。如有必要，从 F# PowerPack 获取其实现的副本并将其复制到您的应用程序中

所以这里是来自 PowerPack 的代码：

```
#nowarn "9"

namespace Microsoft.FSharp.Compatibility

open System.Collections.Generic

module Seq = 
  let combine     ie1 ie2  = Seq.zip ie1 ie2
  let nonempty (ie : seq<'T>)  = use e = ie.GetEnumerator() in e.MoveNext() //'

  let generate openf compute closef = 
        seq { let r = openf() 
              try 
                let x = ref None
                while (x := compute r; (!x).IsSome) do
                    yield (!x).Value
              finally
                 closef r }

  let generate_using (openf : unit -> ('b :> System.IDisposable)) compute = //'
        generate openf compute (fun (s:'b) -> s.Dispose()) //'

  let cons (x:'T) (s: seq<'T>) = 
        seq { yield x
              yield! s } 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-06-04T01:59:56.077

仅供参考，.Net 4.0 Beta1 的 PowerPack 二进制文件今天上线：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=e475a670-9596-4958-bfa2-dc0ac29b4631&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=e475a670-9596-4958-bfa2-dc0ac29b4631&displaylang=en)

# wpf - WPF - 从 WPF 应用程序切换到 xbap

> ID：927688
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T19:19:19.807
> 
>         
> 
> 标签：wpf, xbap

我有一个工作的 WPF 应用程序。我希望看到它作为 xbap 运行。我需要在我的 WPF 应用程序中进行哪些更改才能使其作为 xbap 运行？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:45:14.347

当涉及到你可以用图形做什么时，两者之间的唯一区别是 XBAP 不能使用 BitmapEffects。除此之外，沙盒安全问题几乎是您唯一需要处理的事情。大多数纯 WPF 程序应该可以顺利过渡。

查看[WPF 和 XBAP 之间差异的比较](http://wpfwonderland.wordpress.com/2007/01/28/comparing-wpf-applications-and-xbap-whats-the-difference/)。

这是[创建 XBAP 应用程序的教程](http://www.xbap.org/tutorial.html)。

基于此，您可以进行相当简单的重构来为您的程序同时容纳 WPF 和 XBAP。

*   首先，将所有 WPF 代码移动到与核心 WPF EXE 项目分开的 .dll 项目中。在您的核心 WPF EXE 项目中引用此项目。

*   修改 EXE 项目的 App.xaml 以从您的 .dll 项目指向您的主页。

*   创建一个新的 XBAP 项目。

*   在你的XBAP项目中引用上面提到的dll项目

*   修改 XBAP 项目的 App.xaml 以从您的 .dll 指向主页

*   发布并运行。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-10-22T16:08:40.277

是的，我们可以在 XBAP 中使用 Windows。但是第一个对象必须是Page，因为Page会显示在浏览器上。您可以在页面上放置一个按钮并从中打开窗口。

# c - 分块传输解码器，C 的代码片段

> ID：927694
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:20:19.930
> 
>         
> 
> 标签：c, decode, chunked-encoding

> **可能的重复：**
> 
>   [使用 Actionscript 解码分块的 HTTP](https://stackoverflow.com/questions/287920/decoding-chunked-http-with-actionscript)

我正在制作一个仅允许访问我的文件夹、下载其中的文件以及上传到文件夹的 http 服务器。到目前为止，我已经完成了大部分工作，唯一剩下的就是上传文件了。每当我从客户端接收文件时，它们都会发送分块数据。

我不明白解码。我只需要一个函数来解码我在套接字上收到的数据。甚至可以让我禁止浏览器发送分块传输。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:30:07.663

分块传输是 HTTP/1.1 规范的一部分。如果您的服务器仅响应 HTTP/1.0 响应，我希望客户端在不使用块的情况下上传数据。

# svn - 将修订与 Trac 一起分组？

> ID：927698
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:22:26.663
> 
>         
> 
> 标签：svn, trac, commit, post-commit

如何在 Trac 中[“将您已经提交给 svn 的一堆修订组合在一起”](https://stackoverflow.com/questions/926354/grouping-commited-files-together-as-a-single-commit-after-youve-already-commit/927455#927455)（参见 Jim T 的回答）？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:45:50.160

最基本的想法是在提交时将错误编号放入修订日志中。如果这是第一件事，那么当您查看日志时，您将能够轻松地看到错误编号。

我知道 Redmine 有一个附加功能，可以检查提交日志中的这些错误编号并将修订附加到错误，因此您可以从错误中看到修复它所涉及的所有修订。如果 trac 没有类似的东西，我会感到惊讶。

TortoiseSVN 也通过[bugtraq 属性](http://tortoisesvn.net/issuetracker_integration)支持票务系统。它们以不同的方式与跟踪软件集成——从突出错误编号并允许它们显示的简单正则表达式到可以安装在乌龟中以在提交时浏览打开的错误的完全成熟的模块。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:07:19.163

您将在 vailla Trac 中获得的最好的结果是在您的提交评论中放置一个指向票证的链接（“#123 的固定 blah blah blah”注意：# 是 trac 将如何获取链接。

缺点是 trac 不跟踪工单正文/数据库中的变更集。提交评论将正确链接突出显示并且易于搜索，但默认情况下不存在您想要的细粒度级别跟踪。

我*认为*你可以通过使用 svn 的 post/pre-commit 钩子脚本来实现你想要的。Trac 附带了一个示例。

# php - 调整时区和 DST

> ID：927703
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:23:40.967
> 
>         
> 
> 标签：php, mysql, datetime

在我的网站上，用户可以为其当前时区设置首选项。我的数据库中有一堆日期时间，但我想适当地显示每个时间，给定 A）它们所在的时区，以及 B）夏令时是否有效。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T19:33:37.237

这是一个多步骤的过程。

1.  允许用户从[Olson 时区数据库](http://www.twinsun.com/tz/tz-link.htm)中选择他们的时区。如果您在 Linux 或其他 Unices 上，它可能已经安装在您的机器上。

2.  将**所有**日期和时间存储为 UTC。没有例外。

3.  当用户请求一个页面时，加载它并且无论何时需要格式化时间，使用用户的时区首选项并使用时区感知格式化功能。PHP 和 Python 都有办法以合理的方式存储日期和时间。

    [Haluk 有一个很好的例子来说明如何使用 PHP 的 DateTimeZone。](https://stackoverflow.com/questions/927703/mysql-adjusting-for-timezones-and-dst/1481498#1481498)但是，如果您使用的遗留代码在请求中只使用一个时区，则可以使用这样的东西；这是我在自定义 PunBB 以正确显示时区时使用的（我从那里继续前进......）

    ```
    /**
     * Sets up the timezone system. $timezone is the timezone. In PunBB, this is
     * called by setup_dates($pun_user['timezone']) in common.php.
     *
     * DON'T USE THIS unless you can't use PHP's DateTime module.
     */
    function setup_dates($timezone) {
        if(function_exists('date_default_timezone_set')) {
            date_default_timezone_set($timezone) ;
        } else {
            putenv('TZ='.$timezone) ;
        }
    } 
    ```

    在 Python 中，使用[pytz](http://pytz.sourceforge.net/)库，它也应该已经安装在您的服务器上（同样，假设 *nix）。如果不是，请让您的系统管理员安装它（发行版通常对其进行自定义以使用内置时区数据库），或者只是使用`easy_install`. pytz 提供了很好的[使用示例](http://pytz.sourceforge.net/#example-usage)。您将要使用以下`astimezone`方法：

    ```
    >>> utc_dt = datetime(2002, 10, 27, 6, 0, 0, tzinfo=utc)
    >>> loc_dt = utc_dt.astimezone(eastern)
    >>> loc_dt.strftime(fmt)
    '2002-10-27 01:00:00 EST-0500' 
    ```

    每次格式化时间供用户阅读时执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:28:37.743

我们使用针对用户时区进行调整的日期格式化方法/函数。日期/时间存储在我们的本地时区 (PST) 中并进行适当转换。

我见过其他使用 unix 时间戳将所有内容存储在 GMT 中的系统。您仍然需要将其转换为用户的时区。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-09-26T15:53:25.427

当我查询我的数据时，我使用以下 PHP 脚本

```
<?  while($row = mysql_fetch_array($registration)){ 

  $dt_obj = new DateTime($row['message_sent_timestamp']." UTC");
  $dt_obj->setTimezone(new DateTimeZone('Europe/Istanbul'));
  echo $formatted_date_long=date_format($dt_obj, 'Y-m-d H:i:s'); } ?> 
```

您可以在此处将 datetimezone 值替换为可用的[php 时区](http://us3.php.net/manual/en/timezones.php)之一：

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:34:24.987

MySQL 将其本地日期/时间类型存储为服务器上的 UTC，并基于每个连接将它们转换为其他时区。如果连接没有指定时区，它会尝试使用服务器时间。[您可以在文档](http://dev.mysql.com/doc/refman/5.0/en/time-zone-support.html)中阅读有关此内容的更多信息。但你应该能够做到：

`SET time_zone = timezone;`

到查询开始时的客户端时区，或者如果您按请求连接。

# java - 使用 Spring DM 添加 ServiceListener

> ID：927708
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T19:25:19.530
> 
>         
> 
> 标签：java, osgi, spring-dm

我想知道是否可以做相当于

```
public void start(BundleContext context)
{  
    String filter = "filter for my specific service";
    context.addServiceListener(new MyServiceListener(), filter);
} 
```

与弹簧 DM。[我找到了为生命周期管理添加侦听器的](http://static.springframework.org/osgi/docs/1.1.3/reference/html-single/#service-registry:export:lifecycle)参考资料。但这与注册服务的生命周期有关。我需要了解注册/注销特定服务接口的任何服务的生命周期。  

需要知道这一点的包实际上**并不是**在创建服务，而是将使用它。由于该服务的多个实例会在运行时更改，因此我不能简单地在我的 Spring 配置中创建服务引用。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-01T11:33:27.563

Spring DM 包括对引用服务集合的支持。不幸的是，作为一个新用户，我不能发布链接，但是这个功能在 Spring DM 1.2 文档的第 7.2.2 节中有描述。Spring DM 在运行时自动更新此集合的内容，因为服务被添加到服务注册表中或从服务注册表中删除。

当您声明对服务的引用时，无论是作为单个引用还是服务集合，您还可以声明一个侦听器 bean，它将在服务来来去去时得到通知。这记录在第 7.2.3 节中。

我建议使用列表或服务集，并使用侦听器 bean，以便在集合内容发生更改时通知您。

# iphone - iPhone + Quartz：如何获得水的效果

> ID：927714
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:26:38.840
> 
>         
> 
> 标签：iphone, cocoa-touch, graphics, quartz-graphics

有没有机会在 iPhone 上用 Quartz 构建水效果？

类似于这个的东西：

[替代文字 http://img37.imageshack.us/img37/6358/bild1wbm.png](http://img37.imageshack.us/img37/6358/bild1wbm.png)

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T19:36:24.593

**为此，我强烈推荐使用 OpenGL ES**。

尽管您在[**这个 SO question**](https://stackoverflow.com/questions/845662/core-animation-or-opengl-es)中解决的问题很“简单”，但我当时也推荐了 OpenGL ES。所以，你可以想象我为什么再次建议它。

检查**[这个 SO question](https://stackoverflow.com/questions/726738/how-do-i-make-a-water-effect-view-with-opengles-on-the-iphone)**以了解 OpenGL 的水效果。

# asp.net-mvc - 如何使操作方法上的 ActionFilter 优先于控制器上的相同 ActionFilter

> ID：927721
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T19:29:04.017
> 
>         
> 
> 标签：asp.net-mvc

由于自 11 月以来 asp.net mvc 发生了很大变化，有没有人可以解决这个问题：

[解决 Controller 和 Action 上的 FilterAttributes](https://stackoverflow.com/questions/274039/resolve-filterattributes-on-controller-and-action)

Phil 说控制器上的 ActionFilter 只是将属性应用于控制器的所有操作方法的简写，这是真的，如果我将相同的 ActionFilter 属性放在控制器和操作方法上，它将运行两次。但这似乎不是自然行为，因为编译器甚至不允许您多次将相同的属性直接放在方法上。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-30T00:51:01.743

通过在每个过滤器上指定 Order 属性，一个过滤器可以优先于另一个过滤器。例如...

```
[MyFilter(Order=2)]
public class MyController : Controller
{
    [MyFilter(Order=1)]
    public ActionResult MyAction()
    {
        //...
    }
} 
```

在此示例中，操作方法上的过滤器将在控制器上的过滤器之前执行。

高温高压

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2010-09-14T08:03:15.847

我找到了一种方法，通过使用排序、继承和 AttributeUsage 参数“作弊”

首先，为控制器定义 ActionFilter

```
[AttributeUsage(AttributeTargets.Class)]
public class FilterController : ActionFilterAttribute
{
    public FilterController()
    {
        this.Order = 2;
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        if (!filterContext.HttpContext.Items.Contains("WeAlreadyWentThroughThis"))
        {
                // do our thing
            filterContext.HttpContext.Items.Add("WeAlreadyWentThroughThis", "yep");
            base.OnActionExecuted(filterContext);
        }
    }
} 
```

然后继承你的动作属性的类

```
[AttributeUsage(AttributeTargets.Method)]
public class FilterAction : FilterController
{
    public FilterAction()
    {
        this.Order = 1;
    }
} 
```

它远非完美，因为您必须依赖 HttpContext 和两个类（尽管您可以使用命名空间将两个类命名为相同）。但是你会得到类或动作的属性范围的编译器强制检查，并且在键入代码时你不会忘记一个 order 参数。

# data-binding - 数据绑定失败

> ID：927722
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:29:09.070
> 
>         
> 
> 标签：data-binding, bindingsource

我有一个包含 30 个数据字段的表单 - 主要是显示字符串数据的 TextBox 控件，但有 3 个下拉列表组合框和一个用于显示日期时间的文本框。我正在使用 BindingSource 将这些字段绑定到从 BindingList<> 派生的自定义数据对象。

根据数据源中数据的内容，有时特定字段将无法绑定 - 这意味着来自数据源的数据不会移动到控件中。失败的控件是一个简单的 textbox.text / string 绑定。

我可以执行一个特定的查询，在每个实例中都会导致这个特定的字段无法绑定。我还有其他可以执行的查询，这些查询可以生成一组数据，其中绑定都可以正常工作。

我的问题是 - 是什么导致数据绑定失败？其他绑定字段的失败会阻止所有其他绑定触发吗？  

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-08-06T21:38:54.610

您可以检查以下几点

*   数据字段的大小是否与 UI 中的字段不匹配

*   数据中是否有特殊字符

*   绑定字段的代码是否在某些情况下未运行

*   是否有一些代码正在清除绑定

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-01-18T21:23:03.487

我通过编写自己的绑定基础结构解决了这个问题。这让我可以更明确地控制绑定何时触发以及结果发生的情况。

# sql - 什么是用于选择项目/属性列表中具有多个属性的项目的 SQL 语句？

> ID：927724
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T19:29:49.553
> 
>         
> 
> 标签：sql, relational-division, sql-match-all

假设我有一个表，其中列出了项目和属性，例如，

```
frog    green
cat     furry
frog    nice
cat     4 legs
frog    4 legs 
```

从项目列中，我想选择具有绿色和 4 条腿属性的唯一对象。在这种情况下，我希望只取回青蛙对象。执行此操作的最有效查询是什么？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-29T19:37:24.107

```
select  item.name 
from    item 
where   item.attribute in ('4 legs', 'green') 
group by item.name 
having  count(distinct item.attribute) = 2 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:37:33.077

最有效的方法是使用自联接：

```
SELECT * FROM attributes a1 
JOIN attributes a2 USING (item_name) -- e.g. frog
WHERE a1.value = 'green' AND a2.value = '4 legs'; 
```

有些人使用的另一个解决方案是使用 GROUP BY 的技巧：

```
SELECT item_name FROM attributes
WHERE value IN ('4 legs', 'green')
GROUP BY item_name
HAVING COUNT(*) = 2; 
```

但是 GROUP BY 解决方案可能不如 JOIN 高效，具体取决于您使用的 RDBMS 品牌。此外，随着表中容量的增加，一种方法可能会更好地扩展。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:33:01.637

select * from table where thing='frog'

没有什么比知道你想要什么更好的了。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:38:26.553

```
select
    item, count(*)
from
    @temp
where
    attribute in ('4 legs','green')
group by
    item
having
    count(*) = 2 -- this "2" needs to be replaced with however many attributes you have 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:55:01.170

您也可以分别查询每个属性，然后将它们相交...

```
/*
-- create sample table...
create table #temp1
    (item varchar(max),
    attrib varchar(max))

-- populate sample table (SQL 08)...
insert #temp1
values ('frog', 'green'), ('cat', 'furry'), ('frog', 'nice'), ('cat', '4 legs'), ('frog', '4 legs')
*/

SELECT  item
FROM    #temp1
WHERE   attrib = 'green'
INTERSECT
SELECT  item
FROM    #temp1
WHERE   attrib = '4 legs' 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:34:20.727

~~很难，因为它不是标准化模型。~~这是一个周末。

您正在过滤多个未连接的行，因此您必须依次提取每个属性，然后匹配项目。

```
SELECT
   item
FROM
    (SELECT
        item
    FROM
        Mytable
    WHERE
        attribute = '4 legs') k1
    JOIN
    (SELECT
        item
    FROM
        Mytable
    WHERE
        attribute = 'green') k2 ON k1.item = k2.item 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:34:29.060

创建两个表，一个项目和一个属性。

项目可以是名称、intAttributeID，其中 intAttributeID 是对 Attributes 表的外键引用。这样你就可以根据你关心的任何事情来做一个选择语句。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:44:25.873

但也许这可以帮助你：

```
SELECT * 
FROM tbl t1
INNER JOIN tbl t2 ON t1.Name = t2.Name
WHERE t1.Attribute = 'green' AND t2.Attribute = '4 legs' 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T21:51:10.373

如果可能，我会重新设计。这不是您能够同时有效地查询 12 个值的东西（它将需要 12 个连接）

请阅读这篇维基百科文章
[http://en.wikipedia.org/wiki/Entity-Attribute-Value_model#Downsides](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model#Downsides)

从未见过使用这种模型的数据库最终没有遇到严重的性能问题。这种设计对于非数据库的人来说看起来很优雅，但实际上通常是数据库设计糟糕的标志。

# asp.net-mvc - 确定绑定时更改了哪些字段

> ID：927728
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:30:51.470
> 
>         
> 
> 标签：asp.net-mvc

如何确定模型编辑后哪些字段发生了变化

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T23:29:45.870

如果您使用的是 Linq to SQL，则 GetModifiedMembers 方法采用类型 Object 的参数，并返回 System.Data.Linq.ModifiedMemberInfo 对象的数组。DataContext 中的每个 Table 类都有一个可以在任何实体上调用的 GetModifiedMembers 方法。

[http://msdn.microsoft.com/en-us/library/system.data.linq.itable.getmodifiedmembers.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.itable.getmodifiedmembers.aspx)

在实体框架中，使用 ObjectStateManager，可以访问所有这些更改信息，如对象状态（添加/修改/删除）、修改的属性、原始值和当前值

```
IEnumerable<ObjectStateEntry> changes = 
        this.ObjectStateManager.GetObjectStateEntries(
        EntityState.Added | EntityState.Deleted | EntityState.Modified); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T23:37:51.097

您可以在您的实体上实现 INotifyPropertyChanged。您需要为每个属性触发 PropertyChanged 事件......因此您必须进行一些重构才能使其正常工作。它是使用 .NET 实现它的唯一内置方法。

如果您不想手动实现 INotifyPropertyChanged，您可以使用 PostSharp 更新您的类并在编译时调整您的属性。但是，这将需要预先进行相当复杂的工作。

# python - 如何覆盖 Django 中超类模型字段的详细名称

> ID：927729
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-05-29T19:30:57.083
> 
>         
> 
> 标签：python, django, inheritance, django-models

假设我有一个继承自 SuperFoo 的模型 Foo：

```
class SuperFoo(models.Model):
    name = models.CharField('name of SuperFoo instance', max_length=50)
    ...

class Foo(SuperFoo):
    ... # do something that changes verbose_name of name field of SuperFoo 
```

在 Foo 类中，我想覆盖 SuperFoo 的名称字段的 verbose_name。我可以吗？如果不是，最好的选择是在模型表单定义中设置标签以使其显示在模板中？

* * *

## 回答 #1

> 赞同：58
> 
>             
> 
> 时间：2009-05-30T02:02:46.623

我使用的一个简单的技巧是：

```
class SuperFoo(models.Model):
    name = models.CharField('name of SuperFoo instance', max_length=50)
    ...
    class Meta: 
        abstract = True

class Foo(SuperFoo):
    ... # do something that changes verbose_name of name field of SuperFoo
Foo._meta.get_field('name').verbose_name = 'Whatever' 
```

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2014-06-29T11:54:04.983

请记住修改 Foo._meta.fields 也会影响超类的警告 - 因此只有在超类是抽象的情况下才真正有用，我已经将@Gerry 放弃的答案包装为可重用的类装饰器：

```
def modify_fields(**kwargs):
    def wrap(cls):
        for field, prop_dict in kwargs.items():
            for prop, val in prop_dict.items():
                setattr(cls._meta.get_field(field), prop, val)
        return cls
    return wrap 
```

像这样使用它：

```
@modify_fields(timestamp={
    'verbose_name': 'Available From',
    'help_text': 'Earliest date you can book this'})
class Purchase(BaseOrderItem):
    pass 
```

上面的示例更改了继承字段 'timestamp' 的 verbose_name 和 help_text。您可以传入尽可能多的关键字参数，因为您要修改的字段。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:39:38.990

您最好的选择是设置/更改表单本身的标签。引用模型的`name`字段`Foo`（例如，通过在 中查找`Foo._meta.fields`）实际上会为您提供对 的`name`字段的引用`SuperFoo`，因此更改它`verbose_name`会在两个模型中更改它。

此外，向类添加`name`字段`Foo`也不起作用，[因为](http://docs.djangoproject.com/en/dev/topics/db/models/#field-name-hiding-is-not-permitted)...

> 覆盖父模型中的字段会导致在初始化新实例（指定正在初始化的字段
>   `Model.__init__`）和序列化等领域出现困难。这些是普通 Python 类继承不必以完全相同的方式处理的特性，因此 Django 模型继承和 Python 类继承之间的区别不仅仅是任意的。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2011-06-21T13:43:24.850

看看 Django-CMS 是如何做到这一点的，它们会覆盖`db_table`模型中继承自`CMSPlugin`. 基础知识（我也用于我自己的东西）归结为：

```
class SuperFooMetaClass(ModelBase):
    def __new__(cls, name, bases, attrs):
        new_class = super(SuperFooMetaClass, cls).__new__(cls, name, bases, attrs)
        new_class._meta.verbose_name = "...."   # perhaps only if not customized
        return new_class

class SuperFoo(models.Model):
    __metaclass__ = SuperFooMetaClass

    .... 
```

您可以添加一些检查，例如仅更新子类（不是直接类型），或者仅在未自定义值时更新。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2020-06-10T09:38:27.240

我有来自同一个基类的不同子类。而且我只关心 Django Admin 界面中的表单视图。

唯一对我有用的解决方案是自定义 Django Admin 界面并在那里设置 verbose_name（或 help_text）：

```
class FooAdmin(admin.ModelAdmin):
    def get_form(self, request, obj=None, **kwargs):
        form = super().get_form(request, obj, **kwargs)
        form.base_fields['name'].verbose_name = "my verbose name"
        return form

admin.site.register(models.Foo, FooAdmin) 
```

# bash - 如何跳转到 shell 输出的第一行？(shell 等效于 emacs comint-show-output)

> ID：927730
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:31:00.923
> 
>         
> 
> 标签：bash, shell

我最近在 emacs shell 模式下发现了“comint-show-output”，它跳转到 shell 输出的第一行，当查看超过屏幕长度的 shell 输出时，我发现它非常方便。与使用“向上翻页”滚动相比，此命令的优点是 A）您不必用眼睛扫描输出的第一行 B）您只需按一次组合键（而不是“向上翻页”可能事先不知道的次数）。

我想过用'|结束我所有的命令 more' 但实际上这不是我想要的，因为大多数时候，我想将所有输出保留在终端缓冲区中，并且我通常想先看到 shell 输出的结尾。

我使用 OSX。是否有终端应用程序（在 os x 上）和 shell（在远程 linux 上）组合等效（所以我可以在不使用 emacs 的情况下做类似的事情 - 我知道，疯狂的谈话）？我通常使用 bash，但只为这个特性切换 shell 就可以了。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-30T00:54:58.303

我做这种事情的方式是将我的输出发送到一个文件，然后在文件写入时观察文件。您仍然可以实时将命令的结果转储到终端历史记录中，并且仍然可以在事后进一步检查输出的实际内容（或在另一个终端等...）

```
command > output &
tail -f output

head output 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:41:41.197

你总是可以像这样在 bash 中做一些事情：

```
alias foo='!! | more' 
```

这将使 foo 运行上一个命令更多。我不确定有什么方法可以完全按照您的建议进行。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:50:15.487

如果您期望大量输出并且不想运行您的命令两次，您可以使用[`tee(1)`](http://linux.die.net/man/1/tee)fork 输出：

```
my-command | tee /tmp/my-command.log | less 
```

这会将输出通过管道传输到分页器 ( `less`)，同时将输出记录到文件（在本例中为名为 的文件`/tmp/my-command.log`）。如果您需要在退出后查看输出`less`，您可以只查看`cat`日志文件而不是重新运行命令。

# wpf - UIElements 除了选项卡标题

> ID：927733
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:31:47.427
> 
>         
> 
> 标签：wpf, datatemplate, tabcontrol, uielement

有没有办法在 s' 标题`UIElement`的右侧放置一些东西（自定义）`TabItem`，以便标题会考虑它的大小。

我觉得他们应该有一个数据模板，但我不知道该读什么或如何查询谷歌。

[替代文字 http://trotsenko.com.ua/files/sample.png](http://trotsenko.com.ua/files/sample.png)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T22:53:40.747

没有一种简单的方法可以将内容放置在该位置，但是有一种方法。为此，您必须覆盖`ControlTemplate`.`TabControl`

大多数系统主题都将`TabPanel`（选项卡所在的位置）和选项卡内容放在`Grid`这样的位置：

```
<ControlTemplate TargetType="{x:Type TabControl}">
                    <Grid KeyboardNavigation.TabNavigation="Local"
                          SnapsToDevicePixels="true"
                          ClipToBounds="true">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition x:Name="ColumnDefinition0"/>
                            <ColumnDefinition x:Name="ColumnDefinition1"
                                              Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition x:Name="RowDefinition0"
                                           Height="Auto"/>
                            <RowDefinition x:Name="RowDefinition1"
                                           Height="*"/>
                        </Grid.RowDefinitions>
                        <TabPanel x:Name="HeaderPanel"
                                  Panel.ZIndex ="1" 
                                  KeyboardNavigation.TabIndex="1"
                                  Grid.Column="0"
                                  Grid.Row="0"
                                  Margin="2,2,2,0"
                                  IsItemsHost="true"/>

                        <Border x:Name="ContentPanel"
                                BorderThickness="0,0,1,1"
                                BorderBrush="#D0CEBF"
                                KeyboardNavigation.TabNavigation="Local"
                                KeyboardNavigation.DirectionalNavigation="Contained"
                                KeyboardNavigation.TabIndex="2"
                                Grid.Column="0" Grid.ColumnSpan="2"
                                Grid.Row="1">
...

...

...
                        </Border>
                    </Grid>
...
                </ControlTemplate> 
```

因此，您**可以**将另一个 ContentControl 添加到网格并将其绑定到自定义附加属性。请记住，默认的 ControlTemplates 也有很多触发器来控制溢出处理等，并且您必须确保您的其他 UI 元素不会干扰它。

但是，如果您不必处理 TabControl 方向或溢出，您应该能够相当快地获得类似的东西：

[三个带有红色边框和文本块的 TabItem http://img35.imageshack.us/img35/3237/tabpanelexample.png](http://img35.imageshack.us/img35/3237/tabpanelexample.png)

祝你好运！

# implementation - ERD 是否规定了实施方法？

> ID：927737
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:32:42.557
> 
>         
> 
> 标签：implementation, diagram, erd

让我对 ERD 感到困惑的一件事是，他们是否对如何在技术上实施他们的关系做出任何规定。

在下图中，我不确定该图是否需要在数据库级别或应用程序级别实现这些关系。

是制定任何技术处方还是简单地定义关系并让我决定如何实施？

在构建基于它的东西之前，我是否需要从 ERD 的创建者那里获得更多信息？

[![替代文字](https://i.stack.imgur.com/JN2zw.png)](https://i.stack.imgur.com/JN2zw.png)

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:42:26.843

看来你正在把问题颠倒过来。

答案当然是：不，没有什么会迫使您在数据库中创建关系。但是你为什么不这样做呢？

这就是数据库被称为*关系数据库*的原因——因为它为您提供了一个现成可用的解决方案，与工具和持久层很好地集成，并且它对应用程序开发人员的影响是众所周知的。

不在数据库级别实现关系会很疯狂。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:04:20.293

ERD 不是您所说的“技术处方”，而只是逻辑关系的表示。

如何在数据库或应用程序中实现它取决于您。

但数据库是实施这些关系的合适场所。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:44:40.053

ERD 图是显示实体关系及其基数的逻辑图，尽管它可以同时解释为表关系图或类图，但它们都不是，您仍然需要其他图。

顺便说一句，据我所知，在数据库模型中强制执行关系以保持数据库一致性总是好的。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:46:19.673

在验证放入数据库的数据时，我会说尽可能冗余。

在应用程序端进行检查以确保唯一性/数据类型有效性一切正常。并构建数据库以拥有它需要的所有关系。

不要让数据库/应用程序假设一切都是正确的。

这可以为您节省几个小时修复孤立记录和一致性问题的时间。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T19:46:55.070

**“是不是在开什么技术处方……”**

它看起来不像代码。也许我错过了一些东西。

**“或者只是定义关系并让我来决定如何实现它？”**

这取决于你的客户。  

如果他们认为图表与代码同构，那么您将不得不从约定或上下文中理解缺失的部分。

如果他们不认为图表与代码同构，那么您将不得不决定如何实现它。

# python - 真的很奇怪（mod）_python问题

> ID：927759
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T19:38:24.107
> 
>         
> 
> 标签：python, debugging, mod-python

这个很难解释！

我正在编写一个通过 mod_python 运行的 python 应用程序。在每个请求中，返回的输出都不同，即使逻辑是“固定的”。

我有两个班，`classA`和`classB`。这样：

```
class ClassA:
    def page(self, req):
        req.write("In classA page")
        objB = ClassB()
        objB.methodB(req)
        req.write("End of page")

class ClassB:
    def methodB(self, req):
        req.write("In methodB")
        return None 
```

这是我所拥有的一个**严重剪断的版本。**但是我剪掉的东西并没有改变控制流。只有**一个**地方`MethodB()`被称为。那是从`__init__()`.`classA`

您会期望以下输出：

```
In classA __init__
In methodB
End of __init__ 
```

但是，看似随机地获得上述正确输出或：

```
In classA __init__
In methodB
End of __init__
In methodB 
```

stacktrace 显示`methodB`第二次从`__init__`. `methodB`应该只调用一次。如果它被第二次调用，你会期望其他逻辑`__init__`也被执行两次。但是之前或之后`methodB`都没有执行，也没有递归。

我通常不会求助于使用 SO 进行调试，但我一直在为此挠头。

版本：2.5.2 r252:60911

**提前致谢**

**编辑**
一些暗示问题可能出在其他地方的线索....对代码段的上述更改会导致每 250 次左右的点击中出现奇怪的输出 1。这很奇怪。

打印“In methodB”之前的输出越多，随后打印的错误就越多……平均而言，不是直接比率。它甚至在 Lynx 中也是如此。

我要回到绘图板上。

:(

# 作为回应

mod_python 和 Apache 似乎有婚姻问题。重新启动，对于一些请求来说一切都很好。然后一切都变得越来越梨形。发行时

```
/etc/rc.d/init.d/httpd stop 
```

这需要很长的时间。RAM 也被请求吞噬了。我对 Apache 的内部结构不是很熟悉，但*感觉*就像（感谢 Nadia）线程保持活动状态并**随机对接**请求。这简直是​​疯了。

**按照 S.Lott 和 Nadia 的建议迁移到 mod_wsgi**

**再次感谢！！**

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:16:55.260

我以前见过 mod_python 的类似行为。通常是因为 apache 正在运行多个线程，其中一个正在运行旧版本的代码。当您刷新页面时，使用旧代码的线程可能正在为页面提供服务。我通常通过停止 apache 然后重新启动它来解决这个问题

```
sudo /etc/init.d/apache stop
sudo /etc/init.d/apache restart 
```

自行重启并不总是有效。有时即使这样也行不通！这可能听起来很奇怪，但在极少数情况下，我最后的手段是`raise Exception()`在处理程序的第一行添加一条语句，刷新页面，重新启动 apache，然后再次刷新页面。每次都这样。必须有更好的解决方案。但这对我有用。mod_python 肯定会让人发疯！

我希望这可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:41:07.797

我真的不知道，但构造函数不应该返回任何东西，所以删除`return None`. 即使他们可以返回东西，`None`如果函数本身不返回任何东西，也会自动返回。

而且我认为您需要`self`在 MethodB 中进行论证。

**编辑：**你能显示更多代码吗？这工作正常。

# jquery - 为 jQuery 自动完成结果格式化数据

> ID：927766
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:40:16.537
> 
>         
> 
> 标签：jquery, asp.net-mvc, autocomplete

我有一些我正在格式化的数据：

```
 // ... imagine populating a SqlDataReader with some results ...
 var results = new StringBuilder();
 while (reader.Read())
 {
     results.AppendFormat("{0}, {1}\n", reader["name"], reader["emailAddress"]);
 }
 return results.ToString(); 
```

我的控制器操作非常简单：

```
 public ActionResult Find(string q)
 {
     var users = Customer.Search(q);
     return Content(users);
 } 
```

我在视图中的 javascript 看起来像这样：

```
 $(document).ready(function() {
     $("input#user").autocomplete('<%= Url.Action("Find", "Customer") %>', {
         minChars: 2,
         width: 500,
         matchContains: true,
         autoFill: false,
         formatItem: function(row, i, max) {
             return i + "/" + max + ": (" + row[0] + ") " + row[1];
         },

         formatMatch: function(row, i, max) {
             return row[0];
         },

         formatResult: function(row) {
             return row[1];
         }
      });
    }); 
```

***问题一***

我正在使用[此处的自动完成](http://docs.jquery.com/Plugins/Autocomplete "从这里自动完成")功能。在这一点上，我遇到了一个问题，我无法将这两个字段作为单独的值读取。例如，如果行名称字段为“John”，其电子邮件字段为“john@doe.com”，我希望它们分别显示在第 [0] 行和第[1](http://docs.jquery.com/Plugins/Autocomplete "从这里自动完成")行中。但是，他们目前在行 [0] 中得到“John，john@doe.com”，并且第[1](http://docs.jquery.com/Plugins/Autocomplete "从这里自动完成")行未定义。

我需要更改什么（在 javascript 或我构建字符串的方法中）以获取 row[0] 和 row [1](http://docs.jquery.com/Plugins/Autocomplete "从这里自动完成")以显示正确的数据？

***问题 B***

我希望将数据命名为行中的数据。我的意思是：

```
 formatItem: function(row, i, max) {
     return i + "/" + max + ": (" + row.name + ") " + row.email; 
```

我挣扎了一段时间来格式化我的数据，所以这会发生，但我从来没有成功。我将如何格式化我的数据以便自动完成功能能够理解这一点？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:52:54.747

如果您创建具有名称和电子邮件属性的类的结果列表，然后将其作为 JSON 返回，那么我认为它会按照您希望的方式工作。

中级

```
public class AutocompleteResult
{
    public string Name { get; set; }
    public string Email { get; set; }
} 
```

搜索代码：

```
var results = new List<AutocompleteResult>();
while (reader.Read())
{
    results.Add( new AutocompleteResult
                     {
                         Name = reader["name"],
                         Email = reader["email"]
                     });
}
return results; 
```

行动：

```
public ActionResult Find(string q)
{
    var users = Customer.Search(q);
    return Json(users);
} 
```

看法：

我认为...关键区别在于解析方法和数据类型，您可能需要调整解析方法等。人。获得正确的格式。您也许可以摆脱 formatResult/formatMatch，但我不确定。我不使用这些，我记得我在 parse 中所做的事情正确设置了值。我试图保留你的基本代码，但正如我所说，我没有使用你所做的所有方法，也没有深入探索它们。

```
$(document).ready(function() {
    $("input#user").autocomplete('<%= Url.Action("Find", "Customer") %>', {
        dataType: 'json',
        minChars: 2,
        width: 500,
        matchContains: true,
        autoFill: false,
        parse: function(data) {
           var array = new Array();
           for (var i = 0; i < data.length; ++i) {
              var datum = data[i];
              array[array.length] = {
                          data: datum,
                          value: datum.Name,
                          result: dataum.Email
              };
           }
        }
        formatItem: function(data, i, max) {
            return i + "/" + max + ": (" + data.Name + ") " + data.Email;
        },
        formatMatch: function(data, i, max) {
            return data.Name;
        },
        formatResult: function(data) {
            return data.Email;
        }
     });
}); 
```

# c# - 如果 CMI_DataFile 类具有“where condition1 AND condition2”（C#），则对 CMI_DataFile 类的 WMI 查询会产生“无效查询”

> ID：927767
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:40:24.773
> 
>         
> 
> 标签：c#, .net, wmi

好的，这就是我正在做的只提炼到 System.Management 调用的内容：

简单查询和方法调用在同一连接上工作。这个查询不会。并且该文件存在于远程机器上。线索？

```
myQuery = "Select * from CIM_DataFile Where Drive = 'C:' AND Path = '\\Users\\someguy\\Documents\\' AND FileName = 'Default' AND Extension = 'rdp'";

options = new ConnectionOptions();
options.Username = myUsername;
options.Password = myPassword;
options.Authority = "ntlmdomain:MYDOMAIN";
scope = new ManagementScope("\\\\REMOTEMACHINE\\root\\CIMV2", options);
scope.Connect();
searcher = new ManagementObjectSearcher(scope, new ObjectQuery(myQuery));
myResults = searcher.Get(); 
```

ManagementObjectSearcher.Get() 给我一个 ManagementException 说“无效查询”。一个更简单的查询，比如“SELECT * FROM Win32_NetworkAdapter”，可以工作。

我试图将 WHERE 减少到只有一个，即“Select * from CIM_DataFile Where Extension = 'rdp'”。它有效，但显然它没有让我得到我想要的。（在编辑之前，我错误地认为它即使在那时也不起作用；请参阅评论）我在这里走到了尽头。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-06-09T20:07:11.557

我是一个白痴。请不要打我。

首先，只有在 WHERE 子句中传递文件名的所有组件时，查询才能可靠地工作。

其次，我不得不将路径组件中的反斜杠加倍，我做错了。我做了：

```
pathPath.Replace("\\", "\\\\"); 
```

而我必须做的是：

```
pathPath = pathPath.Replace("\\", "\\\\"); 
```

这是正确的。我假设 String.Replace() 在线更改了字符串。糟糕的 C# 新手。坏的。

# linq - 如何在silverlight的一个linq查询中查询和计算Employees表和Project表？

> ID：927771
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:41:20.793
> 
>         
> 
> 标签：linq, silverlight, datagrid

我有两个表，一个员工表和一个项目表，我希望带回分配给每个项目的员工数量的计数。在员工表中，我有员工 ID 和项目 ID，在项目表中，我有项目 ID、姓名、部门、​​备注等。我希望带回以下信息，并将其显示在 Silverlight 中的单个 DataGrid 中，其中包含员工人数作为计数分配给每个项目。

名称 部门 备注 计数

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T19:59:22.613

有很多方法可以做到这一点，但最简单的可能是这样做：

```
var x =
    from proj in db.Projects
    select new
    {
        Name = proj.Name,
        Department = proj.Department,
        Notes = proj.Notes,
        Count = db.Employees.Where(emp => emp.ProjectID == proj.ProjectID).Count()
    }; 
```

或者，如果您在 ProjectID 上的 Projects 和Employees 之间创建了一个外键（如果没有，您应该强烈考虑这样做），LINQ 将提供更简洁的语法：

```
var x =
    from proj in db.Projects
    select new
    {
        Name = proj.Name,
        Department = proj.Department,
        Notes = proj.Notes,
        Count = proj.Employees.Count()
    }; 
```

没有比这更好的了！

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:39:51.080

我想你想要这样的东西......

```
dbContext dbCon = new dbContext();
            var projects = from project in dbCon.Projects
                           join employee in dbCon.Employees on project.ProjectID equals employee.projectid
                           group employee by new { employee.projectid, project.Name, project.Department, project.Notes } into grouping
                           select new { 
                               //projectID = grouping.Key.projectid, 
                               projectName = grouping.Key.Name,
                               projectDepartment = grouping.Key.Department, 
                               projectNotes = grouping.Key.Notes, 
                               count = grouping.Count() 
                           }; 
```

# c# - PostSharp 对象映射器

> ID：927775
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:41:58.683
> 
>         
> 
> 标签：c#, aop, postsharp

我正在考虑将 PostSharp 用于实体到 DTO 和 DTO 到实体的映射器。为大约 100 个实体手动执行该任务将是维护的噩梦。我已经在 codeplex 上查看了 AutoMapper，但我认为开销可能是我的情况下的一个严重问题，此外我觉得 PostSharp 可以让我对映射约定进行一些额外的控制。如果有人可以分享这个问题之王的经验，那就太好了。

我想的方向是这样的（如果这不可能，请有人告诉我）：

我打算坚持上课的方面将用内容填充接下来的两个方法：

```
EntityType EntityToDTO(DTOType DTO) {}

DTOType DTOToEntity(EntityType Entity) {} 
```

第一种方法将返回基于 DTO 的实体，第二种方法将执行相反的操作。在我计划遍历每个属性的方面内，创建新目标并将属性的值分配给目标对象的对应项。这是否可以在编译时完成而没有任何运行时开销？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:00:22.720

如果您的 DTO 字段名称与您的实体字段名称匹配，那么我会使用 Duck Typing

[http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx](http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx)

[http://haacked.com/archive/2007/08/19/why-duck-typing-matters-to-c-developers.aspx](http://haacked.com/archive/2007/08/19/why-duck-typing-matters-to-c-developers.aspx)

您的代码将像这样工作

```
UserDTO user = DuckTyping.Cast<UserDTO>(userEntity); 
```

基本上，duck 类型库将通过匹配名称来映射字段。他们使用动态生成的 IL 来归档它。

如果这有可能太慢，我可能会尝试让 CodeSmith 为我生成方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:09:48.660

如果有帮助，有一个名为 PostSharp4ET 的项目，它基本上实现了对实体框架 1 的 POCO 对象的支持。请参阅[http://www.codeplex.com/efcontrib](http://www.codeplex.com/efcontrib)。

请注意，PostSharp 不擅长生成新代码。它擅长将新代码与现有代码混合。如果您需要生成代码，我建议您编写一个基于反射的 C# 代码生成器，并编译生成的代码。或者使用像 CodeSmith 这样的工具，如前所述。

# c# - 上传到 FTP 后如何在文件上设置 DateTimeStamp？

> ID：927776
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T19:42:02.303
> 
>         
> 
> 标签：c#, ftp

我有一个将游戏数据文件部署到不同游戏机的应用程序。如果用户计算机和控制台上的匹配文件具有相同的大小和日期，则不得重新部署它们。

在 Xbox 上，这很容易实现，因为用于在控制台上上传文件的 XDK 库允许我设置上传文件的日期以匹配用户计算机上的日期。

然而，在 Ps3 上，我使用在控制台上运行的 FTP 服务。我`WebClient.UploadFileAsync`用来将文件上传到控制台。但是，我无法弄清楚如何设置上传文件的日期时间戳，只剩下文件大小来确定不安全的相同文件。

我想知道是否有办法通过 WebClient 接口设置文件的日期时间戳？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-18T18:06:19.410

我认为您不能为此使用 WebClient 界面。

一些 FTP 服务器似乎实现了各种非标准的 FTP 扩展命令，以支持设置文件的最后修改时间。我知道的有：

1.  MDTM - 这是获取文件最后修改时间的标准命令（由 GetDateTimestamp() 使用）。一些服务器通过为命令指定时间戳参数来支持集合操作。以及文件名。

2.  MFMT - 这是在 IETF 实验草案[MFMT](https://datatracker.ietf.org/doc/html/draft-somers-ftp-mfxx-04#section-3)中定义的，以标准化此操作并避免上述 MDTM 命令的非标准使用。

3.  网站 UTIME

如果在 PS3 上运行的 FTP 服务器支持任何这些扩展（检查 FEAT 命令的结果），那么您可以在上传文件后使用简单的套接字 FTP 连接向服务器发出适当的命令。

* * *

## 回答 #2

> 赞同：-2
> 
>             
> 
> 时间：2009-05-29T20:00:40.503

WebClient 会将 ftp 连接移交给 FtpWebRequest。如果您直接使用 FtpWebRequest，您可以向服务器发送 FTP 命令。支持的命令被定义为 WebRequestMethods.Ftp 的字段。这些命令之一是 GetDateTimestamp。

因此，如果您手动（而不是通过 WebClient）构建 FtpWebRequest 并发送 GateDateTimestamp 或 ListDirectoryDe​​tails 命令，您应该能够获取目标文件的时间戳。

# types - 将 System.types 转换为 SMO.DataTypes

> ID：927778
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T19:42:25.890
> 
>         
> 
> 标签：types, smo

我有一个项目通过 SMO 创建从 DataTable 到 SQL 表的表。

列的数据类型当前不从 System.Type 转换为 SMO.DataType。我可以通过案例声明来做到这一点，但我希望有一个更清洁的解决方案。也许涉及 TypeDescriptor.GetConverter(targetDataType)。

这适用于 System.types 和 SQL.DataTypes，但我无法将其转换为 SMO.DataTypes。

有什么建议或提示吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-07-16T20:09:52.543

我最终使用 Case 语句来处理转换。工作正常。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-08-19T12:31:56.017

我也是这样做的。我没有处理所有情况，然后在需要时添加。我的方法不是很干净...

```
 public static SqlDbType MappingToSQLType(String CLRTypeName)
    {
        string[] t = CLRTypeName.Split('.');
        for (int i = 0; i <= 31; i++)// there is 31 sqldatatypes
        {
            if (t[1].Equals("Int64") &&
                ((SqlDbType)i).ToString().ToLower().Equals("bigint"))
                return ((SqlDbType)i);
            else if (t[1].Equals("Int32") &&
                ((SqlDbType)i).ToString().ToLower().Equals("int"))
                return ((SqlDbType)i);
            else if (t[1].Equals("Int16") &&
                ((SqlDbType)i).ToString().ToLower().Equals("smallint"))
                return ((SqlDbType)i);
            else if (t[1].Equals("Boolean") &&
                ((SqlDbType)i).ToString().ToLower().Equals("bit"))
                return ((SqlDbType)i);
            else if (t[1].Equals("Double") &&
                ((SqlDbType)i).ToString().ToLower().Equals("float"))
                return ((SqlDbType)i);
            else if (t[1].Equals("Single") &&
                ((SqlDbType)i).ToString().ToLower().Equals("real"))
                return ((SqlDbType)i);
            else if (((SqlDbType)i).ToString().ToLower().Equals(t[1].ToLower()))
                return ((SqlDbType)i);
        }
        return SqlDbType.NVarChar;
    } 
```

# php - 根据大小从文件夹中抓取图像

> ID：927792
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-05-29T19:45:04.810
> 
>         
> 
> 标签：php, image, directory

好的，所以我有一个在使用此[答案后创建的文件夹](https://stackoverflow.com/questions/908679/unzip-specific-extension-only/908716#908716)

所以现在我有一个文件夹，里面有很多文件夹，每个文件夹都有图像和 .txt 文件

图片几乎都是.jpg

所以现在我想显示每个文件夹中的图像，使用 php 我想显示每个文件夹中的第一张图像，如果没有图像我想显示默认图像

所以只要有我想显示图像的文件夹的位置

有任何想法吗？它可以通过 php 或 javascript，请不要使用其他语言，它将不合时宜地用于 wordpress 主题中，文件夹位置是自定义字段参数

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T19:48:37.017

尝试使用[PHP glob](http://www.php.net/glob) - 它会在您提供的任何文件夹中返回一个文件名数组。您可以按 *.jpg 进行过滤，并且只使用数组中的第一项。

例如，我使用：

```
$imageArray = glob($folder . "/image*.jpg"); 
```

这会在文件夹中创建一个名为 image[something].jpg 的所有文件名的数组`$folder`。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T22:08:35.660

```
<?php

$record_ratio = 0;
foreach (glob("*.jpg") as $filename) {
    $info = getimagesize($filename);
    $ratio = $info[0] / $info[1];
    if (abs(1 - $ratio) < abs(1 - $record_ratio)) {
      $record_ratio = $ratio;
      $record_filename = $filename;
    }
    if (record_ratio == 1) break;
}
if ($record_ratio > 0) {
  echo '<img src="'.$record_filename.'" height=150px><br>';
}

?>

<?php
foreach (glob("*.txt") as $filename) {
        echo nl2br(file_get_contents($filename));
        echo "<br></br>";
}
?> 
```

# sql - 如何从存储过程中返回所有值？

> ID：927794
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T19:45:29.113
> 
>         
> 
> 标签：sql, delphi, stored-procedures

原谅我的天真，但我是使用 Delphi 和数据库的新手（这对某些人来说可能看起来很奇怪）。

我已经使用 TADOConnection 建立了与我的数据库 (MSSQL) 的连接。我正在使用 TADStoredProc 来访问我的存储过程。

我的存储过程返回 2 列，一列包含服务器名称，第二列包含服务器上的用户。它通常返回大约 70 条记录......不是很多数据。

如何以编程方式枚举此存储过程？我可以在我的表单上删除一个 DBGrid 并将它附加到一个 TDataSource（然后附加到我的 ADOStoredProc），我可以验证数据是否被正确检索。

理想情况下，我想枚举返回的数据并将其移动到 TStringList 中。

目前，我正在使用以下代码枚举 ADOStoredProc，但它只返回“@RETURN_VALUE”：

```
ADOStoredProc1.Open;
ADOStoredProc1.ExecProc;
ADOStoredProc1.Parameters.Refresh;

for i := 0 to AdoStoredProc1.Parameters.Count - 1 do
begin
  Memo1.Lines.Add(AdoStoredProc1.Parameters.Items[i].Name);
  Memo1.Lines.Add(AdoStoredProc1.Parameters.Items[i].Value);
end; 
```

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-29T23:09:44.583

调用 Open 以获取返回的数据集

```
StoredProc.Open;
while not StoredProc.EOF do
begin
  Memo1.Lines.Add(StoredProc.FieldByName('xyz').Value);
  StoredProc.Next;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-30T01:32:39.803

使用 Open 从 StoredProc 获取记录

使用设计时字段、在循环之前使用 FieldByName 抓取的临时字段或 Fields[nn] 来获取值。  

```
procedure GetADOResults(AStoredProc: TADOStoredProc; AStrings: TStrings);
var
  fldServer, fldUser: TField;
begin
  AStoredProc.Open;
  fldServer := AStoredProc.FieldByName('ServerName');
  fldUser := AStoredProc.FieldByName('User');
  while not AStoredProc.EOF do
  begin
    AStrings.Add(Format('Server: %s - / User: %s',[fldServer.AsString, fldUser.AsString]));
    // or with FFields and Index (asumming ServerName is the 1st and User the 2nd) and no local vars
    AStrings.Add(Format('Server: %s - / User: %s',[AStoredProc.Fields[0].AsString, AStoredProc.Fields[1].AsString]));
    AStoredProc.Next;
  end;
end;

//use like
  GetADOResults(ADOStoredProc1, Memo1.Lines); 
```

注意：Fields[nn] 允许编写更少的代码，但要注意如果 StoredProc 更改了返回列的顺序。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:53:51.380

如果您的存储过程返回结果集（数据行），请不要使用 ExecProc。它旨在执行没有结果集的过程。改为使用 Open 或 Active，然后您可以像使用参数一样处理它们：

```
ADOStoredProc.Open;

for i := 0 to ADOStoredProc1.Parameters.Count - 1 do
begin
  Memo1.Lines.Add(ADOStoredProc1.Parameters.Items[i].Name);
  Memo1.Lines.Add(ADOStoredProc1.Parameters.Items[i].Value);
end; 
```

顺便说一句，调用 Open 然后 ExecProc 会导致问题；Open 返回一个结果集，ExecProc 然后将其清除，因为您正在第二次运行该过程而没有预期的结果集。我也不认为你需要Parameters.Refresh，但我不是100% 确定这一点。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:01:39.473

看看这个（只是用谷歌搜索）：

```
[http://www.scip.be/index.php?Page=ArticlesDelphi12&Lang=EN#Procedure][1] 
```

基本上，SQL Server 存储过程总是返回一个返回值，但它也可以创建一个结果集，您需要像从常规 select 语句返回的数据集一样对其进行处理。

# php - 如何在 JS 文件中使用 PHP（使用 Symfony）？

> ID：927795
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T19:45:32.813
> 
>         
> 
> 标签：php, javascript, symfony1, helper

我发现了这个：
 [http ://www.symfony-zone.com/wordpress/2008/12/13/use-routing-to-server-localized-and-dynamic-javascript/](http://www.symfony-zone.com/wordpress/2008/12/13/use-routing-to-server-localized-and-dynamic-javascript/)

但我看到它已经通过**use_dynamic_javascript()** AssetHelper 内置到 Symfony 中。

不过，我找不到任何使用此帮助程序的文档。任何示例，链接或任何帮助？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-21T19:36:02.857

我最终使用了[这种](http://www.symfony-zone.com/wordpress/2008/12/13/use-routing-to-server-localized-and-dynamic-javascript/)方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-01-29T15:23:39.530

也许这可以帮助：[howto use use_dynamic_javascript helper](http://goodies.lemonsoftware.eu/php:dynamicjs)

# linux - SVN 检出文件夹的内容，而不是文件夹本身

> ID：927806
> 
>         
> 
> 赞同：144
> 
>         
> 
> 时间：2009-05-29T19:48:14.477
> 
>         
> 
> 标签：linux, svn, svn-checkout

我对linux和svn相当陌生。我正在尝试使用此命令（在 public_html 中）将项目的主干文件夹检出到我的 public_html 目录中：

```
svn checkout file:///home/landonwinters/svn/waterproject/trunk 
```

waterproject 目录包含解压drupal 基本安装的文件。

它检查得很好，除了所有文件都在`public_html/trunk`而不是仅仅在`public_html`.

我不知道将主干的所有内容移动到 public_html 和 rm 主干的命令，但我想我可以相对容易地弄清楚这一点。我只想知道我是否可以只检查文件夹的内容，而不需要文件夹本身。

* * *

## 回答 #1

> 赞同：282
> 
>             
> 
> 时间：2009-05-29T19:53:31.173

只需添加一个`.`：

```
svn checkout file:///home/landonwinters/svn/waterproject/trunk . 
```

这意味着：签出到当前目录。

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2009-05-29T19:54:59.937

```
svn co svn://path destination 
```

要指定当前目录，请使用“。” 对于您的目标目录：

```
svn checkout file:///home/landonwinters/svn/waterproject/trunk . 
```

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T19:55:22.807

在命令行上提供目录：

```
svn checkout file:///home/landonwinters/svn/waterproject/trunk public_html 
```

* * *

## 回答 #4

> 赞同：10
> 
>             
> 
> 时间：2011-09-12T09:59:39.283

只需在命令行中添加目录：

```
svn checkout svn://192.168.1.1/projectname/ target-directory/ 
```

# java - 如何在 Java 中检测 SQL 表的存在？

> ID：927807
> 
>         
> 
> 赞同：36
> 
>         
> 
> 时间：2009-05-29T19:48:19.453
> 
>         
> 
> 标签：java, sql, database

如何在 Java 中检测给定 SQL 数据库中是否存在某个表？

* * *

## 回答 #1

> 赞同：42
> 
>             
> 
> 时间：2009-05-29T19:56:22.400

您可以使用[DatabaseMetaData.getTables()](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/DatabaseMetaData.html#getTables(java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String[]))获取有关现有表的信息。

此方法透明地工作并且独立于数据库引擎。我认为它在幕后查询信息模式表。

**编辑：**

这是[一个打印所有现有表名的示例](http://www.java2s.com/Code/JavaAPI/java.sql/DatabaseMetaDatagetTablesStringcatalogStringschemaPatternStringtableNamePatternStringtypes.htm)。

```
DatabaseMetaData md = connection.getMetaData();
ResultSet rs = md.getTables(null, null, "%", null);
while (rs.next()) {
  System.out.println(rs.getString(3));
} 
```

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-05-29T19:57:08.763

使用`java.sql.DatabaseMetaData.getTables(null, null, YOUR_TABLE, null)`. 如果表存在，您将获得`ResultSet`一条记录。

请参阅[DatabaseMetaData.getTables](http://java.sun.com/j2se/1.4.2/docs/api/java/sql/DatabaseMetaData.html#getTables(java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String[]))

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-31T08:22:37.317

对于所有符合 ANSI 的数据库：（mySQL、SQL Server 2005/2008、Oracle、PostgreSQL、SQLLite，也许还有其他）

```
select 1 from information_schema.tables where table_name = @tableName 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:53:50.313

这不是特定于语言的问题，而是特定于数据库的问题。您将查询数据库中的元数据以了解该特定对象的存在。

例如在 SQL Server 中：

```
SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[table]')
   AND type in (N'U') 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:53:57.273

编写一个查询将列出表的表/视图的查询（这取决于数据库供应商）。从 Java 调用它。

谷歌搜索[information_schema.tables](http://www.google.co.uk/search?hl=en&q=information_schema.tables&btnG=Search&meta=)会有很大帮助。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:54:04.637

根据数据库，您可以执行（MySQL）

```
SHOW TABLES 
```

或（甲骨文）

```
SELECT * FROM user_objects WHERE object_type = 'TABLE' 
```

或 SQL Server 的另一件事。循环浏览 MySQL 的结果或进一步过滤 Oracle 的结果。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:54:13.777

为什么不直接查看它是否在 sysobjects 中（对于 SQL Server）？

```
SELECT [name] FROM [sysobjects] WHERE type = 'U' AND [name] = 'TableName' 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T19:56:23.850

有一个 JDBC 功能，独立于数据库供应商 - 请参阅 [java.sql.DatabaseMetaData#g​​etTables()][1]

[您可以通过调用java.sql.Connection#getMetaData()](http://java.sun.com/javase/6/docs/api/java/sql/Connection.html#getMetaData())来获取 DatabaseMetaData 实例

[1]： http: [//java.sun.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getTables](http://java.sun.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getTables(java.lang.String) (java.lang.String, java.lang.String, java.lang.String, java.lang.String[])

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2019-11-16T01:39:00.547

这对我有用`jdbc:derby`：

```
//Create Staff table if it does not exist yet
String tableName = "STAFF";
boolean exists = conn.getMetaData().getTables(null, null, tableName, null).next();
if(!exists){
    s = conn.createStatement();
    s.execute("create table staff(lastname varchar(30), firstname varchar(30), position varchar(20),salary double,age int)");
    System.out.println("Created table " + tableName);
} 
```

请注意，`tableName`必须全部大写。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:04:58.687

对于 MS 访问：

```
Select Count(*) From MSysObjects 
Where type=1 And name='your_table_name_here' 
```

# .net - 如何使用 System.Net.WebRequest 访问受 .htaccess 保护的页面？

> ID：927816
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T19:51:08.447
> 
>         
> 
> 标签：.net, security, apache

我试图弄清楚当 Apache 服务器具有保护访问权限的 .htaccess 文件时如何使用 System.Net.WebRequest 类发送我的凭据。它似乎与 Credentials 属性有关（想象一下！），但我不确定如何创建正确的 ICredentials 对象。示例代码 = 接受的答案。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:03:22.573

```
System.Net.CredentialCache aCredentialCache = new System.Net.CredentialCache();
aCredentialCache.Add(new Uri("www.yoursite.com"), "Basic", new System.Net.NetworkCredential("User", "Password"));

System.Net.WebRequest aRequest = System.Net.WebRequest.Create("www.yoursite.com");
aRequest.Credentials = aCredentialCache; 
```

# sql-server-2005 - Openquery 比直接查询链接表快得多

> ID：927820
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T19:53:00.440
> 
>         
> 
> 标签：sql-server-2005, oracle, linked-server

试图弄清楚为什么两者之间存在如此显着的差异

`select * from linkedserver..tablename` 

和

`select * from openquery(linkedserver, select * from tablename)`.  

4 分钟对 13 秒。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2010-05-12T15:42:48.293

OPENQUERY 连接到目标服务器并在该服务器上运行查询并返回结果集。然而，我相信链接服务器查询是在本地服务器上执行的，并通过连接运行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-31T05:38:16.540

Openquery 直接连接到目标服务器。尽管说了 RDBMS，但您没有说与数据通信的另一种方式是什么。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-01T19:50:50.180

你知道它是否试图在链接服务器上征集分布式事务吗？如果您在进行调用时观察 Oracle 的 Trace 输出，您应该能够看到发生的请求的差异。IIRC，标准链接查询将以不同于 OPENQUERY 调用的方式从 oracle 元数据中请求模式信息。我不确切知道为什么会发生这种情况，但我过去遇到过类似的问题，通过使用 OPENQUERY 已解决。

# asp.net - 使用 sp_columns（或 INFORMATION_SCHEMA.Columns）结果填充 ParameterCollection

> ID：927837
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:55:52.103
> 
>         
> 
> 标签：asp.net, sql-server-2005, data-binding, parameters

我想根据`execute sp_columns MyTableName`或的结果构建一个 ParameterCollection 对象`SELECT * FROM INFORMATION_SCHEMA.Columns WHERE TABLE_NAME = 'MyTableName'`。

我遇到的问题是为每个 Parameter 分配适当的数据类型......我不确定如何从上述两个查询中的任何一个收集该信息并将其转换为 a `System.Data.DbType`or `System.TypeCode`。

任何帮助是极大的赞赏。

链接：[MSDN：sp_columns](http://msdn.microsoft.com/en-us/library/ms176077.aspx)，[MSDN：Information Schema.Columns](http://msdn.microsoft.com/en-us/library/ms188348.aspx)

**编辑：**我想我正在寻找的是类似于`Type.GetType("TypeName")`接受 SQL 数据类型的功能。例如，`DbType.GetType("int")`或`DbType.GetType("varchar")`。

**编辑：**来自答案的链接：[MSDN：Enum.Parse 方法](http://msdn.microsoft.com/en-us/library/kxydatf9.aspx)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T21:05:28.733

这实际上很容易做到:-) SqlDbType 是一个枚举，并且 Enum 类上有一个很好的静态函数，它可以完成您正在寻找的内容：

```
 private  SqlDbType ConvertType(string typeName)
 {
      return (SqlDbType)Enum.Parse(typeof(SqlDbType), typeName, true);
 } 
```

有了这个，您应该可以轻松地将 INFORMATION_SCHEMA 查询的输出转换为 SqlParameters 集合。

# gwt - GWT Void 远程服务似乎无缘无故失败

> ID：927841
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T19:56:33.133
> 
>         
> 
> 标签：gwt, gwt-rpc

我正在处理一个 GWT 项目，并且有几个无效的远程服务似乎执行得很好，但在客户端，最终触发了该`onFailure()`方法。任何地方都不会抛出异常，并且在后端观察到预期的行为。我不知道可能出了什么问题。以下是相关代码：

接口和实现...

```
@RemoteServiceRelativePath("DeleteSearchService")
public interface DeleteSearchService extends RemoteService {
    /**
     * Utility class for simplifying access to the instance of async service.
     */
    public static class Util {
        private static DeleteSearchServiceAsync instance;
        public static DeleteSearchServiceAsync getInstance(){
            if (instance == null) {
                instance = GWT.create(DeleteSearchService.class);
            }
            return instance;
        }
    }

    public void delete(SearchBean search);
}

public interface DeleteSearchServiceAsync {
    public void delete(SearchBean bean, AsyncCallback<Void> callback);
}

public class DeleteSearchServiceImpl extends RemoteServiceServlet implements DeleteSearchService {

    private static final long serialVersionUID = 1L;

    @Override
    public void delete(SearchBean search) {
        try {

            Connection conn = SQLAccess.getConnection();
            String sql = "DELETE FROM `searches` WHERE `id`=?";

            PreparedStatement ps = conn.prepareStatement(sql);
            ps.setInt(1, search.getSearchId());

            ps.execute();

            sql = "DELETE FROM `searchsourcemap` WHERE `search-id` = ?";

            ps = conn.prepareStatement(sql);
            ps.setInt(1, search.getSearchId());

            ps.execute();

            return;

        } catch (Exception e) {
            // TODO Log error
            e.printStackTrace();
        }
    }
} 
```

调用代码...

```
private class DeleteListener implements ClickListener {
        public void onClick(Widget sender) {
            DeleteSearchServiceAsync dss = DeleteSearchService.Util.getInstance();

            SearchBean bean = buildBeanFromGUI();

            dss.delete(bean, new AsyncCallback<Void>(){

                //@Override
                public void onFailure(Throwable caught) {
                    // TODO log
                    SearchNotDeleted snd = new SearchNotDeleted();
                    snd.show();
                }

                //@Override
                public void onSuccess(Void result) {
                    SearchDeleted sd = new SearchDeleted();
                    sd.show();
                    searchDef.getParent().removeFromParent();                   
                }

            });
        }
    } 
```

我知道我发布了 500 行代码是个混蛋，但我从昨天开始就一直盯着它看，不知道我哪里出错了。也许第二双眼睛会有所帮助......

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:39:49.317

LGTM 恐怕。

您使用的是托管模式还是成熟的浏览器？您可以尝试切换，看看是否有帮助。

此外，它可能有助于倾听`//TODO`并执行`GWT.log`何时`onFailure`被调用。

# c# - 如何在 C# 中调用 Windows 中的屏幕保护程序？

> ID：927843
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T19:57:22.617
> 
>         
> 
> 标签：c#, .net, windows, managed, screensaver

如果在 Windows 环境中定义了用户的屏幕保护程序，我想调用它。

我知道它可以使用纯 C++ 代码来完成（然后在 C# 中的包装非常简单），如此处所建议[的](http://bobmoore.mvps.org/Win32/w32tip22.htm)。

不过，出于好奇，我想知道这样的任务是否可以通过使用点网框架（2.0 版及更高版本）的纯托管代码来完成，无需 p/invoke 并且无需访问 C++ 端（反过来，可以很容易使用 Windows API）。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:27:43.100

我有一个想法，我不确定这会持续多久，所以我认为你需要进行一些研究，但希望它足以让你开始。

屏幕保护程序只是一个可执行文件，注册表将这个可执行文件的位置存储在`HKCU\Control Panel\Desktop\SCRNSAVE.EXE`

在我的 Vista 副本上，这对我有用：

```
RegistryKey screenSaverKey = Registry.CurrentUser.OpenSubKey(@"Control Panel\Desktop");
if (screenSaverKey != null)
{
    string screenSaverFilePath = screenSaverKey.GetValue("SCRNSAVE.EXE", string.Empty).ToString();
    if (!string.IsNullOrEmpty(screenSaverFilePath) && File.Exists(screenSaverFilePath))
    {
        Process screenSaverProcess = Process.Start(new ProcessStartInfo(screenSaverFilePath, "/s"));  // "/s" for full-screen mode
        screenSaverProcess.WaitForExit();  // Wait for the screensaver to be dismissed by the user
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:05:21.743

我认为拥有这样做的.Net 库函数是极不可能的——我不知道。快速搜索返回了此代码项目[教程](http://www.codeproject.com/KB/cs/ScreenSaverControl.aspx)，其中包含您在问题中提到的托管包装器的示例。

P/invoke 的存在使您能够访问特定于操作系统的功能，其中屏幕保护程序就是一个示例。  

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:05:26.313

我不确定您是否可以使用完全托管的代码来执行此操作。

这使用 Windows API，但仍然非常简单：[从 C# Windows 窗体启动系统屏幕保护程序](https://stackoverflow.com/questions/267728/launch-system-screensaver-from-c-windows-form)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2016-02-03T19:38:20.413

在任何版本的Windows上工作...

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace HQ.Util.Unmanaged
{
    public class ScreenSaverHelper
    {
        [DllImport("User32.dll")]
        public static extern int SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

        [DllImport("user32.dll", EntryPoint = "GetDesktopWindow")]
        private static extern IntPtr GetDesktopWindow();

        // Signatures for unmanaged calls
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern bool SystemParametersInfo(int uAction, int uParam, ref int lpvParam, int flags);

        // Constants
        private const int SPI_GETSCREENSAVERACTIVE = 16;
        private const int SPI_SETSCREENSAVERACTIVE = 17;
        private const int SPI_GETSCREENSAVERTIMEOUT = 14;
        private const int SPI_SETSCREENSAVERTIMEOUT = 15;
        private const int SPI_GETSCREENSAVERRUNNING = 114;
        private const int SPIF_SENDWININICHANGE = 2;

        private const uint DESKTOP_WRITEOBJECTS = 0x0080;
        private const uint DESKTOP_READOBJECTS = 0x0001;
        private const int WM_CLOSE = 16;

        public const uint WM_SYSCOMMAND = 0x112;
        public const uint SC_SCREENSAVE = 0xF140;
        public enum SpecialHandles
        {
            HWND_DESKTOP = 0x0,
            HWND_BROADCAST = 0xFFFF
        }
        public static void TurnScreenSaver(bool turnOn = true)
        {
            // Does not work on Windows 7
            // int nullVar = 0;
            // SystemParametersInfo(SPI_SETSCREENSAVERACTIVE, 1, ref nullVar, SPIF_SENDWININICHANGE);

            // Does not work on Windows 7, can't broadcast. Also not needed.
            // SendMessage(new IntPtr((int) SpecialHandles.HWND_BROADCAST), WM_SYSCOMMAND, SC_SCREENSAVE, 0);

            SendMessage(GetDesktopWindow(), WM_SYSCOMMAND, (IntPtr)SC_SCREENSAVE, (IntPtr)0);
        }
    }
} 
```

# .net - .Net 上是否有 URL 验证器？

> ID：927847
> 
>         
> 
> 赞同：45
> 
>         
> 
> 时间：2009-05-29T19:59:34.827
> 
>         
> 
> 标签：.net, asp.net, asp.net-mvc, validation, url

有没有一种方法可以验证 .Net、ASP.Net 或 ASP.Net MVC 中的 URL？

* * *

## 回答 #1

> 赞同：49
> 
>             
> 
> 时间：2009-05-29T20:08:41.563

您可以使用[`Uri.TryCreate`](http://msdn.microsoft.com/en-us/library/system.uri.trycreate.aspx)来验证 URL：

```
public bool IsValidUri(string uri)
{
    Uri validatedUri;
    return Uri.TryCreate(uri, UriKind.RelativeOrAbsolute, out validatedUri);
} 
```

评论建议`TryCreate`只需将异常处理向下移动一级。但是，我检查了源代码，发现并非如此。里面没有try/catch `TryCreate`，它使用了一个不应该抛出的自定义解析器。

* * *

## 回答 #2

> 赞同：46
> 
>             
> 
> 时间：2013-05-03T09:25:37.753

到目前为止提供的答案并未检查方案，允许各种不需要的输入，这可能使您容易受到 javascript 注入的影响（请参阅 TheCloudlessSky 的评论）。

URI 只是对象的唯一标识。“C:\Test”是一个有效的 URI。

在我的项目中，我使用了以下代码：

```
/// <summary>
/// Validates a URL.
/// </summary>
/// <param name="url"></param>
/// <returns></returns>
private bool ValidateUrl(string url)
{
    Uri validatedUri;

    if (Uri.TryCreate(url, UriKind.Absolute, out Uri validatedUri)) //.NET URI validation.
    {
        //If true: validatedUri contains a valid Uri. Check for the scheme in addition.
        return (validatedUri.Scheme == Uri.UriSchemeHttp || validatedUri.Scheme == Uri.UriSchemeHttps);
    }
    return false;
} 
```

定义您将允许的方案并相应地更改代码。

* * *

## 回答 #3

> 赞同：20
> 
>             
> 
> 时间：2012-02-21T22:24:59.383

您可以使用 Uri.IsWellFormedUriString，无需为此创建自己的函数：

```
public static bool IsWellFormedUriString(string uriString, uriKind uriKind); 
```

uriKind 可以在哪里：

```
UriKind.RelativeOrAbsolute 
UriKind.Absolute
UriKind.Relative 
```

有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/library/system.uri.iswellformeduristring.aspx](http://msdn.microsoft.com/en-us/library/system.uri.iswellformeduristring.aspx)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2021-02-25T17:33:36.377

如果您需要 Arjan 的 VB.Net 中的漂亮代码

```
 'Validates a URL.
    Function ValidateUrl(url As String) As Boolean
        Dim validatedUri As Uri = Nothing
        If (Uri.TryCreate(url, UriKind.Absolute, validatedUri)) Then
            Return (validatedUri.Scheme = Uri.UriSchemeHttp Or validatedUri.Scheme = Uri.UriSchemeHttps)
        End If
        Return False
    End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:05:39.307

比使用 try/catch 功能更快的方法（可能）是使用 Regex。如果您必须验证 1000 多个捕获异常的 URL 会很慢。

这是[示例正则表达式的链接](http://regexlib.com/REDetails.aspx?regexp_id=1854)- 使用 Google 查找更多信息。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T20:02:47.083

```
static bool IsValidUri(string urlString) {
   try {
      new Uri(urlString);
      return true;
   } catch {
      return false;
   }
} 
```

# deployment - 包装应用

> ID：927851
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:01:17.943
> 
>         
> 
> 标签：deployment

我们有一个 Windows 应用程序，我们使用 Wise 进行部署。最近我们切换到 InstallAware，虽然它有一些优点，但我们也面临一些问题。有人可以推荐另一个部署和打包应用程序吗？我们是一家小公司，我们没有专门的打包人员等。我们的包还包括 SQL 服务器快速安装，我们希望像 IA 中那样简单。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:06:15.733

[NSIS](http://nsis.sourceforge.net/)或[InnoSetup](http://www.jrsoftware.org/isinfo.php)怎么样？它们都被广泛使用，而且并不难使用。（如果你选择InnoSetup，还要下载ISTool，这比手动编写脚本文件要容易得多。）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:19:46.020

我们已经多次使用[NSIS ，既用于完整的常规桌面安装程序，也用于小型、静默安装补丁。](http://nsis.sourceforge.net/)编写一个基本的安装程序很容易，特别是如果您使用[HM NIS Edit](http://hmne.sourceforge.net/)，它充当 NSIS 的向导和 IDE。因为它是可编写脚本的，所以您将能够检查是否已经安装了 SQL Server Express - 如果没有，它可以作为安装程序过程的一部分进行安装。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:04:43.477

除了 Windows 安装程序和 Visual Studio 附带的安装项目外，我从未使用过任何东西。您是否有任何不寻常的要求阻止您这样做？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2014-05-13T07:32:54.873

我假设您的要求如下，您正在使用 wise package studio 创建\自定义应用程序来创建 MSI，这些 msi 包将部署或安装到您的环境中。

我的问题是：你们公司有多少台台式机\笔记本电脑（基础设施）

根据我的假设解决您的问题：

目前 Admistudio 是替代 Wise 的最佳产品，您可以使用 Installshield repackager 来创建或自定义应用程序。Install anyware 用于自定义 Dll 文件（构建和发布方法）并在该构建文件中创建自定义操作并将其构建到 MSI

Installshield Repackager 用于从 Exe 文件创建 MSI 并使用转换文件自定义现有 MSI（无需修改现有 MSI，我们可以将 MST 文件创建为 MSI 并对 MST 文件执行自定义，部署时将应用相同的文件。）

如果您需要进一步的帮助，请告诉我。

# unit-testing - 困惑：遗漏与单元测试相同的功能测试？

> ID：927857
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-05-29T20:03:16.287
> 
>         
> 
> 标签：unit-testing, functional-testing

我正在努力弄清楚应该从功能测试中排除什么（在我的例子中，使用 Rails，但我猜框架可能无关紧要）。

我的印象是，我不应该为单元测试中捕获的东西使用功能测试——例如检查一个字段不能有太多字符，或者一个字段不能为空。如果是这种情况，那么肯定应该使用功能测试来测试哪些意外事件，和/或让其他人只进行单元测试的经验法则是什么？

还是这种印象一开始就不正确？

我已经看过
[这个](https://stackoverflow.com/questions/182325/why-are-functional-tests-not-enough-what-do-unit-tests-offer)
和 
[这个](https://stackoverflow.com/questions/556006/do-you-need-to-do-unit-and-integration-testing-if-you-already-do-functional-testi)
，但我仍然不知所措。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T20:15:26.510

功能测试：它是否做**营销/可用性/客户签署**的事情？即，如果您的规范明确指出邮政编码文本框只允许有效的美国邮政编码，那么您可能应该在功能测试中对其进行测试。

单元测试：它是否按照**开发人员的预期**进行？在这些测试中，您应该使用*测试替身*将代码与依赖项隔离开来。

所以是的，会有某种重叠。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:28:21.027

我会通过功能测试“突飞猛进”，而不用担心涵盖所有内容，而是专注于单元测试。

原因：

*   功能测试很慢

*   功能测试难以编写和维护

*   除了单元测试之外，功能测试只能捕获两个额外的项目：

    *   图形用户界面错误

    *   跨层错配

总而言之，我发现两次覆盖所有内容并没有回报。

# asp.net - 嵌套字典到嵌套中继器asp.net c#

> ID：927859
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T20:03:20.343
> 
>         
> 
> 标签：asp.net, dictionary, nested, repeater

我正在制作一个 asp.page，它将显示有关公司资产的分层信息。

为了获取数据，我使用了 lambda 表达式：

```
 FASAssetInfoDataContext fasInfo = new FASAssetInfoDataContext();
        var data = from g in fasInfo.Asset_Informations
                          where g.Department.Substring(0, 3) == p
                          select g;
        Dictionary<string, Dictionary<string, List<info>>> branch = data.GroupBy(e => e.Location)
            .ToDictionary(g => g.Key,
            g => g.GroupBy(gl => gl.G_L_Asset_Acct_No)
                .ToDictionary(gl => gl.Key,
                gl => gl.Select(s => new info
                {
                    acqDate = s.Acquisition_Date,
                    asstNo = s.Co_Asset_Number,
                    classInfo = s.Class,
                    description = s.Description,
                    mfgSerialNo = s.Mfg_Serial_No,
                    deprThisRun = s.Depr_This_Run__Int_,
                    AcqValue = s.Acquisition_Value__Int_,
                    currentAccDepr = s.Current_Accum_Depr__Int_,
                    estLife = s.Est_Life__YYMM___Int_,
                    inServiceDate = s.Placed_In_Service_Date__Int_,
                    netBookValue = s.Current_Net_Book_Value__Int_,
                    oldAcqValue = s.Acquisition_Value__Tax_
                }).ToList())); 
```

所以我现在有一组嵌套的字典，最后有一个信息列表。我的问题是如何最好地在页面本身上显示这些信息？我可以达到第一级，但一直在努力让嵌套中继器正常运行。如果有更好的控制使用我全神贯注:)

谢谢，

马可

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-05-30T00:02:48.173

如果您确实需要使用嵌套中继器，这是可能的，但让它工作并不是特别明显。以下将起作用（为简洁起见）：

```
<asp:Repeater id="level1" OnItemDataBound="level1_ItemDataBound" ...>
  <ItemTemplate>
    <asp:Repeater id="level2" OnItemDataBound="level2_ItemDataBound" ...>
      <ItemTemplate>
        <asp:Repeater id="level3" OnItemDataBound="level3_ItemDataBound" ...>
        </asp:Repeater>
      </ItemTemplate>
    </asp:Repeater>
  </ItemTemplate>
</asp:Repeater> 
```

后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    Dictionary<string, Dictionary<string, List<info>>> branch = ...;
    level1.DataSource = branch;
    level1.DataBind();
}

protected void level1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    Dictionary<string, List<info>> data = (Dictionary<string, List<info>>)e.Item.DataItem;
    Repeater level2 = e.Item.FindControl("level2") as Repeater;
    level2.DataSource = data;
    level2.DataBind();
}

protected void level2_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    List<info> data = (List<info>)e.Item.DataItem;
    Repeater level3 = e.Item.FindControl("level3") as Repeater;
    level3.DataSource = data;
    level3.DataBind();
}

protected void level3_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
   // Bind properties from info elements in List<info> here
} 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-07-23T22:42:09.390

有一种更好的方法可以在没有任何 ItemDataBound 事件的情况下执行此操作。为简单起见，我们假设有两级中继器。

```
<asp:Repeater id="level1" >
   <ItemTemplate>
     <asp:Repeater id="level2" 
          DataSource='<%# ((System.Collections.Generic.KeyValuePair<string,System.Collections.Generic.List<string>>)Container.DataItem).Value %>' >
      <ItemTemplate>
           <%# Container.DataItem %>
       </ItemTemplate>
      </asp:Repeater>
   </ItemTemplate>
 </asp:Repeater> 
```

我通常更喜欢这种方式，因为出于某种原因我讨厌 ItemDataBound 事件:)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:05:13.117

asp：树视图？不确定它将如何处理嵌套数据集，但它旨在显示它。

# .net - 如何找到实现接口的类（.Net）

> ID：927861
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:03:46.113
> 
>         
> 
> 标签：.net, inheritance

我能找到的最接近这个问题的是：[Getting all types that implement an interface](https://stackoverflow.com/questions/26733/getting-all-types-that-implement-an-interface-with-c-3-5)

但那是在代码中使用的，要使用它，我必须更改代码，重新编译并运行。我想知道是否有一种更简单的方法来查找所有实现某个接口的类。

我似乎经常面临这个问题，以至于我正在寻找一些更简单/更通用的方法来找到我的答案。最近我想找出我可以使用哪些类来实现 ISet，对我来说哪个类并不重要，只需要一个用来创建实例。

所以我想知道是否有任何方法可以找到所有实现给定接口的类？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:06:40.147

使用[ReSharper](http://www.jetbrains.com/resharper/)，右键单击界面，转到实施，从它填充的列表中选择要查看的界面。

我认为没有办法以编程方式进行，但如果您只是指在 IDE 中，这是最简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:05:37.140

不，没有更简单的方法。我想这种方式很容易做到。只有三行。如果您需要连续多次执行此操作，您可以将结果缓存在列表或字典中（以防您想针对一组接口对其进行测试）。

如果您只需要作为工具，[Reflector](http://www.red-gate.com/products/reflector/)就可以了。

# python - 如何在 Linux 机器上使用 Python 获取文件夹的所有者和组？

> ID：927866
> 
>         
> 
> 赞同：24
> 
>         
> 
> 时间：2009-05-29T20:04:54.740
> 
>         
> 
> 标签：python, linux, directory, owner

如何在 Linux 下使用 Python 获取目录的所有者和组 ID？

* * *

## 回答 #1

> 赞同：42
> 
>             
> 
> 时间：2009-05-29T20:10:40.077

用于[`os.stat()`](http://docs.python.org/library/os.html#os.stat)获取文件的uid和gid。然后，使用[`pwd.getpwuid()`](http://docs.python.org/library/pwd.html#pwd.getpwuid)和[`grp.getgrgid()`](http://docs.python.org/library/grp.html#grp.getgrgid)分别获取用户名和组名。

```
import grp
import pwd
import os

stat_info = os.stat('/path')
uid = stat_info.st_uid
gid = stat_info.st_gid
print uid, gid

user = pwd.getpwuid(uid)[0]
group = grp.getgrgid(gid)[0]
print user, group 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2016-04-11T10:38:07.940

从 Python 3.4.4 开始，模块`Path`类[`pathlib`](https://docs.python.org/3/library/pathlib.html#pathlib.Path.owner)为此提供了很好的语法：

```
from pathlib import Path
whatever = Path("relative/or/absolute/path/to_whatever")
if whatever.exists():
    print("Owner: %s" % whatever.owner())
    print("Group: %s" % whatever.group()) 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:13:19.323

使用[os.stat](http://docs.python.org/3.0/library/os.html#os.stat)：

```
>>> s = os.stat('.')
>>> s.st_uid
1000
>>> s.st_gid
1000 
```

`st_uid`是所有者的用户ID，`st_gid`是组ID。有关可以通过 获取的其他信息，请参阅链接文档`stat`。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:09:52.827

我倾向于使用[os.stat](http://docs.python.org/library/os.html#files-and-directories)：

> 在给定路径上执行 stat 系统调用。返回值是一个对象，其属性对应于stat结构的成员，即：st_mode（保护位），`st_ino`（inode编号），`st_dev`（设备），`st_nlink`（硬链接数），**`st_uid`（user id of owner），`st_gid`（group所有者的 ID）**，`st_size`（文件大小，以字节为单位），`st_atime`（最近访问`st_mtime`时间），（最近内容修改时间），`st_ctime`（平台相关；Unix 上最近元数据更改的时间，或创建时间视窗）

上面的链接中有一个示例`os.stat`。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:10:30.140

使用该`os.stat`功能。

# version-control - 懒人的源代码控制系统？

> ID：927874
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:06:08.887
> 
>         
> 
> 标签：version-control

我用过 CVS 和 SVN。我遇到的两个问题是，您必须使用记住这些操作的工具显式执行所有添加/删除/更新/移动等操作，以便可以提交它们。TortoiseSVN 之类的工具让生活更轻松，但没有我想的那么简单。IDE 集成也很好，但我不喜欢必须在 IDE 中做所有事情。我的问题是我会在不使用适当工具的情况下不小心进行更新或重命名文件夹，然后我的源代码就会变得混乱。

是否有一个简单的源代码控制工具可以让我在文件夹结构中随心所欲地工作，并允许我在完成后同步所有内容？

我意识到这会使传统源代码控制的某些功能变得不可能，但我会接受的。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:27:37.687

较新的分布式源代码控制系统，如[GIT](http://git-scm.com/)、[Bazaar](http://bazaar-vcs.org/)和[Mercurial](http://www.selenic.com/mercurial/wiki/)（又名：Hg）都倾向于更好地检测文件系统中所做的广泛更改，例如移动目录、重命名文件甚至替换文件系统的大块。

根据我的阅读，Bazaar 和 Mercurial 基本上是从头开始构建的，专门用于处理这种自由格式的编辑，特别是因为 SVN 对您的要求非常明确。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:11:08.423

[Dropbox](http://www.getdropbox.com/)是一个很好的版本控制风格的应用程序，需要一点设置和零维护。恢复到旧版本不如通常的源代码管理有效，它会跟踪您的*所有*更改（您无法选择是否提交）。

基本上，您在计算机上创建一个 Dropbox 文件夹，您保存的所有内容都会自动同步。它非常快（它会在几分钟内做出反应，而不是几小时），并且您可以获得一两个演出空间。

所以，你得到的控制更少，但它非常容易。我个人将它用于我的[密码安全](http://passwordsafe.sourceforge.net/)数据库和我的“待办事项”列表，因此我可以从任何计算机访问它们。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:12:50.103

即使您过去在使用 SVN 时遇到过一些问题。我仍然认为这是要走的路。VisualSVN 服务器提供了一个简单的界面来设置所有内容，并且有大量免费或低成本的工具可供使用。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:21:11.960

虽然这并不能回答问题本身，但我强烈建议您训练自己使用您选择的版本控制系统来处理所有问题。一旦使用 VC 系统成为一种习惯，就不会再不小心弄乱你的源文件夹了（当然，人为因素仍然存在），并且在明确工作的版本控制下，你会得到比任何自动更改的工具更好的日志-追踪。在 Windows 上，TortoiseSVN 是一个非常好的工具，它可以很容易地避免忽视 VC 系统。

（以使用 VC 系统训练自己做一个类比：如果你设法让自己使用触摸打字进行训练，那么你将不再知道没有它你是如何生活的。几年前当我决定这样做时发生在我身上至少我应该学它才能判断系统。我真的不明白我以前是怎么打字的。）

至于重命名问题，您可能需要查看 git。它可以在不使用 VC 系统本身的情况下处理重命名/移动。

# hibernate - 你问什么 Hibernate 面试问题？

> ID：927880
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T20:08:17.010
> 
>         
> 
> 标签：hibernate

我们正在采访新开发人员，寻找具有一些休眠经验的人。我们正在尝试整理一个问题列表来测试受访者的休眠知识。我们基本上是在使用测试来验证是否有人很好地掌握了 Hibernate 的工作原理。似乎这些天人们会在他们的简历上列出任何东西。你会问什么问题？

任何提示都会有所帮助！

非常感谢，丹尼尔

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T21:28:59.170

1.  Hibernate 解决了什么问题？

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-08-18T14:26:49.893

这里有三个关于hibernate的小测验，可以帮助你筛选候选人

[Hibernate 面试题](http://www.skill-guru.com/skill/login/fetchRelatedTestsPosts.faces?tag=hibernate)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-30T02:36:29.237

让他们在面试时在 Hibernate 中编写一些 CRUD 代码。你会很快发现他们是否合格。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:20:34.830

1.  什么是休眠？

2.  Hibernate 如何处理映射文件中的多一关系？

3.  您如何维护 Hibernate 的映射文件？

4.  有哪些方法可以提高 Hibernate 的性能？

5.  在 Hibernate 中如何支持分页（在前端 App 端）？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-05T13:18:26.393

让他们向您解释 Hibernate 的不同缓存级别，他们理解这一点很重要。

# sql - 这个 Oracle SQL 语句有什么作用？

> ID：927883
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:08:50.050
> 
>         
> 
> 标签：sql, oracle

我正在将 MSSQL 脚本迁移到 Oracle SQL，但我无法弄清楚脚本中的一行在做什么。

我对 SQL 很陌生。

```
CREATE TABLE HA_BACKUP_PROCESSES 
(
    ID numeric (10, 0) NOT NULL , 
    PROCESS_ID numeric (10, 0) NOT NULL , 
    BACKUP_PROCESS_ID numeric (10, 0) NOT NULL , 
    CONSTRAINT HA_BCK_PROC_PK PRIMARY KEY (ID) 
        USING INDEX TABLESPACE userdata001 
) 
```

在上面的代码中，' `USING INDEX TABLESPACE userdata001`'语句是做什么的？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T20:11:39.797

此子句允许选择将在其中创建与 UNIQUE 或 PRIMARY KEY 约束相关联的索引的表空间。如果未指定，则使用 default_tablespace，如果 default_tablespace 为空字符串，则使用数据库的默认表空间

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:26:13.260

表空间只不过是数据文件和索引的逻辑容器。

设置 Oracle 实例时，您必须先定义表空间，然后才能创建数据文件。然后，当您创建表或索引时，您必须指定要在其中创建数据文件的表空间，或者接受默认表空间。  

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:28:52.943

它指示数据库将索引信息存储在名为“userdata001”的表空间中。

[可以在此处找到有用的解释](http://www.adp-gmbh.ch/ora/concepts/tablespaces.html)：

*表空间是 Oracle 数据库中的逻辑存储单元。这是合乎逻辑的，因为表空间在数据库所在机器的文件系统中是不可见的。反过来，一个表空间由至少一个数据文件组成，而这些数据文件又在物理上位于服务器的文件系统中。顺便说一句，一个数据文件恰好属于一个表空间。存储在 Oracle 数据库中的每个表、索引等都属于一个表空间。表空间在 Oracle 数据库和存储表或索引数据的文件系统之间建立了桥梁。* 

# web-applications - Web 应用程序或桌面应用程序，哪个更容易获利？

> ID：927884
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T20:09:29.550
> 
>         
> 
> 标签：web-applications, desktop-application

如果可以将一个想法实现为桌面应用程序和网络应用程序，您会采用哪种方式？

我在这里有点偏见，作为一个用户，我更喜欢桌面应用程序而不是网络应用程序，因为能够快速访问信息：无需打开浏览器，无需登录，响应速度更快，托盘集成，通知，全局热键等。作为开发人员，我也有更多开发桌面应用程序的经验。但作为 ISV，我必须担心不仅要丰富用户，还要丰富我自己 ;)

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-05-29T20:25:31.623

这实际上取决于您拥有什么样的应用程序以及您想用它做什么。

Web 应用程序主要具有以下优点：

*   **真正的平台独立性**——如果浏览器可用于该平台，您的应用程序将在其上运行。当然在实践中它并不那么简单，但与桌面应用程序相比，它本质上不是问题。

*   **轻松部署**- 将最新版本上传到服务器，等等 - 部署完成。这就是它所需要的。没有手动更新，没有下载，什么都没有

*   **全球可用性**- 浏览器 + 互联网连接 = 访问您的应用程序。

*   **保密**- 如果您认为这是一个优点。我的意思是您的大部分宝贵代码都保留在您的服务器上，您不必担心邪恶的人对您的东西进行逆向工程；）

*   **用户控制**-*您*决定谁可以访问您的服务，谁不能。无需担心软件盗版、序列号和所有讨厌的东西。

另一方面，您有以下问题：

*   **集成**- 您的应用程序运行在服务器上，实际上没有办法与本地应用程序（甚至文件）交互。例如，在 Web 应用程序和本地程序之间复制和粘贴实际上是不可行的。这当然还包括访问本地硬件，如 USB 加密狗，或任何你能想到的东西。

*   **连接**- 没有互联网，没有服务。有一些方法可以通过本地缓存等来缓解这个问题，但最重要的是，如果没有互联网连接，你就是 SOL。

*   **性能**——如果你的应用程序性能很重，那么让一万用户同时在你的服务器上运行它可能需要一个昂贵的服务器场。您可能不想将 SETI@home 实现为 Web 应用程序。

*   **GUI** - 现在你可以使用 Flash 和 JavaScript 制作令人惊叹的 GUI，但它仍然与真正的桌面 GUI 不同（立即想到浏览器和其他应用程序之间的拖放操作）。右键单击上下文菜单是一个经典问题。您是显示浏览器的菜单，还是尝试抑制它并显示您自己的菜单？这是一个失败/失败的情况。

*   **责任/总拥有成本**- 这是*您的*服务器，因此*您*必须为此付费并确保它运行顺畅并进行备份。桌面应用程序按“原样”交付，如果用户的硬盘崩溃，这不是您的问题。Web 应用程序在这里完全不同。

那么，这意味着什么？这一切都取决于。找出对您来说最重要的问题。

**编辑：**抱歉，我刚刚读到您专门询问了有关通过您的应用获利的问题。您也应该在问题的正文中提到这一点；）但我认为无论如何我都部分回答了，至少我尝试过。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T20:16:05.777

我想这取决于您计划如何将事物货币化。使用桌面应用程序，您将主要从付费购买中获得收入。使用网络应用程序，您始终可以按月收费（甚至根据访问级别收取分级费用），甚至可以支持带有广告的免费/试用版。

另外，为什么要将自己限制在其中之一？使用像 Adob​​e 的 AIR 这样的框架，让自己两全其美。

你的技能组合在哪里？如果您有大量构建桌面应用程序的经验并且对 Web 不太熟悉，请先使用桌面。如果您是 Web 开发人员，请先使用 Web。发挥自己的优势。

设计怎么样？知道任何可以为您设计 Web 应用程序的网页设计师，或者在桌面上吹出一些东西会更容易吗？

Web 的跨平台方面是否值得，或者您打算主要为 Windows、Mac 或 Linux 构建并且对此感到满意？

有很多考虑。发挥自己的优势。

编辑（2012 年 9 月）：似乎这篇文章在 3 年后仍然有一些流量。在这一点上，它已经过时了，并且没有考虑到移动设备之类的东西，我不知道。:-) YMMV！

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:15:37.150

在你的情况下，因为你的背景是桌面，我会这样做只是因为你可以更快地实现它，也可能以更好的方式实现它。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:14:19.790

这是一个权衡。

一方面，Web 应用程序允许您采用 SaaS 样式的费用，并允许更轻松的部署模型。另一方面，Web 应用程序需要以服务器和带宽成本的形式进行维护。

桌面应用程序允许更丰富的 UI，这可能会让您的用户更快乐，但更难以部署和更新。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:13:35.453

如果您希望通过您的应用程序赚钱，我会说基于 Web 的应用程序要容易得多，因为每个潜在客户都可以在您公开应用程序后立即访问它。桌面应用程序需要的供应链比我能想到的任何编程任务都要多得多。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:14:53.127

这完全取决于您的应用程序提供的功能。有些应用程序无法在 Web 上运行，因为它们需要本地 PC 数据，而这些数据不能从浏览器中获得。

从维护的角度来看，Web 应用程序肯定更容易维护（节省时间和成本），因为它只在一个地方运行（你的服务器，所以任何新版本都必须只到那里）并且测试它相当容易通过跨不同浏览器进行测试，可以实现不同的用户配置。使用桌面应用程序会更难做到这一点，因为每个用户都可以有不同的硬件/操作系统设置，这可能会导致各种问题（并且您可能很难在支持场景中复制它）。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:16:33.653

谷歌说网络应用程序是未来，他们可能是对的。Web 应用程序具有显着的最终用户优势，即本质上是跨平台的（在大多数情况下），并且不需要安装到将要使用它们的计算机上（同样，在大多数情况下）。当然，另一方面是它们将在*您的*计算机上运行，​​而不是在您的用户的计算机上运行，​​因此您将不得不在基础设施上花费一定数量的钱，而且可能比您花在上面的钱还要多分配。还有营销问题——你可能不会在它上面花更多的钱，但是当你不能在百思买的端盖上放一个盒子时，要宣传这个词要困难得多。

无论如何，如果您可以选择其中任何一个，我会调查托管和扩展您的应用程序的成本，如果不禁止盈利，我会说选择网络应用程序。如果你能很好地推销它，你将获得比使用桌面应用程序更大的用户群。

这无疑是一场激烈的讨论中的两分钱。:-)

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:19:32.370

我更喜欢网络，因为：

1) 跨平台 2) 您只需解决一次问题，从而降低支持成本 3) 您可以相当轻松地加入，甚至可以免费试用 4) 向所有客户推出新功能更容易

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T21:46:03.053

好吧，简单明了*，*它是网络，100%。在您的网站上粘贴广告大约需要 5 分钟。可能要长一点，让它看起来不错。

但这并不意味着您将在桌面上尽可能多地制作。但说真的，如果你说得简单，人们会编写脚本来制作带有广告的网站。他们赚了 100 美元，然后将网站关闭。他们每天这样做几次。没有办法在桌面上赚到这种快钱。

需要注意的是，在网络上你谈论的是少量的钱，除非你可以让网站受欢迎。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-07-15T07:31:19.143

我认为这真的取决于应用程序的类型。网络浏览器可以处理你想扔给它的任何东西吗？新的浏览器令人印象深刻，但仍然停留在 IE6 上的人不会高兴。另外，离线数据有多重要？Google Gears 是一个糟糕的解决方案。Safari 和 Firefox (3.5) 都对离线数据有很好的支持，但同样，使用旧浏览器的人无法充分利用它。（当然，您可以随时放弃对旧版浏览器的支持。）

网络上的主要缺点是您对用户的数据负责。网络上的主要优势是您会自动获得更广泛的受众。桌面应用程序的反向 - 更小的受众，但你的负担更轻。  

# html - 使用手工编辑的 HTML/CSS 或使用设计程序哪个更好？为什么？

> ID：927889
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T20:10:37.957
> 
>         
> 
> 标签：html, css, xhtml, web

对于设计网站，是自己学习 HTML/CSS 还是使用网页设计程序更好？为什么？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-29T20:23:06.700

在我作为 Web 开发人员的历史中，我曾在手动编码和 Dreamweaver 之间来回穿梭。

我最初是从手工编写 HTML 开始的。这是在表格布局为王的时代，编辑嵌套表格真的很头疼。再加上缺乏可视化隐藏元素的好工具，这很快就变成了一场噩梦。

我开始使用 Dreamweaver 主要是为了加快我的表格设计工作流程。然而，很快，当我开始制作没有服务器后端的静态网站时，Dreamweaver 的模板系统就成为了天赐之物。能够更新一个模板并让它在整个静态站点中传播将我的跨页面不一致减少到几乎为零。

最近，整个 web 2.0 的推动让我和几乎所有其他人重新回到了手动编码游戏中。我发现 Dreamweaver 并不真正适合兼容设计，因为它严重以表格为中心。我发现这些天我编写的大部分 HTML 都非常简单明了，几乎不需要编辑器。此外，我的所有开发现在又是动态的，因此不再需要静态 html 生成模板系统。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:14:31.850

为自己学习，这样您就可以弄清楚如何按照您希望的方式完成事情，而不必依赖某种程序来为您解决问题。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:16:59.440

就像技术中的其他任何事情一样，首先学习核心概念，然后使用工具将您掌握的东西自动化。通过这样做，您将更好地了解一切如何协同工作，并且您能够轻松判断何时出现问题。通过这种方式，您将不受任何一种设计工具的束缚，并且可以使用任何最有效的工具，因为您了解核心概念。

用理查德费曼的话来说，

> “我无法创造的东西，我不明白。”

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:15:59.130

它们确实有两个目的，其中任何一个都“更好”。

如果您学会手工操作，您将：

*   更好地控制正在发生的事情

*   减少无关代码

*   能够更轻松地维护您的代码

如果您使用程序，您将：

*   能够进行视觉设计

*   可能能够更快地设计

*   不必学习手工编写 CSS

这真的取决于你的目标是什么。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:15:46.353

我更喜欢手动编写 HTML/CSS，因为您对代码拥有最多的控制权。大多数设计程序会添加不需要的额外标记。即使是简单的 WYSIWYG JavaScript 编辑器也会添加额外的标记。虽然文件大小的差异不大，但随着时间的推移，额外的标记会增加。我还认为，当您知道代码的创建内容时，更容易维护代码。

此外，通过花时间手工完成，您将学到更多。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:16:07.617

就个人而言，如果可以的话，我总是使用具有自动完成功能的编辑器手动编辑我的 HTML/CSS，因为这总是让生活更轻松。在你开始依赖任何程序为你生成代码之前，你绝对应该尽可能多地学习一门语言，因为大多数时候你最终会修复它们给你的东西。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:16:13.827

我倾向于手动完成所有操作。

1.  我使用的是什么 IDE 或服务器端语言都没有关系。标记是标记。能够用手快速完成是很有价值的。

2.  通常情况下，您必须手动编辑一些标记。通过从头开始编写，您已经非常熟悉标记的结构。您不必花费任何时间将自己定位到设计器生成的标记。

3.  虽然不一定是规则，但我发现那些生活在设计器中的人在标记和代码工艺方面不那么敏锐。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T11:29:37.897

我喜欢手工编码，因为这样我可以保持代码干净整洁。无论如何，HTML 并不难。

如果您决定手动编写代码，您将需要一个支持语法高亮的编辑器，并且您需要尽可能频繁地验证您的代码以避免错误（无论如何这是一个好习惯）。这个 Firefox 扩展将大大简化您的工作：users.skynet.be/mgueury/mozilla/

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T02:24:13.663

我不会阅读回复，所以很可能有人已经说过了，但是哦，好吧。

首先，您应该始终手动写出您的 HTML / CSS。这样做的原因是，无论 HTML 编辑器多么先进，它都不会像它应该/应该的那样好。对于“好”的 html / css，您实际上最终会以与您所看到的顺序不同的顺序编写您的页面。

例如，显示如下的页面：

```
________________
|logo          |
|----menu------|
|..............|
|...content....|
|..............|
|....footer....|
---------------- 
```

“应该”实际上是这样流动的：

```
<h1>title of site</h1>
<div id="content">.....</div>
<ul id="menu">....</ul>
<div id="footer">...</div> 
```

如果您通过漂亮漂亮的 gui 进行操作，那么 HTML 编辑器只会让您大吃一惊。可能有利的是使用 Web Expression 2 或 Visual Studio 进行智能感知。它可能有助于加快（或减慢）你的学习速度。

如果您已经熟悉 HTML / CSS，我真的推荐[Transcending CSS Design 。](https://rads.stackoverflow.com/amzn/click/com/0321410971)否则，请先阅读 CSS 书籍，而不是 HTML 书籍。通过 CSS 进行样式设计将教你正确的语义 HTML（或者应该，无论如何）。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:14:57.527

我更喜欢手工的方法。这样你就知道你得到了什么。另外，我还没有找到一个生成不需要调整的 HTML/CSS 的编辑器，尤其是在您针对多个浏览器的情况下。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:15:44.560

用手做。使用设计程序往往会插入许多您并不真正需要的额外标记，这只会使您的学习能力复杂化。

如果您手动操作，您至少知道在哪里插入了什么以及为什么插入。此外，还有很多不错的网站可以引导您了解基础知识。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:17:09.160

IMO，您仍将学习使用 Dreamweaver 等网页设计程序，因为您必须查看源代码并使其符合您的确切需求，而且速度更快。但是手工做会让**你写得越多，你学到的东西就越多**，我同意 100%

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:20:08.810

这有点模糊。  

我认为“更好”（定性地）很大程度上取决于（1）设计师的能力，以及（2）应用程序的复杂性。  

关于“更好”（如“可取”）：使用应用程序可能是在所有情况下都无法拯救您的拐杖。了解如何“原始代码”html 和 css 对于理解应用程序的限制和解决这些限制非常有价值。仅出于这个原因，我建议知道如何手动完成，然后密切关注应用程序生成的输出，如果您选择使用一个。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T01:47:36.590

绝对最好的是当您**了解自己在做什么**时——您只能**通过手工编码来**做到这一点。

如果您不了解 HTML 或 CSS，并且您使用的是所见即所得的编辑器，那么您如何确定一切都是正确的？你不能！

如果您对 HTML 和 CSS 有很好的理解，为什么要使用 WYSIWYG 编辑器？它们使事情变得更加困难，因为您看不到代码，并且在您不知情的情况下插入了额外的标签和规则。

手工编码总是最好的。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T02:03:35.483

为什么要了解 xhtml/css ？

以下是一些原因：

*   尊重[语义](http://en.wikipedia.org/wiki/Semantic_HTML#Semantic_HTML)意义

*   [DOM 兼容](http://en.wikipedia.org/wiki/Standards-compliant)（你知道 javascript 的混乱）

*   [更容易维护](http://en.wikipedia.org/wiki/Software_maintenance)

*   [搜索引擎优化](http://en.wikipedia.org/wiki/Search_engine_optimization)

您仍然认为设计/集成网站需要更长的时间吗？

想想使用[vi](http://www.vim.org)，[eclipse](http://www.eclipse.org/)，[quanta](http://quanta.kdewebdev.org/)，[可能还有其他一些](http://en.wikipedia.org/wiki/List_of_HTML_editors)......

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T02:09:44.143

手动是显而易见的答案，因为您的网站/应用程序会更好。（另外，如果您使用 JavaScript，最好遍历您自己编写的文档的 DOM，而不是您必须事先检查的生成文档。）但这主要是因为当今存在的可视化工具确实糟透了（我在想 Dreamweaver）。绝对有可能创建一个*良好*的可视化编辑 (WYSIWYG) 程序，它实际上可以生成*良好的*HTML/CSS/JavaScript，但还没有任何接近的东西出现，所以现在手工编码要好得多。

# ruby - 在 JRuby/Rack 下运行 Ruby 脚本，就像它们是 CGI 一样

> ID：927892
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T20:11:05.083
> 
>         
> 
> 标签：ruby, servlets, cgi, jruby, rack

有没有办法映射 *.rb 文件以在 JRuby 下执行，并将输出像 CGI 一样发送到浏览器？基本上我正在寻找一个 JRuby CGI servlet。

理想情况下，我想在 web.xml 中定义一个 JRuby servlet，然后能够将 *.rb 文件放入 WEB-INF/ruby 并能够通过[http://servername/contextname/rubyprogram.rb](http://servername/contextname/rubyprogram.rb)调用它们和通过表单发布或作为 URL 的一部分将数据传递给 ruby​​ 程序。

编辑：我做了更多的研究，发现了 Sun 的项目 Phobos（将整个 Ruby 安装捆绑在一个 WAR 文件中）和 JRuby RACK。

有没有人能够设置一个轻巧简单的 Rack 安装来做到这一点？任何人都知道可以让我这样做的示例配置吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:31:29.723

我对 J2EE 不是很熟悉，但是您可以编写自己的 Java servlet，它将 Ruby 脚本名称作为参数并使用 JRuby 作为库来执行它。

JRuby 站点上有关于如何从 Java 程序运行 Ruby 脚本的示例。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-07-06T17:27:12.607

你应该看看[莺](http://kenai.com/projects/warbler/pages/Home)。它是一个 gem，可让您将 Ruby 应用程序打包为 WAR 文件并在 servlet 容器中运行它（在[JRuby-Rack](http://kenai.com/projects/jruby-rack/pages/Home)的帮助下）。

您还应该查看[Glassfish](http://wiki.glassfish.java.net/Wiki.jsp?page=JRuby) gem，它包含 Glassfish 应用服务器的精简版本，它可以轻松加载与 Rack 兼容的应用程序并在 JRuby 中运行它。

这里有一个关于如何在 Glassfish 中运行 JRuby 应用程序的截屏视频：http: [//netbeans.tv/technologies/First-JRuby-app-in-GlassFish-86/](http://netbeans.tv/technologies/First-JRuby-app-in-GlassFish-86/)

在这里可以找到大量其他资源：http:
 [//kenai.com/projects/jruby/pages/WalkthroughsAndTutorials](http://kenai.com/projects/jruby/pages/WalkthroughsAndTutorials)

# 64-bit - 在未来的硬件上编程？

> ID：927894
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T20:11:15.723
> 
>         
> 
> 标签：64-bit, hardware, multicore

我想为未来的硬件练习编程代码。这些是什么？想到的两个主要事物是 64 位和多核。我还注意到缓存很重要，GPU 有自己的技术，但现在我对任何图形编程都不感兴趣。

我还应该知道什么？

-edit- 我知道现在有很多这样的，但很快所有的 cpu 都将是多核的，线程将变得更加重要。我考虑了字节序（大字节序与小字节序），但发现这并不重要，并且已经有一个大字节序 CPU 可供测试。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T20:17:46.677

如果您想深入了解完全支持 64 位的“主流”操作系统，我建议您开始针对 Mac OS X“Snow Leopard”（10.6 的代号）测试版进行编码。其中一项重大改进是 Grand Central，它是开发人员为多核系统编写代码的“设施”。Grand Central 不仅应该在核心之间分配工作负载，还应该将工作负载分配给 GPU。

同样重要的是智能设备的爆炸式增长，如 iPhone、Android 等。我坚信一些即将到来的所谓“上网本”将依赖于 Android 和 iPhone OS 等操作系统，因此知道如何针对它们进行编码SDK，并且知道如何为移动设备优化代码非常重要（例如优化性能图形或其他，电池使用）。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T20:19:10.093

我对未来的建议:)

*   英伟达[CUDA](http://www.nvidia.com/object/cuda_home.html)

*   英伟达[Tegra](http://www.nvidia.com/object/product_tegra_apx_us.html)

或者你可以专注于光线追踪。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:45:24.440

我无法预测未来，但要研究的一个方面是类似于 PS3 中使用的[CELL 处理器](http://en.wikipedia.org/wiki/Cell_processor)，其中没有许多相同的通用内核，只有一个（虽然能够对称多线程）加上许多内核更具体的目的。

> 在一个简单的分析中，Cell 处理器可以分为四个组件：外部输入和输出结构、称为电源处理元件 (PPE) 的主处理器（一个双向同步多线程 Power ISA v.2.03 兼容内核）、八个完全- 称为协同处理元件或 SPE 的功能性协处理器，以及连接 PPE、输入/输出元件和 SPE 的专用高带宽循环数据总线，称为元件互连总线或 EIB。

[CUDA](http://en.wikipedia.org/wiki/CUDA)和[OpenCL](http://en.wikipedia.org/wiki/OpenCL)的相似之处在于您将通用代码和高性能计算分成单独的部分，这些部分可以在不同的硬件和语言/api 上运行。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:16:28.770

64 位和多核是现在而不是未来。

关于未来：量子计算或类似的东西？

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:40:05.183

学习[OpenCL](http://en.wikipedia.org/wiki/OpenCL)怎么样？它是一种基于 C 的大规模并行处理语言。它类似于 nVidia 的[CUDA](http://en.wikipedia.org/wiki/CUDA)，但与供应商无关。目前还没有主要的实现，但预计很快就会看到一些。

至于64位，不用太担心。除非您正在做非常低级的东西（内核），否则编程不会有任何不同。Java 和 .NET 等更高级别的框架允许您在 32 位和 64 位机器上运行代码。甚至 C/C++ 也允许您这样做（但不是那么透明）。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:38:50.677

我同意 Oli 的回答 (+1) 并补充说，除了 64 位环境之外，您还可以查看多核环境。该行业正在接近原始速度改进周期的结束。但是我们看到越来越多的多核 CPU。所以并行或并发编程——这很难——很快就变得非常需要。

你怎么能为此做好准备和实践呢？我一直在问自己同样的问题。因此，在我看来，[ML](http://www.smlnj.org/)、[Haskell](http://haskell.org/)、[LISP](http://en.wikipedia.org/wiki/Lisp_programming_language)、[Arc](http://arclanguage.org/)、[Scheme](http://groups.csail.mit.edu/mac/projects/scheme/)等函数式语言是一个很好的起点，因为真正的函数式语言通常没有副作用，因此非常“可并行化”。  [Erlang](http://erlang.org/)是另一种有趣的语言。

我发现的其他有趣的发展包括

*   奇[点](http://www.se-radio.net/podcast/2008-03/episode-88-singularity-research-os-galen-hunt)研究操作系统

*   事务性内存和软件隔离进程

*   许多关于并发的软件工程播客剧集。（这是[第一个](http://www.se-radio.net/podcast/2006-04/episode-12-concurrency-pt-1)。）

*   这篇来自 ACM Queue 关于“[真实世界并发](http://queue.acm.org/detail.cfm?id=1454462)”的文章

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:17:07.210

当然这个问题很难回答，因为没有人知道未来的硬件会是什么样子（至少从长远来看），但是多线程/并行编程很重要，而且在未来几年肯定会更加重要。

我还建议使用像 CUDA/Stream 这样的 GPU 计算，但这可能是一个问题，因为这很可能会在未来几年发生很大变化。

# grails - 在 Grails 中搭建 Web 服务

> ID：927900
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T20:12:57.717
> 
>         
> 
> 标签：grails, groovy, scaffolding

我需要实现一个 Web 应用程序，但我需要使用不同的 SOAP Web 服务作为后端，而不是使用关系数据库。应用程序的一个重要部分只调用 Web 服务并显示结果。由于 Web 服务以 Operation: In parameters 和 Return Type 的形式明确定义，因此在我看来，基本 GUI 可以像基于域实体的脚手架一样轻松构建。

例如，在 SearchProducts Web 服务操作的情况下，我需要输入搜索参数作为输入，这样才能构建搜索页面。操作将返回一个产品列表，所以我需要一个在某种表格中显示该列表的页面。

grails 中是否已经有一些库可以让您实现这一目标。如果没有，您将如何创建一个？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-11-17T02:15:31.213

可能最简单的方法是在 WSDL 文件上使用 wsimport 来生成客户端存根。然后，您可以从 Groovy 调用存根中的方法，就像在 Java 中调用它们一样。

例如，考虑 Microsoft 的 TerraServer 的 WSDL 文件，该文件位于[http://terraservice.net/TerraService.asmx?wsdl](http://terraservice.net/TerraService.asmx?wsdl)。然后你运行类似的东西

```
wsimport -d src -keep http://terraservice.net/TerraService.asmx?WSDL 
```

它将所有已编译的存根放在 src 目录中。然后你可以编写像这样的 Groovy 代码

```
import com.terraserver_usa.terraserver.*;

TerraServiceSoap sei = new TerraService().getTerraServiceSoap()
Place home = new Place(city:'Boston',state:'MA',country:'US')
def pt = sei.convertPlaceToLonLatPt(home)
println "$pt.lat, $pt.lon"
assert Math.abs(pt.lat - 42.360000) < 0.001
assert Math.abs(pt.lon - -71.05000) < 0.001 
```

如果您想访问大量 Web 服务，请为所有这些服务生成存根。或者您可以改用动态代理。  

不过，底线是让 Java 做它已经做得很好的事情，并在它使您的生活更轻松的地方使用 Groovy。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-11-16T23:00:36.087

您应该能够使用[XFire](http://grails.org/plugin/xfire)或[CXF](http://grails.org/plugin/cxf)插件。对于自动脚手架，请修改脚手架模板中的 Controller.groovy 模板，以便它自动生成您需要的方法。  

# c++ - 写“hello world”的奇怪方式

> ID：927901
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T20:13:00.883
> 
>         
> 
> 标签：c++

> **可能的重复项：**
> 
>   [在不更改 main() 函数的情况下更改 c++ 输出](https://stackoverflow.com/questions/646169/changing-c-output-without-changing-the-main-function)
> 
>   [如何将方法的输出分配给文本框值而无需隐藏代码](https://stackoverflow.com/questions/36028/how-to-assign-a-methods-output-to-a-textbox-value-without-code-behind)

如何在不修改 main 函数的情况下编写 hello world？谢谢

```
int main(){return 0;} 
```

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-05-29T20:17:44.883

```
#include<iostream>

int hello() {
    cout<<"Hello World"<<endl;
}

static int foo = hello();

int main(){return 0;} 
```

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T20:16:35.293

只需将此代码添加到某个 .cpp 文件中。

```
class Hack {
  Hack() { cout << "Hello World"; }
} hackInstance; 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:16:45.400

使用预处理器 #define 扩展以返回以打印 hello world，然后返回。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:17:03.357

我假设可以创造性地使用#define 预处理器语句来完成这项工作。

# java-web-start - 为什么我在 jnlp 中得到 UnsupportedClassVersionError？

> ID：927908
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:14:56.467
> 
>         
> 
> 标签：java-web-start, jnlp

启动 jnlp 时抛出 UnsupportedClassVersionError，但是当我尝试从命令行运行相关的 jar 文件时，一切正常。我尝试使用签名/未签名的 jar 文件将 j2se 版本设置为 1.5+、1.6+，但这一切都无济于事。

我正在尝试使用两个支持的 jar 文件（mysql-connector.jar 和 swingx.jar）启动我自己的 jar 文件。我的 jar 文件已在 Eclipse 中使用 1.6 合规性设置进行编译，并使用 ant 构建到 jar 中。由于我可以使用 java 1.6 从命令行启动 3 个 jar，我对 jnlp 失败感到有点困惑。任何帮助表示赞赏。

这是jnlp文件：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- JNLP File -->
<jnlp spec="1.5+" codebase="http://www.etc.com/p" href="demo-daily.jnlp">
 <information>
  <title>demo: daily stock charting utility</title>
  <offline-allowed/>
 </information>
 <security>
 </security>
 <resources>
  <j2se href="http://java.sun.com/products/autodl/j2se" version="1.6+" />
  <jar href="demo-daily.jar" main="true" />
  <jar href="swingx.jar" main="false" />
  <jar href="mysql-connector.jar" main="false" />
 </resources>
 <application-desc main-class="quipu.viewers.charts.stockcharts.daily"/>
</jnlp> 
```

我得到的错误是：

java.lang.UnsupportedClassVersionError: java.lang.ClassLoader.defineClass1(Native Method) 的 .class 文件中的错误版本号 java.security.SecureClassLoader.defineClass(SecureClassLoader) 的 java.lang.ClassLoader.defineClass(ClassLoader.java:675) .java:124) 在 java.net.URLClassLoader.defineClass(URLClassLoader.java:260) 在 java.net.URLClassLoader.access$100(URLClassLoader.java:56) 在 java.net.URLClassLoader$1.run(URLClassLoader.java: 195) 在 java.security.AccessController.doPrivileged(Native Method) 在 java.net.URLClassLoader.findClass(URLClassLoader.java:188) 在 com.sun.jnlp.JNLPClassLoader.findClass(JNLPClassLoader.java:256) 在 java.lang .ClassLoader.loadClass(ClassLoader.java:316) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:251) 在 com.sun.javaws.Launcher.doLaunchApp(Launcher.java:1052) 在 com.sun.javaws。启动器.run（启动器.java：105) 在 java.lang.Thread.run(Thread.java:613)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T23:42:27.450

首先，打开 CMD 窗口或 shell 窗口（根据您使用的操作系统）并输入：

```
java -version 
```

确保您正在运行的版本是您希望运行的版本。然后，再次从命令行发出命令：

```
javaws http://host/path/to/your.jnlp 
```

如果您无法从命令行运行`javaws`，则必须找出它的安装位置并使用可执行文件的完整路径。在 Windows 下，这将类似于

```
C:\Program Files\Java\jre1.6.0_14\bin\javaws.exe 
```

在 Linux 下它可能是`/usr/bin/javaws`，也可能在另一个目录中。

我知道在 Windows 下，无论如何，当您运行任何 Java Web Start 应用程序时，JNLP 加载程序都是从安装的最新 Java 版本开始使用的。或者至少它应该这样做。我还没有在 Linux（或 MacOS）下试验过它是如何工作的。但总是有可能出现问题，当您启动 JNLP 时，您会不小心运行 Java 1.5 JNLP 启动器。

您始终可以尝试卸载并重新安装最新版本的 Java，以确保正确安装最新最好的版本。这可能会解决问题。您可能还需要检查 $PATH（或 %PATH%）以确保路径上的 Java 版本正确。（这并不总是必要的......但如果路径上有任何版本的 Java，请确保它是您想要的版本。）检查环境变量 JAVA_HOME 以确保它指向您认为它所在的位置。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:23:46.620

只是一个猜测，但更新开始标签以引用 spec="1.6+"

```
<jnlp spec="1.6+" codebase="http://www.etc.com/p" href="demo-daily.jnlp"> 
```

# web-services - 从网络访问魔兽世界数据

> ID：927937
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T20:18:29.733
> 
>         
> 
> 标签：web-services, world-of-warcraft

我知道 WoW 插件编程社区，但我找不到任何文档，是任何用于从 Web 访问 WoW 数据库的 API。我看到 WoWHeroes.com 和 Wowhead 等第三方网站使用游戏数据（项目和角色数据库），所以我知道这是可能的。但是，我不知道从哪里开始。是否有我可以使用的 Web 服务，或者他们是否正在做某种需要在其服务器环境中运行 WoW 客户端的幕后工作？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T20:23:40.613

Wowhead 和 WoWHearoes 等网站使用来自玩家的客户端运行插件来收集数据。然后将数据发布到他们的网站。没有办法访问 WoW 的数据库。您最好的选择是点击军械库并提取从您的搜索返回的 XML。军械库只是对返回的 xml 数据进行的 xml 转换。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2011-09-09T01:45:46.313

暴雪最近（2011 年 8 月 15 日）在以下位置发布了其 RESTful API 的文档草案：

[http://blizzard.github.com/api-wow-docs/](http://blizzard.github.com/api-wow-docs/)

API 涵盖了有关角色、物品、拍卖、公会、PVP 等的信息。

对 API 的请求目前被限制为每天 3,000 次以供匿名使用，但有一个流程可以注册合法需要更多访问权限的应用程序。

**更新（2019 年 1 月）**：新的暴雪战网开发者门户在这里：

[https://develop.battle.net/](https://develop.battle.net/)

请求限制和身份验证规则已更改。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:23:55.980

可以从军械库中挖掘字符，页面是 xml。项目是从本地安装游戏文件中挖掘出来的，这就是 wowhead 至少是这样做的。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:24:15.107

从哇军械库中获取物品数据实际上真的很容易！

例如：

[http://www.wowarmory.com/item-info.xml?i=33135](http://www.wowarmory.com/item-info.xml?i=33135)

查看页面的源代码（不是通过 Google Chrome，它通过 XSLT 显示转换后的 XML），您将看到 XML 数据！

例如，您可以使用[搜索列表页面检索所有蓝色宝石](http://www.wowarmory.com/search.xml?searchQuery=&fl[source]=all&fl[type]=gems&fl[subTp]=blue&fl[rrt]=all&fl[usbleBy]=all&advOptName=none&fl[andor]=and&searchType=items&fl[advOpt]=none)，然后使用 XML 解析器检索数据

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:26:50.497

他们正在从[www.wowarmory.com](http://www.wowarmory.com)解析军械库信息。没有官方的暴雪 API 可以访问它，但是有一个可用的开源 PHP 解决方案（[http://phparmory.sourceforge.net/](http://phparmory.sourceforge.net/)）

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2012-10-04T07:47:11.850

派对可能有点晚了，但为了将来参考，请查看[http://blizzard.github.com/api-wow-docs/上的 WoW API 文档](http://blizzard.github.com/api-wow-docs/)

抓取 HTML 和 XML 现在已经过时了，暴雪也不鼓励这样做。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2012-03-08T20:45:41.807

文档：
 [http](http://blizzard.github.com/api-wow-docs/) ://blizzard.github.com/api-wow-docs/
享受

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:25:50.047

像这样的网站实际上是从[军械库](http://www.wowarmory.com/)中获取数据的。如果您拉出任何项目、公会、角色等并在页面上执行“查看源代码”，您将看到返回的 XML 数据。这是一个关于如何获取数据的[快速 C# 示例。](http://spelldamage.wordpress.com/2007/07/17/quick-take-pulling-armory-data-with-c/)

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:24:31.610

此第三方网站收集来自玩家的数据。我认为这个集合基于 WoW 的插件或每个玩家手动提交信息。

下一个选项是包装 wow 站点并解析来自网站 (HTML) 的信息。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:25:17.723

这可能是您的问题的错误站点，但您正在考虑 wowarmory xml 的东西。没有官方的哇 api。人们只是做 httprequests 并让 xml 做数字运算的东西。尝试谷歌搜索。有一些已经为您编写的不同语言的库。我知道 php/ruby 中有实现。前段时间我在.net 中工作，直到我分心。这是一篇总结了这一切的文章。

[http://www.wow.com/2008/02/11/mashing-up-wow-data-when-we-can-get-it-in-outside-applications/](http://www.wow.com/2008/02/11/mashing-up-wow-data-when-we-can-get-it-in-outside-applications/)

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:25:23.997

Wowhead 和其他网站通常依赖用户通过 wow 插件收集的数据。

Wowhead 还可以让其他网站在悬停弹出窗口中引用该数据，因此它们的内容可以在许多网站上重复使用。

[由 Wowhead 提供支持](http://www.wowhead.com/?powered)

* * *

## 回答 #12

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T20:30:38.027

对于实际的游戏数据收集：cosmos.exe 是 thottbot 例如使用的。它可能使用某种形式的 windows hack（dllinjection 或其他东西）或嗅探数据包以确定哪些项目已丢弃等（拦截从 wow 服务器到您的客户端的流量并对其进行解码）。它将这些数据保存在用户计算机上，然后将其上传到网络服务器进行存储。我不知道是否为这种事情创建了任何开发库。

# c++ - Deleting a heap then dereferencing a pointer to that memory

> ID：927945
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T20:20:58.217
> 
>         
> 
> 标签：c++, pointers, heap-memory

This is code from an exercise:

```
#include <iostream>
using namespace std;

int main() {
    int n = 13;
    int* ip = new int(n + 3);
    int* ip2 = ip;
    cout << *ip << endl;
    delete ip;
    cout << *ip2 << endl;
    cout << ip << tab << ip2 << endl;
} 
```

When the space allocated to the int on the heap is deleted, I thought that dereferencing the pointer would give some sort of memory error. Instead, it returns 0.

Why is this?

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-05-29T20:22:33.347

Dereferencing an invalid pointer leads to undefined results per spec. It's not guaranteed to fail. 

*Usually (CPU/OS/compiler/... dependent)*, the compiler doesn't really care about it at all. It just gives what's currently at that memory address. For example, in x86 architecture, you just see an error only when the address is in a memory page that's not mapped to your process (or your process doesn't have permission to access that), thus an exception will be thrown by the CPU (protection fault) which the OS would handle appropriately (and probably, making your process fail). A trick is sometimes used to make accessing the address `0` always cause an access violation: The OS sets the read/write bits of the first page of the address space in the page table to 0 so that any access to that page will always generate an exception.

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:23:29.723

This behaviour is undefined, and so what will happen is implementation and system dependent.

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:25:12.920

Dereferencing the `ip` pointer will return what happens to be at that memory location at that time. 

It's returning 0 because that's what the four bytes at `ip` happen to encode to when cast as an integer. 

dereferencing a pointer after it's been deleted is unpredictable. It might be zero, it might be something else if that memory has been reallocated elsewhere. 

You're just lucky that it's 0 when you run your program. 

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T19:43:03.997

Further to Mehrdads answer, In gcc with glibc, the data structures representing the memory heap are stored in the block of memory returned, to save memory (i.e. its an intrusive list). So, when a block of memory is freed, it is added to the free list. My guess is that the 0 being written following the free indicates that this is the last element of the the free block list (the first pointer sized word of deallocated memory will contain the lists `next` pointer).

If you were to allocate and free more memory before dereferencing this block again, the value would change when a new item is added to the end of the free list. This is one way that library implementation decisions affect what happens during 'undefined' behaviour. In this case, the glibc developers have taken advantage of the fact that this behaviour is undefined to make their memory allocator more space efficient.

If you run your program under valgrind, it will catch these errors for you. In any case, always stay away from undefined behaviour, since it is very likely to be different on various platforms and even different builds on the same platform (e.g. debug vs release).

# flash - Flash ActionScript 2 的压缩和解压缩工具

> ID：927947
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T20:21:20.807
> 
>         
> 
> 标签：flash, actionscript, zip, actionscript-2, unzip

您是否知道 flash / actionscript 2 的任何 zip/unzip 组件或脚本？

我知道[这个](http://ntt.cc/2008/01/19/actionscript-class-library-fzip.html)用于 flex / AS3 的库，但是是否有一个用于 AS2 的库可以节省我长时间的转换尝试？

是否有这样的库支持创建/解析受密码保护的 zip 文件？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-31T15:59:36.410

基本上可以做到...但是会很慢...

[http://code.google.com/p/hxformat/](http://code.google.com/p/hxformat/)

实际上，您将加载字符串，然后将其解码为字节数组（使用 Bytes.ofString）...这将花费很多时间...您将无法对结果做很多事情，我想，因为 AS2 api 非常有限......

您将需要 Haxe，它是一种开源语言，它允许您针对许多平台，其中一个是 AVM1 ...只需访问 haxe.org ...并找到合适的 IDE 来编译...

问题是，编译代码很容易，但你可能很难使用结果，因为 Haxe->swc 仅适用于 AVM2 ...但有多种解决方案...

无论如何......如果可能的话，你应该将你的代码移植到 AS3，正如 fenomas 所建议的那样...... AS2 真的过时了，因为语言和目标更差，VM 更慢，API 更小......而且，还有更多的 AS3那里的库...只是我的个人意见...

好吧，无论如何祝你好运......;）

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-31T06:41:14.993

我不能肯定地说什么，但我认为这种库在 AS2 中是不可能的。如果没有 ByteArrays，您一开始就无法对数据进行二进制访问，所以我能想象的唯一方法是一些令人难以置信的骇人听闻的方法，比如将文件作为位图读取并使用 getPixel 和 setPixel 调整其位 - 想想就让人难以置信。

我认为您在这里唯一真正的选择是：

1.  将您的代码移植到 AS3 并使用您链接的库

2.  通过 LocalConnection 桥将您的 AS2 代码与 AS3 库一起使用（这很麻烦，但这里有几个关于它的主题）

3.  在 Flash 之外进行压缩（例如，在 PHP 中的服务器端等）

# objective-c - 创建以 NSString 的值命名的对象 - 可能吗？

> ID：927955
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:23:46.417
> 
>         
> 
> 标签：objective-c, cocoa, oop, nsstring

是否可以创建一个以 NSString 的值命名的对象？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:33:14.807

尝试这个：

```
Class theClass = NSClassFromString(someString);
id object = [[theClass alloc] init]; 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:33:39.423

如果您的意思是字符串指定了类名，那么是的，使用 NSClassFromString 函数来查找适当的类“工厂”对象很容易做到这一点：

```
NSString* myClassName = @"NSNumber";
id myNewObject = [[NSClassFromString(myClassName) alloc] init];

// myNewObject is an NSNumber... 
```

这个例子是人为的，但你明白了。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T21:26:17.740

是的：

```
//In your header
extern NSString *FrobnitzerCalibrationHigh;
extern NSString *FrobnitzerCalibrationMedium;
extern NSString *FrobnitzerCalibrationLow;

//In your implementation
NSString *FrobnitzerCalibrationHigh = @"FrobnitzerCalibrationHigh";
NSString *FrobnitzerCalibrationMedium = @"FrobnitzerCalibrationMedium";
NSString *FrobnitzerCalibrationLow = @"FrobnitzerCalibrationLow"; 
```

您可以制作几个宏并将它们放在前缀标题中：

```
//Semicolons intentionally omitted (see below)
#define DECLARE_STRING_CONSTANT(name) extern NSString *name
#define DEFINE_STRING_CONSTANT(name) NSString *name = @#name 
```

然后在你的类头文件和实现中使用它们：

```
//In your header
DECLARE_STRING_CONSTANT(FrobnitzerCalibrationHigh);
DECLARE_STRING_CONSTANT(FrobnitzerCalibrationMedium);
DECLARE_STRING_CONSTANT(FrobnitzerCalibrationLow);

//In your implementation
DEFINE_STRING_CONSTANT(FrobnitzerCalibrationHigh);
DEFINE_STRING_CONSTANT(FrobnitzerCalibrationMedium);
DEFINE_STRING_CONSTANT(FrobnitzerCalibrationLow); 
```

（宏省略了分号，因为它们的用法会提供分号。如果宏也有分号，那么扩展将是`extern NSString *FrobnitzerCalibrationHigh;;`——在这种情况下是无害的，但如果我这样做会困扰我，主要是因为在其他一些情况下它不是无害的.)

# c# - EditorReuseAttribute 的真正用途是什么？

> ID：927964
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T20:25:08.160
> 
>         
> 
> 标签：c#, attributes, componentmodel

我找不到使用此属性的方法的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-23T19:17:22.317

想象一下你有这样的场景：

```
class Complex
{
   public OtherComplex1 Property1 { get; set; }
   public OtherComplex2 Property2 { get; set; }
   public OtherComplex2 Property3 { get; set; }
   .....
   public OtherComplexN PropertyN { get; set; }

} 
```

您的每个属性都有自己的类型设计器，它显示一些属性等。

比如说，您有两个不同的 Complex 类实例 + 一些其他任意类的实例。

现在，当您像这样在对象之间切换时 - 复杂实例 1 -> 其他 -> 复杂实例 2 - 一切都会正常工作，但是如果您执行以下操作：

复杂实例 1 -> 复杂实例 2，您会注意到属性没有被刷新。

这是属性网格的默认行为，它试图优化数据刷新操作的数量。unless you want to bake a lot of logic in order to keep your designers updated, i'd suggest marking your complexTypes with editor reuse attribute set to false - in this case, whenever selection changes to a different instance, property grid would still refresh your设计师。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-06-01T13:07:54.643

[MSDN](http://msdn.microsoft.com/en-us/library/system.activities.design.base.propertyediting.editorreuseattribute(VS.100).aspx)表示确实是表示可以重复使用属性编辑器而无需每次都重新创建。

这是一个性能上的胜利，特别是如果您的编辑器需要在启动时做大量工作，这是可以避免的。除非您*实际上*遇到性能问题，否则我不会担心。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:27:12.743

如果您不知道它的作用，为什么需要使用它？您是否有任何当前正在使用它的代码可以作为示例发布？

听起来它允许您定义可以重用您的属性的属性编辑器而无需重新启动。我不太确定为什么这会有用。

# svn - 我如何将一个我之前忘记提交的文件提交到 SVN，（调整它的修订号）

> ID：927970
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T20:25:36.833
> 
>         
> 
> 标签：svn, tortoisesvn

所以我一直很高兴地使用颠覆来定期提交与我的大型 Visual Studio 解决方案相关的项目堆栈中的文件。

我决定有一天做一个 svn 导出，并决定我需要看看我的项目在 2008 年 10 月是如何工作的。所以，我导出到我的本地文件系统，修订版 37。

当我去编译项目时，不知何故有 2 或 3 个文件在 10 月份被忽略了。假设他们直到 99 版才被提交，或者更好的是，他们仍然根本没有被提交。

有没有办法调整文件上的提交号，以便它与*你想要*的正确修订相匹配？因此，如果我重新导出修订版 37，我会在 Visual Studio 中获得正确且有效的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:32:36.570

并不真地。Subversion 修订号适用于整个源代码树。如果您能够对已提交的修订进行更改，那将破坏变更管理的想法。

您可以做的是从修订版 37 创建一个分支，并对其进行更改。这将创建一个新的修订版，比如 100。然后您可以提交它，您将获得您正在寻找的修改后的修订版 37。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:35:07.737

这是可能的，但要求您不要胆小，了解 SVN 存储库转储格式并有稳定的手（和备份）。

该过程是将整个存储库转储为文本版本，找到您要查找的修订条目并添加信息，然后重新加载转储（覆盖现有存储库）。

不幸的是，这种格式不适合胆小的人（它类似于带有扩展的 HTTP，大多数字段都以它们的长度开头），并且打破它相当容易。

也不是很推荐。现在提交文件，以后要更加小心。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:33:31.437

不，那是不可能的。你不能改变历史。

如果可以按照您的要求进行操作，那么这将打破版本控制的整个概念：拥有可靠的提交历史记录。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:32:20.597

这似乎是不可能的事情。

您可以尝试从更高版本中获取这两个文件并使用它们（使用版本 37 中的文件）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:41:27.240

听起来您并不真正关心它是修订版 37。相反，您正试图重新导出具有特定现实世界属性的修订版（即，修订版 37 恰好是您提供给客户的版本）。

正如马特所说，你真的想从 rev 37 创建一个分支。本质上，这意味着你要将 rev 37 复制到一个 Subversion 目录，其名称可以解释它是什么，例如 /branches/client-A。然后，将丢失的文件添加到分支并提交。然后，您可以从 /branches/client-A 导出以获得您想要的。

# java - Java 的哪些特性使其能够比类似的 C++ 程序构建得更快？

> ID：927975
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T20:26:28.547
> 
>         
> 
> 标签：java, build-process

> **可能重复：**
> 
>   [为什么 C++ 编译需要这么长时间？](https://stackoverflow.com/questions/318398/why-does-c-compilation-take-so-long)

我正在处理两个大小大致相同（loc）的不同项目。使用 Ant 的 Java 构建过程以分钟为单位。使用 CMAKE 工具的 C++ 构建处理以小时为单位。

Java 的哪些特性使其能够比类似的 C++ 程序构建得更快？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:28:10.200

我不得不怀疑缺少千行头文件与它有很大关系。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:28:51.070

**不同的优化策略**

Java 代码在编译时通常不像 C/C++ 代码那样优化。这意味着与 C/C++ 编译器发出的“类似”本机代码相比，Java 字节码“优化程度较低”。JVM 的即时 (JIT) 编译器在运行时进行优化以提高字节码性能。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T20:29:12.630

模板的编译速度特别慢。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:29:08.917

仅具有相同的 LOC 并不意味着构建将花费相同的时间。例如，如果您在 C++ 中添加像 windows.h 这样的大头文件，则必须为这一行构建更多内容。

* * *

## 回答 #5

> 赞同：-2
> 
>             
> 
> 时间：2009-05-29T20:28:53.223

哇，那个 CMAKE 文件中肯定**有**其他事情发生，而 java 项目没有发生。是否正在运行自动化测试用例？Java 没有任何基本的东西可以使它编译数量级（或任何）比 C++ 代码快。

# msbuild - 如何在 MSBuild 中找到当前文件

> ID：927978
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T20:27:16.037
> 
>         
> 
> 标签：msbuild

我知道最新出版的关于 MSBuild 的书说这是不可能的，但我确信我已经看到了一个指向当前文件的属性。

有谁知道找到当前文件的方法？（即当主 MSBuild 文件导入辅助文件时。从该文件内部到辅助文件的路径是什么。）

我正在尝试在 HKEY_LOCALMACHINE\Software\Microsoft\VisualStudio\8.0\MSBuild\SafeImports 中注册我的文件，但是文件的路径在我的每台同事计算机上都不是恒定的，并且它是从几个不同的项目中导入的，因此进行了硬编码相对路径也不是一个好主意。

如果有办法让当前工作目录也可以工作（工作目录会随着每次导入而切换，我想我可以把它保存下来）

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-06-01T13:22:41.573

没有可靠的方法来识别“**当前文件**”。当 MSBuild 处理一个文件时，它可以导入多个其他文件，最终结果是该文件在内存中的单个完整表示。当目标执行时，它们不知道它们是在哪个文件中声明的。

这就是为什么可重用的构建脚本必须“参数化”以接受已知相对位置的位置。例如，如果您依赖于 3rd 方引用文件夹所在的位置，则驱动该过程的构建脚本必须为您声明该属性。

## 仅限 MSBuild 4.0

如果您使用的是**MSBuild 4.0**，即 Visual Studio 2010/.NET 4.0，（可以针对 .NET 2.0/3.0/3.5）。然后，您现在拥有可用于此特定目的的这些属性：

*   `MSBuildThisFile`

*   `MSBuildThisFileDirectory`

*   `MSBuildThisFileDirectoryNoRoot`

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-07-17T23:32:03.553

在 4.0+ 中，您可以使用像 $(MSBuildThisFile) 这样的属性来做到这一点。看[这里](http://msdn.microsoft.com/en-us/library/ms164309.aspx)

# json - 如何在 Scala / Lift 中构造和解析 JSON 字符串

> ID：927983
> 
>         
> 
> 赞同：55
> 
>         
> 
> 时间：2009-05-29T20:28:14.987
> 
>         
> 
> 标签：json, scala, lift

我正在尝试使用 JSON 在浏览器和我的应用程序之间发送数据。

我正在尝试使用 Lift 1.0 创建和解析 JSON 字符串，但由于某种原因，我无法解析我刚刚构建的 JSON：

```
scala>import scala.util.parsing.json.JSON._
import scala.util.parsing.json.JSON._

scala> import net.liftweb.http.js._
import net.liftweb.http.js._

scala> import net.liftweb.http.js.JE._
import net.liftweb.http.js.JE._

scala> val json = JsObj(("foo", 4), ("bar", "baz")).toJsCmd
json: String = {'foo': 4, 'bar': 'baz'}

scala>  parseFull(json)  
res3: Option[Any] = None 
```

如何以编程方式在 Scala/Lift 中构造一个也可以再次解析的有效 JSON 消息？

* * *

## 回答 #1

> 赞同：89
> 
>             
> 
> 时间：2009-05-29T20:53:50.787

您正在使用 Lift 1.0's `JsCmd`，它生成带有单引号字符串的 JSON，并尝试使用仅支持双引号字符串的 scala 解析器对其进行解析。

重要的是要意识到 JSON 有多种定义。

单引号字符串在 JSON 中有效吗？

*   它们是根据[ECMAScript 5th Ed](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf)

*   它们不符合 Crockford 的原始[RFC 4627](http://www.ietf.org/rfc/rfc4627.txt)

Lift 和 Scala 提供了许多解析 JSON 的方法，有时版本之间的行为不同。

这些解析器接受的字符串是不等价的。

以下是生成和解析 JSON 字符串的各种方法的一些评论和示例。

* * *

## [使用lift-json](https://github.com/lift/lift/tree/master/framework/lift-base/lift-json/)库 DSL生成 JSON

*   受到推崇的

*   尽管它的名字，这是一个独立的项目，不依赖于电梯的其余部分

例子：

```
scala> import net.liftweb.json.JsonAST
import net.liftweb.json.JsonAST

scala> import net.liftweb.json.JsonDSL._
import net.liftweb.json.JsonDSL._

scala> import net.liftweb.json.Printer._
import net.liftweb.json.Printer._

scala> val json1 = ("foo" -> 4) ~ ("bar" -> "baz")
json1: net.liftweb.json.JsonAST.JObject = JObject(List(JField(foo,JInt(4)), JField(bar,JString(baz))))

scala> compact(JsonAST.render(json1))
res0: String = {"foo":4,"bar":"baz"}

scala> val json2 = List(1,2,3)
json2: List[Int] = List(1, 2, 3)

scala> compact(JsonAST.render(json2))
res1: String = [1,2,3]

scala> val json3 = ("foo", 4) ~ ("bar", List(1,2,3))
json3: net.liftweb.json.JsonAST.JObject = JObject(List(JField(foo,JInt(4)), JField(bar,JArray(List(JInt(1), JInt(2), JInt(3))))))

scala> compact(JsonAST.render(json3))
res2: String = {"foo":4,"bar":[1,2,3]} 
```

* * *

## [使用lift-json](https://github.com/lift/lift/tree/master/framework/lift-base/lift-json/)库解析 JSON

*   受到推崇的

*   提供到/从 scala 案例类的隐式映射

*   当前不支持在控制台中定义的案例类（将抛出一个`com.thoughtworks.paranamer.ParameterNamesNotFoundException: Unable to get class bytes`）

*   下面的示例使用`[PublicID](http://www.scala-lang.org/api/current/scala/xml/dtd/PublicID.html)`, 一个预先存在的 scala 案例类，以便它可以在 scala 控制台上工作。

例子：

```
scala> import scala.xml.dtd.PublicID
import scala.xml.dtd.PublicID

scala> import net.liftweb.json._
import net.liftweb.json._

scala> import net.liftweb.json.JsonAST._
import net.liftweb.json.JsonAST._

scala> import net.liftweb.json.JsonDSL._
import net.liftweb.json.JsonDSL._

scala> implicit val formats = DefaultFormats 
formats: net.liftweb.json.DefaultFormats.type = net.liftweb.json.DefaultFormats$@7fa27edd

scala> val jsonAst = ("publicId1" -> "idString") ~ ("systemId" -> "systemIdStr")
jsonAst: net.liftweb.json.JsonAST.JObject = JObject(List(JField(publicId,JString(idString)), JField(systemId,JString(systemIdStr))))

scala> jsonAst.extract[PublicID]
res0: scala.xml.dtd.PublicID = PUBLIC "idString" "systemIdStr" 
```

* * *

## 在 scala 2.7.7 和 2.8.1 中解析 JSON

*   不推荐 - “[不再真正支持](http://www.quora.com/How-do-I-parse-a-JSON-string-in-scala)”

*   Scala 2.7.7 的解析器不会解析单引号 JSON   

*   问题中使用的这种解析方法

例子：

```
scala>import scala.util.parsing.json.JSON._
import scala.util.parsing.json.JSON._

scala>  parseFull("{\"foo\" : 4 }")        
res1: Option[Any] = Some(Map(foo -> 4.0))

scala> parseFull("[ 1,2,3 ]")
res2: Option[Any] = Some(List(1.0, 2.0, 3.0))

scala>  parseFull("{'foo' : 4 }")  
res3: Option[Any] = None 
```

* * *

## [使用util.JSONParser](http://main.scala-tools.org/mvnsites/liftweb-2.0/framework/scaladocs/net/liftweb/util/JSONParser$object.html)在 Lift 2.0 和 2.2 中解析 JSON

*   中性推荐

*   Lift 的 util.JSONParser 将解析单引号或双引号的 JSON 字符串：

例子：

```
scala> import net.liftweb.util.JSONParser._
import net.liftweb.util.JSONParser._

scala> parse("{\"foo\" : 4 }")    
res1: net.liftweb.common.Box[Any] = Full(Map(foo -> 4.0))

scala> parse("[ 1,2,3 ]")
res2: net.liftweb.common.Box[Any] = Full(List(1.0, 2.0, 3.0))

scala> parse("{'foo' : 4}")           
res3: net.liftweb.common.Box[Any] = Full(Map(foo -> 4.0)) 
```

* * *

## [使用json.JsonParser](http://main.scala-tools.org/mvnsites/liftweb-2.0/framework/scaladocs/net/liftweb/json/JsonParser$object.html)在 Lift 2.0 和 2.2 中解析 JSON

*   中性推荐

*   Lift 的 json.JsonParser 不会解析单引号的 JSON 字符串：

例子：

```
scala> import net.liftweb.json._
import net.liftweb.json._

scala> import net.liftweb.json.JsonParser._
import net.liftweb.json.JsonParser._

scala> parse("{\"foo\" : 4 }")
res1: net.liftweb.json.JsonAST.JValue = JObject(List(JField(foo,JInt(4))))

scala> parse("[ 1,2,3 ]")
res2: net.liftweb.json.JsonAST.JValue = JArray(List(JInt(1), JInt(2), JInt(3)))

scala> parse("{'foo' : 4}")    
net.liftweb.json.JsonParser$ParseException: unknown token '
Near: {'foo' : 4}
    at net.liftweb.json.JsonParser$Parser.fail(JsonParser.scala:216)
    at net.liftweb.json.JsonParser$Parser.nextToken(JsonParser.scala:308)
    at net.liftweb.json.JsonParser$$anonfun$1.apply(JsonParser.scala:172)
    at net.liftweb.json.JsonParser$$anonfun$1.apply(JsonParser.scala:129)
    at net.liftweb.json.JsonParse... 
```

* * *

## 使用 Lift 1.0 JsCmd 生成 JSON

*   不推荐 - 输出对所有 JSON 解析器都无效

*   注意字符串周围的单引号：

例子：

```
scala> import net.liftweb.http.js._
import net.liftweb.http.js._

scala> import net.liftweb.http.js.JE._
import net.liftweb.http.js.JE._

scala> JsObj(("foo", 4), ("bar", "baz")).toJsCmd
res0: String = {'foo': 4, 'bar': 'baz'}

scala> JsArray(1,2,3).toJsCmd
res1: String = 
[1, 2, 3]

scala>  JsObj(("foo", 4), ("bar", JsArray(1,2,3))).toJsCmd
res2: String = 
{'foo': 4, 'bar': [1, 2, 3]
} 
```

* * *

## 使用 Lift 2.0 JsCmd 生成 JSON

*   中性推荐

*   注意字符串周围的双引号：

例子：

```
scala> import net.liftweb.http.js._
import net.liftweb.http.js._

scala> import net.liftweb.http.js.JE._
import net.liftweb.http.js.JE._

scala> JsObj(("foo", 4), ("bar", "baz")).toJsCmd
res0: String = {"foo": 4, "bar": "baz"}

scala> JsArray(1,2,3).toJsCmd
res1: String = 
[1, 2, 3]

scala> JsObj(("foo", 4), ("bar", JsArray(1,2,3))).toJsCmd
res3: String = 
{"foo": 4, "bar": [1, 2, 3]
} 
```

* * *

## 在 scala 中生成 JSON（用 2.10 测试）

*   “[不再真正受支持](http://www.quora.com/How-do-I-parse-a-JSON-string-in-scala)”，但它可以工作并且就在那里。

例子：

```
scala> import scala.util.parsing.json._
import scala.util.parsing.json._

scala> JSONObject (Map ("foo" -> 4, "bar" -> JSONArray (1 :: 2 :: 3 :: Nil))) .toString()
res0: String = {"foo" : 4, "bar" : [1, 2, 3]} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2016-05-28T18:52:23.010

看看[Circe](https://github.com/travisbrown/circe "瑟瑟")。它真的很好用，它利用了[Shapeless](https://github.com/milessabin/shapeless)和[Cats](https://github.com/typelevel/cats)的一些新工具。另外，您可以从[编译为 Javascript 的 Scala](https://www.scala-js.org/)使用它。

取自[Circe 自述文件](https://github.com/travisbrown/circe "瑟瑟")：

> scala> 导入 io.circe。*, io.circe.generic.auto。*, io.circe.parser。*, io.circe. 语法。*导入 io.circe._ 导入 io.circe.generic.auto._ 导入 io.circe.parser._ 导入 io.circe.syntax._
> 
>   
>   
> 
> scala> 密封特征 Foo 定义的特征 Foo
> 
>   
>   
> 
> scala> case class Bar(xs: List[String]) extends Foo 定义的类 Bar
> 
>   
>   
> 
> scala> case class Qux(i: Int, d: Option[Double]) extends Foo 定义的类 Qux
> 
>   
>   
> 
> scala> val foo: Foo = Qux(13, Some(14.0)) foo: Foo = Qux(13,Some(14.0))
> 
>   
>   
> 
> scala> foo.asJson.noSpaces res0: String = {"Qux":{"d":14.0,"i":13}}
> 
>   
>   
> 
> scala> decodeFoo res1:cats.data.Xor[io.circe.Error,Foo] = Right(Qux(13,Some(14.0)))

# python - Python类继承问题

> ID：927985
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-05-29T20:28:23.647
> 
>         
> 
> 标签：python, class, inheritance

我正在玩 Python 类继承，遇到了一个问题，`__init__`如果从子类（下面的代码）调用继承没有被执行，我从 Active Python 得到的结果是：

* * *

```
>>> start
Tom Sneed
Sue Ann
Traceback (most recent call last):
  File "C:\Python26\Lib\site-packages\pythonwin\pywin\framework\scriptutils.py", line 312, <br>in RunScript
    exec codeObject in __main__.__dict__
  File "C:\temp\classtest.py", line 22, in <module>
    print y.get_emp()
  File "C:\temp\classtest.py", line 16, in get_emp
    return self.FirstName + ' ' + 'abc'
AttributeError: Employee instance has no attribute 'FirstName' 
```

* * *

## 这是代码

```
class Person():
    AnotherName = 'Sue Ann'
    def __init__(self):
        self.FirstName = 'Tom'
        self.LastName = 'Sneed'

    def get_name(self):
        return self.FirstName + ' ' + self.LastName

class Employee(Person):
    def __init__(self):
        self.empnum = 'abc123'

    def get_emp(self):
        print self.AnotherName
        return self.FirstName + ' ' + 'abc'

x = Person()
y = Employee()
print 'start'
print x.get_name()
print y.get_emp() 
```

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-05-29T20:34:37.767

三件事：

1.  您需要显式调用构造函数。它不会像在 C++ 中那样自动为您调用

2.  使用继承自对象的新型类

3.  对于新式类，使用可用的 super() 方法

这看起来像：

```
class Person(object):
    AnotherName = 'Sue Ann'
    def __init__(self):
        super(Person, self).__init__()
        self.FirstName = 'Tom'
        self.LastName = 'Sneed'

    def get_name(self):
        return self.FirstName + ' ' + self.LastName

class Employee(Person):
    def __init__(self):
        super(Employee, self).__init__()
        self.empnum = 'abc123'

    def get_emp(self):
        print self.AnotherName
        return self.FirstName + ' ' + 'abc' 
```

推荐使用 super ，因为它也可以在多重继承的情况下正确处理调用构造函数一次（只要继承图中的每个类也使用 super ）。如果/当您更改类的继承对象时（例如，您分解出一个基类并更改派生，并且不必担心您的类调用错误的父类），这也是您需要更改代码的少一个地方构造函数）。同样在 MI 方面，您只需要一次超级调用即可正确调用所有基类构造函数。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-05-29T20:32:36.960

您应该明确调用超类的 init 函数：

```
class Employee(Person):
    def __init__(self):
        Person.__init__(self)
        self.empnum = "abc123" 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T20:31:04.000

Employee 必须显式调用父级的 __init__ （不是 init）：

```
 class Employee(Person):  
    def __init__(self):  
         Person.__init__(self)  
         self.empnum = 'abc123' 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-11-10T18:25:50.897

而不是`super(class, instance)`模式，为什么不只是使用`super(instance)`作为类总是`instance.__class__`？

有没有特定情况下不会`instance.__class__`？

# .net - 如何找到所有依赖的dll

> ID：927991
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:29:16.937
> 
>         
> 
> 标签：.net, web-services

在 Cassini 中运行 Web 服务时出现此错误：找不到指定的模块。（来自 HRESULT 的异常：0x8007007E）

如何准确判断找不到哪个文件？我已经尝试过 ProcMon，但我没有看到任何明显的方法来确定它生成的数千行中的实际错误。

看到一篇关于 fuslogview - Assemly Binding Log Viewer 的帖子，但在那里看不到任何日志。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:35:18.297

我之前非常广泛地处理过整个程序集绑定问题，而 Fusion Logs 就是它所在的位置。但是，您必须做一些事情才能让它们实际写入日志。

这是我获得有关如何执行此操作的大部分信息的地方，并且从那以后一直在使用它：

[http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T20:39:15.060

[您可以按照此处所述](http://mark.michaelis.net/Blog/BindingExceptionsInNET20Fusion.aspx)激活日志记录。该工具的文档在[此处](http://msdn.microsoft.com/en-us/library/e74a18c4(VS.80).aspx)。

根据评论：您也可以尝试[Dependency Walker](http://www.dependencywalker.com/)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:45:41.053

我一般使用 [.Net reflector] 来识别 DLL 文件的依赖关系。这当然是假设您正在寻找 .Net 程序集 DLL，而不是常规的 Windows DLL。

显然，作为该站点的新用户，我无法发布 URL，但第一个 google 结果将使您能够下载反射器应用程序。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2017-05-15T16:49:04.213

另一种选择是使用

```
dumpbin /dependents DLL_FILE 
```

它在第一级显示依赖库。dumpbin 是一个 exe 文件，位于 Visual Studio 的 bin 目录中。

# javascript - 可以查看 PDF 的 Javascript 和 CSS 灯箱

> ID：927992
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T20:29:35.920
> 
>         
> 
> 标签：javascript, css, pdf, lightbox, lightbox2

有没有人发现任何可以显示 PDF 的灯箱类型的 javascript/css 代码？我尝试了很多图书馆，但没有一个对我有用。环境需要兼容 IE6/IE7。

我正在寻找类似的东西：
 [Lightbox 2](http://www.huddletogether.com/projects/lightbox2/)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:37:58.183

[http://stickmanlabs.com/lightwindow/](http://stickmanlabs.com/lightwindow/)

具体来说，查看用于嵌入 PDF 的演示“Flash Paper”

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:31:37.507

祝你好运找到任何可以在没有插件的浏览器中显示 PDF 的东西。

您可以考虑以灯箱样式嵌入指向 PDF 的 IFrame。不过，这大约是你能做的最好的事情。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T20:51:09.980

总结您的选择：

**如果 PDF 的一部分的屏幕截图**足够好，那么正如 tomlog 回答的那样，您可以找到一个库或现有代码来将所述部分提取为图像，并将该图像显示在“灯箱”中。

但是，如果您需要*实际的 PDF 查看功能*，则**无法**在 IE6/7 中完成，而无需加载到 Adob​​e Flash/swf 对象中，或者以某种方式包含在官方的 Adob​​e Reader 浏览器插件中。

走**插件**路线，您将不得不使用**iFrame**。

如果**Flash** /embedding 方法看起来更好，jvenema 建议[http://stickmanlabs.com/lightwindow/](http://stickmanlabs.com/lightwindow/)有一个“Flash Paper”演示（Flash Paper 是嵌入 PDF 文档的*官方*方式），您可以查看或嵌入其他内容，见[http://www.scribd.com/](http://www.scribd.com/)和其他。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-10-11T18:45:55.497

[artViper 的缓冲器](http://www.artviper.net/bumpbox-demo/)

> **Bumpbox 2.0**是一个灯箱克隆，支持 PDF、flv、swf、音频、图像、内联 HTML 和远程 html 文件。现在还可以直接播放 Youtube© 和 Vimeo© 视频！

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:32:01.453

如果它不在这里，它就不在任何地方：[灯箱克隆](http://planetozh.com/projects/lightbox-clones/)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:33:25.150

您在这里有几个解决方案

您可以将 PDF 嵌入 iframe（在灯箱或面板中），例如[http://www.cs.tut.fi/~jkorpela/html/iframe-pdf.html](http://www.cs.tut.fi/~jkorpela/html/iframe-pdf.html)

否则，您可以将 PDF 上传到像 Issuu 这样的文档共享站点，并将其 swf 嵌入您的网页中。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:34:45.660

如果您可以找到一个 PDF 库，可以将每个页面转换为图像（JPEG、GIF 或其他），那么您可以在您的灯箱中显示这些内容。

显然，您将失去 PDF 的所有缩放和分页功能。

# c# - 强类型数据集 Adapter.Update 不插入行

> ID：927999
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T20:31:54.607
> 
>         
> 
> 标签：c#

我有以下代码（根据[指南](http://weblogs.asp.net/scottgu/archive/2006/01/15/435498.aspx)）应该将一条记录插入我的强类型数据集，然后插入我的数据库。但是，该记录并未输入到数据库中，而是正确输入到数据集中。我错过了一个命令吗？

```
 using (Dataset1TableAdapters.AddressTableAdapter addressAdapter = new Dataset1TableAdapters.AddressTableAdapter())
{
    using (Dataset1.AddressDataTable addresses = new Dataset1.AddressDataTable()) 
    {
        // Create a new address.
        Dataset1.AddressRow address = addresses.NewAddressRow();

        // Set some data.
        address.Address1 = "test1";
        address.Address2 = "test2";
        address.Address3 = "test3";
        address.UserID = 1;

        // Add new address to address table.
        addresses.AddAddressRow(address);

        // Update the database with all the changes.
        addressAdapter.Update(addresses);
    }
} 
```

干杯，保罗。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2012-03-01T04:44:09.027

我认为您需要一个`CommandBuilder`与您的适配器关联的对象

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2012-04-10T10:58:58.667

请`addresses.AcceptChanges()`在调用更新命令之前致电，如果这不起作用，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T20:38:05.857

您的连接对象设置是否正确？类型化的数据集将根据配置默认其连接。您还可以在创建 TableAdapter 时指定连接对象。************* 
```**