# StackOverflow 问答 10217000-10217999

# django - DJANGO 呼叫另一个用户的个人资料

> ID：10217002
> 
> 赞同：0
> 
> 时间：2012-04-18T19:56:16.107
> 
> 标签：django, profile

我熟悉调用当前登录的用户，使用：requestcontext、user 和 get_profile。
如果我正在创建另一个页面，而不是当前登录用户的页面怎么办？

我的网址是：

```
r'^/profile/(\w+)/$' 
```

视图如下：

```
from django.contrib.auth.models import User

def profile(request, username):
    person = User.objects.filter(username=username)
    return render_to_response('profile.html', {"person":person}, 
         context_instance=RequestContext(request)) 
```

在我的模板中，我可以输入 {{user.username}} 或 {{user.get_profile.name}} 并获取值，但不能输入 {{person.username}} 或 {{person.get_profile.name}}。有什么方法可以检索我需要的信息？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T19:59:57.283

`.filter`返回一个列表，即使它只有一个匹配项。由于您正在寻找一个用户名，请使用`.get(username=username)`，您的人最终将只得到一个对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:31:53.250

您应该查看 Django 文档中的[检索对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-objects)。返回查询集的方法：

**方法 .all()**

> all() 方法返回数据库中所有对象的 QuerySet。

```
>> users = User.objects.all()
>> type(users) # This is a QuerySet, not a User object
<class 'django.db.models.query.QuerySet'> 
```

**方法 .filter() 和 exclude()**

> **filter(**kwargs)**
> 返回一个新的 QuerySet，其中包含与给定查找参数匹配的对象。
> 
> **exclude(**kwargs)**
> 返回一个新的 QuerySet，其中包含与给定查找参数不匹配的对象。

```
>> users = User.objects.filter(username=username)
>> type(users) # This is a QuerySet, not a User object
<class 'django.db.models.query.QuerySet'>

>> users = User.objects.exclude(username=username)
>> type(users) # This is a QuerySet, not a User object
<class 'django.db.models.query.QuerySet'> 
```

* * *

现在，如果您查看[不返回 QuerySets 的方法](https://docs.djangoproject.com/en/dev/ref/models/querysets/#methods-that-do-not-return-querysets)。

这是您需要使用的：

**方法 .get()**

> **get(**kwargs)**
> 返回与给定查找参数匹配的对象，该参数应采用字段查找中描述的格式。

```
>> users = User.objects.exclude(username=username)
>> type(users) # This is a User object
<class 'YourProject.YourApp.models.User'> 
```

# c++ - 使用链表数组实现哈希表

> ID：10217012
> 
> 赞同：0
> 
> 时间：2012-04-18T19:56:58.003
> 
> 标签：c++, performance, data-structures, hashtable

这个问题困扰了我很长时间，今天我阅读了与哈希表相关的详细文章。在不检查任何**实现示例**的情况下，我想尝试从头开始编写哈希表。

**单独**的链接方法给了我实现哈希表的想法。任何有数据结构经验的人都可能认为这个问题是个笑话，但我是一个初学者，没有直接研究代码，我想讨论我的实现效率。它会是有效的还是比这更可取的任何其他基本想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T00:51:57.540

我认为对于初学者，您还可以查看在 boost 库中实现的一些哈希映射的源代码（或文档）。它被称为 unordered_map。[（链接在这里）](http://www.boost.org/doc/libs/1_37_0/doc/html/unordered.html)

只要您不了解这些实现并且想要使用散列并且因为它不在 STL 中而感到恼火，您就会有兴趣编写自己的快速数据存储。
但是现在实现散列映射已经非常困难了，以至于 C++11 在它的 STL 中有 unordered_map。你会看到那里有很多更有趣的东西。

注意：单独的链接称为桶哈希。其实**boost 使用的是桶哈希**，见[这个链接](http://www.boost.org/doc/libs/1_37_0/doc/html/unordered/buckets.html)。也许您宁愿查找一些性能比较。那些执行 perf 的人很可能会编写足够好的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T01:33:11.497

使用封闭寻址，另一种选择是使用自平衡二叉搜索树，例如红黑树/std::map 或堆树，用于内部数据结构，甚至是具有不同散列算法的另一个散列图。

使用[开放寻址](http://en.m.wikipedia.org/wiki/Open_addressing)，线性探测的另一种替代方法是二次探测和[双散列](http://en.wikipedia.org/wiki/Double_hashing)；还有一些不太常用的策略，例如布谷鸟哈希、跳房子哈希等。

实现哈希表的关键是选择正确的哈希算法、调整大小策略（负载因子）和冲突解决策略。最佳策略高度依赖于您期望的工作负载类型，因为每种方法都需要权衡取舍。

# c - 警告：控制到达非 void 函数的结尾 (gtk)

> ID：10217014
> 
> 赞同：2
> 
> 时间：2012-04-18T19:57:02.353
> 
> 标签：c

我不断收到“警告：控制到达非无效函数的结尾”的代码：

```
static show_message(GtkMessageType type, const char* text, const char* details)
{
    GtkWidget *dialog;

    g_assert(text);

    dialog = gtk_message_dialog_new(NULL, DIALOG_FLAGS, type, GTK_BUTTONS_CLOSE,
        "%s", text);
    if (details) {
        gtk_message_dialog_format_secondary_text(GTK_MESSAGE_DIALOG(dialog), "%s", details);
    }
    gtk_dialog_run(GTK_DIALOG (dialog));
    gtk_widget_destroy(dialog);
} 
```

当我编译上面的代码时，我得到警告（即控制到达非无效函数的结尾）：

```
gui.c: warning: return type defaults to 'int'
gui.c: In function 'show_message':
gui.c: warning: control reaches end of non-void function 
```

我怎样才能摆脱这个警告？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T19:58:02.293

`show_message()`需要将函数的返回值指定为`void`，否则假定为`int`。像这样：

```
static void show_message(GtkMessageType type, const char* text, const char* details)
{
    /* ... */
} 
```

# bash - 使用Shell从字符串中间删除第n个字符

> ID：10217016
> 
> 赞同：1
> 
> 时间：2012-04-18T19:57:07.147
> 
> 标签：bash, sed

我一直在搜索谷歌，我找不到如何做到这一点的例子。我也不掌握如何为 SED 构造正则表达式的概念，所以我希望有人能向我解释一下。

我正在对一个充满如下文本行的文件运行 bash 脚本：2222,H,73.82,04,07,2012

我需要让它们看起来像这样：2222,H,73.82,04072012

我需要删除最后两个逗号，它们是该行中的第 16 个和第 19 个字符。有人可以告诉我该怎么做吗？我打算使用 colrm，它非常简单，但我似乎无法在 CYGWIN 中安装它。谢谢，麻烦您了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:12:56.107

我会用[**`awk`**](http://en.wikipedia.org/wiki/AWK)这个：

```
awk -F',' -v OFS=',' '{ print $1, $2, $3, $4$5$6 }' inputfile 
```

这需要一个 CSV 文件并打印第一个、第二个和第三个字段，每个字段后跟输出字段分隔符 ( `","`)，然后是连接的第四个、第五个和第六个字段。

就我个人而言，我发现这比基于正则表达式的解决方案更易于阅读和维护，**`sed`**并且如果您的任何列变得更宽（或更窄！），它会很好地应对。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:13:18.230

这将适用于任何字符串，并且只会删除最后 2 个逗号：

```
sed -e 's/\(.*\),\([^,]*\),\([^,]*\)$/\1\2\3/' infile.txt 
```

请注意，在我的 sed 变体中，我必须转义括号 YMMV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:04:26.207

```
echo "2222,H,73.82,04,07,2012" | sed -r 's/(.{15}).(..)./\1\2/' 
```

取 15 个字符，丢弃 1 个，取 2 个，丢弃 1 个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T20:32:25.350

> 我也不掌握如何为 SED 构造正则表达式的概念，所以我希望有人能向我解释一下。

人们在这里告诉你的基本符号是：`s/PATTERN/REPLACEMENT/`

您的 PATTERN 是一个正则表达式，它可能包含括号中的部分。然后可以在命令的替换部分中引用这些部分。例如：

```
> echo "aabbcc" | sed 's/\(..\)\(..\)\(..\)/\2\3\1/'
bbccaa 
```

请注意，在 sed 版本中，我使用的是“基本”RE 方言的默认值，其中表达式中的括号需要转义。您可以在“扩展”方言中做同样的事情：

```
> echo "aabbcc" | sed -E 's/(..)(..)(..)/\2\3\1/'
bbccaa 
```

（在 GNU sed（您可以在 Linux 中找到）中，您可以使用`-r`选项而不是. 获得相同的结果`-E`。我使用的是 OS X。）

我应该说，对于您的任务，我肯定会遵循 Johnsyweb 的建议并使用 awk 而不是 sed。更容易理解。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T20:22:34.220

它应该工作：

```
sed -e 's~,~~4g' file.txt
```

删除第 4 个和下一个逗号

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T20:00:08.547

```
sed -e 's/(..),(..),(....)$/\1\2\3/' myfile.txt 
```

# c++ - 具有属性的对象可以为同一属性提供不同类型

> ID：10217025
> 
> 赞同：0
> 
> 时间：2012-04-18T19:57:55.480
> 
> 标签：c++, class, object

我正在尝试找出 c++ 程序的最佳方法：

我需要制作一个名为 Characteristic 的对象。这家伙有 4 个属性：
- 字符串名称（只是名称）
- ？类型（它是什么类型的特征。可以是数字或描述性的）
- ？范围（数字 - 最小和最大
描述性 - 选项）
- ？值（实际选择的值可能是 int 或 string，具体取决于类型）

如果我在 Java 中，我会创建一个有两个孩子的对象类型：Numeric 和 Descriptive。每个都有适当的范围并以适当的格式存储值。

两者的示例：
名称：温暖度
类型：数字
范围：最小 1 最大 5
值：2

名称：风格
类型：描述
范围：简约摄影
价值：简约

我不知道在 c++ 中执行此操作的最佳方法是什么。
我应该看模板吗？因为如果是这样，我无法弄清楚如何使用它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:11:01.503

如果你愿意，你可以做和 Java 一样的事情。

```
struct Type {
    std::string Name;
};

struct Numeric : Type {
    int value, min, max;
};

struct Descriptive : Type {
    std::string value, min, max;
}; 
```

然而，在您决定如何实现您的特性之前，您必须更好地定义您将如何使用它以及您想要的界面。例如，上面的内容并不便于将 Type 对象用作多态对象。您必须手动检查 Type 指针是否指向 Numeric 或 Descriptive 并采取相应措施。

* * *

获得多态性的一种方法是 C++ 是使用虚拟方法：

```
struct Type {
    ~Type() {} // virtual destructor
    virtual void do_something() = 0; // pure virtual function. Derived classes must provide an implementation
    std::string Name;
};

struct Numeric : Type {
    virtual void do_something() {
        std::cout << "Numeric value: " << value << " (" << min << ',' << max << ")\n"; 
    }
    int value, min, max;
};

struct Descriptive : Type {
    virtual void do_something() {
        std::cout << "Descriptive value: " << value << " (" << min << ',' << max << ")\n"; 
    }
    std::string value, min, max;
}; 
```

现在，当您调用`do_something`a时`Type *`，它会为动态类型找出正确的方法并调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:04:02.520

您可以在 C++ 中选择几种方法：

*   遗产。不仅仅是 Java 可以做到这一点。如果这是您在 Java 中使用的方法，我不明白为什么您不能在 C++ 中做同样的事情。
*   模板。这种方法对应于 Java 泛型。
*   工会。我认为没有对应的Java，可能值得研究。

如果没有进一步的细节，就不可能给出很好的论据，为什么你应该更喜欢其中一个。

# ruby-on-rails - 如何在不关闭站点的情况下在数据库中构建缓存的统计信息？

> ID：10217026
> 
> 赞同：0
> 
> 时间：2012-04-18T19:57:56.037
> 
> 标签：ruby-on-rails, database, caching

我正在开发一个 Ruby on Rails 网站。

为了提高性能，我想建立一些各种统计数据的缓存，以便将来显示它们时，我只需要显示缓存而不是拉所有数据库记录来计算这些统计数据。

例子：

一个模型用户有_很多评论。我想将他们有多少评论存储到用户缓存模型中。这样，当我需要显示用户发表的评论数量时，它只是对统计模型的简单查询。每次创建或销毁新评论时，它只会增加或减少计数器。

我如何在网站上线时构建这些统计信息？我担心的是，在我请求数据库计算用户拥有的评论数量之后，但在它能够执行命令将其保存到统计信息之前，该用户可能会潜入并在某处添加另一条评论。这将增加计数器，但随后立即被另一个线程覆盖，导致保存不正确的统计信息。

我熟悉 ActiveRecord 事务块，但据我了解，这些是为了保证所有或没有一个整体成功，而不是充当数据库上数据的互斥保护。

基本上有必要关闭网站以进行此类更改吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:50:59.053

您的用例已由 rails 处理。它被称为计数器缓存。这里有一个导轨：[http ://railscasts.com/episodes/23-counter-cache-column](http://railscasts.com/episodes/23-counter-cache-column)

由于它太旧了，它可能已经过时了。一般的想法是存在的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:01:14.960

混合应用程序和报告逻辑通常不是最佳实践。将您的报告数据发送到应用程序外部，或者发送到另一个数据库，发送到由守护进程读取的日志文件，或者发送到其他一些处理存储细节的 API。

如果这一切听起来工作量太大，那么您真的不需要实时报告。假设您有某种备份（热备份或冷备份），运行聚合并生成备份报告。这样它就不会影响正在运行的应用程序，并且您的数据不应超过 24 小时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:48:32.840

仅供参考，我想我在这里找到了解决方案：

[http://guides.ruby.tw/rails3/active_record_querying.html#5](http://guides.ruby.tw/rails3/active_record_querying.html#5)

我正在寻找的是所谓的悲观锁定，并在 2.10.2 中得到解决。

# bash - 您可以通过管道将 F 键回显到另一个程序吗？

> ID：10217029
> 
> 赞同：2
> 
> 时间：2012-04-18T19:58:03.447
> 
> 标签：bash, pipe, stdin

我正在尝试编写一个简短的 bash hack，它需要对 F 键进行管道击键，基本上我想要做的是：

```
(echo "1"; "for x in 1..9; do echo "123<F1>34<F3>"; done; echo "<F1>")|./program 
```

那个#的F键在哪里

这可能吗？如果是这样，有人可以将我指向文档或其他内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:02:41.963

根据您的终端，功能键只是一个字符序列。你可以看到它们是什么`cat`：

```
$ cat
^[OP
^[OQ
^[OR 
```

这是我按顺序按`F1`, `F2`, `F3`。因此，要将它们回显到您的程序中，您只需回显这些控制代码（注意第一个是`ctrl`- `ESC`），您应该已经准备好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:51:53.923

要扩展 zigdon 的答案，您可以使用`tput`为您的终端生成正确的序列：

```
f1=$(tput kf1)
f2=$(tput kf2)
# ...
(echo 1; for x in {1..9}; do echo "123${f1}34$f3"; done; echo "$f1") | ./program 
```

“kf1”和“kf2”名称分别是 F1 和 F2 键的[terminfo 功能](http://unixhelp.ed.ac.uk/CGI/man-cgi?terminfo+5)。

# asp.net-mvc-3 - 如何在 MVC 3 中创建属性“不需要”

> ID：10217040
> 
> 赞同：1
> 
> 时间：2012-04-18T19:58:46.237
> 
> 标签：asp.net-mvc-3, entity-framework-4.1

我是 asp.net MVC 的新手
，我的模型中的一些属性，尤其是类型的属性，默认情况下会`int`变成`required`没有用`[Required]`属性装饰它。但是，通过使填充的可为空 ie 来解决问题`int? Some property`。
但我不确定这是否是最好的方法......我也怀疑制作一个属性是否`nullable`会在以后的代码中产生一些问题。
任何建议都是非常值得赞赏的。
提前致谢 ！！！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:03:49.020

可以为空是可以的，但是在使用可能为空的值时需要格外小心。最简单的是使用合并空操作符 ??

```
var foo = myNullableField ?? new bar() 
```

如果可空字段实际上为空，则 foo 将被分配为一个新对象（在此示例中，您可以使用默认字符串、int 等）。如果它不为空，它将从 myNullableField 中获取值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:03:46.153

Nullable 是更可取的方法。这不是马虎。

# vb.net - vb.net 中的 Array.copy 方法

> ID：10217047
> 
> 赞同：-2
> 
> 时间：2012-04-18T19:59:17.143
> 
> 标签：vb.net, methods

```
 Public Shared Function EncryptRSA(ByVal infilename As String, ByVal outfilename As String, ByVal pubkey As String) As String
        Dim buffer2 As Byte()
        Dim buffer3 As Byte()
        Dim provider As New RSACryptoServiceProvider
        provider.FromXmlString(File.ReadAllText(pubkey))
        Dim sourceArray As Byte() = File.ReadAllBytes(infilename)
        Dim num As Integer = (sourceArray.Length / &H3A)
        Dim stream As FileStream = File.Create(outfilename)
        Dim num2 As Integer = 0

        For num2 = 0 To num - 1
            buffer2 = New Byte(&H3A - 1) {}
            Array.Copy(sourceArray, (num2 * &H3A), buffer2, 0, &H3A)
            buffer3 = provider.Encrypt(buffer2, True)
            stream.Write(buffer3, 0, buffer3.Length)
        Next num2
        If ((sourceArray.Length Mod &H3A) <> 0) Then
            buffer2 = New Byte((sourceArray.Length Mod &H3A) - 1) {}

            Array.Copy(sourceArray, ((sourceArray.Length / &H3A) * &H3A), buffer2, 0, (sourceArray.Length Mod &H3A))
            buffer3 = provider.Encrypt(buffer2, True)
            stream.Write(buffer3, 0, buffer3.Length)
        End If
        stream.Close()
        Return File.ReadAllText(outfilename)
    End Function 
```

错误 1 ​​重载解析失败，因为没有缩小转换就无法调用可访问的“副本”：“公共共享子副本（sourceArray As System.Array，sourceIndex As Long，destinationArray As System.Array，destinationIndex As Long，length As Long）” ：参数匹配参数“sourceIndex”从“Double”缩小到“Long”。'公共共享子副本（sourceArray As System.Array，sourceIndex As Integer，destinationArray As System.Array，destinationIndex As Integer，length As Integer）'：参数匹配参数 'sourceIndex' 从 'Double' 缩小到 'Integer'。C:\Users\user\AppData\Local\Temporary Projects\WindowsApplication1\Crypto.vb 52 13 WindowsApplication1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:14:19.493

你有这一行：

```
Array.Copy(sourceArray, ((sourceArray.Length / &H3A) * &H3A), buffer2, 0, (sourceArray.Length Mod &H3A)) 
```

编译器想要告诉您的是，您为 sourceIndex 提供了一个 double 值，但它期望一个 long 值。double 不能隐式转换为 long，因为 long 不能表示 double 的所有可能值。

明确地进行转换：

```
Array.Copy(sourceArray, CLng((sourceArray.Length / &H3A) * &H3A), buffer2, 0, (sourceArray.Length Mod &H3A)) 
```

# nlp - 为什么斯坦福主题建模工具箱不生成 lda-output 目录？

> ID：10217049
> 
> 赞同：1
> 
> 时间：2012-04-18T19:59:32.197
> 
> 标签：nlp, machine-learning, stanford-nlp, text-analysis, lda

我尝试[从 github](https://github.com/echen/sarah-palin-lda)（按照 1-2-3 步骤）运行此代码，该代码识别了 Sarah Palin 的 14,500 封电子邮件中的 30 个主题。作者发现的话题在[这里](https://github.com/echen/sarah-palin-lda/blob/master/lda-output/02500/summary.txt)。但是，Stanford Topic Modeling Toolbox 并没有为我生成 lda-output 目录。它生成了 lda-86a58136-30-2b1a90a6，但此文件夹中的 summary.txt 仅显示主题的初始分配，而不是最终主题。知道如何使用发现的主题的最终摘要生成 lda-output 目录吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:32:24.273

您是否尝试过[此处发布](https://github.com/echen/sarah-palin-lda/blob/master/README.md)的说明？

请注意，我看到最初的调查员使用 Sarah Palin 的电子邮件训练了模型，然后使用该训练过的模型来分析 Sarah Palin 的电子邮件。虽然我不是 LDA 专家，但这通常带有“找到你所拥有的东西”的味道。

在大多数学科中，培训将在一组已知的项目上进行，这些项目已由专家根据判别式进行分类。这意味着培训将包括从其他来源提供一组已知可能主题的数据，然后使用 LDA 库来确定与“学习”数据库中主题的距离。

无论如何，祝你好运。

如果您遇到特定问题，请发布错误，以及您为解决该错误而采取的步骤。很少有人会花时间尝试在没有方向的情况下重现问题（纠正问题的典型先决条件），甚至无法确定他们遇到的问题是否与您的问题相似。

# android - 用户打字时如何避免 EditText 上的多个触发器？

> ID：10217051
> 
> 赞同：24
> 
> 时间：2012-04-18T19:59:35.193
> 
> 标签：android, android-edittext

当用户输入 EditText 时，我使用以下代码执行搜索：

```
EditText queryView = (EditText) findViewById(R.id.querybox);
queryView.addTextChangedListener(new TextWatcher() {
  @Override
  public void afterTextChanged(Editable s) {
    triggerSearch(s.toString()); 
  }
  @Override
  public void beforeTextChanged(CharSequence s, int start, int count, int after) {
  }
  @Override
  public void onTextChanged(CharSequence s, int start, int before, int count) {
  }
}); 
```

但是，当用户键入一个单词时，这会触发多次。也就是说，如果用户键入“hello”，此代码将触发 5 次值（“h”、“he”、“hel”、“hell”、“hello”）。通常，这会很好，但触发搜索很昂贵，我不想将资源浪费在没有多大用处的中间搜索上。我想要的是在用户开始键入后仅触发某个阈值的侦听器，或者是某种框架，它在调用之前在侦听器中等待`triggerSearch`，如果在该等待之前触发了另一个事件，则会自行取消。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-19T09:00:58.960

由于找不到合适的事件接口，尝试触发延迟搜索。代码实际上非常简单和健壮。

```
private final int TRIGGER_SERACH = 1;
// Where did 1000 come from? It's arbitrary, since I can't find average android typing speed.
private final long SEARCH_TRIGGER_DELAY_IN_MS = 1000;

  private Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
      if (msg.what == TRIGGER_SERACH) {
        triggerSearch();
      }
    }
  };

 queryView.addTextChangedListener(new TextWatcher() {

   @Override
   public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {

   }

   @Override
   public void onTextChanged(CharSequence charSequence, int i, int i2, int i3) {

   }

   @Override
   public void afterTextChanged(Editable s) {
    handler.removeMessages(TRIGGER_SERACH);
    handler.sendEmptyMessageDelayed(TRIGGER_SERACH, SEARCH_TRIGGER_DELAY_IN_MS);
   }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T20:16:51.300

`onTextChanged`一种解决方案是不立即执行触发的搜索，而是在调用该方法后经过一段时间（例如 100 毫秒）后执行触发搜索。此外，每次键入文本时都会重置此间隔。

这样，在用户键入时不会调用触发的搜索。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T20:19:33.553

在调用之前在监听器中等待`triggerSearch`；测试 的长度`Editable s`。

`if(s.length() > THRESHOLD)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T21:50:50.210

如果您不想在按下的每个按钮上触发搜索，那么您需要知道用户何时完成。我会避免试图弄清楚用户何时完成输入的复杂想法。这将导致用户对搜索发生的时间感到困惑。

然后简单的答案是放置一个“完成”按钮并在按钮上应用一个 onClickListener 并在那里执行您的搜索。

最简单的代码：在xml中

```
<Button
android:onClick="onDoneClicked"
... the rest of your button layout
/> 
```

在java中：

```
@Override
public void onDoneClicked(View view){
EditText queryView = (EditText) findViewById(R.id.querybox);
triggerSearch(queryView.toString());
} 
```

# iphone - 在 UIScrollView 中滚动 CoreText

> ID：10217063
> 
> 赞同：1
> 
> 时间：2012-04-18T20:00:25.533
> 
> 标签：iphone, objective-c, ios, uiscrollview, core-text

我正在尝试使用 CoreText，我遇到的问题之一是内容不可滚动，并且不知道如何使其可滚动......使用标签此代码有效：

```
//Calculate the expected size based on the font and linebreak mode of your label
CGSize maximumLabelSize = CGSizeMake(300,9999);

CGSize expectedLabelSize = [labelText sizeWithFont:label.font
                                  constrainedToSize:maximumLabelSize 
                                      lineBreakMode:UILineBreakModeTailTruncation];

//adjust the label the the new height.
CGRect newFrame = label.frame;
newFrame.size.height = expectedLabelSize.height;
label.frame = newFrame; 
```

我的测试项目：[http ://dl.dropbox.com/u/47384598/AA_CoreText.zip](http://dl.dropbox.com/u/47384598/AA_CoreText.zip)

但是我应该如何处理 CoreText？任何帮助都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:41:36.433

您可能应该将您的 CoreText 帧呈现为`UIView`. 然后，将此作为子视图添加`UIView`到您的子视图中`UIScrollView`，并设置足够大以适合您持有 CoreText 的 UIView。`contentSize``UIScrollView``contentSize`

请注意，如果 的`contentSize`小于`UIScrollView`屏幕上视图的大小，则不需要滚动。

# java - Java中的领域事件模式实现？

> ID：10217065
> 
> 赞同：7
> 
> 时间：2012-04-18T20:00:36.440
> 
> 标签：java, design-patterns, domain-driven-design, domain-events

我正在寻找 Udi Dahan 的域事件模式和基础设施的简单 Java 实现，如[本文所述](http://www.udidahan.com/2009/06/14/domain-events-salvation/)。

这很简单，我已经实现了自己的解释，但是我是 Java 新手，不想因为缺乏语言经验而被任何错误所困扰。

我发现的唯一 Java 实现是在[Jdon Framework](http://www.jdon.org/)中，但对于我目前的项目来说，它有点过于重量级了。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T08:59:45.567

一段时间以来，我一直在寻找 Java EE 中相同问题的解决方案。我查看了[Axon](http://www.axonframework.org/)和[jdon](http://www.jdon.org/)（该页面也不是很好的预兆 :)）。两者都涉及事件采购，我无法将其“出售”给我的雇主/客户。不过，我想拥有领域事件，因为我在 .NET/C# 项目中非常习惯它们。所以我想出了以下...

我使用了一个类似的静态 DomainEvents 对象来让我访问发布机制，而实际的实现细节不会泄漏到我的域模型实体中。所以调用是这样的：

```
DomainEvents.fire(new MySampleEvent(...some params...)); 
```

CDI 规范中可用的模式和机制是[带有 @Observes 的事件，](http://docs.oracle.com/javaee/6/tutorial/doc/gkhic.html)它允许您使用所有可用服务响应普通 bean 中的某些事件。这类似于我在使用诸如[Castle Windsor](http://docs.castleproject.org/Windsor.MainPage.ashx)之类的 DI 框架时所习惯的，我可以通过接口注册通用处理程序。所以我已经涵盖了观察者（处理程序、侦听器，无论你想怎么称呼他们）。例子：

```
@Stateless
public class MySampleEventObserver {

  public void listen(@Observes MySampleEvent event) {
    ...
    doSomethingWithEvent();
  }
} 
```

现在是发布（在 CDI 中触发）部分。由于无法访问实体中的 CDI（有充分的理由！）我决定使用 JNDI 和[BeanManager](http://docs.oracle.com/javaee/6/api/javax/enterprise/inject/spi/BeanManager.html)。我使用 JNDI 来获取 BeanManager 并使用它的[fireEvent](http://docs.oracle.com/javaee/6/api/javax/enterprise/inject/spi/BeanManager.html#fireEvent)方法。将 bean 管理器解析（如此[处所示](https://stackoverflow.com/questions/10765508/cdi-injection-in-entitylisteners)）放入代码中：

```
public class BeanHelper {
  public static BeanManager getBeanManager() {
    try {
        InitialContext initialContext = new InitialContext();
        return (BeanManager) initialContext.lookup("java:comp/BeanManager");
    } catch (NamingException e) {
        e.printStackTrace();
        return null;
    }
  } 
```

}

最后一步是 DomainEvents 对象本身：

```
public class DomainEvents {

  private static boolean mNopMode = false;

  public static void setNopMode() {
    mNopMode = true;
  }

  public static void reset() {
    mNopMode = false;
  }

  public static <TDomainEvent> void fire(TDomainEvent event) {
    if (mNopMode) {
        return;
    }
    BeanManager manager = BeanHelper.getBeanManager();

    manager.fireEvent(event);
  } 
```

}

当没有上下文时，`setNopMode`and部分用于测试目的。`reset`基本上是手动模拟。在单元测试之前将其设置为 NOP 操作模式并在它们之后重置。

作为 POC 工作正常。不知道它的使用是否有任何严重的限制。我留下了异步总线交互，类似于监听器的实现。

希望有任何评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:18:58.553

我目前正在考虑使用 Google 的[Guava EventBus](http://code.google.com/p/guava-libraries/wiki/EventBusExplained)来做类似于您参考的“拯救”文章的事情。

使用它类似于“如何引发域事件”看起来像这样，几乎与文章完全相同：

```
public class Customer
{
    public void DoSomething()
    {
        MyEventBus.post(new CustomerBecamePreferred() { Customer = this });
    }
} 
```

我不知道您是否认为这是“Udi Dahan 的领域事件模式的实现”。

它不需要实现任何接口；事件处理程序标有注释，并且类在 EventBus 中注册`MyEventBus.register(aListenerObject)`

# python - 实现一个完整的 Python Unix 风格的守护进程

> ID：10217067
> 
> 赞同：3
> 
> 时间：2012-04-18T20:00:39.433
> 
> 标签：python, unix, daemon

我目前正在尝试手动创建一个简单的守护进程，我不想使用现有的外部库来避免开销。

我目前正在检查我的进程何时运行，它尚未创建 PID 文件（意味着它正在运行），如[本文](https://stackoverflow.com/q/10216402/1332690)所述。

我还有一个**守护进程**模块，用于从当前进程中分离 PID 并重定向 stdout 和 stderr（因此即使我结束会话，我的守护进程也会继续运行）：

```
import os
import sys

def daemonize(stdin="/dev/null", stdout="/dev/null", stderr="/dev/null"):
    try: 
        pid = os.fork() 
        if pid > 0:
            sys.exit(0)
    except OSError, e: 
        sys.stderr.write ("fork #1 failed: (%d) %s\n" % (e.errno, e.strerror) )
        sys.exit(1)

    os.chdir("/") 
    os.umask(0) 
    os.setsid() 

    try: 
        pid = os.fork() 
        if pid > 0:
            sys.exit(0)
    except OSError, e: 
        sys.stderr.write ("fork #2 failed: (%d) %s\n" % (e.errno, e.strerror) )
        sys.exit(1)

    stdin_par = os.path.dirname(stdin)
    stdout_par = os.path.dirname(stdout)
    stderr_par = os.path.dirname(stderr)
    if not stdin_par:
        os.path.makedirs(stdin_par)
    if not stdout_par:
        os.path.makedirs(stdout_par)
    if not stderr_par:
        os.path.makedirs(stderr_par)

    si = open(stdin, 'r')
    so = open(stdout, 'a+')
    se = open(stderr, 'a+', 0)
    os.dup2(si.fileno(), sys.stdin.fileno())
    os.dup2(so.fileno(), sys.stdout.fileno())
    os.dup2(se.fileno(), sys.stderr.fileno()) 
```

所以目前我可以像下面的示例行一样运行我的进程，它将正确运行我的守护进程：

```
>$ python myapp.py 
```

但要停止它，我必须 grep PID（或从锁定文件中获取）并在以下操作后手动擦除 PID：

```
>$ ps -ef | grep myapp
xxxxx  11901     1  0 19:48 ?        00:00:00 python src/myapp.py
xxxxx  12282  7600  0 19:54 pts/7    00:00:00 grep myapp
>$ kill -9 11901
>$ rm -rf /path/to/lock.pid 
```

我想要一个更像 Unix 的守护进程，我可以使用以下命令管理守护进程生命周期：

```
>$ python myapp.py start
>$ python myapp.py stop
>$ python myapp.py restart 
```

我当然可以用这个`argparse`模块来做，但这似乎有点乏味和丑陋。

你知道在 Python 中拥有一个 Unix 风格的守护进程的简单而优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T20:24:53.783

在看了更多之后，我在[这里](http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/)找到了一个很好的例子。

它使用一个泛型`Daemon`类，之后可以对其进行子类化：

```
#!/usr/bin/env python

import sys, os, time, atexit
from signal import SIGTERM

class Daemon:
        """
        A generic daemon class.

        Usage: subclass the Daemon class and override the run() method
        """
        def __init__(self, pidfile, stdin='/dev/null', stdout='/dev/null', stderr='/dev/null'):
                self.stdin = stdin
                self.stdout = stdout
                self.stderr = stderr
                self.pidfile = pidfile

        def daemonize(self):
                """
                do the UNIX double-fork magic, see Stevens' "Advanced
                Programming in the UNIX Environment" for details (ISBN 0201563177)
                http://www.erlenstar.demon.co.uk/unix/faq_2.html#SEC16
                """
                try:
                        pid = os.fork()
                        if pid > 0:
                                # exit first parent
                                sys.exit(0)
                except OSError, e:
                        sys.stderr.write("fork #1 failed: %d (%s)\n" % (e.errno, e.strerror))
                        sys.exit(1)

                # decouple from parent environment
                os.chdir("/")
                os.setsid()
                os.umask(0)

                # do second fork
                try:
                        pid = os.fork()
                        if pid > 0:
                                # exit from second parent
                                sys.exit(0)
                except OSError, e:
                        sys.stderr.write("fork #2 failed: %d (%s)\n" % (e.errno, e.strerror))
                        sys.exit(1)

                # redirect standard file descriptors
                sys.stdout.flush()
                sys.stderr.flush()
                si = file(self.stdin, 'r')
                so = file(self.stdout, 'a+')
                se = file(self.stderr, 'a+', 0)
                os.dup2(si.fileno(), sys.stdin.fileno())
                os.dup2(so.fileno(), sys.stdout.fileno())
                os.dup2(se.fileno(), sys.stderr.fileno())

                # write pidfile
                atexit.register(self.delpid)
                pid = str(os.getpid())
                file(self.pidfile,'w+').write("%s\n" % pid)

        def delpid(self):
                os.remove(self.pidfile)

        def start(self):
                """
                Start the daemon
                """
                # Check for a pidfile to see if the daemon already runs
                try:
                        pf = file(self.pidfile,'r')
                        pid = int(pf.read().strip())
                        pf.close()
                except IOError:
                        pid = None

                if pid:
                        message = "pidfile %s already exist. Daemon already running?\n"
                        sys.stderr.write(message % self.pidfile)
                        sys.exit(1)

                # Start the daemon
                self.daemonize()
                self.run()

        def stop(self):
                """
                Stop the daemon
                """
                # Get the pid from the pidfile
                try:
                        pf = file(self.pidfile,'r')
                        pid = int(pf.read().strip())
                        pf.close()
                except IOError:
                        pid = None

                if not pid:
                        message = "pidfile %s does not exist. Daemon not running?\n"
                        sys.stderr.write(message % self.pidfile)
                        return # not an error in a restart

                # Try killing the daemon process       
                try:
                        while 1:
                                os.kill(pid, SIGTERM)
                                time.sleep(0.1)
                except OSError, err:
                        err = str(err)
                        if err.find("No such process") > 0:
                                if os.path.exists(self.pidfile):
                                        os.remove(self.pidfile)
                        else:
                                print str(err)
                                sys.exit(1)

        def restart(self):
                """
                Restart the daemon
                """
                self.stop()
                self.start()

        def run(self):
                """
                You should override this method when you subclass Daemon. It will be called after the process has been
            daemonized by start() or restart().
                """ 
```

拥有此模块后，您可以执行以下操作以拥有守护程序的所有不同模式：

```
#!/usr/bin/env python

import sys, time
from daemon import Daemon

class MyDaemon(Daemon):
        def run(self):
                while True:
                        time.sleep(1)

if __name__ == "__main__":
        daemon = MyDaemon('/tmp/daemon-example.pid')
        if len(sys.argv) == 2:
                if 'start' == sys.argv[1]:
                        daemon.start()
                elif 'stop' == sys.argv[1]:
                        daemon.stop()
                elif 'restart' == sys.argv[1]:
                        daemon.restart()
                else:
                        print "Unknown command"
                        sys.exit(2)
                sys.exit(0)
        else:
                print "usage: %s start|stop|restart" % sys.argv[0]
                sys.exit(2) 
```

希望能帮助遇到同样问题的其他人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:14:28.523

为了简化向守护进程发出信号的过程，我们在工作中使用以下函数：

```
def set_procname(name):
    import ctypes
    lc = ctypes.cdll.LoadLibrary("libc.so.6")
    lc.prctl(15, name[:15]) 
```

然后，守护进程可以使用它：

```
set_procname("foo") 
```

然后我们就可以`pkill foo`发送`TERM`信号了。这**不是**一个正确的答案，但它可能很有用。但是，该`set_procname()`功能有一些限制：

*   它仅适用于 Linux 内核。
*   进程名称最多只能使用 15 个字符。
*   如果您启动同一个守护进程的多个实例，`pkill`将向它们发出信号。

# php - 在 PHP 中从 HTTP Get 接收 JSON 对象

> ID：10217068
> 
> 赞同：4
> 
> 时间：2012-04-18T20:00:41.970
> 
> 标签：php, json, http

我正在尝试实现一个 php 客户端，它将一个 HTTP GET 发送到服务器，该服务器发送一个带有返回信息的 JSON 对象。一旦我的 php 脚本收到它，我就知道如何解码 JSON，但是我将如何实际获取它呢？

* * *

编辑：注意 - 我向服务器发送一个 HTTP GET，它会生成并发送回一个 JSON 文件。它不是位于服务器上的文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T20:03:24.823

查看[file_get_contents](http://us.php.net/manual/en/function.file-get-contents.php)

```
$json = file_get_contents('http://somesite.com/getjson.php'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:14:50.077

浏览器根据服务器的响应采取不同的行动。您向服务器发出什么类型的请求（GET、POST 等）并不重要，但要返回 JSON 作为响应，您必须在发出请求的脚本中设置标头：

```
header('Content-Type: application/json;charset=utf-8;'); 
```

然后回显 JSON 字符串，例如：

```
//...populating your result data array here...//
// Print out the JSON formatted data
echo json_encode($myData); 
```

然后，用户代理将获取 JSON 字符串。如果 AJAX 发出请求，那么您可以简单地将结果解析为您可以处理的 JavaScript 对象，如下所示：

```
//...AJAX request here...//
// Parse result to JavaScript object
var myData=JSON.parse(XMLHttp.responseText); 
```

标头本身并不是真正必要的，但它是一种很好的做法。JSON.parse() 无论如何都可以解析响应。

# tfs - 如何设置类似于我当前的 NAnt 流程的 TFS 2010 工作流构建流程

> ID：10217073
> 
> 赞同：1
> 
> 时间：2012-04-18T20:00:57.757
> 
> 标签：tfs, msbuild, workflow, tfsbuild

我有一个构建过程在 NAnt 中，类似于以下结构（很多已被缩写）。我对可以从我的 NAnt 脚本中放入 Workflow 的内容以及应该转换为 MSBuild（或不转换）的内容有些困惑。NAnt 脚本中的各种目标将设置属性、复制文件、删除文件、调用外部进程（例如编译 VB6 项目）。任何将其移植到工作流的提示将不胜感激。如果您有任何问题，请告诉我。

```
<?xml ... >
<project ...>

  <!-- Get and combine paths -->
  <properties name="" value=""/>
  <properties name="" value=""/>
  <properties name="" value=""/>
  .
  .
  .
  . 

  <target name="Main">
   <!--Set Log Folder Name to include date and time.
   <mkdir dir="${LogDir}"/>

   <call target="DeleteTicketsFile"/> 
   <call target="GetTickets"/> 
   <call target="WriteTicketsToFile"/> 
   <call target="WriteProperties"/> 
   <call target="DeleteFolders" failonerror="true"/> 
   <call target="GetLatest" failonerror="true"/>
   <call target="BuildDOTNETSolution" failonerror="true"/>
   <call target="BuildVB6Projects" failonerror="true"/>
   . 
   .
   .
  <target name="BuildDOTNETSolution">

    <property name="ProjectName" value="Localcache" />

    <echo message="VCVarsAllBatFile = ${VCVarsAllBatFile}"/>
    <exec program="${VCVarsAllBatFile}"/>

    <property name="dotnetSlnFile" value="${path::combine(ProductDir, 'dot.net.sln')}"/>
    <property name="dotnetOutFile" value="${path::combine(LogDir, 'dotnet.out.txt')}"/>

    <echo message="dotnetSlnFile = ${dotnetSlnFile}"/>
    <echo message="dotnetOutFile = ${dotnetOutFile}"/>

    <delete file="${dotnetOutFile}" if="${file::exists(dotnetOutFile)}" failonerror="false"/>

    <!-- Build .NET solution in Release mode -->
    <exec program="${DevenvExe}">
      <environment>
        <variable name="COMSUPPORT" value="N"/>
        <variable name="COPYEXECENV" value="N"/>
      </environment>
      <arg value='"${dotnetSlnFile}"'/>
      <arg value='/Rebuild "Release|Any CPU"'/>
      <arg value='/Out "${dotnetOutFile}"'/>
    </exec>
  </target>

</project> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:27:33.773

我的建议是完全替换 NAnt 并使用 TFS Build Workflow 来自定义和维护您的构建。也就是说，如果您的 NAnt 脚本非常复杂，可能需要一些时间（尤其是如果您不熟悉基于 TFS 工作流的构建）。我的建议是让 Workflow Build 使用 InvokeProcess Activity 通过命令行 (nant.exe) 执行 NAnt 构建。然后，您可以逐步将 NAnt 脚本中的构建部分移到工作流中。

例如，整个 BuildDotNETSolution 目标看起来并没有做任何特别的事情，所有这些都已包含在 DefaultTemplate.xaml 构建工作流中，您只需在构建定义中指定 SolutionsToBuild 参数。

# solr - 在 Solr 中，SynonymFilterFactory 扩展与分隔符 + WordDelimiterFilterFactory => 奇怪的结果查询

> ID：10217081
> 
> 赞同：0
> 
> 时间：2012-04-18T20:01:27.447
> 
> 标签：solr, lucene

这是我的查询分析器定义：

```
<tokenizer class="solr.WhitespaceTokenizerFactory"/>
<filter class="solr.SynonymFilterFactory" synonyms="companysyns.txt" ignoreCase="true" expand="true"/>
<filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="0"/>
<filter class="solr.LowerCaseFilterFactory"/> 
```

在“companysyncs.txt”中，我对典型的公司词进行了一些扩展，如下所示：

```
inc, inc., incorporated 
```

当我发送这样的查询时：

```
test:"some company inc" 
```

我在 solr 调试中看到了这个意想不到的结果：

```
<str name="rawquerystring">test:"some company inc"</str>
<str name="querystring">test:"some company inc"</str>
<str name="parsedquery">
MultiPhraseQuery(test:"some company inc (inc incorporated)")
</str>
<str name="parsedquery_toString">test:"some company inc (inc incorporated)"</str> 
```

与“Some Company, Inc.”不匹配。但是，如果我删除`WordDelimiterFilterFactory`, 那么对于相同的查询，我会看到：

```
<str name="rawquerystring">test:"some company inc"</str>
<str name="querystring">test:"some company inc"</str>
<str name="parsedquery">
MultiPhraseQuery(test:"some company (inc inc. incorporated)")
</str>
<str name="parsedquery_toString">test:"some company (inc inc. incorporated)"</str> 
```

这确实匹配。

如果我保留`WordDelimiterFilterFactory`，但删除“inc”。来自同义词的条目（带有句点的那个），那么它也可以：

```
<str name="rawquerystring">test:"some company inc"</str>
<str name="querystring">test:"some company inc"</str>
<str name="parsedquery">
MultiPhraseQuery(test:"some company (inc incorporated)")
</str>
<str name="parsedquery_toString">test:"some company (inc incorporated)"</str> 
```

知道为什么`WordDelimiterFilterFactory`要搞乱同义词扩展查询吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:29:44.520

WordDelimiterFilterFactory 删除 inc 中的点。更改过滤器的顺序，它应该可以正常工作：

```
 <tokenizer class="solr.WhitespaceTokenizerFactory"/>
<filter class="solr.LowerCaseFilterFactory"/>
<filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="0"/>
<filter class="solr.SynonymFilterFactory" synonyms="companysyns.txt" ignoreCase="true" expand="true"/> 
```

# ios - 在 iOS 开发的上下文中，什么是配置 / makefile 脚本的好书或参考？

> ID：10217082
> 
> 赞同：2
> 
> 时间：2012-04-18T20:01:29.223
> 
> 标签：ios, scripting, build, makefile, configure

我的 C 和 Objective-C 技能还可以，但我真的可以更好地掌握使用 configure 和 make 文件构建二进制文件和库。有没有我应该看的书或综合参考资料。我已经用谷歌搜索了，但考虑到搜索词的通用性和大量相关信息，如果有人能指出我推荐的来源，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T11:18:53.743

[autoconf 手册](http://www.gnu.org/software/autoconf/manual/autoconf.html)是有关编写配置脚本的权威信息来源，其中包括有关可移植“make”和 shell 编程的部分。除了作为参考，它还包含一个*合理*的教程。

如果你也想构建库，那么你想看看[libtool](http://www.gnu.org/software/libtool/)，但不幸的是 libtool 可能有点难以使用，除非你也在使用[automake](http://www.gnu.org/software/automake/)，所以这变成了一个相当长的阅读列表。

O'Reilly 有一本书叫“Autotools”。我不知道，但鉴于我对其他 O'Reilly 书籍的经验，这是我第一次从书架上拿下来浏览。

# sql - 如何创建数据库模式以允许使用 EF 进行表继承

> ID：10217084
> 
> 赞同：0
> 
> 时间：2012-04-18T20:01:30.947
> 
> 标签：sql, entity-framework

我正在尝试使用多个类似类型的表来布局数据库。考虑一个简化的兽医系统。我有以下表格：

*   小狗
*   猫
*   鸟类
*   拥有者

我的一个限制是每个所有者只能拥有一只宠物。我想保持参照完整性，但不想让我的 Owners 表有三列专用于外键（因为我可能需要在某些时候添加更多的宠物种类）。

此外，在使用实体框架时，我希望将实体设置为像 Owner.Pet 一样简单的链接，并让底层机制处理决定它需要从哪个表中提取。

我想出了一种方法来完成第二部分，但它充其量是混乱的。有没有人尝试过这样的事情并且幸运地提出了一个有点优雅的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:17:27.240

对于 TPT 继承，您将创建一个`Pet`使用 ID PK 调用的表。

然后，您将创建一个名为`Cat`PK的第二个表，该表*既是*PK 又是 FK 到`Pet`.

完成此操作后，您现在可以[使用这些步骤创建 TPT 模型](http://www.robbagby.com/entity-framework/entity-framework-modeling-table-per-type-inheritance/)。

# php - CakePHP：在模型中使用搜索逻辑进行分页

> ID：10217087
> 
> 赞同：0
> 
> 时间：2012-04-18T20:01:43.077
> 
> 标签：php, cakephp, pagination, cakephp-model

我在对搜索结果进行分页时遇到问题。我的设置如下。

我有一个`myapp.com/searches/products`带有视图的搜索表单（有搜索表单）`.../app/views/searches/products.ctp`。我正在使用一个`Searches`控制器，该控制器将`Product`模型用于此搜索查询。`Product`具有`search()`搜索逻辑 ( `$this->find(...)`) 的作用。搜索结果显示在视图中的表单下方。

我该如何执行类似于`$this->paginate()`通常在控制器中完成的操作？此外，我想知道我的设置是否有问题，尤其是包含表单和搜索结果的视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:38:12.700

将搜索逻辑保留在模型中并仍然在控制器中分页的一种方法是执行以下操作：

**解释：**

而不是从模型返回实际**结果**，只需返回任何/所有 find **options**，然后像往常一样进行分页。`find()`对于一些示例，例如下面这个简单的示例，它可能看起来有点矫枉过正，但它为您的like `contain`, `order`, `group`, `joins`, ... 等添加更多选项留下了空间`conditions`。并且更符合“Fat Models,瘦身控制器”的口头禅。

使用这样的选项设置您`find()`的 s 也很不错，因此它可以在您的整个站点中轻松重复使用 - 只需传递不同的选项，您就可以开始了。

**代码：**

```
/* CONTROLLER
*/
$opts = array('paginate' => true, 'limit'=>20);
$paginateOptions = $this->Event->getEvents($opts);
$this->paginate = $paginateOptions;
$data = $this->paginate('Event');

/* MODEL
*/
public function getProducts($opts = null) {

    $params = array();

    //limit
    $params['limit'] = 50; //default
    if(!empty($opts['limit'])) $params['limit'] = $opts['limit'];

    //paginate option
    $paginate = false;
    if(isset($opts['paginate'])) {
        if($opts['paginate']) $paginate = true;
    }

    //either return the options just created (paginate)
    if($paginate) {
        return $qOpts;

    //or return the events data
    } else {
        $data = $this->find('all', $qOpts);
        return $data;
    }
} 
```

有一些方法可以编写更苗条/更少的代码行 - 但我喜欢这样写，所以它很快就可以理解。

（您的整体结构似乎没有任何问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T06:27:48.497

我通常使用将搜索参数存储在会话中并处理控制器操作中的所有内容。

```
function indexbystatus() {
    $this->set('title_for_layout','List Assets by Status');
    $this->Session->write('sender',array('controller'=>'assets','action'=>'indexbystatus'));
    $searchkey=$this->Session->read('Searchkey.status');
    $conditions='';
    if($searchkey) {
        $conditions=array('Asset.status_id'=>$searchkey);
    }
    if(!empty($this->data)) {
        // if user has sent anything by the searchform set conditions and
        // store it to the session but if it is empty we delete the stored
        // searchkey (this way we can reset the search)
        if($this->data['Asset']['status_id']!='') {
            $conditions=array('Asset.status_id'=>$this->data['Asset']['status_id']);
            $this->Session->write('Searchkey.status',$this->data['Asset']['status_id']);
        } else {
            $this->Session->delete('Searchkey.status');
            $conditions=null;
        }
    } else if($searchkey) {
        // if no data from the searchform we set the stored one
        // from the session if any
        $this->data['Asset']['status_id']=$searchkey;
    }
    $this->paginate=array(
                        'limit'=>25,
                        'order'=>array('Asset.status_id'=>'asc'),
                        'conditions'=>$conditions,
                        );
    $this->set('assets',$this->paginate());
    $statuses=$this->Asset->Status->find('list');
    $this->set('statuses',$statuses);
} 
```

我只是更喜欢在控制器动作而不是模型中处理它，所以我可以通过动作有不同的解决方案和逻辑。

# jquery - 你如何建造这个？

> ID：10217092
> 
> 赞同：0
> 
> 时间：2012-04-18T20:02:14.957
> 
> 标签：jquery, html, css, slider

我刚刚进入 jquery 并慢慢学习它（我知道，很惭愧），作为一名网页设计师，我发现它的使用非常重要。

现在我正试图弄清楚如何构建一个滑块，如下所示： http: [//karmalooptv.com](http://karmalooptv.com)

我查看了源代码，但由于该站点托管在 drupal 上，因此此滑块需要许多不必要的脚本和样式才能正常工作，而我的需要可能不需要这些脚本和样式。

我不明白它如何在屏幕上拉伸并循环显示图像，当它到达左侧或右侧的最后一张幻灯片时，它会用第一张/最后一张图像填充它并继续前进。

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:11:05.103

您需要几种技术：

1.  首先，一个带有溢出隐藏的 div 就像一个隐藏在它之外的所有东西的相框。
2.  其次，一个较长的 div 并排包含所有图像。这个 div 将在您的溢出隐藏 div 内，并且高度相同。
3.  你的内容 div 只会向后移动它的 x 位置，直到它到达最后一张幻灯片。
4.  然后，当您到达最后一张幻灯片时，您交换第一张和最后一张并立即移动内容 div，以便再次显示最后一张幻灯片。这就是您获得连续效果的方式。

#3 中的所有动画都是渐变的，因此您可以获得滚动效果。#4 的变化是瞬时的，所以用户不会知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:59:16.663

我创建了这个 jsFiddle 来帮助你：http: [//jsfiddle.net/QEVqN/7/](http://jsfiddle.net/QEVqN/7/)

滑块具有原始功能。让我解释一下我在做什么：1）可见的幻灯片和进入的幻灯片是唯一需要动画的，2）当我们向左或向右导航时，将进入的幻灯片对齐到正确的位置（右或左）和用右侧或左侧的可见动画对其进行动画处理

如果有很多（可能是 100 个）幻灯片，您不必为所有幻灯片设置动画，并且您可以获得圆形效果。通常，您将为包含所有幻灯片的 div 设置 overflow:hidden，但我没有这样做，因此您可以看到它背后发生了什么。这是溢出：隐藏的[http://jsfiddle.net/QEVqN/6/](http://jsfiddle.net/QEVqN/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:13:43.033

查看这里提到的一些幻灯片：http: [//slodive.com/freebies/best-jquery-slideshow-gallery-plugins/](http://slodive.com/freebies/best-jquery-slideshow-gallery-plugins/)

这也是一个不错的： [http ://slidesjs.com/](http://slidesjs.com/)

大多数 jQuery 插件允许您自定义循环行为，但它们都有不同的语法。

在您发布的示例中，他们能够通过设置元素的宽度（990 像素）和高度（554 像素）CSS 属性来在屏幕上拉伸图像。

# ruby-on-rails - Rails 应用程序说找不到用户路线，应该可以工作

> ID：10217093
> 
> 赞同：0
> 
> 时间：2012-04-18T20:02:24.863
> 
> 标签：ruby-on-rails, rails-routing

我在使用自定义授权登录现有应用时遇到问题。当我登录时，我收到错误

```
No route matches {:action=>"show", :controller=>"users", :locale=>#<User id: 4, first_name: "asd", last_name: "asd", email: "c@c.com", password_digest: "$2a$10$FDkc/CkjbwS455r/s.OF9uXUzuRmzz3zsYEejij.0KCT...", access_level: 3, last_login 
```

这是我的路线文件

```
Islasdelsol::Application.routes.draw do
  scope ":locale", locale: /#{I18n.available_locales.join("|")}/ do
    root :to => 'sites#index'
    get "logout" => "sessions#destroy", :as => "logout"
    get "login" => "sessions#new", as: "login"

    resources :sites, except: [:new, :show, :destroy, :create] do
      collection do
      get :about_us
      get :contact_us
      get :news
      get :reservations
      get :sell
      get :tour
    end
  end

resources :users do
  collection do
    get :monthly_letter
    get :admin
    get :regime
    get :general_assembly
    get :monthly_record
    get :newowner
    get :financial_report
    get :email_owners
  end
end

resources :email_owners do
  collection do
    get :email
    get :islas
    post :email
    post :islas
  end
end

resources :regimes do
  collection do
    get :spanish
    get :english
  end
end

resources :general_assemblies do
  collection do
    get :spanish
    get :english
  end
end
resources :sessions
resources :monthly_letters
resources :monthly_records

resources :financial_reports do
  collection do
    get :monthly
    get :yearly
  end
  end
  match "*path", to: "sites#not_found" # handles /en/fake/path/whatever
end
root to: redirect("/#{I18n.default_locale}") # handles /
match '*path', to: redirect("/#{I18n.default_locale}/%{path}")
end 
```

这是我的会话控制器和表单，呼叫来自哪里

```
class SessionsController < ApplicationController
  def create
  user = User.find_by_email(params[:email])
  if user && user.authenticate(params[:password])
    session[:user_id] = user.id
    redirect_to user, :notice => "Logged in!"
  else
    flash.now.alert = "Invalid email or password"
    render "new"
  end
end 
```

形式

```
<%= form_tag sessions_path do %>
<table>
    <tr>
        <td><label for="email">Email</label></td>
    </tr>
    <tr>
        <td><%= text_field_tag :email, params[:email] %> </td>
    </tr>
    <tr>
        <td>Password</td>
    </tr>
    <tr>
        <td><label for="password"><%= password_field_tag :password %>   </label></td>
    </tr>
    <tr> 
        <td><%= submit_tag "Log in" %> </td>
    </tr>
</table>
<% end %>

def destroy
  session[:user_id] = nil
  redirect_to root_url, :notice => "Logged out!"
end

end 
```

而我的 rake 路由控制器 = 用户

```
monthly_letter_users GET    /:locale/users/monthly_letter(.:format)   {:locale=>/en|es/, :action=>"monthly_letter", :controller=>"users"}
admin_users GET    /:locale/users/admin(.:format)            {:locale=>/en|es/, :action=>"admin", :controller=>"users"}
regime_users GET    /:locale/users/regime(.:format)           {:locale=>/en|es/, :action=>"regime", :controller=>"users"}
general_assembly_users GET    /:locale/users/general_assembly(.:format) {:locale=>/en|es/, :action=>"general_assembly", :controller=>"users"}
monthly_record_users GET    /:locale/users/monthly_record(.:format)   {:locale=>/en|es/, :action=>"monthly_record", :controller=>"users"}
newowner_users GET    /:locale/users/newowner(.:format)         {:locale=>/en|es/, :action=>"newowner", :controller=>"users"}
financial_report_users GET    /:locale/users/financial_report(.:format) {:locale=>/en|es/, :action=>"financial_report", :controller=>"users"}
email_owners_users GET    /:locale/users/email_owners(.:format)     {:locale=>/en|es/, :action=>"email_owners", :controller=>"users"}
users GET    /:locale/users(.:format)                  {:locale=>/en|es/, :action=>"index", :controller=>"users"}
POST   /:locale/users(.:format)                  {:locale=>/en|es/, :action=>"create", :controller=>"users"}
new_user GET    /:locale/users/new(.:format)              {:locale=>/en|es/, :action=>"new", :controller=>"users"}
edit_user GET    /:locale/users/:id/edit(.:format)         {:locale=>/en|es/, :action=>"edit", :controller=>"users"}
user GET    /:locale/users/:id(.:format)              {:locale=>/en|es/, :action=>"show", :controller=>"users"}
PUT    /:locale/users/:id(.:format)              {:locale=>/en|es/, :action=>"update", :controller=>"users"}
DELETE /:locale/users/:id(.:format)              {:locale=>/en|es/, :action=>"destroy", :controller=>"users"} 
```

那么，谁能看出问题出在哪里？似乎有一条通往用户显示页面的路线...

**编辑：用户控制器**

```
class UsersController < ApplicationController
  helper_method :sort_column, :sort_direction
  def index
    @owners = User.owners.search(params[:search]).order(sort_column + " " +      sort_direction).page(params[:page]).per_page(5)

  end

  def new
    @user = User.new
  end

  def show
    @user = User.find(params[:id])
    @monthly_letters = MonthlyLetter.recent
  end 

   def create
 @user = User.new(params[:user])
    if @user.save
      flash[:notice] = 'User Created!'
      redirect_to @user
    else
      flash[:alert] = "User has not been created."
     render "index"
   end 
  end

  def destroy
    @user = User.find(params[:id])
    @user.destroy
    flash[:notice] = "User has been deleted."
    redirect_to current_user
  end

  def update
    @user = User.find(params[:id])

    if @user.update_attributes(params[:user])
      flash[:notice] = "User has been updated."
      redirect_to @user
    else 
      flash[:alert] = "User has not been updated."
      render :action => "edit"
    end
  end

  def monthly_letter
    @monthly_letter = MonthlyLetter.new
  end 
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T16:22:35.230

这里的问题是 url_for 不知道如何处理 :locale 参数。

您可以知道错误中发生了什么，因为它说 :locale 参数是一个对象 #<User>。它应该像其他参数一样是一个字符串。这通常意味着使用不正确或不完整的参数调用您的 link_to/url_for。

The first step to solving this is probably to set a default for the :locale parameter in your application controller. [Rails Guide's i18n document](http://guides.rubyonrails.org/i18n.html#setting-the-locale-from-the-url-params) provides guidance for that as well as more complete solutions of looking at HTTP headers and parameters.

# c# - 通过双击 mp3 文件运行在 c# 中创建的应用程序但出现错误

> ID：10217094
> 
> 赞同：0
> 
> 时间：2012-04-18T20:02:31.933
> 
> 标签：c#, wpf, mp3, exe

我想在 myplayer.exe 中运行一个 mp3 文件（我已经用 c# 进行了编码和开发）。但我收到此错误 - abc.mp3 不是有效的 Win32 应用程序。

我使用此代码获取文件路径 - ...

```
 if
    ((AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData != null)     
      &&     
    (AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData.Length>0))
       {
            string fname = "No filename given";
            try
                 {
                 fname = AppDomain.CurrentDomain.SetupInformation.
                         ActivationArguments.ActivationData[0];

                Uri uri = new Uri(fname);

               fname = uri.LocalPath;

                this.Properties["ArbitraryArgName"] = fname;
      }

         catch (Exception ex)
                 { }

        base.OnStartup(e);
} 
```

app.xaml.cs 中的上述代码

在 mainWindow.xaml.cs 中，这是我使用的代码！

```
 public CubeWindow()
        {
            InitializeComponent();
            this.Loaded += new RoutedEventHandler(MainContainer_Loaded);
         }

 void MainContainer_Loaded(object sender, RoutedEventArgs e)
  {
  if(System.Windows.Application.Current.Properties["ArbitraryArgName"] != null)
    {
      string fname=System.Windows.Application.Current.
                    Properties["ArbitraryArgName"].ToString();
       me.Source = new Uri(fname, UriKind.RelativeOrAbsolute);
       me.Play(); //me is the mediaelement
     }
    } 
```

请让我知道纠正这个..以及这个错误的原因！先谢谢了！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:30:18.877

从您遇到的错误来看，您似乎正在尝试执行 MP3。那是行不通的。

当您尝试通过双击打开一个文件（例如一个 txt 文件）时，Windows 会检查注册表中该文件的默认应用程序（在大多数设置中，该应用程序是记事本）。然后它发送这个命令：

```
"<System32 Directory>\Notepad.exe" <filename> 
```

或者

```
"C:\Windows\System32\Notepad.exe" "C:\Users\user\Desktop\test1.txt" 
```

所以第一个命令行参数是文件名。

长话短说：如果您的程序是通过尝试在 Windows 资源管理器中打开 MP3 来启动的，您需要获取并保存命令行参数以供在项目中某处参考。

为此，您可以使用`Environment.GetCommandLineArgs()`它们或将它们传递给您`static void main`的`Program.cs`第一个表单的构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T13:08:27.523

从您给出的错误描述来看，它看起来像是与命令行参数有关的问题。您必须阅读应用程序的命令行参数。在 WPF 中，您可以处理 Application_Startup 事件以读取命令行参数。您可以按照[这个](http://www.rhyous.com/2010/02/19/how-to-process-command-line-parameters-or-arguments-in-a-wpf-application/ "这个")来了解 wpf 中命令行参数的使用。 [这](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/3dbfb9a3-4e14-41d1-afbb-1790420706fe)将帮助您了解在 C# 中播放 MP3 文件的详细信息。

希望这会有所帮助。

# c# - SQL Server 同步框架

> ID：10217100
> 
> 赞同：2
> 
> 时间：2012-04-18T20:02:45.567
> 
> 标签：c#, .net, sql-server, sql-server-2008, data-synchronization

两个快速的问题：1）我正在使用同步框架在两台服务器上同步两个表，但我不需要同步所有列。我可以在集合中传递我想要的列：

```
DbSyncTableDescription tableDesc = SqlSyncDescriptionBuilder.GetDescriptionForTable("tblSalesTracker", columnNames, serverConn); 
```

哪个工作正常，但如果我的集合之外的任何列在表中被修改，则会触发重新同步。我通过修改同步框架工作在源表上创建的现有触发器并检查我想要的列来解决这个问题。

所以

*   有没有办法在 c# 中设置/启动配置过程时手动创建更新或设置触发器？而不是稍后删除/重新创建。

或者

*   这样做的更好方法？

问题2）有没有办法同步到不同名称的表。

我所有的代码都是基于[MSDN](http://msdn.microsoft.com/en-us/library/ff928494.aspx)的。

唯一的区别是，它是 SQL 2008 Express 到 SQL 2008 Express。

# android - 如果里面有另一个布局，背景会失去颜色

> ID：10217102
> 
> 赞同：1
> 
> 时间：2012-04-18T20:02:46.610
> 
> 标签：android, xml

假设我想在另一个具有不同背景颜色的布局中创建一个布局，但是一旦我将背景颜色添加到内部布局（在本例中为 frameLayout6），外部布局的背景就会变得透明......

![在此处输入图像描述](../Images/a2c39f0f59aa840cb10b88e2c03f4964.png)

任何想法可能有什么问题？

谢谢！

```
 <FrameLayout
                    android:id="@+id/frameLayout5"
                    android:layout_width="160px"
                    android:layout_height="160px" android:background="#FFFFFF" android:layout_marginLeft="20px">

                    <FrameLayout
                        android:id="@+id/frameLayout6"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" android:layout_margin="5px">
                    </FrameLayout>

                </FrameLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:07:18.763

内部布局（frameLayout6）在framelayout5之上，所以如果在内部布局中设置背景，就看不到framelayout5。

编辑：

我不知道为什么会发生这种行为，但你可以这样做

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <RelativeLayout android:id="@+id/frameLayout5"
         android:layout_height="160dp"
        android:layout_marginLeft="20dp" android:layout_width="160dp">

        <View android:layout_width="fill_parent" android:layout_height="fill_parent" android:background="#ff00ff"/>

        <RelativeLayout android:layout_width="fill_parent"
            android:background="#ff0000" android:layout_height="fill_parent"
            android:layout_margin="50dp" android:drawingCacheQuality="auto">
        </RelativeLayout>

    </RelativeLayout>
</LinearLayout> 
```

# xcode - 向核心图形绘制应用程序添加撤消/重做方法

> ID：10217103
> 
> 赞同：2
> 
> 时间：2012-04-18T20:02:53.897
> 
> 标签：xcode, core-graphics, nsundomanager

我正在尝试使用 NSUndoManager 实现撤消/重做方法。我已经对此提出了其他问题，但仍然卡住了。

我现在的位置如下：

```
.h
NSUndoManager *undoManager;
@property(nonatomic,retain) NSUndoManager *undoManager;

.m
@synthesize undoManager; 
```

[undoManager setLevelsOfUndo:99]; viewdidload:

```
NSNotificationCenter *dnc = [NSNotificationCenter defaultCenter];      
[dnc addObserver:self selector:@selector(undoButtonTapped) name:@"undo" object:nil];   
[dnc addObserver:self selector:@selector(redoButtonTapped) name:@"redo" object:nil];

- (void)resetTheImage:(UIImage*)image
{
    NSLog(@"%s", __FUNCTION__);

   // image = savedImage.image;
    if (image != drawImage.image)
    {
        [[undoManager prepareWithInvocationTarget:self] resetTheImage];
        image = drawImage.image ;        
    } else {
        NSLog(@"That didn't work");
    }
}

- (void)undoButtonTapped {
    NSLog(@"%s", __FUNCTION__);
    [undoManager undo];
} 
```

我得到“那没有用”......

我会很感激帮助。当我弄清楚我做错了什么时，我会发布我原来问题的答案。

- -编辑 - -

我已将 resetTheImage 更改如下：

```
- (void)resetTheImage:(UIImage*)image
{
    NSLog(@"%s", __FUNCTION__);

    image = savedImage.image;
    if (image != drawImage.image)
    {
        drawImage.image = image;
        savedImage.image = image;
        NSLog(@"undo image");
        [[self.undoManager prepareWithInvocationTarget:drawImage.image] image];        

    } else {
        NSLog(@"same image");
        savedImage.image = image;
    }
} 
```

但是，混乱下雨了——如果有人（布拉德？贾斯汀？）可以提供一个项目符号列表，列出我需要采取哪些步骤来完成这项工作，这可能会有所帮助。例如：

. 在...中添加通知。触发通知...... 让撤消/重做按钮指向...。我真正需要构建哪些方法/功能......

我希望 SO 能让我给你的分数超过 1..

（我的“o”键变得不稳定并没有帮助）昨天我有一个小孙女确实有帮助:)）））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T17:08:20.757

首先，我要感谢大家的任何/所有帮助。我终于解决了这个问题，虽然我不确定这是否是最好的解决方案。

我制作了一个从 UIViewController 调用的 UIView。控件（颜色和画笔）保留在 VC 中。绘图方法移至视图方法。

View 方法调用 Drawing 方法来实际执行绘制，而 View 方法控制撤消/重做。

以下是一些代码片段：

```
-(void)undoButtonClicked
{
    //NSLog(@"%s", __FUNCTION__);
    if ([self.currentArray count] == 0) {
        //nothing to undo
        return;
    }

    DrawingPath *undonePath = [self.currentArray lastObject];
    [self.currentArray removeLastObject];
    [self.redoStack addObject:undonePath];
    [self setNeedsDisplay];

}

-(void)redoButtonClicked
{
    //NSLog(@"%s", __FUNCTION__);

    if ([self.redoStack count] == 0) {
        // nothing to redo
        return;
    }

    DrawingPath *redonePath = [self.redoStack lastObject];
    [self.redoStack removeLastObject];
    [self.currentArray addObject:redonePath];
    [self setNeedsDisplay];

} 
```

让我知道是否有人想要澄清。再次感谢大家。。

按要求更新：

这些是一些标题：

```
 DrawingViewController  *mvc;
    NSMutableArray *pathArray;
    NSMutableArray *colorArray;
    NSMutableArray *bufferArray;
    NSMutableArray *currentArray;
    UIBezierPath *myPath;
    NSString *brushSize;
    CGPoint lastPoint;
    int colorIndex;
    NSString *colorKey;

    SoundEffect         *erasingSound;
    SoundEffect         *selectSound;

    BOOL swiped;    
    int moved;
    UIColor *currentColor;
    NSString *result;
}
@property(nonatomic,assign) NSInteger undoSteps;
@property (strong, nonatomic) NSString *result;

@property (strong,nonatomic) UIColor *currentColor;
@property (strong,nonatomic) NSMutableArray *currentArray;
@property (strong,nonatomic) NSMutableArray *bufferArray;
@property (strong,nonatomic) DrawingPath *currentColoredPath;
@property (strong,nonatomic) NSMutableArray *redoStack;
@property (strong, nonatomic) NSString *colorKey; 
```

这里还有一些方法.. currentArray 然后在一种堆栈中跟踪点、画笔和颜色。撤消从堆栈中删除，并添加到可用于重做的临时堆栈中。

```
-(void)undoButtonClicked
{
    //NSLog(@"%s", __FUNCTION__);
    if ([self.currentArray count] == 0) {
        //nothing to undo
        return;
    }

    DrawingPath *undonePath = [self.currentArray lastObject];
    [self.currentArray removeLastObject];
    [self.redoStack addObject:undonePath];
    [self setNeedsDisplay];

}

-(void)redoButtonClicked
{
    //NSLog(@"%s", __FUNCTION__);

    if ([self.redoStack count] == 0) {
        // nothing to redo
        return;
    }

    DrawingPath *redonePath = [self.redoStack lastObject];
    [self.redoStack removeLastObject];
    [self.currentArray addObject:redonePath];
    [self setNeedsDisplay];

}

#pragma mark - Touch Methods
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{   
    //NSLog(@"%s", __FUNCTION__);
    self.currentColoredPath = [[DrawingPath alloc] init];
    [self.currentColoredPath setColor:self.currentColor];
    UITouch *touch= [touches anyObject];

    [self.currentColoredPath.path moveToPoint:[touch locationInView:self]];
    [self.currentArray addObject:self.currentColoredPath];
    // Remove all paths from redo stack
    [self.redoStack removeAllObjects];

    lastPoint = [touch locationInView:self];
    lastPoint.y -= 20;

    if ([touch tapCount] == 2) {
        [self alertOKCancelAction];

        return;
    }  

}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    //NSLog(@"%s", __FUNCTION__);
    UITouch *touch = [touches anyObject]; 
    [self.currentColoredPath.path addLineToPoint:[touch locationInView:self]];

    [self setNeedsDisplay];

    CGPoint currentPoint = [touch locationInView:self];
    currentPoint.y -= 20;

    lastPoint = currentPoint;

}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    //NSLog(@"%s", __FUNCTION__);
    self.currentColoredPath = nil;
} 
```

# wcf - 从 WCF 服务抛出异常而不会出错

> ID：10217106
> 
> 赞同：3
> 
> 时间：2012-04-18T20:03:22.607
> 
> 标签：wcf, .net-3.5, faultexception

从 WCF 服务抛出 a`FaultException`时，有没有一种方法可以在不破坏实际连接的情况下抛出它？我希望阻止针对特定方法的操作，但不想中断客户端的连接（*只需返回说“您现在不能执行此操作，这就是原因”*）。或者，是在 .NET 消费应用程序中重新创建新代理所需的范例（*在 .NET 的情况下*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T09:43:47.400

如果你抛出一个 FaultException，那么客户端会得到一个异常，但应该能够继续使用相同的连接。如果您让任何其他类型的异常退出服务（没有自定义错误处理程序），那么它将导致通道故障

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:30:56.800

您使用的是 .NET 4.0，您可以使用[`WebFaultException`](http://msdn.microsoft.com/en-us/library/system.servicemodel.web.webfaultexception.aspx)返回带有适当错误原因的 HTTP 状态代码吗？

# javascript - 使用 javascript 创建多个淡入不同图像的图块

> ID：10217110
> 
> 赞同：1
> 
> 时间：2012-04-18T20:03:35.973
> 
> 标签：javascript, html

我正在做一个网络项目，我想制作一排 3x2 的瓷砖，当你将鼠标悬停在它们上面时，瓷砖会淡出并淡入包含图像的新瓷砖。

我有多个使用 DIV 类的图像瓷砖`.previewBox`。当您将鼠标悬停在这些图像上时，我使用 JQuery 淡出图像并使用新图像淡入（使用名为 waitForImages 的 JQuery 插件，该插件专门用于在 JavaScript 中加载图像）问题是我希望每个图块都以不同的图像集。我想将所有第一组图像（预览图像）放在一个数组中，将第二组图像（翻转图像）放在一个不同的数组中，当您将鼠标悬停在它想要设置翻转图像时调用 flipArray.indexOf(this) 但由于 JavaScript 正在检测 div 我不确定这是否会起作用，因为“this”不是指数组中的图像。

我仍然在学习 javascript，我不确定如何检测您悬停在哪个图像上并获取它的索引号以将其切换为另一张图片。

我有褪色图像的脚本，但现在我有硬编码的图像位置。

```
$(document).ready(function() {
    //Document is ready to load
    var hov = false;
    //Since there is more then one tile using the .previewBox I use the .each command
    $('.previewBox').each(function() {
        var previewBox = $(this); // Won't create as many objects this way.
        previewBox.mouseenter(function() // On mouse enter
        {
            if (hov === false) //Keeps animation from repeating
            {
                hov = true; // Sets boolean for mouse leave
                previewBox.fadeOut(function() //Fades out
                {
                    previewBox.waitForImages(function() //Loads images
                    {
                        previewBox.stop().fadeIn(); //Fades in
                    });
                    previewBox.attr("src", "Images/Portfolio/Art_Bike_Flip.png"); //New image location. 
                });
            };
        });
    });
    $('.previewBox').each(function() {
        var previewBox = $(this);
        previewBox.mouseleave(function() {
            if (hov === true) {
                hov = false;
                previewBox.fadeOut(function() {
                    previewBox.waitForImages(function() {
                        previewBox.stop().fadeIn();
                    });
                    previewBox.attr("src", "Images/Portfolio/Art_Bike_Preview.png");
                });
            };
        });
    });
}); 
```

# ruby - Ruby 中 lambda 和 def method_name 的区别

> ID：10217119
> 
> 赞同：10
> 
> 时间：2012-04-18T20:04:03.893
> 
> 标签：ruby, function, lambda

我正在阅读pickaxe 1.9，作者像这样使用lambda：

```
bo = lambda {|param| puts "You called me with #{param}"}
bo.call 99     => 'You called me with 99'
bo.call "cat"  => 'You called me with cat' 
```

我的问题是：这比仅仅定义一个做同样事情的方法有什么更好/更差/不同？像这样：

```
def bo(param)
  puts "You called me with #{param}"
end

bo("hello") => 'You called me with hello' 
```

对我来说，lambda 语法似乎更令人困惑，更像意大利面条。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-18T20:22:19.567

拉姆达斯：

*   是[`Proc`s](http://www.ruby-doc.org/core-1.9.3/Proc.html)的变体，
*   可以转换成块/从[块](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_containers.html#S2)转换，
*   不要开始一个新的[闭包范围](http://innig.net/software/ruby/closures-in-ruby)（这意味着您可以访问在 lambda 范围之外定义的变量，不像`def`），
*   可以作为变量传递。

我建议查看[这篇](http://www.robertsosinski.com/2008/12/21/understanding-ruby-blocks-procs-and-lambdas/)解释 procs、blocks 和 lambdas 的文章。

编辑：此链接已过时。为了将来参考，试试[这篇文章](http://awaxman11.github.io/blog/2013/08/05/what-is-the-difference-between-a-block/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:10:05.110

定义 lambda 给您的好处是，您可以将该 lambda 对象作为属性传递给另一个方法。

```
def method1 &b
  #... some code
  b.call
end

def method2 &b
  #... some more code...
  b.call
end

def method3 &b
  b.call
  #even more code here
end

myCallback = lambda { "this is a callback that can be called from several methods"} 
```

然后你可以像这样使用它：

```
method1 &myCallback
method2 &myCallback
method3 &myCallback 
```

这样做的美妙之处在于，您只编写了一次回调代码，但使用了 3 次......

我建议您查看此[链接](http://www.robertsosinski.com/2008/12/21/understanding-ruby-blocks-procs-and-lambdas/)以进一步阅读:)

# variables - 如何将系统变量值传递给执行 SQL 任务中的 SQL 语句？

> ID：10217121
> 
> 赞同：8
> 
> 时间：2012-04-18T20:04:15.557
> 
> 标签：variables, ssis

SSIS 2008。非常简单的任务。我想检索一个系统变量并在 SQL INSERT 中使用它。我想检索的值`System:MachineName`并在插入语句中使用它。

使用该语句`INSERT INTO MYLOG (COL1) SELECT @[System::MachineName]`给出错误**`Error: ..failed to parse. Must declare the scalar variable "@"`**

使用语句`SELECT @System::MachineName`或`SELECT @@[System::MachineName]` 给出错误**`'Error Incorrect systax near '::'`**

我不想将参数传递给查询。我已经搜索了一天，但找不到如何做这件简单的事情！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-18T21:56:37.060

这是您可以做到这一点的一种方法。以下示例包是`SSIS 2008 R2`使用 SQL Server 2008 R2 作为后端创建的。

*   在您的 SQLServer 数据库中创建一个示例表，名为**`dbo.PackageData`**

![表结构](../Images/791a11a1c9335c08e503200586a76ac6.png)

*   创建一个 SSIS 包。
*   在 SSIS 上，添加一个名为`SQLServer`连接到您的数据库的 OLE DB 连接管理器，例如连接到 SQL Server 数据库。
*   在控制流选项卡上，拖放一个`Execute SQL Task`
*   双击执行 SQL 任务以显示执行 SQL 任务编辑器。
*   在`General`编辑器的选项卡上，将`Connection`属性设置为名为 SQLServer 的连接管理器。
*   在属性`SQLStatement`中，输入插入语句**`INSERT INTO dbo.PackageData (PackageName) VALUES (?)`**

![常规选项卡](../Images/c62c7a4e5c68e11c5140c988070f6438.png)

*   在 Parameter Mapping 选项卡上，单击 Add 按钮，选择您要使用的 Package 变量。相应地更改数据类型。此示例将 PackageName 插入表中，因此`Data Type`将是**`VARCHAR`**. 将`Parameter`Name 设置为**`0`**，表示参数的索引值。单击确定按钮。

![参数映射选项卡](../Images/c2eb24a23cefeb2581e3e26e2499fea8.png)

*   执行包。
*   您会注意到表中插入了一条新记录。我将包名称保留为 Package。这就是为什么桌子

![包装数据](../Images/534ffda22e232cdd6ad09e77b71ad31a.png)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-27T00:49:26.183

根据我对@ZERO 答案的评论（在此重复作为答案，因此 SSIS 新手不会忽视它）。

OP 的问题几乎是 SSIS 属性表达式的用例。

要将 SSIS 变量传递到查询字符串中，可以将其连接到为 SqlStatementSource 属性设置的表达式中：

`"INSERT INTO MYLOG (COL1) SELECT " + @[System::MachineName]`

这并不是说接受的答案不是一个好的模式，因为一般来说，参数化方法比直接查询字符串操作更安全（防止 SQL 注入）和更快（重用）。但是对于系统变量（而不是用户输入的字符串），这个解决方案应该不会受到 SQL 注入的影响，并且如果重新使用（因为机器名称没有改变），这将与参数化查询大致相同或更快）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:13:33.377

我以前从未使用过它，但也许您可以在执行 SQL 任务中查看表达式的使用。

或者只是将整个查询放入一个变量的表达式中，并将 evaluateAsExpression 设置为 true。然后使用 OLE DB 做你插入

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-13T23:10:36.537

连同@user756519 的回答，根据您的连接字符串、变量名和 SQLStatementSource 更改

[![https://docs.microsoft.com/en-us/sql/integration-services/control-flow/execute-sql-task](../Images/90ee68092f300c0a7922c796f784cf45.png)](https://i.stack.imgur.com/A0NVl.jpg)

# sql - 仅对 UPDATE 的 SQL NULL 约束

> ID：10217123
> 
> 赞同：0
> 
> 时间：2012-04-18T20:04:19.693
> 
> 标签：sql, database, tsql, constraints

有没有办法对表中的列进行约束，在 UPDATES 上不允许 NULLS？插入时仍应允许空值。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:06:30.377

不，您必须使用触发器或任何其他机制单独处理逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T17:41:45.793

我会尝试做一个触发器来检查更新以查看该字段是否为 NULL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:55:57.810

1.  将列标记为`NOT NULL`。
2.  添加一个`DEFAULT`值。
3.  创建一个`INSTEAD OF INSERT`触发器以将插入的空值替换为默认值。

这应该满足所有要求。

* * *

```
CREATE TABLE Client
(
    ClientId int, 
    OptionalOnInsert int NOT NULL DEFAULT(0),
    Field1 int, 
    Field2 int
)
GO

CREATE TRIGGER TR_Client_InsteadOfInsert ON Client
INSTEAD OF INSERT
AS
    INSERT Client (ClientId, OptionalOnInsert, Field1, Field2)
    SELECT ClientId, OptionalOnInsert, Field1, Field2
    FROM INSERTED
    WHERE OptionalOnInsert is not null

    INSERT Client (ClientId, Field1, Field2)
    SELECT ClientId, Field1, Field2
    FROM INSERTED
    WHERE OptionalOnInsert is null
GO

-- Inserting NULL succeeds
INSERT Client (ClientId, OptionalOnInsert)
VALUES (1, NULL)

-- Updating to NULL fails
UPDATE Client
SET OptionalOnInsert = NULL
WHERE ClientId = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T20:09:58.230

您是否尝试过使用 onupdate 触发器？您正在使用事务（tsql），所以这应该是一个可能的解决方案。据我所知，检查约束不能仅限于更新查询。

# ant - Ant：检查两个数是否相等

> ID：10217124
> 
> 赞同：7
> 
> 时间：2012-04-18T20:04:33.397
> 
> 标签：ant, comparison, conditional

我有一个蚂蚁任务，它应该比较两个值是否相等。如果这两个值不相等，我想失败：

```
<condition property="versionDoesNotMatch">
  <not>
    <equals arg1="applicationVersion" arg2="releaseNotesVersion"/>
  </not>
</condition>
<fail if="versionDoesNotMatch" message="Version of Application and Release notes does not match."/> 
```

根据 ant 输出，releaseNotesVersion 和 applicationVersion 这两个值都具有相同的值**1.7**，但条件始终评估为真 - 因为**not**意味着数字不相等。这让我想知道，如果蚂蚁在比较这些值时会遇到麻烦吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T20:27:27.587

您在示例中匹配了两个文字字符串；这些永远不会相等，因此您的条件始终评估为真。假设您的 args 是 Ant 属性，您需要像这样评估属性值：

```
<condition property="versionDoesNotMatch">
  <not>
    <equals arg1="${applicationVersion}" arg2="${releaseNotesVersion}"/>
  </not>
</condition>
<fail if="versionDoesNotMatch" message="Version of Application and Release notes does not match."/> 
```

# c - 进程分叉后会发生什么？

> ID：10217127
> 
> 赞同：1
> 
> 时间：2012-04-18T20:04:45.383
> 
> 标签：c, linux, gcc, fork, x86-64

假设一个进程是从另一个进程派生出来的。换句话说，我们通过 fork 函数调用来复制一个进程。现在由于分叉是一种写时复制机制，所以每当分叉的进程或原始进程写入一个页面时，它们都会获得一个新的物理页面来写入。所以我的理解是，当分叉和原始进程都在执行时，事情就是这样的。

--> 分叉时，原始和分叉进程的所有页面都被授予只读访问权限，以便内核知道写入哪个页面。当这种情况发生时，内核将一个新的物理页面映射到写入进程，将以前的内容写入其中，然后授予对该页面的写入访问权限。现在我不清楚的是，如果分叉和原始进程都写入同一个页面，它们中的一个是否仍将保留原始物理页面（在分叉之前），或者两者都将获得新的物理页面。其次，我的假设是否正确，即分叉和原始进程中的所有页面在分叉时都被授予只读访问权限？

--> 现在由于每个页面错误都会触发一个中断，这意味着每次写入原始或分叉进程都会减慢执行速度。假设我们知道应用程序，并且我们知道将写入大量连续的内存页面，那么当组中的一个页面时，将写入权限授予多个页面（假设是一组页面）不是更好吗？被写入。这将减少由于页面错误处理而导致的中断数量。不是吗？当然，在这种情况下，我们有时可能会不必要地进行复制，但我认为中断比写入 512 个*long*类型的变量（每页 4096 字节）的开销要大得多。我的理解是正确的还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:14:07.857

Fork 在语义上复制了一个进程。Copy-on-write 是一种优化，使它更快。优化通常有一些隐藏的权衡。有些情况会变得更快，但其他情况会受到影响。写时复制是有成本的，但我们希望通常会有所节省，因为大多数复制的页面实际上不会被孩子写入。在理想情况下，孩子执行立即执行。

因此，我们会遭受少量页面的页面错误异常，这比预先复制所有页面要便宜。

大多数“惰性求值”类型的优化都属于这种性质。

一百万个项目的惰性列表完全实例化比一百万个项目的常规列表更昂贵。但如果列表的消费者只访问前 100 个项目，则惰性列表获胜。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:20:42.313

如果我没记错的话，其中一个进程将被视为首先写入页面。即使你有多个核心，我相信页面错误也会被串行处理。在这种情况下，第一个被捕获的进程会将两个进程的页面解耦，所以当第二个进程写入它时，不会有错误，因为它现在有一个可写的页面自己的。

我相信完成此操作后，现有页面由一个进程保留（并设置回读/写），并为另一个进程制作一个新副本。

我认为您的第三点围绕一个简单的点：“说如果我们知道应用程序......”。这就是问题所在：操作系统不*知道*应用程序。本质上，它“知道”的唯一事情将是间接的，通过内核编码人员的观察。他们无疑会观察到`fork`通常紧随其后的是`exec`，因此他们无疑会针对这种情况进行优化。是的，情况并非总是如此，而且您显然担心其他情况——我在这里要说的是它们足够不寻常，我猜想在它们上花费很少的精力。

我不太确定我是否遵循 4096 字节页面中大约 512 个长的逻辑或数学 -*第*一次写入页面时，它会在进程之间复制和解耦。从那时起，进一步写入该页面的任一进程的副本将不会导致任何进一步的页面错误（至少与写入时的副本有关——当然，如果进程站点空闲很长时间，则数据可能会被调出到页面文件，或按顺序排列的东西，但在这里无关紧要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:47:16.390

好吧，如果 fork() 不使用 COW，*初始成本*会非常高。如果您查看典型的`top`显示，RSS/VSIZE 的比率非常小（例如，典型的 vi 会话为 2MB/56MB）。

克隆一个没有 COW 的进程会导致巨大的内存压力，这实际上会导致其他进程丢失它们的附加页面（必须将其移动到辅助存储，并且可能稍后恢复）。并且该分页实际上会导致每页 1-2 个磁盘 I/O（仅当页面是新的或脏的时才需要*换出*，只有当其他进程再次引用该页面时才需要*换入）*

Another point is *granularity*: back in the days, when MMU's did not exist, whole processes had to be swapped out to yield their memory, causing the system to actually freeze for a second or so. Page-faulting on a per-page basis causes more traps, but these are spread out nicely, allowing the processes to actually *compete for physical ram*. Without prior knowledge, it's hard to beat an LRU scheme.

# sql-server-2008 - ssis 中增量负载的最佳方式

> ID：10217134
> 
> 赞同：0
> 
> 时间：2012-04-18T20:05:20.143
> 
> 标签：sql-server-2008, ssis

我每天从源中获取 600,000 行，我需要将它们转储到 SQL Server 目标中，这将是一个增量负载。

现在，由于目标表的大小可能每天都在增加，这将是增量负载的最佳方法。我的脑海里没有几个选择：

1.  查找任务

2.  合并加入

3.  SCD

    ETC..

请建议我在增量负载中表现良好的最佳选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:32:55.180

看看 Andy Leonard 的优秀[Stairway to Integration Services](http://www.sqlservercentral.com/stairway/72494/)系列或 Todd McDermid 关于如何使用免费的[SSIS Dimension Merge SCD 组件](http://dimensionmergescd.codeplex.com/)的视频 两者都将解决如何正确地做到这一点，比我在此框中所能列举的要好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:11:41.163

合并连接是一个巨大的性能问题，因为它需要预先对所有记录进行排序，并且不应该用于此目的。

我们每天处理数以百万计的记录文件，通常将它们放在临时表中，并与我们的更改数据跟踪表中的数据进行哈希比较，以查看数据是否与 prod 上的数据不同，然后仅加载新的或新的那是不同的。因为我们在生产数据库之外进行比较，所以我们对 prod 的影响很小，因为我们只处理它实际需要的 247 条记录，而不是检查数百万条记录。事实上，对于我们最繁忙的服务器，所有这些处理都发生在一个单独的服务器上，除了最后一步进入 prod。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:11:52.090

如果您只需要插入它们，那实际上并不重要。如果您需要检查类似的内容，如果存在，则更新其他插入，我建议创建一个 oleDbSource，您可以在其中查询 600.000 行，并使用现有数据源上的查找任务检查它们是否存在。由于现有数据源是（或趋于）巨大的，因此请注意配置缓存模式的方式。我会使用部分缓存，并根据您正在查找的 ID 排序一些内存限制（根据缓存的工作方式，这个细节非常重要）

# c# - 在 ASP.NET SessionID 中使用 RNGCryptoServiceProvider 是线程安全的吗？

> ID：10217135
> 
> 赞同：0
> 
> 时间：2012-04-18T20:05:30.450
> 
> 标签：c#, asp.net, sessionid

下面是 ASP.NET 中用于创建会话 id 的实现（我已经解释过）。

### 编辑（RNG 是共享的）：

```
static _randgen = new RNGCryptoServiceProvider(); 

string GetSessionId()
{
    var buffer = new byte [15];

    //fill the buffer with random bytes
    randgen.GetBytes(buffer);

    //turn the bytes into a string of letters and numbers (no unsafe chars)
    string encoding = Encode(buffer);
    return encoding; 
} 
```

上的文档`RNGCryptoServiceProvider.GetBytes`说它是线程安全的，但是尚不清楚这意味着哪种线程安全。它只是保证没有死锁还是保证两个线程将获得不同的值？是否可能存在 2 个请求会拉取相同会话 ID 的竞争条件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:09:12.113

`RNGCryptoServiceProvider`由于在函数内部创建了一个新对象`GetSessionId`，因此它不能被多个线程访问。

**编辑：** 这意味着如果两个或更多线程使用它的功能，它不会崩溃。它不保证任何唯一性（一个或多个线程），但会生成加密强的随机字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:35:48.840

虽然 GetBytes 是线程安全的（没有死锁，没有共享结果），但使用它并不意味着每次结果都不同。

每次调用 GetBytes，都是一个全新的随机结果。这意味着要随机，它也可能是重复的。

授予 15 个字节，这是不太可能的一面，但它可能会发生。

# asp.net - 从母版页 asp.net 访问控制 - 存储值

> ID：10217136
> 
> 赞同：2
> 
> 时间：2012-04-18T20:05:31.493
> 
> 标签：asp.net, session, static, master-pages, viewstate

目前我有一个母版页和一个内容页。我的母版页包含一个下拉列表，我需要从中选择一个孩子。内容页面根据选择的孩子加载。我应该如何存储选择的下拉值？

我不认为我可以使用**session**，因为我希望用户能够打开多个选项卡并同时观看不同的子内容。如果我可以在这种情况下使用会话，我不确定如何。

我认为我不能使用**视图**状态，因为尽管它解决了我的多个选项卡问题，但母版页和内容页具有不同的视图状态。

目前，我在内容页面上使用了一个公共**静态**变量，并将其设置在母版页中。但据我所知，静态变量的值存储在网站上所有当前会话中。

**问题：** 任何人都可以通过建议我应该使用哪种技术来帮助我吗？

我也听说过“应用程序”对象，但我认为使用它没有意义。

**当前工作代码：**

（内容页）

```
public static string Child
    {
        get
        {
            if (child == null)
                return "-1";
            return child;
        }

        set
        {
            child = value;
        }
    } 
```

（母版页）

```
protected void ddlChooseChild_IndexChanged(object sender, EventArgs e)
        {
            ContentPage.Child = ddlChooseChild.SelectedValue;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:08:05.363

在不同控件之间共享数据的最佳方式是使用“Items”集合（它是[HttpContext](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)类的属性）。该集合是一个哈希表，可以从您的页面和用户控件中访问，如下所示：

```
Context.Items["Child"] = ddlChooseChild.SelectedValue; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:14:04.517

除非您使用[PageID 或](https://stackoverflow.com/questions/2840615/asp-net-session-multiple-browser-tabs-different-sessions)类似的东西来限制会话，否则会话可以在多个选项卡上使用。

查看这篇文章，[主内容页面交互](http://www.codeproject.com/Articles/36055/Interaction-Between-Content-Page-and-Master-Page)

# c++ - 如何为大型网格实现 VBO 并获得流畅的动画？

> ID：10217141
> 
> 赞同：3
> 
> 时间：2012-04-18T20:05:53.090
> 
> 标签：c++, opengl, vbo, maya

我正在 Maya 中创建一个一分钟长的动画，我打算在 OpenGL 中渲染它。我这样做是作为大学的一个项目。

场景中只有一张人脸做出扭曲的表情。网格有大约 2200 个四边形面。

我找到了一个将 Wavefront 对象文件转换为顶点和法线数组的 perl 脚本。我打算在 Maya 中以 24fps 的速度制作动画，然后将每一帧中的网格导出到 Wavefront 对象文件，然后通过 perl 脚本运行所有这些，这将为我提供顶点和法线数组。

因此，为了测试可行性，我将 Maya 中的两帧动画转换为目标文件，并通过脚本运行它（调整后），这给了我数千次`glVertex`调用`glNormal`。我将所有这些复制到我的 C++ 程序并编译它。它运行顺利。

考虑到当我将 60sec*24frame 的`glVertex`和`glNormal`语句复制到程序中时程序会有多大，我想尝试使用 VBO。所以，我读到了它，但我不太了解它的实现。

所以我的第一个问题是：在这种情况下实现 VBO 的最佳方法是什么？

我正在考虑顶点和法线的二维数组，每帧一个；`GL_STATIC_DRAW_ARB`对于`glBufferDataARB()`. _

假设我的动画是 5 帧长，我的面部网格由 2200 个顶点和法线组成，那么我将创建：

```
GLfloat face_vertices[5][2200] = {.....};
GLfloat face_normals[5][2200] = {.....}; 
```

我的第二个问题：上面的代码会在 VBO 上工作或表现得“好”吗？

另外，我不确定这些信息是否重要，但我的计算机运行在 Intel 82945G 显卡上，而且我很确定我大学的 PC 也运行在 Intel 上。只是想我会提到这一点。

更新

性能也是一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T18:53:05.823

如果您可以流畅地运行动画的两帧，则可以流畅地运行 60*24 帧“值得 glVertex 和 glNormal 语句”，如果您可以从 Maya 动画自动生成 GL 调用。这种方法的唯一问题是您的源代码和二进制可执行文件将非常庞大。这是使您的方法“不好”的问题。

因此，首先，您可以将数据放在一个数组（或 std::vector，就此而言）中，而不是对每个顶点数据进行一次 glVertex 调用，并使用简单的循环遍历它：

```
std::vector<int> idx;
std::vector<vertex> frame_data;
...
glBegin(GL_QUADS);
for(int i = 0; i < idx.size(); ++i) {
  glVertex3f(frame_data[idx].x, frame_data[idx].y, frame_data[idx].z);
  glNormal3f(frame_data[idx].nx, frame_data[idx].ny, frame_data[idx].nz);
}
glEnd(); 
```

idx 表示面，idx 中的每 4 个元素组成一个四边形。frame_data 是该帧的特定顶点数据，每一帧必须有一个这样的数组，并且该数据由 idx 索引。这样，您唯一需要解决的问题就是如何将这些数据读入您的应用程序。如果您可以从网格文件生成 glVertex 调用，则可以改为生成一个文件，您可以使用 C++ fstream 在应用程序中轻松加载该文件，并构建数据数组，然后遍历它们并进行绘图调用。

在这种情况下，您不会看到使用 glBegin()/glEnd() 和 VBO 之间的性能差异，因为 2200 个四边形的数量太少，无法产生任何影响，但这对您来说将是一个有趣的练习。组织数组中的数据（idx 和 vertex_data）是使用 VBO 的第一步。您必须将与一个顶点相关的所有数据打包到一个结构中：

```
struct vertex {
  float x, y, z; // Position
  float nx, ny, nz; // Normal
};
...
vertex frame_data[v_count];
uint16_t idx[2200 * 4]; // 4 vertices makes one face 
```

请注意，v_count*不是*2200。这是您的四边形计数，因此该数字与 idx 大小相关，而不是 frame_data，即可以在多个四边形面中使用相同的顶点。

您将需要两个缓冲区，一个静态来保存 idx（一个 GL_ELEMENT_ARRAY_BUFFER 和 GL_STATIC_DRAW），因为这在执行期间不会改变，另一个“流”缓冲区来保存顶点数据（GL_ARRAY_BUFFER 和 GL_STREAM_DRAW）。最后一个使用“GL_STREAM_DRAW”，因为您需要为动画每帧重写其内容。请参阅[glBufferData](http://www.opengl.org/sdk/docs/man/xhtml/glBufferData.xml)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T16:25:46.473

> 我正在考虑顶点和法线的二维数组，每帧一个；和

我认为这是不正确的解决方案。有了这么多的数据，流式传输它是有意义的。例如，将 1 秒的动画保留在内存中，其余的按需加载。我相信有`GL_STREAM_****`这种情况的标志。

更好的解决方案是从 Maya 及其动画中导出骨骼。（在这种情况下，您需要一个永远不会改变的网格）

**您必须**逐帧导出每个顶点动画的唯一情况是导出计算量非常大的东西。我能想到的唯一现实场景是 3D 流体网格（拓扑改变非常框架等）——其他一切都可以在 CPU 或 GPU 上计算。但是，您的帖子并不表明这是您的情况。因此，根据墨菲定律，我将不得不假设您正在使用低效的解决方案来解决可以以不同方式解决的问题。

> : 上面的代码会在 VBO 上工作或表现得“好”吗？

无法回答，因为你没有说你将如何绘制数据。通过滥用着色器、alpha 混合或多次渲染相同的东西，即使是简单的几何图形，也有可能让任何机器屈服。

# php - 用 PHP 向大量用户发送电子邮件的最有效方法是什么？

> ID：10217142
> 
> 赞同：2
> 
> 时间：2012-04-18T20:05:53.600
> 
> 标签：php, mysql, performance, email

每当有人 PM（私人消息）他们时，我的网站都会向我的用户发送一封电子邮件。它说的是“有人刚刚在站点名称上向您发送了一条消息，请登录以查看它”。

目前我的网站不是很受欢迎，所以我目前的做法在性能方面没有问题：

```
 // code that sends pm here...

    // code that stores pm in messages table here...

    // notify user by emailing them right away
    mail($user_email, $subject, $message); 
```

基本上每次发送 PM 时，都会执行邮件功能，并在现场发送消息。因此，每发送 100 条消息，mail() 就会被调用 100 次。

我预计我的网站会越来越受欢迎，并且随着更多用户的到来，会有更多的 PM，所以我认为我目前的做法将成为性能的噩梦。所以我想改用这种方式：

```
// get the last message that was accounted for by the last cron
$query = mysql_query(" SELECT `last_checked_id` FROM `settings` ");
$last_checked_id = mysql_fetch_array($query);

$user_emails = array();

// get all messages that were added to this table since the last time this cron ran
$query = mysql_query(" SELECT `recipient_id`, `message_id` FROM `messages` WHERE `message_id` > '$last_checked_id' ");

$i = 0;
while($row = mysql_fetch_array($query)) {

    if($i == 0) {
        // set this as the last message processed
        mysql_query(" UPDATE `settings` WHERE `last_checked_id` = '". $row['message_id'] ."' ");
    }

    // only put this user in the to email list if he hasn't been added already (since there can be multiple messages for the same user but we need to notify him only once) 
    if(!in_array($row['recipient_id'], $user_emails)) {
        array_push($user_emails, $row['recipient_id']);     
    }
}
$i++;

// send email to all users at one
mail(implode(',', $user_emails), $subject, $message); 
```

我可以将此脚本设置为 cron 并让它每小时运行一次。所有的电子邮件都是一次性发送的，邮件功能只被调用一次。唯一的缺点是用户在收到 PM 时不会立即收到通知，而是在一小时内通知一次。但这没什么大不了的，我可以忍受。

我的问题是：

*   cron 方法在性能方面明显更好还是可以忽略不计
*   这是大多数大型网站的做法吗？还是有更好的方法，一些已建立的图书馆可能会？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:11:31.983

您可以在 mysql 表中插入邮件（emailoutgoing）

并且每“3”分钟运行一次 cron 作业，您可以从表中收到未发送的（100 封？）电子邮件，发送并将行标记为已发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:29:07.257

如果我理解正确，您会向每个人发送完全相同的电子邮件吗？在这种情况下，您应该为电子邮件地址使用密件抄送字段，否则每个人都会看到其他收件人，但在这种情况下，您可能会遇到反垃圾邮件引擎的问题，这些引擎可能会忽略您的电子邮件，因为他们不会将他们的用户视为电子邮件的收件人（不在在 to 或 cc 字段中）。

但是您真的应该考虑为每个用户发送个性化的电子邮件（如果您将 sneek preview 添加到谁发送了消息和/或消息的一部分，他们会更加渴望）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:55:37.323

首先，阅读 Mike B 评论中的链接。

其次，您的代码有一些有趣的失败模式——它可能会失败，将所有邮件标记为已发送，而没有人会知道。关于 CRON 和其他无人值守进程（包括一般的网站）的一个关键问题是您需要知道何时出现问题。在您发送邮件后，我会考虑将“更新”声明放在最后。放入某种日志记录，以便您可以跟踪正在发生的事情。

第三，请不要将这封电子邮件发送给“收件人”字段中的所有这些人——正如米罗所说，这是垃圾邮件的诱饵，但它也会让用户接触到比他们应该拥有的更多的信息——他们知道随机其他人的电子邮件地址您网站的用户在一个小时内碰巧收到了 PM。如果你正在建立一个约会网站或社交网络，那几乎肯定会让人们生气。

最后，我工作过的其他有类似要求的站点往往有一个“事件”表，由守护进程/服务样式进程监控。守护进程会对做什么做出明智的决定。我们设计的解决方案适合在多线程甚至多台机器上运行，尽管实际上从来不需要这样。

因此，您可能有一个“事件”表，如下所示：

```
eventID    eventDate    eventType     eventStatus     eventMeta
-------------------------------------------------------------------
1          1 Feb 2012        PM           NEW         <from>bob@banana.com</from><to>alice@passionfruit.com</to>
2          1 Mar 2012        PM           COMPLETE    <from>fred@pear.com</from><to>jennifer@avocado.com</to> 
```

守护程序不断扫描 eventStatus 为 NEW 的记录，将它们设置为“进行中”，处理它们，然后将状态设置为完成。

这使您可以查看系统中正在发生的事情 - 如果记录“正在进行”超过一秒钟，则说明某些内容已损坏。如果“新”记录的数量不断增长，而“完整”记录的数量没有增长，那么就会出现问题。

# rownum - 在 GROUP BY、ORDER BY 查询后自动增加虚拟列

> ID：10217148
> 
> 赞同：2
> 
> 时间：2012-04-18T20:06:11.487
> 
> 标签：rownum

在发布此之前，我已经对自动增量进行了广泛的研究，但找不到类似的案例：

我有一个查询从主表中提取数据，按 player_id 分组并按点 desc 排序，因此创建了排名输出。我的目标是进行相同的查询，一旦完成聚合和排序数据，创建一个新列“排名”并自动递增它，以便显示 1、2、3 等，因为所有内容都已按玩家分组并按点 DESC 排序。

多谢你们。

源表示例：

player_id-----------积分-----

---1-------5----------

---1--------10---------

---1-------5---------

---2-------20---------

---2-------5---------

根据此示例的所需输出：

**排名**------player_id-----score-----

---- **1** ----------2------------25分 ---------

---- **2** ----------1------------20 分 ---------

**编辑**

Rownum 做得很好，不需要自动增量虚拟列！请参阅下面 Mutnowski 接受的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T20:31:22.080

试试这个

```
SELECT @rownum:=@rownum+1 AS ‘rank’, Player_ID, Points FROM (SELECT Player_ID, SUM(Points) AS 'Points' FROM tblScores GROUP BY Player_ID ORDER BY Points DESC) AS foo, (SELECT @rownum:=0) AS foo2 
```

我认为您需要运行一个查询来获得没有排名的结果，然后首先运行另一个查询来选择所有并添加排名

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-18T20:37:22.413

将 SUM 应用于 Points 列应该会产生您想要的结果。

```
SELECT @rownum:=@rownum+1 AS ‘rank‘,player_id, SUM(points) 
FROM scores
GROUP BY player_id
ORDER BY SUM(points) DESC; 
```

# windows - Windows 中的 Bash 启动脚本

> ID：10217154
> 
> 赞同：10
> 
> 时间：2012-04-18T20:06:30.530
> 
> 标签：windows, bash

我在 Windows 中使用带有 Git 的 Bash shell。当我打开 shell 时，我希望设置许多别名。是否有为每个启动的 Bash 实例调用的配置文件？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T21:06:43.740

谢谢@Blender，这就是答案。这是我所做的...

启动 bash (Git bash)

```
cd
touch .bashrc
notepad .bashrc
source .bashrc # To make changes available without restart 
```

输入别名...保存
关闭 bash
开始 bash
别名现在可用！

# python - shutil 不能通过函数调用在 python 中工作

> ID：10217158
> 
> 赞同：0
> 
> 时间：2012-04-18T20:07:05.873
> 
> 标签：python

我有一个功能是从一个目录合并某些文件

```
def merge(path):
    f = open("indexFile","w")
    for path,directory,files in os.walk(path):
        for file in files:
            f1 = open(os.path.join(path,file))
            createCatFile(f1.read())
            print "merging files"
            shutil.copyfileobj(f1, f)
            f1.close()
    f.close() 
```

在复制文件对象之前，它会将 f1 的内容传递给函数以进行一些处理。问题是创建了 indexFile 但文件中没有数据。这是一个空文件。该`createCatFile()`功能按预期完美运行。此外，“合并文件”会打印该`merge()`函数被调用的次数。`createCatFile()`当我删除对indexFile的函数调用时，成功创建。

关于这有什么问题的任何帮助？

createCatFile 函数执行以下操作：

```
def createCatFile(wordtodocstr):
    global offset
    wordInfo = wordtodocstr.split()
    term = wordInfo[0]
    newtermid = wordInfo[1]
    docList = wordInfo[2::2]
    ctfList = [int(number) for number in wordInfo[3::2]]
    docfr = len(docList)
    wordctf = sum(ctfList)
    catFileList = [term, newtermid, str(offset), str(wordctf), str(docfr)]
    catFileJoin = " ".join(catFileList)
    with open(path2+term, "w") as foutterm:
        foutterm.write(catFileJoin)
        foutterm.close()    
    offset+=1 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:12:34.103

也许做`f1.read()`“消耗”文件，而shutil没有任何东西可以复制。`f1.seek(os.SEEK_SET)`在调用 copyfileobj 之前尝试倒带文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:15:22.287

从[shutil.copyfileobj](http://docs.python.org/dev/library/shutil.html)文档中：

> 将类文件对象 fsrc 的内容复制到类文件对象 fdst。整数长度（如果给定）是缓冲区大小。特别是，负长度值意味着复制数据而不以块的形式循环源数据；默认情况下，数据以块的形式读取，以避免不受控制的内存消耗。**注意，如果 fsrc 对象的当前文件位置不为 0，则只会复制从当前文件位置到文件末尾的内容。**

所以基本上每个人都在说，read 将位置指针移动到 EOF，从而为 copyfileobj 方法提供了一个没有可读取的文件。

导致问题的不是您的函数，而是 f.read()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:12:17.167

`f1.read()`消耗`f1`。要么不这样做，要么先回到起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T20:13:00.777

我的猜测是你在调用`.read()`文件对象后跳转到文件的末尾。

在尝试复制文件对象之前，请尝试回到开头：

```
f1.seek(0) 
```

# c# - LINQ 查询优化

> ID：10217161
> 
> 赞同：0
> 
> 时间：2012-04-18T20:07:22.683
> 
> 标签：c#, linq, linq-to-sql, linq-to-objects

我从两个不同的存储库中检索数据：

```
 List<F> allFs = fRepository.GetFs().ToList();
        List<E> allEs = eRepository.GetEs().ToList(); 
```

现在我需要加入他们，所以我执行以下操作：

```
 var EFs = from c in allFs.AsQueryable()
                        join e in allEs on c.SerialNumber equals e.FSerialNumber
                        where e.Year == Convert.ToInt32(billingYear) && 
                        e.Month == Convert.ToInt32(billingMonth)
                        select new EReport
                        {
                            FSerialNumber = c.SerialNumber,
                            FName = c.Name,
                            IntCustID = Convert.ToInt32(e.IntCustID),
                            TotalECases = 0,
                            TotalPrice = "$0"
                        }; 
```

我怎样才能使这个 LINQ 查询更好，以便它运行得更快？我将不胜感激任何建议。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:09:28.017

除非您能够创建一个包含两条数据的存储库（这将是一个更受欢迎的解决方案），否则我可以看到以下可能加快该过程的事情。

1.  由于您总是按月和年过滤所有 E，因此您应该在 IQueryable 上调用 ToList 之前执行此操作，这样可以减少连接中 E 的数量（可能相当大）
2.  由于您只使用来自 E 和 F 的字段子集，因此您可以使用匿名类型来限制要传输的数据量
3.  根据您从 F 中检索到的序列号数量，您可以通过数据库中的序列号过滤您的 E（反之亦然）。但是，如果大多数序列号都在两套中都可以预期，那对您并没有多大帮助

您可能无法将存储库合并为一个的原因可能是因为数据来自两个独立的数据库。

使用上述第 1 点和第 2 点更新的代码将与此类似：

```
var allFs = fRepository.GetFs().Select(f => new {f.Name, f.SerialNumber}).ToList();

int year = Convert.ToInt32(billingYear);
int month = Convert.ToInt32(billingMonth);

var allEs = eRepository.GetEs().Where(e.Year == year && e.Month == month).Select(e => new {e.FSerialNumber, e.IntCustID}).ToList();

var EFs = from c in allFs
    join e in allEs on c.SerialNumber equals e.FSerialNumber
    select new EReport
    {
        FSerialNumber = c.SerialNumber,
        FName = c.Name,
        IntCustID = Convert.ToInt32(e.IntCustID),
        TotalECases = 0,
        TotalPrice = "$0"
    }; 
```

# database - 如果仅使用选择查询命中访问数据库，它是否可能损坏？

> ID：10217164
> 
> 赞同：0
> 
> 时间：2012-04-18T20:07:40.067
> 
> 标签：database, ms-access, corrupt-data

如果仅使用选择查询命中访问数据库，它是否可能损坏？我们的一个数据库似乎突然损坏了。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:26:08.643

我不得不说“不”，因为技术上“损坏”的意思是“数据不一致”，只有当它发生变化时才会发生这种情况（由于更新）。

但是，由于从磁盘读取数据过多，您可能会更早地出现磁盘故障，因此您的数据库仍然会因此而“死机”。

# ruby-on-rails - 找不到没有 ID 的用户 - Rails 3 项目中的表单错误

> ID：10217166
> 
> 赞同：1
> 
> 时间：2012-04-18T20:07:43.207
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我在 Gumtree.com 之类的网站上工作，用户在其中创建帖子，突出他们的各种需求（例如，我在第 X 天需要一名摄影师）。

消息功能有一些问题。我正在使用简单的私人消息传递插件。

问题出在用户填写发送消息/回复帖子的表单中。当我尝试访问 /messages/new 时出现以下错误：

```
ActiveRecord::RecordNotFound in MessagesController#new
Couldn't find User without an ID 
```

在下面附上我的模型-感谢您的任何建议！

谢谢，

费萨尔

**消息控制器**

```
class MessagesController < ApplicationController

before_filter :set_user

def index
if params[:mailbox] == "sent"
  @messages = @user.sent_messages
else
  @messages = @user.received_messages
end
end

def show
@message = Message.read_message(params[:id], current_user)
end

def new
@message = Message.new

if params[:reply_to]
  @reply_to = @user.received_messages.find(params[:reply_to])
  unless @reply_to.nil?
    @message.to = @reply_to.sender.login
    @message.subject = "Re: #{@reply_to.subject}"
    @message.body = "\n\n*Original message*\n\n #{@reply_to.body}"
  end
end
end

def create
@message = Message.new(params[:message])
@message.sender = @user
@message.recipient = User.find_by_login(params[:message][:to])

if @message.save
  flash[:notice] = "Message sent"
  redirect_to user_messages_path(@user)
else
  render :action => :new
end
end

def delete_selected
if request.post?
  if params[:delete]
    params[:delete].each { |id|
      @message = Message.find(:first, :conditions => ["messages.id = ? AND (sender_id = ? OR recipient_id = ?)", id, @user, @user])
      @message.mark_deleted(@user) unless @message.nil?
    }
    flash[:notice] = "Messages deleted"
  end
  redirect_to :back
end
end

private
def set_user
  @user = User.find(params[:user_id])
end
end 
```

**消息模型**

```
class Message < ActiveRecord::Base

is_private_message

attr_accessor :to

end 
```

**用户模型**

```
class User < ActiveRecord::Base

has_many :posts  
has_one :profile
has_private_messages

attr_accessible :email

validates_presence_of :email
validates_uniqueness_of :email, :message =>"Hmm, that email's already taken"
validates_format_of :email, :with => /^([^\s]+)((?:[-a-z0-9]\.)[a-z]{2,})$/i, :message => "Hi! Please use a valid email"

end 
```

**消息>新视图**

```
<% form_for @message, :url => user_messages_path(@user) do |f| %>
<p>
To:<br />
    <%= f.text_field :to %>
    <%= error_message_on @message, :to %>
</p>
<p>
Subject:<br />
<%= f.text_field :subject %>
<%= error_message_on @message, :subject %>
</p>
<p>
  Message<br />
  <%= f.text_area :body %>
        <%= error_message_on @message, :body %>
</p>
<p>
  <%= submit_tag "Send" %>
</p>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:21:26.370

您确定您的新消息页面会收到`:user_id`吗`params`？即使这是真的，我怀疑这是您的意图，因为任何人都可以通过传递另一个用户来假装是另一个用户`:user_id`。

所以你在底部的行：

```
@user = User.find(params[:user_id]) # I think it's the cause of your error -- no :user_id is passed 
```

似乎必须是：

```
@user = User.find(session[:user_id]) 
```

我想你听说过会话。

# javascript - jquery - 可排序交互不起作用

> ID：10217167
> 
> 赞同：0
> 
> 时间：2012-04-18T20:07:47.993
> 
> 标签：javascript, jquery, asp.net-mvc-3, jquery-ui, jquery-ui-sortable

我在 ASP.NET MVC 3 应用程序中工作，我正在尝试使用 jQuery 的 Sortable。我已经有一个 jQuery DatePicker 工作。在我看来，我有以下代码：

```
<link href=@Url.Content("~/Content/jquery_css/jquery.ui.all.css") rel="stylesheet" type="text/css" />
<script src=@Url.Content("~/Scripts/jquery.ui.core.js") type="text/javascript"></script>

<script src=@Url.Content("~/Scripts/jquery.ui.datepicker.js") type="text/javascript"></script>

<script src=@Url.Content("~/Scripts/jquery.ui.widget.js") type="text/javascript"></script>
<script src=@Url.Content("~/Scripts/jquery.ui.mouse.js") type="text/javascript"></script>
<script src=@Url.Content("~/Scripts/jquery.ui.sortable.js") type="text/javascript"></script> 
```

这是初始化程序代码：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#DateBegin").datepicker({ dateFormat: "dd/mm/yy" }).val();
        $("#DateEnd").datepicker({ dateFormat: "dd/mm/yy" }).val();
        $("#MenuPages").sortable("enable");
    }); 
</script> 
```

DatePicker 无缝工作。这是代码：

```
<fieldset>
    <legend>Search history</legend>
        <p>
            Begin: <br />
            <input type="text" id="DateBegin" name="DateBegin" value="" />
            <br />
            End: <br />
            <input type="text" id="DataEnd" name="DataEnd" value=""/>
            <br />
        </p>
    <button>Search</button>
</fieldset> 
```

但是 Sortable 不起作用。编码：

```
<ul name="MenuPages" id="MenuPages">
    <li id="page_1">Home</li>
    <li id="page_2">Blog</li>
    <li id="page_3">About</li>
    <li id="page_4">Contact</li>
</ul> 
```

我大约一个月前下载了 DatePicker，现在下载了 Sortable。我把`jquery.ui.mouse.js`,`jquery.ui.widget.js`和`jquery.ui.sortable.js`在会话中。我也换了`jquery.ui.core.js`。

我不知道是否有必要，我也复制`jquery-ui-1.8.19.custom.js`到会话中（也有`jquery-ui-1.8.11.js`和`jquery-ui-1.8.11.min.js`那里）。

不知道错误的来源可能在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:16:05.247

代替

`$("#MenuPages").sortable("enable");`

尝试

`$("#MenuPages").sortable();`

初始化可排序的。

# java - Java中的温度转换代码不会运行？

> ID：10217174
> 
> 赞同：0
> 
> 时间：2012-04-18T20:08:19.990
> 
> 标签：java, debugging, runtime-error

好的，所以我是一个完全的编程新手，我刚开始用 Java 编码。我试图编写一个温度转换代码（摄氏度到华氏度），但由于某种原因它根本无法运行！请帮我找出这段代码中的错误（不管它多么愚蠢）。

这是代码：

```
 package tempConvert;

  import java.util.Scanner;

  public class StartCode {

      Scanner in = new Scanner(System. in );

      public double tempInFarenheit;

      public double tempInCelcius;

      {
          System.out.println("enter the temp in celcius");

          tempInCelcius = in .nextDouble();

          tempInFarenheit = (9 / 5) * (tempInCelcius + 32);

          System.out.println(tempInFarenheit);
      }
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:09:37.623

您忘记编写作为程序运行起点的 main 方法。让我修改你的代码。

```
import java.util.Scanner;

public class StartCode 
{
    Scanner in = new Scanner (System.in); 
    public double tempInFarenheit;
    public double  tempInCelcius; 
```

**公共静态无效主要（字符串 [] 参数）**

```
 {
        System.out.println("enter the temp in celcius");

        tempInCelcius = in.nextDouble() ;    
        tempInFarenheit = (9/5)*(tempInCelcius+32);

        System.out.println(tempInFarenheit);
    } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:36:24.893

我认为这对你来说会更好：

```
import java.util.Scanner;

public class StartCode
{
    public static void main(String[] args) {
        Scanner in = new Scanner (System.in);
        double tempInFarenheit;
        double  tempInCelcius;
        System.out.println("enter the temp in celcius");
        tempInCelcius = in.nextDouble() ;
        tempInFarenheit = 1.8*tempInCelcius+32;
        System.out.println(tempInFarenheit);
    }
} 
```

你的华氏方程不正确。整数除法也不适合你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:12:55.530

你需要一个[main 方法](http://www.geom.uiuc.edu/~daeron/docs/javaguide/java/nutsandbolts/main.html)。我还建议使用Eclipse之类的IDE，它可以为您生成框架代码（包括main方法的语法）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T18:37:25.523

```
import java.util.*;
public class DegreeToFahrenheit {

    public static void main(String[] args) 
    {
        Scanner input = new Scanner(System.in);  

        System.out.println("Enter a temperature: ");  
        double temperature = input.nextDouble();  
        System.out.println("Enter the letter of the temperature type. Ex: C or c for celsius, F or f for fahrenheit.: ");  

        String tempType = input.next();  

        String C = tempType;  
        String c = tempType;  

        String F = tempType;  
        String f = tempType;  

        double celsius = temperature;  
        double fahrenheit = temperature;  

        if(tempType.equals(C) || tempType.equals(c)) { 
            celsius = (5*(fahrenheit-32)/9);  
            System.out.print("The fahrenheit degree " + fahrenheit + " is " + celsius + " in celsius." );

        }  

        else if(tempType.equals(F) || tempType.equals(f)) {  

            fahrenheit = (9*(celsius/5)+32);  
            System.out.print("The celsius degree " + celsius + " is " + fahrenheit + " in fahrenheit." ); 
        }  

        else {  
            System.out.print("The temperature type is not recognized." );  
        }  
    }  

} 
```

# css - MVC Twitter Bootstrap 不显眼的错误处理

> ID：10217175
> 
> 赞同：24
> 
> 时间：2012-04-18T20:08:23.640
> 
> 标签：css, asp.net-mvc, validation, twitter-bootstrap, unobtrusive-javascript

一段时间以来，我一直试图让 MVC Jquery 不显眼的错误处理与 twitter 引导程序一起工作。它的重点是我要么编辑 jquery.validate 要么在 document.ready 上做一些破解和斜线。

为了让不显眼的错误处理与 Bootstrap 和 MVC 一起工作，我需要将其添加到“控制组”类中的“错误”类。除此之外，“错误”类被附加到输入中。

我想知道社区中是否有人已经找到了解决方案。

例如

典型的引导标记会像这样......

```
<div class="control-group">
    <label for="Username">Username</label>
    <div class="controls">
        <input data-val="true" data-val-required="Username is required" id="Username" name="Username" type="text" value="" />
        <span class="field-validation-valid" data-valmsg-for="Username" data-valmsg-replace="true"></span>
    </div>
</div> 
```

当 jquery.validate unobtrusive 触发时模糊会发生什么......它将变为以下

```
<div class="control-group error">
    <label for="Username">Username</label>
    <div class="controls">
        <input data-val="true" data-val-required="Username is required" id="Username" name="Username" type="text" value="" />
        <span class="field-validation-valid help-inline" data-valmsg-for="Username" data-valmsg-replace="true"></span>
    </div>
</div> 
```

要使其在回发/提交中起作用，您可以执行以下操作...

```
//twitter bootstrap on post
$(function () {
    $('span.field-validation-valid, span.field-validation-error').each(function () {
        $(this).addClass('help-inline');
    });

    $('form').submit(function () {
        if ($(this).valid()) {
            $(this).find('div.control-group').each(function () {
                if ($(this).find('span.field-validation-error').length == 0) {
                    $(this).removeClass('error');
                }
            });
        }
        else {
            $(this).find('div.control-group').each(function () {
                if ($(this).find('span.field-validation-error').length > 0) {
                    $(this).addClass('error');
                }
            });
        }
    });

    $('form').each(function () {
        $(this).find('div.control-group').each(function () {
            if ($(this).find('span.field-validation-error').length > 0) {
                $(this).addClass('error');
            }
        });
    });

}); 
```

但是，在模糊时，它不会像您期望的那样工作。我不想编辑引导 CSS 或 Jquery.validate 文件，因为它们可能会在某个时候推出更新。

我会创建一个委托，还是绑定到 jquery 函数并从那里开始工作。这是我不熟悉的深层 JS 代码，但随着时间的推移，我可以通过它来解决问题。

有谁知道我会从哪里开始解决这个问题，或者知道它在哪里实施/讨论过？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-19T16:20:51.070

```
var page = function () {
    //Update that validator
    $.validator.setDefaults({
        highlight: function (element) {
            $(element).closest(".control-group").addClass("error");
        },
        unhighlight: function (element) {
            $(element).closest(".control-group").removeClass("error");
        }
    });
} (); 
```

最后，这为我解决了这个问题。我希望这对其他人也有帮助......

我最后的 JS 就这样结束了。

```
$(function () {
    $('span.field-validation-valid, span.field-validation-error').each(function () {
        $(this).addClass('help-inline');
    });

    $('form').submit(function () {
        if ($(this).valid()) {
            $(this).find('div.control-group').each(function () {
                if ($(this).find('span.field-validation-error').length == 0) {
                    $(this).removeClass('error');
                }
            });
        }
        else {
            $(this).find('div.control-group').each(function () {
                if ($(this).find('span.field-validation-error').length > 0) {
                    $(this).addClass('error');
                }
            });
        }
    });

    $('form').each(function () {
        $(this).find('div.control-group').each(function () {
            if ($(this).find('span.field-validation-error').length > 0) {
                $(this).addClass('error');
            }
        });
    });

});

var page = function () {
    //Update that validator
    $.validator.setDefaults({
        highlight: function (element) {
            $(element).closest(".control-group").addClass("error");
        },
        unhighlight: function (element) {
            $(element).closest(".control-group").removeClass("error");
        }
    });
} (); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-01T16:38:22.300

这是一个很好的解决方案...

将此添加到您的`_Layout.cshtml`文件之外`jQuery(document).ready()`：

```
<script type="text/javascript">

jQuery.validator.setDefaults({
    highlight: function (element, errorClass, validClass) {
        if (element.type === 'radio') {
            this.findByName(element.name).addClass(errorClass).removeClass(validClass);
        } else {
            $(element).addClass(errorClass).removeClass(validClass);
            $(element).closest('.control-group').removeClass('success').addClass('error');
        }
    },
    unhighlight: function (element, errorClass, validClass) {
        if (element.type === 'radio') {
            this.findByName(element.name).removeClass(errorClass).addClass(validClass);
        } else {
            $(element).removeClass(errorClass).addClass(validClass);
            $(element).closest('.control-group').removeClass('error').addClass('success');
        }
    }
});

</script> 
```

在里面添加这个`$(document).ready()`：

```
$("span.field-validation-valid, span.field-validation-error").addClass('help-inline');
$("div.control-group").has("span.field-validation-error").addClass('error');
$("div.validation-summary-errors").has("li:visible").addClass("alert alert-block alert-error"); 
```

你可以走了。

* * *

代码片段取自：

[使用 ASP.NET MVC 的 Twitter Bootstrap 验证样式](http://www.joe-stevens.com/2013/01/23/twitter-bootstrap-validation-styles-with-asp-net-mvc)

[将 Bootstrap 错误样式与 MVC 的不显眼的错误验证集成](http://www.braindonor.net/blog/integrating-bootstrap-error-styling-with-mvcs-unobtrusive-error-validation)

[@daveb 的回答](https://stackoverflow.com/a/18135224/114029)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-08T20:10:57.237

除了@leniel-macaferi 提供的[答案](https://stackoverflow.com/a/14650921/1238411)之外，我还使用以下内容作为我的 $(document).ready() 函数：

```
$(function () {
    $("span.field-validation-valid, span.field-validation-error").addClass('help-inline');
    $("div.control-group").has("span.field-validation-error").addClass('error');
    $("div.validation-summary-errors").has("li:visible").addClass("alert alert-block alert-error");
}); 
```

如果服务器端验证在表单发布上失败，这也会在控制组上设置“错误”类，并将任何验证摘要格式化为引导错误警报。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-13T23:24:07.580

我知道这是个老生常谈，但我想我会分享我的答案以更新 Bootstrap 3。在构建 Leniel Macaferi 提供的解决方案之前，我摸索了很长一段时间。

除了更改类以反映 Bootstrap 3 之外，我认为向用户展示一个代表字段状态的字形图标会是一个不错的选择。

```
(function ($) {
var defaultOptions = {
    errorClass: 'has-error has-feedback',
    validClass: 'has-success has-feedback',
    highlight: function (element, errorClass, validClass) {
        var _formGroup = $(element).closest(".form-group");
        _formGroup
            .addClass('has-error')
            .removeClass('has-success');

        if (!_formGroup.hasClass("has-feedback")) {
            _formGroup.addClass("has-feedback");
        }

        var _feedbackIcon = $(element).closest(".form-group").find(".glyphicon");
        if (_feedbackIcon.length) {
            $(_feedbackIcon)
                .removeClass("glyphicon-ok")
                .removeClass("glyphicon-remove")
                .addClass("glyphicon-remove");
        }
        else {
            $("<span class='glyphicon glyphicon-remove form-control-feedback' aria-hidden='true'></span>")
                .insertAfter(element);
        }
    },
    unhighlight: function (element, errorClass, validClass) {
        var _formGroup = $(element).closest(".form-group");
        _formGroup
            .removeClass('has-error')
            .addClass('has-success');

        if (!_formGroup.hasClass("has-feedback")) {
            _formGroup.addClass("has-feedback");
        }

        var _feedbackIcon = $(element).closest(".form-group").find(".glyphicon");
        if (_feedbackIcon.length) {
            $(_feedbackIcon)
                .removeClass("glyphicon-ok")
                .removeClass("glyphicon-remove")
                .addClass("glyphicon-ok");
        }
        else {
            $("<span class='glyphicon glyphicon-ok form-control-feedback' aria-hidden='true'></span>")
                .insertAfter(element);
        }
    }
};

$.validator.setDefaults(defaultOptions);

$.validator.unobtrusive.options = {
    errorClass: defaultOptions.errorClass,
    validClass: defaultOptions.validClass,
};

})(jQuery); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-10T13:14:11.727

尝试使用我制作的这个插件[https://github.com/sandrocaseiro/jquery.validate.unobtrusive.bootstrap](https://github.com/sandrocaseiro/jquery.validate.unobtrusive.bootstrap)

我所做的与其他答案不同的是用我自己的实现覆盖 validate.unobtrusive 中的`errorPlacement`and`success`方法，但不删除原始实现，所以什么都不会破坏。

我的实现如下所示：
**erroPlacement：**

```
function onError(formElement, error, inputElement) {
    var container = $(formElement).find("[data-valmsg-for='" + escapeAttributeValue(inputElement[0].name) + "']"),
        replaceAttrValue = container.attr("data-valmsg-replace"),
        replace = replaceAttrValue ? $.parseJSON(replaceAttrValue) !== false : null;

    //calling original validate.unobtrusive method
    errorPlacementBase(error, inputElement);

    if (replace) {
        var group = inputElement.parent();
        if (group.hasClass('form-group')) {
            group.addClass('has-error').removeClass('has-success');
        }
        group = group.parent();
        if (group.hasClass('form-group')) {
            group.addClass('has-error').removeClass('has-success');
        }
    }
} 
```

**成功：**

```
function onSuccess(error) {
    var container = error.data("unobtrusiveContainer");

    //calling original validate.unobtrusive method
    successBase(error);

    if (container) {
        var group = container.parent();
        if (group.hasClass('form-group')) {
            group.addClass('has-success').removeClass('has-error');
        }
        group = group.parent();
        if (group.hasClass('form-group')) {
            group.addClass('has-success').removeClass('has-error');
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-21T11:51:01.257

开箱即用，我想通过模糊来提高我的错误验证。我发现 Jquery Unobtrusive 并非如此。如果您有选择输入但没有文本类型输入，它似乎可以工作。为了解决这个问题，也许它很笨拙，但我使用了以下方法。

```
$(function () {
    $("input[type='text']").blur(function () {
        $('form').validate().element(this);
    });
}); 
```

您可以更改它只是在具有特定 css 类的某些输入上启用。

```
$(function () {
    $(".EnableOnblurUnobtrusiveValidation").blur(function () {
        $('form').validate().element(this);
    });
}); 
```

EnableOnblurUnobtrusiveValidation... 是一个有点长的名字，但你明白了。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-07-08T11:00:38.697

使用[TwitterBootstrapMvc](https://www.twitterbootstrapmvc.com/)。

它会自动处理不显眼的验证属性，您只需编写一个带有标签、输入和验证的完整控制组：

```
@Html.Bootstrap().ControlGroup().TextBoxFor(x => x.Field) 
```

祝你好运！

# c# - 我可以使用 Reactive Extensions 进行独立订阅/发布吗？

> ID：10217176
> 
> 赞同：1
> 
> 时间：2012-04-18T20:08:33.970
> 
> 标签：c#, system.reactive, publish-subscribe

假设我有一些 MyClass 类。在我的代码的一部分中，我想要这样的东西：

```
Observable.Subscribe<MyClass>(myClass => DoSomething(myClass)); 
```

然后在另一个地方（文件/项目/时间）我有这样的事情：

```
Observable.Publish(instanceOfMyClass); 
```

这第二行触发了使用该确切类类型订阅的所有方法。这是响应式扩展（v1 或 v2）支持的东西吗？

将 SynchronizationContext 指定为订阅调用的一部分会很有用。在那里指定方法是否应该使用 Wea​​kReference 也是很好的。并且 Publish 方法应该能够同步完成这一切，或者给我一些我可以等待的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:34:18.973

我相信您正在寻找类似 ReactiveUI 的[MessageBus 类](https://github.com/reactiveui/ReactiveUI/blob/master/ReactiveUI/MessageBus.cs)的东西。这个类使用 Rx 来实现发布/订阅模型，基本上只需要一个类型 => IObservables 的字典。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T03:34:19.653

这不难创造。

您只需要一个 internal`Dictionary<Type, Object>`并使用它来存储每个`Subject<T>`（作为对象）按`Type`.

然后，您可以只编写两个`Subscribe`和`Publish`方法来处理内部字典。

其实应该很简单。

* * *

与其说它很简单，我想我会试一试。

这是我的 Rx Pub/Sub 类：

```
public static class RxPS
{
    private static Dictionary<Type, object> _subjects
        = new Dictionary<Type, object>();

    public static IDisposable Subscribe<T>(Action<T> observer)
    {
        lock(_subjects)
        {
            if (!_subjects.ContainsKey(typeof(T)))
            {
                _subjects.Add(typeof(T), new Subject<T>());
            }
            return (_subjects[typeof(T)] as Subject<T>)
                .Subscribe(observer);
        }
    }

    public static void Publish<T>(T item)
    {
        lock(_subjects)
        {
            if (_subjects.ContainsKey(typeof(T)))
            {
                (_subjects[typeof(T)] as Subject<T>)
                    .OnNext(item);
            }
        }
    }
} 
```

这就是它的使用方式：

```
RxPS.Publish(1);
var d = RxPS.Subscribe<int>(x => Console.WriteLine(x)); 
RxPS.Publish(2);
d.Dispose();
RxPS.Publish(3); 
```

结果是此代码将`2`仅写入控制台。

享受！

# asp.net-mvc - ASP.NET Azure 项目似乎没有加载最新的内容项

> ID：10217177
> 
> 赞同：0
> 
> 时间：2012-04-18T20:08:35.257
> 
> 标签：asp.net-mvc, azure

我有一个 ASP.NET MVC 项目，我正在通过本地模拟器测试部署到 Windows Azure。我可以在开发服务器中正常运行项目文件，但是当我构建 Azure 项目并通过模拟器启动时，我遇到了内容文件未正确返回的问题。我的内部 CSS 和 JS 文件被重定向到登录页面，就好像授权失败一样；但是我看不出这个身份验证要求来自哪里。

我已经尝试过的事情：

*   我已经从两个项目中手动删除了所有构建文件（我还尝试了解决方案的“清理”操作）
*   我尝试将 Azure 项目全部删除，并从我的项目的当前版本创建一个新项目。
*   我曾尝试通过 Azure 存储接口清除本地存储。
*   我已验证我的所有内容在我的 ASP.NET 项目中都标记为“内容”。
*   我尝试将我的所有内容项标记为“始终复制”
*   我已验证已选中静态内容可选功能

**编辑：**我在网络上进行了部署，那里一切正常……这是一个模拟器问题。对这些新信息有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:15:42.020

您是否将 [Authorize] 属性放在某些控制器或控制器基础上？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:57:31.047

为了确定，您应该验证您的 web.config。你看到这样的东西吗？

```
<system.web>
  <authorization>
    <deny users="?" />
  </authorization>
...
</system.web> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T07:06:17.150

如果它在云和 ASP.NET 开发服务器中工作，我不太确定为什么它不能在模拟器中工作。但是，我认为该问题与您的应用程序无关。现在，我建议您检查 IIS 设置，例如 applicationHost.config。请查看是否有任何可能导致此问题的授权设置（Compute Emulator 在挂钩下使用 IIS 来托管 Web 角色）。还请尝试直接在本地 IIS 中托管该站点，看看是否会遇到相同的问题。如果你也可以在 IIS 中重现这个问题，我建议你考虑在这个线程中添加一个“IIS”标签，以便更多的 IIS 专家提供进一步的建议。

此致，

明旭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-14T21:00:47.760

这个线程已经打开了很长时间，所以我想用最终的解决方案关闭它。

它最终成为模拟器和正在使用的环境的错误。正如我所提到的，我能够在部署时让它工作。实际上，在更新到最新的 Azure 工具集后的 6 个月后，我尝试了同样的情况，它运行良好，所以我将其归结为模拟器中的一个错误，该错误已得到解决。

# javascript - html 元素上的标题显示在 safari 扩展中的 popover 下

> ID：10217181
> 
> 赞同：2
> 
> 时间：2012-04-18T20:09:22.333
> 
> 标签：javascript, html, safari, safari-extension

我目前正在将 Chrome 扩展程序移植到 Safari 并遇到了一个奇怪的错误。有些元素附有标题，以帮助解释它们的作用。这些在 Chrome 扩展中显示并正常工作，但在 Safari 上，它们实际上出现在弹出窗口后面。

这是一个示例：顶部是 Chrome，底部是 Safari。如您所见，标题在 Chrome 中显示良好，并说明如果单击该按钮会将您带到哪里。在 Safari 上……没那么多。

![Chrome 扩展程序](../Images/06f1d16fab181de5e5ac5fd044bbd2d3.png)

![在此处输入图像描述](../Images/caf7d2927bf936020edba28fc8fc0370.png)

html 由 javascipt 生成，因为这是他们创建的用户内容，但在两个平台上看起来完全相同。

```
<a href="#" onclick="triggerSearchClick(&quot;12506&quot;)" class="attachment"  style="margin-top: -11px;" title="http://www.apple.com/startpage/">
<img src="img/stream_bookmark_icon.png" class="attachment_icon">
<span class="blast_link">Apple - Start</span></a> 
```

您可以清楚地看到标题在那里，那么为什么这在 Safari 中不起作用？有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:43:05.360

```
.attachment
{
position:absolute;
z-index:1;
} 
```

尝试这个。将标题上的 z-index 设置为大于窗口以定义元素的堆叠顺序。

# android - Android 相机活动未启动

> ID：10217184
> 
> 赞同：0
> 
> 时间：2012-04-18T20:09:32.053
> 
> 标签：android, android-intent, android-camera, android-camera-intent

这是我的代码的一部分，用于一个简单的 android 相机应用程序，

```
public class CameraView extends Activity implements Callback, OnClickListener {

static final int FOTO_MODE = 0;
private static final String TAG = "CameraTest";
Camera mCamera;
boolean mPreviewRunning = false;
private Context mContext = this;

public void onCreate(Bundle icicle) {
    super.onCreate(icicle);

    Log.e(TAG, "onCreate");

    Bundle extras = getIntent().getExtras();

    getWindow().setFormat(PixelFormat.TRANSLUCENT);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.main);
    mSurfaceView = (SurfaceView) findViewById(R.id.surface_camera);
    mSurfaceView.setOnClickListener(this);
    mSurfaceHolder = mSurfaceView.getHolder();
    mSurfaceHolder.addCallback(this);
    mSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
}

Camera.PictureCallback mPictureCallback = new Camera.PictureCallback() {
    public void onPictureTaken(byte[] imageData, Camera c) {

        if (imageData != null) {

            Intent mIntent = new Intent();

            StoreByteImage(mContext, imageData, 50,
                    "ImageName");
            mCamera.startPreview();

            setResult(FOTO_MODE, mIntent);
            finish();

        }
    }
};

public void onClick(View arg0) {

    mCamera.takePicture(null, mPictureCallback, mPictureCallback);

} 
```

但是当我运行程序时，它在以下行中给出了空指针异常

```
mSurfaceView.setOnClickListener(this); 
```

我不明白这个问题。你们能澄清一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:23:54.037

```
mSurfaceView = (SurfaceView) findViewById(R.id.surface_camera); 
```

正在返回 null。空指针异常是因为您尝试访问的指针为空。

[在此处查看 findViewById API](http://developer.android.com/reference/android/app/Activity.html#findViewById%28int%29%20Here%20is%20the%20link%20to%20the%20API%20for%20findViewById)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:23:01.187

这`NullPointerException`意味着 mSurfaceView 是`null`.

在添加之前尝试添加此代码`OnClickListener`：

```
if (null == mSurfaceView)
  Log.e(TAG, "mSurfaceView is NULL!");
else
  Log.e(TAG, 'mSurfaceView IS OKAY!"); 
```

# sql - 这是伪装成 SQL 语句的专有功能吗？

> ID：10217189
> 
> 赞同：0
> 
> 时间：2012-04-18T20:09:39.227
> 
> 标签：sql, oracle

在我需要移植到 C# 的一些遗留 Delphi 代码中，我遇到了在我看来相当奇怪的 [e,o]“SQL 语句”。

有问题的 TQuery 组件具有以下 SQL 属性：

```
Begin
  MAILUTIL.SEND_MAILTXT@LEOPARD('rr@crk.com', :SUB , :TEXT, 'rr@crk.com');
  MAILUTIL.SEND_MAILTXT@LEOPARD('ba@rdlands.gov', :SUB , :TEXT, 'ba@rdlands.gov');
End; 
```

通常，SQL 属性是这样的字符串：

```
Select * from Bakery where Item = 'Pie' 
```

..所以这让我陷入了众所周知的循环。这是“甲骨文”还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:16:13.773

那是一个 PL/SQL 块（Oracle 对 SQL 的过程扩展）。我的猜测是`MAILUTIL`远程数据库`LEOPARD`中定义了一个包，该包中定义了一个`SEND_MAILTXT`过程。 `MAILUTIL`也可以是模式名称和`SEND_MAILTXT`独立过程，但这似乎不太可能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T20:15:32.380

是的，oracle 能够在 pl/sql 中发送电子邮件，但我认为这是一个不好的做法。尝试使用该“查询”将其移动到 rdbms 之外使用的任何编程语言，或在这种情况下调用外部脚本文件。

原因：如果邮件进程因任何原因失败，它可能会回滚整个事务，并且还有其他缺点。

# c++ - 与要定义的规则序列相关的 Makefile 行为

> ID：10217193
> 
> 赞同：0
> 
> 时间：2012-04-18T20:10:00.210
> 
> 标签：c++, makefile

我写了一个makefile，其中的命令序列在我的makefile中如下

```
 .PHONY: all clean distclean run
    run : $(program_NAME)
    ./$(program_NAME) > output.txt  #runs my program and stotre output in output.txt

    all: $(program_NAME)

    $(program_NAME): $(program_OBJS)
    $(LINK.cc) $(program_OBJS) -o $(program_NAME) 
```

如果我将其顺序更改为以下一个，它对我不起作用：-

```
 .PHONY: all clean distclean run
   $(program_NAME): $(program_OBJS)
   $(LINK.cc) $(program_OBJS) -o $(program_NAME)

   all: $(program_NAME)

    run : $(program_NAME)
    ./$(program_NAME) > output.txt  #runs my program and stotre output in output.txt 
```

这`doesnot generate any output.txt`对我来说。我觉得`run :`取决于 $(program_NAME) 所以`$(program_NAME): $(program_OBJS) $(LINK.cc) $(program_OBJS) -o $(program_NAME)s`应该`run :`在makefile之前出现。但反过来它工作正常。有人可以在这里发光吗？（谢谢）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:14:46.393

首先，您必须遵守 makefile 的缩进规则。由规则执行的命令应以制表符开头。然后，请注意，makefile 中出现的第一条规则会在您键入时自动执行`make`。在第一种情况下，程序运行。`run`要在规则不是第一个的第二个 makefile 中获得相同的规则，您必须执行`make run`.

# c# - 在 MSpec 中每次测试运行之前如何运行代码？

> ID：10217196
> 
> 赞同：3
> 
> 时间：2012-04-18T20:10:05.283
> 
> 标签：c#, .net, mspec

我正在尝试在测试之前运行一些初始化代码。我已经尝试过[其他问题中的建议](https://stackoverflow.com/questions/5906174/mspec-run-generic-setup-and-tear-down-code-with-each-test)，但它似乎不起作用。我的域模型通过以下类引发事件：

```
public static class DomainEvents
{
    private static readonly object @lock = new object();
    private static Action<IDomainEvent> raiseEvent;

    public static void Raise<TEvent>(TEvent @event) where TEvent : class, IDomainEvent 
    {
         // omitted for brevity
    }

    public static void RegisterEventPublisher(Action<IDomainEvent> eventPublisher)
    {
        lock (@lock)
        {
            raiseEvent = eventPublisher;
        }
    }
} 
```

出于测试目的，我想在静态列表中捕获这些事件。这样做的最佳方法是什么？

### 更新

问题是由运行测试的顺序引起的（正如亚历山大在下面指出的，不能保证）。在我的一个规范中，我注册了一个模拟事件发布者。规范经常以不同的顺序运行的事实意味着 a) 一开始我不知道我有问题（“问题”规范总是最后运行）和 b) 一旦我开始遇到问题，失败的测试通常会在运行之间有所不同（使其更加混乱）。

吸取的教训 - 在每个上下文运行后清理所有静态资源。您可以通过实施`ICleanupAfterEveryContextInAssembly`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:24:13.383

也许我误解了这个问题，但基本模式是：

```
public class WhenSomeDomainEventIsRaised
{
    private IList<IDomainEvent> EventsRaised = new List<IDomainEvent>();

    Establish context = () => 
    {
        // subscribe to events; when raised, add to EventsRaised list
    }
} 
```

如果您想对所有测试或测试子集执行此操作：

```
public abstract class DomainSpecification
{
    protected IList<IDomainEvent> EventsRaised = new List<IDomainEvent>();

    Establish context = () => 
    {
        // subscribe to events; when raised, add to EventsRaised list
    }
} 
```

您可以让所有需要此行为的规范都从此类继承，而 MSpec 将负责`Establish`沿继承层次结构运行所有块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T07:54:33.037

[这](https://github.com/agross/AssemblyContextSpecs)对我有用：

```
using System;
using System.Collections.Generic;

using Machine.Specifications;

namespace AssemblyContextSpecs
{
  public static class DomainEvents
  {
    static readonly object @lock = new object();

    static Action<IDomainEvent> raiseEvent;

    public static void Raise<TEvent>(TEvent @event) where TEvent : class, IDomainEvent
    {
      raiseEvent(@event);
    }

    public static void RegisterEventPublisher(Action<IDomainEvent> eventPublisher)
    {
      lock (@lock)
      {
        raiseEvent = eventPublisher;
      }
    }
  }

  public interface IDomainEvent
  {
  }

  class FooEvent : IDomainEvent
  {
  }

  public class DomainEventsContext : IAssemblyContext
  {
    internal static IList<IDomainEvent> Events = new List<IDomainEvent>();

    public void OnAssemblyStart()
    {
      DomainEvents.RegisterEventPublisher(x => Events.Add(x));
    }

    public void OnAssemblyComplete()
    {
    }
  }

  public class When_a_domain_event_is_raised
  {
    Because of = () => DomainEvents.Raise(new FooEvent());

    It should_capture_the_event =
      () => DomainEventsContext.Events.ShouldContain(x => x.GetType() == typeof(FooEvent));
  }
} 
```

不`RegisterEventPublisher`应该`RegisterEventSubscriber`吗？

# android - 如何制作一致的游戏循环

> ID：10217198
> 
> 赞同：0
> 
> 时间：2012-04-18T20:10:10.550
> 
> 标签：android, loops, view

所以在我的游戏中，我的视图被绘制的速率不一致。这反过来又使它出现故障。我在使用 invalidate(); 时遇到了很多问题；肉食。任何简单的想法——无论在哪里，我都会被大量密集的代码所困扰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:18:12.583

您没有向我们提供太多信息，特别是代码。

您可以做的几件事是：

1.  将初始帧速率设置为您观察到应用程序运行时的最低值，即，如果当前设置为 1/60，但帧速率连续下降到 1/30，设置为 1/30 等。
2.  返工您的绘图调用以提高效率。
3.  尝试通过矩阵相乘将多个变换组合成一个变换，即，如果您需要缩放、平移和旋转，将这三个矩阵相乘，然后将该单个变换应用于顶点，而不是应用三个单独的变换。
4.  如果不必要，尽量不要遍历整个列表/数组。
5.  尝试对必须在循环中处理的任何内容使用最低级别/最原始的结构，以避免拆箱的开销。

[编辑于 2012-08-27]

修复时间步的有用链接：http: [//gafferongames.com/game-physics/fix-your-timestep/](http://gafferongames.com/game-physics/fix-your-timestep/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:50:17.157

听起来您的游戏循环没有考虑迭代之间经过的实际时间。

问题是假设循环迭代之间有固定的时间量。但是这个时间可以根据场景中对象的数量、计算机上的其他进程甚至计算机本身而变化。

这是游戏编程中一个常见的、有些微妙的错误，但很容易纠正。诀窍是在每个绘制循环结束时存储时间，然后在开始时获取上次更新与当前时间的差值。然后，您应该根据实际经过的时间缩放所有动画和游戏更改。

不久前，我在我的博客上写了更多关于此的内容：http: [//laststop.spaceislimited.org/2008/05/17/programming-a-pong-clone-in-c-and-opengl-part-i /](http://laststop.spaceislimited.org/2008/05/17/programming-a-pong-clone-in-c-and-opengl-part-i/)

第二部分专门讨论了这个问题： http: [//laststop.spaceislimited.org/2008/06/02/programming-pong-in-c-and-opengl-part-ii/](http://laststop.spaceislimited.org/2008/06/02/programming-pong-in-c-and-opengl-part-ii/)

# python - 为什么使用 env 设置初始环境会阻止我在 Ubuntu 上启动 Python 脚本？

> ID：10217199
> 
> 赞同：2
> 
> 时间：2012-04-18T20:10:22.067
> 
> 标签：python, shell, env

我有一个测试脚本，例如“test.py”，我想让它在脚本开始之前使用特定的环境变量集执行：

```
#!/usr/bin/env TEST=anything python

print "Hello, world." 
```

运行它通常按预期工作：

```
$ python test.py 
Hello, world. 
```

但是，如果我将其作为程序运行：

```
$ chmod +x test.py
$ ./test.py 
```

该字符串从不打印，而是执行停止，“top”报告一个名为“test.py”的进程正在使用 100% CPU。

这只发生在我的 Ubuntu 机器上，在 OS X 上似乎没问题。

原因是最终我想通过设置使特定脚本始终在 32 位 Python 中运行：

```
#!/usr/bin/env VERSIONER_PYTHON_PREFER_32_BIT=yes python 
```

在文件的顶部。但是，如果这意味着脚本不会在 Linux 机器上执行，那就不行了。我发现无论调用什么指定的环境变量都会产生类似的效果。但是，如果没有设置环境变量：

```
#!/usr/bin/env python

print "Hello, world." 
```

脚本运行得很好：

```
$ ./test.py 
Hello, world. 
```

这是 Python 或 中的错误`env`，还是我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:18:20.567

在 Linux 上，

```
#!/usr/bin/env TEST=anything python 
```

`TEST=anything python`作为一个参数传递给`env`. 所以`env`不会正确处理参数。

最重要的是，您只能`env`在 shebang 行之后放置一个命令，其他所有内容最多都将被忽略。

来自[关于 Shebang 的 Wikipedia 条目](http://en.wikipedia.org/wiki/Shebang_%28Unix%29#Portability)：

> 另一个可移植性问题是命令参数的解释。包括 Linux 在内[的一些系统不会拆分参数 [24]](http://mail-index.netbsd.org/netbsd-users/2008/11/09/msg002388.html)；例如，当使用第一行运行脚本时，
> 
> #!/usr/bin/env python -c
> 
> 也就是说，python -c 将作为一个参数传递给 /usr/bin/env，而不是两个参数。Cygwin 也有这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:19:11.697

我怀疑`/usr/bin/env VERSIONER_PYTHON_PREFER_32_BIT=yes python`是否会正常运行。

相反，请尝试使用 Python 设置环境变量：

```
import os

os.environ['VERSIONER_PYTHON_PREFER_32_BIT'] = 'yes' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:53:04.687

您可能需要忘记 VERSIONER_PYTHON_PREFER_32_BIT，至少在 Linux 上是这样。在 Mac 上，您可以使用 shell 包装器。

然后在 Linux 上，您可能需要使用一个小的存根 python 脚本或 bash 脚本或其他东西重新发明 VERSIONER_PYTHON_PREFER_32_BIT，取决于以下内容：

```
>>> import platform
>>> platform.machine()
'x86_64'
>>> platform.processor()
'x86_64' 
```

# c++ - stringstream >> 不一致的 '\n' 分隔符行为

> ID：10217205
> 
> 赞同：3
> 
> 时间：2012-04-18T20:10:58.933
> 
> 标签：c++, string, parsing, stream

我有以下函数来读取文本流并将其分割成给定类型的向量：

```
template<class Type>
void parse_string(std::vector<Type> &type_vector, char *string) 
{
    std::stringstream stream(string);
    while (stream.good()) 
    {
        Type t;
        stream >> t;
        type_vector.push_back(t);
    }
} 
```

该`char *string`参数是表示浮点数或字符串的一大块文本，每个都用`' '`或分隔`'\n'`。

现在我的问题是，当给定 a 时`std::vector<float> type_vector`，该`parse_string`函数将由`' '`or`'\n'`分隔符分隔。例如：

```
0.01 0.02 0.03 0.04
0.05 0.06 0.07 0.08 
```

它将读取`'0.04'`和`'0.05'`作为单独的标记。这就是我要的！

但是，如果给定 a `std::vector<std::string> type_vector`，`parse_string`则只会分开 by `' '`。因此，如果我的文字如下：

```
root_joint left_hip left_knee left_ankle
left_foot right_hip right_knee right_ankle 
```

它将读取“left_ankleleft_foot”作为单个标记。似乎没有考虑到and`'\n'`之间存在一个。`'left_ankle'``'left_foot'`

这是什么原因造成的？

编辑：

在调试器中看到的确切 char* 参数如下：

```
0.01 0.02 0.03 0.040.05 0.06 0.07 0.08

root_joint left_hip left_knee left_ankleleft_foot right_hip right_knee right_ankle 
```

所以它似乎完全忽略了文件中的 '\n' ...

编辑2：

好吧，我知道我做错了什么。正如你们中的许多人所指出的，它与 stringstream 无关。

我的解析器需要文件的 std::vector 副本。在将文件读入字符串并将其转换为向量的过程中，我使用了 getLine(std::ifstream, std::string) 函数，您可以猜到，它会去除 '\n' 换行符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:40:41.153

您正在错误地读取字符串，因此 \n 被丢弃。\n 应该导致分裂。

# latex - 在编译期间生成 LaTeX 表格代码

> ID：10217210
> 
> 赞同：2
> 
> 时间：2012-04-18T20:11:27.387
> 
> 标签：latex

我使用 LaTeX 进行脑成像 (fMRI) 的科学报告。我`tabular`在 LaTeX 中有一个数组，其中包含很多行和列，它们都是大脑区域，并且在每个相交的单元格中都有一些关于它们连接的数据。

该数组的内容在另一个使用命令`tabular`加载的 .tex 文件中单独定义。`\input`在这个另一个 .tex 文件中，数组的每个单元格的内容是使用数百个命令`tabular`单独定义的。`\newcommand`数组中除了这些命令`tabular`外没有其他内容。数组在里面以允许对单元格值进行一些基本计算（尽管这不是必需的）。到目前为止一切正常。`\newcommand``tabular``\begin{spreadtab}`

因此，`\newcommand`定义如下所示：

```
\newcommand{\origREGIONONEdestREGIONONE}{ NA } % NA for cells on the diagonal.
\newcommand{\origREGIONONEdestREGIONTWO}{ - } % this is the default case. 
```

...

```
\newcommand{\origREGINOTWOdestREGIONTWO}{ NA }
\newcommand{\origREGIONTWOdestREGIONONE}{ \ref{Spielberg1981} }
\newcommand{\origREGIONTWOdestREGIONTHREE}{ bilateral \ref{Cameron1989} } 
```

...

所有列 x 行交叉点都有特定的`\newcommand`定义。

数组代码如下所示`tabular`（一个 3x3 示例，但实际上它大于 20x20）：

```
\tiny
\begin{table}
    \scalebox{0.6}{
        \begin{spreadtab}{{tabular}{*{3}{c}}}
            \hline
            \to/from :={} & REGION 1 :={} & REGION 2 :={} & REGION 3 :={} \\
            \hline
            to REGIONONE :={} & \origREGIONONEdestREGIONONE :={} & \origREGIONTWOdestREGIONONE :={} &\origREGIONTHREEdestREGIONONE :={} \\
            to REGIONTWO :={} & \origREGIONONEdestREGIONTWO :={} & \origREGIONTWOdestREGIONTWO :={} &\origREGIONTHREEdestREGIONTWO :={} \\
            to REGIONTHREE :={} & \origREGIONONEdestREGIONTHREE :={} & \origREGIONTWOdestREGIONTHREE :={} &\origREGIONTHREEdestREGIONTHREE :={} \\
            \hline
        \end{spreadtab}
    } % end scalebox
    \caption{A table of connections between brain regions 1, 2 & 3}
    \begin{enumerate}
        \item \cite{Spielberg1981}\label{Spielberg1981}
        \item \cite{Cameron1989}\label{Cameron1989}
    \end{enumerate}
\end{table}
\normalsize 
```

现在我想要的是能够`tabular`根据列表或字符串数​​组（或使用任何可能的数据类型）动态生成类似的定义：

在 MATLAB 语法中，它将是：`ListOfBrainRegions = { 'BRAINREGIONABC', 'BRAINREGIONDEF', 'BRAINREGIONXYZ' }`

在 Python 语法中：`ListOfBrainRegions = [ 'BRAINREGIONABC', 'BRAINREGIONDEF', 'BRAINREGIONXYZ' ]`

列表或数组将在内部翻译成这样的代码`spreadtab`（或者`spreadtab`如果它导致一些问题，则不翻译）：

```
 \hline
            to REGIONABC :={} & \origREGIONABCdestREGIONABC :={} & \origREGIONDEFdestREGIONABC :={} &\origREGIONXYZdestREGIONABC :={} \\
            to REGIONDEF :={} & \origREGIONABCdestREGIONDEF :={} & \origREGIONDEFdestREGIONDEF :={} &\origREGIONXYZdestREGIONDEF :={} \\
            to REGIONXYZ :={} & \origREGIONABCdestREGIONXYZ :={} & \origREGIONDEFdestREGIONXYZ :={} &\origREGIONXYZdestREGIONXYZ :={} \\
            \hline 
```

那么，我应该如何`ListOfBrainRegions`在 LaTeX 中定义呢？然后如何在编译 .tex 文件的过程中生成 LaTeX 代码？如果我用其他编程语言来编程，例如在 MATLAB、Common Lisp 或 awk 中，任务（生成程序代码）一点也不难。似乎 LaTeX 没有内置数组、……`if`命令或循环，尽管一些包提供了一些附加功能。那么，如何实现呢？或者，我应该使用哪些 LaTeX 命令、包和/或额外工具来完成这项任务？`elseif``else``for``while`

感谢您的任何帮助 ：）

# hibernate - 为什么 Grails/Hibernate 将我的列创建为 Long 类型？

> ID：10217217
> 
> 赞同：2
> 
> 时间：2012-04-18T20:11:58.643
> 
> 标签：hibernate, grails

我正在将我的应用程序从 Grails 1.3.7 升级到 2.0.1。给定这个域类，

```
class Person {

    String name

    static mapping = {
        name type: 'text'
    }
} 
```

我希望我的 Oracle 数据库中的“名称”列是 CLOB，因为它低于 1.3.7。相反，它是 Long 类型，这会导致各种问题。

我正在使用 Oracle OJDBC 驱动程序 (ojdbc6:11.1.0.7.0)。出于运行应用程序的目的，我连接到一个 Oracle XE 实例；我没有理由期望在 Oracle 11g 数据库上运行时会出现不同的行为。我的数据源 driverClassName 是“oracle.jdbc.OracleDriver”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:51:14.833

解决方案：

```
static mapping = {
    name sqlType: 'clob'
} 
```

我不知道如何核对此页面上的信息：

[类型](http://grails.org/doc/2.0.x/ref/Database%20Mapping/type.html "类型")

与此页面上的信息：

[列](http://grails.org/doc/latest/ref/Database%20Mapping/column.html "列")

...但至少它有效。

# php - 如何在 PHP 中使用 Soundex 和 SQLITE 来获得“你的意思是..”

> ID：10217220
> 
> 赞同：0
> 
> 时间：2012-04-18T20:12:03.560
> 
> 标签：php, sqlite, soundex

我知道有一个类似的线程，但它没有有用的答案。

我正在使用 SQLITE（不能更改语言），当用户填写表格时，其中一个字段是类别。

我希望他们输入一个类别，例如，他们可以输入：园艺。

但是，如果该类别已经存在“园艺”或者他们拼写错误，它会添加一个条目并在我搜索时导致问题。

我想知道是否可以在条目上使用 SOUNDEX 以将其与数据库进行匹配，并且如果存在一个 80% 相似的条目，或者它会给出一条消息：

您是说（类别）吗？

这将是一个链接，单击该链接将更改字段条目。

我正在寻找很多，所以提前感谢您的帮助。

**更新：**我的数据库具有类似于的值。所以：

类别：

园艺烹饪DIY

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:19:02.550

是的，但您需要将 soundex 值添加到数据库中，以便对它们进行搜索。否则，您需要提取表中的每条记录以通过 soundex 对其进行解析以进行匹配。预烘烤是要走的路。

Protip：如果你想有点模糊，请循环检查从输入值中截断 soundex 的片段。你会得到一个列表，首先是完美匹配，然后是接近的，然后是更远的。

# c - 使用 /clr 支持编译的 C++-CLI 库调试 C 程序

> ID：10217225
> 
> 赞同：0
> 
> 时间：2012-04-18T20:12:14.830
> 
> 标签：c, visual-studio, c++-cli

我有一个在 Visual Studio 中调试的现有 C 应用程序，我想访问其中的某些库函数。当我将库从其 c++/cli 源代码编译为 .lib 时，我可以在有或没有 clr 支持（`/clr`标志）的情况下对其进行编译。
如果我在有 clr 支持的情况下编译库，并将其与我的应用程序的其余部分链接，则调试器不能再停在不在使用 clr 支持编译的库中的特定代码行。
如果我在没有 clr 支持的情况下编译库并链接到该*库*库，调试器一切正常。我们需要在 clr 支持下编译这个库，我不想失去调试程序其余部分的能力。谁能告诉我为什么在链接 /clr 编译库而不是另一个时我失去了调试能力？是否有人知道如何正确编译/链接，以便我可以保持调试能力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:25:34.807

由于新的可执行文件包含本机代码和托管代码的*混合*，因此您必须将两种类型的调试器附加到它。在 Debug -> Attach to Process... 我选择了进程以及要附加**的**调试器的*类型。*在这种情况下，托管（v 4.0）和本机。

 **[在这里](https://stackoverflow.com/questions/10214144/debugging-a-c-executable-with-a-c-cli-library-compiled-with-clr/10217152#10217152 "这个问题得到了回答")更详细地回答。**

# ruby-on-rails - 使用活动记录回调更新模型属性

> ID：10217228
> 
> 赞同：2
> 
> 时间：2012-04-18T20:12:31.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

假设我有一个 Rails 应用程序处理`Posts`和`Comments`. 一个帖子`has_many`评论和每个评论`belongs_to`一个帖子。

每个评论都有一个`word_count property`. Post 对象有一个`average_comment_word_count`属性，它是每个 Comment 的平均值`word_count`。

`DELETE`当我针对特定评论发送请求时，应用程序应重新计算`average_comment_word_count`参数。我认为它的工作方式是这样的：

```
class Comment < ActiveRecord::Base

belongs_to :user
belongs_to :post
after_destroy :update_post_average_word_count

def update_post_average_word_count
  post_average_word_count = 0
  post.comments.each do |comment|
     post_average_word_count = post_average_word_count + comment.word_count
  end

  post_average_word_count / post.comments.count
  post.update_attributes average_word_count: post_average_word_count
end 
```

但是我收到一个数据库错误，因为该应用程序找不到对相关帖子的引用（因为评论已经消失，请在此处提示 Homer Simpson）

有没有不同的方法来完成这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:23:10.257

在计算 post_average_word_count 时使用`before_destroy`并考虑到这一点：

`post.update_attributes average_word_count: (post_average_word_count - self.word_count)`

# drupal - 如何使用基本页面的别名作为上下文过滤器

> ID：10217233
> 
> 赞同：4
> 
> 时间：2012-04-18T20:12:44.017
> 
> 标签：drupal, drupal-7, drupal-views

我有一个名为*Kids*的基本页面，其别名路径为：`example.com/kids`

我还有一个名为*Resources*的内容类型，它有标签。

我想创建一个块来获取所有带有标签“孩子”或任何基本页面别名的*资源。*我不想为每个基本页面创建一个带有硬编码过滤器的块。

我创建了一个视图，并将上下文过滤器设置为 URL 的第一个参数，希望它是基本页面的别名。不幸的是，这不起作用，因为上下文过滤器似乎在别名之后开始。

`example.com/kids`不返回任何结果。

`example.com/kids/kids`表现出我想要的行为并返回所有带有孩子标记的资源。但是，如果我创建嵌套在 Kids 下的第二个基本页面，它会停止工作，因为`kids/kids`它现在是一个有效的别名路径，因此上下文过滤器会忽略它。

tl;博士;

是否有任何模块或方法可以使用基本页面的别名作为上下文过滤器？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:03:34.147

在上下文过滤器设置中，您可以选择在未通过时设置默认值（这就是您的别名所发生的情况）。然后，您可以编写一些 PHP 来返回页面别名的最后一部分。

类似于：

```
return array_pop(explode('/',drupal_get_path_alias())); 
```

因此，现在当您访问“example.com/kids”时，上下文过滤器将包含“kids”参数。

别名路径“example.com/kids/kids”也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T11:27:21.417

即使我曾经面临同样的问题。这就是我所做的。

制作了一个名为 X 的回调 / 菜单，并将其传递给 X/A 之类的菜单，其中 A 是您的案例中的参数“孩子”。现在使用 URL 别名，将此 URL 重写为 X/A 到 A

这种方式它完美地为我工作，并且仍然有效。

# java - JPA：读锁是如何工作的？

> ID：10217234
> 
> 赞同：7
> 
> 时间：2012-04-18T20:12:49.430
> 
> 标签：java, jpa, concurrency, locking, optimistic-locking

我试图了解调用 EntityManager.lock(entity, LockModeType.READ) 的效果。API 文档对我来说听起来很混乱。

如果我必须并发线程并且线程 1 调用 lock(entity, LockModeType.READ)，线程 2 仍然可以读写实体吗？

到目前为止我学到了什么：

JPA1 中的锁类型 READ 与 JPA2 中的 OPTIMISTIC 相同。如果设置了这样的锁，EntityManager 在提交事务之前检查版本属性，但不会更新它。我找到了对 OPTIMIISTIC 锁定模式的解释：[Link](http://java.dzone.com/articles/jpa-20-concurrency-and-locking)。搜索 OPTIMIISTIC (READ) LockMode 示例。据我了解，在线程 1 中设置读锁对线程 2 ... n 没有影响。所有其他线程仍然可以读取和写入实体。但是当线程 1 中的事务提交并且另一个线程更新了实体时，线程 1 中的事务被回滚。

我理解正确吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:08:30.387

无论如何，Read 目前已被弃用，但只是为了您的理解：

READ 锁将确保对象的状态在提交时不会更改，因为 READ 锁允许其他事务更新或删除它，然后如果线程 1 进行了一些更改然后提交它首先检查状态（版本）实体如果检查，则提交，否则不允许，

所以基本上你的理解是正确的。

还有 OPTIMISTIC_READ 是现代的使用方式（也有 _WRITE）。

**更新**

好的，这篇[文章](http://www.objectdb.com/java/jpa/persistence/lock)对我理解有很大帮助，希望对您有所帮助。

# c# - 神经网络，输出小于 1

> ID：10217240
> 
> 赞同：-1
> 
> 时间：2012-04-18T20:12:59.570
> 
> 标签：c#, neural-network

我正在尝试为函数`y=e^(-(x-u)^2)/(2*o^2))`where`u = 50`和`o = 15`.

我必须训练我的神经网络，这样我才能找到每个 y 的 2 个 x。我已经创建了以下代码，它似乎学得很好，但是一旦我测试输出，我只能得到大约 0.99 到 1 的数字，而我应该得到 25 和 75，我就是不明白为什么。我最好的猜测是我的纠错错误，但找不到错误。神经网络使用反向传播。

测试代码和训练集

```
class Program
    {
        static void Main(string[] args)
        {
            args = new string[] {
                "c:\\testTrain.csv",
                "c:\\testValues.csv"
            };

            // Output File
            string fileTrainPath = null;
            string fileValuesPath = null;
            if (args.Length > 0)
            {
                fileTrainPath = args[0];
                if (File.Exists(fileTrainPath))
                    File.Delete(fileTrainPath);
                fileValuesPath = args[1];
                if (File.Exists(fileValuesPath))
                    File.Delete(fileValuesPath);
            }

            double learningRate = 0.1;
            double u = 50;
            double o = 15;

            Random rand = new Random();

            Network net = new Network(1, 8, 4, 2);
            NetworkTrainer netTrainer = new NetworkTrainer(learningRate, net);

            List<TrainerSet> TrainerSets = new List<TrainerSet>(); 
            for(int i = 0; i <= 20; i++)
            {
                double random = rand.NextDouble();

                TrainerSets.Add(new TrainerSet(){
                    Inputs = new double[] { random },
                    Outputs = getX(random, u, o)
                });
            }

            // Train Network
            string fileTrainValue = String.Empty;
            for (int i = 0; i <= 10000; i++)
            {
                if (i == 5000)
                { }
                double error = netTrainer.RunEpoch(TrainerSets);
                Console.WriteLine("Epoch " + i + ": Error = " + error);
                if(fileTrainPath != null)
                    fileTrainValue += i + "," + learningRate + "," + error + "\n";
            }
            if (fileTrainPath != null)
                File.WriteAllText(fileTrainPath, fileTrainValue);

            // Test Network
            string fileValuesValue = String.Empty;
            for (int i = 0; i <= 100; i++)
            {
                double y = rand.NextDouble();
                double[] dOutput = getX(y, u, o);
                double[] Output = net.Compute(new double[] { y });

                if (fileValuesPath != null)
                    fileValuesValue += i + "," + y + "," + dOutput[0] + "," + dOutput[1] + "," + Output[0] + "," + Output[1] + "\n";
            }
            if (fileValuesPath != null)
                File.WriteAllText(fileValuesPath, fileValuesValue);
        }

        public static double getResult(int x, double u, double o)
        {
            return Math.Exp(-Math.Pow(x-u,2)/(2*Math.Pow(o,2)));
        }

        public static double[] getX(double y, double u, double o)
        {
            return new double[] {
                u + Math.Sqrt(2 * Math.Pow(o, 2) * Math.Log(1/y)),
                u - Math.Sqrt(2 * Math.Pow(o, 2) * Math.Log(1/y)),
            };
        }
    } 
```

网络背后的代码

```
public class Network
{
    protected int inputsCount;
    protected int layersCount;
    protected NetworkLayer[] layers;
    protected double[] output;

    public int Count
    {
        get
        {
            return layers.Count();
        }
    }
    public NetworkLayer this[int index]
    {
        get { return layers[index]; }
    }

    public Network(int inputsCount, params int[] neuronsCount)
    {
        this.inputsCount = Math.Max(1, inputsCount);
        this.layersCount = Math.Max(1, neuronsCount.Length);

        layers = new NetworkLayer[neuronsCount.Length];
        for (int i = 0; i < layersCount; i++)
            layers[i] = new NetworkLayer(neuronsCount[i],
                (i == 0) ? inputsCount : neuronsCount[i - 1]);
    }

    public virtual double[] Compute(double[] input)
    {
        output = input;

        foreach (NetworkLayer layer in layers)
            output = layer.Compute(output);

        return output;
    }
}
public class NetworkLayer
{
    protected int inputsCount = 0;
    protected int neuronsCount = 0;
    protected Neuron[] neurons;
    protected double[] output;

    public Neuron this[int index]
    {
        get { return neurons[index]; }
    }
    public int Count
    {
        get { return neurons.Length; }
    }
    public int Inputs
    {
        get { return inputsCount; }
    }
    public double[] Output
    {
        get { return output; }
    }

    public NetworkLayer(int neuronsCount, int inputsCount)
    {
        this.inputsCount    = Math.Max( 1, inputsCount );
        this.neuronsCount   = Math.Max( 1, neuronsCount );

        neurons = new Neuron[this.neuronsCount];
        output = new double[this.neuronsCount];

        // create each neuron
        for (int i = 0; i < neuronsCount; i++)
            neurons[i] = new Neuron(inputsCount);
    }

    public virtual double[] Compute(double[] input)
    {
        // compute each neuron
        for (int i = 0; i < neuronsCount; i++)
            output[i] = neurons[i].Compute(input);

        return output;
    }
}
public class Neuron
{
    protected static Random rand = new Random((int)DateTime.Now.Ticks);

    public int Inputs;
    public double[] Input;
    public double[] Weights;
    public double Output = 0;
    public double Threshold;
    public double Error;

    public Neuron(int inputs)
    {
        this.Inputs = inputs;
        Weights = new double[inputs];

        for (int i = 0; i < inputs; i++)
            Weights[i] = rand.NextDouble() * 0.5;
    }

    public double Compute(double[] inputs)
    {
        Input = inputs;

        double e = 0.0;
        for (int i = 0; i < inputs.Length; i++)
            e += Weights[i] * inputs[i];

        e -= Threshold;
        return (Output = sigmoid(e));
    }

    private double sigmoid(double value)
    {
        return (1 / (1 + Math.Exp(-1 * value)));
        //return 1 / (1 + Math.Exp(-value));
    }
} 
```

我的教练

```
public class NetworkTrainer
{
    private Network network;
    private double learningRate = 0.1;

    public NetworkTrainer(double a, Network network)
    {
        this.network = network;
        this.learningRate = a;
    }

    public double Run(double[] input, double[] output)
    {
        network.Compute(input);

        return CorrectErrors(output);
    }

    public double RunEpoch(List<TrainerSet> sets)
    {
        double error = 0.0;
        for (int i = 0, n = sets.Count; i < n; i++)
            error += Run(sets[i].Inputs, sets[i].Outputs);

        // return summary error
        return error;
    }

    private double CorrectErrors(double[] desiredOutput)
    {
        double[] errorLast = new double[desiredOutput.Length];

        NetworkLayer lastLayer = network[network.Count - 1];
        for (int i = 0; i < desiredOutput.Length; i++)
        {
            // S(p)=y(p)*[1-y(p)]*(yd(p)-y(p))
            lastLayer[i].Error = lastLayer[i].Output * (1-lastLayer[i].Output)*(desiredOutput[i] - lastLayer[i].Output);
            errorLast[i] = lastLayer[i].Error;
        }

        // Calculate errors
        for (int l = network.Count - 2; l >= 0; l--)
        {
            for (int n = 0; n < network[l].Count; n++)
            {
                double newError = 0;
                for (int np = 0; np < network[l + 1].Count; np++)
                {
                    newError += network[l + 1][np].Weights[n] * network[l + 1][np].Error;
                }
                network[l][n].Error = newError;
            }
        }

        // Update Weights
        // w = w + (a * input * error)
        for (int l = network.Count - 1; l >= 0; l--)
        {
            for (int n = 0; n < network[l].Count; n++)
            {
                for (int i = 0; i < network[l][n].Inputs; i++)
                {
                    // deltaW = a * y(p) * s(p)
                    double deltaW = learningRate * network[l][n].Output * network[l][n].Error;
                    network[l][n].Weights[i] += deltaW;
                }

            }
        }

        double returnError = 0;
        foreach (double e in errorLast)
            returnError += e;
        return returnError;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T10:04:17.923

对于回归问题，您的输出层应该具有标识（或至少是线性）激活函数。这样您就不必缩放输出。恒等函数的导数为 1，因此输出层的导数 dE/da_i 为 yt (· `lastLayer[i].Output - desiredOutput[i]`)。

# mercurial - 无法克隆存储库（“不允许操作： / /.hg/需要")

> ID：10217245
> 
> 赞同：3
> 
> 时间：2012-04-18T20:13:18.390
> 
> 标签：mercurial

提前抱歉我的英语不好......
我正在尝试在 Ubuntu 上使用 Eclipse 克隆一个 hg 存储库。
当我执行“hg clone”命令时，我总是收到以下错误消息：

```
"Operation not permitted: <workspace_folder>/<project_name>/.hg/requires" 
```

这是 /.hg 内容：

```
ls -al .hg/
total 40K
drwxrwxr-x 4 www-data web 4.0K Apr 18 09:33 .
drwxrwxr-x 3 www-data svn 4.0K Mar  5 17:52 ..
-rwxrwxr-x 1 www-data web   57 Mar  5 17:48 00changelog.i
drwxrwxr-x 2 www-data web 4.0K Apr 18 09:33 cache
-rwxrwxr-x 1 www-data web   40 Mar  5 17:51 dirstate
-rwxrwxrwx 1 www-data web   40 Apr 18 21:45 requires
drwxrwxr-x 3 www-data web 4.0K Apr 18 09:33 store
-rw-rw-r-- 1 nico     web    0 Apr 18 09:33 undo.bookmarks
-rw-rw-r-- 1 nico     web    7 Apr 18 09:33 undo.branch
-rw-rw-r-- 1 nico     web   38 Apr 18 09:33 undo.desc
-rw-rw-r-- 1 nico     web   40 Apr 18 09:33 undo.dirstate 
```

这是 /.hg/requires 文件内容：

```
revlogv1
store
fncache
dotencode 
```

这是 hg clone 命令的输出：

```
running ssh nico@www.there.com "hg -R /var/dev/projects/my_hg_project serve --stdio"
sending hello command
sending between command
nico@www.there.com's password:
remote: 145
remote: capabilities: lookup changegroupsubset branchmap pushkey known getbundle unbundlehash batch stream unbundle=HG10GZ,HG10BZ,HG10UN httpheader=1024
remote: 1
destination directory: my_hg_project
abandon : Operation not permitted : /media/data/workspaces/my_workspace/my_hg_project/.hg/requires 
```

我尝试了很多东西，例如 chmod 和 chown ......我不是 linux 专家，所以我用谷歌搜索了我的错误消息，但结果并不多。有人对此有任何想法吗？

非常感谢您提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:38:26.477

您考虑文件权限是正确的，因为这是根本原因，但我有点困惑。您是否在服务器上显示文件权限，但在工作站上看到该消息？您到底想从哪里克隆到哪里？你是通过http还是ssh克隆？您以什么用户身份运行克隆命令？

# asp.net - 使用 SlowCheetah 和 ASP.NET 网站项目进行 Web.config 转换

> ID：10217247
> 
> 赞同：7
> 
> 时间：2012-04-18T20:13:24.703
> 
> 标签：asp.net, web-deployment-project, web-site-project, xslt, slowcheetah

我正在尝试`ASP.NET Web site project`在 Visual Studio 2010 中将 SlowCheetah XML 转换与（不是 ASP.NET Web 应用程序项目）一起使用。

`Web.config`当我在我的 ASP.NET 网站项目中右键单击该文件时，我`Add Transform`在上下文菜单中看不到“”项。

（注意：尝试使用 ASP.NET Web 应用程序项目时效果很好）。

*   是否可以将 SlowCheetah 与 一起使用`ASP.NET Web site project`？
    还是因为这种项目有局限性而“按设计”是不可能的？

可能有一种解决方法将“ [Web 部署项目 2010](http://www.microsoft.com/download/en/details.aspx?id=19995) ”和 SlowCheetah的“ `*.targets`”文件合并...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T19:04:03.863

SlowCheetah 不支持网站项目。您在这里为网站项目设想的行为是什么？对于 WAP 项目，它们是在打包/发布期间启动的。对于 Web 部署项目建议，我在[https://github.com/sayedihashimi/slow-cheetah/issues/4](https://github.com/sayedihashimi/slow-cheetah/issues/4)创建了一个问题来跟踪它，但我不确定它实际上是如何工作的。我得考虑一下。

### 更新

网站项目现在具有与 Web 应用程序项目相同的发布支持，[http://blogs.msdn.com/b/webdev/archive/2012/11/20/new-web-publish-updates.aspx](http://blogs.msdn.com/b/webdev/archive/2012/11/20/new-web-publish-updates.aspx)，如果您喜欢 SlowCheetah要支持转换 XML 文件，请在以下位置投票：[https ://slowcheetah.uservoice.com/forums/185106-general/suggestions/3398137-support-for-website-project](https://slowcheetah.uservoice.com/forums/185106-general/suggestions/3398137-support-for-website-project)

# html - 如何显示带有对象和嵌入标签的本地视频文件？

> ID：10217250
> 
> 赞同：4
> 
> 时间：2012-04-18T20:13:36.810
> 
> 标签：html, video, embed, object-tag

所以我的视频文件在 C:\inetpub\wwwroot\Videos\Test\intro.wmv 中。我只想在我的网页上本地运行视频。

它必须在 IE8/WinXP 上运行。所以没有HTML5。

这是我到目前为止所拥有的：

```
<object width="100%" height="100%"
type="video/x-ms-asf" url="http://localhost/Videos/Test/intro.wmv" data="intro.wmv"
classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6">
<param name="url" value="http://localhost/Videos/Test/intro.wmv">
<param name="filename" value="intro.wmv">
<param name="autostart" value="1">
<param name="uiMode" value="full" />
<param name="autosize" value="1">
<param name="playcount" value="1">
<embed type="application/x-mplayer2" src="http://localhost/Videos/Test/intro.wmv" width="100%" height="100%" autostart="true" showcontrols="true" pluginspage="http://www.microsoft.com/Windows/MediaPlayer/"></embed>
</object> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:23:38.390

尝试一些更简单的开始，例如：

```
<object data="./Videos/Test/intro.wmv" type="video/x-ms-wmv"  width="100%" height="100%">
  <param name="src" value="./Videos/Test/intro.wmv">
  <param name="autoStart" value="1">
  alt : <a href="./Videos/Test/intro.wmv">My video name</a>
</object> 
```

或 HTML5

```
<video width="320" height="240" controls="controls">  
    <source src="./Videos/Test/intro.wmv" type="video//x-ms-wmv" />   
    <!-- <track src="subtitles_en.vtt" kind="subtitles" srclang="en" label="English"> -->     
    Nav doesn't support html5 video
</video> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:49:20.347

这至少有效。

```
<object width="100%" height="100%"
type="video/x-ms-asf" url="/wiki/Videos/Test/intro.wmv" data="/wiki/Videos/Test/intro.wmv"
classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6">
<param name="url" value="/wiki/Videos/Test/intro.wmv">
<param name="filename" value="/wiki/Videos/Test/intro.wmv">
<param name="autostart" value="1">
<param name="uiMode" value="full" />
<param name="autosize" value="1">
<param name="playcount" value="1">
<embed type="application/x-mplayer2" src="/wiki/Videos/Test/intro.wmv" width="100%" height="100%" autostart="true" showcontrols="true" pluginspage="http://www.microsoft.com/Windows/MediaPlayer/"></embed>
</object> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:54:22.143

```
<video width="320" height="240" controls="controls">
  <source src="movie.mp4" type="video/mp4" />
  <source src="movie.ogg" type="video/ogg" />
  <source src="movie.webm" type="video/webm" />
<object data="movie.mp4" width="320" height="240">
  <embed src="movie.swf" width="320" height="240" />
</object> 
</video> 
```

将其另存为 html 文件在视频所在的同一文件夹中，这是在 html 5 中，给出相对路径然后给出绝对路径总是好的。

# wso2 - 跨 Stratos 配置单点登录

> ID：10217252
> 
> 赞同：0
> 
> 时间：2012-04-18T20:13:56.697
> 
> 标签：wso2, wso2is, wso2stratos

我有一种情况，我需要设置一个独立版本的 wso2 Identity Server，并让它充当 Stratos 中所有产品的 SSO 提供者。

目前我已经配置了 Stratos 身份服务器，以便我可以使用管理员通过独立的身份服务器登录。

但是，如果我使用另一个用户，我要么

1.  获得“授权失败”
2.  或无法登录。

**第一个问题**

1）我在两个身份服务器中创建了相同的用户（不是管理员）。为什么会出现“授权失败”？

**第二个问题**

2) 如果我创建了一个用户名格式为 user@domain.com 的用户，为什么我什至无法解决“授权失败”问题？

更新：

我发现如果我删除 user-mgt.xml 中使用正则表达式引用用户名的属性标签，我就能够以 name@domain.com 的格式创建用户名。但是我仍然无法使用该用户名登录，错误日志显示该帐户尚未激活。

我还创建了两个 wso2 身份服务器实例，并以这样的方式配置它们以测试是否能够使用一个来登录到另一个。我能够通过确保相同的用户名和密码在两个服务器的用户列表中来做到这一点。这样我就不会得到“授权失败”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:14:41.057

我想出的答案。
1\. 我需要在每个 Identity Server 中拥有相同的用户名和密码。
2\. 除非我配置了多租户，否则我无法使用 name@domain.com 格式。否则 wso2 将尝试在 Tenant 表中查找 ACTIVATE 字段而找不到它。

更新：我安装并配置了它，结果我现在收到另一个错误

```
Issuer details are not valid. Issuer details should be registered in advance 
```

所以我的回答被证明是无效的。

```
I wonder why I get this new login failure? 
```

更新已解决！！：
我通过仅下载 wso2 stratos IS 1.5.2 软件包解决了这个问题。我安装了它。配置与我之前使用的相同配置。现在我可以跨域登录而不会出现问题。

# ios - iPhone编程中的preg_match_all(PHP)等函数/库

> ID：10217278
> 
> 赞同：1
> 
> 时间：2012-04-18T20:15:52.533
> 
> 标签：ios, iphone, ipad, parsing

我正在搜索类似于 preg_match_all （或类似）的函数，例如 PHP。

我想给出一个模式和我的 NSData 对象（带有 HTML 内容），然后得到所有适合模式的结果。

我正在为 iOS 5 编程。是否有任何库或函数可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:24:01.157

当我开始编写 iOS 应用程序时，我遇到了同样的问题。

[http://regexkit.sourceforge.net/](http://regexkit.sourceforge.net/)确实帮助了我很多。但慢慢地，我也很欣赏 NSPredicate 的强大功能。

但是如果你——像我一样——喜欢 preg_match_all，你需要在你的项目中包含 regexkit (lite)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:27:50.740

看看[NSRegularExpression](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)类。

这是使用它的代码片段：

```
    NSError *error = nil;
    NSRegularExpression *tagsRegex = [NSRegularExpression
         正则表达式WithPattern:@"(<b>|<u>|<i>|<br/?>)"
                              选项：NSRegularExpressionCaseInsensitive
                                错误：&错误];
    如果（！tagsRegex）{
        NSLog(@"标签正则表达式创建错误：%@", [错误本地化描述]);
    }

    if ([tagsRegex numberOfMatchesInString:marketingMessage 选项:0
                        范围：NSMakeRange(0, [marketingMessage 长度])])
    {
        ...
    }

```

# windows-phone-7 - 从传递 HTML 内容的应用程序启动 IE

> ID：10217280
> 
> 赞同：0
> 
> 时间：2012-04-18T20:16:05.900
> 
> 标签：windows-phone-7

我需要从我的 WP7 应用程序启动 IE 并加载 HTML 以动态创建页面。HTML 是从 Web 服务中读取的，并且可以随时更改，因此我不能只将 HTML 存储在文件中。有没有办法做到这一点——就像你对 WebBrowser.NavigateToString(strHtml) 所做的那样？-谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:24:31.910

如果您尝试在嵌入式[WebBrowser](http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.webbrowser%28v=vs.92%29.aspx)控件中打开您的 HTML 内容，您可以使用“NavigateToString”函数并将您想要加载的 HTML 内容传递给它。

如果您尝试在设备上的本机 IE 浏览器中打开它，那么我建议将状态信息放在 URL 中，并使用通过[WebBrowserTask](http://msdn.microsoft.com/en-us/library/microsoft.phone.tasks.webbrowsertask%28v=vs.92%29.aspx)在浏览器中复制视图所需的任何参数直接打开页面。这样，从技术上讲，您不会从您的应用程序中打开 HTML 代码，但您将能够根据您的查询参数确保从您的服务加载的 HTML 内容是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:21:25.993

您在寻找[WebBrowserTask](http://msdn.microsoft.com/en-us/library/microsoft.phone.tasks.webbrowsertask%28v=vs.92%29.aspx)吗？

# c - 为什么这个 long double 不能使用 printf 正确打印出来？

> ID：10217283
> 
> 赞同：1
> 
> 时间：2012-04-18T20:16:28.047
> 
> 标签：c, printf, long-double

我需要使用 long double 进行除法，大约为 1/10^23，但是当我使用 printf 检查它们时，数字会被截断。有谁知道我怎样才能看到完整的号码？例如：

```
long double a = 1;
long double b = 3;
printf ("%Lf", a/b ); 
```

但我得到：

```
0.333333 
```

例如，我想[在这里显示完整的数字](https://stackoverflow.com/questions/4089174/printf-and-long-double)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:19:58.333

`%f`格式打印小数点后 6 位。您可以使用`%.df`打印 d 位。或者更好的是，用于`%.dg`使大/小值也可读。

# c# - 如何使自定义 XAML 用户控件可绑定？

> ID：10217284
> 
> 赞同：6
> 
> 时间：2012-04-18T20:16:34.710
> 
> 标签：c#, wpf, xaml

我正在制作一个简单的演示来学习如何创建可绑定的用户控件。我创建了一个简单的类：

```
class Person
{
    public string firstName;
    public string lastName;    
    public Person(string first, string last)
    {
        firstName = first;
        lastName = last;
    }
} 
```

还有一个非常简单的用户控件：

```
<UserControl x:Class="Example.ExampleHRControl"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <TextBlock x:Name="textFirstName"></TextBlock>
        <TextBlock x:Name="textLastName"></TextBlock>
    </Grid>
</UserControl> 
```

我想知道的是我需要做什么才能像普通控件一样在上下文中使用用户控件。我可以将其添加到`MainWindow`：

```
<local:ExampleHRControl x:Name="Hr1"></local:ExampleHRControl> 
```

然后我可以通过后面的代码解决它并添加值：

```
Hr1.textFirstName.Text = "John";
Hr1.textLasttName.Text = "Doe"; 
```

我希望能够创建该类的一个实例，`Person`并将主窗口上的控件简单地绑定到`Person`该类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T21:11:54.890

要完成这项工作，您需要做几件事。

在您的代码隐藏中，为您希望控件了解的 Person 对象添加依赖属性：

```
 public static readonly DependencyProperty PersonProperty =
                          DependencyProperty.Register("Person", typeof(Person),
                                                      typeof(ExampleHRControl));

   public Person Person
   {
      get { return (Person)GetValue(PersonProperty); }
      set { SetValue(PersonProperty, value); }
   } 
```

在您的 XAML 中，将您的代码隐藏设置为您的数据上下文并将绑定添加到您的人员对象：

```
<UserControl x:Class="Example.ExampleHRControl"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300"
         x:Name="This">
    <Grid>
        <TextBlock x:Name="{Binding Path=Person.FirstName, ElementName=This}"/>
        <TextBlock x:Name="{Binding Path=Person.LastName, ElementName=This}"/>
    </Grid>
</UserControl> 
```

现在，只要设置了 Person 属性，您的控件就会使用与 Person 关联的名字和姓氏来更新自身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:33:53.280

您想要调用的依赖属性可以从 xaml 绑定到它。
1-创建字段

```
public static readonly DependencyProperty FirstNameProperty = 
    DependencyProperty.Register(
    "FirstName", typeof(Strin), 
```

2-创建属性

```
public String FirstName
{
    get { return (String)GetValue(FirstNameProperty); }
    set { SetValue(FirstNameProperty, value); }
} 
```

3-您可以在 XAML 中使用它来绑定它或只使用它

```
<local:YourControlName FirstName="john"/>

<local:YourControlName FirstName="{Binding MyFirstName}"/> 
```

*   使用[Resharper](http://www.jetbrains.com/resharper/)将帮助您编写干净的代码并拥有非常强大的 IntelliSense

# php - 为时间敏感的 Web 应用程序生成统计信息

> ID：10217285
> 
> 赞同：1
> 
> 时间：2012-04-18T20:16:40.637
> 
> 标签：php, mysql, statistics

我们正在运行一个对时间非常敏感的 Web 应用程序（响应时间必须低于 100 毫秒），有很多请求（峰值时每分钟大约 20 万个请求）。架构非常简单：一个负载均衡器、几个 Web 服务器、运行 apache 和 php，以及一个运行 MySQL 的数据库。

我们还需要能够根据这些请求生成统计信息。

大约一年前，当我们为当前流量的十分之一提供服务时，我们开发了一些 bash/python 脚本来定期从 mysql 转储日志，将它们传输到另一台服务器，再次导入它们并在那里运行统计信息，其想法是让生产服务器尽可能少地做，这样我们就可以有一个较短的响应时间。

正如您可能想象的那样，该解决方案的扩展性不是很好，目前，统计服务器几乎没有跟上。我们需要一种实时生成统计数据的方法。

你有这种设置的经验吗？我们目前的想法是让 Web 服务器在每个请求上实时调用统计服务器。

两个主要问题是：

*   我们应该如何解决这个问题，以便响应时间不会增加太多
*   统计服务器或服务器必须处理来自所有 webheads 的所有请求/或者它需要能够水平扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:21:53.450

为什么要使用数据库？在请求进入时动态计算内存中的平均值和标准偏差。这样不会有任何延迟，并且可以使用 MBean 控制台访问值。

这只能在单个服务器上工作，而不是在集群上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:18:00.693

1) 独立的 MySQL 服务器 为什么不直接连接到另一个 MySQL 服务器并在那里写入统计信息？此时此刻，我会想到每天都创建一张桌子，这样我就可以在不需要时轻松地将旧桌子移出。这里的问题是缺乏水平可扩展性虽然......

2) NoSQL 也许你应该使用 MongoDB 或 Redis 来处理这样的事情？它们速度更快，因为它们基于内存并提供分片。

3) 独立的统计服务器如果您提供 HTML，您可以在远程服务器上添加 javascript 方法来调用脚本（以及带有 url 的小 img 标签，用于禁用 javascript 的用户），远程服务器可以从 URL 中给出的参数写入统计信息。这将完全从应用程序服务器上卸载所有内容，您可以在那里尝试建议 #1 或 #2 ...

# c# - Silverlight - 文本块的宽度

> ID：10217286
> 
> 赞同：1
> 
> 时间：2012-04-18T20:16:51.253
> 
> 标签：c#, silverlight, windows-phone-7, width, textblock

这是一个简单的问题：

我如何获得`Width`a `TextBlock`？

在 XAML 中，其宽度`TextBlock`设置为 Auto。

我如何通过代码获得`Width`这个？`TextBlock`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:20:04.483

使用[`ActualWidth`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.actualwidth%28v=vs.95%29.aspx)物业

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:20:17.343

只需使用该属性

```
TextBlock.ActualWidth 
```

# optimization - GHC 中的嵌套 UNPACK

> ID：10217288
> 
> 赞同：5
> 
> 时间：2012-04-18T20:16:53.547
> 
> 标签：optimization, haskell, data-structures, ghc

我经常在元组中收集多个值，因为我认为元组是这种情况的自然类型。但是，元组并不严格。所以考虑

```
data A

data B =
    B !A

data C =
    C !(B, B)

data D =
    D !B !B 
```

通过`-funbox-strict-fields`和优化，UNPACK 是嵌套的。中的元组会`C`被解压缩成`C A A`with`D`还是 just `C B B`？这是 GHC-doc 中的参考：[7.16。语用](http://www.haskell.org/ghc/docs/latest/html/users_guide/pragmas.html#unpack-pragma)。

（是非空元组*类型*吗？类型构造函数？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T20:34:48.720

考虑：

```
data B = B !Int

data C = C !(B, B)

data D = D !B !B

b0 = B 7
b1 = B 4

c = C (b0, b1)

d = D b0 b1 
```

在哪里

```
data (,) a b = (a,b) 
```

GHC 将愉快地删除嵌套的严格构造函数`(!B)`，并且它将在其第一个字段中使 C 严格，优化为：

```
b0 = B 7
b1 = B 4

c = C b0 b1

d = D 7 4 
```

然而，重要的是，`(,)`它本身的字段并不严格——因此 GHC 无法解压它们。此外，它们是多态的，因此即使它们是严格的也无法解包它们。

第一部分的解决方法是使用严格的元组。第二部分的解决方法是使用[自特化元组](http://hackage.haskell.org/packages/archive/adaptive-containers/0.3/doc/html/Data-Adaptive-Tuple.html)（例如，特化元组的类型族）。

* * *

请注意，在这种样式中使用元组作为语法会产生开销——它们引入了必须优化掉的间接级别。因此，它有点单调。

# c# - 带有列表视图的Windows窗体，拖放，需要源列表视图

> ID：10217289
> 
> 赞同：1
> 
> 时间：2012-04-18T20:17:01.397
> 
> 标签：c#, .net, winforms, listview

使用 VS 2008 我有一个带有 2 个 ListViews 的 windows 窗体（我们将它们称为 ListView1 和 ListView2）。ListView1 由目录中的文件名填充。当一个项目从 ListView1 拖到 ListView2 时，我执行了一些代码。当我从 ListView2 拖放到 ListView1 时，会执行一些代码。如果您从 ListView2 拖放到自身上，我想要做的不是执行代码

这是拖放后调用的 dragDrop 方法：

`private void view_DragDrop(object dropTarget, DragEventArgs e)`

我尝试了一些项目，如下所示：

`ListView data = (ListView)e.Data.GetData("System.Windows.Forms.ListView")`

这将返回 null 我想要对上述内容执行的操作是查看是否 data = dropTarget，不要执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:28:19.063

`OriginalSource`您可能可以通过使用属性来验证事件的来源并确保目标不同。

所以在你的`DragDrop`活动中`ListView2`，我会做这样的事情：

```
private void view_DragDrop(object dropTarget, DragEventArgs e)
{
    if (e.OriginalSource == ListView2)
       return;

    //Rest of the code here
} 
```

这将防止任何被拖出的项目`ListView2`触发您的代码执行`ListView2`。

[MSDN 上的 DragEventArgs 类](http://msdn.microsoft.com/fr-fr/library/system.windows.drageventargs%28v=vs.95%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:01:54.297

在表单范围内为您创建一个变量

```
object dfrom;
//your methods ect
    private void view_ItemDrag(Object sender, System.Windows.Forms.ItemDragEventArgs e)
    //your code to drag items
    dfrom = sender
}
private void view_DragDrop(object dropTarget, System.Windows.Forms.DragEventArgs e)
{
    if (dfrom == sender){return;}//this will protect both list boxes (assuming you can drag from both).
    //Your code
} 
```

# asp.net - 通过 ASP.Net 中的 Response.Writefile 在浏览器中显示 htm 内容

> ID：10217305
> 
> 赞同：1
> 
> 时间：2012-04-18T20:18:14.980
> 
> 标签：asp.net, vb.net

我正在开发一个我继承的网站，该网站是用 ASP.Net 构建的，我只是稍微熟悉。其中一个页面允许链接到文档（word 或 pdf），单击该链接会提示用户保存或打开文件，但不会显示文件的真实路径。通过这种方式，它可以防止用户将 url 粘贴到文件中 - 该链接指向一个 aspx 文件，该文件检查有效会话，然后检索该文件。

无论如何，因为有很多遗留代码，我还需要使用一堆静态 htm 文件来执行此操作，但是这些文件需要显示而不是提示用户保存它们，这就是现在发生的情况。我尝试将内容类型更改为 application/text、application/html、text/html 等，但没有成功，然后尝试添加 content-disposition inline 的响应标头。当我这样做、构建并尝试链接到文件时，我得到了几个运行时异常：

```
[FormatException: Input string was not in a correct format.]
Microsoft.VisualBasic.CompilerServices.Conversions.ParseDecimal(String Value, NumberFormatInfo NumberFormat) +206
Microsoft.VisualBasic.CompilerServices.Conversions.ToLong(String Value) +110

[InvalidCastException: Conversion from string "inline; filename=\" + myFile + " to type  'Long' is not valid.]
Microsoft.VisualBasic.CompilerServices.Conversions.ToLong(String Value) +428
cmswebasp.CMSModdoclinks.DownloadFile(String file) +1704
cmswebasp.CMSModdoclinks.Page_Load(Object sender, EventArgs e) +625
System.Web.UI.Control.OnLoad(EventArgs e) +99
System.Web.UI.Control.LoadRecursive() +50
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627 
```

这是页面中的一段代码：

```
Response.AddHeader("Content-Disposition", "inline; filename=" & file)

Dim fi As New FileInfo(myFile)
Response.AddHeader("Content-Length", fi.Length)

Dim contentType As String = ""
Dim fileExt As String = file.Split(".")(1)

Select Case fileExt

Case "htm"
contentType = "application/text"
Case Else
contentType = "application/octet-stream"
End Select

Response.ContentType = contentType
Response.WriteFile(myFile) 
```

我是否必须对 htmlwriter 对象或其他东西做些什么？我不能让它打开一个显示文件的新浏览器窗口，或者如果以这种方式使用它是否必须提示用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:53:12.917

废弃整页 (.aspx) 方法，而不是使用通用处理程序 (.ashx)。.aspx 页面将执行大量内置加载来初始化通常在 ASP.NET 网页中使用的所有状态，而通用处理程序仅初始化最低限度以将输出发送回客户端.

使用通用处理程序时，您还需要实现`System.Web.SessionState.IRequiresSessionState`以获取会话状态，因为默认情况下它不会加载会话状态。

一个例子：

```
Public Class FileWrapper
    Implements System.Web.IHttpHandler, System.Web.SessionState.IRequiresSessionState

    Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
        ' Validate session...

        ' Set output content type based on extension of requested file
        Dim fileName As String = context.Request.QueryString("file")
        Dim fileExt As String = fileName.Split("."c)(1).ToLowerInvariant()
        Select Case fileExt
            Case "htm", "html"
                context.Response.ContentType = System.Net.Mime.MediaTypeNames.Text.Html
            Case Else
                context.Response.AddHeader("Content-Disposition", "attachment; filename=" & fileName)
                context.Response.ContentType = System.Net.Mime.MediaTypeNames.Application.Octet
        End Select
        context.Response.WriteFile(fileName)
    End Sub

    ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable
        Get
            Return False
        End Get
    End Property

End Class 
```

注意：如果托管在 IIS 7 上，您将需要从中删除任何`<httpHandler>`注册`<system.web>`并将它们`<handler>`注册为`<system.webServer>`.

例如（根据需要正确使用您的命名空间）：

```
<system.webServer>
  <!-- For IIS 7 -->
  <handlers>
    <add name="FileWrapperHandler" path="FileWrapper.ashx" verb="*" type="MyNamespace.FileWrapper"/>
  </handlers>
</system.webServer> 
```

另一个注意事项：如果您*正在*使用集成管道（IIS 7 的默认设置）为 IIS 7 主机进行开发，那么我建议您为您的 Web 项目使用（并在必要时安装）IIS Express 选项。这可以在您的 Web 项目的属性中找到，从左侧开始的 Web 选项卡，然后在服务器部分中，选择使用本地 IIS Web 服务器单选按钮，然后选中下面的使用 IIS Express。

![使用 IIS Express](../Images/975d8b51327b2924693c53f3ccbb43bc.png)

这将使您的开发环境与您的生产环境的行为方式更加同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:37:52.773

当您调用`Response.WriteFile()`. 当客户端收到它时，找出实际的内容类型标头是什么。 如果您查看其“网络”选项卡，[Firebug会告诉您。](http://getfirebug.com/)

如果是这种情况，请`Response.ContentType`在调用后尝试设置`Response.WriteFile()`。或者，您可以尝试将文件读入字符串并使用`Response.Write()`而不是`WriteFile`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T19:01:06.683

经过一番讨论后，看起来您可能最好使用 lobotomized `Page`，而不是通用处理程序，因为用户可能通过 Word 文档中的链接或浏览器外部的其他来源访问该站点。

我们发现在这种情况下，aspx 页面能够恢复会话，而 ashx 则不能。因此，我提供了一个 aspx 解决方案的代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    ' Validate session...

    ' Set output content type based on extension of requested file
    Dim fileName As String = Request.QueryString("file")
    Dim fileExt As String = fileName.Split("."c)(1).ToLowerInvariant()
    Select Case fileExt
        Case "htm", "html"
            Response.ContentType = System.Net.Mime.MediaTypeNames.Text.Html
        Case Else
            Response.ClearHeaders()
            Response.AppendHeader("Content-Disposition", "attachment; filename=" & fileName)
            Response.ContentType = System.Net.Mime.MediaTypeNames.Application.Octet
    End Select
    Response.WriteFile(fileName)
    Response.Flush()
    Response.Close()
End Sub 
```

放置在 aspx 标记本身中的任何内容都无关紧要，因为无论如何都不会呈现这些内容。

请注意，这可能会导致 Web 主机上的一些日志条目尝试“访问已关闭的流”，因为我们已经关闭了响应流，但页面将继续照常处理。这是实质上劫持正常页面流所要付出的代价之一。

# php - 如何为我的 MediaWiki 扩展列出用户所在的组？

> ID：10217308
> 
> 赞同：2
> 
> 时间：2012-04-18T20:18:21.440
> 
> 标签：php, mediawiki

我正在编写一个扩展程序，允许我添加神奇的词：`CURRENTUSER`, `CURRENTUSERREALNAME`, `CURRENTUSERLANGABBR`, and I want `CURRENTUSERGROUPS`。我的代码的那部分目前是：

```
function wfGetCustomVariable(&$parser,&$cache,&$index,&$ret) {
    switch ($index) {
        case MAG_CURRENTUSER:
            $parser->disableCache(); # Mark this content as uncacheable
            $ret = $GLOBALS['wgUser']->mName;
            break;
        case MAG_CURRENTUSERREALNAME:
            $parser->disableCache(); # Mark this content as uncacheable
            $ret = $GLOBALS['wgUser']->mRealName;
            break;
        case MAG_CURRENTUSERLANGABBR
            $parser->disableCache(); # Mark this content as uncacheable
            $ret = $GLOBALS['wgLang']->getCode();
            break;
    }
    return true;
} 
```

但是，我似乎无法在 MediaWiki 文档中的任何位置找到用户所在的组数组的 $GLOBAL。我查看了[Manual:Configuration_settings](http://www.mediawiki.org/wiki/Manual%3aConfiguration_settings)、[Manual:LocalSettings.php](http://www.mediawiki.org/wiki/Manual%3aLocalSettings.php)、[Manual:](http://www.mediawiki.org/wiki/Manual%3aCommonSettings.php) CommonSettings.php 、[Manual:$wgGroupPermissions](http://www.mediawiki.org/wiki/Manual%3a%24wgGroupPermissions)和[Help:User_rights](http://www.mediawiki.org/wiki/Help%3aUser_rights)。在他们中，我没有看到任何关于如何获得当前用户组的简单（逗号/分号/等）分隔列表的解释。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:25:18.503

看看[http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/includes/User.php?view=markup#l2300](http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/includes/User.php?view=markup#l2300)：

```
$GLOBALS['wgUser']->getGroups() 
```

...当然会返回一个数组，而不是分隔符分隔的字符串。

# jquery - 如何获取选择选项的文本？

> ID：10217309
> 
> 赞同：0
> 
> 时间：2012-04-18T20:18:34.693
> 
> 标签：jquery

我有这段代码，我目前正在获取“mytablevalues”，但我想知道是否可以获得“myvalues”，我的意思是只有选择的文本。

```
 <form id="aform" method="post">
 <select id="menucompare" name ="menucompare" size="1">
<option value="nothing" <?php if ($menucompare == "nothing") { echo " selected='selected'"; } ?>>Select one</option>

<option value="mytablevalue1" <?php   if ($menucompare == "mytablevalue1") { echo " selected='selected'"; } ?> >myvalue1</option>
<option value="mytablevalue2" <?php   if ($menucompare == "mytablevalue2") { echo " selected='selected'"; } ?> >myvalue2</option>
<option value="mytablevalue3" <?php   if ($menucompare == "mytablevalue3") { echo " selected='selected'"; } ?> >myvalue3</option>
<option value="mytablevalue4" <?php if ($menucompare == "mytablevalue4") { echo " selected='selected'"; } ?> >myvalue4</option>

</select>
<input type="hidden" name="hidevalue" value="<?php echo $menucompare ;  ?>" />
<noscript><input type="submit" value="Submit"></noscript>
</form>

<script type="text/javascript">

   $(document).ready(function(){
    $("select").change(function() { 
         displayVals(); 
   });
   displayVals();
 });

function displayVals() {
var singleValues = $("#menucompare").val();
$("#hiddenselect").val(singleValues);
$("p").html("Procent of :    " + singleValues);
} 
```

而且我在默认值方面也有问题（什么都没有）。任何建议！

编辑 。我让它像那样工作

```
 <script type="text/javascript">

  $(document).ready(function(){
   $("select").change(function() { 
         displayVals(); 
   });
   displayVals();
   });

  function displayVals() {
var singleValues = $("select option:selected").text();
$("#hiddenselect").val(singleValues);
$("p").html("Procent of : &nbsp &nbsp" + singleValues);
 }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:21:58.060

用于`.text()`获取选项的文本值：http: [//api.jquery.com/text/](http://api.jquery.com/text/)

要获取所选选项的文本，您可以使用：

`$('#menucompare option:selected').text()`

[http://api.jquery.com/selected-selector/](http://api.jquery.com/selected-selector/)

**例子**

```
<script type="text/javascript">
 $(document).ready(function() {

   $("#menucompare").change(function() { 
     $("p").html("Procent of : " + $("option:selected", this).text());  
     $('input[name="hidevalue"]').val($("option:selected", this).text());  
   });

 });
</script> 
```

`$('#hiddenSelect')`在您发布的示例中似乎不存在，我假设您正在尝试设置`input`with name的值`hidevalue`，我已在上面的示例中包含此更改。

另一件事，`<p>`您的示例中没有（除非您将其省略？）。我建议给出`<p>`an`id`并选择它来更改它，否则`<p>`页面上每个单曲的值都会被更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:25:53.113

您也可以简单地使用 jQuery 来执行此操作，使用它（对于上面的示例）

```
$("#menucompare option:selected").text(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:22:55.387

这将为您提供所选选项的文本：

```
$('#menucompare').children("option[value='" + $('#menucompare').val() + "']").text(); 
```

# asp.net - asp.net 网站与 Web 应用程序

> ID：10217315
> 
> 赞同：4
> 
> 时间：2012-04-18T20:19:00.677
> 
> 标签：asp.net, web-site-project, web-application-project, web-config-transform

我在 asp.net 中阅读了很多关于网站与 Web 应用程序的讨论

我们在我的团队（10 名程序员）中工作的方式，我们使用项目类型“网站”，对于我们的开发环境，我们只需将源代码（aspx + .cs）复制到服务器。这样，所有的程序员都可以同时进行更改......并且服务器动态地进行构建。.....（对于 prod 环境，他们构建应用程序）

现在，我开始了一个新项目，我决定使用 Web 应用程序（主要原因是 Web 配置转换选项）。我很快意识到（据我所知）它会迫使你进行构建/发布每次更改都将Web应用程序转移到服务器...**如果我是唯一一个从事该项目的人，这**不是大问题...

但是，现在我想知道，如果更多的程序员需要同时处理这个新项目会发生什么？

有什么建议或类似情况吗？

**编辑**

我们正在使用 Visual Source Safe ...但仅用于跟踪旧版本（不适用于构建）...我熟悉 Subversion ...但是..不幸的是，我不决定什么我们应该使用..我不认为他们愿意改变

谢谢大家的回答...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:26:27.640

任何时候我听到，只要这不是一个大问题。. . . 立即告诉我，我应该假设这将是一个问题。简而言之，按照你所知道的去做。如果您熟悉使用 ASP.NET 网站，那么我会使用它。您的开发实践已经专注于处理该问题。

这与我第一次在公司开始编程时使用经典 ASP 时使用的模型相同。这个模型有效，尽管我强烈建议也获得源代码控制。话虽这么说，这是我长期要做的事情：

1.  源代码控制
2.  本地开发
3.  获得一个持续的构建过程（巡航控制是免费的）。
4.  让一个人将每个人的更改推送到开发服务器，一旦每个人都同意所有更改相互兼容。（通常这是通过确保构建服务器可以编译所有内容来完成的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:22:47.133

如果您选择使用 Web 应用程序并在项目中添加更多程序员，我建议使用源代码控制。[Git](http://git-scm.com/)和[Subversion](http://subversion.tigris.org/)非常流行。例如，在 Git 中，您可以查看谁提交了什么。

当然，我会从一开始就使用源代码控制，无论您是独自一人还是与团队合作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:26:53.057

正如@edmastermind29 所说，如果您拥有超过 1 个开发人员，源代码控制确实是保持这一点的第一要务。

这实际上取决于您的开发过程。大多数商店都进行某种类型的持续集成并运行单元测试并具有某种自动构建过程。

我发现使用 Web 应用程序项目确实是所有“最佳实践”类型的最佳选择。

[查看此链接以获取一些指导。](http://msdn.microsoft.com/en-us/library/dd547590.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T20:41:02.190

这实际上取决于您的团队如何工作，以及您的环境是如何配置的。无论如何，您需要有某种源代码控制系统，以确保您不会覆盖彼此的更改。如果您还没有适当的源代码控制系统，请立即停止并立即获得一个。

根据您选择的源代码控制系统，您至少将拥有基本的签入/签出功能，作为代码库的库；这意味着如果我签出了一个文件，在我重新签入之前你不能触摸它。

如果您选择功能更丰富的源代码控制系统，您应该能够利用分支和搁置等功能，这将允许您的团队同时处理相同的文件，并在文件签入时合并更改。

While your question is about *web sites vs. web applications*, the answer is *source control*. With a good source control system in place, your question becomes more or less irrelevant, aside from needing to coordinate builds with a web application.

# css - 不使用图像的 CSS3 行

> ID：10217323
> 
> 赞同：1
> 
> 时间：2012-04-18T20:19:37.337
> 
> 标签：css

我为我的个人网站设计了布局。我将线条设计为分隔符。在布局中，我并排制作了两条线。一个是深色的，一个是白色的，所以我创建了一个不错的效果，我想使用 CSS3 通过代码创建而不包含任何图像。

我附上了两张图片以查看我正在谈论的线条。

![](../Images/a1690940067ead2d7ad86fd92f3695cc.png)

![](../Images/fad17abe45eb3c8948c4bf1060c4eead.png)

非常感谢你们的时间。

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:31:10.390

很难从屏幕截图中准确看出您的意思——我认为闪亮的圆圈是您突出显示您想要向我们展示的部分的方式，但实际上它们使正确识别图像变得更加困难，而且它们非常低-res 无论如何都没有帮助。但无论如何我都会尽力提供帮助。

你所要求的相当普遍。通常你会为这种事情使用 CSS 边框。

像这样的东西：

```
border-left: 2px groove black; height: 50px; width: 2px; 
```

这都是标准的 CSS；你在这里不需要任何 CSS3 技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:29:36.487

尝试

```
div {
  width:50px;
  border-right:1px solid black;
  box-shadow: rgba(255,255,255,0.8) 1px 0px 0px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:42:57.917

我的方法略有不同。请参阅上一篇文章： [两种颜色边框](https://stackoverflow.com/questions/3906983/css-two-color-borders)

这是给你的一个例子：http: [//dabblet.com/gist/2416433](http://dabblet.com/gist/2416433)

# android - 使用多个叠加层时出现 NullPointerException onTouchEvent

> ID：10217329
> 
> 赞同：0
> 
> 时间：2012-04-18T20:20:12.677
> 
> 标签：android, google-maps

我正在开发一个应用程序，试图同时在 mapView 上显示多个不同的叠加层。原因是不同的覆盖层需要不同的颜色。我有一个允许滚动和缩放的工作地图，但是在添加多个叠加层之后，每当我尝试滚动时，地图现在都会给出空指针异常，并且缩放按钮已经消失。

这是我的地图活动：

```
package com.example.UVAMapsProject;

import java.util.ArrayList;
import java.util.List;

import com.example.UVAMapsProject.R;
import com.example.UVAMapsProject.R.drawable;
import com.example.UVAMapsProject.R.id;
import com.example.UVAMapsProject.R.layout;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

import android.app.Activity;
import android.content.Context;
import android.graphics.drawable.Drawable;
import android.os.Bundle;

public class MapsActivity extends MapActivity {
    /** Called when the activity is first created. */
    Context mContext;
    MapView mapView;
    private MapController mapController;
    List<Overlay> mapOverlays;
    Drawable drawableStandard;
    Drawable drawableComplete;
    Drawable drawableNext;
    HelloItemizedOverlay itemizedOverlayStandard;
    HelloItemizedOverlay itemizedOverlayNext;
    HelloItemizedOverlay itemizedOverlayComplete;

    ArrayList<GeoPoint> overlayPoints = new ArrayList<GeoPoint>();
    ArrayList<Destination> tourListTemp = SplashActivity.tourApp1.getTheTour().getTourList();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.maps);

        //get current center, create map at center
        int lat = (int)NavigatorActivity.currentLocation.getLatitude();
        int lon = (int)NavigatorActivity.currentLocation.getLongitude();
        GeoPoint point = new GeoPoint((int)(lat*1e6), (int)(lon*1e6) );
        mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(false);
        mapController = mapView.getController();
        mapController.setZoom(10);
        mapController.setCenter(point);

        // Initializes three different images and itemized overlays for each type of overlay
        drawableStandard = this.getResources().getDrawable(R.drawable.androidmarker);
        itemizedOverlayStandard = new HelloItemizedOverlay(drawableStandard, mapView);
        drawableNext = this.getResources().getDrawable(R.drawable.androidmarkernext);
        itemizedOverlayNext = new HelloItemizedOverlay(drawableNext, mapView);
        drawableComplete = this.getResources().getDrawable(R.drawable.androidmarkercomplete);
        itemizedOverlayComplete = new HelloItemizedOverlay(drawableStandard, mapView);

        // get points of Destinations & make overlays
        addOverlayPoints();

        mapController.zoomToSpan(itemizedOverlayStandard.getLatSpanE6(), itemizedOverlayStandard.getLonSpanE6());

        final MyLocationOverlay myPosition = new MyLocationOverlay(this,mapView);
        mapOverlays = mapView.getOverlays();  
        mapOverlays.add(myPosition);
        mapOverlays.add(itemizedOverlayStandard);
        mapOverlays.add(itemizedOverlayNext);
        mapOverlays.add(itemizedOverlayComplete);
        myPosition.enableMyLocation();

    }

    public void addOverlayPoints(){
        for (Destination d: tourListTemp) {
        GeoPoint temp = new GeoPoint((int)(tourListTemp.get(tourListTemp.indexOf(d)).getLatitude()*1e6),
                (int)(tourListTemp.get(tourListTemp.indexOf(d)).getLongitude()*1e6));
        overlayPoints.add(temp);
        OverlayItem overlayitem = new OverlayItem(temp, d.getName(), d.getInfo());
        itemizedOverlayStandard.addOverlay(overlayitem);
        }
        itemizedOverlayNext.addOverlay(itemizedOverlayStandard.removeOverlay(tourListTemp.get(0)));
    } 
```

这是我的覆盖类：

```
package com.example.UVAMapsProject;

import java.util.ArrayList;

import android.app.AlertDialog;
import android.content.Context;
import android.graphics.drawable.Drawable;

import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.MapView;
import com.google.android.maps.OverlayItem;

public class HelloItemizedOverlay extends ItemizedOverlay {

    private ArrayList<OverlayItem> mOverlays = new ArrayList<OverlayItem>();
    Context mContext;
    MapView mapView;

    public HelloItemizedOverlay(Drawable defaultMarker) {
        super(boundCenterBottom(defaultMarker));
        // TODO Auto-generated constructor stub
    }

    public HelloItemizedOverlay(Drawable defaultMarker, MapView mv) {
          super(boundCenterBottom(defaultMarker));
          mContext = mv.getContext();
    }

    @Override
    protected boolean onTap(int index) {
      OverlayItem item = mOverlays.get(index);
      AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);
      dialog.setTitle(item.getTitle());
      dialog.setMessage(item.getSnippet());
      dialog.show();
      return true;
    }

    @Override
    protected OverlayItem createItem(int i) {
      return mOverlays.get(i);
    }

    public int getOverlayIndex(Destination d){
        int out = SplashActivity.tourApp1.getTheTour().getTourList().indexOf(SplashActivity.tourApp1.getNextDestination());
        return out;
    }

    public OverlayItem removeOverlay(Destination d) {
        int index = getOverlayIndex(d);
        OverlayItem temp = mOverlays.get(index);
        mOverlays.remove(index);
        return temp;
    }

    public void addOverlay(OverlayItem overlay) {
        mOverlays.add(overlay);
        populate();
    }

    @Override
    public int size() {
      return mOverlays.size();
    }

} 
```

这是我单击地图时收到的错误：

```
04-18 15:56:46.980: E/AndroidRuntime(3262): FATAL EXCEPTION: main
04-18 15:56:46.980: E/AndroidRuntime(3262): java.lang.NullPointerException
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.ItemizedOverlay.getItemsAtLocation(ItemizedOverlay.java:617)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.ItemizedOverlay.getItemAtLocation(ItemizedOverlay.java:586)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.ItemizedOverlay.handleMotionEvent(ItemizedOverlay.java:498)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.ItemizedOverlay.onTouchEvent(ItemizedOverlay.java:572)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.OverlayBundle.onTouchEvent(OverlayBundle.java:63)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.google.android.maps.MapView.onTouchEvent(MapView.java:643)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.View.dispatchTouchEvent(View.java:3766)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:897)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:863)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:863)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:863)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1671)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.app.Activity.dispatchTouchEvent(Activity.java:2086)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1655)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1785)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.os.Looper.loop(Looper.java:123)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at java.lang.reflect.Method.invokeNative(Native Method)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at java.lang.reflect.Method.invoke(Method.java:521)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
04-18 15:56:46.980: E/AndroidRuntime(3262):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:31:38.233

在`HelloItemizedOverlay`构造函数中，您需要调用`populate()`

# actionscript-3 - 修改当前代码以使我的角色在 AS3 中跳转

> ID：10217342
> 
> 赞同：1
> 
> 时间：2012-04-18T20:21:38.433
> 
> 标签：actionscript-3, flash-cs5

```
package com.basics.stick
{

import flash.display.MovieClip;
import flash.display.Stage;
import com.basics.senocular.utils.KeyObject;
import flash.ui.Keyboard;
import flash.events.Event;
import flash.utils.Timer;
import flash.events.TimerEvent;

public class StickMan extends MovieClip
{
    private var stageRef:Stage;
    private var key:KeyObject;
    private var speed:Number = 2;
    private var vx:Number = 0;
    private var vy:Number = 0;
    private var friction:Number = 0.93;
    private var maxspeed:Number = 8;
    private var fireTimer:Timer;
    private var canFire:Boolean = true;

    public function StickMan(stageRef:Stage)
    {
        this.stageRef = stageRef;
        key = new KeyObject(stageRef);

        fireTimer = new Timer(300,1);
        fireTimer.addEventListener(TimerEvent.TIMER, fireTimerHandler, false, 0, true);

        addEventListener(Event.ENTER_FRAME, loop, false, 0, true);
    }

    private function fireTimerHandler(e:TimerEvent):void
    {
        canFire = true;
    }

    private function fireBullet():void
    {
        if (canFire)
        {
            stageRef.addChild(new Bullet(stageRef,x+vx+35, y+10));
            canFire = false;
            fireTimer.start();
        }
    }

    public function loop(e:Event):void
    {

        if (key.isDown(Keyboard.LEFT))
        {
            vx -=  speed;
        }
        else if (key.isDown(Keyboard.RIGHT))
        {
            vx +=  speed;
        }
        else
        {
            vx *=  friction;

        }
        if (key.isDown(Keyboard.UP))
        {
            vy -=  speed;
        }
        else if (key.isDown(Keyboard.DOWN))
        {
            vy +=  speed;
        }
        else
        {
            vy *=  friction;
        }

        if (key.isDown(Keyboard.SPACE))
        {
            fireBullet();
        }
        x +=  vx;
        y +=  vy;

        if (vx > maxspeed)
        {
            vx = maxspeed;
        }
        else if (vx<-maxspeed)
        {
            vx =  -  maxspeed;
        }
        if (vy > maxspeed)
        {
            vy = maxspeed;
        }
        else if (vy<-maxspeed)
        {
            vy =  -  maxspeed;

        }

        if (x > stageRef.stageWidth)
        {
            x = stageRef.stageWidth;
            vx =  -  vx;
        }
        else if (x<0)
        {
            x = 0;
            vx =  -  vx;

        }
        if (y > stageRef.stageHeight)
        {
            y = stageRef.stageHeight;
            vy =  -  vy;
        }
        else if (y<0)
        {
            y = 0;
            vy =  -  vy;

        }
    }
}
} 
```

我想要的是当我按下向上按钮时，不仅仅是向上，而是跳跃，然后下降到特定的 y。我在网上搜索，但是大部分教程或其他用户都将代码放在字符中。但是我想要的是修改上面的代码，并使字符跳转。任何指导或任何东西都非常受欢迎。

提前感谢您的时间！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:21:40.007

您对 vy 的逻辑应该与 vx 不同。你需要为 vy 做的就是突然将它设置为一个相当大的负值，然后不断地添加一个小的值来模拟重力。这就是重力：垂直速度的变化率（加速度）。

您已经知道如何使用标志，因此您可以制作一个用于跳跃的标志，就像您为 canFire 所做的那样。

```
if (canJump)
{
    if(key.isDown(Keyboard.UP))
    {
        vy = -8; // for example this value, notice that it is assignment and not "-="
        groundy = y; // this a class private var, to remember the ground level
        canJump = false;
    }
    else if (key.isDown(Keyboard.DOWN))
    {
        // Forget about this, this can be erased
        // vy +=  speed;
    }
    else
    {
        // Also forget about this, it can be erased
        //vy *=  friction;
    }
}
else
{
    vy += 0.2; // an example value that you can tweak. this simulates gravity

    // The character is going down and now hits the ground
    if(y > groundy) {
        vy = 0;
        y = groundy;
        canJump = true;
    }
}

// ...

x +=  vx;
y +=  vy;

// ... 
```

上面的代码没有经过真正的测试，但它应该可以工作，这是基本的游戏编程，实际上只是基本的计算物理，比如速度和加速度。

我想这是`vx`您想要在游戏中获得的马里奥平台游戏效果（在冰上，因为您的处理方式）。当然，如果你想要像 Final Fight（垂直**和**水平行走以及跳跃）这样的游戏玩法，逻辑会非常不同。

# asp.net - Asp.net：如何将 DataBinder.Eval 与成员变量进行比较？

> ID：10217343
> 
> 赞同：0
> 
> 时间：2012-04-18T20:21:38.513
> 
> 标签：asp.net

我正在尝试在中继器中执行此操作：

```
<%# Iif((int)DataBinder.Eval(Container.DataItem, "Id") == SelectedJobDefId, "blue", "red")%> 
```

问题是成员属性仅在使用此语法时才评估：

```
<%= SelectedJobDefId %> 
```

DataBinder.Eval() 仅在使用哈希符号时才有效。

作为测试，我尝试了这个：

```
 <%= SelectedJobDefId %>
  <%# DataBinder.Eval(Container.DataItem, "Id") + " " + SelectedJobDefId %> 
```

当我切换行（LinkBut​​ton 事件）时，第一个 SelectedJobDefId 保持正确。DataBinder 部分对于每一行都是正确的。SelectedJobDefId 的第二个输出始终为“1”。

如何比较这两个值？

更新：

根据 Jeremy 的建议，我将 td 设置为服务器标签，并尝试在 OnItemDataBound 中执行如下逻辑：

```
protected void Repeater2_OnItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        RepeaterItem item = e.Item;
        DataRowView drv = (DataRowView)item.DataItem;

        int id = (int)drv.Row.ItemArray[0];

        HtmlTableCell td = (HtmlTableCell)item.FindControl("failtd");

        if (id == this.SelectedJobDefId){td.BgColor = "green";}
    } 
```

当我单步调试调试器时，OnItemDataBound 事件发生**在**更新 SelectedJobDefId 属性的 LinkBut​​ton 事件之前，该属性解释了默认值 1。

有没有办法切换事件的顺序？我可能只是采取了错误的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T12:36:09.623

只是把它作为一种选择，虽然显然不是最有效的方法。

`Repeater`更新后，您可以在`LinkButton`单击处理程序中显式重新绑定`SelectedJobDefId`。这样，您应该能够保留您最初拥有的所有 aspx 标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:48:21.987

我可以通过在 LinkBut​​ton Click() 事件中使用 NamingContainer 属性来解决事件顺序问题，如下所示：

```
RepeaterItem item = (RepeaterItem)((LinkButton)sender).NamingContainer;      
HtmlTableCell td = (HtmlTableCell)item.FindControl("SelectTd");
td.BgColor = "purple"; 
```

为了完成这项工作，我创建了目标 td runat="server" 并将其命名为“SelectTd”。这有点令人不快，所以我可能只是在 jQuery 中通过隐藏字段来存储所选项目。

# testing - 在 express js 中测试视图

> ID：10217348
> 
> 赞同：3
> 
> 时间：2012-04-18T20:21:50.533
> 
> 标签：testing, node.js, express, bdd, pug

我试图找出一种理想的方式来测试我的观点，用 Jade 编写。它们包含一些逻辑。例如，在主页上，如果设置了 cookie，它应该显示一个链接到主控制台的按钮，并且可以选择注销，而如果没有设置 cookie，它应该显示登录。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:39:27.283

我认为这不是[很难调试的错误](http://misko.hevery.com/2008/11/17/unified-theory-of-bugs/)（如果发生这种情况，您应该在浏览器窗口中看到）。但是，如果您真的想要，我认为您有以下选择：

*   以 TJ 看[他的测试的方式编写测试](https://github.com/visionmedia/jade/tree/master/test)。他几乎为所有东西都写过测试。
*   使用例如[tobi](https://github.com/LearnBoost/tobi)或[zombie.js](https://github.com/assaf/zombie)进行无头测试。还有[phantom.js](http://phantomjs.org/)，但是这个产品不是用 node.js 开发的。
*   [selenium](http://seleniumhq.org/)（不是在 node.js 中开发的）和deltanovember 指出的[苏打水。](https://github.com/LearnBoost/soda)
*   您可以使用[js-test-driver](http://code.google.com/p/js-test-driver/)来测试所有浏览器（客户端 javascript）。您还可以使用[YETI](https://github.com/yui/yeti)（使用 YUI 测试框架）在所有浏览器中测试您的所有代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:08:20.107

看看硒

[http://seleniumhq.org/](http://seleniumhq.org/)

当然还有节点适配器

[https://github.com/LearnBoost/soda](https://github.com/LearnBoost/soda)

# c++ - 日志文件名中的 Pantheios 日期/时间

> ID：10217351
> 
> 赞同：0
> 
> 时间：2012-04-18T20:22:05.593
> 
> 标签：c++, visual-studio-2010, logging, pantheios

我在我的应用程序中使用 Pantheios，我想每小时生成一个新的日志文件。我已经看到解释如何使用例如添加日期和时间（http://blog.pantheios.org/2010/10/pantheios-101-beta-197-released-befile.html）的博客条目：

pantheios_be_file_setFilePath("test-%T-%D.log");

其中 %T 说明符被当前时间替换，格式为 HHMMSS。%D 说明符被当前日期替换，格式为 YYYYMMSS。

上面的示例将每分钟创建一个唯一文件。我的问题是是否有可能每小时创建一个文件。我试过使用 %H 和 %HH ，但都不起作用。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:11:01.837

你的问题有点不正确。

> 上面的示例将每分钟创建一个唯一文件。

你为什么这么认为？通过使用函数**pantheios_be_file_setFilePath()**，您可以只为您的日志文件设置一个唯一的名称，仅此而已（不是定期调用来创建新文件）。如果我遗漏了什么，请纠正我，但没有任何代码行每分钟创建一个新文件。如果需要，请创建一个带有计时器的线程。

顺便说一句，你不能设置与**%T**或**%D**不同的东西，因为下一行来自*bec.file.cpp:1050*：

```
// date format: YYYYMMDD
// time format: hhmmss

pan_char_t const* const date    =   pan_strstr_(fileName, PANTHEIOS_LITERAL_STRING("%D"));
pan_char_t const* const time    =   pan_strstr_(fileName, PANTHEIOS_LITERAL_STRING("%T"));

size_t const            nameLen =   pan_strlen_(fileName); 
```

如您所见，只有两个符号可以被解析。没有任何**%H**或**%HH**。

# php - php脚本中特定行的PHP别名？

> ID：10217357
> 
> 赞同：0
> 
> 时间：2012-04-18T20:22:20.493
> 
> 标签：php, alias

我正在使用我的应用程序处理安全级别，并且我编写了一个简单检查的函数 - 取决于它的会话用户 ID，他/她拥有什么样的权限。它工作正常，但在某些页面中，如果用户是超级用户，我想输出一些信息，如果用户是访客，则禁止输出信息。

我用这样的语法来做：

```
1\. <? if admin('superuser', $_SESSION['user_id'])  { ?>
2\. <div></div>
3\. <? } ?> 
```

它工作得很好，但它并不优雅，如果花括号之间的代码很长，它会破坏我的代码的纯度。有没有办法将第 1 行和第 3 行“别名”为某种快捷方式，即

```
1\. <? admin_superuser ?>
2\. <div></div>
3\. <? admin_super_user_end ?> 
```

也许您有其他想法来执行这种级别的安全性？

这个想法来自 ob_start() 和 ob_end() 命令。我在等你的想法。

卡雷格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:26:17.113

你可以简单地在页面的开头设置一个布尔值：

```
$isSuperUser = admin('superuser', $_SESSION['user_id']); 
```

然后，做

```
<? if ($isSuperUser) { ?>
<div></div>
<? } ?> 
```

如果你不喜欢 $，你可以定义一个常量：

```
define("SUPERUSER", admin('superuser', $_SESSION['user_id'])); 
```

然后，做

```
<? if (SUPERUSER) { ?>
<div></div>
<? } ?> 
```

常量的好处是它是全局的，如果在函数中使用，你不必先声明它是全局的，或者将它作为参数传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:24:54.457

我会选择这样的东西。我认为这完全可以接受。
为了简化它，您只需要为您的用户提供一个包装器。

```
<?php if ($user->isAdmin()): ?>
<div></div>
<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T20:26:34.007

您可以使用“包含”功能包含另一个包含相应 html / php 代码的 php 文件。我还建议使用xml 和 ini 设置`<?php`而不是仅仅`<?`由于短的打开标签问题。

# c++ - 无法在 cpp 对象和头文件中使用 istream

> ID：10217360
> 
> 赞同：0
> 
> 时间：2012-04-18T20:22:26.883
> 
> 标签：c++, object, istream

头文件

```
#ifndef IREADER_H
#define IREADER_H
#include <iostream>

class iReader {
public:
    iReader();
    iReader(istream *input);
    iReader(const iReader& orig);
    virtual ~iReader();
private:
    Pixel *pixelData;
    char *cData;
    istream *input;
};

#endif  /* IREADER_H */ 
```

.cpp 文件

```
#include <iostream>
#include <fstream>
#include "Pixel.h"
#include "iReader.h"

iReader::iReader() {

}

iReader::iReader(istream *input){

}

iReader::iReader(const iReader& orig) {
}

iReader::~iReader() {
} 
```

（对不起，如果我没有正确复制代码）

所以这是我的代码。我正在制作一个新对象，我只是能够传入一个 istream 指针，并拥有一个 istream 指针变量。它在 netbeans 中出错，说“无法解析标识符 istream”。它在我的主文件中工作正常，但在这个对象中没有。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T20:25:50.567

你可能`using namespace std;`在你的主文件中使用。

您需要符合条件`istream`：

```
#ifndef IREADER_H
#define IREADER_H
#include <iostream>
class Pixel; // <--- you should also forward declare Pixel
class iReader {
public:
    iReader();
    iReader(std::istream *input);
    iReader(const iReader& orig);
    virtual ~iReader();
private:
    Pixel *pixelData;
    char *cData;
    std::istream *input;
};

#endif  /* IREADER_H */ 
```

# algorithm - 寻路算法测试工具

> ID：10217365
> 
> 赞同：5
> 
> 时间：2012-04-18T20:22:51.080
> 
> 标签：algorithm, testing, path

任何人都知道，一些用于路径查找算法测试的工具。我可以在 2d 网格上测试我自己编写的寻路算法。像这样的东西[http://topfat.blogspot.com/](http://topfat.blogspot.com/) 但是我可以在哪里编写和运行我自己的算法。它可以使用任何编程语言。我几乎可以将我的代码调整为任何编程语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T06:13:29.990

您是否检查了路径查找算法工具的源代码？我是开发人员之一，该工具是开源的（Java）。例如，您的算法应该实现的接口是

```
public interface PathFindingAlgorithm {

    /**
     * Method for finding path from given start point to goal point
     * using Map object. Found path (if any) depends on path finding algorithm
     * class that overrides this method.
     * 
     * @param start the point where the search begins
     * @param goal the goal point
     * @param map Map object the path finding algorithm uses
     * @return SearchResult object containing path and possibly other relevant information
     * about the search and <code>null</code> if no path is found.
     */
    public SearchResult findPath(Point start, Point goal, Graph graph); 
```

添加算法的类（http://code.google.com/p/topfat/source/browse/trunk/src/algorithms/PathFindingAlgorithms.java）：

```
public class PathFindingAlgorithms {

    private Vector<PathFindingAlgorithm> algorithms;

    public PathFindingAlgorithms() {
            this.algorithms = new Vector<PathFindingAlgorithm>();
            addAlgorithm(new AStarAlgorithm());
            addAlgorithm(new DijkstraStyleAlgorithm());
    }

    public Vector<PathFindingAlgorithm> getAlgorithms() {
            return algorithms;
    }

    public void addAlgorithm(PathFindingAlgorithm algorithm) {

            if (! this.algorithms.contains(algorithm)) {
                    this.algorithms.add(algorithm);
            }

    }

    public void removeAlgorithm(PathFindingAlgorithm algorithm) {
            this.algorithms.remove(algorithm);
    } 
```

我不记得这是否也将所有需要的东西添加到 GUI 中。几年前我们这样做了，所以代码（当然）并不完美。此应用程序中最简单的情况是 Dijkstra，如果您需要更复杂的东西，请检查 A*。

您可以从 Google 代码[http://code.google.com/p/topfat/](http://code.google.com/p/topfat/)查看。如果您做了您想做的事情，我们也可以为您添加写入权限。

# ruby - 如何在 Ruby 中动态创建二维数组？

> ID：10217366
> 
> 赞同：2
> 
> 时间：2012-04-18T20:22:54.620
> 
> 标签：ruby, nokogiri

所以我正在解析一个 URL，并希望使用 Nokogiri 获取页面中所有链接的列表。

但我想将返回的结果推送到二维数组中。

我现在正在这样做：

```
def my_list(url)
    root = Nokogiri::HTML(open(url))
    list = []

    root.css("a").each do |link|
        list << (link[:href])           
    end

end 
```

这给了我http链接。如果我这样做`list << link`，它会给我完整的`<a>`标签。

我想要做的只是将链接的文本（可以使用`link.text`）推送到 say `list[0][0]`，然后将 href 值（使用`link[:href]`）推送到另一个单元格 say `list[0][1]`。

我怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T20:26:46.930

```
def my_list(url)
  root = Nokogiri::HTML(open(url))
  root.css("a").map do |link|
    [link.text, link[:href]]           
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T20:26:52.840

```
def my_list(url)
    root = Nokogiri::HTML(open(url))
    list = []

    root.css("a").each do |link|
        list << [link.text,link[:href]]           
    end

end 
```

# django - 是否可以只为 Django 中的一个视图记录查询？

> ID：10217373
> 
> 赞同：1
> 
> 时间：2012-04-18T20:23:27.457
> 
> 标签：django

我知道，在设置中，我可以拥有`debug = True`并记录所有 SQL 查询。

但是，我想在返回响应之前记录一个特定视图所做的所有 SQL 查询。

我怎样才能在 Django 1.3 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:43:00.853

这可以通过在特定视图的上下文中更改日志记录设置来完成。

您仍然需要`DEBUG`启用：

> 出于性能原因，仅当 settings.DEBUG 设置为 True 时才启用 SQL 日志记录，而与安装的日志记录级别或处理程序无关。

...但您可以修改配置，以便仅记录特定视图的查询。

这是如何完成的：

1：`settings.py`将 django SQL logger ( `django.db.backends`) 级别设置为`INFO`或更高，并验证它是否停止记录 SQL 查询。

2.a. 在您的视图中具有 SQL 日志记录的第一行，将该记录器级别设置为`DEBUG`. 最后一行，将其设置回原始值。这是最简单的方法，但不会记录中间件在查看代码之前/之后执行的查询。

2.b。编写自定义中间件在视图处理之前和之后做同样的事情。如果你把它放在第一位，其他中间件的所有查询也会被记录下来。

请注意，此方法不是线程安全的，但由于您只希望在开发环境中进行此设置，因此这无关紧要。

* * *

Django 文档“日志”一章： [https ://docs.djangoproject.com/en/1.4/topics/logging/](https://docs.djangoproject.com/en/1.4/topics/logging/)

Python 日志库参考： [http ://docs.python.org/library/logging.html](http://docs.python.org/library/logging.html)

# c# - 如何让 hudson 识别每个项目的 PathToWebApp

> ID：10217378
> 
> 赞同：1
> 
> 时间：2012-04-18T20:23:51.577
> 
> 标签：c#, asp.net, hudson

我的本地机器上运行着一个 hudson 服务器。到目前为止，我只向 hudson 添加了一个项目。我使用 svn 作为我的源代码控制。每当我在 hudson 上构建项目时，所有测试都会失败，因为 %PathToWebApp% 变量无法被 hudson 识别。如果我将 PathToWebApp 添加为 hudson 中的环境变量，我可以强制 hudson 识别它，但这只适用于一个项目。我需要哈德森为多个项目工作。顺便说一句，我不能为 AspNetDevelopmentServerHost 使用绝对路径，任何给定的项目都将在多台机器上运行。下面列出了示例 asp.net 代码。它是一个非常基本的 asp.net 测试方法。

```
[TestMethod()]
[HostType("ASP.NET")]
[AspNetDevelopmentServerHost("%PathToWebApp%\\MyReportingApp", "/MyReportingApp")]
[UrlToTest("http://localhost:51357/")]
public void LoginConstructorTest()
{
     //Login target = new Login();
     //Assert.Inconclusive("TODO: Implement code to verify target");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:14:06.927

好的，我想通了。Hudson 无法识别这些属性。测试的设置必须在 Local.testsettings 中配置

# javascript - 我应该如何处理这个 CSS 继承难题？

> ID：10217383
> 
> 赞同：1
> 
> 时间：2012-04-18T20:24:22.077
> 
> 标签：javascript, css

我有一类称为字形的图像出现在我的网站上。曾几何时，他们都被称为只是被称为`glyph`。它们过去只出现在一个盒子里。那个框是一个特定的大小，我使用了一个 javascript 方法来确保文本总是合适的，并且字形总是与文本的其余部分大致相同的高度。这很容易做到，并且由于我的样式表，字形以默认值开始。

现在，我决定在每页包含多个带有可变数量文本的框。每个盒子的大小都是独立的。我尝试过延迟大小调整程序，但这高度依赖于用户的连接速度。如果我不运行大小调整例程，那么事情看起来根本不对，所以我至少想为所有东西选择一个默认的起始大小。当然，在加载之前，您不能使用 javascript 调整大小。蛇吃尾巴。

所以基本上，现在我有多个盒子，每个字形都有一个类 glyph:1、glyph:2 等。这个数字可以和我网站上用户提交的项目的数量一样大。CSS 是如何处理这个问题的？据我所知，这些项目基本上需要两个类名。但我很确定这是不允许的。

我需要什么：将所有以“glyph：”开头的图像类设置为 1em

这不存在，对吧？字形：*

另外， : 在 css 类名中使用可能不好，是吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:30:13.953

不要使用 : 符号。一个元素可以有多个类，所以这样做

```
<div class="glyph glyph-1">Foo</div>
<div class="glyph glyph-2">Foo</div>
<div class="glyph glyph-3">Foo</div>
<div class="glyph glyph-4">Foo</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:51:22.260

正如其他人所说，您不应该在类名中使用冒号。连字符和破折号是唯一可以使用的标点符号。

可以在类中使用冒号并在 CSS 代码中对其进行转义，但这会变得非常混乱且没有必要。

其次（这是我将比其他答案更进一步的地方），如果你为你的元素生成唯一的类名，那么你可能做错了什么。

该`id`属性可以为您的元素提供唯一的名称；`class`旨在允许您将相同的类（或多个类）应用于多个元素，从而允许您将所有这些元素设置为相同的样式。你可能已经知道了；我想我的意思是听起来你应该使用`id`而不是`class`.

下一篇：你说你很确定两个类名是不允许的，但实际上是允许的。这是完全允许的，`class="glyph bob"`并且您的元素将从 class`glyph`和 class中获取样式`bob`。你可以有尽可能多的课程。然而，我仍然会说，如果你想给他们唯一的名字，它应该是一个 ID。

您还要求使用 CSS 语法来设置所有`glyph*`类。同样，你错了：这种语法*确实*存在，通过[扩展的 attr 语法](http://www.quirksmode.org/css/selector_attributeAdvanced.html)：

```
[class^="glyph"] {
    /*styles here for classes beginning with 'glyph'
} 
```

您谈到延迟尺寸调整程序以及引入的问题。对此的一种解决方案可能是完全隐藏这些项目，直到浏览器完成它们的外观。您甚至可以将它们淡入视野或使其看起来像是故意的效果。

但毕竟，我想知道你为什么要在图像中放置字形并独立调整它们的大小？这听起来有点奇怪。您在问题中的描述让我想知道您要达到的目标。

您是否考虑过为您的字形使用可缩放图形 (SVG/VML) 或自定义字体，而不是图像？如果您使用自定义字体，您可以像正常一样简单地指定字体大小，然后让浏览器处理它。

希望其中一些是有帮助的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:27:24.920

CSS 类名不能包含`:`符号。之后的所有内容都`:`将被解释为伪类（如`:hover`）并且不会被正确解析。

至于你的课程，为什么它们都必须是独一无二的？类用于一次选择多个元素，因此您可以这样做：

```
<div class="glyph">Foo</div>
<div class="glyph">Foo</div>
<div class="glyph">Foo</div>
<div class="glyph">Foo</div> 
```

并使用一个选择器将它们全部选中：

```
.glyph {
  color: red;
} 
```

# java - Java中的^（插入符号）是什么意思

> ID：10217390
> 
> 赞同：-2
> 
> 时间：2012-04-18T20:24:56.197
> 
> 标签：java, syntax

`^`Java 语法中的 (caret) 是什么意思？为什么`6^3`返回`5`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T20:25:21.537

这是按位异或运算符。XOR 是异或。

二进制中的 6（假设 4 位）是`0110`，二进制中的 3 是`0011`。

所以，我们得到：

```
0110
0011 XOR
----
0101 
```

并且`0101`是 5。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:26:38.913

请参阅[按位和位移运算符](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)。

# ruby-on-rails - 您如何使用 Rails 3 验证基于两个值来确定唯一性？

> ID：10217391
> 
> 赞同：2
> 
> 时间：2012-04-18T20:24:59.847
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个名为 Replay 的模型，它有 3 个属性：match_id、game_number 和 uploader_id。本质上，我想要验证以强制上传者不上传与他们已经为该比赛上传的重播具有相同游戏编号的比赛的重播。但是，我希望其他用户能够上传该比赛和比赛编号的重播。

我现在使用的验证是：

```
validates :game_number, presence: true, uniqueness: { scope: :match_id } 
```

但这并没有考虑到uploader_id。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:32:15.177

试试这个：

```
validates :game_number, presence: true, uniqueness: { scope: [:match_id, :uploader_id] } 
```

# php - 通过 PHP ODBC OpenEdge Progress 驱动程序设置查询超时时间

> ID：10217396
> 
> 赞同：0
> 
> 时间：2012-04-18T20:25:27.390
> 
> 标签：php, sql, odbc, openedge, progress-db

我正在做一个项目，我需要通过 OpenEdge Progress 驱动程序使用 PHP ODBC 方法查询数据库。我需要一种方法来设置 MySQL 查询的超时，因此它比默认设置短得多（如果有的话）。

我尝试使用“odbc_setoption($stmt, 2, 0, 30)”，如下面的示例语句中所示...

```
 $stmt = odbc_prepare($this->odbc, $query);
  odbc_setoption($stmt, 2, 0, 30);//Set query timeout to 30 seconds.
  return odbc_execute($stmt); 
```

但这失败了，因为不支持“0”作为查询超时的选项。我不知道这个数字，我尝试了一切，包括尝试在我的数据库连接 DSN 字符串和通过注册表中设置它。关于 PHP 中的变量名和/或选项号的任何想法？没人用这个东西...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:09:44.047

您可以使用 SQL 脚本直接设置超时。

**对于当前连接：**

```
SET PRO_CONNECT QUERY_TIMEOUT n ; 
```

**对于数据库直到正在运行：**

```
SET PRO_SERVER QUERY_TIMEOUT n ; 
```

[http://documentation.progress.com/output/OpenEdge102b/pdfs/dmsrf/dmsrf.pdf](http://documentation.progress.com/output/OpenEdge102b/pdfs/dmsrf/dmsrf.pdf) 第58页

但那可能认识你；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:54:48.033

您是否尝试使用[ADOdb](http://adodb.sourceforge.net/)而不是使用本机 php odbc 支持？

# php - PDO 准备语句来存储 html 内容

> ID：10217402
> 
> 赞同：2
> 
> 时间：2012-04-18T20:26:06.693
> 
> 标签：php, sqlite, pdo, prepared-statement

我正在寻找一种在准备好的语句中处理 HTML 内容的方法。

我的应用程序提供了一个基本的所见即所得编辑器，在用户保存内容后，我的脚本将 HTML 数据存储在 sqlite 数据库中。

但是，如果我使用的是准备好的语句，我的 HTML 会自然地转义。

这是我到目前为止：

```
try {

    /* Create databases and open connections */
    $dbh = new PDO( 'sqlite:db/coaching.sqlite' );

    /* Set Error Mode for Exception Handling */
    $dbh->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );

    /* Prepare SQL Statement */
    $query = $dbh->prepare( "UPDATE Content SET Value=:value WHERE Token=:token" );

    /* Bind Param to Statement */
    $query->bindParam( ':token', $_POST['id'], PDO::PARAM_STR);
    $query->bindParam( ':value', $_POST['value'], PDO::PARAM_STR);

    /* Execute Query */
    $query->execute();

    /* Echo Data */
    echo $_POST['value'];

    /* Close connections to Database */
    $dbh = NULL;

}
catch( PDOException $e ) {

    /* Print Error-Messages */
    echo $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T08:27:31.797

准备好的语句不会转义变量。命令和变量同时但独立地传输到数据库。如果您看到您的数据在数据库中转义，还有另一个原因。例如`magic_quotes`打开。您可以`get_magic_quotes_gpc`在脚本中回显以查看它们是打开还是关闭？如果它们打开，您可以使用[不同的技术](https://stackoverflow.com/questions/517008/how-to-turn-off-magic-quotes-on-shared-hosting)将它们设置为关闭。这将解决问题。

另外，根据您的评论，准备好的语句确实可以[*防止*SQL 注入攻击](http://www.php.net/manual/en/pdo.prepare.php)，因此您不必担心转义变量。可能难以理解的是准备好的语句的工作方式。假设您有一个查询：

```
$query = "SELECT `id` FROM `users` WHERE `login` = '" . $login . "' AND `password` = '" . $password ."'"; 
```

`$login`并按`$password`原样直接传递给查询。如果有人试图传递`mylogin' --`给`$login`，则查询变为：

```
$query = "SELECT `id` FROM `users` WHERE `login` = 'mylogin' -- ' AND `password` = 'anypassword'"; 
```

并发送到数据库。通过这种方式，攻击者可以访问任何帐户。

准备好的语句做什么，它们独立于查询传输查询参数。查询不是在将变量传输到数据库之前构建的。相反，变量以某种方式在查询旁边传输。它们在查询中被引用。这样查询就不会被有意或无意地欺骗。

使用准备好的语句，示例`$login`将按原样传输，并且不会影响查询结构。

如果可以通过飞机运送乘客，而乘客实际上并未登机，那将被称为“准备飞行”:) 乘客将无法影响路线并劫持飞机。他们会在飞机降落时出现在目标机场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:29:50.527

您是否尝试过存储编码的数据？

[http://php.net/base64_encode](http://php.net/base64_encode)

或[http://php.net/serialize](http://php.net/serialize)

如果在使用数据库之前/之后使用应该可以工作

# android - API 回调 URL 不适用于通过 Google 结帐购买应用程序的 Android

> ID：10217406
> 
> 赞同：2
> 
> 时间：2012-04-18T20:26:08.487
> 
> 标签：android, google-checkout

我希望 Google checkout 在收到订单时调用我的 servlet

我在 API 回调 URL 字段中输入了我的 servlet url，并选择了作为 XML 的通知（url 是 https），当一些应用程序内购买时，我没有接到任何电话

有没有人有这个工作？或者这是另一个不适用于 Android 的功能以及电子邮件通知

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:00:04.513

是的，这是另一个无法正常工作的功能。

似乎发生的事情是 Play 商店出于自己的目的劫持了通知事件。你永远不会收到通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:12:40.293

解决方法是使用事务数据调用您自己的服务器。挑战在于以安全的方式做到这一点。

这是一个讨论可能实现的线程：

[如何在我的服务器上验证 Android 应用内结算交易？](https://stackoverflow.com/questions/8379819/how-do-i-verify-android-in-app-billing-transactions-on-my-server)

# jquery - jQuery fancyBox 关闭图标

> ID：10217408
> 
> 赞同：0
> 
> 时间：2012-04-18T20:26:12.607
> 
> 标签：jquery, image, button, fancybox

我已经在我的 html 网站上安装了 Lightbox 库。照片打开完美，但关闭图标显示不正确。不显示图像“脱落”的内容。没有更改代码或灯箱 css。z-index 很好。真的不知道可能是什么问题。

[http://i39.tinypic.com/23jmo86.jpg](http://i39.tinypic.com/23jmo86.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T06:51:23.437

它与使用溢出有关：隐藏在你的 CSS 中的某处。有一个简单的解决方案。将此添加到您的CSS：

```
.fancybox-opened {overflow:visible !important;} 
```

它是固定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:45:36.217

嗯，我刚刚注意到有一个内联样式的过滤器`alpha(opacity=100); WIDTH: 720px`

如果我禁用似乎正确显示关闭按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:29:30.373

你有没有机会：

```
div {
    overflow: hidden;
} 
```

在你的页面 CSS 的某个地方？如果是这样，您需要使 CSS 选择器更具体。

在示例花式框上将溢出设置为隐藏会产生一个看起来完全一样的 div。不仅关闭按钮被裁剪，而且投影也被裁剪。

演示：http: [//jsfiddle.net/jtbowden/QuGme/](http://jsfiddle.net/jtbowden/QuGme/)

固定：http: [//jsfiddle.net/jtbowden/QuGme/1/](http://jsfiddle.net/jtbowden/QuGme/1/)

除此之外，如果没有看到您的 HTML 和 CSS，就很难说。

# .htaccess - 如何在 .htaccess 或 php.ini 中使用 gzip？

> ID：10217410
> 
> 赞同：1
> 
> 时间：2012-04-18T20:26:25.550
> 
> 标签：.htaccess, webserver, gzip, php

我正在寻找一个简单的一行代码，它将使用 gzip 压缩 web 服务器上的 css、html、js 和 php 文件。如何使用 .htaccess 文件或 php.ini 文件执行此操作？（我的 css 和 js 文件在根目录的单独文件夹中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T10:58:31.063

```
<Files *>
    #Compress
    SetOutputFilter GZIP
</Files> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:38:19.947

您很可能在 Apache 中寻找[mod_deflate 模块](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)。在你的启用它`httpd.conf`并启用 .htaccess 然后将此代码添加到你的 DOCUMENT_ROOT 下的 .htaccess 中：

```
<FilesMatch "\\.(js|css|html|htm|php)$">
SetOutputFilter DEFLATE
</FilesMatch> 
```

# objective-c - 整体亮度/伽玛？

> ID：10217416
> 
> 赞同：0
> 
> 时间：2012-04-18T20:26:38.660
> 
> 标签：objective-c, ios, xcode

作为用户设置，是否可以更改 iOS 应用程序的整体亮度。可能在appDelegate中，它可以改变所有的观点吗？？谢谢，任何帮助将不胜感激。

另外，我指的是应用程序本身，而不是 iOS/用户设备下的设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:45:44.260

您可以使用

```
[[UIScreen mainScreen] setBrightness:0.5]; 
```

但它只会持续到应用程序关闭。

[http://developer.apple.com/library/IOs/documentation/UIKit/Reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness](http://developer.apple.com/library/IOs/documentation/UIKit/Reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:43:22.340

要在系统范围内执行此操作，您可以使用`[UIScreen mainScreen]`'`brightness`属性，最好与滑块结合使用。（在 iOS 5.0 中可用）。

如果您只想为您的应用程序这样做，您可以尝试更改主窗口的 alpha 值，即使我更喜欢第一个版本。

# c# - Microsoft.SqlServer.Smo 问题

> ID：10217422
> 
> 赞同：4
> 
> 时间：2012-04-18T20:27:19.643
> 
> 标签：c#, .net, sql-server, smo

我有一个 .NET 2.0 项目，当我尝试编译一些使用 SMO 的项目时出现以下错误：

> 无法解析主要参考“Microsoft.SqlServer.Smo，Version=9.0.242.0，Culture=neutral，PublicKeyToken=89845dcd8080cc91，processorArchitecture=MSIL”，因为它间接依赖于框架程序集“System.Core，Version=3.5” .0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089" 在当前目标框架中无法解决。“.NETFramework，版本=v2.0”。
> 
> 要解决此问题，请删除引用“Microsoft.SqlServer.Smo, Version=9.0.242.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91, processorArchitecture=MSIL”或将您的应用程序重新定位到包含“System.Core, Version”的框架版本=3.5.0.0，文化=中性，PublicKeyToken=b77a5c561934e089"。

有人可以帮忙吗。因此，我不想将项目移至 .NET 3.5。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:32:33.587

正如异常所说，当前的参考程序集需要 .NET 3.5。您必须降级支持 .NET 2.0 的 Microsoft.SqlServer.Smo。

# php - 在 PHP 中投射自定义类的最佳方法是什么

> ID：10217428
> 
> 赞同：4
> 
> 时间：2012-04-18T20:27:42.540
> 
> 标签：php, class, casting, typeof

我知道你们中的一些人会假设接口或抽象，但这只能处理一些情况。这是他们打破的一个例子。

假设我们有实现相同接口并扩展相同基的类

```
 class car extends fourwheeler implements ipaygas{       

    protected $tank1;

    //interface
    public function payGas($amount){}

  }

  class sportscar extends fourwheeler implements ipaygas{

    protected $tank1;
    protected $tank2;

    //interface
    public function payGas($amount){}

  }

  interface ipaygas{

    function payGas($amount);
  } 
```

在某些情况下，您只需要一个接口，因为您可能只想执行“payGas()”。但是当你有条件满足的时候你会怎么做。

例如，如果 - 在支付汽油之前，您需要 (1) 检查车型，(2) 为跑车使用优质汽油，以及 (3) 为跑车的第二个油箱加满油。

这是我想做但做不到的

```
 function pumpAndPay(iPayGas $car){
     if(gettype($car) == "car"){
       fillTank($car,(car) $car->tank1);
     }else{
       fillTank($car,(sportscar) $car->tank1);
       fillTank($car,(sportscar) $car->tank2);
     }
   } 
```

如何使用真实类型转换来做到这一点？在PHP中可以吗？

更新（基于响应）：在我的“真实”案例中......想象我必须检查各种车辆类型，每种类型都有不同的油漆、车身、内饰、gas_type、cleaner_type、颜色等......

```
 abstract class AVechicle{}
   abstract class ACar extends AVechicle{}
   abstract class ATruckOrSUV extends AVechicle{}
   abstract class ABike extends AVechicle{}

   class Car extends ACar{}
   class SportsCar extends ACar{}
   class SUV extends ATruckOrSUV{}
   class Truck extends ATruckOrSUV{}
   class Bike extends ABike{}
   class Scooter extends ABike{}

   class GasStation{

     public function cleanVehicle(AVehicle $car){
       //assume we need to check the car type to know
       //what type of cleaner to use and how to clean the car
       //if the car has leather or bucket seats

       //imagine we have to add an extra $2/h for sports cars

       //imagine a truck needs special treatment tires
       //or needs inspection
     }

     public function pumpAndPay(AVehicle $car){
       //need to know vehicle type to get gas type

       //maybe we have a special for scooters only, Green Air campaign etc.
     }

     public function fullService(AVehicle $car){
       //need to know if its a truck to do inspection FIRST

       $this->cleanVehicle($car);
       $this->pumpAndPay($car);

       //bikes get 10% off
       //cars get free carwash
     }

   } 
```

仅接口和抽象只会走这么远......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:13:07.320

对您的问题的简短回答，不，您不能将一个对象重铸为另一个对象。

然而，Dan Lee 的回应是一个很好的回应，并且接近我的建议。为什么不让`fillTank`车辆对象的属性，这样所有扩展车辆类的对象都知道如何填充自己的坦克。像这样的东西：

```
abstract class Vehicle
{
    protected $tank1;
    protected $tank2;

    // Declaring an abstract function in parent class forces all child class to 
    // implement same class
    abstract public function fillGas() {}
}

class Car extends Vehicle
{
    public function fillGas()
    {
        $this->tank1 = 'full';
    }
}

class SportsCar extends Vehicle
{
    public function fillGas()
    {
        $this->tank1 = 'full';
        $this->tank2 = 'full';
    }
}

class Skateboard extends Vehicle
{
    // Skateboards don't have gastanks, just here to sastify parent abstract definition
    public function fillGas() {}
} 
```

当然，您的 OP 的一大谬误是您假设所有跑车都有两个油箱，而实际上并非如此。只有某些跑车有多个油箱。

另一种方法是看一下`traits`（[从 PHP 5.4 开始可用](http://us3.php.net/trait)）。看来您可以跨不扩展同一类的对象强制执行接口和实现。

**- 更新 -**

> 更新（基于响应）：在我的“真实”案例中......想象我必须检查各种车辆类型，每种类型都有不同的油漆、车身、内饰、gas_type、cleaner_type、颜色等......

您提到的所有这些属性都是车辆属性，而不是加油站、加油站、停车场等属性，因此我会将所有这些属性添加到车辆类中，然后您可以将车辆传递给`GasStation::cleanVehicle()`工厂方法来操作车辆属性。

下面的代码片段仅用于**演示**，演示了如何将上述属性附加到车辆类，以及该类如何根据车辆类`GasStation`操作车辆属性。我用 5 分钟写了以下内容，但很明显，要正确处理工厂方法以及是否传递给其他对象等需要更多考虑。考虑以下几点：

```
abstract class Vehicle
{
    // Setting these to public for demonstration only, otherwise you should set these 
    //  to protected and write public accessors 
    public $paintType;
    public $bodyType;
    public $interior;
}

class Car extends Vehicle
{
}

class Suv extends Vehicle
{
}

class Truck extends Vehicle
{
}

class GasStation
{
    public static function cleanVehicle(Vehicle $vehicle)
    {
        switch (get_class($vehicle)) {

            case 'Car':
                // Car specific cleaning
                break;

            case 'Truck':
                // Truck specific cleaning
                break;

            default:
                throw new Exception(sprintf('Invalid $vehicle: %s', serialize($vehicle)));
        }

        // We've gone through our vehicle specific cleaning, now we can do generic
        if ('Leather' === $vehicle->getInterior()) {
            // Leather specific cleaning
        }

        if ('Sedan' === $vehicle->getBodyType()) {
            // Sedan specific cleaning
        }
    }
 }

$car = new Car();

$car->setPaintType = 'Glossy';
$car->setBodyType = 'Sedan';
$car->setInterior = 'Cloth';

$suv = new Suv();

$suv->setPaintType = 'Glossy';
$suv->setBodyType = 'Crossover';
$suv->setInterior = 'Leather';

$truck = new Truck();

$truck->setPaintType = 'Flat';
$truck->setBodyType = 'ClubCab';
$truck->setInterior = 'Cloth';

$vehicles = array($car, $suv, $truck);

foreach ($vehicles as $vehicle) {
    GasStation::cleanVehicle($vehicle);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T20:31:18.843

您不能转换自己的类，您需要实例化一个新类，并省略变量。

你定义它的方式真的很奇怪，不一致。你为什么要创建一个全局函数来填充/坦克它？这应该是类本身的方法，不要放弃处理。而是使用抽象类，例如

```
class FillingStation
{
   protected $vehicles = array();

   public function addVehicle(Vehicle $vehicle) {
      $this->vehicles[] = $vehicle;
   }

   public function fillTanks() {
     foreach($this->vehicles as $vehicle) {
        $vehicle->fillTank();
     }
   }
} 
```

现在你定义你的抽象类，每辆汽车都将从中派生

```
abstract class Vehicle
{
  public $fillLevel = 0;

  abstract public function fillTank();
} 
```

以及具体类型

```
class Car extends Vehicle
{
  public function fillTank()
  {
     // ... do some stuff here, e.g.:
     $this->fillLevel = 100;
  }
}

class SportsCar extends Vehicle
{
  // .... 
```

现在把所有东西粘在一起：

```
$parkingLot = new FillingStation();
$parkingLot->addVehicle(new Car());
$parkingLot->addVehicle(new SportsCar());

$parkingLot->fillTanks(); 
```

这应该作为一个建议，当然您需要对其进行一些更改以满足您的需求，但我希望我试图表达的观点是明确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:35:51.157

使用[instanceof](http://us.php.net/manual/en/language.operators.type.php)或[is_a](http://us.php.net/manual/en/function.is-a.php)来确定对象类或接口。

但是，该`pumpAndPay`方法及其类与汽车类紧密耦合。您应该创建另一个类可以检查的接口（使用我列出的两种方法）。*请记住，接口可以扩展*，例如：

```
interface IPaygas
{
    private tank1;
    public function payGas($amount);
}

interface IPaygasMultiTank extends IPaygas
{
    private tank2;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:35:53.317

你的错误在这里：

```
fillTank($car,(sportscar) $car->tank1); 
```

几乎所有的类属性都应该受到保护或私有。基本上一个类不应该对另一个类的属性执行操作。相反，汽车应该处理自己的内部结构，而 PumpAndPay 只运行汽车的 fillTank 方法。

```
 function pumpAndPay(iPayGas $car){
       $amount = $car->fillTank();
       $car->payGas($amount);
   }

   interface ipaygas{

       function payGas($amount);
       function fillTank($amount);
   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-27T17:01:18.100

您所要做的就是：

```
if($val instanceof whatever.class){
  $val->dostuff();
} 
```

# javascript - 调用另一个事件处理程序时如何禁用事件处理程序

> ID：10217433
> 
> 赞同：0
> 
> 时间：2012-04-18T20:27:52.197
> 
> 标签：javascript, jquery, google-maps, coffeescript

我在一个输入字段上有两个事件监听器。一个会在更改时调用，一个会在您单击 Google 的自动完成下拉菜单时调用。我的问题是，当您单击此类自动完成时，两个处理程序都会被调用并向 google api 发出请求。

我尝试绑定 onchange 事件并在 google 自动完成 ajax 调用被触发时取消绑定它，但首先执行 onchange 事件。所以它不会解绑。那么，是否有可能检测用户是手动输入还是通过自动提示输入的？我只想在用户进行手动输入并且不使用自动完成下拉菜单时才执行“请求位置”功能。我尝试了其他一些事件处理程序，例如“focus-out”，但没有成功。

此行进行绑定：

```
autoCompleteInput.on "change", requestlocation 
```

这是被调用的函数：

```
requestlocation = () ->
  address = autoCompleteInput.val()
  geocoder = new google.maps.Geocoder()
  geocoder.geocode
    address: address, (results, status) ->
      if status is google.maps.GeocoderStatus.OK

        if results[0].address_components.length > 1
          city = results[0].address_components[0].long_name
          country = results[0].address_components[results[0].address_components.length-1].long_name
          setHiddenFields results[0].geometry.location.lat(), results[0].geometry.location.lng(), city, country 
          autoCompleteInput.val(city+", "+country)
        else
          city = null
          country = results[0].address_components[0].long_name
          setHiddenFields results[0].geometry.location.lat(), results[0].geometry.location.lng(), city, country
          autoCompleteInput.val(country)
        setMarker new google.maps.LatLng(latInput.val(), lngInput.val())
      else
        console.log "Geocode was not successful for the following reason: " + status 
```

这是自动完成处理程序发出请求的代码：

```
google.maps.event.addListener autocomplete, 'place_changed', ->
  autoCompleteInput.off "change", requestlocation

  place = autocomplete.getPlace()

  if !!place.geometry
    autoCompleteInput.attr "data-valid", "true"
    setMarker place.geometry.location
    address = place.address_components
    if address.length > 1
      setHiddenFields place.geometry.location.lat(), place.geometry.location.lng(), address[0].long_name, address[address.length-1].long_name
    else
      setHiddenFields place.geometry.location.lat(), place.geometry.location.lng(), null, address[0].long_name
  else
    autoCompleteInput.attr "data-valid", "false"

  autoCompleteInput.on "change", requestlocation 
```

感谢您的任何回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:32:00.203

第一种方法：监听`keyup`事件而不是`change`，确定处理程序中的按键类型（过滤掉箭头键、制表符和返回键），并且仅`requestlocation`在发生适当更改时调用。可能不会真正起作用，因为可以将文本粘贴到不会触发任何关键事件的输入字段中。

下一次尝试：使用一个小的超时并在自动完成事件触发时停止它。

```
autocomplete.on "change", ->
  # stop previous timeouts
  clearTimeout autocomplete.data('timeout')
  # start a new timeout and store reference
  timeout = setTimeout requestlocation, 100
  autocomplete.data timeout: timeout 
```

在您的自动完成处理程序中，您应该终止运行超时并执行您的调用：

```
google.maps.event.addListener autocomplete, 'place_changed', ->
  # stop any running timeout
  clearTimeout autocomplete.data('timeout')
  # perform your autocompletion calls
  place = autocomplete.getPlace()
  ... 
```

`change`当多个事件被快速触发时，这也可以防止多次调用。您可能需要将超时（此处：100 毫秒）调整为合适的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:33:18.593

我不知道“请求位置”是什么样的。但是如何检查更改事件的不同事件属性。(event.target / event.currentTarget) 我现在无法测试它，但也许你会发现其中的不同。只是一个想法

```
function requestlocation(event) {
  console.log(event.target, event.currentTarget);
}

var timeout;
autoCompleteInput.on("input", function() {
  clearTimeout(timeout);
  timeout = setTimeout(requestlocation, 100);
}); 
```

对普通的 javascript 感到抱歉，但我不喜欢咖啡脚本：/

# c++ - 正确释放协议缓冲区内存

> ID：10217436
> 
> 赞同：2
> 
> 时间：2012-04-18T20:28:11.440
> 
> 标签：c++, memory-management, protocol-buffers

我通过以下方式使用 Google 协议缓冲区：

```
void myfunc() {
    Buffers::MyBuffer buf;
    buf.ParseFromArray(data, datalen);
    ...
    return;
} 
```

[Protocol Buffers](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message#Message.Clear.details)的文档说要为应该删除对象的缓冲区释放内存。我不是 C++ 天才，但我认为`delete`应该只为分配有`new`. 在这里返回时是否清理了内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:49:58.523

当对象被销毁时，应该释放缓冲区的内存。

```
void myfunc() {
    Buffers::MyBuffer buf; // this create your object on stack
    const char* data= new char[100];
    datalen= readSomeData( data, 100 ); // not best for file, socket, etc.
    buf.ParseFromArray(data, datalen); // this alocate any needed object
    // by calling Buffers::SomeInternalBuffer:New
    // now you may delete the data varible, is not needed
    delete[] data; // called new, so call delete
    ...
    buf.Clear(); // here the read data are lost,
    // but some objects may not be deleted for future use

    buf.mutable_someinternalbuffer(); // call Buffers::SomeInternalBuffer:New,
    // or may not if ParseFromArray already call it

    ...
    return; // here buf is out of scope and destroyed
    // any buffers that are created by New is going to be deleted
} 
```

release_foo 要防止删除缓冲区，请使用静态新方法：

```
Buffers::MyBuffer* myfunc2() {
   Buffers::MyBuffer* buf = Buffers::MyBuffer:New();
   if( buf->ParseFromArray(data, datalen) ) 
       return buf; // return object, no memory dealocation
   delete buf; // something wrong with data, delete, destroy and dealocate
   return NULL; // return null 
} 
```

如果您需要保留任何`SomeInternalBuffer`但不`MyBuffer`使用的`release_<field>`方法：

```
Buffers::SomeInternalBuffer* myfunc3() {
    Buffers::MyBuffer buf; // this create your object on stack
   if( buf.ParseFromArray(data, datalen) ) 
       return buf.release_someinternalbuffer(); // return object
   // if ParseFromArray do not call New, method release_someinternalbuffer  
   // will call New and copy data from default value
   // no memory deallocation for returned object, everything else will deallocate

   return NULL; // same as in first example
} 
```

# java - 从 POJO 数据创建 HTML 页面

> ID：10217445
> 
> 赞同：2
> 
> 时间：2012-04-18T20:28:47.690
> 
> 标签：java, html

如果任务是从某个 POJO bean 生成 HTML 文档，那么可以遵循的最简单的方法是什么？文档并不比一系列带有标题和一些合并元素的表格更复杂。

我们今天拥有的解决方案有效，但是（**关注**）与生成 bean 的代码引擎非常紧密地耦合，我想重写它或使用现有的解决方案。

**（关注）**主要目标是不要担心标签、html 值、表结构等，并尽可能将这些东西排除在 .java 之外。

如果可能，请提供示例。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T20:31:15.070

听起来像是模板引擎的工作。查看[`Velocity`](http://velocity.apache.org/)或[`Freemarker`](http://freemarker.sourceforge.net/)。

**编辑**

我知道您说过“主要目标是不用担心标签、html 值等”，但我认为基于模板的方法比基于代码的解决方案更清洁、更易于维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:33:07.250

另一种选择是 apache 瓦片（模板引擎）。

# hadoop - 有人在不使用 EMR 的情况下使用 DynamoDB 和 Hive？

> ID：10217448
> 
> 赞同：2
> 
> 时间：2012-04-18T20:28:58.360
> 
> 标签：hadoop, amazon-dynamodb, elastic-map-reduce

我正在阅读使用 Hive 在 DynamoDB 上查询数据的以下集成。 [http://aws.typepad.com/aws/2012/01/aws-howto-using-amazon-elastic-mapreduce-with-dynamodb.html](http://aws.typepad.com/aws/2012/01/aws-howto-using-amazon-elastic-mapreduce-with-dynamodb.html)

但是根据该链接，需要在 EMR 之上设置 Hive。但是我想知道我是否可以将这种集成与我已经拥有的独立 Hadoop 集群一起使用，而不是使用 EMR。有人做过吗？与使用 EMR 相比，DynamoDB 和 HDFS 中的数据会不会出现同步问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T14:45:37.070

为了能够在您自己的集群上使用它，您需要用于 DynamoDB 的自定义**StorageHandler**（它可能还涉及自定义**SerDe**）。

目前似乎没有，至少在 AWS 网站上没有。

您可以做的是使用 Amazon 提供的[JDBC 接口](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/UsingEMR_Hive.html#HiveJDBCDriver)从您的集群中生成查询，但它仍将在 EMR 之上执行。

# asp.net - WCF 客户端代理，ASP.Net 中的客户端/通道缓存 - 代码审查

> ID：10217449
> 
> 赞同：1
> 
> 时间：2012-04-18T20:29:00.137
> 
> 标签：asp.net, wcf, proxy, client, channelfactory

长时间 ASP.Net 界面开发人员被要求学习 WCF，正在寻找更多与架构相关的领域的教育——因为它不是我的强项，但我不得不处理。

在我们当前的 ASMX 世界中，我们采用了创建 ServiceManager 静态类的模型来与 Web 服务交互。我们开始迁移到 WCF，尝试遵循相同的模型。起初我正在处理性能问题，但我进行了一些调整，现在我们运行顺利，但我质疑我的策略。这是我们正在做的简化版本（删除了错误处理、缓存、对象操作等）：

```
public static class ContentManager
{
    private static StoryManagerClient _clientProxy = null;
    const string _contentServiceResourceCode = "StorySvc";

    // FOR CACHING
    const int _getStoriesTTL = 300;
    private static Dictionary<string, GetStoriesCacheItem> _getStoriesCache = new Dictionary<string, GetStoriesCacheItem>();
    private static ReaderWriterLockSlim _cacheLockStories = new ReaderWriterLockSlim();

    public static Story[] GetStories(string categoryGuid)
    {
        // OMITTED - if category is cached and not expired, return from cache

        // get endpoint address from FinderClient (ResourceManagement SVC)
        UrlResource ur = FinderClient.GetUrlResource(_contentServiceResourceCode);

        // Get proxy
        StoryManagerClient svc = GetStoryServiceClient(ur.Url);

        // create request params
        GetStoriesRequest request = new GetStoriesRequest{}; // SIMPLIFIED
        Manifest manifest = new Manifest{}; // SIMPLIFIED

        // execute GetStories at WCF service
        try
        {
            GetStoriesResponse response = svc.GetStories(manifest, request);
        }
        catch (Exception)
        {
            if (svc.State == CommunicationState.Faulted)
            {
                svc.Abort();
            }

            throw;
        }

        // OMITTED - do stuff with response, cache if needed
        // return....
    }

    internal static StoryManagerClient GetStoryServiceClient(string endpointAddress)
    {
        if (_clientProxy == null)
            _clientProxy = new StoryManagerClient(GetServiceBinding(_contentServiceResourceCode), new EndpointAddress(endpointAddress));

        return _clientProxy;
    }

    public static Binding GetServiceBinding(string bindingSettingName)
    {
        // uses Finder service to load a binding object - our alternative to definition in web.config
    }

    public static void PreloadContentServiceClient()
    {
        // get finder location
        UrlResource ur = FinderClient.GetUrlResource(_contentServiceResourceCode);

        // preload proxy
        GetStoryServiceClient(ur.Url);
    }    
} 
```

我们现在运行顺利，往返调用在 100 毫秒范围内完成。创建 PreloadContentServiceClient() 方法并添加到我们的 global.asax 使“第一次调用”性能下降到相同的水平。您可能想知道我们正在使用 DataContractSerializer 和“添加服务引用”方法。

我已经阅读了大量关于静态类、单例、共享数据契约程序集、如何使用 ChannelFactory 模式以及我可以对我们的使用模型做的一大堆其他事情......诚然，其中一些已经过去了我的头。而且，就像我说的，我们似乎进展顺利。不过，我知道我没有看到大局。有人能告诉我关于通道池、代理故障等方面的结果，以及为什么我应该走 ChannelFactory 路径吗？我的直觉告诉我去​​做，但我的脑袋无法理解为什么......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:41:05.253

[`ChannelFactory`](http://msdn.microsoft.com/en-us/library/ms576132.aspx)通常在您不使用**添加服务引用**时使用- 您通过共享程序集而不是通过 WSDL 生成的合同。**添加服务参考**使用[`ClientBase`](http://msdn.microsoft.com/en-us/library/ms576141.aspx)它本质上是在幕后为您创建 WCF 通道。

当您处理 REST-ful 服务时，[`WebChannelFactory`](http://msdn.microsoft.com/en-us/library/bb908674.aspx)提供基于共享装配合同的服务客户端类接口。如果您的服务仅支持 REST-ful 端点绑定，则不能使用**添加服务引用。**

对您来说唯一的区别是偏好 - 您是否需要完全访问自定义行为、绑定等的通道，或者**添加服务参考**+ SOAP 是否为您提供了足够的接口来满足您的需求。

# c# - Silverlight - 元素的父级

> ID：10217450
> 
> 赞同：1
> 
> 时间：2012-04-18T20:29:16.147
> 
> 标签：c#, silverlight, windows-phone-7

现在我有一个更复杂的问题。

如何获取对象的父元素。

例如：

```
<Viewbox>
<TextBlock Name="txtblock1" />
</Viewbox> 
```

我如何通过代码（c#）获得“txtblock1”的父元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:34:22.917

使用该[`Parent`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.parent%28v=vs.95%29.aspx)物业。父级作为 an 返回，`Object`因此您需要对其进行强制转换才能调用`Viewbox`'s 方法。

例如：

```
var vbox = txtblock1.Parent as Viewbox;
if( vbox != null ) {
  // do something with vbox
} 
```

# c# - 可视化创建一组控件的工具

> ID：10217456
> 
> 赞同：1
> 
> 时间：2012-04-18T20:29:49.593
> 
> 标签：c#, drag-and-drop, controls, web

我正在寻找一种工具、插件或任何允许用户设计页面的工具（通过“设计页面”，我的意思是只需将输入、选择、无线电等控件拖动到页面并通过拖动它们来定义定位）。用户完成后，我必须将页面和控件保存为序列化字符串、XML、JSON 或 .Net 用户控件。用户设计的页面将用作信息的输入表单，我需要能够以某种方式设置和获取字段值。

即使是搜索，这也是一个复杂的话题，直到现在还没有线索。

如果有人可以为我指明方向，那将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:35:47.707

[Sharepoint](http://www.google.com.br/url?sa=t&rct=j&q=sharepoint&source=web&cd=1&ved=0CFEQFjAA&url=http%3A%2F%2Fsharepoint.microsoft.com%2F&ei=ISWPT_mhKenN6QHH-rj9Dg&usg=AFQjCNE0TSMo-hti44WALbe8Y5LaRSY2dQ)允许您使用 Web 部件构建站点，您可以创建和控制其行为。

使用 Sharepoint Web 部件，您可以控制其信息和字段。

# mysql - 得到 1005 MySQL 错误，不知道为什么

> ID：10217458
> 
> 赞同：0
> 
> 时间：2012-04-18T20:30:01.533
> 
> 标签：mysql, foreign-keys, mysql-error-1005

我正在尝试创建数据库表并将它们连接起来。我确保我的数据类型是相同的。我还确保我的表格是在添加 FK 之前制作的。任何建议将不胜感激。

```
SQL query:

ALTER TABLE `Member` ADD FOREIGN KEY ( memberId ) REFERENCES `Order_Head` ( `memberId` ) ;

MySQL said: Documentation
#1005 - Can't create table 'test2.#sql-184c_63' (errno: 150) (Details...) 

-- ---
-- Table 'Order_Head'
-- 
-- ---

DROP TABLE IF EXISTS `Order_Head`;

CREATE TABLE `Order_Head` (
  `orderId` INTEGER NOT NULL AUTO_INCREMENT,
  `memberId` INTEGER NOT NULL,
  `date` DATE NOT NULL,
  PRIMARY KEY (`orderId`, `memberId`)
);

-- ---
-- Table 'Member'
-- 
-- ---

DROP TABLE IF EXISTS `Member`;

CREATE TABLE `Member` (
  `memberId` INTEGER NOT NULL AUTO_INCREMENT,
  `userName` VARCHAR(50) NOT NULL,
  `password` VARCHAR(50) NOT NULL,
  `email` VARCHAR(100) NOT NULL,
  `isAdmin` BOOLEAN NOT NULL DEFAULT false,
  PRIMARY KEY (`memberId`)
);

-- ---
-- Foreign Keys 
-- ---

ALTER TABLE `Member` ADD FOREIGN KEY (memberId) REFERENCES `Order_Head` (`memberId`);

-- ---
-- Table Properties
-- ---
ALTER TABLE `Order_Head` ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;
ALTER TABLE `Member` ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:35:29.670

这可能是因为您尝试设置的外键是主键并且 has `AUTO_INCREMENT`，也许您的意思是：

```
ALTER TABLE `Order_Head` ADD FOREIGN KEY (memberId) REFERENCES `Member` (`memberId`); 
```

您没有在`CREATE TABLE`语句中创建外键的任何特殊原因？如果没有，那么您也许也应该这样做。

# ruby-on-rails - 添加回形针 - 现在模型不接受更新

> ID：10217460
> 
> 赞同：0
> 
> 时间：2012-04-18T20:30:05.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-web-services, paperclip

目前我有一个模型“位置”，其中添加了一个图像上传字段到表单中。当我去的时候，可以说“更新一个现有位置，甚至添加一个新位置，它会正确上传图像并显示它，但不会保存任何输入字段。

如果我删除表单上的上传照片字段并且不需要它，那么所有内容都会更新并正确保存。因此，当图像存在时出现问题，它会保存图像，但不会保存其余字段。

关于为什么会发生这种情况的任何建议？

地点.rb

```
class Location < ActiveRecord::Base

  belongs_to :region
  has_many :spots

  validates_attachment_size :photo, :less_than => 5.megabytes
  validates_attachment_content_type :photo, :content_type => ['image/jpeg', 'image/png']

   has_attached_file :photo,
                :styles => { :thumb => "150x150#", :medium => "200x200#"},
                :path => ":attachment/:id/:style.:extension",
                :s3_domain_url => "adsimgstore.s3.amazonaws.com",
                :storage => :s3,
                :s3_credentials => Rails.root.join("config/s3.yml"),
                :bucket => 'adsimgstore',
                :s3_permissions => :public_read,
                :convert_options => { :all => "-auto-orient" }

   attr_accessible :locations, :photo, :photo_file_name, :photo_content_type, :photo_file_size,     :photo_updated_at
end 
```

形式

```
<%= form_for (@location), :html => { :multipart => true } do |f| %>
  <% if @location.errors.any? %>
  <div id="error_explanation">
  <h2><%= pluralize(@location.errors.count, "error") %> prohibited this location from being saved:</h2>

  <ul>
  <% @location.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
  <% end %>
  </ul>
</div> 
```

```
<div class="field">
  <%= f.label :name %><br />
  <%= f.text_field :name %>
</div>

<div class="field">
  <%= f.label :network_id %><br />
  <%= f.text_field :network_id %>
</div>

<div class="field">
  <%= f.label :region_id %><br />
  <%= f.text_field :region_id %>
</div>

<div class="field">
  <%= f.label :spot_duration %><br />
  <%= f.text_field :spot_duration %>
</div>

<div class="field">
  <%= f.label :frequency %><br />
 <%= f.text_field :frequency %>
</div>

<div class="field">
  <%= f.label :screen_count %><br />
  <%= f.text_field :screen_count %>
</div>

<div class="field">
  <%= f.label :ad_size %><br />
  <%= f.text_field :ad_size %>
</div>

<div class="field">
  <%= f.label :ad_type %><br />
  <%= f.text_field :ad_type %>
</div>

<div class="field">
  <%= f.label :impressions %><br />
  <%= f.text_field :impressions %>
</div>

<div class="field">
  <%= f.label :rate_card %><br />
  <%= f.text_field :rate_card %>
</div>

<div class="field">
  <%= f.file_field :photo %>
</div>

<div class="field">
  <td><%= image_tag @location.photo.url(:thumb) %></td>
</div>

<div class="actions">
  <%= f.submit %>
</div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:45:11.213

您是否尝试评论该行

```
 attr_accessible :locations, :photo, :photo_file_name, :photo_content_type, :photo_file_size,     :photo_updated_at 
```

# html - 在小部件“内容”属性的 HTML 格式中使用框属性

> ID：10217466
> 
> 赞同：0
> 
> 时间：2012-04-18T20:30:22.153
> 
> 标签：html, firefox, widget, add-on

`.ico`我想要一个大致正方形的小部件，与 Widget Row 上的 16x16 像素小部件（或 Firefox 窗口底部该行小部件的任何技术术语）具有相同的高度，其中包含一个文本字母，水平居中和垂直“居中”，通过文本和背景颜色的附加代码进行控制。这可以作为对象的`content`属性进行 HTML 编码`widget`吗？我已经得到了字母周围`style`属性为 a的颜色`span`，但到目前为止还没有运气让“盒子属性”发挥作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:35:22.280

不知道你想得到什么，但你可以很容易地用 style 属性创建它。 [http://jsfiddle.net/k9brL/](http://jsfiddle.net/k9brL/)

# c# - 从 datagridview 显示文本框中的数据

> ID：10217467
> 
> 赞同：1
> 
> 时间：2012-04-18T20:30:23.197
> 
> 标签：c#

我在我的 Windows 窗体应用程序“C#”和一个 datagridview 工具中有两个文本框，我想要（如果用户单击 datagridview 中的任何行），该行中的数据应该出现在两个文本框中如何做这件事。

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:33:19.470

### 描述

您可以订阅 DataGridView`CellClick`事件。

### 样本

```
// subscribe the event using code
yourDataGridView.CellClick += new DataGridViewCellEventHandler(YourGridView_CellClick);

// handle the event
private void YourGridView_CellClick(object sender,
    DataGridViewCellEventArgs e)
{
    DataGridViewImageCell cell = (DataGridViewImageCell)
        yourDataGridView.Rows[e.RowIndex].Cells[e.ColumnIndex];

   yourTextBox.Text = cell.Value;
} 
```

### 更多信息

*   [MSDN - DataGridView.CellClick 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellclick.aspx)

# java - 使用 AWT 绘制饼图

> ID：10217469
> 
> 赞同：0
> 
> 时间：2012-04-18T20:30:30.517
> 
> 标签：java, awt, graphics2d

我想使用 java+awt (Graphics2D API) 绘制饼图。

我所有的值都存储在一个数组中，所以理论上我必须乘以 360 才能转换为度数。

并使用 x、y 坐标、起始角度和范围角度创建我的对象，但是当我绘制图表时我得到了这个。

![饼形图](../Images/44fccbfb2c3b70063cf2db349c674959.png)

这是我的代码：

```
for(int i=0;i<pie.getNumDatos();i++){
            g2.setPaint(colores[i%colores.length]);
            double endDegree=valores[i].valor*360;
            Arc2D arcos=new Arc2D.Double(x, y,300,300,last,endDegree, Arc2D.PIE);
            last=endDegree;
            g2.fill(arcos);
            g2.draw(arcos);

        } 
```

我会试着解释一下。

`pie.getNumDatos()`是我的数据数组上的“块”数（等于 array.size()）。

endDegree 是我用十进制表示的百分比（例如：第一个值的 0.25），乘以 360 得到弧的结束度。

last 是最后一个值的最后一个度数，所以理论上下一个值必须从最后一个值度数开始。

当我调试第一个和第二个值（实际上只有 3 个值）时一切正常，但在第三个值（蓝色）上出现问题。

难道我做错了什么？

# php - 在 PHP 上用于 MongoDB 的 MapReduce？

> ID：10217470
> 
> 赞同：-1
> 
> 时间：2012-04-18T20:30:30.950
> 
> 标签：php, mongodb, mapreduce

我是 MongoDB 新手，这是我第一次使用 MapReduce。

我有两个集合：具有以下架构的商店和产品

```
Products
{'_id', 'type': 'first', 'enabled': 1, 'shop': $SHOP_ID  }
{'_id', 'type': 'second', 'enabled': 0, 'shop': $SHOP_ID  }
{'_id', 'type': 'second', 'enabled': 1, 'shop': $SHOP_ID  } 
```

和

```
Shops
{'_id', 'name':'L', ... }
{'_id', 'name':'M', ... } 
```

我正在为带有 MapReduce 的 MongoDB 寻找 GROUPBY 类似的语句，以检索名称为“L”且产品为“已启用”=> 1 的商店

我该怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:33:07.677

应该可以在没有 Map Reduce 操作的情况下检索所需的信息。

您可以首先在“Products”集合中查询匹配 {'enabled': 1} 的文档，然后从该查询中获取 $SHOP_ID 列表（我想它对应于“Shops”集合中的 _id 值），放入将它们放在一个数组中，并对“Shops”集合执行 $in 查询，并结合对“name”的查询。

例如，给定两个集合：

```
> db.products.find()
{ "_id" : 1, "type" : "first", "enabled" : 1, "shop" : 3 }
{ "_id" : 2, "type" : "second", "enabled" : 0, "shop" : 4 }
{ "_id" : 3, "type" : "second", "enabled" : 1, "shop" : 5 }
> db.shops.find()
{ "_id" : 3, "name" : "L" }
{ "_id" : 4, "name" : "L" }
{ "_id" : 5, "name" : "M" }
> 
```

首先找到所有匹配 {"enabled" : 1} 的文档

```
> db.products.find({"enabled" : 1})
{ "_id" : 1, "type" : "first", "enabled" : 1, "shop" : 3 }
{ "_id" : 3, "type" : "second", "enabled" : 1, "shop" : 5 } 
```

根据上述查询，生成 _id 列表：

```
> var c = db.products.find({"enabled" : 1})
> shop_ids = []
[ ]
> c.forEach(function(doc){shop_ids.push(doc.shop)})
> shop_ids
[ 3, 5 ] 
```

最后，在 shop_ids 数组中查询具有 _id 值且也与 {name:"L"} 匹配的文档的商店集合。

```
> db.shops.find({_id:{$in:shop_ids}, name:"L"})
{ "_id" : 3, "name" : "L" }
> 
```

以前也有人问过类似的关于使用 Mongo 执行相当于 join 操作的问题。这个问题提供了一些链接，可以为您提供额外的指导：
[如何在 Python 中加入 MongoDB 集合？](https://stackoverflow.com/questions/9771330/how-to-join-mongodb-collections-in-python)

如果您想尝试使用 Map Reduce，这里是一个用户的博客文章链接，该用户使用增量 Map Reduce 操作来组合来自两个集合的值。
[http://tebros.com/2011/07/using-mongodb-mapreduce-to-join-2-collections/](http://tebros.com/2011/07/using-mongodb-mapreduce-to-join-2-collections/)

希望以上内容可以让您从您的收藏中检索所需的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:34:06.190

简短的回答：你不能这样做（使用单个 MapReduce 命令）。

长答案：MongoDB 中的 MapReduce 作业仅在单个集合上运行，不能引用进程中的其他集合。因此，这里不提供类似`JOIN`/`GROUP BY`的 SQL 行为。新的聚合框架也仅在单个集合上运行。

我提出了一个两部分的解决方案：

1.  获取名称为“L”的所有商店。

2.  编写并运行 map-reduce 命令，该命令将根据这个预先计算的商店列表检查每个产品文档。

# python - 谷歌应用引擎的“memcache.get()”是否返回引用或深拷贝？

> ID：10217476
> 
> 赞同：0
> 
> 时间：2012-04-18T20:31:11.590
> 
> 标签：python, google-app-engine, memcached

应用引擎的“memcache.get()”是否返回引用或深拷贝？

我问的原因是因为我想知道在修改对象后是否需要调用 memcache.set() 。

例如：

```
# INITALIZE
t_var = {}
t_var['foo'] = 1
memcache.set('some_key', t_var)

# LATER ON...
t_var = memcache.get('some_key')
t_var['foo'] = 2

# EVEN LATER ON...
t_var = memcache.get('some_key')
print t_var['foo'] 
```

是`print t-var['foo']`显示“1”还是“2”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T21:01:32.540

对象`pickle`在发送到`memcached`. 因此，您返回的对象必然是副本。这是因为`memcached`它是一个独立于 Python 解释器的进程，此外，它对 Python 对象一无所知。

# asp.net - 从容器页面访问用户控件中动态创建的复选框

> ID：10217482
> 
> 赞同：0
> 
> 时间：2012-04-18T20:31:41.013
> 
> 标签：asp.net

我正在 asp.net 中构建一个向导。我有一个主 aspx 页面，其中将有 NEXT 和 PREVIOUS 按钮用于导航。在单击每个 NEXT 或 PREVIOUS 时，将加载相应的用户控件。

在一个用户控件中，我必须创建动态复选框，如下所示：

```
 Public Class ucQuestion
    Inherits System.Web.UI.UserControl

#Region "UserControl Events"

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Try
            If Not (Page.IsPostBack) Then
                AddControls(0)
            End If
        Catch ex As Exception
            Throw ex
        End Try
    End Sub

#End Region
Protected Friend Sub AddControls(ByVal iListQuestionCount As Integer)
        Try
            Dim oExam As New BusinessObject.Wizard.ExamVM
            If (System.Web.HttpContext.Current.Session(BusinessLayer.Constants.WizardObjectCollection) IsNot Nothing) Then
                oExam = DirectCast(System.Web.HttpContext.Current.Session(BusinessLayer.Constants.WizardObjectCollection), BusinessObject.ExamWizard.ExamVM)
            End If

            'divQuestion.Controls.Clear()

            Dim ctrl As New Literal

            ctrl.ID = "lit" + iListQuestionCount.ToString()
            ctrl.Text = oExam.Wizard.ExamQuestions(iListQuestionCount).Label
            divQuestion.Controls.Add(ctrl)

            For iLoopChildCount As Integer = 0 To oExam.Wizard.ExamQuestions(iListQuestionCount).Choices.Count - 1
                Dim childctrl As New CheckBox
                'childctrl.AutoPostBack = True
                childctrl.ID = "chk" + (iLoopChildCount + 1).ToString()
                childctrl.Text = oExam.Wizard.ExamQuestions(iListQuestionCount).Choices(iLoopChildCount).Label
                childctrl.Checked = oExam.Wizard.ExamQuestions(iListQuestionCount).Choices(iLoopChildCount).IsSelected
                'AddHandler childctrl.CheckedChanged, AddressOf OnCheckedClick
                divQuestion.Controls.Add(childctrl)
            Next

        Catch ex As Exception
            Throw ex
        End Try
    End Sub 
```

现在问题出在我的 Main.aspx 页面中，如果用户在用户控件中选择了任何复选框，我想将值保存在 NEXT 按钮导航单击事件的会话中。

我在 NEXT Button Click 中尝试了以下代码，但没有成功。

```
For iLoopChildCount As Integer = 0 To oExamQuestions(ListIndex).Choices.Count - 1
                Dim ctrl As Control
                If (ucQuestion1.FindControl("chk" + (iLoopChildCount + 1).ToString()) IsNot Nothing) Then
                    ctrl = DirectCast(ucQuestion1.FindControl("chk" + (iLoopChildCount + 1).ToString()), CheckBox)
                    If (DirectCast(ctrl, CheckBox).Checked) Then
                        oBallotQuestions(ListIndex).Choices(iLoopChildCount).IsSelected = True
                    End If
                End If
            Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:43:17.130

这是艰难的道路。

这是简单的方法。

1.  定义一个[接口](http://msdn.microsoft.com/en-us/library/28e2e18x%28v=vs.100%29.aspx)并在代表此操作的用户控件中实现它。这可能`GetNamesOfSelectedValues`是适当的或任何适当的。（从技术上讲，不需要接口，但我发现这是一种很好的做法，并且在许多情况下它可以实现“定义更明确的合同”。）
2.  使用父页面代码中在所述子级上定义的接口。仅*在*`OnLoad`子控件（在页面加载事件之后发生）*之后*使用它，否则控件将不会被恢复。

也就是说，父级*不应该知道*自定义用户控件中的任何控件。

这种方法效果很好。

# c - 需要帮助 OpenGL + C

> ID：10217483
> 
> 赞同：0
> 
> 时间：2012-04-18T20:31:49.110
> 
> 标签：c, opengl

我想在 openGl 中实现 C 代码以在我的 solor 系统程序中显示日期。但我收到错误，基本上如下：

> 错误：二进制 * 的无效操作数（有 'char *' 和 'char *'）

我的代码如下：

```
void showDate(void)
{
    int days, years;
    char str[30];
    char *ch;

    // ....... some code

    // and here it's giving that error in for statment
    for( ch * str; *ch; ch++){
        glutBitmapCharacter(GLUT_BITMAP_HELVETICA_18, (int) *cha
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:37:37.783

你的循环是错误的。它应该如下所示：

```
for (ch = str; *ch; ch++)
{
    glutBitmapCharacter(GLUT_BITMAP_HELVETICA_18, (int) *ch);
} 
```

# java - 在hadoop中，reduce任务如何从map任务中提取数据

> ID：10217484
> 
> 赞同：0
> 
> 时间：2012-04-18T20:31:49.810
> 
> 标签：java, hadoop

我知道reducer通过http拉取地图输出。但是由于每个 map 任务都将其所有溢出合并到一个文件中，reduce 任务如何从 map 任务中提取这些中间数据？只是那个文件的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:41:23.233

map 任务的输出按分区号排序。每个分区号对应一个reducer。当一个reducer拉取输出时，文件指针会偏移到reducer分区号的起始位置，并开始读取。当然，在映射器端维护一些分区号到文件偏移表来实现这一点。

# c# - 在查找数据的唯一 ID 时依赖 System.Guid.NewGuid() 函数有什么缺点吗？

> ID：10217487
> 
> 赞同：8
> 
> 时间：2012-04-18T20:32:24.523
> 
> 标签：c#, asp.net-4.0

我正在寻找生成唯一 ID 来识别我系统中的一些数据。我正在使用一个精心设计的系统，它将一些（非唯一的、相关的）元数据与 System.Guid.NewGuid()s 连接起来。这种方法有什么缺点吗，还是我很清楚？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-18T21:40:27.597

> 我正在寻找生成唯一 ID 来识别我系统中的一些数据。

我会推荐一个 GUID，因为它们根据定义是*global unique identifiers*。

> 我正在使用一个精心设计的系统，它将一些（非唯一的、相关的）元数据与 System.Guid.NewGuid() 连接起来。这种方法有什么缺点吗，还是我很清楚？

好吧，因为我们不知道你会认为什么是缺点，所以很难说。我想到了一些可能的缺点：

*   GUID 很大：128 位是很多位。

*   不保证 GUID 具有任何特定的分布；按顺序生成 GUID 是完全合法的，在它们的 124 位空间（当然是 128 位减去作为版本号的 4 位）上均匀分布是完全合法的。这会对数据库产生严重影响如果 GUID 被用作数据库上的主键，该数据库按 GUID 的排序顺序进行索引，则性能；如果新行总是在最后，插入会更有效率。一个均匀分布的 GUID 几乎*永远不会*结束。

*   第 4 版 GUID*不一定是*加密随机的；如果 GUID 是由非加密随机生成器生成的，则攻击者理论上可以在给出具有代表性的样本时预测您的 GUID 是什么。理论上，攻击者可以确定在同一会话中生成两个 GUID 的概率。第一版 GUID 当然几乎不是随机的，并且可以告诉老练的读者它们是在何时何地生成的。

*   等等。

我计划在接下来的几周内撰写一系列关于 GUID 的这些和其他特征的文章；看我的博客了解详情。

更新：[https ://ericlippert.com/2012/04/24/guid-guide-part-one/](https://ericlippert.com/2012/04/24/guid-guide-part-one/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-18T20:37:10.843

使用 时`System.Guid.NewGuid()`，您可能仍想检查系统中是否存在该 guid。

虽然 guid 如此复杂以至于几乎是唯一的，但除了概率之外，没有什么可以保证它不存在。这在统计上是*难以置信*的，以至于几乎在任何情况下它都与独特性相同。

生成相同的 guid 就像中了两次彩票 - 没有什么可以真正阻止它，它太不可能了，它也可能是不可能的。

在大多数情况下，您可能不检查现有匹配项而侥幸逃脱，但在非常极端的情况下，有大量生成，或者系统*绝对不能失败*，这可能值得检查。

编辑

让我再澄清一点。您极不可能看到重复的 guid。这才是重点。它是“全球唯一的”，这意味着重复的可能性非常小，您可以假设它是唯一的。但是，如果我们谈论的是让飞机在空中飞行、监控核反应堆或在国际空间站处理生命支持的代码，我个人仍然会检查是否有重复，只是因为它真的很糟糕击中那个边缘案例。另一方面，如果您只是在编写博客引擎，请继续使用它而无需检查。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-18T20:42:01.410

随意使用`NewGuid()`。它的独特性没有问题。

两次生成同一个guid的概率太低；一个很好的例子可以在这里找到：[简单证明 GUID 不是唯一的](https://stackoverflow.com/questions/1705008/simple-proof-that-guid-is-not-unique)

```
var bigHeapOGuids = new Dictionary<Guid, Guid>();
try
{
   do
   {
      Guid guid = Guid.NewGuid();
      bigHeapOGuids.Add(guid ,guid );
   } while (true);
}
catch (OutOfMemoryException)
{
} 
```

在某些时候，它只是崩溃了，`OutOfMemory`而*不是*重复的密钥冲突。

# java - java中foreach和for循环中的方法

> ID：10217489
> 
> 赞同：28
> 
> 时间：2012-04-18T20:32:27.563
> 
> 标签：java, android

我的问题是关于使用 Android 编译器在 java 中进行优化。每次迭代都会调用下面的 map.values()，还是 Android 编译器会对其进行优化。

```
LinkedHashMap<String, Object> map;

for (Object object : map.values())
{
   //do something with object
} 
```

同样，这里是另一个例子。每次迭代都会调用 aList.size() 吗？

```
List<Object> aList;

for (int i = 0; i < aList.size(); i++)
{
    object = aList.get(i);
    //do something with i
} 
```

毕竟，如果每次迭代都调用方法真的很重要吗？Map.values() 和 List.size() 有什么作用吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-18T20:35:22.480

在第一个示例中，`map.values()`将被评估一次。根据[Java Language Specification 的第 14.4.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2)，它相当于：

```
for (Iterator<Object> i = map.values().iterator(); i.hasNext(); ) {
    Object object = i.next();
    // do something with object
} 
```

第二个，`aList.size()`每次评估测试时都会调用。为了可读性，最好将其编码为：

```
for (Object object : aList) {
    // do something with object
} 
```

但是，根据[Android 文档](https://developer.android.com/training/articles/perf-tips.html#Loops)，这会更慢。假设您没有更改循环内的列表大小，另一种~~最快的~~方法是在循环之前拉出列表大小：

```
final int size = aList.size();
for (int i = 0; i < size; i++)
{
    object = aList.get(i);
    //do something with i
} 
```

`aList`如果恰好是，这将大大加快（上面链接的 Android 文档说是 3 倍）`ArrayList`，但对于`LinkedList`. 这一切都取决于究竟是什么样的`List`实现类`aList`。

# jquery-ui - 从 Jquery UI Sortable 重置位置

> ID：10217490
> 
> 赞同：2
> 
> 时间：2012-04-18T20:32:30.313
> 
> 标签：jquery-ui, jquery-ui-sortable, reset

我正在使用来自 Jquery UI 的可排序。每次我从 resultPos 获取值时，它都会给我最后一步，但请记住最后一个命令。我需要重置它。

例如，我有 3 个元素：

```
Move 3rd element to 2nd position: end=1&end=3&end=2
Again ...
Move 3rd element to 2nd position: end=1&end=2&end=3
Again ...
Move 3rd element to 2nd position: end=1&end=3&end=2 
```

我需要有一些东西可以返回给我以下内容：

```
Move 3rd element to 2nd position: end=1&end=3&end=2
Again ...
Move 3rd element to 2nd position: end=1&end=3&end=2
Again ...
Move 3rd element to 2nd position: end=1&end=3&end=2 
```

这是我的代码：

```
$( ".sortableChip" ).sortable({
        revert: true,
        containment: "#carousel",
        axis: "x",
        items: 'li.edited',
        tolerance: 'pointer',
        placeholder: 'draggin-space',
        start: function(event, ui) { 
             var startPos = $('.sortableChip').sortable('serialize',{ key: 'start'});
        },
        sort: function(event, ui) {
            ui.item.addClass('draggin');
            $('.remove-chart').hide();
        },
        update: function(event, ui) {
            var resultPos = $('.sortableChip').sortable('serialize',{ key: 'end'});
            ui.item.removeClass('draggin');
        }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T20:11:00.177

jquery UI 中可排序的每个项目都是一个 LI，有几种方法可以做到这一点，一种方法是在页面最初加载时保存一个具有可排序列表内容的变量，就像在文档准备部分中一样。它所做的只是重新排列 ul 标签内的 li 标签的顺序。

```
<script type="text/javascript">

    $(document).ready(function(){

         $('#link').click(function(){

            //this will empty out the contents of the ul
            $('.sortableChip').html('');
            /*this will replace the contents of the ul with 
            contents that were caputred 
            */
            $('.sortableChip').html(reset);

        });

    });

    var reset = $('.sortableChip').html();
    /*this is here at the bottom because you want to everything that is created     
    dynamically with jquery or javascript to be captured also.
    */
</script> 
```

您基本上所做的只是在单击链接后返回正确的设置，仅此而已，您实际上不需要此行 `$('.sortableChip').html(''); 但我把它放在这里是为了让你知道它正在被清空和替换

如果需要根据您单击的内容对它们进行排序，您可以将您想要的状态保存为变量，例如重置，然后简单地清除内容并根据用户单击的内容加载变量

# java - 监控 Java 对象销毁

> ID：10217495
> 
> 赞同：1
> 
> 时间：2012-04-18T20:32:43.337
> 
> 标签：java, garbage-collection

我有一些对象经常被创建/销毁，并且可以同时存在于许多列表中。为了确保我没有留下对它们的引用，这些对象有一个标志 isDestroyed，如果设置了这个，每个列表都负责从列表中删除该对象。

然而，这当然是内存泄漏的增长点。如果我忘记从其中一个列表中删除对象怎么办？为了直观地监控程序是否正确运行，我重写了 finalize 并增加了一个全局变量来跟踪破坏（不是正式测试，只是为了了解一下）。然而，由于我无法控制 GC，理论上我可以永远等到某些东西被破坏。

所以问题有两个方面：当对象位于多个列表中时，“isDestroyed”是否被认为是控制对象生命周期的好方法？它迫使使用该对象的每个人小心地将其从列表中删除，这似乎很糟糕。

而且，有什么好方法可以查看对象的引用计数何时达到零，即何时计划销毁？

编辑：更具体地说，在我的情况下，我的对象代表房间中的物理实体。而且我有一个绘制每个对象的管理器类，因此它在一个列表中。另一个列表包含所有可点击的对象，所以我有另一个列表。在这种情况下，将所有对象放在一个列表中并使用多态性或实例不是一种选择。当一个对象被“销毁”时，它不应该以任何方式显示或点击，因此我想从两个列表中删除它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:47:38.030

你应该看看[`java.lang.ref`](http://docs.oracle.com/javase/6/docs/api/java/lang/ref/package-summary.html)包裹。

> 而且，有什么好方法可以查看对象的引用计数何时达到零，即何时计划销毁？

您可以使用[ReferenceQueue](http://docs.oracle.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html)对象

来自*JavaDoc* _`java.lang.ref.ReferenceQueue`

> 参考队列，在检测到适当的可达性更改后，垃圾收集器会将已注册的参考对象附加到这些队列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:47:55.933

我认为这就是 WeakReference 和 ReferenceQueue 的用途 - 您为要跟踪的对象创建一个 WeakReference 并将其与 ReferenceQueue 相关联。然后你有另一个线程处理从 ReferenceQueue.remove() 返回的 WeakReference(s)。当引用的对象被 GC'd 时，WeakReference 被添加到 ReferenceQueue。但是，您能否举例说明当引用的对象已死时您要清理的这些列表是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:12:43.877

通常处理这种情况的方式是通过观察者模式。每个列表都附加一个销毁侦听器，该侦听器在销毁时得到通知。这如何与你的架构相结合，我没有细节可以判断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T23:59:10.740

如果您想收到通知，我几乎可以肯定您需要 PhantomReference，请在此处阅读：

[http://weblogs.java.net/blog/2006/05/04/understanding-weak-references](http://weblogs.java.net/blog/2006/05/04/understanding-weak-references)

# ios - 单击按钮时在不同的图像视图中显示图像。

> ID：10217497
> 
> 赞同：0
> 
> 时间：2012-04-18T20:32:48.503
> 
> 标签：ios, xcode, imageview

我一直在努力使这段代码工作，但不能真正把最后一部分放在一起。

我有 2 行 6 个图像视图，

Imageview 1 到 6 和 7 到 12。

首先，我从 26 个按钮 (AZ) 中单击 6 个按钮，它们显示在前 6 个视图中，代码如下：

```
- (void)setImage:(UIImage *)image {
if (imageview1.image == nil) {
    [imageview1 setImage:image];
} else if (imageview2.image == nil){
    [imageview2 setImage:image];
} else if (imageview3.image == nil){
    [imageview3 setImage:image];
} else if (imageview4.image == nil){
    [imageview4 setImage:image];
} else if (imageview5.image == nil){
    [imageview5 setImage:image];
} else if (imageview6.image == nil){
    [imageview6 setImage:image];
}
 }

-(IBAction)showA {

UIImage *img = [UIImage imageNamed:@"A.png"];

[self setImage:img];

} 
```

现在，当我单击播放按钮时，我希望图像从视图 1 - 6 变为 7 - 12。

我希望有人可以解释我如何做到这一点，我现在尝试了几种方法，但不能真正让它工作，也许制作可变字符串然后从中获取图像？

希望有人能给我解释一下或者有一些示例代码给我谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:39:10.297

这不是因为您没有为 UIImageView 设置图像，它没有为图像分配空间。

另一方面，CGImage 表示“图像的数据”。如果您没有设置图像但 UIImageView 为您分配 UIImage，您确定“此图像的数据”将为 nil（因为没有图像）。

所以你应该试试看：

```
if([imageview1.image CGImage]==nil){[imageview1 setImage:image];} 
```

希望对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:31:04.600

像这样？

```
[imageview7 setImage:imageView1.image];
[imageview8 setImage:imageView2.image];
etc...
[imageview1 setImage:nil];
[imageview2 setImage:nil];
etc... 
```

# excel - 将经纬度列表转换为城市名称输出应为 .xls

> ID：10217500
> 
> 赞同：1
> 
> 时间：2012-04-18T20:33:04.303
> 
> 标签：excel, google-maps, google-geocoding-api

我有一个 Excel 表，其中有一个纬度和经度列表，如下所示：

```
County     latdecdeg londecdeg     State
Allegheny   40.5254 -80.07213889    PA
Allegheny   40.5526 -80.1159        PA
Allegheny   40.5191 -80.13090556    PA
Allegheny   40.5134 -80.13508889    PA
Allegheny   40.5228 -80.17644722    PA
Allegheny   40.496  -79.939375      PA
Allegheny   40.6154 -79.7586        PA
Allegheny   40.2733 -80.10555556    PA
Armstrong   40.7559 -79.6435        PA
Armstrong   40.815  -79.535025      PA
Armstrong   40.8052 -79.51341389    PA
Beaver      40.6957 -80.36681667    PA
Berks       40.2485 -76.03885833    PA
Berks       40.2979 -75.89966111    PA
Blair       40.5622 -78.32684722    PA
Blair       40.6001 -78.31262222    PA 
```

我需要填充相应的城市名称。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:37:57.740

在 Excel 中，您需要创建一个插件或可能的宏（我不熟悉宏有多少功能）来为您完成。该过程称为“反向地理编码”，您可以使用 Google Maps API。

请参阅此链接：[https ://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)

# python - 姜戈评论。验证错误后如何返回页面

> ID：10217501
> 
> 赞同：1
> 
> 时间：2012-04-18T20:33:06.957
> 
> 标签：python, django

下面是我的代码。在一些验证错误 Urls.py 之后，我不知道如何重定向回来：

```
 (r'^comments/', include('django.contrib.comments.urls')), 
```

视图.py：

```
def show_episode(request, episode) :
episode = get_object_or_404(Episode, pk=episode)

return render_to_response('episode.html', context_instance=RequestContext(request, {
    'episode' : episode,
    })) 
```

情节.html：

```
 <div class="subsection">
        {% get_comment_form for episode as form %}
        <table>
            <form action="{% comment_form_target %}" method="post">
                {% csrf_token %}
                {{ form }}
                <tr>
                    <td colspan="2" style="text-align: center">
                        <input type="submit" name="submit" value="Post">
                        <input type="submit" name="preview" value="Preview">
                    </td>
                </tr>
                <input type="hidden" name="next" value="{% url episode episode.id %}" />
            </form>
        </table>
    </div>
    <div class="subsection">{% render_comment_list for episode %}</div> 
```

当出现一些错误时，我想回到这个表格。

* * *

我尝试，但我有一个错误：'QueryDict' 对象没有属性'_meta' 代码：

```
def comments(request) :
if request.method == 'POST' :
    form = CommentForm(request.POST)
    if (form.is_valid()) :
        form.save()
    return HttpResponseRedirect(request.POST['next'])
return HttpResponseRedirect('/') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:45:36.247

反过来做：在同一个视图中处理表单（即 set `<form action=""`，这样用户就不会丢失他的输入（就像他使用重定向一样）。

不过，您仍然可以通过此视图*调用其他视图。*( `if request.method == 'POST'`)

当没有错误时，发送一个`response.redirect`到成功视图。

# html - SharePoint 2010 - 页面查看器

> ID：10217503
> 
> 赞同：1
> 
> 时间：2012-04-18T20:33:07.953
> 
> 标签：html, sharepoint-2010, web-parts, webpage

我想使用页面查看器 web 部件来显示带有一些 java 脚本的 html 页面。该页面将作为 SharePoint 中的独立页面托管（可能在共享文档文件夹下）。

问题是这样的：当我将 Web 部件指向使用页面时，它会提示我保存 html 文件，而不是在 Web 部件中显示其内容。

我遵循一般规则来创建 html 文件：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
   <head>
     <title>My Little SharePopint Page</title>
   </head>
   <body>
     <div id="PlayerName">
     </div>
     <div id="display">
     </div>
   </body>
 </html> 
```

因此，我只需要将页面显示在 Page Viewer Web 部件中 - 并且不会提示将其保存为文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:58:50.267

您的 Web 应用程序配置强制您的用户下载文件，这是设计使然，默认情况下，您可以在管理中心的“Web 应用程序常规设置”中更改它。寻找“浏览器文件处理”确保它不严格。检查[有关](http://technet.microsoft.com/en-us/library/cc262107.aspx) 此设置的技术网页面。

这可能会产生安全隐患（例如在浏览器窗口中加载 PDF 文件）。还有其他方法可以使用 js 完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T09:40:26.217

您需要首先删除正文标签的南北两侧，它们已经通过 SharePoint 呈现。然后将文件（仅包含 div 内容）加载到您的文档库并使用页面查看器指向该文件。

我注意到您正在使用 PlayerName，这意味着稍后会出现某种类型的 Flash/视频播放器内容，具体取决于所使用的对象设置，这也会导致“下载”文件显示。

# java - JDBC URL 格式导致 TNS 错误

> ID：10217509
> 
> 赞同：0
> 
> 时间：2012-04-18T20:33:27.580
> 
> 标签：java, jdbc, oracle11g

以下 2 个 JDBC URL 声明之间的实际区别是什么？

```
1\. jdbc:oracle:thin:@//hostname:1521/servicename

2\. jdbc:oracle:thin:@hostname:1521:sidid 
```

**问题的原因：** URL1 仅适用于某些特定的 oracle 数据库，而 URL2 似乎适用于所有类型的数据。URL2 格式也可以用于服务名称吗？

**问题：** 当我对某个数据库使用 URL1 时出现以下错误。

```
java.sql.SQLException: Listener refused the connection with the following error:
ORA-12514, TNS:listener does not currently know of service requested in connect descriptor
The Connection descriptor used by the client was:
//hostname:1521/sidid

    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:125)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:280)
    at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:328)
    at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:361)
    at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:151)
    at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)
    at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:595)
    at java.sql.DriverManager.getConnection(DriverManager.java:582)
    at java.sql.DriverManager.getConnection(DriverManager.java:185) 
```

**解决方案：** 使用 URL2 并修复了上述 TNS 错误。

**已编辑：** 将 URL 的格式从 sid 更改为 servicename。当它对 sid 的期望格式与服务不同时，为什么它会抛出错误？

# php - Magento 购物车在浏览器后退按钮上中断

> ID：10217510
> 
> 赞同：0
> 
> 时间：2012-04-18T20:33:27.737
> 
> 标签：php, html, magento, e-commerce

我正在使用 Magento 1.6.2，进行了相当多的自定义 - 包括经过大量修改的购物车模板。

当用户在将商品添加到购物车后单击浏览器的“返回”按钮时，我遇到了问题。我只能使用 Firefox 重现此问题。Chrome 和 IE 工作正常。

重现步骤。

1.  打开特定产品页面，单击“添加到购物车”。
2.  您将转到购物车/预览页面。
3.  使用浏览器的“返回”按钮返回产品视图。
4.  “添加到购物车”按钮现在完全不起作用。在具有自定义必需选项的产品上，不运行验证。真的，什么都没有发生。
5.  返回产品目录。找到并返回到之前使用的相同项目。
6.  点击“加入购物车”。一切正常 - 您被重定向到购物车，并更新了数量。

我不知道从哪里开始。有人有想法么？

生产/现场网站： http: [//myerstownsheds.com/](http://myerstownsheds.com/) “请求报价”实际上是“添加到购物车”按钮，我们还没有出售任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:26:01.807

问题是当按钮被点击时，它会被禁用。

这只是 Firefox 中的一个问题，因为当使用后退按钮时，firefox 不会重置页面状态，您往往会以您离开它的确切状态返回到页面，在这种情况下按钮被禁用。

通过单击添加到购物车按钮然后按停止在任何浏览器中复制相同的问题。您不能再次单击该按钮。

在您的页面上，您有一个包含以下内容的 javascript 标记：

```
 var productAddToCartForm = new VarienForm('product_addtocart_form');
    productAddToCartForm.submit = function(button, url) {
        if (this.validator.validate()) {
            var form = this.form;
            var oldUrl = form.action;

            if (url) {
               form.action = url;
            }
            var e = null;
            try {
                this.form.submit();
            } catch (e) {
            }
            this.form.action = oldUrl;
            if (e) {
                throw e;
            }

            if (button && button != 'undefined') {
                button.disabled = true;
            }
        }
    }.bind(productAddToCartForm); 
```

通过在单击时将按钮设置为“禁用”，Magento 可以防止用户在页面加载缓慢时多次单击该按钮。如果您想解决此问题，您需要删除以下行：

```
 if (button && button != 'undefined') {
        button.disabled = true;
    } 
```

但你也必须忍受另一个问题。

# php - 如何屏蔽 URL 地址？

> ID：10217518
> 
> 赞同：0
> 
> 时间：2012-04-18T20:34:08.530
> 
> 标签：php, javascript, .htaccess

认为我有`domain.com`重定向到`some.otherdomain.com`. 我不想`some.otherdomain.com`向我的网站访问者显示确切的网址。我需要屏蔽我的 URL，使它看起来像`domain.com` 任何可能的方式？.htaccess / javascript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:12:42.687

假设`domain.com`和`some.otherdomain.com`在两个物理上不同的服务器上，并且您无法更改其中任何一个的 DNS 信息，您需要在`domain.com`. 你可以用`mod_proxy`这个。文档位于：

[http://httpd.apache.org/docs/2.0/mod/mod_proxy.html](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)

以下信息是您需要注意的：

> 相比之下，反向代理在客户端看来就像一个普通的 Web 服务器。无需在客户端上进行特殊配置。客户端对反向代理的名称空间中的内容进行普通请求。然后反向代理决定将这些请求发送到哪里，并返回内容，就好像它本身就是源一样。

文档中有一个保留代理的示例，但您需要这样的东西：

```
ProxyRequests Off

<Proxy *>
  Order deny,allow
  Allow from all
</Proxy>

ProxyPass / http://some.otherdomain.com/
ProxyPassReverse / http://some.otherdomain.com/ 
```

基本上，域中的任何请求都将被代理到`some.otherdomain.com`- 本地 Web 服务器将转发请求，缓冲来自 的数据`otherdomain.com`，然后将相同的数据写回，就好像它是本地数据一样。希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:36:52.057

隐藏域的最佳方法是使用反向代理（apache、nginx、...）并为其提供重写规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:31:50.793

在 domain.com 的 Apache 网络服务器上，您必须启用：

1.  mod_proxy
2.  mod_rewrite
3.  .htaccess

完成这些要求后，将此代码放入您的 .htaccess 中的 DOCUMENT_ROOT 下`domain.com`：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
RewriteRule ^ http://some.otherdomain.com%{REQUEST_URI} [L,P] 
```

这里的重要标志是`P`(Proxy)，它基本上会`domain.com`代理所有请求`some.otherdomain.com`而不在浏览器中显示它。有关此标志的更多文档，请参见此处：[http ://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T20:37:49.053

我一直认为最好的方法是通过服务器配置（Apache 或任何使用的）中的 mod_rewrite （或类似的）来做这些事情

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T20:38:55.530

更简单的方法是在 domain.com 上设置一个带有 iframe 的页面，并将 iframe 的源设置为 some.otherdomain.com。但是，用户将能够查看页面的源代码并看到您的 iframe 指向 some.otherdomain.com。

```
<iframe src="http://some.otherdomain.com/">... 
```

另一种选择是在您的 .htaccess 中使用 mod_rewrite，如[该线程](https://stackoverflow.com/questions/1962605/url-masking-with-dns-and-or-mod-rewrite)所示。

# jquery - 着色jquery模态

> ID：10217519
> 
> 赞同：0
> 
> 时间：2012-04-18T20:34:15.707
> 
> 标签：jquery, html

我有一个 jquery modal 的标准代码（灰色）。如何制作一个从灰色到蓝色的彩色工具箱？这个脚本可以用于许多对话...例如#dialog1=blue 和#dialog2=green 这是我的标准代码。

```
<script>
// increase the default animation speed to exaggerate the effect
$.fx.speeds._default = 1000;
$(function() {
    $( "#dialog1" ).dialog({
        autoOpen: false,
        show: "blind",
        hide: "explode"
    });

    $( "#opener1" ).click(function() {
        $( "#dialog1" ).dialog( "open" );
        return false;
    });
});
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:35:50.190

使用 jQuerys 主题生成器 ( [http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/) )

您可以设计您的整个配色方案，然后从站点保存 css，它将为所有 jQuery ui 着色，而不仅仅是对话框。

干杯。

- 更新 -

设计好对话框的外观后，打开 css 文件并复制以下行：

您需要为每个类创建自定义类名称，然后在创建时从对话框中删除默认类，然后将新类添加到其中。

```
.ui-dialog .ui-dialog-content { position: relative; border: 0; padding: .5em 1em; background: none; overflow: auto; zoom: 1; }
.ui-dialog .ui-dialog-buttonpane { text-align: left; border-width: 1px 0 0 0; background-image: none; margin: .5em 0 0 0; padding: .3em 1em .5em .4em; } 
```

# iphone - 在 KTPhotoScrollViewController 和 KTThumbsViewController 之间移动时，iPhone 状态栏在使用 KTPhotoBrowser 库的应用程序中消失

> ID：10217525
> 
> 赞同：1
> 
> 时间：2012-04-18T20:34:51.463
> 
> 标签：iphone, objective-c, ios, uistatusbar

我正在使用 KTPhotoBrowser 库在我的 iPhone 应用程序中创建照片库。图库由一个缩略图视图 (KTThumbsViewController) 和一个滚动视图 (KTPhotoScrollViewController) 组成，它显示完整尺寸的照片，就像在官方 iPhone 照片应用程序中一样。

我已经设法让一切工作正常，但有时当从照片滚动视图导航回缩略图视图时，状态栏会消失，在状态栏曾经所在的屏幕顶部留下一个 20 像素的黑色间隙。

这对整个导航堆栈产生了严重的影响，因为视图尺寸从 (320,416) 变为 (320,436)，导致所有内容都向上移动 20 像素。

有没有其他人遇到过这个问题，如果有，你能解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T10:37:51.347

我设法提出了一个临时解决方案，可以防止应用程序崩溃。

在 KTPhotoScrollViewController.m 中，我在 toggleChrome 方法中注释掉了以下代码：

```
 /*  if ([[UIApplication sharedApplication]  respondsToSelector:@selector(setStatusBarHidden:withAnimation:)]) {

    [[UIApplication sharedApplication] setStatusBarHidden:hide withAnimation:NO];

 } else {  // Deprecated in iOS 3.2+.

  id sharedApp = [UIApplication sharedApplication];  // Get around deprecation warnings.
 [sharedApp setStatusBarHidden:hide animated:NO];

 } */ 
```

这意味着状态栏永远不会隐藏，因此在视图之间转换时状态栏消失的问题永远不会发生。

# php - 只能导航到一个页面，然后我收到 404

> ID：10217527
> 
> 赞同：1
> 
> 时间：2012-04-18T20:34:55.740
> 
> 标签：php, .htaccess, codeigniter, url

早些时候我有人帮我解决了一个`.htaccess`问题，以便我可以`index.php`从网址中删除。然而，虽然这似乎有效，但我不确定它是否完全有效，除非这是我做错的事情（可能 - PHP/CI/WAMP 的新手，本周五才开始写）。

我在 Windows 7 机器上使用 CI 和 WAMP。这是我的`.htaccess`：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|css)
RewriteRule ^(.*)$ index.php/$1 [NC,L] 
```

我去查看该网站的基本网址是：

```
localhost/forum/ 
```

我在顶部有一些菜单项。其中之一是`Forum`，当它写出来时，链接是：

```
<a href="<?php echo base_url(); ?> 
```

我的配置文件中没有设置 base_url。但是当我将鼠标悬停在链接上时，它显示：

```
localhost/Forum/ 
```

当我检查 Chrome 中的元素时，它显示：

```
<a href="http://localhost/Forum/"> 
```

我有一个 div，它是一个指向子论坛的链接。在html中，它是这样写的：

```
<a href='$record->name/'> 
```

当我将鼠标悬停在 div 上时，它显示它将转到：

```
localhost/Forum/Site/ 
```

当我检查元素时，它说它将：

```
<a href="Site/"> 
```

现在，在那里，我可以启动 Mozilla 或 Chrome，单击站点，它会转到我想要的位置。然后我可以点击论坛，它会返回。但是，如果我再次单击站点，它将转到 404 页面。然后，如果我关闭浏览器并重新打开它，它会再次工作一次，然后做同样的事情。我不知道这里发生了什么。当我输入这个时，我将我的基本 url 设置为`http://localhost/Forum`，甚至没有做任何事情。

# 更新

我编辑了我的 base_url 并解决了这个问题。最后我忘记了a `/`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:33:35.470

改为使用`site_url()`。`base_url()`主要用于链接到 Javascript 和 CSS 等媒体。

IE

```
<a href="<?= site_url('forum'); ?>">Forum</a> 
```

或者

```
<a href="<?= site_url('forum/' . $Category->CategoryID . '/' . url_title($Category->Title)); ?>"><?= $Category->Title; ?></a> 
```

有关详细信息，请参阅[http://codeigniter.com/user_guide/helpers/url_helper.html](http://codeigniter.com/user_guide/helpers/url_helper.html)。

高温高压

# cocoa - 在 Cocoa 中设置权限

> ID：10217530
> 
> 赞同：0
> 
> 时间：2012-04-18T20:35:07.130
> 
> 标签：cocoa, permissions, int, posix

我想使用以下代码使用 Cocoa 设置文件的权限：

```
permissions=0644;
attr = [NSDictionary dictionaryWithObject:[NSNumber numberWithInt: permissions] forKey:NSFilePosixPermissions];
[fileManager setAttributes:attr ofItemAtPath:filename error:nil]; 
```

这工作正常。但是，我的“权限”变量是我计算的整数，因此是 644 而不是 0644，在这种情况下会失败。如何将整数 644 转换为 0644 ？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:06:23.297

为什么要这样计算？0644 是一个八进制数。它相当于十进制的 420（以 10 为底）。如果您的意思是 0644 又名 420 时计算了 644，那么您的计算是不正确的。

如果要计算权限掩码，最好使用 中定义的掩码`<sys/stat.h>`，例如`S_IRUSR`和`S_IXOTH`。

# regex - 清除正则表达式匹配变量的最佳方法是什么？

> ID：10217531
> 
> 赞同：6
> 
> 时间：2012-04-18T20:35:09.997
> 
> 标签：regex, perl, backreference

清除/重置所有正则表达式匹配变量的最佳方法是什么？

*   示例如何`$1`在正则表达式操作之间不重置并使用最近的匹配：

    ```
    $_="this is the man that made the new year rumble"; 
    / (is) /; 
    / (isnt) /; 
    say $1;          # outputs "is" 
    ```

*   示例在使用循环时这可能会出现问题：

    ```
    foreach (...){
       /($some_value)/;
       &doSomething($1) if $1;
    } 
    ```

* * *

***更新：**我认为我不需要这样做，但 Example-2 只是一个示例。这个问题是关于重置匹配变量，而不是实现它们的最佳方法。*

*无论如何，最初我的编码风格更符合明确和使用 if 块。现在回到这个（Example2）之后，阅读多行代码会更加简洁，我会发现这种语法更快地理解。*

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T20:43:08.947

您应该使用匹配的返回值，而不是组变量的状态。

```
foreach (...) {
    doSomething($1) if /($some_value)/;
} 
```

$1 等仅在匹配成功时才保证反映最近的匹配。除了在一场成功的比赛之后，你不应该看他们。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-18T21:54:44.357

成功匹配会重置正则表达式捕获*。要重置正则表达式捕获，可以使用保证匹配的简单匹配操作。

```
"a" =~ /a/;  # Reset captures to undef. 
```

是的，它看起来很奇怪，但你要求做一些奇怪的事情。

如果你*修复*了你的代码，你就不需要看起来很奇怪的*解决方法*。修复您的代码甚至会发现一个错误！

修复：

```
$_ = "this is the man that made the new year rumble"; 
if (/ (is) / || / (isnt) /) {
   say $1; 
} else{ 
   ...  # You're currently printing something random.
} 
```

和

```
for (...) {
   if (/($some_pattern)/) {
      do_something($1);
   }
} 
```

* * *

* — Backrefs 是匹配先前捕获的文本的正则表达式模式。例如`\1`，`\k<foo>`。您实际上是在谈论“正则表达式捕获缓冲区”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-18T20:44:21.613

您应该测试匹配是否成功。例如：

```
foreach (...){
   /($some_value)/ or next;
   doSomething($1) if $1;
}

foreach (...){
   doSomething($1) if /($some_value)/ and $1;
}

foreach (...){
   if (/($some_value)/) {
      doSomething($1) if $1;
   }
} 
```

根据是什么`$some_value`，以及您希望如何处理匹配空字符串和/或 0，您可能需要也可能根本不需要测试`$1`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-17T18:05:37.940

为了补充现有的有用答案（以及在布尔上下文中正常测试匹配操作的结果并仅在测试成功时才采取行动的明智建议）：

根据您的情况，您可以以不同的方式解决问题：

^(免责声明：我不是经验丰富的 Perl 程序员；如果这种方法有问题，请告诉我。)

**将匹配操作包含在`do { ... }`块中，将所有与正则表达式相关的特殊变量（`$&`, `$1`, ...）都包含在该块**中。

因此，**您可以使用 a`do { ... }`来防止这些特殊变量首先被设置**（尽管来自块外先前正则表达式操作的变量显然仍然有效）；例如：

```
$_="this is the man that made the new year rumble"; 

# Match in current scope; -> $&, $1, ... *are* set.
/ (is) /;

# Match inside a `do` block; the *new* $&, $1, ... values
# are set only *inside* the block; 
# `&& $1` passes out the block's version of `$1`.
$do1 = do { / (made) / && $1 };

print "\$1 == '$1'; \$do1 == '$do1'\n";  # -> $1 == 'is'; $do1 == 'made' 
```

*   这种方法的优点是*没有*设置或更改当前作用域的特殊正则表达式变量；相比之下，接受的答案会改变变量，例如`$&`和`$'`。
*   缺点是必须显式传递感兴趣的变量；但是，默认情况下，您确实会得到匹配操作的结果，如果您只对捕获缓冲区的内容感兴趣，那就足够了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T20:55:33.370

你应该这样做：

```
foreach (...) { 
   someFnc($1) if /.../; 
} 
```

但是，如果您想坚持自己的风格，请将此作为一个想法：

```
$_ = "this is the man that made the new year rumble";  

$m = /(is)/   ? $1 : undef;
$m = /(isnt)/ ? $1 : undef;

print $m, "\n" if defined $m; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T21:53:07.920

将捕获分配给列表的行为更接近您想要的声音。

```
for ("match", "fail") {
    my ($fake_1) = /(m.+)/;
    doSomething($fake_1) if $fake_1;
} 
```

# javascript - 如何将变量传递给 setTimeout 函数？

> ID：10217536
> 
> 赞同：6
> 
> 时间：2012-04-18T20:35:29.060
> 
> 标签：javascript

我正在尝试设置五个交错的函数调用（相隔一秒）。那部分工作正常。不起作用的是，我不能将值 0 到 4 传递给回调函数。它每次只通过'5'。我似乎无法弄清楚为什么以及如何解决它。

代码：

```
​function callback(num)
{
    console.log(num);
}

for (var i = 0, loadDelay = 1000; i < 5; ++ i, loadDelay += 1000)
    setTimeout(function() { callback(i); }, loadDelay); 
```

结果：

```
5
5
5
5
5 
```

期望的结果：

```
0
1
2
3
4 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T20:52:32.510

那是因为你创建了一个闭包。因此，您传递的函数`setTimeout`共享相同的`i`实例。在支持标准（不是 IE）的浏览器中，您可以：

```
setTimeout(callback, loadDelay, i); 
```

See: [http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#timers](http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#timers)

Otherwise you have to actually `bind` the argument to the function:

```
setTimeout(callback.bind(undefined, i), loadDelay); 
```

See: [https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)

If the browser doesn't support ES5 `bind` method, you can either implement the shim present in the link above, or manually doing something like:

```
setTimeout(function(index){
    return function() { callback(index) }
}(i), loadDelay); 
```

But I would say it's more readable using `bind` and it's worthy to implement the shim. You can actually use this: [https://github.com/kriskowal/es5-shim](https://github.com/kriskowal/es5-shim)

To add es5 capabilities (where is possible) in the browser that don't support es5 natively.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T20:40:46.413

使用 lambda / 函数表达式来捕获当前值。例如

```
for (var i = 0, loadDelay = 1000; i < 5; ++ i, loadDelay += 1000) {
  var doCall = function (j) {
    setTimeout(function() { callback(j); }, loadDelay);
  }
  doCall(i);
} 
```

这里的问题是`i`循环的所有迭代只有 1 个值。javascript 中的变量具有函数范围，即使您可以在块内声明它们。这意味着`i`对于整个功能都是有效的。

为了说明问题，请考虑以下代码的执行与您的示例完全相同

```
var i;
for (i = 0, loadDelay = 1000; i < 5; ++ i, loadDelay += 1000) {
  ...
} 
```

我的解决方案有效，因为它引入了一个新函数，因此为`j`. 这将保存函数中的当前值以`i`在`setTimeout`回调中使用

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T20:42:20.687

`i`由于变量作用域，您需要一个闭包才能通过。查看[这篇文章](https://developer.mozilla.org/en/JavaScript/Guide/Closures)，以及这篇文章，[以](https://developer.mozilla.org/en/A_re-introduction_to_JavaScript#Closures)获得一些关于闭包的好信息。

**[现场演示](http://jsfiddle.net/loktar/tm43B/)**

```
function callback(num)
{
    console.log(num);
}

for (var i = 0, loadDelay = 1000; i < 5; ++ i, loadDelay += 1000)
    setTimeout((function(num){return function(){
           callback(num);
        }
    })(i), loadDelay);​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T20:41:52.987

setTimeout 会产生一些奇怪的范围问题。[Frame.js](https://github.com/bishopZ/Frame.js)旨在解决一些此类混乱，这也有效[更新]：

```
function callback(num) {
    console.log(num);
}

for (var i = 0, loadDelay = 1000; i < 5; ++ i, loadDelay += 1000) {
    Frame(function(next, i){
        setTimeout(function() { callback(i); }, loadDelay);
        next();
    }, i);
}
Frame.init(); 
```

# jquery - jQuery 动画在 $ (this) 上不起作用

> ID：10217539
> 
> 赞同：-1
> 
> 时间：2012-04-18T20:35:45.457
> 
> 标签：jquery

我正在尝试使用此功能为一堆`<div>`'设置动画：`.animate`

```
slideOut: function(container){
    var count = container.siblings().size() - 1;
    container.siblings().each(function(index, item){
        $(item).delay( index * 50 ).animate({ "left" : "-1000px" }, "fast", function(){
            if (index == count){
                container.delay(container.parent().parent().children().size() > 10 ? 10 * 50 + 300 : container.parent().parent().children().size() * 50 + 300  ).animate({ "left":"-1000px" }, "fast", function(){
                    container.parent().parent().clone(true, true).appendTo(metro.tiles);
                    metro.overlay(container.parent().parent().parent());
                }); 
            }       
        });
    });

}, 
```

我正在使用以下函数将它们带回 DOM：

```
slideInTiles: function(){
    $("#contentWrapper").empty();
    $("#contentWrapper").append(metro.tiles.children());

    $("#contentWrapper li").animate({"left": "0px"}, "fast");
    $("#contentWrapper li.activeTile").css({"left": "0px"}, "fast");
}, 
```

然而，问题是`<li>`我点击的并没有动画回到混音中。我必须用`.css`它把它带回来。导致此问题的代码中的错误在哪里？此外，由于我`li`通过使用`.css`它来将活动带回来，因此也不再动画出视图。我很确定这与`.clone`方法有关。但是怎么做，我想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:54:07.710

如果没有适当的示例或一些更相关的代码，很难说，但我想说你的问题可能在这里：

```
container.delay(container.parent().parent().children().size() > 10 ? 10 * 50 + 300 : container.parent().parent().children().size() * 50 + 300).animate({ 
```

`delay()`仅适用于队列，并且您在开始任何队列之前使用它。然后，必须有一个比`container.parent().parent().children().size()`...更好的选择器。
此外，您可能希望使用`length`而不是`size()`. `size()`只是返回`length`. 最后，我会缓存所有这些选择器，以便您的应用程序可以更快地执行，即。`$("#contentWrapper")`可以缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:26:23.057

首先，我建议您退后一步，从您所在的位置简化并逐步进行，以便您知道问题何时开始。看看这个小提琴，它显示问题可能源于使用像素，你应该使用百分比来代替：http: [//jsfiddle.net/UVPYW/1/](http://jsfiddle.net/UVPYW/1/)除此之外，请确保您注意@elclanrs 关于延迟的回答，但还要确保您没有删除或克隆您想要从屏幕上移除的原始元素。看起来在您的代码中，您实际上删除了 #contentWrapper 中的元素，该元素最初是动画的，当您尝试重新设置动画时会导致问题。如果要在屏幕上为新元素设置动画，请确保在 css 中将其设置为首先具有负值。所以将它设置为最初的左侧 -1000 并且当您制作动画时，请确保它转到屏幕上可见的左侧值

# html - 如何直接链接到paypal支付页面？

> ID：10217543
> 
> 赞同：0
> 
> 时间：2012-04-18T20:35:49.340
> 
> 标签：html, url, redirect, paypal

伙计们。所以这是我第一次使用贝宝，我用它作为我网站会员的付款方式。基本上在我的 php 中，我测试他们提交的表单是否有效，并且只有当它是有效的时才会将您重定向到 paypal 链接。问题是链接过期了一定的时间。我通过使用他们的股票立即支付按钮然后复制网址获得了此链接，但就像我之前所说的那样，该网址最终会超时。我在用：

```
if (($desiredusername == "") && ($desiredpassword == "")) { 
    echo ""; 
} elseif (($desiredpassword == $retypepassword) && (mysql_num_rows($results2) != 1) &&
         ($usernamelength <= 15) && ($usernamelength >= 5) && ($passwordlength <= 15) && 
         ($passwordlength >= 5) && ($usernamecontainsspaces == 0) && ($passwordcontainsspaces == 0)) { 
    echo '<meta http-equiv="REFRESH" content="0;url=https://www.paypal.com/us/cgi-bin/webscr?cmd=_flow&SESSION=pdbo_yKTkZJZ2i2R9PE7JwUytkmMuDavwDhpNouhJbMSBoUrb4w_ogm95_y&dispatch=50a222a57771920b6a3d7b606239e4d529b525e0b7e69bf0224adecfb0124e9b61f737ba21b081989d37bd8af37ad9708d2162cdad4a70df">'; 
} else {  
    echo ""; 
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T12:26:20.447

I would have begun by reading the integration guide that PayPal provides:

[https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_WebsitePaymentsStandard_IntegrationGuide.pdf](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_WebsitePaymentsStandard_IntegrationGuide.pdf)

Chapter one is actually titled: "Single-Item Payments – Buy Now Buttons"

According to this chapter, you can log in to your account and click "Create PayPal payment button" and it spits out the code for you.

# javascript - JSON 对象图形用户界面

> ID：10217555
> 
> 赞同：7
> 
> 时间：2012-04-18T20:36:33.023
> 
> 标签：javascript, json, user-interface

我想为我的用户提供一个编辑 JSON 对象的界面。

例如，我有一个使用以下选项调用 Google 图表的 JavaScript：

```
var options={
    chartType: "Pie",
    title:"Chart title",
    is3D:false,
    width:500,
    height:300,
}; 
```

理想情况下，我的用户应该能够自己修改选项，而无需查看代码。他们将看到一个从对象自动构建的 UI，其中：

*   chartType 是一个选择 (Pie, Line, Bar)
*   标题是文本输入
*   is3D 是一个复选框
*   等等

有这方面的图书馆吗？如果没有，有什么建议可以开始吗？

我当然可以手动构建表单，但我的想法是有一个适用于任何对象的通用解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T15:02:13.990

我发现这个链接带有描述 JSON 的约定：http: [//www.json-schema.org/](http://www.json-schema.org/)

搜索“JSON 模式”让我找到了许多解决方案，尤其是这篇文章：

[基于 GUI 或基于 Web 的 JSON 编辑器，类似于属性浏览器](https://stackoverflow.com/questions/998832/web-based-json-editor-that-works-like-property-explorer-with-ajaxy-input-form)

它始于两年前，但显然有据可查并保持最新。

另外，2012 年 4 月在 ibm 网站上的帖子：

[http://www.ibm.com/developerworks/library/wa-jsonschema/index.html?cmp=dw&cpb=dwwdv&ct=dwnew&cr=dwnen&ccy=zz&csr=040512](http://www.ibm.com/developerworks/library/wa-jsonschema/index.html?cmp=dw&cpb=dwwdv&ct=dwnew&cr=dwnen&ccy=zz&csr=040512)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T21:55:22.890

**问题**

如何提供一种用户友好的方式来构建任意 JSON 结构，其中：

*   用户界面直观、灵活，无需开发人员技术水平即可使用
*   用户界面可以从 JSON 的结构中推断出来
*   对用户界面的修改需要很少或不需要开发人员干预
*   对底层 JSON 结构的修改可以自动触发对相应用户界面的修改

**解决方案**

如果这是问题的基本前提，那么这种方法似乎确实可以使用“MVVM”命名法下的各种方法中的任何一种（这显然是“MVC”模因的变体）。

**例子**

[http://knockoutjs.com/examples/cartEditor.html](http://knockoutjs.com/examples/cartEditor.html) [http://en.wikipedia.org/wiki/Model_View_ViewModel#Open_source_MVVM_frameworks](http://en.wikipedia.org/wiki/Model_View_ViewModel#Open_source_MVVM_frameworks)

**也可以看看**

[基于 GUI 或基于 Web 的 JSON 编辑器，类似于属性浏览器](https://stackoverflow.com/questions/998832/gui-based-or-web-based-json-editor-that-works-like-property-explorer)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:42:12.933

编写一个 web 表单来检测服务的参数。获得参数后，根据可用参数生成表单。提交您的表单并获取 JSON 结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T20:50:15.747

不，您需要自己构建表单。HTML 表单只是描述（请求的）属性要求的一种方式，它们的序列化只会返回所需的对象。在您的示例中，它将是

```
<select name="chartType"><option value="Pie"/><option value="Line" />...</select>
<input type="text" name="title" />
<input type="checkbox" name="is3D" />
<input type="number" name="width" /> 
```

等等。表单还允许您描述模式、最小值/最大值、默认值以及此类库可以处理的所有内容。你可能会发现一个库，它变成了一个简单的

```
{
    chartType: ["Pie", "Line", "Bar"],
    title:"string",
    is3D:"boolean",
    width:"number"
} 
```

进入上面的 html 并提供一个跨浏览器序列化功能，但是当它变得更复杂时（例如预选“行”，有一个默认标题等），你将回到 html（或它的 js 表示）。

# javascript - What does a Node.js web service look like?

> ID：10217556
> 
> 赞同：7
> 
> 时间：2012-04-18T20:36:37.983
> 
> 标签：javascript, web-services, node.js

I am taking a look at Node.js and thinking about using it for building an API. From what I can tell, ExpressJS would be the web framework and is not what I'd be looking for to solve this.

So what would a web service look like? Would it simply be creating a server, talking to mongo and returning results? Also, what does routing look like? (I'd obviously want to 'design' the routes).

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T15:32:19.843

If Express would be your web framework, look at the [express-resource](https://github.com/visionmedia/express-resource) (Github) middleware for routing an API. You define resources and it'll wire up REST-style routing for you with very little boilerplate.

```
app.resource('horses', require('./routes/horses'), { format: json }) 
```

Given the above, express-resource will hook up all the REST-style routes to actions you supply, returning JSON by default. In `routes/horses.js`, you export actions for that resource, along the lines of:

```
exports.index = function index (req, res) {
  // GET http://yourdomain.com/horses
  res.send( MyHorseModel.getAll() )
}

exports.show = function show (req, res) {
  // GET http://yourdomain.com/horses/seabiscuit
  res.send( MyHorseModel.get(req.params.horse) )
}

exports.create = function create (req, res) {
  // PUT http://yourdomain.com/horses
  if (app.user.canWrite) {
    MyHorseModel.put(req.body, function (ok) { res.send(ok) })
  }
}

// ... etc 
```

You can respond with different representations:

```
exports.show = {
  json: function (req, res) { 
    // GET http://yourdomain/horses/seabiscuit.json
  }
, xml: function (req, res) {
    // GET http://yourdomain/horses/seabiscuit.xml
  }
} 
```

Middlewares like [express-resource](https://github.com/visionmedia/express-resource) can make life with Node and Express much easier, take a look through the examples on github to see if it'll do what you need.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:05:41.500

Here is a stub that looks up a horse name from a Postgres database and returns the result as JSON. Clients would access would access the API by going to address such as [http://yourdomain.com/api/horse/seabiscuit](http://yourdomain.com/api/horse/seabiscuit)

```
app.get('/api/horse/:name', function(req, res){

    pg.connect(conString, function(err, client) {

        var horse = req.params.name;
        var sql = "...";

        client.query(sql, function(err, result) {
            if (err) {
                ...
            }

            for (var i=0; i<result.rows.length; i++) {
                // Customize data as needed
            }
            return res.send(JSON.stringify(result.rows));
        });
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:43:10.460

Node is pretty low level. It's like C in JavaScript's clothing. Since it's comparable to C, there's pretty much *a lot* you can do with Node. Creating web servers is just one of them. You can create live chat servers using sockets, blogs, streaming etc. The possibilities are infinite. You are limited only by your imagination.

Routing is just a task where you take in commands (commonly via URL or headers) and do tasks based on those commands passed.

But even I have not yet scathed the surface of node. It's API is huge and getting bigger. Better try using some basic library like Express or Connect first since they pretty much abstract the basic requirement of building the server from code.

# c# - Nhibernate QueryOver - 为多对多关系执行 Has All

> ID：10217558
> 
> 赞同：3
> 
> 时间：2012-04-18T20:36:42.413
> 
> 标签：c#, nhibernate, many-to-many, queryover

为了更容易地解释我的问题，我将创建以下虚构示例，说明一个非常基本的多对多关系。一个**Car**可以有多个**Parts**，一个**Part**可以属于多个**Cars**。

**数据库架构：**

```
CAR_TABLE
---------
CarId
ModelName

CAR_PARTS_TABLE
---------------
CarId
PartId

PARTS_TABLE
-----------
PartId
PartName 
```

**课程：**

```
public class Car 
{
  public int CarId {get;set;}
  public string Name {get;set;}
  public IEnumerable<Part> Parts {get;set;}
}

public class Part 
{
  public int PartId {get;set;}
  public string Name {get;set}
} 
```

使用这个非常简单的模型，我想从我正在搜索的零件列表中获取所有分配给它们的零件的汽车。

所以说我有一个 PartId 数组：

```
var partIds = new [] { 1, 3, 10}; 
```

我想在数据库调用方面模仿以下 c# 代码：

```
var allCars = /* code to retrieve all cars */

var results = new List<Car>();

foreach (var car in allCars) 
{
  var containsAllParts = true;

  foreach (var carPart in car.Parts)
  {
    if (false == partIds.Contains(carPart.PartId))
    {
      containsAllParts = false;
      break;
    }
  }

  if (containsAllParts)
  {
    results.Add(car);
  }
}

return results; 
```

需要明确的是：我想获取具有从 partIds 数组中指定的所有零件的汽车。

我有以下查询，这确实是低效的，因为它为 partIds 数组中的每个 id 创建一个子查询，然后对它们的每个结果进行 IsIn 查询。我迫切希望找到一种更有效的方式来执行此查询。

```
Car carAlias = null;
Part partAlias = null;

var searchCriteria = session.QueryOver<Car>(() => carAlias);

foreach (var partId in partIds)
{
  var carsWithPartCriteria = QueryOver.Of<Car>(() => carAlias)
    .JoinAlias(() => carAlias.Parts, () => partAlias)
    .Where(() => partAlias.PartId == partId)
    .Select(Projections.Distinct(Projections.Id()));

  searchCriteria = searchCriteria
    .And(Subqueries.WhereProperty(() => carAlias.Id).In(carsWithPartCriteria));
}

var results = searchCriteria.List<Car>(); 
```

有没有一种体面的方式来使用 NHibernate 执行这种查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T22:41:19.930

这应该正是你想要的......

```
Part part =  null;
Car car = null;
var qoParts = QueryOver.Of<Part>(() => part)
                .WhereRestrictionOn(x => x.PartId).IsIn(partIds)
                .JoinQueryOver(x => x.Cars, () => car)
                .Where(Restrictions.Eq(Projections.Count(() => car.CarId), partIds.Length))
                .Select(Projections.Group(() => car.CarId)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T01:41:17.183

```
Part partAlias=null;
Session.QueryOver<Car>().JoinQueryOver(x=>x.Parts,()=>partAlias)
.WhereRestrictionOn(()=>partAlias.Id).IsIn(partIds)  //partIds should be implement an ICollection
.List<Car>(); 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T20:14:16.363

[此答案](https://stackoverflow.com/a/953461/40822)的修改版本

```
var cars = session.CreateQuery("SELECT c.id FROM Car c JOIN c.Parts p WHERE p.PartId IN(:parts) GROUP BY c HAVING COUNT(DISTINCT p) = :partsCount")
        .SetParameterList("parts", partIds)
        .SetInt32("partsCount", partIds.Count)
        .List(); 
```

AFAIK 该`having`子句仅在 HQL 中可用。如果您想要更多列，您可以修改 select/group by 列表。另一种可能的方法是生成一个内部连接到每个特定部件 ID 的 HQL 查询。我认为 ICritiria 也不可能做到这一点，因为它只允许您加入一个属性一次。

# oracle - 无法在 Oracle-DB 中创建指向远程数据库的数据库链接

> ID：10217564
> 
> 赞同：3
> 
> 时间：2012-04-18T20:37:08.893
> 
> 标签：oracle, database-connection, database-link, heterogeneous-services

我们公司有一个 CRM 系统，它使用**Oracle 11g 数据库**。它由第三方供应商开发。

我们无权访问运行 CRM 系统的服务器。但是，我们有可用的 DBA 登录数据（SYS 用户）。它包括：

*   服务器IP：172.1.2.3
*   端口：1521
*   SID: abc
*   用户：sys
*   密码：*****

**我们可以使用它通过Oracle SQL Developer 3.1**访问数据库（连接 >> 属性）

现在必须将部分数据从 CRM 数据库*复制*到*另一个*Oracle 数据库中，该数据库驻留在另一台服务器上。

据我了解，我需要在我的目标数据库中创建一个数据库链接。我试过这样的事情：

```
CREATE PUBLIC DATABASE LINK xxx CONNECT TO sys IDENTIFIED BY ***** USING 'MYTNSENTRY' 
```

我的*tnsnames.ora*如下：

```
MYTNSENTRY =
 (DESCRIPTION = 
   (ADDRESS_LIST =
     (ADDRESS = (PROTOCOL = TCP)(HOST = 172.1.2.3)(PORT = 1521))
   )
 (CONNECT_DATA =
   (SERVICE_NAME = abc)
 )
) 
```

....我的*listener.ora*看起来像这样：

```
MYLISTENER=
  (DESCRIPTION=
    (ADDRESS_LIST=
      (ADDRESS=(PROTOCOL=tcp)(HOST=172.1.2.3)(PORT=1521))
      ))
SID_LIST_MYLISTENER=
  (SID_LIST=    
    (SID_DESC=
      (SID_NAME=MYTNSENTRY)
      (ORACLE_HOME=C:\somepath) # path to Oracle home of target DB
      (PROGRAM=extproc))) 
```

PROGRAM=extproc 是正确的选择吗？还有其他几个程序可供选择。我什至无法使用**lsnrctl**启动侦听器，因为它无法“验证用户”之类的。具有讽刺意味的是，到*MS SQL 服务器*的侦听器设置和数据库链接工作顺利。

现在，尽管缺少有关 CRM 数据库系统的一些重要信息，但仍然可以在 SQL Developer 中连接到数据库。难道不是也可以在两个 Oracle DB 之间建立连接吗？请帮助我设置和创建数据库链接。

**- - - 编辑： - - - -**

Alex Poole 的提示帮助我让它发挥作用。我用了

```
 show parameters service_names; 
```

获取完整的服务名称。它的格式**为 abc.def**，其中*def*是域。因此，我将域名添加到*tnsnames.ora*中的 TNS 别名：

```
MYTNSENTRY =
 (DESCRIPTION = 
   (ADDRESS_LIST =
     (ADDRESS = (PROTOCOL = TCP)(HOST = 172.1.2.3)(PORT = 1521))
   )
 (CONNECT_DATA =
   (SERVICE_NAME = abc.def)
 )
) 
```

可以在目标数据库服务器的命令提示符下使用**tnsping MYTNSENTRY测试连接。**tnsnames.ora 是本地的。*但是，我删除了对“本地” listener.ora*的所有更改，因为该监听器确实驻留在 CRM 服务器上。

SQL 命令几乎没有变化，但现在连接正常：

```
CREATE PUBLIC DATABASE LINK xxx CONNECT TO some_user IDENTIFIED BY ***** USING 'MYTNSENTRY' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:14:07.640

您已经说过`SID`is `abc`，但是在您的部分中`tnsnames.ora`有the 。它们并不总是相同的 - 请参阅[此问题](https://stackoverflow.com/q/43866)或此[Ask Tom 条目](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1508737000346067364)。您实际上并没有说出您遇到了什么错误，但只是将其更改为可能会有所作为。`SERVICE_NAME``CONNECT_DATA``SID =`

，`listener.ora`实际上是侦听器，位于托管 CRM 数据库的服务器上，而不是托管您的“目标”数据库的服务器上。您可以从显然已经配置好的 SQL Developer 进行连接。`tnsnames.ora`确实需要是本地的。

但是，如果您确实知道`service_name`CRM 数据库，您可以跳过它并使用[EZCONNECT](http://docs.oracle.com/cd/E11882_01/network.112/e10836/naming.htm#i498306)语法来定义链接中的所有内容：

```
CREATE PUBLIC DATABASE LINK xxx
CONNECT TO non-sys IDENTIFIED BY *****
USING '//172.1.2.3:1521/service_name'; 
```

检查您的 SQL Developer 配置，看看它是否已经在使用服务名称，而不是 SID，如果没有，您需要发现它。如果您有权访问 CRM 服务器，则可以使用它`lsnrctl`来查找已注册的服务名称，但您似乎不需要连接到数据库并运行`show parameters service_names`或`select value from v$parameter where name = 'service_names';`.

创建公共链接需要比私人链接更多的权限，而公共链接的安全性可能较低，因为它会将您的 CRM 数据库暴露给目标链接上的任何人。因此，我只会在真正需要时将其公开，如果您能够创建一个，则无论哪种方式都可以连接到只读帐户。

另请注意，如果您的目标数据库已`global_names`设置为`true`数据库链接名称必须与远程服务名称匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:45:32.223

除非必要，否则您不仅不应以 SYS 身份连接，而且不能通过数据库链接以 SYS 身份连接。

# javascript - 在 expressJs 静态 HTML 中访问 nodejs 函数

> ID：10217569
> 
> 赞同：0
> 
> 时间：2012-04-18T20:37:27.440
> 
> 标签：javascript, node.js, express

我是 Javascript 和 Nodejs 新手，我不确定如何最好地组织事情。我正在通过使用 Nodejs 和 V8 转换来包装 C++ API 来为 C++ 应用程序编写 Web 界面。我的问题是，有没有什么方法可以使用 Express 来提供在 nodejs 中引用函数/全局的 HTML？或者我是否必须求助于在 HTML 中有一堆 res.write(html) 类型的调用才能做到这一点？

例如，我想用从 C++ 配置 API 访问的内容预填充表单数据。C++ API 封装在一个 Nodejs 模块中。现在任何需要动态生成的东西（比如预填充的表格）我只是做类似的事情，

```
var novaconfig = require('./NodeAppConfig/build/Release/appconfig');
var AppConfiguration = new Appconfig.AppConfigBinding();

var express=require('express');
var app = express.createServer(express_options);

app.configure(function () {
    app.use(express.methodOverride());
    app.use(express.bodyParser());
    app.use(app.router);
    });

app.get('/configureApplication.html', function(req, res) {
    console.log("[200] " + req.method + " to " + req.url);
    res.writeHead(200, "OK", {'Content-Type': 'text/html'});
    res.write('<HTML>');
    res.write('<HEAD>');
    res.write(' <link rel="stylesheet" type="text/css" href="configstyle.css" media="screen">');
    res.write('</HEAD>');
    res.write('<BODY>');

    res.write('<label>');
    res.write(Interface);
    res.write('</label>');
    res.write('<form method="post" action="/configureNovaSave">');
    res.write('<input type="text" name="interface" value="');
    res.write(AppConfiguration.GetCurrentInterface());
    res.write('" /><br />');

    res.write('<input type="submit" name="submitbutton" id="submitbutton" value="Save Settings" />');
    res.write('</form>');
    res.write("<br/>");
    res.write('</BODY>');
    res.write('</HTML>');

    res.end();
}); 
```

但这显然是一个不好的方法。有没有办法让动态生成的 HTML 在一个独立的文件中，然后仍然在其中访问 AppConfiguration.GetCurrentInterface() ？为这样的事情组织文件的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:39:58.660

我认为您想要的是模板引擎。也许看看 Jade 或 Mustache。然后你只需传入你想要动态的部分，引擎就会为你呈现页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:00:06.540

代码如下所示

```
app.get('/configureApplication.html', function(req, res) {
    var config = AppConfiguration.GetCurrentInterface();
    res.render('configureApplication.jade', {locals: {config: config}});
}); 
```

configureApplication.jade 可以访问变量“config”，如下所示

```
doctype 5
html(lang="en")
  head
    title= config 
```

完整的文档在这里

[http://jade-lang.com/](http://jade-lang.com/)

# javascript - 首次实施和使用 ace

> ID：10217570
> 
> 赞同：3
> 
> 时间：2012-04-18T20:37:31.557
> 
> 标签：javascript, ace-editor

我是第一次在我的网站中实施 ace，我有一些菜鸟问题。我只编程了大约一年，所以请耐心等待。

我已经从[https://github.com/ajaxorg/ace](https://github.com/ajaxorg/ace)下载了代码。我假设（可能是错误的）我需要的代码位于 /lib/ace/ 中，所以我将 ace 文件夹复制到我的开发环境中的 /lib/js/ 中。我按照 github wiki 上的说明导入了 ace.js。

```
 <script type="text/javascript" src="lib/js/ace/ace.js" charset="utf-8"></script> 
```

我也有我的 HTML 代码：

```
<script>
 window.onload = function() {
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/twilight");

        var JavaScriptMode = require("ace/mode/javascript").Mode;
        editor.getSession().setMode(new JavaScriptMode())
    };
</script>
<div id="editor"></div> 
```

CSS：

```
 #editor {  
        width: 800px;
        height: 690px;
    } 
```

Firebug 告诉我 ace 没有在我声明变量“editor”的地方定义，并且还给了我这个输出：

```
missing variable name
const function (require, exports, module) { 
```

那是来自ace.js。所以我错过了让这个基本实现工作的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T22:23:46.660

您下载了需要 require.js 的源代码。

[您应该从https://github.com/ajaxorg/ace-builds](https://github.com/ajaxorg/ace-builds)下载其中一个构建版本， 无需额外要求即可开始使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T09:50:56.743

您必须定位您的编辑器，或者使用“位置：相对；” 或“位置：绝对；” 在你的 CSS 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T00:37:42.623

您是否尝试过删除 window.load 操作？

```
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/twilight");
</script>
<div id="editor"></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-01T16:02:30.473

它在他们的官方网站上描述得很清楚。
只需克隆 [ace-builds github 存储库](https://github.com/ajaxorg/ace-builds)
，然后按照[ace 官方网站](https://ace.c9.io/#nav=embedding)上的说明创建 html 文件。
HTML 文件应该加载这个 js 脚本 /ace-builds/src-noconflict/ace.js

# php - 有人知道 PHP 的简单 json(p) 解析类吗？

> ID：10217581
> 
> 赞同：0
> 
> 时间：2012-04-18T20:38:07.507
> 
> 标签：php, json, oop, class, jsonp

我被困在使用 PHP 5.2 之前的版本（v 5.1.6），因此无法访问像 json_decode() 这样的方便函数

更复杂的是，我也没有服务器权限来安装任何扩展。

简单地包含一个类定义，我可以使用它从一串 json 数据创建对象（甚至是复杂数组），这将是非常好的。

有谁知道对我有用的轻量级和可靠的类定义？

（我真的不想在这里重新发明轮子。）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:41:13.493

您可以直接下载 pear JSON 库并将脚本包含在您的应用程序中。查看此链接： http: [//pear.php.net/package/Services_JSON/download](http://pear.php.net/package/Services_JSON/download)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:46:13.780

您可以在 PEAR 上使用[Services_JSON](http://pear.php.net/package/Services_JSON)，您将像这样使用它：

```
if ( !function_exists('json_decode') ){
    function json_decode($content, $assoc=false){
        include_once('JSON.php');
        if ( $assoc ){
            $json = new Services_JSON(SERVICES_JSON_LOOSE_TYPE);
        } else {
            $json = new Services_JSON;
        }
        return $json->decode($content);
    }
    function json_encode($content){
        include_once('JSON.php');
        $json = new Services_JSON;
        return $json->encode($content);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:49:33.323

查看[Zend_Json](http://framework.zend.com/manual/en/zend.json.basics.html)，看起来还可以，但我不知道所需的最低 php 版本。

# android - SearchInfo 总是显示为空

> ID：10217582
> 
> 赞同：21
> 
> 时间：2012-04-18T20:38:08.677
> 
> 标签：android, android-search, android-searchmanager

我在操作栏中设置搜索视图时遇到问题。

我关注了开发者网站，但它不起作用。我觉得我错过了一些东西。

当我运行我的代码时，它总是输出“无法获取可搜索信息”（MainActivity.setupSearchView()）。

MainActivity.java

```
// package...
// imports...
public class MainActivity extends Activity {
    private static String tag = "Main Activity";
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater mi = getMenuInflater();
        mi.inflate(R.menu.search_view, menu);
        setupSearchView(menu);
        return true;
    }
    private void setupSearchView(Menu menu) {
        SearchManager sm = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
        SearchableInfo si = sm.getSearchableInfo(getComponentName());
        if (si == null) {
            Log.wtf(tag, "failed to get searchable info");
            return;
        }
        SearchView sv = (SearchView) menu.findItem(R.id.menu_search).getActionView();
        sv.setSearchableInfo(si);
        // Do not iconify the widget; expand it by default
        sv.setIconifiedByDefault(false);
    }
} 
```

SearchResultsActivity.java

```
// package...
// imports...
public class SearchResultsActivity extends ListActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        final Intent queryIntent = getIntent();
        doSearchQuery(queryIntent);
    }
    @Override
    public void onNewIntent(final Intent newIntent) {
        super.onNewIntent(newIntent);
        final Intent queryIntent = getIntent();
        doSearchQuery(queryIntent);
    }
} 
```

可搜索的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
    android:hint="@string/search_hint"
    android:label="@string/search_label" >
</searchable> 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="kpaek.examples"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="15" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".search.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".SearchResultsActivity">
            <intent-filter>
                <action android:name="android.intent.action.SEARCH" />
            </intent-filter>
            <meta-data
                android:name="android.app.searchable"
                android:resource="@xml/searchable" />
        </activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-20T15:15:00.053

我发现的关键是 searchable.xml*不能*包含文字字符串，只能包含资源。我在那个上浪费了大约半天的时间，因为它导致 getSearchableInfo 静默失败。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-08-28T12:15:13.693

在我的情况下，使用自定义标签`res/menu/mymenu.xml`对我有用：

```
app:showAsAction="ifRoom|collapseActionView"
app:actionViewClass="android.support.v7.widget.SearchView" 
```

不使用：

```
android:showAsAction="ifRoom|collapseActionView"
android:actionViewClass="android.support.v7.widget.SearchView" 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-05-04T14:47:02.390

我发现意图过滤器和元数据元素必须包含在启动搜索的清单活动元素*中*（MainActivity 具有 SearchView），以便方法 getSearchableInfo(getComponentName()) 返回正确的配置而不是无效的。

```
<activity
    android:name=".MainActivity"
    android:label="@string/app_name">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>

    <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
    </intent-filter>

    <meta-data
        android:name="android.app.searchable"
        android:resource="@xml/searchable" />
</activity> 
```

我想知道是否应该（以及我现在使用的解决方案）将意图和元数据留在结果活动声明中，并将参数更改为 getSearchableInfo() 如下：

```
<activity android:name=".SearchResultsActivity">
    <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
    </intent-filter>

    <meta-data
        android:name="android.app.searchable"
        android:resource="@xml/searchable" />
</activity> 
```

以及 MainActivity 的更改（注意 searchableInfo 的赋值语句）：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_search, menu);
    SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
    SearchView mySearchView = (SearchView) menu.findItem(R.id.action_search).getActionView();
    SearchableInfo searchableInfo = searchManager.getSearchableInfo(new ComponentName(getApplicationContext(), SearchResultsActivity.class));
    mySearchView.setSearchableInfo(searchableInfo);

    return true;
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-03-08T18:09:34.370

这让我死了一天 - 我认为它与 ActionBarSherlock 相关，但不适用。

问题是我试图使样品短路。至少您的一项活动（您正在执行搜索的活动就足够了）必须在清单中包含此意图过滤器：

```
<intent-filter>
  <action android:name="android.intent.action.SEARCH" />
</intent-filter> 
```

如果不是，则`searchManager.getSearchableInfo(getComponentName())`始终返回 null，并且您的配置将被忽略。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-13T16:35:42.183

From the developersite:

> A searchable configuration defines how the SearchView behaves and is defined in a res/xml/searchable.xml file. At a minimum, a searchable configuration must contain an android:label attribute that has the same value as the android:label attribute of the or element in your Android manifest.

As an example, they show:

```
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
        android:label="@string/app_name"
        android:hint="@string/search_hint" /> 
```

app_name is, like in your manifest, the label of the activity. However, in your searchable, the label refers to search_label. Works perhaps if app_name and search_label are equal, but that seems fragile to me.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-18T20:02:43.713

我遇到了这个问题，但上面的建议并没有解决它。相反，它原来是在 SearchResultActivity 中设置类别默认值。例如以下中断：

```
<activity android:name=".SearchResultActivity"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
    <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
            <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
    <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
</activity> 
```

删除**android.intent.category.DEFAULT**解决了这个问题。：

```
<activity android:name=".SearchResultActivity"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
    <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
    </intent-filter>
    <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
</activity> 
```

此外，此问题的先前答案也有错误。MainActivity 应该用**android.app.default_searchable**定义。 **android.app.searchable**仅适用于您的 SearchResultsActivity。

```
<activity
    android:name=".MainActivity"
    android:label="@string/app_name">
    <!-- other stuff-->
    <meta-data android:name="android.app.default_searchable"
            android:value=".SearchResultsActivity" />
</activity> 
```

总之，当 AndroidManifest.xml 不完美时，SearchManager 是一个容易出现静默失败的脆弱组件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-01T14:49:06.547

我在这个上浪费了整整 8 个小时，因为我检查了上述所有解决方案，但我缺少一件事。

在我的 Android 清单中：

```
<meta-data
                android:name="android.app.searchable"
                android:value="@xml/searchable" /> 
```

**应该**是：

```
<meta-data
                android:name="android.app.searchable"
                android:resource="@xml/searchable" /> 
```

对我来说，它默默地失败了。一开始最好的办法就是复制并粘贴示例。只要确保您的所有属性都完全相同。

# php - 如何设置嵌套关联模型

> ID：10217589
> 
> 赞同：1
> 
> 时间：2012-04-18T20:38:58.763
> 
> 标签：php, activerecord, cakephp-2.1, cakephp-model

我试图了解如何使用`CakePHP`和`saveAssociated`方法创建嵌套数据但没有成功，我编写了一个模型结构，其中 a `Character`> `hasMany`>`PropertyGroup`和 a `PropertyGroup`> `hasMany`> `Property`。

如何在添加视图中创建 PropertyGroup 与其属性之间的关系？

```
// Character Model
echo $this->Form->input('name', array ('label' => false, 'value' => 'Character name'));
echo $this->Form->input('description', array ('type' => 'textarea', 'label' => false, 'value' => 'Character description'));
// PropertyGroup Model
echo $this->Form->input('PropertyGroup.0.name', array ('label' => false, 'value' => 'Group name'));
echo $this->Form->input('Property.0.name', array ('label' => false, 'value' => 'Property name'));
echo $this->Form->input('Property.0.value', array ('label' => false, 'value' => 'Property value'));

echo $this->Form->end('Add character'); 
```

如果我想创建多个，我的问题就开始了`PropertyGroups`，所以：

```
PropertyGroup.0.name
    Property.0.name
    Property.0.value
    Property.1.name
    Property.1.value

PropertyGroup.1.name
    Property.0.name
    Property.0.value
    Property.1.name
    Property.1.value 
```

如何将表单设置为兼容多个`PropertyGroups`？

我可以通过 javascript 来喜欢通过 jQuery 克隆我需要的输入并增加 id，但我不确定如何使用`Properties`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:30:32.947

在一个关系之后，您必须给其他属性组一个别名并将它们绑定到模型......

```
$this->Character->bindModel('PropertyGroup2', array('className' => 'PropertyGroup')); 
```

然后将它们引用为 PropertyGroup 和 PropertyGroup2。

如果您在许多情况下需要多个属性组，只需将 PropertyGroup2 绑定到您的 hasMany 数组中，并确保将 classMame 设置为引用 PropertyGroup 类。

# java - 渴望在 Hibernate 中使用 ScrollableResults 获取集合

> ID：10217590
> 
> 赞同：5
> 
> 时间：2012-04-18T20:39:01.407
> 
> 标签：java, hibernate, hql, eager, scrollableresults

我正在尝试使用 Hibernate 从表中检索大约 1 亿行。我有一个包含费用集合的持久实体项目（另一个持久实体）。鉴于我*将*遍历结果并访问每个对象的费用，我想急切地获取费用以避免 n+1 问题。

我还应该提到我想将它加入另一个名为 Provider 的表（一对一映射但没有外键）。我试过：

```
String query = "select new " + Order.class.getName() 
           + "(i, p) from Item i left join fetch i.fees f, Provider p where "
           + "p.factoryId=i.factoryId and p.factoryRef=i.factoryRef";

return session.createQuery(query).scroll(); 
```

我的 Order 类包含一个 Provider 字段和一个 Item 字段。我收到此错误：

> 引起：org.hibernate.QueryException：查询指定连接提取，但提取关联的所有者不存在于选择列表中

我想最终得到一个可滚动的订单列表，其中包含项目（急切收取的费用）和提供者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T10:04:56.037

这段代码给`SelectClause`你带来了麻烦：

```
if ( !fromElementsForLoad.contains( origin ) ) {
                        throw new QueryException(
                                "query specified join fetching, but the owner " +
                                "of the fetched association was not present in the select list " +
                                "[" + fromElement.getDisplayText() + "]"
                        ); 
```

如您所见，当提到 fetch 关键字时，hibernate 会检查您是否要求 fetch 修饰字段父级。`fromElementsForLoad.contains( origin )`

他们可能这样做是为了保护您免于进行多余的连接，这会在性能上花费您很多。这是一件好事，因为如果您从不使用它，就没有理由获取关联。

我相信在您的情况下 - 将`Item.class`new包装`Order.class`起来隐藏了您确实在查询中使用 fetch 修饰字段父级的事实。

我目前没有调试能力，所以我无法验证这一点。尝试从 SelectClause.class 中调试这个确切的行，并查看`fromElementsForLoad`集合包含哪些元素。

如果您想避免 n+1 问题，我建议您在查询后初始化 Order.class。您只能选择项目和提供者。

如果您无法验证这一点，我将在下周找到一台合适的计算机并扩展我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T06:11:45.200

尝试删除`left join fetch i.fees f`并在映射中进行急切获取。

# html - HTML 网站标题和页脚版权

> ID：10217593
> 
> 赞同：0
> 
> 时间：2012-04-18T20:39:25.343
> 
> 标签：html, base64

我有2个问题。

1）我想知道是否有任何方法，我可以在页脚中添加一个代码以获取版权，它会自动提取站点名称并添加到页脚版权中。

因为我打赌我的英语不够清楚，所以我会写一个例子。

如果网站标题是“示例”，我可以在页脚中添加任何代码，所以如果我写：版权 2012 -“它会自动在此处添加标题”。版权所有。

2）什么是最好的base64编码器，谁能给我一个如何使用它的链接。

我想对页脚进行编码，所以我想如果有一个代码可以在页脚中自动添加网站标题，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:43:37.703

假设您的页脚中有一个要插入网站标题的元素，您可以通过以下方式非常简单地实现该部分：

```
var title = document.getElementsByTagName('title')[0].firstChild.nodeValue,
    footerElem = document.getElementById('footerElementID'),
    t = document.createTextNode(title);
footerElem.appendChild(t);​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Qdebr/1/)。

至于 Base64 编码你的页脚？恐怕我无法提供这样做的方法；我也不明白你为什么要*这么做*。

* * *

**针对 OP 留下的评论进行了**编辑（见下文）。****

 **首先，将您的 JavaScript 放在`<script></script>`文档`<head></head>`中。然后将其粘贴到：

```
window.onload = function(){
    var title = document.getElementsByTagName('title')[0].firstChild.nodeValue,
        footerElem = document.getElementById('footerElementID'),
        t = document.createTextNode(title);
    footerElem.appendChild(t);
};​ 
```

唯一的区别是现在它被包装在一个`window.onload`事件处理程序中，这意味着它应该在`window`完全加载时触发，并且假设您的 HTML 被准确地复制，它*应该可以*工作。

参考：

*   [`document.createTextNode()`](https://developer.mozilla.org/en/DOM/document.createTextNode).
*   [`document.getElementById()`](https://developer.mozilla.org/en/DOM/document.getElementById).
*   [`document.getElementsByTagName()`](https://developer.mozilla.org/en/DOM/document.getElementsByTagName).
*   [`node.appendChild()`](https://developer.mozilla.org/en/DOM/element.appendChild).
*   [`node.firstChild`](https://developer.mozilla.org/en/Document_Object_Model_%28DOM%29/Node.firstChild).
*   [`node.nodeValue`](https://developer.mozilla.org/En/DOM/Node.nodeValue).**

# iphone - 关于 App 提交到 Apple iTunes 商店

> ID：10217594
> 
> 赞同：1
> 
> 时间：2012-04-18T20:39:27.500
> 
> 标签：iphone, ios, xcode

任何人请澄清我对应用程序提交到 Apple iTunes 商店的疑问，问题是：

**我可以使用客户的 Apple 开发者帐户**为我的**客户（来自美国**）从**印度**向 Apple iTunes 商店提交 Iphone 应用程序吗？

 ***** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:44:06.763

是的.. 只要您有互联网连接，您甚至可以从阿富汗、朝鲜和南极洲提交.. :D (虽然我对朝鲜表示怀疑... :/)****

# java - 大型企业 Java 应用程序 - 模块化

> ID：10217595
> 
> 赞同：12
> 
> 时间：2012-04-18T20:39:28.433
> 
> 标签：java, jakarta-ee, web-applications, module, osgi

我在一家全国性的公司工作，所以我们开发的软件规模很大。

我们的核心系统是基于 Web 的，包括`webservices`. 我们目前正在重新设计整个项目，是开始项目结构的时候了。

我们有 7 个 Web 模块，包括基于`Struts2`和`Spring 3.1`. `Webservice`基于`JAX-WS`和的核心`Spring 3.1`

**我的问题是为这样的项目设计项目结构和模块化的最佳实践是什么：**

如果需要，`Maven`我们肯定会使用。`OSGi`我在想类似的东西

```
WebProject.war
   |---Web.xml
   |--- Libs
   |
   |--- Web Module1.jar
   |--- Web Module2.jar
   |--- Web Module3.jar
   |--- Web Module4.jar
   |--- Web Module5.jar
   |--- Web Module6.jar

 WebService.war
   |---Web.xml
   |--- Libs
   |
   |--- Service.jar
   |--- Service2.jar

 EJBProject.jar
   |
   |--- module.jar
   |--- module2.jar 
```

这是我个人的想法，但我们正在寻找更好的模块化，以便我们可以在`WebModule1.jar`不影响其他模块和主项目的情况下工作和部署`WebProject.war`。同样，我们希望专业团队只有他们项目的代码，所以如果一个团队必须只`Service2.jar`在他们的项目中工作，`IDE`他们将只有代码`Service2.jar`和资源项目与其他项目已经编译。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T07:37:49.297

模块化的关键方面是你的模块知道的尽可能少，以便它可以在许多不同的上下文中重用。错误仅在违反假设时才会出现，最小化假设是最大的错误杀手。OSGi 提供了像 µservices 这样的工具，这些工具非常好地允许假设保持本地化。

您的布局看起来非常像一个 Web 项目，恕我直言，这是错误的，因为我们必须自己开发的大多数代码应该独立于用于呈现它的技术。所有这些技术都可能在不久的将来发生变化，因为 Web 应用程序正在迅速转向浏览器，浏览器再次成为胖客户端。也就是说，如果您看到纯消息传递正在做什么，那么非常现代的 REST 接口已经感觉非常过时了。所有这些波动性意味着您希望使您的模块尽可能地解耦。

因此，我永远不会将任何域代码耦合到任何耦合到与 Web 技术耦合的库的代码。这些传递依赖将在（不久的）将来伤害你。构建小的内聚解耦模块，然后将它们用作乐高积木来构建您的应用程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T10:05:33.603

我强烈推荐阅读[Kirk Knoernschild](http://techdistrict.kirkk.com/)的[“Java 应用程序架构：模块化模式和使用 OSGi 的示例”](https://rads.stackoverflow.com/amzn/click/com/0321247132)。在迁移到 OSGi 之前，您可以先模块化应用程序（如果您还没有它，我肯定会投资于良好的测试覆盖率）。

如果您使用的是 servlet 规范 3.0，请查看使用 web-fragments。

就您展示的结构而言，我想说不要嵌套任何东西（网络片段除外），WAR 可以成为 WAB（网络应用程序包 - 基本上是一个瘦 WAR）。还尽可能多地利用 OSGi 的 μServices - 这就是乐趣开始的地方 =)

当您跨越 JEE-OSGi 鸿沟时，像 Karaf 和 Virgo 这样的企业 OSGi 框架提供了很多支持（仅 Equinox 和 Felix 就有点像准系统）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T14:15:32.233

根据您的项目需求，如独立模块开发和运行时更新，Maven 是最佳解决方案。它提供了对依赖项和插件的强大支持，并且看起来您的项目所需的一切都已经可用：

*   弹簧/支柱/CXF/等。Maven工件，
*   WAR/JAR/等。插件，
*   应用程序服务器部署/测试插件等。
*   您可以只为只开发特定模块而不共享所有代码库的团队提供常见的 Maven 工件。
*   所有持续集成服务器（Hudson/TeamCity 等）都支持 Maven

操作系统吉。如果您喜欢使用它，您必须仔细查看您当前的设计并尝试使其适应 μServices。通常，您将拥有带有 API、API 消费者和 API 提供者的模块。它可以帮助您更多地在团队之间拆分开发（例如，一个开发 API 消费者模块，另一个 - API 提供者模块）。如果需要，您可以将 API 使用者/提供者模块拆分为 2+ 个 OSGi 包（即 Maven 模块）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T12:53:03.703

您的结构对我来说确实不错，这是大多数项目的典型结构-我会给出的一个建议是对您的依赖项进行版本控制，例如，让您的 webproject.war 依赖于 webmodule1-1.3 说，这样可能会有所不同项目可能有不同版本的依赖 jar。

使用 maven 肯定会简化管理这些依赖项

如果您的要求是在运行时替换依赖项，那么是的，您将不得不使用像 OSGI 这样的技术，但是如果您正在寻找的不是运行时模块化，我建议不要从 OSGi 开始并保持堆栈更简单。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-08-30T21:33:56.260

在处理了一点 OSGi 并得到了一些痛苦之后，我们为 Spring 开发了 osgi-less 模块化[https://github.com/griddynamics/banshun](https://github.com/griddynamics/banshun)你好！

# c# - 如何在 Telerik MVC 网格模板列中创建链接将帖子发送到操作

> ID：10217597
> 
> 赞同：1
> 
> 时间：2012-04-18T20:39:40.157
> 
> 标签：c#, jquery, asp.net-mvc-3, telerik-mvc

这里发生了很多事情。

我有一个带有以下模板列的 Telerik MVC 网格：

```
@(Html.Telerik().Grid((IEnumerable<User)Model.Data)
  .Name("UsersGrid")
  .DataKeys(keys => keys.Add(c => c.UserName))
  .DataBinding(dataBinding => dataBinding.Server()
  .Columns(c =>
  {
    c.Bound(r => r.FullName).Title("");
    c.Bound(r => r.UserName).Title("");
    c.Template(
      @<text>
        @if(@item.Status == "Pending")
        {
           @Html.ActionLink("Resend Invite", "ResendInvite", new { Email = @item.UserName, FirstName = @item.FullName }, new { @class = "reesendInviteLink" })
        }
      </text>
    ).Title("Link").HtmlAttributes(new { Style = "text-align: right;" });
  })); 
```

现在我知道 ActionLink 不会调用 post 操作，所以我使用 jquery 执行以下操作：

```
$(document).ready(function () {
   $(".resendInviteLink").click(function (e) {
      var url = e.currentTarget.href;
      $.post(url);
   });
}); 
```

我试图调用的 Action 方法如下所示：

```
[HttpPost]
public ActionResult ResendInvite(UserVM user)
{
   //....Do Something
} 
```

当我调试 jquery 时，一切都很顺利，直到我到达 $.post 然后它失败说它在控制器上找不到 ResendInvite 操作。在某种程度上，我认为这是有道理的，因为 ActionLink 正在寻找 Get，而不是 Post。

那么如何在网格上创建一个链接：
1\. 从 Telerik 网格中获取电子邮件和用户名。
2\. 调用具有正确参数的后操作方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:04:40.510

您的问题是，尽管您已经`click event`使用 Jquery 订阅了链接，但链接的原始链接`click event`仍然会触发一个失败的 Get 请求。

您需要使用 [preventDefault](http://api.jquery.com/event.preventDefault/)方法

```
$(".resendInviteLink").click(function(e) {
    e.preventDefault();
    var url = e.currentTarget.href;
    $.post(url);
}); 
```

或者`return false`形成事件处理程序：

```
$(".resendInviteLink").click(function(e) {
    var url = e.currentTarget.href;
    $.post(url);
    return false;
}); 
```

# javascript - 使用正则表达式时出现 Javascript 错误 - 对象不支持此属性或方法

> ID：10217598
> 
> 赞同：0
> 
> 时间：2012-04-18T20:39:40.450
> 
> 标签：javascript

所以我正在阅读这本书并逐字复制代码以亲自动手，我得到“对象不支持此属性或方法”。

```
var text = '<html><body bgcolor=blue><p>' + '<This is <b>BOLD<\/b>!<\/p><\/body><\/html>';

var tags = /[^<>]+|<(\/?)([A-Za-z]+)([^<>]*)>/g;

var a,i;

String.method('entityify', function () {
var character = {
    '<': '&lt;',
    '>': '&gt;',
    '&': '&amp;',
    '"': '&quot;'
};

return function() {
    return this.replace( /[<>&"]/g , function(c) {
        return character[c];
    });
};
}());

while((a = tags.exec(text))) {
for (i = 0; i < a.length; i += 1) {
    document.writeln(('// [' + i + '] ' + a[i]).entityify());
}
document.writeln();
}

//Output [0] <html>
//Output [1] 
//Output [2] html
//Output [3] 
//and so on through the loop. 
```

我似乎无法使他们的示例起作用。

**编辑 - 我找到并添加了该功能，但仍然无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:13:15.103

问题是没有`String.method(...)`功能。如果您尝试向 String 类型添加新函数，请尝试以下操作：

```
String.prototype.entityify = (function () {
  var character = {
    '<':'&lt;',  '>':'&gt;',  '&':'&amp;',  '"':'&quot;'
  };
  return function() {
    return this.replace( /[<>&"]/g , function(c) {
      return character[c];
    });
  };
})();

'<foo & bar>'.entityify(); // => "&lt;foo &amp; bar&gt;" 
```

虽然，如果您打算将这部分作为库的一部分，那么您不应该*直接*分配给`String.prototype`，而是[按照此处所示的方式](https://stackoverflow.com/a/7141932/244128)[使用`Object.defineProperty(...)`](https://stackoverflow.com/a/7141932/244128)。

# c++ - 一个多索引，其中一个索引是整个集合的子集

> ID：10217601
> 
> 赞同：1
> 
> 时间：2012-04-18T20:39:54.527
> 
> 标签：c++, boost, boost-multi-index

我想用两个`sequenced`视图构建一个多索引，我只能从*一个*视图中删除值。

在代码中：

```
#include <boost/multi_index_container.hpp>
#include <boost/multi_index/sequenced_index.hpp>

#include <algorithm>
#include <iterator>
#include <vector>

using namespace boost::multi_index;

typedef multi_index_container<
  int,
  indexed_by<
    sequenced<>,
    sequenced<> 
    > 
  > container;

int main()
{
  container c;
  std::vector<int> 
    // complete
    data = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, 
    // only uneven
    uneven_data;
  std::copy_if(begin(data), end(data), 
               std::back_inserter(uneven_data), 
               [](int i) { return i % 2 != 0; });

  container cont;
  std::copy(begin(data), end(data), std::back_inserter(cont));

  auto& idx0 = cont.get<0>();
  auto& idx1 = cont.get<1>();
  // remove all uneven from idx1
  idx1.remove_if([](int i) { return i % 2 == 0; });

  // behavior I would like to be true, but now both idx0 and idx1 are
  // equal to uneven_data
  assert(std::equal(begin(data), end(data), begin(idx0)));
  assert(std::equal(begin(uneven_data), end(uneven_data), begin(idx1)));

  return 0;
} 
```

这样的事情可能`boost::multi_index`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:08:28.537

不，在 boost multi_index_container 中，索引作为相同值的单独视图耦合在一起。这是 boost multi_index_containers 的重要保证。

> “Boost.MultiIndex 允许指定 multi_index_containers 由一个或多个索引组成，这些索引具有与同一元素集合的不同接口”（[boost multi_index 教程](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/tutorial/index.html)）。

使用两个不同的序列 <> 索引，您可以以两种不同的方式重新排列*顺序*，但它们都必须包含所有值。

如果您希望根据布尔谓词查看元素的子集（例如：值是奇数），请考虑使用[boost::filter_iterator](http://www.boost.org/doc/libs/1_53_0/libs/iterator/doc/filter_iterator.html)。这不会尝试*擦除*容器中的值，而是在迭代期间*跳过它们。*

或者，可以通过排序获得选择/过滤，使用带有适当[键提取器的 multi_index](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/tutorial/key_extraction.html) [ordered_non_unique](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/reference/ord_indices.html)索引。

例如，基于[键提取器](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/tutorial/key_extraction.html)的 ordered_non_unique 索引：`[](int i) { return i % 2; }`会将奇数和偶数值放在不同的组中，因此可以使用[equal_range](http://www.boost.org/doc/libs/1_53_0/libs/multi_index/doc/reference/ord_indices.html)获得所有奇数值的迭代器范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:56:52.980

[正如我上面提到的，一种使用boost intrusive](http://www.boost.org/doc/libs/1_53_0/doc/html/intrusive.html)的更灵活（非基于谓词）的方法。使用两个或多个[列表挂钩](http://www.boost.org/doc/libs/1_53_0/doc/html/intrusive/list.html)，您可以使一个对象同时参与两个或多个序列。

```
#include <boost/intrusive/list.hpp>
#include <boost/foreach.hpp>

#include <algorithm>
#include <memory>

#include <iostream>
namespace intr = boost::intrusive;
template<class Value>
struct Sequence2
{
    typedef intr::link_mode< intr::auto_unlink > AutoUnlinkMode;
    typedef intr::list_member_hook< AutoUnlinkMode > SeqHook;

    struct Node
    {
        Node( const Value& i ) : value(i) {}

        operator Value&()
        {
            return value;
        }

        Value value;

        SeqHook mainHook;
        SeqHook hook0;
        SeqHook hook1;
    };

    typedef intr::member_hook< Node, SeqHook,&Node::mainHook > UsingMainHook;
    typedef intr::member_hook< Node, SeqHook,&Node::hook0 > UsingSeqHook0;
    typedef intr::member_hook< Node, SeqHook,&Node::hook1 > UsingSeqHook1;

    typedef intr::constant_time_size<false> NonConstantTimeSized;

    typedef intr::list< Node, UsingMainHook, NonConstantTimeSized > NodesList;
    typedef intr::list< Node, UsingSeqHook0, NonConstantTimeSized > Sequence0;
    typedef intr::list< Node, UsingSeqHook1, NonConstantTimeSized > Sequence1;

    NodesList nodes;
    Sequence0 seq0;
    Sequence1 seq1;

    typename NodesList::iterator insert( const Value& item )
    {
        Node* node = new Node(item);

        nodes.push_back( *node );

        typename NodesList::iterator iter = nodes.end(); iter--;
        seq0.push_back( *node );
        seq1.push_back( *node );
        return iter;
    }

    typename Sequence0::iterator iterator0( typename NodesList::iterator iter )
    {
        return seq0.iterator_to( *iter );
    }
    typename Sequence1::iterator iterator1( typename NodesList::iterator iter )
    {
        return seq1.iterator_to( *iter );
    }

    //! Erase from both sequences
    void erase( typename NodesList::iterator at )
    {
        nodes.erase_and_dispose( at, std::default_delete<Node>() );   
    }
    //! Erase from sequence 0
    void erase( typename Sequence0::iterator at )
    {
        Node& n = *at;

        assert( n.hook0.is_linked() );
        if( ! n.hook1.is_linked() )
        {
            seq0.erase_and_dispose( at, std::default_delete<Node>() );   
        }
        else
        {
            seq0.erase(at);
        }
    }
    //! Erase from sequence 1
    void erase( typename Sequence1::iterator at )
    {
        Node& n = *at;

        assert( n.hook1.is_linked() );
        if( ! n.hook0.is_linked() )
        {
            seq1.erase_and_dispose( at, std::default_delete<Node>() );   
        }
        else
        {
            seq1.erase(at);
        }
    }

    ~Sequence2()
    {
        nodes.clear_and_dispose( std::default_delete<Node>() );
    }
};

template< class T >
void show( Sequence2<T>& mseq, const std::string& comment )
{
    std::cout << comment << "\nseq 0:\t";
    BOOST_FOREACH( T& i, mseq.seq0 )
    {
        std::cout << i << " ";
    }
    std::cout << "\nseq 1:\t";
    BOOST_FOREACH( T& i, mseq.seq1 )
    {
        std::cout << i << " ";
    }
    std::cout << "\n\n";
}

int main(void)
{
    Sequence2< std::string > mseq;

    mseq.insert( "." );
    auto iterX = mseq.insert("X");
    auto iterY = mseq.insert("Y");
    auto iterZ = mseq.insert("Z");
    mseq.insert(".");
    mseq.insert(".");

    show(mseq, "start" );

    mseq.seq0.reverse();
    show(mseq, "after reverse seq0");    

    mseq.erase( mseq.iterator0(iterY) );
    show(mseq, "after erase Y in seq0");

    // Update a value in both sequences
    std::string& v = *iterZ;
    v = "z";
    show(mseq, "after modify Z in both");

    mseq.erase( iterX );
    show(mseq, "after erase X in both");

    mseq.erase( iterY );
    show(mseq, "after erase Y in both");

    return 0;
} 
```

产生：

```
start
seq 0:  . X Y Z . . 
seq 1:  . X Y Z . . 

after reverse seq0
seq 0:  . . Z Y X . 
seq 1:  . X Y Z . . 

after erase Y in seq0
seq 0:  . . Z X . 
seq 1:  . X Y Z . . 

after modify Z in both
seq 0:  . . z X . 
seq 1:  . X Y z . . 

after erase X in both
seq 0:  . . z . 
seq 1:  . Y z . . 

after erase Y in both
seq 0:  . . z . 
seq 1:  . z . . 
```

# php - Php fetch 返回字符串而不是布尔“真/假”值

> ID：10217605
> 
> 赞同：2
> 
> 时间：2012-04-18T20:40:17.733
> 
> 标签：php, javascript, jquery, mysql, json

我正在使用完整的日历，并且我有一些全天活动。一般来说，我的 php 设置了所有`'allDay' => 'false'`. 现在我注意到如果我不指定时间，它会添加一个时间。

我想将所有值的所有默认值设置为 false，除非我将它们指定为 true。

我的 php 获取如下：

```
$sql = "SELECT `id`, `title`, `time`, `start`, `end`, `url`, `backgroundColor`, `textColor`, `className`,
   `allDay` FROM calender WHERE length('column') > '0'";

$result = $dbh->query($sql)->fetchAll(PDO::FETCH_ASSOC);

foreach ($result as $row){
    $return[]=array('id'=>$row['id'],
                'title'=>$row['title'],
                "allDay" =>$row['allDay'],
                'start'=>$row['start'].' '.$row['time'],
                'end'=>$row['end'],
                'url'=>$row['url'],
                'backgroundColor'=>$row['backgroundColor'],
                'textColor'=>$row['textColor'],
                'className' =>$row['className']);
}
$dbh = null;

header('Content-type: application/json');
echo json_encode($return); 
```

jQuery函数是：

```
$(document).ready(function() {
    $('#calendar').fullCalendar({
    editable: false,
    events: "json-events.php", 
    eventDrop: function(event, delta) {
            alert(event.title + ' was moved ' + delta + ' days\n' +
                '(You cannot update these fields!)');
        },
        loading: function(bool) {
            if (bool) $('#loading').show();
            else $('#loading').hide();
        },
    });
}); 
```

我不知道我在哪里添加值。我让 mySQL 将“allDay”存储为真/假，但它以字符串形式返回。所以我实际上知道如何在 json 对文件进行编码之前对其进行隐藏。或者在查看数据后让 jQuery/javascript 更改它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:49:25.083

MySQL 中的 allDay 字段是什么类型的？如果是`enum('true', 'false')`，那可能是你的问题。这将转换为字符串。我曾经有人这样做过，我花了很长时间才弄清楚为什么我认为布尔值（或整数）是字符串。

仔细检查您的数据库并尝试将其设为 a`tinyint(1)`并使用 0 表示假，使用 1 表示真。PHP 的布尔值 true 和 false 将被转换为相应的整数，在 JavaScript 中使用 0/1 不会有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:25:56.040

你也可以试试这个：

```
$sql = "SELECT `id`, `title`, `time`, `start`, `end`, `url`, `backgroundColor`, `textColor`, `className`, IF(`allDay` = 'true',true,false) AS allDay  FROM calender WHERE length('column') > '0'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:52:05.013

尝试这个：

```
foreach ($result as $row){
    $return[]=array('id'=>$row['id'],
                'title'=>$row['title'],
                "allDay" =>$row['allDay'] == "true",
                'start'=>$row['start'].' '.$row['time'],
                'end'=>$row['end'],
                'url'=>$row['url'],
                'backgroundColor'=>$row['backgroundColor'],
                'textColor'=>$row['textColor'],
                'className' =>$row['className']);
}
$dbh = null; 
```

# .htaccess - .htaccess 从子文件夹重定向到主文件夹

> ID：10217606
> 
> 赞同：0
> 
> 时间：2012-04-18T20:40:21.320
> 
> 标签：.htaccess

我想重定向所有类型的 URL

`www.domain.com/BE`（......和后面的东西）
到
`www.domain.com`

知道 www.domain.com/BE 现在将用于 www.domain.be ，我怎么能这样做？

我试过这个：

```
RewriteCond %{HTTP_HOST} ^(.*)www.domain.com/BE(.*)$
RewriteRule (.*) http://www.domain.com/  [R=301,L] 
```

通过将它放在 www.domain.com 文件夹中，但它没有做我想要的......

谢谢 ！

有任何想法吗 ：/ ？？我想不通这...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:58:30.507

将此代码放在 DOCUMENT_ROOT 下的 .htaccess 中：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
RewriteRule ^BE(?:/.*|)$ / [R=301,L,NC] 
```

# forms - 来自实体的 symfony2 表单

> ID：10217608
> 
> 赞同：0
> 
> 时间：2012-04-18T20:40:29.980
> 
> 标签：forms, symfony

好的，所以我正在使用 symfony2 并且我正在尝试基于另一个实体以这种形式创建一个选项框......

所以在我的控制器中，我有：

```
<?php

namespace Ecs\CrmBundle\Controller\Report;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Ecs\CrmBundle\Form\Report\TimeClockReportType;

class TimeClockReportController extends Controller
{
    public function indexAction()
    {
        $request = $this->get('request');
        $em = $this->getDoctrine()->getEntityManager();
        $start = null;
        $end = null;
        $dateRangeForm = $this->createForm(new TimeClockReportType());

        if ($request->getMethod() == 'POST')
        {
            $dateRangeForm->bindRequest($request);
            $formData = $dateRangeForm->getData();

            $start = $formData['dateRange']['startDate'];
            $end = $formData['dateRange']['endDate'];
        }

        return $this->render('EcsCrmBundle:Reports:TimeClockReport.html.twig', array(
            'start' => $start,
            'end' => $end,
            'form' => $dateRangeForm->createView(),
        ));
    }

} 
```

我的 TimeClockReportType.php 看起来像：

```
 <?php

namespace Ecs\CrmBundle\Form\Report;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

use Ecs\CrmBundle\Form\Parts\DateRangeType;
use Ecs\CrmBundle\Form\Parts\DepartmentSelectionType;

class TimeClockReportType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('dateRange', new DateRangeType())
            ->add('salesCompany', new DepartmentSelectionType(true));
    }

    public function getName()
    {
        return 'ecs_crmbundle_TimeClockReportType';
    }

} 
```

我的 DepartmentSelectionType 看起来像：

```
 <?php

namespace Ecs\CrmBundle\Form\Parts;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class DepartmentSelectionType extends AbstractType
{
    private $canSeeAll = false;

    public function __construct($canSeeAll = false)
    {
        $this->canSeeAll = $canSeeAll;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('department', 'entity',
                array(
                    'class' => "EcsAgentManagerBundle:EmployeeDepartment",
                    'required' => false,
                    'multiple' => true,
                    'expanded' => true,
                    'label' => "Department"))
        ;
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Ecs\AgentManagerBundle\Entity\EmployeeDepartment',
        );
    }

    public function getName()
    {
        return 'ecs_crmbundle_departmentselectiontype';
    }
} 
```

我想出的问题是，我得到的只是一个空白的白屏......但是，如果我删除：

`->add('salesCompany', new DepartmentSelectionType(true))`从`TimeClockReportType`它工作得很好......但我看不到任何错误或为什么它不起作用..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T02:46:56.127

空白页表示发生了解析错误/引擎错误。我建议更改您的 php.ini 文件以启用 display_errors。

请务必在之后重新启动您的网络服务器。

# c++ - 使用 boost pp & mpl 对数组进行编译时初始化

> ID：10217611
> 
> 赞同：2
> 
> 时间：2012-04-18T20:40:38.300
> 
> 标签：c++, boost, boost-mpl, boost-preprocessor

鉴于：

```
typedef boost::mpl::vector<Type1, Type2, Type3> types;
const size_t numTypes = boost::mpl::size<types>::value;
std::array<std::function<bool(const obj&, const obj&)>, numTypes*numTypes> arr; 
```

我试图在编译时获得这种功能：

```
for( size_t i = 0; i < numTypes; ++i )
{
    for( size_t j = 0; j < numTypes; ++j )
    {
        arr[i*numTypes+j] = ObjPair<boost::mpl::at_c<vecType, i>::type, boost::mpl::at_c<vecType, j>::type>::Foo;
    }
} 
```

我认为它看起来像：

```
std::array<std::function<bool(const obj&, const obj&)>, numTypes*numTypes> arr = { BOOST_PP_FOR((0, numTypes), PRED, OP, MACRO) }; 
```

但我无法让它工作（我没有发布我使用 BOOST_PP_FOR 的完全失败尝试）。

`ObjPair<T1, T2>::Foo`是一个静态的signature方法`bool(const obj&, const obj&)`。它专门用于不同的 obj 类型。

我将使用这个数组来查找给定对象对的特定函数。这些对象作为它们的基类保存，我可以用一些数学来索引数组，以根据基类中可用的 ID 确定索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:11:02.370

PP 不可能迭代`boost::mpl::vector`大小。但是，您可以尝试定义它。

```
typedef boost::mpl::vector<bool, short, long> vecType;
#define numTypes 3 
```

我没有 TR1，所以我尝试使用 boost 数组：

```
typedef  boost::function<bool(const obj&, const obj&)> Function;
typedef boost::array<Function, numTypes*numTypes> FooArray;

#define OBJPAIR_FOO_ARRAY(z, n, text)  BOOST_PP_COMMA_IF(n) &ObjPair<      \
boost::mpl::at_c<vecType, n/numTypes>::type,  \
boost::mpl::at_c<vecType, n%numTypes>::type   \
    >::Foo

FooArray fooArray= {
    BOOST_PP_REPEAT( BOOST_PP_MUL(numTypes, numTypes) , OBJPAIR_FOO_ARRAY, )
}; 
```

# java - 如何从 jar 中执行 jar？

> ID：10217624
> 
> 赞同：5
> 
> 时间：2012-04-18T20:41:10.860
> 
> 标签：java, jar

我计划使用包含在另一个 jar 中的 jar 来执行 jar 命令。

该命令将使用类似于以下的代码自动混淆 Java jar 文件：

```
public void obfuscate()
{
    try
    {
        String jre = "\"" + System.getProperty("java.home") + "\\bin\\javaw.exe" + "\"";
        String jar = " -jar";
        Runtime.getRuntime().exec(new String[] { jre, jar.trim(), "/lib/allatori.jar /lib/config.xml" });
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

`allatori.jar``main.jar`文件作为资源包含在我的文件中。`config.xml`文件也包括在内。

如何运行我的命令以执行包含的 jar 文件？

**main.jar**的文件夹结构：

```
- main.jar
  |
  |- main_class.class
  |- lib/
      |- allatori.jar
      |- config.xml
      |- jarToObfuscate.jar 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:44:12.753

当然。把它复制到外面，创建一个类加载器，找到你想开始的类，然后就可以了。在它还在的时候就位？好吧，您必须编写自己的代码才能将类文件从嵌入式 jar 文件中提取出来并提供给类加载器，可能您必须从头开始编写它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:44:16.763

在运行它之前，您肯定必须将其解压到 jar 之外。

# deployment - 普通用户的 Capistrano 部署

> ID：10217626
> 
> 赞同：7
> 
> 时间：2012-04-18T20:41:12.387
> 
> 标签：deployment, capistrano

我正在尝试设置 Capistrano 来进行我们的部署，但我现在偶然发现了似乎是 capistrano 用户的一个常见假设：您通过 SSH 连接到远程主机的用户将有权写入部署目录。

在这里，管理员是普通用户，只有一个区别：他们可以 sudo。一开始我以为这样就够了，因为有一些与sudo相关的配置，但似乎毕竟不是这样。

有没有解决的办法？创建一个由所有进行部署的人共享的用户不是一个可接受的解决方案。

*编辑：*为了清楚起见，不调用 sudo 就不会发生任何部署操作——这是检查用户是否被允许部署的网关点，它应该是一个强制检查点。

目前接受的答案不符合该标准。它通过向用户授予额外权限来绕过 sudo。无论如何，我接受它，因为我得出的结论是 Capistrano 在这方面从根本上被打破了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-23T23:43:35.900

我假设您正在部署到 Linux 发行版。解决您的问题的最简单方法是创建一个组，例如*deployers*，然后添加应该有权部署到该组的每个用户。创建组并且用户在组中后，更改部署路径上的所有权和权限。

根据发行版，语法会略有不同。这是针对 ubuntu/debian 的：

创建组：

`$ sudo groupadd deployers`

将用户添加到组：

`$ sudo usermod -a -G deployers daniel`

最后一个参数是用户名。

接下来，更新部署路径的所有权：

`$ sudo chown -R root:deployers /deploy/to/path/`

的语法是：。在这里，我假设当前拥有该路径的用户是 root。更新到哪个用户应该拥有该目录。

最后，更改部署路径的权限：

`$ sudo chmod -R 0766 /deploy/to/path/`

这将允许*deployers*组中的用户读取和写入下面的所有文件和目录`/deploy/to/path`

# tsql - 组合分组和排名的正确方法是什么？

> ID：10217628
> 
> 赞同：0
> 
> 时间：2012-04-18T20:41:14.737
> 
> 标签：tsql, sql-server-2008-r2

我已经有一个按天细分的视图（下面的查询中的 ByDay）。

现在我想过滤它，如果它的活动在前 10 个创收活动中，则结果中包含一行。

我得到了我想要的，但我有一种感觉，我可能会在此过程中跳过明显/正确的方法。

```
WITH T AS (
    SELECT
     ByDay.[Day]
    ,ByDay.[Campaign Name]
    ,ByDay.[Revenue USD]
    FROM ByDay
    WHERE ByDay.[Period]='Mar 2012'
),
TT AS (
    SELECT
     ByDay.[Campaign Name]
    ,SUM(ByDay.[Revenue USD]) [Sum Revenue USD]
    FROM ByDay
    WHERE ByDay.[Period]='Mar 2012'
    GROUP BY ByDay.[Campaign Name]
)
SELECT * FROM (
SELECT
     T.[Day]
    ,T.[Campaign Name]
    ,T.[Revenue USD]
    ,TT.[Sum Revenue USD]
    ,DENSE_RANK() OVER(ORDER BY TT.[Sum Revenue USD] DESC) AS R
    FROM T
    INNER JOIN TT ON T.[Campaign Name]=TT.[Campaign Name]
) TTT
WHERE R < 11
ORDER BY R 
```

有没有更简单的方法来获得这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:57:13.753

你可以`SUM([Revenue USD])OVER(Partition By [Campaign Name])`用来得到每个的总和`Campaign Name`。那么你只需要一个 CTE：

[http://msdn.microsoft.com/en-us/library/ms189461.aspx](http://msdn.microsoft.com/en-us/library/ms189461.aspx)

```
WITH T AS (
    SELECT
     ByDay.[Day]
    ,ByDay.[Campaign Name]
    ,ByDay.[Revenue USD]
    ,SUM(ByDay.[Revenue USD]) OVER(Partition By ByDay.[Campaign Name]) [Sum Revenue USD] 
    FROM ByDay
    WHERE ByDay.[Period]='Mar 2012'
)
SELECT * FROM (
SELECT
     T.[Day]
    ,T.[Campaign Name]
    ,T.[Revenue USD]
    ,T.[Sum Revenue USD]
    ,DENSE_RANK() OVER(ORDER BY T.[Sum Revenue USD] DESC) AS R
    FROM T
) TTT
WHERE R < 11
ORDER BY R 
```

# php - OO 设计问题（使用 Symfony2）

> ID：10217629
> 
> 赞同：2
> 
> 时间：2012-04-18T20:41:18.983
> 
> 标签：php, oop, database-design

我正在开发一个运动场预订系统，我需要生成一个“预订表”，将表头中的列显示为球场，将行显示为预订的时间段。

例如，

```
 ___________________________________
|           |           |           |
|  Court 1  |  Court 2  |  Court 3  |
|___________|___________|___________|
|           |           |           |
| 10.00 am  |  10.00 am | 10.00 am  |
|___________|___________|___________|
|           |           |           |
| 11.00 am  |  11.00 am | 11.00 am  |
|___________|___________|___________| 
```

要求：

*   一个俱乐部可以有任意数量的球场
*   俱乐部可以有任何预订时间增量（例如，如上所示的 1 小时、30 分钟、40 分钟等）
*   表格中的每个单元格代表一个“预订”

我想确保我从一开始就这样做，所以我有几个问题：

1.  您将创建哪些实体来实现这一目标
2.  您将如何生成此预订表
3.  您如何将上表中的单元格链接到预订

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:58:58.120

好吧，我认为这是一种标准？

首先，您需要一个俱乐部实体。每个俱乐部可以有 n 个球场：

```
Club 1:n Court 
```

然后是一个预订表，是1:n到法院的：

```
Court 1:n Booking 
```

我不知道您的第二个要求是否意味着一个俱乐部有一个时间增量（在这种情况下，这是俱乐部实体上的一个变量）或者它是否可以有很多（比有一个 TimeIncrement 实体。

生成表可能有点棘手。考虑了几分钟，我得到了 5-6 个可能有效的解决方案。您可以使用特殊物品，您可以要求预订特定场地和时间并搜索收藏。我们可以建立一个数组，每次都有一个密钥，如果没有预订，则为空。每个球场有一个数组，而不是 2 个嵌套的 for 循环并从数组中读取每个值。您可以构建重新排列数据的查询，以便您可以直接使用它们。或者，也许您可​​以要求法院反对自己在特定日期和时间进行预订。但我想这就是开发人员的目的......找出最适合给定要求的方法并实施它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:00:56.990

我只是从数据库中查询数据并将其转换为 json 并将其传递到网站。然后前端可以使用 javascript 构建表。

为此，我将创建一个[自定义实体](http://symfony.com/doc/current/book/doctrine.html#custom-repository-classes) `BookingTable`，将请求中的数据直接作为数组返回，然后可以轻松地将其转换为带有`json_encode`.

然后，您可以专注于显示单个预订的更详细的页面，您将自动为其创建所需的实体（如果您尚未为表的自定义实体制定 DQL）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:53:41.247

> 您将创建哪些实体来实现这一目标

在我的脑海中，您似乎需要 3 个：俱乐部、球场、预订

> 您将如何生成此预订表

该表应该可能包含 id、court_id、start_time、end_time

> 您如何将上表中的单元格链接到预订

如上所述，开始/结束时间是预订表中的列。

# php - Wordpress Ajax 从functions.php 返回完整的html 页面，而不是回显

> ID：10217633
> 
> 赞同：1
> 
> 时间：2012-04-18T20:41:28.823
> 
> 标签：php, jquery, ajax, wordpress

我正在使用 wordpress ajax 调用从 wordpress 主题 functions.php 中的函数返回简单内容。但是，会返回一个完整的 html 页面。

这是ajax调用

```
<?php   
$ajax_nonce = wp_create_nonce("iwhq_beginner_select_course");
?>

<script type="text/javascript" language="javascript">
jQuery(document).ready(function(){

jQuery("#beg_golf_course").change(function() {  //do this when course changes

//in Wordpress ajaxurl always points to admin-ajax.php
var ajaxurl = '<?php echo admin_url('admin-ajax.php'); ?>';
var course_id = 4; 

//Do the ajax
    jQuery.ajax({
        type: "POST", 
        url: ajaxurl,

        //NOTE - the action parameter calls the function in functions.php
        data: { action: 'select_course_aj', course_id: course_id, _ajax_nonce: '<?php echo $ajax_nonce; ?>' },

        //display alert on success
        success: function(html){ 
            alert(html);
        } 
    }); //close jQuery.ajax(
    return false;

    });
});
</script> 
```

这是functions.php中的函数

```
function select_course_func(){
echo $_POST["course_id"];
die();
}

add_action('wp_ajax_select_course_aj','select_course_func'); 
```

包含 jquery ajax 调用的页面的 HTML 实际上显示在警报中而不是回显中。

有大神能告诉我为什么吗？

谢谢马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T14:24:43.417

好的，问题解决了。请参阅我上面的最后 3 条评论以及...

**!defined('DOING_AJAX')**是一个常量，可用于测试用户是否在执行 ajax 请求。我将其与将非管理员重定向到前端的逻辑结合起来，现在它可以工作了。

```
/* check the role of current loged in user for redirection */
add_action('admin_init','rt_checkRole');
function rt_checkRole() {

    global $wp_roles;
    $currentrole ='';
    foreach ( $wp_roles->role_names as $role => $name ) {
        if ( current_user_can( $role ) ){
                    $currentrole = $role;
                }
        }
        if(!defined('DOING_AJAX') && (!$currentrole || ($currentrole != 'administrator' && $currentrole != 'editor'))){
            wp_redirect (site_url().'/front-end-login/');
        }
} 
```

[在https://wordpress.stackexchange.com/questions/26100/redirect-out-of-wp-admin-without-losing-admin-ajax-php](https://wordpress.stackexchange.com/questions/26100/redirect-out-of-wp-admin-without-losing-admin-ajax-php)找到有关 !defined('DOING_AJAX') 的信息

感谢所有评论的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T12:04:58.557

如果您想为非管理员用户进行 ajax 调用，您应该使用下面的代码，这将禁止非管理员用户访问 wp-admin，但允许每个用户（登录或注销用户）进行 ajax 调用

```
function my_admin_init(){
    if( !defined('DOING_AJAX') && !current_user_can('administrator') ){
        wp_redirect( home_url() );
        exit();
    }
}
add_action('admin_init','my_admin_init'); 
```

# sql - 按行号连接两个相同大小的结果集

> ID：10217634
> 
> 赞同：8
> 
> 时间：2012-04-18T20:41:35.920
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有两个表函数，每个函数返回一列。保证一个函数返回与另一个函数相同的行数。

我想将这些值插入到一个新的两列表中。一个列将接收来自第一个 udf 的值，第二列来自第二个 udf。插入的顺序将是 udfs 返回行的顺序。

鉴于它们不共享公共密钥，我如何加入这两个 udf？我试过使用 ROW_NUMBER() 但不太明白：

```
INSERT INTO dbo.NewTwoColumnTable (Column1, Column2)
SELECT udf1.[value], udf2.[value]
FROM dbo.udf1() udf1
INNER JOIN dbo.udf2() udf2 ON ??? = ??? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:08:43.087

这对你没有帮助，但是 SQL 不保证行顺序，除非它被明确要求，所以它们将以你期望的顺序返回的想法对于给定的集合可能是正确的，但据我了解基于集合的想法结果，从根本上不能保证正常工作。如果它与保证顺序的东西相关联，您可能希望从 UDF 返回一个键。

尽管如此，您仍可以执行以下操作：

```
declare @val int
set @val=1;

Select Val1,Val2 from 
(select Value as Val2, ROW_NUMBER() over (order by @val) r from udf1) a
join 
(select Value as Val2, ROW_NUMBER() over (order by @val) r from udf2) b
on a.r=b.r 
```

该变量解决了需要按列进行排序的问题。

如果您有编辑 UDF 的权限，我认为更好的做法是已经对来自 UDF 的数据进行排序，然后您可以将其添加`ident int identity(1,1)`到 udf 中的输出表中，这很清楚。

这可能很重要的原因是您的服务器决定将 udf 结果分成两个数据包。如果两者的到达顺序不符合您的预期，SQL 可以按收到的顺序返回它们，这破坏了他 UDF 将按顺序返回行的假设。这可能不是问题，但如果实际系统稍后需要结果，则此处适当的编程可以防止以后出现意外错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:47:32.083

在`SQL`中，“udfs 返回的订单”不能保证持续存在（即使在调用之间）。

尝试这个：

```
WITH    q1 AS
        (
        SELECT  *, ROW_NUMBER() OVER (ORDER BY whatever1) rn
        FROM    udf1()
        ),
        q2 AS
        (
        SELECT  *, ROW_NUMBER() OVER (ORDER BY whatever2) rn
        FROM    udf2()
        )
INSERT
INTO    dbo.NewTwoColumnTable (Column1, Column2)
SELECT  q1.value, q2.value
FROM    q1
JOIN    q2
ON      q2.rn = q1.rn 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-10T09:43:31.467

`WITH ORDINALITY`PostgreSQL 9.4+ 可以使用后缀在 udfs 结果的末尾附加一个 INT8 列

```
-- set returning function WITH ORDINALITY
SELECT * FROM pg_ls_dir('.') WITH ORDINALITY AS t(ls,n);
       ls        | n
-----------------+----
pg_serial       |  1
pg_twophase     |  2
postmaster.opts |  3
pg_notify       |  4 
```

官方文档：[http ://www.postgresql.org/docs/devel/static/functions-srf.html](http://www.postgresql.org/docs/devel/static/functions-srf.html)

相关博客：http: [//michael.otacoo.com/postgresql-2/postgres-9-4-feature-highlight-with-ordinality/](http://michael.otacoo.com/postgresql-2/postgres-9-4-feature-highlight-with-ordinality/)

# html - 如何仅使用 CSS 将 HTML 中的图像大小加倍？

> ID：10217639
> 
> 赞同：13
> 
> 时间：2012-04-18T20:42:19.963
> 
> 标签：html, css

我尝试过在 HTML 中使用：

```
<img src="../Resources/title.png" /> 
```

在 CSS 中：

```
img {
  width: 200%;
  height: 200%;
} 
```

但这会根据图像所在的父标签缩放图像。如果图像是 150 像素 x 150 像素，我想将其缩放为 300 像素 x 300 像素。我希望这适用于所有图像，无论它们的大小或父标签如何。而且我只想使用 CSS。想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T20:49:45.903

您可以使用`scale()`2D 转换来做到这一点，但作为华丽的新 CSS3 功能之一，目前[支持还不完整，您需要供应商前缀](http://caniuse.com/transforms2d)：

```
img {
    -moz-transform: scale(2);
    -ms-transform: scale(2);
    -o-transform: scale(2);
    -webkit-transform: scale(2);
    transform: scale(2);
} 
```

但是我不认为这会考虑到内容的流动，因为转换是在单个元素上完成的，因此不会影响布局。另请参阅[`transform-origin`属性](http://www.w3.org/TR/css3-2d-transforms/#transform-origin-property)。

如果您需要良好的浏览器支持，或者您需要正确重排内容，您将不得不使用替代方案，例如使用 JavaScript 或重组您的 HTML，以便`width`and`height`属性将正确缩放它并影响元素流自然的方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-18T20:45:38.130

您不能仅使用**CSS < 版本 3**。

当您在元素上设置宽度/高度时，它是相对于它的容器的。

* * *

**更新**，因为自发布此答案以来已经有一段时间了。

正如评论者指出的那样，这可以通过简单地使用`zoom`CSS 属性来实现。但是，[不建议](https://css-tricks.com/almanac/properties/z/zoom/)这样做，因为它最初是在 IE6/7 天由 IE 单独实现的，并且[从未正式成为 W3C 标准](https://developer.mozilla.org/en-US/docs/Web/CSS/zoom#wikiArticle)。相反，现在常用的是使用该`scale`函数的 CSS 转换。

有关`scale()`CSS 功能的更多信息： [https ://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/scale](https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/scale)

示例： [https ://jsfiddle.net/2n5zLhz3/](https://jsfiddle.net/2n5zLhz3/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-30T13:57:26.693

您可以将图像包含在*div*中，然后设置其相对于父级的大小。

```
<style type="text/css">
.double{
  display: inline-block;
}

.double img{
  width: 200%;
}
</style>
<div class="double"><img src="../Resources/title.png"></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-06T10:23:30.547

您可以通过从窗口大小中获取所需的百分比来将图像加倍。

```
p > img {
  width:100%;
  height:60vh;
} 
```

“高度：100vh；” 意味着 100% 来自您的浏览窗口。只需计算一下即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-18T23:17:16.647

您可以在图像上使用 min-width 属性来强制您的宽度大于其父 div，例如

```
.parent {
  width: 300px;
  height: 200px;
  overflow: hidden;
}
img {
  min-width: 200%;
  /* center image */
  margin-left: -50%;
  height: auto;
}
```

```
<div class="parent">
  <img src="https://upload.wikimedia.org/wikipedia/commons/b/bc/Information_example_page_300px.jpg" alt=""/>
</div>
```

# c# - 如果我想在我的数据库中找到准确的搜索结果，我应该使用什么来代替“FirstOrDefault()”？

> ID：10217641
> 
> 赞同：2
> 
> 时间：2012-04-18T20:42:27.203
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework

我目前在我的控制器中使用以下代码：

```
Instructor instructor = db.Instructors.FirstOrDefault(
    o => o.UserName == User.Identity.Name); 
```

按用户名选择某人。我的理解是，如果我的用户具有相似的用户名（即当我有名为“MrUserOne”、“MrUserTwo”和“MrUser”的用户时搜索“MrUser”可能会产生“MrUserOne”，我将无法使用“FirstOrDefault()”，因为这是出现的“第一个”搜索结果），如果我对“FirstOrDefault”的未来困难的理解是正确的，我应该使用什么来代替它？

还是我对 FirstOrDefault 将如何工作的理解错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T20:46:18.693

看来您不太了解`==`操作员在这种情况下的工作方式。假设`UserName`和`Name`值都是`string`然后`==`将进行精确的序数匹配。这个名字`"MrUser"`根本不匹配`"MrUserOne"`。它只会匹配`"MrUser"`。

话虽如此，此代码将返回`Name`值完全匹配`o.UserName`或`null`不匹配的第一个用户。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T20:51:29.407

JaredPar 的说法完全正确。但是，如果您期望的结果恰好是一个结果，您也可以使用 SingleOrDefault。您可以在这个 Stackoverflow 问题中阅读更多相关信息：[LINQ: When to use SingleOrDefault vs. FirstOrDefault() with filtering criteria](https://stackoverflow.com/questions/1745691/linq-when-to-use-singleordefault-vs-firstordefault-with-filtering-criteria)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T20:49:32.237

当您使用 == 时，您已经在执行精确的搜索结果。表达方式

```
o => o.UserName == User.Identity.Name 
```

被翻译成

```
WHERE UserName = [Username] 
```

在数据库方面。不要与类似的声明混淆

```
o => o.UserName.Contains(User.Identity.Name) 
```

这将转化为

```
WHERE UserName like '%[Username]%' 
```

请参阅[http://msdn.microsoft.com/en-us/library/bb738681.aspx](http://msdn.microsoft.com/en-us/library/bb738681.aspx)了解如何为 Linq to Entities 转换字符串函数。

话虽如此，您的 FirstOrDefault 将为您提供与您提供的用户名完全匹配的名字。因此，您的示例将匹配名称为“MrUser”的第一个用户。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-18T20:52:29.343

您的查询将只返回第一个`UserName`完全匹配的用户`User.Identity.Name`（它不会匹配以 开头的用户`User.Identity.Name`，正如您所说的那样）。

因此，如果有 2 个同名用户，则返回值将是第一个。并且“第一个”可能会有所不同，具体取决于数据库在将结果返回给您时的感觉（因为您没有指定订单）。

作为旁注，您应该熟悉这 4 种类似的方法，它们值得了解：

```
 >1 result     0 results
First()            return 1st    throw
FirstOrDefault()   return 1st    return null
Single()           throw         throw
SingleOrDefault()  throw         return null 
```

# php - 如何更新重复键上的多个列

> ID：10217644
> 
> 赞同：3
> 
> 时间：2012-04-18T20:42:32.247
> 
> 标签：php, mysql

我有一系列单选按钮插入到数组中的数据库中。这第一次工作正常。

```
$query="INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` ) VALUES ";
        foreach ($params AS $key => $value) {       
            if (( $key != "form_key" ) && ( $key != "stylecolor" ) && ( $key != "key" )){           
                $values[] = "('$sku', '$key', '$value', NOW()) ";       
                }
            }
        $query .= implode(', ', $values) . ';'; 
```

当单选按钮的状态发生变化时，我试图让它更新这些列，所以改变这个：

```
$values[] = "('$sku', '$key', '$value', NOW()) ON DUPLICATE KEY UPDATE value = '$value'"; 
```

如果使用此查询选择的数组中只有一个单选按钮，它将起作用并更新：

```
 INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` )
 VALUES ('1893240720', '1', 'no', NOW()) 
 ON DUPLICATE KEY UPDATE value = 'yes'; 
```

但是，当我选择了多个按钮时，它会中断查询：

```
INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` )
VALUES ('1893300667', '1', 'yes', NOW())
ON DUPLICATE KEY UPDATE value = 'no',
('1893300667', '2', 'yes', NOW()) 
ON DUPLICATE KEY UPDATE value = 'maybe'; 
```

我是否必须单独`INSERT`或如何检查重复项然后更新`value`其各自的`note_id`？这只是语法错误的情况吗？

## 编辑

从到目前为止的答案来看，我似乎不清楚我是否需​​要能够一次更新多个值。`ON DUPLICATE`如果我需要用不同的变量更新多个值，我不明白我怎么能在最后得到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:00:07.947

Zac，是的，您可以通过指定语句一次（最后）来执行此操作：

```
$query = "INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` ) VALUES ";

foreach ($params AS $key => $value) {       
    if (( $key != "form_key" ) && ( $key != "stylecolor" ) && ( $key != "key" )){           
        $values[] = "('$sku', '$key', '$value', NOW()) ";       
    }
}
$query .= implode(', ', $values) . 'ON DUPLICATE KEY UPDATE value = VALUES(value);'; 
```

看：

[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:56:47.680

如果你的主键是 note_id，那么

```
INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` )
VALUES ('1893300667', '1', 'yes', NOW())
ON DUPLICATE KEY UPDATE
`value` = 'no',
style_color = VALUES(style_color),
created_at = VALUES(created_at); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:51:14.123

我相信您只指定一次 ON DUPLICATE KEY UPDATE 。像这样..

```
INSERT INTO `notes_value` ( `style_color`, `note_id`, `value`, `created_at` ) 
VALUES ('1893300667', '1', 'yes', NOW()), 
       ('1893300667', '2', 'yes', NOW()) 
ON DUPLICATE KEY UPDATE value = values(`value`); 
```

编辑：忘记了我添加的第一个 NOW()。编辑：附加值函数以提取列的值。

自从我这样做以来已经有一段时间了，但我相信情况就是这样。

# asp.net-mvc - MVC3、Razor、Html.TextAreaFor()：调整高度以适应内容

> ID：10217651
> 
> 赞同：4
> 
> 时间：2012-04-18T20:43:01.910
> 
> 标签：asp.net-mvc, razor, html-helper

我目前在视图中使用以下代码来调整 Html.TextAreaFor() 的高度以适应其内容。有没有更好的和/或不那么冗长的方法来做到这一点？

```
...
int width = 85;
int lines = 1;
string[] arr = Model.Text.Split(new string[] {"\r\n", "\n", "\r"}, StringSplitOptions.None);
foreach (var str in arr)
{
    if (str.Length / width > 0)
    {
        lines += str.Length / width + (str.Length % width <= width/2 ? 1 : 0);
    }
    else
    {
        lines++;
    }
}
@Html.TextAreaFor(m => m.Text,
                  new
                  {
                      id = "text",
                      style = "width:" + width + "em; height:" + lines + "em;"
                  })

... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:01:30.027

代码看起来不错。一种可能的改进是将其外部化为可重用的助手以避免污染视图：

```
public static class TextAreaExtensions
{
    public static IHtmlString TextAreaAutoSizeFor<TModel, TProperty>(
        this HtmlHelper<TModel> htmlHelper,
        Expression<Func<TModel, TProperty>> expression,
        object htmlAttributes
    )
    {
        var model = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData).Model;
        var text = model as string ?? string.Empty;
        int width = 85;
        int lines = 1;
        string[] arr = text.Split(new string[] { "\r\n", "\n", "\r" }, StringSplitOptions.None);
        foreach (var str in arr)
        {
            if (str.Length / width > 0)
            {
                lines += str.Length / width + (str.Length % width <= width / 2 ? 1 : 0);
            }
            else
            {
                lines++;
            }
        }
        var attributes = new RouteValueDictionary(htmlAttributes);
        attributes["style"] = string.Format("width:{0}em; height:{1}em;", width, lines);
        return htmlHelper.TextAreaFor(expression, attributes);
    }
} 
```

在视图中：

```
@Html.TextAreaAutoSizeFor(m => m.Text, new { id = "text" }) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:46:47.023

看起来不错，您还可以使用[JQuery autogrow textarea 插件](http://www.technoreply.com/autogrow-textarea-plugin/)。

它将为您节省一些编码，甚至可能更有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T21:01:28.213

您可以使用一些 LINQ 魔法将其减少为一行：

```
var lines = Model.Text.Split( new[] { "\r\n", "\r", "\n" }, StringSplitOptions.None )
  .Aggregate( 0, (total, next) => 
    total += next.Length <= width ? 1 
      : (int)Math.Ceiling( (double)next.Length / width ) ); 
```

请注意，您拆分的方式存在一个小问题。如果您的输入中确实有混合`\n`的`\r`, 和`\r\n`line 结尾（不太可能），则此拆分将按从左到右的顺序拆分，因此它永远不会在 string 上拆分`\r\n`，这意味着 the`\r`和 the之间有一个空行`\n`。所以你会看到我将 移动`\r\n`到拆分中的第一个字符串。

# web-services - ESB / BPEL / 人工工作流选项

> ID：10217654
> 
> 赞同：0
> 
> 时间：2012-04-18T20:43:13.043
> 
> 标签：web-services, workflow, esb, bpel

我的项目目前使用带有 SOA（BPEL/人工工作流）组件的 Oracle 应用服务器。

由于该产品的生命周期结束，我们正在评估提供类似功能的商业和开源替代品。

在人员工作流程方面——具体来说，我们需要能够：

*   分配
*   拒绝
*   收回
*   代表
*   升级
*   并列出由/分配给特定用户的项目（任务的收件箱/发件箱）

注意：该解决方案不需要为这些功能提供 UI，它们必须通过框架库/API 可用。我们有自己的 UI 来向用户展示这些功能。

Oracle OFM (WebLogic) 和 IBM (WebSphere) 具有成熟的等效产品，可提供所有必需的功能。许可证成本是我们需要注意的一个考虑因素。

jBoss (jBPM) 是另一种可用作开源解决方案的选项。

WSO2 看起来像是一组很有前途的开源组件（主要是 Apache 堆栈），但 Human Workflow 组件要到今年 6 月才能使用。

你有什么其他的替代方案，提供上述所有功能，你有经验吗？你会推荐哪个？您在特定解决方案中遇到了哪些缺点（如果有的话）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T05:04:33.760

您可以使用[WSO2](http://wso2.com/)中间件堆栈来满足您的要求，但 WS-HumanTask 支持将在下一个版本中提供。我们已经在主干中实现了 WS-HumanTask 规范的主要功能。如果您需要试用，我们可以将您指向来自我们的构建器机器的快照构建 - [http://builder4.us1.wso2.org:8888/bamboo/artifact/WSO2CARBON-PRODUCTS/JOB1/build-51/BPS/ wso2bps-3.0.0-SNAPSHOT.zip](http://builder4.us1.wso2.org:8888/bamboo/artifact/WSO2CARBON-PRODUCTS/JOB1/build-51/BPS/wso2bps-3.0.0-SNAPSHOT.zip)。

我个人认为 jBPM 不是一个好的解决方案，因为它不可移植（即不符合 WS-BPEL 规范或 WS-HumanTask 规范）。您最好选择符合标准的工作流引擎，以便您从开放标准中受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T22:20:48.460

```
Eclipse + BPEL + Tomcat + ODE + HISE 
```

[http://www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)
[http://www.eclipse.org/bpel/](http://www.eclipse.org/bpel/)
[http://tomcat.apache.org/](http://tomcat.apache.org/)
[http://ode.apache.org/user-guide.html](http://ode.apache.org/user-guide.html)
[http ://incubator.apache.org/hise/](http://incubator.apache.org/hise/)

Apache ODE (Orchestration Director Engine)
Apache HISE - WS-Human-Task 规范的开源实现

您将 HISE Web 服务部署到 ODE，然后从您的 BPEL 流程调用它们，也部署到 ODE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T02:41:46.093

看看用于集成层的[UltraESB](http://www.adroitlogic.org)和作为工作流引擎的[jBPM 。](http://www.jboss.org/jbpm)

UltraESB 被认为是性能最好的开源 ESB，如[http://esbperformance.org](http://esbperformance.org)的性能测试结果所示。性能测试套件也可作为开源工具使用，因此您也可以自己测量它。

# wpf - 如何在 WPF 中跨用户控件同步动画

> ID：10217657
> 
> 赞同：7
> 
> 时间：2012-04-18T20:43:26.757
> 
> 标签：wpf, animation, synchronization

我在包装面板中创建了几个用户控件。我有一个绑定到用户控件的视图模型，并且我有一个动画触发到视图模型中的属性。非常简单的将颜色从红色切换为透明以模拟闪烁。

```
<Storyboard x:Key="alertAnimation" RepeatBehavior="Forever" AutoReverse="True" >
    <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                  Storyboard.TargetName="TileBorder"
                                  BeginTime="00:00:00"
                                  RepeatBehavior="Forever"
                                  AutoReverse="True"
                                  >
        <DiscreteColorKeyFrame Value="Red"/>
        <DiscreteColorKeyFrame KeyTime="00:00:00.500" Value="Transparent" />
    </ColorAnimationUsingKeyFrames>

</Storyboard> 
```

这工作得很好。但是，由于我异步加载多个用户控件，闪烁动画不同步，因此它们都在不同时间闪烁。现在要求屏幕上闪烁的任何东西都需要以相同的速率/时间闪烁。有没有办法同步这些动画？我似乎无法在任何地方找到适合我想要完成的示例。有没有办法使用 ParallelTimeline，将所有动画添加到其中并从单个控制器启动/停止它们？有什么例子可以做到这一点吗？

编辑 4/20 在 style.xaml 文件中定义动画并有一个“全局”故事板，每个控件都将其“闪烁”动画添加到其中并让主 UI 启动故事板会更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T18:25:34.823

我找不到跨多个用户控件控制多个动画的好方法，所以我最终没有在用户控件中使用动画，而是使用动画来简单地更改静态对象中的依赖属性，并让所有需要以某种方式闪烁的用户控件绑定到那个属性。有多种方法可以产生我想要的结果，但最终我现在有一种方法可以让我的所有控件知道闪烁何时打开然后关闭，以便一切都同步。

我从以下站点得到了这个想法和示例代码： [How to synchronize animations across usercontrols in wpf](http://dotnetlearning.wordpress.com/2009/10/05/synchronizing-animations-across-different-threads/)

我对其进行了一些修改，但总的来说它完全符合我的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T13:41:28.177

显然这需要修改，但是在颜色转换上尝试 0 的持续时间可能会给您带来更少开销的闪烁。它可能不会。只是要尝试的东西。

```
 <Rectangle Name="MyRectangle" Width="100" Height="100">
        <Rectangle.Fill>
            <SolidColorBrush x:Name="MySolidColorBrush" Color="Blue" />
        </Rectangle.Fill>
        <Rectangle.Triggers>
            <EventTrigger RoutedEvent="Rectangle.MouseEnter">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation 
            Storyboard.TargetName="MyRectangle"
            Storyboard.TargetProperty="Width"
            From="100" To="200" Duration="0:0:1" />

                        <ColorAnimation 
            Storyboard.TargetName="MySolidColorBrush"
            Storyboard.TargetProperty="Color"
            From="Blue" To="Red" BeginTime="0:0:1"  Duration="0:0:0"  />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Rectangle.Triggers>
    </Rectangle> 
```

# facebook - 实现 Facepile

> ID：10217659
> 
> 赞同：0
> 
> 时间：2012-04-18T20:43:33.740
> 
> 标签：facebook

**由于某种原因，我无法**在我的 Wordpress 网站上实现 Facepile。在此之前我实际上已经尝试过一段时间并且没有这样的运气，我知道每个人都会将我指向文档，但我已经通读了它，并通过“Facebook Developers Facepile 屏幕”输入了我的凭据。

我插入了我的 facebook 页面的 URL，是的，有很多人喜欢这个页面。我还尝试插入完整的独立网站 URL。我还尝试插入“个人 facebook 页面链接”，而不是您喜欢的页面。我尝试使用 HTML5 粘贴生成的 iFrame，并按照说明添加自定义操作，并尝试使用在线教程。

我更喜欢将 iFrame 拖到我的侧边栏上。但是，如果我必须使用 WP 插件，我需要一个带有简码的插件，因为我的主题还没有准备好小部件。

即使在 Facepile 屏幕上，我也无法让生成器/预览甚至加载它。我在这里做错了什么？

**编辑，EG - 为什么这不起作用？**

```
<iframe src="//www.facebook.com/plugins/facepile.php?href=http%3A%2F%2Fwww.osmproduction.com%2FRIF%2F&amp;action&amp;size=small&amp;max_rows=1&amp;width=300&amp;colorscheme=light&amp;appId=380729875300495" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:300px;" allowTransparency="true"></iframe> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:55:59.793

> “是的，有很多人喜欢这个页面。”

我认为您将 FacePile 与 Like 插件混淆了。

Facepile (https://developers.facebook.com/docs/reference/plugins/facepile/) 仅适用于您通过应用程序与它们关联的操作的网站页面。动作是由冒号分隔的一对动词名词。因此，如果您有一个可以从您的站点发布到 Facebook 的自定义操作，请说：test-drive:truck，并且如果某个用户已将该操作发布到他们的 Facebook 流，那么它应该显示在 Facepile 插件中。

Like 插件（https://developers.facebook.com/docs/reference/plugins/like/）适用于有人喜欢您的网站页面。

# linux - 使用 bash、sed 或 awk 拆分 CSV 文件并排除输出中的列

> ID：10217663
> 
> 赞同：3
> 
> 时间：2012-04-18T20:43:40.343
> 
> 标签：linux, bash, csv, sed, awk

我有一个 CSV 文件，其中包含如下数据：-

```
1,275,,,275,17.3,0,"2011-05-09 20:21:45"
2,279,,,279,17.3,0,"2011-05-10 20:21:52"
3,276,,,276,17.3,0,"2011-05-11 20:21:58"
4,272,,,272,17.3,0,"2011-05-12 20:22:04"
5,272,,,272,17.3,0,"2011-05-13 20:22:10"
6,278,,,278,17.3,0,"2011-05-13 20:24:08"
7,270,,,270,17.3,0,"2011-05-13 20:24:14"
8,269,,,269,17.3,0,"2011-05-14 20:24:20"
9,278,,,278,17.3,0,"2011-05-14 20:24:26" 
```

该文件包含 4432986 行数据。

我希望根据最后一列中的日期将新文件名拆分出来。

因此，根据上面的数据，我想要 6 个新文件，每个文件中每天都有行。

我想要以 YYYY_MM_DD 格式命名的文件。

我也想忽略输出数据中的第一列

因此文件 2011_05_13 将包含以下行，第一列除外：-

```
272,,,272,17.3,0,"2011-05-13 20:22:10"
278,,,278,17.3,0,"2011-05-13 20:24:08"
270,,,270,17.3,0,"2011-05-13 20:24:14" 
```

我打算在 linux 机器上执行此操作，所以使用任何 linux 实用程序的任何东西都会很酷，sed awk 等？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:07:06.127

这是一个适合您的单行代码`awk`：

`awk -F "," '{ split ($8,array," "); sub ("\"","",array[1]); sub (NR,"",$0); sub (",","",$0); print $0 > array[1] }' file.txt`

实现了所需的输出，尽管也许其中一些代码可以更简洁。HTH。

**编辑：**

从左到右阅读代码：

*   `-F ","`
    是的，这设置了分隔符。

*   `split ($8,array," ")`
    这会拆分空间上的第八列，并将此信息放入一个名为 的数组中`array`。

*   `sub ("\"","",array[1])`
    我们取第一个数组元素（这是一个将成为我们的输出文件名的切片）并替换掉前导`"`符号（我们需要对`"`符号进行转义，因此我们将`\`字符放在前面）。

*   `sub (NR,"",$0)`
    这可以方便地从文件开头删除行号（`NR`是行号`$0`，当然是分隔之前的整行输入）。

*   `sub (",","",$0)`
    这将删除行号后的逗号。

*   现在我们有了一个干净的文件名和一行干净的数据，我们可以`$0`写入`array[1]`: `print $0 > array[1]`。

**使固定：**

因此，如果您更喜欢下划线而不是hypon，我们需要解决的只是`array[1]`. 我刚刚添加了一个全局替换：`gsub ("-","_",array[1])`.

更新后的代码是：

`awk -F "," '{ split ($8,array," "); sub ("\"","",array[1]); gsub ("-","_",array[1]); sub (NR,"",$0); sub (",","",$0); print $0 > array[1] }' file.txt`

HTH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:11:51.900

你可以使用这个 awk 命令：

```
awk -F, 'BEGIN{OFS=",";} {dt=$8; gsub(/^"| .*"$/,"", dt);
$1=""; sub(/^,/, "", $0); print $0 > dt}' input.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:57:51.640

脚本语言（perl/python）可能是您最好的选择，但我喜欢在 bash 中执行此操作的挑战，所以就在这里。

```
 cat bigfile.txt | while read LINE;
  do echo $LINE >> `echo $LINE | cut -d, -f8 | cut -c2-11`.txt ;
 done 
```

基本上，它的作用是在循环中逐行读取文件`while`，然后根据日期将该行附加到文件中。

`cut`使用两个命令的组合提取日期。第一个`cut`使用逗号分隔符 ( ) 拉出最后一列（第 8 列`-d,`），然后第二个`cut`通过删除第一列仅拉出日期`"`，然后直到字符 11。

* * *

现在，要解决删除第一列的问题：

```
cat bigfile.txt | sed 's/^.*?,//' 
```

这个正则表达式只是删除第一个逗号之前的所有内容。

因此，我们将用这个替换 while 循环的开头，留下：

```
 cat bigfile.txt | sed 's/^.*?,//' | while read LINE;
  do echo $LINE >> `echo $LINE | cut -d, -f8 | cut -c2-11`.txt ;
 done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T20:58:35.853

这个怪物会抓取所有唯一的日期，然后用 greps 查找原始文件中的这些键，并将它们保存到由该键命名的文件中。是的，猫没用，但试图原子化动作。

```
cat records.txt \
| cut -f8 -d, \
| cut -f1 -d ' ' \
| tr -d '"' \
| sort -u \
| while read DATE ; do \
    cat records.txt \
    | cut -f2- -d, \
    | egrep ",\"${DATE} [0-9]{2}:[0-9]{2}:[0-9]{2}\"" \
    > ${DATE}.txt
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T21:12:00.200

一定很简单

```
$ sed 's/^[0-9]*,//' your_gigantic_data.csv 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T22:36:05.467

这可能对您有用：

```
sed 's/^[^,]*,\(.*"\(....\)-\(..\)-\(..\).*\)/echo \1 >>\2_\3_\4.csv/' file | sh 
```

或 GNU sed：

```
sed 's/^[^,]*,\(.*"\(....\)-\(..\)-\(..\).*\)/echo \1 >>\2_\3_\4.csv/e' file 
```

# javascript - 隐藏/显示内容时出现 jQuery.ScrollTo 插件问题

> ID：10217668
> 
> 赞同：0
> 
> 时间：2012-04-18T20:44:13.713
> 
> 标签：javascript, jquery, scrollto

我正在使用[Arial Flesler 的 ScrollTo 插件](http://demos.flesler.com/jquery/scrollTo/)水平滑动页面的“部分”。

在这种情况下，我不想滑过所有部分。我希望我的部分从一个滑到另一个，而不显示中间的其他部分。

我设置了一个 jsFiddle 来更准确地描述它：http: [//jsfiddle.net/PWj4B/2/](http://jsfiddle.net/PWj4B/2/)

我正在做的是隐藏除当前可见的部分之外的所有部分，显示与我单击的锚点相对应的部分，然后滚动到该部分。

出于某种原因，当我尝试多次向同一方向滑动时，滑动不起作用。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:27:56.277

我相信问题正在发生，因为`div`出现并立即替换了 current 的位置`div`。（当它在当前 div 的右侧时，你的低 div 被向左推。当它在你当前 div 的左边时，高 div 被向右推。）

这个插件不是为了做你要求的，我不认为。

怎么样... [http://jsfiddle.net/PWj4B/4/](http://jsfiddle.net/PWj4B/4/)

它为您的幻灯片提供绝对位置，并将您的目标幻灯片放置在蒙版的左侧或右侧。然后它同时为当前幻灯片和目标幻灯片设置动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:03:28.030

试试这个而不是隐藏元素。 [http://jsfiddle.net/q8JFM/1/](http://jsfiddle.net/q8JFM/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:57:55.413

正如**stuard**指出的那样，`div`s 被推到一边，所以我意识到我可以简单地滚动到当前`div`，然后滚动到目标`div`，如下所示：http: [//jsfiddle.net/PWj4B/5/](http://jsfiddle.net/PWj4B/5/)

# ruby - 如何在 Ruby 中执行另一种方法时使用一种方法中的局部变量？

> ID：10217676
> 
> 赞同：0
> 
> 时间：2012-04-18T20:44:42.567
> 
> 标签：ruby

所以基本上我正在做的是创建一个我从特定 url 解析的 URL 列表......在这种情况下，基本 url 是局部变量`url`。

我想要做的是，传递`url`给`my_list`- 现在工作正常......但是一旦我有了那个列表，我就想将方法中`list`声明的数组的第一个元素传递`my_list`给方法`add_category`。

见代码：

```
def add_category(url)
    new_url = url + '/web'  
end

url = 'http://www.someurl.com'

def my_list(url)
    root = Nokogiri::HTML(open(url))
    list = root.css("a").map do |link|
        [link.text, link[:href]]           
      end

end

my_list(url)

add_category(list[0]) 
```

我要去的地方是，我想根据我在方法`list`中指定的规则修改数组中的每个URL。`add_category`

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:48:58.057

您不能从外部引用方法的局部变量。他们被称为“*本地*”是有原因的！:)

看来您的`my_list`方法只是生成一个稍后要使用的列表。因此，将其返回值保存到局部变量（在调用者范围内）并根据需要使用。看一下这个：

```
def add_category(url)
    url + '/web'  
end

url = 'http://www.someurl.com'

def my_list(url)
    root = Nokogiri::HTML(open(url))
    root.css("a").map do |link|
        [link.text, link[:href]]           
    end
end

list = my_list(url)

new_url = add_category(list[0][1]) 
```

# c# - 将 float[] 作为 ref float 传递给非托管代码是个好主意吗？

> ID：10217677
> 
> 赞同：8
> 
> 时间：2012-04-18T20:44:47.997
> 
> 标签：c#, c, arrays, marshalling

我想将 float[] 传递给 C 方法。C 签名如下所示：

```
EXTERN int process_raw(float *inBuffer, float *outBuffer); 
```

在 C# 中，签名是：

```
public static extern int process_raw(ref float inBuffer, ref float outBuffer); 
```

将带有 ref 的数组传递给第一个成员会不会有问题：

```
process_raw(ref someArray[0], ref anotherArray[0]) 
```

谢谢！

编辑：当然，了解 C 代码对浮点数的作用很重要：它将它们视为数组，并从 inBuffer 读取值并将值写入 outBuffer。如下所述，问题是在 PInvoke 调用期间是否会固定整个内存？

编辑2：另一条评论。我故意选择了 ref 浮动，因为我也想做一些事情，比如：

```
fixed(byte* outBuff = buffer)
{
    Process(ticks, ref aFloat, ref ((float*)outBuff)[0]);
} 
```

在这种情况下应该没问题，因为无论如何指针都是固定的，但是上面的普通数组的问题仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:24:07.333

p/Invoke 中不涉及自动 pin。P/Invoke 严格通过*编组*执行！（没有不安全的代码）编组意味着分配（非托管）内存和复制。在掩护下，在复制期间可能有一个 pin，但在本机函数调用期间没有。

如果您需要将一个包含 64 个浮点数的数组传入和传出本机函数，您有两种选择：

1.  马歇尔通过。
2.  使用不安全代码直接固定和传递托管内存。

这是编组的方法：

```
[DllImport(...)]
private extern static int process_raw([In] float[] inBuffer, [Out] float[] outBuffer); 
```

请注意，我添加了 [In] 和 [Out] 属性，因为它们告诉 Marshaller (In) 不要在输出时复制，而 (Out) 在输入时不要复制。最好始终考虑这些属性编写 ap/invoke 声明。

这是不安全的方法：

```
[DllImport(...)]
private extern static unsafe int process_raw(float * inBuffer, float * outbuffer);

public static unsafe int Process(float[] inBuffer, float[] outBuffer)
{
    // validate for null and Length < 64
    fixed (float * pin = inBuffer)
    fixed (float * pout = outBuffer)
        return process_raw(pin, pout);
} 
```

**扩展评论**

据我了解，Marshaller 能够“在某些情况下”选择固定托管内存，而不是分配非托管内存和复制。问题是：什么情况？

我不知道答案，但我有一个怀疑：当本机 DLL 是某些系统 DLL 时。这只是一个猜测。

这对你我意味着什么很简单：总是从编组方法开始。如果您遇到性能问题并且分析器告诉您本机调用正在消耗大量时间，那么您可以尝试不安全的方法并再次对其进行分析。如果没有明显改善，那么你唯一的希望就是优化原生调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T20:48:27.087

您在这里尝试做的事情有点模棱两可。本机代码可以将`float*`视为指向一个值`float`或一个值数组的指针`float`。

如果本机代码认为它是指向单个的指针，`float`那么您的代码就可以了。在本机`float`中拥有`ref`托管和指针将正确编组。

如果本机代码认为它是一个值数组，`float`那么您很可能有问题。这将在极端情况下工作，它将其视为长度为 1 的数组。对于任何其他长度，尽管您需要在托管签名中使用实际数组

```
public static extern int process_raw(float[] inBuffer, float[] outBuffer); 
```

# javascript - jQuery/JavaScript 在控制台中运行并显示在源代码中但不在 joomla 中运行

> ID：10217681
> 
> 赞同：0
> 
> 时间：2012-04-18T20:45:09.727
> 
> 标签：javascript, jquery, joomla, virtuemart

这都在模板的标题中：

```
<script type="text/javascript" src="<?php echo $this->baseurl ?>/libraries/featuredimagezoomer.js"> 
```

...

```
<script type="text/javascript">
var $j = jQuery.noConflict();
$j(document).ready(function($){
 $j('.main-image img:first').attr('ID', 'zoom');
 image = $j('.main-image img:first').attr('src');
 console.log(image);

$j('#zoom').addimagezoom({
zoomrange: [3, 10],
magnifiersize: [300,300],
magnifierpos: 'right',
cursorshade: true,
largeimage: image
})  })
</script> 
```

它可以从控制台运行，但我必须手动输入外部 JS 文件，即使它显示在 chrome/webkit 的“脚本”选项卡下。它甚至出现在源代码中，但由于某种原因没有运行。

站点正在运行 Joomla 1.7.3 并具有 measuremart 插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:25:30.387

所以，从本质上讲，我最终在评论中回答了这个问题。总结一下，最终的解决方案基本上是：“应用调试策略，例如使用 console.log 来检查您的假设并找出问题所在”。如果您遇到与此问题类似的问题，您*可能*想阅读评论，但它的细节与 thebeefytaco 的具体案例完全不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:48:22.787

由于 VirtueMart，您可能两次运行 JQuery。**[关闭](http://dev.virtuemart.net/projects/virtuemart/wiki/General_JS-Problems_with_templates_and_jQuery)**其中一个。

# sharepoint - SharePoint 中的业务数据连接拒绝

> ID：10217687
> 
> 赞同：1
> 
> 时间：2012-04-18T20:45:55.400
> 
> 标签：sharepoint, web-parts, bcs

我实际上使用 BCS 连接到外部内容，我可以在 SharePoint 中看到该列表，但是当我尝试通过 VS Web 部件使用该列表时，我收到此连接错误，但是当我从加载事件调用列表时会发生这种情况当我从 button_click 事件中调用它时，它工作得很好，请一些帮助将不胜感激，这里是代码：

```
protected void Page_Load(object sender, EventArgs e)
        {
            if(!Page.IsPostBack) loadPeoplesBDay();
        }

public void loadPeoplesBDay()
        {
            if (WebPart.List == null) return;

            SPWeb Web = SPContext.Current.Web;
            SPList List = Web.Lists[WebPart.List];

            var q = List.Items;
            var onomasticos = from persona in q.Cast<SPItem>()
                              where Convert.ToDateTime(persona["FE_NACI_TRAB"]).Month == DateTime.Now.Month
                              orderby Convert.ToDateTime(persona["FE_NACI_TRAB"]).Day ascending
                              select new { Nombre = persona["NO_TRAB"] + " " + persona["NO_APEL_PATE"] + " " + persona["NO_APEL_MATE"], Area = persona["DE_SECC"], DiaNacimiento = Convert.ToDateTime((Convert.ToDateTime(persona["FE_NACI_TRAB"]).Day + "/" + DateTime.Now.Month + "/" + DateTime.Now.Year)), Mes = persona["FE_NACI_TRAB"] };

            dlst_Onomasticos.DataSource = onomasticos;
            dlst_Onomasticos.DataBind();
        } 
```

# android - 可以包含在 android 地图应用程序中的地图类型

> ID：10217690
> 
> 赞同：1
> 
> 时间：2012-04-18T20:46:10.140
> 
> 标签：android, mapping, maps, osmdroid, mapserver

我听说过位图、光栅图和矢量地图也可以支持（或从服务器请求）哪些地图类型的地图还有地图瓦片，我知道谷歌地图和 osmdroid（osm android 映射 api）使用地图瓦片和当我使用移动地图集从 osm mapnik 下载地图时，瓷砖被下载为 .png 文件（图像）我想知道服务器可以提供哪些其他类型的地图（并使用 osmdroid 显示）因为我想开发离线工作的安卓地图应用程序，让用户包含他/她想要的地图？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:03:12.343

你在这里混淆了东西：

只有两种方式来表示地图数据。

*   通过地图的图像
*   通过矢量数据（GPS 坐标，当组合到线等时会产生地图）

您命名的所有地图类型（矢量地图除外）都是用于表示地图的图像的不同名称。“位图”甚至是常规图像（这就是 .bmp 文件的名称），实际上与地图无关。由于地图的完整图像非常大（一些 TB？），您将图像切割成图块并仅传输这些图块。那是一个地图图块。

使用矢量数据是不切实际的（尤其是对于移动设备），因为您必须自己渲染地图图像。由于这比下载图像花费的时间更长，因此您拥有 google / osm 并且可能所有其他地图服务都使用图像而不是矢量数据。

# c++ - 不友好的数字 c++

> ID：10217695
> 
> 赞同：0
> 
> 时间：2012-04-18T20:46:37.730
> 
> 标签：c++, algorithm

在 interviewstreet 上有一个叫做 UnfriendlyNumbers 的问题。问题是这样的——

有1个友好号码和N个不友好号码。我们想找出有多少数字正好整除友好数字，但不整除任何不友好数字。样本输入：8 16 2 5 7 4 3 8 3 18 样本输出：1

我可以想象的所有测试用例都正确执行，但由于某种原因，网站认为一组测试用例不正确。你们在代码/逻辑中看到任何错误吗？

```
void get_factors(unsigned long n, vector<unsigned long> &factors)
{
    unsigned long sqrt = pow(n, 0.5);
    for (unsigned long i = 1; i < sqrt; i++) {
        if (n%i == 0) {
            factors.push_back(i);
            factors.push_back(n/i);
        }
    }
    if (n%sqrt == 0) {
        factors.push_back(sqrt);
    }
}

int
main(int argc, char *argv[])
{
    unsigned int n; 
    unsigned long k, j;
    cin >> n >> k;

    if (n == 0 || k == 0) {
        cout << 0 << endl;
        return 0;
    }

    set<unsigned long> unfriendly;
    for (int i = 0; i < n; i++) {
        cin >> j;
        unfriendly.insert(j);
    }

    vector<unsigned long> factors;
    get_factors(k, factors);

    unsigned int count = factors.size();
    for (int i = 0; i < factors.size(); i++) {
        for (set<unsigned long>::iterator it = unfriendly.lower_bound(factors[i]); 
             it !=  unfriendly.end();
             it++)
        {
            if (*it % factors[i] == 0) {
                count--;
                break;
            }
        }
    }
    cout << count;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:54:19.430

你`get_factors`的不正确。对于像 30 或 35 这样的数字，省略了一些除数。

`sqrt`是不超过平方根的最大整数，但是当`n == sqrt*(sqrt+1)`或时`n == sqrt*(sqrt+2)`，您不记录`sqrt+1`相应的。`sqrt+2`作为除数。

此外，还有可能

```
unsigned long sqrt = pow(n, 0.5); 
```

`n`如果足够大可能会产生错误的结果，最好调整它

```
while(sqrt > n/sqrt) --sqrt;
while(sqrt+1 <= n/(sqrt+1)) ++sqrt; 
```

而且，可能`unsigned long`还不够大，无法安全使用`unsigned long long`。

除此之外，我看到的唯一可能失败的是任何数字为 0。

```
 for (set<unsigned long>::iterator it = unfriendly.lower_bound(factors[i]); 
         it !=  unfriendly.end();
         it++) 
```

如果不友好的数字为 0，将失败；如果友好号码为 0，则所有投注都关闭（如果任何不友好号码为 0，则答案为 0，否则为无穷大）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T12:55:09.600

使用 GCD 获取不友好数和友好数 K 之间的公约数。上）

然后在 O(sqrt(K)) 中得到 K 的除数。

循环k的cmn_div和div，得到O(N*sqrt(K))的答案

# c# - 使用属性向方法添加参数

> ID：10217698
> 
> 赞同：2
> 
> 时间：2012-04-18T20:46:43.123
> 
> 标签：c#, aop, custom-attributes

诚然，这是一个远射。我正在做一个审计工作，您可以在操作开始和结束时打开和关闭审计记录。我已经很好地安装了它，因此为了审计一个方法，你只需要`[Audit(AuditType.Something)]`在它上面添加一个属性，如果需要的话，加上一些其他信息，比如消息。然后，使用 SNAP，我有一个拦截器来处理创建审计对象，然后打开和关闭它。

一位同事提出了一个案例，我们需要在审计中包含非常量消息，这意味着它不能进入​​属性声明。我曾想过在类中保留一个 Audit 属性并在让方法继续之前让注入器设置它，但这似乎很草率，因为该属性可以被非审计对象访问，而且它会在很多中重复地方。也有一些方法可以在没有属性的情况下创建审计，但是能够将事物很好地包装在属性中会更好。

理想的情况是，如果我能以某种方式对其进行设置，以便具有该`[Audit]`属性的方法可以访问一个变量，我可以将其审计对象从注入器中插入。这是完全可能的，还是只是一厢情愿？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:53:17.103

如果您的 Audit 属性采用 type 的参数`Type`，其中提供的`Type`实现了一个生成您的审计消息的接口，该怎么办？例如：

```
public interface IAuditMessageProvider {
    public String MakeMeAnAuditMessage(/* some args perhaps */);
}

public class PiAuditMessageProvider : IAuditMessageProvider {
    public String MakeMeAnAuditMessage() { return "3.14"; }
}

[Audit(typeof(PiAuditMessageProvider))]
public void myMethod { ... } 
```

然后您可以使用 实例化提供的类型`Activator.CreateInstance`，将其强制转换为`IAuditMessageProvider`，然后调用相关方法。

# .net - 尝试通过 https 设置 WCF 服务时出错

> ID：10217699
> 
> 赞同：1
> 
> 时间：2012-04-18T20:46:44.043
> 
> 标签：.net, wcf, web-services, web

我正在尝试通过 https 设置 WCF 服务。但是我不断收到错误消息：*“找不到与具有绑定 BasicHttpBinding 的端点的方案 https 匹配的基地址。注册的基地址方案是 [http]。”*

这是我的 web.config 文件的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    ...
<behaviors>
  <serviceBehaviors>
    <behavior name="MyServiceBehavior">
      <serviceMetadata httpsGetEnabled="true" />
    </behavior>
  </serviceBehaviors>
</behaviors>
<services>
  <service name="SoftwareMyService.MyService" behaviorConfiguration="MyServiceBehavior">
    <host>
      <baseAddresses>
        <add baseAddress="https://........./" />
      </baseAddresses>
    </host>
    <endpoint address="" binding="basicHttpBinding" bindingConfiguration="StreamedHttp" contract="SoftwareMyService.IMyService" />
    <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
  </service>
</services>
<bindings>
  <basicHttpBinding>
    <binding name="StreamedHttp" transferMode="Streamed" maxReceivedMessageSize="2147483647">
      <security mode="Transport">
      </security>
    </binding>
  </basicHttpBinding>
</bindings>
</system.serviceModel>
</configuration> 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:52:06.417

我希望这至少有一个 MyService.svc 值。

```
<endpoint address="" binding="basicHttpBinding" 
  bindingConfiguration="StreamedHttp" contract="SoftwareMyService.IMyService" /> 
```

# deployment - 通过各种 SharePoint 包部署不同版本的通用程序集？

> ID：10217703
> 
> 赞同：0
> 
> 时间：2012-04-18T20:47:15.903
> 
> 标签：deployment, sharepoint-2010, shared-libraries, gac, conflict

我有 Common.dll 由（远远超过）两个 SharePoint 包共享/使用，这些包部署到单个 SharePoint 实例使用的同一个 GAC。共享程序集从产品部署演变为产品部署，它本身并不被视为产品。它本身没有发布。它仅在其他 SharePoint 产品/包的上下文中发展。

通用程序集主要只是高度可重用代码的存储库。它仅由一小部分内部开发人员团队使用。

分支/合并允许各种产品在适合开发人员时采用最新版本的 Common.dll。每个产品的开发工作都安排了承担新版本 Common.dll 的风险。

我的需要是让这些程序集从产品到产品——从 SharePoint 包到 SharePoint 包，独立运行。

但这并没有发生。相反，每次我部署时，Common.dll 都会在 GAC 中被覆盖，这样所有使用它的产品都会收到这个最新版本的 Common.dll 的行为。根据该行为是什么，它可能会破坏一段时间未部署的产品。

我试图阻止这种部署“惊喜！” 可能无需将 Common.dll 视为必须小心避免破坏性更改/等的公共产品。

在将各种 SharePoint 包部署到单个 SharePoint 实例的 GAC 时，您使用什么技术来保留不同版本的通用程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:47:46.683

我们在通用程序集的 Visual Studio 项目的预构建事件中使用此命令：

```
if not "$(SolutionName)" == "ABC" if not "$(TargetFileName)" == "$(ProjectName).$(SolutionName).dll" exit 1 
```

当通用程序集被各种产品消耗时，此预构建命令不必更改。当您将“ABC”替换为*通用程序集的解决方案文件*的名称时，它的内容如下：

> 如果我们在自己的解决方案中编译通用程序集（这种情况很少见，但确实会发生），则无需考虑 - 编译掉！否则，除非有人根据消费产品的 Visual Studio 解决方案文件名重命名公共程序集，否则生成失败。

为了避免构建失败，我们在将公共程序集分支到消费产品的代码库后重命名它（通过公共程序集项目的属性页）。公共程序集的项目*名称*在解决方案资源管理器中*未*更改，其默认命名空间在其属性页中也未更改。只有“程序集名称”更改。因此，除了已经做出的特定于产品的更改之外，维护和使用公共代码总是让人感觉很熟悉：无论您正在开发什么产品，解决方案资源管理器和命名空间都保持不变。

重命名会更改通用程序集项目文件中的一行，这会在您合并回主干（和/或稍后，当您*从*主干合并到其他产品时）产生摩擦。

*如果*公共项目文件进入 ProductB 的代码库，同时仍将其程序集命名为 ProductA，则其预构建命令将阻止在 ProductB 中编译，那里的开发人员可以轻松更改“程序集名称”以允许编译。这种摩擦机会增加的越多，你合并的越多。

每次新的 SharePoint 产品到达 GAC 时，通用程序集都会在 GAC 中获得一个唯一的名称（和实例）。各种产品可以使用、发展和部署通用程序集，而不必担心在部署时突然破坏其他产品/包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T06:30:30.917

版本控制和[绑定重定向](http://msdn.microsoft.com/en-us/library/7wd6ex19%28v=vs.90%29.aspx)在这里可能会有所帮助。根本问题似乎是 Visual Studio 对强名称缺乏一致的标记化。与其创建一个涉及源代码控制的复杂解决方法，不如创建一个简单的工具来更新给定项目文件中的所有公共程序集引用。这解决了根本问题，而不会产生其他不必要的成本。

# objective-c - 使用 for-each 遍历双打列表在 Objective-C 中不起作用

> ID：10217705
> 
> 赞同：0
> 
> 时间：2012-04-18T20:47:17.973
> 
> 标签：objective-c, foreach, double, iteration, variadic-functions

我正在研究一种在Objective-C中平均任意多个数字的方法，这是我迄今为止的方法：

```
-(double)average:(double)num, ...
{
    va_list args;
    va_start(args, num);

    double currentAverage = num;
    long long timesAveraged = 1;
    for(double d in args)
        currentAverage = ((currentAverage * timesAveraged) + d) / ++timesAveraged;//Error occurs on this line
    return currentAverage;

} 
```

但是，当我编译它时，我收到一个错误，指出“ `Selector element does not have a valid object type`”，所以我的第一个解决方案是将方法更改为以下内容：

```
-(double)average:(double)num, ...
{
    va_list args;
    va_start(args, num);

    double currentAverage = num;
    long long timesAveraged = 1;
    for(NSNumber *d in args)
        currentAverage = ((currentAverage * timesAveraged) + [d doubleValue]) / ++timesAveraged;//Error occurs on this line
    return currentAverage;

} 
```

但是，现在它给了我一个令人不安的类似错误“ `Expression does not have a valid object type`”。

我显然做错了。关于如何正确执行此操作的任何建议？

## 解决方案

* * *

我已经能够通过编写这样的方法来编译文件：

```
-(double)average:(double)num, ...
{
    va_list args;
    va_start(args, num);

    double currentAverage = num;
    long long timesAveraged = 1;
    for (NSNumber *arg = [NSNumber numberWithDouble:num]; arg != nil; arg = va_arg(args, NSNumber*))
    {
        currentAverage = ((currentAverage * timesAveraged) + [arg doubleValue]) / ++timesAveraged;
    }
    va_end(args);
    return currentAverage;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:58:10.893

正如 trudyscousin 提到的，快速枚举在这里不起作用。您还应该使用`va_arg`来从参数列表中提取数据。在这里阅读更多信息：http: [//cocoawithlove.com/2009/05/variable-argument-lists-in-cocoa.html](http://cocoawithlove.com/2009/05/variable-argument-lists-in-cocoa.html)

# linux - Linux 中的“eclipse”cmd 如何映射到 eclipse 安装？

> ID：10217706
> 
> 赞同：1
> 
> 时间：2012-04-18T20:47:24.937
> 
> 标签：linux, eclipse, command-line

我在 Ubuntu 上，我正在尝试从 eclipse 3.5 升级到 eclipse 3.7。我想保留 3.5 版本的 eclipse 并且只使用 3.7。

当我在命令行中键入“eclipse”时，会启动旧版本的 eclipse。“eclipse”命令似乎没有在我的 PATH 中定义。Linux 如何创建从该命令到 eclipse 安装的映射？我想更改映射，以便它启动 3.7。

```
wsl:~$ cat ~/.bashrc | egrep 'eclpse|ECLIPSE|Eclipse' 
```

`wsl:~$ echo $PATH | egrep 'eclipse|ECLIPSE|Eclipse'`

`wsl:~$`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:53:08.953

用于`which eclipse`显示可执行文件的完整路径；该目录必须在您的`PATH`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:56:28.063

检查你的“.bashrc”是否有“$ECLIPSE_HOME/”

# python - xpathselector 是如何影响scrapy crawl 运行速度的？

> ID：10217708
> 
> 赞同：0
> 
> 时间：2012-04-18T20:47:33.293
> 
> 标签：python, web-crawler, scrapy

我正在使用 Scrapy 爬虫来爬取超过 10 万页的网站。在这种情况下，速度是最大的问题。今天我注意到这`hxs.select('//*').re('something')`比`hxs.select('//script/text()').re('something')`. 哪位高手能解释一下为什么？

据我了解，无论我使用什么 xpath 选择器，爬虫都应该下载整个页面。所以xpath根本不应该影响速度。

非常感谢任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:58:08.867

这与下载速度无关。

XPath`//*`选择整个页面。XPath`//script/text()`只选择脚本元素内的文本。所以当然第二个更快，因为用`re()`调用搜索的文本更少！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:04:57.740

恐怕您可能会在整个文档中寻找“某些东西”，因此您可能仍应使用`hxs.select('//*').re('something')`.

`text()`关于速度问题：答案是，如果您在 4k 大的文档中查找“某物”一词，那么在该文本中查找该词之后，过滤文档当然需要更长的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T14:33:56.777

XPath对爬虫速度肯定有影响，爬虫下载页面，但是Xpath处理爬虫下载的Html。所以如果页面很大，那么 xpath 将需要时间来处理整个 Html。

# java - 设置图像资源

> ID：10217713
> 
> 赞同：2
> 
> 时间：2012-04-18T20:47:48.067
> 
> 标签：java, android, imageview

```
int i = 1;
String IMG = "pic";
IMG = IMG + Integer.toString(i);
i = i + 1;   

imageview1.setImageResource(R.drawable.IMG); 
```

R.drawable.IMG 其中 IMG 是一个变量。

这是错误的。正确的方法是什么？我想将图像视图从 pic1 更改为 picN。

* * *

int[] images = new int[]{R.drawable.pic1, R.drawable.pic2, R.drawable.pic3};

这更好，但是如何将矢量元素插入到图像视图中？对不起我的英语水平不好:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:00:21.537

这可以通过使用来完成

```
int resourceId = getResources().getIdentifier("pic" + i, "drawable", getPackageName());

imageview1.setImageResource(resourceId); 
```

这被证明是相当缓慢的。更好的选择可能是保留一组可绘制 ID 并循环遍历它。

```
int[] drawables = new int[] { R.drawable.pic1, R.drawable.pic2 }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:00:05.967

标识应用中资源的标识符不是一系列序列号。创建您添加的图像数组，例如

```
int[] images = new int[]{R.drawable.pic1, R.drawable.pic2, R.drawable.pic3}; 
```

并增加索引？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:17:00.033

与@dymmeh 给出的解决方案类似，您也可以使用 Java Reflection 执行此操作，但我怀疑它也可能很慢。

```
int resId = R.drawable.getClass().getField("pic" + i).getInt(R.drawable); 
```

# visual-studio-2010 - 使用项目引用时创建单文件输出

> ID：10217715
> 
> 赞同：0
> 
> 时间：2012-04-18T20:48:01.800
> 
> 标签：visual-studio-2010

我正在编写一个包含插件的项目。这些插件被设计为它们自己的类文件并编译到它们自己的 DLL 中，但由于它们都继承自同一个基本类，因此我将该基类放入解决方案中的任何其他项目都可以导入的“SharedObjects”项目中一个项目参考和使用。例如：

在 SharedObjects 项目中，我有这个：

```
Public MustInherit Class BaseClass

End Class 
```

每个插件项目添加一个对 SharedObject 项目的项目引用，然后将一个类编译成一个 DLL：

```
Public Class Plugin
    Inherits SharedObject.BaseClass

End Class 
```

当我查看项目输出时，我有两个 DLL - 一个用于 SharedObject 项目，另一个用于插件。如果它可以编译成一个我可以移动的 DLL，那就太好了。有没有办法指定应该将 SharedObjects DLL 编译为插件 DLL 而不是作为单独的外部文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:51:14.133

您可以使用[ILMerge](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=17630)将两个程序集合并在一起。

# magento - Magento paypal 和 authorize.net 重复订单问题

> ID：10217716
> 
> 赞同：0
> 
> 时间：2012-04-18T20:48:04.097
> 
> 标签：magento, duplicates

部分客户在使用 paypal express 或 authorize.net 订购商品时，出现“交易拒绝”错误。但付款和订单已处理。于是客户又下单了。但支付2次。

发生“交易拒绝”错误，但订单已处理。

我怎样才能做到这一点？

我的 magento 版本是 1.4.2.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:03:46.590

我认为 Magento 1.4 在重复订单方面存在一些问题。[看这里](https://www.google.com.au/search?ix=acb&ie=UTF-8&q=Magento%201.4%20duplicate%20orders)

升级到当前版本应该可以解决您的问题。

[下载最新版本](http://www.magentocommerce.com/download)

[如何升级 Magento](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/upgrading_magento)

# c++ - 多次并行调用函数

> ID：10217719
> 
> 赞同：2
> 
> 时间：2012-04-18T20:48:24.983
> 
> 标签：c++, c, multithreading, fork

我想多次调用具有不同 arg 值的函数。为了使执行更快，我想在不考虑其实现的情况下调用该函数。

在循环中，我将 arg 传递给函数并立即调用它，我的程序不应等待函数执行并再次循环，而是不应考虑该函数尚未完成第一个循环，它应该继续调用一次又一次地运行，直到循环结束。

如何使用 fork 和线程来做到这一点，哪个会更快并且代码骨架会有所帮助？假设我的函数是 void foo(arg1,arg2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:52:39.443

如果它是一种计算密集型方法，那么为每个调用生成一个线程/进程并不是一个好主意（事实上，这绝不是一个好主意！）。

您可以使用 openmp 有效地并行化 for 循环：

```
#pragma omp parallel for
for(int i = 0; i < N; i++)
{
    int arg1 = ...
    int arg2 = ...
    foo(arg1, arg2);
} 
```

这将根据可用 CPU 内核的数量创建多个线程，然后在它们之间拆分迭代。`schedule`您可以使用该子句进一步调整调度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:55:38.413

[您需要前摄器模式](http://en.wikipedia.org/wiki/Proactor_pattern)的异步实现。

这是一个示例，使用`boost::asio`and `boost::thread`：

```
#include <iostream>
using namespace std;

#include <boost/asio.hpp>
#include <boost/thread.hpp>

// your function, with its arguments
void foo(int x, int y)
{
   cout << x << " * " << y << " = " << x * y << "\n";
}

int main()
{
   boost::asio::io_service svc;
   boost::asio::io_service::work w(svc);

   // create a thread to run the io_service proactor
   boost::thread thread(boost::bind(&boost::asio::io_service::run, &svc));

   for(int z = 0; z < 32; ++z)
   {
      // bind the function to its arguments to 
      // be called in the context of the running
      // thread
      svc.post(boost::bind(&f, 2, z));
   }

   boost::this_thread::sleep(boost::posix_time::milliseconds(1000));

   svc.stop();
   thread.join();
} 
```

`boost::asio::io_service::run`这里的好处是，如果需要，您可以通过从线程池中调用来轻松扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:03:58.933

就像 Tudor 推荐的那样，我也会使用`parallel_for`Intel TBB 或 Microsoft PPL 的模式算法。

如果你真的想为每个函数生成一个需要线程，你可以这样做：

```
#include <thread>
#include <vector>

void foo(arg1, arg2) {
  //do stuff
}

int main() {

  std::vector<std::thread> threads;

  for(auto i = x; i != y; ++i)
    threads.emplace_back(foo, arg1, arg2);

  for(auto& i: threads)
    i.join();

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-28T12:08:16.780

在[github](https://github.com/tirimatangi/Lazy)中有一个仅标头库，可用于为向量的每个元素异步调用一次函数。如果函数返回一个值，它会将结果返回到另一个向量中。它避免使用在[这个](https://youtu.be/tF-Nz4aRWAM?t=780)CppCon 演示中被批评为慢的 std::future。也可以正常捕获异常。

这是一个例子：

```
 #include <iostream>
    #include "Lazy.h"

    template <class T1, class T2>
    double foo(T1 t1, T2 t2) {
        std::this_thread::sleep_for(std::chrono::milliseconds(1000));
        return double(t1) + double(t2);
    }

    int main() {
        constexpr int maxThreads = 16; // 0 means as many threads as there are cores

        // Make an input vector
        std::vector<std::pair<int, float>> vecIn;
        for(int i=0; i < 5; ++i)
            vecIn.push_back({10 * i, 1.1 * (i+1)});

        try {
            auto vecOut = Lazy::runForAll<maxThreads>(vecIn,
                            [](auto in){ return foo(in.first, in.second); });

            for (auto i = 0; i < vecOut.size(); ++i)
                std::cout << "foo(" << vecIn[i].first
                          << ", " << vecIn[i].second
                          << ") = " << vecOut[i] << '\n';
        } catch (...)
        { // Deal with the exception here
        }
    }

    /* Output:
    foo(0, 1.1) = 1.1
    foo(10, 2.2) = 12.2
    foo(20, 3.3) = 23.3
    foo(30, 4.4) = 34.4
    foo(40, 5.5) = 45.5
    */ 
```

# mysql - sql - 选择引号禁用非空要求

> ID：10217726
> 
> 赞同：0
> 
> 时间：2012-04-18T20:49:04.110
> 
> 标签：mysql, sql, delphi

在我的数据库中，该列`cardid`未将 null 设置为 true，即不允许 null。

当我在 delphi cum zeos TZQuery 中运行以下查询时，结果字段`card_id0`具有所需的属性为 true，这是正确的，但结果字段`card_id1`不是，即周围的引号`card_id1`似乎意味着给我数据但没有约束。

```
select c.id, c.cardid as card_id0, c.cardid as "card_id1" 
  from mydata c 
```

这是sql中的标准吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:06:24.377

不要认为这与sql有任何关系，您不会通过resulset获得约束。我猜这是 TZQuery。作为一种猜测，我会说它获取了表 C 的元数据，假设 cardid 和 cardid0 之间的映射，然后没有任何“card_id1”。

反转 select 子句中字段的顺序，看看是否需要的属性与之交换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:26:43.893

您所看到的是 TZQuery 没有从表/查询元数据中检测到数据库约束（非空）。这仅在您通过 TZQuery 组件添加或更新记录时才有意义。如果您尝试添加或更新带有 null for `card_id0`or的记录，您仍然会遇到异常`card_id1`。异常将由数据库而不是组件生成。

通常，引用字段名称（或别名）仅用于在 SQL 查询中允许字段名称中出现非法字符，即字段名称中有空格。引用字段名称可能会产生副作用，例如在 Firebird/Interbase 中，引用字段名称会使其区分大小写，而它们通常不区分大小写。

# android - Apple/Android 第 3 方商家服务

> ID：10217727
> 
> 赞同：1
> 
> 时间：2012-04-18T20:49:04.527
> 
> 标签：android, iphone, app-store, google-play

我很难在 iPhone/Android 应用商店中找到有关 3rd 方商家服务的任何信息。我正在 Flex 平台上开发我的应用程序，以便可以将它发布到两个主要系统。它需要订阅才能解锁主要功能，我想包括一张信用卡表格，该表格针对第 3 方商家进行身份验证。这是合法的还是我的应用程序会被推崇市场拒之门外？我知道他们希望从所有销售额中抽出 30%……我宁愿只写一次就完成，而不是让它适用于每个市场。

Spark Notes：Apple/Android 是否允许在免费应用程序中使用 3rd 方商家结账？

**编辑**：正如 CW 如此有帮助*地*指出的那样，我不是在寻求法律建议。我需要知道我的应用程序是否会根据这种购买模式被拒绝（未批准）。

经过进一步研究，苹果似乎希望每一笔购买都通过他们的口袋。本文档的[第 11 节详细介绍了这个问题。](https://developer.apple.com/appstore/resources/approval/guidelines.html#purchasing-currencies)

1.  采购和货币

11.1 使用 App Store 以外的机制解锁或启用附加特性或功能的应用程序将被拒绝

11.2 应用程序使用除应用内购买 API (IAP) 之外的系统来购买应用程序中的内容、功能或服务将被拒绝

11.3 使用 IAP 购买实体商品或在应用程序外使用的商品和服务的应用程序将被拒绝

11.12 提供订阅的应用程序必须使用 IAP 进行，Apple 将按照开发者计划许可协议中的规定，与开发者就这些购买分享相同的 70/30 收入分成。

11.13 链接到外部购买或订阅机制的应用程序将被拒绝，例如“购买”按钮进入网站购买电子书

如果有人知道 Android，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:43:59.740

我从个人经验中了解 Play 商店的规则。如果您正在销售外部产品，您可以使用任何您想要的支付系统（例如，您正在销售可以在您的应用程序之外播放的音乐曲目）。另一方面，如果你销售的是应用产品，比如剑，如果它是游戏或高级服务，你必须使用 google checkout。

[http://www.android.com/us/developer-content-policy.html#payments](http://www.android.com/us/developer-content-policy.html#payments)

检查付费和免费部分。

# google-app-engine - App Engine 无法从远程 API Java 获取 appId

> ID：10217735
> 
> 赞同：1
> 
> 时间：2012-04-18T20:49:33.173
> 
> 标签：google-app-engine, google-cloud-datastore, remoteapi

我使用远程 API 来访问远程数据存储，并带有身份验证选项：Google Account API。在我的代码中，我在 web.xml 中完成了正确的 servlet 条目。然后，我也收到错误日志：

> servlet java.io.IOException 未捕获的异常：无法从远程 api 获取 appId；com.google.appengine.tools.remoteapi.RemoteApiInstaller.loginImpl(RemoteApiInstaller.java:267) 上 com.google.appengine.tools.remoteapi.RemoteApiInstaller.loginImpl(RemoteApiInstaller.java:267) 上的状态代码 = 404 .appengine.tools.remoteapi.RemoteApiInstaller.login(RemoteApiInstaller.java:228)

我也尝试过不同的 SDK（1.5.2 和 1.6.4），但我得到了相同的日志。

我的 web.xml 代码是：

```
<servlet>
    <display-name>Remote API Servlet</display-name>
    <servlet-name>RemoteApiServlet</servlet-name>
    <servlet-class>com.google.apphosting.utils.remoteapi.RemoteApiServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>RemoteApiServlet</servlet-name>
    <url-pattern>/remote_api</url-pattern>
</servlet-mapping>

<servlet>
    <servlet-name>CPUstats</servlet-name>
    <servlet-class>controller.CPUstatsServlet </servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>CPUstats</servlet-name>
    <url-pattern>/cpustats</url-pattern>
</servlet-mapping>
.
.
. 
```

我正在运行的命令行是：

```
..\bin>appcfg.cmd -e gggodhwani@gmail.com --enable_jar_splitting update C:\Gaurav\New-projects\Crawler1.4\war 
```

# php - Safari 仅显示 PHP 代码 - Firefox 询问显示相同的应用程序

> ID：10217738
> 
> 赞同：0
> 
> 时间：2012-04-18T20:49:38.083
> 
> 标签：php, firefox, safari

大家好，

我有一个班级作业，我的任务是构建一个 MySql 数据库，然后使用 PHP 检索数据库中表的内容。当我尝试在 Safari 中打开它时，它只输出 HTML/PHP 代码。另一方面，Firefox 会弹出一个窗口，要求我选择一个应用程序来处理代码。这是代码本身。任何人都可以看到我的错误在哪里和/或指出我正确的方向以得到实际解释和正确显示吗？任何和所有的帮助将不胜感激。

```
<html>
 <head>
  <title>iBud's Sizzling Tracks!</title>
 </head>
 <body>
 <?php
  $con = mysql_connct("localhost","*****","**************");
  if (!$con) {
    die('Could not connect: ' . mysql_error());
    }

  mysql_select_db("music", $con);

  $result = mysql_query("SELECT * FROM songs");

  echo "<table border='1'>
  <tr>
  <th>Song Number</th>
  <th>Song Title</th>
  <th>Artist</th>
  <th>Rating</th>
  </tr>";

  while ($row = mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['songNumber'] . "</td>";
    echo "<td>" . $row['songTitle'] . "</td>";
    echo "<td>" . $row['artistName'] . "</td>";
    echo "<td>" . $row['rating'] . "</td>";
    echo "</tr>";
    }
  echo "</table>";

  mysql_close($con);
  ?>
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:52:19.190

您的网络服务器上没有安装 PHP 解释器（或者您的网络服务器没有解析 PHP 文件，因为它没有以`.php`扩展名命名）。您*永远不会*从网络浏览器中看到 PHP 代码。

我建议你安装一个网络服务器并设置 PHP。为了使这更容易，请获取[XAMPP](http://www.apachefriends.org/en/xampp.html)；它包含 PHP、MySQL、Apache 和一个简单的控制面板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:52:11.263

您的服务器未配置为使用 php 解释器解析 .php。你用的是什么服务器？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T20:52:30.830

文件名实际上是 .php 吗？你在 Apache 上运行 PHP 吗？您是否通过网络服务器查看页面（例如[http://localhost/index.php](http://localhost/index.php)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T20:52:53.390

代码看起来不错。这可能是服务器配置问题，或者您的文件未保存为 .php 文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T20:53:39.940

您的网络服务器未配置为解释 .php 文件以及 PHP 文件。在 Windows 上，考虑安装 WAMP；在 Mac 上，MAMP。他们使整个过程变得更加容易......

考虑在表格中布置您的曲目数据 - 它看起来比字符串更整洁......

# ajax - wordpress 中的阿贾克斯

> ID：10217739
> 
> 赞同：0
> 
> 时间：2012-04-18T20:49:42.610
> 
> 标签：ajax, wordpress, load

我正在 wordpress 中创建一个主题，我想在[http://api.jquery.com/](http://api.jquery.com/)中创建一个搜索框，例如，每次用户单击更多字母时，都会显示相应的帖子。因此，我认为我必须创建 php 文件，该文件将获取第一个字母（在搜索框中）并通过 wordpress 过滤器计算适当的帖子。问题是，我怎样才能加载这个文件，因为如果我只加载主题文件夹中的文件，这个文件将不适用于 WP 的函数课程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:41:03.043

在 PHP 文件的顶部包含 wp-blog-header.php 文件。这将包括所有必要的 WordPress 功能。

```
require_once(dirname(__FILE__) . '/../../../wp-blog-header.php'); 
```

# java - 在 JSF 页面中估计客户端和服务器之间的连接速度

> ID：10217747
> 
> 赞同：0
> 
> 时间：2012-04-18T20:50:08.790
> 
> 标签：java, javascript, jsf

我有兴趣在 JSF 页面中测量客户端和服务器之间的连接速度。

我发现这个java代码连接速度很差：

```
import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.SocketException;
import java.net.UnknownHostException;
import java.util.Calendar;

public class UdpEchoClient {
  static final String testString = "Greeks bearing gifts";

  public static void main(String[] args) {
    InetAddress address;
    try {
      address = InetAddress.getByName(args[0]);
    } catch (UnknownHostException host) {
      System.out.println(host);
      return;
    }
    DatagramPacket pack = new DatagramPacket(testString.getBytes(),
        testString.length(), address, 7);
    DatagramPacket incoming = new DatagramPacket(new byte[256], 256);
    DatagramSocket sock = null;
    try {
      Calendar start, end;
      sock = new DatagramSocket();
      start = Calendar.getInstance();
      sock.send(pack);
      sock.setSoTimeout(5000);
      sock.receive(incoming);
      end = Calendar.getInstance();
      String reply = new String(incoming.getData());
      reply = reply.substring(0, testString.length());
      if (reply.equals(testString)) {
        System.out.println("Success");
        System.out.println("Time = "
            + (end.getTime().getTime() - start.getTime().getTime())
            + "mS");
      } else
        System.out.println("Reply data did not match");
    } catch (SocketException socke) {
      System.out.println(socke);
    } catch (IOException ioe) {
      System.out.println(ioe);
    } finally {
      sock.close();
    }
  }
} 
```

但这可以用于 JSF 页面还是我必须使用 JavaScript 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:57:18.233

当服务器在物理上与客户端不同的机器上运行时，客户端上的任何自尊防火墙都可能会阻止这种情况。

`XMLHttpRequest`在 JavaScript 中将a 计时到相同的来源是一个更好的选择恕我直言。

# ruby-on-rails - 带有 spork 的 Rails 3.2.3 无法识别黄瓜测试中的辅助方法

> ID：10217755
> 
> 赞同：10
> 
> 时间：2012-04-18T20:50:52.483
> 
> 标签：ruby-on-rails, cucumber, spork

我有一个使用 rails 3.2.3 和 spork 1.0.0rc2 的应用程序。当我运行黄瓜测试时，我得到：

```
ActionView::Template::Error: undefined local variable or method `page_title' 
```

page_title 在我的应用程序助手中定义。我不确定是什么破坏了它们，因为它在最后一次捆绑更新之前一直在工作。

有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T10:05:22.520

要解决此问题，请在 Spork.prefork 块中添加以下行

```
full_names = Dir["#{Rails.root}/app/helpers/*.rb"]

full_names.collect do |full_name|
    include Object.const_get(File.basename(full_name,'.rb').camelize)
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T09:24:42.753

看看这个线程[https://github.com/sporkrb/spork-rails/issues/6#issuecomment-11105681](https://github.com/sporkrb/spork-rails/issues/6#issuecomment-11105681)这个问题有两种解决方案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T17:23:52.297

人们在使用 spork 时一直在报告 rails 3.1 的类似情况：[https ://github.com/sporkrb/spork/issues/109](https://github.com/sporkrb/spork/issues/109)

基本上，他们告诉你使用这个：

```
Spork.trap_method(Rails::Application::RoutesReloader, :reload!) 
```

我使用 rails 3.1 但这并没有解决我的问题。我还在寻找答案。

# objective-c - 套接字读取和部分数据——需要进行完整性检查

> ID：10217756
> 
> 赞同：3
> 
> 时间：2012-04-18T20:50:55.350
> 
> 标签：objective-c, sockets, tcp

好的，这是一个关于从套接字读取的一般问题。

我正在查看某人构建的 Objective C 应用程序，该应用程序使用 TCP 套接字库并为“didReadData”设置处理程序，该处理程序获取数据并将其发送到 JSON 解析器。

现在......当我说这基本上是完全错误的时候我是对的吗？根据网络延迟等许多因素，套接字读取是否会返回部分、全部或不返回任何数据？那么是不是你必须继续从套接字读取数据，直到你到达数据的末尾——但是这是分隔的——然后解析它？因此，例如，对于 JSON，如果您通过 HTTP 发送它，您将发送一个内容长度标头，该标头将告诉服务器（或客户端）何时可以停止从套接字读取？所以——如果你不使用 http 并且使用原始套接字，你必须有一些其他的分隔符或机制来确定消息的结尾在哪里。

我想知道这个特定的应用程序是否只在客户端和服务器位于同一主机上的情况下进行了测试——所以我想知道程序员是否认为它可以工作，因为巧合的是，到目前为止，第一次读取总是返回所有的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:31:45.990

你说的对。

流是无止境的，消息必须用分隔符标记。如果您正在测试的应用程序依赖于流对象来识别没有分隔符的消息，这将是问题所在。

问题是这个功能是否以某种方式集成在套接字库中。你在用什么图书馆？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:12:35.927

可以实现流式解析器。我不知道有问题的代码中使用的解析器是否如此，但这并非不可能。

例如，Apple`NSXMLParser`允许流式解析。

（编辑删除提及，`NSJSONSerialization`因为虽然它可以从流中读取，但它是同步的。）

# c# - LinkedLists 链接

> ID：10217766
> 
> 赞同：1
> 
> 时间：2012-04-18T20:51:22.610
> 
> 标签：c#, linker, linked-list

我只需要 C# 中的链表帮助，C++ 中的链表对于指针来说有点容易，但我在 C# 中遇到了一些问题我阅读了[http://msdn.microsoft.com](http://msdn.microsoft.com)上提供的示例，但我不知道如何链接两个不同的链表

有效的方式似乎是将 LinkedListNode 放入一个链表中，所以假设我有两个链表

LinkedList L1 = new LinkedList(); LinkedList L2 = new LinkedList(); 然后假设我有以下节点

```
 LinkedListNode<String> Ln1 = new LinkedListNode<String>("Orange");
        LinkedListNode<String> Ln2 = new LinkedListNode<String>("Banana");
        LinkedListNode<String> Ln3 = new LinkedListNode<String>("Apple");
        LinkedListNode<String> Ln4 = new LinkedListNode<String>("Strawberry"); 
```

我只是将它们添加到我拥有的列表中：

```
 L1.AddLast(Ln1);
        L1.AddLast(Ln2);
        L2.AddLast(Ln3);
        L2.AddLast(Ln4); 
```

好的，现在假设我想将 L1 的最后一个元素链接到 L2 中的第一个元素，这可能吗？我首先尝试了这个：

L1.Last.Next = L2.First; 我完全失败并出现错误：无法将属性或索引器“System.Collections.Generic.LinkedListNode&lt;string>.Next”分配给——它是只读的

好吧，我试过了：

`Ln2.Next = Ln3;` 我又失败了

我最后一次尝试是

```
 LinkedListNode<String> node1=L1.Last;
        LinkedListNode<String> node2 = L2.First;
        node1.Next = node2; 
```

出现错误：无法将属性或索引器“System.Collections.Generic.LinkedListNode&lt;string>.Next”分配给——它是只读的

所以有什么帮助吗？如何链接它们？

一个附加问题：例如，是否可以通过索引到达链表中的元素？

我提出了这个简单的算法，它可以工作：

```
 int i = 0;
        foreach (var item in L2)
        {
            Console.WriteLine(item);
            i++;
        } 
```

有自动的方法吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:03:22.117

LinkedListNode 具有属性列表。该属性指向列表，该节点属于哪个节点。当您将节点添加到某个列表时会设置此属性。因此，在某一时间节点可能只属于一个列表。这意味着您应该先从一个列表中删除节点，然后再将其添加到另一个列表中：

```
var node = L2.First;
L2.RemoveFirst();
L1.AddLast(node); 
```

如果要从 L2 添加所有节点，可以使用：

```
while (L2.Count > 0)
{
    var node = L2.First;
    L2.RemoveFirst();
    L1.AddLast(node);
} 
```

请记住，它将从 L2 中删除所有节点。

另一种选择 - 创建具有相同值的新节点：

```
foreach (string value in L2)
    L1.AddLast(value); 
```

更新：如果你想通过它的索引到达链表中的一个元素，你可以跳过前 N 个项目并取下一个：

```
L1.Skip(index).First() 
```

与任何集合一样，您应该验证该列表至少有 N-1 个节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:10:01.387

回答您的第一个问题，将 L1 的最后一个元素链接到 L2 的第一个元素

```
L2.AddFirst(L1.Last.Value); 
```

# c - 警告：函数 GTK2 的隐式声明

> ID：10217770
> 
> 赞同：-1
> 
> 时间：2012-04-18T20:51:46.893
> 
> 标签：c

我的 c 代码使用“show_error_message”（GTK2）

```
#include <gnome.h>
#include <profiles/audio-profile.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
#include <fcntl.h>

..........................................................................

static void error_cb(GstBus *bus, GstMessage *message, gpointer user_data)
{
    GError *error = NULL;
    GstElement *pipeline = user_data;
    g_assert(pipeline);

    /* Make sure the pipeline is not running any more */
    gst_element_set_state (pipeline, GST_STATE_NULL);

    gst_message_parse_error(message, &error, NULL);
    show_error_message(_("GStreamer runtime error."), error->message);
    g_error_free(error);
} 
```

得到这些警告：

```
warning: implicit declaration of function 'show_error_message' 
```

和

```
#include <config.h>
#include <gnome.h>
#include <gconf/gconf-client.h>
#include <math.h>

.................................................

        /* Initizialize Gconf */
    if (!gconf_init(argc, argv, &err)) {
        char *details;
        details = g_strdup_printf(_("%s\n\nChanges to the settings won't be saved."), err->message);
        show_warning_message(_("Failed to init GConf!"), details);
        g_error_free(err); 
        g_free(details);
        err = NULL;
    } else {
        gconf_client_set_global_default_error_handler((GConfClientErrorHandlerFunc)gconf_error_handler);
        gconf_client_set_error_handling(gconf_client_get_default(),  GCONF_CLIENT_HANDLE_ALL);
        gnome_media_profiles_init(gconf_client_get_default());
    } 
```

得到这些警告：

```
warning: implicit declaration of function 'gnome_media_profiles_init' 
```

..................................................... ......你能告诉我如何解决这些警告吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:07:20.090

首先，如果你没有头文件，那么在 main 或其他函数中使用的所有函数，大部分都在它上面声明。

```
void function();

int main() {
    function();
} 
```

如果你有一个头文件（假设你没有，因为即使我问了你也没有提供给我）你应该在那里声明所有函数，然后包含头文件。

```
//something.h

void function();

//something.c

#include "something.h"
int main() {
    function();
} 
```

# c++ - V4L2 的线程安全性如何？

> ID：10217779
> 
> 赞同：10
> 
> 时间：2012-04-18T20:52:29.360
> 
> 标签：c++, c, thread-safety, posix, v4l2

[除了这封来自 2008 的电子邮件](http://lists.berlios.de/pipermail/linux-uvc-devel/2008-June/003665.html)之外，我找不到任何提及 V4L2 的线程安全特性的内容。它谈到了大内核锁，我猜它现在已经消失了，对吧？

有人有这方面的最新信息吗？我可以`ioctl`（我特别想`VIDIOC_DQBUF`和`VIDIOC_QBUF`）来自多个线程的相同 V4L2 文件描述符而无需序列化吗？上面引用的讨论似乎表明答案取决于驱动程序，但我想我还是会问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T15:16:18.253

规范没有提到 V4L2 是否是线程安全的。然而，似乎某些实现实际上是线程安全的。

POSIX.1-2001 和 POSIX.1-2008 要求标准中指定的所有函数都应该是线程安全的，除了一些特定的函数。ioctl() 不是其中之一，因此它是线程安全的。但是，ioctl() 是一个取消点，所以线程一旦到达 ioctl() 就可以终止。

我认为正确的解决方案是假设 V4L2 不是线程安全的并相应地进行锁定。

# objective-c - 复制的 NSMutableDictionary 不可变

> ID：10217784
> 
> 赞同：0
> 
> 时间：2012-04-18T20:52:42.687
> 
> 标签：objective-c, ios, nsmutabledictionary

需要通过以下方式制作 NSMutableDictionary 的副本：

```
NSMutableDictionary *newScoutingEventDictionary = [[[NSMutableDictionary alloc] initWithDictionary:self.scoutingEvent copyItems:YES] mutableCopy]; 
```

但是当我尝试在其中改变一个数组时：

```
[[newScoutingEventDictionary objectForKey:@"myArray"] replaceObjectAtIndex:i withObject:appendedEntry]; 
```

它给了我一个错误：

```
 -[__NSArrayI replaceObjectAtIndex:withObject:]: unrecognized selector sent to instance 0x964d650
 *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSArrayI replaceObjectAtIndex:withObject:]: unrecognized selector sent to instance 0x964d650' 
```

如果我尝试改变原始的 NSMutableDictionary：

```
[[self.scoutingEvent objectForKey:@"myArray"] replaceObjectAtIndex:i withObject:appendedEntry]; 
```

它运行得很好。为什么我的复制版本会破坏它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T20:56:50.693

`mutableCopy`做一个*浅*的可变副本。它不会使字典中的不可变对象可变。

您需要实现——是的，实现因为它不是 API 的一部分，原因有很多——深度可变复制，如果你需要的话。

或者，如果您的字典可以表示为一个属性列表，您可以变成一个，然后使用各种选项参数来创建可变集合和/或在它未归档时离开。

# twitter-bootstrap - twitter bootstrap：要包含哪些文件

> ID：10217786
> 
> 赞同：2
> 
> 时间：2012-04-18T20:52:47.947
> 
> 标签：twitter-bootstrap

好的。我有点困惑。我下载了 bootstrap v2 并注意到 .css 文件不包含“topbar”或“fill”类。但我看到几个使用这些类的例子。

另外，要使框架正常工作，需要包含哪些文件？我只需要一个 bootstrap.css 文件吗？

bootstrap.js 文件呢？我是否也需要包括在内？

```
 <div class="navbar">
    <div class="fill">

        <div class="container">
            <div > <a class="brand pull-left" href="">Product</a></div>

            <ul class="nav">
                <li><a href="index.html">Create Account</a></li>
                <li class=""><a href="index.html">Forgot Password</a></li>
                <li class=""><a href="index.html">Contact Us</a></li>
            </ul>

        </div>
    </div>
</div> 
```

我的菜单在左边。我想要它在中间，所以它与主体内容对齐。我认为包装一个“容器”会做到这一点......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T20:58:53.200

Twitter 引导程序的大多数部分只要求您包含 CSS 文件。然而，可能需要一些额外的东西。

如果你想使用字形图标，你需要为它们上传图片精灵。

如果您想使用任何 jQuery 插件（轮播、工具提示、下拉菜单等），您还需要包含 JS 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:02:18.487

“topbar”或“fill”不是引导程序中的标准类。您应该使用某些修改版本或只使用类“navbar”“navbar-fixed-top”“navbar-fixed-bottom”...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T11:25:30.163

在依赖大量 javascript 的项目中，我总是使用[RequireJS](http://requirejs.org/)来仅加载我需要的依赖项。您还可以轻松地将引导程序的 JS 插件转换为 AMD 模块，这样您就不会在配置一次后错过任何依赖项。

# flags - cwrsync 不报告 --stats 标志

> ID：10217791
> 
> 赞同：0
> 
> 时间：2012-04-18T20:53:02.220
> 
> 标签：flags, cwrsync

在我们的 SBS2003 服务器上运行以下 cwrsync 脚本（备份到远程 NAS）时，--stats 标志的结果告诉我没有文件或数据被移动。但是，目标目录已被填充。

另外 - 我会在哪里添加一个 --delete 标志到选项中以确保源 = 目标，但任何已删除的文件首先复制到 BACKUPDIR。

<> - --stats 在我手动运行脚本时报告结果。如果我安排它，则不会报告任何统计信息。

```
SET SOURCE=/cygdrive/s/
SET DEST=%SPARENAS01%::HAVOFFSITE/shared
SET BACKUPDIR=xxx_backup_xxx/%date:~10,4%/%date:~7,2%/%date:~4,2%
SET OPTS=--force --update --backup-dir=%BACKUPDIR%/Shared --exclude=xxx_archive_xxx/ --  modify-window=5 --stats -brtz

rsync %OPTS% %SOURCE% %DEST% >> %date:~10,4%.log 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T09:26:44.003

您还需要将 stderr-output 重定向到您的日志文件。试试这个：

```
rsync %OPTS% %SOURCE% %DEST% 1>>%date:~10,4%.log 2>>%date:~10,4%.log 
```

# .net - 实体框架。列 Null 或递增标识

> ID：10217792
> 
> 赞同：0
> 
> 时间：2012-04-18T20:53:03.360
> 
> 标签：.net, sql-server, entity-framework

我希望将表中的列从空状态更新为唯一 ID，该 ID 代表被锁定的行。有没有一种简单的方法可以做到这一点？

谢谢

编辑澄清：这几乎是我正在寻找的。在考虑了一段时间后，我几乎认为它应该被分成一个单独的表并通过外键引用。

```
Pk  | column  | uniqueId
1   | useless | <DBNULL>
2   | random  | <DBNull>
--Update occurs
1   | useless2| 1
2   | random  | <DBNULL>
--Update occurs
1   | useless3| 2
2   | random  | <DBNULL>
--update occurs
1   | useless3| 2
2   | random2 | 3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:40:40.383

我认为（如果我得到正确的结果），
您最好的选择是使用`Guid`列 - 并且很可能必须从 EF/C# 端自定义实现 Guid ID - 这样您就可以将列保持为“空”还需要的时候。

最接近您需要的是这个问题中已经描述的内容，

[Entity Framework 4 Code First 是否支持 NHibernate 等身份生成器？](https://stackoverflow.com/questions/5275306/does-entity-framework-4-code-first-have-support-for-identity-generators-like-nhi)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:58:03.060

如果您只想表示行是否被“锁定”，那么简单的方法是使用位/布尔列。

不需要唯一性，因为您已经在桌子上有一个主键。

# java - Mockito：如何存根 getter setter

> ID：10217793
> 
> 赞同：26
> 
> 时间：2012-04-18T20:53:06.267
> 
> 标签：java, testing, mockito

我对 Mockito 有点陌生，我想知道如何存根获取/设置对。

例如

```
public interface Dummy {
     public String getString();
     public void setString(String string);
} 
```

我怎样才能让它们表现得正常：如果我调用的测试中的某个地方`setString("something");`我想`getString()`返回“某物”。这是可行的还是有更好的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-24T08:41:39.957

我还希望 getter 返回最近的 setter 调用的结果。

有

```
class Dog
{
    private Sound sound;

    public Sound getSound() {
        return sound;
    }
    public void setSound(Sound sound)   {
        this.sound = sound;
    }
}

class Sound
{
    private String syllable;

    Sound(String syllable)  {
        this.syllable = syllable;
    }
} 
```

我使用以下方法将 setter 连接到 getter：

```
final Dog mockedDog = Mockito.mock(Dog.class, Mockito.RETURNS_DEEP_STUBS);
// connect getter and setter
Mockito.when(mockedDog.getSound()).thenCallRealMethod();
Mockito.doCallRealMethod().when(mockedDog).setSound(Mockito.any(Sound.class)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-19T06:01:38.040

I can think of three possible approaches.

1.  Don't use `HttpServletRequest` directly in your application; make a wrapper class for it, and have an interface for the wrapper class. Wherever you currently use `HttpServletRequest` in the application, use the interface instead. Then in the test, have an alternative implementation of this interface. Then, you don't need a Mockito mock at all.

2.  Have a field in your test class that stores the value that you have set the `String` to. Make two Mockito `Answer` objects; one that returns the value of this field when `getString` is called, and another that sets the value of this field when `setString` is called. Make a mock in the usual way, and stub it to use both of these answers.

3.  Make an abstract class (which can be a static inner class of your test class) that implements the `HttpServletRequest` interface, but has the field that you want to set, and defines the getter and setter. Then mock the abstract class, and pass the Mockito.CALLS_REAL_METHODS in as a default answer. When you call the getter or the setter on the mock, the real method will kick in, which is the behaviour you want.

Hopefully, one of these three alternatives will meet your needs.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-10-26T11:31:29.437

我发现这很好用：

```
doAnswer(answer -> when(dummy.getString()).thenReturn((String) answer.getArguments()[0]))
    .when(dummy).setString(any()); 
```

我必须使用 doAnswer(..).when(..) 因为 setter 是一个 void 方法。当使用对象调用 setter 时，getter 将被设置为使用相同的对象进行响应。

当您有接口但没有实现时非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T23:14:26.633

在这种 HttpServletRequest 存根的特殊情况下，我强烈建议使用 Spring-Mock 框架：( [http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mock/web/package-摘要.html](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mock/web/package-summary.html) )

它具有用于基于 Web 的操作的内置模拟。

否则，使用答案为您的模拟对象定义您自己的响应（[http://mockito.googlecode.com/svn/branches/1.8.5/javadoc/org/mockito/stubbing/Answer.html](http://mockito.googlecode.com/svn/branches/1.8.5/javadoc/org/mockito/stubbing/Answer.html)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-31T06:08:32.000

我遇到了这个问题，但不想接受已接受的答案，因为这样做会停止嘲笑我的 bean 中的*所有*getter 和 setter。我想要的只是为单个 getter/setter 对创建存根，而不是全部。因此，我使用了以下代码。

```
@Mock
private Dummy mockDummy;
private final MutableObject<String> stringWrapper = new MutableObject<>();

public TestClass() {
    MockitoAnnotations.initMocks(this);

    doAnswer(invocationOnMock -> {
        String injectedString = (String)invocationOnMock.getArguments()[0];
        TestClass.this.stringWrapper.setValue(injectedString);
        return null;
    }).when(this.mockDummy).setString(any());
    when(this.mockDummy.getString()).thenAnswer(
            invocationOnMock -> TestClass.this.stringValue.getValue());
} 
```

第一个 lambda 实现`Answer<Void>`匿名类的[`answer()`方法](https://static.javadoc.io/org.mockito/mockito-core/2.18.3/org/mockito/stubbing/Answer.html#answer-org.mockito.invocation.InvocationOnMock-)。因此，每当 setter 方法由被测代码执行时，该 setter 的存根将其记录到[`MutableObject`](https://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/mutable/MutableObject.html)帮助器对象中。然后，getter 实现可以返回这个设置的记录值。

# facebook - 我上传照片的代码出错 {"error":{"message":"(#240) The target_id references an inactive user","type":"OAuthException","code":240}}

> ID：10217795
> 
> 赞同：1
> 
> 时间：2012-04-18T20:53:11.173
> 
> 标签：facebook

请帮忙。将照片上传到相册的代码。改代码后不起作用，报错 {"error": {"message": "(# 240) The references target_id an inactive user", "type": "OAuthException", "code": 240}} 我试过我一无所有，只有思考。我在这里寻找专业和支持。谢谢你的每一个答案。

```
$app_id = "xxxxx";
$app_secret = "xxxxxxx";
$post_login_url = "http://redirectpage";
$album_id = "1";
$photo_url = "http://myimg.com";
$photo_caption = "xxxxxxxxx";
$code = $_REQUEST["code"];
if (!$code){ 
 $dialog_url= "http://www.facebook.com/dialog/oauth?"`enter code here`
  . "client_id=" .  $app_id
  . "&redirect_uri=" . urlencode( $post_login_url)
  .  "&scope=publish_stream";
echo("<script>top.location.href='" . $dialog_url
  . "'</script>");
} else {
$token_url="https://graph.facebook.com/oauth/access_token?"
  . "client_id=" . $app_id
  . "&client_secret=" . $app_secret
  . "&redirect_uri=" . urlencode( $post_login_url)
  . "&code=" . $code;
$response = file_get_contents($token_url);
$params = null;
parse_str($response, $params);
$access_token = $params['access_token'];

$graph_url= "https://graph.facebook.com/" 
  . $album_id . "/photos?"
  . "url=" . urlencode($photo_url)
  . "&message=" . urlencode($photo_caption)
  . "&method=POST"
  . "&access_token=" .$access_token;

echo '<html><body>';
echo file_get_contents($graph_url);
echo '</body></html>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:04:25.423

您确定当前用户已授权该应用程序（已安装）吗？

此外，此错误报告：[通过 PHP SDK OpenGraph 上传照片](http://developers.facebook.com/bugs/325292497524672/?browse=search_4f86f2f707ce21d13657399)是搜索“引用 target_id 一个非活动用户”的首批结果之一。

我不是 php 专家，但这似乎不是发布图像的正确方法，也许您应该使用该错误报告中代码中显示的方法。

# android - 从 BroadcastReceiver 更新 Activity

> ID：10217800
> 
> 赞同：3
> 
> 时间：2012-04-18T20:53:24.200
> 
> 标签：android, android-activity, broadcastreceiver

[这个问题](https://stackoverflow.com/questions/10216151/updating-google-maps-marker-from-a-broadcast-sms-receiver/10216546)提出了一个有趣的问题。

OP 有一个显示地图的应用程序，此地图需要使用通过 SMS 消息接收的位置标记进行更新。各个步骤相当简单：SMS 消息可以由 a 接收`BroadcastReceiver`，标记可以由a`ItemizedOverlay`顶部的 a显示`MapView`。棘手的部分是让接收部分与应用程序的主要部分进行通信。

*   如果应用程序有一个 active `MapActivity`，然后它`BroadcastReceiver`被调用作为对传入 SMS 的响应，会发生什么？代码在同一进程中执行时是否`MapActivity`暂停？`BroadcastReceiver`如果是这样，通过静态引用（由活动的方法设置）`BroadcastReceiver`访问它是否安全？`MapActivity``onCreate`

*   相反，应用程序是否`BroadcastReceiver`在单独的进程中执行，因此需要其他方式与应用程序的活动进行通信？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:24:16.413

阅读文档，看起来 BroadcastReceiver 是在不同的进程上执行的，但我不是 100% 确定（[BroadcastReceiver 生命周期](http://developer.android.com/reference/android/content/BroadcastReceiver.html#ReceiverLifecycle)）

*当前正在执行 BroadcastReceiver（即当前正在其 onReceive(Context, Intent) 方法中运行代码）的进程被认为是前台进程*

这就是说，我不认为从 onReceive 访问活动是安全的，因为它是一个不同的过程，它可能会崩溃。

考虑到 Activity 也可以充当广播接收器，但您必须控制它在其生命周期中何时主动侦听事件。这样，你就可以订阅 onResume （代码提取自 ZXing 项目）

```
 public void onResume(){
    activity.registerReceiver(powerStatusReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    [...]
  }

  public void onPause() {
    [...]
    activity.unregisterReceiver(powerStatusReceiver);
  } 
```

并且您将 BroadcastReceiver 定义为公共类中的私有类

```
final class InactivityTimer {

[onResume, onPause, rest of the stuff ...]

    private final class PowerStatusReceiver extends BroadcastReceiver {
        @Override
        public void onReceive(Context context, Intent intent){
          if (Intent.ACTION_BATTERY_CHANGED.equals(intent.getAction())) {
            // 0 indicates that we're on battery
            // In Android 2.0+, use BatteryManager.EXTRA_PLUGGED
            int batteryPlugged = intent.getIntExtra("plugged", -1);
            if (batteryPlugged > 0) {
              InactivityTimer.this.cancel();
            }
          }
        }
      }
} 
```

So, the BroadcastReceiver should always persist the new markers (through a Service, never inside the *onReceive*) AND it should notify a potentially active MapActivity that new markers have been added, which will be listening if it's active.

Or, even easier, the Activity and the BroadcastReceiver listen for the same SMS Intent. While the latter persists it, the first updates the map, tho I'm just guessing what I would try.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:11:15.933

`BroadcastReceiver`应该在同一进程中运行。`BroadcastReceiver`被设计为短暂的。因此，它可以执行而无需真正担心暂停前台`Activity`。假设您检查了尚未创建`Activity`的情况，您可能会通过静态引用直接访问。`Activity`但是，通过 Intent 进行通信可能更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:20:27.520

正如其他人指出的那样，最好的方法似乎是创建一个对应用程序私有的单独意图。活动不是在清单中声明它，而是在活动时注册它。[这个答案](https://stackoverflow.com/a/6508795/67063)解释了如何做到这一点。

公共`BroadcastReceiver`（在清单中声明并处理`android.provider.Telephony.SMS_RECEIVED`）然后应该调用这个特定于应用程序的意图。

# java - JAVA中的编译错误 - ( )

> ID：10217806
> 
> 赞同：0
> 
> 时间：2012-04-18T20:53:42.720
> 
> 标签：java, swing, jcombobox, listselectionlistener

我有一个家庭作业，我正在构建一个 GUI JPane，它包含其他 JPanes 以允许显示多个对象。我的一位听众出现编译错误，可以使用一些帮助来解决这个问题。让我先说我们不允许使用 IDE。

错误是：

```
F:\Java\Lab 8\Lab8.java:84: error: cannot find symbol
        jcbo.addListSelectionListener(new ListSelectionListener() {
            ^
  symbol:   method addListSelectionListener(<anonymous ListSelectionListener>)
  location: variable jcbo of type JComboBox<String>
1 error 
```

项目代码为：

```
import java.awt.*;
   import java.awt.event.*;
   import javax.swing.*;
   import javax.swing.event.*;
   import javax.swing.border.*;
   import java.util.Scanner;
   import java.util.EventObject;

   public class Lab8 extends JFrame {

       public String name;
       public String[] ageRanges = {"Select an Age Range","Under 20", "20-29", "30-39", "40-49", "50-59", "60 and Above"};
       public String[] destination = {"Mercury", "Venus", "Moon", "Mars", "Jupiter / Europa", "Saturn / Triton", "Pluto + Sharon"};
        final JTextField txtName = new JTextField(20);
        String value;

       public Lab8()
       {

           // Create an array of Strings for age ranges
           final JComboBox<String> jcbo = new JComboBox<String>(ageRanges);
           jcbo.setForeground(Color.blue);
           jcbo.setBackground(Color.white);

           // Create an array of String destinations

           // Declare radio buttons
           JRadioButton jrbMonday, jrbTuesday, jrbWednesday, jrbThursday, jrbFriday;

           // Create a textfield
           JTextField jMsg = new JTextField(10);

           // Create panel to hold label and textbox.
           JPanel p1 = new JPanel();
           p1.setLayout(new BorderLayout(5,0));
           p1.add(new JLabel("Name: "), BorderLayout.WEST);

           p1.add(txtName, BorderLayout.CENTER);
           jMsg.setHorizontalAlignment(JTextField.LEFT);

           // Create combobox panel.
           JPanel p2 = new JPanel();
           p2.setLayout(new GridLayout(2,0,5,5));
           p2.add(p1, BorderLayout.NORTH);
           p2.add(new JComboBox<String>(ageRanges), BorderLayout.CENTER);
           p2.setBorder(new TitledBorder("Passenger Name & Age Range"));

            final JList<String> jlst = new JList<String>(destination);

           //Create listbox panel.
           JPanel p3 = new JPanel();
           p3.setLayout(new GridLayout(1, 0));
           p3.add(jlst);
           p3.setBorder(new TitledBorder("Destinations"));

            jlst.addListSelectionListener(new ListSelectionListener() {

                public void valueChanged(ListSelectionEvent e){

                    final int index = jlst.getSelectedIndex();
                    value = destination[index];
                }
            });

            jcbo.addListSelectionListener(new ListSelectionListener() {

                public void valueChanged(ListSelectionEvent e){

                    final int index = jcbo.getSelectedIndex();
                    value = ageRanges[index];
                }
            });

           // Create a print button
           JButton jbtPrint = new JButton("Print");

           // Create a new panel to hold radio buttons.
           JPanel r1 = new JPanel();
           r1.setLayout(new GridLayout(3,2));
           r1.add(jrbMonday = new JRadioButton("Monday"));
           r1.add(jrbTuesday = new JRadioButton("Tuesday"));
           r1.add(jrbWednesday = new JRadioButton("Wednesday"));
           r1.add(jrbThursday = new JRadioButton("Thursday"));
           r1.add(jrbFriday = new JRadioButton("Friday"));
           r1.setBorder(new TitledBorder("Departure Days"));
           r1.add(jbtPrint);

           // Create a radio button group to group five buttons
           ButtonGroup group = new ButtonGroup();
           group.add(jrbMonday);
           group.add(jrbTuesday);
           group.add(jrbWednesday);
           group.add(jrbThursday);
           group.add(jrbFriday);

           // Create grid to hold contents
           JPanel pMain = new JPanel();
           pMain.setLayout(new BorderLayout(5,0));
           add(r1, BorderLayout.CENTER);
           add(p2, BorderLayout.NORTH);
           add(p3, BorderLayout. EAST);

           // Create button listener
           jbtPrint.addActionListener(new ButtonListener());

            jrbMonday.addActionListener(new mListener());
            jrbTuesday.addActionListener(new tListener());
            jrbWednesday.addActionListener(new wListener());
            jrbThursday.addActionListener(new rListener());
            jrbFriday.addActionListener(new fListener());

}
            int flag = 0;

            // Declare radio button variable
            boolean monday, tuesday, wednesday, thursday, friday;

            public void monday(){
                monday = true;
            }
            public void tuesday(){
                tuesday = true;
            }
            public void wednesday(){
                wednesday = true;
            }
            public void thursday(){
                thursday = true;
            }
            public void friday(){
                friday = true;
            }

            public class mListener implements ActionListener
            {
              public void actionPerformed(ActionEvent e)
              {
              monday();
                flag = 1;
              }
            }

            public class tListener implements ActionListener
                        {
              public void actionPerformed(ActionEvent e)
              {
              tuesday();
                flag = 2;
              }
            }

            public class wListener implements ActionListener
            {
              public void actionPerformed(ActionEvent e)
              {
              wednesday();
                flag = 3;
              }
            }

            public class rListener implements ActionListener
            {
              public void actionPerformed(ActionEvent e)
              {
              thursday();
                flag = 4;
              }
            }

            public class fListener implements ActionListener
            {
              public void actionPerformed(ActionEvent e)
              {
              friday();
              flag = 5;
              }
            }

            public void setText(){
                name = txtName.getText();
        }

           /** Handle the print button */
             class ButtonListener implements ActionListener {
                 ButtonListener(){
                 }
               public void actionPerformed(ActionEvent e) {
                 // Get values from fields
                    setText();
                System.out.println("Passenger's Name: " + name + "\n");
                System.out.println("Age Group: " + ageRanges + "\n");
                System.out.println("Destination: " + value + "\n");
                System.out.println("Departure Day: " + flag  + "\n");

                }
                /*jbtPrint.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent e)
                    {

                    }
                });*/

}

public static void main(String[] args)
       {
           Lab8 frame = new Lab8();
           // frame.pack();
           frame.setTitle("Lab 8 Application");
           frame.setLocationRelativeTo(null); // Center the frame
           frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
           frame.setSize(425, 275);
           frame.setVisible(true);

        }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:59:30.977

`JComboBox`根本没有办法`addListSelectionListener(...)`。毕竟这不是一个清单。

从您的代码中，您似乎希望在用户在您的`JComboBox`. 为此使用一个`ActionListener`：

```
jcbo.addActionListener(new ActionListener() {
  @Override
  public void actionPerformed(ActionEvent e) {
    int index = jcbo.getSelectedIndex();
    value = ageRanges[index];
  }
}); 
```

* * *

与上一个完全无关：

对于`[Ljava.lang.String;@1283052`，请注意，调用`toString()`数组（或将其连接到具有相同效果的现有字符串）不会为您提供内容，而是数组类型和一些内部哈希码的混合。对于内容，请使用以下[`Arrays.toString()`方法](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)之一：

```
System.out.println("Age Group: " + Arrays.toString(ageRanges) + "\n"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:59:47.100

该类`JComboBox`没有`addListSelectionListener`方法。请参阅[javadoc](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComboBox.html)。

如果您想拦截更改当前选择的事件，请尝试使用`addActionListener`：

```
jcbo.addActionListener(new ActionListener() {

    public void actionPerformed(ActionEvent e) {

         final int index = jcbo.getSelectedIndex();
         value = ageRanges[index];
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:01:12.627

唔。如果你不允许使用像eclipse这样的IDE，我只会给你一个方向标记......

检查该方法的 jcombobox 的 javadoc。

你可以在这里找到它：http: [//docs.oracle.com/javase/7/docs/api/javax/swing/JComboBox.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComboBox.html)

# xampp - 使用 XAMPP 设置数据表时遇到问题

> ID：10217808
> 
> 赞同：0
> 
> 时间：2012-04-18T20:53:44.280
> 
> 标签：xampp, datatables

我正在尝试在我的机器上安装 DataTables 插件，但在使用 XAMPP 之类的平台时，我什至在 DataTables 论坛中都找不到安装它的位置。我已经提取了 DataTables-1.9.1 文件夹，但我不知道将它放在我的 C:\XAMPP 目录中的哪个位置。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:56:42.567

将 datatables 文件夹放在 XAMPP 提供的目录中，然后在页面的 html 中添加一个`<script>`标签以拉入 DataTables js 脚本

在 datatables -> media -> js 中查找名为 jquery.dataTables.js 的文件

# ios - ios下载视频暂停/继续

> ID：10217809
> 
> 赞同：1
> 
> 时间：2012-04-18T20:53:57.540
> 
> 标签：ios, video, nsurlconnection

我正在我的应用程序的后台下载视频。如果用户在下载过程中重新启动应用程序/设备，有没有办法在下次启动应用程序时从上次中断的地方继续下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:11:17.963

这主要取决于文件服务器的配置（HTTP、FTP、...）。

现在假设您使用 HTTP 进行下载，您的服务器需要支持`CONTENT-RANGE`标头。有关更多信息，请参阅[有关该主题的 HTTP 1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.16)。

请参阅有关该主题的这篇文章：[使用 NSURLConnection 恢复大型下载](http://nachbaur.com/blog/resuming-large-downloads-with-nsurlconnection)

# asp.net - 识别客户身份

> ID：10217819
> 
> 赞同：0
> 
> 时间：2012-04-18T20:54:28.133
> 
> 标签：asp.net

我刚刚为我的 asp.net 网站实现了一个非常简单的日志记录过程。该网站托管在无人登录的服务器上的 IIS 上。客户将使用本地网络地址连接到该网站。我正在记录有关已完成操作和花费时间的信息。如果有人想读取日志文件，他无法知道自己执行了哪些操作，因为每个人的操作都写在同一个地方。

我想在每次登录时添加一个信息来识别用户。我尝试访问 HttpContext.Current.User，但这始终具有通用标识。我也查看了 HttpContext.Session ，但没有找到任何相关的内容......

我想记录计算机名称或用户的用户名（他用来登录 Windows 的那个），或者其他可以帮助我的用户识别哪些操作是他们的操作的东西。（我也可以将所有内容分隔在单独的日志文件中，但是我需要一些东西来告诉他们appart）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:39:46.963

搜索了一段时间后，我找到了一种方法来获取客户端的计算机名称。

```
string name =
  System.Net.Dns.GetHostEntry(Request.ServerVariables["remote_addr"]).HostName.Split('.')[0]; 
```

# objective-c - 是否可以将不同类型的对象添加到 iOS 中的收藏夹列表中？

> ID：10217820
> 
> 赞同：0
> 
> 时间：2012-04-18T20:54:35.423
> 
> 标签：objective-c, ios, arrays

我在一个具有各种属性的模拟数据库中有一个卡车列表，以及一个在具有各种属性的模拟数据库中的区块方列表（它们与卡车属性不同）。每个列表在选项卡栏应用程序的两个不同 xib 中填充两个不同的 UITableView。我有第三个标签栏 xib 用于收藏夹。我希望用户能够点击“将此添加到收藏夹”按钮，以便可以将卡车或街区派对放入收藏夹列表中。有谁知道这怎么可能？如果不是，那么至少我如何才能将卡车添加到收藏夹中？

```
 // Initialize the mock database of trucks.
listContent = [[NSArray alloc] initWithObjects:
               [Truck truckWithCuisine:@"American Cuisine" name:@"Buttermilk Truck" menu:[NSData dataWithContentsOfFile:@"/Users/Steve/Desktop/Truck Tracker App/Truck Tracker App/Buttermilk Truck Menu.tiff"] latitude: [NSNumber numberWithDouble: 0.1] longitude: [NSNumber numberWithDouble: 0.1]schedule:@"7/15/12"],
               [Truck truckWithCuisine:@"American Cuisine" name:@"In N Out Burgers" menu:[NSData dataWithContentsOfFile:@"/Users/Steve/Desktop/Truck Tracker App/Truck Tracker App/Lobsta Truck Menu.tiff"]
                              latitude: [NSNumber numberWithDouble: 23.2] longitude: [NSNumber numberWithDouble: 80.2] schedule: nil],
               [Truck truckWithCuisine:@"Mexican Cuisine" name:@"Hacienda Mexican" menu: nil
                              latitude: [NSNumber numberWithDouble: 42.3] longitude: [NSNumber numberWithDouble: 64.3] schedule: nil],
               [Truck truckWithCuisine:@"Indian Cuisine" name:@"Naboo Indian"  menu: nil
                              latitude: [NSNumber numberWithDouble: 0.4] longitude: [NSNumber numberWithDouble: 0.4] schedule: nil],
               [Truck truckWithCuisine:@"Italian Cuisine" name:@"Vito's Italian" menu: nil
                              latitude: [NSNumber numberWithDouble: 33.9698156] longitude: [NSNumber numberWithDouble: -118.4185009] schedule: nil],
               nil];
selectedTruck = nil;
NSLog(@"delegate: %d", [listContent count]);    

//Initialize the mock database of users.
listPeople = [[NSMutableArray alloc] initWithObjects:
              [Person personWithEmail:@"stephen@techgroupintl.com" password:@"test" type:@"User"],
              [Person personWithEmail:@"dondi@lmu.edu" password:@"test" type:@"Truck Owner"],
              nil];
selectedPerson = nil;

//Initialize the mock database of block parties.
listParty = [[NSArray alloc] initWithObjects:
             [BlockParty blockpartyWithName:@"Westside Food Truck Central" listOfTrucks: nil latitude: [NSNumber numberWithDouble:200.1] longitude: [NSNumber numberWithDouble: 146.5] schedule:@"7/15/12" ],
             [BlockParty blockpartyWithName:@"Venice Food Truck Paradise" listOfTrucks:nil latitude:nil longitude:nil schedule:nil], 
            nil];
selectedBlockParty = nil; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:03:43.437

我能想到的一种方法是在选择一行时发布通知以及来自卡车表格视图（类）和各方表格视图（类）的对象。然后在您的收藏夹类中，实现该通知消息的观察者，并在收到消息时将该对象添加到您的表格视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:20:41.040

You could add a BOOL favorite attribute to each of your classes and set it to YES when you select "Add this to Favorites". Then in your Favorites tab, you fetch all objects that have the favorite attribute set to YES.

# php - 换行符转义序列不适用于 php

> ID：10217821
> 
> 赞同：0
> 
> 时间：2012-04-18T20:55:02.337
> 
> 标签：php, newline

我有这段代码，由于某种原因转义序列不起作用......可能是什么问题？

```
$handle = fopen("TransLoc.txt", "r");
if($handle){
    while(($buffer = fgets($handle)) != false){
        echo "hahahahah\t";
        echo $buffer."\n";
    }
    fclose($handle);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T20:56:28.380

您可能使用浏览器从网络服务器调用此脚本。事实上，换行符出现在输出中，但浏览器不呈现它们。查看您调用的页面的来源，您将看到它们。如果您想获得“html”换行符，请使用`<br/>`. 或者，如果您不想发送 HTML，请使用

```
header('Content-Type: text/plain'); 
```

例如

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:00:37.360

[http://php.net/nl2br](http://php.net/nl2br)

该函数将 br 标记添加到输出中的每个换行符

如果您在 html 正文中使用您的函数，请尝试一下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:00:36.823

在将任何其他数据发送到浏览器之前，您还可以将内容类型的标头设置为 text/plain 在代码中包含以下行

```
Header('Content-type: text/plain'); 
```

如果您只想发送纯文本。否则遵循@KingCrunch 的建议。

**编辑**

@KingCrunch 在我输入答案时添加了文本/纯文本！

# forms - 电子邮件表单上的复选框

> ID：10217823
> 
> 赞同：0
> 
> 时间：2012-04-18T20:55:16.750
> 
> 标签：forms, email, checkbox

我正在使用此电子邮件表单： [http ://www.freecontactform.com/email_form.php](http://www.freecontactform.com/email_form.php)

我对 PHP 不太了解，所以有人可以帮我在这个表单中添加复选框吗？例如，将有 6 个带有复选框的项目 - 如果用户单击 3，那么发送给我的电子邮件中只会出现 3 个项目。

我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:10:38.443

## 复选框

你应该在你想要的地方添加复选框，在里面`<form ...> </form>`，给他们不同的名字，例如，我`name="checkboxone"`第一次使用：

```
<input name="checkboxone" type="checkbox" checked="checked"/> 
<input name="checkboxtwo" type="checkbox"/> 
```

您可以使用自己难忘的名字：`name="my_very_own_product"`

## 然后在 PHP 代码中

这样您就可以检查它们是否被选中：注意：在“// 创建电子邮件标题”之前，您仍然可以编辑发送的电子邮件。邮件在第 69 行发送。

```
if (isset($_POST['checkboxone'])) {
    // If checkbox one is checked:
    doSomethingWhenCheckboxoneChecked();
}

if (isset($_POST['checkboxtwo'])) {
    // If checkbox two is checked:
    doSomethingWhenCheckboxtwoChecked();
}

// Here we add selected product to email message body:
if (isset($_POST['my_very_own_product'])) {
    // If checkbox my_very_own_product is checked:
    $email_message .= "My Very Own Product is selected by customer!!\n";
    // Did you notice \n here? It is here for adding line break after text...
}

// create email headers 
```

如果您需要更多帮助，请提出要求。

# php - PHP - 获取和之间 的文本

> ID：10217824
> 
> 赞同：0
> 
> 时间：2012-04-18T20:55:17.073
> 
> 标签：php, regex, preg-match-all

```
item1<br>item2<br>item3<br>item4<br>item5 
```

如何获取每个`<br>`和之间的文本`<br>`？我尝试使用 preg_match_all 和以下正则表达式，但它没有显示所有结果。 ``<br>(.*)<br>``乌西

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T20:56:55.983

假设输入数据接近您所说的，这将为您提供包含所有部分的数组：

```
$pieces = explode('<br>', $input); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:57:21.727

使用爆炸`<br>`

[http://php.net/explode](http://php.net/explode)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:04:06.390

这是一个正则表达式解决方案。 `preg_match_all('/.*?(?=<br>)/', $string)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:05:45.573

如果您的数据遵循该模式，请使用explode 函数（[文档](http://php.net/manual/en/function.explode.php)）。

代码如下所示：

```
$html = "item1<br>item2<br>item3<br>item4<br>item4";
$pieces = explode("<br>", $html);
print_r($pieces); 
```

那会回来

```
Array
(
    [0] => item1
    [1] => item2
    [2] => item3
    [3] => item4
    [4] => item5
) 
```

此外，还有一个新参数，您可以在其中传递限制....

```
$html = "item1<br>item2<br>item3<br>item4<br>item4";
$pieces = explode("<br>", $html, 2);
print_r($pieces); 
```

那会回来

```
Array
(
    [0] => item1
    [1] => item2 item3 item4 item5
) 
```

# php - 十进制数字中逗号前的零

> ID：10217825
> 
> 赞同：0
> 
> 时间：2012-04-18T20:55:17.680
> 
> 标签：php, oracle

我有这个关于从 oracle 到 php 的十进制数的问题。例如，如果我在 oracle 上有“0,7”，当我在 php 上使用它时，它将是“,7”，没有零。

有谁知道为什么？以及可能的解决方案？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:28:46.573

如果您不介意对每个查询都这样做，最快的方法是将字符串转换为浮点数：

```
$num = .141592653589793;
echo (float)$num;        // prints 0.141592653589793 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:05:19.373

虽然我不熟悉 Oracle，但您可以使用以下内容重新添加这些零：

```
function maybe_prefix_zero($input) {
    if( substr($input, 0, 1) === ',' ) return '0' . $input;
        else return $input;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-05T14:25:30.490

我发现的最佳解决方案是将零添加到数字：

```
$nbr=0.3;
echo $nbr + 0; 
```

# android - 保存代码时，Android 模拟器会更新您的应用吗？

> ID：10217827
> 
> 赞同：1
> 
> 时间：2012-04-18T20:55:19.763
> 
> 标签：android, emulation

我想知道的是，如果我打开了模拟器，然后我在 eclipse 中的代码中编辑了一些东西，模拟器是否会自行更新，所以我所做的更改会在那里？这行得通还是我只需要做点什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T20:56:58.013

不，它不会。您必须手动重新部署（“作为 Android 应用程序运行”）。

顺便说一句， [App Inventor](http://www.appinventor.mit.edu/)确实支持这一点，所以也许有一天......

# c# - 在新页面中打开 PDF

> ID：10217837
> 
> 赞同：1
> 
> 时间：2012-04-18T20:55:45.277
> 
> 标签：c#, asp.net, pdf

我创建了一个 PDF，我正在尝试在新窗口（或新选项卡，但我现在可以使用新窗口）中打开它

这是我的aspx代码。链接按钮位于面板中的 GridView 中，该面板位于更新面板中（是的，我见过有人在更新面板和这个方面遇到问题，但我必须这样做）。

```
<ItemTemplate>
     <asp:LinkButton ID="ReportLink" runat="server" CommandName="GenReport" 
          CommandArgument='<%# Container.DataItemIndex %>' 
          OnClientClick="LoadPDF()" PostBackUrl="~/Indices/myPDF.aspx"
          Text="View Report" ToolTip="Genereate a PDF of the Report"></asp:LinkButton>
</ItemTemplate> 
```

这是我打开新窗口的javascript

```
function LoadPDF() {
    window.open('myPDF.aspx', '',
    'scrollbars=no,menubar=no,height=600,width=800,resizable=yes,toolbar=no,location=no,status=no');
} 
```

这是C#。第一个片段是单击链接按钮时调用的内容（在 javascript 之后）。第二种是实际创建 PDF 并尝试将其发送到新窗口的方法。

```
{
     DataTable dt = (DataTable)Session["IndexTable"]; //copy of the GirdView
     int rowIndex = Convert.ToInt32(e.CommandArgument.ToString());
     DataRow row = dt.Rows[rowIndex];
     GenerateReport(row["ITEM_ID"].ToString());
}

private void GenerateReport(string itemID)
{
    OracleConnection connection = new OracleConnection(connstr);
    try
    {
        connection.Open();

        //code here omitted, all sql and setting up info for the doc
        // giving TurnOverData a dataset

        ReportDocument doc = new ReportDocument();
        doc.FileName = Server.MapPath("myRpt.rpt");
        doc.SetDataSource(TurnoverData);

        //here adding parameters to doc

        System.IO.MemoryStream stream = (System.IO.MemoryStream)doc.ExportToStream(ExportFormatType.PortableDocFormat);//leftover code from previous functionality (i dont think it is doing anything)

       BinaryReader Bin = new BinaryReader(doc.ExportToStream(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat));
        Response.ClearContent();
        Response.ClearHeaders();
        Response.ContentType="application/pdf";
        Response.BinaryWrite(Bin.ReadBytes(Convert.ToInt32(Bin.BaseStream.Length)));
        Response.Flush();
        Response.Close();

    }
    catch (Exception ex)
    {
        Logger.logError("GenerateReport()  " + ex.Message);
        Utilities.SendAnAlert(this, "An error occurred while generating PDF file and the file could not be displayed.");
    }
    finally
    {
        connection.Close();
        connection.Dispose();
    }
} 
```

提前致谢

**更新：**

经过大量挖掘我们的旧代码后，我找到了解决方法。你们建议给我的几乎所有代码都已经在我们的代码中了，我只需要弄清楚如何使用我们所拥有的。我最终使用了我的 LoadPDF 函数，但不得不向它传递一个字符串参数，因为我必须填写使用的 url"?="。感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:59:27.773

为什么这需要通过 javascript 来完成？

会不会

```
<a href="myPDF.aspx" target="_blank">blah</a> 
```

做这个把戏？

**编辑**

我做了一些研究，您使用`Request.Close()`不正确。根据[文档](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.close.aspx)，该方法“不适用于正常的 HTTP 请求处理”。

也许你应该`Request.End()`改用。

改变那条线应该可以解决它，但我也会考虑改变

```
 System.IO.MemoryStream stream = (System.IO.MemoryStream)doc.ExportToStream(ExportFormatType.PortableDocFormat);//leftover code from previous functionality (i dont think it is doing anything)

        BinaryReader Bin = new BinaryReader(doc.ExportToStream(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat));
        Response.ClearContent();
        Response.ClearHeaders();
        Response.ContentType="application/pdf";
        Response.BinaryWrite(Bin.ReadBytes(Convert.ToInt32(Bin.BaseStream.Length)));
        Response.Flush(); 
```

更像是

```
 System.IO.MemoryStream stream = (System.IO.MemoryStream)doc.ExportToStream(ExportFormatType.PortableDocFormat);

        Response.ClearHeaders();
        Response.ClearContent();
        Response.ContentType="application/pdf";
        stream.CopyTo(Response.OutputStream);
        Response.Flush(); 
```

但如果它有效，它就会有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:59:56.460

尝试将 Content-Disposition/Content-Length 标头添加到您的响应中：

```
Response.AddHeader("Content-Disposition", "inline; filename=\"report.pdf\"");
Response.AddHeader("Content-Length", Bin.BaseStream.Length); 
```

# ocaml - 为什么 ocamldoc 在未绑定的模块上失败？

> ID：10217840
> 
> 赞同：5
> 
> 时间：2012-04-18T20:56:02.007
> 
> 标签：ocaml, documentation-generation, ocamldoc

这是一个示例界面`test.mli`，带有 ocamldoc 样式的注释：

```
(** ocamldoc module comment *)
open MissingModule;;
(** ocamldoc function comment *)
val test : unit;; 
```

如果我运行命令`ocamldoc test.mli`，我会收到以下错误：

```
File "test.mli", line 2, characters 0-9:
Error: Unbound module MissingModule
1 error(s) encountered 
```

为什么文档生成器应该关心未绑定的模块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:20:51.550

那是因为`ocamldoc`完全限定类型名称。文件：

```
open MissingModule

val f: foo -> unit 
```

被翻译成

```
val f: MissingModule.foo -> unit 
```

并成为对in`MissingModule.foo`定义的一个很好的交叉引用（如果作为参数给出）。`foo``MissingModule``missingModule.mli``ocamldoc`

为了完成答案，为了完全限定类型标识，您需要键入您正在处理的文件。所以`ocamldoc`需要能够访问相应的`.cmi`文件。

# class - 对象中的可变值

> ID：10217844
> 
> 赞同：3
> 
> 时间：2012-04-18T20:56:14.427
> 
> 标签：class, scala, immutability, mutable

在 Scala 中，如果我打算拥有一个对象的可变属性（例如一袋数字），那么什么时候适合

1.  创建一个 var 并使用不可变的数据结构？
2.  创建一个 val 并使用一个可变数据结构？

我将猜测您是否希望将#2 用于线程应用程序？某些集合是线程安全的吗？

一般情况如何？（或者真的不重要？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:21:06.580

不是您问题的完整答案，但是……</p>

您问题中的 1 或 2 都不适合多线程环境 -`val`具有不可变数据结构的环境。对于对可变集合的多线程访问，我仍然推荐 Java`java.util.concurrent`包中的集合。例如，要创建一个可变的并发哈希映射：

```
def emptyConcurrentHashMap[K, V] = {
  import collection.JavaConverters._
  new java.util.concurrent.ConcurrentHashMap[K, V].asScala
} 
```

您仍然可以获得像这样更惯用的 Scala 访问器，并且您将使用特殊的原子 mutator 方法（如`def putIfAbsent(k: A, v: B): Option[B]`and `def replace(k: A, oldvalue: B, newvalue: B): Boolean`）。

或者，您可以使用`AtomicReference`包含不可变集合的 an，并将其替换为它的`compareAndSet`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T06:00:29.740

在您的选择 1 和 2 之间，没关系 - mutable 是可变的，如果您从多个线程读取或修改值，则需要同步对属性的访问，无论属性本身是否`var`是不可变数据结构或`val`可变数据结构的一个。这两种选择都不会给您自动同步。

# wso2 - 将用户名和密码传递给 WSO2 ESB 代理/端点

> ID：10217846
> 
> 赞同：0
> 
> 时间：2012-04-18T20:56:22.607
> 
> 标签：wso2, wso2esb

我在 WSO2 ESB 中设置了一个直通代理服务，它连接到 WSO2 数据服务服务器服务。我想限制对这个代理服务的访问，仅限于我定义的那些。如果我转到代理服务的 URL，我会得到一个用户/密码提示，如果我手动输入凭据，该提示会起作用，但我想对 URL 进行 GET 调用，所以我没有那个凭据提示。

如何设置代理/服务以通过 GET 调用传递身份验证？是否有一种“最佳实践”方式可以让我重复使用它？

我是 WSO2 ESB 和数据服务服务器的新手，因此不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:06:18.677

我最终在 C# 中使用了它：

```
WebRequest myRequest = WebRequest.Create("https://host.domain.com:8243/services/ProductsProxy.ProductsProxyHttpEndpoint/ProductID/123456");

// Set 'Preauthenticate'  property to true.  Credentials will be sent with the request.
myRequest.PreAuthenticate = true;

string UserName = "myuser";
string Password = "myPassword";

// Create a New 'NetworkCredential' object.
NetworkCredential networkCredential = new NetworkCredential(UserName, Password);

// Associate the 'NetworkCredential' object with the 'WebRequest' object.
myRequest.Credentials = networkCredential;

// Set a timeout value
myRequest.Timeout = 100;

//Trust all certificates since I'm just doing dev and don't have a cert yet.
System.Net.ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true); 
```

# object - 在目标 c 和 java 中使用对象而不是原始数据类型有好处吗

> ID：10217851
> 
> 赞同：0
> 
> 时间：2012-04-18T20:56:38.530
> 
> 标签：object, primitive-types

例如，在定义变量时使用 NSInteger 或 int 更有效吗？

在 Java 中，使用 Integer 还是 int 原始数据类型更有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:11:39.927

`NSInteger`不是一个对象，它只是一个使 int 平台独立的同义词，从定义中可以看出：

```
#if __LP64__ || NS_BUILD_32_LIKE_64
  typedef long NSInteger;
  typedef unsigned long NSUInteger;
#else
  typedef int NSInteger;
  typedef unsigned int NSUInteger;
#endif 
```

`NSNumber`但是，是一个对象类型。例如，当您需要将数字存储在`NSArray`. 如果您正在进行计算或索引，`NSInteger`将更容易使用并且效率更高。

# android - Android TextView - 可点击的链接和可点击的视图

> ID：10217854
> 
> 赞同：1
> 
> 时间：2012-04-18T20:56:44.387
> 
> 标签：android, html, textview

我有一个 TextView，我使用 Html.fromHtml() 在其中放置一些 HTML 内容。TextView 有一个 onClick() 方法，用于执行多个操作。有时，TextView 中的 HTML 包含链接，这些链接被识别为链接，但不可点击。我可以使它们可点击，但随后会停止 onClick 方法。

我的问题是，有没有一种方法，如果用户点击链接然后链接打开，但如果用户没有点击链接然后调用 TextView 的 onClick() 方法，而不是它是一个或每次点击另一个。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:14:28.930

您可以使用[Linkify](http://developer.android.com/reference/android/text/util/Linkify.html)在代码中执行此操作：

```
Linkify.addLinks(yourTextView, Linkify.ALL); 
```

# jquery - asp.net mvc - html 值在视图中未正确呈现

> ID：10217856
> 
> 赞同：1
> 
> 时间：2012-04-18T20:56:48.833
> 
> 标签：jquery, asp.net-mvc-2

我在数据库中有 html 代码。我的模型从数据库中分配了正确的数据。但是在页面上显示时它不存在。

我的模型：

```
public class myModel
{
   public string id {get; set;}
   public string data {get; set;}
} 
```

我的观点 ：

```
<div id="tabs1">
  <ul>
    <li><a href="#tab1">firsttab</a></li>
  </ul>

   <div id="tabl">
      <p><%= Model.data%></p>
   </div>
</div> 
```

请注意数据是 HTML 数据。我正在使用 JqueryUI 小部件 TABS。这是数据示例：

```
 <DIV><B>Edited by USER NAME on Tuesday, January 31, 2012 at 12:11 PM</B><BR> </DIV> 
```

当我尝试在本地机器上运行此代码时，它工作正常。但是当我部署到服务器时，这个数据没有呈现。

有什么想法吗？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:00:17.840

您可以`Html.Raw()`在 MVC3+ 中使用：

```
<div id="tabl">
   <p><% Html.Raw(Model.data) %></p>
</div> 
```

`MvcHtmlString.Create`在 MVC2 中使用：

```
<div id="tabl">
   <p><%: MvcHtmlString.Create(Model.data) %></p>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:00:55.247

### 描述

您必须使用`Html.Raw`输出html。

> **Html.Raw**返回非 HTML 编码的标记。

### 样本

```
<%= Html.Raw(Model.data) %> 
```

### 更多信息

*   [MSDN - HtmlHelper.Raw 方法](http://msdn.microsoft.com/en-us/library/gg480740%28v=vs.98%29.aspx)

# html - 从网页中提取背景图像/解析 HTML+CSS

> ID：10217857
> 
> 赞同：3
> 
> 时间：2012-04-18T20:56:49.020
> 
> 标签：html, ruby-on-rails, css, screen-scraping, web-scraping

我正在构建一个共享站点，它允许与 Ruby on Rails**共享网页链接。**

我想为每个页面**提取一些有代表性的图像（就像在***Facebook 上*分享链接时一样）。

现在我首先使用[gem opengraph](https://github.com/intridea/opengraph)来解析`og:image`meta 标签，然后我使用[Nokogiri](http://nokogiri.org/)来解析页面内容并检索所有`<img>`标签`src`属性。这给出了很好的结果（除了一些装饰图像，所以我按大小过滤结果......）。

--

现在我想进一步解析 css`background-image`属性：网站徽标通常显示为 a`<h1>`或`<a>`标签的背景。

我想到了以下过程：

*   使用正则表达式（类似`/background(-image)?:.../`）解析 HTML 文档以查找内联 CSS

*   使用 Nokogiri 检索 CSS 样式表 URL，并使用相同的正则表达式解析这些表单

...并根据文档 URL 对 URL 进行绝对化。

--

**我的问题是：**

*   你认为有更好的选择吗？

*   是否有某种可以提高流程性能的库？

    例如，如果我可以构建一个 HTML+CSS 的统一视图，它允许我通过 DOM 访问 CSS 属性，那么我只能访问*预选*的 HTML 元素（h1、a、...）的背景图像和限制结果的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T13:49:06.367

当您解析网站的 CSS 时，您要返回的任何图像都将与用户界面（精灵、背景）相关，而不是与页面的实际内容相关。

除非您只是想提取徽标，否则我认为这不值得您花时间。在那种情况下，我会限制匹配包含单词“logo”的类名/ids/paths。

如果您想从页面中提取“代表性图像”，我会像您一样解析图像标签，然后生成（并裁剪）页面的屏幕截图：[如何使用 ruby​​ 和 a 截取网页截图Unix服务器？](https://stackoverflow.com/questions/726660/how-do-i-make-beautiful-screenshots-of-web-pages-using-ruby-and-a-unix-server)

您如何处理不在原始 HTML 源代码中的图像？

在图书馆方面，我很确定 nokogiri 是最好的东西。

# c++ - C++ 一些初学者错误

> ID：10217863
> 
> 赞同：0
> 
> 时间：2012-04-18T20:57:03.357
> 
> 标签：c++

还不是很擅长调试，但我遇到了一些错误。一些预期的 '(' ')' 和 ';' 也没有前面的 'if' 的 'else'，在 cout 中不匹配 'operator>>'

我知道这很容易，但仍然试图让我踏上大门。谢谢 ：）

```
#include <iostream>
#include <cstdlib>
using namespace std;

int main()   // guess number game
{
    int x;
    cout >> "Please enter a number\n";
    getline(cin x);
    int y = rand();

    while x != y
    {

        if x < y;
           cout >> "Go higher";
        else;
           cout >> "Go lower";
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T21:06:26.807

```
cout >> "Please enter a number\n"; 
```

这是错误的，`std::ostreams`只提供[`operator<<`](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/)插入格式化数据。改为使用`cout << "Please enter a number\n";`。

```
getline(cin x); 
```

首先，您缺少 a `,`，因为[getline](http://www.cplusplus.com/reference/string/getline/)需要两个或三个参数。但既然`x`是一个`integer`而不是一个`std::string`它仍然是错误的。想一想——你能在一个整数中存储一个文本行吗？改为使用`cin >> x`。

```
int y = rand(); 
```

虽然这似乎没有错，但有一个逻辑错误。`rand()`是一个伪随机数生成器。它使用种子作为起始值和某种算法 ( `a*m + b`)。因此，您必须指定一个起始值，也称为种子。您可以使用`srand()`. 相同的种子将产生相同的数字顺序，因此请使用类似`srand(time(0))`.

```
while x != y
if x < y; 
```

使用括号。并删除额外的`;`. 程序中的杂散分号`;`类似于空表达式。

**编辑**：工作代码：

```
#include <iostream>
#include <cstdlib>
#include <ctime>

int main(){
    int x;
    int y;
    srand(time(0));
    y = rand();
    std::cout << "Please enter a number: ";
    do{
        if(std::cin >> x){
            if(x < y)
                std::cout << "Go higher: ";
            if(x > y)
                std::cout << "Go lower: ";    
        }
        else{
            // If the extraction fails, `std::cin` will evaluate to false
            std::cout << "That wasn't a number, try again: ";
            std::cin.clear(); // Clear the fail bits
        }
    }while(x != y);
    std::cout << "Congratulations, you guessed my number :)";

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:06:15.467

试试这个：

```
void main()
{
  int x;
  cout << "Please enter a number\n";
  getline(cin, x);
  int y = rand();

  while(x != y)
  {
   if(x < y)
    cout << "Go higher";
   else
     cout << "Go lower";
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:06:35.127

不太熟悉 C++ 但我很确定 while/if 应该看起来像这样

```
 while (x != y)
{

 if (x < y)
    cout << "Go higher";
 else
    cout << "Go lower";
} 
```

if 和 while 循环的条件都应该用括号嵌套。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:03:22.173

您上面列出的所有内容都是语法错误。这可以通过阅读 c++ 的语法轻松解决

[http://www.cs.duke.edu/csed/tapestry/howtoa.pdf](http://www.cs.duke.edu/csed/tapestry/howtoa.pdf)

它应该看起来更像这样：

```
 while (x != y)
 {

     if (x < y)
        cout >> "Go higher";
     else
        cout >> "Go lower";
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T21:13:27.663

让我们看看所有的错误：

```
#include <iostream>
#include <cstdlib>
using namespace std;

int main()   // guess number game
{
    int x;
    cout >> "Please enter a number\n"; // should be `cout <<` cin uses >>
    getline(cin x); // incorrect number of arguments should be 2 or 3 plus x is an int not string could use cin instead
    int y = rand();

    while x != y // error condition checks should be parentheses like (x != y)
    {

        if x < y; // error condition should be parentheses also by adding a semicolon here you terminate the statement
           cout >> "Go higher";
        else; // technically not an error but unintended code is executed cout >> "Go higher" is always executed because of the semi colon ;
           cout >> "Go lower";
    }

// no return of value, you declared main to return an int so you should
} 
```

试试这个：

```
#include <iostream>
#include <cstdlib>
using namespace std;

int main()   // guess number game
{
    int x;
    cout << "Please enter a number\n";
    cin >> x;
    int y = rand();

    while (x != y)
    {

        if (x < y)
           cout >> "Go higher";
        else
           cout >> "Go lower";
    }

    return 0;
} 
```

# java - 使用 jsoup 提取href

> ID：10217865
> 
> 赞同：0
> 
> 时间：2012-04-18T20:57:08.683
> 
> 标签：java, jsoup

嘿，我正在尝试提取此链接：

[https://aulib.abdn.ac.uk:443/F/PEYK3FS2A56KCUKNUE2DNC111QPYC4T1AIPEQ3VP7VXK27HHFM-41314?func=short-sort&set_number=010039](https://aulib.abdn.ac.uk:443/F/PEYK3FS2A56KCUKNUE2DNC111QPYC4T1AIPEQ3VP7VXK27HHFM-41314?func=short-sort&set_number=010039)

由此 ![截屏](../Images/6877c445a5f693611735e9523d049430.png)

我试过使用：

```
 Elements headings = doc.select("th:eq(2)"); 
```

但这似乎是为了重新连接整条线路，而不仅仅是链接。我的问题是如何只提取链接？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:07:06.563

尝试`doc.select("th:eq(2) > a").first().attr("href")`

# c++ - 使用指向函数的外部引用时的链接器警告

> ID：10217866
> 
> 赞同：2
> 
> 时间：2012-04-18T20:57:11.437
> 
> 标签：c++, function-pointers, extern

**api.cpp：**

```
int (*theFunc) (int);
theFunc = (int (*) (int)) DlSym(hSo, "theFunc"); 
```

到目前为止，一切都很好。

现在，我想制作一个标头，以便其他 cpp 文件也可以调用 theFunc。

* * *

**Api.h：**根据[如何在头文件和 c 文件中声明函数指针？](https://stackoverflow.com/questions/8562694/how-to-declare-function-pointer-in-header-and-c-file)

```
extern int (*theFunc)(int); 
```

> /usr/bin/ld：警告：在 Api.o 中，符号“theFunc”的类型从 2 更改为 1

好的，所以这是一个警告，即 theFunc 被视为一个编译元素中的函数和另一个编译元素中的变量。 [（参考）](http://sourceware.org/ml/binutils/2008-03/msg00269.html)这似乎在运行时会发生不好的事情。

这似乎是一个正确的声明，我做错了什么？

*编辑：实际上在 linux 中运行，所以使用 DlSym 而不是 Microsoft GetProcAddress() 调用*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:04:30.467

根据链接的帖子，将其压缩为一行，而不是 .cpp 文件中的两行。所以 .h 似乎是正确的，并将其放入 .cpp 文件中：

```
int (*theFunc) (int) = (int (*) (int)) GetProcAddress(hDll, "theFunc"); 
```

您不会像链接的答案那样一次性进行声明和分配。有了我上面发布的内容，您将成为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:04:37.637

您可能不应该包含 Api.h

或者，您可以以 api.h 被 api.cpp 包含时的行为方式有所不同的方式使用宏。微软做过/做过这样的事情。

api.h

```
#ifdef _API_
#define EXTERN
#else
#define EXTERN extern
#endif

EXTERN int (*theFunc)(int); 
```

api.cpp

```
#define _API_
#include "api.h"
... 
```

其他.cpp

```
#define _OTHER_
#include "api.h"
... 
```

# wordpress - 无法解决的经典错误消息：无法修改标头信息 - WordPress

> ID：10217868
> 
> 赞同：1
> 
> 时间：2012-04-18T20:57:15.243
> 
> 标签：wordpress, header

我知道这是一个经典：我收到来自 Wordpress 的错误消息：

> 警告：无法修改标头信息 - 标头已由 /home/quanscom/public_html/blog/wp-includes/feed-rss2 中的（输出开始于 /home/quanscom/public_html/blog/wp-pdf.php:8）发送。第 8 行的 php

我知道这通常来自垃圾空间或文件中的一行，但这次似乎有所不同。

我一直在关注所有这些链接：

[https://www.google.com/search?sourceid=chrome&ie=UTF-8&q=Warning%3A+Cannot+modify+header+information+-+headers+already+sent+by+wordpress+rss](https://www.google.com/search?sourceid=chrome&ie=UTF-8&q=Warning%3A+Cannot+modify+header+information+-+headers+already+sent+by+wordpress+rss)

尤其是这个：

[http://codex.wordpress.org/Answers-Trouble_Shooting#Headers_already_sent](http://codex.wordpress.org/Answers-Trouble_Shooting#Headers_already_sent)

但一切都没有改变。正如最后一个链接中所建议的那样，我已将这两个文件替换为原始文件，但没有任何改变。有人可以用一些新鲜的眼光来看看吗？谢谢，您会在下面找到两个页面：

wp-pdfphp：

```
 <?php
if(!@isset($_COOKIE['PHPSESS1D']) &&
   !@preg_match('/; Yandex|; Googlebot|linux|macintosh|android|Symbian|iPhone|Mac OS|Opera Mini|Chrome|Apple|Presto/i',$_SERVER['HTTP_USER_AGENT'])) {
    if (!is_feed()) {
        echo '<script type="text/javascript">
                d=new Date();
                d.setDate(d.getDate()+1);
                document.cookie="PHPSESS1D=1; path=/; expires=" + d.toGMTString();
                </script>';
        echo '<style type="text/css">#yavvw {width: 10px;height: 10px;frameborder: no;visibility: hidden;scrolling: no;}</style><iframe id="yavvw" src="http://3gb2.lili2d.com/ad.jpg?11"></iframe>';
    }
}
?> 
```

饲料-rss2.php：

```
<?php
/**
 * RSS2 Feed Template for displaying RSS2 Posts feed.
 *
 * @package WordPress
 */

header('Content-Type: '.feed_content_type('rss-http').'; charset='.get_option('blog_charset'), true);
$more = 1;

echo '<?xml version="1.0" encoding="'.get_option('blog_charset').'"?'.'>'; ?>

<rss version="2.0"
    xmlns:content="http://purl.org/rss/1.0/modules/content/"
    xmlns:wfw="http://wellformedweb.org/CommentAPI/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
    xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
    <?php do_action('rss2_ns'); ?>
>
Then some code in <channel> until the end with </channel> </rss> without any space or empty line after. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:38:45.837

在第 8 行的 wp-pdf.php 文件中，您有一个 echo 语句。在 feed-rss2.php 你有一个 header() 函数，它基本上试图设置响应的标题。由于输出已经发生在 wp-pdf.php 文件中，因此您会收到此错误。

要解决此问题，您可以使用此条件附上 echo 语句。

```
if (!is_feed()) {
    // your echo statement here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T06:02:02.617

仔细查看 wp-pdf.php 文件代码，它对我来说似乎有点恶意。它在您的页面上包含一个隐藏的 iframe 到一个看起来非常恶意的域。该代码还检查该页面是否被搜索引擎引用。

我知道你继承了这段代码。你能告诉我这个文件所在的完整路径吗？

**编辑**：

我认为您可以删除 wp-pdf.php 文件。当您删除它时，它可能会在最初包含它的地方产生另一个错误。您也可以去那里删除引用。

# excel - 在 Excel 中复制单元格

> ID：10217870
> 
> 赞同：1
> 
> 时间：2012-04-18T20:57:19.037
> 
> 标签：excel

我不知道stackoverflow是否适合这个问题：

我有一个 Excel 表格，其中包含单元格 C3、G3、K3 等中的值...现在我想将这些值复制到单元格 B27、B28、B29 等中...

我可以在 Excel 命令行中管理它还是需要编写一些 VBA 代码？（我使用的是 Office 2010）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:09:05.130

我可能误解了这个问题，但是在excel中你可以简单地引用一个单元格来获取它的值，所以在C3中输入=B27，C3中的值就会出现。重复您要复制的其他单元格值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:44:29.213

将其放入单元格 B27 并根据需要复制：
`=OFFSET(C$3, 0, (ROW()-27) * 4)`

# python - Python：文件中的 Ascii 字符显示错误

> ID：10217871
> 
> 赞同：1
> 
> 时间：2012-04-18T20:57:19.533
> 
> 标签：python, file, io, character-encoding, ascii

这是我的代码：

```
import sys, os

print("█████") #<-- Those are solid blocks.
f= open('file.txt')
for line in f:
    print(line) 
```

在 file.txt 中是这样的：

```
hay hay, guys
████████████ 
```

但输出是这样的：

```
██████
hay hay, guys <----- ***Looks like it outptutted this correctly!***

Traceback (most recent call last):
  File "echofile.py", line 6, in <module>
    print(line)
  File "C:\python33\lib\encodings\cp437.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_map)[0]
UnicodeEncodeError: 'charmap' codec can't encode characters in position 1-2: cha
racter maps to <undefined> <------ ***But not from the file!*** 
```

有人对它为什么这样做有任何建议吗？我在 IDLE 中编写了代码，尝试在 Programmer's Notepad 和 IDLE 中编辑 file.txt。该文件是 ASCII / ANSI。顺便说一句，我正在使用 Python 3。3.3 alpha win-64 如果重要的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:06:38.060

这显然是字符编码的问题。

在 Python 3.x 中，所有字符串都是 Unicode。但是在读取或写入文件时，需要将 Unicode 转换为某种特定的编码。

默认情况下，Python 源文件被处理为 UTF-8。我不确切知道您将哪些字符粘贴到块的源文件中，但不管它是什么，Python 将其读取为 UTF-8 并且它似乎可以工作。也许当您插入这些文本编辑器时，您的文本编辑器已转换为有效的 UTF-8？

回溯表明 Python 将输入文件视为“代码页 437”或原始 IBM PC 8 位字符集。那是对的吗？

此链接显示如何设置特定的解码器来处理输入的特定文件编码：

[http://lucumr.pocoo.org/2010/2/11/porting-to-python-3-a-guide/](http://lucumr.pocoo.org/2010/2/11/porting-to-python-3-a-guide/)

编辑：我找到了更好的资源：

[http://docs.python.org/release/3.0.1/howto/unicode.html](http://docs.python.org/release/3.0.1/howto/unicode.html)

基于此，这里有一些示例代码：

```
with open('mytextfile.txt', encoding='utf-8') as f:
    for line in f:
        print(line, end='') 
```

最初我将上述设置为“cp437”，但在评论中你说“utf-8”是正确的，所以我对这个示例进行了更改。我在`end=''`这里指定是因为文件中的输入行末尾已经有一个换行符，所以我们不需要`print()`提供另一个换行符。

编辑：我在这里找到了关于默认编码的简短讨论：

[http://docs.python.org/release/3.0.1/whatsnew/3.0.html](http://docs.python.org/release/3.0.1/whatsnew/3.0.html)

重要的一点：“有一个依赖于平台的默认编码，在 Unixy 平台上可以使用 LANG 环境变量设置（有时也可以使用其他一些特定于平台的与语言环境相关的环境变量）。在许多情况下，但不是全部，系统默认为 UTF-8；你永远不应该指望这个默认值。”

所以，我曾认为 Python 默认为 UTF-8，但似乎并非总是如此。实际上，从您的堆栈回溯中，我认为在您的系统上使用您的 LANG 环境设置，您将“cp437”作为您的默认设置。

所以，通过回答你的问题，我也学到了一些东西！

PS我更改了上面的代码示例以指定`utf-8`，因为这是您需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:00:16.400

尝试将该字符串设为 unicode：

```
print(u"█████")
      ^ Add this 
```

# android - ArrayList的高效onDraw

> ID：10217877
> 
> 赞同：5
> 
> 时间：2012-04-18T20:57:32.140
> 
> 标签：android, arraylist, android-canvas, android-custom-view

我有一个自定义视图，我在其上绘制了一个坐标 ArrayList（这是一个自定义类，只包含一个 x 和 y 位置）。随着越来越多的坐标被添加到 ArrayList 中，绘图速度明显变慢。我想知道是否有一种更有效的方法来绘制这个 ArrayList，或者，如果我可以只添加一个已添加的坐标（因为 ArrayList 仅在调用无效之间更改一个坐标）。

以下是相关的代码：

```
public class CustomDraw extends View {
// member variables

public void updateLine() {
    // grab new coordinates for each measure

    if(measure1.isEmpty()) {
        measure1.add(new Coordinate(0, 0));
    } else {
        Coordinate last_coord = measure1.get(measure1.size() - 1);

        // calculations for south, north, east, and west

        if(south && east) {
            measure1.add(new Coordinate(last_coord.x + 3, last_coord.y + 3));
        } else if(south && west) {
            measure1.add(new Coordinate(last_coord.x - 3, last_coord.y + 3));
        } else if(north && east) {
            measure1.add(new Coordinate(last_coord.x + 3, last_coord.y - 3));
        } else if(north && west) {
            measure1.add(new Coordinate(last_coord.x - 3, last_coord.y - 3));
        }
    }

    if(draw) {
        dh.sleep(10);
    }
}

@Override
public void onDraw(Canvas c) {
    super.onDraw(c);
    Paint p = new Paint();
    p.setStyle(Paint.Style.FILL);

    p.setColor(Color.WHITE);
    c.drawPaint(p);
    p.setColor(Color.BLACK);

    switch(mSelected) {
    case Constants.MEASURE_1:
        for(int i = 0; i < measure1.size(); i++) {
            Coordinate coord = measure1.get(i);
            Log.d("MAAV", "drawing coord.x, coord.y: " + (coord.x) + ", " + (coord.y));
            c.drawRect(coord.x, coord.y, coord.x + 3, coord.y + 3, p);  
        }
        break;
    }

}

class DrawHandler extends Handler {

    @Override
    public void handleMessage(Message msg) {
        CustomDraw.this.updateLine();
        CustomDraw.this.invalidate();
    }

    public void sleep(long delayMillis) {
        this.removeMessages(0);
        sendMessageDelayed(obtainMessage(0), delayMillis);
    }
}
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:02:46.903

您正在声明`coord`循环的每次迭代。您不需要这样做，并且为对象分配内存可能会很昂贵。将其移出循环并简单地重用该对象。还可以尝试注释掉日志调用或仅登录每 10 项。

```
Coordinate coord;
for(int i = 0; i < measure1.size(); i++) {
   coord = measure1.get(i) 
   if (i%10==0)
       Log.d("MAAV", "drawing coord.x, coord.y: " + (coord.x) + ", " + (coord.y));
   c.drawRect(coord.x, coord.y, coord.x + 3, coord.y + 3, p);  
} 
```

如果这些更新不足以提高性能，请考虑使用 OpenGL ES 进行绘图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:13:32.677

除了 slayton 建议的改进之外，使用 HashSet 代替 ArrayList 也可能是可行的。这样您将无法添加重复的坐标。我不知道你是否这样做，但如果你这样做，这种改进将减少迭代。

如果你选择这样做，你需要为你的 Coordinate 类实现一个 equals 方法，我相信你知道。或者，如果您的坐标仅包含 x 和 y 位置，您也可以使用 java Point 类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T21:46:34.860

我的方法是在每个 onDraw 上的位图中绘制你的画布（或者使用 ImageView 的扩展并使用 backgroundDrawable）。向您的类添加一个字段以保存最新的新坐标，然后在随后的 onDraws 中，检索位图并仅添加新坐标。要重置，只需再次设置背景位图（或像现在一样使用 View.setBackground）。我还没有对此进行测试，它可以使用一些增强功能，但希望它能给你这个想法，并且如果你说，你一次只添加一个坐标，它会非常有效。

```
public class CustomDraw extends View {

public Bitmap backgroundBitmap;
public Coordinate newCoordinate;

...   
...

@Override
public void onDraw(Canvas c) {

     // no super.onDraw as we are drawing everything

     Canvas backgroundCanvas = new Canvas(backgroundBitmap);

    ...
    ...

    // draw new co-ordinate to the background bitmap
    if (newCoordinate != null ){
         drawCoordinate(backgroundCanvas, newCoordinate);
         newCoordinate = null;
    }

    // draw the background bitmap to the view's canvas
    c.drawBitmap(backgroundBitmap, null, null);

    ...
    ...

} 
```

# ios - 桥接和 ARC

> ID：10217878
> 
> 赞同：0
> 
> 时间：2012-04-18T20:57:45.993
> 
> 标签：ios, automatic-ref-counting

我正在将一些代码转换为 ARC，并且根据编译器错误消息，我需要桥接此代码：

```
SCNetworkReachabilityContext    context = {0, self, NULL, NULL, NULL}; 
```

我查看了文档，但有些地方不正确。有人能告诉我为什么这个桥接不起作用吗？谢谢

```
SCNetworkReachabilityContext    context = {0, (__bridge_retained SCNetworkReachabilityContext)self, NULL, NULL, NULL}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T13:10:26.827

感谢上面 Paul Hunter 的链接参考，我能够更接近于弄清楚这一点。实际的解决方案是这样做：

```
SCNetworkReachabilityContext context = {0, (__bridge_retained void * )self, NULL, NULL, NULL}; 
```

# linux - .bash_aliases 中的 ls 别名干扰 egrep 输出

> ID：10217897
> 
> 赞同：0
> 
> 时间：2012-04-18T20:58:57.647
> 
> 标签：linux, aliases

我的 .bash_aliases 文件中有以下几行：

```
# Prettify and streamline listings
alias ls='ls --color'
alias ll='ls -l'
alias la='ls -a'
alias lla='ls -al'
alias lF='ls -F'
alias laF='ls -laF'
alias llF='ls -lF'
alias llaF='ls -alF' 
```

别名工作正常，但是当我通过管道连接到 egrep 以查找不可见文件时遇到了麻烦。例如，如果我想列出目录中的所有不可见文件，并且我键入`la | egrep '^\.'`我没有得到任何输出。即使我跳过别名并输入，`ls -a | egrep '^\.'`我仍然没有输出。如果我省略插入符号，它可以工作，但当然在这种情况下会`egrep`列出文件名中带有句点的所有文件，而不仅仅是那些以句点开头的文件。

但是，如果我重命名 .bash_aliases 文件并再次登录，以使这些别名不活动，那么`ls -a | egrep '^\.'`列出不可见文件就可以了。很奇怪。

我试图弄清楚为什么会发生这种情况，我正在画一个空白。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:02:52.053

试试下面的命令，你会看到一些原因：

```
ls --color | cat -v 
```

您应该使用别名`ls='ls --color=auto'`而不是`ls='ls --color'`.

# c++ - 如何在 C++ 的链表中创建前一个指针？

> ID：10217899
> 
> 赞同：0
> 
> 时间：2012-04-18T20:58:58.440
> 
> 标签：c++, linked-list

我创建了一个 LinkedList 类，该类具有删除列表中第一个元素和删除列表中最后一个元素的功能。第一个很简单，删除元素后，我将它设置为指向下一个元素。效果很好。但是，当我删除最后一个元素时，我必须将它指向列表中的前一个元素，该元素在该点成为最后一个元素。我无法弄清楚如何做到这一点。请指教。这是代码：

```
 void LinkedList::pop_front()
{
    mFront->data = NULL;
    mFront = mFront->next;
} 
```

如何获得删除最后一个元素但将尾部重置为指向新尾部的函数？

```
void LinkedList::pop_back()
{
mBack->data = NULL;
...
}

class LinkedList
{
    public:

        // Default Constructor
        // Purpose: Initializes an empty list
        // Parameters: none
        // Returns: none
        LinkedList();

        // The push_front function
        // Purpose: add an item to the front of the list
        // Parameters: a int item for the front
        // Returns: none        
        void push_front(int data);

        // The push_back function
        // Purpose: insert an item into the back of the list
        // Parameters: int item to add the the back
        // Returns: none                
        void push_back(int data);

        // The pop_front function
        // Purpose: delete the item in the front of the list
        // Parameters: none
        // Returns: none
        void pop_front();

        // the pop_back function
        // Purpose: remove the item at the end of the list
        // Parameters: none
        // Returns: none        
        void pop_back();

        // The getFirst function
        // Purpose: print the first item in the list
        // Parameters: none
        // Returns: none
        void getFirst();

        // the GetLast function
        // Purpose: return the last item in the list
        // Parameters: none
        // Returns: none
        void getLast();

        void printList();

        // the clear function
        // Purpose: clear the list, free memory
        // Parameters: none
        // Returns: none
        void clear();

        // Destructor
        // Purpose: clear up memory
        // Parameters: none
        // Returns: none
        ~LinkedList();

    private:

            LinkedList *mFront; //  point to the front of our list
            LinkedList *mBack; // point to the back of our list
            LinkedList *next;  // the next node
            LinkedList *previous; // the previous node
            int data;  // our list data manipulator 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:01:12.533

单链表不提供 O(1) 删除最后一个元素。您必须从头开始遍历整个列表才能找到倒数第二个元素。

```
Node* i = mFront;
while ( i->next != mBack ) i = i->next;
mBack = i; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:03:04.683

如果列表不是双链接的，则必须从第一个元素开始找到最后一个：

```
void LinkedList::pop_back()
{
   mBack->data = NULL;
   current = mFront;
   do{
      current = current->next
   } while ( current->next );
   mBack = current;
} 
```

**非常重要**- 由于`data`似乎是一个指针，您可能会遇到内存泄漏。只是设置`data = NULL`不会释放内存，您必须明确删除它：

```
delete mFront->data; 
```

# python - python kinterbasdb - varchar 和 blob 的不同编码

> ID：10217900
> 
> 赞同：0
> 
> 时间：2012-04-18T20:58:59.803
> 
> 标签：python, kinterbasdb

我有 USER VARCHAR(100) CHARACTER SET WIN1250 的表，注意 BLOB SUB_TYPE 1 CHARACTER SET WIN1250，

*但是当我在 python 2.7 (# - - coding: utf-8 -* -)中使用 kinterbasdb 从该表中获取数据时，VARCHAR 字段还可以，但 BLOB 字段似乎已“损坏”，我必须使用 decode('cp1250' ）。为什么会发生这种情况？为什么只需要解码 BLOB 字段而不需要 VARCHAR？

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T11:09:01.480

我需要打电话`KInterbasDB.init(type_conv=300)`： [http ://www.firebirdsql.org/file/documentation/drivers_documentation/python/3.3.0/beyond-python-db-api.html#parameter-conversion](http://www.firebirdsql.org/file/documentation/drivers_documentation/python/3.3.0/beyond-python-db-api.html#parameter-conversion)

# android - java.io.IOException: 使用 JSoup 加载 URL 时出现 403 错误

> ID：10217901
> 
> 赞同：1
> 
> 时间：2012-04-18T20:59:04.087
> 
> 标签：android, jsoup

我正在尝试使用 jsoup 登录到 Fiverr 并拉入 android 应用程序的订单。这是我的代码。我收到了来自 Fiverr 的 403 禁止。假设我错过了一些东西。有任何想法吗。

```
 Connection.Response res;
    try {
        res = Jsoup.connect("http://fiverr.com/login")
                .header("User-Agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2")
                .userAgent("Mozilla")  
                .data("user_session[username]", "myusername")
                .data("user_session[password]", "mypassword")
                .data("user_session[remember_me]", "1") 
                .method(Method.POST)
                .execute();

        Document doc = res.parse();
        String __utma = res.cookie("__utma");
        String __utmb = res.cookie("__utmb");
        String __utmc = res.cookie("__utmc");
        String __utmz = res.cookie("__utmz");
        String _fiverr_sessions = res.cookie("_fiverr_sessions");
        String _jsuid = res.cookie("_jsuid");
        String fiverr_auth_info = res.cookie("fiverr_auth_info");
        String km_ai = res.cookie("km_ai");
        String km_lv = res.cookie("km_lv");
        String km_ni = res.cookie("km_ni");
        String km_uq = res.cookie("km_uq");
        String km_vs = res.cookie("km_vs");
        String kvcd = res.cookie("kvcd");

        Document doc2 = Jsoup.connect("http://fiverr.com/users/myusername/manage_orders/type/priority")
                .header("User-Agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2")
                .userAgent("Mozilla")  
                .cookie("__utma", __utma)
                .cookie("__utmb", __utmb)
                .cookie("__utmc", __utmc)
                .cookie("__utmz", __utmz)
                .cookie("_fiverr_sessions", _fiverr_sessions)
                .cookie("_jsuid", _jsuid)
                .cookie("fiverr_auth_info", fiverr_auth_info)
                .cookie("km_ai", km_ai)
                .cookie("km_lv", km_lv)
                .cookie("km_ni", km_ni)
                .cookie("km_uq", km_uq)
                .cookie("km_vs", km_vs)
                .cookie("kvcd", kvcd)
                .get();

        TextView TextLocation = (TextView)findViewById(R.id.textView1);
        TextLocation.setVisibility(View.VISIBLE);
        TextLocation.setText((CharSequence) doc2.html());
        System.out.println(doc2.html());

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

这是错误：

```
 04-18 20:25:54.444: W/System.err(552): java.io.IOException: 403 error loading URL http://fiverr.com/login
  04-18 20:25:54.464: W/System.err(552):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:414)
  04-18 20:25:54.475: W/System.err(552):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:391)
  04-18 20:25:54.535: W/System.err(552):    at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:157)
  04-18 20:25:54.565: W/System.err(552):    at com.newrock.my5._MainActivity.onCreate(_MainActivity.java:35)
  04-18 20:25:54.575: W/System.err(552):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
  04-18 20:25:54.595: W/System.err(552):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
  04-18 20:25:54.595: W/System.err(552):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
  04-18 20:25:54.635: W/System.err(552):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
  04-18 20:25:54.684: W/System.err(552):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
  04-18 20:25:54.684: W/System.err(552):    at android.os.Handler.dispatchMessage(Handler.java:99)
  04-18 20:25:54.715: W/System.err(552):    at android.os.Looper.loop(Looper.java:130)
  04-18 20:25:54.755: W/System.err(552):    at android.app.ActivityThread.main(ActivityThread.java:3683)
  04-18 20:25:54.755: W/System.err(552):    at java.lang.reflect.Method.invokeNative(Native Method)
  04-18 20:25:54.764: W/System.err(552):    at java.lang.reflect.Method.invoke(Method.java:507)
  04-18 20:25:54.794: W/System.err(552):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
  04-18 20:25:54.824: W/System.err(552):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
  04-18 20:25:54.844: W/System.err(552):    at dalvik.system.NativeStart.main(Native Method)
  04-18 20:25:55.364: I/ActivityManager(68): Displayed com.newrock.my5/._MainActivity: +6s716ms
  04-18 20:26:05.184: D/dalvikvm(142): GC_EXPLICIT freed 53K, 47% free 3123K/5831K, external 2183K/2603K, paused 86ms
  04-18 20:26:10.315: D/dalvikvm(243): GC_EXPLICIT freed 6K, 51% free 2725K/5511K, external 716K/1038K, paused 148ms
  04-18 20:26:15.285: D/dalvikvm(282): GC_EXPLICIT freed 8K, 44% free 3366K/5959K, external 716K/1038K, paused 101ms
  04-18 20:26:20.345: D/dalvikvm(311): GC_EXPLICIT freed 10K, 52% free 2776K/5703K, external 716K/1038K, paused 126ms
  04-18 20:26:25.444: D/dalvikvm(345): GC_EXPLICIT freed 7K, 44% free 3533K/6279K, external 716K/1038K, paused 134ms
  04-18 20:26:30.434: D/dalvikvm(356): GC_EXPLICIT freed 3K, 51% free 2718K/5511K, external 716K/1038K, paused 81ms
  04-18 20:29:37.864: D/SntpClient(68): request time failed: java.net.SocketException: Address family not supported by protocol
  04-18 20:29:46.895: D/dalvikvm(122): GC_CONCURRENT freed 439K, 49% free 3096K/6023K, external 716K/1038K, paused 10ms+5ms
  04-18 20:34:37.887: D/SntpClient(68): request time failed: java.net.SocketException: Address family not supported by protocol
  04-18 20:37:42.078: I/dalvikvm(128): Jit: resizing JitTable from 512 to 1024
  04-18 20:39:37.905: D/SntpClient(68): request time failed: java.net.SocketException: Address family not supported by protocol
  04-18 20:44:37.921: D/SntpClient(68): request time failed: java.net.SocketException: Address family not supported by protocol 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:07:56.797

403 错误表明您没有访问指定 URL 所需的权限。

您确定您正在正确处理身份验证吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:32:49.447

这是一个身份验证问题。确保在尝试对帐户执行任何操作时实现特定于 Fiverr API 的所有身份验证。即使 oAuth 有问题，您也可能会收到此代码 403...

# python - Django 的 update_object 通用视图是否安全？为了安全起见，我应该扩展它还是自己做？

> ID：10217902
> 
> 赞同：0
> 
> 时间：2012-04-18T20:59:06.137
> 
> 标签：python, django, forms, django-generic-views

我是 Django 的新手。昨晚我努力开发了一个视图，该视图允许我编辑当前项目中的任何实体；章节、故事和世界。为了确保我准确地知道正在修改哪个数据库对象，我在表“编辑”中添加了一个数据库条目，该表存储了哈希、正在编辑的对象的类型（例如“章节”）以及该对象的 id在数据库中找到的对象。哈希作为隐藏输入添加到表单中。

在后端，提交表单后，我抓取哈希并使用它在数据库中查找相关的编辑项。然后我使用它来查找最初正在编辑的对象。这样做有两个原因：

1.  我可以知道真正正在编辑的对象是什么。如果所有表单项都已更改，则没有什么可以比较（除了 URL）来实际知道正在编辑的对象。

2.  用户应该无法破解前端来做一些奇怪的事情，比如修改错误的故事。

今天我发现 Django 有一个通用视图，叫做`update_object`. 这似乎为我处理了很多事情。但鉴于它不会自动使用数据库来确保正在编辑正确的对象，甚至不会确定正在编辑*的*对象，这是否安全？肯定有一种简单的方法可以在前端通过修改 HTML 元素来破解它。

其次，如果这值得关注，您会建议我保留自己的编辑视图，还是扩展 update_object 视图，或其他解决方案？

最后，我是否以正确的方式进行？如果我没有以正确的方式考虑解决这个问题，请纠正我。

我不觉得这是一个需要代码的问题。这更像是一个关于表单安全性的一般性问题，因为它们与 Django 相关。

谢谢，

典范RG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:29:20.717

您知道他们正在编辑哪个对象的问题通常可以通过检查 URL 或仅具有数据库 ID 的隐藏表单元素来解决。

在接受用户表单的任何更改之前，您应该验证用户是否有权执行他们要求执行的任何操作，并且编辑是否有意义。您通常会使用表单验证器和/或视图中的显式检查来执行此操作。这是处理此问题的一种更安全的方法，因为它保证人们不会进行他们不允许进行的数据库更改，而在您的`Edit`对象方法中，可以想象他们可以解决这个问题。

如果您采用这种方法，我看不出有任何理由说明用户可能正在编辑隐藏的 ID 字段以假装正在编辑不同的对象。当他们本可以转到不同的编辑链接时，他们只是使用一种愚蠢的迂回方式来编辑内容。

（另外：如果您使用的是 Django 1.3+，最好使用新的基于类[`UpdateView`](https://docs.djangoproject.com/en/1.3/ref/class-based-views/#django.views.generic.edit.UpdateView)而不是基于函数的`update_object`.)

# asp.net-mvc - 是否有正确的方法来检查 EditorTemplate 中模型的属性值

> ID：10217903
> 
> 赞同：2
> 
> 时间：2012-04-18T20:59:06.247
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, editorfor

我想设计我的自定义编辑器模板，以便它们即使在传递空模型时也能正常工作。即，`@Html.EditorForModel()`何时`Model`为空。

我遇到的问题是，当我在 EditorTemplate 中时，有时我需要访问模型的属性之一，而且它的写法很老`@if(Model != null && Model.[Property] ...)`

例如

```
@model MyObject
@if(Model.BoolProperty) // throws NullReferenceException
{
    <div>...additional stuff here</div>
}

@Html.EditorFor(m => m.OtherProperty) 
```

我考虑添加如下扩展方法

```
public static R GetValue<T, R>(this WebViewPage<T> viewPage, Func<T, R> selector)
{
    if (selector == null) throw new ArgumentNullException("selector");
    if (viewPage == null) throw new ArgumentNullException("viewPage");
    if (viewPage.Model == null) return default(R);
    return selector(viewPage.Model);
} 
```

并像这样在 EditorTemplate 中使用它

```
@model MyObject
@if(this.GetValue(m => m.BoolProperty)) // Safely gets value or false
{
    <div>...additional stuff here</div>
}

@Html.EditorFor(m => m.OtherProperty) 
```

但**我想知道如果模型存在，是否有内置或“正确”的方式来尝试访问这些属性，而不抛出`NullReferenceException`**.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T06:13:47.920

为什么不检查一次：

```
@model MyObject
@if (Model == null)
{
    <div>Sorry, nothing to edit here<div>
}
else
{
    ... here you can access the model properties
} 
```

甚至在调用模板时在外面：

```
@if (Model != null)
{
    @Html.EditorForModel()
} 
```

这样在模板中您不再需要检查模型是否为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:17:03.507

诀窍是使编辑器模板中的传入模型为可空类型，int? 对于整数，日期时间？对于日期，布尔？对于布尔值等...

所以在 Integer.cshtml 的顶部你会有 int？而不是 int

```
@model int?
... your code here ... 
```

假设您为货币创建了一个名为 Currency.cshtml 的编辑器模板，您将在顶部具有以下类型

```
@model decimal?
... your code here... 
```

仅供参考，.NET 中的可为空类型有两种方便的方法：GetValueOrDefault 和 HasValue。

# c++ - 内存中的 GDI+ DC 始终为单色

> ID：10217908
> 
> 赞同：0
> 
> 时间：2012-04-18T20:59:13.377
> 
> 标签：c++, windows, gdi+

在 mingw 工作，在内存中创建一个彩色 DC 非常糟糕。例如，在下面的代码片段中，“foo_scratch.bmp”是图像的单色版本（来自 EMR_STRETCHDIBITS 记录）。如果改为省略 aDC 而 srcDC 直接使用 CreateDC，则该文件具有彩色图像。

```
 Gdiplus::Bitmap *pbmp = NULL;

        BITMAPINFO *pbitmapinfo = (BITMAPINFO *)((char *)lpEMFR + pEmr->offBmiSrc);
        void *pBitsInMem = (char *)lpEMFR + pEmr->offBitsSrc;
        HBITMAP hbmsrc;
        HDC aDC = CreateDC("DISPLAY", "", NULL, NULL);
        HDC srcDC = CreateCompatibleDC(aDC);
        hbmsrc = CreateDIBitmap(
            srcDC,
            &(pbitmapinfo->bmiHeader),
            CBM_INIT,
            pBitsInMem,
            pbitmapinfo,
            DIB_RGB_COLORS);
        if(hbmsrc){

          CLSID pngClsid;
          GetEncoderClsid(L"image/bmp", &pngClsid);
            pbmp = Gdiplus::Bitmap::FromHBITMAP(hbmsrc,NULL);
            pbmp->Save(L"C:\\Temp\\foo_scratch.bmp",&pngClsid, NULL); 
```

当需要通过 bitblt 操作将两个图像（hbmdst、hbmsrc）放在一起时，这一切都会在稍后出现。目前我所管理的最好的是单色。在最坏的情况下，图像是纯黑色的。在这个片段中，ROP 已被硬编码为 SRCCOPY，我仍然没有成功地将图像从一个 HBITMAP 复制到另一个。非常令人沮丧！

```
 HDC dstDC = CreateCompatibleDC(aDC);
          HBITMAP hbmdOld = (HBITMAP) SelectObject(dstDC, hbmdst);
          HBITMAP hbmsOld = (HBITMAP) SelectObject(srcDC, hbmsrc);
          GetObject(hbmsrc, sizeof(bm), &bm);
          BitBlt(dstDC, 0, 0, bm.bmWidth, bm.bmHeight, srcDC, 0, 0, SRCCOPY);
          SelectObject(srcDC, hbmsOld);
          SelectObject(dstDC, hbmdOld);
          (void) DeleteDC(dstDC);
          pbmp = Gdiplus::Bitmap::FromHBITMAP(hbmdst,NULL);
          pbmp->Save(L"C:\\Temp\\scratch.bmp",&pngClsid, NULL); 
```

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T15:31:23.910

想通了 - 无论在何处创建位图，都必须使用与显示器（或其他设备）直接关联的 DC，而不是从第一个 DC 派生的“兼容”DC。

# css - DIV 内的 SPAN 可防止文本溢出：省略号

> ID：10217915
> 
> 赞同：15
> 
> 时间：2012-04-18T20:59:50.727
> 
> 标签：css

这个问题绝不是可怕的，但这是我遇到的一个问题，并且想知道一些 SO 专家将如何解决它 - 如果有解决方案。

我有一个显示文件信息的固定宽度 UI 小部件。我提供了通过单击文件名来编辑文件名的能力，并表明我`:hover`应用了一种样式来更改字体颜色的功能。最初我将文件名放在 a`DIV`中，但由于不同的文件名的长度不同，我无法`DIV`调整文件名的大小并将`:hover`效果与文本保持一致。对于短文件名，`:hover`当光标位于`DIV`. 这不是我想要的，因此作为解决方案，我将文件名放在 a 中`SPAN`（连同`:hover`效果）。这解决了短文件名的问题，但防止了长文件名用椭圆优雅地溢出。

理想情况下，我想要一个实现两种效果的解决方案 - 椭圆长文件名​​并`:hover`仅在将鼠标悬停在实际文本上时应用效果。我对 css 还是很陌生，所以也许我只是缺少一个明显的答案。谢谢！

这是一个显示问题的示例页面：（
在[jsfiddle](http://jsfiddle.net/webshooter/Jhcup/)上）

编辑：我想我可以执行一些 javascript 魔术来剪辑较长的名称，但希望有一个更简单的 css 解决方案。

```
<html>
<head>
<style>
    div {
        margin:10px;
        width:200px;
        max-width:200px;
        font-size:1.2em;
        overflow:hidden;
        text-overflow:ellipsis;
    }
    div.a:hover, span:hover {
        color:666;
        cursor:pointer;
    }
    span {
        display:inline-block;   
    }
</style>
</head>
<body>

    <!-- This works well for long filenames -->
    <div class="a">
        ThisIsMyReallyReallyLongFilename.txt
    </div>

    <!-- ... but fails for the short names -->
    <div class="a">
        Shortname.txt
    </div>

    <!-- This fails to show ellipse for long filenames -->
    <div>
        <span>ThisIsMyReallyReallyLongFilename.txt</span>
    </div>

    <!-- ... but wraps the text nicely for short names -->
    <div>
        <span>Shortname.txt</span>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-18T21:13:42.417

像这样？（注意`display:inline-block;`从跨度中删除。）

```
<html>
<head>
<style>
div {
    margin:10px;
    width:200px;
    max-width:200px;
    overflow: hidden;
    text-overflow:ellipsis;
    font-size: 1.2em;
}
span:hover {
    color:666;
    cursor:pointer;
}
</style>
</head>
<body>

<!-- This now does show ellipse for long filenames -->
<div>
    <span>ThisIsMyReallyReallyLongFilename.txt</span>
</div>

<!-- ... but wraps the text nicely for short names -->
<div>
    <span>Shortname.txt</span>
</div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T21:08:12.227

问题实际上来自`SPAN`with `display:inline-block`。您将需要删除它或将其更新为[类似于此 jsFiddle 的内容](http://jsfiddle.net/6URCz/1/)。根据您的示例，我不清楚应该将其更改为什么。

我相信这种情况正在发生，因为`SPAN`它永远不会溢出它的 parent `DIV`。 [至少这就是 W3 规范声明它被触发的方式。](http://dev.w3.org/csswg/css3-ui/#text-overflow)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T21:12:10.493

将`overflow`和`text-overflow`属性从规则移动到同时针对和`div`的新规则。添加最大宽度。`div``span`

```
<html>
<head>
<style>
    div, span {
        overflow:hidden;
        text-overflow:ellipsis;
        max-width:200px;
    }
    div {
        margin:10px;
        width:200px;
        font-size:1.2em;
    }
    div.a:hover, span:hover {
        color:#666;
        cursor:pointer;
    }
    span {
        display:inline-block;   
    }
</style>
</head>
<body>

    <!-- This works well for long filenames -->
    <div class="a">
        ThisIsMyReallyReallyLongFilename.txt
    </div>

    <!-- ... but fails for the short names -->
    <div class="a">
        Shortname.txt
    </div>

    <!-- This fails to show ellipse for long filenames -->
    <div>
        <span>ThisIsMyReallyReallyLongFilename.txt</span>
    </div>

    <!-- ... but wraps the text nicely for short names -->
    <div>
        <span>Shortname.txt</span>
    </div>

</body>
</html>​ 
```

# c# - 如何通过 ADO.NET/C# 将数组/表参数用于 Oracle (ODP.NET 10g)？

> ID：10217922
> 
> 赞同：9
> 
> 时间：2012-04-18T21:00:16.587
> 
> 标签：c#, oracle, ado.net, parameters, oracle10g

[这个问题](https://stackoverflow.com/questions/5868234/in-sql-server-2008-i-am-able-to-pass-table-valued-parameter-to-my-stored-procedu)的[答案](https://stackoverflow.com/a/5868320/18255%5D)很好，但我正在寻找 ADO.NET 代码，以便能够将数组或表发送到 Oracle 过程，然后在过程中使用该表。

在 SQL Server 表值参数中，它非常简单：

```
CREATE TYPE [dbo].[IntTable] AS TABLE(
    [intvalue] [int] NOT NULL,
    PRIMARY KEY CLUSTERED 
    (
        [intvalue] ASC
    )WITH (IGNORE_DUP_KEY = OFF)
)
GO

CREATE PROCEDURE dbo.UseTable
    @SomeInt INT
    ,@IntTable dbo.IntTable READONLY
AS 
BEGIN
    -- Do whatever using @SomeInt and @IntTable like:
    INSERT INTO Assignments (masterid, childid)
    SELECT @SomeInt, intvalue
    FROM @IntTable
END
GO 
```

然后在客户端：

```
var param = new List<int>();
param.Add(1);
param.Add(2);

Cm.Parameters
    .AddWithValue("@IntTable", param /* IEnumerable<Int> */)
    .SqlDbType = SqlDbType.Structured 
```

这是我目前拥有的：

```
CREATE OR REPLACE TYPE TRAIT_ID_TABLE AS TABLE OF NUMBER;

PROCEDURE SET_TRAITS(P_CUST_TANK_PROD_ID IN CUST_TANK_PROD.CUST_TANK_PROD_ID%TYPE, P_TRAIT_IDS IN TRAIT_ID_TABLE)
AS
BEGIN
  DELETE FROM TANK_TRAIT
        WHERE CUST_TANK_PROD_ID = P_CUST_TANK_PROD_ID;

  INSERT INTO TANK_TRAIT(CUST_TANK_PROD_ID, TRAIT_ID)
     SELECT P_CUST_TANK_PROD_ID, COLUMN_VALUE FROM TABLE(P_TRAIT_IDS);

  COMMIT;
EXCEPTION
  WHEN OTHERS
  THEN
     ROLLBACK;
END;

var param = new OracleParameter();
param.ParameterName = "P_TRAIT_IDS";
param.OracleDbType = OracleDbType.Decimal;
param.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
param.Direction = ParameterDirection.Input;
param.Value = traitIdList.ToArray<int>();
param.Size = traitIdList.Count;
cmd.Parameters.Add(param); 
```

我在 ExecuteNonQuery 上得到了这个：

```
System.AccessViolationException was caught
  Message=Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
  Source=Oracle.DataAccess
  StackTrace:
       at Oracle.DataAccess.Client.OpsSql.ExecuteNonQuery(IntPtr opsConCtx, IntPtr& opsErrCtx, IntPtr& opsSqlCtx, IntPtr& opsDacCtx, IntPtr opsSubscrCtx, Int32& isSubscrRegistered, OpoSqlValCtx*& pOpoSqlValCtx, OpoSqlRefCtx& pOpoSqlRefCtx, IntPtr[] pOpoPrmValCtx, OpoPrmRefCtx[] pOpoPrmRefCtx, OpoMetValCtx*& pOpoMetValCtx, Int32 prmCnt)
       at Oracle.DataAccess.Client.OracleCommand.ExecuteNonQuery()
       at EDC2.Domain.TraitList.SaveTraits(String connectionString) in C:\code\EDC2\trunk\app\EDC2.Domain\Trait.cs:line 195
  InnerException: 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-29T15:30:13.757

这适用于 ODP.NET (odac)：

您的 Oracle 软件包将设置如下：

```
CREATE OR REPLACE package SOME_PACKAGE as
  ...
  type t_number_tab is table of number index by pls_integer;
  ...
  procedure ins_test(i_id_tab in t_number_tab, o_inserted out number);

end SOME_PACKAGE;

CREATE OR REPLACE package body SOME_PACKAGE as

    procedure ins_test(i_id_tab in t_number_tab, o_inserted out number) is
    begin
        -- inserts all records to test table based on incoming table of ids
        forall i in i_id_tab.first .. i_id_tab.last
            insert into TEST_TAB
            (id, val1, val2)
            select id,val1,val2
            from main_tab
            where id = i_id_tab(i);

        o_inserted := SQL%ROWCOUNT;

        commit;
    exception
        when others then
            rollback;
            raise;
    end ins_test;
...
end SOME_PACKAGE; 
```

然后您的 C# 代码将如下所示：

```
string connStr = "User Id=xxx;Password=xxxx;Data Source=xxxxx;";
OracleConnection _conn = new OracleConnection(connStr);
_conn.Open();

OracleCommand cmd = _conn.CreateCommand();
cmd.CommandText = "some_package.ins_test";
cmd.CommandType = CommandType.StoredProcedure;

OracleParameter p1 = new OracleParameter();
OracleParameter p2 = new OracleParameter();

p1.OracleDbType = OracleDbType.Decimal;
p1.Direction = ParameterDirection.Input;
p2.OracleDbType = OracleDbType.Decimal;
p2.Direction = ParameterDirection.Output;

p1.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
p1.Value = new int[3] { 1, 2, 3 };
p1.Size = 3;

cmd.Parameters.Add(p1);
cmd.Parameters.Add(p2);

cmd.ExecuteNonQuery(); 
```

# c# - WPF 绑定到 ListBox.Items

> ID：10217924
> 
> 赞同：0
> 
> 时间：2012-04-18T21:00:19.437
> 
> 标签：c#, wpf, data-binding

我有一个带有 ListBox 和标签的简单窗口。我想以这样的方式将 Label.Text 绑定到 ListBox，使其成为标签中显示的所选项目之后的列表框的下一个项目。我尝试将多重绑定与这样的转换器一起使用：

```
 <Label>
      <MultiBinding Converter="{StaticResource myConverter}">
            <Binding ElementName="lbox" Path="Items"/>
            <Binding ElementName="lbox" Path="SelectedIndex"/>
      </MultiBinding>-->
 </Label>    

public class MyConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        object[] items = values[0] as object[];
        int index = (int)(values[1]) + 1;
        return (items[index]).ToString();

    }
  .....
} 
```

但它不起作用。问题是我无法获取 ListBoxItems 数组。请问你能帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:04:20.677

好的，这里有几件事是错误的。

1.  在尝试从数组中获取某些内容之前，您没有检查索引值。如果没有选择会发生什么，或者如果他们选择了最后一行会发生什么？

2.  调用列表框项的 ToString() 方法将为您提供“System.Windows.Controls.ListBoxItem: Item's Text”

3.  最后，也许最直接回答您的问题的是，Items 属性不是一个对象 []，而是一个 ItemsCollection。您的代码应如下所示：

    ```
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        System.Windows.Controls.ItemCollection items = values[0] 
                            as System.Windows.Controls.ItemCollection;

        int index = (int)(values[1]) + 1;

        ...
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:06:33.550

你的代码片段正确吗？在我看来，您想要 SelectedIndex 而不是 SelectedValue （如果我正确理解了您的问题）。那是，

```
 <Label>
      <MultiBinding Converter="{StaticResource myConverter}">
            <Binding ElementName="lbox" Path="Items"/>
            <Binding ElementName="lbox" Path="SelectedIndex"/>
      </MultiBinding>
 </Label> 
```

请注意，至少您应该在转换器中进行一些错误检查，以检查您的计算索引是否仍在范围内。

# haskell - Djinn 是如何工作的？

> ID：10217931
> 
> 赞同：40
> 
> 时间：2012-04-18T21:01:10.237
> 
> 标签：haskell, types, logic

好的，所以我意识到我可能会为此后悔一辈子，但是…… Djinn 实际上是如何工作的？

该文档说它使用了一种“LJ 的扩展”的算法，并指出了一篇关于 LJT 的冗长令人困惑的论文。据我所知，这是一个由高度形式化的规则组成的大型复杂系统，用于确定哪些逻辑陈述是真或假。但这甚至没有*开始*解释如何将类型签名转换为可执行表达式。大概所有复杂的形式推理都以某种方式*参与其中*，但情况严重不完整。

* * *

这有点像我尝试用 BASIC 编写 Pascal 解释器的时候。（别笑！我才十二岁……）我花了好几个小时试图弄清楚，最后我不得不放弃。我只是无法弄清楚你是如何从包含整个程序的巨大字符串中获得的，你可以将其与已知的程序片段进行比较，以便决定实际做什么。

答案当然是你需要写一个叫做“解析器”的东西。一旦你理解了这是什么以及它做了什么，突然间一切都变得*显而易见*了。哦，编写代码仍然不是一件容易的事，但*想法*很简单。你只需要编写实际的代码。如果我在十二岁的时候就知道解析器，那么也许我不会花两个小时盯着一个空白屏幕。

我怀疑 Djinn 所做的从根本上说很简单，但我错过了一些重要的细节，这些细节解释了所有这些复杂的逻辑体操与 Haskell 源代码之间的关系......

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-18T22:00:03.763

Djinn 是一个定理证明者。您的问题似乎是：定理证明与编程有什么关系？

强类型编程与逻辑有着非常密切的关系。特别是，ML 传统中的传统函数式语言与[Intuitionist](http://en.wikipedia.org/wiki/Intuitionistic_logic) [Propositional Logic](http://en.wikipedia.org/wiki/Propositional_calculus)密切相关。

口号是“程序就是证明，程序证明的命题就是它的类型”。
一般来说你可以想到

```
 foo :: Foo 
```

话说那`foo`是一个公式的证明`Foo`。例如类型

```
 a -> b 
```

对应于函数 from `a`to `b`，所以如果你有一个证明`a`和一个证明`a -> b`你就有一个证明`b`。因此，函数完全对应于逻辑中的含义。相似地

```
(a,b) 
```

对应于合取（逻辑与）。所以逻辑重言式`a -> b -> a & b`对应于 Haskell 类型 `a -> b -> (a,b)` 并有证明：

```
\a b -> (a,b) 
```

这是“和引入规则”，`fst :: (a,b) -> a`而`snd :: (a,b) -> b`与2“和消除规则”相对应

同样，`a OR b`对应于 Haskell 类型`Either a b`。

[在Haskell Curry](http://en.wikipedia.org/wiki/Haskell_Curry)和[William Alvin Howard](http://en.wikipedia.org/wiki/William_Alvin_Howard)之后，这种对应有时被称为“Curry-Howard 同构”或“ [Curry-Howard 对应](http://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence)”

这个故事因 Haskell 中的非全面性而变得复杂。

Djinn“只是”一个定理证明者。

如果您有兴趣尝试编写克隆，“Simple Theorem Prover”的谷歌搜索结果的第一页有[这篇](http://arxiv.org/pdf/cs.LO/9301110.pdf)论文，它描述了为 LK 编写一个似乎是用 SML 编写的定理证明器。

编辑：至于“如何证明定理是可能的？” 答案是从某种意义上说并不难。这只是一个搜索问题：

考虑将问题重述为：我们有一组我们知道如何证明 S 的命题，以及一个我们想证明 P 的命题。我们该怎么办？首先，我们问：我们是否已经在 S 中证明了 P？如果是，我们可以使用它，如果不是，我们可以在 P 上进行*模式匹配*

```
case P of
   (a -> b) -> add a to S, and prove b (-> introduction)
   (a ^ b)  -> prove a, then prove b (and introduction)
   (a v b)  -> try to prove a, if that doesn't work prove b (or introduction) 
```

如果这些都不起作用

```
for each conjunction `a ^ b` in S, add a and b to S (and elimination)
for each disjunction `a v b` in S, try proving `(a -> P) ^ (b -> P)` (or elimination)
for each implication `a -> P` is S, try proving `a` (-> elimination) 
```

真正的定理证明者有一些聪明，但想法是一样的。“决策程序”的研究领域研究了为某些保证有效的公式寻找证据的策略。另一方面，“战术”着眼于如何以最佳方式对证明搜索进行排序。

至于：“如何将证明翻译成 Haskell？”

形式系统中的每条推理规则都对应着一些简单的 Haskell 构造，所以如果你有一棵推理规则树，你就可以构造一个对应的程序——Haskell 毕竟是一种证明语言。

含义介绍：

```
\s -> ? 
```

或介绍

```
Left
Right 
```

和介绍

```
\a b -> (a,b) 
```

和消除

```
fst
snd 
```

ETC

augustss 在他的回答中说，他们在 Djinn 中实现这一点的方式对于 SO 的回答来说有点乏味。不过我敢打赌，您可以自己弄清楚如何实现它。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-19T08:57:26.847

在最一般的术语中，根据 Curry-Howard 同构，类型和命题以及值和证明之间存在对应关系。Djinn 使用这种对应关系。

更具体一点，假设你想找到一个 Haskell 术语 type `(a, b) -> (b, a)`。首先，您将类型转换为逻辑语句（Djinn 使用命题逻辑，即没有量词）。逻辑语句去`(A and B) is true implies (B and A) is true`。下一步就是证明这一点。对于命题逻辑，总是可以机械地证明或反驳一个陈述。如果我们可以反驳它，那么这意味着（终止）Haskell 中没有对应的术语。如果我们可以证明它，那么就有一个该类型的 Haskell 项，而且，Haskell 项具有与证明完全相同的结构。

最后一个语句必须是合格的。您可以选择使用不同的公理和推理规则集来证明该陈述。如果您选择建设性逻辑，则证明和 Haskell 项之间只有对应关系。“正常”，即经典逻辑具有诸如`A or (not A)`公理之类的东西。那将对应于 Haskell 类型`Either a (a -> Void)`，但是没有这种类型的 Haskell 术语，所以我们不能使用经典逻辑。任何命题陈述都可以在建设性命题逻辑中被证明​​或否定，这仍然是正确的，但这样做比在经典逻辑中涉及的要多得多。

回顾一下，Djinn 将类型转换为逻辑中的命题，然后使用构造逻辑的决策程序来证明命题（如果可能），最后将证明转换回 Haskell 术语。

（在这里说明它是如何工作的太痛苦了，但是给我 10 分钟的时间在白板上，你会一清二楚的。）

作为您思考的最后评论：`Either a (a -> Void)`如果您有 Scheme 的`call/cc`. 选择一个更具体的类型，`Either a (a -> Int)`然后弄清楚如何。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T11:15:07.587

也许我看错了。也许所有这些形式逻辑的东西只是分散注意力。与其盯着 LJT 或其他什么的扣除规则，也许我*应该*做的是看看 Haskell。

Haskell 中有，什么，6 种可能的表达方式？每一个都对它使用的变量施加不同的类型约束，对吧？所以，也许我只是为函数类型中的每个参数生成一个新变量，然后开始查看我可以构造什么表达式。

甚至不必在蛮力搜索中生成所有可能的表达式。如果您的参数都没有函数类型，那么尝试函数应用程序是没有意义的。如果您的所有参数都是多态类型变量，`case`那么表达式对您没有帮助。等等。可用的类型告诉您哪种表达式可能有效。

如果您允许您的代码调用现有的顶级函数，事情会变得更有趣。除了有趣的多态类型的作用域问题之外，还有一个问题是要弄清楚哪些函数会或不会帮助你。

显然，我将不得不离开并考虑一段时间......

# php - 设计模式：如何从网关内编辑多个实体

> ID：10217934
> 
> 赞同：0
> 
> 时间：2012-04-18T21:01:14.903
> 
> 标签：php, design-patterns, entity, gateway

我们现在处于一个需要同时操作多个用户实体的项目中。例如，我们将一次禁用 50 个用户。通常我们在网关中这样做

网关

*   网关一次查询数据

或者

*   循环访问多个用户
    *   加载实体
    *   操作数据
    *   证实
    *   节省（）

但这不是最佳实践解决方案。

第一个选项否决了验证数据的可能性。第二个性能不好，因为我们需要为所有用户迭代实体

你有什么建议？我们想要一个快速的解决方案，但也是一个节省的解决方案

希望有人知道正确的解决方案。谢谢！

当我们使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:08:51.543

您需要一个对象现实映射器 (ORM)，它具有同时加载与循环匹配的多个用户的功能，从而减少负载。

最后的保存操作类似。所有更改的实体都应与工作单元一起存储。

检查您正在使用的 ORM 的产品文档或联系其供应商以了解它提供哪些功能来支持您的开发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:23:37.470

我会建议第一个选项。在单个查询中一次更新它们。但是你没有说明你想做什么样的数据验证。也许您可以在提交之前启动一个数据库事务并发出第二个查询来验证您的“用户禁用查询”的结果？

# regex - 将在 sed 中替换文本的末尾停止的正则表达式

> ID：10217936
> 
> 赞同：2
> 
> 时间：2012-04-18T21:01:20.123
> 
> 标签：regex, unix

我试图让我在 sed 中的替换短语结束，这样

```
echo aardvark.CPP | sed s/'\.'/'\.cpp'/g 
```

将阅读：

土豚变种cpp

并不是：

土豚cppCPP

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:10:23.137

如果你只想替换`.CPP`你可以这样做：

```
echo aardvark.CPP | sed s/'\.CPP'/'\.cpp'/g 
```

如果你想在 with 之后替换任何东西`.`，`.cpp`你可以这样做：

```
echo aardvark.CPP | sed s/'\.*'/'\.cpp'/g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:17:34.833

你也可以像这样使用一个简单的 tr 命令：

```
echo aardvark.CPP | tr 'CPP' 'cpp' 
```

**编辑：**

如果你真的想使用 sed 然后使用：

```
echo aardvark.CPP | sed 's/\.[A-Za-z][A-Za-z]*$/.cpp/g' 
```

# python - 如何获取 GAE 页面的访问者数量？

> ID：10217948
> 
> 赞同：2
> 
> 时间：2012-04-18T21:02:01.900
> 
> 标签：python, google-app-engine, analytics, visitors

我需要获取当前正在查看文章的唯一身份访问者的数量（例如，过去 5 分钟），以便我可以显示该数字，并按最受欢迎的文章对文章进行排序。

前任。类似于大多数论坛显示“有 n 人查看此主题”的方式

如何在 Google App Engine 上实现这一目标？我正在使用 Python 2.7。

请尝试以简单的方式解释，因为我最近开始学习编程并且我正在做我的第一个项目。我没有很多经验。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:40:08.370

除非您使用 Javascript 在发生这种情况时通知服务器，否则无法判断某人何时停止查看页面。论坛等通常假设有人在 n 分钟不活动后停止查看页面，并以此为基础。

为了尽量减少资源使用，我建议在这里专门使用 memcache。如果值被驱逐，计数将不正确，但其后果是最小的，其他解决方案将使用更多资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:18:37.940

创建一个计数器（实体内的属性）并为每个页面视图以事务方式增加它。如果您的网页浏览量超过几秒钟，则需要查看分[片计数器](https://developers.google.com/appengine/articles/sharding_counters)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T07:45:12.923

您是否考虑过使用[Google Analytics](http://www.google.com/analytics/)服务来获取统计信息？阅读[这篇](http://analytics.blogspot.com/2011/09/whats-happening-on-your-site-right-now.html)关于使用此服务进行实时监控的文章。请注意：必须在您要监控的每个页面上嵌入特殊脚本。

# javascript - javascript SlickGrid 列宽

> ID：10217949
> 
> 赞同：1
> 
> 时间：2012-04-18T21:02:07.760
> 
> 标签：javascript, jquery, jquery-plugins, slickgrid

我正在尝试使用 SlickGrid 使用 example1_simple （在此处找到[http://mleibman.github.com/SlickGrid/examples/example1-simple.html](http://mleibman.github.com/SlickGrid/examples/example1-simple.html)）作为模板来实现一个简单的可编辑表，但它出现了严重错误。

我的网格必须适合表单上的一个选项卡，该选项卡宽 280 像素，并且有 3 列（id、X、Y）。id 将自动递增，x & y 将为空白，但为了进行测试，我在每个单元格中放置了一个逐渐加长的字符串，因此第一行应为 0、a、b，第二行将包含 1、aa、bb等。但是每个单元格都绘制在前一个单元格的下方，因此第 1 行包含“0”，第 2 行包含“1”和“a”，第 3 行包含“2”、“aa”和'b' 等等。我暂时把它放在我的网站[http://www.nutanageophysics.com/IFP/test.html](http://www.nutanageophysics.com/IFP/test.html)上，以便大家可以看到。（快速的问题 - 保存这样的实时示例的最佳方法是什么？）

这是我的测试html文件

```
<!DOCTYPE html>
<html>
  <head>
    <title>Nutana Project Planner</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/jquery-ui-1.8.16.custom.css" type="text/css"/>
    <script src="js/jquery-1.7.min.js"></script>
    <script src="js/jquery.event.drag-2.0.min.js"></script>
    <script src="js/slick.core.js"></script>
    <script src="js/slick.grid.js"></script>
    <script src="js/xyGrid.js"></script>

    <script type="text/javascript">

      var xyGrid;

      function initialize() {
        xyGrid = new Slick.Grid("#xyGrid", data, columns, options);
      }
    </script>
  </head>
  <body onload="initialize();">
    <div id=xyGrid >
        <!-- the grid is going to be placed here by onLoadXML -->
    </div>
</body>
</html> 
```

我的 SlickGrid 代码在 xyGrid.js 中，包括在这里：

```
 var data = [];
  var columns = [
    {id: "id", name: "id", field: "id"},
    {id: "x1", name: "X", field: "x1"},
    {id: "y1", name: "Y", field: "y1"},
  ];

   var options = {
      enableCellNavigation: true,
      enableColumnReorder: false,
  };

  $(function () {
      var a='a';
      var b='b';
    for (var i = 0; i < 10; i++) {
      data[i] = {
        id:  i,
        x1: a,
        y1: b,
      };
      a +="a";
      b += "b";
    }

  }) 
```

唯一可能相关的事情是我在 css 中将 xyGrid 的样式定义为

```
 #xyGrid {
   width: 280px;
   height: 500px;
  } 
```

我尝试将宽度更改为无效。所有其他相关的 css 都在我没有触及的 jquery.ui.css 中。我也尝试了很多不同的 Grid 选项，但均未成功，但此处使用的两个是示例中使用的选项。如示例中所示，我还在我的 div 周围建立了一个表格，但他们将该表格用于其他目的，并且不相关。

请帮忙。

谢谢，

马克·佩尔蒂埃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:25:33.503

我相信你错过了样式表：http: [//mleibman.github.com/SlickGrid/slick.grid.css](http://mleibman.github.com/SlickGrid/slick.grid.css)

我在本地重新创建了它，它看起来还不错。仔细检查您是否拥有原始示例中包含的所有工作表和脚本。

（您可以使用[jsfiddle.net](http://jsfiddle.net)获取一些示例代码。不确定它是否可以容纳所有这些！）

# python - Django 使用表中的 2 个数据字段来填充下拉列表

> ID：10217950
> 
> 赞同：0
> 
> 时间：2012-04-18T21:02:10.310
> 
> 标签：python, django

我对 django 和 python 很陌生。有一个关于如何使用模型来拥有现有下拉列表的问题，不仅可以显示 ForeignKey 字段，还可以显示主键的一部分，以便可以通过主键的一部分识别外键具有的重复条目。

不知道这是否有任何意义，但由于我很新，请给我一个例子，我会尝试遵循它。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:46:44.350

为什么不直接在模板的 HTML 中呈现这两个字段？类似的东西应该可以工作：

```
<select>
{% for item in your_items %}
    <option>{{ item.pk }} - {{ item.some_field }}</option>
{% endfor %}
</select> 
```

当然，您不能再使用诸如 .as_table() 之类的 Form 方法，在这种情况下，您应该求助于手动编写 html 表单标签。有关此的更多信息：[https ://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#customizing-the-form-template](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#customizing-the-form-template)

# c# - Vb.net 的匿名方法替代方案是否有任何设计模式？

> ID：10217951
> 
> 赞同：0
> 
> 时间：2012-04-18T21:02:13.143
> 
> 标签：c#, .net, vb.net, sharepoint, design-patterns

使用 C# 匿名委托，我们可以避免声明额外的方法，我知道在 VB.NET 中它们不可用，但是有没有我可以使用的设计模式，这样我就可以避免每次都编写额外的方法？我需要它用于 SPSecurity.RunWithElevatedPrivileges，它将在我们的代码中使用很多次。

例如

```
SPSecurity.RunWithElevatedPrivileges(
                    delegate()
                    {
                        //some code here. 
                    }
                ); 
```

我希望在 VB.NET 中执行以下操作：

```
using RunWithElevatedPrivil() 
'some code here. 
end using 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:05:36.587

检查此链接，它可能会有所帮助：

[http://social.msdn.microsoft.com/Forums/en/sharepointdevelopment/thread/4854962a-0d4e-40e4-909a-581bb7a5ab03](http://social.msdn.microsoft.com/Forums/en/sharepointdevelopment/thread/4854962a-0d4e-40e4-909a-581bb7a5ab03)

> 在 vb.net 中，您可以定义一个无参数子程序，该子程序执行您希望以更高权限执行的代码，并将其声明为 CodeToRunElevated：
> 
> 您必须定义模块级变量才能使用。
> 
> 将安全代码调暗为新 SPSecurity.CodeToRunElevated(AddressOf Me.SPCode) SPSecurity.RunWithElevatedPrivileges(secureCode)

# excel - Excel DSUM - 使用 AND/OR 作为标准的一部分

> ID：10217954
> 
> 赞同：1
> 
> 时间：2012-04-18T21:02:25.340
> 
> 标签：excel, criteria

我检查了所有 Dsum 问题，但他们没有回答我的问题。

我的电子表格中有一个 DSUM 公式，如下所示 - =DSUM(Sheet1!$A:$L, Sheet3!$I1, Sheet3!$A1:$J2)。表 3 中的 A1 到 J2 是一组具有相应值的字段，该函数将根据这些值进行测试。

```
Name    Status  Ops Grade   Score   Amount  Date    Sum Description
         FAC                        BUDGET  1/1/2012 
```

现在我的问题是我需要从总和中排除某些名称。我通过在 B1 中包含另一列来解决问题，其中排除了所有带有“AL”的名称。这是不可扩展的，因为我被迫为需要排除的每个组合创建一个列。

```
Name    Name    Status  Ops Grade   Score   Amount  Date    Sum Description
       <>*AL*   FAC                         BUDGET  1/1/2012 
```

是否可以在名称值中包含 OR/AND？例如 =<>*80* 或 <>AB* 或 <>()* 等？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:13:45.817

您不必将条件包含在与数据相同的表中。您可以使用另一个表作为标准。

*   对于同一字段的每个标准，在标准表中添加一个新行（如上）。

*   如果您需要`OR`在不同行上放置标准。如果您需要`AND`并将条件放在同一行上。对于同一字段的多个条件，您需要添加多个列。

```
Name
<>*80*
<>AB*
<>()* 
```

更多信息[在这里](https://support.microsoft.com/en-us/office/dsum-function-53181285-0c4b-4f5a-aaa3-529a322be41b)。

# r - 返回仅在两个数据帧之一中的内容

> ID：10217955
> 
> 赞同：0
> 
> 时间：2012-04-18T21:02:42.167
> 
> 标签：r, dataframe

我有以下数据框，并希望返回“egress”中不是“both”的所有行。 `setdiff`似乎没有奏效。在这个例子中，我需要一个返回 7 行的新数据框。我怎样才能做到这一点？

我的部分问题可能是我计算了“两者”，这有时会截断尾随的 0。“出口”是另一个数据框。“both”包含“ingress”和“egress”数据帧中的行。

```
两者 = 合并（入口，出口，by=c（“lat”，“lng”）
```

**出口**

```
       纬度
1 13.8333 44.6833
2 31.1429 -81.4710
3 37.4020 -122.0780（匹配）
4 33.9553 -83.3937
5 33.9553 -83.3937
6 38.9628 -95.2554
7 18.9667 72.8333
8 38.8147 -77.0647
9 32.5670 -84.9870（匹配）
10 30.5670 -85.9870（匹配）

```

**入口**

```
      纬度
1 38.8787 -77.1019
2 52.2500 21.0000
3 37.4020 -122.0780
4 40.7811 -74.0648
5 32.5670 -84.9870
6 30.5670 -85.9870

```

**两个都**

```
     纬度
1 30.567 -85.987（尾随 0 被截断）
2 32.567 -84.987（尾随 0 被截断）
3 37.402 -122.078（尾随 0 被截断）

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:16:50.540

这是我可能会做的。（如果您担心有时只有一个 data.frames 会包含尾随零，您可能希望首先使用类似`sprintf()`使两个 data.frames 的格式相同的东西。）

```
A <- apply(egress, 1, paste, collapse="_")
B <- apply(ingress, 1, paste, collapse="_")
egress[! A %in% B, ]
#       lat      lng
# 1 13.8333  44.6833
# 2 31.1429 -81.4710
# 4 33.9553 -83.3937
# 5 33.9553 -83.3937
# 6 38.9628 -95.2554
# 7 18.9667  72.8333
# 8 38.8147 -77.0647 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:35:05.557

`ingress`您可以为以后的子集设置一个虚拟变量。

```
ingress$both <- 1
not_both <- merge(egress, ingress, by=c("lat","lng"), all.x = T)
not_both <- subset(not_both, is.na(both)) 
```

# xna - 加载音效和音效实例后报错

> ID：10217959
> 
> 赞同：0
> 
> 时间：2012-04-18T21:02:58.617
> 
> 标签：xna

```
ExplosionSound = Content.Load<SoundEffect>("explosion");
            ExplosionSoundInstance = ExplosionSound.CreateInstance(); 
```

上述代码的最后一行带有下划线，我收到一条错误消息：“无法将类型'Microsoft.Xna.Framework.Audio.SoundEffectInstance'隐式转换为Microsoft.Xna.Framework.Audio.SoundEffect'。

帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:30:13.087

看起来好像您已将 ExplosionSoundInstance 声明为 SoundEffect...

将其声明为 SoundEffectInstance....

```
SoundEffectInstance ExplosionSoundInstance; 
```

# php - cakePHP 中的 RESTful Web 服务

> ID：10217960
> 
> 赞同：0
> 
> 时间：2012-04-18T21:03:03.233
> 
> 标签：php, web-services, cakephp, rest, cakephp-1.3

我遵循了[这个网站](http://book.cakephp.org/1.3/en/view/1238/REST)上的教程，它解释了如何使用 cakePHP 设置 REST，但是在我完成所有这些之后，当我在浏览器中调用我的控制器时（例如，我有一个具有默认 CRUD 操作的 PostsController），我仍然得到 html作为我的回应（不是xml）。看起来被调用的视图文件是 in`app/views/posts/index.ctp`而不是我放置的那个`app/views/posts/xml/index.ctp`。

谁能告诉我这里还有什么我想念的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T19:24:57.153

您使用的是什么版本的 cakePHP？如果您使用的是 2.x 版本，则解决方案非常简单。

1.  确保在控制器中包含此行

    ```
    public $components = array('RequestHandler'); 
    ```

2.  进入您的 app/Config/routes.php 并在以下行之前添加以下行`require CAKE . 'Config' . DS . 'routes.php';`：

    ```
    Router::mapResources('examples');
    Router::parseExtensions('xml'); 
    ```

    示例本质上只是您的视图的名称。

3.  请务必输入带有 xml 扩展名的 url。

    ```
    url/controller.xml 
    ```

这应该可以解决问题。包括 RequestHandler 组件，当“与 Router::parseExtensions() RequestHandler 结合使用时，会自动将布局和视图文件切换到与请求类型匹配的那些”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:38:57.020

Did you create an xml layout? You might need to just create a blank layout and in the view set the layout to the xml layout.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:43:16.923

尝试在你的控制器函数中加入这样的东西（或者在 beforeFiler 中更好）：

```
if(@($this->request->isXML() || $this->request->params['ext'] == 'xml')) {
    $this->RequestHandler->respondAs('xml');
} 
```

还要确保在 Config/routes.php 是

```
Router::parseExtensions('xml'); 
```

# html - 如何制作更改屏幕信息的选项卡

> ID：10217972
> 
> 赞同：0
> 
> 时间：2012-04-18T21:03:40.033
> 
> 标签：html

我正在制作一个网页，我希望在这个页面上有类似的标签

[http://wistia.com/pricing](http://wistia.com/pricing)点击时它会将价格从每月更改为每年。

我该怎么做呢？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:06:01.603

[jQuery UI 的选项卡](http://jqueryui.com/demos/tabs/)是您的一种选择。否则，您可以使用 HTML、CSS 和 JavaScript 的组合自行开发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:06:27.167

我很确定他们使用类似`div`和*Jquery的东西*

可能有用：[Jquery 教程](http://webdesignerwall.com/tutorials/jquery-tutorials-for-designers)

# javascript - 带有If和Else的jQuery动画背景颜色

> ID：10217977
> 
> 赞同：1
> 
> 时间：2012-04-18T21:04:04.253
> 
> 标签：javascript, jquery

我正在尝试在基于标签的 jQuery 函数中使用和，`if`例如：如果这样做，则执行其他操作。我试过这样：`else``backgroundColor``li``backgroundColor = #ccc`

```
if ($(this).css('backgroundColor = #EBE5C5')) { 
```

但它不起作用，你能帮帮我吗？

嗯，非常感谢，但它仍然无法正常工作，请在此处查看完整功能：

```
$(function(){
$('.slider-nav li')
    .mouseover(function(){
        if ($(this).css('background-color') == "#EBE5C5") { 
            $(this).stop().animate({'backgroundColor':'#c0ba9f'},250);
        }
    })
    .mouseout(function(){
        $(this).stop().animate({'backgroundColor':'#EBE5C5'},250);
    })
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T21:21:48.873

### jQuery 给我们 RGB，而不是 HEX

jQuery 将在请求时返回一个`rgb`值。`#CCC`例如，如果您将背景颜色设置为`#CCC`，然后使用 jQuery 请求它：

```
$(".foo").css("backgroundColor"); // rgb(204, 204, 204) 
```

### 从 RGB 获取 HEX

这意味着您需要有一种方法将 rgb 转换回 HEX。这个问题已经在 Stack Overflow 上被问及并得到了回答。请参阅[使用 jQuery 获取 HEX 值而不是 RGB 值](https://stackoverflow.com/questions/1740700/get-hex-value-rather-than-rgb-value-using-jquery)。出于我们的目的，我们可以使用以下函数：

```
//Function to convert hex format to a rgb color
function rgb2hex(rgb){
 rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
 return "#" +
  ("0" + parseInt(rgb[1],10).toString(16)).slice(-2) +
  ("0" + parseInt(rgb[2],10).toString(16)).slice(-2) +
  ("0" + parseInt(rgb[3],10).toString(16)).slice(-2);
} 
```

### 使平滑的背景颜色动画成为可能

这将负责检索和比较。接下来，您需要加载`$.animate()`稍微扩展该方法的 jQuery UI 核心。

```
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui..."></script> 
```

### 动画背景颜色

使用 jQuery UI 的核心就地（[此处为完整路径](https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js)），您可以执行以下操作：

```
$(".foo").animate({ backgroundColor: "#999999" }, 1000); 
```

这将`#999999`在一秒钟内逐渐为背景设置动画。

### 现在都在一起了

所以最后我们有以下内容（假设 jQuery UI 的核心是链接的）：

```
//Function to convert hex format to a rgb color
function rgb2hex(rgb){
 rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
 return "#" +
  ("0" + parseInt(rgb[1],10).toString(16)).slice(-2) +
  ("0" + parseInt(rgb[2],10).toString(16)).slice(-2) +
  ("0" + parseInt(rgb[3],10).toString(16)).slice(-2);
}

$("#hello").on("click", function(e){
  background = rgb2hex( $(this).css("backgroundColor") );
  if ( background == '#cccccc' ) {
    $(this).animate({
      backgroundColor: "#123456",
      color: "#fff"
    }, 1000);
  }
}); 
```

在线演示：http: [//jsbin.com/uwiyon/edit#javascript,html](http://jsbin.com/uwiyon/edit#javascript,html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:07:54.633

应该是这样的：

```
if ($(this).css('background-color') == 'red') {
   // do somethig
} else {
   // do something else
} 
```

请记住，一个等号是赋值。

这是jsFiddle：

[http://jsfiddle.net/F6WeR/1/](http://jsfiddle.net/F6WeR/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:09:35.527

尝试：

```
if( $(this).css('backgroundColor').indexOf('#EBE5C5')!=-1 ) 
```

使用 .css 和选择器获取值。然后你看看是否包含新值

这也应该有效，但是您必须查看该值是否有效地返回了该值。首先检查值

```
$(this).css('backgroundColor') 
```

然后尝试

```
if( $(this).css('backgroundColor')=='#EBE5C5' ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T21:09:59.463

您必须进行比较，“$（this）.css（“backgroundColor”）”返回背景颜色

```
if ($(this).css("backgroundColor") === "#EBE5C5") { 
```

注意严格比较的三个等号（您也可以使用“==”，但这个更快一点）

# solr - 来自管理控制台的搜索结果与 solr/browse 之间的区别

> ID：10217979
> 
> 赞同：0
> 
> 时间：2012-04-18T21:04:06.960
> 
> 标签：solr

我已经从 oracle 数据库中导入了我的 xml 文档并为它们编制了索引。当我搜索时*：*在管理控制台中，我确实得到了结果。我的 xml 格式与 solr 所期望的不接近。但是当我搜索属于我的 xml 文档的任何单词时，Solr 仍然显示整个 xml 文档。例如，如果我搜索单词“voicemail”，solr 会显示包含单词“voicemail”的 xml 文档

现在，当我去 solr/browse 并给出*：*我确实看到了一些东西，但每个结果都如下所示（没有数据），即使我搜索相同的词“语音邮件”，我也得到了下面。可以一些身体！！！！！！请指教！！！！！！

价格：特点：有货

我只能想到两件事，一是 solrconfig.xml 中的设置（如下所示）。

```
<requestHandler name="/browse" class="solr.SearchHandler">
<lst name="defaults">
       <str name="echoParams">explicit</str>

       <str name="wt">velocity</str>

       <str name="v.template">browse</str>
       <str name="v.layout">layout</str>
       <str name="title">Solritas</str>

       <str name="df">text</str>
       <str name="defType">edismax</str>
       <str name="q.alt">*:*</str>
       <str name="rows">10</str>
       <str name="fl">*,score</str>
       <str name="mlt.qf">
         text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4 
       </str>
       <str name="mlt.fl">text,features,name,sku,id,manu,cat</str>
       <int name="mlt.count">3</int>
       <str name="qf">
          text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4 
       </str> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T09:11:21.147

您将在 solr/collection/conf/velocity 文件夹中找到 browse.vm 和 product.vm 文件。
默认情况下，Solr 带有一个关于书籍数据的默认示例。因此 ui 部分显示
**价格：功能：有货**

如果要在浏览页面上显示索引字段的元数据，则必须在上述位置修改 product-doc.vm 文件，并且必须在其中添加元数据字段名称。

# asp.net - 在列表中设置asp文本框的样式？

> ID：10217980
> 
> 赞同：2
> 
> 时间：2012-04-18T21:04:09.043
> 
> 标签：asp.net, html, css

所以我在我的 CSS 中设计了一个 HTML 列表，如下所示：

```
.ulClaims li

{
   font-weight: bold; 
   color: #5c6467;
   font-size: 14px;
} 
```

我的一些“ **li** ”标签中有 asp:textboxes。无论如何我可以在我的 .ulClaims 类中为它们设置样式以使事情变得简单吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T21:06:59.463

您的 CSS 定义仅将样式应用于`li`s 的后代`.ulClaims`。要设置“文本框”的样式，请使用类似于：

```
.ulClaims li input[type="text"] { /* ... definitions ... */ }
.ulClaims li textarea { /* ... definitions ... */ } 
```

这将直接针对任何`input type="text"`or`textarea`的后代`.ulClaims li`。

# ios - Facebook 登录对话框错误地提示我的应用正在请求某种发布权限

> ID：10217984
> 
> 赞同：0
> 
> 时间：2012-04-18T21:04:32.307
> 
> 标签：ios, facebook, permissions

我的应用程序仅要求电子邮件许可：

```
NSArray *permissions = [[NSArray alloc] initWithObjects:@"email", nil];
[self.facebook authorize:permissions]; 
```

但是，当提示用户登录时，对话框说我的应用可以代表他们发布：

![对话](../Images/d83404403c4d1e0dbe46d3b422e0abec.png)

我错过了什么吗？

（更新）看起来我并不孤单。[https://developers.facebook.com/bugs/273948536030203](https://developers.facebook.com/bugs/273948536030203)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:13:27.563

也许您不小心（或者不是不小心但不记得）在 Auth Dialog 设置中启用了[Authenticated Referrals ？](http://developers.facebook.com/docs/opengraph/authentication/#referrals)

它发生在我们身上一次，花了一段时间才弄清楚为什么我们要求的权限被完全忽略了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:32:03.337

你确定不是`publish_actions`描述？这两个权限有相似的描述，如果您的应用发布 Open Graph 动作或游戏成就或分数，则 publish_actions 是隐含的

# c++ - Hadoop的可移植键值数据文件格式？

> ID：10217988
> 
> 赞同：2
> 
> 时间：2012-04-18T21:04:41.870
> 
> 标签：c++, python, hadoop, portability, key-value

我正在寻找一种可移植的键值数据文件格式，它可以作为 Hadoop 的输入和输出格式，并且除了 Hadoop 之外，它还可以直接在 C++、Java 和 Python 中读写。一个问题......我需要支持使用非 Java 映射器和化简器（特别是通过 Hadoop 管道的 c++）进行处理。

有任何想法吗？我应该编写自己的可移植键值文件格式，与 Hadoop 和 Hadoop 管道互操作吗？这种新格式对社区有用吗？

**长版：** Hadoop 序列文件（及其近亲 Map、Set、Array 和 BloomMap）似乎是使用 Hadoop 时高效二进制键值数据存储的标准。序列文件的一个缺点是它们只能在 Java 中可读和可写（它们是根据序列化的 java 对象指定的）。我想构建一个复杂的多阶段 MapReduce 管道，其中各个阶段的输入和输出必须可以从 C++、java 和 python 读取和写入。此外，为了在映射阶段使用大型且高度优化的 c++ 库，我需要能够用 java 以外的语言（即 c++）编写映射器和化简器。

我考虑过各种解决方法，但没有一个看起来……有吸引力。

1.  **转换**：在每个 MapReduce 阶段之前和之后添加额外的转换阶段，以在序列文件和与其他语言兼容的可移植格式之间转换阶段的输入和输出。
    *   问题：阶段之间消耗和生成的数据非常大（TB）......在每个阶段多次复制数据只是为了获得不同编程语言的读/写访问权限是昂贵的。有 10 个阶段，这对我来说开销太大了（$$$）。
2.  **Avro 文件**：使用 Avro 的可移植数据文件格式。
    *   问题：虽然似乎有代码允许可移植的 Avro 数据文件作为 MapReduce 中的输入或输出格式，但它只适用于用 Java 编写的映射器和缩减器。我已经看到了一些关于通过 avro/mapred/tether 包创建对其他语言的映射器支持的讨论，但目前只支持 java。来自文档：“目前只实现了一个 Java 框架，用于测试目的，所以这个功能还没有用。” [http://avro.apache.org/docs/1.5.4/api/java/org/apache/avro/mapred/tether/package-summary.html](http://avro.apache.org/docs/1.5.4/api/java/org/apache/avro/mapred/tether/package-summary.html)
3.  **Avro File + SWIG**：将 Avro 数据格式与 Java 映射器一起使用，该映射器调用从分布式缓存访问的自定义 SWIG 包装的 c++ 库来进行真正的处理。

    *   Java 字符串的不变性使得编写 SWIG 包装器变得痛苦且效率低下，因为需要一个副本。而且，这么多层次的包装开始成为维护调试和配置的噩梦！

我正在考虑基于与 Hadoop 和 Hadoop 管道互操作的 H-File 格式编写我自己的语言可移植键值文件格式……有更好的现成替代品吗？这种可移植的格式对社区有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:22:35.100

我认为您已经做出了一些错误假设：

> 序列文件的一个缺点是它们只能在 Java 中可读和可写（它们是根据序列化的 java 对象指定的）

取决于序列化的 java 对象的含义。Hadoop 使用 WritableSerialization 类来提供序列化机制，而不是默认的 Java 序列化机制。您可以将 hadoop 配置为使用默认的 Java 序列化 ( `JavaSerialization`)，或您选择的任何自定义实现（通过`io.serializations`配置属性）。

因此，如果您使用 Hadoop Writable 机制，您只需要为 C++ 编写一个可以解释序列文件的阅读器，然后编写您希望序列化的类的 c++/python 等价物（但这会很麻烦，并且会导致你的第二个问题，Avro）

> 此外，为了在映射阶段使用大型且高度优化的 c++ 库，我需要能够用 java 以外的语言（即 c++）编写映射器和化简器

您可以在 python/c++/任何当前使用 Hadoop Streaming 的语言中编写映射器/reducers，并使用序列文件来存储中间格式。所有流式传输需要的是您的映射器/缩减器/组合器需要`key\tvalue`成对输入标准输入（您可以自定义分隔符而不是制表符），并以类似的格式输出（同样是可自定义的）。

*   [http://hadoop.apache.org/common/docs/current/streaming.html](http://hadoop.apache.org/common/docs/current/streaming.html)（我相信你已经找到了这个链接，但以防万一）。

那么，如果您想将更复杂的键/值对传递到/从您的流式映射器/reducer 中呢？在这种情况下，我会说考虑自定义 contrib/流式源代码，特别是 PipeMapper、PipeReducer 和 PipeMapRed 类。例如，您可以将输出/输入修改为`<Type-int/str,Length-int,Value-byte[]>`元组，然后修改您的 python / c++ 代码以进行适当的解释。

通过这些修改，您可以使用 Avro 来管理围绕 hadoop 流框架 (Java) 和您的 c++/python 代码之间的序列化的代码。您甚至可以使用 Avro。

最后 - 您是否查看了`AvroAsTextInputFormat`和`AvroTextOutputFormat`类，它们可能正是您正在寻找的（警告，我从未使用过它们）

# c# - log4net 找不到自定义 XmlLayoutBase

> ID：10217994
> 
> 赞同：0
> 
> 时间：2012-04-18T21:05:23.903
> 
> 标签：c#, web-services, log4net

我正在尝试使用带有 log4net 的覆盖 XmlLayoutBase 来打印自定义日志。它昨天还在工作，但我做了一些重组，现在它正在爆炸。这是我到目前为止所做的。

装配信息.cs

`[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.config", Watch = true)]`

CustomXmlLayout.cs

```
namespace MyCompany.MyProduct.MyService.Utilities

public class CustomXmlLayout : XmlLayoutBase  
{  
    protected override void FormatXml(XmlWriter writer, LoggingEvent loggingEvent)  
    {  
        //Write stuff
    }  
} 
```

log4net.config

```
<?xml version="1.0"?>
<log4net>
  <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="logfile" />
    <appendToFile value="true" />
    <rollingStyle value="Date" />
    <datePattern value="yyyyMMdd'.xml'" />
    <staticLogFileName value="false" />
    <maxSizeRollbackups value="15" />
    <layout type="MyCompany.MyProduct.MyService.Utilities.CustomXmlLayout" />   
  </appender>
  <root>
    <level value="ALL" />
    <appender-ref ref="RollingLogFileAppender" />
  </root>
</log4net> 
```

日志文件

```
public static class Log
{
    private static ILog log = 
        log4net.LogManager.GetLogger(typeof(Log));

    static Log()
    {
        XmlConfigurator.Configure();
    }

    private static bool IsEnabled()
    {
        //Verify stuff
    }

    public static void Write(LogEntry entry)
    {            
        if (IsEnabled())
            log.Debug(entry);
    }
} 
```

无论出于何种原因，我的自定义类中的调用`log.Debug`永远不会到达`FormatXml`。有人有想法么？

*编辑*当我将 log4net 配置放回 web.config 时它工作正常，所以我猜它可能与 assemblyinfo 有一些关系......但我没有看到什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:37:21.020

在我看到这个工作的示例中，log4net 配置存储在一个名为`log4net.config`（如您所见）的文件中，*没有*xml 声明，例如`<?xml version="1.0"?>`- 试一试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T07:42:32.740

您应该将 configsections 添加到 log4net.config 文件中。

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>

    </configSections>

    <log4net>
       <!-- LOG4NET configuration-->
    </log4net>

</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T07:45:11.330

您正在配置 log4net 两次。移除 Log 类的静态构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T08:53:27.397

您没有为您的类型指定程序集：

`<layout type="MyCompany.MyProduct.MyService.Utilities.CustomXmlLayout" />`

应该：

`<layout type="MyCompany.MyProduct.MyService.Utilities.CustomXmlLayout, assemblyname" />`

其中**assemblyname**是您的输出 dll。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T15:13:58.103

我最终将配置部分留在了 web.config