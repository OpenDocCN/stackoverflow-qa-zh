# StackOverflow 问答 10791000-10791999

# css - 推荐的 CSS 符号

> ID：10791002
> 
> 赞同：5
> 
> 时间：2012-05-28T22:23:44.197
> 
> 标签：css

我有一个带有 ID 的 div：

```
<div id="main"> 
```

之间的正确（或区别）是什么

```
div#main { 
```

和

```
#main { 
```

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:37:26.810

关于使用高效的 CSS 选择器有[一个很棒的文档](https://developers.google.com/speed/docs/best-practices/rendering#UseEfficientCSSSelectors)，专注于*使用过度合格的选择器的规则*：

> ID 选择器根据定义是唯一的。包含标签或类限定符只会添加需要进行不必要评估的冗余信息。

您的选择器不仅将样式应用于具有 id 的元素，`main`还将通过检查它是否也是`div`（按该顺序）来重新限定元素。澄清一下：css选择器是*从右到左*评估的，这与在jQuery等中使用的选择器语法不同。

Re pixelistik 的建议`div#main`比`#main`- 是的，这在技术上是正确的，但是如果你不得不求助于这个来提高规则的特异性，那么你正在处理的 CSS 的结构很可能没有像它应该的那样经过深思熟虑.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:26:52.087

`#main`匹配 ID 为“main”的所有内容，而`div#main`仅匹配`<div>`ID 为 main 的元素。

理想情况下，您永远不应该有两个具有相同 ID 的元素，因此实际上这两者并没有什么区别，但是关于指定是否`div`使其更快地找到结果可能存在与性能相关的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T22:25:58.517

所以区别在于：

当您编写`div#main`样式时，将仅适用于`<div>`元素。当您编写`#main`时，它可以用作`<div>`、 `<span>`、`<p>`等的样式。

而且推荐的东西很难说，每个开发者都有它的不同。所以我使用例如 `span.<nameClass>`嵌套在`<li>`例如时。

```
#nav li span.href a {
 ...
} 
```

我认为当您希望具有特定名称的某个类只能具有一个元素时使用它。

所以当你写`span#href`它时，它只适用`<span id="href">Simply dummy text</span>`于其他人。当你写`#href`它时，它会起作用，`<span id="href">Simply dummy text</span>`或者`<a href="#" id="href">Link</a>`当你问这个问题时两者都是正确的。我在上面写的差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T22:29:29.843

两者都是正确的。

`div#main`比 更具体`#main`，这意味着使用第一个选择器定义的样式将覆盖第二个选择器的样式。

这是对 CSS 特异性的一个很好的介绍：http: [//htmldog.com/guides/cssadvanced/specificity/](http://htmldog.com/guides/cssadvanced/specificity/)

# c# - 我应该使用什么模式来表达分层枚举？

> ID：10791008
> 
> 赞同：8
> 
> 时间：2012-05-28T22:24:33.217
> 
> 标签：c#, architecture, enums, design-patterns

我正在尝试使用 API 在给定时间（值和时间的元组）发布值。这些样本将由数据查看器（例如图表）使用。

我想将该值与数量和单位相关联，例如以米为单位的长度。这样我的“观众”可以适当地缩放它。

我正在寻找一种分层枚举，如下所示：

```
enum Quantity
{
   Mass.Kg,
   Mass.g,
   Length.m,
   Length.mm
} 
```

但这在 C# 中不存在。

我不确定表达这一点的最佳模式，我想出了以下内容。是否有公认的或更好的方法来做到这一点？

```
using System;
using Moq;

namespace ConsoleApplication26
{
    class Program
    {
        static void Main(string[] args)
        {
            //use a Mock to play with the API
            Mock<ITelemetryPublisherFactory> mockTelemetryPublisherFactory = new Mock<ITelemetryPublisherFactory>();
            var telemetryPublisherFactory = mockTelemetryPublisherFactory.Object;

            //example usages
            var massTelemetryPublisher = telemetryPublisherFactory.GetChannelSamplePublisher<Double>("My Mass", Mass.Kg);
            massTelemetryPublisher.PublishChannelSampleAtTimeNow(83.4);                        

            var lengthTelemetryPublisher = telemetryPublisherFactory.GetChannelSamplePublisher<Int32>("My Height", Length.μm);
            lengthTelemetryPublisher.PublishChannelSampleAtTimeNow(1800000);      

            //10 years time..
            lengthTelemetryPublisher.PublishChannelSampleAtTimeNow(1800000);
            massTelemetryPublisher.PublishChannelSampleAtTimeNow(120.1);                        
        }
    }

    public interface ITelemetryPublisherFactory
    {
        ITelemetryPublisher<T> GetChannelSamplePublisher<T>(String channelName, Quantity quantity);
    }

    public interface ITelemetryPublisher<T>
    {
        void PublishChannelSampleAtTimeNow(T sampleValue);
    }

    public abstract class Quantity {}

    public class Mass : Quantity
    {
        private enum Unit
        {
            g,
            Kg
        }

        private readonly Unit _unit;

        private Mass(Unit unit)
        {
            _unit = unit;
        }

        public static Quantity Kg {get { return new Mass(Unit.Kg); }}
        public static Quantity g { get { return new Mass(Unit.g); } }

        public override string ToString()
        {
            return String.Format("Mass.{0}", _unit);
        }
    }

    public class Length : Quantity
    {
        private enum Unit
        {
            m,
            mm,
            μm,
            beardSecond
        }

        private readonly Unit _unit;

        private Length(Unit unit)
        {
            _unit = unit;
        }

        public static Quantity m { get { return new Length(Unit.m); } }
        public static Quantity mm { get { return new Length(Unit.mm); } }
        public static Quantity μm { get { return new Length(Unit.μm); } }
        public static Quantity beardSecond { get { return new Length(Unit.beardSecond); } }

        public override string ToString()
        {
            return String.Format("Length.{0}", _unit);
        }        
    }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:23:36.670

我认为最好`Unit`为度量单位创建一个类，以及一个`Quantity`将度量单位与数量相关联的类。查看这个想法的[数量模式](http://martinfowler.com/eaaDev/quantity.html)。由于您还想记录计量单位的“类型”，您可以创建一个`UnitType`记录该信息的类：

```
public sealed partial class UnitType {
  public string Name { get; private set; }
  public UnitType(string name) {
    Name = name;
  }
}

public sealed partial class Unit {
  public string Name { get; private set; }
  public UnitType Type { get; private set; }
  public Unit(string name, UnitType type) {
    Name = name;
    Type = type;
  }
} 
```

（您应该通过覆盖`Equals`和使它们成为正确的值类型`GetHashCode`）

`Unit`可以扩展该类以提供例如转换、复合单元、格式化和解析。

然后，您可以在类中定义常见情况：

```
public partial class UnitType {
  public static readonly UnitType Mass = new UnitType("Mass");
  public static readonly UnitType Length = new UnitType("Length");
}

public partial class Unit {
  public static readonly Unit Grams = new Unit("g", UnitType.Mass);
  public static readonly Unit Kilos = new Unit("kg", UnitType.Mass);
  // ...
} 
```

或者用静态类定义你的“层次结构”：

```
public static class Mass {
  public static readonly UnitType Type = new UnitType("Mass");

  public static readonly Unit Grams = new Unit("g", Type);
  public static readonly Unit Kilos = new Unit("kg", Type);
  ...
}

public static class Length ... 
```

该类`Quantity`也将是一个不可变的值类型（仅显示其用法）：

```
var eniacWeight = new Quantity(27, Mass.Tons); 
```

或者您可以使用扩展方法来创建`Quantity`s：

```
var eniacWeight = 27.Tons(); 
```

（来自[ENIAC](http://en.wikipedia.org/wiki/ENIAC)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:56:26.830

您建议的方法对我来说似乎很合理，我在我的项目中使用了类似的方法。但是，我保留了对象的实际值部分，并且我使用`struct`而不是`class`，因为它们自然是值类型。这里不需要继承（无论如何，结构也不可能），所以我使用接口来创建契约并在需要时充当约束（我称之为它`IUnitOfMeasure`）。

我不建议创建一个将各种测量类型的所有单位组合在一起的枚举；验证单位以确保有人在使用长度时没有引用质量单位是地狱。

```
public interface IUnitOfMeasure<TThis>
    where TThis : IUnitOfMeasure<TThis>
{
    TThis ConvertTo(TThis value);
}

public struct Mass : IUnitOfMeasure<Mass>
{
    public enum Units
    {
        Gram,
        Kilogram
    }

    private double _value;
    private Mass.Units _unit;

    public double Value { get { return _value; } }

    public Mass.Units Unit { get { return _unit; } }

    public Mass(double value, Mass.Units unit)
    {
        _value = value;
        _unit = unit;
    }

    public Mass ConvertTo(Mass value)
    {
        switch(value.Unit)
        {
            case Units.Gram:
                return new Mass(Unit == Units.Gram ? Value : Value/1000, Units.Gram);
            case Units.Kilogram:
                return new Mass(Unit == Units.Gram ? Value*1000 : Value, Units.Kilogram);
            default:
                throw new NotImplementedException();
        }
    }

    public override string ToString()
    {
        return string.Format("{0} {1}", Value, Unit);
    }

    public static readonly Mass G = new Mass(0, Units.Gram);
    public static readonly Mass Kg = new Mass(0, Units.Kilogram);
} 
```

用法：

```
var kg = new Mass(5.0, Mass.Units.Kilogram);

Console.WriteLine(kg); // writes "5 Kilogram"

var g = kg.ConvertTo(Mass.G);

Console.WriteLine(g); // writes ".005 Gram" 
```

如果您不关心保留值，而只想将枚举/静态值保留在中心位置：

```
public static class UnitOfMeasure
{
    public enum Mass
    {
      Gram,
      Kilogram
    }

    public enum Length
    {
       Meter,
       Kilometer
    }
    // etc.
} 
```

用法：`var unit = UnitOfMeasure.Mass.Kilogram;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T22:59:04.537

这是不可能的。枚举是原始类型，不能从其他枚举继承，因为继承是对象的属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T23:24:08.257

如上所述，分层枚举是不可能的。但是，如果您只使用公制，则可以在有帮助的情况下使用标准前缀。

```
enum MeasurementUnits
{
    Gram,
    Metre,
    Litre,
    Hectare
    // etc
}

enum MeasurementPrefix
{
    Milli,
    Natural,
    Kilo,
    Mega
    // etc
} 
```

这可能不是您想要的，但它会提供您可能正在寻找的“分组”类型（例如，通过检查它们的“单位”值来对长度、重量等进行分组）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T23:18:10.417

你不能用枚举引入继承。枚举只是一种方便的机制，允许您在代码中使用有意义的文本标识符。从您拥有的代码中，我建议您使用类似的枚举；

```
public enum UnitOfMeasure
{
    MassGrams,
    MassKg,
    LengthMM,
    LengthCM,
    . . .
} 
```

或者将其拆分到合适的位置，例如分别定义质量和长度。

'继承'只是您在考虑这个问题时引入的东西，但它不是您的解决方案所必需的。当你想处理质量时，你只需要查看适合质量的标志/枚举。

# java - Listview 清除/重置/完成不起作用

> ID：10791014
> 
> 赞同：0
> 
> 时间：2012-05-28T22:25:03.317
> 
> 标签：java, android, xml, listview

我有一个带有 2 个活动的 Android 应用程序第一个（主要）活动：带有可用 XML 文件的下拉列表第二个（列表）活动：在 ListView / Listadapter 中显示结果

该应用程序工作正常，但是当我在第二个活动上使用“后退”按钮时，它会完成应用程序并清除 ArrayList（使用 System.out 测试）并选择另一个 XML 视图，显示旧的 XML 结果。

所以基本上它看起来像列表视图仍然出现在我的记忆中，我该如何清除/重置它？

```
 XMLParse parser = new XMLParse();
    String xml = parser.getXmlFromUrl(URL); // getting XML
    Document doc = parser.getDomElement(xml); // getting DOM element
            //SOME CODE//

    // Adding menuItems to ListView
    adapter = new SimpleAdapter(this, menuItems,
            R.layout.list_item,
            new String[] { bestemming, vertrek, spoor, vertraging }, new int[] {
                    R.id.bestemming, R.id.vertrek, R.id.spoor, R.id.vertraging });
    setListAdapter(adapter);

    final Button button = (Button) findViewById(R.id.back);
    button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            menuItems.clear();
            finish();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T03:23:20.783

你用 ArrayAdapter 试过了吗？

```
adapter = new ArrayAdapter ...
...
menuItems.clear();
adapter.clear();
... 
```

或者

```
listView.setAdapter(null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:07:24.247

您必须通知适配器您已更改 ArrayList 并且它将重绘它。有时它会在没有通知的情况下重绘，但有时会显示旧数据。

在您的主要活动中尝试使用类似的东西：

```
@Override
protected void onResume() {
    super.onResume();

    adapter.notifyDataSetChanged();
} 
```

# android - 市场中的 Google +1 按钮（google play）

> ID：10791017
> 
> 赞同：1
> 
> 时间：2012-05-28T22:25:16.283
> 
> 标签：android, google-play

我注意到 Google Play 现在显示了一个 +1 按钮，因此人们可以说他们喜欢您的应用程序。有没有办法知道它的统计数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:38:21.237

除了市场上显示的数字外，没有其他办法。我相信谷歌正在努力将它添加到开发控制台。

# c++ - 无法从 Qt 中的 QWebPage 接收下载请求

> ID：10791021
> 
> 赞同：2
> 
> 时间：2012-05-28T22:25:53.990
> 
> 标签：c++, qt, mobile, download, qwebpage

我正在尝试为 QGraphicsWebView 创建一个下载管理器，到目前为止它运行良好，除了一件事：我无法将下载请求从 QWebPage 发送到下载管理器。

```
QObject::connect(webPage, SIGNAL(downloadRequested(const QNetworkRequest&)),
                 this, SLOT(downloadRequested(const QNetworkRequest&))); 
```

这是我的代码，用于将下载请求信号连接到将请求转发到下载管理器的插槽。我在其他操作之前在插槽中放置了一条 qDebug() 消息，但未显示该消息。这意味着当我单击文件的链接时不会发送信号。

当用户单击文件的链接时，有没有办法可以发送信号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:52:34.280

仅当`downloadRequested(QNetworkRequest)`您右键单击链接，然后单击上下文菜单的“保存链接...”项时才会发出信号。

当用户单击应该下载的内容的链接（使用 HTTP 字段`Content-Disposition: attachment; filename=...`）时，`QWebPage`会发出 `unsupportedContent(QNetworkReply*)`信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T04:37:51.727

看这个：[QWebPage::unsupportedContent](http://qt-project.org/doc/qt-4.8/qwebpage.html#unsupportedContent)

# ios - 在 iOS 上，setNeedsDisplay 真的不会导致 drawRect 被调用...除非 CALayer 的 display 或 drawInContext 最终调用 drawRect？

> ID：10791025
> 
> 赞同：3
> 
> 时间：2012-05-28T22:26:14.797
> 
> 标签：ios, uiview, core-animation, calayer, drawrect

我真的不明白 CALayer`display`和视图中的`drawInContext`关系`drawRect`。

如果我有一个设置`[self.view setNeedsDisplay]`每 1 秒的 NSTimer，则每 1 秒`drawRect`调用一次，如`drawRect`.

但是，如果我将一个 CALayer 子类化并将其用于视图，如果我将该`display`方法设为空，那么 now`drawRect`将永远不会被调用。 **更新：**但是`display`每 1 秒调用一次，如 NSLog 语句所示。

如果我删除该空`display`方法并添加一个空`drawInContext`方法，`drawRect`则永远不会再调用它。 **更新：**但是`drawInContext`每 1 秒调用一次，如 NSLog 语句所示。

到底发生了什么？似乎`display`可以选择性地调用`drawInContext`并且`drawInContext`可以选择性地以某种方式调用`drawRect`（如何？），但这里的真实情况是什么？

* * *

**更新：答案有更多线索：**

我将`CoolLayer.m`代码更改为以下内容：

```
-(void) display {
    NSLog(@"In CoolLayer's display method");
    [super display];
}

-(void) drawInContext:(CGContextRef)ctx {
    NSLog(@"In CoolLayer's drawInContext method");
    [super drawInContext:ctx];
} 
```

因此，假设在 View 的位置 (100,100) 处有一个月亮（由 Core Graphics 绘制的圆圈），现在我将其更改为位置 (200,200)，自然会调用`[self.view setNeedsDisplay]`，现在，CALayer 将新视图图像根本没有缓存，因为我`drawRect`决定现在应该如何显示月亮。

即便如此，入口点是 CALayer's `display`，然后是 CALayer's `drawInContext`: 如果我在 处设置断点`drawRect`，调用堆栈显示：

![在此处输入图像描述](../Images/5a44382f2fb6826f3acf2ea253645da5.png)

所以我们可以看到 CoolLayer's`display`是先进入的，然后是 CALayer's `display`，然后是 CoolLayer's `drawInContext`，然后是 CALayer's `drawInContext`，即使在这种情况下，新图像不存在这样的缓存。

最后，CALayer`drawInContext`调用委托的`drawLayer:InContext`. 委托是视图（FooView 或 UIView）......并且`drawLayer:InContext`是 UIView 中的默认实现（因为我没有覆盖它）。终于`drawLayer:InContext`叫了`drawRect`。

所以我猜测两点：为什么即使没有图像缓存它也会进入CALayer？因为通过这种机制，图像是在上下文中绘制的，最后返回到`display`，CGImage就是从这个上下文中创建出来的，然后现在将其设置为缓存的新图像。这就是 CALayer 缓存图像的方式。

我不太确定的另一件事是：如果`[self.view setNeedsDisplay]`总是触发`drawRect`被调用，那么什么时候可以使用 CALayer 中的缓存图像？可能是......在Mac OS X上，当另一个窗口覆盖一个窗口时，现在顶部窗口被移开。现在我们不需要调用`drawRect`重绘一切，而是可以使用CALayer中的缓存图像。或者在 iOS 上，如果我们停止应用程序，执行其他操作，然后返回应用程序，则可以使用缓存的图像，而不是调用`drawRect`. 但是如何区分这两种“脏”呢？一个是“未知的脏”——月亮需要按照`drawRect`逻辑的要求重新绘制（它也可以在那里使用随机数作为坐标）。其他类型的脏是它被掩盖或消失，现在需要重新显示。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T20:06:21.760

当需要显示某个层并且没有有效的后备存储时（可能是因为该层收到了一条`setNeedsDisplay`消息），系统会将`display`消息发送给该层。

该`-[CALayer display]`方法大致如下所示：

```
- (void)display {
    if ([self.delegate respondsToSelector:@selector(displayLayer:)]) {
        [[self.delegate retain] displayLayer:self];
        [self.delegate release];
        return;
    }

    CABackingStoreRef backing = _backingStore;
    if (!backing) {
        backing = _backingStore = ... code here to create and configure
            the CABackingStore properly, given the layer size, isOpaque,
            contentScale, etc.
    }

    CGContextRef gc = ... code here to create a CGContext that draws into backing,
        with the proper clip region
    ... also code to set up a bitmap in memory shared with the WindowServer process

    [self drawInContext:gc];
    self.contents = backing;
} 
```

因此，如果您覆盖`display`，除非您调用`[super display]`. 如果你实现`displayLayer:`in `FooView`，你必须以某种方式创建自己的`CGImage`并将其存储在图层的`contents`属性中。

该`-[CALayer drawInContext:]`方法大致如下所示：

```
- (void)drawInContext:(CGContextRef)gc {
    if ([self.delegate respondsToSelector:@selector(drawLayer:inContext:)]) {
        [[self.delegate retain] drawLayer:self inContext:gc];
        [self.delegate release];
        return;
    } else {
        CAAction *action = [self actionForKey:@"onDraw"];
        if (action) {
            NSDictionary *args = [NSDictionary dictionaryWithObject:gc forKey:@"context"];
            [action runActionForKey:@"onDraw" object:self arguments:args];
        }
    }
} 
```

`onDraw`据我所知，该行动没有记录在案。

该`-[UIView drawLayer:inContext:]`方法大致如下所示：

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)gc {
    set gc's stroke and fill color spaces to device RGB;
    UIGraphicsPushContext(gc);
    fill gc with the view's background color;
    if ([self respondsToSelector:@selector(drawRect:)]) {
        [self drawRect:CGContextGetClipBoundingBox(gc)];
    }
    UIGraphicsPopContext(gc);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:30:11.883

UIView 的更新过程是基于`dirty`状态的，这意味着如果视图的外观没有变化，则视图不太可能被重绘。

那是开发人员参考中提到的内部实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T15:49:14.280

实现 drawInContext 或 display 或 drawRect 会告诉操作系统在视图脏时要调用哪个（需要显示）。选择一个你想要调用脏视图的代码并实现它，不要将任何你依赖的代码放在其他代码中。

# java - 在 JAVA 中验证 JSON 字符串对象格式的最佳方法是什么

> ID：10791027
> 
> 赞同：2
> 
> 时间：2012-05-28T22:26:21.103
> 
> 标签：java, json, string, validation, rest

我想验证字符串对象是否是有效的 json 对象，无论其数据是否正确。换句话说，这个 json 字符串的格式是否正确？

例如，给我：

“abc”：“123”，“cba”：“233”}

该过程应返回格式异常。{ "abc":"123" "cba":"233" }

应该给同样的。

您可能认为这很容易，但我们如何才能及时做到并避免重复过程（解组不应该依赖于验证的结果）？在我们的案例中，处理字符串可能会消耗资源。

但是，如果这个成本是绝对不可避免的，那么我们在 java 中验证 json 字符串的最快方法/工具是什么？

请注意，我们的案例中使用了 Jersey-json。不幸的是，它没有一个很好的 JSON 对象格式验证器。所以基本上一个字符串被传入并且在它被解组之前，我需要在它上面应用一个验证器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:32:30.803

[这](http://www.stringtree.org/stringtree-json.html)是一个很好的处理 JSON 的库。您可以使用`JSONValidatingReader`该类来验证 JSON 格式是否有效。

谈到工具，如果您正在寻找 Java 之外的一些工具，您可以随时尝试[JSONLint](http://jsonlint.com/)。更快、更简单、更清晰的错误消息，但它是基于网络的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:30:20.010

使用像[Jackson](http://jackson.codehaus.org/)这样已经知道如何为您执行此操作的库。

# java - while-else-循环

> ID：10791030
> 
> 赞同：11
> 
> 时间：2012-05-28T22:26:33.250
> 
> 标签：java, performance, arraylist, while-loop, theory

当然，这在 java 中是不可能的（迄今为止），但理想情况下我想实现它，因为它是许多迭代的核心。例如，第一次多次调用它时，我在创建`ArrayList`. 不幸的是，我的实际代码没有循环`set`内部；`else`因此它会通过命令和`add`然后`set`浪费时间。

之后，我还将它放在另一个循环中，它仅在数据已创建时执行集合，并且在许多其他循环中它是多重嵌套的，因此这是一个漫长的过程。

```
ArrayList<Integer>  dataColLinker = new java.util.ArrayList<Integer>();
...
...
public void setLinkerAt( int value, int rowIndex) {
    ...
    while(rowIndex >= dataColLinker.size()) {
        dataColLinker.add(value);
    } else {
        dataColLinker.set(rowIndex, value);
    } 
```

有什么想法或理论吗？`if`当涉及到语句和`ArrayList`命令等时，我不确定 java 的速度

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-28T22:34:08.547

我错过了什么吗？

这不是假设的代码吗

```
while(rowIndex >= dataColLinker.size()) {
    dataColLinker.add(value);
} else {
    dataColLinker.set(rowIndex, value);
} 
```

和这个意思一样吗？

```
while(rowIndex >= dataColLinker.size()) {
    dataColLinker.add(value);
}
dataColLinker.set(rowIndex, value); 
```

或这个？

```
if (rowIndex >= dataColLinker.size()) {
    do {
        dataColLinker.add(value);
    } while(rowIndex >= dataColLinker.size());
} else {
    dataColLinker.set(rowIndex, value);
} 
```

（后者更有意义......我猜）。无论哪种方式，很明显您可以重写循环，以便在循环内不会重复“其他测试”......就像我刚刚所做的那样。

* * *

FWIW，这很可能是过早优化的情况。也就是说，您可能在浪费时间优化不需要优化的代码：

*   如您所知，JIT 编译器的优化器可能已经移动了代码，因此“else”部分不再在循环中。

*   即使没有，您尝试优化的特定事物也可能不是重大瓶颈……即使它可能被执行 600,000 次。

我的建议是暂时忘记这个问题。让程序运行起来。当它工作时，决定它是否运行得足够快。如果没有，则对其进行分析，并使用分析器输出来决定值得花时间优化的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:32:00.033

我不明白为什么有一段时间的封装......

采用

```
//Use the appropriate start and end...
for(int rowIndex = 0, e = 65536; i < e; ++i){        
    if(rowIndex >= dataColLinker.size()) {
         dataColLinker.add(value);
     } else {
        dataColLinker.set(rowIndex, value);
     }    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T22:30:23.293

将“set”语句包装为“如果未设置则设置”并将其裸露在 while 循环之上。

你是对的，这种语言并没有提供你正在寻找的语法，但那是因为有像我刚才建议的那样的编程范式，所以你不需要你提出的语法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-10T15:41:58.770

```
boolean entered = false, last;
while (( entered |= last = ( condition ) )) {
        // Do while
} if ( !entered ) {
        // Else
} 
```

别客气。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-27T02:35:28.020

Java 没有这种控制结构。
但应该注意的是，其他语言也是如此。
例如，Python 具有[while-else](https://docs.python.org/3/reference/compound_stmts.html?highlight=while#the-while-statement)结构。

在 Java 的情况下，您可以模仿这种行为，正如您已经展示的那样：

```
if (rowIndex >= dataColLinker.size()) {
    do {
        dataColLinker.add(value);
    } while(rowIndex >= dataColLinker.size());
} else {
    dataColLinker.set(rowIndex, value);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-09T22:41:46.443

此 while else 语句应仅在条件为 false 时执行 else 代码，这意味着它将始终执行它。但是，有一个问题，当你在 while 循环中使用 break 关键字时，else 语句不应该执行。

满足does条件的代码只有：

```
boolean entered = false;
while (condition) {
   entered = true; // Set it to true stright away
   // While loop code

   // If you want to break out of this loop
   if (condition) {
      entered = false;
      break;
   }
} if (!entered) {
   // else code
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-20T21:07:56.750

假设您来自 Python 并接受这一点：

```
def setLinkerAt(value, rowIndex):
    isEnough = lambda i: return i < dataColLinker.count()
    while (not isEnough(rowIndex)):
        dataColLinker.append(value)
    else:
        dataColLinker[rowIndex] = value 
```

我能想到的最相似的是：

```
public void setLinkerAt( int value, int rowIndex) {
    isEnough = (i) -> { return i < dataColLine.size; }
    if(isEnough()){
        dataColLinker.set(rowIndex, value);
    }
    else while(!isEnough(rowInex)) {
        dataColLinker.add(value);
    } 
```

注意逻辑和逆向逻辑的必要性。我不确定这是一个很好的解决方案（逻辑的重复），但无括号`else`是我能想到的最接近的语法，同时保持相同的行为，即不执行超过所需的逻辑。

# c# - 基于层次结构中的类型优化和优雅地执行某些行为

> ID：10791043
> 
> 赞同：1
> 
> 时间：2012-05-28T22:27:53.717
> 
> 标签：c#, performance, type-conversion, hierarchy, overloading

我正在尝试优化我的代码的某个部分，这恰好处于一个紧密的性能循环中。主要是我想学习新的东西，我可以在未来应用。我的实现非常冗长，所以我将给出一个我想要实现的一般示例。

我的问题与此有关：[C# 'is' operator performance](https://stackoverflow.com/questions/686412/c-sharp-is-operator-performance)，尤其是所选答案。

假设我有一个类 A。我还有一个类 B，它派生自 A。我有一个类型 A 的列表（其中包含 A 和 B 类型的混合）。在我处理这些项目的方法中，我想根据对象的实际类型实现某种行为（不确定这是否是正确的说法。请在我说错的地方纠正我）。

```
void Process(A item)
{
   if (item is A)
   {
      DoBehavior((A)item); //I know the cast is redundant here, I'm just leaving 
                           //it here for my explanation.
   }
   else if (item is B)
   {
      DoBehavior((B)item);
   }
}

void DoBehaviour(A item)
{
   //perform necessary behaviour for type A
}

void DoBehaviour(B item)
{
   //perform necessary behaviour for type B
} 
```

这是我目前的做法。请注意，我遍历了包含 A 和 B 的类型 A 的列表。另外，如果您觉得我没有提供足够的代码来澄清这种情况，我会很乐意扩展。

在我上面发布的问题：[C# 'is' operator performance](https://stackoverflow.com/questions/686412/c-sharp-is-operator-performance)中，我了解到我可以更改结构以使用“as”运算符，并完全摆脱显式强制转换。

```
B bItem = item as B;

if (bItem  != null)
{
    DoBehavior(bItem);
} 
```

这一切都很好，然而，实际上我不仅有一个 A 和一个 B，我还有一个 C、一个 D 等等，它们都是从基类 A 派生的。这将导致许多这样的 if 语句，并且它们必须嵌套以获得最佳性能：

```
B bItem = item as B;

if (bItem  != null)
{
    DoBehavior(bItem);
}
else
{
   C cItem = item as C;
   if (cItem != null)
   {
      DoBehavior(cItem);
   }
   else
   {
      //and so on.
   }
} 
```

现在这很丑陋。我喜欢编写整洁、优雅的代码，但我在这方面做得特别差（这常常导致我浪费时间试图让事情看起来更好一点）。

我希望这个问题不要太宽泛，但首先我想知道在获取类型时是否有更优化和更干净的解决方案，以便执行相关行为。如果没有，有没有比这样嵌套更清洁的方式来使用这些“as”运算符？

我想一种替代方法是将行为移到基类 A 中，然后为每个派生类覆盖它。然而，在更高的思维意义上，我这个特殊情况下的行为不是 A 类（或者它的孩子）的行为，而是一些外部类在它上面的行为/行为（对于每种类型，它的行为会有所不同）。如果没有更好的方法来做到这一点，我将强烈考虑实施它，正如我现在解释的那样 - 但我希望对此有一些专家意见。

我试图保持简短，并且可能遗漏了太多细节。让我知道是否是这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:51:55.740

这不就是多态性的全部意义吗？一种根据其类型具有不同行为的方法。而且我相当肯定这会比“类型切换”更快。
如果需要，您还可以使用函数重载（用于您的外部处理），请参见下面的测试程序：

```
using System;
using System.Collections.Generic;

public class A
{
    public String Value
    {
        get;
        set;
    }

    public A()
    {
        Value = "A's value";
    }

    public virtual void Process()
    {
        // Do algorithm for type A
        Console.WriteLine("In A.Process()");
    }
}

public class B : A
{
    public int Health
    {
        get;
        set;
    }

    public B()
    {
        Value = "B's value";
        Health = 100;
    }

    public override void Process()
    {
        // Do algorithm for type B
        Console.WriteLine("In B.Process()");
    }
}

public static class Manager
{
    // Does internal processing
    public static void ProcessInternal(List<A> items)
    {
        foreach(dynamic item in items)
        {
            item.Process(); // Call A.Process() or B.Process() depending on type
            ProcessExternal(item);
        }
    }

    public static void ProcessExternal(A a)
    {
        Console.WriteLine(a.Value);
    }

    public static void ProcessExternal(B b)
    {
        Console.WriteLine(b.Health);
    }

    public static void Main(String[] args)
    {
        List<A> objects = new List<A>();
        objects.Add(new A());
        objects.Add(new B());
        ProcessInternal(objects);
    }
} 
```

**请注意，这仅适用于 .Net 4.0 ！**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:54:12.243

我强烈建议您通过编程接口而不是引用具体类来避免“if..else if..else if..”路径。

为此，首先使`Process()`方法不知道其参数的类型。可能该参数最终将成为一个接口，例如`IDoSomething`.

接下来，实现`Process()`它不会`DoSomething()`直接调用。您将不得不分解`DoSomething()`更小的代码块，这些代码块将被移动到`IDoSomething`方法的特定实现中。该`Process()`方法将盲目地调用这些方法——换句话说，将`IDoSomething`契约应用于某些数据。

越复杂，这可能会令人厌烦`DoSomething()`，但是您将拥有更好的关注点分离，并且将“打开”`Process()`任何`IDoSomething`兼容类型，甚至无需再编写一个`else`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T10:11:40.647

我发现的情况的最佳解决方案是使用双调度/访客模式。我描述了基类 A 是抽象的，具体类 B 和 C 继承自 A 的情况。此外，通过使基类 A 中的 DoBehavior 方法抽象，我们强迫自己在需要的任何地方为其实现实现，所以如果我们扩展它以添加更多类型，我们不会忘记添加它的 DoBehavior 方法（似乎不太可能忘记，但这种行为对于您添加的其他新类型可能无关紧要，并且可能会被忽略 -特别是如果有很多这样的行为模式）

```
interface IVisitor
{
   void DoBehavior(B item);
   void DoBehavior(C item);
}

abstract class A
{
    abstract void DoBehavior(IVisitor visitor);
}

class B : A
{
    override void DoBehavior(IVisitor visitor)
    {
       //can do some internal behavior here    
       visitor.DoBehavior(this); //external processing
    }
}

class C : A
{
    override void DoBehavior(IVisitor visitor)
    {
       //can do some internal behavior here   
       visitor.DoBehavior(this); //external processing
    }
}

class Manager: IVisitor //(or executor or whatever. The external processing class)
{

    public static void ProcessAll(List<A> items)
    {
        foreach(A item in items)
        {
            item.DoBehavior(this);
        }
    }

   void DoBehavior(B item)
   {

   }

   void DoBehavior(C item);
   { 

   }

} 
```

谢谢大家的贡献。学到了很多东西，并从大家那里得到了一些好主意（如果您遇到类似情况，阅读所有答案是值得的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T22:38:17.653

一种简单的解决方案是在指定类类型的基类中添加一个字段。

```
 class A
    {
        // Alternative
        string typeName =  this.GetType().Name;
        public virtual string TypeName { get { return typeName; } }

        public virtual string GetTypeName() { return "A"; }
    }

    class B : A
    {
        public override string GetTypeName() { return "B"; }
    }

    class C : A
    {
        public override string GetTypeName() { return "C"; }
    }

    class Executer
    {

        void ExecuteCommand(A val)
        {
            Console.WriteLine(val.GetType().Name);

            switch (val.GetTypeName())
            {
                case "A": DoSomethingA(val as A); break;
                case "B": DoSomethingB(val as B); break;
                case "C": DoSomethingC(val as C); break;
            }
        }

        private void DoSomethingC(C c)
        {
            throw new NotImplementedException();
        }

        private void DoSomethingB(B b)
        {
            throw new NotImplementedException();
        }

        private void DoSomethingA(A a)
        {
            throw new NotImplementedException();
        }

    } 
```

您实际上并不需要使用字符串，但我更喜欢使用该选项而不是使用整数，原因很简单，您不能在同一个命名空间中声明 2 个具有相同名称的类，因此如果您总是返回名称类，您有自动反冲突机制。

# c - 把字符串变成代码？

> ID：10791050
> 
> 赞同：1
> 
> 时间：2012-05-28T22:28:34.943
> 
> 标签：c, string, io, interpreter

因此，假设我有一个包含一些 C 代码的字符串，可以预测地从一个文件中读取，该文件中除了普通的 C 代码之外还有其他内容。我如何将此字符串转换为程序可用的代码？我是否必须编写一个完整的解释器，或者是否有一个库已经为我完成了这项工作？有问题的代码可能会调用我在实际 C 文件中声明的子例程，因此仅考虑常用 C 命令的子例程可能不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:36:21.400

哇。对于 C，这实际上非常困难。

你基本上有几个选择：

### 解释代码

为此，您将不得不编写一个解释器，而解释 C 是一个相当困难的问题。过去有可用的 C 解释器，但我最近没有读到过。无论如何，除非你*真的真的*需要这个，否则编写自己的解释器是一个*大*工程。

[谷歌搜索](https://www.google.com/webhp?sourceid=chrome-instant&ix=h9&ie=UTF-8#hl=en&newwindow=1&safe=off&output=search&sclient=psy-ab&q=open%20source%20C%20interpreter&oq=&aq=&aqi=&aql=&gs_l=&pbx=1&fp=4892cb34971d8ce7&ix=h9&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&biw=1576&bih=994)确实显示了几个开源（部分）C 解释器，比如[picoc](http://code.google.com/p/picoc/)

### 编译并动态加载

如果您可以捕获代码并将其包装成句法完整的 C 源文件，那么您可以将其编译为 C 动态可加载库：Windows 中的 DLL，或更多 UNIX 变体中的 .so。然后你可以在运行时加载结果。

现在，通常会导致某人这样做是需要能够表达一些复杂的脚本功能。您是否考虑过使用*不同*语言的可能性？Python、Scheme (guile) 和 Lua 很容易作为脚本语言添加到 C 应用程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:31:49.063

C 没有这种性质。这是因为 C 是编译的，并且编译器需要在代码开始运行之前对代码进行大量构建（因此接收一个字符串作为输入），它不能真正轻松地即时更改。编译语言对它们具有刚性，而解释语言具有灵活性。

您正在考虑 Perl、Python PHP 等以及所谓的“第四代语言”。我确信在 cs 中有一个技术术语来表示这种灵活性，但 C 没有它。如果您有一项需要大量使用这种字符串的任务，则需要切换到其中一种语言（并放弃性能）。`/e`例如，用正则表达式检查 Perl 的标志。

在 C 中，您需要设计您的应用程序，因此您不需要这样做。这通常是非常可行的，因为它的非面向对象和其他缺陷，许多巨大、复杂的应用程序在编写良好的 C 上运行得很好。

# asp.net-mvc - 从视图调用操作

> ID：10791055
> 
> 赞同：0
> 
> 时间：2012-05-28T22:29:17.810
> 
> 标签：asp.net-mvc

这是我的行动：

```
[HttpPost]
    public ActionResult AddDispo(string idv, string dd, string df)
    {
        try
        {
            Models.indisponible model = new Models.indisponible();
            model.Dd = Convert.ToDateTime(dd);
            model.Df = Convert.ToDateTime(df);
            model.idv = idv;
            entity.indisponible.AddObject(model);
            entity.SaveChanges();
            TempData["Resultat"] = "La nouvelle date a été ajouté courrectement";
            return RedirectToAction("Dispo", "Agence", new { idv = idv});
        }
        catch (Exception)
        {
            TempData["Resultat"] = "Une erreur se produiset Vielliez ressaiyer";
            return RedirectToAction("Dispo", "Agence", new { idv = idv});
        }

    } 
```

从我的角度来看，我想在不使用的情况下调用此操作`Html.beginForm`，我已经进行了此试验，但没有奏效：

```
<%: Html.Action("Accepter", "Adddispo", new { id = Model.idv, dd = Model.Dd, df = Model.Df  })%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T10:09:10.277

操作链接将始终发送“GET”请求。从控制器操作中删除 [HttpPost] 属性，或使用 shyju 建议的类似技术。操作链接在 Windows 事件方面存在一些问题，因此您应该坚持使用风格化按钮，除非特别需要锚点。示例样式将是：

```
#mybutton input[type=submit] {
    background: none;
    padding: 0px;
    font-family: arial;
    font-size: 1em;
    cursor: pointer;        // to make it look like link
    border: none;           //     --- " -----
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:36:07.193

您的 Action 方法是**HTTPOST**类型。因此，您需要一个表单发布才能调用该操作。如果你不想在你的视图中使用表单标签，你可以使用 jQuery 来做一个 POST。

下面的示例在用户单击带有 ID 的按钮时发布一个帖子`btnPost`。

**HTML（您的视图的内容）**

```
<html>
 <head>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
 </head>
 <body>
     Name : <input type="text" id="txtName" />  <br/>
     Age: <input type="text" id="txtAge" />  <br/>
     Place : <input type="text" id="txtPlace" />  <br/>
     <input type="button" value="Save" id="btnPost" /> 

     <script type="text/javascript">
      $(function(){

         $("#btnPost").click(function(e){
            e.preventDefault(); // preventing the default button submit behaviour

            var name=$("#txtName").val();  //reading the text box values
            var age=$("#txtAge").val(); 
            var place=$("#txtPlace").val(); 

            $.post("YourController/AddDispo", { idv :name, dd : age, df=place} ,function(data) { 
              //Do whatever with the the response. may be an alert
              alert(data);
            });    
         });

     });
    </script> 
```

**它能做什么**

**1)**在文档的开头部分，我们包含了对[jQuery 库](http://jquery.com/)的引用。我包括来自谷歌 CDN 的参考。您可以将其更改为包含您的本地副本。如果您使用的是 ASP.NET MVC，则默认项目模板在文件夹下有这个`Scripts`（版本号可能不同）。

**2)**在文档[就绪](http://api.jquery.com/ready/)事件 ( `$(function(){..`) 中，我们将一些功能绑定到具有 ID 的按钮`btnPost`。我们正在绑定`click`事件的功能。因此，每当用户单击该按钮时，就会执行该段代码。

**3）**我们正在读取文本框的值，并利用 jQuery 的[post](http://api.jquery.com/jQuery.post/)方法。它将我们传递的数据（我们在这里传递文本框的值）发布到 action 方法。一旦 action 方法返回一些东西给被调用者，它将被存储在 data 变量中。在检查该值之后，您可以做进一步的事情（向用户显示一些消息/重新加载一些内容）。

# php - vBulletin 机器人只在某些时候被调用

> ID：10791057
> 
> 赞同：0
> 
> 时间：2012-05-28T22:29:20.207
> 
> 标签：php, regex, plugins, bots, vbulletin

我一直在对我的 vBulletin 论坛进行大量修改，并且我对不同形式的 AI 和论坛上的机器人特别感兴趣。我最近创建了一个插件，如果它被调用，它将在一个线程中发布机器人。它有时有效，有时无效。我不明白为什么它如此不可靠。

它在钩子位置“newpost_complete”触发并具有以下代码：

```
if (stristr($postinfo['pagetext'],'.robot:')){
    preg_match('@^(?:.robot:)?([^:]+)@i',$postinfo['pagetext'], $matches);
    $host = $matches[1];
    require_once(DIR . '/includes/functions_robot.php');
    run($host,$threadinfo['threadid']);
} 
```

我不擅长正则表达式，所以我不确定 preg_match 是最优的。我发现如果您发布 .robot:hi: 它很少运行代码，但是如果您在其中引用带有 .robot:hi: 的帖子，即使实际引用的内容更改为其他内容，它也会运行而不会失败。

这是functions_robot.php文件中的相关代码：

```
function run($command,$threadid) {
    global $vbulletin;
    global $db;
    if ($command == 'hi') {
        $output = 'Hello.';
        //Queries
    }
} 
```

关于是什么导致它如此不可靠的任何想法？如果我能顺利运行的话，潜力很大。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T06:05:24.037

[我能够通过使用http://regex.larsolavtorvik.com/](http://regex.larsolavtorvik.com/)弄清楚

我切换到 postdata_presave 挂钩而不是 newpost_complete。

```
$pagetext =& $this->fetch_field('pagetext', 'post');
$threadid =& $this->fetch_field('threadid', 'post');
if (stristr($pagetext,'.robot:')){
    preg_match('/(\.robot:)(.*)(:)/iU',$pagetext, $matches);
    $host = $matches[2];
    require_once(DIR . '/includes/functions_robot.php');
    run($host,$threadid);
} 
```

新的钩子位置意味着它通常比我的实际柱子上的插入物更快地发射，使机器人柱子在我面前。我通过添加`usleep(500000);`到我的 run() 函数的开头来解决这个问题。

# ruby - 如何完成 readline 参数完成？

> ID：10791060
> 
> 赞同：0
> 
> 时间：2012-05-28T22:29:31.423
> 
> 标签：ruby

我有一个 Ruby 应用程序，它使用 readline 和命令完成。

在输入第一个字符串（命令）后，我希望能够完成它的参数。参数列表应基于所选命令。

有人有一个简单的例子吗？

这些是命令：

```
COMMANDS = [
  'collect', 'watch'
].sort

COLLECT = [
  'stuff', 'otherstuff'
].sort

comp = proc do |s| 
  COMMANDS.grep( /^#{Regexp.escape(s)}/ )        
end

Readline.completion_proc = comp 
```

每次按`TAB`时，都会执行 proc 块并`COMMANDS`匹配来自数组的命令。在其中一个命令完全匹配后，我想开始仅在`COLLECT`数组中搜索参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-20T21:18:42.813

因为每次我寻找这样的东西时你的问题都会首先出现，所以我想与其他人分享我的代码。

```
#!/usr/bin/env ruby
require 'readline'

module Shell
  PROMPT = "shell> "
  module InputCompletor
    CORE_WORDS = %w[ clear help show exit export]
    SHOW_ARGS = %w[ list user ]
    EXPORT_ARGS = %w[ file ]
    COMPLETION_PROC = proc { |input|
      case input
      when /^(show|export) (.*)/
        command = $1
        receiver = $2
        DISPATCH_TABLE[$1].call($2)
      when /^(h|s|c|e.*)/
        receiver = $1
        CORE_WORDS.grep(/^#{Regexp.quote(receiver)}/)
      when /^\s*$/
        puts
        CORE_WORDS.map{|d| print "#{d}\t"}
        puts
        print PROMPT
      end
    }
    def self.show(receiver)
      if SHOW_ARGS.grep(/^#{Regexp.quote(receiver)}/).length > 1
        SHOW_ARGS.grep(/^#{Regexp.quote(receiver)}/)
      elsif SHOW_ARGS.grep(/^#{Regexp.quote(receiver)}/).length == 1
        "show #{SHOW_ARGS.grep(/^#{Regexp.quote(receiver)}/).join}"
      end
    end
    def self.export(receiver)
      if EXPORT_ARGS.grep(/^#{Regexp.quote(receiver)}/).length > 1
        EXPORT_ARGS.grep(/^#{Regexp.quote(receiver)}/)
      elsif EXPORT_ARGS.grep(/^#{Regexp.quote(receiver)}/).length == 1
        "export #{EXPORT_ARGS.grep(/^#{Regexp.quote(receiver)}/).join}"
      end
    end
    DISPATCH_TABLE = {'show' => lambda {|x| show(x)} ,
                      'export' => lambda {|x| export(x)}}
  end
  class CLI
    Readline.completion_append_character = ' '
    Readline.completer_word_break_characters = "\x00"
    Readline.completion_proc = Shell::InputCompletor::COMPLETION_PROC
    def initialize
      while line = Readline.readline("#{PROMPT}",true)
        Readline::HISTORY.pop if /^\s*$/ =~ line
        begin
          if Readline::HISTORY[-2] == line
            Readline::HISTORY.pop
          end
        rescue IndexError
        end
        cmd = line.chomp
        case cmd
        when /^clear/
          system('clear')
        when /^help/
          puts 'no help here'
        when /show list/
          puts 'nothing to show'
        when /^show\s$/
          puts 'missing args'
        when /export file/
          puts 'nothing to export'
        when /^export\s$/
          puts 'missing args'
        when /^exit/
          exit
        end
      end
    end
  end
end
Shell::CLI.new 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T21:09:55.333

想了想，解决方法很简单：

```
comp = proc do |s| 
  if Readline.line_buffer =~ /^.* /
    COLLECT.grep( /^#{Regexp.escape(s)}/ ) 
  else
    COMMANDS.grep( /^#{Regexp.escape(s)}/ ) 
  end
end 
```

现在我只需要将它变成更灵活/可用的东西。

# perl - Bash/perl 从文件中打印行直到带有条件的字符

> ID：10791061
> 
> 赞同：2
> 
> 时间：2012-05-28T22:30:05.667
> 
> 标签：perl, bash, parsing

我正在尝试扫描文件以查找包含特定字符串的行，并将这些行打印到另一个文件。

但是，如果包含以“，”结尾的字符串的行忽略空格，我需要打印多行直到“）”字符。

目前我正在使用

```
for func in $fnnames
do
  sed/"$func"/p <$file >>$CODEBASEDIR/function_signature -n
done 
```

其中 $func 包含我要查找的字符串，但当然它不适用于限制。

有没有办法做到这一点？目前使用 bash，但 perl 也很好。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:12:53.443

```
perl -ne 'print if 1 .. /\).*,\s*$/' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:45:14.507

您的问题很棘手，因为您的限制不准确。你说 - 我认为 - 一个块应该是这样的：

```
foo,
bar,
baz) 
```

`foo`开始块的字符串在哪里，右括号结束它。但是，您也可以说：

```
foo bar baz) xxxxxxxxxxx, 
```

而且您只想打印到`)`，也就是说`foo bar baz)`，如果行以逗号结尾。

您**也**可以说只应继续以逗号结尾的行：

```
foo,   # print + is continued
bar    # print + is not continued
xxxxx  # ignored line
foo    # print + is not continued
foo,
bar,
baz)   # closing parens also end block 
```

由于我只能猜测您的意思是第一种选择，因此我给您两个选择：

```
use strict;
use warnings;

sub flip {
    while (<DATA>) {
        print if /^foo/ .. /\)\s*$/;
    }
}

sub ifchain {
    my ($foo, $print);
    while (<DATA>) {
        if (/^foo/) {
            $foo = 1;          # start block
            print;
        } elsif ($foo) {
            if (/,\s*$/) {
                print;
            } elsif (/\)\s*$/) {
                $foo = 0;      # end block
                print;
            }
            # for catching input errors:
            else { chomp; warn "Mismatched line '$_'" }
        }
    }
}

__DATA__
foo1,
bar, 
baz)
sadsdasdasdasd,
asda
adaffssd
foo2,   
two,    
three)
yada 
```

第一个将打印在以 开头的`foo`行和以 结尾的行之间找到的任何行`)`。它将忽略“以逗号结尾的行”限制。从积极的方面来说，它可以简化为单行：

```
perl -ne 'print if /^foo/ .. /\)\s*$/' file.txt 
```

第二个只是一个简单的 if 结构，它将同时考虑这两个限制，如果在块内发现一行与这两个限制都不匹配，则会发出警告（打印到 STDERR）。

# javascript - jquery 选择并排除多个 nth-childs

> ID：10791064
> 
> 赞同：1
> 
> 时间：2012-05-28T22:30:13.950
> 
> 标签：javascript, jquery, find, css-selectors

有没有一种方法可以一次选择多个 nth-childs，例如：

```
 $("#table").find("tr > :not(td:nth-child(1,3,5))"); 
```

这是行不通的

我想选择每行中的所有 td 但不是第 1、3、5 列（这可以是任何组合）。

有没有办法做到这一点？我无法分配类名。

谢谢你的帮助！

更新：

我想在表的所有行中搜索，但排除某些列。

我现在有这个代码：

```
 elem.keyup(function() {

    $(options.table).find("tr").hide();
    var data = this.value.split(" ");
    var jo = $(options.table).find("tr > :not(td:nth-child("+cols+"))");

    $.each(data, function(i, v){

    jo = jo.filter(":containsIgnoreCase('"+v+"')");

    });

    jo.parent().show();
    }); 
```

它在我传递单个值时起作用，但我想排除多个列。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:47:01.370

From your example, it looks like you're trying to exclude the odd numbers. Try:

```
$("#table").find("tr > :not(td:nth-child(odd))"); 
```

Although, it may be more efficient to just select the even ones.

```
$("#table").find("tr > td:nth-child(even)"); 
```

You can also use formulas in nth-child. [See this link for more detail.](http://css-tricks.com/how-nth-child-works/)

Okay, as per comments below/clarification on the question, here is another solution.

```
$("#table").find("tr > td").filter(function(index){
   return index == 1 || index == 2 || index == 5;   
}); 
```

# symfony - Twig / Symfony 2 中“默认”过滤器和布尔宏参数的错误？

> ID：10791068
> 
> 赞同：7
> 
> 时间：2012-05-28T22:30:35.957
> 
> 标签：symfony, twig

我正在使用Twig 过滤器在我的[宏](http://twig.sensiolabs.org/doc/tags/macro.html)[`default`](http://twig.sensiolabs.org/doc/filters/default.html)中指定参数默认值：

```
{% macro base(type, title, content, separator, dismissable) %}
{% spaceless %}

    {% debug dismissable %}

    {% set separator   = separator|default('!') %}
    {% set dismissable = dismissable|default(true) %}

    {% debug dismissable %}

    {# Beginning outputting... #}
{% endspaceless %}
{% endmacro %} 
```

**问题**是`dismissable`参数类型应该是`boolean`. 但是，当通过`false`过滤器时会对其进行评估并分配一个`true`默认值。示例**输出**：

```
{{ base('success', 'Title', 'Hello', '!', false) }}

boolean false
boolean true 
```

这是一个错误吗？这是（部分）过滤器描述：

> 如果值未定义或为空，则默认过滤器返回传递的默认值，否则返回变量的值。

`false`甚至没有提到布尔值的评估。我的**临时解决方法**是：

```
{% set dismissable = dismissable is not defined or dismissable is null ?
    true : dismissable %} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-29T07:27:15.623

这不是一个错误。您引用的文档提到了它，尽管它远非显而易见：

> 如果值未定义或为**空**

由我强调。False 是一个空值。

[Twig_Node_Expression_Default](https://github.com/fabpot/Twig/blob/master/lib/Twig/Node/Expression/Filter/Default.php)在代码中创建一个[Twig_Node_Expression_Conditional 。](https://github.com/fabpot/Twig/blob/master/lib/Twig/Node/Expression/Conditional.php)最后，默认过滤器归结为以下 php 代码：

```
$passed_value ? $passed_value : $default_value 
```

在您的情况下，传递的值为 false，因此表达式返回默认值。

您应该继续使用您的解决方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-06T07:11:45.327

您可以像这样使用[null-coalescing](http://twig.sensiolabs.org/doc/templates.html#other-operators)运算符`??`：

```
{% set dismissable = dismissable ?? true %} 
```

那应该可以解决您的问题，这是一个不错且干净的解决方案。:-)

编辑：它也解决了这个`default(false)`问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-12T13:47:25.143

可以替换有问题的表达式`my_boolean|default(true)`（`my_boolean|default(false)`按预期工作）`not my_boolean is defined or my_boolean`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-07T01:22:31.460

我遇到了同样的“问题”，我这样做了：

```
{% set dismissable = dismissable is not same as(false) %} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-16T13:10:39.903

这是@Maerlyn 已经提到的预期行为。
但是您可以利用`fallback`过滤器并简化您的代码。
这将起作用：
`{% set dismissable = dismissable|fallback(true) %}`

# r - 使用包 'rmongodb' 处理查询结果集

> ID：10791069
> 
> 赞同：3
> 
> 时间：2012-05-28T22:30:40.450
> 
> 标签：r, mongodb, rmongodb

[当使用rmongodb](http://cran.at.r-project.org/web/packages/rmongodb/index.html)包并且最终对象应该是 a 时，您将如何处理MongoDB 查询的结果集（**长度 > 1** ） ？`list`

我尝试避免在单`list`步执行结果集时简单地附加对象时发生的 R 典型的“按值传递”复制效率低下。但为了做到这一点，我想我需要知道查询总共返回了多少“记录”，不是吗？这样，我可以跨越一个空列表，并在单步执行结果集时将其填满——甚至更好，我可以使用`lapply()`等等。

这是一个小例子

## 示例内容

该示例取自[MongoDB 网站](http://www.mongodb.org/display/DOCS/Querying+and+nulls)并通过[rmongodb实现](http://cran.at.r-project.org/web/packages/rmongodb/index.html)

```
mongo <- mongo.create(db="test")
ns <- "test.foo"
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.append(buf, "x", 1)
mongo.bson.buffer.append(buf, "y", 1)
x.1 <- mongo.bson.from.buffer(buf)
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.append(buf, "x", 2)
mongo.bson.buffer.append(buf, "y", "string")
x.2 <- mongo.bson.from.buffer(buf)
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.append(buf, "x", 3)
mongo.bson.buffer.append(buf, "y", NULL)
x.3 <- mongo.bson.from.buffer(buf)
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.append(buf, "x", 4)
x.4 <- mongo.bson.from.buffer(buf)

mongo.insert.batch(mongo, ns, list(x.1, x.2, x.3, x.4)) 
```

## 询问

```
cursor <- mongo.find(mongo, ns, query=list(y=NULL))

# Alternatively
buf <- mongo.bson.buffer.create()
mongo.bson.buffer.append(buf, "y", NULL)
query <- mongo.bson.from.buffer(buf)
cursor <- mongo.find(mongo, ns, query) 
```

## 处理查询结果

这是我能想到的最好的：

```
out <- NULL
while (mongo.cursor.next(cursor)) {
    out <- c(out, list(mongo.bson.to.list(mongo.cursor.value(cursor))))
}
out 
```

然而，我正在寻找的是类似`as.list(cursor)`或类似的东西：

```
# Say I could find out the length of the result set:
cursor.length <- length(cursor
out <- lapply(cursor.length, function(x) {
    mongo.cursor.value(cursor[[x]])
)}

# Alternative:
out <- vector("list", cursor.length)
for (x in 1:cursor.length) {
    out[[x]] <- mongo.cursor.value(cursor[[x]])
)} 
```

这可能吗？不幸的是，我对我认为包使用的 C/C++ 指针并不十分熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:30:40.753

[我已经在http://cnub.org/rmongodb.ashx#FAQ](http://cnub.org/rmongodb.ashx#FAQ)上关于 rmongodb 的 FAQ 中回答了这个问题。 这显示了如何从查询中获取数组、列表和数据帧。

# algorithm - 在图中更改为非 MST 边以更改 MST

> ID：10791070
> 
> 赞同：1
> 
> 时间：2012-05-28T22:30:43.637
> 
> 标签：algorithm, graph, minimum-spanning-tree

设计一种算法，该算法采用加权图 G 并找到对非 MST 边的成本的最小变化，该变化会导致 G 的最小生成树发生变化。

**到目前为止我的解决方案（需要建议）**：

要更改 MST，我们需要更改非 MST 边 st 的权重，使其比 MST 中起始顶点和结束顶点路径中的最大边小 1。

所以我们可以从遍历 MST 的边开始，对于每个顶点，检查是否有非 MST 边。如果有，可以执行到达边缘端点（在 MST 中）的 bfs。非 MST 边缘权重必须更新为比路径中的最大边缘权重小一。

这将导致非 MST 边缘包含在 MST 中，并且之前的最大边缘从 MST 中删除。

有人可以判断这个解决方案是否正确？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T14:34:30.323

你找到了这个主意。但是，需要调整您的答案以表明您想要找到最小的变化，而不是您想要修改您在步行中遇到的每个非 MST 边缘。

如果这是一个学校问题，您还将被要求提供正确性证明。为了构建它，我建议依靠 Kruskal 的证明，并解释为什么您的更改会让 Kruskal 选择修改后的边缘而不是路径中的其他最大权重边缘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-04T10:25:37.567

我有个主意。所以基本上，我们可以遵循 Kruskal 算法的思想。所以如果我们想让MST发生变化，那么Krukal算法一定有一次没有选择原始MST中的边。该边必须是我们要修改其成本的边。所以算法很清楚。遵循克鲁斯卡尔算法，每次我们想选择一条新边e时，我们都按照克鲁斯卡尔算法不断搜索，找到另一条边e'，但仍然没有形成循环。然后我们计算成本的最小变化：w(e')-w(e)-1 。（我不确定成本是否限制为整数）。只需从上面选择最小的变化。

# php - AJAX：PHP 函数返回 1，但“成功”部分说它返回 0

> ID：10791071
> 
> 赞同：0
> 
> 时间：2012-05-28T22:30:58.130
> 
> 标签：php, javascript, ajax

我需要以下功能的帮助。该函数`mainApp.php`返回 1，但执行`Else`了部分`success IF`语句。我怀疑表达式的正确性`function(html,msg)`。如何解决这个问题呢？

**更新（工作代码）：**

```
function click_function_ps() {
    $.ajax({
        url: 'callpage.php?page=optim/mainApp.php',
        data: 'myParam='+$('#myParam').val(),
        dataType: 'json',
        success: function(output){
            if(output.msg === 1){
                $('#myContainer').html(output.html);
            } else {
                $dialog.dialog('open');
                return false;
            }
        }
    });
} 
```

**主应用程序.php**

```
 $html_code = '<table width="100%">
                <tr>
                    <td width="100%">
                        <div class="scrollbar" id="chart"><img class="displayed" src="ganttchart.php"></div>
                    </td>
                </tr>
            </table>';

            echo json_encode(array('msg' => 1, 'html' => $html_code)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:31:47.983

返回的响应在第一个参数中。第二个通常不有趣。

> ```
> success(data, textStatus, jqXHR) 
> ```
> 
> 请求成功时调用的函数。该函数获得三个参数： 从服务器返回的数据，根据 dataType 参数格式化；描述状态的字符串；和 jqXHR 对象。

我还建议您重命名`html`为更有意义的名称，例如`data`or`response`并添加`dataType: 'json'`到您的 ajax 参数中。然后让您的 PHP 脚本返回并在您的函数中`json_encode(array('msg' => 1, 'html' => $your_html_code))`使用`data.msg`和。`data.html`

# database - 嵌入式数据库与独立数据库

> ID：10791072
> 
> 赞同：2
> 
> 时间：2012-05-28T22:31:01.550
> 
> 标签：database, embedded-database

我在这里没有找到两者的比较。如果评论中已经存在该主题，请给我链接，我将关闭该主题。

我感兴趣的是性能比较。这两种类型之间是否有任何显着差异。我听说人们设法在嵌入式中存储数百万条记录而没有问题。以 H2 为例。在生活中，我从未遇到过嵌入式，直到看到 Spring 示例书籍并借助嵌入式数据库测试其他东西（更容易设置和开始模拟应用程序）。他们有多可靠？资源效率如何？上下文不是关于一个拥有十亿用户的系统，而是关于更现实的几十万用户？

你可以猜到我在哪里领先，嵌入 - 更容易设置，更容易使用 - 那为什么还要麻烦呢？我不是判断其他品质的 DBA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T11:21:28.553

找到了有趣的链接，但仍在等待其他意见。似乎 H2 比 MySQL 和 PostgreSQL 更快 - [http://www.h2database.com/html/performance.html](http://www.h2database.com/html/performance.html)，同时消耗的内存稍多，如果您查看下面的假设，这是不正确的。（虽然在单台电脑上测试过）

# windows - 尝试执行 OpenProcess 和 TerminateProcess 时访问被拒绝

> ID：10791076
> 
> 赞同：1
> 
> 时间：2012-05-28T22:31:15.447
> 
> 标签：windows, visual-c++

当我使用 Ctrl + F5 从 Visual C++ 2010 Express 编译和执行/调试我的代码时，它执行得很好。

当我尝试执行构建项目后形成的 exe 时，它​​会在调用`OpenProcess`and时产生拒绝访问错误`TerminateProcess`。

任何想法为什么会发生这种情况？

如何修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:04:50.247

一种可能性是它可能是由[UAC](http://msdn.microsoft.com/en-us/library/windows/desktop/aa511445.aspx)引起的。尝试从提升的命令提示符或资源管理器中使用上下文菜单中的“以管理员身份运行”选项启动您的应用程序。

# linux - linux命令`jobs`中`%1`的含义

> ID：10791082
> 
> 赞同：4
> 
> 时间：2012-05-28T22:31:54.540
> 
> 标签：linux

我看过以下脚本：

```
$ ./crazy-malloc &
[1] 2817
malloced 3056 MB
$ jobs -x pmap %1
2823: ./crazy-malloc
000cc000 4112K rw--- [ anon ]
004d0000 104K r-x-- /lib/ld-2.3.5.so
004ea000 4K r---- /lib/ld-2.3.5.so
004eb000 4K rw--- /lib/ld-2.3.5.so
004ee000 1168K r-x-- /lib/libc-2.3.5.so
00612000 8K r---- /lib/libc-2.3.5.so
00614000 8K rw--- /lib/libc-2.3.5.so
00616000 8K rw--- [ anon ]
006cf000 124388K rw--- [ anon ]
08048000 4K r-x-- /home/john/examples/mm/crazy-malloc
08049000 4K rw--- /home/john/examples/mm/crazy-malloc
08051000 2882516K rw--- [ anon ]
b7f56000 125424K rw--- [ anon ]
bfa43000 84K rw--- [ stack ]
bfa58000 5140K rw--- [ anon ]
ffffe000 4K ----- [ anon ]
total 3142980K 
```

Q1>线的用途是`jobs -x pmap %1`什么？这里说明了什么`%1`？

> jobs -x command [ args ... ] 如果提供了 -x 选项，jobs 会将在 command 或 args 中找到的任何 jobspec 替换为相应的进程组 ID，并执行传递 args 的命令，返回其退出状态。
> 
> pmap - 报告进程的内存映射

Q2> 前两列代表什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:38:29.390

1.  `%1`表示您刚刚启动和后台处理的进程（`./crazy-malloc`，pid 2817）。该命令`jobs -x pmap %1`扩展为`pmap 2817`。

2.  输出中的四列`pmap`分别代表进程映射的每个内存区域的基地址、大小、权限和映射文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T22:40:15.103

`%1`是您发布的段落所讨论的工作规范。基本上，如果你看到这样的线

```
[2] 2817 
```

在后台执行作业时，其作业规范将为`%2`.

# optimization - 这个 F# 函数是否是尾递归的，其中递归函数在函数内部被多次调用？

> ID：10791083
> 
> 赞同：1
> 
> 时间：2012-05-28T22:31:58.253
> 
> 标签：optimization, f#, tail-recursion, tail-call-optimization

关于尾递归函数有几个问题，例如[this](https://stackoverflow.com/questions/5809683/is-my-rec-function-tail-recursive)和[this](https://stackoverflow.com/questions/806712/how-do-i-know-if-a-function-is-tail-recursive-in-f)但找不到与以下类似的任何内容。

我的理解是尾调用优化函数应该在其最后一次调用中返回一个累积值，而不需要任何进一步的评估。例如，使用阶乘函数很容易理解，它被优化为循环[2](https://stackoverflow.com/questions/806712/how-do-i-know-if-a-function-is-tail-recursive-in-f)。但在其他情况下，例如在以下情况下，告诉您最后一次调用是什么并不总是很明显？其中有很多，因为函数在体内不止一次被递归调用。

Brian 提出了一种查找方法，但我不确定如何优化尾调用。我可以将`--tailcalls`标志传递给编译器以自动执行它，但它总是成功吗？

`f`并`g`返回相同的类型。

```
type T = T of int * T list

let rec myfunc f (T (x,xs)) =
    if (List.isEmpty xs) then f x
    else 
        List.fold g acc (List.map (fun xxs -> myfunc f xxs) xs) 
```

任何对尾调用优化上述代码的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:55:19.880

> 我的理解是尾调用优化函数应该在最后一次调用中返回一个累积值......

几乎。尾递归是递归调用都出现在尾部位置。尾部位置意味着调用者直接从其被调用者返回结果。

> 下面，最后一个电话是什么？

尾部位置有两个调用。首先，调用`f`. 二是调用`List.fold`。递归调用不在尾部位置，因为它的返回值不是由它的调用者直接返回的。

> ```
> if (List.isEmpty xs) then f x 
> ```

另外，使用模式匹配而不是`isEmpty`和朋友。

> 任何对尾调用优化上述代码的帮助将不胜感激。

在任何人能够帮助您编写尾递归版本之前，您必须发布工作代码或至少一个规范。一般来说，最简单的解决方案是使用连续传递样式或命令样式编写。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T00:00:43.217

正如乔恩已经说过的，您的函数不是尾递归的。基本问题是它需要*多次*递归调用自身（列表中的每个元素一次`xs`，这是在传递给的 lambda 函数中完成的`List.map`）。

如果您确实需要进行多次递归调用，则使用*延续传递样式*或即命令式堆栈可能是唯一的选择。延续背后的想法是，每个函数都将采用另一个函数（作为最后一个参数），当结果可用时应该执行该函数。

以下示例显示了普通版本（左侧）和基于延续（右侧）

```
let res = foo a b                          fooCont a b (fun res ->
printfn "Result: %d" res                     printfn "Result: %d" res) 
```

要以延续传递风格编写函数，您还需要使用基于延续的`fold`函数。您可以首先`map`通过将完成的操作`map`移入 lambda 函数来避免使用`fold`：

```
List.fold g acc (List.map (fun xxs -> myfunc f xxs) xs) 
```

变成：

```
List.fold (fun state xxs -> g state (myfunc f xxs)) acc xs 
```

然后您可以按如下方式重写代码（请注意，`f`您`g`的问题中没有显示的两者现在都是基于延续的函数，因此它们需要额外的参数，代表延续）：

```
// The additional parameter 'cont' is the continuation to be called 
// when the final result of myfunc is computed
let rec myfunc' f (T (x,xs)) cont = 
  if (List.isEmpty xs) then 
    // Call the 'f' function to process the last element and give it the
    // current continuation (it will be called when 'f' calculates the result)
    f x cont
  else  
    // Using the continuation-based version of fold - the lambda now takes current
    // element 'xxs', the accumulated state and a continuation to call
    // when it finishes calculating 
    List.foldCont (fun xxs state cont -> 
      // Call 'myfunc' recursively - note, this is tail-call position now!
      myfunc' f xxs (fun res -> 
        // In the continuation, we perform the aggregation using 'g'
        // and the result is reported to the continuation that resumes
        // folding the remaining elements of the list.
        g state res cont)) acc xs cont 
```

该`List.foldCont`函数是一个基于延续的版本，`fold`可以写成如下：

```
module List = 
  let rec foldCont f (state:'TState) (list:'T list) cont =
    match list with
    | [] -> cont state
    | x::xs -> foldCont f state xs (fun state ->
        f x state cont) 
```

由于您没有发布完整的工作示例，因此我无法真正测试代码，但我认为它应该可以工作。

# iphone - 导航视图内的 UIView 更改

> ID：10791085
> 
> 赞同：1
> 
> 时间：2012-05-28T22:32:18.563
> 
> 标签：iphone, ios, uiviewcontroller, uinavigationcontroller, uinavigationbar

我正在处理基本导航模板，该模板有一个包含导航栏等的主视图，最后在构建应用程序时在其中加载一个视图。

我想知道如何做到这一点，以便用户可以在此主视图中导航多个视图，而无需像在导航器应用程序中更改视图时通常那样向导航堆栈添加任何内容。

我计划转换这些视图的方式是使用滑动手势。

任何帮助将不胜感激，希望我已经很好地解释了我的问题，因为它很难解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:40:53.337

我会使用带有分页的 UIScrollView 来解决这个问题。

但如果这对你不起作用，试试这个：

```
- (void) swipedScreen:(id) sender {
    //I'll leave getNewView to you to implement based on how you want to get the new view
    UIView *newView = [self getNewView];
    self.view = newView;
}

- (void) setupSwipeGestureRecognizer {
    UISwipeGestureRecognizer *swipeGesture = [[[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipedScreen:)] autorelease];
    swipeGesture.direction = (UISwipeGestureRecognizerDirectionUp|UISwipeGestureRecognizerDirectionDown);
    [window addGestureRecognizer:swipeGesture];
}

- (void) viewDidLoad {
    [self setupSwipeGestureRecognizer];
} 
```

并且不要忘记在您认为合适的地方移除手势识别器。

# html - 如果我将它用于我的布局，我的网站是否可以与不支持 html5 的下游浏览器一起使用？

> ID：10791086
> 
> 赞同：3
> 
> 时间：2012-05-28T22:32:20.640
> 
> 标签：html, html4

我想布局一个带有 html5 语义标记的网站。我在想; 如果我使用 html5 并像使用 html4 一样设置部分的样式，它仍然可以正确呈现吗？我不想使用真正最新的 html5 东西，比如画布，我只想证明这个网站的未来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:38:14.547

浏览器将忽略任何 HTML5 特定标签（例如`<nav>`或）。`<header>`原始标签不会出现在页面上（您不会看到`<nav>`出现的单词等），但它们根本不会做任何事情。请注意，应用于它们的任何样式也将不起作用 - 我很难发现这一点。如果要设置导航栏的样式，请不要设置`<nav>`标签的样式；`<div>`在其中设置或类似标签的样式。

至于诸如`<video>`或类似的HTML5“实用程序”，您最好使用检测浏览器功能并使用适当代码的Javascript库。[例如， Jplayer](http://jplayer.org)允许您嵌入使用 HTML5（如果可用）和 Flash（如果不是）的视频和音频，同时仍使用相同的 HTML 界面。

如果您想要一个真正炫耀的功能，例如 Canvas 驱动的系统，那么最好不要将其用于您网站的主要区域，只需添加一个小注释，说“请升级到现代浏览器以正确查看此内容”如果您可以检测到它不起作用（可以通过使用`var check=document.createElement('canvas')`then 检查该值是否未定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:38:55.240

您绝对可以使用 shim 来做到这一点 - 这将允许您使用所有 HTML5 语义标签并将它们转换为旧浏览器。在这里查看 html5shim：[http ://code.google.com/p/html5shim/](http://code.google.com/p/html5shim/)

并将其包含在您的代码中，它们是如何显示的：

```
<!--[if lt IE 9]>
<script src="dist/html5shiv.js"></script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T23:12:49.997

您可以使用 HTML5 Boilerplate 来做到这一点。

它带有 Modernizr（包括 html5shiv），还有更多。

[html5boilerplate.com](http://html5boilerplate.com)

# java - Processbuilder 不重定向 StdOut

> ID：10791091
> 
> 赞同：4
> 
> 时间：2012-05-28T22:33:07.237
> 
> 标签：java, stdout, processbuilder

是否可以将输出流重定向回进程，或者根本不重定向它？

背景故事：我正在尝试使用 processbuilder 启动一个可执行文件。（确切地说是源专用服务器/srcds.exe）

由于使用 processbuilder 启动它，这个可执行文件的控制台窗口仍然是空的。启动几秒钟后，可执行文件崩溃并显示错误“CTextConsoleWin32::GetLine: !GetNumberOfConsoleInputEvents”，因为它的控制台是空的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:42:18.723

我认为您正在谈论使启动的进程'stdout 转到当前进程'stdout。如果您使用的是 JDK7，那很简单：

```
.redirectOutput(ProcessBuilder.Redirect.INHERIT) 
```

**更新：（**评论太多）我认为你很困惑。当您从终端启动进程时，该进程将成为该终端进程的子进程，并将标准输出发送到该终端。当您从 Java 启动进程时，该进程是 Java 进程的子进程，其标准输出将发送到 Java。

在第一种情况下，有一个显示标准输出的终端，因为您自己从终端启动了它，这就是终端对标准输出所做的事情。然而，当从 Java 启动时，不会有终端窗口，除非您启动的进程中的某些东西打开了一个终端，并且您启动的进程的标准输出被交还给程序员，您可以随意处理。从终端启动时看到的等效行为是`Redirect.INHERIT`我已经提到的。

你现在的问题不是Java。您的问题是不了解此“srcds.exe”如何处理标准输入和标准输出。弄清楚这一点，然后回来询问如何使用 Java 做到这一点。

我现在只是在猜测，但您可以尝试从进程的标准输出中读取并将其反馈回标准输入。也许这就是它所期待的？不过，这听起来很疯狂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:44:30.647

你可以得到这样的输出

```
ProcessBuilder pb = new ProcessBuilder(args);
Process p = pb.start(); 

//below code gets the output from the process
InputStream in = p.getInputStream();
BufferedInputStream buf = new BufferedInputStream(in);
InputStreamReader inread = new InputStreamReader(buf);
BufferedReader bufferedreader = new BufferedReader(inread);
String line;
while ((line = bufferedreader.readLine()) != null) {
    *do something / collect output*
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-10T16:23:00.723

我已经为此苦苦挣扎了一段时间，但我想你可以做的最简单的方法是自己传输流，使用某种 StreamTransfer 类，你可以说哪个在单独的线程中`InputStream`写入哪个`OutputStream`以避免死锁。在此示例中，我执行`ls`then`cat`并手动将`stdout`of`ls`连接到`stdin`of `cat`，然后`cat`'s `stdout`to`System.out`以打印最终结果：

```
public class TestRedirectingStreams {

    public static void main(String[] args) throws IOException, InterruptedException {
        ExecutorService threads = Executors.newFixedThreadPool(10); 
        Process echo = Runtime.getRuntime().exec("ls"),
                cat = Runtime.getRuntime().exec("cat");
        threads.submit(StreamTransfer.transfer(echo.getInputStream(), cat.getOutputStream()));
        threads.submit(StreamTransfer.transfer(cat.getInputStream(), System.out));
        threads.shutdown();
    }
}

class StreamTransfer implements Callable<Void> {
    public static final int BUFFER_SIZE = 1024;
    private InputStream in;
    private OutputStream out;

    public static StreamTransfer transfer(InputStream in, OutputStream out) {
        return new StreamTransfer(in, out);
    }

    private StreamTransfer(InputStream in, OutputStream out) {
        this.in = in;
        this.out = out;
    }

    @Override
    public Void call() throws Exception { // write to streams when thread executes
        byte[] buffer = new byte[BUFFER_SIZE];
        int read = 0;
        while ((read = in.read(buffer)) != -1) 
            out.write(buffer, 0, read);
        in.close();
        out.close();
        return null;
    }
} 
```

如果您想改用 ProcessBuilder，则示例保持不变，因为`ProcessBuilder.start()`返回进程，您仍然可以检索所需的流并相应地传输。

# android - Android 在返回活动时保存信息

> ID：10791095
> 
> 赞同：0
> 
> 时间：2012-05-28T22:33:15.563
> 
> 标签：android, android-activity, save, return

对android来说非常新，想知道如何让这个示例代码返回到它停止的地方，而不是在返回屏幕时重新加载图片。现在，当我退出屏幕并返回时，我必须重新开始。我已阅读并尝试理解 Android 文档，但无法完成这项工作或从哪里开始......谢谢大家！

```
 package com.windmillagency;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;

import org.apache.http.HttpEntity;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ProgressDialog;
import android.content.Context;
import android.content.SharedPreferences;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Gallery;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.Toast;

public class AndroidFlickrActivity extends BT_activity_base {

    public String thisActivityName = "Flickr";

    ProgressDialog progressDialog;
    BackgroundThread backgroundThread;

    public class FlickrImage {
        String Id;
        String Owner;
        String Secret;
        String Server;
        String Farm;
        String Title;

        Bitmap FlickrBitmap;

        FlickrImage(String _Id, String _Owner, String _Secret, 
                String _Server, String _Farm, String _Title){
            Id = _Id;
            Owner = _Owner;
            Secret = _Secret;
            Server = _Server;
            Farm = _Farm;
            Title = _Title;

            FlickrBitmap = preloadBitmap();
        }

        private Bitmap preloadBitmap(){
            Bitmap bm= null;

            String FlickrPhotoPath = 
                    "http://farm" + Farm + ".static.flickr.com/" 
                    + Server + "/" + Id + "_" + Secret + "_m.jpg";

            URL FlickrPhotoUrl = null;

            try {
                FlickrPhotoUrl = new URL(FlickrPhotoPath);

                HttpURLConnection httpConnection 
                    = (HttpURLConnection) FlickrPhotoUrl.openConnection();
                httpConnection.setDoInput(true);
                httpConnection.connect();
                InputStream inputStream = httpConnection.getInputStream();
                bm = BitmapFactory.decodeStream(inputStream);

            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return bm;
        }

        public Bitmap getBitmap(){
            return FlickrBitmap;
        }

    }

    class FlickrAdapter extends BaseAdapter{
        private Context context;
        private FlickrImage[] FlickrAdapterImage;;

        FlickrAdapter(Context c, FlickrImage[] fImage){
            context = c;
            FlickrAdapterImage = fImage;
        }

        public int getCount() {
            // TODO Auto-generated method stub
            return FlickrAdapterImage.length;
        }

        public Object getItem(int position) {
            // TODO Auto-generated method stub
            return FlickrAdapterImage[position];
        }

        public long getItemId(int position) {
            // TODO Auto-generated method stub
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub
            ImageView image;  
            if (convertView == null) {
                image = new ImageView(context);  
                image.setLayoutParams(new Gallery.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));  
                image.setScaleType(ImageView.ScaleType.FIT_CENTER);  
                image.setPadding(8, 8, 8, 8);   
            } else {  
                image = (ImageView) convertView;    
            }  

            image.setImageBitmap(FlickrAdapterImage[position].getBitmap());

            return image; 
        }

    }

    FlickrImage[] myFlickrImage;

    /*
     * FlickrQuery = FlickrQuery_url 
     * + FlickrQuery_per_page 
     * + FlickrQuery_nojsoncallback 
     * + FlickrQuery_format
     * + FlickrQuery_tag + q
     * + FlickrQuery_key + FlickrApiKey
     */

    String FlickrQuery_url = "http://api.flickr.com/services/rest/?method=flickr.people.getPublicPhotos&api_key=fdd73dc07613841fbe325b5103d673b7&user_id=65005067@N08&per_page=25&format=json";
    String FlickrQuery_per_page = "&per_page=10";
    String FlickrQuery_nojsoncallback = "&nojsoncallback=1";
    String FlickrQuery_format = "&format=json";
    String FlickrQuery_tag = "&tags=";
    String FlickrQuery_key = "&api_key=";

    //  Apply your Flickr API:
    //  www.flickr.com/services/apps/create/apply/?
    String FlickrApiKey = "fdd73dc07613841fbe325b5103d673b7";

    final String DEFAULT_SEARCH = "flickr";

    EditText searchText;
    Button searchButton;

    Gallery photoBar;

    Bitmap bmFlickr;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        this.activityName = "AndroidFlickrActivity";
        BT_debugger.showIt(activityName + ":onCreate"); 

        //reference to base layout..
            LinearLayout baseView = (LinearLayout)findViewById(R.id.baseView);

            //setup background colors...
            BT_viewUtilities.updateBackgroundColorsForScreen(this, this.screenData);

            //setup background images..
            if(backgroundImageWorkerThread == null){
                backgroundImageWorkerThread = new BackgroundImageWorkerThread();
                backgroundImageWorkerThread.start();
            }           

            //setup navigation bar...
            LinearLayout navBar = BT_viewUtilities.getNavBarForScreen(this, this.screenData);
            if(navBar != null){
                baseView.addView(navBar);
            }

            //inflate this screens layout file...
            LayoutInflater vi = (LayoutInflater)thisActivity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            View thisScreensView = vi.inflate(R.layout.flickr, null);

            //add the view to the base view...
            baseView.addView(thisScreensView);  

       searchText = (EditText)findViewById(R.id.searchtext);
        searchText.setText(DEFAULT_SEARCH);
        searchButton = (Button)findViewById(R.id.searchbutton);

        photoBar = (Gallery)findViewById(R.id.photobar);

        searchButton.setOnClickListener(searchButtonOnClickListener);
    }

///////////////////////////////////////////////////
//activity life-cycle overrides

//onResume
@Override
public void onResume() {
super.onResume();
//Log.i("ZZ", thisActivityName + ":onResume");
tToast("onResume");
}       

private void tToast(String s) {
    Context context = getApplicationContext();
    int duration = Toast.LENGTH_SHORT;
    Toast toast = Toast.makeText(context, s, duration);
    toast.show();
}

//onPause
@Override
public void onPause() {
//Log.i("ZZ", thisActivityName + ":onPause");
super.onPause();
tToast("onPause");
}

//activity life-cycle overrides
///////////////////////////////////////////////////

    private Button.OnClickListener searchButtonOnClickListener
       = new Button.OnClickListener(){

        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(AndroidFlickrActivity.this, 
                   "Progress", "Please Wait");

            backgroundThread = new BackgroundThread();
            backgroundThread.setRunning(true);
            backgroundThread.start();

           }};

    private String QueryFlickr(String q){

        String qResult = null;

        String qString = 
                FlickrQuery_url 
                + FlickrQuery_per_page 
                + FlickrQuery_nojsoncallback 
                + FlickrQuery_format 
                + FlickrQuery_tag + q  
                + FlickrQuery_key + FlickrApiKey;

        HttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(qString);

        try {
            HttpEntity httpEntity = httpClient.execute(httpGet).getEntity();

            if (httpEntity != null){
                InputStream inputStream = httpEntity.getContent();
                Reader in = new InputStreamReader(inputStream);
                BufferedReader bufferedreader = new BufferedReader(in);
                StringBuilder stringBuilder = new StringBuilder();

                String stringReadLine = null;

                while ((stringReadLine = bufferedreader.readLine()) != null) {
                    stringBuilder.append(stringReadLine + "\n");
                    }

                qResult = stringBuilder.toString();
                inputStream.close();
            }

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return qResult;
    }

    private FlickrImage[] ParseJSON(String json){

        FlickrImage[] flickrImage = null;

        bmFlickr = null;
        String flickrId;
        String flickrOwner;
        String flickrSecret;
        String flickrServer;
        String flickrFarm;
        String flickrTitle;

        try {
            JSONObject JsonObject = new JSONObject(json);
            JSONObject Json_photos = JsonObject.getJSONObject("photos");
            JSONArray JsonArray_photo = Json_photos.getJSONArray("photo");

            flickrImage = new FlickrImage[JsonArray_photo.length()];
            for (int i = 0; i < JsonArray_photo.length(); i++){
                JSONObject FlickrPhoto = JsonArray_photo.getJSONObject(i);
                flickrId = FlickrPhoto.getString("id");
                flickrOwner = FlickrPhoto.getString("owner");
                flickrSecret = FlickrPhoto.getString("secret");
                flickrServer = FlickrPhoto.getString("server");
                flickrFarm = FlickrPhoto.getString("farm");
                flickrTitle = FlickrPhoto.getString("title");
                flickrImage[i] = new FlickrImage(flickrId, flickrOwner, flickrSecret,
                        flickrServer, flickrFarm, flickrTitle);
            }

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return flickrImage;
    }

    public class BackgroundThread extends Thread{
        volatile boolean running = false;
        int cnt;

        void setRunning(boolean b){
            running = b;    
            cnt = 10;
        }

        @Override
        public void run() {
            // TODO Auto-generated method stub
            String searchQ = searchText.getText().toString();
            String searchResult = QueryFlickr(searchQ);

            myFlickrImage = ParseJSON(searchResult);

            handler.sendMessage(handler.obtainMessage());

        }
    }

    Handler handler = new Handler(){

        @Override
        public void handleMessage(Message msg) {
            // TODO Auto-generated method stub

            progressDialog.dismiss();
            photoBar.setAdapter(new FlickrAdapter(AndroidFlickrActivity.this, myFlickrImage));
            Toast.makeText(AndroidFlickrActivity.this, 
                    "Images Loaded", Toast.LENGTH_LONG).show();
        }

    };

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:15:20.543

编写您的活动，以便它知道其当前状态。

在您的`onPause()`方法中，以您喜欢的任何方式保存该状态。SharedPrefs，存储到数据库，到平面文件等。

在您的`onResume()`方法中，读取该状态并恢复它。

# c++ - 递归函数导致堆栈溢出

> ID：10791096
> 
> 赞同：1
> 
> 时间：2012-05-28T22:33:17.927
> 
> 标签：c++, recursion, stack-overflow

我有以下任务：

> **编写一个程序，要求输入一个数字和一个幂。编写一个递归函数，将数字发挥到极致。例如，如果数字为 2，幂为 4，则函数将返回 16。**

我写了一个程序，编译时没有错误，但是当我启动程序并输入一个值时，会出现“堆栈溢出”错误。我想我的递归函数变得无限，但我不知道如何以其他方式编写它。

这是我的代码：

```
#include <iostream>
using namespace std;
int powpow(int number);

int main(){
    cout<<"Enter number:";
    int x;
    cin>>x;
    cout<<"The result of ("<<x<<" * "<<x<<") * "<<x*x<<" is: "<<powpow(x);
    system("pause");
    return 0;
}
int powpow(int number){
    int result = number*number;
    return powpow(result);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T22:34:37.333

您的递归没有终止条件，因此它永远运行。

听起来你可能没有很好地掌握递归，所以我想从更简单的东西开始，[斐波那契数](http://en.wikipedia.org/wiki/Fibonacci_number)列。

每当我们根据递归定义一个函数时，我们首先需要定义一个基本情况。在斐波那契的情况下，我们有 2 个基本情况：

```
F(0) = 0
F(1) = 1 
```

也就是说，用英语来说，“F of 0 is 0, F of 1 is 1”。或者更简单地说，如果我们将 0 传递给函数 F，我们将返回 0。如果我们通过 1，我们将返回 1。

一旦我们定义了基本案例，那么我们需要寻找递归关系。在斐波那契的情况下，我们有以下递归：

F(n) = F(n-1) + F(n-2)

所以对于`n >= 2`，我们可以使用上面的递归。为什么？好吧，让我们试试 n = 2。

```
F(2) = F(n-1) + F(n-2)
     = F(1) + F(0)
     = 1    + 0
     = 1 
```

所以现在我们知道 F(2) 的答案是 1。此外，我们现在可以计算 F(3) 的答案。为什么？那么，我们需要什么来计算 F(3)？我们需要 F(2) 和 F(1)。我们现在有了这两个答案，因为 F(1) 是一个基本情况，我们刚刚解决了上面的 F(2)。

所以，现在让我们试着写一段伪代码来解决 F。

```
function F(int n) {
  // handle base cases
  if (n equals 0)
    return 0
  if (n equals 1)
    return 1

  // recurrence
  return F(n-1) + F(n-2);
} 
```

请注意，在递归函数中，我们总是在函数的开头处理基本情况。如果我们没有基本案例，我们就无法定义这种重复，否则，我们的重复将没有终止条件。所以这就是为什么你总是把基本情况放在函数的**开头**。

现在，根据上面的解释，另一个很好的练习是为[阶乘函数编写一个递归函数](http://en.wikipedia.org/wiki/Factorial)。因此，请按照以下步骤操作：

```
1\. Define the base case (use wikipedia article for hints).
2\. Define recurrence in terms of base case
3\. Write pseudo code to solve the recurrence, and be sure to put base case(s) at beginning of function, and recurrence at end. 
```

一旦你掌握了这些步骤，那么继续进行功率循环对你来说应该更有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T22:36:05.023

你的功能

*   不应该做什么
*   没有终止条件

试着想一想：当你的函数`x^y`只接受一个数字作为参数时，它怎么能返回。然后，考虑如何将数字提高到幂，并且实施应该是显而易见的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T22:39:05.160

递归例程总是需要一个“平凡”或“基本”的案例。想想你写了什么，为 x 传入 1，什么会停止递归？

```
powpow(1)
  result = 1*1
  call powpow(1)
    result = 1*1
    call powpow(1)
      result = 1*1
      call powpow(1) 
```

*adinfinitum （或直到你执行堆栈）*

# php - PHP：基于主题标签创建变量

> ID：10791106
> 
> 赞同：0
> 
> 时间：2012-05-28T22:34:54.433
> 
> 标签：php, html, ajax

我正在使用[本教程](http://tutorialzine.com/2009/09/simple-ajax-website-jquery/)创建一个 ajax 站点并且正在努力使用 PHP。这是提供的代码：

**PHP**

```
if(!$_POST['page']) die("0");

$page = (int)$_POST['page'];

if(file_exists('pages/page_'.$page.'.html'))
echo file_get_contents('pages/page_'.$page.'.html');

else echo 'There is no such page!'; 
```

我想使用 等以外的命名结构`page_1.html`。`page_2.html`我的 HTML 如下所示：

**HTML**

```
<ul id="navigation">
    <li><a href="#home">Home</a></li>
    <li><a href="#about">About</a></li>
    <li><a href="#services">Services</a></li>
    <li><a href="#page4">Page 4</a></li>
</ul> 
```

现在唯一有效的链接是“第 4 页”。我将如何重写 PHP 以便前三个链接可以工作？

**Javascript**

```
var default_content="";

$(document).ready(function(){

    checkURL();
    $('ul li a').click(function (e){

            checkURL(this.hash);

    });

    //filling in the default content
    default_content = $('#pageContent').html();

    setInterval("checkURL()",250);

});

var lasturl="";

function checkURL(hash)
{
    if(!hash) hash=window.location.hash;

    if(hash != lasturl)
    {
        lasturl=hash;

        // FIX - if we've used the history buttons to return to the homepage,
        // fill the pageContent with the default_content

        if(hash=="")
        $('#pageContent').html(default_content);

        else
        loadPage(hash);
    }
}

function loadPage(url)
{
    url=url.replace('#page','');

    $('#loading').css('visibility','visible');

    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+url,
        dataType: "html",
        success: function(msg){

            if(parseInt(msg)!=0)
            {
                $('#pageContent').html(msg);
                $('#loading').css('visibility','hidden');
            }
        }

    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:43:54.360

只有`page4`作品，因为它期望脚本被命名为`page_number.html`. 您`home, about, services`与该模式不匹配。为了使它们也能正常工作，您需要将`file_get_contents()`调用更改为 allow `page/anything.html`。

首先要修改的是发布的功能：

```
function loadPage(url)
{
    // Instead of stripping off #page, only 
    // strip off the # to use the rest of the URL
    url=url.replace('#','');

    $('#loading').css('visibility','visible');

    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+url,
        dataType: "html",
        success: function(msg){

            if(parseInt(msg)!=0)
            {
                $('#pageContent').html(msg);
                $('#loading').css('visibility','hidden');
            }
        }

    });
} 
```

现在，这在 PHP 中引入了安全风险。您需要验证 的值`$_POST['page']`是严格的字母数字，以便没有人可以注入文件名`../../../../somefile`来读取您的文件系统。使用下面的表达式将允许您使用任何字母和数字字符来命名文件，但会拒绝点和空字节，这是[文件路径注入/目录遍历攻击](https://www.owasp.org/index.php/Relative_Path_Traversal)中的主要危险。

```
if(empty($_POST['page'])) die("0");
// Remove the typecast so you can use the whole string
//$page = (int)$_POST['page'];
// Just use the post val.  This is safe because we'll validate it with preg_match() before use...
$page = $_POST['page'];

// And validate it as alphanumeric before reading the filesystem
if (preg_match('/^[a-z0-9]+$/i', $_POST['page']) && file_exists('pages/'.$page.'.html')) {
  // Remove the page_ to use the whole thing
  echo file_get_contents('pages/'.$page.'.html');
}
else echo 'There is no such page!'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:44:54.530

你需要改变的不仅仅是这个才能让它工作。

1.  更改 JS，使其不会从 URL 中删除除井号之外的任何内容：

    ```
    url=url.replace('#page',''); 
    ```

    需要是：

    ```
    url=url.replace('#',''); 
    ```

2.  更改 PHP 以处理字符串：

    ```
    if(!$_POST['page']) die("0");

    // Only allow alphanumeric characters and an underscore in page names
    $page = preg_replace( "/[^\w]/", '', $_POST['page']);

    if(file_exists('pages/'.$page.'.html'))
        echo file_get_contents('pages/'.$page.'.html');
    else echo 'There is no such page!'; 
    ```

3.  现在在`pages/`目录中创建页面。

    *   `<li><a href="#home">Home</a></li>`将会`home.html`
    *   `<li><a href="#about">About</a></li>`将会`about.html`
    *   `<li><a href="#services">Services</a></li>`将会`services.html`
    *   `<li><a href="#page4">Page 4</a></li>`将会`page4.html`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:39:57.067

将 PHP 更改为：

```
$page = $_POST['page'];
if(file_exists('pages/'.$page.'.html'))
echo file_get_contents('pages/'.$page.'.html'); 
```

现在您正在使用整个哈希标记，因此#about 将导致：pages/about.html

在你的 javascript 函数 loadPage 中更改它

```
url=url.replace('#page',''); 
```

变成

```
url=url.replace('#',''); 
```

# jsp - request.getHeader("referer")，比后退按钮重新加载页面

> ID：10791109
> 
> 赞同：0
> 
> 时间：2012-05-28T22:35:04.553
> 
> 标签：jsp, servlets, back, http-referer

JSP1 链接到 JSP2。

JSP2 调用一个 servlet，它做一些事情并以：

```
response.sendRedirect(request.getHeader("referer"));
return; 
```

在这一点上，我回到了 JSP2。问题是从那里按下浏览器后退按钮，页面只是重新加载自身而不是返回到 JSP1。这是正确的，因为 sendRedirect 在历史记录中添加了一个条目。

但我想回到 JSP1。有小费吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T02:13:57.407

出于各种敏感原因，您根本不应该在控制器操作中依赖引荐来源标头。你至少已经发现了一个。此标头并不总是由客户端发送，或者它的值可能实际上并不代表真正的引荐来源网址。某些浏览器、代理甚至防病毒配置可能会隐藏、更改甚至混淆引荐来源标头。最高使用它用于统计目的。

而是将其`from`作为请求参数传递，

```
<input type="hidden" name="from" value="${pageContext.request.requestURI}" /> 
```

使用此逻辑（省略验证）

```
response.sendRedirect(request.getParameter("from")); 
```

或者，更好的是，如果它始终是基于其他请求参数的同一个 JSP，则只需在服务器端完全硬编码/配置它。

# google-app-engine - 如何处理属于模型对象状态的对象，但不需要单独的数据库级支持？

> ID：10791117
> 
> 赞同：0
> 
> 时间：2012-05-28T22:36:28.470
> 
> 标签：google-app-engine

在我的 Google App Engine 应用程序中，我有需要存储的模型对象。这些对象由各种策略对象参数化。例如，我的 Event 类有一个 Privacy Policy 对象，该对象决定谁可以查看、更新等。PrivacyPolicy 有各种不同的子类。事件在各个点咨询其 PrivacyPolicy 对象。

```
class PrivacyPolicy(db.Model):
    def can_see(self, event, user):
        pass

class OwnerOnlyPolicy(PrivacyPolicy):
    def can_see(self, event, user):
        return user == event.owner

class GroupOnlyPolicy(PrivacyPolicy):
    def can_see(self, event, user):
        for grp in event.owner.groups()
            if grp.is_member(user):
                return True
        return False

class OnlyCertainUsersPolicy(PrivacyPolicy):
    def __init__(self, others):
        self.others = others

    def can_see(self, event, user):
        return user in others 
```

我可以让我的 Event 类使用 PrivacyPolicy 的 ReferenceProperty：

```
class Event(db.Model):
    privacy: db.ReferenceProperty(PrivacyPolicy)
    #… 
```

我不喜欢这样的原因是一对一的关系意味着没有人每次都查询策略对象，不需要维护从策略到其事件对象的反向引用，并且没有其他方式PrivacyPolicy 是一个独立的数据库级对象。它在功能上等同于 IntegerProperty，因为它是 Event 对象状态的一部分，它只是一个对象而不是数字——特别是它是一个可以有零状态或很多状态的对象，对于 Event 类型是未知的。

我找不到任何人谈论如何处理这种情况。有没有我不知道的工具/方法？我只是把它吸起来并使用参考属性和开销吗？

如果处理此问题的唯一其他方法是自定义属性类型，那么任何有关如何处理它的建议都将受到欢迎。我的第一个想法是使用 TextProperty 来存储策略对象 ( `policy`) 的字符串 rep，在需要时对其进行解码，缓存结果，并对策略对象进行任何更改使缓存无效并更新字符串 rep。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:56:49.737

尝试将其存储在数据存储中会使您过于复杂。这属于代码而不是数据存储。

最简单的方法是：

```
class Event(db.Model):
    privacy = db.IntegerProperty()

    def can_see(self, user):
        if self.privacy == PRIVACY_OWNER_ONLY:
            return user == event.owner
        else if self.privacy == PRIVACY_GROUP:
            for grp in self.owner.groups()
                if grp.is_member(user):
                    return True
            return False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:13:17.480

有时只需要考虑正确的方法。解决方案是引入一种使用 pickle 来存储和检索值的新属性，例如[https://groups.google.com/forum/?fromgroups#!topic/google-appengine/bwMD0ZfRnJg中描述的属性](https://groups.google.com/forum/?fromgroups#!topic/google-appengine/bwMD0ZfRnJg)

我想要一些更复杂的东西，因为泡菜并不总是答案，而且无论如何文档都很好，所以这是我的 ObjectReference 类型：

```
import pickle
from google.appengine.ext import db

class ObjectProperty(db.Property):
    def __init__(self, object_type=None, verbose_name=None, to_store=pickle.dumps, from_store=pickle.loads, **kwds):
        """Initializes this Property with all the given options

        All args are passed to the superclass. The ones used specifically by this class are described here. For
        all other args, see base class method documentation for details.

        Args:
          object_type: If not None, all values assigned to the property must be either instances of this type or None
          to_store: A function to use to convert a property value to a storable str representation. The default is
            to use pickle.dumps()
          from_store: A function to use to convert a storable str representation to a property value. The default is
            to use pickle.loads()
        """
        if object_type and not isinstance(object_type, type):
            raise TypeError('object_type should be a type object')

        kwds['indexed'] = False         # It never makes sense to index pickled data
        super(ObjectProperty, self).__init__(verbose_name, **kwds)

        self.to_store = to_store
        self.from_store = from_store
        self.object_type = object_type

    def get_value_for_datastore(self, model_instance):
        """Get value from property to send to datastore.

        We retrieve the value of the attribute and return the result of invoking the to_store function on it

        See base class method documentation for details.
        """
        value = getattr(model_instance, self.name, None)
        return self.to_store(value)

    def make_value_from_datastore(self, rep):
        """Get value from datastore to assign to the property.

        We take the value passed, convert it to str() and return the result of invoking the from_store function
        on it. The Property class assigns this returned value to the property.

        See base class method documentation for details.
        """
        # It passes us a unicode, even though I returned a str, so this is required
        rep = str(rep)
        return self.from_store(rep)

    def validate(self, value):
        """Validate reference.

        Returns:
          A valid value.

        Raises:
          BadValueError for the following reasons:
            - Object not of correct type.
        """
        value = super(ObjectProperty, self).validate(value)

        if value is not None and not isinstance(value, self.object_type):
            raise db.KindError('Property %s must be of type %s' % (self.name, self.object_type))

        return value 
```

# inheritance - Play 框架 - 继承

> ID：10791119
> 
> 赞同：-1
> 
> 时间：2012-05-28T22:36:33.553
> 
> 标签：inheritance, playframework

我的模型 - 问题和答案，扩展了一个类 Post。Post 有一个字段 - 字符串内容。

让问题成为类问题的一个实例。我的 HTML 包含 question.content，但引发异常，说找不到该字段。为什么问题没有继承的“内容”字段？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T06:25:06.700

您需要使用`@MappedSuperclass`.

如果您查看我假设您的实体继承自的“play.db.jpa.Model”的源代码，您将看到使用了这个特殊的注释。这会将此类的内容带入您的持久实体中。

# android - 如何仅更改按下的 textView 的颜色？

> ID：10791122
> 
> 赞同：0
> 
> 时间：2012-05-28T22:36:45.007
> 
> 标签：android, listview, colors, textview, selector

我正在使用此代码表在不同事件中定义 textView 的颜色。textView 在 listView 中（10+ 项），效果（颜色）适用于每个 listItem 中的每个 textView。如何更改仅按下的 textView 的颜色？

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
  <item
    android:state_focused="true"
    android:state_pressed="true"
    android:color="@color/text_white" />
  <item
    android:state_focused="false"
    android:state_pressed="true"
    android:color="@color/text_white" />
  <item
    android:state_focused="true"
    android:color="@color/text_white" />
  <item
    android:state_selected="true"
    android:color="@color/text_white" />
  <item
    android:state_checked="true"
    android:color="@color/text_white" />
  <item
    android:state_selected="false"
    android:state_checked="false"
    android:state_focused="false"
    android:state_pressed="false"
    android:color="@color/text_blue" />
</selector> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T05:20:52.520

尝试这个

```
 <?xml version="1.0" encoding="utf-8"?>
    <selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_focused="true" //<<<<<Here focus us true then txt_pressed
          android:state_pressed="false" 
          android:drawable="@drawable/txt_pressed" />
    <item android:state_focused="true" 
          android:state_pressed="true"
          android:drawable="@drawable/txt_pressed" />
    <item android:state_focused="false" 
          android:state_pressed="true"
      android:drawable="@drawable/txt_pressed" />
    <item android:drawable="@drawable/txt_default" />
</selector> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T05:12:41.660

在xml文件中，要更改颜色的textview，添加

```
 android:background="@drawable/filename" 
```

# html - 显示的神秘负边距：inline-block 元素

> ID：10791125
> 
> 赞同：9
> 
> 时间：2012-05-28T22:36:57.257
> 
> 标签：html, css

我真的很困惑为什么会这样。[http://syndex.me](http://syndex.me)上的帖子有 2px 的边距。当页面最初加载时，这是遵守的。当第二批帖子加载时（14 个帖子开始加载），您会看到出于某种奇怪的原因，右侧的帖子实际上比应有的短 2px。

更奇怪的是，检查帖子显示它们实际上设置了一个`margin:2px` 更奇怪的是，这只发生在左边或右边距，而不是顶部和底部（？！）

做了很长一段时间的前端，我很有信心这是一个奇怪的案例。

我在 firefox、safari 和 chrome 上遇到了这个渲染问题。

如果我使用检查器翻转帖子，我可以看到每个帖子确实有 2px 边距，只是第二个帖子的边距（右侧）开始时好像旁边的帖子的边距为零，但是它确实也有一个。

好像帖子忽略了他们的邻居左右边距？

一件事，帖子正在使用`display:inline-block`. 我不明白的是：为什么这种行为只在延迟加载后才会出现？而且我知道内联元素有 2 到 4 px 的自然空间，但这*忽略*了2px，看起来很奇怪。

我不知道从哪里开始寻找这个，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T16:01:10.233

首次加载页面时，HTML 中每个`<div class="post">`. 每个空白块都被渲染为一个空格字符（通常为 4px 宽）。`<div class="post_margin_adjustment">`用它来抵消这一点`margin-right: -4px`，所以初始帖子之间的差距是 8px：

```
  4px（从左帖到右边距）  
+ 4px（空格字符）  
- 4px（从左 post_margin_adjustment 开始的负边距）  
+ 4px（从右帖到左边距）  
= 8像素

```

当 Infinite Scroll 插件加载下一页时，它会抓取新`div.post`元素并将它们插入到页面中，**没有**空格。所以新帖子之间的差距是4px：

```
  4px（从左帖到右边距）  
- 4px（从左 post_margin_adjustment 开始的负边距）  
+ 4px（从右帖到左边距）  
= 4像素

```

这就是为什么新职位之间的差距比初始职位之间的差距更窄的原因。

* * *

为了解决这个问题，我会：

1.  删除初始帖子之间的空格：

    ```
    $('div.post').detach().appendTo('#posts'); 
    ```

    在页面准备/加载上，它模拟了无限滚动插件正在做的事情。

2.  `margin-right: -4px;`从中删除`.post_margin_adjustment`。

初始帖子和新帖子之间的差距现在都应该是 8px 宽。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-04T20:25:57.987

***[首先，此 SO Answer 是对Zuul](https://stackoverflow.com/a/10825638/1195891)在此页面上提供的 SO Answer 的补充。我无法编辑他的答案，或者同行评审过程无论出于何种原因都不起作用。***

已为 SO 问题提供了可靠和/或官方来源。

参考：“*根据检查员的计算风格不可能是在说一件事，但在视觉上它在做另一件事吗？* ”

在这种情况下， **Firefox**内置了一个**[用于 CSS 的 3D 查看器](https://developer.mozilla.org/en/Tools/Page_Inspector/3D_view)**。它显示图像已正确加载但`margin-right`正在产生问题的揭示信息。让我通过为您的金头盔照片拍摄的图像来说明这一点。

**第一个图像通过虚线**显示了在它自己的容器中**加载的图像**。但是请注意，图像本身延伸到右侧的虚线之外： **![边距错误.jpg](../Images/fc07dfa93da5c2c85eb90800a7904d75.png)**

 ****第二张图片是使用Firefox 3D 查看器** 的特写。**在这里，您可以通过显示的蓝色底部**看到原始容器正确放置在页面上。这表明该`onload`过程尊重了与右侧图像的正确 CSS 距离。虽然右上角的文字很模糊，但有一个勾选**标记**`margin-right`in use of `-4px`： ![cssRespectedOnload.jpg](../Images/4509cde85d208431307c97cc00f7dcdb.png)

这张最终照片带有已`margin-right`删除的复选标记。请注意，照片现在正确显示： ![removeMarginOffset.jpg](../Images/05373fccd8e0f54ff49f582ed12d3890.png)

**[使用3D Viewer for CSS](https://developer.mozilla.org/en/Tools/Page_Inspector/3D_view)** 时，可以使用 Firefox 复制上述内容。

**新：**您可以右键单击每个图像并选择`view image`查看更大的版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T23:21:08.143

如果我的问题正确，通过使用 Firebug 分析带有 FF12.0 的页面，我看到：

```
.post_margin_adjustment {
    margin-right: -4px;
} 
```

那就是将左侧的帖子拉到右侧，从而导致布局不尊重您的：

```
.index .post {                                         /* syndex.me (line 469) */
  margin: 4px;
} 
```

删除负边距似乎可以解决问题。

* * *

**笔记：**

你在说`margin:2px`，但我在当前的 css 上看到的是`margin:4px;`，所以，帖子之间的总数是`8px`如果修复了否定的问题`margin`。

刚刚使用了“web developer 1.1.9”中的“标尺”，`8px`当否定`margin`被禁用时它会给我！

* * *

**最后一件事**也弄乱了保证金声明是：

```
.index .post {                                          /* syndex.css (line 1) */
  line-height: 0;
} 
```

该声明导致图像被拉起，从而减少了顶部/底部帖子之间的空间。

禁用此选项可修复顶部/底部间距，允许通过`margin:4px`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-04T01:12:16.680

您的 AJAX 检索内容缺少样式表似乎依赖的空格。证明：预加载一些动态帖子，检查页面，将 body 元素*编辑为 HTML 。*您会看到[静态帖子之间有足够的空白](https://i.stack.imgur.com/gQfan.png)（可能过多），而[动态帖子则粘在一起](https://i.stack.imgur.com/HbYcI.png)。

解决方案一：在附加动态帖子的脚本中添加一些空格。

解决方案二：避免依赖 css 中的空格，并使用[替代方法](https://stackoverflow.com/a/5078297/1081234)从 inline-block 元素中删除空格。

IMO 最好使用#2 的总体方向。**

# php - 如何仅从 DOM 中抓取最大的图像？

> ID：10791126
> 
> 赞同：-2
> 
> 时间：2012-05-28T22:36:57.377
> 
> 标签：php, parsing, screen-scraping, simple-html-dom, getimagesize

我正在使用[SimpleHTMLDOM](http://simplehtmldom.sourceforge.net/manual.htm)来抓取页面（在我以外的服务器中）。

基本实现是

```
try {
    $html = file_get_html(urldecode(trim($url)));
} catch (Exception $e) {
    echo $url;
}

foreach ($html->find('img') as $element) {
  $src = "";
  $src = $element->src;
    if (preg_match("/\.(?:jpe?g|png)$/i", $src)) {
        $images[] = $src;
    }
} 
```

这很好用，但它会返回页面中的所有图像，包括小头像、图标和按钮图像。我当然想避免这些。

然后我尝试在循环中插入如下

```
...

if (preg_match("/\.(?:jpe?g|png)$/i", $src)) {
    $size = getimagesize($src);
    if ($size[0] > 200) {
        $images[] = $src;
    }
}
... 
```

这在像`http://cnn.com`. 但在其他情况下，它会返回许多错误。例如

[http://www.huffingtonpost.com/2012/05/27/alan-simpson-republicans_n_1549604.html](http://www.huffingtonpost.com/2012/05/27/alan-simpson-republicans_n_1549604.html)

给出了一堆错误，比如

```
<p>Severity: Warning</p>
<p>Message:  getimagesize(/images/snn-logo-comments.png): failed to open stream: No such file or directory
<p>Severity: Warning</p>
<p>Message:  getimagesize(/images/close-gray.png): failed to open stream: No such file or directory 
```

这似乎是由于某些图像中的相对 URL 而发生的。这里的问题是这会使脚本崩溃，然后没有加载任何图像，而我的 Ajax 框将永远加载。

你有任何想法如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:41:49.853

问题是图像 URL 是相对于站点根目录的，因此您的服务器无法理解它们来获取它们并找出它们的大小。您可以参考[这个问题](https://stackoverflow.com/questions/1243418/php-how-to-resolve-a-relative-url)来弄清楚如何从相对 URL 中获取绝对 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:21:38.460

假设网址为[http://somedomain.com](http://somedomain.com) ，请尝试类似的操作...

```
$domain = explode('/', $url);
$domain = $domain[2];

// ... snip ...

if (preg_match("/\.(?:jpe?g|png)$/i", $src)) {
    $size = getimagesize($src);
    if ($size[0] > 200) {
        if(strpos($src, '/', 0) === 0)
            $src = $domain . $src;

        $images[] = $src;
    }
} 
```

这会对一些人有所帮助，但它不会是万无一失的——我想不出有很多域使用 ../../etc 图像的相对路径，但我确信有人是——当然，你可以测试匹配图像的 src 属性中的域以外的任何内容，并尝试将域扔在那里，但也没有每次都有效的承诺。我认为有更好的方法......也许有一个默认方法，并为麻烦的域加载带有预定义域“修复”的配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:44:00.273

您尝试使用图像大小检查的方法是正确的。

但是，为了让它在所有站点上工作，您需要添加某种相对 URL 解析。

我不知道是否有任何库或类似的库，但这里有一个关于如何做到这一点的快速概述：

*   找到您正在抓取的 URL 的域部分
*   假设任何以 / 开头的 URL 都是绝对 URL。您可以简单地通过连接域和路径来获取这些
*   假设任何不以 / 开头的 URL 都是相对的。您可能需要解析 URL 中的任何 .. 标记以定位预期路径
*   检查文档中的标签`<base>`：如果文档有`<base>`标签，它将所有相对路径锚定到标签中定义的路径中。

您也许可以找到一个库来将相对路径和绝对路径转换为您可以使用的东西，但在大多数情况下，它们不会考虑`<base>`最后一点提到的标签。

# php - 用户提交代码的服务器端执行

> ID：10791140
> 
> 赞同：3
> 
> 时间：2012-05-28T22:38:46.467
> 
> 标签：php, security, eval, dsl

这是我的情况。我正在构建一个应用程序，其中包含一些繁重的数学计算，其中公式需要由具有足够特权但不受信任的用户编辑。

我需要一种安全的服务器端脚本语言。我需要能够访问 4 个以上数据库表中的常量和值、先前计算的结果、定义用户变量和函数、使用 if/then/else 语句，而且我确信还有更多我想不到的东西现在。

我考虑过的一些选项：

1.  我考虑过使用类似[这个 matheval 库](http://www.phpclasses.org/package/2695-PHP-Safely-evaluate-mathematical-expressions.html)的东西，但我最终需要为我的用例大幅扩展它。我基本上是在创建自己的自定义语言。

2.  [PHP runkit 沙箱](http://us.php.net/manual/en/runkit.sandbox.php)。我以前从未使用过它，但我非常担心所涉及的安全问题。考虑到可能的安全问题，我认为这不是一个可行的选择。

3.  我不知道是否有可能的另一个想法是在服务器端使用类似 javascript 的东西。我已经看到 js 在桌面应用程序中用作脚本平台来扩展功能，并且似乎类似的方法可能是可行的。我可以理想地定义运行它的环境，例如禁用文件系统访问等。同样，安全性似乎是一个问题。

从我所做的研究来看，#1 似乎是我唯一的选择，但我想我会检查一个更大的人才库。:-)

如果#3 是可能的，这似乎是要走的路，但我似乎无法找到任何有用的东西。另一方面，#2 和#3 之间可能没有太大区别。

性能是另一个考虑因素。大约有 65 个奇怪的公式，每个公式执行大约 450 次。每个公式都可以访问大约 15 个唯一变量、一百个左右的常数，以及之前公式的结果。（是的，有一个特定的执行顺序。）

我可以使用异步方法进行计算，其中计算将由用户事件启动并存储在数据库中，但宁愿不必这样做。

处理这种情况的最佳方法是什么？我的研究中是否还有其他第三方库没有出现？除了我的 3 之外，我还应该考虑其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:40:02.763

今天几乎没有理由创建自定义语言。有这么多可用和可破解的，编写自己的真的是浪费时间。

如果您不为无数用户提供服务（对于无数的各种值），那么大多数现代脚本语言都是安全的，特别是如果您愿意采取严厉措施来做到这一点（例如完全消除 I/O 和系统接口） ）。

JavaScript 是一个有效的选项。在 JS 本身中创建迷你沙箱来运行外部代码很简单。如果您希望人们能够跨运行保持状态，只需要求他们将其存储在“类似 JSON”的 JS 结构中，这些结构可以在退出时从系统中轻松序列化，并且可以轻松重新加载。这些甚至可以是函数的结果。

如果您不想让他们使用某个函数或例程，您可以在触发外部代码之前取消定义它。不希望他们使用“读取”来读取文件？`read = func(s) { }`

显然，您应该与想要使用的 JS 实现的邮件列表交谈，以获得一些更好地保护它的提示。

但是 JS 有很好的支持，有据可查，而且解释器真的很容易使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:06:59.430

您有两个基本选择：

a）提供您自己的语言，您可以完全控制所做的事情，因此不会发生任何不好的事情，

b) 使用其他一些执行引擎，并检查它所做的一切以验证没有发生任何不良情况。

我对 b) 的问题是很难弄清楚某人可能以晦涩的方式做的所有坏事。

我更喜欢 a)，因为你只需要让他们有能力做你允许的事情。

如果您想要处理一组相当简单的公式，那么编写解析器/评估器实际上非常容易。请参阅[是否有可用于 8 位嵌入式系统的 flex/bison 替代方案？](https://stackoverflow.com/questions/2245962/is-there-an-alternative-for-flex-bison-that-is-usable-on-8-bit-embedded-systems/2336769#2336769)

我不清楚你有性能问题。是的，你想执行 450 次；但它包括数据库访问，其成本将支配任何涉及 1000 个算术步骤的计算。您可能会发现您的速度受到数据库访问的限制，您需要缓存数据库访问以使其运行得更快。

# ios - 在 iOS 上构建全景照片的开源库？

> ID：10791151
> 
> 赞同：1
> 
> 时间：2012-05-28T22:40:22.663
> 
> 标签：ios, image, image-processing, panoramas

有人知道这样的图书馆吗？我想在 iPhone 上使用此功能，但不想从头开始编写代码。PanoramaGL 没有帮助，因为它只处理显示全景图而不是构建它。

希望很快收到你的来信 Cheere Fadi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:51:06.233

根据您想要完成的工作的复杂程度，Opencv 库有一个[全景拼接](http://opencv.willowgarage.com/wiki/opencv_stitching) 模块。Opencv 现在可以在 iOS 上运行，请参阅[iPhone 和 OpenCV](https://stackoverflow.com/questions/348040/iphone-and-opencv)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:01:16.003

看到一个[全景](https://github.com/SpotMetrix/Panoramic)它开源帮助你。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T22:49:19.503

Not sure if this is helpful, but there is actually already a panoramic camera coded into iOS. you have to edit a plist file on a jailbroken device to enable it, though.

# arduino - Arduino步进器

> ID：10791153
> 
> 赞同：7
> 
> 时间：2012-05-28T22:40:33.910
> 
> 标签：arduino

我正在使用[Arduino Uno](http://arduino.cc/en/Main/ArduinoBoardUno)、电源屏蔽（[参考模型](http://www.dfrobot.com/wiki/index.php?title=Arduino_Motor_Shield_%28L298N%29_%28SKU:DRI0009%29)）和双极步进电机构建一个系统。

我无法使用 Arduino 的步进器库启动电机。我实例化我的步进器

```
Stepper myStepper(motorSteps, motorPin1,motorPin2m motorPin3,motorPin4); 
```

继续使用 Arduino 提供的示例代码。

当我在 Arduino 上启动代码时，电机发出一些声音，但它不转动。

如何确定要使用的正确电机引脚？在电源屏蔽上，要使用哪种模式，[PWM](http://en.wikipedia.org/wiki/Pulse-width_modulation)还是[PLL](http://en.wikipedia.org/wiki/Phase-locked_loop)？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T16:55:58.560

正如你所建议的，adafruit 电机护罩应该适合 arduino 步进库，因为它使用 L293D 来驱动电机。它可以驱动 2 个电流为 0.6A 的步进器（适用于您可以在打印机、软盘/CD/DVD 阅读器中找到的大多数小型步进器......）。

小心，他们似乎使用自己的库来制作这个盾牌，你可以在这里找到它：

[http://www.ladyada.net/make/mshield/download.html](http://www.ladyada.net/make/mshield/download.html)

要知道如何连接您的步进器，请看这里：

[http://www.ladyada.net/make/mshield/use.html](http://www.ladyada.net/make/mshield/use.html)

很抱歉以这种方式回答您的评论，但我没有足够的声誉来发表评论......所以，如果您认为这是一个很好的答案，请 +1 我的回答 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T17:35:52.393

arduino草图不​​起作用是正常的。它像这样驱动电机：

*   PIN1：线圈1，正向电流
*   PIN2：线圈1，反向电流
*   PIN3：线圈2，正向电流
*   PIN4：线圈2，反向电流

您的盾牌以这种方式驱动步进器：

*   PIN1：当前前进/后退
*   PIN2 : PWM 电流强度
*   PIN3 : PWM 电流强度
*   PIN4 : 当前前进/后退

驱动步进电机不是一个好主意，因为您甚至不需要 PWM 来驱动步进电机。是用来驱动直流电机的。您可以编写自己的草图来驱动带有该防护罩的步进器，但您应该找到适合 arduino 驱动步进器的防护罩。找类似“ [UL2003 stepper module](http://www.ebay.com/sch/i.html?LH_BIN=1&_sacat=0&_nkw=UL2003%20stepper&LH_PrefLoc=2) ”的东西，几块钱。

编辑：我有其中一个模块，它就像一个魅力。小心你需要的力量。也许您需要类似[L298N 模块](http://www.ebay.com/sch/i.html?_nkw=L298N&_sacat=0&_odkw=LN298&LH_BIN=1&_osacat=0&LH_PrefLoc=2)的东西。我也有几个，它们工作得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-09T12:29:55.353

如果电机发出一些声音，这是个好消息。至少你和它有联系。由于它只是声音而没有动作，因此这种行为可能包含三件事；

1.  电机针脚连接错误
2.  来自电机驱动器的电流不足。
3.  根据电机可以处理的情况，由使用 PWM 的代码确定的步数可能太少或太高。

我可以提供这个 URL 链接来确定电机引脚；

[如何在没有步进电机引脚的情况下确定我的步进电机接线](http://digital.ni.com/public.nsf/allkb/0AEE7B9AD4B3E04186256ACE005D833B)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-30T13:15:03.697

在步进电机中有多少根电线？4 或 6。

你的连接有问题。这就是为什么它发出这样的声音。

用万用表测试。您会发现两根电线具有高电阻。另外两个给一半。将前两个与电机驱动器 out1 连接，后两个与 out2 连接。

你没有提到你使用的是哪个电机驱动器。尝试使用 L298 电机驱动器屏蔽。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-23T17:27:19.420

问题似乎是错误连接的电机引脚。您确定将真正的绕组连接到电机吗？用欧姆表测量电机引脚。应该有两个绕组具有引脚 A1-A2 和 B1-B2。在这些引脚之间，您应该看到一些电阻值。然后确保以正确的顺序连接到屏蔽。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-06T20:22:47.167

我认为您遇到的问题与您尝试使用的防护罩类型有关。您链接的电源屏蔽是为直流电机设计的，您正在尝试使用步进电机（有关差异的解释，请参见[本网站）。](http://www.modmypi.com/blog/whats-the-difference-between-dc-servo-stepper-motors)

我建议尝试另一个支持使用步进电机的防护罩（如[Sparkfun EasyDriver ）。](https://www.sparkfun.com/products/12779)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-12T01:42:31.330

在 mi 项目中，我使用双极电机（nema17），您可以使用 A4988 pololu（或 drv8825，更强大，更昂贵）轻松驱动它。这些驱动器内部有一个 H 桥，并允许您通过简单的方式控制电机：

```
while(1){
   digitalWrite(PIN_STEP, HIGH);
   delay(1000);
   digitalWrite(PIN_STEP, LOW);
   delay(1000);
//1RPM = 100 microsecond delay for a 1.8 degree angle motor (200 steps per 
  turn)
  } 
```

# python - PyDev：始终运行相同的模块

> ID：10791157
> 
> 赞同：2
> 
> 时间：2012-05-28T22:40:58.103
> 
> 标签：python, eclipse, pydev

这是一个简单的。

我在 OS X 10.6 上使用 PyDev。我有一个运行某个模块来启动我的应用程序。每当我在其他模块中进行更改时，我需要将视图切换到启动模块以启动或从“运行”下拉菜单中选择它。我很好奇，是否有快捷方式或设置来设置默认模块以在您按下运行/启动时运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:57:55.503

**首选项 > 运行/调试 > 启动**

在“启动操作”下，选择“始终启动以前启动的应用程序”

![在此处输入图像描述](../Images/8bd6cdb46ffbde670316e0687835fe9f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:48:32.700

您可以按控制台中的重新启动当前启动图标

# c# - MVC3 日期时间存档布局 - 模型格式

> ID：10791159
> 
> 赞同：0
> 
> 时间：2012-05-28T22:41:47.863
> 
> 标签：c#, asp.net-mvc, database, sorting, datetime

好吧，所以我有一个包含帖子集合的数据库，其中包含一个名为 CreationDate 的列/属性。我想知道我的 ViewModel 会如何显示这样的存档：

```
..............
. 2012       .
.    Feb     .
.      PostA .
.      PostB .
.      PostC .
.    Mar     .
.      PostD .
.    May     .
.      PostE .
.............. 
```

起初我虽然我为什么不对控制器中的日期进行排序，但它最终成为一堆`foreach`循环，将遍历每个帖子，看看控制器是否已经为每个年|月制作了一个容器。

我的另一个想法是在我的数据库中添加更多列，称为年和月。这样我就可以获得所有不同的年份及其相应的月份，但我不确定这会是什么样子，也不知道我是否希望这些列在我的数据库/我的实体上......

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:16:36.160

好的。这是一个建议；在这种情况下，如果您可以使用`ViewModel`

```
public class PostsViewModel
{
    public int Year;
    public List<MonthPosts> Posts;

    public class MonthPosts
    {
        public string Month { get; set; }   // or may be enum with Months
        public List<Post> MPosts{ get; set;}   // your collection of Posts if they carry many other column values that are needed at the view. If it is just to render the description, instead of list of posts you can pass the list of description of the Posts.
    }
} 
```

在您的控制器中从您的帖子集合中您应该能够填写`PostsViewModel`并将其返回到视图

在你看来

```
@model IEnumerable<PostsViewModel> 
```

现在您应该能够在视图中对其进行迭代并根据您的需要进行渲染（存档格式）

**视图中的伪语法**

```
foreach(PostViewModel pvm in Model)
{
    render pvm.Year
    foreach(PostViewModel.MonthPosts mp in pvm.Posts)
    {
         render mp.Month;
         foreach(Post p in mp.MPosts)
         {
              render p.Description   //according to your needs
         }
    }
} 
```

# php - PHP 类函数忽略返回语句

> ID：10791163
> 
> 赞同：0
> 
> 时间：2012-05-28T22:41:59.163
> 
> 标签：php, class, function, return

由于某种原因，当 check_em() 成功时返回不起作用。我是php新手，所以我在这里不知所措。

```
<?php

//Class to handle mysql
class db_handler {
    private $db_host = 'localhost';
    private $db_name = 'project';
    private $db_user = 'project';
    private $db_pass = 'dbpassword';
    private $db_con_mysql = '';
    private $db_con_db = '';

    public function check_em($username, $password) {
        $db_query = "SELECT password FROM user WHERE name='".$username."' LIMIT 1;";
        if($this->db_con_mysql!='') {
            $db_query_response = mysql_query($db_query) or die('Query failed: '.mysql_error());
            $db_query_return = mysql_fetch_row($db_query_response);
            $db_sha1_hash = $db_query_return[0];
            echo $db_sha1_hash."<br>";
            echo sha1($password)."<br>";
            if(sha1($password)==$db_sha1_hash) {
                return 'user valid'; //THIS DOESN'T WORK!?!?!?
            } else {
                return 'no good';
            }
        } else {
            $this->db_connect();
            $this->check_em($username, $password);
        }

    }

    //Connect to mysql, then database
    private function db_connect() {
        $this->db_con_mysql = mysql_connect($this->db_host, $this->db_user, $this->db_pass) || die('Connection failed: '.mysql_error());
        $this->db_con_db = mysql_select_db($this->db_name) || die('Could not use'.$this->db_name.'. '.mysql_error());
        return;
    }

    //Disconnect from database and reset vars used to track connection.
    private function db_disconnect() {
        if($this->db_con_mysql!='') {
            mysql_close();
            $this->db_con_mysql = '';
            $this->db_con_db = '';
            return;
        }
    }

    public function fake($some_val) {
        if($some_val<6) {
            return TRUE;
        } else {
            return FALSE;
        }
    }
}

$db_obj = new db_handler();
$val1 = $db_obj->check_em('someuser','password'); //should return 'user valid'
echo "val1:".$val1."<br>";
echo "<br><br>";

$val2 = $db_obj->check_em('someuser','passw0rd'); //should return 'no good'
echo "val2:".$val2."<br>";
echo "<br><br>";

echo "test<br>";
echo $db_obj->fake(4)."<br>";

?> 
```

结果：

```
5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8
5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8
val1:

5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8
7c6a61c68ef8b9b6b061b28c348bc1ed7921cb53
val2:no good

test
1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:46:38.527

This line needs a return:

```
return $this->check_em($username, $password); 
```

But a more sensible solution would be to connect to the database inside the `if` when the connection is `null`. Really, the whole thing could be better written, but I'll leave it at that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:46:56.430

```
...
else {
            $this->db_connect();
            return $this->check_em($username, $password);
        }
... 
```

You want to add the return, so that if it fails, then it goes one level deeper and finds another. If that level deeper succeeds, it passes the value up to the level above, which can pass it up and up until it reaches the original function call.

# c# - RavenDB 快速子串搜索

> ID：10791164
> 
> 赞同：6
> 
> 时间：2012-05-28T22:42:07.207
> 
> 标签：c#, substring, ravendb

我可能有数万亿个字符串序列。我正在寻找快速的子字符串搜索。

我创建了一个索引。当我试图得到一些结果（`x => x.StartWith`）时，在一个 300 万个对象数据库上大约需要 2 秒。

处理 5 亿个对象可能需要多长时间？

是否可以让 RavenDB 搜索更快？

```
 store.DatabaseCommands.PutIndex("KeyPhraseInfoByWord", new Raven.Client.Indexes.IndexDefinitionBuilder<KeyPhraseInfo>
   {
    Map = wordStats => from keyPhraseInfo in keyPhraseInfoCollection 
                   select new { keyPhraseInfo.Key },
    Analyzers =
        {
            { x => x.Key, "SimpleAnalyzer"}
        }
    }); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T13:58:42.663

Nier0，您可以使用 RavenDB 进行非常快速的 NGram 搜索，是的。见：[https ://gist.github.com/1669767](https://gist.github.com/1669767)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-28T12:36:35.483

Ayende 出色的 NGram 分析器似乎是为比 RavenDB 现在使用的旧版本的 Lucene 制作的，所以我为像我这样困惑的人制作了它的更新版本。请参阅： http: [//pastebin.com/a78XzGDk](http://pastebin.com/a78XzGDk)。所有功劳都归功于 Ayende。

要使用它，请将其放入库中，构建它并将其放入 RavenDB 目录中 Server 下的 Analyzers 文件夹中。然后像这样创建一个索引：

```
public class PostByNameIndex : AbstractIndexCreationTask<Posts>
{
    public PostByNameIndex()
    {
        Map = posts => posts.Select(x => new {x.Name});
        Analyze(x => x.Name, typeof(NGramAnalyzer).AssemblyQualifiedName);
     }
} 
```

但正如我所说，所有的功劳和感谢 Ayende 创造了这个。

# php - 暂停-继续用php读取大文本文件

> ID：10791167
> 
> 赞同：0
> 
> 时间：2012-05-28T22:42:37.860
> 
> 标签：php, text

我有以下 PHP 代码。我希望能够从它停止的地方继续读取文本文件，并且文本文件超过 90mb。

是否可以从脚本停止运行的点继续阅读？

```
$in = fopen('email.txt','r');

while($kw = trim(fgets($in))) {
    //my code
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:45:35.057

不，如果不时不时保存当前状态，这并不容易。

但是，您最好尝试修复导致脚本停止的任何原因，而不是这样做。`set_time_limit(0);`并且`ignore_user_abort(true);`很可能会阻止您的脚本在运行时停止。

如果您*确实*希望能够从某个位置继续，`ftell($in)`请不时使用获取该位​​置并将其存储在文件/数据库中。启动脚本时，您检查是否有存储位置，然后`fseek($in, $offset);`在打开文件后检查。

如果脚本是从浏览器执行的，并且可能需要足够的时间来中止，您还可以考虑将其拆分为块并使用包含要继续的参数的重定向干净地终止脚本。因此，您的脚本将处理例如 1000 行，然后以 1000 的偏移量重新启动以处理接下来的 1000 行，依此类推。

# string - 近似字符串匹配的具体算法代码

> ID：10791168
> 
> 赞同：1
> 
> 时间：2012-05-28T22:43:19.197
> 
> 标签：string, algorithm, data-structures, string-matching

[近似字符串匹配](http://en.wikipedia.org/wiki/Approximate_string_matching)并不是一个陌生的问题。

我正在学习并试图了解如何解决它。我什至现在也不想太深入，只想了解蛮力的方式。

在其 wiki 页面（[近似字符串匹配](http://en.wikipedia.org/wiki/Approximate_string_matching)）中，它说

> 蛮力方法是计算 T 的所有子串到 P（模式）的编辑距离，然后选择具有最小距离的子串。但是，该算法的运行时间为 O(m * n^3)，n 是 T 的长度，m 是 P 的长度

行。我通过以下方式理解此声明：

1.  我们找出 T 的所有可能子串
2.  我们计算每对字符串 {P, t1}, {P, t2}, ... 的编辑距离
3.  我们找出哪个子串与 P 的距离最短，这个子串就是答案。

我有以下问题：

一种。我可以使用两个 for 循环来获取所有可能的子字符串，这需要 O(n^2)。所以当我尝试计算一个子串和模式的编辑距离时，它是否需要 O(n*m)？为什么？

湾。我究竟如何计算一对（一个子串和模式）的距离？我知道我可以插入、删除、替换，但是谁能给我一个只计算一对的算法？

谢谢

* * *

## 编辑

好的，我应该使用[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)，但我不太了解它的方法。

这是部分代码

```
for j from 1 to n
{
    for i from 1 to m
    {
      if s[i] = t[j] then  
        d[i, j] := d[i-1, j-1]       // no operation required
      else
        d[i, j] := minimum
                   (
                     d[i-1, j] + 1,  // a deletion
                     d[i, j-1] + 1,  // an insertion
                     d[i-1, j-1] + 1 // a substitution
                   )
    }
  } 
```

所以，假设我现在正在比较`{"suv", "svi"}`.

所以`'v' != 'i'`，那么我必须看到另外三对：

1.  `{"su", "sv"}`
2.  `{"suv", "sv"}`
3.  `{"su", "svi"}`

我如何理解这部分？为什么我需要看到这 3 个部分？

这是否`distance between two prefixes`意味着我们需要进行`distance`多次更改才能使两个前缀（或字符串）相等？

那么，让我们来看看`{"su", "sv"}`。我们可以看到，距离`{"su", "sv"}`是1。那么只加1怎么能`{"su", "sv"}`变成呢？`{"suv", "svi"}`我认为我们需要在“su”中插入“v”，在“sv”中插入“v”，然后用“v”替换最后一个“i”，这涉及到 3 个操作，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:53:08.993

测量两个字符串之间的编辑距离的标准方法称为[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)- 维基百科页面包含该算法的伪代码。

至于您的编辑：您需要查看，`{"su", "sv"}`因为更改`"suv"`为的最佳方法可能`"svi"`是将最后一个替换为`v`，`i`其成本将高于更改`"su"`为的成本`"sv"`。或者，最好的方法可能是更改`"suv"`为`"sv"`某种方式，然后添加一个`i`. 或者，最好的方法可能是先删除`v`from`"suv"`然后更改`"su"`为`"svi"`. 在这种情况下，第一种方法被证明是最好的（或与其他选项一样好）。编辑距离确实是2，操作是把the`u`变成a `v`，把the`v`变成an `i`。

# ruby-on-rails - 如何使用 Rmagick 生成字体图像？

> ID：10791173
> 
> 赞同：1
> 
> 时间：2012-05-28T22:44:25.790
> 
> 标签：ruby-on-rails, ruby, fonts, rmagick

在我的应用程序中，有一个控制器具有从 TrueType 和 OpenType 文件生成图像的方法，它接收“颜色”、“任意文本”、“背景”等参数。

问题是路径文件包含空格时：

```
def imagefont

  font = Font.find params[:font]
  file = File.basename font.file, File.extname(font.file)
  fontfile = File.path(Pathname.new("public/downloads/#{font.name.slice(0,1).capitalize}/#{file}/#{font.file}"))

  options = {
    :max_width  => 240,
    :text_color => params[:color],
    :font_size  => 35,
    :text       => params[:text],
    :bg_color   => params[:background],
    :font       => fontfile
  }

  if File.exists?(options[:font])

    canvas = Magick::Image.new 50, 50
    image = Magick::Draw.new

    begin

      image.annotate(canvas, 0, 0, 0, 0, options[:text]) do
        image.pointsize = options[:font_size]
        image.font = options[:font]
      end

      metrics = image.get_type_metrics canvas, options[:text]
      canvas = Magick::Image.new(metrics.width, metrics.height){ self.background_color = options[:bg_color] }

      options[:font_size] -= 1

    end while metrics.width > options[:max_width]

    image  = Magick::Draw.new
    image.font options[:font]
    image.font_size options[:font_size]
    image.fill options[:text_color]
    image.text 0, 0, options[:text]
    image.gravity = Magick::CenterGravity
    image.draw canvas

    temp = Tempfile.new([font.file, '.png'])
    canvas.write(temp.path)

    render :text => open(temp.path).read  

  end

end 
```

上面的代码有效，除非字体名称包含空格。在这种情况下，它会显示以下错误：

```
Magick::ImageMagickError in FontController#imagefont
non-conforming drawing primitive definition `Blick' @ error/draw.c/DrawImage/3146 
```

在这种情况下，字体名称是“ `A Blick for All Seasons`”，所以我认为这是引号的问题。我试过放简单的引号，但我没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T07:53:25.580

我没有答案，但我有一个可能的解决方案。我发现并修改了 gem 文件中接收**fontfile**参数的方法。最初是这样出现的：

```
# File lib/RMagick.rb, line 335
def font(name)
  primitive "font #{name}"
end 
```

我改变了添加简单的引号，我明白了，工作正常：

```
# File lib/RMagick.rb, line 335
def font(name)
  primitive "font \'#{name}\'"
end 
```

我想我应该发送一个“拉取请求”来进行这个更改。除非有其他答案。

# node.js - socketio 和 redisstore 扩展效率

> ID：10791177
> 
> 赞同：0
> 
> 时间：2012-05-28T22:44:48.400
> 
> 标签：node.js, redis, socket.io

我正在做一个相当大的项目，涉及在客户端之间发送数据。所以，我只是在研究一些新技术。无论如何，我想我会尝试一下 Nodejs。我只是有一个关于socketio和redis的问题。

当我们在 socketio 中使用 pub/sub 函数时，每个客户端连接都会创建一个到 redis 的新连接吗？或者，socketio 是否使用最多创建三个连接（总共，无论客户端数量如何）来执行发布/订阅内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:13:05.913

从[源码](https://github.com/LearnBoost/socket.io/blob/master/lib/manager.js#L685-L691)来看，似乎每个客户端连接都有两个关联的 Redis 订阅（`this.store`在代码中），但每个 socket.io 服务器只有三个到 Redis 的连接（[源码](https://github.com/LearnBoost/socket.io/blob/master/lib/stores/redis.js#L63-L84)）。

```
this.store.subscribe('message:' + data.id, function (packet) {
  self.onClientMessage(data.id, packet);
});

this.store.subscribe('disconnect:' + data.id, function (reason) {
  self.onClientDisconnect(data.id, reason);
}); 
```

Redis 应该能够处理大量连接和订阅，但一如既往地建议进行基准测试。

# google-apps-script - 从我的谷歌表单自动创建谷歌联系人

> ID：10791179
> 
> 赞同：0
> 
> 时间：2012-05-28T22:44:54.823
> 
> 标签：google-apps-script

我有我的客户填写的谷歌表格。每次新人填写调查表时，如何让表单自动创建谷歌联系人？我不想每次都复制粘贴只是为了在我的 gmail 中创建一个新联系人

我正在尝试使用此脚本，但是当我尝试使用一些测试数据运行它时出现错误

```
function onFormSubmit(e) {
   var timestamp = e.values[0];
   var firstName= e.values[1];
   var lastName= e.values[2];
   var email= e.values[3];
   var phone= e.values[4]; 
   ContactsApp.createContact( timestamp  ,  firstName , lastName ,  email , phone );
 } 
```

> TypeError：无法从未定义中读取属性“值”。（第 2 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:43:09.943

尝试手动运行该函数时，您将收到该错误消息，因为没有将事件传递给该函数。

忽略帖子的其余部分（参见 Henrique 的评论）。

> 根据文档：
> 
> 一个事件作为参数 (e) 传递给每个事件处理程序。您可以将属性添加到 (e) 参数，以进一步定义触发器的工作方式或捕获有关脚本如何触发的信息。
> 
> 如果您使用这些属性，您仍必须从资源菜单设置触发器，如以上部分所述。
> 
> [https://developers.google.com/apps-script/guide_events#TriggerAttributes](https://developers.google.com/apps-script/guide_events#TriggerAttributes)
> 
> 我无法解释为什么会这样，但您似乎需要使用简单的事件处理程序（即命名函数 onFormSubmit），以及将可安装的事件处理程序应用于同一函数。然后，至少对我来说，它按预期工作。
> 
> HTH，亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T05:03:43.923

函数中没有“电话”参数`createContact`。在尝试从更难调试的触发器创建它之前，您是否尝试过编写一个简单的函数来创建一个简单的联系人，只是为了检查您是否做对了？

另外，我记得一个关于表单提交参数的[旧错误](http://code.google.com/p/google-apps-script-issues/issues/detail?id=291)，它可能会回来。`toString`无论如何，在所有参数中添加 a 并没有什么坏处。例如

```
var email = e.values[3].toString(); //just to be sure 
```

# html - 表因某种原因重叠

> ID：10791180
> 
> 赞同：1
> 
> 时间：2012-05-28T22:45:08.917
> 
> 标签：html, overlapping

出于某种原因，我`<td>`的 s 彼此重叠。它不应该那样做。我希望中心与当前不存在的左列分开。

有人知道我做错了什么吗？这是您可以查看代码等的网站：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:48:25.980

原因是 的`100%`宽度`.MiddleCenterContent`。不要使用表格来组织布局。表格仅用于表格数据。使用 div 或其他语义适当的容器将帮助您防止此类问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:52:13.447

`.MiddleCenterContent`宽度为`100%`，迫使它与邻居重叠。更好的方法是先设置`defaultTable`宽度`100%`，然后只定义其他单元格的宽度，然后`.MiddleCenterContent`填写。

尽管如此，更好的做法是使用`<div>`标签进行布局。互联网上有很多关于使用这些方法的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T22:56:04.567

在你的CSS中你有

```
.MiddleCenterContent {
width: 100%;
vertical-align: top;
} 
```

只需删除以下行

```
width: 100%; 
```

这迫使中心单元格为 100% 大，与其他单元格重叠

# c# - 突出显示触发事件的按钮

> ID：10791181
> 
> 赞同：0
> 
> 时间：2012-05-28T22:45:13.700
> 
> 标签：c#, silverlight-4.0

考虑一个具有 31 个超链接按钮的 SilverLight 项目。这些代表一个月中的日子。我正在使用此代码突出显示代表今天的超链接按钮。

```
var daynumberHyperButton = this.FindName("Day" + DateTime.Today.Day) as HyperlinkButton;

//Highlighting the day of the month
if (daynumberHyperButton != null)
{
   daynumberHyperButton.Background = new SolidColorBrush(Colors.Gray);
} 
```

然后，如果我点击这个突出显示的超链接按钮，它将打开一个子窗口来编写一些报告。

```
private void dayHyperLink_Click(object sender, RoutedEventArgs e)
{
    //This will initite and show the report window
    ReportWindow rapport = new ReportWindow();
    rapport.Closed += new EventHandler(rapport_Closed);
    rapport.Show();
} 
```

当我通过单击“确定”按钮关闭子窗口时，它会更改突出显示（今天）的超链接按钮的颜色，因为我正在使用此代码来执行此操作：-

```
private void rapport_Closed(object sender, EventArgs e)
{
    ReportWindow rapport = (ReportWindow)sender;
    var daynumberHyperButton = this.FindName("Day" + DateTime.Today.Day) as HyperlinkButton;
    if (rapport.UsersValue == "Röd" && rapport.DialogResult==true)
    {
        daynumberHyperButton.Background = new SolidColorBrush(Colors.Red);
    }
    else if (rapport.UsersValue == "Gul")
    {
        daynumberHyperButton.Background = new SolidColorBrush(Colors.Yellow);
    }
    else
    {
        daynumberHyperButton.Background = new SolidColorBrush(Colors.Green);
    }
} 
```

但是，如果我单击任何其他未突出显示的超链接按钮，它仍然只会更改突出显示的超链接按钮的颜色。我知道这一点是因为我的`rapport_Closed`活动有：

```
var daynumberHyperButton = this.FindName("Day" + DateTime.Today.Day) as HyperlinkButton; 
```

如何更改上面的代码，这是我的 rapport_Closed 事件的一部分，以便它更改事件触发（打开子窗口的那个）超链接按钮的颜色，无论哪个超链接按钮是触发事件的那个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:53:49.760

好的，现在我可以说我已经做到了。如果有人遇到类似问题，这就是我所做的。

1.  在可能的 Home.xaml.cs 中，我添加了一个像这样的公共属性：-

    public HyperlinkBut​​ton dayHyperLink { get; 放; }

2.  在 Click 事件中，我添加了以下代码：-

    dayHyperLink = (HyperlinkBut​​ton) 发送者；

3.  对于 rapport_Closing 事件，我将 if 语句更改为以下代码：-

    if (rapport.UsersValue == "Röd" && rapport.DialogResult == true) { dayHyperLink.Background = new SolidColorBrush(Colors.Red); } 这让我感到很高兴；）

# ruby-on-rails-3 - 使用@partner.products 关联时，“'2,1':String 的未定义方法 'each'”？

> ID：10791184
> 
> 赞同：0
> 
> 时间：2012-05-28T22:45:50.443
> 
> 标签：ruby-on-rails-3, activerecord

我有一个零件文件，我想在其中展示我为特定合作伙伴提供的所有产品。这是html.erb：

```
<% unless @products.nil? %>
        <% @products.each do |prod|%>
            <tr id="p_<%= prod.id%>">
                <td><%= prod.name %></td>
                <td><%= prod.price %></td>
                <td><%= number_field_tag "product_qty_input[#{prod.id}]", get_offer_product_qty(@offer.id, prod.id),:min => 0, :max => 99 %></td>
                <td>X</td>
            </tr>
        <% end %>
    <% end %> 
```

但我不断收到错误：未定义的方法 `each' for "2,1":String 它说它在这一行：<% @products.each do |prod|%>

但我没有看到问题.. 这是我的控制器：

```
def select_products
    @partner = Partner.find(params[:partner_id])
    if params[:id] == "-1"
      @offer = nil
    else
      @offer = Offer.find(params[:id])
    end

    @select_callback = url_for( @offer.nil? ? new_partner_offer_path(@partner) : [:edit, @partner, @offer] ) 
    @products = @partner.active_products
    @num_select = PRODS_PER_OFFER

    respond_to do |format|
      format.html { render :template => "products/select"}
    end
  end 
```

你看我有@products = @partner.active_products 方法，但我改变了它以查看它是否到达那里，它不是，必须是之前的东西......

我会感谢任何帮助。

提前致谢

**更新**

这是方法`active_products`：

```
def active_products
    self.products.where("active IS NOT NULL AND active = true")
end 
```

它应该返回对象而不是字符串我做错了什么？谢谢@论文

**更新 2** 伙计们，非常感谢您的帮助，在@thesis 的帮助下，我想通了。这实际上是我以前从未想过的事情，问题中也没有描述。当我在另一个页面中选择产品时，我的 sessionkeeper 帮助我保留了我的表格！那是在搞砸！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:50:10.977

你的问题很简单。您必须修复您的`active_products`方法，因为它返回`String`. 在您的情况下，字符串是，`"2,1"`但您必须返回产品集合，以使用[每种](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-each)方法对其进行迭代。

如需更多帮助，请更新您的问题并从模型中添加`active_products`实例方法。`Partner`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T07:18:35.747

你真的有数字“2,1”的产品吗？

@partner.active_products 应该理想地返回 ActiveRecord::Relation，因此它应该迭代 Product 类的对象。

请通过[http://guides.rubyonrails.org/](http://guides.rubyonrails.org/)

在此之前，您可能想搜索“ruby 哲学”和“rails 哲学”

# jquery - 我应该在哪里存储 html 元素的元信息？

> ID：10791186
> 
> 赞同：0
> 
> 时间：2012-05-28T22:46:14.850
> 
> 标签：jquery, html, ajax

我不知道这个问题的标题是否恰当。

我有一个侧边栏，其中填充了代表数据库中对象的可点击 div。当用户单击其中一个 div 时，我想通过 ajax 获取更详细的信息并在主要内容区域中显示接收到的信息。

每个侧边栏 div 都需要与之关联`id`，我可以使用我的 javascript 将其传递给服务器。

我想知道我应该把这个ID放在页面上的什么地方？

是否有这样做的最佳实践方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:47:35.867

我会将数据存储在[`data-`attributes](http://ejohn.org/blog/html-5-data-attributes/)中。

jQuery 有一种方法[`data()`](http://api.jquery.com/jQuery.data/)可以轻松检索/存储数据。

对于从服务器加载部分视图，我会推荐[`$.load()`](http://api.jquery.com/load/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:51:29.867

我认为最好的方法是让表单锚链接中的可点击区域转到以 json 格式获取数据的 url。

像这样的东西：

```
<a href="/getdata?id=1234" class="data_expand"  rel="nofollow">Expand</a> 
```

进而：

```
$(function(){

    $(".sidebar a.data_expand").click(function(event){
       event.preventDefault();

       $.get($(this).attr("href")).then(function(data){
           //Handle data here
       });
    });

}); 
```

# ruby-on-rails - How do I iterate through Associations in Rails?

> ID：10791187
> 
> 赞同：1
> 
> 时间：2012-05-28T22:46:18.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, iteration

Ok, So I have a review model, and a votes model (Upvotes and Downvotes modeled through a single variable 'likes', If its true its an upvote, if its false its a downvote.). The votes are a has_many relation, and are polymorphic (I hope to be able to use this on more than just reviews later on).

So in the reviews model has the line

```
 has_many :votes, :as => :votable 
```

And the votes model is defined like this

```
class Vote < ActiveRecord::Base
  belongs_to :votable, :polymorphic => true
  belongs_to :user

  def upvote?
    like
  end

  def downvote?
    !like
  end
end 
```

Now this is fine, I can upvote, downvote and remove votes just fine. But I'm trying to generate a score bassed on the upvotes and downvotes (Simply upvotes-downvotes for now). To do this I added the following to the reviews model

```
def score
  up = 0
  down = 0
  self.votes.each do |v|
    if v.upvote?
      up += 1
    elsif v.downvote?
      down += 1
    end
  end
  up-down
end 
```

However I always get 0 back as the answer. The error is in the loop, as I can set the up or down variables to be what ever outside of it and they are passed through. Its starting to drive me insane, and I have no idea where im going wrong.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:04:40.977

对于初学者来说，最好使用数据库来计算具有命名范围的反对和赞成的数量。

然后，一旦获得总计数，您就可以从赞成票中减去反对票。

有关范围的更多信息，请参阅： http: [//guides.rubyonrails.org/active_record_querying.html#scopes](http://guides.rubyonrails.org/active_record_querying.html#scopes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T03:47:18.887

如果您确定错误在循环中，那么这是我最好的猜测：

你有 v.upvote 吗？好像，和 v.downvote？作为一个 elsif。

如果这两个都是假的会发生什么？我很确定什么都不会发生。因此，0 - 0 = 0，你总是得到零。如果您的 v.upvote? 和 v.downvote？写得正确，或者它们是正确的值。

尝试：

```
if v.upvote?
 ...
else
 ...
end 
```

显然，您以这种方式进行这些设置是有原因的，但您可能只是在错误的事情上进行分区。

希望这可以帮助。

# c# - Trouble Drawing Graphics

> ID：10791188
> 
> 赞同：0
> 
> 时间：2012-05-28T22:46:25.637
> 
> 标签：c#, gdi+

I am having trouble drawing graphics on a simple form. My code compiles and runs, but the intended red box does not show up.

I am using the full .NET Framework 4 in Visual Studio 2010.

What is going wrong, and how can it be fixed?

```
private void Form1_Load(object sender, EventArgs e)
{
    System.Drawing.Graphics graphicsObj;
    graphicsObj = this.CreateGraphics();
    Pen myPen = new Pen(System.Drawing.Color.Red, 5);
    Rectangle myRectangle = new Rectangle(20, 20, 250, 200);
    graphicsObj.DrawRectangle(myPen, myRectangle);
} 
```

**EDIT: Working But Slow Code**

```
 void BatteryPaint(object sender, EventArgs e)
    {
        TabPage page = (TabPage)sender;
        if (!controlsSetup)
        {
            populateBatteryTab(page);
            controlsSetup = true;
        }
        //Create the items
        Rectangle busBar = new Rectangle();
        Rectangle batPack = new Rectangle();
        Rectangle pack1Outline = new Rectangle();
        Rectangle pack2Outline = new Rectangle();
        Rectangle pack3Outline = new Rectangle();
        Rectangle pack4Outline = new Rectangle();

        Color GreenZone = Color.FromArgb(150, 0, 255, 0);
        Color YellowZone = Color.FromArgb(150, 255, 255, 0);
        Color RedZone = Color.FromArgb(150, 255, 0, 0);
        Color greyZone = Color.FromArgb(200, 200, 200, 200);

        Graphics graphicControl = page.CreateGraphics();

        SolidBrush busBarBrush = new SolidBrush(Color.Peru);
        SolidBrush GreenBrush = new SolidBrush(GreenZone);
        SolidBrush GreyBrush = new SolidBrush(greyZone);

        Pen packPen = new Pen(Color.LightGray, (float)8);

        Point busBarTop = new Point(page.Width / 64, page.Height / 32);
        Point busBarBottom = new Point(busBarTop.X, busBarTop.Y + page.Height / 6);

        //change the properties
        //Bus Bar Top
        busBar.Width = page.Width*153 / 640;
        busBar.Height = page.Height / 64;
        busBar.Location = busBarTop;
        graphicControl.FillRectangle(busBarBrush, busBar);

        //Bus Bar Bottom
        busBar.Location = busBarBottom;
        graphicControl.FillRectangle(busBarBrush, busBar);

        //Pack 1
        batPack.Width = page.Width / 20;
        batPack.Height = (busBarBottom.Y + busBar.Height) - busBarTop.Y;
        batPack.Location = new Point(busBarTop.X + page.Width / packSpacingMultiplier, busBarTop.Y);
        pack1Outline.Width = batOutlineWidth;
        graphicControl.FillRectangle(GreenBrush, batPack);
        pack1Outline.Height = (3 * (Battery.Width + page.Width / batSpacingMultiplier) + page.Width / batSpacingMultiplier);
        pack1Outline.Location = new Point(BatPack1.X - (page.Width / batSpacingMultiplier), BatPack1.Y - (page.Width / batSpacingMultiplier));
        for(int numBats = 0; numBats < 30; numBats++)
        {
            Battery.Location = new Point(BatPack1.X + ((numBats % 10) * (Battery.Width + page.Width / batSpacingMultiplier)), BatPack1.Y + ((numBats / 10) * (Battery.Width + page.Width / batSpacingMultiplier)));
            graphicControl.FillEllipse(new SolidBrush(BatteryZone(0.00)), Battery);
        }

        //Pack 2
        batPack.Location = new Point(batPack.Location.X + batPack.Width + page.Width / packSpacingMultiplier, batPack.Location.Y);
        graphicControl.FillRectangle(GreenBrush, batPack);
        pack2Outline.Width = batOutlineWidth;
        pack2Outline.Height = (3 * (Battery.Width + page.Width / batSpacingMultiplier) + page.Width / batSpacingMultiplier);
        pack2Outline.Location = new Point(BatPack2.X - (page.Width / batSpacingMultiplier), BatPack2.Y - (page.Width / batSpacingMultiplier));
        for(int numBats = 0; numBats < 30; numBats++)
        {
            Battery.Location = new Point(BatPack2.X + ((numBats % 10) * (Battery.Width + page.Width / batSpacingMultiplier)), BatPack2.Y + ((numBats / 10) * (Battery.Width + page.Width / batSpacingMultiplier)));
            graphicControl.FillEllipse(new SolidBrush(BatteryZone(0.00)), Battery);
        }

        //Pack 3
        batPack.Location = new Point(batPack.Location.X + batPack.Width + page.Width / packSpacingMultiplier, batPack.Location.Y);
        graphicControl.FillRectangle(GreenBrush, batPack);
        pack3Outline.Width = batOutlineWidth;
        pack3Outline.Height = (3 * (Battery.Width + page.Width / batSpacingMultiplier) + page.Width / batSpacingMultiplier);
        pack3Outline.Location = new Point(BatPack3.X - (page.Width / batSpacingMultiplier), BatPack3.Y - (page.Width / batSpacingMultiplier));
        for(int numBats = 0; numBats < 30; numBats++)
        {
            Battery.Location = new Point(BatPack3.X + ((numBats % 10) * (Battery.Width + page.Width / batSpacingMultiplier)), BatPack3.Y + ((numBats / 10) * (Battery.Width + page.Width / batSpacingMultiplier)));
            graphicControl.FillEllipse(new SolidBrush(BatteryZone(0.00)), Battery);
        }

        //Pack 4
        batPack.Location = new Point(batPack.Location.X + batPack.Width + page.Width / packSpacingMultiplier, batPack.Location.Y);
        graphicControl.FillRectangle(GreyBrush, batPack);
        pack4Outline.Width = batOutlineWidth;
        pack4Outline.Height = (3 * (Battery.Width + page.Width / batSpacingMultiplier) + page.Width / batSpacingMultiplier);
        pack4Outline.Location = new Point(BatPack4.X - (page.Width / batSpacingMultiplier), BatPack4.Y - (page.Width / batSpacingMultiplier));
        for(int numBats = 0; numBats < 30; numBats++)
        {
            Battery.Location = new Point(BatPack4.X + ((numBats % 10) * (Battery.Width + page.Width / batSpacingMultiplier)), BatPack4.Y + ((numBats / 10) * (Battery.Width + page.Width / batSpacingMultiplier)));
            graphicControl.FillEllipse(new SolidBrush(BatteryZone(0.00)), Battery);
        }

        //add the controls
        graphicControl.DrawRectangle(packPen, pack1Outline);
        graphicControl.DrawRectangle(packPen, pack2Outline);
        graphicControl.DrawRectangle(packPen, pack3Outline);
        graphicControl.DrawRectangle(packPen, pack4Outline);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:58:12.370

您不应该在事件中进行绘图，该`Load`事件甚至在您的表单第一次显示之前就被触发。窗口在显示时会重新绘制，这会清除您绘制的图形。如果您想要一个持久的矩形，请`Paint`改为处理事件：

```
private void Form1_Paint(object sender, PaintEventArgs e)
{
    System.Drawing.Graphics graphicsObj = e.Graphics;
    Pen myPen = new Pen(System.Drawing.Color.Red, 5);
    Rectangle myRectangle = new Rectangle(20, 20, 250, 200);
    graphicsObj.DrawRectangle(myPen, myRectangle);
} 
```

如果您*不*想要一个持久的矩形（非常值得怀疑，但仍然可能），请尝试处理`Shown`事件而不是`Load`事件。

如果显示的图形会经常更新（例如在游戏中），请确保设置`DoubleBuffered`为`true`并覆盖`OnPaint`而不是处理事件：

```
protected override void OnPaint(PaintEventArgs e)
{
    Graphics g = e.Graphics;
    Pen myPen = new Pen(Color.Red, 5);
    g.DrawRectangle(myPen, 20, 20, 250, 200);
} 
```

# ruby - Passing original string PLUS matches when using gsub and block?

> ID：10791195
> 
> 赞同：1
> 
> 时间：2012-05-28T22:47:10.703
> 
> 标签：ruby, string

Rails fans are familiar with `params[:terms]` or a hash of 'things' passed to the controller collected form the url. E.g.:

```
params
=> {"term"=>"Warren Buffet",
    "controller"=>"search",
    "format"=>"json",
    "action"=>"index"} 
```

If I want to use "Warren Buffet", "Warren" and "Buffet" in the code below, does anyone know which method I should be using instead? `gsub` is close, but it takes each match and not the original string too. Unless I'm doing it wrong, which is totally possible:

```
@potential_investors = []
params[:term].gsub(/(\w{1,})/) do |term|
  @potential_investors << User.where(:investor => true)
  .order('first_name ASC, last_name ASC')
  .search_potential_investors(term)
end

```

Thoughts?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:11:24.953

怎么样：

```
s = "Filthy Rich"
s.split(" ").push(s)
>> ["Filthy", "Rich", "Filthy Rich"] 
```

或者，`scan`如果您更喜欢使用正则表达式：

```
s.scan(/\w+/).push(s)
>> ["Filthy", "Rich", "Filthy Rich"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:11:19.067

```
params["term"].gsub(/(\w{1,})/) 
```

返回一个枚举器。您可以将其转换为数组并将原始术语附加到其中：

```
ary = params["term"].gsub(/(\w{1,})/).to_a + [params["term"]] 
```

然后处理它：

```
ary.each do |term|
... 
```

# c - In GIO, why do these asynchronous file IO operations never complete? (applies to both C and Vala)

> ID：10791196
> 
> 赞同：2
> 
> 时间：2012-05-28T22:47:10.750
> 
> 标签：c, asynchronous, glib, vala, gio

I want to perform asynchronous file IO operations. Here is a simplified version of what I am trying to do in Vala:

```
void main(string[] args) {
    store_async();

    while(true)
        ;
}

async void store_async() {
    File file = File.new_for_path("settings.ini");

    stderr.printf("Checking if file exists...\n");
    if (!file.query_exists()) {
        stderr.printf("About to yield file.create_async...\n");
        try {
            yield file.create_async(FileCreateFlags.REPLACE_DESTINATION);
        } catch (Error err) {
            error("Error creating file: %s\n", err.message);
        }
        stderr.printf("Returned from file.create_async.\n");
    }

    string data = "hello\n";
    string new_etag;
    stderr.printf("About to yield file.replace_contents_async...\n");
    try {
        yield file.replace_contents_async(
            data.data,
            null,
            false,
            FileCreateFlags.NONE,
            null,
            out new_etag);
    } catch (Error err) {
        error("Error replacing contents: %s\n", err.message);
    }

    stderr.printf("Returned from file.replace_contents_async.\n");
} 
```

When I run this program, and no file `settings.ini` exists, `settings.ini` is created and I see this output:

```
Checking if file exists...
About to yield file.create_async...
(hangs) 
```

If `settings.ini` exists, nothing is written to it, and I see this output:

```
Checking if file exists...
About to yield file.create_async...
(hangs) 
```

I have a similar problem if I try to reproduce the issue in C. Here is my C code (it doesn't replicate the entire vala example above, just the part that creates the file):

```
#include <glib.h>
#include <gio/gio.h>
#include <stdio.h>

void create_callback(GObject *source_object, GAsyncResult *res, gpointer user_data);
void write_contents();

GFile* file;

void main(int argc, char** argv) {
    g_type_init();

    fprintf(stderr, "Before file_new_for_path\n");
    file = g_file_new_for_path("settings.ini");

    fprintf(stderr, "Before file_query_exists\n");
    if (!g_file_query_exists(file, NULL)) {
        fprintf(stderr, "Before file_create_async\n");
        g_file_create_async(
                file,
                G_FILE_CREATE_REPLACE_DESTINATION,
                G_PRIORITY_DEFAULT,
                NULL,
                create_callback,
                NULL);
        fprintf(stderr, "After file_create_async\n");
    } else {
        fprintf(stderr, "File already exists. Before write_contents\n");
        write_contents();
        fprintf(stderr, "File already exists. After write_contents\n");
    }

    while(TRUE)
        ;
}

void create_callback(GObject *source_object, GAsyncResult *res, gpointer user_data) {
    fprintf(stderr, "In create_callback. Before write_contents.\n");
    write_contents();
    fprintf(stderr, "In create_callback. After write_contents.\n");
}

void write_contents() {
    fprintf(stderr, "In write_contents\n");
} 
```

When I run this example, I see this output (assuming `settings.ini` does not exist):

```
Before file_new_for_path
Before file_query_exists
Before file_create_async
After file_create_async
(hangs) 
```

In other words, `create_callback` is never called.

What am I doing wrong? Why don't `g_file_create_async` and `g_file_replace_contents_async` ever complete when I call them?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T23:03:06.390

glib 中的异步实现要求您运行消息循环。如果没有，您的回调将如何以及何时被调用？

所以在 Vala 中添加：

```
var loop = new MainLoop();
loop.run(); 
```

在 C 中：

```
GMainLoop *loop = g_main_loop_new(NULL, FALSE);
g_main_loop_run(loop);
g_main_loop_unref(loop) 
```

# c - C data structure libraries

> ID：10791199
> 
> 赞同：0
> 
> 时间：2012-05-28T22:47:38.853
> 
> 标签：c

> **Possible Duplicate:**
> [Generic data structure libraries for C?](https://stackoverflow.com/questions/2159555/generic-data-structure-libraries-for-c)

Starting off in C programming and wondering if anyone is aware of any library containing implementations of data structures such as linked list, hash maps etc ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:49:33.580

glib. Hard to use if you're just-starting-off because you actually have to know how to get around in pointers.

It's reasonably standard for applications that want to use that sort of thing (excuse the wishy-washy opining).

An option I usually prefer is to wrap C++ STL with C APIs myself. I don't know if there's a standard converter for this. But this is because most developers I work with understand C++-to-C APIs (part of the corporate code landscape at my firm) and STL much better than glib, in which client code tends to be egregiously error prone.

# javascript - JavaScript eval("{}") return behavior?

> ID：10791202
> 
> 赞同：4
> 
> 时间：2012-05-28T22:48:05.180
> 
> 标签：javascript, ecmascript-5

According to the [ECMA-262 Specification](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf), the following statements return `1`:

```
eval("1;;;;;")
eval("1;{}")
eval("1;var a;") 
```

Ensuring that:

> The value of a StatementList is the value of the last value producing Statement in the StatementList.

Can you explain these different returns ?

```
eval("{}") // undefined
eval("var a={}; a;") // {}
eval("var a={};") // undefined 
```

What is the difference between `1;` and `{};` ?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T22:49:45.633

Left alone, `{}` is interpreted as a *block*, not an object. It contains no statements, so does not affect the value of, say, `eval("1;{}")`. To force it to be interpreted as an object, you can use parentheses:

```
eval("1;({})"); // {} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:52:37.483

在我看来，它`eval`被解释`{}`为代码块的分隔符，因此没有内在价值。

# ruby-on-rails-3 - Rails 3 - Building a nested resource within another nested resource (articles -> comments -> votes)

> ID：10791209
> 
> 赞同：1
> 
> 时间：2012-05-28T22:49:05.980
> 
> 标签：ruby-on-rails-3, build, resources, nested, associations

In my app there is an association problem, which I'm unable to fix. My app is quite simple: There's an Article model; each article has_many comments, and each of those comments has_many votes, in my case 'upvotes'.
To explain the way I designed it, I did a comments scaffold, edited the comment models and routes to a nested resource, everything works fine. Now, I basically did the same process again for 'upvotes' and again edited model and routes to make this a nested resource within the comment nested resource. But this fails at the following point:

```
NoMethodError in Articles#show
Showing .../app/views/upvotes/_form.html.erb where line #1 raised:
undefined method `upvotes' for nil:NilClass 
```

My _form.html.erb file looks like this:

```
<%= form_for([@comment, @comment.upvotes.build]) do |f| %>
<%= f.hidden_field "comment_id", :value => :comment_id %>
<%= image_submit_tag "buttons/upvote.png" %>
<% end %> 
```

Why is 'upvotes' undefined in this case, whereas here:

```
<%= form_for([@article, @article.comments.build]) do |form| %>
rest of code 
```

everything works totally fine? I copied the same mechanism but with @comment.upvotes it doesn't work.

My upvotes_controller:

```
class UpvotesController < ApplicationController

  def new
    @upvote = Upvote.new

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @upvote }
    end    
  end

  def create
  @article = Article.find(params[:id])
  @comment = @article.comments.find(params[:id])
    @upvote = @comment.upvotes.build(params[:upvote])
    respond_to do |format|
      if @upvote.save
        format.html { redirect_to(@article, :notice => 'Voted successfully.') }
        format.xml  { render :xml => @article, :status => :created, :location => @article }
      else
        format.html { redirect_to(@article, :notice => 
        'Vote failed.')}
            format.xml  { render :xml => @upvote.errors, :status => :unprocessable_entity }
      end
    end
  end

end 
```

I'm sorry for this much code.., my articles_controller: (extract)

```
def show
    @upvote = Upvote.new(params[:vote])
    @article = Article.find(params[:id])
    @comments = @article.comments.paginate(page: params[:page])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @article }
    end
  end 
```

And my 3 models:

```
 class Article < ActiveRecord::Base
    attr_accessible :body, :title

    has_many :comments
  end

  class Comment < ActiveRecord::Base
    attr_accessible :content

    belongs_to :user
    belongs_to :article
    has_many :upvotes
  end

  class Upvote < ActiveRecord::Base
    attr_accessible :article_id, :comment_id, :user_id

    belongs_to :comment, counter_cache: true
  end 
```

Upvote migration file:

```
 class CreateUpvotes < ActiveRecord::Migration
    def change
      create_table :upvotes do |t|
        t.integer :comment_id
        t.integer :user_id

        t.timestamps
      end
    end
  end 
```

My routes:

```
 resources :articles do
      resources :comments, only: [:create, :destroy] do
        resources :upvotes, only: [:new, :create]
      end
    end 
```

Sorry for that much code. If anyone might answer this, they would be so incredibly awesome! Thank you in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:18:21.727

您的错误消息说您尝试 call `upvotes`on `nil`。具体来说，它是`@comment.upvotes.build`您`/app/views/upvotes/_form.html.erb`视图中代码的一部分。

您必须通过添加（带有内容）变量来修复`show`您的操作。`ArticlesController``@comment`

```
 def show
    @upvote = Upvote.new(params[:vote])
    @article = Article.find(params[:id])
    @comments = @article.comments.paginate(page: params[:page])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @article }
    end
  end 
```

`UpvotesController`在`create`行动中也发生了奇怪的事情。

```
@article = Article.find(params[:id])
@comment = @article.comments.find(params[:id])
@upvote = @comment.upvotes.build(params[:upvote]) 
```

首先，您`@article`使用获取了一个`params[:id]`，然后您获取了该`@article`（通过关联）的所有评论，其中评论 id 与`@article`id 相同。请检查您的代码，它不一致并且无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T14:21:22.713

现在一切都已修复并且工作正常。采取了不同的方法，简单地使用 Upvote.new 而不是将其嵌套到评论和建立关联中，也编辑了我的路线。实现了马修福特的想法

> 我怀疑你在文章页面上有很多评论，评论变量应该是本地的，例如@article.comments.each do |comment| 然后使用评论变量来构建您的投票表格。

谢谢大家的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:11:15.643

> 为什么在这种情况下“upvotes”未定义，而在这里：

这是因为您正在对 nil 对象进行投票，但该评论尚不存在。

最好的办法是查看嵌套属性：

[http://guides.rubyonrails.org/2_3_release_notes.html#nested-attributes](http://guides.rubyonrails.org/2_3_release_notes.html#nested-attributes)

[http://guides.rubyonrails.org/2_3_release_notes.html#nested-object-forms](http://guides.rubyonrails.org/2_3_release_notes.html#nested-object-forms)

# iphone - New Address Book App-How to Import Contacts From Existing Address Book to my App?

> ID：10791211
> 
> 赞同：2
> 
> 时间：2012-05-28T22:49:13.337
> 
> 标签：iphone, ios5, addressbook

I am working on an app for a new address book. Is there code existing to make a button to import your contact (from existing address book) into my app? And add *67 to these new contacts if possible?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:57:23.537

您需要阅读如何从通讯录中导入联系人。

[**ABAddressBook 类参考**](https://developer.apple.com/library/mac/#documentation/userexperience/Reference/AddressBook/Classes/ABAddressBook_Class/Reference/Reference.html)

## 这是一个例子

```
CFStringRef phone,phoneLabel;
ABMutableMultiValueRef phoneMulti = ABRecordCopyValue(person, kABPersonPhoneProperty);
NSMutableDictionary *myPhoneDict = [NSMutableDictionary dictionaryWithCapacity:ABMultiValueGetCount(phoneMulti)];
for (CFIndex i = 0; i < ABMultiValueGetCount(phoneMulti); i++) { 
    phoneLabel = ABAddressBookCopyLocalizedLabel(ABMultiValueCopyLabelAtIndex(phoneMulti, i));
    phone = ABMultiValueCopyValueAtIndex(phoneMulti, i); 
    [myPhoneDict setObject:(NSString*)phone forKey:(NSString*)phoneLabel];
    CFRelease(phone);
    CFRelease(phoneLabel);
} 
if ( [myPhoneDict objectForKey:@"mobile"] != nil) {
    NSLog(@"Cell Phone: %@",[myPhoneDict objectForKey:@"mobile"]);
} 

else if ( [myPhoneDict objectForKey:@"home"] != nil) {
    NSLog(@"Home Phone: %@",[myPhoneDict objectForKey:@"home"]);
} 

else if ( [myPhoneDict objectForKey:@"work"] != nil) {
    NSLog@"Work Phone: %@",[myPhoneDict objectForKey:@"work"]);
} 
```

然后，您可以获取您要查找的任何数字并将您的 *67 数字添加到其中，然后保存该新字符串。

# algorithm - AVL 树 - 为什么某些节点的左右子节点的高度必须相差 1？

> ID：10791213
> 
> 赞同：2
> 
> 时间：2012-05-28T22:49:20.377
> 
> 标签：algorithm, binary-tree, avl-tree

某个节点的左右子节点的高度相差 2 有什么问题？

这是我第一次接触 AVL 树，我似乎无法理解为什么它是必须的？

真的，孩子相差2岁有什么问题？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:51:30.517

这就是AVL树的概念，左右孩子的高度最多不能相差一个。

来自维基百科

> 在 AVL 树中，任何节点的两个子子树的高度最多相差 1。

由于它是平衡的，这使得搜索为 0(logn)，因此它比非平衡二叉树更快，其中所有元素都可能在左侧，使其为 0(n)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T22:51:50.807

根据定义，平衡二叉树只能相差一个。如果您查看在 AVL 树上运行的算法，您会发现该属性始终保持不变。

虽然可以制作某种高度最多相差 +- 2 的数据结构，但这样做并没有真正的好处。通过将其保留为 +- 1，您可以创建一个更简单的自平衡数据结构。

# string - eval in template strings

> ID：10791218
> 
> 赞同：2
> 
> 时间：2012-05-28T22:50:02.953
> 
> 标签：string, templates, python

I'm considering porting a rather unwieldy bash script to python but I'm stuck on how to handle the following aspect: The point of the script is to generate a png image depending on dynamically fetched data. The bash script grabs the data, and builds a very long invocation of the `convert` utility, with lots of options. It seemed like python's template strings would be a good solution (I would vastly prefer to stay within the standard library, since I'll be deploying to shared hosting), but I discovered that you can't evaluate expressions as you can in bash:

```
>>> from string import Template
>>> s = Template('The width times one is ${width}')
>>> s.substitute(width=45)
'The width times one is 45'
>>> t = Template('The width times two is ${width*2}')
>>> t.substitute(width=45)
# Raises ValueError 
```

Since my bash script depends quite heavily on such arithmetic (otherwise the number of variables to keep track of would increase exponentially) I'd like to know if there's a way to emulate this behavior in python. I saw that [this question](https://stackoverflow.com/questions/5282503/evaluation-inside-string), asking roughly the same, has a comment, reading:

> This would be very unPythonic, because it's counterintuitive -- strings are just strings, they shouldn't run code!

If this is the case, what would be a more idiomatic way to approach this problem? The proposed answer to the question linked above is to use string formatting with either the `%` syntax or the `format()` function, but I don't think that would work well with the number of variables in my string (around 50).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:55:20.403

为什么不使用内置的字符串格式？

```
width = 45
"Width times one is {width}".format(width=width)
"Width times two is {width}".format(width=2*width) 
```

结果是

```
Width times one is 45
Width times two is 90 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:01:38.100

您可能需要一个更好的模板引擎。[`Jinja2`](http://jinja.pocoo.org/)支持这种东西等等。我不认为标准库有任何同样强大的功能，但据我所知，该库是纯 Python，因此您只需复制它即可将其集成到您的应用程序中。

如果 Jinja 由于某种原因不适合您，请查看 Python wiki，其中有[专门针对这些类型的库的部分](http://wiki.python.org/moin/Templating#Engines_Mixing_Logic_into_Templates)。其中包括非常轻量级的[Templite](http://www.joonis.de/content/TemplitePythonTemplatingEngine)，它只是一个类，似乎完全可以满足您的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T22:57:11.820

这个问题的 Pythonic 解决方案是忘记字符串格式并将参数*列表*[`subprocess`](http://docs.python.org/library/subprocess.html)传递给其中一个函数，例如

```
# I have no idea about convert's command line usage,
# so here's an example using echo.
subprocess.call(["echo", str(1 + 1), "bla"]) 
```

这样，无需构建单个字符串，也无需担心引用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-28T23:34:04.947

这个任务并不难，你为什么不做一些有趣的编码呢？这里的功能几乎可以满足您的需求。

```
import re
def TempEval(template,**kwargs):
    mark = re.compile('\${(.*?)}')
    for key in kwargs:
        exec('%s=%s'%(key,kwargs[key]))
    for item in mark.findall(template):
        template=template.replace('${%s}'%item,str(eval(item)))
    return template

print TempEval('The width times one is ${width}',width=5)
#The width times one is 5
print TempEval('The width times two is ${width*2}',width=5)
#The width times two is 10 
```

# java - NetBeans GUI 构建器：“正在加载...”消息

> ID：10791221
> 
> 赞同：6
> 
> 时间：2012-05-28T22:50:33.323
> 
> 标签：java, linux, swing, netbeans

NetBeans 教程集中的示例项目仅包含一个 Swing 表单（空 JFrame），可以正常编译和运行，但我无法使用 NetBeans GUI buider 更改表单的布局并在其中添加元素，因为它仅显示带有单个的空占位符“正在加载...”消息。任何如何解决它的线索将不胜感激。

Kubuntu 12.04、Openjdk 1.7、NetBeans 7.0.1，带有活动的 GUI 设计器插件。

日志文件包含错误

`SEVERE [org.openide.util.RequestProcessor]: Error in RequestProcessor org.netbeans.modules.form.FormDesigner$PreLoadTask`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T01:55:29.920

Designer 中的 KNOWN BUG 标记为完成（未加载 Netbeans 7.0.1 GUI 编辑器）。

从 netbeans 获取新版本。

似乎是同样的问题。

报告：...我所有的项目都使用 SWING 组件，当我单击“设计”切换器时，为了在 GUI 中进行更改，它显示标签“正在加载”，我收到以下错误：...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T20:06:06.883

我在 Gentoo 系统上与 NetBeans-7.2 有非常相似的问题（唯一的区别是日志中的另一个错误：）`java.lang.ClassNotFoundException: org.w3c.dom.ElementTraversal`。解决方案是安装`dev-java/batik`包并启动 NetBeans

```
netbeans-7.2 -cp:a /usr/share/batik-1.7/lib/batik-ext.jar 
```

这些额外的参数可以添加到`netbeans_default_options`中`/etc/netbeans-7.2/netbeans.conf`以进行永久修复。更多信息可以在[这里](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=653915)和[这里](https://forums.gentoo.org/viewtopic-p-7233044.html)找到。

# objective-c - #define 或 #if 语句错误

> ID：10791222
> 
> 赞同：5
> 
> 时间：2012-05-28T22:50:33.640
> 
> 标签：objective-c, if-statement, c-preprocessor

我已经阅读了许多#if 和#define 语句的定义。
我尝试使用我阅读的方式，但仅在将其定义为以下注释的行上出现错误“ **Invalid token at start of a preprocessor expression ”：**

```
#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

#define is_ipad         (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
#define is_ipad_hd      ( (is_ipad == 1 && [UIScreen mainScreen].bounds.size.width > 1024 ) ? YES : NO)
#define is_iphone_hd    ([UIScreen mainScreen].bounds.size.width > 480 ? YES : NO)
#define device_width    480.0f
#define device_height   320.0f

#if (is_ipad_hd == YES) // Error here
  #define device_width       = 2048.0f
  #define device_height      = 1496.0f
#endif 
```

为什么它在简单的教程中起作用，当我们尝试更复杂的事情时，这些事情就会发生！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T22:57:13.180

这些是预处理器指令，因此您无权访问 [UIScreen mainScreen] 方法和编译时定义的所有其他对象！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:00:19.313

宏评估发生在编译时。

但是，`(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)`or`[UIScreen mainScreen]`只能在运行时进行解释。

除此之外，您不应该依赖屏幕尺寸来为您做脏活。相反，您应该依赖用户界面惯用语和主屏幕的比例：

```
BOOL isiPad = UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad;
BOOL isHD = [[UIScreen mainScreen] scale] == 2.0;

if (isiPad) {
  if (isHD) {
    // retina iPad
  } else {
    // non-retina iPad
  }
} else {
  if (isHD) {
    // retina iPhone/iPod touch
  } else {
    // non-retina iPhone/iPod touch
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:02:05.667

同意这里的其他人，尽管我不太精通 C 预处理器，但快速谷歌搜索返回：

expression 是整数类型的 C 表达式，受到严格的限制。[**它可能包含......比我在源代码**](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html#SEC32)中快速实现的格式要好得多[。](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html#SEC32)[](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html#SEC32)

# javascript - Javascript 浏览器插件是否已启用？

> ID：10791229
> 
> 赞同：0
> 
> 时间：2012-05-28T22:51:48.847
> 
> 标签：javascript, jquery, google-maps, google-earth, google-earth-plugin

我正在使用 Google 地球做一些事情，想知道 Google 地球的浏览器插件是否已启用（注意：**插件已安装但已禁用的**情况）

我打算如何做到这一点。1.检测插件是否安装完成使用`google.earth.isSupported();` 2.检测插件是否已启用（**这就是问题所在**）

想知道如果插件已安装但已禁用，是否需要检测？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:57:06.300

该插件在任何一种情况下都不可用。无法检查它是否已安装但已禁用。浏览器根本不会向脚本公开禁用的插件。

# jquery - JQuery 克隆的页面链接不起作用

> ID：10791234
> 
> 赞同：1
> 
> 时间：2012-05-28T22:52:09.170
> 
> 标签：jquery, clone, hyperlink

我在页面顶部动态创建页面链接。完成所有工作后，我将页面链接包装器克隆到位于下部页面的 div 中。问题是，克隆的页面链接在单击时什么也不做。如果元素被克隆，这甚至可能吗？或者我怎样才能将我的页面链接也复制到页面底部？

```
<div id="pages"></div>

<div id="workspace"><br/></div>

<div id="pagesclone"></div>

//create the page links
for (x = 0; x < 6; x++) {
    $('#pages').append(' <a href="#" class="links">' + x + '</a> ');    
}

//function for when a link is clicked
$('.links').click(function() {
   current = $(this).html();
   $('#workspace').html('You clicked ' + current);
});

//clone to the lower page
$('#pages').clone().appendTo('#pagesclone'); 
```

jsfiddle：http: [//jsfiddle.net/JshnC/4/](http://jsfiddle.net/JshnC/4/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:53:36.910

如果您还想克隆事件，请传入`true`括号：

```
var foo = $(bar).clone(true); 
```

您可以更深入，也可以使用第二个参数克隆子事件：

```
var foo = $(bar).clone(true, true); 
```

来源：[http ://api.jquery.com/clone/](http://api.jquery.com/clone/)

### 警告

我看到您在元素上使用了 id 属性 -`.clone`将导致在您的文档中使用重复的 id。如果可能的话，避免使用 id 来支持将被克隆的元素上的类。

# django - 用于现代浏览器检测的 Django 应用程序或中间件

> ID：10791238
> 
> 赞同：0
> 
> 时间：2012-05-28T22:52:35.927
> 
> 标签：django, twitter-bootstrap

我创建了一个使用来自 Twitter 的 Bootstrap 的 Django 站点。我已经在最新版本的 Chrome、FireFox 和 Safari 上测试了该网站。它看起来真的很好。然后我们有了 Internet Explorer（播放失败的音乐……wonk、wonk、wooonk）。它似乎工作正常，但看起来不太好（例如，没有圆角等）。我想要的是检测 IE，然后将它们重定向到一个页面，告诉他们 IE 用户可能会遇到问题，并且强烈建议使用更兼容的浏览器。但是，不幸的是，我不能强迫他们不使用 IE。所以，我需要添加一个标志，表明他们已经显示了页面。有谁知道做这样的事情的应用程序/中间件？我已经做了一些谷歌搜索，但真的没有找到任何东西。

我不认为写起来会非常困难，但我宁愿不重新发明轮子。

版本信息：Django 1.3.1；引导程序 2.0.2 和 jQuery 1.7.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:03:31.170

如果[http://djangosnippets.org](http://djangosnippets.org)上没有任何东西可以做到这一点（我怀疑有，TBH），写它 - 因为就像你说的那样，这并不难 - 并贡献它

# sql - SQL Server - 可能的枢轴解决方案？

> ID：10791247
> 
> 赞同：1
> 
> 时间：2012-05-28T22:54:14.700
> 
> 标签：sql, pivot

我有一个非常简单的问题，在网上很难找到。也许我正在搜索不正确的关键字，所以我想停下来问问你们，因为你们的网站对我的学习很有帮助。看下面的场景：

从 mystudies 中选择 student，count(*) 作为 Total，（未知变量：book1、book2、book3、book4 等...）。

基本上，我想做的就是列出与总数匹配的唯一学生 ID 的所有书籍。有人可以为我指出正确的方向，读好书或其他任何东西，这样我就可以朝着正确的方向迈出一步吗？我假设它将通过左连接完成（不确定如何执行 x1、x2、x3 部分），然后只需通过唯一的学生 ID 号（无重复）将两者链接起来，但在线上的每个人都指向枢轴但出现枢轴将所有行放入列而不是一列。SQL server 2005 是首选平台。

谢谢！

对不起

以下查询为表中所有重复条目生成我的唯一 ID（学生）和学生计数：

```
select student, count(*) as Total 
from mystudies
group by student order by total desc 
```

我不知道的部分是如何在表唯一 id (boookid) 上创建左连接

```
select mystudies1.student, mystudies1.total, mystudies2.bookid 
from  (  select student, count(*) as Total 
         from mystudies
         group by student
      ) mystudies1
      left join 
      (  select student, bookid 
         from mystudies
      ) mystudies2 
         on mystudies1.student=mystudies2.student
order by mystudies1.total desc, mystudies1.student asc 
```

显然，上面的行将产生类似于以下的结果：

```
Student    Total  BookID
000001    3        100001
000001    3        100002
000001    3        100003
000002    2        200001
000002    2        200002
000003    1        300001 
```

但我真正想要的是类似于以下内容：

```
Student    Total  BookID
000001     3      100001, 100002, 100003
000002     2      200001, 200002
000003     1      300001 
```

我认为它必须在左连接中完成，这样它就不会改变对学生执行的实际计数。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T09:34:04.357

在 SQL-Server 中使用 FOR XML 路径方法：

```
SELECT  Student,
        Total,
        STUFF(( SELECT  ', ' + BookID
                FROM    MyStudies books
                WHERE   Books.Student = MyStudies.Student
                FOR XML PATH(''), TYPE
                ).value('.', 'VARCHAR(MAX)'), 1, 2, '') AS Books
FROM    (   SELECT  Student, COUNT(*) AS Total
            FROM    myStudies
            GROUP BY Student
        ) MyStudies 
```

我之前已经完整解释了 XML PATH 方法是如何工作[的](https://stackoverflow.com/questions/10381512/what-this-query-does-to-create-comma-delimited-list-sql-server/10381975#10381975)。[随着对我的回答的进一步改进，这里](https://stackoverflow.com/questions/5031204/does-t-sql-have-an-aggregate-function-to-concatenate-strings/5031297#5031297)指出

[SQL Server 小提琴](http://sqlfiddle.com/#!3/5217f/1)

* * *

在 MySQL AND SQLite 中，您可以使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数：

```
SELECT  Student, 
        COUNT(*) AS Total, 
        GROUP_CONCAT(BookID) AS Books
FROM    myStudies
GROUP BY Student 
```

[MySQL 小提琴](http://sqlfiddle.com/#!2/5217f/2)

[SQLite 小提琴](http://sqlfiddle.com/#!5/5217f/1)

* * *

在 Postgresql 中，您可以使用[ARRAY_AGG](http://www.postgresql.org/docs/8.4/static/functions-aggregate.html)函数：

```
SELECT  Student, 
        COUNT(*) AS Total, 
        ARRAY_AGG(BookID) AS Books
FROM    myStudies
GROUP BY Student 
```

[Postgresql 小提琴](http://sqlfiddle.com/#!1/5217f/2)

* * *

在 oracle 中，您可以使用[LISTAGG](http://www.oracle-base.com/articles/misc/string-aggregation-techniques.php)函数

```
SELECT  Student, 
        COUNT(*) AS Total, 
        LISTAGG(BookID, ', ') WITHIN GROUP (ORDER BY BookID) AS Books
FROM    myStudies
GROUP BY Student 
```

[Oracle SQL 小提琴](http://sqlfiddle.com/#!4/5217f/4)

* * *

# android - Android - 防止人们改变音量

> ID：10791250
> 
> 赞同：4
> 
> 时间：2012-05-28T22:54:46.117
> 
> 标签：android

只要打开应用程序，我怎么能不允许用户更改设备的音量？，如果可能的话。

我发现您可以使用 AudioManger 将音量设置为静音：

```
AudioManager volumeControl = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
volumeControl.setStreamMute(AudioManager.STREAM_MUSIC, true); 
```

然而，这不是我要找的。我希望当用户进入应用程序时锁定其当前音量并且不允许更改它，而在后台播放旋律增加音量。（这就是我不想让用户控制音量的原因）

我在想是否有可能覆盖音量增大、音量减小键？就像我们可以覆盖后退按钮一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T23:14:52.923

> 我在想是否有可能覆盖音量增大、音量减小键？就像我们可以覆盖后退按钮一样。

是的，你可以用同样的方式处理它。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ((keyCode == KeyEvent.KEYCODE_VOLUME_DOWN)){
        //Nothing
    }
    return true;
} 
```

@sarnold 如果是闹钟，我可以看到用例。许多人希望闹钟中的此功能能够阻止自己在想要醒来时关闭声音。

无论哪种方式，请注意您可能会惹恼您的用户做这样的事情。如果可能的话，应该避免它。

**编辑：设置音量**

```
 AudioManager am =  (AudioManager) getSystemService(AUDIO_SERVICE); 
    am.setStreamVolume(AudioManager.STREAM_MUSIC,6,0); 
```

# jquery - 如果 $(this) 引用了元素，则检索 .data() 有效，但 $('#id_of_element') 引用的元素无效

> ID：10791254
> 
> 赞同：0
> 
> 时间：2012-05-28T22:55:42.713
> 
> 标签：jquery, jquery-plugins, jquery-selectors

我正在编写一个 jQuery 插件，需要添加`.data()`到插件内的元素并稍后检索它。当我在一个元素上运行该方法时，当通过它的 id 引用元素时，我无法检索存储的数据，例如：

```
$('#name_of_the_element') 
```

如果我使用引用元素，我可以访问数据`$(this)`。

我究竟做错了什么？

这是 jQuery 插件的代码和我在其中使用它的 html 文件的代码：

jQuery插件：

```
(function( $ ){

    var methods = {

        checkit : function(options) {

            return this.each(function(){

                var $this = $(this);

                $this.data('testdata','this is what i need to see');

            }); 
        }

    }

  $.fn.demoplug = function( method ) {        
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.checkit.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.antigravity' );
    }    

  };

})( jQuery ); 
```

HTML 文件：

```
<div role="main" id="main">
    <ul id="miniatures">
        <li><img src="img/thumbs/thumb-01.jpg"></li>
        <li><img src="img/thumbs/thumb-02.jpg"></li>            
        <li id="mov3"><img src="img/thumbs/thumb-03.jpg"></li>
        <li><img src="img/thumbs/thumb-04.jpg"></li>            
        <li><img src="img/thumbs/thumb-05.jpg"></li>
    </ul>
</div>

<script src="js/libs/jquery-1.7.2.min.js"></script>
<script src="js/libs/jquery.demoplug.js"></script>
<script>

    $(document).ready(function(){

        $('li#mov3').demoplug('checkit');

        alert( $('li#mov3').data('checkit') );  // not working

        $('li#mov3').click(function(){

            alert( $(this).data('testdata') );  // works

        });
    });

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:05:19.370

```
 alert( $('li#mov3').data('checkit') );  // not working 
```

这是因为您正在获取数据中的“checkit”键，但您将键设置为“testdata”：

```
 $this.data('testdata','this is what i need to see'); 
```

将其更改为此将起作用：

```
 alert( $('li#mov3').data('testdata') ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:07:05.110

啊，错误是在错误的地方！我从我正在处理的插件中提取了这段代码，以显示我认为错误的地方，但真正的错误是在插件内部我正在使用 .clone() 方法和我对 .clone() 方法的错误使用犯了这个错误——它加倍了 LI 元素的 ID，所以我得到了 2 个 id="mov3" 的 LI。我没有阅读足够的文档来查看使用 .clone() 时克隆了哪些内容。谢谢大家的回答！

# assembly - 向程序集 x86 插入新指令时的堆栈帧大小？

> ID：10791255
> 
> 赞同：2
> 
> 时间：2012-05-28T22:56:01.303
> 
> 标签：assembly, x86, gnu, fedora, stack-frame

如果我在堆栈帧中插入新的函数和指令来汇编 x86 代码，是否有必要增加堆栈大小？如果是的话是多少？

```
sub 0x4, %esp
push %eax                 ;;new instruction
...
call  fun                 ;; new inserted function
pop  %eax                 ;;new instruction 
.....
add 0x4, %esp 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:03:22.283

[调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions)是管理如何调用函数、传递和返回值以及如何管理堆栈空间和可用寄存器的关键。有很多约定。知道你的函数使用的是哪一个，你调用的函数使用的是哪一个；他们可能不一样！

一个非常常见的约定是“管理你自己的堆栈”。在这种情况下，每个函数都会在堆栈上分配所需的堆栈空间量。它不需要担心它调用的函数的堆栈空间需求；根据定义，他们将分配他们需要的（额外的）堆栈空间。

“叶”函数是不调用其他函数的函数；每个叶子函数都需要一些堆栈空间。一些调用约定要求叶函数的调用者不仅为其自身需要分配空间，而且为其调用的所有叶函数分配空间。这将调用叶函数（被调用最多！）的开销降至最低。通常这种安排只由编译器完成，因为人们很难可靠地跟踪他们调用的所有函数以及这些函数的堆栈需求。有时您可能会遇到一个手写的汇编函数，该函数在其 API 中声明调用者必须为其分配空间。

System V ABI 在 SP 下方提供了一个大约 128 字节堆栈的“红色区域”，这些堆栈*始终*可供叶函数使用。这意味着调用者不需要分配该空间，并且小于红色区域大小需求的叶函数只需使其可用而不分配它。这是一个非常好的约定，因为没有函数不必担心它是否正在调用叶函数，这使得可以将任意组例程链接在一起。

# core-animation - CGAffineTransform：将比例应用于翻译，如何？

> ID：10791261
> 
> 赞同：0
> 
> 时间：2012-05-28T22:56:18.930
> 
> 标签：core-animation, cgaffinetransform, affinetransform

Apple 使用的仿射变换将“比例”定义为“不影响翻译”

在我看来，这完全错误，并且与我对正常仿射变换的期望不符（其中比例乘以平移确实会影响平移），并且使得处理现实世界的问题变得极其困难，其中“缩放”预计将缩放整个坐标系，而不仅仅是一次单个对象的局部坐标。

Apple 的库中是否有解决此问题的安全方法（即使“比例”适用于整个矩阵，而不仅仅是非翻译部分）？

还是我犯了一个愚蠢的错误，完全误解了缩放发生了什么，不知何故？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:09:45.417

我很确定这只是意味着它不会影响矩阵中的翻译值。CGAffineTransform 不是某种特殊的数学品牌，它只是一个常规的变换矩阵。它与您曾经使用过的任何其他转换矩阵一样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:35:29.207

啊。尴尬。我的错误： concat 的论点是错误的！至少我可以把它留在这里，希望能帮助下一个人犯下这样一个愚蠢的错误。

1.  我以错误的方式进行了 Concat 调用；显然，“翻译”“比例”按预期工作 - 比例不会影响翻译！

2.  当我在谷歌上搜索这个问题时，我找到了几个关于 CGAffineTransform 进行缩放和独立翻译的页面。确认偏差:(我读到了，并认为这是真的。Doh。

仅供参考： CGAffineTransformConcat( A, B ) ... 执行： Matrix A * Matrix B ... 即“首先是 A 的效果，然后是 B 的效果”

因此，请确保您的缩放矩阵是第二个参数（如果您有一系列嵌套的 Concat 调用，则为“稍后”参数）。

# iphone - 使用 ASIHTTPRequest 下载 plist 只能部分工作

> ID：10791267
> 
> 赞同：0
> 
> 时间：2012-05-28T22:57:08.847
> 
> 标签：iphone, objective-c, save, plist, asihttprequest

我有一个游戏，可以玩不同的类别。这些类别基本上是 plist 文件。因此，如果将来我想添加 plist，用户应该能够下载 plist 并玩新的关卡。所以我的目标是：

*   从 URL 下载 .plist
*   将 .plist 文件保存在 iphone 上的文档目录中（永远）
*   使用 .plist

这是我所做的并且它有效（控制台日志“完成！”），但如果我检查文件是否在文档目录中，则没有响应（布尔文件存在保持否）。

```
-(void)startGame:(id)sender{
    NSArray *categoriesArray = [[GameStateSingleton sharedMySingleton] categoriesArray];
    NSString *category = [NSString stringWithFormat:[categoriesArray objectAtIndex:[sender tag]]];

    NSString *thePath = [mainPath stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.plist",category]];
    NSDictionary *categoryPlist = [NSDictionary dictionaryWithContentsOfFile:thePath];

    if(categoryPlist != nil){
        [[GameStateSingleton sharedMySingleton]setCurrentCategory:category];
        [[GameStateSingleton sharedMySingleton]updateHexCountAndInitalTime];
        [[CCDirector sharedDirector]replaceScene:[CCTransitionFade transitionWithDuration:TRANSITIONDURATION scene:[LevelSets scene]]]; 
    }
    else{

        [self plistForCategory:category];
        NSString* documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
        NSString *myCategory= [documentsPath stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.plist",category]];
        BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:myCategory];
        if(fileExists == YES){
            [[GameStateSingleton sharedMySingleton]setCurrentCategory:category];
            [[GameStateSingleton sharedMySingleton]updateHexCountAndInitalTime];
            [[CCDirector sharedDirector]replaceScene:[CCTransitionFade transitionWithDuration:TRANSITIONDURATION scene:[LevelSets scene]]]; 
            NSLog(@"category exists now");
        }
    }

}

-(void)plistForCategory:(NSString*)category
{

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];

    NSURL *url = [NSURL URLWithString:[ NSString stringWithFormat:@"http://www.tinycles.com/wannaplay/plists/%@.plist",category]];

    ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
    [request setDownloadDestinationPath:documentsDirectory];
    [request setDelegate:self];
    [request startAsynchronous];

}

- (void)requestFinished:(ASIHTTPRequest *)request 
{
    NSLog(@"finished !!");
}

- (void)requestFailed:(ASIHTTPRequest *)request
{
    // Download failed. This is why.
    NSError *error = [request error];
    NSLog(@"%@", error);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:35:26.177

也许问题是因为您正在启动异步请求，所以如果请求尚未完成，您`if(fileExist==YES)`仍然返回 NO；在这种情况下，我建议您启动同步请求：

```
- (IBAction)startRequest:(id)sender
{
  NSURL *url = [NSURL URLWithString:LINK_TO_PLIST];
  ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
  [request setDownloadDestinationPath:DOC_PATH];
  [request startSynchronous];
  NSError *error = [request error];
  if (!error) {
      //start your game after the file is downloaded
  }
} 
```

# jquery - JQuery 和 Rails...使用 AJAX 与 HTML 标头提交

> ID：10791270
> 
> 赞同：0
> 
> 时间：2012-05-28T22:57:23.017
> 
> 标签：jquery, ruby-on-rails, ajax, jquery-events

这个有点独特……

我有一系列复选框图像，当它们被点击时，表单提交......使用以下Javascript：

```
$('#pin_rose').simpleImageCheck({
  image: '/images/rose.png',
  imageChecked: '/images/one.png'
   })
  .change(function() {
    var c = 'checked';
    if (!$('#pin_rose').is(':checked')) {
      $(this).closest('form').submit();
    }
    $(this).closest('form').submit();

}); 
```

但是，我希望表单在 rails 3 环境中使用 ajax 提交，这样页面就不会重新加载......

在我的 _edit.html 部分中，我有以下内容：

```
<%= form_for([@posts, @pin], :html => {:multipart => true}, :remote => true) do |f| %> 
```

在我的 pins_controller.rb 控制器中，我有：

```
def update
...
    respond_to do |format|
      if @pin.update_attributes(params[:pin])
        format.html { redirect_to @post }
        format.js
      else
        format.html { redirect_to '/static_pages/login' }
        format.js
      end
...
end 
```

然后在我的 update.js.erb 我有

```
$("#new_pins").append("<h1>new pin added</h1>") 
```

问题是当我单击图像时，表单提交并添加数据，但它重定向，而不是使用 ajax。

有没有办法让 Rails 覆盖`$(this).closest('form').submit();`Javascript 调用，使其不作为 html 提交？

我知道我可以在 Javascript 中进行标准的 ajax 调用，但我不希望这样做，因为我需要在将来提取对象（“添加的新引脚”只是现在）。

**更新：** 跑耙路线...

```
 users POST /users(.:format)                           users#create
        new_user GET  /users/new(.:format)                       users#new
            user GET  /users/:id(.:format)                       users#show
       post_pins POST /posts/:post_id/pins(.:format)             pins#create
    new_post_pin GET  /posts/:post_id/pins/new(.:format)         pins#new
   edit_post_pin GET  /posts/:post_id/pins/:id/edit(.:format)    pins#edit
        post_pin PUT  /posts/:post_id/pins/:id(.:format)         pins#update
           posts POST /posts(.:format)                           posts#create
        new_post GET  /posts/new(.:format)                       posts#new
       edit_post GET  /posts/:id/edit(.:format)                  posts#edit
            post GET  /posts/:id(.:format)                       posts#show
                 PUT  /posts/:id(.:format)                       posts#update
           login      /login(.:format)                           static_pages#login
           about      /about(.:format)                           static_pages#about
                      /posts(.:format)                           posts#new 
```

第二次更新

主要问题是`$('#myform').submit();`提交为html。有没有办法将其更改为改为 format.js ？我也试过这个无济于事：

```
<%= f.check_box :rose, :onchange => '$(this.form).submit();' %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:52:20.587

我会明确命名表格，即：

```
<%= form_for([@posts, @pin], 
   :remote => true, 
   :html => {:multipart => true, :id=>'myform'} ) do |f| %> 
```

然后在你的javascript中：

```
$('#myform').submit(); 
```

# hibernate - 一对多休眠

> ID：10791273
> 
> 赞同：0
> 
> 时间：2012-05-28T22:57:38.387
> 
> 标签：hibernate, jsf-2, one-to-many

我有这种一对多的关系。这是我的一张桌子。

```
private Set<Images> imagesContainer = new HashSet<Images>(0);

@OneToMany(fetch = FetchType.LAZY, mappedBy = "container")
public Set<Images> getImagesContainer() {
    return this.imagesContainer;
}

public void setImagesContainer(Set<Images> imagesContainer) {
    this.imagesContainer = imagesContainer;
} 
```

这是我的许多表：

```
private Container container;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "id_container", nullable = false)
public Container getContainer() {
    return this.container;
}

public void setContainer(Container container) {
    this.container = container;
} 
```

我如何使用休眠插入一个带有许多容器的新容器。我会试试这个：

```
...
Set<Images> images=new HashSet<Images>();
images.add(img1);
images.add(img2);

Container c = new Container();
c.setImagesContainer(images);
....

@Override
@Transactional(propagation=Propagation.REQUIRED)
public void save(Container c){
   getHibernateTemplate().save(c);
} 
```

不要工作！！！我得到“嵌套异常是 org.hibernate.exception.DataException：无法插入：...”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:08:04.107

正如您`mappedBy = "container"`在`Container`实体中指定的那样，关系的所有者是`Images`实体。这意味着休眠将确定`Container`与`Images`实体之间的关系使用`image.getContainer()`

因为您没有将任何容器实例设置为`images`代码片段中所有实例的容器属性，所以`image.getContainer()`返回`NULL`并因此休眠将认为所有`image`实例都不与任何`Container`实例相关联。它将插入不允许 NULL ( )`NULL`的`Container`table列，因此会发生错误。`id_container``nullable = false`

为了解决这个问题，你应该设置实例的`container`属性：`Image`

```
Container c = new Container();
img1.setContainer(c);
img2.setContainer(c); 
session.save(c); 
```

# html - ext js 对象取目标元素的样式

> ID：10791278
> 
> 赞同：0
> 
> 时间：2012-05-28T22:58:19.640
> 
> 标签：html, extjs

我有 ExtJs 2.2

我在 JSP 中有这个输入：

```
 <td class="myStyle" bgcolor="someColor"><div align="left">
    <input name="myInput" type="text" id="myInput" value="" size="30" maxlength="40">
    </div></td> 
```

然后我有这个：

```
 Ext.onReady(function(){
       new Ext.form.NumberField({  
       allowDecimals: false,
       allowNegative: false,
       cls:'',
       emptyClass:'',
       emptyText:'',
       fieldClass:'',
       focusClass:'',
       invalidClass:'',
       invalidText:'',
       disableClass:'',
       grow: false,
       maxLenght: 40,
        applyTo: document.getElementById("myInput")
  });
 }); 
```

但是，它改变了输入的风格......有没有办法保留 myInput 的风格？

编辑：

昨天我还注意到，我将 Extjs 输入置于 html 输入之上！.. 所以我将 HTML 代码更改为：

```
 <td class="myStyle" bgcolor="someColor"><div align="left" id='myInputDiv'>
    </div></td> 
```

和 extjs 代码：

```
 Ext.onReady(function(){
       new Ext.form.NumberField({  
       allowDecimals: false,
       allowNegative: false,
       cls:'',
       emptyClass:'',
       emptyText:'',
       fieldClass:'',
       focusClass:'',
       invalidClass:'',
       invalidText:'',
       disableClass:'',
       grow: false,
       maxLenght: 40,
               id: 'myInput',
               name: 'myInput',
        applyTo: document.getElementById("myInputDiv")
  });
 }); 
```

但是，它看起来仍然与页面中的其他输入不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:13:39.270

在 ExtJs 中，您可以使用 `Ext.select`来选择元素，然后应用您想要的样式。

例如， `Ext.select('.el').setStyle('color', 'green');`将`color:green`属性应用于类**.e1**的所有元素。

# matlab - 将两个矩阵元素与求和相乘

> ID：10791279
> 
> 赞同：3
> 
> 时间：2012-05-28T22:58:22.567
> 
> 标签：matlab

我有两个 4x2 矩阵。我怎样才能实现这样的乘法：输出应该是一个 4x1 矩阵，其中每个元素是原始矩阵中行中元素的乘积之和。像这样：

```
 [1 2;
A =  3 4; 
     5 6;
     7 8]

    [1 2;
B =  3 4; 
     5 6; 
     7 8] 
```

结果 C 矩阵将是：

```
 [1*1 + 2*2;
C =  3*3 + 4*4;
     5*5 + 6*6;
     7*7 + 8*8] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:16:43.503

这是一个更简洁的答案：

```
C = dot(A, B, 2); 
```

您基本上想要行的点积。这是 MATLAB 中的一种矢量化运算，因此比元素乘积比求和运算更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:03:20.203

我的 matlab 有点生锈，但试试

```
D = A .* B;
C = D(:,1) + D(:,2); 
```

第一个操作将生成一个 4x2 矩阵，其中包含来自 A 和 B 的相应元素的乘积，而第二个操作将来自同一行的乘积相加。

您正在寻找的结果也是矩阵产品的对角线元素，因此您可以使用

```
C = diag(A * transpose(B)); 
```

尽管这对于较大的矩阵来说效率非常低。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T23:15:34.417

Aasmund Eldhuset 大部分是正确的，但我相信最后一行应该是

```
 C = D(:,1) + D(:,2); 
```

因为您想对最后一列中的每一行求和

# c++ - 如何在c中使用IWbemContext的“__ProviderArchitecture”标志？

> ID：10791282
> 
> 赞同：3
> 
> 时间：2012-05-28T22:58:37.387
> 
> 标签：c++, windows, visual-c++, wmi

我一直在尝试按照以下[MSDN 教程](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393067%28v=vs.85%29.aspx)从 32 位应用程序中查询 64 位注册表提供程序。

可悲的是，这些示例都是用 VB 编写的，我遇到了一些问题。

对于 C++ 开发人员，文章提到...

> C++ 应用程序可以使用 IWbemContext 接口和 IWbemServices::ExecMethod 将非默认提供程序的使用传达给 WMI。

...虽然，当您查看示例 VB 代码时，上下文对象也用于`ConnectServer`方法中：

```
Set objCtx = CreateObject("WbemScripting.SWbemNamedValueSet")
objCtx.Add "__ProviderArchitecture", 32
Set objLocator = CreateObject("Wbemscripting.SWbemLocator")
Set objServices = objLocator.ConnectServer("","root\default","","",,,,objCtx)
Set objStdRegProv = objServices.Get("StdRegProv") 
```

我试过在 VC++ 中重现这个：

```
HRESULT res;
CComPtr<IWbemContext> ctx;
if (!create_registry_redirection_context_(hive, ctx)) {
    return false;
}

res = locator_->ConnectServer(CComBSTR(namespace_.c_str()),     // Namespace to use
                              0,                                // Current security context (username)
                              0,                                // Current security context (password)
                              0,                                // Use current locale
                              WBEM_FLAG_CONNECT_USE_MAX_WAIT,   // Return if connexion is unsuccessful after 2 minutes
                              0,                                // Name of the domain  of the user to authenticate
                              ctx,                              // Optional context
                              &service_);                       // Fill this pointer 
```

该`create_registry_redirection_context_`方法用于`CoCreateInstance`实例化我的上下文，我使用以下几行来设置架构：

```
CComVariant value_arch(64, VT_I4);
ctx->SetValue(L"__ProviderArchitecture", 0, &value_arch); 
```

现在的问题是，该`ConnectServer`方法返回一个错误（0x80041008 - WMI 无效参数）。如果我注释掉该`ctx->SetValue(L"__ProviderArchitecture", 0, &value_arch);`行，一切正常，但当然，我最终会查询 32 位注册表提供程序。

我也尝试在通话期间不设置任何上下文`ConnectServer`，但仅在`ExecMethod`通话期间（如 MSDN 文章中所述），但虽然我没有收到任何错误，但我仍在查询 32 位提供程序，但没有看到我的 64 位注册表项。

我究竟做错了什么？在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T07:30:51.783

我知道，这有点晚了，但是对于存档（并且因为 MS 无法提供这样的示例）：

```
 HRESULT hres;
  IWbemLocator *pLoc = NULL;
  hres = CoCreateInstance(CLSID_WbemLocator, 0, CLSCTX_INPROC_SERVER, IID_IWbemLocator, (LPVOID *) &pLoc); 
  if (FAILED(hres))
  {
    m_nExitCode = TCP1;
    return FALSE;
  }

  IWbemContext *pContext = NULL;
  hres = CoCreateInstance(CLSID_WbemContext, 0, CLSCTX_INPROC_SERVER, IID_IWbemContext, (LPVOID *) &pContext); 
  if (FAILED(hres))
  {
    m_nExitCode = TCP1_2;
    return FALSE;
  }

  VARIANT vArchitecture;
  VariantInit(&vArchitecture);
  V_VT(&vArchitecture) = VT_I4;
  V_INT(&vArchitecture) = 64;
  hres = pContext->SetValue(_bstr_t(L"__ProviderArchitecture"), 0, &vArchitecture);
  VariantClear(&vArchitecture);

  //VARIANT vRequiredArchicture;
  //VariantInit(&vRequiredArchicture);
  //V_VT(&vRequiredArchicture) = VT_BOOL;
  //V_BOOL(&vRequiredArchicture) = VARIANT_TRUE;
  //hres = pContext->SetValue(_bstr_t(L"__RequiredArchitecture"), 0, &vRequiredArchicture);
  //VariantClear(&vRequiredArchicture);

  IWbemServices *pSvc = NULL;

  hres = pLoc->ConnectServer(
     _bstr_t(L"root\\Microsoft\\SqlServer\\ComputerManagement10"), // Object path of WMI namespace
     NULL,                    // User name. NULL = current user
     NULL,                    // User password. NULL = current
     0,                       // Locale. NULL indicates current
     NULL,                    // Security flags.
     0,                       // Authority (for example, Kerberos)
     pContext,               // Context object 
     &pSvc                    // pointer to IWbemServices proxy
     ); 
```

带有RequiredArchitecture 的块未经测试，似乎没有必要。PS：错误处理需要改进！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T16:58:41.737

你看过 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa393067(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393067(v=vs.85).aspx) 并尝试设置 "__RequiredArchitecture" = TRUE 吗？

还必须首先尝试使其以相同代码显示的方式（即 64 位到 32 位）工作？

# c# - 从 C++ 库方法返回的“char*”中获取 C# 字符串？

> ID：10791284
> 
> 赞同：2
> 
> 时间：2012-05-28T22:58:39.470
> 
> 标签：c#, c++, visual-studio-2010, visual-c++

我有一个在我的 C# 应用程序中使用的 C++ 库。C++ 库中的一种方法返回一个`char *`. 如何`char *`在我的 C# 应用程序中将其转换为字符串？

显然在我的 C# 应用程序中，此方法返回的数据类型是`sbyte *`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:04:37.943

`String`有[一个构造函数，它采用`char*`](http://msdn.microsoft.com/EN-US/library/6y4za026.aspx)：

```
char* x = ...
string s = new string(x); 
```

[另一个需要`sbyte*`](http://msdn.microsoft.com/en-us/library/k9s9t975)一个：

```
sbyte* x = ...
string s = new string(x); 
```

# c++ - 更智能地循环排列

> ID：10791289
> 
> 赞同：3
> 
> 时间：2012-05-28T22:59:14.443
> 
> 标签：c++, algorithm

我有一个 3 x 3 的布尔值网格，我对我可以拥有三个“活”单元格的方式感兴趣（据我计算，有 56 个排列）。旋转对称无关紧要，但活细胞彼此无法区分。

假设我正在索引网格中相对于质心的值：

```
-------------------
|-1,-1| 0,-1| 1,-1|
-------------------
|-1,0 |     | 1,0 |
-------------------
|-1,1 | 0,1 | 1,1 |
------------------- 
```

是否有一个很好的循环可以用来计算 56 个排列？（我刚刚把它全部打完，我很想知道我是否可以稍微聪明一点）。

我正在使用 C++，但如果很清楚，基本算法在任何语言或伪语言中都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:04:22.433

您可以使用[next_permutation](http://www.sgi.com/tech/stl/next_permutation.html)。

例如，假设字符串下面 x 中的每个字符代表网格中的一个单元格（质心单元格除外），从左上角开始到右下角。您可以运行此代码来查找所有可能的排列，并且在循环内，字符串 x 将代表一种可能的排列，其中 1 是活细胞，而 0 是死细胞。

```
int main() {
  string x = "00000111";
  int cnt = 0;
  do {
    ++cnt;

    // do something useful with this configuration...

  } while(next_permutation(x.begin(),x.end()));
  cout<<cnt<<endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:04:02.900

从 Wikipedia尝试[此过程。](http://en.wikipedia.org/wiki/Permutation#Generation_in_lexicographic_order)

> 以下算法在给定排列之后按字典顺序生成下一个排列。它就地改变了给定的排列。
> 
> 1.  找到满足 a[k] < a[k + 1] 的最大索引 k。如果不存在这样的索引，则排列是最后一个排列。
> 2.  找到最大的索引 l 使得 a[k] < a[l]。由于 k + 1 是这样一个索引，所以 l 是很好定义的并且满足 k < l。
> 3.  将 a[k] 与 a[l] 交换。
> 4.  反转从 a[k + 1] 到最后一个元素 a[n] 的序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:14:10.033

你可以使用这个方法：

假设你用一个数组表示你的网格，你的元素在哪里

```
[(-1,-1), (0,-1),(1,-1)...] 
```

依此类推，你基本上在第一行取元素，然后是第二行，然后是第三行。

所以现在，你只需要获取所有可用的数字，也就是说：

```
[1,1,1,0,0,0,0,0,0] 
```

正如你所说，你只需要 3 个活细胞。

现在我们已经确定了不同字符串的含义，您可以简单地采用执行置换的代码，例如此链接[如何在 C 中生成置换？](http://techforum4u.com/entry.php/764-How-To-Generate-Permutation-In-C?s=ff4d4f39e832033a81526994f6fe1a19&bt=953#comment953) hich 完全符合您的要求，或者算法库中的任何 ohte 等效代码，例如 std::next_permutation。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T02:26:01.153

你更喜欢“**更智能**”的循环还是“更**理智**”的循环？

```
//c++ --std=c++11 test.cc

#include <iostream>
#include <string>
#include <list>
#include <vector>
#include <algorithm>
#include <utility>

using std::string;
using std::list;
using std::vector;

const string show[8] = { "(-1,-1)","( 0,-1)","( 1,-1)"
                       , "(-1, 0)",          "( 1, 0)"
                       , "(-1, 1)","( 0, 1)","( 1, 1)"
                       };

auto permutations_of_living_cells =
    [] (int number_of_living_cells) -> list<vector<string>>
    {
    typedef list<vector<string>> (*recT)( void*
                                        , int
                                        , int
                                        , vector<string> &&
                                        , list<vector<string>> &&
                                        );
    recT rec = []( void*r
                 , int n
                 , int i
                 , vector<string> && prefix
                 , list<vector<string>> && l
                 ) -> list<vector<string>>
        {
        if( n==0 )
            {
            l.push_back(std::move(prefix));
            return std::move(l);
            }
        if( i>8-n ) return std::move(l);
        vector<string> psi(prefix);
        psi.push_back(show[i]);
        return  ((recT)r)(r,n  ,i+1,std::move(prefix),
                ((recT)r)(r,n-1,i+1,std::move(psi   ),
                    std::move(l)
                )
                );
        };
    return rec( (void*)rec
              , number_of_living_cells
              , 0
              , vector<string>()
              , list<vector<string>>()
              );
};

template<class T>
std::ostream& operator<<( std::ostream & out,const vector<T> & v )
{
    if( v.empty() ) return out << "[]";
    out << "[ " << *v.begin();
    std::for_each( v.begin()+1, v.end(), [&](T x){out<<", "<<x;} );
    return out << " ]";
}

int main()
{
    for( auto v : permutations_of_living_cells(3) )
        std::cout << v << "\n";
    std::cout << std::flush;
    return 0;
} 
```

# metadata - 谷歌文本搜索与元数据搜索

> ID：10791291
> 
> 赞同：0
> 
> 时间：2012-05-28T22:59:49.307
> 
> 标签：metadata, search-engine

我对搜索引擎很感兴趣。

今天在一次演讲中，我听说 google 执行文本搜索，而更复杂的引擎可以依赖元数据的使用，这显然不是 google 使用的。

文本搜索和元数据搜索有什么区别？

您能否提供一些链接，让我可以更深入地讨论这个主题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:05:52.257

元数据是 100% 文本。

谷歌不使用它的原因是人们倾向于对他们的内容撒谎（不是故意的。）

现在，谷歌不使用的是关键字元数据标签（尽管他们可能会检查它以查看您是否是骗子......）他们确实使用其他元标签。

我刚刚写了一长串许多系统支持的元标记。我仍然需要添加更多内容，但其中 og:image 和 description 以及其他一些非常有用。

[http://snapwebsites.org/implementation/feature-requirements/layout-feature-core/meta-tags-and-links-supported-core](http://snapwebsites.org/implementation/feature-requirements/layout-feature-core/meta-tags-and-links-supported-core)

# castle-windsor - 模拟温莎城堡的“Per Graph”生活方式

> ID：10791301
> 
> 赞同：1
> 
> 时间：2012-05-28T23:01:32.893
> 
> 标签：castle-windsor, windsor-3.0

我正在尝试模拟温莎的“Per Graph”生活方式，以便以正确的方式解析我的对象。我尝试过 Bound 的生活方式，但没有任何成功，可能是由于缺乏这方面的知识。我需要的内容在以下示例代码中表示：

```
class Program
{
    static void Main( string[] args )
    {
        var container = new WindsorContainer();
        container.Register(
            Component.For<ClassA>().LifestyleBoundTo<ClassC1>(),
            //Component.For<ClassA>().LifestyleBoundTo<ClassC2>(),
            Component.For<ClassB1>().LifeStyle.Transient,
            Component.For<ClassB2>().LifeStyle.Transient,
            Component.For<ClassC1>().LifeStyle.Transient,
            Component.For<ClassC2>().LifeStyle.Transient );

        var c1 = container.Resolve<ClassC1>();
        Assert.AreSame( c1.B1.A, c1.A );

        var c2 = container.Resolve<ClassC2>();
        Assert.AreSame( c2.B2.A, c2.A );

        Assert.AreNotSame( c1.A, c2.A );
    }
}

class ClassA
{
}

class ClassB1
{
    public ClassB1( ClassA a)
    {
        A = a;
    }

    public ClassA A { get; set; }
}

class ClassC1
{
    public ClassC1( ClassA a, ClassB1 b1 )
    {
        A = a;
        B1 = b1;
    }

    public ClassA A { get; set; }
    public ClassB1 B1 { get; set; }
}

class ClassB2
{
    public ClassB2( ClassA a )
    {
        A = a;
    }

    public ClassA A { get; set; }
}

class ClassC2
{
    public ClassC2( ClassA a, ClassB2 b2 )
    {
        A = a;
        B2 = b2;
    }

    public ClassA A { get; set; }
    public ClassB2 B2 { get; set; }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:09:32.597

好的，所以一切都按预期工作。

您的第一个断言按预期通过。第二个按预期失败，因为您正在确定范围`ClassA`，`ClassC1`并且图表中没有该类的实例用于第二个解析。

# html - 创建一个只接受一个密码的字段

> ID：10791303
> 
> 赞同：1
> 
> 时间：2012-05-28T21:32:42.813
> 
> 标签：html, passwords, user-input, post

我知道奇怪的问题，但我需要创建一个只接受一个密码的输入字段，在这种情况下是一个促销代码，所以它可以转到另一个页面，客户可以打印出一些 pdf 和其他类型的详细信息。感谢您抽出宝贵时间，如果您需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:49:21.383

这不需要任何东西，除了您将第 6 行的代码更改为您想要的 PROMO 之外。

```
<form action="" method="POST">
Code: <input name="code" type="text" />
<input name="submit" type="submit"/>
</form>
<?php
if(isset($_POST['submit']))
{
    if($_POST['code'] == "7d7cf9e1")
    {
        echo 'Code accepted.';
        //do something here
    }
    else{
        echo 'Sorry, try again.';
    }
}
?> 
```

您可以根据自己的需要进行调整。

# api - WP7 错误：“远程服务器返回错误：NotFound。”

> ID：10791305
> 
> 赞同：1
> 
> 时间：2012-05-28T23:01:56.240
> 
> 标签：api, windows-phone-7, delicious-api

我有这段代码，它曾经可以工作，但在某个特定时间它停止工作并返回错误“远程服务器返回错误：NotFound。”

```
 WebClient deliciousWebClient = new WebClient();
        deliciousWebClient.Credentials = Credentials;
        deliciousWebClient.DownloadStringAsync(new Uri("https://api.del.icio.us/v1/tags/get"));
        deliciousWebClient.DownloadStringCompleted += (s, ee) =>
        {
            if (ee.Error == null)
            {
                … 
```

关于这个错误有什么建议吗？

在此代码中，错误指向美味的端点，但其他一些服务也发生了同样的错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:06:00.660

该`NotFound`错误是典型的 404 错误，因此 API 端点可能已关闭或您已更改。

我首先使用[Fiddler2](http://fiddler2.com)手动发出请求。这将帮助您确定问题是在您的代码中还是在 API 端。

正如您在下面提到的，很难让 Fiddler 使用 WP7 模拟器。过去当我非常绝望时，我使用的一个技巧是编写一个快速控制台应用程序，该应用程序使用与我的 Windows Phone 应用程序正在执行的代码相同的代码。然后我能够成功拦截流量。事实证明我的请求格式正确。

# ios5 - 使用 Facebook“iOS 原生深度链接”和基于 iOS 5 故事板/segue 的应用程序的 openURL？

> ID：10791307
> 
> 赞同：1
> 
> 时间：2012-05-28T23:02:18.123
> 
> 标签：ios5, uistoryboard, facebook-ios-sdk, uistoryboardsegue

我有一个启用 Facebook 的 iOS 5 应用程序，它使用故事板和基于 segue 的导航，并且对如何实现“iOS 原生深度链接”感到困惑。[改进 iOS 上的应用程序分发中](https://developers.facebook.com/blog/post/2012/02/21/improving-app-distribution-on-ios/)的示例代码仅显示一个`UIAlertView`，但我正在尝试启动两个连续的序列操作。

出于这个问题的目的，我已将应用程序简化为三个视图控制器 `MYCategoryTableViewController`：`MYItemsTableViewController`和`MYItemViewController`. 在正常流程中，应用程序打开到`MYCategoryTableViewController`，其中显示类别表。当用户选择一个类别时，会有一个`MYItemsTableViewController`显示该所选类别的项目表的segue。最后，当一个项目被选中时，会有一个`MYItemViewController`显示项目详细视图的 segue。

`prepareForSegue`from`MYCategoryTableViewController`在目标视图控制器上设置一个表示该类别的属性：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([[segue identifier] isEqualToString:@"ITEMS_SEGUE"]) {
        MYItemsTableViewController *vc = [segue destinationViewController];        
        MYCategory *mycategory = [self.fetchedResultsController objectAtIndexPath:[self.tableView indexPathForSelectedRow]];
        vc.mycategory = mycategory;
    }
} 
```

`prepareForSegue`from`MYItemsTableViewController`在目标视图控制器上设置一个表示该类别的属性：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([[segue identifier] isEqualToString:@"ITEM_SEGUE"]) {
        MYItemViewController *vc = [segue destinationViewController];
        MYItem *myitem = [self.fetchedResultsController objectAtIndexPath:[self.tableView indexPathForSelectedRow]];
        vc.myitem = myitem;
    }
} 
```

**问题：** 我知道我需要在 中实现一些东西`application:openURL`，但不知道下一步该做什么。假设传入的 URL 提供了用于查找`MYCategory`和`MYItem`对象的标识符。我发现`performSegueWithIdentifier`但不确定它如何与目标视图控制器交互`prepareForSegue`以及如何在目标视图控制器上设置模型对象。

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    // get "target_url" from incoming url
    // and parse out MYCategory and MYItem identifiers

    // something like this???
    [self.window makeKeyAndVisible];
    [self.window.rootViewController performSegueWithIdentifier:@"ITEM_SEGUE" sender:self];

    return [facebook handleOpenURL:url];
} 
```

**更新：** [以编程方式选择 tableview 上的单元格不执行关联的 segue](https://stackoverflow.com/questions/10104465/selecting-programmatically-a-cell-on-a-tableview-doesnt-perform-associated-segu)给了我一个想法。也许我只是保存了 url`application:openURL:`并让它`MYCategoryTableViewController`自然加载。然后在期间`viewWillAppear`，调用`tableView selectRowAtIndexPath`然后`performSegueWithIdentifier`过渡到`MYItemsTableViewController`。在 中重复相同的模式，但在调用`MYItemsTableViewController`之前清除 url 。`performSegueWithIdentifier`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T01:55:50.870

这是我的工作。在`MYAppDelegate`中，我捕获了一个表示深度链接 id 的字符串。

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    NSString *deepLinkId;  
    // more code that parses url

    // only deep link if MYCategoryTableViewController is active controller
    UIViewController *rootContoller = self.window.rootViewController;
    if ([rootContoller isKindOfClass:[UINavigationController class]]) {
        UINavigationController *navController = (UINavigationController *)rootContoller;
        if ([navController.topViewController isKindOfClass:[MYCategoryTableViewController class]]) {
            self.deepLinkId = deepLinkId;
        }
    }
} 
```

然后，当`MYCategoryTableViewController`加载时，调用`selectRowAtIndexPath`then `performSegueWithIdentifier`。

```
- (void)processDeepLink {  
    if (_appDelegate.deepLinkId) {
        MYItem *myitem = [MYItem lookupById:_appDelegate.deepLinkId inManagedObjectContext:_appDelegate.dataDocument.managedObjectContext];
        if (myitem) {
            NSIndexPath *indexPath = [self.fetchedResultsController indexPathForObject:myitem.mycategory];
            [self.tableView selectRowAtIndexPath:indexPath animated:NO scrollPosition:UITableViewScrollPositionMiddle];
            [self performSegueWithIdentifier:@"ITEMS_SEGUE" sender:self];
        }
    }
} 
```

在`MYItemViewController`加载时，类似的流程。

```
if (_appDelegate.deepLinkId) {
    MYItem *plate = [MYItem lookupById:_appDelegate.deepLinkId inManagedObjectContext:_appDelegate.dataDocument.managedObjectContext];
    NSIndexPath *indexPath = [self.fetchedResultsController indexPathForObject:plate];
    [self.tableView selectRowAtIndexPath:indexPath animated:NO scrollPosition:UITableViewScrollPositionMiddle];

    _appDelegate.deepLinkId = nil;
    [self performSegueWithIdentifier:@"ITEM_SEGUE" sender:self];
} 
```

`UIApplicationDidBecomeActiveNotification`当应用程序已经打开时，我还必须观察用例。

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(processDeepLink)
                                             name:UIApplicationDidBecomeActiveNotification
                                           object:nil]; 
```

# linux - 在多个 node.js HTTP 进程之间共享一个端口

> ID：10791309
> 
> 赞同：16
> 
> 时间：2012-05-28T23:03:05.780
> 
> 标签：linux, node.js, http, vhosts

我有一个运行着几个 node.js 项目的根服务器。它们应该在自己的进程和目录中单独运行。考虑这个文件结构：

```
/home
+-- /node
    +-- /someProject      | www.some-project.com
    |   +-- index.js
    |   +-- anotherFile.img
    |   +-- ...
    +-- /anotherProject   | www.another-project.com
    |   +-- /stuff
    |   +-- index.js
    |   +-- ...
    +-- /myWebsite        | www.my-website.com
    |   +-- /static
    |   +-- index.js
    |   +-- ...
    +-- ...               | ... 
```

每个 index.js 都应该作为一个单独的进程启动，并将其`cwd`设置为其父文件夹（`someProject`、`anotherProject`等）。

想想 ov 虚拟主机。每个项目启动一个网络服务器，它在自己的域上进行侦听。这就是问题所在。只有一个脚本可以启动，因为它们都尝试绑定到端口 80。我深入研究了 node.js API 并寻找可能的解决方案：[`child_process.fork()`](http://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options).

可悲的是，这不是很好。当我尝试将服务器实例发送到主进程（稍后发出请求）或包含主进程`request`和`response`从主进程到从属进程的对象时，我得到了错误。这是因为 node.js 在内部尝试将这些高级对象转换为 JSON 字符串，然后将其重新转换为其原始形式。这使得所有对象都失去了它们的引用和功能。

第二种方法*`child.js`*

```
var http = require("http");

var server = http.createServer(function(req, res) {
    // stuff...
});
server.listen(80);

process.send(server); // Nope 
```

第一种方法*`master.js`*

```
var http = require("http"),
    cp = require("child_process");

var child = cp.fork("/home/node/someProject/index.js", [], { env: "/home/node/someProject" });

var router = http.createServer(function(req, res) {
    // domaincheck, etc...
    child.send({ request: req, response: res }); // Nope
});
router.listen(80); 
```

所以这是一个死胡同。但是，嘿！Node.js 提供了一些可发送的句柄。这是文档中的一个示例：

*`master.js`*

```
var server = require('net').createServer();
var child = require('child_process').fork(__dirname + '/child.js');
// Open up the server object and send the handle.
server.listen(1337, function() {
  child.send({ server: true }, server._handle);
}); 
```

*`child.js`*

```
process.on('message', function(m, serverHandle) {
  if (serverHandle) {
    var server = require('net').createServer();
    server.listen(serverHandle);
  }
}); 
```

这里孩子直接监听主服务器。所以中间没有域检查。所以这里是一个死胡同。

我也想过[`Cluster`](http://nodejs.org/api/cluster.html)，但这使用的技术与手柄相同，因此具有相同的局限性。

那么……有什么好主意吗？

我目前所做的是相当hack-ish。我制作了一个名为[distroy](https://npmjs.org/package/distroy)的包。它绑定到端口 80 并在内部代理所有请求到 Unix 域套接字路径，例如`/tmp/distroy/http/www.example.com`，单独的应用程序在其上侦听。这也（有点）适用于 HTTPS（请参阅我关于[SNI](https://stackoverflow.com/questions/17832592/extract-server-name-indication-sni-from-tls-client-hello)的问题）。剩下的问题是，原来的 IP 地址丢失了，因为它现在总是 127.0.0.1。我想我可以通过monkeypatching来规避这个问题，`net.Server`这样我就可以在打开连接之前传输IP地址。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T01:35:50.437

如果您对 node.js 解决方案感兴趣，请查看 node.js 中的[bouncy](http://substack.net/posts/5bd18d)、websocket 和支持 https 的 http 路由器代理/负载平衡器。

定义你的 routes.json 像

```
 {
      "beep.example.com" : 8000,
      "boop.example.com" : 8001
 } 
```

然后使用

```
 bouncy routes.json 80 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:14:26.890

就个人而言，我只是让他们都在专用端口或最好是套接字上监听，然后将所有内容都放在专用路由器脚本或 nginx 后面。这是 IMO 最简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T04:02:41.640

对于连接中间件，有[vhost](http://www.senchalabs.org/connect/vhost.html)扩展。也许你可以复制他们的一些概念。

# git - Git如何递归删除文件和文件夹？

> ID：10791315
> 
> 赞同：1
> 
> 时间：2012-05-28T23:03:22.870
> 
> 标签：git, repository

我不小心将我的 bin、classpath 和其他几个文件上传到了我之前软删除的 git 中。我可以使用什么命令来完成所有提交并仅从远程文件中删除某些文件，而不是本地文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:05:49.697

见[GitHub 上](http://help.github.com/remove-sensitive-data/)的解释：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch FILES' --prune-empty -- --all 
```

`FILES`成为您要核对的文件。`-r`如果要删除整个目录，请使用。

# python - python 3.2 if-else

> ID：10791325
> 
> 赞同：-6
> 
> 时间：2012-05-28T23:04:59.867
> 
> 标签：python, python-3.x, if-statement

我需要 python 3.2 if-else 语句的帮助，代码是：

```
if gam < 1:
    file = open("data1.dat","w")
    gam = gam2
elif gam == 1:
    file = open("data2.dat","w")
    gam = gam3
elif gam > 1:
    file = open("data3.dat","w") 
```

运行时，如果 gam < 1 如果我删除冒号，我会收到指向冒号的语法错误点，我会收到指向 word 文件的语法错误。

编辑：这里有更多的代码

```
for o in range (3):
    for i in range (0,len(x)):
        for j in range (0,len(y)):
            a[i][j]=x[i]
            b[i][j]=y[j]

    for i in range (0,len(x)):
        for j in range (0,len(y)):
            u[i][j] = (vinf*a[i][j]*b[i][j]*(4*math.pi*math.pow(3,2)+gamma*(math.pow(a[i][j],2)+math.pow(b[i][j],2))))/(2*math.pi*math.pow(math.pow(a[i][j],2)+math.pow(b[i][j],2),2))
            v[i][j] = (1/2)*vinf*((math.pow(b[i][j],2)*(4*math.pi*math.pow(3,2)+b[i][j]*(math.pow(a[i][j],2)+math.pow(b[i][j],2))))/(math.pi*math.pow(math.pow(a[i][j],2)+math.pow(b[i][j],2),2))-(2*math.pow(3,2))/(math.pow(a[i][j],2)+math.pow(b[i][j],2))+(gamma*math.log1p(math.sqrt(math.pow(a[i][j],2)+math.pow(b[i][j],2))/3))/math.pi+2)
            p[i][j] = 1-(math.pow(u[i][j],2)+math.pow(v[i][j],2))
            s[i][j] = (vinf*b[i][j])*(1-(math.pow(3,2)/(math.pow(a[i][j],2)+math.pow(b[i][j],2)))+(gamma/(2*math.pi))*math.log1p(math.sqrt(math.pow(a[i][j],2)+math.pow(b[i][j],2))/3)

    if gam < 1:
        file = open("data1.dat","w")
        gam = gam2
    elif gam == 1:
        file = open("data2.dat","w")
        gam = gam3
    elif gam > 1:
        file = open("data3.dat","w") 
```

edit2：我似乎在 s 行缺少括号，但现在关闭文件时出现错误

```
if gam < 1:
        file = open("data1.dat","w")
        gam = gam2
    elif gam == 1:
        file = open("data2.dat","w")
        gam = gam3
    elif gam > 1:
        file = open("data3.dat","w")
    file.write('title = "Driven Cavity"\r\n')
    file.write('variables = "x", "y", "u", "v", "p", "s"\r\n')
    file.write('ZONE T="All"\r\n')
    file.write(' I={}'.format(len(x)))
    file.write(' J={}'.format(len(x)))
    file.write(' K=1')
    file.write(' ZONETYPE=Ordered\r\n')
    file.write(' DATAPACKING=POINT\r\n')

    for i in range (0,len(x)):
        for j in range (0,len(y)):
            file.write('{}\t'.format(a[i][j]))
            file.write('{}\t'.format(b[i][j]))
            file.write('{}\t'.format(u[i][j]))
            file.write('{}\t'.format(v[i][j]))
            file.write('{}\t'.format(p[i][j]))
            file.write('{}\t\n'.format(s[i][j])
    file.close() 
```

别介意只是另一个括号。漫长的一天

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:23:17.113

您错过了`)`行尾的关闭：

```
s[i][j] = (vinf*b[i][j])*(1-(math.pow(3,2)/(math.pow(a[i][j],2)+math.pow(b[i][j],2)))+(gamma/(2*math.pi))*math.log1p(math.sqrt(math.pow(a[i][j],2)+math.pow(b[i][j],2))/3)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:26:27.947

`(math.pow(a[i][j],2)`语句之前的马拉松表达式中的这个特定表达式`if`看起来好像缺少结束语`)`

IE，

```
s[i][j] = (vinf*b[i][j])*(1-(math.pow(3,2)/(math.pow(a[i][j],2) + ... 
```

应该

```
s[i][j] = (vinf*b[i][j])*(1-(math.pow(3,2)/(math.pow(a[i][j],2)) + ... 
```

虽然很难确定表达式的长度和所需的可能分组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T00:16:12.120

为避免不匹配的 ()、{}、[]、''、"" 等错误，请使用代码编辑器，在您使用关闭器时指示开启器，最好了解特定语言。Idle 的编辑器针对 Python 执行此操作，Notepad++ 针对多种语言执行此操作，而其他几个编辑器针对各种语言执行此操作。

当你得到一个看起来错误的令人费解的 SyntaxError 时（在指示的位置）以某种方式修改代码并查看指示器是否移动。在您的原始代码中，如果您在 if 之前的行中放置*了任何内容*，例如 '1==1'，则 ^ 将移至该行。那么你就会知道问题出在 if 语句之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T01:55:36.933

与您的问题没有直接关系，但是：您的代码似乎做了很多不必要的工作。我试着精简一下。

```
from math import log1p, sqrt, pi
NEWLINE = '\r\n'
header = NEWLINE.join([
    'title = "Driven Cavity"',
    'variables = "x", "y", "u", "v", "p", "s"',
    'ZONE T="All"',
    ' I={} J={} K=1 ZONETYPE=Ordered',
    ' DATAPACKING=POINT',
    ''
])

for o in range(3):
    if gam < 1:    fname = "data1.dat"
    elif gam == 1: fname = "data2.dat"
    else:          fname = "data3.dat"

    with open(fname, "w") as outf:
        outf.write(header.format(len(x), len(y)))

        for _x in x:
            for _y in y:
                _xsq = _x**2
                _ysq = _y**2
                sqsq = (_xsq + _ysq)**2
                chunk = gamma*log1p(sqrt(_xsq+_ysq)/3.)/pi

                u = 0.5*vinf*_x*_y*(36.*pi + gamma*(_xsq+_ysq))/(pi*sqsq)
                v = 0.5*vinf*(2\. + _ysq*(36.*pi + _y*(_xsq+_ysq))/(pi*sqsq) - 18./(_xsq+_ysq) + chunk)
                p = 1\. - (u**2 + v**2)
                s = vinf*_y*(1\. - 9./(_xsq+_ysq) + 0.5*chunk)

                outf.write('{}\t{}\t{}\t{}\t{}\t{}{}'.format(_x, _y, u, v, p, s, NEWLINE)) 
```

希望这可以帮助。

# google-maps - 带有 kml 层的 Google 地图 (API v3)。如何隐藏kml URL？

> ID：10791327
> 
> 赞同：0
> 
> 时间：2012-05-28T23:05:09.323
> 
> 标签：google-maps, kml, wikimapia

我想通过 API v3 显示一个带有 kml 的谷歌地图。问题是每个人都可以看到 kml 的 url 并轻松下载它。是否有“隐藏” .KML URL 的技巧？

wikimapia.org 似乎做了类似的事情来显示 kml 多边形，但如果您通过脚本标签检查 Firebug，您将看不到 kml URL。

感谢大家的帮助。A. 来自意大利。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:54:31.083

您可以在运行时生成它，以便服务器向页面发送 URL。但是，它仍然在某些时候被发现。通过默默无闻的安全性并没有真正起作用。KMLLayer 层要求您的 KML 位于公共服务器上。您可以改为解析 KML 并以这种方式呈现，比如使用[egeoxml](http://econym.org.uk/gmap/egeoxml.htm)。但是，这提供的性能要低得多。

# playframework - 播放框架 - save()

> ID：10791330
> 
> 赞同：1
> 
> 时间：2012-05-28T23:05:31.120
> 
> 标签：playframework

该`save()`方法仅用于向数据库添加条目，而不是在修改时使用。例如，当我创建一个问题时，我会这样做`question.save`。当我添加问题的答案时，我只是这样做`question.add(answer)`。我不必`save()`提出问题来保存更改。我的理解正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T06:26:37.977

Play 使用`save()`无论是新的还是现有的模型。它在幕后为您管理所有复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T05:25:37.040

是的，您确实需要保存您的问题。Play有一些很好的[教程](http://www.playframework.org/documentation/1.2.4/guide2)，你应该看看。

# netezza - Netezza：如何向表中添加列

> ID：10791332
> 
> 赞同：2
> 
> 时间：2012-05-28T23:05:48.620
> 
> 标签：netezza

不支持 ALTER TABLE table_name ADD 列。有没有其他方法可以将列添加到表中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T13:59:10.877

你大错特错。Netezza 支持添加列。这在您的数据库用户指南中进行了描述，B-19 部分解释了 ALTER TABLE 语法。

查看 nzsql 的输出：

```
LABDB(ADMIN)=> CREATE TABLE REGION2 AS SELECT * FROM REGION;
INSERT 0 4
Elapsed time: 0m0.138s
LABDB(ADMIN)=> ALTER TABLE REGION2 ADD r_col1 char(8);
ALTER TABLE
Elapsed time: 0m0.145s
LABDB(ADMIN)=> SELECT * FROM REGION2;
 R_REGIONKEY |          R_NAME           |          R_COMMENT          | R_COL1
-------------+---------------------------+-----------------------------+--------
           4 | ap                        | asia pacific                |
           3 | emea                      | europe, middle east, africa |
           2 | sa                        | south america               |
           1 | na                        | north america               |
(4 rows)

Elapsed time: 0m0.510s
LABDB(ADMIN)=> UPDATE REGION2 SET r_col1 = 'AABBAABB';
UPDATE 4
Elapsed time: 0m1.256s
LABDB(ADMIN)=> SELECT * FROM REGION2;
 R_REGIONKEY |          R_NAME           |          R_COMMENT          |  R_COL1
-------------+---------------------------+-----------------------------+----------
           1 | na                        | north america               | AABBAABB
           3 | emea                      | europe, middle east, africa | AABBAABB
           4 | ap                        | asia pacific                | AABBAABB
           2 | sa                        | south america               | AABBAABB
(4 rows)

Elapsed time: 0m0.111s
LABDB(ADMIN)=> 
```

# ruby - 解释这个原始文本 - 一种策略？

> ID：10791337
> 
> 赞同：7
> 
> 时间：2012-05-28T23:06:38.317
> 
> 标签：ruby, parsing, text, language-agnostic, screen-scraping

我有这个原始文本：

```
________________________________________________________________________________________________________________________________
Pos Car  Competitor/Team                Driver                   Vehicle              Cap   CL Laps     Race.Time Fastest...Lap

1     6  Jason Clements                 Jason Clements           BMW M3               3200       10     9:48.5710   3 0:57.3228*
2    42  David Skillender               David Skillender         Holden VS Commodore  6000       10     9:55.6866   2 0:57.9409 
3    37  Bruce Cook                     Bruce Cook               Ford  Escort         3759       10     9:56.4388   4 0:58.3359 
4    18  Troy Marinelli                 Troy Marinelli           Nissan  Silvia       3396       10     9:56.7758   2 0:58.4443 
5    75  Anthony Gilbertson             Anthony Gilbertson       BMW M3               3200       10    10:02.5842   3 0:58.9336 
6    26  Trent Purcell                  Trent Purcell            Mazda RX7            2354       10    10:07.6285   4 0:59.0546 
7    12  Scott Hunter                   Scott Hunter             Toyota  Corolla      2000       10    10:11.3722   5 0:59.8921 
8    91  Graeme Wilkinson               Graeme Wilkinson         Ford  Escort         2000       10    10:13.4114   5 1:00.2175 
9     7  Justin Wade                    Justin Wade              BMW M3               4000       10    10:18.2020   9 1:00.8969 
10   55  Greg Craig                     Grag Craig               Toyota  Corolla      1840       10    10:18.9956   7 1:00.7905 
11   46  Kyle Orgam-Moore               Kyle Organ-Moore         Holden VS Commodore  6000       10    10:30.0179   3 1:01.6741 
12   39  Uptiles Strathpine             Trent Spencer            BMW Mini Cooper S    1500       10    10:40.1436   2 1:02.2728 
13  177  Mark Hyde                      Mark Hyde                Ford  Escort         1993       10    10:49.5920   2 1:03.8069 
14   34  Peter Draheim                  Peter Draheim            Mazda RX3            2600       10    10:50.8159  10 1:03.4396 
15    5  Scott Douglas                  Scott Douglas            Datsun  1200         1998        9     9:48.7808   3 1:01.5371 
16   72  Paul Redman                    Paul Redman              Ford  Focus          2lt         9    10:11.3707   2 1:05.8729 
17    8  Matthew Speakman               Matthew Speakman         Toyota  Celica       1600        9    10:16.3159   3 1:05.9117 
18   74  Lucas Easton                   Lucas Easton             Toyota  Celica       1600        9    10:16.8050   6 1:06.0748 
19   77  Dean Fuller                    Dean Fuller              Mitsubishi  Sigma    2600        9    10:25.2877   3 1:07.3991 
20   16  Brett Batterby                 Brett Batterby           Toyota  Corolla      1600        9    10:29.9127   4 1:07.8420 
21   95  Ross Hurford                   Ross Hurford             Toyota  Corolla      1600        8     9:57.5297   2 1:12.2672 
DNF  13  Charles Wright                 Charles Wright           BMW 325i             2700        9     9:47.9888   7 1:03.2808 
DNF  20  Shane Satchwell                Shane Satchwell          Datsun  1200 Coupe   1998        1     1:05.9100   1 1:05.9100 

Fastest Lap Av.Speed Is 152kph, Race Av.Speed Is 148kph
R=under lap record by greatest margin, r=under lap record, *=fastest lap time
________________________________________________________________________________________________________________________________
Issue# 2 - Printed Sat May 26 15:43:31 2012                     Timing System By NATSOFT (03)63431311 www.natsoft.com.au/results
Amended 
```

我需要将其解析为具有明显位置、汽车、驾驶员等字段的对象。问题是我不知道要使用哪种策略。如果我在空格上拆分它，我最终会得到一个这样的列表：

```
["1", "6", "Jason", "Clements", "Jason", "Clements", "BMW", "M3", "3200", "10", "9:48.5710", "3", "0:57.3228*"] 
```

你能看到问题。我不能仅仅解释这个列表，因为人们可能只有一个名字，或者一个名字中的三个单词，或者一辆车中有许多不同的单词。仅使用索引来引用列表是不可能的。

如何使用由列名定义的偏移量？我不太明白如何使用它。

**编辑**：所以我使用的当前算法是这样的：

1.  拆分新行上的文本，给出行的集合。
2.  在每行上找到常见的空白字符 FURTHEST RIGHT。即每一行上的位置（索引），其中每隔一行包含空格。例如：
3.  根据这些常见字符拆分行。
4.  修剪线条

存在几个问题：

如果名称包含相同的长度，如下所示：

```
Jason Adams
Bobby Sacka
Jerry Louis 
```

然后它将解释为两个单独的项目：（[ `"Jason" "Adams", "Bobby", "Sacka", "Jerry", "Louis"]`）。

而如果它们都像这样不同：

```
Dominic Bou
Bob Adams
Jerry Seinfeld 
```

然后它会在 Seinfeld 中的最后一个 'd' 上正确拆分（因此我们会得到三个名称的集合（`["Dominic Bou", "Bob Adams", "Jerry Seinfeld"]`）。

它也很脆。我正在寻找更好的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T09:02:29.283

[http://blog.ryanwood.com/past/2009/6/12/slither-a-dsl-for-parsing-fixed-width-text-files](http://blog.ryanwood.com/past/2009/6/12/slither-a-dsl-for-parsing-fixed-width-text-files)这可能会解决您的问题。

[这里](https://github.com/ryanwood/slither)还有几个例子和github。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T05:54:35.853

这不是正则表达式的好案例，您真的想发现格式然后解压缩这些行：

```
lines = str.split "\n"

# you know the field names so you can use them to find the column positions
fields = ['Pos', 'Car', 'Competitor/Team', 'Driver', 'Vehicle', 'Cap', 'CL Laps', 'Race.Time', 'Fastest...Lap']
header = lines.shift until header =~ /^Pos/
positions = fields.map{|f| header.index f}

# use that to construct an unpack format string
format = 1.upto(positions.length-1).map{|x| "A#{positions[x] - positions[x-1]}"}.join
# A4A5A31A25A21A6A12A10

lines.each do |line|
  next unless line =~ /^(\d|DNF)/ # skip lines you're not interested in
  data = line.unpack(format).map{|x| x.strip}
  puts data.join(', ')
  # or better yet...
  car = Hash[fields.zip data]
  puts car['Driver']
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-22T19:48:53.033

我认为在每行上使用固定宽度就很容易了。

```
#!/usr/bin/env ruby

# ruby parsing_winner.rb winners_list.txt 
args = ARGV
puts "ruby parsing_winner.rb winners_list.txt " if args.empty?
winner_file = open args.shift
array_of_race_results, array_of_race_results_array  = [], []

class RaceResult

  attr_accessor :position, :car, :team, :driver, :vehicle, :cap, :cl_laps, :race_time, :fastest, :fastest_lap
  def initialize(position, car, team, driver, vehicle, cap, cl_laps, race_time, fastest, fastest_lap)
    @position    = position 
    @car         = car 
    @team        = team  
    @driver      = driver  
    @vehicle     = vehicle  
    @cap         = cap  
    @cl_laps     = cl_laps  
    @race_time   = race_time 
    @fastest     = fastest
    @fastest_lap = fastest_lap 
  end

  def to_a
    # ["1", "6", "Jason", "Clements", "Jason", "Clements", "BMW", "M3", "3200", "10", "9:48.5710", "3", "0:57.3228*"]
    [position, car, team, driver, vehicle, cap, cl_laps, race_time, fastest, fastest_lap]
  end
end

# Pos Car  Competitor/Team                Driver                   Vehicle              Cap   CL Laps     Race.Time Fastest...Lap

# 1     6  Jason Clements                 Jason Clements           BMW M3               3200       10     9:48.5710   3 0:57.3228*
# 2    42  David Skillender               David Skillender         Holden VS Commodore  6000       10     9:55.6866   2 0:57.9409
# etc...
winner_file.each_line do |line|
  next if line[/^____/] || line[/^\w{4,}|^\s|^Pos/] || line[0..3][/\=/]
  position    = line[0..3].strip
  car         = line[4..8].strip
  team        = line[9..39].strip
  driver      = line[40..64].strip
  vehicle     = line[65..85].strip
  cap         = line[86..91].strip
  cl_laps     = line[92..101].strip
  race_time   = line[102..113].strip
  fastest     = line[114..116].strip
  fastest_lap = line[117..-1].strip
  racer = RaceResult.new(position, car, team, driver, vehicle, cap, cl_laps, race_time, fastest, fastest_lap)
  array_of_race_results << racer
  array_of_race_results_array << racer.to_a
end

puts "Race Results Objects: #{array_of_race_results}"
puts "Race Results: #{array_of_race_results_array.inspect}" 
```

输出 =>

```
Race Results Objects: [#<RaceResult:0x007fcc4a84b7c8 @position="1", @car="6", @team="Jason Clements", @driver="Jason Clements", @vehicle="BMW M3", @cap="3200", @cl_laps="10", @race_time="9:48.5710", @fastest="3", @fastest_lap="0:57.3228*">, #<RaceResult:0x007fcc4a84aa08 @position="2", @car="42", @team="David Skillender", @driver="David Skillender", @vehicle="Holden VS Commodore", @cap="6000", @cl_laps="10", @race_time="9:55.6866", @fastest="2", @fastest_lap="0:57.9409">, #<RaceResult:0x007fcc4a849ce8 @position="3", @car="37", @team="Bruce Cook", @driver="Bruce Cook", @vehicle="Ford  Escort", @cap="3759", @cl_laps="10", @race_time="9:56.4388", @fastest="4", @fastest_lap="0:58.3359">, #<RaceResult:0x007fcc4a8491f8 @position="4", @car="18", @team="Troy Marinelli", @driver="Troy Marinelli", @vehicle="Nissan  Silvia", @cap="3396", @cl_laps="10", @race_time="9:56.7758", @fastest="2", @fastest_lap="0:58.4443">, #<RaceResult:0x007fcc4b091ab8 @position="5", @car="75", @team="Anthony Gilbertson", @driver="Anthony Gilbertson", @vehicle="BMW M3", @cap="3200", @cl_laps="10", @race_time="10:02.5842", @fastest="3", @fastest_lap="0:58.9336">, #<RaceResult:0x007fcc4b0916a8 @position="6", @car="26", @team="Trent Purcell", @driver="Trent Purcell", @vehicle="Mazda RX7", @cap="2354", @cl_laps="10", @race_time="10:07.6285", @fastest="4", @fastest_lap="0:59.0546">, #<RaceResult:0x007fcc4b091298 @position="7", @car="12", @team="Scott Hunter", @driver="Scott Hunter", @vehicle="Toyota  Corolla", @cap="2000", @cl_laps="10", @race_time="10:11.3722", @fastest="5", @fastest_lap="0:59.8921">, #<RaceResult:0x007fcc4b090e88 @position="8", @car="91", @team="Graeme Wilkinson", @driver="Graeme Wilkinson", @vehicle="Ford  Escort", @cap="2000", @cl_laps="10", @race_time="10:13.4114", @fastest="5", @fastest_lap="1:00.2175">, #<RaceResult:0x007fcc4b090a78 @position="9", @car="7", @team="Justin Wade", @driver="Justin Wade", @vehicle="BMW M3", @cap="4000", @cl_laps="10", @race_time="10:18.2020", @fastest="9", @fastest_lap="1:00.8969">, #<RaceResult:0x007fcc4b090668 @position="10", @car="55", @team="Greg Craig", @driver="Grag Craig", @vehicle="Toyota  Corolla", @cap="1840", @cl_laps="10", @race_time="10:18.9956", @fastest="7", @fastest_lap="1:00.7905">, #<RaceResult:0x007fcc4b090258 @position="11", @car="46", @team="Kyle Orgam-Moore", @driver="Kyle Organ-Moore", @vehicle="Holden VS Commodore", @cap="6000", @cl_laps="10", @race_time="10:30.0179", @fastest="3", @fastest_lap="1:01.6741">, #<RaceResult:0x007fcc4b08fe48 @position="12", @car="39", @team="Uptiles Strathpine", @driver="Trent Spencer", @vehicle="BMW Mini Cooper S", @cap="1500", @cl_laps="10", @race_time="10:40.1436", @fastest="2", @fastest_lap="1:02.2728">, #<RaceResult:0x007fcc4b08fa38 @position="13", @car="177", @team="Mark Hyde", @driver="Mark Hyde", @vehicle="Ford  Escort", @cap="1993", @cl_laps="10", @race_time="10:49.5920", @fastest="2", @fastest_lap="1:03.8069">, #<RaceResult:0x007fcc4b08f628 @position="14", @car="34", @team="Peter Draheim", @driver="Peter Draheim", @vehicle="Mazda RX3", @cap="2600", @cl_laps="10", @race_time="10:50.8159", @fastest="10", @fastest_lap="1:03.4396">, #<RaceResult:0x007fcc4b08f218 @position="15", @car="5", @team="Scott Douglas", @driver="Scott Douglas", @vehicle="Datsun  1200", @cap="1998", @cl_laps="9", @race_time="9:48.7808", @fastest="3", @fastest_lap="1:01.5371">, #<RaceResult:0x007fcc4b08ee08 @position="16", @car="72", @team="Paul Redman", @driver="Paul Redman", @vehicle="Ford  Focus", @cap="2lt", @cl_laps="9", @race_time="10:11.3707", @fastest="2", @fastest_lap="1:05.8729">, #<RaceResult:0x007fcc4b08e9f8 @position="17", @car="8", @team="Matthew Speakman", @driver="Matthew Speakman", @vehicle="Toyota  Celica", @cap="1600", @cl_laps="9", @race_time="10:16.3159", @fastest="3", @fastest_lap="1:05.9117">, #<RaceResult:0x007fcc4b08e5e8 @position="18", @car="74", @team="Lucas Easton", @driver="Lucas Easton", @vehicle="Toyota  Celica", @cap="1600", @cl_laps="9", @race_time="10:16.8050", @fastest="6", @fastest_lap="1:06.0748">, #<RaceResult:0x007fcc4b08e1d8 @position="19", @car="77", @team="Dean Fuller", @driver="Dean Fuller", @vehicle="Mitsubishi  Sigma", @cap="2600", @cl_laps="9", @race_time="10:25.2877", @fastest="3", @fastest_lap="1:07.3991">, #<RaceResult:0x007fcc4b08ddc8 @position="20", @car="16", @team="Brett Batterby", @driver="Brett Batterby", @vehicle="Toyota  Corolla", @cap="1600", @cl_laps="9", @race_time="10:29.9127", @fastest="4", @fastest_lap="1:07.8420">, #<RaceResult:0x007fcc4a848348 @position="21", @car="95", @team="Ross Hurford", @driver="Ross Hurford", @vehicle="Toyota  Corolla", @cap="1600", @cl_laps="8", @race_time="9:57.5297", @fastest="2", @fastest_lap="1:12.2672">, #<RaceResult:0x007fcc4a847948 @position="DNF", @car="13", @team="Charles Wright", @driver="Charles Wright", @vehicle="BMW 325i", @cap="2700", @cl_laps="9", @race_time="9:47.9888", @fastest="7", @fastest_lap="1:03.2808">, #<RaceResult:0x007fcc4a847010 @position="DNF", @car="20", @team="Shane Satchwell", @driver="Shane Satchwell", @vehicle="Datsun  1200 Coupe", @cap="1998", @cl_laps="1", @race_time="1:05.9100", @fastest="1", @fastest_lap="1:05.9100">]
Race Results: [["1", "6", "Jason Clements", "Jason Clements", "BMW M3", "3200", "10", "9:48.5710", "3", "0:57.3228*"], ["2", "42", "David Skillender", "David Skillender", "Holden VS Commodore", "6000", "10", "9:55.6866", "2", "0:57.9409"], ["3", "37", "Bruce Cook", "Bruce Cook", "Ford  Escort", "3759", "10", "9:56.4388", "4", "0:58.3359"], ["4", "18", "Troy Marinelli", "Troy Marinelli", "Nissan  Silvia", "3396", "10", "9:56.7758", "2", "0:58.4443"], ["5", "75", "Anthony Gilbertson", "Anthony Gilbertson", "BMW M3", "3200", "10", "10:02.5842", "3", "0:58.9336"], ["6", "26", "Trent Purcell", "Trent Purcell", "Mazda RX7", "2354", "10", "10:07.6285", "4", "0:59.0546"], ["7", "12", "Scott Hunter", "Scott Hunter", "Toyota  Corolla", "2000", "10", "10:11.3722", "5", "0:59.8921"], ["8", "91", "Graeme Wilkinson", "Graeme Wilkinson", "Ford  Escort", "2000", "10", "10:13.4114", "5", "1:00.2175"], ["9", "7", "Justin Wade", "Justin Wade", "BMW M3", "4000", "10", "10:18.2020", "9", "1:00.8969"], ["10", "55", "Greg Craig", "Grag Craig", "Toyota  Corolla", "1840", "10", "10:18.9956", "7", "1:00.7905"], ["11", "46", "Kyle Orgam-Moore", "Kyle Organ-Moore", "Holden VS Commodore", "6000", "10", "10:30.0179", "3", "1:01.6741"], ["12", "39", "Uptiles Strathpine", "Trent Spencer", "BMW Mini Cooper S", "1500", "10", "10:40.1436", "2", "1:02.2728"], ["13", "177", "Mark Hyde", "Mark Hyde", "Ford  Escort", "1993", "10", "10:49.5920", "2", "1:03.8069"], ["14", "34", "Peter Draheim", "Peter Draheim", "Mazda RX3", "2600", "10", "10:50.8159", "10", "1:03.4396"], ["15", "5", "Scott Douglas", "Scott Douglas", "Datsun  1200", "1998", "9", "9:48.7808", "3", "1:01.5371"], ["16", "72", "Paul Redman", "Paul Redman", "Ford  Focus", "2lt", "9", "10:11.3707", "2", "1:05.8729"], ["17", "8", "Matthew Speakman", "Matthew Speakman", "Toyota  Celica", "1600", "9", "10:16.3159", "3", "1:05.9117"], ["18", "74", "Lucas Easton", "Lucas Easton", "Toyota  Celica", "1600", "9", "10:16.8050", "6", "1:06.0748"], ["19", "77", "Dean Fuller", "Dean Fuller", "Mitsubishi  Sigma", "2600", "9", "10:25.2877", "3", "1:07.3991"], ["20", "16", "Brett Batterby", "Brett Batterby", "Toyota  Corolla", "1600", "9", "10:29.9127", "4", "1:07.8420"], ["21", "95", "Ross Hurford", "Ross Hurford", "Toyota  Corolla", "1600", "8", "9:57.5297", "2", "1:12.2672"], ["DNF", "13", "Charles Wright", "Charles Wright", "BMW 325i", "2700", "9", "9:47.9888", "7", "1:03.2808"], ["DNF", "20", "Shane Satchwell", "Shane Satchwell", "Datsun  1200 Coupe", "1998", "1", "1:05.9100", "1", "1:05.9100"]] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-28T23:18:47.663

根据格式的一致性，您可能可以为此使用正则表达式。

这是一个适用于当前数据的示例正则表达式 - 可能需要根据精确的规则进行调整，但它给出了这个想法：

```
^

# Pos
(\d+|DNF)
\s+

#Car
(\d+)
\s+

# Team
([\w-]+(?: [\w-]+)+)
\s+

# Driver
([\w-]+(?: [\w-]+)+)
\s+

# Vehicle
([\w-]+(?:  ?[\w-]+)+)
\s+

# Cap
(\d{4}|\dlt)
\s+

# CL Laps
(\d+)
\s+

# Race.Time
(\d+:\d+\.\d+)
\s+

# Fastest Lap
(\d+)
\s+

# Fastest Lap Time
(\d+:\d+\.\d+\*?)
\s*

$ 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-28T23:20:22.380

如果您可以验证空格是空格字符而不是制表符，并且总是截断过长的文本以适应列结构，那么我将对切片边界进行硬编码：

```
parsed = [rawLine[0:3],rawLine[4:7],rawLine[9:38], ...etc... ] 
```

根据数据源的不同，这可能很脆弱（例如，如果每次运行都有不同的列宽）。

如果标题行始终相同，则可以通过搜索标题行的已知单词来提取切片边界。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-20T01:41:05.310

你可以使用`fixed_width`宝石。

您可以使用以下代码解析您给定的文件：

```
require 'fixed_width'
require 'pp'

FixedWidth.define :cars do |d|
  d.head do |head|
    head.trap { |line| line !~ /\d/ }
  end
  d.body do |body|
    body.trap { |line| line =~ /^(\d|DNF)/ }
    body.column :pos, 4
    body.column :car, 5
    body.column :competitor, 31
    body.column :driver, 25
    body.column :vehicle, 21
    body.column :cap, 5
    body.column :cl_laps, 11
    body.column :race_time, 11
    body.column :fast_lap_no, 4
    body.column :fast_lap_time, 10
  end
end

pp FixedWidth.parse(File.open("races.txt"), :cars) 
```

该`trap`方法识别每个部分中的行。我使用了正则表达式：

*   正`head`则表达式查找不包含数字的行。
*   正`body`则表达式查找以数字或“DNF”开头的行

每个部分必须包括紧跟最后一行的行。定义只是标识要抓取的`column`列数。该库为您去除空格。如果您想*生成*一个固定宽度的文件，您可以添加对齐参数，但您似乎不需要它。

结果是一个像这样开始的哈希：

```
{:head=>[{}, {}, {}],
 :body=>
  [{:pos=>"1",
    :car=>"6",
    :competitor=>"Jason Clements",
    :driver=>"Jason Clements",
    :vehicle=>"BMW M3",
    :cap=>"3200",
    :cl_laps=>"10",
    :race_time=>"9:48.5710",
    :fast_lap_no=>"3",
    :fast_lap_time=>"0:57.3228"},
   {:pos=>"2",
    :car=>"42",
    :competitor=>"David Skillender",
    :driver=>"David Skillender",
    :vehicle=>"Holden VS Commodore",
    :cap=>"6000",
    :cl_laps=>"10",
    :race_time=>"9:55.6866",
    :fast_lap_no=>"2",
    :fast_lap_time=>"0:57.9409"}, 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-07-20T20:10:58.507

好吧，我明白了：

**编辑**：我忘了提，假设您已将输入文本存储在变量中`input_string`

```
# Choose a delimeter that is unlikely to occure
DELIM = '|||'

# DRY -> extend String
class String
  def split_on_spaces(min_spaces = 1)
    self.strip.gsub(/\s{#{min_spaces},}/, DELIM).split(DELIM)
  end
end

# just get the data lines
lines = input_string.split("\n")
lines = lines[2...(lines.length - 4)].delete_if { |line|
  line.empty?
}

# Grab all the entries into a nice 2-d array
entries = lines.map { |line|
  [
    line[0..8].split_on_spaces,
    line[9..85].split_on_spaces(3).map{ |string| 
      string.gsub(/\s+/, ' ')  # replace whitespace with 1 space
    },
    line[85...line.length].split_on_spaces(2)

  ].flatten
}

# BONUS

# Make nice hashes
keys = [:pos, :car, :team, :driver, :vehicle, :cap, :cl_laps, :race_time, :fastest_lap]
objects = entries.map { |entry|
  Hash[keys.zip entry]
} 
```

输出：

```
entries # =>
["1", "6", "Jason Clements", "Jason Clements", "BMW M3", "3200", "10", "9:48.5710", "3 0:57.3228*"]
["2", "42", "David Skillender", "David Skillender", "Holden VS Commodore", "6000", "10", "9:55.6866", "2 0:57.9409"]
...
# all of length 9, no extra spaces 
```

万一阵列只是不削减它

```
objects # =>
{:pos=>"1", :car=>"6", :team=>"Jason Clements", :driver=>"Jason Clements", :vehicle=>"BMW M3", :cap=>"3200", :cl_laps=>"10", :race_time=>"9:48.5710", :fastest_lap=>"3 0:57.3228*"}
{:pos=>"2", :car=>"42", :team=>"David Skillender", :driver=>"David Skillender", :vehicle=>"Holden VS Commodore", :cap=>"6000", :cl_laps=>"10", :race_time=>"9:55.6866", :fastest_lap=>"2 0:57.9409"}
... 
```

我将把它重构为好的功能留给你。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-05-28T23:10:52.263

除非对列的分隔方式有明确的规则，否则您无法真正做到。

**假设您知道**每个列值都正确缩进到列标题，那么您的方法很好。

另一种方法可能是将由一个空格分隔的单词组合在一起（从您提供的文本中，我可以看到该规则也适用）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-05-28T23:21:04.173

假设文本的间距始终相同，您可以根据位置拆分字符串，然后去除每个部分周围的额外空格。例如，在 python 中：

```
pos=row[0:3].strip()
car=row[4:7].strip() 
```

等等。或者，您可以定义一个正则表达式来捕获每个部分：

```
([:alnum:]+)\s([:num:]+)\s(([:alpha:]+ )+)\s(([:alpha:]+ )+)\s(([:alpha:]* )+)\s 
```

等等。（确切的语法取决于您的正则表达式语法。）请注意，汽车正则表达式需要处理添加的空格。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-25T04:19:56.813

我不打算对此进行编码，但绝对适用于上述数据集的一种方法是通过空格解析它，然后以这种方式分配元素：

```
someArray = array of strings that were split by white space

Pos = someArray[0]
Car = someArray[1]
Competitor/Team = someArray[2] + " " + someArray[3]
Driver = someArray[4] + " " + someArray[5]
Vehicle = someArray[6] + " " + ... + " " + someArray[someArray.length - 6]
Cap = someArray[someArray.length - 5]
CL Laps = someArray[someArray.length - 4]
Race.Time = someArray[someArray.length - 3]
Fastest...Lap = someArray[someArray.length - 2] + " " + someArray[someArray.length - 1] 
```

车辆部分可以通过某种 for 或 while 循环来完成。

# bash - 您是否应该在 shell 脚本中更改当前目录？

> ID：10791341
> 
> 赞同：3
> 
> 时间：2012-05-28T23:07:24.083
> 
> 标签：bash, shell, jar, sh, working-directory

我一直认为当前目录是用户的东西，而不是脚本，因为它取决于用户的位置，并且每次执行脚本时都可能不同。

所以当我遇到 Java jar 实用程序的`-C`选项时，我有点困惑。

* * *

对于那些不知道`-C`在指定要包含在 jar 中的文件/文件夹之前使用该选项的人。由于文件/文件夹的路径已复制到 jar 中，因此该`-C`选项会在包含文件之前更改目录：

换句话说：

```
jar -C flower lily.class 
```

将制作一个包含该`lily.class`文件的 jar，而：

```
jar flower/lily.class 
```

将`flower`在 jar 中创建一个文件夹，其中包含`lily.class`

* * *

对于我正在制作的 jar-ing 脚本，我想使用 Bourne 通配符，`folder/*`但这会使使用`-C`变得不可能，因为它仅适用于下一个直接参数。

所以使用通配符的唯一方法是从当前目录运行；但我仍然对在脚本中更改和使用当前目录感到不安。

在脚本中使用当前目录有什么缺点吗？也许是出于某种原因不赞成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:40:26.320

我认为从 shell 脚本更改当前目录本身没有任何问题。当然，如果它自己采取，它不会导致任何不好的事情发生。

事实上，我有一个用于启动基于 Java 的服务器的标准脚本，第一行是：

```
cd `dirname $0` 
```

这确保脚本中的其余命令在包含脚本文件本身的目录中执行（当单台机器托管多个服务器实例时很有用），而不管实际调用 shell 脚本的位置。`cd`在不更改脚本中的当前目录的情况下，只有在用户记得在运行脚本之前手动进入相应目录 时，它才能正常工作。

在这种情况下，`cd`从脚本中执行操作可以从服务器启动/关闭过程中删除一个手动步骤，从而使事情变得不太容易出错。

因此，与大多数事情一样，这类事情也有合法用途。我敢肯定也有一些值得怀疑的地方。这实际上取决于什么最适合您的特定用例。这是我无法真正评论的事情......我总是让`maven`我为我构建我的 JAR。

# javascript - 非本机滚动

> ID：10791347
> 
> 赞同：0
> 
> 时间：2012-05-28T23:09:29.650
> 
> 标签：javascript, html, css

是否有可以帮助制作滚动条的库，该滚动条在 HTML 中为 div 滚动？假设有一个 200 X 200 的 div，但这个 div 内的所有内容实际上都是 200 * 1000，所以您必须向下滚动才能看到所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:12:50.543

您可以使用基于 JQuery 的[Tiny Scrollbar 。](http://baijs.nl/tinyscrollbar/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:20:42.113

你应该使用

```
overflow: auto; 
```

用于自动滚动条插入，以及

```
overflow: scroll; 
```

让它出现。

^(**你标记了 CSS。*)

## 添加

您可以使用 CSS3 来设置滚动条的样式：（即使 Google 也在使用它们，只需在控制台中查看即可。）

*   [http://css-tricks.com/custom-scrollbars-in-webkit/](http://css-tricks.com/custom-scrollbars-in-webkit/)
*   [http://www.webkit.org/blog/363/styling-scrollbars/](http://www.webkit.org/blog/363/styling-scrollbars/)

注意：IE 不支持 CSS3（一如既往），因此您必须使用旧的 IE 特定方式来设置样式。

目前 Webkit 浏览器将支持它：（如 Chrome 和 Safari）

```
::-webkit-scrollbar {
    width: 12px;
}

::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    border-radius: 10px;
    background: gray;
} 
```

[**在这里测试一下**](http://jsfiddle.net/DerekL/Wwqhb/)。

但是，这在 Firefox 中不起作用，**因为他们*认为*用户讨厌那些花哨的滚动条。**所以如果你真的想改变它，你可以试试[jScrollPane](http://jscrollpane.kelvinluck.com/)，它是一个 jQuery 插件并且易于使用。IMO，CSS 比插件好得多，因为它包含的要下载的字符更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:21:05.967

假设您想将滚动条放在以下 div 上：
`<div class="myscrolling" >blah blah...</div>`

CSS：

```
div.myscrolling{
height:200px;
width:200px;
overflow:auto;
} 
```

# javascript - Facebook 客户端授权流程并获取所有场景的 access_token，例如应用范围更改时等

> ID：10791357
> 
> 赞同：1
> 
> 时间：2012-05-28T23:11:50.530
> 
> 标签：javascript, facebook, authorization

我正在尝试通过客户端授权流程使用 JS 做 3 件简单的事情：

1.  检查用户是否已登录。如果没有，则显示具有适当范围的登录对话框。
2.  如果用户已经在浏览器上登录 Facebook，则确保应用程序已被授权（如果没有，则显示授权对话框）。
3.  如果用户已经授权应用程序，则确保 authResponse 上的 access_token 具有应用程序所需的正确范围（权限）。（如果没有，重新显示新权限的授权对话框）。

我正在尝试为此利用 js sdk，而不想编写任何手动编码的对话框等，因为 sdk 会自动处理浏览器/设备的细微差别。

我无法在 FB 文档或其他任何地方找到正确描述的内容。（没有关于应用程序的权限/范围可以更改授权后的事实的文档）。

提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:25:42.517

经过艰苦的尝试，我完成了这项工作，以下是使用最少代码量的步骤。

**方法 **

1.  使用 fb-login-button 方便登录。登录按钮是用户第一次到达页面时显示的唯一内容。所有其他表单都是“隐藏的”，迫使用户在继续之前单击此按钮。
2.  设置 onlogin="function();" 在 fb-login-button 上 - 这样您就可以隐藏登录按钮并显示其余的表单/等，以便用户继续使用您的应用程序。请注意，onlogin 仅被调用一次（当用户登录或使用新范围授权应用程序时） - 因此始终隐藏登录按钮并显示页面/表单的其余部分以供用户继续是安全的.
3.  ***最重要的一步***：使用相同的 fb-login-button 也可以在正确的范围内进行授权：所以即使用户已登录 - 强制用户单击登录按钮。在这种情况下，fb-login-button 将检查现有 access_token 的范围（对于已登录的 fb 用户）是否是 fb-login-button 属性上请求的范围的子集。在这种情况下，fb-login-button 将自动为您显示授权对话框。在任何情况下都会触发 onLogin 回调（当登录按钮应该被隐藏（）并且剩余的页面/表单被显示（）时）。
4.  订阅 FB.events 以在每次设置时获取 authResponses 和相应的 access_token，这会发生 2 次：当首次为已登录的用户 b 显示提取时。在用户第一次或第二次使用新范围授权应用程序之后。这使您可以保持 authResponse 和 access_token 新鲜，以用于所有后续图形调用/等。

**实施步骤 **

1.  fb-login-button 必须使用 onlogin 回调创建：

    `<div class="fb-login-button" onLogin="onLogin();" scope="publish_actions" data-size="large">Use This App</div>`

请注意，文字不是登录，而是“使用此应用程序”，因为除了登录之外，还会显示授权按钮。

1.  订阅事件。

    ```
    `// authRepsonse Change is needed when the user hits the UseApp button
    // and permissions are re-fetched - then a new token needs to be refreshed
    FB.Event.subscribe('auth.authResponseChange', handleResponseChange);`

    `// when the user logins and all permissions are all set, clicking on the 
    // use-app will not do anything and authResponse will always be null.
    // so this subscription is necessary
    FB.Event.subscribe('auth.statusChange', handleResponseChange);` 
    ```

`*   登录功能隐藏登录按钮并显示表单。

    ```
     `function onLogin () {
            hideLogin();
            showMain();
        }` 
    ```

    `*   处理状态更改以保存令牌。

    ```
    // global variable that contains the access_token 
    // for use in graph calls/etc.
    var authResponse = null;

    function handleResponseChange(response) {
        if (response && response.authResponse) {
            authResponse = response.authResponse
            if (response.status == 'connected') {
               updateUserInfo(response);
               return;
           }
        }
        else { 
           authResponse = null;
        }
        hideMain();
        showLogin();
    } 
    ````` 

 ``希望这会有所帮助，我相信这可能是处理客户端身份验证流程的最佳方式，无需进行任何额外的授权/登录对话，让 FB sdk 来解决问题。``

# objective-c - 如何从 Cocoa 中的不同音频文件创建同时播放的音频堆栈？

> ID：10791361
> 
> 赞同：1
> 
> 时间：2012-05-28T23:12:34.613
> 
> 标签：objective-c, macos, cocoa, core-audio

我正在使用 Xcode 中的 Cocoa 开发 Mac OS X 应用程序。一项功能涉及同时播放音频：

我想构建某种音频堆栈：在运行时从一组不同的源文件合并的音频文件。源音频文件集在每个运行时都不同。每个音频文件的长度完全相同。

创建音频堆栈（或合并文件）后，我想播放[和存储]它。

我是 Cocoa 中音频框架的新手。是否有提供适当功能的高级 API？我是否必须查看 CoreAudio、Audio Unit 或 QTKit 框架的内部？您有实现想法（或示例实现）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:46:16.630

如果您只想同时播放一堆音频文件，这很容易；与 Windows 不同的是，OS X 就像它内置了一个无限通道混音器一样，所有更高级别的功能只是在需要时为每个声音抓取一个新通道。例如：

```
NSURL *u1 = [[NSBundle mainBundle] URLForResource:@"1" withExtension:@"mp3"];  
NSURL *u2 = [[NSBundle mainBundle] URLForResource:@"2" withExtension:@"mp3"];
NSSound *s1 = [[NSSound alloc] initWithContentsOfURL:u1 byReference:YES];
NSSound *s2 = [[NSSound alloc] initWithContentsOfURL:u2 byReference:YES];
[s1 play];
[s2 play]; 
```

这将在（非常接近）同时开始播放 MyApp.app/Contents/Resources/1.mp3 和 MyApp.app/Contents/Resources/2.mp3。

如果你需要一个包含一堆音轨的（真实的或虚拟的）文件，QTKit 可能是最简单的方法；创建电影，打开所有音频文件，将它们的曲目复制到电影中（具有相同的开始日期），现在您可以播放电影（或做任何您想做的事情）。

如果您想将音频实际合并到一个立体声轨道中（例如，这样您可以保存一个普通的音频文件），而不是仅仅在运行时一起播放轨道，您可以使用上面的 QTKit 并创建一个导出会话（很像使用QuickTime Player 中的“导出...”功能），或者使用 CoreAudio，或者各种不同的跨平台开源库。

# ruby-on-rails-3 - 更改默认注册路线后，Devise 未验证注册表单

> ID：10791366
> 
> 赞同：1
> 
> 时间：2012-05-28T23:12:53.543
> 
> 标签：ruby-on-rails-3, devise

我有一个简单的应用程序（Rails 3.2），它带有一个使用设计（版本 2.0.4）设置的用户模式。

我的用户模型具有设计默认设置：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable, :confirmable,
     :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :first_name, :last_name, :email, :password, :password_confirmation, :remember_me
end 
```

当我使用这样的默认设计路线时，一切似乎都正常：

```
devise_for :users 
```

但是我没有使用默认值，所以我将其更改为：

```
devise_for :users, :path => '', :path_names => { :sign_in => "login", :sign_out => "logout", :sign_up => "sign_up" } 
```

在我更改此路由并重新启动服务器后，它们似乎工作正常，但由于某种原因，验证现在不起作用，即使我从模型中删除“可验证”功能并添加我自己的自定义验证，它们似乎也没有也可以工作。

很想得到你的帮助！- 帕兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:30:40.493

**解决了这个问题**。它不起作用的原因是因为设计使用“用户/登录”来了解要处理的范围。

所以为了解决这个问题，我将路由文件更改为：

```
devise_for :users
devise_scope :user do
  get "/login" => "devise/sessions#new"
  get "/logout" => "devise/sessions#destroy"
  get "/register" => "devise/registrations#new"
end 
```

**参考：** [https ://github.com/plataformatec/devise/wiki/How-To:-Change-the-default-sign_in-and-sign_out-routes](https://github.com/plataformatec/devise/wiki/How-To:-Change-the-default-sign_in-and-sign_out-routes)

# android - android：在封闭路径之外而不是在内部绘制

> ID：10791367
> 
> 赞同：6
> 
> 时间：2012-05-28T23:13:11.323
> 
> 标签：android, drawing

我在 android 的画布上绘制一个填充的多边形。

```
canvas.drawPath(path,myPaint); 
```

现在我想做完全相反的事情：填充多边形之外的区域。

如何告诉油漆填充外部区域 - 多边形未覆盖的区域？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-09-25T18:10:08.563

只需使用

```
path.setFillType(FillType.INVERSE_EVEN_ODD); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:55:25.520

这可能很复杂或非常简单。

复杂的方法：

创建一个与您的多边形完全一样的路径，除了不要关闭它。继续那条路到最近的墙。在墙壁周围画。关闭并填充。在代码中，这不是很有趣。

简单的方法：

给画布上色。绘制多边形。

祝你好运。

# javascript - 通过 jQuery 调用 API

> ID：10791369
> 
> 赞同：0
> 
> 时间：2012-05-28T23:13:35.113
> 
> 标签：javascript, jquery, api

我正在尝试构建一个将数据发送到外部 API、等待响应并解释结果的 .js 文件。外部 API 基于 XML，并接受以 XML 作为正文（内容类型；文本/xml）的 HTTPS Post。我可以通过 cURL 正确调用 API。

这是我到目前为止所拥有的：

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body onload="CallService()">

<script type="text/javascript">
var webServiceURL = 'https://www.url.com';
var xmlString = '<xml><parameter1>value1</parameter1>
<parameter2>value2</parameter2></xml>';

function CallService() {
   $.ajax({
      url: webServiceURL, 
      type: "POST",
      dataType: "xml", 
      data: xmlString, 
      processData: false,
      contentType: "text/xml; charset=\"utf-8\"",
      success: OnSuccess, 
      error: OnError
});
  return false;
}

function OnSuccess(data, status) {
  alert(data.d);
}

function OnError(request, status, error) {
  alert('error');
}

$(document).ready(function() {
  jQuery.support.cors = true;
});
</script>
</body>
</html> 
```

当我打开 HTML 时，我收到一条警告说“错误”，而另一端（外部 API）什么也没有出现。有没有办法只使用 JavaScript/Ajax/jQuery 来做到这一点，还是我需要一个接收 JS 调用的“支持”代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:00:58.317

当您想进行跨域查询时，您基本上有 3 种解决方案：

1) 使用[JSONP](http://en.wikipedia.org/wiki/JSONP)，如果您使用的是 XML 而不是 JSON，您将不会感兴趣

2) 通过在服务于主 html 页面的服务器上设置一种代理（或任何类型的 get），不真正做跨域

3）更改服务器上的标头以指定您接受跨域查询的浏览器。这是新的，但已被所有主要浏览器接受。这就是所谓的[CORS](https://developer.mozilla.org/en/http_access_control)。在所有服务器端语言中更改标题（“访问控制-...”）很容易，因此现在应该是首选方式（如果您遇到问题（安全、权限、带宽、广告等）） - 域访问您服务的数据，您可以限制允许的来源）。

# php - 如何使用 PHP 正则表达式查找两个固定标记之间的所有文本匹配项？

> ID：10791370
> 
> 赞同：-1
> 
> 时间：2012-05-28T23:13:47.923
> 
> 标签：php, regex

我正在寻找以下字符串（或字符串 - 可能出现很多次）：

`<!--##`和`##-->`

示例：从`<!--##HELLO##-->`我需要匹配的输入中`HELLO`。

什么是正则表达式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T23:16:04.630

```
(?<=<!--##).*?(?=##-->) 
```

Lookaround 是仅匹配`HELLO`. 如其他答案中所述，您还可以匹配整个`<!--##HELLO##-->`并提取捕获的组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:22:33.297

正则表达式

```
<!--##(.*?)##--> 
```

将文本存储在第一组中。请务必设置允许 . 匹配换行符（/s 下面）

对于 php preg 这变成

```
if (preg_match('/<!--##(.*?)##-->/s', $subject, $regs)) {
    $result = $regs[1];
} else {
    $result = "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:21:22.973

```
/<!--##(.*?)##-->/ 
```

基本上，这是对其他提供的答案执行此操作的另一种方法，因为我认为使用匹配组来找出您的文本比使用向前/向后仅匹配您正在寻找的内容更简单。番茄，汤姆啊。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-07T22:41:03.113

这是一个使用 的版本`preg_match_all`，以及一个为您提供每个匹配项的迭代器：

```
$match_list = array();
if( preg_match_all('/<!--##(.*?)##-->/s', $subject, $regs) ) {
    $match_list = $regs[1];
} else {
    echo "Warning: No matches found in: " . $subject;
}

foreach($match_list as $i=>$v) {
    echo "Match: " . $i . " : " . $v . "\n";
} 
```

# php - 在 PHP 中自动将帖子上传到 Facebook

> ID：10791375
> 
> 赞同：0
> 
> 时间：2012-05-28T23:14:43.833
> 
> 标签：php, facebook

我制作了自己的“博客风格”网站，没有使用 WordPress 或类似的东西。我正在寻找一种方法来自动将文章的特定部分发布到我为该网站运行的 Facebook 页面的 Facebook 墙上。是否有捷径可寻？我正在使用 PHP 进行帖子提交。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:20:34.053

这可以使用 Facebook API。您可能会找到涵盖大部分功能的 PHP 库，但了解 Facebook API 仍然是一个好主意，以便您了解事情是如何工作的。请参阅[http://developers.facebook.com/docs/reference/api/](http://developers.facebook.com/docs/reference/api/)

# asp.net-mvc-3 - 在 TFS 测试运行期间加载本地化的 resx 文件

> ID：10791377
> 
> 赞同：2
> 
> 时间：2012-05-28T23:15:19.180
> 
> 标签：asp.net-mvc-3, tfs, internationalization, mstest, resx

我们正在使用 .resx 文件来国际化我们的应用程序。我们的解决方案和测试 (mstest) 在本地完美运行，并且在部署时，但是当我们尝试从 Team Foundation Server (TFS) 运行测试时，似乎找不到资源文件（所有字符串始终以 en-US 形式返回）。

对于每个资源文件，我们选择了：

*   构建操作的“嵌入式资源”
*   复制到输出的“如果更新则复制”...
*   自定义工具的“PublicResXFileCodeGenerator”

关于我们可以做些什么来解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T04:38:21.697

*   构建动作 = “内容”
*   复制到输出目录=“始终复制”

请进行上述更改。

# java - 作业 Java 覆盖

> ID：10791379
> 
> 赞同：-1
> 
> 时间：2012-05-28T23:15:20.890
> 
> 标签：java

我有一个带有 2 个变量的超类 RECTANGLE 和一个带有 1 个变量的子类 SQUARE。我正在使用类 Square 来继承 getArea() 方法并很好地覆盖它。Eclipse 编辑器在我的 SQUARE 类中出现错误，“super(width,length);”。LENGTH 变量有一个错误，可以通过在 RECTANGLE 类中将其设为静态来修复，这不是我想要的。我的作业要求 SQUARE 类有一个带有 1 个变量的构造函数，可以自行相乘。我的代码中的逻辑错误是什么？

```
public class Rectangle 
{

double width, length;

Rectangle(double width, double length) 
{
    this.width = width;
    this.length = length;
}

double getArea() 
{
    double area = width * length;
    return area;
}   

void show() 
{
    System.out.println("Rectangle's width and length are: " + width + ", " + length);
    System.out.println("Rectangle's area is: " + getArea());
    System.out.println();
}
}

public class Square extends Rectangle
{
double width, length;

Square(double width) 
{
    super(width, length);
    this.width = width;
}

double getArea() 
{
    double area = width * width;
    return area;
}   

void show() 
{
    System.out.println("Square's width is: " + width) ;
    System.out.println("Square's area is: " + getArea());
}
}

public class ShapesAPP 
{

public static void main(String[] args) 
{
    Rectangle shape1 = new Rectangle(5, 2);
    Square shape2 = new Square(5);
    shape1.show( );
    shape2.show( );
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:18:56.730

你应该有这样的构造函数：

```
Square(double width) 
{
    super(width, width);
} 
```

此外，您应该消除 Square 类中的以下行：`double width, length;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:18:46.547

它应该是：

```
Square(double width) 
{
    super(width, width);
    //this.width = width;
} 
```

A`Square`是一个所有边都等长的矩形。

您收到错误是因为您尝试使用`length`尚未初始化的。

此外，您不需要有成员`width`和`length`in `Square`。您已经在基类中拥有它们。所以一个更好的修订版本是：

```
public class Square extends Rectangle
{
    Square(double width) 
    {
        super(width, length);
    }

    double getArea() 
    {
        double area = width * width;
        return area;
    }  

    void show() 
    {
        System.out.println("Square's width is: " + width) ;
        System.out.println("Square's area is: " + getArea());
    }

} 
```

# actionscript-3 - XMLListCollection 查找索引值

> ID：10791385
> 
> 赞同：0
> 
> 时间：2012-05-28T23:16:05.113
> 
> 标签：actionscript-3, apache-flex, flash-builder

我想在 XMLListCollection 上找到特定的值。

我尝试使用这样的东西，但它不起作用！

```
var xmllisteRDV:XMLList= XML(event.result).RDVClinik;
xmlCollSuivi = new XMLListCollection(xmllisteRDV);
var index:Number = -1;
for(var i:Number = 0; i < xmllisteRDV.length(); i++)
{
    if(XML(xmllisteRDV[i]).@grDateDeb == todayDate)
    {
        index = i;
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:06:40.533

首先要尝试指出原始代码中的错误：

```
var xmllisteRDV:XMLList= XML(event.result).RDVClinik;  //Unnecessary cast, event.result is Object compiler will not check or know the run-time type, doesn't care because Object is declared dynamic meaning properties can be added to it dynamically, if RDVClinik didn't exist on the particular Object type it would simply be null casting as XML gives it no information about this "property"
xmlCollSuivi = new XMLListCollection(xmllisteRDV);
 var index:Number = -1;
        for(var i:Number = 0; i < xmllisteRDV.length(); i++) //length is a property not a method on XMLListCollection this should throw a compile time error
        {
            if(XML(xmllisteRDV[i]).@grDateDeb == todayDate)// I see no type when debugging for the result of xmllisteRDV[i] not positive here but this cast is at the least unnecessary
            {
                index = i;
                break;
            }
        } 
```

这是一个我认为可能会改变 todayDate 构建方式的版本

```
var date:Date = new Date();
var todayDate:String = date.dateUTC+"/"+date.dayUTC+"/"+date.fullYear;
var index:int=-1;
for(var i:int = 0; i < flex3Projects.length; i++)
{
    trace(xmllisteRDV[i].@grDateDeb)
    if(xmllisteRDV[i].@grDateDeb.toString() == todayDate)
    {
        index = i;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:53:22.237

在您的帮助下，我找到了解决方案

```
private function setSelectedItem():void
{
    var gData:Object = dgSuiviClini.dataProvider;
    var todayDate:String= new DateUtility().DateAsToString(new Date());

    for(var i:Number=0; i < gData.length; i++)
    {
        var thisObj:Object = gData.getItemAt(i);
        if(thisObj.grDateDeb == todayDate)
        {
            dgSuiviClini.selectedIndex = i;
            //sometimes scrollToIndex doesnt work if validateNow() not done
            dgSuiviClini.validateNow();
                //dgSuiviClini.scrollToIndex(i);
        }
        else{
            dgSuiviClini.validateNow();
                // dgSuiviClini.scrollToIndex(gData.length);

        }
    }
    dgSuiviClini.validateNow();
    dgSuiviClini.editedItemPosition = { rowIndex: gData.length-1, columnIndex: nColSaisie };

} 
```

谢谢

# android - Android (x,y) 连续触摸（拖动）坐标

> ID：10791389
> 
> 赞同：6
> 
> 时间：2012-05-28T23:16:38.377
> 
> 标签：android, touch, coordinates

我是android新手，我一直在尝试找出如何检索屏幕上连续触摸的坐标。例如，有 2 个变量 (x,y) 在手指移动时实时更新。我知道如何在触摸时找到它，但我真的不知道如何让它在手指移动时返回结果。

我一直在尝试 switch 语句，while/for 循环与 ACTION_MOVE 的不同组合。/ UP/ DOWN .. 仍然没有。

我在网站上发现了同样的问题，但答案只适合第一步（仅显示触摸的协调）我真的很感激这个问题的解决方案！谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-28T23:22:06.760

在没有看到您的代码的情况下，我只是在猜测，但基本上如果您不返回`true`第一次调用`onTouchEvent`，您将看不到手势中的任何后续事件（MOVE、UP 等）。

也许那是你的问题？否则请放上代码示例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-29T12:43:02.803

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final TextView xCoord = (TextView) findViewById(R.id.textView1);
    final TextView yCoord = (TextView) findViewById(R.id.textView2);

    final View touchView = findViewById(R.id.textView3);
    touchView.setOnTouchListener(new View.OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {
            final int action = event.getAction();
            switch (action & MotionEvent.ACTION_MASK) {

                case MotionEvent.ACTION_DOWN: {
                    xCoord.setText(String.valueOf((int) event.getX()));
                    yCoord.setText(String.valueOf((int) event.getY()));
                    break;
                }

                case MotionEvent.ACTION_MOVE:{
                    xCoord.setText(String.valueOf((int) event.getX()));
                    yCoord.setText(String.valueOf((int) event.getY()));
                    break;
                }
            }
            return true;

        }

    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T00:13:56.013

您需要为`OnTouchListener`要识别拖动的任何视图实现一个。

然后在`OnTouchListener`你需要显示X和Y坐标。我相信你可以通过`MotionEvent.getRawX()`和`MotionEvent.getRawY()`

您可以使用该`MotionEvent.getAction()`方法找出拖动发生的时间。我相信常数是`MotionEvent.ACTION_MOVE`。这是一些伪代码：

添加 OnTouchListener 接口

```
public class XYZ extends Activity implements OnTouchListener 
```

在 onCreate 方法中注册监听器

```
public void onCreate(Bundle savedInstanceState)
{
    //other code

    View onTouchView = findViewById(R.id.whatever_id);
    onTouchView.setOnTouchListener(this);
} 
```

实现 onTouch 方法

```
public boolean onTouch(View view, MotionEvent event) 
{
    if(event.getAction() == MotionEvent.ACTION_MOVE)
    {
        float x = event.getRawX();
        float y = event.getRawY();
        //  Code to display x and y go here
        // you can print the x and y coordinate in a textView for exemple
    }
} 
```

# c++ - 使用默认参数的构造函数模板实例化

> ID：10791390
> 
> 赞同：4
> 
> 时间：2012-05-28T23:17:12.613
> 
> 标签：c++, templates, arguments

我有一个构造函数原型，如下所示：

```
template <typename type_position> window(
    const int size[2],
    const char* caption="Window", const SDL_Surface* icon=NULL,
    bool fullscreen=false, bool vsync=true, bool resizable=false, int multisample=0,
    type_position position=type_position(0)
) 
```

然后我想构建一个实例：

```
new window(screen_size,"My Window",NULL,fullscreen); 
```

问题（我假设）是`T`无法明确指定的（即，它可以是`int`or`long`或`short`等）。我得到错误：

> 错误 C2660：“窗口”：函数不接受 4 个参数

然后我尝试指定类型：

```
new window<int>(screen_size,"My Window",NULL,fullscreen); 
```

但这不起作用：

> 错误 C2512：“窗口”：没有适当的默认构造函数可用
> 错误 C2062：类型“int”意外

我做了一些研究，我能得到的最接近的问题是“ [C++ 模板函数默认值](/q/3301362)”这个问题，除了在我的例子中，模板参数可以从第一个参数中推断出来。

那么，我是卡住了还是缺少了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:43:23.890

您不能为构造函数提供显式模板参数列表，并且不能从默认函数参数推导出模板参数，因此`type_position position`需要显式提供函数参数（而不是默认）以推断类型。

由于这是最后一个参数，它会阻止您使用任何构造函数的默认参数。您可以重新排序构造函数参数，以便`type_position`首先给出，或者您可以添加一个允许推导它的虚拟参数：

```
template <typename type_position> window(
  type_position dummy,
  const int size[2],
  const char* caption="Window", const SDL_Surface* icon=NULL,
  bool fullscreen=false, bool vsync=true, bool resizable=false, int multisample=0,
  type_position position=type_position(0)
); 
```

然后使用要推导的类型的虚拟第一个参数调用它：

```
new window(1, screen_size,"My Window",NULL,fullscreen); 
```

或者，如果您使用 C++11，则可以提供默认模板参数：

```
template <typename type_position = int> window(
  const int size[2],
  const char* caption="Window", const SDL_Surface* icon=NULL,
  bool fullscreen=false, bool vsync=true, bool resizable=false, int multisample=0,
  type_position position=type_position(0)
); 
```

或者，决定您是否真的想要一个带有需要推导的参数的模板构造函数。`type_position`如果您事先不知道它是什么，您打算如何处理该类型？某人以 a`std::string`作为`position`参数调用该构造函数是否有效？还是一个`vector<double>`？这可能是有道理的，这取决于你的类型做什么，但它并不总是有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:25:05.837

我想得越多，看起来你只需要提供一个单独的构造函数：

```
window(
    const int size[2],
    const char* caption="Window", const SDL_Surface* icon=NULL,
    bool fullscreen=false, bool vsync=true, bool resizable=false,
    int multisample=0,
    int position=0
) 
```

# facebook - 带有哈希的 Facebook Like 按钮

> ID：10791391
> 
> 赞同：4
> 
> 时间：2012-05-28T23:17:15.287
> 
> 标签：facebook, facebook-like, facebook-likebox

当我尝试向我的网站添加一个带有 url+hash ( [example.com/#TEST](http://example.com/#TEST) ) 的 FB Like 按钮并且我尝试单击 Like 按钮时 - 它在新闻提要 (example.com) 中共享没有哈希的链接。

当我尝试用“%23”代替“#”（[example.com/%23TEST](http://example.com/#TEST)）设置按钮时 - 它在计数框中分别计算每个哈希。

有什么办法可以用散列放置一个like按钮 - 并且仍然计算没有散列的url？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-04T17:23:42.063

当您创建类似 Facebook 的按钮时，Facebook 使用**cURL**（纠正我的人）来访问包含元数据的 URL。因此**，如果 cURL 看到不同的元数据**，每个 URL，您将获得不同的 LIKE 按钮。

但这不会发生；与服务器端一样，Facebook 会为每个`#`启用的动态链接看到相同的 URL。由于之前的链接部分`#`是相同的。JavaScript（或任何可以在 URL 中创建散列的行为）显然会被忽略，因为它的*行为*是客户端唯一的东西。

最好的方法是使用 JavaScript 动态创建 Button，并将每个按钮的 URL-to-like 更改为不带散列的友好内容。

```
abc.com/def#part1
abc.com/def#part2

// to
abc.com/def/part1
abc.com/def/part2 
```

仅用于 curl 脚本将其视为不同的 URL。

当用户点击该链接时，`abc.com/def/part1`您还需要**服务器端的帮助**`part1`才能从路由重定向到视图`def`。因此，您将在您的路由器代码中仅加载到路由`def`（想象 MVC），然后要求控制器加载视图`part1`，启用 JavaScript 以附加 URL hash `#part1`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T05:00:57.360

这些哈希标签用于客户端操作而不是服务器端。您将无法在您的赞按钮中使用它们。

# ruby-on-rails - 在 RABL 模板中渲染 ERB 模板

> ID：10791396
> 
> 赞同：5
> 
> 时间：2012-05-28T23:17:50.990
> 
> 标签：ruby-on-rails, erb, rabl

我有一个场景，我想用我的 JSON 传回一条长消息。与其用字符串连接写出来，我宁愿把一个 erb 模板放在一起，我可以将它渲染到我的 JSON 中。以下是我目前正在尝试的代码：

```
object @invitation

node(:phone_message) do |invitation| 
  begin
    old_formats = formats
    self.formats = [:text] # hack so partials resolve with html not json format
    view_renderer.render( self, {:template => "invitation_mailer/rsvp_sms", :object => @invitation})
  ensure
    self.formats = old_formats
  end
end 
```

第一次运行此代码时，一切都按预期工作，但是，我第二次运行它时遇到问题，因为它说缺少实例变量（我假设它是在第一次运行期间生成并缓存的）。

> 未定义的方法 _app_views_invitation_mailer_rsvp_sms_text_erb___2510743827238765954_2192068340 for # (ActionView::Template::Error)

有没有更好的方法将 erb 模板渲染成 rabl？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T12:16:28.187

您可以尝试单独使用 ERB，而不是通过视图渲染器，如下所示：

```
object @invitation

node(:phone_message) do |invitation| 
  begin
    template = ERB.new(File.read("path/to/template.erb"))
    template.result(binding)
  end
end 
```

`binding`是 Object 上的一个方法（通过 Kernel 模块），它返回包含当前上下文的绑定，其中还包括实例变量（`@invitation`在这种情况下）

**更新：**

真的不知道这是否会帮助您进一步了解（而且我也意识到距离您发布此内容已经一年多了），但这是另一种以独立方式呈现 ERB 模板的方法：

```
view = ActionView::Base.new(ActionController::Base.view_paths, {})  

class << view  
 include ApplicationHelper
 include Rails.application.routes.url_helpers
end  
Rails.application.routes.default_url_options = ActionMailer::Base.default_url_options
view.render(:file => "path/to/template.html.erb", :locals => {:local_var => 'content'}) 
```

当我有时间时，我应该和 Rabl 一起尝试一下。

# c# - 解析 AJAX 驱动的页面

> ID：10791398
> 
> 赞同：1
> 
> 时间：2012-05-28T23:18:14.673
> 
> 标签：c#, browser

我正在尝试解析页面加载完成后才填写的页面中的数据。因此，我无法获得一个简单的解决方案

```
while (wb.ReadyState != WebBrowserReadyState.Complete)
{
    Application.DoEvents();
} 
```

去工作。我曾尝试[在 C# 中使用 View Generated Source (After AJAX/JavaScript) 中](https://stackoverflow.com/questions/1307800/view-generated-source-after-ajax-javascript-in-c-sharp)找到的解决方案，但我无法弄清楚如何让它等待下载后加载数据。请帮忙！数据加载后自动填充到页面中，无需用户交互。谢谢！

我刚刚发现[Waiting for WebBrowser ajax content](https://stackoverflow.com/questions/3794522/waiting-for-webbrowser-ajax-content)答案是使用计时器....我不知道如何使用计时器而不是 Thread.Sleep() （它完全阻止线程）来解决这个问题，有人可以帮我吗通过快速示例代码了解使用它的正确方法？再次感谢

我正在研究自己调用 AJAX 的建议，但我认为使用计时器会更好。我仍在寻求有关该主题的帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T05:53:10.333

查看您正在处理的用于 Firefox 的 Firebug 的页面。有一个“Net”选项卡，它允许您查看在页面加载时（但在页面的初始部分已加载之后）发生的所有后续 HTTP Ajax 请求的实际原始数据。

通过查看这些数据，您很可能能够找到 JSON 或其他 XML 数据，其中包含您正在寻找的内容，以响应包含 ID 或类似性质的 GET 请求。

使用链接帖子中提到的“假”浏览器应该被视为最后的手段，因为它会产生最差的性能，因为您可能会下载和解析比必要更多的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T17:37:52.850

对于我的情况，以下解决了它：

```
while (wb.ReadyState != WebBrowserReadyState.Complete)
    Application.DoEvents();

while (wb.Document.GetElementById(elementId) != null && wb.Document.GetElementById(elementId).InnerHtml == null)
    Application.DoEvents(); 
```

第二个 while 循环等待 AJAX 填充指定的元素。在我的情况下，如果 url 中提供了无效的 store #，它会转发到 404 类型的页面。第一个条件验证该元素仍然存在于页面上，如果它被发送到 404 页面则不会。第二个条件等到元素被填充。

如果在 AJAX 填充页面后，我发现了一件有趣的事情，wb.Document.InnerText 和 wb.DocumentStream 仍然包含下载的 html。仅更新 wb.Document.InterHTML。在我的情况下，我正在从结果中创建一个 HtmlAgilityPack HtmlDocument。因为 DocumentStream 变得过时了，我必须像这样重新创建我的文档：

```
htmlDoc.LoadHtml("<html><head><title>" + wb.DocumentTitle + "</title></head><body>" + wb.Document.Body.InnerHtml + "</body></html>"); 
```

在我的情况下，我不关心标题中的元/脚本，所以这是可行的。如果有人关心这些事情，他们显然需要修改那行代码以供自己使用。

# ruby - Ruby 中的时间对象

> ID：10791400
> 
> 赞同：0
> 
> 时间：2012-05-28T23:18:23.767
> 
> 标签：ruby, ruby-on-rails-3

我想知道 Time.localtime 是返回用户本地时间还是服务器本地时间。

如果是服务器，是否有任何干净的方法可以将 UTC 时间或日期时间转换为用户本地时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:21:16.130

Ruby 的`Time`班级对任何“客户”一无所知。您必须为此检查请求标头。似乎是你想要的[`Time#getutc`](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-getutc)。[`Time#getlocal`](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-getlocal)请注意您可以在何处输入 TZ 偏移量的变体`getlocal`- 如果您将其传递给客户端的 TZ，您可以获得客户端的本地时间。正如我之前所说，您必须查看请求标头以确定它是哪个 TZ。

编辑：从头开始，显然请求中不必有 Date 标头。因此，您可以使用[JavaScript](https://stackoverflow.com/questions/4269270/rails-3-setting-the-timezone-to-the-current-users-timezone)来告诉您有关时区的信息。

# c# - 在 DevExpress 停靠面板中调整内容大小

> ID：10791404
> 
> 赞同：1
> 
> 时间：2012-05-28T23:19:19.403
> 
> 标签：c#, resize, devexpress, docking, dockpanel

我正在尝试使用 Devexpress 对接管理器和可停靠面板将三个面板添加到窗口中。以下是目前的结果：

![在此处输入图像描述](../Images/541340143e32f40ec46fdcc40bb36c7b.png)

这三个面板按我想要的方式放置和调整大小，但是当我调整窗口大小时，它们的内容不会正确调整大小。第一个图像通过无法填充窗口的图片框来表明这一点。我目前对此进行规范的尝试是：（Panel3 是指包含 pictureBox1 的面板。而该面板又包含在 dp3 中。）

```
 void dp3_SizeChanged(object sender, EventArgs e)
  {
     panel3.Size = panel3.Parent.Size;
     pictureBox1.Width = dp3.Width;
     pictureBox1.Height = dp3.Height;
  } 
```

控制窗口也是如此。除非窗口过大，否则我的控件不会出现。

![在此处输入图像描述](../Images/5dea73a1953b14a330e43c9448954da6.png)

控件包含在 4 个单独的面板中，这些面板本身包含在可停靠窗口中。

在停靠和调整大小时，如何使事物显示正确的大小和位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T05:22:38.883

> 阅读这篇 DevX 文章 -[在 Visual Studio .NET](http://www.devx.com/dotnet/Article/6964/1954) - [2](http://www.devx.com/dotnet/Article/6964)中设计可调整大小的 Windows 窗体，我最喜欢这篇文章来了解 .NET 中的布局`Winforms`。

您应该在表单中的控件上设置`Anchor`和`Dock`属性。

该`Anchor`属性控制控件的哪些边缘“绑定”或“绑定”到其窗体的相应边缘。
例如，如果您设置`Anchor`为`Bottom`，则控件底部边缘与其父控件底部之间的距离不会改变，因此控件将在您调整窗体大小时向下移动。
如果设置`Anchor`为`Top | Bottom`，控件将在您调整窗体大小时垂直调整大小。

要使用窗体调整控件大小，请将 设置`Anchor`为所有四个边，或设置`Dock`为`Fill`。

您可以将控件的`Dock`属性设置为`Fill`. 这将导致控件填充它的父容器。

您可能仍需要编写一些代码来处理子控件的布局。您可以通过处理`Resize`事件或使用支持调整大小的容器（例如`FlowLayoutPanel`或`TableLayoutPanel`）来做到这一点。

使用控件的`Anchor`属性。`Top, Bottom, Left, Right,`如果您希望它根据父控件在所有四个方向上调整大小，您可能需要将其设置为所有侧面

* * *

如果要[在 Resize 上保持控件 Aspect Ratio](https://stackoverflow.com/questions/721621/maintain-a-controls-aspect-ratio-on-resize)，则需要以某种方式存储纵横比，无论它是在设计时为您所知的，还是您只想在 InitializeComponent( ）。在表单的 Resize 事件中，

# optimization - 与最小内存占用的连续项目比较

> ID：10791407
> 
> 赞同：1
> 
> 时间：2012-05-28T23:20:04.140
> 
> 标签：optimization, j, memory-optimization

在 J（使用 J503，而不是 J6 或 7）中，通常当我想查看数组的元素是否小于其前任时，我使用以下命令：

```
 smaller =: }:<:}. 
```

这导致 n-1 项：

```
 smaller 1 2 3 4 5
1 1 1 1
   smaller 1 2 4 3
1 1 0 
```

在内部，`}:`创建`}.`两个数组（一个省略最后一项，另一个省略第一项），最后允许`<:`比较。总内存使用量将`2(n-1)`用于 2 个临时数组。

```
 memuse =: 7!:2
   i =: ,(10000#1)?10000
   memuse 'smaller i'
148480 
```

另一种在直觉上效果更好的方法需要更多的内存：

```
 smaller2 =: 13 : '2<:/\y.'
   memuse 'smaller i'
214400 
```

（J6 处理得更好。但我坚持使用 J5）。

对于相同的操作，什么是更精简的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:37:45.367

### 编辑：

在 J504 中，使用 rotate(1|.) 似乎是迄今为止最好的选择：

```
smallerS =: <:1&|.
l =: ?. 10000$1000
;memuse &.> 'smaller l';'smaller2 l';'smallerS l'
148480 214400 82880 
```

* * *

我希望

```
2<:/\y 
```

要**好得多**，因为这`2 f/\y`是[自 J 4.06 以来的特殊代码](http://www.jsoftware.com/help/release/infix2.htm)。如果`<:`是性能不佳的原因，请尝试：

```
0>:2-/\ y 
```

# javascript - target="_blank" 链接与 onclick javascript 更改 DOM 导致页面重新加载

> ID：10791410
> 
> 赞同：0
> 
> 时间：2012-05-28T23:20:30.630
> 
> 标签：javascript, html, hyperlink, parent, reload

```
<a href="http://www.google.com" target="_blank" onClick="javascript:_gaq.push(['_trackEvent', 'Conversion', 'Website', 'abc', 1]);goog_report_conversion_website();">the link</a>

<script type="text/javascript">
    goog_report_conversion_website = function() {
    $('#converstion_tracker_iframe').attr('src', '/conversion_tracker/website/');
    }
</script> 
```

上述链接的预期行为应该是在新窗口中打开链接并执行 2 个 js 函数。但是，goog_report_conversion_website() 函数会导致父页面在打开新窗口时重新加载。

我怀疑这是因为我正在更改父页面的 DOM，有人可以确认一下吗？还有如何在单击链接时停止父页面重新加载？

编辑：看起来更改 iframe 的 src 会导致页面重新加载

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:24:19.130

你试过`return false`这样添加吗？

```
<a href="http://www.google.com" target="_blank" onClick="javascript:_gaq.push(['_trackEvent', 'Conversion', 'Website', 'abc', 1]);goog_report_conversion_website(); return false;">the link</a> 
```

# database - 记录未保存到核心数据 sqlite 文件

> ID：10791413
> 
> 赞同：1
> 
> 时间：2012-05-28T23:20:52.987
> 
> 标签：database, sqlite, core-data, ios5, import

在 iOS 编程方面，我是一个完全的新手，更不用说核心数据了。这对我来说相当不直观，因为我真正开始使用 MATLAB 进行编程，我猜它更像是一种“脚本”语言。

无论如何，我的问题是我不知道我必须做什么来为我的应用程序创建一个数据库。所以我读了一点，认为我必须为我的东西创建一个 SQL 数据库，然后导入它。长话短说，我创建了一个 SQLite 数据库，我想使用我已经完成的工作将内容导入我的 CoreData 数据库。

我尝试导出到以逗号分隔的文件和 xml 文件并读取它们，但我不喜欢它，这似乎是我不需要做的额外步骤。

因此，我将 SQLite 数据库导入到我的资源中并添加了 sqlite 框架。

我有我的核心数据模型设置，它正在后台为模型正确设置 SQLite 数据库。

当我运行我的程序将对象添加到我的实体时，它似乎可以工作，我什至可以在之后获取结果。但是，当我检查 Core Data Database SQLite 文件时，没有保存任何记录。

它怎么可能获取结果但不将它们保存到数据库中？

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions{
//load in the path for resources
NSString *paths = [[NSBundle mainBundle] resourcePath];
NSString *databaseName = @"histology.sqlite";
NSString *databasePath = [paths stringByAppendingPathComponent:databaseName];
[self createDatabase:databasePath ];

NSError *error;
if ([[self managedObjectContext] save:&error]) {
    NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
}

// Test listing all CELLS from the store
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entityMO = [NSEntityDescription entityForName:@"CELL"
                                            inManagedObjectContext:[self managedObjectContext]];
[fetchRequest setEntity:entityMO];
NSArray *fetchedObjects = [[self managedObjectContext] executeFetchRequest:fetchRequest error:&error];
for (CELL *cellName in fetchedObjects) {
    //NSLog(@"cellName: %@", cellName);
}    

-(void) createDatabase:databasePath {
NSLog(@"The createDatabase function was entered.");  
NSLog(@"The databasePath is %@ ",[databasePath description]);
// Setup the database object
sqlite3 *histoDatabase;

// Open the database from filessytem
if(sqlite3_open([databasePath UTF8String], &histoDatabase) == SQLITE_OK) {
        NSLog(@"The database was opened");
    // Setup the SQL Statement and compile it for faster access
    const char *sqlStatement = "SELECT * FROM CELL";
    sqlite3_stmt *compiledStatement;

    if(sqlite3_prepare_v2(histoDatabase, sqlStatement, -1, &compiledStatement, NULL) != SQLITE_OK) {
        NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(histoDatabase));
    }

    if(sqlite3_prepare_v2(histoDatabase, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK) {

        // Loop through the results and add them to cell MO array
        while(sqlite3_step(compiledStatement) == SQLITE_ROW) {
            CELL *cellMO = [NSEntityDescription insertNewObjectForEntityForName:@"CELL" inManagedObjectContext:[self managedObjectContext]];

            if (sqlite3_column_type(compiledStatement, 0) != SQLITE_NULL) {
                cellMO.cellName = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 0)];
            } else {
                cellMO.cellName = @"undefined";
            }

            if (sqlite3_column_type(compiledStatement, 1) != SQLITE_NULL) {
                cellMO.cellDescription = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 1)];
            } else {
                cellMO.cellDescription = @"undefined";
            }

                NSLog(@"The contents of NSString *cellName = %@",[cellMO.cellName   description]);

        }
    }

    // Release the compiled statement from memory
    sqlite3_finalize(compiledStatement);

}
sqlite3_close(histoDatabase);
} 
```

我觉得这与打开/关闭两个数据库的时间有关？

附上我有一些SQL调试输出到终端

```
2012-05-28 16:03:39.556 MedPix[34751:fb03] The createDatabase function was entered.

2012-05-28 16:03:39.557 MedPix[34751:fb03] The databasePath is /Users/jack/Library/Application Support/iPhone Simulator/5.1/Applications/A6B2A79D-BA93-4E24-9291-5B7948A3CDF4/MedPix.app/histology.sqlite 

2012-05-28 16:03:39.559 MedPix[34751:fb03] The database was opened

2012-05-28 16:03:39.560 MedPix[34751:fb03] The database was prepared

2012-05-28 16:03:39.575 MedPix[34751:fb03] CoreData: annotation: Connecting to sqlite database file at "/Users/jack/Library/Application Support/iPhone Simulator/5.1/Applications/A6B2A79D-BA93-4E24-9291-5B7948A3CDF4/Documents/MedPix.sqlite"

2012-05-28 16:03:39.576 MedPix[34751:fb03] CoreData: annotation: creating schema.

2012-05-28 16:03:39.577 MedPix[34751:fb03] CoreData: sql: pragma page_size=4096

2012-05-28 16:03:39.578 MedPix[34751:fb03] CoreData: sql: pragma auto_vacuum=2

2012-05-28 16:03:39.630 MedPix[34751:fb03] CoreData: sql: BEGIN EXCLUSIVE

2012-05-28 16:03:39.631 MedPix[34751:fb03] CoreData: sql: SELECT TBL_NAME FROM SQLITE_MASTER WHERE TBL_NAME = 'Z_METADATA'

2012-05-28 16:03:39.632 MedPix[34751:fb03] CoreData: sql: CREATE TABLE ZCELL ( Z_PK INTEGER PRIMARY KEY, Z_ENT INTEGER, Z_OPT INTEGER, ZCELLDESCRIPTION VARCHAR, ZCELLNAME VARCHAR ) 
...

2012-05-28 16:03:39.669 MedPix[34751:fb03] CoreData: annotation: Creating primary key table.

2012-05-28 16:03:39.671 MedPix[34751:fb03] CoreData: sql: CREATE TABLE Z_PRIMARYKEY (Z_ENT INTEGER PRIMARY KEY, Z_NAME VARCHAR, Z_SUPER INTEGER, Z_MAX INTEGER)

2012-05-28 16:03:39.672 MedPix[34751:fb03] CoreData: sql: INSERT INTO Z_PRIMARYKEY(Z_ENT, Z_NAME, Z_SUPER, Z_MAX) VALUES(1, 'CELL', 0, 0)
...

2012-05-28 16:03:39.701 MedPix[34751:fb03] CoreData: sql: CREATE TABLE Z_METADATA (Z_VERSION INTEGER PRIMARY KEY, Z_UUID VARCHAR(255), Z_PLIST BLOB)

2012-05-28 16:03:39.702 MedPix[34751:fb03] CoreData: sql: SELECT TBL_NAME FROM SQLITE_MASTER WHERE TBL_NAME = 'Z_METADATA'

2012-05-28 16:03:39.703 MedPix[34751:fb03] CoreData: sql: DELETE FROM Z_METADATA WHERE Z_VERSION = ?

2012-05-28 16:03:39.704 MedPix[34751:fb03] CoreData: sql: INSERT INTO Z_METADATA (Z_VERSION, Z_UUID, Z_PLIST) VALUES (?, ?, ?)

2012-05-28 16:03:39.705 MedPix[34751:fb03] CoreData: sql: COMMIT

2012-05-28 16:03:39.710 MedPix[34751:fb03] CoreData: sql: pragma cache_size=200

2012-05-28 16:03:39.711 MedPix[34751:fb03] CoreData: sql: SELECT Z_VERSION, Z_UUID, Z_PLIST FROM Z_METADATA

2012-05-28 16:03:39.712 MedPix[34751:fb03] The contents of NSString *cellName = Beta Cell

2012-05-28 16:03:39.712 MedPix[34751:fb03] The contents of NSString *cellName = Gastric Chief Cell

...

2012-05-28 16:03:39.714 MedPix[34751:fb03] The database was prepared

2012-05-28 16:03:39.764 MedPix[34751:fb03] The createDatabase function has finished. Now fetching.

2012-05-28 16:03:39.765 MedPix[34751:fb03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZCELLDESCRIPTION, t0.ZCELLNAME FROM ZCELL t0 

2012-05-28 16:03:39.766 MedPix[34751:fb03] CoreData: annotation: sql connection fetch time: 0.0008s

2012-05-28 16:03:39.767 MedPix[34751:fb03] CoreData: annotation: total fetch execution time: 0.0016s for 0 rows.

2012-05-28 16:03:39.768 MedPix[34751:fb03] cellName: <CELL: 0x6bbc120> (entity: CELL; id: 0x6bbc160 <x-coredata:///CELL/t57D10DDD-74E2-474F-97EE-E3BD0FF684DA34> ; data: {
cellDescription = "S cells are cells which release secretin, found in the jejunum and duodenum. They are stimulated by a drop in pH to 4 or below in the small intestine's lumen. The released secretin will increase the s";
cellName = "S Cell";
organs =     (
);
specimens =     (
);
systems =     (
);
tissues =     (
);
})
... 
```

部分被缩短以缩写。但请注意，提取结果包含信息，但它说总提取执行是针对“0”行？这个怎么可能？任何帮助将不胜感激，尤其是详细的解释。：） 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T04:55:51.320

有几件事。

首先，根据您导入的数据库的大小，您可能希望从主线程中获取导入。否则，如果您在 applicationDidFinishLaunching: 方法中需要很长时间才能完成，系统将终止您的应用程序。您可以按如下方式执行此操作：

```
// If in applicationDidFinishLaunching, we need to first schedule on the main queue
// We do this to be one of the first things scheduled once the main queue starts running
dispatch_async(dispatch_get_main_queue(), ^{
    // now get off the main queue
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),^{
       [self createDatabase:databasePath];

       // Now put the results back on the main queue
       dispatch_async(dispatch_get_main_queue(), ^{
           NSError *error;
           if ([[self managedObjectContext] save:&error]) {
              NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
           }

       // Test listing all CELLS from the store
           NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
           NSEntityDescription *entityMO = [NSEntityDescription entityForName:@"CELL"
                                        inManagedObjectContext:[self managedObjectContext]];
           [fetchRequest setEntity:entityMO];
           NSArray *fetchedObjects = [[self managedObjectContext] executeFetchRequest:fetchRequest error:&error];
           for (CELL *cellName in fetchedObjects) {
              //NSLog(@"cellName: %@", cellName);
           }
       });    

    });
}); 
```

我会检查导入是否已完成，如果没有，则使用 Grand Central Dispatch 将导入工作从主线程中移除。

其次，正如 gerry3 在他的回答中提到的那样，您需要将 save: 消息发送到您的托管对象上下文。使用 iOS5 的父子上下文将允许您通过子上下文在后台轻松导入，然后将这些更改推送到主父上下文。查看 WWDC 2011 核心数据会话和堆栈溢出以获得良好的概述。

在您上面的代码的上下文中，您将执行以下所有操作：

```
// create a child context with a concurrent queue type.
NSManagedObjectContext *childManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];

// Set the parentContext.  Now whenever we save changes to the child context
// They will be pushed up to the parentContext and we can choose to save or throw them
// away
childManagedObjectContext.parentContext=self.managedObjectContext;

// Loop through the results and add them to cell MO array
NSInteger rowNumber=0;
while(sqlite3_step(compiledStatement) == SQLITE_ROW) {
        CELL *cellMO = [NSEntityDescription insertNewObjectForEntityForName:@"CELL" inManagedObjectContext:[self managedObjectContext]];

   if (sqlite3_column_type(compiledStatement, 0) != SQLITE_NULL) {
        cellMO.cellName = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 0)];
   } else {
        cellMO.cellName = @"undefined";
   }

   if (sqlite3_column_type(compiledStatement, 1) != SQLITE_NULL) {
        cellMO.cellDescription = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 1)];
   } else {
        cellMO.cellDescription = @"undefined";
   }
   NSLog(@"The contents of NSString *cellName = %@",[cellMO.cellName   description]);

   // Save our records periodically.  Choose a good number of iterations on this.
   // depends on your particular situation.
   if (rowNumber%100==0){
       NSError *mocError=nil;
       // Save the changes on the child context
       // This will push the changes up to the parent context.
       [childManagedObjectContext performBlock:^{
            [self.managedObjectContext save: &mocError];
            if (mocError){
                NSLog(@"mocError on rowNumber:  %d, error:  %@",rowNumber, error);
            }
            // Now save the changes on the parent context

            [self.managedObjectContext performBlock:^{
                    NSError *parentMocError=nil;
                    [self.managedObjectContext save: &parentMocError];
                    if (parentMocError){
                      NSLog(@"parentMocError on rowNumber:  %d, error:  %@",rowNumber, parentMocError);
                    }
             }];

       }];

   }
   rowNumber=rowNumber+1;
}

// Pickup and stragglers
[childManagedObjectContext performBlock:^{
     [self.managedObjectContext save: &mocError];
     if (mocError){
        NSLog(@"mocError on rowNumber:  %d, error:  %@",rowNumber, error);
     }
     // Now save the changes on the parent context

     [self.managedObjectContext performBlock:^{
           NSError *parentMocError=nil;
           [self.managedObjectContext save: &parentMocError];
               if (parentMocError){
                  NSLog(@"parentMocError on rowNumber:  %d, error:  %@",rowNumber, parentMocError);
               }
           }];

 }]; 
```

祝你好运！

蒂姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T03:51:28.130

插入所有新对象后，您需要再次`save:`使用。`managedObjectContext`

如果您要插入大量新对象，您可能希望在整个过程中定期保存。

# python - Python open() 模式和文件写入

> ID：10791418
> 
> 赞同：1
> 
> 时间：2012-05-28T23:21:23.090
> 
> 标签：python, pygtk

我正在学习 PyGTK，我正在制作一个文本编辑器（这似乎是 pygtk 的世界：]） 无论如何，我有一个“保存”功能，可以将 TextBuffer 写入文件。看起来像

```
try:
    f = open(self.working_file_path, "rw+")
    buff = self._get_buffer()
    f.write(self._get_text())
    #update modified flag
    buff.set_modified(False)
    f.close()

except IOError as e:
    print "File Doesnt Exist so bring up Save As..."
    ...... 
```

基本上，如果文件存在，则将缓冲区写入其中，如果不存在，则打开另存为对话框。

我的问题是：“更新”文件的最佳方式是什么。我似乎只能附加到文件的末尾。我尝试了各种文件模式，但我确定我错过了一些东西。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T23:49:53.473

您**可以**在模式下打开文件`"r+"`，该模式允许您读取和写入文件，并寻找特定位置并在那里写入。不过，这可能无法帮助您做我认为您想要的事情；听起来您只想写出更改的数据？

请记住，文件在磁盘上不是存储为一系列可扩展的行，它只是一个字节序列；其中一些字节表示行尾，但下一行紧随其后。因此，如果您编辑文件中的第一行并写出新的第一行，除非新行的长度与旧行的长度**完全相同**，否则第二行现在将不在正确的位置，所以您需要移动它（如果您写出的新行比原来的长，请先复制它）。现在这意味着下一行也不在正确的位置......依此类推，直到您必须读入并写出文件的整个其余部分。

实际上，除非您可以简单地追加更多数据，否则您几乎不会只写入现有文件的一部分；如果您需要“更改”您读入的文件，请在内存中对其进行更改，然后将其写回，**或者**您分段读取文件（通常是逐行），然后随时写入**新**文件（然后可能将新文件移动到原始文件的顶部）。第一种方法最简单，第二种方法更好，因为不必一次将整个内容保存在内存中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T23:56:54.103

在您写入文件的位置，您的位置在文件的末尾，因此您需要回到开头。然后，您将覆盖该文件，但这可能会在最后留下旧内容，因此您还需要截断该文件。

此外，您指定的模式 ( `'rw+'`) 无效，当我尝试对使用它打开的文件执行一些操作时，我得到 IOErrors。我相信您想要模式`'r+'`（*“[打开以进行读写](http://linux.die.net/man/3/fopen)。流位于文件的开头。”*）。 `'w+'`类似，但如果文件不存在，则会创建该文件。

所以，你正在寻找的可能是这样的代码：

```
try:
    f = open(self.working_file_path, "r+")
    buff = self._get_buffer()
    f.seek(0)
    f.truncate()
    f.write(self._get_text())
    #update modified flag
    buff.set_modified(False)
    f.close()

except IOError as e:
    print "File Doesnt Exist so bring up Save As..."
    ...... 
```

但是，您可能希望修改此代码以在截断和写入文件时正确捕获和处理错误，而不是假设本节中的所有 IOErrors 都是来自调用 open 的不存在文件错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:28:33.177

将文件作为列表读入，在其开头添加一个元素，然后将其全部写出。像这样的东西。

```
f = open(self.working_file_path, "r+")
flist = f.readlines()
flist.insert(0, self._get_text())
f.seek(0)
f.writelines(flist) 
```

# javascript - jQuery .live('click', function() {}); 不适用于 iPad

> ID：10791419
> 
> 赞同：0
> 
> 时间：2012-05-28T23:21:30.123
> 
> 标签：javascript, jquery, ipad, safari, mobile-safari

我有一些 jQuery 函数，当在字段中选择新值时会更新一些数字`<SELECT>`。这些`<SELECT>`项目由用户动态添加，因此这些函数使用 .live() 函数。在 Mozilla、Chrome 和 IE8 中一切都按计划进行，但是当我尝试在我的 iPad 上访问该页面时，数字不再相应地更新。我必须再次**单击**该`<SELECT>`字段才能更新数字**。**这是我的功能之一：

```
 // Update subtotal when .months is changed
    $(".months").live('click',function(){

        var pid = this.id.replace("months", "");
        var price = document.getElementById('row' + pid).className;
        updateSubtotal(pid, price);

    }); 
```

所有功能都包含在`document.ready()`块中。我已经尝试过“单击更改”并且也尝试过“更改”，但是它们在其他一些浏览器中存在问题。

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:27:24.353

iPad 和选择元素玩得不是很好。如果您需要选择的值来做任何事情，您将需要绑定到**模糊。**

尝试这样的事情（*.months*应该是你的选择元素）：

```
// Update subtotal when .months is changed
$(".months").on('blur', function(){

    var pid = this.id.replace("months", "");
    var price = document.getElementById('row' + pid).className;
    updateSubtotal(pid, price);

   }); 
```

**编辑**
试试这个：

```
// Update subtotal when .months is changed
$(document).on('blur|click', ".months", function(){
    var pid = this.id.replace("months", "");
    var price = document.getElementById('row' + pid).className;
    updateSubtotal(pid, price);
    }); 
```

**on()**的好处是你可以将它附加到一个元素并从那里委托。由于您的*$(document)*将始终存在，它还可以捕获您动态添加到页面的元素，而这些元素从一开始就不存在。由于您的原始代码*实时*使用，我希望元素能够动态加载或生成。在这种情况下，为了使用*on()*将事件绑定到它，您必须绑定到*文档*并*委托*给即将到来的任何*.months*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T15:13:45.080

如果您将一个空的 onclick="" 添加到 div （或 span 或其他任何内容），它会起作用....我不知道为什么:)

# c++ - 在xcode中切换到objective-c ++时出现malloc错误

> ID：10791420
> 
> 赞同：0
> 
> 时间：2012-05-28T23:21:36.207
> 
> 标签：c++, xcode, malloc, type-conversion, objective-c++

我有一个想在我的 Objective-C 项目中使用的 C++ 类。如果没有 #include 任何 C++ 头文件，当我将我的 Obj-C 文件从“.m”重命名为“.mm”并因此切换编译器时，编译器会产生一大堆 malloc 错误：

```
double * pointValues = malloc(sizeof(double *)*numOfPts);

error: invalid conversion from 'void*' to 'double*' 
```

突然，所有带有 malloc 的行都变得无效。使用 Obj-C++ 编译器时是否必须对“malloc”进行类型转换，或者这是其他问题的表现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:23:01.717

在 C++ 中，没有从`void*`到其他指针类型的隐式转换，因此您必须显式转换。不仅使用 Objective-C++ 编译器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:24:42.093

C++ 具有强类型。C++ 中不允许直接转换：

```
double * pointValues = (double*) malloc(sizeof(double *)*numOfPts);
//                        |
//                  explicit cast 
```

# jquery - 如何在jquery中取消设置偏移量

> ID：10791423
> 
> 赞同：0
> 
> 时间：2012-05-28T23:22:08.067
> 
> 标签：jquery, html, offset

我在取消设置元素的偏移量时遇到问题。这是我在 jsfiddle 中的代码：http: [//jsfiddle.net/hhQH2/39/](http://jsfiddle.net/hhQH2/39/)

这是我的代码：HTML：

```
<div class="div" id="378246"></div>
<div class="promoBook" id="378246"></div>
<div class="availability"><div class="avClose">X</div></div>
<div class='tellme'></div> 
```

CSS：

```
.promoBook{
margin-top: 100px;
margin-left: 100px;
background: #333;
width: 120px;
height: 45px;
    color: #fff;
}
.availability{
position: absolute;
background: red;
width: 200px;
height: 150px;
    display: none;
} 
```

查询：

```
//pop up availability 
$(".promoBook").click(function(){
    var btnavail = $(".availability");
    var bookId = $(this).attr("id");
    var btnpos = $(this).offset();

    $(".tellme").text(btnpos.left + btnpos.top);

    //change position of availability div
    btnavail.offset(btnpos);
    btnavail.show();
    $(".avClose").click(function(){
    btnavail.hide();
    btnavail.offset({left:0,top:0});    
    });

    });​ 
```

主要问题是它没有擦除设置的偏移量......它保存旧的并添加新的。我希望这是有道理的..任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:33:20.397

在 jQuery 文档中：

> 注意：jQuery 不支持获取隐藏元素的偏移坐标或考虑在 body 元素上设置的边框、边距或填充。

我相信当你想设置它时它是一样的；）

要解决您的问题，只需反转 close 方法的两行：

```
$(".avClose").click(function(){
    btnavail.offset({left:0,top:0});    
    btnavail.hide();

}); 
```

# c# - C#如何从数组中排除一个int？

> ID：10791424
> 
> 赞同：-1
> 
> 时间：2012-05-28T23:22:27.080
> 
> 标签：c#, arrays, int

所以我有一个整数数组。我想使用循环并排除使等式成立的整数。所以这就像

```
for (int n = 0; n < first9char.Length; n++ ) {
                                        if (first9char[n] == clickValue) {
                                            first9char[n] = first9char[n + 1]; 
```

但是它只会改变等于不改变整个数组的值。那么有没有办法做到这一点？

我想在这个循环中使用它。

```
 if (UserSquareMethod.clickedBoxes[0] == -1) {
            MessageBox.Show("You have not selected any box");
        } else {
            int i = 0;
            do {
                if (textButtonArray[clickedBox[i]].Text == "" || clickValue == "") {
                    textButtonArray[clickedBox[i]].Text = clickValue;
                    textButtonArray[clickedBox[i]].Font = new Font(textButtonArray[clickedBox[i]].Font.FontFamily, 14, FontStyle.Bold);
                }

                else
                {
                    textButtonArray[clickedBox[i]].Text += "," + clickValue;
                    textButtonArray[clickedBox[i]].Font = new Font(textButtonArray[clickedBox[i]].Font.FontFamily, 5, FontStyle.Regular);
                    string[] first9char = textButtonArray[clickedBox[i]].Text.Split(new string[] { "," }, StringSplitOptions.None);
                    for (int j = 1; j < first9char.Length; j++)
                    {
                        for (int k = j - 1; k >= 0; k--)
                        {
                            if (first9char[j] == first9char[k])
                            {
                                if (clearNumberClicked == true)
                                {
                                    first9char = Array.FindAll(first9char, x => x != clickValue);
                                    label2.Text = first9char[0];

                                    //int n = 0;

                                    //for (int p = 0; p < first9char.Length; p++)
                                    //{
                                      //  if (first9char[p] != clickValue)
                                      //  {
                                        //    first9char[n] = first9char[p];
                                        //    n++;
                                        //    label2.Text += "," + first9char[n];
                                       // }
                                   // }

                                    //for (int n = 0; n < first9char.Length; n++ ) {
                                        //if (first9char[n] == clickValue) {
                                          //  first9char[n] = first9char[n + 1];
                                          //  for ( int p = 0; p < n; p++) {

                                                //}

                                        //}
                                    //}
                                    MessageBox.Show("Clear the number" + first9char[(first9char.Length - 1)] + "and " + clickValue + " " + first9char.Length);

                                }

                                else {
                                first9char[j] = "";
                                textButtonArray[clickedBox[i]].Text = first9char[0]; 
                                MessageBox.Show("You cannot enter the same number again!"+ first9char[j]+j);
                                for (int m = 1; m < (first9char.Length - 1); m++) {
                                    textButtonArray[clickedBox[i]].Text += ","+ first9char[m]; 

                                }
                            }

                            }
                        }

                    }

                    if (textButtonArray[clickedBox[i]].Text.Length > 9)
                    {

                        textButtonArray[clickedBox[i]].Text = first9char[0] + "," + first9char[1] + "," + first9char[2] + "," + first9char[3] + "," + first9char[4];
                        MessageBox.Show("You cannot enter more than 5 numbers, please clear the box if you want to enter different number." + textButtonArray[clickedBox[i]].Text.Length);
                    }

                }
                i++;

            }
            while (clickedBox[i] != -1);

        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:25:34.617

我会为此使用 LINQ：

```
first9char = first9char.Where(x => x != clickValue).ToArray(); 
```

它只是意味着“选择不匹配的项目”。如果由于某种原因您不能使用 LINQ，那么只需保留另一个计数器，并确保仅从`n`那里循环到：

```
int n = 0;

for(int i = 0; i < first9char.Length; i++) {
    if(first9char[i] != clickValue) {
        first9char[n] = first9char[i];
        n++;
    }
} 
```

清洁高效。

# jar - LWJGL 可执行 jar 启动然后崩溃

> ID：10791426
> 
> 赞同：0
> 
> 时间：2012-05-28T23:22:43.833
> 
> 标签：jar, crash, lwjgl

我很想得到一些帮助。我为读取四个 .obj 文件和一个纹理文件的类开发了这个程序。它在我的 IDE (Eclipse) 中运行良好，但是当我将其导出并使用 JavaSplice 创建最终的可执行 jar 时，它会启动，显示一个显示窗口一小会儿，然后就崩溃了。通过一些测试和仔细的评论，我确定它不是在拼接端，而是我的代码。通过评论，我确定问题出在四个 .obj 中读取的显示列表中：

```
int objectOneDisplayList = glGenLists(1);
glNewList(objectOneDisplayList, GL_COMPILE);
{   
        Model m = null;
        try
        {
            m = OBJLoader.loadModel(new File("res/circle.obj"));
        }
        catch(FileNotFoundException e)
        {
            e.printStackTrace();
            Display.destroy();
        }
        catch(IOException e)
        {
            e.printStackTrace();
            Display.destroy();
        }

        glBegin(GL_TRIANGLES);
        for(Face face : m.faces)
        {
            glColor3f(0.0f, 0.75f, 0.0f);
            Vector3f n1 = m.normals.get((int) face.normal.x - 1);
            glNormal3f(n1.x, n1.y, n1.z);
            Vector3f v1 = m.vertices.get((int) face.vertex.x - 1);
            glVertex3f(v1.x, v1.y, v1.z);
            Vector3f n2 = m.normals.get((int) face.normal.y - 1);
            glNormal3f(n2.x, n2.y, n2.z);
            Vector3f v2 = m.vertices.get((int) face.vertex.y - 1);
            glVertex3f(v2.x, v2.y, v2.z);
            Vector3f n3 = m.normals.get((int) face.normal.z - 1);
            glNormal3f(n3.x, n3.y, n3.z);
            Vector3f v3 = m.vertices.get((int) face.vertex.z - 1);
            glVertex3f(v3.x, v3.y, v3.z);
        }
        glEnd();
    }
    glEndList(); 
```

其中有四个只是具有不同的文件名和列表名称。现在这是我的 OBJLoader 类：

```
package base;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import org.lwjgl.util.vector.Vector3f;

public class OBJLoader
{
    public static Model loadModel(File f) throws FileNotFoundException, IOException 
    {
        BufferedReader reader = new BufferedReader(new FileReader(f));
        Model m = new Model();
        String line;
       while((line = reader.readLine()) != null)
       {
            if(line.startsWith("v "))
            {
                float x = Float.valueOf(line.split(" ")[1]);
                float y = Float.valueOf(line.split(" ")[2]);
                float z = Float.valueOf(line.split(" ")[3]);
                m.vertices.add(new Vector3f(x, y, z));
            }
            else if(line.startsWith("vn "))
            {
                float x = Float.valueOf(line.split(" ")[1]);
                float y = Float.valueOf(line.split(" ")[2]);
                float z = Float.valueOf(line.split(" ")[3]);
                m.normals.add(new Vector3f(x, y, z));
            }
            else if(line.startsWith("f "))
            {
                Vector3f vertexIndices = new Vector3f(Float.valueOf(line.split(" ")[1].split("/")[0]),
                Float.valueOf(line.split(" ")[2].split("/")[0]),
                Float.valueOf(line.split(" ")[3].split("/")[0]));
                Vector3f normalIndices = new Vector3f(Float.valueOf(line.split(" ")[1].split("/")[2]),
                Float.valueOf(line.split(" ")[2].split("/")[2]),
                Float.valueOf(line.split(" ")[3].split("/")[2]));

                m.faces.add(new Face(vertexIndices, normalIndices));
            }
        }
        reader.close();
        return m;
    }
} 
```

我认为这是因为我需要使用 InputFileStream。有人可以告诉我如何使用它来重写它吗？

编辑：重写了 OBJLoader 以不使用 FileReader，仍然没有工作。我想我不能使用任何类型的阅读器。那我该如何阅读这些行？：

```
public class OBJLoader
{
    public static Model loadModel(File f) throws FileNotFoundException, IOException 
    {
        BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(f)));
        Model m = new Model();
        String line;
        while((line = reader.readLine()) != null)
        {
            if(line.startsWith("v "))
            {
                float x = Float.valueOf(line.split(" ")[1]);
                float y = Float.valueOf(line.split(" ")[2]);
                float z = Float.valueOf(line.split(" ")[3]);
                m.vertices.add(new Vector3f(x, y, z));
            }
            else if(line.startsWith("vn "))
            {
                float x = Float.valueOf(line.split(" ")[1]);
                float y = Float.valueOf(line.split(" ")[2]);
                float z = Float.valueOf(line.split(" ")[3]);
                m.normals.add(new Vector3f(x, y, z));
            }
            else if(line.startsWith("f "))
            {
                Vector3f vertexIndices = new Vector3f(Float.valueOf(line.split(" ")[1].split("/")[0]),
                        Float.valueOf(line.split(" ")[2].split("/")[0]),
                        Float.valueOf(line.split(" ")[3].split("/")[0]));
                Vector3f normalIndices = new Vector3f(Float.valueOf(line.split(" ")[1].split("/")[2]),
                        Float.valueOf(line.split(" ")[2].split("/")[2]),
                        Float.valueOf(line.split(" ")[3].split("/")[2]));

                m.faces.add(new Face(vertexIndices, normalIndices));
            }
        }
        reader.close();
        return m;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:54:25.023

打开命令提示符，输入：

```
java -jar "pathToYourJar.jar" 
```

有了这个，你可以看到代码抛出了什么异常。

关于崩溃，我认为可以使用 InputStreams 而不是 Files 来解决问题。

改变：

```
BufferedReader reader = new BufferedReader(new InputStreamReader
    (new FileInputStream(f))); 
```

进入

```
String path = "/package1/package2/file.obj";
InputStream source = ClassLoader.class.getResourceAsStream(path);
BufferedReader reader = new BufferedReader(new InputStreamReader
    (source); 
```

这适用于 Eclipse 和 JAR。

# java - 外部 Jar 编译错误

> ID：10791429
> 
> 赞同：0
> 
> 时间：2012-05-28T23:23:35.460
> 
> 标签：java, classnotfoundexception

我正在尝试命令行编译我的代码，但我无法让它正常运行。我的项目在 Eclipse 中，我可以指定要包含的 jar 文件的位置，但命令行是另一个问题。所有 .java 和 .jar 文件都在同一个目录中。

我可以编译

```
javac -classpath opencsv-2.3.jar *.java 
```

如果我尝试运行我的代码，我会收到以下异常。

```
java ClassificationGenerator 
```

线程“主”java.lang.NoClassDefFoundError 中的异常：au/com/bytecode/opencsv/CSVReader

我尝试运行代码

```
java -classpath opencsv-2.3.jar ClassificationGenerator 
```

但后来我得到

```
Exception in thread "main" java.lang.NoClassDefFoundError: ClassificationGenerator
Caused by: java.lang.ClassNotFoundException: ClassificationGenerator
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:25:31.393

您需要在运行时在类路径中提供 jar，嗯：

```
java -classpath .;opencsv-2.3.jar ClassificationGenerator 
```

# android - Android AVD 从不启动

> ID：10791432
> 
> 赞同：1
> 
> 时间：2012-05-28T23:23:51.727
> 
> 标签：android, eclipse

我刚刚安装了具有测试和开发所需的所有要求的 Android SDK，但是有一个问题。编译和构建应用程序工作正常，但是当我按下运行按钮时。有时候是这样的。

模拟器只是一个带键盘的黑屏。这就是日志输出的内容：

> [2012-05-28 16:04:35 - RedstoneCraft] ------------------------------
> [2012-05-28 16:04:35 - RedstoneCraft] Android 发布！
> [2012-05-28 16:04:35 - RedstoneCraft] adb 运行正常。
> [2012-05-28 16:04:35 - RedstoneCraft] 执行 mx.x10.redstonecraft.app.RedstoneCraftActivity 活动启动
> [2012-05-28 16:04:35 - RedstoneCraft] 自动目标模式：启动具有兼容 AVD 的新模拟器'Android'
> [2012-05-28 16:04:35 - RedstoneCraft] 使用虚拟设备'Android' 启动新模拟器
> [2012-05-28 16:04:49 - RedstoneCraft] 发现新模拟器：emulator-5554
> [2012 -05-28 16:04:49 - RedstoneCraft] 等待 HOME ('android.process.acore') 启动...
> [2012-05-28 16:06:05 - RedstoneCraft] 模拟器 5554 已断开连接！取消“mx.x10.redstonecraft.app.RedstoneCraftActivity 活动启动”！

然后当它说 emulator-5554 断开连接时，那就是 android 屏幕弹出但一直呆在那里直到我关闭模拟器。我已经尝试了一切，但仍然没有帮助。:(

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-29T04:50:56.053

只需关闭模拟器并重新启动即可。即使您得到“ emulator-5554 已断开连接！取消 'mx.x10.redstonecraft.app.RedstoneCraftActivity 活动启动'！” 只需尝试关闭模拟器并重新启动即可。有用。

# asp.net-mvc - 通过 Datacontext 非常缓慢地保存更改

> ID：10791433
> 
> 赞同：1
> 
> 时间：2012-05-28T23:24:06.847
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, datacontext, azure-sql-database

我正在使用实体框架和 SQL Azure 数据库开发 MVC3 .NET 项目。

当我尝试在一个表中一次保存多条记录时，需要几分钟才能完成操作！

我使用相同的 Datacontext 来添加对象和保存更改，我也尝试使用多个 Datacontexts，但结果是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:51:42.303

此外，请查看以下文件：

实体框架性能注意事项：http: [//msdn.microsoft.com/en-us/library/cc853327.aspx](http://msdn.microsoft.com/en-us/library/cc853327.aspx)

SQL Azure 性能指南：[http ://social.technet.microsoft.com/wiki/contents/articles/sql-azure-performance-and-elasticity-guide.aspx](http://social.technet.microsoft.com/wiki/contents/articles/sql-azure-performance-and-elasticity-guide.aspx)

此致，

明旭。

# ruby-on-rails - 测试运行失败后数据库脏，如何修复？

> ID：10791437
> 
> 赞同：0
> 
> 时间：2012-05-28T23:24:49.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, tdd, bdd

对于我的测试，我使用最新的 Rspec、FactoryGirl、Guard 组合来对抗本地 SQLite 数据库。当我在开发 BDD 风格时，我经常会编写一个失败的测试，它可能会在数据库中留下一些垃圾数据，我认为尤其是在存在解释器错误的情况下。

我经常被迫删除数据库并重新迁移以将其恢复到干净状态，这既费时又痛苦。似乎大多数时候 Rspec 自己的回滚机制做得很好，但有时还不够。

处理这种情况的正确方法是什么？每次执行单个测试时都应该擦除数据库吗？database_cleaner 会比 Rspec 做得更好吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:27:23.870

脑海中浮现出三种方式。

一，将您的测试包装在事务中，并在最后回滚。

二、使用可以非常快速地创建/拆除的内存数据库

三，完全模拟您的数据库连接并根据进行的数据库调用执行验证。

# javascript - 在 JavaScript 中构建和维护选项数组/对象

> ID：10791438
> 
> 赞同：1
> 
> 时间：2012-05-28T23:24:52.873
> 
> 标签：javascript

我正在为我目前正在从事的项目构建分面/过滤搜索，并且正在寻找一个函数（或 jquery 插件）来帮助我做到这一点。假设我有一个如下对象：

```
var options = {
    "country": 2,
    "Gender": 1
} 
```

然后我有一个名为 filter() 的函数。我通过过滤我想要切换/添加/更新的选项的键和值。我目前的功能给我带来的只是麻烦，而且我离调试兔子洞太远了，不值得发布。基本上我有这个：

```
filter('country', 3); 
```

将更新“国家”键以将“3”作为其新值。

```
filter('Age Group', 4); 
```

将该键/值对添加到选项对象。

```
filter('Gender', 1); 
```

将从对象中完全删除“性别”键。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T23:32:35.077

这个明显的实现怎么样：

```
​function filter(o, key, val)​ {
    if (o.hasOwnProperty(key) && o[key] == val) {
        delete o[key];    
    } else {
        o[key] = val;
    }
} 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:45:24.697

我建议这样做：

```
​function filter(o, key, val)​ {
    if (o[key] === val) {
        delete o[key];    
    } else {
        o[key] = val;
    }
} 
```

如果`key`不作为对象的属性存在，那么`o[key]`它将`undefined`不匹配`val`，因此它将添加键/值。

如果`key`存在，但`val`不匹配，它将设置键/值

如果`key`存在且`val`匹配，它将删除密钥。

注意：使用它`===`来确保比较中没有自动类型转换很重要。

* * *

或者，如果您想要一个自动使用您的`options`变量的函数，那么您可以使用它：

```
​function filter(key, val)​ {
    if (options[key] === val) {
        delete options[key];    
    } else {
        options[key] = val;
    }
} 
```

就个人而言，我认为如果您根据密钥先前是否存在或是否匹配来进行显式 setKey 和 removeKey 函数而不是此变量操作，则代码更具可读性。

# c++ - 如何在 alt-tab 切换和返回后恢复 ClipCursor 收缩

> ID：10791439
> 
> 赞同：2
> 
> 时间：2012-05-28T23:24:52.897
> 
> 标签：c++, winapi

我正在尝试将鼠标指针（带有自定义光标）限制在我的应用程序窗口的客户区域，该应用程序最初可以工作，但当我从应用程序切换并返回时遇到问题。我`ClipCursor()`用来限制光标并使用几个不同的光标，这些光标取决于情况，所以我使用`SetCursor()`而不是设置窗口的类光标。

通过检查我的 WndProc 中的 WM_SETCURSOR 消息，当 Alt-Tabbing 离开应用程序并返回（我想允许）时，我已经正确恢复了光标：

```
case WM_SETCURSOR:
{
    if (mIsMouseGrabOn)  // a bool that indicates if the mouse should be restricted to the cient area or not
        SetCursor(gmInstance->m_cursorTargetGreen);
    else
        SetCursor(gmInstance->m_cursorTargetRed);
    return 0; // prevent DefWndProc from resetting it
} 
```

但是在切换回来时，光标不再被剪辑到我的应用程序窗口的客户区。我尝试检查 WM_ACTIVATEAPP（如下所示）但没有成功，并尝试使用相同的代码和相同的结果检查 WM_ACTIVATE。

```
case WM_ACTIVATEAPP:
{
    if(wParam == TRUE) // When we are activated
    { 
        if (mIsMouseGrabOn)
            GrabMouse(); // function to determine client area and call ClipCusor with the results
        else
            ClipCusor(NULL); // make the sure cursor is freed
    }
    else if(wParam == FALSE) // When we are deactivated
    {
        ClipCursor(NULL);
    }
    //return 0; // Let DefWndProc handle anything else
} 
```

使用上面的代码，光标会正确更改，但不会被捕获，无论`mIsMouseGrabOn`.

从应用程序切换回来时，如何正确绑定光标？我应该注意哪些消息而不是 WM_ACTIVATEAPP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:42:03.100

您可以观看失去焦点并获得焦点消息

1) WA_ACTIVE 或 WA_CLICKACTIVE - 窗口获得焦点

2) WA_INACTIVE - 窗口失去焦点

如果您的应用程序以全屏模式运行，您应该注意：

3) WM_DISPLAYCHANGE - 当 Windows 改变桌面分辨率时

并调整消息大小

WM_SIZE - 如果 wparam 等于 SIZE_MINIMIZED,SIZE_MAXIMIZED 或 SIZE_RESTORED 你可以剪辑或取消剪辑光标

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-05T21:09:12.493

`WM_SETFOCUS`在 Window 接收到键盘焦点后发送，这允许 ClipCursor 工作。

# c - AIX 等效于 ieee754.h

> ID：10791446
> 
> 赞同：1
> 
> 时间：2012-05-28T23:26:01.220
> 
> 标签：c, serialization, include, aix, ieee-754

我编写了一些 C 代码，将某些值序列化为一个文件，该文件随后在另一台机器上用 Java 反序列化（使用自定义代码）。

我正在序列化的值中有 64 位双精度浮点实数。当我编写代码时，它将被编译并仅在 Linux 上运行，并且`gcc`可以编译它。我曾经`ieee754.h`根据 IEEE 754 标准访问值的所有部分，并将这些部分写入文件。在 Java 端，我会简单地使用[`Double.longBitsToDouble(long)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#longBitsToDouble%28long%29)来重新组合值。

问题是我被要求使用`xlc`10 使代码能够在 AIX 5.3 上编译和运行。

`ieee754.h`在 AIX 上是否有任何等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:46:23.707

缺少字节序问题，IEEE754 是一种固定格式。不需要系统标头来告诉您它的外观。只需执行以下操作：

```
uint64_t rep;
double x;
memcpy(&rep, &x, sizeof rep); 
```

如果您在一个必须这样做的平台上，您可能希望包含一些用于有条件地对结果进行字节顺序交换的代码，但据我所知，AIX 不会是其中之一。

# android - 自定义布局可能是一个简单的问题：ImageView TextView = GridView

> ID：10791450
> 
> 赞同：1
> 
> 时间：2012-05-28T23:26:46.307
> 
> 标签：android, android-layout, gridview

我正在开发我的第一个“专业”（即，全功能、无错误、美观的）Android 应用程序，但我在 Android 布局方面遇到了一些问题。

特别是，我有一个 gridView，我用一个包含 ImageView、TextView 和隐藏 TextView（可见性设置为“消失”）的布局来膨胀。

我有一个 115 x 115 的“找不到图像”图像。其他图像（“找到”）同样是 115 x 115。它们都是 JPEG。

问题是什么都没有。文本限制在 17 个字符以下。所以我认为图像大小相同，文本大小相同，单元格大小相同，网格会对齐......但是不;）

请参阅[此处](https://imgur.com/sVQyP,Hwocu#0)了解它现在的外观和[此处](https://imgur.com/sVQyP,Hwocu#1)了解相对布局的外观。

这和[这](https://stackoverflow.com/questions/4788211/android-custom-gridview-layout-textview-with-imageview-on-top)[都](https://stackoverflow.com/questions/9758829/android-custom-adapter-with-imageview-and-textview)建议使用RelativeLayout。

网格视图：

```
 <?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">

    <GridView xmlns:android="http://schemas.android.com/apk/res/android"
              android:id="@+id/gridView"
              android:numColumns="auto_fit"
              android:gravity="top"
              android:layout_gravity="top"
              android:padding="10dp"
              android:verticalSpacing="10dp"
              android:horizontalSpacing="10dp"
              android:columnWidth="50dp"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent" >
    </GridView>
</LinearLayout> 
```

细胞：

```
 <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/widget44"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_gravity="top"
        android:gravity="top">
    <ImageView
            android:id="@+id/icon_image"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="top"
            android:layout_gravity="top">
    </ImageView>
    <TextView
            android:id="@+id/icon_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="TextView"
            android:gravity="center_horizontal"
            android:textColorHighlight="#656565">
    </TextView>
    <TextView
            android:id="@+id/full_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:visibility="gone"
            android:layout_gravity="top" >
    </TextView>
</RelativeLayout> 
```

所以……可以肯定的是，我可能有一件事或几件事错了。但我可以使用你的帮助。谢谢。

编辑：有人建议我发布我的适配器代码，所以就在这里。

一、gridview活动：

```
package com.buildingfive.sharealike;

import android.app.Activity;
import android.content.ComponentName;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.GridView;
import android.widget.ListAdapter;
import android.widget.TextView;
import com.buildingfive.R;

public class BrowseSearchProducts extends Activity {
    GridView gridView;
    Cursor cursor;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.browse_search);

        //get gridview data from db
        DBHelper db = new DBHelper(this);
        //this cursor is never really closed, everywhere I tried, GPF
        cursor = db.getReadableDatabase().rawQuery("SELECT _id, Title, Image FROM products;", null);
        cursor.moveToFirst();

        //populate gridview
        gridView = (GridView) findViewById(R.id.gridView);
        ListAdapter listAdapter = new ImageAdapter(this, cursor);
        ((ImageAdapter) listAdapter).setCount(cursor.getCount());
        gridView.setAdapter(listAdapter);

        gridView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
                TextView vText = (TextView) v.findViewById(R.id.full_text);
                String strCaption = ((TextView) vText).getText().toString();

                Intent intent = new Intent(BrowseSearchProducts.this, ShowDetails.class);
                intent.putExtra("search", strCaption);
                startActivity(intent);
            }
        });
    }

    @Override
    protected void onDestroy() {
        cursor.close();
        this.finish();
        super.onDestroy();
    }
} 
```

现在自定义 ImageAdapter：

```
package com.buildingfive.sharealike;

import android.content.Context;
import android.database.Cursor;
import android.graphics.BitmapFactory;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import com.buildingfive.R;

public class ImageAdapter extends BaseAdapter {
    Context mContext;
    Cursor mCursor;
    int mCount;

    public static final int ACTIVITY_CREATE = 10;

    public ImageAdapter(Context c, Cursor cursor){
        mContext = c;
        mCursor = cursor;
    }

    public void setCount(int nCount) {
        this.mCount = nCount;
    }

    @Override
    public int getCount() {
        return mCount;
    }

    //also required
    public Object getItem(int position) {
        //should return the actual object at the specified position in our Adapter
        return mCursor.getString(1);
    }

    //required
    public long getItemId(int position) {
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View vwIconPlusCaption;
        String strCaption = mCursor.getString(1);
        String strFull = strCaption;

        if (strCaption == "")
            return null;

        //The Beckham Experiment: Blah Blah Blah 2ndary Tagline
        if (strCaption.indexOf(":") > -1)
            strCaption = strCaption.split(":")[0].toString();
        else
            if (strCaption.length() >= 17)
                strCaption = strCaption.substring(0, 17);

        if(convertView == null){
            LayoutInflater li;
            li = LayoutInflater.from(mContext);

            //icon_plus_caption is loaded into a view
            vwIconPlusCaption = li.inflate(R.layout.icon_plus_caption, null);
            TextView tv = (TextView) vwIconPlusCaption.findViewById(R.id.icon_text);

            //the view's caption set here
            tv.setText(strCaption);
            TextView fullText = (TextView) vwIconPlusCaption.findViewById(R.id.full_text);
            //passes the full title in a hidden ("gone") textview
            fullText.setText(strFull);
            ImageView iv = (ImageView) vwIconPlusCaption.findViewById(R.id.icon_image);

            byte[] bb = mCursor.getBlob(2);
            if (bb == null) {
                //image not found
                iv.setImageResource(R.drawable.not_found);
            } else {
                iv.setImageBitmap(BitmapFactory.decodeByteArray(bb, 0, bb.length));
            }

            if (position + 1 < mCount)
                mCursor.moveToNext();
        }
        else
        {
            vwIconPlusCaption = convertView;
        }
        return vwIconPlusCaption;
    }
} 
```

编辑：已解决：解决方案如下：

出于某种原因，从 SQL lite 中提取所有图像与从 android 资源中提取“未找到”图像时，尺寸会有所不同。有关更多信息，请参阅[此链接](https://stackoverflow.com/questions/7060413/image-from-resources-is-scaled-properly-but-image-blob-from-sqlite-isnt-andro)。

我添加的行是：

```
 iv.setImageBitmap(Bitmap.createScaledBitmap(bitmap, 115, 115, true)); 
```

...为了将 android drawable 的大小强制为 115 x 115。

感谢所有尝试参与的人。

# asp.net - LabelFor + EditorFor 在同一行？

> ID：10791451
> 
> 赞同：4
> 
> 时间：2012-05-28T23:26:51.580
> 
> 标签：asp.net, .net, asp.net-mvc, asp.net-mvc-3, razor

我有这个代码：

```
<div class="editor-label">
    @Html.LabelFor(model => model.Ticket)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.Ticket)
    @Html.ValidationMessageFor(model => model.Ticket)
</div> 
```

如何在同一行获取标签和复选框（在本例中为复选框）？我已经尝试删除 div，但它们仍然出现在不同的行上。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-14T21:46:33.567

删除不适用于我的应用程序，但添加`new { @style = "display:inline-block" }`为第二个参数`LabelFor()`。

我更喜欢标签前的复选框，所以它是：

```
<div>
    @Html.EditorFor(model => model.GetAll)
    @Html.LabelFor(model => model.GetAll, new { @style = "display:inline-block" })
</div> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T00:09:46.190

只需删除分隔它们的 div，这对我有用，我可以`Ticket []`接受。

另外，`CheckBoxFor`如果你知道它是一个`CheckBox`

```
<div>
    @Html.LabelFor(model => model.Ticket)
    @Html.CheckBoxFor(model => model.Ticket)
    @Html.ValidationMessageFor(model => model.Ticket)
</div> 
```

我也使用了这个代码，因为 OP 说这是他的代码

```
<div class="editor-field">
    @Html.Label("SMS Alerts?")
    @Html.EditorFor(model => model.GetAll)
</div> 
```

我明白了`GetAll []`

`GetAll`在`bool`我的 ViewModel 中

也用了这个

```
<div>
    @Html.LabelFor(model => model.GetAll)
    @Html.EditorFor(model => model.GetAll)
</div> 
```

我明白了`GetAll []`

和这个

```
<div class="editor-field">
    @Html.LabelFor(model => model.GetAll)
    @Html.EditorFor(model => model.GetAll)
</div> 
```

我明白了`GetAll []`

在每种情况下，我的测试都是标签和复选框是内联的

# php - PHP 和 PostgreSQL - 从 SQL 文件中插入行

> ID：10791452
> 
> 赞同：1
> 
> 时间：2012-05-28T23:27:01.297
> 
> 标签：php, postgresql

所以，我正在尝试使用 PHP 向 PostgreSQL 表中插入一些寄存器。

我有一张`career`表，寄存器在 school_careers.sql 中。所以我试过这个：

```
$host = "localhost";
$user = "user";
$pass = "passw0";
$db = "school";

$con = pg_connect("host=$host dbname=$db user=$user password=$pass")
       or die ("Could not connect to server $server\n");

$query = "\\i ./school_classes.sql";
$rs = pg_query($con, $query) or die("Cannot execute query: $query\n");

echo $rs . " done\n";

pg_close($con); 
```

但我只是得到：

`Cannot execute query: \i ./school_classes.sql`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:31:46.973

您收到错误是因为[`pg_query`](http://php.net/manual/en/function.pg-query.php)需要文字查询，而不是文件名。

这篇文章讨论了从 PHP 中的文件加载和运行 sql：[Loading .sql files from inside PHP](https://stackoverflow.com/questions/147821/loading-sql-files-from-within-php)

[Jeremy Privett](https://stackoverflow.com/users/560/jeremy-privett)接受的答案似乎建议您“构建一个 PHP 文件，该文件包含一个变量中的查询 [您] 可以从中运行它们”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:44:30.413

这不起作用，因为“\i”是一个 psql 客户端程序命令，不是一个有效的查询。该命令无法按原样在 PHP 中作为 pg_query 工作。如果你想这样做，你可以调用一个 shell 并运行这个命令：

```
psql -c "\i ./school_classes.sql" -U <username> -h <hostname> <dbname> 
```

这有一个缺点，我不相信您可以简单地将密码传递给 psql 客户端，它会提示输入密码。您可以设置一个包含用户名/密码对的*.pgpass*文件，然后它可以使用它来连接而无需提示（这在 PostgreSQL 文档中详细说明为“libpq-pgpass”）。

另外，我不是 PHP 人，所以我不知道如何运行 shell 命令，但这是一个足够常见的操作，它应该在文档中。您还需要确定如何捕获 shell 命令的输出，以验证您的脚本是否正确。

# javascript - HTML5 的用于录音的 getUserMedia 现在可以工作了吗？

> ID：10791457
> 
> 赞同：16
> 
> 时间：2012-05-28T23:27:48.487
> 
> 标签：javascript, html, google-chrome

我搜索了很多关于 getUserMedia 的 DEMO 和示例，但大多数只是相机捕捉，而不是麦克风。

所以我下载了一些例子并在我自己的电脑上尝试，相机捕捉是工作，但是当我改变了

```
navigator.webkitGetUserMedia({video : true},gotStream); 
```

到

```
navigator.webkitGetUserMedia({audio : true},gotStream); 
```

浏览器要求我先允许麦克风访问，然后它失败了

```
document.getElementById("audio").src = window.webkitURL.createObjectURL(stream); 
```

消息是：

```
GET blob:http%3A//localhost/a5077b7e-097a-4281-b444-8c1d3e327eb4 404 (Not Found) 
```

这是我的代码：[getUserMedia_simple_audio_test](http://pastie.org/3985501)

我做错什么了吗？或者现在只有 getUserMedia 可以用于相机？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T00:24:09.983

它目前在 Google Chrome 中不可用。请参阅[问题 112367](http://code.google.com/p/chromium/issues/detail?id=112367)。

你可以在[演示](http://jsfiddle.net/DerekL/JV996/)中看到，它总是会抛出一个错误说

> GET blob:http%3A//whatever.it.is/b0058260-9579-419b-b409-18024ef7c6da 404（未找到）

而且你也不能听麦克风

```
{
    video: true,
    audio: true
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T13:17:29.470

Chrome Canary 目前支持它。您需要在地址栏中输入 about:flags，然后启用 Web 音频输入。

以下代码将音频输入连接到扬声器。注意反馈！

```
<script>
// this is to store a reference to the input so we can kill it later 
var liveSource;
// creates an audiocontext and hooks up the audio input
function connectAudioInToSpeakers(){
  var context = new webkitAudioContext();  
  navigator.webkitGetUserMedia({audio: true}, function(stream) {
    console.log("Connected live audio input");
    liveSource = context.createMediaStreamSource(stream);
    liveSource.connect(context.destination);
  });
 }
// disconnects the audio input
function makeItStop(){
   console.log("killing audio!");
   liveSource.disconnect();
 }
// run this when the page loads
connectAudioInToSpeakers();
</script>
<input type="button" value="please make it stop!" onclick="makeItStop()"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:25:34.833

（对不起，我忘记登录了，所以用我正确的用户名发帖...）

Chrome Canary 目前支持它。您需要`about:flags`在地址栏中输入内容，然后启用 Web 音频输入。

以下代码将音频输入连接到扬声器。注意反馈！

[http://jsfiddle.net/2mLtM/](http://jsfiddle.net/2mLtM/)

```
<script>
// this is to store a reference to the input so we can kill it later 
var liveSource;
// creates an audiocontext and hooks up the audio input
function connectAudioInToSpeakers(){
  var context = new webkitAudioContext();  
  navigator.webkitGetUserMedia({audio: true}, function(stream) {
    console.log("Connected live audio input");
    liveSource = context.createMediaStreamSource(stream);
    liveSource.connect(context.destination);
  });
 }
// disconnects the audio input
function makeItStop(){
   console.log("killing audio!");
   liveSource.disconnect();
 }
// run this when the page loads
connectAudioInToSpeakers();
</script>
<input type="button" value="please make it stop!" onclick="makeItStop()"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-22T19:45:00.857

它的工作，你只需要在`toString`之后添加参数`audio : true`

检查这篇文章 -[链接](http://www.andismith.com/blog/2012/06/introduction-to-getusermedia/)

# .net - 数据绑定到十进制（或对象）属性时获取基本字段类型

> ID：10791458
> 
> 赞同：2
> 
> 时间：2012-05-28T23:27:57.710
> 
> 标签：.net, vb.net, winforms, data-binding, currencymanager

我有一个自定义 NumericEditor 控件，它有一个名为 Value 的可为空的 Decimal 属性。当我将数据字段绑定到值时，我想检索绑定数据的基础类型，以便在源字段是整数数据类型时限制小数位的使用。

我想我必须在 BindingContextChanged 事件中执行此操作，但是如何从绑定本身获取数据字段的类型？我的 Google-Fu 现在让我失望了。

简而言之，我正在寻找类似于`GetValueType`以下问题中提到的方法： [简单数据绑定 - 如何处理绑定字段/属性更改。Winforms，.Net](https://stackoverflow.com/questions/1589719/simple-databinding-how-to-handle-bound-field-property-change-winforms-net)

我想如果 Value 属性是一个对象，这种方法也会很方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:02:19.630

我想出了以下解决方案：

```
Private Sub NumericEditor_BindingContextChanged(sender As Object, e As EventArgs) Handles Me.BindingContextChanged
   If DataBindings.Count > 0 AndAlso DataBindings.Item("Value") IsNot Nothing Then
      Dim myPropDescs As PropertyDescriptorCollection = DataBindings.Item("Value").BindingManagerBase.GetItemProperties
      Dim propertyName As String = DataBindings.Item("Value").BindingMemberInfo.BindingField
      Dim bindingType As Type = myPropDescs.Find(propertyName, False).PropertyType

      Select Case bindingType
         Case GetType(SByte)
            DecimalPlaces = 0
            MinimumValue = SByte.MinValue
            MaximumValue = SByte.MaxValue
         Case GetType(Byte)
            DecimalPlaces = 0
            MinimumValue = Byte.MinValue
            MaximumValue = Byte.MaxValue
         Case GetType(Int16)
            DecimalPlaces = 0
            MinimumValue = Int16.MinValue
            MaximumValue = Int16.MaxValue
         Case GetType(UInt16)
            DecimalPlaces = 0
            MinimumValue = UInt16.MinValue
            MaximumValue = UInt16.MaxValue
         Case GetType(Int32)
            DecimalPlaces = 0
            MinimumValue = Int32.MinValue
            MaximumValue = Int32.MaxValue
         Case GetType(UInt32)
            DecimalPlaces = 0
            MinimumValue = UInt32.MinValue
            MaximumValue = UInt32.MaxValue
         Case GetType(Int64)
            DecimalPlaces = 0
            MinimumValue = Int64.MinValue
            MaximumValue = Int64.MaxValue
         Case GetType(UInt64)
            DecimalPlaces = 0
            MinimumValue = UInt64.MinValue
            MaximumValue = UInt64.MaxValue
         Case GetType(Single), GetType(Double), GetType(Decimal)
            MinimumValue = Decimal.MinValue
            MaximumValue = Decimal.MaxValue
      End Select
   End If
End Sub 
```

它有点重复，因此不是那么优雅，但它确实有效。（我的实际代码在设置 MinimumValue 和 MaximumValue 时也会进行检查，以防开发人员已经设置了这些属性，确保开发人员的设置在它们仍然有效的情况下不会被覆盖。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T06:52:40.823

您将需要确定绑定上下文并对其进行导航，因为可能存在多个绑定，而您显然没有获得哪一个已更改的信息。像这样的东西：

```
DirectCast(sender, Control).BindingContext.Item(dataSet, "dataMember").Bindings.Item(0).DataSource.GetType() 
```

# c# - 获取（计数）Excel文件使用的行数和列数（以数据表计）

> ID：10791463
> 
> 赞同：0
> 
> 时间：2012-05-28T23:29:18.153
> 
> 标签：c#, excel, datatable, count

我在我的数据表中导入了一个 excel 文件。出于某种原因，我需要计算我的总行数和列数。在我的 excel 文件中，我刚刚使用了 3 行，在 A 列和 20、21、22 行的 3 个单元格中给出了 1、2、3。

现在从 1 到 19 的行没有使用，也没有低于 22，同样，我没有使用 B 列到典型的 excel 文件的末尾，只使用了 A。

因此，正确的答案是 Rows.Count = 3 和 Columns.Count = 1。

现在，我想计算我使用的那个 DataTable 的行和列。请告诉我我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:12:54.177

不会有一个标志告诉您“此行是否已使用标志”您需要做的是确定在这种情况下不会使用的行中的值 1-19, 22 您需要考虑如果检查一行中的一列就足够了，或者如果您需要检查该列中的所有行以查看该行是否被使用。假设我知道如果 MemberShipNumber 等于 null 或 "" 那么我知道整行都不会被使用，这就是我将如何进行检查：

```
 foreach(DataRow dr in table)
  {

     if (string.String.IsNullOrEmpty(dr["MembershipNumber"]))
     {
         Console.Write("This row is empty");
     } 
     else
     {
         Console.Write("This row is not empty there is more processing to do.");
     }
  } 
```

希望有帮助

# html - 如何为链接/div背景添加css过渡颜色更改

> ID：10791464
> 
> 赞同：2
> 
> 时间：2012-05-28T23:30:11.210
> 
> 标签：html, css, background-color, css-transitions

我希望整个 div 从更改`#555555`为`#b13c19`. 这是一个简单的圆角 div 包裹在一个链接上。我似乎无法正确处理。这是我到目前为止所拥有的。任何帮助将非常感激。

***HTML***

```
<div id="resume_btn">
   <a href="Aalok_Resume.pdf"> Click Here to View My Resume </a>
</div> 
```

***CSS***

```
#resume_btn {
  position: relative;
  margin-top: 25px;
  padding: 20px;
  width: 220px;
  height: 25px;
  background-color: #555555;
  background-repeat: no-repeat;
  text-align:center;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  -ms-border-radius: 10px;
  -0-border-radius: 10px;
  border-radius: 10px;  
}

#resume_btn a {
  text-decoration: none;
  color:white;
  font-family: 'oswald', helvetica, arial, sans-serif;
  font-size: 18px;
  font-weight: 300;
} 
```

我不确定在哪里放置`-moz-transition: background 1s ease-in;`等属性。当我将鼠标悬停在链接上时，我希望背景改变颜色。我使它适用于链接的背景颜色，但它看起来不太好，因为背景只包含措辞而不是整个 230 x 25 区域。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:34:55.857

```
#resume_btn {
    position: relative;
    margin-top: 25px;
    width: 320px;
    background-color: #555555;
    background-repeat: no-repeat;
    text-align:center;

    -webkit-border-radius: 10px;
       -moz-border-radius: 10px;
        -ms-border-radius: 10px;
         -0-border-radius: 10px;
            border-radius: 10px; 

    -webkit-transition: background 1s;
       -moz-transition: background 1s;
        -ms-transition: background 1s;
         -o-transition: background 1s;
            transition: background 1s;
}

#resume_btn:hover {
    background:  #b13c19;
}

#resume_btn a {
    text-decoration: none;
    display: block;
    color: white;
    font: 300 18px 'oswald', helvetica, arial, sans-serif;
    padding: 20px;
}
```

```
<div id="resume_btn">
  <a href="Aalok_Resume.pdf"> Click Here to View My Resume </a>
</div>
```

# android - 不知道这里发生了什么

> ID：10791466
> 
> 赞同：0
> 
> 时间：2012-05-28T23:30:25.710
> 
> 标签：android, android-preferences

所以我有一个 SharedPreference 我正在调用logged_in。我得到首选项并检查它是否为 1，是否应该启动新活动，否则我希望它向我显示它的实际情况。这是代码：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        PreferenceManager.setDefaultValues(this, R.xml.preferences, false);

        prefs = getSharedPreferences("preferences", MODE_PRIVATE);

        // Check if the user is logged in
        String loggedIn = prefs.getString("logged_in", null);

        if(loggedIn != "1") {
            setContentView(R.layout.main);
            TextView textView = (TextView) findViewById(R.id.login_status);
            textView.setText(prefs.getString("logged_in", null));
        }

        else {
            startActivity(new Intent(this, LoggedInActivity.class));
        }
    } 
```

真正奇怪的是它会加载主视图而不是启动 LoggedIn Activity，但随后它会将logged_in 首选项显示为 1。所以根据我所看到的，它应该启动新的 Activity，但它不是. 我真的很困惑。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:33:59.967

您正在比较引用而不是字符串值。也就是说，您是说*这两个引用是否指向同一个对象*，而不是*这两个对象的内容是否相同*。你应该这样做：

```
if( !loggedIn.equals("1") ) 
```

但是请注意，如果`loggedIn`是`null`，该代码将引发一个`NullPointerException`. 所以这会更合适：

```
if( loggedIn == null || !loggedIn.equals("1") ) 
```

`int`也就是说，在这种特殊情况下，使用首选项会更好。

# ios - iOS 5 - 按核心数据属性将 UITableView 划分为多个部分

> ID：10791468
> 
> 赞同：0
> 
> 时间：2012-05-28T23:30:32.040
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller, sections

我是 Core Data 的新手，所以请多多包涵。;)

在我的数据模型中，我有一个名为“Item”的实体，具有 2 个属性，“Section”和“Name”。我已经使用名称填充了 UITableView（我的主视图），但我想将 TableView 分为 3 个不同的部分，由属性“部分”确定。我在想“section”属性应该是一个整数，所以 0 是第一个部分，1 是第二个部分，2 是第三个部分。

我真的不知道如何将 TableView 分成几个部分。我正在使用 NSFetchedResultsController。这是当前代码。

```
- (void)setupFetchedResultsController
{
// 1 - Decide what Entity you want
NSString *dbEntityName = @"Item"; // Put your entity name here

// 2 - Request that Entity
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:dbEntityName];

// 3 - Filter it if you want
//request.predicate = [NSPredicate predicateWithFormat:@"Item.name = what"];

// 4 - Sort it if you want
request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"name"
                                                                                 ascending:YES
                                                                                  selector:@selector(localizedCaseInsensitiveCompare:)]];
// 5 - Fetch it
self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                    managedObjectContext:self.managedObjectContext
                                                                      sectionNameKeyPath:nil
                                                                               cacheName:nil];
[self performFetch];
} 
```

另外，我想知道 Xcode 中数据模型中的 Fetch Request 模板是否会有所帮助。我看到了如何创建获取请求，但没有看到如何让它对获取的内容做任何事情（例如：将获取的数据放入某个 TableView 部分。）

如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T01:24:39.790

创建 NSfetchedResultsController 时需要选择 sectionNameKeyPath。这应该指向模型对象中的一个属性，该属性对于同一部分中的每个项目都是相同的。

要显示节标题，请确保实现所有 tableView 数据源方法，如 NSfetchedResultsController 文档中的示例中所示。

# git - Jenkins 和 Git 稀疏检出

> ID：10791472
> 
> 赞同：69
> 
> 时间：2012-05-28T23:30:46.693
> 
> 标签：git, jenkins, sparse-checkout

我在 Git 中有一个大型存储库。如何在 Jenkins 中创建一个仅从项目中检出一个子文件夹的工作？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2014-07-18T09:56:21.457

自 git-plugin 2.1.0（2014 年 4 月）以来，[Jenkins Git 插件](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)支持*稀疏签出。*您需要 git >= 1.7.0 才能使用此功能。它位于“其他行为”->“稀疏结帐路径”下。

[![截屏](../Images/13e5d536b987cd25eff8e3bc3e88a07b.png)](https://i.stack.imgur.com/ySUGh.png)

请参阅：Jira 问题[JENKINS-21809](https://issues.jenkins-ci.org/browse/JENKINS-21809)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-05-28T23:30:46.990

您可以使用Git 的[稀疏检出](http://schacon.github.com/git/git-read-tree.html#_sparse_checkout)功能。请注意，Git 仍然会将整个存储库克隆到本地磁盘。然而，这并不算太糟糕，因为它是压缩的。

1.  在 Jenkins 中创建一个新作业，在 Source Code Management 部分设置 Git 存储库。
2.  构建项目。这会将整个存储库克隆到本地磁盘。
3.  打开项目的工作区文件夹，删除除 .git 文件夹之外的所有内容。
4.  打开项目工作区文件夹的 Git shell。启用稀疏结帐：

    ```
    git config core.sparsecheckout true 
    ```

5.  更新工作树：

    ```
    git read-tree -mu HEAD 
    ```

6.  `sparse-checkout`在 .git/info 文件夹中创建文件。添加要签出到该文件的子文件夹的路径，如下所示（注意尾部斜杠）：

    ```
    folder/to/include/ 
    ```

7.  再次构建项目。这次只有一个子文件夹应该出现在工作区文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T00:25:38.967

你可以有一个自定义步骤，只使用

```
git checkout your-branch -- the/desired/path anthother/desired/path 
```

要清除它，您可以只`rm -rf`使用工作文件夹并使用`mkdir workingdir`. 这将要求您在上述命令的 git 级别上指定此选项：

```
git --working-dir="/path/to/workingdir" checkout your-branch -- the/desired/path anthother/desired/path 
```

这一切都取决于你对詹金斯的了解程度。

# ruby-on-rails - 在视图中显示缺失的 I18n 翻译

> ID：10791474
> 
> 赞同：2
> 
> 时间：2012-05-28T23:31:27.487
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, actionview, actionviewhelper

正如[ActionView 的文档](http://apidock.com/rails/ActionView/Helpers/TranslationHelper/translate)中所述，Rails 中的`t`视图助手会自动修改缺失的翻译。例如：

```
irb> helper.t('words.foo_bar')
=> "<span class="translation_missing" title="translation missing: en.words.foo_bar">Foo Bar</span>" 
```

有什么办法可以全局禁用它吗？我更愿意看到“*翻译缺失：en.words.asdf* ”。

我发现的唯一解决方法是使用`I18n.t "..."`而不是`t "..."`在视图中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:43:36.177

尝试将此代码放入您的`development.rb`

```
# Enable locale fallbacks for I18n (makes lookups for any locale fall back to
# the I18n.default_locale when a translation can not be found)
config.i18n.fallbacks = false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T07:07:11.580

我的`config/initializers`目录中有这个文件，它显示了所有失败的翻译查找以及它们在日志输出中的来源：[https ://gist.github.com/1594660](https://gist.github.com/1594660)

也许这正是您正在寻找的。

# flash - Trace 和 if 语句矛盾

> ID：10791477
> 
> 赞同：-3
> 
> 时间：2012-05-28T23:32:06.850
> 
> 标签：flash, if-statement, trace

第一个跟踪打印“2”，但第二个跟踪“true”从未打印...我将根据要求显示更多代码，但这对我来说没有任何意义：

```
trace(n.wallMask & 2);
if (n.wallMask & 2 != 0) {
    trace(true);
    w = 22.5;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:35:33.787

你应该添加括号：

```
if ((n.wallMask & 2) != 0) {
    trace(true);
    w = 22.5;
} 
```

# macros - Scheme宏由不是列表头部的关键字触发

> ID：10791481
> 
> 赞同：7
> 
> 时间：2012-05-28T23:33:14.473
> 
> 标签：macros, lisp, scheme

假设我想在 s 表达式中的第一项以外的其他内容上触发 Scheme 宏。例如，假设我想`define`用中缀样式替换`:=`，这样：

```
(a := 5) -> (define a 5)
((square x) := (* x x)) -> (define (square x) (* x x)) 
```

实际的转变似乎很简单。诀窍是让 Scheme 找到`:=`表达式并对其进行宏扩展。我已经考虑过使用标准宏的中缀语法来包围大部分代码，也许是：`(with-infix-define expr1 expr2 ...)`，并让标准宏遍历其主体中的表达式并执行任何必要的转换。我知道如果我采用这种方法，我将不得不小心避免转换实际上应该是数据的列表，例如引用列表和准引用列表的某些部分。我设想的一个例子：

```
(with-infix-define
   ((make-adder n) := (lambda (m) (+ n m)))

   ((foo) :=
       (add-3 := (make-adder 3))
       (add-6 := (make-adder 6))
       (let ((a 5) (b 6))
           (+ (add-3 a) (add-6 b))))

   (display (foo))
   (display '(This := should not be transformed)) 
```

所以，我的问题有两个：

1.  如果我走这`with-infix-define`条路，除了报价和准报价外，我是否必须注意任何绊脚石？
2.  我感觉有点像在重新发明轮子。这种类型的代码遍历似乎*正是*标准宏扩展系统必须要做的——唯一的区别是它们在决定是否进行任何代码转换时只查看列表中的第一项。有什么办法可以搭载现有系统吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T05:27:37.190

1.  在继续此之前，最好仔细考虑一下——IME 您经常会发现您真正想要的读者级别的处理方式`:=`是中缀语法。这当然意味着它也是引号等中的中缀，所以现在看起来很糟糕，但我的经验是，你最终会意识到最好始终如一地做事。

2.  为了完整起见，我会提到在 Racket 中有一个用于类似中缀的表达式的读取语法技巧：`(x . define . 1)`被*读取*为`(define x 1)`. （如上所述，它无处不在。）

3.  否则，您对包装宏的想法几乎是您唯一可以做的事情。但这并不意味着它完全没有希望，你可能有一个钩子到你的实现的扩展器中，它可以让你做这样的事情——例如，Racket 有一个特殊的宏[`#%module-begin`](http://docs.racket-lang.org/reference/module.html#%28form._%28%28lib._racket/private/base..rkt%29._~23~25module-begin%29%29)，它包裹了一个完整的模块体并[`#%top-interaction`](http://docs.racket-lang.org/reference/__top-interaction.html#%28form._%28%28lib._racket/private/base..rkt%29._~23~25top-interaction%29%29)包裹了顶层表达式REPL。（这两个都是在两个上下文中隐式添加的。）这是一个例子（为了简单起见，我使用 Racket [`define-syntax-rule`](http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket/private/misc..rkt%29._define-syntax-rule%29%29)）：

    ```
    #lang racket/base

    (provide (except-out (all-from-out racket/base)
                         #%module-begin #%top-interaction)
             (rename-out [my-module-begin #%module-begin]
                         [my-top-interaction #%top-interaction]))

    (define-syntax infix-def
      (syntax-rules (:= begin)
        [(_ (begin E ...)) (begin (infix-def E) ...)]
        [(_ (x := E ...))  (define x (infix-def E) ...)]
        [(_ E)             E]))

    (define-syntax-rule (my-module-begin E ...)
      (#%module-begin (infix-def E) ...))
    (define-syntax-rule (my-top-interaction . E)
      (#%top-interaction . (infix-def E))) 
    ```

    如果我把它放在一个名为 的文件中`my-lang.rkt`，我现在可以按如下方式使用它：

    ```
    #lang s-exp "my-lang.rkt"
    (x := 10)
    ((fib n) :=
     (done? := (<= n 1))
     (if done? n (+ (fib (- n 1)) (fib (- n 2)))))
    (fib x) 
    ```

4.  是的，你需要处理很多事情。上面的两个例子是处理`begin`表达式和处理函数体。这显然是一个非常部分的列表——您还需要 , 等的主体`lambda`。`let`但这仍然比一些盲目按摩要好，因为这不切实际，因为您无法真正提前知道一些随机代码是如何产生的将结束。作为一个简单的例子，考虑这个简单的宏：

    ```
    (define-syntax-rule (track E)
      (begin (eprintf "Evaluating: ~s\n" 'E)
             E))
    (x := 1) 
    ```

5.  这样做的结果是，为了获得适当的解决方案，您需要某种方法来预扩展代码，以便您可以扫描它并处理您的实现中为数不多的已知核心形式。

6.  是的，所有这些都是重复宏扩展器所做的工作，但是由于您正在更改扩展的工作方式，所以没有办法解决这个问题。（要了解为什么它是一个根本性的变化，请考虑一下`(if := 1)`——这是一个条件表达式还是一个定义？你如何决定哪个优先？）因此，对于具有这种“可爱语法”的语言，一种更流行的方法就是将代码读取并解析成普通的 S 表达式，然后让实际的语言实现使用普通的函数和宏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T09:46:56.217

重新定义`define`有点复杂。请参阅@Eli 的出色解释。

另一方面，如果您满足`:=`于使用`set!`的东西会更简单一些。

这是一个小例子：

```
#lang racket

(module assignment racket
  (provide (rename-out [app #%app]))

  (define-syntax (app stx)
    (syntax-case stx (:=)
      [(_ id := expr)
       (identifier? #'id)
       (syntax/loc stx (set! id expr))]      
      [(_ . more) 
       (syntax/loc stx (#%app . more))])))

(require 'assignment)

(define x 41)
(x := (+ x 1))
(displayln x) 
```

为了将示例保存在单个文件中，我使用了子模块（在 Racket 的预发布版本中可用）。

# javascript - 带有缩进的基于 Javascript/jQuery 的动态列表

> ID：10791484
> 
> 赞同：0
> 
> 时间：2012-05-28T23:33:26.220
> 
> 标签：javascript, jquery, user-interface

我正在为基于 Web 的列表应用程序构建 UI。

有谁知道允许用户安排 html 元素排序的脚本？类似于这个 [http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)但也可以通过水平拖动来缩进项目？（代表父子关系）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:55:07.760

我相信你想要的父子关系会创建一个树，所以为什么不寻找一些允许拖放的 jQuery Tree 插件。

我在谷歌快速搜索后发现了这个：http: [//www.jstree.com/demo](http://www.jstree.com/demo)

有几个 Tree 插件可以做与你想要的类似的事情。

# java - 从构造函数构建 GUI。[设计决定]

> ID：10791485
> 
> 赞同：3
> 
> 时间：2012-05-28T23:33:27.550
> 
> 标签：java, user-interface

我即将完成我们的考试项目，当回顾我的编码时，我觉得我做得很好。不过，事情显然**总是**会好很多。但也许这只是我。

我负责对 GUI 进行编码，并将其与应用程序逻辑相结合。在制作 GUI 时，我决定为每个窗口制作一个类文件（例如 LoginWnd.java），并在构造函数中实际构建 GUI。我将初始化所有内容并在此构造函数中设置所有数据。

然后为了浏览应用程序，我会在 jbutton 上设置 actionlisteners。例如，在 SearchWnd 中，点击“搜索”按钮将创建一个带有一些指定参数的 ResultWnd 新对象。

现在我有点想知道：这个设计决定有什么不好吗？有没有我应该知道的设计范式？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T23:46:54.493

总体而言，您的方法听起来不错-只要有效，您就已经实现了主要目标！所以我在这里的评论更多是关于微调/更广泛的设计方面。

如果在程序执行期间 GUI 不会随后发生变化，那么在构造函数中*进行*GUI 构造基本上没有错。这里的基本原理是，应为“一次性”建设活动保留建设者。因此，对于具有预定布局的对话框等可能没问题。

如果您有一个更加动态的 GUI，其中组件在整个程序执行过程中经常被添加和删除，那么我强烈建议将其移至构造函数之外的一组方法，以便可以独立于对象构造来调用它们。如果需要进行初始设置，构造函数本身仍然可以调用这些方法，但随后您可以稍后调用这些方法来添加新组件、刷新布局等。

好消息是，如果你弄错了这些东西并不难重构——如果需要，稍后将设置代码从构造函数中提取到单独的方法中通常是微不足道的。

要注意的另一件事是经常重复的口头禅**“更喜欢组合而不是继承”**。也就是说，如果您可以通过组装现有组件而不是继承和覆盖您的设计来使您的 GUI 工作，那么从长远来看，您的设计可能会更好/更容易维护。例如，我认为我从未对 JFrame 进行子类化——在其中添加包含所有应用程序特定组件的 JPanel 几乎总是更简洁。

最后，**小心不要将您的 GUI 组件与您的应用程序逻辑耦合得太紧密。**Swing 实际上在鼓励您将数据模型与表示代码分离方面做得很好（例如，使用[ListModel 和朋友](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)）。值得研究和理解这种方法。关键是您*通常*应该以与应用程序完全无关的方式构建 GUI 组件，但通过将它们连接到正确的数据模型和事件处理程序等来赋予它们特定于应用程序的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:45:48.717

我还在构造函数中初始化了我的 GUI，所以它不会很糟糕 :) 但是当它变得太长时，我会将部分代码提取到单独的 GUI 组件中。

# git - 如何使用 git init 用更新版本替换本地 git 钩子？

> ID：10791486
> 
> 赞同：10
> 
> 时间：2012-05-28T23:33:38.437
> 
> 标签：git, githooks

我和这个用户有完全相同的问题：

[git init 模板，替换修改后的钩子](https://stackoverflow.com/questions/3007051/git-init-template-replacing-modified-hooks)

我的全局 git 挂钩中有一个新模板文件。但是，原始模板文件已经加载，因此`git init`不会覆盖。我在这里读到同样的内容，这似乎是正确的 git 行为：

来自[http://www.cs.potsdam.edu/cgi-bin/man/man2html?1+git-init](http://www.cs.potsdam.edu/cgi-bin/man/man2html?1+git-init)：

> 在现有存储库中运行 git init 是安全的。它不会覆盖已经存在的东西。重新运行 git init 的主要原因是选择新添加的模板。

那么强制重新加载新的 git 模板钩子的好方法是什么？我在许多 git repos 中有很多钩子，在几台计算机上并被各种用户使用。最实用的方法是让用户运行特定的命令，而不是告诉他们先删除钩子，然后再运行 git init 命令。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T06:35:23.507

> 最实用的方法是让用户运行一个特定的命令，而不是告诉他们先删除钩子，然后运行 ​​git init 命令

在这种情况下，一种可能的方法是向这些用户分发一个执行此操作的脚本（您可以在每个存储库中对该脚本进行版本控制）。
他们不会直接执行，而是`git init`调用该脚本：

*   取下挂钩
*   打电话给`git init --template=`

* * *

但请注意您使用 --temaplate 选项使用的路径。赋予“ ”
的相对应相对于目录“ ”被调用，但它是相对于存储库的，已在 Git 2.22.1（2019 年第二季度）中更正。`pathname``git init --template=<path> <repo>``git init`

请参阅[Nguyễn Thái Ngọc Duy ( ) 的](https://github.com/pclouds)[提交 e1df7fe](https://github.com/git/git/commit/e1df7fe43f4e2e607ed24668e2942d45df8d2743)（2019 年 5 月 10 日[）](https://github.com/pclouds)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 35d7715](https://github.com/git/git/commit/35d771591f673e1c2c7bc90b998670bed1e9e567))^(中，2019 年 7 月 25 日）)[`pclouds`](https://github.com/pclouds)
^([`gitster`](https://github.com/gitster))

> ## init：使`--template`路径相对于`$CWD`
> 
> 期间`git-init`我们`chdir()`到了目标目录，但是`--template`没有调整。
> 所以它是相对于目标目录而不是当前目录的。
> 
> It would be ok if it's documented, but `--template` in `git-init.txt` mentions nothing about this behavior.
> Change it to be relative to `$CWD`, which is much more intuitive.

# asp.net-mvc - ServiceStack 如何自动装配我的自定义 IRepository MyController 上的属性

> ID：10791489
> 
> 赞同：2
> 
> 时间：2012-05-28T23:34:01.257
> 
> 标签：asp.net-mvc, dependency-injection, servicestack

带有 ServiceSTack Mvc 电源包的 Asp.Net mvc

AppHost中有一行：

```
ControllerBuilder.Current.SetControllerFactory(new FunqControllerFactory(container)); 
```

所以这是我的代码

```
public class BaseController<T>:Controller
{
   protected IRepository<T> Repository {get;set;}

   public ActionResult Detail(T t){}
}

public class CarController:BaseController<Car>
{
} 
```

我将在 App.Host 中使用此代码

```
container.Register<IRepository<Car>>(c => new CarRepository()); 
```

我如何使用 AutoWire 存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:34:32.000

只有公共属性或构造函数被注入，所以尝试通过以下方式使 Repository 公开：

```
public class BaseController<T>:Controller
{
   public IRepository<T> Repository {get;set;}

   public ActionResult Detail(T t){}
}

public class CarController:BaseController<Car> {} 
```

此外，如果您使用的是[MVC PowerPack](http://www.servicestack.net/mvc-powerpack/)，您可能希望从[ServiceStackController](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.FluentValidation.Mvc3/Mvc/ServiceStackController.cs#L51)继承，这会给您带来很多好处，例如使用 ServiceStack 的 JSON 序列化，可以访问 ServiceStack 的共享[缓存](https://github.com/ServiceStack/ServiceStack/wiki/Caching)和会话提供程序以及能够共享 ServiceStack[身份验证/](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization) MVC 控制器和[ServiceStack](http://www.servicestack.net/) Web 服务（如果您正在使用）的[授权功能。](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)

# php - 在 mySQLi Prepared Statement 中使用 UPDATE 时出现 500 内部服务器错误

> ID：10791492
> 
> 赞同：1
> 
> 时间：2012-05-28T23:34:16.663
> 
> 标签：php, mysqli

我有一个非常简单的 UPDATE 命令，我正在尝试执行但不断收到 HTTP 500 内部服务器错误。

```
$test = $mysqli->prepare('UPDATE `tname` SET column = ? WHERE `ID` = ?');
$test->bind_param('ii', $value, $id);
$test->execute(); 
```

过去几天我一直在寻找解决方案，但无济于事。

$mysqli 对象已创建，并且在执行上述代码之前不会关闭。事实证明，如果我将准备语句更改为“SELECT”或“UPDATE”以外的任何其他语句，它就会成功运行。

`$value`并且`$id`不为空；如果我回显它们，则值是正确的。

奇怪的是，在迁移到 AWS 之前，这在我的本地环境和 Hostmonster 上运行良好。我可能需要更改一些设置吗？我什么也没找到，问题似乎只出在涉及`UPDATE`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:06:52.037

我已经为我自己的问题找到了解决方案，所以如果有人遇到类似的问题，这就是我所做的：

1.  如果您收到 HTTP 500 内部服务器错误，但您确定服务器配置正确，那么您很可能遇到了 PHP 错误，因此请转到 php.ini 并确保 error_reporting 为 E_ALL 并且 display_errors 已打开。（您需要在生产环境中将其关闭。）

2.  打开 PHP 错误后，问题的根源应该很明显。对我来说，我的 DB 用户没有 UPDATE 权限（我没有设置 DB，所以我不知道这一点），所以我只需要 GRANT UPDATE 权限。

# jquery - 如何垂直居中容器div

> ID：10791495
> 
> 赞同：1
> 
> 时间：2012-05-28T23:35:00.517
> 
> 标签：jquery, css, html, center, vertical-alignment

我无法垂直居中`popup_interstitial_table`包含广告类型容器。

它是自动解释的小提琴：http: [//jsfiddle.net/NomikOS/D8LLM/](http://jsfiddle.net/NomikOS/D8LLM/)

> 也欢迎使用 jQuery 解决方案。

HTML：

```
<div id="popup_interstitial">
    <div id="parent">
        <div id="popup_interstitial_pro_head_text">
            Headline text 
        </div>
        <div id="child">
            <div id="popup_interstitial_table">
                <div id="popup_interstitial_row2">
                    <div id="popup_interstitial_title"><?php echo $title; ?></div>
                    <img id="popup_interstitial_image" src="<?php echo $image; ?>">
                    <div id="popup_interstitial_description"><?php echo $description; ?></div>
                </div>
            </div>
        </div>
    </div>
</div> 
```

相关的CSS代码是：

```
#popup_interstitial_pro_head_text{
    color:#FFF; 
    font-size: 2em;
    font-weight: normal;
    text-shadow: 0.05em 0.05em #666;
    background-color: #A5CF4C;
    width: 100%;
    padding-left: 1%;
    padding-top: 0.8%;
    padding-bottom: 0.8%;
    border-top-width: thin;
    border-top-style: solid;
    border-top-color: #648323;
    border-bottom-width: thin;
    border-bottom-style: solid;
    border-bottom-color: #759928;
    margin-bottom: 2%;
    -webkit-box-shadow: 1px 1px 8px #333333;
    -moz-box-shadow: 1px 1px 8px #333333;
    khtml-box-shadow: 1px 1px 8px #333333;
    filter: shadow(color=#333333, direction=135, strength=0);
}
#popup_interstitial {
    display: none;
    width: 100%;
    height: 100%;
    position: fixed;
    background-color:#FFFFFF;
    color:#111;
    z-index:9999;
    top:0;
    left:0;
}
#popup_interstitial_table {
    width: 50%;
    margin: 0 auto 0 auto;
    background-color:#E7E7E7;
    padding: 1em 2.2em;
    font: 0.85em "Trebuchet MS", Arial, Helvetica, sans-serif;
    margin-top: 5%;
    vertical-align: center;

}
#popup_interstitial_title{
    color:#FFF; 
    font-size: 1.5em;
    font-weight: bold;
    padding: 0 0 0 0.3em;
    border-bottom-width: thin;
    border-bottom-style: solid;
    border-bottom-color: #777;
    background-color: #888; 
    border-radius: 0.3em;
}
#popup_interstitial_description{
    padding-top: 1.7em;
    padding-bottom: 1.2em;
    border-bottom-width: thin;
    border-bottom-style: solid;
    border-bottom-color: #ccc;
    line-height:1.5em;
}

#popup_interstitial_image{
    vertical-align: baseline;
    margin: 25px 20px 3px 0;
    -webkit-box-shadow: 1px 1px 8px #333333;
    -moz-box-shadow: 1px 1px 8px #333333;
    khtml-box-shadow: 1px 1px 8px #333333;
    filter: shadow(color=#333333, direction=135, strength=0);
    padding: 4px;
    margin-left: 6px;
    float: left;
} 
```

这是最重要的：

```
#parent {position: relative;}
#child {
    padding: 0% 0;
    margin: 0 auto; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:12:42.760

使用这个 CSS：

```
#child {
    display: table
}
#popup_interstitial_table {
    display: table-cell;
    vertical-align: middle;
    text-align: center
} 
```

并将您的其他 CSS 添加到其中。

请参见[垂直居中示例](http://www.w3.org/Style/Examples/007/center-example "垂直居中示例")

和 [CSS：居中的东西](http://www.w3.org/Style/Examples/007/center.en.html "CSS：居中的东西")。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:54:51.103

我不知道在不使用表格单元格的情况下垂直居中元素的任何好方法。在这种情况下，它是相当简单的，但你会回到基于表格的布局，我猜你想避免这种情况。

回复问题：元素垂直居中有多重要？

另一种选择是使用 javascript 在渲染时设置边距。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T02:16:13.723

对于您当前的结构，您有两种解决方案可以使其工作：

# 1）CSS

用 div 包裹元素并使用这个技巧：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/D8LLM/9/)示例！^(（如果您上下移动框架，您会看到目标保持垂直居中。）)

```
#childWrap {                  // the new element, the mentioned wrapper
  display: table;
  width: 100%;
  height: 100%;
}
#child {                      // your element that needs to be restyled
  display: table-cell;
  width: 100%;
  height: 100%;
  vertical-align: middle;
}
#popup_interstitial_table {   // the element vertically aligned
  width: 50%;
  margin: -48px auto 0 auto;
} 
```

这里所做的是将包装元素设置为显示为表格，占据其父元素的整个宽度和高度（`#parent`）。

然后，我们可以将其设置`#child`为显示为表格单元格，并将其内容设置为在中间垂直对齐。

现在的窍门，因为`#parent`还包含另一个元素，你需要保持原样，但它的高度从 的“中心”计算中删除`#popup_interstitial_table`，我们需要`#popup_interstitial_table`用 a拉动`margin-top:-60px`来固定它的位置。负边距是`#popup_interstitial_pro_head_text`占据的高度。

## 重要的提示：

因为你有这个结构，为了将修复传递给浏览器，你`#popup_interstitial_pro_head_text`需要使用一个单元，我选择`px`了这个例子。

您混合了`%`多个`em`声明！

* * *

**附带说明：**

> ~~垂直对齐：居中；~~

**你用：**

> 垂直对齐：中间；

请参阅[此链接](http://w3.org/tr/css21/visudet.html#propdef-vertical-align)以获取更多信息！

* * *

# 2) 查询

使用 jQuery，您可以收集 所占用的空间`#popup_interstitial_table`并计算必要的顶部和左侧固定值以使其垂直居中：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/sU3LZ/)示例！^(（如果您上下移动框架，您会看到目标保持垂直居中。）)

**查询**

```
function center() {
  var $target = $('#popup_interstitial_table'),
      $header = $('#popup_interstitial_pro_head_text'),
      fixTop  = ($target.outerHeight(true)/2)-($header.outerHeight(true)/2),
      fixLeft = $target.outerWidth(true)/2;

  $target.css({
    "margin-top": "-" + fixTop + "px",
    "margin-left" : "-" + fixLeft + "px"
  });
}

$(document).ready(function() {
  center();
}); 
```

**CSS**

为防止大量脚本计算，CSS 应固定为：

```
#parent {
  position: relative;
  height: 100%;        // this was added
}
#child {
  padding: 0% 0;
  height: 100%;        // this was added
}
#popup_interstitial_table {
  width: 50%;
  margin: 0 auto 0 auto;
  background-color:#E7E7E7;
  padding: 1em 2.2em;
  font: 0.85em "Trebuchet MS", Arial, Helvetica, sans-serif;
  position: absolute;  // this was added
  top: 50%;            // this was added
  left: 50%;           // this was added
} 
```

所以，重复一遍，在不改变你当前结构的情况下，这是我能想到的让你的元素居中的两种解决方案！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-29T05:27:03.967

您好，您可以通过两个简单的步骤获得结果：-

只需定义**display:table-cell** & **vertical-align:middle**到你的这个 id **#popup_interstitial_table**

```
#popup_interstitial_table {
    background-color: #E7E7E7;
    display: table-cell;
    font: 0.85em "Trebuchet MS",Arial,Helvetica,sans-serif;
    height: 300px;
    margin: 5% auto 0;
    vertical-align: middle;
    width: 450px;
} 
```

看演示：- [http://jsfiddle.net/D8LLM/34/](http://jsfiddle.net/D8LLM/34/)

# java - 如何在内存模型上进行 Acceleo 代码生成？

> ID：10791502
> 
> 赞同：0
> 
> 时间：2012-05-28T23:36:50.960
> 
> 标签：java, eclipse, acceleo, ocl

我正在尝试使用 Acceleo 生成一些代码。我正在内存中构建我的模型实体，我想为它生成代码。

现在，当 Acceleo 尝试将我的模型对象与我的模板函数的参数类型匹配时，它不匹配。这些类完全相同，但由于 Acceleo 的包注册表和我的内存模型不同，它们不匹配，Acceleo 说找不到与主模板匹配的模型元素。

我可以纠正这个问题吗？我可以强制 acceleo 包注册表成为内存注册表吗？我可以在语义级别强制类匹配（而不仅仅是在 Java 上`==`吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:53:32.443

如果在全局注册表中找不到模型，Acceleo 只会在自己的注册表中注册模型。你确定你使用正确的 NsURI 来注册包吗？您在 Acceleo 模块 ( ) 开头设置的 URI`[module myModule('<NsURI>')]`必须与元模型根包的 NsURI 匹配。它还必须`registerPackages`与您在主模块旁边生成的 java 类的方法中定义的内容相匹配（请注意，由于您是在内存中创建模型，所以最后一步可能不是强制性的）。

如果这三个匹配，Acceleo 应该能够将模型的元素与生成模块中定义的类型匹配。但是，如果这还不够，我们需要在创建内存模型之前知道您是如何注册包的？

Laurent Goubet Obeo

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:36:43.160

要为来到这里的任何人回答这个问题：

真正的问题是我的 EMF 包的 URI。我有一个`commons`和`commons.study`包。包的 URI`commons`被设置为`http://domain.com/model.ecore#/`. Acceleo 在运行时添加他自己的（空白）`http://domain.com/model.ecore`，以防止代理解析器将请求委托给工作区。

解决方案是将我的根`commons`包重命名为正确`http://domain.com/model.ecore`的并将`commons.study`URI 设置为`http://domain.com/model.ecore#//study`. 这样，Acceleo 资源集将不包含空白包，并将加载正确地委托给 Workspace 包注册表。

另请注意，需要生成您的根包。如果不是，则它没有正确注册，并且不会出现在 Workspace 包注册表中。所以如果根包只包含一个子包，也可以在里面添加一个 DUMMY 类。

# php - 模型中的全局变量

> ID：10791506
> 
> 赞同：1
> 
> 时间：2012-05-28T23:38:29.023
> 
> 标签：php, codeigniter, variables, global-variables

不确定它本身是否是全局的，但我需要的是从模型中设置的变量，该变量在模型被调用时动态生成。但是，我需要设置一个变量，该变量可供通过模板拉入的多个视图访问以使用相同的变量。

它是我的客户赞助商的广告 ID，每页有多个广告位，例如 486x 60 和 160x90 的位置。但是我想要做的是，当从一堆中随机抽取 ID 时，我希望我的所有广告位都是同一个赞助商。

现在我尝试进入我的 header.php 视图并定义一个变量

`$adsIDvar = $this->modelname->sponsorids()`然后在每个视图中，我只使用 $varIDvar 放置广告，但似乎没有任何视图继承该变量。我试图找到这方面的信息，但大多数寻找类似符号的人需要硬编码变量，例如网站标题。

我需要一些可以跨越障碍的东西，而且我更愿意避免使用会话/cookie，因为我想避免在英国处理整个 Cookie 事情，因为该网站的一半观众来自英国，我d 宁愿不必为了这个目的而努力说这个网站使用 cookie 等等等等接受/拒绝。此外，如果他们拒绝，这会给我的工作带来麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:04:03.153

如果要从全局范围导入变量，则需要使用`global`关键字。例如：

```
class SomeClass {
    public function SomeFunction() {
        global $adsIDvar; // now it is imported from the global scope
    }
} 
```

这只是我的意见，但也许更好的方法是制作一个专门用于处理广告 ID 的特殊类。我可能会尝试这样的事情：

```
class AdHelper {
    public static $advertiser_id;

    public static function getAdvertiserId() {
        if (!isset(self::$advertiser_id)) {
            self::selectAdvertiserId();
        }

        return self::$advertiser_id;
    }

    protected static function selectAdvertiserId() {
        self::$advertiser_id = ....; // Implement this however you like, random or whatever
    }
}

// you can call it from anywhere like:
$adsIDvar = AdHelper::getAdvertiserId(); 
```

# css - 是否可以使用 CSS 更改半个单词（徽标名称）的颜色？

> ID：10791510
> 
> 赞同：3
> 
> 时间：2012-05-28T23:39:06.870
> 
> 标签：css, html

我有一个名为 Example 的徽标名称。

我希望 Exam 是蓝色的，le 是红色的。

我知道您可以使用 :first-letter 但我最多需要更改 4 个字符。这是唯一阻止我制作纯 CSS 徽标而不是使用图像的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T23:48:32.320

您可以将单个（我假设是一个跨度）拆分为 3 个单独的跨度。

```
<span class="blue logo">Exam</span><span class="logo">p</span><span class="red logo">le</span> 
```

那么你的css可能看起来像这样

```
.blue {
    color: blue;
}

.red {
    color: red;
}

.logo {
    font-size: 33px;
    font-family: Helvetica;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:16:24.170

```
<!doctype html>
<html>
    <头部>
        <标题></标题>
        <风格>
h1 {
    字体大小：0；
}
h1：之前{
    内容：'示例'；
    颜色：#0000ff；
    字体大小：32px；
}
h1：在{之后
    内容：“乐”；
    颜色：#ff0000；
    字体大小：32px；
}
        </style>
    </head>
    <正文>
        <h1>示例</h1>
    </正文>
</html>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T23:44:37.057

假设您可以修改标记，您可以重新包装文本：

```
<span class="branding-highlight">Exam</span>ple
.branding-highlight {color:red;} 
```

CSS 还没有访问[第 n 个所有内容的](http://css-tricks.com/a-call-for-nth-everything/)机制。如果可以，浏览器将需要时间来采用它——上面的示例将仍然得到最好的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-15T19:23:13.660

我知道你已经接受了一个答案，但我想我会使用 jQuery 贡献这个方法，因为它可能对你或这个问题的未来读者有用。

**HTML：**

```
<span class="logo">Example</span> 
```

**CSS：**

```
.logo{
   color:blue;
} 
```

**jQuery：**

```
$('.logo').each(function() {
    $(this).html(
        $(this).html().substr(0, $(this).html().length-3)
        + "<span style='color: red'>"
        + $(this).html().substr(-3)
        + "</span>");
}); 
```

**[演示](http://jsfiddle.net/SimplyAzuma/2s9pA/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T06:13:16.830

嘿，我想你想这样

**这是 CSS 部分**

```
.logo{
    font-size: 33px;
    font-family: Helvetica;
    color:red;
}
.logo > span{
    color:blue;
} 
```

**这是 HTML 部分**

```
<div class="logo">
    Exam
    <span>ple</span>
</div> 
```

现在查看**现场演示** [http://jsfiddle.net/SyPfG/](http://jsfiddle.net/SyPfG/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-27T18:03:27.813

即使不修改标记也是可能的：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Title of the document</title>
    <style>
      h1 {
      display: inline-block;
      margin: 0;
      line-height: 1em; 
      font-family: Helvetica, Arial, sans-serif;
      font-weight: bold;
      font-size: 100px;
      background: linear-gradient(to right, #1c87c9 50%, #8ebf42 50%);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      }
    </style>
  </head>
  <body>
    <h1>R</h1>
    <p>This is a character with half-style.</p>
  </body>
</html>
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-05-28T23:46:07.007

您可以按照 OV 的建议使用此方法！：
`<div id="logo"><span style="color:red">Exam</span><span style="black">p</span><span style="blue">le</span></div>`

# zend-framework - 包含路径的 zend 框架安装问题

> ID：10791514
> 
> 赞同：0
> 
> 时间：2012-05-28T23:40:39.797
> 
> 标签：zend-framework, frameworks, installation, include-path

我第一次尝试安装 Zend Framework，我正在运行 WAMP。我下载了文件并解压缩并将其移动到 C:\wamp\bin\php\

我将库的路径添加到环境变量中。变量名：路径，变量值：C:\wamp\bin\php\zend_framework\library

我通过 php_info() 验证了正在使用的 php.ini 文件。我打开它并设置了zend库的路径。include_path = ".;C:\wamp\bin\php\zend_framework\library;C:\wamp\bin\php\PEAR-1.9.4;"

当我打开一个 cmd 行并输入 zf 时，我得到这个：

****** *** ** *** ** *** ** *** ******采埃孚错误******* *** ** *** ** *** ** *** ** *** **** 为了运行 zf 命令，您需要确保 Zend Framework 在您的 include_path 中。有多种方法可以确保此 zf 命令行工具知道 Zend Framework 库在您的系统上的位置，但并非所有方法都可以在此处描述。*****

 *****让 zf 命令运行的最简单方法是通过环境变量 ZEND_TOOL_INCLUDE_PATH 或 ZEND_TOOL_INCLUDE_PATH_PREPEND 为其提供包含路径，并使用正确的包含路径，然后运行命令“zf --setup”。此命令旨在为您的用户创建一个存储位置，以及创建 zf 命令将参考的 zf.ini 文件，以便在您的系统上正常运行。

您将运行的示例：

$ ZEND_TOOL_INCLUDE_PATH=/path/to/library zf --setup

我们鼓励您在下面的链接中阅读更多内容。Zend_Tool 和 CLI 设置信息（可通过命令行“zf --info”获得） * 在环境变量 HOMEPATH 中找到具有值 \Users\TOS H 的主目录 * 假定存储目录位于主目录的位置 \Users\TOSH/.zf/ * 存储目录不存在于 \Users\TOSH/.zf/ * 配置文件假定在主目录的位置 \Users\TOSH/.zf.ini * 配置文件不存在于 \Users\TOSH/.zf.ini

## 要更改此工具的设置，请运行：“zf --setup”

php -i 从 cmd 行工作。

操作系统：Windows 7 64 位 PHP v. 5.3.9 Apache 2.2.21

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:41:04.413

用于 CLI 的 php.ini 与您使用 wamp 打开的用于 Web 服务器 (apache) 的不同

```
C:\wamp\bin\apache\Apache2.2.21\bin\php.ini 
```

you should add include_path in following ini aswell

```
C:\wamp\bin\php\php5.3.10\php.ini 
```

Note depending upon your versions of php , apache path could be little different.*****

# c++ - 同一服务器上的多个并发 FastCGI 应用程序

> ID：10791515
> 
> 赞同：1
> 
> 时间：2012-05-28T23:40:43.407
> 
> 标签：c++, api, rest, fastcgi

我在后端有一个带有 C++ API 的 RESTful Web 服务。我正在使用 FastCGI 库来促进 REST 接口。我的 C++ API 有多个可以独立使用的函数。我正在寻找一种尽可能快的方法。以下是我得到的一些想法：

1.  有一个 FastCGI 应用程序获取要执行的函数，执行该函数并返回输出。这样，即使下一次调用是针对不同的独立函数，API 调用也会一直等待直到一个“函数”完成。

2.  拥有多个 FastCGI 应用程序，每个应用程序只能从 API 访问一个函数，每个应用程序都获取该特定应用程序的输入并单独返回该特定应用程序的输出。

通过这种方式，我可以对所有不同的函数进行并发调用，并且将为我拥有的每个函数创建单独的进程队列，而不是为 FastCGI 应用程序提供一个由对不同独立函数的调用组成的通用进程队列。

虽然这看起来会更好，但我不确定是否可以实现这样的系统 - 即让许多 FastCGI 应用程序从同一台服务器并行运行。如果可能的话，有人可以告诉我如何实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T02:37:36.153

每个 FastCGI 应用程序都是一个单独的程序，循环运行，并以 FastCGI 规范定义的二进制协议与 Apache 通信。唯一可能的并发问题与您在运行并发 CGI 或 PHP 请求时遇到的并发问题相同，只有一个例外：由于 FastCGI 进程不会终止，因此必须仔细管理任何有限的资源。例如，如果您只有一个数据库服务器的 10 个客户端许可证，那么您不能有 11 个 FastCGI 进程使用该数据库，除非您管理的连接比“开始时打开，结束时关闭”方法更常用CGI 或 PHP。

# ruby - 如何以这种特殊方式解析这个 Craigslist 页面？

> ID：10791520
> 
> 赞同：5
> 
> 时间：2012-05-28T23:41:38.150
> 
> 标签：ruby, nokogiri

这是有问题的页面：http: [//phoenix.craigslist.org/cpg/](http://phoenix.craigslist.org/cpg/)

我想做的是创建一个如下所示的数组：

日期（由该页面上的 h4 标记捕获）=> 在单元格中`[0][0][0]`，
链接文本 => 在单元格中`[0][1][0]`
链接 href => 在单元格中`[0][1][1]`

即在每一行中，我每行存储这些项目中的每一个。

我所做的只是将所有`h4`标签拉入并将它们存储在这样的哈希中：

```
contents2[link[:date]] = content_page.css("h4").text 
```

这样做的问题是一个单元格存储了整个页面上 h4 标签中的所有文本......而我希望有 1 个日期到 1 个单元格。

举个例子：

```
0 => Mon May 28 - Leads need follow up - (Phoenix) - http://phoenix.craigslist.org/wvl/cpg/3043296202.html
1=> Mon May 28 - .Net/Java Developers - (phoenix) - http://phoenix.craigslist.org/cph/cpg/3043067349.html 
```

任何关于我如何使用代码来解决这个问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:37:00.653

这个怎么样？

```
require 'rubygems'
require 'open-uri'
require 'nokogiri'

doc = Nokogiri::HTML(open("http://phoenix.craigslist.org/cpg/"))

# Postings start inside the second blockquote on the page
bq = doc.xpath('//blockquote')[1]

date  = nil         # Temp store of date of postings
posts = Array.new   # Store array of all postings here

# Loop through all blockquote children collecting data as we go along...
bq.children.each { |nod|
  # The date is stored in the h4 nodes. Grab it from there.
  date = nod.text if nod.name == "h4"

  # Skip nodes until we have a date
  next if !date

  # Skip nodes that are not p blocks. The p blocks contain the postings.
  next if nod.name != "p"

  # We have a p block. Extract posting data.
  link = nod.css('a').first['href']
  text = nod.text

  # Add new posting to array
  posts << [date, text, link]
}

# Output everything we just collected
posts.each { |p| puts p.join(" - ") } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:40:10.323

还有其他方法，但遍历可能再次是最简单的：

```
doc.traverse do |node|
  @date = node.text if node.name == 'h4'
  next unless @date
  break if node.text['next 100 postings']
  puts [@date, node.parent.text, node[:href]].join(' - ') if node.name == 'a'
end 
```

# c++ - OpenGL FBO 不渲染到纹理 (C++)

> ID：10791524
> 
> 赞同：0
> 
> 时间：2012-05-28T23:42:25.713
> 
> 标签：c++, opengl, fbo

我一直在尝试将茶壶渲染到 FBO，然后将后续纹理用作纹理贴图。似乎什么都没有出现，所以我想知道我做错了什么。下面是主循环：

```
//switch to fbo
glBindFramebuffer(GL_FRAMEBUFFER, fbo);

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

glLoadIdentity();
gluLookAt(0.0,0.0,5.0, 
          0.0,0.0,-1.0,
          0.0f,1.0f,0.0f);

glLightfv(GL_LIGHT0, GL_POSITION, lpos);
glRotatef(a,0,1,1);
glutSolidTeapot(1);

   //switch to main

glBindFramebuffer(GL_FRAMEBUFFER, 0);
glLoadIdentity();
gluLookAt(0.0,0.0,5.0, 
          0.0,0.0,-1.0,
          0.0f,1.0f,0.0f);

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glBindTexture(GL_TEXTURE_2D, img);

   //draw cube

glColor4f(1, 1, 1, 1);
    glBegin(GL_TRIANGLES);
    // front faces
    glNormal3f(0,0,1);
    // face v0-v1-v2
    glTexCoord2f(1,1);  glVertex3f(1,1,1);
    glTexCoord2f(0,1);  glVertex3f(-1,1,1);
    glTexCoord2f(0,0);  glVertex3f(-1,-1,1);
  ...draws cube 
```

我尝试使用 glFramebufferStatus 并返回“成功”

```
 glGenTextures(1, &img); 
glBindTexture(GL_TEXTURE_2D, img); 
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, 512, 512, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);

glGenFramebuffers(1,&fbo);
glBindFramebuffer(GL_FRAMEBUFFER,fbo);
glGenRenderbuffers(1, &depthbuffer);    
glBindRenderbuffer(GL_RENDERBUFFER, depthbuffer);
glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT, 512, 512);
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthbuffer);

glGenTextures(1, &img); 
glBindTexture(GL_TEXTURE_2D, img); 
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, 512, 512, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);

glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, img, 0);

    glBindFramebuffer(GL_FRAMEBUFFER, fbo);

GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);

if (status==GL_FRAMEBUFFER_COMPLETE) {
    printf("success\n");
} 
```

然而，我得到的只是没有纹理映射的立方体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T23:55:05.327

这里有两个可能的错误：

1.  渲染到 FBO 失败。要检查是否是这种情况，请使用不同的背景颜色（例如粉红色）清除 FBO，并查看纹理是否受到影响（例如，通过将其读回 CPU）。您还应该确保您的转换矩阵和视口 ( `glViewport`) 是正确的。

2.  纹理映射失败。确保您已经为纹理映射设置了所有内容，并首先使用静态纹理测试纹理映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T23:49:45.610

怎么样`glEnable ( GL_TEXTURE_2D )`？

# c# - 自定义表单控件中的 FieldInfo.CaptionStyle 不起作用

> ID：10791530
> 
> 赞同：0
> 
> 时间：2012-05-28T23:43:41.343
> 
> 标签：c#, asp.net, .net, content-management-system, kentico

我使用 asp.net 创建了一个自定义表单控件，用于在我的 Kentico bizform 中使用，我想根据自定义表单控件字段中的值更改表单中另一个字段的字段标题样式。所以，这就是我所做的：

```
protected void ddl_SelectedIndexChanged(object sender, EventArgs e)
{
   if(this.Value == "1")
   {
       FormEngineUserControl formItem = (FormEngineUserControl)this.Form.FieldControls["Other"];
       formItem.FieldInfo.CaptionStyle = "font-weight:bold";
   }
} 
```

但是，表单中的字段标题似乎没有加粗。我尝试测试事件是否会触发并且确实会触发。事实上，如果我尝试像 formItem.Text = "Something" 之类的东西，那么 texbox 就会充满“Something”。在调试时，我还注意到字段标题样式确实更改为“字体粗细：粗体”，但这并没有显示在表单上。所以，captionstyle 属性或我使用它的方式有问题。我如何让它工作？

（请注意，字段控件“Other”是文本框输入）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T18:20:33.010

在 Page 的生命周期中可能为时已晚，并且控件已经呈现。尝试更早地设置 CaptionStyle（例如在控件的 OnLoad 或 OnInit 中），您就会确定地知道。

# java - 简单加法应用程序不起作用“不幸的是，......”

> ID：10791533
> 
> 赞同：0
> 
> 时间：2012-05-28T23:44:07.973
> 
> 标签：java, android, xml, eclipse

我是初学者，我需要一些建议。当我尝试在 android 模拟器中运行以下 Android 应用程序时，当我尝试运行它时，它会显示“不幸的是，再次关闭”。

我不确定为什么它不起作用。

有人可以给我建议吗？谢谢马特

爪哇：

```
package again.we.practice;

import org.apache.cordova.DroidGap;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class AgainActivity extends DroidGap {
/** Called when the activity is first created. */

int counter;
Button add, sub;
TextView display;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView (R.layout.main);
    counter = 0;
    add = (Button) findViewById(R.id.bAdd);
    add = (Button) findViewById(R.id.bSub);
    display = (TextView) findViewById(R.id.tvdisplay);
    add.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            counter++;
            display.setText("Your total is " + counter);
        }
    });
    sub.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            counter--;
            display.setText("Your total is " + counter);
        }
    });
}
} 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="again.we.practice"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="7"/>
<supports-screens 
android:largeScreens="true" 
android:normalScreens="true" 
android:smallScreens="true" 
android:resizeable="true" 
android:anyDensity="true" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name" 
        android:name=".AgainActivity"
        android:configChanges="orientation|keyboardHidden" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:49:38.117

sub 从未初始化，因此给出一个空指针

```
sub = (Button) findViewById(R.id.bSub); 
```

会成功的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:01:55.567

代替

```
add = (Button) findViewById(R.id.bSub); 
```

和

```
sub = (Button) findViewById(R.id.bSub); 
```

你得到一个空指针异常，因为 sub 没有实例化。如果错误没有消失，请打印 log cat，以便我们为您提供帮助。

# .net - Sharepoint 2010 沙盒中的 .NET 图表控件

> ID：10791535
> 
> 赞同：0
> 
> 时间：2012-05-28T23:44:38.783
> 
> 标签：.net, sharepoint, charts, sandbox

我正在尝试在我的 Sharepoint 2010 沙盒解决方案中使用 .NET 图表控件。我已经[从这里](http://www.microsoft.com/en-us/download/details.aspx?id=14422)下载并安装了 .NET 3.5 的 MSChart 。

有谁知道 Sharepoint 2010 沙盒解决方案是否支持 .NET 图表控件？

我试图找到示例，但我只能找到 Sharepoint 2010（不是沙盒）的示例，在这些示例中，您需要在 web.config 文件中添加程序集引用，这在沙盒中是不可能的。[这是在 Sharepoint http://mosshowto.blogspot.com.au/2008/12/asp-net-chart-control-sharepoint.html](http://mosshowto.blogspot.com.au/2008/12/asp-net-chart-control-sharepoint.html)中使用 .NET 图表的示例。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T05:59:40.553

您不能在 SP2010 沙箱中使用 .Net 图表控件。
我通常在服务器上生成 JSON 数据，然后在客户端使用 JavaScript 和 HighCharts [http://www.highcharts.com/](http://www.highcharts.com/)生成图形。

它完成了这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T23:54:07.663

图表 Web 部件在 SharePoint 2010 中开箱即用。有关详细信息，请参阅[文章。](http://www.dotnetmafia.com/blogs/dotnettipoftheday/archive/2010/02/24/impress-the-boss-with-the-sharepoint-2010-chart-web-part.aspx)

# php - 不使用 Zend_Application 的 Zend Framework 项目

> ID：10791540
> 
> 赞同：4
> 
> 时间：2012-05-28T23:45:05.980
> 
> 标签：php, performance, model-view-controller, zend-framework

即使[在这里](https://stackoverflow.com/questions/3777765/using-zend-framework-for-highload-projects)，我也一直在许多[站点](http://blog.astrumfutura.com/2010/02/php-framework-benchmarks-entertaining-but-ultimately-useless/)上阅读，为了提高 Zend Framework 应用程序的性能，不要在引导程序中使用 Zend_Application，但还没有找到一个可以证明这一点的站点。

你们知道有这个方法描述的地方，并且可能会为我提供一些代码示例吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T04:26:29.323

我只是把这个放在一起：

[https://gist.github.com/2822456](https://gist.github.com/2822456)

转载如下以完成。未经测试，只是我认为它通常（！）可能工作的一些想法。现在我已经了解了一点，我对 Zend_Application、它的引导类以及它的可配置/可重用应用程序资源有了更大的了解。;-)

```
// Do your PHP settings like timezone, error reporting
// ..

// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/_zf/application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'production'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

// Get autoloading in place
require_once 'Zend/Loader/Autoloader.php';
$autoloader = Zend_Loader_Autoloader::getInstance();
// Any additional configs to autoloader, like custom autoloaders

// Read config
$config = new Zend_Config_Ini(APPLICATION_PATH . '/configs/application.ini', APPLICATION_ENV);

// bootstrap resources manually:
// * create db adapter
// * create resource autoloaders with the mappings you need
// * etc

// Get the singleton front controller
$front = Zend_Controller_Front::getInstance();

// Set controller directory
$front->setControllerDirectory(APPLICATION_PATH . '/controllers');

// Or set module directory
$front->setModuleDirectory(APPLICATION_PATH . '/modules');

// Other front config, like throw exceptions, etc.
// ...
// 
// Create a router
$router = new Zend_Controller_Router_Rewrite();

// Add routes to the router
$router->addRoute('myRoute', new Zend_Controller_Router_Route(array(
    // your routing params
)));
// More routes...
// Alternatively, the routes can all be in an xml or ini file and you can add 
// them all at once.

// Tell front to use our configured router
$front->setRouter($router);

// Add an plugins to your $front
$front->registerPlugin(new My_Plugin());
// other plugins...

// Dispatch the request
$front->dispatch(); 
```

也可能有一些 View/ViewRenderer 的事情要做。但正如在其他地方所指出的那样，ViewRenderer 会产生不小的性能损失。如果性能是问题，那么您将需要禁用 ViewRenderer 并使您的动作控制器使用调用自己的渲染`$this->view->render('my/view-script.phtml')`

当您调用`$front->dispatch()`时，将自动创建`$request`和对象。`$response`如果你想在引导时对它们做一些特定的事情——比如在响应的 Content-Type 标头中设置字符集——那么你可以自己创建你的请求/响应对象，做你想做的事情，然后将它附加到前面与`$front->setResponse($response);`请求对象相同。

尽管我看到我的示例使用了`Zend_Loader_Autoloader`哪些`Zend_config_Ini`Padraic 笔记会导致性能下降。下一步是通过使用数组进行配置、从框架中剥离 require_once 调用、注册不同的自动加载器等来解决这些问题，这是留给读者的练习...... ;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:36:57.177

嗨，我有点不同意在引导程序中不使用 Zend_Application，而且我还没有看到这种技术的具体示例。

就我个人而言，我认为不使用 Zend_app 引导您的应用程序没有什么好处，假设 a）您以“Zend 方式”做事并且 b）您的项目要么足够大，要么只是保证使用 Zend 框架（或任何其他框架）事情）。

> 虽然 Zend_App 非常适合在标准化结构中创建一致的复杂引导程序，但它不会对基线性能没有显着的性能影响。更直接的引导程序（在 Zend_App 到来之前是 ZF 的典型）要快得多，并且也可以在没有配置文件的情况下完成。

*取自 Pádraic Brady 链接。*

对我来说，上面没有任何意义，他基本上只是说 Zend_App 非常适合复杂的引导程序，但增加了性能损失。但这不是任何框架/框架组件的前提吗？我知道帕德莱克是一个非常聪明的人，我相信他有他的推理，但我也很想看到这个建议的例子/证据。

也许在回答您的问题时，您可以使用最新的 Zend 框架对基本应用程序进行基准测试，然后使用旧的非 Zend_App 方式从 < 1.10 开始使用 Zend 框架，但我想说虽然显然不是完美的 Zend_App 显然更快地启动大多数应用程序并运行，所以这是否值得“性能打击”取决于开发人员。

这是一个链接，它在某种程度上涉及您可能追求的内容，但参考了模块化方法（仍然很有趣，但仍然如此）：

[http://www.osebboy.com/blog/zend-framework-modules/](http://www.osebboy.com/blog/zend-framework-modules/)

# xml - 如何从 eXist 服务器 XML 数据库中查询数据？

> ID：10791543
> 
> 赞同：1
> 
> 时间：2012-05-28T23:45:37.920
> 
> 标签：xml, exist-db

如何从存储在 eXist 服务器中的 XML 文件中查询结果？我对脚本完全陌生。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T05:55:08.227

[XQuery WikiBook](http://en.wikibooks.org/wiki/XQuery)为 XQuery 初学者提供了一组[示例](http://en.wikibooks.org/wiki/XQuery#Beginning_Examples)——这是一个很好的起点。

# javascript - 让backbone.js 'fetch' 自动更新视图

> ID：10791546
> 
> 赞同：3
> 
> 时间：2012-05-28T23:46:06.240
> 
> 标签：javascript, ajax, backbone.js, fetch

我正在尝试使用 Backbone.js 完成一项基本任务，但无法使其正常工作。我只想对我的模型执行*获取*操作并让它更新视图。这是我的代码：

```
(function($) {
    var HomeModel = Backbone.Model.extend({
        defaults: {
            lead: "not logged in",
        },
        url: 'test.php'
    });

    var HomeView = Backbone.View.extend({
        initialize: function() {
            this.model = new HomeModel();
            this.model.bind("change", this.render);
            this.model.fetch();
        },

        el: $("#content"),

        render: function() {
            this.$el.html(this.model.get("lead"));
        }
    });

    var homeView = new HomeView();
})(jQuery); 
```

我可以看到“test.php”加载成功，但*渲染*函数永远不会被调用。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:27:14.053

您是如何看到“test.php”成功加载的？也许 AJAX 请求成功，但响应不是有效的 JSON？尝试在 fetch 调用中添加成功和错误回调：`this.model.fetch({success: function (resp) { console.log('success: %o', resp) }, error: function (er) { console.log('error: %o', er) });`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:50:35.300

我想我有正确的答案。您在函数中指`this`的是`render`，但上下文`this`是事件而不是您的类。因此，您应该使用下划线的`bindAll`函数将类绑定到函数的内部。像这样：

```
var HomeView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this, 'render'); // bind 'this' in 'render'
        this.model = new HomeModel();
        this.model.bind("change", this.render);
        this.model.fetch();
    },
}); 
```

否则 this.el 不存在，或者至少是错误的，并且悄悄地失败了。

# c++ - Boost.MPL 转换状态？

> ID：10791548
> 
> 赞同：2
> 
> 时间：2012-05-28T23:46:14.447
> 
> 标签：c++, templates, boost-mpl

我有以下 mpl 序列

```
boost::mpl::vector_c<std::size_t, 0, 1, 2, 0, 1, 0> 
```

我需要根据以下算法（运行时版本）对其进行转换：

```
i=0
output_sequence=[]
for k in (0,...,len(input_sequence)-1):
if input_sequence[k] == 0:
    output_sequence.append(i)
    i=i+1
else:
    output_sequence.append(-1) 
```

在我的情况下，结果应该是：

```
boost::mpl::vector_c<std::size_t, 0, -1, -1, 1, -1, 2> 
```

我可以想象至少有两种方法可以在运行时使用 std::transform 或 std::accumulate 实现这一点，但不知道如何在编译时使用 mpl 实现相同的结果。对我来说主要问题是以某种方式存储状态“i”（当前找到的零数）以及输出序列。

非常感谢！

## 添加

根据HighCommander4的回答，我想与大家分享采用的方法。实际上，可以`boost::mpl::fold`与自定义元函数一起使用。与 HighCommander4 相比，唯一的概念变化是将当前可用的空闲索引打包为增长的输出序列的第一个元素。可以在类型计算结束时使用 删除它`boost::mpl::pop_font`。

```
#include <boost/mpl/size_t.hpp>
#include <boost/mpl/equal_to.hpp>

#include <boost/mpl/fold.hpp>

#include <boost/mpl/front.hpp>
#include <boost/mpl/push_front.hpp>
#include <boost/mpl/push_back.hpp>
#include <boost/mpl/pop_front.hpp>

#include <boost/mpl/vector_c.hpp>
#include <boost/mpl/if.hpp>
#include <boost/mpl/at.hpp>

#include <boost/mpl/print.hpp>

namespace mpl=boost::mpl;

struct assign_index
{
                enum { dim_dynamic, dim_static };
                template<typename Output, typename Index,
                         typename Enable = typename mpl::if_<
                                             mpl::equal_to<Index, mpl::size_t<1> >,
                                             mpl::size_t<dim_dynamic>,
                                             mpl::size_t<dim_static> >::type>
                struct apply 
                {
                                typedef typename mpl::push_back<Output, mpl::size_t<-1> >::type type;
                };

                template<typename Output, typename Index>
                struct apply <Output, Index, mpl::size_t<dim_dynamic> >
                {
                                typedef typename mpl::front<Output>::type current;
                                typedef typename mpl::next<current>::type next;
                                typedef typename mpl::push_back<Output, current>::type append_type;
                                typedef typename mpl::push_front<
                                                typename mpl::pop_front<append_type>::type,next
                                                >::type type;
                };              
};

template<class input_sequence>
struct map_indices
{
                // The first element of state0 keeps track of the current index count.
                typedef mpl::vector_c<std::size_t, 0> state0;
                typedef typename mpl::fold<input_sequence, state0, assign_index>::type output_sequence;

                // Remove the first element from the final output sequence
                typedef typename mpl::pop_front<output_sequence>::type type;
};

int main (int argc, const char** argv)
{
                typedef mpl::vector_c<std::size_t, 1, 2, 3, 1, 2, 1> input_sequence;
                typedef map_indices<input_sequence>::type output_sequence;
                int i;
                i=mpl::print<mpl::at_c<output_sequence, 0>::type>();
                i=mpl::print<mpl::at_c<output_sequence, 1>::type>();
                i=mpl::print<mpl::at_c<output_sequence, 2>::type>();
                i=mpl::print<mpl::at_c<output_sequence, 3>::type>();
                i=mpl::print<mpl::at_c<output_sequence, 4>::type>();
                i=mpl::print<mpl::at_c<output_sequence, 5>::type>();
                return 0;
} 
```

PS：在这个实现中，输入序列中的“1”被转换为递增索引，而大于 1 的值被转换为 std::size_t(-1)。输入序列中不允许有零（在别处检查）。

PS2：我已经检查过，确实没有工具`boost::mpl`可以将任意`mpl`序列（作为算法结果获得的序列）转换回`boost::mpl::vector`. 因此也有必要为此编写代码......我最终调整了代码

```
<boost/fusion/container/vector/detail/as_vector.hpp> 
```

对类型计算结果进行“规范化”。

再次感谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T06:33:21.103

模板元编程确实需要一些时间来适应。

注意循环是如何变成递归的，if 语句是如何变成模板特化的，而“状态”是如何变成额外的模板参数的：

```
#include <cstddef>
#include <boost/mpl/print.hpp>
#include <boost/mpl/vector_c.hpp>
#include <boost/mpl/push_back.hpp>
#include <boost/mpl/pop_front.hpp>
#include <boost/mpl/front.hpp>
#include <boost/mpl/size.hpp>

using boost::mpl::vector_c;
using boost::mpl::push_back;
using boost::mpl::pop_front;
using boost::mpl::front;
using boost::mpl::int_;
using boost::mpl::size;

typedef vector_c<std::size_t, 0, 1, 2, 0, 1, 0> input_sequence;

template <int i, int current>
struct next_i
{
    static const int value = i;
};

template <int i>
struct next_i<i, 0>
{
    static const int value = i + 1;
};

template <int i, int current>
struct next_output
{
    static const int value = -1;
};

template <int i>
struct next_output<i, 0>
{
    static const int value = i;
};

template <typename rest_of_input, int rest_of_input_size, int i, typename output_so_far>
struct loop
{
    typedef typename front<rest_of_input>::type current_t;
    static const int current = current_t::value;
    static const int next_i_ = next_i<i, current>::value;
    static const int next_output_ = next_output<i, current>::value; 

    typedef typename loop<
            typename pop_front<rest_of_input>::type,
            rest_of_input_size - 1,
            next_i_,
            typename push_back<output_so_far, int_<next_output_> >::type 
    >::type type;
};

template <typename rest_of_input, int i, typename output_so_far>
struct loop<rest_of_input, 0, i, output_so_far>
{
    typedef output_so_far type;
};

template <typename input>
struct algorithm
{
    typedef typename size<input>::type size_;
    typedef typename loop<input, size_::value, 0, vector_c<std::size_t> >::type type;
};

typedef algorithm<input_sequence>::type output_sequence;

int main()
{
    boost::mpl::print<output_sequence>();
} 
```

这可能写得更好（也许用`mpl::fold`）。

# ruby-on-rails - ActiveResource 从根本上是有缺陷的吗？

> ID：10791549
> 
> 赞同：19
> 
> 时间：2012-05-28T23:46:15.370
> 
> 标签：ruby-on-rails, rest, activeresource

来自不同团队的几位开发人员独立地告诉我，ActiveResource 是一个有缺陷的想法。我听到的最常见的批评是，将其设计为具有类似 ActiveRecord 的界面是错误的。我还听到有关处理错误或吞并错误的方式的抱怨。一位开发人员实际上创建了自己的 gem 来提供与 ActiveResource（基于 RESTful 资源的模型框架）相同的功能。

我是 ActiveResource 的新手，但是当我查看代码并进行实验并了解它是如何工作的时，我很难看出阻力来自何处。它似乎基于干净、可靠的概念。我什至听说它太重了！但在我的考试中，我发现它轻而快。

因此，在所有关于 ActiveResource 的争议中，我转向网络寻求答案。当然，肯定有很多关于为什么 ActiveResource 应该支持 X 的博客文章。毕竟，我肯定能找到关于 DataMapper 是否优于 ActiveRecord 的文章。所以我已经搜索了，我已经搜索了......什么都没有。没有一件事。我在 Internet 上找不到任何批评 ActiveResource 的页面（除了对 REST 的全面批评）。我什至找不到建议的替代方案。它得到了 Rails 核心团队的支持，似乎是社区事实上的标准。

**底线：**

ActiveResource 有争议吗？如果是这样，辩论的性质是什么？有替代品吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-24T12:04:20.477

自 2007 年以来，我与 ActiveResource 进行了广泛的合作，并在 Rails 从 v1.2 升级到 v4.0 期间使用 ARes 构建和维护了一个多服务分布式架构。在我看来，作为当前形式的公共图书馆，ARes从根本上*是*有缺陷的，但它包含许多可以在单个系统中使用的好想法。我做了[一个](https://skillsmatter.com/skillscasts/5283-deprecating-activeresource-alternative-approaches-for-internal-rails-services)关于我们在公司从 ARes 迁移出来的演讲。

人们在实践中不喜欢 ARes 的一个重要原因是他们不同意的维护不善或实施细节。诸如处理您同事提到的错误消息之类的事情属于此类别。此外，随着时间的推移，您会发​​现由于不明智的一次性改进或错误修复，甚至是 Rails 内部变化的渗透（例如，去年[YAML 灾难](http://www.kalzumeus.com/2013/01/31/what-the-rails-security-issue-means-for-your-startup/)来袭时，我们的 ARes 遭遇了灾难性的崩溃）。系统）。但是所有这些事情都可以通过更好的维护和更好的视野来改进，将这些问题与*基本*问题分开很重要。

我开始相信，以及 Yehuda 在上面的评论中提到的，ARes 失败了，因为 REST API 没有一般的具体语义。即使利用最好的 Rails 约定，HTTP API 语义充其量也是脆弱的。

与 ActiveRecord 所做的对比，它生成 SQL：一种用于选择数据行的定义良好的声明性语言。SQL 基于关系模型，它为我们提供了基于不同子句的查询含义的数学定义。这种数学基础允许像 Arel 这样的东西在 ruby​​ 中创建可组合的 SQL DSL。在 SQL 数据库中，可以执行任何语法正确的查询（即使它太慢而不实用），因为引擎被设计为正式解析和映射 SQL 语句以可证明正确的实现来操作和获取基础数据。因此，当您在此基础上构建像 ActiveRecord 这样的 ORM 时，您在底层系统中有非常强大的保证。如果您生成有效的 SQL 引擎保证它会工作，如果您生成无效的 SQL，引擎会返回一个错误。即使 SQL 标准化，值得注意的是每个数据库都有一个单独的 ActiveRecord 适配器，以确保正确性和正确映射到 ActiveRecord 功能。它们中的每一个都使用底层驱动程序来保证对正在运行的数据库的正确有线协议实现。所有这些代码背后都有相当多的规范和维护，所有这些都使当今的 ActiveRecord 具有良好的优雅性和可靠性。

现在考虑一个 HTTP API 及其支持？它可以是任何数据库技术，或者根本就没有！它很可能是内部编写的，并且仅提供业务功能所必需的内容。与在其模式中携带有关通用查询操作的所有必要信息的数据库不同，HTTP API 与任何底层存储机制或业务逻辑完全解耦。即使 API 提供了如何使用查询参数的标准，也没有关于哪些过滤器或排序选项可用的自文档定义。哎呀，即使检查参数的有效性也不能保证，因为 API 通常不会吞下或忽略无效的参数。

综上所述，ARes 非常方便，但它是建立在流沙之上的。它使用的想法和惯例很方便，但它们缺乏凝聚力的愿景和稳定性，无法可靠。就我个人而言，我认为使用自己的约定和可靠的规范来滚动你的 ARes 看起来很相似，然后你可以将它们应用于你的服务实现并不是不合理的。

在建立一个像 ARes 之类的东西可能有意义的基础方面，Yehuda Katz 和 Steve Klabnik 的优秀[JSON:API](http://jsonapi.org)规范是一个很棒的社区项目，它将为这样一个基础提供一个非常重要的构建块，但值得注意的是就语义保证和可派生功能而言，它仍然远不及特定的数据库驱动程序。我怀疑一个真正优秀的类 ARes 库来利用 JSON-API 看起来与它今天所做的有很大不同，以更好地包含与 RDBMS 相比，即席 API 中隐含的灰色区域。

*编辑：经过两年激烈的辩论和来自不同社区的反馈，[JSON:API刚刚达到 1.0。](http://jsonapi.org)我估计在这个规范中投入的工作量比 ActiveResource 所达到的要多几个数量级。尽管它与 ActiveResource 的抽象级别不同，但 JSON:API 追求类似的目标，即提供标准语义，以便 API 更易于生产和使用。查看一些[实现](http://jsonapi.org/implementations/)可以很好地了解 JSON:API 可以提供多少杠杆作用。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T14:20:00.157

在 Rails 4.0 中，ActiveResource 已从 Rails 中提取。

很多人只是使用 RestClient 或 HTTParty 或其他库。这些库通常被认为更简单，更易于使用。

# internet-explorer - 谷歌地图 v3 无法在 IE9 中加载

> ID：10791551
> 
> 赞同：1
> 
> 时间：2012-05-28T23:46:32.857
> 
> 标签：internet-explorer, google-maps, internet-explorer-9

我在 Internet Explorer 9 中加载谷歌地图 v3 时遇到问题。Chrome 和 Firefox 完美加载它，但 IE9 根本不显示它。我有这个功能：

```
function load() {
  var map = new google.maps.Map(document.getElementById("mapa"), {
    center: new google.maps.LatLng(44.109742, 20.462222),
    zoom: 7,
    mapTypeId: 'roadmap'
  }); 
```

我在这里打电话：

```
<body onload="load()"> 
```

在我的页面的开头，我有一个识别浏览器的“if”子句：

```
<?php if ( preg_match( '/MSIE/i', $_SERVER['HTTP_USER_AGENT'] ) ) { ?>
    <link href="CSS/stylemapaIE.css" rel="stylesheet" type="text/css" />
<?php } elseif ( preg_match( '/Firefox/i', $_SERVER['HTTP_USER_AGENT'] ) ) { ?>
    <link href="CSS/stylemapaMF.css" rel="stylesheet" type="text/css" />
<?php } else { ?>
    <link href="CSS/stylemapa.css" rel="stylesheet" type="text/css" />
<?php } ?> 
```

并使用三种不同的 CSS 样式表。[您可以在http://jedanzasve.rs/Test/mapaponuda.php](http://jedanzasve.rs/Test/mapaponuda.php)看到页面有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:01:12.257

确保您没有使用 IE 9 的兼容性视图。要验证这一点 打开开发人员工具并查看菜单栏右侧的两个下拉菜单，如果显示 IE9 兼容性视图，请将其更改为 Internet Explorer 9 和 Internet Explorer 9 标准。

打开开发者工具

> 按 F12

或者

> 工具 > 选择 F12 开发者工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:03:46.900

地图在 IE9（浏览器模式：IE9）和 Chrome 中为我加载。但是，您确实`undefined`在控制台中出现了一些变量。这向我表明您没有正确引用所有资源，或者您没有以正确的顺序引用它们。当然，另一种可能性是您只是在处理缓存文件。

清除您的缓存，仔细检查您的资源及其依赖项。

# ruby-on-rails - Rails 使用 CarrierWave 和 MiniMagick 裁剪并上传到 S3

> ID：10791554
> 
> 赞同：2
> 
> 时间：2012-05-28T23:47:48.817
> 
> 标签：ruby-on-rails, carrierwave

我已经在这个有一段时间了。使用这个[RailsCast](http://railscasts.com/episodes/182-cropping-images?view=asciicast)，我已经能够修改它以与 CarrierWave 一起使用——至少在理论上是这样。我试图允许用户裁剪他们的个人资料照片，然后使用 CarrierWave 将其上传到 S3。到目前为止，这是有效的：

*   用户上传图片及其其他个人资料信息
*   他们成功地被带到一个裁剪页面，在那里他们可以裁剪照片 - 照片被上传并且原始图像尺寸被成功捕获
*   单击“裁剪”以保存图像不会触发任何错误（模型保存得很好），但据我所知，实际上也不会裁剪或重新创建版本。

所以，这是我得到的代码。这是模型：

```
attr_accessor :crop_x, :crop_y, :crop_w, :crop_h, :original_width, :original_height
attr_accessible :avatar, :remove_avatar
after_update :reprocess_avatar, :if => :cropping?

mount_uploader :avatar, ProfileBaseUploader

def cropping?
  !crop_x.blank? && !crop_y.blank? && !crop_w.blank? && !crop_h.blank?
end

private
  def reprocess_avatar
    avatar.process!
    avatar.recreate_versions!
  end 
```

漂亮的样板——crop_x 等属性是从裁剪视图分配的。我已经确认这些都被传入并正确分配，并且 reprocess_avatar 方法被调用。

这是我的上传代码：

```
include CarrierWave::MiniMagick
include CarrierWaveDirect::Uploader

storage :fog

require 'guid'

process :cropper
process :store_best_geometry

version :tiny_thumb do
  process :resize_to_limit => [50, 50]
end

version :thumb do
  process :resize_to_limit => [200, 200]
end

version :large do
  process :resize_to_fit => [500, 500]
end

def extension_white_list
    %w(jpg jpeg gif png)
end

def filename
   @name ||= "#{secure_token}.#{file.extension}" if original_filename.present?
end

def store_best_geometry
  manipulate! do |img|
    if model
      model.original_width = img['width']
      model.original_height = img['height']
    end
    img = yield(img) if block_given?
    img
  end
end

def cropper
  return unless model.cropping?
  manipulate! do |img|
    img = img.crop("#{model.crop_x}x#{model.crop_y}+#{model.crop_w}+#{model.crop_h}")
    img
  end
end

protected
  def secure_token
    var = :"@#{mounted_as}_secure_token"
    model.instance_variable_get(var) or model.instance_variable_set(var, Guid.new)
  end 
```

我**认为**是过程！并重新创建版本！方法根本无法正常运行，但我不知道为什么。我没有任何可以提供的错误（如果有人知道我如何生成错误，我很乐意这样做）。我知道 store_best_geometry 方法效果很好。不能对cropper说同样的话。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T02:51:35.560

就像一场糟糕的飞机失事一样，我做错了很多事情。

首先，我对作物的论据顺序错误。在我的问题中，你会注意到我有：

```
img.crop('[x offset]x[y offset]+[width]+[height]') 
```

正确的顺序是：

```
img.crop('[width]x[height]+[x offset]+[y offset]') 
```

所以这是问题一。尝试以错误的顺序执行此操作会引发错误（挖掘到控制台以找到它）关于提供的几何图形无效。

下一个问题：用我的cropper 方法打破收益链并返回一个字符串而不是一个图像。原来，crop 方法返回一个字符串。看看原来的cropper方法：

```
def cropper
  return unless model.cropping?
  manipulate! do |img|
    img = img.crop("#{model.crop_x}x#{model.crop_y}+#{model.crop_w}+#{model.crop_h}")
    img
  end
end 
```

哎呀！最后返回的是一个字符串。事实证明，正确的方法是直接调用图像上的方法：

```
def cropper
  return unless model.cropping?
  manipulate! do |img|
    img.crop("#{model.crop_w}x#{model.crop_h}+#{model.crop_x}+#{model.crop_y}")
    img = yield(img) if block_given?
    img
  end
end 
```

我做错的最后一件事——这完全是业余时间的错误——没有让一些关键属性可以访问。在我无限的智慧中，我假设 attr_accessor 将使属性可访问。没有。我必须修改我的模型以使crop_x、crop_y、crop_w 和crop_h 参数可以访问。

```
attr_accessor :crop_x, :crop_y, :crop_w, :crop_h, :original_width, :original_height
attr_accessible :avatar, :remove_avatar, :crop_x, :crop_y, :crop_w, :crop_h
after_update :reprocess_avatar, :if => :cropping? 
```

最后一点，不是很重要，但很容易知道。我不需要调用过程！作为recreate_versions！为我这样做。

希望这对至少一个人有帮助。

# flash - Flex/Flash Builder：引用另一个项目的正确方法？

> ID：10791557
> 
> 赞同：5
> 
> 时间：2012-05-28T23:48:05.793
> 
> 标签：flash, apache-flex, project-management, flash-builder, project

我有一个使用 Flash Builder 4.5 的相当大的 Flex/Flash Builder 项目。我想创建另一个项目，该项目使用该原始项目中的一些组件。在新项目中，我将资源与原始项目链接，它工作正常，但新项目的文件大小非常大。尽管它只使用了一小部分组件和资产，但它接近于原始项目的文件大小。有没有更好的方法来最小化新项目的文件大小？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T08:25:25.770

您应该将所有通用的、可重用的代码分成一个或多个库项目。在 FlashBuilder 中，您无法将项目的性质从应用程序转换为库，因此您必须创建一个空白库项目并复制您希望在两个项目中可用的代码。

以最简单的形式，您的项目结构应如下所示：

```
Flex app project A (swf) \
                           Flex library project (swc)
Flex app project B (swf) / 
```

现在要使用该库，请转到“Properties > Flex Build Path”，单击“Add Project...”按钮并选择您刚刚创建的库项目。

![添加库项目](../Images/3e0f6b57be08a92251a141f05f0d33ae.png)

现在您已链接到该项目，您想要选择如何链接引用的组件。（双击“链接类型”进行编辑。）

![选择链接类型](../Images/4e3c429034c0a63605241c4267ff1450.png)

通过您链接项目的方式，FB 显然只是将项目 A 中的所有类编译到项目 B 中。这显然不是您想要的。这些是您的链接选项（对于应用程序项目）：

*   **合并到代码**中：只有实际引用的代码才会被编译到主应用程序中。因此，如果 lib 项目中的 ClassA 从未被引用而 ClassB 被引用，则只有 ClassB 将被编译到主应用程序中。
*   **RSL**：没有任何东西被编译到主应用程序中，但是库在运行时被加载；完全，因为我们不知道我们需要哪些类。这个库虽然缓存在客户端上，所以你只需加载一次就可以有更长的加载时间。主应用程序将小于“合并”链接。

选择哪个选项取决于具体情况，完全取决于您。我建议您自己尝试看看差异（使用真实服务器，因为在本地服务器上您不会感觉到加载时间）。

我还应该提到**外部**链接选项，它不会将任何类编译到主应用程序中，也不会在运行时加载它们。这主要用于库之间的依赖关系，这些库将在同一主应用程序中用作 RSL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T07:04:32.873

您绝对应该看看使用`-link-report`flag 进行编译的作用。这会打印依赖关系图，并会向您展示为什么要使用这么多资源。

如果你不知道怎么做：有一个地方你可以在项目设置中添加编译器参数 - 通常FB在那里添加 -locale=en_US （你实际上可能不需要），添加 -link-report= report.xml 并编译。它将在项目的根目录中生成一个 xml 文件。打开它并检查。

[http://www.kahunaburger.com/2008/03/08/air-link-report-visualizer/](http://www.kahunaburger.com/2008/03/08/air-link-report-visualizer/)我没有使用这个程序，但它似乎提供了很好的依赖关系视觉表示 - 也可能有用。

# php - 在特定日期和时间范围内在 MySQL 中更新/插入随机日期的方法

> ID：10791558
> 
> 赞同：-5
> 
> 时间：2012-05-28T23:48:14.977
> 
> 标签：php, mysql, phpmyadmin

> **可能重复：**
> [如何在指定日期范围内的 SQL 中更新/插入随机日期](https://stackoverflow.com/questions/10788285/how-to-update-insert-random-dates-in-sql-within-a-specified-date-range)

我的 MySQL 数据库表具有以下列：

```
Primary_ID, Begin_Date, End_Date, Timestamp 
```

如何使用 phpmyadmin 更新选定的行，随机生成的 begin_dates 和指定日期范围内的时间戳（例如：一个月中的 30 天）。例如期望的结果

```
Primary_id--- Begin_Date -------------Timestamp

1.------------2008-09-02--------------2008-09-02 21:48:09

2.------------2008-09-03--------------2008-09-03 15:19:01

3.------------2008-09-14--------------2008-09-14 01:23:12

4.------------2008-09-27--------------2008-09-27 19:03:59 
```

日期范围在 2008-09-01 和 2008-09-31 之间。时间24小时可变

我是一个新手，所以可以在 phpmyadmin 中使用的语法会有很大帮助。

我们正在为一个有 500 名成员的健身房网站进行演示，但添加的成员值都具有相同的开始日期和时间。尝试在数据库中将它们分成不同的月度注册，例如 50 人在 8 月的不同日期和时间注册，35 人在 10 月等。

当我在这里尝试一些答案时，我收到此错误：#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '$randomDate = rand(1,31)' 附近使用正确的语法。因此，理想情况下，我可以通过最少的编辑复制并粘贴到 phpmyadmin 中的代码将不胜感激. 如果可能，按顺序排列。让一个完全虚拟的人通过尽可能接近一两次的点击来理解和执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:21:51.253

我会用一个简单的 MySQL 调用和一个基本的 PHP 脚本将它们全部取出，将它们放入一个数组中，通过“日期随机器”运行该数组，然后获取新数组并按 ID 更新数据库。十分简单。但是，如果不能做这么简单的事情，你可能不应该为健身房做“演示”。当有人不能做基础工作时，它给我们其他自由职业者一个坏名声。不想刻薄。只是说，不要咬得比你能咀嚼的多。

编辑：

天哪，你在发牢骚！我知道我会为此感到遗憾，但这里有一个更好的细分（无需为您编写）。

使用 PHP 从 MySQL 获取数据库信息：

```
$result = //result from mysql query IE. "SELECT*FROM `database`" which results in an array of information. 
```

将该数组放入“日期随机器”（在引号中，因为您创建了函数：

```
$num = mysql_num_rows($result);
for($i=0; $i<$num; ++$i)
{
    //run your "date randomizer" function for each date key
} 
```

使用从“日期随机器”获得的新数组更新您的 Mysql：

```
//run your MySQL query to UPDATE each rows date and information by ID 
```

很简单。我真的无法为你进一步分解它。

如果您的工作是编写 PHP，而您无法做到这一点，那么您需要寻找不同的工作，不管您是否爆发。你真是个刻薄的人。

# c# - 使用 oData 服务添加数据

> ID：10791560
> 
> 赞同：0
> 
> 时间：2012-05-28T23:48:28.553
> 
> 标签：c#, linq, odata

使用 OData 服务添加数据时出现错误。任何帮助表示赞赏。

**实体**（产品表在 ID 列上定义了 PK）

```
 using System;
        using System.Linq;
        using System.Data.Services.Common;
        /// <summary>
        /// Summary description for Class1.
        /// </summary>
        [DataServiceKey("Id")]
        public class Product
        {
            /// <summary>
            /// Gets or sets the Id.
            /// </summary>
            /// <value>The Id.</value>
            public int Id
            {
                get;
                set;
            }

            /// <summary>
            /// Gets or sets the Name.
            /// </summary>
            /// <value>The Name.</value>
            public string Name
            {
                get;
                set;
            }

        } 
```

**数据源 ：-**

```
 /// <summary>
        /// TODO: Provide summary section in the documentation header.
        /// </summary>
        public class ProductContext : IUpdatable
        {
            List<Product> products = new List<Product>
            {
                new Product {Id=1,Name="RedBox"},
                new Product {Id=2,Name="BlueBox"},
                new Product {Id=3,Name="BlackBox"},
            };

            public IQueryable<Product> Products
            {
                get
                {
                    return  products.AsQueryable<Product>();
                }
            }

            public object CreateResource(string containerName, string fullTypeName)
            {
                var objectType = Type.GetType(fullTypeName);
                var resource = Activator.CreateInstance(objectType);
                products.Add((Product)resource);
                return resource;
            }

     public void SaveChanges()
            {
                DataTable productsDT = new DataTable();
                foreach (var product in products)
                {
                    DataRow dataRow = productsDT.NewRow();
                    dataRow["Id"] = product.Id;
                    dataRow["Name"] = product.Name;
                    productsDT.Rows.Add(dataRow);
                }

                using (SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString()))
                {
                    using (SqlCommand command = new SqlCommand())
                    {
                        command.CommandText = "Product_Create";
                        command.CommandType = CommandType.StoredProcedure;
                        command.Parameters.Add("@ProductTable", SqlDbType.Structured);
                        command.Parameters[0].Value = productsDT;
                        command.Connection = connection;
                        connection.Open();
                        command.ExecuteNonQuery();
                    }
                }

            } 
```

**数据服务**

```
 public class ProductService : DataService<ProductContext>
        {
            List<Product> products = new List<Product>();

            // This method is called only once to initialize service-wide policies.
            public static void InitializeService(DataServiceConfiguration config)
            {
                // TODO: set rules to indicate which entity sets and service operations are visible, updatable, etc.
                // Examples:
                config.SetEntitySetAccessRule("Products", EntitySetRights.All);
                //config.SetServiceOperationAccessRule("MyServiceOperation", ServiceOperationRights.);
                config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V2;
                config.UseVerboseErrors = true;
            }

        } 
```

**客户**

```
 /// <summary>
            /// Defines the program entry point. 
            /// </summary>
            /// <param name="args">An array of <see cref="T:System.String"/> containing command line parameters.</param>
            private static void Main(string[] args)
            {
                try
                {
                    ProductContext productContext = new ProductContext(new Uri("http://localhost:24395/ProductService.svc/"));
                    productContext.AddToProducts(new Product { Id = 4, Name = "BrownBox" });
                    productContext.SaveChanges();
                    var products = from p in productContext.Products
                                   select p;

                    foreach (var p in products)
                    {
                        Console.WriteLine(p.Id.ToString() + "--" + p.Name);
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }

                Console.ReadLine();
            } 
```

**例外** - 在 SaveChanges()

```
System.Data.Services.Client.DataServiceRequestException: An error occurred while
 processing this request. ---> System.Data.Services.Client.DataServiceClientExce
ption: <?xml version="1.0" encoding="utf-8" standalone="yes"?>
<error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
  <code></code>
  <message xml:lang="en-US">An error occurred while processing this request.</me
ssage>
  <innererror>
    <message>Value cannot be null.&#xD;
Parameter name: type</message>
    <type>System.ArgumentNullException</type>
    <stacktrace>   at System.Activator.CreateInstance(Type type, Boolean nonPubl
ic)&#xD;
   at System.Activator.CreateInstance(Type type)&#xD;
   at LearningOData.ODataServices.ProductContext.CreateResource(String container
Name, String fullTypeName) in 
ta.ODataServices\ProductContext.cs:line 50&#xD; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T13:54:21.257

看起来你没有覆盖 IUpdatable 需要的 SetValue 方法（但这实际上会给你一个编译错误，所以我猜你只是没有包含它。）但是这里做了一些重要的工作来实际分配一个值您的 Id 和 Name 属性，否则添加到产品列表中的 Product 对象将包含空值。

但是，错误消息说参数名称“type”为空，所以也许您的数据库表中有一个名为“type”的列不可为空？

# ios - IPP over HTTP：收到 400 错误请求作为响应

> ID：10791563
> 
> 赞同：3
> 
> 时间：2012-05-28T23:48:37.187
> 
> 标签：ios, http, airprint, bad-request, ipp-protocol

我在 iOS 上，我正在尝试发送 HTTP POST 请求以通过充当 IPP 服务器的 Mac 在打印机上创建打印作业。我可以使用 airprint 正确打印，我现在正在尝试低级打印，因为我需要将原始数据发送到打印机。

关于我的代码的一些事情：

一切都是硬编码的。我仍在试图找出我哪里出错了，所以我只是处于开发/测试阶段。第一部分是关于 IPP 打印作业请求的二进制结构的定义（根据 RFC 2910 规范，它应该是正确的）。

```
char data[239] = {0x01, 0x01, // IPP version
    0x00, 0x04, // Print-job request
    0x00, 0x00, 0x00, 0x50, // Arbitrary request ID
    0x01, // Attribute group
    // ATT 1
    0x47, // charset value-tag
    0x00, 0x12, // name-length
    'a','t','t','r','i','b','u','t','e','s','-','c','h','a','r','s','e','t', // name
    0x00, 0x05, // value-length
    'u','t','f','-','8', // value
    // ATT 2
    0x48, // natural-language value-tag
    0x00, 0x1B, // name-length
    'a','t','t','r','i','b','u','t','e','s','-','n','a','t','u','r','a','l','-','l','a','n','g','u','a','g','e', // name                       
    0x00, 0x05, // value-length
    'e','n','-','u','s', // value
    // ATT 3
    0x45, // uri type value-tag
    0x00, 0x0B, // name-length
    'p','r','i','n','t','e','r','-','u','r','i', // name
    0x00, 0x47, // value-length
    'i','p','p',':','/','/','A','n','d','r','e','a','s','-','M','a','c','B','o','o','k','-','P','r','o','-','2','.','l','o','c','a','l','.',':','6','3','1','/','p','r','i','n','t','e','r','s','/','H','P','_','D','e','s','k','j','e','t','_','F','4','5','0','0','_','s','e','r','i','e','s', // value
    // ATT 4
    0x42, // requesting user id value-tag
    0x00, 0x14, // name-length
    'r','e','q','u','e','s','t','i','n','g','-','u','s','e','r','-','n','a','m','e', // name
    0x00, 0x05, // value-length
    'g','u','e','s','t', // value
    // ATT 5
    0x49, // document format value-tag
    0x00, 0x0f, // document format
    'd','o','c','u','m','e','n','t','-','f','o','r','m','a','t',
    0x18, // TODO
    'a','p','p','l','i','c','a','t','i','o','n','/','o','c','t','e','t','-','s','t','r','e','a','m',
    0x03, // end of attributes
    't','e','s','t'}; // data

NSMutableData *printJob = [NSMutableData data];
[printJob appendBytes:data length:sizeof(data)];
NSString* requestDataLengthString = [[NSString alloc] initWithFormat:@"%d", [printJob length]];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://192.168.1.23:631/printers/HP_Deskjet_F4500_series"]];
[request setHTTPMethod:@"POST"];
[request setValue:requestDataLengthString forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/ipp" forHTTPHeaderField:@"Content-Type"];
[request setValue:@"Andreas-MacBook-Pro-2.local" forHTTPHeaderField:@"Host"];
[request setValue:@"CUPS/1.5.0" forHTTPHeaderField:@"User-Agent"];
[request setValue:@"100-continue" forHTTPHeaderField:@"Expect"];
[request setHTTPBody:printJob];

[[NSURLConnection connectionWithRequest:request delegate:self] start]; 
```

每当我运行此代码时，10 秒后我都会收到 HTTP 400 错误请求响应。

奇怪的是，每当 airprint 打印向 ipp 服务器发送打印作业时，HTTP 请求似乎与我可以使用数据包分析器捕获的请求完全相同（并且它可以工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-28T23:05:37.270

您必须为**Print-Job**使用正确的 ipp 操作代码：

*   不正确：`0x00, 0x04, // =Validate-job request`
*   正确的 ：`0x00, 0x02, // Print-job request`

您应该使用文档格式`text/plain`而不是`octet-stream`. 还要确保打印机支持数据格式或至少确保 CUPS 配置了适当的转换器（看起来您通过 CUPS 与 HP 打印机交谈）。

不用担心`user-agent`，没关系。相反，请注意您的 http-protocol-handling！通过发送`Expect: 100-continue`您使 CUPS 期望分块 http。不要发送`Expect-Header`，一切都应该没问题。

确保正确计算 ipp-request 加上数据长度的长度并将其放入 content-length-header。

注意：我已经[在 Kotlin 中实现了一个打印请求](https://github.com/gmuth/ipp-printjob-kotlin)。[如果您找到DataInputStream](https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html)、[DataOutputStream](https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html)的替代品并且知道如何发布 http 请求，则应该可以移植到 Objective-C 或 Swift 。我很乐意为您提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-08T15:43:10.293

以下为我打印。我的打印机在端口 80 和 631 上接受 IPP。

```
// See Print-Job Request sample on page 32 
//   in Appendix A: Protocol Examples 
//   of RFC 2910 IPP/1.1 Encoding and Transport
//     https://tools.ietf.org/html/rfc2910

    char data[239] = {0x01, 0x01, // IPP version
    0x00, 0x02, // Print-job request
    0x00, 0x00, 0x00, 0x50, // Arbitrary request ID
    0x01, // Attribute group
    // ATT 1
    0x47, // charset value-tag
    0x00, 0x12, // name-length
    'a','t','t','r','i','b','u','t','e','s','-','c','h','a','r','s','e','t', // name
    0x00, 0x05, // value-length
    'u','t','f','-','8', // value
    // ATT 2
    0x48, // natural-language value-tag
    0x00, 0x1B, // name-length
    'a','t','t','r','i','b','u','t','e','s','-','n','a','t','u','r','a','l','-','l','a','n','g','u','a','g','e', // name
    0x00, 0x02, // value-length
    'e','n', // value
    // ATT 3
    0x45, // uri type value-tag
    0x00, 0x0B, // name-length
    'p','r','i','n','t','e','r','-','u','r','i', // name
    0x00, 0x1A, // value-length
    'i','p','p',':','/','/','1','7','2','.','0','2','0','.','0','1','0','.','0','0','8',':','0','8','0','/', // value
    // ATT 4
    0x42, // requesting user id value-tag
    0x00, 0x14, // name-length
    'r','e','q','u','e','s','t','i','n','g','-','u','s','e','r','-','n','a','m','e', // name
    0x00, 0x09, // value-length
    'a','s','s','o','c','i','a','t','e', // value
    // ATT 5
    0x49, // document format value-tag
    0x00, 0x0f, // document format
    'd','o','c','u','m','e','n','t','-','f','o','r','m','a','t',
    0x00, 0x0f, // value-length
    'a','p','p','l','i','c','a','t','i','o','n','/','p','d','f',
    0x02, // start job-attributes tag
    0x21, // integer type value-tag
    0x00, 0x06, // name-length
    'c','o','p','i','e','s',
    0x00, 0x04, // value-length
    0x00, 0x00, 0x00, 0x01, // 1 copy
    // could add 'sides' with 'two-sided-long-edge' for double sided prints (see RFC)
    0x03 // end of attributes
    }; // follow with pdf file data

NSMutableData *printJob = [NSMutableData dataWithBytes:data length:sizeof(data)];

NSString *pdfFilePath = [[NSBundle mainBundle] pathForResource:@"sample" ofType:@"pdf"];
NSData* pdfData = [NSData dataWithContentsOfFile:pdfFilePath options:NSDataReadingUncached error:NULL];

[printJob appendData:pdfData];

NSString* requestDataLengthString = [[NSString alloc] initWithFormat:@"%ld", [printJob length]];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://172.020.010.008:080/"]];
[request setHTTPMethod:@"POST"];
[request setValue:requestDataLengthString forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/ipp" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:printJob];

NSError *error;
NSURLResponse *response;
NSData *responseData = [NSURLConnection sendSynchronousRequest:request
                                             returningResponse:&response
                                                         error:&error]; 
```

如果您需要帮助查看任何 IPP 调用格式的工作示例，我建议您使用 ipptool 生成请求并将其捕获到文件中。我无法让 Burp 代理拦截它（即使使用 http_proxy 环境变量），但这个节点脚本成功了：

```
const http = require('http');
const fs = require('fs');

http.createServer(function (req, res) {

    console.log('Request Received');

    var body = '';

    res.writeHead(200, {
        'Context-Type': 'text/plain',
        'Access-Control-Allow-Origin': '*'
    });

    req.on('data', function (chunk) {
        body += chunk;
    });

    req.on('end', function() {
        fs.writeFileSync('file.txt', body, 'utf8');
        res.end('{"msg": "OK"}');
    })

}).listen(8080, '127.0.0.1'); 
console.log('Server running at http://127.0.0.1:8080/') 
```

然后你可以调用你的节点服务器：

```
ipptool -vt -f sample.pdf ipp://127.0.0.1:8080/ print-job.test 
```

并检查请求：

```
hexdump -C -n256 file.txt 
```

# wpf - 如何围绕 WPF 中的特定点旋转、平移和缩放控件对象

> ID：10791564
> 
> 赞同：6
> 
> 时间：2012-05-28T23:48:45.677
> 
> 标签：wpf, rotation, transform, scaletransform

我有一个自定义构建的控件，它是一个矩形，里面有一些细节，但它是一个矩形。

我有一个中心点 (X,Y)，我称之为“重心”，它“代表”该点。这意味着当我为对象设置新位置时，我希望该点位于设置位置。当我旋转对象时，我需要它围绕这个点旋转。并且当我缩放对象时，该点必须保持在之前设置的位置。只有对象的大小必须改变。

例如，为了简单地了解问题，假设我有一个 10X10 的正方形。我将重心设置在正方形的确切中心：（5,5）。然后我将对象位置设置为 (100, 100)。然后，广场将在：

(95,95), (105,95), (105,105), (95,105)，这意味着它的中心将在所需的位置。

如果我用值 2 缩放正方形，新的 4 点位置将是：

(90,90), (110,90), (110,110), (90,110)，这意味着它的中心将保持在所需的位置。

如果我将它旋转 45 度，它将围绕其中心旋转，位置为：

(92.93,92.93),(107.07,92.93),(107.07,107.07),(92.93,107.07)

怎么可能做到这一点，它的中心是完全可配置的，并且所有这些转换对于 WPF 中的程序都是透明的？我只想设置比例、位置、旋转角度和中心以使其正确绘制。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T00:06:54.623

您可以相对于对象的大小设置变换的中心点。如果要围绕对象的左上角旋转，则值为`0, 0`。要围绕右下角 10% 的位置旋转，您可以使用`1.1, 1.1`.

`RenderTransformOrigin`为 RotationTranforms调用该属性。在 Blend 中，属性中有一个“变换”组。如果展开它，RenderTransform 有一组选项卡。第五个是中心点。

这是一些示例 XAML：

```
<TextBlock Text="TextBlock" RenderTransformOrigin="-0.5,-0.5" Background="#FFA1BBF9" Margin="50" Width="100" Height="100">
    <TextBlock.RenderTransform>
        <TransformGroup>
            <ScaleTransform ScaleX="2"/>
            <SkewTransform/>
            <RotateTransform Angle="30"/>
            <TranslateTransform/>
         </TransformGroup>
     </TextBlock.RenderTransform>
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-09T16:43:04.100

## ** 旋转原点上的任何控件**

```
// rotated object
      Rectangle r = new Rectangle();
                r.Fill = Brushes.Blue;
                r.Stroke = Brushes.Yellow;
                r.Width = 200;
                r.Height = 100;      

//rotate transform
 RotateTransform rt = new RotateTransform();

            r.RenderTransform = rt;

            //origin for object
            r.RenderTransformOrigin = new Point(.5,.5);

            DoubleAnimation anim3 = new DoubleAnimation(0, 360, TimeSpan.FromSeconds(.5));
            anim3.RepeatBehavior = RepeatBehavior.Forever;
           rt.BeginAnimation(RotateTransform.AngleProperty, anim3);
  grid1.Children.Add(r); 
```

# ruby - Ruby：不要与数组元素进行某些组合

> ID：10791565
> 
> 赞同：1
> 
> 时间：2012-05-28T23:48:48.413
> 
> 标签：ruby, arrays, combinations, ruby-1.9.3

我有一个组合列表：

```
('a'..'z').to_a.combination(3) 
```

但我想生成一个具有相同起始集的新列表`('a'..'z')`：

```
('a'..'z').to_a.combination(5) 
```

有没有办法让 ruby`combination(3)`​​ 在新的集合中使用旧的集合`combination(5)`，这样可以节省一些时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:06:50.913

我不知道是否有或没有任何简单的方法可以重用已经生成的选项，但不要忘记再添加两个“位置”[会大大增加组合的数量（Wolfram Alpha）](http://www.wolframalpha.com/input/?i=nCr%5b26%2C5%5d%2C+nCr%5b26%2C3%5d) ——有案例中的组合`5`比案例多 25 倍`3`。

到目前为止，无论您对数据*做*什么，处理时间都将增加 25 倍，这将超过 Ruby 为您准备组合所花费的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T23:56:19.617

有，但我怀疑你会节省很多时间，除非你在 Rubinius 或其他一些非本地实现上运行。在参考实现中，`Array#combination`它是用紧密的 C 语言编写的，我非常怀疑为了重用这些结果而需要做的附加、循环和差异处理会比原生`combination`使用的要少。

# asp.net - 为什么我的 .resx 文件会产生空输出？

> ID：10791567
> 
> 赞同：0
> 
> 时间：2012-05-28T23:49:06.230
> 
> 标签：asp.net, resources

我正在创建一个 ASP.NET MVC 3.0 应用程序。然后，当我创建 a 时`Foo.resx`，它成功生成了预期的`.cs`输出。但是当我创建类似的东西时，`Foo.en.resx`它只会输出一个空`.cs`文件。即使我主动按下`Run Custom Tool`上下文菜单。

任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T05:11:19.167

我也遇到过这个问题。似乎（我在 MSDN 上的某个地方读到了这个，但找不到链接）只有 Invariant resx (Foo.resx) 才需要代码。事实上，根据我的经验，为每个本地化的 .resx 拥有一个 .cs 文件实际上会破坏应用程序。

**编辑**这是有帮助的吗？[资源 (RESX) 文件搞砸了](https://stackoverflow.com/questions/3343813/resource-resx-files-messed-up)

# java - 计算数组列表的平均值？

> ID：10791568
> 
> 赞同：64
> 
> 时间：2012-05-28T23:49:14.117
> 
> 标签：java, arrays, average

我正在尝试使用下面的代码来计算用户输入的一组值的平均值并将其显示在 a 中，`jTextArea`但它不能正常工作。比如说，用户输入 7、4 和 5，程序在应该显示 5.3 时显示 1 作为平均值

```
 ArrayList <Integer> marks = new ArrayList();
  Collections.addAll(marks, (Integer.parseInt(markInput.getText())));

  private void analyzeButtonActionPerformed(java.awt.event.ActionEvent evt) {
      analyzeTextArea.setText("Class average:" + calculateAverage(marks));
  }

  private int calculateAverage(List <Integer> marks) {
      int sum = 0;
      for (int i=0; i< marks.size(); i++) {
            sum += i;
      }
      return sum / marks.size();
  } 
```

代码有什么问题？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2015-06-24T08:46:32.117

使用 Java 8 会[更容易一些](http://www.leveluplunch.com/java/examples/calculate-average-of-list/)：

```
OptionalDouble average = marks
            .stream()
            .mapToDouble(a -> a)
            .average(); 
```

因此你的平均值是 average.getAsDouble()

```
return average.isPresent() ? average.getAsDouble() : 0; 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-05-28T23:54:19.097

当您拥有增强的 for 循环时，为什么要使用带有索引的笨拙 for 循环？

```
private double calculateAverage(List <Integer> marks) {
  Integer sum = 0;
  if(!marks.isEmpty()) {
    for (Integer mark : marks) {
        sum += mark;
    }
    return sum.doubleValue() / marks.size();
  }
  return sum;
} 
```

**更新**：正如其他几个人已经指出的那样，使用带有 Java 8 及更高版本的 Streams 变得更加简单：

```
private double calculateAverage(List <Integer> marks) {
    return marks.stream()
                .mapToDouble(d -> d)
                .average()
                .orElse(0.0)
} 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-08-21T07:47:16.190

从**Java8 开始**，您可以从 List 中获取平均值，如下所示：

```
 List<Integer> intList = Arrays.asList(1,2,2,3,1,5);

    Double average = intList.stream().mapToInt(val -> val).average().orElse(0.0); 
```

这具有没有移动部件的优点。通过更改 map 方法调用，它可以很容易地适应与其他类型对象的列表一起使用。

例如双打：

```
 List<Double> dblList = Arrays.asList(1.1,2.1,2.2,3.1,1.5,5.3);
    Double average = dblList.stream().mapToDouble(val -> val).average().orElse(0.0); 
```

注意。mapToDouble 是必需的，因为它返回具有`average`方法的 DoubleStream，而 using`map`则没有。

或 BigDecimals：

```
@Test
public void bigDecimalListAveragedCorrectly() {
    List<BigDecimal> bdList = Arrays.asList(valueOf(1.1),valueOf(2.1),valueOf(2.2),valueOf(3.1),valueOf(1.5),valueOf(5.3));
    Double average = bdList.stream().mapToDouble(BigDecimal::doubleValue).average().orElse(0.0);
    assertEquals(2.55, average, 0.000001);
} 
```

using`orElse(0.0)`消除了从`average`“不存在”返回的 Optional 对象的问题。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-05-28T23:50:49.013

对总和使用双精度数，否则您将进行整数除法并且不会得到任何小数：

```
private double calculateAverage(List <Integer> marks) {
    if (marks == null || marks.isEmpty()) {
        return 0;
    }

    double sum = 0;
    for (Integer mark : marks) {
        sum += mark;
    }

    return sum / marks.size();
} 
```

或使用 Java 8 流 API：

```
 return marks.stream().mapToInt(i -> i).average().orElse(0); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-05-28T23:50:40.330

```
sum += i; 
```

您正在添加索引；您应该在以下位置添加实际项目`ArrayList`：

```
sum += marks.get(i); 
```

此外，为确保返回值不会被截断，请强制一个操作数`double`并将您的方法签名更改为`double`：

```
return (double)sum / marks.size(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-20T15:39:04.413

使用[Guava](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/math/Stats.html#meanOf-int...-)，它在语法上得到了简化：

```
Stats.meanOf(numericList); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-26T01:20:05.617

当**数字**不大时，一切似乎都恰到好处。但如果不是，则需要非常小心才能实现**正确性**。

以**双打**为例：

如果它不大，就像其他人提到的那样，您可以简单地尝试一下：

```
doubles.stream().mapToDouble(d -> d).average().orElse(0.0); 
```

但是，如果它超出您的控制并且非常大，您必须按如下方式转向**BigDecimal （使用 BigDecimal 的****旧答案**中的方法实际上是**错误**的）。

```
doubles.stream().map(BigDecimal::valueOf).reduce(BigDecimal.ZERO, BigDecimal::add)
       .divide(BigDecimal.valueOf(doubles.size())).doubleValue(); 
```

附上我进行的**测试以证明我的观点：**

```
 @Test
    public void testAvgDouble() {
        assertEquals(5.0, getAvgBasic(Stream.of(2.0, 4.0, 6.0, 8.0)), 1E-5);
        List<Double> doubleList = new ArrayList<>(Arrays.asList(Math.pow(10, 308), Math.pow(10, 308), Math.pow(10, 308), Math.pow(10, 308)));
        // Double.MAX_VALUE = 1.7976931348623157e+308
        BigDecimal doubleSum = BigDecimal.ZERO;
        for (Double d : doubleList) {
            doubleSum =  doubleSum.add(new BigDecimal(d.toString()));
        }
        out.println(doubleSum.divide(valueOf(doubleList.size())).doubleValue());
        out.println(getAvgUsingRealBigDecimal(doubleList.stream()));
        out.println(getAvgBasic(doubleList.stream()));
        out.println(getAvgUsingFakeBigDecimal(doubleList.stream()));
    }

    private double getAvgBasic(Stream<Double> doubleStream) {
        return doubleStream.mapToDouble(d -> d).average().orElse(0.0);
    }

    private double getAvgUsingFakeBigDecimal(Stream<Double> doubleStream) {
        return doubleStream.map(BigDecimal::valueOf)
                .collect(Collectors.averagingDouble(BigDecimal::doubleValue));
    }

    private double getAvgUsingRealBigDecimal(Stream<Double> doubleStream) {
        List<Double> doubles = doubleStream.collect(Collectors.toList());
        return doubles.stream().map(BigDecimal::valueOf).reduce(BigDecimal.ZERO, BigDecimal::add)
                .divide(valueOf(doubles.size()), BigDecimal.ROUND_DOWN).doubleValue();
    } 
```

至于`Integer`or `Long`，相应地你可以`BigInteger`类似地使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-23T17:14:06.250

```
List.stream().mapToDouble(a->a).average() 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-08-04T20:05:24.107

您可以使用标准循环结构或迭代器/列表迭代器：

```
List<Integer> list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8);
double sum = 0;
Iterator<Integer> iter1 = list.iterator();
while (iter1.hasNext()) {
    sum += iter1.next();
}
double average = sum / list.size();
System.out.println("Average = " + average); 
```

如果使用 Java 8，您可以使用 Stream 或 IntSream 操作：

```
OptionalDouble avg = list.stream().mapToInt(Integer::intValue).average();
System.out.println("Average = " + avg.getAsDouble()); 
```

参考：[计算arraylist的平均值](http://www.topjavatutorial.com/java/calculating-sum-average-arraylist-integers/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-14T04:59:06.750

正确和快速的方法计算平均值`List<Integer>`：

```
private double calculateAverage(List<Integer> marks) {
    long sum = 0;
    for (Integer mark : marks) {
        sum += mark;
    }
    return marks.isEmpty()? 0: 1.0*sum/marks.size();
} 
```

该解决方案考虑到：

*   处理溢出
*   不要像 Java8 流那样分配内存
*   不要使用缓慢的 BigDecimal

它适用于 List，因为任何列表包含少于 2^31 个 int，并且可以使用 long 作为累加器。

附言

实际上 foreach 分配内存 - 您应该在关键任务部分使用旧式 for() 循环

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-09T09:37:21.930

这是一个使用`BigDecimal`而不是的版本`double`：

```
public static BigDecimal calculateAverage(final List<Integer> values) {
    int sum = 0;
    if (!values.isEmpty()) {
        for (final Integer v : values) {
            sum += v;
        }
        return new BigDecimal(sum).divide(new BigDecimal(values.size()), 2, RoundingMode.HALF_UP);
    }
    return BigDecimal.ZERO;
} 
```

# zend-framework - 通过 Puppet 安装 Zend Server CE

> ID：10791575
> 
> 赞同：1
> 
> 时间：2012-05-28T23:50:34.880
> 
> 标签：zend-framework, puppet

我需要通过 puppet 在我的 debian 堆栈上安装带有 PHP 5.2 的 Zend Server CE。任何人都可以帮助清单应该是什么样子。安装说明可在此处获得[http://files.zend.com/help/Zend-Server/zend-server.htm#deb_installation.htm](http://files.zend.com/help/Zend-Server/zend-server.htm#deb_installation.htm)

谢谢。雅罗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:49:09.393

我创建了一个木偶“模块”。它在此处可用[https://github.com/NoStressCommerceCZ/virtualdev/tree/master/basic-box/puppet/modules/zendserverce](https://github.com/NoStressCommerceCZ/virtualdev/tree/master/basic-box/puppet/modules/zendserverce)并安装 zend server ce 5.2 并允许您创建虚拟主机。

**更新**： [https ://github.com/NoStressCommerceCZ/virtualdev-module-puppet-zendserverce](https://github.com/NoStressCommerceCZ/virtualdev-module-puppet-zendserverce)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T11:05:42.190

TrafeX 在 GitHub 上的Puppet 模块[puppet-zendserver](https://github.com/TrafeX/puppet-zendserver)。

# python - 从 python 中获取容器/父对象

> ID：10791588
> 
> 赞同：31
> 
> 时间：2012-05-28T23:52:05.650
> 
> 标签：python, class, object, containers

在 Python 中，是否可以从 Bar 自身中获取包含另一个对象 Bar 的对象，比如 Foo？这是我的意思的一个例子

```
class Foo(object):
    def __init__(self):
        self.bar = Bar()
        self.text = "Hello World"

class Bar(object):
    def __init__(self):
        self.newText = foo.text #This is what I want to do, 
                                #access the properties of the container object

foo = Foo() 
```

这可能吗？谢谢！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-28T23:56:42.917

传递对 Bar 对象的引用，如下所示：

```
class Foo(object):
    def __init__(self):
        self.text = "Hello World"  # has to be created first, so Bar.__init__ can reference it
        self.bar = Bar(self)

class Bar(object):
    def __init__(self, parent):
        self.parent = parent
        self.newText = parent.text

foo = Foo() 
```

**编辑：**正如@thomleo 所指出的，这可能会导致垃圾收集出现问题。[建议的解决方案在http://eli.thegreenplace.net/2009/06/12/safely-using-destructors-in-python/](http://eli.thegreenplace.net/2009/06/12/safely-using-destructors-in-python/)中列出，看起来像

```
import weakref

class Foo(object):
    def __init__(self):
        self.text = "Hello World"
        self.bar = Bar(self)

class Bar(object):
    def __init__(self, parent):
        self.parent = weakref.ref(parent)    # <= garbage-collector safe!
        self.newText = parent.text

foo = Foo() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T00:00:08.583

> 是否有可能从 Bar 本身中获取包含另一个对象 Bar 的对象，比如 Foo？

不是“自动”，因为语言不是那样构建的，特别是语言的构建使得无法保证 Foo 存在。

也就是说，你总是可以明确地做到这一点。属性，就像 Python 中的所有其他标识符一样，只是名称，而不是数据的存储空间；所以没有什么能阻止您让 Bar 实例具有手动分配的`foo`属性，即 Foo 实例，反之亦然。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-09T11:05:35.313

是的，这是可能的。即使没有在对象创建时传递容器引用，即如果您的对象是类属性。您的对象需要实现描述符协议（有一个`__get__()`）：

```
class ChildName(SimpleNamespace):                                                         

    def __get__(self, instance, owner):
        # instance is our parent
        return f'I am {self.name}, my parent is {instance.name}.'

class ChildDiff(SimpleNamespace):

    @property
    def diff(self):
        return self.born - self.parent.born

    def age_diff(self):
        return f'I am {self.diff} years older than {self.parent.name}.'

    def __get__(self, instance, owner):
        self.parent = instance  # XXX: weakref?
        return self  # expose object to be able call age_diff() etc.

class Parent(SimpleNamespace):

    child_name = ChildName(name='Bar')
    child_diff = ChildDiff(born=42)

parent = Parent(name='Foo', born=23)
print(parent.child_name)             # ... I am Bar, my parent is Foo.
print(parent.child_diff.age_diff())  # ... I am 19 years older than Foo. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-18T02:48:30.300

这对我有用：

**父母**：

```
import child

obj_1  = 25             # an object that both parent and child can access

def startup():          # any startup function
    global obj_1
    child.ref( obj_1 )  # send the shared object to the child
    ... 
```

**孩子**：

```
obj_1 = 0               # initual value will be overwritten

def ref(shared_obj):    # receive a reference to the shared object
    global  obj_1       # shared object is global in the child, optional
    obj_1 = shared_obj  # set obj_1 in the child to be obj_1 in the parent 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-29T00:35:18.063

如何使用继承：

```
class Bar(object):
    def __init__(self):
        self.newText = self.text

class Foo(Bar):
    def __init__(self):
        self.txt = 'Hello World'
        Bar.__init__(self)

foo = Foo()
print foo.newText 
```

# datagrid - 允许创建新记录和更新现有记录的稀疏网格视图

> ID：10791589
> 
> 赞同：1
> 
> 时间：2012-05-28T23:52:12.860
> 
> 标签：datagrid, ruby-on-rails-3.1, best-in-place

我正在尝试在 RoR 中创建一个简单的道场考勤应用程序，目前在我知道我能做什么和我想做的事情之间陷入困境，至少在显示、创建和更新考勤记录方面. （应用程序的其余部分对我来说似乎很简单。）

这是相关表的架构：

```
create_table "attendances", :force => true do |t|
  t.date     "class_date"
  t.integer  "student_id"
  t.datetime "created_at"
  t.datetime "updated_at"
  t.integer  "class_hours", :default => 0
end 
```

我知道我可以为此利用基本的脚手架视图，但这样做会很乏味，即新的出勤记录，选择日期，学生和花费的时间，保存，返回索引视图（修改为仅限于特定月份） . 单条记录的创建需要多次点击。本身并不可怕，但我可以看到每个新条目都会变得乏味。也就是说，如果系统用户意识到为该学生输入了错误的小时数，那么这种方法的更新将非常简单。如果需要，完全删除记录非常简单。

我可以看到自己增强了上述内容：

*   索引视图列出了给定月份的所有学生，无论他们是否上课
*   可能使学生的姓名成为新出勤页面的链接（如上所述）
*   如果学生在该日期有该月的条目，则网格中的该单元格将是指向该记录的“编辑出勤”页面的链接
*   我想我可以在编辑出勤页面的底部添加一个删除链接

我真正想要的是提供以下内容的视图：

*   月份一览网格（视图顶部的月份名称，最好使用 jQuery 的日期选择器）
*   网格的第一列列出了所有学生
*   每列的标题（在第一列之后）一个月的天数，从 1 到 N（一个月的最后一天）
*   如果学生在特定日期存在出勤记录，则在单元格中显示小时数
*   如果学生在特定日期不存在出勤记录，则不显示任何内容（或显示“-”或类似的占位符）

我转来转去试图弄清楚这一点。如果网格对每个单元格都有值（即，每个学生都有一个显示该月每一天的记录），那么我可以使用[best_in_place](https://github.com/bernat/best_in_place)来解决这个问题。做完了。但是以这种方式使表格膨胀似乎是对表格的非常低效的使用，尤其是当您考虑到 a) 学生可能会永远留在名册上，除非他们做了如此令人震惊的事情以至于被禁止从道场，b) 没有人参加所有可用的课程，c) 很少有学生参加大多数可用的课程。我考虑尝试让它与 best_in_class_if 一起使用，但它仍然需要记录存在才能显示它。啊。

我最近才知道 find_or_create_by ，它短暂地给了我希望，作为克服这个问题的一种方式。然后，我了解到了这种创建[create_or_update_by](https://stackoverflow.com/a/5580108/1422416)的方法，这给了我另一种希望，作为克服这个问题的一种方式，但仍然有一些问题困扰着我，如何接近它来实现它。即，我必须在网格（html 表）中创建某种对不存在的记录的引用，这似乎无法实现。（我在从 rails 控制台测试 create_or_update_by 时也遇到了问题，`LocalJumpError: no block given (yield)`但我无法确定原因。）

如果我不清楚我试图通过每月一目了然的出勤视图获得的外观和感觉，请将其视为 Excel 电子表格：学生在左列下方，天数-顶部的月份，如果单元格为空，则可以向其中添加值，如果单元格有值，则可以更改。（蓝天：如果class_hours值设置为零，则删除记录。）

我试图在 Routes 文档和 Controllers 文档中找到灵感。没有喜悦。

只要考虑以下几点，我很乐意考虑替代 RoR 解决方案，因为我意识到我可能完全错过了一种更明显/优雅的方法：

*   出勤月一览视图（使用我已经成功利用的[DataTables](http://www.datatables.net/)）列出了系统中的所有学生，无论他们当月是否上课
*   添加/更新学生出勤率的简单方法，理想情况下，点击次数少于基本脚手架视图

干杯。

编辑：进一步考虑，似乎一种合理的方法是使数据网格中尚未在出勤表中具有表示的单元格成为一个链接，该链接将参数 student_id、class_date 和 class_hours 传递给 /出席/新路线（从脚手架修改以接受和使用参数），同样用于单击已经具有值的单元格。（我仍然可以考虑为后者使用 best_in_place，但为了用户界面的一致性，也许我应该避免这种情况。）

如果我错过了以更好的方式解决这个问题的黄金机会，我仍然很乐意接受有见地的建议。

# haskell - 如何使用 widgetFile 在另一个中包含一个 hamletfile？

> ID：10791591
> 
> 赞同：4
> 
> 时间：2012-05-28T23:52:23.770
> 
> 标签：haskell, yesod

为了可重用性，我想在另一个小部件中重用。例如，小部件文件`blogpost.hamlet`可以包含帖子的显示方式，并且`blog.hamlet`可以包含完整的博客。

以下*内容*`blog.hamlet`不起作用：

 *```
$forall post <- posts
    ^{widgetFile "blogpost") 
```

那么，将一个小部件嵌入另一个小部件的正确语法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-29T01:34:05.527

Hamlet 语法不支持在其中嵌入 Template Haskell 拼接，这使得您正在寻找的代码无法实现。相反，您需要在 Haskell 中创建一个辅助函数，例如：

```
blogpost post = $(widgetFile "blogpost") 
```

然后在 blog.hamlet 中，您可以拥有：

```
$forall post <- posts
    ^{blogpost post} 
```*

# c# - 从 OleDbDataReader 中的 MS ACCESS 读取具有特殊名称的属性

> ID：10791594
> 
> 赞同：0
> 
> 时间：2012-05-28T23:52:59.210
> 
> 标签：c#, ms-access, oledbdatareader

当 accdb 数据库的字段名称带有“-”、“%”、“/”等字符或字段名称为“Level”时，我在从 accdb 数据库读取时遇到了一些问题。当我有这样的事情时：

```
string mySelectQuery = "SELECT 'Part_Time_%','Level',Level_change_reason FROM Employees";
OleDbConnection myConnection = new OleDbConnection(oledbConnectString);
OleDbCommand myCommand = new OleDbCommand(mySelectQuery,myConnection);
myConnection.Open();
OleDbDataReader myReader = myCommand.ExecuteReader(); 
```

它运作良好，因为 '' 字符取消了特殊字符和单词meening。还行吧：

```
if ((myReader["Name"] == DBNull.Value) ....
if ((myReader["Surname"] == DBNull.Value) .... 
```

但是当我尝试这个时：

```
if ((myReader["Macro-activity"] == DBNull.Value) ...
if ((myReader["Level"] == DBNull.Value).... 
```

它跳转到 catch 语句。我也试过`myReader["\u004cevel"], myReader["'Macro-activity'"]`- 它完全忽略了转义字符。

每个答案将不胜感激。

PS：我不能更改属性的名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:04:32.833

Access 中的列名转义使用大括号 , `[ & ]`，而不是单引号。

```
string mySelectQuery = "SELECT '[Part_Time_%],[Level],Level_change_reason FROM Employees"; 
```

单引号用于字符串，因此在 select 语句中使用 'Level' 会将文本 'Level' 作为结果集中的未命名列返回。如果您尝试`myReader.GetItem(1)`，它将返回`"Level"`每一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T08:24:26.580

我找到了这个，它做了我想要的：

```
if ((myReader.GetValue(18) == DBNull.Value) || string.Compare(myReader.GetValue(18).ToString(), "0") == 0).... 
```

# java - OpenSSO 发生了什么？

> ID：10791595
> 
> 赞同：-5
> 
> 时间：2012-05-28T23:53:18.667
> 
> 标签：java, opensso

许多 JBoss 和 Sun/Oracle 文档都引用了 OpenSSO，但该项目似乎已经消失了。甚至[Wikipedia OpenSSO](http://en.wikipedia.org/wiki/OpenSSO)页面也链接到死主页。该项目发生了什么？它是否已被重命名或合并到另一个项目中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:02:21.800

[http://www.forgerock.com/openam.html](http://www.forgerock.com/openam.html)

# xcode - 如何在 Xcode Profiling and Archiving Builds 中设置 DEBUG 和 NDEBUG 宏？

> ID：10791601
> 
> 赞同：2
> 
> 时间：2012-05-28T23:54:33.550
> 
> 标签：xcode, configuration, build, profiling, archiving

在 Xcode（当前版本 4.3.2）中，我为调试和发布版本设置了 DEBUG 和 NDEBUG 宏定义，因此我可以有选择地使用 ObjC 预处理器包含调试代码。

问题：当我选择 Product --> Build For --> Archiving 时，既没有定义 DEBUG 也没有定义 NDEBUG。我对 Product --> Build For --> Profiling 有类似的问题。

问题：如何在 xcode 中为存档和分析构建正确设置 DEBUG 和 NDEBUG，这样我的条件代码包含（预处理器）宏不会中断？

我目前在发送到 AppStore 之前存档构建的解决方法是暂时删除 DEBUG 代码；但这不是一个好习惯，即使我受到 git 的源版本控制系统的保护。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T05:53:05.360

尝试将您的定义添加到

```
"Preprocessor Macros Not Used in Precompiled Headers" 
```

反而

```
"Preprocessor Macros" 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-04-14T21:33:02.763

检查构建设置以确保在调试和发布模式下都定义了宏。

例如：
- 对于调试模式：NDEBUG=0 和 DEBUG=1
- 对于发布模式：NDEBUG=1 和 DEBUG=0

# ios - 从 AVAudioRecorder 获取片段

> ID：10791608
> 
> 赞同：0
> 
> 时间：2012-05-28T23:55:52.813
> 
> 标签：ios, ios5, avaudiorecorder

你好，我是 iOS 的新手，我有一个特殊的任务，首先我用 AVAudioRecorder 录制声音，我可以毫无困难地录制和播放它，但我需要在记录中获取数据，这是我的功能：

```
@interface recordViewController : UIViewController <AVAudioRecorderDelegate, AVAudioPlayerDelegate>
{
    AVAudioRecorder *audioRecorder;
    AVAudioPlayer *audioPlayer;
    UIButton *playButton;
    UIButton *recordButton;
    UIButton *stopButton;
} 
```

记录：

```
 -(void) recordAudio {
     if (!audioRecorder.recording)
     {
         playButton.enabled = NO;
         stopButton.enabled = YES;
         [audioRecorder record];
     }
} 
```

玩：

```
-(void) playAudio {
    if (!audioRecorder.recording)
    {
        stopButton.enabled = YES;
        recordButton.enabled = NO;

        NSError *error;

        audioPlayer = [[AVAudioPlayer alloc] 
                       initWithContentsOfURL:audioRecorder.url
                       error:&error];

        audioPlayer.delegate = self;

        if (error)
            NSLog(@"Error: %@", [error localizedDescription]);
        else
            [audioPlayer play];
    } 
} 
```

我怎样才能在记录中获取数据？我在 iOS Developer API 中搜索，但我找不到任何东西，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T04:31:06.097

我还没有尝试过这个解决方案。但这可能会有所帮助。试试看。

录制音频：

```
itsVoiceRecordedURL = [NSURL fileURLWithPath:[NSString stringWithFormat:<Path of the recorded file to be stored>]];
    NSMutableDictionary* recordSetting = [[NSMutableDictionary alloc] init];
    [recordSetting setValue :[NSNumber numberWithInt:kAudioFormatAppleIMA4] forKey:AVFormatIDKey];
    [recordSetting setValue:[NSNumber numberWithFloat:44100.0] forKey:AVSampleRateKey]; 
    [recordSetting setValue:[NSNumber numberWithInt: 2] forKey:AVNumberOfChannelsKey];

    itsAudioRecorder = [[ AVAudioRecorder alloc] initWithURL:itsVoiceRecordedURL settings:recordSetting error:&error];
    [recordSetting release];
    [itsAudioRecorder setDelegate:self];
    //We call this to start the recording process and initialize 
    //the subsstems so that when we actually say "record" it starts right away.
    [itsAudioRecorder prepareToRecord];
    //Start the actual Recording
    [itsAudioRecorder record]; 
```

将录制的音频文件转换为字节数组

```
NSData *data = [NSData dataWithContentsOfFile:AudioFilePath];
NSUInteger len = [data length];
Byte *byteData = (Byte*)malloc(len); 
```

# javascript - Javascript/HTML5 使用图像填充画布

> ID：10791610
> 
> 赞同：8
> 
> 时间：2012-05-28T23:56:14.283
> 
> 标签：javascript, html, canvas

我正在尝试获取图像来填满我的画布。这是我正在尝试的代码：

```
var blueprint_background = new Image();
blueprint_background.src = 'images/blueprint_background.png'; 
var pattern = context.createPattern(blueprint_background, "repeat");

context.fillStyle = pattern;
context.fill(); 
```

问题是什么都没有出现。我能够做基本的 context.fillRect(..) 示例，但这给我带来了麻烦。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T00:07:55.477

您必须等到图像加载后，使用图像的 onload 属性才能知道它何时加载。

```
var blueprint_background = new Image();
blueprint_background.src = 'images/blueprint_background.png'; 
blueprint_background.onload = function(){
    var pattern = context.createPattern(this, "repeat");
    context.fillStyle = pattern;
    context.fill();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-04T20:59:19.130

# 请注意是否有人想从 Worker 中的图像创建模式。

内部工人类图像未定义！

```
ReferenceError: Image is not defined 
```

在这种情况下，我们可以执行以下操作：

```
const result = await fetch('./image.png');
const blob = await result.blob();
const image = await createImageBitmap(blob);
const pattern = canvasContext2D.createPattern(image, 'repeat'); 
```

然后简单地填写 OffscreenCanvasContext2D：

```
canvasContext2D.fillStyle = pattern;
canvasContext2D.fill(); 
```

参考：

*   OffscreenCanvas - [developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas)
*   OffscreenCanvasRenderingContext2D - [html.spec.whatwg.org](https://html.spec.whatwg.org/multipage/canvas.html#offscreencanvasrenderingcontext2d)
*   工人 - [developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/Worker)
*   获取 - [developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)
*   Blob - [developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/Blob)
*   createImageBitmap - [developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/createImageBitmap)
*   createPattern - [html.spec.whatwg.org](https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-createpattern)

# javascript - 支持 LLVM 的 HTML/JS/CSS 语法高亮

> ID：10791614
> 
> 赞同：3
> 
> 时间：2012-05-28T23:56:49.320
> 
> 标签：javascript, html, css, syntax-highlighting, google-code-prettify

我目前正在使用[google-code-prettify](http://code.google.com/p/google-code-prettify/)进行语法高亮显示。它似乎不支持 LLVM。这是格式化 LLVM 时的样子：

![在此处输入图像描述](../Images/b45a22a8bf542bca4f2fcde173386235.png)

这很丑陋。是否有任何支持 LLVM 的前端语法荧光笔？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T22:07:11.317

[我从LLVM TextMate Bundle 项目](https://github.com/hansstimer/llvm.tmbundle)中获取了 LLVM 汇编语法突出显示的模式，并为[google-code-prettify](http://code.google.com/p/google-code-prettify/)编写了一个插件。

```
PR['registerLangHandler'](
    PR['createSimpleLexer'](
        [
         // Whitespace
         [PR['PR_PLAIN'],       /^[\t\n\r \xA0]+/, null, '\t\n\r \xA0'],

         // A double quoted, possibly multi-line, string.
         [PR['PR_STRING'],      /^\"(?:[^\"\\]|\\[\s\S])*(?:\"|$)/, null, '"'],

         // comment.llvm
         [PR['PR_COMMENT'],       /^;[^\r\n]*/, null, ';'],
        ],
        [
         // llvm instructions
         [PR['PR_KEYWORD'],     /^\b(?:add|alloca|and|ashr|bitcast|br|call|eq|exact|extractelement|extractvalue|fadd|fcmp|fdiv|fmul|fpext|fptosi|fptoui|fptrunc|free|frem|fsub|getelementptr|icmp|inbounds|indirectbr|insertelement|insertvalue|inttoptr|invoke|load|lshr|malloc|mul|ne|nsw|nuw|oeq|oge|ogt|ole|olt|one|or|ord|phi|ptrtoint|ret|sdiv|select|sext|sge|sgt|shl|shufflevector|sitofp|sle|slt|srem|store|sub|switch|trunc|udiv|ueq|uge|uge|ugt|ugt|uitofp|ule|ule|ult|ult|une|uno|unreachable|unwind|urem|va_arg|xor|zext)\b/, null],

         // llvm keywords
         [PR['PR_KEYWORD'],     /^\b(?:addrspace|alias|align|alignstack|alwaysinline|appending|asm|blockaddress|byval|c|cc|ccc|coldcc|common|constant|datalayout|declare|default|define|deplibs|dllexport|dllimport|except|extern_weak|external|fastcc|gc|global|hidden|inlinehint|inreg|internal|linkonce|linkonce_odr|metadata|module|naked|nest|noalias|nocapture|noimplicitfloat|noinline|noredzone|noreturn|nounwind|optsize|private|protected|ptx_device|ptx_kernel|readnone|readonly|section|sideeffect|signext|sret|ssp|sspreq|tail|target|thread_local|to|triple|uwtable|volatile|weak|weak_odr|x86_fastcallcc|x86_stdcallcc|zeroext)\b/, null],

         // variable.llvm
         [PR['PR_TYPE'],       /^\s(?:[%@][-a-zA-Z$._][-a-zA-Z$._0-9]*)/],

         // variable.language.llvm
         [PR['PR_TYPE'],       /^\s(?:[%]\d+)/],

         // storage.type.language.llvm
         [PR['PR_PLAIN'],       /^\b(?:i\d+\**)/],

         // variable.metadata.llvm
         [PR['PR_PLAIN'],       /^(!\d+)/],

         // constant.numeric.float.llvm
         [PR['PR_LITERAL'],       /^\b\d+\.\d+\b/],

         // constant.numeric.integer.llvm
         [PR['PR_LITERAL'],       /^\b(?:\d+|0(?:x|X)[a-fA-F0-9]+)\b/],
        ]),
    ['llvm', 'll']); 
```

以下是[演示 jsFiddle](http://jsfiddle.net/eaPg6/3/)和带有演示页面和自述文件的[Gist的链接。](https://gist.github.com/2850418)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T15:23:49.460

Pyments 支持 LLVM。它基于 python 后端，用户可以在样式之间进行选择。

输出模式：

*   HTML
*   ANSI 序列（控制台输出）
*   LaTeX 与[minted包相结合](http://code.google.com/p/minted/)
*   RTF

[http://pygments.org/demo/45402/](http://pygments.org/demo/45402/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T19:30:53.493

考虑到 LLVM 是一种相当晦涩难懂的编程语言，您很难找到专门为它设计的语法高亮器。然而，这并不意味着你不能稍微作弊，并让某些事情发挥作用。我建议使用 SyntaxHighlighter。[http://alexgorbatchev.com/SyntaxHighlighter](http://alexgorbatchev.com/SyntaxHighlighter)

尽管它本身并不支持 LLVM，但它为各种其他编程语言提供了许多内置画笔。我会尝试一下，并尝试将不同的画笔（语法荧光笔）应用于您的 LLVM 代码。有些会匹配得很好，而有些会显得平淡无奇，就像您演示的示例一样。

如果你看[这里](http://alexgorbatchev.com/SyntaxHighlighter/manual/brushes/)，你还会看到许多非官方的画笔也存在。这是使用 SyntaxHighlighter 的一个好处——如果曾经设计过 LLVM 画笔（或者如果您决定自己设计它），那么实现起来会很简单。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T19:31:51.783

不知道你是否是一个 linux 人，因为你使用 Python 我想你会。Emacs 和 Vim 似乎支持 LLVM 语法高亮。请参阅[http://llvm.org/docs/GettingStarted.html](http://llvm.org/docs/GettingStarted.html)。如果您不想使用这些，也许您可​​以使用其他 IDE 或编辑器中提供的语法文件（稍加修改）。谷歌了它，所以不能再帮助你了。如果这还不够，你的任务就成功了。

# javascript - 在javascript中更新jsp变量

> ID：10791617
> 
> 赞同：0
> 
> 时间：2012-05-28T23:57:05.997
> 
> 标签：javascript, jsp

我在我的 jsp 页面顶部定义了一个变量：

```
<%! int count = 0; %> 
```

然后我使用 buttonclick 调用 jquery，如下所示：

```
<script type="text/javascript">
$(document).ready(function() {         
    $('#somebutton').click(function() {
        var c = '<%=count%>';
        <% count += 5; %>
    });
});
</script> 
```

这个想法是变量计数将在函数完成后更新（并保持）。但是，它似乎在本地更新计数，但不会在全局范围内持续存在。当我单击按钮计数总是设置为 5，但在进一步单击按钮时永远不会增加到 10、15 等。

如何从 jquery 函数中更新 jsp 变量并使其保持不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:03:06.913

您必须回调服务器并将数据存储在会话变量中（或者我想取决于安全需要的 cookie）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T09:48:25.200

@Aaron-您可以在 javascript 中使用一种方法，例如

```
function increment(){
                var value1=document.getElementById("lbl1").value;
                value1=parseInt(value1)+5;
                document.getElementById("lbl1").innerText=value1;
            } 
```

其中 lbl1 是 jsp 中文本框的 id，其初始化值为 0 即`<input type="text" value="<%=count%>" id="lbl1"/>`。并在按钮上单击这样的调用增量（）方法`<input type="submit" onclick="increment()"/>.`

希望这能满足您的要求...

# mobile - 触摸设备的活动状态延迟

> ID：10791626
> 
> 赞同：0
> 
> 时间：2012-05-29T00:00:08.767
> 
> 标签：mobile, touchstart

我正在使用以下代码来允许触摸事件的“：活动”状态..

```
document.addEventListener("touchstart", function() {},false); 
```

它工作得很好，但是如果你正在滚动，有没有办法让这个延迟很短？如果您只是滚动，我试图避免列表中的项目成为“：活动”。例如..想想你手机上的“联系人”列表。如果滚动，名称/项目不会触发 ":active" 样式，直到您专门按下项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T02:10:24.480

Take a look here, i think this is what you need.

[http://brice.lechatellier.com/code-design/enable-active-state-on-touch-devices-with-jquery-zepto/](http://brice.lechatellier.com/code-design/enable-active-state-on-touch-devices-with-jquery-zepto/)

# ios - 将 b2Body 移动到位置

> ID：10791633
> 
> 赞同：1
> 
> 时间：2012-05-29T00:01:33.763
> 
> 标签：ios, cocos2d-iphone, box2d

本质上，我正在构建一个带有“点击”控件的应用程序来控制侧面滚动视图中的角色，用户点击他们想要移动角色的位置，然后角色应该移动到那个 x 位置。我只是在考虑实现这一点的最佳方法，我想我可以对角色应用线速度，然后反复检查它是否已达到目标（假设每 0.05 秒），在这种情况下，它的速度可以是设置为 0 但这似乎不是特别优雅。有什么建议么？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T08:45:53.463

尝试使用线性脉冲，它将身体移动到所需的位置。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:21:57.903

您可以轻松地为视图位置设置动画。只是做类似的事情

```
CGPoint destination = ... ;
[UIView animateWithDuration:.3 animations:^{
  view.center = destination;
}]; 
```

您必须在父视图中捕获触摸。此外，目的地的坐标应该在视图的父坐标中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T05:02:26.057

要更改 b2Body 位置，您可以使用 SetTransform 方法。它允许您将 b2World 中的新位置设置为 b2Vec 和身体角度。

但是如果你需要检查碰撞，你可能会遇到麻烦。如果您使用力/速度/脉冲移动身体，它将防止出现例如两个应该碰撞的物体出现在同一位置的情况。在 SetTransform 的情况下，此类对象的碰撞结果可能是错误的。

例如，如果您的游戏区域边界很少，在 SetTransform 的情况下，当您的游戏对象将被放置在您的一个边缘上时，它可以被推出您的游戏区域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T20:00:22.373

我目前正在做类似的事情。我希望我的家伙有一个恒定的运行速度，所以我使用了`SetLinearVelocity(b2Vec2)`一大堆命令实现了一些东西。我不确定在 Box2D 中为`update:(ccTime)dt`您移动时运行的每个调用 SetLinearVelocity 是否“正确”——这有点像绕过看起来很愚蠢的物理引擎——但到目前为止它对我来说还不错。

以下例程的效果`update:`是玩家的身体不会突然停止移动。如果你很好地调整你的玩家身体和环境，它会在它停止时有一个甜蜜的小滑梯。

我的触摸回调在下面`-(BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event` 调用`setGoalX:(float)x`我的 Player 对象的函数：

```
//somewhere initially, I set up linear damping for some extra drag in my player class
//note: GROUND_DAMPING is defined earlier in my file, and is not a Box2d thing.
self.physicsBody->SetLinearDamping(GROUND_DAMPING);

-(void) setGoalX:(float)x
{
    goal_->x = x; //b2Vec2* goal
}

-(void) update:(ccTime)dt
{
    int dx = (goal_->x - body->GetPosition().x)*10;
    if (dx != 0) {
        xdir = (dx > 0) ? 1 : -1;
        if (abs(dx) >= 10) 
            body->SetLinearVelocity(b2Vec2(RUN_SPEED*xdir,body->GetLinearVelocity().y));
    } else xdir = 0;
} 
```

# hash - OpenPGP 签名包散列数据

> ID：10791636
> 
> 赞同：5
> 
> 时间：2012-05-29T00:02:18.863
> 
> 标签：hash, openpgp

RFC 4880 将版本 4 签名数据包标签 2 描述为

```
- One-octet signature type.
- One-octet public-key algorithm.
- One-octet hash algorithm.
- Two-octet scalar octet count for following hashed subpacket data.
Note that this is the length in octets of all of the hashed
subpackets; a pointer incremented by this number will skip over
the hashed subpackets.
- Hashed subpacket data set (zero or more subpackets).
- Two-octet scalar octet count for the following unhashed subpacket
data. Note that this is the length in octets of all of the
unhashed subpackets; a pointer incremented by this number will
skip over the unhashed subpackets.
- Unhashed subpacket data set (zero or more subpackets).
- Two-octet field holding the left 16 bits of the signed hash
value.
- One or more multiprecision integers comprising the signature. 
```

我假设倒数第二行意味着只取散列子包的字符串并用散列算法对其进行散列并取其前 2 个字节。但是，无论我做什么，我似乎都无法得到它。

我很久以前生成了这个假密钥

```
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: BCPG v1.39

mQGiBE5B0h8RBAD533Z5bK1IpBx02QyQL0QoJE4uFRIMGDiwXuwmZzVl+R7Vlurd
GRLsCCbE6vOOh7XQVZGzLEBy9WNzZ9m+EbCfSVAYkjS6FhLws6hG6irrnS+b3JBf
gFJ8vNGF9Z7bhx+7y7NBk0IMyWkGnUkcnav73t5FQUI2faEBN4c/yAGJZwCgjcB7
3akWk9XVWvTCsiMXxpyvkukEALXsvB6cOoFEtQq9cQHjP63fBlvD94dhhMiM0cH6
hW9JotxdK+cxFGG9ZIWgoN2PWbMJka/H4W5EL6tS+YiNAR7I1Ozkt6X16GjnQUzZ
MlSpleK+KiKVN2anRaPEoOIinHrE3ZXd6QlJ/4+OJn4IVWmSEaJpFf4QNgvEu4rh
xinyBAD2RNzREOA+wpnFZ4lDt9NZXmXdxQME/l0J9XcvWhpGsxA/MATQKImy7N49
7GT/M38F+TrpBobag1O3buE99fOLyws4Tbc+sZMdHxoiGZDAIRNQS2rv475E6ktj
7vd5CYvOkA6+8sX1+hPcNlkHtHB1OFkJRsYp6k0zkyC9adjBM7QTYWJjIDxtYWtj
bUBhYWEuY29tPohGBBMRAgAGBQJOQdIfAAoJEDBSJUXPd92GRSQAoItbtbToOg7a
/hcg2sA/aBEQNwuxAKCGR69vmSoCWoBP5waPk0UsjM3BSbjMBE5B0h8QAgCUlP7A
lfO4XuKGVCs4NvyBpd0KA0m0wjndOHRNSIz44x24vLfTO0GrueWjPMqRRLHO8zLJ
S/BXO/BHo6ypjN87Af0VPV1hcq20MEW2iujh3hBwthNwBWhtKdPXOndJGZaB7lsh
LJuWv9z6WyDNXj/SBEiV1gnPm0ELeg8Syhy5pCjMAf9QHehP2eCFqfEwTAnaOlA6
CU+rYHKPZaI9NUwCA7qD2d93/l08/+ZtFvejZW1RWrJ8qfLDRtlPgRzigoF/CXbR
iEYEGBECAAYFAk5B0h8ACgkQMFIlRc933YZRrACfUnWTjHHN+QsEEoJrwRvFmvzj
bR4An24pTpeeN+I6R59O/sdmYsAhjULX
=sStS
-----END PGP PUBLIC KEY BLOCK----- 
```

我认为我应该做的：

```
sha1("\x05\x02\x4e\x41\xd2\x1f") = "52f07613cfd61c80d2343566a8f3f487a0975b80"

\x05 - length of subpacket
\x02 - subpacket type
\x4e\x41\d2\x1f - creation time 
```

从[pgpdump.net](http://pgpdump.net)，我看到散列 (SHA 1) 值的左侧 2 个字节`45 24`用于第一个签名包和`51 ac`第二个签名包。我得到`52 f0`了两者。显然，我不包括一些信息，但它是什么？散列后的子包相同，散列数据之前的所有数据也相同，只是它们是不同类型的签名包（0x13 / 0x18）。即使我从数据包中添加/获取字符，我也无法获得任何正确的哈希值。除了哈希值之外，生成的密钥与此处显示的密钥完全相同。

我应该散列的数据是什么？

编辑：如果稍后发现：

```
The concatenation of the data being signed and the signature data
from the version number through the hashed subpacket data (inclusive)
is hashed. The resulting hash value is what is signed. The left 16
bits of the hash are included in the Signature packet to provide a
quick test to reject some invalid signatures. 
```

但是正在签名的数据是什么？签名前的所有数据包？只是当前签名包之前的包？

上面的关键示例由`packet 6 + packet 13 + packet 2 + packet 14 + packet 2`. 我已经尝试了各种组合`packet 6`，，`packet 13`和`packet 2`（从版本号到散列数据包括在内），但仍然找不到散列到正确值的字符串

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T00:00:42.823

当您生成签名包时，它始终是某人*对*某事*的*签名。也就是说，有一些数据被签名，还有一个公钥，而签名的意义在于，它应该只能由拥有该确切数据和相应私钥的人制作。

因此，“正在签名的数据”将是任何数据块。有关一些示例，请参见 RFC4880 的第 5.2.1 节。在本例中，大概您对公钥块内的签名包感兴趣。

第一个是“用户 ID 和公钥数据包（0x13）的肯定认证”。这在 RFC4880 的第 5.2.4 节中有所描述。

第二个是“子密钥绑定签名”，主密钥（DSA 密钥）保证子密钥（ElGamal 仅加密）属于它。RFC4880 的第 5.2.4 节也描述了这种工作方式。

以下是 5.2.4 中的相关文本：

> 当对密钥进行签名时，哈希数据以八位字节 0x99 开始，然后是密钥的两个八位字节长度，然后是密钥包的正文。（请注意，这是具有两个八位字节长度的密钥数据包的旧式数据包标头。）子密钥绑定签名（类型 0x18）或主密钥绑定签名（类型 0x19）然后使用与主密钥相同的格式对子密钥进行哈希处理密钥（也使用 0x99 作为第一个八位字节）。密钥撤销签名（类型 0x20 和 0x28）仅散列被撤销的密钥。

进而

> 证书签名（类型 0x10 到 0x13）将绑定到密钥的用户 ID 散列到上述数据之后的散列上下文中。V3 认证对用户 ID 或属性数据包数据包的内容进行散列处理，没有任何标头。V4 认证对用于用户 ID 认证的常量 0xB4 或用于用户属性认证的常量 0xD1 进行哈希处理，后跟一个给出用户 ID 或用户属性数据长度的四字节数字，然后是用户 ID 或用户属性数据。

# actionscript-3 - 在 Datagrid 上设置编辑位置

> ID：10791638
> 
> 赞同：1
> 
> 时间：2012-05-29T00:02:50.283
> 
> 标签：actionscript-3, apache-flex, flash-builder

我最近想确保某个特定的单元格已准备好进行编辑。所以我尝试在数据网格上使用editedItemPosition 属性，但单元格没有编辑。

有关信息，我的 datagrid 使用 itemrenderer 和 editorrenderer，并且 datagrid 的可编辑属性为 true。

```
 private function setSelectedItem():void
{
    var gData:Object = dgSuiviClini.dataProvider;
    var todayDate:String= new DateUtility().DateAsToString(new Date());

    for(var i:Number=0; i < gData.length; i++)
    {
        var thisObj:Object = gData.getItemAt(i);
        if(thisObj.grDateDeb == todayDate)
        {
            dgSuiviClini.selectedIndex = i;
            //sometimes scrollToIndex doesnt work if validateNow() not done
            dgSuiviClini.validateNow();
                //dgSuiviClini.scrollToIndex(i);
        }
        else{
            dgSuiviClini.validateNow();
                // dgSuiviClini.scrollToIndex(gData.length);

        }
    }
    dgSuiviClini.validateNow();
    dgSuiviClini.editedItemPosition = { rowIndex: gData.length-1, columnIndex: 3 };

} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:55:21.720

现在，它适用于这段代码

```
 private function setSelectedItem():void
{
    var gData:Object = dgSuiviClini.dataProvider;
    var todayDate:String= new DateUtility().DateAsToString(new Date());

    for(var i:Number=0; i < gData.length; i++)
    {
        var thisObj:Object = gData.getItemAt(i);
        if(thisObj.grDateDeb == todayDate)
        {
            dgSuiviClini.selectedIndex = i;
            //sometimes scrollToIndex doesnt work if validateNow() not done
            dgSuiviClini.validateNow();
                //dgSuiviClini.scrollToIndex(i);
        }
        else{
            dgSuiviClini.validateNow();
                // dgSuiviClini.scrollToIndex(gData.length);

        }
    }
    dgSuiviClini.validateNow();
    dgSuiviClini.editedItemPosition = { rowIndex: gData.length-1, columnIndex: nColSaisie };

} 
```

# jquery - 如何隐藏绘图图表上显示的点？

> ID：10791642
> 
> 赞同：5
> 
> 时间：2012-05-29T00:03:12.283
> 
> 标签：jquery, jqplot

我有以下`jqPlot`图表：

```
 $(document).ready(function () {
       var line1 = new Array();
       @foreach (var item in Model)
       {
          <text>line1.push(["@item.VisitDate.Value.ToString("dd-MMM-yyyy")", @item.count]);</text>
       }
       var plot1 = $.jqplot('chart1', [line1], { title: '<span style="Color: Green " >Number Of Visits</span>',
          axesDefaults: { pad: 1.2 },
          axes: { 
             xaxis: { 
                renderer: $.jqplot.DateAxisRenderer,
                tickOptions: {
                    formatString: '%d/%b/%Y'
                }
             },
             yaxis: { tickOptions: { formatString: '%.2f'} }
          },
          highlighter: { show: true, sizeAdjust: 7.5, tooltipLocation: 'nw'
                //            , formatString: '<b>%s</b>'
          }, cursor: { show: true, tooltipOffset: 6 }
      })    
   }); 
```

但我需要为数组中的每个值隐藏当前显示在绘图图表上的圆形点。换句话说，我需要`jqPplot`图表只显示一条简单的线，没有任何圆形点、荧光笔或刻度选项等。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T09:30:35.100

要摆脱圆形标记，您需要使用以下选项。

```
 seriesDefaults: {
        showMarker: false
    },
    axesDefaults: {
        showTicks: false,
        showTickMarks: false       
    }, 
```

[请参阅此代码示例。](http://jsfiddle.net/Boro/zRhXs/24/)

# javascript - 在回发 (ASP.NET) 中发送本地生成的数据的选项

> ID：10791647
> 
> 赞同：1
> 
> 时间：2012-05-29T00:04:04.540
> 
> 标签：javascript, asp.net, kendo-ui

我使用了 ASP.NET[隐藏字段](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hiddenfield.aspx)控件，允许我在 javascript 中生成单项数据值，然后在回发时将这些值发送回服务器。

我的新问题是我有一个完整的项目列表，这些项目完全在浏览器客户端中创建和编辑。该控件本身不是 ASP.NET 控件。（我正在使用[剑道列表视图](http://demos.kendoui.com/web/listview/editing.html)）。

如何发回这些数据？

我假设 javascript 需要以某种方式将本地数据源编码到 DOM 中，并且服务器代码将以某种方式提取值。

我能想到的唯一“不知何故”是将所有值序列化为一个字符串并将其设置为隐藏字段值。

使用 javascript 序列化值并使用 C# 反序列化这些值当然是可行的，但似乎有点过于“手动”。我想知道是否有更直接的方法不涉及手动序列化。某种写入 DOM 的方法，然后由 ASP.NET 绑定功能获取。

对于这个问题，数据格式如下：

```
[
   {
      sequenceNumber : 1,
      mediaFileId: 3
    },
    {
       sequenceNumber : 2,
       mediaFileId: 28
    },
    {
       sequenceNumber : 3,
       mediaFileId:  32
    }
] 
```

您可能会争辩说 sequenceNumber 是多余的，但我将来会添加新字段，因此最好找到一个适合多字段数据对象的解决方案。

* * *

我知道我可以用 AJAX 调用替换整个帖子，但此时对现有页面的更改太大了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:11:55.820

> 某种写入 DOM 的方法，然后由 ASP.NET 绑定功能获取。

不知道你的意思是什么 - 如果没有 ASP.NET 服务器控件，就没有任何东西可以获取回发的值。服务器控件使用 ViewState 的隐藏字段来存储这些数据，但从客户端添加或更新项目实际上并不可行。

由于您已经拥有 JSON 格式的数据，因此我只需将其放入 a`HiddenFieldValue`并在 C# 端使用 JSON 反序列化器将其返回到 POCO。

[`JavaScriptSerializer`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx), [`DataContractJsonSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx), 或[`JSON.NET`](http://json.codeplex.com/)应该都适用于 C# 反序列化例程，而无需太多手动工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:49:08.963

如果该动作具有破坏性，则使用`post`，否则，使用`get`。

至于数据格式，我建议`json`。

使用 json.net 和 c#`dynamic`和`expendo`，它们很容易使用，而不会对您的页面进行太多更改。

# java - 为什么ñ变成ñ？

> ID：10791649
> 
> 赞同：11
> 
> 时间：2012-05-29T00:04:18.073
> 
> 标签：java, unicode

每当我保存任何包含 ñ 的字符串时，我都不明白它会更改为 Ã±。即使在数据库中，ñ 也更改为 ñ。

例子：

*   ñ 变成ñ。
*   Niño 变成 Niño。

我不知道是什么导致了这个问题或问题来自哪里。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T12:12:54.213

字符`ñ`(U+00F1) 使用 UTF-8 作为两个字节`11000011 10110001`( `0xC3 0xB1`) 进行编码。

这两个字节使用 ISO 8859-1 作为两个字符进行解码`Ã±`。

因此，您很可能使用 UTF-8 将字符编码为字节，并使用 ISO 8859-1（Sajmon 猜测的拉丁语 1）将字节解码为字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T00:08:46.800

字符编码问题，肯定的。确保数据库、网页、内容字符集、java 文件、字符串编码等都使用完全相同的编码 - 例如，UTF-8。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-29T00:07:45.813

您`string`的编码错误。但`UTF-8`你需要其他的，呃，拉丁语 1 吗？你需要解码。

检查[这个](https://stackoverflow.com/questions/5928046/spring-mvc-utf-8-encoding)

希望对您有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-29T00:07:52.460

这是一个字符编码问题，您需要检查从写入器到读取器的整个堆栈是否设置为 UTF-8。

查看此[讨论](https://stackoverflow.com/questions/5928046/spring-mvc-utf-8-encoding)，它可能包含一些可以帮助您的信息：

# wpf - WPF 慢 Tilemap 渲染性能

> ID：10791651
> 
> 赞同：1
> 
> 时间：2012-05-29T00:04:33.737
> 
> 标签：wpf, winforms, performance, xna, tile

我一直致力于将基于 XNA/WinForms 的现有 tilemap 编辑器迁移到 WPF。我对 WPF 比较陌生，但大多数概念并不难掌握。我有一个嵌入到 ScrollViewer 中的 Viewbox，使用 (Viewbox) 派生的 OnRender 方法提供的 DrawingContext 中的 DrawImage 方法来绘制地图。问题是当屏幕上有相当多的图块（在我的机器上>1000）时，我无法获得与 XNA/WinForm 版本几乎相同的性能。我已经实现了缩放和平移，但是当我缩小太多或在屏幕上有大量图块时平移时，会出现严重的延迟，从而破坏用户体验。我已经采取了几个明显的优化措施（冻结源位图，剔除看不到的图块，将位图缩放模式设置为 LowQuality，提供缓存缓存提示），但它们似乎无法解决问题。问题显然在于 WPF 处理使用 DrawingContext 绘制带纹理的四边形的方式。

我提供了一个示例应用程序，其中包含重现问题所需的所有代码：[SampleGridDrawingExample](http://www.filedropper.com/slowgriddrawingexample)

按住鼠标中键并移动鼠标进行平移。随着窗口大小的增加，它变得越来越明显（显然是因为正在渲染更多的图块）。

有没有比 WPF 中的 DrawingContext 更快的方法来绘制大量具有合理性能的纹理四边形？使用 XNA/WinForms 我可以在多个图层中以合理的延迟绘制约 50000 个图块，而在 WPF 中使用我当前的方法超过 1000 会导致明显的延迟（>10000 会使应用程序爬行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T20:27:27.817

WPF 确实使用了硬件加速，但效率非常低 - 它对所有内容进行了太多的绘制调用。它的 3D 渲染功能旨在增强用户界面，而不是繁重的渲染（例如绘制数以万计的单个元素）。有可能您的代码可以优化，但肯定远不及 XNA 为您提供的性能水平。

更好的选择是在 WPF 中构建编辑器，但将渲染器保留在 XNA 中并将其托管在编辑器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T06:38:53.950

我已经下载了你的样本，它对我来说很好，没有重大的性能滞后。但是，如果我监视我的性能，无论何时移动鼠标，您执行的任何计算似乎都会遇到某种瓶颈。请参阅随附的屏幕截图，该屏幕显示了大量移动鼠标（图像的左半部分）和不经常移动鼠标（右半部分）时的 CPU 使用情况。

![CPU使用率](../Images/fb439bc30945821da73794039c46c7f4.png)

我认为渲染不是减慢速度的原因，而是事件处理程序中的其他代码。为了确定，我设置`RenderOptions.ProcessRenderMode = System.Windows.Interop.RenderMode.SoftwareOnly;`了 ，它在我的机器上的行为方式完全相同（良好的 CPU，中等的 GPU）。我也检查了这个 Memleak 问题，但就这一点而言，它看起来还可以——在我的 64 位窗口上，内存使用量永远不会超过 64Megs，垃圾收集有时会有效地释放资源。

你提到你以前的解决方案。该解决方案的哪一部分是基于 XNA 的？XNA 依赖于硬件加速（默认情况下 WPF 也是如此），另一方面，WinForms 是纯粹的 CPU 加速。谁运行你的老魔法，你的 CPU 还是你的 GPU？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T20:20:45.720

似乎单独使用 WPF，目前不可能接近 XNA 的性能。然而，在查看了关于 XNA 集成的 Nick Gravelyns[帖子后](http://blogs.msdn.com/b/nicgrave/archive/2011/03/25/wpf-hosting-for-xna-game-studio-4-0.aspx)，我决定使用那里列出的方法，因为我正在开发的应用程序的性能是可以接受的。经过对示例的一些修改和随后的压力测试，我设法使其足够稳定以用于生产代码。我强烈建议任何对 XNA->WPF 集成感兴趣的人看看那篇文章。

# r - 用矩阵中的列表替换奇异值

> ID：10791654
> 
> 赞同：2
> 
> 时间：2012-05-29T00:05:28.280
> 
> 标签：r, matrix, replace

给定矩阵

```
test <- structure(list(X1 = c(3L, 0L, 3L, 1L, 2L, 2L, 1L, 2L, 2L, 3L), 
X2 = c(2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), X3 = c(0L, 
0L, 3L, 0L, 2L, 2L, 3L, 0L, 0L, 2L), X4 = c(1L, 1L, 1L, 0L, 
3L, 1L, 3L, 1L, 1L, 1L), X5 = c(3L, 3L, 1L, 3L, 1L, 3L, 2L, 
3L, 3L, 3L), X6 = c(3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L
), X7 = c(2L, 2L, 2L, 3L, 2L, 2L, 3L, 2L, 2L, 2L), X8 = c(3L, 
0L, 1L, 0L, 1L, 1L, 3L, 0L, 0L, 1L), X9 = c(3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L)), .Names = c("X1", "X2", "X3", "X4", 
"X5", "X6", "X7", "X8", "X9"), row.names = c("1", "2", "3", "4", 
"5", "6", "7", "8", "9", "10"), class = "data.frame") 
```

我试图用数字序列 c(0,0,1) 替换“1”的每个实例，用 c(0,1,0) 替换 2，用 (1,0,1) 替换 3，用 (1,0,1) 替换 0 (0,0,0)。矩阵中的每个值都应替换为这些三个二进制值序列之一。结果`nrow`矩阵的 应该是`nrow(test) * 3`。显然我尝试使用索引`test[test == 1] <- c(0,0,1)`，但这会返回错误`rhs is the wrong length for indexing by a logical matrix`。替换功能在这里似乎也不起作用，返回相同的错误消息。任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T00:43:29.110

由于结果的维度不同（一个 3 维数组而不是一个 2 维矩阵），您不能只一个一个地替换元素。

您可以使用`apply`:if 经常用于对矩阵的每一列或每一行应用一个函数，但我们也可以使用它对每个元素应用一个函数。

```
apply( 
  test, 
  1:2, 
  function(u) list(c(0,0,0), c(0,0,1), c(0,1,0), c(1,0,1))[[u+1]] 
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:51:16.173

你可以这样做：

```
Z <- matrix(c(0, 1, 0, 0,
              0, 0, 1, 0,
              0, 0, 0, 1), nrow = 3)

sapply(test, function(i)Z[,i+1])
#      X1 X2 X3 X4 X5 X6 X7 X8 X9
# [1,]  0  1  0  0  0  0  1  0  0
# [2,]  0  0  1  0  0  0  0  0  0
# [3,]  1  0  0  0  1  1  0  1  1
# ...
# [28,]  0  1  1  0  0  0  1  0  0
# [29,]  0  0  0  0  0  0  0  0  0
# [30,]  1  0  0  0  1  1  0  0  1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T00:53:17.880

您可以使用 switch 扩展：

```
matrix( sapply( c(1+data.matrix(test)), 
                    switch, c(0,0,0), c(0,0,1), c(0,1,0), c(1,0,1)) , 
        nrow=nrow(test)*3 ) 
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
 [1,]    1    0    0    0    1    1    0    1    1
 [2,]    0    1    0    0    0    0    1    0    0
 [3,]    1    0    0    1    1    1    0    1    1
 [4,]    0    0    0    0    1    1    0    0    1
 [5,]    0    0    0    0    0    0    1    0    0
 [6,]    0    1    0    1    1    1    0    0    1
 snipped remaining rows

str( matrix( sapply( c(1+data.matrix(test)), 
                    switch, c(0,0,0), c(0,0,1), c(0,1,0), c(1,0,1)) , 
        nrow=nrow(test)*3 ) )
  num [1:30, 1:9] 1 0 1 0 0 0 1 0 1 0 ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-03T10:30:11.777

您的输入是一个数据框，因此双重应用方法也可以工作：

```
f <- function(u) list(c(0,0,0), c(0,0,1), c(0,1,0), c(1,0,1))[[u+1]] 
#  borrowed from Vincent Zoonekynd's answer
sapply(test, sapply, f) 
```

请注意，输出完全符合 OP 中的要求（“结果矩阵的 nrow 应为 nrow(test) * 3”）——这可能优于也可能不优于三维数组（的结果`apply(1:2, ...)`），具体取决于你想达到什么。

# perl - 如何让 perl grep 执行正则表达式捕获

> ID：10791655
> 
> 赞同：7
> 
> 时间：2012-05-29T00:05:50.230
> 
> 标签：perl

我正在尝试通过在下面的代码中获取 (.*) 的内容，使用 grep 的正则表达式捕获来捕获子字符串。

```
 @substring = grep /^test-results(.*)/,@$(array_reference); 
```

这不工作....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T05:09:29.893

在列表上下文中，正则表达式匹配返回其捕获匹配的列表，因此您只需要：

```
@substrings = map /^test-results(.*)/, @$array; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-29T00:10:37.573

可能该`map`功能更适合您想要的功能。您正在寻找类似于以下（未经测试）代码的内容：

```
@substrings = map { /^test-results(.*)/ ? $1 : () } @{ $arrayref }; 
```

# objective-c - 分配的对象的潜在泄漏 - 不知道为什么

> ID：10791656
> 
> 赞同：2
> 
> 时间：2012-05-29T00:06:12.507
> 
> 标签：objective-c, ios, memory-management, memory-leaks

有人可以帮我理解为什么静态分析器说在 for(NSDictionary...) 行存在潜在泄漏吗？

```
- (void)imageSearchController:(id)searchController gotResults:(NSArray *)results
{
    if ([results count] == 0) {
        UIAlertView *alertView = [[[UIAlertView alloc] initWithTitle:nil 
                                                            message:@"I was not able to find anything! Please try again."  
                                                           delegate:self cancelButtonTitle:@"OK" 
                                                  otherButtonTitles:nil] autorelease];
        [alertView show];
    } else {
        [self increaseSearchIndex];

        for (NSDictionary *item in results) {
            [imageGallery addSubview:[[ImageBox createImageBoxWitImageURL:[item objectForKey:@"tbUrl"]] retain]];
        }

        if (searchIndex <= 60) {
            [imageGallery addSubview:buttonBox];
        } else {
            [buttonBox removeFromSuperview];
        }

        //position the images with respect to each other and screen orientation
        [self positionImages];
    }
    [activityIndicator stopAnimating];
}

- (void)clearImages 
{
    for (UIView *subview in [imageGallery subviews]) {
        if ([subview isMemberOfClass:[ImageBox class]] || [subview isMemberOfClass:[ButtonBox class]]) {
            [subview removeFromSuperview];
        }
    }
} 
```

图像框将带有填充的图像返回给上述其他其他方法。自从我过去一直在使用 ARC 以来，我是内存管理的新手。如果您发现其他潜在的泄漏，请告诉我。我使用了泄漏仪器工具，它说没有泄漏！但我不确定情况是否如此，因为我试图引入泄漏，但它仍然说没有。以下是所有 ImageBox 代码：

```
@interface ImageBox : UIView

@property (nonatomic, retain) UIImageView *imageView;
@property (nonatomic, retain) UIImage *image;

+ (id)createImageBoxWitImageURL:(NSString *)imageURL;

@end

@implementation ImageBox

@synthesize imageView;
@synthesize image;
- (id)initWithImageURL:(NSString *)imageURL
{
    self = [super init];
    if (self) {
        int padding = 10;
        int imageHeight = 108;
        int imageWidth = 108;

        int paddingBoxHeight = imageHeight + (2 * padding);
        int paddingBoxWidth = imageWidth + (2 * padding);

        NSData* imageData = [[NSData alloc]initWithContentsOfURL:[NSURL URLWithString:imageURL]];
        image = [[[UIImage alloc] initWithData:imageData] autorelease];
        [imageData release];

        imageView = [[[UIImageView alloc] initWithImage:image] autorelease];
        imageView.layer.masksToBounds = YES;
        imageView.layer.cornerRadius = 13.0;
        imageView.contentMode = UIViewContentModeScaleAspectFill;
        CGRect imageFrame = CGRectMake(padding, padding, imageWidth, imageHeight);
        [imageView setFrame:imageFrame];

        CGRect paddingBoxFrame = CGRectMake(0, 0, paddingBoxWidth, paddingBoxHeight);
        [self setFrame:paddingBoxFrame];
        [self addSubview:imageView];

        self.backgroundColor = [UIColor clearColor];
    }
    return self;
}

+ (id)createImageBoxWitImageURL:(NSString *)imageURL
{
    ImageBox *imageBox = [[self alloc] initWithImageURL:imageURL];
    return [imageBox autorelease];
}

- (void)dealloc
{
    [imageView release];
    [image release];
    [super dealloc];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:08:37.327

这是因为有一个明确的、不必要的`retain`.

```
[imageGallery addSubview:
  [[ImageBox createImageBoxWitImageURL:[item objectForKey:@"tbUrl"]] retain]];
                                                                     ^^^^^^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:09:05.333

```
[imageGallery addSubview:[[ImageBox createImageBoxWitImageURL:[item objectForKey:@"tbUrl"]] retain]]; 
```

you are over-retaining the retaining the object, as it is already owned by the dictionary you are storing it in. if you would remove it form the dictionary, but still wants to have around, than you should retain it or use a retaining property.

try:

```
[imageGallery addSubview:[ImageBox createImageBoxWitImageURL:[item objectForKey:@"tbUrl"]]]; 
```

UIView's [`-addSubview:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-BBCCCEII) retains the subview:

> **Discussion**
> This method retains view and sets its next responder to the receiver, which is its new superview.

You are over-releasing image, imageView, as you release them in dealoc, but also call autorelease on them.

# java - 使用字符串参数实例化对象的 Java 问题

> ID：10791657
> 
> 赞同：1
> 
> 时间：2012-05-29T00:06:32.997
> 
> 标签：java, string, instantiation

我正在尝试完成我的作业，但在实例化具有 String 参数的对象时遇到问题。当我编译并运行到目前为止我拥有的应用程序时，它返回“Null”的字符串值，而不是我期望的值。

这是我的抽象超类

```
public abstract class Book
{
//Declaration of class variable
private String title;
protected double price;

// contructor for Book class objects
public Book(String bookTitle)
    {
        bookTitle = title;
    }
//method that gets and returns books title
public String getTitle()
    {
        return title;
    }
//method that gets and returns books price
public double getPrice()
    {
        return price;
    }
//abstract method with no parameters
public abstract void setPrice();
} 
```

这是我的子类

```
public class Fiction extends Book
{
//subclass contructor
public Fiction(String bookTitle)
{
    //calling superclass constructor
    super(bookTitle);
}
//override annotation and setPrice method override
@Override
public void setPrice()
{
    price = 19.99;
}
} 
```

这是我的主要方法类，对象fictionBook 应该用标题The White Unicorn 进行实例化。但是，由于某种原因，我的 println 正在打印出 null

```
public class BookTester
{
//Main method
public static void main(String[] args)
{
    //Instantiate object
    Fiction fictionBook = new Fiction("The White Unicorn");
    NonFiction nonFictionBook = new NonFiction("Autobiography of Curtis Sizemore");
    //call to the setPrice() method
    fictionBook.setPrice();
    nonFictionBook.setPrice();
    //Print information on books
    System.out.println("The Fiction book titled \"" + fictionBook.getTitle() + "\"costs $" + fictionBook.getPrice());
}
} 
```

我无法弄清楚问题是什么。任何人都可以帮助我吗？我也有一个非小说类书籍的子类，但我还没有达到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T00:09:03.710

```
public Book(String bookTitle)
    {
        bookTitle = title;
    } 
```

您正在将参数设置为属性值 - 可能与您的意图相反？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T07:30:48.843

你的课应该是这样的——

```
public abstract class Book
{
//Declaration of class variable
private String title;
protected double price;

// contructor for Book class objects
public Book(String bookTitle)
    {
        this.title = bookTitle;
    }
//method that gets and returns books title
public String getTitle()
    {
        return this.title;
    }
//method that gets and returns books price
public double getPrice()
    {
        return this.price;
    }
//abstract method with no parameters
public abstract void setPrice();
} 
```

# apache - .htaccess 仅重定向基本 URL，同时仍重定向所有其他内部内容

> ID：10791659
> 
> 赞同：0
> 
> 时间：2012-05-29T00:06:49.387
> 
> 标签：apache, .htaccess, redirect

这有点像泡菜，不幸的是，如果我没有继承其他人的问题，我就不会加入泡菜。

在我的公司，我们有一个夏季业务和一个冬季业务。以前的承包商没有在同一个 CMS 中设置具有相似内容的两个企业，而是将冬季网站安装在基本 public_html 文件夹中，并将夏季网站安装在子目录中。

当夏天到来时，这会产生问题，因为人们访问我们的网站时仍然会看到冬季网站，尽管我们希望他们去夏天。我们也不希望通过将每个人从根目录引导到 /summer/ 并摆脱 /winter 来使冬季网站无法访问。我们也有一些我们在那里获得的 SEO 实力......

**我的理论解决方案如下：**

1- 将所有冬季网站移动到 /winter/ （改变这些被合并并内置到 drupal CMS 中，所以请原谅子目录的扩散）

2- 将所有内部内容重定向如下，以尽可能保持我们拥有的页面的 SEO 排名，而不会使访问者感到困惑：

```
#redirect internal to winter page
RewriteCond %{REQUEST_URI} ^/?
RewriteRule (.*) /winter/$1 [R=301] 
```

该代码确实有效。

3- 仅将登录页面 (http://www.website.com/) 重定向到内部夏季页面 /summer/

我能够完成前两个没问题。问题在于第三个。我真的可以在这里使用一些帮助！我已经用谷歌搜索了几个小时，但我对 .htaccess 的理解还不够好，甚至不知道如何提出这个问题。我试图找到一些基本教程，但更多时候我只是找到关于如何完成任务的简短片段，而任务本身却一无所获。

那么，有人吗？布勒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:28:12.150

重定向登陆页面：

```
RewriteRule ^$ summer/ [L] 
```

在每个不以“/summer”开头的请求之前添加/winter：

```
RewriteCond %{REQUEST_URI} !^/(summer|winter) [NC]
RewriteRule ^(.*)$ winter/$1 [L,R=301,QSA] 
```

将这两个规则按顺序排列应该可以完成您想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:28:57.360

根据信息，请按顺序使用以下inf代码：

```
#redirect internal to winter page
RewriteRule ^$ /summer [R=301,L]
RewriteCond %{REQUEST_URI} ^/?
RewriteRule (.*) /winter/$1 [R=301] 
```

# python - 如何离散化 pandas DataFrame 中的值并转换为二进制矩阵？

> ID：10791661
> 
> 赞同：8
> 
> 时间：2012-05-29T00:06:52.027
> 
> 标签：python, pandas, dataframe

我的意思是这样的：

我有一个`DataFrame`可能是分类或名义的列。对于每个观察（行），我想生成一个新行，其中变量的每个可能值现在都是它自己的二进制变量。例如，这个矩阵（第一行是列标签）

```
'a'     'b'     'c'
one     0.2     0
two     0.4     1
two     0.9     0
three   0.1     2
one     0.0     4
two     0.2     5 
```

将被转换成这样的东西：

```
'a'              'b'                                                    'c'
one  two  three  [0.0,0.2)  [0.2,0.4)  [0.4,0.6)  [0.6,0.8)  [0.8,1.0]   0   1   2   3   4   5

 1    0     0        0          1          0          0          0       1   0   0   0   0   0
 0    1     0        0          0          0          0          1       0   1   0   0   0   0
 0    1     0        0          0          0          0          1       1   0   0   0   0   0
 0    0     1        1          0          0          0          0       0   0   1   0   0   0
 1    0     0        1          0          0          0          0       0   0   0   0   1   0
 0    1     0        0          1          0          0          0       0   0   0   0   0   1 
```

初始矩阵中的每个变量（列）都被合并到所有可能的值中。如果它是分类的，那么每个可能的值都会成为一个新列。如果它是一个浮点数，那么这些值会以某种方式分箱（例如，总是分成 10 个箱）。如果它是一个 int，那么它可以是每个可能的 int 值，或者也可能是 binning。

仅供参考：在我的实际应用程序中，表格最多有 200 万行，而完整的“扩展”矩阵可能有数百列。

有没有简单的方法来执行这个操作？

另外，我也愿意跳过这一步，因为我真的想计算一个 Burt 表（这是交叉表的对称矩阵）。有没有一种简单的方法可以用这个函数做类似的事情`crosstab`？否则，计算交叉表只是一个简单的矩阵乘法。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-12T21:52:56.733

请注意，我已经实现了离散化连续数据的新函数`cut`和函数：`qcut`

[http://pandas-docs.github.io/pandas-docs-travis/basics.html#discretization-and-quantiling](http://pandas-docs.github.io/pandas-docs-travis/basics.html#discretization-and-quantiling)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-22T12:13:58.643

`a`对于示例中的和列之类的标记列`c`，您可以使用 pandas 内置方法[get_dummies()](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.get_dummies.html#pandas.get_dummies)。

前任。：

```
import pandas as pd
s1 = ['a', 'b', np.nan]
pd.get_dummies(s1)
       a  b
    0  1  0
    1  0  1
    2  0  0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-29T08:13:14.277

您可以使用某种广播：

```
 In [58]: df
    Out[58]:
           a    b  c
    0    one  0.2  0
    1    two  0.4  1
    2    two  0.9  0
    3  three  0.1  2
    4    one  0.0  4
    5    two  0.2  5

    In [41]: (df.a.values[:,numpy.newaxis] == df.a.unique()).astype(int)
    Out[41]:
    array([[1, 0, 0],
           [0, 1, 0],
           [0, 1, 0],
           [0, 0, 1],
           [1, 0, 0],
           [0, 1, 0]])

    In [54]: ((0 <= df.b.values[:,numpy.newaxis]) & (df.b.values[:,numpy.newaxis] < 0.2)).astype(int)
    Out[54]:
    array([[0],
           [0],
           [0],
           [1],
           [1],
           [0]])

    In [59]: (df.c.values[:,numpy.newaxis] == df.c.unique()).astype(int)
    Out[59]:
    array([[1, 0, 0, 0, 0],
           [0, 1, 0, 0, 0],
           [1, 0, 0, 0, 0],
           [0, 0, 1, 0, 0],
           [0, 0, 0, 1, 0],
           [0, 0, 0, 0, 1]]) 
```

然后将所有部分连接在一起`pandas.concat`或类似。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-02T14:37:38.100

我怀疑你会打败[patsy](http://jseabold.net/presentations/seabold_pydata2012.html#slide1)的简单性。它专为这项任务而设计：

```
>>> from patsy import dmatrix
>>> dmatrix('C(a) + C(b) + C(c) - 1', df, return_type='dataframe')

   C(a)[one]  C(a)[three]  C(a)[two]  C(b)[T.0.1]  C(b)[T.0.2]  C(b)[T.0.4]   C(b)[T.0.9]  C(c)[T.1]  C(c)[T.2]  C(c)[T.4]  C(c)[T.5]  
0          1            0          0            0            1            0             0          0          0          0          0  
1          0            0          1            0            0            1             0          1          0          0          0  
2          0            0          1            0            0            0             1          0          0          0          0  
3          0            1          0            1            0            0             0          0          1          0          0  
4          1            0          0            0            0            0             0          0          0          1          0  
5          0            0          1            0            1            0             0          0          0          0          1 
```

这里的`C(a)`手段将变量转换为分类，`-1`是为了避免输出截距列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-05T04:40:58.170

将其他几个评论放在一个回答 OP 问题的回复中。

```
d = {'a' : pd.Series(['one', 'two', 'two', 'three', 'one', 'two']), 
     'b' : pd.Series([0.2, 0.4, 0.9, 0.1, 0.0, 0.2]),
     'c' : pd.Series([0, 1, 0, 2, 4, 5]) }

data = pd.DataFrame(d)
a_cols = pd.crosstab(data.index, [data.a])
b_bins = pd.cut(data.b, [0.0, 0.2, 0.4, 0.6, 0.8, 1.0], right=False)
b_cols = pd.crosstab(data.index, b_bins)
c_cols = pd.crosstab(data.index, [data.c], )
new_data = a_cols.join(b_cols).join(c_cols)
new_data.index.names = ['']
print new_data.to_string()

"""
       one  three  two  [0, 0.2)  [0.2, 0.4)  [0.4, 0.6)  [0.8, 1)  0  1  2  4  5

    0    1      0    0         0           1           0         0  1  0  0  0  0
    1    0      0    1         0           0           1         0  0  1  0  0  0
    2    0      0    1         0           0           0         1  1  0  0  0  0
    3    0      1    0         1           0           0         0  0  0  1  0  0
    4    1      0    0         1           0           0         0  0  0  0  1  0
    5    0      0    1         0           1           0         0  0  0  0  0  1
""" 
```

# android - 通过 DialogFragment android 将 TimePickerDialog 的结果设置为按钮

> ID：10791666
> 
> 赞同：1
> 
> 时间：2012-05-29T00:07:21.530
> 
> 标签：android

美好的一天，我将第一个承认，我根本没有使用片段的经验，只是在学习，所以请多多包涵。正如标题所说，我试图将 TimePickerDialog 的结果设置为我的活动中的一个按钮，但没有成功。当我单击开始按钮时，我看不到通常的 TimePickerDialog，我看到的只是屏幕中间的一个小空对话框。那么请问我做错了什么？谢谢你。

这是我的代码：

时间对话：

```
public class TimeDialog extends DialogFragment {
    private int mHour;
    private int mMinute;

    public TimeDialog(){

    }

    public static TimeDialog newInstance(int title){
        TimeDialog frag = new TimeDialog();
        Bundle args = new Bundle();
        args.putInt("title", title);
        frag.setArguments(args);
        return null;

    }

    private TimePickerDialog.OnTimeSetListener mTimeSetListener = new TimePickerDialog.OnTimeSetListener() {

        @Override
            public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
                mHour = hourOfDay;
                mMinute = minute;

                //updateDisplay();
            }

        /*private void updateDisplay() {

            View v = getActivity().getLayoutInflater().inflate(R.layout.add_resp, null);
            Button start = (Button)v.findViewById(R.id.start_time_button_id);
            start.setText(new StringBuilder().append(mHour).append(":").append(mMinute).toString());

        }*/
        };

    @Override
    public Dialog onCreateDialog(Bundle savedInstancestate){

        return new TimePickerDialog(getActivity(), mTimeSetListener, mHour, mMinute, false);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){
        View v = inflater.inflate(R.layout.add_resp, container, false);
        Button start = (Button)v.findViewById(R.id.start_time_button_id);
        start.setText(new StringBuilder().append(mHour).append(":").append(mMinute).toString());
        return v;

    }   
} 
```

这是我从活动中调用它的地方：

```
public class AddResp extends Activity implements OnClickListener {
    EditText text_title;
    Button start;

    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.add_resp);

        text_title = (EditText)findViewById(R.id.title_text_id);
        start = (Button)findViewById(R.id.start_time_button_id);

        start.setOnClickListener(this);

    }

    @Override
    public void onClick(View view) {
        int selection = view.getId();
        switch(selection){
        case R.id.start_time_button_id:

             DialogFragment newFragment = new DialogFragment();
                newFragment.show(getFragmentManager(), "dialog");
         break;       
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T17:20:15.717

要将数据从 DialogFragment 发送到 Activity，您可以使用 Handler 类。

**调用 TimePicker 对话框的主要活动：**

```
 public class MainActivity extends Activity{ 

    Handler h = new Handler(){
        @Override
        public void handleMessage(Message msg){
            Button button = (Button) findViewById(R.id.btn);
            button.setText(msg.getData().getString("btn"));
        }
    };

    @Override
    public void onCreate(Bundle bundle){
        super.onCreate(bundle);
        setContentView(R.layout.main);
    }

    public void btnClicked(View v){    
        TimepickerFragment dialog = new TimepickerFragment(h);
        dialog.show(getFragmentManager(), "timepickerdialog");
    }
} 
```

**时间选择器对话框：**

```
 public class TimepickerFragment extends DialogFragment{
    Handler h;
    public TimepickerFragment(Handler arg_h){
        h = arg_h;      
    }       
    private TimePickerDialog.OnTimeSetListener callback = new TimePickerDialog.OnTimeSetListener() {

        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {         
            Message msg = new Message();
            Bundle data = new Bundle();
            data.putString("btn", "Selected Time - " + hourOfDay + ":" + minute);
            msg.setData(data);
            h.sendMessage(msg);             
        }
    };

    public Dialog onCreateDialog(Bundle bundle){
        int hourOfDay = 10;
        int minute = 10;
        boolean is24HourView = false;
        TimePickerDialog tpdialog = new TimePickerDialog(getActivity(), callback, hourOfDay, minute, is24HourView); 
        return tpdialog;
    }
} 
```

注意：以上代码在 API 级别 14 中测试

# c#-4.0 - 创建一个新任务的成本是多少？

> ID：10791671
> 
> 赞同：1
> 
> 时间：2012-05-29T00:07:56.007
> 
> 标签：c#-4.0, asynchronous, task-parallel-library

我正在做一些异步数据获取，我需要在多次调用数据库时这样做。所有这些任务都需要以预定义的顺序执行，为此我使用协程和任务。

```
GetItemsA(); // wrapped in new Task
GetItemsB(); // wrapped in new Task
GetItemsC(); // wrapped in new Task 
```

目前，我正在为每个调用创建一个新任务。这是一种不好的做法，我应该尽量避免这种情况，并将所有 cals 包装在一个任务中吗？

```
GetItems(); // wrap in single Task

void GetItems()
{
    GetItemsA();
    GetItemsB();
    GetItemsC();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:05:26.117

好的做法通常是忽略开销并专注于代码的可读性。只有当您发现某些代码是您的应用程序的瓶颈时，才尝试对其进行优化。

创建新的开销`Task`很可能可以忽略不计，尤其是与数据库往返相比时。

# oauth-2.0 - iframe/popup 中的 Google oauth2 授权

> ID：10791673
> 
> 赞同：5
> 
> 时间：2012-05-29T00:08:06.610
> 
> 标签：oauth-2.0, x-frame-options

我的应用程序在 iframe 中工作（注入了 chrome 扩展）。该应用程序需要使用 google oauth2 向用户询问一些权限。[由于 X-Frame-Options: SAMEORIGIN at https://accounts.google.com/o/oauth2/auth](https://accounts.google.com/o/oauth2/auth)，重定向到 oauth-page 不能直接在 iframe 中工作

有没有办法在弹出窗口中显示页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:08:19.363

[对于您的情况，Google+ 登录](https://developers.google.com/+/web/signin/)似乎是一个不错的选择。它带有一个按钮，可在弹出窗口中触发身份验证流程。

# ruby-on-rails - 无法删除文件

> ID：10791677
> 
> 赞同：1
> 
> 时间：2012-05-29T00:09:01.650
> 
> 标签：ruby-on-rails, ruby

使用 Mac。

我为学习 Ruby on Rails 的演示创建了一个博客。我正在尝试将文件删除到我创建的博客中，但仍有一些文件不会删除。

我不断收到一条错误消息，说“development.sqlite3”正在使用中。我不知道是什么在使用这个文件，如何找到它，以及如何退出它。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:24:24.873

您可能在`ruby`某处运行了一个进程。启动[Activity Monitor](https://en.wikipedia.org/wiki/Activity_Monitor)，找到一个`ruby`进程，然后杀死它。（大概这是您在机器上运行的唯一 Ruby 程序，但请仔细检查。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:14:02.583

重新启动你的mac，然后再试一次

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T00:18:17.333

大多数情况下，重新启动计算机都有效。如果没有，如果文件已经存在，您可以在清空垃圾桶时尝试按住“alt”键。

或者，您可以使用终端

```
sudo rm -rf yourFileName 
```

# android - Droid Razr 上未显示小部件

> ID：10791686
> 
> 赞同：3
> 
> 时间：2012-05-29T00:10:39.090
> 
> 标签：android, widget

我有一个显示静态小部件的应用程序，但不适用于 Droid Razr。我一生都无法弄清楚，因为我的编码技能充其量是业余的。

小部件在主屏幕上，但它们是不可见的。您可以移动它们，但它们只是不显示。

基本上我的应用程序有多个小部件，并且在其他 android 版本中运行良好。我不太关心我糟糕的编码，但更要确保它适用于 Razr。（虽然提示将不胜感激！）

民主党人.java

```
 package demo.crat.widgets;

    import android.app.Activity;

    import android.os.Bundle;

    public class democrat extends Activity {
        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

        }

} 
```

然后我有每个小部件的另一个 java 文件（我确定这不是正确的编码）

W1.java

```
 package demo.crat.widgets;

import android.appwidget.AppWidgetProvider;

public class W1 extends AppWidgetProvider {
} 
```

我了解如何编辑所有 res 文件，所以我没有包含它们。

下面是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="demo.crat.widgets"
      android:versionCode="4"
      android:versionName="1.3">
    <uses-sdk android:minSdkVersion="4" />

      <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".democrat"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
<!-- Broadcast Receiver that will process AppWidget updates -->
        <receiver android:icon="@drawable/w1" android:name=".W1" android:label="@string/string1">
            <intent-filter>
                <action  android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
<meta-data android:name="android.appwidget.provider"
android:resource="@xml/hello_widget_provider" />
        </receiver>
        <!-- Broadcast Receiver that will process AppWidget updates -->
        <receiver android:icon="@drawable/w2" android:name=".W2" android:label="@string/string2">
            <intent-filter>
                <action  android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
<meta-data android:name="android.appwidget.provider"
android:resource="@xml/hello_widget_provider2" />
        </receiver>

    </application>
</manifest> 
```

我认为这与 democrat.java 中没有 OnUpdate() 有关吗？任何帮助将非常感激！

# algorithm - 如何在无向图中找到反馈边集

> ID：10791689
> 
> 赞同：15
> 
> 时间：2012-05-29T00:11:49.843
> 
> 标签：algorithm, graph, kruskals-algorithm

令 G = (V,E) 为无向图。**如果 G 的每个循环在 F 中至少有一条边，则一个边**集 F ⊆ E 称为 反馈边集。

 **(a) 假设 G 未加权。设计一种有效的算法来找到最小尺寸的反馈边集。

(b) 假设 G 是一个带正边权重的加权无向图。设计一个有效的算法来找到一个最小权重的反馈边集。

* * *

我的解决方案（需要建议）：

a)**最小尺寸反馈边集：**由于图是未加权的，我们可以使用 DFS。我们像往常一样从任何顶点开始 DFS。当我们遇到一个后边缘时，我们将它插入到一组反馈边缘中。当 DFS 完成时，集合将是答案。

b)**最小权重反馈边集：**由于图是加权的，我们可以使用 Kruskal。但克鲁斯卡尔通常从重量最小的边缘开始。如果我们可以否定所有边权重，然后运行 ​​Kruskal，每当我们在同一组件的顶点之间获得一条边时，我们可以将其保存在反馈边集中。最后，否定边缘权重。我建议否定边缘权重的原因是因为我们需要最小的权重反馈集。使用否定权重，Kruskal 将从具有最小权重（实际上是最大）的边开始，并会找到具有较小权重的相同组件的边。

有人可以判断这个解决方案是否正确吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T15:14:29.537

是的，您的解决方案是正确的。无向图的最小权重反馈边集是最大权重生成森林的补充。所有生成林具有相同的基数，因此在未加权的情况下，任何生成林（由 DFS 发现）都可以。（证明草图：拟阵。）

反馈*弧*集确实是 NP 难的，但这是无向的情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-20T21:19:46.760

要在具有正权重的加权有向图中找到最小权重反馈边集：

通过否定权重，观察它相当于找到最大权重反馈边缘集。要找到最大权重反馈边集，请使用 Prim 或 Kruskal 算法构建 MST。然后取那个 MST 的补码。

为什么它有效？这是基于以下观察：

**一条边不在任何 MST 中当且仅当存在一个循环，该循环对该循环中的所有其他边具有最大权重。** 或者，换句话说，一条边在某个 MST 中当且仅当对于该边所属的每个循环，它在该循环中的所有其他边上不是具有最大权重。

实际上，假设我们有一个具有最大权重的反馈边集，其中存在一个包含该边和另一个权重更大的边的循环，那么用另一个边替换该边将提供一个权重更大的反馈边集。

为了完整起见，观察的**证明：**

<=) 假设一条边在一个循环中具有最大权重。如果它在某个 MST 中，那么用该循环中的另一个边替换该边将提供一个权重更小的 MST。

=>) 假设对于给定边所属的每个循环，在该循环中都存在一个权重更大的边。如果它不在任何 MST 中，那么将该边添加到 MST 将导致 MST 中的循环。然后从该循环中移​​除最大权重的边缘（与给定边缘不同）将提供具有较小权重的 MST（并包含该给定边缘）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T07:26:47.967

这两个问题都是NP完全的。因此，即使是近似有效的（多项式时间）解决方案也不太可能存在（http://en.wikipedia.org/wiki/Feedback_arc_set）。

如果您可以放宽应用程序中对严格的最小解决方案大小的要求，还有其他可用的启发式方法，但它们可能难以相互比较。

请注意，您可以轻松找到最小（不是最小）解决方案：以任何顺序遍历任何反馈边缘集的边缘，如果冗余则立即删除。对所有边缘进行一次扫描就足够了，并使用例如 DFS 执行冗余测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-04T12:21:47.597

对于任何反馈边，此图的补集必须是原始图的生成森林。这就是说补图不包含任何循环，这是非常明显的。

问题a)：
对于最小尺寸的反馈边集，这相当于找到最大尺寸的跨越森林。所以我们可以简单地使用 DFS 来找到图中每个连通分量的生成树并取补。然后我们得到一个最小尺寸反馈边。实际上，我认为 DFS 是没有必要的，只要我们可以为每个连接的组件找到一个生成树。
问题b)：
要找到一个最小权重反馈边集，这相当于找到最大权重跨越森林。然后我们可以使用 Kruskal 算法或 Prim 算法来找到每个连通分量的最大生成树。然后取补，我们将得到一个最小权重反馈集。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-05-29T11:13:54.693

Your solution A) won't work because you don't provide any logic to decide wether an edge has a "back" property or not.

Your solution B) won't work because Kruskal doesn't look for a feedback set, but for a min-weighted covering tree. A good example of why a min-weighted tree doesn't necessarily include a feedback edge set is the K4 graph.**

# php - PHP - 营业时间

> ID：10791697
> 
> 赞同：2
> 
> 时间：2012-05-29T00:13:08.690
> 
> 标签：php, time

我正在尝试运行一个脚本，该脚本将在营业时间显示一条消息，但是在晚上 11 点至凌晨 4 点过夜时它似乎不起作用，知道如何解决它吗？当前代码如下：

```
date_default_timezone_set('Etc/GMT+0'); 

// Define daily open hours. Must be in 24-hour format, separated by dash. If closed for the day, set to 00:00-00:00
$time_range_mon = '23:00-04:00';
$time_range_tue = '23:00-04:00';
$time_range_wed = '23:00-04:00';
$time_range_thu = '23:00-04:00';
$time_range_fri = '23:00-04:00';
$time_range_sat = '23:00-04:00';
$time_range_sun = '23:00-04:00';

// Gets current day of week
$status_today = strtolower(date("D"));
// Gets current time of day in 00:00 format
$current_time = date("G:i");
// Makes current time of day computer-readable
$current_time_x = strtotime($current_time);

// Builds an array, assigning user-defined time ranges to each day of week
$all_days = array("mon" => $time_range_mon, "tue" => $time_range_tue, "wed" =>     $time_range_wed, "thu" => $time_range_thu, "fri" => $time_range_fri, "sat" =>     $time_range_sat, "sun" => $time_range_sun);
foreach ($all_days as &$each_day) {
    $each_day = explode("-", $each_day);
    $each_day[0] = strtotime($each_day[0]);
    $each_day[1] = strtotime($each_day[1]);
}

// Defines array of possible days of week
$week_days = array("mon", "tue", "wed", "thu", "fri", "sat", "sun");

// Compares current day of week to possible days of week and determines open vs closed     output based on current day and time.
foreach ($week_days as &$each_week_day) {
    if ($status_today == $each_week_day) {
        if (($all_days[$each_week_day][0] <= $current_time_x) &&     ($all_days[$each_week_day][1] >= $current_time_x)) {
        echo "Running Script - Operating Hours";
    } else {
        echo "Not Running Script - Out of Hours";
        }
    }
} 
```

# php - 有没有办法在 MySQL 结果集中生成“假”行？

> ID：10791698
> 
> 赞同：5
> 
> 时间：2012-05-29T00:13:08.890
> 
> 标签：php, mysql, sql

我需要这个用于图表目的。基本上我必须：

1.  按日期选择所有发送的短信，不带时间部分，逐日获取包含日期/计数对的数组；
2.  在我的表中没有任何记录的情况下添加“假”行，即用零填充所有日期“空白”。

一个示例结果和相应的表格（这里是简化的）将是：

```
array(
    '2012-05-26 00:00:00' => 1,
    '2012-05-27 00:00:00' => 0, // Fake added row
    '2012-05-28 00:00:00' => 2,
)

+----------------+----------------------+
| Table SMS | id | sent_at              |
+----------------+----------------------+
|           |  1 | 2012-05-26 21:58:41  |
+----------------+----------------------+
|           |  2 | 2012-05-28 22:19:21  |
+----------------+----------------------+
|           |  3 | 2012-05-28 02:19:21  |
+----------------+----------------------+ 
```

是否有任何 SQL 命令可以执行此操作，或者我应该手动使用 PHP 数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:17:06.383

您可以使用 UNION 语句

```
SELECT 
   sent_at,
   Count(*)
FROM (Select
        id,
        DATE(sent_at) as sent_at
      FROM TableName 
      Group by Date(sent_at)
      UNION ALL
      Select
        '0' as id,
        DATE('2012-05-27') as sent_at) derived_table
Group By sent_at 
```

**已编辑**

我建议创建一个特殊的表来加入。

创建用于查询的日期表

```
CREATE TABLE DateTable (
  DateValue DateTime,
  Year Int,
  Month Int,
  Day Int) 
```

现在用您正在查询的范围内的所有日期值填充此表。您可以使用任何有效日期轻松加入此表。允许您聚合存在和不存在的日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T03:25:09.020

是的，我一直这样做

```
DROP PROCEDURE IF EXISTS `Example`;
DELIMITER $$

CREATE PROCEDURE `Example` (
    $StartDate DATE,
    $EndDate DATE
    )
BEGIN

    DECLARE $curDay DATE;
    SET $StartDate = IFNULL($StartDate,'2000-01-01');
    SET $curDay = $StartDate;

    DROP TEMPORARY TABLE IF EXISTS `Day`;
    CREATE TEMPORARY TABLE `Day`(
        `Date` DATE
    );

    DaysLoop:LOOP

        INSERT INTO
            `Day`(`Date`)
        SELECT 
            $curDay
        ;

        SET $curDay = $curDay + INTERVAL 1 DAY;

        IF 
            $curDay >= $EndDate OR $curDay >= NOW()
        THEN 
            LEAVE DaysLoop;
        END IF;

    END LOOP DaysLoop;

    SELECT
        D.Date,
        COUNT(S.id)
    FROM
        `Day` AS D
    LEFT JOIN
        `SMS` AS S
        ON D.Date = DATE(S.sent_at)
    GROUP BY
        D.Date
    ORDER BY
        D.Date
    ;

END $$

DELIMITER ;

CALL Example('2012-01-01','2012-05-01'); 
```

我使用并推荐用于报告的存储过程，只要确保您对创建脚本和诸如此类的东西进行版本控制。

# php - 如何在 WordPress 中仅显示子子页面的子页面？

> ID：10791699
> 
> 赞同：1
> 
> 时间：2012-05-29T00:13:21.023
> 
> 标签：php, wordpress, wordpress-theming

所以，我有一个看起来像这样的页面结构

```
 Location
    - New York
      - Restaurant #1
        - Dinner Menu
        - Lunch Menu
      - Restaurant #2
        - Dinner Menu
        - Lunch Menu 
```

所以当我说餐厅#1 页面时，我希望它只显示餐厅#1 的所有子页面。不幸的是，我当前的代码库正在返回纽约的所有子页面。

这是我的代码：

```
if ( is_page() ) {
   if($post->post_parent)
       $children = wp_list_pages('sort_column=menu_order&title_li=&child_of='.$post->post_parent.'&echo=0');
   else
       $children = wp_list_pages('sort_column=menu_order&title_li=&child_of='.$post->ID.'&echo=0');

   if ($children) {
       echo $children; 
   }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:26:47.210

得到它的工作。就是这样：

```
<? $pages = get_pages('child_of='.$post->ID.'&sort_column=post_title'); 
$count = 0; 
foreach($pages as $page){ ?>
  <li>
    <a href="<? echo get_page_link($page->ID) ?>"><? echo$page->post_title?></a>
  </li>
<? } 
?> 
```

# delphi - WorkAreas 在 Delphi 中的 ListViews 上工作吗？

> ID：10791705
> 
> 赞同：5
> 
> 时间：2012-05-29T00:14:40.730
> 
> 标签：delphi, listview

我一直在玩 TListView 并一直试图弄清楚 WorkAreas 是如何工作的，以及它们有什么用处。似乎很少有文档（大惊喜）。

有人成功使用过 WorkAreas 吗？如果是的话是为了什么？

我一直在尝试以下方法：

```
 wa := ListView1.WorkAreas.Add;
  wa.DisplayName := 'Work Area 0';
  wa.Rect.Width := ListView1.Width div 2;
  wa.Rect.Height := ListView1.Height; 
```

这似乎创建了一个工作区区域，您可以通过检查其 WorkArea 属性来确定项目是否与该工作区相关联。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T01:27:05.463

它是 VCL 对原生 List-View 控件的工作区的支持。请参阅[列表视图工作区](http://msdn.microsoft.com/en-us/library/bb774735%28v=vs.85%29#ListView_Working_Areas)。该文档提供了一个示例，说明它们的用途：

> [...] 多个工作区域可用于在一个视图中创建不同的区域。您可以在单个视图中创建具有不同含义的区域。例如，文件系统的视图可能有一个用于读/写文件的区域和另一个用于只读文件的区域。用户可以通过将项目放置在不同的工作区域来对它们进行分类。[...]

该文档还提到，您可以在边缘附近创建空边框，或者通过使用工作区导致通常不会出现滚动条。

VCL 的文档似乎没有太多遗漏。您可以添加和查询工作区。将项目重新定位到特定的工作区域，或询问它位于哪个工作区域。没有什么是自动的，你必须自己做。一个项目与工作区没有关联，您必须自己移动它（VCL 只是遍历工作区并检查项目和区域的坐标以找到项目所在的工作区）。

分类部分可能不是非常有用，因为无需控件本身的帮助就可以保留他/她自己的虚拟区域。关于边缘和滚动条的部分可能更重要。但我从未见过在应用程序中实现过这样的事情，包括操作系统本身。

* * *

布局控制的示例用法：

```
type
  TForm1 = class(TForm)
    Button1: TButton;
    ListView1: TListView;
    procedure Button1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  end;

var
  Form1: TForm1;

implementation

uses
  commctrl;

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
var
  R1, R2: TRect;
begin
  R1 := Rect(0, 0,
              ListView1.ClientWidth div 2, ListView1.ClientHeight div 2 + 10);
  R2 := Rect(ListView1.ClientWidth div 2 + 1, 0,
              ListView1.ClientWidth - 1, ListView1.ClientHeight div 2 + 10);

  ListView1.WorkAreas.Add.Rect := R1;
  ListView1.WorkAreas.Add.Rect := R2;

  ListView1.AddItem('Item 1', nil);
  ListView1.AddItem('Item 2', nil);
  ListView1.AddItem('Item 3', nil);
  ListView1.AddItem('Item 4', nil);
  ListView1.AddItem('Item 5', nil);
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  i: Integer;
begin
  for i := 0 to ListView1.Items.Count - 1 do begin
    ListView1.Items[i].Left := ListView1.WorkAreas[1].Rect.Left;
    ListView1.Items[i].Top := ListView1.WorkAreas[1].Rect.Top;
  end;
  ListView1.Arrange(arAlignTop);
end; 
```

初始视图：
![在此处输入图像描述](../Images/2c380de0d7cde0ac815586dac6f20b8e.png)
按下按钮后：
![在此处输入图像描述](../Images/7927aec38d99d761bba014f2c16658a0.png)

请注意，在第一张图片中，“第 5 项”不在任何工作区。在按钮单击处理程序中，我尝试将所有五个项目放在“右上角”工作区中。将“Item 5”放在那里后，控件决定踢出“Item-1”，因为所有五个都不适合。现在应该很明显，我从未使用过工作区，但我特意给出了这个例子，以便能够指出可能的怪癖。我所期望的是出现文档中提到的滚动条。

# php - 单一网站 - 许多企业，将每个个人帐户链接到 Facebook 帐户

> ID：10791706
> 
> 赞同：1
> 
> 时间：2012-05-29T00:15:10.853
> 
> 标签：php, facebook

我经营 www.yespanya.com

在网站上，每个企业都有自己的页面，里面充满了有用的信息。我的客户会定期添加折扣券、特别优惠和娱乐活动。

我想添加将每个客户帐户与他们自己的 Facebook 帐户相关联的功能，以便我们可以以编程方式更新他们的个人 Facebook 帐户 - 只需输入他们的用户凭据一次。

这样，当他们更新我们网站上的报价时，这将同时更新他们的 Facebook 页面。

我确信这是可能的，但不知道要寻找什么，或者我们应该使用任何相关的 API？

感谢任何帮助。

# installation - 使 MUI2 欢迎页面标签具有透明背景

> ID：10791707
> 
> 赞同：3
> 
> 时间：2012-05-29T00:15:16.033
> 
> 标签：installation, nsis

**编辑：**我发现解决方案见底部文字

**我正在尝试使 MUI2 欢迎页面的文本具有透明背景。**

我可以让文本具有 MUI1 的透明背景，但 MUI2 不具有透明背景（标签窗口保持白色背景）。*您还建议我只使用 MUI1 还是 MUI2 更好用？*

你能帮我让 MUI2 欢迎页面的标签具有透明背景吗？

相关代码（请参阅下面的所有代码，您可以编译以查看错误）：

```
!define MUI_PAGE_CUSTOMFUNCTION_SHOW WelcomePageShow
!insertmacro MUI_PAGE_WELCOME
Function WelcomePageShow
    # Why does the following code make the labels background transparent in MUI 
    # but NOT in MUI2???
    # What do I need to do to make it transparent in MUI2??

    ; Set transparent backgrounds.
    SetCtlColors $MUI_HWND 0xFFFFFF transparent
    !insertmacro SetTransparent $MUI_HWND 1201  # These aren't transparent in MUI2
    !insertmacro SetTransparent $MUI_HWND 1202  # These aren't transparent in MUI2

    # Make main white background a different colour
    GetDlgItem $R0 ${MUI_HWND} 1044
    SetCtlColors $R0 0x444444 0xff0000         # The background colour doesn't change in MUI2
    # Make smaller white background a different colour
    GetDlgItem $R0 ${MUI_HWND} 1018
    SetCtlColors $R0 0x444444 0x00ff00         # The background colour doesn't change in MUI2 
    Call RefreshParentControls
FunctionEnd 
```

所有代码：

```
!include MUI2.nsh   # change this to !include MUI.nsh to see how the code works successfully for MUI1
!include WinMessages.nsh
!include "LogicLib.nsh"

; Local bitmap path.
!define BITMAP_FILE test2.bmp

; --------------------------------------------------------------------------------------------------
; Installer Settings
; --------------------------------------------------------------------------------------------------
Name "Background Bitmap"
OutFile "bgbitmap.exe"
ShowInstDetails show

; --------------------------------------------------------------------------------------------------
; Modern UI Settings
; --------------------------------------------------------------------------------------------------
!define MUI_COMPONENTSPAGE_NODESC
!define MUI_FINISHPAGE_NOAUTOCLOSE
!define MUI_CUSTOMFUNCTION_GUIINIT MyGUIInit

; --------------------------------------------------------------------------------------------------
; Definitions
; --------------------------------------------------------------------------------------------------
!ifndef LR_LOADFROMFILE
    !define LR_LOADFROMFILE     0x0010
!endif
!ifndef LR_CREATEDIBSECTION
    !define LR_CREATEDIBSECTION 0x2000
!endif
!ifndef IMAGE_BITMAP
    !define IMAGE_BITMAP        0
!endif
!ifndef SS_BITMAP
    !define SS_BITMAP           0x0000000E
!endif
!ifndef WS_CHILD
    !define WS_CHILD            0x40000000
!endif
!ifndef WS_VISIBLE
    !define WS_VISIBLE          0x10000000
!endif
!define HWND_TOP            0
!define SWP_NOSIZE          0x0001
!define SWP_NOMOVE          0x0002
!define IDC_BITMAP          1500
!define stRECT "(i, i, i, i) i"
Var hBitmap

; --------------------------------------------------------------------------------------------------
; Pages
; --------------------------------------------------------------------------------------------------
!define MUI_PAGE_CUSTOMFUNCTION_SHOW WelcomePageShow
!insertmacro MUI_PAGE_WELCOME

!insertmacro MUI_LANGUAGE English

; --------------------------------------------------------------------------------------------------
; Macros
; --------------------------------------------------------------------------------------------------
; Destroy a window.
!macro DestroyWindow HWND IDC
    GetDlgItem $R0 ${HWND} ${IDC}
    System::Call `user32::DestroyWindow(i R0)`
!macroend

; Give window transparent background.
!macro SetTransparent HWND IDC
    GetDlgItem $R0 ${HWND} ${IDC}
    SetCtlColors $R0 0x444444 transparent
!macroend

; Refresh window.
!macro RefreshWindow HWND IDC
    GetDlgItem $R0 ${HWND} ${IDC}
    ShowWindow $R0 ${SW_HIDE}
    ShowWindow $R0 ${SW_SHOW}
!macroend

; --------------------------------------------------------------------------------------------------
; Functions
; --------------------------------------------------------------------------------------------------
Function MyGUIInit

    ; Extract bitmap image.
    InitPluginsDir
    ReserveFile `${BITMAP_FILE}`
    File `/ONAME=$PLUGINSDIR\bg.bmp` `${BITMAP_FILE}`

    ; Get the size of the window.
    System::Call `*${stRECT} .R0`
    System::Call `user32::GetClientRect(i $HWNDPARENT, i R0)`
    System::Call `*$R0${stRECT} (, , .R1, .R2)`
    System::Free $R0

    ; Create bitmap control.
    System::Call `kernel32::GetModuleHandle(i 0) i.R3`
    System::Call `user32::CreateWindowEx(i 0, t "STATIC", t "", i ${SS_BITMAP}|${WS_CHILD}|${WS_VISIBLE}, i 0, i 0, i R1, i R2, i $HWNDPARENT, i ${IDC_BITMAP}, i R3, i 0) i.R1`
    System::Call `user32::SetWindowPos(i R1, i ${HWND_TOP}, i 0, i 0, i 0, i 0, i ${SWP_NOSIZE}|${SWP_NOMOVE})`

    ; Set the bitmap.
    System::Call `user32::LoadImage(i 0, t "$PLUGINSDIR\bg.bmp", i ${IMAGE_BITMAP}, i 0, i 0, i ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) i.s`
    Pop $hBitmap
    SendMessage $R1 ${STM_SETIMAGE} ${IMAGE_BITMAP} $hBitmap

    ; Set transparent backgrounds.
    !insertmacro SetTransparent $HWNDPARENT 3
    !insertmacro SetTransparent $HWNDPARENT 1
    !insertmacro SetTransparent $HWNDPARENT 2
    !insertmacro SetTransparent $HWNDPARENT 1034
    !insertmacro SetTransparent $HWNDPARENT 1037
    !insertmacro SetTransparent $HWNDPARENT 1038

    ; Remove unwanted controls.
    !insertmacro DestroyWindow  $HWNDPARENT 1256
    !insertmacro DestroyWindow  $HWNDPARENT 1028
    !insertmacro DestroyWindow  $HWNDPARENT 1039

FunctionEnd

Function RefreshParentControls

    !insertmacro RefreshWindow  $HWNDPARENT 1037
    !insertmacro RefreshWindow  $HWNDPARENT 1038

FunctionEnd

Function WelcomePageShow

    # Why does the following code make the labels background transparent in MUI 
    # but NOT in MUI2???
    # What do I need to do to make it transparent in MUI2??

    ; Set transparent backgrounds.
    SetCtlColors $MUI_HWND 0xFFFFFF transparent
    !insertmacro SetTransparent $MUI_HWND 1201  # These aren't transparent in MUI2
    !insertmacro SetTransparent $MUI_HWND 1202  # These aren't transparent in MUI2

    # Make main white background a different colour
    GetDlgItem $R0 ${MUI_HWND} 1044
    SetCtlColors $R0 0x444444 0xff0000         # The background colour doesn't change in MUI2
    # Make smaller white background a different colour
    GetDlgItem $R0 ${MUI_HWND} 1018
    SetCtlColors $R0 0x444444 0x00ff00         # The background colour doesn't change in MUI2 
    Call RefreshParentControls
FunctionEnd

; Free loaded resources.
Function .onGUIEnd

    ; Destroy the bitmap.
    System::Call `gdi32::DeleteObject(i s)` $hBitmap

FunctionEnd

; --------------------------------------------------------------------------------------------------
; Dummy section
; --------------------------------------------------------------------------------------------------
Section "Dummy Section"
SectionEnd 
```

解决方案：

```
 Function WelcomePageShow
          # Sets background image
        System::Call `user32::LoadImage(i 0, t "$PLUGINSDIR\wb.bmp", i ${IMAGE_BITMAP}, i 0, i 0, i ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) i.s`
        Pop $hBitmap
        SendMessage $bitmapWindow ${STM_SETIMAGE} ${IMAGE_BITMAP} $hBitmap

           # Start solution
        SetCtlColors $mui.WelcomePage ${CTRL_COLOUR} transparent
        SetCtlColors $mui.WelcomePage.text ${CTRL_COLOUR} transparent
        SetCtlColors $mui.WelcomePage.title 0x333333 transparent

        !insertmacro DestroyWindow  $HWNDPARENT 1037
        !insertmacro DestroyWindow  $HWNDPARENT 1038
        !insertmacro DestroyWindow  $HWNDPARENT 1036 
        System::Call `user32::DestroyWindow(i $mui.WelcomePage.Image)`
        Call RefreshParentControls
    FunctionEnd 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T03:44:37.123

解决方案：

```
Function WelcomePageShow
      # Sets background image
    System::Call `user32::LoadImage(i 0, t "$PLUGINSDIR\wb.bmp", i ${IMAGE_BITMAP}, i 0, i 0, i ${LR_CREATEDIBSECTION}|${LR_LOADFROMFILE}) i.s`
    Pop $hBitmap
    SendMessage $bitmapWindow ${STM_SETIMAGE} ${IMAGE_BITMAP} $hBitmap

       # Start solution
    SetCtlColors $mui.WelcomePage ${CTRL_COLOUR} transparent
    SetCtlColors $mui.WelcomePage.text ${CTRL_COLOUR} transparent
    SetCtlColors $mui.WelcomePage.title 0x333333 transparent

    !insertmacro DestroyWindow  $HWNDPARENT 1037
    !insertmacro DestroyWindow  $HWNDPARENT 1038
    !insertmacro DestroyWindow  $HWNDPARENT 1036 
    System::Call `user32::DestroyWindow(i $mui.WelcomePage.Image)`
    Call RefreshParentControls
FunctionEnd 
```

# c# - 使用 SQL Server CE 数据库部署项目

> ID：10791708
> 
> 赞同：1
> 
> 时间：2012-05-29T00:15:25.643
> 
> 标签：c#, .net, entity-framework, sql-server-ce

我正在尝试部署一个使用`.SDF`文件和实体框架的应用程序。每当部署的应用程序尝试使用实体（连接到数据库）时，我都会收到错误消息：

> 在配置中找不到指定的商店提供程序，或无效。
> System.ArgumentException：找不到请求的 .Net Framework 数据提供程序。它可能没有安装。
> 在 System.Data.Common.DbProviderFactories.GetFactory（字符串 providerInvariantName）
> 在 System.Data.EntityClient.EntityConnection.GetFactory（字符串 providerString）

我的连接字符串如下所示：

```
<add name="DBEntities" 
    connectionString="metadata=res://*/DB_Model.csdl|res://*/DB_Model.ssdl|res://*/DB_Model.msl;
    provider=System.Data.SqlServerCe.3.5;
    provider connection string=&quot;Data Source=|DataDirectory|\Database\DB.sdf&quot;" 
    providerName="System.Data.EntityClient" /> 
```

我在某处读过可能需要引用 dll 的内容，`System.Data.SqlServerCe.3.5`但我不确定。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T07:27:15.963

您需要在目标系统上安装 3.5 SP2 运行时，或使用此处所述的私有部署：http: [//erikej.blogspot.com/2012/05/private-deployment-of-sql-server.html](http://erikej.blogspot.com/2012/05/private-deployment-of-sql-server.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:57:40.103

*   在您的项目属性下，在**Publish**选项卡上，单击**Application Files**。
*   查找**System.Data.SqlServerCe.dll**（可能通过选中**显示所有文件**框）。
*   确保其**Publish Status**为**Include**。

# c# - 远程桌面连接中的 SetForegroundWindow

> ID：10791709
> 
> 赞同：3
> 
> 时间：2012-05-29T00:15:28.263
> 
> 标签：c#, window, remote-desktop, setfocus

我在 C# 中有一个应用程序，它将密钥发送到另一个程序。为此，我在发送有效的密钥之前调用 SetForegroundWindow 方法。问题是当我使用 RDC 连接到计算机并最小化 RDC 窗口或断开连接时，不会发送密钥。

这是因为在 RDC 模式下，SetForegroundWindow 方法在最小化或断开连接状态下不起作用。我尝试过使用 SetActiveWindow、SetFocus 和 BringWindowToTop，但没有成功。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-10T13:05:16.157

这是很常见的问题。当您断开或最小化 RDP 窗口时，GUI 上下文会丢失。但是您可以保持 RDP 不最小化（焦点可以安全地丢失）。换句话说，如果您想继续在本地工作，只需关闭全屏模式并切换到另一个窗口。

在我们公司的测试团队使用主从方法：主主机启动远程连接并保持它们非最小化，直到每个 GUI 自动化任务完成。

# php - 重复分组的数字回显

> ID：10791710
> 
> 赞同：0
> 
> 时间：2012-05-29T00:15:48.953
> 
> 标签：php, mysql

我有一个名为“submission”的数据库，其中包含“submissionid”和“1adzip”字段。“1adzip”字段是一个邮政编码。

我正在尝试回显一个表格，该表格回显所有邮政编码，并将相同邮政编码的重复分组。我怎样才能做到这一点？下面的代码是我尝试过的，它返回空白结果。

```
$query2 = "SELECT submissionid, 1adzip
FROM submission
GROUP BY 1adzip
ORDER BY 1adzip ASC";       

$result2 = mysql_query($query2);

$arr2 = array(); 
echo "<table class=\"commentecho2\">";

while ($row2 = mysql_fetch_array($result2)) { 

    echo '<tr>';
    echo '<td>'.$row2["1adzip"].'</td>';
    echo '<tr>';

}
echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:35:14.463

您的查询可能有错误；您可能希望通过使用反引号来转义不以下划线或字母开头的字段：

```
SELECT submissionid, `1adzip`
FROM submission
GROUP BY `1adzip`
ORDER BY `1adzip` ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:02:31.590

您正在使用摘要查询（它包含一个`GROUP BY`子句），而您要总结的内容有点混乱。

试试这个查询而不是你给的那个。你可能会得到更好的结果。

```
SELECT count(*) howmany, 1adzip
  FROM submission
 GROUP BY 1adzip
 ORDER BY 1adzip ASC 
```

# ubuntu - 向新贵服务发送重新加载命令

> ID：10791711
> 
> 赞同：5
> 
> 时间：2012-05-29T00:15:56.020
> 
> 标签：ubuntu, upstart

如何`upstart`在不需要完全停止的情况下向启动的守护程序发送某种重新加载命令？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T00:40:25.560

`upstart`通常管理两种类型的进程：

*   运行一次以处理事件的程序
*   长期存在并为其他事物提供服务的守护进程

`SIGHUP`守护进程通常为请求守护进程重新读取和重新解析其配置文件的信号提供信号处理程序。(`SIGHUP`是挂机信号，与电话线或SSH协议连接或断开时可能来来去去的终端更相关。对于没有终端的程序，“挂断”他们的终端是没有意义的，所以信号不会被发送到守护进程，除非系统管理员操作。）

如果您可以修改程序以在收到信号时重新读取其配置`SIGHUP`，那么您可以使用标准`upstart` `reload service`命令重新加载配置文件。（你可以对这个信号做*任何事情*，但是系统管理员希望守护进程重新读取这个信号上的配置文件——做其他事情可能会令人困惑和烦人。）

# boost - 使用测试 dll 和生产 dll 时的链接问题

> ID：10791712
> 
> 赞同：0
> 
> 时间：2012-05-29T00:16:06.517
> 
> 标签：boost, boost-test

我想为 DLL 的内部组件编写单元测试，并且在测试项目中我只能访问导出的符号。我也想测试内部类，我不想仅仅为了测试而导出它们。我正在使用 boost 测试、visual studio 10 和动态链接。我得到的信息是

```
fatal error LNK1120: 1 unresolved externals 
```

有任何想法吗？

# php - php表单更新mysql

> ID：10791722
> 
> 赞同：0
> 
> 时间：2012-05-29T00:18:20.593
> 
> 标签：php, mysql, database

我正在尝试使用我创建的编辑表单中的新信息更新 mysql 数据库。我不能把手指放在哪里出了问题。该代码弹出一个mysql错误。有任何想法吗？

```
<?php
// connect to datebase
require "episodelist.db.php";
// real escape all strings
$season_num = mysql_real_escape_string($_POST['season_num']);
$eps_num = mysql_real_escape_string($_POST['eps_num']);
$temp_eps_num = mysql_real_escape_string($_POST['temp_eps_num']);
$title = mysql_real_escape_string($_POST['title']);
$inspired = mysql_real_escape_string($_POST['inspired']);
$descrip = mysql_real_escape_string($_POST['descrip']);

// update data in mysql database
$sql="UPDATE $season SET season_num='$season_num', eps_num='$eps_num', temp_eps_num='$temp_eps_num', title='$title', inspired='$inspired', descrip='$descrip' WHERE id='$id'";
$result=mysql_query($sql);

// if successfully updated.
if($result){
echo "Successful";
echo "<BR>";$result=mysql_query($sql);
echo "<a href='../episodelist_superadmin.html'>View result</a>";
}

else {
echo "Whoops: " . mysql_error(); ;
}
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:23:20.443

你似乎没有在`$season`任何地方定义。因此，它会导致您的查询语法出现问题。

就我个人而言，我会避免将变量直接放在字符串中，而是将它们连接起来（`"string".$var."more string"`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T16:33:26.650

我从季前删除了美元，它经过深思熟虑，现在一切正常。谢谢你的第二双眼睛：）

# android - 扫描带有注释的类的 Android 类路径

> ID：10791726
> 
> 赞同：3
> 
> 时间：2012-05-29T00:19:59.493
> 
> 标签：android, annotations, classpath

我正在寻找扫描类路径以获取注释的方法。这是在 Android 平台上，这就是为什么到目前为止我发现的所有标准方法似乎都不起作用的原因。

我发现唯一可行的解​​决方案是：http: [//mindtherobot.com/blog/737/android-hacks-scan-android-classpath/](http://mindtherobot.com/blog/737/android-hacks-scan-android-classpath/)但它更像是一个黑客而不是一个解决方案，所以我宁愿不采取那条路线，加上该解决方案实际上加载了所有类。我更喜欢在不加载类的情况下扫描注释的解决方案。

# php - 如何在 Linux 中从命令行生成 xls 文件？

> ID：10791731
> 
> 赞同：2
> 
> 时间：2012-05-29T00:20:59.377
> 
> 标签：php, mysql, excel, export-to-excel

我需要每天在我的网站上自动更新 Excel 中的一些价目表。我为此使用了 PHPExcel，但生成 1 个只有 40000 行和 11 列的文件需要大量内存（大约 900 Mb），这在我的 Linux 托管服务器上不可用。所有 Google 结果仅指向 PHPExcel。我想知道是否有任何命令行实用程序可以做同样的事情，但消耗更少的内存，所以我可以使用 cron 在我的 Linux 服务器上运行它？我需要在我的 Excel 文件中使用一些格式和公式，这使得 CSV 和 HTML 成为非选项。

当然，我可能会从 Windows Server 机器连接到 MySQL，在那里在实际的 Excel 中生成 Excel 文件，然后将它们上传到服务器，但这个选项对我来说似乎很 hacky。

**补充：** 我现在在 PERL、Python 和 Java 模块之间做出选择，选择在大文件上消耗更少资源且更易于使用的模块；欢迎对此主题发表任何评论。也接受任何其他解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:28:17.307

您应该考虑使用 java 和[Apache POI](http://poi.apache.org/)

它具有良好的性能，甚至比 Windows 上的 MS Office 互操作程序集更好（基于我自己的经验）。

它还拥有庞大的用户社区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:36:23.913

根据页面的复杂性，您可以尝试手动构建 xlsx 文件。xlsx 规范非常复杂，但我已经看到了创建非常简单的表的示例。

也许这个[链接](http://www.techrepublic.com/article/convert-an-xml-file-into-an-excel-spreadsheet-with-this-technique/6163451)可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T02:30:15.630

使用 PERL 和 John McNamara 的模块 Spreadsheet::WriteExcel 生成各种精美的电子表格，我取得了非常好的结果。但这需要编程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T16:15:18.847

您可以尝试从 ResultSet 在 Java 上的[Templater中构建它。](http://templater.info/)我们正在使用更多 Java 示例更新站点，但代码看起来会与此类似。

ITemplaterDocument doc = Configuration.Factory.Open(file); doc.process（结果集）；doc.flush();

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-04T08:12:49.503

对我来说最简单的选择是使用[python-excel](http://www.python-excel.org/)库。虽然我从来没有在 python 上写过任何东西，但我只花了几个小时就可以真正使用它，而且它的运行速度比 PHPExcel 快得多，并且消耗的内存更少（我最大的文件大约 300 Mb，而 900 Mb php）。但是，如果您正在寻找类似问题的解决方案，其他答案中提供的工具也可能适合您的需求。

# ios - 为 UITableView 提取 HTML 表格

> ID：10791733
> 
> 赞同：1
> 
> 时间：2012-05-29T00:21:22.407
> 
> 标签：ios, uitableview, html-content-extraction

我正在尝试为 iPhone 制作一个基于 UITableView 的应用程序。我之前通过从 RSS 提要中提取数据来做到这一点，但是对于这个应用程序，我正在尝试使用来自网页的数据。数据采用 Web 表格格式 (http://www.roblox.com/Forum/Default.aspx)，并且由于是论坛，因此具有不同的层次结构。

我应该如何解析这些数据？有我可以使用的框架吗？

再一次，我想使用的数据是这个网站上的表格（论坛） - [http://www.roblox.com/Forum/Default.aspx](http://www.roblox.com/Forum/Default.aspx)。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:04:22.820

我真的推荐[Hpple](https://github.com/topfunky/hpple)。这是一个非常好的 XML/HTML 解析器。

要使用它，您需要`${SDKROOT}/usr/include/libxml2`在项目选项中添加“标题搜索路径”并添加`-lxml2`到“其他链接器标志”。

然后，将其拖到您的代码中：`TFHpple.h`, `TFHpple.m`, `TFHppleElement.h`, `TFHppleElement.m`, `XPathQuery.h`, `XPathQuery.m`.

在代码中添加：

```
NSData *htmlData = [[NSString stringWithContentsOfURL:[NSURL URLWithString: @"http://www.roblox.com/Forum/Default.aspx"]] dataUsingEncoding:NSUTF8StringEncoding];

TFHpple *xpathParser = [[TFHpple alloc] initWithHTMLData:htmlData];
NSArray *elements  = [xpathParser searchWithXPathQuery:@"//a[@class='forumTitle']"];

for(int i = 0; i < [elements count]; i++) {
    TFHppleElement *element = [elements objectAtIndex:i];
    NSString *string = [element content];
    NSLog(@"%@", string);
}

[xpathParser release];
[htmlData release]; 
```

我们在每个`a`with`class = forumTitle`和it`TFHppleElement`中创建了一个循环。`NSLog`

要了解更多信息，请查看[XPath Syntax](http://www.w3schools.com/xpath/xpath_syntax.asp)。还要检查[一个教程](http://blog.objectgraph.com/index.php/2010/02/24/parsing-html-iphone-development/)。

现在你问：为什么要使用 Hpple？它更快，更容易使用，并且有很棒的教程。

希望对您有所帮助！

# ios - “架构 i386 的未定义符号”尝试使用 iCarousel

> ID：10791735
> 
> 赞同：3
> 
> 时间：2012-05-29T00:21:47.323
> 
> 标签：ios, xcode4

我正在尝试使用 iCarousel（https://github.com/nicklockwood/iCarousel）并将 iCarousel.h 和 iCarousel.m 添加到我的项目中（使用 Xcode 4.3.1）。

但是在尝试分配 iCarousel 的实例时出现链接器错误（iCarousel 继承自 UIView）：

```
self.carousel = [[iCarousel alloc]initWithFrame:self.view.bounds]; 
```

完整的链接器错误是：

```
Ld "/Users/Me/Library/Developer/Xcode/DerivedData/IMS-eyffphshuxtblseccxpfluamxudo/Build/Products/Debug-iphonesimulator/MyApp.app/MyApp" normal i386
cd /Users/Me/Desktop/IMS/3.2
setenv MACOSX_DEPLOYMENT_TARGET 10.6
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -L/Users/Me/Library/Developer/Xcode/DerivedData/IMS-eyffphshuxtblseccxpfluamxudo/Build/Products/Debug-iphonesimulator -F/Users/Me/Library/Developer/Xcode/DerivedData/IMS-eyffphshuxtblseccxpfluamxudo/Build/Products/Debug-iphonesimulator -filelist "/Users/Me/Library/Developer/Xcode/DerivedData/IMS-eyffphshuxtblseccxpfluamxudo/Build/Intermediates/IMS.build/Debug-iphonesimulator/MyApp.build/Objects-normal/i386/MyApp.LinkFileList" -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -fobjc-arc -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=50100 -framework AssetsLibrary -framework SystemConfiguration -framework MessageUI -framework EventKit -framework MapKit -framework QuartzCore -framework AddressBook -framework UIKit -framework Foundation -framework CoreGraphics -o "/Users/Me/Library/Developer/Xcode/DerivedData/IMS-eyffphshuxtblseccxpfluamxudo/Build/Products/Debug-iphonesimulator/MyApp.app/MyApp"

Undefined symbols for architecture i386:
"_OBJC_CLASS_$_iCarousel", referenced from:
objc-class-ref in IMSCarouselViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有一些示例项目演示了 iCarousel 的使用，并且可以很好地编译。我认为我的项目和示例项目之间肯定存在一些构建设置差异，但我不知道它们可能是什么，也不知道如何找出。是否有任何技巧可以破译链接器消息以找出问题所在？

（我使用与示例项目中相同的框架/库）

TIA

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T00:42:42.877

即使您在项目中添加了 .h 和 .m 文件，听起来它们也没有被编译。在 File Inspector 中选择 iCarousel.m 文件（在项目的左侧），然后查看 File Inspector 中的“Target Membership”设置。

它看起来像这样（只会选择“iCarousel.m”，而不是“AppDelegate.m”）：

![确保为您的 .m 文件选择了 Target Membership](../Images/77aadfbd6f649c902ca57a67c935f6af.png)

# python - 默认为键的Python字典？

> ID：10791738
> 
> 赞同：21
> 
> 时间：2012-05-29T00:22:04.823
> 
> 标签：python, dictionary, defaultdict

有没有办法让 defaultdict 默认返回密钥？或者一些具有等效行为的数据结构？即，在初始化字典之后`d`，

```
>>> d['a'] = 1
>>> d['a']
1
>>> d['b']
'b'
>>> d['c']
'c' 
```

我只看到默认字典采用不带参数的函数，所以我不确定除了创建一种新的字典之外是否还有其他解决方案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-29T00:28:39.790

我会覆盖以下`__missing__`方法`dict`：

```
>>> class MyDefaultDict(dict):
...     def __missing__(self, key):
...         self[key] = key
...         return key
...
>>> d = MyDefaultDict()
>>> d['joe']
'joe'
>>> d
{'joe': 'joe'} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-29T00:36:54.487

**编辑：** 糟糕，我刚刚意识到我文件中的代码最初来自另一个 stackoverflow 答案！[https://stackoverflow.com/a/2912455/456876](https://stackoverflow.com/a/2912455/456876)，去投票。

这就是我使用的 - 它是一个 defaultdict 变体，它将键作为参数传递给默认值工厂函数，该函数作为参数传递给**init**，而不是没有参数：

```
class keybased_defaultdict(defaultdict):
    def __missing__(self, key):
        if self.default_factory is None:
            raise KeyError(key)
        else:
            value = self[key] = self.default_factory(key)
            return value 
```

这是您想要的用途：

```
>>> d = keybased_defaultdict(lambda x: x)
>>> d[1]
1
>>> d['a']
'a' 
```

其他可能性：

```
>>> d = keybased_defaultdict(lambda x: len(x))
>>> d['a']
1
>>> d['abc']
3 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T00:59:32.027

如果你不想继承 dict，你可以尝试使用

```
d.get('a', 'a')
d.get('b', 'b')
d.get('c', 'c') 
```

我认为为此目的更清晰，更不神奇

如果你是一个 DRY 狂热者并且只有单个字符键，你可以这样做:)

```
d.get(*'a'*2)
d.get(*'b'*2)
d.get(*'c'*2) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-29T00:27:30.973

您可能必须编写自己的类来继承（或类似）`defaultdict`并覆盖该`__getitem__`方法。

# java - 初始化final但不是invar？

> ID：10791740
> 
> 赞同：0
> 
> 时间：2012-05-29T00:22:39.097
> 
> 标签：java, boolean, final

我一直在做一个街机视频游戏，我需要一些关于子弹方向的帮助。现在我只有一颗不会移动的子弹，它只是在它开始的地方绘制（我正在一步一步地做所有事情）。问题是我不知道子弹会​​向左还是向右。我有一个名为 bullet 的布尔变量，当子弹发射时（当 X 键被释放时）它变为真。

```
 public void pistol( boolean right ) {

    if( right ) {
        dbg.fillRect( barrelRightX, barrelY, barrelWidth, barrelHeight );
        dbg.fillRect( handleRightX, handleY, handleWidth, handleHeight );
    }
    else {
        dbg.fillRect( barrelLeftX, barrelY, barrelWidth, barrelHeight );
        dbg.fillRect( handleLeftX, handleY, handleWidth, handleHeight );
    }

    if( bullet ) {

        if( right )
            dbg.drawOval( barrelRightX + barrelWidth, barrelY, 5, 5 );

        else
            dbg.drawOval( barrelLeftX - 5, barrelY, 5, 5 );

    }
} 
```

if(bullet) 之前的第一段代码只是画手枪。我把它放在那里，这样你就可以看到 right 是一个布尔参数。基本上这意味着如果子弹已经发射并且手枪朝右，那么您将绘制子弹，这样它看起来就好像它是从枪管中出来的一样，如果子弹已经发射并且它没有朝右（这显然意味着它朝左）然后你会画它，所以它看起来就像它通常会那样出来。问题是，由于运行整个程序有一个巨大的动画循环，所以当我发射子弹并改变手枪的方向（从右到左或从左到右）时，子弹会改变位置，这不应该发生。我尝试制作子弹最终，但我需要它在释放 X 键时变为真时进行更改。所以，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T00:28:25.317

`final`只说不能重新分配 [member] 变量（或者不能扩展类以及有关方法的其他内容；-）。它*没有*说明对象的*可变性*。我也没有在代码中看到它的用法......

无论如何，为什么不在开枪*时**创建*一个新的 Bullet [对象] ？也就是说，“方向”和“初始位置”是 Bullet 在创建时已知的方面。这允许产生和处理 [多个独立] 子弹，而不必担心不必要的交互......（1 个子弹只是 N 子弹的特例）。

# wpf - ListBox 的选中项编号

> ID：10791741
> 
> 赞同：1
> 
> 时间：2012-05-29T00:22:44.797
> 
> 标签：wpf, xaml

我有一个看起来像这样的 ListBox：

```
<ListBox>
    <ListBoxItem>Item1</ListBoxItem>
    <ListBoxItem>Item2</ListBoxItem>
    <ListBoxItem>Item3</ListBoxItem>
    <ListBoxItem>Item4</ListBoxItem>
</ListBox> 
```

有没有办法查看所选项目的数组？我计划根据 ListBoxItem[Number?] 执行特定操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:31:39.693

我认为您正在寻找[`SelectedItem`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selecteditem.aspx)房产，或者可能是[`SelectedIndex`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedindex.aspx)房产和[`Items`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.items.aspx)房产。或者也许是[`SelectedItems`](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.selecteditems.aspx)财产。你的问题不是很清楚你想要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:50:35.827

您可以使用以下示例使用数组语法访问列表框的项目，但请注意，还有更多更容易解决的方法。我也更喜欢上面现有的答案。

在下面添加以下命名空间：

```
using System.Windows.Controls.Primitives; 
```

然后尝试编写以下代码。

```
EX
        ListBox x = new ListBox();
        ListBoxItem[] y = x.GetVisualDescendants().OfType<ListBoxItem>().ToArray();
        y[0].Content = "Foo"; 
```

# javascript - 为什么我不能将 jquery 选择器对象从内联 HTML 元素传递给函数？

> ID：10791743
> 
> 赞同：0
> 
> 时间：2012-05-29T00:23:00.570
> 
> 标签：javascript, jquery

我遇到了一个意外错误，我在调试时遇到了一些烦人的问题。我得到的错误是这样的：

`Uncaught SyntaxError: Unexpected token }`

这是 HTML：

```
<html>
<head>
<script type="text/javascript"src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>
<body>

<form class="search" action="search" method="get">
<input type="text" id="search-string" />
<button type="button" onclick="return clearInputValue( $("#search-string") )">
<span class="clear-icon"></span>
</button>
</form>

 <script>
 var  clearInputValue = function(a) {

 // Ultimately I will check if the object passed to this function has a value greater than 1, and if so, I will clear the input

   return false;

 };

 </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:24:31.013

您需要使用一组不同的引号。

```
<button type="button" onclick="return clearInputValue( $('#search-string') )"> 
```

注意单引号。

此外，作为旁注，不鼓励使用内联 javascript。将您的内容 (html) 与您的行为 (javascript) 分开会更好，就像您对演示文稿 (css) 所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:26:09.067

一方面，您只是提前终止了字符串。将其更改为：

```
onclick="return clearInputValue($('#search-string'))" 
```

其次，您应该使用 jQuery 来附加事件。

```
$(function(){

    function clearInputValue(a) {
        return false;
    };

    $('button').on('click',function(){
        clearInputValue($('#search-string'));
    });

}); 
```

# php - 通过PHP与POS终端通信

> ID：10791745
> 
> 赞同：1
> 
> 时间：2012-05-29T00:23:19.437
> 
> 标签：php, terminal, point-of-sale

知道 PHP 如何与 POS 终端通信吗？沟通 = 读取数据、读取状态、写入数据（发送客户必须支付的金额）。

主要的想法是最后客户所要做的就是写下他的 PIN 并按下 OK 按钮。

PHP 和 POST 终端连接在同一个网络中。如有必要，POS 终端可以通过串行电缆连接到 Linux 机器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T17:46:57.057

你说的。

Fox 示例，使用串口。

我向您保证，如果您询问 POS 设备的公司供应商，您可以获得程序员参考，以便了解通讯。使用串行端口的协议。

首先询问供应商。

# .net - 查询 EF 并将结果（记录）保存到列表中？

> ID：10791750
> 
> 赞同：1
> 
> 时间：2012-05-29T00:24:15.760
> 
> 标签：.net, linq, entity-framework, c#-4.0

我有一个`List`。`QuestionData`该类`QuestionData`解释如下：

```
class QuestionData
{
    public string Question { get; set; }
    public List<Option> Answers { get; set; }
} 
```

我使用 EF 作为 ORM（注意：`Question`两者都`Option`使用的`QuestionData`是 EF 的自动生成的实体）。

两个表（`Question`s 和`Option`s）都有 PK-FK 关系。我想填写列表，`QuestionData`因为我必须`Question`在它们下显示 s 和答案。我该如何填写`QuestionData`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:41:12.777

为了扩展 Yeonho 的答案，我认为您可能需要这样的东西：

```
using(QuestionContext context = new QuestionContext())
{
    List<QuestionData> questionDatas = 
       context.Questions.Select(q => new QuestionData()
       {
          Question = q,
          Answers = q.Options.ToList()
       });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:57:03.363

```
using(QuestionContext context = new QuestionContext())
{
    List<QuestionData> questionDatas = 
       context.Questions.Select(q => new QuestionData()
       {
          Question = q.Value,
          Answers = q.Options.ToList()
       });
} 
```

# php - 如何组织一组模块化 Div

> ID：10791751
> 
> 赞同：0
> 
> 时间：2012-05-29T00:24:22.470
> 
> 标签：php, mysql, css, database, dataset

我正在编写包含帖子流的网站部分。这些帖子大小不一，但只包含文字。我想做的是从服务器获取帖子的文本，然后：

1.  按它们包含的字符数将它们组织成大、中和小尺寸的帖子。![在此处输入图像描述](../Images/ebdc5ce0e5d2b2da1ecc5497e246ca5b.png)

2.  将帖子组合成一个堆栈，以便在显示时，所有帖子都与边缘齐平。这要求每行帖子的宽度相同。![在此处输入图像描述](../Images/dd2b36e9dd13a59a9d6c0167d88bf2cf.png)

帖子位于一个 div 中，该 div 设置为在帖子溢出时自动将其放在下一行，因此唯一的问题是以正确的顺序将帖子放置在 div 中。

例如，图/图像 2 的代码是：

```
<div class="small_posts" ></div><div class="medium_posts"></div>
<div class="medium_posts"></div><div class="small_posts" ></div>
<div class="small_posts" ></div><div class="tiny_posts"  ></div><div class="tiny_posts"></div> 
```

帖子的文本来自 MySQL 数据库的线性数组，我正在使用 PHP 接收和显示它。

我的问题不是如何在 PHP 中实现这一点，而是*首先如何设计一个算法来做到这一点*。

到目前为止，我尝试的设计都是粗制滥造的黑客，质量太低，无法提及。

我将非常感谢有关如何设计一种算法以有效地将这些帖子分类为刷新行的一些建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T00:10:12.327

您还可以使用 javascript 找到解决方案 查看此插件[http://masonry.desandro.com/](http://masonry.desandro.com/)

# ruby-on-rails - 数字（货币）成英文单词

> ID：10791752
> 
> 赞同：0
> 
> 时间：2012-05-29T00:24:22.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1

我有一个生成发票的应用程序。该系统适用于三种货币：英镑、美元和欧元。作为要求的一部分，发票必须以英文单词显示总金额。

例如：
100.50 英镑 - 一百英镑五十便士。
100.50 美元 - 一百美元和五十美分。
€100.50 - 一百欧元五十美分。

我从 2010 年找到[了这篇](https://stackoverflow.com/questions/3966159/number-to-english-word-conversion-rails)文章，但它并没有真正解决我的问题。我想知道将数字转换为包括货币在内的单词的最佳方法是什么。
我正在尝试寻找一颗宝石来帮助我解决这个问题，但我可以找到......
非常欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:51:05.423

您链接的帖子提到了语言学.gem - 因为它可以为您转换数字，您需要做的就是拆分主要和次要单位（即美元和美分/磅和便士），处理每个，然后重新组合成一个字符串带有主要和次要单位名称，即

```
majorUnit.en.numwords dollars [and minorUnit.en.numwords cents]
...
puts 100.en.numwords + " dollars and " + 50.en.numwords + " cents"
# => 100 dollars and fifty cents 
```

[语言学.gem](http://rubydoc.info/gems/linguistics/1.0.9/frames)的一个好处是，当您只有一个主要/次要单位时，它还可以为您处理单数/复数，例如：

```
"penny".en.plural
# => "pence" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-19T04:06:48.690

```
def self.subhundred number
  ones = %w{zero one two three four five six seven eight nine
        ten eleven twelve thirteen fourteen fifteen
        sixteen seventeen eighteen nineteen}
  tens = %w{zero ten twenty thirty fourty fifty sixty seventy eighty ninety}

  subhundred = number % 100
  return [ones[subhundred]] if subhundred < 20
  return [tens[subhundred / 10], ones[subhundred % 10]]
end

def self.subthousand number
      hundreds = (number % 1000) / 100
      tens = number % 100
      s = []
      s = subhundred(hundreds) + ["hundred"] unless hundreds == 0
      s = s + ["and"] if hundreds == 0 or tens == 0
      s = s + [subhundred(tens)] unless tens == 0
      s
end

def self.decimals number
          return [] unless number.to_s['.']
          number = number.to_s.split('.')[1]  
          puts "num ---#{number}"
          digits =  subhundred number.to_i if number.to_i > 0
          #digits.present? ? ["and"] + digits + ['cents'] : []
           digits.present? ? ["and"] +  ['cents']  + digits : []  
end
def self.words_from_numbers number
          steps = [""] + %w{thousand million billion trillion quadrillion quintillion sextillion}
          result = []
          n = number.to_i
          steps.each do |step|
            x = n % 1000
            unit = (step == "") ? [] : [step]
            result = subthousand(x) + unit  + result unless x == 0
            n = n / 1000
          end
          result = ["zero"] if result.empty?
          result = result + decimals(number)

          result.join(' ').gsub('zero','').strip
end

 OutPut :  

  puts words_from_numbers(440100) => " US DOLLARS FOUR HUNDRED  FOURTY  THOUSAND AND ONE HUNDRED ONLY" 
```

# sharepoint - 控制 SharePoint 组 A 从组 B 上传的文档的访问权限

> ID：10791755
> 
> 赞同：2
> 
> 时间：2012-05-29T00:24:33.107
> 
> 标签：sharepoint, sharepoint-2010

根据问题的标题，我想知道我是否有以下设置：

1 个网站集 2 个 SharePoint 组（A 和 B），其中包含 1 个 AD 组作为其成员。

我可以在 sharepoint 的用户权限内限制 SharePoint Group A 从 SharePoint Group B 上传的文档的可见性吗？即将它们存储在同一个库中，但 B 组不应该知道它的存在？

1.  这可以通过 SharePoint 组权限配置来完成吗？
2.  如果选项 1 不可行，我可以通过自定义控件执行此操作吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:19:37.327

如果我正确地理解了你。根据个人经验，管理文档级别的权限很快就会变得一团糟！

我猜 A 组可以看到 B 组的文档

这可能不是最好的解决方案，但会向库中添加一条额外的元数据。

在添加时找出当前用户上传文档的内容是安全的一部分，并将数据添加到您的新字段中，说明 a、a 和 b 或 b

拥有一个自定义显示，该显示还寻求当前用户的权限级别，并获取他们有权访问的有关该额外元数据字段的所有文档并显示它们。

在库中将过滤器设置为由 [我] 创建，这将阻止他们查看其他人的文档，但他们已上传到库中的文档除外。

如果您需要更清晰的信息，请告诉我。这在非常高的水平上解释了一个可能的解决方案。

# c++ - 删除和带有数据指针的节点？

> ID：10791757
> 
> 赞同：2
> 
> 时间：2012-05-29T00:25:03.633
> 
> 标签：c++, pointers, memory-management, nodes

将`delete`指向 struct 的指针`foo`：

```
struct foo
{
    bar * baz;
}; 
```

指向结构`baz`：

```
struct baz
{
    int arr;
}; 
```

还`delete`/释放指向的内存`baz`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T00:27:06.120

不，删除不会以这种方式“级联”。

但是，如果您有一个*析构函数*for `foo`，那么您可以`delete baz`在该析构函数中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T00:27:12.460

不，您需要在删除 foo 实例之前手动删除 baz。大多数典型的开发人员都会有 foo delete baz 的析构函数。

```
struct foo
{
    bar * baz;
    ~foo()
    {
        delete baz;
    }
}; 
```

# iphone - 核心动画离屏到屏幕动画

> ID：10791760
> 
> 赞同：3
> 
> 时间：2012-05-29T00:26:11.270
> 
> 标签：iphone, objective-c, ios, core-animation, core-graphics

在我正在制作的应用程序中，我试图让一个按钮在屏幕外启动并在屏幕上移动。我不确定如何从屏幕外的按钮开始，但我知道一旦我弄清楚了，我可以执行以下代码：

```
[UIView beginAnimation:@"animate" context: nil];
[UIView setAnimationDuration:3];
self.myButton.frame = CGRectMake (20, 100, 40, 80);
//Other animations
[UIView commitAnimations]; 
```

此外，在该行`[UIView beginAnimation:@"animate" context:nil];`中，上下文参数是否要求 CGContextRef？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T00:49:22.537

我假设您正在询问如何让按钮从屏幕外动画到屏幕上，为此只需将按钮原点位置设置为位于屏幕外的坐标。

```
self.myButton.frame = CGRectMake(-80, 100, 40, 80); 
```

完成此操作后，您可以使用发布的代码在屏幕上制作动画。请记住，按钮将从第一个位置移动到第二个位置，这意味着如果您使用我使用的坐标，按钮将从左侧移动到屏幕上，而 y 位置不会改变。请记住，在 setAnimationDuration 中分配的时间内，您将按钮放置得越远，它必须移动到屏幕上的速度就越快。

所以从左边动画到屏幕上

```
self.myButton.frame = CGRectMake(-80, 100, 40, 80);
// begin animation block    
[UIView beginAnimations:@"animate" context: nil];
[UIView setAnimationDuration:3];
self.myButton.frame = CGRectMake (20, 100, 40, 80);
// commit frame changes to be animated
[UIView commitAnimations]; 
```

此外，如果该按钮以前在屏幕上，它似乎会从屏幕上传送，然后在使用该代码时滑回。

哦，要回答您关于上下文的问题，不，它不必是 CGContextRef，它可以是任何数据类型（只要它是对象而不是原始数据）。它基本上是动画发生时传递给委托的数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T00:56:19.180

BeginAnimation:context: 在 iOS 4.0 或更高版本中不鼓励使用，您应该使用基于块的方法之一。您应该设置原始帧，使其不在屏幕上。这是一个稍微延迟后将按钮从右侧移入的示例：

```
self.myButton.frame = CGRectMake (340, 250, 40, 80);
    [self.view addSubview:myButton];
    [UIView animateWithDuration:5 delay:.2 options: UIViewAnimationOptionLayoutSubviews animations:^{
    self.myButton.frame = CGRectMake (140, 250, 40, 80);
    //Other animations
    }
     completion:nil]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T00:58:51.877

如果您不使用 xibs，您可以在屏幕外设置按钮的框架`viewDidLoad`（如果您使用的是 xibs，请将其滑出视图）：

```
 //create the button or get it from the xib
 CGRect rect = self.myButton.frame;
 rect.origin.x=-200;//or a good point to hide the button
 self.myButton.frame=rect; 
```

然后当你想为按钮设置动画时，你可以使用块动画：

```
 [UIView animateWithDuration:0.3f delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{
        self.myButton.frame=SET_YOUR_FRAME;
    } completion:^(BOOL finished)]; 
```

有关上下文，请参阅[文档](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/uiview_class/uiview/uiview.html%23//apple_ref/occ/clm/UIView/beginAnimations%3acontext%3a)

# clojure - 延迟是否应该被视为不可变的值？

> ID：10791762
> 
> 赞同：3
> 
> 时间：2012-05-29T00:26:50.480
> 
> 标签：clojure, functional-programming, immutability, lazy-evaluation

我是 Clojure / 使用不可变值编程的函数式方法的忠实粉丝。

但是我不确定[延迟](http://richhickey.github.com/clojure/clojure.core-api.html#clojure.core/delay)是否应该被视为一个不可变的值（假设你延迟一个纯函数）。我对较大的不可变数据结构中存在一个或多个延迟的情况特别感兴趣。

例如包含延迟的向量：

```
[1 2 (delay (reduce + (range 1000)))] 
```

据我所见，这表现得好像它是一个不可变的值，因为在您强制其评估之前您看不到延迟的结果 - 然后结果被缓存，之后该值永远不会改变。

以这种方式将延迟视为不可变值有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T02:34:34.653

延迟模拟通常称为*thunk*的东西，它是对尚未评估的表达式的引用，一旦被强制，它就会被其结果替换，并且此后是不可变的。Haskell 使用这种内部可变的 thunk 来模拟非严格评估。该表达式`[1, 2, foldl1 (+) [0..1000]]`名义上与其在具有严格评估的语言中的显式延迟等效项相同。

当然，如果延迟对象中使用的函数是纯函数，则将其视为不可变也没有什么坏处。您可以通过以下几种方式来考虑这一点：

*   根据定义，纯函数可以用其结果替换。

*   局部突变（在这种情况下是延迟对象）不会使函数不纯。

当然，Clojure 不区分纯函数和不纯函数，因此作为开发人员，您需要认真对待它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T04:13:53.840

`delay`是一个“价值生产者”，就像一个函数是一个价值生产者，只是`delay`让“价值生产者代码”懒惰地执行，即当它被要求提供价值时，而不变性是正在产生的价值的属性因此，可以将生成的值视为不可变的，就像函数调用一样。这是关于产生的价值，但如果你的功能正在产生副作用，那么你可能会遇到其他问题，但产生的价值仍然是不可变的

# javascript - jQuery $.post 基础知识

> ID：10791763
> 
> 赞同：0
> 
> 时间：2012-05-29T00:26:54.823
> 
> 标签：javascript, jquery

我只是在学习如何使用 jquery，而且我很困惑。这是我正在尝试做的事情（出于练习/学习目的）：

1.  接受输入
2.  使用 jquery 将输入发布到 div 标签中

这是我的代码..但它不工作

```
<script type="text/javascript">
function test(data) {
$.post("<?php echo $_SERVER['PHP_SELF']; ?>", function(data) {
    $("#lol").innerHTML = data;
});
}
</script>

<form action="" onsubmit="test($(this.children()))" method="POST">
<input type="hidden"
    value="derp" />
<input type="text"
    name="herp" />
<a href="javascript:void(0)"
    onclick="test($(this).parent())">
    Submit
</a>
</form>
<div id="lol">...</div> 
```

一些帮助/教程解释绝对很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:03:34.663

该`data`变量被滥用。如果你想通过你的 post 请求发送数据，你会想要这样的东西：

```
function test(post_data_array) {
    $.post(
        "<?php echo $_SERVER['PHP_SELF']; ?>",
        post_data_array,
        function(response_data) {
            $("#lol").innerHTML = data;
        }
    );
} 
```

在您的示例中，根本没有发送表单数据。希望这可以帮助！

**jQuery $.post() 参考：** [http ://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

# linq - 编写一个 LINQ 查询以获取布尔 sharepoint2010 字段的计数

> ID：10791765
> 
> 赞同：1
> 
> 时间：2012-05-29T00:27:08.847
> 
> 标签：linq, sharepoint, sharepoint-2010

我有一张桌子：

用户名|已完成
Moran|0
Moran|1
Moran|1
Moran|0
Russ|1
Russ|1
Russ|1
James|0
James|0
James|1

我需要一个 LINQ 查询（或 CAML，因为这是 Sharepoint 2010），它将拉回以下结果：

来自竞争列的不同用户名和 0 计数。这将表明用户 Moran 有 2 个未完成的任务，Russ 没有，James 有 2

莫兰|2 拉斯|0 詹姆斯|2

以下查询适用于 SQL

```
SELECT DISTINCT a.UserName, (select count(*) FROM AmexTransactions WHERE Completed = 0 AND UserName = a.UserName) FROM AmexTransactions a 
```

我需要在 LINQ 或 Sharepoint 2010 对象中使用它，并将数据存储在 SP2010 列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T06:13:38.620

尝试这个：

```
var result = dataContext.AmexTransactions
                        .GroupBy(x => x.UserName)
                        .Select(g => new
                        {
                            UserName = g.Key,
                            IncompleteTasks = g.Count(x => x.Completed == 0)
                        })
                        .ToList(); 
```

# javascript - JQueryUI 菜单选择事件未触发

> ID：10791768
> 
> 赞同：3
> 
> 时间：2012-05-29T00:27:26.620
> 
> 标签：javascript, jquery, jquery-ui, events, jquery-ui-menu

根据[http://docs.jquery.com/ui/menu#event-select](http://docs.jquery.com/UI/Menu#event-select)的文档 -选择（单击？）时应触发事件，但它没有任何操作。我错过了什么吗？

```
<!DOCTYPE html>
<html>
<head>
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

<link href="http://view.jqueryui.com/menu/themes/base/jquery.ui.menu.css" rel="stylesheet" type="text/css"/>
<script src="http://view.jqueryui.com/menu/ui/jquery.ui.menu.js"></script>

  <script>
  $(document).ready(function() {
    $("ul").menu({
      select: function(event, ui){
        alert('selected');
      }
    });
  });
  </script>
</head>
<body style="font-size:62.5%;">
  <ul>
  <li><a href="#">Aberdeen</a></li>
  <li><a href="#">Ada</a></li>
  <li><a href="#">Adamsville</a></li>
  <li><a href="#">Addyston</a></li>
  <li><a href="#">Adelphi</a></li>
</ul>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:35:13.313

尝试更改`select`为`selected`

```
 $("ul").menu({
         selected : function(){
            alert("Selected");
         }
     }); 
```

编辑：当前版本的 jquery ui 使用“选择”而不是“选择”，例如

```
 $("ul").menu({
         select : function(){
            alert("Selected");
         }
     }); 
```

# spring - 使用带有 Scala Trait 的 Spring @Autowired

> ID：10791770
> 
> 赞同：7
> 
> 时间：2012-05-29T00:27:35.613
> 
> 标签：spring, scala, dependency-injection

我有一个简单的场景，我扩展了一个 Scala 特征，如下所示：

```
 trait Vehicle {

      @Autowired
      private var myDistanceLogger: MyDistanceLogger = null

      def travel(miles:Int) = {
        println("travelling " + miles)
        myDistanceLogger.logMiles(miles)
      }
    }

    @Component
    class Truck extends Vehicle {

    } 
```

即使 Truck 包在 Springs 组件扫描中，我也会收到一个空指针异常。包中的所有其他（非扩展）类都连接良好。关于什么是错的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:26:00.440

这是一个小小的猜测——基于[这篇](http://www.codecommit.com/blog/java/interop-between-java-and-scala)文章，scala 中的特征被转换为 java 接口。所以，你的特点：

```
trait Vehicle {
      @Autowired
      private var myDistanceLogger: MyDistanceLogger = null
} 
```

将被翻译成：

```
public interface Vehicle {
    public MyDistanceLogger myDistanceLogger();
} 
```

并且`@Autowired`在吸气剂中没有意义，我猜这就是为什么它没有自动装配的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T23:50:25.373

我刚刚对此进行了测试，它确实有效 - 特征中的私有 var 被正确自动装配。

你什么时候调用 travel()？也就是说，在所有 Spring 初始化完成之后，您确定调用它吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T12:30:54.560

Scala 将注释放在 Spring 找不到的字段上。您需要确保将其放置在 Scala 的内部 setter 方法中：

```
import scala.annotation.meta.setter

@(Autowired @setter)
private var myDistanceLogger: MyDistanceLogger = _ 
```

# javascript - Drupal 7：远程站点与本地站点不同

> ID：10791771
> 
> 赞同：1
> 
> 时间：2012-05-29T00:27:37.630
> 
> 标签：javascript, drupal-7, drupal-modules

我注意到在远程托管站点上安装 Drupal 7 后，我的站点的行为有所不同。该问题似乎与 JavaScript 有关，因为在浏览器中禁用 JavaScript 时，（远程或本地）站点都不起作用。

我一直在寻找几个小时的想法，但无处可寻。

行为一：在 Drupal 7 中 - 创建内容类型时，“机器名称”字段应该是自动填充的。这不会发生在我的远程站点上。

行为二：显示套件中的“现场显示”链接在远程站点上不起作用。它出现在内容类型 - 管理显示页面上。链接出现但不起作用。

再一次 - 这两种行为在我的本地 Aquia Dev Desktop 安装上似乎都可以正常工作，但是当我在远程站点上安装 Drupal 7 时会中断。

注意：我假设这些行为是相关的，但我不确定。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:19:42.717

这可能与[Drupal7 mod_security 问题](http://drupal.org/node/522646)有关。如果您仍然可以访问旧主机，您可以通过在启用“聚合 JavaScript 文件”后检查问题是否消失来确认这一点。在主页 >> 管理 >> 配置 >> 性能（yourdomain.com/admin/config/development/performance）。基本上，服务器安全设置禁止访问具有特定名称的 Drupal7 Javascript 文件，并且丢失的文件正在杀死站点上的某些 Javascript 功能。当您聚合 Javascript 文件时，不会使用有问题的名称。

# cocoa - KVO：如何告诉观察者，那个自我改变了？

> ID：10791773
> 
> 赞同：1
> 
> 时间：2012-05-29T00:28:07.470
> 
> 标签：cocoa, core-data, key-value-observing

在一个子类中，其实例被另一个对象观察到：如何告诉观察者这个实例发生了变化？

我想做的是：我希望 NSArrayController 在某些 NSManagedObject （控制器管理）的属性发生更改时收到通知。控制器应该认为 NSManagedObject 发生了变化，但实际上它的一个属性发生了变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T02:35:22.297

设置托管对象的属性时，使用属性的访问器方法之一（例如，`myObject.foo = bar`或`[myObject setFoo:bar]`）或使用KVC（`[myObject setValue:bar forKey:@"foo"]`）。后者是普通 NSManagedObject 的唯一方法；能够做到前者是继承 NSManagedObject 的优点之一。

您可以自己发布 KVO 通知，但这仅在您`setPrimitiveValue:forKey:`直接分配给实例变量（或使用）时才有必要，除非在少数情况下，否则您不应该这样做：

*   （仅限 Ivar）在`init`方法中。你不应该有任何观察者，所以你不应该担心发布 KVO 通知。
*   （仅限 Ivars）在`dealloc`. 你不应该再有任何观察者，所以你不应该担心发布 KVO 通知。（如果此时您仍然有观察者，那是您的代码中的一个错误。）
*   （包括 ivars 和`sPV:fK:`）在自定义访问器中。您不需要从自定义访问器发布您自己的 KVO 通知，因为 KVO 会为您执行此操作。它还允许您设置依赖项，因此您也不需要为其他属性发布 KVO 通知。

（我从来没有接触过 Core Data，所以如果有任何 Core Data 专家可以仔细查看我的答案并确保我没有做错任何事情或遗漏任何内容，我将不胜感激。）

# asp.net-mvc-3 - ASP.NET MVC 3路由多个参数没有查询字符串

> ID：10791778
> 
> 赞同：1
> 
> 时间：2012-05-29T00:28:40.347
> 
> 标签：asp.net-mvc-3, razor, asp.net-mvc-routing

我有以下路线设置，但它没有按我预期的方式出现。是的，我还是 MVC 的新手。

出来的方式是这样的。

```
http://localhost:29998/Home/States?make=Chrysler 
```

我希望它出来的方式是这样的

```
http://localhost:29998/Home/Chrysler/States 
```

当然，一旦你点击你的状态，它就会看起来像这样。

```
http://localhost:29998/Home/Chrysler/Florida 
```

我真的很想能够从那里完全删除“家”，然后将其保留为

```
http://localhost:29998/Chrysler/States

routes.MapRoute(
                "States", // Route name
                "{controller}/{action}/{make}", // URL with parameters
                new { controller = "Home", action = "States", Make = "" } // Parameter defaults
            ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T09:27:32.327

这是您的解决方案：

```
localhost:29998/Chrysler/States

routes.MapRoute(
                "States", // Route name
                "{make}/{states}/", // URL with parameters
                new { controller = "Home", action = "GetStateData", make="", states="" } 
            ); 
```

你应该把它放在默认路由方法下面，这样它就不会使用你的控制器值。

# html - 较小分辨率的背景图像

> ID：10791786
> 
> 赞同：0
> 
> 时间：2012-05-29T00:32:08.310
> 
> 标签：html, css

我有一个 x1600 宽度的大背景图像。它非常适合 1600x900 屏幕。但是，当我将其更改为 1280x720 时，会修剪右侧的背景图像。使居中的幻灯片向右对齐。

我如何使它在左右两侧修剪，同时保持幻灯片居中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:33:53.433

```
background-position: center center; 
```

这会将背景定位在中间，如果屏幕不够大，那么它将修剪所有需要的边。

但请记住，我的 1920x1200 屏幕会出现空白边缘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:05:10.997

采用

```
background-position: center center; 
```

使图像居中。

```
background-size: cover; 
```

将图像缩放到最大尺寸，使其宽度和高度都适合该区域，

```
background-size: contain; 
```

将缩放背景图像，使其全部可见，并且

```
background-size: 100% 100%; 
```

将图像拉伸到区域的宽度和高度。

[http://www.w3schools.com/cssref/css3_pr_background-size.asp](http://www.w3schools.com/cssref/css3_pr_background-size.asp)

希望有帮助！

编辑：为了与旧浏览器兼容，请使用 、 和 指定相同`-moz-background-size`的`-webkit-background-size`值`-o-background-size`。请参阅[背景尺寸 - MDN](https://developer.mozilla.org/en/CSS/background-size)。

# macos - 在 mac 中安装 pgrouting

> ID：10791789
> 
> 赞同：2
> 
> 时间：2012-05-29T00:32:50.287
> 
> 标签：macos, pgrouting

我在 mac 中安装 pgrouting 时遇到问题。它在 brew 中不可用。有没有办法使用 brew install pgrouting 安装它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-05-07T15:46:21.593

`brew install pgrouting`将安装 pgRouting。

# html - 提交按钮上未显示边框

> ID：10791792
> 
> 赞同：0
> 
> 时间：2012-05-29T00:33:42.303
> 
> 标签：html, css

当我尝试为按钮的样式添加边框时，它没有显示出来。我以前成功地做到了这一点，但不知道这次我做错了什么。

这是HTML：

```
<input name="submit" type="submit" class="mediumbutton" value="Submit"> 
```

这是我的 CSS：

```
.mediumbutton {
    width: 140;
    height: 40;
    font-family: Arial, Helvetica, sans-serif;
    color: #666;
    font-size: 24px;
    background-color: #DDD;
    border: 3px;
    border-color: #000;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T00:37:50.550

你缺一个`border-style`，试试。`border: 3px **solid** #000000;`

> “*由于边框样式的初始值为‘none’，所以除非设置了边框样式，否则没有边框可见。* ” — [http://w3.org/tr/css21/box.html#propdef-border-style](http://w3.org/tr/css21/box.html#propdef-border-style)

此外，您的值`width`和`height`属性值缺少[度量单位](http://w3.org/tr/css21/syndata.html#length-units)。虽然`input`元素有些例外，但通常情况下，尽管缺少此类单位，但仍适用此类尺寸，这可能表明您的文档正在以[怪癖模式](http://en.wikipedia.org/wiki/Quirks_mode)呈现，可以通过确保`<!doctype html>`正确包含正确的 doctype 声明 () 来纠正这种情况（应该是第一行，前面绝对没有）。

# celery - 在 Supervisord 中激活 vitualenv

> ID：10791794
> 
> 赞同：3
> 
> 时间：2012-05-29T00:34:09.350
> 
> 标签：celery, django-celery, supervisord

对于一点背景。我正在使用 Supervisor 来监控 django-celery 进程。我需要能够设置virutalenv，然后启动celeryd 进程。

我目前正在这样做的方式是，在`supervisor.conf`我拥有的文件中

```
[program:celery]  
command = /srv/worker.sh

stdout_logfile = /srv/supervisor.log
stderr_logfile = /srv/supervisor.log 
```

然后在`worker.sh`我有

```
/bin/su - username -c "source /srv/virtualenvs/bin/activate; python /srv/manage.py celeryd 
```

这行得通，有点。问题是，当我`supervisorctl stop celery`与主管合作时，它不会杀死工人。他们仍然存在。我在想，如果我能够在主管中激活 virtualenv，一切都会比放入 shell 脚本更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T00:53:43.950

TERM 信号被发送到 shell 脚本而不是 celeryd。要么不使用它（因为您可以从 supervisord conf 设置用户）或使用 exec。

无论如何，最佳做法是（如果您不关心丢失某些任务）：short stopwaitsecs 和 killasgroup=true。

例如：

```
[program:celery]
command=celeeryd blablabla
user=username 
stopwaitsecs=10
killasgroup=true 
```

# ruby-on-rails - Rails 3 Video Converter - 使用 voyeur HOWTO 制作配置文件？

> ID：10791796
> 
> 赞同：0
> 
> 时间：2012-05-29T00:34:15.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, carrierwave, video-encoding

我正在使用“Rails 3 + CarrierWave + Voyeur”，我需要制作新闻资料来转换 Voyeur 中的视频。

我在这里留下一个例子：

```
# video_uploader.rb
  版本：webmprev 做
    进程 :encode_video => [:webmprev]
    def full_filename(for_file)
      “#{model.id}_#{File.basename(for_file, File.extname(for_file))}.webm”
    结尾
  结尾

```

我需要为要创建的每种视频格式创建单独的配置文件。我希望有人帮助我。

谢谢。

安德烈斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:48:30.510

我的解决方案是：

**# video_uploader.rb**

```
  版本：v1080p 做
    处理：encode_video => [:mp4_1080p]
    def full_filename(for_file)
      “#{model.id}_#{File.basename(for_file, File.extname(for_file))}.mp4”
    结尾
  结尾

```

**# video_converter.rb**

```
modify:
fixed_name = File.basename(current_path, '.*') + "." + format.to_s

by:
fixed_name = File.basename(current_path, '.*') + "." + format.to_s.split("_"). 
```

```
在以下位置为 voyeur 创建一个文件 perfil：  
/path_to_ruby/gems/voyeur-0.1.2/lib/Voyeur/video_converters/mp4_1080p.rb

```

**# mp4_1080p.rb**

```
module Voyeur
  class Mp4_1080p < Converter
    def file_extension
      "mp4"
    end

    def convert_options
      "-b 1500k -vcodec libx264 -vpre hq -s hd1080 -g 30"
    end
  end
end 
```

# javascript - 如何自动缩进/格式化单行 js 文件？

> ID：10791797
> 
> 赞同：7
> 
> 时间：2012-05-29T00:34:17.227
> 
> 标签：javascript

一位优秀的前开发人员希望在离开我们公司之前让我们的生活更加艰难，并在一行中开发了一个完整的 JavaScript UI 框架。我的意思是......可能他在发展之后搞砸了......

关键是……我需要修复很多错误……我想知道你们将如何自动缩进整个代码。

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-29T00:35:55.800

> 一行中的整个 javascript UI 框架

将可读的开发代码变成乱七八糟的生产代码的过程称为*缩小/丑化*。概括地说，这个过程优化了生产使用的代码。根据实现，它可以执行（但不限于）以下操作：

*   通过删除空格来压缩代码（将其变成单行）
*   通过将变量和函数重命名为更短的来压缩
*   使用替代语法压缩语法（如`if`s 到三元，`for`to `while`）
*   删除死/无法访问的代码

> 你们将如何自动缩进整个代码

这个任务有很多工具：

*   您可以使用[JSBeautifier](http://jsbeautifier.org/)，一个用于格式化 JS 和 HTML 的在线工具。方便快速格式化。如果你碰巧使用 Sublime Text 编辑器[，有一个插件可以解决这个问题。](https://sublime.wbond.net/packages/HTML-CSS-JS%20Prettify)

*   如果您使用 Grunt，则构建了一个[JSBeautifier 任务](https://npmjs.org/package/grunt-jsbeautifier)来执行与 JSBeautifier 的在线版本相同的功能。

*   Chrome 在开发工具的 Sources 选项卡中有一个漂亮的打印选项。*这会在调试器上*缩进压缩代码（它不会修改文件）。

*   如果该文件恰好有一个随附的*源映射*（与代码文件同名但有`*.map`扩展名的文件），那么您很幸运。源映射就像一个字典，其中包含原始名称与压缩名称的映射。Chrome 和 Firefox 开发工具支持源映射，但默认情况下不启用。如果您启用它，浏览器将尝试下载它们（假设它们与缩小文件一起包含）并在开发人员工具的“源”选项卡中使用它们进行查看。

# jquery - 如何将json返回的数组映射到表中的列

> ID：10791800
> 
> 赞同：0
> 
> 时间：2012-05-29T00:34:50.650
> 
> 标签：jquery

我有对我的服务器进行查询的 javascript。返回的数据如下所示：

```
Json(new {  ansData = ansData,
                  success = true,
                  correct = score }); 
```

当我在浏览器上放置断点并查看时，我在 json.ansData 数组中看到以下内容：

```
ansData [false, false, true]    
0 false 
1 false 
2 true 
```

我需要做的是以某种方式将其映射到一个表，这样如果元素为假，则什么也不会发生，但如果元素为真，则 img 将更改为“/tick.png”

```
<table>
<tr id="ans_0">
   <td id="ansData[0]"><img src="/blank.png"></td>
</tr>
<tr id="ans_1">
   <td id="ansData[1]"><img src="/blank.png"></td>
</tr>
<tr id="ans_2">
   <td id="ansData[2]"><img src="/blank.png"></td>
</tr>
</table> 
```

这是我的ajax调用：

```
$.ajax({
        type: "POST",
        traditional: true,
        url: '/Test/Cities/JsonCheck',
        data: parms,
        dataType: "json",
        success: function (json) {
           ...  
        } 
```

有人可以建议我如何做到这一点。我对 jQuery 非常熟悉，但我从来不需要做任何事情，比如将具有真假值的数组映射到我的 DOM 中的元素。

# javascript - jquerymobile 页面的分析

> ID：10791802
> 
> 赞同：0
> 
> 时间：2012-05-29T00:35:11.987
> 
> 标签：javascript, jquery, google-analytics

我们使用 ajax 使用 jQm 来访问页面，但这不是可以理解的跟踪页面浏览量，如何设置分析来跟踪页面点击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:50:39.477

正如分析文档中所述，您应该使用事件跟踪来跟踪 ajax 页面加载：

> 使用 ga.js，您通常会将事件跟踪应用于：
> 
> 任何 Flash 驱动的元素，例如 Flash 网站或 Flash 电影播放器
> 
> **嵌入式 AJAX 页面元素**
> 
> 页面小工具
> 
> 文件下载
> 
> 数据加载时间

设置描述：[https ://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#SettingUpEventTracking](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide#SettingUpEventTracking)

# jquery - jQuery。在按钮单击事件上获取文本输入字段的值？

> ID：10791811
> 
> 赞同：8
> 
> 时间：2012-05-29T00:36:52.277
> 
> 标签：jquery

html:

```
<div id="search">
  <input id="term" type="text" value="enter your search" />
  <button id="hit" type="button" name="">Search</button>
</div> 
```

jQuery：

```
$(document).ready(function() {
  var term = $('#term').val();
  $('#hit').click(function() {
    alert(term);
  });
}); 
```

问题是，无论我在输入字段中输入什么，然后点击按钮，它总是提醒原始输入值“输入您的搜索”。

我该如何解决？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-29T00:42:57.420

您遇到的问题是整个代码块在 DOM 就绪事件上执行。

`var term = $('#term').val();`仅被评估一次并将“输入您的搜索”存储在术语变量中。这就是为什么无论您将值更改为什么，该变量在页面呈现时仍然保持初始值。

相反，您应该做的更像是以下内容：

jQuery

```
$(document).ready(function() {
  $('#hit').click(function() {
    alert($('#term').val());
  });
}); 
```

在这段代码中，当单击事件侦听器触发时，会评估具有 id term 的元素的值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-29T00:40:51.920

因为您只是在文档准备好时创建了变量..尝试在点击函数中创建变量“term”...

```
 $(document).ready(function() {
      $('#hit').click(function(event) {
          var term = $('#term').val();
          alert(term);
      });
  });​ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T00:40:51.193

您需要获取 on 的值`click`，而不是`document ready`

```
$(document).ready(function() {
  $('#hit').click(function() {
    var term = $('#term').val();
    alert(term);
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-16T10:00:53.890

在遇到麻烦后这对我有用 For int

```
function getValue(){
    $("qty").value = parseInt($("qty").value);
} 
```

对于字符串

```
function getValue(){
    $("qty").value = $("qty").value;
} 
```

# perl - 如何使用 grep 或 map 删除元素？

> ID：10791814
> 
> 赞同：9
> 
> 时间：2012-05-29T00:36:57.267
> 
> 标签：perl

如何使用`grep`或`map`删除数组中的元素或对数组的引用？我在使用`splice`从对数组的引用中删除一个或多个元素时遇到问题，并想看看是否`grep`或`map`可以为我提供更好的解决方案。

```
@removedElements = grep /test/, @array; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T00:58:43.517

你说的`"array or reference array"`好像是两种不同的东西。这令人困惑。

我假设既然你已经命名了你的数组`@removedElements`，那么你想问的是如何从中*删除*元素`@array`并将它们放入`@removedElements`。

```
@removedElements = grep /test/, @array;   
@array           = grep ! /test/, @array; 
```

对测试的简单否定将产生任一列表。你也可以做一个循环：

```
my (@removedElements, @rest);
for (@array) {
    if (/test/) {
        push @removedElements, $_;
    } else {
        push @rest, $_;
    }
} 
```

这样做的好处是执行的检查更少。

为了使用`splice`，您需要跟踪索引，在这种情况下我不确定它是否值得。它肯定不会使您的代码更易于阅读。同样，我怀疑`map`它会比常规循环有用得多。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T01:32:17.477

`grep`如果您知道要保留的元素，请使用。

```
my @keepers = grep /interesting/, @array; 
```

相反，如果您有对数组的引用，则编写

```
my @keepers = grep /interesting/, @$arrayref; 
```

请注意，这不会修改数组。

该过程与`map`. 给定一个拒绝元素的测试，写

```
my @keepers = map /do not want/ ? () : $_, @array; 
```

颠倒测试的意义

```
my @keepers = map /interesting/ ? $_ : (), @array; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-04T22:32:47.250

您可能还喜欢`extract_by`. [`List::UtilsBy`](http://metacpan.org/module/List%3a%3aUtilsBy)它类似于 grep，只是它从传递的数组中删除项目。

```
use List::UtilsBy qw( extract_by );

# some values in @array

my @removed = extract_by { m/test/ } @array;

# Matching elements will now be removed from @array and appear in @removed. 
```

# iphone - 渲染 pdf 时暂停屏幕更新

> ID：10791816
> 
> 赞同：1
> 
> 时间：2012-05-29T00:37:12.610
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我正在 ios 中制作一个以特定缩放级别呈现 pdf 的应用程序。该方法看起来不错，但是在渲染时，我只想保持屏幕暂停而不是看到光栅化的图块。有没有办法在开始过程时暂停屏幕，然后在完成后显示成品。就像是...

`[mainScreen pauseScreen]; //method I'm trying to find`

`[self redrawPDF]; //this method works fine`

`[mainScreen resume]; //show finished product`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:45:37.103

我不知道是否可以暂停将上下文渲染到屏幕，但您可以渲染到离屏位图，然后快速将该位图渲染到屏幕。这将对最终用户隐藏渲染过程。

这是 Stack Overflow 答案的[链接](https://stackoverflow.com/q/410313/335858)，解释了渲染到屏幕外位图的过程。

# silverlight - 升级到 Silverlight 5 后不会触发鼠标事件

> ID：10791817
> 
> 赞同：1
> 
> 时间：2012-05-29T00:37:29.020
> 
> 标签：silverlight, silverlight-5.0

我正准备把头发扯掉。我有一个相当复杂的自定义 Silverlight 控件，其中一些在 XAML 中定义，其余控件以编程方式添加。问题是此时我的鼠标事件都没有被触发。

XAML：

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="itiStyles.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources>

<Canvas>
    <Canvas.Resources>
        <!--L O A D I N G  A R E A-->
        <Storyboard x:Name="LoadingArea_Loading" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="spinner" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)" To="43200" Duration="00:03:00" />
        </Storyboard>
        <SolidColorBrush Color="Black" Opacity="0.5" x:Key="TransparentBackground">
         </SolidColorBrush>
        <Storyboard x:Name="ShowBigImage">
            <DoubleAnimation
             Storyboard.TargetName="ImageZoom"
             Storyboard.TargetProperty="Opacity"
             From="0.0" To="1.0" Duration="00:00:02" />
        </Storyboard>
        <Storyboard x:Name="HideBigImage">
            <DoubleAnimation
             Storyboard.TargetName="ImageZoom"
             Storyboard.TargetProperty="Opacity"
             From="1.0" To="0.0" Duration="00:00:01" />
        </Storyboard>
        <Storyboard x:Name="ShowFadedBackground">
            <DoubleAnimation
             Storyboard.TargetName="LoadingAreaBg"
             Storyboard.TargetProperty="Opacity"
             From="0.0" To="1.0" Duration="00:00:02" />
        </Storyboard>
        <Storyboard x:Name="HideFadedBackground">
            <DoubleAnimation
             Storyboard.TargetName="LoadingAreaBg"
             Storyboard.TargetProperty="Opacity"
             From="1.0" To="0.0" Duration="00:00:01" />
        </Storyboard>
        <Storyboard x:Name="ShowTestFeedback">
            <DoubleAnimation
             Storyboard.TargetName="TestFeedback"
             Storyboard.TargetProperty="Opacity"
             From="0.0" To="1.0" Duration="00:00:02" />
        </Storyboard>
        <Storyboard x:Name="HideTestFeedback">
            <DoubleAnimation
             Storyboard.TargetName="TestFeedback"
             Storyboard.TargetProperty="Opacity"
             From="1.0" To="0.0" Duration="00:00:01" />
        </Storyboard>
        <Storyboard x:Name="ShowAnswerResponse">
            <DoubleAnimation
             Storyboard.TargetName="AnswerResponse"
             Storyboard.TargetProperty="Opacity"
             From="0.0" To="1.0" Duration="0:0:1"/>
        </Storyboard>
        <Storyboard x:Name="HideAnswerResponse">
            <DoubleAnimation
             Storyboard.TargetName="AnswerResponse"
             Storyboard.TargetProperty="Opacity"
             From="1.0" To="0.0" BeginTime="0:0:1" Duration="0:0:1"/>
        </Storyboard>
    </Canvas.Resources>

    <Grid x:Name="LayoutRoot" Background="White">
        <TextBox Height="23" HorizontalAlignment="Left" Margin="40,38,0,0" Name="m_txtNoQuestionPools" VerticalAlignment="Top" Width="120" />
        <MediaElement Height="120" HorizontalAlignment="Left" Margin="166,192,0,0" Name="_audio" VerticalAlignment="Top" Width="160" />
        <Grid Height="498" HorizontalAlignment="Stretch" Margin="0" Name="m_oQuestionPanel" VerticalAlignment="Stretch" Width="Auto">
            <Grid.RowDefinitions>
                <RowDefinition x:Name="QuestionHeight" Height="Auto" />
                <RowDefinition x:Name="AnswerHeight" Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Image x:Name="ImageZoom" Width="450" Height="Auto" Grid.Column="0" Grid.RowSpan="2" Visibility="Collapsed" Opacity="0" Canvas.ZIndex="999" />
            <StackPanel Height="100" Name="questionPanel" HorizontalAlignment="Stretch"  Width="743" Grid.Row="0" Grid.Column="0">
                <TextBlock Name="questionTextBlock" />
                <Image Name="questionImage"  Width="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Stretch="Fill" />
            </StackPanel>
            <StackPanel Height="Auto" HorizontalAlignment="Stretch"  Width="743" Grid.Row="1" Grid.Column="0">
                <Grid Height="Auto" Name="AnswerContainer" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="743">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Canvas Height="Auto" Width="743" Background="{StaticResource TransparentBackground}" x:Name="LoadingAreaBg" Canvas.ZIndex="998" Grid.Row="1" Grid.Column="0" Visibility="Collapsed" >                            
                    </Canvas>
                    <Canvas Height="61" Width="61" Canvas.Left="8" Canvas.Top="8" x:Name="LoadingArea" Canvas.ZIndex="999" Grid.Row="1" Grid.Column="0" Visibility="Collapsed">
                        <Path x:Name="Pathb" Width="61.3707" Height="61.3717" Stretch="Fill" StrokeThickness="1.33333" StrokeLineJoin="Round" Stroke="#BD006EBA" Fill="#BD000000" Data="F1 M 303.297,179.655C 303.297,196.234 289.854,209.673 273.271,209.673C 256.7,209.673 243.26,196.234 243.26,179.655C 243.26,163.075 256.7,149.635 273.271,149.635C 289.854,149.635 303.297,163.075 303.297,179.655 Z "/>
                        <Path x:Name="Path_0b" Width="50.0575" Height="50.0615" Stretch="Fill" Fill="#FF446485" Data="F1 M 256.314,179.655C 256.314,170.297 263.923,162.687 273.272,162.687C 282.634,162.687 290.244,170.297 290.244,179.655C 290.244,189.01 282.634,196.621 273.272,196.621C 263.923,196.621 256.314,189.01 256.314,179.655 Z M 248.25,179.655C 248.25,193.456 259.479,204.686 273.272,204.686C 279.962,204.686 286.249,202.081 290.976,197.354C 295.704,192.626 298.307,186.341 298.307,179.655C 298.307,172.968 295.704,166.683 290.976,161.956C 286.249,157.227 279.962,154.624 273.272,154.624C 259.479,154.624 248.25,165.851 248.25,179.655 Z " Canvas.Left="5.5" Canvas.Top="5.498"/>
                        <Path x:Name="spinner" Width="24.9508" Height="25.0417" Stretch="Fill" Data="F1 M 256.314,179.655L 256.314,179.64L 248.25,179.64L 248.25,179.655C 248.25,193.432 259.44,204.643 273.2,204.681L 273.2,196.617C 263.885,196.578 256.314,188.986 256.314,179.655 Z " RenderTransformOrigin="1,0" Canvas.Left="5.472" Canvas.Top="30.507">
                            <Path.Fill>
                                <LinearGradientBrush StartPoint="0.801298,0.928042" EndPoint="0.159004,0.00604094">
                                    <GradientStop Color="#FF446185" Offset="0"/>
                                    <GradientStop Color="#FFFFE400" Offset="0.543967"/>
                                    <GradientStop Color="#FFF2DB21" Offset="0.981595"/>
                                    <GradientStop Color="#FFF4DD23" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                            <Path.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    <SkewTransform AngleX="0" AngleY="0"/>
                                    <RotateTransform Angle="0"/>
                                    <TranslateTransform X="0" Y="0"/>
                                </TransformGroup>
                            </Path.RenderTransform>
                        </Path>
                        <Path x:Name="Path_2b" Width="44.9978" Height="45.0008" Stretch="Fill" StrokeThickness="2.66667" StrokeMiterLimit="2" Stroke="#5AFFFFFF" Data="F1 M 294.444,179.655C 294.444,191.344 284.967,200.821 273.272,200.821C 261.588,200.821 252.113,191.344 252.113,179.655C 252.113,167.965 261.588,158.487 273.272,158.487C 284.967,158.487 294.444,167.965 294.444,179.655 Z " Canvas.Left="8.002" Canvas.Top="8"/>
                        <Path x:Name="Path_3b" Width="42.3312" Height="42.3342" Stretch="Fill" Fill="#B3000000" Data="F1 M 294.444,179.655C 294.444,191.344 284.967,200.821 273.272,200.821C 261.588,200.821 252.113,191.344 252.113,179.655C 252.113,167.965 261.588,158.487 273.272,158.487C 284.967,158.487 294.444,167.965 294.444,179.655 Z " Canvas.Left="9.5" Canvas.Top="9.5"/>
                    </Canvas>                        
                    <sdk:Label Height="50" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" FontSize="20" Canvas.ZIndex="999" Visibility="Collapsed" Opacity="0" Name="AnswerResponse" Foreground="White"/>
                    <sdk:Label Height="50" FontSize="20" HorizontalContentAlignment="Left" VerticalAlignment="Top" Canvas.ZIndex="999" Visibility="Collapsed" Opacity="0" Name="TestFeedback" Foreground="White" />
                    <ScrollViewer Name="AnswerScrollPanel" VerticalAlignment="Stretch">
                        <StackPanel Name="answerPanel" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="743"  Grid.Row="1" Grid.Column="0">
                            <Grid Height="Auto" Name="answerGrid" Width="Auto" Margin="20" Background="Transparent" Canvas.ZIndex="998">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition MaxWidth="40" MinWidth="40" Width="40" />
                                        <ColumnDefinition MaxWidth="35" MinWidth="35" Width="35" />
                                        <ColumnDefinition MaxWidth="35" MinWidth="35" Width="35" />
                                        <ColumnDefinition MinWidth="100" />
                                        <ColumnDefinition MaxWidth="35" MinWidth="35" Width="35" />
                                        <ColumnDefinition MaxWidth="35" MinWidth="35" Width="35" />
                                        <ColumnDefinition  MinWidth="100" />
                                </Grid.ColumnDefinitions>
                            </Grid>
                            <TextBox Name = "m_answerItem" Width="Auto" Padding="20" Visibility="Collapsed" AcceptsReturn="True" TextWrapping="Wrap" Canvas.ZIndex="2" />
                            <Grid x:Name="RankOrderControls" Visibility="Collapsed" VerticalAlignment="Stretch" Canvas.ZIndex="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="370" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition x:Name="m_RankOrderRow" Height="*"/>
                                </Grid.RowDefinitions>

                                <controlsToolkit:ListBoxDragDropTarget HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" x:Name="m_rankOrderSource" Grid.Row="0" Grid.Column="0" Background="Transparent" BorderBrush="Transparent">
                                    <ListBox x:Name="m_rankOrderAvailable" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Background="Transparent" BorderBrush="Black" Grid.Column="0" Grid.Row="0">
                                        <ListBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel />
                                            </ItemsPanelTemplate>
                                        </ListBox.ItemsPanel>
                                    </ListBox>
                                </controlsToolkit:ListBoxDragDropTarget>
                                <Grid Grid.Column="1" Grid.Row="0" VerticalAlignment="Stretch">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="15" />
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Height="15" Text="Drag your choices below to rank" Width="370" TextAlignment="Center" FontWeight="Bold" Grid.Row="0"/>
                                    <controlsToolkit:ListBoxDragDropTarget x:Name="m_rankOrderTarget" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" AllowDrop="True" Grid.Row="1" Background="Transparent" BorderBrush="Transparent">
                                        <it:ListBoxGeneric x:Name="mRankOrderUsed" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Background="Transparent" BorderBrush="Transparent">
                                            <it:ListBoxGeneric.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel />
                                                </ItemsPanelTemplate>
                                            </it:ListBoxGeneric.ItemsPanel>
                                        </it:ListBoxGeneric>
                                    </controlsToolkit:ListBoxDragDropTarget>
                                </Grid>
                            </Grid>

                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </StackPanel>
        </Grid>
    </Grid>        
</Canvas> 
```

生成单选按钮的代码：

```
private FrameworkElement AddRadioButton(string answerIdentifiers)
    {
        var oRadioButton = new RadioButton
                               {
                                   Content = answerIdentifiers,
                                   Background =
                                       new SolidColorBrush(ColorNamesExtensions.ColorNames.Transparent.FromName())                                       
                               };
        oRadioButton.Click += OQuestionControlClick;
        oRadioButton.MouseEnter += ORadioButtonMouseEnter;
        oRadioButton.MouseLeave += ORadioButtonMouseLeave;
        return oRadioButton;
    } 
```

创建新网格行的代码：

```
var row = new RowDefinition();                
            answerGrid.RowDefinitions.Add(row); 
```

将元素添加到网格的代码：

```
private void AddToGrid(FrameworkElement element, int columnNumber, int rowNumber)
    {
        answerGrid.Children.Add(element);
        Grid.SetColumn(element, columnNumber);
        Grid.SetRow(element, rowNumber - 1);
    } 
```

我处理原始框架元素的原因是我可以添加单选按钮或复选框或任何将 FrameworkElement 扩展到网格的东西。

同样，此代码在 SL4 中运行良好，在 SL5 中仍能正常显示，但没有触发鼠标事件。

I've tried the transparent backgrounds and ensuring things have sizes, I've tried messing with the z-order and I've tried messing with IsHitTestEnabled and nothing seems to be working.

Any help?

EDIT: I've also updated all of target versions to 5.0 from 4.0 and everything builds fine with that configuration.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T19:22:09.457

I finally figured it out thanks to getting Silverlight Spy. In Silverlight 4, Borders weren't marked as HitTestVisible, but apparently in Silverlight 5 they are. This isn't documented anywhere but the borders were taking all of the mouse events and handling them.

I set HitTestVisible to False on all of the Borders in MainPage.xaml and now all mouse events are working as expected.

# jquery - Rails Ajax create.js.erb 如何重新加载部分？

> ID：10791822
> 
> 赞同：2
> 
> 时间：2012-05-29T00:38:16.493
> 
> 标签：jquery, ajax, ruby-on-rails-3

我有一个通过 ajax 成功提交数据的表单，但我不知道如何在 ajax 操作之后触发事件。提交新记录后，我想重新加载包含表单的部分。

看法

```
#container
  #partial
   <%= form_for [@qa, @newpdd], :remote => true do |f| %>
    ....
   <%= f.submit "add %> 
```

PDD 控制器

```
def create
@pdd = Pdd.create!(params[:pdd])
@pdd.qa_id = params[:qa_id]
@qa = Qa.find(params[:qa_id])

respond_to do |format|
  if @pdd.save
    format.html { redirect_to(@qa, :notice => 'Pdd was successfully created.') }
    format.xml  { render :xml => @pdd, :status => :created, :location => @pdd }
    format.js
#    render :partial => pddsection
  else
    format.html { render :action => "new" }
    format.xml  { render :xml => @pdd.errors, :status => :unprocessable_entity }
  end
end
end 
```

创建.js.erb

```
$('#partial').replaceWith("<%= escape_javascript(render :partial => 'pdds/partial') %>"); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:57:05.020

我使用`<%=j %>`标签而不是`<%= escape_javascript() %>`，尽管它们在功能上可能相似。

你的代码看起来不错。`:remote => true`应该使您的浏览器执行服务器返回的任何 javascript（在本例中为 create.js.erb）。作为故障排除步骤，打开浏览器的开发人员控制台并查看您从 ajax 表单提交中获得的响应。视图渲染是否正确？ERB 呈现的 javascript 是否正确？

如果看起来不错，请将其复制并粘贴到 javascript 控制台中。如果这不能更新页面，请找出它有什么问题。可能是错误的选择器或语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T10:51:34.783

我最终放弃了表单中的 :remote => true 条件，如以下 rails cast 所示：

[Railscast 136](http://railscasts.com/episodes/136-jquery)

现在一切都按预期工作。谢谢您的帮助。

# python - 在Python中将字符串转换为二进制整数

> ID：10791824
> 
> 赞同：2
> 
> 时间：2012-05-29T00:38:31.327
> 
> 标签：python

我正在尝试将字符串转换为二进制整数：

```
string = "0b011" 
i = int(string) 
```

但是这段代码引发了一个`ValueError`. 但是，以下代码可以正常工作：

```
i = int(0b011) 
```

但是在这里我传递了一个二进制文字，而不是一个字符串。如何转换字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:41:19.547

试试这个代码：

```
string = '0b011'
i = int(string, 2) # value of i is 3 
```

它使用内置过程[int()](http://docs.python.org/library/functions.html#int)和可选的 base 参数，该参数指示要在转换中使用的基础 - 在本例中为两个，来自文档：

> base 参数给出转换的基数（默认为 10），可以是 [2, 36] 范围内的任何整数或零。如果 base 为零，则根据 string 的内容确定正确的基数；解释与整数文字相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T00:40:27.420

使用第二个可选参数（base），告诉`int()`字符串是`base 2`：

```
int(str[,base])

>>> string = "0b011"
>>> int(string,2)
3 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T01:04:20.433

```
>>> from ast import literal_eval
>>> literal_eval("0b011")
3 
```

# implementation - 关于 Paxos 和论文 Paxos Made Simple 的澄清

> ID：10791825
> 
> 赞同：6
> 
> 时间：2012-05-29T00:38:34.057
> 
> 标签：implementation, paxos

我读了一篇名为“Paxos made simple”的论文，但仍然有些困惑：

1.  “paxos算法的实例”指的是什么？每个实例是否表明有来自外部客户端的输入/命令？并且每个实例的paxos算法将并行执行？？？

2.  如果只有一个“杰出”的proposer可以发出proposal，那么paxos算法和2-phase commit算法有什么区别？？？

3.  在实际项目中，我们可以在哪里应用 paxos 算法？

似乎这里的论文给出了更清晰的描述： [http ://research.microsoft.com/pubs/64634/web-dsn-submission.pdf](http://research.microsoft.com/pubs/64634/web-dsn-submission.pdf)

还有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T18:27:48.617

> “paxos算法的实例”指的是什么？每个实例是否表明有来自外部客户端的输入/命令？并且每个实例的paxos算法将并行执行？？？

[我在另一个问题](https://stackoverflow.com/questions/5850487/questions-about-paxos-implementation/10151660#10151660)中回答了“实例”问题，所以我在这里简单总结一下。

基本上，这就像说“快速排序的实例”来指代算法的一次运行。在 Paxos 的情况下，它不是对列表进行排序，而是在多个主机上选择一个值。paxos 的多个实例可以/正在并行运行。参与者必须意识到这一点，因此最好明确提及。

> 如果只有一个“杰出”的proposer可以发出proposal，那么paxos算法和2-phase commit算法有什么区别？？？

*Distinguished Proposer*是一种优化，不是算法的要求。Distinguished Proposer 减少了两个提议者跨越准备/接受消息的争用，如果您希望实例完成，这很重要。在此模型中，节点将请求转发给 Distinguished Proposer，而不是为自己提出。如果它认为 Distinguished Proposer 已经死了，那么它只是为自己提出建议。（它不必/它永远不能 100% 确信杰出的提议者已经死了）。

> 我们可以在现实世界/项目中在哪里应用 paxos 算法？

首先，我使用 Paxos 进行领导人选举。例如，如果我有几个节点可以做一个任务是一个数据库Master，我使用Paxos 到一个paxos 实例来选择master。

次要用例是作为强一致性数据库。这样做的问题是，由于 Paxos 中需要的消息数量，它可能会很慢，所以我不会将它用于由不同数据库更好地服务的事情。也就是说，我主要将它用于配置。以上面提到的数据库主领导选举为例。我存储结果，以便节点可以查询诸如“谁*是*当前数据库主服务器？”之类的内容。Paxos 也会发布它的结果，所以在正常模式下我只是听这个流而不是实际查询。

# backbone.js - 在 Backbone.js 中定义模型类的两种方法

> ID：10791826
> 
> 赞同：1
> 
> 时间：2012-05-29T00:38:45.573
> 
> 标签：backbone.js

原谅我的无知，我想知道有什么区别：

```
class Car extends Backbone.Model {

} 
```

和

```
var Car = Backbone.Model.extend({

}); 
```

像我一样傻，第一个表达式来自咖啡脚本语法，它编译为较低的（不完全是，但做同样的事情）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:49:00.313

1.  第一个不是javascript。
2.  javascript 扩展与 java 扩展不同

> JavaScript 的活力允许我们添加或替换现有类的方法。我们可以随时调用方法method，并且该类的所有当前和将来的实例都将具有该方法。我们可以随时扩展一个类。继承具有追溯性。我们称这个类扩充是为了避免与 Java 的扩展混淆，这意味着别的东西。

来自[http://javascript.crockford.com/inheritance.html](http://javascript.crockford.com/inheritance.html)

# jquery - 如何将 JSON 对象转换为有用的东西？

> ID：10791827
> 
> 赞同：1
> 
> 时间：2012-05-29T00:38:46.070
> 
> 标签：jquery, json

这是我的 JSON 文件

```
"shipping":{
    "countries":{
        "150":{
            "id":150,
            "code":"nl",
            "title":"Nederland"
        }
    },
    "country":150,
    "zipcode":null,
    "methods":{
        "core|13490|40699":{
            "id":"core|13490|40699",
            "title":"ophalen",
            "description":"ophalen",
            "content":false,
            "pickup":true,
            "cod":false,
            "price":{
                "price_excl":"0.0000",
                "price_incl":"0.0000"
            }
    },
    "core|10292|40718":{
        "id":"core|10292|40718",
        "title":"Pakketdienst",
        "description":"Pakketdienst",
        "content":false,
        "pickup":false,
        "cod":false,
        "price":{
        "price_excl":"33.5714",
        "price_incl":"39.9500"}
        }
    }
} 
```

我的脚本如下所示：

```
function bakVormShipping(targetClass){
    $.getJSON('http://shop.com/cart/?format=json', function(data){
        var methods = ''
        $.each(data.cart.shipping.methods, function(index, methods){
            if (index == "core|10292|40696") {
                $('<span></span>').html('<strong>' + methods.price.price_incl + '</strong>').appendTo(targetClass);
            }
            else if (index == "core|10292|40693") {
                $('<span></span>').html('<strong>' + methods.price.price_incl + '</strong>').appendTo(targetClass);
            }
            else if (index == "core|10292|40718") {
                $('<span></span>').html('<strong>' + methods.price.price_incl + '</strong>').appendTo(targetClass);
            }
        });
    });
} 
```

首先是一些小解释。您看到的 json 是从“购物车”页面调用的。您看到的第一种方法是运输方式：在商店取货。第二个用于实际运输。我想在我商店的不同页面上加载第二个（实际运输）。所以人们可以看到运费是多少。所有产品都基于重量，因此当产品重量更重时，运费会更改为 ID 为“core|10292|40693”和“core|10292|40718”（参见代码）的方法，并且所有不同的价格都会偏离路线. 所有这些都是动态的，因此 json 将始终具有提货方法和实际的运输方法。

我试图实现的是 a) 缩短代码。例如，如果 (index == "core|10292|40696" || "core|10292|40693" || "core|10292|40718") 不起作用并打印出取货方式和实际运输方式.

b) 将输出转换为具有两位小数的货币。我搜索了这个论坛，但我无法让它在这个代码上工作。代码现在打印 39.9500 而不是 39.95

c）我想摆脱，`$('<span></span>')`因为代码现在可以打印所有内容。我尝试使用 $(methods) 但这给出了“未定义”错误。显然因为`var methods =`是“空的”并且什么都不做。

有没有人有一些方向或愿意提供帮助？我对 JSON 和 jquery 很陌生，所以请耐心等待。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:58:41.683

> **a)`if (index == "core|10292|40696" || "core|10292|40693" || "core|10292|40718")`不起作用**

如果`index`等于其中任何一个值，您需要执行以下操作：

```
if (index == "core|10292|40696" || index == "core|10292|40693"
    || index == "core|10292|40718") 
```

> **b) 将输出转换为带两位小数的货币。**

目前，您的货币金额是字符串。下面使用[一元加号运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Arithmetic_Operators#.2B_%28Unary_Plus%29)将`price_incl`字符串转换为数字，然后使用该[`.toFixed()`方法](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toFixed)将它们四舍五入到小数点后两位：

```
(+methods.price.price_incl).toFixed(2) 
```

周围的括号在`+methods.price.price_incl`那里，因为没有它们，方法调用`.toFixed(2)`将比一元加号具有更高的运算符优先级。

> **c）我想摆脱，`$('<span></span>')`因为代码现在可以打印所有内容。**

您可以像创建跨度一样创建强元素，即通过将一串 html 传递给`$()`函数（然后`targetClass`像您已经做的那样附加结果）：

```
$('<strong>' + methods.price.price_incl + '</strong>').appendTo(targetClass);

// OR, possibly easier to read but definitely more compact:
$('<strong/>').html(methods.price.price_incl).appendTo(targetClass);

// OR with the rounding included:
$('<strong/>').html((+methods.price.price_incl).toFixed(2)).appendTo(targetClass); 
```

# php - PHP中的正则表达式布尔函数

> ID：10791829
> 
> 赞同：-4
> 
> 时间：2012-05-29T00:38:58.873
> 
> 标签：php, regex

我有一个字符串，我想测试它是否为以下格式。

```
exactly seven alphabetical OR numerical characters, followed by a '_', followed by 
exactly five alphabetical OR numerical characters, followed by a '_', followed by 
exactly seven alphabetical OR numerical characters, followed by a '_', followed by 
exactly nine alphabetical OR numerical characters. 
No other characters should exist other then the above mentioned characters. 
```

我想要一个函数，如果它与描述匹配则返回 true，如果不匹配则返回 false。

编辑：字母和数字字符可以混合使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:51:56.940

这`{}`将允许您指定 char 可以重复多少次。

`[]`允许您列出`-`指定字符范围的可能字符。

最后的`i`标志使它不区分大小写。`^`标记字符串的开始并`$`标记结束。这些可以防止任何东西出现在比赛的前面。

```
preg_match('/^[a-z0-9]{7}_[a-z0-9]{5}_[a-z0-9]{7}_[a-z0-9]{9}$/i', $str); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T00:43:58.580

匹配这个的正则表达式是：

```
^[a-zA-Z0-9]{7}_[a-zA-Z0-9]{5}_[a-zA-Z0-9]{7}_[a-zA-Z0-9]{9}$ 
```

语法简要概述：

*   `^`仅匹配字符串的开头；`$`只匹配结尾。
*   `[`并`]`表示要匹配的字符。它们可以包括范围，例如`0-9`.
*   `{`并`}`表示将前一件事重复特定次数。

# objective-c - 在 Objective-C 和 iOS 中，代表似乎可以向任何方向发展？

> ID：10791831
> 
> 赞同：2
> 
> 时间：2012-05-29T00:39:39.197
> 
> 标签：objective-c, ios, design-patterns, delegates, delegation

起初我有点惊讶的是，`UIView`我的绘图是由帮助的`CALayer`，但`CALayer`代表实际上是`UIView`。似乎关系颠倒了。

但是，delegate 是否真的没有“主帅”或“所有权”关系……它可以去任何方向：例如，A 类可以有一个 B 类的委托，同时 B 类可以还有一个代表是 A 类。

更重要的是，可以有多个委托，这意味着一个对象需要几个其他对象的帮助。

这有点类似于物理世界，CTO 可以将“面试某人的技术能力测试”委托给 David，而现在 David 是提供 1 到 10 分的代表。但 David 可以委托满足或不要回到 CTO（一个布尔值）说“我只能面试 Javascript 的候选人，我同意可以雇用新候选人并同意与他合作，如果你发现他擅长可扩展性问题，因为我们的团队需要这样一个人”——David 将其委托给 CTO。

所以在Objective-C（也可能是任何语言）中，可以有多个委托，他们可以去任何方向，主要思想只是为了一些原始对象不知道如何处理的“帮助”。真的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:11:30.393

iOS 中的代表与现实生活中的不同。委托不会主动告诉对象如何工作，而是被动地指示对象应该如何操作，并接收有关对象状态的更新。

委托用于监视其所委托的对象的状态，并提供有关对象应如何执行其任务的说明（必要时）。您有权说没有特定的所有权，例如 A 类可以成为 B 类的代表，而 B 类委托 A 类。这很好。

有四种主要类型的委托方法，它们都向委托提供有关对象状态的信息，并从委托中请求指令。[Peylow 在这里](https://stackoverflow.com/questions/1349706/little-confused-on-delegates-in-objective-c)的回答中很好地描述了它们。

所有这一切都是一种迂回的说法，是的，你是对的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:09:44.443

代表有助于面向对象的封装原则。以 UIApplication 为例。你有没有对它进行子类化？在一些罕见的情况下是可能的，但大多数时候它提供的重要功能可能会受到用户粗心的子类化的影响。于是，委托模式就出现了。UIApplication 将完全按照其内部预期的方式运行，并从委托中获取某些预定义情况的提示，这些情况预计会始终如一地发生。委托的另一个功能与事件有关（obj-c 中的通知）。该对象将通知其委托外部观察者可能感兴趣的某些事件（例如，UIScrollView 开始和结束滚动）。

但是，通常只有一个代表，而不是您所说的多个代表。这并不是说这是不可能的，但大多数时候这是不寻常的（如果两个代表将单元格高度提供给 UITableView 会发生什么？）

因此，在您的示例中，CTO 有一组标准，他在内部使用而不通知大卫，但对于其中一个标准，他需要大卫（或他自己以外的人）执行某些任务并报告结果。这个结果可能是可选的（大卫有机会拒绝，CTO 将使用他自己的判断）或必需的（如果大卫拒绝，他将失去他的“工作”）。无论哪种情况，关键是无需关心 CTO 内部的想法（就像无需担心 UIApplication 如何做它所做的那样）。重要的功能是从开发人员那里封装的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T01:10:47.517

是的，代表可以朝任何方向前进，因为作为某事的代表实际上只意味着它将代表“主”类执行某些方法。

这可能与您提出的问题有关：

[Objective C 中的多个委托](https://stackoverflow.com/questions/1382241/multiple-delegates-in-objective-c)

> 所以在Objective-C（也可能是任何语言）中，可以有多个委托，他们可以去任何方向，主要思想只是为了一些原始对象不知道如何处理的“帮助”。真的吗？

几乎，它取决于类和这样的目的：

@可选方法

这些将有助于自定义方法的行为，如果被覆盖但不是真正必要的，或者它们已经有默认实现。

@required 方法

这些至关重要，正如您所说，主要课程不知道如何处理它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T01:12:13.973

实际上，建立委托模式的不是语言，而是框架（Cocoa）。

然而，委托通常使用称为“协议”的语言特性来实现。ObjC 中的协议是一个类可以承诺实现的方法声明列表。协议中的每个方法都可以是可选的或必需的。如果一个类采用了协议但没有实现所需的方法，编译器将发出错误信号。

协议没有实现并且不依赖于类层次结构，非常适合存在于委托与其委托者之间的松散关系。任何类都可以采用任何协议，或许多，宣布它将实现那里声明的方法。如果协议概述了委托人和委托人之间的接口，那么该类*实际上*就是委托人。

任何*对象*（而不是*class*）可以（通常）用作委托的原因是委托属性/ivars 通常是 typed `id`。这是通用对象指针，允许分配任何类型的对象，这与委托的模式保持一致——委托者需要知道的只是它的委托响应它将发送的消息。任何其他行为与其业务无关。

> A类可以有一个B类的委托，同时B类也可以有一个A类的委托。

当然，可能，只要他们每个人都知道对方实现了必要的方法。在我的脑海中，我想不出这样做的理由——Cocoa 中的委托通常是控制器对象，允许在没有子类化的情况下修改框架模型类的行为。委托人/模型将请求其委托人/控制器允许做某事，或通知委托人它即将或刚刚做某事。

> 所以在Objective-C（也可能是任何语言）中，可以有多个委托，他们可以去任何方向，主要思想只是为了一些原始对象不知道如何处理的“帮助”。真的吗？

我真的不知道你所说的“去任何方向”是什么意思。这也不是什么“帮助”。一般来说，具有关联委托协议的对象*不需要*委托存在——没有它它也能很好地工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T01:15:30.080

委托只是一种提供函数的方法，您正在调用您希望它使用的数据和算法的访问权限。这没有什么神奇之处，也没有涉及“标准”——只是一种利用普通对象的特殊方式。其他语言对同一概念使用不同的术语（例如，“事件处理程序”）。

# php - 从 cURL 和 PHP 同时打印和写入文件

> ID：10791832
> 
> 赞同：1
> 
> 时间：2012-05-29T00:39:52.180
> 
> 标签：php, curl

我正在尝试找到一种更好的表达方式，但我想要的非常简单（或者至少，我认为应该如此）。我想从 URL 下载一个文件（它将是一个大小约为 10MB 的二进制文件），并且我想将它流式传输到同时请求它的浏览器。据我所知，当您没有设置 CURLOPT_RETURNTRANSFER 或 CURLOPT_FILE 时，这只是 php 和 curl 的默认行为，根据文档，这是因为 CURLOPT_FILE 设置为 STDOUT（页面）。但我想要的是服务器在接收到服务器时回显来自服务器的任何内容，并记录输出并将其保存到文件中。后一部分不一定要在文件仍在下载时发生，但如果可能的话，那就太好了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:50:02.300

您应该特别查找输出缓冲和[ob_flush()](http://php.net/manual/en/function.ob-flush.php)，但要非常小心处理错误！

PHP 通常会在向浏览器发送任何内容之前尝试完成所有脚本的执行，但如果您手动覆盖它，您可以在脚本仍在运行时逐步向浏览器发送数据。

如果您不想这样做，另一种方法是在已加载的页面中使用分块传输和 XMLHttpRequests，并使用某种服务器回调将数据块提供给浏览器。

# java - 如何保持服务器的移动速度？

> ID：10791834
> 
> 赞同：4
> 
> 时间：2012-05-29T00:40:15.157
> 
> 标签：java, awt, kryonet

我正在为我的游戏编写服务器，但无法弄清楚如何保持移动速度。根据计算机上运行的内容，移动速度要么非常快，要么非常慢。我已经尝试为服务器创建自己的 delta 方法，但它不起作用。我不能在更新时使用 Slick delta 变量，因为服务器是使用 AWT 和 Kryonet 编程的。

有谁知道如何保持运动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T14:37:36.777

您的游戏服务器需要有一个明确的全球时间。我建议使用 System.currentTimeMillis();

然后，您必须根据基于时间的方程来确定运动。由于您机器上的循环不会以准确的速率执行，因此您需要使用 System.currentTimeMillis() 从上一个时间值中减去来获得通过的增量时间。在您的运动方程式中使用该值以获得一致的运动外观。如果您正在计算物理（即运动），您将需要使用 Runge Kutta 4 阶方程，而不是正常的欧拉方程（欧拉随着时间的推移计算误差）。

其他有用的链接：

[http://gafferongames.com/game-physics/integration-basics/](http://gafferongames.com/game-physics/integration-basics/)

[https://developer.valvesoftware.com/wiki/Latency_Compensating_Methods_in_Client/Server_In-game_Protocol_Design_and_Optimization](https://developer.valvesoftware.com/wiki/Latency_Compensating_Methods_in_Client/Server_In-game_Protocol_Design_and_Optimization)

# mysql - 通过对服务器的 root 访问，我将如何更改 mysql root 密码？

> ID：10791842
> 
> 赞同：1
> 
> 时间：2012-05-29T00:41:15.567
> 
> 标签：mysql, sql

> **可能重复：**
> [如何在 MySQL 中更改 root 用户的密码？](https://stackoverflow.com/questions/53482/how-do-i-change-the-password-of-the-root-user-in-mysql)

我对 ec2 实例具有 root 访问权限，但我不知道我需要的 mysql root 密码是什么。我将如何 1) 找到这个？或2）重新安装mysql并给自己一个root密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:46:05.737

```
$ sudo service mysql stop
$ /usr/bin/mysqld_safe --skip-grant-tables &
mysql -h localhost
> use mysql
> update user set password = password('') where user = 'root' and host='localhost';
> quit
$ sudo service mysql start
$ mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g. 
```

# c++ - C++：SFINAE 和随机生成器/引擎

> ID：10791846
> 
> 赞同：3
> 
> 时间：2012-05-29T00:41:41.367
> 
> 标签：c++, random, sfinae

我目前有一个类的构造函数：

```
template<class TX, class TY> MyClass(const TX &x, const TY &y) 
```

并允许我根据 2 个值构建我的课程。

我希望能够使用 C++ 2011 中的随机生成器/引擎构建我的类。

```
template<class TG, class TE> MyClass(TG &generator, TE &engine) 
```

如何修改最后一个构造函数，因为在这种形式下，它与编译器的第一个构造函数相同。我想我可以使用 SFINAE，但我不知道如何。

非常感谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T01:10:57.917

TX 和 TY 参数在第一个构造函数中代表什么？要使用 SFINAE，您必须找到与 TX 和 TY 不同的生成器和引擎 API 的某些方面，例如成员变量或函数。该`seed`函数可能是一个很好的候选者。检查具有已知签名的成员函数的一般技术记录在此处的另一个答案中：[是否可以编写模板来检查函数的存在？](https://stackoverflow.com/questions/257288/is-it-possible-to-write-a-c-template-to-check-for-a-functions-existence/264088#264088)

# iframe - 绝对定位 iframe 覆盖固定页脚

> ID：10791857
> 
> 赞同：2
> 
> 时间：2012-05-29T00:44:05.473
> 
> 标签：iframe, youtube

这是我想要完成的。我有背景，我想在上面放置一个 iframe 元素。

我使用的html如下：

```
<div id="container">
    <img src="images/videoframe.png" id="img1" />
    <iframe id="img2" width="370" height="209" src="http://www.youtube-nocookie.com/embed/BWW7te-P5Ak?rel=0" frameborder="0" allowfullscreen></iframe>
</div> 
```

我用来完成此操作的 CSS 如下：

```
#container {
    position:relative;
}

#img2 {
    position: absolute;
    left: 50px;
    top: 29px; 
```

我设法让它完美地工作。我的问题是……我有一个固定的页脚，而 iframe（但只有 iframe）重叠并覆盖了固定页脚的一部分。

我的固定页脚的 html 如下：

```
<div class="floatingfooter">
  <a href="http://www.facebook.com/TraumaSlaveSC" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('FacebookIcon','','images/socialmedia/Stone-FaceBook2.png',1)"><img src="images/socialmedia/Stone-FaceBook.png" alt="Like Us on Facebook" name="FacebookIcon" width="86" height="85" border="0" class="centerimage" id="FacebookIcon" /></a>

<a href="http://www.facebook.com/TraumaSlaveSC" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('MySpaceIcon','','images/socialmedia/Stone-MySpace2.png',0)"><img src="images/socialmedia/Stone-MySpace.png" alt="Add Us on MySpace" name="MySpaceIcon" width="85" height="85" border="0" class="centerimage" id="MySpaceIcon" /></a> 

<a href="http://www.reverbnation.com/traumaslave" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('ReverbNationIcon','','images/socialmedia/Stone-Reverb2.png',1)"><img src="images/socialmedia/Stone-Reverb.png" alt="Listen to us on Reverbnation" name="ReverbNationIcon" width="85" height="85" border="0" class="centerimage" id="ReverbNationIcon" /></a> 
<a href="http://twitter.com/traumaslavefan" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('TwitterIcon','','images/socialmedia/Stone-Twitter2.png',1)"><img src="images/socialmedia/Stone-Twitter.png" alt="Follow Us on Twitter" name="TwitterIcon" width="86" height="85" border="0" class="centerimage" id="TwitterIcon" /></a><a href="http://www.youtube.com/traumaslave" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('YouTubeIcon','','images/socialmedia/Stone-YouTube2.png',1)"><img src="images/socialmedia/Stone-YouTube.png" alt="Watch Our YouTube Channel" name="YouTubeIcon" width="85" height="85" border="0" class="centerimage" id="YouTubeIcon" /></a></div> 
```

我的固定页脚的 CSS 在这里：

```
.floatingfooter {
    color: #ffffff;
    font-size: 14px;
    font-family: Verdana, Geneva, Arial, sans-serif;
    background-color: #7A6D50;
    text-align: center;
    position:fixed;
    bottom: 0px;
    left: 0px;
    width: 100%;
    height: 105px;
    z-index: 100000;
    vertical-align: middle;
    padding-top: 20px;
} 
```

当前发布代码的网站是 www.traumaslave.com

这真的让我很难过。

我处于早期设计阶段，所以我知道我的编码非常粗糙。我需要清理它。但是，我想知道

如何使 iframe 在固定页脚下滚动

或者

如果有人有任何更好的想法将 iframe 放在一个整洁的背景中以规避这个问题

或者

如果问题出在 iframe 本身，是否有人知道嵌入不包含 iframe 的 youtube 视频的解决方案，并且仍然允许编码以将视频嵌入到背景中。

非常感谢！

珍妮弗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T02:58:30.717

所以我最终将静态页脚更改为静态侧边栏。它最终看起来更好，我不需要担心重叠的元素。我仍然非常失望，以至于我没有收到任何回复。:( 因此，如果有人遇到同样的问题并查看此帖子，我建议您尝试使用侧边栏。它对我很有用，因为我的导航窗格是水平的，所以它看起来并不古怪。

快乐编码！

珍

# c# - 通过硬盘搜索关键字

> ID：10791860
> 
> 赞同：0
> 
> 时间：2012-05-29T00:44:49.653
> 
> 标签：c#, java, search

我正在进行一个项目，该项目将创建一个工具，该工具可以扫描硬盘驱动器以搜索特定关键字，并将包含这些关键字的文件输出到单独的文档中。我想知道这样的项目需要多长时间，我还有不到一年的时间，我目前仍在学习编程。在开始之前我应该​​查看的编程领域中的任何帮助将不胜感激。

它将用于 Windows 和 Java 或 C#。将用于系统上的实时内存分析。

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:51:20.937

`grep(1)`带有 、 和 命令行 选项的 GNU 命令`-R`可以`-l`在几`-f`秒钟内完成。POSIX 指定`grep(1)`的命令与命令相结合`find(1)`可以在几秒钟内为您提供此工作。因此，如果您只是想完成工作，请考虑使用现有工具。

根据您的技能水平，您可能需要一个下午来编写此工具的克隆，或者如果这是您第一次有机会学习正则表达式、树行走等，则可能需要一个月的项目。

在 C# 中进行项目可能会让您更轻松地访问具有多个数据分支的文件；如果您的工具将用于任何类型的取证环境，这将是至关重要的。

# google-app-engine - Google App Engine 的注册问题

> ID：10791864
> 
> 赞同：0
> 
> 时间：2012-05-29T00:45:31.570
> 
> 标签：google-app-engine, google-apps

在使用 codecademy.com 和 udacity.com 对 Web 应用程序开发有所了解之后，我终于尝试建立并运行自己的网站并尝试编写应用程序。我听取了一些建议并开始尝试使用 App Engine，但很快就遇到了重大问题。我假设我忽略了一些明显的东西，但我找不到正确的文档。

最终目标：

从 helloworld.axiomofcats.com 为 andrewhelloapp.appspot.com 提供服务

我现在在哪里：

*   根据 udacity 说明，我使用 draw.matteson@gmail.com 注册了应用引擎
*   我通过 SMS 验证并在 andrewhelloapp.appspot.com 创建了一个 hello world 应用程序
*   我想在 helloworld.axiomofcats.com 上提供这个服务（我拥有 [axiomofcats.com](http://axiomofcats.com)）
*   在此页面上找到了执行此操作的说明：http: [//support.google.com/sites/bin/answer.py ?hl=en&answer=99448](http://support.google.com/sites/bin/answer.py?hl=en&answer=99448)
*   我不知道如何将我的 draw.matteson@gmail.com 与 Google Apps 关联起来
*   我使用 Google Apps (drew.matteson@axiomofcats.com) 注册了 axiomofcats.com，并完成了验证我对该网站的所有权的过程
*   然后，我尝试让 draw.matteson@axiomofcats.com 成为应用引擎帐户
*   由于短信验证限制只有一个电话号码，我无法注册

到目前为止我的假设

*   要为使用 appengine 开发的子域 helloworld.axiomofcats.com 提供应用程序，我相信我需要一个包含两件事的帐户
    *   访问应用引擎
    *   访问谷歌应用程序

我认为的问题：

*   draw.matteson@gmail.com 可以访问应用引擎，但无法使用谷歌应用注册域
*   draw.matteson@axiomofcats.com 拥有我想要提供服务的域，但无法注册应用程序引擎，除非我使用自己的电话号码以外的电话号码

这类似于此处发现的未回答问题：[https ://stackoverflow.com/questions/805855/google-app-engine-registering-a-new-application](https://stackoverflow.com/questions/805855/google-app-engine-registering-a-new-application)

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:17:34.960

试试这个：

1.  转到您的 App Engine 管理页面 -> 权限
2.  邀请您的其他帐户作为所有者 (drew.matteson@axiomofcats.com)
3.  检查您的电子邮件并接受邀请
4.  转到管理 -> 添加域，输入 axiomofcats.com
5.  按照进一步的说明..

# python - Selenium webdriver 在单击之前突出显示元素

> ID：10791866
> 
> 赞同：2
> 
> 时间：2012-05-29T00:45:40.970
> 
> 标签：python, selenium-webdriver, automated-tests, ui-testing

我正在研究一组用 Python 编写的 selenium UI 测试。在以前的项目中，我使用的是 WatiN 和 C#。

WatiN 框架有一个你可以启用的功能，它可以“突出显示”你点击、选择或输入的元素。执行操作时，元素周围会出现黄色边框。我发现这在对损坏的测试进行故障排除时非常有用，如果单击了错误的元素，我经常可以从测试运行中看到。

我想知道 Selenium webdriver 是否有类似的功能可以打开。基本上我想要某种视觉指示正在与什么元素进行交互。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T09:26:20.017

Selenium RC 可以做到这一点，但在 WebDriver 中没有直接的 API 方法可以做到这一点。您的选择是：

1）使用`WebDriverBackedSelenium`您的语言绑定中的实现来访问该`Highlight`方法。

`JavascriptExecutor`2）只需使用（或您的语言绑定中的类似实现）调用一些javascript来为您完成这项工作。这将模仿**Selenium RC/选项 1**将实现的功能。

要调用的 Javascript 存在于此处：

[http://code.google.com/p/selenium/source/browse/javascript/selenium-core/scripts/htmlutils.js](http://code.google.com/p/selenium/source/browse/javascript/selenium-core/scripts/htmlutils.js)

要注意的功能是`highlight`功能。只需使用 JavascriptExecutor 加载此脚本（搜索以了解如何在您的编程语言中执行此操作）。

然后，您可以比较它以查看`WebDriverBackedSelenium`Java API 中的实现如何使用它：

[http://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/internal/seleniumemulation/Highlight.java](http://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/internal/seleniumemulation/Highlight.java)

使用它，在您自己的代码中执行相同的操作。

附带说明一下，用于 Firefox 的 Selenium IDE 也可以突出显示方法。

# php - WordPress 查询分类中的多个术语

> ID：10791868
> 
> 赞同：1
> 
> 时间：2012-05-29T00:46:00.497
> 
> 标签：php, mysql, wordpress

我正在一个网站上工作，我需要在一个分类中查询多个术语。目前，我有以下适用于下拉菜单的内容。

```
function ct_search_form_select_quick($name, $taxonomy_name = null) {
    global $search_values;

    if (!$taxonomy_name) {
        $taxonomy_name = $name;
    }
    ?>
    <select id="ct_<?php echo $name; ?>" name="ct_<?php echo $name; ?>">
        <option value="0"><?php _e('Any', 'theme_textdomain'); ?></option>
        <?php foreach( get_terms($taxonomy_name, 'hide_empty=0') as $t ) : ?>
            <?php if ($search_values[$name] == $t->slug) { $selected = 'selected="selected" '; } else { $selected = ''; } ?>
            <option <?php echo $selected; ?>value="<?php echo $t->slug; ?>"><?php echo $t->name; ?></option>
        <?php endforeach; ?>
    </select> 
```

但是，我希望能够在一个分类中查询多个术语。

我有以下代码，它允许我选择术语并输出第一个术语的结果，但忽略第二个术语。URL 输出为

> ?property_type=condo-duplex&property_type=condo-loft&ct_price_from=&ct_price_to=&ct_mls=&property-search=true&x=32&y=18，需要输出为?property_type=condo-duplex,condo-loft&ct_price_from=&ct_price_to=&ct_mls=&property-search=真&x=32&y=18

```
function ct_search_form_select($name, $taxonomy_name = null) {
    global $search_values;

    if (!$taxonomy_name) {
        $taxonomy_name = $name;
    }
    ?>
        <input type="checkbox" value="0" name="ct_<?php echo $name; ?>"><?php _e('Any', 'theme_textdomain'); ?>
        <?php foreach( get_terms($taxonomy_name, 'hide_empty=0') as $t ) : ?>-->
                    <?php if ($search_values[$name] == $t->slug) { $selected = 'selected="selected" '; } else { $selected = ''; } ?>

<input type="checkbox" name="<?php echo $name; ?>" value="<?php echo $t->slug; ?>"><?php echo $t->name; ?>
        <?php endforeach; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:49:20.587

对您来说有多方便：

已经有一个了不起的插件可以实现这个确切的功能：

[http://wordpress.org/extend/plugins/query-multiple-taxonomies/](http://wordpress.org/extend/plugins/query-multiple-taxonomies/)

在这里查看它的实际效果：

productionlocations.com/locations

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T06:37:32.650

一年后不确定这是否有用，但我遇到了类似的问题，这就是我想出的

```
function ct_search_form_check($name, $taxonomy_name = null) {
global $search_values;

    if (!$taxonomy_name) {
        $taxonomy_name = $name;
    }

?>
    <?php foreach( get_terms($taxonomy_name, 'hide_empty=0') as $t) : ?>
        <?php if ($search_values[$name] == $t->slug) { $selected = 'checked="checked"'; } else { $selected = ''; } ?>
            <div><input id="ct_<?php echo $name; ?>" name="ct_<?php echo $name; ?>" type="checkbox" style="margin-right:5px; margin-left:5px" <?php echo $selected; ?>value="<?php echo $t->slug; ?>"><?php echo $t->name; ?><span style="margin-left:10px"></span></input></div>
           <?php 
           $data = array();
                while (list($name, $t->slug) = each($arr)) {
                   $data[] = "$name";
                }
                echo implode($data); 
                if (!empty($_GET['ct_'])) { 
                    $url = str_replace('&ct_=', '%2c', $_SERVER['QUERY_STRING']);
                    header("Location: ?$url");
                } ?>
    <?php endforeach; ?> 
```

# c++ - 特定于域的 C++ 迭代器方法

> ID：10791870
> 
> 赞同：4
> 
> 时间：2012-05-29T00:46:40.930
> 
> 标签：c++, iterator

除了迭代器概念所需的常规方法之外，是否有任何理由不在迭代器中包含非标准方法？附加方法将特定于迭代器生成的项目类型。

* * *

## 具体例子

为了使我的问题更具体，我正在对 GUI 菜单中的菜单项进行交互。在内部，迭代器通过索引访问菜单。取消引用时，它会在该索引处查询该项目的菜单，创建一个表示菜单返回的属性的不可变对象，并将其缓存在成员变量中，然后返回对它的引用。

### 不安全的解决方案

另一种方法是使表示可变并使其将属性更新写回底层菜单。它看起来像这样：

```
menu m = some_menu();
menu_iterator pos = m.begin() + 3;

menu_item i = *pos;
...
i.caption("foo");
i.disable(); 
```

这意味着每个`menu_item`表示都必须存储它的位置和菜单句柄——没什么大不了的——除非菜单在创建项目表示后已经插入/删除了一个项目。在这种情况下，随着完全不同的项目的属性发生变化，各种地狱都可能会崩溃。

### 更好的解决方案？

所以我的想法是添加额外的方法来改变*迭代器*的属性而不是它返回的值。这样，用户总是知道正在更新的是当前指向的项目，并且插入使其无效的通常迭代器语义适用（它不会真正使其无效，它只会指向不同的项目）。

```
menu m = some_menu();
menu_iterator pos = m.begin()+3;
...
pos.caption("foo");
pos.disable(); 
```

你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:52:36.720

这是我要做的：

*   如果您不需要*能够*通过迭代器改变菜单项，只需设置`menu_item`不可变 - 问题就解决了。
*   如果您需要能够通过迭代器改变菜单项：
    *   如果您对底层菜单实现具有这种类型的控制，请`menu_item`指向**实际**的菜单对象，该对象在添加新菜单项时不会失效。您甚至可以让迭代器在取消引用时返回（当然是通过引用）实际的菜单对象并`menu_item`完全取消包装器。
    *   如果您没有那种类型的控件，那么`menu_item`它实际上是菜单项的代理，而不是菜单项本身。调用它`menu_item_proxy`，并记录它具有代理行为，并且当迭代器失效时代理也会失效。用户仍然可以使用语法“在迭代器上”调用方法`pos->caption("foo")`。

我不会将方法`caption()`放在迭代器本身内部。（例如，如何使用它们`for_each`？）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-29T20:29:57.637

向迭代器添加方法并没有错。迭代器只是访问者的一个特例。访问者应该在访问某个对象时执行所有必需的操作。随意添加您的业务需要的任何方法

# javascript - 发送超过 50 个应用请求

> ID：10791872
> 
> 赞同：0
> 
> 时间：2012-05-29T00:47:21.573
> 
> 标签：javascript, facebook, facebook-javascript-sdk

所以我想向所有朋友发送一个应用请求，即使他们有超过 50 个。现在我让它抓取所有朋友，并让它以 50 个为一组多次提示他们，但这可能非常多余和累人为用户。我只是想知道是否有办法通过让应用程序以某种方式在后端执行请求，或者在没有提示的情况下发送请求来完成 50 多个任务。

我听说过“无摩擦请求”，但这只有在用户之前向用户发送过请求时才有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:21:31.043

不，您不能在没有用户交互的情况下批量发送这样的请求，即使用户不需要确认每个单独请求的无摩擦请求也只有在用户已经确认至少一个请求并启用选项时才有效下次提示。

我很难想到这将是垃圾邮件以外的任何情况，我想如果您有一个强制发送超过 50 个请求的系统，您将很快触发垃圾邮件过滤器

# ruby-on-rails - 使用捆绑包安装 Factory Girl 3.3 会导致 Ruby 版本错误

> ID：10791873
> 
> 赞同：3
> 
> 时间：2012-05-29T00:47:32.070
> 
> 标签：ruby-on-rails, ruby, rubygems, factory-bot, rbenv

我正在 Ubuntu 12.04 64bit 上安装带有 bundle install 的工厂女孩​​并且收到错误

```
Installing factory_girl (3.3.0) /usr/lib/ruby/vendor_ruby/1.8/rubygems/installer.rb:388:in `ensure_required_ruby_version_met': factory_girl requires Ruby version >= 1.9.2\. (Gem::InstallError)
from /usr/lib/ruby/vendor_ruby/1.8/rubygems/installer.rb:156:in `install'
from /usr/lib/ruby/vendor_ruby/bundler/source.rb:101:in `install'
from /usr/lib/ruby/vendor_ruby/bundler/rubygems_integration.rb:78:in `preserve_paths'
from /usr/lib/ruby/vendor_ruby/bundler/source.rb:91:in `install'
from /usr/lib/ruby/vendor_ruby/bundler/installer.rb:58:in `run'
from /usr/lib/ruby/vendor_ruby/bundler/rubygems_integration.rb:93:in `with_build_args'
from /usr/lib/ruby/vendor_ruby/bundler/installer.rb:57:in `run'
from /usr/lib/ruby/vendor_ruby/bundler/spec_set.rb:12:in `each'
from /usr/lib/ruby/vendor_ruby/bundler/spec_set.rb:12:in `each'
from /usr/lib/ruby/vendor_ruby/bundler/installer.rb:49:in `run'
from /usr/lib/ruby/vendor_ruby/bundler/installer.rb:8:in `install'
from /usr/lib/ruby/vendor_ruby/bundler/cli.rb:222:in `install'
from /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/task.rb:22:in `send'
from /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/task.rb:22:in `run'
from /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
from /usr/lib/ruby/vendor_ruby/bundler/vendor/thor.rb:246:in `dispatch'
from /usr/lib/ruby/vendor_ruby/bundler/vendor/thor/base.rb:389:in `start'
from /usr/bin/bundle:13 
```

这是我的 Ruby -v

```
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux] 
```

我正在使用 RBenv，这是命令的结果：rbenv version

```
1.9.3-p194 (set by /home/user/.rbenv/version) 
```

这是命令的结果：rbenv 版本

```
1.9.2-p290
* 1.9.3-p194 (set by /home/user/.rbenv/version) 
```

这是我的 gemfile 中的 factory_girl_rails

```
group :test do
 gem 'factory_girl_rails', '~> 3.3.0'
end 
```

如果您需要查看更多文件，请告诉我，我很乐意发布它们。任何人都知道为什么我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T20:04:13.047

问题不在于`rbenv`它不起作用或与任何东西发生冲突，而在于您实际上并没有正确设置它以正确使用它。

我注意到的第一件事是您的`gem`安装位置在：

```
/usr/lib/ruby/vendor_ruby 
```

带有 gem 可执行文件：

```
/usr/bin 
```

这似乎是`Ubuntu 12.04` [`ruby`package](http://packages.ubuntu.com/precise/ruby)提供的“系统红宝石” ，在您执行以下操作时安装：

```
sudo apt-get install ruby 
```

所以，即使你已经`rbenv`安装了，你实际上并没有使用它，并且尝试安装 gems 失败了。具体来说，您实际运行的 ruby​​ 是 Ubuntu 系统 ruby​​ version `1.8.7`，如下行所示：

```
/usr/lib/ruby/vendor_ruby/1.8/rubygems/installer.rb:388:in `ensure_required_ruby_version_met': factory_girl requires Ruby version >= 1.9.2\. (Gem::InstallError) 
```

简而言之，该错误准确地告诉您问题所在 -`factory_girl`需要 ruby`1.9.2`​​ 或更高版本，并且您运行的版本不够新。

因此，要解决此问题，您需要根据[安装说明](https://github.com/sstephenson/rbenv#-2-installation)`~/.bash_profile`配置“点文件”（ ,`~/.bashrc`等），以便在您键入or或任何 ruby​​gems 可执行命令时，例如or ，您实际上是运行您的托管 ruby​​，而不是系统提供的默认 ruby​​。这最终是通过在您的常用目录之前的路径中放置您的“垫片”目录（`rbenv` `ruby``gem``rake``bundle``rbenv``rbenv``~/.rbenv/shims``$PATH``rbenv rehash`

然后，一旦您`rbenv`正确配置了它，您就可以利用使用该命令`.rbenv-version`创建的目录中的文件。[`rbenv local`](https://github.com/sstephenson/rbenv#-32-rbenv-local)

# php - PHP - 创建用于收集和显示错误的单例消息传递类

> ID：10791874
> 
> 赞同：2
> 
> 时间：2012-05-29T00:48:25.910
> 
> 标签：php, singleton

我在这里寻找语法上的胜利...我希望能够将消息添加到单例类中以供以后检索。

目前它看起来像这样：

```
class messenger
{
    static $messages;

    public function addMessage( $message ) {
        self::messages[] = $message;
    }

    public function showMessages() {
        foreach ( self::messages as $message ) {
            echo "<p>$message</p>";
        }
    }

} 
```

现在我希望能够像这样使用它：

```
messenger::addMessage( 'This is a potential message!' );
messenger::addMessage( 'Another potential message!' );
messenger::showMessages(); 
```

哪个会输出这个（[p] == 一个 html 段落标签）：

```
[p]This is a potential message![/p]
[p]Anotherpotential message![/p] 
```

我对这个概念有误解吗？我真的不想将它与使用它的每个不同类中的变量重新关联，但我不确定我的挂断是“如何做”还是根本不可能。

这个概念是能够将错误消息添加到这个（如数组）中，我不必全球化并且可以稍后检索。

**编辑：**我这样做是为了通过我的框架，我可以将来自其他类的消息添加到这个类，这些类可能也想在以后显示错误，而不必使用全局变量或重新实例化该类。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:36:53.633

我不完全确定你在问什么。是的，您的建议可以正常工作。但如果你不知道，你的语法有点不对劲。

```
public static function addMessage( $message ) { ... }
public static function showMessages() { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:48:38.050

最好从外面隐藏它的状态，所以：

```
static $messages; 
```

应该：

```
private static $messages = array(); 
```

还要注意初始化以确保它是一个数组，然后再向其中添加消息。

此外，您正在使用的方法应该声明为`static`，否则 PHP 会抱怨这个（触发`E_STRICT`警告），例如

```
public static function yourFunction() { } 
```

# playframework - Play Framework - 将数据从视图发送到控制器

> ID：10791875
> 
> 赞同：0
> 
> 时间：2012-05-29T00:48:43.693
> 
> 标签：playframework

控制器可以将数据作为渲染方法中的参数发送给视图。视图如何将数据发送到控制器？

编辑：让我澄清一下。

`Application.showQuestion(Question q){ render(q); }`

showQuestion.html 显示问题“q”并有一个文本框用于输入“a”到“q”的答案。表单上的提交按钮调用方法 createAnswer。我不仅要传递答案'a'，还要传递问题'q'。createAnswer(q, a) 会实现同样的效果吗？我的目标是：

a.问题=q；q.addAnswer(a);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T10:59:44.567

我猜你想要做的是让用户通过点击你生成的网页来调用正确的控制器。

您正在寻找的是所谓的`reverse routing`，Play 有一个机制。[你可以在这里](http://www.playframework.org/documentation/2.0/ScalaRouting)看到它是如何工作的。然后，如果您尝试从表单中获取输入，我建议您使用[文档中详述的 Form 对象](http://www.playframework.org/documentation/2.0/ScalaForms)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T05:35:56.517

我不完全确定我是否正确理解了您的问题，但希望是的：

如何将问题 q 与答案 a 一起传递的最简单方法是使用预定义的模板“表单”。您可以执行以下操作：

```
showQuestion.html:

#{form @Application.createAnswer(q), id:'answerForm'}
   ...
   // add input for the answer here
   ...
#{/form} 
```

然后在 Application.java 中定义方法 Application.createAnswer(q, a)，它会被调用。因此表单标签中使用的参数和表单中的输入组合在一起。这部分`#{form @Application.createAnswer(q)...`实际上只做的是，它在表单中创建隐藏的输入字段，当单击提交按钮时，这些字段被传递给控制器​​。

关于表单标签的详细信息： [playframework 1.2.4 中的表单标签](http://www.playframework.org/documentation/1.2.4/tags#form)

请注意，我所描述的适用于 playframework 1.2.4。我不确定它在 2.0.1 中是否以同样的方式工作，但我（真的）希望是的。

# parsing - 如何在解析器中包括方法声明、常量、函数调用的计数？

> ID：10791876
> 
> 赞同：0
> 
> 时间：2012-05-29T00:48:51.473
> 
> 标签：parsing, parser-generator, jflex

我正在为类似于 java 但更简单的语言实现解析器。我写了一个词法分析器，现在正在写解析器。我已经写了语法，我需要实现元素的计数，但我不知道要放它。我认为它应该在制作后出现在动作代码中，但我不知道要初始化它。

例如

```
MethodDecl ::= ReturnType:type IDENTIFIER:id LPAREN FormParsOp:pars RPAREN VarDeclListOp LBRACE StatementListOp RBRACE
       {: System.out.println("Method: " + type + " " + id + "(" + pars + ")");   methodNumber++;:} 
    | STATIC ReturnType:type IDENTIFIER:id LPAREN FormParsOp:pars RPAREN VarDeclListOp LBRACE StatementListOp RBRACE
       {: System.out.println("Static method: " + type + " " + id + "(" + pars + ")");  staticMethodNumber++;:} ; 
```

我应该在哪里定义和初始化变量 methodNumber 和 staticMethodNumber？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T22:05:21.970

解决了...我把它们放在动作代码中并在那里初始化

# bash - 如果参数是文件名，bash getopts 会中断吗？

> ID：10791877
> 
> 赞同：1
> 
> 时间：2012-05-29T00:48:58.043
> 
> 标签：bash, getopts

我正在使用 getopts 编写一个脚本，该命令可以具有任何顺序的参数，包括有效参数`-a`和文件名，如`stuff.txt`. 问题是，当我运行这样的命令时：

`program.sh -a -b stuff.txt -c -d`

我的代码处理参数`-a`并且没问题`-b`，直到它到达文件名，然后它停止处理并且不接触参数`-c`，`-d`然后。我的代码看起来有点像这样：

```
while getopts ":a:b:c:d" opt; do

case "$opt" in

    a) # do something;;

    b) # do something;;

    /?) echo ERROR
        exit 1;;

esac
done 
```

我在`while`循环之外处理文件，它们似乎注册得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:51:06.077

由于您已经指出每个选项都需要一个参数，因为在每个选项字母后都有一个冒号`":a:b:c:d"`（第一个冒号影响错误处理），因此脚本将`-b`其视为`-a`. 当它遇到文件名时，它检测到选项处理应该停止。

您应该为`-a`不需要参数的选项字母提供参数或删除冒号。

进行这些更正后，您的脚本会将文件名视为参数，`-b`并且在处理时变量`$OPTARGS`将包含文件名`-b`。

# ios - 空白主视图

> ID：10791879
> 
> 赞同：0
> 
> 时间：2012-05-29T00:49:06.780
> 
> 标签：ios

基本上，我不知道为什么我的主视图是空白的（在模拟器中）。这是我在 iOS 中的第一个应用程序，并且正在努力学习（所以提前感谢）。

在 MainStoryboard.storyboard 中，我布置了三个单元格。第一个具有“SoundCategoryCell”标识符，另外两个具有“Cell”。

我将表格视图内容作为“静态单元格”，因为会有一个已知的固定数字。

虽然我编辑了 cellForRowAtIndexPath，但我不确定它是否相关，但如果您认为需要，我会添加代码。

我很困惑为什么主视图控制器的“图片”在情节提要中有三个单元格，但在构建后它是空白的。

再次感谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:33:34.583

确保您已从场景的父类中删除所有 TableView DataSource 方法：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

在使用静态单元表视图时，在父类中包含这些会导致问题。您仍然需要情节提要场景的 UITableViewController 父类，但不需要数据源方法

# objective-c - UIManagedDocument 正确初始化并等待它准备好

> ID：10791885
> 
> 赞同：2
> 
> 时间：2012-05-29T00:50:11.567
> 
> 标签：objective-c, ios, core-data

我正在尝试将 CoreData 与 an 一起使用`UIManagedDocument`，我知道它需要一段时间才能准备好，而且我也知道它准备好时会触发通知。我想在准备好后显示应用程序，这样做方便吗？

`UIManagedDocument`初始化 a并等待它准备就绪的标准方法（时间和方式）是什么？

从一开始就显示数据的应用程序会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T14:12:04.107

Apple 建议您侦听 UIDocumentStateChangedNotification 以对文档的状态更改做出反应。这包括当您的文档打开并准备好继续进行时，以及在保存文档时出现错误时您想要采取的步骤。

虽然这是关于基于文档的应用程序，但它也适用于 UIManagedDocument。

请参阅[iOS 的基于文档的应用程序编程指南](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/DocumentBasedAppPGiOS/ManageDocumentLifeCycle/ManageDocumentLifeCycle.html#//apple_ref/doc/uid/TP40011149-CH4-SW6)。

我个人喜欢这种方法的原因是因为它允许我根据文档状态调整 UI。它允许我根据多个文档组合的状态做出反应。与完成处理程序有关的事情会更加棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T03:42:40.707

用于创建和打开 UIManagedDocument 的两个接口都有一个回调块。

我建议在完成处理程序运行之前不设置文档属性。这样您就可以确定文档已打开并准备就绪。

我将显示没有数据的应用程序，并在数据准备好时让打开/获取排卵数据。

如果我在启动应用程序时这样做，我会继续加载应用程序，当数据准备好时，它会填充视图......但只有加载刚好足以开始，其余的提取发生在背景。

打开一个文件应该不会花很长时间......耗时的部分是加载数据。如果必须，您可以在启动时显示启动画面。Apple 的东西显示了一个类似于空白应用程序的图像……看看 iTunesU 在启动时如何显示空白书柜，然后用你的东西填充它。

有些人在开头播放了几秒钟的开场动画，掩盖了启动顺序。我想这可能是合适的，具体取决于您的应用程序。这在面向图形的游戏中似乎更容易接受。

# asp.net-mvc-3 - 如何根据对象值选择 Html.Radiobutton

> ID：10791886
> 
> 赞同：1
> 
> 时间：2012-05-29T00:50:18.530
> 
> 标签：asp.net-mvc-3, radio-button

我的 asp.net mvc 编辑视图中有以下 RadioButtons：-

```
<div class="editor-label">
    @Html.LabelFor(model => model.InsuranceSettled)
</div>

<div class="editor-field">
    @Html.RadioButton("InsuranceSettled", 1) Yes
    @Html.ValidationMessageFor(model => model.InsuranceSettled)
</div>

<div class="editor-field">
    @Html.RadioButton("InsuranceSettled", 0) No
    @Html.ValidationMessageFor(model => model.InsuranceSettled)
</div> 
```

但是我如何根据模型值选择所需的单选按钮，所以如果 model.InsuranceSettled 值为 0，则选择 No 单选按钮，反之亦然.. BR

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T06:12:52.773

我建议`RadioButtonFor`改用。我认为最好使用强类型帮助器来生成您的输入，以确保您的输入具有正确的名称。他们还将根据您的模型自动选择默认值。

```
@Html.RadioButtonFor(model => model.InsuranceSettled, 1) 

@Html.RadioButtonFor(model => model.InsuranceSettled, 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T02:02:02.677

试试这个：

```
@Html.RadioButton("InsuranceSettled", 1, Model.InsuranceSettled == 1)
....
@Html.RadioButton("InsuranceSettled", 0, Model.InsuranceSettled == 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T08:00:38.967

```
@Html.RadioButtonFor(model => model.InsuranceSettled , "True", model.InsuranceSettled == 1? new { Checked = "checked" } : null)

@Html.RadioButtonFor(model => model.InsuranceSettled , "False", model.InsuranceSettled == 0? new { Checked = "checked" } : null) 
```

# jquery - jQuery隐藏和显示面板

> ID：10791888
> 
> 赞同：0
> 
> 时间：2012-05-29T00:50:22.187
> 
> 标签：jquery, html, css

在下面的代码中，我试图构建两个面板；新订单面板和跟踪订单面板。我面临的问题是在第一个面板中打开的两个面板的组件。我不确定你是否理解这个问题。这是代码，您可以尝试清楚地理解它：

```
<html>
<head>
<script type="text/javascript" src="jscss/jquery.js"></script>
<script type="text/javascript"> 
$(document).ready(function(){
$(".flip").click(function(){
$(".panel").slideToggle("slow");
  });
});
$(document).ready(function(){
$(".flip1").click(function(){
    $(".panel1").slideToggle("slow");
  });
});
</script>

<style type="text/css"> 
div.panel,p.flip
{
margin:0px;
padding:5px;
text-align:center;
background:#e5eecc;
border:solid 1px #c3c3c3;
}
div.panel
{
height:220px;
display:none;
}
div.panel1,p.flip1
{
margin:0px;
padding:5px;
text-align:center;
background:#e5eecc;
border:solid 1px #c3c3c3;
}
div.panel1
{
height:220px;
display:none;
}
</style>
</head>

<body>

<div class="panel">
<form action="Order.php" method="post">
   Name<br /><input style="font-weight: bold;" name="name" size="60" type="text"                 AUTOCOMPLETE=OFF><br /><br />

   Subject<br /><input style="font-weight: bold;" name="subject" size="60" type="text"     id="subject"><br /> <br />

   Email<br /><input style="font-weight: bold;" name="email" size="60" type="text"><br /> <br />

   <input type="submit" value="submit" />
   </form>
</div>

<div class="panel1">
<form action="Track.php" method="post">
   ID<br /><input style="font-weight: bold;" name="id" size="60" type="text"         AUTOCOMPLETE=OFF><br /><br />
   <input type="submit" value="submit" />
   </form>
</div>

<p class="flip">New Order</p>
<br/><br/><br/>
<p class="flip1">Track Order</p>

</body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:37:17.260

您的问题是您只是将它们按错误的顺序排列。使用`panel`，然后`flip`，然后`panel1`，然后`flip1`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T02:09:11.450

我为你做了改变。是的，您在 HTML 结构的顺序上犯了错误。你可以看看这个：http: [//jsfiddle.net/zhujy_8833/pAerK/](http://jsfiddle.net/zhujy_8833/pAerK/)

基本上，请按如下顺序排列：

1.  分区面板

2.  p.翻转

3.  div.panel1

4.  p.flip1

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T04:11:21.703

那是因为你的 html 代码的顺序错误，试试这个：

```
<body>

  <div class="panel">
    <form action="Order.php" method="post">
      Name<br /><input style="font-weight: bold;" name="name" size="60" type="text" AUTOCOMPLETE=OFF><br /><br />

      Subject<br /><input style="font-weight: bold;" name="subject" size="60" type="text" id="subject"><br /> <br />

      Email<br /><input style="font-weight: bold;" name="email" size="60" type="text"><br /> <br />

      <input type="submit" value="submit" />
    </form>
  </div>
  <p class="flip">New Order</p>
  <br/><br/><br/>

  <div class="panel1">
    <form action="Track.php" method="post">
      ID<br /><input style="font-weight: bold;" name="id" size="60" type="text"         AUTOCOMPLETE=OFF><br /><br />
      <input type="submit" value="submit" />
    </form>
  </div>
  <p class="flip1">Track Order</p> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T00:58:56.397

在标记中，您的订单是面板、面板 1、新订单标题和跟踪订单标题。这是它们显示的顺序。

# c++ - IEEE Std 754 浮点：让 t := a - b，标准是否保证 a == b + t？

> ID：10791894
> 
> 赞同：11
> 
> 时间：2012-05-29T00:51:07.637
> 
> 标签：c++, c, floating-point, ieee-754

假设 , `t`,`a`都是`b`双精度（IEEE Std 754）变量，并且 , 的两个值`a`都不`b`是`NaN`（但可能是`Inf`）。之后`t = a - b`，我一定有`a == b + t`吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-29T01:05:04.120

绝对不。一个明显的例子是`a=DBL_MAX`，`b=-DBL_MAX`。那么`t=INFINITY`，`b+t`也是如此`INFINITY`。

可能更令人惊讶的是，在某些情况下发生这种情况而没有任何溢出。基本上，它们都是`a-b`不精确的形式。例如，如果`a`is`DBL_EPSILON/4`和`b`is `-1`，`a-b`则为 1（假设默认舍入模式），`a-b+b`然后为 0。

我提到第二个示例的原因是，这是强制舍入到 IEEE 算术中特定精度的*规范方法。*例如，如果您有一个 [0,1) 范围内的数字，并且想要强制将其四舍五入到 4 位精度，您可以先加然后减`0x1p49`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:08:17.120

在执行第一个操作的过程中，位可能已经从结果的低端丢失。所以一个问题是，第二次操作会完全重现这些损失吗？我还没有完全想到这一点。

但是，当然，第一个操作可能溢出到 +/-infinity，导致第二个比较不相等。

（当然，在一般情况下，使用`==`浮点值几乎总是一个错误。）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-29T01:53:35.987

使用浮点数时，您无法得到任何保证。如果两个数字的指数不同，则算术运算的结果可能无法完全用浮点数表示。

考虑这段代码：

```
float a = 0.003f;
float b = 10000000.0f;
float t = a - b;
float x = b + t; 
```

在 Visual Studio 2010 上运行，您将`t==-10000000.0f`获得`x==0`.

在比较浮点数时，永远不要使用相等。而是比较两个值之间差异的绝对值和一个足够小的满足您的精度需求的 epsilon 值。

它变得更加奇怪，因为不同的浮点实现可能会为相同的操作返回不同的结果。

# vb.net - 如何添加新的 Windows 窗体，然后以编程方式添加 PictureBox？

> ID：10791898
> 
> 赞同：0
> 
> 时间：2012-05-29T00:51:30.273
> 
> 标签：vb.net, winforms, controls

我正在寻找学习如何以编程方式向我的应用程序添加新表单，然后向该新表单添加图片框、文本框和按钮？

我可以在当前表单上添加一个新按钮、一个新表单或一个新图片框，但我似乎无法弄清楚如何向我的应用程序添加一个新表单，然后将图片框和文本框以及按钮放在那个新的形式。

我错过了什么？

```
'Form2
Dim form2 As New Form
form2.Size = New System.Drawing.Size(500, 500)
form2.Show()
Dim picturebox1 As New PictureBox()
Dim Textbox1 As New TextBox()
Dim Button1 As New Button()
CType(Me.PictureBox1, System.ComponentModel.ISupportInitialize).BeginInit()
Me.SuspendLayout()
'
'PICTURE BOX  PROPERTIES
'
picturebox1.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
picturebox1.Location = New System.Drawing.Point(11, 12)
picturebox1.Name = "PictureBox1"
picturebox1.Size = New System.Drawing.Size(365, 124)
picturebox1.TabIndex = 0
picturebox1.TabStop = False
picturebox1.Show()

'TEXTBOX PROPERTIES

Textbox1.Location = New System.Drawing.Point(12, 142)
Textbox1.Name = "TextBox1"
Textbox1.Size = New System.Drawing.Size(364, 20)
Textbox1.TabIndex = 1
Textbox1.Show()

'BUTTON PROPERTIES
Button1.Location = New System.Drawing.Point(128, 172)
Button1.Name = "Button1"
Button1.Size = New System.Drawing.Size(95, 24)
Button1.TabIndex = 2
Button1.Text = "Submit"
Button1.Show()

Me.Controls.Add(picturebox1)
Me.Controls.Add(Textbox1)
Me.Controls.Add(Button1) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T01:03:09.403

你应该试试 ：

```
form2.Controls.Add(picturebox1)
form2.Controls.Add(Textbox1)
form2.Controls.Add(Button1) 
```

这将显示`Control`s 中的 s `form2`。

# jquery - jQuery 缓存 JSON 请求

> ID：10791900
> 
> 赞同：0
> 
> 时间：2012-05-29T00:51:50.403
> 
> 标签：jquery, html, jquery-mobile

我正在开发 HTML5 移动应用程序。我想使用 jQuery 将特定的 JSON 请求缓存 10 天。我尝试设置`cache : true`请求。但我不能在那里指定 10 天。这可能吗？或者我是否需要使用 HTML5 本地存储。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:59:28.953

设置`cache: true`应强制浏览器遵循 HTTP 响应中指定的说明。要指定将响应缓存 10 天，您可以从服务器端添加此 HTTP 标头： `Cache-Control: max-age=864000`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T01:16:20.250

您可以只存储带有日期的 json 数据，这将使您能够在调用服务器进行更新之前查找缓存的数据。

您可以使用 html5 中的本地存储 api。

有关如何使用它的一些想法，您可以查看这个问题。

[在 HTML5 localStorage 中存储对象](https://stackoverflow.com/questions/2010892/storing-objects-in-html5-localstorage)

要知道这是否适用于您的目标移动设备，您可以查看以下内容：

[http://caniuse.com/#feat=namevalue-storage](http://caniuse.com/#feat=namevalue-storage)

所以，你可以这样做：

```
var dtDateTime = new Date();
var intDateTime = dtDateTime.getTime();
var objJSON = {};
objJSON.datetime = intDateTime;
objJSON.data = myjson;
localStorage.setItem('cachedObject', JSON.stringify(objJSON)); 
```

然后您可以检索对象并检查日期并决定是否需要重新加载数据。

我还没有测试过这个，但它应该很接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T00:56:39.363

是不是因为你应该`domCache: true`根据[文档](http://jquerymobile.com/test/docs/pages/page-cache.html)使用。

# ruby-on-rails - MAC OS X 上的 Postgres 权限被拒绝

> ID：10791904
> 
> 赞同：23
> 
> 时间：2012-05-29T00:52:40.537
> 
> 标签：ruby-on-rails, ruby-on-rails-3, macos, postgresql, osx-lion

我正在按照 ruby​​ on rails 教程使用 postgres 运行，但是当我尝试“rake db:create”时，出现以下错误：

```
could not connect to server: Permission denied
    Is the server running locally and accepting
    connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

我发现这个问题发出了一些类似的问题，但无论如何我都无法让它工作。

[升级到 OSX 10.7 Lion 后修复 Postgresql](https://stackoverflow.com/questions/6770649/repairing-postgresql-after-upgrading-to-osx-10-7-lion)

阅读此问题后，我已经安装了自制软件，并且路径很好， brew doctor 显示路径上没有错误。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-29T04:45:51.043

您可以尝试**TCP 连接**，而不是对**套接字文件**权限进行故障排除。添加到您的. 当然，这只有在 postgres 正在侦听 TCP 流量时才有效。Postgres 默认侦听端口 5432，因此会告诉您它是否正在侦听。**`host: localhost``config/database.yml``netstat -an | grep 5432`**

 ****参考**

*   [PostgreSQL 文档：18.3。连接和身份验证](https://www.postgresql.org/docs/current/static/runtime-config-connection.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-26T04:46:35.850

Oh, may be you are open postgre in another application, like **pgadmin** [http://www.pgadmin.org/](http://www.pgadmin.org/) Try to close any application that use postgre SQL and run your command again.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T15:26:11.373

我今天遇到了同样的问题，发现下面这篇博文对我有帮助：

[http://nextmarvel.net/blog/2011/09/brew-install-postgresql-on-os-x-lion/](http://nextmarvel.net/blog/2011/09/brew-install-postgresql-on-os-x-lion/)

> 它将您的 OS X 默认 postgres 二进制文件移动到存档文件夹中，并用符号链接自制版本来代替它们。

**TL;博士** `curl http://nextmarvel.net/blog/downloads/fixBrewLionPostgres.sh | sh`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-08T18:52:53.300

只需检查您的 config/database.yml 是否有------host: localhost 和 port: (通过 netstat -an | grep 5432 或 5433 自行检查)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-08T19:06:23.830

我遇到过同样的问题。在尝试了上面发布的所有建议均未成功后，我终于退出了终端并重新启动了它。

这行得通。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-03-28T22:21:40.673

我也遇到了这个问题，因为我的 Gemfile 中同时激活了 mysql 和 pg gem。

我注释掉了 mysql gem：

```
# mysql 
```

然后跑：

```
bundle install 
```

接着：

```
rake db:migrate 
```

它就像一个魅力。**

# python - 获取名称错误：在 Python 中使用 Twisted 时未定义名称 Self。如何消除此错误？

> ID：10791908
> 
> 赞同：1
> 
> 时间：2012-05-29T00:53:26.197
> 
> 标签：python

```
def mention_notifier(self):
    print self.stat_old

if __name__ == "__main__":
    import sys
    self.stat_old = Set([])
    l = task.LoopingCall(mention_notifier).start(timeout) 
```

这是我的代码的基本框架。我希望 stat_old 是一个全局变量，每次调用mention_notifier 时都不会重新初始化。因此，我做了这样的事情。但是没有定义“自我”的这个错误。有什么线索可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:19:12.867

我不使用 Twisted，但通过查看[docs](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.task.LoopingCall.html)，这样的事情可能会起作用：

```
def mention_notifier(self):
    print self.stat_old

class Namespace(object): 
    pass

if __name__ == "__main__":
    import sys
    self=Namespace()
    self.stat_old = Set([])
    l = task.LoopingCall(mention_notifier,self).start(timeout) 
```

当然，这里的变量名`self`可能应该更改为其他名称——按照惯例`self`，通常在类内部使用，以在方法调用中引用类的实例......

看起来`LoopingCall`可以给定参数以传递给函数（在这种情况下，`self`传递了命名空间对象）。然后在函数内部，“self”被修改（只要你不在`self=...`函数内部做类似的事情，你就是金子——`self.attribute=...`完全没问题）

# sql - 在存储过程中返回带有 OUTPUT DELETED 子句的 UPDATE 结果

> ID：10791909
> 
> 赞同：0
> 
> 时间：2012-05-29T00:53:30.430
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我正在尝试编写一个递增并返回 int 列值的函数：

```
CREATE PROCEDURE [GetNextTagSuffix]
AS
BEGIN

    UPDATE [MyTable]
    SET [NextTagSuffix] = [NextTagSuffix] + 1
    OUTPUT DELETED.[NextTagSuffix]
    WHERE [MyTableId] = 'SpecialCase'

END 
```

*OUTPUT*子句可以输出*INTO*表变量或临时表，但我只需要该单个值，因此首先将其添加到表变量中似乎很愚蠢。有没有办法将该值直接分配给变量并返回它？

使用表变量解决：

```
CREATE PROCEDURE [GetNextTagSuffix]
@TagSuffix int out
AS
BEGIN

DECLARE @tagTable TABLE
(
  NextTagSuffix int
)

UPDATE [MyTable]
SET [NextTagSuffix] = [NextTagSuffix] + 1
OUTPUT DELETED.[NextTagSuffix] INTO @tagTable
WHERE [MyTableId] = 'SpecialCase'

SET @TagSuffix = (SELECT MAX(NextTagSuffix) FROM @tagTable)

RETURN @TagSuffix

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:27:38.087

我相信您必须将输出分配给表变量或临时表。从[BOL 文档](http://msdn.microsoft.com/en-us/library/ms177564.aspx)中，

```
<OUTPUT_CLAUSE> ::=
{
    [ OUTPUT <dml_select_list> INTO { @table_variable | output_table } [ ( column_list ) ] ]
    [ OUTPUT <dml_select_list> ]
} 
```

请注意它如何指定可以将输出选择到表变量或表中。

2006 年，提交了一个[Microsoft Connect 操作项](http://connect.microsoft.com/SQLServer/feedback/details/150944/allow-variable-assignment-using-dml-output-clause)，要求准确地请求您想要使用的功能（从 OUTPUT 子句的结果对标量变量进行赋值的能力）。Microsoft 将该项目关闭为“Closed as Won't Fix”，因此可以肯定此功能在 SQL 2005 中不可用，也没有放入 SQL 2008。因此，除非他们改变主意，否则它在 SQL 2012 中也不可用. 您可能希望在未来的 SQL 版本中对连接项目进行投票或提交一个新的请求此功能的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:34:37.253

但是你可以在你的 SP 中使用输出参数

```
CREATE PROCEDURE [GetNextTagSuffix]
@value int output
AS
BEGIN

UPDATE [MyTable]
SET [NextTagSuffix] = [NextTagSuffix] + 1
OUTPUT DELETED.[NextTagSuffix]
WHERE [MyTableId] = 'SpecialCase'

END

DECLARE @result int 
EXEC GetNextTagSuffix @value=@result output 
```

# jquery - 更改 html href 但使用 jquery 保留文本相同

> ID：10791910
> 
> 赞同：0
> 
> 时间：2012-05-29T00:53:35.797
> 
> 标签：jquery, html, text, href, title

有没有办法更改链接的 href 值但保持其文本不变？

```
<a id="mylink" href="www.link.com">click here</a> 
```

我想简单地更改“www.link.com”并保持文本“单击此处”不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:55:04.237

使用[该`.attr()`函数](http://api.jquery.com/attr/)更改元素的属性：

```
$('#mylink').attr('href', 'newvalue'); 
```

此外，仅供参考（这甚至可能是您更改它的原因），`href="www.link.com"`将导致链接断开，除非实际上`www.link.com`在与托管链接的页面相同的路径中调用了一个文件。要转到另一个域，URL 需要完全限定以包含协议：`href="http://www.link.com"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:48:14.013

[jQuery 的 .attr() 方法](http://api.jquery.com/attr/)将是执行此操作的最佳方法。它就像一个魅力。这是您将用于您想做的事情的代码：

```
$('#mylink').attr('href', 'http://www.newlink.com'); 
```

另外，请确保您的 href 包含协议。( `http://`, `https://`, 等)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T02:00:20.637

使用 jQuery .attr() 可以轻松实现。

```
var link = $("#mylink");   //the target anchor
link.attr("href","{your url here}"); 
```

# actionscript-3 - Flex/AIR Mobile：TabbedViewNavigator selectedIndex 不起作用

> ID：10791911
> 
> 赞同：0
> 
> 时间：2012-05-29T00:53:48.340
> 
> 标签：actionscript-3, apache-flex, air, flex4.6

我在 FB 4.6 中有一个带有 TabbedViewNavigator 的移动项目。我的底部有4个按钮，它们是ViewNavigators，并充当标签。对于这种情况，假设选项卡被标记为 HOME、ADD、DELETE 和 ABOUT。我遇到以下情况：

1.  用户按下添加选项卡。
2.  在 ADD 屏幕中，用户单击几个链接，这些链接将它们从 ADD 选项卡的 firstView 中移到一个新视图中。对于本例，假设活动视图称为 PlayersView。
3.  用户现在单击另一个选项卡，例如 HOME。
4.  用户决定返回添加选项卡。但是，在按下 ADD 选项卡时，用户会被带到最后一个视图，在本例中是 PlayersView。

如何更改功能，以便在按下选项卡时，用户总是被带到该选项卡的 firstView 属性。如上所述，这不会发生。我尝试在 tabbedNavigator 上创建一个 IndexChangeEvent 侦听器，然后更改 tabbedNavigator 的 selectedIndex，但这不起作用。

```
protected function tabbedviewnavigatorapplication1_applicationCompleteHandler(event:FlexEvent):void {

      this.tabbedNavigator.addEventListener(IndexChangeEvent.CHANGE,onIndexChange);
}

protected function onIndexChange(event:IndexChangeEvent):void {

      this.tabbedNavigator.selectedIndex = event.newIndex;
      trace(' THIS DOESN'T WORK');
} 
```

任何帮助表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T07:24:29.370

在您的代码中，当您设置

```
tabbedNavigator.selectedIndex 
```

您在不同的 ViewNavigator 之间切换，而不是在`ViewNavigator`.

据我了解，您正试图留*在*一个`ViewNavigator`堆栈中并选择第一个`View`.

假设您有：

```
<s:navigators>
    <s:ViewNavigator id="addSomethingNavigator" firstView="views.AddView"/>
    <s:ViewNavigator id="deleteSomethingNavigator" firstView="views.DeleteView"/>
</s:navigators> 
```

您可以像这样弹出到特定的 ViewNavigator 的第一个`View`：

```
addSomethingNavigator.popToFirstView(); 
```

# php - 卷曲成 xml 而不是网页

> ID：10791913
> 
> 赞同：0
> 
> 时间：2012-05-29T00:54:25.220
> 
> 标签：php, xml, curl

好的，所以我使用以下代码来设置和检索 curl url

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
$xml_response = curl_exec($ch);
curl_close($ch);
echo $xml_response; 
```

我的问题是我正在调用的 api 具有 xml 格式的数据，所以 curl 以这样的一个大字符串返回数据

509f0e1f-b8d4-4cb8-b4f0-109751dca4eb0.0114370000000000TrueASIN0273702440SmallAll0273702440http://www.amazon.com/Accounting-Finance-Non-Specialists-Peter-....（等）

如何让 curl 以 xml 格式显示数据？

# sql-server-2008 - 空间索引没有任何好处

> ID：10791916
> 
> 赞同：1
> 
> 时间：2012-05-29T00:55:11.210
> 
> 标签：sql-server-2008, tsql, geospatial, spatial-index

我有一个大型查询，试图将质心与它们适合的多边形相匹配。虽然我确实通过块和多边形的 Z 值进行约束，但它仍然会进行**大量**的多点计算并且需要**很长时间**才能运行。

对于一些背景：

*   包含质心的表有 250 万行
*   表中的所有空间数据都在世界很小的一个区域内，整个事物的边界框只有 7643 x 2351 米
*   在这些行中，660K 适合符合 Z 标准
*   包含多边形的表有 10K 行
*   表中的所有空间数据都位于世界上更小的区域
*   在这些行中，有 2366 行符合名称标准
*   在没有任何索引的情况下运行查询需要 11 个小时并返回 91K 匹配项

查询是这样的：

```
select blocks.Id, blocks.WGS84Centroid, polygons.Shape
from 
blocks inner join polygons
    on
    blocks.ZCentre >= (polygons.ZCentre - (polygons.ZLength/2))  and blocks.ZCentre <= (polygons.ZCentre + (polygons.ZLength/2)) and
    polygons.Shape.STIntersects(blocks.WGS84Centroid) = 1
inner join name
    on
    polygons.nameId = name.ID
where name.Name = 'blah' 
```

因此，为了加快查询速度，我在`blocks.WGS84Centroid`和 上添加了一个空间索引`polygons.Shape`。
查询分析器还建议在 blocks.ZCentre 上使用非聚集索引，包括 blocks.Id 和 blocks.WGS84Centroid。

毕竟，这是查询计划：
![SSMS 查询计划](../Images/b2a4dfd03f9b08669e2752d4868a4c0b.png)

和过滤器成本：
![SSMS 过滤器成本](../Images/fd85ceca5c162946b06e0a20cba95071.png)

但是，在添加这 3 个索引之后，查询仍然需要同样长的时间才能运行。
我现在能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:17:16.860

我认为空间索引没有太大帮助的原因可能与地球如此小区域的数据密度有关。
我已经对此进行了一些试验，最好的选择似乎是索引上的密度尽可能高。

在 SQL Server 2008 中，这是通过在 4 级空间索引网格的每一级上使用 HIGH。通过提示优化器使用此索引，我将连接减少到约 1 小时而不是 10 小时！

在 SQL Server 2012 中，我发现了另外几个有趣
的方面：​​首先，如果一个地理对象是一个点，STIntersects() 会得到更好的优化，就像我的例子一样。在我的机器上，同样的查询在 2012 年的运行速度是 2008 年的两倍。

第二个更令人印象深刻！2012 年的一种新型空间索引使用多达 8 级细分。我猜密集数据特别适合索引中这种几何上更高级别的细分，因为当提示使用新索引而不是旧的 4 级索引时，相同的查询运行速度快 45 倍。

# java - 解析 .txt 文件（考虑性能指标）

> ID：10791918
> 
> 赞同：0
> 
> 时间：2012-05-29T00:55:16.577
> 
> 标签：java, parsing

```
DurationOfRun:5
ThreadSize:10
ExistingRange:1-1000
NewRange:5000-10000
Percentage:55 - AutoRefreshStoreCategories  Data:Previous/30,New/70    UserLogged:true/50,false/50      SleepTime:5000     AttributeGet:1,16,10106,10111       AttributeSet:2060/30,10053/27
Percentage:25 - CrossPromoEditItemRule      Data:Previous/60,New/40    UserLogged:true/50,false/50      SleepTime:4000     AttributeGet:1,10107                AttributeSet:10108/34,10109/25
Percentage:20 - CrossPromoManageRules       Data:Previous/30,New/70    UserLogged:true/50,false/50      SleepTime:2000     AttributeGet:1,10107                AttributeSet:10108/26,10109/21 
```

我正在尝试解析上面的 .txt 文件（前四行是固定的，后三行可以增加意味着它可以超过 3），因此我编写了下面的代码及其工作，但它看起来很乱。那么有没有更好的方法来解析上述 .txt 文件，如果我们考虑性能，那么这将是解析上述 txt 文件的最佳方法。

```
private static int noOfThreads;
private static List<Command> commands;
public static int startRange;
public static int endRange;
public static int newStartRange;
public static int newEndRange;
private static BufferedReader br = null;
private static String sCurrentLine = null;
private static List<String> values;
private static String commandName;
private static String percentage;
private static List<String> attributeIDGet;
private static List<String> attributeIDSet;
private static LinkedHashMap<String, Double> dataCriteria;
private static LinkedHashMap<Boolean, Double> userLoggingCriteria;
private static long sleepTimeOfCommand;
private static long durationOfRun;

br = new BufferedReader(new FileReader("S:\\Testing\\PDSTest1.txt"));
values = new ArrayList<String>();

while ((sCurrentLine = br.readLine()) != null) {
    if(sCurrentLine.startsWith("DurationOfRun")) {
        durationOfRun = Long.parseLong(sCurrentLine.split(":")[1]);
    } else if(sCurrentLine.startsWith("ThreadSize")) {
        noOfThreads = Integer.parseInt(sCurrentLine.split(":")[1]);
    } else if(sCurrentLine.startsWith("ExistingRange")) {
        startRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[0]);
        endRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[1]);
    } else if(sCurrentLine.startsWith("NewRange")) {
        newStartRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[0]);
        newEndRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[1]);
    } else {
        attributeIDGet =  new ArrayList<String>();
        attributeIDSet =  new ArrayList<String>();
        dataCriteria = new LinkedHashMap<String, Double>();
        userLoggingCriteria = new LinkedHashMap<Boolean, Double>();

        percentage = sCurrentLine.split("-")[0].split(":")[1].trim();
        values = Arrays.asList(sCurrentLine.split("-")[1].trim().split("\\s+"));
        for(String s : values) {
            if(s.startsWith("Data")) {
                String[] data = s.split(":")[1].split(",");
                for (String n : data) {
                    dataCriteria.put(n.split("/")[0], Double.parseDouble(n.split("/")[1]));
                }
                //dataCriteria.put(data.split("/")[0], value)
            } else if(s.startsWith("UserLogged")) {
                String[] userLogged = s.split(":")[1].split(",");
                for (String t : userLogged) {
                    userLoggingCriteria.put(Boolean.parseBoolean(t.split("/")[0]), Double.parseDouble(t.split("/")[1]));
                }
                //userLogged = Boolean.parseBoolean(s.split(":")[1]);
            } else if(s.startsWith("SleepTime")) {
                sleepTimeOfCommand = Long.parseLong(s.split(":")[1]);
            } else if(s.startsWith("AttributeGet")) {
                String[] strGet = s.split(":")[1].split(",");
                for(String q : strGet) attributeIDGet.add(q); 
            } else if(s.startsWith("AttributeSet:")) {
                String[] strSet = s.split(":")[1].split(",");
                for(String p : strSet) attributeIDSet.add(p); 
            } else {
                commandName = s;
            }
        }
        Command command = new Command();
        command.setName(commandName);
        command.setExecutionPercentage(Double.parseDouble(percentage));
        command.setAttributeIDGet(attributeIDGet);
        command.setAttributeIDSet(attributeIDSet);
        command.setDataUsageCriteria(dataCriteria);
        command.setUserLoggingCriteria(userLoggingCriteria);
        command.setSleepTime(sleepTimeOfCommand);
        commands.add(command); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:31:27.900

好吧，一旦您深入到解析器的较低层，解析器通常会*很混乱:-)*

但是，至少在代码质量方面，一种*可能的改进是认识到您的语法是分层的这一事实。*

我的意思是每一行都是一个识别标记，后面跟着一些属性。

在、和的情况下`DurationOfRun`，属性相对简单。稍微复杂一些，但还可以。`ThreadSize``ExistingRange``NewRange``Percentage`

我会将代码构造为（伪代码）：

```
def parseFile (fileHandle):
    while (currentLine = fileHandle.getNextLine()) != EOF:
        if currentLine.beginsWith ("DurationOfRun:"):
            processDurationOfRun (currentLine[14:])

        elsif currentLine.beginsWith ("ThreadSize:"):
            processThreadSize (currentLine[11:])

        elsif currentLine.beginsWith ("ExistingRange:"):
            processExistingRange (currentLine[14:])

        elsif currentLine.beginsWith ("NewRange:"):
            processNewRange (currentLine[9:])

        elsif currentLine.beginsWith ("Percentage:"):
            processPercentage (currentLine[11:])

        else
            raise error 
```

然后，在每个`processWhatever()`函数中，您根据预期格式解析该行的其余部分。这样可以使您的代码保持小而易读，并且将来可以轻松更改，而无需在泥潭中导航:-)

例如，`processDurationOfRun()`只需从该行的其余部分获取一个整数：

```
def processDurationOfRun (line):
    this.durationOfRun = line.parseAsInt() 
```

同样，两个范围的函数拆分字符串`-`并从结果值中获取两个整数：

```
def processExistingRange (line):
    values[] = line.split("-")
    this.existingRangeStart = values[0].parseAsInt()
    this.existingRangeEnd   = values[1].parseAsInt() 
```

该`processPercentage()`功能是一个棘手的功能，但如果您也将其分层，这也很容易实现。假设这些东西总是按相同的顺序排列，它包括：

*   一个整数；
*   文字`-`;
*   某种文本类别；和
*   一系列`key:value`对。

甚至这些对中的值*也*可以由较低级别解析，首先用逗号分割以获得像`Previous/30`and之类`New/70`的子值，然后将每个子值分割成斜线以获得单个项目。这样，逻辑层次结构可以反映在您的代码中。

除非您期望每秒多次解析此文本文件，或者除非它的*大小**为数*兆字节，否则我会更关心代码的可读性和可维护性，而不是解析速度。

我们需要从代码中榨取最后一点性能的日子已经一去不复返了，但是当发现错误或需要增强时，我们仍然无法及时修复所述代码。

有时最好优化*可读性。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:38:25.187

在确定确实存在性能问题之前，我不会担心性能。关于其余代码，如果您不添加任何新的线型，我不会担心。但是，如果您确实担心，工厂设计模式可以帮助您将所需处理类型的*选择*与实际处理分开。它使添加新的线型更容易，而不会引入太多的错误机会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T03:28:23.647

更年轻、更方便的类是Scanner。您只需要修改分隔符，并一次性读取所需格式（readInt、readLong）的数据 - 无需单独的 x.parseX - 调用。

第二：将你的代码拆分成小的、可重用的部分。它们使程序可读，并且您可以轻松隐藏细节。

例如，不要犹豫对范围使用类似结构的类。从方法返回多个值可以通过这些来完成，而无需样板文件（getter、setter、ctor）。

```
import java.util.*;
import java.io.*;

public class ReadSampleFile
{
    // struct like classes:
    class PercentageRow {
        public int percentage;
        public String name;
        public int dataPrevious;
        public int dataNew;
        public int userLoggedTrue;
        public int userLoggedFalse;
        public List<Integer> attributeGet;
        public List<Integer> attributeSet;
    }
    class Range {
        public int from;
        public int to;
    }

    private int readInt (String name, Scanner sc) {     
        String s = sc.next (); 
        if (s.startsWith (name)) {
            return sc.nextLong ();
        }
        else err (name + " expected, found: " + s);     
    }

    private long readLong (String name, Scanner sc) {
        String s = sc.next (); 
        if (s.startsWith (name)) {
            return sc.nextInt ();
        }
        else err (name + " expected, found: " + s);     
    }

    private Range readRange (String name, Scanner sc) {
        String s = sc.next (); 
        if (s.startsWith (name)) {
            Range r = new Range ();
            r.from = sc.nextInt ();
            r.to = sc.nextInt ();
            return r; 
        }
        else err (name + " expected, found: " + s);
    }

    private PercentageLine readPercentageLine (Scanner sc) {
        // reuse above methods
        PercentageLine percentageLine = new PercentageLine ();
        percentageLine.percentage = readInt ("Percentage", sc);
        // ...
        return percentageLine;
    }

    public ReadSampleFile () throws FileNotFoundException
    {       
        /* I only read from my sourcefile for convenience. 
        So I could scroll up to see what's the next entry.                  
        Don't do this at home. :) The dummy later ...
        */ 
        Scanner sc = new Scanner (new File ("./ReadSampleFile.java"));
        sc.useDelimiter ("[ \n/,:-]");
        // ... is the comment I had to insert.
        String dummy = sc.nextLine (); 
        List <String> values = new ArrayList<String> ();
        if (sc.hasNext ()) {
            // see how nice the data structure is reflected 
            // by this code:  
            long duration = readLong ("DurationOfRun");         
            int noOfThreads = readInt ("ThreadSize");
            Range eRange = readRange ("ExistingRange");
            Range nRange = readRange ("NewRange");
            List <PercentageRow> percentageRows = new ArrayList <PercentageRow> ();
            // including the repetition ...
            while (sc.hasNext ()) {
                percentageRows.add (readPercentageLine ()); 
            }
        }
    }

    public static void main (String args[])  throws FileNotFoundException
    {
        new ReadSampleFile ();
    }

    public static void err (String msg)
    {
        System.out.println ("Err:\t" + msg);
    }
} 
```

# php - php 类扩展

> ID：10791920
> 
> 赞同：0
> 
> 时间：2012-05-29T00:55:43.217
> 
> 标签：php, oop, inheritance

我想知道是否有可能让一个扩展的类有一个 var 集并从基类中使用？

例如：

```
class me
{
    public $hello = array();

    protected function setter($me)
    {
        $this->hello[] = $me;
    }
}

class foo extends me
{
    public function __construct()
    {
        $this->setter('foo');
    }
}

class yoo extends me
{
    public function __construct()
    {
        parent::setter('yoo');
    }
}

$me = new me();
$foo = new foo();
$yoo = new yoo();

print_r($me->hello); 
```

打印的数组是 array() 没有设置任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:59:06.427

是的，您可以通过制作`$hello` [static](http://php.net/manual/en/language.oop5.static.php)来做到这一点：

```
public static $hello = array(); 
```

这样做时，您将不得不删除`$this`from`$this->hello[] = $me;`并将其替换为 a `self`，因为`hello`对于当前对象实例将不再是唯一的：

```
self::$hello[] = $me; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T02:45:30.463

你正在使用

```
parent::setter('yoo'); 
```

但是在我的父类中，该函数未定义为静态的。所以你不能使用 :: 来调用非静态函数。

# asp.net-mvc - Dotless + MVC + Azure 有垃圾而不是 CSS

> ID：10791921
> 
> 赞同：1
> 
> 时间：2012-05-29T00:56:08.053
> 
> 标签：asp.net-mvc, asp.net-mvc-4, azure, dotless

我使用 Nuget 将 Dotless 添加到我的 Azure MVC4 项目中。它不工作。我已经三重检查了一切，似乎没问题。当我下载较少的文件时，这是内容：

```
‹      ì½`I–%&/mÊ{JõJ×àt¡€`$Ø@ìÁˆÍæ’ìiG#)«*ÊeVe]f@Ìí¼÷Þ{ï½÷Þ{ï½÷º;N'÷ßÿ?\fdlöÎJÚÉž!€ªÈ?~|?"~—?ö7ø5ðü:¿Æ÷÷ÿúÀïtögüî¿ðîâŸùÅàw~ÅwþÍÿ¨ý‹ƒ?èø-·ëOú=³ÿîþ£þùÿâOùï~çâó¿ó×~ëþgòŸÌ¿þÛüžÿÜÿçÿ}¿ò?øÅÿãß/ÿü=‡þ‹åøÿ¿ïùì×,ÿ×á;ÿÎ?ýü®Ð_óOý.¿Ç/ý™ßå÷øè—þ§ÿÙÞ_ûÇ–¯þ‹ÿú¼þêŸÿ/ÿëÿ×ßðÅû¿÷âW]ÿÍÿÜEñ·?ÿ½þ÷ßý—üY¿Í?ûËÿ¾¿è¯ø]þÃÏþê?cñ”ÿão“ÿâ‡ã_öWüªÿí_®þ¼¿ì¿þ•¿É?ðoýãÍ‹ÿ°zðÿ¦ÿËçï¯þk¯þÈÿãß?ù?—?õ§õþSÿãŸøþ—ÿîgÿàïòKþ·¿ÿßÿÉývå¿øËþ“ÉpôïüÎÿáßûþoÿ÷¯óküÿ÷ÿýçÿ’ã¿éïù5~_ãÿ   ÿÿiÓÀû 
```

不幸的是，它似乎没有正确下载。知道为什么在开发环境中添加到 Windows Azure 项目时会出现这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T05:52:41.220

看起来响应被 gzip 压缩了两次。

默认情况下，dotless 处理 gzip/deflate 压缩，但由于您可以打开 IIS 来执行此操作，您可以通过将`handleWebCompression="false"`属性添加到配置节节点来禁用 dotless。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:43:20.873

当你说“在 Azure 之外运行”时——在哪里？VS2010 开发服务器还是完整的 IIS？7

看看 mime 类型和处理程序。

确保 .less 映射到 IIS7 部分，而不仅仅是部分。前者适用于 IIS7。

如果您没有安装 IIS7，请尝试让它在 IIS Express 下运行。

Azure 上没有什么比 Windows Server 2008 或 2008 R2 和 IIS7+ 更神奇的了。

# regex - 检索以 EOL、空格结尾或没有任何字符的单词。正则表达式

> ID：10791923
> 
> 赞同：0
> 
> 时间：2012-05-29T00:56:13.727
> 
> 标签：regex

我有一个包含这些模式的单词的文件

```
word word2
word
word word
word wordword 
```

我需要计算所有只是'word'而不是'word2'或wordword的单词。

我试过

```
$ grep 'word[^a-ZA-Z0-9 | $]' testWordCount.txt       
$ grep 'word[^a-ZA-Z0-9]' testWordCount.txt    
$ grep 'word[$| ]' testWordCount.txt 
```

抱歉，如果其中一些没有意义。我正在学习正则表达式。很抱歉没有包括用于正则表达式的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:57:29.540

使用以下正则表达式匹配行：

```
/\bword\b/ 
```

`\b`是一个[单词边界锚](http://www.regular-expressions.info/wordboundaries.html)，它将匹配单词的开头、单词的结尾、行的开头或行的结尾。

您可以在[RegexPal](http://regexpal.com/?flags=g&regex=%5Cbword%5Cb&input=word%20word2%0Aword%0Aword%20word%0Aword%20wordword)测试此表达式。

* * *

我看到你正在使用 grep - 这个正则表达式引擎使用`\<`和`\>`转义词边界。

```
/\<word\>/ 
```

* * *

此外，这里是计算 bash 中所有实例的方法：

```
cat testWordCount.txt | tr ' ' '\n' | grep -c '\<word\>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:56:03.430

egrep -o 在一行上打印匹配的标记，最后可以很容易地计算出来。`\b`表示**边界**或类似的东西。

```
egrep -o "\bword\b" words.txt | wc 
```

# ruby-on-rails-3 - 无法在 Rails 3 App 中使用 cocoon 和 simple_forms 为嵌套表单批量分配受保护的属性

> ID：10791927
> 
> 赞同：1
> 
> 时间：2012-05-29T00:56:35.547
> 
> 标签：ruby-on-rails-3, simple-form, nested-forms, cocoon-gem

**问题：**

我在提交表单时收到一条错误消息，上面写着：

> ActiveModel::MassAssignmentSecurity::AdmissionRecordsController#create 中的错误
> 
> 无法批量分配受保护的属性：admission_record

**我的设置：**

我正在使用 Rails 3.2.3，还有额外的 gem，包括 Cocoon 1.0.14 和 Simple_Form 2.0.2

**风景：**

我的`app/views/admission_records/_form.html.haml`样子：

```
= simple_form_for [@admission, @record] do |f|
  = f.simple_fields_for :vital_signs, @record.vital_signs.build do |vs|
    = render :partial => "vital_sign_fields", :locals => { :f => vs }
    = link_to_add_association "Add Vital Signs", f, :vital_signs
  = f.submit 
```

我的`app/views/admission_records/_vital_sign_fields.html.haml`样子：

```
.nested-fields
  = f.label :sbp
  = f.text_field :sbp
  ...
  = link_to_remove_association "Remove Vital Sign" 
```

我基本上想做的是我有一个名为 AdmissionRecord 的资源嵌套在另一个名为 PatientAdmission 的资源中（`route.rb`如下所示）。我有另一个名为的资源`VitalSign`，我希望在创建`AdmissionRecord`

我的`config/routes.rb`文件看起来像：

```
resources :patient_admissions do
  resources :admission_records
end 
```

**模型：**

我的`app/models/patient_admission.rb`样子：

```
class PatientAdmission < ActiveRecord::Base
  has_many :admission_records, :dependent => :destroy
end 
```

我的`app/models/admission_record.rb`样子：

```
class AdmissionRecord < ActiveRecord::Base
  belongs_to :patient_admission
  has_many :vital_signs, :dependent => :destroy

  accepts_nested_attributes_for :vital_signs, :rejects_if => :all_blank, :allow_destroy => true
  attr_accessible :vital_signs_attributes
end 
```

我的`app/models/vital_sign.rb`样子：

```
class VitalSign < ActiveRecord::Base
  belongs_to :admission_record
  attr_accessible # just fields that appear in the form
end 
```

**控制器：**

我的`new`and`create`方法`AdmissionRecordsController`看起来像：

```
before_filter do
  @admission = PatientAdmission.find(params[:patient_admission_id])
end

def new
  @record = @admission.admission_records.build
end

def create
  @record = @admission.admission_records.build(params[:admission_record])
  @vital_sign = @record.vital_signs.build(params[:vital_signs])
  @vital_sign.save
  if @record.save
    # Flash success and redirect to the right place
  else
    # Flash error and render :new
  end
end 
```

**请求：**

请帮我找出哪里出错了。我已经搜索了几个小时，并查看了演示应用程序的其他示例和源代码，例如在[cocoon_simple_form_demo](https://github.com/nathanvda/cocoon_simple_form_demo/blob/master/app/views/projects/_form.html.slim)中找到的那些，但似乎仍然无法修复此错误。如果调试此问题需要任何其他信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T09:16:59.733

好的，我刚刚遇到了这个问题，并通过在 belongs_to 模型中输入一行代码来解决它。

```
# patient_admission.rb
Class PatientAdmission < ActiveRecord::Base
  attr_accessible :admission_record_attributes

  accepts_nested_attributes_for :admission_record

  ...
end 
```

这是[另一个](https://stackoverflow.com/questions/16050083/in-nested-form-cant-mass-assign-protected-attributes)解决方案:)

# html - CSS 特异性和不推荐使用的 HTML 属性

> ID：10791929
> 
> 赞同：3
> 
> 时间：2012-05-29T00:56:44.357
> 
> 标签：html, css, css-specificity

如果有的话，以下应用的样式的隐含[特性是什么：](http://www.w3.org/TR/CSS21/cascade.html#specificity)

```
<iframe src="..." height="300" width="500"></iframe> 
```

它是否仍然获得`specificity = 1,0,0,0`并覆盖任何其他应用的样式？这将如何与*适当的*内联样式一起使用，即优先：

```
<iframe src="..." height="300" width="500" style="height:150px;width:600px;"></iframe> 
```

浏览器是否同意更喜欢`style=""`声明而不是无效的声明，或者还有其他事情发生？

**注意**：我只是对在这种情况下选择正确样式的机制感到好奇，但不提倡这样的声明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T04:44:46.693

[根据您提到的页面上的最后一节，非 CSS 表示性提示的优先级，](http://www.w3.org/TR/CSS2/cascade.html#preshint)可以将表示性 HTML 属性映射到的 CSS 规则的特异性为零 (0) 。因此，页面的真实样式表中的设置会覆盖这些属性，例如`style="height:150px;width:600px;"`wins`height`和`width`属性。

这不依赖于属性的有效性。有效性是一个正式的东西，不会影响浏览器的行为。即使您声明了 Strict doctype，浏览器仍然会尊重它们识别的那些表示属性。（对此没有规范。这就是事情的运作方式。）

PS 本节中的示例可能看起来很奇怪。为什么`font[color] { color: orange; }`在用户样式表中不影响HTML 文档中`font`具有属性的元素？`color`原因是属性被转换为*作者*（页面）样式表中的 CSS 规则，并且（在没有 的情况下`!important`）作者样式表中的任何内容都会赢得*用户*样式表。但是`font[color] { color: orange; }`在*作者*样式表中会覆盖标记中设置的颜色，例如`<font color=red>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:16:37.643

属性和/或任何 css 声明将`style=""`始终优先于`width`和`height`html 属性。

在任何情况下，总是建议使用 CSS 样式表。

# asp.net-mvc-3 - MVC3 + 来自数据库的流式图像在我的服务器上导致非常高的 CPU 使用率

> ID：10791933
> 
> 赞同：0
> 
> 时间：2012-05-29T00:57:31.490
> 
> 标签：asp.net-mvc-3, cpu-usage, memorystream, filestreamresult

我有一个从数据库（SQL2008）流式传输图像的站点，我认为这是导致我的服务器上 CPU 使用率非常高的站点。CPU 使用率至少为 60-90%。

我正在使用 MVC3，下面是我的控制器中将图像发送到视图的代码：

```
 [OutputCache(Duration = 86400, VaryByParam = "GUID")]
 public FileStreamResult GetFile(string guid)
    {
        Guid id = new Guid(guid);
        Thumbnail thumbnail = thumbService.GetThumbnailByGUID(id);
        Stream stream = new MemoryStream(thumbnail.FileContent.ToArray());
        var fsr = new FileStreamResult(stream, "image");
        return fsr;
    } 
```

风景：

```
 <div style="background:url('@url');background-repeat:no-repeat;background-position:50% top;background-color:#fff;" class="photoThumb"> 
```

上面的@url 是 /GetFile/guid

谁能告诉我我做错了什么？

谢谢

答案和另一个问题的更新：

下面答案中的 [OutputCache(Duration = 86400, VaryByParam = "GUID")] 有效，并提高了网站的性能。CPU 使用率现在已下降到 8-60%，但我还想确保所有东西都已处理完毕，所以我想知道 FileStreamResult 是为我做这件事还是应该手动做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T04:42:22.640

我猜每个图像请求都有一个数据库命中，每个页面请求有多个图像 - 这可能导致 CPU 使用率高。您应该尝试缓存图像。

如果你用

`[OutputCache( Duration = 86400, VaryByParam = "id" )]`

这应该将结果图像缓存一天，这意味着更少的数据库查询，并希望减少服务器上的负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T12:23:30.237

您也可以进行如下修改。

```
[OutputCache(Duration = 86400, VaryByParam = "GUID")]
     public FileStreamResult GetFile(string guid)
        {
            Guid id = new Guid(guid);
            Thumbnail thumbnail = thumbService.GetThumbnailByGUID(id);
            var fsr; 
            using(Stream stream = new MemoryStream(thumbnail.FileContent.ToArray()))
            {
                fsr = new FileStreamResult(stream, "image");
            }
            return fsr;
        } 
```

正如上面评论中提到的，当你的页面渲染时 FileStreamResult 会自动处理。

# c++ - 检查客户端和服务器之间的延迟

> ID：10791935
> 
> 赞同：1
> 
> 时间：2012-05-29T00:57:42.007
> 
> 标签：c++, qt, client, latency, performance

我一直在考虑这个：向客户端发送一条“消息”，然后每当服务器收到它时，我将发送日期与接收日期进行比较，然后我会从那里得到 ms。

但我的问题是，有没有其他有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:16:23.037

至于基本概念：

只需发送一个信号（如 ping ）并等待它返回。执行时间告诉您服务器和客户端之间的延迟。

但是，您需要经常执行此操作才能获得准确的值。问题是网络延迟是高度可变的。

再说一次，这样做可能根本不可行，因为涉及的不仅仅是发送和接收信号。例如，数据包可能采用的实际路由可能会有所不同。

此外，有人会认为将执行时间除以 2 会得到准确的结果，但事实并非如此。
服务器到客户端可能比回程更快，从而搞砸了结果。

# drupal - Drupal 中的文件结构/目录视图

> ID：10791937
> 
> 赞同：0
> 
> 时间：2012-05-29T00:57:59.570
> 
> 标签：drupal

有没有办法在 Drupal 中拥有某种文件结构或目录视图？我一直在寻找几个星期，但没有找到任何东西。

编辑：我希望内容视图（管理员级别）中的每个网页都有某种文件组织，我希望能够拥有文件夹和子文件夹，它们基本上看起来像 www.example.com/folder/another_folder/file .html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:00:57.117

如果您正在为您的用户寻找文件浏览器/管理器，那么比较流行的一种是[IMCE](http://drupal.org/project/imce)。

> IMCE 是一个支持个人目录和配额的图像/文件上传器和浏览器。

查看[IMCE 页面](http://drupal.org/project/imce)上的相关项目以查看其他类似模块。

# php - 使用 PHP 确定图像的 DPI

> ID：10791938
> 
> 赞同：2
> 
> 时间：2012-05-29T00:58:12.520
> 
> 标签：php, image-processing, imagemagick, gd

使用 ImageMagick 或 GD 在 PHP 中确定图像 DPI 的最快和最简单的方法是什么？虽然确定各种格式的 DPI 会很好，但至少应该支持 JPEG 和 PNG。

类似问题： [如何使用 PHP 检查照片 DPI](https://stackoverflow.com/questions/5892731/how-to-check-photo-dpi-with-php)

[仅 JPEG 解决方案](http://sandalian.com/php/get-dpi-value-of-an-image-using-php.html)

# iphone - 在 Flash 上运行 iOS 应用程序

> ID：10791949
> 
> 赞同：3
> 
> 时间：2012-05-29T00:59:31.927
> 
> 标签：iphone, ios, flash, ipad

我在 iPhone 和 iPad 上为 iOS 编写了一个应用程序。我想通过 Flash 在我的网站上制作我编写的应用程序（儿童游戏）。我不知道这是否可能...

我只需要用另一种语言编写应用程序吗？我找不到任何可以帮助我使其可用的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:08:49.577

如果你用 HTML5 编写你的应用程序，那么你可以让它在你的网站上可用，但如果用 obj C 编写，我非常怀疑除了用另一种语言重新编写应用程序之外，还有什么简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:01:46.933

没有工具可以让 iOS 应用程序通过 Flash Player 运行。

编写将作为本机应用程序运行并在 Web 中运行的应用程序的最佳选择可能是编写针对智能手机优化的 Web 应用程序。通过这种方式，您可以使用 UIWebView 在本机应用程序中运行它（因此仍然在 App Store 中），但也可以通过网络使用它。你甚至可以考虑利用像 Phonegap 这样的工具来帮助解决这个问题。但这当然意味着重新编写您的应用程序。

# java - 从服务器端（Java）向 Facebook 用户发送消息

> ID：10791951
> 
> 赞同：0
> 
> 时间：2012-05-29T01:00:49.880
> 
> 标签：java, facebook, server-side

我有一个异步执行大量处理的网站，在某些时候，应该向以前安装了我网站的 Facebook 应用程序的用户发送私人消息。

是否可以从服务器端（Java）直接向这些用户发送消息？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:34:15.160

这是不可能的，如果是的话，想象一下 Facebook 用户会收到多少垃圾邮件。

或者，您可以访问他们的电子邮件（具有适当的权限），并改用它。

# regex - 正则表达式：将某个单词之前的所有单词更改为大写

> ID：10791952
> 
> 赞同：0
> 
> 时间：2012-05-29T01:01:23.880
> 
> 标签：regex, yahoo-pipes

我正在寻找以下形式的字符串：

作者姓名未知长度的文章标题：some.url

只需将其更改为：

作者姓名未知长度的文章标题：some.url

我尝试了各种可以成功挑选文章标题的选项，例如

```
(^.*?by) 
```

并将用我想要的任何东西替换它。例如，如果我说

```
replace [(^.*?by)] with [test title] 
```

以上变为：

作者姓名的测试标题：some.url

但是，每当我尝试用 \U$1 替换它时，它都会使整个字符串大写，而不仅仅是与查询匹配的字符串。

我究竟做错了什么？顺便说一句，我是一个完整的正则表达式菜鸟，一个小时前才开始，但任何帮助都将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:37:01.653

```
$string = 'Article Title Of Unknown Length by Author Name: some.url';
$string =~ s/^(.*)(?= by )/\U\1\E/gi;
print $string; # ARTICLE TITLE OF UNKNOWN LENGTH by Author Name: some.url 
```

编辑>

```
/           search for
^           at start of string 
(.*)        match and capture a group of 0+(`*`) any character (`.`)
(?= by )    followed by literal " by " (`?=` is positive lookahead)
/           replace with
\U          start upper-casing
\1          the first captured group
\E          stop upper-casing
/           options
g           search globally
i           case insensitive 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T08:00:42.720

请注意，guido 如何在“by”周围包含空格，以便此正则表达式与“Messing With Abby by Abby: some.url”等内容一起使用。如果您的输入中有标签等，您可能希望将它们替换为“\s”。不确定雅虎管道是如何工作的。很可能`replace [^(.*)(?= by )] with [\U$1]`会成功。无论如何，模式`^(.*)( by )(.*)$`将匹配整个输入，分为三个部分，所以从这里应该很容易弄清楚如何重建你需要的东西`replace [^(.*)( by )(.*)$] with [\U$1 by \$3]`或类似的东西。

# php - PHP：简化多个 || 运算符语句合二为一？

> ID：10791953
> 
> 赞同：1
> 
> 时间：2012-05-29T01:01:24.340
> 
> 标签：php, operators

> **可能重复：**
> [具有多个条件的 php if 语句](https://stackoverflow.com/questions/5593512/php-if-statement-with-multiple-conditions)

我有这个代码：

`if(x==1 || x==2 || x==3 || x==4 )`

反正有没有更短的？例如：

`if(x==1||2||3||4 )`

如果 X= 1,2,3 OR 4，这句话的意义是什么？

先感谢您。

**编辑：（**感谢所有回复，这里有一些澄清）

我有一个 while 循环，但只希望调用特定的数据库条目。我的代码是最新的

```
<?php while(the_repeater_field('team_members','options') && get_sub_field('member_sort') == 1 : ?>
 <div class="one_fourth">
        <img src="<?php the_sub_field('image'); ?>" alt="" />
        <p>
          <?php the_sub_field('info'); ?>
            <br />
            <a href="mailto:<?php the_sub_field('email'); ?>"><?php the_sub_field('email'); ?></a>
        </p>
 </div>
<?php endwhile; ?> 
```

现在它与 == 1 完美配合，但我也想显示 2,3,4 。我只是不确定我应该如何放置代码来执行 1||2||3||4

**更新 2：**

好的，所以我使用了以下代码，但我猜我的做法是错误的。下面的代码只显示了等于 1 的记录……但不显示等于 2,3,4 的记录……我猜是因为 while 循环只运行一次，因为该语句立即变为真。

```
 <?php while(the_repeater_field('team_members','options') && in_array(get_sub_field('member_sort'),array(1,2,3,4))): ?>
                        <div class="one_fourth">
                            <img src="<?php the_sub_field('image'); ?>" alt="" />
                            <p>
                                <?php the_sub_field('info'); ?>
                                <br />
                                <a href="mailto:<?php the_sub_field('email'); ?>"><?php the_sub_field('email'); ?></a>
                            </p>
                        </div>
                    <?php endwhile; ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T01:04:15.847

```
if (in_array($x, array(1,2,3,4)) 
```

甚至：

```
if (in_array($x, range(1, 4))) 
```

好的，这个问题已经发展了很多，但我认为现在的问题是你想遍历所有值，但只在某些条件下做事情。您可以使用该`continue`语句中止当前迭代并立即进入下一个迭代。

```
<?php while (the_repeater_field('team_members','options')) : ?>
    <?php if (!in_array(get_sub_field('member_sort'), array(1,2,3,4))) continue; ?>

    ... do stuff

 <?php endwhile; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T01:04:57.690

这取决于你有多少，以及是否可能有其他条件，但要么`switch`：

```
switch(x) {
    case 1:
    case 2:
    case 3:
    case 4:
        break;
    default:
        // Do stuff
} 
```

或者一个数组，特别是对于许多项目：

```
if(!in_array(x, array(1, 2, 3, 4)) {
    // Do stuff
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T01:05:07.587

如果您使用的是 PHP 5.4+，您可以这样做：

```
if (in_array($x, [1,2,3,4])) 
```

否则，它是：

```
if (in_array($x, array(1,2,3,4))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T05:07:36.790

没有办法。只能通过使用数组。

# java - Java - 创建内部时钟

> ID：10791954
> 
> 赞同：3
> 
> 时间：2012-05-29T01:01:34.053
> 
> 标签：java, time, clock, internal

我希望从 Java 中的特定时间计算经过的时间（以毫秒为单位）。

它用于开始时间的经典方式`System.currentTimeMillis();`，然后再次与前一个一起使用以获取经过时间。我希望做类似的事情，但不要依赖系统时间。

如果我依赖系统时间，程序的用户可以操纵系统时钟来破解程序。

我尝试使用类似于以下的代码：

```
int elapsed = 0;
while (true) {
    Thread.sleep(10);
    elapsed += 10;
} 
```

这可行，但是在计算机滞后然后锁定一两秒钟的情况下，我不太可靠。

有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T01:08:18.523

你想利用`System.nanoTime`. 它与系统时钟无关。它只能用于跟踪相对时间，这似乎是您想要做的。

为了防止这个答案只是指向另一个答案的链接，这里有一个简短的解释。

从文档

> **public static long nanoTime()**返回最精确的可用系统计时器的当前值，以纳秒为单位。
> 
> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关。返回的值表示自某个固定但任意时间以来的纳秒（可能在将来，因此值可能为负数）。此方法提供纳秒精度，但不一定提供纳秒精度。不保证值的变化频率。由于数值溢出，超过大约 292 年（2 ^(63纳秒）的连续调用的差异将无法准确计算经过的时间。)

另一个指向计时器信息的链接：[https ://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks](https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)

您可以使用 Java 的 Timer 类以某种特定的精度产生一个“检查”回调，比如说每 500 毫秒。此回调不会用于确定 500 毫秒是否确实通过了。您将调用`System.nanoTime`回调并将其与您上次调用的时间进行比较`System.nanoTime`。无论挂钟如何变化，这都会为您提供相当准确的时间表示。

你可以看看这里：[System.currentTimeMillis vs System.nanoTime](https://stackoverflow.com/questions/351565/system-currenttimemillis-vs-system-nanotime)

# fortran - 在 FORTRAN 中有效地搜索数组

> ID：10791957
> 
> 赞同：1
> 
> 时间：2012-05-29T01:01:49.587
> 
> 标签：fortran, numerical-methods, finite-element-analysis

我试图以稀疏格式将刚度矩阵存储在 FORTRAN 中以节省内存，即我正在使用三个非零元素向量（irows、icols、A）。在找出这些数组的大小之后，下一步是在其中插入值。所以我使用高斯点，即对于每个高斯点，我要找出局部刚度矩阵，然后将这个局部刚度矩阵插入全局（irows，icols，A）之一。

这种插入的主要问题是，每次我们必须检查新值是否存在于全局数组中，所以如果值存在，则将新值添加到旧值中，如果不添加到末尾。即我们必须搜索整个数组以查找该值是否存在。如果这些数组（irows、icols、A）的大小很大，那么这个搜索在计算上是非常昂贵的。

任何人都可以提出一种更好的方法来为每个高斯点插入全局刚度矩阵的局部刚度矩阵。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T02:34:10.917

如果您使用预先排序的数据结构，那么搜索它会非常有效。作为您的主要数据结构或作为辅助数据结构。您想要一个可以在中间插入另一个条目的条目。例如，二叉搜索树 (http://en.wikipedia.org/wiki/Binary_search_tree)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T03:02:35.007

我相当确定这是 FEM 分析中的一个众所周知的问题 - 我在这个[scipy 文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.coo_matrix.html#scipy.sparse.coo_matrix)中找到了对它的引用，但当然主体是独立于语言的。基本上你应该做的是以你拥有的格式创建你的矩阵，而不是搜索矩阵来查看一个条目是否已经存在，只是假设它不存在。这意味着您最终会得到重复的条目，这些条目需要添加在一起才能获得正确的值。

一旦你构建了你的矩阵，你通常会将它转换为一些更有效的形式来解决它（例如[CSR 等](http://en.wikipedia.org/wiki/Sparse_matrix)） - 确切的格式可能由你正在使用的稀疏求解器确定。在此转换过程中，应将重复的条目添加在一起 ​​- 一些稀疏矩阵库会为您执行此操作。我知道 scipy 是这样做的，它的许多内部例程都是用 fortran 编写的，所以你也许可以使用其中的一个（它们都是开源的）。或者您可以检查[netlib](http://www.netlib.org/master/expanded_liblist.html)上是否有任何合适的东西。

# jquery - Jquery Mobile Web：是否可以调用本机应用程序？

> ID：10791961
> 
> 赞同：3
> 
> 时间：2012-05-29T01:02:34.403
> 
> 标签：jquery, jquery-mobile

我希望能够触摸移动网页上的链接并让它启动一个本地移动应用程序，例如 Skype。这似乎是一个巨大的安全问题，但我想知道移动环境是否允许这样做？

编辑：是的！有用。对 document.window = "myapp://myparam" 的 javascript 调用效果很好！或者例如，以下工作：

document.window = "skype://";

诀窍是知道应用程序的名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T01:07:53.973

没有移动网页不允许这样做，但有一些替代方案。

构建移动应用程序时，您有 3 个选择

1.  本机应用程序
2.  Web应用程序
3.  混合应用

第一个选项与设备无关，因为您需要专门为每个设备进行编程。

第二个选项不允许您访问本机设备控件（至少还没有 HTML5）

最后一个选择是用本机语言编写一个简单的包装应用程序并在其中呈现一个浏览器。这可以实现两全其美。大多数内容是作为网络应用程序构建的，但某些功能可以使用本地语言。

这是其中两种混合方法

*   PhoneGAP [http://phonegap.com/](http://phonegap.com/)
*   WorpkLight [http://www.worklight.com](http://www.worklight.com)

# c++ - X 获取和发送击键 C++

> ID：10791962
> 
> 赞同：2
> 
> 时间：2012-05-29T01:02:39.060
> 
> 标签：c++, linux, keyboard, xorg

我想为linux制作一个文本替换程序。即，我键入类似 .alog 的内容，然后将其替换为 /usr/local/apache/logs/。我知道我可以用 alaises 做到这一点，但我经常远程登录没有这种 alaises 的机器。

我也有兴趣这样做以用于学习目的。

我在网上看到一些关于在 X 中为我制作的窗口抓取和发送击键的信息，但找不到有关为工作区中的所有窗口执行此操作的信息。

任何有关如何执行此操作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T01:19:59.113

您可能希望以窗口管理器的代码为起点；无论窗口如何，窗口管理器都会绑定键来工作，这可能是一个好的开始。[`dwm`](http://dwm.suckless.org/)被广泛认为拥有漂亮的代码。

`setup()`似乎直接将其事件掩码添加到根窗口：

```
 screen = DefaultScreen(dpy);
    root = RootWindow(dpy, screen);
    /* ... */
    /* select for events */
    wa.cursor = cursor[CurNormal];
    wa.event_mask = SubstructureRedirectMask|SubstructureNotifyMask|ButtonPressMask|PointerMotionMask
                    |EnterWindowMask|LeaveWindowMask|StructureNotifyMask|PropertyChangeMask;
    XChangeWindowAttributes(dpy, root, CWEventMask|CWCursor, &wa);
    XSelectInput(dpy, root, wa.event_mask);
    grabkeys(); 
```

# javascript - 可以更改“jquery UI 自动完成”功能中传递的默认“Term”名称吗？

> ID：10791968
> 
> 赞同：5
> 
> 时间：2012-05-29T01:03:40.897
> 
> 标签：javascript, jquery, jquery-ui, autocomplete, jquery-ui-autocomplete

我正在尝试使用 jquery ui 自动完成功能更改默认设置为该“术语”字段。是否可以轻松地将其更改为“q”（查询）而无需在“核心”文件中进行更改？

JavaScript：

```
<script>
    $(function() {
        $( "#spotify_song_search" ).autocomplete({
            source: "http://ws.spotify.com/search/1/track.json",
            data: { 
                q: request.term 
            },
            dataType: "getjson",
            minLength: 3,
            select: function( event, ui ) { 
                alert('select'); 
            }
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T01:29:14.170

是的，可以通过发出您自己的 AJAX 请求来实现。

假设您有以下设置：

```
$("#myfield").autocomplete({
    source: '/my_url/myservice.xyz'
}); 
```

默认情况下自动完成（如您所见）发送的请求如下所示：

> myservice.xyz?term=abc"

`source`您可以提供对自动完成选项的函数引用。在该函数中，您可以发出自己的 AJAX 请求，如下所示：

```
$("#myfield").autocomplete({
     source: function (request, response) {
         // request.term is the term searched for.
         // response is the callback function you must call to update the autocomplete's 
         // suggestion list.
         $.ajax({
             url: "/my_url/myservice.xyz",
             data: { q: request.term },
             dataType: "json",
             success: response,
             error: function () {
                 response([]);
             }
         });
     });
}); 
```

这应该生成一个看起来更像的请求：

> myservice.xyz?q=abc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:12:11.183

您可以使用回调`source`选项并提出自己的请求。

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

# c# - 使用 NHibernate 在两个数据库之间复制数据

> ID：10791971
> 
> 赞同：2
> 
> 时间：2012-05-29T01:04:07.320
> 
> 标签：c#, nhibernate, replicate

各位晚上好。

我正在寻找一种在两个数据库之间复制数据的方法，将选择一些（或全部）表，可能是在这些表中确定的所有数据，并将其复制到具有相同结构但在不同数据库中的其他表。我们使用NHibernate，uNhAddIns，在网上搜索，我找到了一些关于ISession.replicate()的东西，但是找不到有效的文档说明如何使用它。

我们还不知道我们将如何做，如果它会在我们的应用程序启动时复制一些表（预选），我正在计划这个。但我真的很感激任何类型的帮助。那么，任何人都有可以帮助理解这个工具的任何东西、教程、文章吗？

谢谢你。

# linq - 具有嵌套 .Any() 条件的 NHibernate LINQ 查询

> ID：10791982
> 
> 赞同：1
> 
> 时间：2012-05-29T01:05:14.577
> 
> 标签：linq, nhibernate

这是我的课程的样子：

```
class User
{
    IList<UserRedemptionCode> UserRedemptions;
}

class UserRedemptionCode
{
    string Code;
}

class Course
{
    IList<CourseRedemptionCode> CourseRedemptions;
}

class CourseRedemptionCode
{
    string Code;
    string SomeData;
} 
```

我想检索与与用户关联的兑换代码匹配的所有课程。这是我正在进行的当前 IQuerable 调用：

```
IQueryable<Course> query = Courses.Where(
    course => course.CourseRedemptions.Any(
        cr => user.UserRedemptions.Any(rc => cr.Code == rc.Code)); 
```

但是，这似乎不适用于 NHibernate。我得到这个例外：

```
System.NotSupportedExceptionSpecified method is not supported.
  at NHibernate.Hql.Ast.ANTLR.PolymorphicQuerySourceDetector.GetClassName(IASTNode querySource)
  at NHibernate.Hql.Ast.ANTLR.PolymorphicQuerySourceDetector.Process(IASTNode tree)
  at NHibernate.Hql.Ast.ANTLR.AstPolymorphicProcessor.Process()
  at NHibernate.Hql.Ast.ANTLR.ASTQueryTranslatorFactory.CreateQueryTranslators(IASTNode ast, String queryIdentifier, String collectionRole, Boolean shallow, IDictionary`2 filters, ISessionFactoryImplementor factory)
  at NHibernate.Hql.Ast.ANTLR.ASTQueryTranslatorFactory.CreateQueryTranslators(String queryIdentifier, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 filters, ISessionFactoryImplementor factory)
  at NHibernate.Engine.Query.QueryPlanCache.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters)
  at NHibernate.Impl.AbstractSessionImpl.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow)
  at NHibernate.Impl.AbstractSessionImpl.CreateQuery(IQueryExpression queryExpression)
  at NHibernate.Linq.DefaultQueryProvider.PrepareQuery(Expression expression, IQuery& query, NhLinqExpression& nhQuery)
  at NHibernate.Linq.DefaultQueryProvider.Execute(Expression expression)
  at NHibernate.Linq.DefaultQueryProvider.Execute[TResult](Expression expression)
  at Remotion.Linq.QueryableBase`1.GetEnumerator()
  at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
  at System.Web.Http.Filters.EnumerableEvaluatorFilter.Convert[T](Object input)
  at System.Web.Http.Filters.EnumerableEvaluatorFilter.OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
  at System.Web.Http.Filters.ActionFilterAttribute.CallOnActionExecuted(HttpActionContext actionContext, HttpResponseMessage response, Exception exception)
  at System.Web.Http.Filters.ActionFilterAttribute.<>c__DisplayClass4.<System.Web.Http.Filters.IActionFilter.ExecuteActionFilterAsync>b__2(HttpResponseMessage response)
  at System.Threading.Tasks.TaskHelpersExtensions.<>c__DisplayClass2e`2.<Then>b__2d(Task`1 t)
  at System.Threading.Tasks.TaskHelpersExtensions.ThenImpl[TTask,TOuterResult](TTask task, Func`2 continuation, CancellationToken cancellationToken) 
```

还有另一个问题，在此查询中，我返回了课程列表，但我还需要与用户关联的 CourseRedemptionCode，以便获取 SomeData。

有任何想法吗？还有另一种方法可以进行此查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T08:39:34.857

NHibernate Jira 中有几个匹配“PolymorphicQuerySourceDetector”或“Any”的问题，最近修复了一些问题，但您没有说明您使用的是哪个 NHibernate 版本。

作为替代方案，并且可能更好，请尝试以下方式：

```
var codes = user.UserRedemptions.Select(ur => ur.Code).ToList();

var query = (from c in Courses
             from cr in c.CourseRedemptions
             where codes.Contains(cr.Code)
             select new { c, cr }); 
```

请注意，如果多个代码匹配，您将在响应中多次获得相同的课程。您还可以从 select 语句中删除“cr”，然后在内存中查找匹配的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-06T04:10:18.333

在您尝试 Oskar 的答案之前，请尝试此操作，因为根据映射，它可能在 SQL 中工作：

示例 - 替换：

```
.Where(u => u.Businesses.Any(ub => trainee.Businesses.Any(tb => tb.Id == ub.Id))) 
```

和

```
.Where(u => u.Businesses.Any(ub => trainee.Businesses.Contains(ub))) 
```

我刚试过这个，它对我有用。YMMV！如果是这样，它应该是首选，因为它可以创建更简洁的 SQL 语句并拉回更少的数据。

# list - Salesforce apex 触发列表中的重复 ID

> ID：10791984
> 
> 赞同：3
> 
> 时间：2012-05-29T01:05:38.700
> 
> 标签：list, triggers, duplicates, salesforce

在我的订单插入触发器中，我需要更新订单信息的联系人，我知道我的联系人列表中有重复的记录。所以我使用 Contact[] contactToUpdate = new List(new Set(contactList)); 删除重复项。

但我仍然收到错误消息：List 中重复。

任何的想法？？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T03:34:09.023

你是正确的，一个集合包含独特的元素，但问题是你正在处理联系人的实例：仅仅因为两个实例引用数据库中的同一个联系人，它们在内存中仍然是不同的对象实例，因此是唯一的，结果是您可能必须在集合中表示具有相同 ID 的相同联系人的条目。

解决此问题的最简单方法是使用 id 映射来联系：

```
map<Id, Contact> contactMap = new map<id, Contact>(); 
```

对于您处理的每个订单，您可以使用联系人查找作为地图的键来访问您要更新的联系人。在处理结束时，您可以通过调用来更新联系人：

```
update mapContacts.values(); 
```

# java - 即使文件存在并且拼写正确，也会出现 FileNotFoundException

> ID：10791986
> 
> 赞同：5
> 
> 时间：2012-05-29T01:06:05.653
> 
> 标签：java, filenotfoundexception

我正在创建一个小程序，它将读取一个文本文件，该文件包含大量随机生成的数字，并生成平均值、中位数和众数等统计数据。我已经创建了文本文件，并确保在声明为新文件时名称完全相同。

是的，该文件与类文件位于同一文件夹中。

```
public class GradeStats {
public static void main(String[] args){
    ListCreator lc = new ListCreator(); //create ListCreator object
    lc.getGrades(); //start the grade listing process
    try{
        File gradeList = new File("C:/Users/Casi/IdeaProjects/GradeStats/GradeList");
        FileReader fr = new FileReader(gradeList); 

        BufferedReader bf = new BufferedReader(fr);       

        String line;

        while ((line = bf.readLine()) != null){
            System.out.println(line);
        }
        bf.close();
    }catch(Exception ex){
        ex.printStackTrace();

    }
} 
```

}

错误行内容如下：

```
java.io.FileNotFoundException: GradeList.txt (The system cannot find the file specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileReader.<init>(FileReader.java:72)
    at ListCreator.getGrades(ListCreator.java:17)
    at GradeStats.main(GradeStats.java:11)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T01:20:05.883

如何添加：

```
String curDir = System.getProperty("user.dir"); 
```

把这个打印出来。它会告诉你当前的工作目录是什么。然后你应该能够看到为什么它没有找到文件。

如果找不到文件，您可以检查以允许自己执行某些操作，而不是允许您的代码抛出：

```
File GradeList = new File("GradeList.txt");
if(!GradeList.exists()) {
    System.out.println("Failed to find file");
   //do something
} 
```

请运行以下命令并粘贴输出：

```
String curDir = System.getProperty("user.dir");
File GradeList = new File("GradeList.txt");
System.out.println("Current sys dir: " + curDir);
System.out.println("Current abs dir: " + GradeList.getAbsolutePath()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T01:29:09.647

问题是您只指定了一个*相对*文件路径并且不知道您的 java 应用程序的“当前目录”是什么。

添加此代码，一切都会清楚：

```
File gradeList = new File("GradeList.txt");
if (!gradeList.exists()) {
    throw new FileNotFoundException("Failed to find file: " + 
        gradeList.getAbsolutePath());
} 
```

通过检查绝对路径你会发现文件*不是*当前目录。

另一种方法是在创建 File 对象时指定绝对文件路径：

```
File gradeList = new File("/somedir/somesubdir/GradeList.txt"); 
```

顺便说一句，尽量坚持命名约定：用前导小写字母命名变量，即`gradeList`不`GradeList`

# c# - 使用fluent API在遗留数据库中建立一对一关系的复合外键

> ID：10791988
> 
> 赞同：3
> 
> 时间：2012-05-29T01:06:09.363
> 
> 标签：c#, .net, entity-framework, composite-key, one-to-one

我只是 EF 代码优先模型的初学者。给定两个映射到当前遗留 MS SQL 数据库的 POCO 类。它们与建立一对多关系的复合外键相关联。由于它实际上是一对一的关系，我希望在我的 POCO 对象中有相应的导航属性，并在流式 API 中进行映射。这是我的例子：

```
public partial class Answer
{
    //primary key
    public int id { get; set; }

    //foreign keys
    public int question { get; set; }
    public int assignedForm { get; set; }

    //simple fields
    public short state { get; set; }
    public int author { get; set; }

    //navigation property
    public virtual AssignedQuestion AssignedQuestion { get; set; }
}

 public partial class AssignedQuestion
{
    // primary keys
    public int id { get; set; }
    public int assignedForm { get; set; }

    //simple field
    public string content { get; set; }

    //navigation property
    //public virtual ICollection<Answer> Answers { get; set; }
    public virtual Answer Answer { get; set; }
} 
```

如果我想做一对多的关系，我只需取消注释“Answers”集合并拥有 Fluent API 映射：

```
modelBuilder.Entity<AssignedQuestion>()
    .HasKey(q => new { q.id, q.assignedForm });

modelBuilder.Entity<Answer>()
    .HasRequired(a => a.AssignedQuestion)
    .WithMany(aq=>aq.Answers)
    .HasForeignKey(a => new { a.question,a.assignedForm}); 
```

我的目标是使用一对一的关系，并在 AssignedQuestion 中使用“Answer”属性和这样的 Fluent API：

```
modelBuilder.Entity<AssignedQuestion>()
    .HasKey(q => new { q.id, q.assignedForm });

modelBuilder.Entity<Answer>()
    .HasRequired(a => a.AssignedQuestion)
    .WithOptional(aq => aq.Answer);
    //.HasForeignKey(a => new { a.question, a.assignedForm }); 
```

问题是我无法准确指定外键字段（如前面的示例）并取消注释 HasForeignKey 调用。在这种情况下，EF 尝试使用常规字段名称“AssignedQuestion_ID”和“AssignedQuestion_AssignedForm”而不是 Answer 表中的“question”和“assignedForm”来连接表。除了更改字段名称之外，Fluent API 中是否有其他解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T08:29:14.570

这不是一对一的关系，因此您的第一个映射是正确的。之所以是一对多，是因为 EF 只有在双方的 PK 上构建时才理解一对一。如果`AssignedQuestion`有 PK`id`并且`assignedForm`您`Answer`将需要在其上具有 FK 和 PK `id`，`assignedForm`否则 EF 不会将其视为一对一的关系。即使您在数据库中使用唯一约束标记您的`question`and `assignedForm`（使其在数据库中一对一），EF 仍然无法将其作为一对一处理，因为它还不支持唯一约束（除了PK）。

# php - 两个日期时间列之间的Mysql

> ID：10791989
> 
> 赞同：0
> 
> 时间：2012-05-29T01:06:11.423
> 
> 标签：php, mysql, datetime, between

我有以下代码，它似乎没有产生预期的结果：

```
$date_from = '2012-04-27 18:19:33';
$date_to = '2012-05-29 00:59:57';

$database->connect(); 
        $ancestors = mysql_query('
            SELECT * FROM ' . $database->db_prefix . 'comments e
                WHERE e.created BETWEEN "' . $date_from . '" AND "' . $date_to . '" AND   
                    e.ancestors = "' . $comment["id"] . '" AND e.user_id != "' . $user->user_object["id"] . '" AND
                        NOT EXISTS
                        (
                            SELECT null 
                            FROM ' . $database->db_prefix . 'notifications d
                            WHERE  d.target_id = e.id
                        )
                        ORDER BY e.created DESC
        ', $database->connection_handle);
    $database->close(); 
```

这可能是一个愚蠢的错误。但是当我不确定选择语句 BETWEEN 和使用的日期是否是有效的 MYSQL 时，我发现很难确定。

任何帮助都会很棒。我一直在搜寻，我所做的似乎是正确的，因此造成了混乱。

已编辑 //

我在 date_from 和 date_to 日期之间发表了很多评论，并且通知表中没有通知（不存在部分）......所以基本上，我应该得到大约 25 条评论......相反，我只收到一条返回的评论日期为 2012-05-29 00:23:39

已编辑 //

是因为您只能将日期与日期进行比较......以及将时间与时间进行比较吗？为了做到这一点，我该如何调整 mysql？

已编辑 //

函数之间的定义出错了。我真的不确定它到底出了什么问题。

1.  您可以返回两个日期之间的记录吗？
2.  能给我举个例子吗？

已编辑//问题已解决。这与查询无关，因此可以肯定地说这是正确的做法。我以一种疯狂的方式完成了我的日期范围。谢谢你们所有的帮助！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:14:09.533

在[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_between)中，它指出在使用 between 日期或时间值时应使用[CAST](http://dev.mysql.com/doc/refman/5.5/en/cast-functions.html#function_cast)，因此您的查询应编写如下。

```
WHERE e.created BETWEEN CAST("' . $date_from . '" AS DATETIME) AND CAST("' . $date_to . '" AS DATETIME) ... 
```

如果您没有得到预期的结果，这可能会解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-11T13:24:25.723

我遇到了同样的问题，我想你可能想应用这个解决方案：

```
$from = $_GET['from'];
$to = $_GET['to'];
include("connect.php");
$link=Connection();
$query = "SELECT * FROM records WHERE date_time BETWEEN '$from' AND '$to'";
$result=mysql_query($query,$link);
$list = array();
if($result === FALSE) {
    echo "No data";
} 
```

这里的技巧是signle引号，你需要把你的变量放在那个引号里让mysql处理它

# javascript - JavaScript 在检测鼠标滚轮事件时遇到问题

> ID：10791995
> 
> 赞同：4
> 
> 时间：2012-05-29T01:06:48.960
> 
> 标签：javascript, events, mouse, mousewheel

我正在尝试捕获鼠标事件。这是我正在尝试的代码：

```
if(window.addEventListener) { document.addEventListener('DOMMouseScroll', zoom_handler, false); } 
else { document.onmousewheel = zoom_handler; }

alert("test"); //I see this alert so I assume the code above it is run 
```

//...

```
function zoom_handler(event) {

    var delta = 0;

    if (!event) event = window.event;
    // normalize the delta
    if (event.wheelDelta) {
        // IE and Opera
        delta = event.wheelDelta / 60;
    } else if (event.detail) {
        // W3C
        delta = -event.detail / 2;
    }

    alert("Delta: " + delta);

} 
```

除了问题是当我尝试在页面上上下滚动时我什么也看不到，所以我想我没有正确捕获事件。作为参考，我一直在尝试遵循本教程：http: [//viralpatel.net/blogs/2009/08/javascript-mouse-scroll-event-down-example.html](http://viralpatel.net/blogs/2009/08/javascript-mouse-scroll-event-down-example.html)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T01:35:13.900

我想您实现它的方式仅适用于某些浏览器，例如 Chrome 浏览器。你试过把

```
document.onmousewheel = zoom_handler; 
```

在 else 语句之外？这样做，使它可以在我运行在 OSX Lion (Mac) 上的 Chrome 浏览器上运行。

这是我在我的电脑上测试的方式：

```
if(window.addEventListener) { document.addEventListener('DOMMouseScroll', zoom_handler, false); } 
document.onmousewheel = zoom_handler;

alert("test"); //I see this alert so I assume the code above it is run 
```

希望修复它。

# javascript - onPreCreate with Owner 从外部源中提取

> ID：10791996
> 
> 赞同：2
> 
> 时间：2012-05-29T01:06:54.267
> 
> 标签：javascript, rally

我正在尝试在 Rally 中创建一个自定义 HTML 应用程序，以通过 Add New 组件创建一个用户故事，并使用 JQuery 和 YQL JSON 查询从外部源绘制数据。

这个过程对于预先填写的名称、描述和注释来说是一个奇迹。但是，目前 Owner 进行预填充的唯一方法是使用 Object Dropdown 手动选择用户。我希望能够从同一个外部来源中提取所有者。

目前这是测试理论的虚拟代码：

```
var statement = "select * from html where url='" + value + "' and xpath='//h1'";
        document.getElementById('statement').innerHTML = statement;
        $.queryYQL(statement, "json", function (data) {
            var item = data.query.results.h1;  
            for(var i=0;i<item.length;i++){  
                title = item[i].content; 
                style = item[i].style;
                output += "<h3>"+title +"<br />"+ style +"</h3>"; 
            }
            document.getElementById('results').innerHTML = output;   
        });

function onAddNewPreCreate(addNew, eventArgs) {
        eventArgs.item["Name"] = title;
        eventArgs.item["Description"] = output;
        eventArgs.item["Notes"] = style;
        eventArgs.item["Owner"] = user;
    } 
```

'value' 变量是通过文本框设置的，用户可以在其中输入他们想要从中获取外部数据的 URL。

用户变量通过下拉菜单设置。我尝试用与 Rally 中的用户完全相同的显示名称替换用户变量，例如 eventArgs.item["Owner"] = "User Name"; 但这会导致创建时用户故事的所有者为空白。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T03:12:13.547

由于用户是 Rally 中的对象，因此您不能将 Artifact 的 Owner 属性设置为 Rally 用户名的字符串，而是必须将 Owner 设置为对有效 Rally 用户的引用，以 ref 的形式：`/user/12345678910`其中 long integer 是感兴趣的用户的对象 ID。您可以使用 rallyDataSource 和 AppSDK 查询 Rally User Name 的字符串值，获取所需的 ref。

我包含了一个基本示例，该示例说明了采用电子邮件格式的用户名并查询 Rally 以获取对所需用户对象的引用的想法。该示例使用一个简单的 DOM`<select>`组件来模拟用户名数据的“外部”源（在您的情况下，通过带有 YQL JSON 的 JQuery 填充）。这些示例代替 AppSDK ObjectDropdown 执行此操作，尽管这是完成此操作的最简单方法，但正如您所指出的，它不适合您的需求，因为您正在轮询外部源作为用户选择器的源。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- Copyright (c) 2011 Rally Software Development Corp. All rights reserved -->
<html>
<head>
    <title>Component Example: Add New User Story, &quotExternal&quot User Chooser</title>
    <meta name="Name" content="Component Example: Add New User Story, 'External' User Chooser" />
    <meta name="Version" content="2012.1" />
    <meta name="Vendor" content="Rally Labs" />
    <script type="text/javascript" src="https://rally1.rallydev.com/apps/1.26/sdk.js"></script>
    <script type="text/javascript">

      // Global variables to store Reference to selected User
      var userRef = null;
      var rallyDataSource;

    var getUserRef = function(results) {      
        var user = results.users[0];
        userRef = user._ref;
    };

    function userSelectChanged() {

        var userChooser = document.getElementById("userChooser");
        var strUser = userChooser.options[userChooser.selectedIndex].value;

        queryString = '(UserName = "' + strUser + '")';

        var userQueryConfig = { 
          type : 'user',
          key : 'users',
          fetch: 'UserName,DisplayName,Role',
          query: queryString
        };

        rallyDataSource.findAll(userQueryConfig, getUserRef);
    }

    function onAddNewAdd(addNew, eventArgs){      
        var createdItem = eventArgs.item;
        var createdFormattedId = createdItem.FormattedID;       
        alert("Created new User Story with Formatted ID: " + createdFormattedId);
    }

    function onAddNewPreCreate(addNew, eventArgs)
    {
        // Grab Rally ref of User selected in HTML dropdown
        // set it as Owner attribute of created User Story
        eventArgs.item["Owner"] = userRef;
    }
    function onLoad() {

        rallyDataSource = new rally.sdk.data.RallyDataSource('__WORKSPACE_OID__',
                '__PROJECT_OID__',
                '__PROJECT_SCOPING_UP__',
                '__PROJECT_SCOPING_DOWN__');

        var addNewConfig = {
           types : ["HierarchicalRequirement"]
        };

        // Populate userRef from Rally for default selected user:
        userSelectChanged();

        var addNew = new rally.sdk.ui.AddNewArtifact(addNewConfig, rallyDataSource);
        addNew.addEventListener("onAdd",onAddNewAdd);
        addNew.addEventListener('onPreCreate', onAddNewPreCreate);
        addNew.display("addNewDiv");

    }

    rally.addOnLoad(onLoad);

    </script>
</head>
<body>
<div id="addNewDiv"></div>
<div id="userChooserDiv">
Select a Rally User as Story Owner:
<select id="userChooser" onChange="userSelectChanged()">
  <option selected value="user1@company.com">user1@company.com</option>
  <option value="user2@company.com">user2@company.com</option>
  <option value="user3@company.com">user3@company.com</option>
</select>
</body>
</html> 
```

# google-apps-script - 关于：教程：从电子表格发送电子邮件

> ID：10791999
> 
> 赞同：-1
> 
> 时间：2012-05-29T01:07:50.523
> 
> 标签：google-apps-script

是否可以更新此脚本？2009 年它可能奏效了，但现在不行了。

教程：从电子表格发送电子邮件 - [Google Developers 教程的快速链接](https://developers.google.com/apps-script/articles/sending_emails)

我一辈子都无法让自己的脚本正常工作。在发送前检查时出现正确增加行的问题，这要么让我发送一打包含单行数据的电子邮件，要么如果我尝试实现一个while循环，我最终给自己发送了数百个电子邮件和谷歌然后阻止我继续使用该功能，直到第二天。

我的具体脚本问题是[HERE](https://stackoverflow.com/questions/10769935/proper-incrementing-while-using-mailapp-sendemail)，但我认为我的措辞不正确，因为没有人回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T06:04:48.860

您似乎在脚本中忘记了几件事：

1°：var dataRange = sheet.getRange(sRow,1,1,cols); // 这只会在您的工作表中获得 1 行，因此循环不起作用是正常的（长度 = 1）。
我建议用最后一行值替换高度值（请参阅[文档以获取该值](https://developers.google.com/apps-script/class_sheet#getLastRow)）以使循环遍历每一行。

2° 当您使用 .setValue(EMAIL_SENT); EMAIL_SENT 的值未在您的代码中定义（它在教程中的函数之外定义）。我建议添加这样的语句： var EMAIL_SENT="EMAIL_SENT" 或者，更简单地在您的“setValue”语句中使用字符串值，如下所示：.setValue("EMAIL_SENT");