# StackOverflow 问答 10935000-10935999

# logging - 如何读取后台智能传输服务 (BITS) 日志？

> ID：10935002
> 
> 赞同：8
> 
> 时间：2012-06-07T15:32:43.040
> 
> 标签：logging, microsoft-bits, bits-service

如何读取后台智能传输服务 (BITS) 日志？

我找到了以下博客：

[http://blogs.msdn.com/b/heaths/archive/2008/07/07/enable-bits-logging.aspx](http://blogs.msdn.com/b/heaths/archive/2008/07/07/enable-bits-logging.aspx)

但它会创建我无法读取的二进制日志文件

> %WINDIR%\System32\bits.log

任何人都可以帮助我吗？

# c++ - 具有boost序列化的二进制数据

> ID：10935005
> 
> 赞同：0
> 
> 时间：2012-06-07T15:32:50.530
> 
> 标签：c++, serialization, boost

我有这个带有一些二进制数据的类：

```
struct Message {
  int val1;
  double val2;
  std::string val3;    // contains some binary data
  template <class Archive>
    void serialize(Archive& ar, const unsigned int version)
  {
    ar & val1 & val2 & val3;
  }
}; 
```

我应该如何编写归档函数来处理 val3 中的二进制数据？

# c++ - 是否可以在 VS 2008 中使用 textbackground() 函数？

> ID：10935006
> 
> 赞同：0
> 
> 时间：2012-06-07T15:32:50.337
> 
> 标签：c++, c, visual-studio-2008

我想在 Visual Studio 2008 编写的 c++ 程序中使用这个函数。据我所知，Borland 曾经支持这个函数，但它不是标准的 c++ 函数，VS 2008 没有识别这个代码：

```
textbackground(1); 
```

我想知道在 VS 2008 中是否有使用此功能的解决方案？

[您可以在此处](http://www.ousob.com/ng/borcpp/ng6c57c.php)阅读有关此功能的更多信息。

PS 包括 conio.h 不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:01:03.637

您需要做的是使用 Windows NT 的控制台 IO 功能。

例如 SetConsoleTextAttribute 设置控制台上文本的属性（前景色、背景色）。 [http://msdn.microsoft.com/en-us/library/windows/desktop/ms686047(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686047%28v=vs.85%29.aspx)描述了这个功能。在[http://msdn.microsoft.com/en-us/library/windows/desktop/ms686974(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686974%28v=vs.85%29.aspx)上，您可以找到使用此控制台功能（和其他控制台功能）的示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T08:41:17.983

只是为了帮助别人多一点：

代替：

```
textbackground(1); 
```

我以这种方式使用**了 SetConsoleTextAttribute()**函数：

```
# include <windows.h>

HANDLE screen;

int main( )
    { 
       screen = GetStdHandle(STD_OUTPUT_HANDLE);
       SetConsoleTextAttribute(screen,1);

       // your own code

       return 0;
     } 
```

数字**1**指的是**蓝色**。

# c# - 如何使用 ValueInjecter 根据展平属性的名称查找源属性

> ID：10935016
> 
> 赞同：3
> 
> 时间：2012-06-07T15:33:22.510
> 
> 标签：c#, dynamic-linq, valueinjecter

这是相同问题的对应物[（但使用 AutoMapper）](https://stackoverflow.com/q/3405149/481904)。我使用[ValueInjecter](http://valueinjecter.codeplex.com/)，如果有解决方案，我很感兴趣。

简化代码示例：

```
// get a list of viewModels for the grid.
// NOTE: sort parameter is flattened property of the model (e.g. "CustomerInvoiceAmount" -> "Customer.Invoice.Amount"
// QUESTION: how do I get original property path so I can pass it to my repository for use with Dynamic LINQ?
public HttpResponseMessage Get(string sort)
{
    var models = _repo.GetAll(sort) // get a list of domain models
    var dto = _mapper.MapToDto(models); // get a list of view models that are flattened  via dto.InjectFrom<FlatLoopValueInjection>(models);

    var response = new HttpResponseMessage();
    response.CreateContent(vehicles);

    return response;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:15:07.550

好吧，我能够拼凑出一些东西，但我真的很想得到社区的一些意见（也许来自编写 ValueInjecter 的@Chuck Norris）......

所以重申一下这个问题......

*   您的视图中正在使用您的扁平视图模型。
*   视图有一个网格，其列是所述视图模型的属性。
*   当用户单击列时，将 sort=columnName 传递给控制器
*   因此，现在您需要将展平的属性名称解码为原始对象图，以便将其传递到您的存储库以进行服务器端排序（例如，使用动态表达式 APi、动态 LINQ 等）...

因此，如果 a`Company`具有称为`President`type的属性`Employee`，并且`Employee`具有称为`HomeAddress`type 的属性，`Address`并且具有称为`Address`string 的属性，`Line1`则：

" `President.HomeAddress.Line1`" 将被展平为`PresidentHomeAddressLine1`您的视图模型上名为 " " 的属性。

为了用户服务器端排序 Dynamic Linq 需要点属性路径，而不是扁平的。我只需要 ValueInjecter 来***展开 flat 属性！***不是全班。

这是我想出的（从执行其他操作的方法中提取的相关逻辑：

```
// type is type of your unflattened domain model.
// flatProperty is property name in your flattened view model
public string GetSortExpressionFor(Type type, string flatPropertyPath)
{
    if (type == null || String.IsNullOrWhiteSpace(flatPropertyPath))
    {
        return String.Empty;
    }

    // use ValueInjecter to find unflattened property
    var trails = TrailFinder.GetTrails(flatPropertyPath, type.GetInfos(), typesMatch => true).FirstOrDefault();
    var unflatPropertyPath = (trails != null && trails.Any()) ? String.Join(".", trails) : String.Empty;

    return unflatPropertyPath;
}

// sample usage     
var unflatPropertyPath = GetSortExpressionFor(typeof(Company), "PresidentHomeAddressLine1");
// unflatPropertyPath == "President.HomeAddress.Line1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:35:20.993

另一种方法是使用`TrailFinder`

```
IEnumerable<IList<string>> GetTrails(string upn, IEnumerable<PropertyInfo> all, Func<Type, bool> f) 
```

它被`UberFlatter`这样使用：

```
var trails = TrailFinder.GetTrails(flatPropertyName, target.GetType().GetInfos(), f); 
```

f Func 检查 end 属性的类型以匹配特定条件（可能在您的情况下，您可以只返回 true）

# c# - C# - 递增数字并在前面保持零

> ID：10935020
> 
> 赞同：17
> 
> 时间：2012-06-07T15:33:29.790
> 
> 标签：c#, int, increment

我需要制作一个 40 位的计数器变量。它应该开始`0000000000000000000000000000000000000001`
并递增到
`0000000000000000000000000000000000000002`

当我使用这个`int`类时，它会切断所有的零。问题是我需要增加数字，然后将其转换为字符串，并使用正确数量的前导零。总大小应为 40 位。因此，例如，如果我达到 50，它应该如下所示：

`0000000000000000000000000000000000000050`

我怎样才能做到这一点并保留零？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-07T15:35:42.680

转换为字符串时使用整数和格式或填充结果。如

```
int i = 1;
string s = i.ToString().PadLeft(40, '0'); 
```

请参阅[Jeppe Stig Nielson 的答案](https://stackoverflow.com/a/10935076/414076)，了解我也永远记不起的格式选项。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-06-07T15:36:26.277

尝试使用

```
int myNumber = ...;
string output = myNumber.ToString("D40"); 
```

当然，`int`永远不可能增长到填满所有这些数字的地方（最大`int`的只有 10 个数字）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T15:47:24.457

只需将您的字符串转换为 int，执行加法或任何其他操作，然后转换回具有足够数量的前导 0 的字符串：

```
// 39 zero's + "1"
string initValue = new String('0', 39) + "1";

// convert to int and add 1
int newValue = Int32.Parse(initValue) + 1;

// convert back to string with leading zero's
string newValueString = newValue.ToString().PadLeft(40, '0'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T15:53:27.510

前几天我不得不做类似的事情，但我只需要两个零。我结束了

```
string str = String.Format("{0:00}", myInt); 
```

不确定这是否是万无一失的，但请尝试

```
String.Format("{0:0000000000000000000000000000000000000000}", myInt) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-14T01:45:31.333

你也可以用这个。。

```
int number = 1;
string tempNumber = $"{number:00}"; 
```

结果：

```
01 
```

# android - android - 如何获取我的 android 设备的内存使用情况

> ID：10935022
> 
> 赞同：4
> 
> 时间：2012-06-07T15:33:40.883
> 
> 标签：android, memory, memory-management

各位朋友过得怎么样，希望大家多多指教。朋友们我想知道我的 android 设备有多少内存以及使用了多少内存活动内存、非活动内存、空闲内存和有线内存（以 MB 为单位）我已经通过[这个链接](https://stackoverflow.com/questions/2298208/how-to-discover-memory-usage-of-my-application-in-android)通过解析“/system/bin/”来说明这一点cat", "/proc/meminfo" 我们可以得到我上面提到的东西，是的，我得到了所有的东西，但是我得到了一个长字符串，我拥有一切

```
 MemTotal:         377192 kB
  MemFree:           10448 kB
  Buffers:            1368 kB``
  Cached:            74276 kB
  SwapCached:            0 kB
  Active:           143116 kB
  Inactive:         177292 kB
  Active(anon):     118388 kB
  Inactive(anon):   137664 kB
  Active(file):      24728 kB
  Inactive(file):    39628 kB
    Unevictable:       10664 kB
    Mlocked:           10372 kB
    HighTotal:        190464 kB
    HighFree:            568 kB
    LowTotal:         186728 kB
    LowFree:            9880 kB
    SwapTotal:             0 kB
    SwapFree:              0 kB
Dirty:                 8 kB
Writeback:             0 kB
AnonPages:        255440 kB
Mapped:            45816 kB
Shmem:               624 kB
Slab:              10952 kB
SReclaimable:       2456 kB
SUnreclaim:         8496 kB 
```

我从中得到的甚至更大的字符串

```
 private String ReadCPUinfo()
{
ProcessBuilder cmd;
StringBuffer strMemory = new StringBuffer();
//final ActivityManager activityManager =(ActivityManager) 
context.getSystemService(Context.ACTIVITY_SERVICE);
ActivityManager actvityManager = (ActivityManager) this.getSystemService(  
ACTIVITY_SERVICE );
ActivityManager.MemoryInfo mInfo = new ActivityManager.MemoryInfo ();
actvityManager.getMemoryInfo( mInfo );
strMemory.append("Available Memory : ");
strMemory.append(mInfo.availMem/1048576L);
strMemory.append("\n");
strMemory.append("\n");
String result=strMemory.toString();
try{
String[] args = {"/system/bin/cat", "/proc/meminfo"};
cmd = new ProcessBuilder(args);
Process process = cmd.start();
InputStream in = process.getInputStream();
byte[] re = new byte[1024];
while(in.read(re) != -1){
System.out.println("itthhe   ====  ---   >>>>    "+new String(re));
result = result + new String(re);
}
in.close();
} catch(IOException ex){
ex.printStackTrace();
}
return result;
} 
```

我想知道我是否可以动态地打破这个字符串以获得差异。设备或是否有任何其他方法可以找到上述内容

我也经历过[这个](https://stackoverflow.com/questions/3170691/how-to-get-current-memory-usage-in-android)，但也不是完全使用..我很容易获得可用的内存信息，但我需要全部四个

任何帮助都非常感谢提前感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T15:43:53.130

```
ActivityManager activityManager = (ActivityManager) context.getSystemService(ACTIVITY_SERVICE);
MemoryInfo memoryInfo = new ActivityManager.MemoryInfo();
activityManager.getMemoryInfo(memoryInfo);

Log.i(TAG, " memoryInfo.availMem " + memoryInfo.availMem + "\n" );
Log.i(TAG, " memoryInfo.lowMemory " + memoryInfo.lowMemory + "\n" );
Log.i(TAG, " memoryInfo.threshold " + memoryInfo.threshold + "\n" );

List<RunningAppProcessInfo> runningAppProcesses = activityManager.getRunningAppProcesses();

Map<Integer, String> pidMap = new TreeMap<Integer, String>();
for (RunningAppProcessInfo runningAppProcessInfo : runningAppProcesses)
{
    pidMap.put(runningAppProcessInfo.pid, runningAppProcessInfo.processName);
}

Collection<Integer> keys = pidMap.keySet();

for(int key : keys)
{
    int pids[] = new int[1];
    pids[0] = key;
    android.os.Debug.MemoryInfo[] memoryInfoArray = activityManager.getProcessMemoryInfo(pids);
    for(android.os.Debug.MemoryInfo pidMemoryInfo: memoryInfoArray)
    {
        Log.i(TAG, String.format("** MEMINFO in pid %d [%s] **\n",pids[0],pidMap.get(pids[0])));
        Log.i(TAG, " pidMemoryInfo.getTotalPrivateDirty(): " + pidMemoryInfo.getTotalPrivateDirty() + "\n");
        Log.i(TAG, " pidMemoryInfo.getTotalPss(): " + pidMemoryInfo.getTotalPss() + "\n");
        Log.i(TAG, " pidMemoryInfo.getTotalSharedDirty(): " + pidMemoryInfo.getTotalSharedDirty() + "\n");
    }
} 
```

请参阅[如何在 Android 中发现我的应用程序的内存使用情况？](https://stackoverflow.com/questions/2298208/how-to-discover-memory-usage-of-my-application-in-android)

这就是你所需要的;)

# nhibernate - 在 AR 和 Nhibernate 中运行没有会话的 hql 更新

> ID：10935025
> 
> 赞同：0
> 
> 时间：2012-06-07T15:33:50.897
> 
> 标签：nhibernate, castle-activerecord

我正在使用 Castle Active Record 和 NHibernate，并且需要能够在不使用会话的情况下运行 HQL 更新。当我使用会话时，它最终会导致锁定问题：

```
public static ISession GetSession(out ISessionFactoryHolder factoryHolder, out bool created)
        {
            created = false;
            var type = typeof(T);
            factoryHolder = ActiveRecordMediator.GetSessionFactoryHolder();
            ISessionScope activeScope = factoryHolder.ThreadScopeInfo.GetRegisteredScope();
            ISession session = null;
            var key = factoryHolder.GetSessionFactory(type);
            if (activeScope == null)
            {
                created = true;
                session = factoryHolder.CreateSession(type);
            }
            else
            {
                if (activeScope.IsKeyKnown(key))
                    session = activeScope.GetSession(key);
                else
                    session = factoryHolder.GetSessionFactory(type).OpenSession();
            }
            return session;
        }

        public static void UpdateQuery(string query)
        {
            ISessionFactoryHolder factoryHolder;
            var created = false;
            var session = GetSession(out factoryHolder, out created);
            session.CreateQuery(query).ExecuteUpdate();
            if (created)
                factoryHolder.ReleaseSession(session);
        } 
```

由于会话中发生的所有锁定，这在我们的生产环境中引起了重大问题。我如何在不实例化会话的情况下运行 hql 更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:34:09.443

您不能在 NHibernate 会话之外执行 HQL。但是，您可能会发现使用无状态会话会有所帮助（在 ActiveRecord 中使用 StatelessSessionScope）。

或者，如果无状态会话仍然不够高效，您将不得不使用简单的 SQL 执行查询，使用 session.CreateSqlQuery(...)

# javascript - 如何清除间隔并重新设置？

> ID：10935026
> 
> 赞同：18
> 
> 时间：2012-06-07T15:33:59.713
> 
> 标签：javascript, jquery

这就是我想要完成的事情：当到达最后一张幻灯片时，fadeOut 最后一张幻灯片，然后 fadeIn 第一张幻灯片，然后 clearInterval ***（一切都适用于这部分）***。现在我的问题是，如果 setInterval 不存在，我想**再次**
设置它，但我不知道如何实现:(我试图用 if 语句解决这个问题，但我的脚本根本不起作用！
所以我怎样才能重新开始我的间隔？谢谢！！
**没有**这样的 if 语句它工作正常：

```
if(!intervalID){
    intervalID = setInterval(animate,5000);
} 
```

这是我到目前为止所拥有的：

```
$(document).ready(function() {
  /*check if intervalID don't exists messes UP!!*/
  if (!intervalID) {
    intervalID = setInterval(animate, 5000);
  }

  //Hide everything except first slide and controls

  $('.slidewrap div:not(.slidewrap div:first,.slidewrap .slide_controls)').hide();

  var animate = function() {

    /*if .pagination_active is last removeClass and addClass to .pagination_active 
             first li tag*/

    if ($('.pagination_active').is($('.slide_controls ul li:last'))) {
      $('.pagination_active').removeClass('pagination_active');
      $('.slide_controls ul li:first').addClass('pagination_active');
    } else {
      $('.pagination_active').removeClass('pagination_active').next().addClass('pagination_active');
    }

    /*if div.active is last fadeOut and add .active class 
             to the first div and fadeIn FIRST div then CLEAR INTERVAL and set intervalID to zero */

    if ($('.active').is($('.slidewrap div:last'))) {
      $('.active').fadeOut(1000).removeClass('active');
      $('.slidewrap div:first').addClass('active').fadeIn(1000, function() {
        clearInterval(intervalID);
        intervalID = 0;

      });
    }

    //OR .active fadeOut and next div fadeIn
    else {
      $('.active').fadeOut(1000).next().fadeIn(1000, function() {
        $('.slidewrap div.active').removeClass('active').next('div').addClass('active');

      });
    }

  }

  var intervalID;
  intervalID = setInterval(animate, 3000);

}); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-07T15:35:33.627

清除一个间隔后，您需要使用 重新启动它`setInterval()`。

最好为您的功能`setInterval()`

```
var intervalID = null;

function intervalManager(flag, animate, time) {
   if(flag)
     intervalID =  setInterval(animate, time);
   else
     clearInterval(intervalID);
} 
```

这`flag`是一个`boolean`带有 value 的变量`true/ false`。`true`will execute `setInterval()`and `false`will `clearInterval()`;

现在您可以根据需要使用上述功能。

例如：

```
intervalManager(true, animate, 300);  // for setInterval

intervalManager(false);  // for clearInterval 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-15T13:27:56.107

**只是示例**

```
var myVar 
function myTimer() {
    var d = new Date();
    var t = d.toLocaleTimeString();
    document.getElementById("demo").innerHTML = t;
}

function myStopFunction() {
    clearInterval(myVar);
}
function myStartFunction() {
    myVar = setInterval(myTimer, 1000);
}
myStartFunction();
```

```
<p id="demo"></p>
<button onclick="myStopFunction()">Stop time</button>
<button onclick="myStartFunction()">Start time</button>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-07T16:30:35.060

这是一个带有回调和间隔的实用程序对象，您可以使用它来启动和停止间隔。

```
 //simple utility object to start and stop an interval       
    var IntervalUtil = function(functionCall, interval){

        var intervalObj = 0,
            INTERVAL    = interval;

        var callback = functionCall;

        function startTimer(){
            console.log('start timer', intervalObj)
            if(intervalObj === 0){
                intervalObj = setInterval(callback, INTERVAL)
            }
        }   

        function stopTimer(){
            clearInterval(intervalObj);
            intervalObj = 0;
            console.log('timer stopped', intervalObj);
        }

        return {
            startTimer : startTimer,
            stopTimer  : stopTimer
        }

    }; 
```

**你会这样使用它 **

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
    <meta name="author" content=""/>

    <title>Timer : setInterval()</title> 

    <style type="text/css">

    html, body, div, span, applet, object, iframe,
    h1, h2, h3, h4, h5, h6, p, blockquote, pre,
    a, abbr, acronym, address, big, cite, code,
    del, dfn, em, img, ins, kbd, q, s, samp,
    small, strike, strong, sub, sup, tt, var,
    b, u, i, center,
    dl, dt, dd, ol, ul, li,
    fieldset, form, label, legend,
    table, caption, tbody, tfoot, thead, tr, th, td,
    article, aside, canvas, details, embed, 
    figure, figcaption, footer, header, hgroup, 
    menu, nav, output, ruby, section, summary,
    time, mark, audio, video {
        margin: 0;
        padding: 0;
        border: 0;
        font-size: 100%;
        color:#000;
        line-height:1.3em;
        font: inherit;
        vertical-align: middle;
        font-family:arial;
        font-size:12px;
        outline:none;
    }

    a{
        outline:none;
        text-decoration:none;
        color:#145486;
    }
    a span{
        color:#145486;
    }

    h1{
        font-weight:normal;
        font-size:32px;
    }

    body{
        background:#efefef;
        text-align:center;
    }
    .content{
        width:400px;
        padding:20px;
        margin:10px auto;
        background:#fff;
        border:solid 1px #ebebeb;
        text-align:left;
    }

    #toggleTimer{
        color:#fff;
        font-size:10px;
        padding:2px 7px;
        display:inline-block;
        background:#357cb7;
        border:solid 1px #0c8af4;
    }

    #toggleTimer.running{
        background:#f14621;
        border:solid 1px #ff4c00;
    }

    #output{
        padding:7px;
        font-size:10px;
        border:dashed 1px #ebebeb;
        background:#f8f8f8;
        margin-left:10px;
        display:inline-block;
    }
    em{
        font-weight:bold;
    }

    </style>

</head>
<body>

<div class="content">

    <h1>Set Interval Code</h1>

    <a href="javascript:" id="toggleTimer" class="">Start Timer</a>

    <span id="output"></span>

    <br class="clear"/>

</div>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">

    $(document).ready(function(){
        var demo = new Demo();
    });

    var Demo = function(){

        var self = this;

        var START_TEXT = "Start Timer",
            STOP_TEXT  = "Stop Timer";

        var $toggle = $('#toggleTimer'),
            $output = $('#output');

        var count = 0;

        var intervalUtil;

        function init(){
            intervalUtil = new IntervalUtil(printMessage, 1000);
            setClickHandler();
            return self;
        }   

        function setClickHandler(){
            $toggle.click(toggleTimer)
        }

        function toggleTimer(){

            $toggle.toggleClass('running');

            if($toggle.hasClass('running')){
                $toggle.text(STOP_TEXT);
                intervalUtil.startTimer();
            }else{
                $toggle.text(START_TEXT);
                intervalUtil.stopTimer();
            }
        }

        function printMessage(){        
            $output.html("printMessage called <em>" + (count++) + "</em> times");
        }

        return init();

    }

    //simple utility object to start and stop an interval       
    var IntervalUtil = function(functionCall, interval){

        var intervalObj = 0,
            INTERVAL    = interval;

        var callback = functionCall;

        function startTimer(){
            console.log('start timer', intervalObj)
            if(intervalObj === 0){
                intervalObj = setInterval(callback, INTERVAL)
            }
        }   

        function stopTimer(){
            clearInterval(intervalObj);
            intervalObj = 0;
            console.log('timer stopped', intervalObj);
        }

        return {
            startTimer : startTimer,
            stopTimer  : stopTimer
        }

    };  

</script>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-17T14:17:52.450

计时器的解决方案计数 15 秒然后转到主页，如果点击屏幕将计时器重置为开始。它可能对某人有用。（x 是触摸事件的计数器）：

```
 var productInterval = null;
  var counterForGoToMainPage = 15;

  function startTimer(){
    counterForGoToMainPage--;

    if(counterForGoToMainPage == 0){
      clearInterval(productInterval);
      counterForGoToMainPage = 15;
      window.location.href = "/";
      }
  }

  function countTouches(event) {
  var x = event.touches.length;

    if(x == 1) { 
      clearInterval(productInterval);
      counterForGoToMainPage = 15;
      productInterval = setInterval(function(){
         startTimer();
      },1000);
    }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-27T02:44:27.977

在我的项目中（使用`Sveltekit`），我了解到您可以在函数之间循环`setInterval`和`clearInterval`使用`let`来定义 NodeJS 计时器：

```
$: number = 0 //The "$" sign, in this case, is used to a make reactive statement 

const changeValue = (e: any) => {
    let changingValue = setInterval(() => {
        number += 0.01
        if (number >= 0.2) {
            clearInterval(changingValue)
        }
    }, 4)
}, 
changeValueAgain = (e: any) => {
    let changingValue = setInterval(() => {
        number -= 0.01
        if (number <= 0) {
            clearInterval(changingValue)
        }
    }, 4)
} 
```

（顺便说一下，我使用的是 Typescript）很简单，每次调用函数时，它都会创建一个新的 NodeJS 计时器，当某些条件为真时该计时器会被清除

该`e`参数用于事件处理程序...

# excel - Excel vba 到 mac

> ID：10935028
> 
> 赞同：3
> 
> 时间：2012-06-07T15:34:01.433
> 
> 标签：excel, vba, macos

我有一个在 Windows 环境中运行良好的 Excel 电子表格，但是当我们尝试在 MAC Office 2011 中运行相同的电子表格时，宏工作但按钮未启用？它们只是显示为图像。有任何想法吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T22:00:05.333

看起来您通过将按钮从 ActiveX 转换为 Forms 解决了评论中的按钮问题。

关于对 Microsoft XML 库的引用，我已经在网络上进行了很多查找以找到在 Mac Office 2011 上提供此功能的内容，但一无所获。

以下是我看到人们问同样问题的其他一些地方：

[http://www.vbaexpress.com/forum/archive/index.php/t-12976.html](http://www.vbaexpress.com/forum/archive/index.php/t-12976.html)

[适用于 Mac 的 VBA：MSXML2.DOMDocument 或 System.PrivateProfileString 不起作用](https://stackoverflow.com/questions/10499182/vba-for-mac-msxml2-domdocument-or-system-privateprofilestring-doesnt-work)

如果其他人知道如何让 DOMDOCUMENT 在 Mac Office 2011 上工作，请加入！

# c - “对‘ceilf’的未定义引用”

> ID：10935029
> 
> 赞同：3
> 
> 时间：2012-06-07T15:34:09.017
> 
> 标签：c, eclipse

简单的问题。我正在将其他人以前编写的代码导入到 Eclipse 中。我收到错误消息：

```
"undefined reference to `ceilf'" 
```

当我使用`ceilf`. 在我看来，`ceilf`这应该包含在我的文件中包含的 math.h 库中。但是，当我打开 /usr/include/math.h 文件时，我没有看到定义的 ceilf 方法。事实上，据我所知，我的 redhat 部署中的 math.h 文件都没有`ceilf`方法。知道在哪里定义了任性的`ceilf`方法吗？由于此代码可以工作，甚至可以在其他地方编译，因此问题必须与我的配置有关，而不是代码本身。

附言。我可以使用常规`ceil`方法。我考虑过只是切换到它，但是在程序的关键路径中效率会降低。是的，我知道过早的优化是邪恶的，但是出于好奇，我一直在问为什么我会出现错误。我不明白为什么我的`math.h`文件不会玷污它。

编辑:: 感谢您解释为什么我找不到该`ceilf`功能，我理解这个问题。但是，我不知道如何安抚日食。我已尝试按照建议将编译器选项设置为使用**std=c99**，但它并没有消除错误。事实上，我认为 eclipse 只是使用我的**Makefile**来进行构建，并且 make 文件不会抛出异常。我可以做些什么来让编辑器意识到我已经定义了文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T16:14:49.433

`ceilf`是数学库的一部分，因此您需要链接`-lm`才能使用它。只是`#include <math.h>`还不够。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:39:35.473

根据手册页：

```
Feature Test Macro Requirements for glibc (see feature_test_macros(7)):

       ceilf(), ceill():
           _BSD_SOURCE || _SVID_SOURCE || _XOPEN_SOURCE >= 600 ||
           _ISOC99_SOURCE || _POSIX_C_SOURCE >= 200112L;
           or cc -std=c99 
```

尝试在编译器中将标准设置为 C99 或启用这些功能测试宏之一。

还要确保您正在链接`-lm`或为您的平台和编译器链接数学库的适当开关。

# c# - 检查字符串 vb.net 中的 "

> ID：10935031
> 
> 赞同：4
> 
> 时间：2012-06-07T15:34:15.110
> 
> 标签：c#, .net, vb.net, special-characters

我正在努力检查 vb.net 中字符串中的“。有人可以建议一种方法来查找字符串中的”，就像我们在 c# 中使用“\”“一样

我已经尝试过，\" 和 "" 但没有用。

```
If partnerItem.Contains("*") Or partnerItem.Contains(""") Then
isBad = True
reportError(i + 1, colDetails(0), colDetails(1), "Field cannot contain " & PARTNER_ITEM_INVALID_CHARACTERS & " characters.") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T15:37:44.607

```
... partnerItem.Contains("""") ... 
```

我相信 VB.Net 用双引号转义双引号。由于此站点上的代码着色，您的语法通过此更改正确突出显示。

```
If partnerItem.Contains("*") Or partnerItem.Contains("""") Then
   isBad = True
   reportError(i + 1, colDetails(0), colDetails(1), "Field cannot contain " & PARTNER_ITEM_INVALID_CHARACTERS & " characters.") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T15:38:25.220

你真的很接近，只是短暂的`"`：

```
If partnerItem.Contains("*") Or partnerItem.Contains("""") Then 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/267k4fw5.aspx](http://msdn.microsoft.com/en-us/library/267k4fw5.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:47:27.167

您可以通过将双引号替换为 2 个单引号或不替换，将带双引号的字符串保存到数据库中。

替换为单引号：

```
lsstr = lsstr.replace(chr(34),"'") 
```

替换为无

```
Dim str As String = "I ""love"" VB"
Console.WriteLine(str)
Console.WriteLine(str.Replace("""", ""))
Catch ex As Exception
Console.Write(ex.ToString())
Finally
Console.Read() 
```

# spring - 使用 Spring 集成的事务性 POP3 邮箱访问

> ID：10935032
> 
> 赞同：2
> 
> 时间：2012-06-07T15:34:17.143
> 
> 标签：spring, transactions, jakarta-mail, pop3, spring-integration

我们想使用 Spring Integration 2.1.1 以事务方式从 POP3 邮箱中读取邮件。事务性使我们可以读取电子邮件并将其保存到 Oracle 并从邮箱中删除。在事务回滚的情况下，我们希望电子邮件保留在邮箱中（即不被删除）。

我们的问题是，尽管处于事务中（稍后会详细介绍），但邮箱被打开，邮件被检索，标记为删除并且连接关闭，而与事务的其余部分无关。这意味着如果稍后发生故障（因为连接已关闭并且邮箱进入永久删除电子邮件的更新状态），则不删除邮件为时已晚。

我们一直在尝试通过创建事务轮询入站通道适配器来做到这一点：

```
<!-- This inbound channel adaptor interfaces to the sendmail POP3 queue -->
<int-mail:inbound-channel-adapter id="pop3PollingChannelAdaptor" 
                                  store-uri="pop3://myuser:myuser@100.100.100.100/inbox" 
                                  channel="receiveInboundEmailChannel" 
                                  should-delete-messages="true"              
                                  auto-startup="true" 
                                  java-mail-properties="javaMailProperties">
    <!-- Will poll every 20 seconds -->            
    <int:poller fixed-rate="10000" 
                max-messages-per-poll="1">
        <int:transactional transaction-manager="txManager"
                           isolation="DEFAULT"
                           propagation="REQUIRED"
                           read-only="false"
                           timeout="100000" />
    </int:poller>
</int-mail:inbound-channel-adapter> 
```

它将消息放在入站电子邮件通道上：

依次由出站通道适配器（端点）监听：

```
<int:outbound-channel-adapter channel="receiveInboundEmailChannel" 
                              ref="inboundEmailMessageEndpoint" 
                              method="processMessage" /> 
```

端点的实现目前使事情变得非常简单。目前我们并没有靠近数据库，相反，如果我们想触发回滚，我们只是抛出一个异常。

```
@MessageEndpoint
public class InboundEmailMessageEndpoint {
    @Transactional(propagation = Propagation.MANDATORY)
    public void processMessage(Message<MimeMessage> message) {

        MimeMessage mailMessage =  message.getPayload();

        // We throw exceptions here to cause a rollback if we need to during investigation...
    }
} 
```

查看所有日志，我们可以在上下文中看到我们的问题（注意 POP3 “sayon​​ara”是如何在端点中的其余工作开始之前，最重要的是，在周围事务提交/回滚之前）：

```
15:32:25.256 INFO  [main][org.springframework.transaction.jta.JtaTransactionManager]     Using JTA UserTransaction: com.atomikos.icatch.jta.UserTransactionImp@3228a1
15:32:25.256 INFO  [main][org.springframework.transaction.jta.JtaTransactionManager] Using JTA TransactionManager: com.atomikos.icatch.jta.UserTransactionManager@10980e7
15:32:25.422 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction() returning NULL!
15:32:25.422 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction() returning NULL!
15:32:25.423 DEBUG [task-scheduler-1][org.springframework.transaction.jta.JtaTransactionManager] Creating new transaction with name [org.springframework.integration.endpoint.AbstractPollingEndpoint$1.call]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,timeout_100000
15:32:25.423 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction() returning NULL!
15:32:25.423 WARN  [task-scheduler-1][com.atomikos.icatch.imp.TransactionServiceImp] Attempt to create a transaction with a timeout that exceeds com.atomikos.icatch.max_timeout - truncating to: 300000
15:32:25.423 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 entering state: ACTIVE
15:32:25.425 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.thread.TaskManager] TaskManager: initializing...
15:32:25.426 INFO  [task-scheduler-1][com.atomikos.icatch.imp.thread.TaskManager] THREADS: using JDK thread pooling...
15:32:25.428 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.thread.TaskManager] THREADS: using executor class com.atomikos.icatch.imp.thread.Java15ExecutorFactory$Executor
15:32:25.428 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.thread.Java15ExecutorFactory] (1.5) executing task: com.atomikos.timing.PooledAlarmTimer@18c4a7f
15:32:25.429 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.thread.ThreadFactory] ThreadFactory: creating new thread: Atomikos:0
15:32:25.429 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.TransactionServiceImp] Creating composite transaction: 10.9.21.7.tm0000100022
15:32:25.433 INFO  [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] createCompositeTransaction ( 100000000 ): created new ROOT transaction with id 10.9.21.7.tm0000100022
DEBUG: JavaMail version 1.4.4
DEBUG: successfully loaded resource: /META-INF/javamail.default.providers
DEBUG: Tables of loaded providers
DEBUG: Providers Listed By Class Name: {com.sun.mail.smtp.SMTPSSLTransport=javax.mail.Provider[TRANSPORT,smtps,com.sun.mail.smtp.SMTPSSLTransport,Sun Microsystems, Inc], com.sun.mail.smtp.SMTPTransport=javax.mail.Provider[TRANSPORT,smtp,com.sun.mail.smtp.SMTPTransport,Sun Microsystems, Inc], com.sun.mail.imap.IMAPSSLStore=javax.mail.Provider[STORE,imaps,com.sun.mail.imap.IMAPSSLStore,Sun Microsystems, Inc], com.sun.mail.pop3.POP3SSLStore=javax.mail.Provider[STORE,pop3s,com.sun.mail.pop3.POP3SSLStore,Sun Microsystems, Inc], com.sun.mail.imap.IMAPStore=javax.mail.Provider[STORE,imap,com.sun.mail.imap.IMAPStore,Sun Microsystems, Inc], com.sun.mail.pop3.POP3Store=javax.mail.Provider[STORE,pop3,com.sun.mail.pop3.POP3Store,Sun Microsystems, Inc]}
DEBUG: Providers Listed By Protocol: {imaps=javax.mail.Provider[STORE,imaps,com.sun.mail.imap.IMAPSSLStore,Sun Microsystems, Inc], imap=javax.mail.Provider[STORE,imap,com.sun.mail.imap.IMAPStore,Sun Microsystems, Inc], smtps=javax.mail.Provider[TRANSPORT,smtps,com.sun.mail.smtp.SMTPSSLTransport,Sun Microsystems, Inc], pop3=javax.mail.Provider[STORE,pop3,com.sun.mail.pop3.POP3Store,Sun Microsystems, Inc], pop3s=javax.mail.Provider[STORE,pop3s,com.sun.mail.pop3.POP3SSLStore,Sun Microsystems, Inc], smtp=javax.mail.Provider[TRANSPORT,smtp,com.sun.mail.smtp.SMTPTransport,Sun Microsystems, Inc]}
DEBUG: successfully loaded resource: /META-INF/javamail.default.address.map
DEBUG: getProvider() returning javax.mail.Provider[STORE,pop3,com.sun.mail.pop3.POP3Store,Sun Microsystems, Inc]
DEBUG POP3: mail.pop3.rsetbeforequit: false
DEBUG POP3: mail.pop3.disabletop: false
DEBUG POP3: mail.pop3.forgettopheaders: false
DEBUG POP3: mail.pop3.cachewriteto: false
DEBUG POP3: mail.pop3.filecache.enable: false
DEBUG POP3: mail.pop3.keepmessagecontent: false
DEBUG POP3: mail.pop3.starttls.enable: false
DEBUG POP3: mail.pop3.starttls.required: false
15:32:25.446 DEBUG [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] connecting to store [pop3://devmail9:*****@100.100.100.100/inbox]
DEBUG POP3: mail.pop3.apop.enable: false
DEBUG POP3: mail.pop3.disablecapa: false
DEBUG POP3: connecting to host "100.100.100.100", port 110, isSSL false
S: +OK POP3 xxxxx.xxxx.xxxx.xxx.xxx.uk v4.39 server ready
C: CAPA
S: -ERR Unknown command in AUTHORIZATION state
C: USER myuser
S: +OK User name accepted, password please
C: PASS myuser
S: +OK Mailbox open, 3 messages
15:32:25.564 DEBUG [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] opening folder [pop3://myuser:*****@100.100.100.100/inbox]
C: STAT
S: +OK 3 5956
15:32:25.569 INFO  [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] attempting to receive mail from folder [inbox]
C: NOOP
S: +OK No-op to you too!
15:32:25.591 DEBUG [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] found 1 new messages
C: TOP 1 0
S: +OK Top of message follows
Received: from xxxxx.xxxx.xxxx.xxx.xxx.uk ([100.100.100.100]) by     xxxxx.xxxx.xxxx.xxx.xxx.uk (AIX5.2/8.11.6p2/8.11.0) with ESMTP id q57EUrG1544330 for C:    LIST 1

....

S: +OK 1 1996
15:32:25.604 DEBUG [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] Recieved 1 messages
15:32:26.097 DEBUG [task-scheduler-1][org.springframework.integration.mail.Pop3MailReceiver] USER flags are not supported by this mail server. Flagging message with system flag
DEBUG POP3: streaming msg 1
C: RETR 1
S: +OK 1996 octets
Received: from xxxxx.xxxx.xxxx.xxx.xxx.uk ([100.100.100.100]) by GLA610.crown.copfs.gsi.gov.uk (AIX5.2/8.11.6p2/8.11.0) with ESMTP id q57EUrG1544330 for <myuser@xxxxx.xxxx.xxxx.xxx.xxx.uk>; Thu, 7 Jun 2012 15:30:53 +0100

....

DEBUG POP3: streaming msg 1
C: RETR 1
S: +OK 1996 octets
Received: from xxxxx.xxxx.xxxx.xxx.xxx.uk ([100.100.100.100]) by xxxxx.xxxx.xxxx.xxx.xxx.uk (AIX5.2/8.11.6p2/8.11.0) with ESMTP id q57EUrG1544330 for <myuser@xxxxx.xxxx.xxxx.xxx.xxx.uk>; Thu, 7 Jun 2012 15:30:53 +0100

....

.
C: NOOP
S: +OK No-op to you too!
C: DELE 1
S: +OK Message deleted
C: QUIT
S: +OK Sayonara
15:32:26.672 DEBUG [task-scheduler-1][org.springframework.integration.mail.MailReceivingMessageSource] received mail message [javax.mail.internet.MimeMessage@ef4504]
15:32:26.696 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.697 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.697 DEBUG [task-scheduler-1][org.springframework.transaction.jta.JtaTransactionManager] Participating in existing transaction
15:32:26.716 INFO  [task-scheduler-1][xx.xxx.xxx.xxx.channel.email.InboundEmailMessageEndpoint] In InboundEmailMessageEndpoint.  processing MailMessage (Subject): 7777777777777777777
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.735 DEBUG [task-scheduler-1][org.springframework.transaction.jta.JtaTransactionManager] Initiating transaction commit
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.735 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.BaseTransactionManager] getCompositeTransaction()  returning instance with id 10.9.21.7.tm0000100022
15:32:26.736 INFO  [task-scheduler-1][com.atomikos.icatch.imp.CompositeTransactionImp] commit() done (by application) of transaction 10.9.21.7.tm0000100022
15:32:26.736 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 entering state: COMMITTING
15:32:26.740 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 entering state: TERMINATED
15:32:26.741 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 : stopping timer...
15:32:26.741 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 : disposing statehandler TERMINATED...
15:32:26.741 DEBUG [task-scheduler-1][com.atomikos.icatch.imp.CoordinatorImp] Coordinator 10.9.21.7.tm0000100022 : disposed. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:14:24.950

邮件服务器不支持事务。您需要实现自己的事务资源来包装邮件服务器 - 事务/意图日志、故障恢复等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T07:59:41.633

POP3 是事务性的，但不是数据库和消息队列事务意义上的。因此，它无法按照我们的要求正确参与交易。

但是，我们向 Spring 集成人员[记录了一个特性请求，以按照“](https://jira.springsource.org/browse/INT-2606) [Best Efforts 1PC](http://www.javaworld.com/javaworld/jw-01-2009/jw-01-spring-transactions.html) ”模式添加伪事务支持，最后一步是 POP3“提交”。这看起来好像它会进入 2.2.0 版本。

# string - 在 Python 中将十六进制和整数的字符串转换为列表

> ID：10935033
> 
> 赞同：2
> 
> 时间：2012-06-07T15:34:19.000
> 
> 标签：string, hex, python-2.7

我试图在一串十六进制数字中找到最大值。我的转换方法是对字符串进行标记，将该标记列表转换为整数，然后取最大值。

字符串的格式如下：

```
'\x1e\x00\x00\x00\xf0\x0f184203308373388492761797873987' 
```

我无法控制格式，因为它是 LZ4 算法的 Python 绑定的输出。

SO上的其他类似答案没有混合类型或在具有许多十六进制数字的字符串中使用转义字符。

那么，我如何将其变成一个列表，例如：

```
[0x1e, 0x00, 0x00, ...] 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:36:39.243

我不确定你想如何获取十六进制值之后的整数......它们应该是 1、2 还是*x*位？

所以，我这样做：

```
import re

# convert unicode or string to raw
def raw(s):
    if isinstance(s, str):
        s = s.encode('string-escape')
    elif isinstance(s, unicode):
        s = s.encode('unicode-escape')
    return s

s = '\x1e\x00\x00\x00\xf0\x0f184203308373388492761797873987'

print [ re.sub(r'\\', r'0', raw(i)) for i in s] 
```

我明白了：

```
['0x1e', '0x00', '0x00', '0x00', '0xf0', '0x0f', '1', '8', '4', '2', '0', '3', '3', '0', '8', '3', '7', '3', '3', '8', '8', '4', '9', '2', '7', '6', '1', '7', '9', '7', '8', '7', '3', '9', '8', '7'] 
```

希望能有所帮助

**编辑：**简化列表理解

**编辑：**如果您确实想摆脱非十六进制值，那么您可以使用

```
>>> print [int(re.sub(r'\\', r'0', raw(i)), 16) for i in s if len(raw(i))>1]
[30, 0, 0, 0, 240, 15] 
```

并比较......甚至更好，正如[帝斯曼](https://stackoverflow.com/users/487339/dsm)所说

```
>>> s = '\x1e\x00\x00\x00\xf0\x0f184203308373388492761797873987'
>>> ord(max(s))
240 
```

# android - 如何获取谁将意图发送到服务？

> ID：10935039
> 
> 赞同：2
> 
> 时间：2012-06-07T15:34:25.030
> 
> 标签：android, binding, android-intent, android-service

如果我的服务有启动、绑定或解除绑定的意图，我想知道完成它的类的名称。

如何获取哪个类发送了服务通过这些方法获得的意图？

甚至可能吗？如果是这样，怎么做？如果不是，为什么，如果我想监控谁绑定到服务以及它何时从服务中解除绑定，我该如何克服它？

我尝试了 Intent 类的多种方法，但似乎没有一个能够查询这些数据。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-07T16:43:01.493

```
//You can put activity name in the intent object like this
Intent intent=new Intent(this,myservice.class);
intent.putExtra("activity_name","MainActivity");
startService(intent);

//While in service you get this values by writing
Intent intent=getIntent();
String name=intent.getStringExtra("activity_name");
//..... 
```

# php - echo for 循环成字符串

> ID：10935042
> 
> 赞同：1
> 
> 时间：2012-06-07T15:34:34.190
> 
> 标签：php, variables, for-loop

我有一个 for 循环，我希望能够将结果回显到字符串中。如何才能做到这一点？它只会将循环的最后一次运行回显到我的变量中，以便在循环外使用。

```
for ($i = 0; $i < $numItem; $i++) {
            extract($cartContent[$i]);

        $pricebands = array("1"=>"$pd_price1","2"=>"$pd_price2","3"=>"$pd_price3","4"=>"$pd_price4","5"=>"$pd_price5","6"=>"$pd_price6");
        if(isset($loggedInfo['price'])){
            $priceToShow = $pricebands[$loggedInfo['price']];
        } else {
            $priceToShow = $pricebands[1];
        }
            $productUrl = "index.php?c=$cat_id&p=$pd_id";
            $subTotal += $priceToShow * $ct_qty;
            $pd_name;
            $ct_qty;
            $productList = "L_NAME".$i."=".$pd_name."&L_AMT".$i."=".$priceToShow."&L_QTY".$i."=".$ct_qty."&";   
        }
        $amount = $subTotal;           
    } 
```

以及将 $productList 放入的变量

```
 $nvpstr="&PAYMENTACTION=$paymentType&AMT=$amount&".trim($productList)."CREDITCARDTYPE=$creditCardType&ACCT=$creditCardNumber&EXPDATE=".$padDateMonth.$expDateYear."&CVV2=$cvv2Number&FIRSTNAME=$firstName&LASTNAME=$lastName&STREET=$address1&CITY=$city&STATE=$state&ZIP=$zip&COUNTRYCODE=$countryCode&CURRENCYCODE=$currencyCode"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T15:37:03.523

每次循环时都会重置 $productList 。你想添加它，而不是设置它：

```
$productList .= 'new stuff...'; 
```

在循环之前，将变量设置为一个空字符串，您将向其中添加更多字符：

```
$productList = ''; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T15:37:29.527

字符串连接或内爆。

我对你想要加入的确切字符串有点困惑，没有回声。

```
for ($i = 0; $i < $numItem; $i++) {
        extract($cartContent[$i]);

    $pricebands = array("1"=>"$pd_price1","2"=>"$pd_price2","3"=>"$pd_price3","4"=>"$pd_price4","5"=>"$pd_price5","6"=>"$pd_price6");
    if(isset($loggedInfo['price'])){
        $priceToShow = $pricebands[$loggedInfo['price']];
    } else {
        $priceToShow = $pricebands[1];
    }
        $productUrl = "index.php?c=$cat_id&p=$pd_id";
        $subTotal += $priceToShow * $ct_qty;
        $pd_name;
        $ct_qty;
        $productList .= "L_NAME".$i."=".$pd_name."&L_AMT".$i."=".$priceToShow."&L_QTY".$i."=".$ct_qty."&";   
    }
    $amount = $subTotal;           
} 
```

# c++ - 规范化时避免奇怪的单应值

> ID：10935047
> 
> 赞同：5
> 
> 时间：2012-06-07T15:34:44.580
> 
> 标签：c++, numerical-methods, homography, divide-by-zero

熟悉 Homographies 的人会知道，您必须将其除以任何矩阵分量进行归一化，以保持齐次坐标。单应性是一个 3x3 矩阵，它通常被归一化除以 (3,3) 处的元素。

![http://www.cg.tu-berlin.de/fileadmin/fg144/Courses/06WS/scanning/Dennis/Extrinsic%20calibration-Dateien/image006.jpg](../Images/8224ee7f111574fbf115fb74fb6a41f6.png)

当该值非常小时（例如 0.0000008）并除以一个假定为零的值（0.0000007）时，问题就出现了。结果值在假定为零时几乎为 0.875，并且结果投影没有意义。

我想知道解决这个问题的常用方法是什么。我使用 C++ 和浮点运算。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T08:06:35.003

所以，如果我理解这个问题：

```
0/0.000000001 = 0   = CORRECT 
```

和：

```
0.000000001/0.000000001 ~ 1    INCORRECT 
```

我将使用参数 sigma 定义一个函数来检查错误。

如果 value < sigma = 0.001，则假定其为零，并返回 0，否则，返回 value。

因此，它将始终以超过 sigma 误差的值起作用，如果不是，则为 0。

# ravendb - RavenDB 查询建议多个单词

> ID：10935048
> 
> 赞同：3
> 
> 时间：2012-06-07T15:34:52.040
> 
> 标签：ravendb

我有一些代码正在搜索具有以下索引的 RavenDB 数据库：

```
public class Products_Search :
                AbstractIndexCreationTask<Product, Products_Search.Result>
{
    public class Result
    {
        public string Query { get; set; }
    }

    public Products_Search()
    {
        Map = products =>
              from product in products
              select new
              {
                  Query = new
                  {
                      Categories = product.Categories.Boost(5),
                      Brands = product.Brands.Boost(8),
                      product.Description,
                      Name = product.Name.Boost(10),
                      product.SKU
                  },
                  product.Price
              };

        Index(x => x.Query, FieldIndexing.Analyzed);
    }
} 
```

如果我这样查询（草莓蛋白都拼错了）：

```
var query = RavenSession.Query<Products_Search.Result, Products_Search>()
                        .Where(x => x.Query == "strawbery protien");

var suggestions = query.Suggest().Suggestions.Take(5) 
```

我希望建议是“草莓蛋白”而不是“草莓”和“蛋白质”中的另一个。RavenDB 有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:41:00.883

我必须做类似的事情，我使用`LuceneQuery`语法来实现它。我正在使用`OR`运算符，但您会想要使用`AND`运算符。

**指数**

```
public class ContentItem_BySearchParam : AbstractIndexCreationTask<ContentItem>
{
    public ContentItem_BySearchParam()
    {
        Map = contentItems =>
                from contentItem in contentItems
                select new {contentItem.Title, contentItem.Description, contentItem.Keywords};

        Store("Title", FieldStorage.Yes);
        Index("Title", FieldIndexing.Analyzed);

        Store("Description", FieldStorage.Yes);
        Index("Description", FieldIndexing.Analyzed);

        Store("Keywords", FieldStorage.Yes);
        Index("Keywords", FieldIndexing.Analyzed);
    }
} 
```

**查询**

```
public SearchResults GetResults(IDocumentSession db, params string[] searchTerms)
{
    var query =
            GetLuceneQuery("Title", searchTerms) + " OR " +
            GetLuceneQuery("Description", searchTerms) + " OR " +
            GetLuceneQuery("Keywords", searchTerms);

    var results = db
        .Advanced
        .LuceneQuery<ContentItem, RavenIndexes.ContentItem_BySearchParam>()
        .Where(query)
        .ToList();

      .... do other stuff
}

private string GetLuceneQuery(string field, string[] terms, string searchOperator = "")
{
    var join = " " + searchOperator;
    var prefix = field + ":(" + searchOperator;
    return prefix + String.Join(@join, terms) + ")";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T07:53:23.040

爱生活，

我们根据我们使用的术语构建建议。您可以对查询字段进行两次索引，一次使用已分析（在这种情况下将其分解为单词），一次使用默认值，在这种情况下使用完整术语。这可能会给你你想要的。

# awk - 在 awk 中搜索空值

> ID：10935049
> 
> 赞同：1
> 
> 时间：2012-06-07T15:34:52.777
> 
> 标签：awk

我有一个 txt 文件，其中有许多用管道分隔的列。我想检查列`$36`是否为“0”、null 或空白，然后过滤整行。

```
awk -F"|" 'BEGIN{OFS="|"} NR!=1, $3="A" && $36!=0 && length($36)>0
{print $1, $81, $3, $2, $21, $22, $6, $19, $20, $25, $26, $29, $30,
$31, $33, $34, $36, $38, "", $39, "", "", $40, $42, "rrr", "", "" }' 
```

我尝试使用`length($36)>0`但它不适用于空白值。我可以看到该列的文件是这样的`||`（两个管道之间没有任何东西）。

请帮助我识别这些值并应用过滤器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:48:27.330

```
$36 !~ /^[0 ]*$/ 
```

`0.0`应该做你想做的事，但如果条目的值为零（例如），则它不匹配。为此，请尝试

```
$36 && $36 !~ /^[0 ]*$/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:39:33.927

用于`$36 ~ /^$|0/`过滤零或空字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T15:39:45.673

您可以使用以下条件进行过滤：

```
awk -F '|' '($36 ~ /^0?$/)' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T15:49:06.677

您可以通过使用更多的垂直空间来稍微简化代码。你的情况有一个令人费解的逗号；我想应该应该是一个`&&`。如图所示，您有一个没有操作的条件（因此有一个 print 的默认操作`$0`）和一个没有条件的操作（因此每行都有一个默认匹配）。

```
awk -F"|" 'BEGIN{OFS="|"}
    NR != 1 && $3 = "A" && $36 != 0 && length($36) > 0 {
       print $1, $81, $3, $2, $21, $22, $6, $19, $20, $25, $26, $29, $30,
             $31, $33, $34, $36, $38, "", $39, "", "", $40, $42, "rrr", "", ""
    }' 
```

请注意， 与`{`条件在同一行。就个人而言，我可能会写成：

```
awk -F"|" 'BEGIN{OFS="|"}
    {
        if (NR != 1 && $3 = "A" && $36 != 0 && length($36) > 0)
        {
            print $1, $81, $3, $2, $21, $22, $6, $19, $20, $25, $26, $29, $30,
                  $31, $33, $34, $36, $38, "", $39, "", "", $40, $42, "rrr", "", ""
        }
    }' 
```

到目前为止，我假设您要打印如果它不是第一行数据，如果`$3`是`A`，并且如果`$36`既不是空也不是零。您说“我要过滤”，但这并不能解释您是要包含还是排除过滤的行。如果您只关心字段 36 为空的行，您可以将条件简化为：

```
awk -F"|" 'BEGIN{OFS="|"}
    {
        if (NR != 1 && $3 = "A" && $36 != "")
        {
            print $1, $81, $3, $2, $21, $22, $6, $19, $20, $25, $26, $29, $30,
                  $31, $33, $34, $36, $38, "", $39, "", "", $40, $42, "rrr", "", ""
        }
    }' 
```

或者你可以只使用`length($36) > 0`；在这种情况下它们是等价的。

鉴于您没有提供任何示例数据，而且我也懒得去计算具有 81 个或更多管道分隔字段的记录是什么样的，因此我无法测试此代码。问一个问题时，你应该简化你的代码；例如，在一个示例中，您可以使用 4 列，然后将小规模解决方案调整回具有 80 多列的实际案例。

# ios - 使用较新的 SDK 版本方法时删除警告

> ID：10935051
> 
> 赞同：0
> 
> 时间：2012-06-07T15:34:57.390
> 
> 标签：ios, sdk, warnings, pragma

我正在使用自 iOS SDK 5.0 版以来可用的方法。当然，在调用它之前，我正在检查该类是否具有该方法（换句话说，它正在检查正在运行的 iOS 版本）：

```
if ([UITabBar instancesRespondToSelector:@selector(setSelectedImageTintColor:)]) {
    [myTabBarController.tabBar setSelectedImageTintColor :TINT_COLOR_IMAGES];
} 
```

这工作正常。但是，我收到了要删除的警告，但我没有找到任何可以处理它的东西。警告是：

```
warning: ‘UITabBar’ may not respond to ‘-setSelectedImageTintColor:’
warning: (Messages without a matching method signature
warning: will be assumed to return ‘id’ and accept
warning: ‘...’ as arguments.) 
```

因为我不想删除项目中的所有警告（删除选项 -Wall），所以我尝试了这个 #pragma ：

```
#pragma GCC diagnostic ignored "-Wundeclared-selector"
[...] my method containing call to setSelectedImageTintColor
#pragma GCC diagnostic warning "-Wundeclared-selector" 
```

但这不起作用，即使我用“Wall”替换了“Wundeclared-selector”，这意味着#pragma 没有效果，也许我需要在我的makefile中激活一些东西。

任何的想法 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T15:39:49.373

删除警告更改此

```
 [myTabBarController.tabBar setSelectedImageTintColor :TINT_COLOR_IMAGES]; 
```

到

```
 [myTabBarController.tabBar performSelector:@selector(setSelectedImageTintColor:) withObject:TINT_COLOR_IMAGES]; 
```

这将删除警告

# xsd - 如何使用 JiBX 解组而不使用 XSD？

> ID：10935053
> 
> 赞同：0
> 
> 时间：2012-06-07T15:35:07.217
> 
> 标签：xsd, unmarshalling, castor, jibx

我想使用 JiBX 来解组巨大的 XML 文件，但我不希望它针对 XSD 进行验证。我该怎么做呢？

概念证明（适用于符合 XSD 的 XML 的 jUnit 片段）：

```
IBindingFactory bfact = BindingDirectory.getFactory(Customer.class);
IUnmarshallingContext uctx = bfact.createUnmarshallingContext();
Customer customer = (Customer) uctx.unmarshalDocument(new FileInputStream(fileLocation), null); 
```

为什么我需要这个？我有一个 RESTful 服务，允许用户上传巨大的 XML 文件。Castor 被证明对这项工作来说太慢了，我现在正在用 JiBX 重写东西。虽然，我从经验中知道，用户有时会上传 99.9% 可处理的文件，但元素中的一个额外 XML 属性会使整个 XML 不正确。我仍然想在内存中解组所有我能做的事情并手动进行验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:02:45.860

波马里奥，
你想做的都是可能的。[我建议您从github](https://github.com/organizations/jibx)下载我们的源代码并针对一些 xml 文件进行测试。如果 JiBX 抱怨模型中没有的 XML 元素和属性，请在我们的源代码中找到错误并更改代码以忽略错误的 XML 数据而不是抛出错误。
我不应该太难。
祝你好运！
大学教师

# search - 最优 Solr JVM/虚拟/物理内存配置

> ID：10935054
> 
> 赞同：1
> 
> 时间：2012-06-07T15:35:07.500
> 
> 标签：search, ubuntu, solr, jvm

我们公司有几种不同的获取潜在客户的方式，以及我们处理的几种类型的潜在客户。每种类型的潜在客户之间只有微小的差异，并且大部分信息与一种或多种其他潜在客户类型共享或相关。我和我的团队正在尝试使用 Solr 构建/配置一个索引，以处理每种潜在客户类型及其所有共享数据......客户数据、度假村数据。等（总共大约 120 万条记录）。我们目前正在托管一个运行 Tomcat 6 和 Solr 3.4 的 Ubuntu 服务器（12G RAM，8 核 Opteron）。

我希望索引在客户在我们的网站上提交潜在客户表单时实时添加记录（每天大约 1500-2000 次），以及在员工添加或修改数据时更新（每天大约 2500-3000 次） .

此外，我需要网站上的客户和内部员工能够使用过滤器、构面、自动完成、突出显示以及人们期望从编写良好的搜索中获得的所有内容快速搜索这些数据。

此设置当前正在运行，但经常在网站和我们的内部应用程序中挂起更新记录。每 1000 个文档或 5 秒提交一次，我每天优化一次。这种设置的最佳 JVM、服务器或 Solr 配置是什么？任何帮助将不胜感激，我可以向愿意提供帮助的任何人提供所需的尽可能多的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T23:22:59.930

首先，[您不应该优化](http://www.searchworkings.org/blog/-/blogs/simon-says%3a-optimize-is-bad-for-you).

在 Solr 中配置 JVM 堆大小时有两个常见错误：

*   为 JVM 提供过多内存（操作系统缓存将无法缓存磁盘操作），
*   没有给 JVM 足够的内存（垃圾收集器会有很大的压力，它会被迫频繁地运行 stop-the-world 收集，使用 JMX 监控来确定是否触发了 full GC）。

您的应用程序可能挂起的另一个原因是后台合并。Lucene 是基于段的，只要段数高于`mergeFactor`，就会触发合并。较低的值`mergeFactor`可能会解释挂起。

您应该提供有关当前设置的更多详细信息，以便我们为您提供帮助：

*   JVM 大小，
*   您正在使用什么收集器（G1、吞吐量收集器、并发低暂停收集器，...）
*   索引大小（在磁盘上，而不是文档数），
*   `mergeFactor`, `ramBufferSizeMB`, ...

# xcode - 如何在不关闭项目本身的情况下关闭 XCode 4 中的所有文档（编辑器）窗口？

> ID：10935058
> 
> 赞同：2
> 
> 时间：2012-06-07T15:35:22.103
> 
> 标签：xcode

在 XCode 3.x 中，按下任何编辑器窗口的红色“关闭”按钮，同时按住 Option 键，关闭所有编辑器窗口。在 XCode 4 中，同样的事情会关闭所有窗口，但也会关闭项目本身。有没有办法在不关闭 Xcode 4 中的项目的情况下关闭它们？

# spring - 事务二级缓存和生成的标识符

> ID：10935059
> 
> 赞同：1
> 
> 时间：2012-06-07T15:35:23.983
> 
> 标签：spring, hibernate, jta, infinispan, atomikos

我有以下堆栈：

*   休眠 3.6.9.Final
*   春天 3.1.1
*   Atomikos 3.7.1
*   Infinispan 4.2.1.FINAL
*   MySQL

我一直在编写一些测试，以确保当抛出 RuntimeException 时，当前事务会在数据库上回滚，但也会在事务性 2LC 上回滚。

我发现了一些奇怪的结果，希望有人能解释一下。

如果我使用带有 @Cache(usage=CacheConcurrencyStrategy.TRANSACTIONAL) 注释的 @Entity 和字符串 @Id，我会在分配 id 并保存实体时看到我期望的结果：

*   当没有抛出异常时，事务被提交并且 2LC 包含实体，我使用以下方法确认了这一点：

`sessionFactory.getCache().containsEntity(MyEntity.class, myIdentifier)`

*   如果抛出异常，则数据库或 2LC 都不包含该实体。

`@Entity`但是，如果我使用生成的`@Id`（MySQL 自动递增长属性）重复这些测试，如图所示：

```
@Id
@GeneratedValue
private long id; 
```

我发现实体永远不会被放入 2LC，无论抛出任何异常。

我已经进行了一些调试，这似乎取决于`AbstractSaveEventListener#performSaveOrReplicate`. 对于分配的`@Id`useIdentityColumn 为 false，因此我们实例化并执行 EntityInsertAction，然后将新实体放入 2LC。

相反，如果`@Id`由 MySQL 生成，我们发现 useIdentityColumn 为真，我们实例化并执行 EntityIdentityInsertAction。这包含注释掉的关于 2LC 的代码，如下所示：

```
 //TODO: this bit actually has to be called after all cascades!
      //but since identity insert is called *synchronously*,
      //      instead of asynchronously as other actions, it isn't
      /*if ( persister.hasCache() && !persister.isCacheInvalidationRequired() ) {
         cacheEntry = new CacheEntry(object, persister, session);
         persister.getCache().insert(generatedId, cacheEntry);
      }*/ 
```

这有什么原因吗？缓存插入是否应该在其他地方完成？这是一个错误吗？

如果有人能阐明这种差异以及它应该如何工作，我将不胜感激。

我已经在 Hibernate 论坛上发布了这个[问题](https://forum.hibernate.org/viewtopic.php?f=1&t=1015758&start=0)，但没有太大的兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T21:58:42.347

我也认为这对于二级缓存的使用是一个很大的限制，所以我创建了一个[问题](https://hibernate.onjira.com/browse/HHH-7964)(HHH-7964)。我还添加了一条带有解决方法的评论，但这只是一个概念证明，据我所知不应用于生产。

# math - 2D 弹丸追踪路径说明

> ID：10935060
> 
> 赞同：-1
> 
> 时间：2012-06-07T15:35:25.110
> 
> 标签：math, geometry, computational-geometry, trigonometry, projective-geometry

2D游戏中的弹丸追踪路径问题：

假设：

我们做了一个简化的假设，即重力是恒定的并且没有风或阻力。弹丸的运动由以下方程给出：

x = x0 + v0t cos(theta)

y = y0 + v0t sin(theta) + .5 gt^2

其中 (x0, y0) 是初始位置，v0 是初始速度（仅幅度），theta 是排放角，g 是重力加速度。求解 v0t 的第一个方程并代入第二个方程，我们得到方程 [1]：

y = y0 + (x-x0) tan(theta) + .5 (g/v0^2) (x-x0)^2 / cos(theta)^2

校准：

校准是根据实际弹丸确定 g 值的过程。为此，我们发射一个随机射弹并捕获：

1.  起点 (x0, y0)
2.  目标向量 (v0, theta)
3.  曲线上的一个随机点 (x1, y1)

将这些值代入方程 [1] 并求解 g，我们得到：

g = (v0^2) * {[2 cos(theta)^2 (y1-y0) / (x1-x0)^2] - [sin(2theta) / (x1-x0)]}

应用：

现在我们有了 g，我们可以将其代回方程 [1]，现在可以使用该方程从任何起点和初始速度跟踪射弹的路径。**（这是我不明白的部分）**

**g=5.89**

**(x0,y0) 起始位置 = 0,0**

**初始速度 = 1-100**

**放电角度 = 0-360**

**有人可以解释一下，如果重力加速度为 5.89（在这个游戏中），那么对于 1-100 之间的任何初始速度和 0-360 之间的任何放电角，如何获得抛物线的完整绘制路径，并且开始位置是0,0？**

**我是一个数学新手，所有这些东西都不是我在别处找到的粗体字，而且我一直在绞尽脑汁。请假设我什么都不知道。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:50:26.037

您只会错过第一组方程中的**时间**t 和空间/时间约束，绘制射弹的前 x 秒或直到射弹离开边界框 m。所以伪代码是：

*   t=0；x(0)=某个坐标；y(0)=另一个坐标
*   **环路**吨
*   t=t+1
*   计算坐标 {X(t=1), Y(t=1)}
*   在此点与前一个点之间绘制点或线
*   **LOOP UNTIL** t>time limit OR point {X(t), Y(t)} 在你的边界框之外

我希望这对你的努力有所帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:28:17.133

选择`v0 = 10`，`theta = 60 degrees`我们有

```
tan(theta) = 1.732
cos(theta) = 0.5 
```

因此等式[1](http://www.google.de/#q=1.732%2ax+-+0.1178%2ax%5E2)显示为 ( `x0=0`, `y0=0`,`g=5.89`给出)

```
y = 1.732*x - 0.1178*x^2 
```

可以直接绘制（`y`vs. `x`）：[见这里](http://www.google.de/#q=1.732%2ax+-+0.1178%2ax%5E2)

注意：我更正了`-`重力的符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:02:55.610

这是一个非常简单的本科物理问题。您从 x 和 y 方向的牛顿定律开始：

![x方向的力平衡](../Images/40d48b699f13d2cbd9d05bbed2c51c74.png)

![y方向的力平衡](../Images/69a997bdbafd909b13b625dee78ada13.png)

初始条件：

![零时的 x 位移](../Images/e934dc0cea37597d100af2ebe910e671.png)

![零时的 x 速度](../Images/7b96affe45308ee5f815b46aca62a14e.png)

![零时间的 y 位移](../Images/2e192a6f8857051a97b5d3d988de9b1c.png)

![零时间的 y 速度](../Images/292f0c6712b9d2490f970ffb4127850d.png)

其中 Q 是弹丸的初始速度，而 theta 是如果枪指向右侧，则从地平线逆时针测量的角度。

因此，如果您将每一项整合一次，您将获得：

![x-速度与时间](../Images/1bc15496c38a491cbdc9b75bf8b21f14.png)

![y 速度与时间的关系](../Images/154a222b078a1ecc4416504730ab5b29.png)

应用初始条件：

![x-速度常数](../Images/8e25e18bbb54058a6c422cd3cc4560b9.png)

![y-速度常数](../Images/63b018c1e3205ec6f8be458089f8011c.png)

第二次积分给出：

![x 位移与时间的关系](../Images/392a46d1bd45159074ce02ecb89b2484.png)

![y 位移与时间](../Images/8af82ef94e85c2534da7abab961a8e51.png)

再次应用初始条件：

![x位移初始条件](../Images/a204eb8894f401147afe6cd83bbff34c.png)

![y 位移初始条件](../Images/1fafef0eb4c1ffb541d09c3ae3bef6ec.png)

从枪响起，进行替换就可以得到您想要的射弹 (u, v) 位置的最终方程：

![作为时间函数的射弹的 x 位置](../Images/42f05231f2d8c7972685a83c3e5c2a9e.png)

![弹丸的 y 位置作为时间的函数](../Images/aded5eed847f5150123f1d59184ed500.png)

如果把坐标系的原点放在枪口出口处，那么两个初始位移为零。

现在你有两个方程来表示弹丸的 (u, v) 位置。您可以插入弹丸的初始速度和枪的角度，从地平线测量为零，指向右侧。

您只需从零开始，选择时间增量，然后循环任意长的时间间隔。您将时间的当前值插入这些方程式，评估结果，增加时间，然后重复。

让我们想象一下，您将枪从地平线逆时针倾斜 45 度，并以 1000 英寸/秒的速度发射弹丸。您可以穿越时间，看到抛物线沿抛物线路径向上和向右移动，直到它到达顶点，然后开始回落到地平线。最终，您的 y 位移将回到零，然后继续进入负区域，就好像您是从悬崖边缘拍摄的一样。

如果您想知道弹丸在撞击地面之前走了多远，只需在高度小于或等于零时停止时间循环：

![是时候回到地球了](../Images/8d938b173ec4d6576bdafd8d8e9d152c.png)

这是为您提供的 Java 实现：

```
package physics;

/**
 * CannonSimulator simulates shooting a projectile.  Users are responsible for making
 * sure that all constants use consistent units (e.g. meters for length, seconds for
 * time, kg for mass, etc.)
 * @author Michael
 * @since 6/14/12 9:47 PM
 * @link http://stackoverflow.com/questions/10935060/2d-projectile-tracing-path-clarification/11043389#11043389
 */
public class CannonSimulator {

    private double m;
    private double g;
    private double q;
    private double theta;

    public static void main(String[] args) {
        double m = ((args.length > 0) ? Double.valueOf(args[0]) : 1.0); // default mass is 1 kg
        double g = ((args.length > 1) ? Double.valueOf(args[1]) : 9.8); // default gravity is 9.8 m/sec^2
        double q = ((args.length > 2) ? Double.valueOf(args[2]) : 100.0); // default velocity is 100 m/sec
        double theta = ((args.length > 3 ? Double.valueOf(args[3]) : Math.PI/4.0)); // default angle is 45 degrees
        CannonSimulator simulator = new CannonSimulator(m, g, q, theta);
        double t = 0.0;
        double dt = 0.001; // time increment of 0.1 seconds
        while (simulator.v(t) >= 0.0) {
            System.out.println(String.format("time: %10.3f u: %10.3f v: %10.3f", t, simulator.u(t), simulator.v(t)));
            t += dt;
        }
    }

    public CannonSimulator(double m, double g, double q, double theta) {
        if (m <= 0.0) throw new IllegalArgumentException("mass must be greater than zero");
        if (g <= 0.0) throw new IllegalArgumentException("gravity must be greater than zero");
        if (q <= 0.0) throw new IllegalArgumentException("velocity must be greater than zero");

        this.m = m;
        this.g = g;
        this.q = q;
        this.theta = theta;
    }

    public double v(double time) {
        return time*(q*Math.sin(theta) - g*time/m);
    }

    public double u(double time) {
        return time*q*Math.cos(theta);
    }
} 
```

*这就是*解决这个问题的方法。

# assembly - x86 架构的反汇编程序

> ID：10935063
> 
> 赞同：0
> 
> 时间：2012-06-07T15:35:34.300
> 
> 标签：assembly, x86

我下载了ollyDbg，但是好像默认没有集成反汇编器。[官方网页](http://ollydbg.de)上的disasm.zip文件只包含源代码，但是为了编译它，我们必须安装很多过时的库（f.ex MSDOS的dir.h）。
因此，我要求从机器代码（.exe）转换为 x86 汇编语言（.asm）的最简单方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:26:11.430

我不知道“最简单的方法”[原文如此]，但我强烈推荐[IDA Pro - 免费版](http://www.hex-rays.com/products/ida/support/download_freeware.shtml)反汇编程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-08T15:15:49.790

ODA，在线反汇编程序，是一个免费的、基于 Web 的逆向工程平台，支持 x86 和许多其他架构。在 www.onlinedisassembler.com 上查看

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:47:14.660

对我来说最好的反汇编程序是 ndisasm，它带有[NASM assembler](http://www.nasm.us/pub/nasm/releasebuilds/2.10.01/win32/)。

此外，OllyDbg 确实带有反汇编器，这就是为什么您可以从 EXE 中看到汇编...否则它作为调试器几乎毫无用处。

# java - java中的密码填充字符串是什么

> ID：10935068
> 
> 赞同：32
> 
> 时间：2012-06-07T15:35:43.267
> 
> 标签：java, padding, jce

每个人都在谈论密码中的填充方案，但是需要传递给密码的实际字符串是什么？我不在乎它们是对称的还是不对称的，我只想要一个可能值的列表。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-06-07T15:49:20.243

填充有很多类型，PKCS-7、零、ISO 10126、ANSI X.923 等。
我建议你阅读[填充](http://en.wikipedia.org/wiki/Padding_%28cryptography%29)，因为你似乎没有完全理解这个概念。

然后有可能您指的是加密[salt](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)。

**编辑**
Java 平台的每个实现都需要支持以下标准密码转换，括号中的密钥大小：

*   AES/CBC/NoPadding (128)
*   AES/CBC/PKCS5Padding (128)
*   AES/ECB/无填充 (128)
*   AES/ECB/PKCS5 填充 (128)
*   DES/CBC/无填充 (56)
*   DES/CBC/PKCS5填充 (56)
*   DES/ECB/无填充 (56)
*   DES/ECB/PKCS5填充 (56)
*   DESede/CBC/NoPadding (168)
*   DESede/CBC/PKCS5Padding (168)
*   DESede/ECB/无填充 (168)
*   DESede/ECB/PKCS5Padding (168)
*   RSA/ECB/PKCS1填充（1024、2048）
*   RSA/ECB/OAEPWithSHA-1AndMGF1Padding (1024, 2048)
*   RSA/ECB/OAEPWithSHA-256AndMGF1Padding（1024、2048）

[你可以在这里](http://docs.oracle.com/javase/7/docs/technotes/guides/security/StandardNames.html#impl)找到一份清单。

**编辑 2您可以在**[此处](http://www.bouncycastle.org/specifications.html)
找到 Bouncy Castle 规范。它列出了所有可用的填充方案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-07T16:33:47.913

块密码需要填充，流密码不需要。块密码需要填充，因为它们会加密整个块，并且您的消息可能与整个块数不完全匹配。填充用于将消息长度扩展到下一个块边界。

有关详细信息，请参阅有关[加密填充](http://en.wikipedia.org/wiki/Padding_%28cryptography%29)的 Wikipedia 文章。

对于大多数目的，使用 PKCS#7（又名 PKCS#5）填充：n 个字节，所有值 n：

```
01
02 02
03 03 03
...
10 10 10 10 ... 10 10 
```

# c - 在 UDP 套接字上调用 select() 会导致参数无效错误

> ID：10935071
> 
> 赞同：0
> 
> 时间：2012-06-07T15:35:45.863
> 
> 标签：c, sockets, select

我在 UDP 套接字上调用 select() 以查看是否有要读取的数据。每次方法返回 -1 并且 errno 设置为 22（无效参数）。这是我的代码的一部分：

```
fd_set sockets;
struct timeval alarm;
alarm.tv_sec = 0;
alarm.tv_usec = 1000;
FD_ZERO(&sockets);
FD_SET(udpSocket, &sockets);
maxfd = udpsocket + 1;
selected = select(maxfd, &sockets, NULL, NULL, &alarm);
printf("%d\n", selected); 
```

“选定”始终为 -1。我知道套接字很好，因为此时我已经成功地通过它发送了数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:29:38.637

根据select的手册页，`EINVAL`意思是“nfds为负或超时中包含的值无效”，这表明`udpsocket`是`-2`或更少。

一个可能的提示：您`udpSocket`在 fd_set 中设置，然后使用`udpsocket`来计算`maxfd`. 有两个仅在单个字符的情况下不同的变量很容易被忽略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T18:03:57.353

事实证明，错误的原因是我将警报的微秒属性设置为：

```
alarm.tv_usec = 2000000; 
```

这显然是太高的价值。显然，将 seconds 属性设置为 2 更容易：

```
alarm.tv_sec = 2; 
```

# mongodb - 如何使用 Mule MongoDB 连接器存储 BinData 字段？

> ID：10935075
> 
> 赞同：1
> 
> 时间：2012-06-07T15:36:24.237
> 
> 标签：mongodb, mule

使用 Mule MongoDB 连接器，如何将字段存储为 BinData 类型？

```
 <mongo:insert-object-from-map collection="#[variable:collectionName]">
        <mongo:element-attributes>
            <mongo:element-attribute key="msg_id">BinData(3, '#[message:id]')</mongo:element-attribute>
            <mongo:element-attribute key="shortcode">#[map-payload:shortcode]</mongo:element-attribute>
            <mongo:element-attribute key="msg">#[map-payload:msg]</mongo:element-attribute>
        </mongo:element-attributes>
    </mongo:insert-object-from-map> 
```

我试过的上面这个例子只存储字符串“BinData（3，'eea894d1-b0b5-11e1-91c7-a769a8d50370'）”

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T11:26:56.897

您也许可以使用 Groovy 创建对象

```
<mongo:element-attribute key="msg_id">#[groovy:new BinData(3, payload.getUniqueId())]</mongo:element-attribute> 
```

这可能不起作用，因为 MongoDB 驱动程序无法[转换对象](http://www.mongodb.org/display/DOCS/Java+Types)，但可以使用 Groovy 创建[BasicDBObject 来创建您存储的数据](http://www.mongodb.org/display/DOCS/Java+Tutorial#JavaTutorial-InsertingaDocument)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T12:02:23.267

实际上，我完全放弃了 Mule MongoDB 连接器，因为它不可靠并且在重负载下失败。这篇文章解释了为什么它失败得如此悲惨 - [http://www.thorntech.com/2012/07/mule-mongo-connector-fails-under-heavy-load/](http://www.thorntech.com/2012/07/mule-mongo-connector-fails-under-heavy-load/)

编写我自己的使用标准 java 驱动程序的 Mule 组件非常容易。它的表现要好得多，我可以毫无问题地保存我想要的任何数据类型。

# asp.net-mvc-3 - 如何在此 MSDN 示例中使用 Order By

> ID：10935077
> 
> 赞同：9
> 
> 时间：2012-06-07T15:36:31.083
> 
> 标签：asp.net-mvc-3, entity-framework-4.1, repository-pattern

我试图弄清楚如何使用这个 orderBy 参数。我不确定我应该传入什么。

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

```
 public virtual IEnumerable<TEntity> Get(
        Expression<Func<TEntity, bool>> filter = null,
        Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> orderBy = null,
        string includeProperties = "")
    {
        IQueryable<TEntity> query = dbSet;

        if (filter != null)
        {
            query = query.Where(filter);
        }

        foreach (var includeProperty in includeProperties.Split
            (new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries))
        {
            query = query.Include(includeProperty);
        }

        if (orderBy != null)
        {
            return orderBy(query).ToList();
        }
        else
        {
            return query.ToList();
        }
    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-07T15:44:31.197

如果您从 msdn 文章中阅读此内容

“代码 Func, IOrderedQueryable> orderBy 也意味着调用者将提供一个 lambda 表达式。但在这种情况下，表达式的输入是 TEntity 类型的 IQueryable 对象。表达式将返回该 IQueryable 对象的有序版本。对于例如，如果为 Student 实体类型实例化存储库，则调用方法中的代码可能会为 orderBy 参数指定 q => q.OrderBy(s => s.LastName)。”

它说，当您调用 Get 时，您应该提供一个 lambda 表达式，该表达式将是 IQueryable 上的 Func 或函数，提供 IOrderedQueryable。

因此，对于文章中使用的 Student 对象，您需要使用它。

```
var students = repository.Get(x => x.FirstName = "Bob",q => q.OrderBy(s => s.LastName)); 
```

# c# - 在 c# .net 中使用 postsharp 获取标签名称

> ID：10935080
> 
> 赞同：0
> 
> 时间：2012-06-07T15:36:34.160
> 
> 标签：c#, postsharp

我正在使用以下代码作为

```
 [DisplayOrder]  
public static void ss()
{
    Console.WriteLine("ss");

 } 
```

我正在使用以下代码获取方法名称

```
 foreach (MethodInfo targetMethod in type.GetMethods(BindingFlags.Static | BindingFlags.InvokeMethod | BindingFlags.Default | BindingFlags.CreateInstance | BindingFlags.Instance | BindingFlags.Public | BindingFlags.DeclaredOnly | BindingFlags.SuppressChangeType | BindingFlags.ExactBinding | BindingFlags.FlattenHierarchy | BindingFlags.GetField | BindingFlags.GetProperty ))
            {
                Console.WriteLine("=== " + targetMethod.Name);

                {
                    instances.Add(new AspectInstance(targetMethod, aspectToApply));
                }

            }
            foreach (Type nestedType in type.GetNestedTypes())
            {
                ProcessType(nestedType, instances);
            }
        } 
```

方法的名称来了并且执行得很好

我不知道如何将标签名称设为“[DisplayOrder]”。

卡在这里

不知道如何进行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:40:26.157

请参阅[http://msdn.microsoft.com/en-us/library/z919e8tw(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/z919e8tw(v=vs.80).aspx)

# mysql - 如何从 mysql 的嵌套选择中只返回一列

> ID：10935082
> 
> 赞同：-1
> 
> 时间：2012-06-07T15:36:53.297
> 
> 标签：mysql, sql

你好我对mysql中的嵌套选择有疑问。我想要一个可以实现以下虚拟查询打算实现的目标的工作查询：

```
select t1.col1 from t1
  where t1.col2 in
  (select t3.col2, t3.col3 from t3
     order by t3.col3 limit NUM) 
```

好吧，基本上来说，t1.col2 应该在嵌套选择 t3.col2 中，但是嵌套选择应该按另一列 t3.col3 排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:44:10.707

不幸的是，`MySQL`不支持`LIMIT`与`IN`.

尝试这个：

```
SELECT  col1
FROM    (
        SELECT  DISTINCT col2
        FROM    (
                SELECT  col2
                FROM    t3
                ORDER BY
                        col3
                LIMIT   5
                ) q
        ) q
JOIN    t1
USING   (col2) 
```

# jquery - 启用和禁用可拖动元素

> ID：10935083
> 
> 赞同：1
> 
> 时间：2012-06-07T15:36:53.360
> 
> 标签：jquery

我正在禁用一些“li”可拖动元素，然后尝试根据其 id 和类启用“li”元素。该类正在被删除，但 li 元素仍然不可拖动？

```
//Disabling draggable on li elements using 'not'
$(".myLi:not(.disable)").sortable({
revert : true,
}).draggable({
helper : "clone"                
}
});

<li id="test" class="myLi disable" >Li Point1</li>

var toTest = $('#test');

//Enabling li element to draggable again using id and class
toTest.removeClass('disable'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T15:53:30.887

首先，您只将可拖动功能添加到带有`class` *myli*但没有`class` *禁用*的元素。稍后，您从一个元素中删除`class` *禁用。*因为它从来没有变成功能，所以不能拖动。

首先使所有`li`可拖动，然后您应该使用`enable`and`disable`方法 from `draggable`：

```
$(".myLi").sortable(...).draggable(...);
$(".myLi.disable").draggable('disable'); 
```

如果要启用一个：

```
toTest.draggable('enable'); 
```

另请参阅[此示例](http://jsfiddle.net/Q9sHz/1/)。

# android - 我如何在安卓平板电脑上运行我的安卓应用程序

> ID：10935084
> 
> 赞同：1
> 
> 时间：2012-06-07T15:36:56.797
> 
> 标签：android

我使用 SDK:2.3.3 为我的 android 手机（Samsung GT-S5830）开发了一个应用程序。我想在 android 选项卡（Samsung GT-N7000）上运行我的应用程序。

当我将我的 android 平板电脑与 PC 连接时（使用 Windows-7），PC 会自动安装它的 USB 驱动程序，但是当我运行我的应用程序“设备选择器”窗口不显示我的平板电脑时。

这是我在平板电脑上工作的第一次体验。作为初学者，我需要在我的应用程序中进行哪些更改才能在 Android 平板电脑上运行它。

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:41:21.773

您的 Windows PC 确实安装了 USB 驱动程序，用于将平板电脑安装为大容量存储设备。
您需要的是`ADB Driver`平板电脑的（Android 调试桥）。

[在 XDA Developers 尝试此链接](http://forum.xda-developers.com/showthread.php?t=1571943)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T09:34:44.853

您是否选中了调试模式的复选框？您是否更新了 ADT 和 sdk 更新（它们还包括 Windows 下设备的新驱动程序）。

# ruby-on-rails - 退出 ActiveAdmin 后重定向

> ID：10935085
> 
> 赞同：5
> 
> 时间：2012-06-07T15:36:57.620
> 
> 标签：ruby-on-rails, devise, activeadmin

我正在尝试将用户重定向到我的 root_path，它`/`允许未经身份验证的用户使用，但我似乎无法更改`active admin`.

我知道`active admin`用作`devise`身份验证机制，但我无法覆盖`devise`任何一个的默认值。

我在我的`application_controller.rb`（即使它应该是默认值）中尝试了以下内容：

```
# Overwriting the sign_out redirect path method
def after_sign_out_path_for(resource_or_scope)
  root_path
end 
```

但我仍然在我的日志中看到这一点：

```
Started GET "/admin/logout?locale=fr" for 127.0.0.1 at 2012-06-07 11:30:15 -0400
  Processing by ActiveAdmin::Devise::SessionsController#destroy as HTML
  Parameters: {"locale"=>"fr"}
  AdminUser Load (0.4ms)  SELECT `admin_users`.* FROM `admin_users` WHERE `admin_users`.`id` = 1 LIMIT 1
   (0.1ms)  BEGIN
   (0.3ms)  UPDATE `admin_users` SET `remember_created_at` = NULL, `updated_at` = '2012-06-07 15:30:15' WHERE `admin_users`.`id` = 1
   (0.5ms)  COMMIT
Redirected to http://localhost:3000/admin
Completed 302 Found in 47ms 
```

所以它让我回到登录页面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-03T23:27:54.707

Fivell 的回答有点不正确，因为登录也被重定向到 root_path。更好的是，您可以覆盖特定的设计方法：

```
ActiveAdmin::Devise::SessionsController.class_eval do
  def after_sign_out_path_for(resource_or_scope)
    "/wherever-you-want"
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-24T12:12:31.453

我为此做了一个猴子补丁

```
module ActiveAdmin::Devise::Controller

      def root_path
        "/"  #add your logic
      end
end 
```

将此添加到初始化程序，它必须在注销后强制重定向到根 url。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-20T09:10:41.990

这对我有用

```
# in app/admin/override.rb
ActiveAdmin::Devise::SessionsController.class_eval do
  def after_sign_in_path_for(resource)
    admin_dashboard_path
  end

  def root_path
    "/"  #add your logic
  end

  def after_sign_out_path_for(resource_or_scope)
    root_path
  end
end 
```

# sql-server - 数据库 '[path\MDF file] 无法打开，因为它是 661 版本。此服务器支持 655 及更早版本

> ID：10935090
> 
> 赞同：0
> 
> 时间：2012-06-07T15:37:07.003
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

我将我的项目复制到我的托管服务器空间并在尝试运行它时收到以下消息：

> 数据库 '[path\MDF file] 无法打开，因为它是 661 版本。此服务器支持 655 及更早版本。不支持降级路径。

有什么建议么？我想这与我使用 SQL Server Express 2008 和托管服务提供商无关。如果是这样，我从这里去哪里？SSE 是否有可用于重新创建表的脚本以及其他版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:07:06.470

除了使用 SQL 2000 可比性级别从头开始重新创建数据库之外，我一无所获......

# linux - Imagemagick：为 PDF flate 嵌入生成原始图像数据？

> ID：10935091
> 
> 赞同：4
> 
> 时间：2012-06-07T15:37:09.460
> 
> 标签：linux, pdf, command-line, imagemagick, pdf-generation

我正在尝试提供一个 PDF 的命令行源代码示例（*另请参阅[如何生成可在文档查看器中工作的纯文本源代码 PDF 示例？](https://stackoverflow.com/questions/10932012/how-to-generate-plain-text-source-code-pdf-examples-that-work-in-a-document-view)*），但要嵌入图像。这就是我得到的结果 - 我有一个模板`hello.pdf`：

```
%PDF-1.4
1 0 obj
  << /Type /Catalog
      /Outlines 2 0 R
      /Pages 3 0 R
  >>
endobj

2 0 obj
  << /Type /Outlines
      /Count 0
  >>
endobj

3 0 obj
  << /Type /Pages
      /Kids [ 4 0 R ]
      /Count 1
  >>
endobj

4 0 obj
  << /Type /Page
      /Parent 3 0 R
      /MediaBox [ 0 0 612 792 ]
      /Contents 5 0 R
      /Resources <<   /ProcSet 6 0 R
                      /Font << /F1 7 0 R >>
                      /ProcSet [ /PDF /Text /ImageC ] /XObject << /Im1 8 0 R >>
      >>
  >>
endobj

5 0 obj
  << /Length 173 >>
stream
  BT
    /F1 24 Tf
    100 100 Td
    ( Hello World ) Tj
    200 200 Td
    ( Hello Again ) Tj
    % width skew-right-up skew-top-right height x y
    150 0 0 150 340 130 cm
    % 150 150 Td - irrelevant for image
    /Im1 Do
  ET
endstream
endobj

6 0 obj
  [ /PDF /Text ]
endobj

7 0 obj
  << /Type /Font
    /Subtype /Type1
    /Name /F1
    /BaseFont /Helvetica
    /Encoding /MacRomanEncoding
  >>
endobj

8 0 obj
<<
  /BitsPerComponent 8 /ColorSpace /DeviceRGB /DecodeParms
  <<
    /BitsPerComponent 8 /Colors 3 /Columns 150 /Predictor 10
  >>
  /Filter [ /FlateDecode ] /Height 150 /Length 1418 /Subtype /Image /Type /XObject /Width 150
>>
stream
###endstream
endobj

9 0 obj
  [ /PDF ]
endobj

xref
0 10
0000000000 65535 f
0000000009 00000 n
0000000074 00000 n
0000000120 00000 n
0000000179 00000 n
0000000364 00000 n
0000000466 00000 n
0000000496 00000 n
0000001000 00000 n
0000001100 00000 n

trailer
  << /Size 10
    /Root 1 0 R
  >>
startxref
625
%%EOF 
```

然后，我使用 生成图像数据`convert`，并使用以下方法应用“平面”压缩`zlib`：

```
convert -size 150x150 gradient:\#4b4-\#bfb test.ppm 
du -b test.ppm     # 135017 bytes
python -c "import zlib,sys;sys.stdout.write(zlib.compress(sys.stdin.read()))" < test.ppm > test.flate
du -b test.flate    # 1418 bytes 
```

然后，我替换`/Length 1418`文件中的，最后`###`使用以下命令替换令牌：

```
perl -ne 's/^###/`cat test.flate`/e;print' hello.pdf > hello2.pdf 
```

这个文件显然有不正确的外部参照表，但是，打开`evince`就好了：

![hello2.pdf-evince](../Images/d29c4fc37e70f98b96825a1f57a671f6.png)

...但是，很明显位图的格式不正确。

我也尝试过生成，比如说，

```
convert -size 150x150 gradient:\#4b4-\#bfb -endian LSB rgb:test.raw 
```

...但那些甚至不是一般的绿色（原始图像应该是）。

有谁知道正确的图像格式 - 和`convert`命令行 - 来生成可以“扁平化”并包含在 pdf 中的原始图像？

非常感谢您的任何答案，
干杯！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:14:09.553

好的，修复它；问题是必须在`convert`命令行中指定 8 位深度；因此正确的调用是：

```
convert -depth 8 -size 150x150 gradient:\#4b4-\#bfb rgb:test.raw 
```

然后我们有：

```
du -b test.raw # 67500 bytes
python -c "import zlib,sys;sys.stdout.write(zlib.compress(sys.stdin.read()))" < test.raw > test.flate
du -b test.flate # 664 bytes

# replace /Length 664, and then:

perl -ne 's/^###/`cat test.flate`/e;print' hello.pdf > hello2.pdf 
```

最后，`hello2.pdf`打开`evince`并正确显示位图：

![hello2.pdf-evince-OK](../Images/37be40558c759cd6f2d65a100c7affd0.png)

顺便说一句，我发现这个是因为我实际上是在尝试调试另一个文档中的图像；所以我基本上做了以下事情：

```
# extract and save the stream of this image object
qpdf --show-object=23 --raw-stream-data mybadfile.pdf > myraw.file

# get raw binary data - deflate the saved object stream 
python -c "import zlib,sys;sys.stdout.write(zlib.decompress(sys.stdin.read()))" < myraw.file > myraw.deflate

identify myraw.deflate
# identify: no decode delegate for this image format `myraw.deflate' @ constitute.c/ReadImage/530.

identify rgb:myraw.deflate
# identify: Must specify image size `myraw.deflate' @ rgb.c/ReadRGBImage/155.

identify -size 588x508 rgb:myraw.deflate
# rgb:myraw.deflate=>myraw.deflate RGB 588x508 588x508+0+0 16-bit TrueColor DirectClass 875KiB 0.020u 0:00.030
# identify: Unexpected end-of-file `myraw.deflate': No such file or directory @ rgb.c/ReadRGBImage/261.

display -size 588x508 rgb:myraw.deflate
# display: Unexpected end-of-file `myraw.deflate': No such file or directory @ rgb.c/ReadRGBImage/261\. ### but it shows correctly, except for size?

identify -depth 8 -size 588x508 rgb:myraw.deflate
# rgb:myraw.deflate=>myraw.deflate RGB 588x508 588x508+0+0 8-bit TrueColor DirectClass 875KiB 0.020u 0:00  ## OK

display -depth 8 -size 588x508 rgb:myraw.deflate 
# OK; choosing rgba: is already bad - so confirmed 8-bit rgb 
```

希望这对某人有帮助，
干杯！

# c# - Monitor.Enter(object, ref bool) 与 Monitor.Enter(object) 相比有什么优势？

> ID：10935092
> 
> 赞同：5
> 
> 时间：2012-06-07T15:37:12.197
> 
> 标签：c#, c#-4.0, concurrency, c#-3.0

根据语言规范`lock(obj) statement;`将编译为：

```
object lockObj = obj; // (the langspec doesn't mention this var, but it wouldn't be safe without it)
Monitor.Enter(lockObj);
try
{
    statement;
}
finally
{
    Monitor.Exit(lockObj);
} 
```

但是，它被编译为：

```
try
{
    object lockObj = obj;
    bool lockTaken = false;
    Monitor.Enter(lockObj, ref lockTaken);
    statement;
}
finally
{
    if (lockTaken) Monitor.Exit(lockObj);
} 
```

这似乎比必要的复杂得多。所以问题是，这种实施的优势是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T15:46:13.460

与往常一样，Eric Lippert 已经回答了这个问题：

[编码中的奇妙冒险：锁和异常不能混用](http://blogs.msdn.com/b/ericlippert/archive/2009/03/06/locks-and-exceptions-do-not-mix.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-30T22:21:33.300

最近我在“CLR via C#”中读到它实际上可能不是一个优势。原因是该`finally`块总是释放锁定的资源，即使该`try`块由于意外错误而退出。这可能会使资源处于未定义状态并且可以访问。程序不会死锁，但错误可能更微妙，因此更难找到。

这当然取决于情况，但我想`lock`如果您的优先级是防止由于在最坏的情况下意外中断线程而导致死锁，那么当前的实现最有意义。

# flash - 启用 Smart Touch 遥控器作为鼠标/触摸板输入

> ID：10935096
> 
> 赞同：1
> 
> 时间：2012-06-07T15:37:27.200
> 
> 标签：flash, mouse, touchpad, samsung-smart-tv

在三星 ES8000 附带的网络浏览器中，可以通过 Smart Touch 遥控器支持鼠标/触摸板。

我正在开发一个基于 Flash 的应用程序并且需要支持鼠标输入。电视允许外部鼠标输入，我可以`<mouse>y</mouse>`在`config.xml`.

显然，它还公开了一个我没有使用过的外部鼠标输入 API：

*   [http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_3.1/API_Reference/JavaScript_APIs/Interactive_Remote_API/mousepad](http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_3.1/API_Reference/JavaScript_APIs/Interactive_Remote_API/mousepad)

告诉我的用户他们必须连接外接鼠标才能使用该应用程序显然不是很好。是否可以在其他应用程序中启用 Smart Touch 遥控器作为鼠标/触摸板？我搜索了三星指南文档和谷歌，但找不到任何参考。

# asp.net - 为具有 Silverlight 和 ASP.NET 应用程序的解决方案提供用于全球化的卫星组装的单独项目

> ID：10935098
> 
> 赞同：0
> 
> 时间：2012-06-07T15:37:34.643
> 
> 标签：asp.net, silverlight, localization, globalization, satellite-assembly

我试图找出一种方法，为我在同一个解决方案中的两个应用程序创建一个单独的项目。这可以做到吗？我找不到任何示例，甚至使用卫星程序集进行全球化的教程都非常糟糕。我希望这两个应用程序共享一个共同的资源库。有谁知道我会怎么做？Silverlight 不能引用非 silverlight 项目，所以这已经是一个障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:48:44.463

您可以将单独的项目添加为 Silverlight 类库项目，并从 Silverlight 和 ASP.NET 项目中引用它。在这种情况下，Visual Studio 可能会抛出警告，但这很好用。

# grails - 未使用 Grails 1.3.7 和 WLS 调用的 HttpSessionListener 事件

> ID：10935099
> 
> 赞同：0
> 
> 时间：2012-06-07T15:37:38.017
> 
> 标签：grails, weblogic11g

我有一个在 tomcat 上成功部署的应用程序，我必须迁移到在 Weblogic Server 上运行，但是当我尝试部署时，在 web.xml 中注册了一个未触发的侦听器。WLS 是否需要一些额外的配置才能完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T08:23:09.100

看来这是一场虚惊。WLS 在生成 http 会话时似乎比 Tomcat 更具侵略性，因此稍后重新检测会话侦听器实际上会成功触发。

# windows-phone-7 - 无法在发布模式下运行 windows phone 7 应用程序

> ID：10935102
> 
> 赞同：0
> 
> 时间：2012-06-07T15:37:48.637
> 
> 标签：windows-phone-7

我可以在诺基亚 710 和模拟器的调试模式下成功部署我的应用程序。但是，当我在 Visual Studio 2010 Ultimate 中更改为发布模式时，在这一行抛出了 NullReferenceException

```
PhoneApplicationService.Current.UserIdleDetectionMode = IdleDetectionMode.Disabled; 
```

在文件中`App.xaml.cs`。Nokia 710 和 Emulator 都会出现此问题。一种假设是 VS 有一个错误导致`System.Diagnostics.Debugger.IsAttached`返回 true，而没有真正的 Debugger “attacted”。有什么建议可以解决这个问题吗？

更新：我尝试在`if (System.Diagnostics.Debugger.IsAttached)`. 它不再抛出异常。部署时我得到的只是黑屏，我的应用程序没有运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:26:46.140

我在是否应该删除此问题或发布答案之间犹豫不决。最后，我决定保留它以帮助其他人不会犯这样的菜鸟错误。

这个问题的答案很简单。当我设置发布模式时，我应该执行以下步骤：

*   构建>构建解决方案(F6)
*   构建>部署解决方案

而已。

按 F5 并认为它会部署时我犯了一个错误。实际上 F5 仅用于调试；因此，在调试模式下找不到设备时会引发异常。

希望有所帮助

# python - Serve stylesheet with webapp2 outside of Google App Engine

> ID：10935103
> 
> 赞同：4
> 
> 时间：2012-06-07T15:37:48.700
> 
> 标签：python, css, google-app-engine, static, webapp2

So I have successfully deployed an app using webapp2/jinja2 and a Paste server, but am having trouble serving static stylesheets.

I have had luck accessing static files via [this method](https://stackoverflow.com/questions/8470733/how-can-i-handle-static-files-with-python-webapp2-in-heroku), as well as implementing a StaticFileHandler I found with some google-fu:

```
import os
import mimetypes
import webapp2
import logging

class StaticFileHandler(webapp2.RequestHandler):
    def get(self, path):
        abs_path = os.path.abspath(os.path.join(self.app.config.get('webapp2_static.static_file_path', 'static'), path))
        if os.path.isdir(abs_path) or abs_path.find(os.getcwd()) != 0:
            self.response.set_status(403)
            return
        try:
            f = open(abs_path, 'r')
            self.response.headers.add_header('Content-Type', mimetypes.guess_type(abs_path)[0])
            self.response.out.write(f.read())
            f.close()
        except:
            self.response.set_status(404) 
```

where my main app routing looks like:

```
app = webapp2.WSGIApplication([('/', HelloWorld),
                               (r'/display', DisplayHandler),
                               (r'/static/(.+)', StaticFileHandler)
                              ], debug=True) 
```

My css files are in a folder under the app root: /static/css/main.css

I can access the file via direct url, and even link it as a stylesheet, but the styles won't apply. Any ideas? Is there another way to serve stylesheets? Some way to implement an app.yaml similar to GAE?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:45:20.213

~~you dont need a static file handler.
upload the app with the static file folder by adding this to your `app.yaml`~~

 ~~```
- url: /static/
  static_dir: static 
```~~ 

~~docs are here: [https://developers.google.com/appengine/docs/python/config/appconfig#Static_Directory_Handlers](https://developers.google.com/appengine/docs/python/config/appconfig#Static_Directory_Handlers)~~

edit: see answer below in comments

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T13:03:32.647

@Mnemon, hats off to you for solving my problem. I would upvote you but I'm not allowed to do that. You convinced me that if it's not the only webapp2 way without GAE, it's at least a way that will work.

But also I can contribute that your solution is now installable as "pip install webapp2_static", from [pipi](https://pypi.python.org/pypi/webapp2_static/0.1)--- by an author who seems to be using his real name... you I'm sure. Other webapp2 docs that I found helpful are available [here](http://webapp-improved.appspot.com/guide/app.html#guide-app-config).

I'm implementing your code on a Linux desktop development server, using paste, which you also used:

```
def main():
    from paste import httpserver
    httpserver.serve(app, host='127.0.0.1', port='8080') 
```

But with the code as you have it above (which appears to be utterly identical to that of webapp2_static.py file), I don't find that putting my css files in a folder named static in the app root works as you said.

For example, I have /home/user/proj/public_html/app/app.py, where the py file contains your code plus other "views" for my ultra-simple site. (I don't know how paste really works, so maybe for now the public_html is just in there for reference so that I don't become confused when I'm uploading stuff onto the production server.)

So if I put the css stylesheets into a folder named /static, then, if I put /static in as either a subdirectory of /app or of /public_html I find that neither location works; I must instead make it a subdirectory of /proj.

I wasn't expecting that, but the cure for me is to change the default 'static' in your app.configure.get(..., 'static') call, to 'public_html/app/static'. Then it works, with the /static folder inside /app.

Similarly using the pipi code with './app/static/ in place of the default 'static' doesn't work; I found that I need ./public_html/app/static instead (or maybe it was just /public_html/app/static or even public_html/app/static... I forgot... one of those worked).

I tested how your computation of abs_path works and have reworked it in the code below, in which I have junked your approach in favor of something more Djangoesque. To wit, in my one app py file I put at the top the following:

```
STATIC_DIR = os.sep + 'tostatic' + os.path.abspath(os.path.dirname(__file__)) + os.sep + 'static' 
```

Then in the page to which I want to add css, my Home page in my case, I put a very readable:

```
<link href="{{STATIC_DIR}}/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"> 
```

For the "view" that generates my Home page I have (env is a jinja2 Environment object that takes a template loader as an argument):

```
class Home(webapp2.RequestHandler):
    def get(self):
        template = env.get_template('index.html')
        template_values = {'STATIC_DIR': STATIC_DIR }
        self.response.write(template.render(template_values)) 
```

And finally the URL routing is as in:

```
app = webapp2.WSGIApplication(
[
(r'/', Home),
(r'/tostatic/(.+)', StaticView),
], debug=True) 
```

The view for the static file serving is now:

```
class StaticView(webapp2.RequestHandler):
    def get(self, path):
        path = os.sep + path
        try:
            f = open(path, 'r')
            self.response.headers.add_header('Content-Type', mimetypes.guess_type(path)[0])
            self.response.out.write(f.read())
            f.close()
        except Exception, e:
            print 'Problem in StaticView:', e
            self.response.set_status(404) 
```

To finally close, the problem that I had with your approach is the one that I and other near noobs have with the departure of URLs from the legacy association with the file system. In your approach "static" is both a sub-directory and a string between slashes at the front of the URL that tells the interpreter which view (which webapp2.RequestHandler subclass) to run. You take the /static from the rest of the URL and then later hard-code it back on. And when it comes time to decide what to put in for href in the tag the HTML page coder has to remember that duplicity. With the {{STATIC_DIR}} template variable approach it's clear what to do. And it's easy to redefine the location of the static files--- only the STATIC_DIR declaration has to be changed.

I found that self.response.set_status(404) shows up in Firebug, but not Firefox. Evidently with webapp2 you must provide and serve your own HTTP status code pages.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-10T11:28:49.887

```
self.response.headers.add_header('Content-Type', mimetypes.guess_type(abs_path)[0])
self.response.headers['Content-Type'] = mimetypes.guess_type(abs_path)[0] 
```

# c# - 如何在 WPF 中有条件地执行 EventTrigger？

> ID：10935104
> 
> 赞同：4
> 
> 时间：2012-06-07T15:37:49.213
> 
> 标签：c#, .net, wpf, animation

目前，我有以下代码在 DataGrid 单元格的值更改时刷新它：

```
<TextBlock Background="White" Text={Binding Date, NotifyOnTargetUpdated=True} >
    <EventTrigger RoutedEvent="Binding.TargetUpdated" >
        <BeginStoryboard>
            <Storyboard>
                <ColorAnimation AutoReverse="True" From="#1F1F1F" To="#FFFF88" Duration="0:0:0.2" Storyboard.TargetProperty="Background.Color" FillBehavior="Stop" />
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</TextBlock> 
```

现在，只有当 viewmodel 的布尔值为 true 时，我才需要执行此动画。我怎样才能做到这一点？

编辑：扩展样本

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T08:37:05.427

感谢 XAML 家伙在另一个论坛上的回答。这是问题的答案，解决方案是使用以下附加行为：

```
class AttachedBehaviours
{
    public static bool GetAllowTargetUpdated(DependencyObject obj)
    {
        return (bool)obj.GetValue(AllowTargetUpdatedProperty);
    }

    public static void SetAllowTargetUpdated(DependencyObject obj, bool value)
    {
        obj.SetValue(AllowTargetUpdatedProperty, value);
    }

    // Using a DependencyProperty as the backing store for AllowTargetUpdated.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty AllowTargetUpdatedProperty =
        DependencyProperty.RegisterAttached("AllowTargetUpdated", typeof(bool), typeof(AttachedBehaviours), new UIPropertyMetadata(false, PropChanged));

    static void PropChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        var ele = obj as FrameworkElement;
        var be = ele.GetBindingExpression(TextBlock.TextProperty);
        if (be == null) return;

        var b = be.ParentBinding;

        var newBinding = new Binding(b.Path.Path);
        newBinding.NotifyOnTargetUpdated = (bool)e.NewValue;

        ele.SetBinding(TextBlock.TextProperty, newBinding);
    }
} 
```

这是它在 XAML 中的用法：

```
<TextBlock Background="White" Text="{Binding Date}"  local:AttachedBehaviours.AllowTargetUpdated="{Binding EnableAnimations}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,10,0,0"  > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T19:38:08.807

你有没有尝试过这样的事情：

```
<ControlTemplate.Triggers>
    <DataTrigger Value="false">
        <DataTrigger.EnterActions>
            <BeginStoryboard> 
            <Storyboard> 
                <ColorAnimation AutoReverse="True" From="#1F1F1F" To="#FFFF88" Duration="0:0:0.2" Storyboard.TargetProperty="Background.Color" FillBehavior="Stop" /> 
            </Storyboard> 
        </BeginStoryboard> 

       </DataTrigger.EnterActions>
    </DataTrigger>
</ControlTemplate.Triggers> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:43:53.147

好吧，这就是我解决问题的方法。可能是我写过的最丑陋的代码之一，所以请随意提出更好的建议。

我创建了一个转换器，我使用启用/禁用动画的布尔值绑定到持续时间。像这样的东西：

```
class AnimationEnablerConverter : IValueConverter
{
    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        bool enableAnimation = (bool)value;

        if (enableAnimation)
        {
            return new System.Windows.Duration(new TimeSpan(0, 0, 0, 0, 200));
        }
        else
        {
            return new System.Windows.Duration(new TimeSpan(0, 0, 0, 0, 0));
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    #endregion
} 
```

和 xaml：

```
<ColorAnimation AutoReverse="True" From="#1F1F1F" To="#FFFF88" Duration="{Binding IsAnimationEnabled, Converter={StaticResource anim2}}" Storyboard.TargetProperty="Background.Color" FillBehavior="Stop" /> 
```

# windows-runtime - 导航到其他页面后继续播放的全局 MediaElement

> ID：10935107
> 
> 赞同：4
> 
> 时间：2012-06-07T15:37:55.080
> 
> 标签：windows-runtime, windows-store-apps, winrt-xaml, mediaelement

我正在使用 MediaElement 在我的 Metro 应用程序中播放音乐。即使我导航到另一个页面，我也希望音乐继续播放。

在以下线程中还提出了该问题：http: [//social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/241ba3b4-3e2a-4f9b-a704-87c7b1be7988/](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/241ba3b4-3e2a-4f9b-a704-87c7b1be7988/)

我按照 JimMan 的建议做了 1) 在 App.xaml.cs 中更改了根框架的控件模板以包含 MediaElement

```
var rootFrame = new Frame();
rootFrame.Style = Resources["RootFrameStyle"] as Style;
rootFrame.Navigate(typeof(HomePage), MainViewModel.Instance);
Window.Current.Content = rootFrame;
Window.Current.Activate(); 
```

2）在 Styles.xaml 添加

```
<Style  x:Key="RootFrameStyle" TargetType="Frame">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Frame">
                <Grid>
                    <MediaElement x:Name="MediaPlayer" AudioCategory="BackgroundCapableMedia" AutoPlay="True"  />
                    <ContentPresenter />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>   
</Style> 
```

3) 要访问导航到的页面上的 MediaElement：

```
DendencyObject rootGrid = VisualTreeHelper.GetChild(Window.Current.Content, 0);     
MediaElement rootMediaElement = (MediaElement)VisualTreeHelper.GetChild(rootGrid, 0); 
```

但是 VisualTreeHelper.GetChild(Window.Current.Content, 0); 始终返回 null，即使我尝试访问根页面上的 MediaElemt。

我构建了一个小示例项目来演示。

[示例项目](https://www.dropbox.com/sh/9xh05t9vctfwqcd/B6JmlpaBFm)

有任何想法吗 ？提前致谢 ！

最好的问候法比安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:32:40.310

您的导航处理程序可能会在视觉树完全加载（添加到视觉树）之前调用视觉树子级。您可以尝试将代码移动到 Loaded 事件处理程序。

编辑*

我通过进行以下更改来确认我的理论：

```
public sealed partial class MainPage : Page
{
    public MainPage()
    {
        this.InitializeComponent();
        this.Loaded += OnLoaded;
    }

    private void OnLoaded(object sender, RoutedEventArgs e)
    {
        DependencyObject rootGrid = VisualTreeHelper.GetChild(Window.Current.Content, 0);
        MediaElement rootMediaElement = (MediaElement)VisualTreeHelper.GetChild(rootGrid, 0);
    }
} 
```

# javascript - 在这段 JavaScript 代码中，为什么有些函数可以访问内部变量而有些则不能？

> ID：10935109
> 
> 赞同：1
> 
> 时间：2012-06-07T15:37:55.927
> 
> 标签：javascript

我有以下代码：

```
var dp = dp || {
    VERSION : '0.00.02',
    startApp : function() {
        $(app.init);
        $(app.start);
    }
};
dp.startApp(); 
```

它在下面调用 app.init 和 app.start ：

```
var app = app || {};

app.init = function() {
    this.baseElement = $('div#app');
    $('body').css('background-color', 'beige');
};

app.start = function() {
    //this.baseElement.html('showing this'); //this works
    //this.show(); //error: show is not a function
    app.show(); //error: show is a function, but baseElement is undefined
};

app.show = function() {
    this.baseElement.html('showing this');
}; 
```

为什么`app.start`这样做：

*   第一线工作
*   第二行显示它不是函数
*   第三行说 baseelement 是未定义的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T15:42:36.937

由于您将函数传递给`document.ready`，因此 jQuery 将调用它们并`this`设置为`document`。这意味着您当然可以设置任意属性`document`，但它不是 jQuery 对象，因此它没有您正在调用的方法。

你可以试试这个：

```
$(dp.startApp) //Since `this` doesn't matter here 
```

和

```
startApp : function() {
    app.init(); //Calling the functions as property of `app`, will make `this` set to `app`
    app.start();
} 
```

我想您在这里缺少的最大的事情是绑定`this`是动态的，并且取决于您调用函数的方式，而不是您如何定义它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:43:32.553

`$(app.init);`调用`app.init`函数但接收者不是`app`对象。

因此`baseElement`变量未设置在`init`正确的对象 ( `app`) 中。

你可以试试`$(function(){app.init();app.start();});`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:18:29.117

这就是我将如何构建您的代码：

```
$(function() {

    app = {
        init: function() {
            this.version = '0.00.02';
            this.baseElement = $("div#app");
            this.bindEvents();
            this.start();
        },
        bindEvents: function() {
            $('body').css('background-color', 'beige');
        },
        start: function() {
            this.show();
        },
        show: function() {
            this.baseElement.html('showing this');
        }
    }

});

$(document).ready(function() {
    app.init();
}); 
```

编辑：我知道这并不能回答你的问题，但它清理了一点，让你更容易理解正在发生的事情..

# syntax - # 在 Scheme 数字文字中的含义

> ID：10935110
> 
> 赞同：14
> 
> 时间：2012-06-07T15:37:56.363
> 
> 标签：syntax, scheme, racket

运行 R5RS 的 DrRacket 说这`1###`是一个完全有效的方案编号并打印`1000.0`. 这让我相信井号 (#) 表示数字不准确，但我不确定。规范还说它是数字文字的有效语法，但没有说明这些符号的含义。

关于方案编号文字中的 # 符号表示什么的任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-07T16:59:20.347

哈希语法是在 1989 年引入的。Scheme 作者邮件列表上有一个关于不精确数字的讨论，其中包含几个不错的想法。有些人流行起来，有些人没有。

[http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1989/msg00178.html](http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1989/msg00178.html)

一个坚持的想法是引入`#`代表未知数字。如果您有两个有效数字的测量值，您可以用`23##`该数字表示`2`并且`3`是已知的，但最后一个数字是未知的。如果你写`2300`，那么你看不出两个零是不可信的。当我看到我期望`23##`评估为 2350 的语法时，但（我相信）解释是依赖于实现的。许多实现解释`23##`为 2300。

这里正式介绍了语法：

[http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1989/msg00324.html](http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1989/msg00324.html)

编辑

来自[http://groups.csail.mit.edu/mac/ftpdir/scheme-reports/r3rs-html/r3rs_8.html#SEC52](http://groups.csail.mit.edu/mac/ftpdir/scheme-reports/r3rs-html/r3rs_8.html#SEC52)

> 尝试产生比内部机器表示的数字更多的数字时，将用“#”标记填充多余的数字。这并不是说实现知道或跟踪数字的重要性，只是机器将标记尝试生成只有 15 位机器表示的数字的 20 位数字：
> 
> 3.14158265358979#####；(flo 20 (精确度))

编辑2

Gerald Jay Sussman 写了为什么在此处引入语法：

[http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1994/msg00096.html](http://groups.csail.mit.edu/mac/ftpdir/scheme-mail/HTML/rrrs-1994/msg00096.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-07T15:57:59.517

这是关于数字常量的 R4RS 和 R5RS 文档：

*   [R4RS 6.5.4 数值常量的语法](http://people.csail.mit.edu/jaffer/r4rs_8.html#SEC53)
*   [R5RS 6.2.4 数值常量的语法](http://people.csail.mit.edu/jaffer/r5rs_8.html#SEC54)。

以机智：

> 如果数字的书面表示没有精确前缀，则常数可能不精确或精确。如果它包含小数点、指数或“#”字符代替数字，则为不精确，否则为精确。

不确定它们是否意味着除此之外的任何内容，除了`0`.

# jquery - 设置 jQuery sortable 接受哪些项目

> ID：10935111
> 
> 赞同：2
> 
> 时间：2012-06-07T15:37:56.440
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable

我试图让一堆 jQuery sortables 的行为类似于带有[接受](http://jqueryui.com/demos/droppable/#option-accept)选项集的 droppable。基本上，我有一个搜索功能，它返回三种不同类型的产品（比如苹果、香蕉和柑橘类水果），然后可以将它们拖到用户创建的列表中（搜索结果是 jQuery 可拖动并使用[connectToSortable](http://jqueryui.com/demos/draggable/#option-connectToSortable)），产品是可在这些列表内和之间排序。但我希望这些列表中的每一个都只接受一种类型的产品，理想情况下为用户提供视觉反馈，了解哪些列表可以接受当前被拖动的项目。一些示例代码：

```
<ul id="results">
    <li class="banana">Plantain</li>
    <li class="apple">Granny Smith</li>
    <li class="citrus">Orange</li>
    <li class="banana">Enset</li>
    <li class="apple">Golden Delicious</li>
    <li class="citrus">Lemon</li>
</ul>

<ul class="section banana"></ul>
<ul class="section apple"></ul>
<ul class="section banana"></ul>
<ul class="section citrus"></ul>
<ul class="section apple"></ul>
<ul class="section apple"></ul>
<ul class="section citrus"></ul>

<script type="text/javascript">

    $("ul#results li").draggable({
        helper: "clone", 
        connectToSortable: "ul.section"
    });

    $("ul.section").sortable({
        connectWith: "ul.section"
    });

</script> 
```

在上面的示例中，我希望属于`<ul>`“apple”类的 s 只接受`<li>`也是“apple”等的 s，并且当拖动或排序“apple”时，我希望`<ul>`突出显示“apple”。知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:42:42.710

您可以调用`.draggable`每个部分：

```
$('ul#results li.banana').draggable({
    connectToSortable: 'ul.section.banana'
});
$('ul#results li.apple').draggable({
    connectToSortable: 'ul.section.apple'
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T04:12:38.020

感谢 Thomas 让我走上了正确的道路 - 我按照他的建议满足了要求，并将相同的方法应用于 sortables，如下所示：

```
$("ul.section.apple").sortable({
    connectWith: "ul.section.apple"
});
$("ul.section.banana").sortable({
    connectWith: "ul.section.banana"
});
$("ul.section.citrus").sortable({
    connectWith: "ul.section.citrus"
}); 
```

通过将这些处理程序添加到可拖动对象和可排序对象的开始和停止事件中，我得到了突出显示：

```
...
start: function(event, ui) {
    $("ul.section.apple").addClass("highlight");
},
stop: function(event, ui) {
    $("ul.section.apple").removeClass("highlight");
}
... 
```

ETC

当您考虑时，确实很明显。

# php - 如何为重定向设置 php cookie

> ID：10935112
> 
> 赞同：1
> 
> 时间：2012-06-07T15:37:57.453
> 
> 标签：php, redirect, cookies

当人们访问我的网站时，我需要他们点击两个州（NC 或 VA）之一。根据单击的状态，它会将它们重定向到我网站上的相应页面。设置 cookie 后，我希望他们访问该站点，而不是再次询问问题，它已经知道将它们发送到他们选择的页面（状态）。我对 php 知之甚少...刚好够危险，您可以给我的任何方向将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:41:51.147

You can set the cookie as:

```
setcookie('state', $state, time() + (60 * 60 *24)); 
```

Assuming `$state` is either 'nc' or 'va', this will work:

```
if(isset($_COOKIE['state']))
{
    if($_COOKIE['state'] == 'va')
        header('Location: va/index.php');
    else if($_COOKIE['state'] == 'nc')
        header('Location: vnc/index.php');
}
else
{
    // Make them choose again here.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T15:41:56.227

You should take a look at this php function [setcookie](http://php.net/manual/en/function.setcookie.php).

```
setcookie( "state", "VA", time()+3600 ); 
```

Then redirect using the location header.

```
header( "Location: /" ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:43:39.977

在索引页面上

```
<?php

if(isset($_COOKIE['state']))
{
   switch($_COOKIE['state'])
   {
      case "NC":
        header('location: www.url.com/site1/');
      break;

      case "VA":
        header('location: www.url.com/site2/');
      break;
   }

}
else
{
   //Display site options
}

?> 
```

在各个网站上（例如 www.url.com/site1/）：

```
<?php
if(!isset($_COOKIE['state']))
{
  setcookie('state', "NC" ,time() + (86400 * 7)); //valid for 7 days
}
?> 
```

# python - Django Http404 和 DEBUG 模式捕获 22

> ID：10935113
> 
> 赞同：4
> 
> 时间：2012-06-07T15:37:57.840
> 
> 标签：python, django, http-status-code-404

我`staticfiles`在开发过程中使用该应用程序，除非打开 DEBUG，否则该应用程序不起作用。

从[文档](https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-in-development)：

> 警告 这仅在 DEBUG 为 True 时有效。
> 
> 那是因为这种观点非常低效并且可能不安全。这仅用于本地开发，绝不能在生产中使用。
> 
> 此外，使用 staticfiles_urlpatterns 时，您的 STATIC_URL 设置不能为空或完整的 URL，例如 [http://static.example.com/](http://static.example.com/)。

不过，我正在尝试查看我的 Http404 模板，当然它们在调试模式下不起作用**。**所以我遇到了问题 22 - 如果我想查看 404 页面，我必须关闭 DEBUG，但是没有静态文件是服务器，我看不到任何图像等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:42:14.273

你可以简单地假装你在生产中。跑：

```
python manage.py collectstatic --noinput 
```

将所有文件复制到`STATIC_ROOT`. 然后，暂时将以下内容添加到 urls.py 中：

```
urlpatterns += patterns('',
    (r'^static/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.STATIC_ROOT}),
) 
```

每次更改任何静态文件时都必须运行`collectstatic`，因此我建议在 Firebug 之类的东西中进行实时编辑，然后保存成品。另外，请记住删除`static`目录并在完成后从 urls.py 中删除该行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-07T15:43:48.310

我自己没有尝试过，但您可以尝试设置 DEBUG_PROPAGATE_EXCEPTIONS = True

[https://docs.djangoproject.com/en/dev/ref/settings/](https://docs.djangoproject.com/en/dev/ref/settings/)

# c# - 在更新时从 GridView 内的下拉列表中获取选定的值

> ID：10935114
> 
> 赞同：2
> 
> 时间：2012-06-07T15:37:58.530
> 
> 标签：c#, asp.net, gridview, drop-down-menu

所以我有一些GridView。当您编辑一行时，特定的列会从标签变为 DropDownList。此下拉列表的内容是通过一些 SQL 数据源填充的。用户可以做出选择并点击“更新”。

我如何才能真正获得下拉菜单的 SelectedValue 属性？

我认为这会起作用：

```
 <asp:GridView ... >
        <Columns>
            ...
                <EditItemTemplate>
                    <asp:DropDownList ID="ServiceCategoriesGvDropDown" AutoPostBack="True" .../>
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:Label ... />
                </ItemTemplate>
            </asp:TemplateField>
            ...
        </Columns>
    </asp:GridView> 
```

然后将它与我的 SqlDataSource 中的 ControlParameter 连接起来：

```
 <UpdateParameters>
        ...
        <asp:ControlParameter ControlID="ServiceCategoriesGvDropDown" PropertyName="SelectedValue" ... />
    </UpdateParameters> 
```

但是，我得到以下异常：

System.InvalidOperationException：在 ControlParameter 'ServiceCategoriesID' 中找不到控件'ServiceCategoriesGvDropDown'。

很明显，我的下拉菜单没有找到。也许它已经被这点摧毁了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T06:33:25.147

在网格的更新事件中试试这个。

```
 protected void YourGrid_RowUpdating(object sender, GridViewUpdateEventArgs e)
 {
  DropDownList ddl= (DropDownList )YourGrid.Rows[e.RowIndex].FindControl("ddlId");
  string selectedvalue=ddl.selectedvalue;
  //Your update code goes here
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:41:24.080

我认为你需要做的是：

1.  将`SelectedIndexChange`事件附加到`DropDownlist`您的`Gridview`
2.  抓住`SelectedValue`那个事件。
3.  获取对您的 DataSource 的引用，`UpdateParameters`并以编程方式使用`SelectedValue`.
4.  调用您的数据源的`Update`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:03:39.383

您可以尝试这样做：

假设gridview的ID是gridview1

```
<asp:ControlParameter ControlID="gridview1$ServiceCategoriesGvDropDown" PropertyName="SelectedValue" /> 
```

# magento - magento 订单 id 增量跳跃

> ID：10935117
> 
> 赞同：5
> 
> 时间：2012-06-07T15:38:13.443
> 
> 标签：magento

由于某种原因，订单 ID（sales_flat_order 表上的增量 ID）随后在我的 Magento 1.6.1 上没有增加。这是在下达大量实时订单后的样子：

```
increment_id   created_at            updated_at
100000001      2011-12-14 12:35:24   2011-12-14 12:35:25
100000002      2011-12-14 13:02:39   2011-12-14 13:02:39
100000003      2011-12-14 13:04:18   2011-12-14 13:04:18
100000004      2012-02-01 16:54:58   2012-02-01 16:54:58
100000005      2012-03-14 12:22:35   2012-03-14 12:22:35
100000006      2012-03-20 13:10:48   2012-03-20 13:10:48
100000011      2012-03-29 20:58:48   2012-03-29 20:58:48
100000012      2012-03-29 21:06:43   2012-03-29 21:06:43
100000013      2012-03-30 10:48:20   2012-03-30 10:48:21
100000014      2012-03-30 13:05:40   2012-03-30 13:05:41
100000015      2012-04-03 15:51:01   2012-04-03 15:51:02
100000016      2012-04-19 15:00:49   2012-04-19 15:00:50
100000017      2012-05-09 12:09:21   2012-05-09 12:09:22
100000019      2012-05-24 05:35:35   2012-05-24 05:35:36
100000020      2012-05-24 05:41:11   2012-05-24 05:41:12
100000008      2012-05-24 05:48:52   2012-05-24 05:48:53 
```

我的问题是为什么 Magento 有时会跳跃增量？更糟糕的是，在我的示例中，增量为 100000008 的顺序在 100000020 之后。有人知道为什么会发生这种情况，是否有办法解决它？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-07T20:09:59.530

这是正常的，尽管令人不安是可以理解的。

当 Magento 进入结帐过程时，它会“保留”一个 increment_id 并将其放在报价（购物车）对象上。您可以在以下位置查看获取增量 id 的代码：

```
Mage_Eav_Model_Entity_Type::fetchNewIncrementId() 
```

每个商店最后使用的 ID 存储在 eav_entity_store 中。如果客户在完成结账过程之前放弃了他们的购物车（即报价对象），则保留的 increment_id 将永远不会出现在订单上。当订单号进入繁忙的商店时，您有时可以在订单号中看到这种效果 - 有时，在结账旧购物车的客户的当天订单中会出现一个非常旧的订单 ID。

存在此行为是为了允许 Magento 在订单完成之前向支付网关发送最终订单 ID (increment_id)，从而允许网关将订单 ID 与订单相关联。如果客户放弃网关中的付款流程，订单 ID 已失效（或更准确地说，仍附加到报价单上）。

您可以在 PayPal express 模块中看到这种情况：

```
Mage_Paypal_Model_Express_Checkout::start() 
```

调用

```
Mage_Sales_Model_Quote::reserveOrderId() 
```

如果您想找到您的“缺失”increment_id，请查看字段 reserved_order_id 下的 sales_flat_quote。您应该看到它们附加到未转换的报价对象（购物车）。

这种行为可能会导致某些支付网关出现问题；莫内里斯浮现在脑海中。当您两次向 Moneris 的托管支付页面发送相同的订单 ID 时，它会阻塞并为客户创建一个神秘的错误状态。当客户访问托管支付页面、退出并重新访问该页面时，就会出现这种情况。因此，在某些情况下，有必要以编程方式重新生成与报价对象关联的订单 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-15T09:09:18.850

我遇到了同样的问题，但只有当服务器受到大量负载时。出现此问题是因为数据库在将报价转换为订单时进入锁定状态。经过进一步检查，我发现问题在于它在插入 sales_flat_order 表后立即尝试在事务中写入 sales_flat_order_grid 表。对于并发查询，它会导致锁定冲突。真正的解决方案是将 sales_flat_order_grid 的东西移出事务。

[该链接帮助我理解了这个问题](https://web.archive.org/web/20150213012742/http://www.magentocommerce.com/boards/viewthread/31666/P0)

该补丁为我解决了这个问题。

您必须从 Mage_Sales_Model_Abstract 中删除函数 _afterSave 并添加

```
public function afterCommitCallback(){
    if (!$this->getForceUpdateGridRecords()) {
         $this->_getResource()->updateGridRecords($this->getId());
     }
    parent::afterCommitCallback();
} 
```

让我知道它是否可以为您解决问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-11-22T12:24:53.950

在过去的几个月里，我们多次遇到同样的问题。在检查我们的支付服务提供商交易列表后，我们发现由于潜在的欺诈问题，数以千计的低价值（微）交易被拒绝。我的观点是，欺诈者正试图使用​​我们的结帐流程来探查他们必须查明的卡片列表，以找出哪些卡片有效，哪些卡片已失效。我已将其报告给欺诈行为、我们的网络主机和我们的支付提供商。

总之，我的建议是让您检查您的 PSP 交易清单在同一时间段内。

祝你好运，布里斯克。

# javascript - 如何让 javascript 返回这个值？

> ID：10935125
> 
> 赞同：0
> 
> 时间：2012-06-07T15:38:33.843
> 
> 标签：javascript

警报有效，但返回值为 0。如何让它返回正确的值？

```
var img;
img = new Image();
img.onload = function() {
   alert(img.width);
   return(img.width);
};
img.src = "https://maps.gstatic.com/mapfiles/dir/bike.png";
alert(img.width); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:41:53.263

You can't do that. `onload` runs once the image is loaded, which means after setting the `src`, `onload` will run later.

You need to put all code dealing with the image's width inside the `onload`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:42:39.590

You can return the value, but you have no way of capturing it.

The function you pass to `onload` is executed, when your image has loaded. But there is no way to retrieve the return value there. You can just call another function inside, to process the value.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:44:36.627

我`10`从 Chrome 中的这段代码中得到：

```
var img = new Image();
img.onload = function() { console.log(img.width); }
img.src = "https://maps.gstatic.com/mapfiles/dir/bike.png"; 
```

在查询宽度（in ）之前，您必须等待图像加载`onload`。

# python - 子程序参数未正确从 Python 传递到 Fortran

> ID：10935126
> 
> 赞同：3
> 
> 时间：2012-06-07T15:38:41.650
> 
> 标签：python, fortran, f2py

我正在使用 f2py 编译一个供 Python 脚本使用的数值模块。我已将代码简化为以下最小示例：

fd.f:

```
module fd
  ! Double precision real kind
  integer, parameter :: dp = selected_real_kind(15)

contains

subroutine lprsmf(th)
  implicit none
  real(dp) th
  write(*,*) 'th - fd',th
end subroutine lprsmf

end module fd 
```

次.f：

```
subroutine itimes(th)
  use fd
  implicit none
  real(dp) th

  write(*,*) 'th - it',th
  call lprsmf(th)
end subroutine itimes 
```

重新运行.py：

```
import it

th = 200
it.itimes(th) 
```

用于编译运行的命令如下（注意我是`cmd`在windows下使用的）：

```
gfortran -c fd.f
f2py.py -c -m it --compiler=mingw32 fd.o itimes.f
reprun.py 
```

输出是：

```
th - it  1.50520876326836550E-163
th - fd  1.50520876326836550E-163 
```

我的第一个猜测是，`th`不知何故没有正确地从`reprun.py`to subroutine传递`itimes`。但是，我不理解这种行为，因为代码的完整版本包括其他输入，所有这些都正确传递。从 Fortran 调用 itime 时，我无法让它做同样的事情，所以我假设它与 Python/Fortran 接口有关。谁能提供有关为什么会发生这种行为的任何见解？

**编辑：**`th = 200`用reprun.py 替换产生`th = 200.0`以下输出：

```
th - it  1.19472349365371216E-298
th - fd  1.19472349365371216E-298 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:58:35.420

也将您的 times 子例程包装在一个模块中。这是我所做的：

次.f90：

```
module itime

contains

subroutine itimes(th)
  use fd
  implicit none
  real(dp) th

  write(*,*) 'th - it',th
  call lprsmf(th)
end subroutine itimes

end module 
```

编译并运行：

```
gfortran -c fd.f90
c:\python27_w32\python.exe c:\python27_w32\scripts\f2py.py -c -m it --compiler=mingw32 fd.f90 itimes.f90 
```

运行重新运行.py：

```
import it

th = 200
it.itime.itimes(th) 
```

输出：

```
 th - it   200.00000000000000     
 th - fd   200.00000000000000 
```

# python - 在python中访问资源文件的方法

> ID：10935127
> 
> 赞同：31
> 
> 时间：2012-06-07T15:38:44.523
> 
> 标签：python

在 python 程序中访问资源的正确方法是什么。

基本上，在我的许多 python 模块中，我最终都会编写这样的代码：

```
 DIRNAME = os.path.split(__file__)[0]

  (...) 

  template_file = os.path.join(DIRNAME, "template.foo") 
```

这没关系，但是：

*   如果我开始使用 python zip 包，它将中断
*   这是样板代码

在 Java 中，我有一个功能完全相同 --- 但在代码位于一堆文件夹中和打包在`.jar`文件中时都可以工作。

Python中是否有这样的功能，或者我可能会使用任何其他模式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-07T16:11:51.407

您需要查看在stdlib中使用[get_data或](http://docs.python.org/library/pkgutil.html "获取数据")[使用 setuptools](http://setuptools.readthedocs.io/en/latest/pkg_resources.html) /distribute 中的 pkg_resources。您使用哪一个可能取决于您是否已经使用分发将您的代码打包为鸡蛋。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:57:17.327

试图了解我们如何将这两个方面结合在一起

1.  在本机文件系统中加载资源
2.  打包成压缩文件

阅读有关 zipimport 的快速教程：http: [//www.doughellmann.com/PyMOTW/zipimport/](http://www.doughellmann.com/PyMOTW/zipimport/)

我看到以下示例：

```
import sys
sys.path.insert(0, 'zipimport_example.zip')
import os
import zipimport
importer = zipimport.zipimporter('zipimport_example.zip')
module = importer.load_module('example_package')
print module.__file__
print module.__loader__.get_data('example_package/README.txt') 
```

我认为 __file__ 的输出是“zipimport_example.zip/example_package/__init__.pyc”

需要从内部检查它的外观。

但是我们总是可以做这样的事情：

```
if ".zip" in example_package.__file__:
    ... 
    load using get_data
else:
    load by building the correct file path 
```

**[编辑：]我试图更好地解决这个例子。**

如果包被导入为压缩文件，那么会发生两件事

1.  __file__ 在其路径中包含“.zip”。
2.  __loader__ 在名称空间中可用

如果满足这两个条件，那么您可以在包中执行以下操作：

```
print __loader__.get_data(os.path.join('package_name','README.txt')) 
```

否则模块已正常加载，您可以按照常规方法加载文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:48:25.333

我想[zipimport](http://docs.python.org/library/zipimport.html)标准 python 模块可能是一个答案......

编辑：好吧，不是直接使用模块，而是`sys.path`如示例中所示使用可能是一个好方法：

*   我有一个 zip 文件，里面`test.zip`有一个 python 模块`test`和一个文件`test.foo`
*   为了测试压缩的python模块`test`可以知道`test.foo`，它包含以下代码：

C

```
import os
DIRNAME = os.path.dirname(__file__)
if os.path.exists(os.path.join(DIRNAME, 'test.foo')):
    print 'OK'
else:
    print 'KO' 
```

测试看起来不错：

```
>>> import sys
>>> sys.path.insert(0, r'D:\DATA\FP12210\My Documents\Outils\SVN\05_impl\2_tools\test.zip')
>>> import test
OK
>>> 
```

因此，一个解决方案可能是循环进入您的 zip 文件以检索所有 python 模块，并将它们添加到`sys.path`; 理想情况下，这段代码是您的应用程序加载的第一个代码。

# iphone - iOS OpenEars 无法识别准确的声音

> ID：10935128
> 
> 赞同：1
> 
> 时间：2012-06-07T15:38:55.543
> 
> 标签：iphone, objective-c, ios, speech-recognition, openears

我想通过研究在我的 iPhone 应用程序中实现语音识别功能，我开始了解 OpenEars 库，我下载了它并得到了一个示例项目，我得到了一个示例项目，当我运行它时，如果我说“你好”它以“你说左”的形式返回，我尝试了许多单词组合，但我只得到左、右、下、前等某些响应集。这是openears中的错误吗？如果是这样，有什么办法可以纠正这个问题？提前感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T15:43:20.243

看看[在您的应用程序中使用 OpenEars](http://www.politepix.com/openears/yourapp)

您的示例中有一个`corpus.txt`文件只允许它识别：

去

向前

落后

剩下

对

开始

停止

转动

您可以添加其他单词甚至短语。

# javascript - 在询问用户是否要离开之前检查 ASP 页面是否脏

> ID：10935129
> 
> 赞同：2
> 
> 时间：2012-06-07T15:38:56.083
> 
> 标签：javascript, jquery, asp.net

我有一个 ASP.NET 表单，它有一堆用户输入、文本框、复选框等。我需要能够检查用户是否在未保存的情况下对表单进行了编辑，如果是，则在卸载之前提示。

一旦用户编辑其中一个文本框，我就会设置一个脏标志。如果他们将数据保存在表单上，​​那么我会重置标志。因此，该标志只应在用户编辑但尚未保存时设置。

然后我使用这个标志来决定是否提示用户“你确定要离开这个页面吗？”</p>

代码片段：

```
var _isDirty = false;

    $(function () {
        try {
                $("#MainContent_txtSometextBox").change(function () {
                    _isDirty = true;
                });
            } catch (e) { }
        }); 
```

问题是我不想在每个控件上都设置这个。是否可以在页面级别设置它？我认为这不会那么容易，因为我们在页面上也有自定义用户控件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T15:40:39.077

你可以传递一个不同的选择器

```
$("input, select, textarea").change(function () {
    _isDirty = true;
}); 
```

您可以根据需要扩展它。

如果您需要限制它，请将其包装在`div`, then`find`中。

```
$("#myForm").find("input, select, textarea").change(function () {
    _isDirty = true;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:03:09.003

您可以使用 jquery 的[输入选择器](http://api.jquery.com/input-selector/)来定位所有输入、文本区域、选择和按钮元素。对于按钮，您需要一个点击事件，对于文本框和区域，脏标志在失去焦点时触发。

**[演示](http://jsfiddle.net/jarekb84/r2FjQ/1/)**

```
$('#body :input'​​​​​​​​).change(function () {
    _isDirty = true;
}); 
```

# actionscript-3 - AS3 如何将 vars 发送到继承类的父构造函数？

> ID：10935132
> 
> 赞同：0
> 
> 时间：2012-06-07T15:39:01.167
> 
> 标签：actionscript-3, inheritance

这个标题可能没有意义，所以我会试着解释一下。

假设我在 AS3 中创建了一个类，任何具有一些基本变量的类，并且这些变量是通过该类构造函数设置的

所以..

`var class = new basicClass(var1, var2);`

现在假设我想创建一个继承basicClass的变量/方法等的新类，所以新类有类似的东西

`public class betterClass extends basicClass`

也许这也有一些通过它的构造函数设置的变量。

现在我感到困惑的是，你如何设置父类（basicClass）变量或通过它的构造函数通过创建betterClass来做任何事情？

如果 basicClass 有一个期望值的构造函数，那么你如何设置它，通过做......

`var class2 = new betterClass(var3, var4)`

因为`var3`and`var4`是针对 BetterClass 的构造函数的，所以我看不到一个实例`basicClass`是如何设置的。

我知道这是非常基本的东西，只是我以前从未需要使用继承。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:49:16.637

这样你就有了 BasicClass，它的构造函数可能如下所示：

```
public function BasicClass(var1:*, var2:*)
{
    //do some stuff with var1 and var2
}

//you can extend some metods too
public function niceFunction():void
{
    trace('Oh! Hello!');
} 
```

现在您可以创建 BetterClass：

```
public function BetterClass(var3:*, var4:*)
{
    super(var3, var4);
    //this calls constructor of BasicClass
}

override public function niceFunction():void
{
    super.niceFunction();
    trace('Nice to meet you.');
    //This will trace: Oh! Hello! Nice to meet you.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:42:20.310

您可以使用“super”关键字从扩展类中调用父类的构造函数

```
public betterClass(){
    super(constuctorParam1,constructorParam2);// this calls the constructor of the class this class extended
} 
```

这是更详细的信息 [http://ntt.cc/2009/07/26/beginning-actionscript-3-super-this-setter-getter.html](http://ntt.cc/2009/07/26/beginning-actionscript-3-super-this-setter-getter.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:57:06.290

有时，您有不同的签名

```
package {
  public class A {
    protected var _a:String, _b:String;
    public function A(a:String, b:String) {
      _a = a;
      _b = b;
    }
  }
}

package {
  public class B extends A {
    private var _c:Number;
    public function B(c:Number) {
      super('', '');
      _c = c;
    }
  }
} 
```

您必须了解不同的论点及其含义。此外，如果可能，请提供有用的默认值。

只是一些额外的输入。

# asp.net - ASP.NET Ajax 在 FF 和 Chrome 中不起作用

> ID：10935133
> 
> 赞同：0
> 
> 时间：2012-06-07T15:39:12.117
> 
> 标签：asp.net, ajax, iis-7, ajaxcontroltoolkit

我使用带有一些 ajax 控制工具包元素的 asp.net 3.5 站点。它在 IE 中运行良好，但在 FF 和 Chrome 中不起作用。

在FF它说错误：

> 用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 6.0；WOW64；Trident/4.0；GTB7.3；SLCC1；.NET CLR 2.0.50727；Media Center PC 5.0；.NET CLR 3.5.30729；InfoPath.2 ; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E) 时间戳：2012 年 6 月 7 日星期四 14:14:24 UTC
> 
> 消息：ASP.NET Ajax 客户端框架加载失败。行：98 字符：34 代码：0 URI：[http ://beta2.site.com/page.aspx](http://beta2.site.com/page.aspx)
> 
> 消息：“系统”未定义行：129 字符：1 代码：0 URI： [http ://beta2.site.com/page.aspx](http://beta2.site.com/page.aspx)

我使用 IIS7 网络服务器。

它可能是什么？谁能帮我？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:54:28.490

web.config 文件中的值不正确。

应该适合我：

```
 <httpHandlers>
        <remove verb="*" path="*.asmx"/>
        <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
    </httpHandlers> 
```

# javascript - 如何通过类名查找标签以跳过 jQuery forms.js 中的验证

> ID：10935134
> 
> 赞同：1
> 
> 时间：2012-06-07T15:39:12.790
> 
> 标签：javascript, jquery, ajax

这是我的代码：

```
(function($){
$.fn.extend({
    forms:function(opt){
        if(opt===undefined)
            opt={}
        this.each(function(){
            var th=$(this),
                data=th.data('forms'),
                _={
                    errorCl:'error',
                    emptyCl:'empty',
                    invalidCl:'invalid',
                    notRequiredCl:'notRequired',
                    successCl:'success',
                    successShow:'4000',
                    mailHandlerURL:'bin/MailHandler.php',
                    ownerEmail:'#',
                    stripHTML:true,
                    smtpMailServer:'localhost',
                    targets:'input,textarea',
                    controls:'a[data-type=reset],a[data-type=submit]',
                    validate:true,

                    rx:{
                        ".name":{rx:/^[a-zA-Z'][a-zA-Z-' ]+[a-zA-Z']?$/,target:'input'},
                        ".email":{rx:/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i,target:'input'},
                        ".message":{rx:/.{20}/,target:'textarea'}
                    },
                    preFu:function(){
                        _.labels.each(function(){
                            var label=$(this),
                                inp=$(_.targets,this),
                                defVal=inp.val(),
                                trueVal=(function(){
                                            var tmp=inp.is('input')?(tmp=label.html().match(/value=['"](.+?)['"].+/),!!tmp&&!!tmp[1]&&tmp[1]):inp.html()
                                            return defVal==''?defVal:tmp
                                        })()
                            trueVal!=defVal
                                &&inp.val(defVal=trueVal||defVal)
                            label.data({defVal:defVal})                             
                            inp
                                .bind('focus',function(){
                                    inp.val()==defVal
                                        &&(inp.val(''),_.hideEmptyFu(label),label.removeClass(_.invalidCl))
                                })
                                .bind('blur',function(){
                                    _.validateFu(label)
                                    if(_.isEmpty(label))
                                        inp.val(defVal)

                                        ,_.hideErrorFu(label.removeClass(_.invalidCl))

                                })
                                .bind('keyup',function(){
                                    label.hasClass(_.invalidCl)
                                        &&_.validateFu(label)
                                })
                            label.find('.'+_.errorCl+',.'+_.emptyCl).css({display:'block'}).hide()
                        })
                        _.success=$('.'+_.successCl,_.form).hide()
                    },
                    isRequired:function(el){
                        return !el.hasClass(_.notRequiredCl)
                    },
                    isValid:function(el){                           
                        var ret=true
                        $.each(_.rx,function(k,d){
                            if(el.is(k))
                                ret=d.rx.test(el.find(d.target).val())                                      
                        })
                        return ret                          
                    },
                    isEmpty:function(el){
                        var tmp
                        return (tmp=el.find(_.targets).val())==''||tmp==el.data('defVal')
                    },
                    validateFu:function(el){                            
                        el.each(function(){
                            var th=$(this)
                                ,req=_.isRequired(th)
                                ,empty=_.isEmpty(th)
                                ,valid=_.isValid(th)

                            if(empty&&req)
                                _.showEmptyFu(th.addClass(_.invalidCl))
                                //_.hideEmptyFu(th.removeClass(_.invalidCl))

                            else
                                _.hideEmptyFu(th.removeClass(_.invalidCl))

                            if(!empty)
                                if(valid)
                                    _.hideErrorFu(th.removeClass(_.invalidCl))
                                else
                                    _.showErrorFu(th.addClass(_.invalidCl))                             
                        })
                    },
                    getValFromLabel:function(label){
                        var val=$('input,textarea',label).val()
                            ,defVal=label.data('defVal')                                
                        return label.length?val==defVal?'nope':val:'nope'
                    },
                    submitFu:function(){
                        _.validateFu(_.labels)                          
                        if(!_.form.has('.'+_.invalidCl).length)
                            $.ajax({
                                type: "POST",
                                url:_.mailHandlerURL,
                                data:{
                                    name:_.getValFromLabel($('.name',_.form)),
                                    email:_.getValFromLabel($('.email',_.form)),
                                    phone:_.getValFromLabel($('.phone',_.form)),
                                    state:_.getValFromLabel($('.state',_.form)),
                                    message:_.getValFromLabel($('.message',_.form)),
                                    owner_email:_.ownerEmail,
                                    stripHTML:_.stripHTML
                                },
                                success: function(){
                                    _.showFu()
                                }
                            })          
                    },
                    showFu:function(){
                        _.success.slideDown(function(){
                            setTimeout(function(){
                                _.success.slideUp()
                                _.form.trigger('reset')
                            },_.successShow)
                        })
                    },
                    controlsFu:function(){
                        $(_.controls,_.form).each(function(){
                            var th=$(this)
                            th
                                .bind('click',function(){
                                    _.form.trigger(th.data('type'))
                                    return false
                                })
                        })
                    },
                    showErrorFu:function(label){
                        label.find('.'+_.errorCl).slideDown()
                    },
                    hideErrorFu:function(label){
                        label.find('.'+_.errorCl).slideUp()
                    },
                    showEmptyFu:function(label){
                        label.find('.'+_.emptyCl).slideDown()
                        _.hideErrorFu(label)
                    },
                    hideEmptyFu:function(label){
                        label.find('.'+_.emptyCl).slideUp()
                    },
                    init:function(){
                        _.form=this
                        _.labels=$('label',_.form)

                        _.preFu()

                        _.controlsFu()

                        _.form
                            .bind('submit',function(){
                                if(_.validate)
                                    _.submitFu()
                                else
                                    _.form[0].submit()
                                return false
                            })
                            .bind('reset',function(){
                                _.labels.removeClass(_.invalidCl)                                   
                                _.labels.each(function(){
                                    var th=$(this)
                                    _.hideErrorFu(th)
                                    _.hideEmptyFu(th)
                                })
                            })
                        _.form.trigger('reset')
                    }
                }
            if(!data)
                (typeof opt=='object'?$.extend(_,opt):_).init.call(th),
                th.data({cScroll:_}),
                data=_
            else
                _=typeof opt=='object'?$.extend(data,opt):data
        })
        return this
    }
})
})(jQuery) 
```

我想跳过**状态** 和**电话**验证并提交表单。我已经删除了 regx，现在它没有检查**state**和**phone**，但它显示该字段是必需的。

这是一段HTML代码：

```
 <label class="state">
                                <input type="text" name="state" value="Your Website">
                                <span class="error">*This is not a valid website.</span>
                                <span class="empty">*This field is required.</span>
                                <span class="clear"></span>
                            </label>
                            <label class="phone">
                                <input type="text" name="phone" value="Phone Number">
                                <span class="error">*Enter a valid contact number...</span>
                                <span class="empty">*This is a required field.</span>
                                <span class="clear"></span>
                            </label> 
```

我还尝试删除显示所需字段的跨度，但之后它不会提交表单（提交按钮不起作用）。

花了很多时间后，我认识到 form.js 正在验证 HTML 中的所有**标签**，我如何在 JavaScript 中按名称跳过**标签？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T16:15:34.307

只需将“不需要”类添加到不需要的字段中。

消息：*Het bericht is te kort。*Dit is een verplicht veld。

# maven - Maven 并将 JAR 添加到系统范围

> ID：10935135
> 
> 赞同：87
> 
> 时间：2012-06-07T15:39:13.707
> 
> 标签：maven

我的 Android 项目中有一个 JAR，我希望将它添加到最终的 APK 中。好的，我开始：

```
 <dependency>
        <groupId>com.loopj.android.http</groupId>
        <artifactId>android-async-http</artifactId>
        <version>1.3.2</version>
        <type>jar</type>
        <scope>system</scope>
        <systemPath>${project.basedir}/libs/android-async-http-1.3.2.jar</systemPath>
    </dependency> 
```

但是当我跑步时，`mvn package`我会收到警告：

```
[WARNING] Some problems were encountered while building the effective model for **apk:1.0
[WARNING] 'dependencies.dependency.systemPath' for com.loopj.android.http:android-async-http:jar should not point at files within the project directory, ${project.basedir}/libs/android-async-http-1.3.2.jar will be unresolvable by dependent projects @ line 36, column 25 
```

在最终的 APK 中没有 JAR。

我该如何解决？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2015-06-24T09:59:43.637

我不知道真正的原因，但 Maven 推动开发人员将所有库（也自定义）安装到一些 Maven 存储库中，所以`scope:system`不受欢迎，一个简单的解决方法是使用`maven-install-plugin`

**遵循用法：**

用这种方式写你的依赖

```
<dependency>
    <groupId>com.mylib</groupId>
    <artifactId>mylib-core</artifactId>
    <version>0.0.1</version>
</dependency> 
```

然后，添加 maven-install-plugin

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-install-plugin</artifactId>
    <version>2.5.2</version>
    <executions>
        <execution>
            <id>install-external</id>
            <phase>clean</phase>
            <configuration>
                <file>${basedir}/lib/mylib-core-0.0.1.jar</file>
                <repositoryLayout>default</repositoryLayout>
                <groupId>com.mylib</groupId>
                <artifactId>mylib-core</artifactId>
                <version>0.0.1</version>
                <packaging>jar</packaging>
                <generatePom>true</generatePom>
            </configuration>
            <goals>
                <goal>install-file</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

注意`phase:clean`，要将您的自定义库安装到您的存储库中，您必须运行`mvn clean`然后`mvn install`

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-07T15:46:08.203

您需要[将 jar 添加](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)到本地 maven 存储库。或者（更好的选择）指定适当的存储库（如果存在），以便它可以由 maven 自动下载

`<systemPath>`在任何一种情况下，从依赖项中删除标签

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-12-07T02:09:16.647

```
<plugin>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-maven-plugin</artifactId>
    <configuration>
        <includeSystemScope>true</includeSystemScope>
    </configuration>
</plugin> 
```

试试这个。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-06-07T16:25:59.817

系统范围仅设计用于处理“系统”文件；位于某个固定位置的文件。`/usr/lib`，或`${java.home}`（例如`tools.jar`）中的文件。它并非旨在支持`.jar`项目中的杂项文件。

作者故意拒绝让路径名扩展正常工作以阻止您。因此，在短期内您可以使用`install:install-file`安装到本地 repo 中，然后有一天使用 repo manager 进行共享。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-08T12:43:24.257

试试这个配置。它对我有用：

```
<plugin>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.4</version>
    <configuration>
        <warSourceDirectory>mywebRoot</warSourceDirectory>
        <warSourceExcludes>source\**,build\**,dist\**,WEB-INF\lib\*,
            WEB-INF\classes\**,build.*
        </warSourceExcludes>
        <webXml>myproject/source/deploiement/web.xml</webXml>
        <webResources>
            <resource>
                <directory>mywebRoot/WEB-INF/lib</directory>
                <targetPath>WEB-INF/lib</targetPath>
                <includes>
                        <include>mySystemJar1.jar.jar</include>
                         <include>mySystemJar2.jar</include>
                   </includes>
            </resource>
        </webResources>
    </configuration>
</plugin> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-07T16:02:20.853

使用存储库管理器并将这种 jar 安装到其中。这完全解决了您的问题，适用于您网络中的所有计算机。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-18T00:59:19.893

mvn install:install-file -DgroupId=com.paic.maven -DartifactId=tplconfig-maven-plugin -Dversion=1.0 -Dpackaging=jar -Dfile=tplconfig-maven-plugin-1.0.jar -DgeneratePom=true

将 jar 安装到本地存储库。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-01T07:20:44.907

感谢 Ging3r 我得到了解决方案：

跟着这些步骤：

1.  不要在依赖标签中使用。在 pom.xml 文件的依赖项标记中使用以下内容::

    ```
    <dependency>
    <groupId>com.netsuite.suitetalk.proxy.v2019_1</groupId>
    <artifactId>suitetalk-axis-proxy-v2019_1</artifactId>
    <version>1.0.0</version>
    </dependency>
    <dependency>
        <groupId>com.netsuite.suitetalk.client.v2019_1</groupId>
        <artifactId>suitetalk-client-v2019_1</artifactId>
        <version>2.0.0</version>
    </dependency>
    <dependency>
        <groupId>com.netsuite.suitetalk.client.common</groupId>
        <artifactId>suitetalk-client-common</artifactId>
        <version>1.0.0</version>
    </dependency> 
    ```

2.  在 pom.xml 文件的 plugins 标签中使用以下代码：

    ```
     <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-install-plugin</artifactId>
            <version>2.5.2</version>
            <executions>
                <execution>
                    <id>suitetalk-proxy</id>
                    <phase>clean</phase>
                    <configuration>
                        <file>${basedir}/lib/suitetalk-axis-proxy-v2019_1-1.0.0.jar</file>
                        <repositoryLayout>default</repositoryLayout>
                        <groupId>com.netsuite.suitetalk.proxy.v2019_1</groupId>
                        <artifactId>suitetalk-axis-proxy-v2019_1</artifactId>
                        <version>1.0.0</version>
                        <packaging>jar</packaging>
                        <generatePom>true</generatePom>
                    </configuration>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                </execution>
                <execution>
                    <id>suitetalk-client</id>
                    <phase>clean</phase>
                    <configuration>
                        <file>${basedir}/lib/suitetalk-client-v2019_1-2.0.0.jar</file>
                        <repositoryLayout>default</repositoryLayout>
                        <groupId>com.netsuite.suitetalk.client.v2019_1</groupId>
                        <artifactId>suitetalk-client-v2019_1</artifactId>
                        <version>2.0.0</version>
                        <packaging>jar</packaging>
                        <generatePom>true</generatePom>
                    </configuration>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                </execution>
                <execution>
                    <id>suitetalk-client-common</id>
                    <phase>clean</phase>
                    <configuration>
                        <file>${basedir}/lib/suitetalk-client-common-1.0.0.jar</file>
                        <repositoryLayout>default</repositoryLayout>
                        <groupId>com.netsuite.suitetalk.client.common</groupId>
                        <artifactId>suitetalk-client-common</artifactId>
                        <version>1.0.0</version>
                        <packaging>jar</packaging>
                        <generatePom>true</generatePom>
                    </configuration>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
    ```

我包括来自 lib 文件夹的 3 个罐子：

[![包括spring boot项目中的外部jar](../Images/4a536ce23438c6bc17634d8df00fd2c3.png)](https://i.stack.imgur.com/vWDmP.png)

最后，使用`mvn clean`然后`mvn install`或'mvn clean install'并从目标文件夹或安装路径运行jar文件（见`mvn install`日志）：

`java -jar abc.jar`

注意：如果您在 jenkins 工作，请记住一件事，然后首先使用`mvn clean`然后`mvn clean install`命令为您工作，因为以前的代码`mvn clean install`命令存储缓存用于依赖。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-25T01:50:57.117

在这个线程之后，我能够配置安装插件来加载我的自定义 jar，但是`configuration`在运行时插件没有看到我的`mvn install`

我正在使用`maven-install-plugin:2.5.2`使用`maven:3.6.3-jdk-8`docker 映像的基础。

我不完全理解[文档中的这个注释](https://maven.apache.org/guides/mini/guide-configuring-plugins.html#Using_the_executions_Tag)（在本节的末尾），但似乎你可以给阶段目标一个执行 ID，强制它使用你的配置：

> 注意：元素内部的配置与外部的配置不同，因为它们不能从直接命令行调用中使用，因为它们仅在调用它们绑定到的生命周期阶段时应用。因此，您必须将配置部分移到执行部分之外，以将其全局应用于插件的所有调用。由于 Maven 3.3.1 不再是这种情况，因为您可以在命令行上指定直接插件目标调用的执行 ID。因此，如果您想从命令行运行上述插件并且它是特定的 execution1 配置，您可以执行：

> `mvn myqyeryplugin:queryMojo@execution1`

我最后的工作 docker 命令：

```
docker run -it --rm --name parser -v "$(shell pwd)":/usr/src/parser -w /usr/src/parser maven:3.6.3-jdk-8 mvn -X install:install-file@install-my-jar-file 
```

`install-my-jar-file`我的处决 ID在哪里`<execution><id>install-my-jar-file</id>...`

# java - 试图让视图反映编辑器的状态

> ID：10935151
> 
> 赞同：1
> 
> 时间：2012-06-07T15:40:12.070
> 
> 标签：java, eclipse-rcp

我有一个观点，我想对编辑器中发生的事情做出反应。现在我有一个我想要的按钮，以便在单击它时将视图中的数据更新为一些新的信息集。我从哪里开始，我有我的选择活动，但不知道如何在两者之间进行沟通。我正在寻找一种松散耦合的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:29:57.060

我确信有很多方法可以做到这一点，但我过去曾使用 JFace [IPropertyChangeListener](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fjface%2Futil%2FIPropertyChangeListener.html)接口来进行简单的事件传播。

让您的视图实现 IPropertyChangeListener。创建一个可以注册的 Singleton 类`IPropertyChangeListener`，并向其发送[PropertyChangeEvent](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fjface%2Futil%2FPropertyChangeEvent.html)。然后在您的视图的构造函数中，将其注册到您的单例中。

现在，您可以在编辑器中获取 Singleton 并触发将在您的视图中拾取的事件。

单例的示例代码：

```
public class PropertyChangeEventBus {

    private static PropertyChangeEventBus s_instance = new PropertyChangeEventBus();

    public static PropertyChangeEventBus instance()
    {
        return s_instance;
    }

    private Set<IPropertyChangeListener> m_listeners;

    private PropertyChangeEventBus()
    {
        // use CopyOnWriteArraySet to prevent ConcurrentModificationExceptions
        m_listeners = new CopyOnWriteArraySet<IPropertyChangeListener>();
    }

    public void addListener(IPropertyChangeListener listener)
    {   
        m_listeners.add(listener);       
    }

    public void removeListener(IPropertyChangeListener listener)
    {
        m_listeners.remove(listener);
    }

    public void fire(final PropertyChangeEvent event)
    {   
        // run property change events in UI thread to prevent having to have lots of syncExecs in the listener methods
        ViewUtils.syncExec(new Runnable()
        {           
            @Override
            public void run()
            {
                for (IPropertyChangeListener listener : m_listeners) 
                {
                    try
                    {
                        listener.propertyChange(event);
                    }
                    catch(Exception e)
                    {                       
                        //log it, present error message
                    }
                }
            }
        });     
    }
} 
```

视图的示例代码：

```
//The constructor
public MyView() 
{
    PropertyChangeEventBus.instance().addListener(this);
}

@Override
public void propertyChange(PropertyChangeEvent event)
{
    if(event.getProperty().equals(SOME_CONSTANT))
    {           
        // Refresh View         
    }
} 
```

# ruby - 用于提取表数据的 Nokogiri 和 xpath

> ID：10935162
> 
> 赞同：1
> 
> 时间：2012-06-07T15:41:03.850
> 
> 标签：ruby, html-table, nokogiri

我是个新手，我正在尝试从表中抓取一些数据，但使用 xpath 运气不佳。我可以得到我需要的第一个字段，但是……什么都没有。

每行的表结构如下：

```
<tr bgcolor="#FFF7E7">
<td valign="Top"><font color="#8C4510">
<span id="DataGrid1__ctl3_Label2">Index</span>
</font></td>
<td><font color="#8C4510"><a href="javascript:__doPostBack('DataGrid1$_ctl3$_ctl0','')"><font color="#8C4510">Title</font></a></font></td>
<td><font color="#8C4510"><a href="javascript:__doPostBack('DataGrid1$_ctl3$_ctl2','')"><font color="#8C4510">People</font></a></font></td>
<td valign="Top"><font color="#8C4510">Date</font></td><td><font color="#8C4510"><a href="javascript:__doPostBack('DataGrid1$_ctl3$_ctl4','')">
<font color="#8C4510">Text</font></a></font></td>
<td><font color="#8C4510"><a href="javascript:__doPostBack('DataGrid1$_ctl3$_ctl6','')"><font color="#8C4510">Outcome</font></a></font></td>
<td valign="Top">
<font color="#8C4510"><a href="javascript:__doPostBack('DataGrid1$_ctl3$_ctl8','')"><font color="#8C4510">Click link for more</font></a></font></td>
</tr> 
```

我正在尝试提取索引、标题、人员、文本、结果字段以及链接。我正在设法提取索引，但似乎无法获得其余部分。

在我的 ruby​​ 代码中，我对实际获取表的调用似乎正在工作，但是除了索引之外，我为表的每一行提取字段的循环不是。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:13:33.443

使用您在此处提供的摘录，您可以使用以下 XPath 查询提取文本和链接：

```
require 'rubygems'
require 'nokogiri'

f = File.open('test.html')
doc = Nokogiri::HTML(f)

doc.xpath("//tr//td//a").each do |node|
  puts "#{node.text().strip()}: #{node.attribute('href')}"
end
f.close 
```

但是，没有看到表中的其他行，不确定这是否对其余行有任何帮助。

# javascript - Phonegap html输入元素onclick未触发

> ID：10935166
> 
> 赞同：1
> 
> 时间：2012-06-07T15:41:20.453
> 
> 标签：javascript, cordova, onclick

我正在开发一个 phonegap 应用程序，并且有一个奇怪的情况，即 html 输入按钮的 onclick 没有触发。该按钮确实出现在页面上。我单击按钮，看到按钮上的阴影，所以我知道它正在被单击，但该功能不会触发。代码如下。我采用相同的代码并将其放在 jsfiddle 中，它可以按预期工作。我尝试通过 jquery 设置它，但结果相同。

```
console.log('making photo button');
var photoInput = document.createElement('input');
photoInput.type = 'button';
photoInput.value = 'Add Photo';
photoInput.onclick = function () {alert('photo button clicked');};
console.log(photoInput.onclick);
form.appendChild(photoInput); 
```

两个 console.logs 都会触发，第二个的输出是上面设置的 onclick。为了增加怪异，我在这个下方创建了另一个输入按钮，语法相同但点击不同，它没有问题。唯一的区别是这个块在一个 for 循环中的 switch case 内，动态构建表单，但另一个按钮是在之后创建和附加的。由于显示了日志语句，因此不可能没有到达代码。

提交前编辑：我刚刚开始工作。在创建并附加了循环和其他输入按钮并将表单附加到文档后，我运行以下代码。

```
var photoButton = document.getElementById('photoButton');
photoButton.onclick = function () {alert('photo button after clicked');}; 
```

我可以使用它，但是如果有人知道，我想了解为什么它最初不起作用。

# android - Save Android project to run on PC (eclipse)

> ID：10935169
> 
> 赞同：2
> 
> 时间：2012-06-07T15:41:30.193
> 
> 标签：android, windows, eclipse

Is it possible to convert or to just export an Android project from eclipse to run on a PC without an emulator (like .exe)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:46:52.457

不，这是不可能的，因为 Android 使用`Dalvik VM`每个模拟器都内置的 wich。`.apk`在没有设备的情况下，在模拟器中部署和归档是最快和最简单的方法。

Dalvik vm 是一个完整的环境，在 Windows 上不包括（或...）：

![在此处输入图像描述](../Images/bf2f52c0547676fc4793b9e8200f7128.png)

# jquery - jquery ui button padding override

> ID：10935173
> 
> 赞同：2
> 
> 时间：2012-06-07T15:41:39.760
> 
> 标签：jquery, css, jquery-ui, button

HTML markup is as follows:

```
<button id="Refresh"><img src="refresh.png" /></button> 
```

I am creating this button as a jquery ui button with the following code:

```
$("#Refresh").button(); 
```

Calling this function produces the following markup:

```
<button id="Refresh" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false">
    <span class="ui-button-text">
        <img src="refresh.png">
    </span>
</button> 
```

This works fine. The result is a button with padding of `.4em 1em;` as defined in jquery's CSS. (`.ui-button-text-only .ui-button-text`)

I have several buttons on this page, and I like this padding for most of them. However, for this one button in particular I'd like to have no padding. I realize I could just change the CSS for `.ui-button-text-only` and `.ui-button-text` but that would screw up the other buttons using this style, and I like them the way they are.

So I'm wondering if there's any way to override this css **just for one button**. I took a look at [jquery's button docs](http://jqueryui.com/demos/button/) but it doesn't appear to allow passing of specific CSS in with the button options.

Thanks in advance for the help!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:47:01.537

创建后，您可以在按钮内的跨度中添加一个新类。

```
$("#Refresh").button();
$("#Refresh").find('span.ui-button-text').addClass('yourClass'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:44:58.340

您可以简单地使用 CSS 对其进行样式设置。为了确保它没有被覆盖添加'！important'

添加跨度标签

```
#Refresh span {
    padding:0 !important;
} 
```

# android - Menu items are not shown in SherlockFragmentActivity with tabs

> ID：10935175
> 
> 赞同：4
> 
> 时间：2012-06-07T15:41:46.937
> 
> 标签：android, menu, actionbarsherlock, android-ui

My application runs on Gingerbread. It can properly show action-bar menu-item in normal `SherlockFragmentActivity` but when I add a menu item in an `Activity` with tabs the item is not shown. I was expecting to see the item above the tabs on the right of the name.

Is that normal or I'm doing something wrong?

I can add normal options-menu item that are properly show in the menu.

So the main question is: did someone manage to show both the tabs and the action-bar?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T08:29:40.627

你做错了什么。包括其他菜单选项没有任何问题。如果您使用的是操作栏微调器，则情况不同，因为它不适用于选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T05:16:10.147

尝试在 PrepareOptionsMenu 中添加项目来代替 CreateOptionsMenu 我希望这会起作用

# php - Error using WAMP with LDAP

> ID：10935180
> 
> 赞同：4
> 
> 时间：2012-06-07T15:42:00.213
> 
> 标签：php, ldap

I'm using WAMP and trying to run something like the following:

```
<?php

$ldap = ldap_connect("ldap.example.com");

$user = "exampleUser";
$pass = "examplePass";

if($bind = ldap_bind($ldap, $user, $pass)) {
  // logged in
} else {
  // error message
}

?> 
```

Before doing this though, I tried running phpinfo() to see if ldap was installed, and it doesn't appear anywhere.

I've tried the following:

1.  Uncommented the following line in php.ini: extension=php_ldap.dll
2.  Copied these files into the same directory as php.ini: ssleay32.dll and libeay32.dll
3.  Added the following to my environment variables: C:\wamp\bin\php
4.  Restarted after doing any of these.

I don't really know what I'm doing, but these were the suggestions I found online. Any help would be appreciated!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-23T11:43:49.853

这个答案可能对遇到这个问题的其他人有用，因为自从 OP 发布这个问题已经一年多了。

我在跑

*   WAMP 版本：2.4
*   阿帕奇版本：2.4.4
*   PHP版本：5.4.16

我尝试了大多数建议的解决方案，谷歌搜索会带给你，但似乎没有任何效果。推荐查看[PHP 页面的论坛](http://www.php.net/manual/en/ldap.installation.php)

上面链接中名为 Frank 的用户建议复制`libsasl.dll`到，`[apache folder]\bin`尽管这仅推荐用于早期版本的 php，但此文件位于 php 文件夹中。

```
copy "C:\wamp\bin\php\php5.4.16\libsasl.dll" "C:\wamp\bin\apache\apache2.4.4\bin\libsasl.dll" 
```

这对我有用，当我使用 LDAP 时，它现在出现了`phpinfo()`，虽然除了运行该函数之外我还没有正确测试它`ldap_connect()`，但我假设这意味着它正在工作，我应该能够在我的应用。

除了添加`libsasl.dll`到 Apache bin 之外，我还添加了`C:\wamp\bin\apache\Apache2.4.4\bin`和`C:\wamp\bin\php\php5.4.16`我的`PATH`（即 Windows 环境变量 -> 系统变量 -> 路径），我添加了`ssleay32.dll`and`libeay32.dll`到 Apache 和 php bin，不确定是否需要，但它现在正在工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-10T03:58:19.300

我只是将 'libsasl.dll' 从 php 目录复制到 apache 目录并显然重新启动了 httpd。这解决了我的问题。

这不是 WAMP 安装，我分别安装了 apache 和 php。在 WAMP 或 LAMP 的情况下，可能需要更多文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:58:58.830

你得到什么错误？功能不存在？

此外，您应该在 ldap_connect 函数之后添加以下行：

```
ldap_set_option($ldap, LDAP_OPT_PROTOCOL_VERSION, 3);
ldap_set_option($ldap, LDAP_OPT_REFERRALS, 0);
ldap_set_option($ldap, LDAP_OPT_DEBUG_LEVEL, 7);

if(!$ldap){
    echo "LDAP Failed To Connect: ".ldap_error($ldap);
} 
```

这些选项将 ldap 设置为协议版本 3，这是服务器 2k3 等上的活动目录等所需的，并启用了 ldap 连接上的调试。

**更新**

此外，运行 phpinfo() 并查找扩展目录。导航到该目录并确保 php_ldap.dll 存在于其中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-13T12:52:38.180

`php`我通过在以下 Windows 系统路径中添加文件夹解决了同样的问题：

在命令提示符下

```
SET PATH=C:\wamp\bin\php\php5.3.13;%PATH% 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-07T16:45:33.767

为时已晚，但我遇到了问题，我想补充一点，您必须 在**php 和 apache 的 php.ini中****取消注释 extension=php_ldap.dll**。

# gmail - How to publish a countdown via gmail status?

> ID：10935182
> 
> 赞同：5
> 
> 时间：2012-06-07T15:42:10.587
> 
> 标签：gmail, status

Please is it possible to publish a countdown in my gmail status? Like "01:44:15:23" and its decrements continually.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T10:55:13.747

找到一篇好[文章分享](http://mpcabd.igeex.biz/google-talk-status-countdown/)：

Google Talk 使用 XMPP，那么如果您可以使用连接`XMPP client`到您`Google account`的客户端，则可以使用客户端而不是 Google Talk。

整个机制太简单了（使用 Smack`XMPP Library`是因为它很简单而且对我很有帮助）：

1.  登录。
2.  计算现在和目标日期之间的差异。
3.  发送存在

**登录**

```
import org.jivesoftware.smack.XMPPConnection;

public void connect() {
    XMPPConnection connection = new XMPPConnection(server); //Server is gmail.com for Google Talk.
    connection.connect();
    connection.login(username, password); //Username and password.
} 
```

**计算现在与目标日期之间的差异**

这个过程是使用 Java Calendar 和 Date 对象完成的：

```
import java.util.Calendar;
import java.util.Date;

{
        Calendar calendar1 = Calendar.getInstance();
        Date d = new Date();
        calendar1.setTime(d);

        Calendar calendar2 = Calendar.getInstance();
        calendar2.setTime(endLine); //End line is the date we're counting to.

        long milliseconds1 = calendar1.getTimeInMillis();
        long milliseconds2 = calendar2.getTimeInMillis();
        long diff = milliseconds2 - milliseconds1;

        long diffDays = diff / (24 * 60 * 60 * 1000);
        diff = diff % (24 * 60 * 60 * 1000);

        long diffHours = diff / (60 * 60 * 1000);
        diff = diff % (60 * 60 * 1000);

        long diffMinutes = diff / (60 * 1000);
        diff = diff % (60 * 1000);
} 
```

此代码以天、小时和分钟计算两个日期之间的差异。

**发送存在**

计算完差值后，我们要做的就是发送出席信息：

```
import org.jivesoftware.smack.packet.Presence;

{
         String remaining = Long.toString(diffDays) + &quot; day(s), &quot; + Long.toString(diffHours) + &quot; hour(s), &quot; + Long.toString(diffMinutes) + &quot; minute(s) &quot; + message; //Message is usually: Until &quot;something&quot;.

        Presence presence = new Presence(Presence.Type.available);
        presence.setStatus(remaining);
        presence.setPriority(24); //Highest priority in Google Talk
        presence.setMode(presenceMode); //This is one of XMPP modes (Available, Chat, DND, Away, XA).
        connection.sendPacket(presence);
} 
```

此后，人们将看到您的新状态，而不是 Google Talk 中的状态。（请注意，您将无法在 Google Talk 中看到更改，但请放心，它已更改。如果您想确保更改，请您的一位朋友告诉您您的状态）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T06:17:33.830

它非常简单，只需`status-counter.jar`从[这里](http://goo.gl/wIuv8)下载并编写一个脚本文件

```
java -jar /root/status-counter.jar -status SF -username username@gmail.com -password XXXXXX -datetime 2013-03-21T16:00:00+02:00 -type hours -decimals 0 
```

并编写一个 cron 来完成这项工作

```
*/5 * * * * /path/script.sh > /dev/null 
```

这将每 5 分钟更新一次您的状态。更多细节可以在[这里](http://goo.gl/Murt8)找到。

# sql - sql FInding strings with duplicate characters

> ID：10935183
> 
> 赞同：0
> 
> 时间：2012-06-07T15:42:10.667
> 
> 标签：sql, oracle9i

I have a list of strings:

1.  HEAWAMFWSP
2.  TLHHHAFWSP
3.  AWAMFWHHAW
4.  AUAWAMHHHA

Each of these strings represent 5 pairs of 2 character combinations (i.e. HE AW AM FW SP)

What I am looking to do in SQL is to display all strings that have duplication in the pairs.

Take string number 3 from above; AW AM FW HH AW. I need to display this record because it has a duplicate pair (AW).

Is this possible?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:13:06.983

鉴于当前的要求，是的，这是可行的。这是一个使用递归 CTE 的版本（文本可能需要针对供应商的特性进行调整），在 DB2 上编写和测试。请注意，如果字符串中有超过 2 个对的实例，或者超过 1 组重复，这将返回多行。

```
WITH RECURSIVE Pair (rowid, start, pair, text) as (
                     SELECT id, 1, SUBSTR(text, 1, 2), text
                     FROM SourceTable
                     UNION ALL
                     SELECT rowid, start + 2, SUBSTR(text, start + 2, 2), text
                     FROM Pair
                     WHERE start < LENGTH(text) - 1)
SELECT Pair.rowid, Pair.pair, Pair.start, Duplicate.start, Pair.text
FROM Pair
JOIN Pair as Duplicate
ON Duplicate.rowid = Pair.rowid
AND Duplicate.pair = Pair.pair
AND Duplicate.start > Pair.start 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:15:41.033

这是一个不太优雅的解决方案，但它有效并且无论有多少重复匹配项都只返回一次该行。substring 函数适用于 SQLServer，不确定它适用于 Oracle。

```
select ID, Value
from MyTable
where (substring(Value,1,2) = substring(Value,3,4)
or substring(Value,1,2) = substring(Value,5,6)
or substring(Value,1,2) = substring(Value,7,8)
or substring(Value,1,2) = substring(Value,9,10)
or substring(Value,3,4) = substring(Value,5,6)
or substring(Value,3,4) = substring(Value,7,8)
or substring(Value,3,4) = substring(Value,9,10)
or substring(Value,5,6) = substring(Value,7,8)
or substring(Value,5,6) = substring(Value,9,10)
or substring(Value,7,8) = substring(Value,9,10)) 
```

# c++ - uClinux中的动态分配

> ID：10935187
> 
> 赞同：4
> 
> 时间：2012-06-07T15:42:20.083
> 
> 标签：c++, c, virtual-memory, uclinux, mmu

我是嵌入式开发的新手，我发现传统 Linux 和 uClinux 之间的最大区别是 uClinux 缺少 MMU。

从[这篇文章](http://www.linuxjournal.com/article/7221)：

> 如果没有 VM，每个进程都必须位于内存中可以运行的位置。在最简单的情况下，这个内存区域必须是连续的。一般来说，它不能扩展，因为它上面和下面可能还有其他进程。这意味着 uClinux 中的进程无法像传统 Linux 进程那样在运行时增加其可用内存的大小。

对我来说，这听起来像是所有数据都必须驻留在堆栈上，而且堆分配是不可能的，这意味着 malloc() 和/或“new”是不可能的……这准确吗？也许有允许管理“静态堆”（即可以请求“动态”分配的基于堆栈的区域）的技术/库？

还是我想多了？还是过度简化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T20:51:01.133

在常规 Linux 下，程序员不需要处理物理资源。内核负责这一点，用户空间进程只能看到自己的地址空间。随着堆栈的增长，或者发出 malloc 类型的请求，内核会将空闲内存映射到进程的虚拟地址空间。

在 uClinux 中，程序员必须更关心物理内存。MMU 和 VM 不可用，所有地址空间都与内核共享。当加载用户空间程序时，会为进程分配用于文本、堆栈和变量的物理内存页。进程的程序计数器、堆栈指针和数据/bss 表指针设置为物理内存地址。堆分配（通过 malloc 类型调用）是从同一个池中进行的。

您不必摆脱程序中的堆分配。您将需要关注一些新问题。由于堆栈无法通过虚拟内存增长，因此您必须在链接期间正确调整其大小以防止堆栈溢出。内存碎片成为一个问题，因为没有 MMU 来整合较小的空闲页面。错误指针变得更加危险，因为它们现在可能导致对物理内存中任何位置的意外写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T20:21:24.453

我使用 uCLinux 已经有一段时间了（在它被集成到主树之前），但我认为 malloc 仍然可以作为 c 库的一部分使用。由于堆不是孤立的，因此在内存中执行非常糟糕的事情（tm）的可能性要高得多，但这是可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-03T12:00:22.087

是的，您可以在 uclinux 上的用户空间应用程序中使用 malloc，但是您必须增加用户空间应用程序的堆栈大小（在运行程序之前导致堆栈大小是静态的），这样当 malloc 运行时它将获得空间需要。例如，arm-cortex arm 工具链上的 uclinux 提供了查找和更改用户应用程序二进制文件使用的堆栈大小的命令，然后您可以将其传输到您的嵌入式系统并运行 ----- > arm-uclinuxeabi-flthdr

# c# - Entity framework Data Access Layer project's connection string

> ID：10935188
> 
> 赞同：1
> 
> 时间：2012-06-07T15:42:21.663
> 
> 标签：c#, entity-framework, connection-string, data-access-layer

I have this project made by someone else that's I'm refering in mine; it's a data access layer using Entity Framework.

So of course, when I compile my project, I have my executable, with its .config file.

Here's the kicker: How can I tell the data access layer DLL to which server and with which credentials to connect to it ?

If I open the DAL DLL in Notepad, I do see the connection strings hardcoded in it.

I have modified the DAL project to be able to handle many connection strings, but once compiled, it's baked in it.

Am I misunderstanding the internal workings of EF ?

Thanks a ton.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T16:45:10.727

您很可能希望将凭据存储到某种类型的配置文件中。有几种方法可以做到这一点。查看以下 MSDN 文章：[安全注意事项（实体框架）](http://msdn.microsoft.com/en-us/library/cc716760.aspx)

# snapshot - PyDBG process snapshots not working

> ID：10935190
> 
> 赞同：1
> 
> 时间：2012-06-07T15:42:31.787
> 
> 标签：snapshot, pydbg

I'm following Gray Hat Python book and have copied their code for the process snapshots using PyDBG. When I run the script I get no errors and expected output however my program is not actually reverting to the snapshot. When I go in debug it seems like values are in the snapshot variables as if it is storing snapshot info but I don't really know enough to say for sure.

Here is code:

```
from pydbg import *
from pydbg.defines import *
import threading
import time
import sys

class snapshotter(object):
    def __init__(self,exe_path):
        self.exe_path = exe_path
        self.pid = None
        self.dbg = None
        self.running = True

        pydbg_thread = threading.Thread(target=self.start_debugger)
        pydbg_thread.setDaemon(0)
        pydbg_thread.start()

        while self.pid == None:
            time.sleep(1)

        monitor_thread = threading.Thread(target=self.monitor_debugger)
        monitor_thread.setDaemon(0)
        monitor_thread.start()

    def monitor_debugger(self):
        while self.running == True:
            input = raw_input("Enter: 'snap','restore' or 'quit'")
            input = input.lower().strip()
            if input == "quit":
                print "[*] Exiting the snapshotter."
                self.running = False
                self.dbg.terminate_process()
            elif input == "snap":
                print "[*] Suspending all threads."
                self.dbg.suspend_all_threads()
                print "[*] Obtaining snapshot."
                self.dbg.process_snapshot()
                print "[*] Resuming operation."
                self.dbg.resume_all_threads()
            elif input == "restore":
                print "[*] Suspending all threads."
                self.dbg.suspend_all_threads()
                print "[*] Restoring snapshot."
                self.dbg.process_restore()
                print "[*] Resuming operation."
                self.dbg.resume_all_threads()

    def start_debugger(self):
        self.dbg = pydbg()
        pid = self.dbg.load(self.exe_path)
        self.pid = self.dbg.pid
        self.dbg.run()

exe_path = "C:\\WINDOWS\\System32\\calc.exe"
snapshotter(exe_path) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T03:53:04.717

您的代码在 XP SP1（虚拟机）上的 Python 2.7 上为我工作。您运行的是哪个版本的 Windows？另外，它可能是你的 pydbg 安装？我正在使用在以下位置找到的二进制文件：

[http://www.lfd.uci.edu/~gohlke/pythonlibs/#pydbg](http://www.lfd.uci.edu/~gohlke/pythonlibs/#pydbg)

# c# - 获取特定文件夹下的所有安全组

> ID：10935192
> 
> 赞同：2
> 
> 时间：2012-06-07T15:42:36.090
> 
> 标签：c#, active-directory, ldap

活动目录。如何获取特定文件夹中的所有安全组？

![广告](../Images/2259018a988b2d5e148644482cb1876b.png)

假设我的域是“cfs”。我将列出 cfs\CHC_APP 中的所有安全组。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:47:14.323

你会做这样的事情：

```
DirectoryEntry searchBase = new DirectoryEntry("LDAP://OU=CHC_APP,DC=cfs");
DirectorySearcher searcher = new DirectorySearcher(searchBase);
searcher.Filter = "(&(objectCategory=group)(objectClass=group)(groupType:1.2.840.113556.1.4.803:=2147483648))";

SearchResultCollection results = searcher.FindAll();

//do something with results 
```

# sql-server - 触发器的 SQL if update() 语句

> ID：10935195
> 
> 赞同：3
> 
> 时间：2012-06-07T15:42:40.807
> 
> 标签：sql-server, triggers

如果旧值不等于新值，我希望我的触发器仅在更新时执行。如果值保持不变，我不希望我执行 if 块。

```
if UPDATE(interview)
    BEGIN 
    EXEC sp_send_dbmail
            @profile_name = 'SM_PRFL',
    @recipients = 'email',

    @subject = 'this is a test' ,
    @body = 'message'
            END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:52:23.883

查看以下链接，查找“在 INSTEAD OF 触发器中使用插入和删除的表”：http: [//msdn.microsoft.com/en-us/library/ms191300 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms191300(SQL.90).aspx)

这应该允许您执行测试并根据需要执行操作。例如，您可以...

```
If ( Update(interview))
BEGIN
    -- If column esb has been changed from its previous value
    IF ((SELECT esb FROM INSERTED) <> select esb FROM DELETED)
    BEGIN
    EXEC sp_send_dbmail
            @profile_name = 'SM_PRFL',
    @recipients = 'email',

    @subject = 'this is a test' ,
    @body = 'message'
    END
END 
```

# c# - How to use Majestic13 for parsing HTML?

> ID：10935203
> 
> 赞同：2
> 
> 时间：2012-06-07T15:43:20.840
> 
> 标签：c#, .net, html, silverlight, parsing

I have a HTML document of the structure

```
<table width="85%" border="1" height="315" align="center">
  <tr> 
    <td colspan="2" align="center"><font color="#400040"><b>Register No</b></font></td>
    <th colspan="2"><font color="Brown">42209104069</font></th>
    <td colspan="2" align="center"><font color="#400040"><b>Name</b></font></td>
    <th colspan="2"><font color="Brown">SATHISH KUMAR R</font></th>
  </tr>
  <tr> 
    <td colspan="2"><font color="blue"><center><b>Subject</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Credits</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Grade</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Result</b></font></td>
  </tr>
  <tr>
    <td colspan="2"><center> CS2301</td> //1
    <td colspan="2"><center> 3</td>      //2
    <td colspan="2"><center> E</td>      //3
    <td colspan="2"><center> PASS</td>   //4
  </tr>
</table> 
```

I want to extract the contents of the tag of lines 1,2,3,4 and save to a string. I want to know how to achieve this using Majestic13 in my C# project.

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-07T04:42:20.783

PM>安装包Majestic13

```
 var html=@"<table width="85%" border="1" height="315" align="center">
  <tr> 
    <td colspan="2" align="center"><font color="#400040"><b>Register No</b></font></td>
    <th colspan="2"><font color="Brown">42209104069</font></th>
    <td colspan="2" align="center"><font color="#400040"><b>Name</b></font></td>
    <th colspan="2"><font color="Brown">SATHISH KUMAR R</font></th>
  </tr>
  <tr> 
    <td colspan="2"><font color="blue"><center><b>Subject</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Credits</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Grade</b></font></td>
    <td colspan="2"><font color="blue"><center><b>Result</b></font></td>
  </tr>
  <tr>
    <td colspan="2" class="a"><center> CS2301</td> //1
    <td colspan="2" class="a"><center> 3</td>      //2
    <td colspan="2" class="a"><center> E</td>      //3
    <td colspan="2" class="a"><center> PASS</td>   //4
  </tr>
</table>";

        var paser = new HtmlParser();
        var node = paser.Pasrse(html);
        var finder = new FindTagsVisitor(TagBuilder => tag.Name == "td" && tag.Attributes.ContainsKey("class"));
        node.AcceptVisitor(finder); 
```

# performance - Data Structures: Wikipedia-like Tree

> ID：10935204
> 
> 赞同：5
> 
> 时间：2012-06-07T15:43:25.623
> 
> 标签：performance, data-structures, tree, hierarchy, wikipedia

I am currently in the process of developing an ontology, a web hierarchy of categories of *everything* (think persons, places, things). The finished product should be something that allows me to navigate from Technology->Computers->Laptops->USB Ports, but also from Movies->Minority Report->Computers->etc. I need an efficient data structure to group these. I need a tree-like graph, but a special tree that allows child nodes to have multiple parent nodes. In thinking over this, I have realized that Wikipedia is an imperfect model for this. In fact, they have a hierarchy starting [here](http://en.wikipedia.org/wiki/Category%3aFundamental_categories "here") that is essentially exactly what I need. I see that they used a directed graph, but I am wondering what the differences/drawbacks between this directed graph, a directed acyclic graph, and a polytree are. I have tried researching it, but I don't quite understand the differences. Any help would be greatly appreciated. Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:10:01.090

我认为维基百科上的文章给出了一个很好的概述：

*   有[向图](http://en.wikipedia.org/wiki/Directed_graph)是一组由边连接的节点，这些边具有与它们相关的方向。
*   有[向无环图](http://en.wikipedia.org/wiki/Directed_acyclic_graph)（DAG）是没有有[向](http://en.wikipedia.org/wiki/Cycle_graph#Directed_cycle_graph)环的有向图。
*   多[树](http://en.wikipedia.org/wiki/Polytree)（也称为有向树）是一个有向图，在任意两个顶点之间只有一条无向路径。换句话说，多树是一个有向图，其底层无向图是一个[树](https://en.wikipedia.org/wiki/Tree_(graph_theory))，或者等效地，一个[连接](https://en.wikipedia.org/wiki/Connectivity_(graph_theory))的有向无环图，其中也没有无向环。

所以我认为你搜索一个连通的有向无环图。尽管 Wikipedia 类别系统允许循环，但它们是不需要的。

# java - 嵌套的 JPanel 和 GridBagLayout 不是“打包”组件

> ID：10935206
> 
> 赞同：2
> 
> 时间：2012-06-07T15:43:31.650
> 
> 标签：java, swing, awt, gridbaglayout

我附上了以下`Border`图例适用的屏幕截图：

黄色 =`JPanel`有`BorderLayout`

蓝色 =`JPanel`有`GridBagLayout`

紫红色 =`JPanel`有`FlowLayout`

有两个面板没有被颜色遮挡，值得一提：

1) 显示“Primary”字样的标题面板；此面板`BorderLayout.NORTH`位于“黄色”面板中。

2) 设备图像所在的图像面板；这个面板是“Fuchsia”的兄弟

![嵌套布局问题](../Images/8f56df07261466d9dc9c3b575242acc6.png)

“蓝色”`BorderLayout.CENTER`位于“黄色”，而“紫红色”和图像面板具有以下约束：

```
GridBagConstraints c = new GridBagConstraints();

c.weightx = 1.0;
c.weighty = 1.0;
c.gridx = 0;
c.gridy = 0;
c.anchor = GridBagConstraints.NORTHWEST;
c.insets = new Insets(0, 10, 0, 0);
c.fill = GridBagConstraints.BOTH;

//"Blue".add(imagePanel, c);

c.weighty = 0.80;       
c.gridy = 1;
c.fill = GridBagConstraints.HORIZONTAL;

//"Blue".add("Fuchsia", c); 
```

正如您可能从图像中看出的那样，我正试图摆脱“紫红色”下方“蓝色”中的“浪费”空间。我似乎无法做到这一点`GridBagConstraints`，所以我只是用错了`LayoutManager`吗？在我看来，它就像“蓝色”，他只是给每个孩子一半`CENTER`的可用空间并保留剩余空间而不是向上收缩。我在这里想念什么？这仅仅是在“Fuchsia”上设置首选或最大尺寸的问题吗？这似乎不会让我到达我想去的地方，因为“紫红色”周围的边框（由我的颜色编码覆盖）是我希望组件结束的地方。`BorderLayout``JPanel`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:00:25.727

不使用 GridBagLayout 可能是

![在此处输入图像描述](../Images/b7aced6c15939b7e158d74ae43f269ea.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.border.LineBorder;

public class NestedLayout {

    private JFrame frame = new JFrame();
    private JPanel yellowNorthPanel = new JPanel();
    private JPanel yellowPanel = new JPanel();
    private JPanel bluePanel = new JPanel();
    private JPanel fuchsiaTopPanel = new JPanel();
    private JPanel fuchsiaBottonPanel = new JPanel();

    public NestedLayout() {
        yellowNorthPanel.setBorder(new LineBorder(Color.yellow, 5));
        yellowPanel.setLayout(new BorderLayout());
        yellowPanel.setBorder(new LineBorder(Color.yellow, 5));
        bluePanel.setLayout(new BorderLayout(5, 5));
        bluePanel.setBorder(new LineBorder(Color.blue, 5));
        fuchsiaTopPanel.setBorder(new LineBorder(Color.cyan, 5));
        fuchsiaBottonPanel.setBorder(new LineBorder(Color.cyan, 5));
        bluePanel.add(fuchsiaTopPanel, BorderLayout.NORTH);
        bluePanel.add(fuchsiaBottonPanel);
        yellowPanel.add(bluePanel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(yellowNorthPanel, BorderLayout.NORTH);
        frame.add(yellowPanel);
        //frame.pack();
        frame.setSize(400, 300);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new NestedLayout();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T16:19:08.230

![布局快照](../Images/77613c9b8ab0e32c5f89a278f7195bdf.png)

看看这个输出，来自这个代码示例：

```
import java.awt.*;
import javax.swing.*;

public class LayoutTest
{
    private void displayGUI()
    {
        JFrame frame = new JFrame("Layout Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setOpaque(true);
        contentPane.setBackground(Color.YELLOW);
        contentPane.setLayout(new BorderLayout(2, 2));

        JPanel topPanel = new JPanel();
        topPanel.setLayout(new FlowLayout(FlowLayout.LEFT));
        JLabel headingLabel = new JLabel("Primary");
        topPanel.add(headingLabel);
        contentPane.add(topPanel, BorderLayout.PAGE_START);

        JPanel centerPanel = new JPanel();
        centerPanel.setOpaque(true);
        centerPanel.setBackground(Color.BLUE);
        centerPanel.setLayout(new GridBagLayout());

        GridBagConstraints gbc = new GridBagConstraints();
        gbc.anchor = GridBagConstraints.FIRST_LINE_START;
        gbc.fill = GridBagConstraints.BOTH;
        gbc.weightx = 1.0;
        gbc.weighty = 0.2;
        gbc.gridx = 0;
        gbc.gridy = 0;

        JPanel imagePanel = new JPanel();   
        JLabel imageLabel = null;
        try
        {
            imageLabel = new JLabel(
                            new ImageIcon(
                                new java.net.URL(
                                    "http://pscode.org/"
                                    + "tame/screenshot/"
                                    + "landscape/slider1.gif")));
        }
        catch(Exception e)  
        {
            e.printStackTrace();
        }
        imagePanel.add(imageLabel);
        centerPanel.add(imagePanel, gbc);

        JPanel detailsPanel = new JPanel();
        detailsPanel.setOpaque(true);
        detailsPanel.setBackground(Color.WHITE);
        detailsPanel.setBorder(
                        BorderFactory.createEmptyBorder(
                                              5, 5, 5, 5));
        detailsPanel.setLayout(new GridLayout(0, 1, 5, 5));

        JLabel statusLabel = new JLabel("Chassis Status : ");
        JLabel usageLabel = new JLabel("Bandwidth Usage : ");
        JLabel fanLabel = new JLabel("Fan Status : ");

        detailsPanel.add(statusLabel);
        detailsPanel.add(usageLabel);
        detailsPanel.add(fanLabel);

        gbc.fill = GridBagConstraints.BOTH;
        gbc.weighty = 0.8;
        gbc.gridx = 0;
        gbc.gridy = 1;
        gbc.gridheight = 3;
        centerPanel.add(detailsPanel, gbc);

        contentPane.add(centerPanel, BorderLayout.CENTER);

        frame.setContentPane(contentPane);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new LayoutTest().displayGUI();
            }
        });
    }
} 
```

# jquery - 输入在 IE 中显示为禁用，但未禁用

> ID：10935215
> 
> 赞同：5
> 
> 时间：2012-06-07T15:44:01.627
> 
> 标签：jquery, internet-explorer-8, disabled-input

我的页面上有一个输入（按钮），如下所示：

```
<input id="the-button" type="submit" class="btn" value="Click me!"> 
```

我正在覆盖表单提交操作，因此我可以在实际提交表单之前检查一些事情。在执行此操作之前，我禁用了该按钮，因此用户不会再次单击它，因此他们可以看到该页面正在运行。

```
$("#the-button").attr("disabled", true); 
```

如果我决定不提交表单，我会重新启用该按钮。

```
$("#the-button").attr("disabled", false); 
```

这在 Chrome/Firefox 中按预期工作，但在 IE8 中，该按钮*似乎*被禁用，但您仍然可以单击它。所需的行为是看起来已启用，但在 IE 中显示为灰色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T15:50:01.883

如果您使用的是 jQuery 1.6+，那么您真的应该使用 .prop，因为 'disabled' 是 [元素的属性](http://www.w3schools.com/jsref/prop_html_disabled.asp)

```
$("#the-button").prop("disabled", true);
$("#the-button").prop("disabled", false); 
```

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:07:49.107

正如 Wiry 所说，这是使用 jQuery 的最佳方式`prop`，但是如果您坚持使用旧版本的 jQuery，您可以“镜像”IE 的语句，例如：

```
$("#the-button").attr("disabled", ""); // Enabled
$("#the-button").attr("disabled", "disabled"); // Disabled 
```

ReadOnly 也是如此（显然在文本框等上）

```
$("#the-button").attr("readonly", ""); // Read Write
$("#the-button").attr("readonly", "readonly"); // Read Only 
```

# excel - 从单元格中删除除数字以外的所有数字并在破折号后截断数字

> ID：10935216
> 
> 赞同：1
> 
> 时间：2012-06-07T15:44:06.487
> 
> 标签：excel, vba

我有一行包含地址示例“GILBERT AZ 85234-4512”的一部分。我想删除除 85234 以外的所有字符。因此，删除除数字以外的所有字符，只保留 5 位数的 zip。

这需要循环完成，因为我有 1500 多条记录。如果它不是太麻烦的话，它也可以删除任何剩余的空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T01:32:59.040

这将使用一个`RegExp`和一个变体数组最有效地完成（因为范围循环可能非常慢）

从[这篇文章](http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/Excel/A_2684-Using-varinat-arrays-in-VBA-for-large-scale-data.html)

```
Sub KillNums()
    Dim rng1 As Range
    Dim rngArea As Range
    Dim lngRow As Long
    Dim lngCol As Long
    Dim lngCalc As Long
    Dim objReg As Object
    Dim X()

    On Error Resume Next
    Set rng1 = Application.InputBox("Select range for the replacement of leading zeros", "User select", Selection.Address, , , , , 8)
    If rng1 Is Nothing Then Exit Sub
    On Error GoTo 0

    'See Patrick Matthews excellent article on using Regular Expressions with VBA
    Set objReg = CreateObject("vbscript.regexp")
    objReg.Pattern = "^.+?(\d+)\-.*$"

   'Speed up the code by turning off screenupdating and setting calculation to manual
   'Disable any code events that may occur when writing to cells
    With Application
        lngCalc = .Calculation
        .ScreenUpdating = False
        .Calculation = xlCalculationManual
        .EnableEvents = False
    End With

    'Test each area in the user selected range

    'Non contiguous range areas are common when using SpecialCells to define specific cell types to work on
    For Each rngArea In Intersect(rng1, ActiveSheet.UsedRange).Areas
        'The most common outcome is used for the True outcome to optimise code speed
        If rngArea.Cells.Count > 1 Then
           'If there is more than once cell then set the variant array to the dimensions of the range area
           'Using Value2 provides a useful speed improvement over Value. On my testing it was 2% on blank cells, up to 10% on non-blanks
            X = rngArea.Value2
            For lngRow = 1 To rngArea.Rows.Count
                For lngCol = 1 To rngArea.Columns.Count
                    'replace the leading zeroes
                    X(lngRow, lngCol) = objReg.Replace(X(lngRow, lngCol), "$1")
                Next lngCol
            Next lngRow
            'Dump the updated array back over the initial range
            rngArea.Value2 = X
        Else
            'caters for a single cell range area. No variant array required
            rngArea.Value = objReg.Replace(rngArea.Value, "$1")
        End If
    Next rngArea

    'cleanup the Application settings
    With Application
        .ScreenUpdating = True
        .Calculation = lngCalc
        .EnableEvents = True
    End With

    Set objReg = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:09:43.170

一种快速的方法是选择单元格并选择查找-替换 (Ctrl+H)。

首先`-*`用 nothing 替换，然后用 nothing 替换`* `（包括空格）。

这取决于您的数据格式是否一致，因此请检查结果并在必要时使用撤消/重做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:53:01.597

除非其他地方的地址中有“-”，否则这应该有效。

***更新***：我对邮政编码中没有“-”的情况进行了更改

```
 Sub findZip()
Dim hyphen As String
Dim zip As String
    For Each cell In Range("A2:A1501")
        hyphen = InStr(1, cell, "-")
        If hyphen <> 0 Then
         zip = Trim(Mid(cell, hyphen - 5, 5))
         Else: zip = Right(Trim(cell), 5)
         End If
        cell.Offset(0, 1) = zip
    Next
End Sub 
```

# mysql - MySQL LOAD DATA INFILE：有效，但不可预测的行终止符

> ID：10935219
> 
> 赞同：16
> 
> 时间：2012-06-07T15:44:12.757
> 
> 标签：mysql, csv, delimiter, end-of-line

MySQL 有一个不错的 CSV 导入功能`LOAD DATA INFILE`。

我有一个需要定期从 CSV 导入的大型数据集，所以这个功能正是我所需要的。我有一个可以完美导入数据的工作脚本。

.....除了....我事先不知道行尾终止符是什么。

我的 SQL 代码目前看起来像这样：

```
LOAD DATA INFILE '{fileName}'
 INTO TABLE {importTable}
 FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
 LINES TERMINATED BY '\n'
 IGNORE 1 LINES
( {fieldList} ); 
```

这对于某些导入文件非常有用。

但是，导入数据来自多个来源。其中一些有`\n`终止符；其他人有`\r\n`。我无法预测我会拥有哪一个。

有没有一种方法可以`LOAD DATA INFILE`用来指定我的行可以用`\n`或终止`\r\n`？我该如何处理？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T11:12:22.200

您可以将行分隔符指定为 '\n' 并在加载期间从最后一个字段中删除尾随的 '\r' 分隔符。

例如 -

假设我们有“entries.txt”文件。行分隔符是 '\r\n'，只有行之后`ITEM2 | CLASS3 | DATE2`的分隔符是 '\n'：

```
COL1  | COL2   | COL3
ITEM1 | CLASS1 | DATE1
ITEM2 | CLASS3 | DATE2
ITEM3 | CLASS1 | DATE3
ITEM4 | CLASS2 | DATE4 
```

创建表语句：

```
CREATE TABLE entries(
  column1 VARCHAR(255) DEFAULT NULL,
  column2 VARCHAR(255) DEFAULT NULL,
  column3 VARCHAR(255) DEFAULT NULL
) 
```

我们的 LOAD DATA INFILE 查询：

```
LOAD DATA INFILE 'entries.txt' INTO TABLE entries
FIELDS TERMINATED BY '|'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(column1, column2, @var)
SET column3 = TRIM(TRAILING '\r' FROM @var); 
```

显示结果：

```
SELECT * FROM entries;
+---------+----------+---------+
| column1 | column2  | column3 |
+---------+----------+---------+
| ITEM1   |  CLASS1  |  DATE1  |
| ITEM2   |  CLASS3  |  DATE2  |
| ITEM3   |  CLASS1  |  DATE3  |
| ITEM4   |  CLASS2  |  DATE4  |
+---------+----------+---------+ 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-07T16:18:31.263

我只是预处理它。作为导入过程的一部分，从命令行工具将 \r\n 更改为 \n 的全局搜索/替换应该简单且高效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T06:47:54.547

我假设您只需要通过 mysql 而不是任何编程语言来获取信息。如果您有记事本++，则在使用加载数据之前将格式转换为***windows 格式***\r\n ( CR LF )。然后处理Load数据查询。确保 LINES TERMINATED BY '\r\n'

![在此处输入图像描述](../Images/95637eaa1a5031ee5f9d2fb1bc1344b8.png)

**编辑：**

由于编辑器通常不适合转换较大的文件。对于较大的文件，以下命令通常用于 windows 和 linux

1）在windows中转换成windows格式

```
TYPE [unix_file] | FIND "" /V > dos_file 
```

2）在linux中转换成windows格式

```
unix2dos  [file] 
```

其他命令也可用

windows 格式文件可以通过 tr -d '\r' < inputfile > outputfile删除所有 ASCII *CR \r字符转换为 Unix 格式*

```
grep -PL $'\r\n' myfile.txt # show UNIX format  style file (LF terminated)
grep -Pl $'\r\n' myfile.txt # show WINDOS format style file (CRLF terminated) 
```

在 linux/unix 中，***file***命令检测所使用的行尾 (EOL) 类型。因此可以使用此命令检查文件类型

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T17:44:12.030

您还可以查看其中一个数据集成包。Talend Open Studio 具有非常灵活的数据输入例程。例如，您可以使用一组分隔符处理文件并捕获拒绝并以另一种方式处理它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T21:05:59.007

如果第一次加载有 0 行，则对另一个行终止符执行相同的语句。这应该可以通过一些基本的计数逻辑来实现。

至少它全部保留在 SQL 中，如果它在你第一次获胜时工作。并且可以减少重新扫描所有行并删除特定字符的头痛。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-05T03:50:06.620

为什么不先看看线条是如何结束的？

```
$handle = fopen('inputFile.csv', 'r');

$i = 0;
if ($handle) {
    while (($buffer = fgets($handle)) !== false) {

        $s =  substr($buffer,-50);

        echo $s; 
        echo preg_match('/\r/', $s) ? 'cr ' : '-- ';
        echo preg_match('/\n/', $s) ? 'nl<br>' : '--<br>';          

        if( $i++ > 5)
            break;

    }

    fclose($handle);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-20T07:56:03.990

您可以使用 LINES STARTING 将文本中的常用行结尾和新行分开：

```
LOAD DATA LOCAL INFILE '/home/laptop/Downloads/field3-utf8.csv' 
IGNORE INTO TABLE Field FIELDS 
TERMINATED BY ';' 
OPTIONALLY ENCLOSED BY '^' 
LINES STARTING BY '^' 
TERMINATED BY '\r\n' 
(Id, Form_id, Name, Value) 
```

对于带有 " 封闭字符的普通 CSV 文件，它将是：

```
...
LINES STARTING BY '"' 
... 
```

# android - 带有按钮的自定义视图实现 OnGestureListener

> ID：10935221
> 
> 赞同：7
> 
> 时间：2012-06-07T15:44:28.793
> 
> 标签：android, android-view, android-gesture

在过去的几个小时里，我一直在头疼，用谷歌搜索了谷歌，StackOverflow 或其他地方的例子都没有对我有用，所以就这样......

我有一个自定义视图，即`extends LinearLayout and implements GestureDetector.OnGestureListener`.

在我的自定义布局中，我有 3 个按钮，每个按钮都有一个点击监听器。我想要的是能够在视图中到处乱扔以执行某些操作，而且还能够单击按钮。

如果我在视图内而不是在其中一个按钮上进行操作，我的 onFling 功能会**非常有效。**如果我跳过其中一个按钮，它在大多数情况下会执行点击操作，或者在某些情况下不会执行任何操作。

这是我的代码的相关部分：

```
@Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH) {
            return false;
        }
        // right to left swipe
        if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            viewFlipper.setInAnimation(slideLeftIn);
            viewFlipper.setOutAnimation(slideLeftOut);
            viewFlipper.showNext();
            return true;

        } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            viewFlipper.setInAnimation(slideRightIn);
            viewFlipper.setOutAnimation(slideRightOut);
            viewFlipper.showPrevious();
            return true;
        }

        return false;
    }

    @Override
    public boolean onDown(MotionEvent e) {
        // TODO Auto-generated method stub
        return true;
    }

    @Override
    public void onLongPress(MotionEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
            float distanceY) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public void onShowPress(MotionEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public boolean onSingleTapUp(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (gestureDetector.onTouchEvent(event)) {
            return gestureDetector.onTouchEvent(event);
        }
        return false;
    } 
```

尝试了返回 true 的任意组合；返回假；我能想到...将不胜感激任何帮助！:)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T07:53:19.497

这是最终为我解决的问题......（仅来自我的问题的修改代码）。不确定这是否是最好的解决方案，但它有效：

```
@Override
    public boolean onDown(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }

@Override
    public boolean onTouchEvent(MotionEvent e) {
        return gestureDetector.onTouchEvent(e);
    }

    @Override
    public boolean onInterceptTouchEvent(MotionEvent e) {
        return onTouchEvent(e);
    } 
```

这将允许投掷手势，即使在按钮上，也允许简单地单击按钮，**但是**如果您在该视图后面有另一个带有按钮的视图，有时点击会向后传递并在视图后面的按钮上执行 onClick。解决方案是添加`"android:clickable="true"`到前视图的根布局（LinearLayout、FrameLayout 或其他）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T09:52:17.420

这是一个可能与您描述的情况有关的答案[https://stackoverflow.com/a/9182176/780700](https://stackoverflow.com/a/9182176/780700)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:52:56.010

也许你可以设置一个覆盖`SurfaceView`，你可以处理所有的事情：http: [//developer.android.com/reference/android/view/SurfaceView.html](http://developer.android.com/reference/android/view/SurfaceView.html)

使用顶部的surfaceView，您的按钮应该仍然可以工作，并且您的flings 应该能够毫无问题地越过按钮。

# c# - 当其父表单嵌入另一个应用程序时，如何让 MenuStrip 工作

> ID：10935224
> 
> 赞同：0
> 
> 时间：2012-06-07T15:44:34.883
> 
> 标签：c#, winforms

现在我有一个名为“TargetForm”的带有 MenuStrip 的 WinFormApp，它通过调用 API 函数 SetParent 嵌入到另一个名为“HostForm”的 WinFormApp 中。但是我发现 MenuStrip 停止运行，无论我如何点击它

似乎 TargetForm 的 MenuStrip 在 HostForm 托管时没有意识到鼠标已被单击。

我正在使用 SPY++ 监视 TargetForm 上的 Windows 消息，并发现当我单击菜单时引发了 WM_PARENTNOTIFY

我可以将 Windows 消息 WM_PARENTNOTIFY 从 HostForm 发布到 MenuStrip 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:48:26.743

I would put the contents of the main form of the embedded app into a WinForms User Control (put it into a separate project), and embed the user control into both applications.

# git - Git交互式合并？

> ID：10935226
> 
> 赞同：92
> 
> 时间：2012-06-07T15:44:36.530
> 
> 标签：git, version-control

我有两个具有完全相同文件的分支（如果您想知道它是一个 .sql 文件），我想以交互方式合并它。

几乎我想打开一个差异程序，就像我在发生冲突（或命令行）时所做的那样，并准确选择哪些行去哪里。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-06-07T15:51:29.973

是的，但主要是通过手动实现。你会告诉 Git 你正在合并两个相关的分支，但它不应该尝试自己提交结果，（*编辑添加：*如果它认为合并是微不足道的，也不快进）：

```
git merge --no-commit --no-ff branch-to-merge 
```

然后你会向 git 询问文件，因为它出现在两个分支中：

```
git show HEAD:filename >filename.HEAD
git show branch-to-merge:filename >filename.branch 
```

和他们的合并基地，

```
git show `git merge-base HEAD branch-to-merge`:filename  >filename.base 
```

您将使用您想要的任何工具合并它们（例如）

```
meld filename.{HEAD,branch,base} 
```

您将暂存该 ( `git add filename`)，然后提交合并 ( `git commit`)。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-07-19T20:06:54.240

最简单的方法是以图形`git merge <other_branch`方式`git mergetool`解决冲突。有关如何设置合并工具的信息，请参阅[#10935226 。](https://stackoverflow.com/questions/10935226/git-interactive-merge)

问题是，您更改的文件可能会与旧文件快速合并。然后你必须变得更聪明一点。

Novelocrat 提供了一种深入挖掘的好方法，但您通常必须将初始命令更改为，`git merge --no-commit --no-ff <other_branch>`因为 --no-commit 的真正意思是“不要提交合并……除非它是快进合并。” 对于很多想要做你想做的事的人来说，这有点刺痛。

有时，最不令人困惑的方式不是很时髦：在不同的工作副本中检查另一个分支，使用您最喜欢的合并工具在您想要的目录中获取您想要的版本，然后提交它。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-05-27T20:37:21.887

从您要合并到的分支：

```
git checkout -p branch_to_merge -- 
```

这不会检出 branch_to_merge，但会让您以交互方式从补丁（差异）中添加大块。

[http://git-scm.com/docs/git-checkout](http://git-scm.com/docs/git-checkout)

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2014-03-13T22:24:33.880

根据这个要点， temp 可能是现有的分支。

[https://gist.github.com/katylava/564416](https://gist.github.com/katylava/564416)

* * *

在主人：

```
git checkout -b temp 
```

在温度：

```
git merge --no-commit --no-ff refactor 
```

… 将所有内容分阶段，所以：

```
git reset HEAD 
```

然后开始添加你想要的部分：

```
git add --interactive 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T16:02:15.633

您可以简单地使用[WinMerge](https://winmerge.org/)、[DiffMerge](http://www.sourcegear.com/diffmerge/)或任何可用的 diff/merge UI 工具手动完成工作。如果你想把它挂在“git difftool”中，你可以在线搜索以找到使这些工具与 git 一起使用的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-12T02:09:37.437

我发现这样做的最好方法是：

1.  使用您的更改签出分支
2.  从该点创建一个新分支
3.  将您的新分支重置为您想要比较和构建的提交。默认情况下，重置将是“混合”重置，这意味着它不会更改“工作树”，即实际的代码文件
4.  此时，我的文本编辑器 (VSCode) 向我展示了我当前文件和我重置到的提交之间的不同之处。我可以编辑代码以选择要提交的行。这样做是让我看到我的分支发生的所有变化并确认我将提交的每一行代码。这很有用，例如在将我的更改合并回生产之前。

# java - Memcached 中的多个缓存

> ID：10935231
> 
> 赞同：5
> 
> 时间：2012-06-07T15:44:56.347
> 
> 标签：java, caching, memcached

我正在将缓存**从 EhCache 迁移到 Memcached**。只有 1 个 Memcached 实例，有没有办法拥有多个缓存（如在 EhCache 中）？

例如，我想要一个“用户”缓存、一个“产品”缓存等......主要是为了能够单独监控和配置每个缓存，并且能够单独清除它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:04:56.727

通常，这种行为是通过命名空间在 memcached 中实现的。在单个 memcached 实例中，维护多个命名空间，每个命名空间代表不同的缓存。然而，memcached 本身并不支持命名空间——相反，memcached 命名空间是通过在键前面加上命名空间标识符（例如，`memcachedClient.get('products.top10')`）来模拟的。一些 memcached 客户端，例如[Python GAE memcached 客户端](https://developers.google.com/appengine/docs/python/memcache/clientclass#Client_set)，为您抽象了这种行为。但是，据我所知，xmemcached 没有。

你有两个选择。

*   手动为您使用的每个键添加前缀。
*   编写一个`XMemcachedClient`带有两个更改的瘦包装器：它有一个`String namespace`用作前缀值的成员，并且它覆盖[`get0()`](https://github.com/killme2008/xmemcached/blob/master/src/main/java/net/rubyeye/xmemcached/XMemcachedClient.java#L952)以应用该前缀。这有点危险，因为它依赖于当前的 XMemcached 实现。

# scala - 具有多个参数的scala隐式方法

> ID：10935232
> 
> 赞同：6
> 
> 时间：2012-06-07T15:44:56.623
> 
> 标签：scala, implicit

在对[SIP-13](http://docs.scala-lang.org/sips/pending/implicit-classes.html)的评论中， Martin Odersky 暗示可以创建具有多个参数的隐式方法。根据我的经验，隐式方法总是只有一个参数，我无法想象如何使用具有多个参数的隐式方法。有人可以给出一些用例和解释吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T15:50:46.953

例如，如果您需要函数类型的隐式参数：

```
implicit def foo(x: Int, y: Int) = y * x

def bar(x: Int, y: Int)(implicit f: (Int, Int) => Int) = f(x,y)

scala> bar(3,4)
res3: Int = 12 
```

# html - CSS中有没有办法让一个子元素以一个以上的父元素为目标？

> ID：10935234
> 
> 赞同：0
> 
> 时间：2012-06-07T15:44:59.887
> 
> 标签：html, css, menu

我知道可能有，但情况如下：

我有一个带有标签中链接的大型菜单。当标签内部的链接具有焦点时，我希望标签显示在焦点上。

大多数大型菜单仅适用于悬停。我必须`<li>`专注于工作（因为它就在显示之前），使用`li:focus`. 但是，一旦您在`<li>`和其中的链接之后立即将标签移至内部，就会`<div>`消失。

我确信有一种方法可以通过 jQuery 完成，但我试图避免这种情况。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:19:45.247

目前没有办法在 CSS 中选择元素的父级。这可能在 CSS4 中可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:48:04.817

您不能使用 css 选择父元素，唯一的方法是使用 jQuery parent() 方法。

# css - 合并和缩小 CSS 文件 - 重新定位 url(...)s

> ID：10935239
> 
> 赞同：2
> 
> 时间：2012-06-07T15:45:19.170
> 
> 标签：css, url, minify

作为部署的一部分，我将几个 CSS 文件缩小并合并为一个。但是，这样做时，规则等`url()`使用的许多 s`background-image`都将失效，因为 CSS 规则从一个文件（在一个位置）移动到另一个文件。

是否有任何 CSS 缩小器可以重新建立这些 URL 的基础？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:53:01.357

试试[这个](http://code.google.com/p/minify/wiki/UriRewriting)；它可能会有所帮助。如果没有，告诉我，我会去寻找别的东西。

# php - 如何使用 php 自动更新数据库值？

> ID：10935240
> 
> 赞同：0
> 
> 时间：2012-06-07T15:45:19.653
> 
> 标签：php, mysql, database

当从购物篮中添加或删除商品时，我网站上的商店会调整商品数量。但是，如果有人来到该站点并将一件商品中的 10 件添加到购物篮中并且没有删除这 10 件商品就离开了，那么他们将永远不会返回到数据库中。

如果有人在将商品从购物篮中取出之前离开网站，我该如何补充商品数量？也许是一个cron？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:59:01.400

用户将物品放入购物篮后是否需要立即“保留”？

## 是的

当用户预订项目时，将其预订时间存储在表格中。在计算产品的可用项目数时，减去当前保留的项目数。

当/如果用户为该项目付款时，从保留表中删除该项目并将其标记为已购买。

然后使用 cron 在 time 之后删除保留表中的所有项目`x`。

这样做的缺点是用户的购物篮将在 time 之后清空`x`，因此您必须告知用户他们还剩下多少时间来支付他们的物品。

这更适合需求量大的商品，这些商品在付款之前可能会缺货。例如，活动门票。

## 不

不要在用户将商品放入购物篮时将其标记为已保留，并在用户付款时再次检查库存。如果产品在他们将商品放入购物篮后已经缺货，则显示错误。

这更容易，更适合低需求的产品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:48:23.760

编写一个脚本来清理陈旧的备份（例如，最后一次访问是在 2 小时前）并在 cron 中调用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T15:55:16.440

您可以创建一个 cron 作业，在商品放入购物车后每隔 X 小时自动从客户购物车中删除元素，但这可能会从购物车中删除仍在被活动用户使用的商品，因此这可能会被忽视。

一种做你想做的事的方法也是使用 JavaScript 来捕捉用户关闭网站/去 afk X 小时。一旦任何一个元素被触发，您就可以进行 AJAX 调用以从购物车中删除商品并相应地更新网站。这似乎是解决您的问题“当他们离开网站时”最直接的解决方案，但如果 cookie 被客户端本身破坏，则不会真正解决问题。

无论哪种方式，您都需要考虑一种方法来确保客户端、会话和数据库上的数据同步，以确保没有物品是“孤立的”，并且不会对不存在的物品进行购买。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T15:56:46.557

首先，很难确定用户何时离开站点并且不会返回。有很多方法，但并非所有方法都是万无一失的。我在下面详细介绍的最好的一个：

访问者可以是注册用户，也可以是尚未注册的新用户。您的代码应将购物车内容连同添加时间一起保存在数据库表中。记录需要与用户标识 - 已注册或未注册。注册后，您只需将注册用户的 ID 保存在购物车表中即可。如果它是未注册用户，那么您需要使用 cookie 并在购物车表和 cookie 上保存一个 ID。

如果用户在特定时间段内离开并返回，例如 1 小时，则用户可以看到购物车内容完好无损。

同时，您需要编写一个脚本来查找超过 1 小时的购物车内容并删除它们并将库存退回到您的库存中。您可以设置一个 cron，每隔几分钟（例如 15 分钟等）运行一次此脚本。

如果用户在此过程运行后返回，则购物车将不包含添加的项目，用户将需要再次添加它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T15:52:19.350

在他们完全完成购买之前，不要从您的库存中删除数量。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-07T15:49:32.420

为此使用 cookie。我在我的客户商店使用它的方法。示例： http: [//magazinsvarki.ru/](http://magazinsvarki.ru/)

# ruby - 匹配参数

> ID：10935248
> 
> 赞同：0
> 
> 时间：2012-06-07T15:45:50.293
> 
> 标签：ruby, regex, match

Ruby 中的以下方法可以帮助扫描带有哈希的输入字符串吗？

```
def foo(bar)
  (bar.scan(/^#/).empty?) ? "##{bar}" : bar
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:50:18.757

您可以通过以下方式实现相同的目标：

```
if bar.start_with?('#')
  bar
else
  "##{bar}"
end 
```

或使用三元：

```
bar.start_with? '#' ? bar : "##{bar}" 
```

# html - IE8中的旋转图像打印

> ID：10935249
> 
> 赞同：0
> 
> 时间：2012-06-07T15:45:50.480
> 
> 标签：html, css, printing, internet-explorer-8

我有一个使用 CSS3 转换或 filter css 命令旋转图像的站点。当我在 IE8 中打印页面时，图像不会旋转打印出来。

无论如何要做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:58:08.410

早期的 ie 不支持 css 3 转换。您需要使用 javacript 在某种程度上复制效果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T09:27:32.333

我在 IE8 上遇到了同样的问题，并通过将媒体属性设置为样式标记来解决，如下所示。

```
<style type="text/css" media="print"> 
```

# xcode - Xcode 上的 OpenGL 第 5 版源码

> ID：10935260
> 
> 赞同：1
> 
> 时间：2012-06-07T15:46:18.033
> 
> 标签：xcode, opengl, opengl-3

我从这里下载了 OpenGL 第 5 版示例的源代码：http: [//www.starstonesoftware.com/OpenGL/](http://www.starstonesoftware.com/OpenGL/) 这是一个名为 XCode.zip 的文件

那里的项目实际上从未针对 OpenGL 3.0 的最新 Xcode 进行更新。我想知道是否有人已经走了这条危险而黑暗的道路并让这些项目工作，或者是否有最新 XCode 的新 zip 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T21:38:42.740

问题是这些示例使用了 GLUT，它尚未更新为能够在 OS X 上使用 OpenGL 3。

> 苹果没有更新 GLUT。试图腾出时间采用 GLFW 作为新框架。
> 
>                                                 — *Richard S. Wright Jr.，[在 Twitter 上发帖](http://twitter.com/opengl/status/231218659484381184)*

# ssh - 为什么 Fabric 会抛出 'TypeError: argument must be an int, or have a fileno() method'？

> ID：10935263
> 
> 赞同：11
> 
> 时间：2012-06-07T15:46:25.767
> 
> 标签：ssh, fabric, ssh-keys

在远程服务器上运行 Fabric 任务时，我得到以下堆栈跟踪：

```
[x.x.x.x] run: git fetch && git reset --hard origin/develop
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/usr/lib/python2.6/threading.py", line 532, in __bootstrap_inner
    self.run()
  File "/var/lib/jenkins/jobs/deploy/workspace/.pyenv/lib/python2.6/site-packages/ssh/agent.py", line 115, in run
    self._communicate()
  File "/var/lib/jenkins/jobs/deploy/workspace/.pyenv/lib/python2.6/site-packages/ssh/agent.py", line 125, in _communicate
    events = select([self._agent._conn, self.__inr], [], [], 0.5)
TypeError: argument must be an int, or have a fileno() method. 
```

Fabric 任务正在尝试执行*git fetch并且在**ssh/agent.py*中引发异常的事实让我认为 SSH 身份验证有问题。

同一用户可以在 Fabric 之外运行*git fetch ，并且该任务在我的笔记本电脑上运行良好。*

这里发生了什么？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T13:29:36.927

[Fabric 的问题跟踪器上提出的一个问题](https://github.com/fabric/fabric/issues/642)提到该错误可能是由于主机上没有运行 ssh-agent 引起的。

我通过启动 ssh-agent 并添加用户密钥解决了这个问题：

```
$> eval `ssh-agent`
$> ssh-add ~/.ssh/id_rsa 
```

成功！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-20T16:45:38.623

要在您首次登录时自动启动 ssh-agent，请将其添加到您的`~/.bashrc`：

```
if [ ! -S ~/.ssh/ssh_auth_sock ]; then
  eval `ssh-agent`
  ln -sf "$SSH_AUTH_SOCK" ~/.ssh/ssh_auth_sock
  ssh-add
fi
export SSH_AUTH_SOCK=~/.ssh/ssh_auth_sock 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-14T23:51:13.937

当我尝试在`./manage.py shell_plus`.

事实证明（对我来说）该错误是由于我的 shell_plus 设置为使用 bpython 而不是 ipython 造成的。

`./manage.py shell_plus --ipython`相反，当我跑步时，一切都运行良好。

我意识到这可能不是对您的问题的直接答案，但我想我不妨在这里为其他像我一样遇到此问题的人留个便条。

# python - 带有两个日期字段的 django 请求

> ID：10935265
> 
> 赞同：0
> 
> 时间：2012-06-07T15:46:32.100
> 
> 标签：python, django, date, filter, request

我正在尝试使用过滤器对日期和表示年份的整数组合的请求，但在执行此操作时遇到了一些麻烦。

这是我的模型：

```
class Exemple(models.Model):
    date_field = models.DateField()
    year_field = models.IntegerField() 
```

这是有效的请求：

```
exs = Exemple.objects.extra(where=["DATE(date_field, '+' || year_field|| ' years') < DATE('now') OR date_field is NULL"]) 
```

我想只使用 django ORM 做同样的请求，我试过这个（没用）

```
from django.db.models import F
import datetime
exs = Exemple.objects.filter(date_field__lt=datetime.timedelta(days=-365*F('year_field'))+datetime.datetime.today().year) 
```

我认为问题在于 F() 在 timedelta 被调用时还不是一个值

提前感谢您提供任何可能有帮助的解决方案或想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:37:48.160

这正是问题所在。您不能仅使用 ORM 进行复杂的计算。但是，您也许可以利用`__year`查找来简化数学运算：

```
Exemple.objects.filter(date_field__year__lt=F('year_field')) 
```

但是，任何比这更复杂的东西，您都必须使用`extra`.

# wpf - 如果用户尝试通过键盘或鼠标选中/取消选中复选框，如何采取行动？

> ID：10935266
> 
> 赞同：2
> 
> 时间：2012-06-07T15:46:41.053
> 
> 标签：wpf, mvvm, checkbox

我正在编写一个应用程序（WPF MVVM），每当用户尝试检查/取消选中某些复选框（以及其他控件，但我将专注于这篇文章的复选框）时，我都需要提示用户。我需要他通过 MessageBox 确认他是否要继续由复选框启动的操作，我已经在 PreviewMouseLeftButtonDown 事件中提出了 MessageBox 问题，但刚才有人告诉我：如果他们使用键盘选中/取消选中会怎样？

是否有一个模拟键盘事件可以连接到我已经拥有的 PreviewMouseLeftButtonDown 事件代码，以便在他们选中/取消选中复选框时显示提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:57:29.107

鉴于您使用的是 MVVM，我建议您在 ViewModel (VM) 类中处理此问题。

*   将 CheckBox 控件上的 IsChecked 属性绑定到 VM 上的属性。

*   在 VM 中，设置验证检查值的逻辑。您不会希望直接从 VM 打开消息框（这会将 VM 直接绑定到可视化服务）。我建议创建一个查询服务（作为 C# 接口）并使用显示 MessageBox 的代码来实现它。将服务传递给 VM 的构造函数，或者让 VM 通过容器（依赖注入或全局服务容器）获取服务。

*   如果查询失败，请不要更改 VM 中的值。视图中的 CheckBox 将保持其先前的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T18:34:06.483

控件上有一个 PreviewKeyDown/KeyUp 事件，您可以将其附加`ICommand`到（对于 MVVM 样式）或在事件后面连接代码（对于非 MVVM）。

然后该事件可以显示消息框，如果需要，您可以使用以下方法取消操作：

```
if(e.Key == Key.Space)
{
    //TODO: processing for message box
    e.Handled = True
} 
```

以上将事件链标记为已处理，因此管道中的其他事件不会被执行。

请注意，`Key.Space`如果要捕获所有内容，可以将其替换为您可能想要捕获或删除的任何内容。

# windows - 来自另一个线程的套接字关闭调用是否总是使阻塞的 recv() 线程唤醒？

> ID：10935267
> 
> 赞同：3
> 
> 时间：2012-06-07T15:46:48.853
> 
> 标签：windows, linux, sockets, freebsd

我找不到太多文档来说明这是否应该发生：

1.  某个线程打开一个 TCP（或其他流）套接字
2.  线程 1 启动一个阻塞的 recv()
3.  线程 2 使用 SHUT_RDWR（或我认为是 SHUT_RD）在套接字上调用 shutdown()
4.  线程 1 现在从其阻塞调用中“唤醒”，并返回零，就像另一方关闭其套接字一样。

这种行为出现在现代 Linux 和 FreeBSD 系统上。我没有和其他人一起测试过。

此处对 Microsoft MSDN 帮助页面的评论：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms740481%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740481%28v=vs.85%29.aspx)表明这种行为在视窗; 它还指出“目前不是这种情况”，但这可能已经过时了。

这种行为是否在任何地方指定？我可以依靠它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T22:36:23.530

我不认为你可以依赖它。shutdown() 初始化套接字关闭，但细节取决于特定情况。某些协议可能确实会立即关闭连接和套接字，这会唤醒在该套接字上休眠的进程。在其他情况下，关闭只是启动协议状态机，但它需要一些时间才能达到唤醒任何人有意义的地步。例如，已建立的 TCP 连接必须经过几个状态转换，直到达到 CLOSED 状态。你最终会醒来，但你不能指望它马上发生。

# javascript - Javascript 到动作脚本

> ID：10935275
> 
> 赞同：2
> 
> 时间：2012-06-07T15:47:15.410
> 
> 标签：javascript, actionscript-3, flex4

我正在尝试将一些预先存在的 html/JavaScript 文件转换为 Flex。我尝试进行一些研究，看看是否有任何编译器可以将代码从 javascript 编译为 actionscript。据我所知，有很多方法可以将 actionscript 转换为 javascript，但我找不到任何相反的方法。有谁知道是否有办法做到这一点，还是我应该编写自己的工具？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T18:08:02.187

我想你会发现这行不通，因为 AS3 是一种严格类型的语言，而 Javascript 不是。即使存在这样的编译器，您的 ActionScript 也可能会因为它会创建一堆通用对象而遇到问题。

简而言之：ActionScript to Javascript 是可行的，因为 Javascript 更宽松，但丢失了很多结构。继承、类型等

但反过来说，没有办法重新添加到 ActionScript 所需的结构中。

正如其中一位评论者所提到的，您可能需要手动进行此转换。

另一个想法：Flash 播放器可以与 Javascript 对话。可能不需要将 Javascript 转换为 ActionScript，而只需创建一些函数来通过其 ExternalInterface 类与 Flash SWF 文件对话。只需将 Javascript 保留在 Javascript 中即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T07:30:53.523

我强烈建议完全重写，因为它们（JS 和 AS）都是 ECMA 标准语言（如果我错了，请纠正我）

但是，如果您***真的***需要一种自动化的方式，请尝试：

1.  [将您的 JS 转换为 haxe](https://groups.google.com/forum/#!topic/Haxelang/tihDuJImM4g)
2.  将输出 Haxe 编译为 AS

这是我认为最简单的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T20:55:28.557

你最好编写自己的工具。编写 javascript 的方法有很多种，包括它是无类型的，因此很难编写一个可以转换所有内容的万能的解决方案。如果它是一个库，那么转换操作码而不是代码到代码可能更有意义，但这在很大程度上取决于 javascript 的编写方式。

这会很痛苦，这是肯定的。

*   js 是无类型的，actionscript 是“类型的”。我想一切都可能是一个对象，它会运作良好
*   js 函数作用域的处理方式不同。
*   actionscript 中的匿名函数调用通常不受欢迎，并且会损害性能
*   actionscript 中的 setTimeOut 之类的东西也很不受欢迎，enter_frame 和 timer 可能更有用
*   actionscript 中的垃圾收集处理方式略有不同——事件分派也是如此

# c# - .退出事件问题

> ID：10935281
> 
> 赞同：0
> 
> 时间：2012-06-07T15:47:49.060
> 
> 标签：c#, process

`.Exited`不适用于所有情况，例如：当我关闭显示图像的`C:\foo.png`负责应用程序时，我没有得到`MessageBox.Show("exited!");`

这是我的代码：

```
 public static void TryOpenFile(string filename)
                {
                        Process proc = new Process();
                        proc.StartInfo = new ProcessStartInfo(filename);
                        proc.EnableRaisingEvents = true;
                        proc.Exited += (a,b) => { MessageBox.Show("Exited!"); }
                        proc.Start();
                    } 
```

我如何调用函数`TryOpenFile(@"C:\foo.png");`。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T15:55:50.450

您是否可能已经打开了图像编辑程序？当您调用 proc.Start() 时，如果进程已经在运行，则重用现有进程。您应该检查 proc.Start() 的返回值，看看是否是这种情况。

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa326949(v=vs.71).aspx)：

> **返回值**
> 
> **如果进程资源已启动，则为**true ；**如果没有启动新的进程资源（例如，如果重用现有进程），则为 false。**
> 
>  **...
> 
> **评论**
> 
> ...
> 
> 如果 StartInfo 属性的 FileName 成员指定的进程资源已在计算机上运行，​​则不会启动其他进程资源。而是重用正在运行的进程资源并返回**false**。**

# macos - 第一次使用 SVN

> ID：10935288
> 
> 赞同：1
> 
> 时间：2012-06-07T15:48:09.077
> 
> 标签：macos, svn

不知道我应该在这里问还是服务器故障。

无论如何，我最近在一个安装了 SVN 的新工作中开始了一个项目。即使我通过一些 keygen 获得了 SSH 访问权限，我也没有使用它。但是现在我已经为初学者做了一些在线阅读，并且在通过 SSH 输入命令后，我很难通过“which svn”。我想这会告诉我存储库的路径（即 /usr/bin/svn），但我什至不知道如何到达该目录（我在 Mac OS X 上使用终端）。

所有这一切让我觉得自己很愚蠢，因为我以前从来没有真正需要使用终端来做 Web 项目，这是我通过 SSH 使用 SVN 的第一次体验（见鬼，甚至是第一次使用 SSH）。

我已经在谷歌上搜索和阅读了一个周末，但我认为这里的某个人可能很清楚在哪里可以找到文件或检查哪些文件在 SVN 下等。我认为我的主要问题是找出如何使用终端“获取”到我要处理的文件夹。

我确实阅读了检查文件是否在 SVN 下、签出、更新、提交等命令。我只想知道如何访问这些文件来执行此操作。抱歉这个菜鸟问题，提前感谢

如果有人解释了 SSH 的好处，可以加分（我完全理解 SVN 的好处，并且很想正确地学习它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:03:19.627

使用颠覆客户端可能会更好。OS X 上最受欢迎的两个是[http://versionsapp.com](http://versionsapp.com)和[http://zennaware.com/cornerstone/index.php](http://zennaware.com/cornerstone/index.php)（最近我的开发者朋友似乎更喜欢基石。）

这些应该让您完成所有（或几乎所有）SVN 功能，但使用 GUI。您仍然需要学习术语。看看[http://svnbook.red-bean.com/en/1.6/svn.basic.html](http://svnbook.red-bean.com/en/1.6/svn.basic.html)

您需要 SVN+SSH，因为它更安全，但这并不意味着您必须使用命令行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T15:55:27.540

`/usr/bin`好吧，即使`svn`住在那里，也没有必要去。`/usr/bin`是系统尝试解析文件位置时自动包含的标准位置。您应该可以开始使用 SVN 命令，例如：

```
svn checkout ... 
```

使用 SVN 和 SSH 的好处是完全不同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:47:31.677

`svn list --verbose http://host_name/svn_dir`将为您提供当前版本化项目的列表（包括修订号和修改日期）

`svn checkout http://host_name/svn_dir/repository_name projectx`将签出 repo（在本地机器上创建工作副本）

我会推荐[这里](http://svnbook.red-bean.com/)的手册，即使您一开始没有阅读它，只是在需要时将其用作您的第一个参考点。

# c# - 使用扩展方法将对象属性映射到键表示路径的字典的最有效方法

> ID：10935291
> 
> 赞同：1
> 
> 时间：2012-06-07T15:48:14.203
> 
> 标签：c#, reflection

扩展方法将对象属性映射到 IDictionary 的最有效方法是什么：

*   键是属性路径（例如“Customer.Company.Address.Line1”）
*   values 是属性值的字符串表示形式（例如“123 Main St.”或“”（空字符串），当为 null 或默认值时）
*   属性集合仍然只包含路径（例如公共 IList Invoices --> "Customer.Invoices" 但值是集合计数）

使用反射是最好的方法吗？有例子吗？

谢谢Z...

## 澄清更新

*   字典键应该是基于属性名称而不是类型层次结构的路径。因此，如果客户有属性`public Company ParentCompany`而公司有属性，`public Address BillingAddress`那么键路径应该是“ParentCompany.BillingAddress”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:21:56.653

**编辑：**

```
public static IDictionary<string, string> GetProperties<T>(this T obj)
    where T : class
{
    var properties = obj.GetPropertyList();
    return properties.ToDictionary(prop => prop.Item1, prop => prop.Item2);
}

public static IEnumerable<Tuple<string, string>> GetPropertyList<T>(this T obj)
    where T : class
{
    if (obj == null)
        throw new ArgumentNullException("obj");

    Type t = obj.GetType();

    return GetProperties(obj, t, t.Name);
}

private static IEnumerable<Tuple<string, string>> GetProperties(object obj, Type objType, string propertyPath)
{
    // If atomic property, return property value with path to property
    if (objType.IsValueType || objType.Equals(typeof(string)))
        return Enumerable.Repeat(Tuple.Create(propertyPath, obj.ToString()), 1);

    else
    {
        // Return empty value for null values
        if (obj == null)
            return Enumerable.Repeat(Tuple.Create(propertyPath, string.Empty), 1);

        else
        {
            // Recursively examine properties; add properties to property path
            return from prop in objType.GetProperties()
                   where prop.CanRead && !prop.GetIndexParameters().Any()
                   let propValue = prop.GetValue(obj, null)
                   let propType = prop.PropertyType
                   from nameValPair in GetProperties(propValue, propType, string.Format("{0}.{1}", propertyPath, prop.Name))
                   select nameValPair;
        }
    }
} 
```

这仍然不能处理值参数的默认值。请注意，何时停止递归迭代的逻辑是关键。最初我停留在值类型的属性上，但这意味着字符串被视为其他对象。所以我添加了一个特殊情况来将字符串视为原子类型。

# ruby-on-rails - Carrierwave、Fog 和 URL 重写

> ID：10935297
> 
> 赞同：1
> 
> 时间：2012-06-07T15:48:44.470
> 
> 标签：ruby-on-rails, amazon-s3, carrierwave, fog

我使用 Fog 和 Carrierwave 将图像存储在 Amazon S3 中。它返回一个像`bucket.s3.amazonaws.com/my_image.jpg.`

DNS 条目已设置为`images.mysite.com`指向`bucket.s3.amazonaws.com.`

我想调整我的视图 API 以使用`images.mysite.com/my_image.jpg`URL。然而，Carrierwave 只推出了基于亚马逊的产品。有没有一种简单的方法可以告诉 Carrierwave 和/或 Fog 为其 URL 使用不同的主机？如果没有，我将如何修改上传器以将其吐出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T19:14:46.353

来发现，截至 2012 年 6 月 6 日，Amazon AWS 不支持自定义 SSL 证书，这使得这成为一个争论点。

# sql-server-2008 - 用户 sa 的 sqlcmd 登录失败

> ID：10935298
> 
> 赞同：1
> 
> 时间：2012-06-07T15:48:47.783
> 
> 标签：sql-server-2008, ssms, sa

我正在尝试运行此命令

```
sqlcmd -U "sa" -P "mypassword" -S (local)\SQLEXPRESS -Q "ALTER DATABASE mydatabase SET SINGLE_USER WITH ROLLBACK IMMEDIATE" 
```

来自 .bat 文件，但因错误而失败

```
"Login failed for user 'sa' 
```

我已经转到SSMS中安全选项卡下的登录选项卡，并将sa帐户的密码更改为.bat文件中的密码，但仍然出现此错误。

我尝试使用这些凭据和 SQL Server 身份验证使用 sa 帐户登录 SSMS，但我得到了同样的错误。我已经停止并启动了 SQL Server 服务，但没有任何效果。

知道我必须做什么吗？

# c - 指针魔术：具有指针成员等的结构

> ID：10935300
> 
> 赞同：-2
> 
> 时间：2012-06-07T15:48:56.157
> 
> 标签：c, pointers, struct

我真的不知道如何给这个问题起一个好的标题——对不起。

只是想知道这一切的目标是什么：将一个 uint8_t 变量指针传递给 bar() ，它确实将它设置为 1 或 0，我可以检查它在我的 main 中的状态。我确实需要 zbar()，它是一个线程，它实际上将值设置为 1 或 0

所以我有一个地方：

```
struct foo_t {
    ...
    uint8_t *state;
}; 
```

我主要选择：

```
int main(void) {
     uint8_t state = 0;
     bar(&state);

     while(1) {
          if(state)
              //do something here
     }
} 
```

在这里，我们在另一个源文件中有其他地方。

```
void bar(uint8_t *state) {
    struct foo_t *foo;    //using malloc here - don't worry

    foo->state = state;

    zbar(foo); 
```

}

```
void zbar(struct foo_t *arg) {
    if(condition)
       arg->state = 1;
    else
       arg->state = 0;
 } 
```

如何使这个工作？o0 zBar 实际上可以访问 arg 结构，这根本不是问题。

请不要担心为什么我这样做很奇怪，它是在线程等中使用的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:53:54.570

`bar()`需要通过指针获取其参数。另外，如果要检查 中的状态`main`，则需要`bool`在调用后更改指向`zBar`

```
void bar(uint8_t* state) {
  struct foo_t *foo; //using malloc here - don't worry
  foo->state = *state;
  zbar(foo);
  *state = foo->state;
} 
```

您在`main`( `bar(&state);`)中正确调用它

请注意，此代码现在的方式，一旦`zbar`被调用，`state`将永远不会再改变。如果您希望线程访问（和修改）状态，则需要将地址存储在`struct foo`：

```
struct foo
{
  // ...
  uint8_t* state;
}; 
```

并改变`bar`：

```
void bar(uint8_t* state) {
  struct foo_t *foo; //using malloc here - don't worry
  foo->state = state; // no dereferencing
  // zbar(foo);  // start the thread using zbar
}

void zbar(struct foo_t *arg) {
  if(condition)
    *(arg->state) = 1;
  else
    *(arg->state) = 0;
} 
```

然后任何更改也将`*(foo->state)`更改`state``main`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:59:26.617

我猜你的意思是`void bar(uint8_t* state)`？

它不符合我认为你的意图。我再次假设您希望更改`state`变量？`main`如果是这样试试

```
struct foo_t {
    uint8_t* state; // changed this to a pointer type.
}

void bar(uint8_t* state) {
    struct foo_t *foo = blah blah;
    foo->state = state;
    zbar(foo);
}

void zbar(foo_t* arg) {
   if (condition)
       *(arg->state) = 1;
   else
       *(arg->state) = 0;
} 
```

我*认为*这就是你想要做的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T16:11:14.130

我*觉得*你说的是：

*   线程 1 运行`main`，并且有一个局部变量`uint8_t state`
    *   它将在一个循环中检查这个局部变量的值，期望它可能被异步更新`zbar`
*   线程 2 运行（除其他外）`zbar`
    *   当`zbar`更改 的值时`arg->state`，您希望`main`在线程 1 中查看新值

因此，首先，您需要确保`arg->state`和`main`的局部`state`变量实际上引用了内存中的同一位置。由于`bar`已经 allocates `foo_t arg`，因此共享副本可能更容易：

```
int main(void) {
    foo_t *arg = bar();

    while(1) {
        if(arg->state)
            ; //do something here
    }
} 
```

其次，您需要确保`main`实际*看到*该位置的新值：正如**事实上**所说，有几件事可能会阻止这种情况发生。*最明显的是，在第一次*调用 之后不需要`main`重新加载 的值，因为它看不到任何可能改变它的东西。*`state``bar`*

 *这些东西本质上是不可移植的；告诉我们平台，我们将能够提供更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T15:54:29.453

不，这行不通。首先，它不会编译 --`foo_t`的`state`成员被定义为 a`uint8_t`但您正试图将 a 存储`uint8_t *`在其中。如果你通过`bar`说类似的东西来解决这个问题`foo->state = *state`，那么它仍然无法工作，因为虽然`bar`正在传递一个指向`main`的`state`变量的指针，但它所做的只是取消引用它一次并将结果放入一个结构中。

您可以声明`foo_t`拥有一个`uint8_t *`成员，`&state`从`main`into传递`bar`并将其存储在`foo_t`. 或者（如果您的代码结构允许）完全忘记`foo_t`，只需将指针传递给`state`from `main`to `bar`to `zbar`。也就是说，其中之一：

```
struct foo_t { ...; uint8_t * state; ... };
void bar(uint8_t * state) { struct foo_t * foo; ...; foo->state = state; zbar(foo); ... }
void zbar(struct foo_t * arg) { ...; *(arg->state) = 1; ... } 
```

[编辑添加：在这种情况下，您还需要声明`state`volatile in `main`，以警告编译器另一个线程可能会修改其值。]

或者

```
void bar(uint8_t * state) { ...; zbar(state); ... }
void zbar(uint8_t * state) { ...; *state = 1; ... } 
```

另一种说法。“它在线程等中使用。” 做一些奇怪或丑陋的事情并不是一个很好的理由。如果你用线程做的*特定事情**需要*它，当然这是另一回事，当然你没有义务在这里捍卫你的设计决策——我只是想提醒你不要看到“这里是线程”作为做奇怪事情的*一般许可。**

# ruby - Eloquent Ruby - 保存代码块以执行后面的示例

> ID：10935301
> 
> 赞同：0
> 
> 时间：2012-06-07T15:48:56.533
> 
> 标签：ruby, block

在 Eloquent Ruby 中有一个我不明白的代码示例。

```
class Document
  attr_accessor :save_listener

  # most of the class omitted...

  def on_save( &block )
    @save_listener = block
  end

  def save( path )
    File.open( path, 'w' ) { |f| f.print( @contents ) }
    @save_listener.call( self, path ) if @save_listener
  end
end

# usage
my_doc = Document.new( 'block based example', 'russ', '' )
my_doc.on_save do |doc|
  puts "Hey, I've been saved!"
end 
```

为什么`@save_listener.call( self, path )`需要两个参数？保存的块看起来只有一个参数`|doc|`。这是书中的错字还是我在这里遗漏了什么？

我什至尝试输入这段代码并执行它，我发现我可以添加任意数量的参数并且不会出现任何错误。但是我仍然不明白为什么这个例子中有两个参数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T16:47:39.023

这是由于 和 之间的细微`Proc`差别`Lambda`。当您`Proc`使用代码块创建一个新的时，您可以在调用它时传递任意数量的参数。例如：

```
proc = Proc.new {|a,b| a + b}
proc.arity #=> 2 -- the number of arguments the Proc expects
proc.call(4,8) #=> 12
proc.call(4,8,15,16,23,42) #=> 12 
```

它正在接受这些参数，但只是不将它们分配给块中的任何变量。

但是，a`Lambda`关心参数的数量。

```
proc = lambda {|a,b| a + b}
proc.arity #=> 2
proc.call(4,8) #=> 12
proc.call(4,8,15,16,23,42) #=> ArgumentError: wrong number of arguments (6 for 2) 
```

这样做的原因是因为`Proc.call`分配方法的参数类似于变量的并行分配。

```
num1, num2 = 1,2 #=> num1 is 1, num2 is 2
num1, num2 = 1  #=> num1 is 1, num2 is nil
num1, num2 = 1,2,3,4,5 #=> num1 is 1, num2 is 2 and the rest are discarded 
```

但是，`Lambda`不能这样工作。`Lambda`与其说是变量赋值，不如说更像是一个方法调用。

因此，如果您担心只允许一定数量的参数，请使用`Lambda`. 但是，在此示例中，由于您有可能向块添加路径，`Proc`因此最好使用 a。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:53:30.207

在该示例中它看起来没用，但是您可以将任意数量的参数传递给块，它们将被忽略。在这种情况下，您也可以不带参数调用它。

# javascript - 如何使用 Map/Reduce 和 MongoDB 按链接的文档属性进行分组

> ID：10935303
> 
> 赞同：0
> 
> 时间：2012-06-07T15:49:05.300
> 
> 标签：javascript, mongodb, mapreduce

我试图找出一种使用 MongoDB 和 Map/Reduce 按人口统计对用户站点访问进行分组的好方法。我有以下收藏：

实地考察 - 示例：

```
{
    userId: '184792',
    resource: '/example/foo',
    visitTime: ISODate(...)
} 
```

用户配置文件 - 示例：

```
{
    userId: '184792',
    demo: '18-30',
    city: 'Austin',
    state: 'TX',
    ...
} 
```

我想生成一份报告，显示每天或每月按人口统计的网站访问次数。但是，如果我对站点访问进行 Map/Reduce，我只能访问 userId，而不是人口统计信息，因此我无法根据人口统计信息发出密钥。事实上，如果我想按任何用户属性（例如 State）进行分组，那也是不可能的。

有谁知道在 MongoDB 中解决这个问题的最佳实践方法是什么？我应该复制每个站点访问文档中的所有用户属性吗？我应该在应用程序代码中进行某种类型的重新减少，我可以在其中使用多个查询加入集合吗？还是我只是使用错误的工具来解决此类问题？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:29:41.933

这里有三个解决方案：

1.  将人口统计数据非规范化到站点访问中。
2.  做一个“客户端”的 Map/Reduce。即：编写一个循环访问访问的脚本，加载适当的用户配置文件，然后更新摘要集合。
3.  为此保留实时计数器。

> 有谁知道在 MongoDB 中解决这个问题的最佳实践方法是什么？

对于 MongoDB，答案通常是*“取决于”*。在这种情况下，确实如此。

需要考虑的一些问题：

*   您是否已经在每次访问时查找个人资料数据？
*   您想要“实时”数据吗？
*   您是否提前知道所有预期的汇总？
*   您想存储所有交易数据还是只关心汇总？

**通常，这里的解决方案是#1 和#3 的组合。**

如果您想要交易数据和“灵活”的报告，那么您需要在每次访问时保留配置文件数据。

如果您提前知道您的主要报告，那么我建议使用某种形式的计数器并在您编写交易的同时写入这些。因此，您基本上可以即时构建您的报告数据集。是的，它的写入次数更多，但 MongoDB 更喜欢这种进行大量写入的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:41:48.293

实际上，您可以使用`reduce`output 选项将两个 map reduce 结果合并在一起。

> { reduce : "collectionName" } - 如果结果集中和旧集合中的给定键存在文档，则将对这两个值执行归约操作（使用指定的归约函数）并将结果写入输出集合。如果提供了 finalize 函数，这也将在 reduce 之后运行。

您需要将两个集合映射到一种通用格式，以便您可以对每个源映射文档中的一个文档执行此缩减步骤，并合并每个集合中的相应字段。

有关示例，请参阅[此博客条目。](http://tebros.com/2011/07/using-mongodb-mapreduce-to-join-2-collections/)

# c# - 如何访问当前系统音频声音以查看实际音量？

> ID：10935311
> 
> 赞同：1
> 
> 时间：2012-06-07T15:49:31.820
> 
> 标签：c#, audio, volume

我需要获得在 Windows 7 系统上播放的**实际**音频级别，就像 Skype 在设置中那样：

[![Skype 设置](../Images/84f3e5bac621c2d0ad7a816c0ae5e710.png)](https://i.stack.imgur.com/cJPFk.png)

**我对此一无所知，这里的任何人都可以帮助我吗？**

我想做的是，我想编写一个简单的工具，如果窗户上的声音太小，它会调高最大音量，如果声音太大，它会调低音量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:52:02.267

你可以试试这个链接：

[http://www.dreamincode.net/forums/topic/45693-controlling-sound-volume-in-c%23/](http://www.dreamincode.net/forums/topic/45693-controlling-sound-volume-in-c%23/)

基本上，你需要导入这个win32 api函数：

```
[DllImport("winmm.dll")]
public static extern int waveOutGetVolume(IntPtr hwo, out uint dwVolume); 
```

那么你可以像这样使用它：

```
waveOutGetVolume(IntPtr.Zero, out CurrVol); 
```

你会得到'CurrVol'的音量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T16:38:33.177

下载 NAudio 类并在 C# 项目中引用 DLL。

然后将以下代码添加到您的项目中。它将枚举所有音频设备获取其音量并尝试将其静音。

```
 try
        {
            //Instantiate an Enumerator to find audio devices
            NAudio.CoreAudioApi.MMDeviceEnumerator MMDE = new NAudio.CoreAudioApi.MMDeviceEnumerator();
            //Get all the devices, no matter what condition or status
            NAudio.CoreAudioApi.MMDeviceCollection DevCol = MMDE.EnumerateAudioEndPoints(NAudio.CoreAudioApi.DataFlow.All, NAudio.CoreAudioApi.DeviceState.All);
            //Loop through all devices
            foreach (NAudio.CoreAudioApi.MMDevice dev in DevCol)
            {
                try
                {
                    //Get its audio volume
                    System.Diagnostics.Debug.Print("Volume of " + dev.FriendlyName + " is " + dev.AudioEndpointVolume.MasterVolumeLevel.ToString());

                    //Mute it
                    dev.AudioEndpointVolume.Mute = true;
                    System.Diagnostics.Debug.Print(dev.FriendlyName + " is muted");

                    //Get its audio volume
                    System.Diagnostics.Debug.Print(dev.AudioEndpointVolume.MasterVolumeLevel.ToString());
                }
                catch (Exception ex)
                {
                    //Do something with exception when an audio endpoint could not be muted
                    System.Diagnostics.Debug.Print(dev.FriendlyName + " could not be muted");
                }
            }
        }
        catch (Exception ex)
        {
            //When something happend that prevent us to iterate through the devices
            System.Diagnostics.Debug.Print("Could not enumerate devices due to an excepion: " + ex.Message);
        } 
```

# vb.net - 使用 Activator.CreateInstance 的重做方法

> ID：10935315
> 
> 赞同：0
> 
> 时间：2012-06-07T15:49:39.190
> 
> 标签：vb.net

我怎么能用 Activator.CreateInstance 重做这个方法

```
 Public Overridable Function setCreditType() As CreditType 
    Select Case creditTypeId 
        Case Is = 0 
            Return New NewCredit(Me) 
        Case Is = 1 
            Return New ExecutiveProducer(Me) 
        Case Is = 2 
            Return New Producer(Me) 
        Case Else 
            Return New NullCredit(Me) 
    End Select 
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:42:40.900

最直接的回应是这样的：

```
Dim t As Type = GetType(Foo) 'Get Foo from somewhere
Dim ctorArgs() New As Object { Me }
Return (CreditType)Activator.CreateInstance(t, ctorArgs) 
```

# javascript - Facebook 应用程序非常慢

> ID：10935318
> 
> 赞同：-4
> 
> 时间：2012-06-07T15:49:54.530
> 
> 标签：javascript, facebook-graph-api

我已经使用 facebook API 开发了 facebook 应用程序，我在页面顶部包含了 facebook api，它正在为所有页面加载，因为我在所有页面中都使用了 api，我不知道这是否是我的问题申请需要时间，

任何人都可以建议我如何解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T19:30:43.693

由于您的标签显示 Javascript，我假设您正在使用 Graph API 周围的 Javascript SDK。请参阅： http: [//developers.facebook.com/docs/reference/javascript/](http://developers.facebook.com/docs/reference/javascript/) ，因为它讨论了未正确指定频道 url html 文件将如何使 JS SDK 运行非常缓慢。

这是它的重要部分：

> **频道文件**
> 
> 频道文件解决了某些浏览器中跨域通信的一些问题。channel.html 文件的内容可以只有一行：
> 
> ```
>  <script src="//connect.facebook.net/en_US/all.js"></script> 
> ```
> 
> 尽可能长时间地缓存通道文件很重要。提供此文件时，您必须发送具有较长有效期的有效 Expires 标头。这将确保频道文件被浏览器缓存，这对于流畅的用户体验很重要。如果没有适当的缓存，跨域通信将变得非常缓慢，用户体验将严重下降。在 PHP 中执行此操作的一种简单方法是：
> 
> ```
>  <?php
>  $cache_expire = 60*60*24*365;
>  header("Pragma: public");
>  header("Cache-Control: max-age=".$cache_expire);
>  header('Expires: ' . gmdate('D, d M Y H:i:s', time()+$cache_expire) . ' GMT');
>  ?>
>  <script src="//connect.facebook.net/en_US/all.js"></script> 
> ```
> 
> channelUrl 参数是可选的，但建议使用。提供通道文件可以帮助解决三个特定的已知问题。首先，包含跨框架通信的代码的页面可能会导致社交插件在没有 channelUrl 的情况下显示为空白。其次，如果没有提供 channelUrl 并且页面包含自动播放的音频或视频，则用户可能会听到两个音频流，因为该页面已在后台第二次加载以进行跨域通信。第三，通道文件将防止在您的服务器端日志中包含额外的命中。如果您不指定 channelUrl，您可以从日志中删除包含 fb_xd_bust 或 fb_xd_fragment 参数的页面查看，以确保正确计数。
> 
> channelUrl 必须是与包含 SDK 的页面匹配的完全限定 URL。换句话说，如果您的站点使用 www 提供服务，则频道文件域必须包含 www，并且如果您修改页面上的 document.domain，您也必须在 channel.html 文件中进行相同的 document.domain 更改。协议也必须匹配。如果您的页面是通过 https 提供的，那么您的 channelUrl 也必须是 https。记住也要为脚本 src 使用匹配协议。上面的示例代码使用了应该正确处理大多数 https 情况的协议相关 URL。

# php - php通过珍珠邮件发送大量电子邮件 - 查看队列中发送的消息/消息

> ID：10935326
> 
> 赞同：0
> 
> 时间：2012-06-07T15:50:15.747
> 
> 标签：php, email, swiftmailer, mailman, mail-queue

我使用 mail.php 函数在 php 中设置了群发电子邮件。

我已经阅读了“使用 PHP 发送大量电子邮件”的帖子，这很有帮助，但不想在新帖子上打开对话。我希望能够从我的前端 php 群发电子邮件页面查看队列中的消息或过去发送的消息。

关注点：

*   查看已发送消息的能力
*   能够取消队列中的消息发送

哪个是最好的系统？

*   斯威夫特梅勒
*   梨mail_queue
*   邮递员

将不胜感激一些建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T15:55:25.667

这是您的代码的问题，而不是概念的问题。您的代码应该在尝试发送电子邮件之前验证电子邮件，如果它无效则跳过它，然后继续循环，这意味着您的群发邮件不会因无效电子邮件而冻结。

# perl - 使用 WWW::Selenium 上传文件

> ID：10935327
> 
> 赞同：0
> 
> 时间：2012-06-07T15:50:16.527
> 
> 标签：perl, selenium, upload, automation

有人可以告诉我如何使用网站中的上传按钮上传文件吗？

**上传按钮的 HTML 源代码**

```
<div id="upload-import-link" class="qq-upload-button string-file-import" style="position: relative; overflow: hidden; direction: ltr;">
<input type="file" multiple="multiple" name="file" style="position: absolute; right: 0pt; top: 0pt; font-family: Arial; font-size: 118px; margin: 0pt; padding: 0pt; cursor: pointer; opacity: 0;"> 
```

这是上传按钮的行为。
当我单击“上传”按钮时，会打开弹出窗口以选择文件。
一旦我选择了文件，它就会被上传。
如何自动化此行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:37:43.557

根据标签和语言选择（perl），我假设您使用的是 Selenium 1 RC - Perl

如果是这种情况，您可以这样做

```
$sel->type_ok("upload-import-link", "\/home\/yourname\/Desktop\/filename.doc",'User enters the file path of the document to be uploaded');
$sel->click_ok("submit","user clicks on upload\/submit button"); 
```

# iphone - 如何在应用程序中引用每个 UILabel

> ID：10935329
> 
> 赞同：4
> 
> 时间：2012-06-07T15:50:23.967
> 
> 标签：iphone, objective-c, ios

我想`UILabel`在我的应用程序的每个视图中更改每个视图的字体，而不需要对每一个（大约 50 个）进行编码。我该怎么做呢？

具体来说，我想知道如何引用 all `UILabels`。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T15:51:51.950

这可以通过新的 iOS 5 外观 API 轻松处理。Appearance API 允许您在整个应用程序中更改控件的外观。

看看我下面的截图： [http ://www.youtube.com/watch?v=L63CU2T7DBE&list=UUKvDySsrOVgUgRLhWHeyHJA&index=4&feature=plcp](http://www.youtube.com/watch?v=L63CU2T7DBE&list=UUKvDySsrOVgUgRLhWHeyHJA&index=4&feature=plcp)

这可能有效：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [[UILabel appearance] setFont:[UIFont fontWithName:@"Marker Felt" size:56]];

    [[UILabel appearanceWhenContainedIn:[UIButton class], nil] setFont:[UIFont fontWithName:@"Marker Felt" size:10]];

    [[UINavigationBar appearance] setTintColor:[UIColor blueColor]];

    return YES;
} 
```

# android - 如何根据单击的列表项更改将哪些图像加载到 ViewPager

> ID：10935331
> 
> 赞同：1
> 
> 时间：2012-06-07T15:50:43.807
> 
> 标签：android, android-listview, android-viewpager

我在可绘制文件夹中有多个图像，但我只希望根据之前 ListView 活动中单击的项目加载某些图像。所以我正在尝试学习如何延迟加载图像而不是将它们硬编码到我的 xml 文件中。我是一个新手，并试图自学来自 ios 开发背景的 android。提前感谢您的帮助。
私有类 MyPagerAdapter 扩展 PagerAdapter {

```
 public int getCount(){
        return 3;
    }

    public Object instantiateItem(View collection, int position){
        LayoutInflater inflater = (LayoutInflater)collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        ImageView iv1 = (ImageView) findViewById(R.id.imageView1);
        ImageView iv2 = (ImageView) findViewById(R.id.imageView2);
        ImageView iv3 = (ImageView) findViewById(R.id.imageView3);

        int resId = 0;
        switch(position){
        case 0:
            iv1.setImageResource(R.drawable.amersenna);
            resId = R.layout.left;
            break;
        case 1:
            iv2.setImageResource(R.drawable.amersenna);
            resId = R.layout.middle;
            break;
        case 2:
            iv3.setImageResource(R.drawable.amersenna);
            resId = R.layout.right;
            break;
        }

        View view = inflater.inflate(resId, null);

        ((ViewPager) collection).addView(view, 0);

        return view;
    }

    @Override
    public void destroyItem(View agr0, int agr1, Object agr2) {
        ((ViewPager) agr0).removeView((View)agr2);
    }

    @Override
    public boolean isViewFromObject(View agr0, Object agr1){
        return agr0 == ((View)agr1);
    }

    @Override 
    public Parcelable saveState(){
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T10:02:59.797

您可以使用类中的`setTag(Object)`和`getTag()`方法`View`。为每个 ImageView 添加一个 ArrayList 对象。因此，当单击特定的 ImageView 时，您可以使用“getTag()”获取附加的 ArrayList 对象。通过这种方式，您将能够根据需要在单击特定列表项时加载不同的图像。

# java - java.lang.IllegalArgumentException：文档库 tomcat\webapps\appdata 不存在或不是可读目录

> ID：10935334
> 
> 赞同：4
> 
> 时间：2012-06-07T15:50:49.920
> 
> 标签：java, tomcat, war

我之前在本地 Tomcat (6.0.35) 实例上部署了一个 WAR，名为`appdata.war`​​，因此 webapps 目录如下所示：

```
webapps/
    docs/
    examples/
    host-manager/
    manager/
    appdata/ (exploded WAR)
    ROOT/
    appdata.war 
```

我删除了`appdata/`and `appdata.war`（这样 Tomcat 就不会尝试重新部署它），然后`appmon-qa.war`在这个目录中添加了一个新的 war ( )。然后我运行 Tomcat 启动脚本并看到引用“旧” `appdata`WAR 的部署错误。我四处寻找，看到一个具有该名称的文件夹，`${TOMCAT.HOME}/work/Catalina/localhost/appdata`然后我将其删除（再次，只是为了防止 Tomcat 重新部署它）。然后我重新运行了启动脚本，并在 catalina 日志中看到了这一点：

```
SEVERE: Error starting static Resources
java.lang.IllegalArgumentException: Document base C:\Program Files\Apache\apache-tomcat-6.0.35\webapps\appdata does not exist or is not a readable directory
    at org.apache.naming.resources.FileDirContext.setDocBase(FileDirContext.java:        
    at org.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:4320)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4489)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    ...rest of stacktrace omitted for brevity
Jun 7, 2012 11:35:27 AM org.apache.catalina.core.StandardContext start
SEVERE: Error in resourceStart()
Jun 7, 2012 11:35:27 AM org.apache.catalina.core.StandardContext start
SEVERE: Error getConfigured
Jun 7, 2012 11:35:27 AM org.apache.catalina.core.StandardContext start
SEVERE: Context [/appdata] startup failed due to previous errors
Jun 7, 2012 11:35:27 AM org.apache.catalina.core.StandardContext stop
INFO: Container org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/appdata] has not been started
Jun 7, 2012 11:35:27 AM org.apache.catalina.startup.HostConfig deployWAR
INFO: Deploying web application archive appmon-qa.war
Jun 7, 2012 11:35:28 AM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
Jun 7, 2012 11:35:28 AM org.apache.catalina.core.StandardContext start
SEVERE: Context [/appmon-qa] startup failed due to previous errors 
```

我**假设**我写得非常完美的`appmon-qa.war`应用程序由于对这个旧应用程序的一些幽灵引用而无法部署`appdata.war`。如果是这样，我是否（正确地）从 Tomcat 中完全取消部署或删除它，以便它不会给我的新应用程序带来问题？

否则，如果这个日志输出表明自己有问题`appmon-qa.war`，那我从哪里开始调试呢？通常这些“由于先前的错误而失败”输出还包括错误的原因或来源；这个输出非常不具描述性和模糊性。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T15:57:13.710

查看`${TOMCAT.HOME}/conf/Catalina/localhost/appdata.xml`并删除它，如果它存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T15:03:51.850

我遇到了同样的错误（文档库...不存在或不是可读目录）。简单的解决方案是在现有的 Tomcat 上重新安装 Tomcat（忽略警告“无法安装服务”，因为它已经存在）。

# c - 试图在为数组分配堆分配内存中的值时找出错误

> ID：10935336
> 
> 赞同：0
> 
> 时间：2012-06-07T15:51:02.740
> 
> 标签：c, malloc, allocation

我试图弄清楚为什么当我将值分配给堆分配内存中的结构数组中的结构时会出现错误。

我有以下 C 结构：

```
typedef struct _Point{
int x;
int y;
 }Point; 
```

和一个点数组：

```
typedef Point Sample[]; 
```

现在我想分配一个样本数组，其中任何样本由 15 个点组成，我使用以下代码：

```
Sample *new_positions;
data.old_positions =(Sample*) malloc(sizeof(Point) * 15 * global.nsamples); 
```

当我尝试将其与以下代码一起使用以分配值时，出现错误

```
data.old_positions[0][0].x=5; 
```

问题出在哪里？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T15:53:02.067

data.old_positions 只是一维 -

```
 data.old_positions[0].x=5; 
```

分配 Zeroith 项目。最好模拟二维而不是构造二维数组。

```
 data.old_positions[0 * 15 + 0].x = 5; 
```

`(Sample *)malloc(...`有效地构造一个没有内容的一维数组。您将需要 malloc 二维...

```
 data.old_positions = (Sample *)malloc(sizeof(Sample) * global.nsamples)
 for (int i = 0; i < global.nsamples; i++) 
     data.old_positions[i] = (Point*)malloc(sizeof(Point) * 15); 
```

那应该这样做。

# c# - 以下代码线程安全吗

> ID：10935338
> 
> 赞同：0
> 
> 时间：2012-06-07T15:51:23.977
> 
> 标签：c#, multithreading, thread-safety, locking

我有这样的课。

```
public abstract class HtmlObject<T>
{

    public HtmlObject() {}
    public HtmlObject(string id, string name, T value)
    {
        this.ID = id;
        this.Name = name;
        this.Value = value;
    }

    public string ID { get; set; }
    public string Name { get; set; }
    public T Value { get; set; }

    public abstract string Build();
} 
```

有一个看起来像这样的具体实现。

```
public class HtmlRadio : HtmlObject<string>
{
    private const string RadioHtml = "<input type='radio' name='{0}' value='{1}' {2} />{1}<br />";

    public bool Checked { get; set; }

    public override string Build()
    {
        if (this.Checked) 
            return string.Format(HtmlRadio.RadioHtml, this.Name, this.Value, "checked='checked'");
        else
            return string.Format(HtmlRadio.RadioHtml, this.Name, this.Value, string.Empty);
    }
} 
```

我想知道的是，`Build()`如果跨线程进行调用是否安全。我的假设是不会因为如果我接听以下一系列电话

```
HtmlRadio radio = new HtmlRadio();
radio.Checked = false;
//Something could happen here?
string result = radio.Build(); 
```

我的理解是，它的值`radio.Checked`可以在它被设置和调用之间改变，这`Build()`是正确的吗？如果是这样，如果我愿意，我怎么能“解决”这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T15:54:38.390

```
IHtmlRadio radio = new HtmlRadio();
radio.Checked = false;
//Something could happen here only if you give `radio` to another thread somehow.
string result = radio.Build(); 
```

另一个线程可以访问`radio`吗？如果没有，那么你很好。

另外，你怕什么？如果检查从假变为真或真变为假，你真的在​​乎吗？它不会爆炸——它会返回一个布尔值，而不是抛出异常。

**编辑：** 不，它不是写的线程安全的，另一个线程可以更改`Checked`and `Value`，`Name`其中没有一个以任何方式以任何顺序受到保护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:33:06.640

通常，实例成员*并非*设计为线程安全的。您的代码与 .NET Framework 中的大多数类一样不安全。

除非您的类是专门为与并发相关的场景（例如`System.Collections.Concurrent`命名空间）而设计的，否则您不必担心使其成为线程安全的；这只会导致实施过于复杂和效率低下。在适用的情况下，线程访问的同步应该是消费代码的责任。

# jquery - 在 jQuery.ajax() GET 请求中记录构造的 URL 字符串

> ID：10935341
> 
> 赞同：8
> 
> 时间：2012-06-07T15:51:39.780
> 
> 标签：jquery

我想记录 jQuery.ajax 调用的完全构造的 url 字符串。我在 ajax 命令的数据变量中设置参数，如下所示：

```
jQuery.ajax({
  url: 'http://a.site.com',
  data: {
    format: 'json',
    name: 'John Smith',
    addressdetails: 1
  },
  beforeSend: function(jqXHR, settings) {
    console.log(jqXHR, settings); // Can't find it in these values
  },
  success: function(data, textStatus, jqXHR) {
    console.log(data, textStatus, jqXHR); // Nor in these
  }
}); 
```

我将在上面示例的日志中寻找的是这个字符串：

```
'http://a.site.com?format=json&name=John%20Smith&addressdetails=1' 
```

我觉得一定有什么我错过了。我确信它会在其中一个回调函数中，但我一生都无法在任何地方找到它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-07T15:59:10.047

```
settings.url 
```

见片段：

```
$.ajax({
  url: 'http://google.com',
  data: {
    format: 'json',
    name: 'John Smith',
    addressdetails: 1
  },
  beforeSend: function(jqXHR, settings) {
    document.write(settings.url);
  }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
```

# xtk - 将颜色表动态设置为音量

> ID：10935343
> 
> 赞同：0
> 
> 时间：2012-06-07T15:51:46.677
> 
> 标签：xtk

渲染卷后，以下代码段似乎没有做任何事情。

`volume.colortable.file = file; volume.modified(); r.render();` 此外，放在`volume.colortable.file = file;`后面`r.add(volume)`会导致“y 未定义”错误。

使用了最新的 xtk_edge.js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:41:35.550

这是正确的。在解析过程中需要附加颜色表以正确配置卷/标签图的纹理。在我看来也没有简单的方法。

# c++ - 使用受保护构造函数的 C++ 常量实例？

> ID：10935345
> 
> 赞同：1
> 
> 时间：2012-06-07T15:51:49.203
> 
> 标签：c++, constants, instance, protected

我需要定义一个生成唯一标识符的 C++ 类。这个想法是每个可见类的每个实例都将被一个唯一的整数值标记。我们称其为实例的“句柄”。句柄在系统中的所有实例中必须是唯一的。

一些实例可能与其他实例相关，在这种情况下，它们的类定义了一个成员来存储其亲属的句柄。

但并非所有实例实际上都有亲戚。所以我需要一个特殊的句柄值来代表一个“未定义”的亲戚。

我需要帮助来定义那个特殊的实例。这是我尝试过的：

```
class Handle {
public:
  Handle(): mValue(newValue()) {};

  static const Handle kUndefHandle(0);         // (1)

protected:
  Handle(int val): mValue(val) {};             // (2)
  int mValue;
  static int mNextValue = 1000; // start at 1000\. (3)

  static int newValue() { return mNextValue++; }
}; 
```

笔记：

*   第 (3) 行无法编译（Clang 3.x）。编译器拒绝静态变量的内联初始化。修复很简单，在实现文件中离线初始化它。因此，我的课程不能仅是标题，但我可以忍受。

*   第 (1) 行定义了我的特殊常量实例。不幸的是，编译器失败了，说“预期的参数声明符”。

我也尝试过：`static const Handle kUndefHandle = 0;`但是编译器会抱怨“变量的类型‘句柄’不完整”，*即使我把它放在子类*中。而且我不能像在 Ruby 中那样在 C++ 中重新打开一个类。

我可以通过将该 const 实例声明放在类之外来使其工作。我失去了课程范围，但这是一个小缺点。如果我关心的话，我仍然可以使用命名空间。

但是，这仅在我将第 (2) 行中的构造函数公开时才有效。我不希望那样。我不想让程序员用任意值构造句柄。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:58:01.937

这对我有用：

# 标题

```
class Handle {
public:
  Handle(): mValue(newValue()) {};

  static const Handle kUndefHandle;

protected:
  Handle(int val): mValue(val) {};
  int mValue;
  static int mNextValue;

  static int newValue() { return mNextValue++; }
}; 
```

# 执行

```
const Handle Handle::kUndefHandle(0);

int Handle::mNextValue = 1000; 
```

初始化静态类成员实际上被认为是在类的范围内，因此您可以在该上下文中访问私有和受保护的构造函数。

* * *

请注意，您应该将构造函数设为私有，因为**目前存在一个漏洞，人们可以通过该漏洞构造具有任意值**的句柄：派生类，链接到受保护的构造函数，然后将结果对象转换为`Handle`. （[见ideone的例子](http://ideone.com/Q9bg3)）

```
class FakeHandle : public Handle
{
public:
  FakeHandle(int val) : Handle(val) { }
}; 
```

现在可以这样做：

```
Handle badHandle = FakeHandle(5); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T15:57:56.167

`static const`只有当成员是整数类型时，才能在类中初始化成员。这是一种特殊情况，一般规则是您必须将初始化放在 .cpp 文件中（连同您的静态非常量）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:58:24.177

这是一个可以帮助您入门的框架：

```
class Foo
{
    static int const undef_handle;
    static int next_handle;
    static int get_handle() { return ++next_handle; }

    int const my_handle;
    int const related_handle;

public:

    Foo()
    : my_handle(get_handle())
    , related_handle(undef_handle)
    { }

    Foo(int h)
    : my_handle(get_handle())
    , related_handle(h)
    { }

    // Copy/move constructors, assignment, ...
};

int Foo::next_handle = 1000;
int const Foo::undef_handle = 0; 
```

# jquery - jQuery 这不选择单个元素

> ID：10935347
> 
> 赞同：0
> 
> 时间：2012-06-07T15:51:52.927
> 
> 标签：jquery, css

我有一些带有图标的链接：

```
<div class="icons">
< href="..."><img src='' /></a>
< href="..."><img src='' /></a>
...
</div> 
```

我正在尝试使用 jQuery 使用代码`margin-top`为 s 的 css 属性设置动画：`IMG`

```
$j = jQuery.noConflict();
$j("div.icons a").live({
mouseenter: 
function(){
    $j("img",this).animate({'margin-top': '-10px'}, 500);},
mouseleave:
function(){
    $j("img",this).animate({'margin-top': '-35px'}, 500);}
}); 
```

但它正在改变`margin-top`DIV 中所有图像的属性，而不仅仅是悬停的图像。我究竟做错了什么？

你可以在这里看到它的工作：http: [//pasterzdrzew.pl/](http://pasterzdrzew.pl/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:55:54.103

问题是您`display: inline-block;`在链接上使用了，您应该使用`display:block; float:left;`并且应该可以解决问题（使用 Chrome 的开发人员工具测试）。

Inline-block 并不完全是块元素，应该非常明智地使用它，以防止出现这样的问题，因为边距与块元素的行为不完全相同。

# objective-c - 为我的班级采用/实施快速枚举的示例？

> ID：10935355
> 
> 赞同：6
> 
> 时间：2012-06-07T15:52:24.827
> 
> 标签：objective-c, fast-enumeration

我试图了解如何为我正在创建的类采用快速枚举协议（在 iOS/objective C 下）。我阅读了 Apple 文档的部分，但是……我不太明白！

有人有一些我可以看的示例代码吗？

我正在尝试做的事情：我有一个对象数组，我希望发送者对其进行迭代。发件人想要使用 for-in 构造。问题是我不希望发送者看到数组中的*所有*对象，因为其中一些在应用程序的上下文中无效。

换句话说，我希望我的迭代器返回数组中匹配特定条件的对象子集。

我不希望在此过程中创建任何*新*数组，以免减慢速度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T15:58:26.970

Apple 自己的[FastEnumerationSample](https://developer.apple.com/library/mac/#samplecode/FastEnumerationSample/Introduction/Intro.html)很好地证明了这一点。从它的声音来看，你可能还没有看到它。

还有[这篇博文](http://www.mikeash.com/pyblog/friday-qa-2010-04-16-implementing-fast-enumeration.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-10T14:37:19.357

这里有更好的解释：

[http://www.cocoawithlove.com/2008/05/implementing-countbyenumeratingwithstat.html](http://www.cocoawithlove.com/2008/05/implementing-countbyenumeratingwithstat.html)

注意：Apple 的源代码在技术上是正确的，但解释得不好，而且几乎没有用，除非你喜欢玩“猜猜程序员那天在想什么/抽烟”。

Liekwise，Mike Ash 的帖子是正确的，并且*在您知道如何做之后*很有用，但作为一个起点很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T15:58:14.777

我不知道您所说的“发件人想要使用 for-in 构造”是什么意思。使用 indexOfObjectsPassingTest: 可能会更好地实现您要求的结果，这将为您提供数组中通过您为其设置的任何测试的所有项目的索引集。

您还可以使用 filteredArrayUsingPredicate: 派生一个新数组，该数组是原始数组的子集——我知道您说过您不想创建任何新数组，但如果您想返回数组的子集，那么您必须创建一个新数组。

# javascript - 溢出：当元素被删除时，带有子 TABLE 滚动条的 DIV 上的 auto 仍然存在

> ID：10935360
> 
> 赞同：1
> 
> 时间：2012-06-07T15:52:59.583
> 
> 标签：javascript, jquery, html, css, internet-explorer

在 IE8 中，当从具有静态高度和溢出设置为自动的 DIV 内的表中动态删除 TR 元素时，滚动条在不再需要时仍然可见。

这是一个例子：http: [//jsfiddle.net/9HGJm/17/](http://jsfiddle.net/9HGJm/17/)

有没有办法让 IE 在不再需要滚动条时像其他浏览器一样隐藏滚动条？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T02:20:39.707

删除 #macroFilters div 上设置的固定宽度似乎有助于使滚动条消失。另一种方法是我添加了一个父 div 来包装 #macroFilters div，然后将该外部 div 设置为固定宽度，滚动条也消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T22:36:45.020

我最终通过手动更改溢出属性来使用 Foobar 的方法。看来是让IE8配合的唯一途径。

```
 if ( $('#container> div').height() <= $('.selectionData').height() ) {
              $('#container').css('overflow','visible');
        } else {
              $('#container').css('overflow','auto');           
       } 
```

这是一个结果示例：http: [//jsfiddle.net/9HGJm/7/](http://jsfiddle.net/9HGJm/7/)

# java - JDBC 中带有单个语句的多个 ResultSet-s

> ID：10935361
> 
> 赞同：2
> 
> 时间：2012-06-07T15:53:01.137
> 
> 标签：java, jdbc

`Connection.createStatement()`没有参数。然后我们调用`Statement.executeQuery()`来检索数据。

我们可以使用单个`Statement`实例来运行多个不同的查询吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T15:56:08.473

可以，但不能同时进行。当您重新执行该语句时，[先前的结果集将关闭](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html)：

> 当生成它的 Statement 对象关闭、重新执行或用于从多个结果序列中检索下一个结果时，ResultSet 对象将自动关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T15:54:58.923

如果您正在执行具有不同参数的相同 SQL，则可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T12:43:11.123

尝试语句 createStatement(int resultSetType, int resultSetConcurrency, int resultSetHoldability) resultSetHoldability=ResultSet.HOLD_CURSORS_OVER_COMMIT

# mysql - 为什么当乘以 DECIMAL 字段时，答案会四舍五入？

> ID：10935366
> 
> 赞同：0
> 
> 时间：2012-06-07T15:53:12.353
> 
> 标签：mysql

我有一个**DECIMAL(18,3)**字段，我使用触发器将其乘以 12。使用任何计算器都会返回例如 644.8 * 12 = 7737.6。但 MySQL 返回 7738。什么给出了？扳机：

`SET NEW.Perannum = NEW.Wage * 12;`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:06:28.013

尝试乘以 12.00 以确保十进制值 * 十进制值...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-07T17:37:33.580

你必须了解它的数学原理。“四舍五入”总是意味着到下一位最接近的小数点——向上或向下。例如，如果您的结果需要小数点为 0 的精度，而您的计算结果为 0.5 或更小，则它会向下舍入。如果计算值大于 0.5，则会四舍五入。您正在寻找的是“截断”，这意味着“将多余的剩余部分扔掉”。

# qt - 从 .bat 文件和 .bat 文件执行 bash 脚本由 QT 应用程序调用

> ID：10935367
> 
> 赞同：3
> 
> 时间：2012-06-07T15:53:16.167
> 
> 标签：qt, bash, batch-file

我需要有关从 Windows 中的 Qt 应用程序调用的批处理脚本（.bat）执行 bash 脚本的帮助。

**问题概述：**我需要通过 Qt 应用程序将文件从 Windows 传输到 Linux 机器，并在 linux 中运行 bash 脚本来执行一些命令。

**到目前为止我所做的：** 我可以通过 Qt 应用程序成功地将文件从 Windows 传输到 Linux 机器。Qt 应用程序调用传输文件的批处理文件

例子

```
 void Qt_intro101::on_file_upgrade_clicked()
 {
     QFileInfo fileInfo( ui->selected_file->text() );
     if( !fileInfo.exists() )
     {
         QMessageBox::information(this, tr("Information"),
                           tr("Unable to find file for upgrading!"));
        return;
     }

     // copying update
     QString fileName = fileInfo.absoluteFilePath();

      //Check if cmd.exe is present in Clients system and is located at correct path
      QFileInfo cmdFile( "C:\\Windows\\system32\\cmd.exe");
      if( !cmdFile.exists() )
      {
          QMessageBox::information( this, tr( "Information" ),
                                  tr("Failed to find the cmd.exe ... Check cmd.exe is        installed and is in  C:\\Windows\\system32\\ !"));
           return;
      }

     QStringList arguments ;
     arguments << " /c" <<"c:\\temp\\upgradeTesting\\test.bat"<< fileName  ;
     QProcess *process = new QProcess( this );
     process->start( cmdFile.absoluteFilePath(), arguments ) ;
     if( !process->waitForStarted() )
     {
           QMessageBox::information(this, tr("Information"),
                             tr("Failed to start the process for upgrading!"));
           return;
      }

             QMessageBox::information(this, tr("Information"),
                             tr("Please wait while system is  upgrading   .. click Ok to exit this box"));
         qDebug() << fileName ;
         process->waitForFinished() ;
         qDebug() << process->readAllStandardOutput();
        QMessageBox::information( this, tr( "Information" ),
                             tr( "Upgradation is successful.. Please restart the system") ) ;
          process->deleteLater();

  } 
```

* * *

我写了一个批处理脚本（.bat），它执行类似的命令

```
 pscp -pw "lol" "%TARGET_UPDATE%" squire@"%TARGET_IP%":"%BASE_DIR%"/ 
```

**通过下面的批处理文件执行 bash 脚本是批处理文件中的命令**

```
 putty -pw "lol" -m test-update.sh squires@"%TARGET_IP%" 
```

我什至尝试过类似的东西

```
 C:\\Program Files\\putty.exe -pw "lol"  -m test-update.sh squires@"%TARGET_IP%" 
```

你们能告诉我我在哪里犯错吗？

谢谢和问候，
山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T09:13:19.093

我认为使用 QProcess::execute(QString cmdstring) 比您也可以将参数传递给批处理文件本身更容易

测试.cpp

```
QFileInfo cmdFile( "C:\\Windows\\system32\\cmd.exe");
QProcess *process = new QProcess( this );
process->execute(cmdFile.absoluteFilePath() + " /c helloparam.bat \"my param\"  ");
process->waitForFinished() ;
qDebug() << process->readAllStandardOutput(); 
```

helloparam.bat

```
@echo off
echo hello %1 
```

信息：要在您的 IDE 中进行测试，请确保您正在从发布文件夹运行 application.exe，并将批处理文件也在该文件夹中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:02:01.640

你不能`waitForStarted()`每次运行调用两次。如果`waitForStarted()`返回 false，您将从方法执行中返回。所以在`if( ! waitForStarted()`你的进程运行之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:17:57.793

花了很多小时后，我意识到我需要在批处理脚本中给出完整的路径名，以便 Qt 执行它。没有 qt 它可以正常工作，但是如果我想通过 QT 应用程序运行批处理文件，那么我想我需要提供 bash 脚本的完全限定路径名。例子

```
 putty.exe -pw "lol" -m C:\\temp\\upgradingTest\\test-update.sh squires@"%TARGET_IP%" 
```

代替

```
 putty -pw "lol" -m test-update.sh squires@"%TARGET_IP%" 
```

# database - 可更新顺序记录的数据库设计

> ID：10935371
> 
> 赞同：0
> 
> 时间：2012-06-07T15:53:21.620
> 
> 标签：database, database-design, relational-database

我正在创建一个数据模型来存储与生产跟踪相关的数据。我在一家为客户建模和分析数据的工程公司工作。该过程有几个步骤，并且该过程不断更新。

我正在尝试对流程进行建模并包括父流程和流程的顺序。

例如：

```
Process Table
---------------------
ProcessID - uniqueidentifier
ProcessName - varchar
ProcessDescription - varchar
...

ProcessOrder Table
---------------------
ProcessID - uniqueidentifier FK - Process
ParentProcessID - uniqueidentifier FK - Process
ProcessOrder - int
... 
```

表中的`ProcessOrder`列`ProcessOrder`将简单地存储一个数字，该数字表示它所代表的父进程中的哪个顺序步骤。

例如，一个建模过程有以下步骤：创建新的空模型，命名模型，输入模型参数。该`Process`表看起来像：

```
ProcessID | ProcessName | ProcessDescription
-------------------------------------------------
UUID1     | Modeling    | Create Model of Data
UUID2     | New Model   | create new empty model
UUID3     | Name Model  | name model
UUID4     | Parameters  | enter model parameters 
```

该`ProcessOrder`表看起来像：

```
ProcessID | ParentProcessID | ProcessOrder
--------------------------------------------------
UUID2     | UUID1           | 1
UUID3     | UUID1           | 2
UUID4     | UUID1           | 3 
```

这种设计的问题是，当工作流更新时，流程顺序会发生变化，我需要更新已`ProcessOrder`更改流程的记录以及具有相同`ParentProcessID`.

有没有更好的方法来存储这种数据并保持规范化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T10:35:28.360

我认为该解决方案类似于我在[Advise on database design for a project生命周期中提出的解决方案](https://stackoverflow.com/questions/11035357/advise-on-database-design-for-a-project-lifecycle/11264055#11264055)

上面的数据是针对前面示例中描述的不同状态值的。因此，对于每个客户项目，您都有下表：

a) 客户项目 - Clientid - 对客户的引用 - 状态（FK 到 ProcessID） - 项目名称、描述、开始日期

b) 状态更改 - 跟踪从一种状态到另一种状态的更改 - projectid - 旧状态（FK 到 ProcessID） - 新状态（FK 到 ProcessID） - 更改日期 - 注释（以及其他列，如批准等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T15:35:56.003

这个问题类似于为什么 LinkedLists 具有更好的插入性能（假设您已经有对要插入的节点的引用）与 ArrayList 中的插入相比。

在 ArrayList 中进行插入时，您必须移动所有记录以为新插入腾出空间。假设有 N 条记录，这可能需要 O(N) 时间（想象在列表的开头插入）。

在 LinkedList 中，您只需在要插入的点更新节点。根据上述假设，这将花费 O(1) 时间，因为您只需要更新 Prev 节点和 Next 节点。

要在数据库中设置 LinkedList 结构，而不是 ProcessOrder 列，您将有两列，PrevProcessID 和 NextProcessID。

选择这个时问题来了。天真的方法是在表上递归地自连接。这将导致 N 个连接。

不要使用 N 个连接，而是不要使用任何连接并选择所有具有父 ID 的进程。

在代码中，有一个包含以下字段的 Process 对象： ParentProcessID ProcessID PrevProcessID NextProcessID

在从选择中读取记录时，创建这些对象并将它们存储在以 ProcessID 作为键的 HashTable 中。这将花费 O(N) 时间来遍历 select 语句。

现在记录在 HashTable 中，您可以通过查找表中的 NextProcessID（或 PrevProcessID）轻松地从一个节点移动到下一个节点。使用 HashTable 可以让您免于进行 N 次连接，而是花费 O(N) 时间来设置。

比较两种方法

1）您现在拥有的当前解决方案。这是一个 ArrayList 类型的解决方案（将 ProcessOrder 视为索引）。插入需要 O(N) 时间，而您可以节省读取时间，因为您不必设置 HashTable。但是，如果您已经循环通过返回的记录来设置实体对象，那么这将与 LinkedList 解决方案中的设置时间量相同。

2）我提出的解决方案。这是一个 LinkedList 类型的解决方案。假设您知道要插入的位置，插入需要 O(1) 时间。设置时间需要 O(N) 时间。

# groovy - 如何在soapUI 中的AMF 请求中发送AMF 凭据？

> ID：10935372
> 
> 赞同：0
> 
> 时间：2012-06-07T15:53:22.197
> 
> 标签：groovy, soapui, amf, loadui

我需要在soapUI 中使用AMF 请求发送登录名和密码。

是的，我知道在 testCase 级别有一个选项，您可以在其中指定它，并且您可以通过测试步骤设置此属性，但我需要在不使用此方法的情况下将这些信息与请求一起发送尝试在 LoadUI 中加载测试此测试用例，所有虚拟用户似乎都使用相同的 AMF 会话凭据，即使我在测试运行中随机化并重置这些值也是如此。

它实例化了测试用例的每个部分，除了 AMF 会话凭据，所以我需要找到一种方法来用脚本发送它，因为这些不是在请求中作为参数发送的，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T20:04:48.450

我最终不得不在 Groovy 脚本步骤中手动创建 AMF 连接并登录和注销并关闭连接。

发现这个解释整个过程的很棒的博客。

[http://aredko.blogspot.com/2010/06/testing-blazeds-remote-objects-with_06.html](http://aredko.blogspot.com/2010/06/testing-blazeds-remote-objects-with_06.html)

# jquery - 如何检测是否在jQuery中创建了跨度

> ID：10935373
> 
> 赞同：0
> 
> 时间：2012-06-07T15:53:22.343
> 
> 标签：jquery, asp.net-mvc-3

这实际上与 ASP.NET MVC 有关。

提交表单时，将执行模型验证。如果检测到错误，错误消息将显示在`<span>`. 我们应该能够使用`jQuery`, by来掌握它`$('span.field-validation-error')`。但是我们应该为这个“OnCreated”绑定什么事件呢？

我已经尝试过`$('span.field-validation-error').change(function (e) {`，`$('span.field-validation-error').load(function (e) {`等等。但它们都没有奏效。

那么正确的事件名称是什么？

- - 更新 - -

我们的目标是自定义显示的错误消息。例如，如果可以`<span>`在创建标签时对其进行编辑，我们将能够显示感叹号图标并将这些错误消息放置在工具提示中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:23:49.803

我**猜**你可以：

```
var checkTimer = setInterval(function() {
        if ($('span.field-validation-error').length > 0) {
            //yay :D it exists!
            alert("YEP");
            clearInterval(checkTimer);
        } else {
            //derp...    
            console.log("nope");
        }
}, 50);
setTimeout(function() {
    document.body.innerHTML = "<span class='field-validation-error'>word</span>";
}, 5000);​ 
```

示例： http:
[//jsfiddle.net/neuroflux/Ynz5b/1/](http://jsfiddle.net/neuroflux/Ynz5b/1/)

**[编辑]**是的......它很乱，我讨厌计时器和间隔 - 但这是一种方法......

**[编辑 2]**检查参考如果元素存在：[http ://aaronrussell.co.uk/legacy/check-if-an-element-exists-using-jquery/](http://aaronrussell.co.uk/legacy/check-if-an-element-exists-using-jquery/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:00:45.507

如果我理解正确，您真正想做的是将一些代码包装在另一个函数中，并同时调用`span.field-validation-error`附加到 DOM 的代码。

没有`onCreated`事件处理程序，也不`onLoad`适用于 DOM 节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T19:39:50.633

不确定我是否真的会为您正在做的事情推荐这种方法，但您可以考虑挂钩到 jQuery 验证器 settings.showErrors 属性来操作错误消息，然后调用默认方法 (defaultShowErrors) 以照常显示它们。

# php - PHP 包含无法正常工作

> ID：10935382
> 
> 赞同：0
> 
> 时间：2012-06-07T15:53:49.723
> 
> 标签：php, debian

我有在 Debian Squeeze 上运行`http://www.example.com/`的文档。`/home/www/example.com/www`

```
/home/www/example.com/
    www/
         index.php
    php/
         include_me.php 
```

在 php.ini 中，我取消注释并更改为：

```
include_path =".:/home/www/example.com" 
```

在 www 的脚本 index.php 中，我有`require_once("/php/include_me.php")`. 我从 PHP 得到的输出是：

```
Warning: require_once(/php/include_me.php) [function.require-once]: failed to open stream: No such file or directory in /home/www/example.com/www/index.php on line 2

Fatal error: require_once() [function.require]: Failed opening required '/php/include_me.php' (include_path='.:/home/www/example.com') in /home/www/example.com/www/index.php on line 2 
```

如您所见，包含路径根据错误设置正确。但如果我这样做`require_once("../php/include_me.php");`，它会起作用。因此，包含路径一定有问题。

有谁知道我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T15:56:42.123

```
php/ 
```

是相对路径，以当前目录为起点

```
./php/ 
```

是一个相对路径，并显式声明当前目录 ( **.** ) 作为起点

```
/php/ 
```

不是相对路径，**这**意味着它的起点是顶级目录（根目录**/**）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:59:29.923

我同意 Mihai Stancu 的观点，但我想补充一点，包括使用 dirname(__FILE__) 可能是更好的做法，这样当目录移动时代码不会中断。这将充当绝对路径，但允许您将它们视为本地路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T16:00:33.697

require_once("/php/include_me.php") 的解释：

您为“/home/www/example.com/”设置了包含路径，但这是/home/www 的子目录。您的 require_once 正在寻找 /php/include_me.php。

```
/
home/
    www/
        example.com/
              php/
              www/
php/
    include_me.php 
```

您的 require 调用中有一个前面的 /，它正在寻找 /php/include_me.php。要查找 /home/www/example.com/php/include_me.php 你会想要：

```
require_once('php/include_me.php'); 
```

您还可以将包含路径设置为：

```
include_path =".:/home/www/example.com/:/home/www/example.com/www/:/home/www/example.com/php/" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-07T15:57:55.597

从文档中[`include`](http://php.net/include)：

> 如果定义了路径——无论是绝对路径（在 Windows 上以驱动器号或 \ 开头，或在 Unix/Linux 系统上以 / 开头）还是相对于当前目录（以 . 或 .. 开头）—— include_path 将被完全忽略。例如，如果文件名以 ../ 开头，解析器将在父目录中查找请求的文件。

由于您在这种情况下指定了绝对路径，因此`include_path`将忽略 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T15:58:09.080

你需要的开始斜线一次将从根搜索......尝试：

```
require_once('php/include_me.php'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-07T15:58:28.393

这是试图在您的文件系统上的 /php 中获取文件，而不是您的 Web 目录。

```
require_once("/php/include_me.php"); 
```

# r - R中子集的前x个条目的平均值

> ID：10935384
> 
> 赞同：1
> 
> 时间：2012-06-07T15:53:56.777
> 
> 标签：r, subset, mean

说我有数据框

```
df <- data.frame('A' = c('a','a','a','a','b','b','b','b','b'),
                 'B' = c('y','y','z','z','y','y','y','z','z'),
                 'value'=c(1  , 2 , 2 , 3 , 2 , 3 , 1 , 2 , 2)) 
```

所以看起来像这样

```
 A B value  
 a y     1  
 a y     2  
 a z     2  
 a z     3  
 b y     2  
 b y     3  
 b y     1   
 b z     2   
 b z     2 
```

我可以使用查询获得 A 和 B 的每个子集的平均值

```
with(df, aggregate(df, by = list(A, B), FUN = mean)) 
```

经过一些操作后

```
A B value  
a y   1.5  
b y   2.0  
a z   2.5  
b z   2.0 
```

有没有办法做到这一点，但只计算每个子集中最高 x 值的平均值。因此，如果我们在此示例中将 x 设为 2，则子集 ay、az 和 bz 的平均值不会改变，因为它们总共只有两个条目（因此顶部 x 条目是子集的整个数据集）。但是 by 有三个条目，因此我们希望返回最高两个值（2 和 3）的平均值，以便输出表看起来像

```
A B value  
a y   1.5  
b y   2.5  
a z   2.5  
b z   2.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:08:13.800

我发现使用公式接口更容易`aggregate`，如下：

您的原始版本：

```
aggregate(value~A+B, data=df, FUN = mean)
  A B value
1 a y   1.5
2 b y   2.0
3 a z   2.5
4 b z   2.0 
```

您可以通过使用计算排序值尾部平均值的匿名函数来获得所需的版本：

```
aggregate(value~A+B, data=df, FUN = function(x)mean(tail(sort(x), 2)))
  A B value
1 a y   1.5
2 b y   2.5
3 a z   2.5
4 b z   2.0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:10:39.367

对于同一件事的版本：

```
lapply(split(df, list(df$A, df$B)),
       function(x) mean(x[order(x$value, decreasing = TRUE), ][1:2, "value"])) 
```

或者

```
sapply(split(df, list(df$A, df$B)),
       function(x) mean(x[order(x$value, decreasing = TRUE), ][1:2, "value"])) 
```

给出想要的结果：

```
> lapply(split(df, list(df$A, df$B),
+        function(x) mean(x[order(x$value, decreasing = TRUE), ][1:2, "value"]))
$a.y
[1] 1.5

$b.y
[1] 2.5

$a.z
[1] 2.5

$b.z
[1] 2

> sapply(split(df, list(df$A, df$B)),
+        function(x) mean(x[order(x$value, decreasing = TRUE), ][1:2, "value"]))
a.y b.y a.z b.z 
1.5 2.5 2.5 2.0 
```

在实际应用程序中，您可能希望使匿名函数成为适当的函数，并使其对每个子集中少于 2 行的情况具有鲁棒性。这留给读者作为练习。

我展示的匿名函数（或一个非常相似的函数）可以很容易地用于`aggregate()`：

```
aggregate(value ~ A + B, data = df,
          FUN = function(x) mean(x[order(x, decreasing = TRUE)][1:2])) 
```

例如：

```
> aggregate(value ~ A + B, data = df,
+           FUN = function(x) mean(x[order(x, decreasing = TRUE)][1:2]))
  A B value
1 a y   1.5
2 b y   2.5
3 a z   2.5
4 b z   2.0 
```

但我是老派，经常用手做这些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:06:10.667

这有帮助吗？

```
x <- 2
with(df, aggregate(df, by = list(A, B), FUN = function(x)
                                                 mean(x[1:x]))) 
```

# css - CSS 性能：是否可以在彩色元素上大量使用叠加图案？

> ID：10935386
> 
> 赞同：3
> 
> 时间：2012-06-07T15:53:58.313
> 
> 标签：css, background-image

我即将构建一个包含大量纹理背景的设计，这些背景使用相同的羊皮纸图案但颜色不同。显然，我可以为每种颜色创建和导出不同的平铺背景图像，但我想知道创建一个单色图案是否更聪明，我可以覆盖具有必要块背景颜色的元素。

我的问题是，从性能的角度来看，这种方法是否可行。我以前为小元素做过这个，但我想知道在许多元素上使用这种技术是否会慢得让人无法接受，例如网站的背景、给定页面上的几个 div、按钮等。经验告诉我，旧的浏览器对太多的 png alpha 感到窒息（尽管这个项目是 IE8+，幸运的是）。

有什么想法吗？

编辑：当我谈到性能时，我主要关心的不是下载时间，而是实际的页面渲染性能。我注意到 alpha PNG 在过去落后于某些浏览器，因此即使是一个小的平铺纹理的广泛使用也可能（我猜）会导致类似的问题。

在这个阶段下载性能不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:03:27.363

我强烈建议使用单一的单色图案。我建议这样做，因为在这种情况下，浏览器只加载一个图像文件，而在另一种选择中加载多个文件。如果您的网站很小并且没有获得太多流量，那可能并不重要，但是优化您所做的工作量始终是一个好习惯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:04:14.710

From a performance point of view, I would say stick with the same parchment pattern in different colors. I agree that your solution is cleaner - that's what I'd prefer - but you're only going to alienate users who possibly receive decreased performance on the client end (users with low-end tech? mobile devices?), whereas the extra bandwidth you would otherwise save using the monochrome pattern is (IMO) less likely to alienate users based on bandwidth (how big a difference are we talking?). I can't find any actual benchmarks for these situations.

Here are some links that discuss some related aspects of this. Note the first link has a user saying there are memory leaks in PNG alpha 24-bit in IE8.

[Which is superior, CSS transparency or PNG Transparency?](https://stackoverflow.com/questions/549768/which-is-superior-css-transparency-or-png-transparency)

[CSS opacity performance. Image fading](https://stackoverflow.com/questions/4761423/css-opacity-performance-image-fading)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:16:36.273

表现什么？如果加载性能，那么使用更少的文件会加快速度。如果滚动的性能，那将取决于你如何构建它和你的目标受众。

几年前我建立了一个有美国观众的网站，并使用了覆盖纯色的单色透明 PNG。我在很多机器上测试过这个。唯一的显示性能问题是，如果某些东西在其他不是的东西的顶部滚动。例如，如果您有两个图案重叠，一个滚动，而另一个滚动，您将在速度较慢的机器和移动设备上看到一些重绘问题。

这仅适用于少数元素，包括页面背景。如果您将其应用于每页的数十个元素，则可能会开始在旧机器上显示问题。但它仍然比具有转换功能的大型 JS 滑块占用的资源要少。

# mpi - MPI 中的互通器

> ID：10935387
> 
> 赞同：1
> 
> 时间：2012-06-07T15:54:01.463
> 
> 标签：mpi

我对以下代码有疑问：

```
#include "mpi.h"
#include <stdio.h>
#include <stdlib.h>
#include <iostream>

#define NUM_SPAWNS 2
// Based on the example from: http://mpi.deino.net/mpi_functions/MPI_Comm_spawn.html
void MPI_messenger(int stuff, int dest)
{
    MPI_Send(&stuff, 1, MPI_INT, dest, 1,intercomm);
}

int main( int argc, char *argv[] )
{
    int my_rank;
    int size;
    int np = NUM_SPAWNS;
    int errcodes[NUM_SPAWNS];
    MPI_Comm parentcomm, intercomm, testcomm;
    MPI_Init( &argc, &argv );
    MPI_Status stat;
    MPI_Comm_get_parent( &parentcomm );
    if (parentcomm == MPI_COMM_NULL)
    {
        MPI_Comm_spawn( "spawn_example4", MPI_ARGV_NULL, np, MPI_INFO_NULL, 0, MPI_COMM_WORLD, &intercomm, errcodes );
        MPI_Comm_rank(MPI_COMM_WORLD, &my_rank);
        MPI_Comm_size(MPI_COMM_WORLD, &size);
        int lol = 10;
        MPI_messenger(lol,0);
        MPI_messenger(lol,1);
    }
    else
    {
        MPI_Comm_rank(MPI_COMM_WORLD, &my_rank);
        MPI_Comm_size(MPI_COMM_WORLD, &size);
        int lol;
        MPI_Recv(&lol, 1, MPI_INT,0,1,parentcomm, &stat);

        std::cout << lol << "\n";
    }
    fflush(stdout);
    MPI_Finalize();
    return 0;
} 
```

当然intercommunicator intercomm没有定义在函数MPI_messenger的范围内。我想知道是否以及如何在函数内部获取此交互器而不将其作为参数传递。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:59:12.077

与任何其他变量相同的方式：全局声明它，或者在对两者可见的其他公共范围内声明它`main()`（`MPI_messenger()`例如，在同一个类中作为成员）。

# ruby-on-rails-3 - 未定义的方法 `+@' for true:TrueClass

> ID：10935388
> 
> 赞同：1
> 
> 时间：2012-06-07T15:54:03.273
> 
> 标签：ruby-on-rails-3, activerecord, rake

我写了这个任务来填充一个表。“飞行”表非常大（23000 个帖子）。但是当我们第二次通过循环时，我得到了这个奇怪的错误。

这是代码：

```
desc "Compute the AirlineTerminal Table"
task :populate_airlineterminals => :environment do
    #first delete content
    AirlineTerminal.destroy_all
    allFlights = Flight.all

        #AFTER ONE ITERATION THE ERROR HAPPENS
    allFlights.each do |f|
        atTerminal = AirlineTerminal.where(:airline_id => f.airline_id, :airport_id => f.airport_id, :terminal => f.terminal).first
        if atTerminal.nil?
            atTerminal = AirlineTerminal.new
            atTerminal.airport_id = f.airport_id
            atTerminal.airline_id = f.airline_id
            atTerminal.terminal = f.terminal
        end
        atTerminal.count++

        atTerminal.save #so far so good
    end
end 
```

这就是我运行脚本时发生的情况，经过一次循环后它会崩溃。

```
$ rake populate_airlineterminals
rake aborted!
undefined method `+@' for true:TrueClass 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:06:46.217

虽然我不知道我敢打赌的错误是

```
atTerminal++ 
```

是罪魁祸首。据我所知 ++ 没有在 ruby​​ 中定义。你必须使用

```
atTerminal += 1 
```

当然，除非您自己定义了它。也许它在解释代码时会导致错误。在 irb 中试试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:24:57.210

Ruby 没有 ++ 或 -- 运算符，只有 += 和 -=

[Ruby 新手应该知道的事情](http://ruby-doc.org/docs/Newcomers/ruby.html#operators)

# wpfdatagrid - 使用鼠标调整窗口大小时，我的 Datagrid 在 WPF 中显示一半

> ID：10935389
> 
> 赞同：1
> 
> 时间：2012-06-07T15:54:07.330
> 
> 标签：wpfdatagrid

在我的 WPF 项目中，我有带有滚动条的数据网格。当我使用鼠标 DataGrid 调整窗口大小时，只显示一半。另一个问题是打开弹出窗口并调整大小并关闭弹出窗口时。我再次打开，它打开以前的高度和宽度？

任何人都可以指导我这两个设计问题吗？

谢谢，拉姆基

# android - Android 进度对话框未显示

> ID：10935400
> 
> 赞同：1
> 
> 时间：2012-06-07T15:54:58.267
> 
> 标签：android, visibility, progressdialog, runnable

这是主线程中的处理程序，它显示和关闭进度对话框。

```
public static final int SHOW = 0;
public static final int DISMISS = 1;
public Handler pdHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        Log.i(TAG, "+ handleMessage(msg:" + msg + ")");
        switch(msg.what) {
        case SHOW:
            pd = ProgressDialog.show(LogViewer.this, "", getText(R.string.loading_msg), true);
            break;
        case DISMISS:
            if(pd != null) {
                pd.dismiss();
                pd = null;
            }
            break;
        }
    }
}; 
```

显示进度的消息是：

```
 pdHandler.sendMessage(pdHandler.obtainMessage(SHOW)); 
```

关闭它的消息是：

```
 pdHandler.sendMessage(pdHandler.obtainMessage(DISMISS)); 
```

当我在启动 AsyncTask 之前调用它时，它运行良好，AsyncTask onPostExecute() 将其关闭。

但是当它在可运行对象 (runOnUiThread) 中运行时，对话框不会显示。检查调试器上的 pd 变量，它显示 is 已创建、正在运行并且可见，但实际上它是不可见的。

有什么建议吗？

**更新：**
我首先做了我应该做的明显测试。我评论了 DISMISS 消息。进度对话框确实出现了。在可运行文件完成后，它出现得太晚了。
我现在不明白 DISMISS 消息确实关闭了尚不可见的 ProgressDialog，这就是我没有看到它的原因。
现在问题变成了：我需要在执行可运行代码之前显示 ProgressDialog。而且它不是那么直截了当。我的调用层次结构是这样的：

```
onScrollEventChanged
    --> runOnUiThread ( 
        --> checkScrollLimits
            --> if need to scroll
                 show ProgressDialog "Loading"
                 get new data into table
                 dismiss ProgressDIalog
    ) 
```

我试过这样的事情：

```
onScrollEventChanged
    --> checkScrollLimits
        --> if need to scroll
             show ProgressDialog "Loading"
             --> runOnUiThread ( 
                 get new data into table
                 dismiss ProgressDIalog
             ) 
```

但是在 ProgressDialog 可以显示之前，解除消息仍然存在。

根据 Logcat 的说法，在 SHOW 消息到达和 DISMISS 消息到达之间有 5 秒的时间间隔。

**更新二：**
虽然我会使用 ProgressDIalog 的 isShowing() 方法

```
pd = ProgressDialog.show(...)
while(!pd.isShowing()); 
```

但它根本没有帮助，即使对话框尚未显示，它也会返回 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:07:27.500

也许您不应该使用`runOnUiThread()`并通过以下`Looper.prepare()`功能更好地处理它：

[Looper 的目的是什么以及如何使用它？](https://stackoverflow.com/questions/7597742/android-what-is-the-purpose-of-looper-and-how-to-use-it)

此外，您`AsyncTask`已完成并运行，然后您在 UI-Thread 中，因此不需要`onPostExecute()`额外的。`runOnUiThread()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:26:49.810

我认为它不起作用。您发送消息的地方

pdHandler.sendMessage(pdHandler.obtainMessage(DISMISS));

您需要将所有这些繁重的语句或工作放入另一个非 ui 线程。处理程序用于将消息放入线程消息队列中，如果您的线程将忙，那么它将在上一条消息之后执行该消息。因此，由于您的 ui 工作繁重，该对话框没有更新。始终将服务用于您的后台工作。永远不要试图把所有东西都放在你的 UI 线程中。

希望它会帮助您，否则使用 AsyncTask 它是做这些事情的最佳方法。如果您仍然面临同样的问题，请从您将消息发送到处理程序的位置发布该代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T13:00:37.757

我通过将代码转换为 AsyncTask 并使用 try/catch 块使其工作。

[在这篇文章](https://stackoverflow.com/questions/10900588/progress-dialog-shows-too-late/10968876#10968876)中查看我的答案

我不确定 AsyncTask 是否是必要的，但在我拥有它之后，**try/catch 块产生了影响。**

# asp.net - ASP Visual Basic 语法错误

> ID：10935401
> 
> 赞同：1
> 
> 时间：2012-06-07T15:54:58.130
> 
> 标签：asp.net, vb.net

我正在尝试显示几个 RSS 提要的聚合提要。我正在用一个asp页面来做这个。

问题是我收到错误消息：Microsoft VBScript 编译错误'800a0401'

预期的语句结束

对于该行：

```
Dim feed As SyndicationFeed = New SyndicationFeed("Feed Title", "Feed Description", New Uri("http://feeds.reuters.com/reuters/oddlyEnoughNews"), "FeedID", DateTime.Now) 
```

我无法弄清楚错误在哪里。我读过的所有内容都表明这是一个简单的语法错误，缺少逗号或其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:57:30.340

这是正确的吗？很久没有写VB了。

```
Dim feed As New SyndicationFeed("Feed Title", "Feed Description", New Uri("http://feeds.reuters.com/reuters/oddlyEnoughNews"), "FeedID", DateTime.Now) 
```

# c# - ASP.net 中的 TCP 客户端

> ID：10935409
> 
> 赞同：1
> 
> 时间：2012-06-07T15:55:24.210
> 
> 标签：c#, tcpclient, .net

我正在尝试从 asp web 应用程序连接到 tcp 服务器。我在 C# 中使用应用程序完成了此操作，现在我想看看它是否可以在 Web 浏览器中运行。

我的代码是：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Net;
using System.Net.Sockets;

namespace TcpWebClient

{
    public partial class _Default : System.Web.UI.Page
{

    private byte[] data = new byte[1024];
    IPEndPoint ipep = new IPEndPoint(
            IPAddress.Parse("192.168.1.20"), 12000);

    Socket server = new Socket(AddressFamily.InterNetwork,
                   SocketType.Stream, ProtocolType.Tcp);

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {

        try
        {
            server.Connect(ipep);
        }
        catch (SocketException)
        {              
        }
    }

    protected void Button2_Click(object sender, EventArgs e)
    {
        NetworkStream ns = new NetworkStream(server);

        if (ns.CanWrite)
        {
            ns.Write(Encoding.ASCII.GetBytes("DI"), 0, 2);
            ns.Flush();
        }
        else
        {
        }
        TextBox1.Text = null;
        TextBox1.Text = Encoding.ASCII.GetString(data, 0, ns.Read(data, 0, data.Length));
    }

}
} 
```

什么工作？：我连接到 tcp 服务器。但是当我想发送和接收一些数据时，我遇到了错误：

```
IOException was unhandled by user code and something like this: Operation is not supported on connected sockets (don't know if my translation to english is ok). 
```

我做错了什么？

System.dll 中出现“System.IO.IOException”类型的第一次机会异常

**编辑：**

像这样的东西正在工作..但是我需要重新连接到服务器的每个计时器滴答声..是否可以建立一个连接，然后每个计时器滴答声读取/发送数据而不重新连接？

```
 protected void Timer1_Tick(object sender, EventArgs e)
    {

            server.Connect(ipep);
            NetworkStream stream = new NetworkStream(server);

            Byte[] data = System.Text.Encoding.ASCII.GetBytes("data");
            stream.Write(data, 0, data.Length);
            data = new Byte[256];
            Int32 bytes = stream.Read(data, 0, 8);
            responseData = System.Text.Encoding.ASCII.GetString(data, 0, bytes);
            TextBox1.Text = responseData;
            server.Close();

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T06:54:55.147

您实际上回答了自己：连接没有在您的第二个事件处理程序（Button2_click）中打开，因为您在 button1 单击时打开，并且它当然会与页面一起结束其生命周期，每个请求都会创建一个实例。

您可以将打开的连接保存在静态变量中（如果您不介意该连接是共享应用程序 - 对所有用户都适用），但我真的不确定您是否真的只使用您在编辑中发布的代码。
如果您希望连接在应用程序范围内可用，请将其变量定义为静态变量（但请确保在第一次尝试使用之前初始化/连接），您可以使用`Lazy<T>`.net 4 中提供的帮助程序类来确保连接初始化一次，仅在第一次需要时。
如果您还需要在其他类中访问连接，则可以创建一个单独的单例类来包装它（并在那里以相同的方式对其进行初始化）

# javascript - JSNI Hello World 不工作

> ID：10935416
> 
> 赞同：2
> 
> 时间：2012-06-07T15:55:43.040
> 
> 标签：javascript, gwt, jsni

我使用 JSNI完成了一个简单的*Hello World GWT 示例。*它只显示一条消息。

这是 EntryPoint 类中的代码：

```
public void onModuleLoad() {
  // TODO Auto-generated method stub
  alert("Hello World!");
 }
 native void alert(String msg) /*-{
  $wnd.alert(msg);
 }-*/;
} 
```

我看到了这个异常：

```
java.lang.reflect.InvocationTargetException
 at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T01:09:34.220

我创建了示例 GWT 项目并将您的代码复制到入口点，它运行良好。我认为你有一个更深层次的设置问题。我会查看您的 *.gwt.xml 文件并确保它没有格式错误并检查您的 GWT 库引用等。同时打开运行配置并确保它是一个 Web 应用程序。

```
 /**
 * Entry point classes define <code>onModuleLoad()</code>.
 */
public class So implements EntryPoint {

    native void alert(String msg) /*-{ 
      $wnd.alert(msg); 
     }-*/; 

    /**
     * This is the entry point method.
     */
    public void onModuleLoad() {

        alert("Hello World!"); 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:23:46.043

您可能不会在 DevMode 中运行此代码，而是在普通 JVM 中运行，GWT 无法发挥它的*魔力*

# iphone - 以图形方式布局滚动视图（页面视图）

> ID：10935421
> 
> 赞同：0
> 
> 时间：2012-06-07T15:55:59.437
> 
> 标签：iphone, ios, xcode, uiscrollview, storyboard

有没有办法使用水平滚动和 UIPageControl 轻松布局滚动视图的每一页？或者，如果没有，我可以在情节提要中制作视图，然后将这些视图中的每一个加载到相关页面中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:20:45.937

使您的视图具有“自由格式”大小，并使用从情节提要中加载视图，

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

customViewController = [storyboard instantiateViewControllerWithIdentifier:@"CutomOversizedViewController"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:04:53.040

iOS 5 添加了一个类似于您需要的类，称为[UIPageViewController](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html)。

搜索 ref 库，似乎没有发布任何演示新类的示例，但在您自己的实现中对其进行测试应该相对简单。

它需要一个视图控制器数组，因此在您的情况下，您似乎可以提供一个显示滚动视图的重复视图控制器列表，然后管理一种内部维护页面索引的方法。

# java - 在 android 应用程序中找出谷歌搜索的结果链接

> ID：10935422
> 
> 赞同：0
> 
> 时间：2012-06-07T15:56:01.620
> 
> 标签：java, android, windows

我需要在我的 android 应用程序中找到一些特定谷歌搜索的结果链接。请任何人帮助我找到一种方法来做到这一点。我只需要谷歌搜索的链接。如果有人发布一些示例代码，它将对我非常有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T05:08:47.530

我想不出你只需要链接的原因..只需在 webview 中打开搜索页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T06:59:17.047

您可以编写一个 PHP curl 程序来捕获生成的网页，然后使用一些正则表达式从结果页面中获取链接。

# c# - 将 WebService 添加到 Silverlight (3.0) 时引用不明确？

> ID：10935427
> 
> 赞同：2
> 
> 时间：2012-06-07T15:56:23.373
> 
> 标签：c#, silverlight, silverlight-3.0

当我添加我的 WebService 时，我开始收到所有这些错误：

**'Stream' 是 'System.IO.Stream' 和 'MultiSelectFileUploader.ServiceReference.Stream' 之间的模糊引用**

当我所拥有的只是 GetFiles() 时，这并没有发生。我可以继续将我的 Streams 更改为 System.IO.Stream，但是当我尝试传递给 UploadFiles() 时，我得到它不是 ServiceReference.Stream 的错误。感谢您的帮助。

这是我的网络服务...

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.IO;

namespace MultiSelectFileUploader.Web
{
    /// <summary>
    /// Summary description for FileService
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class FileService : System.Web.Services.WebService
    {

        [WebMethod]
        public List<string> GetFiles()
        {
            List<string> l = new List<string>();

            foreach (FileInfo fi in (new DirectoryInfo(Server.MapPath("~/Temp/")).GetFiles()))
                l.Add(fi.Name);

            return l;
        }

        [WebMethod]
        public void UploadFiles(string filename, Stream file)
        {
            string filepath = AppDomain.CurrentDomain.BaseDirectory + @"Temp\";

            if (!Directory.Exists(filepath)) { Directory.CreateDirectory(filepath); }

            WriteFile(file, File.Create(Context.Server.MapPath("~/Temp/" + filename)));
        }

        private void WriteFile(Stream stream, FileStream fs)
        {
            int bytesRead;
            byte[] buffer = new byte[4096];

            while ((bytesRead = stream.Read(buffer, 0, buffer.Length)) != 0)
                fs.Write(buffer, 0, bytesRead);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:11:59.277

ASMX 服务不支持流式传输。您必须使用 WCF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:06:51.260

听起来您有两个名为 Stream 的类，位于两个命名空间中，位于单独的程序集 (DLL) 中。

如果您需要在同一个 C# 类中使用两个名为 Stream 的类，则最好完全限定使用它们的类名（还有其他方法，但恕我直言，这是最干净的）。

您`isn't a ServiceReference.Stream`大概是因为您将某处的声明更改为`System.IO.Stream`实际上`MultiSelectFileUploader.ServiceReference.Stream`预期的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:08:35.667

由于您有两个不同的版本`Stream`（一个 in`System.IO`和一个 in `MultiSelectFileUploader.ServiceReference`），因此您需要有一种区分它们的方法。

此外，您现在遇到的错误是因为您没有在`MultiSelectFileUploader.ServiceReference`任何地方使用命名空间，所以您的代码不知道一个`MultiSelectFileUploader.ServiceReference.Stream`类。

我建议为`System.IO`and使用别名`MultiSelectFileUploader.ServiceReference`，如下所示：

```
using IO = System.IO;
using Uploader = MultiSelectFileUploader.ServiceReference; 
```

然后使用别名指定您正在使用的流，如下所示（假设这是您使用 MultiSelectFileUploader.ServiceReference.Stream 类的地方）：

```
private void WriteFile(Uploader.Stream stream, FileStream fs)
{
    ...
} 
```

它之前没有发生的原因是 GetFiles 没有明确引用 Stream 类。

# iphone - Xcode：使用 CoreData 进行故事板

> ID：10935429
> 
> 赞同：2
> 
> 时间：2012-06-07T15:56:30.667
> 
> 标签：iphone, ios, core-data, storyboard, nsmanagedobject

[下载我的源码供参考！](https://www.dropbox.com/s/97fzpnxu3ej0giv/SafetyCulture.zip)

我是 iOS 开发的新手，我正在尝试自学...我需要一些帮助

首先，切换到“安全文化主视图”时出现错误... ![故事板](../Images/e26334fce0fe773457898a8d01d321fb.png)

> 2012-06-07 11:50:54.720 SafetyCulture[1777:fb03] *** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“+entityForName：找不到实体名称“事件”的 NSManagedObjectModel

我不知道如何解决这个...

其次，我想通过两步过程创建记录……在“问题……”VC 上，我希望用户回答大约 20 个问题——但它们的格式都相同，所以我不需要额外的xib，对吗？所以当谈到最后一个问题时，我希望“下一步”按钮说“完成”或“保存”......应该很简单吗？

我渴望使用 Xcode 站起来……如果您需要更多信息，请告诉我，我会尽力而为！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:23:50.677

如果您在现有项目中添加核心数据，请按照此链接[添加核心数据现有 iPhone 项目中的说明进行操作](http://wiresareobsolete.com/wordpress/2009/12/adding-core-data-existing-iphone-projects/)

对于第二个问题：您不需要添加更多视图，只需使用 UIScrollView 并根据需要扩展它即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T20:08:22.483

我追踪了引发异常的代码：

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:self.managedObjectContext]; 
```

在您的方法`- (NSFetchedResultsController *)fetchedResultsController`中，同名属性的自定义设置器，如果不存在则初始化一个。真正的问题是`self.managedObjectContext`目前为零。在您的代码中，没有任何地方是分配了 managedObjectContext 的主视图控制器。

最简单的方法是从 AppDelegate 中获取它，以这种方式

```
#import "safetyCultureAppDelegate.h" //this needs to be at the top to make sure the compiler knows what you’re on about.
...
self.managedObjectContext = [(safetyCultureAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext]; //put this in the viewDidLoad, or wherever you can set it when the Master VC is created. 
```

使用断点很容易解决，我敦促您学习如何使用断点，因为它们对于此类可重现的错误非常有用。

至于你的第二个问题，有上百万种方法可以剥这只猫的皮。创建一堆场景并在它们之间进行push segues并给它们一个共享的“问题类”并没有错。它看起来很漂亮，并且不会涉及太多代码。性能不会是问题。

也就是说，如果您想以编程方式执行此操作，请使用 NSDictionaries 的 NSArray，每个 dict 包含一个问题和可能的答案，并对控制器进行编程以在向后或向前点击时从数组中加载它们，记住保存。如果问题是静态的，我真的强烈建议您使用故事板方法。远不那么繁琐。

Breakpoints 和 segues 都很好，但是现在我敦促你冲杯咖啡，买些饼干，并阅读[Core Data Programming Guide](http://developer.apple.com/library/ios/documentation/cocoa/Conceptual/CoreData/CoreData.pdf)的封面。您会发现 Apple 的文档非常易于访问。

如果您对此真的很陌生，请遵循[此建议。](https://stackoverflow.com/a/6488745/929581)它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:44:23.320

我不相信这是一个故事板问题。您的视图控制器需要设置核心数据堆栈。检查调用的代码`entityForName:`是否设置有效`NSManagedObjectContext`。

Core Data 堆栈是 Core Data 需要运行的一些对象。在使用 Core Data 创建的标准 Xcode 模板中，这些对象在 Application Delegate 中设置。

如果您愿意，Core Data 的“基本单元”是 NSManagedObject。您在建模工具中建模实体，然后使用 Xcode 从模型生成类。那些生成的类是 NSManagedObjectObject 的子类。

您通常与 NSManagedObjectContext 进行交互。NSManagedObjectContext 就像一个“便签本”，您可以在其中对 NSManagedObjects 进行更改。上下文是应用程序委托设置的核心数据堆栈的顶部。

当您在 Xcode 中创建新项目时，系统会提示您输入一些信息，包括是否使用 Core Data。如果您选中该框，Xcode 将设置您的*持久存储协调*器和您的*托管对象上下文*。这就是你的核心数据堆栈的基础。

通常，您可能会传递对应用程序委托的托管对象上下文的引用。（你不能从多个线程访问同一个上下文。核心数据和多线程是一个单独的章节。）然后，每当你实例化一个新对象时，你就将它直接插入到托管对象上下文中。

要保存，请在上下文中调用 save。

# java - 通过空指针中途终止 char[] -> 字符串转换

> ID：10935430
> 
> 赞同：5
> 
> 时间：2012-06-07T15:56:34.043
> 
> 标签：java, string, null

我正在尝试在 Java中复制[它。](http://en.wikipedia.org/wiki/Character_string#Null-terminated)为了节省您的点击，它表示字符数组`['F', 'R', 'A', 'N', 'K', NULL, 'k', 'e', 'f', 'w']`在转换为以空字符结尾的字符串时，将在 之后停止`'K'`，因为它在那里遇到空指针。但是，我的 Java 尝试似乎没有奏效。

```
public class TerminatingStrings{
    public static void main(String[] args){
        char[] broken = new char[3];
        broken[0] = 'a';
        broken[1] = '\u0000';
        broken[2] = 'c';
        String s = new String(broken);
        System.out.println(s);
    }
} 
```

仍然打印`ac`。除此之外，我还尝试过 (1) 不初始化`broken[1]`和 (2) 将其显式设置为 null，甚至没有编译。

这在Java中是否可能？还是我对事物的理解是错误的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T15:58:17.070

与 C 不同，Java 不使用以 NUL 结尾的字符串。要获得这种行为，您的代码必须在 char 数组中找到第一个位置`\0`，并在构造字符串时停在那里。

# facebook - 使用facebook登录认证访问网站

> ID：10935431
> 
> 赞同：1
> 
> 时间：2012-06-07T15:56:37.430
> 
> 标签：facebook, facebook-graph-api

代替网站内置登录表单，我使用`Facebook`登录来获取用户身份验证，然后他们可以浏览我网站上的所有其他页面。

我的问题是如何存储用户权限，以便在所有页面中，我的网站识别当前用户是经过身份验证的用户？

Facebook SDK 中是否有任何功能提供这些功能，或者我应该使用基本的 PHP 功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:36:01.270

SDK 本身并没有为您提供这种存储数据的方法。你必须自己做这件事。有自己的编程组件可以为您管理这些。它将用户的 access_token 存储在数据库中。这可以通过ajax直接完成。您可以请求用户权限并将数据存储在数据库中......一步！

看看[http://www.facebook.com/pages/Helper-Component-Community/222933037808340?sk=app_412923142052609](http://www.facebook.com/pages/Helper-Component-Community/222933037808340?sk=app_412923142052609)

# hibernate - 我可以在 Play 上记录 hibernate 的 DDL 代码吗？启动？

> ID：10935432
> 
> 赞同：1
> 
> 时间：2012-06-07T15:56:38.880
> 
> 标签：hibernate, playframework, ddl, playframework-1.x

我们的应用程序是在 Java over Play 上开发的！1.2.4。我们将 JPA over Hibernate 用于我们的 ORM。

根据 Play! 的默认配置，我们的开发环境将 DDL 设置为 false，而 prod 环境将其设置为 true。

到目前为止，数据库中的更改要求我们编写 SQL 脚本以在生产环境中运行，方法是：a）知道发生了什么变化，并将其添加到脚本文件中，或者 b）手动检查数据库以编写增量代码。

如果我们能获得 Hibernate 执行的所有 DDL 操作的日志，那就太好了，省去了打字和手动验证。

我在 Play 上找不到任何有关此的信息！或休眠文档。

我试过在 application.conf 上设置它，但没有运气：

```
jpa.debugSQL=true 
```

我可以看到 Select 操作，但没有 DDL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T10:10:32.917

Hibernate 有几个可以在 log4j.properties 中设置的日志类别。如果您不使用 log4j.properties，请按照[此处](http://www.playframework.org/documentation/1.2.5/logs#anamelevelsConfigureloglevelsa)所述创建一个。

然后你需要一个休眠日志类别的列表，你可以在[这里](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/session-configuration.html#configuration-logging)找到它们。

例如，如果您想记录 DDL 语句，您应该将以下行添加到 log4j.properties 文件中：

```
# Log all SQL DDL statements as they are executed
log4j.logger.org.hibernate.tool.hbm2ddl=trace 
```

此外，您可能会发现 jpa.ddl 参数很有用，请参阅 Play 文档了解更多信息。

# javascript - 从显示中排除字符？

> ID：10935433
> 
> 赞同：2
> 
> 时间：2012-06-07T15:56:39.567
> 
> 标签：javascript, html, vbulletin

我想排除字符在 vbulletin 模板中的显示。

例如，如果用户写：

```
"[Hello World] How are you?" 
```

我想排除所有里面的“[”和“]”，所以它只显示：

```
"How are you?" 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:17:56.040

使用 JavaScript 字符串操作 .getIndexOf() 和 .substring()。获取第一个括号的位置，获取第二个括号的位置，将字符串拆分为 3 个子字符串，中间部分位于两个索引值之间，然后将第一个和第三个子字符串相加。像这样：

```
var string = "[Hello World] How are you?";
var bracket1 = string.getIndexOf("[");
var bracket2 = string.getIndexOf("]");
var substring1 = string.substring(0,bracket1);
var substring2 = string.substring(bracket1,bracket2);
var substring3 = string.substring(bracket2,string.length);
var solution = substring 1 + " " + substring 3; 
```

至少，这是一个概念。一切可能都不对，但您可以稍微调整一下数字以使其完美。

或者，如果您不需要担心 [] 之前的内容，只需使用 .split()：

```
 var string = "[Hello World] How are you?";
 var solutionArray = string.split("]");
 var solution = solutionArray[1]; 
```

希望这可以帮助！

# spring - 使用来自不同捆绑包的资源

> ID：10935437
> 
> 赞同：1
> 
> 时间：2012-06-07T15:56:51.227
> 
> 标签：spring, resources, osgi, spring-dm

我在 Virgo 上的 SpringDM 中加载文件时遇到问题。原因当然是我，我做错了什么。

情况是这样的：bundleA 包含一个类来执行一些通用初始化（用通用配置文件中的数据填充表）。

bundleB 包含来自 bundleA 的初始化类的更具体版本（扩展）（在 spring 文件中，我还指定来自 bundleA 的类是 bundleB 中更专门的类的父类）

bundleC 是一个 web 包，调用 bundleB（依次调用 bundleA）

但是，bundleB/bundleA 似乎找不到配置文件。我得到 java.io.FileNotFound 异常（文件不存在）。

我将 bundleA 中的配置文件定义为类路径资源：

```
<bean id="myBeanId" class="org.springframework.core.io.ClassPathResource">
    <constructor-arg>
        <value>configfile.cfg</value>
    </constructor-arg>
</bean> 
```

bean 被创建并注入到带有 Autowired 注释的初始化类中。但是，一旦我尝试使用该文件，就会出现异常。

我的方法有任何“一般”缺陷吗？我应该使用其他资源加载器吗？还有其他建议吗？

如果部分问题不清楚，请告诉我，我会尽力澄清......

谢谢！

# javascript - 带有无效标签的 JSONP 调用

> ID：10935438
> 
> 赞同：2
> 
> 时间：2012-06-07T15:56:53.997
> 
> 标签：javascript, jquery, jsonp

我正在尝试对 api 进行 JSONP 调用，但我不确定 API 是否支持 JSONP，不知道如何测试。但下面显示了无效标签的萤火虫控制台错误。这是否意味着 api 不支持 JSONP 是不是我的电话有问题。

这是我对 api 的调用。我更改了网址，因为客户不乐意我提供网址

```
 jQuery.getJSON("http://blaa.blaa.com/api/services?format=js&callback=?",
    function (data) {
        console.log("services data = ", data);
    }); 
```

当我在**firebug**中测试时，我得到了这个无效的标签

```
{"services":{"service":[{"name":"tt"...

servic...2711124 (line 1, col 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:01:23.760

`Invalid label`是当您期望作为 JSONP 内容（即 Javascript 代码）提供的内容实际上是 JSON 内容时您将得到的错误。

这不是有效的 Javascript，即使它是一个 JSON 对象：

```
{'foo' : 'bar'} 
```

这是因为`{`被视为[块](https://developer.mozilla.org/en/JavaScript/Reference/Statements/block)的开头，而不是对象文字。`'foo'`然后被视为尝试创建[label](https://developer.mozilla.org/en/JavaScript/Reference/Statements/label)，其中包含周围的引号是无效的。

这本质上是一条神秘的消息，告诉您服务器不理解 JSONP，或者您没有正确请求它（有些服务器要求提供超出标准的额外参数`callback=`）。

# jakarta-ee - Java EE 的 Netbeans 教程中的 NullPointerException

> ID：10935439
> 
> 赞同：1
> 
> 时间：2012-06-07T15:56:56.197
> 
> 标签：jakarta-ee, glassfish-3, netbeans-7, netbeans-6.9

我尝试按照[Netbeans 电子商务教程](http://netbeans.org/kb/docs/javaee/ecommerce/intro.html)来熟悉 Netbeans。我用的是Netbeans 7.0，教程推荐Netbeans 6.8-6.9。通常改编很容易（显示的元素顺序不同，或者有更多字段）。

该教程在第三章中指出：“[确保取消选择'Enable Contexts and Dependency Injection'选项。](http://netbeans.org/kb/docs/javaee/ecommerce/setup-dev-environ.html) ”

对于[第 7 章](http://netbeans.org/kb/docs/javaee/ecommerce/entity-session.html)，我根据第 7 章的内容对其进行了改编，特别是在以下代码中添加了以下代码`ControllerServlet`：

```
@EJB
private CategoryFacade categoryFacade;

public void init() throws ServletException {

    // store category list in servlet context
    getServletContext().setAttribute("categories", categoryFacade.findAll()); // line 37
} 
```

当他们说要运行它时，我尝试运行它，并且`NullPointerException`在第 37 行收到一条消息。第 37 行是上面编写的 init 方法中的实际代码。异常发生在服务器端，所以我猜在某个时候，编写教程的人改变了主意并激活了 CDI。我试图添加一个假人`beans.xml`来解决这个问题，但没有成功。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="
      http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">
</beans> 
```

在此之后，我下载了提供的代码并从他们的“断点”（文件 AffableBean_snapshot3.zip）重新完成工作，我得到了相同的`NullPointerException`. 在本教程的这一部分 (AffableBean_snapshot4.zip) 之后，我还采用了项目的版本，但它仍然在完全相同的点上失败。

那么，我做错了什么？我真的应该使用 Netbeans 6.9 而不是 7.0 吗？`sun-*`唯一显着的区别是Netbeans 6.9 和`glassfish-*`Netbeans 7.0中的一些 xml 文件的文件名。

# java - Android XML 布局错误

> ID：10935441
> 
> 赞同：0
> 
> 时间：2012-06-07T15:57:12.350
> 
> 标签：java, android, eclipse

我有一个 XML 布局，它有一个谷歌地图、两个文本视图和一个相对布局的按钮。文本视图位于谷歌地图下方，当用户在地图上移动光标时，文本值“纬度：”和“经度：”更新为“纬度：xxx”和“经度”xxx”。提交按钮说“提交”并做到这一点，它将纬度/经度打包到一个意图中并将其传递给下一个活动。

这一切都很好，直到我开始弄乱布局。我注意到，因为我一直在 eclipse 中懒惰地使用图形设计工具，所以所有东西都有设置尺寸，这意味着在更大的屏幕上它看起来很傻。

我添加了另一个相对布局并将纬度/经度文本和提交按钮放入其中，并将新布局放置在另一个现在只有 MapView 的相对布局下。

我的意图是使用 android:layout_weight 将底部相对布局分配在底部屏幕的 15% 左右，而屏幕的其余部分将是谷歌地图。

物理尺寸很好。但是，如果我的 textviews 完全依赖于提交按钮（android:layout_above/below），则提交按钮的文本将采用依赖于它的 textview 的值并得到更新，而 textview 将停留在“lat /long:" 并且不会更新。

我目前在相对布局的顶部设置了文本视图，在底部设置了独立的提交按钮，它工作正常。我只是好奇到底发生了什么。

这是我的xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="80" >

    <com.google.android.maps.MapView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:apiKey="xxx"
        android:clickable="true"
        android:enabled="true" >
    </com.google.android.maps.MapView>
</RelativeLayout>

<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="20" >

    <TextView
        android:id="@+id/Latitude"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Latitude:" />

    <TextView
        android:id="@+id/Longitude"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/Latitude"
        android:text="Longitude:" />

    <Button
        android:id="@+id/submitbutton"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:onClick="GOTOUPLOADER"
        android:text="Submit" />

</RelativeLayout> 
```

这是唯一（我认为）适用于此 xml 文件的相关代码。请注意，我没有对此处的按钮文本做任何事情。它甚至不是这个类的一个属性。按钮与此类的唯一交互是它在单击时调用一个方法来启动另一个活动。

```
 //setupmap()instantiates mapview and centers on the given location
public void setupmap()
    {
        getcoords();//setup coordinates
        lattext.setText("Latitude: "+String.valueOf(Lat));
        lontext.setText("Longitude: "+String.valueOf(Long));
        mapView = (MapView) findViewById(R.id.mapView);//instantiate mapview
        mapView.setBuiltInZoomControls(true);//able to zoom
        mcontrol = mapView.getController();//mapcontroller contains methods to manipulate mapview
        mcontrol.animateTo(point);//zoom to our geopoint
        mcontrol.setZoom(19);//zoom level 1-21\. 1=world view, 21=as zoomed in as possible
        MyOverlay over = new MyOverlay();//instantiate overlay
        listofoverlays = mapView.getOverlays();//create a list of overlays
        listofoverlays.clear();//clear list
        listofoverlays.add(over);//add our overlay
        mapView.invalidate();//invalidate for changes to take effect
    }//setupmap 
```

请原谅所有的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:19:43.787

好的，我仍然不确定我是否完全理解您的问题，但开始尝试解决此问题：

我在这里所做的是获取您的代码并将关系定位放回其上。请注意，如果您将一个对象与另一个对象相关联，则必须将要引用的对象放在被引用的对象下方。这是因为`id`在使用 .java 声明之前不在生成的 R.java 中`android:id=@+id/object`。在这种情况下，如果您想将一个对象声明为`above`另一个对象，那么我们从下往上构建。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:baselineAligned="false"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="80" >

        <com.google.android.maps.MapView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/mapView"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:apiKey="xxx"
            android:clickable="true"
            android:enabled="true" >
        </com.google.android.maps.MapView>
    </RelativeLayout>

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="20" >

        <Button
            android:id="@+id/submitbutton"
            style="?android:attr/buttonStyleSmall"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:text="Submit" />

        <TextView
            android:id="@+id/Longitude"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_above="@id/submitbutton"
            android:text="Longitude:" />

        <TextView
            android:id="@+id/Latitude"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@id/Longitude"
            android:layout_alignParentLeft="true"
            android:text="Latitude:" />
    </RelativeLayout>

</LinearLayout> 
```

编辑：

从你的例子来看，你的问题似乎出在你的 java.util 中。你如何呼吁`TextView`使用`setText`你的节目？

请参见下面的示例：

```
TextView lattext = (TextView)findViewById(R.id.Latitude); 
lattext.setText("Latitude: " + String.valueOf(Lat));

// And

TextView lontext= (TextView)findViewById(R.id.Longitude);
// Avoid using "Long", Long is reserved... If I am unsure of whether text is reserved
// I will always place my initials in front of it... i.e. "String.valueOf(jjLong));"
lontext.setText("Latitude: " + String.valueOf(Lon)); 
```

# powershell - 使用 Format-Table 中的 PowerShell 表达式，我的表现力如何？

> ID：10935450
> 
> 赞同：1
> 
> 时间：2012-06-07T15:57:47.803
> 
> 标签：powershell

我有以下脚本输出用户 Exchange 邮箱的颜色编码文件夹层次结构。如果超过某个阈值（在这种情况下为 20 MB），它将以红色输出该行，如果不是，则以灰色输出。

```
#Get Folder Size Breakdown to Table with Color Coding
get-mailbox $username |
Get-MailboxFolderStatistics |
ft @{
        Name="Name"
        Expression=
        {
            $prefix=""
            foreach($c in $_.FolderPath.ToCharArray())
            {
                if($c -eq '/'){$prefix+='-'}
            }
            if($_.FolderSize -gt 20MB)
            {
                $Host.UI.RawUI.ForegroundColor = "Red"
            } else
            { 
                $Host.UI.RawUI.ForegroundColor = "Gray"
            }
            $prefix + $_.Name
        }
    },
    FolderSize,
    FolderandSubfolderSize 
```

这个脚本有一些问题。

如果最后处理的文件夹大于 20 MB，我的控制台文本在运行后仍为红色。此脚本假定原始控制台文本为灰色。如果不是灰色，那么我已经更改了用户的控制台文本。如果您不在表达式的上下文中，这两个问题都很容易解决`format-table`，但是我一生都无法弄清楚在这种特殊情况下是否可以解决这些问题。这是我尝试过的要点，但它不起作用。（实际上我已经尝试了大约 20 种不同的变体）。

```
get-mailbox $username |
Get-MailboxFolderStatistics |
ft @{
        Name="Name"
        Expression=
        {
            $prefix=""
            $originalColor = $Host.UI.RawUI.ForegroundColor
            foreach($c in $_.FolderPath.ToCharArray())
            {
                if($c -eq '/'){$prefix+='-'}
            }
            if($_.FolderSize -gt 20MB)
            {
                $Host.UI.RawUI.ForegroundColor = "Red"
            }
            $prefix + $_.Name
            $Host.UI.RawUI.ForegroundColor = $originalColor
        }
    },
    FolderSize,
    FolderandSubfolderSize 
```

注意：这样做的目的是最终将其压缩为单线。我知道我可以在启动管道之前存储变量并在管道完成后恢复颜色，但这会带来乐趣/恶化。我更好奇是否可以在不改变此管道的基本结构的情况下完成此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T22:15:27.937

我不认为这是可能的。本质上，每次读取前景色`Format-Table`的表达式都会改变。`Name`但`Format-Table`可能不会立即从该表达式中写出值，因此您无法重置表达式中的颜色。

我认为你将不得不包装你的管道：

```
$originalColor = $Host.UI.RawUI.ForegroundColor

get-mailbox $username |
Get-MailboxFolderStatistics |
ft @{
        Name="Name"
        Expression=
        {
            $prefix = " " * (($_.FolderPath -split '/').Length)
            $Host.UI.RawUI.ForegroundColor = if($_.FolderSize -gt 20MB) { "Red" } else { $originalColor }
            $prefix + $_.Name
        }
    },
    FolderSize,
    FolderandSubfolderSize

$Host.UI.RawUI.ForegroundColor = $originalColor 
```

另一种选择是编写自己的格式化代码，找出每列的最大大小，然后`Write-Host`用来写出东西：

```
$stats = get-mailbox $username |
    Get-MailboxFolderStatistics |

$nameMaxWidth = 0
$sizeMaxWidth = 0
$subFolderSizeMaxWidth = 0
$stats | ForEach-Object {

    if( $_.Name.Length -gt $nameMaxWidth )
    {
        $nameMaxWidth = $_.Name.Length + (($_.FolderPath -split '/').Length - 1)
    }

    $sizeWidth = $_.FolderSize.ToString().Length
    if( $sizeWidth -gt $sizeMaxWidth )
    {
        $sizeMaxWidth = $sizeWidth
    }

    $subSizeWidth = $_.FolderAndSubFolderSize.ToString().Length
    if( $subSizeWidth -gt $subFolderSizeMaxWidth )
    {
        $subFolderSizeMaxWidth = $subSizeWidth
    }
}

$stats | ForEach-Object {
    $colorParam = @{ }
    if( $_.FolderSize -gt 20MB )
    {
        $colorParam.ForegroundColor = 'Red'
    }

    $prefix = ' ' * (($_.FolderPath -split '/').Length - 1)
    Write-Host ("{0}{1,$nameMaxWidth}" -f $prefix,$_.Name) -NoNewLine @colorParam
    Write-Host "  " -NoNewline
    Write-Host ("{0,-$sizeMaxWidth}" -f $_.FolderSize) -NoNewLine
    Write-Host "  " -NoNewLine
    Write-Host ("{0,-$subFolderSizeMaxWidth}" -f $_.FolderAndSubFolderSize)
} 
```

# jquery - 单击 jQuery 选项卡时文本输入窃取焦点

> ID：10935451
> 
> 赞同：0
> 
> 时间：2012-06-07T15:57:49.217
> 
> 标签：jquery, tabs, focus

我正在构建一个围绕 jQuery 选项卡构建的 Web 界面，其中第一个选项卡包含一个文本输入，可用作通过其他选项卡快速搜索。***我希望文本框在选择第一个选项卡后立即获得焦点***，以便用户可以尽快开始输入。

目前我正在尝试使用该`tabsselect`事件来绑定焦点窃取功能，但似乎我错过了一些东西。

我当前的代码：

```
$("#usertabs").tabs().bind("tabsselect",function( event, ui){
    if(ui.index == 0){
        alert('fire');
        $('#barcodeselect').focus();
    }
}); 
```

当我单击第一个选项卡时，会弹出警报，一旦我关闭它，就会显示第一个选项卡，但是`textbox`没有焦点。

`$('#barcodeselect').focus();`从 a调用`console`确实有预期的效果，所以它不应该是一个错字或类似的东西..

是不是标签的更改会从 中窃取焦点`textbox`？如果是这样，有没有办法绑定标签更改正在***完成***而不是***开始***？还是我只是健忘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:21:55.950

您应该使用`tabsshow`而不是`tabsselect`.

单击选项卡时会发生选项卡选择（这样您就可以取消返回 false 的选项卡更改）。

选项卡显示发生在选项卡最终被选中并显示时。

# javascript - 如何确定某物是否是 HTML 颜色名称之一，而无需检查每一个？

> ID：10935454
> 
> 赞同：0
> 
> 时间：2012-06-07T15:57:57.220
> 
> 标签：javascript, html, colors

我有一个来自 texarea 的字符串，现在我想知道该字符串是否是[此处](http://www.w3schools.com/html/html_colornames.asp)的 HTML 颜色名称之一）。我知道我可以简单地将我的字符串与每个字符串进行比较，但这会占用相当多的空间并且不是很好。有没有像 iscolorname(color) 这样的函数？还是我不会检查每一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:00:53.887

这个问题提供了一些部分答案：[Javascript function to convert color names to hex codes](https://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes)

一个完整的：您可以简单地创建一个内存画布并执行以下操作：

```
if (suspectedColor.indexOf('(')>=0 || suspectedColor.indexOf('#')>=0) {
   // see http://www.w3.org/TR/2dcontext/#dom-context-2d-fillstyle
   isColorName = false;
} else {
    context.fillStyle = suspectedColor;
    isColorName = context.fillStyle!="#000000" ; // ok, I let as an exercice the check that colorName isn't black
} 
```

它的工作原理是这样的：

> 语境 。fillStyle [ = value ] 返回用于填充形状的当前样式。
> 
> 可以设置，改变填充样式。
> 
> 样式可以是包含 CSS 颜色的字符串，也可以是 CanvasGradient 或 CanvasPattern 对象。**无效值将被忽略。**

（来自[http://www.w3.org/TR/2dcontext/#dom-context-2d-fillstyle](http://www.w3.org/TR/2dcontext/#dom-context-2d-fillstyle)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:01:07.773

您可以尝试设置颜色并将其读回。除了 IE 之外的浏览器会忽略无效颜色，如果您设置了无效属性，较旧的 IE 会抛出一个错误，您可以捕捉到该错误。

（如果经常使用，请改用对象测试。）

```
function validColor(cstring){
    var check= false, dummy= document.createElement('span');
    try{
        dummy.style.color= cstring;
        return !!dummy.style.color;
    }
    catch(er){
        return false;
    }
    finally{
        dummy= null;
    }
}
validColor('reddish') 
```

# visual-studio - 实体数据模型向导在 vs 2012 中未显示 Microsoft SQL Server Compact 3.5

> ID：10935457
> 
> 赞同：1
> 
> 时间：2012-06-07T15:58:01.730
> 
> 标签：visual-studio, sql-server-ce

我有 SQL Compact 3.5 版本，我正在尝试使用实体数据模型向导为其生成一个 EDMX 文件。我正在使用 Visual Studio 2012 Beta Ultimate。

我正在尝试生成一个模型（从数据库生成）。我创建一个新连接，选择更改数据源。在这里，我看不到*Microsoft SQL Server Compact 3.5*数据库文件。

但我可以在 VS 2010 中看到这一点。

如何使用 SQL CE 3.5 和 Visual Studio 2012 创建实体模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:03:31.780

VS 2012 中的服务器资源管理器等不支持 SQL Server Compact 3.5。

**更新**最新版本的免费 SQL Server Compact Toolbox 插件增加了对将 SQL Server Compact 3.5 文件连接到服务器资源管理器以使用实体框架工具的支持

# c# - 按照 mm.ss 格式将 INT 转换为十进制

> ID：10935459
> 
> 赞同：3
> 
> 时间：2012-06-07T15:58:06.493
> 
> 标签：c#, math, type-conversion

我可能在这里真的很愚蠢，但我的大脑已经一片空白。

我有一个滑块（它使用 Int32 值），但我想用它来选择音乐歌曲中的位置（mm.ss）

我还想将滑块显示的值输出到其上方的标签中，以便更容易查看滑块的设置。

有人有什么建议吗？

我想尝试将 int 值转换为小数，然后除以 60。

顺便说一句，我在 C# 中这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:01:11.510

`int`值代表什么？如果是歌曲的秒数，您应该使用：

```
TimeSpan time = TimeSpan.FromSeconds(seconds);
string text = time.ToString(@"mm\.ss"); 
```

使用 a`decimal`将是一个非常糟糕的主意 - 具有秒数的格式与小数分钟数不同。例如，*作为分数的*10.50 分钟是 10 分 30 秒，而不是 10 分 50 秒，据我所知，这就是你想要的。

`TimeSpan`是在 .NET 中表示持续时间的*自然*方式......这就是为什么它支持[以分钟和秒为单位格式化](http://msdn.microsoft.com/en-us/library/ee372287.aspx)的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:02:02.467

将其转换为十进制不会以您想要的方式显示它。例如，四分半钟将显示为 4:50，而不是 4:30。

将时间分为分钟和秒，并格式化它们：

```
int minutes = time / 60;
int seconds = time % 60;
string formatted = minutes.ToString() + ":" + seconds.ToString("00"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:02:28.870

您应该在内部将歌曲的长度表示为秒（可以保存在 int 中）。要实际显示它，您`song_length / 60`需要获取分钟（这称为整数除法，它返回结果并丢弃分数，例如`100/60 = 1`）。

之后，您可以通过`song_length % 60`(`%`是模运算符) 获得秒数。

编辑：没有看到 c# 标签。Jon Skeet 的答案在 c# 中更合适。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T23:16:19.660

**编辑**：我误解了问题的范围，但我会留下这个以防万一。

1.  以秒为单位存储曲目的总长度。
2.  将滑块的位置计算为最大可能滑块值的一部分。
3.  将轨道长度（以秒为单位）乘以在 2）中获得的小数值。这以秒为单位给出了从轨道开始的偏移量。
4.  格式化 3) 中的值以进行显示。

下面是一个人为的例子来说明这个过程：

```
int maxSliderValue = 100;
int sliderValue = 18;
int trackLengthInSeconds = 248;

float sliderFraction = ((float)sliderValue)/((float)maxSliderValue);
int offsetInSeconds = Convert.ToInt32(Math.Floor(trackLengthInSeconds * sliderFraction));
TimeSpan offset = TimeSpan.FromSeconds(offsetInSeconds);
string displayValue = offset.ToString(@"mm\.ss"); 
```

# grails - 在为 Grails 应用程序编写 Geb/Spock 测试时，您将如何封装用户的登录操作，以便可以在测试中重用它？

> ID：10935470
> 
> 赞同：1
> 
> 时间：2012-06-07T15:58:36.897
> 
> 标签：grails, groovy, functional-testing, spock, geb

我开始用 Geb 和 Spock 编写功能测试。我为我的应用程序的登录写了一些简单的，但现在，我想封装登录过程，以便我可以测试需要身份验证的页面。

你会怎么做？

提前致谢。

另外，我找不到一个谷歌小组来发布这个问题，有 Geb/Spock 问题的人去哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:41:11.440

我找到了一篇很棒的博客文章，回答了我的问题：

[封装页面状态和动作](http://adhockery.blogspot.com/2010/11/encapsulating-page-state-and-actions-in.html)

作者超越了我最初的用例，还演示了如何围绕分页模块封装和重用测试代码。

# ruby - 更改上游独角兽忙时Nginx返回的状态码

> ID：10935471
> 
> 赞同：5
> 
> 时间：2012-06-07T15:58:37.703
> 
> 标签：ruby, nginx, unicorn

我在独角兽面前使用 Nginx。当应用程序处于高负载并且所有独角兽工作者都忙时，nginx 将返回一个 502 响应，说明网关配置错误。我可以接受这种行为，但在这种情况下，我希望 nginx 返回一个 503 响应代码（服务器忙，稍后再试），这是一个更合适的响应。

我看到了这个答案： [Is it possible to change the HTTP status code returned when proxy_pass gateway is down in nginx?](https://stackoverflow.com/questions/8237761/is-it-possible-to-change-the-http-status-code-returned-when-proxy-pass-gateway-i)

其中描述了如何重写从上游代理返回的一些状态码：

```
location / {
    proxy_pass http://backend;
    proxy_intercept_errors on;
    error_page 502 503 504 =503 @proxyisdown; # always reply with 503
}

location @proxyisdown {
    add_header Retry-After 500;
    index my_pretty_error_page.html; 
} 
```

但这有两个问题：

1.  上游应用程序有时会针对应保留的有效情况返回 502 响应代码
2.  我不相信上游代理实际上返回了这个错误的状态码，更可能的是 nginx 无法将项目放在（tcp？）缓冲区上，然后 nginx 返回误导性的状态码。

在这种情况下，有什么方法可以控制 nginx 返回的状态码，使其变为 503 而不是 502？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:08:31.277

您是否考虑过使用后端服务器解决这个问题？调整后端服务器接受的客户端数量，以便对它的请求通常成功或失败，并且不会陷入返回 503 的糖蜜状态。理想情况下，您将能够调整后端服务器当可用客户端用完时返回 503，而 Nginx 将在后端服务器实际关闭时继续返回 502。

# java - EclipseLink/JPA：指定字节数组的长度

> ID：10935472
> 
> 赞同：1
> 
> 时间：2012-06-07T15:58:45.900
> 
> 标签：java, sql, jpa, orm, eclipselink

我有以下定义：

```
@Column(name = "password", length = 80)
byte[] password; 
```

当我使用 EclipseLink 创建表（mysql）时，我得到一个带有`longblob`. 一个`tinyblob`就够了。

我如何指定长度？

我知道我可以添加一个`columnDefinition`，但我想让它与数据库/sql 无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T08:53:45.670

如果您想要 blob 列的特定类型，则应使用 columnDefinition。长度的问题是它仅适用于字符串。这在[API](http://docs.oracle.com/javaee/5/api/javax/persistence/Column.html#length%28%29)中也有说明。

# xcode - 无论旋转如何，iPad 启动图像都是倒置的（纵向），仅适用于横向应用程序

> ID：10935480
> 
> 赞同：1
> 
> 时间：2012-06-07T15:59:17.453
> 
> 标签：xcode, ipad, launch, universal

我正在开发一个通用应用程序。我的部署目标是 5.1 我希望它只在 iPhone/iPod 上运行纵向，在 iPad 上只运行横向。

我正在使用 iPhone 和 iPad 模拟器以及最新版本的 iPod touch 和 iPad 进行测试。

它在 iPhone 上按预期工作。纵向启动图像首先出现，然后应用程序启动。没问题。它在模拟器和我的 iPod 上运行良好。无论旋转如何，应用程序都会按预期启动并继续纵向运行（底部主页按钮）。

它在 iPad 模拟器中正常工作。横向启动图像出现，然后应用程序以横向启动。无论旋转如何，启动图像和应用程序都会按预期以横向方式启动和运行。

但是，在我的 iPad 上，无论 iPad 以哪种方式旋转，纵向启动图像都会以纵向倒置显示。当我从项目中删除 Default-Portrait~ipad.png 和 Default-Portrait@2x~ipad.png 文件时，XCode 将它们替换为适用于 iPhone 而非 iPad 的 Default.png 和 Default@2x.png , 并且哪个也发射倒置。

我的 InfoPlist 包括以下设置： 初始界面方向：纵向（底部主页按钮）（初始界面方向没有键~ipad） 支持的界面方向：纵向（底部主页按钮） 支持的界面方向~ipad：横向（左主页按钮）横向（右主页按钮）

我尝试将初始界面方向更改为横向，并尝试完全删除该键。两者都没有改变它的运行方式。

我现在已经尝试了我能想到的一切来完成这项工作。有人有解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T17:07:22.467

好的，我终于解决了这个问题。对我来说，这似乎是 XCode 中的一个错误，但我应该抓住它。

我将所有图像文件都放在“支持文件”文件夹中。这对我的音乐文件或大多数图像文件来说都不是问题。然而，当谈到我的 Default-Landscape~ipad.png 和 Default-Landscape@2x~ipad 文件时，XCode 并不喜欢它。

我已将这些文件拖到摘要页面上的相应框中，并且它们被接受了。然后我将它们从顶级文件夹移动到“支持文件”文件夹——就像我对 iPhone 的 Default.png 和 Default@2x.png 文件所做的那样。

当我构建应用程序时，我没有收到任何错误。当我运行该应用程序时，我没有收到任何警告。

但是，这就是我出错的地方。我直到游戏后期才使用 Profiler 运行该应用程序，显然即使我这样做了，我也一定忽略了这两个警告。最后，我注意到了它们：在顶级应用程序包装器下找不到 Info.plist 中指定的图标：Default-Landscape~ipad.png。我对 Default-Landscape@2x~ipad.png 有同样的警告。

所以，我从我的项目中删除了这两个文件。然后我将它们拖到摘要页面上各自的框中，就像我之前所做的那样。但是这次我没有从顶部项目文件夹中移动文件。我跑了一个清洁。然后我运行了应用程序。

它已修复。

希望这对其他人有帮助。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-10T17:59:33.663

我有一个类似的问题，并且能够通过将 plist 文件中支持的方向的顺序更改为 [0]:LandscapeRight 和 [1]:LandscapeLeft 来解决这个问题

# r - R中的滑动FFT

> ID：10935481
> 
> 赞同：8
> 
> 时间：2012-06-07T15:59:18.923
> 
> 标签：r, fft

R中是否有用于计算样本滑动FFT的函数或包？我的意思是，给定 的输出`fft(x[n:m])`，有效地计算`fft(x[1+(n:m)])`。

理想情况下，我会找到一个在线版本（一开始我无法访问完整的时间序列，或者它太大而无法放入内存，我不会尝试将整个运行的 FFT 保存在内存）和批处理版本（我给它整个样本`x`并告诉它正在运行的窗口宽度`w`，从而产生一个复杂的维度矩阵`c(w,length(x)/w)`）。

此处介绍了这种算法的一个示例（但我从未尝试过用任何语言实现它）：

[http://cnx.org/content/m12029/latest/](http://cnx.org/content/m12029/latest/)

如果 R 中不存在这样的东西，我猜这看起来并不难实现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T19:47:46.113

就像我在这里发布东西时通常发生的那样，我一直在努力并想出了一个解决方案：

```
fft.up <- function(x1, xn, prev) {
  b <- length(prev)
  vec <- exp(2i*pi*seq.int(0,b-1)/b)
  (prev - x1 + xn) * vec
}

# Test it out
x <- runif(6)
all.equal(fft.up(x[1], x[6], fft(x[1:5])), fft(x[2:6]))
# [1] TRUE 
```

仍然有兴趣知道某些图书馆是否提供此功能，因为那样它也可能提供其他方便的东西。=) 但是现在我的问题已经解决了。

# django - 共享主机上的 Django 和乘客设置

> ID：10935486
> 
> 赞同：2
> 
> 时间：2012-06-07T15:59:36.570
> 
> 标签：django, passenger, virtualenv, dreamhost

我正在尝试在共享托管服务提供商 Dreamhost 上设置 Django。在为 Django 项目提供服务时，会使用Passenger WSGI。这适用于 Dreamhost 的默认 python，但无法在我的 virtualenv 中找到模块。

我将passenger_wsgi.py 更改为包括：

```
INTERP = "/home/<username>/.pythonbrew/venvs/Python-2.7.3/<venv>/bin/python"
if sys.executable != INTERP: os.execl(INTERP, INTERP, *sys.argv) 
```

（如[http://wiki.dreamhost.com/Passenger_WSGI](http://wiki.dreamhost.com/Passenger_WSGI)中所述）

这会以一般的内部服务器错误破坏站点。我的 Dreamhost 日志文件没有提供太多额外帮助：脚本头过早结束：internal_error.html。

如何配置Passenger 以查找安装在我的virtualenv 中的Python 模块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T03:29:20.337

更改 INTERP 后，尝试在 sys.path 上添加 virtualenv 站点包。

```
import sys
sys.path.insert(0, '/path/to/venv/site-packages') 
```

这是和我一起工作

# jquery - Jquery在点击时按值升序/降序对div进行排序

> ID：10935491
> 
> 赞同：1
> 
> 时间：2012-06-07T16:00:04.457
> 
> 标签：jquery, sorting

所以我有一些带有文本值的 div，还有一些带有数值的 div，它们的排序如下：

```
<div id="Test1">
        <div class="likelyOddHeader">
            <div class="likelyOddA">Test1</div>
            <div class="likelyOddB"><img src="img here"/></div>
            <div class="timeZone">West</div>
        </div>
        <div class="hidden">
                <div class="weight">127</div>
                <div class="values">Value5: Value here. <br />
                                                DbValue5: 1234, DbValue6, 123456</div>
                <div class="overrides">Overrides: 0</div>
        </div>
    </div>
    <div id="Test2">
        <div class="likelyEvenHeader">
            <div class="likelyEvenA">Test2</div>
                            <div class="img here"/></div>
            <div class="timeZone">East</div>
        </div>
        <div class="hidden">
                <div class="weight">124</div>
                <div class="values">  Value5: Value here. <br />
                                    DbValue5: 1234, DbValue6, 123456</div>
                <div class="overrides">Overrides: 0</div>
        </div>
    </div> 
```

我希望按重量、名称和时区名称进行排序。有人可以帮我解决这个问题吗？

# sql - 动态 SQL - 组合 2 个表

> ID：10935493
> 
> 赞同：0
> 
> 时间：2012-06-07T16:00:08.437
> 
> 标签：sql

在我的活动表中，我有列 - Activity、ActivityBaseTable、FieldName

```
**Activity**    **ActivityBaseTable**    **FieldName**
Task            TaskBase                 CreatedOn
Task            TaskBase                 ModifiedOn 
```

我需要一个 sql 语句，比如 -

```
select Activity, ActivityBaseTable, FieldName, MIN([Date field], MAX([Date field])
from Activities 
```

最小和最大日期字段将是 -

```
select min(CreatedOn), Max(CreatedOn)
from TaskBase 
```

或者

```
select min(ModifiedOn), Max(ModifiedOn)
from TaskBase 
```

这可以写成一个陈述吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:59:22.490

您可能不会喜欢这个作为**答案**，但是如果您可以修改您的数据模型以不在列中使用表名，那将是**更**可取的。请[在此处](http://www.sommarskog.se/dynamic_sql.html)查看该主题的精彩摘要。当我读到你有`dozens of rows with different base ActivityBaseTables`. 我不知道这是一个好主意的设计。

根据您的 RDBMS，此站点上有很多示例以及其他有关如何编写存储过程（这可能是您需要的）来执行此操作的示例。

**我只是恳求您更改数据模型并完全避免这种情况。**

# regex - 从字符串中的特定字符串模式中提取数字

> ID：10935496
> 
> 赞同：0
> 
> 时间：2012-06-07T16:00:21.563
> 
> 标签：regex, bash

我正在使用 bash 遍历文件名，并且需要一种方法来从由前一个字符表示的字符串中提取特定数字。本质上，所有文件都有一部分名称看起来像`D01`或`D02`。一个示例文件名是`Build-asdasdasd.D01V02.dat`. 我正在尝试使用 sed，但到目前为止无济于事。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:37:56.163

纯重击：

```
name='Build-asdasdasd.D01V02.dat'

[[ "$name" =~ \.(D[[:digit:]]{2}[[:upper:]][[:digit:]]{2})\. ]] \
   && number="${BASH_REMATCH[1]}" || number=''

echo  "'$number'" 
```

回声显示

```
'D01V02' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:23:10.133

你的问题很不清楚。如果你想要 后面的数字`D`，你可以使用

```
f="Build-asdasdasd.D01V02.dat"
num=$(grep -Po '(?<=D)\d\d' <<< "$f") 
```

或者

```
num=$(sed 's/^.*D\([[:digit:]][[:digit:]]\).*/\1/' <<< "$f") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:18:09.247

这是另一个纯 bash 答案，假设您的文件名始终与示例相似。不需要正则表达式。

```
name='Build-asdasdasd.D01V02.dat'
number="${name%.*}"
number="${name##*.}"
echo "$number" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:07:50.657

您不必在一个表达式中完成所有操作。您可以构建管道，如下所示：

```
echo 'Build-asdasdasd.D01V02.dat' |
egrep -o '\.D([[:digit:]]{2}[^.]+)' |
sed 's/^.//' 
```

这`D01V02`会为我返回，但您可能希望针对更广泛的语料库测试您的表达，以查看是否存在任何边缘情况。

# click - Slidesjs 不会使幻灯片可点击

> ID：10935500
> 
> 赞同：1
> 
> 时间：2012-06-07T16:00:35.990
> 
> 标签：click, slider

我已将 Slidesjs 滑块嵌入到我的网站中。我试图了解如何使幻灯片可点击，因为即使我将 img 元素包装在锚元素中，点击似乎也无法正常工作。

```
<div id="slides">
    <div class="slides_container">
        <div><a href="#"><img src="img/slider/slide1.png" alt="Slide #1"></a></div>
        <div><a href="#"><img src="img/slider/slide2.png" alt="Slide #2"></a></div>
        <div><a href="#"><img src="img/slider/slide3.png" alt="Slide #3"></a></div>
        <div><a href="#"><img src="img/slider/slide4.png" alt="Slide #4"></a></div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T03:01:29.980

我遇到了同样的问题，它是 slidesLoaded 函数中的“底部”参数。我变了

```
 slidesLoaded: function() {
      $('.caption').animate({
        bottom:0
      },200);
    } 
```

至

```
 slidesLoaded: function() {
      $('.caption').animate({
        bottom:-200
      },200);
    } 
```

它有效。

因此，我的最终脚本的高度为 270px 幻灯片，如下所示。

```
 animationStart: function(current){
      $('.caption').animate({
        bottom:-270
      },100);
    },
    animationComplete: function(current){
      $('.caption').animate({
        bottom:-230
      },200);
    },
    slidesLoaded: function() {
      $('.caption').animate({
        bottom:-230
      },20);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-03T03:31:32.247

这只是 z-index 问题，在幻灯片 div 中设置最高 z-index 并将位置设置为相对如下，您的链接现在就可以了。

```
<div id="slides" style="z-index:9999999; position:relative;">
<div class="slides_container">
    <div><a href="#"><img src="img/slider/slide1.png" alt="Slide #1"></a></div>
    <div><a href="#"><img src="img/slider/slide2.png" alt="Slide #2"></a></div>
    <div><a href="#"><img src="img/slider/slide3.png" alt="Slide #3"></a></div>
    <div><a href="#"><img src="img/slider/slide4.png" alt="Slide #4"></a></div>
</div></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:34:49.243

在此示例中，每张幻灯片在单击时都指向外部网页：http: [//slidesjs.com/examples/images-with-captions/](http://slidesjs.com/examples/images-with-captions/)

也许您可以尝试根据此示例调整您的代码。

# jquery - .load() 使用 Var 来自另一个 html 文档的 div

> ID：10935505
> 
> 赞同：1
> 
> 时间：2012-06-07T16:00:53.980
> 
> 标签：jquery, ajax, variables

我正在尝试加载一个通过单击选择的 Div，我从中保存 txt，以便它可以显示想要的。

我如何告诉 jquery 加载哪个 div？这是代码。

```
$('li').click(function(){
        var selected = $(this).text().toLowerCase();
        var thisone = $ ('#'+ selected);
        $('#inhere').load('secondcontent.html thisone');
        $(thisone).slideDown(200);
        $(thisone).addClass('online');
        $('.bubble').fadeIn(900).delay(2000).hide(200);
    });
    $('.close_pseudo').click(function(){
        $('.online').slideUp(200).removeClass('online');
        $('.bubble').hide();

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:03:51.213

您可能是这里类似 PHP 思维的受害者。你需要像这样指向一个特定的 div：

```
var selected = $(this).text().toLowerCase();
var thisone = '#'+selected;
$('#inhere').load('secondcontent.html '+ thisone); 
```

# c# - GoblinXNA：更改屏幕分辨率时出现异常

> ID：10935506
> 
> 赞同：0
> 
> 时间：2012-06-07T16:00:54.213
> 
> 标签：c#, xna

我在我的 GoblinXNA 程序中遇到了一个问题，即屏幕分辨率，如果我使用 480*640 一切都很好并且我的应用程序运行良好

```
captureDevice.InitVideoCapture(0, FrameRate._60Hz, Resolution._640x480,
                ImageFormat.R8G8B8_24, false); 
```

但如果我将其更改为 800x600 或 1280x1024，如下所示：

```
captureDevice.InitVideoCapture(0, FrameRate._60Hz, Resolution._800x600, ImageFormat.R8G8B8_24, false); 
```

我有一个例外

```
GoblinXNA.GoblinException was unhandled
  Message=Could not start video stream
Could not setup graph
Error HRESULT E_FAIL has been returned from a call to a COM component.
  Source=GoblinXNA
  StackTrace:
       at GoblinXNA.Device.Capture.DirectShowCapture.StartupVideo(UCOMIMoniker mon) in C:\GoblinXNAv4.0\src\Device\Capture\DirectShowCapture.cs:line 576
       at GoblinXNA.Device.Capture.DirectShowCapture.InitVideoCapture(Int32 videoDeviceID, FrameRate framerate, Resolution resolution, ImageFormat format, Boolean grayscale) in C:\GoblinXNAv4.0\src\Device\Capture\DirectShowCapture.cs:line 276
       at Se.HInitialize(Scene scene) in C:\Se\H.cs:line 119
       at Se.App.Initialize() in C:\Se\App.cs:line 96
       at Microsoft.Xna.Framework.Game.RunGame(Boolean useBlockingRun)
       at Microsoft.Xna.Framework.Game.Run()
       at Se.Program.Main(String[] args) in C:\Se\Program.cs:line 15
  InnerException: 
```

知道如何解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:29:38.067

我设法通过将 DirectShowCapture.cs 中的分辨率更改为 1280x720 并重新编译 GoblinXNA.dll 来解决问题

# symfony - 无法使用 Symfony2 功能测试设置 Content-Type

> ID：10935508
> 
> 赞同：5
> 
> 时间：2012-06-07T16:01:03.650
> 
> 标签：symfony, functional-testing

我正在测试一个 RESTful API，需要测试应用程序是否正确解析传入的数据。传入数据的类型可以是 XML 或 JSON 格式。应用程序查看标头中的 Content-Type 值以确定如何处理数据。

该应用程序运行良好，但我无法在 Symfony2 中为其编写适当的功能测试，因为在调用 URL 时我似乎无法设置 Content-Type。

我正在做这样的事情：

```
$crawler = $client->request('PUT','/api/record/, array("data" => $xmlData), array(), array("Content-Type" => "text/xml")); 
```

虽然它没有抛出任何错误，但我的应用程序无法获取它。我使用 Firefox 的“海报”插件以及 cUrl 成功地测试了我的脚本。

任何帮助/想法将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T22:22:34.470

从我在[Symfony2 测试部分](http://symfony.com/doc/current/book/testing.html)（它使用`Crawler`并`Client`与应用程序交互）中看到的内容来看，您应该将它作为`'CONTENT_TYPE' => 'application/xml'`. 所以你应该尝试以下方法：

```
$crawler = $client->request('PUT','/api/record/', array("data" => $xmlData), array(), array('CONTENT_TYPE' => 'application/xml')); 
```

请注意，我将其从 更改`text/xml`为`application/xml`，但两者都应该工作。

# adobe - Photoshop 到 PDF 的桥接：文本质量下降

> ID：10935511
> 
> 赞同：-1
> 
> 时间：2012-06-07T16:01:14.760
> 
> 标签：adobe, photoshop

我有一个在 Photoshop 中设计的文本文档，全是文本，但是当我保存图像然后使用 Bridge 将它们导出为 PDF 时，文本质量不清晰并且文本周围包含模糊。无法找到正确的导出设置来解决此问题。![在此处输入图像描述](../Images/e11a44d7df8b26f058e6c7da05ee64ac.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:56:43.443

Photoshop 不适用于创建包含大量文本的 PDF，因为它旨在处理光栅图像而不是矢量。如果您可以访问 Illustrator，我建议您改用它。

也就是说，这个问题似乎至少是半相关的，你可能会发现它很有用：

[将 Photoshop 文档另存为 .pdf 会导致图像模糊/像素化](https://stackoverflow.com/questions/578303/saving-a-photoshop-document-as-a-pdf-results-in-blurry-pixelated-images)

# affiliate - 在 mixpanel 中跟踪附属公司

> ID：10935514
> 
> 赞同：0
> 
> 时间：2012-06-07T16:01:33.817
> 
> 标签：affiliate, mixpanel

尝试使用 mixpanel 建立一个基本的会员跟踪系统。

通过分段系统设置推荐链接和跟踪事件没有问题，但是我希望能够将某个事件归因于推荐者，即使该事件是在以后的会话中触发的（例如标准会员计划的经典 30 天 cookie ）。

有人知道该怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T19:47:03.073

听起来你想要一个[超级财产](https://mixpanel.com/docs/properties-or-segments/how-do-i-set-a-property-every-time)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T06:14:31.807

基于 raylu 的回答，您当然想要一个超级属性：[我如何每次都设置一个属性？](https://mixpanel.com/docs/properties-or-segments/how-do-i-set-a-property-every-time)

对于附属公司，您可能只想计算第一个附属公司，以便您使用`register_once`：[https ://mixpanel.com/docs/integration-libraries/javascript-full-api#register_once](https://mixpanel.com/docs/integration-libraries/javascript-full-api#register_once)

# python - wxPython 非阻塞 GUI 线程和多处理？

> ID：10935515
> 
> 赞同：1
> 
> 时间：2012-06-07T16:01:38.967
> 
> 标签：python, multithreading, wxpython, multiprocessing, nonblocking

Python 2.7.3 x64 wxPython 2.8 x64

读了很多关于 python 线程和多处理的文章，特别是 Doug Hellmann 的一些文章，这些文章帮助很大。但是，我对一件事感到困惑......

我*认为*Python 多处理模块或多或少是线程模块的替代品，除了 args 必须是可腌制的，但我发现为了不阻塞我的 GUI，我必须首先创建一个新线程使用threading.Thread，然后使用multiprocessing.Process 在该线程中进行多进程。这行得通，而且效果很好，但对我来说似乎有点笨拙。

如果我尝试在没有第一个线程的情况下直接进行多处理，那么我的 GUI 仍然会阻塞，直到多处理作业完成。这是按设计工作，还是我错过了多处理模块的一些基本内容？

如果需要示例，我可以提供。

谢谢，

-RMW混沌

要求一个例子...

假设 onProcess() 是由 GUI 中的按钮触发的，这会阻止 GUI...

```
import time
import multiprocessing as mp

def myWorker(a, b):
    time.sleep(0.1)
    print '{} * {} = {}'.format(a, b, a*b)

def onProcess(event):
    jobs = mp.cpu_count() * 2
    a = 5
    b = 10

    for job in range(jobs):
        mp.Process(target = myWorker, args = (a, b,)).start() 
```

虽然这不...

```
import time
import multiprocessing as mp
import threading as th

def myWorker(a, b):
    time.sleep(0.1)
    print '{} * {} = {}'.format(a, b, a*b)

def onProcess(event):
    a = 5
    b = 10
    th.Thread(target = myThread, args = [a, b,]).start()

def myThread(a, b):
    jobs = mp.cpu_count() * 2

    for job in range(jobs):
        mp.Process(target = myWorker, args = (a, b,)).start() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:19:54.937

多线程和多处理是根本不同的。

线程大部分用于 i/o。当您创建一个新线程时，它包含在与您生成该线程的程序相同的进程中。这意味着它与程序共享内存空间，但它们（程序和线程）不能并行运行（还要查找 GIL）。

另一方面，多处理在操作系统级别产生了一个新进程。这个新进程可以与预先存在的进程并行运行，但它不与生成它的程序共享内存空间。当您要加速的代码与 i/o 无关，而是实际的处理器密集型计算时，这会更有用。

对于 gui，您通常希望对 gui 的不同部分使用线程，以便在 gui 的一个部分中运行某些东西不会锁定整个 gui，直到处理结束。

没有代码很难说，但我相信你不应该特别需要在新线程中产生一个进程，而只是让那个线程处理处理。但是，如果该线程需要处理密集计算类型的处理而不是大量 i/o，那么您将需要启动一个进程来处理它。

我相信您的大部分问题在于误解了多处理与多线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:28:47.100

我尝试在以下测试程序中运行您的代码，并且多处理工作正常，没有任何内容被阻止：

```
import time
import multiprocessing as mp
import wx

def myWorker(a, b):
    time.sleep(10)
    print '{} * {} = {}'.format(a, b, a*b)

def onProcess(event):
    jobs = mp.cpu_count() * 2
    a = 5
    b = 10

    for job in range(jobs):
        mp.Process(target = myWorker, args = (a, b,)).start()

def onGUI(event):
    print 'GUI is not blocked'

class MyFrame(wx.Frame):
    def __init__(self, parent, id, title):
       wx.Frame.__init__(self, parent, id, title)
       buttons = []
       panel = wx.Panel(self, wx.ID_ANY)
       sizer = wx.BoxSizer(wx.VERTICAL)
       gui_proc_btn = wx.Button(panel, wx.ID_ANY, 'GUI Process')
       other_proc_btn = wx.Button(panel, wx.ID_ANY, 'Other process')

       gui_proc_btn.Bind(wx.EVT_BUTTON, onGUI)
       sizer.Add(gui_proc_btn, 0, wx.ALL, 5)
       other_proc_btn.Bind(wx.EVT_BUTTON, onProcess)
       sizer.Add(other_proc_btn, 0, wx.ALL, 5)
       panel.SetSizer(sizer)

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, 'test.py')
        frame.Show(True)
        self.SetTopWindow(frame)
        return True

if __name__ == '__main__':

    app = MyApp(0)
    app.MainLoop() 
```

从命令行运行它，按第二个按钮（这用于`multiprocessing`您的功能，我增加了睡眠时间），然后按第一个按钮。您应该注意到按下第一个按钮时会生成输出，因此程序不会被阻止。

# php - PHP ODBC 存储过程参数号无效

> ID：10935516
> 
> 赞同：4
> 
> 时间：2012-06-07T16:01:39.730
> 
> 标签：php, stored-procedures, odbc

我对这个 SQL/PHP/ODBC/FBI/TLA 等世界 100% 是全新的，所以如果我所问的内容非常基本，我深表歉意。

我正在使用一个存储过程，该过程使用邮政编码的经纬度数据库将中心邮政编码和给定的英里半径作为 2 个输入参数，然后返回该给定英里半径内的邮政编码数组。当我在我的 SQL 查看器中运行它时它工作得很好，但是当我尝试使用 php 来做同样的事情时，我只会得到无效的参数错误。

```
$connstr = "Driver={SQL Server};Server=MyServer;Database=MyDatabase;";
$conn = odbc_connect($connstr, "Name", "PW");

$query_string = " CALL FindZipCodeWithinRadius(?,?)  ";

$sp = odbc_prepare($conn, $query_string);
$zipcodes = odbc_execute($sp,array(" 14602, 35"));

print_r($zipcodes); 
```

当我像这样运行代码时，我收到错误“没有足够的参数（1 应该是 2）”

我在这些输入参数周围尝试了双引号/单引号的不同迭代，但它们要么给我上述错误，要么给我这个错误：

“SQL 错误：[Microsoft][ODBC SQL Server Driver]参数号无效，SQL 状态 S1093”

一个快速的谷歌搜索让我相信第二个错误意味着有太多的参数被读入 proc，那么我是如何在跳过所需的 2 时从 1 变为 many 的呢？

如果有区别的话，数据库就在 SQL 2000 上。

有任何想法吗？感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:08:16.813

```
$zipcodes = odbc_execute($sp,array(" 14602, 35")); 
```

应该

```
$zipcodes = odbc_execute($sp,array("14602", "35")); 
```

在您的执行中，您传递了 1 个数组值“14602, 35”，并且您准备好的语句正在寻找 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T07:45:27.043

```
Below is the Code to execute MS SQL Stored Procedure in PHP

$DBConnString="DRIVER={SQL Server};SERVER=localhost;DATABASE=ERPDev";
$DBUsername="sa";
$DBPswd="";
$DBConnect = odbc_connect($DBConnString, $DBUsername, $DBPswd);  

$Param1 = '2';
$query_string = "P_Test[$Param1]";
$ResultSet = odbc_prepare($DBConnect, $query_string);
odbc_execute($ResultSet);
// odbc_result_all($ResultSet);
while($obRows = odbc_fetch_object($ResultSet))
{
    print $obRows->UserId." - ";
    print $obRows->UserFirstName." - ";
    print $obRows->UserLastName."<br />";
}
odbc_free_result($ResultSet);
odbc_close($DBConnect); 
```

# html - 左下角为空的不规则 div

> ID：10935517
> 
> 赞同：0
> 
> 时间：2012-06-07T16:01:41.200
> 
> 标签：html, css

我想制作一个 div，我将在其中放置文本。div 应该是这样的：

```
qqqqqqqqqqqqq
qqqqqqqqqqqqq
qqqqqqqqqqqqq
qqqqqqqqqqqqq
qqqqqqqqqqqqq
qqqqqqqqqqqqq
  qqqqqqqqqqq
    qqqqqqqqq
      qqqqqqq
        qqqqq 
```

我不想在左下角看到文字，但`text-align: left;`它应该看起来像我的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:57:03.987

试试这样

的HTML

```
<div>
    <div>qqqqqqqqqqqqq</div>
    <div>qqqqqqqqqqqqq</div>
    <div>qqqqqqqqqqqqq</div>        
    <div>qqqqqqqqqqqqq</div>    
    <div>qqqqqqqqqqqqq</div>
    <div>qqqqqqqqqqqqq</div>
    <div>qqqqqqqqqqq</div>
    <div>qqqqqqqqq</div>    
    <div>qqqqqqq</div>
    <div>qqqqq</div>        
</div> 
```

CSS

```
div
{
text-align:right
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:54:02.217

使用此代码

**HTML**

```
<div class="div1">
qqqqqqqqqqqqq<br>
qqqqqqqqqqqqq<br>
qqqqqqqqqqqqq<br>
qqqqqqqqqqqqq<br>
qqqqqqqqqqqqq<br>
qqqqqqqqqqqqq<br>
qqqqqqqqqqq<br>
qqqqqqqqq<br>
qqqqqqq<br>
qqqqq<br>

</div> 
```

**CSS**

```
.div1{
width:150px;
height:200px;
background:#eaeaea;
text-align:right
} 
```

[在这里查看演示](http://jsfiddle.net/zXCZM/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:09:03.253

div 是矩形的。您要么需要使用`text-align: right;`, put nbsp's 来推动内容，要么使用其他 div 来填充该区域。

您的示例似乎非常适合，`text-align: right;`因为文本是正确的。

# python - python xlrd 字符串匹配

> ID：10935518
> 
> 赞同：3
> 
> 时间：2012-06-07T16:01:44.010
> 
> 标签：python, excel, xls, xlrd

我在 API 中找不到任何东西。有没有办法根据字符串匹配返回单元格的行号或坐标？例如：您给脚本一个字符串，它会扫描 .xls 文件，当它找到具有匹配字符串的单元格时，它会返回坐标或行号。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T16:13:26.530

```
for i in range(sheet.nrows):
     row = sheet.row_values(i)
     for j in range(len(row)):
          if row[j] == search_value:
                return i,j
return None 
```

类似的东西......只是一个基本的搜索

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-24T19:53:37.450

您可以尝试以下功能，谢谢 Joran

```
def look4_xlrd (search_value, sheet) :
lines = []
columns = []
for i in range (sheet.nrows) :
    row = sheet.row_values(i)
    for j in range(len(row)) :
        if row[j] == search_value :
            lines.append(i)
            columns.append(j)
    del row
return lines, columns 
```

# django - Django 函数问题和 urlconf 混淆

> ID：10935519
> 
> 赞同：0
> 
> 时间：2012-06-07T16:01:45.147
> 
> 标签：django, function, blogs, categories

我无法将我的问题放在一句话中。我正在按照教程从头开始制作博客。但该教程预测所有类别、标签、月份和年份列表都在单独的模板中。

我想在主博客页面上添加类别列表、月份和年份列表。

所以这就是我得到的。使用此代码，类别列表显示在主页中，但前提是您转到 blog/category url，而不仅仅是 blog/ 我想要的位置。

```
 **(r'^$', list),**
    (r'^archive/(\d{1,2})/$', list),
    (r'^\d{2}/d{4}/$', month),
    (r'^([0-9]{4}/\d{1,2})/(?P<slug>.*)/$', detail),
    (r'^(?P<year>\d{4})/$', year),
    **(r'^category/$', category),** 
```

我也试过：

```
 (r'^$', category), 
```

但没有运气。

这是 category.html 和 list.html 中模板中的相同代码：

```
 {% if categories %}
        {% for category in categories %}
        <li class="cat-item"><a href="category/{{ category.name.lower }}/"
            title="{{ category.name.capitalize }}">
             {{ category.name.capitalize }}</a>
         </li>
         {% endfor %}
         {% endif %} 
```

视图.py：

```
def category(request):
    return render_to_response('blog/list.html', {'categories':Category.objects.all(),},) 
```

就像这样。我试过这个，但在 def 列表中没有运气：

```
return render_to_response('blog/list.html',{'posts':posts,
                                       'next':next,
                                       'previous':previous,
                                       'categories':Category.objects.all(),
                                       },) 
```

我怎样才能让博客/类别上的内容也显示在博客/上？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:20:48.527

当您在浏览器中键入 url 时，请求将发送到您的服务器。Django 然后获取 url 并将其与 url 模式匹配以确定正确的视图。一旦找到视图，django 就会停止匹配并执行该视图，该视图又会返回响应。

如果您想在不同的视图中使用您的类别，您要么必须确保在每个视图中`categories`为模板提供相同的上下文变量，要么通常更好，[编写一个简单的自定义模板标签](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#inclusion-tags)。对于您的类别，这可能如下所示：

```
@register.inclusion_tag('blog/category_list.html')
def categories_list():
    return { 'categories': Category.objects.all() } 
```

在文件 'blog/categoy_list.html' 中将是当前在 'categories.html' 和 'list.html' 中的代码。在这些文件中将其替换为。

```
{% load your_blog_tags %}
{% categories_list %} 
```

您可以在任何需要类别列表的地方使用它。当然，这同样适用于年份和月份列表。

# java - 在 Jersey 客户端上获取 PUT 请求的状态

> ID：10935520
> 
> 赞同：5
> 
> 时间：2012-06-07T16:01:46.330
> 
> 标签：java, web-services, jersey

我在服务器端使用 Jersey 定义了一个 web 服务，如下所示：

```
@POST
@Consumes(MediaType.APPLICATION_XML)
@Path("/foo")
public Response bar(List<Foo> listFoo) {    
 try {
        //save the resource
        } catch (Exception e) {
        log.error("Error saving", e);
        return Response.status(Status.INTERNAL_SERVER_ERROR).build();
    }
    return Response.status(Status.OK).build();
} 
```

我正在尝试在我的 Jersey 客户端中获取服务器状态，如下所示：

```
Response response = ws.type(MediaType.APPLICATION_XML).post(Response.class,list); 
```

但我得到了错误：

```
A message body reader for Java class javax.ws.rs.core.Response, and Java type class javax.ws.rs.core.Response, and MIME media type application/xml was not found javax.ws.rs.core.Response 
```

我真的不需要 Response 对象，只需要状态码，我怎么能得到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T09:29:39.593

好的，我通过更改请求响应类型解决了它：

```
Response response = ws.type(MediaType.APPLICATION_XML).post(Response.class,list); 
```

和

```
ClientResponse response = ws.type(MediaType.APPLICATION_XML).post(ClientResponse.class,list); 
```

作为`ClientResponse`一个`com.sun.jersey.api.client.ClientResponse`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T07:49:49.740

为您的网络服务添加`@Consumes`注释并将参数添加到您的`bar()`方法，因为您试图将一些名为`list`.

我建议您`@POST`改用，因为规范`@PUT`不返回响应。

UPD。顺便说一句，您的实体为空 - 您最好删除您的`@Produces`注释并返回`Response`其状态集。

UPD2。`.accept(MediaType.APPLICATION_XML)`并从客户端删除方法。

# mongodb - 选择一个 mongodb 分片键

> ID：10935526
> 
> 赞同：1
> 
> 时间：2012-06-07T16:02:03.727
> 
> 标签：mongodb

我正在为我的应用程序启动数据存储服务。MongoDB 作为存储机制运行，我创建了 2 个分片来启动。

应用程序将存储事件数据，所有数据的结构如下：

```
{ 
  _id: '4fa2f7e25626cd1374000002', 
  created_at: '2012-05-03T21:25:54 00:00', 
  name: 'client_session_connect', 
  session_remote_id: '74ACF9AA-9E09-11E1-8C9E-8462380DA5E6', 
  zone_id: '74ACF9AA-9E09-11E1-8C9E-1231380DA5E6',
  additional: {
    some_other_key: 'value'
  }
} 
```

事件将有多种名称，任何新事件都可以随时使用新事件名称创建。系统中会有很多同名的事件。_id、created_at 和 name 将成为每个事件的一部分，但不保证其他值。

根据我所阅读的内容（[此处](http://www.mongodb.org/display/DOCS/Choosing+a+Shard+Key)和[此处](https://rads.stackoverflow.com/amzn/click/com/1449303218)），似乎最好的分片键是 { name: 1, created_at: 1 }。我的解释是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T20:58:07.007

从您所说的来看，这似乎是一个很好的分片键，但有一些注意事项：

- 分片键是不可变的，因此如果您需要更改文档的“名称”字段，则需要删除并重新插入它（可能这对您来说不是问题，除非您打算经常更改名称） .

- 如果您连续快速编写大量具有相同“名称”的文档，所有这些写入将转到同一个块，因为“created_at”可能是一个增加的字段。最终，该块将被拆分为多个块并在接收机器上平衡，因此如果您希望接收大量具有相同“名称”的文档写入，这只是一个问题。

- 如果“名称”不是均匀分布的，您可以对名称进行哈希处理并将结果存储在文档的新字段中，然后制作分片键 {hashedName : 1, created_at : 1}。这可能会提供更均匀的负载分布，从而减少以后的平衡量。不过，它确实为您的文档增加了一点复杂性。

假设您知道这些事情，{name: 1, created_at: 1} 很可能是最适合您的分片键。

# android - 带有表条目的数据库备份。

> ID：10935535
> 
> 赞同：1
> 
> 时间：2012-06-07T16:02:32.263
> 
> 标签：android, sqlite

我想备份一个数据库，我在谷歌上找到了似乎可以工作的代码，但它只备份了数据库结构，而不是数据库中的条目。

没有报告错误，以及如何将表格导出为 CSV 格式？

*备份数据库的代码：*

```
public void BackupDB() {
 InputStream myInput;

    try {

        myInput = new FileInputStream("/data/data/com.cecchina.mathew.lessonsDB/databases/Teaching");
        // Set the output folder on the SDcard
        File directory = new File("/mnt/sdcard/external_sd/TeachingBKup/");
        // Create the folder if it doesn't exist:
        if (!directory.exists()) 
        {
            directory.mkdirs();
        } 
        // Set the output file stream up:

        OutputStream myOutput = new FileOutputStream(directory.getPath()+ "/Teaching.backup");
        // Transfer bytes from the input file to the output file
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0)
        {
            myOutput.write(buffer, 0, length);
        }
        // Close and clear the streams
        myOutput.flush();

        myOutput.close();

        myInput.close();

    } catch (FileNotFoundException e) {
Toast.makeText(ourContext, "Backup Unsuccesfull file not found error!",          Toast.LENGTH_LONG).show();
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
Toast.makeText(ourContext, "Backup Unsuccesfull IO error!", Toast.LENGTH_LONG).show();
// TODO Auto-generated catch block
        e.printStackTrace();
    }
Toast.makeText(ourContext, "DataBase structure backed up!", Toast.LENGTH_LONG).show();

} 
```

建议我哪里欠缺？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:21:07.013

如果您在插入任何数据之前创建备份，那么您所得到的当然就是结构（正如您所说的那样）。

您的代码复制了一个完整的文件，因此如果数据库中有数据，则会将其复制到卡中。

我使用几乎相同的代码（从菜单项启动）在我的几个应用程序中执行备份。我也有恢复/导入的代码，当我这样做时，我的所有数据都在那里。

# design-patterns - 何时应在模态视图（或任何一般视图）中设置布局？

> ID：10935538
> 
> 赞同：0
> 
> 时间：2012-06-07T16:02:52.477
> 
> 标签：design-patterns, uiview, uiviewcontroller

我遇到了一个问题，表明我可能不正确地实现了设计模式。我有动态子视图，其大小取决于语言。当我呈现一个模态视图时，我在 viewDidLoad 期间设置了布局。我注意到 UILabel 对象没有正确显示，并发现问题在于 viewDidLoad 期间模态视图的大小与显示视图时的大小不同。

viewDidLoad 期间模态视图的宽度为 768。视图出现后，宽度为 540。

这表明我应该在 viewWillAppear 期间设置布局，而不是在 viewDidLoad 期间。

这似乎与我对 DRY 原则的理解相矛盾，如果我将其应用于执行，因为一旦加载视图，布局就不会改变，所以每次视图出现时我都会不必要地重复布局代码。（我知道在我的示例中，语言设置可以在模态演示之间更改，但可能还有其他示例不存在这种类型的动态。）

我以同样的方式在非模态视图中实现布局——在 viewDidLoad 中。

我应该以不同的方式做这件事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T05:22:37.487

假设视图不会改变是不正确的。例如，在改变方向时。在大多数情况下，通常在 viewDidLoad 中设置您的视图以及正确的自动调整大小掩码就足够了。如果您需要更好地控制视图调整大小时的设置，您应该覆盖 viewWillLayoutSubviews/viewDidLayoutSubviews，并在那里重新排列您的视图。因此，在 viewDidLoad 中，您将添加您的子视图并设置它们的内容，然后在布局中设置它们的大小和位置。

# python - Python语法错误：行继续字符后出现意外字符

> ID：10935545
> 
> 赞同：0
> 
> 时间：2012-06-07T16:03:12.090
> 
> 标签：python, newline, syntax-error

我刚刚开始使用python，所以很可能只是在做一些愚蠢的事情。我正在从表中读取数据，需要将它们放入 txt 文件的列中。我无法说服我的代码创建一个新行。

这是我的代码-

```
file = open("test_m.rdb")
table = open('table.txt', 'w+')

trash = file.readline()

trash = file.readline()

data = file.readline()
i = data.split()
flux = i[2]
observed = i[4]
table.write(flux + " " + observed,)

while 1:
    line = file.readline()
    i = line.split()
    try:
        flux = i[2]
        observed = i[4]
    except IndexError:
        break
    table.write(\nflux + " " + observed)
table.close() 
```

错误显示-

```
File "PlotRdbFile.py", line 24
    table.write(\nflux + " " + observed)
                                   ^
SyntaxError: unexpected character after line continuation character 
```

提前感谢您发现我的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:03:56.327

```
table.write(\nflux + " " + observed) 
```

应该

```
table.write("\n" + flux + " " + observed) 
```

或者

```
table.write("\n{} {}".format(flux, observed)) 
```

更多关于[format()](http://docs.python.org/library/string.html#format-string-syntax)的信息，如果你好奇的话。

# java - 默认情况下增加主键，因为记录是在数据库中输入的

> ID：10935547
> 
> 赞同：0
> 
> 时间：2012-06-07T16:03:12.837
> 
> 标签：java, jdbc

我正在做一个java程序，因为我正在创建我的第二个或第三个简单的jdbc程序，我在一个表中输入有关学生的信息，其中有四个字段，学生的姓名，城市和卷号由用户通过java程序（代码）手动添加，但我希望第四个字段id（主键，因此必须是唯一的）必须在添加完整记录期间自动生成，并且必须是值比表中存在的前一个 id 的值多一个......我怎么能这样做？我不太擅长 sql 查询..:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:23:29.870

你用的是哪个IDE？？？

```
 CREATE TABLE "student"
        (
        "stud_id" INT not null primary key
                GENERATED ALWAYS AS IDENTITY
                (START WITH 1, INCREMENT BY 1),   
        "NAME" VARCHAR(50),     
        "CITY" VARCHAR(50),
        "ROLL NO." INTEGER
        ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:07:39.187

它应该通过服务器（sql）端完成，尝试阅读有关自动增量的信息，例如[MySQL 自动增量](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)

是的，您还没有从 Java 端设置自动增量，例如，如果您的学生表有一些字段，如 id (auto_increment)、name 和 age，您应该从 java 端设置 name 和 age，id 将从 SQL 添加边。

# php - 保留 OnClick 的 Table Fixed Header 插件

> ID：10935548
> 
> 赞同：0
> 
> 时间：2012-06-07T16:03:13.823
> 
> 标签：php, javascript, jquery

我有一个用 PHP 动态构建的表。PHP 为每一行提供一个单击事件，该事件突出显示选定的行并在页面的另一部分显示与其相关的详细信息。

我希望这张表是可排序的，所以我开始使用它： [http ://tablesorter.com/docs/](http://tablesorter.com/docs/)

效果很好，它是可排序的，可选择的，而且速度适中。

我也开始研究固定标题并发现： [http ://www.tablefixedheader.com/](http://www.tablefixedheader.com/)

排序和固定标题。惊人的。

这适用于我想要的所有方式，但不幸的是它很慢并且摆脱了我为每个表行创建的 onClick 事件。

这是不可接受的，事实上，它从根本上破坏了我的应用程序。有没有更好的插件、防止这种情况的方法或更简单的解决方案？

我需要一个带有固定标题的可排序表，它允许我向每个表行添加唯一的 onClick 事件和 ID。而且我真的不想自己写...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:06:45.440

数据表改变了我的生活。 [http://datatables.net/index](http://datatables.net/index)

固定标头功能是“额外的”：[http ://datatables.net/extras/fixedheader/](http://datatables.net/extras/fixedheader/)

# c++ - 为什么 scanf 似乎跳过输入？

> ID：10935558
> 
> 赞同：5
> 
> 时间：2012-06-07T16:03:53.620
> 
> 标签：c++, c, io, scanf, cout

我对以下程序中 scanf 的行为感到困惑。scanf 似乎输入一次，然后不再输入，直到打印出字符流。

下面在一个 C 程序中

```
#include<stdio.h>
int main()
{
    int i, j=0;

    do
    {
        ++j;
        scanf("%d", &i);
        printf("\n\n%d %d\n\n", i, j);
    }
    while((i!=8) && (j<10));  

    printf("\nJ = %d\n", j);
    return 0;
} 
```

在这里，直到我输入任何整数程序都可以正常工作，但是当输入一个字符时，它会继续打印 i 的最后输入值并且永远不会停止（直到循环退出时 j 为 10），以便 scanf 接受下一个输入。

```
output::  
1    <-----1st input
1 1
2    <---- 2nd input
2 2
a    <---- character input
2 3  
2 4
2 5
2 6
2 7
2 8
2 9
2 10

J = 10 
```

同样的事情也在 c++ 中发生。

```
#include<iostream>
using namespace std;
int main()
{
    int i, j=0;

    do
    {
        ++j;
        cin>>i;
        cout<<i<<" "<<j<<"\n";
    }
    while((i!=8) && (j<10));

    cout<<"\nj = "<<j<<"\n";
}   

output of c++ program ::  
1     <-----1st input
1 1
2     <-----2nd input
2 2
a    <------ character input
0 3
0 4
0 5
0 6
0 7
0 8
0 9
0 10

j = 10 
```

c++ 中唯一的变化是打印 0 而不是最后一个值。

我知道这里程序需要整数值，但我想知道当输入字符代替整数时会发生什么？以上所有发生的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:10:15.453

当您输入 时`a`，则`cin >> i`无法读取它，因为 的类型`i`是`int`无法读取字符的。这意味着，`a`永远留在流中。

现在为什么`i`打印`0`是一个不同的故事。实际上它可以打印任何东西。`i`一旦尝试读取失败，就不会定义 的内容。类似的事情`scanf`也会发生。

正确的写法：

```
do
{
    ++j;
    if (!(cin>>i)) 
    {
       //handle error, maybe you want to break the loop here?
    }
    cout<<i<<" "<<j<<"\n";
}
while((i!=8) && (j<10)); 
```

或者简单地说（如果你想在发生错误时退出循环）：

```
int i = 0, j = 0;
while((i!=8) && (j<10) && ( cin >> i) )
{
    ++j;
    cout<<i<<" "<<j<<"\n";
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T16:12:29.820

如果`scanf`在输入流中看到与转换说明符不匹配的字符，它将停止转换并将有问题的字符留在输入流中。

有几种方法可以解决这个问题。一种是将所有内容读取为文本（使用`scanf`or`%s`转换`%[`说明符 or `fgets`），然后使用`atoi`or`strtol`进行转换（我的首选方法）。

`scanf`或者，您可以检查;的返回值 它将指示成功转换的次数。所以，如果`scanf("%d", &i);`等于 0，那么你就知道输入流中有一个坏字符。您可以使用它并重`getchar()`试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-07T16:11:50.693

你永远不能期望你的用户输入有效的东西。最佳做法是[将输入读入字符串并尝试将其转换为整数](http://www.cplusplus.com/reference/clibrary/cstdlib/atoi/)。[如果输入不是整数](http://rosettacode.org/wiki/Determine_if_a_string_is_numeric#C)，你可以给用户一个错误信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-07T16:12:47.353

问题是，当您输入不属于预期类型的​​输入（由`%d`for scanf 和 for 指定的`int`类型）时`cin>>i;`，输入流不高级，这导致两个操作都试图从完全相同的不正确的输入（这次也失败了），因此您永远不会要求其他输入。

为确保不会发生这种情况，您需要检查两个操作的返回值（阅读手册了解每个操作如何报告错误）。*如果确实*发生了错误（如输入字符时），您将需要清除错误，使用无效输入并重试。我发现在 C++ 中使用`std::gtline()`而不是`int`甚`std::string`至在交互式地从用户那里获取输入时读取整行会更好，因此您会进入您所经历的这个“无限”循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T16:12:49.973

您忽略了返回值。查看手册中的内容[`scanf(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/scanf.3.html)：

> **`RETURN VALUE`**
> `These functions return the number of input items successfully matched and assigned, which can be fewer than provided for, or even zero in the event of an early matching failure.`

它无法匹配整数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-07T16:13:31.347

对于`scanf`，您需要检查其返回值以查看输入的转换是否有效。`scanf`将返回成功扫描的元素数。如果转换不起作用，它会留下输入，您可以尝试不同的扫描，或者只是报告错误。例如：

```
if (scanf("%d", &i) != 1) {
    char buf[512];
    fgets(buf, sizeof(buf), stdin);
    printf("error in line %d: got %s", j, buf);
    return 0;
} 
```

在您的程序中，由于输入是单独的，因此您的循环会重复尝试读取相同的输入。

在 C++ 中，您使用该方法检查故障`fail`，但输入流故障状态是粘性的。所以它不会让你在不清除错误状态的情况下进一步扫描。

```
 std::cin >> i;
    if (std::cin.fail()) {
        std::string buf;
        std::cin.clear();
        std::getline(cin, buf);
        std::cout
             << "error in line " << j
             << ": got " << buf
             << std::endl;
        return 0;
    } 
```

在你的程序中，由于你从不清除失败状态，循环`cin`在失败状态下重复使用，所以它只是报告失败而不做任何事情。

在这两种情况下，如果您先读取输入行，然后尝试解析输入行，您可能会发现使用输入更容易或更可靠。在伪代码中：

```
while read_a_line succeeds
    parse_a_line 
```

在 C 中，读取一行的关键在于，如果它比缓冲区长，您将需要检查这一点并将多个`fgets`调用结果连接在一起以形成一行。而且，要解析一行，您可以使用`sscanf`，它类似于`scanf`但适用于字符串。

```
 if (sscanf(buf, "%d", &i) != 1) {
        printf("error in line %d: got %s", j, buf);
        return 0;
    } 
```

在 C++ 中，对于格式化输入的快速低级解析，我也更喜欢`sscanf`. 但是，如果您想使用流方法，您可以将`string`缓冲区转换为 a`istringstream`来扫描输入。

```
 std::getline(cin, buf);
    if (std::cin.fail()) {
        break;
    }
    std::istringstream buf_in(buf);
    buf_in >> i;
    if (buf_in.fail()) {
        std::cout << "error in line " << j
             << ": got " << buf
             << std::endl;
        return 0;
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-07T16:13:35.747

您可以检查返回值`scanf`以确定整数是否已正确解析（返回应该 = 1）。失败时，您有选择：要么通知用户错误并终止，要么通过读取下一个令牌（`scanf("%s" ...)`可能带有警告）来恢复。

# makefile - 如何跟踪 Makefile 目标以进行故障排除？

> ID：10935560
> 
> 赞同：26
> 
> 时间：2012-06-07T16:03:56.843
> 
> 标签：makefile, gnu-make

我们的构建系统中有一个又长又复杂的 Makefile。有没有一种好方法可以准确跟踪给定 make 调用执行了哪些目标？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-07T16:30:33.417

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:12:26.753

[ElectricMake](http://www.electric-cloud.com/products/electricaccelerator-dev.php) can generate an XML-marked-up version of your build log with lots of information that would help in this situation:

*   The full command-lines for all commands invoked during the build (even those that were marked as "silent" commands with the `@` modifier).
*   The origin (makefile and line number) of the commands invoked.
*   Runtime of the commands.
*   Dependency relationships between the targets in the build.
*   Structural relationship between targets and recursive makes in the build.
*   Files read/written by the commands invoked in the build.

Here's a sample of that output:

```
<job id="J0824ab08" thread="5e72bb0" node="linbuild1-2" type="rule" name="../../i686_Linux/testmain/testmain.d" file="../config/rules.mak" line="109">
<command line="110">
<argv>echo Rebuilding '../../i686_Linux/testmain/testmain.d'</argv>
<output src="prog">Rebuilding ../../i686_Linux/testmain/testmain.d
</output>
</command>
<command line="111-114">
<argv>set -e; g++ -MM -w  -DUSE_PROFILING -DUSE_LOGGING -DHAVE_UNIX -DHAVE_LINUX -I.. testmain.cpp \
        | sed 's!\(testmain\)\.o[ :]*!../../i686_Linux/testmain/\1.o '../../i686_Linux/testmain/testmain.d' : !g' \
        &gt; '../../i686_Linux/testmain/testmain.d'; \
        [ -s '../../i686_Linux/testmain/testmain.d' ] || touch '../../i686_Linux/testmain/testmain.d'</argv>
</command>
<opList>
<op type="read" file="/home/ericm/src/testmain/testmain.cpp"/>
<op type="read" file="/home/ericm/src/minidumper/ExceptionReport.h"/>
<op type="read" file="/home/ericm/src/util/ECAssert.h"/>
<op type="create" file="/home/ericm/i686_Linux/ecloud/testmain/testmain.d" found="0"/>
</opList>
<timing invoked="1.919926" completed="3.600491" node="linbuild1-2"/>
<waitingJobs idList="J0824ae38"/>
</job> 
```

[How to Quickly Navigate an Unfamiliar Makefile](http://www.electric-cloud.com/blog/2009/11/10/how-to-quickly-navigate-an-unfamiliar-makefile/) shows an example of using the annotated build log to find your way around a makefile.

[Data Mining ElectricAccelerator Annotation](http://www.electric-cloud.com/blog/2009/03/31/data-mining-electricaccelerator-annotation-bill-of-materials/) shows how you can use the annotated build log to generate a bill-of-materials for the build.

ElectricMake is GNU Make compatible, so it can process makefiles that work with GNU make.

*Disclaimer: I'm the architect and lead developer of ElectricAccelerator.*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-01-14T13:49:59.970

You can get some information about what targets are being built and why by redefining the SHELL variable in GNU make:

```
__ORIGINAL_SHELL:=$(SHELL)
SHELL=$(warning Building $@$(if $<, (from $<))$(if $?, ($? newer)))$(TIME) $(__ORIGINAL_SHELL) 
```

For example, in `trace-targets.mk`:

```
__ORIGINAL_SHELL:=$(SHELL)
SHELL=$(warning Building $@$(if $<, (from $<))$(if $?, ($? newer)))$(TIME) $(__ORIGINAL_SHELL)

all: aa.stamp ba.stamp

%.stamp:
    echo stamp > $(@)

stamp-clean:
    rm -vf *.stamp

clean: stamp-clean

.PHONY: %.phony
%.phony:
    echo $(@)

aa.stamp: ab.stamp
ab.stamp: ac.stamp

ba.stamp: bb.stamp
bb.stamp: bc.phony 
```

Running `trace-targets.mk` after clean:

```
$ make -f trace-targets.mk
trace-targets.mk:9: Building ac.stamp
echo stamp > ac.stamp
trace-targets.mk:9: Building ab.stamp (from ac.stamp) (ac.stamp newer)
echo stamp > ab.stamp
trace-targets.mk:9: Building aa.stamp (from ab.stamp) (ab.stamp newer)
echo stamp > aa.stamp
trace-targets.mk:18: Building bc.phony
echo bc.phony
bc.phony
trace-targets.mk:9: Building bb.stamp (from bc.phony) (bc.phony newer)
echo stamp > bb.stamp
trace-targets.mk:9: Building ba.stamp (from bb.stamp) (bb.stamp newer)
echo stamp > ba.stamp 
```

Then running `trace-targets.mk` again without cleaning:

```
$ make -f trace-targets.mk
trace-targets.mk:18: Building bc.phony
echo bc.phony
bc.phony
trace-targets.mk:9: Building bb.stamp (from bc.phony) (bc.phony newer)
echo stamp > bb.stamp
trace-targets.mk:9: Building ba.stamp (from bb.stamp) (bb.stamp newer)
echo stamp > ba.stamp 
```

* * *

Practically, what I do in my makefiles is I add this snippet:

```
ifneq ($(filter all targets,$(VERBOSE)),)
__ORIGINAL_SHELL:=$(SHELL)
SHELL=$(warning Building $@$(if $<, (from $<))$(if $?, ($? newer)))$(TIME) $(__ORIGINAL_SHELL)
endif 
```

Then I run my makefiles as follow to see the tracing:

```
make VERBOSE=all
# or
make VERBOSE=targets 
```

The reason for the all/targets is because I also have other verbose stuff like this:

```
ifneq ($(filter all vars,$(VERBOSE)),)
dump_var=$(info var $(1)=$($(1)))
dump_vars=$(foreach var,$(1),$(call dump_var,$(var)))
else
dump_var=
dump_vars=
endif

# used like

$(call dump_vars,SHELL VERBOSE) 
```

And sometimes I want to selectively enable/disable debugging aspects.

If you have many makefiles it may make sense to put this in a common file and include it from others.

* * *

Credit by [John Graham-Cumming](https://stackoverflow.com/users/3820355/john-graham-cumming) who described this method in [Tracing rule execution in GNU Make](https://www.cmcrossroads.com/article/tracing-rule-execution-gnu-make).

# c# - App closes with no infowhen drawing a line (in debug mode)

> ID：10935562
> 
> 赞同：1
> 
> 时间：2012-06-07T16:04:01.023
> 
> 标签：c#, windows-phone-7, xna, rendering

I'm creating a bounding box and for debugging would like to see where it is. It is define as four corners and I simply want to draw line in between these 4 corners.

I managed to Google how to do this:

```
 public void Draw(GraphicsDevice graphicsDevice)
    {
        int num = mCorners.Length;
        VertexPositionColor[] primitiveList = new VertexPositionColor[num];

        for (int i = 0; i < num; ++i)
        {
            primitiveList[i] = new VertexPositionColor(new Vector3(mCorners[i], 0), Color.White);
        }

        short[] triangleStripIndices = new short[] { 0, 1, 2, 3, };
        graphicsDevice.DrawUserIndexedPrimitives<VertexPositionColor>(PrimitiveType.LineStrip, primitiveList, 0, 4, triangleStripIndices, 0, 3);
    } 
```

However, when this code is ran the app just closes. It is in debug mode but there is no stack trace, crash message, error log etc. It just closes, making it very hard to debug.

I've found a similar question that doesn't have an answer: [XNA 4.0 app closes suddenly when it hits a method without throwing any exceptions](https://stackoverflow.com/questions/6181175/xna-4-0-app-closes-suddenly-when-it-hits-a-method-without-throwing-any-exception). The suggestion was is it being initialised properly, and yes mine is. The GraphicsDevice is passed around as a parameter and not obtained statically.

Does anybody know what may be causing this?

Thanks,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:19:20.970

嗨，卢克，试着像这样把你的代码放在 Dispatcher 中

```
 this.Dispatcher.BeginInvoke(new System.Action(delegate()
            {
int num = mCorners.Length;
        VertexPositionColor[] primitiveList = new VertexPositionColor[num];

        for (int i = 0; i < num; ++i)
        {
            primitiveList[i] = new VertexPositionColor(new Vector3(mCorners[i], 0), Color.White);
        }

        short[] triangleStripIndices = new short[] { 0, 1, 2, 3, };
        graphicsDevice.DrawUserIndexedPrimitives<VertexPositionColor>(PrimitiveType.LineStrip, primitiveList, 0, 4, triangleStripIndices, 0, 3);

            })); 
```

当 UI 需要更改并且过程仍在工作时，系统似乎崩溃了。它会引发未处理的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:30:47.923

Ok, figured it out. Code is as follows:

```
 private BasicEffect mBasicEffect;

    public void Draw(GraphicsDevice graphicsDevice)
    {
        // If we haven't set this up yet then do so now
        if (mBasicEffect == null)
        {
            CreateBasicEffect(graphicsDevice);
        }

        foreach (EffectPass pass in mBasicEffect.CurrentTechnique.Passes)
        {
            pass.Apply();

            int num = mCorners.Length + 1;
            short[] triangleStripIndices = new short[num];
            VertexPositionColor[] primitiveList = new VertexPositionColor[num];

            for (int i = 0; i < num; ++i)
            {
                int index = i % mCorners.Length;
                Vector2 vec = mCorners[index];
                primitiveList[index] = new VertexPositionColor(new Vector3(vec, 0), Color.White);
                triangleStripIndices[i] = (short)i;
            }

            graphicsDevice.DrawUserIndexedPrimitives<VertexPositionColor>(PrimitiveType.LineStrip, primitiveList, 0, 5, triangleStripIndices, 0, 4);
        }
    }

    private void CreateBasicEffect(GraphicsDevice device)
    {
        mBasicEffect = new BasicEffect(device);
        mBasicEffect.VertexColorEnabled = true;

        Matrix viewMatrix = Matrix.CreateLookAt(new Vector3(0, 0, 1), Vector3.Zero, Vector3.Up);
        Matrix worldMatrix = Matrix.CreateTranslation(0, 0, 0);
        Matrix projectionMatrix = Matrix.CreateOrthographicOffCenter(0, device.Viewport.Width, device.Viewport.Height, 0, 1, 1000);

        mBasicEffect.World = worldMatrix;
        mBasicEffect.View = viewMatrix;
        mBasicEffect.Projection = projectionMatrix;
    } 
```

# javascript - js / jquery function call order not reflected in result

> ID：10935564
> 
> 赞同：2
> 
> 时间：2012-06-07T16:04:11.000
> 
> 标签：javascript, jquery

EDIT:

Alright, to help resolve this, I've put up the example online:
[http://lodge323.com/test/index.html](http://lodge323.com/test/index.html)

The example works as intended, but it doesn't have the content that I want on it. Note that this apparently only happens on FF13 and not IE9.

Steps to recreate the problem:
-Ctrl+F5 to reload the page (overriding cache).
-Using Firebug (addon for FF), change 1.jpg to head.gif
-Click on the Inventory menu tab on the right

Notice how there's a gap between the menu and the bottom which doesn't happen if 1.jpg is used. So question is, how can I get that gif image to work properly with the page?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:30:24.770

jQuery 的[加载](http://api.jquery.com/load/)是异步的。

与其在 loadContent 之后调用 loadSidebar，不如将其作为回调传递给[load](http://api.jquery.com/load/)：

```
$(document).ready(function() {
    $(".tabs a").click(function() {
        loadContent('#ContentDiv', this, '.tabs a', 'id', loadSidebar);
    });
});

function loadContent(divTarget, elm, selector, attr, callback) {
    $(divTarget).load($(elm).attr(attr) + ' #ContentLoad', callback);
} 
```

这将在内容完成加载时调用 loadSidebar，而不是在开始加载后立即调用。

查看[了解 Javascript 中的回调函数](http://recurial.com/programming/understanding-callback-functions-in-javascript/)。它可能会帮助您理解为什么需要回调。

**编辑**

正如 Eric 指出的那样，您还将 url 存储在 id 中的评论。您应该将其存储在`href`锚点的属性中。然后你可以从你的点击处理程序中返回 false 以避免加载整个页面：

```
$(document).ready(function() {
    $(".tabs a").click(function() {
        loadContent('#ContentDiv', this, '.tabs a', 'href', loadSidebar);
        return false;
    });
}); 
```

# javascript - jquery show() moving other elements in IE 7

> ID：10935566
> 
> 赞同：1
> 
> 时间：2012-06-07T16:04:15.297
> 
> 标签：javascript, jquery, internet-explorer

i have this markup

```
<div class="pfbc-form" id="ticker_div" style="padding: 0px; line-height: 18px; width: 64%; margin-top: 0px; margin-left: 10px;">
    <span id="ticker"><b> Avisos y tratamientos vigentes.</b></span>
</div>
<input class="ui-button ui-widget ui-state-default ui-corner-all" style="height: 40px;width: 10%;" value="something" type="button" onclick="doSomething();"></input> 
```

and this js:

```
var array_datos = ['foo','bar'];
var i = 1;
function blink()
{
    var elem = $( "#ticker" );
    //elem.hide( 'clip', {}, 7000/5);
    elem.text(array_datos[i]);
    elem.show( 'clip', {}, 7000/5);
    if(i+1<array_datos.length)
        i++;
    else
        i = 1;
}
blink();

var timer = setInterval('blink()',7000); 
```

​</p>

this code works in all browsers, except for IE 7\. when the .show runs, the button moves down, and returns to its position when the animation ends.

i tried setting a height to the divs, but that doesnt seem to work. i have no clue of what its happening.

ps: i know that there are a couple of problems in that code but i dont think that affects this behavior.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:44:50.730

`height`为您的容器 div设置：

```
<div class="pfbc-form" id="ticker_div" style="height: 30px; padding: 0px; line-height: 18px; width: 64%; margin-top: 0px; margin-left: 10px;"> 
```

在这里小提琴：http: [//jsfiddle.net/C4KyQ/3/](http://jsfiddle.net/C4KyQ/3/)

# asp.net - Get value of ASP.NET TextBox on Async Postback

> ID：10935567
> 
> 赞同：0
> 
> 时间：2012-06-07T16:04:19.810
> 
> 标签：asp.net, asynchronous, textbox, updatepanel, postback

I'm using an UpdatePanel to asynchronously update a control on my ASP.NET page. During the postback, I'd like to get the value of a TextBox control. The value I get, however, is always the original text value of the TextBox, not the text the user has inputted. How can I get the updated value of the TextBox server-side on a postback?

Thanks in advance for any advice you have to offer.

Here's the code:

```
<asp:UpdatePanel ID="GridUpdatePanel" runat="server">
    <ContentTemplate>
        <asp:GridView ID="AdminGridView" runat="server"
            onrowcreated="AdminGridView_RowCreated" AutoGenerateColumns="False" 
            RowStyle-HorizontalAlign="Center" CssClass="Grid" Font-Size="100%" 
            BorderColor="Black" oninit="AdminGridView_Init">
        </asp:GridView>
        <asp:TextBox ID="SortLabel" runat="server" Text="Recipients"></asp:TextBox>
        <asp:TextBox ID="DirectionLabel" Text="DESC" runat="server"></asp:TextBox>
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="Button1" />
    </Triggers>
</asp:UpdatePanel> 
```

**--EDIT--**

I should add that I'm attempted to retrieve the value of the TextBox in the _Init() Event in the GridView - maybe there's a better place to retrieve the value of the TextBox?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:52:47.790

您无法在`Init`事件中获取 TextBox 的更新值。此事件在页面生命周期中执行得太早，在页面控件设置为发布值之前。为什么不`Button1`点击一下呢？

[这篇](http://msdn.microsoft.com/en-us/library/ms178472.aspx)MSDN 文章可能会帮助你了解 asp.net 页面的生命周期

# c# - 如何从代码中打开组合框编辑的弹出菜单

> ID：10935570
> 
> 赞同：0
> 
> 时间：2012-06-07T16:04:42.460
> 
> 标签：c#, winforms, combobox, devexpress

如何从代码（C# 中的 Windows 应用程序）打开`comboboxedit`“ ”的弹出菜单？`Devexpress Component`

我找不到这样做的属性或方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T08:20:30.833

解决方案是处理`KeyDown`事件并调用`ComboBoxEdit.ShowPopup`方法。

# mule - Mule 3: Setting a response timeout value for "http:rest-service-component"

> ID：10935576
> 
> 赞同：1
> 
> 时间：2012-06-07T16:05:11.187
> 
> 标签：mule

I have a flow that uses the `http:rest-service-component` component. The URL that I want to call takes around a minute to return a response, but "http:rest-service-component" only waits for 10 seconds.

How do I change this timeout value? The `http:rest-service-component` element doesn't have any sort of timeout attribute. I also tried creating an "http:connector" and setting a timeout value there, but that didn't work. Thanks.

```
<flow name="theFlow">
  <inbound-endpoint ... />
  <http:rest-service-component serviceUrl="..." />
</flow> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:28:17.347

如果您可以将此超时设置为全局值，那么您可以将其设置为 30 秒：

```
<configuration defaultResponseTimeout="30000" /> 
```

不过，这将影响所有传输的所有出站端点。如果您只想影响此 HTTP 交互，我看到的唯一选项是在属性`responseTimeout`末尾添加一个查询字符串参数：`serviceUrl`

```
responseTimeout=30000 
```

它*应该*有效，但我尚未确认。

# ruby-on-rails - 使用橡胶 gem 部署在不同类型的实例上

> ID：10935578
> 
> 赞同：1
> 
> 时间：2012-06-07T16:05:18.560
> 
> 标签：ruby-on-rails, deployment, amazon-ec2

我正在使用橡胶 gem，并且已将其设置为在橡胶设置文件中使用 m1.small 实例类型。
现在我想通过部署到不同类型的实例（高 CPU 机器、中型实例和小型实例）来使我的部署复杂化。
如何配置橡胶以将不同的实例用于不同的角色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T07:09:17.173

您需要在橡胶 YAML 文件中设置“image_type”键。

以下是我将数据库实例设置为使用 m1.large 实例类型的方法：

```
roles:
  db:
    cloud_providers:
      aws:
        image_type: m1.large 
```

# iphone - Toolbar(?) underneath navigation bar - iPhone

> ID：10935579
> 
> 赞同：0
> 
> 时间：2012-06-07T16:05:23.227
> 
> 标签：iphone, objective-c, ios, uinavigationcontroller, uitoolbar

I'm wondering how one goes about implementing something like the following:

![enter image description here](../Images/05d81653af1fecdb92312543d01df896.png)

The grey bar underneath the navigation bar that contains 2 buttons, 'Expense' and 'Income'. Can anyone point me to a resource or explain how you implement something like this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:23:09.610

似乎第二个栏是一个工具栏。只需在导航栏下方放置一个工具栏。您面临哪些问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:31:20.350

从这个布局，我对实现的猜测是：

*   顶层：`UITabViewController`
*   选定选项卡：（`MyHistoryViewController`子类`UIViewController`- 或可能是`UITableViewController`- 放置在 a 内`UINavigationController`）
*   `MyHistoryViewController`可以在 Interface Builder（这些天构建到 Xcode 中）中`UIToolbar`使用 a `UISegmentedControl`（或您的自定义工具栏，看起来像上面那样）在 a 上方进行布局`UITableView`

[View Controller Programming Guide](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)是一个有用的资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:22:44.627

您可以在位于导航栏下方的工具栏 (UIToolbar) 中使用分段控件 (UISegmentedControl)。

# android - 找不到与给定名称匹配的资源（在“文本”处，值为“@string/hello”）

> ID：10935581
> 
> 赞同：1
> 
> 时间：2012-06-07T16:05:30.107
> 
> 标签：android

我正在尝试制作一个 Hello World 应用程序。这是[我正在使用的教程](http://docs.xamarin.com/android/getting_started/hello_world?mkt_tok=3RkMMJWWfF9wsRonu6nLZKXonjHpfsX57%2BklWqW%2FlMI%2F0ER3fOvrPUfGjI4ATMFrI%2FqLAzICFpZo2FFAG%2B2UbolO)的链接。

我已成功通过“使用代码创建用户界面”并看到该应用程序在模拟器中运行，但是当我进入“创建字符串资源”时遇到了一些麻烦。我将我的 Strings.xml 文件更改为：

```
 <?xml version="1.0" encoding="utf-8"?>
    <resources>
        <string name="helloButtonText">Say Hello</string>
        <string name="helloLabelText">Hello Mono for Android</string>
    </resources> 
```

正如它所说的那样，然后我更改了 Activity1.cs 中的行，所以它是：

```
 using System;
    using Android.App;
    using Android.Content;
    using Android.Runtime;
    using Android.Views;
    using Android.Widget;
    using Android.OS;

    namespace HelloM4A
{
[Activity (Label = "HelloM4A", MainLauncher = true)]
public class Activity1 : Activity
{
    int count = 1;

protected override void OnCreate (Bundle bundle)
    {
        base.OnCreate (bundle);

        //Create the user interface in code
        var layout = new LinearLayout (this);
        layout.Orientation = Orientation.Vertical;

        var aLabel = new TextView (this);
        //old line aLabel.Text = "Hello, Mono for Android";
        aLabel.SetText (Resource.String.helloLabelText);

        var aButton = new Button (this);     
        //old line aButton.Text = "Say Hello";
        aButton.SetText (Resource.String.helloButtonText);

    aButton.Click += (sender, e) => {
        aLabel.Text = "Hello from the button";
    }; 
    layout.AddView (aLabel);
    layout.AddView (aButton);          
    SetContentView (layout);
    }
        };
    }
} 
```

}

然后，当我尝试运行时，我收到错误消息：找不到与给定名称匹配的资源（在“文本”处，值为“@string/hello”），它说它位于 Main.axml 的第 2 行，所以这里是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<Button
    android:id="@+id/myButton"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello" />
</LinearLayout> 
```

我尝试过其他 Android 教程，但似乎总是卡在向 Strings.xml 文件添加内容的部分。我对此问题的解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:14:11.147

```
<Button
    android:id="@+id/myButton"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello" /> 
```

按钮 XML 上的最后一个属性（即`android:text="@string/hello"`）试图将文本设置为字符串 resource 的值`hello`。您还没有定义`hello`在您的 strings.xml 文件中命名的字符串资源。您需要定义一个，或使用不同的，例如`helloButtonText`：

```
<Button
    android:id="@+id/myButton"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/helloButtonText" /> 
```

或者，由于您似乎是以编程方式而不是通过您定义的 XML 设置视图，因此您现在可以完全摆脱 XML 布局文件。您似乎没有在任何地方使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:11:14.037

您的问题是它（`hello`字符串）不存在。您创建了`helloButtonText`and `helloLabelText`，但没有`hello`。

将您的按钮 xml 更改为此，它应该可以工作：

```
<Button 
    android:id="@+id/myButton" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="@string/helloButtonText" /> 
```

# jquery - 如何在发送到 textarea 框之前使用 .each 和 blur 来确定是否有值？

> ID：10935584
> 
> 赞同：0
> 
> 时间：2012-06-07T16:05:55.673
> 
> 标签：jquery

好吧，我自己真的很困惑。

我们有这个应用程序可以连接值并将它们发送到 TA 框。我想先确定该字段是否有值，

*   如果确实有值，请将其添加到 TA 字段
*   如果它没有值/空，则不要将其添加到 TA 字段中，

**我该怎么做呢？**

我想在**模糊**事件中使用它[**参见代码示例**]。我知道我需要使用**.each()**，检查长度和/或查看每个字段，看看是否有值，如果有，放入 TA 字段

**有人可以告诉我如何做到这一点吗？**

**jsfiddle >>** [http://jsfiddle.net/justmelat/6JHRT/](http://jsfiddle.net/justmelat/6JHRT/)

**HTML**

```
<form>
    <p>First name: <input type="text" name="firstname" id="firstname" value="Paul"/></p>
    <p>Last name: <input type="text" name="lastname"  id="lastname" value="Ryan" /></p>
<p>Street #: <input type="text" name="street_number"  id="street_number" value="4605"/></p>
<p>Address: <input type="text" name="address" id="address"/></p>
<p>City: <input type="text" name="city" id="city" /></p>
<p>State: <input type="text" name="state" id="state"/><br />

<span id="myzip">Zip:</span> <input type="text" name="zip"  id="zip" />
<br /><br />
<select name="hometype" id="hometype">
<option value="">Select</option>
<option value="SFH">Single Family Home</option>
<option value="Condo">Condo</option>
<option value="Trailer">Trailer</option><br />
</select><br />
<input type="radio" name="ownership" value="own" /> Own
<input type="radio" name="ownership" value="rent" /> Rent
    <hr />
<span id="allInfo">All Info:</span> <textarea id="ta_holdAll" rows="10" cols="30"></textarea><div id="charCnt"></div><br /><br />
    <input type="button" value="Add to Field" id="addField">
</form>​ 
```

**查询**

```
$(document).ready(function(){

    function combineFields(event) {
      var mytextareaFld = $('#ta_holdAll');
      var fld_1 = $('#firstname').attr('name')+':  '+$('#firstname').val();
      var fld_2 = $('#lastname').attr('name')+':  '+$('#lastname').val();
      var fld_3 = $('#street_number').attr('name')+':  '+$('#street_number').val();
        var hold_all_fields = fld_1 +'\n' + fld_2 +'\n' + fld_3;
      //hold_all_fields.each();
      mytextareaFld.val(fld_1 +'\n' + fld_2 +'\n' + fld_3);
  }

    $('#addField').on('click',combineFields);

    $('#allInfo').on('click',function(event){
        combineFields(event);
        var $mytextareaFld = $('#ta_holdAll');
        var $outPutCount = $("#charCnt");
        var $ofText = " characters of 1000 remaining";
        var val = $mytextareaFld.val();
        var val2 = $outPutCount.text(val.length).append("<strong>"+$ofText+"</strong>");
    });

    $("#firstname,#lastname, #street_number").blur(combineFields);
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:07:57.810

试试这个——只要检查字段是否存在（有长度），如果不存在，使用一个空字符串：

```
function combineFields(event) {
    var mytextareaFld = $('#ta_holdAll');
    var fld_1 = $('#firstname').val().length ? $('#firstname').attr('name') + ':  ' + $('#firstname').val() + '\n' : '';
    var fld_2 = $('#lastname').val().length ? $('#lastname').attr('name') + ':  ' + $('#lastname').val() + '\n' : '';
    var fld_3 = $('#street_number').val().length ? $('#street_number').attr('name') + ':  ' + $('#street_number').val() + '\n' : '';
    var hold_all_fields = fld_1 + fld_2 + fld_3;
    mytextareaFld.val(hold_all_fields);
} 
```

[http://jsfiddle.net/6JHRT/3/](http://jsfiddle.net/6JHRT/3/)

为了增加实用性，请用于`jQuery.trim()`消除空格：

```
function combineFields(event) {
    var mytextareaFld = $('#ta_holdAll');
    var fld_1 = $.trim($('#firstname').val()).length ? $('#firstname').attr('name') + ':  ' + $('#firstname').val() + '\n' : '';
    var fld_2 = $.trim($('#lastname').val()).length ? $('#lastname').attr('name') + ':  ' + $('#lastname').val() + '\n' : '';
    var fld_3 = $.trim($('#street_number').val()).length ? $('#street_number').attr('name') + ':  ' + $('#street_number').val() + '\n' : '';
    var hold_all_fields = fld_1 + fld_2 + fld_3;
    mytextareaFld.val(hold_all_fields);
} 
```

[http://jsfiddle.net/6JHRT/4/](http://jsfiddle.net/6JHRT/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:26:55.153

试试这个：

```
 function combineFields(event) {
        $('#ta_holdAll').val('');
        $("#firstname,#lastname, #street_number").each(function(){
            if ($(this).val() != '') {
               var val = $(this).attr('name')+':  '+$(this).val();
               var mytextareaFld = $('#ta_holdAll');
              mytextareaFld.val(mytextareaFld.val() + val + '\n');
            }
        })
  } 
```

[http://jsfiddle.net/6JHRT/7/](http://jsfiddle.net/6JHRT/7/)

# java - Failed to change Tomcat 5.5 JVM Memory settings (Linux server)

> ID：10935585
> 
> 赞同：0
> 
> 时间：2012-06-07T16:05:56.660
> 
> 标签：java, jvm-arguments, tomcat5.5

I want to increase the JVM memory settings for my Tomcat 5.5 instance (on Linux server with 1.8 gigs of memory).

Current JVM Status: Free memory: 15.60 MB Total memory: 26.00 MB Max memory: 405.37 MB

I just can't get these settings to budge. I tried the following:

1.  Added the following statement to "setenv.sh" in /tomcat/bin:

    ```
    export JAVA_OPTS="-server -Xms1024m -Xmx1024m -XX:MaxPermSize=256m" 
    ```

2.  Added the following statement to "setenv.sh" in /tomcat/bin:

    ```
    export CATALINA_OPTS="-server -Xms1024m -Xmx1024m -XX:MaxPermSize=256m" 
    ```

3.  Added the following statement to "setenv.sh" in /tomcat/bin:

    ```
    JAVA_OPTS="-Xmx1024m -Xms512m -server"

    export JAVA_OPTS 
    ```

4.  Added the following statement to "catalina.sh" in /tomcat/bin:

    ```
    CATALINA_OPTS="-server -Xms1024m -Xmx1024m -XX:MaxPermSize=256m" 
    ```

5.  Added the following statement to "catalina.sh" in /tomcat/bin:

    ```
    JAVA_OPTS="-server -Xms1024m -Xmx1024m -XX:MaxPermSize=256m" 
    ```

NONE of these changes made any impact on the JVM settings.

I have exhausted all options identified from various support sites, including: [How to tune Tomcat 5.5 JVM Memory settings without using the configuration program](https://stackoverflow.com/questions/286007/how-to-tune-tomcat-5-5-jvm-memory-settings-without-using-the-configuration-progr) and [http://wiki.razuna.com/display/ecp/Adjusting+Memory+Settings+for+Tomcat](http://wiki.razuna.com/display/ecp/Adjusting+Memory+Settings+for+Tomcat)

Thanks in advance.

# linux - 循环通过多个目录的 bash 脚本的输出

> ID：10935587
> 
> 赞同：0
> 
> 时间：2012-06-07T16:06:07.547
> 
> 标签：linux, bash, shell, scripting

我目前正在尝试编写一个循环遍历多个目录的脚本。主 raw_data 目录包含约 150 个子目录（subj001、subj002、...、subj00n），每个子目录都有几个子目录。

如何确保下面给出的脚本的输出将被发送回输入的特定子目录（例如 subj0012），而不是当前目录（raw_data）？

```
#!/bin/bash

for dir in ~raw_data/*
do
  tractor -d -r -b preproc RunStages:1 
done 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:13:30.243

您要将输出保存到的目录的名称是 in `$dir`，对吗？因此，只需通过重定向将输出发送到那里：

```
#!/bin/bash
for dir in ~raw_data/* ; do
    tractor -d -r- b preproc RunStages:1 > $dir/output
done 
```

不过，您应该确保您正在处理的内容确实是一个目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:16:42.380

您可以使用 output of`find`运行循环并将输出附加到所需位置，如下所示：

```
while read d
do
    echo $d >> ~raw_data/subj0012/output
done < <(find ~raw_data -type d) 
```

# javascript - JavaScript Fullscreen API plugin

> ID：10935589
> 
> 赞同：2
> 
> 时间：2012-06-07T16:06:14.223
> 
> 标签：javascript, api, plugins

I've found a plugin called [screenfull.js](http://sindresorhus.com/screenfull.js/) and I'm wondering if it's possible to automatically open the page in fullscreen without clicking on a button. This is an example of code for making the page fullscreen :

```
document.getElementById('#button').addEventListener('click', function() {
if ( screenfull ) {
    screenfull.request();
} else {
    // Ignore or do something else
} 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:09:05.557

使用他们的演示，您可以在窗口加载时运行请求：

例如

```
window.onload = function() {
    screenfull.request( $('#container')[0] );
}; 
```

**[编辑]**
你也可以在准备好 jQuery 文档的情况下运行它...

例如

```
$(document).ready(function() {
    screenfull.request( $('#container')[0] );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-15T21:24:24.977

我用了一个技巧……
        我听着身体上的任何点击来激活。
例如：

```
$('body').on('click', '*', function() {
        screenfull.request();
    }); 
```

注意：它不跟踪已经有事件处理程序的按钮（等）......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:39:08.983

不，那是不可能的。出于安全考虑，`requestFullScrenn()`必须由直接用户操作（如单击）触发。这与弹出窗口相同。

阅读[https://wiki.mozilla.org/Security/Reviews/Firefox10/CodeEditor/FullScreenAPI](https://wiki.mozilla.org/Security/Reviews/Firefox10/CodeEditor/FullScreenAPI)和[https://wiki.mozilla.org/Gecko:FullScreenAPI](https://wiki.mozilla.org/Gecko:FullScreenAPI)以供参考。

# java - maven：如何添加编译阶段后生成的资源

> ID：10935593
> 
> 赞同：38
> 
> 时间：2012-06-07T16:06:32.653
> 
> 标签：java, maven, jax-ws

我有一个 maven 项目，它使用[wsgen](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/wsgen.html)从编译的 java 类 生成[XSD文件。](https://en.wikipedia.org/wiki/XML_Schema_%28W3C%29)

问题是我想将生成的文件作为资源添加到 jar 中。但由于`resource`阶段在阶段之前运行`process-classes`，我无法添加它们。

有没有办法告诉 Maven 添加在该`process-classes`阶段生成的额外资源？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-07T16:18:33.830

我建议将 XSD 文件的输出目录定义为目标/类（可能带有一个补充子文件夹，该文件夹将在打包阶段稍后打包到 jar 中。这可以通过使用[maven-resources-plugin](http://maven.apache.org/plugins/maven-resources-plugin/)来实现。

```
<project>
  ...
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
        <version>3.0.2</version>
        <executions>
          <execution>
            <id>copy-resources</id>
            <phase>process-classes</phase>
            <goals>
              <goal>copy-resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${project.build.outputDirectory}</outputDirectory>
              <resources>          
                <resource>
                  <directory>${basedir}/target/xsd-out</directory>
                  <filtering>false</filtering>
                </resource>
              </resources>              
            </configuration>            
          </execution>
        </executions>
      </plugin>
    </plugins>
    ...
  </build>
  ...
</project> 
```

您需要注意资源插件位于用于调用 wsgen 部分的插件之后。您也可以使用*prepare-package*阶段来确保正确打包资源。

# netbeans - 如何在 netbeans 中打开 2 个文件/项目资源管理器窗口？

> ID：10935596
> 
> 赞同：5
> 
> 时间：2012-06-07T16:06:42.167
> 
> 标签：netbeans, ide

有没有办法在 netbeans 中打开 2 个文件/项目窗口？我想让其中一个窗口指向一个文件夹，另一个窗口指向另一个文件夹。当您有很多文件并且必须在两个文件夹之间不断切换时，每次都必须滚动这么多会很烦人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T10:18:53.170

还没有找到打开 2 个项目窗口的方法，但我在同一个窗格中堆叠了一个项目和一个文件窗口。只需打开两个窗口并将其中一个缩小到一半大小。您也可以取消停靠（浮动）窗户并将它们放在您想要的任何地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-05T13:52:53.270

不存在解决方案。但是您可以像这样“破解”：[https ://pandazen.wordpress.com/2009/12/23/open-netbeans-with-two-instances-windows-simultaneously/](https://pandazen.wordpress.com/2009/12/23/open-netbeans-with-two-instances-windows-simultaneously/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-05T07:02:02.393

[opens-multiple-netbeans-ide-instances](http://netbeanside61.blogspot.in/2008/12/opening-multiple-netbeans-ide-instances.html)中提供的说明确实有效。

我已经对其进行了测试并按预期工作。您需要通过提供项目目录为两个不同的目录创建快捷方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-01T16:50:13.463

两个打开两个 Netbeans 实例，在 Netbeans 启动之前，我快速连续双击两个程序文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-26T09:49:39.737

请允许我在这里明确添加@Do_Nhu_Vy 提到的“黑客”（因为我不信任第三方网站，而且我没有足够的*声誉*来回复他的评论）。所有功劳归于所述链接中的原始 WordPress 用户（Pandazen）。

接着，

hack/解决方案包括在启动时更改 NetBeans 的“userdir”：当 NetBeans 检测到不同的“userdir”（与已打开的 Netbeans 窗口不同）时，它将继续打开一个新窗口。

在启动时更改 NetBeans 的*userdir*的过程很简单：

1.  创建一个空的用户目录，例如：

    ```
    C:\tmp
    ```

2.  复制现有的 NetBeans 快捷方式（创建一个新快捷方式）。您很可能会在“开始菜单”Windows 目录中找到快捷方式

    ```
    C:\ProgramData\Microsoft\Windows\开始菜单\程序\NetBeans"
    ```

3.  右键单击新创建的 Netbeans 快捷方式并选择“属性”，
4.  *通过添加带有所选路径的--userdir DIRECTORY*后缀来修改“目标”字段，将**DIRECTORY**替换为新创建的空目录。例如：

    ```
    "C:\Program Files\NetBeans 8.2\bin\netbeans64.exe"" --userdir C:\tmp
    ```

现在，每个快捷方式都会在不同的窗口中启动一个 NetBeans 实例。这适用于 NetBeans 8.2，但我尚未使用 NetBeans 9 或 10 对其进行测试。

# ruby-on-rails - Rails：application_helper.rb 中定义的方法无法被 categories_controller.rb 识别

> ID：10935602
> 
> 赞同：3
> 
> 时间：2012-06-07T16:07:14.473
> 
> 标签：ruby-on-rails

更多新手问题。

我知道，如果我在我的应用程序帮助程序中定义一个方法，则它可用于整个应用程序代码。

在我的应用程序助手中，我有：

```
def primary_user_is_admin

  if current_user
    user_login_roles = JSON.parse(current_user.role)
    if user_login_roles["admin"]
      return 1
    end
  end
  return nil
end 
```

如果我从 categories_controller 调用它：

```
if !primary_user_is_admin
  redirect_to root_url
end 
```

我收到一条错误消息：未定义的局部变量或方法 `primary_user_is_admin'

如果我将 primary_user_is_admin 代码放在 registrations_helper.rb 文件中，也会发生这种情况

但是，如果我在任何视图中使用它（例如，views/user/edit.html.erb）

```
<% if primary_user_is_admin %>
<% end > 
```

然后它工作。我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-07T16:16:23.880

默认情况下，助手不包含在控制器中。你可以

```
include ApplicationHelper 
```

访问 ApplicationHelper 模块中的方法。前面的[讨论](https://stackoverflow.com/questions/2590912/my-helper-methods-in-controller)有一堆有用的解决方案来访问控制器中的助手。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T16:15:16.633

默认情况下，帮助程序中定义的方法仅可用于视图。您必须在应用程序控制器中“包含 ApplicationHelper”才能在控制器中访问此方法。

# eclipse - Eclipse 版本标记

> ID：10935604
> 
> 赞同：0
> 
> 时间：2012-06-07T16:07:22.793
> 
> 标签：eclipse, versioning, release-management

我正在自己开发一个 Android 应用程序。使用 Eclipse。我没有在网络上定义任何存储库，也没有使用 CVS（没有团队）。我在我的计算机上本地拥有所有代码源。

如何使用版本号标记当前源？
是否习惯于在稳定时标记一次，在准备发布时再次标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T05:19:42.713

你没有。Eclipse 中的本地历史不能替代真正的源代码控制管理系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:15:11.347

我强烈建议使用某种版本控制。您可以在 github 上获得一个免费帐户并将您的代码存储在那里。但是使用版本控制与您在插件中使用版本的方式无关。

此链接包含版本控制的 Eclipse 指南：

[http://wiki.eclipse.org/Version_Numbering](http://wiki.eclipse.org/Version_Numbering)

总结一下：

1.  预发布，使用类似 0.xxqualifier
2.  第一个主要版本将是 1.0.0.qualifier
3.  提高微版本（第三个数字）以修复错误 4，提高次要版本（第二个数字）以获得保持向后兼容性的新功能
4.  升级主要版本以进行破坏兼容性的重大更改
5.  限定符应由构建过程转换为唯一的 id。通常，它是时间戳的某种变体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:18:32.143

我同意[@Andrew](https://stackoverflow.com/users/172363/andrew-eisenberg)的观点，值得将您的代码添加到版本控制系统中。如果您不喜欢将它放在 github 上，您仍然可以在本地 git 存储库中使用 git，这样您的代码就可以进行源代码控制。

@Andrew 还提到了插件和功能版本号的细分。当使用 PDE Build 构建 headless 或通过 PDE UI 导出时，您可以在构建时更改版本的限定符部分。`forceContextQualifier`这是 PDE 导出向导中的一个选项，对于没有源代码控制的 PDE 无头构建，可以在`build.properties`文件中覆盖。

# algorithm - KD TREES (3-D) 最近邻搜索

> ID：10935608
> 
> 赞同：4
> 
> 时间：2012-06-07T16:07:33.337
> 
> 标签：algorithm, data-structures, kdtree

我正在查看**KD trees Nearest Neighbor Search**的 Wikipedia 页面。

当点在 2-D(x,y) 中时，维基百科中给出的伪代码有效。

我想知道，当点是 3-D(x,y,z) 时，我应该做些什么改变。

我用谷歌搜索了很多，甚至在堆栈溢出中通过了类似的问题链接，但我在任何地方都没有找到 3-d 实现，以前的所有问题都以 2-D 点作为输入，而不是我的 3-D 点寻找。

构建 KD 树的 Wiki 中的伪代码是：

```
function kdtree (list of points pointList, int depth)
{
    // Select axis based on depth so that axis cycles through all valid values
    var int axis := depth mod k;

    // Sort point list and choose median as pivot element
    select median by axis from pointList;

    // Create node and construct subtrees
    var tree_node node;
    node.location := median;
    node.leftChild := kdtree(points in pointList before median, depth+1);
    node.rightChild := kdtree(points in pointList after median, depth+1);
    return node;
} 
```

构建KD树后如何找到最近的邻居？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:13:33.827

您可以完全按照 Wikipedia 页面上“最近邻搜索”标题下的描述找到最近邻。那里的描述适用于任何数量的维度。那是：

*   从根递归地沿着树向下走，就好像您要插入要查找最近邻居的点一样。
*   当您到达一片叶子时，请注意它是迄今为止最好的。
*   在再次上树的路上，对于遇到的每个节点：
    *   如果它比迄今为止最好的更接近，请更新迄今为止最好的。
    *   如果 best-so-far 到目标点的距离大于目标点到该节点处分裂超平面的距离，
    *   也处理节点的另一个子节点（使用相同的递归）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T21:15:07.640

我最近编写了一个 KDTree，用于在 3-D 空间中进行最近邻搜索，并且在理解 NNS 时遇到了同样的问题，尤其是 wiki 的 3.2。我最终使用了这个算法，它似乎在我的所有测试中都有效：

这是最初的叶子搜索：

```
public Collection<T> nearestNeighbourSearch(int K, T value) {
    if (value==null) return null;

    //Map used for results
    TreeSet<KdNode> results = new TreeSet<KdNode>(new EuclideanComparator(value));

    //Find the closest leaf node
    KdNode prev = null;
    KdNode node = root;
    while (node!=null) {
        if (KdNode.compareTo(node.depth, node.k, node.id, value)<0) {
            //Greater
            prev = node;
            node = node.greater;
        } else {
            //Lesser
            prev = node;
            node = node.lesser;
        }
    }
    KdNode leaf = prev;

    if (leaf!=null) {
        //Used to not re-examine nodes
        Set<KdNode> examined = new HashSet<KdNode>();

        //Go up the tree, looking for better solutions
        node = leaf;
        while (node!=null) {
            //Search node
            searchNode(value,node,K,results,examined);
            node = node.parent;
        }
    }

    //Load up the collection of the results
    Collection<T> collection = new ArrayList<T>(K);
    for (KdNode kdNode : results) {
        collection.add((T)kdNode.id);
    }
    return collection;
} 
```

这是从最近的叶节点开始的递归搜索：

```
private static final <T extends KdTree.XYZPoint> void searchNode(T value, KdNode node, int K, TreeSet<KdNode> results, Set<KdNode> examined) {
    examined.add(node);

    //Search node
    KdNode lastNode = null;
    Double lastDistance = Double.MAX_VALUE;
    if (results.size()>0) {
        lastNode = results.last();
        lastDistance = lastNode.id.euclideanDistance(value);
    }
    Double nodeDistance = node.id.euclideanDistance(value);
    if (nodeDistance.compareTo(lastDistance)<0) {
        if (results.size()==K && lastNode!=null) results.remove(lastNode);
        results.add(node);
    } else if (nodeDistance.equals(lastDistance)) {
        results.add(node);
    } else if (results.size()<K) {
        results.add(node);
    }
    lastNode = results.last();
    lastDistance = lastNode.id.euclideanDistance(value);

    int axis = node.depth % node.k;
    KdNode lesser = node.lesser;
    KdNode greater = node.greater;

    //Search children branches, if axis aligned distance is less than current distance
    if (lesser!=null && !examined.contains(lesser)) {
        examined.add(lesser);

        double nodePoint = Double.MIN_VALUE;
        double valuePlusDistance = Double.MIN_VALUE;
        if (axis==X_AXIS) {
            nodePoint = node.id.x;
            valuePlusDistance = value.x-lastDistance;
        } else if (axis==Y_AXIS) {
            nodePoint = node.id.y;
            valuePlusDistance = value.y-lastDistance;
        } else {
            nodePoint = node.id.z;
            valuePlusDistance = value.z-lastDistance;
        }
        boolean lineIntersectsCube = ((valuePlusDistance<=nodePoint)?true:false);

        //Continue down lesser branch
        if (lineIntersectsCube) searchNode(value,lesser,K,results,examined);
    }
    if (greater!=null && !examined.contains(greater)) {
        examined.add(greater);

        double nodePoint = Double.MIN_VALUE;
        double valuePlusDistance = Double.MIN_VALUE;
        if (axis==X_AXIS) {
            nodePoint = node.id.x;
            valuePlusDistance = value.x+lastDistance;
        } else if (axis==Y_AXIS) {
            nodePoint = node.id.y;
            valuePlusDistance = value.y+lastDistance;
        } else {
            nodePoint = node.id.z;
            valuePlusDistance = value.z+lastDistance;
        }
        boolean lineIntersectsCube = ((valuePlusDistance>=nodePoint)?true:false);

        //Continue down greater branch
        if (lineIntersectsCube) searchNode(value,greater,K,results,examined);
    }
} 
```

完整的 java 源代码可以在[这里](http://github.com/phishman3579/java-algorithms-implementation/blob/4d08a6ab52a90502a91f7789e6f0fc4f6d6ab037/src/com/jwetherell/algorithms/data_structures/KdTree.java)找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:19:20.563

> 我想知道，当点是 3-D(x,y,z) 时，我应该做些什么改变。

你得到这条线上的当前轴

```
var int axis := depth mod k; 
```

现在根据轴，您可以通过比较相应的属性找到中位数。例如。如果 axis = 0 您与 x 属性进行比较。实现这一点的一种方法是在执行搜索的例程中传递一个比较器函数。

# c# - 在 Outlook 中检索当前电子邮件正文

> ID：10935611
> 
> 赞同：7
> 
> 时间：2012-06-07T16:07:47.787
> 
> 标签：c#, outlook-addin, outlook-2007, outlook-2010

在我的 Outlook 插件中，我想在功能区上添加一个按钮，因此当用户单击此按钮时，我想检索当前选定电子邮件的正文，我有此代码，但它仅从收件箱中检索第一封电子邮件，因为索引为 1：

```
Microsoft.Office.Interop.Outlook.Application myApp = new Microsoft.Office.Interop.Outlook.Application();
Microsoft.Office.Interop.Outlook.NameSpace mapiNameSpace = myApp.GetNamespace("MAPI");
Microsoft.Office.Interop.Outlook.MAPIFolder myInbox = mapiNameSpace.GetDefaultFolder(Microsoft.Office.Interop.Outlook.OlDefaultFolders.olFolderInbox);
String body = ((Microsoft.Office.Interop.Outlook.MailItem)myInbox.Items[1]).Body; 
```

那么如何在Outlook中检索当前打开的电子邮件？，这种方法对我有用，但我需要获取当前电子邮件的索引。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T16:28:09.493

您不应该`Outlook.Application()`每次都初始化一个新实例。大多数加载项框架为您提供一个`Outlook.Application`实例，对应于当前 Outlook 会话，通常通过名为`Application`. 您应该在加载项的整个生命周期中使用它。

要获取当前选定的项目，请使用：

```
Outlook.Explorer explorer = this.Application.ActiveExplorer();
Outlook.Selection selection = explorer.Selection;

if (selection.Count > 0)   // Check that selection is not empty.
{
    object selectedItem = selection[1];   // Index is one-based.
    Outlook.MailItem mailItem = selectedItem as Outlook.MailItem;

    if (mailItem != null)    // Check that selected item is a message.
    {
        // Process mail item here.
    }
} 
```

请注意，上面将让您处理第*一个*选定的项目。如果您选择了多个项目，您可能希望循环处理它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T12:33:52.833

在顶部添加参考

```
using Outlook = Microsoft.Office.Interop.Outlook; 
```

然后在一个方法里面；

```
Outlook._Application oApp = new Outlook.Application();
if (oApp.ActiveExplorer().Selection.Count > 0)
            {
                Object selObject = oApp.ActiveExplorer().Selection[1];

                if (selObject is Outlook.MailItem)
                {
                    Outlook.MailItem mailItem = (selObject as Outlook.MailItem);
                    String htmlBody = mailItem.HTMLBody;
                    String Body = mailItem.Body;
                 }
             } 
```

您还可以在查看邮件之前更改将在 Outlook 中显示的正文。

# php - 如何在 PHP 中的无限循环页面中更新变量？

> ID：10935613
> 
> 赞同：2
> 
> 时间：2012-06-07T16:07:49.450
> 
> 标签：php, session, cookies, infinite-loop

我有这样的事情：

```
<?php
  $perform_check = 1; #Checks data with ID : 1
  while(true)
  {
    #code
  }
?> 
```

*但是在这个过程中必须更新一些数据，是否可以从另一个文档更新这些数据？*

我试过这样的事情：

**索引.php**

```
<?php
  setcookie("data", 19, time()+3600);
?> 
```

和

**循环.php**

```
<?php
  while(true)
  {
    if($perform_check!=$_COOKIE[data]) $perform_check = $_COOKIE[data];
    #rest of code
    flush();
    sleep(0.3);
  }
?> 
```

但它不起作用。我也试过`$_SESSION`，但页面崩溃了`session_start()`。

有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:52:37.963

当 PHP 通过 Web 服务器（例如 Apache2）发送响应时，Cookie 会作为[HTTP 标头发送。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

所有 HTTP 标头都在任何输出之前发送。如果您输出任何内容，则会在输出之前发送标头（包括[set-cookie 标头](http://www.ietf.org/rfc/rfc2109.txt)）。

在您`flush()`第一次之后，您将无法再设置 cookie 或其他标题。

如果您需要进度指示器或更新，则需要使用 javascript 启动您正在执行的任何操作并每隔一段时间进行轮询。在使用循环的过程中，您需要将进度保存在共享内存、文件或数据库中（按此优先顺序），然​​后使用 javascript 进度检查/更新检查启动的过程读取该数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:23:01.567

您可以使用文件的存在来标记进程的结束。例如，创建一个锁定文件，

```
$lock_file = <some unique name>
fopen($lock_file, 'w') or die("can't open file");
while ( file_exists($lock_file)) {

.
.
doStuff();
.
.

} 
```

如果文件被其他进程删除，它应该终止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:18:48.263

我认为while循环在这里没有任何好处。你应该看看[php websocket 实现](http://code.google.com/p/phpwebsocket/)。它是 PHP 中的一种实现，具有 websockets 并与您的用户建立开放连接。如果你有，你可以用双方的听众来管理事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:10:15.360

如果您希望在代码循环时更改值，则需要检查值是否在循环内更改，而不是之前更改。

只有在同一个用户/浏览器同时运行这两个脚本时，cookie 或会话才会起作用。写入文件或数据库是更常用的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T16:16:33.270

我不太确定你真的想在这里做什么..但我想你可以这样做..

```
<?php
  $perform_check = 1; #Checks data with ID : 1
  while(true) : ?>
    $.ajax({
        type:'post',
        data: //your data to be passed to ajax script..
        url: //the script wherein you want to run the query..
        onSuccess: function(data) {

             if(data==test) {
             //if you have data that you want then you could stop the loop
              <?php $perform_check = false; ?>

             }

        }
    });
  <?php endwhile: ?> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-07T16:17:46.900

如果你需要经常检查，你应该使用一个 CRON 来调用你用来检查的函数。

# c# - Linq 多级动态 where 子句

> ID：10935618
> 
> 赞同：2
> 
> 时间：2012-06-07T16:08:05.930
> 
> 标签：c#, linq

首先让我说我已经在这里搜索并阅读了很多关于动态 where 子句的线程，以及 ScottGu 的博客和 Albahari 的 PredicateBuilder 类，但我不确定如何正确应用这些方法中的任何一个我的情况。不知何故，我无法绕过它。

我有以下代码，当像这样“静态”完成时，它可以工作：

```
var persons = from father in fathers
              select new                                
              {
                 Count = father.Sons
                                    .Select(son => son)
                                    .Where(son => son.Skills.Any(skill => skill.SkillType == "Languages" && skill.Name == "French"))
                                    .Where(son => son.Skills.Any(skill => skill.SkillType == "Sport" && skill.Name == "Football"))
                                    .Count(),

                 Name = father.Name
               }; 
```

但是，我希望在运行时生成 where 子句。一个父亲对象有一个儿子对象的集合，而儿子对象又具有一个技能对象的集合。如查询所示，我想知道每个父亲的姓名以及他们拥有一定技能的儿子的数量。这组技能将在运行时选择，因此即使在示例中，我们只有两组技能（2 个 where 子句），它可以是 10 个或运行时任意数量的子句。

我认为我最大的问题是我似乎无法根据我的情况调整 StackOverflow 上给出的答案示例，因为我需要从顶层（父亲）获取信息以及来自第 3 层的信息（技能) 与第 2 级（儿子）的信息有关。

如果需要，我将在明天发布我已经尝试过的示例代码。我现在做不到，因为我有点着急。任何帮助将不胜感激。

**编辑：**

我需要的是一种在运行时连接 where 子句的方法，具体取决于用户选择了多少过滤条件。不同的过滤条件是从外部来源获得并在运行时构建的。例如：

在场景一中，可能有 3 个标准，例如用户选择的标准 1、标准 2 和标准 3。场景 2 可能有 5 个标准，例如标准 1、标准 2、...、标准 5。第三种情况可能有 10 个标准，例如标准 1、标准 2、...、标准 10。我需要的是能够为每个场景执行以下操作，而无需事先知道是否会有 3、5、10 或任何标准。

**场景一：**

```
var persons = from father in fathers
              select new                                
              {
                 Count = father.Sons
                                    .Select(son => son)
                                    .Where(criteria1)
                                    .Where(criteria2)
                                    .Where(criteria3)
                                    .Count(),

                 Name = father.Name
               }; 
```

**场景二：**

```
var persons = from father in fathers
              select new                                
              {
                 Count = father.Sons
                                    .Select(son => son)
                                    .Where(criteria1)
                                    .Where(criteria2)
                                    .Where(criteria3)
                                    .Where(criteria4)
                                    .Where(criteria5)
                                    .Count(),

                 Name = father.Name
               }; 
```

**场景 3：**

```
var persons = from father in fathers
                  select new                                
                  {
                     Count = father.Sons
                                        .Select(son => son)
                                      .Where(criteria1)
                      .Where(criteria2)
                      .Where(criteria3)
                      .Where(criteria4)
                      .Where(criteria5)                   
                      .Where(criteria6)
                      .Where(criteria7)
                      .Where(criteria8)
                      .Where(criteria9)
                      .Where(criteria10)
                                  .Count(),
                     Name = father.Name
                   }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T11:32:12.487

jonnyGold 的答案很好，但它要求 Son 对象具有对父亲对象的引用。这是一个不需要的解决方案：

```
var query = from father in fathers
            from son in father.Sons
            select new {father, son};

foreach (Skill skillCriterion in CriterionSkills)
{
    var capturedSkillCriterion = skillCriterion;
    query = query.Where(fs => fs.son.Skills.Any(
        skill => skill.SkillType == capturedSkillCriterion.SkillType && 
                 skill.Name == capturedSkillCriterion.Name));         
}         

var persons = from fs in query
              group fs by fs.father into g 
              select new                                 
              { 
                 Count = g.Count(),
                 Name = g.Key.Name
              }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:23:57.147

```
var sons = fathers.SelectMany(f => f.Sons);

foreach(Skill skillCriterion in CriterionSkills)
{
    sons = sons.Where(son => son.Skills.Any(skill => skill.SkillType == skillCriterion.SkillType && skill.Name == skillCriterion.Name));
}

// we need to assume some sort of formal father-son relationship
var persons = from son in sons
              group son by new {son.Father.ID, son.Father.Name} into g
              select new
              {
                g.Key.Name,
                g.Count()
              }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:46:29.320

然后设计您的查询来处理过滤器的动态特性。例如，我创建了父亲和儿子，儿子可以踢足球或排球。现在我的查询将采用仅说足球的动态请求......这是我的做法：

```
void Main()
{
   bool findFootballers   = true;
   bool findVolleyBallers = false;

   var Fathers = new List<Father>()
   {
      new Father() { Name = "Frank SR", Sons = new List<Son>() { new Son() { Name = "Bob", PlaysFootball = true }, new Son() { Name = "Frank", PlaysVolleyBall = true } } },
      new Father() { Name = "Knute", Sons = new List<Son>() { new Son() { Name = "Mean Jo Green", PlaysFootball = true }, new Son() { Name = "McMann", PlaysFootball = true } } }
   };

   Fathers.Where (f => (findFootballers == false) ? true : f.Sons.Any (s => s.PlaysFootball == true))
          .Where (f => (findVolleyBallers == false) ? true : f.Sons.Any (s => s.PlaysVolleyBall == true))
          .Select( f => new
                       {
                       Name = f.Name,
                       TargetSportSons = string.Join(", ", f.Sons
                                                            .Where (s => (findFootballers == false) ? true : s.PlaysFootball)
                                                            .Where (s => (findVolleyBallers == false) ? true : s.PlaysVolleyBall)
                                                            .Select (s => s.Name))
                       }
                 )
            .ToList()
            .ForEach(fs => Console.WriteLine ("Father {0} has these sons {1} who play {2}", fs.Name, fs.TargetSportSons, (findFootballers ? "Football" : "VolleyBall ")));

// Output
// Father Frank SR has these sons Bob who play Football
// Father Knute has these sons Mean Jo Green, McMann who play Football

}

public class Son
{
   public string Name { get; set; }
   public bool PlaysFootball { get; set; }
   public bool PlaysVolleyBall { get; set;}
}

public class Father
{
   public string Name { get; set; }
   public List<Son> Sons = new List<Son>();

}

// Define other methods and classes here 
```

# javascript - 多个延迟加载实例 | Javascript

> ID：10935622
> 
> 赞同：4
> 
> 时间：2012-06-07T16:08:28.527
> 
> 标签：javascript, loading, payload

我目前正在阅读这篇关于推迟加载 Javascript 的文章： [https ://developers.google.com/speed/docs/best-practices/payload#DeferLoadingJS](https://developers.google.com/speed/docs/best-practices/payload#DeferLoadingJS)

他们使用这个脚本：

```
<script type="text/javascript">

 // Add a script element as a child of the body
 function downloadJSAtOnload() {
 var element = document.createElement("script");
 element.src = "deferredfunctions.js";
 document.body.appendChild(element);
 }

 // Check for browser support of event handling capability
 if (window.addEventListener)
 window.addEventListener("load", downloadJSAtOnload, false);
 else if (window.attachEvent)
 window.attachEvent("onload", downloadJSAtOnload);
 else window.onload = downloadJSAtOnload;

</script> 
```

我目前有**4 个单独的 Javascript 文件**，我想“推迟”。

我将如何使用 Google 的示例代码实现这一目标？

非常感谢您的任何指点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-18T15:06:07.200

以下脚本正在运行....只需将 html 和 javascript 下面的内容复制粘贴到 html 文件中即可享受

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <title>HTML Lazy Loading</title>
        <link href="/skins/Skin_1/style.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript">
        function myGetTime() {
            var dd = new Date();
            var hh = dd.getHours();
            var mm = dd.getMinutes();
            var ss = dd.getSeconds();
            var ms = dd.getMilliseconds();
            return ("<br/>The time is now: " + hh + ":" + mm + ":" + ss + ":" + ms + "<br/>");
        }

    </script>
</head>
<body>

<div style="color:blue;margin-left:10px;margin-top:10px;" >
<script type="text/javascript">
document.write("Time before loading all scripts");
    document.write(myGetTime() +"<br/>");
</script>

<div style="color:blue;margin-left:10px;margin-top:10px;" >
<script type="text/javascript">

function downloadJSAtOnload() {

var element2 = document.createElement("script");
element2.src = "https://jqueryjs.googlecode.com/files/jquery-1.2.6.js";
document.body.appendChild(element2);

var element4 = document.createElement("script");
element4.src = "https://www.apparelnbags.com/jscripts/validation_forms.js";
document.body.appendChild(element4);

var element5 = document.createElement("script");
element5.src = "https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js";
document.body.appendChild(element5);

var element6 = document.createElement("script");
element6.src = "https://www.apparelnbags.com/jscripts/slideshow_header.js";
document.body.appendChild(element6);

var element6 = document.createElement("script");
element6.src = "https://www.apparelnbags.com/jscripts/slideshow_header.js";
document.body.appendChild(element6);

var element7 = document.createElement("script");
element7.src = "https://www.apparelnbags.com/jscripts/jquery.js";
document.body.appendChild(element7);

var element8 = document.createElement("script");
element8.src = "https://www.apparelnbags.com/jscripts/jquery.lazyload.js";
document.body.appendChild(element8);

var element9 = document.createElement("script");
element8.src = "http://www.apparelnbags.com/AnBTreeViewMenu/jsTreeMenu/jMenu.js";
document.body.appendChild(element9);

}
if (window.addEventListener)
window.addEventListener("load", downloadJSAtOnload, false);
else if (window.attachEvent)
window.attachEvent("onload", downloadJSAtOnload);
else window.onload = downloadJSAtOnload;

</script>
</div>

<div id="dvHeaderMiddle" style="position:absolute; top:400px; left:350px;">

</div>

<script type="text/javascript">
document.write("Time After loading all scripts");
    document.write(myGetTime() +"<br/>");
</script>

</body>
</html> 
```

欢迎 亲爱的 michael mc gurk 下面是 StackOverFlow 的另一个答案。它也很方便

[在此处输入链接描述](https://stackoverflow.com/questions/5852767/possible-to-defer-loading-of-jquery)

```
(function() {
      function getScript(url,success){
        var script=document.createElement('script');
        script.src=url;
        var head=document.getElementsByTagName('head')[0],
            done=false;
        script.onload=script.onreadystatechange = function(){
          if ( !done && (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete') ) {
            done=true;
            success();
            script.onload = script.onreadystatechange = null;
            head.removeChild(script);
          }
        };
        head.appendChild(script);
      }
        getScript('http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js',function(){
            // YOUR CODE GOES HERE AND IS EXECUTED AFTER JQUERY LOADS
        });
    })(); 
```

我真的会将 jQuery 和 jQuery-UI 合并到一个文件中并使用一个 url。如果您真的想单独加载它们，只需链接 getScripts：

```
getScript('http://myurltojquery.js',function(){
        getScript('http://myurltojqueryUI.js',function(){
              //your tab code here
        })
}); 
```

快乐编码:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-13T10:18:46.403

I don't think the provided solutions work.

Appending the script as below will not respect the order of the script breaking dependecy.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-12T22:05:49.783

这可能行得通！而且您可能可以更短地重写代码。祝你好运！

```
<script type="text/javascript">
    var mobjs1 = "http://yoursite.com/js/mobile1.js";
    var mobjs2 = "http://yoursite.com/js/mobile2.js";
    var mobjs3 = "http://yoursite.com/js/mobile3.js";
    var mobjs4 = "http://yoursite.com/js/mobile4.js";

    var mobcss = "http://yoursite.com/css/mobile.css";
    var stylesheet = "stylesheet";

        function downloadJSAtOnload() {
            var css = document.createElement("link");
            var js1 = document.createElement("script");
            var js2 = document.createElement("script");
            var js3 = document.createElement("script");
            var js4 = document.createElement("script");

            css.href= mobcss;
            css.rel= stylesheet;
            js1.src = mobjs1;
            js2.src = mobjs2;
            js3.src = mobjs3;
            js4.src = mobjs4;
            document.body.appendChild(css);
            document.body.appendChild(js1);
            document.body.appendChild(js2);
            document.body.appendChild(js3);
            document.body.appendChild(js4);
        }
        // Browser Capability
        if (window.addEventListener)
            window.addEventListener("load", downloadJSAtOnload, false);
        else if (window.attachEvent)
            window.attachEvent("onload", downloadJSAtOnload);
        else window.onload = downloadJSAtOnload;
</script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-07T16:14:56.843

在`downloadJSAtOnload()`函数中，您只需加载所有三个脚本。这是最简单的复制/粘贴方法：

```
// Add a script element as a child of the body
function downloadJSAtOnload() {
     var element = document.createElement("script");
     element.src = "deferredfunctions.js";
     document.body.appendChild(element);
     element = document.createElement("script");
     element.src = "deferredfunctions2.js";
     document.body.appendChild(element);
     element = document.createElement("script");
     element.src = "deferredfunctions3.js";
     document.body.appendChild(element);
}

 // Check for browser support of event handling capability
 if (window.addEventListener)
     window.addEventListener("load", downloadJSAtOnload, false);
 else if (window.attachEvent)
     window.attachEvent("onload", downloadJSAtOnload);
 else window.onload = downloadJSAtOnload; 
```

而且，这里有一个更清洁的方法：

```
function loadScript(src) {
     var element = document.createElement("script");
     element.src = src;
     document.body.appendChild(element);
}

// Add a script element as a child of the body
function downloadJSAtOnload() {
    loadScript("script1.js");
    loadScript("script2.js");
    loadScript("script3.js");
}

 // Check for browser support of event handling capability
 if (window.addEventListener)
     window.addEventListener("load", downloadJSAtOnload, false);
 else if (window.attachEvent)
     window.attachEvent("onload", downloadJSAtOnload);
 else window.onload = downloadJSAtOnload; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-01T14:53:50.013

将您的文件路径放在一个数组中并循环遍历它

例子

```
<script type="text/javascript">
        function downloadJSAtOnload() {
            var jsFiles = ['js/jquery.script1.js','js/jquery.script2.js','js/jquery.script3.js'];
            var fileAmount = jsFiles.length;
            for (var i = 0; i < fileAmount; i++) {
                var element = document.createElement("script");
                element.src = jsFiles[i];
                document.body.appendChild(element);
            }
        }
        if (window.addEventListener)
            window.addEventListener("load", downloadJSAtOnload, false);
        else if (window.attachEvent)
            window.attachEvent("onload", downloadJSAtOnload);
        else window.onload = downloadJSAtOnload;
    </script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-07T16:19:00.257

您只需为函数提供一个参数，以便能够使用不同的脚本调用它：

```
 // Add a script element with the url as a child of the body
 function downloadJS(url) {
     var element = document.createElement("script");
     element.src = url;
     document.body.appendChild(element);
 }

 onload(function(){
     downloadJS("deferredfunctions.js");
     downloadJS("deferredfunctions2.js");
     downloadJS("deferredfunctions3.js");
 }); 
```

# java - 获得令牌后如何从 Google Plus API 获取电子邮件地址

> ID：10935628
> 
> 赞同：6
> 
> 时间：2012-06-07T16:08:48.287
> 
> 标签：java, google-plus

我已经使用 oauth2.0 获得了访问令牌。我能够获取人名、性别等，但无法获取用户的电子邮件地址。

任何人都可以粘贴一些示例代码或有关如何从 google plus API 获取电子邮件地址的任何建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T12:20:15.347

You can retrieve a user's email address if they specifically authorize your application to see their email address.

Set your scopes to:

```
https://www.googleapis.com/auth/plus.login
https://www.googleapis.com/auth/userinfo.email 
```

The JavaScript calls look like this:

```
gapi.client.load('oauth2', 'v2', function() {
  gapi.client.oauth2.userinfo.get().execute(function(resp) {
    // Shows user email
    console.log(resp.email);
  })
});

gapi.client.load('plus', 'v1', function() {
  gapi.client.plus.people.get( {'userId' : 'me'} ).execute(function(resp) {
    // Shows other profile information
    console.log(resp);
  })
}); 
```

More information [https://developers.google.com/+](https://developers.google.com/+).

Note that you do not need scopes for plus.me or userinfo.profile.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:28:08.650

将未将其设置为对“公共”可见的人的电子邮件地址公开显然是一个隐私问题，因此这是不可能的。

公开已将电子邮件地址可见性设置为“公开”的人员的电子邮件地址是可能的，但目前还没有。目前是一个[悬而未决的问题](http://code.google.com/p/google-plus-platform/issues/detail?id=45)

**编辑：**问题现已解决，因此您可以按照其他答案中的步骤来获取它。

# python - 如何使用 numpy 创建单位矩阵

> ID：10935629
> 
> 赞同：11
> 
> 时间：2012-06-07T16:08:49.090
> 
> 标签：python, numpy

如何使用 numpy创建单位*矩阵？*有没有比这更简单的语法

```
numpy.matrix(numpy.identity(n)) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-09T03:30:15.677

这是一个更简单的语法：

```
np.matlib.identity(n) 
```

这是一个运行得更快的更简单的语法：

```
In [1]: n = 1000
In [2]: timeit np.matlib.identity(n)
100 loops, best of 3: 8.78 ms per loop
In [3]: timeit np.matlib.eye(n)
1000 loops, best of 3: 695 us per loop 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-08-01T08:22:40.837

np.eye[也](http://docs.scipy.org/doc/numpy/reference/generated/numpy.eye.html)可用于创建一个身份数组 (In)。

例如，

```
>>> np.eye(2, dtype=int)
array([[1, 0],
       [0, 1]])
>>> np.eye(3, k=1)
array([[ 0.,  1.,  0.],
       [ 0.,  0.,  1.],
       [ 0.,  0.,  0.]]) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-07T16:13:28.093

我认为没有*更简单*的解决方案。*但是，您可以更有效地*做到这一点：

```
numpy.matrix(numpy.identity(n), copy=False) 
```

这避免了不必要的数据复制。

# sas - 计算每个变量的个数，其中每个变量 =1

> ID：10935630
> 
> 赞同：-1
> 
> 时间：2012-06-07T16:08:55.613
> 
> 标签：sas

你能帮助计算每个变量=1的每个变量的数量吗？我在这里发布了如何计算丢失的数字。希望这是类似的方式。提前致谢。

```
/*y00*/
%let list0=OCALZHMR OCARTERY OCARTH  OCCHD OCDIABTS OCHBP OCMENTAL OCMYOCAR
          OCOTHART OCPSYCH OCSTROKE;

/*y01 and y02*/
%let list1=D_CFAIL D_CHD D_HBP D_MYOCAR D_OTHHRT  D_PSYCH D_RHYTHM D_STROKE 
       D_VALVE OCALZHMR OCARTERY OCARTH  OCCHD OCDIABTS OCHBP OCMENTAL OCMYOCAR 
       OCOTHART  OCPSYCH OCSTROKE;

proc means data=cohort00 nmiss noprint;
     var &list0; 
     output out=y2000_nmiss(drop=_:) nmiss= ;
run;

proc means data=cohort01 nmiss noprint;
     var &list1; 
     output out=y2001_nmiss(drop=_:) nmiss= ;
run;

data y2000_nmiss;
 set y2000_nmiss;
 j=1;
run;

data y2001_nmiss;
 set y2001_nmiss;
 j=1;
run;

proc transpose data=y2000_nmiss out=long0(rename=(COL1=Y2000 _name_=VAR));
     by j;
run;
proc transpose data=y2001_nmiss out=long1(rename=(COL1=Y2001 _name_=VAR));
     by j;
run;

data ATC_missing;
  merge long0 long1;
  by VAR;
  drop j;
run; 
```

这是丢失数量的输出表的一部分：

```
 VARS  Y2000   Y2001  Y2002
OCDIABTS    0     1        0
OCHBP       0     0        0
OCMENTAL   17    18       10
OCMYOCAR    0     0        0
OCOTHART    0     0     4758
OCOTHHRT    .     .        .
OCPSYCH     0     0        0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T08:19:32.813

```
%let list1=Width Length Depth;

data work.is_even / view=work.is_even;
set sashelp.lake;
   array vars {*} &list1 ;
   drop i;
   do i=1 to dim(vars);
       if mod(round(vars(i), 1),2)  = 0 /* would be VARS(I)=1 for your case */
        then vars(i)=1;
   else vars(i)=.;
   end;
run;

proc means data=work.is_even n;
run; 
```

首先，我创建了一个 datastep 视图 work.is_even（查看以避免数据的完整副本），它以我需要的方式操作数据。在这里，如果舍入值是偶数，它将覆盖变量的原始值（不在原始数据中，只是在该视图中）1，如果是奇数，则覆盖 null。然后，只计算非缺失值（PROC MEANS 中的 N 统计量）。

# c++ - 二进制搜索以找到数字所在的范围

> ID：10935635
> 
> 赞同：12
> 
> 时间：2012-06-07T16:09:08.447
> 
> 标签：c++

我有一个数组

```
Values array: 12 20 32 40 52
              ^  ^  ^  ^  ^
              0  1  2  3  4 
```

我必须在其上执行二进制搜索以找到数字所在范围的索引。例如：

1.  给定数字 -> 19（它位于索引 0 和 1 之间），返回 0
2.  给定数字 -> 22（位于索引 1 和 2 之间），返回 1
3.  给定数字 -> 40（位于索引 3 和 4 之间），返回 3

我以以下方式实现了二进制搜索，这对于案例 1 和 3 是正确的，但如果我们搜索案例 2 或 52、55 32 等则不正确。

```
#include <iostream>
using namespace std;

int findIndex(int values[], int number, unsigned first, unsigned last)
{
    unsigned midPoint;
    while(first<last)
    {
        unsigned midPoint = (first+last)/2;
        if (number <= values[midPoint])
            last = midPoint -1;
        else if (number > values[midPoint])
            first = midPoint + 1;
    }
    return midPoint;
}

int main()
{
    int a[] = {12, 20, 32, 40, 52};
    unsigned i = findIndex(a, 55, 0, 4);
    cout << i;
} 
```

`bool found`不允许使用其他变量，例如。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-07T16:27:26.383

C 或 C++ 中的范围通常被指定为直接指向下限，但超过上限。除非您感到极度自虐，否则您可能也希望在搜索中遵守该约定。

假设您要遵循这一点，那么您`last = midpoint-1;`是不正确的。相反，您希望将 last 设置为您将实际使用的范围末尾之后的一个*，*所以它应该是`last = midpoint;`

你也只需要*一个*比较，而不是两个。在二分搜索中，只要两个边界不相等，您将设置中心点的下限或上限，因此您只需进行一次比较即可确定哪个。

至少按照惯例，在 C++ 中，您使用`<`而不是`<=`,`>`等进行所有比较。上述任何方法都可以工作，但遵循仅使用的约定`<`可以避免对包含的类型施加额外（不必要的）要求。

尽管大多数面试官可能不在乎，但当你这样做时，也有潜在的溢出`midpoint = (left + right)/2;`。我通常更喜欢`midpoint = left + (right - left)/2;`

考虑到这些，代码可能看起来像这样：

```
template <class T>
T *lower_bound(T *left, T *right, T val) {
    while (left < right) {
        T *middle = left + (right - left) / 2;
        if (*middle < val)
            left = middle + 1;
        else
            right = middle;
    }
    return left;
}

template <class T>
T *upper_bound(T *left, T *right, T val) {
    while (left < right) {
        T *middle = left + (right - left) / 2;
        if (val < *middle)
            right = middle;
        else
            left = middle + 1;
    }
    return left;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-30T22:30:15.603

为什么不使用标准库函数？

```
#include <vector>
#include <algorithm>
#include <iostream>

using namespace std;

int main() {
    for (int input = 10; input < 55; input++) {
        cout << input << ": ";

        // Your desire:
        vector<int> v = { 12, 20, 32, 40, 52 };
        if (input < v.front() || input > v.back()) {
            cout << "Not found" << endl;
        } else {
            auto it = upper_bound(v.begin(), v.end(), input);
            cout << it - v.begin() - 1 << endl;
        }
    }
} 
```

注意：一个非常酷的网站 - [http://en.cppreference.com/w/cpp/algorithm](http://en.cppreference.com/w/cpp/algorithm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T12:29:59.623

这将在 **min(A[i]) <= key <=max(A[i])的条件下工作**

```
int binary_search(int A[],int key,int left, int right)
{

  while (left <= right) {
        int middle = left + (right - left) / 2;
        if (A[middle] < key)
            left = middle+1;
        else if(A[middle] > key)
            right = middle-1;
        else
            return middle;
    }
    return (left - 1);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-21T16:34:06.747

对于**输入**

4

1 3 8 10

4

**输出**

3（3和8中的最小值）

```
#include <stdio.h>

int main()
{
   int c, first, last, middle, n, search, array[100];

   scanf("%d",&n);

for (c = 0; c < n; c++)
  scanf("%d",&array[c]);

   scanf("%d", &search);

   first = 0;
   last = n - 1;
   middle = (first+last)/2;

while (first <= last) {

  if (array[middle] < search)
  { 
     first = middle + 1;    }
  else if (array[middle] == search) {

     break;
  }
  else
  {  
     last = middle - 1;
  }

  middle = (first + last)/2;
 }
  printf("%d\n",array[middle]);
   return 0;   
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T23:22:23.093

成功的常规二进制搜索返回键的索引。如果找不到键，它总是停在比我们正在搜索的键大的最低键的索引处。我想以下修改后的二进制搜索算法会起作用。

```
Given sorted array A
Find a key using binary search and get an index. 
If A[index] == key
    return index;
else 
   while(index > 1 && A[index] == A[index -1]) index = index -1;
   return index; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T20:30:08.390

```
binsrch(array, num, low, high) {
if (num > array[high])
     return high;

while(1) {
     if (low == high-1)
          return low;
     if(low >= high)
          return low-1;        
     mid = (low+high)/2
     if (num < arr[mid])
          high = mid;
     else
          low = mid+1;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-17T20:31:18.793

这是一个更具体的答案

```
int findIndex(int values[],int key,int first, int last)
{
    if(values[first]<=key && values[first+1]>=key)// stopping condition
    {
        return first;
    }

   int imid=first+(last-first)/2;

   if(first==last || imid==first)
   {
        return -1;
   }
   if(values[imid]>key)
   {
        return findIndex(values,key,first,imid);
    }
    else if(values[imid]<=key)
    {
        return findIndex(values,key,imid,last);
    }

} 
```

我觉得这更符合您正在寻找的内容......而且我们不会在这个东西的最后一个值上废话

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-16T21:11:06.313

```
/* binary_range.c (c) 2016 adolfo@di-mare.com  */
/* http://stackoverflow.com/questions/10935635 */

/* This code is written to be easily translated to Fortran */

#include <stdio.h>   /* printf() */
#include <assert.h>  /* assert() */

/** Find the biggest index 'i' such that '*nSEED <= nVEC[i]'.
    - nVEC[0..N-1] is an strict ascending order array.
    - Returns and index in [0..N].
    - Returns 'N' when '*nSEED>nVEC[N-1]'.
    - Uses binary search to find the range for '*nSEED'.
*/
int binary_range( int *nSEED, int nVEC[] , int N ) {
    int lo,hi, mid,plus;

    if ( *nSEED > nVEC[N-1] ) {
        return N;
    }
    for (;;) { /* lo = binary_range_search() */
        lo = 0;
        hi = N-1;
        for (;;) {
            plus = (hi-lo)>>1; /* mid = (hi+lo)/2; */
            if ( plus == 0 ) {   assert( hi-lo==1 );
                if (*nSEED <= nVEC[lo]) {
                    hi = lo;
                }
                else {
                    lo = hi;
                }
            }
            mid = lo + plus; /* mid = lo + (hi-lo)/2; */

            if (*nSEED <= nVEC[mid]) {
                hi = mid;
            }
            else {
                lo = mid;
            }
            if (lo>=hi) { break; }
        }
        break;
    } /* 'lo' is the index */
    /* This implementation does not use division. */
    /* =========================================  */

    assert( *nSEED <= nVEC[lo] );
    return lo;
}

/** Find the biggest index 'i' such that '*nSEED <= nVEC[i]'.
    - nVEC[0..N-1] is an strict ascending order array.
    - Returns and index in [0..N].
    - Returns 'N' when '*nSEED>nVEC[N-1]'.
    - Uses sequential search to find the range for '*nSEED'.
*/
int sequential_range( int* nSEED, int nVEC[] , int N ) {
    int i;
    if ( *nSEED > nVEC[N-1] ) {
        return N;
    }
    i=0;
    while ( i<N ) {
        if ( *nSEED <= nVEC[i] ) { break; }
        ++i;
    }
    return i;
}

/** test->stackoverflow.10935635(). */
void test_10935635() {
{{  /* test.stackoverflow.10935635()                                  */
    /* http://stackoverflow.com/questions/10935635                    */
    /* binary_range search to find the range in which the number lies */
    /*              0  1  2  3  4                                     */
    int nVEC[] = { 12,20,32,40,52 }; int val;
    int N = sizeof(nVEC)/sizeof(nVEC[0]); /* N = DIM(nVEC[]) */

    val=19; val   = binary_range( &val,nVEC,N );

    /* 19 -> [12 < (19) <= 20] -> return 1 */
    val=19; assert( binary_range( &val,nVEC,N ) == 1 );

    /* 22 -> [20 < (22) <= 32] -> return 2 */
    val=22; assert( binary_range( &val,nVEC,N ) == 2 );

    /* 40 -> [32 < (40) <= 40] -> return 3 */
    val=40; assert( binary_range( &val,nVEC,N ) == 3 );

    /* Everything over 52 returns N */
    val=53; assert( binary_range( &val,nVEC,N ) == N );
}}
}

/** Test program. */
int main() {
    if (1) {
        printf( "\ntest_10935635()" );
        test_10935635();
    }
    printf( "\nEND" );
    return 0;
}

/* Compiler: gcc.exe (tdm-1) 4.9.2 */
/* IDE:      Code::Blocks 16.01    */
/* Language: C && C++              */

/* EOF: binary_range.c */ 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-09T14:25:50.957

我知道这是一个旧线程，但由于我必须解决类似的问题，我想我会分享它。给定一组不重叠的整数范围，我需要测试给定值是否位于任何这些范围内。以下（在 Java 中）使用修改后的二进制搜索来测试值是否位于已排序（从最低到最高）的整数范围集中。

```
/**
 * Very basic Range representation for long values
 *
 */
public class Range {

private long low;
private long high;

public Range(long low, long high) {
    this.low = low;
    this.high = high;
}

public boolean isInRange(long val) {
    return val >= low && val <= high;
}

public long getLow() {
    return low;
}

public void setLow(long low) {
    this.low = low;
}

public long getHigh() {
    return high;
}

public void setHigh(long high) {
    this.high = high;
}

@Override
public String toString() {
    return "Range [low=" + low + ", high=" + high + "]";
}
}

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

//Java implementation of iterative Binary Search over Ranges
class BinaryRangeSearch { 
// Returns index of x if it is present in the list of Range, 
// else return -1 
int binarySearch(List<Range> ranges, int x) 
{ 

    Range[] arr = new Range[ranges.size()];
    arr = ranges.toArray(arr);
    int low = 0, high = arr.length - 1; 
    int iters = 0;
    while (low <= high) { 
        int mid = low + (high - low) / 2; // find mid point

        // Check if x is present a
        if (arr[mid].getLow() == x) {
            System.out.println(iters + " iterations");
            return mid;                 
        }

        // If x greater, ignore left half 
        if (x > arr[mid].getHigh()) {
            low = mid + 1; 
        }
        else if (x >= arr[mid].getLow()) {
            System.out.println(iters + " iterations");
            return mid;
        }

        // If x is smaller, ignore right half of remaining Ranges
        else
            high = mid - 1; 
        iters++;
    } 

    return -1; // not in any of the given Ranges
} 

// Driver method to test above 
public static void main(String args[]) 
{ 
    BinaryRangeSearch ob = new BinaryRangeSearch(); 

    // make a test list of long Range
    int multiplier = 1;

    List<Range> ranges = new ArrayList<>();
    int high = 0;
    for(int i = 0; i <7; i++) {

        int low = i + high;
        high = (i+10) * multiplier;
        Range r = new Range(low, high);
        multiplier *= 10;
        ranges.add(r);
    }

    System.out.println(Arrays.toString(ranges.toArray()));

    int result = ob.binarySearch(ranges, 11); 
    if (result == -1) 
        System.out.println("Element not present"); 
    else
        System.out.println("Element found at "
                        + "index " + result); 
} 
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-01T10:41:44.013

我的python实现：

时间复杂度：O(log(n)) 空间复杂度：O(log(n))

```
def searchForRange(array, target):
    range = [-1, -1]
    alteredBinarySerach(array, target, 0, len(array) -1, range, True)
    alteredBinarySerach(array, target, 0, len(array) -1, range, False)
    return range

def alteredBinarySerach(array, target, left, right, range, goLeft):
    if left > right:
        return

    middle = (left+ right)//2

    if array[middle] > target:
        alteredBinarySerach(array, target, left, middle -1, range, goLeft)
    elif array[middle] < target:
        alteredBinarySerach(array, target, middle +1, right, range, goLeft)
    else:
        if goLeft:
            if middle == 0 or array[middle -1] != target:
                range[0] = middle
            else:
                alteredBinarySerach(array, target, left, middle -1 , range, goLeft)
        else:
            if middle == len(array) -1 or array[middle+1] != target:
                range[1] = middle
            else:
                alteredBinarySerach(array, target, middle +1, right , range, goLeft) 
```

# android - JQuery Mobile 输入焦点重复

> ID：10935636
> 
> 赞同：0
> 
> 时间：2012-06-07T16:09:13.420
> 
> 标签：android, html, mobile, jquery-mobile, cordova

我正在开发一个使用 PhoneGap 和 JQuery Mobile for Android 的应用程序。

我在主页上有 2 个输入，一切正常，但是当我关注一个输入时，看起来 JQuery 复制了它，另一个在原始输入之上，没有边框半径，如果我滚动内容，当它试图在原件上重新定位时，我可以看到下面的原件。

你以前见过这种行为吗？该怎么做才能摆脱它。

谢谢

# javascript - 使用 Javascript 更新复选框选择的输入字段

> ID：10935637
> 
> 赞同：2
> 
> 时间：2012-06-07T16:09:16.390
> 
> 标签：javascript, html

我希望发生两件事。

一

> 当进行选择时，输入字段更新为总数，

二

> 复选框是动态生成的，有时可能多达六个，有时低至一个产品。

这是我所做的，但我无法让它工作:(

```
 <script type="text/javascript">
    function updateTotal(){
        document.getElementById('total').value = 
            (document.getElementById('date0').checked?
             parseFloat(document.getElementById('date0').price):0) +
             (document.getElementById('date1').checked?
             parseFloat(document.getElementById('date1').price):0) +
             (document.getElementById('date2').checked?
             parseFloat(document.getElementById('date2').price):0);
    }
    </script> 
```

以此为形式

```
<form>
 <td id="datecontainer" onchange="Process(this.options[this.selectedIndex].value)">
   <input id="date0" type="checkbox" name="form[date]" value="blue" price="10" onChange="javascript:updateTotal();">product 1<br />
   <input id="date1" type="checkbox" name="form[date]" value="green" price="30" onChange="javascript:updateTotal();">product 2<br />
   <input id="date2" type="checkbox" name="form[date]" value="red" price="50" onChange="javascript:updateTotal();">product 3<br />
 </td>
 <td>
  Total cost is:
  <input name="total" id="total" type="text" readonly="readonly" style="border:0px;">
 </td>
</form> 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:27:21.013

您可以通过更改代码和标记来做到这一点，如下所示：

**HTML**

```
<td id="datecontainer" onchange="Process(this.options[this.selectedIndex].value)">
   <input id="date0" type="checkbox" name="form[date]" value="blue" data-price="10" onChange="updateTotal();">product 1<br />
   <input id="date1" type="checkbox" name="form[date]" value="green" data-price="30" onChange="updateTotal();">product 2<br />
   <input id="date2" type="checkbox" name="form[date]" value="red" data-price="50" onChange="updateTotal();">product 3<br />
 </td>
 <td>
  Total cost is:
  <input name="total" id="total" type="text" readonly="readonly" style="border:0px;">
 </td>​ 
```

**JS**

```
function updateTotal(){
    var date0 = document.getElementById('date0');
    var date1 = document.getElementById('date1');
    var date2 = document.getElementById('date2');
    var amount = 0;    
    amount += date0.checked ? parseFloat(date0.getAttribute('data-price')) : 0;
    amount += date1.checked ? parseFloat(date1.getAttribute('data-price')) : 0;
    amount += date2.checked ? parseFloat(date2.getAttribute('data-price')) : 0;
    document.getElementById('total').value = amount;

}​ 
```

有几点需要注意：

您不需要在 onchanged 属性中的函数之前包含 javascript:。您应该使用 data-* 前缀作为自定义属性的前缀。你应该用 tr 和 table 包围你的 td 标签。您使用它们的方式会使更多发送与 li 孩子一起使用 ul 标签。

**演示**- [http://jsfiddle.net/9mxh5/](http://jsfiddle.net/9mxh5/)

***如果复选框是动态生成的并且您不知道您可能有多少：***

**HTML**

```
<td id="datecontainer" onchange="Process(this.options[this.selectedIndex].value)">
   <input id="date0" type="checkbox" name="form[date]" value="blue" data-price="10" onChange="updateTotal(this);">product 1<br />
   <input id="date1" type="checkbox" name="form[date]" value="green" data-price="30" onChange="updateTotal(this);">product 2<br />
   <input id="date2" type="checkbox" name="form[date]" value="red" data-price="50" onChange="updateTotal(this);">product 3<br />
 </td>
 <td> 
```

**JS**

```
var amount = 0;

function updateTotal(element){
        var price = parseFloat(element.getAttribute('data-price'));
        amount += element.checked ? price : price*(-1);
        document.getElementById('total').value = amount;

    }​ 
```

**演示**- [http://jsfiddle.net/9mxh5/2/](http://jsfiddle.net/9mxh5/2/)

# iphone - IOS [NSURL initFileURLWithPath:]: nil string parameter on loading video

> ID：10935638
> 
> 赞同：3
> 
> 时间：2012-06-07T16:09:25.233
> 
> 标签：iphone, objective-c, ios

我的视频内容有问题。我想从我的视图控制器加载一个视频，我收到这个错误：[NSURL initFileURLWithPath:]: nil string parameter 当我尝试从一个 url 加载视频时，视频不会显示。

我确信我的变量 targetURN 不为零。

从这里我加载我的视图控制器：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    switch (buttonIndex) {
        case 0:
            [self openVideoView:@"Video"];
        break;
        case 1:
            [self openWebview:@"About"];
        break;
        case 2:
            [self openWebview:@"http://www.url.com"];
        break;
    }
}

- (void)openVideoView:(NSString *)url{
    IDPVideoView *vv = [[IDPVideoView alloc] initWithURN:url];
    [self presentModalViewController:vv animated:NO];    
} 
```

在我的视图控制器中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    NSURL *videoURL = nil;

    if ([self.targetURN hasPrefix:@"http"])
    {
        videoURL = [NSURL URLWithString:targetURN];
    }
    else
    {
        videoURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:targetURN ofType:@"mp4"]];
    }
    if(videoURL != nil) {
        MPMoviePlayerController *moviePlayer = 
        [[MPMoviePlayerController alloc] initWithContentURL:videoURL];
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackDidFinish:) name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];

        moviePlayer.controlStyle = MPMovieControlStyleDefault;
        moviePlayer.shouldAutoplay = YES;
        [moviePlayer prepareToPlay];
        [self.view addSubview:moviePlayer.view];
        [moviePlayer setFullscreen:YES animated:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:26:29.920

您是否尝试过先分配网址？

```
NSURL *vidURL = [[NSURL alloc] initWithString:self.targetURN]; 
```

作为一般建议，请尝试`self.targetURN`一直使用，或将其同步为不同的名称，例如

```
@synchronize targetURN = _targetURN 
```

然后`_targetURN`在您的代码中使用。这确保您（在任何情况下）使用正确的属性。

（当然这适用于您的所有财产）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T07:16:06.187

我通过添加这一行解决了错误部分

```
NSString *urlString = [NSString stringWithFormat:url];

- (void)openVideoView:(NSString *)url{
    NSString *urlString = [NSString stringWithFormat:url];
    IDPVideoView *vv = [[IDPVideoView alloc] initWithURN:url];
    [self presentModalViewController:vv animated:NO];    
} 
```

但是视频仍然没有显示。

# lotus - 如何自动刷新未读计数

> ID：10935640
> 
> 赞同：0
> 
> 时间：2012-06-07T16:09:33.810
> 
> 标签：lotus, lotus-domino

用户工作区包含多个 chiklet，这些 chiklet 通常可以引用已停用的服务器，如果发送指向该应用程序的新副本的链接，则会引发错误“您未获得授权”。要解决此问题，用户可以右键单击工作区的任何开放空间并选择“刷新未读计数”选项，该选项会删除任何引用已停用服务器的 chiklet。我能够处理工作区 desktop8.ndk，但对“GetAllUnreadDocuments”的调用什么也没做。我还查看了 Lotus C API 8.5 Reference 并发现了一些我不确定能否解决我的问题的条目问题并检查了 6/7/8/8.5 论坛。

所以，问题是：是否可以创建一个例程来自动化“刷新未读计数”过程，以便可以通过按钮或在收件箱打开后对其进行调用？

我认为 Panagenda 公司有一个流程可以从工作空间中删除旧服务器，但不确定他们是如何处理的。我确实看到“cache.ndk”有一个字段 $SourceDbPath，它存储数据库的服务器/路径。也许解析它并调用服务器以打开“names.nsf”是要走的路。但是，“cache.ndk”并不包含用户工作区中的所有应用程序。

谢谢，

德文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T02:46:58.297

据我所知，工作区不使用普通的 Notes 文档结构，也没有专门用于访问它的已发布 API。Panagenda 对数据结构进行了广泛的研究，并编写了自己的低级代码来操作它们。

# android-emulator - Admob 和 API 版本 8

> ID：10935642
> 
> 赞同：1
> 
> 时间：2012-06-07T16:09:42.087
> 
> 标签：android-emulator, admob, android-version

我在一台……比方说：不是超现代计算机，到目前为止，使用 API 版本 8 的模拟器开发都做得很好。现在我尝试使用 Admob（在干预了从未显示任何广告的“移动应用程序的 Adsense”之后某种原因），但事实证明我需要一个 13 的 API 目标才能使用它。有什么办法让它与8一起运行吗？

在我的清单文件中，我定义了

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15" /> 
```

已经。经过我的调查和到目前为止我阅读的提示之后，我尝试了 Android Manifest 的“减少”集，

```
<activity android:name="com.google.ads.AdActivity"      android:configChanges="keyboard|keyboardHidden|orientation" /> 
```

但是在 v8 模拟器上运行它会产生一些异常，基本上是抱怨未设置所需的 configChanges。我已经阅读了有关使用旧版 Admob SDK 的“技巧”，以及 Google 的警告，即从 2011 年底开始，他们将不再显示广告，必须使用新版本。

最糟糕的是，如果我想使用 Admob，我什至无法在连接的手机上运行自己的应用程序（HTC Legend，v2.3.7 / API 10）？！

或者也许我错过了一些东西，我现在很沮丧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:55:08.657

有一种方法。查看[这篇博文](http://googleadsdeveloper.blogspot.com/2011/11/migrating-to-v431-of-admob-sdk-for.html)，它也适用于 AdMob SDK 6.0。

TL；DR：

将目标设置`project.properties`为`android-13`或更高。您需要全套配置：

```
 <activity android:name="com.google.ads.AdActivity"
           android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/> 
```

只要 minSdkVersion 为 8，你仍然可以在 Android 2.2 上运行。

# vb.net - 如何在 ComboBox 中捕获对象的事件？

> ID：10935644
> 
> 赞同：0
> 
> 时间：2012-06-07T16:09:45.587
> 
> 标签：vb.net, events, combobox

所以基本上我在一个表单上有一个 ComboBox，我通过添加名为“Category”的自定义对象并将 DisplayMember 设置为我的对象的属性“Name”来填充它。

在另一个可以同时打开的表单上，我可以编辑这些“类别”对象的名称。我提出了一个事件“NameChanged”，但我怎样才能在包含 ComboBox 的表单上捕捉到它？

即使对象“类别”的属性“名称”发生变化，组合框上的显示也不会自动更新。所以我需要赶上这个事件，但我不知道该怎么做。

感谢任何可以帮助我的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:31:10.550

如果使 Category 类实现 INotifyPropertyChanged，则可以在属性更改时处理事件。

为此，您必须从一个简单的属性更改您的属性：

```
// will NOT raise event
public string Name { get; set; } 
```

更像是：

```
// will raise event
public string Name
{
    get { return _Name; }
    set
    {
        if (_Name != value)
        {
            _Name = value;
            OnPropertyChanged("Name");
        }
    }
}
private string _Name; 
```

然后在你的类中实现 INotifyPropertyChanged ：

```
 public event EventHandler<PropertyChangedEventArgs> PropertyChanged;

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, e);
    }
    protected virtual void OnPropertyChanged(string propertyName)
    {
        OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
    } 
```

现在，将 Category 对象添加到 ComboBox 时，订阅 PropertyChanged 事件，该事件将在每次 Name 属性更改时引发。

**更好的方法**

考虑使用[Binding](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.aspx "捆绑")类来填充您的 ComboBox。当属性值更改时，绑定会自动使用 INotifyPropertyChanged 更新显示。

# php - 将新行从 PHP 替换为 JavaScript

> ID：10935645
> 
> 赞同：3
> 
> 时间：2012-06-07T16:09:56.940
> 
> 标签：php, javascript, textbox, compatibility

情况很简单：

我发布了一个带有文本区域的纯 HTML 表单。然后，在 PHP 中，我根据表单的内容注册了一个 JavaScript 函数。

这是使用以下代码完成的：

```
$js = sprintf("window.parent.doSomething('%s');", $this->textarea->getValue()); 
```

在我尝试处理换行符之前，它就像一个魅力。我需要用 char 13 替换换行符（我相信），但我无法找到可行的解决方案。我尝试了以下方法：

```
$textarea = str_replace("\n", chr(13), $this->textarea->getValue()); 
```

以及以下内容：

```
$js = sprintf("window.parent.doSomething('%s');", "'+String.fromCharCode(13)+'", $this->textarea->getValue()); 
```

有没有人知道我如何正确处理这些换行符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T10:36:11.610

您几乎就在那里，您只是忘记实际替换换行符。

这应该可以解决问题：

```
$js = sprintf("window.parent.doSomething('%s');"
    , preg_replace(
              '#\r?\n#'
            , '" +  String.fromCharCode(13) + "'
            , $this->textarea->getValue()
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:22:25.187

你的意思是：

```
str_replace("\n", '\n', $this->textarea->getValue()); 
```

用文字字符串替换所有换行符`'\n'`。

* * *

但是，您最好将其编码为 JSON：

```
$js = sprintf(
    "window.parent.doSomething('%s');",
    json_encode($this->textarea->getValue())
); 
```

这也将修复报价。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T10:37:28.570

您的问题已经在我们代码库的其他地方得到解决......

取自我们的 WebApplication.php 文件：

```
 /**
     * Log a message to the javascript console
     *
     * @param $msg
     */
    public function logToConsole($msg)
    {
        if (defined('CONSOLE_LOGGING_ENABLED') && CONSOLE_LOGGING_ENABLED)
        {
            static $last = null;
            static $first = null;
            static $inGroup = false;
            static $count = 0;

            $decimals = 5;

            if ($first == null)
            {
                $first          = microtime(true);
                $timeSinceFirst = str_repeat(' ', $decimals) . ' 0';
            }

            $timeSinceFirst = !isset($timeSinceFirst)
                ? number_format(microtime(true) - $first, $decimals, '.', ' ')
                : $timeSinceFirst;

            $timeSinceLast = $last === null
                ? str_repeat(' ', $decimals) . ' 0'
                : number_format(microtime(true) - $last, $decimals, '.', ' ');

            $args = func_get_args();
            if (count($args) > 1)
            {
                $msg = call_user_func_array('sprintf', $args);
            }
            $this->registerStartupScript(
                sprintf("console.log('%s');", 
                    sprintf('[%s][%s] ', $timeSinceFirst, $timeSinceLast) .
                    str_replace("\n", "'+String.fromCharCode(13)+'", addslashes($msg))));

            $last = microtime(true);
        }
    } 
```

您感兴趣的是：

```
str_replace("\n", "'+String.fromCharCode(13)+'", addslashes($msg)) 
```

请注意，在您的问题中`sprintf`，您忘记了 str_replace...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-07T16:19:08.357

采用

```
str_replace(array("\n\r", "\n", "\r"), char(13), $this->textarea->getValue()); 
```

这应该用 char(13) 替换字符串中的所有新行

# php - 使用一两个数据库处理少量数据

> ID：10935652
> 
> 赞同：0
> 
> 时间：2012-06-07T16:10:23.303
> 
> 标签：php, mysql

对于存储少量用户数据的网站，是否有任何优点或缺点？到目前为止，我有一个包含所有需要的用户数据（地址、电话等）的数据库。现在我正在考虑建立一个数据库来跟踪当前事件，其中一些与特定用户相关联。除了可能使按“类型”（用户数据库和“事件数据库”）分隔数据更“有品味”之外，是否有任何真正的理由这样做？用户数量永远不会超过 100。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:13:01.023

如果您要链接用户数据和当前事件数据，那么将这些数据放在单个数据库中的单独表中会容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:14:41.210

如果您实际上的意思是为一个小型网站拥有多个数据库，那么没有。您可能需要 1 个用于整个网站的数据库，尤其是在它很小的情况下。你会想要多个表。

我假设您将数据库和表混合在一起，这将使您的问题有意义，然后是的，您希望数据库中的多个表来存储不同的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:13:48.287

把事情分开总是最好的。为用户使用一个表，为事件使用另一个表。如果您只使用几个用户，您将不会有问题。但请记住以供将来参考

# jquery - jqGrid 字体设置被 jQueryUI 选项卡设置覆盖

> ID：10935657
> 
> 赞同：2
> 
> 时间：2012-06-07T16:10:45.083
> 
> 标签：jquery, css, jquery-ui, jqgrid

我有一个与此类似的[问题](https://stackoverflow.com/questions/7282130/wrong-font-size-when-using-jqgrid-inside-jqueryui-tab)。我正在使用 jQueryUI 选项卡来控制页面上的内容，并且在某些选项卡上我使用 jqGrid 来显示信息。jqGrid 的字体设置被选项卡定义的较大字体覆盖。该示例中的解决方案是将选项卡定义为 class `ui-jqgrid`。但是除了选项卡下的网格之外，他们什么都没有，因此该解决方案有效。如何仅覆盖网格的字体设置并允许 jqGrid 使用自己的字体设置，但保留选项卡下其他所有内容的设置？

你可以在这里看到它覆盖了我的 jqGrid 字体大小。我也尝试使用百分比，但它也忽略了这一点。

![CSS 计算](../Images/fb43c148757671e951ac210a8244e356.png)

更新 - CSS 计算样式： ![在此处输入图像描述](../Images/a271ac81df7beeb99567701f2ae275de.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:14:38.230

有很多方法可以解决问题。您如何确认[此处](https://stackoverflow.com/a/7287653/315935)描述的方式有效，但它会使其他文本具有`11px`您不想要的字体。

字体的问题是 CSS 设置（见[这里](https://github.com/jquery/jquery-ui/blob/1.8.21/themes/base/jquery.ui.theme.css#L17)）

```
.ui-widget .ui-widget { font-size: 1em; } 
```

因为 Tab 和 jqGrid 都有类`"ui-widget"`，所以设置会覆盖 jqGrid.css 中的字体设置（请参见[此处](https://github.com/tonytomov/jqGrid/blob/v4.3.3/css/ui.jqgrid.css#L2)）：

```
.ui-jqgrid {position: relative; font-size:11px;} 
```

结果你得到[了演示](http://www.ok-soft-gmbh.com/jqGrid/jqGridInjQueryTab0.htm)中的图片：

![在此处输入图像描述](../Images/411782d09b1512a7fe72144b2d19f1f7.png)

jQuery UI 使用`em`样式。例如，您可以在页面的 CSS 中包含以下内容

```
html, body { font-size: 75% } 
```

（见[这里](https://stackoverflow.com/a/7268360/315935)）。在这种情况下，您将获得以下结果（请参阅[演示](http://www.ok-soft-gmbh.com/jqGrid/jqGridInjQueryTab1.htm)）：

![在此处输入图像描述](../Images/ba0c1f18ccab3f5a0f911abb5bb74d1d.png)

顺便说一下 jqGrid 的文档间接建议（请参阅[此处](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:first_grid#html_file)的 HTML 页面示例）。我了解您可能不希望更改页面上其他字体的大小。

在这种情况下，您可以使用例如

```
.ui-jqgrid { font-size: 11px !important; } 
```

或者以下

```
.ui-jqgrid .ui-jqgrid-view { font-size: 11px; }
.ui-jqgrid .ui-jqgrid-pager { font-size: 11px; }
.ui-jqgrid .loading { font-size: 11px; } 
```

您可以[在下一个演示](http://www.ok-soft-gmbh.com/jqGrid/jqGridInjQueryTab2.htm)中看到该方法的结果：

![在此处输入图像描述](../Images/8ceeeb8fd4d7b4cfd1a10ef48abcded0.png)

如果我理解你是正确的，那就是你想要的结果。

**更新**：如果您使用 Chrome 的开发者工具，您可以看到与 IE 开发者工具中相同的信息来定位覆盖`font-size`jqGrid 的 CSS 样式。例如，在[我的第一个演示](http://www.ok-soft-gmbh.com/jqGrid/jqGridInjQueryTab0.htm)中，您将看到

![在此处输入图像描述](../Images/ee00057d7f4e74f4f3bbb1ddff7cff9b.png)

因此，如果在您的应用程序中我的上述建议不起作用，您应该检查应用于任何网格单元格的有效 CSS 样式，并找出哪个 CSS 设置覆盖了 jqGrid 的 CSS。

**更新 2**：从您通过电子邮件发送给我的链接中，我可以看到问题存在，因为您`<!DOCTYPE html ...>`之前忘记包含任何声明`<html>`。因此，Web 浏览器将您的页面解释为在 HTML 3.2 发布之前（1997 年之前）编写的非常老式的 HTML。它因此被命名为[Quirks 模式](http://en.wikipedia.org/wiki/Quirks_mode)。

要解决问题，您应该`<html>`在行之前包括

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

要不就

```
<!DOCTYPE html> 
```

（HTML5 标准）。此外，我强烈建议您在一些 HTML valirador 中验证您的 HTML 页面，例如[http://validator.w3.org/](http://validator.w3.org/)。您当前的代码是 HTML 和 XHTML 之间的混合，这不好。

**更新 2**：我另外发布[了功能请求](http://www.trirand.com/blog/?page_id=393/feature-request/explicitly-deny-the-usage-of-jqgrid-in-quirk-mode/#p26754)，我建议在 的情况下停止创建 jqGrid `document.documentMode <= 5`，因此在使用[Quirks 模式](http://en.wikipedia.org/wiki/Quirks_mode)（否`<!DOCTYPE html ...>`）的情况下。

**更新 3**：根据问题/答案，我向 trirand 发布了两个建议：[this](http://www.trirand.com/blog/?page_id=393/feature-request/explicitly-deny-the-usage-of-jqgrid-in-quirk-mode/#p26754)和[this](http://www.trirand.com/blog/?page_id=393/bugs/setting-font-size-in-ui-jqgrid-css/#p26757)。这两个建议都被接受并且现在是 jqGrid 的一部分（请参见[此处](https://github.com/tonytomov/jqGrid/commit/18930eff8a3984519607a872436713d6326ca897)和[此处](https://github.com/tonytomov/jqGrid/commit/cd019fc800ec29c44d0b2918f6d9b1395d9b3f0d)）。所以下一个版本的用户应该没有描述的问题。

# python - Python tkinter 滚动条不能很好地附加到列表框

> ID：10935658
> 
> 赞同：0
> 
> 时间：2012-06-07T16:10:51.127
> 
> 标签：python, listbox, scrollbar, tkinter

所以，我正在做其他人所说的：

```
scrollbar = Scrollbar(frame)

scrollbar.pack(side=RIGHT, fill=Y)

listbox = Listbox(frame, yscrollcommand=scrollbar.set)

listbox.pack()

scrollbar.config(command=listbox.yview) 
```

但似乎滚动条附加到整个框架而不是列表框本身......我唯一能做的就是使用 scrollbar.place() 而不是打包并将其放在列表框旁边，但是它们它只有一个 1 大小的滚动条，它并没有覆盖列表框 Y 条的一部分，这很丑……

有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:12:11.957

您确实需要将滚动条附加到框架上——但是您可以轻松地创建一个新框架来仅容纳滚动条和列表框。

例如

```
myframe=Frame(frame)
myframe.pack(side=RIGHT, fill=Y)
scrollbar = Scrollbar(myframe) 
scrollbar.pack(side=RIGHT, fill=Y)
listbox = Listbox(myframe, yscrollcommand=scrollbar.set) 
listbox.pack()
scrollbar.config(command=listbox.yview) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T18:26:34.610

小部件不相互连接，它们只占用容器内的空间。如果将滚动条打包在右侧，然后将列表框打包在右侧，它们将显示为附加。您也可以将列表框放在左侧并使其填充水平方向，或者如果它填充两个方向，则可以将其打包在任何地方。

你也可以使用grid代替pack；只需将它们安排在相邻的列中即可。

所以，不要考虑“附加”小部件，考虑将它们放在容器中。

# macos - 在 Cocoa 中驱动主循环的正确方法

> ID：10935668
> 
> 赞同：7
> 
> 时间：2012-03-25T22:06:21.213
> 
> 标签：macos, cocoa, architecture

我正在编写一个当前在 Windows 和 Mac OS X 上运行的游戏。我的主游戏循环如下所示：

```
while(running)
{
    ProcessOSMessages(); // Using Peek/Translate message in Win32
                         // and nextEventMatchingMask in Cocoa
    GameUpdate();
    GameRender();
} 
```

这显然简化了一点，但这就是它的要点。在我可以完全控制应用程序的 Windows 中，它运行良好。不幸的是，Apple 在 Cocoa 应用程序中拥有自己的做事方式。

当我第一次尝试在 Cocoa 中实现我的主循环时，我不知道把它放在哪里，所以我`NSApplication`根据[这篇文章](http://cocoawithlove.com/2009/01/demystifying-nsapplication-by.html)创建了自己的循环。我把我的`GameFrame()`权利投入到我的`run`工作中，一切正常。

但是，我不觉得它是“正确”的做法。我想在 Apple 的生态系统中很好地发挥作用，而不是试图破解一个可行的解决方案。

苹果的[这篇文章](http://developer.apple.com/library/mac/#qa/qa1385/_index.html)`NSTimer`描述了使用 . 的旧方法和使用`CVDisplayLink`. 我已经连接了`CVDisplayLink`版本，但它只是感觉....奇怪。我不喜欢我的游戏由显示器驱动而不是相反的想法。

我只有两个选择来使用`CVDisplayLink`或覆盖我自己的`NSApplication`吗？这些解决方案中的任何一个都感觉不太对。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-25T23:00:46.577

我很想知道是否有真正做过这件事的人愿意参与进来，但这是我的理解：

Apple 将`CVDisplayLink`解决方案推向在使用的主线程上执行循环，`-nextEventMatchingMask:untilDate:inMode:dequeue:`因为我认为它为 UI 控件提供了更好的响应能力。这可能与全屏游戏无关。`NSApplication`（注意：使用这种形式的游戏循环不需要替换。）我*认为*使用的主要潜在问题`CVDisplayLink`是它只会提前运行一帧并且它会提前确定，这甚至比垂直更强大同步。从好的方面来说，它可能会改善延迟。

其他解决方案包括将渲染与游戏逻辑分离，并在主线程上定期运行游戏逻辑并在线程上渲染`CVDisplayLink`。但是，如果您遇到游戏驱动显示范式的问题，我可能只会推荐这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-26T10:16:59.823

您不必创建自己的基于 NSApplication 的类或使用 CVDisplayLink 来解决应用程序的运行循环在 Cocoa 中对您隐藏的事实。

您可以只创建一个线程并将运行循环放在那里。

不过，对于它的价值，我只使用 CVDisplayLink。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-25T16:14:40.937

我在这里贴一些东西来恢复这个问题......主要是出于便携性。我通过研究 OLC Pixel Game Engine 发现，它与 do{}while 循环和 std::chrono 一起使用来检查帧的时间以计算 fElapsed Time。下面是我写的一些代码来做同样的事情。它还添加了一个化妆部分，以控制高于某个值的拍摄帧率，在本例中为 60 FPS。

c++代码

```
int maxSpeedMicros = 16700;
float fTimingBelt; //used to calculate fElapsedTime for internal calls.
std::chrono::steady_clock::time_point timingBelt[2];
bool engineRunning = false; //always have it true, until the engine stops.
bool isPaused = false;

do {
    timingBelt[1] = std::chrono::steady_clock::now();
    fTimingBelt = std::chrono::duration_cast<std::chrono::microseconds>(timingBelt[1] - timingBelt[0]).count() * 0.000001;
    if (isPaused) {
        do {
            std::this_thread::sleep_for (std::chrono::milliseconds(100));
            timingBelt[1] = std::chrono::steady_clock::now();
        } while (isPaused);
    }
    timingBelt[0] = std::chrono::steady_clock::now();
    // do updating stuff here.

    timingBelt[1] = std::chrono::steady_clock::now();
    int frameMakeup = std::chrono::duration_cast<std::chrono::microseconds>(timingBelt[1] - timingBelt[0]).count();
    if (frameMakeup < maxSpeedMicros) {
        int micros = maxSpeedMicros - frameMakeup;
        std::this_thread::sleep_for (std::chrono::microseconds(micros));
    }
} while (engineRunning); 
```

但是，该代码与 Cocoa 的事​​件驱动模型直接冲突。 [可可中的自定义主应用程序循环](https://stackoverflow.com/questions/38768645/custom-main-application-loop-in-cocoa/38768954?noredirect=1#comment64910793_38768954) 因此，作为一个创可贴，我注释掉了整个循环，并创建了一个运行循环一次迭代的新方法。然后我在我的 AppDelegate 中实现了这个：

目标 C 代码

```
- (void)applicationDidFinishLaunching:(NSNotification *)notification {
    engine->resetTimer();

    [NSTimer scheduledTimerWithTimeInterval:0.016666666667 target:self selector:@selector(engineLoop) userInfo:nil repeats:YES];
}
-(void) engineLoop { //Let's handle this by the engine object.  That's too complicated!
    engine->updateState();
    [glView update]; //Since the engine is doing all of its drawing to a GLView
    [[glView openGLContext] flushBuffer];
} 
```

仍然要做的是调整计时器对象的容差。Apple Developer 文档指出，如果计时器对象错过了下一个窗口，它将等待下一个帧时间。但是，容差允许它改变未来事件的时间，以实现更平滑的帧速率转换和更好地利用 CPU 能力。

所以在这一点上，我愿意接受其他人为制作更便携的代码所做的建议和意见。我计划在名为“eventDriven”的引擎的构造函数中使用一个布尔参数，如果为 false，将启动自己的游戏循环线程，然后拆分顶部事件循环以调用处理所有代码的“engineUpdate”方法可以是事件驱动的。然后，在构建事件驱动系统的情况下，代理可以只使用 engineUpdate = TRUE 构建引擎，并让他们的事件驱动游戏更新。

有人做过吗？如果是这样，它如何执行跨平台？

# model-view-controller - “当前对象”概念在 MVC 中的什么位置？

> ID：10935680
> 
> 赞同：0
> 
> 时间：2012-06-07T16:12:36.683
> 
> 标签：model-view-controller

许多带有 GUI 的应用程序可以被视为处理对象的集合（可能在几个级别上）。例如，联系人列表或一组文档。此外，应用程序中可能存在“当前对象”（当前联系人、当前文档等）的概念，并且某些 GUI 控件会在该当前对象（而不是集合中的其他对象）上发生操作。显然，GUI 应该提供一种在对其应用新操作之前选择不同对象作为“新当前对象”的方法。我认为这是一种非常普遍的情况，因此对于在 MVC 模式中放置这样一个概念（例如，列表上的整数索引）的位置可能有一个非常普遍的解决方案。

我觉得它应该在模型之外（我可以想到一个应用程序有几个视图/控制器对共享一个模型，并且每个视图对哪个对象是选定的或当前的对象有自己的看法），但我无法通过“谷歌搜索”来确认。

我想知道讨论这个主题的作者的指针。此外，欢迎您提出意见（如果本论坛允许此类讨论）。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:12:04.373

> [**免责声明：**我的主要语言是 PHP，并且只对 web 上下文中的 MVC 相关模式有经验（主要是使用它的 Model2 变体，因为 web 本身的明显局限性），这塑造[了我对](https://stackoverflow.com/a/5864000/727208)MVC 结构的理解。]

我将*当前对象的概念视为**模型层*状态的一个方面。当前对象不应直接暴露给 MVC 三元组的其他部分。控制器和视图都只能通过模型​​层的更高/公共部分（我倾向于将该部分称为“服务”，但这是一个坏名字）访问它。

这使您可以自由更改、操作和交换您已标记为“当前”的对象。同时 MVC 的其他部分不直接受到影响。

至于有关主题的材料，我还没有真正看到任何专门讨论这个主题的文章/书籍。我能建议的最好的方法是再次阅读[企业应用程序架构的模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)..。

# google-maps - 服务条款和缓存

> ID：10935684
> 
> 赞同：0
> 
> 时间：2012-06-07T16:12:47.763
> 
> 标签：google-maps

我正在开发一款将在公共交通车辆中用作广告系统的应用程序。这是为车辆带来高速 wifi 的大学研究项目的一部分。我在应用程序上显示了一个谷歌地图，但我知道有时连接会在几个小时内无法正常工作。因此，我想在连接中断时将地图图块缓存在城市的大部分区域。我知道 Google 的 TOS 规定 cachng 是非法的，除非在以下情况下：“为了提高 Maps API 实施的性能而临时、安全地以不允许使用服务之外的内容；” 我觉得我的应用程序属于提高地图实现性能的条款，因为我将在大部分时间下载地图并在绝对需要时进入缓存。而且我也会经常刷新缓存。其他人是否同意我允许我这样做？我实际上还没有做任何事情，所以我想我会先听取其他人的意见。另外，有谁知道“内容数量有限”是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:34:12.710

你确定这就是 TOS 所说的吗？在我看来，好像有两组可能相关的术语。

[http://maps.google.com/help/terms_maps.html](http://maps.google.com/help/terms_maps.html)（我认为对于普通的谷歌地图）没有明确说明缓存。如果这些是与您的使用相关的条款，那么您可能没问题。（我担心的是 2a - 不复制“内容或其任何部分”。为此目的复制算什么？）但我不是律师，你也不是，如果这很重要那么你可能应该问谷歌。

[https://www.google.com/enterprise/earthmaps/legal/us/maps_purchase_agreement.html](https://www.google.com/enterprise/earthmaps/legal/us/maps_purchase_agreement.html)（我认为是“Google Maps for Business”）比您所说的更进一步：“客户可以存储有限数量的内容仅用于*由于网络延迟而*提高客户实施的性能“（强调我的） - 并且在网络根本不存在时缓存事物以使系统工作似乎超出了这一点。但我不是律师，你也不是，如果这很重要，那么你可能应该问谷歌。

如果您的缓存策略导致发出的请求多于其他情况，您也应该了解 Google 对此施加的限制。

无论如何，我不是律师，你也不是，如果这很重要，那么你可能应该去问问谷歌。（“你”实际上可能是指“你大学里的法律人”之类的。）

您可能还想考虑 OpenStreetMap。

# coldfusion - 如何重命名 CFWHEELS 中的主键字段？

> ID：10935686
> 
> 赞同：1
> 
> 时间：2012-06-07T16:12:53.437
> 
> 标签：coldfusion, primary-key, cfwheels

这是我尝试过的......但由于某种原因，“model("user").primaryKey() 仍然返回旧的“User_Id”列......

```
<cfset table("user_table")>
<cfset property(name="id", column="User_Id") />
<cfset setPrimaryKey(property="id") /> 
```

**更新**
问题在于“脚手架”插件。它使用“COLUMNLIST”而不是“PROPERTYLIST”

我已经修复了它，它现在似乎可以正常生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:23:15.200

最初该问题并未说明这是 Scaffold 插件的问题。但是，解决方案是仅指定

```
<cfset property(name="id", column="User_Id") /> 
```

（如 CFWHEELS 文档中所述）

错误本身位于使用“COLUMNLIST”生成 HTML 的 Scaffold 插件中。HTML 然后引用不存在的“#users.user_id#”，因为它现在称为“id”。

我将 Scaffold 插件更改为使用“PROPERTYLIST”，现在可以了。

非常抱歉造成混乱！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-07T16:32:43.257

试着只放

```
<cfset setPrimaryKey("id") /> 
```

内部用户模型。毕竟添加`&reload=true`到您的网址。这将重建应用程序并刷新设置。

# regex - 正则表达式从一个关键字提取连续子字符串到另一个关键字

> ID：10935689
> 
> 赞同：1
> 
> 时间：2012-06-07T16:13:02.517
> 
> 标签：regex

我希望正则表达式可以提取以“ERROR”开头的字符串，但不包括文本“STA”。这个想法是只向用户显示错误消息的文本字符串，而没有内部编程细节（例如代码行号和过程名称等）。

例如，应用程序返回的错误字符串始终采用以下形式：

```
...STA-20010: ERROR my app error message is here STA-06512: at ... 
```

我想从这个字符串中提取以下内容：

```
ERROR my app error message is here 
```

有没有办法使用正则表达式来做到这一点？如果它很重要，我将在 actionscript3 中实现它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:15:40.493

以下应该做你想要的：

```
ERROR.*?(?=STA) 
```

将`.*?`匹配尽可能少的字符，以便[先行](http://www.regular-expressions.info/lookaround.html) `(?=STA)`成功。

根据您的错误消息，可能还需要添加单词边界，例如：

```
ERROR.*?(?=\bSTA\b) 
```

这样，在像下面这样的字符串上，您将包括`STACKOVERFLOW`作为错误消息的一部分而不是停止，因为它以 开头`STA`：

```
...STA-20010: ERROR STACKOVERFLOW STA-06512: at ... 
```

# ajax - AJAX 跨域图像发布到 WCF 服务

> ID：10935690
> 
> 赞同：2
> 
> 时间：2012-06-07T16:13:03.490
> 
> 标签：ajax, wcf, cross-domain

我已经被困了2天。

有人可以提供一个如何将跨域 AJAX 发布到 WCF 服务的示例吗？

我正在尝试将图像上传到 WCF 服务器。

**编辑**

WCF 服务：

```
[WebInvoke(UriTemplate = "/upload", Method = "POST", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Wrapped), CorsEnabled]
void UploadImage(Stream image); 
```

阿贾克斯调用：

```
function UploadImage() {
        image = document.getElementById("myimage").src;
        var data = '{"image": "' + image + '"}'
        //alert(data);
        $.ajax({
            url: "http://localhost:44665/api/upload",
            type: "POST",
            contentType: "application/json",
            data: data,
            success: function (result) {
                alert("success");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.log(jqXHR.responseText);
            }
        });
    } 
```

如果我将 WCF 参数从 Stream 更改为字符串，我可以让它工作。但我需要上传图片而不是字符串。

我现在收到一个 WCF 错误，上面写着：

```
The server encountered an error processing the request. See server logs for more details. 
```

** 编辑 2 ** 我添加了以下答案中提到的 global.asax 代码并将其添加到我的 web.config 中：

```
<configuration>
<system.web>
    <compilation debug="true" targetFramework="4.0" />
</system.web>

<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior name="myServiceBehavior">
                <servicedebug includeexceptiondetailinfaults="true" />
            </behavior>
            <behavior name="">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>

        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true"
                               aspNetCompatibilityEnabled="true"/>
</system.serviceModel>
</configuration> 
```

我现在在 Google Chrome 控制台中收到一条错误消息：

```
POST http://localhost:44665/api/upload 500 (Internal Server Error) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T17:08:28.600

因此，您正在尝试从 JavaScript 对托管在另一个域中的 WCF 服务进行 POST 操作。通常，如果不在 WCF 服务端进行一些特殊设置，您就无法做到这一点。

您必须将以下标头添加到`Global.asax.cs`服务端的响应中（如果服务项目不包含`Global.asax.cs`创建一个）。

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
   //..
   EnableCrossDomainCall();
}

private void EnableCrossDomainCall()
{
    // this header tells that from any domain you can access me.
    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", "*");

    if (HttpContext.Current.Request.HttpMethod == "OPTIONS")
    {
        // this one tells about the supported methods to client.
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods",
                      "GET, POST, OPTIONS");

        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", 
                       "Content-Type, Accept");

        HttpContext.Current.Response.AddHeader("Access-Control-Max-Age", "1728000");

        HttpContext.Current.Response.End();
    }
} 
```

**更新：**

您不能只通过 AJAX 发布任何文件，通过 AJAX 您只能传输数据。您可以使用[这个](http://jquery.malsup.com/form/#file-upload)使用隐藏 iframe 的插件来上传模仿 AJAX 的文件。

您可以在此[链接](https://stackoverflow.com/questions/9451141/uploading-an-image-using-wcf-restful-service-full-working-example)中处理 WCF 端的流对象。尝试先上传小尺寸图片，您可以通过在 web.config 中设置[maxRequestLength来控制最大尺寸。](http://msdn.microsoft.com/en-us/library/e1f13641.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-24T19:44:21.457

我遇到了这个问题并尝试了代码不起作用。

我更改了代码并开始工作。

```
 HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", "*");
                HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST,OPTIONS");

                if ((HttpContext.Current.Request.HttpMethod == "OPTIONS"))
                {

                    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", "Content-Type, Accept");
                    HttpContext.Current.Response.AddHeader("Access-Control-Max-Age", "1728000");
                    HttpContext.Current.Response.End();
                 } 
```

# windows - 在 Windows 批处理文件中检查非零（错误）返回码的万无一失的方法

> ID：10935693
> 
> 赞同：20
> 
> 时间：2012-06-07T16:13:09.803
> 
> 标签：windows, batch-file

# 介绍

有很多关于处理批处理文件中的返回码的建议（使用 ERROLEVEL 机制），例如

*   [从批处理文件中获取错误代码](https://stackoverflow.com/questions/3452046/get-error-code-from-within-a-batch-file)
*   [IF 内的 ERRORLEVEL](https://stackoverflow.com/questions/4367930/errorlevel-inside-if)

一些建议是 do `if errorlevel 1 goto somethingbad`，而另一些建议使用 `%ERRORLEVEL%`变量和 using `==`, `EQU`,`LSS`等。语句等似乎存在问题`IF`，因此鼓励延迟扩展，但它似乎有其自身的怪癖。

# 问题

什么是万无一失的（即健壮的，因此它几乎可以在任何具有几乎任何返回代码的系统上工作）的方式来知道是否返回了错误（**非零**）代码？

# 我的尝试

对于基本用法，以下似乎可以捕获任何非零返回码：

```
if not errorlevel 0 (
    echo error level was nonzero
) 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-07T16:38:48.267

抱歉，您的尝试还没有接近。`if not errorlevel 0`仅当 errorlevel 为负时才为真。

如果你知道 errorlevel 永远不会是负数，那么

```
if errorlevel 1 (echo error level is greater than 0) 
```

如果您必须允许负错误级别，并且不在带括号的代码块内，那么

```
set "errorlevel=1"
set "errorlevel="
if %errorlevel% neq 0 (echo error level is non-zero) 
```

*注意 - 在阅读 Joey 对问题中链接答案的评论后，我编辑了我的答案以明确清除任何用户定义的错误级别值。用户定义的错误级别可以掩盖我们试图访问的动态值。但这仅在您的脚本具有`.bat`扩展名时才有效。如果您设置或清除变量，带有扩展名的脚本`.cmd`会将您的 ERRORLEVEL 设置为 0！更糟糕的是，如果您试图取消定义一个不存在的变量，XP 会将 ERRORLEVEL 设置为 1。这就是为什么我在尝试清除它之前首先明确定义了一个 ERRORLEVEL 变量！*

如果您在带括号的代码块内，则必须使用延迟扩展来获取当前值

```
setlocal enableDelayedExpansion
(
  SomeCommandThatMightGenerateAnError
  set "errorlevel=1"
  set "errorlevel="
  if !errorlevel! neq 0 (echo error level is non-zero)
) 
```

但有时您不希望启用延迟扩展。如果您想在执行命令后立即检查错误级别，则不会丢失所有内容。

```
(
  SomeCommandThatMightGenerateAnError && (echo Success, no error) || (echo There was an error)
) 
```

如果您绝对必须检查动态 ERRORLEVEL 值而不使用括号内的延迟扩展，那么以下工作。但它在两个地方都有错误处理代码。

```
(
  SomeCommandThatMightGenerateAnError
  if errorlevel 1 (echo errorlevel is non-zero) else if not errorlevel 0 (echo errorlevel is non-zero)
) 
```

**终于，这里是非零错误级别的“终极”测试，在任何情况下都应该有效:-)**

```
(
  SomeCommandThatMightGenerateAnError
  set foundErr=1
  if errorlevel 0 if not errorlevel 1 set "foundErr="
  if defined foundErr echo errorlevel is non-zero
) 
```

为了方便使用，它甚至可以转换成宏：

```
set "ifErr=set foundErr=1&(if errorlevel 0 if not errorlevel 1 set foundErr=)&if defined foundErr"
(
  SomeCommandThatMightGenerateAnError
  %ifErr% echo errorlevel is non-zero
) 
```

该宏支持括号和 ELSE 就好了：

```
%ifErr% (
  echo errorlevel is non-zero
) else (
  echo errorlevel is zero
) 
```

**最后一期：**

输入和/或输出的重定向可能由于多种原因而失败。但是除非使用了操作符，否则重定向错误*不会*`||`设置错误级别。有关详细信息，请参阅[Windows 中的文件重定向和 %errorlevel%](https://stackoverflow.com/q/10354016/1012053)。因此有人可以争辩说，不存在一种通过错误级别检查错误的万无一失的方法。最可靠的方法（但仍然不是绝对可靠的）是`||`运算符。

# c# - 从数据库中获取相似项目

> ID：10935694
> 
> 赞同：0
> 
> 时间：2012-06-07T16:13:09.943
> 
> 标签：c#, asp.net-mvc, linq, linq-to-sql

我有包含两个字段的 Sql 表，`Title`并且`Description`我使用 LINQ to SQL 进行所有数据库操作，根据我当前向用户显示的项目，我将如何获得类似的项目，我知道这可以通过`Full Text Search`在 SQL 中使用来完成，但是LINQ to SQL 不支持它。

有人可以向我解释这背后的逻辑，或者向我展示它是如何完成的吗？我应该在单词上拆分标题和描述，然后搜索表格还是？所以类似的问题系统看起来很完美，他们是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:43:32.977

有一个叫做 Contains() 的函数，我想它会解决你的问题，这里有一个关于如何使用它的例子：

```
 db = new YourDataContext();
    List<Table> list = new List<Table>();
    list = (from i in db.Table where (i.Item.Contains(curentItem)))select i).ToList(); 
```

# php - 添加新属性集时Magento超时错误

> ID：10935696
> 
> 赞同：0
> 
> 时间：2012-06-07T16:13:17.700
> 
> 标签：php, magento

我在向 Magento 添加新属性集时遇到问题。

在“添加新属性集”页面上，输入名称并选择将新集基于默认值后，单击“保存属性集”。然后页面加载大约 10-15 秒并显示一个带有此错误的白页：

> 致命错误：第 653 行 D:\\httpdocs\lib\Zend\Cache\Backend\File.php 中的最大执行时间超过 30 秒

如果我返回“管理属性集”页面，新集将包含在列表中！**但是**，当我编辑它时，“组”面板是空白的，所有属性都在“未分配的属性”面板中。这很奇怪，因为默认集具有正确的组，因此它看起来不像复制了该集。

非常感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T00:06:07.823

我建议您增加通常存储在 php.ini 中的 max_execution_time，一旦您这样做，请务必重新启动 Apache。这也可以通过 .htaccess 来完成，如果您查看 Magento 提供的那个，我相信有一条线可以将其增加到 18000 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T20:44:08.917

为防止出现此错误，您必须更改[set_time_limit](http://php.net/manual/en/function.set-time-limit.php)的值。

# python - 从 python 列表中取出标点符号

> ID：10935705
> 
> 赞同：0
> 
> 时间：2012-06-07T16:13:33.020
> 
> 标签：python, text, performance, punctuation

我知道有很多关于删除标点符号的例子，但我想知道最有效的方法。我有一个从 txt 文件中读取并拆分的单词列表

```
wordlist = open('Tyger.txt', 'r').read().split() 
```

检查每个单词并删除任何标点符号的最快方法是什么？我可以用一堆代码来做到这一点，但我知道这不是最简单的方法。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:15:58.870

我认为最简单的方法是首先只提取由字母组成的单词：

```
import re

with open("Tyger.txt") as f:
    words = re.findall("\w+", f.read()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:17:32.170

例如：

```
text = """
Tyger! Tyger! burning bright
In the forests of the night,
What immortal hand or eye
Could frame thy fearful symmetry? 
"""
import re
words = re.findall(r'\w+', text) 
```

或者

```
import string
ps = string.punctuation
words = text.translate(string.maketrans(ps, ' ' * len(ps))).split() 
```

第二个要快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:18:47.543

我会用这样的东西：

```
import re
with open("Tyger.txt") as f:
    print " ".join(re.split("[\-\,\!\?\.]", f.read()) 
```

它只会删除真正需要的内容，并且不会由于过度匹配而造成过度过载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T16:37:33.900

```
>>> import re

>>> the_tyger
'\n    Tyger! Tyger! burning bright \n    In the forests of the night, \n    What immortal hand or eye \n    Could frame thy fearful symmetry? \n    \n    In what distant deeps or skies \n    Burnt the fire of thine eyes? \n    On what wings dare he aspire? \n    What the hand dare sieze the fire? \n    \n    And what shoulder, & what art. \n    Could twist the sinews of thy heart? \n    And when thy heart began to beat, \n    What dread hand? & what dread feet? \n    \n    What the hammer? what the chain? \n    In what furnace was thy brain? \n    What the anvil? what dread grasp \n    Dare its deadly terrors clasp? \n    \n    When the stars threw down their spears, \n    And watered heaven with their tears, \n    Did he smile his work to see? \n    Did he who made the Lamb make thee? \n    \n    Tyger! Tyger! burning bright \n    In the forests of the night, \n    What immortal hand or eye \n    Dare frame thy fearful symmetry? \n    '

>>> print re.sub(r'["-,!?.]','',the_tyger) 
```

印刷：

```
Tyger Tyger burning bright 
In the forests of the night 
What immortal hand or eye 
Could frame thy fearful symmetry 

In what distant deeps or skies 
Burnt the fire of thine eyes 
On what wings dare he aspire 
What the hand dare sieze the fire 

And what shoulder  what art 
Could twist the sinews of thy heart 
And when thy heart began to beat 
What dread hand  what dread feet 

What the hammer what the chain 
In what furnace was thy brain 
What the anvil what dread grasp 
Dare its deadly terrors clasp 

When the stars threw down their spears 
And watered heaven with their tears 
Did he smile his work to see 
Did he who made the Lamb make thee 

Tyger Tyger burning bright 
In the forests of the night 
What immortal hand or eye 
Dare frame thy fearful symmetry 
```

或者，使用文件：

```
>>> with open('tyger.txt', 'r') as WmBlake:
...    print re.sub(r'["-,!?.]','',WmBlake.read()) 
```

如果要创建行列表：

```
>>> lines=[]
>>> with open('tyger.txt', 'r') as WmBlake:
...    lines.append(re.sub(r'["-,!?.]','',WmBlake.read())) 
```

# .htaccess - Opera Mini 使用 .htaccess 检测移动浏览器失败

> ID：10935710
> 
> 赞同：1
> 
> 时间：2012-06-07T16:13:42.440
> 
> 标签：.htaccess, mod-rewrite, browser, opera, user-agent

我很难弄清楚这一点。我正在尝试通过 HTACCESS 用户代理嗅探将移动流量引导到网站的移动版本，如下所示：

```
RewriteCond %{HTTP_USER_AGENT} (android|blackberry|ipad|iphone|ipod|iemobile|mini|mobi|palmos|webos|googlebot\-mobile) [NC]
RewriteCond %{HTTP_HOST} ^mobile\.mywebsite\.com$
RewriteRule ^([aA0-zZ9\-\/]*)/([^/]*)$ /index.php?page=$1&q=$2&q2=$3&setview=mobile [L,QSA] 
```

该字符串`mini|mobi`是应检测 Opera Mini 浏览器的位置。但是，这不会发生。我还将该字符串更改为`opera m`和其他变体。仍然没有运气。

这种重写条件似乎适用于其他移动浏览器，但不适用于 Opera，我不明白为什么。即使是检查指向`mobile.`子域的显式指针的第二个条件也无法传递移动内容。

我不是 HTACCESS 大师，所以我的第一个猜测是我的语法错误。但是为什么这可以在其他移动浏览器上运行而不是 Opera Mini 呢？

感谢您的关注！

* * *

## 更新：2012-06-08

我实际上采用了另一种方法，使用 PHP 来检查标头。由于某种原因，我的 HTACCESS 文件没有检测到某些标头信息。尽管 karlcow 的回答可以验证，但我无法让 iPhone 和第三方 Android 浏览器验证。直到一个页面被传递给 PHP 解释器，我才能够阅读这些信息。我想我只是不明白它是如何工作的。

无论如何，我从 Internet 搜索中借用了代码，并将其放入库函数中：

```
function get_device_view() {    
    $view='desktop';
    if(preg_match('/(up.browser|up.link|mmp|symbian|smartphone|midp|wap|phone|android)/i', strtolower($_SERVER['HTTP_USER_AGENT'])))
        $view='mobile';
    if((strpos(strtolower($_SERVER['HTTP_ACCEPT']),'application/vnd.wap.xhtml+xml')>0) || ((isset($_SERVER['HTTP_X_WAP_PROFILE']) || isset($_SERVER['HTTP_PROFILE']))))
        $view='mobile';
    $mobile_ua=strtolower(substr($_SERVER['HTTP_USER_AGENT'],0,4));
    $mobile_agents=array(
        'w3c ','acs-','alav','alca','amoi','audi','avan','benq','bird','blac',
        'blaz','brew','cell','cldc','cmd-','dang','doco','eric','hipt','inno',
        'ipaq','java','jigs','kddi','keji','leno','lg-c','lg-d','lg-g','lge-',
        'maui','maxo','midp','mits','mmef','mobi','mot-','moto','mwbp','nec-',
        'newt','noki','oper','palm','pana','pant','phil','play','port','prox',
        'qwap','sage','sams','sany','sch-','sec-','send','seri','sgh-','shar',
        'sie-','siem','smal','smar','sony','sph-','symb','t-mo','teli','tim-',
        'tosh','tsm-','upg1','upsi','vk-v','voda','wap-','wapa','wapi','wapp',
        'wapr','webc','winw','winw','xda ','xda-');
    if(in_array($mobile_ua,$mobile_agents))
        $view='mobile';
    if (strpos(strtolower($_SERVER['ALL_HTTP']),'OperaMini')>0)
        $view='mobile';
    if(strpos(strtolower($_SERVER['HTTP_USER_AGENT']),'windows')>0)
        $view='desktop';
    return $view;
} 
```

此函数作为网站打包程序的一部分调用，以便在输出任何内容之前`$view`返回 ，以便加载适当的页面和样式表。

此外，我修改了我的 HTACCESS 文件以包含以下内容：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{HTTP_COOKIE} !((^|;\s*)DD_VIEW=([^;]+))
RewriteCond %{HTTP_HOST} mobile\.buffalosbigdeal\.com
RewriteRule ^([aA0-zZ9\-\/]*)/*([^/]*)$ /index.php?page=$1&q=$2&q2=$3&setview=mobile [L,QSA] 
```

如您所见，我只是为移动设备重定向显式呼叫。子域，以及那些不包含`$view`在打包程序过程中保留集合的 cookie。

* * *

我最初的意图是专门使用 HTACCESS 执行浏览器检测；因为简单并且在 mod_rewrite 强大的前提下。但在我的挫折中，为了赶上最后期限，我妥协了，选择了一种更粗的方法，将来可能需要更多的维护。

**经验教训**：基于浏览器功能（即：分辨率、触摸和 DOM 级别）构建响应式网站，并且不要严重依赖用户代理字符串。我们还有这样的解决方案吗？

感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T23:03:09.863

注意 Opera Mini 字符串的模式是

```
Opera/9.80 (J2ME/MIDP; Opera Mini/$CLIENT_VERSION/$SERVER_VERSION; U; $LANGUAGE) Presto/$PRESTO_VERSION 
```

Mini 带有一个大写的 M。嗯，但你输入了 NC，它代表 nocase，所以不是这样。只是为了确定你能试试

```
RewriteCond %{HTTP_USER_AGENT} (android|blackberry|ipad|iphone|ipod|iemobile|mobi|palmos|webos|googlebot\-mobile) [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Opera\ Mini 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T01:45:16.153

应该是 if (strpos(strtolower($_SERVER['HTTP_USER_AGENT']),'operamini')>0)

或者应该是 if (strpos(strtolower($_SERVER['ALL_HTTP']),'operamini')>0)

使用 ALL_HTTP 时出现调试错误，但使用 HTTP_USER_AGENT 时错误消失

下面是调试错误，如下： Debug Notice: Undefined index: ALL_HTTP in header.php on line 29

# sql-server - 更改集成用户的默认数据库

> ID：10935713
> 
> 赞同：0
> 
> 时间：2012-06-07T16:14:03.187
> 
> 标签：sql-server, sql-server-2008

我们有一个“Windows 集成身份验证”用户，其默认数据库已被删除。现在尝试登录时，我们收到一条错误消息，提示用户登录失败。我从 Microsoft 找到了使用 SQLCMD 的解决方案。但是，我无法为该用户发出 alter login 命令。错误消息指出登录名“mylogin”不存在或您没有权限。不幸的是，我在该服务器上没有 sa 凭据。是否有另一种方法可以更改登录时的默认数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:29:43.903

您确实需要`ALTER USER`从具有足够权限的帐户发出命令，或者`Initial Catalog`在连接时从正在使用的任何客户端应用程序中指定连接字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:31:08.363

> 是否有另一种方法可以更改登录时的默认数据库？

否。您是否尝试过登录特定数据库，而不是默认数据库？

[http://www.connectionstrings.com/](http://www.connectionstrings.com/)

拥有您所需要的连接字符串的所有信息。您可以在连接字符串中设置“初始目录”。这不是“用户的默认设置”，而是用于连接的那个。

可悲的是，如果您无权创建数据库或重新配置用户，那就是它停止的地方......然后需要在每次登录时都这样做。检索 SA 密码。

# wpf - 将参数传递给 Execute 和 CanExecute relaycommand WPF MVVM Light

> ID：10935714
> 
> 赞同：0
> 
> 时间：2012-06-07T16:14:07.757
> 
> 标签：wpf, mvvm-light, relaycommand

我正在尝试使用来自 MVVMLight 的 Relay 命令，并且我正在努力寻找正确的语法来将参数传递给 Execute 方法和 CanExecute 方法。

以下是我失败的尝试

```
NewMessageCommand = new RelayCommand<object>(
    (obj) => NewChatMessage(obj.panelID),
    (obj) => (obj.AccessLevelCode.Equals(Constants.PANEL_ACCESS_LEVEL_FULLACCESS))); 
```

任何帮助或方向将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:16:10.883

如果需要访问其成员，则需要指定参数的实际类型。例如：

```
NewMessageCommand = new RelayCommand<MyClass>(
            (obj) => NewChatMessage(obj.panelID),
            (obj) => (obj.AccessLevelCode.Equals(Constants.PANEL_ACCESS_LEVEL_FULLACCESS))                
            ); 
```

# javascript - KML 未更新

> ID：10935722
> 
> 赞同：0
> 
> 时间：2012-06-07T16:14:35.220
> 
> 标签：javascript, google-maps, google-maps-api-3, kml

我在这个地址建立了一个网站：[http ://rhsxc.tk](http://rhsxc.tk)

在网站上，右侧有一个 KML 文件列表，其中大多数只显示“即将推出”的图像。我更新了第一个 KML（培根），但它仍然显示“即将推出”图像，而不是我制作的路径。在 Google 地球中打开 KML 会正确显示它。

Bacon、Detweiller Course 和 Hamilton 正在遇到此问题，并且是最近更新的。昨天更新的其他设施（Hoerr Nursery、Leo Donovan Golf Course、Richwoods Course、Rock Island Trail-Pioneer 和 Tower）运行正常。

编辑：突然培根开始工作，而不是其他人。

# sql - 在 SQL DEVELOPER 中复制一行 100 次

> ID：10935727
> 
> 赞同：1
> 
> 时间：2012-06-07T16:14:52.843
> 
> 标签：sql, oracle, oracle-sqldeveloper

我想根据计数在表中插入一行 100 次。例如，我有一个表`table_id`，`table_name`并且想要行

```
1，自述
2、自述
3、asd
4、asd
'
'
'
100,asd

```

我正在寻找使用 SQL Developer 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:19:53.487

您可以使用[`connect by level`](http://psoug.org/reference/connectby.html)语法轻松生成结果。

```
 select level, 'asd'
   from dual
connect by level <= 100 
```

或者，正如 FSP 指出的带有循环的匿名 PL/SQL 块，这不是一个好的解决方案，因为如果可能的话，您应该始终使用 SQL 而不是 PL/SQL...

```
begin

   for i in 1 .. 100 loop
      insert into my_table(table_id, table_name)
      values(i, 'asd');
   end loop;

end;
/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:22:13.527

如果您使用的是 oracle，则可以通过一个语句来完成：

```
insert into your_table (table_id, table_name) select level, 'asd' from dual connect by level <= 100; 
```

# c# - 序列化和反序列化结构数组

> ID：10935738
> 
> 赞同：3
> 
> 时间：2012-06-07T16:15:28.697
> 
> 标签：c#, serialization, deserialization

在下面的代码中，我观察到编组器正在读取 3 字节源数组以填充另外 8 字节的数据。随着时间的推移，代码最终会引发内存访问冲突。有没有办法告诉编组器在将指针转换为结构时只编组前 3 个字节？如果我将 Articulations 数组设为“NonSerialized”，那么构造函数在处理 11 个字节的源数组时将引发访问冲突。

```
using System;
using System.Runtime.InteropServices;

namespace MarshallingTest
{
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public struct Articulation
    {
        public const int BaseSize = 8;
        public byte attribute1;
        public byte attribute2;
        public byte attribute3;
        public byte attribute4;
        public byte attribute5;
        public byte attribute6;
        public byte attribute7;
        public byte attribute8;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public class TestEntity
    {
        public const int BaseSize = 3;

        public byte EntityId;         //  1 byte
        public byte Variable;         //  1 byte
        public byte NumArticulations; //  1 byte

        [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.Struct)]
        public Articulation[] Articulations;   // 8 bytes each

        public TestEntity(byte[] rawData)
        {
            unsafe
            {
                fixed (byte* pData = rawData)
                {
                    // I am observing that the marshaler is reading past the 3 bytes
                    // to populate another 8 bytes of data.  With time, the code
                    // will eventually throw a memory access violation.
                    //
                    // Is there a way to tell the marshaller to only marshal the 
                    // first 3 bytes when converting a pointer to a structure?
                    Marshal.PtrToStructure((IntPtr) pData, this);

                    for (int i = 0; i < BaseSize + Articulation.BaseSize; i++)
                    {
                        Console.WriteLine("pData + " + i + " = " + *(pData + i));
                    }
                }
            }
        }

        public byte[] ToRaw()
        {
            byte[] byteArray = new byte[BaseSize + Articulation.BaseSize*Articulations.Length];
            unsafe
            {
                fixed (byte* pData = byteArray)
                {
                    Marshal.StructureToPtr(this, (IntPtr) pData, false);
                }
            }
            return byteArray;
        }
    }

    internal class Program
    {
        private const int TestDataSize = TestEntity.BaseSize;

        private static void Main()
        {
            byte[] testData = new byte[TestDataSize];
            for (int i = 0; i < TestDataSize; i++)
            {
                testData[i] = (byte) (i + 1);
            }
            TestEntity test = new TestEntity(testData);

            // Print resulting array.  You'll see that data outside the source
            // byte array was marshalled into the test structure.
            Console.WriteLine(test.EntityId);
            Console.WriteLine(test.Variable);
            Console.WriteLine(test.NumArticulations);
            Console.WriteLine(test.Articulations[0].attribute1);
            Console.WriteLine(test.Articulations[0].attribute2);
            Console.WriteLine(test.Articulations[0].attribute3);
            Console.WriteLine(test.Articulations[0].attribute4);
            Console.WriteLine(test.Articulations[0].attribute5);
            Console.WriteLine(test.Articulations[0].attribute6);
            Console.WriteLine(test.Articulations[0].attribute7);
            Console.WriteLine(test.Articulations[0].attribute8);

            Console.WriteLine("Test complete.");
        }
    }
} 
```

# jquery - jQuery悬停情况

> ID：10935742
> 
> 赞同：-3
> 
> 时间：2012-06-07T16:15:41.753
> 
> 标签：jquery, jquery-hover

所以我有这段代码，它创建一个 div 来阻止一个复选标记的图像，然后向右滑动，使它看起来像是正在绘制复选标记。一切正常，除了我希望代码像用户悬停一段时间一样执行，即使用户只悬停一秒钟。目前，当用户停止悬停时动画停止。谢谢各位！

```
$('li.activated').hover(function () {
    $('ul.actilist').prepend($('<div>&nbsp;</div>').addClass('slidebox'));
}, function () {
    $('ul.actilist').find('div.slidebox').remove();
});

$('li.activated').hover(function() {
    $('div.slidebox').animate({width: '-=17px', marginLeft: '+=14px'}, {duration: '800',easing: 'swing',queue: true});
}, function() {
    if( $('div.slidebox').width() < 17 ){
        $('div.slidebox').animate({width: '+=17px', marginLeft: '-=14px'}, {duration: '2000',easing: 'swing',queue: true});
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T06:44:40.800

您可以使用该`setTimeout`函数来延迟 mouseleave 事件：

```
setTimeout(function() {
    $('div.slidebox').animate({width: '+=17px', marginLeft: '-=14px'}, {duration: '2000',easing: 'swing',queue: true});
}, 800); 
```

但是，这不会完全满足您的要求，因为如果用户将鼠标移出并匆忙放回，则 div 将进一步缩小，然后在超时到期后恢复到其预期大小。（重复执行此操作会导致 div 短暂缩小为空。）为防止这种情况，您需要防止在“取消鼠标离开”的情况下触发悬停事件。这需要更多代码：

```
var hovered = false;

$('li.activated').hover(function() {
    if(hovered) return;
    hovered = true;
    $('div.slidebox').animate({width: '-=17px', marginLeft: '+=14px'}, {duration: '800',easing: 'swing',queue: true});
}, function() {
    var element = this;
    setTimeout(function() {
        if($(element).is(':hover') || !hovered) return;
        hovered = false;
        $('div.slidebox').animate({width: '+=17px', marginLeft: '-=14px'}, {duration: '2000',easing: 'swing',queue: true});
    }, 800);
});​ 
```

jsFiddle：http: [//jsfiddle.net/uUjhJ/2/](http://jsfiddle.net/uUjhJ/2/)

这主要是可行的，但是通过一些勤奋的鼠标挥动，可以使动画“破裂”并开始像风箱一样抽水（直到它通过动画队列）。这是通过在 mouseleave 动画播放时将鼠标移回开始的，我能够找到修复它的唯一方法是将“队列”选项设置为 false 并将动画值更改为固定值（而不是比使用 += 和 -=) 的相对值：

```
var hovered = false;

$('li.activated').hover(function() {
    if(hovered) return;
    hovered = true;
    $('div.slidebox').animate({width: '83px', marginLeft: '14px'}, {duration: '800',easing: 'swing',queue: false});
}, function() {
    var element = this;
    setTimeout(function() {
        if($(element).is(':hover') || !hovered) return;
        hovered = false;
        $('div.slidebox').animate({width: '100px', marginLeft: '0px'}, {duration: '2000',easing: 'swing',queue: false});
    }, 800);
});​ 
```

jsFiddle：http: [//jsfiddle.net/uUjhJ/3/](http://jsfiddle.net/uUjhJ/3/)

从理论上讲，应该可以通过仔细跟踪状态并在调用中使用回调来使原始方法正常工作`animate`，但它非常挑剔，我无法使其工作。

编辑：啊，错过了您还想在悬停事件中添加/删除 div。这可以完成工作：

```
var hovered = false;

$('li.activated').hover(function() {
    if(hovered) return;
    hovered = true;
    if(!$('div.slidebox').length)
        $('ul.actilist').prepend($('<div>&nbsp;</div>').addClass('slidebox'));
    $('div.slidebox').animate({width: '83px', marginLeft: '14px'}, {duration: '800',easing: 'swing',queue: false});
}, function() {
    var element = this;
    setTimeout(function() {
        if($(element).is(':hover') || !hovered) return;
        hovered = false;
        $('div.slidebox').animate({width: '100px', marginLeft: '0px'}, {duration: '2000',easing: 'swing',queue: false,complete: function() {
            if($(element).is(':hover')) return;
            $('ul.actilist').find('div.slidebox').remove();
        }});
    }, 800);
});​ 
```

请注意，元素在“完成”回调中被删除，以确保它在动画之后而不是之前被删除，并且添加代码和删除代码都仔细检查它们是否与任何内容冲突（双重添加或删除当它重新显示时）。

jsFiddle：http: [//jsfiddle.net/uUjhJ/4/](http://jsfiddle.net/uUjhJ/4/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-07T16:22:18.447

我对该`hover()`函数不太熟悉，但该代码应该将动画排入队列（未经测试）：

```
$('li.activated').mouseenter(function() {
    $('div.slidebox').animate({width: '-=17px', marginLeft: '+=14px'}, {duration: '800',easing: 'swing',queue: true});
}).mouseleave(function() {
    if( $('div.slidebox').width() < 17 ){
        $('div.slidebox').animate({width: '+=17px', marginLeft: '-=14px'}, {duration: '2000',easing: 'swing',queue: true});
    }
}); 
```

# iphone - 我在情节提要中的对象没有与代码正确链接

> ID：10935743
> 
> 赞同：0
> 
> 时间：2012-06-07T16:15:58.870
> 
> 标签：iphone, objective-c, hyperlink, storyboard, iboutlet

我正在尝试在我的应用程序中使用故事板。我开始很好，我添加了两个视图控制器，带有一个从第一个到第二个的按钮。问题出在第二个视图控制器中：我在其上添加并与代码链接的对象不起作用。当我在视图控制器代码中设置断点时，'self.property' 设置为零，而它应该由情节提要实例化。

我一直在寻找几个小时的答案，我真的不明白这个问题，因为其余的似乎都很好。

我试图在代码中编写属性（强/非原子，非原子/保留，甚至弱/非原子），将对象直接链接到代码，以便它自动创建属性，但除了“nil”之外，我什么也没得到"带有断点。

视图控制器.h：

```
@interface NMLoadingViewController : UIViewController
{
    __weak IBOutlet UIProgressView *imageProcessingProgressView;
}
@property (weak, nonatomic) IBOutlet UIProgressView *imageProcessingProgressView;

@end 
```

米：

```
@synthesize imageProcessingProgressView;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    // Custom initialization
    NSLog(@"INIT.");
} 
```

（amont其他不相关的代码行）

如果我将断点设置为“INIT”。行，我的 imageProcessingProgressView 为零。我看不出原因，我想我错过了一个非常小的细节......

（请注意，我已经尝试过使用其他对象，例如 UILabel，但它也不起作用。陌生人，当我有两个对象时，其中一个对象的地址不是 nil，但它仍然被损坏并且没有显示正确的对象。）

编辑：这很麻烦......问题是关于XCode中的变量视图，它将我的变量显示为“nil”，而日志显示了一个正确的对象......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:17:33.357

确保`NMLoadingViewController`是你的 viewController 上的类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:25:37.010

删除这个...

```
{
    __weak IBOutlet UIProgressView *imageProcessingProgressView;
} 
```

...并使财产变得强大。

将您的日志消息更改为...

```
NSLog(@"INIT: %@", self.imageProcessingProgressView); 
```

...看看你是否还有问题。如果你这样做了，那么再看看你的故事板连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:20:18.270

首先尝试@Eric 的答案，因为我相信这是真正的问题。

此外，请确保您实际上是在使用界面构建器将控件挂钩回视图控制器。这是通过将一条线从控件拖回视图控制器的属性来完成的。

# c++ - 是否可以拦截来自另一个进程的控制台调用？

> ID：10935745
> 
> 赞同：1
> 
> 时间：2012-06-07T16:16:04.247
> 
> 标签：c++, windows, console, interception

情况是我的程序是通过`system()`or启动的`CreateProcess()`。

现在，当该程序将数据输出到控制台时，是否可以做一些事情。我的意思是程序输出它。那不是等待结束，收集数据然后处理它，而是在这个外部程序调用控制台的那一刻，它想要打印的数据，然后获取该数据，处理它并在控制台上输出其他东西安慰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:01:57.147

最简单的方法通常是使用`_popen(your_program, "r");`. 这将返回一个`FILE *`您可以读取的内容，并且它读取的内容将是孩子写入其标准输出的任何内容。当您阅读`EOF`该文件时，这意味着子进程已终止。这使得实时读取和处理孩子的输出变得相对容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T05:59:27.680

在创建子进程之前调用 AllocConsole，或者使用 AttachConsole(ChildPID) 函数（在父进程中）。之后，您可以使用任何 ReadConsoleXXX 或 WriteConsoleXXX 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:22:19.860

在 Linux 上，创建一个命名管道：

```
system("mkfifo pipename") 
```

然后在第一个程序中打开管道，并使用以下命令启动程序：

```
system("program > pipename") 
```

我不确定如何在 Windows 上执行此操作。

# ruby-on-rails - Rails 3.1 Heroku 错误

> ID：10935749
> 
> 赞同：0
> 
> 时间：2012-06-07T16:16:20.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我的 Rails 应用程序出现间歇性应用程序错误，我一辈子都看不到是什么原因造成的。该应用程序运行良好，直到大约一个小时前！

这是我的日志.....任何人都可以看到有什么问题吗？

```
2012-06-07T16:09:59+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:09:59 +0000] "GET /assets/nav/pages-45be288bf1c354b73ecc4adeca059617.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/application-84db2ac3553aab7e2791e4b5ca93ebbf.js HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/nav/support-64961f422b35d272aa96f67986f96d0d.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/nav/users-c568f05664b07849a5fc6ce332fd41aa.png HTTP/1.1" 503 1085 "http://gent

2012-06-07T16:10:00+00:00 app[web.1]: cache: [GET /assets/nav/settings-cca0ffa9e065cf27a2a6c2f86c13bd2b.png] fresh
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/nav/settings-cca0ffa9e065cf27a2a6c2f86c13bd2b.png HTTP/1.1" 304 0 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/CD-6a8afb79b7099999b2c433ea6c88556e.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/nav/media-4d836bc533c824782f9e9c0d16b7eb27.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/Chart2-f56078de9116b920d1bdbbbd1bf1e30f.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla

2012-06-07T16:10:00+00:00 app[web.1]: cache: [GET /assets/nav/maps-887a3c6fb5517ad187a552194719ea39.png] fresh
2012-06-07T16:10:00+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:00 +0000] "GET /assets/nav/maps-887a3c6fb5517ad187a552194719ea39.png HTTP/1.1" 304 0 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:01+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:01 +0000] "GET /assets/nav/pages-45be288bf1c354b73ecc4adeca059617.png HTTP/1.1" 503 1085 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:01+00:00 app[web.1]: cache: [GET /assets/Home-70b3adf79c12b22e54419a4e1b4ee31e.png] fresh
2012-06-07T16:10:01+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:01 +0000] "GET /assets/Home-70b3adf79c12b22e54419a4e1b4ee31e.png HTTP/1.1" 304 0 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:01+00:00 app[web.1]: cache: [GET /assets/nav/clipboard-9cc6dcc33d25e94a2e88df388916afec.png] fresh
2012-06-07T16:10:01+00:00 heroku[nginx]: 84.19.42.202 - - [07/Jun/2012:16:10:01 +0000] "GET /assets/nav/clipboard-9cc6dcc33d25e94a2e88df388916afec.png HTTP/1.1" 200 3260 "http://gentle-lightning-5246.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:12.0) Gecko/20100101 Firefox/12.0" gentle-lightning-5246.heroku.com
2012-06-07T16:10:02+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/token-input-facebook-a6fe07057db378b23a567f6ceaab6a7b.css dyno=web.1 queue=0 wait=19ms service=24ms status=200 bytes=2519
2012-06-07T16:10:03+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/Tag-Blue-62e036781e85b8a0c324f08b3d06fbae.png dyno=web.1 queue=0 wait=15ms service=14ms status=200 bytes=356
2012-06-07T16:10:04+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/nav/settings-cca0ffa9e065cf27a2a6c2f86c13bd2b.png dyno=web.1 queue=0 wait=6ms service=26ms status=200 bytes=783
2012-06-07T16:10:04+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/nav/maps-887a3c6fb5517ad187a552194719ea39.png dyno=web.1 queue=0 wait=29ms service=82ms status=200 bytes=3331
2012-06-07T16:10:04+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/Home-70b3adf79c12b22e54419a4e1b4ee31e.png dyno=web.1 queue=0 wait=11ms service=51ms status=200 bytes=773
2012-06-07T16:10:04+00:00 heroku[router]: GET gentle-lightning-5246.heroku.com/assets/nav/clipboard-9cc6dcc33d25e94a2e88df388916afec.png dyno=web.1 queue=0 wait=43ms service=44ms status=200 bytes=3260 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:26:07.270

Heroku 有一段时间没动静。对于某些应用程序，它似乎正在恢复正常。 [http://status-old.heroku.com](http://status-old.heroku.com)

# javascript - IE上的主干路由

> ID：10935753
> 
> 赞同：0
> 
> 时间：2012-06-07T16:16:30.540
> 
> 标签：javascript, backbone.js, browser-history

我正在尝试使用历史主干根目录，但它在 IE（或其他不支持历史 API 的浏览器）上无法正常工作。

我的 webapp 有这张地图，**每个模块**都会发出**请求**，但**动作**应该调用一个**函数**：

*   站点/模块A/
*   站点/模块A/action1/ID
*   站点/模块B/
*   站点/模块B/action1/ID

映射：

```
var MyRouter = Backbone.Router.extend({
    routes: {
        "moduleA/": "homeA",
        "moduleA/action1/:id": "action1", 
        // ...
    }
}

var app = new MyRouter();
Backbone.history.start({pushState: true}); 
```

我正在使用这个导航：

```
app.navigate('moduleA/',{trigger:true}); 
```

或者

```
app.navigate('/moduleA/action1/4334',{trigger:true}); 
```

（我正在获取链接点击事件并调用*navigate(link.href,{trigger:true})*）

Every 在 Chr/FF（支持历史 API 的浏览器）上运行良好，并且 url 在浏览器中更新并且函数被调用。

但是，在 IE 中，url 被这种哈希格式替换：site/#moduleA/ 为了解决这个问题，我尝试在 history.start 中设置根目录

```
Backbone.history.start({pushState: true, root:'/moduleA/'}); 
```

但是，现在 IE 使用以下格式替换 url：*site/moduleA/#moduleA/*或*site/moduleA/#moduleA/action1/432432*。

那么，为什么 IE 在 url 中重复 root 呢？我该如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:14:32.170

通过设置`root`为`'/moduleA/'`您告诉主干`site/moduleA`用作根，这是预期的行为。

记住骨干

```
routes: {
    "moduleA/": "homeA",  // #moduleA/
    "moduleA/action1/:id": "action1" // #moduleA//action1/:id
} 
```

不同于

```
routes: {
    "/moduleA/": "homeA",  // #/moduleA/
    "/moduleA/action1/:id": "action1" // #/moduleA//action1/:id
} 
```

使用时牢记这一点很好`app.navigate`。

# html - 将 HTML 嵌入 HTML 中的嵌入式 SVG？

> ID：10935757
> 
> 赞同：8
> 
> 时间：2012-06-07T16:16:38.480
> 
> 标签：html, xhtml, svg, embedding

允许在 HTML 中嵌入 SVG...

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Hmmm....</title>
    </head>
    <body>
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" width="500px" height="100%">
            <text>Hello cruel world!</text>
        </svg>
    </body>
</html> 
```

...反之亦然：

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" width="500px" height="100%">
    <foreignObject x="0" y="0" width="100%" height="100%">
        <body xmlns="http://www.w3.org/1999/xhtml">
            <h1>Goodbye cruel world...</h1>
        </body>
    </foreignObject>
</svg> 
```

规范[说](http://www.w3.org/TR/SVG/extend.html#EmbeddingForeignObjects)（23.2，第三段）（我引用：）“如果你想将 SVG 嵌入 XHTML 中的 SVG 中的 XHTML 中的 SVG，没关系......”。我想*哇，太深了！*并做到了：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Yeah!</title>
    </head>
    <body>
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" width="500px" height="100%">
            <foreignObject x="0" y="0" width="100%" height="100%">
                <body class="svgbody" xmlns="http://www.w3.org/1999/xhtml">
                    <h1>And hello again!</h1>
                </body>
            </foreignObject>
        </svg>
    </body>
</html> 
```

但是所有浏览器都将 body 标签与 HTML5 body 标签合并（HTML5 body 标签获取 svgbody 类）......这就是[小提琴](http://jsfiddle.net/_bop/hWhGH/1/)（[全屏](http://jsfiddle.net/_bop/hWhGH/1/show)）；内联 svg 中没有正文标记。

我不知道为什么，希望你能帮助我！可以通过将 SVG 放在不同的文件中来解决，但我不想听到它。为什么它不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T18:36:24.227

要记住的一件事是 SVG 文档是在 XML 文档中讨论 SVG 中的 XHTML。您使用的不是 XML，而是 HTML。它是 HTML 解析器的一项功能，可以按照您看到的方式合并正文标记。

如果您使用的是 XML 解析器，则不会发生这种合并。为此，您需要为文档提供`application/xhtml+xml`内容类型。如果你这样做了，那么你需要解决其他问题，比如向元素添加`xmlns="http://www.w3.org/1999/xhtml"`属性。`html`

听从 robertc 的建议要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:36:32.980

您是否特别需要 body 元素？为什么不用非特权元素包装您的内容：

```
<body>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0" y="0" width="100%" height="100%">
        <foreignObject x="0" y="0" width="100%" height="100%">
            <body xmlns="http://www.w3.org/1999/xhtml">
                <div class="svgbody">
                    <h1>This sucks less</h1>
                </div>
            </body>
        </foreignObject>
    </svg>
</body> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T12:41:44.290

如果您希望 html5 解析器忽略 svg 及其中的所有内容 ()，您可以将 svg 放入注释中；让 svg 解析器忽略 html-note 使用 cdata：

```
<html><body><svg>
<![CDATA[  <!--  ]]>
    <ForeingObject />
<![CDATA[   -->  ]]>
</svg></body></html> 
```

[http://www.w3schools.com/xml/xml_cdata.asp](http://www.w3schools.com/xml/xml_cdata.asp)

尝试这样的事情......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T09:49:24.703

在[HTML in SVG in HTML 中](https://stackoverflow.com/questions/7458546/html-in-svg-in-html)，我找到了以下示例代码。这对我来说可以。

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>HTML in SVG in HTML</title>
  <style type='text/css'>
    svg { border: 1px solid black; }
    svg div { border: 1px dotted blue; }
  </style>
</head>
<body>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500">
  <foreignObject class="node" x="46" y="22" width="200" height="300">
    <body xmlns="http://www.w3.org/1999/xhtml">
      <div>The quick brown fox jumps over the lazy dog. Pack my box with
         five dozen liquor jugs</div>
    </body>
  </foreignObject>
</svg>
</body>
</html> 
```

尽管如此，请注意，即使在今天（2014 年 3 月），HTML 文档中对内联 SVG 的支持充其量仍然是“古怪的”。

# php - 需要将来自 php 的 AJAX 响应解码为 2 个 url

> ID：10935760
> 
> 赞同：0
> 
> 时间：2012-06-07T16:16:57.123
> 
> 标签：php, jquery, ajax, image, image-gallery

我收到来自 PHP 的 ajax 响应。我想解码响应，并获取 3 个 URL

代码是 HTML/JS

```
<script type="text/javascript">
 $(document).ready(function() {
$(".goButton").click(function() {
   var dir =  $(this).attr("id");

   var imId = $(".theImage").attr("id");
   $.ajax({
      url: "viewnew.php",
      data: {
         current_image: imId,
         direction    : dir
      },
      success: function(ret) {
          alert(ret);
         $(".theImage").attr("src", ret);

         if ('prev' == dir) {
            imId ++;
         } else {
            imId --;
         }
         $("#theImage").attr("id", imId);
      }
   });

});
});
</script>

<body>
<img id="416" class="theImage" src="" />
  <a href="#null" class="goButton" id="next">Next</a>
</body> 
```

PHP文件是

```
$query = 'SELECT * FROM picture ORDER BY RANDOM() LIMIT 2';
$result = mysql_query($query);
$rec = mysql_fetch_array( $result, MYSQL_ASSOC );

echo $rec['pic_location']; 
```

我还想获取下 3 张图像，以便在单击下一个按钮时显示这 2 张图像将全屏显示。一个将显示为全尺寸，另一个显示为缩略图。我如何解码来自 Ajax 的响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:45:14.903

```
 $(document).ready(function() {
$(".goButton").click(function() {
   var dir =  $(this).attr("id");

   var imId = $(".theImage").attr("id");
   $.ajax({
      url: "viewnew.php",
      data: {
         current_image: imId,
         direction    : dir
      },
      success: function(ret) {
          var arr = eval(ret);
         alert("first: " + arr[0] + ", second: " + arr[1]);

         if ('prev' == dir) {
            imId ++;
         } else {
            imId --;
         }
         $("#theImage").attr("id", imId);
      }
   });

});
}); 
```

未经测试，但我认为它应该工作。（此代码假设 PHP 返回`json_encode()`'ed 数组）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:22:34.593

要将数据从 PHP 传递到 javascript，[`json_encode`](http://php.net/manual/en/function.json-encode.php)请在​​输出中使用该函数，然后使用 js 回调进行处理。

`echo json_encode($rec['pic_location']);`

# javascript - 使用 ASP 将值传递到 Javascript 选项对象的方法

> ID：10935761
> 
> 赞同：0
> 
> 时间：2012-06-07T16:17:14.453
> 
> 标签：javascript, asp.net

选项对象（所谓的）用于从页面收集静态参数以供 javascript 文件操作。将动态值从页面传递到 javascript 选项对象的最佳方法是什么？例如，您应该如何在下面插入 MyAlbumID 的值

```
MyOptionsObject({
    flashvars: {
        xmlFilePath: "http://myurl.com/images.php?album=" + MyAlbumID
    })​ 
```

MyAlbumID 是从哪里获得的：

```
 var albumspan = document.getElementById("lblMyAlbum");
 var albumtextnode = albumspan.firstChild;
 var MyAlbumID = albumtextnode.data; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:55:16.450

究竟是什么问题？

```
onDynamicAction(function(){
    // ensure that the DOM is loaded when that action happens

    var myAlbumID = document.getElementById("lblMyAlbum").firstChild.data;
    // lets hope there is an element with that id and a textnode,
    // so that this threw no error

    MyOptionsObject ({
      flashvars: {
        xmlFilePath: "http://myurl.com/images.php?album=" + myAlbumID
      } // missing bracket, btw.
    });
    // set a new object
}) 
```

# github - github图片路径

> ID：10935763
> 
> 赞同：29
> 
> 时间：2012-06-07T16:17:26.010
> 
> 标签：github

# 图片无法在github中显示

我使用markdown写笔记，当我想添加图片时，我这样做：

`![Alt desc](/home/user_name/repo_name/pic/pic_name "desc")`

这里有一个问题，当我`git push`repo 时，github 无法识别

我电脑中的绝对路径

所以我的**问题**是github和markdown文件中的图片路径是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-07T17:00:54.153

您应该使用 http 可访问图像的绝对路径

*   `![Alt desc](http://www.example.com/image.png)`

如果您愿意链接到您自己的存储库，您应该使用**[`raw`url 格式](https://stackoverflow.com/a/4605068/335418)**。

例如，以下降价

*   `![logo](https://github.com/libgit2/libgit2sharp/raw/master/square-logo.png)`

应显示以下图像

![标识](../Images/b927d0bbb2fed6b61fb4d236fefa823b.png)

**注意：**还支持另一种原始格式。上图也可以通过以下网址访问：[https ://raw.github.com/libgit2/libgit2sharp/master/square-logo.png](https://raw.github.com/libgit2/libgit2sharp/master/square-logo.png)

# 更新

关注你的评论。

[basic_option.md](https://github.com/liangxiao3/redhat_note/blob/master/basic_option.md)中的以下降价将不起作用。

*   `> ![Alt vmware](https://github.com/liangxiao3/redhat_note/blob/master/pic/basic_vmware.jpg "vmware tool")`

将其切换到下面的降价应该可以解决这个问题确实，您没有使用**原始 url 格式**（见上文）

*   `![Alt vmware](https://github.com/liangxiao3/redhat_note/raw/master/pic/basic_vmware.jpg)`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-07T17:04:14.187

您可以只使用相对路径，例如`![](pic/pic_name.png)`.

# iphone - 视频无法在 iPad/iPhone 上的 iframe 中播放

> ID：10935766
> 
> 赞同：0
> 
> 时间：2012-06-07T16:17:32.267
> 
> 标签：iphone, ipad, video, iframe

我正在使用 videolightbox 在我的网站上播放视频。它（在所有平台上）在视频以叠加层弹出的主页上工作。为此，我使用：

```
 <a href="videos/player.swf?url=videos/filename.mp4"> 
```

在 page2 上（参见：[http](http://daretogaincontrol.com/page2?title=Having%20Fun) ://daretogaincontrol.com/page2?title=Having%20Fun ）

我使用这样的 iframe 标签：

```
 <iframe src="videos/player.swf?url=videos/filename.mp4"> 
```

那是行不通的。我不确定它是 iframe，但我已经绕了几个圈子试图弄清楚为什么视频不能在 iPad 和 iPhone 上播放（请参阅[视频不能在 iPad/iPhone 上播放](https://stackoverflow.com/questions/10871740/videos-dont-play-on-ipad-iphone)）。

适用于所有其他平台。感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T02:01:09.697

在我看来，您的代码正在使用“.swf”文件来播放 .mp4 视频。

Apple 产品不支持使用 flash (.swf) 对象。

您可以通过使用以下代码来绕过它；

```
<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" width="340" height="280" codebase="http://www.apple.com/qtactivex/qtplugin.cab">
<param name="SRC" value="video.mp4"> 
<param name="AUTOPLAY" value="false">
<param name="CONTROLLER" value="false">
<embed src="video.mp4" width="340" height="260" autoplay="false" controller="false" pluginspage="http://www.apple.com/quicktime/download/">+
</object> 
```

希望这有助于交配。

# reporting-services - ssrs中两种订阅的主要区别是什么

> ID：10935768
> 
> 赞同：0
> 
> 时间：2012-06-07T16:17:40.367
> 
> 标签：reporting-services

SSRS 中的订阅和数据驱动订阅有什么区别？我已经阅读了这两个，但我没有得到确切的区别。两者都是调度，所以两者都是在预定时间执行还是不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:25:17.680

[数据驱动订阅](http://msdn.microsoft.com/en-us/library/ms159150.aspx)是动态的。这直接来自 MSDN。通过数据驱动订阅，您可以：

*   将报告分发给不断变化的订阅者列表。例如，您可以使用数据驱动的订阅在整个大型组织中分发报告，其中订阅者从一个月到一个月不等，或者使用其他标准来确定现有用户组的组成员身份。

*   使用在运行时检索的报告参数值过滤报告输出。

*   为每个报告交付改变报告输出格式和交付选项。

同时...对于[标准订阅](http://msdn.microsoft.com/en-us/library/ms155911%28v=SQL.90%29.aspx)（同样来自 MSDN）“报告包含在订阅处理期间不能更改的静态值。对于每个标准订阅，只有一组报告呈现选项、交付选项和报告参数。 "

# android - 在布局 XML 中编辑 android:tag

> ID：10935776
> 
> 赞同：1
> 
> 时间：2012-06-07T16:18:05.107
> 
> 标签：android, android-layout

官方文档说：

> 为此视图提供一个包含字符串的标签，稍后使用 View.getTag() 检索或使用 View.findViewWithTag() 进行搜索。

`getTag ()`返回一个`Object`不应该是一个字符串。当然，我可以将自定义对象设置为`setTag (Object)`方法中的标记。但是我可以在布局 XML 中做同样的事情吗（例如为标签分配一个枚举值）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:25:32.707

问题中回答了类似的问题，答案是否定的：

[如何通过android中的布局xml将数组设置为任何视图的标签](https://stackoverflow.com/questions/5100381/how-to-set-an-array-as-tag-to-any-view-through-layout-xml-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:24:36.323

在你得到的布局 xml 文件中`android:id`，也许你可以使用它而不是`getTag()`因为这个属性只能在 javaCode (afaik) 中设置。

# c++ - 使用点图支持 Doxygen STL

> ID：10935777
> 
> 赞同：5
> 
> 时间：2012-06-07T16:18:08.067
> 
> 标签：c++, stl, fortran, doxygen

我正在使用 doxygen（xubuntu 12.04 机器上的 1.8.0 版）记录遗留的 c++/fortran 混合代码。我的 dot_graphs、调用图和调用者图工作正常，除非使用 stl std::vector 类。

我有一些类 foo 需要包含另一个类 bar 的向量。

```
class foo
{
  //What i'd like to do (1)
  std::vector<bar> d_bars
  //What works (2)
  bar* d_bars
};
class bar
{
  SOME_FUNCTION();
} 
```

bar 类包含各种函数，例如“SOME_FUNCTION()”。当 foo 类中的函数调用 SOME_FUNCTION 时：`d_bars[i].SOME_FUNCTION();`调用者图仅在 d_bars 以第二种方式声明时生成。这不适用于当前代码，并且需要在使用 stl 矢量类在第一个方法中声明时工作。

我已经有了`BUILTIN_STL_SUPPORT = YES`。我知道我的代码在上面并不完美。我希望你能赶上漂移。我的代码非常庞大，所以我试图简化它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:20:51.820

您应该`BUILTIN_STL_SUPPORT`打开该选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-14T09:54:54.400

我不知道这是否会有所帮助，但无论如何，谁知道。

我一直遇到与您完全相同的问题：我有两个类，其中一个有另一个类的向量。更糟糕的是，我生成了 shared_pointers 并随后创建了它的向量。

我对此唯一的解决方案是使用 sed .. 是的，真的... 例如：

```
class A
{
public:
    A() {};
    ~A() {};
    DoSomeThingA(){
        AA_ = 0;
    };
private:
    int AA_;
};

class B
{
public:
    B() {};
    ~B(){};
    DoSomeThingB(){
        for (size_t i = 0; i < VecA_.size(); i++)
        {
            VecA_[i]->DoSomeThingA();
        }
    };
private:
    std::vector<std::shared_ptr<A>> VecA_;
}; 
```

我使用 sed ( `sed -e 's/VecA_\[i\]-^>/VecA_\./; s/std::vector^<std::shared_ptr^<A^>^>/A/'`) 更改了它（我使用“^”，因为我在 Windows 上，这是适用于“>”的转义字符），获得：

```
class A
{
public:
    A() {};
    ~A() {};
    DoSomeThingA(){
        AA_ = 0;
    };
private:
    int AA_;
};

class B
{
public:
    B() {};
    ~B(){};
    DoSomeThingB(){
        for (size_t i = 0; i < VecA_.size(); i++)
        {
            VecA_.DoSomeThingA();
        }
    };
private:
    A VecA_;
}; 
```

最后，我将 doxygen 配置为：

输入过滤器 =`sed -e 's/VecA_\[i\]-^>/VecA_\./; s/std::vector^<std::shared_ptr^<A^>^>/A/'`

FILTER_SOURCE_FILES = 是

SOURCE_BROWSER = 是

VERBATIM_HEADERS = 否

乏味？是的，当然......但它对我有用，这是我可以完成这项工作的唯一方法！

希望能帮助到你

# php - 用php中的参数执行python脚本

> ID：10935784
> 
> 赞同：0
> 
> 时间：2012-06-07T16:18:34.843
> 
> 标签：php, python, mysql, cgi

我有一个搜索 mySQL 数据库并返回其所有实例的 php 脚本。我想使用这个实例数据（字符串、字符串、字符串、（字符串、字符串、字符串、字符串）的列表列表）作为 python 脚本的参数。

那么如何将所有这些信息传递给我的 python 脚本呢？我知道我使用 exec 来执行脚本，但是我如何将列表列表作为参数包含在内？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:31:37.973

你不能不完全

您可以使用重定向将文本发送到脚本

```
exec("something.py < inputstuff.txt"); 
```

或者你可以传递一个参数列表

```
exec("something.py arg1 arg2 arg3"); 
```

您可以将其作为字符串表示形式传入并在脚本中对其进行评估，或者如果您使用重定向，则数据应该可以从 sys.stdin 获得如果您将其作为 arg 列表传递，则数据应该可以通过 sys.argv 获得

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:32:25.517

```
<?php
    $list = array('arg1', 'arg2');
    exec(sprintf('python script.py %s', escapeshellarg(implode(' ', $list))); 
```

然后只需使用 argparse：[http](http://docs.python.org/library/argparse.html#module-argparse) ://docs.python.org/library/argparse.html#module-argparse 。

# google-app-engine - 在 blobstore 中复制图像

> ID：10935785
> 
> 赞同：1
> 
> 时间：2012-06-07T16:18:44.510
> 
> 标签：google-app-engine, python-2.7, blobstore

我在 blob 商店中有一张由用户上传的图片（他们的个人资料图片）。我想制作一个相同的副本并重新调整副本的大小，以便它可以显示为缩略图。我想制作相同的副本而不是使用 ImageService，因为与配置文件图像相比，它会更频繁地使用。

我在这里做的是：

```
reader = profile_image.open() #get binary data from blob
data = reader.read()

file_name = files.blobstore.create(mime_type=profile_image.content_type)#file to write to

with files.open(file_name, 'a') as f:
   f.write(data)

files.finalize(file_name)

blob_key = files.blobstore.get_blob_key(file_name)

image = images.Image(blob_key = blob_key)
image.resize(width=32, height=32)

entity.small_profile_pic = <MyImageModel>(caption=<caption given by user>,
                                       picture=str(blob_key)) 
```

这给了我错误：

```
BadValueError: Image instance must have a complete key before it can be stored as a reference. 
```

我认为这是因为 blob 没有保存（put（））到数据存储中，但我该怎么做。没有`files.blobstore.get_blob_key(file_name)`做吗？

我还想问一下：blobstore 是否还缓存使用 get_serving_url() 提供的动态转换的图像图像...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:26:06.010

我会使用 get_serving_url 方法。在[文档](https://developers.google.com/appengine/docs/python/images/overview#Transforming_Images_from_the_Blobstore)中指出：

> get_serving_url() 方法允许您生成一个稳定的专用 URL，用于提供适合 Web 的图像缩略图。您只需将原始图像的单个副本存储在 Blobstore 中，然后请求高性能的每图像 URL。这个特殊的 URL 可以自动提供调整大小和/或裁剪的图像，并且从这个 URL 提供服务不会在您的应用程序上产生任何 CPU 或动态服务负载（尽管仍然照常收取带宽费用）。图像通过高度优化的无 cookie 基础设施以低延迟提供。

此外，您发布的代码似乎并未遵循文档中发布的示例。我会用这样的东西

```
img = images.Image(blob_key=original_image_key)
img.resize(width=32, height=32)
thumbnail = img.execute_transforms(output_encoding=images.JPEG)
file_name = files.blobstore.create(mime_type='image/jpeg')#file to write to
with files.open(file_name, 'a') as f: 
    f.write(thumbnail)
files.finalize(file_name)
blob_key = files.blobstore.get_blob_key(file_name) 
```

# python - 通过 git hook 执行 python 子进程

> ID：10935786
> 
> 赞同：2
> 
> 时间：2012-06-07T16:18:46.053
> 
> 标签：python, git, subprocess, pipe

我在 Git 存储库上运行 Gitolite，我在那里有用 Python 编写的 post-receive 钩子。我需要在 git 存储库目录中执行“git”命令。有几行代码：

```
proc = subprocess.Popen(['git', 'log', '-n1'], cwd='/home/git/repos/testing.git' stdout=subprocess.PIPE, stderr=subprocess.PIPE)
proc.communicate() 
```

在我做出新的提交并推送到存储库后，脚本执行并说

```
fatal: Not a git repository: '.' 
```

如果我跑

```
proc = subprocess.Popen(['pwd'], cwd='/home/git/repos/testing.git' stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

它说，正如预期的那样，正确的 git 存储库路径（/home/git/repos/testing.git）

如果我从 bash 手动运行此脚本，它可以正常工作并显示“git log”的正确输出。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:38:38.090

您可以尝试使用命令行开关设置 git 存储库：

```
proc = subprocess.Popen(['git', '--git-dir', '/home/git/repos/testing.git', 'log', '-n1'], stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

`--git-dir`需要指向一个实际的 git 目录（`.git`在工作树中）。请注意，对于某些命令，您*还*需要设置一个`--work-tree`选项。

设置目录的另一种方法是使用`GIT_DIR`环境变量：

```
import os
env = os.environ.copy()
env['GIT_DIR'] = '/home/git/repos/testing.git'
proc = subprocess.Popen((['git', 'log', '-n1', stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env) 
```

显然已经设置了钩子`GIT_DIR`，但显然这对您的情况不正确（它可能是相对的）；上面的代码将其设置为完整的显式路径。

请参阅[`git`手册页](https://www.kernel.org/pub/software/scm/git/docs/v1.7.10.1/git.html)。

编辑：显然，它仅在指定 cwd 并覆盖`GIT_DIR`var 时适用于 OP：

```
import os
repo = '/home/git/repos/testing.git'
env = os.environ.copy()
env['GIT_DIR'] = repo
proc = subprocess.Popen((['git', 'log', '-n1', stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env, cwd=repo) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:37:26.553

cwd 参数后缺少逗号：

```
proc = subprocess.Popen(['git', 'log', '-n1'], cwd='/home/git/repos/testing.git', stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

# javascript - 使用 javascript 循环遍历所有表单元素在控制台中给出错误

> ID：10935790
> 
> 赞同：0
> 
> 时间：2012-06-07T16:18:56.887
> 
> 标签：javascript, html, forms, for-loop

我只创建了一个包含一些输入字段的表单，所以这应该是`document.forms[0]`. 现在循环遍历表单元素，它给了我一些结果，这很好，但之后循环想要继续而不是在 1 处停止并且仅在页面中形成。显然，它在页面上找不到除单个表单之外的任何其他表单，因此它给出了控制台错误...

有人可以告诉我为什么循环不想停在页面上的唯一表单上吗？

请检查这个 jsFiddle 链接：http: [//jsfiddle.net/sxfmN/](http://jsfiddle.net/sxfmN/)

非常感谢

# php - 仅当存在具有相同自定义字段值的其他帖子时才显示 div

> ID：10935791
> 
> 赞同：0
> 
> 时间：2012-06-07T16:18:59.737
> 
> 标签：php, wordpress, custom-fields

我有一个带有一组自定义字段的 wordpress 主题。其中之一被命名为“作者”。

在 single.php 上，我有一个 div，它显示具有相同自定义字段值的其他帖子。

仅当存在具有相同自定义字段值的其他帖子时，我才想显示此 div，否则我不想显示任何内容。

谢谢你的帮助！！

这是我的实际代码：

```
<?php 

                        $myquery = array(
                        'meta_key' => 'autore',
                        'meta_value' => $autore,
                        'showposts' => 2,
                        'post__not_in' => array($post->ID)
                        );

                        if ( $myquery->have_posts() ) : ?>

                        <div class="related">

                        <h3>Altre di <?php the_field('autore'); ?></h3>

                        <ul>

                        <?php while ( $your_query->have_posts() ) : $your_query->the_post(); ?>

                                <?php        
                                echo '<li>'; ?>

                                <?php
                                $fotorel = get_field('foto_homepage');
                                list($width, $height) = getimagesize("$fotorel");
                                $relheight = $height / 2;
                                ?>

                                <div class="related-foto" style="background:url(<?php the_field('foto_homepage'); ?>) no-repeat center center; height:<?php echo $relheight.'px' ?>"></div>
                                <a href="<?php the_permalink() ?>"><?php the_title(); ?></a>

                               <?php echo '</li>';?>

                               <?php endwhile; ?>

                              <?php else : // What to do if there are no posts from that author

                              endif;?>

                                        </ul>

        </div>

                        <?php wp_reset_query(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:34:30.763

这里有一个例子：

[http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query](http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query)

使用条件`<?php if ($pageposts): ?>`，您可以打印或不打印您的 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:06:24.657

我不确定您如何查询自定义字段中的帖子，但 $wp_query 内置了用于处理不返回帖子的查询的条件。

### 更新的代码示例：

```
$args = array(
         'meta_key' => 'autore',
         'meta_value' => $autore,
         'showposts' => 2,
         'post__not_in' => array($post->ID)
        );
 $your_query = new WP_Query( $args );

if ( $your_query->have_posts() ) : ?>

  <div id="your-div">

while ( $your_query->have_posts() ) : $your_query->the_post();

// Do stuff 

endwhile;

  else : // What to do if there are no posts from that author

endif; 
```

# mysql - MySQL密码功能是否容易受到此影响？

> ID：10935794
> 
> 赞同：3
> 
> 时间：2012-06-07T16:19:05.407
> 
> 标签：mysql, security, hash, passwords

使用 MySQL 的密码功能在数据库中存储密码是否一样糟糕？

[http://money.cnn.com/2012/06/06/technology/linkedin-password-hack/?source=linkedin](http://money.cnn.com/2012/06/06/technology/linkedin-password-hack/?source=linkedin)

> SHA-1 的问题在于它每次都以相同的方式翻译相同的文本。因此，如果您的密码是“password”，而您朋友的密码也是“password”，那么它们将以完全相同的方式进行哈希处理。这使得逆向发现原始密码的过程变得更加容易。

我知道它说的是 SHA-1，但显然任何未加盐的单向哈希都会有同样的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:21:14.033

> 使用 MySQL 的密码功能在数据库中存储密码是否一样糟糕？

是的。

一般来说，您希望使用一种包含盐的方法，最好对每个用户都是唯一的，并且运行缓慢以防止暴力破解。[Bcrypt](http://en.wikipedia.org/wiki/Bcrypt)是目前推荐的存储密码的方法，因为它故意（相对）创建缓慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:09:48.500

MySQL[文档](http://dev.mysql.com/doc/refman/5.0/en/encryption-functions.html#function_password)说您不应该在自己的应用程序中使用 PASSWORD() 函数：

> MySQL Server 中的身份验证系统使用 PASSWORD() 函数；您不应该在自己的应用程序中使用它。

在内部，MySQL 的 PASSWORD() 函数使用 SHA1(2)，即 SHA1 的两倍。但是，它不使用盐。所以，是的，它仍然容易受到[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)攻击。

# c# - 使用 ASP.NET Web 表单在表单控件中处理数值计算

> ID：10935797
> 
> 赞同：0
> 
> 时间：2012-06-07T16:19:10.753
> 
> 标签：c#, asp.net

我一直在练习 asp.net 网络表单和控件，现在有点卡在处理用户输入表单中的数字数据的最佳方法上，例如一个简单的例子是一个名为“长度”的输入字段和一个名为width 用户单击按钮，计算并显示 L * W 的结果。

我已经使用 Convert.ToInt32(strvalue2); 测试了将字符串转换为 int 的方法；并将结果输出到控制台确定。

但是当我尝试转换它们并将它们输出到使用这样的表单控件时：

```
 string strvaluel = length.Text;
        string strvalueW = width.Text;

            int numValuel = Convert.ToInt32(strvaluel);
            int numValueW = Convert.ToInt32(strvalueW);
            outputbox.Text   = numValuel * numValueW;  (error cannot explicitly convert    type 'int' to 'string' 
```

我对 asp.net 很陌生，所以任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:20:35.243

将其转换为字符串：

```
outputbox.Text = (numValuel * numValueW).ToString(); 
```

如果您想更好地控制格式（逗号等），请使用格式字符串：

```
outputbox.Text = string.Format("{0:N}",numValuel * numValueW); 
```

有关更多详细信息，请参阅[有关格式字符串的文档](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

# django - 无法获取在 Django 模板中显示的密钥

> ID：10935801
> 
> 赞同：0
> 
> 时间：2012-06-07T16:19:32.597
> 
> 标签：django, django-templates

我已经尝试了大约一天半的时间来获取模型中相关字段的 ID 以显示在我的模板中。没什么特别的，我只想要ID。

这是有问题的模型：

```
class CompositeLesson(models.Model):
    lesson = models.ForeignKey(Lesson)
    student = models.ForeignKey(Student)
    actualDate = models.DateTimeField() 
```

假设我有一个列表 ,`lessonsList`并且`CompositeLesson`能够成功地遍历该列表。其他字段（即实际日期）正确显示。

模板代码片段：

```
{% for lesson in lessonsList %}
<tr{% if forloop.counter|divisibleby:"2" %} class="shaded_row"{% endif %}>
    <td>{{ lesson.actualDate }}</td>
    <td class="table_button">
    {% if not lesson.isCancelled %}
        <div class="table_button_div" id="cancel_{{ lesson__lesson__id }}"><a href="#">Cancel Lesson</a></div>
    {% else %}
        <div class="cancelled_lesson"></div>
    {% endif %} 
```

问题是我无法获取列表中的课程对象的 ID。我试过了：

```
lesson.lesson
lesson.lesson.id
lesson.lesson__id
lesson__lesson__id
lesson.lesson.get_id 
```

...而且它们都不起作用。

提前致谢！

编辑：这是我根据请求构建课程的观点：

```
def all_student_lessons(request, id):
    # This should list all lessons up to today plus the next four, and call out any cancelled or unpaid lessons
    # User should have the option to mark lessons as paid or cancel them
    s = Student.objects.get(pk = id)
    if s.teacher != request.user:
        return HttpResponseForbidden()

    less = Lesson.objects.filter(student = id)
    lessonsList = []
    for le in less:
        if le.frequency == 0:
            # lesson occurs only once
            x = CompositeLesson()
            x.lessonID = le.id
            x.studentID = id
            x.actualDate = datetime.combine(le.startDate, le.lessonTime)
            x.isCancelled = False
            try:
                c = CancelledLesson.objects.get(lesson = le.id, cancelledLessonDate = le.startDate)
                x.canLesson = c.id
                x.isCancelled = True
            except:
                x.canLesson = None
            try:
                p = PaidLesson.objects.get(lesson = le.id, actualDate = le.startDate)
                x.payLesson = p.id
            except:
                x.payLesson = None
            lessonsList.append(x)
        else:
            sd = next_date(le.startDate, le.frequency, le.startDate)
            while sd <= date.today():
                x = CompositeLesson()
                x.lessonID = le.id
                x.studentID = id
                x.actualDate = datetime.combine(sd, le.lessonTime)
                x.isCancelled = False
                try:
                    c = CancelledLesson.objects.get(lesson = le.id, cancelledLessonDate = le.startDate)
                    x.canLesson = c.id
                    x.isCancelled = True
                except:
                    x.canLesson = None
                try:
                    p = PaidLesson.objects.get(lesson = le.id, actualDate = le.startDate)
                    x.payLesson = p.id
                except:
                    x.payLesson = None
                lessonsList.append(x)
                sd += timedelta(le.frequency)
    lessonsList.sort(key = lambda x: x.actualDate)
    return render_to_response('manage_lessons.html', {'lessonsList': lessonsList,
                                                    's': s}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:47:00.080

在您看来，您永远不会分配`x.lesson`. 这是合乎逻辑的，这`lesson.lesson`是未定义的。

你应该替换`x.lessonID = le.id`为`x.lesson = le`

如果这不起作用，还可以尝试 a `x.save()`before a `lessonsList.append(x)`。

在旁注中，您的模型似乎没有定义得太清楚，因为您正在向它添加模型中未定义的新属性。此外，您可以考虑在显示它们的视图之前创建和存储 CompositeLesson 对象。您可能希望在发生其他一些重要事件时创建或修改这些对象，例如安排、支付或取消的课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:49:17.147

而且，看来我是对的。问题是您在这里处理的不是查询集，而是您设置的自定义数据结构。简单地实例化 a`CompositeLesson`不会将其保存到数据库中。因此，您拥有的是`CompositeLesson`与实际数据库记录无关的实例化模型列表，但它们*依赖*于数据库来确定像您的`lesson`FK 这样的值。

长短，`lesson.lesson`在您的模板上下文中是未定义的，所以当然任何类似的东西`lesson.lesson.id`也是未定义的。老实说，我不确定如何纠正这个问题，因为你的代码是一团糟。我的建议是回到绘图板上，如果您需要帮助找出完成您想要实现的目标的最佳方法，请提出一个新问题。我不相信你所拥有的东西是可行的，即使你让它工作，它也是 Django ORM 的一个混蛋，你最好让任何一个可怜的开发人员在未来继承你的代码库想要谋杀你用生锈的耙子。

# linux - Linux 看门狗

> ID：10935802
> 
> 赞同：1
> 
> 时间：2012-06-07T16:19:36.413
> 
> 标签：linux

Linux 上是否有任何用于以下目的的看门狗工具或库？我想构建一个看门狗可执行文件，它启动 2 个进程并在以下情况下重新启动它们：

*   进程崩溃
*   进程变得无响应（例如由于某种原因挂起）

互联网搜索发现`watchdog.c`，但我不确定这是否可以用于我的目的，它看起来相当低级。

[我可以按照这里](https://stackoverflow.com/questions/9072879/how-to-use-linux-software-watchdog)的建议将我的进程作为初始化程序（守护进程）运行，但我不确定 Linux 是否会识别出进程挂起（例如由于死锁）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:22:15.673

我们在这里使用 monit：http://mmonit.com/monit/[它](http://mmonit.com/monit/)可以让你重新启动它对于如何检查以及如何通过脚本做出反应也是高度可定制的

# asp.net-mvc - 没有一堆隐藏字段的成功模型编辑

> ID：10935803
> 
> 赞同：11
> 
> 时间：2012-06-07T16:19:37.043
> 
> 标签：asp.net-mvc, viewmodel, model-binding, valueinjecter

**简而言之**：如何成功编辑数据库条目，而无需在编辑视图中包含模型的每个字段？

**更新**
所以我在数据库中有一个项目（一篇文章）。我想编辑一篇文章。我编辑的文章有很多属性（Id、CreatedBy、DateCreated、Title、Body）。其中一些属性永远不需要更改（如 Id、CreatedBy、DateCreated）。所以在我的编辑视图中，我只想要可以更改的字段（如标题、正文）的输入字段。当我实现这样的编辑视图时，模型绑定失败。我没有提供输入的任何字段都设置为某个“默认”值（例如 DateCreated 设置为 01/01/0001 12:00:00am）。如果我*这样做*为每个字段提供输入，一切正常，文章按预期编辑。我不知道说“模型绑定失败”是否正确，就像“如果在编辑视图中没有为它们提供输入字段，系统会用不正确的数据填充字段”。

如何以只需要为可以/需要编辑的字段提供输入字段的方式创建编辑视图，以便在调用 Controller 中的 Edit 方法时，正确填充 DateCreated 等字段，而不是设置到一些默认的、不正确的值？这是我目前的编辑方法：

```
 [HttpPost]
    public ActionResult Edit(Article article)
    {
        // Get a list of categories for dropdownlist
        ViewBag.Categories = GetDropDownList();

        if (article.CreatedBy == (string)CurrentSession.SamAccountName || (bool)CurrentSession.IsAdmin)
        {                
            if (ModelState.IsValid)
            {
                article.LastUpdatedBy = MyHelpers.SessionBag.Current.SamAccountName;
                article.LastUpdated = DateTime.Now;
                article.Body = Sanitizer.GetSafeHtmlFragment(article.Body);

                _db.Entry(article).State = EntityState.Modified;
                _db.SaveChanges();
                return RedirectToAction("Index", "Home");
            }
            return View(article);
        }

        // User not allowed to edit
        return RedirectToAction("Index", "Home");   
    } 
```

如果有帮助，请编辑视图：

```
. . .
@using (Html.BeginForm()) {
@Html.ValidationSummary(true)

<fieldset>
    <legend>Article</legend>

    <p>
        <input type="submit" value="Save" /> | @Html.ActionLink("Back to List", "Index")
    </p>

    @Html.Action("Details", "Article", new { id = Model.Id })

    @Html.HiddenFor(model => model.CreatedBy)
    @Html.HiddenFor(model => model.DateCreated)

    <div class="editor-field">
        <span>
            @Html.LabelFor(model => model.Type)
            @Html.DropDownListFor(model => model.Type, (SelectList)ViewBag.Categories)
            @Html.ValidationMessageFor(model => model.Type)
        </span>
        <span>
            @Html.LabelFor(model => model.Active)
            @Html.CheckBoxFor(model => model.Active)
            @Html.ValidationMessageFor(model => model.Active)
        </span>
        <span>
            @Html.LabelFor(model => model.Stickied)
            @Html.CheckBoxFor(model => model.Stickied)
            @Html.ValidationMessageFor(model => model.Stickied)
        </span>            
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Title)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Title)
        @Html.ValidationMessageFor(model => model.Title)
    </div>
    <div class="editor-label">
        @Html.LabelFor(model => model.Body)
    </div>
    <div class="editor-field">
        @* We set the id of the TextArea to 'CKeditor' for the CKeditor script to change the TextArea into a WYSIWYG editor. *@
        @Html.TextAreaFor(model => model.Body, new { id = "CKeditor", @class = "text-editor" })
        @Html.ValidationMessageFor(model => model.Body)
    </div>
</fieldset>
. . . 
```

如果我要省略这两个输入：

```
@Html.HiddenFor(model => model.CreatedBy)
@Html.HiddenFor(model => model.DateCreated) 
```

当调用 Edit 方法时，它们被设置为默认值。CreatedBy 设置为*Null*， Created 设置为*01/01/0001 12:00:00am*

为什么它们没有设置为当前在数据库中设置的值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-11T17:31:40.110

经过更多研究后，我发现了一些有助于 ViewModel 流程的工具——一个是 AutoMapper，另一个是 InjectValues。我选择 InjectValues 主要是因为它不仅可以“展平”对象（映射对象 a -> b），而且还可以“取消展平”它们（映射对象 b -> a）——不幸的是 AutoMapper 缺乏的东西- box - 为了更新数据库中的值，我需要做的事情。

现在，我没有将我的 Article 模型及其所有属性发送到我的视图，而是创建了一个仅包含以下属性的 ArticleViewModel：

```
public class ArticleViewModel
{
    public int Id { get; set; }

    [MaxLength(15)]
    public string Type { get; set; }

    public bool Active { get; set; }
    public bool Stickied { get; set; }

    [Required]
    [MaxLength(200)]
    public string Title { get; set; }

    [Required]
    [AllowHtml]
    public string Body { get; set; }
} 
```

当我创建一篇文章时，我不是发送一个文章对象（带有*每个*属性），而是向视图发送一个“更简单”的模型 - 我的 ArticleViewModel：

```
//
// GET: /Article/Create

public ActionResult Create()
{
    return View(new ArticleViewModel());
} 
```

对于 POST 方法，我们将 ViewModel 发送到 View 并使用其数据在数据库中创建新文章。我们通过将 ViewModel “展开”到 Article 对象上来做到这一点：

```
//
// POST: /Article/Create
public ActionResult Create(ArticleViewModel articleViewModel)
{
    Article article = new Article();              // Create new Article object
    article.InjectFrom(articleViewModel);         // unflatten data from ViewModel into article 

    // Fill in the missing pieces
    article.CreatedBy = CurrentSession.SamAccountName;   // Get current logged-in user
    article.DateCreated = DateTime.Now;

    if (ModelState.IsValid)
    {            
        _db.Articles.Add(article);
        _db.SaveChanges();
        return RedirectToAction("Index", "Home");
    }

    ViewBag.Categories = GetDropDownList();
    return View(articleViewModel);            
} 
```

填写的“缺失部分”是我不想在视图中设置的文章属性，也不需要在编辑视图中更新它们（或者根本不需要）。

Edit 方法几乎相同，除了发送一个新的 ViewModel 到 View 之外，我们发送一个预先填充了我们数据库中的数据的 ViewModel。我们通过从数据库中检索文章并将数据展平到 ViewModel 上来做到这一点。一、GET方法：

```
 //
    // GET: /Article/Edit/5
    public ActionResult Edit(int id)
    {
        var article = _db.Articles.Single(r => r.Id == id);     // Retrieve the Article to edit
        ArticleViewModel viewModel = new ArticleViewModel();    // Create new ArticleViewModel to send to the view
        viewModel.InjectFrom(article);                          // Inject ArticleViewModel with data from DB for the Article to be edited.

        return View(viewModel);
    } 
```

对于 POST 方法，我们希望获取从视图发送的数据并用它更新存储在数据库中的文章。为此，我们只需通过将 ViewModel 'unflatten' 到 Article 对象上来反转展平过程 - 就像我们对 Create 方法的 POST 版本所做的那样：

```
 //
    // POST: /Article/Edit/5
    [HttpPost]
    public ActionResult Edit(ArticleViewModel viewModel)
    {
        var article = _db.Articles.Single(r => r.Id == viewModel.Id);   // Grab the Article from the DB to update

        article.InjectFrom(viewModel);      // Inject updated values from the viewModel into the Article stored in the DB

        // Fill in missing pieces
        article.LastUpdatedBy = MyHelpers.SessionBag.Current.SamAccountName;
        article.LastUpdated = DateTime.Now;

        if (ModelState.IsValid)
        {
            _db.Entry(article).State = EntityState.Modified;
            _db.SaveChanges();
            return RedirectToAction("Index", "Home");
        }

        return View(viewModel);    // Something went wrong
    } 
```

我们还需要更改强类型的 Create & Edit 视图以期望 ArticleViewModel 而不是 Article：

```
@model ProjectName.ViewModels.ArticleViewModel 
```

就是这样！

所以总而言之，您可以实现 ViewModel 以将模型的一部分传递*给*您的视图。然后，您可以只更新这些部分，将 ViewModel 传递回 Controller，并使用 ViewModel 中的更新信息来更新*实际*模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:39:46.687

查看模型示例：

```
public class ArticleViewModel {
    [Required]
    public string Title { get; set; }

    public string Content { get; set; }
} 
```

绑定示例

```
public ActionResult Edit(int id, ArticleViewModel article) {
    var existingArticle = db.Articles.Where(a => a.Id == id).First();
    existingArticle.Title = article.Title;
    existingArticle.Content = article.Content;
    db.SaveChanges();
} 
```

这是一个简单的例子，但是您应该查看 ModelState 以检查模型是否没有错误，检查授权并将此代码移出控制器到服务类，但这是另一课。

**这是更正的编辑方法：**

```
[HttpPost]
public ActionResult Edit(Article article)
{
    // Get a list of categories for dropdownlist
    ViewBag.Categories = GetDropDownList();

    if (article.CreatedBy == (string)CurrentSession.SamAccountName || (bool)CurrentSession.IsAdmin)
    {                
        if (ModelState.IsValid)
        {
            var existingArticle = _db.Articles.First(a => a.Id = article.Id);
            existingArticle.LastUpdatedBy = MyHelpers.SessionBag.Current.SamAccountName;
            existingArticle.LastUpdated = DateTime.Now;
            existingArticle.Body = Sanitizer.GetSafeHtmlFragment(article.Body);
            existingArticle.Stickied = article.Stickied;

            _db.SaveChanges();
            return RedirectToAction("Index", "Home");
        }
        return View(article);
    }

    // User not allowed to edit
    return RedirectToAction("Index", "Home");   
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-02T06:59:17.173

另一个没有视图模型的好方法

```
// POST: /Article/Edit/5
[HttpPost]
public ActionResult Edit(Article article0)
{
    var article = _db.Articles.Single(r => r.Id == viewModel.Id);   // Grab the Article from the DB to update

   article.Stickied = article0.Stickied;

    // Fill in missing pieces
    article.LastUpdatedBy = MyHelpers.SessionBag.Current.SamAccountName;
    article.LastUpdated = DateTime.Now;

    if (ModelState.IsValid)
    {
       _db.Entry(article0).State = EntityState.Unchanged;
        _db.Entry(article).State = EntityState.Modified;
        _db.SaveChanges();
        return RedirectToAction("Index", "Home");
    }

    return View(article0);    // Something went wrong
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:47:43.520

使用**视图模型**。

通过我对寻找解决这个问题的持续研究，我相信使用这些称为“ViewModels”的东西是要走的路。正如 Jimmy Bogard 在一篇[文章](http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/)中所解释的，ViewModel 是一种“显示来自单个实体的信息片段”的方法。

[asp.net-mvc-view-model-patterns](http://geekswithblogs.net/michelotti/archive/2009/10/25/asp.net-mvc-view-model-patterns.aspx)让我走上了正轨；我仍在查看作者发布的一些外部资源，以进一步掌握 ViewModel 概念（Jimmy 的博客文章就是其中之一）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-28T10:19:13.907

In addition to the answer, AutoMapper can also be used to unflatten it. [Using AutoMapper to unflatten a DTO](https://stackoverflow.com/a/5890676/3387187)

# c# - 创建虚拟“碎纸机”打印机

> ID：10935804
> 
> 赞同：3
> 
> 时间：2012-06-07T16:19:41.293
> 
> 标签：c#, vb.net, shred, virtual-printer

我需要创建一个“粉碎”的虚拟打印机

基本上这是我的问题。我有一个软件程序需要在保存文件之前“打印”文件。我希望能够打印到我的碎纸机以保存文档，但我实际上并不希望打印文档。所以我需要打印到一个安全删除文档并在 Windows 中显示为驱动程序的程序。

我将如何在 VB.Net 的 C# 中执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T16:21:44.867

无需为此编写代码，只需打印到`nul`. 这从 DOS 开始就有效。只需创建一台新打印机，打印到本地端口，然后`nul`输入端口名称即可。

[http://www.markmmmanning.com/blog/2009/01/creating-fake-printer-devnull-for.html](http://www.markmmanning.com/blog/2009/01/creating-fake-printer-devnull-for.html)

# c# - 命名空间和表共享相同的名称（哎呀！）

> ID：10935808
> 
> 赞同：4
> 
> 时间：2012-06-07T16:19:54.803
> 
> 标签：c#, namespaces, conflict

首先——我承认我的错误！

但我需要知道我是否应该尝试修复它，或者只是忍受后果。

我创建了一个新的解决方案（C#，VS2010）——我们称之为“F.PIA”，以方便参考。该解决方案所做的其中一件事是使用 SQL Server 表 - 是的，您猜对了 - 也被命名为“PIA”。所以关于我的项目的一切——包括主命名空间——都是 F.PIA。

我正在使用 FAPIA 来访问 PIA 表；这个程序集包括一个表和一个公共部分类 PIA。

在我的解决方案中，我可以区分这两者，但我发现对 FAPIA 的引用很笨拙（实际名称比该示例长得多）。

所以我尝试重构，但没有成功。我很确定重命名会更改 DataSetDesigner 中的某些内容，或者不会更改那里的某些内容（或相关项目）-但我还不够熟练，无法弄清楚究竟是什么出了问题-也不知道如何修复它. （是的，在重构之前我确实有一个工作备份 - 是的。）

我应该保持原样，下次从错误中吸取教训吗？或者有没有办法重命名除了对我的表的引用*之外*的所有内容，并让所有内容都正常运行？

谢谢！-- 斯科特 M

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T19:11:09.297

选项：

1.  [通过using 指令](http://msdn.microsoft.com/en-us/library/sf0df423%28v=vs.80%29.aspx)为 C# 命名空间创建命名空间别名。
2.  创建一个类包装器来处理 PIA 表并提供一种更用户友好的方式来访问该表。
3.  完全限定 C# 命名空间的命名空间项。
4.  重命名表，重构，然后改回名称。
5.  创建一个没有命名冲突的新解决方案。
6.  与特质一起生活......

# php - 我想在编写txt文件时在php中使用stripslash

> ID：10935813
> 
> 赞同：0
> 
> 时间：2012-06-07T16:20:31.257
> 
> 标签：php, forms

我有一个 php 文件，它从表单接收数据，然后将该信息写入 txt 文件。它工作得很好，除了有时用户在填写字段时使用 " 或 '。当这种情况发生时，txt 文件当然有一个 \" 或一个 \' 我想摆脱 \ 所以我想使用 stripslash 功能。以下是 php 代码中的一些示例，我只是不知道在哪里以及如何使用 stripslash：

```
$item=$_POST['item']; 
```

还是应该在这部分使用？

```
$savestring =  $carsearch . "\n" . $homesearch . "\n" . $next . "\n" . $item . "\n"; 
```

或者也许在这里：

```
fwrite($fp, $savestring); 
```

我已经在我的 php 页面上省略了大部分代码以节省空间，但我真的很感谢在哪里使用 stripslash 或者我是否应该完全使用另一种技术的任何帮助。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:23:51.067

除非您有一些自定义代码来添加它，否则数据不应该有`/`引号前缀的字符。

`\`如果您的 PHP 版本不完全是最新的并且您打开了[魔术引号](http://php.net/manual/en/security.magicquotes.php)，则可能会出现这种情况。

如果是这种情况，只需关闭魔术引号即可。他们弊大于利。

如果不能（如果是这种情况，我建议改为添加*该*问题），那么我在上面链接到的文档中的注释包括一些用于修复被魔术引号污染的数据的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:22:58.760

您打开了魔术引号。关掉它，斜线就会消失。

# javascript - SharePoint 2010/JavaScript 多字段验证和警报

> ID：10935818
> 
> 赞同：0
> 
> 时间：2012-06-07T16:20:53.737
> 
> 标签：javascript, sharepoint, sharepoint-2010

我正在使用 SharePoint 2010 并有一个自定义的 newform.aspx 和 editform.aspx，由于表单的字段数量和长度，我正在使用 JQuery 创建多个选项卡。

我遇到的问题之一是如何在用户尝试保存表单但未在某些（或所有必填字段）中输入值时以视觉方式向用户提供建议。我正在使用 SharePoint 中的 OOTB 验证功能来指示需要处理哪些字段，但是由于许多必填字段现在位于不同的选项卡上，我想弹出一个警报窗口，指示在保存之前需要处理哪些必填字段表格。

通常我只会处理两个或三个必填字段，但在这种情况下，我将处理八个必填字段，甚至可能更多。在过去，我会使用 JavaScript if else 语句执行以下操作：

```
 function PreSaveAction() {
    var tbTitle = getTagFromIdentifierAndTitle("input", "TextField", "Title");
    var tbVisitor = getTagFromIdentifierAndTitle("input", "TextField", "Visitor"); {
        if (tbTitle.value == "" && tbVisitor.value == "") {
            alert(tbTitle.title + ' is a required field' + '\n' + tbVisitor.title + ' is a required field');
            return true;
        } else {
            if (tbTitle.value == "") {
                alert(tbTitle.title + ' is a required field');
                return true;
            } else {
                if (tbVisitor.value == "") {
                    alert(tbVisitor.title + ' is a required field');
                    return true;
                } else {
                    return true;
                }
            }
        }
    }
}
function getTagFromIdentifierAndTitle(tagName, identifier, title) {
    var len = identifier.length;
    var tags = document.getElementsByTagName(tagName);
    for (var i = 0; i < tags.length; i++) {
        var tempString = tags[i].id;
        if (tags[i].title == title && (identifier == "" || tempString.indexOf(identifier) == tempString.length - len)) {
            return tags[i];
        }
    }
    return null;
} 
```

由于我有这么多必填字段要处理，我知道多个嵌套的 if else 语句不是最有效的完成方式。将使用开关盒是要走的路吗？可能循环？我将如何去做（我不太精通 JavaScript）？

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T04:29:52.253

您不需要嵌套语句。只需一次浏览一个字段即可构建警报，然后触发它：

```
var alertString="";

if (tbTitle.value == "") {  
    alertString+= tbTitle.title + ' is a required field' + '\n';  
}
if (tbVisitor.value == "") {  
    alertString+= tbVisitor.title + ' is a required field' + '\n';  
}
...
// After going through all fields:
if (alertString) {alert(alertString);} 
```

# sql - 谁能告诉我这个查询是否正确？

> ID：10935820
> 
> 赞同：2
> 
> 时间：2012-06-07T16:20:59.960
> 
> 标签：sql, oracle, sqlplus

我现在正在阅读的某本书中有这个问题..我是 SQl 的初学者..学习它..这不是我的作业。我只是在尝试自己的东西..

Sally 想要查询 EMP 表，并确定公司有工厂所在的每个城市有多少员工。她编写了以下查询，但它不起作用。查询的构造方式有什么问题？

```
SELECT city, COUNT(emp_no) as "Number of Customers"
FROM emp
ORDER BY city
GROUP BY city; 
```

这就是我通过引用其他一些在其中使用了 count 和 group By 的查询所做的事情......我认为我们在这个查询中也需要 WHERE 子句......我该怎么做？

```
SELECT empid,count(*) “Employee Total”, city
From emp
Group by city; 
```

请帮忙..谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:27:23.423

您的`first`查询的问题是`order by`应该在`group by`子句之后，

```
SELECT city, COUNT(emp_no) as "Number of Customers"    FROM emp GROUP BY city Order By city; 
```

您的查询的问题`second`是您正在选择 empid 但它不在`Group by`列表中。

尝试

```
SELECT count(*) Employee Total, city From emp Group by city; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:29:10.673

实际上，Sally 查询的唯一问题是 ORDER BY 子句必须位于末尾：

```
SELECT city, COUNT(emp_no) as "Number of Customers"
FROM emp
GROUP BY city
ORDER BY city; 
```

只需切换 GROUP BY 和 ORDER BY ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:24:30.193

```
SELECT count(*) as "Employee Total", city
From emp
Group by city; 
```

在 city 上使用 GROUP BY 子句会将同一城市的所有记录分组在一起，聚合函数 COUNT(*) 将计算每个城市组中的行数。

您之前遇到的问题是列选择中的 empid 列。如果您使用 GROUP BY，则只能选择聚合列和 GROUP BY 子句中的列。如果您将 empid 添加到 GROUP BY 子句，则查询将执行但不会为您提供您正在寻找的结果，因为它会返回每个 empid 和 1 的计数。

# curl - curl_easy_perform 在一个点之后返回部分结果

> ID：10935825
> 
> 赞同：0
> 
> 时间：2012-06-07T16:21:27.953
> 
> 标签：curl, libcurl

我在我的代码中使用 libcurl，curl_easy_perform() 的前几次尝试返回了正确的值，但之后我看到前 800 个左右的字节被丢弃了。传递的指针 write_data 函数开始指向前 800 个字节左右之后的流。

这是我使用的代码片段 -

```
ctx = curl_easy_init();
curl_easy_setopt(ctx, CURLOPT_POSTFIELDS, bodyData);
curl_easy_setopt(ctx, CURLOPT_URL, serverUrl);
curl_easy_setopt(ctx, CURLOPT_WRITEFUNCTION, write_data);
curl_easy_setopt(ctx, CURLOPT_WRITEDATA, response);
res = curl_easy_perform(ctx);
curl_easy_cleanup(ctx); 
```

编辑：好的，所以我看到对于某些请求，write_data 为一个 curl_easy_perform() 调用了两次。所以 write_data 获取前 x 个字节，然后在下一次读取剩余的字节。但是我的 write_data 函数每次都会覆盖响应指针。我如何知道我是否需要 memcpy 或连接到响应指针？我希望我能够正确地描述情况。

谢谢

磷

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T20:00:56.573

您需要提供一个大缓冲区（您的“响应”指针），并且每次调用 write_data 函数时，您都会将更多数据附加到缓冲区。您的响应指针可能应该指向 struct，如下所示：

```
struct myStruct{
    char *buffer; /* remember to malloc this! */
    int size; /* 100000 */
    int used; /* initially 0 */
};
typedef struct myStruct myStruct; 
```

然后，在 write_data 函数的每个条目上，您希望在写入的最后一个位置之后将提供的数据 memcpy 到缓冲区中（请记住，提供给 write_data 的缓冲区不一定是空终止的），例如：

```
size_t write_data( char *ptr, size_t size, size_t nmemb, void *userdata)
{
    myStruct *parseBuf = (myStruct *)userdata;
    int total_size = size * nmemb;
    memcpy(parseBuf->buffer+parseBuf->used, ptr, total_size);
    parseBuf->used += total_size;
    *(parseBuf->buf+parseBuf->used) = 0; /* Add a null terminator on */
    return size * nmemb;
} 
```

应该这样做。（免责声明：我没有费心尝试编译它，但它应该可以工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:44:32.043

对于单个请求，CURLOPT_WRITEFUNCTION 回调将被调用一次或多次。您的函数需要正确处理。

# visual-studio-2010 - 视觉工作室迪亚德？安全模式也不起作用

> ID：10935830
> 
> 赞同：0
> 
> 时间：2012-06-07T16:21:45.293
> 
> 标签：visual-studio-2010

我正在使用 VS210Pro 进行调试，它因一些 SVCHost 错误而崩溃。之后，当我想打开它时，我得到了这个错误：

![在此处输入图像描述](../Images/3d4f17a269440f99ad7776cea0c545d7.png)

我唯一知道的是安全模式命令“devenv /SafeMode”，尝试过。这也没有帮助。所以我要卸载VS并重新安装它。一天中两个小时左右的时间将会过去:) 所以在开始卸载之前，我想让我们问一个问题，也许还有其他我不知道的恢复 VS 的方法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T03:31:05.430

固定的！该问题是由 McAfee 防病毒软件的一些更新引起的！

# r - 如何像这样转换 R 中的 matrix/data.frame？

> ID：10935831
> 
> 赞同：1
> 
> 时间：2012-06-07T16:21:46.403
> 
> 标签：r, statistics

例如，`col1`,`col2`是列名，`r1`,`r2`是行名，例如：

```
 col1 col2
r1    1    4
r2    2    5 
```

`Base`是否有函数`plyr`将其转换为以下形式（3 列 data.frame）？

```
r1    col1 1
r1    col2 4
r2    col1 2
r2    col2 5 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:24:25.950

刚找到。 `melt`功能可以做到。

# ruby-on-rails - 是否有通过 curl 简化 POST 到 API 的 Gem

> ID：10935835
> 
> 赞同：0
> 
> 时间：2012-06-07T16:21:59.303
> 
> 标签：ruby-on-rails

我见过使用非常简单方便的 POST 方法的 API，例如`https://stripe.com/`或新的。`https://pin.net.au/`它不是通过 JSON 发送对象，而是将其作为 post 属性和值发送，并且返回是 json。

```
curl https://api.pin.net.au/1/charges \
-u your-api-key: \
-d "amount=400" \
-d "description=test charge" \
-d "email=roland@pin.net.au" \
-d "ip_address=203.192.1.172" \
-d "card[number]=5123456789012346" \ 
```

我的问题是在 Rails 上是否有可用的 Gem 来执行此操作？我可以理解这背后发生了什么，但我想确定是否有一个 Gem 可以无缝地执行此操作，而无需进一步更改我当前的默认实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:14:57.497

您是否在问如何创建或使用此类 API？

消费：

```
require 'rest-client'
require 'json'

resp = RestClient.post(
  'https://vtUQeOtUnYr7PGCLQ96Ul4zqpDUO4sOE:@api.stripe.com/v1/charges', 
  { 
    :amount => 400, 
    :currency => 'usd', 
    :description => "charge for site@stripe.com", 
    :card => { 
      :number => '4242424242424242', 
      :exp_month => 12, 
      :exp_year => 2012, 
      :cvc => 123 
    } 
  })

JSON.parse(resp) 
```

要创建这些 API，您可以使用以下内容：

[https://github.com/intridea/grape](https://github.com/intridea/grape)

[https://github.com/filtersquad/rocket_pants](https://github.com/filtersquad/rocket_pants)

# powershell - 如何在 Powershell 中输出多个哈希表

> ID：10935836
> 
> 赞同：2
> 
> 时间：2012-06-07T16:22:12.653
> 
> 标签：powershell

我有一个键/值对哈希表的哈希表（来自 .ini 文件）。它看起来像这样：

```
Name                           Value                                                                   
----                           -----                                                                   
global                         {}                                                                      
Variables                      {event_log, software_repo}                                               
Copy Files                     {files.mssql.source, files.utils.source, files.utils.destination, fil... 
```

如何在一个哈希表中输出所有键/值对，而不是这样做？

```
$ini.global; $ini.variables; $ini."Copy Files" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:58:17.783

鉴于这`$hh`是您可以使用哈希表的哈希表，您可以使用循环：

```
foreach ($key in $hh.keys)
{
  Write-Host $hh[$key]
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:32:03.153

您可以轻松编写一个函数以通过哈希进行递归：

```
$hashOfHash = @{
    "outerhash" = @{
        "inner" = "value1"
        "innerHash" = @{
            "innermost" = "value2"
        }
    }
    "outer" = "value3"
}

function Recurse-Hash($hash){
    $hash.keys | %{
        if($hash[$_] -is [HashTable]){ Recurse-Hash $hash[$_]  }
        else{
            write-host "$_ : $($hash[$_])"
        }
    }
}

Recurse-Hash $hashOfHash 
```

以上只是`write-host`关键值，但你明白了。

# c# - 意外以相反的顺序获取可观察列表的项目

> ID：10935845
> 
> 赞同：0
> 
> 时间：2012-06-07T16:22:41.513
> 
> 标签：c#, data-binding, binding, observablecollection

[为了](http://www.deanchalk.me.uk/post/Thread-Safe-Dispatcher-Safe-Observable-Collection-for-WPF.aspx)_ _从 UI 线程以外的线程修改数据绑定集合。

这个自定义的 observable 集合实现了 IList<> 和 INotifyCollectionChanged 并包含一个 IList<> 类型的集合，它存储了实际（周围）observable 集合的所有元素。

当我将此自定义可观察集合数据绑定到 WPF 列表时，可观察列表的项目将正确显示，但它们的顺序相反！

在运行时查看我的代码会发现，位于自定义可观察集合内的 IList<> 类型的嵌入式集合的项目具有正确的顺序。但是当我查看自定义可观察列表时，它的项目顺序相反。

也许我应该发布一些代码以使这一点更清楚:)

这是自定义的 observable 集合：

```
public class ThreadSaveObservableCollection <T> : IList<T>, INotifyCollectionChanged {

     private IList<T> collection;

     public ThreadSaveObservableCollection () {

         collection = new List<T>();
     }

     ...

     public void Insert (int index, T item) {

        if (Thread.CurrentThread == uiDispatcher.Thread) {

            insert_(index, item);
        } else {

            uiDispatcher.BeginInvoke(new Action<int, T>(insert_), DispatcherPriority.Normal, new object[] {index, item});
        }
    }

    private void insert_ (int index, T item) {

        rwLock.AcquireWriterLock(Timeout.Infinite);

        collection.Insert(index, item);
        CollectionChanged(this, new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, item));

        rwLock.ReleaseWriterLock();
    }

    ...
} 
```

这是我在 ViewModel 中使用集合的地方：

```
...
public ThreadSaveCollection Log {get; set;}

public ViewModel () {

    Log = new ThreadSaveCollection();
}
...

public void Insert() {

     log.Instert(0, "entry1");
} 
```

我动态创建对象日志和 WPF 控件之间的绑定：

```
LogList.ItemSource = ViewModel.Log; 
```

除了这个错误的顺序问题，一切似乎都很好：线程做他们应该做的事情，WPF 列表会及时更新。

再次进入代码时，ViewModel 的 Log 对象向我显示了相反的顺序，而 ThreadSaveObservableCollection 中的集合对象具有正确顺序的项目。

我真的很感激任何帮助！先感谢您 ...

**更新：**语句 log.Instert(0, "entry1"); 是故意的，因为我想要一个随着时间的推移获取项目的列表，并且每个新项目都应该插入到列表的开头。换句话说，最新的项目总是在列表的顶部。尽管如此，在我的代码中，嵌入式集合具有所需的顺序，而周围的集合则没有。

无论如何，为什么项目的顺序应该有所不同？

**更新：**有趣的是，当我使用 Add() 而不是 insert 时，订单不会从外部集合中反转。

换句话说：无论我使用 Add(item) 还是 Insert(0, item)，我总是在 ViewModel 的 ThreadSaveObservableCollection 对象中获得相同的项目顺序，而其中包含的集合具有正确的顺序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:25:10.960

您似乎总是在索引 0 处插入新记录

```
log.Inster(0, "entry1"); 
```

创建一个先进先出的场景。

如果你插入

甲乙丙

你会回来的

CBA

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T13:06:18.590

要在 WPF 组件中获得正确的顺序，可以使用 SortDescription：

```
yourListView.Items.SortDescriptions.Add( new SortDescription( "yourSourcePropertyToOrderBy", ListSortDirection.Ascending ) ); 
```

您可以直接在 WPF 后面的代码中在您的 gui-management oder 中设置 SortDescription。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:25:18.600

当您调用时，`Insert(0, "entry1")`您将新值放在列表的开头，这就是顺序颠倒的原因。您可以改用 Add 方法。

# javascript - 从具有静态后备值的 Web 服务获取 XML

> ID：10935848
> 
> 赞同：0
> 
> 时间：2012-06-07T16:23:01.410
> 
> 标签：javascript, jquery, ajax

我正在尝试使用 jQuery $.ajax 调用从 Web 服务返回 xml。如果对该 Web 服务的调用失败，无论出于何种原因，我都有一些我想使用的静态 xml。我正在尝试使用 timeout 属性来告诉我调用是否失败，并将 xml 解析逻辑放入我的错误函数中。我知道 xml 的解析工作正常，因为我已经在删除 ajax 调用的情况下对其进行了测试。当我添加带有虚拟 url 的 ajax 调用以强制出错时，$xml var 永远不会被设置。有什么想法吗？

```
var navXml = '<?xml version="1.0" encoding="utf-8" ?><book><chapter id="1"></book>'; //static xml here
var serviceUrl = 'http://1234lkjasdf/test'; //bad service url to test failure
var $xml;

$.ajax({
type: 'GET',
dataType: 'xml',
url: serviceUrl,
timeout: 10,
success: function(data, status){
    //set $xml var to xml data returned
    $xml = data;
},
error: function (req, status, error){
    //set $xml var to xml parsed from static value
    xmlDoc = $.parseXML( navXml ), 
        $xml = $( xmlDoc );
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:33:10.993

编辑

看起来 $.ajax 错误处理程序中的任何错误都会默默地失败。您的 XML 中有错误。您的章节标签未关闭。它需要是：

```
<chapter id="1" /> 
```

当我修复 XML 中的错误时，它可以工作。这是一个小提琴：http: [//jsfiddle.net/Pzdv5/1/](http://jsfiddle.net/Pzdv5/1/)

* * *

您的错误处理程序需要如下所示：

```
//set $xml var to xml parsed from static value
var xmlDoc = $.parseXML( navXml ); 
$xml = $( xmlDoc ); 
```

您在前面缺少**var**`xmlDoc`（将创建一个全局变量），更重要的是，您在`xmlDoc`声明后有逗号 (,) 而不是分号 (;)。

# mysql - 何时使用 SELECT ... FOR UPDATE？

> ID：10935850
> 
> 赞同：147
> 
> 时间：2012-06-07T16:23:05.720
> 
> 标签：mysql, sql, sql-server, transactions, select-for-update

请帮助我了解背后的用例`SELECT ... FOR UPDATE`。

**问题 1**`SELECT ... FOR UPDATE` ：以下是什么时候应该使用的一个很好的例子吗？

鉴于：

*   房间[id]
*   标签[id，名称]
*   room_tags[room_id, tag_id]
    *   room_id 和 tag_id 是外键

该应用程序想要列出所有房间及其标签，但需要区分没有标签的房间和已删除的房间。如果不使用 SELECT ... FOR UPDATE，可能发生的情况是：

*   最初：
    *   房间包含`[id = 1]`
    *   标签包含`[id = 1, name = 'cats']`
    *   room_tags 包含`[room_id = 1, tag_id = 1]`
*   线程 1：`SELECT id FROM rooms;`
    *   `returns [id = 1]`
*   线程 2：`DELETE FROM room_tags WHERE room_id = 1;`
*   线程 2：`DELETE FROM rooms WHERE id = 1;`
*   线程 2：[提交事务]
*   线程 1：`SELECT tags.name FROM room_tags, tags WHERE room_tags.room_id = 1 AND tags.id = room_tags.tag_id;`
    *   返回一个空列表

现在线程 1 认为房间 1 没有标签，但实际上房间已被删除。为了解决这个问题，线程 1 应该`SELECT id FROM rooms FOR UPDATE`，从而防止线程 2 删除，`rooms`直到线程 1 完成。那是对的吗？

**问题 2**：什么时候应该使用`SERIALIZABLE`事务隔离而不是`READ_COMMITTED`with `SELECT ... FOR UPDATE`？

答案应该是可移植的（不是特定于数据库的）。如果这不可能，请解释原因。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-05-07T18:00:13.857

实现房间和标签之间的一致性并确保房间在被删除后永远不会返回的唯一便携方法是使用`SELECT FOR UPDATE`.

但是，在某些系统中，锁定是并发控制的副作用，您无需`FOR UPDATE`明确指定即可获得相同的结果。

* * *

> 为了解决这个问题，线程 1 应该`SELECT id FROM rooms FOR UPDATE`，从而防止线程 2 删除，`rooms`直到线程 1 完成。那是对的吗？

这取决于您的数据库系统正在使用的并发控制。

*   `MyISAM`in `MySQL`（和其他几个旧系统）在查询期间确实锁定了整个表。

*   在`SQL Server`中，`SELECT`查询在他们检查过的记录/页面/表上放置共享锁，而`DML`查询放置更新锁（后来升级为独占锁或降级为共享锁）。排他锁与共享锁不兼容，因此`SELECT`or`DELETE`查询将锁定直到另一个会话提交。

*   在使用`MVCC`（如`Oracle`, `PostgreSQL`, `MySQL`with `InnoDB`）的数据库中，`DML`查询会创建记录的副本（以一种或另一种方式），通常读者不会阻止作者，反之亦然。对于这些数据库， a`SELECT FOR UPDATE`会派上用场：它会锁定其中一个`SELECT`或`DELETE`查询，直到另一个会话提交，就像这样`SQL Server`做一样。

> 什么时候应该使用`REPEATABLE_READ`事务隔离而不是`READ_COMMITTED`with `SELECT ... FOR UPDATE`？

通常，`REPEATABLE READ`不禁止幻像行（在另一个事务中出现或消失的行，而不是被修改的行）

*   在`Oracle`和更早的`PostgreSQL`版本中，`REPEATABLE READ`实际上是`SERIALIZABLE`. 基本上，这意味着事务在开始后看不到所做的更改。所以在这个设置中，最后一个`Thread 1`查询将返回房间，就好像它从未被删除一样（这可能是也可能不是你想要的）。如果您不想在房间被删除后显示房间，您应该使用锁定行`SELECT FOR UPDATE`

*   在`InnoDB`,`REPEATABLE READ`和`SERIALIZABLE`中是不同的东西：模式中的读者在`SERIALIZABLE`他们评估的记录上设置下一个键锁，有效地防止`DML`它们的并发。因此，您不需要`SELECT FOR UPDATE`in 可序列化模式，但确实需要它们 in `REPEATABLE READ`or `READ COMMITED`。

请注意，隔离模式的标准确实规定您在查询中看不到某些怪癖，但没有定义如何（使用锁定或使用`MVCC`或其他方式）。

当我说“你不需要`SELECT FOR UPDATE`”时，我真的应该添加“因为某些数据库引擎实现的副作用”。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-05-07T18:00:34.693

简短的答案：

Q1：是的。

Q2：不管你用哪个。

长答案：

A`select ... for update`将（正如它所暗示的那样）选择某些行但也会锁定它们，就好像它们已经被当前事务更新（或者好像已经执行了身份更新）。这允许您在当前事务中再次更新它们然后提交，*而另一个事务无法以任何方式修改这些行。*

另一种看待它的方式，就好像以下两条语句是原子执行的：

```
select * from my_table where my_condition;

update my_table set my_column = my_column where my_condition; 
```

由于受影响的行`my_condition`被锁定，没有其他事务可以以任何方式修改它们，因此，事务隔离级别在这里没有区别。

另请注意，事务隔离级别独立于锁定：设置不同的隔离级别不允许您绕过锁定和更新由您的事务锁定的不同事务中的行。

事务隔离级别（在不同级别）所保证的是事务进行时数据的一致性。

# android - Facebook：在浏览器中重用来自移动应用程序的凭据

> ID：10935853
> 
> 赞同：4
> 
> 时间：2012-06-07T16:23:12.957
> 
> 标签：android, facebook, facebook-graph-api

这个问题的形式多种多样——但它们似乎都不是我想要做的。

我正在为Android开发。我有一个网络应用程序，而不是本机应用程序。在我们的网络应用程序页面上，我们有一个通过 Facebook 登录的按钮。

问题：如果在我的手机上，我通过 Facebook Android 应用程序而不是移动 Facebook 网站登录 Facebook，是否可以在我的浏览器中以某种方式重用这些凭据？我知道可以使用 fb:// url 调用 facebook 应用程序，但似乎无法在浏览器中重用应用程序的凭据。

# python - 如何使用 python 的 sqlalchemy 的 execute() 和 pymysql 在查询中转义 %？

> ID：10935854
> 
> 赞同：26
> 
> 时间：2012-06-07T16:23:21.053
> 
> 标签：python, mysql, sqlalchemy

我的查询是：

```
result = connection.execute(
         "select id_number from Table where string like '_stringStart%' limit 1;") 
```

给出错误：

```
query = query % escaped_args
TypeError: not enough arguments for format string 
```

一个快速的谷歌说使用 %% 而不是 % 但这也不起作用。如何转义 % 或者是否有另一种方法来查询以随机字母开头然后以特定序列开头的字符串？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-12T22:14:00.733

由于这是一个文字字符串，因此最好在此处使用绑定参数（使用 说明[`text()`](http://docs.sqlalchemy.org/en/latest/core/sqlelement.html#sqlalchemy.sql.expression.text)）：

```
from sqlalchemy import text

connection.execute(
    text("select * from table where "
         "string like :string limit 1"), 
    string="_stringStart%") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-23T15:33:50.703

另一种实现绑定参数的方法：

```
from sqlalchemy import text

connection.execute(
    text("select id_number from Table where string like :string limit 1").\
    bindparams(string="_stringStart%")
) 
```

甚至严格输入：

```
from sqlalchemy import bindparam, String, text

connection.execute(
    text("select id_number from Table where string like :string limit 1").\
    bindparams(bindparam("string", type_=String)),
    {"string"="_stringStart%"}
) 
```

请记住，`text()`构造在 SQLAlchemy 1.4 中已被弃用，并将在 SQLAlchemy 2.0 中删除。

# android - android模拟器可以在windows XP SP2上运行吗？

> ID：10935856
> 
> 赞同：0
> 
> 时间：2012-06-07T16:23:25.793
> 
> 标签：android, android-emulator, windows-xp-sp2

android 模拟器是否在 windows XP SP2 上运行？我尝试了所有版本的 android（2.3 到 4.0），但同样的版本在 SP3 上运行良好。是他的操作系统问题还是我在 SP2 机器上的设置有任何问题。控制台说应用程序是安装...但一段时间后给出空消息

# scala - 名为 x 的 Scala 动态字段

> ID：10935858
> 
> 赞同：5
> 
> 时间：2012-06-07T16:23:40.840
> 
> 标签：scala, scala-2.10

只需实现一个动态对象（使用 2.10.0-M3）：

```
import language.dynamics
object D extends Dynamic {
    def selectDynamic( field : String ) = Symbol( field )
} 
```

以下工作正常且符合预期

```
object DynamicTest extends App {
    println( D.a )
} 
```

打印'一个

但是，如果我尝试这个：

```
object DynamicTest extends App {
    println( D.x )
} 
```

我得到令人讨厌的错误：

```
[error] DynProb.scala:7: type mismatch;
[error]  found   : D.type
[error]  required: ?{val x: ?}
[error] Note that implicit conversions are not applicable because they are ambiguous:
[error]  both method any2Ensuring in object Predef of type [A](x: A)Ensuring[A]
[error]  and method any2ArrowAssoc in object Predef of type [A](x: A)ArrowAssoc[A]
[error]  are possible conversion functions from D.type to ?{val x: ?}
[error]     println( D.x )
[error]              ^
[error] one error found 
```

为什么 x 如此特别？我在做傻事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-07T08:17:07.443

我现在想出了一个简单的解决方案：

```
import language.dynamics
object D extends Dynamic {
    def selectDynamic( field : String ) = Symbol( field )
    def x = selectDynamic("x")
}
D.x 
```

返回预期的

```
res2: Symbol = 'x 
```

我很想重新定义一个名为的特征`CompleteDynamic`来覆盖这个“x”变量，但我暂时不能。

# c# - 在 EF CF 中建模有向图

> ID：10935861
> 
> 赞同：2
> 
> 时间：2012-06-07T16:23:49.727
> 
> 标签：c#, .net, entity-framework, graph, ef-code-first

我在使用 EF Code First 对图形结构进行建模时遇到了一些麻烦。我有一种情况，即我的应用程序中的许多具体对象可以是与多种边缘类型中的任何一种相关的节点。

例如，两个用户对象可能有关系（喜欢、不喜欢、相关），但每个对象都可以同样地与另一种类型的对象相关（“查看”页面、“喜欢”消息等）

为了在应用程序中对此进行建模，我使用了 GraphNode 的基类，所有可能的节点都将从该基类继承，并且每个 GraphNode 都有一个 Edge 集合。每个 Edge 都有一个 SourceNode、一个 DestinationNode 和一个 RelationshipType（用于加权）。

我知道如何将其建模为直接的数据库优先开发，Edge 的表将具有代理键、SourceObjectID 和 DestinationObjectID 字段，这将是来自被链接对象的 PK，SourceObjectType 和 DestinationObjectType 字段是类型相关的对象，但该站点需要 EF Code First 实施。

我已经到了使用 TPT 继承的地步，所以我有一个 GraphNode 表，其 PK 是 GraphNodeID，但它随后将其用作具体类型的每个表的 PK，在他们自己的PK的地方，这将导致问题。

有没有人这样做过，或者任何人都可以指出我正确的方向来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:12:52.603

正如您所发现的，继承并不适合这种情况。

其他 ORM，如 NHibernate，为“异构关联”提供了开箱即用的支持。由于 EF 没有，我的解决方案是在“服务”层（即在控制器/视图模型和 DbContext 之间）处理这个问题。

我所做的是创建一个抽象，让我可以存储和检索与任何实体关联的元素（在我的例子中是注释或注释）。我通过手动存储引用对象的实体类型和 id 来做到这一点。

这通常是微不足道的，除非您想将元素与非持久实体相关联（我使用 DbContext 中的一些回调来处理）

# c# - 需要在 C# 中构建文件夹树的字符串表示

> ID：10935867
> 
> 赞同：4
> 
> 时间：2012-06-07T16:24:06.183
> 
> 标签：c#, xml, linq, linq-to-xml

我需要在 C# 中遍历文件夹树并以某种方式记录我找到的内容，然后将其作为字符串传递给我网络上的另一个设备，在那里我将以图形方式显示它。

使用递归遍历文件夹树很简单，传递字符串也是如此。

但是我希望字符串的格式尽可能便携，所以我想到了 XML。我猜我可以以某种方式将 XML 序列化为字符串。

我对 XML 很陌生，所以我不确定如何最好地进行。我在想格式应该像这个例子一样结束：

```
<Tree>
  <Folder Name="Folder1">
    <File Name="File1" />
  </Folder>
</Tree> 
```

有任何想法吗？我是否使用 LinqToXML 从 XElement 对象中构建字符串，就像我见过的示例一样，或者这不是最好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:27:56.233

它在一天结束时进行解析；具有给定分隔符的任何格式都应该足够了。

```
Folder/Folder/Folder/Folder/Blah.txt 
```

上面应该比 XML 的开销要简洁得多，也可以满足您的可移植性需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T09:43:15.257

好的，所以我继续使用 XElement - 结果就像 Chuck Savage 说的那样简单：)

```
private void BuildFolderTree(DirectoryInfo parentFolder, XElement parentElement)
{
    // Find all the subfolders under this folder.
    foreach (DirectoryInfo folderInfo in parentFolder.GetDirectories())
    {
        // Add this folder to the doc.
        XElement folderElement = new XElement("Folder", new XAttribute("Name", folderInfo.Name), new XAttribute("Path", folderInfo.FullName));
                parentElement.Add(folderElement);

        // Recurse into this folder.
        BuildFolderTree(folderInfo, folderElement);
    }

    // Process all the files in this folder
    foreach (FileInfo fileInfo in parentFolder.GetFiles("*.*"))
    {
        // Add this file minus its extension.
        parentElement.Add(new XElement(STR_File, new XAttribute("Name", fileInfo.Name), new XAttribute("Path", fileInfo.FullName)));
    }
}

// main code
DriveInfo di = new DriveInfo("M");
XElement usbKeyTreeElement = new XElement("USBKey");
BuildFolderTree(di.RootDirectory, usbKeyTreeElement);
string usbKeyString = usbKeyTreeElement.ToString(); 
```

usbKeyString 最终看起来像这样：

```
<USBKey>
  <Folder Name="folder1" Path="M:\folder1" />
  <Folder Name="folder2" Path="M:\folder2">
    <File Name="file1" Path="M:\folder2\file1.txt" />
    <File Name="file2" Path="M:\folder2\file2.txt" />
  </Folder>
</USBKey> 
```

# php - PHP :: 是什么意思？

> ID：10935869
> 
> 赞同：0
> 
> 时间：2012-06-07T16:24:09.360
> 
> 标签：php, magento

> **可能重复：**
> [参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)

我在 PHP magento 'Mage::run()' 中遇到过这个符号。

这是什么意思？似乎在任何地方都找不到简单的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:26:18.023

它是[范围解析运算符](http://php.net/manual/en/language.oop5.paamayim-nekudotayim.php)（也称为 Paamayim Nekudotaim）。它允许您访问常量或静态方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:27:53.700

它允许您在类中调用静态函数/方法，而无需创建类的实例：

```
class myClass{

static function myFunction(){
echo"foo";
}
} 
```

现在这样称呼它`::`

```
myClass::myFunction; 
```

使用公共功能，您必须创建一个实例：

```
$mycalssinstance= new myCalss;
//then call it
$mycalssfunction=$mycalssinstance->myFunction(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:26:09.603

它是对静态 php 函数的引用

[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:25:06.957

调用静态（类）方法。您可以在没有类实例的情况下调用它。

[http://us.php.net/manual/en/language.oop5.paamayim-nekudotayim.php](http://us.php.net/manual/en/language.oop5.paamayim-nekudotayim.php)

# javascript - 将 url 重定向到文件夹

> ID：10935872
> 
> 赞同：-1
> 
> 时间：2012-06-07T16:24:19.777
> 
> 标签：javascript

曾几何时，我有一个 Joomla 网站，它仍然在根目录中。最近我自己在一个带有html 5的文件夹中构建了我的网站..

要将我的 url 重定向到我的新文件夹，我找到了这个并成功使用它：一个 index.html 包含 =

```
<html>
<head>
<script language="Javascript">
function goto(){
window.location.href="x.href.php"
}
</script>
</head>
<body onload="goto()">
</body>
</html> 
```

但是现在我看到我的 joomla 页面仍然可以访问，除非 Google 仍然显示旧版本的页面（joomla one），否则这不会是一个问题。

如何将所有页面/链接重定向到新文件夹？这可以再次通过Javascript完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:28:58.490

由于 Joomle 使用 Apache，请使用 .htaccess 文件重定向到您的新网站。这是一个例子：

```
RewriteEngine on
RewriteRule ^([^/\.]+)/?$ index.php?page=$1 [L] 
```

# html - 水平对齐按钮

> ID：10935878
> 
> 赞同：6
> 
> 时间：2012-06-07T16:24:47.383
> 
> 标签：html, css, button

我正在尝试使用 CSS 水平对齐按钮。这是我的标记：

```
<button type="button" class="primary-button download-button">Download</button> 
```

还有我的相关CSS：

```
.primary-button {
    font-family: Arial, sans-serif;
    font-size: 1.3em;
    color: #fff;
    border: 1px solid #004487;
    background-image: -webkit-gradient(linear, top, bottom, from(#5288bd), to(#2f659a));
    background-image: -webkit-linear-gradient(top, #5288bd, #2f659a);
    box-shadow: inset 0px 1px 0px rgba(255, 255, 255, 0.4), inset 0px 0px 0px 1px rgba(255, 255, 255, 0.2), 0px 1px 0px rgba(255, 255, 255, .7);
    text-shadow: 0px -1px 0px black;
    cursor: pointer;
}

.download-button {
    padding: 10px 20px;
    border-radius: 5px;
    display: block;
    margin: 10px auto 0px auto;
} 
```

但是，它仍然与左侧对齐。我认为设置`margin: 10px auto 0px auto;`会水平对齐它，因为它现在是一个块元素，但显然不是。

我也尝试将它包装在一个 div 中并使用`text-align: center`，但这也不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T16:28:56.140

给按钮一个宽度。请参阅此**[jsFiddle 示例。](http://jsfiddle.net/j08691/UJkTG/)**

```
.download-button {
    padding: 10px 20px;
    border-radius: 5px;
    display: block;
    width: 130px;
    margin: 10px auto 0px auto;
}​ 
```

如果没有宽度，您会尝试将块级元素居中，该元素是其容器的整个宽度。通过显式设置宽度（例如按钮上的 130 像素），边距居中规则起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T13:40:51.650

实际上设置`float`为`none`如果两者都`position: relative`应该工作：

```
.container{
  text-align: center;
 }
.button{
  float: none;
} 
```

# r - 手动生成交互项

> ID：10935880
> 
> 赞同：0
> 
> 时间：2012-06-07T16:24:58.310
> 
> 标签：r, panel-data

我正在尝试使用`plm`与[其他人](https://stats.stackexchange.com/questions/24131/using-r-and-plm-to-estimate-fixed-effects-models-that-include-interactions-with)相同的问题来估计具有个人特定时间趋势的固定效果面板。我非常愿意使用链接的 CrossValidated 问题中描述的解决方法，但无法弄清楚如何生成必要的数据框列。

也就是说，我有一个表格的数据框

```
data.frame(date=rep(1:5,times=3),id=rep(1:3,each=5)) 
```

并希望在此数据框中为每个`id`名为的列添加一个列，其值与所有观测`date_idX`值相同，否则为零。`date``id==X`

当然，我的问题的任何更优雅的解决方案也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:09:41.800

```
> dfrm <- data.frame(date=rep(1:5,times=3),id=rep(1:3,each=5))
> 
> X <-3;  dfrm$time_idX <- dfrm$date*(dfrm$id==X)
> dfrm
   date id time_idX
1     1  1        0
2     2  1        0
3     3  1        0
4     4  1        0
5     5  1        0
6     1  2        0
7     2  2        0
8     3  2        0
9     4  2        0
10    5  2        0
11    1  3        1
12    2  3        2
13    3  3        3
14    4  3        4
15    5  3        5 
```

我怀疑您真正想要的是在回归公式中执行此操作。为此，`I()`需要该功能。这是伪代码：

```
 regfun( form = yield ~ I(date*(id==X) ), data=dfrm) 
```

我不保证这将是使用 plm 问题的正确解决方案，但它是一种适用于普通回归的方法。您应该编辑您的问题以包含适当的测试用例。

# opencv - 使用相机内在/外在重新扭曲点

> ID：10935882
> 
> 赞同：13
> 
> 时间：2012-06-07T16:25:03.423
> 
> 标签：opencv, camera-calibration, points, distortion

给定一组二维点，我如何应用相反的`undistortPoints`？

我有相机的内在函数，`distCoeffs`并且想（例如）创建一个正方形，并像相机通过镜头看到它一样扭曲它。

我在这里找到了一个“扭曲”补丁：http: [//code.opencv.org/issues/1387](http://code.opencv.org/issues/1387)，但这似乎只对图像有用，我想处理稀疏点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-26T12:04:52.103

这个问题相当老了，但由于我最终从谷歌搜索到这里而没有看到一个简洁的答案，所以我还是决定回答它。

有一个名为的函数[`projectPoints`](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=cvprojectpoints2#projectpoints "项目积分")正是这样做的。C 版本由 OpenCV 在内部使用，用于估计具有以下功能的相机参数[`calibrateCamera`](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=cvprojectpoints2#calibratecamera)和[`stereoCalibrate`](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=cvprojectpoints2#stereocalibrate "立体校准")

编辑：
要使用 2D 点作为输入，我们可以将所有 z 坐标设置为 1，[`convertPointsToHomogeneous`](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=cvprojectpoints2#convertpointstohomogeneous)并使用`projectPoints`不旋转和不平移。

```
cv::Mat points2d = ...;
cv::Mat points3d;
cv::Mat distorted_points2d;
convertPointsToHomogeneous(points2d, points3d);
projectPoints(points3d, cv::Vec3f(0,0,0), cv::Vec3f(0,0,0), camera_matrix, dist_coeffs, distorted_points2d); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-26T12:27:36.543

一个简单的解决方案是使用`initUndistortRectifyMap`从未扭曲坐标到扭曲坐标获取地图：

```
cv::Mat K = ...; // 3x3 intrinsic parameters
cv::Mat D = ...; // 4x1 or similar distortion parameters
int W = 640; // image width
int H = 480; // image height

cv::Mat mapx, mapy;
cv::initUndistortRectifyMap(K, D, cv::Mat(), K, cv::Size(W, H), 
  CV_32F, mapx, mapy);

float distorted_x = mapx.at<float>(y, x);
float distorted_y = mapy.at<float>(y, x); 
```

* * *

我编辑以澄清代码是正确的：

我引用的文档[`initUndistortRectifyMap`](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#cv.InitUndistortRectifyMap)：

> 对于目标（校正和校正）图像中的每个像素 (u, v)，该函数计算源图像（即来自相机的原始图像）中的相应坐标。
> 
> map_x(u,v) = x''f_x + c_x
> 
> map_y(u,v) = y''f_y + c_y

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-26T14:47:46.583

`undistortPoint`是项目点的简单反向版本

就我而言，我想做以下事情：

### 不失真点：

```
int undisortPoints(const vector<cv::Point2f> &uv, vector<cv::Point2f> &xy, const cv::Mat &M, const cv::Mat &d)
{
    cv::undistortPoints(uv, xy, M, d, cv::Mat(), M);
    return 0;
} 
```

这将使点不失真到与图像原点非常相似的坐标，但不会失真。这是 cv::undistort() 函数的默认行为。

### 重新扭曲点：

```
int distortPoints(const vector<cv::Point2f> &xy, vector<cv::Point2f> &uv, const cv::Mat &M, const cv::Mat &d)
{
    vector<cv::Point2f> xy2;
    vector<cv::Point3f>  xyz;
    cv::undistortPoints(xy, xy2, M, cv::Mat());
    for (cv::Point2f p : xy2)xyz.push_back(cv::Point3f(p.x, p.y, 1));
    cv::Mat rvec = cv::Mat::zeros(3, 1, CV_64FC1);
    cv::Mat tvec = cv::Mat::zeros(3, 1, CV_64FC1);
    cv::projectPoints(xyz, rvec, tvec, M, d, uv);
    return 0;
} 
```

这里的小技巧是首先使用线性相机模型将点投影到 z=1 平面。之后，您必须使用原始相机模型投影它们。

我发现这些很有用，我希望它也对你有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T15:19:23.397

我有完全相同的需求。这是一个可能的解决方案：

```
void MyDistortPoints(const std::vector<cv::Point2d> & src, std::vector<cv::Point2d> & dst, 
                     const cv::Mat & cameraMatrix, const cv::Mat & distorsionMatrix)
{
  dst.clear();
  double fx = cameraMatrix.at<double>(0,0);
  double fy = cameraMatrix.at<double>(1,1);
  double ux = cameraMatrix.at<double>(0,2);
  double uy = cameraMatrix.at<double>(1,2);

  double k1 = distorsionMatrix.at<double>(0, 0);
  double k2 = distorsionMatrix.at<double>(0, 1);
  double p1 = distorsionMatrix.at<double>(0, 2);
  double p2 = distorsionMatrix.at<double>(0, 3);
  double k3 = distorsionMatrix.at<double>(0, 4);
  //BOOST_FOREACH(const cv::Point2d &p, src)
  for (unsigned int i = 0; i < src.size(); i++)
  {
    const cv::Point2d &p = src[i];
    double x = p.x;
    double y = p.y;
    double xCorrected, yCorrected;
    //Step 1 : correct distorsion
    {     
      double r2 = x*x + y*y;
      //radial distorsion
      xCorrected = x * (1\. + k1 * r2 + k2 * r2 * r2 + k3 * r2 * r2 * r2);
      yCorrected = y * (1\. + k1 * r2 + k2 * r2 * r2 + k3 * r2 * r2 * r2);

      //tangential distorsion
      //The "Learning OpenCV" book is wrong here !!!
      //False equations from the "Learning OpenCv" book
      //xCorrected = xCorrected + (2\. * p1 * y + p2 * (r2 + 2\. * x * x)); 
      //yCorrected = yCorrected + (p1 * (r2 + 2\. * y * y) + 2\. * p2 * x);
      //Correct formulae found at : http://www.vision.caltech.edu/bouguetj/calib_doc/htmls/parameters.html
      xCorrected = xCorrected + (2\. * p1 * x * y + p2 * (r2 + 2\. * x * x));
      yCorrected = yCorrected + (p1 * (r2 + 2\. * y * y) + 2\. * p2 * x * y);
    }
    //Step 2 : ideal coordinates => actual coordinates
    {
      xCorrected = xCorrected * fx + ux;
      yCorrected = yCorrected * fy + uy;
    }
    dst.push_back(cv::Point2d(xCorrected, yCorrected));
  }

}

void MyDistortPoints(const std::vector<cv::Point2d> & src, std::vector<cv::Point2d> & dst, 
                     const cv::Matx33d & cameraMatrix, const cv::Matx<double, 1, 5> & distorsionMatrix)
{
  cv::Mat cameraMatrix2(cameraMatrix);
  cv::Mat distorsionMatrix2(distorsionMatrix);
  return MyDistortPoints(src, dst, cameraMatrix2, distorsionMatrix2);
}

void TestDistort()
{
  cv::Matx33d cameraMatrix = 0.;
  {
    //cameraMatrix Init
    double fx = 1000., fy = 950.;
    double ux = 324., uy = 249.;
    cameraMatrix(0, 0) = fx;
    cameraMatrix(1, 1) = fy;
    cameraMatrix(0, 2) = ux;
    cameraMatrix(1, 2) = uy;
    cameraMatrix(2, 2) = 1.;
  }

  cv::Matx<double, 1, 5> distorsionMatrix;
  {
    //distorsion Init
    const double k1 = 0.5, k2 = -0.5, k3 = 0.000005, p1 = 0.07, p2 = -0.05;

    distorsionMatrix(0, 0) = k1;
    distorsionMatrix(0, 1) = k2;
    distorsionMatrix(0, 2) = p1;
    distorsionMatrix(0, 3) = p2;
    distorsionMatrix(0, 4) = k3;
  }

  std::vector<cv::Point2d> distortedPoints;
  std::vector<cv::Point2d> undistortedPoints;
  std::vector<cv::Point2d> redistortedPoints;
  distortedPoints.push_back(cv::Point2d(324., 249.));// equals to optical center
  distortedPoints.push_back(cv::Point2d(340., 200));
  distortedPoints.push_back(cv::Point2d(785., 345.));
  distortedPoints.push_back(cv::Point2d(0., 0.));
  cv::undistortPoints(distortedPoints, undistortedPoints, cameraMatrix, distorsionMatrix);  
  MyDistortPoints(undistortedPoints, redistortedPoints, cameraMatrix, distorsionMatrix);
  cv::undistortPoints(redistortedPoints, undistortedPoints, cameraMatrix, distorsionMatrix);  

  //Poor man's unit test ensuring we have an accuracy that is better than 0.001 pixel
  for (unsigned int i = 0; i < undistortedPoints.size(); i++)
  {
    cv::Point2d dist = redistortedPoints[i] - distortedPoints[i];
    double norm = sqrt(dist.dot(dist));
    std::cout << "norm = " << norm << std::endl;
    assert(norm < 1E-3);
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-06T17:21:33.503

对于那些仍在搜索的人，这里有一个简单的 python 函数，它会扭曲点回来：

```
def distortPoints(undistortedPoints, k, d):

    undistorted = np.float32(undistortedPoints[:, np.newaxis, :])

    kInv = np.linalg.inv(k)

    for i in range(len(undistorted)):
        srcv = np.array([undistorted[i][0][0], undistorted[i][0][1], 1])
        dstv = kInv.dot(srcv)
        undistorted[i][0][0] = dstv[0]
        undistorted[i][0][1] = dstv[1]

    distorted = cv2.fisheye.distortPoints(undistorted, k, d)
    return distorted 
```

例子：

```
undistorted = np.array([(639.64, 362.09), (234, 567)])
distorted = distortPoints(undistorted, camK, camD)
print(distorted) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-03T07:03:14.600

这是 main.cpp。它是自给自足的，除了opencv之外不需要其他任何东西。我不记得我在哪里找到的，它有效，我在我的项目中使用它。该程序吃掉一组标准棋盘图像，并生成带有相机所有失真的 json/xml 文件。

```
#include <iostream>
#include <sstream>
#include <time.h>
#include <stdio.h>

#include <opencv2/core/core.hpp>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/calib3d/calib3d.hpp>
#include <opencv2/highgui/highgui.hpp>

#ifndef _CRT_SECURE_NO_WARNINGS
# define _CRT_SECURE_NO_WARNINGS
#endif

using namespace cv;
using namespace std;

static void help()
{
        cout <<  "This is a camera calibration sample." << endl
        <<  "Usage: calibration configurationFile"  << endl
        <<  "Near the sample file you'll find the configuration file, which has detailed help of "
        "how to edit it.  It may be any OpenCV supported file format XML/YAML." << endl;
}
class Settings
{
public:
        Settings() : goodInput(false) {}
        enum Pattern { NOT_EXISTING, CHESSBOARD, CIRCLES_GRID, ASYMMETRIC_CIRCLES_GRID };
        enum InputType {INVALID, CAMERA, VIDEO_FILE, IMAGE_LIST};

        void write(FileStorage& fs) const                        //Write serialization for this class
        {
                fs << "{" << "BoardSize_Width"  << boardSize.width
                << "BoardSize_Height" << boardSize.height
                << "Square_Size"         << squareSize
                << "Calibrate_Pattern" << patternToUse
                << "Calibrate_NrOfFrameToUse" << nrFrames
                << "Calibrate_FixAspectRatio" << aspectRatio
                << "Calibrate_AssumeZeroTangentialDistortion" << calibZeroTangentDist
                << "Calibrate_FixPrincipalPointAtTheCenter" << calibFixPrincipalPoint

                << "Write_DetectedFeaturePoints" << bwritePoints
                << "Write_extrinsicParameters"   << bwriteExtrinsics
                << "Write_outputFileName"  << outputFileName

                << "Show_UndistortedImage" << showUndistorsed

                << "Input_FlipAroundHorizontalAxis" << flipVertical
                << "Input_Delay" << delay
                << "Input" << input
                << "}";
        }
        void read(const FileNode& node)                          //Read serialization for this class
        {
                node["BoardSize_Width" ] >> boardSize.width;
                node["BoardSize_Height"] >> boardSize.height;
                node["Calibrate_Pattern"] >> patternToUse;
                node["Square_Size"]  >> squareSize;
                node["Calibrate_NrOfFrameToUse"] >> nrFrames;
                node["Calibrate_FixAspectRatio"] >> aspectRatio;
                node["Write_DetectedFeaturePoints"] >> bwritePoints;
                node["Write_extrinsicParameters"] >> bwriteExtrinsics;
                node["Write_outputFileName"] >> outputFileName;
                node["Calibrate_AssumeZeroTangentialDistortion"] >> calibZeroTangentDist;
                node["Calibrate_FixPrincipalPointAtTheCenter"] >> calibFixPrincipalPoint;
                node["Input_FlipAroundHorizontalAxis"] >> flipVertical;
                node["Show_UndistortedImage"] >> showUndistorsed;
                node["Input"] >> input;
                node["Input_Delay"] >> delay;
                interprate();
        }
        void interprate()
        {
                goodInput = true;
                if (boardSize.width <= 0 || boardSize.height <= 0)
                {
                        cerr << "Invalid Board size: " << boardSize.width << " " << boardSize.height << endl;
                        goodInput = false;
                }
                if (squareSize <= 10e-6)
                {
                        cerr << "Invalid square size " << squareSize << endl;
                        goodInput = false;
                }
                if (nrFrames <= 0)
                {
                        cerr << "Invalid number of frames " << nrFrames << endl;
                        goodInput = false;
                }

                if (input.empty())      // Check for valid input
                        inputType = INVALID;
                else
                {
                        if (input[0] >= '0' && input[0] <= '9')
                        {
                                stringstream ss(input);
                                ss >> cameraID;
                                inputType = CAMERA;
                        }
                        else
                        {
                                if (readStringList(input, imageList))
                                {
                                        inputType = IMAGE_LIST;
                                        nrFrames = (nrFrames < (int)imageList.size()) ? nrFrames : (int)imageList.size();
                                }
                                else
                                        inputType = VIDEO_FILE;
                        }
                        if (inputType == CAMERA)
                                inputCapture.open(cameraID);
                        if (inputType == VIDEO_FILE)
                                inputCapture.open(input);
                        if (inputType != IMAGE_LIST && !inputCapture.isOpened())
                                inputType = INVALID;
                }
                if (inputType == INVALID)
                {
                        cerr << " Inexistent input: " << input << endl;
                        goodInput = false;
                }

                flag = 0;
                if(calibFixPrincipalPoint) flag |= CV_CALIB_FIX_PRINCIPAL_POINT;
                if(calibZeroTangentDist)   flag |= CV_CALIB_ZERO_TANGENT_DIST;
                if(aspectRatio)            flag |= CV_CALIB_FIX_ASPECT_RATIO;

                calibrationPattern = NOT_EXISTING;
                if (!patternToUse.compare("CHESSBOARD")) calibrationPattern = CHESSBOARD;
                if (!patternToUse.compare("CIRCLES_GRID")) calibrationPattern = CIRCLES_GRID;
                if (!patternToUse.compare("ASYMMETRIC_CIRCLES_GRID")) calibrationPattern = ASYMMETRIC_CIRCLES_GRID;
                if (calibrationPattern == NOT_EXISTING)
                {
                        cerr << " Inexistent camera calibration mode: " << patternToUse << endl;
                        goodInput = false;
                }
                atImageList = 0;

        }
        Mat nextImage()
        {
                Mat result;
                if( inputCapture.isOpened() )
                {
                        Mat view0;
                        inputCapture >> view0;
                        view0.copyTo(result);
                }
                else if( atImageList < (int)imageList.size() )
                        result = imread(imageList[atImageList++], CV_LOAD_IMAGE_COLOR);

                return result;
        }

        static bool readStringList( const string& filename, vector<string>& l )
        {
                l.clear();
                FileStorage fs(filename, FileStorage::READ);
                if( !fs.isOpened() )
                        return false;
                FileNode n = fs.getFirstTopLevelNode();
                if( n.type() != FileNode::SEQ )
                        return false;
                FileNodeIterator it = n.begin(), it_end = n.end();
                for( ; it != it_end; ++it )
                        l.push_back((string)*it);
                return true;
        }
public:
        Size boardSize;            // The size of the board -> Number of items by width and height
        Pattern calibrationPattern;// One of the Chessboard, circles, or asymmetric circle pattern
        float squareSize;          // The size of a square in your defined unit (point, millimeter,etc).
        int nrFrames;              // The number of frames to use from the input for calibration
        float aspectRatio;         // The aspect ratio
        int delay;                 // In case of a video input
        bool bwritePoints;         //  Write detected feature points
        bool bwriteExtrinsics;     // Write extrinsic parameters
        bool calibZeroTangentDist; // Assume zero tangential distortion
        bool calibFixPrincipalPoint;// Fix the principal point at the center
        bool flipVertical;          // Flip the captured images around the horizontal axis
        string outputFileName;      // The name of the file where to write
        bool showUndistorsed;       // Show undistorted images after calibration
        string input;               // The input ->

        int cameraID;
        vector<string> imageList;
        int atImageList;
        VideoCapture inputCapture;
        InputType inputType;
        bool goodInput;
        int flag;

private:
        string patternToUse;

};

static void read(const FileNode& node, Settings& x, const Settings& default_value = Settings())
{
        if(node.empty())
                x = default_value;
        else
                x.read(node);
}

enum { DETECTION = 0, CAPTURING = 1, CALIBRATED = 2 };

bool runCalibrationAndSave(Settings& s, Size imageSize, Mat&  cameraMatrix, Mat& distCoeffs,
                           vector<vector<Point2f> > imagePoints );

int main(int argc, char* argv[])
{
//        help();
        Settings s;
        const string inputSettingsFile = argc > 1 ? argv[1] : "default.xml";
        FileStorage fs(inputSettingsFile, FileStorage::READ); // Read the settings
        if (!fs.isOpened())
        {
                cout << "Could not open the configuration file: \"" << inputSettingsFile << "\"" << endl;
                return -1;
        }
        fs["Settings"] >> s;
        fs.release();                                         // close Settings file

        if (!s.goodInput)
        {
                cout << "Invalid input detected. Application stopping. " << endl;
                return -1;
        }

        vector<vector<Point2f> > imagePoints;
        Mat cameraMatrix, distCoeffs;
        Size imageSize;
        int mode = s.inputType == Settings::IMAGE_LIST ? CAPTURING : DETECTION;
        clock_t prevTimestamp = 0;
        const Scalar RED(0,0,255), GREEN(0,255,0);
        const char ESC_KEY = 27;

        for(int i = 0;;++i)
        {
                Mat view;
                bool blinkOutput = false;

                view = s.nextImage();

                //-----  If no more image, or got enough, then stop calibration and show result -------------
                if( mode == CAPTURING && imagePoints.size() >= (unsigned)s.nrFrames )
                {
                        if( runCalibrationAndSave(s, imageSize,  cameraMatrix, distCoeffs, imagePoints))
                                mode = CALIBRATED;
                        else
                                mode = DETECTION;
                }
                if(view.empty())          // If no more images then run calibration, save and stop loop.
                {
                        if( imagePoints.size() > 0 )
                                runCalibrationAndSave(s, imageSize,  cameraMatrix, distCoeffs, imagePoints);
                        break;
                }

                imageSize = view.size();  // Format input image.
                if( s.flipVertical )    flip( view, view, 0 );

                vector<Point2f> pointBuf;

                bool found;
                switch( s.calibrationPattern ) // Find feature points on the input format
                {
                        case Settings::CHESSBOARD:
                                found = findChessboardCorners( view, s.boardSize, pointBuf,
                                                              CV_CALIB_CB_ADAPTIVE_THRESH | CV_CALIB_CB_FAST_CHECK | CV_CALIB_CB_NORMALIZE_IMAGE);
                                break;
                        case Settings::CIRCLES_GRID:
                                found = findCirclesGrid( view, s.boardSize, pointBuf );
                                break;
                        case Settings::ASYMMETRIC_CIRCLES_GRID:
                                found = findCirclesGrid( view, s.boardSize, pointBuf, CALIB_CB_ASYMMETRIC_GRID );
                                break;
                        default:
                                found = false;
                                break;
                }

                if ( found)                // If done with success,
                {
                        // improve the found corners' coordinate accuracy for chessboard
                        if( s.calibrationPattern == Settings::CHESSBOARD)
                        {
                                Mat viewGray;
                                cvtColor(view, viewGray, COLOR_BGR2GRAY);
                                cornerSubPix( viewGray, pointBuf, Size(11,11),
                                             Size(-1,-1), TermCriteria( CV_TERMCRIT_EPS+CV_TERMCRIT_ITER, 30, 0.1 ));
                        }

                        if( mode == CAPTURING &&  // For camera only take new samples after delay time
                           (!s.inputCapture.isOpened() || clock() - prevTimestamp > s.delay*1e-3*CLOCKS_PER_SEC) )
                        {
                                imagePoints.push_back(pointBuf);
                                prevTimestamp = clock();
                                blinkOutput = s.inputCapture.isOpened();
                        }

                        // Draw the corners.
                        drawChessboardCorners( view, s.boardSize, Mat(pointBuf), found );
                }

                //----------------------------- Output Text ------------------------------------------------
                string msg = (mode == CAPTURING) ? "100/100" :
                mode == CALIBRATED ? "Calibrated" : "Press 'g' to start";
                int baseLine = 0;
                Size textSize = getTextSize(msg, 1, 1, 1, &baseLine);
                Point textOrigin(view.cols - 2*textSize.width - 10, view.rows - 2*baseLine - 10);

                if( mode == CAPTURING )
                {
                        if(s.showUndistorsed)
                                msg = format( "%d/%d Undist", (int)imagePoints.size(), s.nrFrames );
                        else
                                msg = format( "%d/%d", (int)imagePoints.size(), s.nrFrames );
                }

                putText( view, msg, textOrigin, 1, 1, mode == CALIBRATED ?  GREEN : RED);

                if( blinkOutput )
                        bitwise_not(view, view);

                //------------------------- Video capture  output  undistorted ------------------------------
                if( mode == CALIBRATED && s.showUndistorsed )
                {
                        Mat temp = view.clone();
                        undistort(temp, view, cameraMatrix, distCoeffs);
                }

                //------------------------------ Show image and check for input commands -------------------
                imshow("Image View", view);
                char key = (char)waitKey(s.inputCapture.isOpened() ? 50 : s.delay);

                if( key  == ESC_KEY )
                        break;

                if( key == 'u' && mode == CALIBRATED )
                        s.showUndistorsed = !s.showUndistorsed;

                if( s.inputCapture.isOpened() && key == 'g' )
                {
                        mode = CAPTURING;
                        imagePoints.clear();
                }
        }

        // -----------------------Show the undistorted image for the image list ------------------------
        if( s.inputType == Settings::IMAGE_LIST && s.showUndistorsed )
        {
                Mat view, rview, map1, map2;
                initUndistortRectifyMap(cameraMatrix, distCoeffs, Mat(),
                                        getOptimalNewCameraMatrix(cameraMatrix, distCoeffs, imageSize, 1, imageSize, 0),
                                        imageSize, CV_16SC2, map1, map2);

                for(int i = 0; i < (int)s.imageList.size(); i++ )
                {
                        view = imread(s.imageList[i], 1);
                        if(view.empty())
                                continue;
                        remap(view, rview, map1, map2, INTER_LINEAR);
                        imshow("Image View", rview);
                        char c = (char)waitKey();
                        if( c  == ESC_KEY || c == 'q' || c == 'Q' )
                                break;
                }
        }

        return 0;
}

static double computeReprojectionErrors( const vector<vector<Point3f> >& objectPoints,
                                        const vector<vector<Point2f> >& imagePoints,
                                        const vector<Mat>& rvecs, const vector<Mat>& tvecs,
                                        const Mat& cameraMatrix , const Mat& distCoeffs,
                                        vector<float>& perViewErrors)
{
        vector<Point2f> imagePoints2;
        int i, totalPoints = 0;
        double totalErr = 0, err;
        perViewErrors.resize(objectPoints.size());

        for( i = 0; i < (int)objectPoints.size(); ++i )
        {
                projectPoints( Mat(objectPoints[i]), rvecs[i], tvecs[i], cameraMatrix,
                              distCoeffs, imagePoints2);
                err = norm(Mat(imagePoints[i]), Mat(imagePoints2), CV_L2);

                int n = (int)objectPoints[i].size();
                perViewErrors[i] = (float) std::sqrt(err*err/n);
                totalErr        += err*err;
                totalPoints     += n;
        }

        return std::sqrt(totalErr/totalPoints);
}

static void calcBoardCornerPositions(Size boardSize, float squareSize, vector<Point3f>& corners,
                                     Settings::Pattern patternType /*= Settings::CHESSBOARD*/)
{
        corners.clear();

        switch(patternType)
        {
                case Settings::CHESSBOARD:
                case Settings::CIRCLES_GRID:
                        for( int i = 0; i < boardSize.height; ++i )
                                for( int j = 0; j < boardSize.width; ++j )
                                        corners.push_back(Point3f(float( j*squareSize ), float( i*squareSize ), 0));
                        break;

                case Settings::ASYMMETRIC_CIRCLES_GRID:
                        for( int i = 0; i < boardSize.height; i++ )
                                for( int j = 0; j < boardSize.width; j++ )
                                        corners.push_back(Point3f(float((2*j + i % 2)*squareSize), float(i*squareSize), 0));
                        break;
                default:
                        break;
        }
}

static bool runCalibration( Settings& s, Size& imageSize, Mat& cameraMatrix, Mat& distCoeffs,
                           vector<vector<Point2f> > imagePoints, vector<Mat>& rvecs, vector<Mat>& tvecs,
                           vector<float>& reprojErrs,  double& totalAvgErr)
{

        cameraMatrix = Mat::eye(3, 3, CV_64F);
        if( s.flag & CV_CALIB_FIX_ASPECT_RATIO )
                cameraMatrix.at<double>(0,0) = 1.0;

        distCoeffs = Mat::zeros(8, 1, CV_64F);

        vector<vector<Point3f> > objectPoints(1);
        calcBoardCornerPositions(s.boardSize, s.squareSize, objectPoints[0], s.calibrationPattern);

        objectPoints.resize(imagePoints.size(),objectPoints[0]);

        //Find intrinsic and extrinsic camera parameters
        double rms = calibrateCamera(objectPoints, imagePoints, imageSize, cameraMatrix,
                                     distCoeffs, rvecs, tvecs, s.flag|CV_CALIB_FIX_K4|CV_CALIB_FIX_K5);

        cout << "Re-projection error reported by calibrateCamera: "<< rms << endl;

        bool ok = checkRange(cameraMatrix) && checkRange(distCoeffs);

        totalAvgErr = computeReprojectionErrors(objectPoints, imagePoints,
                                                rvecs, tvecs, cameraMatrix, distCoeffs, reprojErrs);

        return ok;
}

// Print camera parameters to the output file
static void saveCameraParams( Settings& s, Size& imageSize, Mat& cameraMatrix, Mat& distCoeffs,
                             const vector<Mat>& rvecs, const vector<Mat>& tvecs,
                             const vector<float>& reprojErrs, const vector<vector<Point2f> >& imagePoints,
                             double totalAvgErr )
{
        FileStorage fs( s.outputFileName, FileStorage::WRITE );

        time_t tm;
        time( &tm );
        struct tm *t2 = localtime( &tm );
        char buf[1024];
        strftime( buf, sizeof(buf)-1, "%c", t2 );

        fs << "calibration_Time" << buf;

        if( !rvecs.empty() || !reprojErrs.empty() )
                fs << "nrOfFrames" << (int)std::max(rvecs.size(), reprojErrs.size());
        fs << "image_Width" << imageSize.width;
        fs << "image_Height" << imageSize.height;
        fs << "board_Width" << s.boardSize.width;
        fs << "board_Height" << s.boardSize.height;
        fs << "square_Size" << s.squareSize;

        if( s.flag & CV_CALIB_FIX_ASPECT_RATIO )
                fs << "FixAspectRatio" << s.aspectRatio;

        if( s.flag )
        {
                sprintf( buf, "flags: %s%s%s%s",
                        s.flag & CV_CALIB_USE_INTRINSIC_GUESS ? " +use_intrinsic_guess" : "",
                        s.flag & CV_CALIB_FIX_ASPECT_RATIO ? " +fix_aspectRatio" : "",
                        s.flag & CV_CALIB_FIX_PRINCIPAL_POINT ? " +fix_principal_point" : "",
                        s.flag & CV_CALIB_ZERO_TANGENT_DIST ? " +zero_tangent_dist" : "" );
                cvWriteComment( *fs, buf, 0 );

        }

        fs << "flagValue" << s.flag;

        fs << "Camera_Matrix" << cameraMatrix;
        fs << "Distortion_Coefficients" << distCoeffs;

        fs << "Avg_Reprojection_Error" << totalAvgErr;
        if( !reprojErrs.empty() )
                fs << "Per_View_Reprojection_Errors" << Mat(reprojErrs);

        if( !rvecs.empty() && !tvecs.empty() )
        {
                CV_Assert(rvecs[0].type() == tvecs[0].type());
                Mat bigmat((int)rvecs.size(), 6, rvecs[0].type());
                for( int i = 0; i < (int)rvecs.size(); i++ )
                {
                        Mat r = bigmat(Range(i, i+1), Range(0,3));
                        Mat t = bigmat(Range(i, i+1), Range(3,6));

                        CV_Assert(rvecs[i].rows == 3 && rvecs[i].cols == 1);
                        CV_Assert(tvecs[i].rows == 3 && tvecs[i].cols == 1);
                        //*.t() is MatExpr (not Mat) so we can use assignment operator
                        r = rvecs[i].t();
                        t = tvecs[i].t();
                }
                cvWriteComment( *fs, "a set of 6-tuples (rotation vector + translation vector) for each view", 0 );
                fs << "Extrinsic_Parameters" << bigmat;
        }

        if( !imagePoints.empty() )
        {
                Mat imagePtMat((int)imagePoints.size(), (int)imagePoints[0].size(), CV_32FC2);
                for( int i = 0; i < (int)imagePoints.size(); i++ )
                {
                        Mat r = imagePtMat.row(i).reshape(2, imagePtMat.cols);
                        Mat imgpti(imagePoints[i]);
                        imgpti.copyTo(r);
                }
                fs << "Image_points" << imagePtMat;
        }
}

bool runCalibrationAndSave(Settings& s, Size imageSize, Mat&  cameraMatrix, Mat& distCoeffs,vector<vector<Point2f> > imagePoints )
{
        vector<Mat> rvecs, tvecs;
        vector<float> reprojErrs;
        double totalAvgErr = 0;

        bool ok = runCalibration(s,imageSize, cameraMatrix, distCoeffs, imagePoints, rvecs, tvecs,
                                 reprojErrs, totalAvgErr);
        cout << (ok ? "Calibration succeeded" : "Calibration failed")
        << ". avg re projection error = "  << totalAvgErr ;

        if( ok )
                saveCameraParams( s, imageSize, cameraMatrix, distCoeffs, rvecs ,tvecs, reprojErrs,
                                 imagePoints, totalAvgErr);
        return ok;
} 
```

# jquery - 突出显示最靠近视口中间的元素

> ID：10935888
> 
> 赞同：1
> 
> 时间：2012-06-07T16:25:19.507
> 
> 标签：jquery

我在页面上有 3 个锚点。我想突出显示根据哪个锚点最靠近视口中间而固定的按钮列表。

我该怎么做？

我已经在使用 InView 和 ViewportOffset 插件了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:56:48.563

所以如果你没有视口的坐标，那么，你可以得到中间：

```
x = (viewport.x2 - viewport.x1) / 2;
y = (viewport.y2 - viewport.y1) / 2; 
```

现在您可以执行以下操作：

```
var distances = [];
var elems = $("a");
elems.each(function(i){
    var o = $(this).offset();
    var d2 = (o.left - x)*(o.left - x) + (o.top - y)*(o.top - y);
    distances[i] = d2
}); 
```

现在你有了数组中距离的“平方”，你需要搜索最小的（最靠近中间的）：

```
var closest = 0;
for (i=0; i<distances.length;i++) {
    if (distances[i] < distances[closest]) {
         closest = i;
    }
} 
```

现在你有了“closest”中最近元素的索引，所以你可以用它做任何事情，比如：

```
elems[i].addClass("higlighted"); 
```

# javascript - 如何在单击按钮时启用/禁用文本框

> ID：10935889
> 
> 赞同：0
> 
> 时间：2012-06-07T16:25:25.963
> 
> 标签：javascript, html

例如，我的页面有一个文本框，它已经有一些值，并且它的只读选项是 "true" ，当单击文本框旁边的编辑按钮时，文本框中的编辑选项被启用。单击按钮时如何实现启用文本框。

```
function func() {
    $("input:button[name='button1']").click(function() {
        $("#text11").val($(this).val()).attr("disabled", "disabled");
        if($(this).val() != "") { 
            $("#text11").attr("disabled", "").focus();
        } 
    });
} 
```

```
<input type="text" name="text11" readonly="readonly" value="Editing is disabled">
<input type="button" value="edit" name="button1"> 
```

当我单击此按钮时，应该禁用文本框中的只读选项。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:42:54.537

基本上，您只想将禁用的属性添加到您的元素以阻止用户使用它。

```
$('#disablebutton').click(function(){
    $('#textfieldToClose').attr('disable');
});

<input type="text" name="text11" readonly="readonly" id="textfieldToClose">
<input type="button" value="edit" name="button1" id="disablebutton"> 
```

我相信这应该工作，还没有测试过介意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:30:34.720

您需要使用 HTML DOM 对象...

[http://www.w3schools.com/jsref/default.asp](http://www.w3schools.com/jsref/default.asp)

# actionscript-3 - 使用 cdata html 文本自动调整文本字段大小

> ID：10935891
> 
> 赞同：1
> 
> 时间：2012-06-07T16:25:36.037
> 
> 标签：actionscript-3, flash, actionscript

我希望能够根据文本字段的动态数据更改多行文本字段的宽度和高度。高度不是问题，但宽度不会改变。宽度必须像单行文本字段一样自动调整大小。有没有办法做到这一点？

我有一个这样的xml数据：

```
<![CDATA[<b>some long text</b> <br> some long text <br> some long text ]]> 
```

在动作脚本中：

```
tx_txt.autoSize = TextFieldAutoSize.LEFT;
tx_txt.htmlText = fromXML; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:51:00.180

我认为您只想设置`multiline`为 true 并省略该`width`属性，并且该字段应在中断之前调整为最长行的长度：

```
import flash.text.*;

var fromXML:String = "<b>some long text adfs afdsadfs afdsadfsfads</b> <br> some long text <br> some long text";

var tx_txt:TextField = new TextField();
tx_txt.autoSize = TextFieldAutoSize.LEFT;
tx_txt.multiline = true;
tx_txt.htmlText = fromXML;
tx_txt.border = true;

this.addChild(tx_txt); 
```

# delphi - 如何转换数据类型以调用 COM 过程？

> ID：10935894
> 
> 赞同：4
> 
> 时间：2012-06-07T16:25:40.680
> 
> 标签：delphi, com, delphi-xe2

我有一个需要使用 COM 调用的过程，它在 C# 中声明如下：

```
void DoSomething (string param1, string[] param2, Object[] param3) 
```

导入的 TypeLibrary 中的 Delphi 声明为：

```
procedure DoSomething (param1: System.Widestring, 
                       param2: ActiveX.PSafeArray, 
                       param3: ActiveX.PSafeArray); 
```

param1 只是一个字符串。
param2 是一个参数名称数组，比如说：['arg1', 'arg2']。
param3 是这些参数的相应值。

示例：arg1: Double = 1.23, arg2: integer = 10。
这将导致：
- param2: ['arg1', 'arg2']
- param3: [1.23, 10]

到目前为止，我有这段代码可以将 param2[] 转换为 PSafeArray：

```
var param2: array of string;
    i: integer;
    va_param2: Variant;
    psa_param2: Activex.PSafeArray;
begin
  SetLength (param2, 2);
  param2 [0] := 'arg1';
  param2 [1] := 'arg2';
  // Create VariantArray, copy data
  va_param2 := VarArrayCreate ([0, Length(param2)-1], varOleStr);
  for i := 0 to Length(param2)-1 do
    va_param2 [i] := param2 [i];
  // Convert VariantArray to PSafeArray
  psa_param2 := PSafeArray (TVarData (va_param2).VArray);
end; 
```

现在我应该有 param2 的 PSafeArray。
但是我怎样才能为 param3[] 做到这一点？
将有不同的数据类型，而不仅仅是字符串。

由于在设置 param2 和 param3 之前我无法调用 COM 过程，因此我也无法确定上面的代码是否在做我需要的事情。
它运行了，但是我是否正确地进行了这些转换以将结果传递给上述 COM 过程？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T20:43:58.167

默认情况下，.NET`Object`被编组为 COM ，除非在 C# 代码中使用语法`VARIANT`明确指定为`IUnknown`or 。`IDispatch``MarshalAs`

试试这个：

```
var
  param2: array of string; 
  param3: array of Variant; 
  i: integer; 
  va_param2: Variant; 
  va_param3: Variant; 
  psa_param2: Activex.PSafeArray; 
  psa_param3: Activex.PSafeArray; 
begin 
  SetLength (param2, 2); 
  param2 [0] := 'arg1'; 
  param2 [1] := 'arg2'; 

  SetLength (param3, 2);
  param3[0] := 1.23;
  param3[1] := 10;

  // Create arrays, copy data 

  va_param2 := VarArrayCreate ([Low(param2), High(param2)], varOleStr); 
  for i := Low(param2) to High(param2) do 
    va_param2 [i] := param2 [i]; 

  va_param3 := VarArrayCreate ([Low(param3), High(param3)], varVariant); 
  for i := Low(param3) to High(param3) do 
    va_param3 [i] := param3 [i]; 

  // Convert arrays to PSafeArray 

  psa_param2 := PSafeArray (TVarData (va_param2).VArray); 
  psa_param3 := PSafeArray (TVarData (va_param3).VArray); 

  ...
end; 
```

# vba - 如何通过两个不同工作表上的列表比较使用 VBA 的值

> ID：10935896
> 
> 赞同：0
> 
> 时间：2012-06-07T16:25:44.540
> 
> 标签：vba, worksheet

我正在尝试将一个工作表中的 2 列与另一个工作表中的 2 列（或可能更多）进行匹配。

我已经发布了我的工作表数据样本，希望能很好地描述我过去一周一直在尝试做的事情。我认为我在正确的轨道上，但我不知道如何在两个工作表之间正确引用。

我想做的是查看位置 1 列，然后查看该位置是否与位置 1 或位置 2 中的我的 RefSheet 引用。

如果是这样，我想看看位置 2 是否在 RefSheet 的同一行的某处匹配。如果匹配，我想突出显示单元格/单元格黄色并提供 RefSheet 中的 ID 号。

如果没有匹配，我想将其突出显示为红色或不突出显示。

```
Sheet All
A       B               C               D
ID  Location 1  Location 2  Given ID
1   West    North   
2   North   South   
3   South   East    
4   East    West    
5   East    East    
6   South   West

Sheet RefSheet
A       B               C   
ID  Location 1     Location 2
1   West            North
2   West            East
3   South           East
4   South           North

What it should look like on the original Worksheet
A               B               C           D
ID          Location 1  Location 2      Given ID
1(Yellow)   West            North           1
2(Yellow)   North           South           4
3(Yellow)   South           East            3
4(Yellow)   East            West            2
5(Red)      East            East    
6(Red)      South           West 
```

这是我可怕的代码

```
 Sub roadfinder()

    Dim lngLast As Long
    Dim lngCounter As Long
    Dim rCell As Range
    Dim lCnt As Long
    Dim nextIntersection
    Dim RefSheet As Worksheet
    Dim list As Worksheet

    Set intersections = ThisWorkbook.Sheets("RefSheet")
    Set crashes = ThisWorkbook.Sheets("All")

    Application.ScreenUpdating = False
    lngLast = Cells(Rows.Count, "B").End(xlUp).Row
    For lngCounter = 2 To lngLast
        With Cells(lngCounter, "B")

            For Each rCell In RefSheet.Range("B1", RefSheet.Cells(RefSheet.Rows.Count, 1)).Cells
            lCnt = lCnt + 1

                'I wasn't sure what to put as a reference to
                If .Value = "" Then
                    .Interior.ColorIndex = 6

                End If

            Next rCell
        End With
    Next lngCounter

    Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:13:41.140

实际上，无需任何编程，只需一个简单的 excel 公式即可轻松完成。**只需将以下作为数组公式**的给定 ID 放入列的单元格 2 ：

```
=SUM(SIGN((B2=Refsheet!$B$2:$B$5)*(C2=Refsheet!$C$2:$C$5)+(B2=Refsheet!$C$2:$C$5)*(C2=Refsheet!$B$2:$B$5))*Refsheet!$A$2:$A$5) 
```

并通过整个列复制此公式（我假设您的输入位置在 B、C 列中，并且您的 RefSheet 范围在 A2-C5 中，就像您在示例中提供的那样）尽管您最好在 Refsheet 上创建命名范围，因此公式将变为：

```
=SUM(SIGN((B2=Ref_Loc1)*(C2=Ref_Loc2)+(B2=Ref_Loc2)*(C2=Ref_Loc1))*Ref_ID) 
```

（记住，它应该是一个数组公式）。获得 ID 后，您可以根据 ID 是否为 0（表示未找到）轻松地对输入单元格进行条件格式设置。refsheet 位置对必须是唯一的，ID 必须是数字而不是零。

# r - 测量R中smooth.spline上点的极限

> ID：10935898
> 
> 赞同：0
> 
> 时间：2012-06-07T16:25:47.963
> 
> 标签：r, statistics, regression

我不确定这是否是正确的术语。

我已经在 R 中输入了一些数据，并使用以下命令通过它放置了一个 smooth.spline。

```
smoothingSpline = smooth.spline(year, rate, spar=0.35)
plot(x,y)
lines(smoothingSpline) 
```

现在我想测量一些限制（或曲线在给定 x 点的位置），并且可能对超出图表的点进行一些预测分析。

R中是否有用于测量（或预测）曲线上的点的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:31:44.173

是`?predict.smooth.spline`你要找的吗？

# kinect - 已安装 Kinect SDK，相机功能不起作用

> ID：10935900
> 
> 赞同：3
> 
> 时间：2012-06-07T16:26:04.903
> 
> 标签：kinect

我对这篇文章有同样的问题：[MSDN Post](http://social.msdn.microsoft.com/Forums/en-US/kinectsdk/thread/db00f3ec-8641-45a5-ac5b-04b537963186)。似乎没有人回答该线程上的有效解决方案。

## 症状：

*   已安装 Kinect SDK 1.5。
*   Kinect 设备已被识别并且驱动程序似乎已正确加载。语音演示工作正常。
*   骨架查看器显示“无法启用骨架跟踪”。
*   Shape Game 启动，但不跟踪任何内容。
*   Kinect Explorer 启动小窗口仅显示已连接到 Kinect，黑色窗口未打开。如果我关闭白色窗口，kinect explorer 仍在运行，我必须通过任务管理器退出它。
*   当我打开 Kinect 资源管理器后拔出和插入 USB 时；它说带宽不足。

## 我试过了：

*   更新了 BIOS。
*   更新主板软件。(华硕 Maximus IV Gene-Z, Gen3)
*   删除所有USB并将它们全部插入。
*   重新启动的窗口。（几百万次）
*   我卸载并重新安装。Kinect SDK 1.0。（但一切都是一样的）

**我的操作系统：** Windows 7 64 位旗舰版。

我已经为此苦苦挣扎了整整一天。任何建议将不胜感激。

```
EDIT: I tried my Kinect device on another computer (laptop), and it works. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T13:59:11.150

我终于能够让我的 kinect 工作了。这个[MSDN Discussion](http://social.msdn.microsoft.com/Forums/en-US/kinectsdk/thread/1edc452e-2f86-4426-97d5-2161ba932e69)帮助我做到了这一点。

## 解决方案：

1.  从控制面板卸载所有 Kinect 驱动程序。
2.  重新安装 Kinect SDK。
3.  **（重要）**确保在驱动程序安装期间跳过从 Windows 更新获取驱动程序。

耶！它工作得很漂亮..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T16:56:34.297

如果 Kinect 与其他设备共享 USB 控制器，则很容易出现像您这样的问题。

请尝试以下操作：拔下所有 USB 设备，然后*仅*将 Kinect 连接到您的计算机。如果您有 USB 鼠标和/或键盘，请将它们插入一组不同的端口（例如，如果您将 Kinect 插入计算机背面，则为前置 USB 端口）。然后，尝试运行 SDK 的示例应用程序。

如果这种方法失败，您的 USB 控制器可能有问题。

另一种选择：尝试在另一台 Windows 计算机上运行示例应用程序，最好是某种类型的笔记本电脑，因为您不需要插入任何额外的 USB 设备。

如果这种方法失败，您的 Kinect 很可能有缺陷。在这种情况下，如果购买时间不是很久以前，您可以从零售商处获得更换或退款。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T05:32:22.973

我也遇到了同样的情况；我注意到一个与 Kinect 相关的 Windows 更新，安装了它。Kinect 停止工作。从 2012 年 5 月 2 日起安装 SDK 并没有解决问题。回滚到 2010 年 2 月的 SDK 也没有修复它。起初我猜微软不希望我们再使用 Kinect for Xbox，这是他们告诉我们为 Windows 购买 Kinect 的方式......好吧，可能是 - 但在我的情况下，Kinect 相机驱动程序以某种方式更新到 1.5 版（2012 年 5 月 2 日），而其他一切都在 1.0 版上。安装原始驱动程序解决了问题。

# filter - SingleColumnValueFilter 没有返回正确的行数

> ID：10935901
> 
> 赞同：0
> 
> 时间：2012-06-07T16:26:07.103
> 
> 标签：filter, mapreduce, hbase

在我们的 HBase 表中，每一行都有一个名为 crawl identifier 的列。使用 MapReduce 作业，我们只想随时处理给定爬网中的行。为了更有效地运行作业，我们为扫描对象提供了一个过滤器（我们希望）它会删除除具有给定爬网标识符的行之外的所有行。但是，我们很快发现我们的作业没有处理正确的行数。

我编写了一个测试映射器来简单地计算具有正确爬网标识符的行数，没有任何过滤器。它遍历表中的所有行并计算正确的预期行数（~15000）。当我们做同样的工作，为扫描对象添加一个过滤器时，计数下降到约 3000。在这两项工作期间或之间，没有对桌子本身进行任何操作。

由于添加扫描过滤器会导致可见行发生如此巨大的变化，我们预计我们只是错误地构建了过滤器。

我们的 MapReduce 作业具有单个映射器：

```
public static class RowCountMapper extends TableMapper<ImmutableBytesWritable, Put>{

    public String crawlIdentifier;

    // counters
    private static enum CountRows {
        ROWS_WITH_MATCHED_CRAWL_IDENTIFIER
    }

    @Override
    public void setup(Context context){
        Configuration configuration=context.getConfiguration();
        crawlIdentifier=configuration.get(ConfigPropertyLib.CRAWL_IDENTIFIER_PROPERTY);

    }

    @Override
    public void map(ImmutableBytesWritable legacykey, Result row, Context context){
        String rowIdentifier=HBaseSchema.getValueFromRow(row, HBaseSchema.CRAWL_IDENTIFIER_COLUMN);
        if (StringUtils.equals(crawlIdentifier, rowIdentifier)){
            context.getCounter(CountRows.ROWS_WITH_MATCHED_CRAWL_IDENTIFIER).increment(1l);
        }
    }
} 
```

过滤器设置是这样的：

```
String crawlIdentifier=configuration.get(ConfigPropertyLib.CRAWL_IDENTIFIER_PROPERTY);
if (StringUtils.isBlank(crawlIdentifier)){
    throw new IllegalArgumentException("Crawl Identifier not set.");
}

// build an HBase scanner
Scan scan=new Scan();
SingleColumnValueFilter filter=new SingleColumnValueFilter(HBaseSchema.CRAWL_IDENTIFIER_COLUMN.getFamily(),
    HBaseSchema.CRAWL_IDENTIFIER_COLUMN.getQualifier(),
    CompareOp.EQUAL,
    Bytes.toBytes(crawlIdentifier));
filter.setFilterIfMissing(true);
scan.setFilter(filter); 
```

我们使用了错误的过滤器，还是我们配置错误？

编辑：我们正在考虑按照[https://issues.apache.org/jira/browse/HBASE-2198](https://issues.apache.org/jira/browse/HBASE-2198)手动添加所有列族，但我很确定扫描默认包含所有族。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T11:11:56.087

过滤器看起来是正确的，但在某些情况下，可能导致这种情况的一种情况与字符编码有关。您的过滤器正在使用使用 UTF8 [1] 的 Bytes.toBytes(String)，而您*可能*在 HBaseSchema 中使用本机字符编码，或者如果您使用 String.getBytes()[2]，则在编写记录时。使用以下内容检查 crawlIdentifier 是否最初写入 HBase，以确保过滤器在过滤后的扫描中进行类似的比较。

```
Bytes.toBytes(crawlIdentifier) 
```

[1] [http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/util/Bytes.html#toBytes(java.lang.String](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/util/Bytes.html#toBytes(java.lang.String) ) [2] [http://docs.oracle.com/ javase/1.4.2/docs/api/java/lang/String.html#getBytes](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#getBytes) ()

# c# - 如何创建一个文件夹并询问用户在 C# 中将其保存到哪里？

> ID：10935908
> 
> 赞同：1
> 
> 时间：2012-06-07T16:26:20.253
> 
> 标签：c#, save, directory

我认为我需要的只是问题。我将我的方法放在了我的 Form.Load 中，我可以创建一个文件夹或打开一个 SaveFileDialog，但不能同时打开两者。

如果有人可以帮助我，请。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:31:57.610

为用户打开一个[`FolderBrowserDialog`](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)标题（[`Description`](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.description.aspx)属性）设置为“选择现有文件夹或创建新文件夹”之类的内容。不要忘记将其[`ShowNewFolderButton`](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.shownewfolderbutton.aspx)属性设置为 true。

您也可以使用`FolderBrowserDialog`要求用户仅选择包含（“父”）文件夹，并通过调用自己创建新文件夹[`Directory.CreateDirectory`](http://msdn.microsoft.com/en-us/library/54a0at6s.aspx)。在这种情况下，`ShowNewFolderButton`应该是假的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:37:11.473

SaveFileDialog 允许用户选择一个*已经存在*的文件位置。如果没有，他们可以按照@Bali 的建议在对话框中创建一个文件夹。

如果您希望用户能够在不使用对话框的情况下创建新文件夹，那么您需要让用户输入路径（例如在文本框中）。然后您可以使用 来检查目录是否存在`Directory.Exist`，如果不存在，请使用`Directory.Create`.

```
void CheckPath(string path)
{
   var dir = Path.GetDirectoryName(path);
   if( !String.IsNullOrEmpty(dir) && !Directory.Exists(dir))
      Directory.Create(dir);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:18:35.387

这将是创建一个新目录

```
 Directory.CreateDirectory(@"C:\Your File Path Here"); 
```

这将是打开一个文件。您可以通过更改路径来选择打开文件初始目录的位置。

```
 OpenFileDialog openFileDialog1 = new OpenFileDialog();
        openFileDialog1.InitialDirectory = (@"C:\Your starting File Path");
        openFileDialog1.Filter = "All Files (*.*)|*.*";
        openFileDialog1.Title = "Select a File"; 
```

# sql - 用于检索列中具有条件值的行的 SQL 查询

> ID：10935909
> 
> 赞同：1
> 
> 时间：2012-06-07T16:26:26.873
> 
> 标签：sql

我不知道这个问题以前是否也被问过。如果是这样，请引导我到链接。

我有一个包含三列的表`name`，`type`并且`date`。`Type`只能是 4 个值 A、B、C 和 D

我想获取所有类型为 A、B 或 C 的记录，但条件是它应该仅在同名也具有 D 类型的情况下获取。

例如让我们考虑这张表

```
Name      type    Date 
abc        A       5/7
abc        B       6/7
abc        D       7/7

xyz        A       5/7
xyz        D       6/7

lmn        A       5/7
lmn        B       6/7
lmn        C       7/7 
```

所以这里的交易我需要以下结果集

```
ABC 5/7
ABC 6/7
XYZ 5/7 
```

因为 ABC 和 XYZ 有一个`type`D，所以显示了 ABC 和 XYZ 的其他记录。由于 lmn 没有`type`D 它不包含在结果集中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:30:14.423

要测试记录是否存在，您可以简单地使用`where exists`：

```
select * from mytable t1 where exists (
     select * from mytable t2 where t1.Name=t2.Name and t2.type="D"
); 
```

这可能是不言自明的，但这里有一个参考：[http ://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html)

如果要排除 D 记录，请执行以下操作：

```
select * from mytable t1 where t1.type<>"D" and exists (
     select * from mytable t2 where t1.Name=t2.Name and t2.type="D"
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:31:54.127

尝试这个：

```
SELECT Name, Date
FROM MyTable as mt
WHERE type != 'D'
AND EXISTS
(
   SELECT * FROM MyTable as mt2
   WHERE mt2.type = 'D' and mt2.name = mt.name
) 
```

您正在选择类型不等于的所有记录，`D`并且具有匹配名称的记录，其中类型 IS 等于`D`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:31:08.763

```
create view all_D as select name from your_table where type=D
select * from your_table where type<>D and name in (select * from all_D) 
```

您甚至可以这样做，而不是拥有该视图，而是将该查询放在“不在”之后的括号中

# java - 如何散列二维平面中的几何点？

> ID：10935916
> 
> 赞同：1
> 
> 时间：2012-06-07T16:27:09.677
> 
> 标签：java, algorithm, hash

简单地说，我有很多 (x, y) 形式的点。

我想将这些点放入一个哈希表中，其中点是关键。

我应该如何实现`hashCode()`类的方法`Point`？以Java为语言

```
class Point {
   public double x;
   public double y;

   @Override
   public int hashCode() {
      // How do I implement here?
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:38:56.660

数字倾向于聚集在大多数坐标平面上；因为，我们倾向于使用舒适范围内的数字。出于这个原因，普通的异或组合是不可取的，因为所有的数字`x == y`都会发生冲突，所有的数字也会发生冲突，`x + 1 == y`依此类推。

为避免这种情况，我建议您先反转 y 坐标的字节，然后再将其与 x 坐标进行异或。这将把一个输入的可变性最大的区域（低位字节）与另一个输入的可变性最小的区域（高位字节）结合起来。在考虑数字簇（例如 x 的值在 1 到 1000 之间）时，这样的算法将给出更均匀的分布。

由于散列算法在散列产生一个没有重聚类的数字字段时效果最佳，因此这种解决方案实际上会由于散列冲突的频率较低而使散列相关的数据结构更快。

当然，以下内容未经过优化，您可能可以对其进行调整以满足您的需求，但这是基本思想：

```
public int hashCode() {

    long bits = Double.doubleToLongBits(y);
    byte[] ybits = new byte[] {
        (byte)((y >> 56) & 0xff),
        (byte)((y >> 48) & 0xff),
        (byte)((y >> 40) & 0xff),
        (byte)((y >> 32) & 0xff),
        (byte)((y >> 24) & 0xff),
        (byte)((y >> 16) & 0xff),
        (byte)((y >> 8) & 0xff),
        (byte)((y >> 0) & 0xff),
    };
    byte[] xbits = new byte[] {
        (byte)((x >> 56) & 0xff),
        (byte)((x >> 48) & 0xff),
        (byte)((x >> 40) & 0xff),
        (byte)((x >> 32) & 0xff),
        (byte)((x >> 24) & 0xff),
        (byte)((x >> 16) & 0xff),
        (byte)((x >> 8) & 0xff),
        (byte)((x >> 0) & 0xff),
    };
    // this combines the bytes of X with the reversed order
    // bytes of Y, and then packs both of those into 4 bytes
    // because we need to return an int (4 bytes).
    byte[] xorbits = new byte[] {
         (xbits[0]^ybits[7])^(xbits[4]^ybits[3]),
         (xbits[1]^ybits[6])^(xbits[5]^ybits[2]),
         (xbits[2]^ybits[5])^(xbits[6]^ybits[1]),
         (xbits[3]^ybits[4])^(xbits[7]^ybits[0]),
    };

    int value = 0;
    for (int i = 0; i < 3; i++) {
       value = (value << 8) + (by[i] & 0xff);
    }
    return value;
} 
```

我建议的初始优化是将哈希码缓存在对象中以供后续查找，如果分析表明这是一个问题，也许可以更有效地管理创建/销毁的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:30:35.067

我不确定双精度的散列有多好，但你应该能够做到：

```
public int hashCode() {
  return x.hashCode() ^ y.hashCode();
} 
```

如果这在测试中产生了太多的冲突（你这样做对吗？），你可以通过位移、幻数等来改变它。真的，各种按位运算。

这是Java吗？我的答案基于我对 C# 的经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:35:26.473

你可以使用任何你想要的功能。这完全取决于您的坐标是什么典型值，以及您希望散列函数有多好。

例如，如果您的所有积分都在 1 到 100 万之间，那么您可以使用类似的东西（这是 C++ 代码，不知道您使用的是什么语言）。

```
size_t hashCode = (size_t)x * (size_t)y; 
```

或者您可以添加这些值，或将这些值相乘，或者做任何您想做的事情。

```
size_t hashCode = (size_t)(x+y); 
```

或者

```
size_t hashCode = (size_t)(x*y); 
```

甚至

```
size_t hashCode = (size_t)(x*y) + (size_t)(x+y); 
```

# vb.net - 使用虚拟 com 端口驱动 FTDI USB 芯片时无法通过 VB.net 中的串行端口接收数据

> ID：10935919
> 
> 赞同：1
> 
> 时间：2012-06-07T16:27:25.980
> 
> 标签：vb.net, serial-port, virtual-serial-port

## 我的设置：

1.  使用 FTDI FT2232D 芯片的硬件设备使用 USB 连接到我的电脑。
2.  我已经安装了 VCP（虚拟 COM 端口）驱动程序，它显示了通过 USB 连接的 FTDI 芯片作为 Windows 中的 COM 端口。
3.  我正在使用一个简单的 VB.net 程序来读取 com 端口。

## 行为：

当我使用 realterm 通过 com 端口向我的设备发送数据时，设备总是成功回复。

当我使用我的 VB.net 测试程序然后使用 realterm 时，tx 工作，但 realterm 没有收到任何回复。

我可以通过拔下usb，重新插入然后重新发送命令来让realterm再次接收数据。

使用我的 vb.net 程序时，拔下和重新插入 USB 并不能解决问题。我的 vb.net 程序有时有效，但并非总是如此。

看起来我的程序中的某些东西导致 com 端口损坏，修复它的唯一方法是拔下 USB 电缆并重新插入。

我的代码看起来像这样：

```
Public Class SerialConnection

    Private MSerialPort As SerialPort
    Private Const StartByte As Byte = &H5B

    Public Sub New(ByVal Port As String)
        MSerialPort = New SerialPort()
        MSerialPort.PortName = Port
        MSerialPort.BaudRate = 9600
        MSerialPort.ReadTimeout = 5000
        MSerialPort.WriteTimeout = 5000
        MSerialPort.Open()
    End Sub

    Public Function SerialPacketTransaction()
        Dim SendPacketBytes = New List(Of Byte)
        Dim ReceivePacketBytes As List(Of Byte)

        MSerialPort.DiscardInBuffer()
    MSerialPort.DiscardOutBuffer()

        SendPacketBytes.Add(StartByte)

        MSerialPort.Write(SendPacketBytes.ToArray, 0, SendPacketBytes.Count)

        Dim TimeoutTime As DateTime = Now().AddMilliseconds(MSerialPort.ReadTimeout)
        Dim readbyte As Byte
        Do
            If Now() > TimeoutTime Then Throw New TimeoutException("Timeout waiting for response")
            Thread.Sleep(50)
            readbyte = ReadSerialByte()
        Loop Until (readbyte = StartByte)
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T14:56:57.440

我有类似的问题，您可以尝试在阅读之前等待接收字节。

此处的详细信息：[USB 串行虚拟 COM 端口：读取不工作但写入工作](https://stackoverflow.com/questions/22193437/usb-serial-virtual-com-port-read-not-working-but-write-works/22882721#22882721)

# ios - 设备关闭或电池耗尽时的 iOS 保存状态

> ID：10935921
> 
> 赞同：0
> 
> 时间：2012-06-07T16:27:30.317
> 
> 标签：ios, battery, savestate

我有一个应用程序可以将手机上创建的记录与网络服务器同步。

当应用程序没有互联网连接时，它将所有内容存储在本地（核心数据），然后在互联网再次可用时同步。

现在一个用户提出了一个有效的用户案例场景......假设他在飞机上制作记录（没有网络）......所以所有内容都存储在本地。一切都很好，直到空姐命令他关掉电话。在应用程序中，如果关闭，他会立即关闭。现在数据正在丢失。当应用程序进入后台甚至手机被锁定时，我正在保存状态。但我如何保证这一点？

当用户关闭手机（长按锁定按钮）时，他们仍然需要滑动一个栏，并且设备需要一些时间才能关闭......所以有一些时间我可以将状态保存在......调用哪个委托方法在这段时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:45:10.197

Your app will get applicationWillResignActive, applicationDidEnterBackground, applicationWillTerminate calls, in that order.

[http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW3](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW3)

You can use applicationWillTerminate as a cue to save stuff.

However it is standard good practice to make sure your data is saved periodically as you go along and not just in these situations - what about if your user has entered lots of lots and data and then your app crashes, the data will be lost.

I'm not very familiar with Core Data but surely it must have atomic save ability.

# java - 使用 Hibernate 创建/重新创建表后不久自动插入第一行

> ID：10935922
> 
> 赞同：0
> 
> 时间：2012-06-07T16:27:31.100
> 
> 标签：java, sql, hibernate, hql

我想要**Username = Administrator**和**Password = admin**，在创建表后不久（或重新创建表时）。

1.  有没有办法使用以下代码插入第一行。我不想使用单独的插入查询
2.  Hibernate 中是否有任何约束来限制用户删除（第一）行

    ```
    @Entity
    @Table(name = "Users")
    public class Users implements Serializable {

        @Id
        @Column(name = "Username", unique = true, nullable = false)
        private String username;

        @Column(name = "Password", nullable = false)
        private String password;

        /**************** getter & setter ************/

    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:35:27.093

您似乎正在寻找的东西称为固定装置。使用 Hibernate，您可以`import.sql`在类路径中提供包含初始数据的文件（插入语句）。

JBoss 的网站上有[更多信息。](http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Data_Services/5/html/Metadata_Repository_Reference_Guide/jdbc-storage-connector.html)

该`import.sql`文件是一个带有 SQL 语句的简单文本文件，每条语句一行：

```
insert into users (id, username) values (1, 'administrator');
insert into users (id, username) values (2, 'user');
... 
```

# django - Django - 如何编写每个字段而不是每个模型的自定义查询集

> ID：10935924
> 
> 赞同：0
> 
> 时间：2012-06-07T16:27:46.437
> 
> 标签：django, django-models, django-managers

我想创建一个自定义字段，这样如果查询该字段，则过滤器始终为 __iexact。

例子：

```
class Domain(models.Model):
    domain = models.IExactCharField()
    name = models.CharField() 
```

我想要一个查询`Domain.objects.filter('domain=newdomain')`被重写为`Domain.objects.filter('domain__iexact=newdomain')`.

我了解您可以使用自定义管理器执行此操作，但我想添加字段以添加自定义管理器。如果已经定义了自定义管理器，我希望将管理器功能链接起来。这可能吗？我正在研究该`contribute_to_class`方法，并认为在定义该字段时它可能具有一些潜力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:07:06.410

下面的代码将不起作用 - 不幸的是，lookup_type 正在其他地方（在 QuerySet 中）添加。我进去看看：）

```
class IExactCharField(models.CharField):
    def get_prep_lookup(self, lookup_type, value):
        return super(IExactCharField, self).get_prep_lookup('iexact', value) 
```

它强制执行 iexact 查找 - 您可以`lookup_type`在引用超类之前添加检查。

PS。请记住，某些数据库 (SQLite) 不支持不区分大小写的 unicode 字符串查找。

编辑：我唯一的解决方法是在 save() 或一些保存信号上使所有域字段小写。

# eclipse - 在 linux 上为 eclipse 3.5.2 安装 clearcase

> ID：10935925
> 
> 赞同：1
> 
> 时间：2012-06-07T16:27:48.107
> 
> 标签：eclipse, clearcase

我想在 linux 上安装 eclipse 3.5.2 的插件清晰案例，但我找不到插件包的 http url 以将其添加到“安装新软件”中我从 IBM 以 zip 格式下载包，但我不能安装成功。

你能提供我这个包裹的网址吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:52:21.117

该插件的唯一信息是：

*   [IBM Rational ClearCase 插件](http://www.ibm.com/developerworks/rational/downloads/07/cc_eclipse3_2/clearcase_plugins.html)
*   [Rational ClearCase SCM 适配器（用于 Eclipse），版本 7.0.0.2](http://www-304.ibm.com/support/docview.wss?uid=swg24024213)
*   **[Rational ClearCase SCM 适配器（用于 Eclipse），版本 7.6.0.0](http://www-304.ibm.com/support/docview.wss?uid=swg24025674)**

最后一个链接是给你的，包含要下载的 zip。
有关安装该 zip 的信息，请参阅“ [clear case plugin eclipse 的问题](https://stackoverflow.com/questions/2462979/problems-with-clear-case-plugin-eclipse/2463223#2463223)”。

您也可以尝试**更新站点**：

```
http://www3.software.ibm.com/ibmdl/pub/software/rationalsdp/clearcase/60/update/windows/ 
```

* * *

[OP Mohamed KALLEL](https://stackoverflow.com/users/1003575/mohamed-kallel)补充道：

> 我安装了它，但是当运行连接到 Rational ClearCase 时，我得到一个带有消息的弹出窗口：

```
You do not have a license to run ClearCase 
```

首先，检查是否没有明显的许可证问题，如[本技术说明](http://www-304.ibm.com/support/docview.wss?uid=swg21135880)中所述，使用[`clearlicense`](https://publib.boulder.ibm.com/infocenter/cchelp/v7r1m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/clearlicense.htm)（或者是否没有任何[ACL 权限](http://www-304.ibm.com/support/docview.wss?uid=swg21338365)或[许可证服务器 IP 地址](http://www-304.ibm.com/support/docview.wss?uid=swg21321483)问题）。

还要检查您的 ClearCase 的确切版本。如果这是 ClearCase LT，它可能不受 Eclipse 插件的支持。如果这是 CCRC（ClearCase Remote Control），那么这不是正确的插件。

# c# - 从 SQL Server 提取 XML 数据以解析为 C# 中的 JSON 格式问题

> ID：10935926
> 
> 赞同：2
> 
> 时间：2012-06-07T16:27:49.290
> 
> 标签：c#, sql, xml, json

我在 C# 中使用 SQLCommand 对将输出 XML 的本地计算机运行 SQL。SQL 代码如下所示：

```
"SELECT 
   ' '                          AS 'ItemsCount', 
   ' '                          AS 'Shipping', 
   ' '                          AS 'Fee', 
   ' '                          AS 'ShippingPrc', 
   ' '                          AS 'FeeType', 
   ' '                          AS 'FeeTaxPrc', 
 //many lines of SQL omitted
 FROM   im_item 
   JOIN ps_doc_lin 
     ON im_item.item_no = ps_doc_lin.item_no 
   JOIN  ps_doc_hdr 
     ON ps_doc_hdr.doc_id = ps_doc_lin.doc_id 
   JOIN ar_cust 
   ON ar_cust.cust_no = ps_doc_hdr.cust_no 
 WHERE  ps_doc_hdr.tkt_dt = (SELECT Max(tkt_dt) //I select Max(tkt_dt) here because this program will run right after a customer has completed checkout.  I want to get the most recent ticket (i.e. the ticket just rang up)
                        FROM   ps_doc_hdr) 
 FOR xml path ('Receipt')"; 
```

这一直有效，但我最近发现了一个致命缺陷。如果在数据库中客户购买了多件商品，则 SQL Server 的 XML 输出将是一个 XML 文件，其中包含针对所购买的每件商品重复的该客户的信息。如果我在 C# 中解析 XML 输出，则无法完成，输出会产生多个根元素。我怀疑各种表的 JOIN 导致了这种情况，但我不得不从 SQL 中提取各种数据，我需要这些连接来获得我需要的东西。

我试图做类似的事情：

```
 ' '                          AS 'Total', 
   ' '                          AS 'InvcHdrRcptStatus', 
   ' '                          AS 'InvcHdrRcptType', 
   ' '                          AS 'Cashier', 
   ' '                          AS 'DocDate', 
   ' '                          AS 'InvcNum', 
   (SELECT      ps_doc_lin.sls_rep           AS 'Clerk'
                    FROM PS_DOC_LIN
                    WHERE PS_DOC_LIN.DOC_ID = PS_DOC_HDR.DOC_ID
                    FOR XML PATH ('Item')) as Items, 
   (SELECT     ar_cust.cust_no              AS 'BillToCustNumber', 
   ' '                          AS 'BillToCustCompany', 
   ar_cust.fst_nam              AS 'BillToFName', 
   ar_cust.lst_nam              AS 'BillToLName', 
   ar_cust.salutation           AS 'Customer/Name/Title', 
   ar_cust.adrs_1               AS 'BillToAddr1', 
   ar_cust.adrs_2               AS 'BillToAddr2', 
   ' '                          AS 'BillToAddr3', 
   ar_cust.zip_cod              AS 'BillToZip', 
   ' '                          AS 'BillToInfo1', 
   ' '                          AS 'BillToInfo2', 
   ' '                          AS 'BillToPhone1', 
   ' '                          AS 'BillToPhone2', 
   ar_cust.phone_1              AS 'ShipToPhone1', 
   ar_cust.phone_2              AS 'ShipToPhone2' FROM AR_CUST WHERE AR_CUST.CUST_NO = PS_DOC_HDR.CUST_NO FOR XML PATH ('Customer'), TYPE) as Customers, 
```

我将 JOIN 嵌套到另一个选择中。虽然这确实有效，但在转换为 JSON 时格式不正确。输出如下所示：

```
{"Receipt":{ ......//omitted data
 ,"Customer":{"Name: {"title":"Mr."}} 
```

我的预期输出将在 {"Receipt": 内组织所有数据，而不使用另一个 {。与此类似：

```
 "Receipt" : {
    "InvcHdrNotes" : ""
    "Tax" : ""
    "TaxPrc" : ""
    "DiscPrc" : ""
    "Discount" : ""
    "InvcComment1" : ""
    "InvcComment2" : ""
} 
```

“收据”是一个更大的 JSON 文件的一个小节。但是，对于我需要获取的其余数据，这个缺陷将被复制（我假设是这样），因为我也需要 JOIN 来获取这些数据。我试过同时使用 Jayrock 和 Newtonsoft.Json，但都有这个问题。

我的目标 XML 输出将是：

```
<Receipt>
<InvcHdrNotes> </InvcHdrNotes>
<Tax>Y</Tax>
<Clerk>MGR</Clerk>
<BillToCustNumber>1000</BillToCustNumber>
<BillToCustCompany> </BillToCustCompany>
<BillToFName>Bill</BillToFName>
<BillToLName>Baker</BillToLName>
<Customer>
  <Name>
    <Title>Mr.</Title>
  </Name>
</Customer>
<BillToAddr1>1426 Millstream Parkway</BillToAddr1>
<BillToAddr3> </BillToAddr3>
<BillToZip>38120</BillToZip>
<BillToInfo1> </BillToInfo1>
<BillToInfo2> </BillToInfo2>
<ShipToCustNumber>1000</ShipToCustNumber>
<ShipToCustCompany> </ShipToCustCompany>
<ShipToFName>Bill</ShipToFName>
<ShipToLName>Baker</ShipToLName>
<ShipToTitle>Mr.</ShipToTitle>
<ShipToAddr1>1426 Millstream Parkway</ShipToAddr1>
<ShipToZip>38120</ShipToZip>
</Receipt> 
```

我使用上面的 SQL 代码得到这个输出，但是在引发我提到的异常之后重复相同的信息。

这是可能的还是这是一个致命的设计缺陷？如果不可能，我不确定如何完成这项任务。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:56:59.060

看起来您正在序列化返回到相同 XML 的每一行 - 所以您最终会得到多个根元素。您需要序列化 ​​List 本身。

所以你最终会得到：

```
<Receipts>
  <Receipt>
    ...
  </Receipt>
  <Receipt>
    ...
  </Receipt>
</Receipts> 
```

# rest - Tomcat 不会取消部署 ROOT.war

> ID：10935927
> 
> 赞同：0
> 
> 时间：2012-06-07T16:27:53.263
> 
> 标签：rest, tomcat, undeploy

*我使用 Tomcat 管理器 ( /manager/text* )的 REST API 部署了我的应用程序。战争是ROOT.war。当我尝试使用*/manager/text/undeploy?path=/ 取消*部署它时，Tomcat 无法通过响应取消部署：

```
FAIL - Unable to delete [C:\Program Files\apache-tomcat-7.0.27\webapps\ROOT]. The continued presence of this file may cause problems. 
```

但是如果我尝试使用 Tomcat 管理器 GUI，它可以取消部署战争
有人知道我该如何解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:00:39.427

您是否尝试过手动删除 ROOT 部署目录？

战争只是分解到 webapps 文件夹下的目录。

# objective-c - 具有分组样式的矩形角的 UITableViewCell

> ID：10935930
> 
> 赞同：0
> 
> 时间：2012-06-07T16:28:04.210
> 
> 标签：objective-c, ios, uitableview

我想要我的单元格上的矩形角。我实施了

```
 cell.backgroundView = [[UIView alloc] initWithFrame:cell.bounds]; 
```

[正如此评论](https://stackoverflow.com/questions/7695129/square-instead-of-rounded-corners-in-uitableviewcell-grouped-style)中所建议的那样，但是当我点击单元格时，突出显示仍然是圆角......我怎样才能摆脱那些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:38:53.487

```
cell.selectedBackgroundView = [[UIView alloc] initWithFrame:cell.bounds]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:56:01.293

...并模仿亮点，你有

```
 #import <QuartzCore/QuartzCore.h>

    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = cell.bounds;
    gradient.colors = [NSArray arrayWithObjects:[[UIColor colorWithRed:0\. green:0.545 blue:0.941 alpha:1] CGColor], [[UIColor colorWithRed:0.027 green:0.353 blue:0.878 alpha:1] CGColor], nil];
    [cell.selectedBackgroundView.layer insertSublayer:gradient atIndex:0]; 
```

它并不完美 - 仍在检查为什么它在纵向上绘制单元格的右边界并且在我旋转设备时不横向缩放...

欢迎提出建议。

# java - 如何在 Android 2.1 中实现均衡器？

> ID：10935938
> 
> 赞同：0
> 
> 时间：2012-06-07T16:28:35.220
> 
> 标签：java, android, audio, equalizer

我知道早先有人问过这个问题，但我找不到急需的信息。

我在 2.3 中实现了均衡器。但我想在 2.1 中实现它

我遇到了两种方法：

1.  将 java 库代码从 2.3 导入到 2.1。但我对此不抱太大希望。
2.  或者，使用 JNI 和 Android NDK 并使用一些开箱即用的 C/C++ 库。（请建议是否有可用的库）

如果任何其他解决方案是可行的，那么请提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T00:38:15.850

如[如何在 Android2.1 中实现均衡器中所述？](https://stackoverflow.com/questions/6261248/how-to-implement-equalizer-in-android2-1?rq=1)您将需要使用 JNI 在本机代码中实现自己的信号处理

# scala - 你能在 scala 中编写自己的存在方法吗？

> ID：10935948
> 
> 赞同：1
> 
> 时间：2012-06-07T16:29:17.497
> 
> 标签：scala

只需阅读有关 Scala 的内容，以及作用于集合的 exists 方法如何减少代码重复等。

你怎么能编写一个类似于 exists 的函数来自己作用于集合呢？是否可以？

有点像作用于特定类型的 ac# 扩展方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T16:41:45.530

当然，您可以使用[隐式转换](http://www.artima.com/weblogs/viewpost.jsp?thread=179766)来做到这一点。

```
scala> implicit def foo[A](xs: Seq[A]) = new {
     |   def any(f: A => Boolean): Boolean = {
     |     for(x <- xs; if f(x)) return true
     |     false
     |   }
     | }
foo: [A](xs: Seq[A])java.lang.Object{def any(f: A => Boolean): Boolean}

scala> Seq(9, 11, 34).any(_ > 10)
res3: Boolean = true

scala> Seq(9, 11, 34).any(_ > 35)
res4: Boolean = false 
```

# php - 在随机位置将变量插入字符串

> ID：10935949
> 
> 赞同：0
> 
> 时间：2012-06-07T16:29:26.493
> 
> 标签：php

请参阅此代码：

```
<?php

$a = rand(1, 10000000000);
$b = "abcdefghi";

?> 
```

如何插入`$b`的随机位置`$a`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:38:54.103

假设“休闲”意味着随机：

```
<?php
$a = rand(1, 10000000000);
$b = "abcdefghi";

//get a random position in a
$randPos = rand(0,strlen($a));
//insert $b in $a
$c = substr($a, 0, $randPos).$b.substr($a, $randPos);

var_dump($c);
?> 
```

以上代码工作：[http ://codepad.org/VCNBAYt1](http://codepad.org/VCNBAYt1)

编辑：有向后的变量。我读到“将a插入b，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:41:36.293

我想你可以通过将 $a 视为字符串并将其与 $b 连接：

```
$a = rand(1, 1000000);
$b= "abcd";
$pos = rand(0, strlen($a));
$a =  substr($a, 0, $pos).$b.substr($a, $pos, strlen($a)-$pos); 
```

结果：

```
a=525019
pos=4
a=5250abcd19

a=128715
pos=5
a=12871abcd5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:33:32.917

您应该将 {$b} 放在 {$a} 的顶部，以便您可以将其插入 {$b} .. 例如：

```
<?php
   $b = "abcdefghi";
   $a = rand(1, 10000000000);
   $a .= $b;
   echo $a;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:37:43.913

像这样：

```
<?php
$position = GetRandomPosition();  // you will have to implement this function
if($position >= strlen($a) - 1) {
    $a .= $b; 
} else {
    $str = str_split($a, $position);
    $a = $str[0] . $b . implode(array_diff($str, array($str[0])));
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T16:42:20.543

将 $a 转换为字符串，然后使用[strlen](http://php.net/manual/en/function.strlen.php)获取 $a 的长度。使用rand，以$a的长度为最大值，得到$a内的随机位置。然后使用[substr_replace](http://php.net/manual/en/function.substr-replace.php)在您刚刚随机化的位置将 $b 插入 $a 中。

# jquery - JQuery .on() - 克隆动态内容

> ID：10935954
> 
> 赞同：2
> 
> 时间：2012-06-07T16:29:48.263
> 
> 标签：jquery, ajax, clone, bind

我正在开发一个用户能够执行一些实时搜索功能的项目。当通过 JQuery Ajax 显示实时搜索的结果时，我需要用户能够单击其中一个显示的结果并在页面的其他位置创建该结果的克隆。我发现的问题是，由于这些新的实时搜索结果没有在第一页加载时处理，我认为它们是 DOM 不存在的“幻像代码”。我对 JQuery 的 on() 和 bind() 函数进行了一些研究，但不确定如何将它们实现到我自己的上下文中。

这是我的 jQuery

```
$(".add").click(function() {
        $(this).parent("li").clone(true).appendTo(".doc_list:first");                       

}); 
```

在那个片段中（this）是指我的按钮，它存在于通过实时搜索结果动态创建的 LI 元素（父元素）内。我需要复制那个 LI 元素。

如果需要更多代码，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:30:55.107

当您的`.add`按钮在页面加载后添加到 DOM 时，即。动态的，所以你需要一个委托事件处理程序（又名实时）。

```
$(".doc_list").on('click', '.add', function() {
    $(this).parent("li").clone(true).appendTo(".doc_list:first");
}); 
```

在这里，我将用户`.doc_list`用作容器，但如果`.doc_list`也是动态元素，则在页面加载时将其替换为属于 DOM 的其他静态元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:32:58.840

```
$("Static-container").on('click', '.add', function() {
        $(this).parent("li").clone(true).appendTo(".doc_list:first");                       
}); 
```

Where`Static-container`是包含所有动态添加`.add`元素的最近元素的选择器。

# php - 对多变量查询 mysql 数据库的结果进行分页

> ID：10935956
> 
> 赞同：0
> 
> 时间：2012-06-07T16:29:57.037
> 
> 标签：php, mysql, pagination

我有一个 mysql 数据库并使用多变量搜索页面 find.php 来输入变量。结果正确显示（计数正确，结果的第 1 页也是正确的）但是当我尝试转到下一页时出现错误 :: Undefined index: term1 line 60 ::Undefined index: term2 line 61 等等上。Search2.php 设置如下：

```
<?php

include "db.inc.php";

if (isset($_GET["page"])) { $page  = $_GET["page"]; } else { $page=1; }; 
$start_from = ($page-1) * 15;

$term1 = $_POST['term1'];
$term2 = $_POST['term2'];
$term3 = $_POST['term3'];
$term4 = $_POST['term4'];

$sql ="SELECT * FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%' LIMIT $start_from, 15";

$rs_result = mysql_query ($sql);
$num_rows = mysql_num_rows($rs_result);
$query = mysql_query("SELECT * FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%'"); 
$number=mysql_num_rows($query); 
print "<font size=\"5\" color=white><b>CD Requests</b></font> </P>";
?> 
```

分页结构

```
<?php 

$sql = "SELECT COUNT(id) FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%'";  
$rs_result = mysql_query($sql); 
$row = mysql_fetch_row($rs_result); 
$total_records = $row[0];
$total_pages = ceil($total_records / 15);

/******  build the pagination links ******/
// range of num links to show
$range = 3;

// if not on page 1, don't show back links
if ($page > 1) {
   // show << link to go back to page 1
   echo " <a href='search2.php?page=1'><b>First</b></a> ";
   // get previous page num
   $prev = $page - 1;
   // show < link to go back to 1 page
   echo " <a href='search2.php?page=$prev'><b>&laquo;</b></a> ";
} // end if 

// loop to show links to range of pages around current page
for ($x = ($page - $range); $x < (($page + $range) + 1); $x++) {
   // if it's a valid page number...
   if (($x > 0) && ($x <= $total_pages)) {
      // if we're on current page...
      if ($x == $page) {
         // 'highlight' it but don't make a link
         echo " <font  size='5' color=yellow><b> $x </b></font> ";
      // if not current page...
      } else {
         // make it a link
         echo " <a href='search2.php?page=$x'>$x</a> ";
      } // end else
   } // end if 
} // end for

// if not on last page, show forward and last page links        
if ($page != $total_pages) {
   // get next page
   $next = $page + 1;
    // echo forward link for next page 
   echo " <a href='search2.php?page=$next'><b>&raquo;</b></a> ";
   // echo forward link for lastpage
   echo " <a href='search2.php?page=$total_pages'><b>Last</b></a> ";
} // end if
/****** end build pagination links ******/

echo '</table>';

?> 
```

不知何故，转到第 2 页无法传递变量术语 1、术语 2 等的正确信息。任何想法/帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:39:53.540

Your page links do not pass `term1`, `term2`, etc. back to the server. Also if you are going to pass them in the link then you need to check `$_REQUEST['term1']`, `$_REQUEST['term2']`, etc. to cover both GET and POST requests.

The code of the links should be like this:

```
echo " <a href='search2.php?page=$next".
    "&amp;term1=".urlencode($term1).
    "&amp;term2=".urlencode($term2).
    "&amp;term3=".urlencode($term3).
    "&amp;term4=".urlencode($term4)"'><b>&raquo;</b></a> "; 
```

If you have too many parameters to pass to the server then you should probably consider sending POST requests when clicking on the links using JavaScript.

# c# - MVC4中根据HTTP_HOST加载路由

> ID：10935960
> 
> 赞同：0
> 
> 时间：2012-06-07T16:30:12.027
> 
> 标签：c#, iis-7, asp.net-mvc-routing

我有一个多租户 MVC4 网站，我想在其中根据传入主机和域名设置*RouteTable ，例如**www.domain1.com*、*www.domain2.com*和*www.domain3.co.uk*可能有一个或多个附加根据主机和域 anem 附加到路由表的值。

DNS 服务器已经设置了许多带有主机的不同区域，我使用 IIS7 作为“自定义 Web 服务器”而不是使用 Visual Studio 2012 开发服务器，以便我在*请求*变量。

我对 IIS7 的问题是，如果您尝试在完成所有其他路由映射的*RegisterRoutes*方法中调用 HttpContext.Current.Request.ServerVariables["HTTP_HOST"] 的值，则该值不可用。

我需要做的主要事情是在请求管道中的某个点确定最终将在 HTTP_HOST 服务器变量中结束的值。该值需要存储并在使用之前适当更新路由表。

它是否需要 Http 模块、Http 处理程序、动作过滤器或类似的东西？或者在 MVC 管道中是否有其他地方可以做到这一点。

克里斯平

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T14:27:15.137

我知道，没有对基于主机的路由的内置支持，但是您可以创建一个 Route 子类来提取主机值。这是一个示例：

[http://blog.maartenballiauw.be/post/2009/05/20/aspnet-mvc-domain-routing.aspx](http://blog.maartenballiauw.be/post/2009/05/20/aspnet-mvc-domain-routing.aspx)

这是为 MVC3 编写的，但在 MVC4 中应该可以正常工作。

# google-docs-api - 教育应用领域中的 Google Drive for Coursework

> ID：10935963
> 
> 赞同：0
> 
> 时间：2012-06-07T16:30:22.360
> 
> 标签：google-docs-api, google-drive-api

我们正在调查 Google 云端硬盘在教育应用领域的使用情况。

我们正在考虑的场景如下（我们想知道现有的 Docs API 是否可以实现所有这些，或者是否可能很快实现）：

1.  为每个学生/我们/创建一个`coursework`文件夹。
2.  在`coursework`文件夹中，我们为每个学习的单元创建文件夹，例如。`web101`, `web201`- 然后学生在特定文件夹（以及其中的子文件夹）中为特定单元工作。
3.  单元导师和讲师拥有对选定文件夹的阅读权限，从而实现持续的形成性反馈（以及可能的自动反馈和监控）。
4.  学生无法控制`coursework`文件夹或单元文件夹的结构，只能控制其中的工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T21:50:32.640

Google Drive 提供用户管理的存储空间，因此如果您在学生的帐户中创建这些文件夹，他们将可以控制它们。

一种可能的解决方案是在“教师”或“管理员”帐户中创建所有文件夹，然后仅与相应的学生共享每个文件夹。

目前所有这些都可以通过 Documents List API 实现：

[https://developers.google.com/google-apps/documents-list/](https://developers.google.com/google-apps/documents-list/)

# css - Nested css counters with leading zeros

> ID：10935965
> 
> 赞同：16
> 
> 时间：2012-06-07T16:30:27.963
> 
> 标签：css, css-content

Is it possible to combine the css `counters()` function with leading zeros, producing a list such as this:

```
Item 01
  Item 01.01
  Item 01.02
    Item 01.02.01 
```

Leading zeros are possible using `content: counter(name, decimal-leading-zero)`, and combining nested counters is possible using `content: counters(name, ".")`.

I know of workarounds if the level of nesting is known (i.e. I know the list will only ever nest 3 levels deep), but does anyone know if it's possible to combine these for lists of an unknown level of nesting?

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-07T17:02:27.693

Yes, you can combine these — just supply the counter style as the last argument to `counters()`:

```
content: counters(name, ".", decimal-leading-zero) 
```

# c# - 将随机数量的点插入到具有最少不同位置的字符串中？

> ID：10935970
> 
> 赞同：1
> 
> 时间：2012-06-07T16:30:38.850
> 
> 标签：c#, winforms, linq, .net-4.0

我想在字符串的随机部分插入随机数量的点（从 1 到 7）而不破坏布局。

这是我当前的代码：

```
Random rand = new Random();
string[] words = iTemplate.Text.Split(' ');
string result = string.Empty;
for (int i = 0; i < words.Count(); i++)
{
    string word = words[i];
    if (rand.Next(i, words.Count()) == i)
    {
        for (int dots = rand.Next(1, 7); dots > 0; dots--)
            word += ".";
    }
    result += word + " ";
} 
```

有没有更有效或更好的 LINQ 选项？

现在，由于它是随机的，可能会出现没有点出现的情况。我通过使用`if (rand.Next(i, words.Count()) == i)`which 似乎可以工作来缩小范围，但仍然有一些结果只显示 1 到 3 个插入点的地方。

我如何保证在此过程中点至少插入 4 个不同的位置？

根据评论请求的示例数据/结果：

```
string template = "Hi, this is a template with several words on it and I want to place random dots on 4 different random places every time I run the function"; 
```

结果1：

```
string result = "Hi, this... is a template with several.. words on it and. I want to place random dots on 4 different random...... places every time I run the function"; 
```

结果 2：

```
string result = "Hi, this is a template. with several... words on it and I want to..... place random dots on 4 different random. places every time I run the function"; 
```

结果 3：

```
string result = "Hi, this. is a template with... several words on it and I want to place random.. dots on 4 different random....... places every time I run the.. function"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:33:42.127

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

class Program
{
    static void Main(string[] args)
    {
        Random rand = new Random();
        string[] words = "Now is the time for all good men to come to the aid of their countrymen".Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);
        if (words.Length > 0)
        {
            // Generate a list of integers from 0 to words.Length - 1
            List<int> addIndices = Enumerable.Range(0, words.Length).ToList();
            // Shuffle those indices
            Shuffle(addIndices, rand);
            // Pick the number of words that will have dots added
            int addCount = rand.Next(4, Math.Max(4, words.Length));
            // Truncate the array so that it only contains the first addCount items
            addIndices.RemoveRange(addCount, addIndices.Count - addCount);

            StringBuilder result = new StringBuilder();
            for (int i = 0; i < words.Length; i++)
            {
                result.Append(words[i]);
                if (addIndices.Contains(i)) // If the random indices list contains this index, add dots
                    result.Append('.', rand.Next(1, 7));
                result.Append(' ');
            }

            Console.WriteLine(result.ToString());
        }
    }

    private static void Shuffle<T>(IList<T> array, Random rand)
    {
        // Kneuth-shuffle
        for (int i = array.Count - 1; i > 0; i--)
        {
            // Pick random element to swap.
            int j = rand.Next(i + 1); // 0 <= j <= i
            // Swap.
            T tmp = array[j];
            array[j] = array[i];
            array[i] = tmp;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:39:44.453

好吧，如果你需要至少 4 个不同的地方，你至少需要 4 个点。你分两部分做——首先选择末尾有一个点的4个单词（即随机选择一个单词，在其上添加一个点，并确保不再选择它），然后选择3随机的单词，重复，并添加点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:45:15.503

只是为了好玩和尽可能简洁：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            var random = new Random();

            var iTemplate = "Hi, this is a template with several words on it and I want to place random dots on 4 different random places every time I run the function";    
            var result = iTemplate;

            while (new Regex("\\. ").Matches(result).Count < 4)
                result = result.TrimEnd()
                    .Split(' ')
                    .Aggregate(
                        string.Empty,
                        (current, word) =>
                            current + (word + (((word.EndsWith(".") || (random.Next(1, 100) % 10) != 0)) ? "" : new string('.', random.Next(1, 7))) + " ")
                        );

            Console.WriteLine(result);
            Console.Read();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:52:59.157

这将确保您在至少 4 个单词中添加点，并且不会在最终字符串中添加尾随空格。

```
Random rand = new Random();
string[] words = iTemplate.Text.Split(' ');
// Insert dots onto at least 4 words
int numInserts = rand.Next(4, words.Count());
// Used later to store which indexes have already been used
Dictionary<int, bool> usedIndexes = new Dictionary<int, bool>();
for (int i = 0; i < numInserts; i++)
{
    int idx = rand.Next(1, words.Count());
    // Don't process the same word twice
    while (usedIndexes.ContainsKey(idx))
    {
        idx = rand.Next(1, words.Count());
    }
     // Mark this index as used
    usedIndexes.Add(idx, true);
    // Append the dots
    words[idx] = words[idx] + new String('.', rand.Next(1, 7));
}
// String.Join will put the separator between each word,
// without the trailing " "
string result = String.Join(" ", words);
Console.WriteLine(result); 
```

此代码假定您实际上在 iTemplate.Text 中至少有 4 个单词。如果您有可能不会，您应该添加一些额外的验证逻辑。

# ruby-on-rails - 测试交互式雷神任务

> ID：10935974
> 
> 赞同：2
> 
> 时间：2012-06-07T16:30:58.317
> 
> 标签：ruby-on-rails, ruby, cucumber, thor

我有以下雷神命令：

```
require 'highline'
class Import < Thor

  desc "files", "Import files into the database"
  method_option "path", :required => true, :desc => "Path to folder containing new  files", :aliases => "-p", :type => :string

  def files
    require './config/environment'

    line = HighLine.new
    line.say(line.color("Identified files as Version 15 (English)", :green))
    if line.agree(line.color("Are you sure you want to import?", :yellow))
      line.say(line.color("Finished.  Imported 70,114 items", :green))
    else
      line.say(line.color("Aborting...", :red))
    end
  end

end 
```

现在，显然，目前这只是在屏幕上输出一些语言。但是，我需要做的是为测试输出的命令编写一个测试，正如我所期望的那样，当我开始从事繁重的工作时，我可以将这些东西存根。

我看过[Aruba](https://github.com/cucumber/aruba)，但出于某种原因，这似乎不喜欢交互性，目前尚不清楚原因。

因此，是否有人对如何测试（使用 RSpec）有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:23:12.723

Aruba 是一套非常完整的用于测试命令行应用程序的步骤。如果它对您不起作用，可能是因为 aruba 将所有文件操作默认为`tmp/aruba`.

但是 neimOo 关于如何用 aruba 编写场景是正确的

```
When I run `thor import` interactively
And I type "yes" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T13:55:46.023

这是使用 Aruba 执行此操作的方法

```
Scenario: Test import
  When I run `thor import` interactively
  And I type "yes"
  Then the stdout should contain "Finished.  Imported 70,114 items" 
```

在这里您可以找到很多 aruba 示例 [https://github.com/cucumber/aruba/blob/master/features/interactive.feature](https://github.com/cucumber/aruba/blob/master/features/interactive.feature)

这是实现本身 [https://github.com/cucumber/aruba/blob/master/lib/aruba/cucumber.rb](https://github.com/cucumber/aruba/blob/master/lib/aruba/cucumber.rb)

# vb.net - 使用 Visual Studio 2010 绘制图表并导出到 Excel

> ID：10935978
> 
> 赞同：0
> 
> 时间：2012-06-07T16:31:09.140
> 
> 标签：vb.net, visual-studio-2010, excel, .net-4.0, charts

我正在使用 .Net 4.0、Visual Studio 2010 和 Visual Basic .Net 做一个项目。

我需要添加一个图表（.Net 4.0 中默认包含的新图表），它表示温度随时间变化，所以我每秒在计时器的经过事件中添加绘图点。

图表做得还不错，但我需要另一个功能，即每次我停止计时器时，将图表保存在 excel（.XLS 或 .XLSX）文件中。默认情况下，图表提供了“System.Windows.Forms.DataVisualization.Charting.DataPointCollection”类型的集合，我想知道是否有办法创建 xml 并将这些集合的信息放入 excel文件。

我环顾四周，但没有找到任何类似的例子，我考虑的最后一件事是使用迭代方式手动写入 excel 文件，但可能它太耗时，因为迭代将是几千秒。

任何想法或有类似问题的任何人都可以提供帮助？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:17:36.840

如果您尝试将图表生成到 Excel 文档中，请让我指出[Officewriter](http://www.officewriter.com/officewriter-api.aspx%20OfficeWriter)。它有一个完整的图表 API。底层的 Excel Charting xml 相当复杂，尤其是对于较新的 OOXML 版本。较旧的 .xls BIFF 非常可怕。您可以做的是找出您要生成的图表，然后使用 ExcelWriter 图表 API 来构建准确的图表并将其保存到文件中。应该是比较无痛的。[您可以从这里](http://www.officewriter.com/officewriter-free-evaluation.aspx%20here)免费获取评估，看看它是否适合您。作为免责声明，我是为最新版本构建图表 API 的工程师之一。

# perl - 将redis（redis2 nginx模块）的响应保存到nginx变量

> ID：10935980
> 
> 赞同：1
> 
> 时间：2012-06-07T16:31:15.910
> 
> 标签：perl, nginx, redis

我想创建一个小型网络应用程序只是为了好玩。应用程序将仅使用 nginx（及其模块）、几个带有 ssi 和 redis 的 html 页面。使用嵌入式 perl 模块、[redis2 模块](http://wiki.nginx.org/HttpRedis2Module)和其他一些模块构建 Nginx。

**问题：** 如何将redis的响应保存到nginx变量（redis2模块响应原始TCP）？

（我知道[lua 模块](http://wiki.nginx.org/HttpLuaModule)，但我不想使用 is）。可以缓存以缓存来自 redis2 模块的原始 TCP 响应吗？也许我应该使用 perl 呢？

# c++ - 指针向量。BOOST 序列化

> ID：10935982
> 
> 赞同：3
> 
> 时间：2012-06-07T16:31:22.677
> 
> 标签：c++, boost, boost-serialization

我想使用 BOOST 序列化/反序列化以下向量中对象的值（不是指针）：

```
std :: vector <A*> m_vector; 
```

要序列化，我使用以下代码：

```
int nItems = m_vector.size();
ar & nItems;
std::for_each(m_vector.begin(), m_vector.end(), [&ar](A* pItem) {
    ar & *pItem;
}); 
```

并反序列化：

```
int nItems;
ar & nItems;
for (int i = 0; i < nItems; ++i) {
    A* pItem;
    ar & *pItem;  ///////////// Run-Time Check Failure #3
    m_vector.push_back(pItem);
} 
```

但是当我运行程序时，出现以下错误：

```
Run-Time Check Failure # 3 - The variable 'pItem' is Being Used without Being initialized. 
```

我究竟做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:34:12.443

您需要为指向的对象分配内存`pItem`：

```
A* pItem = new A;
ar & *pItem;
m_vector.push_back(pItem); 
```

错误是因为虽然你有一个指针，但指针指向的内存位置没有对象——指针的值是垃圾（未初始化的指针）。

`delete`当您不再需要向量中的指针指向的对象时，不要忘记调用以防止内存泄漏。更好的是，使用智能指针（例如`boost::shared_ptr<>`）来确保内存在不再可访问时被释放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-21T14:45:12.037

2年后，但值得一提。

有一个更好的解决方案来序列化**指向对象**或任何其他 STL 容器（列表、集合等）的指针向量。为了序列化一个向量，添加：

```
#include <boost/serialization/vector.hpp> 
```

然后你需要实现 serialize() 方法并将你的类与archieve 成为朋友。这个例子中解释了一切（仔细阅读所有评论，它们非常重要）：

```
#include <fstream>
#include <iostream>
#include <vector>
#include <iostream>

#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>
#include <boost/serialization/vector.hpp>

class Abc{
    // In order to make Abc serializable
    // you need to friend this lass with serialization::access
    friend class boost::serialization::access;

    // and then add this method
    template<class Archive>
    void serialize(Archive & ar, const unsigned int version)
    {
        // choose what class fields do you want to serialize
        ar & a;
        ar & b;
        ar & c;
    }
public:
    int a;
    int b;
    int c;

    // don't forget about default constructor! It's necessary for serialization!
    Abc(){};
    Abc(int a, int b, int c): a(a), b(b), c(c){};
};

class GpsPosition
{
private:
    // as mentioned above...
    friend class boost::serialization::access;
    template<class Archive>
    void serialize(Archive & ar, const unsigned int version)
    {
        ar & degrees;
        ar & minutes;
        ar & seconds;
        ar & wektorIntow;
    }
    int degrees;
    int minutes;
    float seconds;
public:
    std::vector<Abc*> abcVector;
    GpsPosition(){};
    GpsPosition(int d, int m, float s): degrees(d), minutes(m), seconds(s)
    {
        // adding some objects to abcVector
        abcVector.push_back(new Abc(1, 2, 3));
        abcVector.push_back(new Abc(3, 2, 3));
        abcVector.push_back(new Abc(2, 2, 3));
        abcVector.push_back(new Abc(1, 2, 3));
    }
    int getDegrees(){ return this->degrees; }
    int getMinutes(){ return this->minutes; }
    float getSeconds(){ return this->seconds; }
};

int main(){

    // And now how to use it

    // Saving to file:
    std::ofstream fileHandler("filename");
    const GpsPosition position1(35, 59, 24.567f);
    {
        boost::archive::text_oarchive boostOutputArchieve(fileHandler);
        boostOutputArchieve << position1;
    }

    // Reading from file:
    GpsPosition newPosition;
    {
        std::ifstream fileHandler;
        try{
            fileHandler.open("filenacme");
            boost::archive::text_iarchive boostInputArchieve(fileHandler);
            // read class state from archive
            boostInputArchieve >> newPosition;
            // archive and stream closed when destructors are called
            fileHandler.close();
            }
        catch (std::ifstream::failure e) {
            std::cerr << "Exception opening/reading/closing file";
        }
        catch(boost::archive::archive_exception e){
            std::cerr << "Exception opening/reading/closing file";
        }
    }

    // print to the console
    std::cout << newPosition.getMinutes() << std::endl; 
    std::cout << newPosition.abcVector[0]->a;
    std::cin.get();

    return 0;
} 
```

有关更多信息，请查看本教程： http: [//www.boost.org/doc/libs/1_55_0/libs/serialization/doc/index.html](http://www.boost.org/doc/libs/1_55_0/libs/serialization/doc/index.html)

# haskell - 制作 Eq 的 VectorSpace.Scalar 实例

> ID：10935985
> 
> 赞同：1
> 
> 时间：2012-06-07T16:31:39.077
> 
> 标签：haskell, type-families

注意：我可能不需要将 Scalar 添加到 Eq，尽管如果我能弄清楚如何做到这一点，它应该可以解决问题。

所以我正在尝试向[ForceLayout](http://hackage.haskell.org/packages/archive/force-layout/0.1.0.1/doc/html/Physics-ForceLayout.html)模块添加一些功能。像这样向粒子添加质量：

```
data Particle v = Particle { 
                         _pos   :: Point v
                       , _vel   :: v
                       , _force :: v
                       , _mass :: Scalar v
                       }
    deriving (Eq, Show) 
```

但[标量](http://hackage.haskell.org/packages/archive/vector-space/0.7.3/doc/html/Data-VectorSpace.html#t%3aScalar)不在 Eq 或 Show 中！所以这不会编译。不过，质量应该是与其他向量“兼容”的标量。我该如何调和呢？我对类型族的理解不足以分析这种情况。我试过了，但它们很难掌握。不确定是否需要或可能将标量添加到 Eq。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T17:34:21.360

如果你想显示质量场，显示实例必须看起来像

```
instance (Show v, Show (Point v), Show (Scalar v)) => Show (Particle v) where 
```

可以说，GHC 不能解决这个问题的事实是一个错误，或者至少是一个缺失的功能。幸运的是，通过一些扩展繁重的工作，我们可以自己给它上下文：

```
{-# LANGUAGE StandaloneDeriving, TypeFamilies,
    FlexibleContexts, UndecidableInstances #-}
{- ... -}

deriving instance (Show v, Show (Point v), Show (Scalar v)) => Show (Particle v) 
```

[这是GHC 用户指南](http://www.haskell.org/ghc/docs/latest/html/users_guide/deriving.html#stand-alone-deriving)中描述的“独立派生声明” ，其目的基本上是为了让我们可以指定 GHC 通常无法解决的上下文。

这应该可以解决问题。我有点担心 UndecidableInstances，因为它*似乎*应该可以定义的实例`Point`和`Scalar`这样的实例是循环的，但是尽管我尽了最大的努力，我还是无法使类型检查器循环，所以可能没问题。

# ajax - 如何通过ajax渲染数据表之外的组件？

> ID：10935987
> 
> 赞同：1
> 
> 时间：2012-06-07T16:31:45.873
> 
> 标签：ajax, jsf-2, datatable

我有`<h:dataTable>`一个`<h:commandLink>`在一个列中，一个`<h:outputext>`在`<h:dataTable>`我需要通过命令链接呈现的外部。

```
<h:form>
       <h:dataTable value="#{userControl.lista}" var="c">

           <h:column>
               <f:facet name="header" >
                   <h:outputText styleClass="leftColumn" value="Nombre"/>
               </f:facet>
                    #{c.nombre}
           </h:column>

           <h:column>
               <f:facet name="header" >
                   Usuario
               </f:facet>
               <h:commandLink actionListener="#{userControl.setAdmin_user(c.user)}" value="#{c.user}">
                    <f:ajax  render="output" />
               </h:commandLink>                  
           </h:column>       

       </h:dataTable>

       <h:outputText id="output" value="#{userControl.admin_user}"/>
</h:form> 
```

这没用。如果我`<h:outputText>`在同一列内移动，那么它可以工作。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:49:09.137

您当前在 中的客户端 ID`<f:ajax render>`不以默认[`NamingContainer`](http://docs.oracle.com/javaee/6/api/javax/faces/component/NamingContainer.html)分隔符开头，`:`因此与*当前* `NamingContainer`组件相关，在您的情况下为`<h:dataTable>`. 所以它只有在 outputtext 组件也在同一个数据表中时才会起作用。

您需要通过绝对客户端 ID 来引用 outputtext 组件。对于还没有记住所有`NamingContainer`组件的初学者，最简单的方法是`id`在 webbrowser 中检查生成的 HTML 元素的属性。在 webbrowser 中打开页面并执行*View Source*并找到由`<span>`生成的元素`<h:outputText id="output">`并准确获取此 ID 并为其添加前缀`:`以使其*绝对*到视图根。

例如

```
<span id="formId:output"> 
```

对于输出文本包含在 a 中的情况，其中`formId`是 any 的 ID 。如果您没有为 指定一个固定的 ID ，那么 JSF 将自动生成一个。您想指定一个固定 ID，然后喜欢.`<h:form>``<h:form>``<h:form>``<h:form id="formId">`

所以`<f:ajax render>`应该看起来像这样

```
<f:ajax render=":formId:output" /> 
```

# jquery - 在 IE7 中添加/删除类的 Jquery 脚本问题

> ID：10935990
> 
> 赞同：0
> 
> 时间：2012-06-07T16:31:55.127
> 
> 标签：jquery

我的 HTML 中有“displayNone”类，在 Jquery 中我添加和删除它，它可以与 FF 和 IE8 一起使用，但我对 IE7 有问题，你能帮帮我吗？

```
<tr id="tr<%=category %>_1_<% =message.MessageID.ToString() %>" class='<%= (firstCategory ? "" : "displayNone") %>'>
                                    <td id="td<%=category %>_1_1_<% =message.MessageID.ToString() %>" rowspan="2">
                                        <img id="imgEnv<% =message.MessageID.ToString() %>" src='../../Content/Images/envelope_<% =(newMessage ? "closed" : "open") %>.gif'
                                            alt="message" />
                                    </td>                                  
                                    <td class="text-align-right" rowspan="2">
                                        <%= Html.CheckBox("chkMsg", false, new { @value= message.MessageID, @id = string.Format("chkMsg{0}", message.MessageID), @tabindex = "-1" })%>
                                    </td>
                                </tr>

 $('a[id*=lCateg]').click(function() {
                var category = this.id.replace('lCateg', '');
                if ($('#imgCateg' + category).attr('src').indexOf('plus.gif') >= 0) {
                    $('tr[id*=' + category + '_]').removeClass('displayNone');
                    $('#imgCateg' + category).attr('src', $('#imgCateg' + category).attr('src').replace('plus.gif', 'minus.gif'));
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:34:33.917

我建议使用内置 .show .hide 函数的 jquery。这样，它将添加内联样式，并且您不会对任何浏览器有任何问题:)

```
 $('a[id*=lCateg]').click(function() {
            var category = this.id.replace('lCateg', '');
            if ($('#imgCateg' + category).attr('src').indexOf('plus.gif') >= 0) {
                $('tr[id*=' + category + '_]').show();
                $('#imgCateg' + category).attr('src', $('#imgCateg' + category).attr('src').replace('plus.gif', 'minus.gif'));
            } 
```

# java - 无法确定哪个 tomcat 过滤器通过过滤器链中的自定义 tomcat 过滤器去除注入 httpservletresponse 的数据

> ID：10935994
> 
> 赞同：0
> 
> 时间：2012-06-07T16:32:24.323
> 
> 标签：java, tomcat, servlets, servlet-filters

假设您有以下过滤器链：

过滤器 1 ====> 过滤器 2 ====> 过滤器 3 ====> 我们的自定义过滤器 ====> 过滤器 4 ====> 过滤器 5

**<====过滤器1<====过滤器2** <====我们的自定义过滤器<====过滤器3<====过滤器4 <====过滤器5

我们正在注入定制的数据结构^

问题是我们在执行“查看源代码”时在 Web 浏览器中看不到注入的数据。

所以对我们来说很明显，过滤器 1 或 2 正在删除注入的数据。实际上有更多的过滤器（可能有 30 个或更多）。我们正在尝试确定哪个过滤器是删除我们注入的数据的罪魁祸首过滤器。

有没有办法将数据写入无法修改的 HttpServletResponse，如果尝试修改，Java 中会抛出异常？这样，它会立即揭露罪魁祸首。

当您尝试确定代码何时尝试访问已释放的对象时，就像在 Objective-C 中启用僵尸一样。

更多细节（如果您有兴趣）：

我们注入到 httpservletresponse 的数据结构是一个被“脚本”标签包围的 JSON 数据结构，因为我们使用 jQuery 来解析它以获得一堆与用户界面相关的东西。

有趣的是，如果我们尝试注入像“hello stackoverflow”这样的随机字符串，我们可以在 Web 浏览器中执行“查看源代码”时看到这个字符串。所以我们的预感是，任何过滤器都在剥离我们的结构，很可能是在寻找恶意脚本并将我们的东西拉出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:40:44.507

Sure; you could write a read-only response wrapper and continue the filter chain with it.

[Trivial response wrapper example](http://www.java2s.com/Tutorial/Java/0400__Servlet/Filterthatusesaresponsewrappertoconvertalloutputtouppercase.htm) (It doesn't do what you want, it just shows how.)

I'm not convinced this is the *easiest* thing to do when you could just dump the response "in between" the existing filters without having to do any coding, just configuration.

# mysql - 选择子组中的最新行

> ID：10935996
> 
> 赞同：0
> 
> 时间：2012-06-07T16:32:38.870
> 
> 标签：mysql, sql

我有一个由连接和一些条件创建的下表：

```
product_id     date
11111          2012-06-05
11111          2012-05-01
22222          2011-05-01
22222          2011-07-02
33333          2011-01-01 
```

我正在尝试获取行，以便我有一个包含每个产品最新日期的结果集：

```
GOAL

product_id     date
11111          2012-06-05
22222          2011-07-02
33333          2011-01-01 
```

我可以按原样提取数据并进行手动排序，但我宁愿不这样做。我似乎无法找到一种方法来执行 SELECT MAX() 而不只返回一行，而且我宁愿不为每个产品 ID 运行查询。

该表由此查询生成：

```
SELECT item_id, sales_price, item, description, transaction_date 
FROM db.invoice_line AS t1 INNER JOIN db.invoices AS t2 
ON t1.invoice_id = t2.id_invoices WHERE item IS NOT NULL 
AND item_id != '800001E9-1325703142' AND item_id != '800002C3-1326830147' 
AND invoice_id IN 
    (SELECT id_invoices FROM db.invoices 
       WHERE customer_id = '[variable customer id]' 
       AND transaction_date >= DATE_SUB(NOW(), INTERVAL 360 DAY)); 
```

我使用连接来“添加”日期列。之后，我不理会无用的物品，并从一年前至今的特定客户的发票中进行选择。

感谢您的任何指导。

丹麦人

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:10:58.377

看起来`group by`适合该法案：

```
select  product_id
,       max(date)
from    YourTable
group by
        product_id 
```

# jquery - Jquery Ajax 请求在 Ubuntu 上工作但在 Debian 上不工作？

> ID：10935997
> 
> 赞同：0
> 
> 时间：2012-06-07T16:32:42.570
> 
> 标签：jquery, ajax, debian

我有一个奇怪的错误。

我在 linux ubuntu 下开发我的应用程序。

然后我在 linux debian 下导出我的项目进行生产。

我使用一个**经典** `$.ajax`的请求，它返回`url`一个`json`文件来解析它的内容。

`alert()`我在零件上创建了一个 javascript`sucess`来查看返回的内容。

在ubuntu下的developpement版本下，它可以工作，我得到：

```
 [object Object],[object Object],[object Object] 
```

**在debian**下的**生产环境**下，它不起作用，我得到了我的 jsonfile 内容：

 **```
 [
   {
      "cell_line" : "",
      "id_user" : "2",
      "public" : "0",

   },{...},{..} ,etc...] 
```

这里发生了什么？我真的不明白？

平台的变化（ubuntu到debian）如何做到这一点？？？

有一些我想念的东西..

我真的很感激这方面的一些帮助。谢谢！

**更新 ：**

我正在做类似的事情

var first_ajax_call = $.ajax({url:'path_to_data/data.json',success:function(obj){ alert(obj); }});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:01:29.373

你应该像这样开始你的php：

```
<?php
header('Content-type: application/json');
// then output the json encoded object 
```**

# ruby-on-rails - 如何按时间顺序对合并数组和散列进行排序？

> ID：10935999
> 
> 赞同：4
> 
> 时间：2012-06-07T16:32:43.880
> 
> 标签：ruby-on-rails

在 Rails 3.2 应用程序中，我有一个多态 ActivtyFeed 模型。

```
class ActivityFeed
  belongs_to :user
  belongs_to :feedable, polymorphic: true
end 
```

我需要在 ActivityFeed 索引视图中聚合一些项目。例如，我不想为每张照片呈现单独的项目，而是想按日期或事件对照片进行分组，并显示“用户上传的 x 张照片”。

我的控制器如下所示：

```
@feed_items = @user.activity_feeds.sort_by(&:created_at)
@feed_array = []
photos = @feed_items.find_all{|f|f.feedable_type.eql?("Photo")}
@feed_items.delete_if{|f|f.feedable_type.eql?("Photo")}
@feed_array << @feed_items
grouped_photos = photos.group_by{|p| p.feedable.event_id}
@feed_array << grouped_photos
@feed_array.flatten! 
```

然后在我正在使用的视图中，例如

```
if feed_array.class.eql?(Hash)
  render grouped photo partial
elsif feed_array.feedable_type.eql?("Post")
  render single post partial
etc 
```

我无法按时间顺序对项目进行排序，因为数组包含嵌套哈希。

```
[#<ActivityFeed id: 7, user_id: 2, feedable_type: "Post", feedable_id: 3>, {2=>[#<ActivityFeed id 3, user_id: 4, feedable_type: "Photo", feedable_id: 6>]}] 
```

如何对这个数组进行排序？

我试过`@feed_array.sort{|a,b| a.['created_at'] <=> b.['created_at'] }`但得到了`comparison of ActivityFeed with Hash failed`

这是最好的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T17:35:19.497

您可以合并数组和哈希，然后对其进行排序

```
merged.sort {|a,b| a.method <=> b.method } 
```

你只需要告诉 sort 如何对对象进行排序

一个建议，而不是

```
@user.activity_feeds.sort_by(&:created_at) 
```

做

```
@user.activity_feeds.order('created_at ASC') 
```

那应该更快，因为您已经从数据库中排序了活动（如果 activity_feeds 是一个关系）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T09:48:09.627

好吧，您需要对原始设计进行一些修改。

我的建议是添加`event`，并且`activity feed`您还需要保留原件`photo`。`activity feed`

因为，通过将照片保留为活动`a single photo` 源，当照片与任何`event`. 但是，如果 each`photo`属于 an`event`那么您可以删除`photo`from `activity feed`。

然后每个对象都可以`activity feed`并且可以很容易地基于 排序`created_at`。此外，您不需要手动提取照片。

希望这会有所帮助！