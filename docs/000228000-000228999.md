# StackOverflow 问答 000228000-000228999

# c++ - 替代 itoa() 将整数转换为字符串 C++？

> ID：228005
> 
> 赞同：154
> 
> 时间：2008-10-23T00:17:55.990
> 
> 标签：c++, integer, stdstring, itoa

我想知道是否有将整数转换为字符串的替代方法，`itoa()`因为当我在 Visual Studio 中运行它时会收到警告，而当我尝试在 Linux 下构建程序时，会出现编译错误。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2008-10-23T00:31:34.060

在 C++11 中，您可以使用[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)：

```
#include <string>

std::string s = std::to_string(5); 
```

如果您在 C++11 之前使用，则可以使用 C++ 流：

```
#include <sstream>

int i = 5;
std::string s;
std::stringstream out;
out << i;
s = out.str(); 
```

取自[http://notfaq.wordpress.com/2006/08/30/c-convert-int-to-string/](http://notfaq.wordpress.com/2006/08/30/c-convert-int-to-string/)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-23T00:19:56.207

[boost::lexical_cast](http://www.boost.org/doc/libs/1_36_0/libs/conversion/lexical_cast.htm)效果很好。

```
#include <boost/lexical_cast.hpp>
int main(int argc, char** argv) {
    std::string foo = boost::lexical_cast<std::string>(argc);
} 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-10-23T07:17:35.147

## 考古学

itoa 是一个非标准辅助函数，旨在补充 atoi 标准函数，并且可能隐藏了一个 sprintf（它的大部分功能可以在 sprintf 方面实现）：[http ://www.cplusplus.com/reference/clibrary/cstdlib/ itoa.html](http://www.cplusplus.com/reference/clibrary/cstdlib/itoa.html)

## C方式

使用 sprintf。或 snprintf。或者你找到的任何工具。

尽管某些函数不在标准中，正如“onebyone”在他的一个评论中正确提到的那样，大多数编译器都会为您提供替代方案（例如，Visual C++ 有自己的 _snprintf，如果需要，您可以将其 typedef 到 snprintf）。

## C++ 方式。

使用 C++ 流（在当前情况下为 std::stringstream （甚至是已弃用的 std::strstream，正如 Herb Sutter 在他的一本书中提出的那样，因为它更快一些）。

## 结论

你在 C++ 中，这意味着你可以选择你想要的方式：

*   更快的方式（即 C 方式），但您应该确保代码是应用程序中的瓶颈（过早的优化是邪恶的，等等），并且您的代码被安全地封装以避免缓冲区溢出的风险。

*   更安全的方式（即 C++ 方式），如果您知道这部分代码并不重要，那么最好确保这部分代码不会因为有人弄错大小或指针而随机中断（这种情况会发生在现实生活中，比如......昨天，在我的电脑上，因为有人认为在不需要它的情况下使用更快的方式“很酷”）。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-23T00:21:15.923

尝试 sprintf()：

```
char str[12];
int num = 3;
sprintf(str, "%d", num); // str now contains "3" 
```

sprintf() 类似于 printf() 但输出到字符串。

此外，正如 Parappa 在评论中提到的，您可能希望使用 snprintf() 来阻止发生缓冲区溢出（您要转换的数字不适合您的字符串的大小。）它的工作原理如下：

```
snprintf(str, sizeof(str), "%d", num); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-10-23T00:32:32.030

在幕后，lexical_cast 这样做：

```
std::stringstream str;
str << myint;
std::string result;
str >> result; 
```

如果您不想为此“拖入”提升，那么使用上述方法是一个很好的解决方案。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-11-02T21:14:57.930

我们可以`iota`在 C++ 中定义我们自己的函数：

```
string itoa(int a)
{
    string ss="";   //create empty string
    while(a)
    {
        int x=a%10;
        a/=10;
        char i='0';
        i=i+x;
        ss=i+ss;      //append new character at the front of the string!
    }
    return ss;
} 
```

别忘了`#include <string>`。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2012-05-17T19:09:44.723

С++11 终于解决了这个问题[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)。也是`boost::lexical_cast`旧编译器的方便工具。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-08-28T18:46:25.117

我使用这些模板

```
template <typename T> string toStr(T tmp)
{
    ostringstream out;
    out << tmp;
    return out.str();
}

template <typename T> T strTo(string tmp)
{
    T output;
    istringstream in(tmp);
    in >> output;
    return output;
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-05-22T21:28:36.807

试试[Boost.Format](http://www.boost.org/)或[FastFormat](http://www.fastformat.org/)，这两个都是高质量的 C++ 库：

```
int i = 10;
std::string result; 
```

使用 Boost.Format

```
result = str(boost::format("%1%", i)); 
```

或快速格式化

```
fastformat::fmt(result, "{0}", i);
fastformat::write(result, i); 
```

显然，它们都不仅仅是一个整数的简单转换

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-05-04T20:12:30.077

您实际上可以使用一个巧妙编写的模板函数将任何内容转换为字符串。此代码示例使用循环在 Win-32 系统中创建子目录。字符串连接运算符 operator+ 用于连接根与后缀以生成目录名称。后缀是通过使用模板函数将循环控制变量 i 转换为 C++ 字符串并将其与另一个字符串连接来创建的。

```
//Mark Renslow, Globe University, Minnesota School of Business, Utah Career College
//C++ instructor and Network Dean of Information Technology

#include <cstdlib>
#include <iostream>
#include <string>
#include <sstream> // string stream
#include <direct.h>

using namespace std;

string intToString(int x)
{
/**************************************/
/* This function is similar to itoa() */
/* "integer to alpha", a non-standard */
/* C language function. It takes an   */
/* integer as input and as output,    */
/* returns a C++ string.              */
/* itoa()  returned a C-string (null- */
/* terminated)                        */
/* This function is not needed because*/
/* the following template function    */
/* does it all                        */
/**************************************/   
       string r;
       stringstream s;

       s << x;
       r = s.str();

       return r;

}

template <class T>
string toString( T argument)
{
/**************************************/
/* This template shows the power of   */
/* C++ templates. This function will  */
/* convert anything to a string!      */
/* Precondition:                      */
/* operator<< is defined for type T    */
/**************************************/
       string r;
       stringstream s;

       s << argument;
       r = s.str();

       return r;

}

int main( )
{
    string s;

    cout << "What directory would you like me to make?";

    cin >> s;

    try
    {
      mkdir(s.c_str());
    }
    catch (exception& e) 
    {
      cerr << e.what( ) << endl;
    }

    chdir(s.c_str());

    //Using a loop and string concatenation to make several sub-directories
    for(int i = 0; i < 10; i++)
    {
        s = "Dir_";
        s = s + toString(i);
        mkdir(s.c_str());
    }
    system("PAUSE");
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-23T00:22:43.190

分配一个足够长的字符串，然后使用 snprintf。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-06-27T14:16:11.567

```
int number = 123;

stringstream = s;

s << number;

cout << ss.str() << endl; 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-04-29T17:32:54.857

如果您对快速且安全的整数到字符串的转换方法感兴趣并且不限于标准库，我可以推荐[{fmt}](https://github.com/fmtlib/fmt)`format_int`库中的方法：

```
fmt::format_int(42).str();   // convert to std::string
fmt::format_int(42).c_str(); // convert and get as a C string
                             // (mind the lifetime, same as std::string::c_str()) 
```

根据 Boost Karma 的[整数到字符串转换基准](http://zverovich.net/2013/09/07/integer-to-string-conversion-in-cplusplus.html)，这种方法比 glibc`sprintf`或`std::stringstream`. [正如独立基准](https://github.com/ruslo/int-dec-format-tests/blob/545dcc6e2e558bc6146c368ef4265351fedd528a/results/macosx-clang-intel-core-i5-2.3GHz.txt)`int_generator`所证实的那样，它甚至比 Boost Karma 自己的还要快。

免责声明：我是这个库的作者。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-07-01T07:54:04.537

我前段时间写了这个**线程安全的函数，对结果很满意，感觉算法轻巧精简，性能大约是标准 MSVC _itoa() 函数的 3 倍。**

这是链接。[最佳 Base-10 仅 itoa() 函数？](https://stackoverflow.com/questions/21501815/optimal-base-10-only-itoa-function)性能至少是 sprintf() 的 10 倍。基准测试也是函数的 QA 测试，如下所示。

```
start = clock();
for (int i = LONG_MIN; i < LONG_MAX; i++) {
    if (i != atoi(_i32toa(buff, (int32_t)i))) {
        printf("\nError for %i", i);
    }
    if (!i) printf("\nAt zero");
}
printf("\nElapsed time was %f milliseconds", (double)clock() - (double)(start)); 
```

关于使用调用者的存储提出了一些愚蠢的建议，这会使结果浮动在调用者地址空间的缓冲区中的某处。别理他们。正如基准/QA 代码所示，我列出的代码运行良好。

我相信这段代码足够精简，可以在嵌入式环境中使用。YMMV，当然。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-07-07T20:42:34.687

最好的答案，IMO，是这里提供的功能：

[http://www.jb.man.ac.uk/~slowe/cpp/itoa.html](http://www.jb.man.ac.uk/~slowe/cpp/itoa.html)

它模仿了许多库提供的非 ANSI 函数。

```
char* itoa(int value, char* result, int base); 
```

它也非常快，并且在 -O3 下优化得很好，而你不使用 c++ string_format() ... 或 sprintf 的原因是它们太慢了，对吧？

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-23T06:45:16.053

请注意，所有`stringstream`方法**都可能**涉及锁定使用区域设置对象进行格式化。如果您从多个线程中使用这种转换，这**可能是需要注意的事情......**

请参阅此处了解更多信息。[在 C++ 中将数字转换为具有指定长度的字符串](https://stackoverflow.com/questions/225362/convert-a-number-to-a-string-with-specified-length-in-c#226719)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-23T17:34:52.840

在 Windows CE 派生平台上，默认情况下没有`iostream`s。去那里的方法`_itoa<>`通常是与家人一起去`_itow<>`（因为无论如何大多数字符串都是Unicode）。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-10-23T00:31:59.863

大多数上述建议在技术上不是 C++，它们是 C 解决方案。

研究[std::stringstream](http://www.cplusplus.com/reference/iostream/stringstream/)的使用。

# asp.net - .NET 的蓬松云配置

> ID：228013
> 
> 赞同：1
> 
> 时间：2008-10-23T00:21:18.497
> 
> 标签：asp.net, windows, hosting, amazon-web-services, cloud

非常简单的问题，这些天是否有任何云服务器环境可供我们 .NET 人使用，可以与亚马逊的 ec2 相媲美？

编辑：

PDC 2008 看起来有一些非常有趣的信息，只有 4 天 2 小时等待:-)。看来我需要快速节省会议费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T00:24:51.797

屏住呼吸参加[PDC 2008](http://www.microsoftpdc.com/)，您会看到的。此外，Amazon 对 Windows 映像的 EC2 服务支持处于测试阶段。 [AWS Windows 支持博客文章](http://aws.typepad.com/aws/2008/10/coming-soon-ama.html)

**10 月 23 日更新**：AWS Windows 支持发布到生产环境（[详情请点击此处](http://aws.amazon.com/windows/)）

**10 月 27 日更新**：所以你屏住呼吸，看到 Reddog 人变成了“Windows Azure”云服务和 Sitka - SQL Server 数据服务。在 MSDN、MS PDC 站点、Channel 9 等有大量活动可供阅读和学习。玩得开心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T05:20:34.290

我使用 Rackspace 的子公司 Mosso。我对他们很满意。

您可以在他们的系统上运行 PHP、Perl、.NET 和 RoR。MySQL 以及 SQL Server。

[http://www.mosso.com](http://www.mosso.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T00:25:19.533

查看[Sql Server 数据服务](http://www.microsoft.com/sql/dataservices/default.mspx)并确保在下周收听 PDC 2008。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T05:50:09.907

它尚未公开，但 EasyDb 非常专注于 .net，它将您的表格包装到 ASMX Web 服务中。上面有一集dnrtv，[http ://www.dnrtv.com/default.aspx?showNum=121](http://www.dnrtv.com/default.aspx?showNum=121)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T13:38:21.540

今年早些时候，我们带 Mosso 进行了试运行，结果是灾难性的。在许多标准上——正常运行时间、客户服务、灵活性——我们会更好地使用每月 6 美元的共享主机帐户。他们在中途将定价模型从按请求模型更改为按“计算周期”模型，“计算周期”是一个神秘的专有指标，无法优化，因为你不知道它是如何计算的——最后结果是您可能会突然发现自己无缘无故被收取数千美元的费用。

# .net - 如何在 Linq To SQL 中跳过插入/更新的默认值列？

> ID：228025
> 
> 赞同：4
> 
> 时间：2008-10-23T00:26:22.417
> 
> 标签：.net, linq, linq-to-sql

如何通过 Linq To SQL 和 Linq To SQL 插入/更新列使用默认值？特别是我关心时间戳字段。

我已经尝试将该列设置为只读并自动生成，因此它停止尝试输入 DateTime.MinValue，但它似乎没有更新更新。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T00:52:55.593

您需要为时间戳列设置 IsVersion=true。请参阅[ColumnAttribute](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.columnattribute_properties.aspx)的参考。

在我的时间戳列的 DBML 设计器中，属性设置为

```
AutoGenerated=true
AutoSync=Always
Nullable, Primary Key, and ReadOnly = false
SQLDataType = rowversion not null
Timestamp = true
UpdateCheck = never 
```

我假设您的意思是时间戳而不是日期时间。如果是后者，请忽略这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T00:47:20.613

数据库默认值只会在创建行时插入值。除非您想添加触发器，否则它不会对更新做任何事情。

或者，您可以向 DataContext 类添加部分方法。为您的项目添加一个新文件：

```
public partial class YourDatabaseDataContext
{
    partial void InsertYourTable(YourTable instance)
    {
        instance.LastUpdateTime = DateTime.Now;

        this.ExecuteDynamicInsert(instance);
    }

    partial void UpdateYourTable(YourTable instance)
    {
        instance.LastUpdateTime = DateTime.Now;

        this.ExecuteDynamicUpdate(instance);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T11:03:23.363

好像您只是忘记将属性设置为**始终****自动同步**。

 **# c++ - 函数模板参数的C++模板实例化

> ID：228036
> 
> 赞同：6
> 
> 时间：2008-10-23T00:30:45.920
> 
> 标签：c++, templates, boost, function, linker

我在使用模板实例化 [*] 时遇到以下问题。

文件**foo.h**

```
class Foo
{
public:
    template <typename F>
    void func(F f)

private:
    int member_;
}; 
```

文件**foo.cc**

```
template <typename F>
Foo::func(F f)
{
     f(member_);
} 
```

文件**调用者.cc**

```
Foo::func(boost::bind(&Bar::bar_func, bar_instance, _1)); 
```

虽然这编译得很好，但链接器抱怨一个未定义的符号：

`void Foo::func<boost::_bi::bind_t...>`

如何实例化*函数* `Foo::func`？由于它需要一个函数作为参数，我有点困惑。我尝试在**foo.cc**中添加一个实例化函数，因为我习惯于使用常规*的非函数*类型：

```
instantiate()
{
    template<> void Foo::func<boost::function<void(int)> >(boost::function<void(int)>);
} 
```

显然，这是行不通的。如果有人能指出我正确的方向，我将不胜感激。

谢谢！

[*] 是的，我阅读了 parashift FAQ 精简版。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T00:41:54.663

答案取决于编译器。某些版本的 Sun C++ 编译器会通过构建模板函数实现的缓存来自动处理这个问题，这些实现将在不同的翻译单元之间共享。

如果您使用 Visual C++ 和任何其他无法执行此操作的编译器，您不妨将函数定义放在头文件中。

如果标头包含在多个 .cc 文件中，则不必担心重复定义。编译器使用特殊属性标记模板生成的方法，以便链接器知道丢弃重复项而不是抱怨。这就是 C++ 具有“单一定义规则”的原因之一。

**编辑：**上述评论适用于您的模板必须能够链接给定任何类型参数的一般情况。如果您知道客户端将使用的一组封闭类型，您可以通过在模板的实现文件中使用显式实例化来确保它们可用，这将导致编译器生成其他文件链接的定义。但是在一般情况下，您的模板需要使用可能只有客户端知道的类型，那么将模板分为头文件和实现文件就没有什么意义了；无论如何，任何客户都需要包括这两个部分。如果您想将客户端与复杂的依赖项隔离开来，请将这些依赖项隐藏在非模板函数后面，然后从模板代码中调用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T04:49:43.743

将其拆分为您想要的文件：
我不建议这样做。只是表明这是可能的。

扑通一声

```
#include <iostream>
class Foo
{
public:
    Foo(): member_(15){}

    // Note No definition of this in a header file.
    // It is defined in plop.cpp and a single instantiation forced
    // Without actually using it.
    template <typename F>
    void func(F f);

private:
    int member_;
};

struct Bar
{
     void bar_func(int val) { std::cout << val << "\n"; }
};

struct Tar
{
    void tar_func(int val) { std::cout << "This should not print because of specialisation of func\n";}
}; 
```

扑通扑通

```
#include "plop.h"
#include <boost/bind.hpp>
#include <iostream>

template <typename F>
void Foo::func(F f)
{
     f(member_);
}

// Gnarly typedef
typedef boost::_bi::bind_t<void, boost::_mfi::mf1<void, Bar, int>, boost::_bi::list2<boost::_bi::value<Bar>, boost::arg<1> (*)()> > myFunc;

// Force the compiler to generate an instantiation of Foo::func()
template void Foo::func<myFunc>(myFunc f);

// Note this is not a specialization as that requires the <> after template.
// See main.cpp for an example of specialization. 
```

主文件

```
#include "plop.h"
#include <boost/bind.hpp>
#include <iostream>

// Gnarly typedef
typedef boost::_bi::bind_t<void, boost::_mfi::mf1<void, Tar, int>, boost::_bi::list2<boost::_bi::value<Tar>, boost::arg<1> (*)()> > myTar;

// Specialization of Foo::func()
template<> void Foo::func<myTar>(myTar f)
{
    std::cout << "Special\n";
}
// Note. This is not instantiated unless it is used.
// But because it is used in main() we get a version.

int main(int argc,char* argv[])
{
    Foo f;
    Bar b;
    Tar t;

    f.func(boost::bind(&Bar::bar_func, b, _1)); // Uses instantiation from plop.cpp
    f.func(boost::bind(&Tar::tar_func, t, _1)); // Uses local specialization
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T00:35:41.027

您是否将 foo.cc 包含在 caller.cc 中。实例化是在编译时发生的事情——当编译器在调用者中看到调用时，它会生成模板的实例化版本，但需要有完整的定义可用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T02:42:24.653

我认为他们都指的是模板函数定义（不仅仅是声明）必须包含在使用它们的文件中。模板函数实际上并不存在，除非/直到它们被使用；如果将它们放在单独的 cc 文件中，则编译器不会在其他 cc 文件中知道它们，除非`#include`由于解析器的工作方式，您将 cc 文件显式放入头文件或调用它们的文件中.

（这就是模板函数定义通常保存在头文件中的原因，正如 Earwicker 所描述的。）

有更清楚的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T02:44:50.577

我相信 Earwicker 是正确的。在这种情况下显式实例化模板成员函数 func 的问题是 boost::bind 返回的类型是依赖于实现的。它*不是*boost::function。boost::function 可以*包含*boost:bind，因为它有一个模板赋值运算符，用于推断右侧的类型（boost::bind 结果）。在 caller.cc 中对 func 的这种特殊使用中，通过这种特殊的 boost 实现，boost::bind 的类型实际上是它们在 < 和 > 之间的链接器错误中提到的类型（即。`boost::_bi::bind_t...`）。但是为该类型显式实例化 func 可能会有可移植性问题。

# c# - 反转字符串的最佳方法

> ID：228038
> 
> 赞同：516
> 
> 时间：2008-10-23T00:31:32.673
> 
> 标签：c#, .net, performance, algorithm, unicode

我只需要在 C# 2.0 中编写一个字符串反转函数（即 LINQ 不可用）并想出了这个：

```
public string Reverse(string text)
{
    char[] cArray = text.ToCharArray();
    string reverse = String.Empty;
    for (int i = cArray.Length - 1; i > -1; i--)
    {
        reverse += cArray[i];
    }
    return reverse;
} 
```

就我个人而言，我对这个功能并不疯狂，并且相信有更好的方法来做到这一点。有没有？

* * *

## 回答 #1

> 赞同：725
> 
> 时间：2008-10-23T00:40:43.950

```
public static string Reverse( string s )
{
    char[] charArray = s.ToCharArray();
    Array.Reverse( charArray );
    return new string( charArray );
} 
```

* * *

## 回答 #2

> 赞同：211
> 
> 时间：2013-02-27T12:06:03.467

这是一个将字符串正确反转为的解决`"Les Mise\u0301rables"`方案`"selbare\u0301siM seL"`。这应该呈现就像`selbarésiM seL`，而不是`selbaŕesiM seL`（注意重音的位置），就像大多数基于代码单元（`Array.Reverse`等）甚至代码点（特别注意代理对的反转）的实现的结果一样。

```
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;

public static class Test
{
    private static IEnumerable<string> GraphemeClusters(this string s) {
        var enumerator = StringInfo.GetTextElementEnumerator(s);
        while(enumerator.MoveNext()) {
            yield return (string)enumerator.Current;
        }
    }
    private static string ReverseGraphemeClusters(this string s) {
        return string.Join("", s.GraphemeClusters().Reverse().ToArray());
    }

    public static void Main()
    {
        var s = "Les Mise\u0301rables";
        var r = s.ReverseGraphemeClusters();
        Console.WriteLine(r);
    }
} 
```

（以及此处的实时运行示例：[https](https://ideone.com/DqAeMJ) ://ideone.com/DqAeMJ ）

它只是使用 .NET [API 进行字素集群迭代](http://msdn.microsoft.com/en-us/library/x2f3k4f6.aspx)，从那时起就一直存在，但看起来有点“隐藏”。

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2008-10-23T00:41:04.477

这是一个令人惊讶的棘手问题。

我建议在大多数情况下使用 Array.Reverse，因为它是原生编码的，维护和理解非常简单。

在我测试的所有情况下，它似乎都优于 StringBuilder。

```
public string Reverse(string text)
{
   if (text == null) return null;

   // this was posted by petebob as well 
   char[] array = text.ToCharArray();
   Array.Reverse(array);
   return new String(array);
} 
```

[对于使用 Xor](http://www.sqljunkies.com/WebLog/amachanic/archive/2006/07/17/22253.aspx)的某些字符串长度，还有第二种方法可以更快。

```
 public static string ReverseXor(string s)
    {
        if (s == null) return null;
        char[] charArray = s.ToCharArray();
        int len = s.Length - 1;

        for (int i = 0; i < len; i++, len--)
        {
            charArray[i] ^= charArray[len];
            charArray[len] ^= charArray[i];
            charArray[i] ^= charArray[len];
        }

        return new string(charArray);
    } 
```

**注意**如果您想支持完整的 Unicode UTF16 字符集，[请阅读此](https://stackoverflow.com/questions/228038/best-way-to-reverse-a-string-in-c-20#228460)。并使用那里的实现。它可以通过使用上述算法之一并在字符反转后遍历字符串以清理它来进一步优化。

下面是 StringBuilder、Array.Reverse 和 Xor 方法之间的性能比较。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;

namespace ConsoleApplication4
{
    class Program
    {
        delegate string StringDelegate(string s);

        static void Benchmark(string description, StringDelegate d, int times, string text)
        {
            Stopwatch sw = new Stopwatch();
            sw.Start();
            for (int j = 0; j < times; j++)
            {
                d(text);
            }
            sw.Stop();
            Console.WriteLine("{0} Ticks {1} : called {2} times.", sw.ElapsedTicks, description, times);
        }

        public static string ReverseXor(string s)
        {
            char[] charArray = s.ToCharArray();
            int len = s.Length - 1;

            for (int i = 0; i < len; i++, len--)
            {
                charArray[i] ^= charArray[len];
                charArray[len] ^= charArray[i];
                charArray[i] ^= charArray[len];
            }

            return new string(charArray);
        }

        public static string ReverseSB(string text)
        {
            StringBuilder builder = new StringBuilder(text.Length);
            for (int i = text.Length - 1; i >= 0; i--)
            {
                builder.Append(text[i]);
            }
            return builder.ToString();
        }

        public static string ReverseArray(string text)
        {
            char[] array = text.ToCharArray();
            Array.Reverse(array);
            return (new string(array));
        }

        public static string StringOfLength(int length)
        {
            Random random = new Random();
            StringBuilder sb = new StringBuilder();
            for (int i = 0; i < length; i++)
            {
                sb.Append(Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65))));
            }
            return sb.ToString();
        }

        static void Main(string[] args)
        {

            int[] lengths = new int[] {1,10,15,25,50,75,100,1000,100000};

            foreach (int l in lengths)
            {
                int iterations = 10000;
                string text = StringOfLength(l);
                Benchmark(String.Format("String Builder (Length: {0})", l), ReverseSB, iterations, text);
                Benchmark(String.Format("Array.Reverse (Length: {0})", l), ReverseArray, iterations, text);
                Benchmark(String.Format("Xor (Length: {0})", l), ReverseXor, iterations, text);

                Console.WriteLine();    
            }

            Console.Read();
        }
    }
} 
```

结果如下：

```
26251 Ticks String Builder (Length: 1) : called 10000 times.
33373 Ticks Array.Reverse (Length: 1) : called 10000 times.
20162 Ticks Xor (Length: 1) : called 10000 times.

51321 Ticks String Builder (Length: 10) : called 10000 times.
37105 Ticks Array.Reverse (Length: 10) : called 10000 times.
23974 Ticks Xor (Length: 10) : called 10000 times.

66570 Ticks String Builder (Length: 15) : called 10000 times.
26027 Ticks Array.Reverse (Length: 15) : called 10000 times.
24017 Ticks Xor (Length: 15) : called 10000 times.

101609 Ticks String Builder (Length: 25) : called 10000 times.
28472 Ticks Array.Reverse (Length: 25) : called 10000 times.
35355 Ticks Xor (Length: 25) : called 10000 times.

161601 Ticks String Builder (Length: 50) : called 10000 times.
35839 Ticks Array.Reverse (Length: 50) : called 10000 times.
51185 Ticks Xor (Length: 50) : called 10000 times.

230898 Ticks String Builder (Length: 75) : called 10000 times.
40628 Ticks Array.Reverse (Length: 75) : called 10000 times.
78906 Ticks Xor (Length: 75) : called 10000 times.

312017 Ticks String Builder (Length: 100) : called 10000 times.
52225 Ticks Array.Reverse (Length: 100) : called 10000 times.
110195 Ticks Xor (Length: 100) : called 10000 times.

2970691 Ticks String Builder (Length: 1000) : called 10000 times.
292094 Ticks Array.Reverse (Length: 1000) : called 10000 times.
846585 Ticks Xor (Length: 1000) : called 10000 times.

305564115 Ticks String Builder (Length: 100000) : called 10000 times.
74884495 Ticks Array.Reverse (Length: 100000) : called 10000 times.
125409674 Ticks Xor (Length: 100000) : called 10000 times. 
```

对于短字符串，Xor 似乎可以更快。

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2013-04-06T08:14:47.157

如果您可以使用 LINQ (.NET Framework 3.5+)，那么下面的一行将为您提供简短的代码。不要忘记添加`using System.Linq;`以访问[`Enumerable.Reverse`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.reverse?view=netframework-4.8)：

```
public string ReverseString(string srtVarable)
{
    return new string(srtVarable.Reverse().ToArray());
} 
```

笔记：

*   不是最快的版本 - 根据 [Martin Niederl](https://stackoverflow.com/users/6513167/martin-niederl)的说法，它比这里的最快选择慢 5.7 倍。
*   *与许多其他选项一样，此代码完全忽略了各种多字符组合，因此限制使用不*包含此类字符的家庭作业和字符串。有关正确处理此类组合的实现，请参阅此问题中的另一个[答案。](https://stackoverflow.com/a/15111719/477420)

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2008-10-23T03:40:07.580

如果字符串包含 Unicode 数据（严格来说，非 BMP 字符），则已发布的其他方法将损坏它，因为在反转字符串时无法交换高代理代码单元和低代理代码单元的顺序。（有关这方面的更多信息可以在[我的博客](http://code.logos.com/blog/2008/10/how_to_reverse_a_unicode_string_in_c.html)上找到。）

以下代码示例将正确反转包含非 BMP 字符的字符串，例如“\U00010380\U00010381”（Ugaritic Letter Alpa，Ugaritic Letter Beta）。

```
public static string Reverse(this string input)
{
    if (input == null)
        throw new ArgumentNullException("input");

    // allocate a buffer to hold the output
    char[] output = new char[input.Length];
    for (int outputIndex = 0, inputIndex = input.Length - 1; outputIndex < input.Length; outputIndex++, inputIndex--)
    {
        // check for surrogate pair
        if (input[inputIndex] >= 0xDC00 && input[inputIndex] <= 0xDFFF &&
            inputIndex > 0 && input[inputIndex - 1] >= 0xD800 && input[inputIndex - 1] <= 0xDBFF)
        {
            // preserve the order of the surrogate pair code units
            output[outputIndex + 1] = input[inputIndex];
            output[outputIndex] = input[inputIndex - 1];
            outputIndex++;
            inputIndex--;
        }
        else
        {
            output[outputIndex] = input[inputIndex];
        }
    }

    return new string(output);
} 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2011-12-07T17:06:20.863

好的，为了“不要重复自己”，我提供以下解决方案：

```
public string Reverse(string text)
{
   return Microsoft.VisualBasic.Strings.StrReverse(text);
} 
```

我的理解是，这个实现在 VB.NET 中默认可用，可以正确处理 Unicode 字符。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2010-06-15T18:31:02.870

格雷格·比奇（Greg Beech）发布了一个`unsafe`确实是最快的选项（这是一个就地反转）；但是，正如他在回答中指出的那样，这是**[一个完全灾难性的想法](http://philosopherdeveloper.com/posts/are-strings-really-immutable-in-net.html)**。

也就是说，我很惊讶有这么多共识`Array.Reverse`是最快的方法。仍然有一种方法可以比小字符串的**方法****更快**`unsafe`地返回字符串的反转副本（没有就地反转恶作剧） ：**`Array.Reverse`**

```
public static unsafe string Reverse(string text)
{
    int len = text.Length;

    // Why allocate a char[] array on the heap when you won't use it
    // outside of this method? Use the stack.
    char* reversed = stackalloc char[len];

    // Avoid bounds-checking performance penalties.
    fixed (char* str = text)
    {
        int i = 0;
        int j = i + len - 1;
        while (i < len)
        {
            reversed[i++] = str[j--];
        }
    }

    // Need to use this overload for the System.String constructor
    // as providing just the char* pointer could result in garbage
    // at the end of the string (no guarantee of null terminator).
    return new string(reversed, 0, len);
} 
```

[以下是一些基准测试结果](http://charter.herokuapp.com/MZ02Y32T/performance-of-selected-string-reversal-methods-lower-is-better)。

您可以看到，`Array.Reverse`随着字符串变大，性能增益会缩小，然后对该方法消失。但是，对于中小型琴弦，很难击败这种方法。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2014-10-18T11:29:37.647

简单而好的答案是使用扩展方法：

```
static class ExtentionMethodCollection
{
    public static string Inverse(this string @base)
    {
        return new string(@base.Reverse().ToArray());
    }
} 
```

这是输出：

```
string Answer = "12345".Inverse(); // = "54321" 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-10-23T00:37:50.867

[在这里](http://en.wikipedia.org/wiki/Extension_method)查看维基百科条目。他们实现了 String.Reverse 扩展方法。这使您可以编写如下代码：

```
string s = "olleh";
s.Reverse(); 
```

他们还使用该问题的其他答案所建议的 ToCharArray/Reverse 组合。源代码如下所示：

```
public static string Reverse(this string input)
{
    char[] chars = input.ToCharArray();
    Array.Reverse(chars);
    return new String(chars);
} 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2008-10-23T00:38:32.987

首先，您不需要调用`ToCharArray`，因为字符串已经可以作为 char 数组进行索引，因此这将为您节省分配。

下一个优化是使用 a`StringBuilder`来防止不必要的分配（因为字符串是不可变的，将它们连接起来每次都会生成字符串的副本）。为了进一步优化这一点，我们预先设置了 的长度，`StringBuilder`因此它不需要扩展其缓冲区。

```
public string Reverse(string text)
{
    if (string.IsNullOrEmpty(text))
    {
        return text;
    }

    StringBuilder builder = new StringBuilder(text.Length);
    for (int i = text.Length - 1; i >= 0; i--)
    {
        builder.Append(text[i]);
    }

    return builder.ToString();
} 
```

**编辑：性能数据**

`Array.Reverse`我用下面的简单程序测试了这个函数和函数，其中`Reverse1`一个函数是另一个函数`Reverse2`：

```
static void Main(string[] args)
{
    var text = "abcdefghijklmnopqrstuvwxyz";

    // pre-jit
    text = Reverse1(text); 
    text = Reverse2(text);

    // test
    var timer1 = Stopwatch.StartNew();
    for (var i = 0; i < 10000000; i++)
    {
        text = Reverse1(text);
    }

    timer1.Stop();
    Console.WriteLine("First: {0}", timer1.ElapsedMilliseconds);

    var timer2 = Stopwatch.StartNew();
    for (var i = 0; i < 10000000; i++)
    {
        text = Reverse2(text);
    }

    timer2.Stop();
    Console.WriteLine("Second: {0}", timer2.ElapsedMilliseconds);

    Console.ReadLine();
} 
```

事实证明，对于短字符串，该`Array.Reverse`方法的速度大约是上述方法的两倍，而对于较长的字符串，这种差异更加明显。因此，鉴于该`Array.Reverse`方法既简单又快捷，我建议您使用它而不是这个。我把这个留在这里只是为了表明这不是你应该这样做的方式（令我惊讶的是！）

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2008-10-23T02:49:32.237

如果您想玩一个非常危险的游戏，那么这是迄今为止最快的方法（比该`Array.Reverse`方法快四倍左右）。这是使用指针的就地反转。

请注意，我真的不建议将其用于任何用途（[请查看此处，了解为什么您不应使用此方法的某些原因](https://stackoverflow.com/questions/229346/why-should-i-never-use-an-unsafe-block-to-modify-a-string)），但有趣的是看到它可以完成，并且字符串并不是真正不可变的一旦你打开不安全的代码。

```
public static unsafe string Reverse(string text)
{
    if (string.IsNullOrEmpty(text))
    {
        return text;
    }

    fixed (char* pText = text)
    {
        char* pStart = pText;
        char* pEnd = pText + text.Length - 1;
        for (int i = text.Length / 2; i >= 0; i--)
        {
            char temp = *pStart;
            *pStart++ = *pEnd;
            *pEnd-- = temp;
        }

        return text;
    }
} 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2008-10-23T00:48:33.510

尝试使用 Array.Reverse

```
 public string Reverse(string str)
{
    char[] array = str.ToCharArray();
    Array.Reverse(array);
    return new string(array);
} 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2019-07-08T15:08:09.177

从 .NET Core 2.1 开始，有一种使用该方法反转字符串的新`string.Create`方法。

*请注意，此解决方案无法正确处理 Unicode 组合字符等，因为“Les Mise\u0301rables”将被转换为“selbarésiM seL”。请参阅[其他答案](https://stackoverflow.com/a/15111719/8336143)以获得更好的解决方案。*

```
public static string Reverse(string input)
{
    return string.Create<string>(input.Length, input, (chars, state) =>
    {
        state.AsSpan().CopyTo(chars);
        chars.Reverse();
    });
} 
```

这实质上是将 的字符复制`input`到一个新字符串并就地反转新字符串。

### 为什么`string.Create`有用？

当我们从现有数组创建字符串时，会分配一个新的内部数组并复制值。否则，有可能在创建字符串后（在安全环境中）对其进行变异。也就是说，在下面的代码片段中，我们必须分配一个长度为 10 的数组两次，一次作为缓冲区，一次作为字符串的内部数组。

```
var chars = new char[10];
// set array values
var str = new string(chars); 
```

`string.Create`本质上允许我们在字符串的创建期间操作内部数组。也就是说，我们不再需要缓冲区，因此可以避免分配那个 char 数组。

Steve Gordon 在[这里](https://www.stevejgordon.co.uk/creating-strings-with-no-allocation-overhead-using-string-create-csharp)更详细地描述了它。[MSDN](https://msdn.microsoft.com/en-us/magazine/mt814808.aspx#code-snippet-18)上也有一篇文章。

### 如何使用`string.Create`？

```
public static string Create<TState>(int length, TState state, SpanAction<char, TState> action); 
```

该方法接受三个参数：

1.  要创建的字符串的长度，
2.  您要用于动态创建新字符串的数据，
3.  以及从数据创建最终字符串的委托，其中第一个参数指向`char`新字符串的内部数组，第二个参数是您传递给的数据（状态）`string.Create`。

在委托中，我们可以指定如何从数据中创建新字符串。在我们的例子中，我们只是将输入字符串的字符复制到`Span`新字符串使用的字符中。然后我们反转`Span`，因此整个字符串被反转。

### 基准

为了将我提出的反转字符串的方法与接受的答案进行比较，我使用 BenchmarkDotNet 编写了两个基准测试。

```
public class StringExtensions
{
    public static string ReverseWithArray(string input)
    {
        var charArray = input.ToCharArray();
        Array.Reverse(charArray);
        return new string(charArray);
    }

    public static string ReverseWithStringCreate(string input)
    {
        return string.Create(input.Length, input, (chars, state) =>
        {
            state.AsSpan().CopyTo(chars);
            chars.Reverse();
        });
    }
}

[MemoryDiagnoser]
public class StringReverseBenchmarks
{
    private string input;

    [Params(10, 100, 1000)]
    public int InputLength { get; set; }

    [GlobalSetup]
    public void SetInput()
    {
        // Creates a random string of the given length
        this.input = RandomStringGenerator.GetString(InputLength);
    }

    [Benchmark(Baseline = true)]
    public string WithReverseArray() => StringExtensions.ReverseWithArray(input);

    [Benchmark]
    public string WithStringCreate() => StringExtensions.ReverseWithStringCreate(input);
} 
```

这是我机器上的结果：

```
| Method           | InputLength |         Mean |      Error |    StdDev |  Gen 0 | Allocated |
| ---------------- | ----------- | -----------: | ---------: | --------: | -----: | --------: |
| WithReverseArray | 10          |    45.464 ns |  0.4836 ns | 0.4524 ns | 0.0610 |      96 B |
| WithStringCreate | 10          |    39.749 ns |  0.3206 ns | 0.2842 ns | 0.0305 |      48 B |
|                  |             |              |            |           |        |           |
| WithReverseArray | 100         |   175.162 ns |  2.8766 ns | 2.2458 ns | 0.2897 |     456 B |
| WithStringCreate | 100         |   125.284 ns |  2.4657 ns | 2.0590 ns | 0.1473 |     232 B |
|                  |             |              |            |           |        |           |
| WithReverseArray | 1000        | 1,523.544 ns |  9.8808 ns | 8.7591 ns | 2.5768 |    4056 B |
| WithStringCreate | 1000        | 1,078.957 ns | 10.2948 ns | 9.6298 ns | 1.2894 |    2032 B | 
```

如您所见，`ReverseWithStringCreate`我们只分配了该方法使用的一半内存`ReverseWithArray`。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2013-04-09T17:47:44.330

```
public static string Reverse(string input)
{
    return string.Concat(Enumerable.Reverse(input));
} 
```

当然你可以用 Reverse 方法扩展字符串类

```
public static class StringExtensions
{
    public static string Reverse(this string input)
    {
        return string.Concat(Enumerable.Reverse(input));
    }
} 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2017-10-01T18:38:32.790

“最佳”可能取决于很多事情，但这里有几个从快到慢排序的简短替代方案：

```
string s = "z̽a̎l͘g̈o̓", pattern = @"(?s).(?<=(?:.(?=.*$(?<=((\P{M}\p{C}?\p{M}*)\1?))))*)";

string s1 = string.Concat(s.Reverse());                          // "☐☐̓ög͘l̎a̽z"  

string s2 = Microsoft.VisualBasic.Strings.StrReverse(s);         // "o̓g̈l͘a̎̽z"  

string s3 = string.Concat(StringInfo.ParseCombiningCharacters(s).Reverse()
    .Select(i => StringInfo.GetNextTextElement(s, i)));          // "o̓g̈l͘a̎z̽"  

string s4 = Regex.Replace(s, pattern, "$2").Remove(s.Length);    // "o̓g̈l͘a̎z̽" 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2013-04-02T00:45:52.350

不要为功能而烦恼，只需在原地完成即可。注意：第二行会在某些 VS 版本的即时窗口中抛出参数异常。

```
string s = "Blah";
s = new string(s.ToCharArray().Reverse().ToArray()); 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2008-10-23T01:17:58.990

抱歉发了很长的帖子，但这可能很有趣

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        public static string ReverseUsingArrayClass(string text)
        {
            char[] chars = text.ToCharArray();
            Array.Reverse(chars);
            return new string(chars);
        }

        public static string ReverseUsingCharacterBuffer(string text)
        {
            char[] charArray = new char[text.Length];
            int inputStrLength = text.Length - 1;
            for (int idx = 0; idx <= inputStrLength; idx++) 
            {
                charArray[idx] = text[inputStrLength - idx];                
            }
            return new string(charArray);
        }

        public static string ReverseUsingStringBuilder(string text)
        {
            if (string.IsNullOrEmpty(text))
            {
                return text;
            }

            StringBuilder builder = new StringBuilder(text.Length);
            for (int i = text.Length - 1; i >= 0; i--)
            {
                builder.Append(text[i]);
            }

            return builder.ToString();
        }

        private static string ReverseUsingStack(string input)
        {
            Stack<char> resultStack = new Stack<char>();
            foreach (char c in input)
            {
                resultStack.Push(c);
            }

            StringBuilder sb = new StringBuilder();
            while (resultStack.Count > 0)
            {
                sb.Append(resultStack.Pop());
            }
            return sb.ToString();
        }

        public static string ReverseUsingXOR(string text)
        {
            char[] charArray = text.ToCharArray();
            int length = text.Length - 1;
            for (int i = 0; i < length; i++, length--)
            {
                charArray[i] ^= charArray[length];
                charArray[length] ^= charArray[i];
                charArray[i] ^= charArray[length];
            }

            return new string(charArray);
        }

        static void Main(string[] args)
        {
            string testString = string.Join(";", new string[] {
                new string('a', 100), 
                new string('b', 101), 
                new string('c', 102), 
                new string('d', 103),                                                                   
            });
            int cycleCount = 100000;

            Stopwatch stopwatch = new Stopwatch();
            stopwatch.Start();
            for (int i = 0; i < cycleCount; i++) 
            {
                ReverseUsingCharacterBuffer(testString);
            }
            stopwatch.Stop();
            Console.WriteLine("ReverseUsingCharacterBuffer: " + stopwatch.ElapsedMilliseconds + "ms");

            stopwatch.Reset();
            stopwatch.Start();
            for (int i = 0; i < cycleCount; i++) 
            {
                ReverseUsingArrayClass(testString);
            }
            stopwatch.Stop();
            Console.WriteLine("ReverseUsingArrayClass: " + stopwatch.ElapsedMilliseconds + "ms");

            stopwatch.Reset();
            stopwatch.Start();
            for (int i = 0; i < cycleCount; i++) 
            {
                ReverseUsingStringBuilder(testString);
            }
            stopwatch.Stop();
            Console.WriteLine("ReverseUsingStringBuilder: " + stopwatch.ElapsedMilliseconds + "ms");

            stopwatch.Reset();
            stopwatch.Start();
            for (int i = 0; i < cycleCount; i++) 
            {
                ReverseUsingStack(testString);
            }
            stopwatch.Stop();
            Console.WriteLine("ReverseUsingStack: " + stopwatch.ElapsedMilliseconds + "ms");

            stopwatch.Reset();
            stopwatch.Start();
            for (int i = 0; i < cycleCount; i++) 
            {
                ReverseUsingXOR(testString);
            }
            stopwatch.Stop();
            Console.WriteLine("ReverseUsingXOR: " + stopwatch.ElapsedMilliseconds + "ms");            
        }
    }
} 
```

结果：

*   ReverseUsingCharacterBuffer: 346ms
*   ReverseUsingArrayClass：87ms
*   ReverseUsingStringBuilder：824ms
*   ReverseUsingStack：2086ms
*   ReverseUsingXOR：319ms

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2012-09-08T06:03:20.993

```
public string Reverse(string input)
{
    char[] output = new char[input.Length];

    int forwards = 0;
    int backwards = input.Length - 1;

    do
    {
        output[forwards] = input[backwards];
        output[backwards] = input[forwards];
    }while(++forwards <= --backwards);

    return new String(output);
}

public string DotNetReverse(string input)
{
    char[] toReverse = input.ToCharArray();
    Array.Reverse(toReverse);
    return new String(toReverse);
}

public string NaiveReverse(string input)
{
    char[] outputArray = new char[input.Length];
    for (int i = 0; i < input.Length; i++)
    {
        outputArray[i] = input[input.Length - 1 - i];
    }

    return new String(outputArray);
}    

public string RecursiveReverse(string input)
{
    return RecursiveReverseHelper(input, 0, input.Length - 1);
}

public string RecursiveReverseHelper(string input, int startIndex , int endIndex)
{
    if (startIndex == endIndex)
    {
        return "" + input[startIndex];
    }

    if (endIndex - startIndex == 1)
    {
        return "" + input[endIndex] + input[startIndex];
    }

    return input[endIndex] + RecursiveReverseHelper(input, startIndex + 1, endIndex - 1) + input[startIndex];
}

void Main()
{
    int[] sizes = new int[] { 10, 100, 1000, 10000 };
    for(int sizeIndex = 0; sizeIndex < sizes.Length; sizeIndex++)
    {
        string holaMundo  = "";
        for(int i = 0; i < sizes[sizeIndex]; i+= 5)
        {   
            holaMundo += "ABCDE";
        }

        string.Format("\n**** For size: {0} ****\n", sizes[sizeIndex]).Dump();

        string odnuMaloh = DotNetReverse(holaMundo);

        var stopWatch = Stopwatch.StartNew();
        string result = NaiveReverse(holaMundo);
        ("Naive Ticks: " + stopWatch.ElapsedTicks).Dump();

        stopWatch.Restart();
        result = Reverse(holaMundo);
        ("Efficient linear Ticks: " + stopWatch.ElapsedTicks).Dump();

        stopWatch.Restart();
        result = RecursiveReverse(holaMundo);
        ("Recursive Ticks: " + stopWatch.ElapsedTicks).Dump();

        stopWatch.Restart();
        result = DotNetReverse(holaMundo);
        ("DotNet Reverse Ticks: " + stopWatch.ElapsedTicks).Dump();
    }
} 
```

**输出**

**尺寸：10**

```
Naive Ticks: 1
Efficient linear Ticks: 0
Recursive Ticks: 2
DotNet Reverse Ticks: 1 
```

**尺寸：100**

```
Naive Ticks: 2
Efficient linear Ticks: 1
Recursive Ticks: 12
DotNet Reverse Ticks: 1 
```

**尺寸：1000**

```
Naive Ticks: 5
Efficient linear Ticks: 2
Recursive Ticks: 358
DotNet Reverse Ticks: 9 
```

**尺寸：10000**

```
Naive Ticks: 32
Efficient linear Ticks: 28
Recursive Ticks: 84808
DotNet Reverse Ticks: 33 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2018-12-06T09:37:43.823

最简单的方法：

```
string reversed = new string(text.Reverse().ToArray()); 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2014-01-28T18:40:40.723

基于堆栈的解决方案。

```
 public static string Reverse(string text)
    {
        var stack = new Stack<char>(text);
        var array = new char[stack.Count];

        int i = 0;
        while (stack.Count != 0)
        {
            array[i++] = stack.Pop();
        }

        return new string(array);
    } 
```

或者

```
 public static string Reverse(string text)
    {
        var stack = new Stack<char>(text);
        return string.Join("", stack);
    } 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-10-23T00:53:26.607

不得不提交一个递归示例：

```
private static string Reverse(string str)
{
    if (str.IsNullOrEmpty(str) || str.Length == 1)
        return str;
    else
        return str[str.Length - 1] + Reverse(str.Substring(0, str.Length - 1));
} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2011-02-03T19:57:10.227

怎么样：

```
 private string Reverse(string stringToReverse)
    {
        char[] rev = stringToReverse.Reverse().ToArray();
        return new string(rev); 
    } 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2014-06-30T21:31:58.203

我从[Microsoft.VisualBasic.Strings](http://referencesource.microsoft.com/#Microsoft.VisualBasic/Strings.vb)制作了一个 C# 端口。我不确定他们为什么将这些有用的函数（来自 VB）保留在 Framework 中的 System.String 之外，但仍在 Microsoft.VisualBasic 下。财务功能的相同场景（例如`Microsoft.VisualBasic.Financial.Pmt()`）。

```
public static string StrReverse(this string expression)
{
    if ((expression == null))
        return "";

    int srcIndex;

    var length = expression.Length;
    if (length == 0)
        return "";

    //CONSIDER: Get System.String to add a surrogate aware Reverse method

    //Detect if there are any graphemes that need special handling
    for (srcIndex = 0; srcIndex <= length - 1; srcIndex++)
    {
        var ch = expression[srcIndex];
        var uc = char.GetUnicodeCategory(ch);
        if (uc == UnicodeCategory.Surrogate || uc == UnicodeCategory.NonSpacingMark || uc == UnicodeCategory.SpacingCombiningMark || uc == UnicodeCategory.EnclosingMark)
        {
            //Need to use special handling
            return InternalStrReverse(expression, srcIndex, length);
        }
    }

    var chars = expression.ToCharArray();
    Array.Reverse(chars);
    return new string(chars);
}

///<remarks>This routine handles reversing Strings containing graphemes
/// GRAPHEME: a text element that is displayed as a single character</remarks>
private static string InternalStrReverse(string expression, int srcIndex, int length)
{
    //This code can only be hit one time
    var sb = new StringBuilder(length) { Length = length };

    var textEnum = StringInfo.GetTextElementEnumerator(expression, srcIndex);

    //Init enumerator position
    if (!textEnum.MoveNext())
    {
        return "";
    }

    var lastSrcIndex = 0;
    var destIndex = length - 1;

    //Copy up the first surrogate found
    while (lastSrcIndex < srcIndex)
    {
        sb[destIndex] = expression[lastSrcIndex];
        destIndex -= 1;
        lastSrcIndex += 1;
    }

    //Now iterate through the text elements and copy them to the reversed string
    var nextSrcIndex = textEnum.ElementIndex;

    while (destIndex >= 0)
    {
        srcIndex = nextSrcIndex;

        //Move to next element
        nextSrcIndex = (textEnum.MoveNext()) ? textEnum.ElementIndex : length;
        lastSrcIndex = nextSrcIndex - 1;

        while (lastSrcIndex >= srcIndex)
        {
            sb[destIndex] = expression[lastSrcIndex];
            destIndex -= 1;
            lastSrcIndex -= 1;
        }
    }

    return sb.ToString();
} 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2015-06-19T11:13:04.200

很抱歉在这个旧线程上发帖。我正在为面试练习一些代码。

这就是我为 C# 想到的。我在重构之前的第一个版本很糟糕。

```
static String Reverse2(string str)
{
    int strLen = str.Length, elem = strLen - 1;
    char[] charA = new char[strLen];

    for (int i = 0; i < strLen; i++)
    {
        charA[elem] = str[i];
        elem--;
    }

    return new String(charA);
} 
```

与下面的`Array.Reverse`方法相比，字符串中的 12 个字符或更少字符看起来更快。在 13 个字符之后，`Array.Reverse`开始变得更快，并且最终在速度上占主导地位。我只是想大致指出速度开始变化的地方。

```
static String Reverse(string str)
{     
    char[] charA = str.ToCharArray();

    Array.Reverse(charA);

    return new String(charA);
} 
```

在字符串中有 100 个字符时，它比我的版本 x 4 快。但是，如果我知道字符串总是少于 13 个字符，我会使用我制作的那个。

测试完成了`Stopwatch`5000000 次迭代。此外，我不确定我的版本是否处理代理或组合字符情况与`Unicode`编码。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2019-08-20T15:48:55.257

由于我喜欢几个答案 - 一个用于使用`string.Create`，因此具有高性能和低分配，另一个用于正确性 - 使用`StringInfo`该类，我决定需要一种组合方法。这是最终的字符串反转方法:)

```
private static string ReverseString(string str)
    {
        return string.Create(str.Length, str, (chars, state) =>
        {
            var enumerator = StringInfo.GetTextElementEnumerator(state);
            var position = state.Length;
            while (enumerator.MoveNext())
            {
                var cluster = ((string)enumerator.Current).AsSpan();
                cluster.CopyTo(chars.Slice(position - cluster.Length));
                position -= cluster.Length;
            }
        });
    } 
```

还有一种更好的方法是使用 StringInfo 类的方法，该方法通过仅返回索引来跳过枚举器分配的大量字符串。

```
private static string ReverseString(string str)
    {
        return string.Create(str.Length, str, (chars, state) =>
        {
            var position = 0;
            var indexes = StringInfo.ParseCombiningCharacters(state); // skips string creation
            var stateSpan = state.AsSpan();
            for (int len = indexes.Length, i = len - 1; i >= 0; i--)
            {
                var index = indexes[i];
                var spanLength = i == len - 1 ? state.Length - index : indexes[i + 1] - index;
                stateSpan.Slice(index, spanLength).CopyTo(chars.Slice(position));
                position += spanLength;
            }
        });
    } 
```

与 LINQ 解决方案相比的一些基准测试：

```
String length 20:

LINQ                       Mean: 2,355.5 ns   Allocated: 1440 B
string.Create              Mean:   851.0 ns   Allocated:  720 B
string.Create with indexes Mean:   466.4 ns   Allocated:  168 B

String length 450:

LINQ                          Mean: 34.33 us   Allocated: 22.98 KB
string.Create                 Mean:   19.13 us   Allocated: 14.98 KB
string.Create with indexes    Mean:   10.32 us   Allocated: 2.69 KB 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-10-23T00:41:32.900

“更好的方法”取决于您的情况、性能、优雅、可维护性等对您来说更重要的是什么。

无论如何，这是一种使用 Array.Reverse 的方法：

```
string inputString="The quick brown fox jumps over the lazy dog.";
char[] charArray = inputString.ToCharArray(); 
Array.Reverse(charArray); 

string reversed = new string(charArray); 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2012-02-16T07:21:35.207

如果它曾经在一次采访中出现并且你被告知你不能使用 Array.Reverse，我认为这可能是最快的之一。它不会创建新字符串并且只迭代数组的一半以上（即 O(n/2) 次迭代）

```
 public static string ReverseString(string stringToReverse)
    {
        char[] charArray = stringToReverse.ToCharArray();
        int len = charArray.Length-1;
        int mid = len / 2;

        for (int i = 0; i < mid; i++)
        {
            char tmp = charArray[i];
            charArray[i] = charArray[len - i];
            charArray[len - i] = tmp;
        }
        return new string(charArray);
    } 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2014-01-29T12:19:52.267

如果你有一个只包含 ASCII 字符的字符串，你可以使用这个方法。

```
 public static string ASCIIReverse(string s)
    {
        byte[] reversed = new byte[s.Length];

        int k = 0;
        for (int i = s.Length - 1; i >= 0; i--)
        {
            reversed[k++] = (byte)s[i];
        }

        return Encoding.ASCII.GetString(reversed);
    } 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2014-10-09T05:51:45.793

首先，您必须了解的是 str+= 将调整您的字符串内存的大小，以便为 1 个额外的字符腾出空间。这很好，但如果你有一本 1000 页的书要反转，这将需要很长时间才能执行。

有些人可能建议的解决方案是使用 StringBuilder。当您执行 += 时，字符串生成器所做的是它分配更大的内存块来保存新字符，以便每次添加字符时都不需要重新分配。

如果您真的想要一个快速且最小的解决方案，我建议您执行以下操作：

```
 char[] chars = new char[str.Length];
            for (int i = str.Length - 1, j = 0; i >= 0; --i, ++j)
            {
                chars[j] = str[i];
            }
            str = new String(chars); 
```

在此解决方案中，初始化 char[] 时分配一次初始内存，而字符串构造函数从 char 数组构建字符串时分配一次。

在我的系统上，我为您运行了一个反转 2 750 000 个字符的字符串的测试。以下是 10 次执行的结果：

StringBuilder：190K - 200K 滴答声

字符数组：130K - 160K 滴答声

我还对普通 String += 进行了测试，但 10 分钟后我放弃了它，没有输出。

但是，我还注意到对于较小的字符串，StringBuilder 更快，因此您必须根据输入来决定实现。

干杯

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2015-10-29T11:58:58.193

```
public static string reverse(string s) 
{
    string r = "";
    for (int i = s.Length; i > 0; i--) r += s[i - 1];
    return r;
} 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2020-10-07T18:24:00.417

如果有人询问字符串反转，其意图可能是找出您是否知道任何按位运算，如 XOR。在 C# 中，您有 Array.Reverse 函数，但是，您可以在几行代码中使用简单的 XOR 操作（最少）

```
 public static string MyReverse(string s)
    {
        char[] charArray = s.ToCharArray();
        int bgn = -1;
        int end = s.Length;
        while(++bgn < --end)
        {
            charArray[bgn] ^= charArray[end];
            charArray[end] ^= charArray[bgn];
            charArray[bgn] ^= charArray[end];
        }
        return new string(charArray);
    } 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2012-04-27T06:21:53.520

```
public static string Reverse2(string x)
        {
            char[] charArray = new char[x.Length];
            int len = x.Length - 1;
            for (int i = 0; i <= len; i++)
                charArray[i] = x[len - i];
            return new string(charArray);
        } 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2013-02-21T16:09:06.507

```
private static string Reverse(string str)
        {
            string revStr = string.Empty;
            for (int i = str.Length - 1; i >= 0; i--)
            {
                revStr += str[i].ToString();
            }
            return revStr;
        } 
```

**比上述方法快**

```
private static string ReverseEx(string str)
        {
            char[] chrArray = str.ToCharArray();
            int len = chrArray.Length - 1;
            char rev = 'n';
            for (int i = 0; i <= len/2; i++)
            {
                rev = chrArray[i];
                chrArray[i] = chrArray[len - i];
                chrArray[len - i] = rev;
            }
            return new string(chrArray);
        } 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2016-05-31T08:59:44.370

有多种方法可以反转字符串，我在下面展示了其中的 3 种。

-- 使用 Array.Reverse 函数。

```
 private static string ReverseString1(string text)
    {
        char[] rtext = text.ToCharArray();
        Array.Reverse(rtext);
        return new string(rtext);
    } 
```

-- 仅使用字符串

```
 private static string ReverseString2(string text)
    {
        String rtext = "";
        for (int i = text.Length - 1; i >= 0; i--)
        {
            rtext = rtext + text[i];
        }
        return rtext;
    } 
```

-- 只使用 char 数组

```
 public static string ReverseString3(string str)
    {
        char[] chars = str.ToCharArray();
        char[] rchars = new char[chars.Length];
        for (int i = 0, j = str.Length - 1; i < chars.Length; i++, j--)
        {
            rchars[j] = chars[i];
        }
        return new string(rchars);
    } 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2016-09-21T17:05:35.620

就这么简单：

```
string x = "your string";       
string x1 = "";
for(int i = x.Length-1 ; i >= 0; i--)
    x1 += x[i];
Console.WriteLine("The reverse of the string is:\n {0}", x1); 
```

查看[输出](https://dotnetfiddle.net/6UTpZV)。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2017-11-02T16:35:16.700

这是该函数的 unicode 安全版本，编写为可以安全处理 unicode 的扩展。它接近标记的完整答案，但不会为“无效的高代理字符”抛出异常。

```
public static class StringExtensions
{
    public static string Reverse(this string s)
    {
        var info = new StringInfo(s);
        var charArray = new char[s.Length];
        var teIndices = StringInfo.ParseCombiningCharacters(s).Reverse();

        int j = 0;
        foreach(var i in  teIndices)
        {
            if (char.IsHighSurrogate(s[i]))
            {
                charArray[j] = s[i];
                j++;
                charArray[j] = s[i+1];
            }
            else
            {
                charArray[j] = s[i];
            }
            j++;
        }

        return new string(charArray);

    }
} 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2018-02-14T17:18:41.257

如何使用子字符串

```
static string ReverseString(string text)
{
    string sub = "";
    int indexCount = text.Length - 1;
    for (int i = indexCount; i > -1; i--)
    {
        sub = sub + text.Substring(i, 1);
    }
    return sub;
} 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2019-07-24T07:02:58.790

使用 LINQ 的聚合函数

```
string s = "Karthik U";
s = s.Aggregate(new StringBuilder(), (o, p) => o.Insert(0, p)).ToString(); 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2020-04-02T17:29:04.053

处理所有类型的 unicode 字符

使用 System.Globalization；

```
 public static string ReverseString(this string content) {

        var textElementEnumerator = StringInfo.GetTextElementEnumerator(content);

        var SbBuilder = new StringBuilder(content.Length);

        while (textElementEnumerator.MoveNext()) {
            SbBuilder.Insert(0, textElementEnumerator.GetTextElement());
        }

        return SbBuilder.ToString();
    } 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2014-03-12T19:15:21.880

```
 string original = "Stack Overflow";
    string reversed = new string(original.Reverse().ToArray()); 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2019-06-26T12:17:24.603

```
static void Main(string[] args)
{
    string str = "";
    string reverse = "";
    Console.WriteLine("Enter the value to reverse");
    str = Console.ReadLine();
    int length = 0;
    length = str.Length - 1;
    while(length >= 0)
    {
        reverse = reverse + str[length];
        length--;
    }
    Console.Write("Reverse string is {0}", reverse);
    Console.ReadKey();
} 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2019-07-11T05:18:36.337

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    class Program
    {     
        public static string ReverseString(string str)
        {
            int totalLength = str.Length;
            int iCount = 0;
            string strRev = string.Empty;
            iCount = totalLength;
            while (iCount != 0)
            {
                iCount--;
                strRev += str[iCount]; 
            }
            return strRev;
        }
        static void Main(string[] args)
        {
            string str = "Punit Pandya";
            string strResult = ReverseString(str);
            Console.WriteLine(strResult);
            Console.ReadLine();
        }
    }

  } 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2013-12-13T10:33:36.020

```
string A = null;
//a now is reversed and you can use it
A = SimulateStrReverse.StrReverse("your string");

public static class SimulateStrReverse
{
    public static string StrReverse(string expression)
    {
        if (string.IsNullOrEmpty(expression))
            return string.Empty;

        string reversedString = string.Empty;
        for (int charIndex = expression.Length - 1; charIndex >= 0; charIndex--)
        {
            reversedString += expression[charIndex];
        }
        return reversedString;
    }
} 
```

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2016-09-08T20:58:21.627

我在面试中被问到类似的问题。这是我的回应，尽管它的性能可能不如其他答案那么快。我的问题被表述为“创建一个可以具有向后打印字符串的方法的类”：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace BackwardsTest
{
    class PrintBackwards
    {
        public static void print(string param)
        {
            if (param == null || param.Length == 0)
            {
                Console.WriteLine("string is null");
                return;
            }
            List<char> list = new List<char>();
            string returned = null;
            foreach(char d in param)
            {
                list.Add(d);
            }
            for(int i = list.Count(); i > 0; i--)
            {
                returned = returned + list[list.Count - 1];
                list.RemoveAt(list.Count - 1);
            }
            Console.WriteLine(returned);
        }
    }
    class Program
    {
        static void Main(string[] args)
        {
            string test = "I want to print backwards";
            PrintBackwards.print(test);
            System.Threading.Thread.Sleep(5000);
        }
    }
} 
```

* * *

## 回答 #45

> 赞同：-2
> 
> 时间：2018-05-14T19:33:08.087

这是用于反向字符串的代码

```
public Static void main(){
    string text = "Test Text";
    Console.Writeline(RevestString(text))
}

public Static string RevestString(string text){
    char[] textToChar = text.ToCharArray();
    string result= string.Empty;
    int length = textToChar .Length;
    for (int i = length; i > 0; --i)
    result += textToChar[i - 1];
    return result;
} 
```

* * *

## 回答 #46

> 赞同：-3
> 
> 时间：2018-05-18T13:58:32.007

这很简单

```
static void Reverse()
    {
        string str = "PankajRawat";
        var arr = str.ToCharArray();
        for (int i = str.Length-1; i >= 0; i--)
        {
            Console.Write(arr[i]);
        }
    } 
```

* * *

## 回答 #47

> 赞同：-4
> 
> 时间：2010-03-13T20:02:38.287

```
public string rev(string str)
{
    if (str.Length <= 0)
        return string.Empty;
    else
        return str[str.Length-1]+ rev(str.Substring(0,str.Length-1));
} 
```

* * *

## 回答 #48

> 赞同：-5
> 
> 时间：2014-11-27T13:26:20.217

甚至不使用新字符串来反转字符串。让我们说

```
String input  = "Mark Henry";
//Just to convert into char array. One can simply take input in char array.
Char[] array = input.toCharArray(input);
int a = input.length;

for(int i=0; i<(array.length/2 -1) ; i++)
{
    array[i] = array[i] + array[a];
    array[a] = array[i] - array[a];
    array[i] = array[i] - array[a--];
} 
```

* * *

## 回答 #49

> 赞同：-9
> 
> 时间：2014-03-14T20:32:50.577

`SELECT REVERSE('somestring');` 完毕。

# nlp - 自然语言/文本挖掘和 Reddit/社会新闻网站

> ID：228042
> 
> 赞同：3
> 
> 时间：2008-10-23T00:32:49.597
> 
> 标签：nlp, information-retrieval, text-mining

我认为有大量与 reddit、digg 或 news.google.com 等网站相关的自然语言数据。

我对文本挖掘进行了一些研究，但找不到如何使用这些工具来解析 reddit 之类的东西。

你能想出什么样的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T00:56:35.010

我过去发现，在 Reddit 或 Digg 等网站上挖掘数据的最佳方法是首先使用他们提供的开发人员 API。通常，您对某个主题或趋势都非常感兴趣，而获取该数据的唯一方法是通过已建立的公共界面。您还可以解析提要，并将它们结合起来以发现您想知道的 90% 的内容。如果您想对无法通过 API 获得的数据进行深入研究，那么您应该准备好花费大量时间围绕 cURL 之类的工具编写自定义包装器。如果你有预算，你也可以打电话给他们，询问他们是否提供关于用户的付费研究数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T00:55:32.653

我会从[RSS](http://www.reddit.com/.rss)开始，然后我可能会使用[Nutch](http://lucene.apache.org/nutch/)；实际如何处理数据更多的是您的电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T15:00:47.160

这些都是好主意。我可以获取数据，但是可以围绕它构建哪些应用程序？

# windows - 有人使用他们会推荐给其他人的第三方 Windows 注册表编辑器吗？

> ID：228073
> 
> 赞同：3
> 
> 时间：2008-10-23T00:44:45.157
> 
> 标签：windows, registry

我几乎每天都使用 Windows 注册表编辑器 (regedit.exe)，偶尔发现自己希望它有更多的功能。

例如，如果它有：

*   一种导入和导出收藏夹的方法。
*   一种高级搜索功能，它列出了它找到的所有键，而不是简单的查找功能。如果有一种方法可以在您键入时缩小结果范围，那就太好了，但是是的，我意识到我可能要求很多。
*   我最近访问的密钥列表（历史）

所以本质上，我只是在寻找基于现有 regedit 功能集的可靠第三方工具。我对免费和商业解决方案都感兴趣。

以前的开发人员推荐让我发现了像[Notepad++](http://notepad-plus.sourceforge.net)和[RegexBuddy](http://www.regexbuddy.com/)这样的优秀工具，所以我真的很期待你的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T00:00:15.933

除了其他人建议的应用程序之外，您还可以考虑学习一些有关[Windows PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)的知识。PowerShell 的注册表提供程序允许使用其强大的脚本语言访问注册表，因此您可以为一些常见问题编写脚本解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T01:21:49.543

也许这符合您的喜好：Registry Workshop [http://www.torchsoft.com/en/rw_information.html](http://www.torchsoft.com/en/rw_information.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T01:20:32.637

这些程序可能值得一看：

[http://resplendent-registrar.findmysoft.com/](http://resplendent-registrar.findmysoft.com/)

我不能保证它们（没有使用它们），但它们可能会满足您的需求。

# c - 高效的堆管理器，用于处理大量流失、微小的分配？

> ID：228081
> 
> 赞同：8
> 
> 时间：2008-10-23T00:48:19.283
> 
> 标签：c, performance, memory-management, lua, heap-memory

我正在寻找堆管理器的想法来处理非常具体的情况：很多非常小的分配，每个分配范围从 12 到 64 字节。任何更大的东西，我都会传递给常规的堆管理器，所以只需要处理小块。只需要 4 字节对齐。

我主要担心的是

1.  高架。常规的 libc 堆通常会将分配四舍五入为 16 字节的倍数，然后添加另一个 16 字节标头 - 这意味着 20 字节分配的开销超过 50%，这很糟糕。
2.  表现

一个有用的方面是 Lua（它是这个堆的用户）会在调用 free() 时告诉你它正在释放的块的大小——这可能会启用某些优化。

我会发布我目前的方法，它工作正常，但如果可能的话，我想改进它。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T00:55:02.953

可以构建一个对大小相同的对象非常有效的堆管理器。您可以为所需的每种大小的对象创建其中一个堆，或者如果您不介意使用一点空间，则为 16 字节对象创建一个，为 32 字节对象创建一个，为 64 个字节创建一个。最大开销为31 字节分配 33 字节（将在 64 块大小的堆上进行）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-23T01:10:08.600

为了扩展 Greg Hewgill 所说的，实现超高效的固定大小堆的一种方法是：

1.  将大缓冲区拆分为节点。节点大小必须至少为 sizeof(void*)。
2.  使用每个空闲节点的第一个 sizeof(void*) 字节作为链接指针，将它们串在一起形成一个单链表（“空闲列表”）。分配的节点不需要链接指针，因此每个节点的开销为 0。
3.  通过删除列表的头部并返回它来分配（2 个加载，1 个存储）。
4.  通过在列表头部插入来释放（1 个加载，2 个存储）。

显然，第 3 步还必须检查列表是否为空，如果是，则需要进行大量工作以获取新的大缓冲区（或失败）。

正如 Greg D 和 hazzen 所说，更有效的是通过递增或递减指针（1 次加载，1 次存储）进行分配，而根本不提供释放单个节点的方法。

编辑：在这两种情况下，免费都可以处理“我在常规堆管理器上传递的任何更大的东西”的复杂性，因为您可以在调用 free 时恢复大小。否则，您将查看一个标志（每个节点的开销可能为 4 个字节），或者在您使用的缓冲区的某种记录中查找。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T01:02:15.370

答案可能取决于这些对象的生命周期模式。如果对象在您继续进行时全部实例化，然后一举全部删除，则创建一个非常简单的堆管理器可能有意义，该堆管理器通过简单地递增指针来分配内存。然后，当你完成后，吹走整个堆。

Raymond Chen 发表了一篇[有趣的文章](http://blogs.msdn.com/oldnewthing/archive/2005/05/19/420038.aspx)，可能对您有所启发。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T02:20:16.947

我喜欢onebyones的回答。

您也可以考虑为您的固定大小堆集使用[伙伴系统。](http://en.wikipedia.org/wiki/Buddy_memory_allocation)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T01:05:38.313

如果在进行下一轮分配之前分配、使用和释放了一堆内存，我建议使用最简单的分配器：

```
typedef struct _allocator {
    void* buffer;
    int start;
    int max;
} allocator;

void init_allocator(size_t size, allocator* alloc) {
    alloc->buffer = malloc(size);
    alloc->start = 0;
    alloc->max = size;
}

void* allocator_malloc(allocator* alloc, size_t amount) {
    if (alloc->max - alloc->start < 0) return NULL;
    void* mem = alloc->buffer + alloc->start;
    alloc->start += bytes;
    return mem;
}

void allocator_free(allocator* alloc) {
    alloc->start = 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-28T04:30:56.610

我主要使用 O(1) 小块内存管理器 (SBMM)。基本上它是这样工作的：

1) 它从操作系统分配更大的超级块，并将开始+结束地址作为一个范围进行跟踪。SuperBlock 的大小是可调的，但 1MB 是一个相当不错的大小。

2) 超级块被分成块（大小也可调节……4K-64K 好，具体取决于您的应用程序）。这些块中的每一个都处理特定大小的分配，并将块中的所有项目存储为单链表。当你分配一个 SuperBlock 时，你会创建一个 Free Blocks 的链表。

3) 分配一个项目意味着 A) 检查是否有一个带有空闲项目的块处理该大小 - 如果没有，则从超级块分配一个新块。B) 从块的空闲列表中删除该项目。

4) 通过地址释放项目意味着 A) 找到包含地址的超级块 (*) B) 在超级块中找到块（减去超级块的起始地址并除以块大小） C) 将项目推回到块的空闲项目列表中。

正如我所说，这个 SBMM 非常快，因为它以 O(1) 的性能 (*) 运行。在我实现的版本中，我使用了一个 AtomicSList（类似于 Windows 中的 SLIST），因此它不仅是 O(1) 性能，而且在实现中还有 ThreadSafe 和 LockFree。如果您愿意，您实际上可以使用 Win32 SLIST 来实现该算法。

有趣的是，从 SuperBlocks 分配 Blocks 或从 Blocks 分配项目的算法导致几乎相同的代码（它们都是 O(1) 的空闲列表分配）。

(*) SuperBlocks 排列在一个范围图中，平均性能为 O(1)（但在 N 是 SuperBlocks 数量的最坏情况下可能存在 O(Lg N)）。范围图的宽度取决于大致了解您需要多少内存才能获得 O(1) 性能。如果你过冲，你会浪费一点内存，但仍然可以获得 O(1) 性能。如果您低于目标，您将接近 O(Lg N) 性能，但 N 用于 SuperBlock 计数 - 而不是项目计数。由于 SuperBlock 计数与 Item 计数相比非常低（在我的代码中大约是 20 个二进制数量级），因此它不像分配器的其余部分那么重要。

# saml - 如何反序列化 Rampart/C (Axis2/C) 中的 SAML 断言？

> ID：228082
> 
> 赞同：8
> 
> 时间：2008-10-23T00:48:24.837
> 
> 标签：saml, rampart, axis2c

我在 utf-8 缓冲区中有 SAML 1.1 和 SAML 1.0 响应`char *`，我想将它们转换为 Rampart/C`saml_response_t *`对象。我的问题是这样的：

`saml_response_t`从字符串创建的正确方法是什么？

理想情况下，我想要一个 C 代码示例来执行此操作，然后以正确的顺序处理各种解析器工具，因为 Axis2/C 关于如何释放内存有一些奇怪的想法。

我这样做的努力失败了，主要导致内存故障，但这就是我所拥有的。请记住，该`deserialize_buffer()`方法正如它所说的那样 - 将缓冲区转换为`axiom_node_t *`，但我也愿意替换它。

```
/* : get the raw XML from the SAML assertion */
xml_data = Tcl_GetStringFromObj (objv[2], &xml_length);

/* : parse the response XML for processing */
stream = gstream_mem_create (xml_data, xml_length);
node = Axis2_axiom_deserialize_buffer (env, stream);

/* : build a SAML response from the parsed XML */
saml_response = saml_response_create (env);
saml_response_build (saml_response, node, env);
arraylist = saml_response_get_assertions (saml_response, env);

/* : create our return value object */
obj = Tcl_NewListObj (0, NULL);

/* :- convert the SAML assertion into a string */
for (i = 0;
     i < axutil_array_list_size (arraylist, env);
         i++) {
    saml_assertion = (saml_assertion_t *) axutil_array_list_get (arraylist, env, i);
    if (saml_assertion != NULL) {
        assertion_node = saml_assertion_to_om (saml_assertion, NULL, env);

        element = Tcl_NewStringObj (axiom_node_to_string (node, env), -1);
        Tcl_ListObjAppendElement (interp, obj, element);

        axiom_node_free_tree (assertion_node, env);
    }
} 
```

# .net - 使用 .NET 的应用程序

> ID：228083
> 
> 赞同：3
> 
> 时间：2008-10-23T00:48:30.877
> 
> 标签：.net, asp.net, product

您最喜欢的应用程序、产品或您所知道的使用***.NET 或 Asp.NET***作为其底层平台的任何应用程序是什么？作为 .NET 商店，您知道哪些受欢迎的公司？

*这个问题与我见过的其他一些问题有关。所以我刚刚将这个作为社区维基，看看会有什么样的回应。*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T01:21:35.550

客户端应用

*   [油漆网](http://getpaint.net)
*   Windows Live 作家

* * *

开发者工具

*   [.Net 反射器](http://www.red-gate.com/products/reflector/)
*   表达混合

* * *

Asp.Net 应用程序：

*   涂鸦内容管理系统
*   社区服务器

* * *

Asp.Net 网站：

*   [http://myspace.com](http://myspace.com)
*   [http://stackoverflow.com](http://stackoverflow.com)
*   [http://blogs.msdn.com](http://blogs.msdn.com)
*   [http://thedailywtf.com](http://thedailywtf.com)
*   [http://NewEgg.com](http://NewEgg.com)
*   [http://microsoft.com](http://microsoft.com)
*   [http://dell.com](http://dell.com)
*   [http://match.com](http://match.com)
*   [http://monster.com](http://monster.com)
*   [http://constco.com](http://constco.com)
*   [http://NHS.com](http://NHS.com)
*   [http://HSN.com](http://HSN.com)
*   [http://LondonStockExchange.com](http://LondonStockExchange.com)
*   [http://lego.com](http://lego.com)
*   [http://realtor.com](http://realtor.com)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-23T01:00:59.820

Paint.net 使用 .net 框架，我相信它也是用 C# 编写的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T01:14:58.653

ASP.NET 网站的[*入门*](http://www.asp.net/get-started/)有一个“谁在使用 ASP.NET？” 部分，包括**MySpace** .com、**Dell** .com、**Match** .com、**Monster** .com、**Costco** .com、**Lego** .com 和**LondonStockExchange** .com。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-26T01:43:25.110

堆栈溢出就是一个很好的例子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-26T01:49:50.197

[远景打印](http://www.vistaprint.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T02:04:24.530

[Toronto.com](http://www.toronto.com)是使用 asp.net 开发的，它是加拿大多伦多最大的媒体网站之一。如果您愿意，可以阅读[案例研究](http://www.microsoft.com/canada/casestudies/torontodotcom.mspx)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-23T01:17:01.987

视窗媒体中心

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-14T16:32:28.960

[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)一个用于 .Net 开发的 IDE。

[Xobni](http://www.xobni.com/)，一个流行的 Outlook 插件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T10:44:16.117

Microsoft Dynamics CRM Microsoft Office SharePoint Server

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T01:44:26.003

SQL Server 管理工作室和 Paint.Net

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T01:51:13.667

[Cray, Inc - 超级计算机公司](http://www.cray.com/Home.aspx)- 顺便说一句。今天由 CX1 订购，它会很甜蜜....

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-23T01:28:39.483

我使用该平台创建的所有程序都是我的最爱:)

我真的不明白为什么编写哪个平台特定的应用程序很重要，只要它们以良好的方式执行它们的工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-14T16:19:33.493

对我来说，我每天使用的最常见的应用程序之一是 Quickbookx。

它也全部建立在 .NET 之上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-23T00:56:28.910

MySpace 可能是最大的 ASP.NET 站点之一。证明 ASP.NET 可以处理超大负载。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-23T01:07:21.023

ATI 催化剂驱动控制面板。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-12-14T16:36:19.403

很惊讶没有提到...

视觉工作室

# c# - 无法在动态添加的用户控件中获取文本框以保持状态

> ID：228089
> 
> 赞同：1
> 
> 时间：2008-10-23T00:50:44.070
> 
> 标签：c#, asp.net

我已经尝试过看似一切的东西 - 我以前做过很多次类似的事情，但我显然错过了一些东西。

我有一个 UserControl (ucA) - 在 ucA 上是一个 LinkBut​​ton，它以编程方式将不同的 UserControl (ucB) 加载到 ucA 上的面板中。ucB 有 TextBoxes 等。

为什么我的控制不能维持它的状态？即：文本框在回发时丢失了它们的值 - 控件树显示控件的名称，表单值显示值（在 trace.axd 中）

这是 ucA 的代码（基本上）

```
public int SlideCount
{
    get { return Convert.ToInt32(ViewState["SlideCount"]); }
    set { ViewState["SlideCount"] = value; }
}

protected void LinkButton1_Click(object sender, EventArgs e)
{
    SlideCount += 1;
    LoadSlideControls();
}

protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    LoadSlideControls();
}

private void LoadSlideControls()
{
    this.pnlAnnouncementHolder.Controls.Clear();
    for (int i = 0; i < SlideCount; i++)
    {
        this.pnlAnnouncementHolder.Controls.Add(
            LoadControl("AnnouncementSlide.ascx"));
    }
} 
```

这是我尝试做的完整示例：http: [//keithsblogs.com/ControlTest2.zip](http://keithsblogs.com/ControlTest2.zip)

Vyrotek 指出的问题是，控件在点击事件的生命周期中添加得有点晚——有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T01:27:31.467

我只是尝试重新创建您已设置的内容，但似乎没有遇到同样的问题。您希望我以某种方式向您发送我的解决方案吗？

最终编辑，我保证 -

试试这个解决方案：[http ://www.vyrotek.com/code/ControlTest2.zip](http://www.vyrotek.com/code/ControlTest2.zip)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T01:10:39.973

我在打字时安装速成版。到那时，为什么要清除单击按钮时的控件？您不能在单击链接时添加/加载 uc 控件吗？

通过这样做，您不会清除旧控件并且它们将保留该值。

# c# - HTTPListener 的自定义 URI？

> ID：228090
> 
> 赞同：0
> 
> 时间：2008-10-23T00:50:49.403
> 
> 标签：c#, .net, httplistener

有没有办法添加不是 http 或 https 的自定义前缀/URI？HTTPListener.Prefixes.Add 方法只接受 http:// 和 https:// 前缀。

如果我不需要的话，我只是不想重新创建这个类的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T04:03:19.080

你有什么想法？主要是，我对此表示怀疑；此外，它仍然只会处理 http[s]，那么为什么要混淆不同的方案名称呢？不过，您可以通过将其添加到前缀列表（例如“ [http://127.0.0.1:90/](http://127.0.0.1:90/) ”）来监听不同的端口。如果客户端使用正确的协议（http 与 https）连接到该端口，那么它可能会起作用 - 您只需在客户端做很多工作来告诉它如何处理该方案。

老实说，我不确定我是否明白这一点...

# html - How can I position a SPAN to be aligned to either side and above a TABLE?

> ID：228102
> 
> 赞同：3
> 
> 时间：2008-10-23T00:55:26.803
> 
> 标签：html, css, xhtml

```
<div>
<span>left</span>
<span>right</span>
<!-- new line break, so no more content on that line -->
<table> 
...
</table>
</div> 
```

How can I position those spans (they can be changed to any element) so that depending on how big the table is (not defined anywhere, and shouldn't be) the spans are positioned just on top of the left side of the table and the right side of the table.

Example:

```
a    b
table0
table1
table2

```

(where a is the left span, and b is the right span)

P.S. You can change anything bar inner table html.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T01:02:32.640

```
<style type="text/css">
    #wrapper, #top, #tableArea
     {
       width: 100%;
       padding: 10px;
       margin: 0px auto;
      }

     #top
      {
        padding: 0px;
      }

      #leftBox, #rightBox
      {
          margin: 0px;
          float: left;
          display: inline;
          clear: none;
       }

       #rightBox
        {
            float: right;
        }
     </style>
<div id="wrapper">
    <div id="top">
        <div id="leftBox">A</div>
        <div id="rightBox">b<</div>
    </div>
    <div id="tableArea">
        <table> ... </table>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T01:09:47.180

> Doesn't place them relatively, nor does Rob Allen's answer, they put them at the far reaches of the browser not, within the table width.

Well they are going to be bound by their container width and Rob's answer makes both the table and container width 100%.

The only solution I can think of off hand is to put in a row in your table with a single column (spanning all columns) and in that row have your floated DIVs.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-30T14:17:29.433

I ran into similar problem and I have found a solution. It doesn't depend on the width of the table but it is a little trickier. It works in every browser including IE5.5, IE6 and newer.

```
 <style>
  .tablediv {
  float:left; /* this is a must otherwise the div will take a full width of our page and this way it wraps only our content (so only the table)   */
  position:relative; /* we are setting this to start the trickie part */  
  padding-top:2.7em; /* we have to set the room for our spans, 2.7em is enough for two rows otherwise try to use something else; for one row e.g. 1.7em */
  }
  .leftspan {
  position:absolute; /* seting this to our spans will start our behaviour */
  top:0; /* we are setting the position where it will be placed inside the .tablediv */
  left:0;
  }
  .rightspan {
  position:absolute; 
  top:0; 
  right:0; 
  }
  </style>
<div class="tablediv">
 <span class="leftspan">Left text</span>
 <span class="rightspan">Right text <br /> with row</span>
  <table border="1">
   <tr><td colspan="3">Header</td></tr>
   <tr><td rowspan="2">Left content</td><td>Content</td><td rowspan="2">Right content</td></tr>
   <tr><td>Bottom content</td></tr>
  </table>
</div>
 <!-- If you don't want to float this on the right side of the table than you must use the clear style -->
 <p style="clear:both">
  something that continues under our tablediv
 </p> 
```

If you can't use a float for some reason, than you can use an alternative .tablediv style which I found by a mistake. Just replace the `float:left; to display:inline-block;` This works in all modern browser but not in IE7 and below.

Now you get my point and I'm sure you find any other solutions. Just don't forget that the .tablediv will be as long as the inner content. So placing a paragraph into it will cause to stretch to a bigger size than our table.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T01:01:23.440

if you have divs instead of span, try float:left for span a and float:right for span b

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T01:05:57.877

```
<div>
<div style="float:left">a</div><div style="float:right">b</div>
<br style="clear: both">
aaaaaaaaaaaaaaaaaaaaaaaaaaa<br />
aaaaaaaaaaaaaaaaaaaaaaaaaaa<br />
aaaaaaaaaaaaaaaaaaaaaaaaaaa<br />
</div> 
```

Doesn't place them relatively, nor does Rob Allen's answer, they put them at the far reaches of the browser not, within the table width.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T01:11:00.267

@MattMitchell, you might have something there. And then just use fload: left and float right I assume?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T03:06:47.867

I can't think of anyway, except to set the width of the table to something. In my case I choose 100%, which stretches to the width of the rapper at 50em:

```
<style type="text/css">
#wrapper {
    width: 1%;
    min-width:50em;
    padding: 10px;
}
#mainTable {
    width:100%;
}

#leftBox {
    float: left;
}

#rightBox {
    float: right;
}
</style>
<div id="wrapper">
    <div id="leftBox">A</div>
    <div id="rightBox">b</div>
    <br style="clear: both" />
    some text some text some text some text some text <br />
    some text some text some text some text some text <br />
    some text some text some text some text some text
    <table id="mainTable" border="1"><tr><td>test</td><td>test 2</td></tr></table>
</div> 
```

# delphi - 有谁知道好的德尔福对接组件？

> ID：228115
> 
> 赞同：7
> 
> 时间：2008-10-23T00:57:39.733
> 
> 标签：delphi, docking

我们想将可移动面板添加到应用程序中。目前我们已经使用了 DevExpress 对接库，但发现它们非常古怪且难以使用。它也有一些不太好的限制。

通过拖放自动隐藏、固定和移动页面都是我们想要使用的功能。

内置的 delphi 对接功能似乎不足以完成我们需要的事情（另见下面的示例）。也许我应该更深入地研究 delphi 的对接能力……我最初的印象是它们看起来非常面向工具栏，而不是我可以放入框架的东西。

我没有对接主题的经验。我唯一的经验是使用 DevExpress 停靠库，我需要在其中以编程方式创建和停靠面板。

[![截屏](https://i.stack.imgur.com/f8REv.gif)](https://i.stack.imgur.com/f8REv.gif)

是我的想象还是 DevExpress 的产品难以使用/学习？与 d2009 Ribbon Bar 相比，DevExpress Ribbon Bar 组件无疑是一个有用的体验。我将尽快迁移到 d2009 Ribbon Bar。学习和使用都非常简单。与 DevExpress 等价物相比形成鲜明对比。如果使用 DevExpress 等效项需要 4 倍的时间，那么是时候改变方向了。

关于对接库，*您*有什么建议？

感谢您的建议/意见！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T06:53:05.007

自动对接 [http://www.automatedqa.com/products/aqdocking/index.asp](http://www.automatedqa.com/products/aqdocking/index.asp)

并免费提供一个 JVCL Docking [http://jvcl.delphi-jedi.org/](http://jvcl.delphi-jedi.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T03:00:07.943

免责声明：我不是对接的忠实拥护者...但是...
您在 Delphi 中玩过很多对接吗？
如果它可以满足您的所有需求，请重新尝试 VCL ...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T14:16:27.077

AutomatedQA 的对接组件很棒。易于使用，良好的帮助，Visual Studio 2005 风格的对接提示等。我从 DevExpress 对接组件开始（我仍然喜欢 DevExpress 并使用很多他们的组件），但我认为 AutomatedQA 对接组件更易于使用且更可靠.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-09T16:51:58.757

LMD Innovative 有一个对接包 (http://www.lmdinnovative.com/products/vcl/lmddockpack/)。到目前为止没有使用/需要代码，但编译的示例运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T05:16:26.280

我很高兴阅读您的帖子，我正在使用自动化 QA 对接组件，我已经厌倦了它们。我正在考虑切换到 DevExpress，但我想我现在会再考虑一下。AutomatedQA 组件的最大问题是错误，有时浮动窗口会消失，当固定面板被取消固定时，诸如此类。

AutomatedQA 不提供体面的支持，并且不应期望每年发布新版本，即使您已经指出了可以轻松复制的错误。我怀疑对接框架在 AutomatedQA 中没有得到太多关注。

我想人们必须求助于内置的 VCL 或 JEDI，但我找不到任何有价值的示例（Delphi 附带的平庸对接示例并没有提供太多帮助），但我想这一定是可能的，毕竟他们使用这个构建Delphi...

有谁知道一个好的 JEDI 对接示例应用程序？

# linux - 加载多个不同版本的共享库

> ID：228117
> 
> 赞同：16
> 
> 时间：2008-10-23T00:59:00.823
> 
> 标签：linux, gcc, versioning, shared-libraries, dynamic-linking

我在 Linux 上有一个可执行文件，它加载`libfoo.so.1`（即 a `SONAME`）作为其依赖项之一（通过另一个共享库）。它还链接到另一个系统库，而后者又链接到**系统**版本`libfoo.so.2`. 结果，**两者** `libfoo.so.1`都在执行期间被加载，并且`libfoo.so.2`本应从版本 1 的库中调用函数的代码最终会从版本 2 的较新系统库中调用（二进制不兼容）函数，因为某些符号保持不变。结果通常是堆栈粉碎和随后的段错误。

现在，链接到旧版本的库是一个封闭源代码的第三方库，我无法控制`libfoo`它编译的版本。假设剩下的唯一选择是重建一堆当前链接到的系统库`libfoo.so.2`以链接到`libfoo.so.1`.

有没有办法避免用链接到旧的本地副本替换系统库`libfoo`？我可以加载这两个库并让代码调用正确版本的符号吗？所以我需要一些特殊的符号级版本控制？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-24T16:15:45.093

您也许可以做一些版本脚本技巧：

[http://sunsite.ualberta.ca/Documentation/Gnu/binutils-2.9.1/html_node/ld_26.html](http://sunsite.ualberta.ca/Documentation/Gnu/binutils-2.9.1/html_node/ld_26.html)

这可能需要您在 lib 周围编写一个包装器，该包装器会引入 libfoo.so.1，它显式地导出一些符号并将所有其他符号屏蔽为本地符号。例如：

MYSYMS { 全球： foo1; 富二；当地的： *; };

并在您链接该包装器时使用它，例如：

gcc -shared -Wl,--version-script,mysyms.map -o mylib wrapper.o -lfoo -L/path/to/foo.so.1

这应该使 libfoo.so.1 的符号对包装器本地化，并且对主 exe 不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T01:22:48.527

我只能想出一个变通办法。这将静态链接您正在使用的“系统库”版本。对于您的静态构建，您可以将其链接到与第三方库相同的旧版本。鉴于它不依赖于较新的版本...

或许也可以通过不以普通方式链接到第三方库来避免这些问题。相反，您的程序可以在执行时加载它。也许那时它可能会被其他人所掩盖。但我对此知之甚少。

# javascript - Javascript 百分比验证

> ID：228125
> 
> 赞同：11
> 
> 时间：2008-10-23T01:02:18.820
> 
> 标签：javascript, regex

我正在使用一个正则表达式来验证从 0 100 开始的百分比并允许两位小数。

有谁知道如何做到这一点或知道有用于 javascript 客户端验证的常见正则表达式示例的好网站？

@Tom - 感谢您的提问。理想情况下，不会有前导 0 或其他尾随字符。

感谢到目前为止所有回复的人。我发现评论真的很有趣。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-23T01:24:39.883

我不会为此使用正则表达式，而是简单地将用户输入的数字转换为浮点值，然后检查您想要的范围（0 到 100）。尝试使用正则表达式进行数字范围验证几乎总是错误的工具。

```
var x = parseFloat(str);
if (isNaN(x) || x < 0 || x > 100) {
    // value is out of range
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-23T06:18:37.807

我建议这个：

```
(^100(\.0{1,2})?$)|(^([1-9]([0-9])?|0)(\.[0-9]{1,2})?$) 
```

使用此部分匹配 100、100.0 和 100.00

```
^100(\.0{1,2})?$ 
```

和 0、15、99、3.1、21.67 等数字使用

```
^([1-9]([0-9])?|0)(\.[0-9]{1,2})?$ 
```

请注意禁止使用前导零，但允许使用尾随零（但不超过两位小数）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T07:14:14.123

这让我想起了Alex Papadimoulis的[一篇旧博客条目（来自](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)[WTF 日报](http://thedailywtf.com/)），他在其中讲述了以下故事：

> “一位客户要求我建造和安装一个定制的搁架系统。我正处于需要钉钉子的地步，但我不确定用什么来钉钉子。我应该使用旧鞋还是一个玻璃瓶？”
> 
> 你会如何回答这个问题？
> 
> 1.  这取决于。如果您想在干墙之类的东西上敲一个小钉子（20 磅），您会发现使用瓶子要容易得多，尤其是在鞋子脏了的情况下。但是，如果您想将沉重的钉子钉入木头，请使用鞋子：手里拿着破碎的瓶子。
>     
>     
> 2.  您的构建方式存在根本性的问题；你需要使用真正的工具。是的，它可能涉及到工具箱（甚至硬件商店）的旅行，但以正确的方式进行操作将在产品的整个生命周期中节省大量时间、金钱和恶化。在您了解建筑的基础知识之前，您需要停止为金钱而建造东西。

这是一个大多数人认为提出正确的正则表达式来解决问题的挑战，但最好说使用正则表达式是在使用错误的工具来完成这项工作。

尝试使用正则表达式验证数字范围时的问题是，如果允许范围的要求发生变化，则很难更改。今天的要求可能是验证 0 到 100 之间的数字，并且可以为不会让您流血的数字编写正则表达式。但下周要求可能会发生变化，因此允许 0 到 315 之间的值。祝你改变你的正则表达式好运。

Greg Hewgill 给出的解决方案可能更好——即使它将“99fxx”验证为“99”。但考虑到实际情况可能还可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T01:13:12.103

鉴于您的价值在 str

```
str.match(/^(100(\.0{1,2})?|([0-9]?[0-9](\.[0-9]{1,2})))$/) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T06:54:27.953

```
^100(\.(0){0,2})?$|^([1-9]?[0-9])(\.(\d{0,2}))?\%$ 
```

这将匹配：
100.00
可选的“1-9”后跟一个数字（这使得 int 部分），可选地后跟一个点和两个数字

* * *

据我所见，Greg Hewgill 的示例并不能很好地工作，因为*parseFloat('15x')*只会返回 15 ，这将匹配 0<x<100 条件。使用*[parseFloat](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.w3schools.com%2Fjsref%2Fjsref_parseFloat.asp&ei=WyEASZyqJJW60gW3gPnaDQ&usg=AFQjCNHdASnwFzqSOdqFdPtv6YVEgsOnIQ&sig2=8_OYmkVp4KfsSUCxngbKwA)*显然是错误的，因为它不验证百分比值，它试图强制验证。这里有些人抱怨前导零，有些人忽略尾随无效字符。也许问题的作者应该编辑它并明确他需要什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-10T06:39:39.133

如果您不是专门为讲英语的用户开发，我推荐这个：

```
[0-9]{1,2}((,|\.)[0-9]{1,10})?%? 
```

您只需将 10 替换为 2 即可获得两位小数。

我的示例将匹配：

```
15.5
5.4366%
1,43
50,55%
34
45% 
```

当然，这个输出更难投射，但这样的事情会做（Java代码）：

```
private static Double getMyVal(String myVal) {
    if (myVal.contains("%")) {
        myVal = myVal.replace("%", "");
    }
    if (myVal.contains(",")) {
        myVal = myVal.replace(',', '.');
    }
    return Double.valueOf(myVal);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T01:11:33.450

> `(100|[0-9]{1,2})(\.[0-9]{1,2})?`

那应该是你想要的正则表达式。我建议您阅读 Mastering Regular Expression 并下载 RegexBuddy 或 The Regex Coach。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T07:50:14.097

@mlarsen：不是说这里的正则表达式不会做得更好。

请记住，验证必须在客户端和服务器端完成，例如：

```
100|(([1-9][0-9])|[0-9])(\.(([0-9][1-9])|[1-9]))? 
```

将是跨语言检查，请注意检查输入长度与输出匹配长度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-04T07:25:49.173

```
(100(\.(0){1,2})?|([1-9]{1}|[0-9]{2})(\.[0-9]{1,2})?) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-10T17:10:28.983

上述解决方案都不适合我，因为我需要我的正则表达式来允许在用户输入 ex: '18' 时包含数字和小数的值。

此解决方案允许使用空字符串，因此用户可以删除他们的整个输入，并考虑上面阐明的其他规则。

`/(^$)|(^100(\.0{1,2})?$)|(^([1-9]([0-9])?|0)\.(\.[0-9]{1,2})?$)|(^([1-9]([0-9])?|0)(\.[0-9]{1,2})?$)/`

# design-patterns - Yegge 的原型模式示例如何处理实例变量？

> ID：228134
> 
> 赞同：6
> 
> 时间：2008-10-23T01:06:24.897
> 
> 标签：design-patterns, language-agnostic, prototype-pattern

我喜欢 Steve Yegge 的[原型模式示例](http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html)，并决定创建一个快速概念验证示例。

然而，我并没有真正考虑清楚。虽然它非常适合动态指定对象的行为并且是史蒂夫[固执己见的精灵](http://steve.yegge.googlepages.com/when-polymorphism-fails)示例的简单解决方案，但我仍在尝试找出处理实例变量的最佳方法。

例如，假设我有一个 AwesomeDragon 对象。然后我想制作一个 AwesomeDragonImmuneToFire 对象，因此我制作了 AwesomeDragon 的新子代（AwesomeDragonImmuneToFire 继承了 AwesomeDragon 的属性）并将“ImmuneToFire”作为值为“true”的属性。到现在为止还挺好。现在假设我想发送我的 AwesomeDragon 对象去参观附近的农村。这将涉及更新 AwesomeDragon 的“位置”属性。然而，当我这样做的那一刻 AwesomeDragonImmuneToFire 也会起飞。

是在创建对象时覆盖实例值的最佳解决方案，例如立即将 AwesomeDragonImmuneToFire 上的“位置”值“放置”到“位置”的当前“获取”值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T01:42:56.477

这不取决于您如何在系统中实际实现继承吗？

例如，在您所描述的 JavaScript 版本中，`prototype`for`AwesomeDragonImmuneToFire`通常是 an 的实例*，*`AwesomeDragon`并且由于您总是使用实例，因此您对任何特定的 做什么都没有关系`AwesomeDragon`：

```
function Dragon()
{
    this.position = "starting point";
}

function AwesomeDragon()
{
    this.awesome = true;
}
AwesomeDragon.prototype = new Dragon();

function AwesomeDragonImmuneToFire()
{
    this.immuneToFire = true;
}
AwesomeDragonImmuneToFire.prototype = new AwesomeDragon();

>>> var awesome = new AwesomeDragon();
>>> var immune = new AwesomeDragonImmuneToFire();
>>> awesome.position = "flying above village";
>>> immune.position;
"starting point"
>>> immune.awesome
true 
```

在这个例子中，没有类，所有的实例只是`Object`碰巧知道哪个函数被用来构造它们的实例。`new`只是[一点语法糖](http://javascript.crockford.com/prototypal.html)，将 StudlyCaps 用于构造函数只是对旨在与`new`.

关键是每个对象都有一个原型对象链，如果您尝试访问对象本身不包含的属性，则会根据 Yegge 对“属性模式”的描述进行检查。

[https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Details_of_the_Object_Model](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Details_of_the_Object_Model)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T20:53:49.007

> 这将涉及更新 AwesomeDragon 的“位置”属性。然而，当我这样做的那一刻 AwesomeDragonImmuneToFire 也会起飞。

也许我误解了，但我不确定你为什么认为 AwesomeDragonImmuneToFire 也会起飞。如果它们是两个不同的对象并且位置是对象的属性，那么每个实例（龙）将有自己的位置。改变一条龙的位置不应影响另一条龙的位置。

# security - XSS 攻击是否有可能获取 HttpOnly cookie？

> ID：228138
> 
> 赞同：20
> 
> 时间：2008-10-23T01:07:37.250
> 
> 标签：security, cookies, xss

阅读[这篇关于 HttpOnly cookie 的博文](http://www.codinghorror.com/blog/archives/001167.html)让我开始思考，是否有可能通过任何形式的 XSS 获得 HttpOnly cookie？Jeff 提到它“大大提高了标准”，但听起来好像它并不能完全防止 XSS。

除了并非所有浏览器都正确支持此功能这一事实之外，如果它们是 HttpOnly，黑客如何获取用户的 cookie？

我想不出任何办法让 HttpOnly cookie 将自己发送到另一个站点或被脚本读取，所以这似乎是一个安全的安全功能，但我总是惊讶于有些人可以轻松地解决许多问题安全层。

在我工作的环境中，我们只使用 IE，所以其他浏览器不是问题。我正在专门寻找其他可能成为不依赖于浏览器特定缺陷的问题的方法。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-08T01:18:46.173

首先，正如其他人提到的，XSS**可以**允许其他有效负载，而不仅仅是窃取 cookie。

但是，*有*没有办法通过 XSS 窃取 httpOnly cookie？（忽略 httpOnly 支持的问题？）.... 答案是：是的。
XSS 的一个子集称为[跨站点跟踪 (XST)](http://www.owasp.org/index.php/Cross_Site_Tracing)（或转到原始[研究论文](http://www.cgisecurity.com/whitehat-mirror/WhitePaper_screen.pdf)）。[这种攻击让 XSS 有效负载向 Web 服务器（或代理](http://www.securityfocus.com/archive/1/423028)，正向或反向）发送 HTTP TRACE 请求，该请求将向客户端回显完整的请求 - 包括您的 COOKIES，httpOnly 与否。然后 XSS 有效负载可以解析返回的信息，并检索那些美味的 cookie...

* * *

顺便说一句，XSS 的另一个“子集”（有点）涉及将有效负载注入响应标头。虽然类似，但这*并不完全是*XSS，而且标头注入甚至可以导致[HTTP 响应拆分 (HRS)](http://www.owasp.org/index.php/HTTP_Response_Splitting) - 它更强大，允许几乎完全控制其他客户端、缓存中毒，当然还可以访问 cookie，如果愿意的话。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T14:45:00.530

使用 HttpOnly cookie**将防止**XSS 攻击获取这些 cookie。

除非：

*   您的浏览器不支持 HttpOnly
*   浏览器中存在一个前所未有的漏洞，它破坏了 HttpOnly
*   服务器已被破坏（但无论如何你可能已经被水洗了）。

正如另一位发帖人所指出的：XSS 并不是唯一的威胁，抓取 cookie 也不是 XSS 的唯一威胁。我敢肯定你知道这一点——我只是完成了！

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T06:32:19.793

**如果浏览器不理解 HttpOnly，则攻击成功。** *编辑：好吧，你不担心。没关系，但我会留下此通知以供参考。明确说明它是有用的。*

除了嗅探网络之外的另一种窃取方式是直接控制用户的计算机。然后可以从文件中读取 cookie。如果是会话cookie，当然会在浏览器关闭后被删除。

顺便说一句，窃取会话 cookie 并不是 XSS 攻击唯一可能的“有效载荷”。例如，它可能会使您的 CSRF 保护失效。它可能会更改您网站的内容以欺骗用户。和许多其他恶意的东西。

所以最好以一种好的方式保护自己**（转义输出），**并将 HttpOnly 视为**额外**的保护层。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-23T01:19:08.020

数据包嗅探可以读取通过 http 传输的 cookie。但它可能不属于 XSS。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2010-05-27T17:47:05.200

JavaScript 可以修改页面上的 HTML，因此，httpOnly**并不*意味着***您可以安全地抵御 XSS。

# sharepoint - 如何以编程方式关闭共享点导航中的显示页面

> ID：228145
> 
> 赞同：4
> 
> 时间：2008-10-23T01:09:41.113
> 
> 标签：sharepoint, navigation, moss, spweb

我正在使用编程方式创建一个 SharePoint 网站

```
SPWeb spWeb = spSite.AllWebs.Add(...); 
```

我需要运行什么代码来设置 spWeb 以关闭“在导航中显示页面”选项？

**回答：**

```
publishingWeb.IncludePagesInNavigation = false; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T01:34:48.830

我不确定自己，但我能够找到[这个](http://msdn.microsoft.com/en-us/magazine/cc507633.aspx)：

> 修改导航是另一个常见的品牌任务，因为它会影响用户可以看到的内容以及他们如何通过站点层次结构进行操作。Microsoft.SharePoint.Publishing 命名空间公开了几个以发布站点基础结构为目标的类，例如 PublishingWeb 和 PublishingPage。使用这些类，我们可以轻松地修改每个站点的导航。如果您希望子 Web 在全局导航中显示为根级站点，请首先关闭从父站点的继承，如下所示：

```
publishingWeb.InheritGlobalNavigation = false; 
```

> 您可能还希望从全局导航中隐藏所有站点页面。将 IncludePagesInNavigation 设置为 false 会隐藏站点中的所有页面，无论 PublishingPage.IncludeInGlobalNavigation 属性是否设置为 true

```
// do not show pages in navigation
publishingWeb.IncludePagesInNavigation = false; 
```

> 如果您正在处理不从 PublishingWeb 继承的默认站点，仍然可以从全局导航栏中隐藏这些站点。例如，如果您使用协作门户模板创建网站集并希望从全局导航中排除新闻网站，请将该网站添加到该网站的 __GlobalNavigationExcludes 属性：

```
string globalNavExcludes = String.Empty;
SPWeb webSite = MSDNSiteCollection.RootWeb;
// _GlobalNavigationExcludes property contains a delimited string of 
// GUIDs identifying the Id of each site to be excluded from global
// navigation

if (webSite.AllProperties.ContainsKey("__GlobalNavigationExcludes")) {
  globalNavExcludes = 
    webSite.AllProperties["__GlobalNavigationExcludes"].ToString();
}

SPWeb newsSite = MSDNSiteCollection.AllWebs["News"];
// string is delimited "{GUID};{GUID};",
// use format code B to convert to string
globalNavExcludes += String.Concat(currentWeb.ID.ToString("B"), ";");

webSite.AllProperties["__GlobalNavigationExcludes"] = globalNavExcludes;
webSite.Update(); 
```

> 将导航节点直接添加到 SPNavigationNodeCollection 是仅显示所需节点以及对节点和指向外部站点的链接进行分组的好方法。图 10 显示了如何向全局导航栏添加内部链接、外部链接和标题。此示例解决了影响链接是否在新窗口中打开以及如何处理空 URL 的 SPNavigation 类的一些属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-11T07:46:33.957

对于 SP 2010，请使用以下...

publishingWeb.Navigation.GlobalIncludePages = false;

# design-patterns - 关于设计模式：什么时候应该使用单例？

> ID：228164
> 
> 赞同：523
> 
> 时间：2008-10-23T01:17:02.970
> 
> 标签：design-patterns, singleton

荣耀的全局变量 - 成为荣耀的全局类。有人说打破了面向对象的设计。

给我一些场景，除了使用单例的好旧记录器之外。

* * *

## 回答 #1

> 赞同：387
> 
> 时间：2008-10-23T02:53:19.093

在我寻求真相的过程中，我发现实际上很少有“可接受的”理由来使用单例。

在互联网上反复出现的一个原因是“日志记录”类（您提到过）。在这种情况下，可以使用 Singleton 来代替类的单个实例，因为项目中的每个类通常需要一遍又一遍地使用日志记录类。如果每个类都使用这个日志类，依赖注入就变得很麻烦。

日志记录是“可接受的”单例的一个具体示例，因为它不会影响代码的执行。禁用日志记录，代码执行保持不变。启用它，同样的。Misko 在[Root Cause of Singletons](http://misko.hevery.com/2008/08/25/root-cause-of-singletons/)中这样说，“这里的信息流向一种方式：从您的应用程序进入记录器。即使记录器是全局状态，由于没有信息从记录器流入您的应用程序，记录器是可以接受的。”

我敢肯定还有其他正当理由。Alex Miller 在“[我讨厌的模式](http://web.archive.org/web/20120603233658/http://tech.puredanger.com/2007/07/03/pattern-hate-singleton)”中谈到服务定位器和客户端 UI 也可能是“可接受的”选择。

[在 Singleton 阅读更多我爱你，但你让我失望了。](http://geekswithblogs.net/AngelEyes/archive/2013/09/08/singleton-i-love-you-but-youre-bringing-me-down-re-uploaded.aspx)

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2008-10-23T01:59:20.967

单身候选人必须满足三个要求：

*   控制对共享资源的并发访问。
*   系统的多个不同部分将请求对资源的访问。
*   只能有一个对象。

如果您提议的 Singleton 只有其中一个或两个要求，那么重新设计几乎总是正确的选择。

例如，打印机假脱机程序不太可能从多个位置（打印菜单）调用，因此您可以使用互斥锁来解决并发访问问题。

一个简单的记录器是一个可能有效的单例的最明显的例子，但是这可以随着更复杂的记录方案而改变。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2008-10-23T01:31:52.583

读取只应在启动时读取的配置文件并将它们封装在单例中。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-10-23T01:21:32.307

当您需要管理共享资源时，您可以使用单例。例如打印机后台处理程序。您的应用程序应该只有一个后台处理程序实例，以避免对同一资源的请求冲突。

或数据库连接或文件管理器等。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2008-10-23T01:35:04.197

存储一些全局状态（用户语言、帮助文件路径、应用程序路径）的只读单例是合理的。小心使用单例来控制业务逻辑 - 单几乎总是最终成为多个

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-10-23T01:19:35.663

管理与数据库的连接（或连接池）。

我也会用它来检索和存储外部配置文件的信息。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-23T02:05:51.017

在管理对整个应用程序共享的资源的访问时，应该使用单例，并且可能具有同一类的多个实例将是破坏性的。确保访问共享资源线程安全是这种模式至关重要的一个很好的例子。

使用单例时，您应该确保不会意外隐藏依赖项。理想情况下，单例（就像应用程序中的大多数静态变量一样）在执行应用程序的初始化代码期间设置（静态 void Main() 用于 C# 可执行文件，静态 void main() 用于 java 可执行文件），然后传递给所有其他需要它的实例化类。这有助于您保持可测试性。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-23T01:26:20.720

使用单例的一种方法是覆盖一个实例，其中必须有一个“代理”控制对资源的访问。单例在记录器中很不错，因为它们代理访问，比如说，一个文件，该文件只能被独占写入。对于诸如日志记录之类的东西，它们提供了一种将写入抽象到诸如日志文件之类的东西的方法-您可以将缓存机制包装到单例中，等等...

还可以考虑这样一种情况，您的应用程序具有许多窗口/线程/等，但需要单点通信。我曾经用一个来控制我希望我的应用程序启动的作业。单例负责序列化作业并将其状态显示给程序的任何其他感兴趣的部分。在这种情况下，您可以将单例视为在应用程序中运行的“服务器”类... HTH

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2011-05-23T20:19:51.767

我认为单例使用可以被认为与数据库中的多对一关系相同。如果您的代码中有许多不同的部分需要处理一个对象的单个实例，那么使用单例是有意义的。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-11-30T16:30:54.273

当您从数据库或文件加载配置属性对象时，将其作为单例会有所帮助；没有理由继续重新读取在服务器运行时不会更改的静态数据。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-12-21T00:10:03.623

可以在[Test::Builder](http://search.cpan.org/perldoc?Test::Builder)中找到一个单例的实际示例，该类支持几乎所有现代 Perl 测试模块。Test::Builder 单例存储和代理测试过程的状态和历史（历史测试结果，计算测试运行的数量）以及测试输出的去向。这些都是协调由不同作者编写的多个测试模块以在单个测试脚本中协同工作所必需的。

Test::Builder 的单例的历史具有教育意义。调用`new()`总是给你相同的对象。首先，所有数据都存储为类变量，对象本身没有任何内容。这一直有效，直到我想自己测试 Test::Builder。然后我需要两个 Test::Builder 对象，一个设置为虚拟对象，用于捕获和测试其行为和输出，另一个设置为真正的测试对象。那时 Test::Builder 被重构为一个真实的对象。单例对象被存储为类数据，并且`new()`总是返回它。 `create()`添加以制作新对象并启用测试。

目前，用户希望在自己的模块中更改 Test::Builder 的某些行为，但不理会其他行为，而测试历史记录在所有测试模块中保持相同。现在发生的事情是整体 Test::Builder 对象被分解成更小的部分（历史、输出、格式...），并由一个 Test::Builder 实例将它们收集在一起。现在 Test::Builder 不再必须是单例。它的组成部分，就像历史一样，可以。这将单例的不灵活必要性降低了一个级别。它为用户提供了更大的灵活性来混合搭配作品。较小的单例对象现在可以只存储数据，它们的包含对象决定如何使用它。它甚至允许非 Test::Builder 类通过使用 Test::Builder 历史记录和输出单例来发挥作用。

似乎在数据协调和行为灵活性之间存在推拉关系，可以通过将单例放在共享数据周围，尽可能减少行为以确保数据完整性，从而减轻这种关系。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2010-11-02T20:32:06.993

共享资源。特别是在 PHP 中，一个数据库类、一个模板类和一个全局变量 depot 类。所有这些都必须由在整个代码中使用的所有模块/类共享。

这是一个真正的对象使用 -> 模板类包含正在构建的页面模板，它被添加到页面输出的模块塑造、添加、更改。它必须作为单个实例保存，这样才能发生这种情况，数据库也是如此。使用共享数据库单例，所有模块的类都可以访问查询并获取它们，而无需重新运行它们。

全局变量库单例为您提供了一个全局、可靠且易于使用的变量库。它可以很好地整理您的代码。想象一下，将所有配置值放在一个单例中的数组中，例如：

`$gb->config['hostname']`

或在数组中包含所有语言值，例如：

`$gb->lang['ENTER_USER']`

在运行页面代码的最后，你会得到一个现在成熟的：

`$template`

单`$gb`例，具有用于替换其中的 lang 数组的单例，并且所有输出都已加载并准备就绪。您只需将它们替换为成熟模板对象的页面值中现在存在的键，然后将其提供给用户。

这样做的最大好处是你可以对任何东西进行任何你喜欢的后期处理。您可以将所有语言值通过管道传输到谷歌翻译或其他翻译服务并将它们取回，并将它们替换到它们的位置，例如翻译。或者，您可以根据需要替换页面结构或内容字符串。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-08-07T11:45:03.700

首先，让我们区分**Single Object**和**Singleton**。后者是前者*的许多*可能*实现*之一。而且 Single Object 的问题与 Singleton 的问题不同。单一对象本身并不是坏事，有时是做事的唯一方法。简而言之：

*   单个对象 - 我只需要程序中的一个对象实例
*   Singleton - 创建一个带有静态字段的类。添加返回此字段的静态方法。在第一次调用时懒惰地实例化一个字段。始终返回相同的对象。

```
public class Singleton {
    private static Singleton instance;

    private Singleton() {}

    public static Singleton instance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
} 
```

如您所见，规范形式的“单例”模式对测试不太友好。不过，这很容易解决：只需让 Singleton 实现一个接口。让我们称它为“可测试的单例”:)

```
public class Singleton implements ISingleton {
    private static Singleton instance;

    private Singleton() {}

    public static ISingleton instance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
} 
```

现在我们可以模拟 Singleton，因为我们通过接口使用它。其中一项索赔消失了。让我们看看我们是否可以摆脱另一个声明 - 共享全局状态。

如果我们剥离 Singleton 模式，其核心是关于延迟初始化：

```
public static ISingleton instance() {
    if (instance == null) {
        instance = new Singleton();
    }
    return instance;
} 
```

这就是它存在的全部原因。*这就是单对象模式*。我们把它拿走并放到工厂方法中，例如：

```
public class SingletonFactory {
    private static ISingleton instance;

    // Knock-knock. Single Object here
    public static ISingleton simpleSingleton() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
} 
```

与我们的可测试单例有什么区别？没有，因为这是单对象模式的本质——无论您将其实现为单例、工厂方法还是服务定位器都没有关系**。**你仍然有一些共享的全局状态。如果从多个线程访问它，这可能会成为一个问题。您将不得不进行`simpleSingleton()`同步并处理所有多线程问题。

再一次：无论您选择哪种方法，您都必须支付单一对象的价格。使用依赖注入容器只是将复杂性转移到必须处理单个对象的固有问题的框架上。

回顾：

1.  大多数提到 Singleton 的人都是指 Single Object
2.  实现它的流行方法之一是单例模式
3.  它有可以减轻的缺陷
4.  然而，Singleton 的大部分复杂性源于 Single Object 的复杂性
5.  无论您如何实例化单个对象，它仍然存在，无论是服务定位器、工厂方法还是其他东西
6.  您可以将复杂性转移到（希望）经过良好测试的 DI 容器
7.  有时使用 DI 容器很麻烦 - 想象一下为每个类注入一个 LOGGER

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-02-02T03:25:31.660

您可以在实现状态模式时使用 Singleton（以 GoF 书中所示的方式）。这是因为具体的 State 类没有自己的状态，并且根据上下文类执行它们的动作。

您还可以将 Abstract Factory 设为单例。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-23T01:33:20.130

正如每个人所说，共享资源 - 特别是无法处理并发访问的东西。

我见过的一个具体例子是 Lucene Search Index Writer。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-11-11T15:42:20.857

当您想确保一个类将具有一个实例并且该实例将具有对其的全局访问点时，您可以使用单例设计模式。

因此，假设您有一个应用程序需要数据库来处理 CRUD 操作。理想情况下，您将使用与数据库相同的连接对象来访问数据库并执行 CRUD 操作。

因此，为了确保数据库类有一个对象，并且在整个应用程序中都使用同一个对象，我们实现了单例设计模式。

确保您的构造函数是私有的，并且您提供了一个静态方法来提供对单例类的单个对象的访问

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-23T01:26:49.160

在处理可插入模块时，我将它用于封装命令行参数的对象。主程序不知道要加载的模块的命令行参数是什么（甚至不总是知道正在加载哪些模块）。例如，主加载 A，它本身不需要任何参数（所以为什么它应该采用额外的指针/引用/其他，我不确定 - 看起来像污染），然后加载模块 X、Y 和 Z。两个其中，比如 X 和 Z，需要（或接受）参数，因此它们回调命令行单例以告诉它要接受哪些参数，并在运行时回调以查明用户是否确实指定了任何参数其中。

在许多方面，如果您每个查询只使用一个进程，则用于处理 CGI 参数的单例将类似地工作（其他 mod_* 方法不这样做，所以在那里会很糟糕 - 因此说你应该的论点' t 在 mod_cgi 世界中使用单例，以防你移植到 mod_perl 或任何世界）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-23T01:35:30.313

将特定的基础架构问题配置为单例或全局变量可能非常实用。我最喜欢的例子是依赖注入框架，它使用单例作为框架的连接点。

在这种情况下，您将依赖基础架构来简化库的使用并避免不必要的复杂性。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-09-23T03:15:50.243

我认为如果您的应用程序有多个层，例如表示、域和模型。Singleton 非常适合成为横切层的一部分。并为系统中的每一层提供服务。

本质上，Singleton 包装了一项服务，例如日志记录、分析，并将其提供给系统中的其他层。

是的，单身人士需要遵循单一责任原则。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-06-24T17:51:12.863

所以我正在阅读学校的单身模式，教授们整理了一份关于这个主题的当前观点和最佳实践的清单。如果您构建单例以便它不会向代码中添加任何内容，则似乎可以使用单例。如果你做到这一点，以便可以打开和关闭单例使用，除了工作负载之外几乎没有副作用，那么使用这种设计模式是安全且可取的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-10-29T08:01:09.103

单例模式是 Spring 容器化方法中最普遍的模式。如果我们从架构原语的角度来看 - 它们形成了一个对象的黑板图，每个线程都可以对其进行读写。他们执行在多个线程之间同步的戏剧性行为。多个线程需要同步的真正原因是因为始终存在作为计算程序基础的资源，在这些资源上可能会发生争用。考虑一下所谓的“最后一个座位问题”。正在预订航班，但有多种方法可以预订。为简单起见，假设有关航班占用的数据存储在平面文件而不是数据库中。现在，如果有两个线程，每个线程在功能上不同（即由 webapp 中的不同端点表示）并让其中一个线程 A，是潜在乘客用来进行预订的线程，另一个 B 是航班经理用来关闭预订的线程 - 几乎关闭登机门。然后，如果这些线程不使用单例，则飞行对象将从那里的真实资源中分离出来，我们说的不是实际的飞机，而是平面文件中的条目。A线程会引用一个对象，而乘客还在纠结要不要飞，最后当他下定决心时，B线程已经关门了。但是 A 线程引用的对象仍然会显示多一个座位。现在，由于我们最初的假设，删除了 RDBMS，即使登机已关闭，系统也会为乘客写一张票并发给他。现在，在单例实现中，在读B访问系统的那一刻，通用对象Flight更新为关闭状态。因此，如果乘客最终下定决心并单击确认，他将立即出错。如果没有单例，这一切都是不可能的。因此，单例允许您靠近资源并避免线程争用。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-10-24T10:39:48.123

也许是一个带有代码的例子。

在这里，ConcreteRegistry 是扑克游戏中的一个单例，它允许包树上的行为一直访问游戏的少数核心接口（即模型、视图、控制器、环境等的外观）：

[http://www.edmundkirwan.com/servlet/fractal/cs1/frac-cs40.html](http://www.edmundkirwan.com/servlet/fractal/cs1/frac-cs40.html)

埃德。

# binaryfiles - 如何提取 .hpi 文件的 .jpg/.png 组件？

> ID：228165
> 
> 赞同：3
> 
> 时间：2008-10-23T01:17:41.223
> 
> 标签：binaryfiles

我偶然发现了我相当古老的照片对象磁盘，遗憾地发现该公司（hemera）不再为它提供支持。这给我留下了一大堆 .hpi 文件。幸运的是，我找到[了](http://www.halley.cc/ed/linux/interop/hemera.html)有关提取文件的 jpg 和 png 组件的信息。

不幸的是，我无法让它工作。谁能弄清楚这段代码有什么问题？如果您不喜欢 Perl，我会很高兴使用 PHP 或 Python 解决方案。:)

```
open(I, "$name") || die;
binmode(I);
$_ = <I>;
close(I);

my ($j, $p) = m|^.{32}(.*)(\211PNG.*)$|s;
open(J, ">$name.jpg") &&
    do { binmode(J); print J $j; close J; };
open(P, ">$name.png") &&
    do { binmode(P); print P $p; close P; }; 
```

我从 CD 上抓取的当前测试文件的 hexdump 在这里，如果它有帮助的话：

```
0000000 89 48 50 49 0d 0a 1a 0a 64 00 00 00 20 00 00 00
0000010 45 89 00 00 65 89 00 00 0a 21 00 00 00 d0 d0 00 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T01:54:56.590

我在从 MS Word 文档中提取图像时遇到了类似的问题。这是我为此编写的程序。但是，它只提取 PNG：

```
#!/usr/bin/perl
use strict;

my $HEADER = "\211PNG";
my $FOOTER = "IEND\xAEB`\x82";

foreach my $file ( @ARGV )
     {
     print "Extracting $file\n";
     (my $image_base = $file) =~ s/(.*)\..*/$1/;

     my $data = do { local $/; open my( $fh ), $file; <$fh> };

     my $count = 0;

     while( $data =~ m/($HEADER.*?$FOOTER)/sg )
        {
        my $image      = $1;
        $count++;
        my $image_name = "$image_base.$count.png";
        open my $fh, "> $image_name" or warn "$image_name: $!", next;
        print "Writing $image_name: ", length($image), " bytes\n";
        print $fh $image;
        close $fh;
        }

    }

__END__ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T01:28:24.103

似乎正则表达式是错误的。这就是为什么我写了一个小 C 程序来为我做这件事：

```
#include <stdio.h>
#include <stdlib.h>

#define MAX_SIZE 1048576

char stuff[MAX_SIZE];

int main (int argc, char **argv)
{
    unsigned int j_off, j_len, p_off, p_len;
    FILE *fp, *jp, *pp;
    fp = fopen (argv[1], "r");
    if (!fp)    goto error;
    if (fseek (fp, 12, SEEK_SET))   goto error;
    if (!fread (&j_off, 4, 1, fp))  goto error;
    if (!fread (&j_len, 4, 1, fp))  goto error;
    if (!fread (&p_off, 4, 1, fp))  goto error;
    if (!fread (&p_len, 4, 1, fp))  goto error;
    fprintf (stderr, "INFO %s \t%d %d %d %d\n",
        argv[1], j_off, j_len, p_off, p_len);
    if (j_len > MAX_SIZE || p_len > MAX_SIZE) {
        fprintf (stderr, "%s: Chunk size too big!\n", argv[1]);
        return EXIT_FAILURE;
    }

    jp = fopen (argv[2], "w");
    if (!jp)    goto error;
    if (fseek (fp, j_off, SEEK_SET))    goto error;
    if (!fread (stuff, j_len, 1, fp))   goto error;
    if (!fwrite (stuff, j_len, 1, jp))  goto error;
    fclose (jp);

    pp = fopen (argv[3], "w");
    if (!pp)    goto error;
    if (fseek (fp, p_off, SEEK_SET))    goto error;
    if (!fread (stuff, p_len, 1, fp))   goto error;
    if (!fwrite (stuff, p_len, 1, pp))  goto error;
    fclose (pp);
    fclose (fp);
    return EXIT_SUCCESS;

error:
    perror (argv[1]);
    return EXIT_FAILURE;
} 
```

它适用于命令行参数 input.hpi output.jpg output.png。错误处理不是 100% 正确的，但它足以告诉你是否有问题，而且大多数时候它是什么。**对于大文件，您必须放大 MAX_SIZE。**

这是一个可以使用 *.hpi 调用的 shell 脚本：

```
#!/bin/bash

dest=<destination-folder>

for arg in "$@"
do
  base=`echo $arg | cut -d'.' -f1`
  <executable> $arg $dest/original/$base.jpg $dest/mask/$base.png 2>>$dest/log
  #composite -compose CopyOpacity $dest/mask/$base.png $dest/original/$base.jpg $dest/rgba/$base.png
done 
```

可选的复合命令（ImageMagick 附带）将创建一个新的 PNG 图像，该图像将蒙版应用为 alpha 通道。请注意，此文件将比原始文件大 5 倍左右。

请注意，某些 HPI 文件没有掩码。在这种情况下，我的程序仍然可以工作，但会给出一个空的 PNG 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T02:08:01.573

不是您自己编写的解决方案，但[此](http://www.xnview.com/ "xnview")应用程序是供个人使用的免费软件，它声明它可以转换 hpi 文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-23T12:36:24.950

对于那些通过 Google 来到这里的人，我编写了一个 Python 脚本，仅针对 PNG 图像解决了这个问题：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
import re, sys

def main():
  if len(sys.argv) < 2:
    print """Usage:
  {0} BINARY_FILE PNG_PATH_TEMPLATE
Example:
  {0} bin/program 'imgs/image.{{0:03d}}.png'""".format(__file__)
    return
  binfile, pngpath_tpl = sys.argv[1:3]

  rx = re.compile("\x89PNG.+?IEND\xAEB`\x82", re.S)
  bintext = open(binfile, "rb").read()
  PNGs = rx.findall(bintext)

  for i, PNG in enumerate(PNGs):
    f = open(pngpath_tpl.format(i), "wb") # Simple string format.
    f.write(PNG)
    f.close()

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T17:25:25.857

对于`.jpeg`and`.mov`文件，有[recoverjpeg](http://www.rfc1149.net/devel/recoverjpeg.html)，我在 linux 上测试过（但可能与其他平台兼容）。

在某些 debian 系统上，它可以通过`apt get install recoverjpeg`

# stored-procedures - SubSonic 和存储过程

> ID：228175
> 
> 赞同：2
> 
> 时间：2008-10-23T01:22:33.910
> 
> 标签：stored-procedures, subsonic

使用 SubSonic 时，您是将数据作为数据集返回还是将其放入强类型自定义集合或通用对象中？

我运行了亚音速项目，对于我的数据库中的四个存储过程，它给了我一个 Sps.cs，其中包含 4 个返回一个 StoredProcedure 对象的方法。

如果您使用 MVC，您通常使用 StoredProcedure 对象还是将其包装在您的业务逻辑中并返回数据集、列表、集合或其他东西？

数据集仍然是常态还是被其他东西取代了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T01:27:44.557

如果存储过程的结果与您的一个表具有相同的架构，您可以使用以下代码（SubSonic 2.1）构建一个集合：

```
ProductCollection coll = new ProductCollection();
coll.LoadAndCloseReader(SPs.GetProducts(1).GetReader()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T19:03:22.003

`ExecuteTypedList<>`在这种情况下是你最好的朋友：

```
IList<Product> list=SPs.GetProducts().ExecuteTypedList<Product>(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T01:30:24.253

如果我的存储过程从我拥有 SubSonic 对象的一个​​表中返回所有字段，那么我会对存储过程的结果执行 LoadAndCloseReader。如果我的存储过程返回的数据与 SubSonic 对象不匹配，那么我只需将其作为数据集使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T01:46:11.800

也许返回一个数据读取器，然后对其进行迭代以填充一些自定义对象。或者，快速而肮脏的方式（因为您没有使用域驱动设计）在数据库中创建一个与存储过程具有相同结构的视图，然后将结果加载到类似于 John 的代码的 ViewObjectCollection 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T10:45:17.443

你可以做数据阅读器，但那是 1999 年。使用 SubSonic 返回对象是轻而易举的事，而且比数据阅读器更容易使用。您可以像这样检索对象：

```
Dim Charts As Generic.List(Of MusicDB.Billboard) = _
    New SubSonic.Select(MusicDB.DB.Repository.Provider, New String() _
    {"Prefix", "Artist", "Track", "ArtistNarrowToken", "TrackNarrowToken", "ArtistId", "TrackId", "TrackYear"}). _
    From(MetadataTagger.MusicDB.Tables.Billboard). _
    Where(MusicDB.Billboard.Columns.ArtistNarrowToken).IsLessThan(10). _
    Or(MusicDB.Billboard.Columns.TrackId).IsNull(). _
    OrderAsc(New String() {"TrackYear"}).ExecuteTypedList(Of MetadataTagger.MusicDB.Billboard)() 
```

# svn - 颠覆要求不正确的用户

> ID：228183
> 
> 赞同：2
> 
> 时间：2008-10-23T01:25:44.450
> 
> 标签：svn

我刚刚得到了一个闪亮的、全新的 Debian 服务器，由我们的系统组交给我，并且 /etc 目录由 Subversion 进行版本控制。不幸的是，我似乎无法保存一些配置更改；Subversion 一直在向我询问设置盒子的先生们的密码，以及截至今天晚上 6 点正在度假的先生们：

```
djessup@server1:/etc$ sudo svn commit -m "Made some changes."
jdoe@svn.example.root.ent's password: 
```

以我自己的身份签出更改时，我没有这个问题，只有在使用 sudo 以 root 身份提交更改时。

我的第一个想法是有人检查了嵌入用户名的工作目录，但 svn info 显示 Subversion 存储库的位置是 svn+ssh://svn.example.root.ent/svn/its-systems/server1 ，而不是 svn+ssh://jdoe@svn.example.root.ent/svn/its-systems/server1。

我尝试使用[官方 Subversion 用户指南](http://svnbook.red-bean.com/nightly/en/svn.ref.svn.html)中记录的 --username 命令。它完全无效；John Doe 的用户名（实际名称已更改以保护无辜者）不断出现。我在 /root/.subversion 中查找了一些可能的错误配置。那里的配置为零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T01:28:14.663

正如您对时间戳所期望的那样，我在得到答案后问了这个问题。这个问题非常痛苦，我希望它的解决方案能够传播得更广泛，这样其他人就不必走我所做的所有死胡同。

在 Google 上搜索了几遍后，我终于找到了[Hardy Ferentschik](http://www.highlevelbits.com/2007/04/svn-over-ssh-prompts-for-wrong-username.html)解释这个问题的精彩博文。事实证明，问题不在于 Subversion，而在于我用来访问 Subversion 的 SSH 协议。当我打开 /root/.ssh/config 时，我发现以下文本：

```
Host svn.example.root.ent
        User jdoe 
```

我在这个配置文件中用我的用户名替换了 jdoe，一切正常。

# assembly - 为什么没有包含 EAX 高字节的寄存器？

> ID：228200
> 
> 赞同：69
> 
> 时间：2008-10-23T01:31:10.180
> 
> 标签：assembly, x86, cpu-registers

`%AX = (%AH + %AL)`

那么为什么不`%EAX = (%SOME_REGISTER + %AX)`注册一些`%SOME_REGISTER`呢？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2008-10-23T02:40:26.593

只是为了澄清一下。在 1970 年代早期的微处理器时代，CPU 只有少量的寄存器和非常有限的指令集。通常，算术单元只能在单个 CPU 寄存器上运行，通常称为“累加器”。8 位 8080 和 Z80 处理器上的累加器称为“A”。还有 6 个其他通用 8 位寄存器：B、C、D、E、H 和 L。这六个寄存器可以配对形成 3 个 16 位寄存器：BC、DE 和 HL。在内部，累加器与标志寄存器组合形成 AF 16 位寄存器。

当英特尔开发 16 位 8086 系列时，他们希望能够移植 8080 代码，因此他们保持相同的基本寄存器结构：

```
8080/Z80  8086
A         AX
BC        BX
DE        CX
HL        DX
IX        SI    
IY        DI 
```

由于需要移植 8 位代码，他们需要能够引用 AX、BX、CX 和 DX 的各个 8 位部分。这些被称为 AL、AH 用于 AX 的低字节和高字节，以此类推用于 BL/BH、CL/CH 和 DL/DH。Z80 上的 IX 和 IY 仅用作 16 位指针寄存器，因此无需访问 SI 和 DI 的两半。

当 80386 在 1980 年代中期发布时，他们创建了所有寄存器的“扩展”版本。所以，AX 变成了 EAX，BX 变成了 EBX 等等。不需要访问这些新扩展寄存器的前 16 位，所以他们没有创建 EAXH 伪寄存器。

AMD 在生产第一批 64 位处理器时采用了相同的技巧。AX 寄存器的 64 位版本称为 RAX。所以，现在你有一些看起来像这样的东西：

```
|63..32|31..16|15-8|7-0|
               |AH.|AL.|
               |AX.....|
       |EAX............|
|RAX...................| 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-09-09T06:21:12.587

这里发布了很多答案，但没有一个真正回答给定的问题：为什么没有直接编码 EAX 的高 16 位或 RAX 的高 32 位的寄存器？答案归结为 x86 指令编码本身的局限性。

**16 位历史课**

当英特尔设计 8086 时，他们对许多指令使用了可变长度编码方案。这意味着某些极其常见的指令`POP AX`，`MOV CX, [BX+SI+1023]`如, 8B 88 FF 03)。

这似乎是一个合理的解决方案，但是当他们设计它时，*他们填满了大部分可用空间*。因此，例如，`POP`八个单独的寄存器（AX、CX、DX、BX、SP、BP、SI、DI）有 8 条指令，它们填写了操作码 58 到 5F，而操作码 60 完全是另外一回事（`PUSHA`） ，就像操作码 57 ( `PUSH DI`) 一样。在这些之后或之前没有任何空间。即使推送和弹出段寄存器——这在概念上几乎与推送和弹出通用寄存器相同——也必须在不同的位置进行编码（大约在 06/0E/16/1E 左右），因为旁边没有空间其余的推送/弹出指令。

同样，用于复杂指令的“mod r/m”字节`MOV CX, [BX+SI+1023]`只有三位用于对寄存器进行编码，这意味着它总共只能表示八个寄存器。如果您只有八个寄存器，那很好，但如果您想要更多，就会出现真正的问题。

（这里有一张 x86 架构中所有这些字节分配的出色映射：http: [//i.imgur.com/xfeWv.png](https://i.imgur.com/xfeWv.png)。请注意主映射中没有剩余空间，一些指令重叠字节，甚至如何由于 MMX 和 SSE 指令，现在使用了大部分辅助“0F”映射。）

**迈向 32 位和 64 位**

所以为了让 CPU 设计从 16 位扩展到 32 位，他们已经遇到了设计问题，他们用*前缀字节*解决了这个问题：通过在所有标准 16 位前面添加一个特殊的“66”字节指令，CPU 知道您需要相同的指令，但需要 32 位版本 (EAX) 而不是 16 位版本 (AX)。设计的其余部分保持不变：整个 CPU 架构中仍然只有八个通用寄存器。

必须进行类似的黑客操作才能将架构扩展到 64 位（RAX 和朋友）；在那里，通过添加另一组前缀代码 ( `REX`, 40-4F) 来解决问题，这意味着“64 位”（并有效地在“mod r/m”字段中添加了另外两位），并且还丢弃了奇怪的旧没有人使用和重用他们的字节码来更新的指令。

**8 位寄存器旁白**

那么，要问的一个更大的问题是，如果设计中只有八个寄存器的空间，那么像 AH 和 AL 这样的东西是如何工作的。答案的第一部分是没有“ `PUSH AL`”之类的东西——一些指令根本无法对字节大小的寄存器进行操作！唯一能做到的是一些特殊的怪事（比如`AAD`和`XLAT`) 和特殊版本的“mod r/m”指令：通过在“mod r/m”字节中翻转一个非常特定的位，这些“扩展指令”可以翻转以在 8 位寄存器上操作，而不是在16 位的。恰好也有八个 8 位寄存器：AL、CL、DL、BL、AH、CH、DH 和 BH（按此顺序），并且与可用的八个寄存器插槽非常吻合在“mod r/m”字节中。

英特尔当时指出，8086 设计应该与 8080/8085 “源代码兼容”：8086 中的每个 8080/8085 指令都有一条等效指令，但它没有使用相同的字节码（它们甚至不接近），并且您必须重新编译（重新组装）您的程序以使其使用新的字节码。但是“源兼容”是旧软件的一种前进方式，它允许 8085 的单独 A、B、C 等以及组合“BC”和“DE”寄存器仍然可以在新处理器上工作，即使它们现在是称为“AL”和“BL”和“BX”和“DX”（或任何映射）。

所以这才是真正的答案：并不是英特尔或 AMD 故意“遗漏”了 EAX 的高 16 位寄存器，或 RAX 的高 32 位寄存器：而是高 8 位寄存器是一个奇怪的遗留历史异常，并且考虑到架构向后兼容的要求，以更高的比特大小复制他们的设计将非常困难。

**性能考虑**

关于为什么那些“高寄存器”还没有被添加，还有另一个考虑因素：在现代处理器架构中，出于性能原因，可变大小的寄存器实际上并没有重叠：AH 和 AL 不是t AX 的一部分，AX 不是 EAX 的一部分，EAX 不是 RAX 的一部分：它们都是底层的独立寄存器，当您操作其中一个时，处理器会在其他寄存器上设置一个无效标志以便它知道当您从其他人那里读取数据时它需要复制数据。

（例如：如果您设置 AL = 5，处理器不会更新 AX。但如果您随后从 AX 读取，处理器会快速将 AL 中的 5 复制到 AX 的低位。）

通过保持寄存器分开，CPU 可以做各种聪明的事情，比如不可见的寄存器重命名，以使您的代码运行得更快，但这意味着如果您使用将小寄存器视为较大寄存器的旧模式，您的代码运行速度会*变慢*寄存器，因为处理器将不得不停止并更新它们。为了防止所有这些内部簿记失控，CPU 设计人员明智地选择在较新的处理器上添加单独的寄存器，而不是添加更多重叠的寄存器。

（是的，这意味着在现代处理器上，明确地“ `MOVZX EAX, value`”确实比旧的、更草率的“ `MOV AX, value / use EAX`”方式更快。）

**结论**

综上所述，如果英特尔和 AMD 真的想要添加更多“重叠”寄存器，他们是否可以？当然。如果有足够的需求，有办法让他们进来。但是考虑到重要的历史包袱、当前的​​架构限制、显着的性能限制，以及如今大多数代码是由针对非重叠寄存器优化的编译器生成的事实，他们不太可能很快添加这样的东西。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-23T01:41:50.470

在旧的 8 位时代，有 A 寄存器。

在 16 位时代，有 16 位 AX 寄存器，它被分成两个 8 位部分，AH 和 AL，在那些你仍然想使用 8 位值的时候。

在 32 位时代，引入了 32 位 EAX 寄存器，但 AX、AH 和 AL 寄存器都保留了下来。设计者认为没有必要引入一个新的 16 位寄存器来寻址 EAX 的第 16 位到第 31 位。

# multithreading - 你如何处理更新刷新率？

> ID：228205
> 
> 赞同：-1
> 
> 时间：2008-10-23T01:33:05.653
> 
> 标签：multithreading, user-interface

您如何处理从工作函数到 UI 的更新刷新率？

将所有内容发送到 UI 或使用计时器（从哪一侧？工人或 UI？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T01:39:54.157

如果您的平台和开发环境支持它，那么某种异步消息传递系统运行良好。在 Win32 下，我只使用我“发布”的普通 Windows 消息（因此它们不会阻塞线程），并且 UI 的标准主消息线程会拾取消息并处理它们。我通常也会定义自定义消息。

使用 Timers 是次优的，应该没有必要“轮询”这类信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T01:35:35.460

在 Windows 应用程序中，您通常希望在 GUI 线程中使用 Timer 对象来轮询工作人员状态——这更容易，除非您有充分的理由去做其他事情......

您不能只从 Windows 中的工作线程对 UI 例程进行函数调用。将导致未定义的行为，所以要小心！

# java - 我应该把我的测试方法放在一个单独的类中吗？如果是这样，怎么做？

> ID：228218
> 
> 赞同：2
> 
> 时间：2008-10-23T01:36:53.197
> 
> 标签：java, class

我对 Java 很陌生。我的任务是创建自己的方法，然后创建一个类来对其进行测试。我的问题是，我是在类中还是在类中单独创建方法？如果它与类分开，我如何让类访问我的方法？

（它们是否保存为两个单独的文件？）

这是我到目前为止所拥有的，但我收到一个错误，我必须在 DWindmill 类中初始化 KILOWATT。我以为我已经在方法中了？？？有什么建议么？

```
//This is the method Windmill

import java.util.*;
import static java.lang.Math.*;

class DWindmill {

    public static void Windmill(){
    //create the method for the Windmill class

    int miles = 50;
    //int miles = 200;
    //int miles = 250;
    int KILOWATT = (miles / 50);}

    static Scanner console = new Scanner(System.in);
    {

    System.out.println("Enter miles per hour:");
    miles = console.nextInt();

    Windmill();

    System.out.println(+ KILOWATT + "kilowatts");

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T01:41:38.460

对于这样的简单作业，您可能可以在与您的类相同的类中创建您的方法。创建一个带有静态 main 方法的类，这将是您的程序起点，然后创建将被调用的方法。

似乎您对编程很陌生，我会利用您程序中提供的任何教程。它们通常由大三、大四或研究生水平的学生教授，旨在给你一个很好的材料介绍，并让你有时间在课外提问。确保你去上课，并尝试阅读你应该为课程购买的教科书。这些信息通常可以在那里找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T03:21:42.110

**请**去上课或阅读教科书或其他东西，因为您的代码说明了对什么是类、什么是方法以及如何将大括号用于代码块的基本误解。这是您的代码的更正（但未经测试）版本 -

```
class Windmill
{
    public static void main(String args[])
    {
        Scanner console = new Scanner(System.in);
        System.out.println("Enter miles per hour:");
        int miles = console.nextInt();
        int KILOWATT = (miles / 50);
        System.out.println(KILOWATT + " kilowatts");
    }
} 
```

说真的，此时[任何事情都](http://java.sun.com/docs/books/tutorial/getStarted/application/index.html)应该有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T01:40:43.173

在 Java 中，所有方法都存在于类中。因此，为了创建一个类，您可以编写如下内容：

```
public class MyClass {

   public static void Hello() {
      //This is your method!
   }

   public static void main (String[] args) {
       Hello();  //This is how you call your method.
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T01:45:02.383

或者你可以创建如下

```
public class MyClass {
  public int myMethod() {
    ,,,,,
  }
}

public class myTest {
  public void testMyMethod() {
   MyClass testClass = new MyClass();
   int output = testClass.myMethod();
 . 
. 
  }
} 
```

在 Java 中，所有方法都需要在一个类中。你可以有一个单独的测试类或在同一个类中测试它。

如果您使用 jUnit(www.junit.org) 之类的东西对您的方法进行单元测试，事情会变得更加复杂。

# php - 正则表达式预告片

> ID：228220
> 
> 赞同：0
> 
> 时间：2008-10-23T01:39:28.213
> 
> 标签：php, regex

假设我们有 2 个 php 变量：

*   **$name** = '标题';
*   **$url** = ' [http://domain.com/photo.jpg](http://domain.com/photo.jpg) ';

的输入字符串`'{@url,<img src="," alt="{@name}" />}'`应该返回：

`'<img src="http://domain.com/photo.jpg" alt="caption" />'`

`{tag}`最多需要 3 个参数：`{@variable[,text_before][,text_after]}`.

实现这一点需要什么正则表达式？棘手的部分是`{@..}`标签嵌套在另一个标签中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T18:03:53.717

我认为您遇到了*不应该*使用正则表达式的情况之一。

很像这个。

[多行组并使用正则表达式搜索](https://stackoverflow.com/questions/154708/multi-line-group-and-search-with-regex) [多行组并使用正则表达式进行搜索](https://stackoverflow.com/questions/154708/multi-line-group-and-search-with-regex#162194)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-23T02:09:57.530

这是一个CMS。管理员可以添加列字段，然后添加模板代码以使其在列表页面上显示。{@tags} 用于输出动态列值。此模板代码：

`<p>Link: <a href="{@url}">{@name}</a> - {@date}</p>`

将创建一个列表页面，如：

链接：[链接一](http://google.com)- 2008 年 7 月 2 日

链接：[链接二](http://google.com)- 2008 年 6 月 14 日

链接：[链接三](http://google.com)- 2007 年 2 月 9 日

...

我认为人们可能希望在其他人中使用列值，因此第一篇文章中的“alt”标签示例。那么为此使用正则表达式不是一个好主意吗？

# sql - 如何使用序列值将多行插入到 oracle 中？

> ID：228221
> 
> 赞同：44
> 
> 时间：2008-10-23T01:39:41.847
> 
> 标签：sql, oracle

[我知道如果我使用此答案](https://stackoverflow.com/questions/39576/best-way-to-do-multi-row-insert-in-oracle#39602)中的语法，我可以使用单个语句插入多行。

但是，我插入的其中一个值取自一个序列，即

```
insert into TABLE_NAME
(COL1,COL2)
select MY_SEQ.nextval,'some value' from dual
union all
select MY_SEQ.nextval,'another value' from dual
; 
```

如果我尝试运行它，我会收到 ORA-02287 错误。有什么办法可以解决这个问题，还是我应该使用很多 INSERT 语句？

编辑：
如果我必须为序列以外的所有其他列指定列名，我会失去原来的简洁性，所以这是不值得的。在这种情况下，我将只使用多个 INSERT 语句。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-23T02:06:50.530

这有效：

```
insert into TABLE_NAME (COL1,COL2)
select my_seq.nextval, a
from
(SELECT 'SOME VALUE' as a FROM DUAL
 UNION ALL
 SELECT 'ANOTHER VALUE' FROM DUAL) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-26T05:52:58.477

它不起作用，因为序列在以下情况下不起作用：

*   在 WHERE 子句中
*   在 GROUP BY 或 ORDER BY 子句中
*   在 DISTINCT 子句中
*   与 UNION 或 INTERSECT 或 MINUS 一起使用
*   在子查询中

来源：[http ://www.orafaq.com/wiki/ORA-02287](http://www.orafaq.com/wiki/ORA-02287)

但是，这确实有效：

```
insert into table_name
            (col1, col2)
  select my_seq.nextval, inner_view.*
    from (select 'some value' someval
            from dual
          union all
          select 'another value' someval
            from dual) inner_view; 
```

* * *

试试看：

```
create table table_name(col1 varchar2(100), col2 varchar2(100));

create sequence vcert.my_seq
start with 1
increment by 1
minvalue 0;

select * from  table_name; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T02:10:20.210

```
insert into TABLE_NAME
(COL1,COL2)
WITH
data AS
(
    select 'some value'    x from dual
    union all
    select 'another value' x from dual
)
SELECT my_seq.NEXTVAL, x 
FROM data
; 
```

我认为这就是你想要的，但我现在无法访问 oracle 来测试它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T01:57:12.173

来自[Oracle Wiki](http://www.orafaq.com/wiki/ORA-02287)，错误 02287 是

> 当您使用不允许的序列时，会出现 ORA-02287。

**在无法**使用序列的地方，您似乎正在尝试：

> 在子查询中

所以看起来你不能在同一个语句中做倍数。

他们提供的解决方案是：

> 如果您希望为创建的每一行将序列值插入到列中，则创建一个插入前触发器并在触发器中获取序列值并将其分配给列

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T01:56:39.443

一种可能性是在插入时创建触发器以添加正确的序列号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-20T13:54:12.717

这行得通，无需使用 union all。

```
Insert into BARCODECHANGEHISTORY (IDENTIFIER,MESSAGETYPE,FORMERBARCODE,NEWBARCODE,REPLACEMENTDATETIME,OPERATORID,REASON)
select SEQ_BARCODECHANGEHISTORY.nextval, MESSAGETYPE, FORMERBARCODE, NEWBARCODE, REPLACEMENTDATETIME, OPERATORID, REASON
from (
  SELECT
    'BAR' MESSAGETYPE,
    '1234567890' FORMERBARCODE,
    '1234567899' NEWBARCODE,
    to_timestamp('20/07/12','DD/MM/RR HH24:MI:SSXFF') REPLACEMENTDATETIME,
    'PIMATD' OPERATORID,
    'CORRECTION' REASON
  FROM dual
); 
```

# visual-studio-2008 - Visual Studio 2008 未加载 MFC dll 符号

> ID：228224
> 
> 赞同：1
> 
> 时间：2008-10-23T01:40:18.463
> 
> 标签：visual-studio-2008

当我调试我的应用程序时，Visual Studio 2008 似乎没有为 MFC dll 加载符号。这曾经在 2005 年运行良好 - 即。当它加载 dll 时，它说“已加载符号”，然后可以对其进行调试。在 2008 年（已升级到 MFC 9，因此它们是不同的库）它并没有说它为 MFC dll 加载了符号，后来表明它没有因为无法调试它们（“没有加载符号”在调用堆栈等）。

是否有某种设置影响了这一点？我认为 MFC 9.0 应该仍然可以...

编辑：好的，所以进一步的研究表明我在 c:/windows/symbols/dll 中有某种符号，但是 VS 说它们不匹配（而且它们看起来比应有的年龄大约六个月）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T07:24:49.280

使用 Microsoft 符号服务器。Scott Hanselman 展示了如何在[全球范围内做到这一点](http://www.hanselman.com/blog/SetUpYourSystemToUseMicrosoftsPublicSymbolServer.aspx)。这适用于所有 Windows 调试器（即 WinDBG、NTSD 等）。

或者，您可以使用 Visual Studio 中的工具/选项/调试/符号条目。

这将导致 Visual Studio 在需要时下载任何符号。请记住，这会减慢您的前几次调试会话，因为它会第一次下载符号文件的公制卸载负载。

哦，确保你有足够的空间；我的一台 PC 上有几百 MB 的符号文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T04:18:09.877

.pdb 文件必须与 .dll 版本完全匹配 - 您是否检查过它没有使用符号的缓存副本。

# javascript - 防止 Xmlhttprequest 的重定向

> ID：228225
> 
> 赞同：122
> 
> 时间：2008-10-23T01:40:20.147
> 
> 标签：javascript, ajax, xmlhttprequest

发送 XMLHttpRequest-s 时是否可以防止浏览器跟随重定向（即获取重定向状态代码并自己处理）？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-12-05T09:58:53.197

不符合[XMLHttpRequest 对象的 W3C 标准](http://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#infrastructure-for-the-send%28%29-method)（已添加重点）：

> 如果响应是 HTTP 重定向：
> 
> > 如果 Location 标头传达的 URL 的来源与 XMLHttpRequest 的来源相同，并且重定向不违反无限循环预防措施，则在遵守同源请求事件规则的同时**透明地遵循重定向。**

他们正在[考虑](http://www.w3.org/TR/2008/WD-XMLHttpRequest-20080415/#notcovered)将其用于未来的版本：

> 本规范不包括正在考虑用于本规范的未来版本的以下功能：
> 
> *   禁用以下重定向的属性；

但[最新](http://www.w3.org/TR/XMLHttpRequest/)的规范不再提及这一点。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-11-07T03:53:49.613

新的[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)支持不同的重定向处理模式：`follow`、`error`和`manual`，但是当重定向被取消时，我找不到查看新 URL 或状态代码的方法。您可以停止重定向本身，然后它看起来像一个错误（空响应）。如果这就是您所需要的，那么您就可以开始了。~~您还应该知道，通过此 API 发出的请求还[不能取消](https://github.com/whatwg/fetch/issues/27)。~~ *他们[现在是](https://stackoverflow.com/a/46785332)。*

至于 XMLHttpRequest，您可以`HEAD`在服务器上检查 URL 是否已更改：

```
var http = new XMLHttpRequest();
http.open('HEAD', '/the/url');
http.onreadystatechange = function() {
    if (this.readyState === this.DONE) {
        console.log(this.responseURL);
    }
};
http.send(); 
```

您不会获得状态代码，但会找到新的 URL，而无需从中下载整个页面。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-23T07:45:04.030

不，您在 XMLHttpRequest 公开的 API 中没有任何地方允许您覆盖其自动遵循 301 或 302 的默认行为。

如果客户端在 Windows 上运行 IE，那么您可以改用 WinHTTP 来设置一个选项来防止该行为，但这是一个非常有限的解决方案。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-02-09T13:44:32.417

您可以使用`responseURL`属性来获取重定向目标或检查响应最终是否是从您接受的位置获取的。
这当然意味着无论如何都会获取结果，但至少您可以获得有关重定向目标的必要信息，例如检测您想要丢弃响应的条件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-06T19:17:59.683

正如其他评论中所回答的那样，无法在客户端处理重定向或 302 状态。但是，您可以防止重定向。为此，您可以使用 "XMLHttpRequest" xhttp.setRequestHeader("X-Requested-With", "XMLHttpRequest"); 设置请求标头 "X-Requested-With" 这应该在打开之后但在发送之前完成。下面的例子

```
let xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function () {
   if (this.readyState == 4 && this.status == 200) {
         reqObj.success(JSON.parse(this.responseText))
   } else if (this.status != 200) {
         reqObj.error(this.statusText)
   }
};
xhttp.open(reqObj.type, reqObj.url, reqObj.async);
xhttp.setRequestHeader("X-Requested-With", "XMLHttpRequest");
xhttp.send(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-05T20:20:33.273

我扩展了用户的回答以包括一个`abort()`电话。当您想要的只是重定向 url 时，这似乎可以防止服务器发送太多数据。

```
var url = 'the url'
var http = new XMLHttpRequest();
http.open('GET', url);
http.onreadystatechange = function() {
    if (this.readyState === this.DONE) {
        console.log(this.responseURL)
        this.abort() // This seems to stop the response
    }
}
http.send() 
```

在现实生活中，我将上面的代码包装在一个 Promise 中，但它使代码难以阅读。

另外，我不明白为什么获取重定向 url 需要这么困难，但这是另一个时间和地点的问题。

# http-headers - 来自用户代理 HTTP 标头的操作系统

> ID：228256
> 
> 赞同：57
> 
> 时间：2008-10-23T01:53:25.860
> 
> 标签：http-headers, user-agent

在映射用户代理 HTTP 标头字符串 --> 操作系统的任何地方是否有一个好的、最新的列表？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-23T01:58:01.187

这是一个快速列表...如果我错过了您感兴趣的一个，请告诉我。

[http://www.geekpedia.com/code47_Detect-operating-system-from-user-agent-string.html](http://www.geekpedia.com/code47_Detect-operating-system-from-user-agent-string.html)：

> // 将用户代理字符串与操作系统匹配
> Windows 3.11 => Win16,
> Windows 95 => (Windows 95)|(Win95)|(Windows_95),
> Windows 98 => (Windows 98)|(Win98),
> Windows 2000 => ( Windows NT 5.0)|(Windows 2000),
> Windows XP => (Windows NT 5.1)|(Windows XP),
> Windows Server 2003 => (Windows NT 5.2),
> Windows Vista => (Windows NT 6.0),
> Windows 7 => (Windows NT 6.1)、
> Windows 8 => (Windows NT 6.2)、
> Windows 10 => (Windows NT 10.0)、
> Windows NT 4.0 => (Windows NT 4.0)|(WinNT4.0)|(WinNT)|(Windows NT ),
> Windows ME => Windows ME,
> Open BSD => OpenBSD,
> Sun OS => SunOS,
> Linux => (Linux)|(X11),
> Mac OS =>(Mac_PowerPC)|(Macintosh),
> QNX => QNX,
> BeOS => BeOS,
> OS/2 => OS/2,
> Search Bot=>(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves /Teoma)|(ia_archiver)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-23T02:07:27.720

你用什么语言开发？如果您想对用户代理字符串进行数据挖掘，这对您可用的内容有很大的影响。

*   PHP 有 " `browser.php`" 将用户代理解析为操作系统、浏览器和浏览器版本：
    *   [http://www.geekpedia.com/code47_Detect-operating-system-from-user-agent-string.html](http://www.geekpedia.com/code47_Detect-operating-system-from-user-agent-string.html)（警告：Win7`Windows NT 6.1`不是`Windows NT 7.0`）
*   Javascript 具有 Navigator 对象，其中包含有关用户系统的大量详细信息
    *   [https://developer.mozilla.org/en/window.navigator](https://developer.mozilla.org/en/window.navigator)
*   .NET 具有 HttpBrowserCapabilities 对象，可用于确定 Win32 或 Win16，以及浏览器的有用功能
    *   [http://msdn.microsoft.com/en-us/library/system.web.httprequest.browser(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.browser(VS.80).aspx)
*   如果您只想要原始用户代理，Zytrax.com 也有一个很好的用户代理数据库，适用于不同系统上的各种不同浏览器
    *   [http://www.zytrax.com/tech/web/browser_ids.htm](http://www.zytrax.com/tech/web/browser_ids.htm)

Nescio 的回应提供了一个很好的清单。我列表中 PHP 下的第二个链接也包含基本相同的信息，这些信息非常简单，您应该能够将其翻译成任何语言。

请记住，将用户代理用于*任何事情*都会有很多问题。除非您愿意将一部分开发时间用于监控访问您网站的用户代理并执行持续维护，否则您应该尽量避免完全这样做。无论您需要检测操作系统的用例是什么，每个平台中的每个操作系统都可能在很短的时间内发生巨大的变化，因此请务必注意这一点，并仔细考虑如何以及为什么进行操作系统检测。

详细说明风险：在桌面上，每 6 周（Chrome OS）、6 个月（Ubuntu）、1 年（Mac OS）或 2-3 年（Windows）可能会出现一个新的操作系统版本。然后，您还需要考虑为手机、平板电脑、游戏机、[时钟](https://en.wikipedia.org/wiki/Chumby)等发布的操作系统，这些操作系统可能具有更频繁的发布周期和不可预测的市场份额变化。只需看看黑莓、Palm OS、Web OS、iOS、Android、Windows Mobile 和 Windows Phone 在过去几年中市场份额的变化等等。

除非操作系统是您网站的依赖项，例如如果您正在为应用程序创建一个有针对性的“下载”页面（这本身可能会出现问题），几乎总是最好使用[功能检测](http://msdn.microsoft.com/en-us/magazine/hh475813.aspx)，这将允许您无需不断维护浏览器或操作系统检测代码，即可让您的开发面向未来。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-23T02:02:07.763

值得记住的是，用户代理标头很容易被伪造。我不会在任何重要的事情上依赖它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T05:33:59.037

进行 UA 嗅探几乎总是一个坏主意。你根本不能依赖它。

如果您想向客户端发送特定于其环境的响应，您可能应该区分内容类型或编码的差异。这些是[坚如磐石的指定](http://greenbytes.de/tech/webdav/rfc2616.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T05:50:07.753

浏览器中的用户代理不是我所依赖的任何东西，我们都将它用于统计，但我们知道它们不是 100% 准确的。

对于一些不喜欢它的网站，我使用 firefox 并定期欺骗 IE，我的常规 UA 是：

```
Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.3) 
Gecko/2008101315 Ubuntu/8.10 (intrepid) Firefox/3.0.3 
```

我有时使用 Firefox 扩展将其更改为：

```
Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; MS-RTC LM 8; 
.NET CLR 2.0.50727; .NET CLR 1.1.4322) 
```

当您查看它时，您需要解析不同的部分，操作系统是括号之间以分号分隔的值的第三部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-08T20:44:52.393

现在我可以从[http://user-agent-string.info](http://user-agent-string.info)推荐数据库。您可以识别用户代理以及操作系统（如果可用）。

我正在开发 Java 库*[UADetector](http://uadetector.sourceforge.net)*并每月合并一个新版本的数据库（又名 UAS 文件），以 XML 和 INI 格式提供。因此，根据我的经验，我可以说这些数据是最新的。通常的更新间隔在 5 到 10 天之间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-08T04:04:37.337

我正在寻找同样的东西，然后发现：
[http ://www.useragentstring.com](http://www.useragentstring.com)

很棒，但非常详尽：您可能需要重新考虑您需要列表的项目，因为这个项目将“事情放在眼里”。

只是想分享这个给未来研究这个的人。

# visual-studio - Virtual PC 高 CPU 使用率问题

> ID：228262
> 
> 赞同：1
> 
> 时间：2008-10-23T01:55:43.627
> 
> 标签：visual-studio, virtual-pc

我在具有 4 gig RAM 的 Vista 商务笔记本电脑上运行 VPC 2007。我使用 VPC 运行 windows XP 并维护一个 VS2003 Web 项目。起初一切都很棒。我分配了 512MB 的 VPC 并照常工作。我还运行 Resharper 和 Visual SVN。最近，在页面中滚动的行为导致 CPU 超过 50，有时接近 100。这偶尔会冻结我的机器并且令人沮丧。键入代码有时会做同样的事情。

我尝试过更改分配的内存、磁盘空间、打开/关闭页面文件、卸载 ReSharper 和 Visual SVN。我在这台笔记本电脑上的所有内存都没有理由让这件事变慢！我没有任何时候在上面运行任何东西，除了 VPC。

我想知道我是否应该在我的 Vista 机器上安装 VS2003 并处理任何不兼容问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T01:58:27.973

试试[VirtualBox](http://www.virtualbox.org/)。

> VirtualBox 是一系列功能强大的 x86 虚拟化产品，适用于企业和家庭使用。VirtualBox 不仅是面向企业客户的功能极其丰富的高性能产品，它还是唯一一款根据 GNU 通用公共许可证 (GPL) 条款作为开源软件免费提供的专业解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T02:03:25.107

如果是我，我会在 Vista 上本地运行 VS.NET 2003 IDE。只需查看此页面，了解您可能遇到的问题：

[http://msdn.microsoft.com/en-us/vs2005/bb188244.aspx](http://msdn.microsoft.com/en-us/vs2005/bb188244.aspx)

就您的 CPU 而言，它可能是视频驱动程序/显示问题。您是否尝试过在您的 vista 机器上打开/关闭 Aero Glass 以查看是否会有所改变？您的桌面颜色数量在 VPC 和主机上是否相同？您最近是否更新了视频驱动程序？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T02:04:03.063

我推荐VirtualBox。每次使用 VPC 我很快就放弃了，因为性能很糟糕。我用分配了 1.5gb 内存的 Vista 虚拟 PC 运行 VirtualBox，它运行得非常好。事实上，我并没有真正注意到本机运行的速度会减慢多少。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T02:07:58.797

我建议做的第一件事是运行[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)和[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)以找出真正消耗 cpu 的东西。如果它过去运行良好，切换到另一个 VM 可能无法解决任何问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T02:07:01.310

我敢打赌 VisualSVN 是问题所在。我在具有 6GB RAM 的双核系统上遇到了同样的问题。我最终只是卸载了它，因为它不断使 IDE 崩溃。

顺便说一句，我正在运行 64 位的 Server2003。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-12T02:28:54.987

您可能让 VPC07 以最大速度运行活动 vhd。转到控制台菜单上的选项并更改此设置以在所有 vhd 之间平均分配 CPU 时间，您的问题就会消失！

# api - Netsuite 问题：任何地方都有像样的参考吗？

> ID：228265
> 
> 赞同：27
> 
> 时间：2008-10-23T01:57:02.203
> 
> 标签：api, reference, netsuite

我希望这个问题不会太晦涩*难懂*

我正在寻找一个不错的[netsuite](http://netsuite.com)脚本和 api 参考（两者都基于 ASP）

有人知道在哪里可以找到这些东西吗？netsuite 帮助页面充其量是平庸的，论坛也不是很活跃。（我想这两件事已经是不好的迹象，但值得一试吧？）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-29T11:55:53.027

作为一名前 NetSuite 员工，我一次又一次地感到沮丧，即使在内部，除了开发文档中已发布的 pdf 之外，也没有其他好的参考。

NS 用户组以及不太好的示例应用程序是代码片段和如何做事的线索的最佳位置之一。

很多都是通过反复试验完成的。我发现开发 Web 服务比客户端和服务器端脚本更令人沮丧。

乙

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-07-19T18:26:34.810

[在这里](https://system.netsuite.com/help/helpcenter/en_US/Output/Help/SuiteFlex/SuiteFlex.html#998411)找到了一些示例代码 + 文档。我将 netsuite 与一些基于 kohana 的站点集成在一起。我抛出了两个用于简化开发的片段，一个[getNetsuiteConnection()](http://snipplr.com/view/37631/get-netsuite-connection/)方法和一个用于获取给定记录[中的自定义字段列表的片段。](http://snipplr.com/view/32190/)

**更新：** 最近发现了更多资源（主要针对通过 PHP 框架使用 NetSuite）。

*   [NetSuite 全局范围问题](http://www.ozonesolutions.com/programming/2011/06/complextype-reference-not-found-in-directory/)
*   [获取客户列表](http://aiminstitute.org/blog/2011/07/getting-a-list-of-all-customers-from-netsuite-using-the-php-toolkit/)
*   [NetSuite 提示和技巧](http://www.exploreconsulting.com/netsuite_tips_and_tricks.htm)
*   [提示和代码示例](http://dreamxtream.wordpress.com/2011/02/15/netsuite-php-toolkit-tips-and-code-samples/)

**08/12 更新：**如果您正在使用 ruby​​，请查看[这个 gem](https://github.com/RevolutionPrep/netsuite)，它实现了部分 NetSuite SOAP API。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T07:49:31.640

一个快速的 Netsuite 脚本技巧

在使用 SuiteScript 时，我们在 NetSuite 中有不同的字段类型和表单字段，但要从中获取值，我们有通用函数

```
nlapiGetFieldValue();
record.getFieldValue();
rec.getValue(); 
```

这些函数总是以字符串类型返回值。即使是日期和数字类型的字段。

因此，当操作返回的值时，应该（必须）将它们转换为正确的类型以避免错误。

例如，我们可以将 parseInt 或 parseFloat 应用于数值数据。

```
var val = nlapiGetFieldValue('fieldId');
if( 3 > parseInt(val)) 
```

注意 ParseInt 可以返回 NaN 所以更有效的方法是使用这些类型的函数

```
function getNumber(number){
 return (parseFloat(number) == NaN)?0.0:parseFloat(number);
} 
```

对于日期类型字段，我们可以使用标准的 Netsuite 函数

```
nlapiStringToDate(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-30T22:16:47.600

我怎么强调用户组是多么棒的资源都不为过。我经常在那里得到答案，其中很多来自 NetSuite 员工，包括创建者 Evan。订阅各种论坛并提出问题。请务必提及您正在做的事情、您尝试过的事情以及您对正在尝试的过程的任何想法。我发现当我遵循这个公式时，我会得到答案。我公司的其他人只会问如何做某事，很少得到任何帮助。

请注意，SuiteScript 和/或 Web 服务中没有记录或不支持许多内容，并且支持的列表在两者之间不一致。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-05T12:00:14.277

这是一场噩梦。帮助中心部分可供参考。

[https://system.netsuite.com/app/help/helpcenter.nl?topic=help](https://system.netsuite.com/app/help/helpcenter.nl?topic=help)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-15T20:35:19.047

我第二次使用 NS 用户组（最近迁移到[https://usergroup.netsuite.com/users/index.php](https://usergroup.netsuite.com/users/index.php)？我正在等待批准）。为 NS 电话支持支付额外费用也有助于解决问题。在 NS 提供的支持/资源之外，linkedin NS 用户组相当不错。对于 NetSuite 问题，我发现 stackoverflow 结果没有多大用处，可能是因为对系统缺乏了解。

NetSuite for Dummies is a good reference for NetSuite in the functional perspective, but offers very little to developers. For Devs, I'd suggest checking out the NS developers guide here [https://system.netsuite.com/core/media/media.nl?id=5732122&c=NLCORP&h=5fca4bf5dd825a28ab41&_xt=.pdf&addrcountry=US](https://system.netsuite.com/core/media/media.nl?id=5732122&c=NLCORP&h=5fca4bf5dd825a28ab41&_xt=.pdf&addrcountry=US) (old but still relevant). The developers guide contains much of the same information as the help section (albeit the help section is more up to date, but does not have effective searching).

# wcf - wcf wsHttpBinding 和禁用匿名访问

> ID：228268
> 
> 赞同：5
> 
> 时间：2008-10-23T01:58:03.153
> 
> 标签：wcf, iis-6

[http://blogs.msdn.com/drnick/archive/2007/03/23/preventing-anonymous-access.aspx](http://blogs.msdn.com/drnick/archive/2007/03/23/preventing-anonymous-access.aspx)

有人可以澄清是否可以在 WCF 中使用 wsHttpBinding 并在 IIS 中禁用匿名访问而不需要传输（ssl）或消息安全性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T17:13:04.757

你是对的，在你描述 wsHttpBinding 的场景中，afaik 要求我们使用内部 WCF 安全堆栈。所以你通常会做的是

*   启用匿名访问
*   使用 <serviceAuthorization principalPermissionMode="UseWindowsGroups" /> 创建一个 serviceBehavior
*   使用 PrincipalPermissionAttribute 注释服务方法的每个具体实现，这是一个非常强大的工具，具有许多不同的选项来控制访问

这对您来说是一个可以接受的解决方案，还是有其他需要考虑的事情？

基本示例：

```
public class TestService : ITestService
{
  [PrincipalPermission(SecurityAction.Demand, Name = "testdomain\\administrator")]
  public string DoWork()
  {   
    return "Hello World " + Thread.CurrentPrincipal.Identity.Name;
  }
}

  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WcfSecurity.Www.TestServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
          <serviceAuthorization principalPermissionMode="UseWindowsGroups" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service behaviorConfiguration="WcfSecurity.Www.TestServiceBehavior" name="WcfSecurity.Www.TestService">
        <endpoint address="" binding="wsHttpBinding" contract="WcfSecurity.Www.ITestService" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>    
  </system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T01:01:01.893

我们要使用windows集成安全。如果您在 IIS 中禁用匿名访问并只允许窗口，则您似乎无法在不使用某些安全模式（例如需要 ssl 的 transprot 安全）的情况下将 wsHttpBinding 与 WCF 一起使用。

我们只想使用 windows 身份验证，不一定要使用 ssl 来保证传输安全。

我有点惊讶这不可能开箱即用（我的链接似乎证实了这一点），因为这对于实习生申请来说似乎很常见。

我们不想降级到仅支持 Windows 身份验证的 basicHttpBinding。

# algorithm - 关于寻路：D*算法的外行详解

> ID：228269
> 
> 赞同：7
> 
> 时间：2008-10-23T01:58:20.593
> 
> 标签：algorithm, path-finding, d-star

我希望处理的大型网络（小世界图类型）本质上是动态的，经常添加和减少新节点。大概使用 D* over A* 会是在这种动态环境中检测路径的更好方法？

D*有多坚固？它有任何现实世界的经验吗？就像加密算法一样——D* 是否通过大量同行评审和测试得到强化？你会用 D* 来解决这个问题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-23T02:38:49.577

据我了解，第一次运行 D* 时，它会找到与 A* 相同的路径，运行时间几乎相同。然而，当一个节点改变它的边缘值或添加节点时，A* 重新计算所有路径，而 D* 只是第二次重新计算不一致的节点，而不是整个事情。

Anthony Stentz 的 D* 算法（[此处](http://www.frc.ri.cmu.edu/~axs/doc/icra94.pdf)为原始白皮书）在很大程度上已被其工作的衍生产品所弃用。D* Lite 和 LPA* 是最常见的，并且更容易编码/实现。

就现实世界的经验而言，来自 NASA 喷气推进实验室的 Joseph Carsten 和 Art Rankin 在火星探测器“Spirit”和“Opportunity”上安装了使用 D* Lite 元素的 Field D* 版本（[此处](http://www.ceng.metu.edu.tr/~erogul/ceng585/13_DEC_2007_Presentation/d-star-hidden-slides-deleted.ppt)使用 D* 的漫游车幻灯片） . 2007 年 2 月，它被用于完全自主导航火星探测器。

[替代文字 http://asm.arc.nasa.gov/Gallery/images/generic/rover.jpg](http://asm.arc.nasa.gov/Gallery/images/generic/rover.jpg)

显然 D* 在机器人领域非常有用，因为机器人车载传感器不断地重新评估边缘值。在我看来，这将使它非常“经过实战考验”。

同样，我发现另一份[白皮书](http://www.stes.fi/scai2006/proceedings/176-182.pdf)提到了在移动游戏中使用 D* Lite 算法。

我将通过说明我以前从未实现过 D*，只有 A* 来结束这个答案。由于复杂性显着增加，我会说 D*（或 D* Lite）只应在图表中有显着且频繁变化的情况下使用。您将您的情况描述为与此类似，所以我会说肯定选择 D* Lite。如果 NASA 使用它，您可以放心地打赌它已经过彻底调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-22T16:46:52.013

我已经实现了 D* 和 A* 算法。所以，我建议你，如果你的地图没有动态障碍，你应该实现 A*。否则，实施 D*。主要原因是：在第一次搜索时，D* 计算地图中的所有节点，然后显示最短路径，而 A* 仅计算地图中目标和起点周围的有限区域。因此，它比 D* 快得多。在动态环境中，D* 比 A* 更快、更高效。因为在机器人前进的路上，如果它检测到一个新的障碍物，它只会更新意外障碍物周围的几个节点。同时，A* 将重新计算所有事物。

# c# - 为什么 OdbcCommand.ExecuteScalar() 会抛出 AccessViolationException？

> ID：228274
> 
> 赞同：3
> 
> 时间：2008-10-23T02:00:29.950
> 
> 标签：c#, .net, exception, ado.net, odbc

我有一段代码旨在从数据库表中提取文本描述并将它们保存到文本文件中。它看起来像这样（C# .NET）：

```
 OdbcCommand getItemsCommand = new OdbcCommand("SELECT ID FROM ITEMS", databaseConnection);
        OdbcDataReader getItemsReader = getItemsCommand.ExecuteReader();
        OdbcCommand getDescriptionCommand = new OdbcCommand("SELECT ITEMDESCRIPTION FROM ITEMS WHERE ID = ?", databaseConnection);
        getDescriptionCommand.Prepare();
        while (getItemsReader.Read())
        {
            long id = getItemsReader.GetInt64(0);
            String outputPath = "c:\\text\\" + id + ".txt";
            if (!File.Exists(outputPath))
            {
                getDescriptionCommand.Parameters.Clear();
                getDescriptionCommand.Parameters.AddWithValue("id", id);
                String description = (String)getDescriptionCommand.ExecuteScalar();
                StreamWriter outputWriter = new StreamWriter(outputPath);
                outputWriter.Write(description);
                outputWriter.Close();
            }
        }
        getItemsReader.Close(); 
```

此代码已成功将部分数据保存到 .txt 文件，但对于许多行，以下行会引发 AccessViolationException：

```
 String description = (String)getDescriptionCommand.ExecuteScalar(); 
```

异常文本是“尝试读取或写入受保护的内存。这通常表明其他内存已损坏”。

该程序通常会在表的相同行上引发异常，但它似乎不是 100% 一致的。有时，过去抛出异常的数据会突然起作用。

毫无疑问，有些人想知道为什么我不只是在 getItemsCommand 中选择 ID、ITEMDESCRIPTION FROM ITEMS 并跳过第二个查询。实际上，我最初是这样做的，并且在使用 getItemsCommand.GetString() 时遇到了同样的错误。我担心数据集可能占用了太多内存，这可能是导致错误的原因。所以我决定尝试这种方法，看看它是否有帮助。它没有。有谁知道为什么会发生这种情况？

顺便说一句，ID 是一个 INT 并且 ITEMDESCRIPTION 是一个 VARCHAR(32000) 列。如果有什么不同，数据库是 Borland Interbase 6.0 (Ick!)

编辑：在描述抛出异常的位置时，我给出了错误的行！啊！！现在修好了。另外，到目前为止，我已经尝试了建议的方法，但它们没有帮助。但是，我发现只有数据库中非常旧的记录导致了这个错误，这很奇怪。如果我将查询更改为仅提取过去 5 年插入的记录，则没有问题。有人向我建议这可能是编码转换问题或类似的问题？

**更新：**解决了。这个问题原来是我们不太可靠的数据库软件的 ODBC 驱动程序中的一个错误。使用其他驱动程序的解决方法解决了该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T02:27:03.093

在这里黑暗中拍摄...

Try executing your reader, saving your result (maybe in an array or list), and making sure the reader is closed before executing or preparing the next command. You may even want to go extreme and put your getItemsCommand construction inside a using block so you know that it has no resources open before you execute your next command...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T06:21:32.043

It could be a bug in the ODBC driver you are using. What driver is it? What is your connection string?

# project-management - 开发人员应该在项目的什么时候开始“吃自己的狗粮”？

> ID：228277
> 
> 赞同：8
> 
> 时间：2008-10-23T02:01:30.540
> 
> 标签：project-management

我们有一个项目即将推出，PM 坚持团队应该“吃自己的狗粮”？

在什么时候这样做是现实的？

例如假设我们必须编写一个编辑器。我们不能在一开始就使用这个编辑器来实际编码，因为它不存在。我们必须使用另一个编辑器。

在项目期间的一段时间内，使用有问题的编辑器会减慢项目的速度，并且会适得其反。

那么我们在什么时候切换呢？

更新：经过团队内部的一些讨论，我们在开发过程中会强调的要点是：

*   实施可能的最小子集开始
*   尽快识别关键特征
*   只切换部分开发者使用新产品，将风险降至最低

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T02:03:46.713

*你们中的一些*人应该尽快使用它。第一个版本应该被精简，只有你*需要*的最重要的功能才能将它用作（在这种情况下）编辑器。一旦你开始使用它，你会很快发现哪些功能很重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T02:12:56.977

<咆哮>

不生产狗粮，就不用吃狗粮。

无论如何，这个病态和愚蠢的短语的起源是什么？狗不生产自己的食物（有一个粗俗的例外）......

</rant>

问 PM 更重要的是：使用正在开发的产品进行开发，还是按时生产高质量的代码？如果有冲突，哪个更重要？

常识性的答案是：当你正在构建的东西*比你拥有的工具更好*时，就使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T02:04:46.040

您不必切换到专门使用开发编辑器。开始使用它，直到它影响你的生产，列出有问题的东西，修复它们，重复直到你能够在大多数/所有时间有效地使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T02:07:33.260

> 在项目期间的一段时间内，使用有问题的编辑器会减慢项目的速度，并且会适得其反。

听起来你有你的答案。切换的时间是当您的项目不会妨碍生产力时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T02:17:27.717

这是那些“取决于”问题之一。一些指导：

*   在项目完全出炉之前使用该项目有哪些风险？他们可以接受吗？
*   项目进展会更快还是更慢，这是一个问题吗？
*   从商业角度来看，最终产品的质量会提高吗？
*   您最终会得到使程序员更有效率但对客户无用的功能吗？
*   相反，是否会因为开发人员对它们不“感兴趣”而推迟关键功能？
*   “狗粮的味道”会激励您的开发人员吗？

也许最有帮助的指南是我称之为“Headrick 规则”的东西，以首先向我解释它的同事之后：

> 如果您需要某人完成某事，请让他*不*完成它而痛苦！

当然，另一方面是让尽可能快地完成项目变得愉快。就个人而言，我喜欢构建和使用工具，所以我会在谨慎允许的情况下尽快提供狗粮。但我的同事是一个虐待狂，他会回答：“只要它编译好！”

祝你的项目好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T03:08:11.250

一切都与大小、可扩展性和范围有关。如果该产品能够从“狗粮”方法中获得宝贵的成功，那么 ASAP 将是正确的答案。最终用户体验决定了使用产品的最终结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T02:05:20.580

根据正在完成的开发方式，您可以提前或稍后切换。如果您使用的是 TDD 方法，或者在列表中查找和修复错误的位置较高，那么只要您有足够的功能，您觉得可以帮助您的日常生活，我就会开始。如果您有效地确定了功能的优先级，那么这可能是开发的早期阶段。

否则我会等到你进入一些后期阶段，pre alpha 或 pre beta。这意味着您在发育早期不会感到太多痛苦。

正如其他人所提到的，如果您可以改变您的开发工作以尝试使产品更早可用，那就去做吧！我建议让人们尽早开始认真使用该产品，以帮助评估各种功能并让您的初始用户对产品产生情感上的依恋。关心的开发人员通常会付出额外的努力来使项目变得更好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T02:05:42.560

这是关于找到你的“临界质量”特征是什么。如果只是错误而不是功能问题，请立即切换。修复你的错误。如果您需要在工具变得有用之前进行功能开发，请完成这些关键功能，然后切换。

我真诚地希望你不是在写编辑器！;-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T02:07:20.653

我想正确的答案是尽快。当然，使用有缺陷的版本一开始会减慢您的速度，但随后您将在开发过程中执行 QA，因此从长远来看，您将节省时间。如果应用程序中存在阻塞，我会建议您的一些团队而不是整个团队切换，以防止大量持有。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T19:33:54.257

在它达到“Alpha”阶段之前不要开始使用它。它应该具有完整的所有主要功能并且没有已知的严重错误。然后你就可以开始使用它了。

让目标用户试用也很重要，而不仅仅是开发人员（除非它是开发人员工具）。

您想留出足够的开发时间来适应尽可能多的“如果这样做会不会很棒？” 尽可能的特色。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-31T19:44:56.450

当应用于开发团队自己不会使用的软件时，这个问题是没有意义的，因此开发人员应该尽快使用它。“可行”意味着它可以很好地工作，并且不会把事情破坏得太严重。

在开发文本编辑器时，开发人员应该尽早使用它，因为错误并不重要。在开发版本控制系统时，开发人员应该只在它被证明是可靠的时候才使用它。当 Subversion 团队离开他们的 CVS 服务器时，这是一件大事。

一个想法是在团队中拥有更早和更晚的采用者，因为后来的采用者可能会发现早期的采用者已经视而不见的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-23T02:51:19.397

当狗粮变得开胃时，尽快。我想这是另一种说法，即您应该尽早并经常交付价值。顺便说一句，**永远不要**提供已知的有缺陷的软件。没有错误的更少功能比有错误的更多功能更好。

# c# - 我如何知道 Windows 何时进入/退出睡眠或休眠模式？

> ID：228288
> 
> 赞同：25
> 
> 时间：2008-10-23T02:04:46.993
> 
> 标签：c#, windows, sleep-mode, hibernate-mode

是否可以订阅在 Windows 进入或退出睡眠或休眠状态时触发的 Windows 事件？

我需要让我的应用程序知道计算机何时进入睡眠状态以进行一些清理，并避免在它退出睡眠时出现计时问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-23T03:06:22.517

[`Microsoft.Win32.SystemEvents.PowerModeChanged`](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx)活动将为您提供此信息。此事件在 Microsoft 迄今为止发布的所有 .NET 框架变体中都可用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-23T03:05:15.763

在 .NET 中，使用[PowerModeChanged](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx)事件。在 Win32 中，使用[WM_POWERBROADCAST](http://msdn.microsoft.com/en-us/library/aa373247(VS.85).aspx)消息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-24T17:30:27.960

在 Visual Studio 2005 C++ MFC 应用程序中，您需要向`ON_MESSAGE()`消息映射中添加一个以查找`WM_POWERBROADCAST`消息，如下例所示：

```
BEGIN_MESSAGE_MAP(CFrameworkWndDoc, CWindowDocument)
    //{{AFX_MSG_MAP(CFrameworkWndDoc)
    ON_WM_CHAR()
    ON_WM_TIMER()
    //}}AFX_MSG_MAP
    ON_MESSAGE(WM_POWERBROADCAST, OnPowerMsgRcvd)
END_MESSAGE_MAP() 
```

然后，您需要添加消息处理函数以及类定义更改以声明消息处理程序的成员函数，以便您可以检查`wParam`消息类型的变量，如下面的框架：

```
// Handle the WM_POWERBROADCAST message to process a message concerning power management
// such as going to Sleep or Waking Up.
LRESULT CFrameworkWndDoc::OnPowerMsgRcvd(WPARAM wParam, LPARAM lParam)
{
    switch (wParam) {
        case PBT_APMPOWERSTATUSCHANGE:
            TRACE0("PBT_APMPOWERSTATUSCHANGE  received\n");
            break;
        case PBT_APMRESUMEAUTOMATIC:
            TRACE0("PBT_APMRESUMEAUTOMATIC  received\n");
            break;
        case PBT_APMRESUMESUSPEND:
            TRACE0("PBT_APMRESUMESUSPEND  received\n");
            break;
        case PBT_APMSUSPEND:
            TRACE0("PBT_APMSUSPEND  received\n");
            break;
    }

    return 0;
} 
```

我所看到的是，在调试器中启动的 Windows 7 上运行的应用程序中使用上述测试，然后我手动使运行应用程序的 PC 进入睡眠状态，我将看到以下消息：

```
PBT_APMSUSPEND  received 
```

然后，当 PC 重新启动并登录时，我将在调试器输出窗口中看到一条接一条的两条消息：

```
PBT_APMRESUMESUSPEND  received
PBT_APMRESUMEAUTOMATIC  received 
```

到目前为止，我发现的所有内容都表明您不知道您是退出睡眠状态还是休眠状态。我仍在进一步研究暂停或恢复文件和设备处理时需要做什么。我已经看到恢复后 COM 端口的文件句柄不再有效的迹象。我也不确定实例数据库连接的其他进程的接口。

除了标准的睡眠和休眠电源管理状态外，Microsoft 还引入了[Windows 8 和 8.1 的连接待机电源状态，](https://msdn.microsoft.com/en-us/library/windows/hardware/dn481216(v=vs.85).aspx)根据应用程序的类型，它具有一些应用程序设计分支。

> 桌面应用程序通常不需要额外的工作来与连接待机集成。
> 
> Desktop Activity Moderator (DAM) 是 Windows 组件，可在连接待机期间暂停所有桌面应用程序并限制第三方系统服务的运行时间。DAM 的目的是保持与现有应用程序和服务的基本软件兼容性，但减轻它们在睡眠期间对电池寿命的影响。
> 
> 在 DAM 阶段完成后，Windows 会阻止桌面应用程序在连接待机的任何部分运行。Windows 允许第三方系统服务在完成 DAM 阶段后以节流模式执行。在这种模式下，第三方服务每 30 秒可以运行不超过一秒的挂钟时间。

[来自 Intel的 Lynn Merrill 的优雅应用程序暂停艺术](https://software.intel.com/sites/default/files/m/8/8/2/c/9/29388-217019_217019.pdf)有一些关于在 Windows 下处理与电源管理相关的各种 Windows 消息类型的信息，但是它是 2005 年的，因此并非所有材料都可能与 Windows XP 之后的 Windows 有关。在本文档中描述的消息序列中至少有一条不再使用的消息，从 Windows Vista 开始，`PBT_APMQUERYSUSPEND`用于请求应用程序是否能够挂起的消息不再被 Windows 使用。该`SetThreadExecutionState()`函数现在用于指示线程不能因更改为睡眠或休眠状态而中断。有关电源管理状态消息更改的详细信息，请参阅 stackoverflow [Can't catch sleep suspend messages (winxp)中的答案。](https://stackoverflow.com/questions/727154/cant-catch-sleep-suspend-messages-winxp)

**自 Windows XP 以来的系统电源状态事件**

自 Windows XP 以来，Microsoft 改进了电源管理，因为各种版本的 Windows 操作系统共享更多组件，并且 Windows 版本现在部署在需要更仔细电源管理的电池的小型设备上。请参阅[注册电源事件](https://docs.microsoft.com/en-us/windows/win32/power/registering-for-power-events)。既有`RegisterPowerSettingNotification()`功能又有`UnregisterPowerSettingNotification()`功能。

> 应用程序或服务使用该`RegisterPowerSettingNotification` 功能注册通知。当相应的电源设置发生变化时，系统会发送如下通知：
> 
> *   应用程序接收到`WM_POWERBROADCAST`带有 a `wParam`of`PBT_POWERSETTINGCHANGE`和 an的消息，该消息`lParam`指向一个 `POWERBROADCAST_SETTING`结构。
> *   服务`HandlerEx`通过调用该函数接收对其注册的回调函数的调用`RegisterServiceCtrlHandlerEx`。`lpEventData`发送给回调函数的 参数`HandlerEx`指向一个`POWERBROADCAST_SETTING`结构。
> 
> 在`POWERBROADCAST_SETTING`结构中，`PowerSetting`成员包含标识通知的 GUID，数据成员包含电源设置的新值。

另请参阅[电源管理函数](https://docs.microsoft.com/en-us/windows/win32/power/power-management-functions)以获取自 Windows Vista 以来 Windows API 中的电源管理函数列表。

**系统电源状态和电池状况**

您可以使用 Windows 系统服务 API 函数`GetSystemPowerStatus()`来检索当前的电源状态。

> 检索系统的电源状态。该状态指示系统是使用交流电源还是直流电源运行、电池当前是否正在充电、电池寿命剩余多少以及电池保护程序是打开还是关闭。

但是请注意，`SYSTEM_POWER_STATUS`结构中返回的信息是**关于电池状态和 AC/DC 电源的，而不是实际的设备电源状态，例如 Sleep 或 Hibernate**。

如果 Windows 设备处于睡眠或休眠状态，您的应用程序将不会运行，因此该函数不能用于确定当前的 Windows 电源状态。我包含此注释，因为它可能对在研究此主题时到达此帖子的人有用。

*   [GetSystemPowerStatus 函数 (winbase.h)](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getsystempowerstatus?redirectedfrom=MSDN)
*   [SYSTEM_POWER_STATUS 结构 (winbase.h)](https://docs.microsoft.com/en-us/windows/win32/api/winbase/ns-winbase-system_power_status)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-23T02:11:32.703

可以监控[Win32_PowerManagementEvent](http://msdn.microsoft.com/en-us/library/aa394362(VS.85).aspx) WMI 事件

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-23T03:58:32.037

不确定您希望多久监控一次，但如果您在 .NET 中编写服务，您可以覆盖 ServiceBase，将 CanHandlePowerEvent 设置为 true，然后您将通过 PowerBroadcastStatus 枚举收到电源更改通知。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-31T19:53:27.503

您可以订阅 NetworkChange.NetworkAvailabilityChanged 和 NetworkChange.NetworkAddressChanged。

我通常会启动一个两秒钟的计时器，以便在超时时处于睡眠模式后可以恢复网络通信。

# c# - 删除文件锁

> ID：228300
> 
> 赞同：2
> 
> 时间：2008-10-23T02:07:43.057
> 
> 标签：c#, file-io, locking

我需要从文件处于锁定状态的错误情况中恢复。我如何在 c# 中告诉这个文件重置它的锁？我需要添加到这个文件是由第 3 方 dll 打开的，我实际上无权访问文件句柄。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T02:24:52.943

锁定文件是操作系统（代表打开它的程序）的责任。如果文件处于锁定状态，则完全取决于操作系统来解锁。这通常在打开文件的进程退出时自动发生。

但是，我遇到了一个非常酷的实用程序，它会有所帮助。它被称为[解锁器](http://www.emptyloop.com/unlocker/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T02:32:47.170

我真的会考虑寻找另一个 3rd 方 dll。任何处理 Streams 的系统都应该正确响应错误条件，而不是保留文件锁定之类的东西。

该库是否有可能提供错误条件清理，您刚刚看过它？尝试类似以下的方法，

```
 try {
   thirdPartyObj = new ThirdPartObj();
   // Some possible error causing object actions
 catch(Exception ex) {
   thirdPartyObj = null; // The object should close its resources
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T02:53:22.823

您也许可以使用以下内容启动命令行进程，例如 net 或 psfile：

`System.Diagnostics.Process.Start("psfile c:\myfile.txt -c");`

[您可以在此处](http://technet.microsoft.com/en-us/sysinternals/bb897552.aspx)获取 psfile 。

你也可以使用

`net file ID /close`

但这需要您知道文件 ID，这需要更多的工作。

未经测试，但这应该给你一个起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T02:10:32.877

您必须使用 .Close() 关闭文件。您需要确保您仍然可以访问文件对象。

您通常可以通过在执行文件 I/O 的代码之后编写 try{} ... finally {} 构造来避免此错误。在 finally {} 块中，您将调用文件对象的 Close 方法，以防止出现这种情况。您还可以在创建文件时使用 using {} 块，这也可以解决此问题。

# c++ - 是否有任何 C++ 库可以从 Windows 文件夹中的 thumb.db 读取缩略图？

> ID：228304
> 
> 赞同：5
> 
> 时间：2008-10-23T02:08:39.980
> 
> 标签：c++, windows, image

我想在 Windows XP 中读取包含图像的文件夹中的所有缩略图。但是如果我读取图像文件来获取缩略图，它似乎有点慢，所以我希望我可以先读取 windows 图像缩略图缓存：thumb.db。c++ 或 c 中是否有任何库可以从 thumb.db 读取缩略图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T04:04:36.330

Thumbs.db 文件以 OLE[复合文档](http://msdn.microsoft.com/en-us/library/ms693383.aspx)格式存储，许多 Microsoft Office 产品使用的格式相同。

您也可以尝试查看[ThumbsDBLib](http://www.petedavis.net/MySite/DynPageView.aspx?pageid=31)。它在 C# 中，但您可能会看到他们如何读取数据并将其转换为 C++。

注意：Windows Vista 和更高版本不使用 Thumbs.db。请参阅 Vista 及更高版本的[IThumbnailCache 界面](http://msdn.microsoft.com/en-us/library/bb774628(VS.85).aspx)。

对于 Vista 和更高版本，它们存储在此处：%homedrive%\Users\%username%\AppData\Local\Microsoft\Windows\Explorer

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T09:15:04.740

您可能会发现这很有用：

C++ 中的 ThumbsDBLib

[http://www.windameister.org/blog/index.php/thumbslib-in-cpp](http://www.windameister.org/blog/index.php/thumbslib-in-cpp)

# vba - 使用 VBA 合并 Excel 表格

> ID：228318
> 
> 赞同：2
> 
> 时间：2008-10-23T02:15:03.493
> 
> 标签：vba, excel

我有一个 Excel 表（比如 OG.xls），其中已经有一些数据，其中有大约 5000 行，第一行有标题，最多有“AN”列。这个行数（5000）一整年都不会改变。现在我有 5 个 XL 文件（比如 A、B、C、D、E），这些文件中的数据每次都必须从第 5001 行开始附加到这个 OG 文件中。这 5 个文件的列数不同，但与 OG 文件的列数相同。我必须从这些文件中提取数据并将它们放在 OG 文件中。从文件 A：A、B、C、D、E、F、G&H 列转到 OG.xls 文件的 F、G、T、U、V、W、X&Y 列。同样，必须根据 OG.xls 的相应列提取其他文件数据

第二个文件数据必须附加在文件 A 结束的下一行的正下方。（假设从文件 A 填充数据后，现在 OG.xls 有 5110 行，文件 B 数据必须从 OG 的第 5111 行填充.xls. 其他文件也一样. 这5个文件的数据必须逐行填写，但应与OG.xls的列匹配

每次通过填充 OG.xls 的第 5001 行的数据来重复相同的操作。为方便起见，我们可以将所有这些文件放在同一个文件夹中。

我们应该怎么做。

请帮我解决这个问题！！！也让我知道任何澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T05:07:58.700

如果您需要更准确的答案，则需要先尝试一些事情，然后在遇到困难的地方寻求帮助。我的建议是你开始；1\. 开始在 OG.XLS 中编写 VBA 脚本，第一步尝试访问文件 A.xls 并读取列并粘贴它们（它们最初可以以任何顺序位于任何位置）。2\. 一旦你能够做到这一点，下一步就是通过设置正确类型的变量并使用它们并增加它们来查看你是否将数据放在正确的列中（比如你的例子中的 5000）。3\. 您的下一步应该是阅读 A.XLS 中的列标题并找到它们 OG.XLS 并识别它们。最初你可以从做一个简单的字符串比较开始，稍后你可以改进它来做一个 VLOOKUP。4、在此过程中，如果遇到具体问题，请提出，以便得到更好的答复。

社区中很少有人愿意为您编写整个代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T05:52:22.743

为什么A列最终在F列中，为什么C列最终在T中？是否有围绕此的规则，例如第一行是带有相同文本的标题？

也许一张照片可能会有所帮助。

根据我的猜测，我会将每张工作表放入具有有意义字段名称的 RecordSet 中（您需要参考`Microsoft ActiveX Data Objects 2.8 Library`）。完成后，将非常容易附加每个 RecordSet 并将它们放入单个工作表中。

您需要能够找到每张工作表中的最后一列和最后一行才能干净地执行此操作，因此请查看[如何找到最后一行...](https://stackoverflow.com/questions/71180/how-can-i-find-last-row-that-contains-data-in-the-excel-sheet-with-a-macro)

**编辑...**

下面是一个清理示例，说明如何在 VBA 中执行所需的操作。问题在于诸如空白工作表、如何处理公式（这完全忽略它们）以及如何以适当的方式合并列（再次被忽略）等细节。

这已在 Excel 2007 中进行了测试。

```
Option Explicit
Const MAX_CHARS = 1200

Sub MergeAllSheets()
  Dim rs As Recordset
  Dim mergedRS As Recordset
  Dim sh As Worksheet
  Dim wb As Workbook

  Dim fieldList As New Collection
  Dim rsetList As New Collection

  Dim f As Variant
  Dim cols As Long
  Dim rows As Long
  Dim c As Long
  Dim r As Long

  Dim ref As String
  Dim fldName As String
  Dim sourceColumn As String

  Set wb = ActiveWorkbook
  For Each sh In wb.Worksheets
    Set rs = New Recordset
    ref = FindEndCell(sh)
    cols = sh.Range(ref).Column
    rows = sh.Range(ref).Row

    If ref <> "$A$1" Or sh.Range(ref).Value <> "" Then '' This is to catch empty sheet
      c = 1
      r = 1
      Do While c <= cols
        fldName = sh.Cells(r, c).Value
        rs.Fields.Append fldName, adVarChar, MAX_CHARS
        If Not InCollection(fieldList, fldName) Then
          fieldList.Add fldName, fldName
        End If
        c = c + 1
      Loop
      rs.Open

      r = 2
      Do While r <= rows
        rs.AddNew
        c = 1
        Do While c <= cols
          rs.Fields(c - 1) = CStr(sh.Cells(r, c).Value)
          c = c + 1
        Loop
        r = r + 1
        Debug.Print sh.Name & ": " & r & " of " & rows & ", " & c & " of " & cols
      Loop
      rsetList.Add rs, sh.Name
    End If
  Next

  Set mergedRS = New Recordset
  c = 1
  sourceColumn = "SourceSheet"
  Do While InCollection(fieldList, sourceColumn) '' Just in case you merge a merged sheet
    sourceColumn = "SourceSheet" & c
    c = c + 1
  Loop
  mergedRS.Fields.Append sourceColumn, adVarChar, MAX_CHARS
  For Each f In fieldList
    mergedRS.Fields.Append CStr(f), adVarChar, MAX_CHARS
  Next
  mergedRS.Open

  c = 1
  For Each rs In rsetList
    If rs.RecordCount >= 1 Then
      rs.MoveFirst
      Do Until rs.EOF
        mergedRS.AddNew
        mergedRS.Fields(sourceColumn) = "Sheet No. " & c
        For Each f In rs.Fields
          mergedRS.Fields(f.Name) = f.Value
        Next
        rs.MoveNext
      Loop
    End If
    c = c + 1
  Next

  Set sh = wb.Worksheets.Add

  mergedRS.MoveFirst
  r = 1
  c = 1
  For Each f In mergedRS.Fields
    sh.Cells(r, c).Formula = f.Name
    c = c + 1
  Next

  r = 2
  Do Until mergedRS.EOF
    c = 1
    For Each f In mergedRS.Fields
      sh.Cells(r, c).Value = f.Value
      c = c + 1
    Next
    r = r + 1
    mergedRS.MoveNext
  Loop
End Sub

Public Function InCollection(col As Collection, key As String) As Boolean
  Dim var As Variant
  Dim errNumber As Long

  InCollection = False
  Set var = Nothing

  Err.Clear
  On Error Resume Next
    var = col.Item(key)
    errNumber = CLng(Err.Number)
  On Error GoTo 0

  '5 is not in, 0 and 438 represent incollection
  If errNumber = 5 Then ' it is 5 if not in collection
    InCollection = False
  Else
    InCollection = True
  End If

End Function

Public Function FindEndCell(sh As Worksheet) As String
  Dim cols As Long
  Dim rows As Long
  Dim maxCols As Long
  Dim maxRows As Long
  Dim c As Long
  Dim r As Long

  maxRows = sh.rows.Count
  maxCols = sh.Columns.Count

  cols = sh.Range("A1").End(xlToRight).Column
  If cols >= maxCols Then
      cols = 1
  End If

  c = 1
  Do While c <= cols

    r = sh.Cells(1, c).End(xlDown).Row
    If r >= maxRows Then
      r = 1
    End If

    If r > rows Then
      rows = r
    End If
    c = c + 1
  Loop

  FindEndCell = sh.Cells(rows, cols).Address

End Function 
```

# iphone - 导航控制器透明条样式不起作用

> ID：228319
> 
> 赞同：10
> 
> 时间：2008-10-23T02:15:17.610
> 
> 标签：iphone, cocoa-touch

我正在使用导航控制器，并且我将样式设置为：

```
navController.navigationBar.barStyle = UIBarStyleBlackTranslucent; 
```

但是当我运行我的程序时，导航控制器看起来像是在白色背景之上，而不是我的背景。当我向左或向右推动控制器时，我的所有视图，即当前视图，都会移动到顶部，正好与导航栏的大小一致。在那里我可以通过导航控制器栏看到我的背景。有任何想法吗？当我的 barStyle 设置为不透明时，一切看起来都很好。我正在考虑将我的视图框架设置为负 'y' 值，但我认为应该有更优雅的方式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T02:30:26.457

我相信 UINavigationController 假定您的控制器视图框架不包括导航栏下方的区域。

UIBarStyleBlackTranslucent 更常用于 UIToolbar，因此 Apple 可能没有让 UINavigationBar 很好地使用它。如果您想在栏区域下可靠地渲染，您可能需要放弃 UINavigationController，或者开始修改框架（小心旋转）。

此外，如果您的意图是在几秒钟后隐藏导航栏，如果您让它淡出（如照片应用程序）而不是尝试向上滑动（如 Mobile Safari） ，您将有**更轻松的时间。**相信我……这让我花了*很多*时间来艰难地学习。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-11T10:30:10.447

只需使用透明背景图像，并且 translucent = YES 允许内容在条形下方流动。适用于 iOS 5 / 6。添加 viewDidLoad。

```
self.navigationController.navigationBar.translucent = YES;
UIImage * backgroundImage = [UIImage imageNamed:@"spacer.gif"];
[self.navigationController.navigationBar setBackgroundImage:(UIImage *)backgroundImage forBarMetrics:UIBarMetricsDefault]; 
```

我在这里附加了 spacer.gif 图像，一个 1px x 1px 的透明图像。

![间隔.gif](https://i.stack.imgur.com/MzQkt.gif)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T07:43:23.303

```
self.navigationController.navigationBar.tintColor = [UIColor colorWithRed:0.169 green:0.373 blue:0.192 alpha:0.9];
self.navigationController.navigationBar.translucent = YES; 
```

笔记：

1.  不要使用`self.navigationBarStyle`和`self.navigationBarTintColor`改变。
2.  将最后两个语句添加到您的`viewDidLoad`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-20T17:45:05.040

我遇到了同样的问题（在 3.1.3 中），虽然您无法在设置 navigationBar 后设置栏样式，但您可以随时设置 tintColor 和半透明值：

```
 self.navigationController.navigationBar.tintColor = [UIColor blackColor];
    self.navigationController.navigationBar.translucent = YES; 
```

将创建“blackTranslucent”栏，当我将某些视图控制器推入堆栈时，我会更改导航栏的外观。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T20:46:33.967

我遇到了同样的问题，我通过使根视图的背景与我的视图相同来解决它。导航栏后面的白色区域原来是根视图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T03:08:09.563

导航控制器偏移了所有子视图的坐标系，因此它们在导航栏下方绘制。

将视图的框架扩展到负 y 域，以便在导航栏下绘制。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-28T18:15:42.500

您需要在 info.plist 文件中设置 barstyle 以正确偏移所有内容。

但是，自从 2.1 f/w 发布以来我还没有尝试过，但是当我在 2.0 中尝试时，我发现从纵向旋转到横向后设置丢失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-20T15:44:15.770

尝试使用它，可能会有所帮助。

```
_topToolBar.barStyle = UIBarStyleBlackTranslucent;
_topToolBar.alpha = 0.3; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-09T10:14:44.853

我有同样的问题。我解决了！

```
ImageViewExtendController *detailImageController = [[ImageViewExtendController alloc] init];  
[detailImageController loadImage:url];
[self.navigationController pushViewController:detailImageController animated:YES]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T16:08:04.997

如果您在应用程序委托中足够早地将导航控制器的导航栏设置为透明（在将导航控制器添加到窗口之前它对我有用），它会自动将您的视图向上移动到导航栏下方。

不幸的是，它也不会改变您在状态栏下方的视图。可悲的是，您似乎需要实现自己的 UINavigationController 版本。幸运的是，它还不错，因为 UINavigationBar 非常可重用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-18T09:01:25.987

试试这个：

```
self.tabBarController.tabBar.superview.backgroundColor = [UIColor blackColor]; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-08T17:35:58.263

更改子 viewControllers 中的 Extend Edges 选项

例如，在 xcode 编辑器中，转到您的第一个 viewcontroller 子级并取消设置选项：

```
Extend Edges;
    Under Top Bars;
    Under Bottom Bars;
    Under Opaque Bars; 
```

这样，您的子 ViewController 将不会从导航控制器的状态栏下方开始布局，无论是标签栏还是工具栏

希望它可以帮助任何人

# c - 声明指向 __far 指针的指针的正确方法是什么？

> ID：228321
> 
> 赞同：3
> 
> 时间：2008-10-23T02:17:08.153
> 
> 标签：c, pointers, embedded

在嵌入式目标上，我使用远指针来访问内存映射的某些部分。

near 指针（没有明确指定 __near）：

```
无符号整数 *VariableOnePtr;
```

指向近端指针的指针：

```
无符号整数 **VariableOnePtrPtr;
```

远指针：

```
unsigned int *__far VariableTwoPtr;
```

声明指向远指针的指针的正确方法是什么？这个指针本身必须是远指针吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T02:20:51.953

我相信你会这样做：

```
unsigned int * __far *VariableThreePtrPtr; 
```

指向远指针的远指针将是：

```
unsigned int * __far * __far VariableFourPtrPtr; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T23:24:04.877

“__far”是您平台的专有、非标准扩展，因此不存在任何通用方式来使用它。请参阅编译器和标准库制造商的手册以了解如何正确使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T03:48:52.900

您也可以为此使用 typedef，例如

```
typedef unsigned int *__far VariableTwoPtr_t;
VariableTwoPtr_t* VariableTwoPtrPtr; 
```

# lisp - 如何编写这个 Lisp / Scheme 代码？

> ID：228353
> 
> 赞同：6
> 
> 时间：2008-10-23T02:34:17.260
> 
> 标签：lisp, scheme

一个 lambda 表达式，它接受一个函数（一个参数）和一个数字，并将该函数应用于两倍的数字。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-23T02:38:05.023

将函数应用于两倍的数字：

```
(lambda (f x) (f (* 2 x))) 
```

将函数应用于数字两次（这可能是您想要问的）：

```
(lambda (f x) (f (f x))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T03:39:03.247

Greg 的答案是正确的，但您可能会考虑如何分解这个问题以自己找到答案。这是一种方法：

```
; A lambda expression
;(lambda () )

; which takes a function (of one argument) and a number
;(lambda (fun num) )

; and applies the function
;(lambda (fun num) (fun num))

; to twice the number
;(lambda (fun num) (fun (* 2 num)))

((lambda (fun num) (fun (* 2 num))) + 12) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T03:50:43.427

这是另一种方法：

编写合同、目的和标题：

```
;; apply-double : function -> number -> any
;; to apply a given function to double a given number
(define (apply-double fun num) ...) 
```

编写一些测试：

```
(= (apply-double identity 10) 20)
(= (apply-double - 15) -30)
(= (apply-double / 7) 1/14) 
```

定义函数：

```
(define (apply-double fun num) 
  (fun (* 2 num))) 
```

这是这里食谱的缩写：http: [//www.htdp.org/2003-09-26/Book/](http://www.htdp.org/2003-09-26/Book/)

# c# - 在代码中获取 CSproj 路径

> ID：228375
> 
> 赞同：1
> 
> 时间：2008-10-23T02:47:57.250
> 
> 标签：c#

如何获取当前csproject的路径？

假设我有一个 csproject name `MyProj.csproj`，里面有一个类想知道这个 csproj 的文件路径是什么，关于如何做到这一点的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T02:57:47.057

除非您正在谈论为 Visual Studio 创建插件，否则一旦您的程序编译并运行，CsProj 文件就不再存在（就您的代码而言）。

CsProj 实际上用于指示编译器如何将 C# 代码编译成程序集。之后，CsProj 将留在开发人员的工作站上，因为您的应用程序的“最终用户”不需要它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T04:15:19.973

如果你真的必须这样做，我会考虑元编程。在您的解决方案中创建另一个项目，该项目构建一个带有一个参数的命令行 exe。命令行 exe 项目应该输出一个 cs 文件，其中包含一个类，该类具有一个静态属性，该属性返回在命令行中传递的值。

然后，作为其他项目的预构建步骤，使用 ProjectDir 变量调用此命令行 exe（您需要构建顺序，以便首先构建命令行 exe），以便命令行参数是您的项目目录.

您还需要您的 csproj 包含将由命令行输出的文件，以便将其合并到您编译的程序集中。您的主要汇编代码可以调用生成的类的静态属性，从而访问路径。

当然，仅仅因为你能做到这一点，并不意味着你应该这样做；我只是假设您已经确定必须为您的项目执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-09T10:01:45.023

我刚刚发现了这一点，并且有一个非常简单的方法可以使用 Roslyn 来完成。

```
string solutionPath = @"C:\Users\...\PathToSolution\MySolution.sln";
var msWorkspace = MSBuildWorkspace.Create();

var solution = msWorkspace.OpenSolutionAsync(solutionPath).Result;
foreach (var project in solution.Projects)
{
    foreach (var document in project.Documents)
    {
        //get all C# Files here
    }
} 
```

如果您只想拥有 CSproj 文件。你可以得到这样的路径

```
var path=solution.FilePath; 
```

# javascript - 网站可以强制浏览器进入全屏模式吗？

> ID：228377
> 
> 赞同：12
> 
> 时间：2008-10-23T02:49:40.787
> 
> 标签：javascript, html, browser, window

我想进行一项心理学研究，参与者必须查看大图像。

该实验是在网络上完成的，因此是在浏览器窗口中完成的。是否可以告诉浏览器进入全屏模式，例如按下按钮？

我知道有可能打开一个固定大小的弹出窗口。您认为这将是一个可行的替代方案吗？如果，最好的方法是什么？是否有优雅的方法来检测弹出窗口阻止程序，以回退并在原始浏览器窗口中运行研究。

主要担心的是这项研究的参与者不熟悉技术细节，不应该被他们打扰。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T03:02:08.080

您可以告诉用户按 F11。在它旁边，放一个“为什么？” 链接并解释为什么您觉得他们需要处于全屏模式。

我不认为你可以强制浏览器全屏显示，事实上，如果你能做到这一点，我会对我的浏览器感到愤怒。它太具有侵略性了。甚至 Flash 也具有安全性，因此强制插件进入全屏需要事件源自用户交互。所以，如果它对你很重要，这可能是使用 Flash 插件的一个很好的理由，因为你可以将 go-fullscreen 调用附加到一个误导性的按钮上，上面写着“开始测验”（或其他）。

但是，请不要那样做。直接与用户直接联系并告诉他们按 F11。

编辑：我刚刚尝试了另一条评论中提供的示例代码，我很高兴地说 Firefox 打开了一个带有地址栏的最大化窗口，而不是全屏窗口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T02:58:12.360

没有办法将当前窗口调整为全屏，但您可以全屏打开一个弹出窗口：

```
<script type="text/javascript">
<!--
function popup(url) 
{
 params  = 'width='+screen.width;
 params += ', height='+screen.height;
 params += ', top=0, left=0'
 params += ', fullscreen=yes';

 newwin=window.open(url,'windowname4', params);
 if (window.focus) {newwin.focus()}
 return false;
}
// -->
</script>

<a href="javascript: void(0)" 
   onclick="popup('popup.html')">Fullscreen popup window</a> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-17T20:02:05.073

我在搜索后找到了一些代码。

```
function fullscreen() {
    var element = document.getElementById("content");
    if (element.requestFullScreen) {
        if (!document.fullScreen) {
            element.requestFullscreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize_actual.png");
        } else {
            document.exitFullScreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize.png");
        }

    } else if (element.mozRequestFullScreen) {

        if (!document.mozFullScreen) {
            element.mozRequestFullScreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize_actual.png");
            google.maps.event.trigger(map, 'resize');
        } else {
            document.mozCancelFullScreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize.png");
        }

    } else if (element.webkitRequestFullScreen) {

        if (!document.webkitIsFullScreen) {
            element.webkitRequestFullScreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize_actual.png");
            google.maps.event.trigger(map, 'resize');
        } else {
            document.webkitCancelFullScreen();
            $(".fullscreen").attr('src',"img/icons/panel_resize.png");
        } 
    } 
} 
```

它将使用 html5 api。我用jquery为它切换了一张特殊的图片。希望这会有所帮助。目前，我不知道你是否可以强制它，因为它被禁止出于安全考虑。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-23T03:10:59.497

在 IE 上以全屏模式打开一个新窗口：

```
<script>
<!--
window.open("page.html","fs","fullscreen,scrollbars")
//-->
</script> 
```

在 page.html 上放置一个“关闭”链接可能是个好主意：

```
<a href="#" onclick="window.close()">Close Window</a> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T02:57:46.027

过去，我见过网站这样做。但是，由于它非常烦人并且通常被 pr0n 网站的广告使用，因此该技术可能会在最近的浏览器中被阻止。

但我认为重要的一点是：它非常烦人，并且通常被 pr0n 网站的广告使用，所以你可能不想将自己关联到哪些这样的东西，所以你最好只要求你的用户最大化他们的浏览器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T03:17:05.833

要修改父窗口，请尝试以下操作：

```
window.opener.location.href = '/confirmation/page.html'; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T02:55:15.830

F11 使 IE 和 Firefox 进入全屏模式。我确信全屏是可能的，因为 YouTube 和其他视频流媒体网站可以使用 Flash，但我不知道如何使用 javascript。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-26T10:47:35.540

此功能对于支持全屏的移动浏览器更有趣。通过点击一个选项，大多数移动浏览器不会有全屏选项。您可以更改为切换到全屏以获得一点应用感觉。

# c# - C# HTML 字体标签解析

> ID：228382
> 
> 赞同：4
> 
> 时间：2008-10-23T02:54:03.697
> 
> 标签：c#, parsing

我需要解析大量使用 HTML 字体标签进行格式化的文本，

例如：

```
<font face="fontname" ...>Some text</font> 
```

具体来说，我需要确定将使用文本中使用的每种字体呈现哪些字符。我需要能够处理另一个字体标签中的字体标签之类的东西。

我需要为此使用 C#。是否有某种 C# 解析器类可以使这更容易？还是我必须自己写？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T02:58:18.943

我没有使用过它，但是我已经看到了经常提到这种类型的[HTML Agility Pack 。](http://www.codeplex.com/htmlagilitypack)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T03:05:28.133

不确定这是否适用于您的情况，因为我不知道预期用途是什么，但是 XSLT 模板的使用呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T08:20:58.700

您可以将 HTML 加载到 Internet Explorer 中，然后在 DOM 中查询字体标签（或 CSS 样式）。

不知道这是否是最好的选择。

# apache-flex - 如何获取正在运行的进程的命令行参数

> ID：228386
> 
> 赞同：2
> 
> 时间：2008-10-23T02:57:06.450
> 
> 标签：apache-flex, flexbuilder

在我的程序中，当我为 mxmlc 使用命令行编译命令时收到错误消息。该错误与系统字体列表中的 flex 未正确识别嵌入字体名称有关。

但是，一时兴起，我决定将代码复制到 Flex Builder 并在那里编译。令我惊讶的是，它起作用了，它使用我给定的相同系统名称 (PMingLiU) 找到了正确的字体。

我怀疑我的问题可能是语言环境问题，并且由于语言环境的考虑，我的系统无法正确识别字体名称。

我尝试将编译代码的语言环境设置为 en_US，但无济于事。所以我想问一下这里是否有人知道Flex Builder是如何调用MXML编译器的，与直接运行mxmlc相比有什么区别？我们知道它没有直接使用 mxmlc.exe，因为我们尝试用我们自己的可执行文件替换 mxmlc 来捕获命令行参数。

如果重要的话，使用的操作系统是 Windows XP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T06:05:11.640

尽管我对您的问题没有确切的答案（Flex Builder 传递给 mxmlc.exe 的命令行参数是什么），但我确实为您提供了元答案。您可以使用两种方法之一找到命令行。

第一个与平台无关，但需要您编译一个小型 C++ 程序。我以前在解决类似问题时使用过这种方法。您可以做的是创建一个包装应用程序，它只是将命令行输出到文件中。构建此应用程序并将其作为 mxmlc.exe 的临时替代品放入，当 Flex Builder 执行它时，您将能够访问生成的文件“cmdline.txt”以获取调用它的完整命令行：

```
#include <iostream>
#include <fstream>
using namespace std;

int main(int argc, char* argv[])
{
  ofstream cmdLine;
  cmdLine.open("cmdline.txt");

  for (int i = 0; i < argc; i++) {
    cmdLine << argv[i];
    if (i < argc)
      cmdLine << " ";
  }

  cmdLine.close();
  return 0;
} 
```

如果您对在 Flex Builder 上玩这个肮脏的把戏感到不妥，假设您在 Windows 上运行，还有另一种选择。您可以使用[WMI](http://en.wikipedia.org/wiki/Windows_Management_Instrumentation)遍历所有正在运行的进程并获取它们的命令行信息。Ruby 是我选择的语言，这需要您安装适用于 Windows 的 Ruby 解释器，您可以使用[One-Click Ruby Installer for Windows](http://rubyinstaller.rubyforge.org/)轻松完成。

安装后，只要 Flex Builder 启动您的构建，就运行此脚本：

```
require 'win32ole'
wmi = WIN32OLE.connect("winmgmts://")
processes = wmi.ExecQuery("select * from win32_process")

for process in processes do
    cmdLine = process.CommandLine
    puts "Command line: #{cmdLine}" if cmdLine =~ /mxmlc/
end 
```

我添加了一个正则表达式，仅打印命令行中以“mxmlc”启动的进程的命令行（这应该可以满足您的需要）。对于迭代每个进程的更通用的解决方案，只需删除包含以下内容的行末尾的 if 子句：

```
puts "Command line: #{cmdLine}" if cmdLine =~ /mxmlc/ 
```

这将为您省去使用 StartRemoteThread 执行任何低级魔法和在 PEB 结构中导航的麻烦。

考虑到您的问题的性质并且没有有关您的开发操作系统的更多信息，这是我能做的最好的事情。如果这解决了您的问题，我可能会建议您编辑您的帖子，以便遇到类似问题的人可以找到此解决方案。像“如何获取正在运行的进程的命令行参数”这样的标题可能更贴切。

# c++ - 扩展现有类，如命名空间 (C++)？

> ID：228404
> 
> 赞同：5
> 
> 时间：2008-10-23T03:06:21.550
> 
> 标签：c++, code-organization

我用第二人称写作只是因为它对你来说很容易。

您正在使用游戏引擎，并且真的希望特定的引擎类有一个新的方法来执行“bla”。但是您不希望将“游戏”代码传播到“引擎”代码中。

所以你可以用你的一个新方法从中派生一个新类，并将该代码放在你的“游戏”源目录中，但也许还有另一种选择？

所以这在 C++ 语言中可能是完全非法的，但你起初认为，“也许我可以通过我自己的头文件向现有类添加一个新方法，其中包括‘父’头文件和一些特殊语法。这在工作时是可能的例如，带有命名空间..."

假设您不能跨多个标头声明一个类的方法（并且您非常确定您不能），那么支持“中间件/引擎/库”和“应用程序”之间明确划分的其他选项是什么，您想知道？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T04:29:22.380

我对您的唯一问题是，“您添加的功能是否需要成为成员功能，还是可以是免费功能？” 如果你想做的事情可以使用类的现有接口来解决，那么唯一的区别是语法，你应该使用一个自由函数（如果你认为那是“丑陋的”，那么......吸干它并继续前进， C++ 不是为猴子补丁设计的）。

如果您试图了解类的内部内容，这可能表明原始类缺乏灵活性（它没有公开足够的信息让您从公共接口中做您想做的事情）。如果是这样的话，也许原来的类可以“完成”，然后你又要在它上面放一个自由函数。

如果这些都不起作用，并且您只需要一个成员函数（例如，原始类提供了您想要获取的受保护成员，并且您没有修改原始接口的自由）......只有然后才诉诸继承和成员函数实现。

如需深入讨论（以及`std::string`' 的解构），请查看[本周大师“Monolith”类文章](http://www.gotw.ca/gotw/084.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T03:22:54.543

听起来像是“作用于”关系，不适合继承（谨慎使用！）。

一种选择是组合实用程序类，它通过使用指向它的指针来实例化“引擎”的某个实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T03:41:19.450

*   继承（如您所指出的），或
*   使用函数而不是方法，或者
*   更改引擎代码本身，但使用 quilt 或 Mercurial/MQ 等补丁管理器隔离和管理更改

不过，我看不出在这种情况下继承有什么问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T04:11:40.887

如果新方法将使用现有的公共接口实现，那么可以说它更加面向对象，因为它是一个单独的函数而不是一个方法。至少，斯科特迈耶斯认为它是。

为什么？因为它提供了更好的封装。IIRC 的论点是类接口应该定义对象所做的事情。Helper 风格的函数是可以用/对对象完成的事情，而不是对象必须自己做的事情。所以他们不属于这个班级。如果他们在类中，他们可以不必要地访问私有成员，从而扩大该成员的隐藏范围，因此如果私有成员发生任何变化，则需要触及的代码行数。

当然，如果你想访问受保护的成员，那么你必须继承。如果您想要的方法需要每个实例的状态，但不能访问受保护的成员，那么您可以根据口味继承或组合 - 前者通常更简洁，但如果关系不是真的“是”，则具有某些缺点.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T03:17:52.790

听起来你想要Ruby mixins。不确定 C++ 中有什么接近的东西。我认为您必须进行继承。

编辑：您也许可以放入一个朋友方法并像混合一样使用它，但我认为您会开始以一种不好的方式破坏您的封装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T03:31:20.267

您可以做一些类似 COM 的事情，其中​​基类支持 QueryInterface() 方法，该方法允许您请求具有该方法的接口。这在 C++ 中实现相当简单，您不需要 COM 本身。

您还可以“假装”成为一种更动态的语言，并将一组回调作为“方法”，并使用模板或宏来调用它们，并将“this”推入堆栈，然后再将其余参数推入堆栈。但这将是疯狂的:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T03:39:04.260

[或Objective C](http://it.toolbox.com/blogs/macsploitation/extending-classes-in-objectivec-with-categories-27447)中的类别。

有一些概念方法可以在 C++ 中扩展类架构（不是单个类），但这不是随意的行为，需要提前计划。对不起。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T03:46:10.300

对我来说，这听起来像是一个经典的继承问题。除非我将代码放在“引擎增强”目录中，并将该概念包含在您的架构中。

# graphics - RGB 用于颜色合成而不是原色

> ID：228407
> 
> 赞同：7
> 
> 时间：2008-10-23T03:07:11.813
> 
> 标签：graphics, colors, rgb

为什么计算机使用 RGB（红色、*绿色*和蓝色）值来进行颜色合成，而不是使用主要色调、红色、*黄色*和蓝色？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T03:12:02.037

品红色、黄色和青色的色调是减色组合（例如油漆或墨水）的主要色调，而不是加色组合（例如以红色、绿色和蓝色为主的光）。

[维基百科有更多关于原因和原因的详细信息](http://en.wikipedia.org/wiki/Primary_colors)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T03:17:15.910

计算机使用加色模型，其中包括将 RGB 加在一起形成白色，这是使用光源时形成颜色的常用方法。

打印机使用减色法，通常使用青色 (C)、品红色 (M) 和黄色 (Y)，通常使用黑色 (K)。缩写 CMYK

青色与红色相对，洋红色与绿色相对，黄色与蓝色相对。

这是对复杂问题的一个非常简单的解释，提出加色法的人是 James Maxwell（是的，就是那个），所以如果你深入研究关于他的许多文章，这可能会更好地解释。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T03:32:09.577

为了澄清起见，您在学校学习的原色被错误地指定为红色、黄色和蓝色。事实上，它们是青色、黄色和品红色，就像您的喷墨打印机一样。正如之前的帖子所述，青色、黄色和洋红色是减色原色；你看到颜料反射了什么。红色、绿色和蓝色是 CRT、等离子和 LCD 使用的加色原色。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T03:18:18.000

为了效率：RGB 模型是加法的。例如，叠加纯红光和纯蓝光，你会得到洋红色。它也很容易内置到监视器中。如果你拿放大镜看你的显示器，你将能够看到单独的红色、绿色和蓝色点，这些点的强度不同，以构成所需的颜色。正如[ffpf](https://stackoverflow.com/questions/228407/rgb-for-color-composition-rather-than-primary-hues#228415)提到的，请查看 Wikipedia。这是关于[RGB 颜色模型](http://en.wikipedia.org/wiki/RGB_color_model)的文章的链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T03:21:01.223

计算机屏幕发光以显示像素。混合不同颜色的光称为[加色](http://en.wikipedia.org/wiki/Additive_color)。加色使用红色、绿色和蓝色作为原色。

[减色](http://en.wikipedia.org/wiki/Subtractive_color)是不同颜色的材料如何混合，例如油漆。减色法使用红色、黄色和蓝色作为原色。

我的看法是，当光线从物体反射到您的眼睛时，该物体会吸收一些颜色，并将其余的颜色反射到您的眼睛。所以如果一个物体是绿色的，这意味着它从白光中吸收了红色和蓝色。这就是为什么混合红色、绿色和蓝色光会产生白光，但混合红色、黄色和蓝色颜料会产生黑色（混合颜料现在会吸收所有原色。）这就是加色光和减色光之间存在差异的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T03:12:51.770

因为组合光源（计算机显示器所做的）与组合印刷油墨的工作方式不同。这只是一个猜测。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-06T10:24:30.643

## 颜色不真实

颜色是一种感知。光以不同的波长或频率存在，但唯一使某个波长看起来是“颜色”的是人类感知的本质。

## 它的长、中和短

眼睛具有三种类型的“锥形”细胞，它们对长、中或短波长（约 700nm 至 380nm）的三种光波段之一敏感。“长”我们认为是红色、中绿色和短蓝色。但每种锥体类型覆盖的范围更广，并且存在一定的重叠，尤其是长锥体和中锥体。

## 这一切都在你的脑海中

大多数人类视觉系统 (HVS) 位于大脑中（大脑的 62% 参与视觉处理）。重叠的视锥细胞反应被眼睛后部的神经节细胞过滤，通过视神经发送，然后由视觉皮层进一步过滤和处理。

## 没有“初选”之类的东西

虽然我们可以将某些颜色称为“原色”，但没有一组只有三种真实颜色可以构成所有其他颜色。例如，Pantone 需要 14 种不同的染料来组成这组颜色，而一个典型的艺术家会在他们的手环上装上十几种颜色来混合。

电视/显示器使用红色、绿色和蓝色“原色”，其波长选择的目的是尽可能独立地刺激眼睛中的三种视锥细胞。然而，由于锥形带宽重叠，这是不可能实现的。

因此，您“可以”说红色、绿色、蓝色是光的原色，但即使这样也不完全正确。黄色在锥体重叠的中间对“红色”和“绿色”锥体的刺激大致相同。当计算机显示器显示黄色时，它显示的是单独的绿色和红色，它们不会在空气中混合形成黄色——它只是刺激红色和绿色锥体，导致大脑*感知*黄色。

我们感知到黄色，而不是红绿色或绿红色，这是由于眼睛后部的神经节细胞产生的颜色对立过程。

红/绿是对手对，黄/蓝是对手对，组成四种“独特”的颜色（红、黄、绿、蓝）。由于黄色很容易用红光和绿光创建，因此加色过程通常会忽略黄色。

## 减光

反射表面（和透明薄膜）通过吸收光来“减去”光，仅反射（或透射）某些波长。事实证明，在使用减色反射/半透明颜色时，我们使用“原色”青色、洋红色和黄色获得最佳色域，而不是我们试图选择性地刺激三种锥体类型中的每一种的发射光颜色使用红色、绿色和蓝色。

此外，请注意青色与红色“相反”，洋红色与绿色“相反”，黄色与蓝色“相反”。

记录一下，在 sRGB 显示器中，红色实际上是红色/橙色。绿色实际上是绿色/黄色，而蓝色更像是紫罗兰色。

对于加色或减色工艺，所选择的特定颜色（通常）旨在创建最广泛的色域，受到各种经济和实用性原因的限制。

# scheme - 树递归/时间复杂度方案分配

> ID：228412
> 
> 赞同：0
> 
> 时间：2008-10-23T03:10:43.210
> 
> 标签：scheme

如果你能帮助我解决这个问题的任何部分，我将不胜感激。谢谢。

```
2^0 = 1
2^N = 2^(N-1) + 2^(N-1) 
```

1.  将此定义转换为完全等效的树递归函数，称为二次幂。描述它的渐近时间复杂度并解释为什么它有这个时间复杂度。

2.  现在编写一个名为 tttpo_rec 的函数，它计算完全相同的东西，但它使用线性递归过程，该过程具有 O(n) 时间复杂度，并且还使用 O(n) 空间来进行挂起的操作。

3.  现在编写一个名为 tttpo_iter 的函数，它计算完全相同的东西，但它使用具有 O(n) 时间复杂度并且还使用常数空间的线性迭代过程。

4.  现在假设您想概括前面的定义之一，以便它可以处理任意整数幂，以便您可以计算 2^N、3^N 等。编写一个名为 to-the-power-of 的函数，它接受两个参数并将一个提升到另一个的权力。

这是模板：

```
;; to-the-power-of: integer integer -> integer
;; This function raises m to the power of n, returning the result.
;; m must be > 0 and n >= 0.
(define (to-the-power-of m n)
  ...)

(check-expect (to-the-power-of 1 0) 1) ; base case
(check-expect (to-the-power-of 2 3) 8) ; recursive case
(check-expect (to-the-power-of 3 2) 9) ; recursive case 
```

我们将再添加一个限制：您不能使用 * 运算符；您只能使用以下递归函数进行乘法运算：

```
;;; multiply: integer integer -> integer
;; This function multiplies two non-negative integers, returning the result.
;; Its time complexity is O(a).
(define (multiply a b)
  ...) 
```

编写函数，并描述其时间复杂度和原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T03:33:31.137

哈哈哈哈。我不应该为人做作业，但这太有趣了。:-P

1.  这只是幼稚的实现。我可以回答这个问题，而不会放弃其余的问题。

    ```
    (define (tttpo n)
      (if (zero? n) 1
                    (+ (tttpo (- n 1)) (tttpo (- n 1))))) 
    ```

    显然这是一个非常愚蠢的实现，但你被要求给出它的渐近复杂度。

2.  想想如何避免`tttpo`每次迭代调用两次。由于您被要求避免使用`*`，因此您可能需要存储`tttpo`.

3.  阅读尾递归。具体来说，您需要知道如何将通用递归算法转换为其等效的迭代（或尾递归，因为这是 Scheme）版本。

4.  一旦你编写了 3 的代码就很明显了。（或者，告诉我你对 3 的答案，我会进一步帮助你。）

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T03:35:31.910

第一个算法是O(2^n)，可以写成如下：

```
(define (2pow x)
  (if (= x 0) 1
      (+ (2pow (- x 1))
         (2pow (- x 1))))) 
```

这可以用 O(n) 重写如下：

```
(define (2pow x)
  (if (= x 0) 1
    (* 2 (2pow (- x 1))))) 
```

由于 Scheme 使用尾调用优化，我们可以将其写为占用常量堆栈的尾递归函数：

```
(define (2pow x)
  (define (internal x accum)
    (if (= x 0) accum
        (internal (- x 1) (* accum 2))))
  (internal x 1)) 
```

广义：

```
(define (to-the-power-of a b)
  (define (internal x accum)
    (if (= x 0) accum
        (internal (- x 1) (* accum a))))
  (internal b 1)) 
```

**编辑：**因为我看到你不能使用 *，你可以写你自己的整数乘法：

```
(define (mult a b)
  (define (internal a accum)
    (if (= a 1) accum
        (internal (- a 1) (+ accum b))))
  (internal a b)) 
```

这是尾递归的，因此它在恒定的堆栈空间中运行。只需在上述任何算法中将 * 替换为 mult 即可。

我还应该注意，所有这些功能都是直接在这里编写到编辑器中的，没有经过测试。使用风险自负

# mysql - In what order are MySQL JOINs evaluated?

> ID：228424
> 
> 赞同：29
> 
> 时间：2008-10-23T03:17:51.340
> 
> 标签：mysql, sql, join

I have the following query:

```
SELECT c.*
FROM companies AS c
JOIN users AS u USING(companyid)
JOIN jobs AS j USING(userid)
JOIN useraccounts AS us USING(userid)
WHERE j.jobid = 123; 
```

I have the following questions:

1.  Is the USING syntax synonymous with ON syntax?
2.  Are these joins evaluated left to right? In other words, does this query say: x = companies JOIN users; y = x JOIN jobs; z = y JOIN useraccounts;
3.  If the answer to question 2 is yes, is it safe to assume that the companies table has companyid, userid and jobid columns?
4.  I don't understand how the WHERE clause can be used to pick rows on the companies table when it is referring to the alias "j"

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-23T04:38:11.113

1.  USING (fieldname) is a shorthand way of saying ON table1.fieldname = table2.fieldname.

2.  SQL doesn't define the 'order' in which JOINS are done because it is not the nature of the language. Obviously an order has to be specified in the statement, but an INNER JOIN can be considered commutative: you can list them in any order and you will get the same results.

    That said, when constructing a SELECT ... JOIN, particularly one that includes LEFT JOINs, I've found it makes sense to regard the third JOIN as joining the new table to the results of the first JOIN, the fourth JOIN as joining the results of the second JOIN, and so on.

    More rarely, the specified order can influence the behaviour of the query optimizer, due to the way it influences the heuristics.

3.  No. The way the query is assembled, it requires that companies and users both have a companyid, jobs has a userid and a jobid and useraccounts has a userid. However, only one of companies *or* user needs a userid for the JOIN to work.

4.  The WHERE clause is filtering the whole result -- i.e. all JOINed columns -- using a column provided by the jobs table.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-23T03:43:45.357

I can't answer the bit about the USING syntax. That's weird. I've never seen it before, having always used an ON clause instead.

But what I *can* tell you is that the order of JOIN operations is determined dynamically by the query optimizer when it constructs its query plan, based on a system of optimization heuristics, some of which are:

1.  Is the JOIN performed on a primary key field? If so, this gets high priority in the query plan.

2.  Is the JOIN performed on a foreign key field? This also gets high priority.

3.  Does an index exist on the joined field? If so, bump the priority.

4.  Is a JOIN operation performed on a field in WHERE clause? Can the WHERE clause expression be evaluated by examining the index (rather than by performing a table scan)? This is a *major* optimization opportunity, so it gets a major priority bump.

5.  What is the cardinality of the joined column? Columns with high cardinality give the optimizer more opportunities to discriminate against false matches (those that don't satisfy the WHERE clause or the ON clause), so high-cardinality joins are usually processed before low-cardinality joins.

6.  How many actual rows are in the joined table? Joining against a table with only 100 values is going to create less of a data explosion than joining against a table with ten million rows.

Anyhow... the point is... there are a LOT of variables that go into the query execution plan. If you want to see how MySQL optimizes its queries, use the EXPLAIN syntax.

And here's a good article to read:

[http://www.informit.com/articles/article.aspx?p=377652](http://www.informit.com/articles/article.aspx?p=377652)

* * *

ON EDIT:

To answer your 4th question: You aren't querying the "companies" table. You're querying the joined cross-product of **ALL** four tables in your FROM and USING clauses.

The "j.jobid" alias is just the fully-qualified name of one of the columns in that joined collection of tables.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T05:29:00.143

In MySQL, it's often interesting to ask the query optimizer what it plans to do, with:

```
EXPLAIN SELECT [...] 
```

See ["7.2.1 Optimizing Queries with EXPLAIN"](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T03:42:09.823

SEE [http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

*AND start reading here:*

* * *

**Join Processing Changes in MySQL 5.0.12**

Beginning with MySQL 5.0.12, natural joins and joins with USING, including outer join variants, are processed according to the SQL:2003 standard. The goal was to align the syntax and semantics of MySQL with respect to NATURAL JOIN and JOIN ... USING according to SQL:2003\. However, these changes in join processing can result in different output columns for some joins. Also, some queries that appeared to work correctly in older versions must be rewritten to comply with the standard.

These changes have five main aspects:

*   The way that MySQL determines the result columns of NATURAL or USING join operations (and thus the result of the entire FROM clause).

*   Expansion of SELECT * and SELECT tbl_name.* into a list of selected columns.

*   Resolution of column names in NATURAL or USING joins.

*   Transformation of NATURAL or USING joins into JOIN ... ON.

*   Resolution of column names in the ON condition of a JOIN ... ON.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T03:45:14.357

Im not sure about the ON vs USING part (though this [website](http://www.java2s.com/Tutorial/MySQL/0100__Table-Join/ThekeywordUSINGcanbeusedasareplacementfortheONkeywordduringthetableJoins.htm "website") says they are the same)

As for the ordering question, its entirely implementation (and probably query) specific. MYSQL most likely picks an order when compiling the request. If you do want to enforce a particular order you would have to 'nest' your queries:

```
SELECT c.*
FROM companies AS c 
    JOIN (SELECT * FROM users AS u 
        JOIN (SELECT * FROM  jobs AS j USING(userid) 
              JOIN useraccounts AS us USING(userid) 
              WHERE j.jobid = 123)
    ) 
```

as for part 4: the where clause limits what rows from the jobs table are eligible to be JOINed on. So if there are rows which would join due to the matching userids but don't have the correct jobid then they will be omitted.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T04:17:23.340

1) Using is not exactly the same as on, but it is short hand where both tables have a column with the same name you are joining on... see: [http://www.java2s.com/Tutorial/MySQL/0100__Table-Join/ThekeywordUSINGcanbeusedasareplacementfortheONkeywordduringthetableJoins.htm](http://www.java2s.com/Tutorial/MySQL/0100__Table-Join/ThekeywordUSINGcanbeusedasareplacementfortheONkeywordduringthetableJoins.htm)

It is more difficult to read in my opinion, so I'd go spelling out the joins.

3) It is not clear from this query, but I would guess it does not.

2) Assuming you are joining through the other tables (not all directly on companyies) the order in this query does matter... see comparisons below:

**Origional:**

```
SELECT c.* 
    FROM companies AS c 
    JOIN users AS u USING(companyid) 
    JOIN jobs AS j USING(userid) 
    JOIN useraccounts AS us USING(userid) 
WHERE j.jobid = 123 
```

**What I think it is likely suggesting:**

```
SELECT c.* 
    FROM companies AS c 
    JOIN users AS u on u.companyid = c.companyid
    JOIN jobs AS j on j.userid = u.userid
    JOIN useraccounts AS us on us.userid = u.userid 
WHERE j.jobid = 123 
```

You could switch you lines joining jobs & usersaccounts here.

**What it would look like if everything joined on company:**

```
SELECT c.* 
    FROM companies AS c 
    JOIN users AS u on u.companyid = c.companyid
    JOIN jobs AS j on j.userid = c.userid
    JOIN useraccounts AS us on us.userid = c.userid
WHERE j.jobid = 123 
```

This doesn't really make logical sense... unless each user has their own company.

4.) The magic of sql is that you can only show certain columns but all of them are their for sorting and filtering...

if you returned

```
SELECT c.*, j.jobid.... 
```

you could clearly see what it was filtering on, but the database server doesn't care if you output a row or not for filtering.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-05T20:37:25.073

Here is a more detailed answer on `JOIN` precedence. In your case, the `JOIN`s are all commutative. Let's try one where they aren't.

Build schema:

```
CREATE TABLE users (
  name text
);

CREATE TABLE orders (
  order_id text,
  user_name text
);

CREATE TABLE shipments (
  order_id text,
  fulfiller text
); 
```

Add data:

```
INSERT INTO users VALUES ('Bob'), ('Mary');

INSERT INTO orders VALUES ('order1', 'Bob');

INSERT INTO shipments VALUES ('order1', 'Fulfilling Mary'); 
```

Run query:

```
SELECT *
  FROM users
       LEFT OUTER JOIN orders
       ON orders.user_name = users.name
       JOIN shipments
       ON shipments.order_id = orders.order_id 
```

Result:

Only the Bob row is returned

Analysis:

In this query the `LEFT OUTER JOIN` was evaluated first and the `JOIN` was evaluated on the composite result of the `LEFT OUTER JOIN`.

Second query:

```
SELECT *
  FROM users
       LEFT OUTER JOIN (
         orders
         JOIN shipments
         ON shipments.order_id = orders.order_id)
         ON orders.user_name = users.name 
```

Result:

One row for Bob (with the fulfillment data) and one row for Mary with NULLs for fulfillment data.

Analysis:

The parenthesis changed the evaluation order.

* * *

Further MySQL documentation is at [https://dev.mysql.com/doc/refman/5.5/en/nested-join-optimization.html](https://dev.mysql.com/doc/refman/5.5/en/nested-join-optimization.html)

# flash - Flash Remoting Services 死了吗？

> ID：228431
> 
> 赞同：1
> 
> 时间：2008-10-23T03:22:44.527
> 
> 标签：flash, remoting

我有一个使用 Flash Remoting Services 构建某些东西的潜在客户。看起来在 2002-2003 年提供了某种服务器产品，但我一直无法看到它是否做了如此复杂的事情，以至于无法用简单的 Web 服务代替。有谁知道这个产品是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T03:48:19.827

您可以在 Adob​​e 的[Flash Remoting 支持](http://www.adobe.com/support/flash_remoting/)站点上找到支持信息。因此，它并没有完全死掉，以至于如果您已经拥有它的许可证，就无法获得支持。也就是说，我不知道这些天真正使用了多少，所以我无法真正回答你的主要问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-12T14:15:19.047

好吧，我回答这个问题已经太晚了，但是，我有一些使用 Flash Remoting 组件和其他框架在 asp.net 上进行 Flash Remoting 的经验，我也尝试了所有这些带有 flex 的框架，源代码也可以下载，所以继续免费使用它

我通过电子邮件从该博客条目中收到了很多关于源代码设置和其他实现的问题，这说明有很多开发人员实际上至少尝试过这个

[这](http://lakhlaniprashant.blogspot.com/2009/03/flash-remoting-with-aspnet.html)是我的[博客文章](http://lakhlaniprashant.blogspot.com/2009/03/flash-remoting-with-aspnet.html)的链接 希望这有帮助

# ruby-on-rails - 如何使用默认的 Rails 记录器记录 Ruby 异常的整个回溯？

> ID：228441
> 
> 赞同：37
> 
> 时间：2008-10-23T03:31:34.120
> 
> 标签：ruby-on-rails, ruby, logging

我正在研究 rails 项目，我正在尝试将异常记录到 rails 日志文件中。我知道我可以调用`logger.error $!`以将异常的第一行记录到文件中。但是，我也想记录整个跟踪堆栈。如何使用默认的 Rails 记录器记录异常的整个回溯？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-25T12:47:35.150

```
logger.error $!.backtrace 
```

另外，别忘了你可以

```
rescue ErrorType => error_name 
```

给你的错误一个变量名而不是 default `$!`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-26T10:40:22.903

rails 的做法是

```
137             logger.fatal(
138               "\n\n#{exception.class} (#{exception.message}):\n    " +
139               clean_backtrace(exception).join("\n    ") +
140               "\n\n"
141             )

248       def clean_backtrace(exception)
249         if backtrace = exception.backtrace
250           if defined?(RAILS_ROOT)
251             backtrace.map { |line| line.sub RAILS_ROOT, '' }
252           else
253             backtrace
254           end
255         end
256       end 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-10-06T18:57:35.870

在更高版本的 Rails 中，只需取消注释 RAIL_ROOT/config/initializers/backtrace_silencers.rb 中的以下行（如果该文件不存在，则自行添加该文件）：

```
# Rails.backtrace_cleaner.remove_silencers! 
```

这样，您可以将完整的回溯写入异常日志。这在 v2.3.4 中适用于我。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-23T03:42:22.117

`logger.error caller.join("\n")`应该做的伎俩。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-21T09:08:35.423

在 Rails 中，`ActionController::Rescue`处理它。在我的应用程序控制器操作中，我正在使用`log_error`此模块中的方法在日志中格式化回溯：

```
def foo_action
  # break something in here
rescue
  log_error($!)
  # call firemen
end 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-11T04:58:31.107

这是我的做法：

[http://gist.github.com/127708](http://gist.github.com/127708)

这是 Exception#backtrace 的 ri 文档：

[http://gist.github.com/127710](http://gist.github.com/127710)

请注意，您也可以使用 Kernel#caller，它也可以为您提供完整的跟踪（减去当前帧）。

[http://gist.github.com/127709](http://gist.github.com/127709)

另外 - 请注意，如果您试图捕获*所有*异常，您应该从异常中拯救，而不是 RuntimeError。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-25T15:16:03.060

您还可以使用 ruby​​ 的默认变量，如下所示：

```
logger.error "Your error message. Exception message:#{$!} Stacktrace:#{$@}" 
```

# c# - 错误“MSB3176：指定的最低要求版本大于当前发布版本”

> ID：228454
> 
> 赞同：3
> 
> 时间：2008-10-23T03:37:55.823
> 
> 标签：c#, msbuild, .net-2.0, cruisecontrol.net

我已经构建了运行 CruiseControl.NET 的服务器，最近它开始在我的一个项目（.NET 2.0，C#）上抛出这个错误：

> MSB3176：指定的最低要求版本高于当前发布版本。请指定小于或等于当前发布版本的版本。在 Microsoft.Common.targets(2238, 9)

我已经搜索了网络，但找不到解决方案。

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T04:14:13.347

检查项目的属性。版本号位于“发布”选项卡上。您应该将发布版本与最低版本（“更新”按钮）进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T04:15:17.027

项目属性具有发布版本（在发布选项卡上）和（可选）最低版本（在发布选项卡上的更新按钮上）。两者都与任何程序集版本无关，仅用于 ClickOnce。如果指定了最低版本，它必须是合乎逻辑的（即不高于主版本）。

在 csproj 中，这是 ApplicationVersion/ApplicationRevision 和 MinimumRequiredVersion 元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-03T21:01:17.587

对我来说，有人将发布选项切换为“该应用程序仅在线可用”。这导致了上述错误。如果他们也删除了发布位置中的文件，也许它会起作用，但因为它是离线应用程序，不会切换到仅在线，只会给出错误。我们手动卸载并重新安装它们，然后下次发布时我们会再次收到错误。切换到“该应用程序也可以离线使用”并且问题已解决。如果它最初设置为仅在线，它可能会正常工作。

# java - 如何合并多个 BIRT 报告

> ID：228458
> 
> 赞同：3
> 
> 时间：2008-10-23T03:39:07.147
> 
> 标签：java, report, birt

我们目前有一整套报告设计，涵盖了我们应用程序的各个部分，这些报告是由我们的用户按需生成的。

我希望能够将这些报告中的几个捆绑到一个报告中以返回给用户。

我最初破解了一个自定义报告生成器，该生成器使用报告库文件中的段生成报告设计文件，然后运行该生成的设计，但这很笨重并且管理起来很痛苦，因为我必须在里面复制单个报告（仍然需要）报告库文件。对独立报告的任何更改都必须在合并报告的库中复制。

我真正想要的是一种方法来指定几个设计文件，让它们全部运行，然后将一个文件返回给用户，其中包含他们选择的所有报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T02:01:37.530

这是一个相当普遍的请求，我们正在处理但尚未解决。

您今天可以使用的一种不太理想的方法是运行每个报告，然后合并每个 rptdocument 的输出。[BIRT-exchange在此处](http://www.birt-exchange.com/modules/wfdownloads/singlefile.php?cid=2&lid=157) 为 PDF 和 HTML提供了一个示例。问题是页码不正确，目录也不正确。

更好的方法是，如果有一个合并报告引擎任务，它允许您将多个 rptdocument 组合成一个具有适当分页和 TOC 的 rptdocument。[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=205265)有一个 bugzilla 条目，我希望在该产品的 2.5（2009 年 6 月）版本中看到。如果您有兴趣，请查看并提供您的反馈。

最后，我希望在 2009 年产品中看到的功能之一是对 DesignEngine API 的一些改进，它允许开发人员在运行时使用来自其他报表设计的组件轻松地编写单个报表设计。我也创建了一个[bugzilla](https://bugs.eclipse.org/bugs/show_bug.cgi?id=251959)来跟踪它。

如果这些似乎都不合适，请告诉我，我会看看是否可以帮助您找到不同的解决方案。

# search - 使用参数使用 Like 运算符避免 SQL 查询中的 SQL 注入？

> ID：228476
> 
> 赞同：15
> 
> 时间：2008-10-23T03:46:20.360
> 
> 标签：search, ado.net, sql-injection, sql-like

从我的前任那里接过一些代码，我发现了一个使用 Like 运算符的查询：

```
SELECT * FROM suppliers
WHERE supplier_name like '%'+name+%'; 
```

试图避免 SQL 注入问题并将其参数化，但我不太确定如何实现。有什么建议么 ？

请注意，我需要一个经典 ADO.NET 的解决方案——我真的没有资格将此代码切换到 LINQ 之类的东西。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-23T03:52:17.773

试试这个：

```
var query = "select * from foo where name like @searchterm";
using (var command = new SqlCommand(query, connection))
{
  command.Parameters.AddWithValue("@searchterm", String.Format("%{0}%", searchTerm));
  var result = command.ExecuteReader();
} 
```

该框架将自动处理引用问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T03:51:37.183

只需参数化您的查询：

```
SELECT * FROM suppliers WHERE supplier_name like '%' + @name + '%' 
```

现在您可以将您的“名称”变量传递给@name 参数，查询将执行而没有任何注入攻击的危险。即使您传入类似“'' OR true --”之类的内容，它仍然可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-16T16:40:25.850

在 Entity Framework 6 中，Native SQL 可以这样做：

```
List<Person> peopleList = contex.People.SqlQuery(
    @"SELECT * FROM [Person].[Person]
       WHERE [FirstName] LIKE N'%' + @p0 + '%' ", "ab").ToList(); 
```

或者

```
List<Person> peopleList = contex.People.SqlQuery(
    @"SELECT * FROM [Person].[Person]
       WHERE [FirstName] LIKE N'%' + @name + '%' ",
    new SqlParameter("@name", "ab")).ToList(); 
```

此外，您可以直接使用 LINQ to Entities：

```
List<Person> peopleList1 = contex.People.Where(s => s.FirstName.Contains("ab")).ToList(); 
```

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2008-10-23T03:52:03.017

简短回答：

1) name.Replace("'", "''").... 替换您的数据库可能具有的任何转义字符（单引号是最常见的）

2) 如果您使用.net 之类的语言，请使用参数化查询

```
sql="Insert into Employees (Firstname, Lastname, City, State, Zip, Phone, Email) Values ('" & frmFirstname.text & "', '" & frmLastName & "', '" & frmCity & "', '" & frmState & "', '" & frmZip & "', '" & frmPhone & "', '" & frmEmail & "')" 
```

上面替换为下面

```
Dim MySQL as string = "Insert into NewEmp (fname, LName, Address, City, State, Postalcode, Phone, Email) Values (@Firstname, @LastName, @Address, @City, @State, @Postalcode, @Phone, @Email)" 

With cmd.Parameters:
    .Add(New SQLParameter("@Firstname", frmFname.text))
    .Add(New SQLParameter("@LastName", frmLname.text))
    .Add(New SQLParameter("@Address", frmAddress.text))
    .Add(New SQLParameter("@City", frmCity.text))
    .Add(New SQLParameter("@state", frmState.text))
    .Add(New SQLParameter("@Postalcode", frmPostalCode.Text))
    .Add(New SQLParameter("@Phone", frmPhone.text))
    .Add(New SQLParameter("@email", frmemail.text))
end with 
```

3) 用户存储过程

4) 如果您使用的是 .net，请再次使用 Linq to SQL

# java - 如何以编程方式确定 Java 中的操作系统？

> ID：228477
> 
> 赞同：596
> 
> 时间：2008-10-23T03:47:05.663
> 
> 标签：java, operating-system

我想确定我的 Java 程序正在以编程方式运行的主机的操作系统（例如：我希望能够根据我是在 Windows 还是 Unix 平台上加载不同的属性）。100% 可靠的最安全方法是什么？

* * *

## 回答 #1

> 赞同：705
> 
> 时间：2008-10-23T03:48:47.127

您可以使用：

```
System.getProperty("os.name") 
```

PS您可能会发现此代码很有用：

```
class ShowProperties {
    public static void main(String[] args) {
        System.getProperties().list(System.out);
    }
} 
```

它所做的只是打印出 Java 实现提供的所有属性。它将让您了解通过属性可以找到有关 Java 环境的信息。:-)

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2010-05-27T00:17:12.847

如其他答案所示， System.getProperty 提供原始数据。但是，[Apache Commons Lang 组件](http://commons.apache.org/lang/)[为 java.lang.System](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/SystemUtils.html)提供了一个包装器，该包装器具有方便的属性，例如[`SystemUtils.IS_OS_WINDOWS`](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/SystemUtils.html#IS_OS_WINDOWS)，很像前面提到的 Swingx OS 实用程序。

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2008-10-23T03:58:33.830

2008 年 10 月：

我建议将其缓存在静态变量中：

```
public static final class OsUtils
{
   private static String OS = null;
   public static String getOsName()
   {
      if(OS == null) { OS = System.getProperty("os.name"); }
      return OS;
   }
   public static boolean isWindows()
   {
      return getOsName().startsWith("Windows");
   }

   public static boolean isUnix() // and so on
} 
```

这样，每次您请求 Os 时，您不会在应用程序的生命周期内多次获取该属性。

* * *

2016 年 2 月：7 年后：

Windows 10 存在一个错误（在原始答案时不存在）。
请参阅“[适用于 Windows 10 的 Java 的“os.name”？](https://stackoverflow.com/a/31909887/6309) ”

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2013-08-24T10:09:31.067

上面答案中的某些链接似乎已损坏。我在下面的代码中添加了指向当前源代码的指针，并提供了一种使用枚举作为答案来处理检查的方法，以便在评估结果时可以使用 switch 语句：

```
OsCheck.OSType ostype=OsCheck.getOperatingSystemType();
switch (ostype) {
    case Windows: break;
    case MacOS: break;
    case Linux: break;
    case Other: break;
} 
```

助手类是：

```
/**
 * helper class to check the operating system this Java VM runs in
 *
 * please keep the notes below as a pseudo-license
 *
 * http://stackoverflow.com/questions/228477/how-do-i-programmatically-determine-operating-system-in-java
 * compare to http://svn.terracotta.org/svn/tc/dso/tags/2.6.4/code/base/common/src/com/tc/util/runtime/Os.java
 * http://www.docjar.com/html/api/org/apache/commons/lang/SystemUtils.java.html
 */
import java.util.Locale;
public static final class OsCheck {
  /**
   * types of Operating Systems
   */
  public enum OSType {
    Windows, MacOS, Linux, Other
  };

  // cached result of OS detection
  protected static OSType detectedOS;

  /**
   * detect the operating system from the os.name System property and cache
   * the result
   * 
   * @returns - the operating system detected
   */
  public static OSType getOperatingSystemType() {
    if (detectedOS == null) {
      String OS = System.getProperty("os.name", "generic").toLowerCase(Locale.ENGLISH);
      if ((OS.indexOf("mac") >= 0) || (OS.indexOf("darwin") >= 0)) {
        detectedOS = OSType.MacOS;
      } else if (OS.indexOf("win") >= 0) {
        detectedOS = OSType.Windows;
      } else if (OS.indexOf("nux") >= 0) {
        detectedOS = OSType.Linux;
      } else {
        detectedOS = OSType.Other;
      }
    }
    return detectedOS;
  }
} 
```

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2016-12-15T22:32:53.937

以下 JavaFX 类具有确定当前操作系统的静态方法（isWindows()、isLinux()...）：

*   com.sun.javafx.PlatformUtil
*   com.sun.media.jfxmediaimpl.HostUtils
*   com.sun.javafx.util.Utils

例子：

```
if (PlatformUtil.isWindows()){
           ...
} 
```

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2015-07-21T19:02:48.163

**TL;博士**

访问操作系统使用：`System.getProperty("os.name")`.

* * *

## 可是等等！！！

为什么不创建一个实用程序类，让它可重用！并且在多次通话时可能要快得多。**干净，清晰，更快！**

为此类实用程序函数创建一个 Util 类。然后为每种操作系统类型创建公共枚举。

```
public class Util {     
        public enum OS {
            WINDOWS, LINUX, MAC, SOLARIS
        };// Operating systems.

    private static OS os = null;

    public static OS getOS() {
        if (os == null) {
            String operSys = System.getProperty("os.name").toLowerCase();
            if (operSys.contains("win")) {
                os = OS.WINDOWS;
            } else if (operSys.contains("nix") || operSys.contains("nux")
                    || operSys.contains("aix")) {
                os = OS.LINUX;
            } else if (operSys.contains("mac")) {
                os = OS.MAC;
            } else if (operSys.contains("sunos")) {
                os = OS.SOLARIS;
            }
        }
        return os;
    }
} 
```

现在，您可以轻松地从任何类中调用类，如下所示，（PS 由于我们将 os 变量声明为静态，它只会消耗一次时间来识别系统类型，然后可以使用它直到您的应用程序停止。）

```
 switch (Util.getOS()) {
            case WINDOWS:
                //do windows stuff
                break;
            case LINUX: 
```

就是这样！

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-07-06T19:06:32.490

您尝试实现的一个小例子可能`class`与下面的类似：

```
import java.util.Locale;

public class OperatingSystem
{
    private static String OS = System.getProperty("os.name", "unknown").toLowerCase(Locale.ROOT);

    public static boolean isWindows()
    {
        return OS.contains("win");
    }

    public static boolean isMac()
    {
        return OS.contains("mac");
    }

    public static boolean isUnix()
    {
        return OS.contains("nux");
    }
} 
```

这个特定的实现是非常可靠的，应该是普遍适用的。只需将其复制并粘贴到您`class`选择的位置即可。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-05-07T08:20:57.057

试试这个，简单易行

```
System.getProperty("os.name");
System.getProperty("os.version");
System.getProperty("os.arch"); 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-10-23T04:37:26.543

如果你对开源项目如何做这样的事情感兴趣，你可以在这里查看处理这些垃圾的 Terracotta 类 (Os.java)：

*   ~~[http://svn.terracotta.org/svn/tc/dso/trunk/code/base/common/src/com/tc/util/runtime/](http://svn.terracotta.org/svn/tc/dso/trunk/code/base/common/src/com/tc/util/runtime/)~~
*   [http://svn.terracotta.org/svn/tc/dso/tags/2.6.4/code/base/common/src/com/tc/util/runtime/](http://svn.terracotta.org/svn/tc/dso/tags/2.6.4/code/base/common/src/com/tc/util/runtime/)

您可以在这里看到一个类似的类来处理 JVM 版本（Vm.java 和 VmVersion.java）：

*   [http://svn.terracotta.org/svn/tc/dso/trunk/common/src/main/java/com/tc/util/runtime/](http://svn.terracotta.org/svn/tc/dso/trunk/common/src/main/java/com/tc/util/runtime/)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-05-03T09:51:12.540

下面的代码显示了您可以从 System API 获得的值，这些都是您可以通过此 API 获得的所有内容。

```
public class App {
    public static void main( String[] args ) {
        //Operating system name
        System.out.println(System.getProperty("os.name"));

        //Operating system version
        System.out.println(System.getProperty("os.version"));

        //Path separator character used in java.class.path
        System.out.println(System.getProperty("path.separator"));

        //User working directory
        System.out.println(System.getProperty("user.dir"));

        //User home directory
        System.out.println(System.getProperty("user.home"));

        //User account name
        System.out.println(System.getProperty("user.name"));

        //Operating system architecture
        System.out.println(System.getProperty("os.arch"));

        //Sequence used by operating system to separate lines in text files
        System.out.println(System.getProperty("line.separator"));

        System.out.println(System.getProperty("java.version")); //JRE version number

        System.out.println(System.getProperty("java.vendor.url")); //JRE vendor URL

        System.out.println(System.getProperty("java.vendor")); //JRE vendor name

        System.out.println(System.getProperty("java.home")); //Installation directory for Java Runtime Environment (JRE)

        System.out.println(System.getProperty("java.class.path"));

        System.out.println(System.getProperty("file.separator"));
    }
} 
```

答案：-

```
Windows 7
6.1
;
C:\Users\user\Documents\workspace-eclipse\JavaExample
C:\Users\user
user
amd64

1.7.0_71
http://java.oracle.com/
Oracle Corporation
C:\Program Files\Java\jre7
C:\Users\user\Documents\workspace-Eclipse\JavaExample\target\classes
\ 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2018-09-27T07:36:18.140

我认为以下可以在更少的行中提供更广泛的覆盖范围

```
import org.apache.commons.exec.OS;

if (OS.isFamilyWindows()){
                //load some property
            }
else if (OS.isFamilyUnix()){
                //load some other property
            } 
```

更多细节在这里：[https ://commons.apache.org/proper/commons-exec/apidocs/org/apache/commons/exec/OS.html](https://commons.apache.org/proper/commons-exec/apidocs/org/apache/commons/exec/OS.html)

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2019-08-22T20:22:04.437

**如果您在安全敏感的环境中工作，请通读此内容。**

请不要相信通过`System#getProperty(String)`子程序获得的属性！`os.arch`实际上，包括、`os.name`和在内的几乎所有属性`os.version`都不是你所期望的 readonly ——相反，它们实际上完全相反。

首先，任何有足够权限调用`System#setProperty(String, String)`子程序的代码都可以随意修改返回的字面量。但是，这不一定是这里的主要问题，因为它可以通过使用所谓的 来解决`SecurityManager`，正如在[此处](https://docs.oracle.com/javase/tutorial/essential/environment/security.html)更详细地描述的那样。

实际问题是任何用户在运行有`JAR`问题的程序时都可以编辑这些属性（通过`-Dos.name=`、`-Dos.arch=`等）。避免篡改应用程序参数的一种可能方法是查询[此处](https://stackoverflow.com/a/1531999/11173058)`RuntimeMXBean`所示的。下面的代码片段应该提供一些关于如何实现这一点的见解。

```
RuntimeMXBean runtimeMxBean = ManagementFactory.getRuntimeMXBean();
List<String> arguments = runtimeMxBean.getInputArguments();

for (String argument : arguments) {
    if (argument.startsWith("-Dos.name") {
        // System.getProperty("os.name") altered
    } else if (argument.startsWith("-Dos.arch") {
        // System.getProperty("os.arch") altered
    }
} 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-10-23T04:40:21.717

我发现[Swingx 的 OS Utils 可以](https://github.com/tmyroadctfig/swingx/blob/master/swingx-common/src/main/java/org/jdesktop/swingx/util/OS.java)完成这项工作。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2013-04-29T12:36:26.783

```
String osName = System.getProperty("os.name");
System.out.println("Operating system " + osName); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-03-17T11:38:50.573

我喜欢沃尔夫冈的回答，只是因为我相信这样的事情应该是 consts ......

所以我为自己改写了一下，并想分享它:)

```
/**
 * types of Operating Systems
 *
 * please keep the note below as a pseudo-license
 *
 * helper class to check the operating system this Java VM runs in
 * http://stackoverflow.com/questions/228477/how-do-i-programmatically-determine-operating-system-in-java
 * compare to http://svn.terracotta.org/svn/tc/dso/tags/2.6.4/code/base/common/src/com/tc/util/runtime/Os.java
 * http://www.docjar.com/html/api/org/apache/commons/lang/SystemUtils.java.html
 */
public enum OSType {
    MacOS("mac", "darwin"),
    Windows("win"),
    Linux("nux"),
    Other("generic");

    private static OSType detectedOS;

    private final String[] keys;

    private OSType(String... keys) {
        this.keys = keys;
    }

    private boolean match(String osKey) {
        for (int i = 0; i < keys.length; i++) {
            if (osKey.indexOf(keys[i]) != -1)
                return true;
        }
        return false;
    }

    public static OSType getOS_Type() {
        if (detectedOS == null)
            detectedOS = getOperatingSystemType(System.getProperty("os.name", Other.keys[0]).toLowerCase());
        return detectedOS;
    }

    private static OSType getOperatingSystemType(String osKey) {
        for (OSType osType : values()) {
            if (osType.match(osKey))
                return osType;
        }
        return Other;
    }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-01-22T15:46:18.253

您可以只使用 sun.awt.OSInfo#getOSType() 方法

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2021-06-06T23:25:46.760

顶级答案的更短，更清晰（并且急切地计算）的版本：

```
switch(OSType.DETECTED){
...
} 
```

辅助枚举：

```
public enum OSType {
    Windows, MacOS, Linux, Other;
    public static final  OSType DETECTED;
    static{
        String OS = System.getProperty("os.name", "generic").toLowerCase(Locale.ENGLISH);
        if ((OS.contains("mac")) || (OS.contains("darwin"))) {
            DETECTED = OSType.MacOS;
        } else if (OS.contains("win")) {
            DETECTED = OSType.Windows;
        } else if (OS.contains("nux")) {
            DETECTED = OSType.Linux;
        } else {
            DETECTED = OSType.Other;
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-08-01T10:47:27.327

此代码用于显示有关系统操作系统类型、名称、java 信息​​等的所有信息。

```
public static void main(String[] args) {
    // TODO Auto-generated method stub
    Properties pro = System.getProperties();
    for(Object obj : pro.keySet()){
        System.out.println(" System  "+(String)obj+"     :  "+System.getProperty((String)obj));
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-05-15T05:48:41.900

在 com.sun.jna.Platform 类中，您可以找到有用的静态方法，例如

```
Platform.isWindows();
Platform.is64Bit();
Platform.isIntel();
Platform.isARM(); 
```

以及更多。

如果您使用 Maven 只需添加依赖项

```
<dependency>
 <groupId>net.java.dev.jna</groupId>
 <artifactId>jna</artifactId>
 <version>5.2.0</version>
</dependency> 
```

否则只需找到 j​​na 库 jar 文件（例如 jna-5.2.0.jar）并将其添加到类路径中。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-03T11:43:05.957

只需`com.sun.javafx.util.Utils`如下使用。

```
if ( Utils.isWindows()){
     // LOGIC HERE
} 
```

**或使用**

```
boolean isWindows = OSInfo.getOSType().equals(OSInfo.OSType.WINDOWS);
       if (isWindows){
         // YOUR LOGIC HERE
       } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-08-06T12:31:28.407

由于谷歌将“kotlin os name”指向此页面，因此这是@Memin[答案](https://stackoverflow.com/a/31547504/536226)的 Kotlin 版本：

```
private var _osType: OsTypes? = null
val osType: OsTypes
    get() {
        if (_osType == null) {
            _osType = with(System.getProperty("os.name").lowercase(Locale.getDefault())) {
                if (contains("win"))
                    OsTypes.WINDOWS
                else if (listOf("nix", "nux", "aix").any { contains(it) })
                    OsTypes.LINUX
                else if (contains("mac"))
                    OsTypes.MAC
                else if (contains("sunos"))
                    OsTypes.SOLARIS
                else
                    OsTypes.OTHER
            }
        }
        return _osType!!
    }

enum class OsTypes {
    WINDOWS, LINUX, MAC, SOLARIS, OTHER
} 
```

# mod-rewrite - 使用带有 Mod Rewrite 的通配符子域？

> ID：228495
> 
> 赞同：0
> 
> 时间：2008-10-23T03:55:15.273
> 
> 标签：mod-rewrite, subdomain, wildcard-subdomain

我有通配符子域，但是我只是不知道 mod_rewrite 到需要写这个的程度。谁能告诉我如何做到这一点，除了 www 以外的任何东西都不会进入主站点，但除此之外的任何子域都进入 /script/index.php?username=$username？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T04:20:16.983

$username 变量应该来自哪里？

假设主站点的 URL 是[http://www.example.com/main_site.php](http://www.example.com/main_site.php)并且您正在使用此外部目录上下文（即，不在 .htaccess 或 <Directory> 指令中）。如果它在 .htaccess 中，则删除前导 /（例如，将其设为 main_site.php）。

我认为这不会立即起作用，因为有许多不明确的变量（用户名来自哪里？，如何处理请求的其余部分，将其作为参数传递？，这是 htaccess 还是主配置？），但是希望能给你一个想法：

```
#Turn on the rewrite engine
RewriteEngine On
#Check accessed domain, if it's either www.example.com or
RewriteCond %{HTTP_HOST} ^www.example.com$ [NC,OR]
#example.com
RewriteCond %{HTTP_HOST} ^example.com$ [NC]
#and the requested URL does not contain script you'll be accessing to avoid looping
RewriteCond %{REQUEST_URI} !main_site.php
#Then we tell that everything matching the above will go to main_site.php
RewriteRule ^ /main_site.php [L]
#If the request is not asking for main_site.php nor index.php
RewriteCond %{REQUEST_URI} !main_site.php
RewriteCond %{REQUEST_URI} !index.php
#We go to /script/index.php (username will be empty, becase we don't know 
#where to get it from)
RewriteRule ^ /script/index.php?username=$username [L] 
```

# visual-studio - 在开发人员团队中共享 Visual Studio 代码片段

> ID：228496
> 
> 赞同：15
> 
> 时间：2008-10-23T03:55:28.610
> 
> 标签：visual-studio, code-snippets

有没有人想出一种在开发人员团队之间自动共享一组 Visual Studio 代码片段（Visual Studio 使用的实际 .snippet 文件）的好方法？如果我团队中的其他开发人员从我为自己创建的快捷方式中受益，反之亦然。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-24T11:13:53.120

我知道这篇文章已经很老了，但我发现了另一种分享片段的好方法（IMO），也许除了@Kevin Dente 提供的解决方案：**使用 git** !!

**我成功共享了片段和项目模板，创建了一个名为snippets.git**的临时 git 存储库，我将其克隆到*MyDocuments\Visual Studio 2015\Code Snippets文件夹中，现在我可以从**MyDocuments\Visual Studio 2015\Code*添加、编辑或删除片段*Snippets\Visual C#\My Code Snippets*（或*Visual Basic*文件夹），然后提交并推送以使它们对具有相同配置的所有其他团队成员可用。

该原理同样适用于项目模板，您可以创建一个**templates.git**存储库并将其克隆到*MyDocuments\Visual Studio 2015\Templates*文件夹，然后在*MyDocuments\Visual Studio 2015\Templates\ProjectTemplates\Visual C#*下创建模板文件夹（或*Visual Basic*文件夹）。

这样，开发人员可以定期提取两个存储库并拥有最新的片段和模板，几乎可以在 git 服务器可访问的任何地方使用（有人说 github？或 bitbucket？）。

当然，我使用的是 Visual Studio 2015，但该方法可以用于以前版本以及我认为未来版本的 Visual Studio。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-11-30T21:31:18.647

现在是 2018 年，VS Code 团队已添加此功能（目前处于预览状态）

查看[这张票以获取更多信息](https://github.com/Microsoft/vscode/issues/8102)

# controls - 寻找替代方案或改进网站上的下拉列表/菜单

> ID：228500
> 
> 赞同：3
> 
> 时间：2008-10-23T04:01:19.473
> 
> 标签：controls, drop-down-menu, usability, menu

下拉列表、菜单和组合框都是非常常见的用户界面元素。用户习惯于在本机应用程序和有时在 Web 应用程序中看到这些元素，但它们存在一些问题。

1.  你必须瞄准鼠标。当您鼠标移出时，有些菜单会折叠，有些菜单有您必须瞄准才能展开的子菜单。

2.  如果不先瞄准鼠标，您将看不到选项。

这些是困扰我的主要事情，也许其他人也注意到其他问题。如果可以的话，我通常根本不使用下拉菜单。

问题是我有时想在有限的空间里展示一长串选项。问题 2 是我愿意做出的牺牲，但我想知道是否有人有任何技巧可以使这些下拉菜单更易于使用。也许有人发明了一种新的列表控件样式。

我敢肯定，如果这些类型的控件惹恼了我，那么它们会更惹恼我网站的用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T04:26:42.993

嗯..关于下拉列表让我烦恼的另一件事是无法控制它们的宽度，因为它随着文本扩展（或者它们是我不知道的东西？）。

作为替代方案，我考虑了一个小弹出窗口，它最初以字母索引的形式显示可用选项列表，当用户单击字母链接时，它会显示可供选择的相关选项。这将减少可供选择的选项。

同样，我们可以使用 ajax 在用户输入时动态构建选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T04:11:06.363

你可以试试 Mac OS/X 的任务栏，类似于 YouTube 中的选择栏。我认为常用术语是气泡条，当鼠标在它们上方滚动时，小图像的动画会变大，但会缩小到当鼠标不在控件上方时所有项目都可见的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T05:33:17.213

@Nrj width='20px' 将折叠下拉保持在 20px 的宽度。问题是，Inernet Explorer 也显示了具有此宽度的扩展项目，而到目前为止我遇到的所有其他浏览器都会显示完整的菜单。

# code-golf - 回文高尔夫

> ID：228518
> 
> 赞同：29
> 
> 时间：2008-10-23T04:17:25.710
> 
> 标签：code-golf, rosetta-stone, palindrome

目标：任何语言。返回字符串是否为回文的最小函数。这是我在**Python**中的：

```
R=lambda s:all(a==b for a,b in zip(s,reversed(s))) 
```

50 个字符。

接受的答案将是当前最小的答案 - 这将随着找到较小的答案而改变。请指定您的代码使用的语言。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-23T20:34:43.133

J 中的 7 个字符：不确定这是否是最好的方法，我对 J 有点陌生 :)

```
p=:-:|. 
```

解释：|。反转输入。-：比较。操作数是隐式的。

```
p 'radar'
1

p 'moose'
0 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-23T04:19:56.407

这是我的；它是用我发明的一种特定领域的语言编写的，称为“回文”。

```
p 
```

**编辑：**不那么轻率的版本（i386 asm，AT&T 语法）

```
xor %eax, %eax
mov %esi, %edi
#cld    not necessary, assume DF=0 as per x86 ABI
repne scasb
scan:
    dec %edi
    cmpsb
    .byte 0x75, 6    #jnz (short) done
    dec %edi
    cmp %esi, %edi
    .byte 0x72, -9    #jb (short) scan
inc %eax
done: 
```

16 字节，字符串指针在 ESI 中，结果在 EAX 中。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-25T02:14:54.417

可悲的是，我无法达到一千字以下...

![替代文字](https://i291.photobucket.com/albums/ll315/underflowx/palindrome.png)

（LabVIEW。是的，他们会让任何流浪汉在这里发帖；）

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-10-23T06:30:54.163

Haskell，**15 个**字符：

```
p=ap(==)reverse 
```

更易读的版本，**16 个**字符：

```
p x=x==reverse x 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-10-23T04:23:55.993

另一个更短的python版本（21个字符）：

```
R=lambda s:s==s[::-1] 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-10-24T03:30:13.823

冒着被否决票的风险，所有这些都只是调用某种隐藏所有真实编程逻辑的命令*反向。*

我想知道在每种语言中执行此操作的最短手动方法是什么。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-24T14:53:33.590

使用 C# 和 LINQ 运算符：

```
public bool IsPalindrome(string s)
{
    return s.Reverse().SequenceEqual(s);
} 
```

如果你认为 Reverse 是作弊，你可以通过减少来完成整个事情：

```
public bool IsPalindrome(string s)
{
    return s.Aggregate(new StringBuilder(),
                       (sb, c) => sb.Insert(0, c),
                       (sb) => sb.ToString() == s);
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-23T04:26:43.540

Perl（27 个字符）：

```
sub p{$_[0]eq reverse$_[0]} 
```

红宝石（24 个字符）：

```
def p(a)a==a.reverse end 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-10-23T05:56:26.667

73个干净、可读、用java编写的字符

```
boolean p(String s){return s.equals(""+new StringBuffer(s).reverse());} 
```

和平 ：）

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-24T06:06:27.923

无意义的 Haskell 版本（15 个字符，但除非您包含 Control.Arrow 和 Control.Monad 并忽略单态限制，否则实际上并不能正常工作）：

```
p=ap(==)reverse 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-23T05:58:59.827

```
(equal p (reverse p)) 
```

口齿不清。18 个字符。

好的，这是一个特例。如果直接输入到 lisp 解释器并且 p 已经定义，这将起作用。

否则，这将是必要的：

```
(defun g () (equal p (reverse p))) 
```

28 个字符。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-10-23T13:04:49.220

Lua 的目标更多是可读性而不是简洁性，但确实做到了 37 个字符：

```
function p(s)return s==s:reverse()end 
```

变体，只是为了好玩（相同大小）：

```
p=function(s)return s==s:reverse''end 
```

JavaScript 版本更冗长（55 个字符），因为它没有字符串反转功能：

```
function p(s){return s==s.split('').reverse().join('')} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-10-24T09:53:38.310

我会更进一步：完整的 c 代码，编译并运行。

90 个字符

```
main(int n,char**v){char*b,*e;b=e=v[1];while(*++e);for(e--;*b==*e&&b++<e--;);return b>e;} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-23T06:38:32.277

PHP：

```
function p($s){return $s==strrev($s);} // 38 chars 
```

要不就

```
$s==strrev($s); // 15 chars 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-23T20:52:04.470

在您的语言中使用反向功能不是有点作弊吗？我的意思是，查看 Ruby 解决方案给出为

```
def p(a)a==a.reverse end 
```

您可以轻松地将其重写为

```
def p(a)a==a.r end 
```

并且只是说您在代码中创建了一个扩展方法，以便“r”调用反向。我希望看到人们发布不包含对其他函数的调用的解决方案。当然，应该允许字符串长度函数。

没有反转的 Ruby - 41 个字符

```
def m(a)a==a.split('').inject{|r,l|l+r}end 
```

VB.Net - 173 个字符

```
Function P(ByVal S As String) As Boolean
    For i As Integer = 0 To S.Length - 1
        If S(i) <> S(S.Length - i - 1) Then
            Return False
        End If
    Next
    Return True
End Function 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-10-24T03:54:39.390

F#（很像 C# 示例）

```
let p s=let i=0;let l=s.Length;while(++i<l)if(s[i]!=[l-i-1]) 0; 1;; 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-10-07T21:54:52.957

**Golfscript，5 个字符**

```
.-1%=

$ echo -n abacaba | ruby golfscript.rb palindrome.gs
1

$ echo -n deadbeef | ruby golfscript.rb palindrome.gs
0 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-10-23T21:41:39.067

C#**没有反向函数**84 个字符

```
int p(char[]s){int i=0,l=s.Length,t=1;while(++i<l)if(s[i]!=s[l-i-1])t&=0;return t;} 
```

C#**没有反向函数**86 个字符

```
int p(char[]s){int i=0;int l=s.Length;while(++i<l)if(s[i]!=s[l-i-1])return 0;return 1;} 
```

VBScript 41 个字符

```
function p:p=s=strreverse(s):end function 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-10-24T11:11:05.190

Common Lisp，简短且作弊的版本（23 个字符）：

```
#L(equal !1(reverse !1)) 
```

#L 是由 SHARPL-READER 在 iterate 包中实现的阅读器宏字符。它基本上等同于 (lambda (!1) ...)。

Common Lisp，仅使用原语的长版本（137 包括空格，可压缩到 108）：

```
(defun p (s)
  (let ((l (1- (length s))))
    (iter (for i from l downto (/ l 2))
          (always (equal (elt s i) (elt s (- l i))))))) 
```

同样，它使用 iterate，它基本上是内置 LOOP 工具的更简洁版本，因此我倾向于将其视为核心语言。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-10-25T21:16:24.993

灵感来自上一篇文章，69 个字符

```
p(char*a){char*b=a,q=0;while(*++b);while(*a)q|=*a++!=*--b;return!q;} 
```

编辑：下降一个字符：

```
p(char*a){char*b=a,q=0;while(*++b);while(*a)q|=*a++%*--b;return!q;} 
```

EDIT2：65个字符：

```
p(char*a){char*b=a;while(*b)b++;while(*a&&*a++==*--b);return!*a;} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-01-23T04:02:44.480

不是最短的，而且是事后的，但我忍不住在 MATLAB 中尝试一下：

```
R=@(s)all(s==fliplr(s)); 
```

24 个字符。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-10-22T07:51:19.730

18 个字符的 perl 正则表达式

```
/^(.?|(.)(?1)\2)$/ 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2010-02-24T06:03:49.207

C 语言中的 52 个字符，需要注意的是最多一半的字符串将被覆盖：

`p(char*s){return!*s||!(s[strlen(s)-1]-=*s)&&p(++s);}`

没有库调用它是 64 个字符：

`p(char*s){char*e=s;while(*e)++e;return!*s||!(*--e-=*s)&&p(++s);}`

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-10-23T12:56:38.330

Haskell，28 个字符，需要 Control.Arrow 导入。

```
p=uncurry(==).(id&&&reverse) 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-10-23T15:12:40.850

受其他 C 答案中的 strlen 启发，使用标准库函数在 C 中直接实现。

字符数：57

```
p(char*s){char*r=strdup(s);strrev(r);return strcmp(r,s);} 
```

忏悔：我不在这里释放 r 是个坏人。我目前的良好尝试：

```
p(char*s){char*r=strdup(s);s[0]=strcmp(strrev(r),s);free(r);return s[0];} 
```

使其达到 73 个字符；我正在考虑任何缩短时间的方法。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-10-23T15:52:33.063

不使用任何库函数（因为你也应该增加`#include`成本），这是 96 的 C++ 版本：

```
int p(char*a,char*b=0,char*c=0){return c?b<a||p(a+1,--b,c)&&*a==*b:b&&*b?p(a,b+1):p(a,b?b:a,b);} 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-10-24T03:05:26.620

时髦的 17B：

> `p={it==it[-1..0]}`

~~缺点是它不适用于空字符串。~~

再想一想，为空字符串抛出异常是合理的，因为您无法判断是否没有回文。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-10-25T03:12:01.133

Clojure 使用 37 个字符：

```
user=> (defn p[s](=(seq s)(reverse(seq s))))
#'user/p
user=> (p "radar")
true
user=> (p "moose")
false 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2008-10-25T03:54:16.273

Perl 中的 24 个字符。

```
sub p{$_[0]eq+reverse@_} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-23T04:22:48.273

我在 C 中的尝试（70 个字符）：

```
P(char*s){char*e=s+strlen(s)-1;while(s<e&&*s==*e)s++,e--;return s>=e;} 
```

[编辑] 现在实际工作
[编辑 2] 通过使用默认 int return 从 74 减少到 70

作为对一些评论的回应：我不确定预处理器滥用是否算数——您可以在命令行上定义整个内容并将函数设为一个字符。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-01-23T08:14:28.620

Haskell，36 个字符，包括它自己的反向函数。（实际上，如果您使用分号使其成为单行，并忽略末尾的换行符，则为 35...）

```
r[]y=y
r(a:x)y=r x$a:y
p s=s==r s[] 
```

与其他实现一样，“p”是回文谓词。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2010-02-24T06:38:06.523

Perl（21 个字符）：

```
sub{"@_"eq reverse@_} 
```

嘿，这个问题没有指定一个*命名*的子程序！

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2011-05-14T22:46:28.193

F#，没有 LINQ 和 Reverse 方法。序列折叠：

```
let p (s : string) = 
  fst(s |> Seq.fold (fun (r, i) c -> (r && c = s.[s.Length - 1 - i], i + 1)) (true, 0)) 
```

相同，但使用 Seq.iteri 和 ref 变量而不是 Seq.fold：

```
let p (s : string) = 
  let r = ref true
  Seq.iteri (fun i c -> r :=  (!r && c = s.[s.Length - 1 - i])) s
  !r 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-23T12:40:32.543

CFScript，39 个字符：

```
function y(x){return(x is reverse(x));} 
```

我从来都不擅长打高尔夫球。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-23T12:55:31.703

爪哇：

```
boolean y(StringBuffer x){return x.equals(x.reverse());} 
```

上面的不行，哎呀！

```
boolean y(StringBuffer x){return x.toString().equals(x.reverse().toString()); } 
```

嗯。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-23T19:20:23.797

外壳脚本（sed + tac + tr）：

```
test "`echo $1|sed -e 's/\(.\)/\1\n/g'|tac|tr -d '\n'`" == "$1" 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-23T21:52:36.673

绝对不是最小的，但我还是想添加一个条目：

```
sub p{return @_==reverse split//;} 
```

我的 perl 生锈了，这是未经测试的。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-25T03:49:06.597

C，无库，70 个字符：

```
p(char*a){char*b=a-1;while(*++b);while(a<b&&*a++==*--b);return!(a<b);} 
```

正如对另一个 C 解决方案的评论之一提到的那样，原型在 C 中是完全可选的，`int`假定在任何地方都会出现类型，但没有被提及。没有人用 pre-ANSI C 编程过吗？

编辑：更短并处理空字符串。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-10-26T02:44:11.913

JavaScript：55 个字符

```
p=function(x){return (x==x.split('').reverse().join())} 
```

*以上将不起作用，因为您需要`join`调用`""`*

JavaScript：55 个字符

```
function p(s){return s==s.split("").reverse().join("")} 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2008-10-26T04:47:58.420

Java，不使用反向：

```
boolean p(String s){int i=0,l=s.length();while(i<l){if(s.charAt(i++)!=s.charAt(--l))l=-1;}return l>=0; 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-10-26T06:39:17.790

标准 ML（34 个字符和无聊）：

```
fun p s=s=implode(rev(explode(s))) 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2008-10-27T10:20:51.257

C，68 个字符，无库：

```
p(char *s){char *e=s;while(*++e);for(;*s==*--e&&s++<e;);return s>e;} 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-01-23T04:18:04.150

may 很好地给出了一个使用标准库的 c++ 示例：

```
bool p(const std::string &s){std::string s2(s);std::reverse(s2);return s==s2;} 
```

感谢 Jon For 指出如果我们制作一些不必要的副本，这可能会更短。共 67 个字符。

```
bool p(std::string s){std::string x=s;std::reverse(x);return s==x;} 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-09-27T11:53:05.337

Python 中的 58 个字符，无需反转字符串：

```
r="y"
对于我在范围内（len（s））：
 如果（s[i]！=s[-i-1]）：
  r="n"
```

也许 for 循环可以优化？Python对我来说是新的......

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2010-08-22T02:45:47.170

javascript递归版本（无反向垃圾）

```
function p(s){l=s.length;return l<2||(s[0]==s[l-1]&&p(s.substr(1,l-2)))} 
```

（72 个字符）

或在内部实现反向：

```
p=function(s,y){return y?(s==p(s)):s[1]?(p(s.substr(1))+s[0]):s[0]}

p("hannah",1); 
```

（67 个字符）

或者，根本不使用内置函数......

```
p=function(s,y,i){
return i?s[i]?s[i]+p(s,0,i+1):'':y?(s==p(s)):s[1]?(p(p(s,0,1))+s[0]):s[0]
}

p("hannah",1); 
```

（92 个字符）

我能想到的最短的：（迭代）

```
function p(s,l){for(c in s){if(s[c]!=s[l-1-c])s=0}return s}

p("hannah",6);// (is this cheating?) 
```

（59 个字符）

期待看到你在 javascript 中做得更好！

（最好不使用任何内置函数，尤其是反向）

（'return s==s.reverse()' 类型的答案并没有给人留下深刻的印象）

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2010-10-07T22:22:39.040

**F#：29 个字符**

```
let p(s:string)=s=s.Reverse() 
```

（假设 System.Linq 已导入）

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2010-10-08T22:12:27.717

C# 使用*递归 lambda*函数而不使用该`Reverse`函数（115 个字符）：

```
Func<string,bool>p=null;p=w=>{if(w.Length<2)return true;return w[0]==w[w.Length-1]&&p(w.Substring(1,w.Length-2));}; 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2010-10-08T22:59:47.740

**不可能的！language**，假设使用普通参数传递字符串：

```
;~= 
```

3 个字符

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2011-03-19T20:33:51.013

JavaScript，64 字节。

```
function a(x){for(r='',i=x.length;i>0;i--)r+=x[i-1];return x==r} 
```

测试用例：

```
a('lolol'); // true
a('haha');  // false 
```

* * *

## 回答 #50

> 赞同：-1
> 
> 时间：2008-10-24T05:56:04.653

上面 Josh 的 Java 代码片段每次都会返回 true。

# c# - C# 中的 Char.IsHex()

> ID：228523
> 
> 赞同：6
> 
> 时间：2008-10-23T04:19:10.310
> 
> 标签：c#, algorithm

从[这个问题](https://stackoverflow.com/questions/223832/check-a-string-to-see-if-all-characters-are-hexadecimal-values)开始，在 C# 中编写 Char.IsHex() 函数的最佳方法是什么。到目前为止，我有这个但不喜欢它：

```
bool CharIsHex(char c) {
    c = Char.ToLower(c);
    return (Char.IsDigit(c) || c == 'a' || c == 'b' || c == 'c' || c == 'd' || c == 'e' || c == 'f')
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-23T04:24:33.030

您可以将其编写为扩展方法：

```
public static class Extensions
{
   public static bool IsHex(this char c)
   {
      return   (c >= '0' && c <= '9') ||
               (c >= 'a' && c <= 'f') ||
               (c >= 'A' && c <= 'F');
   }
} 
```

这意味着您可以将其称为`char`.

```
char c = 'A';

if (c.IsHex())
{
   Console.WriteLine("We have a hex char.");
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-23T04:22:54.687

根据[我](https://stackoverflow.com/questions/223832/check-a-string-to-see-if-all-characters-are-hexadecimal-values#223854)对您链接到的问题的回答：

```
bool is_hex_char = (c >= '0' && c <= '9') ||
                   (c >= 'a' && c <= 'f') ||
                   (c >= 'A' && c <= 'F'); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-23T04:49:43.557

请注意，`Char.IsDigit()`返回`true`的代码点不仅仅是 ASCII 范围 0x30 到 0x39 中的数字。

例如`true`从 Char.IsDigit() 返回的泰文数字字符： '๐' '๑' '๒' '๓' '๔' '๕' '๖' '๗' '๘' '๙'

还有一些“全角”字符`Char.IsDigit()`返回 true 为：`0xff10`through `0xff19`。这些字形看起来就像 ASCII 字符`0x30-0x39`，所以如果你要接受它们，你也应该接受它们`0xff21-0xff26`，`0xff41-0xff46`它们看起来就像 'A'-'F' 和 'a'-'f'。

如果您要支持 ASCII 范围之外的数字，您的用户可能希望您支持对应于拉丁语 'a'..'f' 和 'A'..'F' 的字形，这些字形存在于其他ASCII 范围之外的脚本。

就个人而言，我认为我会坚持更多类似的东西：

```
 bool isHexChar = ('0' <= c) && (c <= '9') ||
                         ('a' <= c) && (c <= 'f') ||
                         ('A' <= c) && (c <= 'F'); 
```

我认为这对人们来说可能不会那么令人惊讶。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-10T08:40:10.810

只需使用 .NET 方法：

```
char c = 'a';
System.Uri.IsHexDigit(c); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-12T15:12:52.167

还有另一种方法可以做到这一点，使用字符串比较。

```
bool IsHex(char c)
{
    return "0123456789ABCDEFabcdef".IndexOf(c) != -1;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-23T04:41:50.343

关于什么

```
bool CharIsHex(char c) {
    c = Char.ToLower(c);
    return Char.IsDigit(c) || (c >= 'a' && c <= 'f');
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-23T05:15:41.117

您可以在扩展函数中使用正则表达式：

```
using System.Text.RegularExpressions;
public static class Extensions
{
    public static bool IsHex(this char c)
    {

        return (new Regex("[A-Fa-f0-9]").IsMatch(c.ToString()));
    }
} 
```

# c# - C#中 Char.IsDigit() 和 Char.IsNumber() 的区别

> ID：228532
> 
> 赞同：172
> 
> 时间：2008-10-23T04:23:13.920
> 
> 标签：c#, .net, unicode

`Char.IsDigit()`C#和C#有什么区别`Char.IsNumber()`？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-10-23T04:39:27.647

`Char.IsDigit()`是 的子集`Char.IsNumber()`。

一些是“数字”但不是数字的字符包括上标 2 和 3（“²”和“³”）的 0x00b2 和 0x00b3，以及分数的字形，例如“¼”、“½”和“¾” '。

请注意，有相当多的字符`IsDigit()`返回`true`不在 0x30 到 0x39 的 ASCII 范围内，例如这些泰语数字字符：'๐' '๑' '๒' '๓' '๔' '๕' '๖ ''๗''๘''๙'。

这段代码告诉您哪些代码点不同：

```
static private void test()
{
    for (int i = 0; i <= 0xffff; ++i)
    {
        char c = (char) i;

        if (Char.IsDigit( c) != Char.IsNumber( c)) {
            Console.WriteLine( "Char value {0:x} IsDigit() = {1}, IsNumber() = {2}", i, Char.IsDigit( c), Char.IsNumber( c));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-10-23T04:25:15.727

我找到了答案：

> Char.IsNumber() 确定 Char 是否属于任何数字 Unicode 类别。这与 IsDigit 形成对比，后者确定 Char 是否为 radix-10 数字。
> 
> [有效数字是UnicodeCategory](http://msdn.microsoft.com/en-us/library/system.globalization.unicodecategory.aspx "十进制数字字符，即 0 到 9 范围内的字符。由 Unicode 名称表示")中以下类别的 成员：
> 
> 1.  **`DecimalDigitNumber`**
>     十进制数字字符，即 0 到 9 范围内的字符。由 Unicode 名称“Nd”（数字，十进制数字）表示。值为 8。
> 2.  **`LetterNumber`**
>     用字母表示的数字，而不是十进制数字，例如罗马数字表示五，即“V”。该指示符由 Unicode 名称“Nl”（数字、字母）表示。值为 9。
> 3.  **`OtherNumber`**
>     既不是十进制数字也不是字母数字的数字，例如分数 ½。该指示符由 Unicode 名称“No”（数字、其他）表示。值为 10。

## 结论

*   **`Char.IsDigit`**：
    有效数字仅是该`DecimalDigitNumber`类别的成员。
*   **`Char.IsNumber`**:
    有效数字是`DecimalDigitNumber`、`LetterNumber`或`OtherNumber`类别的成员。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2016-03-17T09:25:33.860

`IsNumber(x)`有时会返回`true`结果，一般人不会认为是一个数字，这就是原因。

C# 将字符分组到`UnicodeCategory`其中数字不属于单个而是 3 个不同的类别：

1.  UnicodeCategory.DecimalDigitNumber

> 十进制数字字符，即 0 到 9 范围内的字符。由 Unicode 名称“Nd”（数字，十进制数字）表示。值为 8。

2.  UnicodeCategory.OtherNumber

> 既不是十进制数字也不是字母数字的数字，例如分数 1/2。该指示符由 Unicode 名称“No”（数字、其他）表示。值为 10。

3.  UnicodeCategory.LetterNumber

> 用字母表示的数字，而不是十进制数字，例如罗马数字表示五，即“V”。该指示符由 Unicode 名称“Nl”（数字、字母）表示。值为 9。

任何属于上述之一的东西都将返回`true`. `IsNumber()`因为`IsDigit()`它只会是`UnicodeCategory.DecimalDigitNumber`。

**我写了这段代码来指示哪个是哪个：（**由于允许的帖子大小，表格未满，但您应该能够生成它，无论如何它仅用于示例目的）

```
 [Test]
    public void IsNumberTest()
    {
        var numberLikes = new[] { UnicodeCategory.DecimalDigitNumber, UnicodeCategory.OtherNumber, UnicodeCategory.LetterNumber };
        for (var i = 0; i < 0xffff; i++)
        {
            var c = Char.ConvertFromUtf32(i).ToCharArray()[0];
            if (numberLikes.Contains(Char.GetUnicodeCategory(c)))
            {
                File.AppendAllText("IsNumberLike.txt", string.Format("{0},{1},{2},&#{3};,{4},{5}\n", i, c, Char.GetUnicodeCategory(c), i, Char.IsNumber(c), Char.IsDigit(c)));
            }
        }
    } 
```

结果如下所示： 如您所见，有些东西不会是“数字”。

```
+------+----+--------------------+----------+------+-------+
| int |symbol| UnicodeCategory   | Html   |IsNumber|IsDigit|
+-------+---+--------------------+----------+------+-------+
|    48 | 0 | DecimalDigitNumber | &#48;    | True | True  |
|    49 | 1 | DecimalDigitNumber | &#49;    | True | True  |
|    50 | 2 | DecimalDigitNumber | &#50;    | True | True  |
|    51 | 3 | DecimalDigitNumber | &#51;    | True | True  |
|    52 | 4 | DecimalDigitNumber | &#52;    | True | True  |
|    53 | 5 | DecimalDigitNumber | &#53;    | True | True  |
|    54 | 6 | DecimalDigitNumber | &#54;    | True | True  |
|    55 | 7 | DecimalDigitNumber | &#55;    | True | True  |
|    56 | 8 | DecimalDigitNumber | &#56;    | True | True  |
|    57 | 9 | DecimalDigitNumber | &#57;    | True | True  |
|   178 | ² | OtherNumber        | &#178;   | True | False |
|   179 | ³ | OtherNumber        | &#179;   | True | False |
|   185 | ¹ | OtherNumber        | &#185;   | True | False |
|   188 | ¼ | OtherNumber        | &#188;   | True | False |
|   189 | ½ | OtherNumber        | &#189;   | True | False |
|   190 | ¾ | OtherNumber        | &#190;   | True | False |
|  1632 | ٠ | DecimalDigitNumber | &#1632;  | True | True  |
|  1633 | ١ | DecimalDigitNumber | &#1633;  | True | True  |
|  1634 | ٢ | DecimalDigitNumber | &#1634;  | True | True  |
|  1635 | ٣ | DecimalDigitNumber | &#1635;  | True | True  |
|  1636 | ٤ | DecimalDigitNumber | &#1636;  | True | True  |
|  1637 | ٥ | DecimalDigitNumber | &#1637;  | True | True  |
|  1638 | ٦ | DecimalDigitNumber | &#1638;  | True | True  |
|  1639 | ٧ | DecimalDigitNumber | &#1639;  | True | True  |
|  1640 | ٨ | DecimalDigitNumber | &#1640;  | True | True  |
|  1641 | ٩ | DecimalDigitNumber | &#1641;  | True | True  |
|  1776 | ۰ | DecimalDigitNumber | &#1776;  | True | True  |
|  1777 | ۱ | DecimalDigitNumber | &#1777;  | True | True  |
|  1778 | ۲ | DecimalDigitNumber | &#1778;  | True | True  |
|  1779 | ۳ | DecimalDigitNumber | &#1779;  | True | True  |
|  1780 | ۴ | DecimalDigitNumber | &#1780;  | True | True  |
|  1781 | ۵ | DecimalDigitNumber | &#1781;  | True | True  |
|  1782 | ۶ | DecimalDigitNumber | &#1782;  | True | True  |
|  1783 | ۷ | DecimalDigitNumber | &#1783;  | True | True  |
|  1784 | ۸ | DecimalDigitNumber | &#1784;  | True | True  |
|  1785 | ۹ | DecimalDigitNumber | &#1785;  | True | True  |
|  1984 | ߀ | DecimalDigitNumber | &#1984;  | True | True  |
|  1985 | ߁ | DecimalDigitNumber | &#1985;  | True | True  |
|  1986 | ߂ | DecimalDigitNumber | &#1986;  | True | True  |
|  1987 | ߃ | DecimalDigitNumber | &#1987;  | True | True  |
|  1988 | ߄ | DecimalDigitNumber | &#1988;  | True | True  |
|  1989 | ߅ | DecimalDigitNumber | &#1989;  | True | True  |
|  1990 | ߆ | DecimalDigitNumber | &#1990;  | True | True  |
|  1991 | ߇ | DecimalDigitNumber | &#1991;  | True | True  |
|  1992 | ߈ | DecimalDigitNumber | &#1992;  | True | True  |
|  1993 | ߉ | DecimalDigitNumber | &#1993;  | True | True  |
|  2406 | ० | DecimalDigitNumber | &#2406;  | True | True  |
|  2407 | १ | DecimalDigitNumber | &#2407;  | True | True  |
|  2408 | २ | DecimalDigitNumber | &#2408;  | True | True  |
|  2409 | ३ | DecimalDigitNumber | &#2409;  | True | True  |
|  2410 | ४ | DecimalDigitNumber | &#2410;  | True | True  |
|  2411 | ५ | DecimalDigitNumber | &#2411;  | True | True  |
|  2412 | ६ | DecimalDigitNumber | &#2412;  | True | True  |
|  2413 | ७ | DecimalDigitNumber | &#2413;  | True | True  |
|  2414 | ८ | DecimalDigitNumber | &#2414;  | True | True  |
|  2415 | ९ | DecimalDigitNumber | &#2415;  | True | True  |
|  2534 | ০ | DecimalDigitNumber | &#2534;  | True | True  |
|  2535 | ১ | DecimalDigitNumber | &#2535;  | True | True  |
|  2536 | ২ | DecimalDigitNumber | &#2536;  | True | True  |
|  2537 | ৩ | DecimalDigitNumber | &#2537;  | True | True  |
|  2538 | ৪ | DecimalDigitNumber | &#2538;  | True | True  |
|  2539 | ৫ | DecimalDigitNumber | &#2539;  | True | True  |
|  2540 | ৬ | DecimalDigitNumber | &#2540;  | True | True  |
|  2541 | ৭ | DecimalDigitNumber | &#2541;  | True | True  |
|  2542 | ৮ | DecimalDigitNumber | &#2542;  | True | True  |
|  2543 | ৯ | DecimalDigitNumber | &#2543;  | True | True  |
|  2548 | ৴ | OtherNumber        | &#2548;  | True | False |
|  2549 | ৵ | OtherNumber        | &#2549;  | True | False |
|  2550 | ৶ | OtherNumber        | &#2550;  | True | False |
|  2551 | ৷ | OtherNumber        | &#2551;  | True | False |
|  2552 | ৸ | OtherNumber        | &#2552;  | True | False |
|  2553 | ৹ | OtherNumber        | &#2553;  | True | False |
|  2662 | ੦ | DecimalDigitNumber | &#2662;  | True | True  |
|  2663 | ੧ | DecimalDigitNumber | &#2663;  | True | True  |
|  2664 | ੨ | DecimalDigitNumber | &#2664;  | True | True  |
|  2665 | ੩ | DecimalDigitNumber | &#2665;  | True | True  |
|  2666 | ੪ | DecimalDigitNumber | &#2666;  | True | True  |
|  2667 | ੫ | DecimalDigitNumber | &#2667;  | True | True  |
|  2668 | ੬ | DecimalDigitNumber | &#2668;  | True | True  |
|  2669 | ੭ | DecimalDigitNumber | &#2669;  | True | True  |
|  2670 | ੮ | DecimalDigitNumber | &#2670;  | True | True  |
|  2671 | ੯ | DecimalDigitNumber | &#2671;  | True | True  |
|  2790 | ૦ | DecimalDigitNumber | &#2790;  | True | True  |
|  2791 | ૧ | DecimalDigitNumber | &#2791;  | True | True  |
|  2792 | ૨ | DecimalDigitNumber | &#2792;  | True | True  |
|  2793 | ૩ | DecimalDigitNumber | &#2793;  | True | True  |
|  2794 | ૪ | DecimalDigitNumber | &#2794;  | True | True  |
|  2795 | ૫ | DecimalDigitNumber | &#2795;  | True | True  |
|  2796 | ૬ | DecimalDigitNumber | &#2796;  | True | True  |
|  2797 | ૭ | DecimalDigitNumber | &#2797;  | True | True  |
|  2798 | ૮ | DecimalDigitNumber | &#2798;  | True | True  |
|  2799 | ૯ | DecimalDigitNumber | &#2799;  | True | True  |
|  2918 | ୦ | DecimalDigitNumber | &#2918;  | True | True  |
|  2919 | ୧ | DecimalDigitNumber | &#2919;  | True | True  |
|  2920 | ୨ | DecimalDigitNumber | &#2920;  | True | True  |
|  2921 | ୩ | DecimalDigitNumber | &#2921;  | True | True  |
|  2922 | ୪ | DecimalDigitNumber | &#2922;  | True | True  |
|  2923 | ୫ | DecimalDigitNumber | &#2923;  | True | True  |
|  2924 | ୬ | DecimalDigitNumber | &#2924;  | True | True  |
|  2925 | ୭ | DecimalDigitNumber | &#2925;  | True | True  |
|  2926 | ୮ | DecimalDigitNumber | &#2926;  | True | True  |
|  2927 | ୯ | DecimalDigitNumber | &#2927;  | True | True  |
|  2930 | ୲ | OtherNumber        | &#2930;  | True | False |
|  2931 | ୳ | OtherNumber        | &#2931;  | True | False |
|  2932 | ୴ | OtherNumber        | &#2932;  | True | False |
|  2933 | ୵ | OtherNumber        | &#2933;  | True | False |
|  2934 | ୶ | OtherNumber        | &#2934;  | True | False |
|  2935 | ୷ | OtherNumber        | &#2935;  | True | False |
|  3046 | ௦ | DecimalDigitNumber | &#3046;  | True | True  |
|  3047 | ௧ | DecimalDigitNumber | &#3047;  | True | True  |
|  3048 | ௨ | DecimalDigitNumber | &#3048;  | True | True  |
|  3049 | ௩ | DecimalDigitNumber | &#3049;  | True | True  |
|  3050 | ௪ | DecimalDigitNumber | &#3050;  | True | True  |
|  3051 | ௫ | DecimalDigitNumber | &#3051;  | True | True  |
|  3052 | ௬ | DecimalDigitNumber | &#3052;  | True | True  |
|  3053 | ௭ | DecimalDigitNumber | &#3053;  | True | True  |
|  3054 | ௮ | DecimalDigitNumber | &#3054;  | True | True  |
|  3055 | ௯ | DecimalDigitNumber | &#3055;  | True | True  |
|  3056 | ௰ | OtherNumber        | &#3056;  | True | False |
|  3057 | ௱ | OtherNumber        | &#3057;  | True | False |
|  3058 | ௲ | OtherNumber        | &#3058;  | True | False |
|  3174 | ౦ | DecimalDigitNumber | &#3174;  | True | True  |
|  3175 | ౧ | DecimalDigitNumber | &#3175;  | True | True  |
|  3176 | ౨ | DecimalDigitNumber | &#3176;  | True | True  |
|  3177 | ౩ | DecimalDigitNumber | &#3177;  | True | True  |
|  3178 | ౪ | DecimalDigitNumber | &#3178;  | True | True  |
|  3179 | ౫ | DecimalDigitNumber | &#3179;  | True | True  |
|  3180 | ౬ | DecimalDigitNumber | &#3180;  | True | True  |
|  3181 | ౭ | DecimalDigitNumber | &#3181;  | True | True  |
|  3182 | ౮ | DecimalDigitNumber | &#3182;  | True | True  |
|  3183 | ౯ | DecimalDigitNumber | &#3183;  | True | True  |
|  3192 | ౸ | OtherNumber        | &#3192;  | True | False |
|  3193 | ౹ | OtherNumber        | &#3193;  | True | False |
|  3194 | ౺ | OtherNumber        | &#3194;  | True | False |
|  3195 | ౻ | OtherNumber        | &#3195;  | True | False |
|  3196 | ౼ | OtherNumber        | &#3196;  | True | False |
|  3197 | ౽ | OtherNumber        | &#3197;  | True | False |
|  3198 | ౾ | OtherNumber        | &#3198;  | True | False |
|  3302 | ೦ | DecimalDigitNumber | &#3302;  | True | True  |
|  3303 | ೧ | DecimalDigitNumber | &#3303;  | True | True  |
|  3304 | ೨ | DecimalDigitNumber | &#3304;  | True | True  |
|  3305 | ೩ | DecimalDigitNumber | &#3305;  | True | True  |
|  3306 | ೪ | DecimalDigitNumber | &#3306;  | True | True  |
|  3307 | ೫ | DecimalDigitNumber | &#3307;  | True | True  |
|  3308 | ೬ | DecimalDigitNumber | &#3308;  | True | True  |
|  3309 | ೭ | DecimalDigitNumber | &#3309;  | True | True  |
|  3310 | ೮ | DecimalDigitNumber | &#3310;  | True | True  |
|  3311 | ೯ | DecimalDigitNumber | &#3311;  | True | True  |
|  3430 | ൦ | DecimalDigitNumber | &#3430;  | True | True  |
|  3431 | ൧ | DecimalDigitNumber | &#3431;  | True | True  |
|  3432 | ൨ | DecimalDigitNumber | &#3432;  | True | True  |
|  3433 | ൩ | DecimalDigitNumber | &#3433;  | True | True  |
|  3434 | ൪ | DecimalDigitNumber | &#3434;  | True | True  |
|  3435 | ൫ | DecimalDigitNumber | &#3435;  | True | True  |
|  3436 | ൬ | DecimalDigitNumber | &#3436;  | True | True  |
|  3437 | ൭ | DecimalDigitNumber | &#3437;  | True | True  |
|  3438 | ൮ | DecimalDigitNumber | &#3438;  | True | True  |
|  3439 | ൯ | DecimalDigitNumber | &#3439;  | True | True  |
|  3440 | ൰ | OtherNumber        | &#3440;  | True | False |
|  3441 | ൱ | OtherNumber        | &#3441;  | True | False |
|  3442 | ൲ | OtherNumber        | &#3442;  | True | False |
|  3443 | ൳ | OtherNumber        | &#3443;  | True | False |
|  3444 | ൴ | OtherNumber        | &#3444;  | True | False |
|  3445 | ൵ | OtherNumber        | &#3445;  | True | False |
|  3664 | ๐ | DecimalDigitNumber | &#3664;  | True | True  |
|  3665 | ๑ | DecimalDigitNumber | &#3665;  | True | True  |
|  3666 | ๒ | DecimalDigitNumber | &#3666;  | True | True  |
|  3667 | ๓ | DecimalDigitNumber | &#3667;  | True | True  |
|  3668 | ๔ | DecimalDigitNumber | &#3668;  | True | True  |
|  3669 | ๕ | DecimalDigitNumber | &#3669;  | True | True  |
|  3670 | ๖ | DecimalDigitNumber | &#3670;  | True | True  |
|  3671 | ๗ | DecimalDigitNumber | &#3671;  | True | True  |
|  3672 | ๘ | DecimalDigitNumber | &#3672;  | True | True  |
|  3673 | ๙ | DecimalDigitNumber | &#3673;  | True | True  |
|  3792 | ໐ | DecimalDigitNumber | &#3792;  | True | True  |
|  3793 | ໑ | DecimalDigitNumber | &#3793;  | True | True  |
|  3794 | ໒ | DecimalDigitNumber | &#3794;  | True | True  |
|  3795 | ໓ | DecimalDigitNumber | &#3795;  | True | True  |
|  3796 | ໔ | DecimalDigitNumber | &#3796;  | True | True  |
|  3797 | ໕ | DecimalDigitNumber | &#3797;  | True | True  |
|  3798 | ໖ | DecimalDigitNumber | &#3798;  | True | True  |
|  3799 | ໗ | DecimalDigitNumber | &#3799;  | True | True  |
|  3800 | ໘ | DecimalDigitNumber | &#3800;  | True | True  |
|  3801 | ໙ | DecimalDigitNumber | &#3801;  | True | True  |
|  3872 | ༠ | DecimalDigitNumber | &#3872;  | True | True  |
|  3873 | ༡ | DecimalDigitNumber | &#3873;  | True | True  |
|  3874 | ༢ | DecimalDigitNumber | &#3874;  | True | True  |
|  3875 | ༣ | DecimalDigitNumber | &#3875;  | True | True  |
|  3876 | ༤ | DecimalDigitNumber | &#3876;  | True | True  |
|  3877 | ༥ | DecimalDigitNumber | &#3877;  | True | True  |
|  3878 | ༦ | DecimalDigitNumber | &#3878;  | True | True  |
|  3879 | ༧ | DecimalDigitNumber | &#3879;  | True | True  |
|  3880 | ༨ | DecimalDigitNumber | &#3880;  | True | True  |
|  3881 | ༩ | DecimalDigitNumber | &#3881;  | True | True  |
|  3882 | ༪ | OtherNumber        | &#3882;  | True | False |
|  3883 | ༫ | OtherNumber        | &#3883;  | True | False |
|  3884 | ༬ | OtherNumber        | &#3884;  | True | False |
|  3885 | ༭ | OtherNumber        | &#3885;  | True | False |
|  3886 | ༮ | OtherNumber        | &#3886;  | True | False |
|  3887 | ༯ | OtherNumber        | &#3887;  | True | False |
|  3888 | ༰ | OtherNumber        | &#3888;  | True | False |
|  3889 | ༱ | OtherNumber        | &#3889;  | True | False |
|  3890 | ༲ | OtherNumber        | &#3890;  | True | False |
|  3891 | ༳ | OtherNumber        | &#3891;  | True | False |
|  4160 | ၀ | DecimalDigitNumber | &#4160;  | True | True  |
|  4161 | ၁ | DecimalDigitNumber | &#4161;  | True | True  |
|  4162 | ၂ | DecimalDigitNumber | &#4162;  | True | True  |
|  4163 | ၃ | DecimalDigitNumber | &#4163;  | True | True  |
|  4164 | ၄ | DecimalDigitNumber | &#4164;  | True | True  |
|  4165 | ၅ | DecimalDigitNumber | &#4165;  | True | True  |
|  4166 | ၆ | DecimalDigitNumber | &#4166;  | True | True  |
|  4167 | ၇ | DecimalDigitNumber | &#4167;  | True | True  |
|  4168 | ၈ | DecimalDigitNumber | &#4168;  | True | True  |
|  4169 | ၉ | DecimalDigitNumber | &#4169;  | True | True  |
|  4240 | ႐ | DecimalDigitNumber | &#4240;  | True | True  |
|  4241 | ႑ | DecimalDigitNumber | &#4241;  | True | True  |
|  4242 | ႒ | DecimalDigitNumber | &#4242;  | True | True  |
|  4243 | ႓ | DecimalDigitNumber | &#4243;  | True | True  |
|  4244 | ႔ | DecimalDigitNumber | &#4244;  | True | True  |
|  4245 | ႕ | DecimalDigitNumber | &#4245;  | True | True  |
|  4246 | ႖ | DecimalDigitNumber | &#4246;  | True | True  |
|  4247 | ႗ | DecimalDigitNumber | &#4247;  | True | True  |
|  4248 | ႘ | DecimalDigitNumber | &#4248;  | True | True  |
|  4249 | ႙ | DecimalDigitNumber | &#4249;  | True | True  |
|  4969 | ፩ | OtherNumber        | &#4969;  | True | False |
|  4970 | ፪ | OtherNumber        | &#4970;  | True | False |
|  4971 | ፫ | OtherNumber        | &#4971;  | True | False |
|  4972 | ፬ | OtherNumber        | &#4972;  | True | False |
|  4973 | ፭ | OtherNumber        | &#4973;  | True | False |
|  4974 | ፮ | OtherNumber        | &#4974;  | True | False |
|  4975 | ፯ | OtherNumber        | &#4975;  | True | False |
|  4976 | ፰ | OtherNumber        | &#4976;  | True | False |
|  4977 | ፱ | OtherNumber        | &#4977;  | True | False |
|  4978 | ፲ | OtherNumber        | &#4978;  | True | False |
|  4979 | ፳ | OtherNumber        | &#4979;  | True | False |
|  4980 | ፴ | OtherNumber        | &#4980;  | True | False |
|  4981 | ፵ | OtherNumber        | &#4981;  | True | False |
|  4982 | ፶ | OtherNumber        | &#4982;  | True | False |
|  4983 | ፷ | OtherNumber        | &#4983;  | True | False |
|  4984 | ፸ | OtherNumber        | &#4984;  | True | False |
|  4985 | ፹ | OtherNumber        | &#4985;  | True | False |
|  4986 | ፺ | OtherNumber        | &#4986;  | True | False |
|  4987 | ፻ | OtherNumber        | &#4987;  | True | False |
|  4988 | ፼ | OtherNumber        | &#4988;  | True | False |
|  5870 | ᛮ | LetterNumber       | &#5870;  | True | False |
|  5871 | ᛯ | LetterNumber       | &#5871;  | True | False |
|  5872 | ᛰ | LetterNumber       | &#5872;  | True | False |
|  6112 | ០ | DecimalDigitNumber | &#6112;  | True | True  |
|  6113 | ១ | DecimalDigitNumber | &#6113;  | True | True  |
|  6114 | ២ | DecimalDigitNumber | &#6114;  | True | True  |
|  6115 | ៣ | DecimalDigitNumber | &#6115;  | True | True  |
|  6116 | ៤ | DecimalDigitNumber | &#6116;  | True | True  |
|  6117 | ៥ | DecimalDigitNumber | &#6117;  | True | True  |
|  6118 | ៦ | DecimalDigitNumber | &#6118;  | True | True  |
|  6119 | ៧ | DecimalDigitNumber | &#6119;  | True | True  |
|  6120 | ៨ | DecimalDigitNumber | &#6120;  | True | True  |
|  6121 | ៩ | DecimalDigitNumber | &#6121;  | True | True  |
|  6128 | ៰ | OtherNumber        | &#6128;  | True | False |
|  6129 | ៱ | OtherNumber        | &#6129;  | True | False |
|  6130 | ៲ | OtherNumber        | &#6130;  | True | False |
|  6131 | ៳ | OtherNumber        | &#6131;  | True | False |
|  6132 | ៴ | OtherNumber        | &#6132;  | True | False |
|  6133 | ៵ | OtherNumber        | &#6133;  | True | False |
|  6134 | ៶ | OtherNumber        | &#6134;  | True | False |
|  6135 | ៷ | OtherNumber        | &#6135;  | True | False |
|  6136 | ៸ | OtherNumber        | &#6136;  | True | False |
|  6137 | ៹ | OtherNumber        | &#6137;  | True | False |
|  6160 | ᠐ | DecimalDigitNumber | &#6160;  | True | True  |
|  6161 | ᠑ | DecimalDigitNumber | &#6161;  | True | True  |
|  6162 | ᠒ | DecimalDigitNumber | &#6162;  | True | True  |
|  6163 | ᠓ | DecimalDigitNumber | &#6163;  | True | True  |
|  6164 | ᠔ | DecimalDigitNumber | &#6164;  | True | True  |
|  6165 | ᠕ | DecimalDigitNumber | &#6165;  | True | True  |
|  6166 | ᠖ | DecimalDigitNumber | &#6166;  | True | True  |
|  6167 | ᠗ | DecimalDigitNumber | &#6167;  | True | True  |
|  6168 | ᠘ | DecimalDigitNumber | &#6168;  | True | True  |
|  6169 | ᠙ | DecimalDigitNumber | &#6169;  | True | True  |
|  6470 | ᥆ | DecimalDigitNumber | &#6470;  | True | True  |
|  6471 | ᥇ | DecimalDigitNumber | &#6471;  | True | True  |
|  6472 | ᥈ | DecimalDigitNumber | &#6472;  | True | True  |
|  6473 | ᥉ | DecimalDigitNumber | &#6473;  | True | True  |
|  6474 | ᥊ | DecimalDigitNumber | &#6474;  | True | True  |
|  6475 | ᥋ | DecimalDigitNumber | &#6475;  | True | True  |
|  6476 | ᥌ | DecimalDigitNumber | &#6476;  | True | True  |
|  6477 | ᥍ | DecimalDigitNumber | &#6477;  | True | True  |
|  6478 | ᥎ | DecimalDigitNumber | &#6478;  | True | True  |
|  6479 | ᥏ | DecimalDigitNumber | &#6479;  | True | True  |
|  6608 | ᧐ | DecimalDigitNumber | &#6608;  | True | True  |
|  6609 | ᧑ | DecimalDigitNumber | &#6609;  | True | True  |
|  6610 | ᧒ | DecimalDigitNumber | &#6610;  | True | True  |
|  6611 | ᧓ | DecimalDigitNumber | &#6611;  | True | True  |
|  6612 | ᧔ | DecimalDigitNumber | &#6612;  | True | True  |
|  6613 | ᧕ | DecimalDigitNumber | &#6613;  | True | True  |
|  6614 | ᧖ | DecimalDigitNumber | &#6614;  | True | True  |
|  6615 | ᧗ | DecimalDigitNumber | &#6615;  | True | True  |
|  6616 | ᧘ | DecimalDigitNumber | &#6616;  | True | True  |
|  6617 | ᧙ | DecimalDigitNumber | &#6617;  | True | True  |
|  6618 | ᧚ | OtherNumber        | &#6618;  | True | False |
|  6784 | ᪀ | DecimalDigitNumber | &#6784;  | True | True  |
|  6785 | ᪁ | DecimalDigitNumber | &#6785;  | True | True  |
|  6786 | ᪂ | DecimalDigitNumber | &#6786;  | True | True  |
|  6787 | ᪃ | DecimalDigitNumber | &#6787;  | True | True  |
|  6788 | ᪄ | DecimalDigitNumber | &#6788;  | True | True  |
|  6789 | ᪅ | DecimalDigitNumber | &#6789;  | True | True  |
|  6790 | ᪆ | DecimalDigitNumber | &#6790;  | True | True  |
|  6791 | ᪇ | DecimalDigitNumber | &#6791;  | True | True  |
|  6792 | ᪈ | DecimalDigitNumber | &#6792;  | True | True  |
|  6793 | ᪉ | DecimalDigitNumber | &#6793;  | True | True  |
|  6800 | ᪐ | DecimalDigitNumber | &#6800;  | True | True  |
|  6801 | ᪑ | DecimalDigitNumber | &#6801;  | True | True  |
|  6802 | ᪒ | DecimalDigitNumber | &#6802;  | True | True  |
|  6803 | ᪓ | DecimalDigitNumber | &#6803;  | True | True  |
|  6804 | ᪔ | DecimalDigitNumber | &#6804;  | True | True  |
|  6805 | ᪕ | DecimalDigitNumber | &#6805;  | True | True  |
|  6806 | ᪖ | DecimalDigitNumber | &#6806;  | True | True  |
|  6807 | ᪗ | DecimalDigitNumber | &#6807;  | True | True  |
|  6808 | ᪘ | DecimalDigitNumber | &#6808;  | True | True  |
|  6809 | ᪙ | DecimalDigitNumber | &#6809;  | True | True  |
|  6992 | ᭐ | DecimalDigitNumber | &#6992;  | True | True  |
|  6993 | ᭑ | DecimalDigitNumber | &#6993;  | True | True  |
|  6994 | ᭒ | DecimalDigitNumber | &#6994;  | True | True  |
|  6995 | ᭓ | DecimalDigitNumber | &#6995;  | True | True  |
|  6996 | ᭔ | DecimalDigitNumber | &#6996;  | True | True  |
|  6997 | ᭕ | DecimalDigitNumber | &#6997;  | True | True  |
|  6998 | ᭖ | DecimalDigitNumber | &#6998;  | True | True  |
|  6999 | ᭗ | DecimalDigitNumber | &#6999;  | True | True  |
|  7000 | ᭘ | DecimalDigitNumber | &#7000;  | True | True  |
|  7001 | ᭙ | DecimalDigitNumber | &#7001;  | True | True  |
|  7088 | ᮰ | DecimalDigitNumber | &#7088;  | True | True  |
|  7089 | ᮱ | DecimalDigitNumber | &#7089;  | True | True  |
|  7090 | ᮲ | DecimalDigitNumber | &#7090;  | True | True  |
|  7091 | ᮳ | DecimalDigitNumber | &#7091;  | True | True  |
|  7092 | ᮴ | DecimalDigitNumber | &#7092;  | True | True  |
|  7093 | ᮵ | DecimalDigitNumber | &#7093;  | True | True  |
|  7094 | ᮶ | DecimalDigitNumber | &#7094;  | True | True  |
|  7095 | ᮷ | DecimalDigitNumber | &#7095;  | True | True  |
|  7096 | ᮸ | DecimalDigitNumber | &#7096;  | True | True  |
|  7097 | ᮹ | DecimalDigitNumber | &#7097;  | True | True  |
|  7232 | ᱀ | DecimalDigitNumber | &#7232;  | True | True  |
|  7233 | ᱁ | DecimalDigitNumber | &#7233;  | True | True  |
|  7234 | ᱂ | DecimalDigitNumber | &#7234;  | True | True  |
|  7235 | ᱃ | DecimalDigitNumber | &#7235;  | True | True  |
|  7236 | ᱄ | DecimalDigitNumber | &#7236;  | True | True  |
|  7237 | ᱅ | DecimalDigitNumber | &#7237;  | True | True  |
|  7238 | ᱆ | DecimalDigitNumber | &#7238;  | True | True  |
|  7239 | ᱇ | DecimalDigitNumber | &#7239;  | True | True  |
|  8304 | ⁰ | OtherNumber        | &#8304;  | True | False |
|  8308 | ⁴ | OtherNumber        | &#8308;  | True | False |
|  8309 | ⁵ | OtherNumber        | &#8309;  | True | False |
|  8310 | ⁶ | OtherNumber        | &#8310;  | True | False |
|  8311 | ⁷ | OtherNumber        | &#8311;  | True | False |
|  8312 | ⁸ | OtherNumber        | &#8312;  | True | False |
|  8313 | ⁹ | OtherNumber        | &#8313;  | True | False |
|  8320 | ₀ | OtherNumber        | &#8320;  | True | False |
|  8321 | ₁ | OtherNumber        | &#8321;  | True | False |
|  8322 | ₂ | OtherNumber        | &#8322;  | True | False |
|  8323 | ₃ | OtherNumber        | &#8323;  | True | False |
|  8324 | ₄ | OtherNumber        | &#8324;  | True | False |
|  8325 | ₅ | OtherNumber        | &#8325;  | True | False |
|  8326 | ₆ | OtherNumber        | &#8326;  | True | False |
|  8327 | ₇ | OtherNumber        | &#8327;  | True | False |
|  8328 | ₈ | OtherNumber        | &#8328;  | True | False |
|  8329 | ₉ | OtherNumber        | &#8329;  | True | False |
|  8528 | ⅐ | OtherNumber        | &#8528;  | True | False |
|  8529 | ⅑ | OtherNumber        | &#8529;  | True | False |
|  8530 | ⅒ | OtherNumber        | &#8530;  | True | False |
|  8531 | ⅓ | OtherNumber        | &#8531;  | True | False |
|  8532 | ⅔ | OtherNumber        | &#8532;  | True | False |
|  8533 | ⅕ | OtherNumber        | &#8533;  | True | False |
|  8534 | ⅖ | OtherNumber        | &#8534;  | True | False |
|  8535 | ⅗ | OtherNumber        | &#8535;  | True | False |
|  8536 | ⅘ | OtherNumber        | &#8536;  | True | False |
|  8537 | ⅙ | OtherNumber        | &#8537;  | True | False |
|  8538 | ⅚ | OtherNumber        | &#8538;  | True | False |
|  8539 | ⅛ | OtherNumber        | &#8539;  | True | False |
|  8540 | ⅜ | OtherNumber        | &#8540;  | True | False |
|  8541 | ⅝ | OtherNumber        | &#8541;  | True | False |
|  8542 | ⅞ | OtherNumber        | &#8542;  | True | False |
|  8543 | ⅟ | OtherNumber        | &#8543;  | True | False |
|  8544 | Ⅰ | LetterNumber       | &#8544;  | True | False |
|  8545 | Ⅱ | LetterNumber       | &#8545;  | True | False |
|  8546 | Ⅲ | LetterNumber       | &#8546;  | True | False |
|  8547 | Ⅳ | LetterNumber       | &#8547;  | True | False |
|  8548 | Ⅴ | LetterNumber       | &#8548;  | True | False |
|  8549 | Ⅵ | LetterNumber       | &#8549;  | True | False |
|  8550 | Ⅶ | LetterNumber       | &#8550;  | True | False |
|  8551 | Ⅷ | LetterNumber       | &#8551;  | True | False |
|  8552 | Ⅸ | LetterNumber       | &#8552;  | True | False |
|  8553 | Ⅹ | LetterNumber       | &#8553;  | True | False |
|  8554 | Ⅺ | LetterNumber       | &#8554;  | True | False |
|  8555 | Ⅻ | LetterNumber       | &#8555;  | True | False |
|  8556 | Ⅼ | LetterNumber       | &#8556;  | True | False |
|  8557 | Ⅽ | LetterNumber       | &#8557;  | True | False |
|  8558 | Ⅾ | LetterNumber       | &#8558;  | True | False |
|  8559 | Ⅿ | LetterNumber       | &#8559;  | True | False |
|  8560 | ⅰ | LetterNumber       | &#8560;  | True | False |
|  8561 | ⅱ | LetterNumber       | &#8561;  | True | False |
|  8562 | ⅲ | LetterNumber       | &#8562;  | True | False |
|  8563 | ⅳ | LetterNumber       | &#8563;  | True | False |
|  8564 | ⅴ | LetterNumber       | &#8564;  | True | False |
|  8565 | ⅵ | LetterNumber       | &#8565;  | True | False |
|  8566 | ⅶ | LetterNumber       | &#8566;  | True | False |
|  8567 | ⅷ | LetterNumber       | &#8567;  | True | False |
|  8568 | ⅸ | LetterNumber       | &#8568;  | True | False |
|  8569 | ⅹ | LetterNumber       | &#8569;  | True | False |
|  8570 | ⅺ | LetterNumber       | &#8570;  | True | False |
|  8571 | ⅻ | LetterNumber       | &#8571;  | True | False |
|  8572 | ⅼ | LetterNumber       | &#8572;  | True | False |
|  8573 | ⅽ | LetterNumber       | &#8573;  | True | False |
|  8574 | ⅾ | LetterNumber       | &#8574;  | True | False |
|  8575 | ⅿ | LetterNumber       | &#8575;  | True | False |
|  8576 | ↀ | LetterNumber       | &#8576;  | True | False |
|  8577 | ↁ | LetterNumber       | &#8577;  | True | False |
|  8578 | ↂ | LetterNumber       | &#8578;  | True | False |
|  8581 | ↅ | LetterNumber       | &#8581;  | True | False |
+-------+---+--------------------+----------+------+-------+ 
```

# linux - Linux 默认文件权限

> ID：228534
> 
> 赞同：11
> 
> 时间：2008-10-23T04:23:41.893
> 
> 标签：linux, permissions

有没有办法在 Linux 中设置默认文件权限？即，新创建文件的文件权限（无论创建它的上下文如何）。我知道将 umask 放在 shell 启动中，但这仅适用于 shell 会话。**当我使用pscp**将文件传输到 Linux机器时，该文件始终以 664 (rw-rw-r--) 的权限创建。我使用过的各种 Linux 版本都发生过这种情况。当我将文件 pscp 到共享 Linux 机器（如我的 ISP）时，这尤其令人讨厌。在我可以输入并 chmod 权限之前，该文件基本上就坐在那里，每个人都可以读取，这并不完全安全。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T04:39:02.813

将 umask 放在非交互式 shell 启动中（`.bash_profile`, `.zshenv`，`.tcshrc`具体取决于您的 shell）。然后它将针对非登录会话运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-29T07:20:16.510

如果要影响整个系统，也可以放在/etc/profile

# bash - 如何判断字符串是否未在 Bash shell 脚本中定义

> ID：228544
> 
> 赞同：162
> 
> 时间：2008-10-23T04:26:49.063
> 
> 标签：bash, shell, scripting, string, null

如果我想检查空字符串，我会做

```
[ -z $mystr ] 
```

但是如果我想检查变量是否已经被定义呢？或者 Bash 脚本没有区别？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-10-23T17:19:21.453

[我认为Vinko](https://stackoverflow.com/users/5190/vinko-vrsalovic)的[答案](https://stackoverflow.com/a/228552/15168)暗示了您所追求的答案（如果没有说明），尽管它没有简单地拼写出来。要区分 VAR 是否已设置但为空或未设置，您可以使用：

```
if [ -z "${VAR+xxx}" ]; then echo "VAR is not set at all"; fi
if [ -z "$VAR" ] && [ "${VAR+xxx}" = "xxx" ]; then echo "VAR is set but empty"; fi 
```

您可能可以将第二行的两个测试合并为一个：

```
if [ -z "$VAR" -a "${VAR+xxx}" = "xxx" ]; then echo "VAR is set but empty"; fi 
```

但是，如果您阅读 Autoconf 的文档，您会发现他们不建议将术语与 ' `-a`' 结合使用，而是建议使用单独的简单测试与`&&`. 我没有遇到有问题的系统；这并不意味着它们过去不存在（但它们现在可能非常罕见，即使它们在遥远的过去并不罕见）。

您可以在 Bash 手册中找到这些以及其他相关的[shell 参数扩展](https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion)、[`test`或`[`](https://www.gnu.org/software/bash/manual/bash.html#index-_005b)命令和[条件表达式的详细信息。](https://www.gnu.org/software/bash/manual/bash.html#Bash-Conditional-Expressions)

* * *

最近有人通过电子邮件向我询问了这个问题的答案：

> 您使用了两个测试，我很了解第二个，但不是第一个。更准确地说，我不明白变量扩展的必要性
> 
> ```
> if [ -z "${VAR+xxx}" ]; then echo "VAR is not set at all"; fi 
> ```
> 
> 这不也能达到同样的效果吗？
> 
> ```
> if [ -z "${VAR}" ]; then echo "VAR is not set at all"; fi 
> ```

公平的问题 - 答案是“不，您更简单的替代方案不会做同样的事情”。

假设我在你的测试之前写了这个：

```
VAR= 
```

您的测试会说“根本没有设置 VAR”，但我会说（暗示，因为它什么都没有回显）“设置了 VAR，但它的值可能为空”。试试这个脚本：

```
(
unset VAR
if [ -z "${VAR+xxx}" ]; then echo "JL:1 VAR is not set at all"; fi
if [ -z "${VAR}" ];     then echo "MP:1 VAR is not set at all"; fi
VAR=
if [ -z "${VAR+xxx}" ]; then echo "JL:2 VAR is not set at all"; fi
if [ -z "${VAR}" ];     then echo "MP:2 VAR is not set at all"; fi
) 
```

输出是：

```
JL:1 VAR 根本没有设置
MP:1 VAR 根本没有设置
MP:2 VAR 根本没有设置

```

在第二对测试中，变量被设置，但它被设置为空值。这就是 the`${VAR=value}`和`${VAR:=value}`符号的区别。和、 和`${VAR-value}`、等等也是如此。`${VAR:-value}``${VAR+value}``${VAR:+value}`

* * *

正如[Gili在他的](https://stackoverflow.com/users/14731/gili)[回答](https://stackoverflow.com/a/20003892)中指出的那样，如果您`bash`使用该`set -o nounset`选项运行，那么上面的基本答案会以`unbound variable`. 它很容易补救：

```
if [ -z "${VAR+xxx}" ]; then echo "VAR is not set at all"; fi
if [ -z "${VAR-}" ] && [ "${VAR+xxx}" = "xxx" ]; then echo "VAR is set but empty"; fi 
```

或者您可以使用(等价于)取消该`set -o nounset`选项。`set +u``set -u``set -o nounset`

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-10-23T04:31:04.937

```
~> if [ -z $FOO ]; then echo "EMPTY"; fi
EMPTY
~> FOO=""
~> if [ -z $FOO ]; then echo "EMPTY"; fi
EMPTY
~> FOO="a"
~> if [ -z $FOO ]; then echo "EMPTY"; fi
~> 
```

-z 也适用于未定义的变量。要区分未定义和已定义，您将使用[此处](http://wooledge.org:8000/BashFAQ/083)列出的内容，或者使用更清晰的解释，请使用[此处](http://bash-hackers.org/wiki/doku.php/syntax/pe#use_a_default_value)。

最干净的方法是使用这些示例中的扩展。要获得所有选项，请查看手册的参数扩展部分。

替代词：

```
~$ unset FOO
~$ if test ${FOO+defined}; then echo "DEFINED"; fi
~$ FOO=""
~$ if test ${FOO+defined}; then echo "DEFINED"; fi
DEFINED 
```

默认值：

```
~$ FOO=""
~$ if test "${FOO-default value}" ; then echo "UNDEFINED"; fi
~$ unset FOO
~$ if test "${FOO-default value}" ; then echo "UNDEFINED"; fi
UNDEFINED 
```

当然，您会以不同的方式使用其中之一，放置您想要的值而不是“默认值”，并在适当的情况下直接使用扩展。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-10-01T00:03:27.817

高级 bash 脚本指南，10.2。参数替换：

*   ${var+blahblah}：如果定义了 var，则用 'blahblah' 替换表达式，否则替换为 null
*   ${var-blahblah}：如果 var 被定义，它本身被替换，否则 'blahblah' 被替换
*   ${var?blahblah}：如果定义了 var，则将其替换，否则该函数存在，并带有 'blahblah' 作为错误消息。

要将您的程序逻辑基于变量 $mystr 是否已定义，您可以执行以下操作：

```
isdefined=0
${mystr+ export isdefined=1} 
```

现在，如果 isdefined=0 则变量未定义，如果 isdefined=1 变量已定义

这种检查变量的方法比上面的答案更好，因为它更优雅、更易读，并且如果您的 bash shell 配置为在使用未定义变量时出错`(set -u)`，脚本将提前终止。

其他有用的东西：

如果 $mystr 未定义，则为其分配默认值 7，否则保持不变：

```
mystr=${mystr- 7} 
```

如果变量未定义，则打印错误消息并退出函数：

```
: ${mystr? not defined} 
```

请注意，我在这里使用了 ':'，以免 $mystr 的内容作为命令执行，以防万一它被定义。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-06-09T23:23:01.567

测试总结。

```
[ -n "$var" ] && echo "var is set and not empty"
[ -z "$var" ] && echo "var is unset or empty"
[ "${var+x}" = "x" ] && echo "var is set"  # may or may not be empty
[ -n "${var+x}" ] && echo "var is set"  # may or may not be empty
[ -z "${var+x}" ] && echo "var is unset"
[ -z "${var-x}" ] && echo "var is set and empty" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-06-05T18:06:04.263

检查正在定义的变量的显式方法是：

```
[ -v mystr ] 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-15T14:55:17.377

[https://stackoverflow.com/a/9824943/14731](https://stackoverflow.com/a/9824943/14731)包含一个更好的答案（一个更具可读性并且可以`set -o nounset`启用）。它的工作原理大致如下：

```
if [ -n "${VAR-}" ]; then
    echo "VAR is set and is not empty"
elif [ "${VAR+DEFINED_BUT_EMPTY}" = "DEFINED_BUT_EMPTY" ]; then
    echo "VAR is set, but empty"
else
    echo "VAR is not set"
fi 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-27T22:23:47.063

另一种选择：[“列表数组索引”扩展](http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)：

```
$ unset foo
$ foo=
$ echo ${!foo[*]}
0
$ foo=bar
$ echo ${!foo[*]}
0
$ foo=(bar baz)
$ echo ${!foo[*]}
0 1 
```

唯一一次扩展为空字符串是 when`foo`未设置，因此您可以使用字符串条件检查它：

```
$ unset foo
$ [[ ${!foo[*]} ]]; echo $?
1
$ foo=
$ [[ ${!foo[*]} ]]; echo $?
0
$ foo=bar
$ [[ ${!foo[*]} ]]; echo $?
0
$ foo=(bar baz)
$ [[ ${!foo[*]} ]]; echo $?
0 
```

应该在任何 bash 版本 >= 3.0 中可用

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-21T16:19:56.743

不要进一步摆脱这辆自行车，但想添加

```
shopt -s -o nounset 
```

是您可以添加到脚本顶部的内容，如果未在脚本中的任何位置*声明*变量，则会出错。您会看到的消息是`unbound variable`，但正如其他人提到的那样，它不会捕获空字符串或空值。为了确保任何单个值都不为空，我们可以测试一个变量，因为它使用 扩展`${mystr:?}`，也称为美元符号扩展，这会与`parameter null or not set`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-01T19:49:44.497

[Bash 参考手册](https://www.gnu.org/software/bash/manual/bash.html "gnu.org 上的 Bash 参考手册")是有关 bash 的权威信息来源。

这是一个测试变量以查看它是否存在的示例：

```
if [ -z "$PS1" ]; then
        echo This shell is not interactive
else
        echo This shell is interactive
fi 
```

（来自[第 6.3.2 节](https://www.gnu.org/software/bash/manual/bash.html#Is-this-Shell-Interactive_003f "链接到手册中的特定部分")。）

请注意，在 open 之后`[`和之前的空格`]`不是*可选*的。

* * *

**Vim 用户提示**

我有一个脚本，其中有几个声明如下：

```
export VARIABLE_NAME="$SOME_OTHER_VARIABLE/path-part" 
```

但我希望他们尊重任何现有的价值观。所以我把它们改写成这样：

```
if [ -z "$VARIABLE_NAME" ]; then
        export VARIABLE_NAME="$SOME_OTHER_VARIABLE/path-part"
fi 
```

我能够使用快速正则表达式在 vim 中自动执行此操作：

```
s/\vexport ([A-Z_]+)\=("[^"]+")\n/if [ -z "$\1" ]; then\r  export \1=\2\rfi\r/gc 
```

这可以通过在视觉上选择相关行，然后键入来应用`:`。命令栏预填充`:'<,'>`. 粘贴上面的命令并回车。

* * *

在这个版本的 Vim 上测试：

```
VIM - Vi IMproved 7.3 (2010 Aug 15, compiled Aug 22 2015 15:38:58)
Compiled by root@apple.com 
```

Windows 用户可能需要不同的行尾。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-01T01:02:26.100

这是我认为检查变量是否已定义的更清晰的方法：

```
var_defined() {
    local var_name=$1
    set | grep "^${var_name}=" 1>/dev/null
    return $?
} 
```

按如下方式使用它：

```
if var_defined foo; then
    echo "foo is defined"
else
    echo "foo is not defined"
fi 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-11-27T15:44:42.180

测试未定义变量的较短版本可以简单地是：

```
test -z ${mystr} && echo "mystr is not defined" 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2008-10-23T04:36:34.753

不带任何参数的调用 set .. 它输出所有定义的变量 ..
列表中的最后一个将是脚本中定义的变量 ..
所以你可以将它的输出通过管道传递给可以确定定义了什么和没有定义什么的东西

# image-processing - 关于 Ghostscript：创建空白 .tif 文档的最快方法

> ID：228545
> 
> 赞同：0
> 
> 时间：2008-10-23T04:28:20.527
> 
> 标签：image-processing, tiff, ghostscript

遗留后端需要带有 .tif 文档的电子邮件正文，没有 tif 并且它会失败。所以我需要生成一个空白的.tif，有没有一种快速的方法可以用ghostscript做到这一点？

* * *

编辑：在我需要时在项目安装中使用一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T09:07:38.073

以下行将生成一个 1 像素的 Tiff 文件（340 字节）。这是我能得到的最小的 Tiff 文件。

```
gswin32c.exe -q -dNOPAUSE -sDEVICE=tiffpack -g1x1 -sOutputFile=small.tif -c newpath 0 0 moveto 1 1 lineto closepath stroke showpage quit 
```

实际上，您甚至可以将命令简化为：

```
gswin32c.exe -q -dNOPAUSE -sDEVICE=tiffpack -g1x1 -sOutputFile=small.tif -c showpage quit 
```

没有尺寸增益，唉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T04:48:17.630

您不能制作一次空白 .tif 文件，然后在每次需要时附加相同的文件吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T06:50:07.527

可能在这里：[Re: [R] 使用 rtiff 制作 TIFF 图像](http://tolstoy.newcastle.edu.au/R/e2/help/07/01/8435.html)

# asp.net - 在Javascript中获取GridView选定的行DataKey

> ID：228549
> 
> 赞同：9
> 
> 时间：2008-10-23T04:29:51.973
> 
> 标签：asp.net, javascript, gridview

我有 GridView ，我可以选择一行。然后，我在网格上方有一个名为 Edit 的按钮，用户可以单击该按钮弹出一个窗口并编辑选定的行。所以按钮后面会有Javascript代码

```
function editRecord()
{
  var gridView = document.getElementById("<%= GridView.ClientID %>");
  var id = // somehow get the id here ???
  window.open("edit.aspx?id=" + id);
} 
```

问题是如何在 javascript 中检索选定的记录 ID？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T05:22:53.583

我根据 JasonS 的回应解决了这个问题。我所做的是在网格视图中创建一个隐藏字段，如下所示：

```
<asp:TemplateField ShowHeader="False">
    <ItemTemplate>
      <asp:HiddenField ID="hdID" runat="server" Value='<%# Eval("JobID") %>' />
    </ItemTemplate>
</asp:TemplateField>
<asp:TemplateField Visible="False">
    <ItemTemplate>
      <asp:LinkButton ID="lnkSelect" runat="server" CommandName="select" Text="Select" />
    </ItemTemplate>
</asp:TemplateField> 
```

然后在 OnRowDataBind 上有代码来设置选定的行

```
protected virtual void Grid_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        // Click to highlight row
        Control lnkSelect = e.Row.FindControl("lnkSelect");
        if (lnkSelect != null)
        {
            StringBuilder click = new StringBuilder();
            click.AppendLine(m_View.Page.ClientScript.GetPostBackClientHyperlink(lnkSelect, String.Empty));
            click.AppendLine(String.Format("onGridViewRowSelected('{0}')", e.Row.RowIndex));
            e.Row.Attributes.Add("onclick", click.ToString());
        }
    }            
} 
```

然后在Javascript中我有这样的代码

```
<script type="text/javascript">

var selectedRowIndex = null;

function onGridViewRowSelected(rowIndex)
{        
    selectedRowIndex = rowIndex;
}

function editItem()
{   
    if (selectedRowIndex == null) return;

    var gridView = document.getElementById('<%= GridView1.ClientID %>');                
    var cell = gridView.rows[parseInt(selectedRowIndex)+1].cells[0];        
    var hidID = cell.childNodes[0];        
    window.open('JobTypeEdit.aspx?id=' + hidID.value);
}

</script> 
```

工作一种享受:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T04:33:55.430

1）更改您的javascript函数以使用参数

```
function editRecord(clientId)
{ .... 
```

2）在你的editRecord按钮中输出调用......如果你想避免处理.net生成的ID，只需使用一个简单的

```
<input type="button" onclick="editRecord(your-rows-client-id-goes-here)" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T04:41:18.160

根据您对@DaveK 响应的评论，在 javascript 中，您可以在用户选择隐藏字段时将隐藏字段的 id 设置为所选行的 clientId。然后让您的 editRecord 函数使用在隐藏表单字段上设置的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-18T03:12:30.020

通过为每一行设置预先填充有查询字符串的锚标记，可以完全避免使用 javascript（尽管这会影响您的表格布局，但它只需要单击一次而不是用户单击 2 次）

在gridview模板中插入：

```
<asp:HyperLink runat="server" ID="editLink" Target="_blank"
   NavigateURL='<%# Eval("JobID","edit.aspx?id={0}") %>'> 
     Edit..
</asp:HyperLink> 
```

# c# - winforms 仪表。

> ID：228553
> 
> 赞同：0
> 
> 时间：2008-10-23T04:31:48.770
> 
> 标签：c#, winforms, instrumentation

什么是仪器的最佳模式。我有一个应用程序，我希望能够在每次用户在应用程序中执行多项功能（打开表单、查看某个功能等）时跟踪指标，但我不想在整个应用程序中都有代码正在做这个仪器。我在这里有什么选择？

归根结底，我希望能够汇总多个用户列出指标的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T05:36:14.460

我一直在研究做一些非常相似的事情（对于一个匿名的统计收集库......有点像谷歌分析，但对于桌面应用程序。如果你有兴趣，请查看[这里](http://benjismith.net/index.php/gui-mockup-version-1/)的 GUI 模型。）

无论如何...对于.NET，我一直在研究一些提供动态和静态检测的面向方面的库。我不确定它们是否符合要求（我还没有编写任何代码；我刚刚开始研究这些库）。但这里有一些前景：

*   [http://dotspect.tigris.org/](http://dotspect.tigris.org/)

*   [http://setpoint.codehaus.org/](http://setpoint.codehaus.org/)

*   [http://www.springframework.net/docs/1.2.0-RC1/reference/html/aop.html](http://www.springframework.net/docs/1.2.0-RC1/reference/html/aop.html)

*   [http://www.castleproject.org/aspectsharp/](http://www.castleproject.org/aspectsharp/)

*   [http://www.postsharp.org/](http://www.postsharp.org/)

祝你好运！

# c# - 如何将 ToLongDateString() 的日期和月份首字母大写导致 es-mx 文化？

> ID：228559
> 
> 赞同：7
> 
> 时间：2008-10-23T04:35:38.000
> 
> 标签：c#, .net, datetime, internationalization, culture

目前我在 es-MX Culture 中从以下 C# 代码行获得以下结果

```
 Thread.CurrentThread.CurrentCulture =
     Thread.CurrentThread.CurrentUICulture = new
                CultureInfo("es-mx");

  <span><%=DateTime.Now.ToLongDateString()%></span> 
```

# miércoles，2008 年 10 月 22 日

我想获得以下

# Miércoles，2008 年 10 月 22 日

我需要建立自己的文化吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T05:00:02.223

你不需要建立自己的文化。您只需要更改当前区域性中的属性 DateTimeFormat.DayNames 和 DateTimeFormat.MonthNames。

IE

```
 string[] newNames = { "Lunes", "Martes", "Miercoles", "Jueves", "Viernes", "Sabado", "Domingo" };
        Thread.CurrentThread.CurrentCulture.DateTimeFormat.DayNames = newNames; 
```

然而，奇怪的是 en-US 以第一个大写字母显示月份和日期，而 mx-ES 则没有。

希望能帮助到你！。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T04:50:11.310

西班牙语（墨西哥）的 LongDate 模式是

> `dddd, dd' de 'MMMM' de 'yyyy`

根据[Thread.CurrentThread.CurrentCulture.DateTimeFormat.LongDatePattern](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.longdatepattern.aspx)。我想您只需手动将日期和月份的首字母转换为大写，或者您可以使用[Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)然后将“De”替换为“de”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T05:38:50.430

前两个解决方案工作正常，但如果我们想将其扩展到任何文化怎么办，所以我想出了这种方法，我将当前文化日期时间数组更改为 TitleCase

```
private void SetDateTimeFormatNames()
        {

            Thread.CurrentThread.CurrentCulture.DateTimeFormat.DayNames = ConvertoToTitleCase(Thread.CurrentThread.CurrentCulture.DateTimeFormat.DayNames);
            Thread.CurrentThread.CurrentCulture.DateTimeFormat.MonthNames = ConvertoToTitleCase(Thread.CurrentThread.CurrentCulture.DateTimeFormat.MonthNames);

        }

private string[] ConvertoToTitleCase(string[] arrayToConvert)
            {
                for (int i = 0; i < arrayToConvert.Length; i++)
                {
                    arrayToConvert[i] = Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase(arrayToConvert[i]);
                }

                return arrayToConvert;
            } 
```

如果没有循环，如何改进？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-30T03:03:37.233

有点晚了，但这对我有用！

```
 public static string GetFecha()
    {
        System.Globalization.CultureInfo culture = new System.Globalization.CultureInfo("es-EC");
        System.Threading.Thread.CurrentThread.CurrentCulture = culture;

        // maldita sea!
        string strDate = culture.TextInfo.ToTitleCase(DateTime.Now.ToLongDateString());

        return strDate.Replace("De", "de");

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-07T20:20:52.097

不变文化的自定义长日期格式字符串是“dddd, dd MMMM yyyy”，所以可以使用`string.Format`和处理大写的方法：

```
private string GetDateFormated(DateTime date)
{
    return string.Format("{0}, {1} {2} {3}",
        ToTitleCase(date.ToString("dddd")),
        date.ToString("dd"),
        ToTitleCase(date.ToString("MMMM")),
        date.ToString("yyyy"));
}

private string ToTitleCase(string input)
{
    return input[0].ToString().ToUpper() + input.Substring(1);
} 
```

参考：[长日期（“D”）格式说明符](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings#LongDate)

# makefile - Makefile 问题与在规则的命令部分中使用的定义中使用的条件有关

> ID：228567
> 
> 赞同：4
> 
> 时间：2008-10-23T04:40:15.913
> 
> 标签：makefile

我有一段具有这种结构的makefile：

```
 bob:
ifdef DEBUG
    @echo running
endif
    @echo chug chug chug
ifdef DEBUG
    @echo done
endif    

bobit:
    @echo "before"
    @make bob
    @echo "after" 
```

我在这里大大简化了，所有的回声实际上都是不平凡的命令块，还有更多的条件内容，但这抓住了我问题的本质。

出于技术原因，我现在不想进入，我需要摆脱那个 submake，但是因为 echo 代表了不平凡的代码量，我不想只是复制并通过 bob 的主体来代替子制作。

理想情况下，我想做的是这样的

```
 define BOB_BODY 
ifdef DEBUG
    @echo running
endif
    @echo chug chug chug
ifdef DEBUG
    @echo done
endif
endef

bob:
    $(BOB_BODY)

bobit:
    @echo "before"
    $(BOB_BODY)
    @echo "after" 
```

不幸的是，条件似乎对我不利，它们产生“ifdef：找不到命令”错误，我尝试使用 eval 和 call 的各种组合来解决这个问题，但似乎无法找到让它工作的方法。

我该如何进行这项工作？它甚至是解决问题的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T10:30:20.700

我解决这个问题的方法是改用 bash 条件，这实际上是有一定意义的，因为我们是在玩命令而不是制定规则。

所以我从上面的理想解决方案变成了

```
 define BOB_BODY
    @if [[ -n "$(DEBUG)" ]]; then \
        echo running; \
    fi;
    @echo chug chug chug
    @if [[ -n "$(DEBUG)" ]]; then \
        echo done; \
    fi
endef

bob:
    $(BOB_BODY)

bobit:
    @echo "before"
    $(BOB_BODY)
    @echo "after" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-05T20:49:09.797

您可以简单地更改 ifdef/define 的顺序：

```
ifdef DEBUG
  define BOB_BODY 
    @echo running
    @echo chug chug chug
    @echo done
  endef
else 
  define BOB_BODY 
    @echo chug chug chug
  endef
endif 
```

**更新**

```
define CHUG
  @echo chug chug chug
endef

ifdef DEBUG
  define BOB_BODY 
    @echo running
    $(CHUG)
    @echo done
  endef
else 
  define BOB_BODY 
    $(CHUG)
  endef
endif 
```

# java - NoClassDefFoundError 没有类名

> ID：228572
> 
> 赞同：3
> 
> 时间：2008-10-23T04:43:09.310
> 
> 标签：java

我不太确定这是否特定于 Sun Java Systems Application Server，但有时我会遇到 NoClassDefFoundError，其中错误中没有提到有问题的类，即未找到的类。

有谁知道什么条件会导致 NoClassDefFoundError 在没有指定未找到哪个类的情况下引发？

编辑：Java 1.4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T05:47:20.867

你在使用 Java 5 吗？

有一个关于您的问题的错误，并且已针对 Java 6 进行了更正。

[这是参考](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4649144)

# html - 普通文本内容的 HTML/CSS 设计

> ID：228574
> 
> 赞同：7
> 
> 时间：2008-10-23T04:46:14.140
> 
> 标签：html, css

我的任务是更新一系列网站，以促进迎合特定科学领域的科学会议。这些网站目前是为共享的公共页面模板结构使用一些适度的 CSS 布局编写的，但是每个页面的细节都是 <p>、<br> 和   的混搭。定位内容。这使得更新内容变得困难，因为间距总是在变化，并且页面最终会在最轻微的模式下变得丑陋。

所以，我想把这些东西改成更符合 CSS 的状态。有很多网站提供了针对特定 CSS 设计目标的提示，但我是一名开发人员，没有很多网站艺术能力，也没有考虑到结构。有没有什么好的网站可以在一些相对平凡但有效的商业内容的背景下教授 CSS？像 CSS zen garden 这样的东西很酷，但我正在寻找更多的东西，它们既能给我一些简单的文本密集型业务数据定位想法*，又能*将这些想法作为 CSS 学习机会来展示。

有没有这样的网站？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T19:11:15.240

遗憾的是，如果您对 HTML 没有太多控制，就很难从 CSS 中获得可靠、一致的表示。如果您无法向元素添加特殊的类/ID，则尤其如此。`<br/>`使用不一致的标签将对任何标准化布局的尝试造成严重破坏。

如果您只限于提供给您的 HTML，那么您的主要目标应该是使其尽可能具有可读性。确保字体足够大，以便人们可以靠在椅子上舒适地阅读。或者站在某人的肩膀上。它不需要太大，但如果它像您声称的那样文字很重，传统的 12pt 可能会觉得太小而无法大量阅读。

使用哪种字体是另一个考虑因素。Verdana 比 Arial 更宽，因此它占用更多的水平空间，但往往更容易在眼睛上。其他人倾向于喜欢像Georgia这样的衬线字体，它可以很好地适应更大的尺寸。

垂直间距很重要。确保在页面区域之间包含大量视觉中断。您可以通过明显且一致的副标题样式来实现这一点。还要确保`line-height`每行之间的宽度足够宽——人们不喜欢阅读“砖块”文本。

并且不要忘记水平空间。一般的经验法则是，一列文本可能每行不应超过 60-70 个字符，否则会变得更难阅读。

请记住，人们来到您的网站是为了获取信息，他们访问和获取信息的速度越快，他们就会越快乐。视觉效果很好，但您的首要任务应该始终是使网站尽可能易于使用和清晰易读。

至于灵感，我非常喜欢[Information Architects](http://informationarchitects.jp/)的文本设计。您可能还想看看[Subtraction.com](http://subtraction.com/)。博客可能是很好的灵感来源，因为它们通常包含大量文本。

祝你好运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T10:01:45.313

我会说[A List Apart](http://alistapart.com)是一个很好的起点。

您可以从非常广泛（且结构化）的主题中进行选择，然后点击您感兴趣的主题中的相关链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T04:51:43.350

[我也遇到过类似的情况，通过在http://www.openwebdesign.org/](http://www.openwebdesign.org/)下载和研究一些设计，我学到了很多东西。有大量的设计，论坛上到处都是愿意提供帮助的人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T04:52:09.667

[Eric Meyer](http://meyerweb.com/eric/css/)总是一个很好的 CSS 资源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-28T04:00:34.113

第一件事。使用简单和语义化的 XHTML。如果适用，将那些 s 抛弃`<br>`为`<p></p>`s。使用`<h1>,<h2>,<h3>`, 等等。如果您的页面看起来干净且可读而无需参考 CSS 文件，您就知道您走在正确的轨道上。David Shea 有一个很棒的标记指南。

[David Shea 的标记指南](http://www.mezzoblue.com/downloads/markupguide/#)

至于风格指南……我喜欢 Ben Hunt 从头开始​​的网页设计，尽管他不停地拉皮条他的电子书。内容很好。

[从零开始的网页设计：风格指南](http://webdesignfromscratch.com/web-2.0-design-style-guide.cfm)

[从零开始的网页设计：当前风格](http://www.webdesignfromscratch.com/current-style.cfm)

如果您正在寻找倾向于正确 CSS 的示例 ASP.net 站点，请查看 Microsoft 的免费模板。

[ASP.net 设计入门工具包](http://msdn.microsoft.com/en-us/asp.net/aa336613.aspx)

最后，这是一个真正的宝石，如果您需要样式表数据，Smashing Magazine 有货。这些表格设计不在图表之列。包括示例代码。实际上，您可以在 Smashing Mag 网站上花费数小时。这么多很棒的例子和免费的东西。

[Smashing Magazine：十大 CSS 表格设计](http://www.smashingmagazine.com/2008/08/13/top-10-css-table-designs/)

[Smashing Magazine：所有 CSS 文章](http://www.smashingmagazine.com/category/css/)

和平|露水

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T19:55:43.313

[CSS 框架之战](http://capsizedesigns.com/blog/2008/04/battle-of-the-css-frameworks/)是另一个很好的入门资源。您可以通过采用一个好的、简化的框架来缩短您的 CSS 开发时间。

# security - 这种身份验证模型的安全性如何？

> ID：228577
> 
> 赞同：4
> 
> 时间：2008-10-23T04:48:03.887
> 
> 标签：security, review

我有一个用户帐户“会员中心”，它显示了客户在我公司的所有订阅和会员资格。这是在[https://secure.example1.com/membercenter/](https://secure.example1.com/membercenter/)。

我有另一个网站，它是实际的会员网站。这是在[http://www.example2.com/](http://www.example2.com/)。（每个站点在不同的域上，尽管它是同一个专用服务器。

我想提供对会员网站的轻松登录，而不在链接中包含用户的用户名和密码。

所以我想出的是：

当用户单击其成员资格的“登录”链接时，我创建了他们的用户 ID + unix 时间戳的 md5 哈希，并将其与他们的用户 ID 和时间戳一起添加到数据库表中。

然后我重定向到[http://www.example2.com/login?hash=](http://www.example2.com/login?hash=(the) （哈希）。

example2 上的登录脚本获取哈希并在同一个表中查找它。如果散列存在，我会使用与散列一起存储的用户 ID 从客户数据库中检索他们的用户名和密码，并将其传递给站点预先存在的登录函数，然后他们就可以登录了。

当这个哈希登录脚本运行时，它首先删除任何超过 5 分钟的行，然后检查传递的哈希值。如果找到散列，则将用户登录，然后从表中删除使用的散列。这意味着表中永远不会有任何哈希值超过 5 分钟。唯一会（应该）在表中留下任何哈希值的情况是，如果用户在单击链接后以某种方式无法将其从 secure.example1.com 变为 www.example2.com（例如，互联网在右侧出现故障）第二，DNS 问题解决 example2.com 等）。5 分钟到期意味着他们可以坐在那里重新加载重定向的 URL，直到他们进入，或者直到 5 分钟过去。

当用户被重定向时，他们确实看到了哈希值。

每次从 secure.example2.com 中单击登录链接时，都会计算并存储一个新的哈希值。

我的问题是......我错过了一些明显的东西吗？你将如何破解或破解它？我是否只是在我的站点中创建了一个巨大的安全漏洞？

非常感谢蜂巢思维！

编辑：这是对进入 www.example2.com 并使用您的用户名/密码使用表单登录的正常模式的补充。

EDIT2：对 tobyhede 的回应：嗅探哈希。攻击者还必须阻止用户访问 www.example2.com 上的登录脚本，因为哈希一旦使用就会被删除。如果他们能够阻止这种情况，他们还必须在五分钟内使用哈希，否则它将被自动删除。

EDIT3：回复：攻击者生成自己的哈希：黑客必须将这些哈希插入数据库并包含有效的用户 ID（没有用户知道他们的用户 ID）。他们会怎么做？由于哈希只使用一次，然后立即删除，我不相信以下任何攻击都会起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T05:22:05.660

有人需要做的就是拦截带有哈希的 URL，他们就可以访问您的系统。您确实应该使用 HTTP POST 通过 SSL 传递哈希。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T10:04:01.503

虽然你不能让这种方案完全无懈可击，但有很多事情可以改进它：

*   生成密钥时使用随机种子而不是 unix 时间戳
*   检查第二页请求中的referer是否是第一页
*   检查两个请求的来源是否相同

加密知识证明方案可能适用于这种情况，以最安全的方式解决问题。今天早上开会后，我的大脑有点太糊涂了，但无法说出它们的适用性：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:12:35.013

您在哈希中使用的 id 和用户用于登录站点的用户 id 是否不同？在通过生成哈希来攻击您的系统时，这是至关重要的部分。要考虑的另一件事是，您使用的 ID 是否易于猜测，例如数字或单词？

你必须想出一个解决方案，其中包含攻击者不容易猜到的东西。基本上你想在你的散列中有一个秘密，攻击者几乎不可能猜到。这就是为什么在你的哈希中使用盐（随机位）是要走的路。

我想您知道针对[MD5](http://en.wikipedia.org/wiki/MD5)和[SHA-1](http://en.wikipedia.org/wiki/SHA-1)哈希的攻击吗？在 MD5 中，实际上存在哈希冲突的可能性（[http://merlot.usc.edu/csac-s06/papers/Wang05a.pdf](http://merlot.usc.edu/csac-s06/papers/Wang05a.pdf)），因为 SHA-1 被认为仍然是安全的，但也存在针对两者的[彩虹表攻击](http://en.wikipedia.org/wiki/Rainbow_table)哈希。

使用盐、用户 ID 和时间戳生成哈希听起来对您的解决方案是可行的。我还建议您在使用后删除哈希。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T09:23:40.523

如果攻击者知道用户即将登录，则攻击者可以生成哈希（或一系列时间戳略有不同的哈希）并在用户登录之前登录。更好的解决方案是用随机生成的令牌替换散列。然后攻击者将不得不拦截用户对站点 example2 的登录请求。

只要您在站点 example2 上使用 HTTP 而不是 HTTPS，任何方案都不会是安全的。例如，假设您为站点 example2 找到了安全的完美登录方案。但是，在登录之后，来自用户的请求将在 URL 或请求标头（例如 cookie）中发送会话信息。这些请求可以被拦截，攻击者可以窃取会话信息。在攻击者最坏的情况下，您会将会话链接到他们的源 IP，并且攻击者需要伪造源 IP。

# logging - 如何在实用程序类中获取辅助方法以在 log4net 中使用其调用者记录器？

> ID：228578
> 
> 赞同：2
> 
> 时间：2008-10-23T04:48:10.190
> 
> 标签：logging, log4net

我有一个可执行文件，取决于提供的命令行开关，它看起来像：

**程序.cs -**

```
namespace DiskSpaceReporting
{
    class Program
    {
        static void Main(string[] args)
        {
            if(args.Length == 1)
            {
                switch(args[0])
                {
                    case "-summarytotals":
                        SummaryDiskSpaceReporter.Run();
                        break;

                    case "-detailed":
                        DetailedDiskSpaceReporter.Run();
                        break;
                    //...other reporting types
                }

            }
        }
    }
} 
```

**摘要DiskSpaceReporter.cs**

```
namespace DiskSpaceReporting
{
    public class SummaryDiskSpaceReporter
    {
        private static IEventIDLog log = EventIDLogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);

        public static void Run()
        {
            log.Info(1234, "Starting");
            //...do work
            string message = Helpers.CreateMessage(messageID);
            //...do work
        }
    }
} 
```

**详细的DiskSpaceReporter.cs**

```
namespace DiskSpaceReporting
{
    public class DetailedDiskSpaceReporter
    {
        private static IEventIDLog log = EventIDLogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);

        public static void Run()
        {
            log.Info(1234, "Starting");
            //...do work
            string message = Helpers.CreateMessage(messageID);
            //...do work
        }
    }
} 
```

**助手.cs**

```
namespace DiskSpaceReporting
{
    public class Helpers
    {
        private static IEventIDLog log = ???            
        public static string CreateMessage(Guid messageID)
        {
            log.Info(9876, "Starting");
            //...do work
        }
    }
} 
```

在我的 log4net 配置中，我有两个单独的记录器，每个记录器用于 SummaryDiskSpaceReporter 和DetailedDiskSpaceReporter，因为它们的记录要求不同：

```
<root>
    <level value="ALL" />
    <appender-ref ref="ConsoleLogAppender" />
    <appender-ref ref="EventLogAppender" />
</root>

<logger name="DiskSpaceReporting.SummaryDiskSpaceReporter">
    <appender-ref ref="SummaryDiskSpaceReporterRollingFileAppender"/>
</logger>

<logger name="DiskSpaceReporting.DetailedDiskSpaceReporter">
    <appender-ref ref="DetailedDiskSpaceReporterRollingFileAppender"/>
</logger> 
```

SummaryDiskSpaceReporter 和DetailedDiskSpaceReporter 都调用Helpers 类中的帮助器方法。我想将一些日志记录到辅助类方法中。

所以...问题是，如何让 Helpers.CreateMessage() 方法使用与其调用者相同的记录器？

IE

> SummaryDiskSpaceReporter.Run() -> 使用 DiskSpaceReporting.SummaryDiskSpaceReporter 记录器DetailedDiskSpaceReporter.Run() -> 使用 DiskSpaceReporting.DetailedDiskSpaceReporter 记录器。

干杯凯夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T06:41:43.253

我一直在玩这个问题很长一段时间，不幸的是不得不放弃一段时间并重新开始做“真正的”工作。目前我想出的内容如下：

**选项 1：**传入记录器

这不是一个很好的选项，但如果您不介意将助手耦合到记录器，应该可以正常工作。只需允许您的 CreateMessage 方法获取 IEventIDLog。然后，您可以使用它来记录到正确传入的记录器。

```
public static string CreateMessage(Guid messageID, IEventIDLog log)
{
    log.Info(9876, "Starting");
    //...do work
} 
```

不完全闪亮，但它应该工作！

**选项2：**使用调用堆栈

利用调用堆栈查找调用代码并从中找到类型并从该类型中获取所需的记录器

```
public static string CreateMessage(Guid messageID)
{
    StackFrame frame = new StackTrace().GetFrame(1);
    IEventIDLog log = EventIDLogManager.GetLogger(frame.GetMethod().DeclaringType);
    log.Info(9876, "Starting");
    //...do work
} 
```

仍然没有光泽，因为我们需要接触调用堆栈以及如果调用代码没有记录器会发生什么。

**选项 3：**使用 log4net

这是我们想要使用的选项，这就是问题想要的答案，*但我还没有**解决***。:) 通过 log4net，我们发现了一些很酷的东西，比如允许我们获取根记录器的 Hierarchy 类。

```
Logger logger1 = ((log4net.Repository.Hierarchy.Hierarchy) log4net.LogManager.GetRepository()).Root; 
```

所以我确信有一种方法可以让记录器从 CreateMessage 方法上一层楼，现在只是为了找到它。:)

# winapi - 连接到 Windows 文件副本

> ID：228585
> 
> 赞同：8
> 
> 时间：2008-10-23T04:51:58.077
> 
> 标签：winapi, api, hook

我想编写我自己的文件复制程序，当用户在 Windows 资源管理器中选择“**粘贴**”/（`Ctrl`+ ）时该程序将运行。**CopyHandler**和**SuperCopier**`V`等一些程序正在这样做。但我不知道怎么做。

 ****请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T22:43:25.333

[Ultracopier](http://ultracopier.first-world.info/)和[Supercopier](http://ultracopier.first-world.info/supercopier.html)使用的项目[catchcopy](http://catchcopy.first-world.info/)提供了所有的抽象。您只需要监听命名管道即可从资源管理器接收要执行的复制/移动操作。一切都在 wiki 中有详细说明。

# php - 将数据库连接/对象放入 PHP 中的函数的最佳方法是什么？

> ID：228590
> 
> 赞同：4
> 
> 时间：2008-10-23T04:53:48.353
> 
> 标签：php, database

几个选项是：

```
$connection = {my db connection/object};

function PassedIn($connection) { ... }

function PassedByReference(&$connection) { ... }

function UsingGlobal() {
    global $connection;
    ...
} 
```

所以，传入，通过引用传递，或者使用全局。我正在考虑仅在只有 1 个数据库连接的 1 个项目中使用的功能。如果有多个连接，肯定是传入或引用传递。

当您在 PHP5 中使用对象时，我认为不需要通过引用传递，因此传入或使用全局是两种可能性。

我问的原因是因为我厌倦了总是将 $connection 放入我的函数参数中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T06:23:07.737

我使用 Singleton ResourceManager 类通过整个应用程序处理数据库连接和配置设置等内容：

```
class ResourceManager {
    private static $DB;
    private static $Config;

    public static function get($resource, $options = false) {
        if (property_exists('ResourceManager', $resource)) {
            if (empty(self::$$resource)) {
                self::_init_resource($resource, $options);
            }
            if (!empty(self::$$resource)) {
                return self::$$resource;
            }
        }
        return null;
    }

    private static function _init_resource($resource, $options = null) {
        if ($resource == 'DB') {
            $dsn = 'mysql:host=localhost';
            $username = 'my_username';
            $password = 'p4ssw0rd';
            try {
                self::$DB = new PDO($dsn, $username, $password);
            } catch (PDOException $e) {
                echo 'Connection failed: ' . $e->getMessage();
            }
        } elseif (class_exists($resource) && property_exists('ResourceManager', $resource)) {
            self::$$resource = new $resource($options);
        }
    }
} 
```

然后在函数/对象/任何地方：

```
function doDBThingy() {
    $db = ResourceManager::get('DB');
    if ($db) {
        $stmt = $db->prepare('SELECT * FROM `table`');
        etc...
    }
} 
```

我用它来存储消息、错误消息和警告，以及全局变量。[这里](https://stackoverflow.com/questions/228164/on-design-patterns-when-to-use-the-singleton)有一个有趣的问题，关于何时实际使用这种类型的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T05:45:55.893

尝试以面向对象的方式设计您的代码。使用数据库的方法应该分组在一个类中，并且类实例应该包含数据库连接作为类变量。这样，数据库连接可用于需要它的功能，但它不是全局的。

```
class MyClass {
  protected $_db;

  public function __construct($db)
  {
    $this->_db = $db;
  }

  public function doSomething()
  {
    $this->_db->query(...);
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T11:27:54.377

我看到很多人建议使用某种静态变量。

本质上，全局变量和静态变量之间几乎没有区别。除了语法之外，它们具有完全相同的特征。因此，通过将全局变量替换为静态变量，您将一无所获。在大多数示例中，存在一定程度的解耦，因为静态变量不是直接引用，而是通过静态方法（例如，单例或静态注册表）。虽然稍微好一点，但这仍然存在全局范围的问题。如果您需要在应用程序中使用多个数据库连接，那您就完蛋了。如果您想知道代码的哪些部分有副作用，则需要手动检查实现。这不会影响您的应用程序的成败，但会使维护变得更加困难。

我建议您选择以下之一：

*   将实例作为参数传递给需要它的函数。这是迄今为止最简单的，它具有范围狭窄的所有优点，但它可能会变得相当笨拙。它也是引入依赖项的来源，因为您的代码的某些部分最终可能会成为中间人。如果发生这种情况，请继续..

*   将实例放在对象的范围内，该对象具有需要它的方法。例如。如果该方法`Foo->doStuff()`需要数据库连接，请将其传递给`Foo`的构造函数并将其设置为 on 上的受保护实例变量`Foo`。您仍然可能会遇到一些传递方法的问题，但是对于笨拙的构造函数来说，与方法相比，这通常不是问题。如果您的应用程序变得足够大，您可以使用依赖注入容器来自动执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T05:41:31.347

我的建议是避免在大部分代码中使用全局代码——这很危险、难以跟踪并且会咬你一口。

我这样做的方法是拥有一个名为 getDB() 的函数，它可以通过构造函数注入在类级别或在公共类中使用静态。

所以代码变成了

```
class SomeClass {
    protected $dbc;

    public function __construct($db) {
        $this->dbc = $db;
    }

    public function getDB() {
        return $this->dbc;
    }

    function read_something() {
        $db = getDB();
        $db->query();
    }
} 
```

或使用公共共享类。

```
function read_something() {
    $db = System::getDB();
    $db->query();
} 
```

不管你做了多么优雅的系统设计，总有一些项目在范围内是必然的（例如 DB、Session、Config），我更喜欢将这些作为静态方法保留在我的*System*类中。

让每个类都需要通过构造函数进行连接是最好的方法，最好的意思是最可靠和孤立的。

但是请注意，使用公共共享类来执行此操作会影响使用它完全隔离对象的能力以及对这些对象执行单元测试的能力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T04:57:51.933

以上都不是。

所有`mysql`函数都可以选择使用数据库连接*参数*。如果您不考虑该参数，则假定 mysql_connect() 的最后一个连接。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-23T05:46:58.743

```
function usingFunc() {
  $connection = getConnection();
  ...
}

function getConnection() {
  static $connectionObject = null;
  if ($connectionObject == null) {
    $connectionObject = connectFoo("whatever","connection","method","you","choose");
  }
  return $connectionObject;
} 
```

这样，静态 $connectionObject 在 getConnection 调用之间被保留。

# entity-framework - 在 ADO.Net 数据服务中，如何检查实体是否已在上下文中？

> ID：228595
> 
> 赞同：3
> 
> 时间：2008-10-23T04:57:42.620
> 
> 标签：entity-framework, wcf-data-services

我有一个用于导入数据的 ADO.Net 数据服务。大多数实体都链接到许多实体。要在导入期间执行此操作，我首先创建这些实体，保存它们，然后使用 .SetLink(EntityImport, "NavigationProperty", CreatedEntity)。现在我遇到的第一个问题是上下文并不总是知道 CreatedEntity（这是由于每个实体都是独立导入的，并且在创建每个项目时都会创建一个上下文 - 我想保留这个功能- 即我试图避免“只使用一个上下文”作为答案）。

因此，在尝试调用 SetLink 之前，我有一个 .AddToCreatedEntityType(CreatedEntity)。这当然是第一次工作，但在第二次通过时，我收到错误消息“上下文已经在跟踪实体”。

有没有办法检查上下文是否已经在跟踪实体（context.Contains(CreatedEntity) 尚未实现）？我正在考虑尝试尝试捕获并避免错误，但这似乎每次通过都会创建一个新的 CreatedEntity 。看起来我每次都需要使用 LINQ to Data Services 来获取 CreatedEntity ，但这似乎效率低下 - 有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T07:09:44.240

I think you should look at the [EntityState](http://msdn.microsoft.com/en-us/library/system.data.entitystate.aspx) property of your entity.

Only if it is of the value EntityState.Detached than you have to add it to your context.

Do not forget the following remark:

> This enumeration has a FlagsAttribute attribute that allows a bitwise combination of its member values.

I would create a extension method:

```
public static class EntityObjectExtensions
{
    public static Boolean IsTracked(this EntityObject self)
    {
        return (self.EntityState & EntityState.Detached) != EntityState.Detached;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T05:19:11.543

在尝试检查上下文是否正在跟踪我想要更新（或添加）的实体时，当我发现 context.Entites.Contains(currentItem) 不起作用时，我感到非常失望。

我使用以下方法解决了它：

```
if (context.Entities.Where(entities => entities.Entity == currentItem).Any())
{
   this.service.UpdateObject(currentItem);                    
} 
```

# javascript - 在 JavaScript 中将 XML-RPC 转换为 JSON

> ID：228598
> 
> 赞同：4
> 
> 时间：2008-10-23T05:00:42.287
> 
> 标签：javascript, json, parsing, xml-rpc

谁能推荐一个轻量级的 JavaScript XML-RPC 库？

不久前研究了这个之后，我找不到任何我喜欢的东西，所以我最终还是写了自己的。但是，也许这很愚蠢，因为那里一定有合适的东西！？

我自己的伪库主要缺少将 XML-RPC 响应转换为 JSON 的方法——或者更确切地说，将相应的 responseXML 转换为 JavaScript 对象（根据需要转换[数据类型](http://en.wikipedia.org/wiki/XML-RPC#Data_types)）。这并不难做到，但为什么要重新发明轮子......

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T05:29:43.523

我知道这两个库，您基本上可以使用它们将 XML-RPC 响应转换为 JSON：

*   [XML 到 JSON 转换器](http://www.thomasfrank.se/xml_to_json.html)
*   [xml2json.js](http://goessner.net/download/prj/jsonxml/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-03T14:29:33.143

这似乎可以满足您（和我）的要求：

*   [http://kuriositaet.de/javascript/jsxmlrpc.html](http://kuriositaet.de/javascript/jsxmlrpc.html)
*   [http://kuriositaet.de/javascript/xmlrpc.html](http://kuriositaet.de/javascript/xmlrpc.html)
*   [http://sourceforge.net/projects/jsxmlrpc/](http://sourceforge.net/projects/jsxmlrpc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-01T13:30:18.483

另一个小的 XML 到 JSON（反之亦然）JavaScript 库在这里 -> [http://code.google.com/p/x2js/](http://code.google.com/p/x2js/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-02-25T14:24:47.727

我也可以用这个。Generic XML to Json 对于 XML-RPC 来说相当不方便。

# html - 您能否提出一种更优雅的方式来“标记”用于 html 格式的 c# 代码？

> ID：228605
> 
> 赞同：3
> 
> 时间：2008-10-23T05:12:41.280
> 
> 标签：html, regex, f#, formatting

*（[这个](https://stackoverflow.com/questions/174418/can-you-improve-this-lines-of-code-algorithm-in-f)关于重构 F# 代码的问题让我投了反对票，但也有一些有趣且有用的答案。在 SO 上的 32,000 多个问题中，有 62 个 F# 问题似乎很可怜，所以我要冒更多不赞成的风险！）*

昨天我试图在博客上发布一些代码，然后转向[这个网站](http://manoli.net/csharpformat/)，我过去发现它很有用。然而，博主编辑吃掉了所有的风格声明，结果证明这是一条死胡同。

所以（就像任何黑客一样），我想“这有多难？” 并在 <100 行的 F# 中滚动了我自己的。

这是代码的“肉”，它将输入字符串转换为“令牌”列表。请注意，不要将这些标记与 lexing/parsing-style 标记混淆。我确实简要地看了这些，虽然我几乎什么都不懂，但我确实明白它们只会给我*标记*，而我想保留我的原始字符串。

问题是：有没有更优雅的方式来做到这一点？我不喜欢从输入字符串中删除每个标记字符串所需的 s 的 n 重新定义，但是由于注释、字符串和 #region 指令（其中包含非单词字符）。

```
//Types of tokens we are going to detect
type Token = 
    | Whitespace of string
    | Comment of string
    | Strng of string
    | Keyword of string
    | Text of string
    | EOF

//turn a string into a list of recognised tokens
let tokenize (s:String) = 
    //this is the 'parser' - should we look at compiling the regexs in advance?
    let nexttoken (st:String) = 
        match st with
        | st when Regex.IsMatch(st, "^\s+") -> Whitespace(Regex.Match(st, "^\s+").Value)
        | st when Regex.IsMatch(st, "^//.*?\r?\n") -> Comment(Regex.Match(st, "^//.*?\r?\n").Value) //this is double slash-style comments
        | st when Regex.IsMatch(st, "^/\*(.|[\r?\n])*?\*/") -> Comment(Regex.Match(st, "^/\*(.|[\r?\n])*?\*/").Value) // /* */ style comments http://ostermiller.org/findcomment.html
        | st when Regex.IsMatch(st, @"^""([^""\\]|\\.|"""")*""") -> Strng(Regex.Match(st, @"^""([^""\\]|\\.|"""")*""").Value) // unescaped = "([^"\\]|\\.|"")*" http://wordaligned.org/articles/string-literals-and-regular-expressions
        | st when Regex.IsMatch(st, "^#(end)?region") -> Keyword(Regex.Match(st, "^#(end)?region").Value)
        | st when st <> "" -> 
                match Regex.Match(st, @"^[^""\s]*").Value with //all text until next whitespace or quote (this may be wrong)
                | x when iskeyword x -> Keyword(x)  //iskeyword uses Microsoft.CSharp.CSharpCodeProvider.IsValidIdentifier - a bit fragile...
                | x -> Text(x)
        | _ -> EOF

    //tail-recursive use of next token to transform string into token list
    let tokeneater s = 
        let rec loop s acc = 
            let t = nexttoken s
            match t with
            | EOF -> List.rev acc //return accumulator (have to reverse it because built backwards with tail recursion)
            | Whitespace(x) | Comment(x) 
            | Keyword(x) | Text(x) | Strng(x) -> 
                loop (s.Remove(0, x.Length)) (t::acc)  //tail recursive
        loop s []

    tokeneater s 
```

（如果有人真的感兴趣，我很乐意发布其余的代码）

**编辑** 使用kvb对[活动模式的](http://blogs.msdn.com/chrsmith/archive/2008/02/21/Introduction-to-F_2300_-Active-Patterns.aspx)[出色建议](https://stackoverflow.com/questions/228605/can-you-propose-a-more-elegant-way-to-tokenize-c-code-for-html-formatting/228609#228609)，中心位看起来像这样，好多了！

```
let nexttoken (st:String) = 
    match st with
    | Matches "^\s+" s -> Whitespace(s)
    | Matches "^//.*?\r?(\n|$)" s -> Comment(s) //this is double slash-style comments
    | Matches "^/\*(.|[\r?\n])*?\*/" s -> Comment(s)  // /* */ style comments http://ostermiller.org/findcomment.html
    | Matches @"^@?""([^""\\]|\\.|"""")*""" s -> Strng(s) // unescaped regexp = ^@?"([^"\\]|\\.|"")*" http://wordaligned.org/articles/string-literals-and-regular-expressions
    | Matches "^#(end)?region" s -> Keyword(s) 
    | Matches @"^[^""\s]+" s ->   //all text until next whitespace or quote (this may be wrong)
            match s with
            | IsKeyword x -> Keyword(s)
            | _ -> Text(s)
    | _ -> EOF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:28:13.080

我会使用活动模式来封装 Regex.IsMatch 和 Regex.Match 对，如下所示：

```
let (|Matches|_|) re s =
  let m = Regex(re).Match(s)
  if m.Success then
    Some(Matches (m.Value))
  else
    None 
```

然后您的 nexttoken 函数可能如下所示：

```
let nexttoken (st:String) =         
  match st with        
  | Matches "^s+" s -> Whitespace(s)        
  | Matches "^//.*?\r?\n" s -> Comment(s)
  ... 
```

# jsp - JSP 自定义标记库与 JSP2 标记文件

> ID：228607
> 
> 赞同：7
> 
> 时间：2008-10-23T05:17:26.713
> 
> 标签：jsp, jsp-tags

任何人都可以解释 JSP 自定义标签库和 JSP 2 标签文件背后的想法吗？

它们只是做同一件事的不同方法吗？

他们如何比较？它们的优点和缺点是什么，哪个更好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-13T19:32:00.350

我 <3 标记文件，但如果他们真的这么说，JSTL 的主要开发人员正在吸烟。您不能将所有标签库标签重写为标签文件标签，原因有一个非常重要的：标签文件不能：

返回 EVAL_BODY_INCLUDE；

换句话说，标签文件的正文内容只有三个选项：

**空：**没有内部内容，即。<someTag/>

**无脚本：**没有 JSP 内部内容，即。<someTag><p>hello world</p></someTag> 可以，但 <someTag><p><%= helloWorld.toString() %></p></someTag> 不行

**tagdependent：**你可以拥有 JSP 内部内容，但它不会被这样处理；相反，您必须解析/渲染它，但是您认为合适

但是使用旧式标签库标签，您可以拥有：<body-content>JSP</body-content>（在 tld 文件中）然后“return EVAL_BODY_INCLUDE;” 从你的“doStartTag”。如果您这样做，您的所有 JSP 指令都将被解析，就好像它们是您页面的正常部分一样，并且您的标签只是用适当的内容包装它们。

就个人而言，我的经验法则是：尽可能使用标签文件，即。每当您不需要 JSP 指令在标签内工作时，因为它们干净一百万倍，非程序员更容易使用，不需要 tld（好吧，如果您将它们保存在单独的命名空间中您的标签库标签）。

但是，如果您希望标签中包含 JSP 内容，您唯一的选择是标签库标签。希望有一天，JSP 人会发布一种在标签文件标签内做 JSP 指令处理的方法，然后我们真的可以放弃旧的基于类的标签，但在此之前请不要尝试用标签文件做所有标签，因为您很快就会被简化为为每条逻辑创建自定义标记（因为这是在不使用 JSP 指令的情况下执行逻辑的唯一方法）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T06:36:30.353

**开发自定义标签的问题**

传统的自定义标签需要 Java 编程技能。

除了最简单的自定义标签之外，所有的标签都不容易编写。

与 servlet 相比，JSP 的目的是使用标记语言来管理嵌入动态内容的布局。

必须在专注于标记语言的自定义标签中编写复杂的 Java 代码正在倒退。

在实现新的自定义标记时，我们可能希望使用 JSP 表达式语言或其他自定义标记。

**解决方案** **JSP 2.0 标记文件**

*   标记文件是 JSP 2.0 引入的重要新概念之一。
*   标签文件允许更容易和更快速地开发自定义标签。
*   标记文件是使用普通 JSP 语法（包括脚本元素）开发的，并且与任何其他自定义标记一样使用。
*   每个自定义标签都是一个单独的标签文件。

**标签文件有何不同？**

使用 JSP 语法编写。

*   并非所有 JSP 指令都允许在标记文件中使用。
*   由新的标记文件特定指令、动作和隐式对象支持。

由**.tag**或**.tagx**后缀标识。

旨在为自定义标签开发人员提供方便的开发，而不会丢失功能。

*   JSTL 的一位主要开发人员评论说，如果她有时间，她会使用标记文件重写所有 JSTL。

# java - 如何编写一个返回“this”的类型化实例并在扩展时工作的 Java 函数？

> ID：228614
> 
> 赞同：2
> 
> 时间：2008-10-23T05:21:49.450
> 
> 标签：java, generics

这是一个有点懒惰的问题，但你得到了代表:-)

我有一个 Java 类，它返回自身的实例以允许链接（例如 ClassObject.doStuff().doStuff()）

例如：

```
public class Chainer
{
    public Chainer doStuff()
    {
       /* Do stuff ... */
       return this;
    }
} 
```

我想扩展这个类。有没有办法，也许使用泛型，来扩展这个类而不必覆盖每个方法签名？

例如不是：

```
public class ChainerExtender extends Chainer
{
    public ChainerExtender doStuff()
    {
       super.doStuff();
       return this;
    }
} 
```

我试过了：

```
public class Chainer
{
    public <A extends Chainer> A doStuff()
    {
       /* Do stuff ... */
       return (A)this;
    }
}

public class ChainerExtender extends Chainer
{
    public <A extends Chainer> A doStuff()
    {
       /* Do stuff ... */
       return super.doStuff();
    }
} 
```

但这并没有给出错误：

```
type parameters of <A>A cannot be determined; 
no unique maximal instance exists for type variable A with upper bounds A,Chainer 
```

我是否被迫进行类声明，例如：

```
public class Chainer<T extends Chainer<T>> {}
public class ChainerExtender extends Chainer<ChainerExtender> 
```

根据[这个问题](https://stackoverflow.com/questions/153994/generic-type-args-which-specificy-the-extending-class)？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-02T09:17:45.980

你试过直截了当

```
public class Chainer
{
    public Chainer doStuff()
    {
       /* Do stuff ... */
       return this;
    }
}

public class ChainerExtender extends Chainer
{
    @Override
    public ChainerExtender doStuff()
    {
       /* Do stuff ... */
       super.doStuff();
       return this;
    }
} 
```

在 Java 5 中，您可以将覆盖方法声明为具有协变返回类型，这就是说的意思：子类可以具有具有更具体返回类型的覆盖方法签名。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-23T05:44:50.183

为什么不让它们都返回一个接口？您必须在接口中定义所有可能的链接方法并在基类中提供“null”实现，但您可以链接到您心中的内容。

```
public interface IChainer
{
  IChainer doStuff();
  IChainer doSomethingElse();
}

public class Chainer implements IChainer
{
  public IChainer doStuff()
  {
     // really do something
     return this;
  }

  public IChainer doSomethingElse()
  {
      return this; // do nothing
  }
}

public class ChainerExtender extends Chainer
{
   // simply inherits implementation for doStuff()

   public override IChainer doSomethingElse()
   {
       // really do something
       return this;
   }
} 
```

注意：我上面可能有一些语法问题。在过去的几年里，我主要使用 C# 进行编程。希望你明白这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T14:20:04.963

我让它以这种方式工作。它使用类文字来指示在运行时要转换为哪种类型（请参阅[Gilad Bracha 的泛型教程的](http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)第 8 节）。

```
公共类链接器{
  public <T extends Chainer> T doStuff (Class<T> foo) {
    /* 做东西 */
    返回 foo.cast (this);
  }
}

公共类 ChainerExtender 扩展 Chainer {
  公共 <T 扩展 ChainerExtender> doOtherStuff (Class<T> foo) {
    /* 做其他事情 */
    返回 foo.cast (this);
  }
}

```

所以调用看起来像这样：

```
链纳 c1 = 新链纳（）；
c1 = c1.doStuff (c1.getClass());
// ...
ChainerExtender ce1 = new ChainerExtender();
ce1 = ce1.doStuff (ce1.getClass()).doOtherStuff (ce1.getClass());

```

这种技术的一个缺点是，如果你有一个引用，你必须在调用它之前`Chainer`明确地检查它是否真的是一个对象。不过，这是有道理的，因为尝试在运行时调用对象上的方法会产生错误。`ChainerExtender``doOtherStuff``Chainer`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T05:31:03.613

您能否发布一个导致您看到的错误消息的完整示例？

我刚刚编译并顺利执行了以下内容：

```
public class Test {

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        ChainerExtender c = new ChainerExtender();
        c.doStuff().doStuff();
    }

    public static class Chainer
    {
        public <A extends Chainer> A doStuff()
        {
           /* Do stuff ... */
            System.out.println("Chainer");
           return (A)this;
        }
    }

    public static  class ChainerExtender extends Chainer
    {
        /** 
         * @see test.Test.Chainer#doStuff()
         */
        @Override
        public <A extends Chainer> A doStuff()
        {
            System.out.println("ChainerExtender");
           return super.doStuff();
        }
    }

} 
```

给出：

```
ChainerExtender
Chainer
ChainerExtender
Chainer 
```

我误解了这个问题，请投反对票并发表评论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T07:38:30.283

我认为简单的答案是“不，你不能”。我可以看到这可能很有用，但我觉得这种继承的使用对我来说是“意想不到的后果”。有人决定在子类中添加一些额外的功能只是时间问题，而不是仅仅做一个`super.doStuff()`，并且控制流将非常难以遵循。

一种可能的解决方案是让您的链接器（如果他们使用**构建器**模式）返回不同构建器类的新实例，而不是`this`. 看看 Stephen Colebourne 用[JSR 310](http://www.threeten.org/)中的日期创建构建器做了什么，从 API 的角度来看，这非常聪明，虽然写起来很笨拙。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T13:38:14.877

自从我完成任何 Java 泛型以来已经有一段时间了。

关于什么 ：

```
<T>
公共类Chainer
{
    公共 T doStuf()
   {
   }

}

公共类 ChainerDerived : 扩展 Chainer<ChainerDerived>
{
   public ChainerDerived doStuf()
   {
   }
}

```

我最近大部分时间都在做 C++，这种东西只是课程的标准。Java 泛型是否支持这种类型的结构？

我希望我理解你的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-10T20:20:15.610

请注意，“super.<A>doStuff()”将编译*并*工作。它提示有关您期望的类型的泛型。

# c++ - 如何使用 C++ 在 Windows 和 Linux 中清除控制台

> ID：228617
> 
> 赞同：28
> 
> 时间：2008-10-23T05:23:04.270
> 
> 标签：c++, windows, linux, console, cross-platform

我需要一个跨平台解决方案来清除用 C++ 编写的 Linux 和 Windows 中的控制台。这样做有什么功能吗？另请注意，我不希望最终用户程序员必须更改我程序中的任何代码以使其适用于 Windows 和 Linux（例如，如果它必须在两个函数之间进行选择，则必须做出决定在运行时或编译时自主）。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-23T05:29:42.413

[在两个平台上都没有清除控制台的](http://www.daniweb.com/software-development/cpp/threads/95284/clearing-screen-in-the-console)通用命令。

```
#include <cstdlib>

void clear_screen()
{
#ifdef WINDOWS
    std::system("cls");
#else
    // Assume POSIX
    std::system ("clear");
#endif
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-23T05:28:02.793

简短的回答：你不能。

更长的答案：使用 curses 库（Unix 上的 ncurses， Windows 上的[pdcurses](http://pdcurses.sf.net/)）。NCurses 应该可以通过您的包管理器获得，并且 ncurses 和 pdcurses 具有完全相同的界面（pdcurses 也可以独立于控制台创建窗口，其行为类似于控制台窗口）。

最困难的答案：使用`#ifdef _WIN32`和类似的东西让你的代码在不同的操作系统上表现不同。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-04T22:04:33.653

在 linux 上可以清除控制台。最好的方法是将以下转义序列写入标准输出：

```
write(1,"\E[H\E[2J",7); 
```

这就是*/usr/bin/clear*所做的，没有创建另一个进程的开销。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-03-18T16:17:38.270

一个简单的技巧：为什么不通过使用宏结合使用 system() 命令来清除控制台来检查操作系统类型？这样，您将使用适当的控制台命令作为参数来执行系统命令。

```
#ifdef _WIN32
#define CLEAR "cls"
#else //In any other OS
#define CLEAR "clear"
#endif

//And in the point you want to clear the screen:
//....
system(CLEAR);
//.... 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-11-30T05:39:49.260

**简短的回答**

```
void cls(void)
{
    system("cls||clear");
    return;
} 
```

**长答案**，请阅读：

[系统（“暂停”）说明](https://stackoverflow.com/questions/15039322/systempause-clarification/33991895#33991895)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-02-22T14:42:13.190

张贴的问题无法回答，因为它施加了不可能的限制。“清除屏幕”是跨不同操作系统的一项非常不同的操作，具体操作方式**因**操作系统而异。有关如何在带有“控制台”的几个流行平台和带有“终端”的平台上执行此操作的完整说明，请参阅[此经常给出的答案。](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/clearing-the-tui-screen.html "FGA：如何在 TUI 程序中清除屏幕。")您还会[在同一个地方](http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/clearing-the-tui-screen.html "FGA：如何在 TUI 程序中清除屏幕。")找到一些要避免的常见错误的解释，其中有几个是——唉！- 上面给出的答案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-23T05:29:12.027

这是您在任何其他平台上执行此操作的方式，但它在 Windows 中不起作用：

```
cout << "\f"; 
```

也许您需要进行条件编译：

```
void clrscr()
{
#ifdef _WIN32
    HANDLE hStdOut = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD coord = {0, 0};
    DWORD count;
    CONSOLE_SCREEN_BUFFER_INFO csbi;
    GetConsoleScreenBufferInfo(hStdOut, &csbi);
    FillConsoleOutputCharacter(hStdOut, ' ',
                               csbi.dwSize.X * csbi.dwSize.Y,
                               coord, &count);
    SetConsoleCursorPosition(hStdOut, coord);
#else
    cout << "\f";
#endif
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-23T05:25:24.047

我知道这不是在回答我自己的问题，但是！这适用于 Windows ( `#include <windows.h>`)：

```
void clrscr()
{
    HANDLE hStdOut = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD coord = {0, 0};
    DWORD count;

    CONSOLE_SCREEN_BUFFER_INFO csbi;
    GetConsoleScreenBufferInfo(hStdOut, &csbi);

    FillConsoleOutputCharacter(hStdOut, ' ', csbi.dwSize.X * csbi.dwSize.Y, coord, &count);

    SetConsoleCursorPosition(hStdOut, coord);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-21T04:11:29.887

那么有一个非常接近的选择来清除屏幕。您可以尝试使用重复新行的 for 循环。例如：

```
for (i = 0; i < 100000; i++)
{
  printf ("\n\n\n\n\n");
} 
```

执行此循环后，终端将不允许您滚动回顶部的位置，这是一种非常不专业的常识方法。它不会直接回答您的要求，但它可以工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-21T06:02:38.480

这段代码清除了 Windows 和 Unix 中的控制台（尽管它实际上编译不同）：

```
// File: clear_screen.h
#ifndef _CLEAR_SCREEN_H
#define _CLEAR_SCREEN_H
void clearScreen(void); /* Clears the screen */
#endif /* _CLEAR_SCREEN_H */ 
```

```
// File: clear_screen.c
#ifdef _WIN32
#include <windows.h>
void clearScreen(void) {
    HANDLE hOutput = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD topLeft = {0, 0};
    DWORD dwCount, dwSize;
    CONSOLE_SCREEN_BUFFER_INFO csbi;
    GetConsoleScreenBufferInfo(hOutput, &csbi);
    dwSize = csbi.dwSize.X * csbi.dwSize.Y;
    FillConsoleOutputCharacter(hOutput, 0x20, dwSize, topLeft, &dwCount);
    FillConsoleOutputAttribute(hOutput, 0x07, dwSize, topLeft, &dwCount);
    SetConsoleCursorPosition(hOutput, topLeft);
}
#endif /* _WIN32 */

#ifdef __unix__
#include <stdio.h>
void clearScreen(void) {
    printf("\x1B[2J");
}
#endif /* __unix__ */ 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-03-25T08:02:43.473

正如其他人已经说过的那样，没有办法让一段相同的代码在 Windows 和 Linux 上都清除控制台。

我也**强烈**建议不要使用`std::system`：

*   它使您的程序容易受到攻击；如果有人用自己的恶意程序替换`clear`/怎么办`cls`
*   由于上述原因，防病毒程序讨厌`std::system`. 如果您的代码使用它，则生成的二进制文件可能会检测出病毒阳性，即使它本来是无害的。（请注意，它实际上*并不是*无害的。）

这是我的解决方案：

```
#ifdef _WIN32
#include <Windows.h>
#endif

void clrscr() {
#ifdef _WIN32
    COORD tl = { 0,0 };
    CONSOLE_SCREEN_BUFFER_INFO s;
    HANDLE console = GetStdHandle(STD_OUTPUT_HANDLE);
    GetConsoleScreenBufferInfo(console, &s);
    DWORD written, cells = s.dwSize.X * s.dwSize.Y;
    FillConsoleOutputCharacter(console, ' ', cells, tl, &written);
    FillConsoleOutputAttribute(console, s.wAttributes, cells, tl, &written);
    SetConsoleCursorPosition(console, tl);
#else
    std::cout << "\033[2J\033[1; 1H";
#endif
} 
```

您可以按照上面显示的模式，随意更改这两个代码段。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2011-11-20T14:51:48.003

不会

```
for (int i=0;i<1000;i++){cout<<endl;} 
```

在所有操作系统中清除屏幕？

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2015-02-21T04:27:18.033

如果您在控制台上工作，这应该可以工作

```
#include <conio.h>

int main()

{
    clrscr();
} 
```

# c++ - C++ 中的垃圾收集——为什么？

> ID：228620
> 
> 赞同：48
> 
> 时间：2008-10-23T05:24:59.430
> 
> 标签：c++, garbage-collection, c++11

我一直听到人们抱怨 C++ 没有垃圾收集。我还听说 C++ 标准委员会正在考虑将其添加到该语言中。恐怕我只是不明白它的意义......使用带有智能指针的 RAII 消除了对它的需要，对吧？

我唯一的垃圾收集经验是在几台便宜的 80 年代家用电脑上，这意味着系统每隔一段时间就会死机几秒钟。我确信从那以后它已经有所改善，但正如你所猜想的那样，这并没有让我对它有很高的评价。

垃圾收集可以为经验丰富的 C++ 开发人员提供哪些优势？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-23T06:29:03.370

## 我一直听到人们抱怨 C++ 没有垃圾收集。

我为他们感到难过。严重地。

C++ 有 RAII，我总是抱怨在垃圾收集语言中找不到 RAII（或阉割的 RAII）。

## 垃圾收集可以为经验丰富的 C++ 开发人员提供哪些优势？

另一个工具。

[Matt J 在他的帖子（ C++ 中的垃圾收集——为什么？](https://stackoverflow.com/questions/228620/garbage-collection-in-c-why#228640) ）中写得非常正确：我们不需要 C++ 特性，因为它们中的大多数都可以用 C 编码，而且我们不需要 C 特性，因为它们中的大多数都可以用汇编等编码**。C++ 必须发展。**

作为开发人员：我不关心 GC。我尝试了 RAII 和 GC，我发现 RAII 非常优越。正如 Greg Rogers 在他的帖子（[C++ 中的垃圾收集——为什么？](https://stackoverflow.com/questions/228620/garbage-collection-in-c-why#228670)）中所说，内存泄漏并不是那么可怕（至少在 C++ 中，如果真正使用 C++，它们很少见）以证明 GC 而不是 RAII。GC 具有非确定性的解除分配/终结，只是一种**编写不关心特定内存选择的代码**的方法。

最后一句话很重要：编写“不关心”的代码很重要。就像在 C++ RAII 中一样，我们不关心资源释放，因为 RAII 为我们做这件事，或者因为构造函数为我们做对象初始化，所以有时只编写代码而不关心谁是什么内存的所有者，这很重要，以及我们需要什么样的指针（共享的、弱的等）来处理这段或这段代码。**C++ 中似乎需要 GC。**（即使我个人没有看到它）

## 在 C++ 中良好的 GC 使用示例

有时，在应用程序中，您有“浮动数据”。想象一下数据的树状结构，但没有人真正成为数据的“所有者”（也没有人真正关心它何时会被销毁）。多个对象可以使用它，然后丢弃它。当没有人再使用它时，您希望它被释放。

C++ 方法使用智能指针。boost::shared_ptr 浮现在脑海中。因此，每条数据都由其自己的共享指针拥有。凉爽的。问题是当每条数据都可以引用另一条数据时。您不能使用共享指针，因为它们使用的是引用计数器，它不支持循环引用（A 指向 B，B 指向 A）。所以你必须知道在哪里使用弱指针（boost::weak_ptr），以及何时使用共享指针。

使用 GC，您只需使用树结构数据。

缺点是您不必关心“浮动数据”何时真正被破坏**。**只有它**会被**摧毁。

## 结论

所以最后，如果做得好，并且与当前的 C++ 习语兼容，GC 将是 C++ 的**又一个好工具**。

C++ 是一种多范式语言：添加 GC 可能会让一些 C++ 粉丝因为叛国而哭泣，但最终，这可能是个好主意，我猜 C++ 标准委员会不会让这种主要特性破坏语言，因此我们可以相信他们会进行必要的工作，以启用不会干扰 C++ 的正确 C++ GC：与 C++**中的往常一样，如果您不需要某个功能，请不要使用它，这将花费您没有。**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-23T05:35:24.180

简短的回答是垃圾收集在原理上与智能指针的 RAII 非常相似。如果您分配的每一块内存都位于一个对象中，并且该对象仅由智能指针引用，那么您就有了接近垃圾收集的东西（可能更好）。优势在于不必对每个对象的范围和智能指针如此明智，并让运行时为您完成工作。

这个问题似乎类似于“C++ 必须为经验丰富的汇编开发人员提供什么？指令和子例程消除了对它的需求，对吧？”

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-23T05:49:06.587

随着像 valgrind 这样好的内存检查器的出现，我认为垃圾收集作为安全网没有多大用处，“以防”我们忘记释放某些东西 - 特别是因为它对管理更通用的资源情况没有多大帮助除了内存（尽管这些不太常见）。此外，在我见过的代码中，显式分配和释放内存（即使使用智能指针）也很少见，因为容器通常是一种更简单、更好的方法。

但是垃圾收集可以潜在地提供性能优势，尤其是在堆分配大量短期对象的情况下。GC 还可能为新创建的对象（类似于堆栈上的对象）提供更好的引用位置。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-23T13:00:29.510

我不明白人们怎么能说 RAII 取代了 GC，或者说是非常优越。有很多情况是由 gc 处理的，而 RAII 根本无法处理。他们是不同的野兽。

首先，RAII 不是万无一失的：它可以解决 C++ 中普遍存在的一些常见故障，但在很多情况下 RAII 根本没有帮助；它对异步事件（如 UNIX 下的信号）很脆弱。从根本上说，RAII 依赖于作用域：当一个变量超出作用域时，它会被自动释放（当然，假设析构函数是正确实现的）。

这是一个简单的示例，其中 auto_ptr 或 RAII 都无法帮助您：

```
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#include <memory>

using namespace std;

volatile sig_atomic_t got_sigint = 0;

class A {
        public:
                A() { printf("ctor\n"); };
                ~A() { printf("dtor\n"); };
};

void catch_sigint (int sig)
{
        got_sigint = 1;
}

/* Emulate expensive computation */
void do_something()
{
        sleep(3);
}

void handle_sigint()
{
        printf("Caught SIGINT\n");
        exit(EXIT_FAILURE);
}

int main (void)
{
        A a;
        auto_ptr<A> aa(new A);

        signal(SIGINT, catch_sigint);

        while (1) {
                if (got_sigint == 0) {
                        do_something();
                } else {
                        handle_sigint();
                        return -1;
                }
        }
} 
```

A 的析构函数永远不会被调用。当然，这是一个人为的、有点做作的例子，但实际上也可能发生类似的情况；例如，当您的代码被另一个处理 SIGINT 并且您根本无法控制的代码调用时（具体示例：matlab 中的 mex 扩展）。这也是为什么 finally 在 python 中不保证某些东西的执行的原因。在这种情况下，gc 可以为您提供帮助。

其他习语对此并不好用：在任何非平凡的程序中，您都需要有状态的对象（我在这里使用非常广泛的对象一词，它可以是语言允许的任何构造）；如果你需要控制一个函数之外的状态，你不能用 RAII 轻松地做到这一点（这就是为什么 RAII 对异步编程没有那么有帮助的原因）。OTOH，gc 可以查看您的进程的整个内存，即它知道它分配的所有对象，并且可以异步清理。

使用 gc 也可以更快，原因相同：如果您需要分配/取消分配许多对象（尤其是小对象），gc 将大大优于 RAII，除非您编写自定义分配器，因为 gc 可以分配/一次清洁许多物体。一些著名的 C++ 项目使用 gc，即使在性能问题上也是如此（例如，参见 Tim Sweenie 关于在 Unreal Tournament 中使用 gc：http: [//lambda-the-ultimate.org/node/1277](http://lambda-the-ultimate.org/node/1277)）。GC 基本上以延迟为代价来增加吞吐量。

当然，也有RAII优于gc的情况；特别是，gc 概念主要与内存有关，而这并不是唯一的资源。RAII 可以很好地处理文件等内容。对于这些情况，没有内存处理的语言（如 python 或 ruby​​）确实有类似 RAII 的东西，顺便说一句（在 python 中使用语句）。当您需要精确控制何时释放资源时，RAII 非常有用，例如文件或锁通常就是这种情况。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-23T14:35:05.840

C++ 中支持 GC 的激励因素似乎是 lambda 编程、匿名函数等。事实证明，lambda 库受益于分配内存而不关心清理的能力。普通开发人员的好处将是更简单、更可靠和更快地编译 lambda 库。

GC 还有助于模拟无限内存；您需要删除 POD 的唯一原因是您需要回收内存。如果您有 GC 或无限内存，则无需再删除 POD。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-23T05:30:21.523

该委员会并没有添加垃圾收集，而是添加了一些功能，可以更安全地实现垃圾收集。只有时间才能证明它们是否真的对未来的编译器有任何影响。具体实现可能会有很大差异，但很可能涉及基于可达性的收集，这可能涉及轻微的挂起，具体取决于它是如何完成的。

但有一件事是，没有符合标准的垃圾收集器能够调用析构函数——只能默默地重用丢失的内存。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-23T14:15:49.543

## 垃圾收集可以为经验丰富的 C++ 开发人员提供哪些优势？

不必在经验不足的同事的代码中追踪资源泄漏。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-23T12:37:42.020

垃圾收集允许*推迟*决定谁*拥有*一个对象。

C++ 使用值语义，因此使用 RAII 时，确实会在超出范围时重新收集对象。这有时被称为“立即 GC”。

当您的程序开始使用引用语义（通过智能指针等...）时，该语言不再支持您，您只能使用智能指针库。

GC 的棘手之处在于决定*何时*不再需要对象。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-25T09:36:57.427

假设由于 C++ 没有将垃圾收集*融入到语言中*，因此您不能在 C++ 时期使用垃圾收集，这是一个普遍的错误。这是无稽之谈。我知道精英 C++ 程序员在他们的工作中理所当然地使用 Boehm 收集器。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-07-13T19:30:40.193

# 更简单的线程安全性和可扩展性

GC 有一个属性在某些情况下可能非常重要。在大多数平台上，指针的分配自然是原子的，而创建线程安全的引用计数（“智能”）指针非常困难，并且引入了显着的同步开销。结果，智能指针经常被告知在多核架构上“不能很好地扩展”。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-02-03T03:24:17.867

垃圾收集使[RCU](http://en.wikipedia.org/wiki/Read-copy-update)无锁同步更容易正确有效地实现。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-23T06:50:35.870

垃圾收集确实是自动资源管理的基础。GC 会以难以量化的方式改变您解决问题的方式。例如，当您进行手动资源管理时，您需要：

*   考虑什么时候可以释放一个项目（所有模块/类都用它完成了吗？）
*   考虑当资源准备好被释放时谁负责释放它（哪个类/模块应该释放这个项目？）

在平凡的情况下，没有复杂性。例如，您在方法开始时打开文件并在结束时关闭它。或者调用者必须释放这个返回的内存块。

当您有多个与资源交互的模块并且不清楚谁需要清理时，事情开始迅速变得复杂。最终结果是解决问题的整个方法包括某些编程和设计模式，这是一种折衷方案。

在具有垃圾收集功能的语言中，您可以使用[一次性](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)模式，您可以在其中释放您知道已完成的资源，但如果您未能释放它们，GC 可以挽救这一天。

* * *

智能指针实际上是我提到的妥协的一个完美例子。除非您有备份机制，否则智能指针无法使您免于泄漏循环数据结构。为了避免这个问题，你经常妥协并避免使用循环结构，即使它可能是最合适的。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-23T05:58:30.297

我也怀疑 C++ 委员会是否在标准中添加了一个成熟的垃圾收集。

**但我想说，在现代语言中添加/进行垃圾收集的主要原因是反对**垃圾收集的好理由太少了。自八十年代以来，内存管理和垃圾收集领域取得了一些巨大的进步，我相信甚至还有垃圾收集策略可以为您提供类似软实时的保证（例如，“GC 不会花费超过 .. ..在最坏的情况下”）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-06-17T18:50:14.440

> 使用带有智能指针的 RAII 消除了对它的需要，对吧？

智能指针可用于在 C++ 中实现引用计数，这是垃圾收集（自动内存管理）的一种形式，但生产 GC 不再使用引用计数，因为它有一些重要的缺陷：

1.  引用计数泄漏循环。考虑 A↔B，对象 A 和 B 都相互引用，因此它们的引用计数均为 1，并且都没有被收集，但它们都应该被回收。[像试删除](http://www.cs.virginia.edu/~cs415/reading/bacon-garbage.pdf)这样的高级算法解决了这个问题，但增加了很多复杂性。使用`weak_ptr`作为一种解决方法是回退到手动内存管理。

2.  天真的引用计数很慢有几个原因。首先，它需要经常增加缓存外引用计数（参见[Boost 的 shared_ptr 比 OCaml 的垃圾收集慢 10 倍](http://flyingfrogblog.blogspot.co.uk/2011/01/boosts-sharedptr-up-to-10-slower-than.html)）。其次，在作用域末尾注入的析构函数会导致不必要且昂贵的虚函数调用，并抑制尾调用消除等优化。

3.  基于作用域的引用计数会保持浮动垃圾，因为对象直到作用域结束才被回收，而跟踪 GC 可以在它们变得无法访问时立即回收它们，例如，在循环期间可以回收循环之前分配的本地吗？

> 垃圾收集可以为经验丰富的 C++ 开发人员提供哪些优势？

生产力和可靠性是主要优势。对于许多应用程序，手动内存管理需要大量的程序员工作。通过模拟无限内存机器，垃圾收集将程序员从这种负担中解放出来，使他们能够专注于解决问题并避免一些重要的错误类别（悬空指针、缺失`free`、双精度`free`）。此外，垃圾收集有助于其他形式的编程，例如通过解决[向上的 funarg 问题 (1970)](http://dspace.mit.edu/bitstream/handle/1721.1/5854/AIM-199.pdf)。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-02-04T19:56:29.840

在支持 GC 的框架中，对不可变对象（例如字符串）的引用可以以与原语相同的方式传递。考虑类（C# 或 Java）：

```
public class MaximumItemFinder
{
  String maxItemName = "";
  int maxItemValue = -2147483647 - 1;

  public void AddAnother(int itemValue, String itemName)
  {
    if (itemValue >= maxItemValue)
    {
      maxItemValue = itemValue;
      maxItemName = itemName;
    }
  }
  public String getMaxItemName() { return maxItemName; }
  public int getMaxItemValue() { return maxItemValue; }
} 
```

请注意，此代码不必对任何字符串的*内容*做任何事情，并且可以简单地将它们视为原语。类似的语句`maxItemName = itemName;`可能会生成两条指令：寄存器加载，然后是寄存器存储。将`MaximumItemFinder`无法知道的调用者`AddAnother`是否会保留对传入字符串的任何引用，并且调用者将无法知道`MaximumItemFinder`将对它们的引用保留多长时间。的调用者`getMaxItemName`将无法知道`MaximumItemFinder`返回字符串的原始供应商是否以及何时放弃了对它的所有引用。因为代码可以像原始值一样简单地传递字符串引用，但是，*这些都不重要*。

还要注意，虽然上面的类在同时调用 的情况下不是线程安全的`AddAnother`，但*任何调用`GetMaxItemName`都可以保证返回对空字符串或已传递给的字符串之一的有效引用`AddAnother`*。如果要确保最大项名称与其值之间的任何关系，则需要线程同步，但*即使在没有它的情况下也可以确保内存安全*。

我不认为有任何方法可以在 C++ 中编写像上面这样的方法，它可以在存在任意多线程使用的情况下维护内存安全，而无需使用线程同步或要求每个字符串变量都有自己的内容副本，保存在自己的存储空间中，在相关变量的生命周期内可能不会被释放或重新定位。肯定不可能定义一个可以像`int`.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-05-06T13:25:13.173

## 垃圾收集会让泄漏成为你最糟糕的噩梦

处理诸如循环引用之类的事情的成熟 GC 在某种程度上是对 ref-counted 的升级`shared_ptr`。我会在 C++ 中有点欢迎它，但不是在语言级别。

C++ 的优点之一是它不会强制你进行垃圾收集。

我想纠正一个常见的误解：垃圾收集*神话*，它以某种方式消除了泄漏。根据我的经验，调试其他人编写的代码并试图发现最昂贵的逻辑泄漏的最糟糕的噩梦涉及通过资源密集型主机应用程序使用嵌入式 Python 等语言进行垃圾收集。

在谈论像 GC 这样的主题时，有理论，然后有实践。从理论上讲，它很棒并且可以防止泄漏。然而在理论层面上，每一种语言都很棒而且没有泄漏，因为理论上，每个人都会编写完全正确的代码，并测试每一个可能的情况，其中一段代码可能会出错。

**在我们的案例中，垃圾收集加上不太理想的团队协作导致了最糟糕、最难调试的泄漏。**

问题仍然与资源的所有权有关。当涉及持久对象时，您必须在此处做出明确的设计决策，而垃圾收集使您很容易认为您不这样做。

给定一些资源，`R`在一个团队环境中，开发人员并不总是不断地交流和仔细审查彼此的代码（在我的经验中这有点太常见了），开发人员很容易`A`存储该资源的句柄. 开发人员`B`也是如此，也许以一种模糊的方式间接添加`R`到某些数据结构中。也是如此`C`。在垃圾收集系统中，这创建了 3 个`R`.

因为开发者`A`是最初创建资源的人，并且认为他是它的所有者，所以他记得`R`在用户表示他不再想使用它时释放引用。毕竟，如果他不这样做，什么都不会发生，从测试中可以看出，用户端删除逻辑什么也没做。所以他记得发布它，就像任何有能力的开发人员都会做的那样。这会触发一个事件来`B`处理它，并且还记得释放对 的引用`R`。

然而，`C`忘记了。他不是团队中更强大的开发人员之一：一个在系统中只工作了一年的新人。或者也许他甚至不在团队中，只是一个受欢迎的第三方开发人员为我们的产品编写插件，许多用户添加到软件中。使用垃圾收集，这是我们得到那些无声的逻辑资源泄漏的时候。它们是最糟糕的类型：它们不一定会在软件的用户可见方面表现为一个明显的错误，除了在运行程序的持续时间内，内存使用量会出于某种神秘目的而继续上升和上升。尝试使用调试器缩小这些问题的范围可能与调试时间敏感的竞争条件一样有趣。

如果没有垃圾收集，开发人员`C`将创建一个*悬空指针*。他可能会在某个时候尝试访问它并导致软件崩溃。现在这是一个测试/用户可见的错误。`C`有点尴尬并纠正了他的错误。在 GC 场景中，仅仅试图找出系统泄漏的位置可能非常困难，以至于某些泄漏永远无法纠正。这些不是`valgrind`类型的物理泄漏，可以很容易地检测到并精确定位到特定的代码行。

通过垃圾收集，开发人员`C`制造了一个非常神秘的泄漏。他的代码可以继续访问`R`，现在只是软件中的一些不可见实体，此时与用户无关，但仍处于有效状态。并且随着`C`的代码造成更多泄漏，他在无关资源上创建更多隐藏处理，并且软件不仅泄漏内存而且每次都变得越来越慢。

所以垃圾收集不一定能减轻逻辑资源泄漏。在不太理想的情况下，它可以使泄漏更容易被默默地忽视并保留在软件中。开发人员可能会因为试图追踪他们的 GC 逻辑泄漏而感到沮丧，以至于他们只是告诉用户定期重新启动软件作为一种解决方法。它确实消除了悬空指针，并且在一个注重安全的软件中，在任何情况下崩溃都是完全不可接受的，那么我更喜欢 GC。但我经常在安全性较低但资源密集型、性能关键型产品中工作，在这些产品中，可以及时修复的崩溃比真正晦涩难懂且神秘的静默 bug 更可取，并且资源泄漏在那里并不是微不足道的 bug。

在这两种情况下，我们讨论的是不驻留在堆栈中的持久对象，例如 3D 软件中的场景图或合成器中可用的视频剪辑或游戏世界中的敌人。当资源将它们的生命周期绑定到堆栈时，C++ 和任何其他 GC 语言都倾向于使正确管理资源变得微不足道。真正的困难在于引用其他资源的持久资源。

在 C 或 C++ 中，如果您未能清楚地指定谁拥有资源以及何时应该释放它们的句柄（例如：设置为 null 以响应事件），则可能会出现由段错误导致的悬空指针和崩溃。然而，在 GC 中，响亮而令人讨厌但通常很容易发现的崩溃被交换为可能永远不会被检测到的无声资源泄漏。

# c# - 总结所有节点

> ID：228623
> 
> 赞同：1
> 
> 时间：2008-10-23T05:26:06.540
> 
> 标签：c#, recursion, tree, subtree

这可能是一个简单的修复 - 但我试图将二叉搜索树上的所有节点（来自 Node 类的 Size 属性）相加。到目前为止，在我的 BST 类下面，我有以下内容，但它返回 0：

```
 private long sum(Node<T> thisNode)
    {
        if (thisNode.Left == null && thisNode.Right == null)
            return 0;
        if (node.Right == null)
            return sum(thisNode.Left);
        if (node.Left == null) 
            return sum(thisNode.Right);

        return sum(thisNode.Left) + sum(thisNode.Right);
    } 
```

在我的 Node 类中，我有 Data ，它将 Size 和 Name 存储在它们的给定属性中。我只是想总结整个大小。有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T05:35:32.200

这是因为当您到达叶节点时返回零。您应该返回存储在该叶节点中的大小。

此外，如果您的非叶节点也有大小，您还需要处理它们：

```
private long sum(Node<T> thisNode)
{
    if (thisNode.Left == null && thisNode.Right == null)
        return thisNode.Size;
    if (node.Right == null)
        return thisNode.Size + sum(thisNode.Left);
    if (node.Left == null) 
        return thisNode.Size + sum(thisNode.Right);
    return thisNode.Size + sum(thisNode.Left) + sum(thisNode.Right);
} 
```

如果您的非叶节点没有大小，请使用：

```
private long sum(Node<T> thisNode)
{
    if (thisNode.Left == null && thisNode.Right == null)
        return thisNode.Size;
    if (node.Right == null)
        return sum(thisNode.Left);
    if (node.Left == null) 
        return sum(thisNode.Right);
    return sum(thisNode.Left) + sum(thisNode.Right);
} 
```

第一个更优雅的版本是：

```
private long sum(Node<T> thisNode)
{
    if (thisNode == null)
        return 0;
    return thisNode.Size + sum(thisNode.Left) + sum(thisNode.Right);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T05:30:51.647

也许你的意思是

```
 if (thisNode.Left == null && thisNode.Right == null)
        return thisNode.Size; 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T05:35:38.550

怎么样

```
private long Sum(Node<T> thisNode)
{
  if( thisNode == null )
    return 0;

  return thisNode.Size + Sum(thisNode.Left) + Sum(thisNode.Right);
} 
```

如果 size 属性不在节点本身上，那该怎么办？

```
 public class Node<T>
    {
        public T Data;
        public Node<T> Left;
        public Node<T> Right;

        public static void ForEach(Node<T> root, Action<T> action)
        {
            action(root.Data);

            if (root.Left != null)
                ForEach(root.Left, action);
            if (root.Right != null)
                ForEach(root.Right, action);
        }
    }

    public interface IHasSize
    {
        long Size { get; }
    }

    public static long SumSize<T>(Node<T> root) where T : IHasSize
    {
        long sum = 0;
        Node<T>.ForEach(root, delegate(T item)
        {
            sum += item.Size;
        });
        return sum;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T05:36:32.510

试试这个：

```
 private long sum(Node<T> thisNode)
    {
        if (thisNode == null)
            return 0;
        return thisNode.Size + sum(thisNode.Left) + sum(thisNode.Right);
    } 
```

原始代码返回的唯一“值”是 0 - 这就是结果始终为 0 的原因。

# python - Python 调试器：步入您以交互方式调用的函数

> ID：228642
> 
> 赞同：60
> 
> 时间：2008-10-23T05:35:32.543
> 
> 标签：python, debugging, pdb

Python 很酷，但不幸的是，它的调试器不如 perl -d。

在试验代码时，我经常做的一件事是从调试器中调用一个函数，然后进入该函数，如下所示：

```
# NOTE THAT THIS PROGRAM EXITS IMMEDIATELY WITHOUT CALLING FOO()
~> cat -n /tmp/show_perl.pl
1  #!/usr/local/bin/perl
2
3  sub foo {
4      print "hi\n";
5      print "bye\n";
6  }
7
8  exit 0;

~> perl -d /tmp/show_perl.pl

Loading DB routines from perl5db.pl version 1.28
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(/tmp/show_perl.pl:8):    exit 0;

# MAGIC HAPPENS HERE -- I AM STEPPING INTO A FUNCTION THAT I AM CALLING INTERACTIVELY
  DB<1> s foo() 
main::((eval 6)[/usr/local/lib/perl5/5.8.6/perl5db.pl:628]:3):
3:      foo();

  DB<<2>> s
main::foo(/tmp/show_perl.pl:4):     print "hi\n";

  DB<<2>> n
hi
main::foo(/tmp/show_perl.pl:5):     print "bye\n";

  DB<<2>> n
bye

  DB<2> n
Debugged program terminated.  Use q to quit or R to restart,
  use O inhibit_exit to avoid stopping after program termination,
  h q, h R or h O to get additional info.  

  DB<2> q 
```

这在尝试单步执行函数对各种不同输入的处理以找出失败的原因时非常有用。但是，它似乎在 pdb 或 pydb 中都不起作用（我将展示一个与上述示例等效的 python 示例，但它会导致大量异常堆栈转储）。

所以我的问题是双重的：

1.  我错过了什么吗？
2.  是否有一个 python 调试器确实可以让我这样做？

显然我可以自己将调用放入代码中，但我喜欢交互式工作，例如。当我想尝试使用一组略有不同的参数进行调用时，不必从头开始。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-23T05:42:00.313

我已经回答了我自己的问题！这是 pydb 中的“调试”命令：

```
~> cat -n /tmp/test_python.py
     1  #!/usr/local/bin/python
     2
     3  def foo():
     4      print "hi"
     5      print "bye"
     6
     7  exit(0)
     8

~> pydb /tmp/test_python.py
(/tmp/test_python.py:7):  <module>
7 exit(0)

(Pydb) debug foo()
ENTERING RECURSIVE DEBUGGER
------------------------Call level 11
(/tmp/test_python.py:3):  foo
3 def foo():

((Pydb)) s
(/tmp/test_python.py:4):  foo
4     print "hi"

((Pydb)) s
hi
(/tmp/test_python.py:5):  foo
5     print "bye"

((Pydb)) s
bye
------------------------Return from level 11 (<type 'NoneType'>)
----------------------Return from level 10 (<type 'NoneType'>)
LEAVING RECURSIVE DEBUGGER
(/tmp/test_python.py:7):  <module> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-23T11:27:26.920

您也可以使用 pdb 交互式调试函数，前提是您要调试的脚本最后没有 exit()：

```
$ cat test.py
#!/usr/bin/python

def foo(f, g):
        h = f+g
        print h
        return 2*f 
```

要调试，请启动交互式 python 会话并导入 pdb：

```
$ python
Python 2.5.1 (r251:54869, Apr 18 2007, 22:08:04) 
[GCC 4.0.1 (Apple Computer, Inc. build 5367)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pdb
>>> import test
>>> pdb.runcall(test.foo, 1, 2)
> /Users/simon/Desktop/test.py(4)foo()
-> h = f+g
(Pdb) n
> /Users/simon/Desktop/test.py(5)foo()
-> print h
(Pdb) 
```

pdb 模块随 python 一起提供，并记录在[http://docs.python.org/modindex.html的模块文档中](http://docs.python.org/modindex.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T05:46:25.470

有一个 python 调试器是 python 核心发行版的一部分，称为“pdb”。我自己很少使用它，但有时发现它很有用。

鉴于此程序：

```
def foo():
    a = 0
    print "hi"

    a += 1

    print "bye"

foo() 
```

这是一个调试它的会话：

```
$ python /usr/lib/python2.5/pdb.py /var/tmp/pdbtest.py         ~
> /var/tmp/pdbtest.py(2)<module>()
-> def foo():
(Pdb) s
> /var/tmp/pdbtest.py(10)<module>()
-> foo()
(Pdb) s
--Call--
> /var/tmp/pdbtest.py(2)foo()
-> def foo():
(Pdb) s
> /var/tmp/pdbtest.py(3)foo()
-> a = 0
(Pdb) s
> /var/tmp/pdbtest.py(4)foo()
-> print "hi"
(Pdb) print a
0
(Pdb) s
hi
> /var/tmp/pdbtest.py(6)foo()
-> a += 1
(Pdb) s
> /var/tmp/pdbtest.py(8)foo()
-> print "bye"
(Pdb) print a
1
(Pdb) s
bye
--Return--
> /var/tmp/pdbtest.py(8)foo()->None
-> print "bye"
(Pdb) s
--Return--
> /var/tmp/pdbtest.py(10)<module>()->None
-> foo()
(Pdb) s 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T10:55:53.130

对于我正在开发的代码的交互式工作，我通常发现使用`pdb.set_trace`. 这也使得在循环深处打破程序状态变得更容易： `if <state>: pdb.set_trace()`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T17:07:50.507

如果您更熟悉 GUI 调试器，则可以使用 winpdb（在这种情况下，'win' 不是指 Windows）。我实际上在Linux上使用它。

在 debian/ubuntu 上：

```
sudo aptitude install winpdb 
```

然后只需将其放入您希望它中断的代码中：

```
import rpdb2; rpdb2.start_embedded_debugger_interactive_password() 
```

然后启动 winpdb 并附加到您的运行脚本。

# ruby - 如何在 ruby 中列出当前范围内的当前可用对象？

> ID：228648
> 
> 赞同：39
> 
> 时间：2008-10-23T05:38:15.673
> 
> 标签：ruby, introspection, irb

我是红宝石的新手，我正在玩 IRB。

我发现我可以使用“.methods”方法列出对象的方法，并且 self.methods 有点给了我想要的东西（类似于 Python 的 dir( **builtins** )？），但是我怎样才能找到一个我通过 include 和 require 加载的库/模块？

```
irb(main):036:0* self.methods
=> ["irb_pop_binding", "inspect", "taguri", "irb_chws", "clone", "irb_pushws", "public_methods", "taguri=", "irb_pwws",
"public", "display", "irb_require", "irb_exit", "instance_variable_defined?", "irb_cb", "equal?", "freeze", "irb_context
", "irb_pop_workspace", "irb_cwb", "irb_jobs", "irb_bindings", "methods", "irb_current_working_workspace", "respond_to?"
, "irb_popb", "irb_cws", "fg", "pushws", "conf", "dup", "cwws", "instance_variables", "source", "cb", "kill", "help", "_
_id__", "method", "eql?", "irb_pwb", "id", "bindings", "send", "singleton_methods", "popb", "irb_kill", "chws", "taint",
 "irb_push_binding", "instance_variable_get", "frozen?", "irb_source", "pwws", "private", "instance_of?", "__send__", "i
rb_workspaces", "to_a", "irb_quit", "to_yaml_style", "irb_popws", "irb_change_workspace", "jobs", "type", "install_alias
_method", "irb_push_workspace", "require_gem", "object_id", "instance_eval", "protected_methods", "irb_print_working_wor
kspace", "irb_load", "require", "==", "cws", "===", "irb_pushb", "instance_variable_set", "irb_current_working_binding",
 "extend", "kind_of?", "context", "gem", "to_yaml_properties", "quit", "popws", "irb", "to_s", "to_yaml", "irb_fg", "cla
ss", "hash", "private_methods", "=~", "tainted?", "include", "irb_cwws", "irb_change_binding", "irb_help", "untaint", "n
il?", "pushb", "exit", "irb_print_working_binding", "is_a?", "workspaces"]
irb(main):037:0> 
```

我习惯了 python，我使用 dir() 函数来完成同样的事情：

```
>>> dir()
['__builtins__', '__doc__', '__name__', '__package__']
>>> 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-25T06:18:48.637

我不完全确定您所说的“当前对象”是什么意思。正如已经提到的，您可以遍历 ObjectSpace。但这里有一些其他方法。

```
local_variables
instance_variables
global_variables

class_variables
constants 
```

有一个问题。必须在正确的范围内调用它们。所以就在 IRB 中，或者在对象实例中或在类范围内（基本上到处都是），您可以调用前 3 个。

```
local_variables #=> ["_"]
foo = "bar"
local_variables #=> ["_", "foo"]
# Note: the _ variable in IRB contains the last value evaluated
_ #=> "bar"

instance_variables  #=> []
@inst_var = 42
instance_variables  #=> ["@inst_var"]

global_variables    #=> ["$-d", "$\"", "$$", "$<", "$_", ...]
$"                  #=> ["e2mmap.rb", "irb/init.rb", "irb/workspace.rb", ...] 
```

但是，嗯，如果你想让你的程序真正评估它们而不需要你多次输入它们怎么办？诀窍是评估。

```
eval "@inst_var" #=> 42
global_variables.each do |v|
  puts eval(v)
end 
```

开头提到的 5 个中的最后 2 个必须在模块级别进行评估（类是模块的后代，因此可以工作）。

```
Object.class_variables #=> []
Object.constants #=> ["IO", "Duration", "UNIXserver", "Binding", ...]

class MyClass
  A_CONST = 'pshh'
  class InnerClass
  end
  def initialize
    @@meh = "class_var"
  end
end

MyClass.constants           #=> ["A_CONST", "InnerClass"]
MyClass.class_variables     #=> []
mc = MyClass.new
MyClass.class_variables     #=> ["@@meh"]
MyClass.class_eval "@@meh"  #=> "class_var" 
```

这里还有一些技巧可以在不同的方向上进行探索

```
"".class            #=> String
"".class.ancestors  #=> [String, Enumerable, Comparable, ...]
String.ancestors    #=> [String, Enumerable, Comparable, ...]

def trace
  return caller
end
trace #=> ["(irb):67:in `irb_binding'", "/System/Library/Frameworks/Ruby...", ...] 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-23T08:13:27.637

[ObjectSpace.each_object](http://www.ruby-doc.org/core-1.8.7/classes/ObjectSpace.html#M000928)可能是您正在寻找的。

要获取包含模块的列表，您可以使用[Module.included_modules](http://www.ruby-doc.org/core/classes/Module.html#M001697)。

您还可以使用[object.respond_to 逐个检查对象是否响应方法？](http://ruby-doc.org/core/classes/Object.html#M000333).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T02:13:05.523

该`dir()`方法[没有明确定义](http://www.python.org/doc/2.5.2/lib/built-in-funcs.html)...

> **注意：**因为`dir()`主要是为了方便在交互式提示中使用而提供的，所以它尝试提供一组有趣的名称，而不是尝试提供一组严格或一致定义的名称，并且其详细行为可能会随版本而变化。

...但我们可以在 Ruby 中创建一个近似值。让我们创建一个方法，该方法将返回由包含模块添加到我们范围内的所有方法的排序列表。我们可以通过该方法获取已包含的模块列表`included_modules`。

比如`dir()`，我们想忽略“默认”方法（比如`print`），我们还想关注“有趣”的名称集。因此，我们将忽略 中的方法`Kernel`，并且我们只会返回直接在模块中定义的方法，而忽略继承的方法。我们可以通过传入方法来完成`false`后者`methods()`。把它们放在一起，我们得到...

```
def included_methods(object=self)
  object = object.class if object.class != Class
  modules = (object.included_modules-[Kernel])
  modules.collect{ |mod| mod.methods(false)}.flatten.sort
end 
```

您可以向它传递一个类、一个对象或什么都不传递（它默认为当前范围）。让我们试一试...

```
irb(main):006:0> included_methods
=> []
irb(main):007:0> include Math
=> Object
irb(main):008:0> included_methods
=> ["acos", "acosh", "asin", "asinh", "atan", "atan2", "atanh", "cos", "cosh", "erf", "erfc", "exp", "frexp", "hypot", "ldexp", "log", "log10", "sin", "sinh", "sqrt", "tan", "tanh"] 
```

* * *

`dir()`还包括本地定义的变量，这很容易。只要打电话...

```
local_variables 
```

...不幸的是，我们不能只添加`local_variables`调用，`included_methods`因为它会给我们`included_methods`方法本地的变量，这不会很有用。因此，如果您想要包含在 included_methods 中的局部变量，只需调用...

```
 (included_methods + local_variables).sort 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-11-09T11:06:38.377

我为此写了一个宝石：

```
$ gem install method_info
$ rvm use 1.8.7 # (1.8.6 works but can be very slow for an object with a lot of methods)
$ irb
> require 'method_info'
> 5.method_info
::: Fixnum :::
%, &, *, **, +, -, -@, /, <, <<, <=, <=>, ==, >, >=, >>, [], ^, abs,
div, divmod, even?, fdiv, id2name, modulo, odd?, power!, quo, rdiv,
rpower, size, to_f, to_s, to_sym, zero?, |, ~
::: Integer :::
ceil, chr, denominator, downto, floor, gcd, gcdlcm, integer?, lcm,
next, numerator, ord, pred, round, succ, taguri, taguri=, times, to_i,
to_int, to_r, to_yaml, truncate, upto
::: Precision :::
prec, prec_f, prec_i
::: Numeric :::
+@, coerce, eql?, nonzero?, pretty_print, pretty_print_cycle,
remainder, singleton_method_added, step
::: Comparable :::
between?
::: Object :::
clone, to_yaml_properties, to_yaml_style, what?
::: MethodInfo::ObjectMethod :::
method_info
::: Kernel :::
===, =~, __clone__, __id__, __send__, class, display, dup, enum_for,
equal?, extend, freeze, frozen?, hash, id, inspect, instance_eval,
instance_exec, instance_of?, instance_variable_defined?,
instance_variable_get, instance_variable_set, instance_variables,
is_a?, kind_of?, method, methods, nil?, object_id, pretty_inspect,
private_methods, protected_methods, public_methods, respond_to?, ri,
send, singleton_methods, taint, tainted?, tap, to_a, to_enum, type,
untaint
 => nil 
```

我正在改进传递选项和设置默认值，但现在我建议您将以下内容添加到您的 .irbrc 文件中：

```
require 'method_info'
MethodInfo::OptionHandler.default_options = {
 :ancestors_to_exclude => [Object],
 :enable_colors => true
} 
```

这会启用颜色并隐藏每个对象具有的方法，因为您通常对这些方法不感兴趣。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-07-27T22:27:25.053

关于什么：

```
Object.constants.select{|x| eval(x.to_s).class == Class} 
```

这列出了我可用的课程。我不是红宝石专家，我被丢在红宝石控制台上，不知道手头有什么课程。那一个班轮是一个开始。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-23T08:07:04.187

要访问 ruby​​ 中的所有对象实例，请使用 ObjectSpace

[http://www.ruby-doc.org/core-1.8.7/classes/ObjectSpace.html#M000928](http://www.ruby-doc.org/core-1.8.7/classes/ObjectSpace.html#M000928)

然而，这被认为很慢（即使对于 ruby​​），并且可能无法在某些解释器中启用（例如，jRuby 可以禁用 ObjectSpace，因为它在 jvm 中用于 gc 的速度要快得多，而无需在 jRuby 中跟踪这些东西）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T08:06:06.700

您甚至可以在加载之前将 .methods 消息传递给库/模块，以查看所有可用的方法。这样做`self.methods`只是返回 Object 对象包含的所有方法。你可以通过做看到这一点`self.class`。因此，假设您想查看 File 模块中的所有方法。您只需这样做`File.methods`，您将获得 File 模块中存在的所有方法的列表。这也许不是您想要的，但它应该会有所帮助。

# c# - “单词正则表达式”（语义替换） - 任何示例语法和库？

> ID：228658
> 
> 赞同：7
> 
> 时间：2008-10-23T05:45:36.063
> 
> 标签：c#, language-agnostic, parsing, syntax, semantics

在给定程序语言的情况下，我正在寻找对单词而不是字符进行正则表达式样式转换的句法示例或常用技术。

例如，要跟踪复制，您可能希望创建一个具有相似含义但具有不同单词选择的文档。

我希望能够简洁地定义这些可以应用于文本流的可能转换。

例如。“快速*名词*”改为“快速*名词*”，但“走得快”。不会被改变（之后没有名词。
或者：“爱丽丝会唱歌*”*到“爱丽丝会*唱歌*”

我希望这可以在语法检查器中完成，例如检测被动语态。

这种语言处理的 AC# 实现会非常简洁，但我认为任何努力的大部分都在提出正确的规则 - 保持规则清晰易懂似乎是一个开始的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T14:24:56.563

你可以试试[Jason Rennie > WordNet-QueryData-1.47 > WordNet::QueryData](http://search.cpan.org/~jrennie/WordNet-QueryData-1.47/QueryData.pm#SYNOPSIS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T16:15:08.570

如果您不依赖于特定语言，Haskell 有 Aarne Ranta 的语法框架：

[http://www.grammaticalframework.org/](http://www.grammaticalframework.org/)

它被明确设计为为这种自然语言处理生成解析器等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T09:20:54.290

开始研究的一个好地方是“Word Net”——它是一本语义词典，按相似的含义将单词组合在一起，并以有用的方式记录单词之间的关系。

有很多利用 Word Net 语料库的软件项目，其中一个可能是您需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T06:45:48.393

SIL 的[CARLAStudio](http://www.sil.org/computing/catalog/show_software.asp?id=84)是一个很好的起点，因为它的“计算机辅助相关语言适应”套件。或者 SIL 的[Adapt It](http://www.sil.org/computing/catalog/show_software.asp?id=105)。SIL 拥有大量的语言分析软件，这似乎是您的发展方向。从不关心含义的正则表达式到可以处理语言分析的东西，这无疑是一个很大的飞跃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T08:50:58.157

如果您想要更强大的自然语言解析/转换，您可以尝试[OpenNLP 的 C# 端口](http://www.codeproject.com/KB/recipes/englishparsing.aspx)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-25T15:03:56.323

我不知道您讨论的英语语言处理存在任何语法。您需要使用其中一种工具集（例如 Word Net）来创建自己的 DSL。

# c# - 使用 C# 从 line-in 连续采样的最简单方法是什么

> ID：228659
> 
> 赞同：8
> 
> 时间：2008-10-23T05:45:47.703
> 
> 标签：c#, audio, signal-processing, audio-recording

我想使用 C# 不断地从我的 PC 的音频线中采样（然后处理该数据）。进行抽样的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T07:39:12.357

您可以使用开源[NAudio](http://www.codeplex.com/naudio) .NET 音频库进行一些（基本）音频捕获。查看 NAudioDemo 项目，了解使用 WaveIn 函数录制到 WAV 文件的简单示例。NAudio 现在还包括使用 WASAPI（Windows Vista 及更高版本）和 ASIO（如果您的声卡有 ASIO 驱动程序）捕获音频的能力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T06:04:44.620

.NET 框架中没有用于处理声音的内置库，但如果您使用的是 Win32，则可以使用 DirectSound 等非托管库来执行此操作。

Ianier Munoz 展示了如何通过 CodeProject 上的[P/Invoke使用](http://www.codeproject.com/KB/audio-video/cswavrec.aspx?fid=16677&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2525433&fr=151)[**waveIn**](http://www.codeproject.com/KB/audio-video/cswavrec.aspx?fid=16677&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2525433&fr=151)[在 C# 中编写全双工音频播放器](http://www.codeproject.com/KB/audio-video/cswavrec.aspx?fid=16677&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2525433&fr=151)**。他提到**[托管 DirectSound](http://www.codeproject.com/KB/audio-video/DirectSound9p1.aspx)**是一种更通用的方法。**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T06:26:49.787

还有[Alvas Audio](http://www.alvas.net/alvas.audio.aspx)库，不是免费的，如果你不付费，它会有一个烦人的屏幕，但效果很好。而且文档很好，如果您发现错误或其他问题，支持也很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T10:38:50.573

托管 DirectX 支持直接捕获音频并且非常易于使用，但不再受支持，并且已于去年从 DirectX SDK 中删除。仍然可以通过安装 2007 年 8 月之前的 SDK 版本来[获得它。](http://www.microsoft.com/downloads/details.aspx?familyid=86cf7fa2-e953-475c-abde-f016e4f7b61a&displaylang=en)

虽然不能严格满足您的要求，但更强大的方法是围绕本机 C++ DirectSound API 创建一个 C++/CLI 包装程序集，同样来自 DirectX SDK。然后可以直接从 C# 代码中调用它。尽管需要一些 C++ 和 COM 知识，但这绝对是一种更强大且可维护的方法。

我过去使用过这两种技术，它们都运行良好。

# apache-flex - 在 Flex/flash 中嵌入 Vimeo 视频

> ID：228669
> 
> 赞同：1
> 
> 时间：2008-10-23T05:48:38.570
> 
> 标签：apache-flex, vimeo

是否可以在 Flex中嵌入**Vimeo视频？**

当我尝试[将此链接](http://vimeo.com/moogaloop.swf?clip_id=1193166)嵌入a`<mx:SWFLoader/>`时，它什么也没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T18:26:01.913

我能做的最好的就是这个。使用 Vimeo Api 显示 img 并将 img 链接到视频。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" backgroundColor="black" >
<mx:Script>
<![CDATA[
    import flash.net.navigateToURL;
    import flash.net.URLRequest;

    private var xml:XML = new XML();
    private var loadXML:URLLoader = new URLLoader();

    private function carregar(string:String):void{
    //carregando XML adicionando o evento COMPLETE
    loadXML.load(new URLRequest("http://vimeo.com/api/clip/"+string+".xml"));
    loadXML.addEventListener(Event.COMPLETE, lista);
    }

    //função Listar
    private function lista(event:Event):void {
    xml = new XML(event.target.data);
    img.source = xml.clip.thumbnail_large;
    img.addEventListener(MouseEvent.CLICK, abrir);
    }

    private function abrir(event:MouseEvent):void{

        var req:String = "http://vimeo.com/moogaloop.swf?clip_id="+xml.clip.clip_id;
        var request:URLRequest = new URLRequest(req);
        navigateToURL(request,"_blank");
    }
]]>
</mx:Script>
<mx:TextInput x="209" y="55" width="182" id="codVimeo"/>
<mx:Button x="398" y="55" label="Carregar" click="carregar(codVimeo.text)"/>
<mx:Image x="113" y="94" width="361" height="318" id="img"/>
<mx:Label x="113" y="57" text="Código Vimeo:" color="#FFFFFF"/>
</mx:Application> 
```

# php - PHP门禁系统

> ID：228672
> 
> 赞同：8
> 
> 时间：2008-10-23T05:52:19.513
> 
> 标签：php, database-design, permissions, access-control, database-permissions

我是使用 PHP 和 MySQL 创建 Web 应用程序的团队的一员。该应用程序将有多个具有不同角色的用户。该应用程序还将以地理分布的方式使用。因此，我们需要创建一个在以下两个级别上运行的访问控制系统：

1.  控制特定 php 页面的用户权限，即根据用户的角色提供或拒绝对特定页面（或用户界面元素）的访问。例如：用户可能被允许访问“学生”页面，但不能访问“教师”页面。
2.  控制特定数据库记录的用户权限，即修改数据库查询以便仅显示特定记录。例如，对于城市级别的用户，只应显示与用户的特定城市相关的记录，而对于国家级别的用户，应显示该国所有城市的记录。

我需要帮助设计一个可以处理这两种访问控制类型的系统。点号 1似乎很简单。但是，我完全不知道如何在不对 SQL 查询中的信息进行硬编码的情况下执行第 2 点。

任何帮助，将不胜感激。

提前致谢

维纳亚克

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-28T13:50:08.617

几个月前我也遇到过类似的情况。我发现如果您只检查单个项目的访问级别（或相当少的项目），像 Zend_ACL 这样的工具会非常有用。当您需要获取允许用户访问的大量项目列表时，它会失败。[我使用业务代表](http://java.sun.com/blueprints/corej2eepatterns/Patterns/BusinessDelegate.html)模式为这个问题定制了解决方案。BD 提供可以在特定上下文中应用的业务逻辑。在这种情况下，交付了一个 SQL 逻辑并将其用作子选择中的过滤条件。请参见下图：

[![替代文字](https://i.stack.imgur.com/h0TmD.png)](https://i.stack.imgur.com/h0TmD.png)
[（来源：[epsi.pl](http://gruz.epsi.pl/g/uml/permissions.png)）]

以及说明调用顺序的序列图：

[![替代文字](https://i.stack.imgur.com/eDvrv.png)](https://i.stack.imgur.com/eDvrv.png)
[（来源：[epsi.pl](http://gruz.epsi.pl/g/uml/permissions-s2.png)）]

[我在博客上写了这个解决方案](http://stronger.epsi.pl/2008/04/02/prawa-dostepu-the-ultimate-edition/)，不幸的是它都是波兰语的，但你可能会发现方便的代码和图表。我可以说，实现不是小菜一碟，但在性能方面，与列表中每个元素的迭代访问检查相比，它是一个冠军。此外，上面的基础设施不仅处理列表中的一种类型的项目。它可以在访问不同的列表时服务，无论是城市列表、国家列表、产品列表还是文档列表，只要列表中的项目实现`IAuthorizable`接口即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T06:07:22.993

不知道您的问题的详细信息，但 Zend 框架有一个相当强大的[ACL](http://framework.zend.com/manual/en/zend.acl.html)和[AUTH](http://framework.zend.com/manual/en/zend.auth.html)组件集，您可能想看看。好东西，比如非常精确的访问控制、存储数据以实现持久性、高级条件规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T06:10:37.963

在我看来，您需要的是这样的：（我将使用国家/州/城市示例）

1.  所有国家的列表。每个“国家”都有一个 ID。
2.  国家内所有国家的清单。每个州都绑定了国家的ID，但也有自己的唯一ID。
3.  所有城市的列表。每个城市要么与一个州绑定，要么直接与一个国家绑定，并有一面旗帜表明哪个城市。

对于城市用户，显然只搜索和显示与他们的 ID 匹配的城市的记录。但是，对于州或国家级别，搜索与每个城市相关的所有记录，这些城市的 ID 与该国家（或州或您拥有的）相匹配。

所以基本上，每个子组都依赖于它上面的组，虽然我没有记错，但我相信你可以从那里使用子查询来解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T18:36:07.507

如果您不知道如何执行此操作，我会使用 Zend Framework、CakePHP 或 Symfony 等 php 框架。他们已经为您完成了繁重的工作，并且已经制定了某种类型的访问控制方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-24T06:27:27.797

我有类似的解决方案来构建，到目前为止我已经决定使用规范和角色，所以实际上一个角色会附加一些特权规范。如果他们都满意，则授予权限，否则 - 它回退到资源默认访问权限。

我一直在寻找已经实施该解决方案的人，但似乎没有人这样做。让我们希望它不会失败:)

# c++ - 如何选择并突出显示另一个应用程序中的窗口？

> ID：228675
> 
> 赞同：1
> 
> 时间：2008-10-23T05:53:06.720
> 
> 标签：c++, windows

我想将一些 C++ 程序中的击键发送到另一个窗口。

出于这个原因，我想让用户选择目标窗口，类似于它在 Visual Studio 附带的 Spy++ 实用程序中的操作方式（将十字光标拖到目标窗口上，并用框架突出显示目标窗口）。

在 Windows 中如何进行这种拖动和选择？我完全不知道从哪里开始寻找实现此功能的机制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T06:33:57.747

以下是通常的做法：

1.  使用[SetCapture](http://msdn.microsoft.com/en-us/library/ms646262.aspx)捕获鼠标。这将导致所有鼠标消息被路由到您的应用程序的窗口。
2.  处理[WM_MOUSEMOVE](http://msdn.microsoft.com/en-us/library/ms645616.aspx)消息。[在您的处理程序代码中，使用WindowFromPoint](http://msdn.microsoft.com/en-us/library/ms633558.aspx)抓住鼠标下方的窗口。这将为您提供鼠标当前所在窗口的 HWND。
3.  现在您已经有了窗口，您需要一个设备上下文 (HDC)。您可以使用[GetWindowDC](http://msdn.microsoft.com/en-us/library/ms534830.aspx)为指定的窗口获取一个。
4.  现在您可以使用典型的 GDI 函数绘制到 DC。

您需要注意一些事情 - 干净地擦除选择矩形等，但这是一种方法。

您也可以绘制到屏幕 DC 中来执行此操作，但无论如何您都需要窗口句柄才能获得窗口矩形。

如果您搜索 Spy++ 源代码，您会看到一些这种技术的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T10:14:23.167

前辈的答案是错误的。

Spy++ 源代码已经在 G. Groups 上提供多年（主要见 Win32 api ng news://194.177.96.26/comp.os.ms-windows.programmer.win32）

# vba - 一次加载超过 1 个 CSV 文件

> ID：228680
> 
> 赞同：0
> 
> 时间：2008-10-23T05:57:43.950
> 
> 标签：vba, csv, excel, file-import

如何通过 Excel VBA 以一组、组或多个单个文件的形式导入 CSV 文件，而不是一次一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T21:41:42.203

我有点困惑，大多数版本的 Excel 都可以毫无问题地打开 .csv 文件。

```
strPath = "C:\Docs\"
strFile = Dir(strPath & "*.csv")

Do While strFile <> ""
    Workbooks.Open Filename:=strPath & strFile
    ActiveWorkbook.SaveAs Filename:=strPath & Mid(strFile, 1, InStr(strFile, ".") - 1) _
        & "Conv.xls", FileFormat:=xlNormal

    strFile = Dir
Loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T08:36:26.920

这将快速将文件放入一维数组

```
Open "myfile.csv" For Input As 1
Dim Txt As String
Txt = Input(LOF(1), 1)
Close #1
Dim V As Variant
V = Split(Txt, ",") 
```

然后V包含单个列中的所有项目，NB第一项是V（0）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-17T11:15:18.020

这是另一种避免在 Excel 中打开 csv 文件时重新计算的方法。

将一张空白工作表添加到您的工作簿并在工作表的对象中添加以下代码

```
Function getCsv(fn)
    Dim d, scrup As Boolean
    scrup = Application.ScreenUpdating
    Application.ScreenUpdating = False
    With Me.QueryTables.Add( _
            Connection:="TEXT;" & fn, _
            Destination:=Me.Range("A1") _
        )
        .Name = "data"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 850
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileCommaDelimiter = True
        .Refresh BackgroundQuery:=False
    End With

    d = Me.Names(1).RefersToRange.Value

    Me.Names(1).Delete
    Me.UsedRange.Rows.Delete

    Application.ScreenUpdating = scrup
    getCsv = d
End Function 
```

您可能还想隐藏工作表，以免有人意外使用它。然后你可以像这样使用

```
dim d
d = getCsv("C:\temp\some.csv") 
```

让我稍微担心的一件事是，每次使用函数时，名称都会增加（例如 data_1、data_2、...），因此如果这些名称保存在某个地方，可能会出现稳定性问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-25T00:38:12.957

你也可以使用 workbooks.opentext

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T06:26:30.630

您可以编写一个简单的控制台应用程序来解析一批 csv 文件并将它们保存到 excel 文件中。
不是最简单的解决方案，但它可能是一种选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T02:59:06.437

我最初的想法如下。鉴于此数据

```
Dog Names,Dog Ages,Collar Size
Woof,3,4
Bowser,2,5
Ruffy,4.5,6
Angel,1,7
Demon,7,8
Dog,9,2 
```

创建三个名为 和 的全局数组，`Dog_Names`并`Dog_Ages`用`Collar_Size`CSV 文件中的数据填充它们。

这部分 VBScript 完成了这项工作并显示了结果。`wscript.echo`从子例程中删除注释标记`x`以查看这一切。

```
Option Explicit

Dim FSO
Set FSO = CreateObject( "Scripting.FileSystemObject" )

Dim oStream
Dim sData
Dim aData

Set oStream = fso.OpenTextFile("data.csv")
sData       = oStream.ReadAll
aData       = Split( sData, vbNewLine )

Dim sLine
sLine = aData(0)

Dim aContent
aContent = Split( sLine, "," )

Dim aNames()
Dim nArrayCount
nArrayCount = UBound( aContent )
ReDim aNames( nArrayCount )

Dim i

For i = 0 To nArrayCount
  aNames(i) = Replace( aContent( i ), " ", "_" )
  x "dim " & aNames(i) & "()"
Next

For j = 0 To nArrayCount
  x "redim " & aNames(j) & "( " & UBound( aData ) - 1 & " )"
Next

Dim j
Dim actual
actual = 0

For i = 1 To UBound( aData )
  sLine = aData( i )
  If sLine <> vbnullstring Then
    actual = actual + 1
    aContent = Split( sLine, "," )
    For j = 0 To nArrayCount
      x aNames(j) & "(" & i - 1 & ")=" & Chr(34) & aContent(j) & Chr(34)
    Next
  End If
Next

For j = 0 To nArrayCount
  x "redim preserve " & aNames(j) & "(" & actual - 1 & ")"
Next

For i = 0 To actual - 1
  For j = 0 To nArrayCount
    x "wscript.echo aNames(" & j & ")," & aNames(j) & "(" & i & ")"
  Next
Next

Sub x( s )
  'wscript.echo s
  executeglobal s
End Sub 
```

结果看起来像这样

```
>cscript "C:\Documents and Settings\Bruce\Desktop\datathing.vbs"
Dog_Names Woof
Dog_Ages 3
Collar_Size 4
Dog_Names Bowser
Dog_Ages 2
Collar_Size 5
Dog_Names Ruffy
Dog_Ages 4.5
Collar_Size 6
Dog_Names Angel
Dog_Ages 1
Collar_Size 7
Dog_Names Demon
Dog_Ages 7
Collar_Size 8
Dog_Names Dog
Dog_Ages 9
Collar_Size 2
>Exit code: 0    Time: 0.338 
```

# c - 如何在c中的多个文件使用的头文件中声明一个结构？

> ID：228684
> 
> 赞同：130
> 
> 时间：2008-10-23T05:58:53.307
> 
> 标签：c, file, header, structure

如果我有一个带有结构的 source.c 文件：

```
struct a { 
    int i;
    struct b {
        int j;
    }
}; 
```

这个结构如何在另一个文件（即`func.c`）中使用？

我应该创建一个新的头文件，在那里声明结构并将该头文件包含在其中`func.c`吗？

或者我应该在头文件中定义整个结构并将其包含在两者中`source.c`吗`func.c`？如何`extern`在两个文件中声明结构？

我`typedef`应该吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2008-10-23T06:47:43.147

### 如果这个结构要被其他文件func.c使用怎么办？

当文件（即func.c 文件）中使用类型时，它必须是可见的。最糟糕的方法是将其复制粘贴到每个需要它的源文件中。

正确的方法是将它放在头文件中，并在需要时包含此头文件。

### 我们是否应该打开一个新的头文件并在那里声明结构并将该头文件包含在 func.c 中？

这是我更喜欢的解决方案，因为它使代码高度模块化。我会将您的结构编码为：

```
#ifndef SOME_HEADER_GUARD_WITH_UNIQUE_NAME
#define SOME_HEADER_GUARD_WITH_UNIQUE_NAME

struct a
{ 
    int i;
    struct b
    {
        int j;
    }
};

#endif 
```

我会将使用此结构的函数放在同一个标​​头中（该函数在“语义上”是其“接口”的一部分）。

通常，我可以在结构名称之后命名文件，然后再次使用该名称来选择标题保护定义。

如果需要使用指向结构的指针来声明函数，则不需要完整的结构定义。一个简单的前向声明，如：

```
struct a ; 
```

就足够了，它减少了耦合。

### 或者我们可以在头文件中定义整个结构并将其包含在 source.c 和 func.c 中吗？

这是另一种方式，稍微简单一些，但模块化程度较低：一些只需要你的结构才能工作的代码仍然必须包含所有类型。

在 C++ 中，这可能会导致一些有趣的复杂情况，但是这超出了主题（没有 C++ 标签），所以我不会详细说明。

### 然后如何在两个文件中将该结构声明为 extern。?

[也许我没有明白这一点，但是 Greg Hewgill 在他的帖子How to declare a structure in a header that is to be used by multiple files in c? 中](https://stackoverflow.com/questions/228684/how-to-declare-a-structure-in-a-header-that-is-to-be-used-by-multiple-files-in-c#228691)有一个很好的答案？.

### 我们应该 typedef 它然后如何？

*   如果您使用的是 C++，请不要。
*   如果你使用 C，你应该。

原因是 C 结构管理可能很痛苦：您必须在使用它的任何地方声明 struct 关键字：

```
struct MyStruct ; /* Forward declaration */

struct MyStruct
{
   /* etc. */
} ;

void doSomething(struct MyStruct * p) /* parameter */
{
   struct MyStruct a ; /* variable */
   /* etc */
} 
```

虽然 typedef 将使您能够在没有 struct 关键字的情况下编写它。

```
struct MyStructTag ; /* Forward declaration */

typedef struct MyStructTag
{
   /* etc. */
} MyStruct ;

void doSomething(MyStruct * p) /* parameter */
{
   MyStruct a ; /* variable */
   /* etc */
} 
```

**重要**的是您仍然保留结构的名称。写作：

```
typedef struct
{
   /* etc. */
} MyStruct ; 
```

只会创建一个带有 typedef 名称的匿名结构，您将无法转发声明它。所以保持以下格式：

```
typedef struct MyStructTag
{
   /* etc. */
} MyStruct ; 
```

因此，您可以在任何想要避免添加 struct 关键字的地方使用 MyStruct，并且在 typedef 不起作用时仍然使用 MyStructTag（即前向声明）

### 编辑：

更正了关于 C99 结构声明的错误假设，正如[Jonathan Leffler](https://stackoverflow.com/users/15168/jonathan-leffler)正确评论的那样。

### 编辑 2018-06-01：

[Craig Barnes](https://stackoverflow.com/users/1471119/craig-barnes)在他的评论中提醒我们，你不需要为结构“tag”名称和它的“typedef”名称保留单独的名称，就像我在上面为了清楚起见所做的那样。

事实上，上面的代码可以写成：

```
typedef struct MyStruct
{
   /* etc. */
} MyStruct ; 
```

IIRC，这实际上是 C++ 在幕后使用其更简单的结构声明所做的，以使其与 C 兼容：

```
// C++ explicit declaration by the user
struct MyStruct
{
   /* etc. */
} ;
// C++ standard then implicitly adds the following line
typedef MyStruct MyStruct; 
```

回到 C，我已经看到了这两种用法（单独的名称和相同的名称），并且没有一个有我所知道的缺点，所以如果你不使用[C 单独的“命名空间”来为结构和其他符号](https://stackoverflow.com/questions/3793952/)使用相同的名称，那么使用相同的名称会使阅读更简单.

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-23T06:03:55.700

对于要在多个源文件中使用的结构定义，您绝对应该将其放在头文件中。然后将该头文件包含在任何需要该结构的源文件中。

该`extern`声明不用于结构定义，而是用于变量声明（即具有您已定义的结构类型的某些数据值）。如果要在多个源文件中使用相同的变量，请将其声明为`extern`头文件，如：

```
extern struct a myAValue; 
```

然后，在*一个*源文件中，定义实际变量：

```
struct a myAValue; 
```

如果您忘记这样做或不小心在两个源文件中定义了它，链接器会通知您。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-23T06:01:55.907

啊：

```
#ifndef A_H
#define A_H

struct a { 
    int i;
    struct b {
        int j;
    }
};

#endif 
```

好了，现在你只需要将 ah 包含到要使用此结构的文件中。

# python - 如何从有符号整数中获取十六进制字符串

> ID：228702
> 
> 赞同：19
> 
> 时间：2008-10-23T06:14:02.153
> 
> 标签：python

假设我有经典的 4 字节有符号整数，我想要类似的东西

```
print hex(-1) 
```

给我类似的东西

> 0xffffffff

实际上，上面给了我`-0x1`. 我正在用一些较低级别的语言磨磨蹭蹭，而 python 命令行又快又容易。

所以..有办法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-23T06:17:15.487

这可以解决问题：

```
>>> print(hex (-1 & 0xffffffff))
0xffffffff 
```

或者，总是返回固定大小的变体（可能有更好的方法来做到这一点）：

```
>>> def hex3(n):
...     return "0x%s"%("00000000%s"%(hex(n&0xffffffff)[2:-1]))[-8:]
...
>>> print hex3(-1)
0xffffffff
>>> print hex3(17)
0x00000011 
```

或者，由于 Ignacio 和 bobince，完全避免了 hex()：

```
def hex2(n):
    return "0x%x"%(n&0xffffffff)

def hex3(n):
    return "0x%s"%("00000000%x"%(n&0xffffffff))[-8:] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T07:03:23.910

试试这个功能：

```
'%#4x' % (-1 & 0xffffffff) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-14T06:39:10.290

采用

```
"0x{:04x}".format((int(my_num) & 0xFFFF), '04x') 
```

`my_num`所需的数字在哪里。

# sql - 奇怪的多对多和一对多关系

> ID：228705
> 
> 赞同：3
> 
> 时间：2008-10-23T06:16:00.293
> 
> 标签：sql, constraints

我知道我会投反对票，但我必须确定这是否合乎逻辑。

我有三个表A，B，C。B是用于在A和C之间建立多对多关系的表。但问题是A和C也直接以一对多关系相关

一位客户添加了以下要求：

从表B中获取信息，内联A和C，并在同一个查询中以一对多关系关联A和C

就像是：

[替代文字 http://img247.imageshack.us/img247/7371/74492374sa4.png](http://img247.imageshack.us/img247/7371/74492374sa4.png)

我尝试进行查询，但总是返回 0 行。客户坚持我能完成要求，但我对此表示怀疑。任何意见？

PS。我没有更具描述性的标题，有什么想法吗？

更新：感谢 rcar，在某些情况下，这可能是合乎逻辑的，以便了解学生上过的所有课程的历史记录（假设学生一次只能上一门课）

更新：有一个联系人表，一个包含每个联系人信息的表和关系表。要获取联系人的信息，我必须与 Information 建立 1:1 的关系，并且每个联系人都可以拥有喜欢和通讯录；这就是实现多对多关系的原因。

完整的想法是获取联系人的姓名和他的通讯录。现在我得到了客户的想法......我在查询时遇到了问题，基本上我正在尝试使用 jdecuyper 编写的查询，但正如他警告的那样，我没有得到任何数据

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T06:39:31.977

这是一个可行的方案。你可以在一个查询中加入一个表两次，通常给它分配一个不同的别名以保持事情的正确性。

例如：

```
SELECT s.name AS "student name", c1.className AS "student class", c2.className as "class list"
FROM s
JOIN many_to_many mtm ON s.id_student = mtm.id_student
JOIN c c1 ON s.id_class = c1.id_class
JOIN c c2 ON mtm.id_class = c2.id_class 
```

这将为您提供所有学生姓名和“硬编码”课程的列表，其中包含来自 many_to_many 表的所有课程。

也就是说，这个模式没有逻辑意义。据我所知，您希望学生能够拥有多个班级，因此 many_to_many 表应该是您希望找到与学生关联的班级的地方。如果表 s 中使用的 id_class 条目与 many_to_many 中的条目不同（例如，如果 s.id_class 指的是仅出现在该表中的 homeroom 类分配，而 many_to_many.id_class 指的是信用类并且不包括 homeroom 类），您最好将 c 拆分为两个表。

如果不是这种情况，我很难理解为什么你想要一个类硬连线到 s 表。

编辑：刚刚看到你的评论，这是一个虚构的模式来举个例子。在其他情况下，这可能是一种明智的做事方式。例如，如果您想跟踪公司位置，您可能有一个 Company 表、一个 Locations 表和一个 Country 表。Company 表可能有一个指向国家/地区的一对多链接，您可以在其中跟踪公司总部所在的国家/地区，但通过 Locations 的多对多链接可以跟踪公司拥有商店的每个地方。

如果您可以提供有关架构对您的客户真正代表什么的真实信息，那么我们可能更容易确定在这种情况下它是否合乎逻辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T06:40:38.200

也许是因为缺乏咖啡因，但我想不出想要这样做的正当理由。在您给出的示例中，您有学生、班级和一个将两者联系起来的表格。如果您考虑一下您希望查询做什么，用简单的英语，肯定它必须由`student`表或`class`表驱动。IE

*   选择学生 1245235 参加的所有课程
*   选择所有上 101 班的学生

你能更好地解释需求吗？如果没有，请告诉您的客户接受它。直接在学生和班级之间建立关系（A 和 C），这似乎是纯粹的疯狂，你已经有表 B 可以做到这一点......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T10:07:40.560

请记住，可以通过多对多来表示一对多关系，最简单的方法是在其中添加一个字段来指示关系的类型。然后你可以有一个“当前”记录和任意数量的“历史”记录。

顺便说一句，客户的“要求”是给定的吗？如果是这样，我想我会重新定义我与他们的关系：他们应该告诉我他们想要的“什么”（理想情况下，在商业领域的语言中，他们的问题是什么）并将“如何”留给我。如果他们确切地知道应该如何实现这个东西，那么我倾向于在编辑器中打开源代码并将它们留给它！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T19:20:36.277

我假设 s.id_class 表示学生当前的班级，而不是她过去上过的班级。

rcar 显示的解决方案有效，但它在每一行上重复 c1.className。

这是一种不重复信息的替代方法，它使用更少的连接。您可以使用表达式将 s.id_class 与通过 mtm 表匹配的当前 c.id_class 进行比较。

```
SELECT s.name, c.className, (s.id_class = c.id_class) AS is_current
FROM s JOIN many_to_many AS mtm ON (s.id_student = mtm.id_student)
  JOIN c ON (c.id_class = mtm.id_class); 
```

所以 is_current 将在一行上为 1（真），在所有其他行上为 0（假）。或者，您可以使用`CASE`构造输出更多信息：

```
SELECT s.name, c.className, 
  CASE WHEN s.id_class = c.id_class THEN 'current' ELSE 'past' END AS is_current
FROM s JOIN many_to_many AS mtm ON (s.id_student = mtm.id_student)
  JOIN c ON (c.id_class = mtm.id_class); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T06:37:41.530

这似乎没有意义。像这样的查询：

```
SELECT * FROM relAC RAC
  INNER JOIN tableA A ON A.id_class = RAC.id_class 
  INNER JOIN tableC C ON C.id_class = RAC.id_class 
    WHERE A.id_class = B.id_class 
```

可以生成一组数据但不一致。或者，我们可能遗漏了有关这 3 个表的内容和关系的一些重要信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T10:28:25.150

我个人从未听过客户的要求听起来像：

> 从表B中获取信息，内联A和C，并在同一个查询中以一对多关系关联A和C

看起来这就是您将需求翻译成的内容。您能否用简单的英语指定要求，作为您的客户想要得到的结果？

# mfc - 如何在 MFC 的 CListCtrl 中插入位图或其他图像对象？

> ID：228711
> 
> 赞同：0
> 
> 时间：2008-10-23T06:21:21.437
> 
> 标签：mfc, listview

我想在 listctrl 中列出一组照片的缩略图。但实现此目的的唯一方法是使用 setImageList 方法将图像列表绑定到 CListCtrl 对象并插入如下项目：InsertItem (int nItem, LPCTSTR lpszitem, int nImage)。我还必须通过 ModifyStyle(LVS_TYPEMASK, LVS_ICON) 修改 listctrl 的样式，以强制它显示每个项目的图标。

我不认为这种方法是实现我的目标的好方法。我可以直接在 CListCtrl 中添加位图或其他图像对象吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T06:33:24.470

为什么你认为这不是一个好方法？您的其他选择是使其成为所有者绘制的控件并自己渲染图像，或者通过 CListCtrl::SetCallbackMask 对图像使用回调。

列表控件使用图像列表是有原因的；位图以对呈现列表控件最有效的方式存储。你会很难做得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T06:47:48.683

鉴于您需要这些扩展功能，听起来您必须使用所有者绘制。一个很好的例子是[here](http://www.codeproject.com/KB/list/CGridListCtrlEx.aspx)。它没有显示如何绘制图像，但是一旦你设置了所有者绘制过程，你应该能够使用典型的 BitBlts 来绘制图像。

# .net - 这是启动和管理没有经验的 .net 敏捷项目的最佳教程、书籍和软件

> ID：228721
> 
> 赞同：3
> 
> 时间：2008-10-23T06:28:31.483
> 
> 标签：.net, scrum, methodology, extreme-programming, agile

这是最好的教程、书籍、软件和实践，可以在没有经验的情况下以敏捷的方式启动和管理一个基于 .net 的新开发项目。哪种方法更容易采用 XP|Scrum？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T08:05:07.157

我第一次了解 XP 是在 2004 年，它彻底改变了我的编程世界观。XP 非常平易近人，它鼓励您“使用有效的方法”，您可以从小处着手，然后按自己的方式进行操作。

我对 SCRUM 了解不多。但我可以说我讨厌使用“sprint”这个词，因为它有不好的含义。SCRUM 故意划清界限，不建议任何工程实践，并试图成为一种纯粹的管理技术，表面上将工程决策留给团队。

我建议您获得一本[开创性的 XP 书籍](https://rads.stackoverflow.com/amzn/click/com/0201616416)，您可以在几天内轻松阅读它，之后您将能够从更明智的角度做出决定。如果您阅读了这本书并且喜欢您所阅读的内容，那么请选择 XP。如果您在阅读（部分或全部）这本书后决定不喜欢 XP，那么您可以继续做其他事情。如果你还不想花钱买这本书，可以去谷歌搜索“极限编程”并通读 INET 上的资料——网上有*很多*。

[http://www.extremeprogramming.org/](http://www.extremeprogramming.org/)可与 Kent Beck 的书媲美，以获取有关 XP 的基本信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T20:26:37.303

Scrum 作为一种纯粹的项目管理方法，为您提供了很多可以吊死自己的绳索，以及必要的反馈，以便及早注意到您正在这样做并开始采取纠正措施。另一方面，XP 增加了许多高度迭代方法所必需的工程实践。哪一种适合你，主要看你个人的喜好。

我强烈推荐《敏捷开发的艺术》一书来帮助您入门。对于技术方面，“敏捷原则、模式和实践”可能是一个很好的补充。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T21:56:18.003

来自 henrik Kniberg 的 Trenches 中的 Scrum 和 XP 在[InfoQ](http://www.infoq.com)上可用。另一个是 Mike Cohn 的敏捷估计和规划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:42:21.193

我还建议您看一下截屏视频系列[Autumn Of Agile](http://www.autumnofagile.net/) - 尤其是前几个视频（后面的视频更多地涉及事物的编码方面（假设您质疑您对事物的管理方面更感兴趣）。

其次，我可能会建议您加入以下邮件列表（并寻找其他人加入）：

[http://tech.groups.yahoo.com/group/leanagile/](http://tech.groups.yahoo.com/group/leanagile/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:11:56.670

你问错问题了。

Scrum 肯定更容易采用，但 XP 更有可能使您的项目成功。如果您不熟悉敏捷，则需要练习不同的工程实践。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T17:31:18.093

一本关于 SCRUM 的好书：使用 Scrum 进行敏捷软件开发，作者 Ken Schwaber 和 Mike Beedle。 [http://www.amazon.com/Agile-Software-Development-Scrum/dp/0130676349](https://rads.stackoverflow.com/amzn/click/com/0130676349)

至于软件：

在我的工作中，我们一直使用 Target Process ( [http://targetprocess.com/](http://targetprocess.com/) ) 作为我们的计划和错误跟踪工具。它有很好的可扩展性和源代码控制选项，我们已将其插入 VS2008。

它通过支持积压的用户故事、冲刺和非常好的工作量估算工具来支持 SCRUM 方法。

我们对此非常满意。

# logging - Silverlight 日志记录框架和/或最佳实践

> ID：228723
> 
> 赞同：25
> 
> 时间：2008-10-23T06:29:58.487
> 
> 标签：logging, silverlight-2.0

现在 Silverlight 2 终于发货了。我想知道是否有人为它整理了任何日志框架，也许像[企业库日志](http://msdn.microsoft.com/en-us/library/ff647183.aspx)或[log4net](http://logging.apache.org/log4net/)之类的？我对可以执行跟踪客户端并将消息记录到服务器的东西很感兴趣。

到目前为止，我发现的唯一项目是[Clog](http://clog.codeplex.com/) on [CodeProject](http://www.codeproject.com/KB/silverlight/SilverlightLogging.aspx)。有人用过这个吗？你对此有什么想法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-07T11:08:12.470

如果您愿意暂时摘下宇航员的头盔，下面是我为 Silverlight 编写的轻量级记录器，用于客户端日志记录（主要用于 WCF 操作，但可能用于任何错误）。

它最初用于 iPhone 应用程序的 Monotouch，并已适用于`IsolateStorage`. 如果需要，您可以使用该`Read`方法在文本框中显示。在 SL4 中测试。

```
/// <summary>
/// A lightweight logging class for Silverlight.
/// </summary>
public class Log
{
    /// <summary>
    /// The log file to write to. Defaults to "dd-mm-yyyy.log" e.g. "13-01-2010.log"
    /// </summary>
    public static string LogFilename { get; set; }

    /// <summary>
    /// Whether to appendthe calling method to the start of the log line.
    /// </summary>
    public static bool UseStackFrame { get; set; }

    static Log()
    {
        LogFilename = string.Format("{0}.log", DateTime.Today.ToString("dd-MM-yyyy"));
        UseStackFrame = false;
    }

    /// <summary>
    /// Reads the entire log file, or returns an empty string if it doesn't exist yet.
    /// </summary>
    /// <returns></returns>
    public static string ReadLog()
    {
        string result = "";
        IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForSite();

        if (storage.FileExists(LogFilename))
        {
            try
            {
                using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(LogFilename,FileMode.OpenOrCreate,storage))
                {
                    using (StreamReader reader = new StreamReader(stream))
                    {
                        result = reader.ReadToEnd();
                    }
                }
            }
            catch (IOException)
            {
                // Ignore
            }
        }

        return result;
    }

    /// <summary>
    /// Writes information (not errors) to the log file.
    /// </summary>
    /// <param name="format">A format string</param>
    /// <param name="args">Any arguments for the format string.</param>
    public static void Info(string format, params object[] args)
    {
        WriteLine(LoggingLevel.Info, format, args);
    }

    /// <summary>
    /// Writes a warning (non critical error) to the log file
    /// </summary>
    /// <param name="format">A format string</param>
    /// <param name="args">Any arguments for the format string.</param>
    public static void Warn(string format, params object[] args)
    {
        WriteLine(LoggingLevel.Warn, format, args);
    }

    /// <summary>
    /// Writes a critical or fatal error to the log file.
    /// </summary>
    /// <param name="format">A format string</param>
    /// <param name="args">Any arguments for the format string.</param>
    public static void Fatal(string format, params object[] args)
    {
        WriteLine(LoggingLevel.Fatal, format, args);
    }

    /// <summary>
    /// Writes the args to the default logging output using the format provided.
    /// </summary>
    public static void WriteLine(LoggingLevel level, string format, params object[] args)
    {
        string message = string.Format(format, args);

        // Optionally show the calling method
        if (UseStackFrame)
        {
            var name = new StackFrame(2, false).GetMethod().Name;

            string prefix = string.Format("[{0} - {1}] ", level, name);
            message = string.Format(prefix + format, args);
        }

        Debug.WriteLine(message);
        WriteToFile(message);
    }

    /// <summary>
    /// Writes a line to the current log file.
    /// </summary>
    /// <param name="message"></param>
    private static void WriteToFile(string message)
    {
        try
        {
            IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForSite();
            bool b = storage.FileExists(LogFilename);

            using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(LogFilename,FileMode.Append,storage))
            {
                using (StreamWriter writer = new StreamWriter(stream))
                {
                    writer.WriteLine("[{0}] {1}", DateTime.UtcNow.ToString(), message);
                }
            }
        }
        catch (IOException)
        {
            // throw new Catch22Exception();
        }
    }
}

/// <summary>
/// The type of error to log.
/// </summary>
public enum LoggingLevel
{
    /// <summary>
    /// A message containing information only.
    /// </summary>
    Info,
    /// <summary>
    /// A non-critical warning error message.
    /// </summary>
    Warn,
    /// <summary>
    /// A fatal error message.
    /// </summary>
    Fatal
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T06:40:21.280

如果您只想将调试消息输出到控制台。您可以使用浏览器的 console.log 机制。我为此编写了一个扩展方法。你可以在[我的博客](http://kodierer.blogspot.com/2009/05/silverlight-logging-extension-method.html)上找到。

```
 // http://kodierer.blogspot.com.es/2009/05/silverlight-logging-extension-method.html
    public static string Log(string message)
    {
        var msgLog = "";
        try
        {

            HtmlWindow window = HtmlPage.Window;

            //only log if a console is available
            var isConsoleAvailable = (bool)window.Eval("typeof(console) != 'undefined' && typeof(console.log) != 'undefined'");

            if (!isConsoleAvailable) return "isConsoleAvailable " + isConsoleAvailable;

            var createLogFunction = (bool)window.Eval("typeof(ssplog) == 'undefined'");
            if (createLogFunction)
            {
                // Load the logging function into global scope:
                string logFunction = @"function ssplog(msg) { console.log(msg); }";
                string code = string.Format(@"if(window.execScript) {{ window.execScript('{0}'); }} else {{ eval.call(null, '{0}'); }}", logFunction);
                window.Eval(code);
            }

            // Prepare the message
            DateTime dateTime = DateTime.Now;
            string output = string.Format("{0} - {1} - {2}", dateTime.ToString("u"), "DEBUG", message);

            // Invoke the logging function:
            var logger = window.Eval("ssplog") as ScriptObject;
            logger.InvokeSelf(output);
        }
        catch (Exception ex)
        {
            msgLog = "Error Log " + ex.Message;
        }
        return msgLog;

    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T22:57:12.620

对于我们编写的产品，我将自己深入研究类似的东西。我正在考虑使用 PostSharp for Silverlight 来添加客户端日志记录作为一个方面。

我之前在完整的 .NET Framework 和 Compact Framework 下使用 NLog 项目取得了巨大成功，所以我很可能会采用现有的框架代码并添加一些日志记录目标：

*   一个标准的 System.Diagnostics 目标，用于启用使用 DebugView 等进行捕获。
*   一个类似于 NLog 中的异步 Web 服务目标。
*   具有延迟传输到服务器语义的隔离存储目标。

我简要地查看了 Clog，它似乎存在一个主要缺陷——它无法记录连接失败。因此，假设您的 Web 服务器一直在线，是的，它会工作，但是当上游或服务器本身出现问题时，日志记录数据将全部丢失，甚至可能使您的应用程序崩溃。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-24T09:04:32.517

你也可以使用这个：[http ://silverlightlogging.codeplex.com/](http://silverlightlogging.codeplex.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T15:41:01.697

我最终从头开始编写了一个新的日志框架来解决这个缺陷。我创建了一个本地队列，它将获取日志/跟踪消息，然后进行过滤并将它们发送到服务器。然后队列将由独立存储支持，因此即使客户端为该会话永久离线，消息也会在它重新在线时发送。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-14T03:10:37.963

我正在使用 JavaScript 窗口并使其在 Silverlight 中可编写脚本。对于“生产”，我可以关闭此窗口，但仍将日志行保存到内存中，然后如果出现问题，将其发送到服务器。这样我就可以两全其美 - 在客户端上进行简单的实时日志记录以进行调试，并为用户可能遇到的远程事后情况记录日志。

# vb.net - VB.net 中的水晶报表

> ID：228724
> 
> 赞同：0
> 
> 时间：2008-10-23T06:30:19.033
> 
> 标签：vb.net, crystal-reports, crosstab

我在 vb.net 中使用水晶报表创建报表。

该报告包含一个交叉表，我有 3 个数据：1\. 经销商 - 行字段 2\. 月 - 列 3\. 数量销售 - 汇总字段

如何根据“销售数量 - 汇总”字段按升序排列？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T17:38:39.513

根据您使用它的方式，您可以调整输入以对数据进行升序排序。

> ```
> SELECT customer, sum(amountdue) AS total FROM invoices 
> GROUP BY customer
> ORDER BY total ASC 
> ```

如果您以无法更改该信息的方式进行操作，您能否提供更多见解？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T17:43:12.203

请注意，当按其值对交叉表进行排序时，其他 Business Objects 产品会根据汇总字段的总计进行排序。我忘记了 CR 是如何做到的。

# asp.net - 动态设置两个浮动DIVS的高度

> ID：228726
> 
> 赞同：1
> 
> 时间：2008-10-23T06:30:40.747
> 
> 标签：asp.net, javascript, jquery

使用 VS2008 完成编码 我的页面中有两个 div，即“dvLeftContent”和“dvRightContent”。我无法静态设置页面的高度，因为“dvRightContent”在各个页面上具有可变高度（此处使用母版页）是否有客户端函数（javascript 或 jquery）获取右侧 div 的高度并将其分配给左侧分区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-23T06:47:32.820

使用 jQuery：

```
$("#dvRightContent").bind("resize", function(){
    $("#dvLeftContent").css('height', $("#dvRightContent").css('height')); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T08:40:55.180

谢谢米卡威特曼。一些小改动

```
 $("#dvRightContent").resize(function(){
        $("#dvLeftContent").css("height", ($("#dvRightContent").attr("offsetHeight") - 250 ) +"px");
    }); 
```

这是因为在这种情况下，高度只会给出“自动”，因为它的设置是这样的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T08:54:13.873

还有一个 jQuery 插件可以为您完成这项工作：[Equalize](http://plugins.jquery.com/project/equalizeCols)

它处理 rightcol 大于 leftcol 或 leftcol 大于 rightcol 的情况。它还允许您指定 leftcol 或 rightcol 中的哪个元素应该添加空格。

# php - 在 Windows Vista 上安装 PHP、Apache 2.2.10

> ID：228728
> 
> 赞同：1
> 
> 时间：2008-10-23T06:31:18.170
> 
> 标签：php, apache

我试图让 PHP 在我的 vista 家用机器上工作，但我遇到了奇怪的问题。首先，我遇到了文件权限问题，为此我禁用了 Vista 的 UAC。现在我无法让 PHP 解释器工作。

我已经按照一些教程进行了所有必要的更改，但我仍然无法让它工作。

教程位于：[http ://www.tanguay.info/wamp/installPhp5.php5](http://www.tanguay.info/wamp/installPhp5.php5)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T06:37:14.400

试试[XAMPP](http://www.apachefriends.org/en/xampp.html)。我在家里的一台 Vista 机器上使用它，安装后它运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T07:13:29.037

[WAMPServer](http://www.wampserver.com/) is also a good option. You can easily enable/disable both PHP extensions and Apache 2 modules. Everything is set up somewhat securely (only local access to the serve), and you get phpMyAdmin already set up.

Only thing I've ever missed is Memcached, but that is fairly easy to set up on your own.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T11:38:02.763

我在 Vista 上安装 PHP 和 Apache 的唯一问题是，您需要确保在编辑 httpd.conf 时，您是以管理员身份对其进行编辑，否则文件会以兼容模式保存。

要克服这个问题，只需在开始菜单中键入 notepad++ 或其他任何内容，右键单击该项目并以管理员身份运行。然后从应用程序中打开文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-23T06:39:21.137

您可以将 FastCGI 用于 IIS 7。我也在使用它，而且效果很好！！

[快速CGI](http://learn.iis.net/page.aspx/246/using-fastcgi-to-host-php-applications-on-iis-70/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-23T08:23:28.710

你可以试试[Zend Core](http://www.zend.com/en/products/core/downloads)

它适用于 IIS 和 Apache（它包括 Apache 的安装）

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-10-23T06:51:48.677

iis7 是最好的网络服务器之一，尤其是对于 php，如果你不能让它工作，那意味着你需要足够的谷歌，因为将 php/apache 问题归咎于 Vista 是不合逻辑的

# python - 如何在 Python 中遍历字符串？

> ID：228730
> 
> 赞同：40
> 
> 时间：2008-10-23T06:32:30.743
> 
> 标签：python

例如，假设我想列出字符串中每个字母的频率。最简单的方法是什么？

这是我正在考虑的一个例子......问题是如何使 allTheLetters 等于所说的字母，而不需要像 allTheLetters =“abcdefg...xyz”这样的东西。在许多其他语言中，我可以只做 letter++ 并在字母表中递增，但到目前为止，我还没有在 python 中找到这样做的方法。

```
def alphCount(text):
  lowerText = text.lower()
  for letter in allTheLetters:  
    print letter + ":", lowertext.count(letter) 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-23T07:28:05.373

您提出的问题（如何遍历字母表）与您要解决的问题（如何计算字符串中字母的频率）不是同一个问题。

正如其他海报所建议的那样，您可以使用 string.lowercase：

```
import string
allTheLetters = string.lowercase 
```

要按照您“习惯”的方式做事，将字母视为数字，您可以使用“ord”和“chr”函数。绝对没有理由完全这样做，但也许它更接近你真正想要弄清楚的：

```
def getAllTheLetters(begin='a', end='z'):
    beginNum = ord(begin)
    endNum = ord(end)
    for number in xrange(beginNum, endNum+1):
        yield chr(number) 
```

您可以告诉它做正确的事，因为此代码打印`True`：

```
import string
print ''.join(getAllTheLetters()) == string.lowercase 
```

但是，要解决您实际尝试解决的问题，您需要使用字典并随时收集字母：

```
from collections import defaultdict    
def letterOccurrances(string):
    frequencies = defaultdict(lambda: 0)
    for character in string:
        frequencies[character.lower()] += 1
    return frequencies 
```

像这样使用：

```
occs = letterOccurrances("Hello, world!")
print occs['l']
print occs['h'] 
```

这将分别打印“3”和“1”。

请注意，这也适用于 unicode：

```
# -*- coding: utf-8 -*-
occs = letterOccurrances(u"héĺĺó, ẃóŕĺd!")
print occs[u'l']
print occs[u'ĺ'] 
```

如果您要在 unicode 上尝试其他方法（通过每个字符递增），您将等待很长时间；有数百万个Unicode字符。

要按照以下方式实现您的原始功能（按字母顺序打印每个字母的计数）：

```
def alphCount(text):
    for character, count in sorted(letterOccurrances(text).iteritems()):
        print "%s: %s" % (character, count)

alphCount("hello, world!") 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-23T06:49:27.027

> 问题是如何在没有类似 allTheLetters = "abcdefg...xyz" 的情况下使 allTheLetters 等于所述字母

这实际上是由字符串模块提供的，你不必自己手动输入；）

```
import string

allTheLetters = string.ascii_lowercase

def alphCount(text):
  lowerText = text.lower()
  for letter in allTheLetters:  
    print letter + ":", lowertext.count(letter) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-23T07:04:14.033

如果您只想对字符串进行频率计数，请尝试以下操作：

```
s = 'hi there'
f = {}

for c in s:
        f[c] = f.get(c, 0) + 1

print f 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-28T18:27:08.503

对于计数对象，*明显*的解决方案是[计数器](http://docs.python.org/dev/library/collections.html#collections.Counter)

```
from collections import Counter
import string

c = Counter()
for letter in text.lower():
    c[letter] += 1

for letter in string.lowercase:
    print("%s: %d" % (letter, c[letter])) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-23T06:35:04.687

像这样的东西？

```
for letter in range(ord('a'), ord('z') + 1):
  print chr(letter) + ":", lowertext.count(chr(letter)) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-23T06:50:46.370

你的意思是使用：

```
import string
string.ascii_lowercase 
```

然后，

```
counters = dict()
for letter in string.ascii_lowercase:
    counters[letter] = lowertext.count(letter) 
```

所有小写​​字母都被考虑在内，缺少的计数器将具有零值。

使用生成器：

```
counters = 
    dict( (letter,lowertext.count(letter)) for letter in string.ascii_lowercase ) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-23T07:25:01.793

主要问题是“遍历字母表”：

```
import string
for c in string.lowercase:
    print c 
```

如何在不计算非字母字符的情况下以一定的效率获得字母频率：

```
import string

sample = "Hello there, this is a test!"
letter_freq = dict((c,0) for c in string.lowercase)

for c in [c for c in sample.lower() if c.isalpha()]:
    letter_freq[c] += 1

print letter_freq 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-08T00:09:51.997

这个怎么样，使用字母、数字和标点符号（都可以用来形成一个 Django 键）：

```
import random
import string

chars = string.letters + string.digits + string.punctuation
chars_len = len(chars)
n = 40

print(''.join([chars[random.randint(0, chars_len)] for i in range(n)])) 
```

示例结果：coOL:V!D+P,&S*hzbO{a0_6]2!{4|OIbVuAbq0:

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-21T11:50:55.187

只需使用：

```
import string
string.lowercase  
string.uppercase 
```

或者

```
string.letters[:26]  
string.letters[26:] 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-05-30T17:10:35.810

这就是我所做的：

```
import string
for x in list(string.lowercase):
    print x 
```

# .net - .net 的 CUDA？

> ID：228743
> 
> 赞同：27
> 
> 时间：2008-10-23T06:40:31.180
> 
> 标签：.net, interop, pinvoke, cuda, language-binding

我知道有很多 CUDA 语言绑定，比如 PyCUDA，但是 .Net 有什么*好的*绑定吗？我见过的只有[这一个](http://www.gass-ltd.co.il/en/products/cuda.net/)，但我想知道是否还有其他的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-29T01:13:47.867

这是另一个库：http: [//sourceforge.net/projects/brahma-fx/](http://sourceforge.net/projects/brahma-fx/)

*编辑*：我一直在查看您最初列出的项目的文档，并且可以说界面让我思考：使用 .Net 有什么意义。我列出的项目具有更简洁的界面，但没有文档。您列出的项目似乎更专注于开发路径（最近的 2.1 版本），但 Brahma 的 SVN 并不太旧（5 周）。

另一张海报列出了加速器框架。它看起来*很有*前途，虽然它的许可证是非商业的（如果你打算将它用于任何商业工作，你必须联系他们），当我安装它时，它说它安装正确，我在我的系统上找不到它（这可能是 Vista 问题）！

**编辑**：我查看了各种库，可以说这是我的“建议”：

1.  如果您打算使用 LINQ 并且仅使用 .Net 3.5，请使用 Brahma。
2.  如果您的目标是非商业性的，请使用另一张海报提供的加速器项目（我相信是蒂姆）。它比您提到的项目更高级别。
3.  如果您不关心底层细节，但需要非常活跃的项目和文档，那么请选择您列出的项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-28T04:09:19.790

微软研究院有一个名为“加速器”的项目 [http://research.microsoft.com/apps/pubs/default.aspx?id=70250](http://research.microsoft.com/apps/pubs/default.aspx?id=70250)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-07-23T18:53:25.957

这是另一个[http://www.hybriddsp.com/Products/CUDAfyNET.aspx](http://www.hybriddsp.com/Products/CUDAfyNET.aspx)

自动将 .NET 代码转换为 CUDA C，有相当不错的示例包

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-24T23:34:42.193

签出这两个包装器：

首先是允许使用 .NET 语言（如 C#、F# 和 VB.NET）进行编程的 Tidepowerd* [http://www.tidepowerd.com/product](http://www.tidepowerd.com/product)

第二个 CUDA.NET da Hoopoe，
[http://www.hoopoe-cloud.com/Solutions/cuda.net/](http://www.hoopoe-cloud.com/Solutions/cuda.net/)

两者都在 stackoverflow 上进行了讨论，并在他们的网站上提供了示例代码的建议。我想这会对你有所帮助。

# java - 如何将标签文件打包到 jar 中？

> ID：228755
> 
> 赞同：5
> 
> 时间：2008-10-23T06:47:37.187
> 
> 标签：java, jar, package, tagfile

如何将标记文件打包到 jar 中，以便在多个项目中重复使用？

# asp.net - Application_Start 在工作站上工作正常，部署时不调用

> ID：228770
> 
> 赞同：4
> 
> 时间：2008-10-23T06:52:12.047
> 
> 标签：asp.net, global-asax, application-start

我有一个应用程序在我的开发工作站上运行良好，但在将应用程序部署到实时环境时失败。似乎 Application_Start 没有在实时环境中被调用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T06:52:26.927

我可以通过删除我们测试服务器上网站根目录中的 PrecompiledApp.config 文件来修复它。我猜该文件是该项目是网站项目时的保留。我最近将它转换为一个 Web App 项目。因此，如果您正在构建 Web App 项目，请确保您的目标服务器上没有 PrecompiledApp.config 文件。

# c# - .NET Web 服务和 BackgroundWorker 线程

> ID：228775
> 
> 赞同：14
> 
> 时间：2008-10-23T06:54:59.247
> 
> 标签：c#, asp.net, multithreading, backgroundworker

我正在尝试在 web 服务方法中做一些异步的东西。假设我有以下 API 调用：[http ://www.example.com/api.asmx](http://www.example.com/api.asmx)

该方法称为*GetProducts()*。

在这个 GetProducts 方法中，我做了一些事情（例如，从数据库中获取数据），然后在我返回结果之前，我想做一些异步的事情（例如，给我发一封电子邮件）。

所以这就是我所做的。

```
[WebMethod(Description = "Bal blah blah.")]
public IList<Product> GetProducts()
{
    // Blah blah blah ..
    // Get data from DB .. hi DB!
    // var myData = .......
    // Moar clbuttic blahs :)  (yes, google for clbuttic if you don't know what that is)

    // Ok .. now send me an email for no particular reason, but to prove that async stuff works.
    var myObject = new MyObject();
    myObject.SendDataAsync();

    // Ok, now return the result.
    return myData;
    }
}

public class TrackingCode
{
    public void SendDataAsync()
    {
        var backgroundWorker = new BackgroundWorker();
        backgroundWorker.DoWork += BackgroundWorker_DoWork;
        backgroundWorker.RunWorkerAsync();
        //System.Threading.Thread.Sleep(1000 * 20);
    }

    private void BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        SendEmail();
    }
} 
```

现在，当我运行此代码时，永远不会发送电子邮件。如果我取消注释 Thread.Sleep .. 然后发送电子邮件。

那么......为什么后台工作线程被拆除了？它依赖于父线程吗？这是我应该在 asp.net Web 应用程序中执行后台或分叉线程的错误方式吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-23T07:08:48.970

`BackgroundWorker`当您需要同步回（例如）UI* 线程时很有用，例如出于相似性原因。在这种情况下，似乎简单地使用`ThreadPool`就足够了（而且更简单）。如果您的流量很大，那么生产者/消费者队列可能会允许更好的节流（这样您就不会淹没在线程中） - 但我怀疑`ThreadPool`这里会很好......

```
public void SendDataAsync()
{
    ThreadPool.QueueUserWorkItem(delegate
    {
        SendEmail();
    });
} 
```

另外 - 我不太确定你想通过睡觉来达到什么目的？这只会占用一个线程（不使用 CPU，但也没有好处）。需要详细说明吗？*看起来*您正在暂停您的实际网页（即睡眠发生在网页线程上，而不是电子邮件线程上）。你想在这里做什么？

*=实际上，它将使用任何同步上下文

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T23:28:20.653

再生产者/消费者；基本上 - 只是值得保持*某种*油门。在最简单的级别上，`Semaphore`可以使用 a （与常规 一起`ThreadPool`）将事情限制在已知的工作量内（以避免使线程池饱和）；但是生产者/消费者队列可能会更有效率和管理。

Jon Skeet 在[这里](http://www.yoda.arachsys.com/csharp/miscutil/)有这样的队列( `CustomThreadPool`)。如果你愿意，我可能会写一些关于它的笔记。

就是说：如果您正在调用外部网站，您很可能会在网络 IO / 完成端口上等待很多；因此，您可以拥有稍多的线程......显然（相比之下）如果工作受 CPU 限制，那么拥有比 CPU 内核更多的线程是没有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T07:20:03.737

它可能会被拆除，因为 20 秒后，该 BackgroundWorker 实例可能会被垃圾收集，因为它没有引用（超出范围）。

# c++ - CONFUSED -- c++ 3rd 方库，c++ 新手

> ID：228781
> 
> 赞同：3
> 
> 时间：2008-10-23T07:00:50.593
> 
> 标签：c++, qt

(mingw32, windows xp) 你好，我正在尝试从 Java 迁移到 C++。我对查找、安装和编译非标准 c++ 库感到困惑和沮丧。在 Java 中，它非常方便，它们将 Java 标准 api 中所需的所有功能和文档都塞满了。是否有基本 c++ 库的列表，例如线程、gui、网络、图像\音频处理、xml 等。在一个地方？或者可能，作为单个包装提供？

我尝试安装 QT 库数周，它甚至无法编译。在 Java 中，我曾经通过反复试验来学习功能的新方面，但如果我一开始就无法获取和运行新的 api，那将是不可能的。

拜托，我需要你的建议，最初我想摆脱 Java 的抽象，但现在我只想在我决定自己开枪之前能够使用 c++。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T07:20:12.287

The C++ standard library is extremely light. It contains nowhere near the functionality offered by the Java runtimes or by the .NET CLR.

The [Boost](http://www.boost.org/) libraries add a whole bunch of functionality to C++, but not much (if any) in the area of user interface.

For UI, there's the question of which platform you're targetting. If it's Win32, then you can use the straight Win32 API (mostly designed for C, but there are some C++ wrappers for parts of it). If you want cross-platform, then you're looking at QT or GTK (although there are others).

But, as Andrew already said: "why do you want to learn C++ anyway?". Don't get me wrong: I program in C++ for a living, and actually enjoy it (although I'm beginning to suspect a case of Stockholm Syndrome). If I had to start again, I'd go with a more modern language and environment (Java or C#; or Ruby or Python).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T17:02:30.690

我的建议是：一步一步来。

首先，弄清楚如何在代码中包含预构建的库。我建议从[ZLib](http://www.zlib.net/)开始（它有一个非常容易使用的设计，而且它也是一个有用的工具）。一旦你让预建库工作，删除它并尝试从源代码编译 ZLib。如果您在任何时候需要帮助，请在 Stack Overflow 上询问，我们会帮您完成。

当你开始工作时，你应该已经掌握了编译和安装 Qt 所需的所有知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T08:06:35.607

线程、XML、网络、一些图像生成、编码和处理[——boost](http://boost.org)提供了这些。至于 XML，例如[Arabica](http://www.jezuk.co.uk/cgi-bin/view/arabica) - 它通过用漂亮的标准 C++ 气味包装特定于平台的库来抽象出它们。

GUI部分是一个不同的问题。

有 Qt、wxWidgets、带有 c++ 绑定 (gtkmm) 的 gtk、每个平台的本地库及其 C++ 包装器（WTL 是 Win32 的优秀库），但随着 C++ 标准的发展和提升正在成为标准的一部分（C++ 0x 即将推出），没有任何 GUI 框架可以利用这些标准工具并引入自己的工具。不过，他们的工作做得很好。

# sql-server-2005 - 管理网站“事件”数据库

> ID：228782
> 
> 赞同：6
> 
> 时间：2008-10-23T07:01:14.897
> 
> 标签：sql-server-2005

我应该如何管理引用站点“事件”的表。即用户在我用于跟踪的网站上进行的某些活动。我希望能够在用户的不同活动和他们所做的事情之间进行各种数据挖掘和关联。

仅今天，我就在我的 SiteEvent 表中添加了 107,000 行。我不认为这是可持续的！

数据库是 SQL Server。我主要指的是有关管理大量数据的最佳实践活动。

例如 ：

*   我应该将这些表单独保存在数据库中吗？如果我需要加入其他表，这可能是个问题。目前我只有一个包含所有内容的数据库。
*   我应该如何清除旧记录。我想确保我的 db 文件不会继续增长。
*   备份和截断日志的最佳实践
*   添加额外的索引会显着增加有这么多记录的数据库的大小吗？
*   我在 SQL Server 中需要做的任何其他事情可能会在以后回来咬我？

仅供参考：这些是表格

```
CREATE TABLE [dbo].[SiteEvent](
    [SiteEventId] [int] IDENTITY(1,1) NOT NULL,
    [SiteEventTypeId] [int] NOT NULL,
    [SiteVisitId] [int] NOT NULL,
    [SiteId] [int] NOT NULL,
    [Date] [datetime] NULL,
    [Data] [varchar](255) NULL,
    [Data2] [varchar](255) NULL,
    [Duration] [int] NULL,
    [StageSize] [varchar](10) NULL, 
```

和

```
CREATE TABLE [dbo].[SiteVisit](
    [SiteVisitId] [int] IDENTITY(1,1) NOT NULL,
    [SiteUserId] [int] NULL,
    [ClientGUID] [uniqueidentifier] ROWGUIDCOL  NULL CONSTRAINT [DF_SiteVisit_ClientGUID]  DEFAULT (newid()),
    [ServerGUID] [uniqueidentifier] NULL,
    [UserGUID] [uniqueidentifier] NULL,
    [SiteId] [int] NOT NULL,
    [EntryURL] [varchar](100) NULL,
    [CampaignId] [varchar](50) NULL,
    [Date] [datetime] NOT NULL,
    [Cookie] [varchar](50) NULL,
    [UserAgent] [varchar](255) NULL,
    [Platform] [int] NULL,
    [Referer] [varchar](255) NULL,
    [RegisteredReferer] [int] NULL,
    [FlashVersion] [varchar](20) NULL,
    [SiteURL] [varchar](100) NULL,
    [Email] [varchar](50) NULL,
    [FlexSWZVersion] [varchar](20) NULL,
    [HostAddress] [varchar](20) NULL,
    [HostName] [varchar](100) NULL,
    [InitialStageSize] [varchar](20) NULL,
    [OrderId] [varchar](50) NULL,
    [ScreenResolution] [varchar](50) NULL,
    [TotalTimeOnSite] [int] NULL,
    [CumulativeVisitCount] [int] NULL CONSTRAINT [DF_SiteVisit_CumulativeVisitCount]  DEFAULT ((0)),
    [ContentActivatedTime] [int] NULL CONSTRAINT [DF_SiteVisit_ContentActivatedTime]  DEFAULT ((0)),
    [ContentCompleteTime] [int] NULL,
    [MasterVersion] [int] NULL CONSTRAINT [DF_SiteVisit_MasterVersion]  DEFAULT ((0)), 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T20:16:40.703

你说的两件事是相互冲突的。

1.  我希望能够在用户的不同活动和他们所做的事情之间进行各种数据挖掘和关联。
2.  我想确保我的 db 文件不会继续增长。

我也是数据挖掘的忠实粉丝，但你需要数据来挖掘。在我看来，创建一个可扩展的数据库设计并计划它的巨大增长。然后，去获取所有可以获取的数据。然后，最后，您将能够进行您梦寐以求的所有酷数据挖掘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T16:20:10.980

就我个人而言，我绝对会将日志记录保留在主数据库之外。您的应用程序的性能会因为必须不断进行写入而受到巨大影响。

我认为要走的路是在不同的机器上创建一个辅助数据库，发布一个与底层 DB Schema 无关的 SOAP api，并让应用程序报告它。我还建议也许写语义（不要等待确认响应）可以为你做，如果你可以冒险丢失一些这些信息。

在辅助数据库上，您可以让 API 调用触发某种数据库修剪或分离/备份/重新创建维护过程。如果您需要日志，那么您不应该放弃它在未来有用的可能性。

如果您需要某种分析服务，最好的方法是 SQL Server。否则 MySQL 或 PostGREs 会便宜得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T07:05:03.797

Re-thinking the problem might be just what the doctor ordered. Can 100k records per day really be that useful? Seems like information overload to me. Maybe start by reducing the granularity of your usage tracking?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T07:53:28.677

就重新思考问题而言，您可能会探索许多网络统计数据包之一。您的示例表中只有少数字段不属于 WebTrends 或 Google Analytics 或许多其他的开箱即用实现的一部分。表中的其他项目也可以设置，但要多考虑并研究一下哪个软件包可以满足您的所有需求。如今，大多数现成的东西都可以处理活动跟踪等。

另一种选择是将常见的东西卸载到标准的 web-stats 包中，然后使用您的自定义数据带外将其解析回 SQL Server。

我不知道您还有多少其他数据，但如果每天 107K+ 的记录占其中的大部分，那么您最终可能会花时间处理保持 Web 统计数据正常工作，而不是处理应用程序的实际功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T08:14:35.903

我会将它们保存在同一个数据库中，除非您可以安全地清除/存储旧记录以进行 OLAP 查询，然后将主数据库保留用于 OLTP 目的。

确保为数据库设置较大的初始大小并设置较大的自动增长值，并确保不会耗尽磁盘空间。无论您如何存储，每天 107k 条记录**都会占用空间。**

至于备份，这完全取决于您的要求。只要 IO 子系统可以处理，每周完整、每日 diff 和一/两小时 diff 应该可以正常工作。

额外的索引会占用空间，但同样，这取决于您添加的列。如果您有 10^6 行并且添加了一个非聚集索引，它将占用 10^6 * 4 * 2。对于实际的索引列，这是 10^6，主键也是额外的 4 个字节，对于每个索引条目。因此，对于每 100 万条记录，int 列上的非聚集索引将占用大约 8MB。

当表增长时，您可以添加服务器并对表进行水平分区，以便将数据分布在多个服务器上。

至于 IO，这可能是最大的障碍，请确保您有足够的心轴来处理负载，最好将索引放在它们自己的磁盘集/LUN 上，并将实际数据放在它们自己的磁盘集/LUN 上。

# c++ - 在 C++ 标识符中使用下划线的规则是什么？

> ID：228783
> 
> 赞同：996
> 
> 时间：2008-10-23T07:02:06.347
> 
> 标签：c++, naming-conventions, standards, c++-faq

在 C++ 中，使用某种前缀来命名成员变量是很常见的，以表示它们是成员变量，而不是局部变量或参数。如果您来自 MFC 背景，您可能会使用`m_foo`. 我也`myFoo`偶尔看到。

C#（或者可能只是 .NET）似乎建议只使用下划线，如`_foo`. 这是 C++ 标准允许的吗？

* * *

## 回答 #1

> 赞同：916
> 
> 时间：2008-10-23T07:08:41.280

规则（在 C++11 中没有改变）：

*   在任何范围内保留，包括用作[实现](https://stackoverflow.com/questions/4297933/c-implementation#4297974)宏：
    *   以下划线开头的标识符，后跟一个大写字母
    *   包含相邻下划线（或“双下划线”）的标识符
*   保留在全局命名空间中：
    *   下划线开头的标识符
*   此外，`std`命名空间中的所有内容都是保留的。（不过，您可以添加模板特化。）

来自 2003 C++ 标准：

> ### 17.4.3.1.2 全局名称 [lib.global.names]
> 
> 某些名称和函数签名集始终保留给实现：
> 
> *   每个包含双下划线 ( `__`) 或以下划线后跟大写字母 (2.11) 的名称都保留给实现以供任何使用。
> *   每个以下划线开头的名称都保留给实现用作全局名称空间中的名称。^(165)
> 
> ^(165))此类名称也保留在命名空间`::std`(17.4.3.1) 中。

因为 C++ 基于 C 标准（1.1/2，C++03），而 C99 是规范性参考（1.2/1，C++03），这些也适用于 1999 年的 C 标准：

> ### 7.1.3 保留标识符
> 
> 每个标头声明或定义其相关子条款中列出的所有标识符，并可选地声明或定义其相关的未来库方向子条款中列出的标识符和始终保留用于任何用途或用作文件范围标识符的标识符。
> 
> *   以下划线和大写字母或另一个下划线开头的所有标识符始终保留用于任何用途。
> *   所有以下划线开头的标识符始终保留用作普通和标记名称空间中具有文件范围的标识符。
> *   如果包含任何关联的头文件，则以下任何子条款（包括未来的库方向）中的每个宏名称都保留用于指定用途；除非另有明确说明（见 7.1.4）。
> *   以下任何子条款（包括未来的库方向）中具有外部链接的所有标识符始终保留用作具有外部链接的标识符。^(154)
> *   如果包含任何关联的标头，则保留在以下任何子条款（包括未来的库方向）中列出的具有文件范围的每个标识符用作宏名称和具有相同名称空间中的文件范围的标识符。
> 
> 没有保留其他标识符。如果程序在保留标识符的上下文中声明或定义标识符（7.1.4 允许的除外），或将保留标识符定义为宏名称，则行为未定义。
> 
> 如果程序删除（用`#undef`）上面列出的第一组中标识符的任何宏定义，则行为未定义。
> 
> ^(154))具有外部链接的保留标识符列表包括`errno`、`math_errhandling`、`setjmp`和`va_end`。

其他限制可能适用。例如，POSIX 标准保留了很多可能出现在正常代码中的标识符：

*   以大写字母开头的名称`E`后跟数字或大写字母：
    *   可用于附加错误代码名称。
*   以小写字母开头`is`或`to`后跟小写字母的 名称
    *   可用于额外的字符测试和转换功能。
*   `LC_`以大写字母开头的 名称
    *   可用于指定语言环境属性的附加宏。
*   所有现有数学函数的名称后缀为`f`or`l`保留
    *   分别用于对 float 和 long double 参数进行操作的相应函数。
*   `SIG`以大写字母开头的 名称被保留
    *   附加信号名称。
*   `SIG_`以大写字母开头的 名称被保留
    *   额外的信号动作。
*   `str`保留以、`mem`或`wcs`后跟小写字母开头的 名称
    *   用于附加字符串和数组函数。
*   以任何小写字母开头`PRI`或`SCN`后跟或`X`保留 的名称
    *   用于附加格式说明符宏
*   以结尾的名称`_t`是保留的
    *   其他类型名称。

虽然现在将这些名称用于您自己的目的可能不会导致问题，但它们确实会增加与该标准的未来版本冲突的可能性。

* * *

就我个人而言，我只是不使用下划线开头的标识符。我的规则的新增内容：不要在任何地方使用双下划线，这很容易，因为我很少使用下划线。

在对这篇文章进行研究之后，我不再以标识符结尾，`_t` 因为这是 POSIX 标准保留的。

关于任何以结尾的标识符的规则`_t`让我很惊讶。我认为这是一个 POSIX 标准（尚不确定），正在寻找澄清和官方章节。这来自[GNU libtool 手册](http://www.gnu.org/software/libtool/manual/libc/Reserved-Names.html)，列出了保留名称。

CesarB 提供了以下指向[POSIX 2004](http://www.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_02.html)保留符号的链接，并指出“可以在此处找到许多其他保留的前缀和后缀……”。[POSIX 2008](http://www.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html)保留符号在此处定义。 这些限制比上述限制更细微。

* * *

## 回答 #2

> 赞同：213
> 
> 时间：2008-10-23T07:27:12.287

避免名称冲突的规则都在 C++ 标准中（参见 Stroustrup 书）和 C++ 大师（Sutter 等）提到的。

## 个人规则

因为不想处理案件，想要一个简单的规则，所以我设计了一个**个人**的，既简单又正确：

**命名符号时，如果您满足以下条件，您将避免与编译器/操作系统/标准库发生冲突：**

***   永远不要以下划线开头的符号**
*   **永远不要用两个连续的下划线命名符号。**

当然，将代码放在唯一的命名空间中也有助于避免冲突（但不能防止恶意宏）

## 一些例子

（我使用宏是因为它们对 C/C++ 符号的代码污染更大，但它可以是从变量名到类名的任何内容）

```
#define _WRONG
#define __WRONG_AGAIN
#define RIGHT_
#define WRONG__WRONG
#define RIGHT_RIGHT
#define RIGHT_x_RIGHT 
```

## 摘自 C++0x 草案

从[n3242.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf)文件（我希望最终的标准文本是相似的）：

> **17.6.3.3.2 全局名称 [global.names]**
> 
> 某些名称和函数签名集始终保留给实现：
> 
> — 每个包含双下划线 _ _ 或以下划线后跟大写字母 (2.12) 的名称都保留给实现以供任何使用。
> 
> — 每个以下划线开头的名称都保留给实现用作全局名称空间中的名称。

但是也：

> **17.6.3.3.5 用户定义的文字后缀 [usrlit.suffix]**
> 
> 不以下划线开头的文字后缀标识符保留用于将来的标准化。

最后一个子句令人困惑，除非您认为以下划线开头并后跟小写字母的名称如果*未*在全局命名空间中定义则可以...

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-10-23T07:06:32.703

来自[MSDN](http://msdn.microsoft.com/en-us/library/565w213d.aspx)：

> 在标识符的开头使用两个连续的下划线字符 ( __ ) 或单个前导下划线后跟一个大写字母，保留用于所有范围内的 C++ 实现。您应该避免使用一个前导下划线后跟一个小写字母来表示具有文件范围的名称，因为可能与当前或将来的保留标识符发生冲突。

这意味着您可以使用单个下划线作为成员变量前缀，只要它后跟一个小写字母即可。

这显然取自 C++ 标准的第 17.4.3.1.2 节，但我在网上找不到完整标准的原始来源。

另请参阅[此问题](https://stackoverflow.com/questions/224397/why-do-people-use-double-underscore-so-much-in-c)。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-11-14T20:03:28.710

至于问题的另一部分，通常将下划线放在变量名的*末尾，以免与内部的任何内容发生冲突。*

我什至在类和名称空间内也这样做，因为我只需要记住一个规则（与“在全局范围内的名称末尾，以及其他任何地方的名称开头”相比）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T07:05:58.040

是的，下划线可以在标识符的任何地方使用。我相信规则是：第一个字符中的任何 az、AZ、_ 以及以下字符中的 +0-9。

下划线前缀在 C 代码中很常见——单下划线表示“私有”，双下划线通常保留供编译器使用。

# .net - double in .net

> ID：228795
> 
> 赞同：2
> 
> 时间：2008-10-23T07:07:09.037
> 
> 标签：.net, floating-point, precision

If I have the following code (this was written in .NET)

```
double i = 0.1 + 0.1 + 0.1; 
```

Why doesn't `i` equal `0.3`?
Any ideas?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T07:10:34.350

You need to read up on floating point numbers. Many decimal numbers don't have an exact representation in binary so they won't be an exact match.

That's why in comparisons, you tend to see:

```
if (abs(a-b) < epsilon) { ... 
```

where epsilon is a small value such as 0.00000001, depending on the accuracy required.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T07:10:56.000

Double is a 64-bit floating point data type. It stores decimals as approximate values. If you need exact values, use the Decimal data type which is a [Binary Coded Decimal](http://en.wikipedia.org/wiki/Binary-coded_decimal) data type.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T07:09:39.263

The precision of floating point arithmetic cannot be guaranteed.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T07:11:08.763

Equality with floating point numbers is often not used because there is always an issue with the representation. Normally we compare the difference between two floats and if it is smaller than a certain value (for example 0.0000001) it is considdered equal.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T07:11:34.860

Double calculation is not exact. You have two solution:

*   Use the `Decimal` type which is exact
*   compare abs(i - 0.3) < espilon

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T07:18:35.377

Jon Skeet has a very good walkthrough of this [here](http://www.yoda.arachsys.com/csharp/floatingpoint.html), and the same for `decimal` [here](http://www.yoda.arachsys.com/csharp/decimal.html).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T07:25:04.617

Have a look at this thread:

[Why do I see a double variable initialized to some value like 21.4 as 21.399999618530273?](https://stackoverflow.com/questions/177506/why-do-i-see-a-double-variable-initialized-to-some-value-like-214-as-2139999961)

# c# - 算法：里程表/蛮力

> ID：228796
> 
> 赞同：3
> 
> 时间：2008-10-23T07:07:58.300
> 
> 标签：c#, algorithm

我想用 C# 风格的语言编写一个类似里程表的方法，但不仅仅是使用 0-9 作为字符，而是使用任何字符集。它或多或少会像一个蛮力应用程序一样。

**如果我传入一个从0**到**J**的字符数组，并将长度设置为 5，我想要像*00000, 00001, 00002... HJJJJ, IJJJJJ, JJJJJ 这样的结果*。

这是基础，请帮我扩展：

```
protected void Main()
{
    char[] chars = new char[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
        'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J' };

    BruteForce(chars, 5);
}

private void BruteForce(char[] chars, int length)
{
    // for-loop (?) console-writing all possible combinations from 00000 to JJJJJ
    // (when passed in length is 5)
    // TODO: Implement code...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T07:16:28.017

这不是[“递归而不是多循环”的](https://stackoverflow.com/questions/207889/recursion-instead-of-multi-loops)*完全*重复，但它非常接近。如果这对您没有帮助，我会写一个解决方案。

编辑：这是一个非递归解决方案。递归的返回一个`IEnumerable<string>`from 稍微困难一些，但返回一个迭代器提供了一个很好的接口 IMO :)

```
private static IEnumerable<string> GetAllMatches(char[] chars, int length)
{
    int[] indexes = new int[length];
    char[] current = new char[length];
    for (int i=0; i < length; i++)
    {
        current[i] = chars[0];
    }
    do
        {
            yield return new string(current);
        }
        while (Increment(indexes, current, chars));
}

private static bool Increment(int[] indexes, char[] current, char[] chars)
{
    int position = indexes.Length-1;

    while (position >= 0)
    {
        indexes[position]++;
        if (indexes[position] < chars.Length)
        {
             current[position] = chars[indexes[position]];
             return true;
        }
        indexes[position] = 0;
        current[position] = chars[0];
        position--;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-08T10:14:50.077

这是我找到的解决方案之一。我喜欢它的紧凑性和分离性：

```
private static char[] characters =
    new char[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J' };

// length: The length of the string created by bruteforce
public static void PerformBruteForce(int length) {
    int charactersLength = characters.Length;
    int[] odometer = new int[length];
    long size = (long)Math.Pow(charactersLength, length);

    for (int i = 0; i < size; i++) {
        WriteBruteForce(odometer, characters);
        int position = 0;
        do {
            odometer[position] += 1;
            odometer[position] %= charactersLength;
        } while (odometer[position++] == 0 && position < length);
    }
}

private static void WriteBruteForce(int[] odometer, char[] characters) {
    // Print backwards
    for (int i = odometer.Length - 1; i >= 0; i--) {
        Console.Write(characters[odometer[i]]);
    }
    Console.WriteLine();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T07:13:19.413

谷歌的排列。

但是，如果您只是处理该“十六进制”范围，请执行以下操作：

```
for (int i = 0; i < (1 << 24); i++)
  string s = i.ToString("X6"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T21:07:59.197

下面是我之前为此目的使用过的一个类……顾名思义，它根据所提供的字符集中的字符数在不同的基础中进行计数。希望它有用...

```
public class BaseNCounter
{
    public char[] CharSet { get; set; }
    public int Power { get; set; }

    public BaseNCounter() { }

    public IEnumerable<string> Count() {
        long max = (long)Math.Pow((double)this.CharSet.Length, (double)this.Power);
        long[] counts = new long[this.Power];
        for(long i = 0; i < max; i++)
            yield return IncrementArray(ref counts, i);
    }

    public string IncrementArray(ref long[] counts, long count) {
        long temp = count;
        for (int i = this.Power - 1; i >= 0 ; i--) {
            long pow = (long)Math.Pow(this.CharSet.Length, i);
            counts[i] = temp / pow;
            temp = temp % pow;
        }

        StringBuilder sb = new StringBuilder();
        foreach (int c in counts) sb.Insert(0, this.CharSet[c]);
        return sb.ToString();
    }
} 
```

这是控制台应用程序中的几个使用场景。

```
class Program
{
    static void Main(string[] args)
    {
        BaseNCounter c = new BaseNCounter() { 
            CharSet = new char [] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' }, 
            Power = 2};

        foreach(string cc in c.Count())
            Console.Write("{0} ,", cc);
        Console.WriteLine("");

        BaseNCounter c2 = new BaseNCounter()
        {
            CharSet = new char[] { 'x', 'q', 'r', '9'},
            Power = 3
        };
        foreach (string cc in c2.Count())
            Console.Write("{0} ,", cc);
        Console.Read();
    }
} 
```

# graphics - 如何从 Functional MetaPost 查看输出的 .mp 文件

> ID：228811
> 
> 赞同：3
> 
> 时间：2008-10-23T07:11:47.793
> 
> 标签：graphics, haskell, latex, metapost

我对在 Mac OS X 上使用 Functional MetaPost 很感兴趣：

[http://cryp.to/funcmp/](http://cryp.to/funcmp/)

我正在寻找类似的教程：

[http://haskell.org/haskellwiki/Haskell_in_5_steps](http://haskell.org/haskellwiki/Haskell_in_5_steps)

但是对于一个简单的 FuncMP 示例，即使用 GHC，我可以编译一些简单的东西，例如：

```
import FMP  
myPicture = text "blah"  
main = generate "foo" 1 myPicture 
```

但我不知道如何查看这个 foo.1.mp 输出。（它给出了关于找不到“virmp”的运行时错误；我的 MetaPost 二进制文件是“mpost”；我无法弄清楚如何覆盖此参数或我的 .FunMP 文件正在或应该做什么......）我可以运行mpost ，但输出 (foo.1.1) 是什么，PostScript？每股收益？我该如何使用它？（我想我只需要一个简单的 LaTeX 文件，其中包含 EPS 图或其他东西......）

最好是生成输出（我可以查看的 .ps 或 .pdf），这样我就可以*使用 Functional MetaPost*真正到达某个地方，学习它，玩它，而不是用我的头撞到路径、二进制文件和 shell 命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-26T19:03:01.843

mpost的输出是eps，你可以在ghostview中查看...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T02:08:10.473

@ja：这是真的（EPS 应该是 mpost 的输出）但是这里有一些问题：

1.  ghostview 使用 X11 并且丑陋（尤其是在 Mac 上）到难以使用的地步。

2.  我需要平滑的抗锯齿图形，特别是 PDF，这样我就可以在完成后将图形导入 Photoshop——屏幕上的结果很重要！

3.  最后，我不是唯一一个[对功能性 Metapost 的非标准 Metapost 输出有问题的人](http://www.haskell.org/pipermail/haskell-cafe/2008-October/049776.html)。

我的解决方案是尝试其他方法：

*   [Asymptote](http://asymptote.sourceforge.net/) ...“一种强大的描述性矢量图形语言，为技术图纸提供基于数学坐标的框架。标签和方程式使用 LaTeX 排版，以实现整体文档一致性，产生与 LaTeX 为科学提供的相同高质量排版水平文本。默认情况下，它会生成 PostScript 输出，但它也可以生成 ImageMagick 包可以生成的任何格式。
*   它看起来确实令人印象深刻，并且在许多方面都对 Metapost 进行了改进（真正的浮点，全 3D！），并且编程语言看起来相当现代且经过深思熟虑（一流的函数，Pythonic/Java-ish 语法）。

哇！这太酷了。Asymptote 交付（一旦你安装它......问题都在 FOSS 包/X11/texlive/macports 上，尤其是 lazwutil 方面......）

# sql - Creating stored procedure on the fly. What are the risks/problems?

> ID：228812
> 
> 赞同：2
> 
> 时间：2008-10-23T07:12:22.193
> 
> 标签：sql, sql-server, tsql, stored-procedures

I am thinking about creating stored procedures on the fly.

ie running CREATE PROCEDURE... when the (web) application is running.

What are the risks or problems that it can cause?

*   I know that the database account needs to have the extra privileges.
*   It does NOT happen everyday. Only from time to time.
*   I am using sql server and interested in mysql and postgres as well.

Update1:

Thanks to comments, I am considering creating a new version of stored procedure and switching over instead of ALTERing the sp. example: sp1 -> sp2 -> sp3

Update2:

The reason:

My schema changes because of custom fields (unknown number and type of columns) I tried dynamic sql and sp_executesql first. Of course it works. Dynamic sql works greate for 1,2,3 simple update,inserts.

But it got too ugly and a lot of work and it does not mix well with stored procedure, problems with sql parameterization because it is used inside a stored procedure and the number and type of params is not known at compile time (long story).

At least the basic scenario for this solution is not that complicated. The logic of the sp does NOT change. For each custom field I have to add a new parameter to sp and add a column to update, insert, etc.

I also considered making stored procedure parameters dynamic like sp_executesql that accepts any number and type of params but could not find a way.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T08:46:12.813

对于事务系统，它可能相当昂贵。如果您有一个大批量的作业并且出于某种原因想要使用代码生成器（ETL 工具中相当常见的架构，尤其是[Oracle Warehouse Builder](http://www.oracle.com/solutions/business_intelligence/warehouse-builder.html)和[Wherescape Red](http://www.wherescape.com/products-getting-started/products-getting-started.aspx)），那么这样做并不是不合理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-10T16:49:17.937

您提到在执行此更改时将添加和/或更改存储过程的调用配置文件。您如何使用调用它的应用程序锁定新的调用配置文件？如果您必须恢复所做的更改，您的回滚计划是什么？

过去我所做的只是使用新的调用配置文件将递增的数字后缀附加到存储过程名称 - 然后您可以修改旧版本的 SP 以使用参数的默认值调用新版本，然后你可以发布你的软件调用新版本。

如果您的新版本出现问题并且您必须回滚，则对旧存储过程的调用仍然可以正常工作，并且只需使用您的默认值填充自定义字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T14:54:41.510

我不确定 Tony BanBrahim 讨论的锁定在 SQL Server 2005 中是否正确。

我有一些长时间运行的 SP（大约 30 个子进程的 3 小时批处理），并且我能够在 SP 仍在运行时对其进行更改。（我认为这些更改要等到下一次运行才会生效，但不会导致任何阻塞或任何错误）。现在，外部长时间运行的 SP 既可以使用 EXEC 动态调用 SP，也可以静态调用 SP，但是我在根 SP 和嵌套 SP 运行时都更改了它们，而没有错误消息或块。

WRT您最初的问题，我认为如果以受控方式使用您的策略是可以的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T07:24:47.720

Firstly, the answer to this question really depends on what exactly this stored procedure is intended to do. If it's just reading data or creating a result set for reporting and you don't mind if it's a little inconsistent, then you're probably fine. If it's doing anything remotely interesting with your data then it's a very risky thing to be doing. You should think about whether it's possible (and what would happen) for two users users (or the same user twice) to run multiple versions of the the same stored procedure at the same time. Smells like a train wreck to me. One option is to only allow this procedure alteration to take place when no other users are logged into the system, or forcibly boot them off the database if they are. Another option is to create your new stored procedure with a slightly different name and swap them over when you deem it safe to do so.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T09:11:33.933

如果您确实需要这样做，那么您应该随机化程序的名称以避免与其他用户发生冲突。永远记住，其他用户可能同时在做他们自己的事情——大多数数据库系统不会为存储过程提供事务隔离（Postgres 是我所知道的唯一一个这样做的）。

这将是一件可取的事情，这是极其罕见的——您能否详细说明是什么让您选择了这种方法？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T09:12:07.270

我不会亲自这样做。

正如您所提到的，您将需要额外的权限来授予对创建/更改数据库对象的访问权限。这可能会造成严重的安全风险，因为如果有人发现其中的安全漏洞，没有什么能阻止您的应用程序创建恶意存储过程。

如果您的架构发生更改，请使用该架构更改存储过程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T09:40:23.093

如果一个或多个用户正在运行该过程，或者另一个引用您的过程的过程，您将无法更改该过程。您将阻塞，直到所有相关过程和要编译的过程（我认为您从过程中调用的过程，但我不确定）都没有使用。在繁忙的生产系统上，这可能需要很长时间，如果运气不好，您可能会超时等待所有依赖项都未使用（Oracle 上为 5 分钟）。
你也可能陷入非常丑陋的境地（我有）。以存储过程 B 和 C 为例，它们都调用 A，即您尝试编译的过程。当没有人运行 B 时，系统会锁定 B。现在任何试图运行 B 的用户都会停止。然后系统尝试锁定 C，但 C 正在生成一个非常长的报告，该报告将在另外 10 分钟内完成。您将超时等待锁定，并且您的一些用户将有 5 分钟无响应的系统。我的经验是使用 Oracle，我会确保您的目标 DBMS 不会以相同的方式运行，或者具有更快的故障或更好的锁定获取策略。
我想我是在警告说，看起来可能在开发服务器上工作的东西在繁忙的生产系统上可能会严重失败。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T08:06:59.117

另一个问题是存储过程的主要好处之一是执行计划被缓存，这意味着它将执行得更快。如果您在运行中创建它们，您将失去该优势。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-16T20:19:36.057

我不确定，但听起来像一个或两个：

*   架构问题
*   现有代码是否从应用程序锁定模式表？

我会看看哪些代码正在锁定模式表并重写该代码。您是否有第 3 方或其他东西在锁定这些表？

# asp.net - 在脚本中安装 ASP.NET + SQL Express

> ID：228814
> 
> 赞同：2
> 
> 时间：2008-10-23T07:13:00.333
> 
> 标签：asp.net, iis, installation, scripting

在这个问题上我需要一点帮助。

我有一个用 ASP.NET 编写的 Web 应用程序，加上我有 SQL Express 数据库的 .bak 文件，我的问题是：如何在客户端中通过简单的点击安装它？

我怎样才能编写一个脚本来创建一个新数据库，将 bak 文件恢复到该数据库中，设置 IIS 并且......好吧，就是这样:)

我都是手动完成的，而且我经常这样做，所以我只是想问是否有办法阻止手动执行所有这些步骤。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T07:36:33.983

您可以使用[WiX](http://wix.sourceforge.net/)创建一个 .msi，您可以使用它在您的客户端安装您的应用程序。WiX 需要一点时间来适应，但是一旦你掌握了它，你就会满足上面的需求，并且能够随着应用程序的增长或从安装的角度增加复杂性来扩展它们。

我读到您的问题意味着您有多个客户端安装您的应用程序，如果不是这种情况，并且您的应用程序存在于一个地方，那么会有更好的解决方案和更好的人将它们提供给您！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T04:31:09.333

如果您对学习曲线不满意（并且 IMO 有一点学习曲线），WIX 肯定非常灵活，那么也许您应该查看[Web 部署项目](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx "Scott Gu 的博客 - VS 2008 Web 部署项目支持发布")。

来自博客文章：

> Web 部署项目可以与 VS 2008 中内置的“ASP.NET 网站”或“ASP.NET Web 应用程序项目”选项一起使用，并提供一些额外的构建、打包和部署选项供您使用。

关于数据库，我建议您使用该`App_Data`目录并仅部署“.mdf”文件。这比尝试创建新数据库和恢复备份更容易。

# c# - Handling uncaught exceptions in C# console application

> ID：228817
> 
> 赞同：7
> 
> 时间：2008-10-23T07:13:36.667
> 
> 标签：c#, .net, exception, mono, appdomain

I'm currently writing a server that hosts several modules. The server runs each module in a separate AppDomain. What I want to achieve is exception isolation, i.e. when one module throws an exception I don't want whole process to terminate, just this specific AppDomain. I know that I can tell CLR to fallback to old behaviour (.NET 1.0) when all uncaught exceptions in different threads were swallowed. However, this is not the most 'elegant' solution.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T07:41:11.323

How about subscribing to this event:

```
AppDomain.CurrentDomain.UnhandledException 
```

You'll have to cast the ExceptionObject property from type Object to Exception.

Hope that helps.

# iphone - 应用程序挂起时关闭 iPhone

> ID：228833
> 
> 赞同：8
> 
> 时间：2008-10-23T07:20:45.780
> 
> 标签：iphone

我的应用程序挂起。按下主页按钮不再返回跳板。此外，按下电源按钮 10 秒根本不会关闭 iphone。

有没有办法强制关机？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-23T12:38:49.817

1 - 要“强制退出”iPhone 应用程序，按住 Home 按钮最多 5 秒钟。

2 - 要强制重置（在极少数情况下 1 不起作用），同时按住电源和主页按钮 10 秒钟。

（这在 Apple 支持文章中记录 - [http://support.apple.com/kb/HT1430](http://support.apple.com/kb/HT1430)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-23T07:21:45.247

要强制关闭 iPhone 3G，只需先按下电源按钮，然后按下主页按钮。按住 2 个按钮，直到您的屏幕发生变化。

就是这样......一个简单但未记录的解决方案。那好吧。到目前为止，我的 iPhone 已经以几种方式崩溃了，并且一直有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T10:13:11.733

如果您的应用程序重复挂起电话，请在 bugreport.apple.com 提交错误报告并附上您的应用程序的副本。这是 Apple 对调试非常感兴趣的事情。谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T13:26:08.007

我的 iPhone 在启动过程中尝试重置和擦除所有 iphoe 内容时挂起。

以下是让您的 iPhone 在恢复模式下启动的步骤： 第 1 步：在让 iphone 进入恢复模式之前，在您的 MAC 或 PC 上打开 iTunes 并将电缆连接到 iPhone。第 2 步：同时按住电源和主页按钮，直到屏幕发生变化（大约 10 秒）。第 3 步：松开电源按钮并按住 Home 按钮至少 30 秒。

按照 iTunes 上的说明恢复 iPhone 的固件。

希望这个解决方案适用于所有像我这样有问题的人。幸好我的问题解决了。

# javascript - 最佳实践 javascript 和多语言

> ID：228835
> 
> 赞同：76
> 
> 时间：2008-10-23T07:21:17.133
> 
> 标签：javascript, internationalization

使用 DOM 和 javascript 操作的多语言网站的最佳实践是什么？我使用 javascript 构建网站的一些动态部分。我的第一个想法是使用带有文本字符串和语言代码的数组作为索引。这是一个好主意吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-23T07:46:12.390

当我之前构建过多语言网站（不是很大，因此可能无法很好地扩展）时，我保留了一系列“语言”文件：

*   语言.en.js
*   语言.it.js
*   语言.fr.js

每个文件都声明了一个对象，该对象基本上只是从关键字到语言短语的映射：

```
// lang.en.js
lang = {
    greeting : "Hello"
};

// lang.fr.js
lang = {
    greeting : "Bonjour"
}; 
```

动态加载其中一个文件，然后您需要做的就是从地图中引用密钥：

```
document.onload = function() {
    alert(lang.greeting);
}; 
```

当然，还有许多其他方法可以做到这一点，并且有很多方法可以做到这一点，但更好：将它全部封装到一个函数中，以便可以优雅地处理“字典”中缺失的短语，甚至可以完成整个事情使用 OOP，让它管理文件的动态包括，它甚至可以为你绘制语言选择器等。

```
var l = new Language('en');
l.get('greeting'); 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-10-23T12:45:03.940

在设计多语言支持时，您需要牢记以下几点：

1 - 将代码与数据分开（即不要将字符串硬编码到您的函数中）

2 - 创建一个格式化挂钩函数来处理本地化差异。允许格式化字符串 ( **"{0}"** ) 比连接 ( **"Welcome to" + value** ) 更好，原因有很多：

*   在某些语言中，数字的格式为 1.234.678,00 而不是 1,234,567.00
*   复数通常不像在单数末尾附加一个“s”那么简单
*   语法规则不同，可能会影响事物的顺序，因此您应该允许在翻译挂钩之后附加动态数据：例如，**“Welcome to {0}** ”在日语中变成**“{0} he youkoso”**（这发生在几乎每种语言，请注意）。

3 - 确保您可以在翻译挂钩运行**后实际格式化字符串，以便您可以重用密钥。**

4 -**在任何情况下，都不要将数据库输出挂钩到翻译实用程序**。如果您有多语言数据，请在数据库中创建单独的表/行。我已经看到人们经常犯这种不明智的错误（通常是针对国家和州/省的形式）。

5 - 为创建密钥创建明确的编码实践规则。格式化程序实用程序函数（看起来像**translate("hello world")**将使用一个键作为参数，而具有细微变化的键会使维护非常烦人。例如，在以下示例中您可能会得到三个键： “输入你的名字”，“输入你的名字：”，“输入你的名字：”。选择一种格式（例如，没有冒号，修剪）并在代码审查中发现差异。不要以编程方式执行此过滤，因为它可能会触发错误积极的一面。

6 - 请注意，翻译表中可能需要 HTML 标记（例如，如果您需要将句子中的单词加粗，或有脚注医学参考）。对此进行广泛测试。

7 - 有几种导入语言字符串的方法。理想情况下，您应该有一个 language.lang.js 文件的多个版本，使用服务器端代码在它们之间切换，并从 HTML 文件的底部引用该文件。通过 AJAX 提取文件也是一种替代方法，但可能会引入延迟。将 language.js 合并到你的主代码文件中是不可取的，因为你失去了文件缓存的好处。

8 -**使用您的目标语言进行测试。**这听起来很傻，但我曾经见过一个严重的错误，因为程序员没有费心检查密钥中是否存在“é”。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-07-18T19:19:18.847

```
function Language(lang)
{
    var __construct = function() {
        if (eval('typeof ' + lang) == 'undefined')
        {
            lang = "en";
        }
        return;
    }()

    this.getStr = function(str, defaultStr) {
        var retStr = eval('eval(lang).' + str);
        if (typeof retStr != 'undefined')
        {
            return retStr;
        } else {
            if (typeof defaultStr != 'undefined')
            {
                return defaultStr;
            } else {
                return eval('en.' + str);
            }
        }
    }
} 
```

将此添加到您的页面后，您可以像这样使用它：

```
var en = {
    SelPlace:"Select this place?",
    Save:"Saved."
};

var tr = {
    SelPlace:"Burayı seçmek istiyor musunuz?"
};

var translator = new Language("en");
alert(translator.getStr("SelPlace")); // result: Select this place?
alert(translator.getStr("Save")); // result: Saved.
alert(translator.getStr("DFKASFASDFJK", "Default string for non-existent string")); // result: Default string for non-existent string

var translator = new Language("tr");
alert(translator.getStr("SelPlace")); // result: Burayı seçmek istiyor musunuz?
alert(translator.getStr("Save")); // result: Saved. (because it doesn't exist in this language, borrowed from english as default)
alert(translator.getStr("DFKASFASDFJK", "Default string for non-existent string")); // result: Default string for non-existent string 
```

如果您使用尚未定义的语言调用该类，则将选择English( **en )。**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-23T08:15:23.657

刚刚在 javascript 中找到了一篇关于 i18n 的好文章：http:
[//24ways.org/2007/javascript-internationalisation](http://24ways.org/2007/javascript-internationalisation)

尽管使用 i18n + javascript 进行简单的谷歌搜索会发现很多替代方案。

最后，这取决于您希望它有多*深。*对于几种语言，一个文件就足够了。

您可以使用[Jquery](http://jquery.com/)之类的框架，使用 span 来识别文本（带有类），然后使用每个 span 的 id 来查找所选语言的相应文本。
1行Jquery，完成。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-05-12T12:53:32.217

在阅读了 nickf 和 Leo 的精彩答案后，我创建了以下 CommonJS 风格的 language.js 来管理我的所有字符串（以及可选的[Mustache](https://mustache.github.io/)来格式化它们）：

```
var Mustache = require('mustache');

var LANGUAGE = {
    general: {
        welcome: "Welcome {{name}}!"
    }
};

function _get_string(key) {
    var parts = key.split('.');
    var result = LANGUAGE, i;
    for (i = 0; i < parts.length; ++i) {
        result = result[parts[i]];
    }
    return result;
}

module.exports = function(key, params) {
    var str = _get_string(key);
    if (!params || _.isEmpty(params)) {
        return str;
    }
    return Mustache.render(str, params);
}; 
```

这就是我获得字符串的方式：

```
var L = require('language');
var the_string = L('general.welcome', {name='Joe'}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-09-11T04:57:12.963

这样，您可以通过多字使用一个 js 代码进行多语言：

```
var strings = new Object();

if(navigator.browserLanguage){
  lang = navigator.browserLanguage;
}else{
  lang = navigator.language;
}

lang = lang.substr(0,2).toLowerCase();

if(lang=='fa'){/////////////////////////////Persian////////////////////////////////////////////////////

        strings["Contents"]                              = "فهرست";
        strings["Index"]                                 = "شاخص";
        strings["Search"]                                = "جستجو";
        strings["Bookmark"]                              = "ذخیره";

        strings["Loading the data for search..."]        = "در حال جسنجوی متن...";
        strings["Type in the word(s) to search for:"]    = "لغت مد نظر خود را اینجا تایپ کنید:";
        strings["Search title only"]                     = "جستجو بر اساس عنوان";
        strings["Search previous results"]               = "جستجو در نتایج قبلی";
        strings["Display"]                               = "نمایش";
        strings["No topics found!"]                      = "موردی یافت نشد!";

        strings["Type in the keyword to find:"]          = "کلیدواژه برای یافتن تایپ کنید";

        strings["Show all"]                              = "نمایش همه";
        strings["Hide all"]                              = "پنهان کردن";
        strings["Previous"]                              = "قبلی";
        strings["Next"]                                  = "بعدی";

        strings["Loading table of contents..."]          = "در حال بارگزاری جدول فهرست...";

        strings["Topics:"]                               = "عنوان ها";
        strings["Current topic:"]                        = "عنوان جاری:";
        strings["Remove"]                                = "پاک کردن";
        strings["Add"]                                   = "افزودن";

}else{//////////////////////////////////////English///////////////////////////////////////////////////

strings["Contents"]                              = "Contents";
strings["Index"]                                 = "Index";
strings["Search"]                                = "Search";
strings["Bookmark"]                              = "Bookmark";

strings["Loading the data for search..."]        = "Loading the data for search...";
strings["Type in the word(s) to search for:"]    = "Type in the word(s) to search for:";
strings["Search title only"]                     = "Search title only";
strings["Search previous results"]               = "Search previous results";
strings["Display"]                               = "Display";
strings["No topics found!"]                      = "No topics found!";

strings["Type in the keyword to find:"]          = "Type in the keyword to find:";

strings["Show all"]                              = "Show all";
strings["Hide all"]                              = "Hide all";
strings["Previous"]                              = "Previous";
strings["Next"]                                  = "Next";

strings["Loading table of contents..."]          = "Loading table of contents...";

strings["Topics:"]                               = "Topics:";
strings["Current topic:"]                        = "Current topic:";
strings["Remove"]                                = "Remove";
strings["Add"]                                   = "Add";

} 
```

您可以在此代码中添加另一个语言并在您的 html 代码上设置对象。我使用波斯语波斯语和英语，您可以使用任何类型的语言，只需通过 If-Else 语句创建这部分代码的副本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T11:31:40.950

你应该看看在经典 JS 组件中做了什么——比如 Dojo、Ext、FCKEditor、TinyMCE 等。你会发现很多好主意。

通常它最终是您在标签上设置的某种属性，然后您根据属性的值将标签的内容替换为在翻译文件中找到的翻译。

要记住的一件事是语言集的演变（当您的代码演变时，您是否需要重新翻译整个内容）。我们将翻译保存在 PO 文件 (Gnu Gettext) 中，并且我们有一个脚本可以将 PO 文件转换为可以使用的 JS 文件。

此外：

*   始终使用 UTF-8 - 这听起来很傻，但如果你从一开始就不是 utf-8（HTML 头 + JS 编码），你很快就会破产。
*   使用英文字符串作为翻译的关键——这样你就不会得到这样的结果： lang.Greeting = 'Hello world' - 但是 lang['Hello world'] = 'Hello world';

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-15T01:15:27.567

您可以使用谷歌翻译器：

```
<div id="google_translate_element" style = "float: left; margin-left: 10px;"></div>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL}, 'google_translate_element');
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</div><input type = "text" style = "display: inline; margin-left: 8%;" class = "sear" placeholder = "Search people..."><button class = "bar">&#128270;</button> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-24T22:50:27.780

对于 Spring 包和 JavaScript，有简单的解决方案：在模板（例如 JSP）中生成 i18n 数组并在 JavaScript 中使用它：

JSP：

```
<html>
<script type="text/javascript">
    var i18n = [];
    <c:forEach var='key' items='<%=new String[]{"common.deleted","common.saved","common.enabled","common.disabled","...}%>'>
        i18n['${key}'] = '<spring:message code="${key}"/>';
    </c:forEach>
</script>
</html> 
```

在 JS 中：

```
alert(i18n["common.deleted"]); 
```

另见[Resolving spring:messages in javascript for i18n 国际化](https://stackoverflow.com/questions/6218970/resolving-springmessages-in-javascript-for-i18n-internationalization)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-22T08:07:57.330

```
class Language {
    constructor(lang) {
        var __construct = function (){
            if (eval('typeof ' + lang) == 'undefined'){
                lang = "en";
            }
            return;
        };
        this.getStr = function (str){
            var retStr = eval('eval(lang).' + str);
            if (typeof retStr != 'undefined'){
                return retStr;
            } else {
                return str;
            }
        };
    }
}

var en = {
    Save:"Saved."
};

var fa = {
    Save:"ذخیره"
};

var translator = new Language("fa");
console.log(translator.getStr("Save"));
```

# iphone - 在项目之间共享 iphone 和 mac 代码的最佳方式

> ID：228849
> 
> 赞同：3
> 
> 时间：2008-10-23T07:27:22.693
> 
> 标签：iphone, xcode

我意识到 Mac 和 iPhone 应用程序之间的视图/控制器内容会有所不同，但模型代码可能很相似/相同。那么组织项目以便/可以共享模型代码的最佳方式是什么？

1.  复制/粘贴 - 只需复制并手动保持同步
2.  让 2 个 xcode 项目指向同一个工作区 - 一个用于 Mac，一个用于 iPhone，并共享代码。
3.  公共图书馆 - 大概你不能这样做（或者你可以）

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-28T10:04:01.977

有几种方法可以做到这一点。您可以做的第一件事是创建一个在 Mac OS X 上构建为框架的项目。由于您不能在 iPhone 上使用框架，您可以制作包含相同代码文件的静态库目标。这基本上有效，但标题路径会有所不同。如果您希望头文件路径相同（即 <Myframework/MyFramework.h>），则需要修改静态库头文件的安装路径，以便将它们复制到“$SDK_ROOT/usr/local/include /MyFramework”，并确保 /usr/local/include 是包含的标头搜索路径。然后，您需要将库和头文件安装到每个 SDK_ROOT 中。

我开始做上述事情，但我发现这是一种皇家痛苦。所以我最终做了一些 #2 的变体。基本上，我通过在我的 iPhone 项目根目录中创建一个名为“Externals”的目录，然后在 externals 文件夹中创建一个以适当名称（“MyFramework”）命名的目录，从而使标题路径等效。那是我复制的文件夹，我将框架文件拖入。最后，我将 Externals 文件夹添加为系统头路径（这无疑是一种严重的黑客攻击）。您需要手动将新文件添加到 iPhone 项目中，但我发现将静态库安装到我的构建根目录中并不那么痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T10:34:46.603

我不确定上一个答案的建议是否有效。如果您查看我[之前的问题](https://stackoverflow.com/questions/218450/loading-custom-framework-in-iphone)，您会发现我未能在 iPhone 上加载自定义框架，即使该框架在 Mac 上运行良好。

我会选择方法2。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-12-06T23:58:58.180

您可以使用 JavaScript、CSS 和 HTML 开发您的应用程序。您将分别在 Mac 和 iPhone 上使用 WebView 和 UIWebView 对象。你可以在 WebView 对象中做任何你想做的事情，甚至可以调用 Objective-C。

QuickConnectiPhone 安装程序可在此处找到[https://sourceforge.net/projects/quickconnect/](https://sourceforge.net/projects/quickconnect/)，它将 QuickConnectMac 和 QuickConnectiPhone 模板安装到 Xcode 中。

这样，您可以在一个环境中快速创建应用程序，然后将视图迁移到另一个环境。事实上，QuickConnect 框架是高度模块化的。

如果您不想在 JavaScript 中开发，可以在安装的模板的 Objective-C 端找到相同的模块化框架。

它应该让你更容易做你正在尝试的事情。

# android - How to create Raw socket in Android?

> ID：228851
> 
> 赞同：12
> 
> 时间：2008-10-23T07:29:45.027
> 
> 标签：android, sockets, raw-sockets

Has anybody tried creating `RawSocket` in `Android` and have succeeded ?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-29T14:02:36.083

据我所知，在**任何**纯 Java 库中都无法访问原始套接字。

这部分是因为在大多数 O/S 上，对原始套接字的访问是一项特权操作，仅对以 root / 管理员身份运行的进程可用。

包中可用的`Socket`和`DatagramSocket`类`java.net`是隐式 IP 套接字（分别用于 TCP 和 UDP）。

有关更多详细信息，请参阅[Apple 列表 - Java 原始套接字](https://lists.apple.com/archives/Java-dev/2004/Jul/msg00086.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T17:35:34.320

我实际上并没有在 Android 中创建任何原始套接字，但 java.net 和 javax.net 包可以满足您的需要，

[java.net 包概述](http://code.google.com/android/reference/java/net/package-summary.html)

[javax.net 包概述](http://code.google.com/android/reference/javax/net/package-summary.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-05T16:36:53.047

任何 Java 或 Android 库都不支持原始套接字

使用第 3 方库： [RockSaw](https://www.savarese.org/software/rocksaw/index.html) [JSocket](http://jswrench.sourceforge.net/)

# c - how do you run a c program in cmd

> ID：228852
> 
> 赞同：0
> 
> 时间：2008-10-23T07:30:10.440
> 
> 标签：c

I've opened the **cmd in windows** and I've created a directory by using `md` command. After that I've opened a text file via `notepad <name>`, wrote my program and gave `.c` extention while saving the file.

How can I compile and run my C program to get an output? I've also other programs in my directory: how can I create .exe files for all of them?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T07:44:35.230

适用于 Windows 的免费（无啤酒，不一定无语音）C 编译器包括（来自内存，因此可能还有其他）：

*   MinGW（Windows 的极简 GNU）
*   MSYS
*   赛格温
*   Eclipse CDT（我认为它在幕后使用 GNU）
*   Borland C++（来自他们的 BDN 博物馆网站）
*   Visual C++ 速成

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T07:39:00.623

Maybe [this c compiling handout](http://www.eskimo.com/~scs/cclass/handouts/cstepbystep/index.html) can be of any use.

It shows all the steps needed to create a c based executable file.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T07:32:32.510

You need a compiler - are you using Visual Studio? GCC? The compiler you are using should come with some simple setup instructions to help to get you going.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T14:29:22.533

如果没有理由使用 MS windows，我会建议尝试 linux。

[http://www.ubuntu.com/testing/intrepid/beta](http://www.ubuntu.com/testing/intrepid/beta)

开发环境是免费的。

# jsp - 具有静态输出的 JSP 标记

> ID：228863
> 
> 赞同：1
> 
> 时间：2008-10-23T07:37:32.297
> 
> 标签：jsp, jsp-tags

我正在考虑创建一些始终提供相同输出的 JSP 标记。例如：

```
<foo:bar>baz</foo:bar> 
```

将始终输出：

```
<div class="bar">baz</div> 
```

有没有办法让 JSP 标记的行为就像生成的 servlet 中的静态输出一样？

例如：

```
out.write("<div class=\"bar\">");
...
out.write("</div>"); 
```

代替

```
x.y.z.foo.BarTag _jspx_th_foo_bar_0 = new x.y.z.foo.BarTag();
_jspx_th_foo_bar_0.setPageContext(pageContext);
_jspx_th_foo_bar_0.setParent(null);
_jspxTagObjects.push(_jspx_th_foo_bar_0);
int _jspx_eval_foo_bar_0 = _jspx_th_foo_bar_0.doStartTag();
etc...
etc...
etc... 
```

## 背景

我担心性能。我还没有对此进行测试，但看起来生成的 servlet 为一些非常简单的事情做了很多工作，而且性能非常重要。

但是，如果 servlet 的行为就像输出是直接写在 JSP 中一样，那么生产成本将为零。

我看到这样做有一些好处。我可以更改静态 HTML 甚至更改为更动态的内容，而无需编辑每个 portlet。在我们的设置中，更改标签很容易，但更改每个使用特定元素的 JSP 非常耗时。

这也意味着我可以强制开发人员不要写类似的东西

```
<div class="bar" style="whatever">...</div> 
```

还有更多优势，但如果它在生产服务器上牺牲性能，那可能就不值得了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T08:29:48.010

考虑到您刚刚显示的代码，我很确定性能影响可以忽略不计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T11:38:02.130

我做了一个性能测试。性能差异很小，所以没问题。

## 我是如何进行测试的

我在我们的一个标签库中创建了 500 个单独的标签（以编程方式）。（所以它被包裹在一个罐子里等。）它们看起来都是这样的，唯一的区别是数字：

```
package XX.XX.XX.XX

import java.io.IOException;

import javax.servlet.jsp.JspException;
import javax.servlet.jsp.tagext.TagSupport;

public class Test0001Tag extends TagSupport {

    public Test0001Tag() {
    }

    public int doStartTag() throws JspException {

        try {
            pageContext.getOut().print("<div class=\"Test0001\">");
        } catch (IOException e) {
            throw new JspException(e);
        }
        return EVAL_BODY_INCLUDE;
    }

    public int doEndTag() throws JspException {
        try {
            pageContext.getOut().print("</div>");
        } catch (IOException e) {
            throw new JspException(e);
        }
        return EVAL_PAGE;
    }

    public void release() {
        super.release();
    }
} 
```

然后在 TLD 中有 500 个条目，如下所示：

```
<tag>
   <name>test0001</name>
   <tagclass>XX.XX.XX.XX.Test0001Tag</tagclass>
   <bodycontent>JSP</bodycontent> 
</tag> 
```

然后我抓取了一个包含一些代码的 JSP，并制作了两份副本：一份带有静态 HTML，另一份带有标签。

带有静态 HTML 的那个：

```
<!-- 
<%long start = System.currentTimeMillis();%>
<% for (int i = 0; i < 1000; i++) { %>
<div class="Test0001">X</div>
<div class="Test0002">X</div>
<div class="Test0003">X</div>
...
<div class="Test0498">X</div>
<div class="Test0499">X</div>
<div class="Test0500">X</div>
<% } %>
<%System.out.println(System.currentTimeMillis()-start);%>
 --> 
```

带标签的那个：

```
<!-- 
<%long start = System.currentTimeMillis();%>
<% for (int i = 0; i < 1000; i++) { %>
<bddesign:test0001>X</bddesign:test0001>
<bddesign:test0002>X</bddesign:test0002>
<bddesign:test0003>X</bddesign:test0003>
...
<bddesign:test0498>X</bddesign:test0498>
<bddesign:test0499>X</bddesign:test0499>
<bddesign:test0500>X</bddesign:test0500>
<% } %>
<%System.out.println(System.currentTimeMillis()-start);%>
 --> 
```

引入循环是因为两者都以零毫秒出现。（不幸的是，我在工作中运行 Windows，所以我在这里没有得到太多的精确度。）500 个标签没有产生可测量的延迟这一事实可能已经足够回答了，但我想要更多，即使重复可能允许一些优化。

500 000 个标签的结果：

*   JSP 标记：15-19 秒
*   HTML 标签：12-16 秒

所以有区别，但我认为与从用户点击到答案呈现在屏幕上的所有其他事情相比，它是微不足道的。

## 其他想法

据我所知，Windows 中的粒度约为 15-16 毫秒。所以“0毫秒”实际上意味着“<16毫秒”。小于 16/500 毫秒的延迟。标签是完全可以接受的。

我尝试了 1000 个标签，但 JSP 编译器对此非常不满意。我减少到 500 个标签，因为另一种方法是更改​​设置，这会使我的结果无效。

我将生成的 HTML 设置为 HTML 注释，因为浏览器与测试服务器位于同一台物理机器上，而且我担心浏览器会占用过多的 CPU 时间渲染，即使是双核 CPU。简单的解决方案是注释 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T07:41:10.310

我想知道......为什么不只使用一个普通的旧**包含**？

# .net - 如何在执行 DataBind 之前对 DataSet 进行排序？

> ID：228875
> 
> 赞同：3
> 
> 时间：2008-10-23T07:42:28.417
> 
> 标签：.net, data-binding, sorting, .net-2.0, dataset

我有来自数据库的数据，格式为`DataSet`. 然后我将其设置为`DataSource`网格控件，然后再执行`DataBind()`. 我想在一列上对`DataSet`/进行排序。`DataTable`该列在数据库中排序很复杂，但我希望我可以像对通用列表进行排序一样对它进行排序，即使用 deligate。

这是可能的还是我必须将它转移到不同的数据结构？

**编辑**我无法得到任何适合我的答案，我想是因为我使用的是**.Net 2.0。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T07:54:13.137

由于 DataTable（和 DataView）排序的工作原理，您不能直接使用委托方法。一种解决方法是向数据表中添加表示订单的列，并根据所需的顺序设置值（每行）。然后，您可以将排序添加到此新列的视图中。例如（为了简洁起见，使用 LINQ 进行排序）：

```
var sorted = table.Rows.Cast<DataRow>().OrderBy(row => your code);
int sequence = 0;
foreach(var row in sorted)
{
    row["sequence"] = sequence++;
} 
```

（如果你有一个类型化的数据集，那么我认为你不需要 Cast 步骤，或者你会使用你的类型化 DataRow 子类）

[编辑以包括 2.0]

在 2.0（即没有 LINQ 等）中，您可以使用 a`List<T>`进行排序 - 有点冗长，但是：

```
 List<DataRow> sorted = new List<DataRow>();
        foreach(DataRow row in table.Rows)
        {
            sorted.Add(row);
        }
        sorted.Sort(delegate(DataRow x, DataRow y) { your code });
        int sequence = 0;
        foreach(DataRow row in sorted)
        {
            row["sequence"] = sequence++;
        } 
```

（再次，如果您使用的是类型化数据集，请替换 DataRow）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T07:50:21.943

我认为[DataView.Sort](http://msdn.microsoft.com/en-us/library/system.data.dataview.sort.aspx)属性会有所帮助。您可以通过[DataTable.DefaultView](http://msdn.microsoft.com/en-us/library/system.data.datatable.defaultview.aspx)访问它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T07:52:25.030

如果您不介意在控件上丢失分页/排序，您可以使用以下内容：

```
var dt = new DataTable();
gvWhatever.DataSource = dt.Select().ToList().Sort(); 
```

并且这种排序将根据重载采用 IComparables 等，因此您可以随意排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T13:04:44.303

你可以这样做

```
myTableName.DefaultView.Sort = "MyFieldName DESC"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-14T16:30:38.353

```
protected void grdResult_Sorting(object sender, GridViewSortEventArgs e)
    {
        DataTable dt = ((DataTable)Session["myDatatable"]);
        grdResult.DataSource = dt;
        DataTable dataTable = grdResult.DataSource as DataTable;

    //Code added to fix issue with sorting for Date datatype fields
    if (dataTable != null)
    {   

        DataView dataView = new DataView(dataTable);
        for (int i = 0; i < dataView.Table.Rows.Count; i++)
        {
            try
            {
                dataView.Table.Rows[i]["RESP_DUE_DT"] = common.FormatDateWithYYYYMMDD(Convert.ToDateTime(dataView.Table.Rows[i]["RESP_DUE_DT"]));
                dataView.Table.Rows[i]["RECD_DT"] = common.FormatDateWithYYYYMMDD(Convert.ToDateTime(dataView.Table.Rows[i]["RECD_DT"]));
            }
            catch (Exception ex)
            {

            }
        }

        dataView.Sort = "[" + e.SortExpression + "]" + " " + GetSortDirection(e.SortExpression);

        for (int i = 0; i < dataView.Table.Rows.Count; i++)
        {
            try
            {
                dataView.AllowEdit = true;
                dataView[i].BeginEdit();
                dataView[i]["RESP_DUE_DT"] = common.FormatDateFromStringYYYYMMDD(dataView[i]["RESP_DUE_DT"].ToString());
                dataView[i]["RECD_DT"] = common.FormatDateFromStringYYYYMMDD(dataView[i]["RECD_DT"].ToString());
            }
            catch (Exception ex)
            {

            }
        }
        //End code added to fix the issue with sorting for Date data type fields

        grdResult.DataSource = dataView;
        grdResult.DataBind();

    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T11:21:45.853

您可以在内存中对数据库进行排序，但我不知道“在数据库中排序太复杂”会是什么。如果我是你，我会尝试在数据库中对其进行排序，使用视图、冗余索引、复杂的 SQL 语句，它可能会比在内存中对大型数据集进行排序更快，并具有额外的优势，它可以为其他人保留排序客户端类型（例如 Web 服务等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T11:49:15.423

为什么要在数据库中对列*进行复杂排序*？它假设排序的复杂性在数据库或框架中将是相同的，除非它当然是一个计算列，即使在这种情况下，我猜测在数据库中排序仍然更快。

但是，正如 John 所说，您可以通过 DataView.Sort 属性更改表单级别的排序。如果耗时过多，我建议这样做，在这种情况下，缓存结果会很有用。

# c++ - 如何指定库 X 必须静态链接？

> ID：228881
> 
> 赞同：8
> 
> 时间：2008-10-23T07:47:39.843
> 
> 标签：c++, linker, shared-libraries, static-libraries

我有一个与多个库链接的软件。它们都存在于动态 (.so) 和静态 (.a) 版本中。默认情况下，当使用 g++ 时，它会选择库的动态版本，这对我来说很好。

但是，其中之一绝对需要静态链接。我考虑过使用*-static*但后来它对所有这些都使用了静态版本，这不是我想要的。

如何指定库 X 必须静态链接，而其他库继续链接到 libs 的共享版本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-23T08:02:34.120

g++ -o foo (foo-objects) -Wl,-Bstatic -lmmustbestatic -Wl,-Bdynamic -lother-lib

# sql-server - 建议为 ASP.NET/ColdFusion 和 MS SQL Server 开发哪些硬件（配置）和软件（操作系统版本/应用程序版本）？

> ID：228883
> 
> 赞同：0
> 
> 时间：2008-10-23T07:48:38.920
> 
> 标签：sql-server, windows, configuration, coldfusion

我们是一家小公司，想知道我们应该为我们的开发环境使用的最好的（和负担得起的）硬件和软件配置。目前，我们是一个由四人组成的团队，他们在不同地点远程工作，我们每个人都使用笔记本电脑和 ADSL 连接来处理我们的项目。

这个问题应该有助于我们确定优化硬件和软件的途径，以便充分利用这些开发环境。我们是否需要在笔记本电脑上本地运行所有内容，或者某种分布式解决方案是可能的？鉴于 Windows 2008 和 SQL Server 2008 都是可用的选项，您推荐哪些软件版本？我们是使用中央服务器还是在笔记本电脑上本地运行这些服务器？

我们是一个年轻的团队，所以任何帮助都将受到欢迎和感激！谢谢！

是

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T14:21:20.873

对于一个团队，我建议您将本地环境（笔记本电脑）设置为开发环境，使用本地数据库副本并运行 CF 开发人员版本。版本控制（VSS、Subversion、Git 等）几乎是强制性的。

拥有与实时版本具有相同配置的测试/登台/QA 服务器（尽可能多）。它应该有自己的 CF 许可证以遵循许可协议。您应该将签入代码放在这里供所有人测试和检查集成。一些版本控制系统提供了自动执行此操作的方法，或者您可以手动执行此操作。

显然，生产应该是它自己的事情。我建议您将数据库和应用程序/Web 服务器分开放在两个单独的盒子上。

我知道这可能比您要求的要多/少一些，因此请随时要求澄清。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T00:54:43.207

对于 ASP.NET 或 ColdFusion，您需要让开发人员在他们的笔记本电脑上设置他们自己的本地开发环境。对于 ColdFusion，这可能意味着 ColdFusion 8 Developer Edition（免费）和 MySQL（免费）或 MS SQL Express Edition 2008（也是免费的）。对于实际开发，您将需要 Visual Studio 2008（170 美元 -> 1400 美元）用于 ASP.NET 开发，或带有 CFEclipse 插件（免费）的 Eclipse 用于 ColdFusion 开发。

您几乎可以肯定需要一组测试/QA 服务器，使用 ColdFusion 8（1300 美元），您可以运行 Linux、MacOS X 或 Windows Server。ASP.NET 几乎需要 Windows Server 2003，但如果您喜欢冒险，您可能会使用带有 Mono（免费）的 Linux 或 MacOSX 对于您的数据库引擎，您可以使用 MySQL（免费）、PostgreSQL（免费）、MS SQL （6000 美元），或许多其他之一。

您的生产环境应该与您的测试/QA 环境基本相同，尽管根据您的流量，您最终可能会得到一些深奥的负载平衡解决方案。如果您达到了必要的程度，您将有能力聘请某人为您回答这个问题:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T04:00:05.317

我会使用你能买得起的任何服务器硬件，1/2/3 台机器，有足够的内存和磁盘空间，并使用虚拟服务器或 vmware 服务器。这样你就可以模拟一个多层架构。您可以 VPN/rdp/sslvpn 等连接到您的 QA 环境的虚拟机。

我的 QA 环境有 7 台机器，我有 3 台物理服务器，最大的服务器在物理机上运行 SQL 2005 ent，它托管 2 台虚拟机，其中一台是所有机器用于身份验证的域控制器。2 台其他服务器各托管一个虚拟机。这样我就有一个用于 QA 的 3 层架构和一个用于 UAT 的单独的 3 层架构。虚拟机很容易启动/复制等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T02:39:56.460

MS SQL Server 2008 Express, it's free. [http://www.microsoft.com/downloads/details.aspx?familyid=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en)
Windows XP (prof. edition) is stable and use less resources than Vista. For asp.net I suggest using Dev Studio 2008 Pro.

For the computer itself, you want lots of memory (2-4 GB). A fast dual-core CPU. And you will see a difference using a faster HD (on a laptop, 5400 RPM HD are fast and 4500 RPM are the standard)

I recommend working locally and update all on a central location (with source control as Ben wrote).

# c++ - list::size() 真的是 O(n) 吗？

> ID：228908
> 
> 赞同：65
> 
> 时间：2008-10-23T08:08:58.163
> 
> 标签：c++, list, stl, complexity-theory, big-o

最近，我注意到有人提到它`std::list::size()`具有线性复杂性。
根据[一些](http://www.cplusplus.com/reference/stl/list/size.html) [消息来源](http://bytes.com/forum/thread60248.html)，这实际上取决于实现，因为标准没有说明复杂性必须是什么。[此博客条目中](http://ahlamnote.blogspot.com/2006/11/stl-list-size-method-is-slow.html)
的评论说：

> 实际上，这取决于您使用的是哪个 STL。Microsoft Visual Studio V6 将 size() 实现为 {return (_Size); } 而 gcc（至少在 3.3.2 和 4.1.0 版本中）将其作为 { return std::distance(begin(), end()); 第一个具有恒定速度，第二个具有 o(N) 速度

1.  所以我的猜测是，对于 VC++ 人群来说`size()`，复杂性是恒定的，因为 Dinkumware 自 VC6 以来可能不会改变这一事实。我在吗？

2.  它现在看起来像什么`gcc`？如果真的是O(n)，为什么开发者会选择这样做呢？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-12-06T20:17:28.343

在 C++11 中，要求对于*任何*标准容器，`.size()`操作必须以“恒定”复杂度 (O(1)) 完成。（表 96——容器要求）。以前在 C++03 中`.size()` *应该*具有恒定的复杂性，但不是必需的（请参阅[Is std::string size() a O(1) operation?](https://stackoverflow.com/questions/256033/is-stdstring-size-a-o1-operation)）。

n2923引入了标准的更改[：指定 size() 的复杂性（修订版 1）](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2923.pdf)。

但是，`.size()` 在 libstdc++ 中的实现仍然在 gcc 中使用 O(N) 算法，直到 4.8：

```
 /**  Returns the number of elements in the %list.  */
  size_type
  size() const _GLIBCXX_NOEXCEPT
  { return std::distance(begin(), end()); } 
```

另请参阅[为什么 std::list 在 c++11 上更大？](https://stackoverflow.com/questions/10065055/why-is-stdlist-bigger-on-c11)详细了解为什么以这种方式保存它。

***更新***：在 C++11 模式（或更高使用 gcc **5.0**`std::list::size()`时[正确为 O(1 )。](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=49561#c20)

 *** * *

顺便说一句，`.size()`libc++ 中的正确是 O(1)：

```
_LIBCPP_INLINE_VISIBILITY
size_type size() const _NOEXCEPT     {return base::__sz();}

...

__compressed_pair<size_type, __node_allocator> __size_alloc_;

_LIBCPP_INLINE_VISIBILITY
const size_type& __sz() const _NOEXCEPT
    {return __size_alloc_.first();} 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-10-23T08:14:05.640

## C++11 之前的答案

您是正确的，该标准没有说明`list::size()`必须是什么复杂性 - 但是，它确实建议它“应该具有恒定的复杂性”（表 65 中的注释 A）。

[这是 Howard Hinnant 的一篇有趣的文章](http://howardhinnant.github.io/On_list_size.html)，解释了为什么有些人认为`list::size()`应该具有 O(N) 复杂度（基本上是因为他们认为 O(1)`list::size()`使得`list::splice()`具有 O(N) 复杂度）以及为什么 O(1)`list::size()`是一个好主意（作者认为）：

*   [http://howardhinnant.github.io/On_list_size.html](http://howardhinnant.github.io/On_list_size.html)

我认为论文的主要观点是：

*   在少数情况下保持内部计数，因此`list::size()`O(1) 会导致拼接操作变为线性
*   可能还有更多的情况，有人可能没有意识到可能发生的负面影响，因为他们调用了 O(N) `size()`（例如他的一个例子，`list::size()`在持有锁时被调用）。
*   `size()`为了“最少意外”，标准应该要求任何`size()`实现它的容器以 O(1) 的方式实现它，而不是允许O(N)。如果容器不能做到这一点，它根本不应该实现`size()`。在这种情况下，容器的用户将被告知`size()`不可用，并且如果他们仍然想要或需要获取容器中的元素数量，他们仍然可以`container::distance( begin(), end())`用来获取该值 - 但他们将完全意识到这是O(N) 操作。

我想我倾向于同意他的大部分推理。但是，我不喜欢他提出的对`splice()`重载的补充。必须传入一个`n`必须等​​于`distance( first, last)`才能获得正确行为的值似乎是难以诊断错误的秘诀。

我不确定接下来应该或可以做什么，因为任何更改都会对现有代码产生重大影响。但就目前而言，我认为现有代码已经受到影响 - 对于应该明确定义的东西，行为可能会因一种实现与另一种实现有很大不同。也许 onebyone 的关于将大小“缓存”并标记为已知/未知的评论可能效果很好 - 你会得到摊销的 O(1) 行为 - 你得到 O(N) 行为的唯一时间是当列表被某些 splice() 操作修改时. 这样做的好处是，今天的实现者可以在不改变标准的情况下完成它（除非我遗漏了一些东西）。

~~据我所知，C++0x 并没有改变这方面的任何东西。~~

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-23T17:25:18.600

我之前不得不研究 gcc 3.4 `list::size`，所以我可以这样说：

1.  它使用`std::distance(head, tail)`.
2.  `std::distance`有两种实现：对于满足*RandomAccessIterator*的类型，它使用“tail-head”，对于仅满足*InputIterator*的类型，它使用依赖于“iterator++”的 O(n) 算法，计数直到它到达给定的尾部。
3.  `std::list`不满足*RandomAccessIterator*，因此大小为 O(n)。

至于“为什么”，我只能说`std::list`适合需要顺序访问的问题。将大小存储为类变量会在每次插入、删除等操作中引入开销，并且按照 STL 的意图，这种浪费是一个很大的禁忌。如果您真的需要恒定时间`size()`，请使用`std::deque`.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-23T13:21:39.170

我个人不认为拼接是 O(N) 的问题是允许大小为 O(N) 的唯一原因。*你不为你不使用的东西付费*是一个重要的 C++ 座右铭。在这种情况下，无论您是否检查列表的大小，维护列表大小都需要在每次插入/擦除时额外增加/减少。这是一个很小的固定开销，但仍然需要考虑。

很少需要检查列表的大小。从头到尾迭代而不关心总大小是无限多的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-23T08:18:07.770

我会去[源头](http://www.sgi.com/tech/stl/List.html)（[存档](https://web.archive.org/web/20160221183042/http://www.sgi.com/tech/stl/List.html)）。SGI 的 STL 页面说它允许具有线性复杂性。我相信他们遵循的设计准则是让列表实现尽可能通用，从而在使用列表时允许更大的灵活性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-04T01:57:25.847

此错误报告：[[C++0x] std::list::size](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=49561) complex由于 ABI 兼容性问题，即将推出（在 5.0 中可用）。

GCC 4.9 系列的手册页仍然包含以下免责声明：

> 对 C++11 的支持仍处于试验阶段，在未来的版本中可能会以不兼容的方式发生变化。

* * *

此处引用了相同的错误报告：[Should std::list::size 在 C++11 中是否具有恒定的复杂性？](https://stackoverflow.com/q/19154205/86967)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-18T14:09:34.810

如果您正确使用列表，您可能不会注意到任何差异。

列表适用于您希望在不复制的情况下重新排列的大数据结构，对于您希望在插入后保留有效指针的数据。

在第一种情况下没有区别，在第二种情况下，我更喜欢旧的（较小的） size() 实现。

无论如何，std 更多的是关于正确性和标准行为以及“用户友好性”，而不是原始速度。

# language-agnostic - 当 99.9% 的数据频繁更改时，要缓存什么？

> ID：228909
> 
> 赞同：9
> 
> 时间：2008-10-23T08:10:40.250
> 
> 标签：language-agnostic, caching

好的，我知道我之前问过这个问题，答案基本上是不经常更改的缓存数据。

那么当至少 99.9% 的数据发生变化时该怎么办？

在我的项目中，唯一没有更新或不会经常更新的表是成员个人资料信息（姓名/地址和设置）

那么如何仍然启用某种缓存，但在应用更改时保持并确保正在查看的数据得到更新？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-23T08:16:20.660

我想，并不是所有数据的 99.9% 都发生了变化，而是 99.9% 的数据位置发生了变化。

例如，如果你在做一个布告栏，那就意味着会有源源不断的新帖子，但旧帖子会保持不变，甚至旧帖子也会很长很长时间保持不变。

在这种情况下，您需要一种使旧缓存数据无效的方法，以便您可以在查看线程（在示例中）后立即构建缓存。如果其中一个线程发生了变化（即当有人添加新帖子时），这个缓存项目将被删除/标记为过期，因此下次查看时，它将被重建。不过，其他仍未更改的项目将使用缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T08:17:04.760

如果您的数据在每次查看时都发生变化，那么这将破坏缓存的意义——您应该寻找其他类型的优化。

如果它每隔一段时间就改变一次，那么它可能仍然不值得缓存 - 不要忘记将某些内容存储到缓存会产生一些开销

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T08:22:06.623

真正相关的考虑是这 99.9% 的信息多久更改一次，是每次访问、每秒、分钟、小时吗？根据您拥有的每个时间单位的请求数量和您选择的缓存方案，任何高于访问权限的内容都可能有意义。

只要平均检索时间减少，缓存。**您必须对此进行衡量并做出决定**。

一些缓存验证技术是在访问时检查有效性或将时间戳和到期时间与缓存一起存储。检查每次访问的有效性更昂贵，并且时间戳+过期在某些情况下可能会提供陈旧的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T08:22:03.563

这取决于。

如果您愿意做出这种牺牲（即，事情变得非常糟糕，性能方面），您可能需要考虑以小间隔（10 秒、30 秒、1 分钟......）缓存数据以减少负载在您的数据库上。数据不会是最新的，但可能刚刚足够新鲜。

如果几乎没有任何负载，则无需开始摆弄缓存。真的，没有必要去寻找不存在的问题。毕竟 - 许多数据库引擎都有自己的缓存，不仅用于数据，还用于执行计划。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T08:17:13.637

在单实例 Web 应用程序场景中，您可以在对象更改以及数据库中手动更新缓存。

有时您可以刷新缓存以确保没有不同步的情况（例如，如果数据库被其他应用程序更新）。

请注意，这不适用于企业级场景。

# python - SQLite 参数替换问题

> ID：228912
> 
> 赞同：74
> 
> 时间：2008-10-23T08:13:36.547
> 
> 标签：python, sqlite

使用 SQLite3 和 Python 2.5，我试图遍历一个列表并根据项目的名称从数据库中提取项目的权重。

我尝试使用“？” 建议使用参数替换来防止 SQL 注入，但它不起作用。例如，当我使用：

```
for item in self.inventory_names:
    self.cursor.execute("SELECT weight FROM Equipment WHERE name = ?", item)
    self.cursor.close() 
```

我得到错误：

> sqlite3.ProgrammingError：提供的绑定数量不正确。当前语句使用 1，提供了 8 个。

我相信这在某种程度上是由数据库的初始创建引起的；我制作的实际创建数据库的模块确实有 8 个绑定。

```
cursor.execute("""CREATE TABLE Equipment 
    (id INTEGER PRIMARY KEY, 
    name TEXT,
    price INTEGER, 
    weight REAL, 
    info TEXT, 
    ammo_cap INTEGER, 
    availability_west TEXT,
    availability_east TEXT)""") 
```

但是，当我对每个项目名称使用不太安全的“%s”替换时，它工作得很好。像这样：

```
for item in self.inventory_names:
    self.cursor.execute("SELECT weight FROM Equipment WHERE name = '%s'" % item)
    self.cursor.close() 
```

我不知道为什么当我只调用一个时它认为我有 8 个绑定。我该如何解决？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2008-10-23T08:41:23.167

该`Cursor.execute()`方法需要一个序列作为第二个参数。您提供的字符串恰好是 8 个字符长。

请改用以下表格：

```
self.cursor.execute("SELECT weight FROM Equipment WHERE name = ?", [item]) 
```

Python 库参考： sqlite3 [Cursor Objects](https://docs.python.org/2/library/sqlite3.html#cursor-objects)。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-02-28T00:32:57.790

我花了半天时间试图弄清楚为什么这样的事情会给我一个错误：

```
cursor.execute("SELECT * from ? WHERE name = ?", (table_name, name)) 
```

才发现表名*不能参数化*。希望这将帮助其他人节省一些时间。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2011-09-05T08:51:03.867

它的参数`cursor.execute`表示您需要插入数据库中的值应该是一个元组（序列）。但是考虑这个例子，看看发生了什么：

```
>>> ('jason')
'jason'

>>> ('jason',)
('jason',) 
```

第一个示例计算结果为字符串；所以表示单值元组的正确方法是在第二次评估中。无论如何，下面的代码可以修复您的错误。

```
self.cursor.execute("SELECT weight FROM Equipment WHERE name = ?", (item,)) 
```

还将`cursor.execute`值参数作为字符串（这就是您正在执行的操作）导致示例中的第一次评估并导致您得到的错误。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-07-28T09:47:53.687

该[`sqlite3`](https://docs.python.org/2/library/sqlite3.html#cursor-objects)模块支持*两种*类型的参数占位符：

# qmark风格

使用一个或多个`?`来标记每个参数的位置，并提供参数列表或元组。例如：

```
curs.execute("SELECT weight FROM Equipment WHERE name = ? AND price = ?",
             ['lead', 24]) 
```

# 命名风格

为每个命名参数使用`:par`占位符，并提供一个字典。例如：

```
curs.execute("SELECT weight FROM Equipment WHERE name = :name AND price = :price",
             {name: 'lead', price: 24}) 
```

命名样式参数的优点是您无需担心参数的顺序，并且每个参数都`:par`可以在大型/复杂的 SQL 查询中多次使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T08:32:39.330

你试过这个吗？：

```
for item in self.inventory_names:
    t = (item,)
    self.cursor.execute("SELECT weight FROM Equipment WHERE name = ?", t)
    self.cursor.close() 
```

cursor.execute() 需要一个序列 (list,tuple) 作为第二个参数。(-> ddaa)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-10T15:54:12.650

引用（这就是括号的意思吗？）？with parens 似乎对我有用。我一直在尝试（字面意思）'？但我一直在

> ProgrammingError：提供的绑定数量不正确。当前语句使用 0，并且提供了 1。

当我这样做时：

> SELECT fact FROM factoids WHERE key LIKE (?)

代替：

> SELECT fact FROM factoids WHERE key LIKE '?'

有效。

这是一些python 2.6的东西吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-19T04:45:45.763

items 的每个元素都必须是一个元组。假设名称看起来像这样：

```
names = ['Joe', 'Bob', 'Mary'] 
```

您应该执行以下操作：

```
for item in self.inventory_names:
self.cursor.execute("SELECT weight FROM Equipment WHERE name = ?", (item, )) 
```

通过使用 (item, ) 您将其设为元组而不是字符串。

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2010-07-27T18:31:20.773

尝试

```
execute("select fact from factoids where key like ?", "%%s%" % val) 
```

您根本不需要包装任何东西`?`，Python sqlite 会正确地将其转换为带引号的实体。

# asp.net - 在 ASP.NET 中查找浏览器本地时间

> ID：228926
> 
> 赞同：3
> 
> 时间：2008-10-23T08:18:15.553
> 
> 标签：asp.net

如何在 ASP.NET 中找出浏览您网站的用户的当地时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T08:56:47.100

创建一个隐藏的输入控件，以便在下一页回发时将值返回到服务器。它需要在页面的 onload 事件中填充它，其中包含在 JavaScript 中创建的新 Date 对象的值。您将需要创建一个 JavaScript 函数来执行此操作，并使用 RegisterClientScriptBlock 将其添加到页面中。

像这样的东西；

```
function setNow(hiddenInputId)
{
     var now = new Date();
     var input = document.getElementById(hiddenInputId);

     if(input) input.value = now.toString();
} 
```

然后创建对传递隐藏输入的 ClientId 的函数的调用，然后使用 RegisterStartupScript 将该脚本添加到页面，以便它在页面加载时运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T08:34:46.223

您必须在客户端使用 JavaScript 来获取本地时间并将该值传递给服务器端。您可以使用查询字符串、隐藏字段甚至 AJAX 魔法来传递它。

# c# - 对 SSL 的 HttpWebRequest 失败

> ID：228931
> 
> 赞同：2
> 
> 时间：2008-10-23T08:20:51.710
> 
> 标签：c#, ssl, httpwebrequest

我正在使用此代码向给定 URL 发出请求：

```
private static string GetWebRequestContent(string url)
{
  string sid = String.Empty;

  HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(url);
  req.KeepAlive = false;

  using (HttpWebResponse res = (HttpWebResponse)req.GetResponse())
  {
    using (StreamReader sr = new StreamReader(res.GetResponseStream()))
    {
      sid = sr.ReadToEnd().Trim();
    }
  }

  return sid;
} 
```

我用它来测试工作负载均衡器的粘性，它后面有 3 个服务器。它们都有一个名为 sid.htm 的静态 HTM 文件，其中写入了服务器的服务器 ID。

对于带有 HTTP 的 URL，这可以正常工作。但是对于 HTTPS，它不起作用。我得到这个例外：

> 请求被中止：无法创建 SSL/TLS 安全通道。

目前，我在 WLB 后面只有 2 台服务器，另外一台在防火墙后面有一个公共 IP。如果我点击独立服务器，HTTPS 请求可以正常工作 - 但是当我点击 WLB 时，我会收到上述错误。

一件事：为了在单台服务器和 WLB 之间切换，我使用了我的 hosts 文件。我的域的 DNS 记录目前指向单个服务器。所以我在我的主机文件中放了一条记录来访问 WLB。这不应该引起问题...

**我的问题**：HttpWebRequest 使用哪些 SSL 凭证/证书？如果它使用 40 位 DES 或 56 位 DES，这就是原因，因为它们在 WLB 中被禁用。但自从 IE3 和 Netscape 1 和 2 以来，这些证书就没有在浏览器中使用过。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T08:31:05.903

它在我的浏览器中完美运行。

我发布问题后 1 分钟找到了解决方案：

```
ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3; 
```

这意味着 HttpWebRequest 使用的是 TLS 1.0 - 我不知道，但我假设它是 40 位 DES 或 56 位 DES，在 WLB 中被禁用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T08:40:57.473

您可能需要考虑负载均衡器的一些问题。我们使用的那些通过不安全的 HTTP 连接将 HTTPS 安全流量转发到其背后的服务器。负载平衡器和浏览器之间的连接仍然是安全的，但不需要平衡器和 Web 服务器之间的安全协议开销。

我们想检测 Web 服务器上的安全连接，但最初从未看到 HTTPS 连接。那时我们意识到平衡器背后的流量都是不安全的。一旦我们知道就有意义了。

我们现在要做的是将所有进入平衡器（端口 443）的安全流量转发到端口 81（替代 HTTP），然后将所有正常的 HTTP 流量（端口 80 和 81）转发到端口 80。然后我们可以在网络上检查端口服务器并且知道 80 是不安全的，并且 81 是浏览器和平衡器之间的安全流量，尽管事实上它在 Web 服务器上都是 HTTP。

# flashdevelop - 有没有办法在 FlashDevelop 中重新格式化代码？

> ID：228934
> 
> 赞同：9
> 
> 时间：2008-10-23T08:21:06.780
> 
> 标签：flashdevelop, hotkeys

有没有办法重新格式化代码，即在 FlashDevelop 中强制正确缩进，就像在 Eclipse 中使用 CTRL-SHIFT-F 一样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-01-14T14:33:47.070

由于 FlashDevelop 4 包含一个重新格式化程序：按`Ctrl`+ `Shift`+`2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-05T06:14:47.417

FlashDevelop 的这个插件对我有用：

[http://www.flashdevelop.org/community/viewtopic.php?f=4&t=5208](http://www.flashdevelop.org/community/viewtopic.php?f=4&t=5208)

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2008-12-31T08:58:30.367

打开netbeans 6.5，创建一个xml文件，然后粘贴你的mxml代码；右键单击，格式化代码，最后从 netbeans 复制此格式化文本并将其粘贴到 flex builder 中。这一切......我希望是有用的

# c# - 请有人能给我一个如何在 C# 中使用 System.Monitor 的简单示例吗？

> ID：228945
> 
> 赞同：4
> 
> 时间：2008-10-23T08:27:06.550
> 
> 标签：c#, multithreading

我发现 System.Monitor 非常令人困惑，尽管我了解线程、锁、死锁、竞争条件、哲学家进餐和所有这些爵士乐。通常我使用 ManualResetEvent() 来进行线程间协调，但我知道这是一个重量级的内核对象，而且 System.Monitor（Enter/Pulse 等）效率更高。我用谷歌搜索和搜索，但找不到一个合理的例子。

如果 SO 工作人员能够向我解释这个潜在的奇妙构造，我将不胜感激:-)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T08:42:36.567

这是一个非常简单的例子；调用`Wait`释放锁（允许`Worker`获取它）并将`Main`线程添加到锁对象的挂起队列中。`Worker`然后获得锁，并调用`Pulse`: 这将`Main`线程移动到锁对象的就绪队列中。当`Worker` *释放*锁时，`Main`可以恢复工作。

请注意，这`lock(obj) {...}`只是try/finally 块中`Monitor.Enter`/的编译器糖果。`Monitor.Exit`

[编辑：我将样本更改为`lock(sync)`更早移动，以避免错过脉冲的（不太可能的）风险]

```
 static void Main()
    {
        object sync = new object();
        lock (sync)
        {
            ThreadPool.QueueUserWorkItem(Worker, sync);
            Console.WriteLine("Main sleeping");

            // wait for the worker to tell us it is ready
            Monitor.Wait(sync);
            Console.WriteLine("Main woke up!");
        }
        Console.WriteLine("Press any key...");
        Console.ReadKey();
    }
    static void Worker(object sync)
    {
        Console.WriteLine("Worker started; about to sleep");
        Thread.Sleep(5000);
        Console.WriteLine("Worker about pulse");
        lock (sync)
        { // notify Main that we did something interesting
            Monitor.Pulse(sync);
            Console.WriteLine("Worker pulsed; about to release lock");
        }
        Console.WriteLine("Worker all done");
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T08:49:05.163

See if [this part of my threading article](http://pobox.com/~skeet/csharp/threads/deadlocks.shtml) helps... (the second half of that page). It implements a producer/consumer queue: when the producer produces something in the queue (and finds it was empty - as an optimisation), it pulses the monitor to wake up any waiting threads. When a consumer tries to consume from the queue but finds it empty, it waits for a pulse before trying again.

Alternatively, [Joe Albahari's threading tutorial](http://www.albahari.com/threading/part4.aspx#_Wait_and_Pulse) has a section on Wait/Pulse too.

It's quite similar to the WaitHandle stuff you're used to - although frankly I find it easier to get my head round than WaitHandles, mostly because it's so similar to the Java wait/notify that I "grew up" with :)

# .net - 无效的回发或回调参数。使用 ' 启用事件验证 '

> ID：228969
> 
> 赞同：243
> 
> 时间：2008-10-23T08:34:51.090
> 
> 标签：.net, asp.net, .net-2.0, postback, argumentexception

从客户端发回页面时出现以下错误。我有在客户端修改 asp:ListBox 的 JavaScript 代码。

我们如何解决这个问题？

错误详情如下：

```
Server Error in '/XXX' Application.

--------------------------------------------------------------------------------
Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.ArgumentException: Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[ArgumentException: Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.]
   System.Web.UI.ClientScriptManager.ValidateEvent(String uniqueId, String argument) +2132728
   System.Web.UI.Control.ValidateEvent(String uniqueID, String eventArgument) +108
   System.Web.UI.WebControls.ListBox.LoadPostData(String postDataKey, NameValueCollection postCollection) +274
   System.Web.UI.WebControls.ListBox.System.Web.UI.IPostBackDataHandler.LoadPostData(String postDataKey, NameValueCollection postCollection) +11
   System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +353
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1194

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.1433; ASP.NET Version:2.0.50727.1433 
```

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2010-09-21T09:30:42.230

您的 Page_Load 事件中有代码吗？如果是，那么添加以下内容可能会有所帮助。

```
if (!Page.IsPostBack)
{ //do something } 
```

当您单击命令并且再次运行 Page_load 时会引发此错误，在正常的生命周期中，它将是 Page_Load -> 单击命令 -> Page_Load（再次）-> 处理 ItemCommand 事件

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2008-10-23T09:03:28.427

问题是 ASP.NET 不知道这个额外的或删除的列表项。您有许多选项（如下所列）：

*   禁用事件验证（坏主意，因为您会失去一点安全性，而代价很小）。
*   使用 ASP.NET Ajax 更新面板。（如果您添加或删除列表框，请将列表框放在更新面板中并触发更新。这样视图状态和相关字段将获得更新并且事件验证将通过。）
*   忘记客户端并使用经典的回发并在服务器端添加或删除列表项。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-11-09T07:57:56.263

我有使用 DataGrid 的经验。其中一列是“选择”按钮。当我单击任何行的“选择”按钮时，我收到了此错误消息：

> “无效的回发或回调参数。事件验证在配置中使用或在页面中启用 <%@ Page EnableEventValidation="true" %>。出于安全目的，此功能验证回发或回调事件的参数是否来自服务器控件“

改了几个代码，终于成功了。我的体验路线：

1）我将页面属性更改为`EnableEventValidation="false"`. ***但它没有用。*** （这不仅出于安全原因很危险，而且我的事件处理程序没有被调用：`void Grid_SelectedIndexChanged(object sender, EventArgs e)`

2）我`ClientScript.RegisterForEventValidation`在 Render 方法中实现。***但它没有用。***

```
protected override void Render(HtmlTextWriter writer)
{
    foreach (DataGridItem item in this.Grid.Items)
    {
        Page.ClientScript.RegisterForEventValidation(item.UniqueID);
        foreach (TableCell cell in (item as TableRow).Cells)
        {
            Page.ClientScript.RegisterForEventValidation(cell.UniqueID);
            foreach (System.Web.UI.Control control in cell.Controls)
            {
                if (control is Button)
                    Page.ClientScript.RegisterForEventValidation(control.UniqueID);
            }
        }
    }
} 
```

3）我将网格列中的按钮类型从`PushButton`更改为`LinkButton`。***有效！***("ButtonType="LinkBut​​ton")。我认为如果您可以在其他情况下将按钮更改为其他控件，例如“LinkBut​​ton”，它将正常工作。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-10-29T01:35:13.610

你真的想做 2 或 3，不要禁用事件验证。

向 asp:listbox 客户端添加项目有两个主要问题。

*   首先是它会干扰事件验证。返回到服务器的不是它发送下来的。

*   第二个是即使您禁用事件验证，当您的页面被回发时，列表框中的项目将从视图状态中重建，因此您在客户端上所做的任何更改都将丢失。这样做的原因是 asp.net 不希望在客户端上修改列表框的内容，它只希望进行选择，因此它会丢弃您可能所做的任何更改。

最好的选择是最有可能使用推荐的更新面板。如果您确实需要在客户端执行此操作，另一种选择是使用普通的 old`<select>`而不是`<asp:ListBox>`，并将您的项目列表保存在隐藏字段中。当页面在客户端上呈现时，您可以从文本字段内容的拆分中填充它。

然后，当您准备好发布它时，您从修改后的 .xml 文件中重新填充隐藏字段的内容`<select>`。然后，当然，你必须在服务器上再次拆分它并对你的项目做一些事情，因为你的选择现在是空的，现在它又回到了服务器上。

总而言之，这是一个非常麻烦的解决方案，我不会真正推荐，但如果您真的必须对 listBox 进行客户端修改，它确实有效。但是，我真的建议您在走这条路线之前先查看 updatePanel。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2016-04-19T16:39:49.527

以上都不适合我。经过更多挖掘后，我意识到我忽略了导致问题的页面上应用的 2 个表单。

```
<body>
<form id="form1" runat="server">
<div>
        <form action="#" method="post" class="form" role="form">
        <div>
        ...
        <asp:Button ID="submitButton" runat="server"
        </div>
</div>
</body> 
```

请注意，最近 ASP.NET 已开始考虑在表单标记中包含 iframe 文档中的表单标记的 iframe 本身就是一个嵌套框架。我不得不将 iframe 移出表单标签以避免此错误。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-11-19T12:25:25.553

我在使用Repeater 时遇到了同样的问题，因为我在启用了EnableEventValidation 的网站中有一个带有Repeater 控件的网页。这不好。我收到了无效的回发相关异常。

对我有用的是为中继器设置 EnableViewState="false"。优点是使用起来更简单，就像关闭网站或网页的事件验证一样简单，但范围远小于关闭任何一个的事件验证。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-10-13T06:25:29.507

在客户端上使用 JavaScript 修改 ListBox 时，我遇到了同样的问题。当您从客户端向 ListBox 添加在呈现页面时不存在的新项目时，会发生这种情况。

我找到的解决方法是通知事件验证系统所有可以从客户端添加的有效项目。您可以通过覆盖 Page.Render 并为您的 JavaScript 可以添加到列表框中的每个值调用 Page.ClientScript.RegisterForEventValidation 来执行此操作：

```
protected override void Render(HtmlTextWriter writer)
{
    foreach (string val in allPossibleListBoxValues)
    {
        Page.ClientScript.RegisterForEventValidation(myListBox.UniqueID, val);
    }
    base.Render(writer);
} 
```

如果列表框有大量潜在的有效值，这可能会有点痛苦。在我的例子中，我在两个 ListBox 之间移动项目——一个具有所有可能的值，另一个最初是空的，但当用户单击按钮时，会用 JavaScript 中第一个值的子集填充。在这种情况下，您只需要遍历第一个 ListBox 中的项目并将每个项目注册到第二个列表框中：

```
protected override void Render(HtmlTextWriter writer)
{
    foreach (ListItem i in listBoxAll.Items)
    {
        Page.ClientScript.RegisterForEventValidation(listBoxSelected.UniqueID, i.Value);
    }
    base.Render(writer);
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-02-28T15:56:41.163

这里没有提到的另一种方法是继承 ListBox

IE。

```
public class ListBoxNoEventValidation : ListBox 
{
} 
```

ClientEventValidation 关闭属性 System.Web.UI.SupportsEventValidation 如果您将其子类化，除非您明确将其重新添加，否则它将永远不会调用验证例程。这适用于任何控件，并且是我发现在逐个控件的基础上“禁用”它的唯一方法（即，不是页面级别）。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-08-18T05:46:01.653

您在 .aspx 页面中尝试类似的操作

添加

> EnableEventValidation="假"

您可以随时提出任何问题！

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-12-11T20:43:00.507

如果您通过客户端脚本填写 DropdownList，则在将表单提交回服务器之前清除列表；然后 ASP.NET 不会抱怨，安全性仍然存在。

要从 DDL 中选择数据，您可以将“OnChange”事件附加到 DDL 以在隐藏的 Input 或 Style="display: none;" 的文本框中收集值

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-02-19T00:39:34.150

> 3：我将网格列中的按钮类型从“PushButton”更改为“LinkBut​​ton”。有效！("ButtonType="LinkBut​​ton") 我认为如果您可以在其他情况下将按钮更改为其他控件，例如“LinkBut​​ton”，它将正常工作。

我希望我能投票给你，阿米尔（唉，我的代表太低了。）我只是遇到了这个问题，改变它就像我的 gridview 上的冠军一样。顺便说一句，我认为有效的代码是： ButtonType="Link"

我怀疑这是因为当您单击“编辑”时，您的编辑更改为“更新”和“取消”，然后在提交时又变回“编辑”。而这些不断变化的控制让 .net 感到不安。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-03-30T02:58:11.807

(1) EnableEventValidation="false".......它对我不起作用。

(2) ClientScript.RegisterForEventValidation....它对我不起作用。

**解决方案1：**

在 GridView 中将 Button/ImageButton 更改为 LinkBut​​ton。有用。（但我喜欢 ImageButton）

研究：Button/ImageButton 和 LinkBut​​ton 使用不同的方法来回发

**来源文章：**

[http://geekswithblogs.net/mahesh/archive/2006/06/27/83264.aspx](http://geekswithblogs.net/mahesh/archive/2006/06/27/83264.aspx)

**解决方案2：**

在 OnInit() 中，输入类似这样的代码来设置 Button/ImageButton 的唯一 ID：

```
protected override void OnInit(EventArgs e) {
  foreach (GridViewRow grdRw in gvEvent.Rows) {

  Button deleteButton = (Button)grdRw.Cells[2].Controls[1];

  deleteButton.ID = "btnDelete_" + grdRw.RowIndex.ToString();           
  }
} 
```

**来源文章：**

[http://www.c-sharpcorner.com/Forums/Thread/35301/](http://www.c-sharpcorner.com/Forums/Thread/35301/)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-04-21T12:34:03.750

我实现了一个嵌套的网格视图，我遇到了同样的问题。我使用了 LinkBut​​ton 而不是像这样的图像按钮：

在我有这样的专栏之前：

```
<asp:TemplateField ItemStyle-Width="9">
  <ItemTemplate>
 <asp:ImageButton ID="ImgBtn" ImageUrl="Include/images/gridplus.gif" CommandName="Expand"
                        runat="server" />
  </ItemTemplate>
</asp:TemplateField> 
```

我已经换成这样了。

```
<asp:TemplateField>
<ItemTemplate>
     <asp:LinkButton  CommandName="Expand" ID="lnkBtn"  runat="server" ><asp:Image  ID="Img"  runat="server" ImageUrl="~/Images/app/plus.gif" /></asp:LinkButton>
      </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2010-11-14T16:05:19.640

我有一个类似的问题，但我没有使用 ASP.Net 1.1，也没有通过 javascript 更新控件。我的问题只发生在 Firefox 上，而不是 IE（！）。

我在 PreRender 事件的 DropDownList 中添加了选项，如下所示：

```
DropDownList DD = (DropDownList)F.FindControl("DDlista");
HiddenField HF = (HiddenField)F.FindControl("HFlista");
string[] opcoes = HF.value.Split('\n');
foreach (string opcao in opcoes) DD.Items.Add(opcao); 
```

我的“HF”（隐藏字段）的选项由换行符分隔，如下所示：

```
HF.value = "option 1\n\roption 2\n\roption 3"; 
```

问题是 HTML 页面在代表 DropDown 的“选择”选项上被破坏（我的意思是有换行符）。

所以我解决了我的问题，添加了一行：

```
DropDownList DD = (DropDownList)F.FindControl("DDlista");
HiddenField HF = (HiddenField)F.FindControl("HFlista");
string dados = HF.Value.Replace("\r", "");
string[] opcoes = dados.Split('\n');
foreach (string opcao in opcoes) DD.Items.Add(opcao); 
```

希望这对某人有所帮助。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2011-02-20T07:37:17.533

如果你改变`UseSubmitBehavior="True"` 你 `UseSubmitBehavior="False"`的问题将得到解决

```
<asp:Button ID="BtnDis" runat="server" CommandName="BtnDis" CommandArgument='<%#Eval("Id")%>' Text="Discription" CausesValidation="True" UseSubmitBehavior="False" /> 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-08-05T08:55:28.647

我遇到了同样的问题，我做了什么：

刚刚添加了一个条件`if(!IsPostBack)`，它工作正常:)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-12-26T15:03:03.527

此错误将在没有回发的情况下显示

添加代码：

```
If(!IsPostBack){

 //do something

} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-12-21T14:16:02.213

Ajax **UpdatePanel**做到了，我认为这是**最简单**的方法，忽略了**Ajax 回**发开销。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-05-05T12:55:11.183

在这种情况下，将 id 添加到网格的 RowDataBound 中的按钮。它会解决你的问题。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-01-13T04:58:10.597

此问题的一个简单解决方案是在页面加载时使用**IsPostBack检查。**这将解决这个问题。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-02-17T18:56:26.710

当我们将常规 ASPX 页面转换为内容页面时，我们遇到了同样的问题。

存在此问题的页面`</form>`在其中一个内容部分中有一个标签，因此在运行时呈现了两个表单结束标签，这导致了此问题。从页面中删除额外的表单结束标记解决了这个问题。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-10-21T18:50:37.267

我知道这是一个超级古老的帖子。假设您正在调用您的应用程序，这是一个对我有用的想法：

1.  在您的页面上实现 ICallbackEventHandler
2.  调用 ClientScriptManager.GetCallbackEventReference 来调用你的服务器端代码
3.  如错误消息所述，您可以调用 ClientScriptManager.RegisterForEventValidation

如果您不需要完全控制，您可以使用更新面板来为您执行此操作。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-03-22T11:46:25.517

如果您使用的是 gridview 并且没有在 !ispostback 内的页面加载中绑定 gridview ，那么当您单击 gridview 中的编辑和删除行时会发生此错误。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
        bindGridview();
        } 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-03-08T13:49:03.900

我正在使用 datalist，但我的按钮也出现了同样的错误。我只是使用 IsPostBack 检查并填写我的控件，问题就解决了！伟大的！！！

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2010-07-27T18:59:39.437

四分钟前我收到了同样的错误。然后我和你一样研究了一个半小时。在所有论坛中，他们通常说“添加页面 enableEvent..=false 或 true”。任何提出的解决方案都没有解决我的问题，直到我找到它。不幸的是，问题是一个 ASP.NET 按钮。我在两秒钟前删除了它。我试图用“imagebutton”替换，但这也是不可接受的（因为它给出了同样的错误）。

最后我换成了`LinkButton`. 它似乎正在工作！

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2010-10-14T21:35:27.863

对我有用的是将以下代码从 page_load 移动到 page_prerender：

```
lstMain.DataBind();
Image img = (Image)lstMain.Items[0].FindControl("imgMain");

// Define the name and type of the client scripts on the page.
String csname1 = "PopupScript";
Type cstype = this.GetType();

// Get a ClientScriptManager reference from the Page class.
ClientScriptManager cs = Page.ClientScript;

// Check to see if the startup script is already registered.
if (!cs.IsStartupScriptRegistered(cstype, csname1))
{
    cs.RegisterStartupScript(cstype, csname1, "<script language=javascript> p=\"" + img.ClientID + "\"</script>");
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-05-04T12:50:57.253

如果您使用的是 Ajax 更新面板。添加`<Triggers>`标签并在其中触发 Button 或控件导致 postBack 使用`<asp:PostBackTrigger .../>`

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2011-06-14T13:12:44.373

最好的选择是使用隐藏字段并且不禁用事件验证，还要更改每个列表框、下拉列表以使用 runat 服务器属性进行选择

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2012-12-19T09:50:41.753

如果您事先知道可以填充的数据，则可以使用 ClientScriptManager 来解决此问题。在以前的用户选择中使用 javascript 动态填充下拉框时，我遇到了这个问题。

下面是一些示例代码，用于覆盖渲染方法（在 VB 和 C# 中）并声明下拉列表 ddCar 的潜在值。

在 VB 中：

```
Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)

    Dim ClientScript As ClientScriptManager = Page.ClientScript

    ClientScript.RegisterForEventValidation("ddCar", "Mercedes")

    MyBase.Render(writer)
End Sub 
```

或 C# 中的细微变化可能是：

```
protected override void Render(HtmlTextWriter writer)
{
    Page.ClientScript.RegisterForEventValidation("ddCar", "Mercedes");
    base.Render(writer);
} 
```

对于新手：这应该放在文件后面的代码中（.vb 或 .cs），或者如果在 aspx 文件中使用，您可以用`<script>`标签包装。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2013-10-11T13:56:52.437

这就是我得到它的原因：

我有一个 ASP:ListBox。最初它是隐藏的。在客户端，我将通过 AJAX 使用选项填充它。用户选择了一个选项。然后，当单击提交按钮时，服务器会对 ListBox 感到很有趣，因为它不记得它有任何选项。

所以我所做的是确保在将表单提交回服务器之前清除所有列表选项。这样服务器就不会抱怨，因为列表到客户端是空的，然后又是空的。

排序！！！

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2015-07-02T14:48:44.513

正如尼克 B 所说，这对我有用，在某些情况下你必须删除换行符。看一下代码：

-错误的方法：

```
<asp:DropDownList ID="DropDownList1" runat="server">
    <asp:ListItem Selected="True">
            Item 1</asp:ListItem>
    <asp:ListItem>
            Item 2</asp:ListItem>
    <asp:ListItem>
            Item 3</asp:ListItem>
</asp:DropDownList> 
```

-正确的方法：

```
<asp:DropDownList ID="DropDownList1" runat="server">
    <asp:ListItem Selected="True">Item 1</asp:ListItem>
    <asp:ListItem>Item 2</asp:ListItem>
    <asp:ListItem>Item 3</asp:ListItem>
</asp:DropDownList> 
```

它只发生在 IE10+ 中

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2016-03-23T15:07:28.690

在远程服务器（生产、测试​​、qa、登台等）上出现此问题后，但在本地开发工作站上没有出现此问题后，我发现应用程序池配置的 RequestLimit 不是 0。

这导致应用程序池放弃并回复问题中提到的异常。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2019-06-19T13:35:02.520

对我们来说，问题只是在生产环境中随机发生。RegisterForEventValidation 对我们没有任何帮助。

最后，我们发现在运行 asp.net 应用程序的网络场中，两台 IIS 服务器安装了不同的 .net 版本。所以看起来他们有不同的加密 asp.net 验证哈希的规则。更新它们解决了大部分问题。

另外，我们在两台服务器的 web.config 中配置了 machineKey(compatibilityMode)（两台服务器相同）、httpRuntime(targetFramework)、ValidationSettings:UnobtrusiveValidationMode、pages(renderAllHiddenFieldsAtTopOfForm)。

我们使用此站点生成密钥[https://www.allkeysgenerator.com/Random/ASP-Net-MachineKey-Generator.aspx](https://www.allkeysgenerator.com/Random/ASP-Net-MachineKey-Generator.aspx)

我们花了很多时间解决这个问题，我希望这对某人有所帮助。

```
<appSettings>
   <add key="ValidationSettings:UnobtrusiveValidationMode" value="None" />
...
</appSettings>
<system.web>
   <machineKey compatibilityMode="Framework45" decryptionKey="somekey" validationKey="otherkey" validation="SHA1" decryption="AES />
   <pages [...] controlRenderingCompatibilityVersion="4.0" enableEventValidation="true" renderAllHiddenFieldsAtTopOfForm="true" />
   <httpRuntime [...] requestValidationMode="2.0" targetFramework="4.5" />
...
</system.web> 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-04-23T22:22:51.670

我通过不将 ListBox 添加到父 Page/Control Controls 集合来解决这个确切的错误。因为我真的不需要任何服务器端功能。我只是想用它来输出自定义服务器控件的 HTML，这是我自己在 OnRender 事件处理程序中完成的。我希望使用该控件可以使我免于将自己的 html 写入响应。

此解决方案可能对大多数人不起作用，但它使 ASP.NET 无法对控件执行 ValidateEvent，因为控件在回发之间不会保留在内存中。

此外，我的错误特别是由于所选列表项是上一次回发时不在列表框中的项目。万一这对任何人都有帮助。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-10-01T20:56:13.677

当我在 ItemDataBound 上添加 id 时，它没有给我错误，但它没有给我命令名称。它返回的命令名称为空。然后我在 ItemDataBound 时也添加了命令名称。然后它解决了同样的问题。谢谢尼莱什，很好的建议。有效 ：）

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2013-11-06T16:04:03.643

我有同样的问题，两个列表框和两个按钮。

列表框中的数据是从数据库中加载的，您可以通过单击按钮在框之间移动项目。

我收到了无效的回发。

结果是数据中有回车换行符，当显示在列表框中时您看不到。

在除 IE 10 和 IE 11 之外的所有浏览器中都能正常工作。

删除回车换行符，一切正常。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2015-03-11T17:12:10.173

仅供参考，我对该错误消息有同样的问题，那就是我在同一页面上有 2 个表单标签。母版页中有一个，页面本身中有一个。当我删除第二个表单标签对后，问题就消失了。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2017-02-21T00:40:55.077

下面的示例演示如何在加载页面时测试 IsPostBack 属性的值，以确定页面是第一次呈现还是响应回发。如果页面是第一次呈现，代码将调用 Page.Validate 方法。页面标记（未显示）包含RequiredFieldValidator 控件，如果没有为必填输入字段输入任何条目，这些控件会显示星号。调用 Page.Validate 会导致在呈现页面时立即显示星号，而不是等到用户单击“提交”按钮。回发后，您不必调用 Page.Validate，因为该方法是作为 Page 生命周期的一部分调用的。

```
 private void Page_Load()
    {
        if (!IsPostBack)
        {      
        }
    } 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2018-08-21T14:49:23.167

在服务器端的网格事件结束时取消事件时，我的问题得到了解决。

```
protected void grdEducation_RowEditing(object sender, GridViewEditEventArgs e)
{
  // do your processing ...

  // at end<br />
  e.Cancel = true;
} 
```

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2010-09-23T08:32:02.173

检查您绑定控件的数据。一些无效数据损坏了 ValidateEvent。

# perl - 如何减少常量中的重复？

> ID：228978
> 
> 赞同：6
> 
> 时间：2008-10-23T08:40:41.327
> 
> 标签：perl, refactoring, constants

我有这个 Perl 脚本，其中包含许多已定义的配置文件常量。例如：

```
use constant  {
LOG_DIR                             => "/var/log/",
LOG_FILENAME                        => "/var/log/file1.log",
LOG4PERL_CONF_FILE                  => "/etc/app1/log4perl.conf",
CONF_FILE1                          => "/etc/app1/config1.xml",
CONF_FILE2                          => "/etc/app1/config2.xml",
CONF_FILE3                          => "/etc/app1/config3.xml",
CONF_FILE4                          => "/etc/app1/config4.xml",
CONF_FILE5                          => "/etc/app1/config5.xml",
}; 
```

我想减少 "/etc/app1" 和 "/var/log" 的重复，但使用变量不起作用。同样使用先前定义的常量在同一个“使用常量块”中也不起作用。例如：

```
use constant {
LOG_DIR                             => "/var/log/",
FILE_FILENAME                       => LOG_DIR . "file1.log" 
}; 
```

不起作用。

使用单独的“使用常量”块可以解决这个问题，但这会增加很多不需要的代码。

这样做的正确方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T12:36:24.457

> 使用单独的“使用常量”块可以解决这个问题，但这会增加很多不需要的代码。

真的吗？

```
use constant BASE_PATH => "/etc/app1";

use constant  {
    LOG4PERL_CONF_FILE                  => BASE_PATH . "/log4perl.conf",
    CONF_FILE1                          => BASE_PATH . "/config1.xml",
    CONF_FILE2                          => BASE_PATH . "/config2.xml",
    CONF_FILE3                          => BASE_PATH . "/config3.xml",
    CONF_FILE4                          => BASE_PATH . "/config4.xml",
    CONF_FILE5                          => BASE_PATH . "/config5.xml",
}; 
```

我没有看到很多问题。您只在一点上指定了基本路径，因此遵守了 DRY 原则。如果您为 BASE_PATH 分配环境变量：

```
use constant BASE_PATH => $ENV{MY_BASE_PATH} || "/etc/app1"; 
```

...然后您就有了一种廉价的方式来重新配置您的常量，而无需编辑您的代码。这有什么不喜欢的？

如果您真的想减少重复的“BASE_PATH .”连接，您可以添加一些机制来自己安装常量并将其排除：

```
use strict;
use warnings;

use constant BASE_PATH => $ENV{MY_PATH} || '/etc/apps';

BEGIN {
    my %conf = (
        FILE1 => "/config1.xml",
        FILE2 => "/config2.xml",
    );

    for my $constant (keys %conf) {
        no strict 'refs';
        *{__PACKAGE__ . "::CONF_$constant"}
            = sub () {BASE_PATH . "$conf{$constant}"};
    }
}

print "Config is ", CONF_FILE1, ".\n"; 
```

但在这一点上，我认为天平已经从正确转向讨厌 :) 首先，您不能再 grep 查找 CONF_FILE1 并查看它的定义位置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-23T09:14:12.773

我可能会这样写：

```
use Readonly;

Readonly my $LOG_DIR            => "/var/log";
Readonly my $LOG_FILENAME       => "$LOG_DIR/file1.log";
Readonly my $ETC                => '/etc/app1';
Readonly my $LOG4PERL_CONF_FILE => "$ETC/log4perl.con";

# hash because we don't have an index '0'
Readonly my %CONF_FILES => map { $_ => "$ETC/config$_.xml" } 1 .. 5; 
```

然而，这仍然是很多代码，但它确实消除了重复，这是一个胜利。

为什么你的日志文件是数字的？如果它们以 0 开头，则数组是比散列更好的选择。如果它们被命名，它们将更具描述性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T14:54:12.773

```
use constant +{
    map { sprintf $_, '/var/log' } (
        LOG_DIR            => "%s/",
        LOG_FILENAME       => "%s/file1.log",
    ),
    map { sprintf $_, '/etc/app1' } (
        LOG4PERL_CONF_FILE => "%s/log4perl.conf",
        CONF_FILE1         => "%s/config1.xml",
        CONF_FILE2         => "%s/config2.xml",
        CONF_FILE3         => "%s/config3.xml",
        CONF_FILE4         => "%s/config4.xml",
        CONF_FILE5         => "%s/config5.xml",
    ),
}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-23T08:47:40.113

可悲的是，这行不通。这样做的原因是您在定义函数（“常量”）之前就使用了它们。您在调用之前评估它们`constant->import`。

使用变量不起作用，因为 use 语句是在编译时评估的。分配给变量只在运行时完成，所以它们还不会被定义。

我能给出的唯一解决方案是将其拆分为多个`use constant`语句。在这种情况下，两个语句会做（一个用于`LOG_DIR`and `CONF_DIR`，另一个用于其余的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T20:36:29.813

根据您在做什么，您可能根本不需要常量。大多数情况下，我编写其他人用来完成工作的东西，所以我以一种给其他程序员灵活性的方式来解决这个问题。我把这些东西变成了方法：

```
 sub base_log_dir { '...' }

 sub get_log_file
      {
      my( $self, $number ) = @_;

      my $log_file = catfile( 
        $self->base_log_dir, 
        sprintf "foo%03d", $number
        );
      } 
```

通过这样做，我可以轻松地扩展或覆盖事物。

但是这样做会失去不断折叠的价值，所以你必须考虑这对你有多重要。

# ruby-on-rails - 在rails中需要acts_as_taggable的gem

> ID：228985
> 
> 赞同：2
> 
> 时间：2008-10-23T08:43:38.030
> 
> 标签：ruby-on-rails, ruby

我正在尝试让标签在我的 rails 应用程序中工作，并希望使用acts_as_taggable。首先，我按照我在 Rails Recipies（一个免费的在线示例位）中找到的使用acts_as_taggable 插件的说明进行操作。但是，然后我发现[这个站点](http://taggable.rubyforge.org/)似乎有一个更高级的acts_as_taggable gem（具有相关标签等选项）。

我尝试按照那里的说明进行安装，但我不断收到错误消息。

首先，我正常安装了 gem ( `gem install acts_as_taggable`)，然后我尝试了各种方法来让 rails 识别和加载 gem。网站`require_gem`上列出的命令不起作用（我认为这是一个已被删除的旧命令），直接命令也没有`require`（尽管这对我的 bluecloth gem 有效）。

然后我尝试使用`config.gem 'acts_as_taggable'`，但它一直告诉我我没有安装acts_as_taggable 并要求我运行`rake gems:install`。无论我运行多少次，它仍然会给出错误！

列表的结果`gem query -l -n acts_as_taggable`作为已安装的本地 gem 的acts_as_taggable。

我试过跑步`gem check`，没有任何问题。

当我尝试从控制台要求它时得到的响应是：

```
MissingSourceFile: no such file to load -- acts_as_taggable
        from c:/ruby/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:27:in `ge
m_original_require'
        from c:/ruby/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:27:in `re
quire'
        from c:/ruby/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_suppo
rt/dependencies.rb:510:in `require'
        from c:/ruby/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_suppo
rt/dependencies.rb:355:in `new_constants_in'
        from c:/ruby/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_suppo
rt/dependencies.rb:510:in `require'
        from (irb):1 
```

似乎由于某种原因找不到它。任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T01:06:59.033

您也可以尝试[act_as_taggable_on_steroids](http://agilewebdevelopment.com/plugins/acts_as_taggable_on_steroids)：

> 该插件基于 DHH 的acts_as_taggable，但包括测试、更智能的标签分配和标签云计算等附加功能。

我最近用过。除了一些性能问题之外，它运行良好，并且与[taggable](http://taggable.rubyforge.org/)不同，它正在积极维护中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T08:55:03.357

您是否尝试过运行“gem query -l -n *taggable* ”之类的东西来检查它是否已正确安装到您的本地 gem 存储库中？

如果有，您可以使用一些内置检查来检查它[——Gem 对此很有用](http://www.rubygems.org/read/chapter/10)——以确保它按预期安装。

那将是我探索的第一个途径。

# java - 为什么 byteArray 的长度是 22 而不是 20？

> ID：228987
> 
> 赞同：47
> 
> 时间：2008-10-23T08:45:38.650
> 
> 标签：java, encoding, string, bytearray

我们尝试从字符串转换为`Byte[]`使用以下 Java 代码：

```
String source = "0123456789";
byte[] byteArray = source.getBytes("UTF-16"); 
```

我们得到一个长度为 22 字节的字节数组，我们不确定这个填充是从哪里来的。如何获得长度为 20 的数组？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-10-23T08:53:15.700

[亚历山大的回答](https://stackoverflow.com/questions/228987/convert-string-to-byte-in-java#228998)解释了它为什么存在，但没有解释如何摆脱它。您只需在编码名称中指定所需的字节顺序：

```
String source = "0123456789";
byte[] byteArray = source.getBytes("UTF-16LE"); // Or UTF-16BE 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-23T08:50:31.293

可能前两个字节是[Byte Order Mark](http://en.wikipedia.org/wiki/Byte_Order_Mark)。它指定编码中使用的每个 16 位字中的字节顺序。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-23T08:52:42.893

尝试以十六进制打印字节以查看额外的 2 个字节添加到何处 - 它们是在开头还是结尾？

我选择你会在开头找到一个[字节顺序标记](http://en.wikipedia.org/wiki/Byte_Order_Mark)（0xFEFF）——这允许任何消费（接收）字节数组的人识别编码是小端还是大端。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-23T08:59:48.480

UTF 在开头有一个字节顺序标记，表明该流是以特定格式编码的。正如其他用户指出的那样，第
一个字节是 0XFE
第二个字节是 0XFF
其余字节是
0
48
0
49
0
50
0
51
0
52
0
53
0
54
0
55
0
56
0
57

# processor - 在 FPGA 板上实现的可配置处理器

> ID：228989
> 
> 赞同：4
> 
> 时间：2008-10-23T08:45:53.983
> 
> 标签：processor, vhdl, fpga, configurable

对于一个大学的中期项目，我必须设计一个可配置的处理器，用 VHDL 编写代码，然后在 Digilent 的 Spartan 3E FPGA 板上综合它。我是一个初学者，所以你能告诉我一些关于可配置处理器的信息，一些与这个概念相关的想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T23:11:41.533

您可以查看我[对相关问题的回答](https://stackoverflow.com/questions/148229/best-way-to-learn-how-to-use-fpgas#367127)。我们做了几乎相同的事情，用 VHDL 为 FPGA 板构建 CPU。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-04T07:37:59.300

这只是一个模型，所以请注意我会清理它

fetch instruct1，
fetch instruct2，fetch datas1
fetch instruct3，fetch datas2，process datas1
fetch instruct4，fetch datas3，process datas2，store1 datas1
fetch instruct5，fetch datas4，process datas3， store2 datas1
获取指令 6，获取数据 5，处理数据 4，存储 3 数据 1
获取指令 7，获取数据 6，处理数据 5，存储 4 数据 1
获取指令 8，获取数据 7，处理数据 6，存储 5 数据 1

基本上这些是处理器第 1 部分 ALU 的主要组件： 算术逻辑单元（这是 draeing 派上用场的地方） ALU 有 2 个输入端口和一个输出端口。对 2 个输入端口进行操作并输出结果。要知道 ALU 必须完成哪条指令，有一个控制端口。基本上这是命令的名称。因此，如果控制端口有 4 位，则有 16 条可能的指令。

第 2 部分 寄存器单元：这是一组存储单元（高速缓存）。该存储器的内容通常被传送到 ALU 的输入端口。

Part3 控制单元：这有点像 CPU 的管弦乐队大师。它的工作是 1 将数据发送到 ALU 输入 2 读取指令寄存器中需要发生的指令，将这些代码发送到 ALU 控制端口

界面。这是 RAM 和其他外围设备与 cpu 通信的方式

每次指令输出结果时，都必须存储它。它可以存储在 RAM 中，因此一旦结果准备好，就必须准备好 RAM 写入。同时，可以对下一条指令的输入进行 RAM 读取。同时，可以从 RAM 中获取下一条下一条指令。

生成 1 条指令通常需要超过 1 个时钟周期。处理指令类似于工业生产。这样链式工作就完成了。

VLIW 我们编写的程序是线性的，这意味着指令一个接一个地发生。但是今天的 CPU（虽然不是 ARM）有多个 ALU，因此可以同时处理多个指令。

所以你有处理单元链同时处理多个指令（管道），你有很多这些单元（超标量）

然后它变成了一个可以/需要做什么来定制你的 cpu 架构的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-04T08:15:17.337

我做了一个类似的项目，用 VHDL 实现了一个带有 5 级管道的处理器。

首先，您必须了解处理器如何工作的架构。如果不了解每个 stange 正在做什么以及您需要什么样的控制信号，您就没有希望实际用 VHDL 编写一个。

其次，开始绘制指令和数据将如何流经处理器（即通过每个阶段）的图表。每个阶段如何相互连接？控制信号去哪儿了？我的输入来自哪里，我的输出去哪里？

一旦你有一个实体图，VHDL 中的实际实现应该相对简单。您可以使用 VHDL 的行为建模来准确解释您在图中看到的内容。

# windows - 是否可以通过 Citrix 客户端建立 SSH 隧道？

> ID：228992
> 
> 赞同：16
> 
> 时间：2008-10-23T08:47:40.907
> 
> 标签：windows, deployment, ssh, citrix

我知道这不是一个严格的程序员问题，另一方面，我真的很希望能够`svn up`在生产服务器上做一个简单的事情，这样可以为我们节省很多麻烦。

或者生产服务器在公司网络中，并且只允许通过网关服务器进行访问。从那里我们可以通过远程桌面访问实际的服务器。由于这种维护不友好的设置，我们使用 sftp 服务器将文件发送到生产服务器（ftp 服务器总是重置上次修改日期），因此很难确定哪些文件已更改。

因此，如果可以通过 citrix 连接从实际服务器设置 ssh 隧道，它将简化整个更新过程。

（我考虑的进一步选择是使用 bazaar 将我们的更新推送到 sftp 服务器，然后从那里提取更新，但不幸的是，没有适用于 bazaar 的可用 svn 插件 [on windows]）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T06:24:25.537

好的，不希望这个问题仍未解决，我在 alt.os.citrix 的 usenet 上发布了以下内容：

> 大家好
> 
> 有人问我这个问题。我没有头绪。有任何想法吗？
> 
> “我的连接是 PC -> Citrix Access Gateway -> 实际服务器。我的问题是，是否可以建立从我的 PC 到实际服务器的 ssh 连接。”

我从凯瑟琳杰斐逊那里得到的回应是：

> 应该。我一直使用 Access Gateway VPN 执行此操作，然后通过 ssh 连接到公司 LAN 内的服务器。
> 
> 该用户正在运行什么版本的 Access Gateway？我在 Citrix 工作，也许能为他或她得到更具体的答案。

所以我可以建议你加入 alt.os.citrix（如果你没有 NNTP 工具，可能通过[谷歌群组）并购买](http://groups.google.com/group/alt.os.citrix/topics)[对话](http://groups.google.com/group/alt.os.citrix/browse_thread/thread/994808035d9e8d21#)。

——布鲁斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-24T21:44:25.537

我经常这样做。隧道就像：ssh -nvCXAN -L 1494:10.0.2.39:1494 www.starshipping.com &

然后，您需要一个指向 localhost 的 ICA 文件。

```
[WF客户端]
版本=2

[应用服务器]
连接到 Citrix 服务器=

[连接到 Citrix 服务器]
WinStationDriver=ICA 3.0
传输驱动程序=TCP/IP
客户端音频=关闭
所需颜色=8
用户名=您的用户名
域=您的域
密码=xxxxxxxxx ; 必须加密。我从内部生成的另一个 ICA 文件中提取
屏幕百分比=97
TWIMode=OFF
地址=本地主机

```

这一切在 OSX 上运行得非常好，直到 Citrix 发布了一个新版本的 Citrix 客户端，现在称为 Citrix Online Plugin。从那以后一直无法让它工作。同时，我们的 VPN 一直运行良好，所以不必太担心。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2008-10-28T03:25:15.963

[Citrix over SSH](http://www.boran.com/security/sp/ssh-part1.html#Doing%20even%20more%20with%20SSH), [How to Create a Key Pair for SSH Authentication Using PuTTYgen](http://support.citrix.com/article/CTX109009), [Terminals](http://www.codeplex.com/Terminals). It seems that the answers are "out there" but not readily found. That was just five minutes in Google. HTH.

# asp.net-mvc - ASP.MVC Beta 安装问题

> ID：228997
> 
> 赞同：1
> 
> 时间：2008-10-23T08:49:49.750
> 
> 标签：asp.net-mvc

我刚刚下载了 ASP.MVC MSI 包，但安装失败并显示“**此 Windows 安装程序包存在问题。作为安装的一部分运行的程序未按预期完成。请联系您的支持人员或包供应商.** ”消息。

我看到其他人也有同样的问题（[http://forums.asp.net/p/1336453/2699267.aspx](http://forums.asp.net/p/1336453/2699267.aspx)）。其他人？

我在 Vista 上运行带有 SP1 的 VS 2008 专业版。

一些附加信息：**模板中的错误 (C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ProjectTemplates\VisualBasic\Workflow\1033\StateMachineWorkflowLibrary.zip)、文件 (StateMachineWorkflowLibrary.vstemplate) 等条目。未注册的 ProjectType (VisualBasic)。这可能是由不正确的 ProjectType 或未安装项目类型包引起的。**出现在事件日志中。

顺便说一句，我没有安装 VisualBasic。我正在考虑重新安装 VisualStudio ... :|

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T10:40:01.413

我删除了所有错误的模板，但这并没有解决我的问题。我发现删除已安装的其他加载项可以让我安装 Beta 1。在我的情况下，阻止安装的错误加载项是[Clone Detective](http://www.codeplex.com/CloneDetectiveVS)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T09:07:55.967

我从一个完全不同的 MSI 包（DevExpress 工具包）收到了这个确切的错误消息，结果证明是由我的机器上安装的一个“防御性”包引起的。

检查您的防病毒、防间谍软件、防入侵、防火墙、防 xxx 等软件包，看看它们是否可能会阻止脚本正常运行。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T10:23:11.323

安装程序正在尝试将模板添加到 VB 包，而不先检查它是否存在（ScottGuuuuuuu！）。

如果 MVC 的其余部分已安装并正常工作，请忘记它。如果没有，您不必重新安装 VS。一个快速的解决方法是简单地安装 Visual Basic（例如，修改您的安装而不是重新安装它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T11:13:40.177

Okey, like Simon said, [Clone Detective](http://www.codeplex.com/CloneDetectiveVS) addin was the troublemaker which prevented the installation of ASP MVC. I deinstalled Clone Detective and now MVC has installed without problems. Thanks guys!**********