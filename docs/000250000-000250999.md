# StackOverflow 问答 000250000-000250999

# user-interface - 警报/确认/错误对话框的替代方法？

> ID：250000
> 
> 赞同：5
> 
> 时间：2008-10-30T12:29:41.027
> 
> 标签：user-interface, user-experience

我们都知道警报是不好的。如果你不知道它读[这个](http://www.codinghorror.com/blog/archives/000114.html)

警报用于与用户交流。那么，如果我们不使用它们，有什么好的选择呢？

在实现需要用户通信的东西时，我想得到一个很好的替代方案列表。

我自己举一个例子供大家使用：

**案例：**我们需要先验证用户输入，然后才能继续。

**解决方案：**当用户单击“确定”/“下一步”/“提交”时不显示警告框，而是在用户输入周围/旁边显示一个样式清晰的（例如白色背景上的红色）“框架”，该输入具有无效输入，并带有关于什么的信息文本是错的。为了让用户更容易，有问题的输入应该获得焦点，并在必要时移回视图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T14:22:53.790

这是处理用户错误或警告的层次结构，适用于验证用户对字段的输入。

1.  删除可能导致错误的元素。你真的需要用户的出生日期吗？您是否也可以使用其他不需要验证的东西，例如“18 岁以下”和“18 岁或以上”的选项按钮？

2.  防止错误。一开始就不可能输入无效的输入。例如，使用下拉列表或“图片”字段，拒绝任何不可接受的字符（例如，电话号码的字母）。

3.  接受输入并可能自动更正它并将结果回显给用户。从输入中做出*一些东西*。如果用户键入 4--14#008 作为日期，则自动将其更正为 2008 年 4 月 14 日。如果格式与版本号不匹配，请检查它是否是版本号并查找相应的版本号。如果它不符合您对有效地址的想法，那么，只需假设它是（可能是针对外国的）。用户的出生日期是否错误真的很重要吗？

4.  提供撤消，而不是验证，清楚地显示用户所做的事情的含义，并提供一个明确的路径来扭转它。当用户输入要交易的股票数量时，在其旁边显示美元价值，以防用户将股票与美元混淆。保持字段可编辑，以便用户可以修复它。

5.  在主窗口或网页本身提供警告和错误文本；文本应该是明显的，不会迷失方向，是非模态的，并且在纠正错误后会自动消失。输入无法识别的日期时，用红色下划线并在其旁边放置文字“无法识别的日期”，可能包括帮助链接以获取更多信息。

6.  模态消息框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T12:32:42.020

许多警告框，以及所有让我烦恼的框，基本上都是在掩盖底层程序的缺点。

它通常归结为 iso 提供适当的撤消支持，“你确定吗？” 警报框被扔进去。

简而言之，让一切尽可能宽容（可撤销），您想添加的大多数警报框将不再需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T12:40:22.160

我认为最重要的是用简单（外行可读）的语言提供有用的信息。“你想技术技术吗”没有帮助。

此外，使您的消息与应用程序其余部分的样式相匹配，并且看起来与阻碍用户工作效率的所有其他框不同。这违背了让您的应用程序看起来对用户来说很熟悉的通常规则，但是如果您希望他们阅读消息，它必须看起来不同。

如果您可以避免使用模式对话框，请这样做。这将使您需要使用的时间显得更加重要。

在适当的时候，始终将注意力集中在需要注意的项目上。例如，如果您正在进行某种字段验证，请将焦点放在有问题的字段上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T07:44:51.987

这个怎么样： Aza Raskin 的 [独白框和透明消息](http://humanized.com/weblog/2006/09/11/monolog_boxes_and_transparent_messages/)。

本文讨论“独白”框的消息以及它们的替代方案。

这很有趣。

这就是实现的样子。阅读文章了解更多信息。

![替代文字](https://i.imgur.com/PKuZz1J.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T12:33:51.393

我非常喜欢 ASP.NET 的验证器控件最终结果（尽管它们实际上是个婊子）。以与您描述的方式类似的方式工作，在输入旁边放置一个星号，并在页面上显示可选消息或消息摘要，而不是当面提醒方式。

如果可能的话，我会一直将您的消息保留在页面/表单中。时间尺度可能另有规定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T12:40:04.237

状态栏消息和颜色/文本/项目闪烁更改以指示类似于@Rob 的 ASP.NET 示例的问题。多级撤消/重做系统是最好的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T13:31:55.067

我不是警报框的忠实拥护者，主要是因为它们确实会损害应用程序的可用性。正如 Alan Cooper 在*About Face*中所说的那样，这无异于在头部欺骗用户并称他/她为白痴。

另一方面，不良数据的通知是应用程序中的一项关键需求。首先，在我看来，您应该尽可能避免输入不良数据。大多数平台（ASP.NET、.NET WinForms、WPF、Java Swing、JSP 等）都有各种第三方控件工具包，它们将对此有所帮助。（虽然它在这些部分并不流行，但我实际上已经偏爱 Infragistics NetAdvantage。）

根据您的平台选择，您有许多 UI 通知可能性。已经提到了一些：使用应用程序的状态栏，指示字段本身的问题等。

我是一个 .NET 人，所以很明显我在这里的输入会受到环境的影响。

在网络上，我是验证控件的忠实粉丝。他们提供了很多通知，没有太侵入性的 UI。结合 的简单`Text`属性`*`、详细`ErrorMessage`属性和良好放置且视觉上明显`ValidationSummary`的 ，我得到了所有验证，几乎没有用户的噩梦。对于那些不在 .NET 上的控件，这些控件对输入的数据执行各种验证，并`Text`在页面上的任何位置（通常在被验证的控件旁边）显示它们的属性。该`ErrorMessage`属性位于其中`ValidationSummary`，通常位于页面顶部。

在 WinForms 环境中，我开始使用收件箱`ErrorProvider`控件和 Infragistics 的 Outlook 样式弹出框的组合。在我最近的 WinForms 应用程序中，我使用了两种不同的弹出窗口：一种是半透明的，出现在右下角。它有一个绿色的复选标记图标，用于通知用户成功消息。（我的用户不信任计算机；如果他们没有看到确认信息，他们会认为机器吃掉了他们的数据。长话短说。）这些框会在 7 秒内消失，或者用户可能会手动关闭它们。

第二种弹窗没有半透明，一个红色的X图标，出现在右上角。那是我显示验证错误的地方。此外，`ErrorProvider`控件会在验证失败的每个字段旁边显示一个图标，将鼠标悬停在给定控件上会显示其特定的错误消息。（这些特定消息也在弹出窗口中。）错误弹出窗口在 15 秒后消失。

我在该应用程序中使用的唯一模态警报框是当它崩溃时（真正未处理的异常；目前几乎不可能这样做）以及用户想要关闭脏窗口时。

这些是我用来避免警告框的一些技术。用户可以忽略确认消息（使他们的生活更轻松），并且不会因验证错误而受到模式的困扰——在这些错误被修复之前，他们无法保存他们的数据，但他们并没有被吓倒。当然，只要有可能，我会通过使用适当屏蔽的控件来防止验证错误，这些控件不允许无效输入。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T20:03:15.457

Joel Spolsky[提倡](http://www.joelonsoftware.com/items/2008/07/01.html)添加更多弹出框来告诉用户为什么他们不能执行某项操作，而不是首先禁用该操作（菜单、按钮、链接）。所以我想禁用用户不应该做的操作是摆脱大量弹出窗口的好方法。

# class - 'POCO' 定义

> ID：250001
> 
> 赞同：263
> 
> 时间：2008-10-30T12:30:12.680
> 
> 标签：class, poco

有人可以定义“POCO”的确切含义吗？我越来越频繁地遇到这个词，我想知道它是否只是关于普通类还是意味着更多？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2008-10-30T12:31:20.040

“普通的旧 C# 对象”

只是一个普通类，没有描述基础设施问题的属性或您的域对象不应该拥有的其他职责。

编辑 - 正如其他答案所述，它在技术上是“普通旧 CLR 对象”，但我像 David Arno 评论一样，更喜欢“普通旧类对象”以避免与特定语言或技术的联系。

澄清：换句话说，它们不是从一些特殊的基类派生的，也没有为它们的属性返回任何特殊类型。

请参阅下面的每个示例。

POCO 示例：

```
public class Person
{
    public string Name { get; set; }

    public int Age { get; set; }
} 
```

不是 POCO 的示例：

```
public class PersonComponent : System.ComponentModel.Component
{
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public string Name { get; set; }

    public int Age { get; set; }
} 
```

上面的例子既继承自一个特殊的类来赋予它额外的行为，也使用一个自定义属性来改变行为......两个类都存在相同的属性，但一个*不再*只是一个普通的旧对象。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-30T13:15:33.913

大多数人都说过——Plain Old CLR Object（相对于早期的 POJO——Plain Old Java Object）

POJO 来自 EJB，它要求您从特定的父类继承诸如值对象之类的东西（您从 ORM 或类似的查询中返回的内容），所以如果您想从 EJB 迁移（例如春天），你被塞满了。

POJO 只是不强制继承或任何属性标记以使它们在您使用的任何框架中“工作”的类。

POCO 是相同的，除了在 .NET 中。

通常，它将围绕 ORM 使用 - 较旧的（和一些当前的）要求您从特定的基类继承，这将您与该产品联系起来。较新的没有（nhibernate 是我知道的变体） - 你只需创建一个类，在 ORM 中注册它，你就可以离开了。容易得多。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2016-07-07T19:42:16.597

我可能错了..但无论如何，我认为 POCO 是普通的旧~~类~~CLR 对象，它来自 POJO 普通的旧 Java 对象。POCO 是一个保存数据且没有行为的类。

这是一个用 C# 编写的示例：

```
class Fruit 
{
    public Fruit() { }

    public Fruit(string name, double weight, int quantity) 
    {
        Name = name;
        Weight = weight;
        Quantity = quantity;
    }

    public string Name { get; set; }
    public double Weight { get; set; }
    public int Quantity { get; set; }

    public override string ToString() 
    {
        return $"{Name.ToUpper()} ({Weight}oz): {Quantity}";
    }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-30T12:32:52.020

POCO 代表“普通旧 CLR 对象”。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-02-13T16:20:49.377

在 .NET 中，POCO 是一个“普通的旧 CLR 对象”。它不是“普通的旧 C# 对象”...

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-30T12:38:36.080

添加其他答案，POxx 术语似乎都源于 POTS（[普通旧电话服务](http://en.wikipedia.org/wiki/Plain_old_telephone_service)）。

POX 用于定义简单（普通的旧）XML，而不是与 REST、SOAP 等相关的复杂的多层内容，是一个有用且隐约有趣的术语。PO（插入选择的语言）O 术语已经使这个笑话变得很淡了。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-30T12:32:40.490

在 Java 领域，“PO”通常意味着“普通旧”。其余的可能很棘手，所以我猜你的例子（在 Java 的上下文中）是“普通的旧类对象”。

其他一些例子

*   POJO（普通的旧 java 对象）
*   POJI（普通的旧java接口）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-16T06:41:58.683

有趣的。我所知道的唯一与编程有关并包含 POCO 的是[POCO C++ 框架](http://pocoproject.org/)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-01T08:22:39.990

在 WPF MVVM 术语中，POCO 类是不触发 PropertyChanged 事件的类

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-07-18T14:36:11.973

虽然我确信 POCO 对这里 99.9% 的人来说意味着普通旧类对象或普通旧 C 对象，但 POCO 也是 Animator Pro (Autodesk) 内置的脚本语言。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-25T04:04:35.523

POCO 是一个普通的旧 CLR 对象，它代表应用程序在其问题域方面的状态和行为。它是一个纯类，没有继承，没有任何属性。例子：

```
public class Customer
{
    public int Id { get; set; }

    public string Name { get; set; }
} 
```

# c++ - C ++：结构的ctors？

> ID：250033
> 
> 赞同：4
> 
> 时间：2008-10-30T12:39:56.560
> 
> 标签：c++, performance, class, constructor, struct

C ++：由于结构是具有“公共”所有内容的类，因此是否创建并调用了默认-ctors？

我问的原因是要了解使用结构时 C++ 可能比 C 产生的开销（如果有的话）。我听到的一个观点是，在 C++ 中，类有一些结构没有的开销，但我对此表示怀疑。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-30T12:42:18.070

在 C++ 中，除了结构成员的默认可见性是公共的，而类成员默认为私有之外，没有什么区别。

在性能方面，结构构造将与类构造一样快。实际速度当然取决于您的结构包含的内容。如果您将 C 结构移动到 C++，则您的结构将仅包含 POD 类型（普通旧数据 - 无类），它们无论如何都没有构造函数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-30T14:48:03.417

在与类完全相同的情况下，结构确实具有默认构造函数。

顺便说一句，结构不是“所有东西都公开的类”。这是一个以 public 作为默认访问说明符的类。结构可以有私有成员，但如果他们这样做，你的代码审查员可能会打你。

相关问题不是结构与类，而是 POD 与非 POD。

还记得一个类的“int”成员是如何未初始化的，除非你在初始化列表中给它一个值或在构造函数中设置一个值？嗯，这同样适用于所有 POD 类型。POD 结构（或 POD 类，就此而言）的默认构造函数无关。因此，虽然它名义上存在，但编译器实际上不应该生成和调用它。

这意味着您可以在 C 中定义的任何类型的默认构造函数在 C++ 中使用时不应引入运行时开销。在实践中，我听说并非所有 C++ 编译器都应用了足够的优化来确保所有代码始终发出与编译为 C 时一样好的二进制文件。但我不知道这是否是导致的问题之一问题 - 我猜它通常是相同的。

因此，给定一个 POD 结构：

```
struct sPOD {
    int foo;
    float bar;
    char baz[23];
}; 
```

以下可能不会在 C++ 中发出任何代码（除了可能移动堆栈指针，这取决于编译器将自动变量滚动到一起的程度），就像在 C 中一样：

```
sPOD s1; 
```

事实上，它不适合我在 gcc 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T12:48:36.293

好问题！我对 Stroustrup 的解读倾向于同意 Roddy 的回答。但是，*我认为*是否调用 ctor 在一定程度上取决于结构的创建方式。例如，如果您通过**malloc**创建结构，我不相信构造函数被调用，而如果您**新建**它们，我想它会。

也就是说，我实际上并没有检查过上面的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T12:49:02.940

在 Stroustrup 的书*The C++ Programming Language, Special Edition*的第 234 页第 10.2.8 节中，他给出了一个带有构造函数的结构示例。他还在文中进一步说“即使对于这样的结构，构造函数和访问函数也非常有用......” 尽管我不相信他在严格的技术意义上使用“结构”一词。所以我猜一个结构确实有一个默认的构造函数。

# asp.net - GridView 排序：SortDirection 总是升序

> ID：250037
> 
> 赞同：70
> 
> 时间：2008-10-30T12:41:01.457
> 
> 标签：asp.net, sorting, gridview

我有一个gridview，当用户单击标题时，我需要对其元素进行排序。
它的数据源是一个 List 对象。

aspx 是这样定义的：

```
<asp:GridView ID="grdHeader" AllowSorting="true" AllowPaging="false" 
    AutoGenerateColumns="false" Width="780" runat="server"  OnSorting="grdHeader_OnSorting" EnableViewState="true">
    <Columns>
        <asp:BoundField DataField="Entitycode" HeaderText="Entity" SortExpression="Entitycode" />
        <asp:BoundField DataField="Statusname" HeaderText="Status" SortExpression="Statusname" />
        <asp:BoundField DataField="Username" HeaderText="User" SortExpression="Username" />
    </Columns>
</asp:GridView> 
```

后面的代码是这样定义的：
首先加载：

```
protected void btnSearch_Click(object sender, EventArgs e)
{
    List<V_ReportPeriodStatusEntity> items = GetPeriodStatusesForScreenSelection();
    this.grdHeader.DataSource = items;
    this.grdHeader.DataBind();
} 
```

当用户点击标题时：

```
protected void grdHeader_OnSorting(object sender, GridViewSortEventArgs e)
{
    List<V_ReportPeriodStatusEntity> items = GetPeriodStatusesForScreenSelection();
    items.Sort(new Helpers.GenericComparer<V_ReportPeriodStatusEntity>(e.SortExpression, e.SortDirection));
    grdHeader.DataSource = items;
    grdHeader.DataBind();
} 
```

我的问题是 e.SortDirection 总是设置为升序。
我有一个类似代码的网页，它运行良好，e.SortDirection 在升序和降序之间交替。

我做错什么了 ？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-08-19T07:37:57.380

Session 和 Viewstate 的问题在于，如果页面上有多个 gridview，您还必须跟踪存储 SortColumn 和 Direction 的 gridview 控件。

Session 和 Viewstate 的替代方法是将 2 个属性添加到 Gridview 并以这种方式跟踪 Column 和 Direction。

这是一个例子：

```
private void GridViewSortDirection(GridView g, GridViewSortEventArgs e, out SortDirection d, out string f)
{
    f = e.SortExpression;
    d = e.SortDirection;

    //Check if GridView control has required Attributes
    if (g.Attributes["CurrentSortField"] != null && g.Attributes["CurrentSortDir"] != null)
    {
        if (f == g.Attributes["CurrentSortField"])
        {
            d = SortDirection.Descending;
            if (g.Attributes["CurrentSortDir"] == "ASC")
            {
                d = SortDirection.Ascending;
            }
        }

        g.Attributes["CurrentSortField"] = f;
        g.Attributes["CurrentSortDir"] = (d == SortDirection.Ascending ? "DESC" : "ASC");
    }

} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-06T07:54:23.727

您可以使用会话变量来存储最新的排序表达式，并在下次对网格进行排序时将网格的排序表达式与存储上次排序表达式的会话变量进行比较。如果列相等，则检查先前排序的方向并按相反方向排序。

**例子：**

```
DataTable sourceTable = GridAttendence.DataSource as DataTable;
DataView view = new DataView(sourceTable);
string[] sortData = ViewState["sortExpression"].ToString().Trim().Split(' ');
if (e.SortExpression == sortData[0])
{
    if (sortData[1] == "ASC")
    {
        view.Sort = e.SortExpression + " " + "DESC";
        this.ViewState["sortExpression"] = e.SortExpression + " " + "DESC";
    }
    else
    {
        view.Sort = e.SortExpression + " " + "ASC";
        this.ViewState["sortExpression"] = e.SortExpression + " " + "ASC";
    }
}
else
{
    view.Sort = e.SortExpression + " " + "ASC";
    this.ViewState["sortExpression"] = e.SortExpression + " " + "ASC";
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-01T17:35:14.227

一个简单的解决方案：

```
protected SortDirection GetSortDirection(string column)
{
    SortDirection nextDir = SortDirection.Ascending; // Default next sort expression behaviour.
    if (ViewState["sort"] != null && ViewState["sort"].ToString() == column)
    {   // Exists... DESC.
        nextDir = SortDirection.Descending;
        ViewState["sort"] = null;
    }
    else
    {   // Doesn't exists, set ViewState.
        ViewState["sort"] = column;
    }
    return nextDir;
} 
```

很像 ViewState 上的默认 GridView 排序和轻量级。

**用法：**

```
protected void grdHeader_OnSorting(object sender, GridViewSortEventArgs e)
{
    List<V_ReportPeriodStatusEntity> items = GetPeriodStatusesForScreenSelection();

    items.Sort(new Helpers.GenericComparer<V_ReportPeriodStatusEntity>(e.SortExpression, GetSortDirection(e.SortExpression));
    grdHeader.DataSource = items;
    grdHeader.DataBind();
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-12-30T09:45:29.587

自动双向排序仅适用于 SQL 数据源。不幸的是，MSDN 中的所有文档都假定您正在使用它，因此 GridView 可能会有点令人沮丧。

我这样做的方式是自己跟踪订单。例如：

```
 protected void OnSortingResults(object sender, GridViewSortEventArgs e)
    {
        // If we're toggling sort on the same column, we simply toggle the direction. Otherwise, ASC it is.
        // e.SortDirection is useless and unreliable (only works with SQL data source).
        if (_sortBy == e.SortExpression)
            _sortDirection = _sortDirection == SortDirection.Descending ? SortDirection.Ascending : SortDirection.Descending;
        else
            _sortDirection = SortDirection.Ascending;

        _sortBy = e.SortExpression;

        BindResults();
    } 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-02-11T12:54:21.343

不仅 SQL 数据源没有这个问题，对象数据源也没有这个问题。但是，当在代码中动态设置 DataSource 时，就会出现问题。不幸的是，MSDN 有时信息真的很贫乏。简单提及此行为（这不是错误，而是设计问题）将节省大量时间。无论如何，我不太愿意为此使用 Session 变量。我通常将排序方向存储在 ViewState 中。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-26T14:40:31.340

我这样做的方式类似于[接受的答案](https://stackoverflow.com/questions/250037/gridview-sorting-sortdirection-always-ascending/415759#415759)提供的代码，有点不同，所以我想我也会把它放在那里。请注意，此排序是在[DataTable](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)绑定到[GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx) .DataSource 之前对其进行的。

**选项一：使用 ViewState**

```
void DataGrid_Sorting(object sender, GridViewSortEventArgs e)
{
    if (e.SortExpression == (string)ViewState["SortColumn"])
    {
        // We are resorting the same column, so flip the sort direction
        e.SortDirection = 
            ((SortDirection)ViewState["SortColumnDirection"] == SortDirection.Ascending) ? 
            SortDirection.Descending : SortDirection.Ascending;
    }
    // Apply the sort
    this._data.DefaultView.Sort = e.SortExpression +
        (string)((e.SortDirection == SortDirection.Ascending) ? " ASC" : " DESC");
    ViewState["SortColumn"] = e.SortExpression;
    ViewState["SortColumnDirection"] = e.SortDirection;
} 
```

**选项二：使用会话**

请注意，如果您在现场看到以下内容，或者您​​仍在支持针对旧版浏览器的公司系统，则提供以下内容用于遗留目的。

```
void DataGrid_Sorting(object sender, GridViewSortEventArgs e)
{
    if (e.SortExpression == (string)HttpContext.Current.Session["SortColumn"])
    {
        // We are resorting the same column, so flip the sort direction
        e.SortDirection = 
            ((SortDirection)HttpContext.Current.Session["SortColumnDirection"] == SortDirection.Ascending) ? 
            SortDirection.Descending : SortDirection.Ascending;
    }
    // Apply the sort
    this._data.DefaultView.Sort = e.SortExpression +
        (string)((e.SortDirection == SortDirection.Ascending) ? " ASC" : " DESC");
    HttpContext.Current.Session["SortColumn"] = e.SortExpression;
    HttpContext.Current.Session["SortColumnDirection"] = e.SortDirection;
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-09-04T03:53:55.333

我不知道为什么每个人都忘记使用隐藏字段！它们比 ViewState（我从 2005 年开始关闭）要“便宜”得多。如果您不想使用 Session 或 ViewState，那么这是我的解决方案：

将这两个隐藏字段放在您的 aspx 页面上，并为您的数据设置您想要的默认排序（例如，我使用 LastName）：

```
<asp:HiddenField ID="hfSortExpression" runat="server" Value="LastName" />
<asp:HiddenField ID="hfSortDirection" runat="server" Value="Ascending" /> 
```

然后把这个帮助代码放在你的基本页面中（你有一个基本页面不是吗？如果没有，把你的 .cs 代码放在后面）。

```
/// <summary>
/// Since native ASP.Net GridViews do not provide accurate SortDirections, 
/// we must save a hidden field with previous sort Direction and Expression.
/// Put these two hidden fields on page and call this method in grid sorting event
/// </summary>
/// <param name="hfSortExpression">The hidden field on page that has the PREVIOUS column that is sorted on</param>
/// <param name="hfSortDirection">The hidden field on page that has the PREVIOUS sort direction</param>
protected SortDirection GetSortDirection(GridViewSortEventArgs e, HiddenField hfSortExpression, HiddenField hfSortDirection)
{
    //assume Ascending always by default!!
    SortDirection sortDirection = SortDirection.Ascending;

    //see what previous column (if any) was sorted on
    string previousSortExpression = hfSortExpression.Value;
    //see what previous sort direction was used
    SortDirection previousSortDirection = !string.IsNullOrEmpty(hfSortDirection.Value) ? ((SortDirection)Enum.Parse(typeof(SortDirection), hfSortDirection.Value)) : SortDirection.Ascending;

    //check if we are now sorting on same column
    if (e.SortExpression == previousSortExpression)
    {
        //check if previous direction was ascending
        if (previousSortDirection == SortDirection.Ascending)
        {
            //since column name matches but direction doesn't, 
            sortDirection = SortDirection.Descending;
        }
    }

    // save them back so you know for next time
    hfSortExpression.Value = e.SortExpression;
    hfSortDirection.Value = sortDirection.ToString();

    return sortDirection;
} 
```

接下来，您需要在网格排序事件处理程序中处理排序。在调用获取数据的主要方法之前，从排序事件处理程序调用上述方法

```
protected void gridContacts_Sorting(object sender, GridViewSortEventArgs e)
{
    //get the sort direction (since GridView sortDirection is not implemented!)
    SortDirection sortDirection = GetSortDirection(e, hfSortExpression, hfSortDirection);

    //get data, sort and rebind (obviously, this is my own method... you must replace with your own)
    GetCases(_accountId, e.SortExpression, sortDirection);
} 
```

由于那里有很多示例使用 DataTables 或 DataViews 或其他非 LINQ 友好的集合，我想我会包含一个示例，即调用返回通用列表的中间层方法，并使用 LINQ 进行排序以完成示例并使其更“真实世界”：

```
private void GetCases(AccountID accountId, string sortExpression, SortDirection sortDirection)
{
    //get some data from a middle tier method (database etc._)(
    List<PendingCase> pendingCases = MyMiddleTier.GetCasesPending(accountId.Value);
    //show a count to the users on page (this is just nice to have)
    lblCountPendingCases.Text = pendingCases.Count.ToString();
    //do the actual sorting of your generic list of custom objects
    pendingCases = Sort(sortExpression, sortDirection, pendingCases);
    //bind your grid
    grid.DataSource = pendingCases;
    grid.DataBind();
} 
```

最后，这里是使用 LINQ 对自定义对象的通用列表进行的向下和脏排序。我敢肯定那里有一些更漂亮的东西可以解决问题，但这说明了这个概念：

私有静态列表排序（字符串排序表达式，排序方向排序方向，列表未决案例）{

```
 switch (sortExpression)
    {
        case "FirstName":
            pendingCases = sortDirection == SortDirection.Ascending ? pendingCases.OrderBy(c => c.FirstName).ToList() : pendingCases.OrderByDescending(c => c.FirstName).ToList();
            break;
        case "LastName":
            pendingCases = sortDirection == SortDirection.Ascending ? pendingCases.OrderBy(c => c.LastName).ToList() : pendingCases.OrderByDescending(c => c.LastName).ToList();
            break;
        case "Title":
            pendingCases = sortDirection == SortDirection.Ascending ? pendingCases.OrderBy(c => c.Title).ToList() : pendingCases.OrderByDescending(c => c.Title).ToList();
            break;
        case "AccountName":
            pendingCases = sortDirection == SortDirection.Ascending ? pendingCases.OrderBy(c => c.AccountName).ToList() : pendingCases.OrderByDescending(c => c.AccountName).ToList();
            break;
        case "CreatedByEmail":
            pendingCases = sortDirection == SortDirection.Ascending ? pendingCases.OrderBy(c => c.CreatedByEmail).ToList() : pendingCases.OrderByDescending(c => c.CreatedByEmail).ToList();
            break;
        default:
            break;
    }
    return pendingCases;
} 
```

最后但并非最不重要的一点（我已经说过了吗？）您可能希望在 Page_Load 处理程序中放置类似的内容，以便网格在页面加载时默认绑定...请注意，_accountId 是一个查询字符串参数，转换为自定义在这种情况下，我自己的 AccountID 类型...

```
 if (!Page.IsPostBack)
    {
        //sort by LastName ascending by default
        GetCases(_accountId,hfSortExpression.Value,SortDirection.Ascending);
    } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-06-25T13:24:07.393

所有这些答案都不完全正确。我用那个：

```
protected void SetPageSort(GridViewSortEventArgs e) 
        { 
            if (e.SortExpression == SortExpression) 
            { 
                if (SortDirection == "ASC") 
                { 
                    SortDirection = "DESC"; 
                } 
                else 
                { 
                    SortDirection = "ASC"; 
                } 
            } 
            else 
            {
                if (SortDirection == "ASC")
                {
                    SortDirection = "DESC";
                }
                else
                {
                    SortDirection = "ASC";
                } 
                SortExpression = e.SortExpression; 
            } 
        } 
  protected void gridView_Sorting(object sender, GridViewSortEventArgs e)
        {
            SetPageSort(e); 
```

在 gridView_Sorting...

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-25T09:44:50.123

另一个:) 不需要硬编码列名..

```
DataTable dt = GetData();

    SortDirection sd;
    string f;
    GridViewSortDirection(gvProductBreakdown, e, out sd, out f);
    dt.DefaultView.Sort = sd == SortDirection.Ascending ? f + " asc" : f + " desc";
    gvProductBreakdown.DataSource = dt;
    gvProductBreakdown.DataBind(); 
```

蚂蚁然后：

```
 private void GridViewSortDirection(GridView g, GridViewSortEventArgs e, out SortDirection d, out string f)
    {
        f = e.SortExpression;
        d = e.SortDirection;
 if (g.Attributes[f] != null)
        {
            d = g.Attributes[f] == "ASC" ? SortDirection.Descending : SortDirection.Ascending;

            g.Attributes[f] = d == SortDirection.Ascending ? "ASC" : "DESC";
        }
        else
        {
            g.Attributes[f] = "ASC";
            d = SortDirection.Ascending;
        } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-02-19T20:59:38.710

它可以在不使用 View State 或 Session 的情况下完成。当前顺序可以根据我们排序的列中第一行和最后一行的值来确定：

```
 protected void gvItems_Sorting(object sender, GridViewSortEventArgs e)
    {
        GridView grid = sender as GridView; // get reference to grid
        SortDirection currentSortDirection = SortDirection.Ascending; // default order

        // get column index by SortExpression
        int columnIndex = grid.Columns.IndexOf(grid.Columns.OfType<DataControlField>()
                                      .First(x => x.SortExpression == e.SortExpression));

        // sort only if grid has more than 1 row
        if (grid.Rows.Count > 1)
        {
            // get cells
            TableCell firstCell = grid.Rows[0].Cells[columnIndex];
            TableCell lastCell = grid.Rows[grid.Rows.Count - 1].Cells[columnIndex];

            // if field type of the cell is 'TemplateField' Text property is always empty.
            // Below assumes that value is binded to Label control in 'TemplateField'.
            string firstCellValue = firstCell.Controls.Count == 0 ? firstCell.Text : ((Label)firstCell.Controls[1]).Text;
            string lastCellValue = lastCell.Controls.Count == 0 ? lastCell.Text : ((Label)lastCell.Controls[1]).Text;

            DateTime tmpDate;
            decimal tmpDecimal;

            // try to determinate cell type to ensure correct ordering
            // by date or number
            if (DateTime.TryParse(firstCellValue, out tmpDate)) // sort as DateTime
            {
                currentSortDirection = 
                    DateTime.Compare(Convert.ToDateTime(firstCellValue), 
                                     Convert.ToDateTime(lastCellValue)) < 0 ? 
                                            SortDirection.Ascending : SortDirection.Descending;
            }
            else if (Decimal.TryParse(firstCellValue, out tmpDecimal)) // sort as any numeric type
            {
                currentSortDirection = Decimal.Compare(Convert.ToDecimal(firstCellValue), 
                                                       Convert.ToDecimal(lastCellValue)) < 0 ? 
                                                       SortDirection.Ascending : SortDirection.Descending;
            }
            else // sort as string
            {
                currentSortDirection = string.CompareOrdinal(firstCellValue, lastCellValue) < 0 ? 
                                                             SortDirection.Ascending : SortDirection.Descending;
            }
        }

        // then bind GridView using correct sorting direction (in this example I use Linq)
        if (currentSortDirection == SortDirection.Descending)
        {
            grid.DataSource = myItems.OrderBy(x => x.GetType().GetProperty(e.SortExpression).GetValue(x, null));
        }
        else
        {
            grid.DataSource = myItems.OrderByDescending(x => x.GetType().GetProperty(e.SortExpression).GetValue(x, null));
        }

        grid.DataBind();
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-03T07:21:00.703

```
 <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false" AllowSorting="True" 
            onsorting="GridView1_Sorting" EnableViewState="true">
            <Columns><asp:BoundField DataField="bookid" HeaderText="BOOK ID" SortExpression="bookid"  />
                <asp:BoundField DataField="bookname" HeaderText="BOOK NAME" />
                <asp:BoundField DataField="writer" HeaderText="WRITER" />
                <asp:BoundField DataField="totalbook" HeaderText="TOTAL BOOK" SortExpression="totalbook"  />
                <asp:BoundField DataField="availablebook" HeaderText="AVAILABLE BOOK" />
//gridview code on page load under ispostback false//after that.

protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            string query = "SELECT * FROM book";
            DataTable DT = new DataTable();
            SqlDataAdapter DA = new SqlDataAdapter(query, sqlCon);
            DA.Fill(DT);

            GridView1.DataSource = DT;
            GridView1.DataBind();
        }
    }

    protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
    {

        string query = "SELECT * FROM book";
        DataTable DT = new DataTable();
        SqlDataAdapter DA = new SqlDataAdapter(query, sqlCon);
        DA.Fill(DT);

        GridView1.DataSource = DT;
        GridView1.DataBind();

        if (DT != null)
        {

            DataView dataView = new DataView(DT);
            dataView.Sort = e.SortExpression + " " + ConvertSortDirectionToSql(e.SortDirection);

            GridView1.DataSource = dataView;
            GridView1.DataBind();
        }
    }

    private string GridViewSortDirection
    {
        get { return ViewState["SortDirection"] as string ?? "DESC"; }
        set { ViewState["SortDirection"] = value; }
    }

    private string ConvertSortDirectionToSql(SortDirection sortDirection)
    {
        switch (GridViewSortDirection)
        {
            case "ASC":
                GridViewSortDirection = "DESC";
                break;

            case "DESC":
                GridViewSortDirection = "ASC";
                break;
        }

        return GridViewSortDirection;
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-11-22T00:39:07.783

这可能会被埋在这里，但我想出的解决方案非常适合我的情况：

表单加载事件如下所示：

```
private DataTable DataTable1;
protected void Page_Load(object sender, EventArgs e)
{
  DataTable1 = GetDataFromDatabase();
  this.GridView1.DataSource = DataTable1.DefaultView;
  this.GridView1.DataBind();
} 
```

在页面上添加两个隐藏字段：

```
<asp:HiddenField runat="server" ID="lastSortDirection" />
<asp:HiddenField runat="server" ID="lastSortExpression" /> 
```

将以下内容添加到您的 asp:GridView 对象中：

```
AllowSorting="True" OnSorting="GridView1_Sorting" 
```

使用以下 GridView 排序事件

```
protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
{
    if (lastSortExpression.Value == e.SortExpression.ToString())
    {
        if (lastSortDirection.Value == SortDirection.Ascending.ToString())
        {
            e.SortDirection = SortDirection.Descending;
        }
        else
        {
            e.SortDirection = SortDirection.Ascending;
        }
        lastSortDirection.Value = e.SortDirection.ToString();
        lastSortExpression.Value = e.SortExpression;
    }
    else
    {
        lastSortExpression.Value = e.SortExpression;
        e.SortDirection = SortDirection.Ascending;
        lastSortDirection.Value = e.SortDirection.ToString();
    }

    DataView dv = DataTable1.DefaultView;
    if (e.SortDirection == SortDirection.Ascending)
    {
        dv.Sort = e.SortExpression;
    }
    else
    {
        dv.Sort = e.SortExpression + " DESC";
    }

    DataTable1 = dv.ToTable();
    GridView1.DataSource = DataTable1.DefaultView;
    GridView1.DataBind();
} 
```

现在，如果任何列发生更改，我的 gridview 中的每一列都已排序，无需任何进一步的更改。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-30T15:21:20.667

自从我使用 GridView 已经有一段时间了，但我认为您需要在离开 OnSorting 方法之前将网格的 SortDirection 属性设置为当前的任何值。

所以....

`List<V_ReportPeriodStatusEntity> items = GetPeriodStatusesForScreenSelection();`
`items.Sort(new Helpers.GenericComparer<V_ReportPeriodStatusEntity>(e.SortExpression, e.SortDirection));`
**`grdHeader.SortDirection = e.SortDirection.Equals(SortDirection.Ascending) ? SortDirection.Descending : SortDirection.Ascending;`**
`grdHeader.DataSource = items;`
`grdHeader.DataBind();`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-04T13:32:51.657

我厌倦了处理这个问题并将排序方向和排序列放在 ViewState 中......

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-19T02:49:33.893

为了切换升序和降序，我在应用程序的 BasePage 中使用了一个方法来缓存排序表达式和排序方向：

```
protected void SetPageSort(GridViewSortEventArgs e)
{
    if (e.SortExpression == SortExpression)
    {
        if (SortDirection == "ASC")
        {
            SortDirection = "DESC";
        }
        else
        {
            SortDirection = "ASC";
        }
    }
    else
    {
        SortDirection = "ASC";
        SortExpression = e.SortExpression;
    }
} 
```

SortExpression 和 SortDirection 都是 BasePage 中的属性，它们从 ViewState 中存储和检索它们的值。

所以我所有的派生页面都只是从GridView的Sorting方法中调用SetPageSort，并绑定GridView：

```
protected void gv_Sorting(object sender, GridViewSortEventArgs e)
{
    SetPageSort(e);
    BindGrid();
} 
```

BindGrid 检查 SortExpression 并使用它和 SortDirection 在网格的数据源上执行 ORDERY BY，如下所示：

```
if (SortExpression.Length > 0)
{
    qry.ORDER_BY(SortExpression + " " + SortDirection);
}

gv.DataSource = qry.ExecuteReader();
gv.DataBind(); 
```

因此，基类的 SetPageSort 消除了 GridView 排序的许多苦差事。我觉得我忘记了什么，但这是一般的想法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-03-11T09:15:52.443

XML:

```
<asp:BoundField DataField="DealCRMID" HeaderText="Opportunity ID"
 SortExpression="DealCRMID"/>
<asp:BoundField DataField="DealCustomerName" HeaderText="Customer" 
 SortExpression="DealCustomerName"/>
<asp:BoundField DataField="SLCode" HeaderText="Practice" 
 SortExpression="SLCode"/> 
```

代码：

```
private string ConvertSortDirectionToSql(String sortExpression,SortDirection sortDireciton)
{
    switch (sortExpression)
    {
        case "DealCRMID":
             ViewState["DealCRMID"]=ChangeSortDirection(ViewState["DealCRMID"].ToString());
             return ViewState["DealCRMID"].ToString();

        case "DealCustomerName":
             ViewState["DealCustomerName"] = ChangeSortDirection(ViewState["DealCustomerName"].ToString());
             return ViewState["DealCustomerName"].ToString();

        case "SLCode":
             ViewState["SLCode"] = ChangeSortDirection(ViewState["SLCode"].ToString());
             return ViewState["SLCode"].ToString();

        default:
            return "ASC";
    }       
}

private string ChangeSortDirection(string sortDireciton)
{
    switch (sortDireciton)
    {
        case "DESC":
            return "ASC";
        case "ASC":
            return "DESC";
        default:
            return "ASC";
    }
}

protected void gvPendingApprovals_Sorting(object sender, GridViewSortEventArgs e)
{
    DataSet ds = (System.Data.DataSet)(gvPendingApprovals.DataSource);

    if(ds.Tables.Count>0)
    {
        DataView m_DataView = new DataView(ds.Tables[0]);
        m_DataView.Sort = e.SortExpression + " " + ConvertSortDirectionToSql   (e.SortExpression.ToString(), e.SortDirection);

        gvPendingApprovals.DataSource = m_DataView;
        gvPendingApprovals.DataBind();
    }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-06-21T02:14:22.297

这是解决问题的另一种方法：

```
protected void grdHeader_OnSorting(object sender, GridViewSortEventArgs e)
{
    List<V_ReportPeriodStatusEntity> items = GetPeriodStatusesForScreenSelection();
    items.Sort = e.SortExpression + " " + ConvertSortDirectionToSql(e);
    grdHeader.DataSource = items;
    grdHeader.DataBind();
}

private string ConvertSortDirectionToSql(GridViewSortEventArgs e)
{
    ViewState[e.SortExpression] = ViewState[e.SortExpression] ?? "ASC";
    ViewState[e.SortExpression] = (ViewState[e.SortExpression].ToString() == "ASC") ? "DESC" : "ASC";
    return ViewState[e.SortExpression].ToString();
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-04-29T21:47:54.557

旧字符串，但也许我的回答会对某人有所帮助。

首先将您的 SqlDataSource 作为 DataView：

```
Private Sub DataGrid1_SortCommand(ByVal source As Object, ByVal e As DataGridSortCommandEventArgs) Handles grid1.SortCommand
    Dim dataView As DataView = CType(SqlDataSource1.Select(DataSourceSelectArguments.Empty), DataView)
    dataView.Sort = e.SortExpression + dataView.FieldSortDirection(Session, e.SortExpression)

    grid1.DataSourceID = Nothing
    grid1.DataSource = dataView
    grid1.DataBind()

End Sub 
```

然后使用扩展方法进行排序（有点小气，但一个好的开始）：

```
public static class DataViewExtensions
{
    public static string FieldSortDirection(this DataView dataView, HttpSessionState session, string sortExpression)
    {
        const string SORT_DIRECTION = "SortDirection";
        var identifier = SORT_DIRECTION + sortExpression;

        if (session[identifier] != null)
        {
            if ((string) session[identifier] == " ASC")
                session[identifier] = " DESC";
            else if ((string) session[identifier] == " DESC")
                session[identifier] = " ASC";
        }
        else
            session[identifier] = " ASC";

        return (string) session[identifier];
    }
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2014-10-09T18:23:51.120

上面使用 SecretSquirrel 的[解决方案](https://stackoverflow.com/a/590830/323650)

这是我的完整工作代码。只需将 dgvCoaches 更改为您的网格视图名称。

...在网格绑定期间

```
 dgvCoaches.DataSource = dsCoaches.Tables[0];
        ViewState["AllCoaches"] = dsCoaches.Tables[0];
        dgvCoaches.DataBind(); 
```

现在排序

```
protected void gridView_Sorting(object sender, GridViewSortEventArgs e)
{
    DataTable dt = ViewState["AllCoaches"] as DataTable;

    if (dt != null)
    {
        if (e.SortExpression == (string)ViewState["SortColumn"])
        {
            // We are resorting the same column, so flip the sort direction
            e.SortDirection =
                ((SortDirection)ViewState["SortColumnDirection"] == SortDirection.Ascending) ?
                SortDirection.Descending : SortDirection.Ascending;
        }
        // Apply the sort
        dt.DefaultView.Sort = e.SortExpression +
            (string)((e.SortDirection == SortDirection.Ascending) ? " ASC" : " DESC");
        ViewState["SortColumn"] = e.SortExpression;
        ViewState["SortColumnDirection"] = e.SortDirection; 

        dgvCoaches.DataSource = dt;
        dgvCoaches.DataBind();
    }
} 
```

这是aspx代码：

```
<asp:GridView ID="dgvCoaches" runat="server" 
    CssClass="table table-hover table-striped" GridLines="None"  DataKeyNames="HealthCoachID" OnRowCommand="dgvCoaches_RowCommand"
    AutoGenerateColumns="False" OnSorting="gridView_Sorting" AllowSorting="true">
    <Columns>
        <asp:BoundField DataField="HealthCoachID" Visible="false" />
        <asp:BoundField DataField="LastName" HeaderText="Last Name" SortExpression="LastName" />
        <asp:BoundField DataField="FirstName" HeaderText="First Name" SortExpression="FirstName" />
        <asp:BoundField DataField="LoginName" HeaderText="Login Name" SortExpression="LoginName" />
        <asp:BoundField DataField="Email" HeaderText="Email" SortExpression="Email" HtmlEncode="false" DataFormatString="<a href=mailto:{0}>{0}</a>" />
        <asp:TemplateField>
            <ItemTemplate>
                    <asp:LinkButton runat="server" BorderStyle="None" CssClass="btn btn-default" Text="<i class='glyphicon glyphicon-edit'></i>" CommandName="Update" CommandArgument="<%# ((GridViewRow) Container).RowIndex %>" />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:LinkButton runat="server" OnClientClick="return ConfirmOnDelete();" BorderStyle="None" CssClass="btn btn-default" Text="<i class='glyphicon glyphicon-remove'></i>" CommandName="Delete" CommandArgument="<%# ((GridViewRow) Container).RowIndex %>" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
    <RowStyle CssClass="cursor-pointer" />
</asp:GridView> 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-02-22T13:49:17.037

这是我的做法。比 IMO 的很多答案要容易得多：

创建这个 SortDirection 类

```
 // ==================================================
    // SortByDirection
    // ==================================================
    public SortDirection SortByDirection
    {
        get
        {
            if (ViewState["SortByDirection"] == null)
            {
                ViewState["SortByDirection"] = SortDirection.Ascending;
            }

            return (SortDirection)Enum.Parse(typeof(SortDirection), ViewState["SortByDirection"].ToString());
        }
        set { ViewState["SortByDirection"] = value; }
    } 
```

然后在你的排序函数中使用它，如下所示：

```
 // Created Date
            if (sortBy == "CreatedDate")
            {
                if (SortByDirection == SortDirection.Ascending)
                {
                    data = data.OrderBy(x => x.CreatedDate).ToList();
                    SortByDirection = SortDirection.Descending;
                }
                else {
                    data = data.OrderByDescending(x => x.CreatedDate).ToList();
                    SortByDirection = SortDirection.Ascending;
                } 
            } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-11-06T00:20:12.510

我遇到了一个可怕的问题，所以我最终使用 LINQ 在将 DataTable 分配给视图之前对其进行排序：

```
Dim lquery = From s In listToMap
             Select s
             Order By s.ACCT_Active Descending, s.ACCT_Name 
```

特别是在对布尔字段进行排序时，我确实发现 DataView.Sort 和 DataGrid.Sort 方法不可靠。

我希望这可以帮助那里的人。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-12-14T19:17:46.050

```
void dg_SortCommand(object source, DataGridSortCommandEventArgs e)
{
    DataGrid dg = (DataGrid) source;
    string sortField = dg.Attributes["sortField"];
    List < SubreportSummary > data = (List < SubreportSummary > ) dg.DataSource;
    string field = e.SortExpression.Split(' ')[0];
    string sort = "ASC";
    if (sortField != null)
    {
        sort = sortField.Split(' ')[0] == field ? (sortField.Split(' ')[1] == "DESC" ? "ASC" : "DESC") : "ASC";
    }
    dg.Attributes["sortField"] = field + " " + sort;
    data.Sort(new GenericComparer < SubreportSummary > (field, sort, null));
    dg.DataSource = data;
    dg.DataBind();
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-08-14T15:44:15.030

也许这会对某人有所帮助。不确定是因为它是 2014 年，还是我不明白这篇文章试图解决的问题，但这对于 slickgrid 来说非常简单，如下所示：

问题似乎是如何“记住”当前的排序设置是什么，因此建议围绕 Asp.Net 为您保留该值。但是 slickGrid 可以告诉您当前的排序顺序是什么：

要切换 asc desc 排序，您可以使用 grid.getSortColumns() 来找出当前的列排序。这就是我所做的，但我一次只对 1 列进行排序，因此我可以安全地这样做：'if(grid.getSortColumns()[0].sortAsc)'

...所以我的代码是这样的：

```
 // Make sure you have sortable: true on the relevant column names or 
    // nothing happens as I found!!
    var columns = [
    { name: "FileName", id: "FileName", field: "FileName", width: 95, selectable: true, sortable: true },
    { name: "Type", id: "DocumentType", field: "DocumentType", minWidth: 105, width: 120, maxWidth: 120, selectable: true, sortable: true },
    { name: "ScanDate", id: "ScanDate", field: "ScanDate", width: 90, selectable: true, sortable: true }, ]; 
```

..像往常一样加载你的数据然后排序部分：

```
 // Clicking on a column header fires this event. Here we toggle the sort direction
    grid.onHeaderClick.subscribe(function(e, args) {
        var columnID = args.column.id;

        if (grid.getSortColumns()[0].sortAsc) {
            grid.setSortColumn(args.column.id, true);
        }
        else {
            grid.setSortColumn(args.column.id, false);
        }
    });

    // The actual sort function is like this 
        grid.onSort.subscribe(function (e, args) {
            sortdir = args.sortAsc ? 1 : -1;
            sortcol = args.sortCol.field;

            //alert('in sort');

            // using native sort with comparer
            // preferred method but can be very slow in IE with huge datasets
            dataView.sort(comparer, args.sortAsc);
            grid.invalidateAllRows();
            grid.render();
        });

// Default comparer is enough for what I'm doing here ..
function comparer(a, b) {
    var x = a[sortcol], y = b[sortcol];
    return (x == y ? 0 : (x > y ? 1 : -1));
} 
```

最后确保您的站点中包含 SlickGrid 图像文件夹，当您选择它时，您会在列上看到 asc/desc 箭头。如果缺少它们，文本将变为斜体，但不会出现箭头。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-03-10T13:31:19.870

写了这个，它对我有用：

```
 protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
    {
        if (ViewState["sortExpression"] == null || ViewState["sortExpression"].ToString() != e.SortExpression.ToString())
            MyDataTable.DefaultView.Sort = e.SortExpression + " ASC";
        else
        {
            if (ViewState["SortDirection"].ToString() == "Ascending")
                MyDataTable.DefaultView.Sort = e.SortExpression = e.SortExpression + " DESC";
            else
                MyDataTable.DefaultView.Sort = e.SortExpression + " ASC";
        }

        GridView1.DataSource = MyDataTable;
        GridView1.DataBind();

        ViewState["sortExpression"] = e.SortExpression;
        ViewState["SortDirection"] = e.SortDirection;
    } 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-09-23T19:43:27.670

```
protected void gv_Sorting(object sender, GridViewSortEventArgs e)
{
    DataTable dataTable = (DataTable)Cache["GridData"];

    if (dataTable != null)
    {
        DataView dataView = new DataView(dataTable);
        string Field1 = e.SortExpression;
        string whichWay = "ASC";
        if (HttpContext.Current.Session[Field1] != null)
        {
            whichWay = HttpContext.Current.Session[Field1].ToString();
            if (whichWay == "ASC")
                whichWay = "DESC";
            else
                whichWay = "ASC";               
        }

        HttpContext.Current.Session[Field1] = whichWay;
        dataView.Sort = Field1 + " " + whichWay;      
        gv.DataSource = dataView;
        gv.DataBind();
    }
} 
```

并且您存储之前检索到的信息

```
 string SqlConn = ConfigurationManager.ConnectionStrings["Sql28"].ConnectionString;
    SqlConnection sqlcon = new SqlConnection(SqlConn);
    sqlcon.Open();

    SqlCommand cmd = new SqlCommand();
    cmd.Connection = sqlcon;
    cmd.CommandType = System.Data.CommandType.Text;
    cmd.CommandText = HttpContext.Current.Session["sql"].ToString();

    SqlDataAdapter adapter = new SqlDataAdapter(cmd);
    DataTable employees = new DataTable();
    adapter.Fill(employees);

    gv.DataSource = employees;
    gv.DataBind();

    Cache.Insert("GridData", employees, null, System.Web.Caching.Cache.NoAbsoluteExpiration,new TimeSpan(0, 360000, 0)); 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2017-01-19T18:26:22.013

在 vb.net 但是很简单！

```
Protected Sub grTicketHistory_Sorting(sender As Object, e As GridViewSortEventArgs) Handles grTicketHistory.Sorting

    Dim dt As DataTable = Session("historytable")
    If Session("SortDirection" & e.SortExpression) = "ASC" Then
        Session("SortDirection" & e.SortExpression) = "DESC"
    Else
        Session("SortDirection" & e.SortExpression) = "ASC"
    End If
    dt.DefaultView.Sort = e.SortExpression & " " & Session("SortDirection" & e.SortExpression)
    grTicketHistory.DataSource = dt
    grTicketHistory.DataBind()

End Sub 
```

# python - 如何将安装后脚本添加到 easy_install / setuptools / distutils？

> ID：250038
> 
> 赞同：33
> 
> 时间：2008-10-30T12:42:10.800
> 
> 标签：python, setuptools, distutils

我希望能够在我的 setup.py 中添加一个钩子，它将在安装后运行（在 easy_install'ing 或 python setup.py 安装时）。

在我的项目[PySmell](http://code.google.com/p/pysmell)中，我有一些 Vim 和 Emacs 的支持文件。当用户以通常的方式安装 PySmell 时，这些文件会被复制到实际的 egg 中，用户必须将它们取出并将它们放在他的 .vim 或 .emacs 目录中。我想要的是在安装后询问用户，他希望将这些文件复制到哪里，或者甚至只是一条消息，打印文件的位置以及他应该如何处理它们。

做这个的最好方式是什么？

谢谢

我的 setup.py 看起来像这样：

```
#!/usr/bin/env python
# -*- coding: UTF-8 -*-
from setuptools import setup

version = __import__('pysmell.pysmell').pysmell.__version__

setup(
    name='pysmell',
    version = version,
    description = 'An autocompletion library for Python',
    author = 'Orestis Markou',
    author_email = 'orestis@orestis.gr',
    packages = ['pysmell'],
    entry_points = {
        'console_scripts': [ 'pysmell = pysmell.pysmell:main' ]
    },
    data_files = [
        ('vim', ['pysmell.vim']),
        ('emacs', ['pysmell.el']),
    ],
    include_package_data = True,
    keywords = 'vim autocomplete',
    url = 'http://code.google.com/p/pysmell',
    long_description =
"""\
PySmell is a python IDE completion helper. 

It tries to statically analyze Python source code, without executing it,
and generates information about a project's structure that IDE tools can
use.

The first target is Vim, because that's what I'm using and because its
completion mechanism is very straightforward, but it's not limited to it.
""",
    classifiers = [
        'Development Status :: 5 - Production/Stable',
        'Environment :: Console',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: BSD License',
        'Operating System :: OS Independent',
        'Programming Language :: Python',
        'Topic :: Software Development',
        'Topic :: Utilities',
        'Topic :: Text Editors',
    ]

) 
```

编辑：

这是一个演示的存根`python setup.py install`：

```
from setuptools.command.install import install as _install

class install(_install):
    def run(self):
        _install.run(self)
        print post_install_message

setup(
    cmdclass={'install': install},
    ... 
```

easy_install 路线还没有运气。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T10:33:46.097

这取决于用户如何安装您的软件包。如果用户实际运行“setup.py install”，这相当容易：只需在安装命令中添加另一个子命令（例如 install_vim），它的 run() 方法会将您想要的文件复制到您想要的位置。您可以将子命令添加到 install.sub_commands，然后将命令传递给 setup()。

如果您想要二进制文件中的安装后脚本，这取决于您正在创建的二进制文件的类型。例如，bdist_rpm、bdist_wininst 和 bdist_msi 支持安装后脚本，因为底层打包格式支持安装后脚本。

bdist_egg 在设计上不支持安装后机制：

[http://bugs.python.org/setuptools/issue41](http://bugs.python.org/setuptools/issue41)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-28T15:56:28.713

作为一种变通方法，您可以将 zip_ok 选项设置为 false，以便将您的项目安装为解压缩目录，然后您的用户将更容易找到编辑器配置文件。

在 distutils2 中，可以将东西安装到更多目录，包括自定义目录，并具有 pre/post-install/remove 挂钩。

# design-patterns - 设计模式或代码异味，由于功能分解而导致的非规范化数据

> ID：250044
> 
> 赞同：2
> 
> 时间：2008-10-30T12:44:30.263
> 
> 标签：design-patterns, scalability

[我是http://highscalability.com/](http://highscalability.com/)的忠实粉丝并且一直在寻找我当前的开发以沿着功能边界分解我的应用程序，作为能够横向扩展服务器端，特别是数据库层的途径。这涉及到将应用程序的不同功能组件（我们有几个客户可以使用的单独模块）实现为服务器上自己的独立应用程序，与服务器联系的客户端知道它需要联系不同的服务以获取不同的数据，因此统一的视图呈现给用户。当不同组件中的数据之间存在链接时，问题就出现了，即一个组件保存所有用户数据，但另一个组件需要引用用户作为某些数据的所有者。我' m 目前通过保存链接每一侧的主键信息来执行此操作（就像它们都存在于单个数据库中一样），但是此链接表需要存在于两个组件中以允许在任一方向上进行查找，即“获取特定用户拥有的东西”和“获取该特定事物的所有者”将各自使用不同的组件。对此的替代方法是将链接数据仅存储在一个组件中，但是反向查找将需要 2 次调用，而不仅仅是 1 次。

我的问题是，这些链接表的重复是我应该避免的某种代码异味，还是当您按照这样的功能线拆分应用程序时，事情就是这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T13:14:19.690

功能分解是一种糟糕的设计策略。

考虑尝试使用功能分解构建厨房搅拌机。要搅打、混合、搅拌和混合，您需要四个碗、四个电机、四个刀片、四个开关、四个电源和四个底座来保持每个“功能”。

功能分解用于需求分析。它不是为了设计。

在您的分析通过后，您必须进行综合通过以组装通用组件、通用框架元素和通用数据模型。您应该最终得到一个支持多种功能的数据模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T12:53:48.960

我认为这取决于 - SOA 基本上不意味着功能分解吗？

问题是当不同的功能需要访问相同的数据时，这可能是一种错误的气味。也许需要另一个函数来处理对公共数据的访问，或者函数分解在这种情况下是错误的答案。

如果您试图将厨房扩大到食品制造厂，那么使用单独的大桶进行搅打、搅拌和混合可能是有意义的，并带有大桶“订阅”的某种管道（或“总线”），但是对于国内搅拌机来说，重复使用同一个碗并具有可切换的附件会更有意义。

# java - UI图布局

> ID：250045
> 
> 赞同：2
> 
> 时间：2008-10-30T12:44:49.140
> 
> 标签：java, diagramming

想要生成一个描述网络组件之间关系的 UI 图（具有漂亮的布局）。哪个是最好的基于 Java 的 API，可以以最少的麻烦和轻量级的代码库进行此类布局。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T18:52:09.413

工作。 [http://www.yworks.com/en/index.html](http://www.yworks.com/en/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T18:20:29.353

如果您正在记录可以进行布局的 Java API（例如以分层方式排列框而不重叠），请查看[JGraph](http://www.jgraph.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T13:37:24.120

任何 uml 工具都应该完成这项工作

看看[UMLet](http://www.umlet.com/)或[NetBeans](http://www.netbeans.org/)作为用 Java 制作的 UML 编辑器。

（顺便说一句，Visio 通常是该工作的标准工具）

# asp.net - ASP.NET：更改数据关闭窗口时发出警告

> ID：250055
> 
> 赞同：3
> 
> 时间：2008-10-30T12:49:27.587
> 
> 标签：asp.net, javascript, asp.net-ajax

如果用户**没有保存**他们在网络表单中所做的更改，我想在他们**尝试关闭浏览器窗口时警告他们。**

 **我正在使用 ASP.NET 3.5（带有 ASP.NET Ajax）。

有没有我可以轻松实施的通用解决方案？

*编辑：也许我的问题不清楚：*我专门寻找一种优雅地集成到**ASP.NET**服务器控制方法中的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T12:58:51.873

你会想要利用

```
window.onbeforeunload 
```

事件。如果您在未保存撰写的电子邮件时尝试关闭窗口，则与 Gmail 类似。

这里有一些示例 JS。

[http://forums.devarticles.com/javascript-development-22/how-to-stop-browser-from-closing-using-javascript-8458.html](http://forums.devarticles.com/javascript-development-22/how-to-stop-browser-from-closing-using-javascript-8458.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T13:10:28.073

这是一个 ASP.NET 扩展器控件，可以帮助您解决此问题：

[http://www.codeproject.com/KB/ajax/ajaxdirtypanelextender.aspx](http://www.codeproject.com/KB/ajax/ajaxdirtypanelextender.aspx)

希望这可以帮助。它可能不完全符合您的需求，但它至少向您展示了如何。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:19:18.560

只需添加**`window.onbeforeunload`**事件。这将显示一个模态窗口，您可以在其中决定留下或离开页面。

```
window.onbeforeunload = function (event) {
  var message = 'All changes will get lost!';
  if (typeof event == 'undefined') {
    event = window.event;
  }
  if (event) {
    event.returnValue = message;
  }
  return message;
} 
```

所有浏览器都会提供标准消息（“您确定要离开此页面吗？”）以及您的自定义消息。

所以窗口将如下所示：

```
---------------------------------
| Are you sure you want to      |
| navigate away from this page? |
|                               |
| All changes will get lost!    |
|                               |
|     [Cancel]     [Ok]         |
--------------------------------- 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T13:07:43.150

您可以创建一个扩展[IExtenderProvider](http://msdn.microsoft.com/en-us/library/system.componentmodel.iextenderprovider.aspx)的控件并让它创建 JavaScript 来跟踪更改（或者更有可能使用更改跟踪机制注册控件）。

但是，除非您需要大量回发，否则您仍然必须在 Javascript 中实现更改跟踪。

我在以前的雇主那里使用[Prototype.Js](http://www.prototypejs.org/)做到了这一点。我认为唯一困难的是 Internet Explorer 和 Firefox 需要设置“取消导航”标志的方式之间的区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T12:55:55.547

在 Page_Unload 事件中（或者在你的 body 标签中调用这个函数，`<body onunload="onPageUnload();">`），你可以检查表单中是否有数据。然后你可以运行一些Java：

```
<script language="text/javascript">
   function onPageUnload() {
        var oConfirm = window.confirm("You have unsaved form data, are you sure you want to close this window?");
        if(oConfirm){
            //Close
        }else{
            //Dont 
        }
    }
</script> 
```

看看这对你有什么影响

编辑：它可能不会阻止关闭窗口，但它会提醒您的用户他们在您的表单中有未保存的数据。

确认不能跨浏览器工作，我将研究一种不同的方法并将其发布在这里。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T13:04:26.463

正如其他人所提到的，您需要查看 window.onunload/onbeforeunload 事件。这个事件的问题是每当页面被卸载时它都会被调用。不仅在浏览器窗口关闭时，而且当您单击同一浏览器窗口中的链接以转到同一站点上的不同页面时。你仍然可以做你想做的事，但如果你能预料到这种行为，它会有所帮助。

# apache-flex - Flex - Remoting vs HTTPService - 何时使用什么？

> ID：250058
> 
> 赞同：7
> 
> 时间：2008-10-30T12:49:52.517
> 
> 标签：apache-flex, flash, actionscript-3, remoting

我使用 Flex 已经有一段时间了，到目前为止还没有使用过远程处理。目前，我的应用程序使用生成用于数据绑定的 xml 的 web 服务。

在这个用例中，通过 xml web 服务使用远程处理有什么好处？当我应该选择远程处理而不是 Web 服务时，是否有一般准则？

为什么我要使用远程处理？

我已经下载了[http://www.fluorinefx.com/](http://www.fluorinefx.com/)，但还没有做任何真正的修补......

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T15:21:35.517

如果您只在客户端和主机之间使用简单的数据传输，那么 Web 服务非常有用。您形成 XML 消息，将其发送到服务器并返回一个简单的 XML 消息。然后你反序列化它并相应地对数据采取行动。AS3 对 XML 的支持非常出色，您可以使用它与任何数据服务进行通信，并且您可以完全控制客户端。

当来回传递的数据结构变得过于复杂，或者来回传递的不同数据结构的数量变得太大时，Web 服务就会崩溃。Remoting 通过提供一个为您处理序列化的重量级框架克服了这些问题。定义您的 .NET/PHP/Java 或任何类，框架应提供生成等效 AS 类的工具。这样您就可以来回发送复杂的对象结构，而无需知道数据是如何被序列化的。因为你不需要知道，它可以压缩结构使其几乎不可读，甚至可以使用二进制数据来提高速度。

远程处理不适合小规模或各种服务器协议的东西。您必须在服务器和客户端之间同步类结构；您只能与兼容的远程服务器进行通信，并且该框架会增加客户端大小和复杂性的开销。

关于何时使用哪个，没有正确的答案。两者都有优点和缺点。不过，根据经验，对简单的东西使用 Web 服务，对复杂的东西使用远程处理（这是非常模糊的建议；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T14:02:37.300

就个人而言，我使用远程处理是因为我更喜欢 AMF 而不是 SOAP/XML，原因很简单，因为速度和数据包大小。

[Ted 在此处](http://www.onflex.org/ted/2006/12/xmle4x-vs-amf.php)对 XML 与 AMF 的相对优点进行了很好的讨论

需要考虑的是您在服务器上已有的内容以及您认为客户的未来所在的位置。您是否预计更换或扩展您的客户？如果是，那么 Web 服务是一个很好的架构选择。如果您在短期/中期承诺使用 Flex，那么您可能能够从使用 AMF3 的远程处理与您的 Web 服务中获得更好的性能。

PS 我曾经有一个链接到一个非常好的站点，它测量了 AMF 和 SOAP 的相对性能 - 我会看看我是否能找到它并发布一个链接。

PPS[在这里](http://www.jamesward.com/census/)，但目前似乎不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:03:34.490

远程处理旨在使数据从远程服务传输到 Flash 或 Flex 应用程序更容易和更快。使用远程处理时，无需解析或反序列化从服务接收到的数据。这是因为数据是以本机字节码发送到应用程序的。

我使用远程处理的主要原因之一是它比 XML 服务更轻量级。这是因为 XML 在内存方面是一种糟糕的格式，尤其是对于大型数据集。XML 作为一种交换格式非常棒，但是一旦进入您的应用程序，由于冗长的标签和可能的空白，很可能会比以本机字节码表示的值消耗更多的内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-18T15:01:07.970

[这是一个非常好的实时基准测试](http://www.themidnightcoders.com/products/weborb-for-net/developer-den/technical-articles/amf-vs-webservices.html)，将 AMF 远程处理与 Web 服务和 HTTP 服务进行比较。您甚至可以下载源代码以在您自己的环境中运行此测试。

我也同意之前的一些帖子，即当您运行大型数据集时，AMF 远程处理确实会大放异彩。对于较小的数据集，您可能不会看到显着差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T23:05:26.917

另外值得注意的是，一旦您开始进入这个领域，一个好的有线协议分析器是无价的。专门为闪存协议编写的两个是[Charles](http://www.charlesproxy.com/)和[Service Capture](http://kevinlangdon.com/serviceCapture/)。我刚刚购买了 Service Capture，并且对它非常满意。它还有一个很棒的“带宽模拟”工具，有助于查看我的预加载器在较低带宽连接上的外观。

马库斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T16:58:31.243

如果您打算在其他应用程序上使用数据（意味着您的只是几个前端之一），您可以使用 XML，否则您将通过使用远程处理节省一些时间。

# c# - 术语“真正的”面向对象是什么意思

> ID：250062
> 
> 赞同：8
> 
> 时间：2008-10-30T12:52:05.100
> 
> 标签：c#, ruby, oop

我听说过很多关于 Ruby 甚至可能是 Javascript 是“真正的”面向对象的语言，而不是 C++ 和 C#，它们是面向类（或基于模板）的语言。真正的 OO 是什么意思，与类/模板方法相比有什么优势？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-30T13:03:37.060

这是一个用于推广语言的主观术语。我曾经看到，与 C++ 相比，C# 和 Java 是真正的面向对象语言，因为一切都必须在一个类中（没有全局函数或变量），并且所有对象都继承自一个 Object 类。

对于 Ruby，它可能是指 Ruby 如何将所有内容都视为对象，因此您可以编写`1.to_s`，而不是类似`str(1)`or的东西`String.valueOf(1)`。这是因为 Ruby 不区分值变量和引用变量。在 Javascript 中没有类，您只需创建可以克隆以供重用的可扩展对象，这种编程风格被称为[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)。

另一方面，C++ 被宣传为一种多范式语言，它允许您使用多种方法，例如面向对象、通用和过程编程。它不拘泥于一种范式。

但是，是的，这只是一个主观术语，可能意味着任何事情。通常它指的是该语言是否更强调对象而不是函数、模板等其他语言元素。[维基百科关于 SmallTalk 的文章](http://en.wikipedia.org/wiki/Smalltalk)称其为“纯”面向对象的语言，该描述也适用于 Ruby：

> Smalltalk 是一种“纯”OO 语言，这意味着，与 Java 和 C++ 不同，作为对象的值和作为原始类型的值之间没有区别。在 Smalltalk 中，诸如整数、布尔值和字符之类的原始值也是对象，因为它们是相应类的实例，并且通过发送消息来调用对它们的操作。程序员可以更改实现原始值的类，以便可以为它们的实例定义新的行为——例如，实现新的控制结构——甚至可以改变它们现有的行为。这个事实总结在常见的短语“在 Smalltalk 中，一切都是对象”（更准确地表示为“所有值都是对象”，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T12:57:18.773

C++ 问题如下。C++ 类仅存在于源语法中。没有具有属性和方法的运行时类对象。

在 Python 中，一切都是对象。一个对象的类是另一个对象，它有自己的方法和属性。smalltalk 环境也是如此，它是面向对象的一种基准。

我认为“真正的”面向对象是指那些一切都是对象的环境。

[Java 没有做到这一点，因为它有原始类型。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T13:00:37.063

我认为它可能指的是[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)，一种[编程范式](http://en.wikipedia.org/wiki/Programming_paradigm#Hierarchy_of_programming_paradigms)，其中：

> 类不存在，行为重用（在基于类的语言中称为继承）是通过克隆作为原型的现有对象的过程来执行的。这种模型也可以称为无类、面向原型或基于实例的编程。

另请参阅[Ruby 单例方法](http://www.rubyist.net/~slagell/ruby/singletonmethods.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T04:55:52.027

*C++ 问题如下。C++ 类仅存在于源语法中。没有具有属性和方法的运行时类对象。*

当然，根据该规则，在传统机器架构*上*不存在面向对象编程之类的东西，因为在机器代码级别不存在具有属性和方法的运行时类对象。（或者，至少，除了像旧的[System/38](http://en.wikipedia.org/wiki/System/38)或[AS/400](http://www.cincomsmalltalk.com/userblogs/rademers/blogView?showComments=true&entry=3244986766)这样的专用架构之外，没有其他的。）

“[面向对象](http://en.wikipedia.org/wiki/Object-oriented_programming)”的含义很久以前就被确定为三件事：[抽象数据类型](http://en.wikipedia.org/wiki/Abstract_data_type)，具有[继承](http://en.wikipedia.org/wiki/Inheritance_(computer_science))性和[多态性](http://en.wikipedia.org/wiki/Polymorphism_(computer_science))。（链接的维基百科文章在一定程度上混淆了 OO 的属性和好处。但重要的区别在于 OO 和“[基于对象的](http://en.wikipedia.org/wiki/Object-based)”系统。）

一般来说，“X 不是*真正*面向对象的，不像 Y”真正的意思是“我想卖给你 Y”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T13:00:37.750

“真”或“纯”面向对象的语言通常是指一切都是包括原始类型在内的一流对象的语言。例如，在 C++ 和 Java 中，基本类型 int、char 等不是对象。例如，在 Ruby 中，一切都是对象。有时，定义中隐含了其他标准，具体取决于您与谁交谈。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T04:42:39.043

该术语“真正的面向对象”的另一种解释是，您可以采用一些本身不支持 OOP 的语言，并在其上坚持一种 OOP 的做事方式。例如，您可以对 C 中的封装进行建模，例如

```
typedef struct foo_ {
    T1 (*getA)(foo * self);
    void (*setA)(foo * self, T1 a_);

/* private: */
    T1 a_;
} foo;

T1 foo_getA(foo * self) {
    return self->a_;
}

void foo_setA(foo * self, T1 a_) {
    self->a_ = a_;
}

foo * foo_create() {
    foo * f = malloc(sizeof(foo));
    f->getA = foo_getA;
    f->setA = foo_setA;
    return f;
}

void foo_destroy(foo * f) {
    free (f);
}

void doSomething(T1 a) {
    foo * f = foo_create();
    f->setA(f, a);
    foo_destroy(f);
} 
```

实现继承和多态的技术已经使用了很长时间。一个例子是`GObject`用作 gtk+ 基础的框架。

现在，虽然您可以以面向对象的方式进行编程，但 C 不支持面向对象，而仅允许您在某种程度上模拟它。所以你没有真正的面向对象。查看 C++/Java/C#，您可以支持所有这些类型的东西，例如继承/数据封装和第一手资料。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T02:16:17.820

术语“真正的面向对象”与朴素的术语“面向对象”具有相同的含义。

当将限定词“真实”添加到“手头的主题”时，人们试图提醒读者在当前的话语世界中存在对所述主题的一个或多个“不完整模仿”，它们可以互换使用，但与主语相比，缺乏一个或多个对话语具有重要意义的属性。

此类使用后通常应附有对主体属性的描述，或对“模仿主体”中缺少的属性的描述，或两者兼而有之；从而引导读者理解或至少考虑区别。

创造这个短语的人使用的面向对象似乎包括以下属性：

*   仅通过（消息）将（数据+行为）封装到（对象）中进行通信。
*   当不再引用表示（对象）时，自动回收用于表示（对象）的内存。
*   将（意义）延迟绑定到对象的（表示）上。
*   从（对象）到（对象的属性）的运行时反射。

实践和经验告诉我们，
同样必要的是，包括

*   闭包（有时称为“真正的闭包”，
      正式意义上的（闭包），
      并遵循（lisp）中的闭包示例。
    ）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-30T12:54:50.477

不确定您从提供的示例中获得的区别。但我知道它不是什么！当 OO 作为一种事后的想法被固定在一种语言上时，例如 Perl OO。

# build-environment - Web 开发人员 - 在本地机器上还是在远程主机上进行开发更好？

> ID：250063
> 
> 赞同：40
> 
> 时间：2008-10-30T12:52:26.957
> 
> 标签：build-environment

在本地机器上而不是在集中式开发服务器上进行 Web 开发的优缺点是什么？对于那些在本地机器上进行开发的人，当涉及多个开发人员时，如何为本地开发保持更新的数据库架构？

特别是，我目前正在试验用于 PHP 的 XAMPP，并且很好奇当其他开发人员定期更改数据/数据库结构时，我如何使本地计算机上的 MySQL 数据库实例保持同步。

本地开发只有在单独工作时才实用吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-30T12:59:56.270

*   始终，始终在本地设置上开发。
*   始终使用源代码管理。
*   始终将所有内容置于源代码控制之下，包括数据库模式。

似乎有很多人喜欢拥有一个每个人都用于开发的中央服务器——我真的不明白为什么你更喜欢在一个共享环境中，人们进行更改会中断你的开发过程。

在我的商店中，每个人都有自己的开发 Web 服务器和自己的开发数据库（通常位于同一数据库*服务器上*，但他们自己的数据库）。这样他们就与其他开发人员完全隔离，并且不能互相打扰。

当他们实现一个特性或修复一个错误时，他们会检查他们的代码*和匹配的数据库模式*，以便其他开发人员可以将其作为一个完整的单元使用。发布到测试服务器或部署服务器是从源代码存储库中的标记版本完成的。

稳定而理智！我不明白为什么当开发服务器免费时你会以任何其他方式做这件事！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-30T12:58:49.020

我认为最好有一个在开发过程中完全由您控制的本地设置，以确保其他开发人员所做的更改不会干扰您自己的更改。我在本地设置了开发和测试环境，因此我可以执行这两项任务而无需考虑其他开发人员。我在使用自动测试进行编码时不断运行测试，这意味着我可以确定我的代码是正确的并且满足正确的规范。

在代码库整理好之后，我部署到一个登台服务器（这是一个尽可能接近生产的环境），然后重新运行测试。我们还使用我们的阶段来运行负载测试并进行用户测试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-30T13:22:03.777

至于在其他人编辑时保持您的数据库“同步”。解决此问题的一种方法是将您的数据库模式置于版本控制之下。这不像将源代码置于版本控制之下那么简单，并且有不同的处理方式。

阅读有关编码恐怖的这篇文章：

[https://blog.codinghorror.com/get-your-database-under-version-control/](https://blog.codinghorror.com/get-your-database-under-version-control/)

与其说是帖子本身，不如说是他链接到的 K. Scott Allen 的六篇文章。

基本上，这些文章中描述的是一种基线数据库模式的方法，检查该基线的 .sql 文件，然后在每次更改模式时编写增量 .sql“更改脚本”。现在，每次开发人员签出或更新工作副本时，都会运行任何未完成的更改脚本。除非您使用为您执行此操作的框架，否则您将需要设置一些脚本/工具来自己执行此操作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-30T12:56:01.893

我发现使用远程数据库运行本地 Web 服务器效果最好。数据库复制/同步很痛苦，所以如果我*真的*需要，我只会使用本地数据库。

使用本地 Web 服务器虽然消除了在更改之间上传页面/代码的所有烦恼和缓慢。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-30T12:57:40.800

本地的优点：

*   即使网络出现故障也能正常工作
*   你知道机器上的每一个工具

对本地的缺点：

*   必须将所有内容同步到部署服务器
*   没有版本控制你可以破坏别人的工作

中央的优点：

*   每个人都有相同的工具
*   始终致力于“真实”内容

中央的缺点：

*   如果网络中断，将无法工作
*   您“最喜欢的”工具可能丢失了

我敢肯定还有更多，但这些都是马上想到的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-30T12:59:01.797

在本地机器上开发和“测试”是可以的，但质量测试应该在反映目标环境的系统上执行，即没有安装所有开发工具等。

这将有助于避免“它在我的机器上运行良好”的情况。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-30T13:17:25.363

FWIW，我会提到我们的设置就像马特先生描述的那样。每个开发人员都有自己的个人沙箱，有自己的网络服务器和数据库。在发布的边缘，版本控制的代码被快照/分支并移动到一个临时服务器，该服务器应该尽可能地模仿真实的实时环境。随后进行测试，然后发布到生产环境。

对于我自己的个人（非工作相关）项目，我在本地开发，然后进行直播。一两个项目可能在开发和公共/实时之间有一个中间测试服务器/环境。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-30T13:39:06.083

在本地工作的另一个原因是一切都运行得更快。这转化为更快的发展。网络延迟可能是生产力杀手！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-30T13:01:25.253

两个都。在您的开发服务器上进行一些集成和单元测试（理想情况下，它应该与您的实时服务器尽可能相似，但是是本地的），然后在 QA 环境中进行一些验收测试，这应该与您的实时服务器相同服务器，或完全相同的设置（硬件、软件等），并且应该是远程的。

当涉及到问题的数据库部分时，您可以：

*   每个人都有自己的数据库副本或
*   通过运行集中式脚本（可能作为构建的一部分）保持数据/结构同步

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T13:08:43.710

在 localhost 上进行测试的一个问题是，您可能会错过链接到本地​​文件而不是通过浏览器访问的内容。我父亲总是在他的相机俱乐部网站上放一些链接，比如'a href="C:\My Documents\Camera Club\Photos..."，而当我告诉他他搞砸了，他会说“它对我有用”。同样，在专业环境中，您可能会忘记检查源代码控制中的内容，因此它们不会部署在真实服务器上。

一种折衷的解决方案可能是拥有虚拟机，VirtualBox、VMWare 或 Parallels，这样您就可以启动虚拟 Solaris、Windows、Mac 和/或 Linux 机器来测试它——这将向您展示您的网站在默认浏览器中的外观在每一个上，再加上您可以确保事情通过非本地连接实际工作。更好的办法是拥有一个您部署到的 VM，并将其用作您的 Web 服务器进行测试。

如果您的基础操作系统是 OpenSolaris，您甚至可以使用 ZFS 并使用快照，以便在每次测试运行后将您的虚拟机回滚到其基础状态。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-30T13:21:35.197

我一直在用 Ruby on Rails 构建一个站点，并且一直在本地进行开发，但尽可能多地部署到远程机器上。我在使用 Rails 的敏捷 Web 开发中读到，你练习部署的次数越多越好，因为当部署到生产环境时 - 不会有任何意外。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-30T13:46:31.793

在我目前的职位上，我在自己的机器上进行开发。对于较小的项目，我只使用 Visual Studio 附带的轻量级 Web 服务器。我还在自己的机器上安装了 SQL Server 2005 和 2008，用于开发和初始测试。

总的来说，这对我来说效果很好。我遇到的一个问题是（正如其他人所指出的）保持数据库同步是一种痛苦。我最近搬到了[迁移器 dot](http://code.google.com/p/migratordotnet/) net——基本上是一个 .NET 对 Ruby on Rails 迁移的看法——用于保持本地/暂存/uat/生产数据库同步，这让我的生活压力减轻了很多。像这样的工具还可以更轻松地在团队环境中处理数据库，尽管您必须有足够的纪律才能始终如一地使用它。

我在这里的经验使我相信，本地开发结合某种数据库更改控制过程、持续集成服务器和支持合并的良好版本控制系统（我们使用 TFS）是最好的方法。这让每个人都可以做自己的事情而不会踩到其他人，但也可以确保正确合并更改。

在我之前的工作中，我们在 PC 上使用了 IIS，并结合了一个专用的开发数据库，​​这有点像 PITA——你必须小心不要运行任何可能会关闭数据库甚至弄乱数据的进程，因为它可能会影响其他开发人员和 IMO，这首先破坏了拥有开发数据库的目的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-30T16:29:25.490

我是一个人的商店；我有一个远程服务器和一个本地服务器。

我使用本地服务器进行快速原型设计和初始开发周期，我在其中进行了大量更改并需要快速测试它们。当它进入大致 alpha 阶段时，我将为项目设置一个自定义子主机并部署到我的服务器。有些特性根本无法在本地测试——即基于电子邮件的用户注册——因此这些特性在远程服务器上开发。由于它是 MINE，而不是真正的部署，因此它仍然基本上没有延迟。由于我有一个 VPS，我可以完全控制两台机器上的开发环境。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-10-30T17:41:25.553

在当地发展。注意相反答案的日期。毫无疑问，它们已经过时了。

让我们澄清事实。十年后这个问题继续被问到，一些人继续发布过时的概念。阅读接受的答案。可以肯定地说，这些天是无可争议的。在过去的十年中，各种答案中提到的对当地发展的“弊端”已经得到了相当好的解决。

但是**太棒了！**这个问题的一些答案描述了生产上的开发，风险的严重升级。需要明确的是：严格避免在生产上开发。（我相信那些开发人员不再提倡它。对过时答案的支持可能会过期。也许那些投票的人会回来并表明他们的最新想法。）

推荐的解决方案超出了已接受答案中提到的解决方案：

*   如果可以的话，将您的开发工作流程容器化（例如尝试 Docker）。
*   避免将数据库从本地推送到远程；找到基于源代码控制的更增量的托管流程。Drupal 8 中的[配置管理倡议](https://www.drupal.org/docs/8/configuration-management/managing-your-sites-configuration)提供了一个有趣的例子。
*   对于源代码控制，请考虑 Git。如果您推迟采用源代码控制管理解决方案，请不要再拖延！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-30T12:55:15.220

对于这种情况，我总是在开发服务器上完成。因为没有重新编译。您总是可以每天获得一个新的数据库快照并将其下载到您的机器上。或者只是将 Web 服务器放在本地并将数据库指向开发框。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-30T18:17:13.120

我发现在访问集中式开发数据库的同时使用源代码控制在本地机器上开发代码效果很好。事实证明，保持多个数据库同步是很困难的。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2008-10-30T12:55:03.737

通常，您将拥有一个每个人都共享的本地开发服务器。

# linq - LINQ 与 SQLite (linqtosql)

> ID：250071
> 
> 赞同：59
> 
> 时间：2008-10-30T12:53:59.137
> 
> 标签：linq, linq-to-sql, sqlite

我有一个需要存储的小项目（我选择 SQLite），我使用[ADO DLL for .Net for Sqlite](http://sqlite.phxsoftware.com/)获得了很好的结果。

安装后，我注意到它包含一个 SQLLinq.dll。在调查太多努力之前，并且因为我在网上没有看到任何好的例子，我想知道是否有人使用 SQLite 和 LINQ 获得了任何好的结果？

*如果 linqtosql 的工作方式与 SQL 数据库相同，请告诉我。当我看到它时，我对 Dll 很感兴趣，因为我以前从未使用过 Linqtosql，我认为这将是一个很好的尝试机会，

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-19T21:38:40.090

我最近发现了[DBLinq](http://code.google.com/p/dblinq2007/)，它支持 SQLite 以及其他数据库：

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-11-05T14:28:51.910

根据我自己的经验，Microsoft SQL Compact Framework 是一个真正的禁忌。它真的很慢，而且它的查询分析器真的很差。我不得不要求我的团队重写我的 Windows Mobile 组件的所有管道代码，以摆脱 SQL CE 的糟糕性能。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-30T16:26:31.940

LINQ to SQL 仅支持 SQL Server/Compact，但是 SQLite 人员可能已经根据程序集的名称编写了自己的 LINQ 提供程序。

如果是这种情况，您将能够通过添加对它的引用来使用 LINQ 查询语法，但您不会获得 LINQ to SQL 特定功能，例如 DataContext/designer/SQL Metal/Column attributes/EntitySet/EntityRef 等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-14T05:48:27.837

我知道这个问题很老，但此时，我想我们可以在这里找到 SQLite 支持 .NET 的官方实现：http: [//system.data.sqlite.org/index.html/doc/trunk/www/索引.wiki](http://system.data.sqlite.org/index.html/doc/trunk/www/index.wiki)。应该在这里找到一篇好的介绍性文章：http: [//www.codeproject.com/Articles/236918/Using-SQLite-embedded-database-with-entity-framewo](http://www.codeproject.com/Articles/236918/Using-SQLite-embedded-database-with-entity-framewo)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-30T14:36:30.133

这不是您的问题的答案，但作为替代方案，您可以使用 SQL Compact：

[http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)

它具有良好的 LINQ-to-SQL 支持，并且（尽管名称如此）非常适合具有小存储需求的桌面应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-22T00:37:14.243

NuGet 上有一个名为“LINQ to SQLite”的包。我没试过，但感觉很新鲜。

[https://www.nuget.org/packages/linq2db.SQLite/](https://www.nuget.org/packages/linq2db.SQLite/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-14T09:46:10.650

这是一个很好的 linq to sqlite ..

[http://www.devart.com/dotconnect/sqlite/](http://www.devart.com/dotconnect/sqlite/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-22T16:53:11.590

使用 EntityFramework 7 改进了对 SqLite 的支持，并且可以使用 EntityFramework.Commands 创建一些迁移。这是一个教程：

[https://xamlbrewer.wordpress.com/2016/06/01/getting-started-with-sqlite-and-entity-framework-on-uwp/](https://xamlbrewer.wordpress.com/2016/06/01/getting-started-with-sqlite-and-entity-framework-on-uwp/)

作为先决条件，至少应安装 PowerShell3。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-09T00:34:20.820

由于不再维护 DBLinq，我一直在搜索并找到[这个答案](https://stackoverflow.com/a/22563861/316760)，它不清楚地指向使用 Linq to Sql、Entity Framework 和 SQLite 的解决方案。他链接到的[博客文章](http://www.bricelam.net/2012/10/entity-framework-on-sqlite.html)有点过时，但经过一些调整，我在 GitHub 上找到了一个**[工作示例。](https://github.com/JVimes/LinqSqLiteExample)**

它应该在 Visual Studio 2013 中运行 OOTB。它显示了添加记录（与另一个表中的相关记录）、修改和删除。Artist 和 Album 类代表各自表中的记录（我相信是实体框架的一部分）。请参阅自述文件，了解一些需要注意的问题。

# datetime - 如何在经典asp中检查日期

> ID：250077
> 
> 赞同：1
> 
> 时间：2008-10-30T12:55:55.310
> 
> 标签：datetime, asp-classic

我有一个变量**last_login ，如果上次登录是***昨天*、*今天*或者输出日期，我想输出一条消息。最后两种情况很清楚，但我如何检查经典 asp 中的给定日期是否是**昨天**？

我现在头晕...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T13:00:14.773

dateadd("d",-1,currentDate)

[http://www.w3schools.com/Vbscript/func_dateadd.asp](http://www.w3schools.com/Vbscript/func_dateadd.asp)

# file - 如何检查makefile中是否存在文件

> ID：250082
> 
> 赞同：15
> 
> 时间：2008-10-30T12:57:47.883
> 
> 标签：file, makefile, compilation, testing, gnu-make

我有一个生成文件模板来编译单个 DLL（用于插件系统）。用户的 makefile 如下所示：

```
EXTRA_SRCS=file1 file2
include makefile.in 
```

在`makefile.in`我有：

```
plugin.dll: plugin.os $(patsubst %,%.os,$(EXTRA_SRCS)) 
```

`plugin.os`要编译的主要 C++ 文件在哪里。顺便说一句，文件结尾是`.os`为共享库编译的目标文件（即使用`-fpic`选项 with `gcc`）

现在，问题是额外的源可能（但不一定）是头文件。理想情况下，我想将它们添加为目标`plugin.os`和 的依赖项`file.cpp`，但前提是它们存在。

该方法应该适用于 windows 和 linux，或者至少适用于每个。但是，我只使用 GNU 版本的 make。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-30T13:25:56.407

使用“通配符”功能：

```
$(wildcard *.h) 
```

编辑：为了匹配特定列表，请执行

```
$(wildcard $(HEADER_FILES)) 
```

无需使用$(filter ...)，通配符功能会自动过滤不存在​​的文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-30T16:20:19.080

您没有指定正在使用的编译器，但如果您可以访问 gcc/g++，则可以使用 -MM 选项。

我所做的是为每个 .c 或 .cpp 文件创建一个扩展名为 .d 的文件，然后“包含” .d 文件。我在我的 Makefile 中使用了这样的东西：

```
%.d: %.c
        gcc $(INCS) $(CFLAGS) -MM $< -MF $@

%.d: %.cpp
        g++ $(INCS) $(CXXFLAGS) -MM $< -MF $@ 
```

然后我创建这样的依赖项：

```
C_DEPS=$(C_SRCS:.c=.d)
CPP_DEPS=$(CPP_SRCS:.cpp=.d)
DEPS=$(C_DEPS) $(CPP_DEPS) 
```

这在 Makefile 的底部：

```
include $(DEPS) 
```

这是你想要的那种行为吗？这种方法的美妙之处在于，即使您使用非 GNU 编译器进行实际编译，GNU 编译器也能很好地计算依赖关系。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T16:30:21.790

做简单的

```
$(filter $(wildcard *.h),$(HEADER_FILES)) 
```

做你想做的事？

# c++ - 如何使用 std::copy 读取任意数量的值？

> ID：250096
> 
> 赞同：8
> 
> 时间：2008-10-30T13:02:02.287
> 
> 标签：c++, iterator, stl-algorithm, istream-iterator

我正在尝试编写与此相反的操作：

```
std::ostream outs; // properly initialized of course
std::set<int> my_set; // ditto

outs << my_set.size();
std::copy( my_set.begin(), my_set.end(), std::ostream_iterator<int>( outs ) ); 
```

它应该是这样的：

```
std::istream ins;

std::set<int>::size_type size;
ins >> size;

std::copy( std::istream_iterator<int>( ins ), std::istream_iterator<int>( ins ) ???, std::inserter( my_set, my_set.end() ) ); 
```

但是我坚持使用“结束”迭代器——输入插入器不能使用 std::advance ，我也不能使用具有相同源的两个流......

有什么优雅的方法可以解决这个问题吗？当然我可以使用 for 循环，但也许有更好的东西:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T16:03:04.153

您可以从 istream_iterator<T> 派生。
虽然使用[Daemin 生成器方法](https://stackoverflow.com/questions/250096/how-to-read-arbitrary-number-of-bytes-using-stdcopy#250380)是另一种选择，但我会直接生成到集合中而不是使用中间向量。

```
#include <set>
#include <iterator>
#include <algorithm>
#include <iostream>

template<typename T>
struct CountIter: public std::istream_iterator<T>
{
    CountIter(size_t c)
        :std::istream_iterator<T>()
        ,count(c)
    {}
    CountIter(std::istream& str)
        :std::istream_iterator<T>(str)
        ,count(0)
    {}

    bool operator!=(CountIter const& rhs) const
    {
        return (count != rhs.count) && (dynamic_cast<std::istream_iterator<T> const&>(*this) != rhs);
    }
    T operator*()
    {
        ++count;
        return std::istream_iterator<T>::operator*();
    }

    private:
        size_t  count;
};

int main()
{
    std::set<int>       x;

    //std::copy(std::istream_iterator<int>(std::cin),std::istream_iterator<int>(),std::inserter(x,x.end()));
    std::copy(
                CountIter<int>(std::cin),
                CountIter<int>(5),
                std::inserter(x,x.end())
            );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T18:19:38.720

采用：

```
std::copy( std::istream_iterator<int>(ins),
           std::istream_iterator<int>(),
           std::inserter(my_set, my_set.end())
         ); 
```

注意空参数：

```
std::istream_iterator<int>(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T13:53:02.967

Errr ... [copy_n()](http://www.sgi.com/tech/stl/copy_n.html)算法？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T14:38:16.867

稍微研究一下，我认为直接读入一个集合是行不通的，因为您需要在其上调用 insert 以实际添加元素（我可能弄错了，这里是清晨）。尽管简要查看了 VS2005 中的 STL 文档，但我认为使用 generate_n 函数的东西应该可以工作，例如：

```
std::istream ins;
std::set<int> my_set;
std::vector<int> my_vec;

struct read_functor
{
    read_functor(std::istream& stream) :
        m_stream(stream)
    {
    }

    int operator()
    {
        int temp;
        m_stream >> temp;
        return temp;
    }
private:
    std::istream& m_stream;
};

std::set<int>::size_type size;
ins >> size;
my_vec.reserve(size);

std::generate_n(my_vec.begin(), size, read_functor(ins));
my_set.insert(my_vec.begin(), my_vec.end()); 
```

希望这要么解决了你的问题，要么让你相信循环在宏伟的计划中并没有那么糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T07:52:05.643

如何使用备用迭代器进行遍历，然后使用函数对象（或 lambda）填充容器？

```
istream ins;
set<int>::size_type size;
set<int> new_set;
ins >> size;
ostream_iterator<int> ins_iter(ins);

for_each(counting_iterator<int>(0), counting_iterator<int>(size),
  [&new_set, &ins_iter](int n) { new_set.insert(*ins_iter++); }
); 
```

当然，这假设您有一个符合 C++0x 的编译器。

顺便说一句，'counting_iterator<>' 是[Boost.Iterator](http://www.boost.org/doc/libs/1_36_0/libs/iterator/doc/counting_iterator.html)的一部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-06T16:01:19.120

或者你可以这样做：

```
my_set.insert(std::istream_iterator<int>(ins), std::istream_iterator<int>()); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T13:25:20.260

（编辑：我应该仔细阅读这个问题......）

虽然有些怀疑，但您可以通过在文件中添加一个“失败”第一个循环的条目来获得大致正确的行为，然后清除流上的失败位并开始阅读更多内容。

数据，没有明确的大小，但像这样

```
1 1 2 3 5 8 菲布

```

输入下面的代码似乎符合我的意思，至少在带有 STLPort 的 VS2005 上。

```
typedef std::istream_iterator < int, char, std::char_traits ,ptrdiff_t> is_iter;
std::copy(is_iter(cin), is_iter(), inserter(my_set,my_set.end()));
cin.clear();
std::cin >> instr;

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T13:28:06.150

是的 sdg 但是当我想在该文件/流中使用其他数据结构时？我可能应该明确地写在这里，我想在这个集合之后存储另一个东西，这也是我存储大小的原因。

# sql-server-2005 - SQL Server 管理工作室 2008 智能感知

> ID：250127
> 
> 赞同：26
> 
> 时间：2008-10-30T13:12:02.377
> 
> 标签：sql-server-2005, sql-server-2008, intellisense, ssms

由于智能感知功能，我刚刚安装了 SQL Server Express 2008。它起初工作，但后来停止工作。寻找检查选项并稍后咨询 Google 我发现**如果您连接到 SQL Server 2005 数据库，Microsoft 似乎禁用了智能感知。**

这绝对正确吗？
有没有解决方案（一些注册表“开关”）？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-30T23:20:24.287

如果您希望看到添加的功能，请在[Connect](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=341872)上为请求投票。以下是团队关于为什么放弃它的反馈：

> 让我分享一下产品团队关于 IntelliSense 版本支持的信息。这是从 IntelliSense 项目开始时真正的设计，它是业务决策的一部分。IntelliSense 的实现需要使用托管代码库在客户端完全保真地重建引擎解析器。支持多个服务器版本意味着并行设计和实现多个版本的解析器和相关的基础设施。这会增加开发、测试和支持的时间和成本。同时，核心模块是一个重要的产品基础，不仅支持IntelliSense功能，还支持包括Upgrade Advisor在内的其他产品分析脚本；从长远来看，它可能是需要对 Transact-SQL 语言的句法和语义理解的任何功能。
> 
> 在 CTP5 和 CTP6 中，IntelliSense 存在一个已知问题，即它无法正确检查服务器版本，因此 CTP 用户可以将任何版本的 SQL Server 与 IntelliSense 连接。虽然有些用户没有注意到它，但 IntelliSense 并未按预期正常工作。其影响在于，IntelliSense 很有可能引导用户编写不正确的 Transact-SQL 脚本，或者在脚本在这些版本中完全有效时错误地指示脚本存在错误。
> 
> 考虑到 IntelliSense 的首要目标是提高编写复杂查询或存储过程（或简单的 Transact-SQL 脚本）的生产力，这个问题被认为是*降低生产力*的一个因素，这是新功能带来的巨大负面影响。
> 
> 在 RC0 中，此已知问题已得到纠正，即 IntelliSense 检查服务器版本并在受支持的版本（即 SQL Server 2008）上提供其功能。
> 
> 作为一个版本，IntelliSense 在 Transact-SQL 语言的子集上启用。这是因为在整个语言范围的托管代码中实现词法分析器、解析器、绑定器和脚本文档对象模型的工作范围很大。产品团队正在向前推进，重点是扩大语言支持范围。
> 
> 我希望这些信息至少能提供背景信息，为什么只在 SQL Server 2008 上选择目标版本。

[任何使用 RTM 版本的人都应该考虑这里](http://support.microsoft.com/kb/956717)提供的 CU1（累积更新 1）版本，因为已经解决了很多 IntelliSense 错误。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-25T11:14:52.830

此处添加到列表中的另一种免费工具是[ApexSQL Complete](http://www.apexsql.com/sql_tools_complete.aspx)。过去几个月我一直在使用它，我发现它比 SSMS 智能感知好一点，因为它提供了更多有用的工具提示。

一般来说，这里提到的任何工具都不会出错，尤其是当您准备为高级工具付费时。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-30T23:14:32.257

Red-Gate 的 SQLPrompt 在所有版本（2000、2005 和 2008）以及在 VS 甚至一些文本编辑器中运行时都很好地完成了这项工作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-01T16:34:57.263

确实，SSMS 中的智能感知仅适用于 SQL Server 2008。

最近我们发布了一个用于 SSMS 的自动完成工具 - **[dbForge SQL Complete](http://www.devart.com/dbforge/sql/sqlcomplete/)，**它为 SQL Server 2008、2005 和 2000 提供了 SQL 自动完成和格式化功能。

![dbForge SQL Complete - 主视图](https://i.stack.imgur.com/fB4QY.jpg)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-30T13:23:24.460

我不认为有办法解决这个问题（尽管我可能是错的），但这[可能](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=341872)有助于你寻求真相；-)

看起来智能感知在 CTP 期间建议 2008 年前数据库的“不正确”语法，并在 RTM 中被删除。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-30T23:02:01.500

我和一位同事都安装了 SQL Server Management Studio 2008，并且我们都连接到相同的 SQL Server 2005 和 2008 数据库。他在 2005 年和 2008 年都得到了智能感知。我只是在 2008 年得到它。我们无法弄清楚为什么会这样。

更正：原来我的同事以为他正在连接到 2005 服务器，但实际上是 2008 服务器。

结论：在咨询了我们的 DBA 之后，这似乎是不可能的。他们也对此进行了广泛的研究。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-23T02:11:11.267

如果您安装了正确的版本，但仍然没有 Intellisense [，这](http://blog.sqlauthority.com/2009/03/31/sql-server-2008-intellisense-does-not-work-enable-intellisense/)可能会对您有所帮助。

> 1) 确保您已连接到 SQL Server 2008 Edition。IntelliSense 不适用于以前版本的 SQL Server。
> 
> 2) 应启用 IntelliSense。有两种方法可以验证是否启用了 IntelliSense。a) 从工具栏 b) 转到工具 -> 选项 -> 文本编辑器 -> Transact-SQL -> IntelliSense
> 
> 3) IntelliSense 应使用数据库中的最新更改进行刷新。
> a) 按 CTRL+SHIFT+R b) 转到编辑 -> IntelliSense -> 刷新本地缓存
> 
> 4) 转到工具 -> 选项 -> 文本编辑器 -> Transact-SQL -> 常规 -> IntelliSense 选择自动列表成员并检查参数信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T14:49:23.267

> SQL Server 2008 数据库引擎中有代码支持 Management Studio 2008 中的智能感知功能。

不，没有。你完全错了，应该用湿鱼打耳光。

它所做的只是询问各种 INFORMATION_SCHEMA 虚拟表以进行发现。他们针对以前的版本禁用它的原因是，理论上它可能会鼓励您使用仅对 2005 有效的语法，但很多人在使用它时取得了 100% 的成功。当然，他们禁用它的*真正*原因是它减少了将服务器升级到 2008 年的一个优势（这是他们真正赚钱的地方）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-01T22:40:13.223

您可以在 DbOctopus 中使用智能感知 - 也适用于 SQL Server 2005 和 2000。它目前是免费的，但仅限于 2009 年 9 月 1 日。

你可以在这里找到它：

[http://www.cogin.com/dboctopus/](http://www.cogin.com/dboctopus/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-26T16:22:19.777

顺便说一句，最近我们发布了一个新版本的 SQL Complete，它提供了[许多新功能](http://www.devart.com/dbforge/sql/sqlcomplete/features.html)。所有新功能都在共享软件标准版中提供（30 天免费试用，49.95 美元）。

您仍然可以使用 Express Edition 获得所有基本功能，类似于 v. 1.0。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-30T13:27:41.300

不要想太多，以至于他们在 SQL Server 2005 中*禁用了智能感知，因为 SQL Server 2005 在构建时并没有考虑到智能感知支持。*SQL Server 2008 数据库引擎中有代码支持 Management Studio 2008 中的智能感知功能。

是的，我知道它*似乎*在后来的 CTP 预览版中有效，但一些谷歌搜索（和 DilbertDave 的链接）显示有多种方式破坏了 CTP 行为。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-30T13:43:54.997

只需使用 toad，比任何 Microsoft 工具都好。有一个免费软件版本。

[蟾蜍软](http://www.toadsoft.com/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-23T18:30:45.183

我使用免费软件 Atlantis SQL Enywhere 已经快一年多了，对它印象深刻。适用于 SQL 2005 和 SQL 2008 版本。它的功能给我留下了深刻的印象，并且键盘快捷键与 VS 相似，因此可以非常顺利地过渡到新的编辑器。

一些值得一提的功能。

Intellisense 在使用多个表和使用别名连接时实际工作 使用多个表时的连接建议（减少键入时间，非常整洁） 丰富的 sql 代码格式，使用 Ctrl K、Ctrl D 的 AutoIndent。更好地表示 SQL 计划。使用时突出显示变量声明。鼠标悬停时的表定义。

所有这些功能为我节省了很多时间。

尚未在 SQL 2012 上检查这一点。

# c - 涉及指针和数组的两个声明之间的区别

> ID：250134
> 
> 赞同：3
> 
> 时间：2008-10-30T13:14:34.290
> 
> 标签：c, arrays, pointers

`int *a[3]`和 和有什么不一样`int (*a)[3]`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-30T13:26:45.187

`int a[3]`和之间没有区别`int (a)[3]`，它们都声明`a`为 3 的数组`int`。`int *a[3]`和之间有区别`int (*a)[3]`，前者声明了一个包含 3 个指针的数组，`int`而第二个声明了一个指向 3 个数组的指针`int`。括号在这里有所不同，因为在 C 括号中的优先级高于 *。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-30T16:39:22.693

或者，您可以使用`cdecl`，它以英语输出变量声明的含义。

```
cdecl> explain int*a[3] 
```

**将 a 声明为指向 int 的指针的数组 3**

```
cdecl> explain int (*a) [3] 
```

**将 a 声明为指向 int 数组 3 的指针**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-30T13:32:23.303

如果您有任何疑问，使用这个 g++ 技巧通常很方便：

```
#include <iostream>

template < class T > void describe(T& )
{
  // With msvc, use __FUNCSIG__ instead
  std::cout << __PRETTY_FUNCTION__ << std::endl;
}

int main(int argc, char* argv[])
{
  int *a[3];
  describe(a);

  int (*b)[3];
  describe(b);

  return EXIT_SUCCESS;
} 
```

用 g++ 编译并运行它，你会得到：

```
void describe(T&) [with T = int*[3]]
void describe(T&) [with T = int (*)[3]] 
```

所以，他们绝对不一样！你所拥有的是：

1.  一个由 3 个指向 int 的指针组成的数组。
2.  指向 3 个整数数组的指针。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-30T13:30:29.533

您的星号似乎在格式中丢失了...

```
int *a[3] 
```

声明一个数组 3 `int*`。

```
int (*a)[3] 
```

将 a 声明为指向整数向量的指针。这实际上与任何其他指针没有太大区别，它只是指向一个更复杂的类型。

```
int foo[3];
int bar[3];
int (*vp)[3];
vp = &foo;
(*vp)[0] = 0; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-17T19:08:02.263

[在这个 URL](http://eli.thegreenplace.net/2008/07/18/reading-c-type-declarations/)上可以找到一篇关于阅读 C 类型声明的**优秀文章。**作者 Eli Bendersky 提供了一种阅读声明的简单方法。你从变量的名称开始，然后沿着你走的时候所遇到的发音的线移动。基本方法是从变量名开始往右走。我将提供一个简单的概述，但我强烈建议您阅读这篇文章。

1.  从变量名开始，向右走。
2.  如果您点击右括号`)`或分号`;`，则转回您开始向右移动的位置，然后向左移动。
3.  如果你在向右的时候遇到了一个左括号`(`，那么你遇到了一个*函数*声明，接下来是它的逗号分隔的参数列表。*注意*：您将在参数列表的末尾遇到一个右括号。上述规则不适用于此右括号。
4.  如果遇到左括号，请将其读作“数组”。
5.  向左后，当您击中左括号时`(`，然后返回您上次向右的右括号。跳过正确的括号，然后继续重复。
6.  [重复]

因此，在将此规则应用于您的特定问题时...

在声明中，“ `int * a[3];`”`a`是变量名。所以，它是这样读的：

> `a``[`是一个包含3 个元素 ( )的数组 ( )，其中包含指向整数 ( `[3]`) 的指针 ( )`*``int`

而在声明中，“ `int (* a)[3];`”`a`是变量名。所以，它是这样读的：

> `a`是一个指针 ( `*`)，指向`[`由 3`[3]`个整数 ( ) 组成的数组 ( `int`)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2020-01-08T07:52:18.077

`int *a[3]`: a 是一个由 3 个指向整数类型的指针组成的数组

`int (*a)[3]`: a 是一个指向 3 个整数类型数组的指针

# java - 重构用于测试的静态方法/静态字段

> ID：250137
> 
> 赞同：8
> 
> 时间：2008-10-30T13:15:55.350
> 
> 标签：java, testing, refactoring, static

我有以下遗留代码：

```
public class MyLegacyClass
{
    private static final String jndiName = "java:comp/env/jdbc/LegacyDataSource"

    public static SomeLegacyClass doSomeLegacyStuff(SomeOtherLegacyClass legacyObj)
    {
       // do stuff using jndiName
    }
} 
```

此类在 J2EE-Container 中工作。

现在我想测试容器外的类。

什么是最好的策略？基本上允许重构。

允许访问 LegacyDataSource（测试不必是“纯”单元测试）。

编辑：不允许引入额外的运行时框架。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T15:36:50.697

只是为了使@Robin 对策略模式的建议更加具体：（请注意，您原始问题的公共 API 保持不变。）

```
public class MyLegacyClass {

  private static Strategy strategy = new JNDIStrategy();

  public static SomeLegacyClass doSomeLegacyStuff(SomeOtherLegacyClass legacyObj) {
    // legacy logic
    SomeLegacyClass result = strategy.doSomeStuff(legacyObj);
    // more legacy logic
    return result;
  }

  static void setStrategy(Strategy strategy){
    MyLegacyClass.strategy = strategy;
  }

}

interface Strategy{
  public SomeLegacyClass doSomeStuff(SomeOtherLegacyClass legacyObj);
}

class JNDIStrategy implements Strategy {
  private static final String jndiName = "java:comp/env/jdbc/LegacyDataSource";

  public SomeLegacyClass doSomeStuff(SomeOtherLegacyClass legacyObj) {
    // do stuff using jndiName
  }
} 
```

...和 ​​JUnit 测试。我不太喜欢进行这种设置/拆卸维护，但这是拥有基于静态方法（或单例）的 API 的不幸副作用。我*喜欢*这个测试的地方是它不使用 JNDI - 这很好，因为 (a) 它会运行得很快，并且 (b) 单元测试应该只测试 doSomeLegacyStuff() 方法中的业务逻辑，而不是测试实际数据源。（顺便说一句，这假设测试类与 MyLegacyClass 在同一个包中。）

```
public class MyLegacyClassTest extends TestCase {

  private MockStrategy mockStrategy = new MockStrategy();

  protected void setUp() throws Exception {
    MyLegacyClass.setStrategy(mockStrategy);
  }

  protected void tearDown() throws Exception {
    // TODO, reset original strategy on MyLegacyClass...
  }

  public void testDoSomeLegacyStuff() {
    MyLegacyClass.doSomeLegacyStuff(..);
    assertTrue(..);
  }

  static class MockStrategy implements Strategy{

    public SomeLegacyClass doSomeStuff(SomeOtherLegacyClass legacyObj) {
      // mock behavior however you want, record state however
      // you'd like for test asserts.  Good frameworks like Mockito exist
      // to help create mocks
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T13:19:49.320

重构代码以使用依赖注入。然后使用您喜欢的 DI 框架（Spring、Guice、...）来注入您的资源。这将使运行时资源对象和策略之间的切换变得容易。

在这种情况下，您可以注入数据源。

编辑：根据您的新限制，您可以通过使用策略模式在运行时设置数据源来完成同样的事情。您可能只使用属性文件来区分创建和提供数据源的策略。这不需要新的框架，您只需手动编写相同的基本功能。在 Java EE 容器之外进行测试时，我们将这个确切的想法与 ServiceLocator 一起使用来提供模拟数据源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T14:05:45.607

我认为这里最好的解决方案是将 JNDI 绑定到本地

旧代码使用 jndiName ，如下所示：

```
DataSource datasource = (DataSource)initialContext.lookup(DATASOURCE_CONTEXT); 
```

因此，这里的解决方案是将本地（或您拥有的任何测试数据）绑定到这样的 JNDI 中：

```
 BasicDataSource dataSource = new BasicDataSource();
  dataSource.setDriverClassName(System.getProperty("driverClassName"));
  dataSource.setUser("username");
  dataSource.setPassword("password");
  dataSource.setServerName("localhost");
  dataSource.setPort(3306);
  dataSource.setDatabaseName("databasename"); 
```

然后绑定：

```
Context context = new InitialContext();
context.bind("java:comp/env/jdbc/LegacyDataSource",datasource); 
```

或者类似的，希望对你有帮助。

祝你好运！

# python - Lua 作为通用脚本语言？

> ID：250151
> 
> 赞同：37
> 
> 时间：2008-10-30T13:21:41.033
> 
> 标签：python, scripting, lua

当我看到 Lua 时，我唯一读过的就是“非常适合嵌入”、“快速”、“轻量级”，而且比其他任何东西都多：“魔兽世界”或简称“魔兽世界”。

为什么仅限于将整个事物嵌入到另一个应用程序中？为什么不像使用 Python 或 Perl 那样编写通用脚本呢？

Lua 似乎在速度和内存使用（最快的脚本语言 afaik）等方面做得很好，那么为什么我从来没有看到 Lua 被用作“桌面脚本语言”来自动化任务呢？例如：

*   重命名一堆文件
*   从网上下载一些文件
*   网页抓取

是缺少标准库吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-31T08:48:29.583

Lua 是一种很酷的语言，重量轻且速度极快！

但重点是：**性能对于你提到的那些任务那么重要吗？**

*   重命名一堆文件
*   从网上下载一些文件
*   网页抓取

你编写这些程序一次，运行一次，也可能。为什么你如此关心一次性程序的性能？

例如：

1.  编写一个C/C++程序需要3个小时，处理一次数据，程序运行需要1个小时。
2.  Cost 30 Minute 编写一个 Python 程序处理一次数据，程序运行需要 10 个小时。

如果您选择第一个，您可以节省运行程序的时间，但您会花费时间来开发程序。

另一方面，如果选择第二种，则浪费时间运行程序，但可以在程序运行时做其他事情。**玩魔兽世界，用你的术士杀怪怎么样？吃掉我的DOT**！:P

就是这样！虽然 Lua 写起来并不难，但 Lua 的一切设计都是为了高效。而且 Lua 的模块很少，但 Python 的模块却很多。你不想为 Lua 移植一个 C 库只是为了一个运行一次的程序，对吗？相反，选择 Python 并使用这些模块轻松完成您的任务可能是一个更好的主意。

仅供参考：实际上，我曾尝试使用 Lua 进行网页抓取，但最后，我意识到我不必太在意语言性能。**网页抓取的瓶颈不在于语言的性能**。瓶颈在于网络 I/O、HTML 解析和多任务处理。我所要做的就是确保程序正常工作并找到瓶颈。最后，我选择了 Python 而不是 Lua。有很多优秀的 Python 模块；我没有理由建立自己的。

根据我对网页抓取的经验，我选择 Twisted 进行网络 I/O 和 lxml 进行 html 解析作为我的网页抓取程序的后端。我写了一篇文章来介绍这项技术。

[从网站抓取数据的最佳选择：Python + Twisted + lxml](http://blog.ez2learn.com/2009/09/26/the-best-choice-to-grab-data-from-websites-python-twisted-lxml/)

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-31T14:40:55.890

Lua 的库比 Python 少。但一定要看看[LuaForge](http://luaforge.net/)。它有很多有趣的库，比如[LuaCURL](http://luaforge.net/projects/luacurl/)、[wxLua](http://wxlua.sourceforge.net/)或[getopt](http://luaforge.net/projects/getopt/)。

然后，访问[LuaRocks](http://luarocks.org/)，这是 Lua 的包管理系统。有了它，你可以搜索和安装最成熟的 Lua 模块和依赖。感觉就像[RubyGems](http://en.wikipedia.org/wiki/RubyGems)或[aptitude](http://en.wikipedia.org/wiki/Aptitude_(software))。

[lua-users.org](http://lua-users.org/)网站也有很多有趣的资源，比如教程或[Lua Wiki](http://lua-users.org/wiki)。

我喜欢 Lua 的不是它的速度，而是它最小的核心语言、灵活性和可扩展性。

也就是说，我可能会使用 Python 来完成您提到的任务，因为更大的社区在 Python 中做这些事情。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-30T13:24:26.830

仅仅因为它作为嵌入式脚本引擎的专用语言被“销售”（在某种意义上），并不意味着它仅限于此。事实上，WoW 也可以选择 Python 作为他们的嵌入式脚本语言。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-30T13:28:04.123

这可能是因为 Lua 被设计为一种脚本和扩展语言。在[官方网站上](http://www.lua.org/about.html)，它被描述为一种强大、快速、轻量级、可嵌入的脚本语言。没有什么能阻止你为它编写通用程序（如果我没记错的话，它附带解释器和编译器），但语言设计者打算将它主要用作嵌入式语言（因此是轻量级的）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-28T20:56:38.537

这是一个社会学问题，而不是编程问题。

我几乎完全将 Lua 用于通用脚本。但是我必须写几百行代码，这样 Lua 才能更好地使用 shell。这包括这样的技巧

*   引用一个字符串，以便 shell 将其视为一个单词
*   编写一个函数来捕获命令的输出，如 shell $(command)
*   使用 Lua posix 库编写一个函数来爬取文件系统并扩展 shell globbing 模式

（对于那些可能感兴趣的人，我将代码留在了我的[Lua drop box 中](http://www.cs.tufts.edu/~nr/drop/lua/)，其中还包含一些其他的东西。有趣的东西可能在`osutil`, `os.quote`, `os.runf`,`os.capture`和也许`os.execve`。通配符在[`posixutil.lua`](http://www.cs.tufts.edu/~nr/drop/lua/posixutil.lua). 他们都使用 Luiz Henrique de Figuereido 的[Lua Posix 库](http://www.tecgraf.puc-rio.br/~lhf/ftp/lua/)。）

对我来说，额外的努力是值得的，因为我可以处理简单的语法和出色的数据结构。对于其他人来说，与外壳更直接的连接可能是首选。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-30T19:13:31.023

绝对缺乏标准库。它也比 Python、Perl 或 Ruby 鲜为人知。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-20T08:31:28.220

最近有人推动在 Windows 上为 Lua 创建包含电池的安装。结果可以在 LuaForge的[Lua for Windows项目中找到。](http://luaforge.net/projects/luaforwindows/)它包括解释器和大量额外模块，允许开箱即用地编写和使用有用的脚本和应用程序。

我知道现在各种 Linux 发行版都包括 Lua 和一些模块，而且还会有更多。

邮件列表中还讨论了几个提议的模块库，但社区还没有确定一个作为“官方”机制。

我将 Lua 用作脚本语言和典型应用程序的“主”循环，由一个或多个包含在 C 中更好地实现的代码的 DLL 支持，或者包装特定项目所需的现有库或 API 函数。与诸如[IUP](https://sourceforge.net/projects/iup/)或[wxLua](http://wxlua.sourceforge.net/)（wxWindows 的 Lua 绑定）之类的 GUI 工具包一起使用，Lua 使编写中小型 GUI 应用程序变得非常愉快。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-31T14:15:15.100

我认为关于它作为“营销”事物的答案可能是正确的，同时缺乏大量可供选择的库。我想指出另一个例子：Ruby。Ruby 旨在成为一种通用脚本语言。问题是，自从 Ruby on Rails 变得如此流行以来，很难找到与 Rails 无关的东西。恐怕 Lua 也会遭受这种痛苦，因为一些主要的东西使用它而流行，但永远无法摆脱这种耻辱。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-16T08:56:51.820

缺乏标准库。时期。即使列出目录中的所有文件也需要[非标准模块](http://www.keplerproject.org/luafilesystem)。

这样做有充分的理由（保持严格的 ANSI 可移植性，不需要 POSIX），但结果是，对于一般编程，我更喜欢 Python。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-10-08T13:24:02.017

Lua 作为一种嵌入式语言用于TeX 扩展[LuaTeX](http://www.luatex.org/)中，并因此在 TeX 开发人员中迅速普及。它被用作 TeX Live 发行版中某些实用程序的脚本语言，只是因为现在有一个`luatex`二进制文件，可在所有平台上使用，它也可以用作 Lua 解释器（添加了一些重要模块——slnunicode、luafilesystem等）这对于 Windows 安装非常重要，它依赖于早期的其他 Unix 脚本工具（ActivePerl 等）。ConTeXt 宏语言现在广泛使用 Lua 脚本。

诚然，这是一个非常特殊的领域 :-) 但与游戏完全无关！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-23T11:32:02.087

为了使 Lua 易于嵌入，它必须具有很少的依赖项并且很小。这使得它不适合作为通用脚本语言。因为将其用作通用脚本语言将需要大量标准库。但是如果 Lua 有很多标准库，那么嵌入将更加困难（由于依赖项和内存占用。）

# asp.net - CrmImpersonator 和 IFD

> ID：250152
> 
> 赞同：0
> 
> 时间：2008-10-30T13:21:48.770
> 
> 标签：asp.net, dynamics-crm

我有一个 asp.net 页面，可以很好地用于对服务的内部调用，但是在面向外部的站点上使用时，我根本无法让它发挥作用。

CRMImpersonator 在内部访问时工作正常，但在使用 IFD 界面时，我得到的只是一条消息

```
'Microsoft.Crm.WebServices.Crm2007.CookieAndSoapHeaderAuthenticationProvider, Microsoft.Crm.WebServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' doesn't exist.
Parameter name: Microsoft.Crm.WebServices.Crm2007.CookieAndSoapHeaderAuthenticationProvider, Microsoft.Crm.WebServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.ArgumentException: 'Microsoft.Crm.WebServices.Crm2007.CookieAndSoapHeaderAuthenticationProvider, Microsoft.Crm.WebServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' doesn't exist.
Parameter name: Microsoft.Crm.WebServices.Crm2007.CookieAndSoapHeaderAuthenticationProvider, Microsoft.Crm.WebServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
```

任何想法将不胜感激我的代码如下

```
public string orgname;
public string crmurl;
public string metaurl;
public bool offline;

protected void Page_Load(object sender, EventArgs e)
{
    #region CRM URLs and Organization Name

    //Determine Offline State from Host Name
    if (Request.Url.Host.ToString() == "127.0.0.1")
    {
        #region offline
        offline = true;

        //Retrieve the Port and OrgName from the Registry
        //RegistryKey regkey = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\MSCRMClient");
        //orgname = regkey.GetValue("ClientAuthOrganizationName").ToString();
        string portnumber = regkey.GetValue("CassiniPort").ToString();

        //Construct the URLs
        string baseurl = "http://localhost:" + portnumber + "/mscrmservices/2007/";
        crmurl = baseurl + "crmservice.asmx";
        metaurl = baseurl + "metadataservice.asmx";
        #endregion
    }
    else
    {
        offline = false;

        //Retrieve the URLs from the Registry
        //RegistryKey regkey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\MSCRM");
        //string ServerUrl = regkey.GetValue("ServerUrl").ToString();
        string ServerUrl = "http://192.168.1.152:5555/MSCRMServices";
        crmurl = ServerUrl + "/2007/crmservice.asmx";
        metaurl = ServerUrl + "/2007/metadataservice.asmx";
        Response.Write("ServerURL " + ServerUrl + "<br>");
        Response.Write("CRMURL:   " + crmurl + "<br>");
        Response.Write("MetaURL:  " + metaurl + "<br>");

        //Retrieve the Query String from the current URL
        if (Request.QueryString["orgname"] == null)
        {
            orgname = string.Empty;
        }
        else
        {
            //Query String
            string orgquerystring = Request.QueryString["orgname"].ToString();
            if (string.IsNullOrEmpty(orgquerystring))
            {
                orgname = string.Empty;
            }
            else
            {
                orgname = orgquerystring;
            }

        }

        if (string.IsNullOrEmpty(orgname))
        {
            //Windows Auth URL
            if (Request.Url.Segments[2].TrimEnd('/').ToLower() == "isv")
            {
                orgname = Request.Url.Segments[1].TrimEnd('/').ToLower();
            }

            //IFD URL
            if (string.IsNullOrEmpty(orgname))
            {
                string url = Request.Url.ToString().ToLower();
                int start = url.IndexOf("://") + 3;
                orgname = url.Substring(start, url.IndexOf(".") - start);
            }
        }
        Response.Write(orgname + "<br>");
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-30T15:42:23.917

将 Microsoft.Crm.Webservices.dll 添加到 gac 解决了这个问题。

还需要使用以下 sql 来确保用户被模拟：

```
Execute as user =@username
Select * from FilteredActivityPointer;
revert 
```

# c# - 对象的成员是否应该在类中自动设置？

> ID：250157
> 
> 赞同：1
> 
> 时间：2008-10-30T13:24:11.637
> 
> 标签：c#, properties, constructor

当你有一个复杂的属性时，你应该实例化它还是让用户实例化它？

例如（C#）

一个）

```
 class Xyz{
     List<String> Names {get; set;}
 } 
```

当我尝试使用时，我必须设置它。

```
...
Xyz xyz = new Xyz();
xyz.Name = new List<String>();
xyz.Name.Add("foo");
... 
```

好像我在哪里修改代码

二）

```
 class Xyz{
     public Xyz(){
         Names = new List<String>();
     }
     List<String> Names {get; }
 } 
```

在这种情况下，我可以将 List 设为只读。

可能会出现另一种情况，我想你会故意不想设置它。例如在

C）

```
 class Xyz{
     String Name {get; set;}
 } 
```

我认为初始化是不好的做法。

这种情况有一些经验法则吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T13:38:23.603

根据经验（意味着该规则总会有例外）在构造函数中设置您的成员。这就是构造函数的用途。

请记住，OO 背后的思想之一是抽象。要求“用户”（即想要在其源代码中实例化您的对象的程序员）这样做违反了抽象原则。这将是用户在使用您的对象之前必须考虑的另一件事，因此又是一个潜在的错误来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T13:36:07.930

这是我的正常解决方案：

```
class XYZ 
{
   public XYZ () { Names = new List<string>(); }
   public List<string> Names { get; private set; }
} 
```

~~（请注意，它不适用于 XmlSerialization，因为您需要所有 XmlSerialized 属性上的 getter 和 setter。）（您可以覆盖它，但似乎工作量太大而付出的努力很小）。~~

正如[OregonGhost](https://stackoverflow.com/users/20363/oregonghost)指出的那样 - 您需要为此添加`[XmlArray]`才能与 XmlSerialization 一起使用。

这仍然违反了封装规则，就好像您想要完全正确一样，您将拥有：

```
class XYZ 
{
   public XYZ () { AllNames = new List<string>(); }
   private List<string> AllNames { get; set; }
   public void AddName ( string name ) { AllNames.Add(name); }
   public IEnumerable<string> Names { get { return AllNames.AsReadOnly(); } }
} 
```

由于这与 .Net 框架的几乎所有其余部分的设计背道而驰，因此我通常最终使用第一个解决方案。

但是，这确实具有额外的好处，即 XYZ 可以跟踪对其名称集合的更改，并且 XYZ 是唯一可以修改名称集合的地方。

我已经在少数情况下实现了这一点，但是当我为所有事情都这样做时，它会引起与其他程序员的太多摩擦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T13:39:14.320

是的，有经验法则。代码分析工具是一个好的开始。

关于您的代码的一些经验法则：

允许集合属性上的设置器是不好的做法。这是因为在代码中处理空集合就像处理完整集合一样简单。强迫人们对收藏品做空检查会让你被打败。考虑以下代码片段：

```
public bool IsValid(object input){
  foreach(var validator in this.Validators)
    if(!validator.IsValid(input)
      return false;
  return true;
} 
```

无论验证器集合是否为空，此代码都有效。如果您希望验证，请将验证器添加到集合中。如果没有，请将集合留空。简单的。允许集合属性为 null 会导致上面的这个臭代码版本：

```
public bool IsValid(object input){
  if(this.Validators == null) 
    return false;
  foreach(var validator in this.Validators)
    if(!validator.IsValid(input)
      return false;
  return true;
} 
```

更多的代码行，不那么优雅。

其次，对于集合以外的引用类型，在确定是否要设置属性值时，必须考虑对象的行为方式。该属性是否有一个单一的、明显的默认值？或者该属性的空值是否具有有效含义？

在您的示例中，您可能希望始终在设置器中检查 Name 值，并在分配 null 时将其设置为默认值“（未给出名称）”。当将此对象绑定到 UI 时，这可能会更容易。或者，该名称可能为空，因为您需要一个有效的名称，并且当调用者尝试在未先设置名称的情况下对对象执行操作时，您将检查它并抛出 InvalidOperationException。

就像编程中的大多数事情一样，有很多不同的方法可以做某事，其中一半是坏的，而另一半中的每一种方法都只在某些情况下是好的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T14:28:50.040

构造函数的目的是**构造**对象。不需要进一步的“设置”。如果调用者知道某些信息，则应将其传递给构造函数：

**错误的：**

```
MyClass myc = new MyClass();
myc.SomeProp = 5;
myc.DoSomething(); 
```

**正确的：**

```
MyClass myc = new MyClass(5);
myc.DoSomething(); 
```

如果需要设置 SomeProp 以使 myc 处于有效状态，则尤其如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T13:38:23.027

这真的取决于。

如果该类应该使用 null 属性正确运行，则可以将其保留为未初始化。否则，你最好在构造函数中初始化它。

而且，如果您不想在施工后更改该属性，您可以将其私有化

```
class Xyz
{
     public Xyz(string name)
     {
         this.Name = name;
     }
     String Name 
     {
          get; 
          private set;
     }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-07T16:22:47.027

如果可能，您应该尝试封装您的数据。将对象作为列表公开需要用户了解有关该类的太多私密细节。例如，他们必须知道是否必须从头开始创建列表以避免空引用异常。

```
public class Xyz
{
   private List<String> _names = new List<String>(); // could also set in constructor

   public IEnumerable<String> Names
   {
       get
       {
           return _names;
       }
   }

   public void AddName( string name )
   {
       _names.Add( name );
   }
} 
```

现在，使用 List、HashTable、Dictionary 等都没有关系。

# java - 尝试使用 java.exe -jar 运行我的 jar 时出现 NoClassDefFoundError ...怎么了？

> ID：250166
> 
> 赞同：68
> 
> 时间：2008-10-30T13:26:53.563
> 
> 标签：java, jar, classpath, executable-jar

我有一个应用程序，我正试图将其包装到一个 jar 中以便于部署。当作为可从 CLASSPATH 访问的一组类运行时，应用程序编译并运行良好（在 Windows cmd 窗口中）。但是当我打开我的类并尝试在同一个 cmd 窗口中使用 java 1.6 运行它时，我开始收到异常：

```
C:\dev\myapp\src\common\datagen>C:/apps/jdk1.6.0_07/bin/java.exe -classpath C:\myapp\libs\commons -logging-1.1.jar -server -jar DataGen.jar
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory
    at com.example.myapp.fomc.common.datagen.DataGenerationTest.<clinit>(Unknown Source)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.logging.LogFactory
    at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:276)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)
    ... 1 more 
```

有趣的是，有问题的 LogFactory 似乎在 commons-logging-1.1.jar 中，它位于指定的类路径中。jar 文件（是的，它确实存在）：

```
C:\dev\myapp\src\common\datagen>dir C:\myapp\libs\commons-logging-1.1.jar
 Volume in drive C is Local Disk
 Volume Serial Number is ECCD-A6A7

 Directory of C:\myapp\libs

12/11/2007  11:46 AM            52,915 commons-logging-1.1.jar
           1 File(s)         52,915 bytes
           0 Dir(s)  10,956,947,456 bytes free 
```

commons-logging-1.1.jar 文件的内容：

```
C:\dev\myapp\src\common\datagen>jar -tf C:\myapp\libs\commons-logging-1.1.jar
META-INF/
META-INF/MANIFEST.MF
org/
org/apache/
org/apache/commons/
org/apache/commons/logging/
org/apache/commons/logging/impl/
META-INF/LICENSE.txt
META-INF/NOTICE.txt
org/apache/commons/logging/Log.class
org/apache/commons/logging/LogConfigurationException.class
org/apache/commons/logging/LogFactory$1.class
org/apache/commons/logging/LogFactory$2.class
org/apache/commons/logging/LogFactory$3.class
org/apache/commons/logging/LogFactory$4.class
org/apache/commons/logging/LogFactory$5.class
org/apache/commons/logging/LogFactory.class
... (more classes in commons-logging-1.1 ...) 
```

是的，commons-logging 有 LogFactory 类。最后，我的 jar 清单的内容：

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.6.5
Created-By: 10.0-b23 (Sun Microsystems Inc.)
Main-Class: com.example.myapp.fomc.common.datagen.DataGenerationTest
Class-Path: commons-logging-1.1.jar commons-lang.jar antlr.jar toplink
 .jar GroboTestingJUnit-1.2.1-core.jar junit.jar 
```

这让我和我已经烦扰了一天多的任何同事都感到难过。只是为了挑选答案，至少目前，由于许可限制和公司政策（例如：用于创建 exe 或打包 jar 的工具），第三方解决方案可能已经出现。最终目标是创建一个 jar，它可以从我的开发 Windows 机器复制到 Linux 服务器（带有任何依赖的 jar）并用于填充数据库（因此类路径可能最终在开发和部署环境之间有所不同）。任何有关此谜团的线索将不胜感激！

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-30T13:29:27.740

-jar 选项与 -classpath 互斥。[在此处](http://download.java.net/jdk8u20/docs/technotes/tools/windows/java.html)查看旧描述

> -罐
> 
> 执行封装在 JAR 文件中的程序。第一个参数是 JAR 文件的名称，而不是启动类名称。为了使此选项起作用，JAR 文件的清单必须包含格式为 Main-Class: classname 的行。在这里，classname 标识具有用作应用程序起点的 public static void main(String[] args) 方法的类。
> 
> 有关使用 Jar 文件和 Jar 文件清单的信息，请参阅 Jar 工具参考页面和 Java 教程的 Jar 跟踪。
> 
> ***使用此选项时，JAR 文件是所有用户类的来源，其他用户类路径设置将被忽略。***

一个快速而肮脏的技巧是将您的类路径附加到引导类路径：

> -Xbootclasspath/a：***路径***
> 
> 指定以冒号分隔的directires、JAR 归档和ZIP 归档路径以附加到默认引导类路径。

但是，正如[@Dan](https://stackoverflow.com/users/5171/dan-dyer)所说，正确的解决方案是确保您的 JAR 清单包含它需要的所有 JAR 的类路径。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-01-12T16:18:34.667

您可以省略该`-jar`选项并像这样启动 jar 文件：

`java -cp MyJar.jar;C:\externalJars\* mainpackage.MyMainClass`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-09-05T13:46:51.510

这是正在发生的问题，

如果 JAR 文件是从“C:\java\apps\appli.jar”加载的，并且您的清单文件具有 Class-Path: 引用“lib/other.jar”，则类加载器将在“C:\java \apps\lib\" 用于“other.jar”。它不会查看 JAR 文件条目“lib/other.jar”。

**解决方案：-**

1.  右键单击项目，选择导出。
2.  选择 Java 文件夹并在其中选择 Runnable JAR File 而不是 JAR 文件。
3.  选择适当的选项并在库处理部分选择第三个选项，即（将所需的库复制到生成的 JAR 旁边的子文件夹中）。

*[ **EDIT** = 3rd 选项除了 jar 之外还生成一个文件夹，2nd 选项（“将所需的库打包到生成的 JAR”）也可以在您拥有 jar 时使用。]*

4.  单击完成，您的 JAR 将在指定位置创建，并创建一个包含清单文件中提到的 JARS 的文件夹。
5.  打开终端，为您的 jar 提供正确的路径并使用此命令运行它 java -jar abc.jar

    现在将会发生的是类加载器将在正确的文件夹中查找引用的 JARS，因为现在它们存在于包含您的应用程序 JAR 的同一文件夹中。现在没有抛出“java.lang.NoClassDefFoundError”异常。

这对我有用......希望它也对你有用！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-30T14:11:28.997

如果您在程序中使用外部库并尝试将所有内容打包到一个 jar 文件中，那么由于类路径问题等原因，这并不是那么简单。

我更喜欢使用[OneJar](http://one-jar.sourceforge.net/)来解决这个问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-19T10:16:17.473

我的罐子也有同样的问题

1.  创建 MANIFEST.MF 文件：

> 清单版本：1.0
> 
> 密封：真实
> 
> 类路径：. lib/jarX1.jar lib/jarX2.jar lib/jarX3.jar
> 
> 主类：com.MainClass

2.  右键单击项目，选择导出。

> 选择导出检查项目的所有输出文件夹

3.  选择使用工作区中的现有清单并选择 MANIFEST.MF 文件

这对我有用:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-12T21:55:36.537

我发现当我使用清单时，类路径的 jar 列表需要在每个 jar 列表之后有一个空格，例如“required_lib/sun/pop3.jar required_lib/sun/smtp.jar”。即使它是列表中的最后一个。

# .net - 编写我自己的自动更新程序

> ID：250175
> 
> 赞同：29
> 
> 时间：2008-10-30T13:30:32.700
> 
> 标签：.net, auto-update, updating

在编写我自己的自动更新程序时，是否有一个我应该遵循的通用框架？

不久前，我正在阅读如何创建一个“引导程序”，该程序将在主应用程序之前首先加载（因为由于文件锁定等原因无法更新正在运行的应用程序）

那么有什么提示/最佳实践吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-30T14:29:05.903

您可能必须自己编写。如前所述，基本思想是将您的程序的最新版本（我假设一个 EXE）放在服务器上，然后让您的应用程序在启动时与服务器检查，如果它是从服务器下载 EXE较新的版本。

我通常将其实现为应用程序在启动时调用的 Web 服务。关于这种方法的几个警告：

1.  Web服务方法需要获取服务器上EXE的版本号，并与调用者的版本号进行比较。如果您使用 Assembly 类来读取服务器 EXE 的版本号，只要 Web 服务实例正在运行（至少 20 分钟），这将锁定文件。因此，您有时可能无法用较新版本替换服务器上的 EXE。请改用 AssemblyName 类 - 这允许您在不加载程序集（并锁定它）的情况下读取程序集信息。

2.  调用者应用程序不能用新版本替换它自己的文件——你不能删除或更新正在运行的应用程序文件。然而，它*可以*做的是在运行时重命名自己的文件。所以自动更新的技巧是应用程序重命名自己（例如“MyApplication.exe”到“MyApplication_OLD.exe”），将新版本下载到应用程序文件夹（名为“MyApplication.exe”），通知用户发生需要重新启动应用程序的更新，然后结束。当用户重新启动应用程序时，将启动较新的版本 - 此版本会检查并删除旧版本。

在这样的更新之后自动重启应用程序的自动更新是非常棘手的（它涉及启动另一个进程，然后在自动重启进程启动之前结束它自己的进程）。我从来没有用户抱怨必须重新启动应用程序。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-30T13:41:10.400

好的，首先，如果市场上的安装程序/更新程序产品满足您的需求，您可能应该使用这些产品。话虽如此，不久前我有幸自己构建了这样的系统。是的，我们的安装程序/更新程序在客户端包括两个部分，因此：

~ A 部分将连接到存储和发布最新版本的服务器；如果有更新版本的 B 部分可用，它将下载并启动它

~ B 部分将专注于安装/更新实际应用程序（并且可以下载和安装 A 部分的更新）。

除此之外，我建议始终在安装程序/更新程序中考虑以下 4 个操作：

*   安装和卸载

*   更新和回滚（即撤消上次更新）

当您的用户拥有一个可以在一夜之间自动更新的系统时，回滚是至关重要的。如果每次更新都搞砸了，他们可以在您解决问题时回滚并继续工作。

最后，安装程序/更新程序应尝试对其安装/更新的应用程序不可知论，以便当该应用程序更改时，安装程​​序/更新程序系统受到的影响尽可能小。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-30T14:06:47.383

我为我使用 C++ 开发的应用程序编写了一个更新程序，但总体结构是相同的。

1.  应用检查版本号或其他标识符更改的 URL
2.  应用程序从网络中 拉下*新的更新程序应用程序*
3.  应用程序运行*新的*更新程序应用程序（其中可能包括更新过程中不可预见的更改的代码），然后应用程序退出
4.  新的更新程序等待应用程序退出，然后下载并安装新的“东西”等。

这对我们来说效果很好，因为它总是首先下载一个新的“更新程序”，所以我们可以处理一些可能无法正常工作的时髦新事物。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-14T15:27:15.687

编写了我们自己的自动更新软件。所以这是我的建议......不要这样做！当然，这一切都取决于您的具体情况，但以下是我公司遇到的问题：

*   难以持续支持，特别是如果您将 Win2k 定位到 Windows 7。
*   有权限的挑战。WinVista/7 UAC 可能是一个真正的痛苦。
*   灵活性是一项要求，但您无法预见所有问题。例如，启动/停止服务、启动文件等都是您可能想要为自动更新执行的任务，但您不一定能预见到。

我们软件的问题在于，我们需要在所有 Windows 平台上提供很大的灵活性和支持。我们编写的解决方案运行良好，但是当 Windows 版本发生变化或与我们实验室中的版本不太一样时，它无法扩展并开始失败。我们最终购买了软件，我建议您也这样做。如果您有兴趣，我们购买了一个名为 AutoUpdate+ 的产品（[链接文本](http://AutoUpdatePlus.com "自动更新+")）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-24T22:44:14.593

这是我为解决我们对 WinForms 和 WPF 应用程序的特定需求而编写的一个开源解决方案。总体思路是以尽可能低的开销获得最大的灵活性。

因此，**集成**非常简单，该库几乎可以为您完成所有工作，包括同步操作。它也**非常灵活**，可以让您确定要执行哪些任务以及在什么条件下执行 - 您制定规则（或使用一些已经存在的规则）。最后一点是对**任何更新源**（网络、BitTorrent 等）和任何**提要格式**的支持——任何未实现的内容您都可以自己编写。

还支持冷更新（需要重新启动应用程序），并且会自动完成，除非为任务指定“热交换”。

这归结为一个 DLL，大小不到 70kb。

更多详情请访问[http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/](http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/)

代码位于[http://github.com/synhershko/NAppUpdate](http://github.com/synhershko/NAppUpdate)（在 Apache 2.0 许可下获得许可）

当我有更多时间时，我计划进一步扩展它，但老实说，你应该能够自己快速增强它，以应对它目前不支持的任何东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-30T13:58:38.850

ClickOnce 对我们来说效果不佳。我们将数据库安装在客户的服务器上。在我们进行更新之前，他们的数据库需要更新。我们的客户不止 2 或 3 个，因此为我们的应用程序执行 ClickOnce 并不是最好的主意，除非我遗漏了有关 ClickOnce 的一些重要内容。

我所做的是向数据库中添加一个字段以获取版本号。在我们的 ftp 站点上，我有一个版本文件夹，其中包含我们应用程序的每个版本号的文件夹。在该特定版本的文件夹中，我们放置了一个 zip 文件，其中包含 setup.exe 和 setup.exe 将启动的 msi 文件。所有的先决条件都是从供应商站点下载的，以确保我们的 FTP 站点不会受到大量下载的影响（当我们迁移到 .Net 3.5 时）。当我们的应用程序启动时，它会检查数据库中的版本号字段，如果它与当前版本的程序集版本不同，它将连接到 ftp 站点，从新版本的文件夹下载 zip 文件，解压缩，然后执行设置。这将安装较新版本的 .Net 或我们可能添加的任何其他要求，

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-30T13:40:16.330

如果您使用的是 .Net，为什么不直接使用 ClickOnce？它将完成您所说的所有开箱即用的操作，并且几乎需要零设置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-03T04:30:21.810

此 zip 包含单词搜索生成器工具的源代码，其中包括 AppUpdater 样板代码。
[http://cid-842434ebe9688900.skydrive.live.com/self.aspx/Games/WordSearchGenerator-src-v1.3.zip](http://cid-842434ebe9688900.skydrive.live.com/self.aspx/Games/WordSearchGenerator-src-v1.3.zip)

查找名称中包含“AppUpdater”的 3 个源模块。

它非常简单，仅适用于单组件应用程序。没有 MSI 文件。只是一个EXE。理念是更新检查会自动发生，但只有在用户确认后才会安装更新。

更新程序的工作方式：

它从包含“最新版本”信息的 URL 以及实际新版本所在的第二个 URL 加载 XML 文档。更新程序逻辑会验证 XML 文档上的签名，但您可能并不关心这一点。然后更新程序将当前版本与最新版本进行比较，并且可以告诉应用程序是否有可用更新。更新程序还处理就地替换问题。

在此模型中，应用程序在更新期间存在三个“生命周期阶段”。在正常过程中，应用程序会检查更新，然后正常运行。在某些时候，用户可能会确认他们想要安装可用的更新，并且更新程序将应用程序下载到一个临时位置，然后使用新下载的 exe 启动一个进程。然后更新程序逻辑退出第一个进程。第二个进程，根据第一个进程给它的命令行参数，意识到它是一个新下载的副本，需要复制自己。它将自己复制到原始位置（在命令行上指定），*开始*exe，然后退出。第三个进程正常启动，看到有更新，然后删除临时 exe 副本。然后它会正常运行，包括检查更新。它会发现没有更新，然后会正常运行。这涵盖了就地更新逻辑的操作。

这一切都由 Windows 窗体或 WPF 窗口的构造函数中的这些行处理：

```
 _Updater = new AppUpdater.SimpleAppUpdater(_MyManifestUrl);
  _Updater.Startup(App.CommandLineArgs); 
```

检查更新问题也由构造函数中的几行代码处理，它们创建并运行后台工作线程：

```
 _Worker = new System.ComponentModel.BackgroundWorker();
  _Worker.DoWork += CheckLatest;
  _Worker.RunWorkerCompleted += CheckCompleted;
  _Worker.RunWorkerAsync(); 
```

CheckLatest 是这样的：

```
 void CheckLatest(object sender, System.ComponentModel.DoWorkEventArgs e)
    {
        lock (_Updater)
        {
            if (_Updater.UpdateIsAvailable) // Checks for update
            {
                // can update a textbox (etc) here.  Be careful of InvokeRequired.
            }
        }
    } 
```

完成的事件是这样的：

```
void CheckCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
{
    if (!e.Cancelled && e.Error == null)
    {
        lock (_Updater)
        {
            // only display the about box if there is an update available.
            if (_Updater.HaveCheckedForUpdate && _Updater.UpdateIsAvailable)
            {
                // do whatever you want here.  Eg, pop a dialog saying 
                // "an update is available"
                About about = new About();
                about.Message= "An update is available";
                about.ShowDialog();
            }
        }
    }
} 
```

它适用于 WinForms 或 WPF 应用程序。我想它也适用于控制台应用程序，但我从未尝试过。

创建（可能已签名的）清单文件是一项单独的任务，此处未介绍。

考虑一下，这可能更好地打包为基类 AutoUpdatingForm（用于 WinForms）或 AutoUpdatingWindow（用于 WPF）。但我从来没有迈出那一步。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T13:35:23.983

十年前，我写了一个自动更新程序（不是在 .NET 中），但它的要点是应用程序有一个在启动时检查的版本 ID。在这种情况下，应用程序会查询具有当前版本的数据库表，如果运行版本低于当前版本，则会提示用户下载最新版本。通过检查 URL 可以完成同样的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-11T11:24:12.507

我尚未尝试的解决方案之一是拥有一个可以在静默模式下运行的安装程序。

应用程序调用服务器，如果需要更新，它会下载最后一个安装程序，然后使用静默或更新标志运行它。

它有很多好处：

*   灵活性：您可以为正常安装做任何事情
*   没有额外的包：安装程序和更新是一回事
*   如果您卸载然后重新安装，您可以处理回滚
*   更新是一个单独的过程，因此它可以在安装完成后启动应用程序
*   你有工具来处理 vista UAC

# version-control - 现有开源项目实施的源代码控制/管理

> ID：250189
> 
> 赞同：3
> 
> 时间：2008-10-30T13:34:48.103
> 
> 标签：version-control, open-source

我目前正在测试服务器上安装和配置一个开源项目。我受过良好的源代码管理培训，我想确保我所做的一切都得到妥善管理（对于我，唯一的开发/管理员，以及未来的维护者）。开源项目可作为源代码下载或通过 svn checkout 获得。

我想拥有自己的项目源代码控制版本。我不打算过多地更改（java servlet）代码（如果有的话），但是我肯定希望对所有涉及的配置、XML 文件、XSL、CSS 等进行源代码控制。

我应该继续做我自己的所有源代码的本地存储库吗？我应该尝试只控制我需要更改的文件吗？在这种情况下，我希望目录结构匹配，所以我可以直接对构建目录进行检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T13:49:50.413

我会检查所有代码，因为即使您不想更改它们或现在看不到理由，其他人稍后可能会看到原因。此外，可能存在错误，或简单的重构以提高可维护性或性能等。

SVN 的基本布局是：

```
branches/
tags/
trunk/ 
```

并且一般目录布局（在这三个之下）当然应该与您的应用程序相匹配，以便您可以检查它并立即运行它。但是，您可以通过构建文件等进行轻微修改。但我想*checkout and go*总是很好。有关更多信息或最佳实践的建议，我会查看使用您的技术的其他开源项目。

至于配置文件 - 我不会签入。大多数项目都会签入一个`foo-dist`向用户显示所有配置选项的文件。至少，他们需要复制`foo-dist`到`foo`以启用默认配置。

此外，您是否查看过用于项目托管（包括版本控制）的[Google Code](http://code.google.com)、[Sourceforge](http://sf.net)或[github ？](http://github.com)所有这三个都免费为您提供大量服务-在您无需为项目托管等服务的服务器方面也是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T13:53:43.480

对同一个目录树进行两次签出是行不通的。如果您检查您的源代码，并尝试检查 OSS 项目源代码，那么它们的任何共同目录都会失败，说它已经是另一个项目的工作目录。

如果你可以将css、xml、xsl等文件集中到一个公共目录中，你可以将它们放在你自己项目的svn中的一个目录中，然后将它们检出到OSS项目的工作目录中的一个目录中。

**~/Working => svn://samhoice/project/trunk**

**~/Working/osscomponent => svn://osshost/project/latesttag**

**~/working/osscomponent/config => svn://samhoice/project/trunk/config**

在这种结构中，samhoice 的 svn 存储库中不存在 osscomponent 目录。它由您的安装脚本添加为 OSS 项目的工作目录根目录。config 目录没有从 OSS 项目中检出，也不存在。config 目录由您的安装脚本创建，并且 config 目录从您的项目存储库中签出。

所以在这个目录结构中你有三个结帐。没有递归重叠，因此任何子目录上的 svn 映射之间都没有冲突。

如果您需要将配置文件安排在 OSS 项目的结构中，请在您的 makefile 或配置脚本中添加一些符号链接。您也可以在 svn 客户端的结帐后挂钩中执行此操作。

我在我的一个项目中使用了这样的结构，用于在两个项目树之间共享一些代码。共享内容位于我为您的配置部分推荐的子树中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T22:56:43.477

我使用了几种方法，具体取决于第 3 方项目的大小和定制量：

*   **对于小型或高度定制的项目**，我将从股票代码开始检查整个项目。这使得整个项目的工作变得容易，并提供“一站式购物”来检查我构建它所需的一切。

*   **对于大型或略微定制的项目**，我会保留一份库存档案的副本（通常是一个`.tar.bz2`或`.zip`文件）并确保它已备份。然后，我将以某种形式将体现我的定制的文件置于修订控制之下。这里的选项是

    *   （仅）签入自定义文件本身。如果您正在修改源代码，这通常是最佳选择。

    *   签入执行自定义的脚本。如果脚本向配置实用程序提供输入，这是最有效的，因为您将自定义（输入数据）与库存件（配置实用程序）分开存储。如果发布了第 3 方库的新版本，通常很容易将您的自定义应用到它，从而允许进行关键升级。

*   **对于“永远不会改变™”的项目，**或者客户通过**合同将您绑定到特定版本的项目，**请将库存代码存储在某处，并在修订控制下创建补丁文件。然后，您可以发布带有补丁的“已批准”版本。 *注意：这是一个相当糟糕的选择，因为补丁文件很难维护——如果你制作了一个新补丁，你必须要么重新创建补丁文件，要么创建一个额外的补丁，应用在第一个补丁之上。选择此选项的原因通常不是出于技术原因而选择的。*

我怎么强调都不够，**你需要记录构建此类项目和添加自定义项的整个过程，或者自动化它，或者（最好）两者兼而有之。** 忘记哪些文件属于哪里或属于谁非常容易，而且重新开始很痛苦。特别是如果你是继承人。

祝你好运！

# c# - c#中的整数数学

> ID：250191
> 
> 赞同：9
> 
> 时间：2008-10-30T13:35:03.580
> 
> 标签：c#, math, casting, rounding

我有一个产品品牌菜单，我想分成 4 列。因此，如果我有 39 个品牌，那么我希望每列的最大项目数为 10（最后一列有一个空白。这是我计算列的项目数的方法（使用 C#）：

```
int ItemCount = Convert.ToInt32(Math.Ceiling(Convert.ToDecimal(BrandCount) / 4m)); 
```

所有这些转换对我来说似乎真的很难看。有没有更好的方法在 C# 中对整数进行数学运算？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-30T13:39:46.127

你可以投：

```
int ItemCount = (int) Math.Ceiling( (decimal)BrandCount / 4m ); 
```

此外，因为`int`/`decimal`导致 a`decimal`您可以删除其中一个演员表：

```
int ItemCount = (int) Math.Ceiling( BrandCount / 4m ); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-30T14:02:53.133

为什么你甚至使用小数？

```
int ItemCount = (BrandCount+3)/4; 
```

`+3`确保您向上而不是向下取整：

```
(37+3)/4 == 40/4 == 10
(38+3)/4 == 41/4 == 10
(39+3)/4 == 42/4 == 10
(40+3)/4 == 43/4 == 10 
```

一般来说：

```
public uint DivUp(uint num, uint denom)
{
    return (num + denom - 1) / denom;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-30T13:39:45.550

Mod的更长选择。

```
ItemCount = BrandCount / 4;
if (BrandCount%4 > 0) ItemCount++; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T13:41:35.470

也许尝试这样的事情......假设`BrandCount`是一个整数。您仍然有相同的演员表，但可能更清楚：

```
int ItemCount = (int)(Math.Ceiling(BrandCount / 4m)); 
```

我不是这门课的忠实粉丝`Convert`，我尽可能避免它。它似乎总是让我的代码难以辨认。

# xslt - 使用 stringparam 的 xsltproc 命令行参数

> ID：250197
> 
> 赞同：19
> 
> 时间：2008-10-30T13:38:11.013
> 
> 标签：xslt

我正在尝试编写一个样式表，给定一个 XML 输入（显然）和一个指定“目标”的参数，它将生成与该目标匹配的命令列表。这是编写的样式表：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:param name="target" select="cora_cmd"/>
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="command/program">
    <xsl:if test="@name=$target">
      <xsl:message terminate="no">found match <xsl:value-of select="$target"/>   </xsl:message>
      <xi:include xmlns:xi="http://www.w3.org/2003/XInclude">
        <xsl:attribute name="href"><xsl:value-of select="../@help"/></xsl:attribute>
      </xi:include>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

我正在调用 xsltproc 来执行此样式表，如下所示：

```
xsltproc --param target cora_cmd gen-commands.xsl commands.xml 
```

我遇到的问题是目标的参数值似乎没有设置。至少来自消息的名称似乎是一个空字符串，并且 xsl:if 的测试总是失败。我确信这是由于我的一些愚蠢的错误，但我还没有意识到这一点。有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-30T14:28:39.837

如果我正确理解了这个问题，我认为您需要使用“stringparam”作为调用 xsltproc 的选项，假设您传递的是要匹配的字符串值，而不是 XPath 表达式。

```
xsltproc --stringparam target cora_cmd gen-commands.xsl commands.xml 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-03T16:12:37.203

在样式表中声明 'target' 参数时，`@select`如果您希望它在命令行上未使用参数时用作默认值，则应引用该值：

```
<xsl:param name="target" select="'cora_cmd'"/> 
```

# wcf - 在 Windows 服务中托管 WCF 服务

> ID：250207
> 
> 赞同：5
> 
> 时间：2008-10-30T13:40:07.890
> 
> 标签：wcf, service

如何在windows服务中托管WCF服务？

谢谢塞卡

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T13:51:09.897

我认为这篇文章很好地涵盖了所需的步骤： [WCF Link](http://msdn.microsoft.com/en-us/library/ms733069.aspx)

总结一下：

*   首先，您需要创建一个“Windows 服务”类型的新 Visual Studio 项目。
*   接下来为了能够安装服务，您还需要编写一个如下形式的安装程序类：

.

```
 [RunInstaller(true)]
 public class ProjectInstaller : Installer
 {
 } 
```

*   将 WCF 类添加到项目中，在 Windows 服务的 OnStart 和 OnStop 事件中，您必须显式启动 WCF 服务。

*   在 Visual Studio 命令提示符下，您可以使用以下命令安装服务

.

```
installutil myservicename.exe 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T13:50:27.340

我今天刚刚在第 9 频道看到这个：

[http://channel9.msdn.com/shows/Endpoint/endpointtv-Screencast-Hosting-WCF-Services-in-Windows-Services/](http://channel9.msdn.com/shows/Endpoint/endpointtv-Screencast-Hosting-WCF-Services-in-Windows-Services/)

# python - 如何优化此 Google App Engine 代码？

> ID：250209
> 
> 赞同：5
> 
> 时间：2008-10-30T13:40:19.480
> 
> 标签：python, google-app-engine, optimization

我对 Python 世界比较陌生，但这似乎很简单。

谷歌对我大喊，这段代码需要优化：

```
class AddLinks(webapp.RequestHandler):
     def post(self):
          # Hash the textarea input to generate pseudo-unique value
          hash = md5.new(self.request.get('links')).hexdigest()

          # Seperate the input by line
          allLinks = self.request.get('links').splitlines()

          # For each line in the input, add to the database
          for x in allLinks:
               newGroup = LinkGrouping()
               newGroup.reference = hash
               newGroup.link = x
               newGroup.put()

          # testing vs live
          #baseURL = 'http://localhost:8080'
          baseURL = 'http://linkabyss.appspot.com'

          # Build template parameters
          template_values = {
               'all_links': allLinks,
               'base_url': baseURL,
               'reference': hash,
          }

          # Output the template
          path = os.path.join(os.path.dirname(__file__), 'addLinks.html')
          self.response.out.write(template.render(path, template_values)) 
```

仪表板告诉我这正在使用大量 CPU。

我应该在哪里寻找改进？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T14:41:19.420

这里的主要开销是对数据存储的多个单独放置。如果可以，请按照 Andre 的建议将链接存储为单个实体。您始终可以将链接拆分为数组并将其存储在 ListProperty 中。

如果您确实需要每个链接的实体，请尝试以下操作：

```
# For each line in the input, add to the database
groups = []
for x in allLinks:
     newGroup = LinkGrouping()
     newGroup.reference = hash
     newGroup.link = x
     groups.append(newGroup)
db.put(groups) 
```

它将数据存储往返次数减少到一次，而真正扼杀高 CPU 上限的是往返次数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T14:13:15.717

对我来说看起来很紧。

我看到一件事可能会有所改善。你的电话，“self.request.get('links')”两次。

所以添加：

```
unsplitlinks = self.request.get('links') 
```

引用“未拆分链接”可能会有所帮助。

除此之外，循环是我看到的唯一可以作为优化目标的区域。是否可以准备数据然后立即将其添加到数据库中，而不是为每个链接添加数据库？（我假设 .put() 命令将链接添加到数据库）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:22:26.557

`self.request.get('links')`只需将完整内容存储在数据库的文本字段中，就可以显着减少应用程序和数据库之间的交互。

*   `put()`每人只有一个`post(self)`
*   哈希没有存储 n 次（对于每个链接，这没有意义，真的是浪费空间）

当有人实际调用该页面时，您可以节省对文本字段的解析......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:21:41.130

这多久被调用一次？这看起来还不错……尤其是在删除重复请求之后。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:58:50.977

我可以查询 ListProperty 吗？

就像是

```
SELECT * FROM LinkGrouping WHERE links.contains('http://www.google.com') 
```

我有未来需要该功能的计划。

我肯定会实现单个 db.put() 以减少使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T10:25:38.040

不/你不能使用像“links.contains(' [http://www.google.com](http://www.google.com) ')”这样的东西 GQL 不支持这个

# file - 检查 LAN 环境并取消检查

> ID：250214
> 
> 赞同：1
> 
> 时间：2008-10-30T13:42:47.683
> 
> 标签：file, vba, networking, path

我正在更新一个 VBA 程序（excel）。在启动时，程序检查它是否可以使用以下命令找到办公室文件服务器上的目录：

```
FileSystemObject.FolderExists("\\servername\path") 
```

如果没有找到，程序切换到离线模式并将其输出保存到本地硬盘（供以后传输），而不是直接保存到文件服务器。

这工作正常，如果计算机可以到达路径，它会非常快，但是有时可能需要一段时间（最多一分钟）才能完成对 FolderExists 的调用/超时，特别是如果有网络连接打开但所需路径不存在（即我们连接到其他 LAN）。

我的问题：

1.  有没有更快/更好的方法来检查是否存在使用 VBA 的网络路径？

2.  有没有办法让用户取消 FolderExists() 完成的搜索，因为他知道它不能成功，因为他们不在办公室。即是否有某种方法可以过早退出 FolderExists() （或任何其他函数调用）

我希望解决方案的用户输入尽可能少，这就是为什么检查会自动完成，而不是首先询问用户他是否在办公室。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T13:47:28.203

**如果您在域上：**

检查 LOGONSERVER 环境变量。

如果服务器名称前有两个“\”符号，则它已连接到活动目录，因此您应该进行检查。

否则，它没有登录到办公网络，因此您可以绕过检查。

**如果您不在域中：**

最好的选择可能是对目标服务器运行 ping。

如果它无法获得 ping 响应，则它要么未连接到网络，要么未连接到您的网络，或者服务器已关闭。在这些情况下，您不希望您的代码以任何一种方式运行。

[MVPS.ORG](http://vbnet.mvps.org/index.html?code/internet/ping.htm)和[MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/9a509391-f4e2-4ea7-827a-3370aa203bfb/)都有一些代码示例，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T07:47:09.117

我使用`Dir`命令，定位服务器上的共享文件夹并在找不到时捕获错误。

```
Dir("\\Servername\aFolder\", vbDirectory) 
```

# javascript - 用户登录前的弹窗检测

> ID：250216
> 
> 赞同：6
> 
> 时间：2008-10-30T13:44:21.440
> 
> 标签：javascript, browser, popup

有没有一种好方法可以确定一个人是否启用了弹出窗口阻止程序？我需要维护一个 Web 应用程序，不幸的是它有大量的弹出窗口，我需要检查用户是否启用了弹出窗口阻止程序。

我发现这样做的唯一方法是从 javascript 打开一个窗口，检查它是否打开以确定是否启用了阻止程序，然后立即将其关闭。

这有点烦人，因为没有启用它的用户会在窗口立即打开和关闭时在屏幕上看到一个小闪烁。

有没有其他非侵入性的方法来实现这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T14:02:57.377

阅读[使用 Javascript 检测弹出窗口阻止程序](http://www.visitor-stats.com/articles/detect-popup-blocker.php)：

基本上，您检查“window.open”方法是否返回新打开窗口的句柄。

看起来像这样：

```
var mine = window.open('','','width=1,height=1,left=0,top=0,scrollbars=no');
if(mine)
    var popUpsBlocked = false
else
    var popUpsBlocked = true
mine.close() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T15:53:41.803

正如其他人所说，您必须尝试并查看，但检查生成的窗口对象是否非“虚假”对于所有浏览器来说都是不够的。

当弹出窗口被阻止时， Opera 仍然返回一个`Window`对象，因此您必须充分检查该对象以确定它是否是一个真实的窗口：

```
var popup = window.open(/* ... */);
var popupBlocked = (!popup || typeof popup.document.getElementById == "undefined"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:33:36.160

正如其他人所评论的那样，确定答案的唯一方法就是尝试一下。

但是，对于“是否安装了弹出窗口阻止程序”这个问题，一个很好的近似答案是，这些天，“是”。默认情况下，所有最近的浏览器都会阻止您的弹出窗口，因此您最好设计您的应用程序以优雅地应对这一点。也就是说，除了对用户交互（通常是 onclick）的反应之外，不要尝试 window.open ，你会没事的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T13:57:40.053

我认为没有任何方法可以在不尝试打开窗口的情况下检测到这一点，因为弹出窗口阻止程序不会添加任何可以在 JS 中查询的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:40:53.993

响应用户操作（例如单击链接）而打开的弹出窗口不应被弹出窗口阻止程序阻止。

# associations - IT经理/程序员有什么好的专业协会吗？

> ID：250218
> 
> 赞同：7
> 
> 时间：2008-10-30T13:44:58.490
> 
> 标签：associations

是否有任何适合 IT 经理的专业协会，我可以加入并与其他经理建立联系以分享想法和信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-30T13:59:14.700

[IEEE 计算机学会](http://www.computer.org/portal/site/ieeecs/index.jsp)和[信息技术专业人员协会](http://www.aitp.org/)。密歇根州在 AITP 中有几个[章节。](http://www.aitp.org/organization/chapters/chapters.jsp#Michigan)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T13:49:19.447

[计算机协会 (ACM)](http://www.acm.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T13:57:56.387

特许 IT 专业人士

[http://www.bcs.org/server.php?show=nav.9214](http://www.bcs.org/server.php?show=nav.9214)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T13:52:51.857

[链接](http://www.linkedin.com/)中具有用于非正式网络的组。

对于更严肃或更受认可的事情：在爱尔兰有 ICT，我确信在密歇根州或美国的联邦层面也有类似的事情。也许就像 Paul C. 提到的 ACM。

# javascript - 提交无按钮表单时如何触发功能

> ID：250228
> 
> 赞同：1
> 
> 时间：2008-10-30T13:50:15.653
> 
> 标签：javascript

我有一个页面，上面有很多表格。可能是 1..200。这些表单都没有按钮，它们是以编程方式构建的。我正在使用 jquery 提交所有已检查的表单。

```
 function FakeName()
   {

           $("input:checked").parent("form").submit();

   } 
```

我的表格如下所示：

```
 <form name="FakeForm<%=i%>" action="javascript:void%200" onSubmit="processRow(<%=i%>)" method="post" style="margin:0px;">
                <input type="checkbox" name="FakeNameCheck" value="FakeNameCheck"/>
                <input type="hidden" name="FakeNum" value="<%= FakeNum%>"/>
                <input type="hidden" name="FakeId" value="<%=FakeIdr%>"/>
                <input type="hidden" name="FakeAmt" value="<%=FakeAmount%>"/>
                <input type="hidden" name="FakeTrans" value="FakeTrans"/>
            </form> 
```

注意：操作设置为“javascript:void%200”，以便发布到虚假页面。我想处理我自己在 processRow 中的发布。

OnSubmit 永远不会被调用，因此 ProcessRow 永远不会被调用。

显然，所有函数和变量的名称都已更改以保护其身份：D

当我以编程方式调用提交时，如何让每个表单中的函数触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T14:00:23.653

当`onsubmit`您以编程方式提交表单时，故意不触发处理程序。这是为了避免在事件处理程序导致事件再次被触发（因此事件处理程序被再次调用）时无限递归

但是，当然您可以`processRow()`自己调用该函数来代替`.submit()`调用。

您可以在表单之外进行输入。一种观点是，如果不打算通过 HTML 将`<form>`a 提交给服务器，则 a 不应该是 a 。`<form>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T14:19:37.920

查找[dispatchEvent](https://developer.mozilla.org/index.php?title=En/DOM/Element.dispatchEvent)，它等效于[fireEvent](http://msdn.microsoft.com/en-us/library/ms536423(VS.85).aspx)。这不是世界上最容易使用的东西，但我认为这就是您正在寻找的东西。

我很惊讶没有图书馆可以轻松解决这个问题。原型（我用得最多的）最接近元素的 .fire() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T14:20:01.257

看起来我可以做到这一点：

```
<form name="FakeForm<%=i%>" action="javascript:processRow(<%=i%>)" method="post" style="margin:0px;">
                                <input type="checkbox" name="FakeNameCheck" value="FakeNameCheck"/>
                                <input type="hidden" name="FakeNum" value="<%= FakeNum%>"/>
                                <input type="hidden" name="FakeId" value="<%=FakeIdr%>"/>
                                <input type="hidden" name="FakeAmt" value="<%=FakeAmount%>"/>
                                <input type="hidden" name="FakeTrans" value="FakeTrans"/>
                        </form> 
```

这有什么缺点吗？

# php - 使用 php 发送邮件并转义 hotmails 垃圾文件夹

> ID：250234
> 
> 赞同：7
> 
> 时间：2008-10-30T13:52:34.637
> 
> 标签：php, email, pear, spam

我一直在尝试让 PEAR::mail 成功地将电子邮件发送给 hotmail 用户，而不会被标记为垃圾邮件并最终进入垃圾文件夹，我只使用 hotmail 对 yahoo/gmail 没有任何问题。

google 建议这是 hotmail 的常见问题，可能的原因可能包括

*   服务器主 IP 的反向 DNS 不正确
*   缺少 SenderId/SPF 记录
*   被列入黑名单

检查了以上所有内容后，我只能想到另一个原因-标题格式不正确？

为了测试这个理论，我将 Outlook 设置为通过 PEAR::mail 使用的相同地址发送电子邮件并发送了一个快速测试 - 它直接发送到我的收件箱

所以我将 PEAR::mail 发送的电子邮件的标题与 Outlook 发送的标题进行了比较，只有一些差异 - 我只列出了差异以节省空间（和人们的眼睛）

PEAR::mail 标头（不在 Outlook 标头中）

```
X-PHP-Script: www.example.com/register.php for [users ip address] 
```

Outlook 标头（不在 PEAR::mail 标头中）

```
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Ack6CWSQlgV8s6+6SWyifka2NNpB7g==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3350 
```

我能看到的唯一其他区别是

*   From: 和 To: 标头的顺序颠倒了
*   并在 Received: 标题部分

外表

```
Received: from myhomehostname.com ([ip address] helo=simber) 
by mywebhostname.com with local (Exim 4.67) 
```

梨::邮件

```
Received: from apache by mywebhostname.com with local (Exim 4.67) 
```

标题中的这些小差异可能是原因还是我找错了地方？我知道这可能有问题，因此为什么我选择使用 PEAR::mail 类而不是自己滚动但现在我真的不知道该去哪里，任何帮助将不胜感激。

***更新：***根据更改日志的建议，我尝试将 MS 标头添加到 PEAR::mail 类中，并且我尝试用 PHPMailer 替换 PEAR::mail（带有 & 没有额外的标头）-它们最终都在垃圾文件夹中。

我开始相信它可能不是标题。

***更新 2：***我应该提到这些电子邮件只是用于验证用户注册的电子邮件地址的注册确认 - 没有邮件截图等，因此我们的数量非常低。

我曾考虑警告提供@hotmail/live 电子邮件地址的用户将我们添加到他们的地址簿或检查他们的垃圾文件夹 - 但这对我来说似乎不专业 - 我可能不得不求助于这个。

至于获得发件人分数认证 - 考虑到这些电子邮件的数量和目的低，我不太可能证明这样做的成本是合理的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T16:39:34.503

我的公司进行专业的电子邮件营销活动（通过 strongmail 服务器），我们每天向各种地址发送数千封（请求的）电子邮件。

你面临的问题是你没有权限。您可能只是试图发送大量垃圾邮件的垃圾邮件发送者。

你需要做的是：

*   添加退订链接
*   申请 hotmail 的垃圾邮件报告计划 (JMRP) 并*确保*按下“这是垃圾邮件”按钮的人不会再次收到邮件。这将提高您的“发件人分数”；@hotmail 让你的邮件打通。
*   添加 SPF 和其他反垃圾邮件解决方案。
*   每分钟不要向@hotmail.com 发送超过 50 封电子邮件（其他域有其他限制）

顺便说一句，我们使用 PHPMailer 来编写我们的消息，这完全没有问题 :-) 现在的问题确实是限制接收邮件服务器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-30T16:43:21.967

电子邮件可传递性更接近于一门艺术而不是一门科学。我几乎可以保证它与您的标题无关。试图欺骗标题可能是你能做的最糟糕的事情。邮件服务器在收到邮件时添加*received:*标头：欺骗这将导致您的电子邮件被标记为垃圾邮件：常用的垃圾邮件过滤器之一是计算中继的数量（即*接收：*标头）。如果有太多，你会得到更高的垃圾邮件分数。

反向 DNS 和 SPF 是最低的进入门槛。特别是对于 hotmail，在获得 SPF 和 DNS 记录后，还有其他三个非常重要的因素：

*   IP/域名声誉
*   体积
*   在通讯录中

声誉与被列入黑名单不同。您需要使用 hotmail 建立信任。Hotmail 使用[Sender Score Certified](http://senderscorecertified.com/)作为他们的主要声誉经纪人——如果你愿意，你可以通过他们检查你的声誉，但这可能会花费你。

如果您使用的是共享主机或 IP 地址的过去格格不入，那么您在使用 hotmail 时不会有太多运气。

您可以通过稳定的数量和低垃圾邮件投诉来建立声誉。只要您每天都这样做，您就可以整天每小时发送 100 万条消息。如果您每天发送的消息少于 10,000 条，您可能无法建立良好的声誉。您可以在[Sender Base](http://www.senderbase.org/)获取有关您的交易量的报告。

最后，确保您最终进入收件箱的最佳方法是让您的用户将发送电子邮件地址添加到他们的地址簿中。Hotmail 将其用作安全发件人列表。事实上，我认为现在 Hotmail 中还有一个额外的受信任发件人选项（我已经有一段时间没有参与投递游戏并且我不使用 hotmail）。

以下是发送电子邮件的其他一些最佳做法：

*   始终使用相同的 IP 地址
*   始终使用相同的 FROM 地址
*   如果您有一个要发送时事通讯的大型列表，请确保您停用旧地址（即检查开放率）
*   如果您的列表很大，请尝试根据风险对其进行分段并从不同的 IP 地址发送（即，较新的地址可能会将邮件标记为垃圾邮件）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T13:55:18.000

我一直在我的项目中使用[PHPMailer](http://phpmailer.codeworxtech.com/)，为了避免 Hotmail 的垃圾文件夹，我所做的就是调用一种方法，将 MS Headers 添加到消息中。

[查看源代码](http://www.koders.com/php/fid8B2BF59A0FE70060034616281BE9155A6532DE07.aspx?s=smtp+server#L1168)，并自己添加这些标题。

另外，如果您要发送 HTML 电子邮件，我建议您包含文​​本版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:52:41.363

我建议修改您发送的标题以匹配 Outlook 发送的 100% 的标题，看看是否能解决问题。确实这是一个艰难的过程，hotmail 以拥有超级糟糕的垃圾邮件过滤器而闻名，将大量合法电子邮件发送到垃圾邮件，并将大量垃圾邮件发送到您的收件箱。

# git - 折叠 git 存储库的历史记录

> ID：250238
> 
> 赞同：85
> 
> 时间：2008-10-30T13:53:33.637
> 
> 标签：git, version-control

我们有一个历史悠久的 git 项目。

具体来说，在项目早期，项目中有相当多的二进制资源文件，现在这些已被删除，因为它们实际上是外部资源。

但是，由于之前提交了这些文件，我们的存储库的大小大于 200MB（当前总检出量约为 20MB）。

我们想要做的是“折叠”历史记录，以便存储库似乎是从比它更晚的版本创建的。例如

```
1-----2-----3-----4-----+---+---+
                   \       /
                    +-----+---+---+ 
```

1.  已创建存储库
2.  添加了大量二进制文件
3.  删除了大量二进制文件
4.  存储库的新预期“开始”

因此，我们希望在某个特定点之前丢失项目历史记录。此时只有一个分支，因此尝试处理多个起点等并不复杂。但是我们不想丢失所有历史记录并使用当前版本启动新存储库。

这是可能的，还是我们注定永远拥有一个臃肿的存储库？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-10-30T22:03:31.273

您可以删除二进制膨胀并保留其余的历史记录。Git 允许您重新排序和“压缩”之前的提交，因此您可以仅组合添加和删除大型二进制文件的提交。如果添加都在一个提交中完成，而删除在另一个提交中完成，这将比处理每个文件容易得多。

```
$ git log --stat       # list all commits and commit messages 
```

搜索添加和删除二进制文件的提交，并记下它们的 SHA1，比如`2bcdef`和`3cdef3`。

然后要编辑 repo 的历史记录，请使用`rebase -i`命令及其交互选项，从添加二进制文件的提交的父级开始。它会启动你的 $EDITOR，你会看到一个以 开头的提交列表`2bcdef`：

```
$ git rebase -i 2bcdef^    # generate a pick list of all commits starting with 2bcdef
# Rebasing zzzzzz onto yyyyyyy 
# 
# Commands: 
#  pick = use commit 
#  edit = use commit, but stop for amending 
#  squash = use commit, but meld into previous commit 
# 
# If you remove a line here THAT COMMIT WILL BE LOST.
#
pick 2bcdef   Add binary files and other edits
pick xxxxxx   Another change
  .
  .
pick 3cdef3   Remove binary files; link to them as external resources
  .
  . 
```

作为第二行插入 并从列表中`squash 3cdef3`删除该行。`pick 3cdef3`您现在有一个交互式操作列表，`rebase`它将添加和删除二进制文件的提交合并到一个提交中，其差异只是这些提交中的任何其他更改。然后，当您告诉它完成时，它将按顺序重新应用所有后续提交：

```
$ git rebase --continue 
```

这将需要一两分钟。
您现在拥有一个不再有二进制文件来或去的存储库。但是它们仍然会占用空间，因为默认情况下，Git 会将更改保留 30 天左右，然后才能将它们作为垃圾收集，以便您可以改变主意。如果您现在想删除它们：

```
$ git reflog expire --expire=1.minute refs/heads/master
      #all deletions up to 1 minute  ago available to be garbage-collected
$ git fsck --unreachable      # lists all the blobs(files) that will be garbage-collected
$ git prune
$ git gc 
```

现在您已经消除了膨胀，但保留了其余的历史记录。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-24T12:08:30.847

您可以使用`git filter-branch`与移植一起使提交编号 4 成为您分支的新根提交。只需创建一个文件`.git/info/grafts`，其中只有一行包含提交号 4 的 SHA1。

如果您现在执行 a `git log`or`gitk`您将看到这些命令将提交编号 4 显示为您的分支的根。但是您的存储库中实际上没有任何变化。您可以删除`.git/info/grafts`和`git log`或`gitk`将像以前一样的输出。要真正使提交编号 4 成为新的根，您必须运行`git filter-branch`，不带任何参数。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-30T18:31:58.520

感谢 JesperE 的帖子，我查看了`git-filter-branch`- 这实际上可能是您想要的。看起来您也可以保留之前的提交，除非它们会因为您的大文件被删除而被修改。从[git-filter-branch 手册页](http://git-scm.com/docs/git-filter-branch)：

> 假设您想从所有提交中删除一个文件（包含机密信息或侵犯版权）：
> 
> git filter-branch --tree-filter 'rm 文件名' HEAD

请务必阅读该手册页...显然您希望在存储库的备用克隆上执行此操作，以确保它按预期工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-30T14:33:40.153

是`git-fast-export`你要找的吗？

```
NAME
   git-fast-export - Git data exporter

SYNOPSIS
   git-fast-export [options] | git-fast-import

DESCRIPTION
   This program dumps the given revisions in a form suitable to be piped into git-fast-
   import(1).

   You can use it as a human readable bundle replacement (see git-bundle(1)), or as a kind
   of an interactive git-filter-branch(1). 
```

# c# - C# 2.0 线程问题（匿名方法）

> ID：250244
> 
> 赞同：12
> 
> 时间：2008-10-30T13:56:21.897
> 
> 标签：c#, multithreading, .net-2.0, anonymous-methods

我有一个带有以下代码的简单应用程序：

```
 FileInfo[] files = (new DirectoryInfo(initialDirectory)).GetFiles();
   List<Thread> threads = new List<Thread>(files.Length);

   foreach (FileInfo f in files)
   {
       Thread t = new Thread(delegate()
       {
            Console.WriteLine(f.FullName);
       });
       threads.Add(t);
   }

   foreach (Thread t in threads)
       t.Start(); 
```

假设在 'I=initialDirectory' 目录中我有 3 个文件。然后这个应用程序应该创建 3 个线程，每个线程打印一个文件名；然而，每个线程将打印出“文件”数组中最后一个文件的名称。

为什么是这样？为什么当前文件“f”变量没有在匿名方法中正确设置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-30T13:57:57.183

匿名方法在封闭块中保留对变量的**引用**——而不是变量的实际值。

在方法实际执行时（当您启动线程时）`f`已被分配指向集合中的最后一个值，因此所有 3 个线程都会打印最后一个值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T14:22:50.050

以下是一些关于 C# 中的匿名方法以及编译器将生成的代码的好文章：

[http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx)
[http://blogs.msdn.com/oldnewthing/archive/2006/08/03/687529.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/03/687529.aspx)
[http:// blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx)

我想如果你这样做：

```
   foreach（文件中的 FileInfo f）
   {
       文件信息 f2 = f; //在循环中声明的变量
       线程 t = 新线程（委托（）
       {
            Console.WriteLine(f2.FullName);
       });
       线程。添加（t）；
   }

```

它会按照你想要的方式工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T14:01:09.423

这是因为`f.FullName`是对变量的引用，而不是值（这是您尝试使用它的方式）。当您实际启动线程时，f.FullName 一直递增到数组的末尾。

无论如何，为什么要在这里迭代两次？

```
foreach (FileInfo f in files)
{
   Thread t = new Thread(delegate()
   {
        Console.WriteLine(f.FullName);
   });
   threads.Add(t);
   t.Start();
} 
```

但是，这仍然是错误的，甚至可能更糟，因为您现在有一个竞争条件来查看哪个线程运行得更快：写入控制台项或迭代到下一个 FileInfo。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T17:28:36.430

这是因为迭代器（foreach）的底层代码在线程开始之前已经“迭代”了列表中的所有值......所以当它们开始时，迭代器“指向”的值是列表中的最后一个...

而是在迭代中启动线程......

```
foreach (FileInfo f in files)
 {   
     string filName = f.FullName;
     Thread t = new Thread(delegate()   
                 { Console.WriteLine(filName); });   
     t.Start();
 } 
```

我不相信这里有可能发生比赛，因为所有线程都无法访问共享内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T20:51:19.267

以下内容也可以。

```
 Thread t = new Thread(delegate()
    {
        string name = f.Name;
        Console.WriteLine(name);
    }); 
```

# wcf - .NET 基类型不能被 WCF 序列化

> ID：250255
> 
> 赞同：6
> 
> 时间：2008-10-30T13:59:45.167
> 
> 标签：wcf, serialization, datacontract, datamember, configurationelement

我正在编写 WCF 服务并希望公开一些自定义配置元素（例如自定义 ConfigurationSection 和 ConnectionStringSettings），以便我可以修改服务的配置。

我的自定义配置元素之一继承自`System.Configuration.ConfigurationElementCollection`. 当我尝试启动我的 WCF 服务时，我收到以下错误消息...

> 无法序列化类型“System.Configuration.ConfigurationElementCollection”。考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。

有没有办法为这种类型实现 DataContract？我的继承类标有 [DataContract] 属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-04T22:49:42.750

今天刚碰到这个问题。这令人困惑，因为问题出现在将项目从一台机器转移到另一台机器上。这篇文章似乎相关：

[http://blogs.msdn.com/youssefm/archive/2009/08/10/serializing-plain-old-clr-objects-poco-types-with-datacontractserializer.aspx](http://blogs.msdn.com/youssefm/archive/2009/08/10/serializing-plain-old-clr-objects-poco-types-with-datacontractserializer.aspx)

总结一下链接失效的情况，这个问题似乎出现在运行时 3.5 中，并在运行时 3.5 SP1 中消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T02:45:42.873

好的，最后我不得不重新设计我的解决方案。我发现 SerializableConfigurationSection 最有益。它在 EnterpriseLibrary 的模式和实践中。因此，我没有尝试通过 WCF 传递我的自定义配置部分，而是手动执行序列化/反序列化并将配置部分作为字符串传递给 WCF。

# javascript - JavaScript switch 语句

> ID：250256
> 
> 赞同：11
> 
> 时间：2008-10-30T13:59:50.690
> 
> 标签：javascript

我在编写的某些 JavaScript 中遇到问题，其中 Switch 语句似乎没有按预期工作。

```
switch (msg.ResultType) {
  case 0:
    $('#txtConsole').val("Some Val 0");
    break;
  case 1:
    $('#txtConsole').val("Some Val 1");
    break;
  case 2:
    $('#txtConsole').text("Some Val 2");
    break;
} 
```

ResultType 是一个整数值 0-2，我可以在 FireBug 中看到它。在所有情况下，switch 都将控制权转移到最后的 break 语句，这意味着所有逻辑都被完全跳过。我错过了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-30T14:04:06.720

我确信开关使用 === 在 Actionscript 中进行比较，并且由于 JS 和 AS 都遵循 ECMAScript 标准，我想这同样适用于 JS。我的猜测是该值实际上不是一个数字，而可能是一个字符串。

您可以尝试在开关中使用 parseInt(msg.ResultType) 或在案例中使用字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T14:01:40.483

我遇到了一个类似的问题，问题原来是当它显示为一个 int 值时，switch 语句将它作为一个字符串变量读取。可能不是这里的情况，但这就是发生在我身上的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:08:28.333

试试这个：

```
switch (msg.ResultType-0) {
  case 0:
    $('#txtConsole').val("Some Val 0");
  break;
  case 1:
    $('#txtConsole').val("Some Val 1");
  break;
  case 2:
    $('#txtConsole').text("Some Val 2");
  break;
} 
```

将`-0`强制（强制）它将您的值视为整数而不更改值，并且它比 parseInt 短得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:02:29.967

您确定 ResultType 是整数（例如 0）而不是字符串（例如“0”）吗？

这可以很容易地解释行为上的差异

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:07:34.137

看起来将其更改为 parseInt(msg.ResultType) 已迫使 JavaScript 引擎正确地将其视为整数。谢谢您的帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T14:08:52.560

我注意到的第一件事是，在这三种情况中的两种情况下，您正在调用 .val()，而在第三种情况下，您正在调用 .text()。

如果您尝试将 case 语句更改为字符串而不是整数，那么我唯一能想到的就是您在某处遇到异常，这可能是由访问未定义的变量引起的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-19T11:04:39.667

ES5 中对 int 的最强大的强制转换可能是：

```
 msg.ResultType | 0 
```

这是 asm.js 所在的基石之一。这导致了**非常**优化的 ES5，并通过在以下情况下进行编译来使用：

```
 "use asm" 
```

指令（在 FF 和 Chromium 中）。这种强制导致 Int32 类型被用于 ES5 中表示“int”的数字。所以 5 年前原始问题的食谱食谱解决方案是这样的：

```
 "use strict" ;
$("#txtConsole").val(
  switch (msg.ResultType | 0) {
     case 0:
          "Some Val 0";
     break;
    case 1:
         "Some Val 1";
    break;
    case 2:
         "Some Val 2";
    break;
    default :
         "Illegal ResultType";
  }); 
```

# python - Python Regex - 如何获取匹配的位置和值

> ID：250271
> 
> 赞同：143
> 
> 时间：2008-10-30T14:04:33.583
> 
> 标签：python, regex

如何使用该`re`模块获取所有匹配项的开始和结束位置？例如，给定模式`r'[a-z]'`和字符串`'a1b2c3d4'`，我想获取它找到每个字母的位置。理想情况下，我也想取回比赛的文本。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2008-10-30T14:15:39.177

```
import re
p = re.compile("[a-z]")
for m in p.finditer('a1b2c3d4'):
    print(m.start(), m.group()) 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2008-10-30T14:16:02.467

取自

[*正则表达式 HOWTO*](http://docs.python.org/3.3/howto/regex.html)

> span() 在单个元组中返回开始和结束索引。由于 match 方法只检查 RE 是否在字符串的开头匹配，因此 start() 将始终为零。但是，RegexObject 实例的搜索方法会扫描字符串，因此在这种情况下匹配可能不会从零开始。

```
>>> p = re.compile('[a-z]+')
>>> print p.match('::: message')
None
>>> m = p.search('::: message') ; print m
<re.MatchObject instance at 80c9650>
>>> m.group()
'message'
>>> m.span()
(4, 11) 
```

将其与：

在 Python 2.2 中，也可以使用 finditer() 方法，将 MatchObject 实例的序列作为迭代器返回。

```
>>> p = re.compile( ... )
>>> iterator = p.finditer('12 drummers drumming, 11 ... 10 ...')
>>> iterator
<callable-iterator object at 0x401833ac>
>>> for match in iterator:
...     print match.span()
...
(0, 2)
(22, 24)
(29, 31) 
```

你应该能够按以下顺序做某事

```
for match in re.finditer(r'[a-z]', 'a1b2c3d4'):
   print match.span() 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-07-05T13:08:18.357

对于 Python 3.x

```
from re import finditer
for match in finditer("pattern", "string"):
    print(match.span(), match.group()) 
```

对于字符串中的每个命中，您将获得`\n`分隔的元组（分别包括匹配的第一个和最后一个索引）和匹配本身。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-07-23T15:22:57.080

请注意，跨度和组被索引为正则表达式中的多捕获组

```
regex_with_3_groups=r"([a-z])([0-9]+)([A-Z])"
for match in re.finditer(regex_with_3_groups, string):
    for idx in range(0, 4):
        print(match.span(idx), match.group(idx)) 
```

# python - 如何在 Python 中进行 scp？

> ID：250283
> 
> 赞同：191
> 
> 时间：2008-10-30T14:09:21.873
> 
> 标签：python, ssh, paramiko, scp

在 Python 中 scp 文件的最 Pythonic 方式是什么？我知道的唯一路线是

```
os.system('scp "%s" "%s:%s"' % (localfile, remotehost, remotefile) ) 
```

这是一种 hack，在类 Linux 系统之外无法使用，并且需要 Pexpect 模块的帮助以避免密码提示，除非您已经为远程主机设置了无密码 SSH。

我知道 Twisted's `conch`，但我宁愿避免自己通过低级 ssh 模块实现 scp 。

我知道`paramiko`，一个支持 SSH 和 SFTP 的 Python 模块；但它不支持SCP。

背景：我连接到一个不支持 SFTP 但支持 SSH/SCP 的路由器，所以 SFTP 不是一个选项。

**编辑**：这是[如何使用 SCP 或 SSH 将文件复制到 Python 中的远程服务器的副本？](https://stackoverflow.com/questions/68335/how-do-i-copy-a-file-to-a-remote-server-in-python-using-scp-or-ssh). **但是**，该问题并没有给出处理 Python 中键的特定于 scp 的答案。我希望有一种方法来运行类似的代码

```
import scp

client = scp.Client(host=host, user=user, keyfile=keyfile)
# or
client = scp.Client(host=host, user=user)
client.use_system_keys()
# or
client = scp.Client(host=host, user=user, password=password)

# and then
client.transfer('/etc/local/filename', '/etc/remote/filename') 
```

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2010-11-26T03:03:37.770

试试[Paramiko 的 Python scp 模块](https://github.com/jbardin/scp.py)。它非常易于使用。请参见以下示例：

```
import paramiko
from scp import SCPClient

def createSSHClient(server, port, user, password):
    client = paramiko.SSHClient()
    client.load_system_host_keys()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect(server, port, user, password)
    return client

ssh = createSSHClient(server, port, user, password)
scp = SCPClient(ssh.get_transport()) 
```

然后调用`scp.get()`或`scp.put()`做SCP操作。

（[SCP客户端代码](https://github.com/jbardin/scp.py/blob/master/scp.py)）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-30T16:18:00.707

您可能有兴趣尝试[Pexpect](https://pexpect.readthedocs.io/en/stable/)（[源代码](https://github.com/pexpect/pexpect)）。这将允许您处理输入密码的交互式提示。

这是来自主网站的示例用法（用于 ftp）的片段：

```
# This connects to the openbsd ftp site and
# downloads the recursive directory listing.
import pexpect
child = pexpect.spawn ('ftp ftp.openbsd.org')
child.expect ('Name .*: ')
child.sendline ('anonymous')
child.expect ('Password:')
child.sendline ('noah@example.com')
child.expect ('ftp> ')
child.sendline ('cd pub')
child.expect('ftp> ')
child.sendline ('get ls-lR.gz')
child.expect('ftp> ')
child.sendline ('bye') 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-07-24T20:14:37.957

Couldn't find a straight answer, and this "scp.Client" module doesn't exist. Instead, [this](https://pypi.python.org/pypi/scp) suits me:

```
from paramiko import SSHClient
from scp import SCPClient

ssh = SSHClient()
ssh.load_system_host_keys()
ssh.connect('example.com')

with SCPClient(ssh.get_transport()) as scp:
   scp.put('test.txt', 'test2.txt')
   scp.get('test2.txt') 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-30T20:22:43.570

您也可以查看[paramiko](http://www.lag.net/paramiko/)。还没有 scp 模块，但它完全支持 sftp。

[编辑] 对不起，错过了你提到 paramiko 的那一行。以下模块只是 paramiko 的 scp 协议的实现。如果您不想使用 paramiko 或 conch（我所知道的唯一用于 python 的 ssh 实现），您可以重新设计它以使用管道在常规 ssh 会话上运行。

[用于 paramiko 的 scp.py](https://github.com/jbardin/scp.py)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-30T14:42:42.257

如果你在 win32 上安装 putty，你会得到一个 pscp（putty scp）。

所以你也可以在 win32 上使用 os.system hack。

（您可以使用 putty-agent 进行密钥管理）

* * *

抱歉，这只是一个 hack（但你可以将它包装在 python 类中）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-05-19T08:40:26.163

截至今天，最好的解决方案可能是`AsyncSSH`

[https://asyncssh.readthedocs.io/en/latest/#scp-client](https://asyncssh.readthedocs.io/en/latest/#scp-client)

```
async with asyncssh.connect('host.tld') as conn:
    await asyncssh.scp((conn, 'example.txt'), '.', recurse=True) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-02-07T16:18:23.797

您可以使用包子进程和命令调用来使用 shell 中的 scp 命令。

```
from subprocess import call

cmd = "scp user1@host1:files user2@host2:files"
call(cmd.split(" ")) 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-11-23T19:30:26.523

看看[fabric.transfer](http://docs.fabfile.org/en/2.4/api/transfer.html)。

```
from fabric import Connection

with Connection(host="hostname", 
                user="admin", 
                connect_kwargs={"key_filename": "/home/myuser/.ssh/private.key"}
               ) as c:
    c.get('/foo/bar/file.txt', '/tmp/') 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-01-22T08:36:10.940

```
import paramiko

client = paramiko.SSHClient()
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

client.connect('<IP Address>', username='<User Name>',password='' ,key_filename='<.PEM File path')

#Setup sftp connection and transmit this script 
print ("copying")

sftp = client.open_sftp() 
sftp.put(<Source>, <Destination>)

sftp.close() 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-07-05T14:08:32.797

自从提出这个问题以来已经有一段时间了，与此同时，另一个可以处理这个问题的库已经出现：您可以使用[Plumbum](http://plumbum.readthedocs.org/en/latest/index.html)库中包含的[复制](http://plumbum.readthedocs.org/en/latest/api/path.html#plumbum.path.utils.copy)功能：

```
import plumbum
r = plumbum.machines.SshMachine("example.net")
   # this will use your ssh config as `ssh` from shell
   # depending on your config, you might also need additional
   # params, eg: `user="username", keyfile=".ssh/some_key"`
fro = plumbum.local.path("some_file")
to = r.path("/path/to/destination/")
plumbum.path.utils.copy(fro, to) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-06-04T23:26:21.943

如果您在 *nix 上，您可以使用[sshpass](http://sourceforge.net/projects/sshpass/)

```
sshpass -p password scp -o User=username -o StrictHostKeyChecking=no src dst:/path 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-30T16:20:46.850

嗯，也许另一种选择是使用[sshfs](http://fuse.sourceforge.net/sshfs.html)之类的东西（Mac 也有[sshfs](http://code.google.com/p/macfuse/wiki/MACFUSE_FS_SSHFS)）。安装路由器后，您可以直接复制文件。我不确定这是否适用于您的特定应用程序，但它是一个很好的解决方案，便于使用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-05-21T13:03:59.717

我前段时间整理了一个依赖于 paramiko 的 python SCP 复制脚本。它包括处理与私钥或 SSH 密钥代理的连接的代码，并回退到密码身份验证。

[http://code.activestate.com/recipes/576810-copy-files-over-ssh-using-paramiko/](http://code.activestate.com/recipes/576810-copy-files-over-ssh-using-paramiko/)

# language-agnostic - 最佳实践：许多小功能/方法，还是内联逻辑流程组件的更大功能？

> ID：250284
> 
> 赞同：34
> 
> 时间：2008-10-30T14:09:57.207
> 
> 标签：language-agnostic, function

是编写许多小方法（或函数）更好，还是简单地将这些小进程的逻辑/代码直接写入您将调用小方法的地方？即使暂时只从一个地方调用它，将代码分解成一个小函数又如何呢？

如果一个人的选择取决于某些标准，它们是什么？程序员应该如何做出好的判断？

我希望答案可以普遍适用于多种语言，但如有必要，给出的答案可以特定于一种或多种语言。特别是，我想到了 SQL（函数、规则和存储过程）、Perl、PHP、Javascript 和 Ruby。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-30T14:12:59.383

我总是将长方法分解成逻辑块，并尝试从中制作更小的方法。*除非我在两个不同的地方需要它，否则我通常*不会将几行代码变成一个单独的方法，但有时我这样做只是为了提高可读性，或者如果我想单独测试它。

Fowler 的[重构](https://rads.stackoverflow.com/amzn/click/com/0201485672)就是关于这个主题的，我强烈推荐它。

这是我在重构中使用的一个方便的经验法则。如果一段代码有一个注释，我可以将它改写为方法名称，将其拉出并使其成为方法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-30T14:20:00.743

该方法的大小与其[***圈复杂度***](https://stackoverflow.com/questions/105852)直接相关。

保持方法尺寸较小（这意味着将一个大方法分成几个小方法）的主要优点是：

*   更好的单元测试（由于低圈复杂度）
*   由于更明确的堆栈跟踪（而不是一个巨大的方法中的一个错误），更好的调试

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-30T14:14:39.880

一如既往，您可以说：这取决于。这更多的是命名和定义方法任务的问题。每种方法都应该完成一个（而不是更多）定义明确的任务，并且应该完整地完成它们。方法的名称应该指明任务。如果您的方法名为 DoAandB()，最好使用单独的方法 DoA() 和 DoB()。如果您需要 setupTask、executeTask、FinishTask 等方法，将它们组合起来可能会很有用。

一些要点表明，不同方法的合并可能有用：

*   一种方法不能单独使用，而不使用其他方法。
*   您必须小心以正确的顺序调用一些依赖方法。

一些点表明，该方法的拆分可能是有用的：

*   现有方法的某些行具有明确的独立任务。
*   大方法的单元测试会出现问题。如果为独立方法编写测试更容易，那么将大方法拆分。

作为对单元测试参数的解释：我写了一个方法，它做了一些事情，包括 IO。IO部分很难测试，所以我考虑了一下。我得出的结论是，我的方法做了 5 个合乎逻辑且独立的步骤，其中只有一个涉及 IO。所以我将我的方法分成 5 个较小的方法，其中四个很容易测试。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-30T14:58:52.223

每次都是小方法。

他们是自我记录的（呃，如果名字好的话）

他们将问题分解为可管理的部分——你就是 KeepingItSimple。

您可以使用 OO 技术更容易（并且明显地）插入行为。根据定义，大方法更具程序性，因此灵活性较低。

它们是可单元测试的。这是杀手锏，你根本无法对一些执行大量任务的巨大方法进行单元测试

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-31T15:18:32.633

我从 The Code Complete 书中学到的东西：

*   编写方法/函数，使其实现一个逻辑块（或单元或任务）。如果这需要分解为子任务，那么为它们编写一个单独的方法/函数并调用它们。
*   如果我发现方法/函数名称越来越长，那么我会尝试检查该方法以查看它可以分为两种方法。

希望这可以帮助

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-30T14:21:45.530

我发现拥有许多小方法可以使代码更易于阅读、维护和调试。

当我阅读实现某些业务逻辑的单元时，如果我看到一系列描述流程的方法调用，我可以更好地遵循流程。如果我关心方法是如何实现的，我可以去看看代码。

感觉像是更多的工作，但最终节省了时间。

我认为，知道封装什么是一门艺术。每个人都有一些细微的意见分歧。如果我可以用文字来表达，我会说每种方法都应该做一件可以被描述为完整任务的事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-30T14:15:27.820

一些经验法则：

*   功能不应长于屏幕上可显示的内容
*   如果它使代码更具可读性，则将函数分解为更小的函数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-30T14:17:32.480

我让每个函数做一件事，而且只做一件事，并且我尽量不嵌套太多的逻辑层级。一旦您开始将代码分解为**命名良好**的函数，它就会变得更容易阅读，并且实际上是自记录的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-30T14:16:25.117

方法越大，测试和维护就越困难。我发现当一个大过程分解成原子步骤时，它更容易理解它是如何工作的。此外，这样做是使您的类可扩展的重要的第一步。您可以将这些单独的步骤标记为虚拟的（用于继承），或将它们移动到其他对象（组合）中，从而使您的应用程序的行为更易于定制。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T14:34:34.207

我通常会将函数拆分为较小的函数，每个函数执行一个单一的原子任务，但前提是该函数足够复杂以保证它的安全。

这样，我最终不会为简单的任务提供多个功能，而且我提取的功能通常可以在其他地方使用，因为它们不会尝试实现太多。这也有助于单元测试，因为可以单独测试每个功能（作为逻辑的原子操作）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-11-30T19:45:37.987

这有点……取决于心态。不过，这不是一个固执己见的问题。

答案实际上取决于语言上下文。

在 Java/C#/C++ 世界中，人们遵循 Robert Martin 所宣扬的“清洁代码”学派，那么：许多小方法是必经之路。

一个方法有一个明确的名字，只做一件事。一层嵌套，就是这样。这将其长度限制为 3、5、最多 10 行。

老实说：我发现这种编码方式绝对优于任何其他“风格”。

这种方法的唯一缺点是您最终会得到许多小方法，因此在文件/类中进行排序可能会成为问题。但答案是使用一个体面的 IDE，它可以轻松地来回导航。

因此，使用“所有东西都融入一个方法/功能”的唯一“合法”理由是当您的整个团队都这样工作并且更喜欢这种风格时。或者当你不能使用像样的工具时（但是导航那个又大又丑的功能也不起作用）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-30T14:15:56.397

就个人而言，我明显倾向于使用更多、更小的方法，但并没有达到虔诚地追求最大行数的地步。我的主要标准或目标是保持我的代码干燥。一旦我有一个重复的代码块（无论是在精神上还是实际上是由文本），即使它可能是 2 或 4 行长，我也会将该代码干燥到一个单独的方法中。有时，如果我认为将来很有可能再次使用它，我会提前这样做。

另一方面，我也听到有人争论说，如果你的中断方法太小，在一个开发团队的环境中，一个队友很可能不知道你的方法，要么写内联，要么写他*自己*做同样事情的小方法。诚然，这是一个糟糕的情况。

有些人还试图争辩说将内容保持内联更具可读性，因此读者可以自顶向下阅读，而不必跳过可能跨越多个文件的方法定义。就个人而言，我认为堆栈跟踪的存在使这不是什么大问题。

# sql - 何时创建新的 SQL Server 索引？

> ID：250289
> 
> 赞同：16
> 
> 时间：2008-10-30T14:11:44.207
> 
> 标签：sql, database, tsql

显然（我认为），在列上创建索引`BIT`是不必要的。但是，如果您有一个需要搜索的列，其中每个值都可能是唯一的，例如`BlogPost`或之类`StreetAddress`的东西，那么索引似乎是合适的（再次，我认为）。

但截止点是什么？如果您期望有 10,000 行并且其中将有大约 20 个唯一值，该怎么办。是否应该创建索引？

提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-30T14:26:19.200

对此的最佳答案是分析您的查询并查看索引是否改进了您的查询。回答这个问题的困难在于几乎不可能概括查询优化器的行为。

也就是说，经验法则是，如果您对表的给定查询的选择性为 10% 或更少，那么您很可能会从索引中受益。因此，在您的示例中，如果您的值均匀分布，您*可能会从索引中受益。*但是，考虑到您的表很小，因此您的性能提升可能可以忽略不计。

这不是一个硬性规定，因为有很多因素可以改变 10% 的数字，包括使用聚集索引或其他索引类型、行的大小、如果某些列不是内联的、查询结构等。

还要记住，插入带有索引的表会显着降低性能。如果此表经常更新或附加，则索引的速度提升可能会被较慢的插入和更新所抵消。

请参阅有关[Tablescan 与索引访问](http://msdn.microsoft.com/en-us/library/aa224773(SQL.80).aspx)的 MSDN 文章。

编辑：正如其他人所指出的，如果您正在执行聚合查询，您的查询可能会受益于索引，例如计算特定值出现的次数。如果您经常对特定列进行排序，您也可能会受益。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T14:29:31.097

詹姆斯一针见血。我将补充一点，根据您使用表的方式，即使是位列也可能受益于索引。例如，如果您需要计算一天中多次出现 1 的行数，那么索引可能会很有用。索引并不总是关于查找单个记录——它们也可以用于聚合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T23:29:03.653

具有低基数的索引是非常有问题的。如果只有几个可能的值，SQL Server 几乎总是索引扫描，无论比例如何。

示例：我有一个包含状态字段的表，它只接受值“A”、“N”和“R”（用于 Active、New 和 Retired。）通常你会接近 95% 的情况“R”，4+% 为“A”，少数为“N”。SELECT WHERE state = 'N' 无论如何都会进行表扫描。

但是 - 有一种新的索引类型称为[过滤索引，](http://netindonesia.net/blogs/kasim.wirama/archive/2008/09/21/filtered-index-and-statistics-in-sql-server-2008.aspx)它最终处理了这种情况。当您想要排除具有 NULL 值的记录时，它也很方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T14:20:58.993

在您建议的列中，有理由为数据创建参考或查找表以避免数据冗余。这将使您的列成为外键，指向新查找表的 PK。

所有外键列都应该被索引。

否则，我会避免在正常情况下在此类列上放置索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T14:28:49.913

> `BIT`不需要在列上创建索引。

你会感到惊讶。

我必须为如下查询创建一个涉及位列的索引：

```
SELECT foo.Name FROM foo WHERE foo.Active = 1 
```

不过，表中有大约 300,000 行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T22:58:47.583

我想说这完全取决于表的使用方式和整体系统要求。例如，如果它是大型 JOIN 的一部分，并且父级是一个巨大的报表类型表，那么您肯定需要索引。如果与数据库中的其他表相比它相对较小，并且它被大量插入并且很少读取，那么可能不需要索引。

但是，整个数据库中的操作范围与要分配的可用资源是关键的决策因素。这是该表 + 可能的索引在整个系统中与所有其他表及其要求相比的行为方式。如果您不牢记大局，您可能会为了应用任意规则而尝试应用任意规则来杀死整个系统。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T23:32:03.867

如果您开始遇到查询之间的死锁，通常在 SELECT 和 INSERT/UPDATE 之间，您还应该仔细检查您的索引。选择不当的索引会导致死锁，就像根本没有索引一样。有关其他信息，请参阅[此知识库](http://support.microsoft.com/kb/832524)文章。通常，添加索引或修改其包含的列将有助于解决此类死锁。请务必检查受影响查询的查询计划。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-15T07:13:47.150

最好的方法之一是在 SQL Server 中使用 mvp 视图，我建议一周内不要重新启动服务器，然后运行此查询：

```
USE master; 
Go
SELECT d.database_id,
  d.object_id,
  d.index_handle,
  d.equality_columns,
  d.inequality_columns,
  d.included_columns,
  d.statement AS fully_qualified_object,
  gs.*
FROM   sys.dm_db_missing_index_groups g
JOIN   sys.dm_db_missing_index_group_stats gs ON   gs.group_handle = g.index_group_handle
JOIN   sys.dm_db_missing_index_details d ON   g.index_handle = d.index_handle

Go

SELECT mig.index_group_handle,
  mid.index_handle,
  migs.avg_total_user_cost AS AvgTotalUserCostThatCouldbeReduced,
  migs.avg_user_impact AS AvgPercentageBenefit,
  'CREATE INDEX missing_index_' + CONVERT (varchar, mig.index_group_handle)
  + '_' + CONVERT (varchar, mid.index_handle)
  + ' ON ' + mid.statement
  + ' (' + ISNULL (mid.equality_columns,'')
  + CASE
         WHEN mid.equality_columns IS NOT NULL AND mid.inequality_columns
         IS NOT NULL THEN ','
         ELSE ''
    END
    + ISNULL (mid.inequality_columns, '')
  + ')'
  + ISNULL (' INCLUDE (' + mid.included_columns + ')', '') AS  create_index_statement
FROM sys.dm_db_missing_index_groups mig 
INNER JOIN sys.dm_db_missing_index_group_stats migs ON migs.group_handle =  mig.index_group_handle
INNER JOIN sys.dm_db_missing_index_details mid ON mig.index_handle =  mid.index_handle
Order By migs.avg_user_impact Desc 
```

然后验证您的表并创建请求索引。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-24T20:12:10.873

这里已经发布了很好的答案......只需添加我的两分钱......执行缺失索引`DMV`并查看您提到的表是否被列为创建新索引的候选并查看索引的定义。

从[您是否使用 SQL 的缺失索引 DMV？](http://blogs.msdn.com/b/bartd/archive/2007/07/19/are-you-using-sql-s-missing-index-dmvs.aspx)

```
SELECT
  migs.avg_total_user_cost * (migs.avg_user_impact / 100.0) * (migs.user_seeks + migs.user_scans) AS improvement_measure,
  'CREATE INDEX [missing_index_' + CONVERT (varchar, mig.index_group_handle) + '_' + CONVERT (varchar, mid.index_handle)
  + '_' + LEFT (PARSENAME(mid.statement, 1), 32) + ']'
  + ' ON ' + mid.statement
  + ' (' + ISNULL (mid.equality_columns,'')
    + CASE WHEN mid.equality_columns IS NOT NULL AND mid.inequality_columns IS NOT NULL THEN ',' ELSE '' END
    + ISNULL (mid.inequality_columns, '')
  + ')'
  + ISNULL (' INCLUDE (' + mid.included_columns + ')', '') AS create_index_statement,
  migs.*, mid.database_id, mid.[object_id]
FROM sys.dm_db_missing_index_groups mig
INNER JOIN sys.dm_db_missing_index_group_stats migs ON migs.group_handle = mig.index_group_handle
INNER JOIN sys.dm_db_missing_index_details mid ON mig.index_handle = mid.index_handle
WHERE migs.avg_total_user_cost * (migs.avg_user_impact / 100.0) * (migs.user_seeks + migs.user_scans) > 10
ORDER BY migs.avg_total_user_cost * migs.avg_user_impact * (migs.user_seeks + migs.user_scans) DESC 
```

# c# - 解析 HTML 片段

> ID：250292
> 
> 赞同：3
> 
> 时间：2008-10-30T14:12:54.953
> 
> 标签：c#, asp.net, unit-testing, web-standards

在 C# 中解析 HTML 片段的最佳方法是什么？

对于上下文，我继承了一个使用大量复合控件的应用程序，这很好，但是很多控件是使用一长串文字控件呈现的，这相当可怕。我试图让应用程序进入单元测试，我想让这些控件接受测试，以了解它们是否生成格式良好的 HTML，并在理想的解决方案中验证该 HTML。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T14:14:40.333

看看 [HTMLAgility](http://www.codeplex.com/htmlagilitypack)包。它与 .NET XmlDocument 类非常兼容，但它对不干净/有效的 XHTML 的 HTML 更加宽容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T14:29:46.260

我使用[SGMLReader](http://wiki.developer.mindtouch.com/SgmlReader)从 HTML 生成有效的 Xml 文档，然后使用 XPath 解析所需的内容或使用 XSLT 解析为另一种格式。.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T14:32:57.520

如果 HTML 与 XHTML 兼容，则可以使用内置的 System.Xml 命名空间。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-30T15:06:50.257

您还可以查看[HTML Tidy](http://tidy.sourceforge.net/)以进行 HTML 解析/清理。我认为他们没有特定的 .NET 库，但您可能能够通过命令行运行二进制文件，或者通过 Java 库运行 IKVM。

# windows-vista - Editing the Registry with VBScript on Vista

> ID：250304
> 
> 赞同：0
> 
> 时间：2008-10-30T14:15:51.657
> 
> 标签：windows-vista, vbscript, elevation

A VBScript cannot edit the registry by default on Vista. How do I get elevation (even if the user has to do something when they run the script) so that the script can edit the registry?

The error is:

```
---------------------------
Windows Script Host
---------------------------
Script: blah blah blah.vbs
Line:   6
Char:   1
Error:  Permission denied
Code:   800A0046
Source:     Microsoft VBScript runtime error

---------------------------
OK   
--------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T14:29:51.533

My understanding was that you could edit HKCU as a normal user, but the others were restricted. I could be wrong. Regardless, there are a couple of example [here](http://www.winhelponline.com/articles/185/1/VBScripts-and-UAC-elevation.html) to do what you want to do.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T14:29:46.120

To make it work with native VBScript, you will most likely need a code signing certificate and sign your script with that. More info is in that thread at [tek-tips.com](http://www.tek-tips.com/viewthread.cfm?qid=1475626).

You could try to write the intended changes to a .reg file and call `regedit.exe` with that. Maybe this triggers UAC. Did not tried that, though. I have no Vista around right now. :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T14:32:44.227

Windows XP had the capability to "Run As..." when you right-clicked a program (like the shortcut to the command line). Doesn't Vista have something like this, "Run as Administrator" or something.

Do this on the command line then have them run the script from the command line?

# java - 如何动态更改 Java LAF UIDefaults？

> ID：250313
> 
> 赞同：1
> 
> 时间：2008-10-30T14:19:59.667
> 
> 标签：java, user-interface, look-and-feel

我正在通过动态更改 UIDefaults 来定制 Swing 应用程序。最终目标是更改其中的许多（颜色、字体、大小、边框等）并保存每个用户的结果。虽然它可能会给应用程序一些非标准的外观，但客户要求并且客户应该收到。

我遇到的唯一问题是 GUI 只会更新一次。我第一次更改 ui 属性时一切都很好，随后的更改不会影响任何事情。

```
// called from the EDT
// uiKeyName points to some ColorUIResource
UIManager.getDefaults().put(uiKeyName, <<color from color picker>>);
SwingUtilties.updateComponentTreeUI(rootWindow); 
```

它工作一次，但再也不会。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T17:06:11.360

当您将新颜色（例如）放入表格时，它是 Color 对象，还是 ColorUIResource？**据我了解，只有当前**值是[UIResource](http://java.sun.com/javase/6/docs/api/javax/swing/plaf/UIResource.html)`null`或实例时才会使用新值。因此，如果您插入一个普通的旧 Color 对象，您所做的任何后续更改都将被忽略。

此外，正如链接的文档页面所暗示的那样，这可能仅有助于字体和前景色/背景色；当涉及到更改边框和边距等内容时，您可能会不走运。这不是 Swing 的 Pluggable LookAndFeels 的设计目的。也许您可以让客户对基于 Synth 的 LAF 感兴趣？

# php - 使用php显示mysql数据

> ID：250324
> 
> 赞同：0
> 
> 时间：2008-10-30T14:22:54.857
> 
> 标签：php, mysql

我想知道使用 php 获取数据库中所有行的列表的最佳方法是什么，并且在单击行时更详细地显示信息，例如相关图像等。

我应该使用框架来做到这一点吗？在某处有这方面的好例子吗？

编辑：

我需要更简单的说明，因为我不是程序员，才刚刚开始。可以推荐任何链接或示例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T14:24:44.353

我使用表格和 JavaScript 来做到这一点。

SQL 数据库中的数据本质上是表格的。所以我只是选择数据并创建一个表。然后，为了向下钻取（当我需要时），我提供了一个 JavaScript“更多”功能并使用 CSS 来隐藏/显示附加数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T21:46:41.183

与其他人的建议相反，我不会推荐框架或抽象级别。它将使您无法理解 php 的工作原理，并要求您同时学习 php 和框架结构/流程。抽象层在商业环境中是一种很好的做法，但从您的问题的氛围来看，您不会期望移动服务器或迁移您的数据库。

我建议使用 php 和 mysql 以程序方式（不是面向对象）工作，直到您了解发生了什么以及该语言如何工作。

要回答您的实际问题：

您需要连接到数据库：`mysql_connect()`

您需要选择要使用的数据库：`mysql_select_db()`

您需要定义查询：`msyql_query()`

您需要使用 while 循环来获取数据：

```
$query=mysql_query("select * from table_name");
    while($row=mysql_fetch_assoc($query)){
         extract($row);
         echo $name of field 1.": ".$name of field 2;
    } 
```

要使每一行输出成为更多信息的链接，请重写 echo 语句，如下所示：

```
 echo "<a href=\"http://addresstomoreinfo.php?image_id=".$image_id.\">".$name 
      of field 1.": ".$name of field 2."</a>"; 
```

“字段名称”变量代表您的数据库表的列名，我已经制定了字段名称、冒号和第二个字段名称的布局。信息的显示方式取决于您。

问号在 addresstomoreinfo.php 页面中定义的变量的名称前面，该页面将由`$var=$_GET['image_id'];`

其他 php, html, css 元素也参与了实现这一目标的大局。开始信息的一个很好的来源是[http://www.w3schools.com/](http://www.w3schools.com/) **我也通过链接到上面的 php 手册来生存和死亡**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T14:33:31.450

您可以从[PHP 手册](http://www.php.net/manual/en/)开始。现在组织得比较好。但现在我的讽刺已经不碍事了……

使用数据库的最佳方法之一（目前，您的选择是 MySQL，但这*可能会*改变）是将您的代码从与它的直接交互中抽象出来。

像[ADODB](http://adodb.sourceforge.net/)这样的工具非常值得了解，它使“获取数据库中所有行的列表”的任务变得相当简单。

这样做的主要优点是，如果您发现需要将应用程序迁移到运行不同数据库的服务器上，它使您不必重写大量代码。

更好的是（恕我直言）看一个框架，比如[Zend 的](http://framework.zend.com/)（好吧，他们毕竟做 php），它的 DB 抽象称为 Zend_Db。现在这对您来说可能有点矫枉过正，因为从您的其他问题看来，您对 PHP/MySQL 开发还很陌生。

也不错：[Smarty](http://www.smarty.net/)（用于从逻辑中抽象出您的演示文稿）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:25:33.883

我倾向于使用两个单独的页面。一个列表，它链接到显示详细记录的那个。列出的那个在链接上传递了一个 ID 参数（即 show.php?id=145），因为 show.php 页面将从`$_GET['id']`.

这是解决您的问题的最简单方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:48:45.350

如果您不是程序员，但想使用 php 显示 mysql 表中的内容，也许[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)就是您正在寻找的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T20:01:16.733

如果您正在构建一个简单的数据库驱动应用程序，并且您刚刚开始学习 PHP，那么我推荐的方法是使用为您生成这些的框架。看看 QCodo ( [http://www.qcodo.com](http://www.qcodo.com) )，特别是这个教程视频：[http ://www.qcodo.com/view.php/demo_1_live](http://www.qcodo.com/view.php/demo_1_live)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T22:43:49.227

我想你真的不知道你在问什么！:-)

有了合适的框架、数据库和对象抽象层，这很简单（我已经做过好几次了）。但是从头开始编写它们并*非易事，并且对于从基础学习 PHP 没有帮助。*除非你用其他语言做到这一点。

OTOH，只要您愿意反复重新设计代码（即使您从未真正做过）以开发合适的抽象，直接做这一切仍然是一个很好的练习（正如[@kevtrout 所描述的）。](https://stackoverflow.com/questions/250324/use-php-to-show-mysql-data#251880)国际海事组织，有太多的 PHP 踢，早已超出了如此简单的结构。

# performance - AutoUpdater：56K拨号连接，一般上传速度是多少？

> ID：250332
> 
> 赞同：1
> 
> 时间：2008-10-30T14:25:40.997
> 
> 标签：performance, modem, auto-update

我正在构建一个自动更新程序，我需要知道人们在 56K 调制解调器上获得什么样的上传速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T14:29:47.510

理论上 33.6 kbit/s 上传 = 4.2 kB/s[1]。

根据自己的经验，我会说一半:)

[1] [http://en.wikipedia.org/wiki/ITU-T_V-Series_Recommendations#Simultaneous_transmission_of_data_and_other_signals](http://en.wikipedia.org/wiki/ITU-T_V-Series_Recommendations#Simultaneous_transmission_of_data_and_other_signals)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T14:30:32.173

调制解调器的速度通常不是不对称的，但我似乎记得 56k 是一种特殊模式，上传只有 @33k。

维基百科在其关于[56k 调制解调器的文章中声明如下](http://en.wikipedia.org/wiki/56k_modem)

“如果使用模拟语音带调制解调器 (V.90)，上传速度为 33.6 kbit/s，使用数字调制解调器 (V.92) 上传速度为 48.0 kbit/s。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:14:36.450

根据我自己的经验，我会说大约一半的下载速度。例如，我通常在家中看到 48k 的下载速度和大约 24k 的上传速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:29:48.150

根据[维基百科](http://en.wikipedia.org/wiki/Modem)，最高（理论）速度为 48kbit/s。这是假设 v.92，很大比例的用户不会拥有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:30:11.300

大约 28.8KI 相信（[来源](http://www.56k.com/cons/downonly.shtml)）。

# sharepoint - 使用 32 位应用程序中的 SPSite 访问 64 位 SharePoint

> ID：250335
> 
> 赞同：3
> 
> 时间：2008-10-30T14:27:18.373
> 
> 标签：sharepoint

我创建了一个在 32 位模式下运行的批处理作业，因为它使用 32 位 COM 对象，这需要连接到 SharePoint 以更新列表。它在我的开发环境中工作，因为它是完整的 32 位。但在我的测试和生产环境中，我们使用 64 位 SharePoint，这就是我从 SPSite 得到的：

```
System.IO.FileNotFoundException: 
  The Web application at http://<my sp host>/ could not be found. 
  Verify that you have typed the URL correctly. 
  If the URL should be serving existing content, the system administrator may need to add a new request URL mapping to the intended application.

at Microsoft.SharePoint.SPSite..ctor(SPFarm farm, Uri req... 
```

这就是我所做的

```
 using (SPSite site = new SPSite(_url))
        {
            using (SPWeb web = site.OpenWeb())
            {
                try
                {
                    SPList list = web.Lists[new Guid(_listID)];
                    SPListItem item = list.GetItemById(id);
                    item[field] = value;
                    item.SystemUpdate(false);
                }
                catch (Exception x)
                {
                    log.Error(x);
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T23:32:23.103

您只需要在 64 位进程中运行批处理作业。问题是 SharePoint 在您的测试和生产环境中有许多 COM 对象，这些对象在您的测试和生产环境中编译为 64 位。SPSite 和 SPWeb 对象实际上包装了 COM 对象，这就是它们在 32 位进程中失败的原因。

一种解决方法是通过其 Web 服务而不是对象模型与 SharePoint 进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T15:23:21.520

我不认为这是一个 32/64 位问题，因为我在 32 位上开发和部署到 64 位时处于相同的情况。（实际上，我们正在运行 32 位和 64 位的 WFE）

由于异常是从 SPSite 构造函数中引发的，因此我将进一步调查您正在运行代码的机器（SP 框）是否真正识别该 URL。

# css - Internet Explorer 为垂直滚动条的宽度创建水平滚动条

> ID：250353
> 
> 赞同：9
> 
> 时间：2008-10-30T14:31:33.043
> 
> 标签：css, internet-explorer, xhtml

包含表格的 div 具有以下 CSS 样式：

```
#formulaAlts {
    float: right;   
    height: 200px;
    overflow: auto;
} 
```

这使得当表格大于 200 像素时，滚动条仅出现在表格中，页面上的其他元素保持不变。伟大的！

现在对于我们的朋友 IE...
在 IE 中，该元素会生成垂直滚动条而不增加包含元素。为了“解决”这个问题，创建了一个水平滚动条。
太糟糕了。而且我不想让它烂...

有任何想法吗？

**--EDIT--**
我发现那行

```
overflow-x: hidden; 
```

强制 IE 忽略水平滚动条。这更好.. 但不完全在那里，因为现在我的桌子的一部分是不可见的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T14:40:12.840

小心。

```
overflow-x 
```

不是最广泛支持的属性。

我倾向于使用带有一些正确填充的包含 div：

CSS：

```
div.scroll {
  overflow:auto;
  padding-right:6px;
  /* I've found 6px to be just right my purposes, but try others*/
} 
```

编辑：您需要在某处添加一个高度属性才能使其工作！我通常在 div.scroll 声明中有一个默认设置，然后针对特定情况（大多数）进行调整。HTML：

```
<div class="scroll" >
  <table>
  <!-- your table stuff in here -->
  </table>
</div> 
```

# bash - rearrange data

> ID：250354
> 
> 赞同：0
> 
> 时间：2008-10-30T14:31:50.750
> 
> 标签：bash, sed, unix

If I have a list of data in a text file seperated by a new line, is there a way to append something to the start, then the data, then append something else then the data again?

EG a field X would become new X = X;

Can you do this with bash or sed or just unix tools like cut?

EDIT:

I am trying to get "ITEM_SITE_ID :{$row['ITEM_SITE_ID']}
" .

I am using this line awk '{ print "\""$1 " {:$row['$1']}
" }'

And I get this "ITEM_SITE_ID {:$row[]}

What have I missed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T14:34:04.613

Awk is often the perfect tool for tasks like this. For your specific example:

```
awk '{ print "new " $1 " = " $1 ";" }' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T14:48:09.687

I think the problem is your single quotes are not properly escaped, which is actually impossible to do.

With sed:

```
sed "s/\(.*\)/\1 = \1;/" 
```

Or in your case:

```
sed "s/\(.*\)/\"\1 :{\$row['\1']}\"/" 
```

And with bash:

```
while read line
do
    echo "\"$line :{\$row['$line']}\""
done 
```

And actually you can do it in awk using bashes $'' strings:

```
awk $'{ print "\\"" $1 " :{$row[\'" $1 "\']}\\"" }' 
```

# mysql - 查询优化技术？

> ID：250355
> 
> 赞同：-1
> 
> 时间：2008-10-30T14:32:12.683
> 
> 标签：mysql, optimization

如何优化已经编写好的查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T14:35:22.770

使用[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)查看发生了什么 - 正在使用哪些索引等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T14:33:32.930

如果您无法更改它们：索引和统计信息。
因此，您不会优化查询，而是优化它们的执行计划。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T14:40:02.823

如果您无法更改查询，那么它实际上取决于您选择的数据库引擎上可用的功能。正如 Ovidiu 所说，您可以使用索引并生成使用统计信息来查看瓶颈所在。

否则，您可以使用物化视图或水平分区等技术。

在开始之前，请确保您知道您的优化目标是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T15:48:54.557

IBM Informix Dynamic Server 支持一项功能，该功能允许您在执行预先存在的 SQL 时将优化器指令添加到它（无需修改应用程序）。[在Informix](http://www.informix.com/)网站上查找“外部指令”以获取更多信息（或 Google 的“site:ibm.com informix 外部指令”）。

# python - 截断不以单词中间结尾的字符串

> ID：250357
> 
> 赞同：44
> 
> 时间：2008-10-30T14:32:20.360
> 
> 标签：python, truncate

我正在寻找一种在 Python 中截断字符串的方法，它不会在单词中间截断字符串。

例如：

```
原文：“这真是太棒了。”
“哑巴”截断：“这是真的……”
“聪明”截断：“这真是……”

```

我正在寻找一种从上面完成“智能”截断的方法。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-30T14:36:03.550

实际上，我在我最近的一个项目中为此编写了一个解决方案。我已经将其中的大部分压缩到更小一点。

```
def smart_truncate(content, length=100, suffix='...'):
    if len(content) <= length:
        return content
    else:
        return ' '.join(content[:length+1].split(' ')[0:-1]) + suffix 
```

发生的情况是 if 语句检查您的内容是否已经小于截止点。如果不是，它会截断到所需的长度，在空格上拆分，删除最后一个元素（这样你就不会截断一个单词），然后将它重新连接在一起（同时添加“...”） .

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-30T14:43:16.343

这是 Adam 解决方案中最后一行的稍微好一点的版本：

```
return content[:length].rsplit(' ', 1)[0]+suffix 
```

（这稍微更有效，并且在字符串前面没有空格的情况下返回更合理的结果。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-30T15:47:04.547

有一些微妙之处可能对您来说是问题，也可能不是问题，例如处理制表符（例如，如果您将它们显示为 8 个空格，但在内部将它们视为 1 个字符），处理各种类型的中断和非打破空白，或允许打破连字符等。如果需要这样做，您可能需要查看 textwrap 模块。例如：

```
def truncate(text, max_size):
    if len(text) <= max_size:
        return text
    return textwrap.wrap(text, max_size-3)[0] + "..." 
```

大于 max_size 的单词的默认行为是破坏它们（使 max_size 成为硬限制）。您可以通过将 break_long_words=False 传递给 wrap() 来更改此处其他一些解决方案使用的软限制，在这种情况下，它将返回整个单词。如果您想要此行为，请将最后一行更改为：

```
 lines = textwrap.wrap(text, max_size-3, break_long_words=False)
    return lines[0] + ("..." if len(lines)>1 else "") 
```

根据您想要的确切行为，还有一些其他选项（例如 expand_tabs 可能会感兴趣）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-30T14:59:41.363

```
def smart_truncate1(text, max_length=100, suffix='...'):
    """Returns a string of at most `max_length` characters, cutting
    only at word-boundaries. If the string was truncated, `suffix`
    will be appended.
    """

    if len(text) > max_length:
        pattern = r'^(.{0,%d}\S)\s.*' % (max_length-len(suffix)-1)
        return re.sub(pattern, r'\1' + suffix, text)
    else:
        return text 
```

或者

```
def smart_truncate2(text, min_length=100, suffix='...'):
    """If the `text` is more than `min_length` characters long,
    it will be cut at the next word-boundary and `suffix`will
    be appended.
    """

    pattern = r'^(.{%d,}?\S)\s.*' % (min_length-1)
    return re.sub(pattern, r'\1' + suffix, text) 
```

或者

```
def smart_truncate3(text, length=100, suffix='...'):
    """Truncates `text`, on a word boundary, as close to
    the target length it can come.
    """

    slen = len(suffix)
    pattern = r'^(.{0,%d}\S)\s+\S+' % (length-slen-1)
    if len(text) > length:
        match = re.match(pattern, text)
        if match:
            length0 = match.end(0)
            length1 = match.end(1)
            if abs(length0+slen-length) < abs(length1+slen-length):
                return match.group(0) + suffix
            else:
                return match.group(1) + suffix
    return text 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-12-29T02:54:59.890

```
>>> import textwrap
>>> textwrap.wrap('The quick brown fox jumps over the lazy dog', 12)
['The quick', 'brown fox', 'jumps over', 'the lazy dog'] 
```

你只需要第一个元素，你就完成了......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-30T14:44:05.170

```
def smart_truncate(s, width):
    if s[width].isspace():
        return s[0:width];
    else:
        return s[0:width].rsplit(None, 1)[0] 
```

测试它：

```
>>> smart_truncate('The quick brown fox jumped over the lazy dog.', 23) + "..."
'The quick brown fox...' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-11-14T22:24:38.247

从 Python 3.4+ 开始，您可以使用[textwrap.shorten](https://docs.python.org/3/library/textwrap.html#textwrap.shorten)。使用 OP 示例：

```
>>> import textwrap
>>> original = "This is really awesome."
>>> textwrap.shorten(original, width=20, placeholder="...")
'This is really...' 
```

> textwrap.shorten（文本，宽度，**kwargs）
> 
> 折叠并截断给定的文本以适应给定的宽度。
> 
> 首先，文本中的空格被折叠（所有空格都被单个空格替换）。如果结果符合宽度，则返回。否则，从末尾删除足够的单词，以便剩余的单词加上占位符适合宽度：

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-26T10:40:28.327

对于 Python 3.4+，我会使用[textwrap.shorten](https://docs.python.org/3/library/textwrap.html#textwrap.shorten)。

对于旧版本：

```
def truncate(description, max_len=140, suffix='…'):    
    description = description.strip()
    if len(description) <= max_len:
        return description
    new_description = ''
    for word in description.split(' '):
      tmp_description = new_description + word
      if len(tmp_description) <= max_len-len(suffix):
          new_description = tmp_description + ' '
      else:
          new_description = new_description.strip() + suffix
          break
    return new_description 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-21T22:26:32.093

如果您实际上可能更喜欢按完整句子而不是按单词截断，请从以下内容开始：

```
def smart_truncate_by_sentence(content, length=100, suffix='...',):
    if not isinstance(content,str): return content
    if len(content) <= length:
        return content
    else:
        sentences=content.split('.')
        cs=np.cumsum([len(s) for s in sentences])
        n = max(1,  len(cs[cs<length]) )
        return '.'.join(sentences[:n])+ '. ...'*(n<len(sentences)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-28T20:12:57.553

C++ 版本：

```
string trim(string s, int k) {
    if (s.size()<=k) return s;
    while(k>=0 && s[k]!=' ')
        k--;
    if (k<0) return "";
    string res=s.substr(0, k+1);
    while(res.size() && (res.back()==' '))
        res.pop_back();
    return res;    
} 
```

# linq - 您今天会为您的数据层选择什么，Linq 或 Subsonic？

> ID：250369
> 
> 赞同：7
> 
> 时间：2008-10-30T14:34:37.763
> 
> 标签：linq, subsonic, data-layers

我们准备开始一个全新的项目，没有遗留代码。我们过去确实使用过 Subsonic，我们对此非常满意。但那是在 Linq 之前。

有没有人不得不面对同样的问题（Linq x Subsonic）？

你的决定是什么？原因是什么？

任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-30T15:06:24.020

**亚音速**

优点：

*   漂亮又简单
*   脚手架

缺点：

*   方法签名通常接受可能被滥用的字符串参数（尽管我们鼓励您使用 DAO 字符串常量）。

记住：

*   需要网站项目来进行无代码、无需干预的模型生成（需要 BuildProvider）。

**链接到 SQL**

优点：

*   IDE 中的语法糖
*   支持 MS
*   在IDE中查看要执行的SQL
*   允许在模型中进行不同级别的摆弄，从自动生成到显式定义再到对象属性。

缺点：

*   复杂的。您需要学习像 DataContext 这样的新概念才能有效。

记住：

*   一些 stackoverflow 用户[质疑 Linq 对 SQL 的持续支持](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)。

还要评估[ADO.NET Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(vs.80).aspx)和[此处](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T14:45:58.273

我喜欢 LINQ 的一件事，我不认为 SubSonic 处理得那么优雅，就是自动处理连接。

```
FROM a in db.Orders
where a.Total > 100
SELECT new {a.Item.Desc, a.Customer.Name}; 
```

会自动生成这样的SQLL

```
select i.DESC, c.NAME 
from  ORDERS o  
inner join ITEMS on o.ItemID = i.ItemID 
inner join CUSTOMERS c on o.CustomerID = c.CUSTOMERID 
where o.TOTAL > 100 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T17:01:56.080

NHibernate 呢？新项目真的不适合吗？不过，来自 Java 的人会觉得它很熟悉，您也可以将它与 .NET 2.0 和 Mono 一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T00:40:06.427

我的经验主要是使用 SubSonic。部署非常简单，您将在半小时内完成 DAL。请记住，这是一把瑞士军刀，因为它是为实用而设计的。基本上，您可以获得每个表生成的类，以及对集合执行延迟加载的能力。您还可以通过框架执行存储过程，因此如果您有复杂的数据结构，您可以从数据库中获取它们并更新您手工制作的类。

我现在已经在 5 个主要项目中使用了它，并且对我变得依赖它的速度印象深刻。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T00:48:29.203

我选择了 Linq，因为它内置在框架中。对于那些说微软不会支持它的人......它将被逐步淘汰的LinqToSql。我相信其中一个计划是将其吸收到实体框架中。

我现在正在使用实体框架。它还使用 linq，基本上它与 linqToSql 完全一样，如果您选择使用它，则具有更大的灵活性和功能。

我倾向于避免使用第 3 方框架和规范，因为它们最终也会消失。我相信他们有更多的机会消亡，因为他们的生命来自于有多少人对它感兴趣并使用它。他们的生活也很大程度上依赖于它的主要作者/贡献者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T15:42:30.030

linq to sql 最大的风险是微软会厌倦它并放弃它。有很多猜测认为这已经发生了，并且只会更新实体框架。Subsonic 不会受此影响，更糟糕的是，您拥有进行编辑的源代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T16:07:03.117

我也有同样的情况。LinQ 更“可视化”，你可以在 vstudio 中做所有事情，甚至 Rob 也承认 subsonic 有一些东西可以与之匹配。

IEnumerable、LINQDatasource（带自动分页）和可视化建模让我选择了 Linq 而不是 Subsonic。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T20:40:53.657

您可能想了解当[MS 停止开发 LINQ to SQ](http://codebetter.com/blogs/david.hayden/archive/2008/10/30/linq-to-sql-gets-kicked-to-the-curb-needs-a-good-home.aspx) L 时会发生什么，因为它似乎正在发生。SubSonics 最新版本比之前的版本更容易创建查询并且更具可读性。

# asp.net - 如何控制 JavaScript Ajax Control Toolkit 吐出的数量？

> ID：250374
> 
> 赞同：2
> 
> 时间：2008-10-30T14:36:15.983
> 
> 标签：asp.net, ajaxcontroltoolkit

使用 Ajax 控件工具包，可以轻松地将所有类型的出色扩展器拖放到控件上，但它们注册了大量的 JavaScript 来执行此操作。

1.  我该如何控制？
2.  如果在`ScriptManager`中`MasterPage`，是否有办法控制脚本在一个页面上的加载，而不是在另一个页面上？

例如：日历扩展器在一个页面上，但它的脚本被加载到作为母版页子页面的每个页面上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:43:41.850

考虑放弃 Ajax 控制工具包。巨大的 JavaScript 负载是我们远离它的原因。您应该考虑使用 jquery 之类的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:14:18.177

我也很想得到这个答案。该工具包盲目插入 javascript，不考虑最佳实践，导致我们的开发人员制作了大得离谱的页面。

该工具包的全部要点是简化设计，但现在我们必须重构整个 UI，因为它提供了“易用性”。我们正在发送巨大的页面，我们无法缓存。

# django - “is_logged_in”模板标签不呈现

> ID：250375
> 
> 赞同：2
> 
> 时间：2008-10-30T14:36:20.413
> 
> 标签：django, templatetags

出于某种原因，模板标签不会在 django admin 的模板中呈现。

这个片段来自： [http ://docs.djangoproject.com/en/dev/ref/templates/api/?from=olddocs#shortcut-for-simple-tags](http://docs.djangoproject.com/en/dev/ref/templates/api/?from=olddocs#shortcut-for-simple-tags)

```
{% if is_logged_in %}Thanks for logging in!{% else %}Please log in.{% endif %} 
```

当放置在admin index.html中时，如果用户已登录，则显示“请登录”

与模板标签相同，无法显示任何应用程序，做任何事情。没有错误/它们也没有得到处理

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T15:02:03.387

这只是一个示例，`is_logged_in`除非您将其放在上下文中，否则该变量实际上并未在任何模板中定义。

如果您添加了该行并得到`Please log in.`它确实意味着该标签正在呈现。如果它失败`if`并转到`else`它显然正在运行。不过，您需要在模板中找到可以实际用于`if`案例的内容。我没有弄乱 newforms-admin 中的管理模板，但取决于它们是否使用 RequestContext 以及您启用了哪些 ContextProcessors - 您可能会说`{% if not request.user.is_anonymous %} ...`或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-22T04:09:47.997

我刚试过这个：

request.user.is_authenticated

就在模板中，按我们的意愿工作！

# .net - LINQ 表达式树图灵完备吗？

> ID：250377
> 
> 赞同：11
> 
> 时间：2008-10-30T14:37:16.293
> 
> 标签：.net, linq, expression-trees, dynamic-language-runtime, turing-complete

正如他们在.Net 3.5中一样。我知道它们在 4.0 中，因为这就是 DLR 的工作方式，但我对我们现在拥有的版本感兴趣。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T18:23:28.917

在 C# 3.0 规范的早期草案中，表达式树部分的边缘有一条评论说：

> 我有一个非常了不起的图灵完备性证明，这个边距太窄而无法包含。

可悲的是，没有人能够找出谁写了它或开发了证明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-01T09:20:33.743

如果不定义将执行树的东西，我们不知道。在 CLR 自己的解释中（当您将它们编译为委托时）它们是。但是如果你将它们翻译成 SQL，它们就不是，你可以用你喜欢的任何属性来创造你自己对它们的令人困惑的解释。

在您决定如何解释它们之前，它们只是数据结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T16:49:03.000

LINQ 表达式树可以表示您可以放入普通 C# 表达式中的任何内容。因此，它们不能用于直接表示`while`循环、`for`循环等。

但是，理论上可以使用 lambda 表达式和递归来执行您可能需要的任何迭代。`Enumerable`在实践中，将方法放入树中可能更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T18:18:19.693

那么，你为什么不尝试证明呢？我敢打赌这是一个有趣的挑战；）

但是表达式树仅代表一个表达式，因此您必须定义允许执行的操作，如 Earwicker 所述。

如果您允许表达式树使用递归，您可以实现重复，即 for 循环等。

然而，无类型的 lambda 演算是图灵完备的 Turing_completeness#Examples 但 Lambda 演算本身不允许递归 Lambda_calculus#Recursion 这一切都很冒险。

我会得出结论，表达式可能是图灵完备的，但需要更熟悉这一点的人来确认它。

# sql - 可以将源代码示例保存在 SQL 数据库中，同时保留所有格式吗？如果是这样的话

> ID：250378
> 
> 赞同：1
> 
> 时间：2008-10-30T14:37:24.843
> 
> 标签：sql, language-agnostic, database-design, code-snippets

源代码示例是否可以保存在 SQL 数据库中**，同时保留所有格式**（制表符、换行符等）？如果是这样，将使用什么数据类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T14:39:48.330

是的，使用`TEXT`类型（或`MEDIUMTEXT`或`LONGTEXT`- 你明白了）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T14:40:04.930

BLOB 类型（varbinary）肯定会起作用，尽管数据库也不应该破坏存储为 varchar 的文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T14:40:40.297

Sql Server 中最好的：nvarchar(max)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T14:41:21.463

您可以将其上传到 blob 数据类型。SQL 2008 具有将整个可执行文件存储在数据库中的能力。

# c# - 有谁知道任何进行音频合成器仿真的 C/C++/C# 代码库？

> ID：250394
> 
> 赞同：18
> 
> 时间：2008-10-30T14:41:07.783
> 
> 标签：c#, c++, c, audio, synthesizer

我正在尝试编写一个软件合成器，以重现由 Moog 和 DX7 等经典合成器发出的声音。有谁知道这样的代码资源？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-30T15:51:02.900

那里有很多 C/C++ 库，大多数不再更新。C# 的内容不多，但我见过几个。我还没有真正使用它们中的任何一个，所以我不能给出任何建议。

我会从[Harmony Central](http://www.harmony-central.com/Computer/Programming/)开始，看看你是否在那里找到任何有用的东西。

或者，在 sourceforge.net 上搜索[模拟合成](http://www.google.co.uk/search?hl=en&q=analog+synthesis+site%3Asourceforge.net&meta=)有很多结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-30T20:17:38.900

[斯坦福大学的CCRMA](http://ccrma.stanford.edu/)可以成为音频软件的良好资源。 [C++ (STK) 中的 Synthesis ToolKit](http://ccrma.stanford.edu/software/stk/)看起来可以帮助您。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-07T00:40:49.990

穆格和雅马哈 DX7 截然不同。DX7 使用 FM 合成，这很奇怪。与 Moog 等常见的 VCO/VCA/VCF 类似物非常不同。

很长一段时间以来，雅马哈一直在为自己的调频专利辩护，但我相信它们都已经过期了。卡西欧的相位失真类似于雅马哈的 FM，并设法避免了雅马哈的愤怒（据我所知）。

我会从选择其中一个开始。自从 Nord Lead 和 Access Virus 出现以来，Virtual Analog（模拟模拟合成器）就风靡一时。而且更容易思考。所以如果你想和时髦的人群一起走，我会走那条路。

从好的限带振荡器开始，制作一个包络发生器，做一个滤波器。如需灵感，请查看[Welsh 的 Synthesizer Cookbook](http://www.synthesizer-cookbook.com/)，了解如何使用双振荡器合成器制作各种声音。我将从实现这些补丁所需的最低功能开始。

FM 和 PD 很狂野。如果你走这条路，那就是将足够多的 FM 操作员以有趣的配置链接在一起，以获得一系列有趣的声音。警告：要避免 FM 中的混叠需要做很多工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-08-07T00:55:21.820

Synthmaker 和 SynthEdit 将为您生成 VST 代码。SynthEdit 肯定会输出未编译的 C++ 源文件，而且是免费的。

[http://www.synthedit.com/](http://www.synthedit.com/)

[http://synthmaker.co.uk/](http://synthmaker.co.uk/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-30T23:05:03.303

最好的办法是查看[KvR 的开发者论坛](http://www.kvraudio.com/forum/viewforum.php?f=33)。他们将能够为您指明最佳开源 DSP/合成引擎的方向，以及一些您可以从中获得灵感的开源 VSTi 插件。不过，这一切都将在 C/C++ 中。目前托管代码中只有最基本的音频合成可用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-07T01:47:44.483

musicdsp网站也有一个很棒的[合成](http://musicdsp.org)[库](http://musicdsp.org/archive.php?classid=1)。大量的 C/C++ 示例代码说明了如何做事。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-30T15:33:42.450

查看[Python 音乐库](https://stackoverflow.com/questions/108848/python-music-library)问题的答案。虽然问题是“Python”，但 Python 是基于 C 构建的。因此，任何可从 Python 中使用的东西都将具有 C 库。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-30T21:30:41.887

[Chuck](http://chuck.cs.princeton.edu)是我所知道的最好的，但它类似于 C++，而不是 C++。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-05-30T22:29:56.927

我编写了一个简单的合成器库作为 iPhone 应用程序的一部分。也许它也可以满足您的合成器需求。也许不是。 [http://mobilesynth.googlecode.com/svn/trunk/mobilesynth/Classes/synth/](http://mobilesynth.googlecode.com/svn/trunk/mobilesynth/Classes/synth/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-10-05T17:54:52.580

[这些教程](http://martin-finke.de/blog/tags/making_audio_plugins.html)（尤其是从第 8 部分开始）涵盖了用 C++ 编写经典减法合成器的所有部分：振荡器、包络、滤波器和 LFO。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-30T14:42:09.013

我在[BASS 库](http://www.un4seen.com/)上取得了一些成功，但是当我上次使用它时，它的 .Net 支持有点粗糙。它主要是低级流编码等，但它确实支持一些 DX8 效果。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-14T14:59:11.117

您可能想查看有关 CodeProject 的两篇文章。Leslie Stanford 用 C# 创建了一个 Synth 工具包（据我所知，它是完全托管的）。

[C# Synth 工具包 - 第 I 部分](http://www.codeproject.com/KB/audio-video/synthtoolkitparti.aspx) [C# Synth 工具包 - 第 II 部分](http://www.codeproject.com/KB/audio-video/synthtoolkitpartii.aspx)

另外，我刚刚发现[这个 StackOverflow Question](https://stackoverflow.com/questions/36567/beginner-digital-synth)有一些很好的链接，虽然它与 Java 相关

# python - 如何使用 SQLAlchemy 声明性语法指定关系？

> ID：250398
> 
> 赞同：3
> 
> 时间：2008-10-30T14:41:50.980
> 
> 标签：python, sqlalchemy

我找不到有关如何使用 SQLAlchemy 的声明性语法指定关系的任何适当文档。它不受支持吗？也就是说，我应该使用“传统”语法吗？
我正在寻找一种在更高级别指定关系的方法，避免与外键等混淆。我只想声明“addresses = OneToMany(Address)”并让框架处理细节。我知道Elixir 可以做到这一点，但我想知道“普通”SQLA 是否也可以做到。
谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T17:37:28.440

假设您指的[是声明性插件](http://www.sqlalchemy.org/docs/04/plugins.html#plugins_declarative)，我要说的所有内容都通过示例记录在案：

```
class User(Base):
    __tablename__ = 'users'

    id = Column('id', Integer, primary_key=True)
    addresses = relation("Address", backref="user")

class Address(Base):
    __tablename__ = 'addresses'

    id = Column('id', Integer, primary_key=True)
    user_id = Column('user_id', Integer, ForeignKey('users.id')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T20:19:52.803

查看[声明性文档](http://www.sqlalchemy.org/docs/05/reference/ext/declarative.html)的“配置关系”部分。没有“OneToMany”那么高，但比完全指定关系要好。

```
class Address(Base):
    __tablename__ = 'addresses'

    id = Column(Integer, primary_key=True)
    email = Column(String(50))
    user_id = Column(Integer, ForeignKey('users.id')) 
```

# rule-engine - 规则引擎 - 优点和缺点

> ID：250403
> 
> 赞同：76
> 
> 时间：2008-10-30T14:42:51.757
> 
> 标签：rule-engine

我正在审核一个使用所谓的[规则引擎](http://en.wikipedia.org/wiki/Business_rules_engine)的项目。简而言之，这是一种从应用程序代码中外部化业务逻辑的方法。

这个概念对我来说是全新的，我对此持怀疑态度。在过去几年听到人们谈论[贫血域模型后，我质疑规则引擎方法。](http://www.martinfowler.com/bliki/AnemicDomainModel.html)对我来说，它们似乎是削弱域模型的好方法。例如说我正在做一个与规则引擎交互的java webapp。然后我决定我想要一个基于相同域的 Android 应用程序。除非我希望 Android 应用程序也与规则引擎交互，否则我将不得不错过已经编写的任何业务逻辑。

由于我还没有任何经验，只是好奇，我有兴趣了解使用规则引擎的利弊？我能想到的唯一优点是您不需要重建整个应用程序只是为了更改一些业务规则（但实际上，有多少应用程序真的有这么多的更改？）。但是使用规则引擎来解决这个问题对我来说听起来就像在猎枪伤口上贴创可贴一样。

更新 - 自从写了这篇文章之后，这位大神 Martin Fowler 在[博客上写了一篇关于使用规则引擎的文章](http://martinfowler.com/bliki/RulesEngine.html)。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-31T18:07:50.187

我见过的大多数规则引擎都被系统代码视为黑匣子。如果我要构建一个领域模型，我可能希望某些业务规则是领域模型固有的，例如告诉我对象何时具有无效值的业务规则。这允许多个系统共享域模型，而无需复制业务逻辑。我可以让每个系统使用相同的规则服务来验证我的域模型，但这似乎削弱了我的域模型（正如问题中所指出的那样）。为什么？因为我不是始终在所有系统中始终如一地执行我的业务规则，而是依靠系统程序员来确定何时应该执行业务规则（通过调用规则服务）。如果域模型完全填充给您，这可能不是问题，但如果您'

还有另一类业务规则：决策。例如，保险公司可能需要对承保申请人的风险进行分类并得出保费。您可以将这些类型的业务规则放置在您的域模型中，但是通常需要针对此类场景进行集中决策，并且实际上非常适合面向服务的架构。这确实引出了为什么是规则引擎而不是系统代码的问题。规则引擎可能是更好选择的地方是负责决策的业务规则随着时间的推移而变化（正如其他一些答案所指出的那样）。

规则引擎通常允许您在不重新启动系统或部署新的可执行代码的情况下更改规则（无论您从供应商那里收到什么承诺，请确保您在非生产环境中测试您的更改，因为即使规则引擎完美无瑕，人类仍在改变规则）。如果你在想，“我可以通过使用数据库来存储变化的值来做到这一点”，你是对的。规则引擎不是做新事物的神奇盒子。它旨在成为一种提供更高级别抽象的工具，因此您可以减少对重新发明轮子的关注。许多供应商更进一步，让您创建模板，以便业务用户可以填补空白，而不是学习规则语言。

关于模板的一个特别注意事项：模板永远不会比没有模板的情况下编写规则花费更少的时间，因为模板必须至少描述规则。计划更高的初始成本（就像您要构建一个系统，该系统使用数据库存储更改的值而不是直接在系统代码中编写规则） - 投资回报率是因为您节省了系统代码的未来维护.

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-12-29T19:20:29.270

我认为您对贫血域模型的担忧是正确的。

我已经看到了两个在我工作的生产环境中运行的著名商业 Rete 规则引擎的应用程序。我认为一个是成功的，另一个是失败的。

成功的应用程序是一个决策树应用程序，由约 10 棵树组成，每棵树约 30 个分支点。规则引擎有一个允许业务人员维护规则的 UI。

不太成功的应用程序有大约 3000 条规则被撞到规则数据库中。没有人知道添加新规则时是否存在冲突规则。对 Rete 算法的了解很少，产品的专业知识也离开了公司，所以它变成了一个不可触及、不可重构的黑匣子。部署周期仍然受到规则更改的影响——规则更改时必须进行完整的回归测试。记忆也是一个问题。

我会轻举妄动。当规则集大小适中时，很容易理解更改，例如上面给出的简单电子邮件示例。一旦规则的数量攀升至数百个，我认为您可能会遇到问题。

我还担心规则引擎会成为您应用程序中的单例瓶颈。

我认为使用对象作为划分规则引擎空间的一种方式没有任何问题。在我看来，在遵循私有规则引擎的对象中嵌入行为似乎没问题。当规则引擎需要不属于其对象一部分的状态才能正确触发时，问题就会出现。但这只是设计困难的另一个例子。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-30T15:03:41.527

在某些情况下，规则引擎可以提供很多价值。

首先，许多规则引擎以更具声明性的方式工作。一个非常粗略的例子是 AWK，您可以在其中将正则表达式分配给代码块。当文件扫描器看到正则表达式时，代码块被执行。

你可以看到，在这种情况下，如果你有一个大的 AWK 文件，并且你想添加另一个“规则”，你可以很容易地转到文件底部，添加你的正则表达式和逻辑，然后完成它。具体来说，对于许多应用程序，您并不特别关心其他规则在做什么，并且这些规则并不真正相互操作。

因此，AWK 文件变得更像是“规则汤”。这种“规则汤”的性质让人们非常关注他们的领域，而很少关心系统中可能存在的所有其他规则。

例如，Frank 对总额超过 1000 美元的订单感兴趣，因此他将他感兴趣的规则系统放入其中。“如果 order.total > 1000 THEN 给 Frank 发送电子邮件”。

同时，Sally 想要来自西海岸的所有订单：“IF order.source == 'WEST_COAST' THEN email Sally”。

因此，您可以在这个微不足道的、人为的案例中看到，一个订单可以满足两个规则，但两个规则彼此独立。来自西海岸的 1200 美元订单通知了弗兰克和莎莉。当弗兰克不再担心时，他会简单地将他的排除从汤中剔除。

对于许多情况，这种灵活性非常强大。像这种情况一样，它也可以向最终用户公开以获取简单的规则。使用高级表达式和轻量级脚本。

现在，很明显，在一个复杂的系统中，可能会发生各种相互关系，这就是为什么整个系统没有“完成规则”的原因。某个地方的某个人将负责不失控的规则。但这并不一定会降低这样一个系统可以提供的价值。

请注意，这甚至不涉及专家系统之类的东西，其中规则触发规则可以创建的数据，而是更简单的规则系统。

无论如何，我希望这个例子展示了规则系统如何帮助增强更大的应用程序。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-30T14:57:25.533

我见过的规则引擎最大的优点是它让业务规则所有者实现业务规则，而不是让程序员承担责任。即使您有一个敏捷流程，您不断从利益相关者那里获得反馈并经历快速迭代，它仍然无法达到通过让制定业务规则的人员也实施它们可以实现的效率水平。

此外，如果规则嵌入在代码中，您不能低估删除可能由简单规则更改导致的重新编译-重新测试-重新部署循环的价值。通常有几个团队参与为构建添加祝福，而使用规则引擎可以使很多事情变得不必要。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-30T15:38:07.403

我为客户编写了一个规则引擎。最大的胜利是包括所有利益相关者。引擎可以运行（或重放）查询并以文本解释正在发生的事情。业务人员可以查看文本描述并快速指出规则、例外和其他特殊情况中的细微差别。一旦涉及到业务方面，验证就会变得更好，因为很容易获得他们的输入。此外，规则引擎可以独立于应用程序代码库的其他部分，因此您可以跨应用程序使用它。

缺点是一些程序员不喜欢学习太多。规则引擎和你放入其中的规则，以及实现它们的东西，可能有点麻烦。尽管一个好的系统可以轻松地处理病态和扭曲的逻辑网络（或者经常是不合逻辑的；），但它并不像编写一堆`if`语句那么简单（不管一些头脑简单的规则引擎做什么）。规则引擎为您提供了处理规则关系的工具，但您仍然必须能够在脑海中想象所有这些。有时就像生活在电影*巴西*一样。:)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-30T15:05:49.870

它（与其他一切一样）取决于您的应用程序。对于某些应用程序（通常是那些永远不会改变的应用程序，或者规则最适合现实生活中的常数，即不会显着改变，例如物理属性和公式）使用规则引擎没有意义，它只是引入了额外的复杂性，并要求开发人员拥有更大的技能组合。

对于其他应用程序，这确实是一个好主意。以订单处理（从发票到处理货币交易的任何东西）为例，某些相关法律或法规（在司法意义上）时不时会发生微小的变化，要求您满足新的要求（例如销售税） ，经典）。与其试图强迫你的旧应用程序进入这种突然之间你必须考虑销售税的新情况，而以前你没有考虑，更容易调整你的规则集，而不是不得不干预潜在的大你的代码集。

然后，您当地政府的下一个修正案要求报告特定标准内的所有销售，而不是您也必须进入并添加。最后，您将得到非常复杂的代码，当您转身并想要恢复规则之一的效果而不影响所有其他规则时，这些代码将被证明非常难以管理......

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-30T15:13:44.597

到目前为止，每个人都对规则引擎非常积极，但我建议读者保持警惕。当问题变得有点复杂时，您可能会突然发现整个规则引擎变得不合适，或者比使用更强大的语言复杂得多。此外，对于许多问题，规则引擎将无法轻松检测到大大减少评估条件的运行时和内存占用的属性。在相对较少的情况下，我更喜欢规则引擎而不是依赖注入框架或更动态的编程语言。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-30T15:20:12.603

“但说真的，有多少应用程序真的有这么多的变化？”

老实说，我开发的每个应用程序都经历了从概念到部署后的严格工作流程和/或逻辑变化。这是“维护”编程的第一大原因......

现实情况是，您无法预先考虑所有事情，这就是敏捷流程的原因。此外，在测试中发现之前，BA 似乎总是错过一些重要的东西。

规则引擎迫使您真正将业务逻辑与表示和存储分开。此外，如果使用正确的引擎，您的 BA 可以根据需要添加和删除逻辑。正如 Chris Marasti-Georg 所说，这让 BA 承担了责任。但更重要的是，它允许 BA 准确地得到他们所要求的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-31T18:19:11.083

规则引擎是可配置应用程序的胜利，如果可以避免，您不希望进行自定义构建。他们还擅长集中大量规则库，[Rete](http://en.wikipedia.org/wiki/Rete_algorithm)等算法可以有效地快速匹配大型规则集。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-05-18T19:03:36.320

已经有很多好的答案，但想补充几点：

1.  在自动化任何复杂的决策时，关键的事情很快就变成了你管理而不是执行所涉及的逻辑的能力。规则引擎对此无济于事——您需要考虑业务规则管理系统具有的规则管理功能。大多数商业和开源规则引擎已经演变成具有存储库、报告规则使用情况、版本控制等的规则管理系统。规则存储库，结构化为可以编排以做出业务决策的连贯规则集，比任何一个都更容易管理数千行代码或规则汤。
2.  有许多方法可以使用声明性的、基于规则的方法。使用规则来管理 UI 或作为定义流程的一部分可能非常有效。然而，规则方法最有价值的用途是自动化业务决策，并将其作为松散耦合的决策服务提供，这些服务接受输入、执行规则并返回答案——决策。这些服务可以回答其他服务的问题，例如“这个客户是否有良好的信用风险”或“我应该为这个订单给这个客户什么折扣或者”这个客户目前最好的交叉销售是什么。这些决策服务可以使用规则管理系统非常有效地构建，并允许随着时间的推移轻松集成分析，许多决策都可以从中受益。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-03-22T17:32:54.970

我认为规则、流程和数据引擎（又名数据库）本质上是相似的。但是，出于某种原因，我们从不说对持久性子系统进行黑盒化是不好的。

其次，从我的 POV 来看，贫血模型不是行为**执行轻的模型，而是****行为本身**轻的模型。描述域模型对象中可用行为的实际方法不必由对象本身完成。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-10T06:18:55.997

根据我在规则引擎方面的经验，最大的复杂性在于：

1.  从 OOP POV 来看，在重构影响规则的代码时重构和测试以声明性语言编写的规则是一件非常痛苦的事情。
2.  通常我们应该总是考虑规则的执行顺序，当规则很多时会变得一团糟。
3.  一些小的更改可能会触发规则的错误行为，从而导致生产错误。在实践中，并不总是可以通过预先测试来涵盖所有情况。
4.  在其他对象中使用的规则变异对象也增加了复杂性，导致开发人员将它们分成多个阶段。

# .net - Console.WriteLine 在哪里调试？

> ID：250404
> 
> 赞同：31
> 
> 时间：2008-10-30T14:42:59.557
> 
> 标签：.net, debugging, console

我发现[了这个问题](https://stackoverflow.com/questions/122778/capture-console-output-for-debugging-in-vs)，但我想知道的是不同的 - Console.WriteLine 的输出在调试时会去任何地方吗？我知道要让它进入输出窗口，我应该使用 Debug.WriteLine() 或其他方法，但是标准 Console.WriteLine() 去哪里了？

**编辑** 调试时，您看不到黑色控制台窗口/测试日志 - 所以**真正的问题是**如何在调试期间访问/查看此输出？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-04-07T07:58:09.640

控制台可以将其输出重定向到任何文本编写器。如果您实现了一个写入 Diagnostics.Debug 的文本编写器，那么一切就绪。

这是一个写入调试器的文本编写器。

```
using System.Diagnostics;
using System.IO;
using System.Text;

namespace TestConsole
{
    public class DebugTextWriter : TextWriter
    {
        public override Encoding Encoding
        {
            get { return Encoding.UTF8; }
        }

        //Required
        public override void Write(char value)
        {
            Debug.Write(value);
        }

        //Added for efficiency
        public override void Write(string value)
        {
            Debug.Write(value);
        }

        //Added for efficiency
        public override void WriteLine(string value)
        {
            Debug.WriteLine(value);
        }
    }
} 
```

由于它使用 Diagnostics.Debug，因此它会遵守您的编译器设置，以确定它是否应该写入任何输出。此输出也可以在 Sysinternals DebugView 中看到。

以下是你如何使用它：

```
using System;

namespace TestConsole
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.SetOut(new DebugTextWriter());
            Console.WriteLine("This text goes to the Visual Studio output window.");
        }
    }
} 
```

如果您想在发布模式下编译时在 Sysinternals DebugView 中查看输出，可以使用写入 OutputDebugString API 的 TextWriter。它可能看起来像这样：

```
using System.IO;
using System.Runtime.InteropServices;
using System.Text;

namespace TestConsole
{
    public class OutputDebugStringTextWriter : TextWriter
    {
        [DllImport("kernel32.dll")]
        static extern void OutputDebugString(string lpOutputString);

        public override Encoding Encoding
        {
            get { return Encoding.UTF8; }
        }

        //Required
        public override void Write(char value)
        {
            OutputDebugString(value.ToString());
        }

        //Added for efficiency
        public override void Write(string value)
        {
            OutputDebugString(value);
        }

        //Added for efficiency
        public override void WriteLine(string value)
        {
            OutputDebugString(value);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-01-16T01:49:10.733

`NullStream`，它被定义为“没有后备存储的流”。所有的方法什么都不做或什么也不返回。它是一个内部类`Stream`。以下代码取自微软的源代码。

基本上，当`Console`第一次调用其中一个写入方法时，会调用 Windows API 函数`GetStdHandle`以获取“标准输出”。如果没有返回句柄，`NullStream`则创建并使用一个。

塞缪尔的回答是正确的，并提供了一般信息。无论项目类型如何，要实际重定向控制台输出，请使用`Console.SetOut(New System.IO.StreamWriter("C:\ConsoleOutput.txt"))`，这是一个简单的示例。

### 将控制台、调试和跟踪定向到文件

直接回答你的问题。使用`ConsoleTraceListener`and a`StreamWriter`将所有三个输出定向到文件。我仅将以下内容用于开发。

```
 Dim oLogFile As New System.IO.StreamWriter("C:\ConsoleOutput.txt")
    oLogFile.AutoFlush = True 'so we do not have to worry about flushing before application exit

    Console.SetOut(oLogFile)

    'note, writing to debug and trace causes output on console, so you will get double output in log file
    Dim oListener As New ConsoleTraceListener
    Debug.Listeners.Add(oListener)
    Trace.Listeners.Add(oListener) 
```

### 空流

```
[Serializable]
private sealed class NullStream : Stream {
    internal NullStream() { }

    public override bool CanRead {
        get { return true; }
    }

    public override bool CanWrite {
        get { return true; }
    }

    public override bool CanSeek {
        get { return true; }
    }

    public override long Length {
        get { return 0; }
    }

    public override long Position {
        get { return 0; }
        set { }
    }

    // No need to override Close

    public override void Flush() {
    }

    public override int Read([In, Out] byte[] buffer, int offset, int count) {
        return 0;
    }

    public override int ReadByte() {
        return -1;
    }

    public override void Write(byte[] buffer, int offset, int count) {
    }

    public override void WriteByte(byte value) {
    }

    public override long Seek(long offset, SeekOrigin origin) {
        return 0;
    }

    public override void SetLength(long length) {
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-05-21T21:33:59.247

对我来说最好的解决方案是将 Console.WriteLine() 更改为 System.Diagnostics.Debug.WriteLine()。例如：

```
 catch (DbEntityValidationException dbEx)
 {
    foreach (var validationErrors in dbEx.EntityValidationErrors)
    {
       foreach (var validationError in validationErrors.ValidationErrors)
       {
          System.Diagnostics.Debug.WriteLine("Property: {0} Error: {1}", validationError.PropertyName, validationError.ErrorMessage);
       }
    } 
```

然后，您可以在输出窗口中将错误视为对象。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-30T15:15:55.060

Debug 和 Release 不控制您是否获得控制台窗口。这由项目的输出类型控制。（属性 -> 应用程序 -> 输出类型）。控制台应用程序将为您提供一个控制台窗口，该窗口将可视化并接收来自窗口的输入到 System.Console 中的错误、输入和输出流中。

System.Console 类公开了几个属性和方法，用于与其流交互，即使您看不到它。最值得注意的是：Error、In、Out、SetError()、SetIn()、SetOut() 以及 Read 和 Write 方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-13T04:59:34.710

我实际上会在这个问题上支持詹姆斯。

[http://www.csharp411.com/console-output-from-winforms-application](http://www.csharp411.com/console-output-from-winforms-application)

详细描述它（如果将输出定向到文件就足够了，那么您可以轻松使用 amissico 的方法）。他们描述的大多数方法都模仿了[http://dslweb.nwnexus.com/~ast/dload/guicon.htm中描述的方法](http://dslweb.nwnexus.com/~ast/dload/guicon.htm)

如前所述，将您的项目更改为“控制台”项目将产生类似的效果。干杯!

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-15T12:01:46.367

Visual Studio 启动 Windows 程序 ( [`/target:winexe`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/target-winexe-compiler-option))，并将 stdin/stdout/stderr*重定向*到命名管道。每个管道的另一端归 VS 调试器所有，在 stderr/stdout 上读取的任何内容都显示在调试输出窗口中。因此，`Console.Write`自动神奇地出现在 VS 调试输出中。*请注意，如果您附加*到已启动的进程，则不会发生这种情况（因为重定向技巧只能在进程启动时完成）。

启动控制台程序 ( [`/target:exe`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/target-exe-compiler-option)) 时不会发生此重定向，因此会`Console.Write`转到实际控制台（或`stdout`重定向的任何地方）。

我找不到任何记录这种行为的东西，这只是我调查 VS 如何启动和调试应用程序的结论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T14:44:33.767

它进入控制台（标准输出）或控制台设置的流。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-12T14:37:26.343

正如已经评论过OP的问题：

**无需编写额外代码**

在 Visual Studio 最上面的菜单中选择

> 调试 > 窗口 > 输出

输出窗口仅在调试模式下可见，并且会显示所有内容，例如 `Console.WriteLine("Debug MyVariable: " + MyVariable)` 当您到达它们时。

在之前设置断点（单击所选行开头的行号之前的不同颜色的空白区域），调试（F5），然后逐行执行代码（F11），直到完成为止。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-30T15:08:39.677

即使在 WinForms 应用程序中，您也可以创建控制台窗口，但您必须通过 P/Invoke 才能直接调用 Win32 方法。请参阅[http://pinvoke.net/default.aspx/kernel32/AllocConsole.html](http://pinvoke.net/default.aspx/kernel32/AllocConsole.html)

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-10-30T14:44:59.397

Console.writeline() 转到控制台窗口：黑色命令/dos 提示符。

# ruby-on-rails - 如何为 habtm 字段实现具有自动完成功能的文本字段？

> ID：250408
> 
> 赞同：1
> 
> 时间：2008-10-30T14:43:26.000
> 
> 标签：ruby-on-rails, scriptaculous

我尝试了 Rails Cookbook 中的示例并设法让它工作。但是，`text_field_with_auto_complete`仅适用于一个值。

```
class Expense < ActiveRecord::Base
  has_and_belongs_to_many :categories
end 
```

在新的费用视图中 rhtml

```
<%= text_field_with_auto_complete :category, :name %> 
```

第一类自动完成作品。如何让它适用于多个类别？例如 Category1、Category2
*预期行为：如 StackOverflow 标签文本框*

**更新：**
在一些帮助和更多的修补下，我得到了多个逗号分隔的自动完成显示（将在此处发布代码示例）。
*但是在选择时，最后一个值会替换 text_field_with_auto_complete 的内容。*因此，当通过自动完成选择第二个类别时，文本框将显示 Category2 而不是 Category1，Category2。任何想法如何纠正这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T14:09:59.587

如果您只是尝试支持每个字段的多个自动完成实例，则可以使用符号 :token 将分隔符传递给自动完成选项。这提供了一个分隔符以允许多个结果。Stackoverflow 将使用 :token => ' ' （引号之间应该有一个空格，但自动格式化正在删除它）来指定多个 take 之间的分隔符处的空格，尽管 ',' 更常用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T17:00:38.213

这不是你的问题，但我不会再推荐使用 HABTM。您应该创建一个连接模型并使用 has_many :through。（在您的情况下，您将创建一个名为 ExpenseCategoryAssignment 或其他东西的新模型）

问题是 HABTM 会产生 Rails 不喜欢的歧义，而且它往往会暴露你在其他情况下看不到的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-30T14:56:15.077

您需要像这样使用“数据分隔符”参数
`<%= f.autocomplete_field :brand_name, welcome_autocomplete_brand_name_path, "data-delimiter" => ', ' %>`

# asp.net - asp.net 会话信息是否存储在 cookie 中？

> ID：250410
> 
> 赞同：10
> 
> 时间：2008-10-30T14:44:17.823
> 
> 标签：asp.net, session

如果我写`Session["asdf"] = 234;`

在我的 asp.net 网络应用程序中，这是否意味着客户端将在其浏览器上存储一个 cookie？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-30T14:45:30.037

是的，但 234 不会存储在 cookie 中。cookie 将仅包含唯一 ID（例如`lit3py55t21z5v55vlm25s55`）。每次 ASP.NET 看到该唯一 ID 时，它都会查找相应的会话信息。

如果您不想使用 cookie，可以将会话 ID 放在 URL 中。阅读这篇[MSDN 文章中](http://msdn.microsoft.com/en-us/library/ms178581.aspx)关于 Cookieless SessionIDs 的部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T14:46:10.410

会话变量保存在服务器上，但用户将拥有一个标识其会话的 cookie。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T14:48:41.887

在大多数情况下，您的浏览器中都会存储一个 SessionID 作为 cookie。ASP.NET 确实允许“无 cookie”会话（但老实说，我从未见过在现实世界中使用它）：

[http://msdn.microsoft.com/en-us/library/aa479314.aspx](http://msdn.microsoft.com/en-us/library/aa479314.aspx)

# windows-vista - 我可以在 Windows Vista 上使用任何帐户将数据写入到哪里，并且可以从所有其他帐户查看？

> ID：250415
> 
> 赞同：4
> 
> 时间：2008-10-30T14:45:39.460
> 
> 标签：windows-vista, uac

我需要写一些注册数据（唯一的电脑号，和对应的激活码）。

计算机编号需要从*其他*程序和*所有*帐户中可见（{Admin|Non Admin} 用户访问控制已打开 {On|Off} ）

仅从管理员帐户写入计算机编号和激活码是可以接受的，但它需要可从任何其他帐户读取。

目前（我需要对此进行更多测试）似乎如果 CN 和激活码是在关闭 UAC 的情况下写入的，那么当用户打开 UAC 时，计算机编号是不可见的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T14:48:31.777

在安装期间，您可以将其写入程序的安装文件夹，因为以后可能不会更改（需要写入权限）。作为标准用户，您仍然应该具有读取权限。不然怎么运行程序？:)

或者，您可以使用 All Users Application Data 文件夹。在 XP 中，这通常会映射到`C:\Documents and Settings\All Users\Application Data\YourApp\`. 我面前没有Vista，所以我现在不能给你确切的位置，但它应该是一个非常简单的映射。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T14:58:26.250

返回的位置

`Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData)`

这与 Joel 在他的消息中提到的位置相同，但这是获取该值的正确方法（它在 XP 和 Vista 之间更改了位置，并且可能会再次更改）。

（当然，这是针对 .NET 的。对于 Win32，您希望使用`SHGetFolderPath`带有 CSIDL_COMMON_APPDATA 的函数）

# c# - Visual Studio 宏 - 代码生成语言

> ID：250421
> 
> 赞同：1
> 
> 时间：2008-10-30T14:47:13.947
> 
> 标签：c#, vb.net, visual-studio, macros, code-generation

我正在为 Visual Studio 编写一个宏，它将生成一些代码。

我希望为 C# 和 VB 生成宏，有没有办法确定活动（当前）文档中使用的是什么语言？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T14:50:33.550

您是否考虑过使用[T4](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)？

T4 是直接内置于 Visual Studio 中的代码生成器。如果您使用 C#，您将有一个子 .cs 文件，或者如果您使用 VB，则有一个子 .vb 文件。那是保存生成结果的文件。这与您在 Visual Studio 其他地方看到的用于表达模板/生成的文件与 .designer 文件的关系的视觉隐喻相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:12:40.903

我刚刚找到了一些代码，它似乎是一个隐藏的属性：

```
DTE.ActiveDocument.Language = "CSharp" 
```

# c# - c# 中类、函数、变量等的正确命名符号是什么？

> ID：250423
> 
> 赞同：4
> 
> 时间：2008-10-30T14:47:40.920
> 
> 标签：c#, coding-style, naming-conventions

我是一名没有正式计算背景的网络开发人员，我已经编写代码几年了，但是每次我需要创建一个新的类/函数/变量时，我都会花大约两分钟的时间来决定一个名字然后是如何输入。

例如，如果我编写一个函数来总结一堆数字。我应该叫它吗

```
Sum()
GetSum()
getSum()
get_sum()
AddNumbersReturnTotal() 
```

我知道有一种正确的方法可以做到这一点，我只需要一个指向良好权威来源的链接：D

**[作为c# 编码标准/最佳实践](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices)的副本关闭**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T14:48:37.533

您正在寻找[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T14:52:10.677

类应采用骆驼表示法，首字母大写

```
public class MyClass 
```

C# 中的函数和方法应该以类似的方式运行，但私有方法除外

```
public void MyMethod()
private void myPrivateMethod() 
```

我倾向于做一些不同的变量：

成员变量

```
private int _count; 
```

局部变量

```
int count; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T14:54:33.200

我同意计算与获取的区别：get() 应该用于已经计算的值或以其他方式检索的微不足道的值。

此外，我建议在许多情况下在名称中添加一个名词，这样您计算的总和就很明显了。当然，除非您要添加的名词*是*类名或类型本身。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T14:50:11.790

上述所有的。

我相信官方 C# 指南会说调用它 calculateSum() 因为 getSum() 如果 sum 是一个实例变量将被使用。但这取决于所使用的编码风格以及项目中任何现有代码的编写方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T14:51:36.093

幸运的是，我不相信有一种标准化的方式可以做到这一点。我选择我喜欢的那个，因此它似乎也是我见过的所有其他源代码使用的标准，并使用它运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T14:52:04.530

`Sum()`如果它是公开的并且自己完成工作。

`GetSum()`如果它是公开的并且它从其他地方检索信息。

sum() / getSum() 同上，但用于内部/私有方法。

（嗯......这有点模糊，因为你稍微改变了“Sum”的意思。所以，让我们再试一次。

`XXX`如果 xxx 是一个过程（求和值）。 `GetXXX`如果 xxx 是一个东西。（值的总和）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T15:02:07.070

方法名称是动词。类、字段和属性名称是名词。在这种情况下，`Sum`可以作为动词或名词传递...

`AddNumbersReturnTotal`符合上述定义，但有点长。出于对维护我代码的人（通常是我！）的好意，我尽量避免在标识符中包含多余的单词，并且我尽量避免使用容易打错字的单词。

# .net - 公共方法的返回值和参数是否应该只是同一程序集中的类型？

> ID：250424
> 
> 赞同：2
> 
> 时间：2008-10-30T14:47:49.627
> 
> 标签：.net, assemblies, return-value

我想知道公共方法及其返回值的最佳实践是什么。从引用的程序集中返回类型是否可以，或者我应该确保所有参数和返回值都来自同一个程序集？

我问的原因是我正在将程序集与 ILMerge 合并，我想内部化除主程序集之外的所有程序集，但如果我在主程序集中有公共方法，这似乎是不可能的参数或返回内部程序集中的类型的值。

为了澄清我在说什么，我从 CommonUtils 项目中引用 Oracle.DataAccess，并使用 DbUtils 来创建在 Oracle.DataAccess 中定义的 OracleParameter 类型，这是我想要内部化但不能的程序集。

任何人都可以为我澄清这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T14:50:31.930

返回“字符串”或“IEnumerable”返回值很常见，所以我认为这不是你的问题。

一个好的解决方案可能是返回实现主程序集中定义的接口的对象。

# java - 如何从 JSP 页面加载 COM 对象？

> ID：250434
> 
> 赞同：4
> 
> 时间：2008-10-30T14:50:05.173
> 
> 标签：java, jsp, com, interop, com-interop

我正在开发一个 JSP 应用程序并被迫加载一个 COM 对象。这样的事情能做到吗？

如果是，如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T14:58:41.413

可以使用像[JACOB](http://danadler.com/jacob/)这样的 COM 桥接器。

JACOB 是一个 JAVA-COM 桥接器，它允许您从 Java 调用 COM 自动化组件。它使用 JNI 对 COM 和 Win32 库进行本地调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T14:58:53.380

如果您需要在 Java 端（即服务器）中使用 COM 对象，您将需要[J-Integra](http://j-integra.intrinsyc.com/)或[JNI Wrapper](http://www.teamdev.com/jniwrapper/index.jsf)之类的东西。有几个开源项目可以做类似的事情。

如果您需要在客户端（即浏览器）上使用 COM 对象，那么它与使用普通 HTML 的方式没有什么不同。

# .net - 合并程序集的最佳实践？

> ID：250438
> 
> 赞同：9
> 
> 时间：2008-10-30T14:50:47.747
> 
> 标签：.net, assemblies, ilmerge

我想知道在创建要包含在与依赖项相关的其他项目中的库版本时的启发式方法是什么，以及是否应该包含它们。

我的问题如下：

我有一个 CommonUtilities 库，顾名思义，它提供了一组可以在多个地方使用的实用程序。CommonUtilities 的依赖项包括 log4net.dll（日志框架）和 Oracle.DataAccess.dll（数据库驱动程序）。

我有另一个名为 MyProject 的项目，我想在其中包含 CommonUtilities。MyProject 还依赖于 Oracle.DataAccess。

如果我使用 ILMerge 并将 CommonUtilities 合并到单个程序集 CommonUtilities.dll 中并从 MyProject 中引用它，那么一切都会编译，但我确信我应该从 MyProject 显式引用 Oracle.DataAccess，因为它是一个依赖项，而不是使用合并到 CU 中的程序集。添加对 Oracle.DataAccess 的引用也会导致使用语句不明确，因为引用了两个 Oracle.DataAccess 程序集。

在我的情况下使用 ILMerge /Internalize 会导致编译错误，因为来自内部化的 Oracle.DataAccess 程序集的类型正在从 CommonUtilities 返回，并且它们被标记为内部 MyProject 无法识别返回的类型。

完成这项工作的唯一方法就是不将此特定程序集 (Oracle.DataAccess) 合并到 CommonUtilities 中，而仅从 MyProject 中引用它。这反过来又产生了一个新问题：我应该引用哪个 Oracle.DataAccess.dll - 是否使用 CommonUtils 分发的依赖项？

还有其他方法可以解决这一切吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T20:53:06.060

简短易懂的版本：

> **一个进程中对给定程序集的每个引用都应该引用相同的版本。**

如果你不这样做，你可能会陷入大麻烦，因为应用程序的一部分由于版本不匹配而无法与另一部分通信。

即使使用像 log4net 这样的“真正私有”的东西，您也可能会错过共享配置空间的可能性，例如为应用程序的所有部分使用通用的根记录器。当然，在这种情况下，最后的电话是 - 一如既往 - 与负责的开发人员联系。

另请参阅有关[ILMerge 和 3rd 方程序集](https://stackoverflow.com/q/245429/4918)的其他问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-10T23:05:08.403

我们使用 ILMerge 的最大原因是让我们的混淆步骤更难以逆转。通过使用 /internalize 标志将它们合并在一起，混淆器可以重命名我们合并到父程序集中的公共类和方法。

来自 IL 合并文档：“[Internalize] 控制除了主程序集以外的程序集中的类型是否修改了其可见性。如果为真，则在其程序集之外可见的所有非豁免类型都修改其可见性，以便它们是从合并程序集的外部看不到”

如果程序集是分开的，那么混淆器不会重命名它们。

顺便说一句，Eazfuscator 很棒，而且免费： [http ://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx](http://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-01T01:53:57.157

我们根本不合并库。我看不到将库合并在一起的优势，而只是首先将它们构建在一个程序集中是无法获得的。

我可以看到将库与 EXE 合并的好处。那可能真的很方便。将库合并在一起的问题在于，它们在您的 EXE 中可能具有不同版本的依赖关系，这可能会让同床者感到不舒服。

我不认为将 dll 合并在一起可以被认为是最佳实践，除非您将它们合并到 EXE 中以呈现单个文件而不是多个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T01:35:20.723

我想将一堆本地化程序集放在一个中可能会有一些优势（我什至不确定你能做到）

我不会合并来自其他供应商的库——因为他们通常有自己的许可，并且更新它们需要您重新分发新版本的代码。

如果您有许多库来保持目录整洁，或者确保某些代码始终与主要执行的程序集一起使用，那么合并您自己的库可能是有利的。

我认为 ILMerge 在将库合并到 EXE 时做得更好，这样您就可以拥有一个文件而不是多个文件。

# asp.net - ASP.NET Ajax：Ajax 调用后关闭窗口？

> ID：250450
> 
> 赞同：1
> 
> 时间：2008-10-30T14:55:27.100
> 
> 标签：asp.net, javascript, asp.net-ajax

我正在使用 ASP.NET Ajax。服务器调用完成后如何**告诉浏览器关闭当前窗口**（服务器端代码）？

我设法在服务器方法（在按钮单击处理程序内）中使用 ASP.NET Ajax 的 ScriptManager 方法“RegisterDataItem”来做到这一点：

```
sm.RegisterDataItem(ActionLabel, "action:closewindow") 
```

和一个隐藏的标签并在客户端以这种方式处理它：

```
function PageLoadingHandler(sender, args)
{
    var dataItems = args.get_dataItems();
    if (dataItems['ActionLabel'] == 'action:closewindow') {
        window.close()
    }
}
Sys.WebForms.PageRequestManager.getInstance().add_pageLoading(PageLoadingHandler); 
```

但是感觉**很脏**。必须有一种更优雅的方式来做到这一点。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T15:36:10.247

如果我理解正确，那么在事件处理程序上注册方法应该可以工作`window.close()`。`ScriptManagers` `RegisterStartupScript`有关使用的详细信息，`ScriptManager.RegisterStartupScript`请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)

# c# - .net 控制反转

> ID：250451
> 
> 赞同：6
> 
> 时间：2008-10-30T14:56:00.110
> 
> 标签：c#, .net, dependency-injection, inversion-of-control

我很少听到有人在 .Net[中使用控制反转 (Ioc)](http://martinfowler.com/articles/injection.html)原理。我有一些使用 Java 的朋友在 Spring 和 PicoContainer 中使用了更多的 Ioc。

我了解从您的代码中删除依赖项的原则......但我怀疑它是否更好。

**为什么.Net 程序员不使用（或少用）那些类型的框架？如果你这样做了，从长远来看，你真的发现了积极的影响吗？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T15:01:57.413

很多人在 .NET 中使用 IOC，并且有几个框架可以帮助使用 IoC。您可能在 WinForms 方面看到的较少，因为当您在 Visual Studio 中设计表单时，让容器将所有内容连接在一起更难，但我可以说对于服务器端 .NET 应用程序，我至少在那里工作, IoC 使用非常成功。

为什么在 .NET 中使用它？出于同样的原因，您在其他任何地方都使用它。我最喜欢的两件事是：

*   为 IoC 进行设计倾向于强制执行良好的编码实践——针对接口进行设计、低耦合、高内聚。这也导致了非常容易进行单元测试的类。
*   系统配置通常可以在不重新编译的情况下更改。

其他一些讨论可用于 .NET 的不同 IoC/DI 框架的帖子：

*   [哪些 C#/.net 依赖注入框架值得研究？](https://stackoverflow.com/questions/21288/which-cnet-dependency-injection-frameworks-are-worth-looking-into)
*   [我应该使用哪个依赖注入工具？](https://stackoverflow.com/questions/148908/which-dependency-injection-tool-should-i-use)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T15:03:05.303

我使用[StructureMap](http://www.google.com/search?q=structuremap&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)进行依赖注入，并且最近才开始在[iBATIS.NET](http://ibatis.apache.org/dotnetdownloads.cgi)中使用它来在运行时注入我们的域对象映射器（而**不是**通过 XML 配置文件，不，谢谢！）。

我已经看到了立竿见影的好处。为我们所有的映射器（例如`IPersonMapper`）创建接口，然后添加[Moq](http://code.google.com/p/moq/)允许我快速轻松地编写一些非常棒的无数据库单元测试。

以前（.NET 1.0）我写了自己的插件系统，主要是为了学习反射。从那时起，我在我的项目中实施了某种 IoC。直到最近我才开始使用 IoC 来减少编写单元测试的痛苦。在这一点上，我无法想象以任何其他方式做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T15:05:58.950

直到现在，IoC 在 .Net 中还不是很常见。它与微软以及他们所做的促销活动有关。到目前为止，他们更强调 VS 的 RAD 功能，同时忘记了推广 IoC 和 Di 之类的东西，但现在他们有了自己的称为 Unity 的框架以及他们在 ASP.Net MVC 上所做的工作。

所以我猜大多数人会开始使用这样的东西。因为知道他们可以使用 MS 替代品。

我使用结构图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T15:09:16.493

它变得越来越普遍。我当前的项目使用 Spring，在我之前的项目中我们使用 Castle Windsor。

现在我想使用“约定优于配置”的想法，以防止所有那些复杂的 XML 声明。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T15:13:21.993

有很多与使用 IoC .NET 相关的理论。我认为有相当多的开发人员没有该领域的经验。他们并非来自 Java 背景。他们来自经典的 ASP 和 VB6 背景。此外，微软直到最近才真正推广使用 IoC。

此外，使用 IoC 假设了几件事。首先，您必须了解它的用途以及从中得到什么。其次，您必须开发您的代码，以便实际使用 IoC 容器。

IoC 不仅仅是使用工具箱中的另一个项目。这是关于知道如何使用，知道何时使用它以及成熟的开发人员。

因为它与 .NET 相关，所以我有几个 IoC 容器。我用过 Windsor、StructureMap、Unity，最近还用过 Ninject。但请记住，我还没有在实际应用程序中使用所有这些。我喜欢到处玩耍，看看外面发生了什么。我发现 IoC 容器 .NET 的市场相当不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T17:46:16.210

我使用它来允许我的单元测试用 Mock Classes（模拟实际的生产类）代替上游依赖对象，这样我的单元测试实际上只执行和测试一个 class.method 中的代码，它们被编写来测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T09:15:56.820

试试 LinFu.IOC 2.0：

[http://www.codeproject.com/KB/cs/LinFu_IOC.aspx](http://www.codeproject.com/KB/cs/LinFu_IOC.aspx)

它是目前最灵活的 IOC 容器之一，并且与 Ninject 一样，无需维护 XML 文件。然而，与 Ninject 不同的是，LinFu 不会强迫您编写任何绑定代码来将您的依赖项连接在一起。看一看！:)

# jquery - 如何在 JQuery 调用中使用变量

> ID：250463
> 
> 赞同：4
> 
> 时间：2008-10-30T14:58:37.827
> 
> 标签：jquery, variables

我在尝试着

```
function doRow(rowNum)
{

 $.ajax({
   url: "z.html",
   cache: false,
   success: function(html){
   $('#result + rowNum + "'").append(html);
 }
}); 
```

这似乎不起作用。

当我走到那一步时，我还想将变量传递给数据属性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T15:00:22.097

试试这个：

```
function doRow(rowNum)
{

 $.ajax({
   url: "z.html",
   cache: false,
   success: function(html){
   $('#result'+rowNum).append(html);
 }
}); 
```

# .net-3.5 - 为什么要调用 SqlClient.SqlDataReader Close() 方法呢？

> ID：250468
> 
> 赞同：18
> 
> 时间：2008-10-30T14:58:56.687
> 
> 标签：.net-3.5, sqlconnection

SqlClient.SqlDataReader 是否是 .NET 托管对象？为什么我们必须调用 Close() 方法显式关闭打开的连接？这样一个对象的范围不应该自动关闭吗？垃圾收集器不应该清理它吗？

请帮助我了解这里的最佳做法是什么。

我在[这里](https://stackoverflow.com/questions/247311/sqldatareader-in-this-scenario-will-the-reader-get-closed)看到了一个相关的问题，它进一步说明了我在使用 Web 应用程序时遇到的问题。问题是我们的连接用完了。详细的错误在这里：

```
Exception: System.InvalidOperationException
Message: Timeout expired. The timeout period elapsed prior to obtaining a connection from the pool. This may have occurred because all pooled connections were in use and max pool size was reached.
Source: System.Data 

at  System.Data.SqlClient.SqlConnectionPoolManager.GetPooledConnection(SqlConnectionString options, Boolean& isInTransaction)
at  System.Data.SqlClient.SqlConnection.Open() 
```

为了解决这个问题，我必须明确关闭所有 SQLDataReader 对象。

我正在使用 .NET Framework 3.5

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-30T15:02:00.080

当然，它会在超出范围时被收集（如果它们没有其他引用）。当它被收集时，它将通过它的 Dispose() 方法关闭。然而，你永远不知道 GC 什么时候会释放东西；如果你不关闭你的读者，你很快就会用完与数据库的可用连接。

## 延伸阅读

*   O'Reilly 的[ADO.NET 连接池解释](http://www.ondotnet.com/pub/a/dotnet/2004/02/09/connpool.html)
*   Microsoft 的[使用 DataReader 检索数据对 DataReader](http://msdn.microsoft.com/en-us/library/haa3afyz(VS.71).aspx)进行了总体概述。

~ 威廉·莱利-兰德

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-30T15:13:18.200

@弗罗斯特中尉

> 作为我们商店的一项规则，我们将所有数据库调用显式包装在 Try...Finally 块中，finally 部分捕获并关闭数据连接。为自己省去一个主要的故障排除头痛是值得的。

我有类似的规则，但我要求实现 IDisposable 的对象使用“使用”块。

```
using (SqlConnection conn = new SqlConnection(conStr))
{
     using (SqlCommand command = new SqlCommand())
     {
        // ETC
     } 
} 
```

using 块在离开作用域时立即调用 Dispose，即使出现异常也是如此。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-30T15:18:20.080

一种好的做法（只要您不重复使用连接）是将命令行为添加到 SqlDataReader 以在连接被释放时关闭连接：

```
SqlDataReader rdr = cmd.ExecuteReader( CommandBehavior.CloseConnection ); 
```

添加这将确保在关闭 SqlDataReader 对象（或垃圾收集）时关闭与数据库的连接。

但是，正如我之前所说，如果您计划在同一方法中将数据库连接重新用于另一个操作，则不希望这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-30T18:22:00.833

我想其他人都这么说，但我想清楚一点：

超出范围并不意味着立即进行垃圾收集。

您的应用程序需要在多个级别上“玩得很好”。关闭连接可以帮助您做到这一点。让我们来看看其中的几个级别。

1：您不依赖垃圾收集。理想情况下，垃圾收集不应该存在。但确实如此。但可以肯定的是，您不应该依赖它。

2：您没有保持数据库连接。虽然连接通常是池化的，但您发现存在限制。持有比必要时间更长的时间会使您的应用程序成为坏苹果。

3：您没有产生网络流量。每个数据库连接本质上都是一个 TCP 连接。保持打开状态可能会产生类似于“你还在那里吗？”的网络流量。是的。小流量是的，但在拥挤的网络上，这是不好的做法。SQL Server 本身正在使用资源来保持连接。其他人试图访问该 sql 服务器的资源可以更好地利用。

在考虑数据库访问时，您还必须考虑网络资源。某些获取数据的方法很糟糕，因为它们会带来不必要的东西。ADO 的早期版本因这类东西而臭名昭著。当您只需要数据时带回架构信息。当然，只有几个连接，这不是问题。但是从什么时候开始，任何数据库都只有几个连接。所以想想这些东西，尽量不要滥用资源。

当您的 Web 应用程序只有 100 个用户时，您可能不在乎。但是100,000呢？始终考虑扩展时会发生什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-30T17:41:50.787

如果您没有明确关闭它，那么它会坐在那里等待垃圾收集器“收集”它......只有在这种情况发生之后，它才会被释放回 ADO.Net 连接池以供另一个 Connection.Open 重用请求，因此在所有介入的时间内，任何其他连接请求都必须创建一个全新的请求，即使有一个非常好的未使用的可以使用...

根据 GC 运行之前的时间以及正在执行的数据库请求的数量，您可能会用完与数据库的可用连接。

但是Command.ExecuteReader() 方法上有一个可选参数，称为CommandBehavior。这是一个枚举，其值为：CommandBehavior.Default、CommandBehavior.SingleResult、CommandBehavior.SchemaOnly、CommandBehavior.KeyInfo、CommandBehavior.SingleRow、CommandBehavior.SequentialAccess 和 CommandBehavior.CloseConnection

此枚举有一个 FlagsAttribute 属性，该属性允许按位组合其成员值。这是与此处相关的最后一个值 (CommandBehavior.CloseConnection)。它告诉 Command 对象在数据读取器关闭时关闭连接。 [http://msdn.microsoft.com/en-us/library/system.data.commandbehavior.aspx](http://msdn.microsoft.com/en-us/library/system.data.commandbehavior.aspx)

不幸的是，默认值不是在数据读取器关闭时关闭连接，但是当您希望您的方法在完成后立即将连接释放回池时，您可以（并且应该）将此参数作为 CommandBehavior.CloseConnection 传递它...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-30T15:05:05.690

术语“托管代码”所指的“托管”资源是内存。就是这样。任何其他稀缺资源都需要使用一次性模式进行包装，包括数据库连接。

这对您来说是个问题的原因是垃圾收集器在超出范围时不会为每个对象运行。不那么频繁地收集更多物品会更有效率。因此，如果您等待收集器处理您的对象（是的，如果您最终实现了 idisposable ），您可能会保持许多数据库连接打开的时间比您意识到的要长得多。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-30T15:15:53.313

问题不是连接，而是SqlDataReader 持有的SQL 游标。如果您尝试打开第二个而不关闭第一个，它将引发异常。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-30T15:09:28.177

还要考虑抛出异常时会发生什么 - 如果您突然被迫退出正在执行的代码，您永远不知道连接是否会关闭。

作为我们商店的一项规则，我们将所有数据库调用显式包装在 Try...Finally 块中，finally 部分捕获并关闭数据连接。为自己省去一个主要的故障排除头痛是值得的。

# database - 数据库驱动的前端控制器/页面管理好还是坏？

> ID：250469
> 
> 赞同：1
> 
> 时间：2008-10-30T14:59:01.023
> 
> 标签：database, model-view-controller, front-controller

我目前正在一个自定义框架中工作，该框架使用数据库设置一个页面对象，其中包含有关模块、视图、控制器等的信息，前端控制器使用这些信息来处理 MVC（显然）模式中的路由等。

处理数据库中页面的最初原因是因为我们需要能够在管理界面中动态创建新的登录页面，并且因为我们还需要创建可以附加其他动态对象的 onLoad 和 onUnload 事件。

然而，昨天读完这篇[文章后](https://stackoverflow.com/questions/249281/embedding-html-code-in-stored-procedures)，我想知道我们是否应该把这个处理移出数据库，让它像其他框架一样全是文件结构和代码驱动，这样就可以在没有数据库成为组件的情况下测试页面。

我目前正在考虑是否废弃自定义框架并使用标准框架之一并扩展它（这是现在最有可能的），但我想知道是否扩展框架以像我们一样通过数据库处理页面请求现在还是我们应该简单地使用框架附带的任何路由/处理机制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T15:51:22.710

通常我对允许在“玩具”应用程序中进行的操作非常宽容，但我认为无论如何都应该避免一些坏习惯。数据库是强大的工具，通过存储过程使用相当强大的语言来完成您需要做的任何事情......但它们确实应该用于存储和扩展对数据的访问，并执行您的低级数据一致性规则。

将业务逻辑放入数据层在几年前很常见，但关注点分离确实有助于应用程序在其生命周期内的可维护性。

请注意，使用数据库而不是文件系统来存储页面模板并没有错。两者之间的界限在未来会更加模糊，我有一个系统，所有模板都在数据库中，因为低预算托管以及需要如何保存动态生成的内容的问题。只要您的框架可以轻松地从文件或字段中提取模板并处理它们，这两种方式都无关紧要。

另一方面，昨天的帖子是关于*直接*从数据库生成 UI 层元素（至少，我是这么读的），而不是一个不寻常的模板存储位置。出于上述原因，*这是一个令人深感担忧的问题……数据库被锁定到 Web 应用程序，并且仅限于 Web 应用程序。*

第三方面，如果您的系统运行良好且易于扩展，则永远不要*太*在意别人的建议。每个用例都略有不同。如果您的可维护性没有受到影响并且可以满足业务需求，那就足够了。

# amazon-ec2 - 单实例 Amazon EC2

> ID：250470
> 
> 赞同：6
> 
> 时间：2008-10-30T14:59:35.017
> 
> 标签：amazon-ec2, amazon-web-services

我们在单个 EC2 服务器实例上运行一个轻量级 Web 应用程序，这可以满足我们的需求，但我们想知道是否监控它并在它出现故障时重新启动它。

我们有一个单独的非亚马逊服务器，我们想用它来监控 EC2 并在必要时启动一个新实例并关闭旧实例。我们所有的用户数据都在 Elastic Storage 上，所以我们不太担心丢失任何东西。

我想知道是否有人有以这种方式使用 EC2 的经验，特别是自动化启动新实例的过程？我们从头开始创建东西没有问题，但它似乎应该是一个已解决的问题，所以我想知道是否有人有任何提示、链接、脚本、教程等要分享。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T15:19:44.973

您应该看看[puppet](http://reductivelabs.com/trac/puppet/wiki/PuppetIntroduction)及其对[AWS](http://reductivelabs.com/trac/puppet/wiki/Recipes/AmazonWebService)的支持。我还会查看[RightScale AWS 库](http://rightaws.rubyforge.org/)以及这篇关于[使用 RightScale 脚本启动服务器的](http://blog.rightscale.com/2007/08/07/configuring-servers-with-rightscripts/)文章。您可能还会发现这篇关于[使用 EC2 提供 Web 服务的](http://www.mikebrittain.com/blog/2008/07/19/web-hosting-on-ec2/)文章很有用。我做了类似的事情，但没有外部监控，节点监控自己并在不再需要时关闭，然后当有更多工作要做时会启动一个新节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T22:12:18.797

几点：

### 您必须必须备份您的 Amazon EBS 卷。

他们声称“更好”的可靠性，但不是 100%，而且它比 S3 的“12 9”耐用性低了几个数量级。S3 耐用性 >> EBS 耐用性。这是事实。EBS 支持“快照”功能，该功能可以高效且增量地备份您的存储到 S3。此外，使用 EBS 快照，您只需为压缩增量付费，这通常远小于分配的卷大小。在另一种生活中，我向像您这样“认为”EBS 是“耐用”并信任它的任务关键型数据库的唯一副本的小型客户发送了丢失量的电子邮件……这令人心碎。

### 您的问题：自动启动新实例

您提到的设计路径相对未走；这就是为什么...许多公司运行冗余的“热备用”实例，其中第二个实例已启动并运行。这允许在“故障”（可能是硬件或软件）的情况下快速故障转移（秒）。“冷备用”的问题在于，很难让机器保持最新状态并准备好从旧盒子停止的地方拿起。更重要的是，验证备件是否能够成功恢复您的生产服务是很棘手的。硬件比未经测试的软件系统更可靠。测试测试测试。如果你没有测试你的故障转移，它就不起作用。

启动新 EBS 实例的简单自动化很容易，几乎是微不足道的。它只是一个调用[EC2 命令行工具](http://aws.amazon.com/developertools/351)的单行 bash 脚本。棘手的是最重要的一切。这样的解决方案几乎意味着完全 100% 自动化的部署过程。这都是特定于您的应用程序的。您的应用程序能否拉取运行所需的所有数据（可能存储在 S3 中？）。您今天可以杀死您的实例并使用 0.000 个手动设置/安装步骤启动一个新实例吗？

或者，您可能正在谈论我称之为***“重新实例化 EBS 卷”***的场景：

1.  EC2 盒死机（根卷为 EBS）
2.  强制分离 EBS 卷
3.  使用 EBS 卷启动新的 EC2 实例

...这***主要是***有效的。问题：

*   不能防止 EBS 故障，无论是总卷丢失还是可用性丢失
*   假设一切正常，恢复时间为 O（分钟）
*   您的服务需要配置为自动重启。如果 Nginx 没有运行，把盒子拿回来是没有好处的。
*   您的 DNS 路由或其他服务或任何需要更改 IP 地址的东西。这可以通过 ElasticIP 解决。
*   您的主机 SSH 密钥是如何处理的？同名，新主机密钥在收到主机密钥更改的强烈警告时可能会破坏基于 SSH 的自动化。
*   我没有这方面的证据（除了看到它发生一次），但我相信 EC2/EBS _already_does_this_ 自动用于从 EBS 实例启动

同样，这里的困难部分在你的盘子上。您今天可以停止生产服务并在新实例上可靠地启动它吗？如果是这样，故事的 EC2 部分[真的很简单](http://aws.amazon.com/developertools/351)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T12:42:46.877

作为一个侧面：

> 我们所有的用户数据都在 Elastic Storage 上，所以我们不太担心丢失任何东西。

如果您还没有这样做，我强烈建议您定期将 EBS（弹性块存储）快照到 S3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-29T04:15:00.383

您可以使用最小/最大/所需数量为 1 的自动缩放组。将实例放在 ELB 后面，并让自动缩放组由 ELB 健康节点计数触发。这允许您通过 cloudwatch 和 ELB 健康检查进行内置监控。每当出现问题时，实例都会被自动缩放服务替换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-16T05:23:09.647

1.  如果您没有选中“防止意外终止”，您可能想要这样做。
2.  即使您为您的实例禁用了“详细监控”，您仍然应该看到您的实例的“StatusCheckFailed”指标，您可以在该指标上配置警报（在 CloudWatch 仪表板中）
3.  您的应用程序（托管在不同的服务器中）应该收到警报并使用 AWS API（或 CLI）启动实例

由于您已防止意外终止，因此您永远不需要生成新实例。

# javascript - StackOverflow 如何知道问题何时有新答案？

> ID：250473
> 
> 赞同：11
> 
> 时间：2008-10-30T15:00:01.690
> 
> 标签：javascript, ajax, forums

如果已经问过这个问题，我很抱歉，请指出我正确的方向。

我想知道是否有人对 StackOverflow 在添加帖子时如何在问题顶部弹出“已发布 n 个新答案，加载新答案”的事情有任何见解。这对我的论坛网站来说似乎是一个非常有用的功能，我想知道它是如何完成的。我假设一些 ajax 或某种高级 javascript。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-30T15:01:30.317

看看这个 SO 博客文章：[https ://blog.stackoverflow.com/2008/10/solving-the-fastest-gun-in-the-west-problem/](https://blog.stackoverflow.com/2008/10/solving-the-fastest-gun-in-the-west-problem/)

> 也就是说，从这个讨论中得出的一个可实施的建议是在您撰写答案时发出类似 GMail 的主动通知。我们同意这个功能请求，所以 Jarrod 实现了它。以下是它的工作原理：
> 
> 1.  当您开始撰写回复时，会创建一个计时器。
> 2.  每分钟，页面都会检查自己是否有新的答案出现。
> 3.  如果有新答案出现，通知栏会告诉您有多少，并主动为您更新页面。
> 4.  答案更新以 AJAX 样式执行，因此它们不会中断您当前的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T15:02:14.980

猜测它使用 jQuery 计时器对象每*n*秒查询一次 JSON Web 服务。查看[http://docs.jquery.com](http://docs.jquery.com)和[http://geekswithblogs.net/JuanDoNeblo/archive/2007/10/24/json_in_aspnetajax_part2.aspx](http://geekswithblogs.net/JuanDoNeblo/archive/2007/10/24/json_in_aspnetajax_part2.aspx)。

多么讽刺……在我写这篇文章的时候已经发布了一个答案。

# mysql - 在 PHP 的类中访问数据库的最佳方法是什么？

> ID：250491
> 
> 赞同：1
> 
> 时间：2008-10-30T15:04:18.610
> 
> 标签：mysql, database, oop

我有一个会话类，需要将会话信息存储在 MySQL 数据库中。显然我需要在这个类的方法中查询数据库。一般来说，我可能需要同时连接多个数据库，并且可能已经连接或未连接到该数据库。

鉴于此，访问会话类或任何类的数据库的最佳方式是什么。创建一个类来管理连接有意义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T15:10:32.590

我建议查看此演示文稿，其中讨论了访问数据库时的最佳实践：

[http://laurat.blogs.com/talks/best_practices.pdf](http://laurat.blogs.com/talks/best_practices.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T15:10:34.493

数据库连接是何时何地可以安全使用单例模式的一个典型例子；但是，如果您知道会话对象将是一个全局对象并且它将是您需要创建数据库连接的唯一位置，那么您可以非常安全地将数据库连接存储为会话类的实例成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T15:12:38.717

是的，我会使用[DBAL](http://en.wikipedia.org/wiki/DBAL)。您可以自己编写，也可以使用现有的解决方案，如[PDO](http://us.php.net/manual/en/class.pdo.php)。即使使用现有解决方案，您也可能希望编写一个使用[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)的包装类，以便可以与代码的所有部分共享单个连接。

# .net - VB.NET：即使没有事件处理程序也会引发事件吗？

> ID：250494
> 
> 赞同：8
> 
> 时间：2008-10-30T15:05:17.110
> 
> 标签：.net, vb.net, performance, events

我有一个类可以下载、检查和保存一些大型 XML 文件。有时我希望 UI 告诉我发生了什么，但有时我会使用类并忽略事件。所以我在十几个地方放置了这样的代码行：

```
RaiseEvent Report("Sending request: " & queryString)

RaiseEvent Report("Saving file: " & fileName)

RaiseEvent Report("Finished") 
```

我的问题是——如果没有人在监听它们，这些事件会减慢我的代码吗？他们还会开火吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T16:49:17.243

我自己的回答：

在 VB.NET 中，如果没有设置处理程序来侦听该事件，则该事件不会触发。

我做了一个小实验，其中引发事件的代码传递函数的结果，并且该函数仅在设置了事件处理程序来处理事件时才执行。

```
RaiseEvent Report(GetMyString()) 
```

换句话说，我是说`GetMystring`除非处理程序实际存在，否则不会调用上面的函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T16:30:00.497

没有魔法，隐藏在 RaiseEvent 下的代码完全符合您的预期，它遍历一组处理程序，并执行每个处理程序。检查是否有任何处理程序的开销是微不足道的，不用担心。

如果您的**真正**问题是“为了节省时间，我是否应该在引发事件之前检查事件是否有处理程序？” . . . 那么答案是“不”，这样做你将一无所获。

此外，除非您需要，否则不要担心优化（请参阅此[Wikipedia 条目](http://en.wikipedia.org/wiki/Code_optimization)以了解原因。）

回复：打电话`GetMystring()`。

是的，这与您在 C# 中引发事件的方式有关，在 C# 中，您在引发事件之前检查处理程序的存在。例如：

```
if (MyEvent != null)
    MyEvent(GetMyString()) 
```

顺便说一句，很好的实验:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T15:07:13.207

可能会有少量开销，但我不会担心。当然，实际行动将成为绩效驱动因素。

附带说明：在 C# 中引发没有处理程序的事件实际上会导致引发异常。VB.Net 没有这个问题 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T21:15:19.757

> 如果您的真正问题是“为了节省时间，我是否应该在引发事件之前检查事件是否有处理程序？” . . . 那么答案是“不”，这样做你将一无所获。

在 C# 中，如果您不检查事件是否为 null 并且没有注册处理程序，您将收到 NullReferenceException。

# vba - Excel 无法启用引用/缺少的功能

> ID：250499
> 
> 赞同：5
> 
> 时间：2008-10-30T15:06:07.030
> 
> 标签：vba, excel

我有一个有效的 excel 工作簿，其中包含 VBA 代码和宏来帮助输入数据。

我使用日历来捕获日期并从单元格中读取数据。该应用程序在我的机器上 100% 运行（应用程序是在我的机器上开发的，但为了在办公室中的兼容性`2007`而保存）。`.XLS – 97/2000`当我将文件交给其他人时，日历控件和`TRIM()`功能不起作用。

在我的机器上，我可以进入参考部分，但在办公室的所有其他机器上，该`references`功能是灰色的。知道为什么像日历这样的通用对象和像`trim()`这样的通用功能在某些机器上不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T15:33:37.303

其他 PC 上的新工作簿中的引用是否显示为灰色？引用通常仅在代码运行时显示为灰色。日历控件（是？）臭名昭著的是不能在各种不同的版本上运行，因此开发了各种变通方法，例如[Allen Browne 的日历弹出窗口](http://allenbrowne.com/ser-51.html)。Trim 是 Visual Basic for Applications 的一部分，您可能会发现一旦删除了缺少的 Calendar 控件引用，该功能就已修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:31:25.263

日历控件有许多不同的版本，您需要根据他们机器上的版本来构建它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:53:23.977

VBA 将自动更新对最新版本的引用。示例：如果我引用 Office 10.0，而您的计算机上安装了 Office 12.0，则引用将自动从 10 更新到 12。但它不会*降级*它们。因此，如果您引用了 Office 12.0 并将其部署在只有 Office 10.0 的计算机上，那么您的代码将会中断。

有两种方法可以解决这个问题。如果您想保留早期绑定，那么您将需要获取正在使用的最旧版本库的副本。然后引用该文件。

通常的替代方法是进行后期绑定。然而，对于嵌入式控件，这可能更具挑战性。

# cookies - 除了 URL 重写之外，还有哪些选项可用于在不使用 cookie 的情况下维护会话？

> ID：250501
> 
> 赞同：1
> 
> 时间：2008-10-30T15:06:37.187
> 
> 标签：cookies, url-rewriting

我在 Stack Overflow 和网络上的其他地方看到了各种 URL 重写选项，但我很想知道是否还有其他选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T15:09:50.423

这是猜测，因为 Cookies 和 URL 重写是两大类，但从技术上讲，我认为有可能：

*   使用 javascript 进行一些大规模的黑客攻击，捕获所有链接并提交包含信息的表单。
*   根据 IP 跟踪服务器上的会话

两者都有明显的缺点和漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T15:08:05.107

会话变量？在工作中，我们不允许在没有大量权限的情况下使用非会话 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:09:30.457

您可以通过 cookie 或通过查询参数来维护状态。浏览器需要能够以某种方式将数据传递给 Web 服务器，而这是仅有的两个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T15:10:31.607

我想这取决于您使用的技术。在 ColdFusion 中，您可以在没有 cookie 的情况下维护会话变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T15:10:40.483

使用客户端数据库存储，例如 Google Gears (sqlite) ？Html5 预计会包含一个（[webkit 已经做到了](http://webkit.org/blog/126/webkit-does-html5-client-side-database-storage/)）。

# asp.net - 创建搜索功能的最佳方法 ASP.NET 和 SQL 服务器

> ID：250503
> 
> 赞同：2
> 
> 时间：2008-10-30T15:07:08.790
> 
> 标签：asp.net, sql, search

我有一个包含多个表的 SQL 数据库，并且我正在创建一个搜索功能。除了对不同的表进行多个查询之外，还有其他方法可以实现所述搜索功能吗？

* * *

我可能应该补充一点，我的很多内容都是由数据库驱动的，以使维护更容易。Lucene 不能解决这个问题，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T15:12:13.227

不同的考虑方法：

1）多个查询预烘焙，就像你描述的那样。

2) 您根据用户输入的标准动态组合的动态 sql。

3）如果涉及文本，基于SQL Server全文搜索或Lucene。

在我的开源应用程序 BugTracker.NET 中，我同时执行 2 和 3（使用 Lucene.NET）。

[我在这里记录](http://www.ifdefined.com/blog/post/2009/02/Full-Text-Search-in-ASPNET-using-LuceneNET.aspx)了我如何使用 Lucene.NET：http://www.ifdefined.com/blog/post/2009/02/Full-Text-Search-in-ASPNET-using-LuceneNET.aspx

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T15:18:11.407

既然您已经用 Asp.net 标记了这个问题，我想您想搜索您的网页。在这种情况下，您可以使用 Indexing Server 轻松执行自由文本搜索，以搜索生成的 html 和您设置的任何关键字。

正如 Corey Trager 所建议的，使用 Lucene.NET 也是一种选择。它以快速且易于使用而著称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:34:21.933

尽管其他答案提供了很好的建议，例如使用 Lucene，但我更喜欢使用自定义缓存方法。

因此，对于我帮助创建的网站，我们每隔几个小时将可搜索的数据从许多表中缓存到一个包含以下列的简单表中：

*   网址
*   项目/页面名称
*   主要关键词
*   纯文本内容
*   更新日期

然后我会编写我的 SQL 语句来使用不同的函数来搜索这个字段来确定排名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T16:57:27.290

您可能想查看我写的这篇关于编写全文查询的帖子，它是用 C# 编写的，但它很容易移植，或者只是将它放在一个库中并作为它使用。

[如何在c#中建立一个SQL全文索引搜索词](http://www.muonlab.com/web-development/how-to-build-an-sql-full-text-index-search-term-in-c/ "如何在c#中建立一个SQL全文索引搜索词")

# c# - 使用派生自 System.ComponentModel.Component 的类实现 Dispose()

> ID：250506
> 
> 赞同：2
> 
> 时间：2008-10-30T15:08:18.897
> 
> 标签：c#, dispose

我创建了一个从 Component 派生的类：

```
public class MyComponent: System.ComponentModel.Component
{

} 
```

我看到 Visual Studio 为我放入了这段代码：

```
protected override void Dispose(bool disposing)
{
    try
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
    }
    catch
    {
        throw;
    }
    finally
    {
        base.Dispose(disposing);
    }
} 
```

`MyComponent`有一个成员是 a `DataSet`，也许还有其他一些成员实现`IDisposable`. 如果有的话，我需要用`Dispose()`方法修改什么以确保正确清理东西？感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T15:13:32.787

改变：

```
if (disposing && (components != null))
{
     components.Dispose();
} 
```

成为：

```
if (disposing && (components != null))
{
    _dataset.Dispose();
    components.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T15:15:13.267

检查任何一次性成员对象，如果它们不为空，则将它们处理掉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-07T00:45:18.527

我想出了这门课：

```
public class DisposableComponentWrapper : IComponent
{
    private IDisposable disposable;

    public DisposableComponentWrapper(IDisposable disposable)
    {
        this.disposable = disposable;
    }

    public DisposableComponentWrapper(IDisposable disposable, ISite site)
        : this(disposable)
    {
        Site = site;
    }

    public void Dispose()
    {
        if (disposable != null)
        {
            disposable.Dispose();
        }
        if (Disposed != null)
        {
            Disposed(this, EventArgs.Empty);
        }
    }

    public ISite Site { get; set; }

    public event EventHandler Disposed;
} 
```

和 IContainer 的扩展方法：

```
public static void Add(this IContainer container, IDisposable disposableComponent)
{
    var component = (disposableComponent as IComponent);
    if(component == null)
    {
        component = new DisposableComponentWrapper(disposableComponent);
    }
    container.Add(component);
} 
```

这可能会帮助那些愿意为他们的表格争取可支配资源的人。

注意：我不确定 IComponent.Disposed 的行为，[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.icomponent.disposed.aspx)并没有说明在此接口的实现中应该如何调用它，文档听起来像是在谈论注册到事件的客户端代码而不是应该何时由该接口的实现触发。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-12-17T21:19:29.120

将一次性用品包装在组件中并将它们添加到`components`集合中。dispose 模式的生成实现将正确地处理它们。

```
public partial class MyComponent : System.ComponentModel.Component
{
    private readonly System.Data.DataSet _dataSet;

    public MyComponent(System.Data.DataSet dataSet)
    {
        _dataSet = dataSet ?? throw new System.ArgumentNullException(nameof(dataSet));
        components.Add(new DisposableWrapperComponent(dataSet));
    }
} 
```

是这样定义的`DisposableWrapperComponent`：

```
using System;
using System.ComponentModel;

public class DisposableWrapperComponent : Component
{
    private bool disposed;

    public IDisposable Disposable { get; }

    public DisposableWrapperComponent(IDisposable disposable)
    {
        Disposable = disposable ?? throw new ArgumentNullException(nameof(disposable));
    }

    protected override void Dispose(bool disposing)
    {
        if (disposed) return;

        if (disposing)
        {
            Disposable.Dispose();
        }

        base.Dispose(disposing);

        disposed = true;
    }
} 
```

^(受[@smoothdeveloper](https://stackoverflow.com/users/17049/smoothdeveloper)回答的启发。)

如果您需要能够重置数据集，则将生命周期管理封装在属性中效果很好。

```
using System;
using System.ComponentModel;
using System.Data;

public partial class MyComponent : Component
{
    private const string DataSetComponentName = "dataSet";

    public DataSet DataSet
    {
        get => (DataSet)((DisposableWrapperComponent)components.Components[DataSetComponentName])
                ?.Disposable;
        set
        {
            var lastWrapper = (DisposableWrapperComponent)components.Components[DataSetComponentName];
            if (lastWrapper != null)
            {
                components.Remove(lastWrapper);
                lastWrapper.Dispose();
            }

            if (value != null)
            {
                components.Add(new DisposableWrapperComponent(value), DataSetComponentName);
            }
        }
    }

    public MyComponent(DataSet dataSet)
    {
        DataSet = dataSet ?? throw new ArgumentNullException(nameof(dataSet));
    }
} 
```

我在实现一个 Windows 服务时使用了`OnStart`它，该服务在`OnStop`.

# excel - VBA SQL 查询表错误

> ID：250508
> 
> 赞同：4
> 
> 时间：2008-10-30T15:08:47.150
> 
> 标签：excel, vba

确切地说，我正在尝试从 ACD 呼叫数据系统中提取数据`Nortel Contact Center 6.0`，如果您使用该特定系统，我试图捕获的是每日呼叫数据。但是，当我使用此代码时

（sCW 是一个普通的字符串等于`eCallByCallStat`，sDate 是

`dDate = Format(Month(deffDate) & "/" & iStartDay & "/" & Year(deffDate), "mm/dd/yyyy")`

`sDate = Format(dDate, "yyyymmdd")` )

```
sSql = ""
        sConn = "ODBC;DSN=Aus1S002;UID=somevaliduser;PWD=avalidpassword;SRVR=Thecorrectserver;DB=blue"
        sSql = "SELECT " & sCW & sDate & ".Timestamp, "
        sSql = sSql & sCW & sDate & ".CallEvent, "
        sSql = sSql & sCW & sDate & ".CallEventName, "
        sSql = sSql & sCW & sDate & ".CallID, "
        sSql = sSql & sCW & sDate & ".TelsetLoginID, "
        sSql = sSql & sCW & sDate & ".AssociatedData, "
        sSql = sSql & sCW & sDate & ".Destination, "
        sSql = sSql & sCW & sDate & ".EventData, "
        sSql = sSql & sCW & sDate & ".Source, "
        sSql = sSql & sCW & sDate & ".Time " & vbCrLf
        sSql = sSql & "FROM blue.dbo.eCallByCallStat" & sDate & " " & sCW & sDate & vbCrLf
        sSql = sSql & " ORDER BY " & sCW & sDate & ".Timestamp"

        Set oQT = ActiveSheet.QueryTables.Add(Connection:=sConn, Destination:=Range("A1"), Sql:=sSql)

        oQT.Refresh BackgroundQuery:=False

        Do While oQT.Refreshing = True
        Loop" 
```

当我运行它时，我在 oQT.Refresh BackgroundQuery:=False 收到一条奇怪的错误消息

奇怪的是它工作了一个月左右然后就死了

* * *

@loopo 我实际上将 ' 添加`""`到连接字符串中并且实际上将用户名和密码硬编码到不带引号的查询中，为了在发布中清晰起见，我已经删除了它们

* * *

我收到的错误是

> 运行时错误“-2147417848(80010108)”：对象“_QueryTable”的方法“刷新”失败

* * *

感谢您的输入凯文。数据库永远不会处于没有人访问它的状态，它是一个全天候 24 x 7 并且始终连接到客户端的呼叫处理系统。至少这是我的理解。如果我通过 Excel 手动执行此操作，我永远不会出错，或者只有当我通过宏执行此操作时才会出现任何问题，这是否会给我带来问题，导致我认为是我的代码导致了问题。

我按照制造商的建议通过 ODBC 连接到数据库，但我想知道他们是否曾设想过这种事情。

我将看看我是否可以将其用于 .NET 项目，看看是否有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:56:52.313

首先，如果您要连接到非通用数据库（SQL Server、Oracle 等），**请尝试使用特定于它的数据库连接**。

其次，既然你说这个错误来来去去，你能测试一下当没有其他人访问系统时它是否仍然发生？当您的查询试图读取它们时**，某些行被锁定可能是一个问题......**

第三，**要么切换到不同的报告方法，要么找到不同的方式来获取数据**。Excel 中对此类调用存在限制。虽然，是的，它确实允许您连接到数据库并提取数据，但如果您正在处理大量数据、复杂查询或挑剔的数据库连接，您可能会发现它不够用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T16:48:18.243

查询本身似乎有错误...

如果您可以单步执行您的代码并发布 sSql 的内容，它可能有助于解决问题......

当你经历它时，确保引号被正确地转义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:59:03.120

看起来您的连接字符串中有双引号。这可能是由于网站的一些解析

您可能应该使用“双双”引号设置 sConn，如下所示：

```
sConn = "ODBC;DSN=Aus1S002;UID=""somevaliduser"";PWD=""avalidpassword"";SRVR=""Thecorrectserver"";DB=blue" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T02:48:34.257

您收到的实际错误消息是什么？

在 FROM 子句中，您是否尝试从 2 个不同的表中选择，在不同的命名空间中具有相同的名称？（在这种情况下，我认为它们应该用逗号而不是空格分隔）

还是应该有另一个'。而不是 FROM 子句中的空格？或者它是一个别名？

您需要为每个字段指定表格吗？为什么不这样做：

```
SELECT Timestamp, CallEvent, ... ,Time 
       FROM blue.dbo.eCallByCallStat" & sDate & " ORDER BY Timestamp 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T16:59:11.297

我首先删除 sSQL 的内容`sSql=""`

之后，因为查询是在 for 循环中运行的，所以我在接下来的每一行中构建查询，每一行都建立在上一行的基础上，我这样做是为了让下一个人更容易编辑和理解。

通过sSQL运行后看起来像这样

```
sSQL=SELECT eCallByCallStat20081001.Timestamp, eCallByCallStat20081001.CallEvent,
eCallByCallStat20081001.CallEventName, eCallByCallStat20081001.CallID,
eCallByCallStat20081001.TelsetLoginID, eCallByCallStat20081001.AssociatedData,
eCallByCallStat20081001.Destination, eCallByCallStat20081001.EventData,
eCallByCallStat20081001.Source, eCallByCallStat20081001.Time FROM 
blue.dbo.eCallByCallStat20081001 eCallByCallStat20081001 ORDER BY
eCallByCallStat20081001.Timestamp 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-28T23:09:31.480

我在尝试刷新查询时遇到了同样的问题。

出于某种我不知道的原因。引用**QueryTable 对象**时，刷新仅在您第一次运行 vba 代码时起作用。如果再次运行，运行时错误会提示**Run-time error '-2147217842(80040e4e): Method 'Refresh' of object '_QueryTable' failed** 发生

**这是一个失败的查询刷新示例。** `Ws.ListObjects("TableName").QueryTable.Refresh BackgroundQuery:=False`

**这是找到的解决方案。** `ThisWorkbook.Connections("ConnectionName").Refresh`

如果有人知道 QueryTable 对象的刷新方法失败的原因。请告诉我们。

# oracle - 如何在 sqlplus 中抑制“PL/SQL 过程成功完成”消息？

> ID：250509
> 
> 赞同：33
> 
> 时间：2008-10-30T15:08:52.907
> 
> 标签：oracle, plsql, sqlplus

有没有一种方法可以在 sqlplus 中将 SERVEROUTPUT 设置为 ON，但以某种方式抑制在完成执行 plsql 过程时自动生成的消息“PL/SQL 过程成功完成”？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-30T15:13:31.617

使用命令：

```
SET FEEDBACK OFF 
```

在运行程序之前。之后，您可以再次将其重新打开：

```
SET FEEDBACK ON 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-05T19:36:06.257

这在 sqlplus 中对我来说效果很好，但我确实注意到“设置反馈关闭”会抑制 Sql Developer 中的错误（至少版本 17.2.0.188）。如果您使用 Sql Developer，请注意以下事项：

```
create or replace procedure test_throw_an_error as buzz number; begin dbms_output.put_line('In test_throw_an_error. Now, to infinity!'); buzz:=1/0; end;
/
set serveroutput on
set feedback off
exec test_throw_an_error;
exec dbms_output.put_line('Done, with feedback off');
set feedback on
exec test_throw_an_error;
exec dbms_output.put_line('Done, with feedback on'); 
```

结果：

```
Procedure TEST_THROW_AN_ERROR compiled

In test_throw_an_error. Now, to infinity!

Done, with feedback off

In test_throw_an_error. Now, to infinity!

Error starting at line : 11 in command -
BEGIN test_throw_an_error; END;
Error report -
ORA-01476: divisor is equal to zero
ORA-06512: at "ECTRUNK.TEST_THROW_AN_ERROR", line 1
ORA-06512: at line 1
01476\. 00000 -  "divisor is equal to zero"
*Cause:    
*Action:
Done, with feedback on

PL/SQL procedure successfully completed. 
```

# java - Java SE 6 vs. JRE 1.6 vs. JDK 1.6 - 这些是什么意思？

> ID：250517
> 
> 赞同：198
> 
> 时间：2008-10-30T15:10:09.907
> 
> 标签：java

我看到许多不同的 Java 术语四处飘荡。我需要安装 JDK 1.6。我的理解是 Java 6 == Java 1.6。但是，当我安装 Java SE 6 时，我得到一个报告为 11.0 版的 JVM！谁能解决这个疯狂？

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2008-10-30T15:13:12.350

*   JDK - Java 开发工具包
*   JRE - Java 运行时环境
*   Java SE - Java 标准版

SE 定义了一组能力和功能；有更复杂的版本（企业版 - EE）和更简单的版本（微型版 - ME - 用于移动环境）。

JDK 包括开发 Java 应用程序所需的编译器和其他工具；JRE 没有。因此，要运行其他人提供的 Java 应用程序，您需要 JRE；要开发 Java 应用程序，您需要 JDK。

*编辑*：正如 Chris Marasti-Georg 在评论中指出的那样，您可以在 Sun 的[Java](http://java.sun.com/)网站上找到很多信息，特别是从[Java SE](http://java.sun.com/javase/downloads/index.jsp)部分，（第二个选项，Java SE Development Kit (JDK) 6 Update 10） .

* * *

*2011-04-06 编辑：* 世界在转动，Java 现在由收购 Sun 的 Oracle 管理。今年晚些时候，该`sun.com`域应该会变暗。新页面（基于重定向）是 Oracle 技术网络上的这个[Java](http://www.oracle.com/technetwork/java/index.html)页面。（另见[java.com](http://java.com/)。）

* * *

*2013 年 1 月 11 日编辑：*世界继续转动（尽管 2012 年 12 月 21 日），你瞧，JRE 6 即将结束支持。 [Oracle](http://www.oracle.com/technetwork/java/eol-135779.html)表示在 2013 年 2 月之后不再公开更新 Java 6。

在给定的 Java 版本中，此答案仍然有效。JDK 是 Java Development Kit，JRE 是 Java Runtime Environment，Java SE 是标准版，等等。但是版本 6 (1.6) 已经过时了。

*2015 年 4 月 29 日编辑：*随着又绕太阳转几圈，也到了结束对 Java SE 7 支持的时候了。2015 年 4 月，甲骨文[确认](http://www.oracle.com/technetwork/java/eol-135779.html)不再提供 Java SE 7 的公共更新。Java SE 8 的公共更新暂定于 2017 年 3 月结束，但该结束日期可能会发生变化（稍后而不是更早）。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2011-08-30T18:17:27.823

这可能会帮助某人：

我正在我的系统上安装最新的 Java 进行开发，目前它是 Java SE 7。现在，让我们深入了解这个“疯狂”，正如你所说的......

所有这些都是相同的（当开发人员谈论 Java 进行开发时）：

*   Java SE 7
*   Java SE v1.7.0
*   Java SE 开发工具包 7

从 Java v1.5 开始：

*   v5 = v1.5。
*   v6 = v1.6。
*   v7 = v1.7。

我们可以假设这将保留在未来的版本中。

接下来，对于开发者来说，下载 JDK，而不是 JRE。

JDK 将包含 JRE。如果需要 JDK 和 JRE，请获取 JDK。两者都将从单个 JDK 安装中安装，如下所示。

正如上面有人提到的：

*   JDK = Java Development Kit（开发人员需要这个，如果你用 Java 编码，这就是你）
*   JRE = Java Runtime Environment（用户需要这个，这是当今每个计算机用户）
*   Java SE = Java 标准版

这是我遵循的一步一步的链接（一步导致下一步，这都是一次下载）下载用于开发的 Java (JDK)：

1.  访问“Java SE 下载”：[http ://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)
2.  点击“JDK下载”，访问“Java SE Development Kit 7 Downloads”：[http](http://www.oracle.com/technetwork/java/javase/downloads/java-se-jdk-7-download-432154.html) ://www.oracle.com/technetwork/java/javase/downloads/java-se-jdk-7-download-432154.html （注意随着 JDK 1.7 更新（更高版本）现已推出，点击步骤 #1 中的链接将带您到不同的链接）
3.  接受协议:)
4.  点击“Java SE Development Kit 7 (Windows x64)”： http: [//download.oracle.com/otn-pub/java/jdk/7/jdk-7-windows-x64.exe](http://download.oracle.com/otn-pub/java/jdk/7/jdk-7-windows-x64.exe)（对于我的64位Windows 7系统）
5.  您现在正在为您的系统下载（希望是最新的）JDK！:)

请记住，以上链接仅供参考，向您展示下载 JDK 所需的分步方法。

并使用默认设置安装到：

*   “C:\Program Files\Java\jdk1.7.0\”（JDK）
*   “C:\Program Files\Java\jre7\” (JRE) <--- 为什么它要求一个新的安装文件夹？这是JRE！

从上面记住，JDK 包含 JRE，如果您知道它们都是什么，这是有道理的。再次，见上文。

安装后，仔细检查“C:\Program Files\Java”以查看这两个文件夹。现在你知道它们是什么以及它们为什么在那里了。

我知道我是为新手写的，但我喜欢详细了解事情，所以我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2008-10-30T15:19:09.423

当您键入“java -version”时，您会看到三个版本号——java 版本（我的版本是“ `1.6.0_07`”）、Java SE 运行时环境版本（“build `1.6.0_07-b06`”）和 HotSpot 版本（我的版本是“” `build 10.0-b23, mixed mode"`） .我怀疑你看到的“11.0”是HotSpot版本。

更新：HotSpot 是（或曾经是，现在他们似乎用它来表示整个 VM）内置于 Java 虚拟机中的即时编译器。天知道为什么 Sun 给它一个单独的版本号。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-05-04T13:00:15.140

## Java 版本的简短且可能不正确的历史

*   Java是一个平台。它由两个产品组成——软件开发工具包和运行时环境。

*   当 Java 首次发布时，它显然只是被称为**Java**。如果您是开发人员，您也知道版本，即普通的“1.0”和后来的“1.1”。作为平台一部分的两种产品也被命名为：

    *   JDK——“Java 开发工具包”
    *   JRE——“Java 运行时环境”
*   显然 1.2 版中的变化如此之大，以至于他们开始将该平台称为**Java 2**。

    *   该平台的默认“发行版”被赋予了“标准”这个绰号，以与其兄弟姐妹进行对比。所以你有三个平台：

        *   **“Java 2 标准版 (J2SE)”**
        *   **“Java 2 企业版 (J2EE)”**
        *   **“Java 2 移动版 (J2ME)”**
    *   JDK 正式更名为“Java 2 软件开发工具包”。

*   当 1.5 版问世时，西装决定他们需要“重新命名”产品。所以Java平台有两个版本——产品版本“5”和开发者版本“1.5”（是的，明确提到了规则——“去掉'1。'）。但是，“2”被保留在所以现在平台正式命名为**“Java 2 Platform Standard Edition 5.0（J2SE 5.0）”**。

    *   诉讼还意识到，开发社区并没有接受他们对 JDK 的重命名。但他们并没有恢复他们的更改，而是决定从各个产品的名称中删除“2”，现在分别是**“J2SE Development Kit 5.0 (JDK 5.0)”**和**“J2SE Runtime Environment 5.0 (JRE 5.0)”**。
*   当 1.6 版发布时，有人意识到名称中有两个数字很奇怪。所以他们决定完全放弃 2（和“.0”后缀），我们最终得到包含**“Java SE Development Kit 6 (JDK 6)”的****“Java Platform, Standard Edition 6 (Java SE 6** )”和**“Java SE 运行时环境 6 (JRE 6)”**。

*****   1.7 版没有做任何愚蠢的事情。如果我不得不猜测，下一个重大变化将是删除“SE”，这样循环就完成了，JDK 再次被称为“Java 开发工具包”。**** 

 ****### 笔记

*   为简单起见，省略了一堆商标标志。所以假设 Java™、JDK™ 和 JRE™。

*   SO似乎无法呈现嵌套列表。

### 参考

*   [http://www.oracle.com/technetwork/java/javase/namechange-140185.html](http://www.oracle.com/technetwork/java/javase/namechange-140185.html)

### 结语

只需去掉“1”。来自`javac -version`and印刷的版本`java -version`，你很高兴。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-30T15:20:52.803

随着 Java 5 的发布，产品版本与开发人员版本不同，如此处[所述](http://java.sun.com/j2se/1.5.0/docs/relnotes/version-5.0.html)

## 版本 1.5.0 还是 5.0？

版本号“1.5.0”和“5.0”都用于标识 Java 2 平台标准版的此发行版。版本“5.0”是产品版本，而“1.5.0”是开发者版本。数字“5.0”用于更好地反映J2SE 的成熟度、稳定性、可扩展性和安全性的水平。

### 平台和产品名称中使用的“5.0 版”

5.0 版用于平台和产品名称，如下表所示：

|  | 全名 | 缩写 |
| --- | --- | --- |
| 平台名称 | Java™ 2 平台标准版 5.0 | J2SE™ 5.0 |
| 平台下交付的产品 | J2SE™ 开发套件 5.0 | JDK™ 5.0 |
|  | J2SE™ 运行时环境 5.0 | JRE 5.0 |

### 开发人员使用的“版本 1.5.0”

J2SE 还在某些仅对开发人员可见的地方或由程序解析版本号的地方保留版本号 1.5.0（或 1.5）。如前所述，1.5.0 指的是完全相同的平台和编号为 5.0 的产品。版本号 1.5.0 和 1.5 用于：

*   java -version（除其他信息外，返回 java 版本“1.5.0”）
*   java -fullversion（返回 java 完整版本“1.5.0-b64”）
*   javac -source 1.5（javac -source 5 也可以）
*   java.version 系统属性
*   java.vm.version 系统属性
*   @since 1.5 标签值
*   jdk1.5.0安装目录
*   jre1.5.0安装目录
*   [http://java.sun.com/j2se/1.5.0](http://java.sun.com/j2se/1.5.0)网站（[http://java.sun.com/j2se/5.0](http://java.sun.com/j2se/5.0) 也可以）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-05T06:59:09.973

Java SE Runtime 适用于最终用户，因此您需要 Java JRE 版本，Java 的第一个版本是 1，然后是 1.1 - 1.2 - 1.3 - 1.4 - 1.5 - 1.6 等，通常每个版本都按版本命名，因此 JRE 6 表示 Java jre 1.6，反正有更新版本，比如1.6 update 45，命名为java jre 6u45。

据我所知，他们更喜欢使用数字 6 而不是使用 1.6，以更好地反映成熟度、稳定性、可扩展性、安全性等水平

# sql - Windows 服务或 SQL 作业？

> ID：250518
> 
> 赞同：9
> 
> 时间：2008-10-30T15:10:25.243
> 
> 标签：sql, windows, sql-server-2005, windows-services

我有一个归档过程，基本上在设定的天数后删除归档记录。是写一个预定的 SQL 作业还是一个 Windows 服务来完成删除更好？数据库是mssql2005。

## 更新：

谈到下面的一些答案，这个问题是关于内部应用程序而不是分布式产品。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T15:13:09.230

这取决于你想要完成什么。您想将已删除的档案存储在某处吗？记录更改？SQL 作业应该执行得更好，因为它直接在数据库中运行，但更容易让服务访问数据库之外的资源。所以这取决于你想做什么，，，

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-30T15:13:23.270

我认为计划的 SQL 作业将是一个更安全的解决方案，因为如果将数据库迁移到新机器，进行迁移的人可能会忘记涉及 Windows 服务并忘记在新服务器上启动/安装它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-30T15:13:51.790

过去，我们运行过许多 SQL 作业。然而，最近，我们开始从 .Net 代码调用这些进程，因为客户端应用程序从 Windows 调度任务运行，原因有两个：

1.  以这种方式实现日志记录等功能更容易。
2.  我们还有其他不在数据库中运行的批处理作业，因此必须在 Windows 计划任务中。这样，任何类型的所有批处理作业都将列在一个地方。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T15:19:42.010

请注意，无论您如何操作，对于此任务，您都不需要服务。服务整天都在运行，并且整天都会消耗一些服务器的内存。

在此，您有一个需要运行的任务，并且每天运行一次。因此，您要么想要 SQL Server 中的作业，要么想要 Joel 描述的按计划设置执行然后从服务器内存空间卸载的应用程序（控制台或 winforms）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T15:14:33.487

这是给您/内部的，还是您分发的产品的这一部分。

如果在内部，我会说 SQL 工作。这也只是另一项服务。

如果它是您分发的产品的一部分，我会考虑安装和支持的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T15:34:58.533

To follow on Corey's point, if this is externally distributed, will you need to support SQL Express? If not, I'd go with the SQL job directly. Otherwise, you'll have to get more creative as SQL Express does not have the SQL Agent that comes with the full versions of SQL 2005 (as well as MSDE). Without the SQL Agent, you'll need another way to automatically fire the job. It could be a windows service, a scheduled task (calling a .NET app, powershell script, VBscript, etc.), or you could try to implement some trigger in SQL Server directly.

# c# - 我用什么代替 e.Values.add(... 让 ListViewEditEventArgs 上传图像

> ID：250528
> 
> 赞同：1
> 
> 时间：2008-10-30T15:12:11.183
> 
> 标签：c#, linq, listview, asp.net-3.5, image-uploading

在引用 ListViewInsertEventArgs 的 e.Values 方法时，我可以使用 linq 和 listview 控件将图像上传到数据库，但是 ListViewEditEventArgs 中没有这样的方法，那么我可以使用什么来实现相同的结果？

这是我的插入代码：

protected void ProjectPhotosList_ItemInserting（对象发送者，ListViewInsertEventArgs e）

{

FileUpload uplImage = (FileUpload)ProjectPhotosList.InsertItem.FindControl("uplImage");

标签 fileuploadlbl = (标签)ProjectPhotosList.InsertItem.FindControl("fileuploadlbl");

```
 byte[] img = null;
    if (uplImage.HasFile || !uplImage.FileName.ToLower().EndsWith(".jpg"))
    {
        try
        {
            img = new byte[uplImage.PostedFile.ContentLength];
            uplImage.PostedFile.InputStream.Read(img, 0, img.Length);
        }
        catch
        {
            fileuploadlbl.Text = "unable to upload " + uplImage.FileName.ToString();
        }
    }
    if (img == null)
    {
        e.Cancel = true;
        fileuploadlbl.Text = "Please choose a file to upload";
    }

    try
    {
        e.Values.Add("ProjectPhoto", new System.Data.Linq.Binary(img));
        fileuploadlbl.Text = "File Upload Successful";
    }
    catch
    {
        fileuploadlbl.Text = "File Upload Failed, please try again";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-30T17:55:53.083

好的，我已经解决了这个问题！我只需要采取一些不同的方式：

这是重要的代码：

int mykey = int.Parse(ProjectPhotosList.DataKeys[e.ItemIndex].Value.ToString());

它只是获取所选行的主键值的简单方法。我找到了一篇关于将 pdf 上传到数据库的帖子，并决定以此为基础编写我的其余代码。所以这里是完整的代码：

protected void ProjectPhotosList_ItemUpdating（对象发送者，ListViewUpdateEventArgs e）

{

FileUpload myFile = (FileUpload)ProjectPhotosList.EditItem.FindControl("uploadImage");

```
 TextBox myCaption = (TextBox)ProjectPhotosList.EditItem.FindControl("ProjectPhotoCaptionTextBox");

    int mykey = int.Parse(ProjectPhotosList.DataKeys[e.ItemIndex].Value.ToString());

    if (myFile.HasFile)
    {

        //Get the posted file
        Stream fileDataStream = myFile.PostedFile.InputStream;

        //Get length of file
        int fileLength = myFile.PostedFile.ContentLength;

        //Create a byte array with file length
        byte[] fileData = new byte[fileLength];

        //Read the stream into the byte array
        fileDataStream.Read(fileData, 0, fileLength);

        //get the file type
        string fileType = myFile.PostedFile.ContentType;

        //Open Connection
        PHJamesDataContext db = new PHJamesDataContext();
        //Find the Right Row
        PHJProjectPhoto Newphoto = (from p in db.PHJProjectPhotos
                                    where p.ProjectPhotoId == mykey
                                    select p).Single<PHJProjectPhoto>();

        Newphoto.ProjectPhoto = fileData;

        db.SubmitChanges();
    } 
```

# ruby-on-rails - 使用 db:schema:dump 使用 rake 在旧版 oracle 数据库上进行模式转储

> ID：250545
> 
> 赞同：3
> 
> 时间：2008-10-30T15:14:19.790
> 
> 标签：ruby-on-rails, ruby, oracle, schema, migration

有谁知道用于导入旧版 Oracle 数据库模式的任何特定 DSL 实现。我试图在我想要移植到新的 ruby​​ 应用程序的现有数据库上运行 db:schema:dump。但是，rake 在中途死亡，没有任何错误。它有点锁定。我开始寻找解决这个问题的最佳方法，并找到了如何为 SQLServer 覆盖一些东西但对 Oracle 来说不多的示例。

我基本上想引入模式并从中生成脚手架和模型。

有没有更简单的方法可以做到这一点，还是我必须发明轮子？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T08:20:07.160

第一个问题 - 您使用的是原始 ActiveRecord Oracle 适配器还是 oracle_enhanced 适配器 ( [http://github.com/rsim/oracle-enhanced](http://github.com/rsim/oracle-enhanced) )？我建议使用 oracle_enhanced 适配器，因为我对模式转储进行了一些性能改进。

Rails 提供了两种模式转储方式：

```
rake db:schema:dump 
```

这将使用 Rails 迁移创建 schema.rb 文件以创建模式。在 Oracle 情况下，它将搜索用户本地模式中的所有表（用户在 database.yml 中指定），并将尝试将 Oracle 数据类型转换为 Rails 模型属性类型。如果你有一些 Rails 不支持的数据类型，那么你可能会丢失它们。但是，如果您想以 Rails 方式重新设计您的应用程序，那么这是首选方法。正如我所说，我在 oracle_enhanced 适配器中对大型 Oracle 数据字典的模式转储进行了一些性能改进（如果所有模式中都有数千个表）。

```
rake db:structure:dump 
```

这将创建您可以在其他 Oracle 数据库中执行的 SQL 模式文件（例如 db/development_structure.sql）（这不适用于其他数据库）。这可能是创建模式转储的更快方法，并且不会丢失 Oracle 特定的数据类型。但是这样一来，当您将 ActiveRecord 与此数据库一起使用时，您可能会遇到麻烦，然后会注意到某些数据类型没有被正确处理。因此我建议使用 Rails 迁移来维护模式而不是原始 SQL。

但是，如果您想将 Rails 与一些现有的 Oracle 数据库一起使用，则无需重新创建此模式 - 您只需将 database.yml 指向此现有数据库模式并开始在现有表的顶部创建 ActiveRecord 模型。请参阅[http://blog.rayapps.com/2008/09/26/openworld-unconference-presentation-about-rails-on-oracle/](http://blog.rayapps.com/2008/09/26/openworld-unconference-presentation-about-rails-on-oracle/)了解如何将 Rails 与旧版 Oracle 数据库一起使用的一些技巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:55:55.043

你试过了`rake --trace`吗？

顺便说一句，Oracle 遗留模式是一个小家庭手工业。

[http://github.com/rsim/legacy_oracle_sample.git/README.txt](http://github.com/rsim/legacy_oracle_sample.git/README.txt)

[http://blog.rayapps.com/2008/06/28/activerecord-oracle-enhanced-adapter-version-111-released/](http://blog.rayapps.com/2008/06/28/activerecord-oracle-enhanced-adapter-version-111-released/)

[http://www.oracle.com/technology/pub/articles/saternos-rails.html](http://www.oracle.com/technology/pub/articles/saternos-rails.html)

[http://redsquirrel.com/cgi-bin/dave/dynamic/rails.multiple.oracle.dbs.html](http://redsquirrel.com/cgi-bin/dave/dynamic/rails.multiple.oracle.dbs.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-15T13:03:31.807

**更新：**仅当您使用“, :require => false”时才会失败。删除此参数，按预期工作。

这真的应该工作吗？

```
~/Projects/test (master) $ rake db:structure:dump
(in /Users/plentz/Projects/test)
rake aborted!
Task not supported by 'oracle_enhanced'

(See full trace by running task with --trace) 
```

* * *

宝石文件

```
gem 'activerecord-oracle_enhanced-adapter', :require => false 
```

* * *

```
Using activerecord-oracle_enhanced-adapter (1.3.2) 
```

# ruby - Capistrano：如何在多个项目 deploy.rb 文件中包含常用设置

> ID：250550
> 
> 赞同：4
> 
> 时间：2008-10-30T15:15:50.723
> 
> 标签：ruby, deployment, capistrano

这可能是一个新手红宝石问题。我有几个库和应用程序需要部署到几个不同的主机。所有的应用程序和库都将共享这些主机的一些通用设置——例如主机名、数据库服务器/用户/密码等。

我的目标是做类似的事情：

```
cap host1 stage deploy
cap host2 stage deploy
cap host1 prod deploy
# ... 
```

我的问题是如何在所有 deploy.rb 文件中包含这些常用设置？更具体地说，我想创建一个我可以包含的 rb 文件，其中包含一些常见设置和几个特定于主机的任务定义：

```
set :use_sudo, false
# set some other options

task :host1 do
    role :app, "host1.example.com"
    role :web, "host1.example.com"
    role :db,  "host1.example.com", :primary => true

    set :rodb_host, "dbhost"
    set :rodb_user, "user"
    set :rodb_pass, "pass"
    set :rodb_name, "db"
 end

 task :host2 do
     #...
 end

deploy.task :carsala do
    transaction do
        setup
        update_code
        symlink
    end
end 
```

然后在我定义阶段、产品等的所有 deploy.rb 文件中“包含”这个文件，并根据需要覆盖任何“通用”配置参数。任何建议，将不胜感激。我已经尝试了一些不同的东西，但是我从所有的上限中得到了错误。

编辑：我试过了

```
require 'my_module' 
```

但是我收到错误，抱怨未定义的任务对象。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-30T21:37:10.360

我只是对它进行了更多试验，我发现你必须：

```
load 'config/my_module' 
```

我可以把我所有的通用定义放在这里，然后把它加载到我的 deploy.rb 中。

它出现在加载并执行文件的文档中。或者，要求尝试加载指定的库。我不完全确定真正的区别，但似乎当前应用程序符号空间和所需的库之间存在一些分离（因此出现关于未定义任务对象的错误），这在您执行时不是问题加载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T16:03:21.017

```
require 'my_extension' 
```

将您的扩展保存在 my_extension.rb

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T17:37:17.767

我不确定您的需求有多复杂，但这对我来说很适合部署：

```
set :application, "app"

set :scm,           :subversion
# ... set all your common variables

task :staging do
  set :repository,    "http://app/repository/trunk/"
  # ... set other uncommon variables in task
end

task :production do
  set :repository,    "http://app/repository/production/"
  # ...
end 
```

部署只是

```
cap staging deploy 
```

或者

```
cap production deploy 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T17:15:16.567

Jon 说得对，这是最简单的方法，只需将其保存在单独的文件中并使用`require 'filename'`. 您还可以使用像[Webistrano这样的花哨的东西进行部署，它也以 Capistrano '](http://labs.peritor.com/webistrano) [Recipes](http://labs.peritor.com/webistrano/wiki/Screencasts) '的形式支持这一点。我已经在几个项目中使用了一段时间，并且开始喜欢它。

# c# - 在 .NET 中计算列表最小值/最大值的最短代码

> ID：250553
> 
> 赞同：13
> 
> 时间：2008-10-30T15:17:07.553
> 
> 标签：c#, .net, algorithm

我想要类似的东西

```
int minIndex = list.FindMin(delegate (MyClass a, MyClass b) {returns a.CompareTo(b);}); 
```

.NET 中是否有内置方法可以做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-30T15:20:32.213

试试看这些：

[敏](http://msdn.microsoft.com/en-us/library/bb909313.aspx)

[最大限度](http://msdn.microsoft.com/en-us/library/bb909073.aspx)

只要你的类实现了 IComparable，你所要做的就是：

```
List<MyClass> list = new List();
//add whatever you need to add

MyClass min = list.Min();
MyClass max = list.Max(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-30T21:26:53.610

好吧，如果你不能使用 .NET 3.5，你总是可以对列表进行排序，然后返回 list[0]。它可能不是最快的方法，但它可能是最短的代码，尤其是如果您的类已经实现了 IComparable。

```
List<SomeClass> list = new List<SomeClass>();
// populate the list
// assume that SomeClass implements IComparable
list.Sort();
return list[0];               // min, or
return list[list.Count - 1];  // max 
```

当然，这也假设如果您有多个最小或最大的项目，则返回哪个项目并不重要。

如果你的类没有实现 IComparable，你可以传入一个匿名委托，如下所示：

```
list.Sort(delegate(SomeClass x, SomeClass y) { return string.Compare(x.Name, y.Name); }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T15:20:38.983

使用 Linq，您有 Min() 和 Max() 函数。

所以你可以做`list.AsQueryable().Min();`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T21:12:51.797

您注意到“我仍在 2 中”-然后，您可能想查看[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)。这实际上是针对 C# 3.0 和 .NET 2.0 的，但你应该能够将它与 C# 2.0 和 .NET 2.0 一起使用——只是你必须使用长手：

```
MyClass min = Enumerable.Min(list),
        max = Enumerable.Max(list); 
```

当然，如果您可以切换到 C# 3.0（仍以 .NET 2.0 为目标）会更容易。

如果 LINQBridge 不是一个选项，您可以自己实现它：

```
static void Main()
{
    int[] data = { 3, 5, 1, 5, 5 };
    int min = Min(data);
}
static T Min<T>(IEnumerable<T> values)
{
    return Min<T>(values, Comparer<T>.Default);
}
static T Min<T>(IEnumerable<T> values, IComparer<T> comparer)
{
    bool first = true;
    T result = default(T);
    foreach(T value in values) {
        if(first)
        {
            result = value;
            first = false;
        }
        else
        {
            if(comparer.Compare(result, value) > 0) 
            {
                result = value;
            }
        }
    }
    return result;
} 
```

# java - 正确处理属性的方法

> ID：250560
> 
> 赞同：5
> 
> 时间：2008-10-30T15:19:10.013
> 
> 标签：java, oop, properties, structure

我正在一个相当大的项目中使用 Java。我的问题是关于如何最好地为我的应用程序构建一组属性。

方法 1：拥有一些每个类都可以访问的静态 Properties 对象。（缺点：那么，如果将某些类从应用程序的上下文中取出，它们就会失去通用性；它们还需要显式调用位于不同类中的某些静态对象，并且将来可能会消失；它只是不会*感觉*对了，我错了吗？）

方法 2：让属性由主类实例化并传递给其他应用程序类。（缺点：您最终将指向 Properties 对象的指针传递给几乎每个类，它似乎变得非常多余和麻烦；我不*喜欢*它。）

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T15:23:36.387

我喜欢对许多属性使用 Spring 依赖注入。您可以将应用程序视为构建块，并将属性直接注入需要它们的组件中。这保留（鼓励）封装。然后，您将组件组装在一起并创建“主类”。

依赖注入的一个很好的副作用是你的代码应该更容易测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:27:19.407

实际上，方法 2 效果很好。

我尝试在最近的项目中使用 Singleton 属性对象。然后，当需要添加功能时，我需要修改 Singleton，并且后悔必须找到我使用的每个地方`MySingleton.getInstance()`。

通过各种构造函数传递全局信息对象的方法 2 更易于控制。

使用显式设置器也有帮助。

```
class MyConfig extends Properties {...}

class SomeClass {
    MyConfig theConfig;
    public void setConfi( MyConfig c ) {
        theConfig= c;
    }
    ...
} 
```

它运行良好，您会很高兴您严格控制哪些类实际上需要配置信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T15:27:55.537

如果很多类都需要这些属性，我会选择方法 1。或者可能是使用单例设计模式而不是所有静态方法的变体。这意味着您不必一直传递一些属性对象。另一方面，如果只有少数类需要这些属性，则出于您提到的原因，您可能会选择方法 2。您可能还想问自己，您编写的类实际上被重用的可能性有多大，如果是，那么重用属性对象有多大的问题。如果不可能重用，现在不要理会它，选择最适合当前情况的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T15:25:06.697

听起来您需要一个配置管理器组件。它可以通过某种服务定位器找到，它可以像`ConfigurationManagerClass.instance()`. 这将封装所有的乐趣。或者你可以使用像 Spring 这样的依赖注入框架。

很大程度上取决于组件如何在您的架构中找到彼此。如果您的其他组件作为引用被传递，请执行此操作。只要保持一致。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T18:49:32.773

如果您正在寻找快速的东西，您可以使用系统属性，它们适用于所有类。您可以存储一个字符串值，或者如果您需要存储“东西”列表，您可以使用 System.Properties() 方法。这将返回一个“属性”对象，它是一个 HashTable。然后，您可以将所需的任何内容存储到表中。它并不漂亮，但它是拥有全局属性的快速方法。YMMV

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T15:26:31.967

我通常选择一个位于公共项目中的单例对象，并包含一个以命名空间为键的自身哈希表，从而为每个对象生成一个属性类。

依赖注入也是一种很好的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T16:01:45.763

当我有一个指向内存中属性的静态指针时，我会感觉更舒服。有时您想在运行时重新加载属性，或者使用静态引用更容易实现的其他功能。

请记住，没有班级是一座孤岛。可重用类可以有一个客户端类来保持核心不受单调引用的影响。

你也可以使用接口，只是尽量不要过度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T16:25:25.887

方法 2 显然更好。

无论如何，您不应该让其他类搜索配置对象。您应该在对象外部的配置对象中注入配置。

查看[apache commons 配置](http://commons.apache.org/configuration/index.html)以获取有关配置 Impl 的帮助。

所以在 main() 你可以有

```
MyObject mobj = new MyObject();
mobj.setLookupDelay(appConfig.getMyObjectLookupDelay);
mobj.setTrackerName(appConfig.getMyObjectTrackerName); 
```

代替

```
MyObject mobj = new MyObject();
mobj.setConfig(appConfig); 
```

其中 appConfig 是 apache 配置库的包装器，它根据配置文件中的值的名称执行所有值的查找。

这样，您的对象变得非常容易测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T18:54:41.360

好久没做Java了，就不能直接把你的属性放到java.lang.System属性里面吗？通过这种方式，您可以从任何地方访问值并避免拥有“全局”属性类。

# c# - 如何从 C# 检查是否安装了复杂脚本和 rtl 语言的文件？

> ID：250564
> 
> 赞同：1
> 
> 时间：2008-10-30T15:19:55.193
> 
> 标签：c#, windows

如何从 C# 检查是否安装了复杂脚本和 rtl 语言（区域和语言设置）的文件？

编辑：或者是否有另一种方法来检查从右到左的文本是否会在我的表单中正确显示？

编辑以获得更好的解释（我希望:)）我正在创建一个使用阿拉伯字母（免费词典）的应用程序。所以，我要检查的是：“复杂脚本和从右到左语言的文件（包括泰语）”（语言选项卡中“区域和语言选项”中的复选框）已安装（复选框是否选中。）。如果没有安装，阿拉伯语单词将无法正确显示，如果是这种情况，我想警告用户。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T20:05:59.213

我不确定这是否会让您一路走好，但是您可以查询 WMI。如果您使用的是 .Net，请查看 System.Management 命名空间。你会感兴趣...

命名空间：root\cimv2 类：Win32_OperatingSystem 属性：MUILanguages 和/或区域设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T07:46:53.697

谢谢你的信息。我在 WMI 中查询 Win32_OperatingSystem 属性。它返回带有除 MUILanguages 之外的所有字段和属性的 Win32_OperatingSystem 类 :(

```
...
  uint32 MaxNumberOfProcesses;
  uint64 MaxProcessMemorySize;
  string MUILanguages[]; //I don't see this field, and all others I see
  string Name;
  uint32 NumberOfLicensedUsers;
... 
```

有什么帮助吗？我使用 WinXP SP2 和 VS2005

我使用的代码参考：System.Management；

```
string ConfigNamespace = @"\\.\root\cimv2";
string query = "select * from Win32_OperatingSystem";

ManagementObjectSearcher searcher = 
  new ManagementObjectSearcher(ConfigNamespace, query);

ManagementObjectCollection collection = searcher.Get();

foreach (ManagementObject item in collection)
{
  //PropertyData pd = item.Properties["MUILanguages"];

  foreach (PropertyData data in item.Properties)
  {

  }
} 
```

# ruby-on-rails - 如何使用 Rails 压缩网页输出？

> ID：250566
> 
> 赞同：15
> 
> 时间：2008-10-30T15:20:17.860
> 
> 标签：ruby-on-rails, optimization, gzip, http-compression

对我的网页输出进行**gzip 压缩**的 Rails 最佳插件是什么？

**编辑：** 我托管的公司表示他们不会安装`mod_deflate`.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-30T17:19:41.317

您是否测试过它是否已经启用？如果您的托管服务提供商使用 Apache，那么默认情况下它很可能就在那里。

对您的站点运行此命令，看看您是否获得了`Content-Encoding: gzip`标题。

```
$ curl --head -H "Accept-Encoding: gzip" http://example.com 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-30T15:34:12.950

除非您在没有其他网络服务器的情况下运行 Rails 应用程序（这通常不是一个好主意），否则您可能应该查看您的网络服务器。所有主要的网络服务器都有启用 gzip 的选项。例如，对于 Apache，您可以使用[mod_deflate](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-14T10:43:34.600

您是否尝试过使用 deflate 中间件？添加`use Rack::Deflater`到您的`config.ru`.

这就是你如何使用在 Heroku 上运行的应用程序（自 cedar-stack 以来的 AFAIK）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T17:02:29.380

如果您的托管公司不支持 mod_deflate，那么是时候换一个新的托管公司了。我认为在 Ruby 中这样做会很慢，而且很痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T15:33:22.250

您是否尝试过通过[mod_deflate](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)在 apache 中启用压缩？

# c# - 输入文件（或类）时中断

> ID：250576
> 
> 赞同：20
> 
> 时间：2008-10-30T15:22:36.140
> 
> 标签：c#, visual-studio, debugging

在 Visual Studio 中，有没有办法让调试器在输入某个文件（或类）时中断？请不要回答“只是在每个方法的开头设置一个断点”:)

我正在使用 C#。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-12T09:24:03.880

宏可以成为你的朋友。这是一个宏，它将为当前类中的每个方法添加一个断点（在运行之前将光标放在类中的某个位置）。

```
Public Module ClassBreak
    Public Sub BreakOnAnyMember()
        Dim debugger As EnvDTE.Debugger = DTE.Debugger
        Dim sel As EnvDTE.TextSelection = DTE.ActiveDocument.Selection
        Dim editPoint As EnvDTE.EditPoint = sel.ActivePoint.CreateEditPoint()
        Dim classElem As EnvDTE.CodeElement = editPoint.CodeElement(vsCMElement.vsCMElementClass)

        If Not classElem Is Nothing Then
            For Each member As EnvDTE.CodeElement In classElem.Children
                If member.Kind = vsCMElement.vsCMElementFunction Then
                    debugger.Breakpoints.Add(member.FullName)
                End If
            Next
        End If
    End Sub

End Module 
```

**编辑：**更新为按函数名称添加断点，而不是文件/行号。它“感觉”更好，并且在断点窗口中更容易识别。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-12T01:05:33.173

您可以从引入某种面向方面的编程开始——例如参见 [这个解释](http://blogs.msdn.com/saveenr/archive/2008/11/20/c-aop-elegant-tracing-with-postsharp-and-aspect-oriented-programming.aspx)——然后在单个 OnEnter 方法中放置一个断点。

根据您选择的 AOP 框架，它需要在您的代码中进行一些修饰并引入一些开销（您可以稍后删除），但至少您不需要在任何地方设置断点。在某些框架中，您甚至可以在完全不更改代码的情况下引入它，只需一个 XML 文件？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-12T22:38:00.430

也许您可以在输入方法时使用诸如 PostSharp 之类的 AOP 框架来闯入调试器。看看[这个页面](http://www.postsharp.org/about/getting-started)上的非常简短的教程作为一个例子，你如何在输入方法时记录/跟踪。

在您的情况下，您可以将 Debugger.Break() 语句放入 OnEntry 处理程序中，而不是记录日志。虽然，调试器不会停止在您的方法中，而是在 OnEntry-handler 中（所以我不确定这是否真的有帮助）。

这是一个非常基本的示例：

方面类定义了一个 OnEntry 处理程序，它调用 Debugger.Break()：

```
[Serializable]
public sealed class DebugBreakAttribute : PostSharp.Laos.OnMethodBoundaryAspect
{
    public DebugBreakAttribute() {}
    public DebugBreakAttribute(string category) {}
    public string Category { get { return "DebugBreak"; } }

    public override void OnEntry(PostSharp.Laos.MethodExecutionEventArgs eventArgs)
    {
        base.OnEntry(eventArgs);
        // debugger will break here. Press F10 to continue to the "real" method
        System.Diagnostics.Debugger.Break();
    }
} 
```

然后我可以将此方面应用于我的类，我希望调试器在调用方法时中断：

```
[DebugBreak("DebugBreak")]
public class MyClass
{
    public MyClass()
    {
        // ...
    }
    public void Test()
    {
        // ...
    }
} 
```

现在，如果我构建并运行应用程序，只要调用 MyClass 的方法之一，调试器就会在 OnEntry() 处理程序中停止。我所要做的就是按 F10，我在 MyClass 的方法中。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-30T15:31:51.020

好吧，正如大家所说，它涉及在每个方法的开头设置一个断点。但你没有看到更大的图景。

为此，必须在每个方法的开头设置断点。无论您是手动执行，还是调试器自动执行，都必须设置这些断点才能使其正常工作。

所以，问题真的变成了，“如果对这个功能有足够的需求，那么值得在调试器中构建一个自动设置所有这些断点的方法吗？”。答案是，“不是真的”。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-18T03:19:01.730

此功能在 VS 中针对本机 C++ 实现。crtl-B 并将'function'指定为“Classname::*”，这会在类的每个方法的开头设置一个断点。断点集在断点窗口 (ctrl-alt-B) 中分组在一起，因此可以将它们作为一个组启用、禁用和删除。

遗憾的是，宏可能是托管代码的最佳选择。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-12T02:51:47.990

这在 WinDbg 中运行良好：

```
bm exename!CSomeClass::* 
```

（只是为了澄清，上面的行在类中的所有函数上设置了一个断点，就像 OP 要求的那样，没有诉诸 CRT hacking 或宏愚蠢）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-12T02:17:13.033

您可以编写一个 Visual Studio 宏来获取所有类方法的列表（例如，通过读取`.map`与可执行文件一起生成的文件并在其中搜索正确的符号名称（然后对这些名称进行分解）），然后[`Breakpoints.add()`](http://msdn.microsoft.com/en-us/library/envdte.breakpoints.add(VS.80).aspx)以编程方式使用为这些函数添加断点。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-30T15:27:21.560

```
System.Diagnostics.Debugger.Break(); 
```

（在每个方法的开头）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-30T15:24:52.093

不。或者更确切地说，是的，但它涉及在每个方法的开头设置一个断点。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T08:56:04.557

使用[Debugger.Break();](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx) （来自 System.Diagnostics 命名空间）

将它放在您希望“破坏”的每个功能的顶部

```
void MyFunction()
{
    Debugger.Break();
    Console.WriteLine("More stuff...");
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-12T09:05:04.393

最简单的方法不是简单地在构造函数中设置一个断点（假设你只有一个 - 或者在多个构造函数的情况下它们中的每一个）？

这将在非静态构造函数的情况下首次实例化类时中断调试，而在静态构造函数/类的情况下，一旦 Visual Studio 决定初始化您的类，您就会中断调试。

这当然可以防止您必须在类中的*每个*方法中设置断点。

当然，您不会在随后重新进入类代码时继续进行调试（假设您下次使用相同的实例化对象），但是，如果您每次都重新实例化一个新对象在调用代码中，您可以模拟这一点。

但是，按照传统术语，没有简单的方法可以在一个地方（例如）设置一个断点，并在每次输入类的代码（从任何方法）时（据我所知）进入调试。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-12T09:16:13.587

假设您只对公共方法感兴趣，即当类方法被“从外部”调用时，我将再次插入按合同设计。

你可以养成这样编写公共函数的习惯：

```
public int Whatever(int blah, bool duh)
{
    // INVARIANT (i)
    // PRECONDITION CHECK (ii)

    // BODY (iii)

    // POSTCONDITION CHECK (iv)
    // INVARIANT (v)

} 
```

然后，您可以使用将在 (i) 中调用的 Invariant() 函数并**在其中设置断点**。然后检查调用堆栈以了解您来自哪里。当然，你也会在 (v) 中调用它；如果您真的只对入口点感兴趣，您可以使用辅助函数从 (i) 调用 Invariant，从 (v) 调用另一个。

当然这是额外的代码，但是

1.  无论如何它都是有用的代码，如果您使用按合同设计，那么结构就是样板。
2.  有时您希望断点来调查一些不正确的行为，例如无效的对象状态，在这种情况下，不变量可能是无价的。

对于始终有效的对象，Invariant() 函数只有一个返回 true 的主体。你仍然可以在那里放置一个断点。

这只是一个想法，它确实有一个足迹，所以只要考虑它，如果你喜欢它就使用它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-18T16:03:47.600

乔尔，答案似乎是“不”。每种方法都没有断点。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-09-08T10:43:13.003

要删除由接受的答案设置的断点，请添加另一个带有以下代码的宏

```
Public Sub RemoveBreakOnAnyMember()
    Dim debugger As EnvDTE.Debugger = DTE.Debugger

    Dim bps As Breakpoints
    bps = debugger.Breakpoints

    If (bps.Count > 0) Then
        Dim bp As Breakpoint
        For Each bp In bps
            Dim split As String() = bp.File.Split(New [Char]() {"\"c})

            If (split.Length > 0) Then
                Dim strName = split(split.Length - 1)
                If (strName.Equals(DTE.ActiveDocument.Name)) Then
                    bp.Delete()
                End If
            End If
        Next
    End If
End Sub 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-30T15:25:52.560

不是我知道的。您可以做的最好的事情是在文件或类的每个方法中放置一个断点。你想做什么？您是否想弄清楚是什么方法导致某些事情发生变化？如果是这样，也许数据断点会更合适。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-30T19:57:13.120

您可以编写一个包装器方法，通过它在您的应用程序中进行每次调用。然后在该单一方法中设置断点。但是……你做这种事会很疯狂。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-12T01:18:08.590

您可以在此设置一个内存断点，并将其设置为读取。我认为在调用成员函数的大部分时间都应该进行阅读。我不确定静态函数。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-12T01:38:36.230

```
you can use the following macro:

#ifdef _DEBUG
#define DEBUG_METHOD(x) x DebugBreak();
#else
#define DEBUG_METHOD(x) x
#endif

#include <windows.h>

DEBUG_METHOD(int func(int arg) {)
    return 0;
} 
```

在函数输入时它会闯入调试器

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-12T02:03:52.363

如果这是您正在谈论的 C++，那么您可能会侥幸逃脱，（大量工作）在 CRT 的前导代码中设置断点，或者编写修改前导代码以坚持 INT 3 的代码那里仅用于从相关类生成的函数...这，顺便说一句，可以在运行时完成...您必须让生成的PE文件修改自己，可能在重定位之前，以坚持所有中断那里...

我唯一的其他建议是编写一个使用预定义宏 __FUNCTION__ 的宏，您可以在其中查找属于相关类的任何函数，并在必要时粘贴

```
__asm { int 3 } 
```

在你的宏中让VS中断......这将防止你必须在每个函数的开头设置断点，但你仍然必须坚持一个宏调用，如果你问我，这要好得多。我想我在某处读到了关于如何定义或重新定义每个函数调用的序言代码。我会看看我能找到什么。

我认为我可以使用类似的 hack 来检测您输入的文件，但是您仍然必须将您的函数宏放在您的代码中，否则它永远不会被调用，而且，这几乎是您不想要的去做。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-12T08:46:09.277

如果您愿意使用宏，那么[这个问题的接受答案](https://stackoverflow.com/questions/73063/how-do-i-add-debug-breakpoints-to-lines-displayed-in-a-find-results-window-in-vis)

通过使搜索函数搜索方法、属性和构造函数（根据需要），应该可以轻松地转换为您的需要，也很可能有一种方法可以从更稳定的 ide/symbols 获取相同的信息（尽管可能稍微复杂一点）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-12T09:19:23.720

您可以在程序集中使用`Debugger.Launch()`和`Debugger.Break()``System.Diagnostics`

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-17T14:10:25.077

使用反射的疯狂方法。有关详细信息，请参阅文档`MethodRental.SwapMethodBody`。在伪代码中：

```
void SetBreakpointsForAllMethodsAndConstructorsInClass (string classname)
{
  find type information for class classname
  for each constructor and method
    get MSIL bytes
    prepend call to System.Diagnostics.Debugger.Break to MSIL bytes
    fix up MSIL code (I'm not familiar with the MSIL spec. Generally, absolute jump targets need fixing up)
    call SwapMethodBody with new MSIL
} 
```

然后，您可以传入类名作为运行时参数（如果需要，可以通过命令行）在给定类的所有方法和构造函数上设置断点。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-17T14:18:26.383

文件在运行时不存在（考虑到部分类与将所有内容放在单个文件中没有什么不同——就代码而言）。因此需要宏观方法（或每个方法中的代码）。

对一个类型（在运行时确实存在）做同样的事情可能是可以做到的，但可能是高度侵入性的，为 heisenbugs 创造了更多的潜力。“最简单”的途径可能是使用 .NET 远程处理的代理基础设施（有关使用透明代理的示例，请参阅 MOQ 的实现）。

总结：使用宏，或者全选后跟设置断点（ctrl-A,F9）。

# java - 如何设置工作目录 除了 basedir 之外的任务？

> ID：250577
> 
> 赞同：3
> 
> 时间：2008-10-30T15:22:49.790
> 
> 标签：java, ant, junit

我有一个带有 junit 目标的 Ant 脚本，我希望它使用与 basedir 不同的工作目录启动 VM。我该怎么做？

这是我的目标的伪版本。

```
<target name="buildWithClassFiles">
    <mkdir dir="${basedir}/UnitTest/junit-reports"/>
    <junit fork="true" printsummary="yes">
        <classpath>
            <pathelement location="${basedir}/UnitTest/bin"/>
            <path refid="classpath.compile.tests.nojars"/>
        </classpath>
        <jvmarg value="-javaagent:${lib}/jmockit/jmockit.jar=coverage=:html"/>
        <formatter type="xml" />
        <test name="GlobalTests" todir="${basedir}/UnitTest/junit-reports" />
    </junit>

</target> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T15:40:03.653

你有没有尝试过：

```
 <junit fork="true" printsummary="yes" dir="workingdir"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:58:19.003

我认为其他答案可能忽略了您希望指定工作目录的事实，而不仅仅是您想在特定目录上运行 junit。换句话说，您要确保如果测试创建的文件没有路径信息，它来自您指定的基本目录。

尝试将您想要的目录作为 JVM arg 传递给 junit，覆盖`user.dir`：

```
 <junit fork="true" ...>
   <jvmarg value="-Duser.dir=${desired.current.dir}"/>
    .... 
```

# database - 快速 GUI 应用程序 + sqlite 数据库 CRUD（2-4 个表）使用哪种语言

> ID：250582
> 
> 赞同：4
> 
> 时间：2008-10-30T15:24:23.453
> 
> 标签：database, user-interface

哪种语言用于快速 GUI 应用程序 + sqlite 数据库 CRUD（2-4 个表）。爪哇，Python？（请不要像VBasic那样开玩笑），一些参考，源代码可以看吗？

添加：

第一个想法：1数据库SQLite（Win）+客户端GUI应用程序（Win）客户端表+订单表+其他导入，导出数据库添加，删除，编辑等条目

第二个想法：1个托管数据库（PostgreSQL，MySQL）+ Web应用客户端客户端表+订单表+其他导入，导出数据库添加，删除，编辑等条目

考虑 Django、RoR 或本地 Java(Netbeans)、Python(wxPython+ORM)。

？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T15:29:47.623

尝试使用 python 和 wxPython 进行 UI 编程。我建议您寻找像 SQLachemy 这样的 ORM 映射器。

有人建议专门为您的目的制作的[dabo](http://dabodev.com/)，但我（还）没有经验。它适用于 wxPython 和 SQLite 等数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T15:55:12.157

[德尔福](http://www.codegear.com)。它非常适合这种桌面应用程序，并且有一个可用的[SQLite 包装器](http://www.itwriting.com/blog/a-simple-delphi-wrapper-for-sqlite-3)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T15:27:52.087

无论你最熟悉什么。

或者任何有更好的准备好的组件，所以要么是 Java（Netbeans/Matise + 向导），要么是其他东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T15:31:16.247

需要更多信息。对于内部或您将分发？桌面还是网络？如果是基于网络的，您是托管它还是托管它？

然后是你的个人目标。真的，真的快点，或者让它成为一个学习你感兴趣的语言/技术的机会，比如 Ruby on Rails？林克？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-30T17:09:31.400

Ruby on Rails 将**非常**轻松地进行简单的 CRUD 操作——尽管做的更多可能会更复杂一些（需要阅读一些关于 RoR 的做事方式）。最新版本的 Rails 自动使用 sqlite 数据库，实际上整个数据库和 CRUD GUI 代码可以用一个命令 ( `scaffold`) 创建。

如果要部署它，那可能会更困难一些（尽管我听说 Capistrano 很好） - 但对于本地或 Intranet 使用，那就是我要做的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-30T15:33:55.540

GUI 开发并不比使用 Tcl/tk 容易得多。此外，Tcl 可以说是最好的 sqlite 接口。如果部署是一个问题，那么绝对没有任何语言可以与 tcl 的 tclkit/starkit/starpack 打包机制竞争。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-30T15:39:42.923

编写一个 XulRunner 应用程序；这可以在 Firefox 3.0 上运行。

[http://developer.mozilla.org](http://developer.mozilla.org)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-12T05:59:11.250

[REALbasic](http://www.realsoftware.com/)，如果你想做一个桌面应用程序。个人版内置 SQLite，在 Linux 上免费，在其他平台上便宜。它是一种非常干净的 OO 语言和合理的 IDE，工作效率与 VB6 差不多，但更干净。

我从事跨平台开发已经有 15 年了，现在 REALbasic 是我选择用于直接数据库表单应用程序的工具，包括我目前正在开发的企业会计系统。

我也在 WPF/C#、C++ 和 Cocoa/Objective-C 中工作，所以我[不](http://www.oofile.com.au)只是一个“Basic-weanie”:-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T17:45:40.453

C# 和 WPF，它非常容易了解（我已经玩了 1 周，并在几个小时内完全编写了一个 twitter 客户端。

现在 Cocoa 和界面 Builder，即使对于一个简单的应用程序来说也是一种很酷的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-11T21:59:22.967

如果您正在开发 Web 应用程序，我建议您使用支持脚手架的站点，例如**rails**、**django**或**ASP.NET MVC（动态数据）**。如果它是一个 Windows 应用程序，那么没有什么比 WPF/Silverlight 的生产力和功能更好的了，如果是这样，请考虑使用[OrmLite](http://code.google.com/p/servicestack/wiki/OrmLite)，这是一种 POCO 驱动的轻量级 ORM，它提供了一组围绕常见 ADO.NET IDbConnection 和 IDbCommand 接口的有用扩展方法。仅使用约定和 DataAnnotation 属性进行配置，它可以毫不费力地保存具有深度复杂对象图的模型。

此处提供了使用 Sqlite（带有完整源代码）的实时工作示例： [http ://www.servicestack.net/ServiceStack.Examples.Clients/Default.htm](http://www.servicestack.net/ServiceStack.Examples.Clients/Default.htm)

There is also a complete end-to-end example (i.e. stand-alone, no other config required) on stackoverflow: [xml to sql using linq and C#](https://stackoverflow.com/questions/2106710/xml-to-sql-using-linq-and-c/2137249#2137249)

# vb.net - Outlook 兑换：GetNamesFromIDs

> ID：250583
> 
> 赞同：1
> 
> 时间：2008-10-30T15:24:27.820
> 
> 标签：vb.net, outlook, mapi, outlook-redemption

我正在尝试从 Outlook 项目中获取所有属性名称/值。除了默认的 Outlook 项目属性外，我还有自定义属性。我正在使用兑换来绕过 Outlook 警告，但我在 Redemption.RDOMail 项目上的 GetNamesFromIDs 方法遇到了一些问题......

我正在使用我的兑换会话来获取消息并尝试使用该消息来获取所有属性的名称。

```
Dim rMessage as Redemption.RDOMail = _RDOSession.GetMessageFromID(EntryID, getPublicStoreID())
Dim propertyList As Redemption.PropList = someMessage.GetPropList(Nothing)
For i As Integer = 1 To propertyList.Count + 1
    Console.WriteLine(propertyList(i).ToString())
    Console.WriteLine(someMessage.GetNamesFromIDs(________, propertyList(i)))
Next 
```

我不完全确定将什么作为第一个参数传递给 getNamesFromIDs。GetNamesFromIDs 的定义如下：

```
GetNamesFromIDs(MAPIProp as Object, PropTag as Integer) As Redemption.NamedProperty 
```

我不完全确定应该作为 MAPIProp 对象传入什么。我没有在文档中看到此属性。[http://www.dimastr.com/redemption/rdo/MAPIProp.htm#properties](http://www.dimastr.com/redemption/rdo/MAPIProp.htm#properties)

任何帮助或见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T15:50:24.803

好吧，对于背景信息，作者[建议使用](http://www.pcreview.co.uk/forums/thread-1858064.php)[OutlookSpy](http://www.dimastr.com/outspy/)之类的东西来查看 Outlook 如何存储属性。

看看[这个交流](http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.messaging/2007-01/msg00085.html)（确保通读所有后续回复），没有更多内容（事实上，我认为在某一时刻 Outlook MVP 类型`GetNamesFromIDs`当他的意思时`GetIDsFromNames`）。

您可能会尝试使用`GetIDsFromNames`查看返回的内容，然后使用它传递给`GetNamesFromIDs`.

我以前用过救赎，但不是以这种特殊的方式，所以这就是我为你准备的一切......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T17:04:10.427

我想我想通了。我只使用过 VBA，所以你需要“考虑一下”它的局限性，它将遵循 VB.NET 中的相同方案。

函数签名是这样的：

```
Function GetNamesFromIDs(MAPIProp As Unknown, PropTag As Long) As NamedProperty 
```

作为第一个参数，它需要一个支持`IUnknown`接口的对象。查看 Redemption 文档，很明显有一个名为 的接口`_MAPIProp`，许多其他 RDO 对象都从该接口派生（`IRDOMail`其中包括）。所以这一定是`RDOMail`你试图从中获取数据的地方。

知道了这一点，它只需要文档中的另一个微妙提示即可使其正常工作：

> 给定一个 prop 标签 (>= 0x80000000)，返回命名属性的 GUID 和 id。

所以属性标签必须是`>= 0x80000000`，这意味着它不适用于所有属性，而仅适用于自定义属性（我想这是这种情况下的区别，如果我错了，请纠正我。）传递不满足此条件的属性标签会引发一条错误消息（0x8000ffff“意外结果”）。

这是我的代码。它是 VBA，所以请原谅我的 Hex() 错误，因为 VBA 的长整数会溢出这么大的数字。我相信你会明白的。

```
Sub GetNamesFromIds()

  Dim rSession As New Redemption.RDOSession
  Dim rMessage As Redemption.RDOMail
  Dim PropertyList As Redemption.PropList
  Dim PropTag As Long
  Dim EntryId As String
  Dim i As Integer

  rSession.MAPIOBJECT = Application.Session.MAPIOBJECT

  ' retrieve first random mail for this example '
  EntryId = ActiveExplorer.CurrentFolder.Items(1).EntryId
  Set rMessage = rSession.GetMessageFromID(EntryId)
  Set PropertyList = rMessage.GetPropList(0)

  For i = 1 To PropertyList.Count
    PropTag = PropertyList(i)
    If "0x" & Right("00000000" & Hex(PropTag), 8) > "0x80000000" Then
      Debug.Print
      If IsArray(rMessage.Fields(PropTag)) Then
        Debug.Print Hex(PropTag), "(Array:", UBound(rMessage.Fields(PropTag)), "items)"
      Else
        Debug.Print Hex(PropTag), "(", rMessage.Fields(PropTag), ")"
      End If
      Debug.Print "    GUID:", rMessage.GetNamesFromIds(rMessage, PropTag).GUID
      Debug.Print "      ID:", rMessage.GetNamesFromIds(rMessage, PropTag).ID
    End If
  Next

End Sub 
```

输出的第一个片段：

```
8041001E      (             urn:content-classes:message )
    GUID:     {00020386-0000-0000-C000-000000000046}
      ID:     content-class 
```

# .net - 如何在 WPF TreeView 中的节点旁边添加图标？

> ID：250597
> 
> 赞同：9
> 
> 时间：2008-10-30T15:28:14.100
> 
> 标签：.net, wpf, treeview

我有一个只有 1 级项目的 WPF TreeView。TreeView 是绑定到字符串 ObservableCollection 的数据。如何确保相同的图标出现在 TreeView 中每个节点的左侧？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T14:03:46.793

我认为可以帮助您了解 TreeView 的最佳文章之一是[http://www.codeproject.com/KB/WPF/TreeViewWithViewModel.aspx](http://www.codeproject.com/KB/WPF/TreeViewWithViewModel.aspx)。一般来说，这描述了一组很好的模式，可以使 WPF/SL 中的许多场景变得更加容易。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-31T11:48:16.503

我认为最好的方法是在 TreeView 上设置一个样式，它将更改 TreeViewItems 的模板以拥有您想要的图像。

模板可能需要是带有图像和标签控件的 StackPanel，将图像绑定到图标，将标签文本绑定到 Observable 集合中的字符串。

我从[代码项目文章](http://www.codeproject.com/KB/WPF/WPF_Explorer_Tree.aspx)中复制了相关的代码片段，该文章对此进行了更详细的介绍，但我认为您只需要以下内容（此代码位于 TreeView.Resources 元素中）。

```
<Style TargetType="{x:Type TreeViewItem}">
    <Setter Property="HeaderTemplate">
        <Setter.Value>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <Image Name="img"
                           Width="20"
                           Height="20"
                           Stretch="Fill"
                           Source="image.png"/>
                    <TextBlock Text="{Binding}" Margin="5,0" />
                </StackPanel>
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-20T20:11:19.240

我以这种方式使用了[James Osborn](https://stackoverflow.com/users/6686/james-osborn)的[StackPanel 技术](https://stackoverflow.com/questions/250597/how-do-i-add-icons-next-to-the-nodes-in-a-wpf-treeview/253243#253243)......

XAML：

```
<TreeView Name="TreeViewThings" ItemsSource="{Binding}">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type local:Thing}"
                                  ItemsSource="{Binding Children}">
            <StackPanel Orientation="Horizontal" Margin="2">
                <Image Source="Thing.png"
                       Width="16"
                       Height="16"
                       SnapsToDevicePixels="True"/>
                <TextBlock Text="{Binding Path=Name}" Margin="5,0"/>
            </StackPanel>
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

# .net - MySqlCommand 参数不起作用

> ID：250599
> 
> 赞同：3
> 
> 时间：2008-10-30T15:28:50.213
> 
> 标签：.net, mysql

在以下代码中，用于获取特定行中的产品列表，该命令仅在我硬编码（连接）`productLine`到 SQL 时返回结果。参数替换永远不会发生。

```
 + "lineName = '@productLine' "                       
            + "and isVisible = 1 ";
        MySqlDataAdapter adap = new MySqlDataAdapter(sql, msc);
        adap.SelectCommand.Parameters.Add("@productLine", productLine); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T15:42:07.050

```
 + "lineName = ?productLine "                       
        + "and isVisible = 1 ";
    MySqlDataAdapter adap = new MySqlDataAdapter(sql, msc);
    adap.SelectCommand.Parameters.Add("?productLine", productLine); 
```

1.  删除撇号 (')。
2.  将@改为?，这是MySql查询中参数的前缀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:32:07.337

删除撇号（拼写？）。' 围绕参数。他们不应该被需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:38:01.320

就像他说的

```
+ "lineName = '@productLine' " 
```

应该

```
+ "lineName = @productLine " 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T15:39:05.187

这是正确的，它永远不会发生你有

*   "lineName = '@productLine'"

尝试

*   "lineName = @productLine" 代替 @productLine 将被声明为字符串类型，引号将被秘密添加。但是，您实际上传递的是字符串 @productLine 而不是变量值。

# asp.net-2.0 - 强制 TargetControl 文本框使用 AutocompleteExtender 中的值

> ID：250603
> 
> 赞同：1
> 
> 时间：2008-10-30T15:30:24.063
> 
> 标签：asp.net-2.0, ajaxcontroltoolkit, autocompleteextender

我确定我将不得不编写支持 JavaScript 代码来执行此操作。我设置了一个自动完成扩展器，可以从数据库表中选择值，当进行选择时，我希望它将所选值的 ID 设置为隐藏控件。我可以通过处理文本框上的值更改并对数据库进行选择调用来做到这一点，从公司中选择 idCompany 其中公司名称 =“文本框值”；

最重要的是将作为自动完成扩展器的目标控件的文本框的值限制为仅使用自动完成下拉列表中的值。使用该控件是否可能，是否有示例？是否有更好的控件可供使用（在 ajax 控件工具包或标准 .net 框架内 - 而不是第三方控件）？

我将尝试编写一些 javascript，但我会检查这个问题，看看是否有人有一些有用的链接。我昨晚已经在谷歌上搜索了一段时间。

更新：我没有得到答案或任何有用的链接，我发布了一个几乎可以接受的用户控件，它可以满足我的需求，但有一些可行的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:41:05.720

没有人能给我答案。这是一个持续的传奇。当我试图找到一个[不使用下拉列表来处理大量数据的解决方案](https://stackoverflow.com/questions/247438/alternative-ui-control-for-large-data-lists-instead-of-dropdownlist)时，它就开始了。我在以前的项目中遇到过很多次这个问题。这似乎是可行的代码。现在我需要知道如何提供 AutoPostBack 属性，并允许一些事件，例如 SelectedValueChanged。并且由于 javascript，如果我在同一页面上有多个控件，它将与另一个控件发生冲突。嗯，这是我正在查看代码的一些已知问题，但这是一个开始，并且肯定比在下拉列表加载 30k 列表项时查看挂起的浏览器 3 或 4 分钟要好。

此代码假设有一个 asmx 文件，其中包含脚本方法 GetCompanyListBySearchString 和 GetCompanyIDByCompanyName。

**ASPX文件**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="SelectCompany.ascx.cs" Inherits="Controls_SelectCompany" %>
<%@ Register TagPrefix="ajaxToolkit" Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit" %>
<script language="javascript" type="text/javascript">
    var txtCompanyIDHiddenField = '<%= fldCompanyID.ClientID %>';
    var txtCompanyIDTextBox = '<%= txtCompany.ClientID %>';
    function getCompanyID() {
        if (document.getElementById(txtCompanyIDTextBox).value != "")
            CompanyService.GetCompanyIDByCompanyName(document.getElementById(txtCompanyIDTextBox).value, onCompanyIDSuccess, onCompanyIDFail);
    }
    function onCompanyIDSuccess(sender, e) {
       if (sender == -1)
           document.getElementById(txtCompanyIDTextBox).value = "";
       document.getElementById(txtCompanyIDHiddenField).value = sender;
    }
    function onCompanyIDFail(sender, e) {
        document.getElementById(txtCompanyIDTextBox).value = "";
        document.getElementById(txtCompanyIDHiddenField).value = "-1";
    }
    function onCompanySelected() {
        document.getElementById(txtCompanyIDTextBox).blur();
    }
</script>
<asp:TextBox ID="txtCompany" runat="server"  onblur='getCompanyID()' 
/><ajaxToolkit:AutoCompleteExtender runat="server" ID="aceCompany" CompletionInterval="1000" CompletionSetCount="10"
 MinimumPrefixLength="2"  ServicePath="~/Company/CompanyService.asmx" ServiceMethod="GetCompanyListBySearchString"
 OnClientItemSelected="onCompanySelected" TargetControlID="txtCompany" />
 <asp:HiddenField ID="fldCompanyID" runat="server" Value="0" /> 
```

**代码背后**

```
[System.ComponentModel.DefaultProperty("Text")]
[ValidationProperty("Text")] 
public partial class ApplicationControls_SelectCompany : System.Web.UI.UserControl

{
public string Text
{
    get { return txtCompany.Text; }
    set
    {
        txtCompany.Text = value;
        //this should probably be read only and set the value based off of ID to 
        // make certain this is a valid Company
    }
}
public int CompanyID
{
    get
    {
        int ret = -1; Int32.TryParse(fldCompanyID.Value, out ret); return ret;
    }
    set
    {
        fldCompanyID.Value = value.ToString();
        //Todo:  should set code to set the Text based on the ID to keep things straight
    }
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T16:11:39.450

谢谢你在这里的帖子。它很有用，但是，假设每个人都知道获取由 javascript 函数调用的 web 服务的设置。

很抱歉成为新手，但我无法从客户端调用网络服务。我阅读了这份文档：http: [//msdn.microsoft.com/en-us/magazine/cc163499.aspx](http://msdn.microsoft.com/en-us/magazine/cc163499.aspx)

此外，我发现了一篇有趣的文章，解释了如何创建/获取名称值对，据我所知，这几乎是您所期望的：

[http://blogs.msdn.com/phaniraj/archive/2007/06/19/how-to-use-a-key-value-pair-in-your-autocompleteextender.aspx](http://blogs.msdn.com/phaniraj/archive/2007/06/19/how-to-use-a-key-value-pair-in-your-autocompleteextender.aspx)

对不起，如果我误解了你，但我只是想指导其他经历过同样情况的人。

非常感谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T23:41:36.347

您可以通过捕获 ClientItemSelected 事件来检查选择的值，并确保它不为空。

# unicode - HtmlEncode UTF-8

> ID：250609
> 
> 赞同：4
> 
> 时间：2008-10-30T15:31:40.083
> 
> 标签：unicode, asp-classic, utf-8, character-encoding

我在 asp-classic 中的 utf-8 字符串上使用 Server.HtmlEncode，它可以正常工作，直到字符串中有一些重音符号，例如 Rüstü Recber，它显示为 Rüstü Recber (RÃ¼stÃ ;¼ 来源中的 Recber）。

我尝试将 Response.Charset 属性设置为 utf-8 但这没有任何区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-10T18:56:52.563

更新（已解决）：在页面开头添加 <%@CODEPAGE=65001%> 更正了问题（[http://technet.microsoft.com/en-us/library/bb742422.aspx](http://technet.microsoft.com/en-us/library/bb742422.aspx)）

非常感谢所有的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T15:38:59.943

检查您用于查看文本的编辑器是否设置为显示 utf-8。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:52:13.210

您是否也尝试过 UrlEncode？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T16:21:27.987

您确定字符串在传递给 HtmlEncode 之前是正确的吗？看起来字符串在传递给 HtmlEncode*之前可能编码错误。*

尝试对您知道正确的字符串进行编码，并查看它是否正确编码。

# php - 什么时候/应该在 PHP 中使用 __construct()、__get()、__set() 和 __call()？

> ID：250616
> 
> 赞同：11
> 
> 时间：2008-10-30T15:32:56.820
> 
> 标签：php, magic-function

一个[类似的问题讨论了`__construct`](https://stackoverflow.com/questions/217618/construct-vs-sameasclassname-for-constructor-in-php)，但我把它留在了我的标题中，供搜索找到这个问题的人使用。

显然， __get 和 __set 带有一个参数，即正在获取或设置的变量。但是，您必须知道变量名称（例如，知道该人的年龄是 $age 而不是 $myAge）。因此，如果您必须知道变量名，尤其是在使用您不熟悉的代码（例如库）时，我不明白这一点。

我找到了一些解释[`__get()`](http://www.hudzilla.org/phpbook/read.php/6_14_2)、[`__set()`](http://www.hudzilla.org/phpbook/read.php/6_14_3)和的页面[`__call()`](http://www.hudzilla.org/phpbook/read.php/6_14_4)，但我仍然不明白它们为何有用或何时有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T15:37:39.417

[这个页面](http://uk.php.net/manual/en/language.oop5.overloading.php)可能会有用。（请注意，您所说的不正确-`__set()`将变量的名称和值都作为参数。`__get()`仅采用变量的名称）。

`__get()`并且`__set()`在您想要提供对变量的通用访问的库函数中很有用。例如，在 ActiveRecord 类中，您可能希望人们能够将数据库字段作为对象属性进行访问。例如，在 Kohana PHP 框架中，您可能会使用：

```
$user = ORM::factory('user', 1);
$email = $user->email_address; 
```

这是通过使用`__get()`和来完成的`__set()`。

使用 时可以完成类似的操作`__call()`，即您可以检测到有人何时调用 getProperty() 和 setProperty() 并进行相应处理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-30T15:41:40.517

__get()、__set() 和 __call() 是 PHP 所称的“魔术方法”，我认为这有点愚蠢——我认为“挂钩”更贴切一些。反正我跑题了...

*这些的目的是为访问未*在对象上定义的数据成员（属性或方法）时提供执行案例，可用于各种“聪明”的想法，如变量隐藏、消息转发等。

然而，这是有代价的——调用这些的调用比调用定义的数据成员慢大约 10 倍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T15:42:47.067

重新定义`__get`并且`__set`在核心类中特别有用。例如，如果您不希望您的配置被意外覆盖，但仍想从中获取数据：

```
class Example
{
    private $config = array('password' => 'pAsSwOrD');
    public function __get($name)
    {
        return $this->config[$name];
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T15:58:34.693

魔术方法的另一个有用应用，尤其`__get`是模板。您只需编写使用魔术方法的简单适配器，就可以使您的代码独立于模板引擎。如果您想移动到另一个模板引擎，只需更改这些方法即可。`__set``__toString`

```
class View {

    public $templateFile;
    protected $properties = array();

    public function __set($property, $value) {
        $this->properties[$property] = $value;
    }

    public function __get($property) {
        return @$this->properties[$property];
    }

    public function __toString() {
        require_once 'smarty/libs/Smarty.class.php';
        $smarty = new Smarty();
        $smarty->template_dir = 'view';
        $smarty->compile_dir = 'smarty/compile';
        $smarty->config_dir = 'smarty/config';
        $smarty->cache_dir = 'smarty/cache';
        foreach ($this->properties as $property => $value) {
            $smarty->assign($property, $value);
        }
        return $smarty->fetch($this->templateFile);
    }

} 
```

这种方法的隐藏好处是您可以将 View 对象嵌套在另一个对象中：

```
$index = new View();
$index->templateFile = 'index.tpl';

$topNav = new View();
$topNav->templateFile = 'topNav.tpl';

$index->topNav = $topNav; 
```

在 中`index.tpl`，嵌套看起来像这样：

```
<html>
<head></head>
<body>
    {$topNav}
    Welcome to Foobar Corporation.
</body>
</html> 
```

所有嵌套的 View 对象都会即时转换为字符串（准确地说是 HTML）`echo $index;`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-04T12:44:11.723

我认为这对设计代码不利。如果你知道并做了一个好的设计，那么你就不需要在你的代码中使用`__set()`and了。`__get()`阅读您的代码也非常重要，如果您使用的是工作室（例如 Zend 工作室），`__set()`那么`__get()`您将看不到您的类属性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-16T05:22:48.173

PHP 允许我们动态创建可能导致问题的类变量。您可以使用 __set 和 __get 方法来限制这种行为。请参阅下面的示例...

```
class Person { 
      public $name;
      public function printProperties(){
       print_r(get_object_vars($this));
      }
}

$person = new Person();
$person->name = 'Jay'; //This is valid
$person->printProperties();
$person->age = '26';  //This shouldn't work...but it does 
$person->printProperties(); 
```

为了防止上面你可以这样做..

```
public function __set($name, $value){
    $classVar = get_object_vars($this);
    if(in_array($name, $classVar)){
    $this->$name = $value;
    }
} 
```

希望这可以帮助...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T15:38:00.413

他们是为了做“聪明”的事情。

例如，您可以使用`__set()`and`__get()`与数据库对话。您的代码将是：`$myObject->foo = "bar";`这可以在幕后更新数据库记录。当然，您必须对此非常小心，否则您的表现可能会受到影响，因此“聪明”周围的引号:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T15:39:21.580

在处理包含易于访问的数据的 PHP 对象时，[重载方法特别有用。](http://uk.php.net/manual/en/language.oop5.overloading.php)[__get()](http://www.hudzilla.org/phpbook/read.php/6_14_2)[在](http://www.hudzilla.org/phpbook/read.php/6_14_4)访问不存在的属性时调用， [__set()](http://www.hudzilla.org/phpbook/read.php/6_14_3)在尝试编写不存在的属性时调用，__call() 在调用不存在的方法时调用。

例如，想象有一个类管理您的配置：

```
class Config
{
    protected $_data = array();

    public function __set($key, $val)
    {
        $this->_data[$key] = $val;
    }

    public function __get($key)
    {
        return $this->_data[$key];
    }

    ...etc

} 
```

这使得读取和写入对象变得更加容易，并让您在读取或写入对象时更改为使用自定义功能。例子：

```
$config = new Config();
$config->foo = 'bar';

echo $config->foo; // returns 'bar' 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-30T15:43:06.863

使用它们的一个很好的理由是注册系统（我认为 Zend Framework 将其实现为注册或配置类 iirc），因此您可以执行以下操作

```
$conf = new Config();
$conf->parent->child->grandchild = 'foo'; 
```

这些属性中的每一个都是自动生成的 Config 对象，类似于：

```
function __get($key) {
    return new Config($key);
} 
```

显然，如果 $conf->parent 已经存在，__get() 方法就不会被调用，所以使用它来生成新变量是一个不错的技巧。

请记住，我刚刚引用的这段代码不是功能性的，我只是为了举例而快速编写它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-30T15:47:03.827

可能不是世界上最干净的设计，但我有很多代码引用类中的实例变量，即：

```
$obj->value = 'blah';
echo $obj->value; 
```

但后来，我想在某些情况下设置“值”时做一些特别的事情，所以我重命名了值变量，并用我需要的更改实现了 __set() 和 __get()。

其余的代码不知道有什么区别。

# wpf - MouseOver 突出显示样式在一秒钟后返回默认值（由 Aero 引起？）

> ID：250622
> 
> 赞同：1
> 
> 时间：2008-10-30T15:33:45.133
> 
> 标签：wpf, xaml, combobox, triggers, mouseover

我试图设置我的 ComboBoxes 的样式以匹配 UI 的其余部分，但我遇到了 IsMouseOver 突出显示的问题。它以我指定的颜色突出显示一秒钟，然后淡出默认颜色，这是一种很酷的效果，但不是我想要的。这是我的风格：

```
<Style TargetType="ComboBox">
    <Style.Triggers>
        <Trigger Property="ComboBox.IsMouseOver" Value="True">
            <Setter Property = "Background" Value="Red"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

我该怎么做才能使背景颜色保持不变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T02:29:42.970

问题确实是由于 ComboBox 的默认模板。如果您使用[Reflector](http://www.red-gate.com/products/reflector/)打开 PresentationFramework.Aero 程序集，您可以查看 ButtonChrome 类。有一个名为 OnRenderMouseOverChanged 的​​方法可以隐藏红色背景。

尽管工作量很大，但至少对于 ComboBox，您可能希望覆盖 ComboBox 的默认模板。[您可以通过使用Show Me The Template](http://www.sellsbrothers.com/news/showTopic.aspx?ixTopic=2091)或[Blend](http://www.microsoft.com/expression/products/Overview.aspx?key=blend)来了解 ComboBox 模板是什么样的基本概念。

您可以使用相同的样式来覆盖模板。

```
<Style TargetType="{x:Type ComboBox}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ComboBox}">
                <!-- Template Here -->
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-30T16:34:36.913

您可以通过从 WPF Visual Studio 设计器获取默认模板的副本来覆盖此行为，然后在 ComboBoxReadonlyToggleButton 样式中注释掉 ButtonChrome 部分并将其替换为边框。这是我找到解决方案的网站的链接 - [http://www.scriptscoop.net/t/d346cf01d844/cc-wpf-combobox-mouse-over-color.html](http://www.scriptscoop.net/t/d346cf01d844/c-c-wpf-combobox-mouse-over-color.html)

这是我的代码片段

```
<Style x:Key="ComboBoxReadonlyToggleButton" TargetType="{x:Type ToggleButton}">
  <Setter Property="OverridesDefaultStyle" Value="true"/>
  <Setter Property="IsTabStop" Value="false"/>
  <Setter Property="Focusable" Value="false"/>
  <Setter Property="ClickMode" Value="Press"/>
  <Setter Property="Background" Value="Transparent"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type ToggleButton}">
        <!-- Replace the ButtonChrome - this eliminated the following
             problem:  When the mouse was moved over the ComboBox
             the color would change to the color defined in ___ but 
             then would  
             immediately change to the default Aero blue
             gradient background of 2 powder blue colors  - 
             Had to comment out the          
             below code and replace it as shown
             <Themes:ButtonChrome x:Name="Chrome" BorderBrush="                 {TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" RenderMouseOver="{TemplateBinding IsMouseOver}" RenderPressed="{TemplateBinding IsPressed}" SnapsToDevicePixels="true">
               <Grid HorizontalAlignment="Right" Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}">
                 <Path x:Name="Arrow" Data="{StaticResource DownArrowGeometry}" Fill="Black" HorizontalAlignment="Center" Margin="3,1,0,0" VerticalAlignment="Center"/>
               </Grid>
             </Themes:ButtonChrome>-->

         <!-- Here is the code to replace the ButtonChrome code -->
         <Border x:Name="Chrome" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
           <Grid HorizontalAlignment="Right" Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}">
             <Path x:Name="Arrow" Data="{StaticResource DownArrowGeometry}" Fill="Black" HorizontalAlignment="Center" Margin="3,1,0,0" VerticalAlignment="Center"/>
           </Grid>
         </Border>
       <!-- End of code to replace the Button Chrome --> 
```

我还添加了一些代码来将背景颜色更改为 DarkOrange - 此代码进入 ComboBox 样式的 ControlTemplate（在该部分中）。

```
<!-- Hover Code - Code that was added to change the ComboBox background 
     color when the use hovers over it with the mouse -->
<Trigger Property="IsMouseOver" Value="True">
   <Setter Property="Background" Value="DarkOrange"></Setter>
</Trigger>
<!-- Hover Code - End --> 
```

# javascript - jQuery 绑定的事件处理程序

> ID：250643
> 
> 赞同：0
> 
> 时间：2008-10-30T15:38:32.223
> 
> 标签：javascript, jquery, events

我想使用[jQuery](http://en.wikipedia.org/wiki/JQuery)将“click”事件处理程序附加到 ID 为“foo”的元素的第一个子元素。我知道这样做的语法是：

```
$('#foo:first-child').bind('click', function(event) {
    // I want to access the first child here
}) 
```

在处理程序主体中，我想访问导致事件被触发的元素。我在某处读到您不能简单地通过“this”引用它，那么我该如何访问它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T15:41:42.153

```
$(this).doStuff() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T15:43:53.537

忘记你在某处读过的内容，继续使用 this 关键字：

```
$("#foo:first-child").click(function(event) {
  $(this).css("background", "pink");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T15:42:13.353

只需使用“这个”：

```
$('#foo:first-child').bind('click', function(event) {
  alert(this === $('#foo:first-child')); // True
  this.style.color = "red"; // First child now has red text.
}) 
```

# vim - VIM初始设置：更改左侧行号的背景颜色？

> ID：250652
> 
> 赞同：36
> 
> 时间：2008-10-30T15:40:16.087
> 
> 标签：vim

我`_vimrc`用来配置我的 vim 7.2 (windows) 默认设置。一项设置“设置编号”将在左侧显示行号。我的 vim 背景颜色是白色（我找不到这个设置。也许默认是白色的。无论如何我接受这个设置）。

我希望行号的背景颜色为灰色或暗色。我可以输入什么命令`_vimrc`来配置此默认设置？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-30T15:47:21.317

```
highlight LineNr ctermfg=grey ctermbg=white 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-01-11T09:50:44.297

要使行号列透明（与主背景颜色相同），您可以尝试在您的`.vimrc`:

```
highlight clear LineNr 
```

您还可以清除所谓的符号列（由 gitgutter 等使用）：

```
highlight clear SignColumn 
```

这样，无论您使用哪种配色方案，两列的背景都将兼容。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-30T17:08:26.020

在我的`_vimrc`，这里是设置：

```
highlight LineNr guibg=grey 
```

或者

```
hi LineNr guibg=grey 
```

我不需要设置前景色，默认是黄色的，对我来说没问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-11-06T22:53:40.723

**guibg**和**guifg**用于不在终端中的 vim。对于终端，您使用**ctermfg** **ctermbg**。通常在 GUI vim 中你有更多的颜色支持，你只是想避免背景。所以我通常使用这个：

```
highlight LineNr guibg=NONE 
```

# sharepoint - 是否可以将工作流附加到 MOSS 2007 上的任务列表？

> ID：250671
> 
> 赞同：1
> 
> 时间：2008-10-30T15:43:53.273
> 
> 标签：sharepoint, sharepoint-2007, workflow

我已经尝试过，但由于某种原因，工作流程没有被触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T12:02:00.393

是的，这是允许的。我自己将它用于任务列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T16:06:47.900

它应该适用于所有其他类型的列表。

# php - 使用 PHP 解析 RSS/Atom 提要的最佳方法

> ID：250679
> 
> 赞同：138
> 
> 时间：2008-10-30T15:46:12.067
> 
> 标签：php, parsing, rss, atom-feed

我目前正在使用[Magpie RSS](http://magpierss.sourceforge.net/)，但是当 RSS 或 Atom 提要格式不正确时，它有时会崩溃。是否有任何其他选项可用于使用 PHP 解析 RSS 和 Atom 提要？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-10-30T17:47:00.577

我一直使用[PHP 内置的 SimpleXML 函数](http://us2.php.net/simplexml)来解析 XML 文档。它是为数不多的具有直观结构的通用解析器之一，这使得为特定的东西（如 RSS 提要）构建有意义的类变得非常容易。此外，它会检测 XML 警告和错误，并且在找到任何内容后，您可以简单地通过 HTML Tidy（如 ceejayoz 提到的）之类的东西运行源代码来清理它并再次尝试。

考虑这个使用 SimpleXML 的非常粗略、简单的类：

```
class BlogPost
{
    var $date;
    var $ts;
    var $link;

    var $title;
    var $text;
}

class BlogFeed
{
    var $posts = array();

    function __construct($file_or_url)
    {
        $file_or_url = $this->resolveFile($file_or_url);
        if (!($x = simplexml_load_file($file_or_url)))
            return;

        foreach ($x->channel->item as $item)
        {
            $post = new BlogPost();
            $post->date  = (string) $item->pubDate;
            $post->ts    = strtotime($item->pubDate);
            $post->link  = (string) $item->link;
            $post->title = (string) $item->title;
            $post->text  = (string) $item->description;

            // Create summary as a shortened body and remove images, 
            // extraneous line breaks, etc.
            $post->summary = $this->summarizeText($post->text);

            $this->posts[] = $post;
        }
    }

    private function resolveFile($file_or_url) {
        if (!preg_match('|^https?:|', $file_or_url))
            $feed_uri = $_SERVER['DOCUMENT_ROOT'] .'/shared/xml/'. $file_or_url;
        else
            $feed_uri = $file_or_url;

        return $feed_uri;
    }

    private function summarizeText($summary) {
        $summary = strip_tags($summary);

        // Truncate summary line to 100 characters
        $max_len = 100;
        if (strlen($summary) > $max_len)
            $summary = substr($summary, 0, $max_len) . '...';

        return $summary;
    }
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-11-03T10:14:37.233

用 4 行，我将一个 rss 导入到一个数组中。

```
$feed = implode(file('http://yourdomains.com/feed.rss'));
$xml = simplexml_load_string($feed);
$json = json_encode($xml);
$array = json_decode($json,TRUE); 
```

对于更复杂的解决方案

```
$feed = new DOMDocument();
 $feed->load('file.rss');
 $json = array();
 $json['title'] = $feed->getElementsByTagName('channel')->item(0)->getElementsByTagName('title')->item(0)->firstChild->nodeValue;
 $json['description'] = $feed->getElementsByTagName('channel')->item(0)->getElementsByTagName('description')->item(0)->firstChild->nodeValue;
 $json['link'] = $feed->getElementsByTagName('channel')->item(0)->getElementsByTagName('link')->item(0)->firstChild->nodeValue;
 $items = $feed->getElementsByTagName('channel')->item(0)->getElementsByTagName('item');

 $json['item'] = array();
 $i = 0;

 foreach($items as $key => $item) {
 $title = $item->getElementsByTagName('title')->item(0)->firstChild->nodeValue;
 $description = $item->getElementsByTagName('description')->item(0)->firstChild->nodeValue;
 $pubDate = $item->getElementsByTagName('pubDate')->item(0)->firstChild->nodeValue;
 $guid = $item->getElementsByTagName('guid')->item(0)->firstChild->nodeValue;

 $json['item'][$key]['title'] = $title;
 $json['item'][$key]['description'] = $description;
 $json['item'][$key]['pubdate'] = $pubDate;
 $json['item'][$key]['guid'] = $guid; 
 }

echo json_encode($json); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-30T15:53:35.157

您的其他选择包括：

*   [简单派](http://simplepie.org/)
*   [最后一个RSS](http://lastrss.oslab.net/)
*   [PHP 通用提要解析器](http://www.phpclasses.org/package/4548-PHP-Parse-RSS-and-ATOM-feeds.html)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2014-09-12T17:08:44.003

我想介绍一个简单的脚本来解析 RSS：

```
$i = 0; // counter
$url = "http://www.banki.ru/xml/news.rss"; // url to parse
$rss = simplexml_load_file($url); // XML parser

// RSS items loop

print '<h2><img style="vertical-align: middle;" src="'.$rss->channel->image->url.'" /> '.$rss->channel->title.'</h2>'; // channel title + img with src

foreach($rss->channel->item as $item) {
if ($i < 10) { // parse only 10 items
    print '<a href="'.$item->link.'">'.$item->title.'</a><br />';
}

$i++;
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-27T13:30:21.303

如果提要不是格式良好的 XML，您应该拒绝它，没有例外。您有权称提要创建者[为 bozo](http://www.tbray.org/ongoing/When/200x/2004/01/11/PostelPilgrim)。

否则，您正在为最终导致 HTML 混乱铺平道路。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-30T17:16:08.267

HTML Tidy 库能够修复一些格式错误的 XML 文件。在将它们传递给解析器之前运行你的提要可能会有所帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-30T15:55:06.900

我使用[SimplePie](http://simplepie.org/)来解析 Google Reader 提要，它运行良好，并且具有不错的功能集。

当然，我还没有使用非格式良好的 RSS / Atom 提要对其进行测试，所以我不知道它是如何应对这些的，我假设 Google 是相当符合标准的！:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-18T12:34:59.480

我个人使用 BNC Advanced Feed Parser - 我喜欢非常易于使用的模板系统

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-09-27T16:08:27.717

PHP RSS 阅读器 - [http://www.scriptol.com/rss/rss-reader.php](http://www.scriptol.com/rss/rss-reader.php) - 是一个完整而简单的解析器，成千上万的用户都在使用...

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2014-02-17T10:02:35.243

另一个很棒的免费解析器 - [http://bncscripts.com/free-php-rss-parser/](http://bncscripts.com/free-php-rss-parser/) 它非常轻巧（只有 3kb）并且使用简单！

# ruby-on-rails - 使用 AASM 调用状态更改方法

> ID：250685
> 
> 赞同：1
> 
> 时间：2008-10-30T15:47:21.253
> 
> 标签：ruby-on-rails, ruby, state-machine

如何在 AASM 中调用状态更改方法？

当状态转换为以下模型中的已付款时，我想调用 update_foo ：

```
class Foo < ActiveRecord::Base
  include AASM

  # State Machine
  aasm_initial_state :incomplete
  aasm_state :incomplete
  aasm_state :paid

  aasm_event :pay do
    transitions :from => :incomplete, :to => :paid
  end

  def update_foo
  ...
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T15:48:17.617

没关系 - 想通了：

```
aasm_state :paid, :enter => :update_foo 
```

# ruby-on-rails - 在乘客 Rails 应用程序中包含 ~/opt/lib 库

> ID：250687
> 
> 赞同：5
> 
> 时间：2008-10-30T15:47:47.290
> 
> 标签：ruby-on-rails, ruby, passenger, dreamhost

我无法在 Dreamhost 的Passenger 上获取rails 应用程序，以便在我的~/opt/lib 目录中查看已编译的库。我必须把它们放在这里，因为我没有 root 访问权限。

我可以在 ./script/console 中启动我的应用程序，它可以很好地看到它们的库，因为我更新了 .bash_profile 的`LD_LIBRARY_PATH`环境变量以包含 ~/opt/lib。

我试过放入`ENV['LD_LIBRARY_PATH'] = '~/opt/lib'`我的 environment.rb 文件，但它似乎没有太大帮助。当我导航到我的站点时，Passenger 收到以下错误：libodbcinst.so.1：无法打开共享对象文件：没有这样的文件或目录 - /home/username/opt/lib/odbc.so

有人有这方面的经验吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T09:11:59.257

我在[http://blog.rayapps.com/2008/05/21/using-mod_rails-with-rails-applications-on-oracle/中描述的Passenger有类似的问题](http://blog.rayapps.com/2008/05/21/using-mod_rails-with-rails-applications-on-oracle/)

但在您的情况下，这可能不起作用，因为您将无法更改 Dreamhost 的 httpd.conf 文件。

您可以尝试的其他事情是在 .bashrc 中设置 LD_LIBRARY_PATH - 根据[http://www.wavethenavel.com/jonathanpenn/2008/09/08/bootstrapping-a-dreamhost-account-for-rails-and-git/](http://www.wavethenavel.com/jonathanpenn/2008/09/08/bootstrapping-a-dreamhost-account-for-rails-and-git/)这在 Dreamhost 的案例中是有效的。尚未验证Passenger 将在启动ruby 之前执行.bashrc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T10:05:29.203

使用`.bashrc`不起作用，因为Passenger 使用的库路径是Apache 在启动时加载的路径。它不可能查看用户的目录，因为这将是一个主要的安全问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T20:54:22.707

environment.rb 方式听起来像是要走的路，尽管您可能想要追加到`LD_LIBRARY_PATH`。另外，我会确保使用该目录的完整路径以防万一。

或者，您可能能够使用`.htaccess`指令，类似于 @ [http://wiki.rubyonrails.org/rails/pages/HowToUseOracleWithFastCGI所描述的](http://wiki.rubyonrails.org/rails/pages/HowToUseOracleWithFastCGI)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-16T06:42:41.147

这是一个旧线程，但为了完整起见，这是实现目标的方法：

1.  如果可能，不要设置 LD_LIBRARY_PATH - 这太可怕了。
2.  由于您无法控制 Apache 用户的环境，因此尝试按照上述方法设置 LD_LIBRARY_PATH 环境变量无论如何都不起作用。
3.  在编译库文件之前设置 LDFLAGS 环境变量并设置链接和记录路径标志以设置正确的搜索路径 - 例如：

    导出 LDFLAGS="-L$HOME/opt/lib -R$HOME/opt/lib"

编译后，这些文件将具有指向相关库的正确链接。您可以使用 ldd 命令行工具进行检查 - 例如：

```
ldd /$HOME/your/custom/complied/library/file.so 
```

# javascript - 使用 jQuery 计算直接子 div 元素

> ID：250688
> 
> 赞同：188
> 
> 时间：2008-10-30T15:47:52.110
> 
> 标签：javascript, jquery, dom, jquery-selectors

我有以下 HTML 节点结构：

```
<div id="foo">
  <div id="bar"></div>
  <div id="baz">
    <div id="biz"></div>
  </div>
  <span></span>
</div> 
```

如何计算`foo`类型的直接子级的数量`div`？在上面的示例中，结果应该是两个 (`bar`和`baz`)。

* * *

## 回答 #1

> 赞同：359
> 
> 时间：2008-10-30T15:49:53.027

```
$("#foo > div").length 
```

id 为 'foo' 的元素的直接子元素，它们是 div。然后检索生成的包装集的大小。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2011-08-16T20:13:15.530

我建议使用`$('#foo').children().size()`以获得更好的性能。

我创建了一个[jsperf](http://jsperf.com/jquery-child-ele-size)测试以查看速度差异，并且该方法在 Chrome（canary build v15）中`children()`比子选择器（#foo > div）方法至少高出**60%** ，在 Firefox（v4）中高出**20-30% 。**

顺便说一句，不用说，这两种方法产生相同的结果（在本例中为 1000）。

[更新] 我已经更新了测试以包括 size() 与长度测试，它们并没有太大区别（结果：`length`使用率略快 (2%) 比`size()`）

*[更新] 由于在 OP 中看到的标记不正确（在我进行“标记验证”更新之前），两者`$("#foo > div").length`&`$('#foo').children().length`结果相同（[jsfiddle](http://jsfiddle.net/LavMc/)）。但是为了得到正确的答案，只得到'div'孩子，一个应该使用孩子选择器以获得正确和更好的表现*

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-31T01:22:17.350

```
$("#foo > div") 
```

选择所有 div 是 #foo 的直接后代，
一旦您拥有一组孩子，您可以使用 size 函数：

```
$("#foo > div").size() 
```

或者你可以使用

```
$("#foo > div").length 
```

两者都会返回相同的结果

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-10-23T10:22:35.080

```
$('#foo').children('div').length 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-09-09T16:50:18.747

为了回应 mrCoders 使用 jsperf 的回答，为什么不只使用 dom 节点？

```
var $foo = $('#foo');
var count = $foo[0].childElementCount 
```

您可以在这里尝试测试：http: [//jsperf.com/jquery-child-ele-size/7](http://jsperf.com/jquery-child-ele-size/7)

此方法获得 46,095 op/s，而其他方法最多 2000 op/s

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-30T15:51:10.433

```
$('#foo > div').size() 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-12-05T12:50:45.140

```
$("#foo > div").length 
```

jQuery 有一个 .size() 函数，它会返回元素出现的次数，但是，正如 jQuery 文档中所指定的，它速度较慢，并且返回与 .length 属性相同的值，因此最好简单地使用 .length 属性。长度属性。从这里：[http ://www.electrictoolbox.com/get-total-number-matched-elements-jquery/](http://www.electrictoolbox.com/get-total-number-matched-elements-jquery/)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-03-19T22:04:25.100

```
var divss = 0;
$(function(){
   $("#foo div").each(function(){
    divss++;

   });
   console.log(divss);  
});     
<div id="foo">
  <div id="bar" class="1"></div>
  <div id="baz" class="1"></div>
  <div id="bam" class="1"></div>
</div> 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-10-12T17:38:54.153

使用最新版本的 jquery，您可以使用`$("#superpics div").children().length`.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-12-20T22:11:32.367

```
var n_numTabs = $("#superpics div").size(); 
```

**或者**

```
var n_numTabs = $("#superpics div").length; 
```

* * *

如前所述，两者都返回相同的结果。
但是 size() 函数更像是 jQuery“PC”。
我的页面也有类似的问题。
现在，只需省略 > 它应该可以正常工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-13T14:29:04.747

```
$("div", "#superpics").size(); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-10-03T07:50:37.383

试试这个 div 类型的直接子元素

```
$("#foo > div")[0].children.length 
```

# javascript - 用于人名的 JS 正则表达式

> ID：250690
> 
> 赞同：3
> 
> 时间：2008-10-30T15:48:26.947
> 
> 标签：javascript, regex, string, text

我正在寻找一个好的 JavaScript RegEx 来将名称转换为适当的大小写。例如：

```
John SMITH = John Smith

Mary O'SMITH = Mary O'Smith

E.t MCHYPHEN-SMITH = E.T McHyphen-Smith  

John Middlename SMITH = John Middlename SMITH 
```

反正你懂这个意思。

有人想出一个全面的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:18:00.630

像这样的东西？

```
function fix_name(name) {
    var replacer = function (whole,prefix,word) {
        ret = [];
        if (prefix) {
            ret.push(prefix.charAt(0).toUpperCase());
            ret.push(prefix.substr(1).toLowerCase());
        }
        ret.push(word.charAt(0).toUpperCase());
        ret.push(word.substr(1).toLowerCase());
        return ret.join('');
    }
    var pattern = /\b(ma?c)?([a-z]+)/ig;
    return name.replace(pattern, replacer);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T16:11:34.167

懦夫！....这是我的第二次尝试。处理“John SMITH”、“Mary O'SMITH”、“John Middlename SMITH”、“Et MCHYPHEN-SMITH”和“JoHn-JOE MacDoNAld”

```
Regex fixnames = new Regex("(Ma?C)?(\w)(\w*)(\W*)");
string newName = fixnames.Replace(badName, NameFixer);

static public string NameFixer(Match match) 
{
    string mc = "";
    if (match.Groups[1].Captures.Count > 0)
    {
        if (match.Groups[1].Captures[0].Length == 3)
            mc = "Mac";
        else
            mc = "Mc";
    }

    return 
       mc
      +match.Groups[2].Captures[0].Value.ToUpper()
      +match.Groups[3].Captures[0].Value.ToLower()
      +match.Groups[4].Captures[0].Value;
} 
```

注意：当我意识到你想要一个 Javascript 解决方案而不是一个 .NET 解决方案时，我实在是太有趣了，无法停下来......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T20:59:50.047

[Mark Summerfield 用Lingua::EN::NameCase](http://search.cpan.org/perldoc?Lingua::EN::NameCase)完成了这方面的全面工作：

```
KEITH               Keith
LEIGH-WILLIAMS      Leigh-Williams
MCCARTHY            McCarthy
O'CALLAGHAN         O'Callaghan
ST. JOHN            St. John
VON STREIT          von Streit
VAN DYKE            van Dyke
AP LLWYD DAFYDD     ap Llwyd Dafydd
henry viii          Henry VIII
louis xiv           Louis XIV 
```

以上是用 Perl 编写的，但它大量使用了正则表达式，因此您应该能够收集到一些好的技巧。

这里的相关来源：

```
sub nc {

    croak "Usage: nc [[\\]\$SCALAR]"
        if scalar @_ > 1 or ( ref $_[0] and ref $_[0] ne 'SCALAR' ) ;

    local( $_ ) = @_ if @_ ;
    $_ = ${$_} if ref( $_ ) ;           # Replace reference with value.

    $_ = lc ;                           # Lowercase the lot.
    s{ \b (\w)   }{\u$1}gox ;           # Uppercase first letter of every word.
    s{ (\'\w) \b }{\L$1}gox ;           # Lowercase 's.

    # Name case Mcs and Macs - taken straight from NameParse.pm incl. comments.
    # Exclude names with 1-2 letters after prefix like Mack, Macky, Mace
    # Exclude names ending in a,c,i,o, or j are typically Polish or Italian

    if ( /\bMac[A-Za-z]{2,}[^aciozj]\b/o or /\bMc/o ) {
        s/\b(Ma?c)([A-Za-z]+)/$1\u$2/go ;

        # Now correct for "Mac" exceptions
        s/\bMacEvicius/Macevicius/go ;  # Lithuanian
        s/\bMacHado/Machado/go ;        # Portuguese
        s/\bMacHar/Machar/go ;
        s/\bMacHin/Machin/go ;
        s/\bMacHlin/Machlin/go ;
        s/\bMacIas/Macias/go ;  
        s/\bMacIulis/Maciulis/go ;  
        s/\bMacKie/Mackie/go ;
        s/\bMacKle/Mackle/go ;
        s/\bMacKlin/Macklin/go ;
        s/\bMacQuarie/Macquarie/go ;
    s/\bMacOmber/Macomber/go ;
    s/\bMacIn/Macin/go ;
    s/\bMacKintosh/Mackintosh/go ;
    s/\bMacKen/Macken/go ;
    s/\bMacHen/Machen/go ;
    s/\bMacisaac/MacIsaac/go ;
    s/\bMacHiel/Machiel/go ;
    s/\bMacIol/Maciol/go ;
    s/\bMacKell/Mackell/go ;
    s/\bMacKlem/Macklem/go ;
    s/\bMacKrell/Mackrell/go ;
    s/\bMacLin/Maclin/go ;
    s/\bMacKey/Mackey/go ;
    s/\bMacKley/Mackley/go ;
    s/\bMacHell/Machell/go ;
    s/\bMacHon/Machon/go ;
    }
    s/Macmurdo/MacMurdo/go ;

    # Fixes for "son (daughter) of" etc. in various languages.
    s{ \b Al(?=\s+\w)  }{al}gox ;   # al Arabic or forename Al.
    s{ \b Ap        \b }{ap}gox ;       # ap Welsh.
    s{ \b Ben(?=\s+\w) }{ben}gox ;  # ben Hebrew or forename Ben.
    s{ \b Dell([ae])\b }{dell$1}gox ;   # della and delle Italian.
    s{ \b D([aeiu]) \b }{d$1}gox ;      # da, de, di Italian; du French.
    s{ \b De([lr])  \b }{de$1}gox ;     # del Italian; der Dutch/Flemish.
    s{ \b El        \b }{el}gox unless $SPANISH ;   # el Greek or El Spanish.
    s{ \b La        \b }{la}gox unless $SPANISH ;   # la French or La Spanish.
    s{ \b L([eo])   \b }{l$1}gox ;      # lo Italian; le French.
    s{ \b Van(?=\s+\w) }{van}gox ;  # van German or forename Van.
    s{ \b Von       \b }{von}gox ;  # von Dutch/Flemish

    # Fixes for roman numeral names, e.g. Henry VIII, up to 89, LXXXIX
    s{ \b ( (?: [Xx]{1,3} | [Xx][Ll]   | [Ll][Xx]{0,3} )?
            (?: [Ii]{1,3} | [Ii][VvXx] | [Vv][Ii]{0,3} )? ) \b }{\U$1}gox ;

    $_ ;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T15:51:37.140

不幸的是，有太多不同的名称格式无法正确执行此操作。约翰-乔·麦克唐纳总是令人讨厌！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T15:53:52.113

同意它永远不会完美，但希望得到最常见的情况。这几乎是驼峰式的任何“单词”，并且我猜想将连字符和撇号处理为空格。

# .net - 你如何对私有方法进行单元测试？

> ID：250692
> 
> 赞同：498
> 
> 时间：2008-10-30T15:49:12.340
> 
> 标签：.net, unit-testing, tdd, private

我正在构建一个包含一些公共和私有方法的类库。我希望能够对私有方法进行单元测试（主要是在开发时，但它也可能对未来的重构有用）。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：356
> 
> 时间：2008-10-30T15:54:26.683

如果您想对私有方法进行单元测试，则可能有问题。单元测试（一般而言）旨在测试类的接口，即其公共（和受保护）方法。您当然可以“破解”解决方案（即使只是通过公开方法），但您可能还需要考虑：

1.  如果您要测试的方法确实值得测试，那么将它移到自己的类中可能是值得的。
2.  向调用私有方法的公共方法添加更多测试，测试私有方法的功能。（正如评论员所指出的，只有当这些私有方法的功能确实是公共接口的一部分时，您才应该这样做。如果它们实际上执行对用户隐藏的功能（即单元测试），这可能很糟糕）。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2008-10-30T15:52:37.793

如果您使用的是 .net，则应使用[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。

* * *

## 回答 #3

> 赞同：120
> 
> 时间：2010-10-29T13:50:23.910

测试私有方法可能没有用。但是，我有时也喜欢从测试方法中调用私有方法。大多数时候为了防止测试数据生成的代码重复......

Microsoft 为此提供了两种机制：

**访问器**

*   转到类定义的源代码
*   右键单击类的名称
*   选择“创建私人访问器”
*   选择应该在其中创建访问器的项目 => 您最终将得到一个名为 foo_accessor 的新类。该类将在编译期间动态生成，并提供所有可用的成员。

但是，当涉及到更改原始类的接口时，该机制有时会有些棘手。所以，大多数时候我避免使用它。

**PrivateObject 类** 另一种方法是使用 Microsoft.VisualStudio.TestTools.UnitTesting.PrivateObject

```
// Wrap an already existing instance
PrivateObject accessor = new PrivateObject( objectInstanceToBeWrapped );

// Retrieve a private field
MyReturnType accessiblePrivateField = (MyReturnType) accessor.GetField( "privateFieldName" );

// Call a private method
accessor.Invoke( "PrivateMethodName", new Object[] {/* ... */} ); 
```

* * *

## 回答 #4

> 赞同：82
> 
> 时间：2010-10-19T06:34:08.920

我不同意“你应该只对测试外部接口感兴趣”的理念。这有点像说汽车修理店应该只测试车轮是否转动。是的，最终我对外部行为感兴趣，但我喜欢我自己的、私人的、内部测试更具体、更切题。是的，如果我重构，我可能不得不更改一些测试，但除非它是一个大规模的重构，否则我只需要更改一些并且其他（未更改的）内部测试仍然有效的事实是一个很好的指标重构已经成功。

您可以尝试仅使用公共接口覆盖所有内部案例，理论上可以完全使用公共接口测试每个内部方法（或至少每个重要的方法），但您可能最终不得不站在头上才能实现这以及通过公共接口运行的测试用例与它们设计用于测试的解决方案的内部部分之间的联系可能很难或无法辨别。已经指出，保证内部机器正常工作的个别测试非常值得重构带来的微小测试更改 - 至少这是我的经验。如果每次重构都必须对测试进行重大更改，那么这可能没有意义，但在这种情况下，也许您应该完全重新考虑您的设计。

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2008-10-30T16:04:04.777

在极少数情况下我想测试私有函数，我通常将它们修改为受保护，并且我编写了一个带有公共包装函数的子类。

班上：

```
...

protected void APrivateFunction()
{
    ...
}

... 
```

用于测试的子类：

```
...

[Test]
public void TestAPrivateFunction()
{
    APrivateFunction();
    //or whatever testing code you want here
}

... 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2012-10-24T16:30:01.230

我认为应该问一个更基本的问题是，您为什么要首先尝试测试私有方法。这是一种代码味道，您试图通过该类的公共接口测试私有方法，而该方法是私有的，因为它是一个实现细节。人们应该只关心公共接口的行为，而不是它是如何在幕后实现的。

如果我想测试私有方法的行为，通过使用常见的重构，我可以将其代码提取到另一个类中（可能具有包级别的可见性，因此确保它不是公共 API 的一部分）。然后我可以单独测试它的行为。

重构的产物意味着私有方法现在是一个单独的类，它已成为原始类的协作者。它的行为将通过它自己的单元测试得到很好的理解。

然后，当我尝试测试原始类时，我可以模拟它的行为，这样我就可以专注于测试该类的公共接口的行为，而不必测试公共接口的组合爆炸及其所有私有方法的行为.

我认为这类似于驾驶汽车。当我开车时，我不会开着引擎盖开车，所以我可以看到引擎在工作。我依靠汽车提供的界面，即转速表和速度表来了解发动机是否在工作。我相信当我踩下油门踏板时汽车实际上会移动。如果我想测试引擎，我可以单独对其进行检查。:D

当然，如果您有遗留应用程序，直接测试私有方法可能是最后的手段，但我更希望重构遗留代码以实现更好的测试。Michael Feathers 就这个主题写了一本很棒的书。[http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2010-05-25T07:44:15.870

由于某种原因，私有类型、内部结构和私有成员都是如此，而且您通常不想直接与它们打交道。如果你这样做了，你以后很可能会崩溃，因为不能保证创建这些程序集的人会保留私有/内部实现。

但是，有时，在对已编译或第三方程序集进行一些破解/探索时，我自己最终想要初始化一个私有类或具有私有或内部构造函数的类。或者，有时，在处理我无法更改的预编译遗留库时——我最终会针对私有方法编写一些测试。

因此诞生了 AccessPrivateWrapper - [http://amazedsaint.blogspot.com/2010/05/accessprivatewrapper-c-40-dynamic.html](http://amazedsaint.blogspot.com/2010/05/accessprivatewrapper-c-40-dynamic.html) - 它是一个快速包装类，使用 C# 4.0 动态特性和反射可以轻松完成工作。

您可以创建内部/私有类型，例如

```
 //Note that the wrapper is dynamic
    dynamic wrapper = AccessPrivateWrapper.FromType
        (typeof(SomeKnownClass).Assembly,"ClassWithPrivateConstructor");

    //Access the private members
    wrapper.PrivateMethodInPrivateClass(); 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2012-03-27T07:51:36.880

那么您可以通过两种方式对私有方法进行单元测试

1.  您可以创建`PrivateObject`类的实例，语法如下

    ```
    PrivateObject obj= new PrivateObject(PrivateClass);
    //now with this obj you can call the private method of PrivateCalss.
    obj.PrivateMethod("Parameters"); 
    ```

2.  您可以使用反射。

    ```
    PrivateClass obj = new PrivateClass(); // Class containing private obj
    Type t = typeof(PrivateClass); 
    var x = t.InvokeMember("PrivateFunc", 
        BindingFlags.InvokeMethod | BindingFlags.NonPublic | BindingFlags.Public |  
            BindingFlags.Instance, null, obj, new object[] { 5 }); 
    ```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-10-30T15:55:36.773

我还使用了 InternalsVisibleToAttribute 方法。还值得一提的是，如果您对将以前的私有方法设置为内部方法来实现这一点感到不舒服，那么也许它们不应该成为直接单元测试的主题。

毕竟，您正在测试您的类的*行为*，而不是它的*具体实现*——您可以更改后者而不更改前者，并且您的测试仍然应该通过。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2011-07-22T12:32:05.833

有两种类型的私有方法。静态私有方法和非静态私有方法（实例方法）。以下 2 篇文章通过示例解释了如何对私有方法进行单元测试。

1.  [单元测试静态私有方法](http://venkatcsharpinterview.blogspot.com/2011/07/unit-testing-private-static-method-in-c.html "单元测试静态私有方法")
2.  [单元测试非静态私有方法](http://venkatcsharpinterview.blogspot.com/2011/07/unit-test-private-method-in-c-net.html "单元测试非静态私有方法")

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-10-30T16:10:23.483

MS Test 内置了一个很好的功能，通过创建一个名为 VSCodeGenAccessors 的文件，使私有成员和方法在项目中可用

```
[System.Diagnostics.DebuggerStepThrough()]
    [System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TestTools.UnitTestGeneration", "1.0.0.0")]
    internal class BaseAccessor
    {

        protected Microsoft.VisualStudio.TestTools.UnitTesting.PrivateObject m_privateObject;

        protected BaseAccessor(object target, Microsoft.VisualStudio.TestTools.UnitTesting.PrivateType type)
        {
            m_privateObject = new Microsoft.VisualStudio.TestTools.UnitTesting.PrivateObject(target, type);
        }

        protected BaseAccessor(Microsoft.VisualStudio.TestTools.UnitTesting.PrivateType type)
            :
                this(null, type)
        {
        }

        internal virtual object Target
        {
            get
            {
                return m_privateObject.Target;
            }
        }

        public override string ToString()
        {
            return this.Target.ToString();
        }

        public override bool Equals(object obj)
        {
            if (typeof(BaseAccessor).IsInstanceOfType(obj))
            {
                obj = ((BaseAccessor)(obj)).Target;
            }
            return this.Target.Equals(obj);
        }

        public override int GetHashCode()
        {
            return this.Target.GetHashCode();
        }
    } 
```

使用从 BaseAccessor 派生的类

如

```
[System.Diagnostics.DebuggerStepThrough()]
[System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TestTools.UnitTestGeneration", "1.0.0.0")]
internal class SomeClassAccessor : BaseAccessor
{

    protected static Microsoft.VisualStudio.TestTools.UnitTesting.PrivateType m_privateType = new Microsoft.VisualStudio.TestTools.UnitTesting.PrivateType(typeof(global::Namespace.SomeClass));

    internal SomeClassAccessor(global::Namespace.Someclass target)
        : base(target, m_privateType)
    {
    }

    internal static string STATIC_STRING
    {
        get
        {
            string ret = ((string)(m_privateType.GetStaticField("STATIC_STRING")));
            return ret;
        }
        set
        {
            m_privateType.SetStaticField("STATIC_STRING", value);
        }
    }

    internal int memberVar    {
        get
        {
            int ret = ((int)(m_privateObject.GetField("memberVar")));
            return ret;
        }
        set
        {
            m_privateObject.SetField("memberVar", value);
        }
    }

    internal int PrivateMethodName(int paramName)
    {
        object[] args = new object[] {
            paramName};
        int ret = (int)(m_privateObject.Invoke("PrivateMethodName", new System.Type[] {
                typeof(int)}, args)));
        return ret;
    } 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-11-04T18:35:05.543

在 CodeProject 上有一篇文章简要讨论了测试私有方法的优缺点。然后它提供了一些反射代码来访问私有方法（类似于上面 Marcus 提供的代码）。我在示例中发现的唯一问题是代码没有考虑重载方法。

你可以在这里找到这篇文章：

[http://www.codeproject.com/KB/cs/testnonpublicmembers.aspx](http://www.codeproject.com/KB/cs/testnonpublicmembers.aspx)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-30T15:51:10.590

声明它们`internal`，然后使用[`InternalsVisibleToAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)允许您的单元测试程序集看到它们。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-30T15:59:57.623

我倾向于不使用编译器指令，因为它们很快就会使事情变得混乱。如果您确实需要它们，减轻它的一种方法是将它们放在部分类中，并让您的构建在制作生产版本时忽略该 .cs 文件。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2014-07-03T00:49:27.360

首先，您不应该测试代码的私有方法。您应该测试“公共接口”或 API，即类的公共事物。API 是您向外部调用者公开的所有公共方法。

原因是一旦你开始测试你的类的私有方法和内部结构，你就会将你的类的实现（私有的东西）耦合到你的测试中。这意味着当您决定更改实现细节时，您还必须更改测试。

出于这个原因，您应该避免使用 InternalsVisibleToAtrribute。

这是 Ian Cooper 的精彩演讲，涵盖了这个主题：[Ian Cooper：TDD，哪里出了问题](http://vimeo.com/68375232)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-05-01T17:24:05.783

有时，测试私有声明可能会很好。从根本上说，编译器只有一个公共方法：Compile(string outputFileName, params string[] sourceSFileNames)。我敢肯定你明白，如果不测试每个“隐藏”声明，就很难测试这样的方法！

这就是我们创建 Visual T#: 以简化测试的原因。它是一种免费的 .NET 编程语言（兼容 C# v2.0）。

我们添加了 '.-' 运算符。它的行为就像'。运算符，除非您还可以访问测试中的任何隐藏声明，而无需更改测试项目中的任何内容。

看看我们的网站：**免费**[下载](http://forum.prettyobjects.com/forum2-t-download.aspx)。

 *** * *

## 回答 #17

> 赞同：3
> 
> 时间：2011-06-06T09:24:59.727

我很惊讶还没有人这么说，但我采用的一个解决方案是在类中创建一个静态方法来测试自己。这使您可以访问要测试的所有公共和私有内容。

此外，在脚本语言（具有 OO 能力，如 Python、Ruby 和 PHP）中，您可以让文件在运行时自行测试。确保您的更改不会破坏任何东西的好方法。这显然为测试所有类提供了一个可扩展的解决方案：只需运行它们。（你也可以在其他语言中使用 void main 来执行此操作，它也总是运行它的测试）。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2015-07-16T19:34:25.740

我想在这里创建一个清晰的代码示例，您可以在要测试私有方法的任何类上使用它。

在您的测试用例类中只包含这些方法，然后按照指示使用它们。

```
 /**
   *
   * @var Class_name_of_class_you_want_to_test_private_methods_in
   * note: the actual class and the private variable to store the 
   * class instance in, should at least be different case so that
   * they do not get confused in the code.  Here the class name is
   * is upper case while the private instance variable is all lower
   * case
   */
  private $class_name_of_class_you_want_to_test_private_methods_in;

  /**
   * This uses reflection to be able to get private methods to test
   * @param $methodName
   * @return ReflectionMethod
   */
  protected static function getMethod($methodName) {
    $class = new ReflectionClass('Class_name_of_class_you_want_to_test_private_methods_in');
    $method = $class->getMethod($methodName);
    $method->setAccessible(true);
    return $method;
  }

  /**
   * Uses reflection class to call private methods and get return values.
   * @param $methodName
   * @param array $params
   * @return mixed
   *
   * usage:     $this->_callMethod('_someFunctionName', array(param1,param2,param3));
   *  {params are in
   *   order in which they appear in the function declaration}
   */
  protected function _callMethod($methodName, $params=array()) {
    $method = self::getMethod($methodName);
    return $method->invokeArgs($this->class_name_of_class_you_want_to_test_private_methods_in, $params);
  } 
```

$this->_callMethod('_someFunctionName', array(param1,param2,param3));

只需按照它们在原始私有函数中出现的顺序发出参数

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2015-12-16T18:32:30.460

对于任何想要运行私有方法而没有所有麻烦和混乱的人。这适用于任何单元测试框架，只使用良好的旧反射。

```
public class ReflectionTools
{
    // If the class is non-static
    public static Object InvokePrivate(Object objectUnderTest, string method, params object[] args)
    {
        Type t = objectUnderTest.GetType();
        return t.InvokeMember(method,
            BindingFlags.InvokeMethod |
            BindingFlags.NonPublic |
            BindingFlags.Instance |
            BindingFlags.Static,
            null,
            objectUnderTest,
            args);
    }
    // if the class is static
    public static Object InvokePrivate(Type typeOfObjectUnderTest, string method, params object[] args)
    {
        MemberInfo[] members = typeOfObjectUnderTest.GetMembers(BindingFlags.NonPublic | BindingFlags.Static);
        foreach(var member in members)
        {
            if (member.Name == method)
            {
                return typeOfObjectUnderTest.InvokeMember(method, BindingFlags.NonPublic | BindingFlags.Static | BindingFlags.InvokeMethod, null, typeOfObjectUnderTest, args);
            }
        }
        return null;
    }
} 
```

然后在您的实际测试中，您可以执行以下操作：

```
Assert.AreEqual( 
  ReflectionTools.InvokePrivate(
    typeof(StaticClassOfMethod), 
    "PrivateMethod"), 
  "Expected Result");

Assert.AreEqual( 
  ReflectionTools.InvokePrivate(
    new ClassOfMethod(), 
    "PrivateMethod"), 
  "Expected Result"); 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-31T07:44:44.207

```
CC -Dprivate=public 
```

“CC”是我使用的系统上的命令行编译器。`-Dfoo=bar`相当于`#define foo bar`. 因此，此编译选项有效地将所有私有内容更改为公共内容。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-08-24T07:12:54.437

MbUnit 有一个很好的包装器，叫做 Reflector。

```
Reflector dogReflector = new Reflector(new Dog());
dogReflector.Invoke("DreamAbout", DogDream.Food); 
```

您还可以从属性中设置和获取值

```
dogReflector.GetProperty("Age"); 
```

关于“私人测试”，我同意……在完美世界中。进行私人单元测试是没有意义的。但在现实世界中，您最终可能想要编写私有测试而不是重构代码。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2012-04-11T15:14:21.753

这是关于私有方法单元测试的好[文章。](http://www.codeproject.com/Articles/9715/How-to-Test-Private-and-Protected-methods-in-NET)但我不确定哪个更好，让您的应用程序专门为测试而设计（就像为测试创建测试一样）或使用反射进行测试。很确定我们大多数人会选择第二种方式。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-11-26T14:33:43.570

在我看来，你应该只对你的类的公共 API 进行单元测试。

公开一个方法，以便对其进行单元测试，会破坏暴露实现细节的封装。

一个好的公共 API 解决了客户端代码的直接目标并完全解决了该目标。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2017-04-21T11:57:22.870

我使用[PrivateObject](https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject.aspx)类。但如前所述，最好避免测试私有方法。

```
Class target = new Class();
PrivateObject obj = new PrivateObject(target);
var retVal = obj.Invoke("PrivateMethod");
Assert.AreEqual(retVal); 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2012-05-17T18:05:35.183

这是一个示例，首先是方法签名：

```
private string[] SplitInternal()
{
    return Regex.Matches(Format, @"([^/\[\]]|\[[^]]*\])+")
                        .Cast<Match>()
                        .Select(m => m.Value)
                        .Where(s => !string.IsNullOrEmpty(s))
                        .ToArray();
} 
```

这是测试：

```
/// <summary>
///A test for SplitInternal
///</summary>
[TestMethod()]
[DeploymentItem("Git XmlLib vs2008.dll")]
public void SplitInternalTest()
{
    string path = "pair[path/to/@Key={0}]/Items/Item[Name={1}]/Date";
    object[] values = new object[] { 2, "Martin" };
    XPathString xp = new XPathString(path, values);

    PrivateObject param0 = new PrivateObject(xp);
    XPathString_Accessor target = new XPathString_Accessor(param0);
    string[] expected = new string[] {
        "pair[path/to/@Key={0}]",
        "Items",
        "Item[Name={1}]",
        "Date"
    };
    string[] actual;
    actual = target.SplitInternal();
    CollectionAssert.AreEqual(expected, actual);
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2014-09-22T18:34:04.820

一种方法是使用您的方法`protected`并编写一个测试夹具，该夹具继承您要测试的类。这样，您也不会转动您的方法`public`，而是启用测试。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-06-18T15:40:29.023

1）如果您有遗留代码，那么测试私有方法的唯一方法是通过反射。

2）如果是新代码，那么您有以下选择：

*   使用反射（复杂）
*   在同一个类中编写单元测试（通过在其中包含测试代码使生产代码变得丑陋）
*   重构并在某种 util 类中公开该方法
*   使用 @VisibleForTesting 注释并删除私有

我更喜欢注解的方法，最简单，最不复杂。唯一的问题是我们提高了知名度，我认为这不是一个大问题。我们应该总是对接口进行编码，所以如果我们有一个接口 MyService 和一个实现 MyServiceImpl 那么我们可以有相应的测试类，即 MyServiceTest（测试接口方法）和 MyServiceImplTest（测试私有方法）。无论如何，所有客户端都应该使用该接口，因此即使私有方法的可见性已经增加，它也并不重要。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2015-09-28T07:36:57.987

您还可以在调试模式下构建时将其声明为公共或内部（使用 InternalsVisibleToAttribute）：

```
 /// <summary>
    /// This Method is private.
    /// </summary>
#if DEBUG
    public
#else
    private
#endif
    static string MyPrivateMethod()
    {
        return "false";
    } 
```

它使代码膨胀，但它将`private`在发布版本中。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-05-28T20:39:14.550

您可以从 Visual Studio 2008 为私有方法生成测试方法。当您为私有方法创建单元测试时，测试引用文件夹会添加到您的测试项目中，并且访问器会添加到该文件夹​​中。在单元测试方法的逻辑中也提到了访问器。此访问器允许您的单元测试调用您正在测试的代码中的私有方法。详情请看

[http://msdn.microsoft.com/en-us/library/bb385974.aspx](http://msdn.microsoft.com/en-us/library/bb385974.aspx)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-04-12T20:08:57.847

另请注意，InternalsVisibleToAtrribute 要求您的程序集是[强命名](http://msdn.microsoft.com/en-us/library/bb385840%28v=vs.90%29.aspx)的，如果您正在使用以前没有该要求的解决方案，这会产生它自己的一组问题。我使用访问器来测试私有方法。有关此示例，请参阅[此问题。](https://stackoverflow.com/questions/882532/how-to-use-integrated-unit-testing-in-vs2008-to-test-abstract-class)

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2018-01-29T19:35:56.853

**对于JAVA语言**

在这里，您可以使用模拟行为覆盖测试类的特定方法。

对于以下代码：

```
public class ClassToTest 
{
    public void methodToTest()
    {
        Integer integerInstance = new Integer(0);
        boolean returnValue= methodToMock(integerInstance);
        if(returnValue)
        {
            System.out.println("methodToMock returned true");
        }
        else
        {
            System.out.println("methodToMock returned true");
        }
        System.out.println();
    }
    private boolean methodToMock(int value)
    {
        return true;
    }
} 
```

测试类将是：

```
public class ClassToTestTest{

    @Test
    public void testMethodToTest(){

        new Mockup<ClassToTest>(){
            @Mock
            private boolean methodToMock(int value){
                return true;
            }
        };

        ....    

    }
} 
```

# web-applications - JOGL——有用吗？问题+评论和经验

> ID：250697
> 
> 赞同：2
> 
> 时间：2008-10-30T15:50:22.167
> 
> 标签：web-applications, opengl, cgi, jogl

## 故事：

我一直在谷歌上搜索使用视频卡加速（*无软件渲染）*在网络上显示计算机图形的某种方式。我知道可以为*IE*编写 activeX 模块，但这*不是一个完整的解决方案*，因为它会吸引大量用户（*firefox + macOS 粉丝*）。这是我所想的更多的例子：

[浏览器链接顶部的硬件加速示例](http://tribaltrouble2.com/)

* * *

## 查询：

我最近发现您可以使用**JOGL**从浏览器将 opengl 调用与 java 绑定。所以我想知道一些事情：

> **A)** **JOGL**是我故事的最佳解决方案吗？

> **B)**我可以从 JOGL 查询 opengl 扩展吗？

> **C)**我如何从 JOGL 加载纹理？

* * *

## 评论：

如果您在浏览器中使用过 JOGL，请告诉我您从中遇到的问题/经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T22:07:02.757

我在一个主要的桌面应用程序上使用了 JOGL，它是成功的。它基本上和 OpenGL 一样快。我不能通过网络谈论任何事情——我怀疑你最好的选择是使用 WebStart 编写一个 JOGL 小程序。查看一些 JOGL 示例。

JOGl 是 OpenGL 上的一个非常薄的包装器。如果您了解 OpenGL，则可以使用 JOGL。如果你不了解 OpenGL，学习 JOGl 和学习 OpenGL 是一样的（不是一件容易的事）。几乎所有你可以在 OpenGL 中做的事情都可以在 JOGL 中做。

我们在 Linux 上遇到了硬件加速问题（谁没有），并且一些 Linux 配置会使我们的 JOGL 应用程序崩溃（不一定是其他应用程序）。这是一个已知问题，无论您做什么，都可能在 Linux 上遇到 3D 问题。

我还知道其他人在桌面上成功使用了 JME 和 LWJGL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T16:08:41.180

您在问题中没有提到“小程序”。尝试搜索“jogl applet”或“lwjgl applet”。我对 LWJGL 比 JOGL 更满意，但它们都应该满足您的需求。您可能还对 Java Web Start 感兴趣。尝试使用[LWJGL](http://lwjgl.org/demos.php)的 Java Web Start 和基于 Applet 的示例的演示，以及[JOGL](https://jogl-demos.dev.java.net/applettest.html)小程序的演示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-22T06:38:06.157

让我担心的是，这个论坛不被 Jogl 程序员使用。NASA WorldWind 中有一个庞大而活跃的 Jogl 社区 - 一个非常简洁的基于 JOGL 的应用程序。已经有许多衍生品和定制，包括 JOGL 中的整个虚拟斯洛文尼亚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T15:59:55.127

我已经将 JOGL 用于带有 GLUT 工具包的桌面应用程序，并且效果很好（我还在 C/C++ 和 Python 中使用了 OpenGL 绑定）我无法评论在小程序中运行 JOGL 应用程序...

当您询问如何查询 OpenGL 扩展时，我不确定您的意思，JOGL 只是 Java API 中的 OpenGL 绑定，因此任何 OpenGL 知识都将映射到 JOGL。如果您没有使用过 OpenGL 绑定，那么我建议您阅读红皮书：[http ://www.opengl.org/documentation/red_book/](http://www.opengl.org/documentation/red_book/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T16:41:26.307

> **A)**我相信 Java3D 可以在可用的情况下使用 DirectX 或 OpenGL/JOGL，或者回退到软件渲染。它提供了一个面向场景图的 API，有时更容易编程。
> 
> **B**和**C)** JOGL 是一个非常薄但功能齐全的 OpenGL 及其扩展包装器。（几乎）你可以用 C/C++ 中的 OpenGL 做的所有事情，你可以用 JOGL 以完全相同的方式做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-27T08:25:54.850

[您可以在Parleys](http://parleys.com/display/PARLEYS/Home#)上观看有关使用 Java 中的 openGL 的有趣演示。

演讲题目是“高性能 Java3D 和 2D 图形应用程序”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-19T21:32:41.333

A) 是 B) 是的，使用 GLBase.isExtensionAvailable() 和 GLBase.isFunctionAvailable() C) 使用类 Texture 和 TextureIO。[您可以在这里](http://jogamp.org/jogl-demos/www/)找到新鲜的小程序演示。

请不要使用 Java3D，它已经过时并且不再积极维护。Ardor3D 有一个出色的 JOGL 2.0 渲染器（我写的 ;)）。JMonkeyEngine 2 支持 JOGL 1.1.1a，如 Xith3D 和 3DzzD。

编辑：在写这篇评论几年后，我在 Harvey 的帮助下复活了 Java3D，如果你仍然想使用它，请查看[我的教程。](http://gouessej.wordpress.com/2012/08/01/java-3d-est-de-retour-java-3d-is-back/)

# python - 是否可以使用 subprocess.Popen 与子子进程通信？

> ID：250700
> 
> 赞同：5
> 
> 时间：2008-10-30T15:50:51.700
> 
> 标签：python, subprocess

我正在尝试编写一个打包我们软件的python脚本。该脚本需要构建我们的产品，并将其打包。目前，我们还有其他脚本可以单独完成每个部分，包括 csh 和 perl 脚本。一个这样的脚本运行如下：

```
sudo mod args 
```

其中 mod 是一个 perl 脚本；所以在python中我会做

```
proc = Popen(['sudo', 'mod', '-p', '-c', 'noresource', '-u', 'dtt', '-Q'], stderr=PIPE, stdout=PIPE, stdin=PIPE) 
```

问题是这个模组脚本需要回答几个问题。为此，我认为传统的

```
(stdout, stderr) = proc.communicate(input='y') 
```

会工作。我认为它不起作用，因为 Popen 控制的过程是 sudo，而不是提出问题的 mod 脚本。有什么方法可以与 mod 脚本通信并仍然通过 sudo 运行它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T16:26:41.877

`sudo`我认为您应该在`Popen`通话中删除 ，并要求脚本的用户*键入*`sudo`.

这也使脚本中提升权限的需求更加明确，而不是将其隐藏在`Popen`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-30T23:10:26.727

我会选择使用 Pexpect。

```
import pexpect
child = pexpect.spawn ('sudo mod -p -c noresource -u dtt -Q')
child.expect ('First question:')
child.sendline ('Y')
child.expect ('Second question:')
child.sendline ('Yup') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:22:51.353

最简单的做法是通过`sudo`. 你能做到吗，或者那不是一个选择？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T17:29:43.060

我们需要更多信息。

1.  sudo 是否要求您输入密码？
2.  mod脚本有什么样的提问界面？

因为这些事情不是通过管道正常处理的。

这两种情况的解决方案可能是[Pexpect](http://www.noah.org/wiki/Pexpect)，它非常擅长处理要求密码的有趣脚本以及各种其他输入问题。

# sql-server - SqlDataAdapter.Fill 方法慢

> ID：250713
> 
> 赞同：33
> 
> 时间：2008-10-30T15:53:06.873
> 
> 标签：sql-server, vb.net, .net-1.1

为什么使用此代码返回具有 9 列、89 行的表的存储过程需要 60 秒来执行（.NET 1.1），而在 SQL Server Management Studio 中运行时间小于 1 秒？它在本地机器上运行，所以很少/没有网络延迟，快速的开发机器

```
Dim command As SqlCommand = New SqlCommand(procName, CreateConnection())
command.CommandType = CommandType.StoredProcedure
command.CommandTimeout = _commandTimeOut
Try
   Dim adapter As new SqlDataAdapter(command)
   Dim i as Integer
   For i=0 to parameters.Length-1
      command.Parameters.Add(parameters(i))
   Next
   adapter.Fill(tableToFill)
   adapter.Dispose()
Finally
   command.Dispose()
End Try 
```

我的参数数组是输入的（对于这个 SQL，它只是一个参数）

```
parameters(0) = New SqlParameter("@UserID", SqlDbType.BigInt, 0, ParameterDirection.Input, True, 19, 0, "", DataRowVersion.Current, userID) 
```

存储过程只是一个 select 语句，如下所示：

```
ALTER PROC [dbo].[web_GetMyStuffFool]
   (@UserID BIGINT)
AS
SELECT Col1, Col2, Col3, Col3, Col3, Col3, Col3, Col3, Col3
FROM [Table] 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-30T17:07:41.857

首先，确保您正确地分析了性能。例如，从 ADO.NET 运行查询两次，看看第二次是否比第一次快得多。这消除了等待应用程序编译和调试基础设施启动的开销。

接下来，检查 ADO.NET 和 SSMS 中的默认设置。例如，如果您`SET ARITHABORT OFF`在 SSMS 中运行，您可能会发现它现在的运行速度与使用 ADO.NET 时一样慢。

我曾经发现，`SET ARITHABORT OFF`在 SSMS 中导致重新编译存储的过程和/或使用不同的统计信息。突然之间，SSMS 和 ADO.NET 都报告了大致相同的执行时间。请注意，这*本身*`ARITHABORT`并不是减速的原因，而是它会导致重新编译，并且[由于参数嗅探](http://www.sommarskog.se/query-plan-mysteries.html)，您最终会得到两个不同的计划。参数嗅探很可能是需要解决的实际问题。

 *要检查这一点，请查看每次运行的执行计划，特别是`sys.dm_exec_cached_plans`表格。他们可能会有所不同。

在特定存储过程上运行“sp_recompile”将从缓存中删除关联的执行计划，然后 SQL Server 有机会在下一次执行该过程时创建一个可能更合适的计划。

最后，您可以尝试使用 SSMS 清除整个过程缓存和内存缓冲区的“ [nuke it from orbit ”方法：](http://knowyourmeme.com/memes/nuke-it-from-orbit)

```
DBCC DROPCLEANBUFFERS
DBCC FREEPROCCACHE 
```

在测试查询之前这样做可以防止使用缓存的执行计划和以前的结果缓存。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T18:39:37.857

这是我最终做的事情：

我执行了以下 SQL 语句来重建数据库中所有表的索引：

```
EXEC <databasename>..sp_MSforeachtable @command1='DBCC DBREINDEX (''*'')', @replacechar='*'
-- Replace <databasename> with the name of your database 
```

如果我想在 SSMS 中看到相同的行为，我会像这样运行 proc：

```
SET ARITHABORT OFF
EXEC [dbo].[web_GetMyStuffFool] @UserID=1
SET ARITHABORT ON 
```

绕过它的另一种方法是将其添加到您的代码中：

```
MyConnection.Execute "SET ARITHABORT ON" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-06T15:44:31.277

I ran into the same issue, but when I've rebuilt indexes on SQL table, it worked fine, so you might want to consider rebuilding index on sql server side

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T15:58:47.157

为什么不让它成为 DataReader 而不是 DataAdapter，看起来你有一个单一的结果集，如果你不打算将更改推回 DB 并且不需要在 .NET 代码中应用你不​​应该使用的约束适配器。

编辑：

如果您需要它成为 DataTable，您仍然可以通过 DataReader 从 DB 中提取数据，然后在 .NET 代码中使用 DataReader 填充 DataTable。这仍然应该比依赖 DataSet 和 DataAdapter 更快

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T16:09:12.147

我不知道“为什么”它本身这么慢 - 但正如 Marcus 指出的那样 - 将 Mgmt Studio 与填充数据集进行比较是苹果与橘子。数据集包含大量开销。我讨厌它们，如果我能帮上忙，就永远不要使用它们。

您可能会遇到与旧版本 SQL 堆栈或类似问题不匹配的问题（尤其是考虑到您显然也被困在 .NET 1.1 中）该框架可能会尝试执行“反射”的数据库等价物来推断架构等等等

要考虑尝试使用不幸的约束的一件事是使用数据读取器访问数据库并在代码中构建自己的数据集。您应该可以通过 google 轻松找到示例。

# regex - Shell 脚本/正则表达式：跨多行提取

> ID：250717
> 
> 赞同：0
> 
> 时间：2008-10-30T15:53:53.877
> 
> 标签：regex, shell, extract, lines

我正在尝试编写一个日志解析脚本来提取失败的事件。我可以用 grep 拉出这些：

```
$ grep -A5 "FAILED" log.txt

2008-08-19 17:50:07 [7052] [14] DEBUG:      data: 3a 46 41 49 4c 45 44 20 20 65 72 72 3a 30 32 33   :FAILED  err:023
2008-08-19 17:50:07 [7052] [14] DEBUG:      data: 20 74 65 78 74 3a 20 00                            text: .
2008-08-19 17:50:07 [7052] [14] DEBUG:    Octet string dump ends.
2008-08-19 17:50:07 [7052] [14] DEBUG: SMPP PDU dump ends.
2008-08-19 17:50:07 [7052] [14] DEBUG: SMPP[test] handle_pdu, got DLR
2008-08-19 17:50:07 [7052] [14] DEBUG: DLR[internal]: Looking for DLR smsc=test, ts=1158667543, dst=447872123456, type=2
--
2008-08-19 17:50:07 [7052] [8] DEBUG:      data: 3a 46 41 49 4c 45 44 20 20 65 72 72 3a 30 32 34   :FAILED  err:024
2008-08-19 17:50:07 [7052] [8] DEBUG:      data: 20 74 65 78 74 3a 20 00                            text: .
2008-08-19 17:50:07 [7052] [8] DEBUG:    Octet string dump ends.
2008-08-19 17:50:07 [7052] [8] DEBUG: SMPP PDU dump ends.
2008-08-19 17:50:07 [7052] [8] DEBUG: SMPP[test] handle_pdu, got DLR
2008-08-19 17:50:07 [7052] [8] DEBUG: DLR[internal]: Looking for DLR smsc=test, ts=1040097716, dst=447872987654, type=2 
```

我感兴趣的是，对于每个块，错误代码（即第一行的“:FAILED err:023”的“023”部分）和 dst 编号（即“dst=447872123456”中的“447872123456”在最后一行。）

任何人都可以帮助使用 shell one-liner 来提取这两个值，或者提供一些关于我应该如何处理这个值的提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:07:52.227

```
grep -A 5 FAILED log.txt | \              # Get FAILED and dst and other lines
    egrep '(FAILED|dst=)' | \             # Just the FAILED/dst lines
    egrep -o "err:[0-9]*|dst=[0-9]*" | \  # Just the err: and dst= phrases
    cut -d':' -f 2 | \                    # Strip "err:" from err: lines
    cut -d '=' -f 2 | \                   # Strip "dst=" from dst= lines
    xargs -n 2                            # Combine pairs of numbers

023 447872123456
024 447872987654 
```

与所有 shell "one"-liner 一样，几乎可以肯定有一种更优雅的方式来做到这一点。但是，我发现迭代方法非常成功地获得了我想要的东西：从太多信息（你的 grep）开始，然后缩小我想要的行（使用 grep），然后剪掉我想要的每一行的部分（使用切）。

虽然使用 linux 工具箱需要更多的代码，但您只需要了解一些命令的基础知识就可以完成任何您想做的事情。另一种方法是使用 awk、python 或其他脚本语言，它们需要更专业的编程知识，但占用的屏幕空间更少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:11:20.080

Ruby 中的一个简单解决方案，这里是`filter.rb`：

```
#! /usr/bin/env ruby
File.read(ARGV.first).scan(/:FAILED\s+err:(\d+).*?, dst=(\d+),/m).each do |err, dst|
  puts "#{err} #{dst}"
end 
```

运行它：

```
ruby filter.rb my_log_file.txt 
```

你得到：

```
023 447872123456
024 447872987654 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T18:31:40.900

如果总是有相同数量的字段，您可以

```
grep -A5 "FAILED" log.txt | awk '$24~/err/ {print $24} $12~/dst/{print $12}' error.txt

err:023
dst=447872123456,
err:024
dst=447872987654, 
```

并且根据文件其余部分的外观，您可能可以一起跳过 grep。

“ *$24~/err/ {print $24}* ” 部分告诉 awk 打印字段编号 24，如果它包含 err, ~/XXX/ 其中 XXX 是正则表达式。

# tsql - 删除以前通过 GRANT EXECUTE 授予的权限的语法？

> ID：250718
> 
> 赞同：15
> 
> 时间：2008-10-30T15:54:11.630
> 
> 标签：tsql

如果我通过授予角色执行权限

```
GRANT EXECUTE ON [DBO].[MYPROC] TO MY_ROLE 
```

删除它们的等效语法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-30T15:55:40.177

REVOKE EXECUTE ON [DBO].[MYPROC] TO MY_ROLE

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-30T15:55:46.040

```
DENY EXECUTE ON [DBO].[MYPROC] TO MY_ROLE 
```

或者

```
REVOKE EXECUTE ON [DBO].[MYPROC] TO MY_ROLE 
```

取决于你的目标。第一个充当任何授予权限的过滤器，第二个删除显式权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T15:55:59.830

```
DENY EXECUTE ON [DBO].[MYPROC] TO MY_ROLE 
```

# linux - 精益软件（Web应用）发布工程

> ID：250730
> 
> 赞同：1
> 
> 时间：2008-10-30T15:56:59.503
> 
> 标签：linux, svn, release-management

我希望重新组织我们发布内部软件的方式。所有代码（PHP webapps、一些 Java 应用程序和 Perl 脚本）都检入 Subversion 存储库，但没有分支或标签，所有代码都检入主干（每个应用程序只有大约 1-3 个开发人员）。在生产 linux 服务器上，该软件只是直接从一个工作 svn 副本运行（实际上大部分更改也发生在那里）。

由于我们有很多小应用程序并且经常对正在运行的系统发布小的更改，我正在寻找一种非常精简或透明的方式来进行一些发布工程并清理这些混乱。

是否有任何工具可以帮助我在这样的异构环境（语言方面）中这样做？或者有谁知道如何以正确的方式做到这一点？

否则我会考虑编写一些发布（shell）脚本，自动从主干创建颠覆标签，然后将相应的标签签出到生产服务器。但这对我来说听起来也有点骇人听闻。

谢谢，

海斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T02:12:45.263

使用标签和分支；使其成为开发周期的一部分。当您更新“stable-1.0”分支，测试更改并将其标记为“release-1.0.5”时，您只需在服务器上执行“svn switch”到新标签。试过了还是不行？切换回来，找出问题所在。

但要注意，在 subversion 中分支可能会很痛苦，至少在 1.5 之前的版本中是这样。如果您或您的开发人员没有使用分支的经验，那么一开始可能会遇到一些麻烦和/或错误。但只要你已经提交，就不会丢失任何代码（最坏的情况是难以合并）。

您的开发人员真的应该学习如何使用分支；它可用于多种用途（不仅仅是用于发布工程）。

不要自动切换生产服务器上的代码*；*有人可能不小心按错了按钮。生产更新应始终小心谨慎。恕我直言，添加新标签的脚本是不必要的，因为它很简单，但您的里程可能会有所不同。

最后一件事，不要让任何人在您的生产服务器上进行更改。它可能会导致冲突，而这些往往需要时间来解决。更不用说，它会破坏您在不同工作站上复制给定版本的能力（在这里工作正常！为什么不在服务器上？嗯）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T21:57:00.973

持续集成绝对是要走的路——任何 CI（甚至是极简的批处理文件）都比没有好——但它只会和你现有的策略一样好。由于您的文件实际上并没有最终成为“二进制”或“可分发”，因此标记发布可能只需要您标记存储库，或者甚至只是将 Subversion 修订号存储在某处。您需要的重要策略是任何版本都可以在您需要时重新构建 - 因此您可以比较当前和以前的版本，或者如果出现问题，可以返回旧版本。不用担心在 svn 中创建标签的“开销”——这非常有效。

执行 subversion 标签的发布脚本听起来不错。CI 实现（我推荐 CruiseControl，因为它非常适合异构工作，尽管异构需要更多的配置开销）很棒，因为您可以在 subversion checkin 时自动启动该过程，并运行自动化测试来确定它是否好是否足以标记。

我绝对不会自动部署到发布服务器。一个“暂存区”（称之为“夜间构建”、“beta 测试”等）会更好。在您决定将其推广到生产服务器上之前，请让您的用户对此大加赞赏。而且，只要您制定了能够回滚到早期版本的策略，您就可以降低推出不良的可能性。

生产服务器上的自动结帐是唯一的“hackish”部分——自动结帐、测试、标记、测试版部署就足够了。不过，推广到生产不应该有一个简单的按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T16:12:02.437

一些持续集成服务器会做这种事情，例如[Hudson就有颠覆集成。](http://hudson-ci.org/)它可以为您标记、运行测试和部署。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-12T12:50:40.233

我会用哈德森。除了从 svn (ref sblundy) 中获取和标记之外，它还可以用于使用适当的[插件](http://wiki.hudson-ci.org/display/HUDSON/Plugins)进行发布管理。f.ex.，您可以尝试[使用插件来“提升”](http://wiki.hudson-ci.org/display/HUDSON/Promoted+Builds+Simple+Plugin)您部署到生产环境的构建，并保留提升的构建本身的列表以及各种版本的更改/提交日志。

# c# - 哪些控制反转 (IoC) 容器支持 .NET 1.1？

> ID：250738
> 
> 赞同：1
> 
> 时间：2008-10-30T15:59:26.673
> 
> 标签：c#, .net, dependency-injection, inversion-of-control

哪些控制反转 (IoC) 容器支持 .NET 1.1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-30T16:29:22.027

一个是 Castle Project 的[Castle Microkernel/Windsor](http://www.castleproject.org/container/index.html)。

# nant - Nant - Get Newest Folder

> ID：250746
> 
> 赞同：4
> 
> 时间：2008-10-30T16:03:06.557
> 
> 标签：nant

Is there a relatively simple way in nant, without writing a custom task, to get the name of the newest folder in a certain directory? Recursion is not needed. I have been trying to do it with directory::get-creation-time and a foreach loop and if statements, yada yada. It's too complex, and I'm about to create a custom task instead. However, I suspect there is some simpler way to do it via existing nant features.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T18:06:21.427

I believe you're correct in stating that doing this in a **pure** nant fashion might pose to be messy, especially the way properties work in nant. If you don't want to write a custom task, you can always use the [script task](http://nant.sourceforge.net/release/0.85/help/tasks/script.html). For example:

```
<?xml version="1.0"?>
<project name="testing" basedir=".">

    <script language="C#" prefix="test" >
        <code>
            <![CDATA[
            [Function("find-newest-dir")]
            public static string FindNewestDir( string startDir ) {
                string theNewestDir = string.Empty;
                DateTime theCreateTime = new DateTime();
                DateTime theLastCreateTime = new DateTime();
                string[] theDirs = Directory.GetDirectories( startDir );
                for ( int theCurrentIdx = 0; theCurrentIdx < theDirs.Length; ++theCurrentIdx )
                {
                    if ( theCurrentIdx != 0 )
                    {
                        DateTime theCurrentDirCreateTime = Directory.GetCreationTime( theDirs[ theCurrentIdx ] );
                        if ( theCurrentDirCreateTime >= theCreateTime )
                        {
                            theNewestDir = theDirs[ theCurrentIdx ];
                            theCreateTime = theCurrentDirCreateTime;
                        }
                    }
                    else
                    {
                        theNewestDir = theDirs[ theCurrentIdx ];
                        theCreateTime = Directory.GetCreationTime( theDirs[ theCurrentIdx ] );
                    }
                }
                return theNewestDir;
            }
            ]]>
        </code>
    </script>

    <property name="dir" value="" overwrite="false"/>
    <echo message="The newest directory is: ${test::find-newest-dir( dir )}"/>

</project> 
```

With this, one should be able to call the function to get the newest directory. The implementation of the actual function could be changed to be anything (optimized a bit more or whatever), but I've included a quick one for reference on how to use the **script task**. It produces output like the following:

```
nant -D:dir=c:\

NAnt 0.85 (Build 0.85.2478.0; release; 10/14/2006)
Copyright (C) 2001-2006 Gerry Shaw
http://nant.sourceforge.net

Buildfile: file:///C:/tmp/NAnt.build
Target framework: Microsoft .NET Framework 2.0

   [script] Scanning assembly "jdrgmbuy" for extensions.
     [echo] The newest directory is: C:\tmp

BUILD SUCCEEDED

Total time: 0.3 seconds.

```

# .net - 有人知道可能存在的任何 .NET OpenID Provider 示例代码吗？

> ID：250749
> 
> 赞同：5
> 
> 时间：2008-10-30T16:04:12.310
> 
> 标签：.net, openid

我需要在 .Net 中实现一个 OpenID 提供程序并想知道....是否有任何 OpenSource 代码已经编写并可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T16:07:55.063

我刚刚找到[http://code.google.com/p/dotnetopenid/](http://code.google.com/p/dotnetopenid/)

抱歉没有先正确搜索......

我似乎无法删除这个问题（奇怪）

相反，作为忏悔，这个问题和答案将被标记为社区财产，所以我不会以任何方式从我的愚蠢中受益......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T16:15:30.713

另请参阅[Hanselman 的帖子](http://www.hanselman.com/blog/TheWeeklySourceCode25OpenIDEdition.aspx)，了解在您的网站上使用 DotNetOpenID 的一些详细信息。那个已经在我的书签文件夹里放了一段时间了...... :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T21:38:24.970

顺便说一句 - 谷歌代码上也有 ExtremeSwank。我也去看看，现在好像更远了。

我正在编写一篇博客文章，应该至少从明天开始发布。制定 WCF OpenID 提供程序实现。 [http://www.adronbhall.name](http://www.adronbhall.name)。

# svn - 以“敏捷”的节奏维护发布/分支？

> ID：250752
> 
> 赞同：3
> 
> 时间：2008-10-30T16:05:07.893
> 
> 标签：svn, scrum, branch, release, maintainability

我们有一个软件产品，可以根据客户的需求和更通用的路线图发展。

因为我们处于 SCRUM 项目环境中，所以经常会出现新功能进入产品的情况，然后我们面临以下选择：

*   在已经发布的分支中实现此功能（那么，实际上并不是拥有分支的重点）
*   建立一个新分支 - 但是我们每三周就有一个分支，它不再是可维护的了

不发布新功能不是一种选择，客户不想等待一个长期的里程碑计划来获得他们想要的功能，而且在客户端模块中移动功能并不总是可行的——有时我们需要改变产品的核心...

考虑到这些限制，有没有人对好的做法有任何反馈？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-30T16:25:07.260

我建议我们在当前环境中使用以下内容：像对待安全修复程序一样对待计划外功能。

*   每个计划的版本（例如 3.0、3.1）都有自己的版本号和源代码中的标签。释放后，您不要触摸它。
*   计划发布后的新功能进入下一个计划发布（例如 3.2）
*   如果您必须修改已发布的代码版本，则它是“计划外发布”并获得补丁版本号（例如 3.1.1、3.1.2）。所有变化：
    *   在基于该版本的最新补丁的新分支中实现（例如，3.1.1 是从 3.1.0 创建的，3.1.2 是从 3.1.1 创建的）
    *   立即合并到主干，因此它们也进入下一个计划发布
*   在实现了计划外的功能之后，你将分支变成一个标签（也就是不要再碰它了）并回到主干中工作。

这样，每个计划外的功能都会获得一个分支，但只需要足够长的时间来发布新版本并合并到主干中。您几乎可以在一个地方（主干）完成所有工作，并且没有很多合并工作要做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T16:22:07.003

像（'new_feature_branch'）这样的新分支用于实现与当前分支不兼容的[开发工作（如'release_branch'）](https://stackoverflow.com/questions/16142#114384)

因此，如果您当前的 release_branch 不是很活跃，您可以将其用于新功能（前提是您在开发此新功能*之前*定义了一个标签，以防您需要取消该过程并返回此新功能之前的状态）

建立一个新分支可能是一个很好的解决方案，只要它在发布分支上定期（每 3 周）合并回来，然后被排除在外。如果您在 release_branch 上有一些活动（例如一些热错误修复），则特别推荐。那么这两种努力需要保持分开。

基本上，这一切都取决于您的[合并工作流程](https://stackoverflow.com/questions/216212#216228)定义。

如果您希望我详细说明一些您认为我没有深入讨论的选项，请发表评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:51:13.277

在我的办公室里，我们通常在任何给定时间点都在 3 个分支机构工作。

*   发布：这是当前部署的代码被标记和存储的地方。如果我们需要进行任何关键的错误修复，这就是完成工作的地方。部署时，我们通常会增加标签的修补程序部分（即 1.19.0 -> 1.19.1）。
*   QA：这是为客户准备的代码被标记和存储的地方。当我们开始新工作并且有一些代码目前正在由 QA 测试以准备下一次交付时，将使用此分支。
*   Main：这是完成所有新工作的地方。

在我们需要在第四行进行开发的极少数情况下（由于非常紧张的发布时间表），我们偶尔会打开我们的沙盒代码行。虽然更典型的是，我们只会让一个开发人员单独工作，并且在主线被清除之前不签入。

使用上面的分支策略，我们已经能够在每个 sprint 结束时通过交付来进行主要的功能更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T17:02:04.000

听起来你并不是真的生活在 Scrum 环境中。Scrum*要求*团队在每个 Sprint 结束时完成，这应该不超过四个星期（更可能是一到两周）。因此，无论如何，每隔几周，您就应该拥有一个经过全面测试、正在运行、潜在可部署的系统。

我知道这样做的唯一方法是拥有全面的、完全自动化的客户和开发人员测试套件（如极限编程规定）。

我不确定为什么在这种情况下你需要分支，但我也不明白为什么它不能维护。根据我的经验，分支寿命越短越好。

# html - 当我尝试将 Crystal 报表导出到 HTML 文件时，为什么会出现“无法导出报表”错误？

> ID：250755
> 
> 赞同：0
> 
> 时间：2008-10-30T16:05:54.117
> 
> 标签：html, vb6, crystal-reports, export

我正在尝试将 Crystal Report 导出到 HTML 文件，但是当我调用 Export 方法时，我立即收到此错误：

> **来源**：水晶报表 ActiveX 设计器
> 
> **说明**：无法导出报告。

我已尝试将 crEFTHTML40 和 crEFTHTML32Standard 作为导出格式类型 - 两者都导致相同的错误。

这是我正在做的一个高度简化的版本：

```
Dim objCRReport As CRAXDRT.Report
[...]
objCRReport.ExportOptions.FormatType = 32 'crEFTHTML40
objCRReport.ExportOptions.DestinationType = 1 'crEDTDiskFile
objCRReport.ExportOptions.DiskFileName = "C:\reportInHtmlFormat.html"
objCRReport.Export False '<--- "Failed to export the report" error here 
```

请注意，我专门引用了“Crystal Reports 9 ActiveX Designer 运行时库”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:15:11.383

我不确定您在该`[...]`部分中的内容，但您的代码应包含使用 CRAXDRT 应用程序实例打开报告的调用。

```
Dim objCRReport As CRAXDRT.Report

'***********************************
Dim objCRApp As New CRAXDRT.Application

objCRReport = objCRApp.OpenReport("<YOUR REPORT FILENAME>", 1)
'***********************************

[...]
objCRReport.ExportOptions.FormatType = 32 'crEFTHTML40
objCRReport.ExportOptions.DestinationType = 1 'crEDTDiskFile
objCRReport.ExportOptions.DiskFileName = "C:\reportInHtmlFormat.html"
objCRReport.Export False '<--- "Failed to export the report" error here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-27T19:16:20.530

尝试设置`HTMLFileName`选项：

```
objCRReport.ExportOptions.HTMLFileName = "C:\reportInHtmlFormat.html" 
```

# qt - 在下载短文件期间阻止 Qt 应用程序

> ID：250757
> 
> 赞同：8
> 
> 时间：2008-10-30T16:06:01.230
> 
> 标签：qt

我正在使用 Qt4 编写应用程序。

我需要从给定的 http 地址下载一个非常短的文本文件。

该文件很短，我的应用程序需要它才能继续，所以我想确保下载被阻止（或者如果文件未找到/不可用，几秒钟后将超时）。

我想使用 QHttp::get()，但这是一种非阻塞方法。

我想我可以使用一个线程：我的应用程序会启动它，然后等待它完成。当文件下载或超时后，线程将处理下载并退出。

但我不能让它工作：

```
class JSHttpGetterThread : public QThread
{
  Q_OBJECT

public:
  JSHttpGetterThread(QObject* pParent = NULL);
  ~JSHttpGetterThread();

  virtual void run()
  {
    m_pHttp = new QHttp(this);
    connect(m_pHttp, SIGNAL(requestFinished(int, bool)), this, SLOT(onRequestFinished(int, bool)));

    m_pHttp->setHost("127.0.0.1");
    m_pHttp->get("Foo.txt", &m_GetBuffer);
    exec();
  }

  const QString& getDownloadedFileContent() const
  {
    return m_DownloadedFileContent;
  }

private:
  QHttp* m_pHttp;

  QBuffer m_GetBuffer;
  QString m_DownloadedFileContent;

private slots:
  void onRequestFinished(int Id, bool Error)
  {
    m_DownloadedFileContent = "";
    m_DownloadedFileContent.append(m_GetBuffer.buffer());
  }
}; 
```

在创建线程以启动下载的方法中，这是我正在做的事情：

```
JSHttpGetterThread* pGetter = new JSHttpGetterThread(this);
pGetter->start();
pGetter->wait(); 
```

但这不起作用，我的应用程序一直在等待。它看起来点亮了插槽“onRequestFinished”从未被调用过。

任何的想法 ？

有没有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T15:39:47.283

有点晚了，但是：不要使用这些等待循环，正确的方法是使用来自 QHttp 的 done() 信号。

我所看到的 requestFinished 信号仅适用于您的应用程序完成请求时，数据可能仍在下降中。

您不需要新线程，只需设置 qhttp：

```
httpGetFile= new QHttp();
connect(httpGetFile, SIGNAL(done(bool)), this, SLOT(processHttpGetFile(bool))); 
```

也不要忘记在 processHttpGetFile 中刷新文件，因为它可能并不都在磁盘上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T07:44:03.367

您可以直接进入一个调用的循环，而不是使用线程`processEvents`：

```
while (notFinished) {
   qApp->processEvents(QEventLoop::WaitForMore | QEventLoop::ExcludeUserInput);
} 
```

`notFinished`可以从`onRequestFinished`插槽设置的标志在哪里。

这`ExcludeUserInput`将确保在等待时忽略与 GUI 相关的事件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-30T17:04:21.333

你必须打电话`QThread::quit()`或者`exit()`如果你完成了 - 否则你的线程将永远运行......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T12:34:51.200

我选择实施大卫的解决方案，这似乎是最简单的。

但是，我处理了更多的事情：

*   我不得不为 Qt4.3.3（我正在使用的版本）调整 QEventLoop 枚举值；
*   我必须跟踪请求 ID，以确保在下载请求完成时退出 while 循环，而不是在另一个请求完成时退出；
*   我添加了一个超时，以确保在出现任何问题时退出 while 循环。

这是（或多或少）伪代码的结果：

```
class BlockingDownloader : public QObject
{
  Q_OBJECT
public:
    BlockingDownloaderBlockingDownloader()
    {
      m_pHttp = new QHttp(this);
      connect(m_pHttp, SIGNAL(requestFinished(int, bool)), this, SLOT(onRequestFinished(int, bool)));
    }

    ~BlockingDownloader()
    {
      delete m_pHttp;
    }

    QString getFileContent()
    {
      m_pHttp->setHost("www.xxx.com");
      m_DownloadId = m_pHttp->get("/myfile.txt", &m_GetBuffer);

      QTimer::singleShot(m_TimeOutTime, this, SLOT(onTimeOut()));
      while (!m_FileIsDownloaded)
      {
        qApp->processEvents(QEventLoop::WaitForMoreEvents | QEventLoop::ExcludeUserInputEvents);
      }
      return m_DownloadedFileContent;
    }

private slots:
    void BlockingDownloader::onRequestFinished(int Id, bool Error)
    {
      if (Id == m_DownloadId)
      {
        m_DownloadedFileContent = "";
        m_DownloadedFileContent.append(m_GetBuffer.buffer());
        m_FileIsDownloaded = true;
      }
    }

  void BlockingDownloader::onTimeOut()
  {
    m_FileIsDownloaded = true;
  }

private:
  QHttp* m_pHttp;
  bool m_FileIsDownloaded;
  QBuffer m_GetBuffer;
  QString m_DownloadedFileContent;
  int m_DownloadId;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-15T08:15:53.700

我出于同样的需要使用了 QNetworkAccsessManager。因为这个类管理连接 RFC 基础（6 个进程同时）和非阻塞。

[http://qt-project.org/doc/qt-4.8/qnetworkaccessmanager.html](http://qt-project.org/doc/qt-4.8/qnetworkaccessmanager.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-30T20:24:05.330

给 GUI 一些时间来等待线程然后放弃怎么样。

就像是：

```
JSHttpGetterThread* pGetter = new JSHttpGetterThread(this);
pGetter->start();
pGetter->wait(10000);  //give the thread 10 seconds to download 
```

或者...

为什么 GUI 线程必须等待“下载器线程”？当应用程序启动时，创建下载线程，将 finished() 信号连接到其他对象，启动下载线程，然后返回。当线程完成后，它将向另一个可以恢复您的进程的对象发出信号。

# php - 在 Windows 上安装 PHP 扩展

> ID：250766
> 
> 赞同：11
> 
> 时间：2008-10-30T16:09:22.910
> 
> 标签：php, windows, module, pecl, msdev

我使用的是 Windows XP 家庭版。我需要安装一些 PHP 扩展——memcache、APC、.etc。我非常想使用 PECL 来实现这一点。问题是 PECL 理所当然地认为我的计算机上会有某些程序。例如，在另一篇文章中，我读到您需要在计算机上安装 Microsoft Visual Studio C++。但是，我下载的新版 Visual Studio 没有 msdev.exe，而是使用了 vcbuild.exe，它的 api 完全不同，无法编译这些模块附带的 .dsp 文件。

所以我试图找到一个脚本来升级 dsp 以与 vcbuild.exe 一起工作......结果证明 vcbuild.exe 可以做到这一点，但当然这并没有成功。

我尝试的另一件事是为 Windows (nmake2make) 找到一个 make 脚本。但是模块的根文件夹中没有生成文件。

我还尝试下载 Cygwin 和 MinGW，希望找到一个可以像在 *nix 操作系统中一样简单工作的构建脚本，但无济于事。

我如何在 Windows 机器上使用安装 PHP 扩展？谁能帮我摆脱这种困境？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-14T10:14:49.920

对于所有来这里下载*dll*扩展文件的人。

这是 PHP 扩展下载链接[http://windows.php.net/download/](http://windows.php.net/download/)

这是要下载的 PHP 扩展列表：http: [//pecl.php.net/package-search.php](http://pecl.php.net/package-search.php)

对于核心扩展，或者如果您在 pecl.php.net 上找不到任何扩展，请从压缩包[http://windows.php.net/download/](http://windows.php.net/download/)下载 PHP，然后查看 /ext 内部并将它们复制到本地 php /ext 文件夹.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T16:23:29.650

我能想到的唯一方法是：手动。是的，我知道，但这相对来说很容易。

如果你有编译器，那么如果你有源代码，你至少可以编译一个扩展。否则，您将无法找到二进制发行版（例如我）。

据我了解，这是你所做的：

1.  将扩展库文件夹放在 PHP 的安装路径下。在我的电脑上这是`C:\xampp\php\ext`. 在您的 PHP.ini 中搜索“extension_dir”以找到您的。
2.  编辑 php.ini 以加载扩展。
    1.  找到`; Dynamic Extensions ;`。
    2.  添加行`extension=my_lib.dll`

这应该这样做。否则，您可能应该搜索有关手动安装的深入指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T16:25:26.357

对于 memcache，您需要位于此处的 memcache 服务器 -> [http://code.jellycan.com/memcached/](http://code.jellycan.com/memcached/)并下载 win32 二进制文件

没用过APC：PI使用eAccelerator0953_5.2.6缓存代码

# download - 用于自动更新的文件下载恢复组件

> ID：250767
> 
> 赞同：0
> 
> 时间：2008-10-30T16:09:46.653
> 
> 标签：download, auto-update

原来 install shield 不支持文件下载恢复。

是否有提供此功能的 .net 组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T12:21:41.653

我们使用[AppLife 更新组件](http://www.kineticjump.com/update/default.aspx)。它专门用于 .NET，可以恢复中断的下载并执行更多操作。我们发现它易于使用且灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:34:46.057

我不这么认为，但写一个并不难。已经有很多**HTTP 客户端**。您需要做的就是检查 Web 服务器是否真的支持恢复。检查此博客条目以获取有关 HTTP 和下载恢复的一些信息：

**[http://www.west-wind.com/WebLog/posts/244.aspx](http://www.west-wind.com/WebLog/posts/244.aspx)**

All you would need to do is store the number of bytes read so far somewhere ( file , database ) , and read that when you're starting your application again . Be sure to check the md5 for the file ( if it has one ) , to ensure no errors occured .

# c# - 是否可以格式化工具提示文本（粗体，下划线......等）？

> ID：250774
> 
> 赞同：4
> 
> 时间：2008-10-30T16:12:37.833
> 
> 标签：c#, winforms, formatting, coding-style, tooltip

我想在 WinForms 应用程序中将标准工具提示的一些段落加粗。这可能吗？

如果没有，是否有一个（免费的）工具提示组件可以让我设置它们的样式（最好还有边框和背景）？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T18:26:34.973

您可以使用这种类型：[气球工具提示](http://www.codeproject.com/KB/miscctrl/ballontooltip.aspx)。这让你有一些大胆的标题和一些颜色选项。您可能可以修改源以在消息中显示下划线、斜体和粗体。

![替代文字](https://www.codeproject.com/KB/miscctrl/BallonToolTip/BalloonToolTip.JPG)

## 更新：

您可以修改工具提示的绘图（以及文本的 FONT 对象）。[这是怎么做的](http://andrusdevelopment.blogspot.com/2007/10/implementing-custom-tooltip-in-c.html)。此链接中的代码是针对普通工具提示的，而不是我在上面发布的气球。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-28T08:54:34.430

如果你对 html 有一点了解，你可以像这样编写工具提示：

```
_toolTip.SetToolTip(button, String.Format("<font face=\"Microsoft Yahei\" color=\"blue\">{0}</font>", Tooltip Text)); 
```

# c# - Web 应用程序中带有 IndexSearcher/IndexWriter 的 Lucene.net

> ID：250776
> 
> 赞同：3
> 
> 时间：2008-10-30T16:13:14.993
> 
> 标签：c#, asp.net, lucene, lucene.net

我目前正在一个 Web 应用程序中运行 Lucene.net，并且想知道性能方面的最佳方法。

我目前已对其进行设置，以便在计划的过程中一起处理所有索引写入，同时优化索引。

但是对于搜索 - 我目前正在打开和关闭每个搜索的搜索器，我知道这并不理想。

您认为在这种情况下最好的方法是什么？

处理完更新/优化后，我需要关闭并重新打开索引搜索器，因此计划的进程（这是一个 Windows 控制台应用程序）需要将其完成传达给 Web 应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T16:21:42.680

我刚刚将 Lucene.NET 集成到 BugTracker.NET 中。我不确定我所做的是否是最好的，但它似乎运作良好。

我在应用程序启动时创建索引。

我创建了一个搜索器并保留它，这样每次搜索都不会重新加载索引。所有线程共享同一个搜索器。当搜索者搜索时，它会抓住一把锁。

同时，我有一个 IndexWriter 可以在数据发生更改时更新索引。它只是发生了一点变化，因此它可以快速完成任务。当它运行时，它会获取相同的锁，销毁搜索器，更新索引，然后重新创建搜索器。新的搜索器会一直存在，直到索引的下一次更新。搜索者总是使用最新的索引。

您可以获取 BugTracker.NET 源代码并查看文件 my_lucene.cs 和 search_text.aspx。这一切都在这两个文件中，并且没有那么多代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T13:36:32.793

您可以调用读者 IsCurrent() 方法来检查是否有可用的新版本索引，如果它重新打开它。这不是最好的方法，但很容易，如果您的要求不是很大，那就足够了。

# testing - 回归测试是整个测试套件还是测试样本？

> ID：250779
> 
> 赞同：8
> 
> 时间：2008-10-30T16:14:55.130
> 
> 标签：testing, regression-testing, smoke-testing

我被告知回归测试只是整体测试的一个小样本（仅足以证明您没有通过引入更改或新模块而破坏任何东西）样本。然而， Ron Morrison 和 Grady Booch 的[这篇文章](http://www.iceincusa.com/16csp/content/16_smoke/smkrgt.htm)让我有不同的想法：

> 理想的策略是一次将每个单元纳入一个单元，执行广泛的回归测试，纠正任何缺陷，然后继续下一个单元。

同一份文件还说：

> 一旦添加了少量单元，就会生成测试版本并进行“冒烟测试”，其中运行少量测试以获得集成产品将按预期运行的信心。目的既不是彻底测试新单元，也不是完全回归测试整个系统。

在描述冒烟测试时，作者是这样说的：

> 同样重要的是，烟雾测试对整个系统进行快速检查，而不仅仅是新组件。

我从未见过一起使用“广泛”和“回归测试”，也从未见过被描述为“对整个系统进行完全回归测试”的回归测试。回归测试应该尽可能简单和快速。烟雾测试的定义是我学到的回归测试。

我误解了我所教的内容吗？是不是我教错了？还是对“回归测试”有多种解释？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T16:17:17.060

有多种解释。如果您只修复影响系统一小部分的错误，那么回归测试可能只包括一小套测试相关类或包的测试。如果您要修复错误或添加范围更广的功能，那么您的回归测试也应该有更广泛的范围。

“如果它可能会损坏，请测试它”的经验法则适用于此。如果变化`Foo`可能影响`Bar`，则对两者运行回归。

回归测试只是检查更改是否导致先前通过的测试失败。它们可以在任何级别（单元、集成、系统）运行。 [参考](http://en.wikipedia.org/wiki/Software_testing#Regression_testing)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-30T19:41:22.437

我一直认为回归测试是指任何旨在确保现有功能不会被新更改破坏的测试。这并不意味着对测试套件的大小有任何限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:22:32.943

回归通常用于指代整套测试。这是 QA 在发布之前所做的最后一件事。它用于表明曾经有效的一切仍然有效，在可以显示的范围内。以我的经验，它通常是一组系统范围的测试，无论变化有多大（尽管小的变化可能不会触发回归测试）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T16:23:36.017

在我工作的地方，在每个版本结束时，每个应用程序的回归测试都是标准化的。它们旨在测试所有功能，但并非旨在捕获细微的错误。因此，例如，如果您有一个对其进行了各种验证的表单，则该表单的回归套件将确认每种类型的验证都已完成（字段级别和表单级别）并且可以提交正确的信息. 它并非旨在涵盖每一种情况（即，如果我将字段 A 留空怎么办？字段 B 怎么样？它只会测试其中一个并假设其他情况有效）。

但是，在我正在进行的当前项目中，回归测试更加彻底，我们注意到测试期间出现的缺陷数量有所减少。这两者不一定相关，但我们确实注意到它相当一致。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T17:13:36.290

我对“回归测试”一词的理解是：

*   创建系统时编写单元测试以测试功能
*   当发现错误时，会编写更多单元测试来重现错误并验证它是否已被纠正
*   回归测试运行整个测试集，证明一切仍然有效，包括没有再次出现旧错误[即证明代码没有“回归”]

在实践中，最好在进行更改时始终运行所有现有的单元测试。我唯一会打扰测试子集的时间是完整的单元测试套件需要“太长时间”才能运行[其中“太长”是相当主观的]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T17:16:52.820

从你想要完成的事情开始。然后做你需要做的事情来实现这个目标。然后使用流行语宾果游戏来给你实际做的事情分配一个词。就像其他人一样:-) 准确性并不是那么重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T17:31:24.677

> ...回归测试是整体测试的一个小样本（仅足以证明您没有通过引入更改或新模块而破坏任何东西）样本

如果一小部分测试就足以证明系统有效，那为什么剩下的测试还存在呢？如果您认为您知道您的更改只影响了一部分功能，那么为什么您需要在进行更改后测试任何内容？人类是容易犯错的，没有人真正知道改变某些东西是否会破坏其他东西。IMO，如果您的测试是自动化的，请重新运行它们。如果它们不是自动化的，就将它们自动化。同时，重新运行自动化的任何内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T18:34:24.660

通常，针对产品版本 X 中引入的新功能的一部分功能测试成为版本 X+1、X+2 等回归测试的基础。随着时间的推移，您可以减少未遭受回归的稳定特征的特征/回归测试所花费的时间。如果一个特征遭受大量回归，那么增加对该特征的强调可能是有益的。

我认为提到“广泛回归测试”的文章意味着运行一组广泛的（个别简单的）回归测试。

# unicode - 如何将 Crystal Report 导出到 Unicode 文本文件？

> ID：250784
> 
> 赞同：0
> 
> 时间：2008-10-30T16:17:27.697
> 
> 标签：unicode, vb6, crystal-reports, export, ansi

我正在尝试将 Crystal Report 导出到文本文件，同时保留其中找到的任何 Unicode 字符。默认情况下，Crystal Reports 似乎导出为 ANSI 文本文件。

这是我正在做的一个高度简化的版本：

```
Dim objCRReport As CRAXDRT.Report
[...]
objCRReport.ExportOptions.FormatType = 8 'crEFTText
objCRReport.ExportOptions.DestinationType = 1 'crEDTDiskFile
objCRReport.ExportOptions.DiskFileName = "C:\reportInTextFormat.txt"
objCRReport.Export blnPromptUser 
```

由于它以 ANSI 格式创建文件，因此我丢失了在报告中找到的所有特殊字符。当您直接查看水晶报表时，这些字符都很好。

请注意，我专门引用了“Crystal Reports 9 ActiveX Designer 运行时库”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T16:39:07.077

我想指出，我已经尝试在导出*之前*预先创建一个同名的 Unicode 文件，希望 Crystal 代码会注意到该文件，并附加到它而不是创建一个 ANSI 文件，但不幸的是这不是案子。

然后我想我可以通过导出到一个 RTF 文件（保留字符），然后读取这个 RTF 的内容（减去格式）来解决这个问题（忍者风格）。然后我会自己创建一个 Unicode 文本文件，将 RTF 内容写入其中。不幸的是，为了实现这一点，我不得不考虑使用 RichTextBox，但遇到了很多问题。我想我会在 VB.Net 中取得更大的成功，但不幸的是我被 VB6 困住了。

在尝试了这些方法之后，我发现[一篇文章](http://www.tek-tips.com/faqs.cfm?fid=3874)似乎暗示 Crystal Reports 9*支持*导出到 Unicode 文本文件，但我还没有看到它起作用。它提到打印引擎支持它，所以我将更深入地查看是否可以调用它，以防 .export 本身没有这样做（我对此表示怀疑）。

事实证明，Crystal[严重依赖打印机驱动程序来支持 Unicode](http://www.sdn.sap.com/irj/sdn/go/portal/prtroot/docs/library/uuid/a09051e9-721e-2b10-11b6-f9c65c64ef29)，所以我决定研究一下。原来打印机驱动程序*必须*支持 Unicode，我的测试环境*就是*这种情况。虽然这很有趣，但它并没有解决我的问题——我已经有一个兼容的打印机驱动程序。

所以，最后：在尝试找到解决方案几天后，我的老板决定是时候减少我们的损失了，我们计划重新设计该功能，而不涉及 Crystal Report 到文本的导出。但是，我仍然对如何使用 Crystal 导出到 Unicode 文本文件非常感兴趣——所以如果你知道如何，请回答。

# wpf - 如何仅修改扩展器按钮背景？WPF

> ID：250788
> 
> 赞同：4
> 
> 时间：2008-10-30T16:18:23.327
> 
> 标签：wpf, expander

我在一个蓝色背景的窗口上放置了一个扩展器，我想让扩展器的按钮与默认颜色不同（蓝色，它是从窗口接收的）。当我修改扩展器的背景属性时，它会将整个扩展器、标题和全部更改为新颜色。但是，我只想更改按钮本身。谁能指出我正在寻找的正确房产？谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-31T15:26:17.937

**您不仅需要重新模板 Expander ...您还需要重新模板 Expander 模板中的 ToggleButton** ...以便您可以模板绑定 Expander 上设置的背景画笔一直到 Expander 的视觉效果并进入 ToggleButton 的视觉效果（使用两个 TemplateBindings）。

当您学习如何修改 WPF 控件的视觉效果时，一件有帮助的事情（至少对我而言）是使用 SimpleStyles，因为它们比完整的普通样式和模板更容易复制和修改...... .

为此，打开 Blend 并进入资源库（最底部的工具）...如果单击它，您将看到两组控件：系统控件和简单样式。从简单样式中获取其中一个控件（无论您想要哪个），然后将其放在设计表面上。然后，您可以右键单击它，编辑控制部件（模板），然后编辑副本。这将创建一个简单样式样式和模板的副本……然后您可以（更轻松地）根据您的内心内容进行修改。

（此时我应该注意，然后我将在 Visual Studio 和 Blend 中修改该 xaml（由 Blend 生成）......根据需要来回翻转......并利用每个优点：Blend for its WYSIWYG设计表面...和 ​​Visual Studio 的代码编辑和 IntelliSense 支持。）

我已经起草了一些快速的 xaml 来满足您的要求，并将其包含在下面。您应该能够在 Kaxaml 或其他松散的 xaml 编辑器中删除此 xaml。

希望这可以帮助。

```
<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Width="640"
    Height="480"
>
    <Page.Resources>
        <LinearGradientBrush x:Key="NormalBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#EEE" Offset="0.0"/>
            <GradientStop Color="#CCC" Offset="1.0"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="NormalBorderBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#CCC" Offset="0.0"/>
            <GradientStop Color="#444" Offset="1.0"/>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="GlyphBrush" Color="#444"/>
        <LinearGradientBrush x:Key="MouseOverBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#FFF" Offset="0.0"/>
            <GradientStop Color="#AAA" Offset="1.0"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="PressedBrush" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#BBB" Offset="0.0"/>
            <GradientStop Color="#EEE" Offset="0.1"/>
            <GradientStop Color="#EEE" Offset="0.9"/>
            <GradientStop Color="#FFF" Offset="1.0"/>
        </LinearGradientBrush>

        <ControlTemplate x:Key="newToggleButtonControlTemplate" TargetType="{x:Type ToggleButton}">
            <Grid Background="{TemplateBinding Background}">
                <Rectangle
                    x:Name="Rectangle"
                    Margin="0,0,0,0"
                    Fill="Transparent"
                    Stroke="{DynamicResource NormalBorderBrush}"
                />
                <Path
                    x:Name="Up_Arrow"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Fill="{DynamicResource GlyphBrush}"
                    Data="M 0 0 L 4 4 L 8 0 Z"
                />
                <Path
                    x:Name="Down_Arrow"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Fill="{DynamicResource GlyphBrush}"
                    Data="M 0 4 L 4 0 L 8 4 Z"
                />
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter Property="Fill" Value="{DynamicResource MouseOverBrush}" TargetName="Rectangle"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="true">
                    <Setter Property="Fill" Value="{DynamicResource PressedBrush}" TargetName="Rectangle"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="true">
                    <Setter Property="Visibility" Value="Visible" TargetName="Down_Arrow"/>
                    <Setter Property="Visibility" Value="Collapsed" TargetName="Up_Arrow"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Style x:Key="newExpanderStyle" TargetType="{x:Type Expander}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Expander}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*" x:Name="ContentRow"/>
                            </Grid.RowDefinitions>
                            <Border
                                x:Name="Border"
                                Grid.Row="0"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2,2,0,0"
                            >
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <ToggleButton
                                        Template="{DynamicResource newToggleButtonControlTemplate}"
                                        Background="{TemplateBinding Background}"
                                        IsChecked="{Binding Path=IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                        OverridesDefaultStyle="True"
                                    />
                                    <ContentPresenter Grid.Column="1" Margin="4" RecognizesAccessKey="True" ContentSource="Header"/>
                                </Grid>
                            </Border>
                            <Border
                                x:Name="ExpandSite"
                                Grid.Row="1"
                                Visibility="Collapsed"
                                BorderThickness="1,0,1,1"
                                CornerRadius="0,0,2,2"
                            >
                                <ContentPresenter
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Margin="{TemplateBinding Padding}"
                                    Focusable="false"
                                />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="True">
                                <Setter Property="Visibility" Value="Visible" TargetName="ExpandSite"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Page.Background>
        <LinearGradientBrush EndPoint="0.997,0.996" StartPoint="0.002,0.058">
            <GradientStop Color="#FF63A6DE" Offset="0"/>
            <GradientStop Color="#FFC2DEF5" Offset="1"/>
        </LinearGradientBrush>
    </Page.Background>

    <Grid x:Name="LayoutRoot">
        <Expander
            Style="{DynamicResource newExpanderStyle}"
            Header="Expander"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Background="{DynamicResource NormalBrush}"
        >
            <Grid>
                <Button Content="Hello World"/>
            </Grid>
        </Expander>
    </Grid>
</Page> 
```

# arrays - 使用 FasterCSV 将不均匀的行转换为列

> ID：250789
> 
> 赞同：4
> 
> 时间：2008-10-30T16:18:27.383
> 
> 标签：arrays, ruby, transpose, fastercsv

我有一个 CSV 数据文件，其中的行可能有很多 500+ 列，而有些列则少得多。我需要转置它，以便每一行成为输出文件中的一列。问题是原始文件中的行可能并不都有相同的列数，所以当我尝试数组的转置方法时，我得到：

> `transpose'：元素大小不同（12 应该是 5）（IndexError）

是否有替代方法可以处理不均匀的数组长度？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-30T16:57:54.357

我会插入空值来填充矩阵中的孔，例如：

```
a = [[1, 2, 3], [3, 4]]

# This would throw the error you're talking about
# a.transpose

# Largest row
size = a.max { |r1, r2| r1.size <=> r2.size }.size

# Enlarge matrix inserting nils as needed
a.each { |r| r[size - 1] ||= nil }

# So now a == [[1, 2, 3], [3, 4, nil]]
aa = a.transpose

# aa == [[1, 3], [2, 4], [3, nil]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-24T12:15:12.267

```
# Intitial CSV table data
csv_data = [ [1,2,3,4,5], [10,20,30,40], [100,200] ]

# Finding max length of rows
row_length = csv_data.map(&:length).max

# Inserting nil to the end of each row
csv_data.map do |row|
  (row_length - row.length).times { row.insert(-1, nil) }
end

# Let's check
csv_data
# => [[1, 2, 3, 4, 5], [10, 20, 30, 40, nil], [100, 200, nil, nil, nil]]

# Transposing...
transposed_csv_data = csv_data.transpose

# Hooray!
# => [[1, 10, 100], [2, 20, 200], [3, 30, nil], [4, 40, nil], [5, nil, nil]] 
```

# javascript - 奇怪的 IE 和 Javascript 问题

> ID：250790
> 
> 赞同：1
> 
> 时间：2008-10-30T16:18:27.947
> 
> 标签：javascript, internet-explorer, web-applications

因此，我正在根据用户在页面上单击的位置使用 javascript 创建一些 HTML。在页面加载时，脚本会用 ul 和一些数据替换一个空的 div。用户单击该数据以接收更多信息，依此类推。现在当用户离开页面然后点击返回按钮返回页面时，IE 会显示一个带有替换 div 的空白页面，在所有其他浏览器、FF、Opera、Safari 中，页面要么重新加载到初始 ul或返回到最后一个状态，其中包含动态数据。

任何人都知道这里可能会发生什么？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T21:56:58.683

特鲁尔的回答是正确的。Opera 和更高版本的 Firefox(>1.5) 不考虑从缓存加载页面作为需要触发 onload 事件，因为完整的 DOM 状态也被缓存。

这对于跨浏览器进行标准化是微不足道的，因为如果您定义了 window.onunload 事件，Opera 和 Firefox 就不会表现出这种行为。请参阅[http://developer.mozilla.org/en/Using_Firefox_1.5_caching](http://developer.mozilla.org/en/Using_Firefox_1.5_caching)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T16:45:53.960

听起来您需要管理页面的历史记录和状态。查看我们的 Brad Neuberg 的《[真正简单的历史》](http://code.google.com/p/reallysimplehistory/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:54:23.863

向后和向前导航时 onload 事件的行为不是标准的跨浏览器。作为一般规则，我发现当您单击返回时，onload 事件往往不起作用，因为浏览器正在从缓存加载它而不是重新请求页面。您可以尝试使用 dom 就绪事件而不是窗口加载。

# oracle - 如何使用参数值记录/跟踪 Oracle 存储过程调用？

> ID：250792
> 
> 赞同：4
> 
> 时间：2008-10-30T16:19:04.403
> 
> 标签：oracle

我们正在寻找一种方法来记录对 Oracle 中存储过程的任何调用，并查看调用使用了哪些参数值。

我们正在使用 Oracle 10.2.0.1

我们可以记录 SQL 语句并查看绑定变量，但是当我们跟踪存储过程时，我们会看到绑定变量 B1、B2 等，但没有值。

我们希望看到与在 MS SQL Server Profiler 中看到的相同类型的信息。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T17:14:14.823

您可以查看[DBMS_APPLICATION_INFO 包](http://download-west.oracle.com/docs/cd/A87860_01/doc/appdev.817/a76936/dbms_app.htm)。这允许您使用您想要的任何信息“检测”您的 PL/SQL 代码 - 但它确实需要添加对每个要检测的过程的调用。

另请参阅有关使用 DBMS_APPLICATION_INFO 监控 PL/SQL 的[AskTom 线程。](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:767025833873)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T18:24:37.207

我认为您以一种奇怪的方式使用“日志”一词。

> 我们可以记录 SQL 语句...

您的意思是说您可以使用绑定变量跟踪 sql 语句吗？托尼的回答是针对记录您正在做的事情的能力。这总是优于追踪，因为只有你知道什么对你来说很重要。也许您的流程的执行很大程度上取决于从表中查询一个值。由于该值发生了变化并且没有作为参数传入，因此您可能会丢失该信息。

但是如果你真的记录你正在做的事情，你可以在你的日志表中包含那个值，你不仅会知道你传入的变量，还会知道那个键值。

更改系统设置事件'10046 永远跟踪名称上下文，级别 12'；那是你用的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T20:33:40.643

是的，我想我应该使用“跟踪”这个词

我将尝试描述我们所做的：

使用企业管理器（作为 dbo），我们进入了一个会话，并开始了一个跟踪

启动跟踪启用等待信息，绑定信息

在我们的应用程序上运行一个命中数据库的操作

完成跟踪，在输出上运行：

tkprof .prc output2.txt sys=no record=record.txt 解释=dbo@DBINST/PW

我们想看到的是，“这些过程是用这些参数调用的”我们得到的是：

```
Begin dbo.UPKG_PACKAGENAME.PROC(:v0, :v1, :v2 ...); End;
/
Begin dbo.UPKG_PACKAGENAME.PROC2(:v0, :v1, :v2 ...); End;
/
... 
```

所以我们可以追踪被调用的过程，但我们没有得到实际的参数值，只有 :v0 等。

我的理解是我们所做的与alter system语句相同，但如果不是这样，请告诉我们。

谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T07:08:20.553

你用的是 10g 让我们试试这个 exec dbms_monitor.session_trace_enable(session_id=>xxx, serial_num=>xx, waits=>true, binds=>true); 你可以从 v$session 获取 session_id=SID & serial_num=SERIAL#

# asp.net - 您可以重命名 App_Code 文件夹吗？

> ID：250794
> 
> 赞同：1
> 
> 时间：2008-10-30T16:19:37.240
> 
> 标签：asp.net, web-config

我意识到这会违反约定，但我很想知道您是否可以通过配置来做到这一点。

**编辑：我明白为什么我不想这样做。但是，我确实想了解这个项目的内部情况。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:24:53.237

不，您不能重命名此文件夹并让它实际包含可执行代码。Web 项目系统经过硬编码以在此文件夹中查找代码，并且不会考虑任何其他文件夹中的原始代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T16:29:18.563

Reflector 告诉我**System.Web.HttpRuntime**包含...

```
internal const string CodeDirectoryName = "App_Code"; 
```

所以答案是否定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T16:22:46.377

我不认为这是可能的，但你为什么需要改变它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T16:24:52.863

谷歌“配置公约”

# ajax - 如何使用ajax同时初始化两个列表？

> ID：250801
> 
> 赞同：0
> 
> 时间：2008-10-30T16:22:28.140
> 
> 标签：ajax, list

嗨，有人知道如何使用 ajax 同时初始化两个列表吗？

这是我的代码

```
<html>
<body onload="iniciaListas()">

<script type="text/javascript">
var xmlHttp
function iniciaListas()
{
        muestraListaPaises();
        muestraListaProfesiones();
}
function muestraListaProfesiones()
{
    //Se inicializa el objeto ajax para manipular los eventos asincronos al servidor
    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
      alert ("Your browser does not support AJAX!");
      return;
    } 
    //Se obtine el id de la lista
    var obCon = document.getElementById("ocupacion");
    //Por medio del metodo GET se llama nuestra pagina PHP
    xmlHttp.open("GET", "../Listas/listaProfesiones.php");
    //On ready funcion es la funcion que se da cuenta cuando la pagina php acaba de hacer su proceso
    xmlHttp.onreadystatechange = function() {
        //el estado 4 indica que esta listo para procesar la instruccion
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
            //despues que nuestro objeto ajax  proceso la pagina php recupera un xml generado
            obXML = xmlHttp.responseXML;
            //despues obtine los datos contenidos en las siguites etiquetas
            obCod = obXML.getElementsByTagName("ID");
            obDes = obXML.getElementsByTagName("NOMPROFESION");
            //esta funcion devuelve en su la longitud de todos los registros 
            obCon.length=obCod.length;
            //cilclo de llenado para las listas
            for (var i=0; i<obCod.length;i++) {
                obCon.options[i].value=obCod[i].firstChild.nodeValue;
                obCon.options[i].text=obDes[i].firstChild.nodeValue;
            }
        }
    }   
    //este objeto envia un nulll debido a que el metodo utilizado es get
    xmlHttp.send(null);
}
function muestraListaPaises()
{
    //Se inicializa el objeto ajax para manipular los eventos asincronos al servidor
    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
      alert ("Your browser does not support AJAX!");
      return;
    } 
    //Se obtine el id de la lista
    var obCon = document.getElementById("pais");
    //Por medio del metodo GET se llama nuestra pagina PHP
    xmlHttp.open("GET", "../Listas/listaPaises.php");
    //On ready funcion es la funcion que se da cuenta cuando la pagina php acaba de hacer su proceso
    xmlHttp.onreadystatechange = function() {
        //el estado 4 indica que esta listo para procesar la instruccion
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
            //despues que nuestro objeto ajax  proceso la pagina php recupera un xml generado
            obXML = xmlHttp.responseXML;
            //despues obtine los datos contenidos en las siguites etiquetas
            obCod = obXML.getElementsByTagName("ID");
            obDes = obXML.getElementsByTagName("NOMPAIS");
            //esta funcion devuelve en su la longitud de todos los registros 
            obCon.length=obCod.length;
            //cilclo de llenado para las listas
            for (var i=0; i<obCod.length;i++) {
                obCon.options[i].value=obCod[i].firstChild.nodeValue;
                obCon.options[i].text=obDes[i].firstChild.nodeValue;
            }
        }
    }   
    //este objeto envia un nulll debido a que el metodo utilizado es get
    xmlHttp.send(null);
}

    function GetXmlHttpObject()
    {
        var xmlHttp=null;
        try
          {
          // Firefox, Opera 8.0+, Safari
          xmlHttp=new XMLHttpRequest();
          }
        catch (e)
          {
          // Internet Explorer
          try
            {
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
            }
          catch (e)
            {
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
          }
        return xmlHttp;
    }  
</script>

<html>

<body onload="iniciaListas()">
<script type="text/javascript" src="lists.js"> </script>
<b>Country</b><br>
<select name="pais" id="pais" ></select>

<b>Ocupation</b><br>
<select name="pais" id="pais" ></select>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:26:45.090

我建议对职业节点使用不同的 ID，并加倍添加：

JS Snip - 获取另一个列表，同时添加：

```
//Se obtine el id de la lista
var obCon = document.getElementById("pais");
var obOcupation = document.getElementById("ocupation");

...

for (var i=0; i<obCod.length;i++) {
   obCon.options[i].value=obCod[i].firstChild.nodeValue;
   obCon.options[i].text=obDes[i].firstChild.nodeValue;
   obOcupation.options[i].value=obCod[i].firstChild.nodeValue;
   obOcupation.options[i].text=obDes[i].firstChild.nodeValue;
} 
```

HTML - 给第二个选择不同的名称（用于服务器端）和 id（用于 javascript）：

```
<html>
<body onload="iniciaListas()">
<script type="text/javascript" src="lists.js"> </script>
<b>Country</b><br>
<select name="pais" id="pais" ></select>

<b>Ocupation</b><br>
<select name="ocupation-pais" id="ocupation" ></select>
</body>

</html> 
```

您的代码可以通过使用现有的 JS 框架（如[jQuery](http://jquery.com) ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:31:56.793

据推测，Ajax 调用会以字符串或 JSON 对象的形式获取数据，然后调用您指定的某个 OnComplete 函数。通常，在 OnComplete 中，您获取该数据并使用它来填充列表。只需在该函数中输入双倍的填充代码

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-30T16:28:49.517

使用 ajax 可能不够具体。你的意思是在 JavaScript 中？

# oracle - 您如何评价 Oracle Portal 作为一个平台？

> ID：250816
> 
> 赞同：0
> 
> 时间：2008-10-30T16:26:21.720
> 
> 标签：oracle, oracleportal

一位客户询问我是否可以为他在 Oracle Application Server Portal 上运行的 Intranet 提供一些支持。之前没有使用过这项技术，我想我会问其他人是否拥有以及他们想为它开发什么。

我是 ac#/ASP.NET 开发人员，所以我担心地注意到开发人员指南中没有提及 .NET。有人试图让这两者一起工作并活着讲述这个故事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T19:06:56.373

Oracle Portal 从来没有打算成为一个“平台”，而是为了满足特定需求。当 Portal 不是直接的正确解决方案时，指针指向 JDev 和 BC4J，另外还需要其他东西。我已经完成了广泛的 Oracle 门户开发，并且就其本身而言，它做得很好（即核心数据和应用程序的“门户”，并通过门户公开了该数据）。

门户产品目前的方向是将其分离出来，放在Oracle的“Web Center”之下。这里的重点是使 portlet 的开发越来越接近标准的 java 开发。您可以在这里找到官方声明： [http ://www.oracle.com/technology/products/ias/portal/pdf/oracle_portal_sod_r11.pdf](http://www.oracle.com/technology/products/ias/portal/pdf/oracle_portal_sod_r11.pdf)

Web Center 更像是一个“平台”，其中包含围绕 2.0 技术的所有流行语。包括内容管理、门户和 .NET WSRP 集成特性/功能。除了门户网站（它也为 Web 中心提供快速简单的 portlet）之外，我还会检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T18:16:26.257

我对 Oracle Portal 的唯一体验是间接的，当时我继承了一个系统，该系统将其用于一个相对简单的维护 Web 应用程序。我对 Oracle 产品的大部分看法来自我使用 SQL Server/ASP.NET 的背景，但 Oracle 的设置、管理和继续运行更难，这不仅适用于数据库，也适用于辅助工具，例如Oracle Portal、他们的 SOA 套件、他们的 Mobility Server 等。即使是经验丰富的 Oracle 人员也倾向于同意这一点，所以希望我不会惹恼任何人。

除非我对这些工具有丰富的经验，否则我绝对不会为 Oracle Portal 应用程序（或任何其他 Oracle 产品）提供支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T11:15:31.957

我的公司（一家专门的 Oracle 商店）和我使用 Oracle Portal 已经很多年了，并且非常成功。但是**，如果您没有使用 PL/SQL**（Oracle 的专有数据库编程语言）的经验，我必须警告您不要承担这项任务。

在 Oracle Portal 上构建的 Intranet 可能会广泛使用定制的“portlet”。您可以使用 Java 或 PL/SQL 构建它们；根据我的经验，现实生活中 95% 的 portlet 都是使用 PL/SQL 构建的。

理论上，如果您使用最新版本的 Oracle Portal (10.1.4)，您可以使用 WSRP 1.0 portlet。因此，如果您可以在 .NET 中构建将使用 WSRP 1.0 进行通信的 portlet，那么您可以集成这些。但是如果您的客户要求“支持”，他们可能希望您能够调整他们现有的 portlet——这需要 PL/SQL 编程经验。

Oracle Wiki 上对 Oracle Portal 有相当好的描述： [http ://wiki.oracle.com/page/Oracle+Portal](http://wiki.oracle.com/page/Oracle+Portal)

从战略上讲，Oracle 已将 Oracle Portal 置于“Continue & Converge”类别中，这意味着它受到支持并将获得较小的更新。如今，他们的战略门户产品是 Oracle WebCenter，但每个 CPU 庞然大物的价格为 125,000 美元；对于在 Oracle Portal 上构建的所有站点中的 99% 来说，这可能是多余的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-09T13:57:12.560

在过去的几年里，我已经为 Oracle Portal 开发了十几个 Java portlet。如果您不一定要使用 .NET 开发 portlet 并且不想使用 PL/SQL，我会推荐这种方法。Oracle 的 Portlet Developer Kit (PDK) 提供了很好的功能 ( [http://www.oracle.com/technology/products/ias/portal/pdk.html](http://www.oracle.com/technology/products/ias/portal/pdk.html) )。

我没有尝试过 WSRP 方法，但已经使用 Oracle Portal 附带的 Web Clipping Portlet 部署了 ASP.NET 应用程序并取得了一些成功。

我发现 Portal 有时很难使用，而深入了解 Application Server 堆栈中的其他组件（OID、SSO、Oracle DB 等）非常有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-22T14:21:00.503

我建议您看看 Oracle 的 WebCenter 11g Suite。当甲骨文收购 BEA 时，它承担了一些门户产品，但据我所知，WebCenter 11g 是甲骨文未来门户的故事——所有积极的开发都将集中在那里。你可以在那里找到相当数量的材料。这是[一篇帮助您开始使用 WebCenter 11g 的博客文章](http://www.function1.com/2010/01/the-elephant-in-the-room-a-gentle-intro-to-webcenter-11g-for-wcialui-customers/)。

# stored-procedures - 给定出现在 proc 中的文本字符串，在 db 中查找 Sybase 存储过程

> ID：250818
> 
> 赞同：10
> 
> 时间：2008-10-30T16:26:38.537
> 
> 标签：stored-procedures, sap-ase

给定出现在 proc 中某处的文本字符串，如何在 Sybase 数据库中找到存储过程？我想看看数据库中的任何其他 proc 是否具有与我正在查看的类似的逻辑，并且我认为我有一个非常独特的搜索字符串（文字）

编辑：

我正在使用 Sybase 11.2 版

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T13:57:28.377

Graeme 的回答有两种变体（所以这也不适用于 11.2）：

这也列出了 sproc 的名称，但如果文本出现多次，将为每个 sproc 返回多行：

```
select object_name(id),* from syscomments 
   where texttype = 0 and text like '%whatever%' 
```

这仅列出每个存储过程一次：

```
select distinct object_name(id) from syscomments 
   where texttype = 0 and text like '%whatever%' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-30T16:40:24.157

在 SQL Anywhere 和 Sybase IQ 中：

```
select * from SYS.SYSPROCEDURE where proc_defn like '%whatever%' 
```

我对 ASE 不太熟悉，但根据文档（可从 sybooks.sybase.com 获得），它类似于：

```
select * from syscomments where texttype = 0 and text like '%whatever%' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-29T13:03:17.220

请记住，syscomments 中的文本列是 varchar(255)，所以一个大过程可以由 syscomments 中的多行组成，因此，如果在 syscomments 中将其拆分为 2 个文本行，上述选择将找不到过程名称。

我建议以下选择，它将处理上述情况：

```
declare @text varchar(100)
select @text        = "%whatever%"

select distinct o.name object
from sysobjects o,
    syscomments c
where o.id=c.id
and o.type='P'
and (c.text like @text
or  exists(
    select 1 from syscomments c2 
        where c.id=c2.id 
        and c.colid+1=c2.colid 
        and right(c.text,100)+ substring(c2.text, 1, 100) like @text 
    )
)
order by 1 
```

--[感谢 ASEisql的创建者](http://code.google.com/p/aseisql/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-07-13T13:35:21.470

```
select *  from sysobjects where 
    id in ( select distinct (id) from syscomments where text like '%SearchTerm%')
    and xtype = 'P' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-12T05:03:28.813

```
select distinct object_name(syscomments.id) 'SearchText', syscomments.id from syscomments ,sysobjects 
   where texttype = 0 and text like '%SearchText%' and syscomments.id=sysobjects.id and sysobjects.type='P' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-06T16:19:03.267

多行用于存储数据库对象的文本，值可能跨越两行。所以更准确的答案是：

```
select distinct object_name(sc1.id)
from syscomments sc1
left join syscomments sc2
on (sc2.id = sc1.id and 
sc2.number = sc1.number and
sc2.colid2 = sc1.colid2 + ((sc1.colid + 1) / 32768) and
sc2.colid = (sc1.colid + 1) % 32768)
where
sc1.texttype = 0 and
sc2.texttype = 0 and
lower(sc1.text + sc2.text) like lower('%' ||     @textSearched || '%') 
```

# .net - Dotfuscator 社区版

> ID：250828
> 
> 赞同：1
> 
> 时间：2008-10-30T16:29:25.613
> 
> 标签：.net, obfuscation, dotfuscator

我尝试在我的类库“mylib.core.data.dll”上使用它并成功混淆，但是，当我通过“参考”将此 dll 导入另一个项目并尝试

导入 --- 我的库“mylib.core.data.dll”，除了“e”和“h”外不显示。有人可以告诉我在混淆过程中我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-30T16:50:59.783

您正确地混淆了文件并且您的类被重命名。如果您的 dll 将成为库 dotfuscator 具有您可以设置的库模式，或者您可以关闭重命名。

# php - 将 POST 数组转换回 POST 字符串数据

> ID：250829
> 
> 赞同：8
> 
> 时间：2008-10-30T16:29:43.447
> 
> 标签：php, arrays, post

当您在 HTML 表单中执行以下操作时：

```
<input name="one[]" value="foo" />
<input name="one[]" value="bar" />
<input name="two[key]" value="something" /> 
```

并将表单提交到 PHP 页面，$_POST 数组将如下所示：

```
array(
    'one' => array(
        0 => 'foo',
        1 => 'bar'
    ),
    'two' => array(
        'key' => 'something'
    ),
), 
```

但是，如果您查看标题数据，它将如下所示：

```
one[]=foo&one[]=bar&two[key]=something 
```

有没有人有一个脚本可以将 PHP 数组转换回 POST 数据字符串？[urlencode](http://php.net/urlencode)不起作用，因为它无法访问数组...

* * *

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-30T16:31:21.617

你要`http_build_query()`

# c# - 这是 DirectoryInfo.GetDirectories(string searchPattern) 中的错误吗？

> ID：250834
> 
> 赞同：11
> 
> 时间：2008-10-30T16:31:04.317
> 
> 标签：c#, .net

在指向有效文件夹（不包括驱动器根）的 DirectoryInfo 类的实例上调用[DirectoryInfo.GetDirectories(".")](http://msdn.microsoft.com/en-us/library/f3e2f6e5.aspx)时，结果是一个 DirectoryInfo 数组，其第一个（也是唯一一个）元素指向同名的无效目录作为它自己，低于它自己。

例如：

```
static void Main(string[] args)
{
    DirectoryInfo di = new DirectoryInfo("c:\\temp");
    DirectoryInfo[] dis = di.GetDirectories(".");
    Console.WriteLine(dis[0].FullName);
} 
```

打印出一个不存在的目录：

```
c:\temp\temp 
```

据我所知，在 Windows 中，一个“。” 指当前目录。如果该方法返回“c:\temp”，这对我来说可能是可以接受的，但返回一个具有相同名称的虚假子目录似乎绝对是错误的行为。

**我应该能够断言从这个函数返回的任何 DirectoryInfo 对象确实存在......对吧？！**

我使用 .NET Reflector 反编译了该类，但它导致了这种方法

```
internal static string[] InternalGetFileDirectoryNames(string path, string userPathOriginal, string searchPattern, bool includeFiles, bool includeDirs, SearchOption searchOption)" 
```

这是一头野兽，我不想在脑海中走逻辑。恕我直言，这显然是一个错误。

仅供参考 - 在有人问之前，“*”按预期工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T17:04:38.290

我可以确认你所说的，并且看不到任何合理的解释，所以我投票**BUG**。

我也这么认为，我[把它提交](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=378565)给了微软

# wpf - 如何将 TextBox 的 TextWrapping 属性绑定到 MenuItem 的 IsChecked 值？

> ID：250840
> 
> 赞同：6
> 
> 时间：2008-10-30T16:32:45.873
> 
> 标签：wpf, binding, enums, checkbox, word-wrap

TextBox 的 TextWrapping 属性具有三个可能的值：

*   裹
*   无包装
*   WrapWithOverflow

我想绑定到 MenuItem 的 IsChecked 属性。如果选中了 MenuItem，我想将 TextBox 的 TextWrapping 属性设置为 Wrap。如果未选中 MenuItem，我想将 TextBox 的 TextWrapping 属性设置为 NoWrap。

总而言之，我试图将具有两个状态的控件绑定到具有两个以上值的枚举的两个值。

**[编辑]**如果可能，我想在 XAML 中完成此操作。

**[编辑]**我想出了如何使用 IValueConverter 来做到这一点。也许有更好的方法来做到这一点？这是我所做的：

* * *

在 Window.Resources 中，我声明了对我的 ValueConverter 的引用。

```
<local:Boolean2TextWrapping x:Key="Boolean2TextWrapping" /> 
```

在我的 TextBox 中，我创建了与 MenuItem 的绑定，并将 Converter 包含在绑定语句中。

```
TextWrapping="{Binding ElementName=MenuItemWordWrap, Path=IsChecked, Converter={StaticResource Boolean2TextWrapping}}" 
```

ValueConverter 看起来像这样：

```
public class Boolean2TextWrapping : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo cultureInfo)
        {
            if (((bool)value) == false)
            {
                return TextWrapping.NoWrap;
            }
            return TextWrapping.Wrap;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T00:54:03.380

如果您想在 xaml 中完成这一切，您需要使用[Style](http://msdn.microsoft.com/en-us/library/system.windows.style.aspx)和[DataTrigger](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)。

```
<StackPanel>
    <CheckBox x:Name="WordWrap">Word Wrap</CheckBox>
    <TextBlock Width="50">
        Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Proin lacinia nibh non augue. Pellentesque pretium neque et neque auctor adipiscing.

        <TextBlock.Style>
            <Style TargetType="{x:Type TextBlock}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsChecked, ElementName=WordWrap}" Value="True">
                        <Setter Property="TextWrapping" Value="Wrap" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </TextBlock.Style>
    </TextBlock>
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T19:36:58.403

我认为~~唯一且正确~~的典型方法是使用您已经使用的值转换器。

有时您可以找到您已经构建的现有价值转换器……甚至是 Microsoft 为您构建的更好的转换器。例如，在 System.Windows.Controls 中，Microsoft 编写了 BooleanToVisibilityConverter ... 将 bool 转换为 Visibility 枚举 ... 将 True 转换为 Visible 并将 False 转换为 Collapsed（而不用担心 Hidden）。

一个想法是使用 .NET Reflector，导航到 System.Windows.Data.IValueConverter，然后使用分析功能（特别是“使用者”）并查看实现了 IValueConverter 的内容......你可能会得到很幸运能找到适合您目的的转换器。

在相关说明中， BooleanToVisibilityConverter 与您在上面尝试执行的操作非常相似。

**编辑：** 我真的很喜欢 Todd White 关于设置 TextBox 样式并在 Style 中使用 DataTrigger 的建议。如果您想避免使用转换器，这是一个非常好的主意。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-30T17:07:01.060

我假设您正在谈论.NET。我认为数据绑定不会在这里起作用，因为这些值的类型不同（布尔值与枚举）。最简单的解决方案是处理该菜单项的 CheckedChanged 事件并相应地调整文本框的换行模式。

# open-source - 开源项目分析网站？

> ID：250843
> 
> 赞同：1
> 
> 时间：2008-10-30T16:34:04.577
> 
> 标签：open-source, analytics

过去我至少看过一个网站，它对开源项目进行了分析，描述了代码行、工作时间、签到次数，以及各种各样的东西。

有人知道这些网站吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:43:03.497

他们采用不同的[指标](https://stackoverflow.com/questions/tagged/metrics)，例如[Ohloh](http://www.ohloh.net/)。

# sql-server - 如何在 SQL Server 2008 Express 中使用 SQL Server Management Studio 启用全文索引？

> ID：250844
> 
> 赞同：8
> 
> 时间：2008-10-30T16:34:12.220
> 
> 标签：sql-server, sql-server-2008, ssms

我使用[此处](http://www.wherecanibuyit.co.uk/ASP/full-text-search.html)描述的命令完成了它，它可以工作，但**我想使用 SQL Management Studio 来完成**。

SQL Server 2008 联机丛书说：

> 要创建全文目录：
> 
> 1.  在对象资源管理器中，展开服务器，展开**数据库**，然后展开要在其中创建全文目录的数据库。
>     
>     
> 2.  展开 **存储**，然后右键单击全文目录。
>     
>     
> 
> 选择**新建全文目录**。
> 
> 在“新建**全文目录**”对话框中，指定要重新创建的目录的信息。有关详细信息，请参阅新建全文目录（常规页面）。
> 
> 单击**确定**。

在我的 SQL Server Management Studio 中没有像 Storage 这样的选项。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T16:40:25.263

您需要安装**带有高级服务的 SQL Server 2008 Express**才能在 2008 Express 中使用全文搜索。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T18:57:28.713

行。SSMS-E 似乎不支持全文目录的管理。

[CodePlex ( http://www.codeplex.com/FulltextManager](http://www.codeplex.com/FulltextManager) )上有一个免费的插件，似乎添加了这个功能。

或者，您可以购买包含完整版 SSMS 的 SQL2008 Developer 版（我相信成本仍然只有 49 美元），并且可以连接到 SSE 安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-14T20:16:34.887

您应该安装 SQL Express 2008 服务包 1 -> [http://www.apijunkie.com/APIJunkie/blog/post/2010/07/12/Fix-SQL-Server-2008-Express-Full-Text-Index-Management -缺少.aspx](http://www.apijunkie.com/APIJunkie/blog/post/2010/07/12/Fix-SQL-Server-2008-Express-Full-Text-Index-Management-Missing.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T07:05:29.963

您使用的是完整版的 SSMS 还是 Express 版？

另外，您使用的是最新版本的 SQL BooksOnline。2008 年 8 月版本或在线版本。不幸的是，在 RTM 上发布的 BOL 版本主要是在 2 月发布时编写的，从那时到发布之间对 SSMS 进行了大量更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T22:38:16.733

您也可以考虑升级到支持全文搜索的 SQL Server 2008 R2 Express Advanced。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T11:38:51.497

我想使用 CodePlex 插件是唯一的方法，因为即使使用标准版的 SSMS，您也无法管理 Express 全文目录。

# asp.net - 在经典 ASP 中利用 SOAP

> ID：250845
> 
> 赞同：4
> 
> 时间：2008-10-30T16:34:24.513
> 
> 标签：asp.net, rest, soap, asp-classic

> 澄清：这不是关于*用户代理*对页面的调用，而是经典 ASP 调用 ASP.NET！

我的应用程序正在从经典 ASP 过渡到 ASP.NET。有 50 万行代码，因此一次完全重写所有内容根本不合理，或者坦率地说，考虑到绝大多数经典 ASP 页面都可以正常工作，这是不明智的。*我们翻译页面和功能，因为它们无论如何*都要进行修订，而不仅仅是因为它“酷”。

现在已经转换了大约一半的页面，我们将一些关键功能转移到了 ASP.NET。我没有保留此功能的旧版本（这意味着要维护两个地方而不是一个），而是转向使用 SOAP 来公开此功能。

嗯...不是真的。相反，我们一直在使用我以前称之为“Poor Man's SOAP”的东西，尽管今天称它为 REST 很流行。我一直在使用 ServerXMLHTTP 联系目标页面，将一团 XML 捆绑起来并将其发布到 ASP.NET 端。对于结果，我一直在捆绑一些 XML 并使用 XPATH 将其分解为变量。

所有这些都出奇地好。但是，我一直在考虑内置的 ASP.NET SOAP 功能，这似乎消除了为我的跨平台调用自定义编写登录页面的需要......但是当我查看从 Classic ASP 消费 SOAP 时，大多数建议使用看似贬值的肥皂工具包。

问题是; 你们中有人有这种设置的经验吗？如果有，有没有比自定义 REST 页面或 Soap Toolkit 更好的方法？我认为能够更快地公开更多 ASP.NET 功能将有助于迁移，但我不想让自己陷入不必要的 Soap Toolkit 等遗留技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T17:27:13.797

做更多的搜索我发现

> [从经典的 asp 页面调用 REST Web 服务](https://stackoverflow.com/questions/11219/calling-rest-web-services-from-a-classic-asp-page)

这又与

> [http://www.aspfree.com/c/a/ASP/Consuming-a-WSDL-Webservice-from-ASP/](http://www.aspfree.com/c/a/ASP/Consuming-a-WSDL-Webservice-from-ASP/)

这几乎就是我现在做事的方式，所以也许这是最好的解决方案？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T17:03:31.037

我将[Prototype](http://prototypejs.org)与许多用于 AJAX 调用的经典 ASP 页面一起使用。对于我的数据层，我更喜欢使用 JSON 而不是 XML。Ajax + JSON 比 SOAP + XML 更轻、更快、更容易处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-17T15:20:58.660

我可以用下面的代码做到这一点，显然你需要改变一些东西，但希望这可以让你开始：

```
Set xmlhttp = CreateObject("MSXML2.ServerXMLHTTP")                          
xmlhttp.open "POST", soapServer, False
xmlhttp.setRequestHeader "Content-Type", "text/xml; charset=utf-8"
xmlhttp.setRequestHeader "SOAPAction", char(34) & "WebPlatform.WebServices/ISessionTokenServiceV1/CreateSessionToken" & char(34)

xmlhttp.send soapMessage 
```

soapMEssage 将是您发送的肥皂请求。soapServer是web服务的url，如：[http://localhost:8000/WebServices/SampleService.svc/BASIC](http://localhost:8000/WebServices/SampleService.svc/BASIC)

# xml - 在 SAX 解析器中传递未知 XML 元素

> ID：250846
> 
> 赞同：1
> 
> 时间：2008-10-30T16:34:30.283
> 
> 标签：xml, sax

我正在从 XML 文档加载一些数据，对其进行修改，然后写回 XML。读取是使用 SAX 解析器库完成的，而写入是使用一段自定义代码完成的。有时，文件会在外部进行修改，并添加额外的元素（例如对样式表的引用）。我不想在加载和保存文件时丢失这些额外的元素，而是希望通过任何未知标签以便它们出现

当未知元素与解释元素分开时，将未知元素和属性保存为字符串并在之后输出它们应该很简单，但是当它们散布并嵌套在解释元素中时，它就变得不那么明显了。

任何人都可以提出一个简洁的方法来做到这一点吗？切换到 DOM 解析器会更简单吗？性能不是问题。

*注意。*我正在使用 Gnome Glib::Markup::Parser 使用 C++，但更喜欢与语言/库无关的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T18:50:10.587

我不知道您是如何编写内容处理程序的，但是应该在所有事件上调用它的方法，包括您要保留的外部修改。你`startElement()`和`endElement()`回调可以测试元素名称和属性来决定是否对要修改的元素调用专门的方法，但默认情况下只是重建并输出调用回调的事件。这样，您没有专门处理的任何元素都会默认获得输出。

您也可以在 XSLT 中做同样的事情。进行一个身份转换（一个样式表，它准确地输出输入的内容）并向其添加具有更具体匹配表达式的模板，以进行自定义修改。对于大多数应用程序，我发现 XSLT 比 SAX 或 DOM 更易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T09:11:44.017

当您想要修改 xml 文件并在更改后将其保存回其他文件时，我相信 SAX 不是正确的方法。我的建议是使用 DOM。它将加载整个文件（包括外部所做的修改），因此您只需考虑您想要做什么。之后保存时，一切都会恢复原状。

# c# - 竖起大拇指/竖起大拇指评级实施

> ID：250849
> 
> 赞同：2
> 
> 时间：2008-10-30T16:35:40.563
> 
> 标签：c#, asp.net

与 StackOverFlow 上的类似，我需要实现一种方法，让人们在类似网站的论坛中投票赞成和反对评论。

然而，我们将显示“赞许”和“赞许”的总分，而不是一般的总分。总分将用于过滤目的，例如“按最高评分排序”、“仅显示 + 3 的评分”

最好的实施策略是什么？

正如用户建议的那样，我还将存储投票的信息

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T16:40:18.307

好吧，您需要存储评分（评论 ID、用户 ID、投票值），以便计算和停止重复投票，但我强烈建议您在主要评论实体上添加 VotesUp 和 VotesDown 字段。

为什么要重复？速度。否则，您将执行大量令人作呕的`SUM-WHERE`语句，它们会将您的数据库服务器运行到地下。标题记录上的一些额外字节，您将能够对您的内容进行排序和过滤。

编辑：如果您还打算在某些情况下按总分排序，您可能需要添加第三个字段（VoteTotal）。

编辑 2：如果您能够将所有评论标头缓存在内存中，那么重复是没有意义的。这是很多数据，你需要大量的内存来有效地缓存它。如果你不是亿万富翁，我只会复制数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:50:04.887

[dotnetkicks](http://www.dotnetkicks.com/)对某些人来说是一个很好的开源参考，但不是你所要求的全部

还可以收听这个[StackOverFlow 播客](http://www.hanselman.com/blog/HanselminutesPodcast134StackOverflowUsesASPNETMVCJeffAtwoodAndHisTechnicalTeam.aspx)，该网站的创建者在其中讨论了他们如何解决他们的一些要求。如果您计划上述内容，则需要聆听。

然后，一旦您到达那里，与 uservoice 之类的服务链接会在您开发的早期为您提供一些有价值的反馈。

# c# - 处理不良 xml 数据的正确方法

> ID：250850
> 
> 赞同：2
> 
> 时间：2008-10-30T16:36:24.010
> 
> 标签：c#, xml, xsd, xmlreader, xmlschemaset

我有一个小的 c# windows 服务，它定期从 web 服务中提取 xml 并将数据存储在数据库表中。

不幸的是，它失败了，因为 Web 服务中偶尔会有错误的数据——字符串而不是小数。我对 Web 服务没有任何控制权（来自我们无法更改的软件的未经验证的用户输入），但我想记录错误数据以便重新输入。

这是看起来像这样的简单数据：

```
<ROWS>
  <ROW>
    <COL1>5405</COL1>
    <COL2>102.24</COL1>
  </ROW>
  <ROW>
    <COL1>5406</COL1>
    <COL2>2.25</COL1>
  </ROW>
</ROWS> 
```

该表只有两列，COL1 (NUMBER, 10)、COL2 (NUMBER, 10,2)。

我正在使用验证 XmlReader 和这个 XSD：

```
 <?xml version="1.0" encoding="utf-8"?>
    <xs:schema id="ROWS" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
      <xs:element name="ROWS" msdata:IsDataSet="true" msdata:Locale="en-US">
        <xs:complexType>
          <xs:choice minOccurs="0" maxOccurs="unbounded">
            <xs:element name="ROW">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="COL1" type="xs:decimal" minOccurs="0" />
                  <xs:element name="COL2" type="xs:decimal" minOccurs="0" />
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:choice>
        </xs:complexType>
      </xs:element>
    </xs:schema> 
```

然后是 dataset.ReadXml() 和 Update() 数据集。

每当遇到错误数据时，我都会收到以下异常：

> System.Xml.Schema.XmlSchemaValidationException 未处理
> 
> Message="'COL1' 元素无效 - 根据其数据类型，值 'A40' 无效' [http://www.w3.org/2001/XMLSchema:decimal](http://www.w3.org/2001/XMLSchema:decimal) ' - 字符串 'A40' 不是有效的十进制价值。”

我可以想出几种解决问题的方法，但它们都感觉有点笨拙，我想学习一些更优雅的东西，并提高我的知识。到目前为止，这是我想出的：

*   在加载到验证 XML 阅读器之前预处理 Web 服务提供的 XML，完全删除任何坏节点。
*   捕获 XmlSchemaValidationExceptions 并尝试从它们优雅地继续（不确定那个）
*   不要使用验证 XML 阅读器，而是在将未经验证的 xml 加载到数据集时捕获异常。（再次不确定）
*   在数据集中有字符串列，并忽略错误数据，直到我更新它，并捕获数据库拒绝的任何内容。
*   去用大槌站在用户面前，直到他们学会第一次做对（太耗时）
*   别的东西？

**更新：**数据可能很糟糕，因为它来自不验证 COL1 的用户输入的应用程序 - 但 COL2 中的数字计算正确，并且 COL1 应该对应于不同的系统。应记录任何无效条目，以便更正。数据写入数据库后，另一个系统会验证 COL1 是否有效，如果它在另一个系统中没有正确显示，用户很快就会发现 - 他们过去常常手动加载它:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T16:39:51.617

> 在加载到验证 XML 阅读器之前预处理 Web 服务提供的 XML，完全删除任何坏节点。

这是我会选择的选项，它允许您在异常之前获取错误输入并将其存储在某个地方以便以后查看。然后你可以找到有问题的用户并使用你的另一种方法

> 去用大槌站在用户面前，直到他们学会第一次做对

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:45:07.470

我的问题是：你想用错误的数据做什么？您是想忽略它，对其进行消毒（从“A40”中删除“A”），还是将其收集到最终向用户展示（说到大槌；-）？

如果您只想删除任何包含错误数据的行，请在执行其他任何操作之前先删除有错误的行。您必须自己决定是否仍需要在将剩余的 xml 输入数据库之前对其进行验证。如果您以限制性方式进行剥离，则不再需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T16:46:18.390

如果只是偶尔，我可能会缓存最后一个已知的好结果并完全忽略任何不好的提要。（可能会记录警告。）我会尽量避免尝试纠正错误的提要。如果它甚至对架构无效，谁说实际数据是正确的。

此外，您绝对应该向提要提供商提出问题，以尝试让他们纠正问题。

# php - PHP 负载测试框架

> ID：250866
> 
> 赞同：1
> 
> 时间：2008-10-30T16:41:42.173
> 
> 标签：php, testing, open-source, load

任何人都知道类似于 Grinder 的开源 PHP 负载测试框架“ [http://grinder.sourceforge.net/](http://grinder.sourceforge.net/) ”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:45:48.017

我没用过磨床，但听起来和[JMeter](http://jakarta.apache.org/jmeter/)很像。有时我也会使用普通的旧[Selenium](http://selenium-rc.openqa.org/)进行负载测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T00:01:50.780

RedLine 现在在 Amazon AWS 上有一个PHP 中的[云负载测试](http://www.redline13.com)工具。该服务是免费的，但您必须为您账户上的 Spot 实例付费（例如，在 200 m1.small 上进行 50,000 名用户测试大约为 2 美元/小时）。

# .net - LINQ 中“最受欢迎”的 GROUP BY？

> ID：250867
> 
> 赞同：30
> 
> 时间：2008-10-30T16:41:43.373
> 
> 标签：.net, linq, group-by, ranking

假设有一个标签表，如 stackoverflow 问题标签：

> TagID (bigint), QuestionID (bigint), Tag (varchar)

使用 LINQ 获取 25 个最常用标签的最有效方法是什么？在 SQL 中，一个简单的 GROUP BY 就可以：

```
SELECT Tag, COUNT(Tag) FROM Tags GROUP BY Tag 
```

我写了一些有效的 LINQ：

```
var groups = from t in DataContext.Tags
             group t by t.Tag into g
             select new { Tag = g.Key, Frequency = g.Count() };
return groups.OrderByDescending(g => g.Frequency).Take(25); 
```

像，真的吗？这不是超级冗长吗？可悲的是，我这样做是为了保存大量查询，因为我的 Tag 对象已经包含一个 Frequency 属性，否则如果我实际使用该属性，则需要用数据库检查每个 Tag。

所以我然后将这些匿名类型解析*回*Tag 对象：

```
groups.OrderByDescending(g => g.Frequency).Take(25).ToList().ForEach(t => tags.Add(new Tag()
{
    Tag = t.Tag,
    Frequency = t.Frequency
})); 
```

我是 LINQ 新手，这似乎不对。请告诉我它是如何真正完成的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-30T16:53:14.193

如果你想要 Tag 对象，为什么不直接从你的 Linq 查询中创建它们呢？

```
var groups = from t in DataContext.Tags
             group t by t.Tag into g
             select new Tag() { Tag = g.Key, Frequency = g.Count() };

return groups.OrderByDescending(g => g.Frequency).Take(25); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-30T18:21:55.717

如果您使用语法的详细形式，您的代码将是冗长的。这是一个替代方案：

```
List<Tag> result = 
  db.Tags
  .GroupBy(t => t.Tag)
  .Select(g => new {Tag = g.Key, Frequency = g.Count()})
  .OrderByDescending(t => t.Frequency)
  .Take(25)
  .ToList()
  .Select(t => new Tag(){Tag = t.Tag, Frequency = t.Frequency})
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-30T16:51:57.660

我很确定你做对了。而且，LINQ 生成并将发送到您的数据库的 SQL 看起来就像您开始使用的 SQL，所以当您进行更多的输入时，您的数据库并没有做更多的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-20T20:18:32.257

我认为您的 SQL 查询与您的 LINQ 查询做的事情不同，这也是不公平的——它没有返回前 25 个。

# theory - 写代码可以写代码吗？

> ID：250868
> 
> 赞同：9
> 
> 时间：2008-10-30T16:42:24.793
> 
> 标签：theory

我听说有些事情作为计算机程序员是不能做的，但我不知道它们是什么。我最近想到的一件事是：有一个类可以复制它运行的程序的源代码，修改该程序并向它所在的类添加一个方法，然后运行，这不是很好吗？程序的副本并自行终止。代码可以写代码吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-30T16:48:23.220

如果您想了解可计算性的限制，请阅读[停止问题](http://en.wikipedia.org/wiki/Halting_problem)

> 在可计算性理论中，停机问题是一个决策问题，可以表述如下：给定程序的描述和有限的输入，在给定输入的情况下，决定程序是完成运行还是永远运行。
> 
> 艾伦·图灵在 1936 年证明，不可能存在解决所有可能的程序输入对的停止问题的通用算法

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-30T16:48:46.183

首先查看[quines](http://en.wikipedia.org/wiki/Quines)，然后查看 Macro-Assemblers ，然后查看[lex & yacc](http://www.google.com/search?q=lex+yacc)和[flex & bison](http://www.google.com/search?q=flex+bison)。然后考虑[自修改代码](http://en.wikipedia.org/wiki/Self-modifying_code)。

这是一个quine（格式化，使用输出作为新输入）：

```
#include<stdio.h>

main()
{
  char *a = "main(){char *a = %c%s%c; int b = '%c'; printf(a,b,a,b,b);}";
  int b = '"';
  printf(a,b,a,b,b);
} 
```

现在，如果您只是在寻找程序员无法做到的事情，请寻找与 np-complete 相反的东西。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-30T16:43:37.333

是的。这就是许多病毒的工作原理！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-30T16:48:35.827

了解一下：[可计算性理论](http://en.wikipedia.org/wiki/Computability_theory_(computer_science))。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-30T17:48:13.910

是的，这就是大多数 Lisp 宏所做的（仅举一个例子）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-30T16:45:16.457

是的，当然是，尽管可能不在您所指的上下文中，请查看 t4 上的这篇[文章](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-30T16:51:19.003

如果你看看函数式编程有很多机会编写生成更多代码的代码，那么像 Lisp 这样的语言不区分代码和数据的方式是它强大的重要组成部分。

在创建新应用程序时，Rails 从数据库模式生成各种默认模型和控制器类。用动态语言做这种事情是很标准的——我有一些 PHP 可以生成 php 文件，只是因为它是我当时处理的问题的最简单的解决方案。

所以这是可能的。至于你问的问题——这可能有点模糊——你使用的是什么环境和语言？您希望代码做什么以及为什么需要添加它？一个具体的例子可能会带来更直接相关的回应。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-30T16:44:25.570

是的，可以创建代码生成器。大多数时候，他们接受用户输入并生成有效代码。但还有其他可能性。

自修改程序也是可能的。但它们在dos时代更为常见。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-30T16:46:02.150

当然可以！事实上，如果您使用动态语言，则该类可以在程序仍在运行时更改自身（或另一个类）。它甚至可以创建以前不存在的新类。这称为元编程，它使您的代码变得非常灵活。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-30T16:49:19.070

您混淆/混淆了“写”一词的两种含义。一个含义是将字节物理写入介质，另一个含义是设计软件。当然，您可以让程序执行前者，如果它被设计为这样做的话。

程序做程序员没有明确打算做的事情的唯一方法是表现得像一个生物：变异（在自身中融入一些环境），并以不同的速率复制不同的突变体（以避免完全灭绝，如果突变是终端的）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-30T16:51:25.710

是的。我为 Paint.NET* 编写了一个效果，它为您提供了一个编辑器并允许您“即时”编写图形效果。当您暂停输入时，它会将其编译为 dll，加载并执行它。现在，在编辑器中，您只需要编写实际的渲染函数，**创建 dll 所需的所有其他内容都由编辑器编写**并发送到 C# 编译器。

你可以在这里免费下载：http: [//www.boltbait.com/pdn/codelab/](http://www.boltbait.com/pdn/codelab/)

事实上，甚至还有一个选项可以在将其发送到编译器之前查看为您编写的所有代码。帮助文件（上面链接）讨论了所有内容。

源代码也可以从该页面下载。

*Paint.NET 是一个免费的图像编辑器，您可以在这里下载：http: [//getpaint.net](http://getpaint.net)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-30T17:09:32.820

关于人工智能，请看[进化算法](http://en.wikipedia.org/wiki/Evolutionary_algorithms)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-30T17:33:23.427

> 复制它运行的程序的源代码，修改该程序并向它所在的类添加一个方法，然后运行该程序的副本并自行终止

您还可以生成代码，将其构建为库而不是可执行文件，然后动态加载库，甚至无需退出当前正在运行的程序。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-30T17:44:52.310

动态语言通常不像您建议的那样工作，因为它们没有完全独立的编译步骤。程序不需要修改自己的源代码、重新编译和从头开始。通常，新功能是动态编译和链接的。

Common Lisp 是一种很好的练习语言，但还有其他语言可以在其中创建代码并在其中运行它。通常，这将通过一个名为“eval”或类似的函数来实现。Perl 有一个“eval”函数，脚本语言通常都有这个能力。

有很多程序可以编写其他程序，例如 yacc 或 bison，但它们并没有您所寻找的动态质量。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-11-04T22:51:16.757

看看[Langtom 的循环](http://www.alesdar.org/oldSite/IS/Langton/LangtonLoops.html)。这是自我复制“程序”的最简单示例。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-30T16:44:26.677

有一整类这样的东西称为“代码生成器”。（尽管，编译器也符合您设置的描述）。这些描述了这些野兽的两个领域。

大多数代码生成，采用某种形式的用户输入（大多数采用数据库模式）和然后编译的产品源代码。

更高级的可以输出可执行代码。对于 .NET，有一个专门用于创建可执行代码的完整命名空间 (System.CodeDom)。这些对象，您可以获取 C#（或其他语言）代码，对其进行编译，并将其链接到您当前正在运行的程序中。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-30T16:48:50.147

我在 PHP 中执行此操作。

为了保留类的设置，我保留了一个名为`$data`. $data 只是一个字典/哈希表/关联数组（取决于你来自哪里）。

当您加载该类时，它包含一个基本定义数据的 php 文件。当我保存类时，它会为每个数据值写出 PHP。这是一个缓慢的写入过程（并且目前存在一些并发问题），但它比光读取要快。比使用数据库快得多（也更轻）。

像这样的东西不适用于所有语言。它在 PHP 中对我有用，因为 PHP 非常动态。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-30T17:28:38.693

编写代码生成器一直是可能的。借助 XML 技术，代码生成器的使用可以成为必不可少的工具。假设您为一家必须处理来自其他公司的 XML 文件的公司工作。编写一个使用 XML 解析器解析新 XML 文件的程序并编写另一个程序，该程序设置了所有回调函数来读取该格式的 XML 文件，这是相对简单的。您仍然需要编辑新程序以使其特定于您的需要，但是使用这种类型的代码生成器可以大大减少新 XML 文件（新结构、新名称）的开发时间。在我看来，这是 XML 技术优势的一部分。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-04T22:08:28.903

lisp lisp lisp lisp :p

开玩笑，如果你想让生成代码的代码运行并且你有时间放松学习它并用递归的东西生成更多代码来打破你的想法，试着学习 lisp :)

```
(eval '(or true false)) 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-11-04T23:17:10.293

> 如果有一个类可以复制它运行的程序的源代码，修改该程序并向它所在的类添加一个方法，然后运行程序的副本并自行终止，这不是很好吗

几乎没有任何情况可以解决无法使用非自修改代码“更好”解决的问题。

也就是说，有一些非常常见（有用）的代码编写其他代码的案例。最明显的是任何服务器端 Web 应用程序，它生成 HTML/Javascript（嗯，HTML 是标记，但理论上是相同的）。此外，任何改变终端环境的脚本通常都会输出一个由父 shell 评估的 shell 脚本。wxGlade 生成代码以创建基于 wx 的 GUI。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-08-12T02:57:20.173

请参阅我们的[DMS 软件再造工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)。这是读取和修改程序或通过组装片段生成程序的通用机器。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-30T16:55:48.760

这是人工智能的基本问题之一。我个人希望这是不可能的——否则我很快就会失业！！！:)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-12-24T16:40:06.557

它被称为[元编程](http://en.wikipedia.org/wiki/Meta-programming)，既是编写有用程序的好方法，也是一个有趣的研究课题。雅克·皮特拉 (Jacques Pitrat) 的[人造生物：一本有意识的机器](http://onlinelibrary.wiley.com/book/10.1002/9780470611791)书的良心应该会让你很感兴趣。它主要与基于元知识的计算机程序有关。

另一个相关的术语是[多阶段编程](http://www.cs.rice.edu/~taha/MSP/)（因为有几个阶段的程序，每个阶段都会产生下一个）。

# vb.net - VB.NET 中的迭代器模式（C# 将使用 yield！）

> ID：250874
> 
> 赞同：13
> 
> 时间：2008-10-30T16:43:53.400
> 
> 标签：vb.net, design-patterns, iterator, yield

如何在没有关键字的[VB.NET中实现迭代器模式？](http://en.wikipedia.org/wiki/Visual_Basic_.NET)`yield`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-04-19T07:15:02.237

现在 VS 2010 SP1 支持 Async CTP，请参阅[MSDN 上的 Iterators (C# and Visual Basic)](http://msdn.microsoft.com/en-us/vstudio/gg497937)并[下载 Visual Studio Async CTP (Version 3)](http://www.microsoft.com/en-us/download/details.aspx?id=9983)。

像这样的代码，作品：

```
Private Iterator Function SomeNumbers() As IEnumerable
    ' Use multiple yield statements.
    Yield 3
    Yield 5
    Yield 8
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T16:55:05.140

VB.NET 不支持创建自定义迭代器，因此没有等效于 C# 的 yield 关键字。但是，您可能需要查看知识库文章*[如何使 Visual Basic .NET 或 Visual Basic 2005 类在 For Each 语句中可用以](http://support.microsoft.com/kb/322025)*获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T16:49:26.900

嗯，看起来你可能[不走运](http://weblogs.asp.net/jgaylord/archive/2007/10/17/vb-net-s-quot-yield-return-quot.aspx)：

> 我今天在将一些 C# 转换为 VB.NET 时遇到了一个问题。C# 有一个非常酷的“yield return”语句，它在迭代器块中用于为枚举器对象提供值。VB.NET 没有“yield”关键字。因此，有一些解决方案（没有一个是真正干净的）来解决这个问题。如果您正在循环并希望打破枚举器并返回单个值，则可以使用 return 语句来返回值。但是，如果您想返回整个枚举，请创建子类型的 List() 并返回列表。由于您通常将它与 IEnumerable 一起使用，因此 List() 会很好用。

那是一年前写的，不知道从那以后是否有人想出了更好的东西。

* * *

编辑：这将在 VB.NET 版本 11（VS2010 之后的版本）中实现，计划支持迭代器。该规范[可在此处获得](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=7DE30BAF-B897-453E-AD18-E1EE2226EA86)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T17:31:44.897

C# 的 yield 关键字强制编译器在后台创建状态机来支持它。VB.Net 没有 yield 关键字。但它确实有一个结构可以让您在函数中创建状态机： [静态函数成员](http://msdn.microsoft.com/en-us/library/z2cty7t8.aspx)。

应该可以通过创建一个实现 IEnumerable 的通用类以及所需的状态机并将一个实例作为静态成员放置在您的函数中来模拟 yield return 函数的效果。

当然，这需要在函数之外实现类。但是如果做得好，这个类在一般情况下应该是可重用的。不过，我还没有充分考虑这个想法来提供任何实现细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-07T18:35:48.180

请记住，LINQ 表达式和方法的延迟执行和惰性求值属性使我们能够有效地实现自定义迭代器，直到 yield 语句在 .NET 4.5 中可用。Yield 由 LINQ 表达式和方法在内部使用。

下面的代码演示了这一点。

```
 Private Sub AddOrRemoveUsersFromRoles(procName As String,
                                      applicationId As Integer,
                                      userNames As String(),
                                      rolenames As String())
    Dim sqldb As SqlDatabase = CType(db, SqlDatabase)
    Dim command As DbCommand = sqldb.GetStoredProcCommand(procName)
    Dim record As New SqlDataRecord({New SqlMetaData("value", SqlDbType.VarChar,200)})
    Dim setRecord As Func(Of String, SqlDataRecord) =
        Function(value As String)
            record.SetString(0, value)
            Return record
        End Function
    Dim userNameRecords As IEnumerable(Of SqlDataRecord) = userNames.Select(setRecord)
    Dim roleNameRecords As IEnumerable(Of SqlDataRecord) = rolenames.Select(setRecord)
    With sqldb
        .AddInParameter(command, "userNames", SqlDbType.Structured, userNameRecords)
        .AddInParameter(command, "roleNames", SqlDbType.Structured, roleNameRecords)
        .AddInParameter(command, "applicationId", DbType.Int32, applicationId)
        .AddInParameter(command, "currentUserName", DbType.String, GetUpdatingUserName)
        .ExecuteNonQuery(command)
    End With
End Sub 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2011-05-02T11:09:57.907

下面给出输出：2、4、8、16、32

在 VB.NET 中

```
Public Shared Function setofNumbers() As Integer()

    Dim counter As Integer = 0
    Dim results As New List(Of Integer)
    Dim result As Integer = 1
    While counter < 5
        result = result * 2
        results.Add(result)
        counter += 1
    End While
    Return results.ToArray()
End Function

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    For Each i As Integer In setofNumbers()
        MessageBox.Show(i)
    Next
End Sub 
```

在 C# 中

```
private void Form1_Load(object sender, EventArgs e)
{
    foreach (int i in setofNumbers())
    {
        MessageBox.Show(i.ToString());
    }
}

public static IEnumerable<int> setofNumbers()
{
    int counter=0;
    //List<int> results = new List<int>();
    int result=1;
    while (counter < 5)
    {
      result = result * 2;
      counter += 1;
      yield return result;
    }
} 
```

# qt - 将 QSortFilterProxyModel 与树模型一起使用

> ID：250890
> 
> 赞同：9
> 
> 时间：2008-10-30T16:48:24.360
> 
> 标签：qt, model-view-controller, qsortfilterproxymodel

我有一个`QDirModel`其当前目录已设置。然后我有一个`QListView`应该显示该目录中的文件。这工作正常。

现在我想限制显示的文件，所以它只显示*png*文件（文件名以 .png 结尾）。问题是使用 a`QSortFilterProxyModel`并设置过滤器正则表达式也会尝试匹配文件的每个父级。根据文档：

> 对于分层模型，过滤器递归地应用于所有子级。如果父项与过滤器不匹配，则不会显示其子项。

那么，我如何`QSortFilterProxyModel`才能只过滤目录中的文件，而不是它所在的目录？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T09:45:04.107

对于像我这样对以下行为感兴趣的人：如果一个孩子匹配过滤器，那么它的祖先不应该被隐藏：

```
bool MySortFilterProxyModel::filterAcceptsRow(int source_row, const QModelIndex & source_parent) const
{
    // custom behaviour :
    if(filterRegExp().isEmpty()==false)
    {
        // get source-model index for current row
        QModelIndex source_index = sourceModel()->index(source_row, this->filterKeyColumn(), source_parent) ;
        if(source_index.isValid())
        {
            // if any of children matches the filter, then current index matches the filter as well
            int i, nb = sourceModel()->rowCount(source_index) ;
            for(i=0; i<nb; ++i)
            {
                if(filterAcceptsRow(i, source_index))
                {
                    return true ;
                }
            }
            // check current index itself :
            QString key = sourceModel()->data(source_index, filterRole()).toString();
            return key.contains(filterRegExp()) ;
        }
    }
    // parent call for initial behaviour
    return QSortFilterProxyModel::filterAcceptsRow(source_row, source_parent) ;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T15:41:08.250

我们在我工作的地方遇到了类似的事情，最终制作了我们自己的代理模型来进行过滤。但是，通过查看您想要的文档（这似乎是一种更常见的情况），我遇到了两种可能性。

1.  您也许可以在 QDirModel 上设置名称过滤器并以这种方式过滤事物。我不知道这是否会像你想要的那样工作，或者名称过滤器是否也适用于目录。这些文档有点稀疏。
2.  子类化 QSortFilterProxyModel 并覆盖该`filterAcceptsRow`函数。从文档中：

> 自定义过滤行为可以通过重新实现 filterAcceptsRow() 和 filterAcceptsColumn() 函数来实现。

然后您大概可以使用模型索引来检查索引项是目录（自动接受）还是文件（过滤文件名）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-03-07T18:41:45.573

从 Qt 5.10 开始，`QSortFilterProxyModel`可以选择递归过滤。换句话说，如果一个孩子匹配过滤器，它的父母也将是可见的。

查看[QSortFilterProxyModel::recursiveFilteringEnabled](https://doc.qt.io/qt-5/qsortfilterproxymodel.html#recursiveFilteringEnabled-prop)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-05T12:56:33.317

导出 qsortfilterproxymodel 然后...

```
bool YourQSortFilterProxyModel::filterAcceptsRow ( int source_row, const QModelIndex & source_parent ) const
{
    if (source_parent == qobject_cast<QStandardItemModel*>(sourceModel())->invisibleRootItem()->index())
    {
        // always accept children of rootitem, since we want to filter their children 
        return true;
    }

    return QSortFilterProxyModel::filterAcceptsRow(source_row, source_parent);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-09-02T19:11:50.370

只需使用[KItemModels](http://api.kde.org/frameworks-api/frameworks5-apidocs/kitemmodels/html/index.html) KDE API中的[KRecursiveFilterProxyModel](http://api.kde.org/frameworks-api/frameworks5-apidocs/kitemmodels/html/classKRecursiveFilterProxyModel.html)模型

# eclipse - 重新定位整个（版本化）Eclipse 工作区的最佳方法是什么？

> ID：250901
> 
> 赞同：0
> 
> 时间：2008-10-30T16:50:55.133
> 
> 标签：eclipse, svn

我想知道你们重新定位整个 Eclipse 工作区的最佳方法是什么？假设它是版本化和导出的，你会怎么做？导入文件？从回购中检查整个事情？提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-01T06:09:05.923

当您要求“最佳方式”并且已经提到“版本化”时，我假设您有一些版本控制（而不是涉及日食“本地历史”。基本上，即使在单独工作时，拥有版本控制也是“最佳实践” . 使用这个，你就完成了。

这使您不仅可以迁移到新机器（正如您在对 matt b 问题的评论中提到的那样），而且可以同时在旧机器和新机器上进行操作，如果您发现您依赖某些仅在旧环境。这也将帮助您清除硬编码库路径的工作区和存储库，而不是依赖逻辑库名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T16:52:44.460

也许我遗漏了一些东西，但是您不只是启动 Eclipse，然后选择要使用的新工作区或`Switch workspace`从`File`菜单中选择吗？

# java - Java 应用程序在特殊字符上失败

> ID：250911
> 
> 赞同：0
> 
> 时间：2008-10-30T16:53:44.753
> 
> 标签：java, character-encoding, solaris, locale, special-characters

我正在处理的应用程序从文件中读取信息以填充数据库。文件中的某些字符是非英语字符，例如带重音的法语字符。

该应用程序在 Windows 中运行良好，但在我们的 Solaris 机器上它无法识别特殊字符并引发异常。例如，当它在“Gérer”中遇到重音 e 时，它​​会说：-

```
      遇到：“\u0161”（353），之后：“\'G\u00c3\u00a9rer les mod\u00c3”
```

（从我们的应用程序抛出的异常）

我怀疑为了阻止这种情况发生，我需要更改 JVM 的 file.encoding 属性。我试图通过 System.setProperty() 来做到这一点，但它并没有阻止错误的发生。

对我能做什么有什么建议吗？我正在考虑将 /etc/default/init 中的 solaris 平台的基本语言环境设置为 UTF-8。有人认为这可能会有所帮助吗？

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T18:45:45.683

`native2ascii`这看起来像是使用错误参数转换的文件。为了演示，创建一个包含内容的文件

```
Gérer les modÚ 
```

并将其保存为“a.txt”，编码为 UTF-8。然后运行这个命令：

```
native2ascii -encoding windows-1252 a.txt b.txt 
```

打开新文件，您应该会看到：

```
G\u00c3\u00a9rer les mod\u00c3\u0161 
```

现在反转该过程，但这次指定 ISO-8859-1：

```
native2ascii -reverse -encoding ISO-8859-1 b.txt c.txt 
```

以 UTF-8 格式读取新文件，您应该会看到：

```
Gérer les modÀ\u0161 
```

它可以恢复“é”，但会像您的应用程序一样在“Ú”上窒息。

我不知道您的应用程序出了什么问题，但我很确定对 native2ascii 的错误使用是其中的一部分。这可能是让应用程序使用系统默认编码的结果。当您保存文本时，您应该始终指定编码，无论是文件还是数据库或其他 - 永远不要让它默认。如果您没有充分的理由选择其他内容，请使用 UTF-8。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T17:03:30.053

尝试使用

```
java -Dfile.encoding=UTF-8 ... 
```

在两个系统中启动应用程序时。

解决问题的另一种方法是将编码从两个系统更改为 UTF-8，但我更喜欢第一个选项（对系统的干扰较小）。

编辑：

在stackoverflow上检查这个答案，它可能会有所帮助：

[更改 String(byte[]) 的默认编码](https://stackoverflow.com/questions/81323/changing-the-default-encoding-for-stringbyte)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T23:34:04.197

在读取和写入特定文本数据时指定字符编码，而不是设置系统范围的字符编码，可能更容易、更健壮。您的应用程序如何读取文件？所有 Java I/O 包读取器和写入器都支持传入一个字符编码名称，以便在从字节读取/写入文本时使用。如果您没有指定一个，它将使用平台默认编码，就像您可能遇到的那样。

一些数据库在它们可以接受的文本编码方面令人惊讶地受到限制。如果您的 Java 应用程序以适当的编码将文件作为文本读取，那么它可以根据需要将其输出到数据库。如果您的数据库不支持其字符集包含您拥有的非 ASCII 字符的任何编码，那么您可能需要先将非英文文本编码为 UTF-8 字节，然后 Base64 将这些字节编码为 ASCII 文本.

PS：`String.getBytes()`由于您所看到的原因，切勿使用没有字符编码参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T11:58:23.503

我设法通过运行命令克服了这个错误

```
导出 LC_ALL='en_GB.UTF-8'
```

此命令设置我所在的 shell 的语言环境。这将所有 LC_ 环境变量设置为 Unicode 文件编码。

非常感谢您的所有建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T01:22:35.023

此外，您可能需要验证是否安装了支持 UTF-8（SUNWeulux、SUNWeuluf 等）的操作系统包。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-24T06:16:13.183

Java 在读写文件时使用操作系统的默认编码。现在，一个人永远不应该依赖它。明确指定编码始终是一个好习惯。

在 Java 中，您可以使用以下内容进行读写：

阅读：

```
BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(inputPath),"UTF-8")); 
```

写作：

```
PrintWriter pw = new PrintWriter(new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outputPath), "UTF-8"))); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T17:03:45.747

你也可以在命令行设置编码，像这样`java -Dfile.encoding=utf-8`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T00:52:23.227

我认为我们需要更多信息才能帮助您解决问题：

1.  你到底得到了什么异常，当它发生时你调用了哪个方法。
2.  输入文件的编码是什么？UTF8？UTF16/Unicode？ISO8859-1？

如果您能向我们提供相关的代码片段，也会很有帮助。

另外，我想指出几点：

1.  问题不在“é”处发生，而是在稍后发生。
2.  听起来字符编码可能在您的应用程序中的某个地方进行了硬编码。

# html - 在 Perl 中从富文本编辑器解析 HTML 的最佳方法是什么？

> ID：250914
> 
> 赞同：2
> 
> 时间：2008-10-30T16:54:03.850
> 
> 标签：html, perl, module, tidy, rich-text-editor

是否有一个 Perl 模块可以获取**错误的 HTML**（例如从 Microsoft Word 复制的内容）并将其解析为**格式良好的 HTML**？我看过**HTML::Tidy**，但它在 CPAN 上得到了[可怕的评论](http://cpanratings.perl.org/dist/HTML-Tidy)。我们有一个自定义的遗留模块，它基本上是命令行版本 tidy 的包装器（这似乎与 HTML::Tidy 差不多），但它会将文件写入磁盘并将它们读回，这可能是一个很大的性能惩罚。当然，凭借 Perl 令人敬畏的文本解析能力，还有更好的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T18:22:20.113

两件事情：

1) 确实没有[tidy](http://tidy.sourceforge.net/)的替代品，因为它对大多数人都有效。命令行工具的某些行为是否不适合您？也许如果你举一个例子说明为什么它不适合鼻烟，我们可以更好地理解这个问题。

2）关于性能，您可以考虑修改包装器以调用`open2`tidy 以避免磁盘往返：

```
use IPC::Open2;

my $pid = open2(\*FROM_TIDY, \*TO_TIDY, '/usr/bin/tidy')
    or die "couldn't open";

# give tidy our html and close the handle to tell it we're done
print(TO_TIDY $html_string);
close(TO_TIDY);

# read in the tidy html
while (<FROM_TIDY>) {
    print;
}
close(FROM_TIDY); 
```

# html - HTML 表格列的高度；适用于 Firefox 而不是 IE

> ID：250931
> 
> 赞同：0
> 
> 时间：2008-10-30T16:59:53.183
> 
> 标签：html, firefox, internet-explorer-7

我有一些 HTML 可以在 FireFox3/Opera/Safari 上正常显示，但不能在 IE7 上显示。片段如下：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
    <body bgcolor="#AA5566" >
    <table width="100%">

      <tr>

        <td height="37" valign="top"><img style="float:right;" border="0" src="foo.png" width="37" height="37"/></td>

        <td width="600" rowspan="2" >
          <table width="600" height="800"><tr><td><img src="bar.jpg" width="600" height="800"/></td></tr></table>
        </td>

        <td height="37" valign="top"><img style="float:left;" border="0" src="foo.png" width="37" height="37"/></td>

      </tr>

      <!-- This row doesnt fill the vertical space on IE7 //-->
      <tr>
        <td valign="top" bgcolor="#112233">&nbsp;</td>
        <td valign="top" bgcolor="#112233">&nbsp;</td>
      </tr>

    </table>
    </body> 
```

第二行不会正确填充由第一行中间列创建的垂直空间（注意 rowspan="2"）。相反，即使我将它们的高度设置为 37，第一行和第三列也会向下扩展。下图显示了 IE7 和 Firefox3 中发生的情况......

![替代文字](https://i.stack.imgur.com/DpxMK.png)

编辑：将 HTML 文档类型添加到代码片段中。添加了截图。

任何帮助表示赞赏，谢谢:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T18:47:35.070

正确的答案是：不要使用表格来布局您的页面。

技术上的答案是：你的表格单元正在做他们应该做的事情，即你不能用你使用的代码结构来解决你的问题。

骇人听闻的答案是：让左右单元格的高度正好为 37px，您必须在左右单元格中添加 2 个额外的嵌套表格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T18:55:25.493

如果你这样尝试怎么办：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
    <body bgcolor="#AA5566" >
    <table width="100%" border='1'>

      <tr>

        <td valign="top">
            <table bgcolor="#112233" height="37" width='100%'><tr><td>asdf</td></tr></table><br />
            Other content
        </td>

        <td width="600" rowspan="2" >
          <table width="600" height="800"><tr><td>asdf</td></tr></table>
        </td>

        <td valign="top">
            <table bgcolor="#112233" height="37" width='100%'><tr><td>asdf</td></tr></table><br />
            Other content
        </td>

      </tr>

    </table>
    </body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T17:29:09.627

我不太确定为什么会这样。你想实现什么布局，它真的需要是一张桌子吗？你不应该用表格布局页面，它们应该只用于真正的表格数据。

你考虑过使用 div 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T18:19:25.703

把它扔给一个[验证器](http://validator.w3.org/check)，我相信你会更接近一点。

实际上 - 你所看到的是 IE 的正常行为：将border="1" 添加到你的主表中，它会更清楚地告诉你发生了什么。

# javascript - 受密码保护的超链接，目标=_blank

> ID：250932
> 
> 赞同：-4
> 
> 时间：2008-10-30T17:00:00.810
> 
> 标签：javascript, html

我有一个像这样的超链接：

```
<A Href=My_Java_Servlet?User_Action=Admin_Download_Records&User_Id=Admin onClick=\"Check_Password();\" target=_blank>Download Records</A> 
```

当用户点击它时，会打开一个密码窗口，用户可以尝试 3 次正确的密码。

Javascript 看起来像这样：

```
<Script Language="JavaScript">
  function Check_Password()
  {
    var testV=1;
    var pass1=prompt('Password','');
    while (testV<3)
    {
      if (!pass1) history.go(-1);
      if (pass1=="password") { return true; }
      testV+=1;
      var pass1=prompt('Access Denied - Password Incorrect.','');
    }
    return "false";
  }
</Script> 
```

如果用户输入错误的密码 3 次，它应该什么都不做，但它仍然会打开一个新窗口并显示受保护的信息，如何修复 javascript 或我的 html 超链接，所以只有正确的密码才会打开一个新的目标窗口，错误的密码会使其无能为力吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-30T17:05:58.693

客户端 JavaScript 可能是提供“安全性”的最糟糕的方式。用户可以查看源代码以查看您的所有密码，或者完全禁用 JavaScript。**不要这样做。**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T17:10:55.687

其他人已经用真/假返回值回答了您的问题，但这里是在客户端上检查 javascript 密码的整个想法的一些问题：

1.  下载该页面的任何人都可以免费阅读您的 javascript 源代码 - 从而向他们显示查看该页面所需的密码。

2.  如果他们没有启用 javascript，那么他们将直接进入页面而不会收到 javascript 提示。

3.  他们总是可以复制链接并将其粘贴到地址栏中以绕过密码保护。他们也可以中键单击链接（根据浏览器的不同，该链接应该在新选项卡/窗口中打开。）

即使在私有/仅限 Intranet 的应用程序上，这也是一种可笑的安全方法。:) 请考虑重新设计它，以便在服务器端检查密码（例如，当有人尝试访问 servlet 时，它会呈现一个密码框，然后将该密码发送回服务器，然后允许/拒绝访问.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T17:03:28.417

您可能会尝试返回`false`而不是`"false"`

但是，您最好在服务器上做这种事情，因为除了新手用户之外的所有用户都知道如何“复制链接地址”并将其粘贴到他们的地址栏中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-30T17:02:58.323

你为什么返回**"false"**而不是**false**？

# c# - WPF ComboBox 项目选项卡行为

> ID：250935
> 
> 赞同：0
> 
> 时间：2008-10-30T17:01:39.263
> 
> 标签：c#, wpf, user-interface

我正在将一些 win 表单面板迁移到 WPF。

在 WinForms 中，您可以使用键盘 Tab 进入组合框，通过键入第一个字符来选择一个项目，然后再次按 Tab，组合失去焦点。

在 WPF 中，第二个选项卡会将焦点矩形向下移动到列表中，而不是移动到下一个控件上。

有没有办法得到旧的行为？或者有没有人实现了实现这种行为的 ItemTemplate？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-30T17:17:51.943

有一个具有 IsTabStop 属性的[ComboBoxItem 。](http://msdn.microsoft.com/en-us/library/system.windows.controls.comboboxitem.aspx)

所以我只是应用了适当的样式：

```
<Style TargetType="{x:Type ComboBoxItem}">
    <Setter Property="IsTabStop" Value="False"/>
</Style> 
```

# asp.net - 根据数据类型格式化 ASP.Net GridView 的列

> ID：250937
> 
> 赞同：1
> 
> 时间：2008-10-30T17:01:55.080
> 
> 标签：asp.net, datetime, gridview, asp.net-2.0

我有一个非常简单的 ASP.Net 页面，它充当存储过程的前端。它只是运行程序并使用 gridview 控件显示输出：总代码不到 40 行，包括 aspx 标记。存储过程本身非常...易变。它有多种用途，输出格式会定期更改。

整个事情都很好，因为 gridview 控件并不真正需要关心存储过程返回哪些列：它只是在页面上显示它们，这正是我想要的。

然而，这个运行的数据库在时间部分并不重要的地方都有许多日期时间列——它总是归零。我想要做的是控制gridview中日期时间列的格式，而不知道它们将是哪些列。每当结果中的列具有日期时间类型时，只需应用给定的格式字符串，该字符串将修剪时间组件。

我知道我可以在数据库中转换为 varchar，但我真的不想让开发人员关心查询中的格式，无论如何这属于表示级别。还有其他想法吗？

* * *

最后使用以下代码以可接受（或至少改进）的方式使其工作：

```
Protected Sub OnRowDatabound(ByVal sender As Object, ByVal e As GridViewRowEventArgs)
    If e.Row.RowType = DataControlRowType.DataRow Then
        Dim d As DateTime
        For Each cell As TableCell In e.Row.Cells
            If Date.TryParse(cell.Text, d) AndAlso d.TimeOfDay.Ticks = 0 Then
                cell.Text = d.ToShortDateString()
            End If
        Next cell
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T17:07:12.853

如果您正在自动生成听起来像您的列。使用网格格式的过程很糟糕。

您需要遍历网格的所有列，可能在数据绑定事件中，并将格式化表达式应用于您发现的任何列是日期列。

如果您不是自动生成并且您在网格中对列进行编码，您还将知道哪些列是日期列，并且您可以将相同的格式表达式应用于该列。它类似于 {0:ddMMyyyy} 但您必须查看它，因为这可能不太正确。

所以总结挂钩到数据绑定事件。遍历列集合并确定该列是否为日期列。我想知道你会如何做到这一点:)。如果您决定一列是日期列，请设置其格式表达式。

瞧

- - - - - - - - - - - 编辑

好的，您如何编写从proc返回数据以返回数据表的方法。格式化数据表中的数据后，您可以将数据表绑定到网格。datatable.Columns 集合是 DataColumns 的集合，它们具有 DataType 属性。您可能正在寻找 System.DateTime 或 DateTime，它可能是 DataType 属性本身的属性之一 :)。我知道这很麻烦，但是您要问的肯定会很麻烦。一旦您确定了日期列，您就可以使用它做一些事情。

如果没有，我会开始查看数据阅读器，看看是否有什么可以在那里或使用数据适配器做的事情。我希望我能给你一个正确的答案，但我认为无论你设法做到这一点，它都不会很漂亮。对不起

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T17:08:16.707

如果使用显式绑定列是一个选项，请将 DataFormatString 添加到您的 boundField

```
<asp:BoundField DataField="Whatever" ... DataFormatString="{0:dd/MM/yyyy}" HtmlEncode="False"/ > 
```

否则你可以看看格式化 GridView.OnRowDataBound 事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T17:07:00.750

您可以使用 isDate() 函数来查看某个日期是否有效，然后使用日期格式选项使其看起来像您想要的那样。

日期格式的一些示例：http: [//datawebcontrols.com/faqs/CustomizingAppearance/FormatDateTimeData.shtml](http://datawebcontrols.com/faqs/CustomizingAppearance/FormatDateTimeData.shtml)

# mysql - 重新安装 MYSQL(windows) - 如何使用新安装获取旧数据？

> ID：250939
> 
> 赞同：0
> 
> 时间：2008-10-30T17:01:59.823
> 
> 标签：mysql, windows

我需要重新安装我的电脑，但我没有考虑从 mysql 5 导出数据。

如何将旧安装中的数据获取到新安装中，这只是复制数据目录还是我必须采取其他步骤才能获取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T17:18:04.893

对于 MyISAM 表，您通常可以避免复制它们。（很明显，虽然服务器已停止。）对于 InnoDB，它可以工作，但您必须具有相同的基本块大小设置。如果您可以使用相同的 MySQL 主要版本和相同的 my.cnf，那么您很有可能让它工作。

之后最好确保重建表（例如使用 ALTER TABLE），并在下次正确记录 mysqldump，因为这些都不支持或保证工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T17:16:54.583

我会将您的数据从 mysql 导出为 sql 文件（即：使用 phpmyadmin），然后将其导入到新安装中。您的数据库应该很容易构建并填充数据。

您说您“没有考虑导出数据”。这是否意味着您无法再访问旧安装？

# sqlite - 如何在 sqlite 中找到二进制 blob 的长度（大小）

> ID：250940
> 
> 赞同：54
> 
> 时间：2008-10-30T17:02:53.487
> 
> 标签：sqlite, size, blob

我有一个包含 BLOB 文件的 sqlite 表，但需要对 blob 进行大小/长度检查，我该怎么做？

根据我确实找到的一些文档，使用 length(blob) 不起作用，因为 length() 仅适用于文本，并且在第一个 NULL 之后将停止计数。我的经验测试表明这是真的。

我正在使用 SQLite 3.4.2

* * *

更新：

因此，从 SQLite 3.7.6 开始，似乎 length() 函数返回了正确的 blob 值——我检查了 sqlite 的各种更改日志，但没有看到在哪个版本中得到了更正。

从 Sqlite 3.7.6 开始：

```
payload_id|length(payload)|length(hex(payload))/2
1807913|194|194
1807914|171|171

```

[文档](http://www.sqlite.org/lang_corefunc.html)已更改以反映这一点。

```
length(X) length(X) 函数返回 X 的字符长度，如果 X 是
            一个字符串，如果 X 是一个 blob，则以字节为单位。如果 X 为 NULL，则长度（X）为
            空值。如果 X 是数字，则 length(X) 返回字符串的长度
            X 的表示。

```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-30T17:57:09.010

没遇到过这个问题，你可以试试`length(hex(glob))/2`

**更新（2012 年 8 月）：** 对于 SQLite 3.7.6（2011 年 4 月 12 日发布）及更高版本，`length(blob_column)`文本和二进制数据均按预期工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-09-23T15:56:14.513

对我来说`length(blob)`工作得很好，给出了和另一个一样的结果。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-08T16:45:01.140

作为附加答案，一个常见问题是 sqlite 有效地忽略了表的列类型，因此如果将字符串存储在 blob 列中，它将成为*该行的字符串列*。由于长度在字符串上的工作方式不同，因此它将仅返回最后一个 0 八位字节之前的字符数。将字符串存储在 blob 列中很容易，因为您通常必须显式转换才能插入 blob：

```
insert into table values ('xxxx'); // string insert
insert into table values(cast('xxxx' as blob)); // blob insert 
```

要获得存储为字符串的值的正确长度，可以将长度参数强制转换为 blob：

```
select length(string-value-from-blob-column); // treast blob column as string
select length(cast(blob-column as blob)); // correctly returns blob length 
```

length(hex(blob-column))/2 起作用的原因是 hex 不会在内部 0 个八位字节处停止，并且生成的十六进制字符串不再包含 0 个八位字节，因此 length 返回正确的（完整）长度。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-09T19:18:45.937

执行此操作的查询示例，获取第 3 行中 column 、 table`select`中 blob 的长度：`myblob``mytable`

```
select length(myblob) from mytable where rowid=3; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-21T09:22:27.823

Debian 7 上的 sqlite 3.7.13 中的 LENGTH() 函数不起作用，但 LENGTH(HEX())/2 工作正常。

```
# sqlite --version
3.7.13 2012-06-11 02:05:22 f5b5a13f7394dc143aa136f1d4faba6839eaa6dc

# sqlite xxx.db "SELECT docid, LENGTH(doccontent), LENGTH(HEX(doccontent))/2 AS b FROM cr_doc LIMIT 10;"
1|6|77824
2|5|176251
3|5|176251
4|6|39936
5|6|43520
6|494|101447
7|6|41472
8|6|61440
9|6|41984
10|6|41472 
```

# .net - ASP.net 的测试功能（对象测试台）

> ID：250953
> 
> 赞同：2
> 
> 时间：2008-10-30T17:05:42.950
> 
> 标签：.net, asp.net, testing

**编辑**

我注意到对象测试台是我正在寻找的一个很好的例子，但它似乎不适用于 ASP.net。我总是收到无法创建实例的错误。

* * *

有没有一种方法可以在 ASP.net 中测试您的功能，而无需创建网页并单击按钮。例如，如果我创建一个返回 JSON 结果的控制器，我最终必须创建一个网页，创建一些 javascript 来调用该方法，启动网站，然后单击按钮。

真正很棒的是将命令的名称输入到**即时窗口**中，然后在该点提供参数以查看它们的行为，但是我在那里所做的所有努力似乎都遇到了问题，例如*The expression cannot be在运行模式下评估。*或其他任何东西（我认为交互模式还有另一条消息）。

是否有任何技巧可以只运行一个方法并查看结果而无需创建任何 UI 来进行调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T17:09:58.420

将所有非演示代码（不包括序列化为 JSON，即，将序列化之前的所有代码）放入类库中，并直接从单元测试链接到 DLL。

此外，要在调试器中评估任何表达式，您必须处于*中断模式*（打断点或按下停止按钮，其上有一个停止方块）。*运行模式*通常意味着调试器没有暂停执行，因此堆栈指针不断地上下移动并改变范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T17:47:53.723

There use to be a project call [NUnitASP](http://nunitasp.sourceforge.net/) that's now dead. But the last version may help you in some ways.

Your next choice is to use the Unit Testing functions in Visual Studio. There were many features that were only available in the more expensive "Visual Studio Team Suite Test Edition" that are now part of "Visual Studio Professional".

But if you have deep pockets and the problem is worth enough to you, then "Visual Studio Team Suite Test Edition 2008" is probably the best you can do right now.

Check these videos to get some idea [http://www.asp.net/learn/vsts-videos/](http://www.asp.net/learn/vsts-videos/)

# ruby-on-rails - Postgre Rails 应用程序的 database.yml 中的 schema_search_path 是否忽略大小写？

> ID：250957
> 
> 赞同：2
> 
> 时间：2008-10-30T17:06:45.447
> 
> 标签：ruby-on-rails

我必须连接到一个具有名为“Financeiro”的模式的遗留数据库。我将我的 database.yml 设置为：

```
... 
schema_search_path: Financeiro 
... 
```

当 activerecord 尝试查找某些内容时，我收到以下错误：

> ActiveRecord::StatementInvalid: RuntimeError: ERROR C3F000 Mschema "financeiro" 不存在 F.\src\backend\catalog\namespace.c L2898 Rassign_search_path: SET search_path TO Financeiro from c:/ruby/lib/ruby/gems/1.8/gems /activerecord-2.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:147:in `log'

请注意，在错误消息中，我得到了 financeiro（小写）。如果我将架构重命名为 financeiro 小写，它工作得很好。但是在生产环境中是不可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-30T18:01:51.030

用引号试试“Financeiro”。如果这使它通过 SQL，它应该可以工作。通常，SQL 标准要求标识符不区分大小写，除非被引用。您可能需要做一些特殊的引用才能将双引号从 yml 文件传递​​到实际的 SQL。我根本不了解 Rails/Ruby。

# performance - 证明更快的开发机器的合理性

> ID：250969
> 
> 赞同：4
> 
> 时间：2008-10-30T17:09:40.197
> 
> 标签：performance

我相信量化生产力的提高（额外的工作时间）是最有效的方法。

我的例子：我家里有一台速度很快的机器，而在工作中有一台速度很慢的机器。我的估计是，如果我在工作中使用家用机器，我每天将获得大约 30 分钟的额外工作效率。这种生产力将来自于更少等待完成我所做的所有任务。（每天额外的 30 分钟大约是一年的 3 周。）

问题：我需要测量这个。

是否有软件实用程序可以监控和科学量化机器上的任务所花费的时间？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-30T17:26:01.087

把它分解成你可以量化的部分。例如，我每 4 分钟编译一次，每次编译将节省 10 秒。但过了一会儿，我厌倦了等待几秒钟，所以我去了 Stack Overflow，在那里待了两分钟。有时我会开始和吉姆交谈，这对我们俩来说都需要 4 分钟。所以每小时 15 次 * 8 小时 * 10 秒 = 12 分钟 + 5 次堆栈溢出 = 22 分钟 + 与 Jim 的 4 次对话 = 我 38 分钟，Jim 16 分钟。

下一步是看看是否值得购买一台新电脑。让我们把它四舍五入到每天一小时，你每年花费公司 10 万美元的薪水和福利。你有八分之一的时间被浪费了，因此你和 Jim 之间每年浪费的生产力是 12,500 美元，而这可以通过让你获得更快的计算机来节省。

但你不会把电脑扔掉。老板的新管理员不需要一台全新的电脑，而给她买一台电脑需要 1,000 美元。您的计算机售价 3,000 美元，因此实际上只花费公司 2,000 美元。

让它看起来很简单并不难。目标是把它换成美元，但这当然不能保证你什么。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-30T17:29:47.410

很抱歉，但我相信，如果经理或 CEO 需要实际数据来证明高端机器适合高生产力工人，那么你手头就有更大的问题！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-30T17:24:33.973

来自 Sysinternals 的东西可能会完成他们编写的漂亮任务管理器的工作，这可能会有所帮助。

显然，您的工作机器可能有两倍的任务正在运行并通过 WAN 与数据库通信，而您的家用 PC 则没有。两者都会极大地影响 PC 的感知速度。从那时起，它变得更加复杂，但能够准确监控每项任务将是一个很好的开始。

这是进程监视器的链接，你可能只是喜欢它:)

[http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T17:48:54.097

您可以查看[How to measure Anything](http://www.howtomeasureanything.com/)一书，了解有关如何获得估算值的一些技巧。当您要求更新的机器时，您可能还会要求[双显示器](http://research.microsoft.com/displayarticle.aspx?id=433)。有艰苦的研究表明它可以提高生产力。你还应该考虑到你的成本比你的薪水高很多，也许是你的两倍。

It's always odd when you have a faster machine for your personal use than at work but it happens. Finally, if you can't get any satisfaction and it really bothers you, look for another job. If you can't get another job, figure out what you have to learn to be more desirable to other employers.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-30T17:13:49.877

Excel和秒表？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-30T17:27:47.557

获得更快的机器有一个简单的原因：

*   减少挫败感
*   工作更高效

每次出现问题时，你都会坐在那里等待——因为你在做什么/在想什么而分心。

等待时间就是死时间。即使系统只是挂起一秒钟，您仍然会注意到并分心..

编辑：我不认为编译时间真的是一个问题。任何体面的 CPU 都可以在 10 秒内编译你的东西（在不太复杂的项目上）。当你等待东西出现或关闭时，我看到更多的问题..启动东西应该很快..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-30T17:28:50.707

在 *nix 上，我会`time`在进行构建等时使用。

获取其输出非常简单，并且很容易在机器之间进行比较。

此外 - 您可以为某些“非工作”事物计时，例如构建 GCC 或 KDE 或其他相当大的源代码。

**此外**- 在多个显示器上存在一些相关问题（在 atm 上找不到）：确保你也添加了它:)

# vbscript - 检测到“错误：对象不支持此属性或方法”

> ID：250970
> 
> 赞同：3
> 
> 时间：2008-10-30T17:09:55.347
> 
> 标签：vbscript, error-handling

我正在处理的对象在 JavaScript 中实例化，但在 VBScript 中使用。在一个代码路径中，变量`M.DOM.IPt`被定义并具有一个值，而在另一个代码路径中却没有。我需要检测它是否已被定义。我检查了`M.DOM`在两个代码路径中都定义和可访问的。我尝试过的每个测试都只会导致此错误：

> 错误：对象不支持此属性或方法

我试过了：

*   `IsEmpty(M.DOM.IPt)`
*   `M.DOM.IPt is Nothing`
*   `isNull(M.DOM.IPt)`

有什么方法可以检测未定义变量并避免错误？

注意：我可以`On Error Resume Next`输入，它会简单地忽略错误，但我实际上需要检测它并有条件地做一些事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T17:54:49.717

```
    函数 SupportsMember(object, memberName)
      出错时继续下一步

      暗淡 x
      eval("x = object."+memberName)

      如果 Err = 438 那么
        SupportsMember = 假
      别的
        SupportsMember = 真
      万一

      On Error Goto 0 '清除错误
    结束功能

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T17:48:48.840

```
On Error Resume Next
Err.Clear
MyVariable=M.DOM.Ipt
If Err.Number<> 0 Then
    'error occured - Ipt not defined
    'do your processing here
Else
    'no error - Ipt is defined
    'do your processing here
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T17:32:41.510

您是否尝试过 On Error Goto 标签？

# .net - 在 PreBuild 期间插入函数名称

> ID：250973
> 
> 赞同：2
> 
> 时间：2008-10-30T17:11:03.940
> 
> 标签：.net, macros, compilation

我想编写一个 Visual Studio 宏或类似的东西，它可以获取函数名称并插入错误报告部分的预设位置。看例子就更清楚了

```
Class SampleClass
{
    public void FunctionA()
    {
        try
        {
                //Do some work here
        }
        catch (Exception ex)
        {
                Logger.WriteLine(LogLevelEnum.Error, "SampleClass", "FunctionA Failed");
                Logger.WriteLine(LogLevelEnum.Error, "FunctionA", ex.ToString());
        }
        finally
        {
        }
    }
} 
```

因此，我遵循了我的公共库的大多数关键功能的类似模式。我希望能够在预构建期间将“FunctionA”插入日志记录部分，这样我就不必记住输入正确的名称或在复制和粘贴后忘记重命名它。可以从工具栏手动调用，也可以通过快捷键调用。

那么，我应该从哪里开始呢？

注意：我被认为是 .Net 的中级人员，用 C# 和 VB 编写了 3 年多，但我对宏很陌生，不过不介意学习。不要担心代码本身和异常，这只是一个例子。

编辑：感谢 Ovidiu Pacurar 和 cfeduke。我在这里想要的是一种一次性的改变和忘记的方法。PostSharp 将在这些函数中的每一个上产生开销，即使没有抛出异常也是如此。从堆栈跟踪中挖掘是可行的，但在某些时候，我也想只记录“FunctionA Failed”，而不需要花费太多处理来获取堆栈跟踪。此外，如果库被混淆，堆栈跟踪将是神秘的。

实际上，这个功能还有另一个需要，我之前忘记提到了。当库准备好交付时，我想将所有的函数名改成函数代码，“FunctionA”可能是“0001”，通过引用一个表来解决“混淆”日志问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-30T17:17:23.910

看一下 System.Diagnostics.StackTrace，然后您可以只创建一个日志调用，从堆栈中获取函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T17:27:51.457

我希望 C# 有`__FILE__`和`__LINE__`-like 宏，但它没有。但是，您可以使用[PostSharp](http://www.postsharp.org)对 C# 进行后编译。这样做的好处是不必在运行时调用堆栈跟踪的开销来获取方法名称。性能开销可能不是您在异常处理程序期间关心的问题，但无论如何 PostSharp 是另一个可以执行该工作的可用工具。

PostSharp 的示例视频与您尝试做的事情类似。看看 PostSharp 网站首页上的这个示例代码，让你的齿轮转动：

```
public  class SimplestTraceAttribute : OnMethodBoundaryAspect
{
  public override void OnEntry( MethodExecutionEventArgs eventArgs)
  {
    Trace.TraceInformation("Entering {0}.", eventArgs.Method);
    Trace.Indent();
  }
  public override void OnExit( MethodExecutionEventArgs eventArgs)
  {
    Trace.Unindent();
    Trace.TraceInformation("Leaving {0}.", eventArgs.Method);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T17:26:48.167

看看[PostSharp](http://www.postsharp.org/about/features/)。它允许您以非常简单的方式和更多方式来做到这一点。

也有带有日志记录的样本。

# vb6 - 如何使用 VB6 将 PNG（图像）文件打开为 RGB 数组或 R、G、B 数组

> ID：250980
> 
> 赞同：2
> 
> 时间：2008-10-30T17:14:02.373
> 
> 标签：vb6, png

如何使用 VB6 打开 PNG 格式的图像文件？理想情况下，我（即我的客户）希望打开 PNG 文件并将其放入单独的 R(ed)、G(reen) 和 B(lue) 数组中。

VB6 不是我选择的工具（因为缺乏知识），如果有人能为我指出正确的 VB6 解决方案方向，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-30T18:59:06.670

感谢您的链接，虽然不是一个流利的 VB 人（更多的 C 和 ASM 风格），但代码似乎非常以 BMP 为中心；不是PNG。

如果是这种情况，我必须相信您建议了该链接，因为使代码PNG'able 是一件简单的事情，但我不知道如何处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T18:50:09.617

您可以尝试开源[FreeImage 项目](http://freeimage.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T14:31:46.923

```
'1 form with :
'    1 picturebox : name=Picture1
'    1 commandbutton : name=Command1
Option Explicit

Private Type BITMAP
  bmType As Long
  bmWidth As Long
  bmHeight As Long
  bmWidthBytes As Long
  bmPlanes As Integer
  bmBitsPixel As Integer
  bmBits As Long
End Type

Private Declare Function GetObject Lib "gdi32" Alias "GetObjectA" (ByVal hObject As Long, ByVal nCount As Long, ByRef lpObject As Any) As Long
Private Declare Function GetBitmapBits Lib "gdi32" (ByVal hBitmap As Long, ByVal dwCount As Long, ByRef lpBits As Any) As Long
Private Declare Function SetBitmapBits Lib "gdi32" (ByVal hBitmap As Long, ByVal dwCount As Long, ByRef lpBits As Any) As Long

Private mbmpBits() As Byte
Private mudtBmp As BITMAP

Private Sub Command1_Click()
  ShowRed
'  ShowGreen
'  ShowBlue
End Sub

Private Sub Form_Load()
  Picture1.Picture = LoadPicture("c:\temp\pic.bmp")
End Sub

Private Sub Form_Unload(Cancel As Integer)
  Set Form1 = Nothing
End Sub

Private Sub ShowRed()
  Dim lngX As Long, lngY As Long
  ReadBits
  For lngX = 0 To mudtBmp.bmWidth - 1
    For lngY = 0 To mudtBmp.bmHeight - 1
      mbmpBits(0, lngX, lngY) = 0
      mbmpBits(1, lngX, lngY) = 0
    Next lngY
  Next lngX
  ShowBits
End Sub

Private Sub ShowGreen()
  Dim lngX As Long, lngY As Long
  ReadBits
  For lngX = 0 To mudtBmp.bmWidth - 1
    For lngY = 0 To mudtBmp.bmHeight - 1
      mbmpBits(0, lngX, lngY) = 0
      mbmpBits(2, lngX, lngY) = 0
    Next lngY
  Next lngX
  ShowBits
End Sub

Private Sub ShowBlue()
  Dim lngX As Long, lngY As Long
  ReadBits
  For lngX = 0 To mudtBmp.bmWidth - 1
    For lngY = 0 To mudtBmp.bmHeight - 1
      mbmpBits(1, lngX, lngY) = 0
      mbmpBits(2, lngX, lngY) = 0
    Next lngY
  Next lngX
  ShowBits
End Sub

Private Sub ReadBits()
  GetObject Picture1.Picture.Handle, Len(mudtBmp), mudtBmp
  With mudtBmp
    ReDim mbmpBits(0 To (.bmBitsPixel \ 8) - 1, 0 To .bmWidth - 1, 0 To .bmHeight - 1) As Byte
    GetBitmapBits Picture1.Picture.Handle, .bmWidthBytes * .bmHeight, mbmpBits(0, 0, 0)
  End With 'mudtBmp
End Sub

Private Sub ShowBits()
  SetBitmapBits Picture1.Picture.Handle, mudtBmp.bmWidthBytes * mudtBmp.bmHeight, mbmpBits(0, 0, 0)
  Erase mbmpBits
  Picture1.Refresh
End Sub 
```

# svn - 我真的需要版本控制吗？

> ID：250984
> 
> 赞同：47
> 
> 时间：2008-10-30T17:14:43.900
> 
> 标签：svn, version-control

我在互联网上（各种网站和博客）阅读了有关版本控制的信息。它有多棒，以及所有开发人员都需要如何使用它，因为它非常有用。

问题来了：我真的需要这个吗？我是一名前端开发人员（通常只是 HTML/CSS/JavaScript），我从来没有遇到过像“哇，我昨天的文件！”这样的问题。我试过使用它，安装了[Subversion](http://en.wikipedia.org/wiki/Subversion_%28software%29)和[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)，我理解版本控制背后的概念，但是......我不能使用它（对我来说很奇怪）。

好的，所以... 这很糟糕吗？我通常独自工作（自由职业者），没有客户要求我使用 Subversion（但现在永远不会太晚，对吧？）。那么，我应该开始努力学习使用 Subversion（或类似的东西？）还是只是浪费时间？

* * *

相关问题：[不使用版本控制的好借口](https://stackoverflow.com/questions/132520/good-excuses-not-to-use-version-control#132522)。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2008-10-30T17:53:45.413

这里有一个场景，即使您单独工作，也可以说明源代码控制的有用性。

> 您的客户要求您对网站进行雄心勃勃的修改。这将花费您几个星期的时间，并且涉及对许多页面的编辑。你开始工作。
> 
> 当客户打电话告诉你放弃你正在做的事情以对网站进行紧急但更小的更改时，你已经完成了 50% 的任务。你还没有完成更大的任务，所以它还没有准备好上线，客户不能等待更小的变化。但他也希望将较小的更改合并到您的工作中以进行较大的更改。
> 
> 也许您正在一个包含网站副本的单独文件夹中处理大型任务。现在您必须弄清楚如何以一种可以快速部署的方式进行微小的更改。你拼命工作并完成它。客户回电并提出进一步的细化请求。您也这样做并部署它。一切都很好。
> 
> 现在您必须将其合并到正在进行的工作中以进行重大更改。你为紧急工作做了什么改变？你工作太快，记不住笔记。而且你不能轻易区分这两个目录，因为它们都相对于你开始的基线发生了变化。

上面的场景表明，即使您单独工作，源代码管理也是一个很好的工具。

*   您可以使用分支来处理长期任务，然后在完成后将分支合并回主线。
*   您可以将整套文件与其他分支或过去的修订版进行比较，看看有什么不同。
*   您可以随着时间的推移跟踪工作（顺便说一下，这对于报告和开具发票非常有用）。
*   您可以根据您定义的日期或里程碑恢复任何文件的任何修订。

对于单独的工作，建议使用 Subversion 或 Git。任何人都可以自由选择其中一个，但显然比不使用任何版本控制要好。好书是Mike Mason的“ [Pragmatic Version Control using Subversion, 2nd Edition ”或 Travis Swicegood 的“](http://www.pragprog.com/titles/svn2/pragmatic-version-control-using-subversion) [Pragmatic Version Control Using Git](http://www.pragprog.com/titles/tsgit/pragmatic-version-control-using-git) ”。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-30T17:15:46.910

有很多好处，是的，你需要它。

*   [哪些工具/技术可以使独立开发人员受益？](https://stackoverflow.com/questions/59561/what-toolstechniques-can-benefit-a-solo-developer)
*   [独立开发人员的最佳版本控制](https://stackoverflow.com/questions/138621/best-version-control-for-lone-developer)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-10-30T17:16:11.790

你不需要版本控制，就像 Trapese 艺术家需要安全网一样。这就像备份您的硬盘驱动器 - 大多数时候它似乎是多余的，因为什么都没有发生，但最终**会**需要它。这里没有可能。它**会**发生。而且你永远无法预测什么时候和过去是什么时候会发生的一个糟糕的指标。它可能在未来只发生*一次*，但即使你知道它会发生一次，你也不知道它会有多糟糕。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-30T17:16:15.317

是的！

去做吧。不会伤害你的。。

我通常从笔记本电脑切换到 PC 并返回，将您的代码放在中央存储库的某个位置绝对很棒。

有时恢复到最新版本是很棒的，因为你搞砸了一些很难修复的东西。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-08T21:35:20.717

缺少的最大优势是能够重新生成生成旧版本的源代码。

在构建时，您使用“构建 4.26”标记源代码管理。第二天开始编写 Build 4.27。三个月后，当客户说：“我使用的是 Build 4.26，Frickershaw 功能存在错误。由于您在 build 4.27 中对文件格式进行了一些更改，我无法升级到任何其他版本。有你能为我做点什么？我愿意付出。”

然后，您可以签出 4.26 源代码的一个分支...修复 Frickershaw 功能，然后在大约一两个小时内为用户重新构建包。然后你可以切换回 4.39 版本，继续工作。

同样，您可以追踪添加错误的确切位置。测试版本 4.25 的 bug，然后是 4.20，然后是 4.10，最终发现 bug 是在 4.12 版本中引入的。然后查找“Build 4.11”和“Build 4.12”之间的所有更改，然后关注 Frickershaw 功能。您无需调试即可快速找到错误的源代码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-30T17:17:46.670

尝试使用[Git](http://git.or.cz/)或[Bazaar](http://bazaar-vcs.org/)等[DVCS](http://en.wikipedia.org/wiki/Distributed_revision_control)。它们非常易于设置、易于使用，并提供 Subversion、CVS 等的所有重要功能。

关键是您可以在破坏某些内容时恢复到工作版本，这通常比手动撤消更改要快得多。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-30T17:17:48.373

分支似乎对您没有用？你有没有想过只是尝试一些东西，看看它是否有效？我也做了很多普通的旧的 html/css 的东西，我发现那是无价的。从字面上看，分支来测试某些东西，看看它是否有效，然后决定“meh”然后回滚是没有危险的。

我从来不需要备份（敲木头），但我发现回滚功能非常宝贵。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-30T17:19:06.763

作为自由职业者的一些好处：

*   明确知道您在每个文件中所做的更改以及何时更改（只要您经常签入）
*   回滚到您过去的任何版本。令人惊讶的是，这是多么有价值。
*   跟踪一组更改作为“发布”。通过这种方式，您可以了解每个客户当前正在使用什么以及正在开发什么。
*   备份
*   如果您突然不单独，可以轻松共享项目

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-30T17:22:41.123

如果没有他们整合到我们的流程中，我不会雇用承包商。他们必须通过我们的 SVN 访问代码，并且在不满足单元测试和代码审查要求的情况下不太可能获得报酬。

如果签订合同，我会确保对 VSS（签入/签出）和 CVS（合并和冲突）模型都有扎实的经验。

自己工作，你有一个很好的机会来玩和学习最新的东西——我会尝试 Git。

作为一个单独的开发人员，您可以将源代码控制视为无限撤消 - 跨会话和重启工作。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-08T21:37:02.553

对我来说，源代码控制的一个次要优势是我在多台开发计算机上工作。在机器之间移动我的工作很容易。

我认为最大的优势已经列出来了。它让我在晚上睡觉时知道如果我们必须回滚更改，那将相当容易。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-08T21:57:23.480

我认为从“保留所有版本的文件系统”迁移到源代码控制系统的主要优势在于，sccs 为您保留的所有这些文件的所有版本添加了结构，并为您提供了“在 X 点***整个***文件系统的一致状态是什么”。

换句话说，“文件 A 的哪个版本与 B、C、D 的哪个版本......”。

事后才想到（¡！）：*提交*或*签入*的特殊行为让您思考“这是什么？”，并且生成的日志消息有望用作记忆......

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-07-31T00:29:10.237

这个问题的字面答案是，**不，你不需要版本控制。**

但是，即使您不知道，您也需要版本控制。

* * *

也就是说，在您突破 Grok 障碍之前，许多 SCM 工具使用起来可能很神秘或完全不愉快，所以让我们稍微修改一下：

“但是，您确实需要易于使用的版本控制。” 它就在那里...下载一堆推荐的可视化客户端并试一试，然后尝试最符合您想法的映射。

这导致了您要问的*问题*：

> *为什么*我要使用版本控制？”

答：**版本控制让你无所畏惧！**

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-30T17:19:34.047

是的，你需要它。

至少，对于单个开发人员商店，您需要每天多次将代码移动到 ProjectName-Date-Time 目录中。

也就是说，编写一个脚本，它会在午餐和下班时自动备份您的工作目录，而不会覆盖其他备份。

这可能会增长得非常快，因此最终您将只想保存文件之间的差异，这就是 VC 应用程序所做的。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-30T17:22:34.603

由于您通常独自工作，因此我会说使用版本控制是一个好主意。我发现使用版本控制（在我的例子中是 Subversion）的主要好处之一是，当我独自工作时，它让我更有信心尝试一种新的方法来解决问题。您总是可以分支到解决问题的新方法或框架，看看您是否更喜欢它。如果事实证明这个分支不起作用，您可以放弃它并返回旧方法。这也使得并排尝试不同的解决方案变得更加容易。

因此，如果您曾经看到解决问题的不同方法并且想尝试一下，我肯定会使用版本控制作为一种工具来简化此操作。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-30T17:17:11.697

如果您自己工作，并且定期执行备份，则可能不需要 VC（除非您将备份计为版本历史记录）。一旦您开始与另一位开发人员合作，您就应该进行版本控制，这样您就不会开始重写彼此的工作。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-30T17:17:52.083

即使您现在不需要它，它也是您在团队中工作时需要的东西。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-30T17:20:28.273

对您的 html/css/javascript 进行更改的历史可能是天赐之物。能够将您的前端与一个月前或几个月前的代码进行比较，对于弄清楚为什么模板突然全歪了的原因真的有很长的路要走。

此外，如果您想要/需要获得有关您的项目的帮助，您将拥有一个简单的系统来分发、跟踪和部署更新的内容。

一定要这样做，一旦你习惯了，你会感谢自己的。

结帐（一次） 更新（一天的开始） 提交（任务结束/测试后更改）

这里的所有都是它的。不要提交您在浏览器中刷新的每一个修改，只提交您想要上线的修改。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-30T17:22:36.210

想想它是否像备份。在您需要它的那一天之前，这有点烦人。然后，您丢失的工作量与备份频率成正比。

另一个好处是能够查看您做某事的旧方法，这些方法在某个地方可能已经过时，但在另一个地方可能有用。只需剪切并粘贴进行比较时获得的旧代码即可。

那是除非你喜欢重新发明你已经重新发明的轮子......

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-30T17:22:51.060

当事情可能出错时，他们会。能够参考您可能在一个月前删除的代码，或者在硬件故障或升级后恢复整个项目的能力非常好。

将来也可能会有一个点，当项目的工作人员超过你时。在这样的环境中，必须具备防止（或控制）分支和版本控制的能力。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-30T17:22:55.630

必须必须必须必须必须必须。您必须使用版本控制。

这是最重要的。

如果你现在不明白为什么，总有一天你会的。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-30T18:07:15.090

当您的客户因为现场网站上的某些内容被破坏而惊慌失措并且这是一种回归时，您会很高兴您可以打开 TortoiseSVN 并查看您上周二所做的导致破坏的事情。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-11-04T20:04:17.000

这真的很奇怪。自从我开始使用版本控制以来，我偶尔需要查找代码的旧副本并使用它们。我以前从来不需要这样做......可能是因为这样做的想法并没有真正坚持下去。当您发现版本控制很有帮助时，很容易不注意到这些时候。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-11-08T22:30:54.740

在整个代码库中搜索。这是一个杀手级功能，主要是因为搜索会在另一台机器上执行，因此您可以不受干扰地继续工作。

顺便说一句，这就是我们没有更改为 SourceGear Vault 的原因。它不能这样做。我们仍在寻找与 SourceSafe 兼容的替代品……好吧，SourceSafe。尽管每个人都这么说，但它还没有让我们失望*

* 这可能只是时间问题。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-30T17:59:57.663

我认为您做出了使用某种版本控制的正确决定。为简单起见，我会选择 SVN（忽略 CVS，因为 SVN 基本上是“更好”的 CVS）

SVN 可以直接在文件系统和许多平台上使用“本地”存储库，因此您不必在基础设施（服务器、网络等）中花费太多

SVN 的绝佳资源：http: [//svnbook.red-bean.com](http://svnbook.red-bean.com)

我对 GIT 了解不多，但它是开源的并获得了很多的关注，可能有很多类似的优势！

从某处借用一句话：你现在可能不需要它，但当你这样做时，你会很高兴你这样做了。

快乐的版本控制！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-30T18:09:45.287

虽然陈旧而粗糙，但我们发现 Microsoft Visual SourceSafe 可以正常工作。它非常适合保存版本历史。如果您不担心分支（您可能不会是单独的开发人员），那么它可能正好符合要求。

就签入而言，找到一个好的检查点可能是一项挑战，但每次保存都签入只会使版本控制难以跟踪。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-30T18:15:38.363

> “我真的需要版本控制吗？”

是的。除非您编写了永远不需要更改的完美代码。

一个例子：我有一个要求。我建了一个网页，花了一天左右的时间在页面上，它是508条款的兼容性（大约是6-7年前），然后上传到网站上。接下来，需求发生了巨大的变化。我又花了一天的时间在页面上工作（Hayuge Excel 文件并没有轻松地转换成可访问的 HTML）。大约一周后，客户端切换要求我们返回到版本 A。源代码控制将在大约 10 分钟内完成此操作。事实上，我不得不在任务上再浪费 %$#^^&$# 天。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-11-21T19:45:58.397

一旦您开始在一个引用从多个调用者/应用程序升级“组件”的团队中工作，版本控制将是绝对必须的。在那种环境中，您无法跟上所有可能变化的排列。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-06-17T07:45:38.670

是的，您需要版本控制以用于开发目的或仅用于存储文档。这样，如果您需要这样做以恢复对代码或文档所做的更改或错误，您可以及时返回。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-01-01T22:28:47.443

您需要版本控制，就像您需要生活中的保险一样。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-11-23T07:09:06.173

您需要版本控制来管理不同的文件版本。有了它，您可以从不同的地方获取和处理文件，它有助于团队成员在同一个项目上进行协作。

# sharepoint - SharePoint：我应该使用列表还是数据库？

> ID：250992
> 
> 赞同：10
> 
> 时间：2008-10-30T17:16:12.057
> 
> 标签：sharepoint, architecture

我正在设计自定义 SharePoint 应用程序。在以前的项目中，所有数据都保存在 SharePoint 列表中，这就是我现在一直在尝试的方式。但是，我已经到了数据模型增长的地步，我觉得有必要对其进行规范化并将一个逻辑实体拆分为多个物理列表。我想知道是否应该从 SP 列表切换到经典数据库。一方面，我对 SharePoint 开箱即用的新项目、编辑项目、所有项目表单感到满意；另一方面，我担心一旦我必须查询连接数据（如果它停留在`SPList`s 中），性能会受到影响。
如果您对此问题有任何见解或经验，请分享。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-30T21:12:52.110

这取决于您的要求，但根据我的经验，您应该使用数据库而不是列表：

1）当您的数据库模型中存在多对多关系时

2) 当您有两个或多个实体链接在一起时（例如客户 > 发票 > 发票产品）。

SharePoint 很棒，但在上述情况下，您将遇到 SharePoint UI 限制问题。

3) 如果您计划有任何自定义报告或图表，您应该坚持使用您自己的数据库。

当您使用数据库实体时，最好的方法是开发您自己的 Web 部件，因为 BDC 价格昂贵且在大多数情况下非常有限。您还可以检查 3rd 方 Web 部件（例如 Bamboo Web 部件）

* * *

以下是在数据库上使用 SharePoint 列表的原因：

*   权限
*   最终用户易于使用
*   在数据表 / Excel / Access 中编辑
*   工作流程
*   搜索

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-30T17:20:49.427

如果您有复杂的查询，我建议您将它们放入单独的数据库中。当数据模型不经常增长时，列表很好。

扩展列表列内的字段数量包括使用您必须编码的 STSADM 直接更新 ContentTypes。但是，直接从数据库查询数据（当然有一些缓存）将导致更快的开发，而无需更新链接到与其关联的每个列表的所有 ContentType。

当然，如果你开启缓存，从数据库中查询到的数据会被缓存在页面输出级别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-30T18:25:21.997

除了Maxim的回答，我还建议您考虑搜索。如果这些数据将成为您需要挖掘的东西，OTB 搜索真的很棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T20:44:04.570

我不会太担心去自定义数据库获取数据。

这确实意味着需要额外的工作来使用自定义控件对其进行皮肤化，并将这些控件引入到列表为您执行的布局页面和/或自定义 Web 部件中。

如果您有可用的 BDC，那将是可行的方法，否则是自定义的。

因此，最终它是在易于与 sharepoint 集成和提供数据输入表单与对所有这些项目进行编码但完全控制数据完整性之间进行权衡。*********