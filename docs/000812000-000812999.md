# StackOverflow 问答 000812000-000812999

# asp.net - 如何枚举 .NET 中的单选按钮列表？

> ID：812000
> 
> 赞同：1
> 
> 时间：2009-05-01T16:00:59.413
> 
> 标签：asp.net, radiobuttonlist

如何枚举 .NET 中的单选按钮列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:07:27.620

```
foreach (ListItem item in RadioButtonList1.Items)
{
    if (item .Selected == true)
    {
       Response.Write("You selected " + rbtn.Text);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:04:29.123

枚举其[Items 集合](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.items.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T16:05:32.553

不太确定你在这里问什么 - 但如果你只是想通过项目枚举，它......

```
foreach (var item in MyRbl.Items)
{
   // do something with the current item.
} 
```

如果您想获得价值，只需使用 .SelectedValue

如果您尝试在客户端获取所选值 - 您可以使用 jQuery 来获取所选值...

```
var selected = jQuery('#<%= MyRbl.ClientID %> input:checked').val(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T16:07:29.990

RadioButtonList.Items 是一个实现 IEnumerable 的 ListItemCollection。

# php - PHP - 可靠地将文档内联到浏览器

> ID：812012
> 
> 赞同：0
> 
> 时间：2009-05-01T16:03:21.683
> 
> 标签：php

无论操作系统和浏览器如何，在用户浏览器中可靠交付文档的最佳方式上是否有库或好的文档。我主要查看 PDF、office (2003 & 2007) 和扫描图像 (.tiff) 似乎您总是必须根据浏览器和交付的文档类型设置不同的标题。现在：

```
header("Content-Type: $type");
header("Content-Disposition: inline; filename=$name");
header("Accept-Ranges: bytes");
header("Content-Length: $size");
header("Expires: 0");
header("Cache-Control: private"); 
```

似乎最常用于 IE，但并不总是用于 FF。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T17:39:08.757

我认为您拥有的代码可能是关于它将采取的措施。问题在于，对于每个浏览器，您都需要该代码的变体，因此您最终会得到一个相当复杂的浏览器检测库，其中包含一堆特殊情况。

如果内联对您来说真的很重要，我会考虑在服务器上将它们翻录成对网络更友好的格式并提供服务。您始终可以在底部留下源文件的“下载”链接。[Imagemagick](http://www.imagemagick.org/script/index.php)可以将大多数格式转换为 .png/.gifs，您可以使用[pdftohtml](http://sourceforge.net/projects/pdftohtml/)之类的东西来翻录 PDF。也有一些图书馆会为 word 文档执行此操作，尽管谷歌立即向我吐出的那些是非免费的。

# c# - C#按位向左旋转和向右旋转

> ID：812022
> 
> 赞同：41
> 
> 时间：2009-05-01T16:06:10.867
> 
> 标签：c#, bitwise-operators

`_rotl`C++ 的 C# 等价物(.NET 2.0) 是`_rotr`什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-01T16:10:40.840

这是你想要做的吗？

[Jon Skeet 在另一个网站上回答了这个问题](http://www.developmentnow.com/g/6_2004_3_0_0_71603/-rotl.htm)

基本上你想要的是

（左）

```
(original << bits) | (original >> (32 - bits)) 
```

或者

（右）

```
(original >> bits) | (original << (32 - bits)) 
```

此外，正如 Mehrdad 已经建议的那样，这仅适用于 uint，这也是 Jon 给出的示例。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-01T16:08:49.487

C# 中没有用于位旋转的内置语言功能，但这些扩展方法应该可以完成这项工作：

```
public static uint RotateLeft(this uint value, int count)
{
    return (value << count) | (value >> (32 - count))
}

public static uint RotateRight(this uint value, int count)
{
    return (value >> count) | (value << (32 - count))
} 
```

**注意：**正如 Mehrdad 指出的，有符号整数的右移 ( `>>`) 是一个特性：它用符号位填充 MSB，而不是像无符号数那样用 0 填充。我现在更改了获取和返回`uint`（无符号 32 位整数）的方法——这也更符合 C++`rotl`和`rotr`函数。如果你想旋转整数，只需在传递之前对它们进行大小写，然后再次转换返回值，当然。

示例用法：

```
int foo1 = 8.RotateRight(3); // foo1 = 1
int foo2 = int.MinValue.RotateLeft(3); // foo2 = 4 
```

（注意，`int.MinValue`二进制是 111111111111111111111111 - 32 1s。）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-02-02T10:17:48.253

使用最新的**C# 7**，您现在可以创建***by-ref***扩展方法，这样您就可以摆脱不断将辅助函数的返回值存储回变量的繁琐工作。

这很好地简化了旋转函数，并消除了一类常见的错误，即您忘记重新存储函数的返回值，但同时可能引入一种新的、完全不同类型的错误——当您`ValueTypes`不经意地*在原地*修改时不想或期望他们成为。

```
public static void Rol(ref this ulong ul) => ul = (ul << 1) | (ul >> 63);

public static void Rol(ref this ulong ul, int N) => ul = (ul << N) | (ul >> (64 - N));

public static void Ror(ref this ulong ul) => ul = (ul << 63) | (ul >> 1);

public static void Ror(ref this ulong ul, int N) => ul = (ul << (64 - N)) | (ul >> N);
///   note: ---^        ^---^--- extension method can now use 'ref' for ByRef semantics 
```

通常我肯定会使用`[MethodImpl(MethodImplOptions.AggressiveInlining)]`这些小方法，但经过一番调查（在 x64 上）我发现这里根本没有必要。如果 JIT 确定该方法是合格的（例如，如果您取消选中 VisualStudio 调试器复选框['Suppress JIT Optimization'](https://docs.microsoft.com/en-us/visualstudio/debugger/jit-optimization-and-debugging)，默认情况下启用），则无论如何都会内联方法，这里就是这种情况。

> [*如果术语不熟悉，**JIT**或“即时”是指将 IL 指令一次性转换为针对在运行时检测到的平台调整的本机代码，这是一个按需发生的过程，每个方法为**.NET**程序运行*。]

为了演示***按引用***扩展方法的使用，我将只关注上面显示的第一个方法“向左旋转”，并比较传统***按值***扩展方法和较新***的按引用***方法之间的 JIT 输出。以下是要在 Windows 10 上的**.NET 4.7中的****x64** *版本*上比较的两种测试方法。如上所述，这将使用“未抑制”JIT 优化，因此在您将看到的这些测试条件下，函数将完全消失在内联代码中。

 **```
static ulong Rol_ByVal(this ulong ul) => (ul << 1) | (ul >> 63);

static void Rol_ByRef(ref this ulong ul) => ul = (ul << 1) | (ul >> 63);
//                 notice reassignment here ---^  (c̲a̲l̲l̲e̲e̲ doing it instead of caller) 
```

这是每个相应调用站点的 C# 代码。由于完全 JIT 优化的 AMD64 代码非常小，所以我也可以在这里包含它。这是最佳情况：

```
static ulong x = 1;   // static so it won't be optimized away in this simple test

// ------- ByVal extension method; c̲a̲l̲l̲e̲r̲ must reassign 'x' with the result -------

                     x = x.Rol_ByVal();
// 00007FF969CC0481  mov         rax,qword ptr [7FF969BA4888h]  
// 00007FF969CC0487  rol         rax,1  
// 00007FF969CC048A  mov         qword ptr [7FF969BA4888h],rax  

// ------- New in C#7, ByRef extension method can directly alter 'x' in-situ -------

                     x.Rol_ByRef(); 
// 00007FF969CC0491  rol         qword ptr [7FF969BA4888h],1 
```

哇。是的，这不是开玩笑。**马上，我们可以看到ECMA CIL** (.NET) 中间语言中明显缺乏一系列`OpCodes.Rot`指令几乎不是问题。jitter 能够看穿我们的一堆 C# 变通方法代码来判断其基本意图，在这两种情况下，x64 JIT 都通过简单地发出本机指令来实现。令人印象深刻的是，ByRef 版本使用一条指令直接在主存储器目标地址上执行轮换，甚至无需将其加载到寄存器中。**`(ul << 1) | (ul >> 63)``rol`**

 **在 ByVal 的情况下，您仍然可以看到在被调用的方法被完全优化之前（值类型语义的本质）保持调用者的原始值不变所必需的过度复制的残余痕迹。对于此处的整数循环，它只是将目标整数额外提取/存储到 64 位寄存器`rax`中。

为了澄清这一点，让我们在调试会话中重新抑制 JIT 优化。这样做会使我们的辅助扩展方法回来，带有完整的主体和堆栈帧，以更好地解释上一段的第一句话。首先，让我们看一下调用站点。在这里我们可以看到传统`ValueType`语义的效果，归结为确保没有较低的堆栈帧可以操纵任何父帧的`ValueType`副本：

***按价值：***

```
 x = x.Rol_ByVal();
// 00007FF969CE049C  mov         rcx,qword ptr [7FF969BC4888h]  
// 00007FF969CE04A3  call        00007FF969CE00A8  
// 00007FF969CE04A8  mov         qword ptr [rbp-8],rax  
// 00007FF969CE04AC  mov         rcx,qword ptr [rbp-8]  
// 00007FF969CE04B0  mov         qword ptr [7FF969BC4888h],rcx 
```

* * *

***引用***

```
 x.Rol_ByRef();
// 00007FF969CE04B7  mov         rcx,7FF969BC4888h  
// 00007FF969CE04C1  call        00007FF969CE00B0
//             ...all done, nothing to do here; the callee did everything in-place for us 
```

正如我们从与这两个片段中的每一个相关联的**C#**代码中所期望的那样，我们看到***by-val***调用者在调用返回后有很多工作要做。这是用寄存器中返回`ulong`的完全独立的值覆盖值“x”的父副本的过程。`ulong``rax`

现在让我们看看被调用的目标函数的代码。看到它们需要强制 JIT “抑制”优化。以下是 x64 Release JIT 为`Rol_ByVal`和`Rol_ByRef`函数发出的本机代码。

为了专注于两者之间微小但至关重要的区别，我删除了一些管理样板。（我为上下文留下了堆栈框架的设置和拆卸，并展示了在这个示例中，辅助内容如何使实际的内容指令相形见绌。）你能看到 ByRef 的间接作用吗？好吧，我指出它会有所帮助：-/

```
 static ulong Rol_ByVal(this ulong ul) => (ul << 1) | (ul >> 63);
// 00007FF969CD0760  push        rbp  
// 00007FF969CD0761  sub         rsp,20h  
// 00007FF969CD0765  lea         rbp,[rsp+20h]  
// ...
// 00007FF969CE0E4C  mov         rax,qword ptr [rbp+10h]  
// 00007FF969CE0E50  rol         rax,1  
// 00007FF969CD0798  lea         rsp,[rbp]  
// 00007FF969CD079C  pop         rbp  
// 00007FF969CD079D  ret  

                 static void Rol_ByRef(ref this ulong ul) => ul = (ul << 1) | (ul >> 63);
// 00007FF969CD0760  push        rbp  
// 00007FF969CD0761  sub         rsp,20h  
// 00007FF969CD0765  lea         rbp,[rsp+20h]  
// ...
// 00007FF969CE0E8C  mov         rax,qword ptr [rbp+10h]  
// 00007FF969CE0E90  rol         qword ptr [rax],1              <--- !
// 00007FF969CD0798  lea         rsp,[rbp]  
// 00007FF969CD079C  pop         rbp  
// 00007FF969CD079D  ret 
```

您可能会注意到，这两个调用实际上都是`ulong`通过引用传递父值的实例——这两个示例在这方面是相同的。父级指示其私有副本`ul`驻留在上层堆栈帧中的地址。事实证明，没有必要使被调用者不*读取*它们所在的那些实例，只要我们可以确定它们永远不会写入这些指针。这是一种“惰性”或延迟方法，它为每个较低（子）堆栈框架分配了保留其较高调用者的***ValueType*****语义的****责任。***呼叫者无需主动复制任何`ValueType`如果子框架永远不会覆盖它，则传递给子框架；为了最大限度地避免不必要的复制，只有孩子才能做出最新可能的决定。*

 *`rax`同样有趣的是，对于我展示的第一个 'ByVal' 示例中的笨拙用法，我们可能会有一个解释。在通过内联完全减少了按值方法之后，为什么还需要在寄存器中进行轮换？

好吧，在这两个最新的完整方法体版本中，很明显第一个方法返回`ulong`，第二个是`void`. 由于传入了一个返回值`rax`，因此这里的 ByVal 方法无论如何都必须将其提取到该寄存器中，因此在此处轮换它也很容易。因为 ByRef 方法不需要返回任何值，所以它不需要在任何地方为其调用者粘贴任何东西，更不用说在`rax`. 似乎“不必费心`rax`”释放 ByRef 代码以针对`ulong`其父级共享“它所在的位置”的实例，使用花式`qword ptr`间接进入父级的堆栈帧内存，而不是使用寄存器。`rax`所以这是我对“剩余”的推测，但也许是可信的解释

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-01T16:18:38.763

简单的换档版本是行不通的。原因是，右移有符号数将用**符号位填充左边的位，而不是 0**：

您可以通过以下方式验证这一事实：

```
Console.WriteLine(-1 >> 1); 
```

正确的方法是：

```
public static int RotateLeft(this int value, int count)
{
    uint val = (uint)value;
    return (int)((val << count) | (val >> (32 - count)));
}

public static int RotateRight(this int value, int count)
{
    uint val = (uint)value;
    return (int)((val >> count) | (val << (32 - count)));
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-12-11T13:21:59.470

对于使用 .NET Core 3.0 或 .NET 5.0 及更高版本的用户，可以使用[`BitOperations.RotateLeft`](https://docs.microsoft.com/en-us/dotnet/api/system.numerics.bitoperations.rotateleft)和[`RotateRight`](https://docs.microsoft.com/en-us/dotnet/api/system.numerics.bitoperations.rotateright).

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-26T23:57:03.573

请注意，如果要创建对较短整数值进行操作的重载，则需要添加一个额外的步骤，如下所示：

```
public static byte RotateLeft(
    this byte value,
    int count )
{
    // Unlike the RotateLeft( uint, int ) and RotateLeft( ulong, int ) 
    // overloads, we need to mask out the required bits of count 
    // manually, as the shift operaters will promote a byte to uint, 
    // and will not mask out the correct number of count bits.
    count &= 0x07;
    return (byte)((value << count) | (value >> (8 - count)));
} 
```

32 位和 64 位重载不需要屏蔽操作，因为移位运算符本身会处理这些大小的左侧操作数。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2014-09-10T06:55:52.687

```
// if you are using string

string str=Convert.ToString(number,2);

str=str.PadLeft(32,'0');

//Rotate right

str = str.PadLeft(33, str[str.Length - 1]);

str= str.Remove(str.Length - 1);

number=Convert.ToInt32(str,2);

//Rotate left

str = str.PadRight(33, str[0]);

str= str.Remove(0,1);

number=Convert.ToInt32(str,2); 
```

# apache-flex - 如何自动调整字体大小以适应文本框的高度/宽度？

> ID：812027
> 
> 赞同：11
> 
> 时间：2009-05-01T16:07:26.667
> 
> 标签：apache-flex, actionscript-3

我试图让文本自动调整其字体大小以填充整个文本组件。

我目前的方法是将字体大小设置为文本字符数和文本组件高度和宽度的函数，但我找不到正确的系数来使其正常工作。

有没有更简单或更优雅的方法？

truncateToFit 是否适用于文本？我在某处读到它效果不佳。

**编辑：**我忘了提到我希望它超出最大字体大小（我相信是 127）。这是怎么做到的？规模X？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-01T16:35:42.933

AS3 示例函数。您应该在 TextField 的内容更改时调用它

```
function Autosize(txt:TextField):void 
{
  //You set this according to your TextField's dimensions
  var maxTextWidth:int = 145; 
  var maxTextHeight:int = 30; 

  var f:TextFormat = txt.getTextFormat();

  //decrease font size until the text fits  
  while (txt.textWidth > maxTextWidth || txt.textHeight > maxTextHeight) {
    f.size = int(f.size) - 1;
    txt.setTextFormat(f);
  }

} 
```

# c# - .NET BitmapSource 正在锁定文件

> ID：812033
> 
> 赞同：2
> 
> 时间：2009-05-01T16:08:35.807
> 
> 标签：c#, .net

我正在使用此 C# 代码访问图像文件，以便从中读取元数据。

```
BitmapSource img = BitmapFrame.Create(uri); 
```

不幸的是，由 指定的图像文件被`uri`锁定，直到程序结束。如何防止图像被锁定？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T16:20:09.490

也许[这会有所帮助](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/3cb97997-941f-42a8-a03b-f84b152c1139/)？

***编辑***

```
BitmapSource img = BitmapFrame.Create(uri,BitmapCreateOptions.None,BitmapCacheOption.OnLoad); 
```

BitmapCreateOptions.None = 默认选项

BitmapCacheOption.OnLoad = 在加载时将整个图像缓存到内存中。所有对图像数据的请求都从内存存储中填充。

从[这里](http://msdn.microsoft.com/en-us/library/ms616004.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T16:18:06.237

如果您希望之后能够立即删除/更改文件，请将整个文件读入内存，然后将其`MemoryStream`替换。例如：

```
MemoryStream data = new MemoryStream(File.ReadAllBytes(file));
BitmapSource bitmap = BitmapFrame.Create(data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-13T15:45:20.087

您还可以使用通用流：

```
Stream stream = File.OpenRead(filename);
Bitmap template = new Bitmap(stream); // or (Bitmap) Bitmap.FromStream(stream)
stream.Close(); 
```

# c# - 使用反射将数据读取器转换为列表的最快方法

> ID：812034
> 
> 赞同：2
> 
> 时间：2009-05-01T16:08:36.493
> 
> 标签：c#, asp.net

我正在使用反射将 datareader 转换为通用集合列表。有人可以建议我为此实施反射的最佳方法吗？我要最快的路吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T17:33:59.953

我假设你想做的是这样的：

```
List<MyClass> list = LoadFromDataReader<MyClass>(dataReader); 
```

和：

```
class MyClass
{
    [DataField("FirstName")] public string FirstName { get; set; }
    [DataField("LastName")] public string LastName { get; set; }
} 
```

我这样做：

1.  使用`Type.GetProperties`和`PropertyInfo.GetCustomAttribute`组合一个字典，将字段名称映射到`PropertyInfo`对象
2.  调用`PropertyInfo.SetValue`每条记录中的每个字段

您可以缓存步骤 (1) 的结果，因为字段/属性映射在应用程序的生命周期内不会改变。

如果性能是一个问题（即如果步骤 (2) 成为瓶颈），那么您必须避免使用反射并生成代码来直接设置属性。一些替代改进：

*   用于`System.CodeDom`生成包含代码的 C# 类，以根据`IDataReader`. 请注意，它会在后台`System.CodeDom`调用`csc.exe`编译器，因此您需要在启动时生成一次此代码并在每次调用时重新使用它。
*   用于`System.Reflection.Emit.DynamicMethod`生成设置属性的 IL 代码。运行时开销比 少`System.CodeDom`，但由于您生成的是原始 IL，因此编写和调试起来要困难得多。作为最后的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:12:27.497

这真的取决于你在做什么。我实现了一个对象/接口过程，在该过程中我创建了保存返回数据的信息对象。然后我使用一个接口`IFillable`或类似的东西将 DR 传递给对象，并且对象从 DR 进行水合。

这样我就避免了反射的需要，并且性能很棒。然后，我有一些用于`Fill`和的通用辅助方法`FillCollection`。

我的想法是基于[DotNetNuke](http://www.dotnetnuke.com)框架的 CBO 对象内部的东西。它还实现了反射方法，性能相当不错。

# css - 可变尺寸的 CSS 中心裁剪图像

> ID：812038
> 
> 赞同：3
> 
> 时间：2009-05-01T16:10:29.343
> 
> 标签：css, css-sprites

我正在尝试显示图像的裁剪中心区域并让它适用于不同尺寸的图像。

我成功地为包含图像的 div 设置了固定宽度并使用了 overflow:hidden 属性，这可以按照我想要的方式工作，只是它只显示图像的最左侧部分而右侧是隐藏的。

我想要的是显示图像的中心部分并隐藏图像的左侧和右侧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:21:54.293

我会采用使其成为背景图像的方法

```
.imghider {width:100px; background-image:url(./qed.jpg); background-position:center center;background-repeat:no-repeat;}

<div class="imghider">&nbsp;</div> 
```

至于不同的大小，您可以使用多个类或 CSS 表达式（或服务器端 css 生成）

我希望这有帮助。

# delphi - Delphi Search path vs Library Path vs Browsing Path

> ID：812042
> 
> 赞同：35
> 
> 时间：2009-05-01T16:11:00.810
> 
> 标签：delphi

In Delphi, I can include a folder's source code by adding it to the project Search Path, or adding it to the Library Path. The Search Path applies only to the current project, while the Library Path applies to any project opened with the IDE.

Other than that, is there any functional difference between the Search and Library paths?

My reason for asking: I have a folder X with source used by project A. When I include that folder under Project A's search path, it says it cannot find a specific file in that folder. When I include it under the Library path, then project A compiles fine.

Until now, I was always under the impression that the only difference was that one was project-specific, and the other was global.

While we're on the topic (and at the risk of making a fool of myself): What is the functional difference between "library path" and "browsing path"?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-01T16:29:43.493

As far as I know, browsing path is where the debugger should look for files when breaking/stepping into source files thats not in the library path.

Lets say that you have a thirdparty component that you use. You point the library path to the directory where the pre-compiled dcu-files of that component are. Your project will use these dcu-files when you compile. This is good, because it wont be recompiled every time you do a build.

But by including the compiled dcu files, you loose the possibility to debug the thirparty component. If you include the path to where the source files are in the browse path, the debugger will find the source, and allow you to step in to it.

The default settings for the vcl show this. In library path they have put $(BSD)\Lib, and in the browsing path they have put $(BDS)\SOURCE\WIN32...

Update: There are two different kind of search paths: Compiler search path and debugger search path. The first is there the compiler looks for files during compiling, and the second is where the debugger looks for source files during debugging.

The compiler will only find files in the Library path or the projects search path. The debugger will find identifiers in the compilers search path plus the browsing path, the debug source path for the project, and the global debug search path.

There should not be any difference in specifying things globally or pr project.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-20T21:53:50.530

Debugger will also find files in Library Path.

# entity-framework - 如何将实体框架与分层数据一起使用？

> ID：812046
> 
> 赞同：10
> 
> 时间：2009-05-01T16:12:03.427
> 
> 标签：entity-framework, hierarchical-data, user-defined-functions

我正在使用 sql server 中的大型分层数据集 - 使用标准的“EntityID，ParentID”类型的方法建模。整个树中大约有 25,000 个节点。

我经常需要访问树的子树，然后访问挂在子树节点上的相关数据。几年前，我基于表值函数构建了一个数据访问层，在给定子树的根节点的情况下，使用递归查询来获取任意子树。

我正在考虑使用实体框架，但我看不到如何查询这样的分层数据。AFAIK 在 Linq 中没有递归查询，我无法在我的实体数据模型中公开 TVF。

是继续使用存储过程的唯一解决方案吗？有没有其他人解决了这个问题？

澄清：树中的 25,000 个节点是指分层数据集的大小，与对象或实体框架无关。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T12:23:41.457

最好使用一种称为“嵌套集”的模式，它允许您在一个查询中获取任意子树。如果节点不经常被操作，这将特别有用：[在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/ "在 MySQL 中管理分层数据")。

在一个完美的世界中，实体框架将提供使用这种数据模式保存和查询数据的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T22:26:40.373

使用 Entity Framework 一切皆有可能，但你必须破解并削减你的方式。我目前正在处理的数据库有太多的“持有人表”，因为例如 Points 是与团队和用户共享的。用户和团队都可以拥有博客。

当您说 25 000 个节点时，您是指导航属性吗？如果是这样，我认为获取数据访问权限可能会很棘手。使用实体框架进行导航、搜索等并不难，但我倾向于在纸上建模，然后根据我在使用实体框架时的导航方式创建数据库。听起来你没有那个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:36:02.317

感谢这些建议。

我开始意识到，答案是重构数据库中的数据——要么按照 Georg 建议的嵌套集合的方式，要么可能是我刚刚遇到的传递闭包表。

这样，我希望获得两个主要好处：

a) 更快地查询任意子树

b) 一个不再需要递归查询的数据模型——所以也许可以将它放在实体框架容易到达的地方！

一个难题的正确答案往往不是回答它，而是做其他事情，这总是令人惊讶！

# sql - 为什么这个 INSERT with DATEDIFF 语句不能正常工作？

> ID：812047
> 
> 赞同：0
> 
> 时间：2009-05-01T16:12:10.277
> 
> 标签：sql, insert, datediff

```
INSERT INTO timecrunch.dbo.intervals (IntervalID, Duration) 
SELECT ixInterval, DATEDIFF(hour, dtStart, dtEnd) FROM fogbugz.dbo.TimeInterval
WHERE dtEnd is not NULL 
```

IntervalID 是一个 int，Duration 是一个浮点数

我正在尝试将所有每小时的持续时间放入 Duration 列......我假设即使它不到一个小时它也会使用一个分数，这就是我放一个浮点数的原因？

帮助。

PS：它运行良好，没有错误，但完成后，间隔表仍然是空的......我知道数据在 TimeInterval 表中......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:18:43.287

我不确定为什么您的数据没有显示，但 DATEDIFF 不会返回浮点数。要获得浮点数，您可能需要使用更小的时间单位并除以每分钟的单位数。例子：

```
DATEDIFF(second, dtStart, dtEnd) / (3600.0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T16:18:36.640

DATEDIFF 返回跨越的日期部分边界数的 Int。我希望你能得到持续时间的下限，除非从 Int 到 Float 的隐式转换存在问题。

发布收到的错误消息也很有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T16:20:59.507

要插入一小时的实际分数，请使用：

```
INSERT INTO timecrunch.dbo.intervals (IntervalID, Duration) 
SELECT 
  ixInterval, 
  DATEDIFF(mi, dtStart, dtEnd) / 60.0
FROM 
  fogbugz.dbo.TimeInterval
WHERE 
  dtEnd is not NULL 
```

DATEDIFF 总是返回一个 INT 值，而不是分数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T16:18:47.747

尝试使用 INSERT 位自行运行 SELECT，以检查您的查询是否实际返回了一些数据。

编辑：正如其他人所说，DATEDIFF 返回一个整数，而不是浮点数，但这不应阻止 INSERT 插入一些数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T16:17:12.090

首先，您从运行选择中得到什么结果？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T16:19:29.633

在 Sql Server DateDiff 中返回一个 int（[参见 MSDN](http://msdn.microsoft.com/en-us/library/aa258269(SQL.80).aspx)）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T16:20:50.537

DATEDIFF 将返回一个 int 而不是 float - 这是您遇到的问题吗？

# javascript - 在 jquery 中实现循环滚动

> ID：812049
> 
> 赞同：2
> 
> 时间：2009-05-01T16:12:40.493
> 
> 标签：javascript, jquery

我正在寻找一个 jquery 插件来模拟垂直选取框。我需要它来支持：

1.  滚动任何不透明（非结构化）的内容。没有 li，没有 div。用户甚至可以从 Word 中粘贴。
2.  自动恒定滚动速度。
3.  悬停时暂停。
4.  循环滚动 - 滚动到结束后，从头平滑继续。没有向后滚动，没有可见的跳跃。

我尝试了所有的代码、serialScroll、carousels 等......大多数都需要一些结构、列表、恒定宽度/高度的项目。他们还滚动完整项目（滚动、等待、滚动）。但最大的障碍是要求 4。没有人提供“假”尾巴来平滑重启滚动。

我错过了什么，还是我必须自己写这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T06:40:38.890

2个你想要的活生生的例子：

[http://www.learningjquery.com/2006/10/scroll-up-headline-reader](http://www.learningjquery.com/2006/10/scroll-up-headline-reader)

[http://woork.blogspot.com/2008/10/automatic-news-ticker-with-vertical.html](http://woork.blogspot.com/2008/10/automatic-news-ticker-with-vertical.html)

两者都是使用 jquery 编写的。这是你想要的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T13:48:41.257

我目前正在使用：http: [//jdsharp.us/jQuery/plugins/jdNewsScroll/1.1/](http://jdsharp.us/jQuery/plugins/jdNewsScroll/1.1/)

这似乎也符合您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T17:09:54.520

我会看看[微光](http://visitmix.com/lab/glimmer)。一种新的设计器工具，可帮助生成像这样的酷 UI 小部件所需的所有代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T11:20:25.507

你应该试试[http://flowplayer.org/tools/demos/scrollable/autoscroll.html](http://flowplayer.org/tools/demos/scrollable/autoscroll.html)

问题是它没有从结尾平滑滚动到开头，而是跳到开头...也许您可以根据需要编辑代码...

编辑：

--> [http://www.maaki.com/thomas/SmoothDivScroll/index.html](http://www.maaki.com/thomas/SmoothDivScroll/index.html)

它是一个使用 jQuery 进行自动滚动的小教程。Thr 问题是，它应该与 div 一起使用，并且只能水平工作。但是，如果您有一些 javascript 经验，那么更改代码以使其垂直滚动应该没有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T23:58:30.610

您可能会也可能无法使用[Cycle 插件](http://www.malsup.com/jquery/cycle/)来实现这一点。要么使用它令人印象深刻的 API，要么对其进行一些扩展。

# ruby - Ruby 可选参数

> ID：812058
> 
> 赞同：123
> 
> 时间：2009-05-01T16:16:41.980
> 
> 标签：ruby, optional-parameters

如果我这样定义一个 Ruby 函数：

```
def ldap_get ( base_dn, filter, scope=LDAP::LDAP_SCOPE_SUBTREE, attrs=nil ) 
```

我怎么能称它只提供前 2 个和最后一个 args？为什么不像

```
ldap_get( base_dn, filter, , X) 
```

可能或如果可能，怎么做？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-05-01T16:33:20.880

使用选项哈希几乎总是更好。

```
def ldap_get(base_dn, filter, options = {})
  options[:scope] ||= LDAP::LDAP_SCOPE_SUBTREE
  ...
end

ldap_get(base_dn, filter, :attrs => X) 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-05-01T16:24:02.087

这对于目前的 ruby​​ 是不可能的。您不能将“空”属性传递给方法。你能得到的最接近的是通过 nil：

```
ldap_get(base_dn, filter, nil, X) 
```

但是，这会将范围设置为 nil，而不是 LDAP::LDAP_SCOPE_SUBTREE。

您可以做的是在您的方法中设置默认值：

```
def ldap_get(base_dn, filter, scope = nil, attrs = nil)
  scope ||= LDAP::LDAP_SCOPE_SUBTREE
  ... do something ...
end 
```

现在，如果您按上述方式调用该方法，则行为将如您所愿。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-07-14T19:00:27.660

时间已经过去了，从 Ruby 版本 2 开始支持命名参数：

```
def ldap_get ( base_dn, filter, scope: "some_scope", attrs: nil )
  p attrs
end

ldap_get("first_arg", "second_arg", attrs: "attr1, attr2") # => "attr1, attr2" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T16:21:18.210

不可能按照您定义的方式进行`ldap_get`。但是，如果您`ldap_get`这样定义：

```
def ldap_get ( base_dn, filter, attrs=nil, scope=LDAP::LDAP_SCOPE_SUBTREE ) 
```

现在你可以：

```
ldap_get( base_dn, filter, X ) 
```

但是现在你有一个问题，你不能用前两个 args 和最后一个 arg 来调用它（和以前一样的问题，但现在最后一个 arg 不同了）。

这样做的理由很简单：Ruby 中的每个参数都不需要具有默认值，因此您不能按照您指定的方式调用它。例如，在您的情况下，前两个参数没有默认值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-12T12:05:00.090

1）你不能重载方法（[为什么ruby不支持方法重载？](https://stackoverflow.com/questions/9373104/why-does-ruby-not-support-method-overloading?lq=1)）那么为什么不完全编写一个新方法呢？

2）我使用 splat 运算符 * 解决了一个类似的问题，用于长度为零或更多的数组。然后，如果我想传递一个参数，我可以，它被解释为一个数组，但是如果我想在没有任何参数的情况下调用该方法，那么我不必传递任何东西。请参阅*Ruby 编程语言*第 186/187 页

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-28T18:53:47.133

最近我找到了解决这个问题的方法。我想在数组类中创建一个带有可选参数的方法，以保留或丢弃数组中的元素。

我模拟这个的方法是传递一个数组作为参数，然后检查该索引处的值是否为 nil。

```
class Array
  def ascii_to_text(params)
    param_len = params.length
    if param_len > 3 or param_len < 2 then raise "Invalid number of arguments #{param_len} for 2 || 3." end
    bottom  = params[0]
    top     = params[1]
    keep    = params[2]
    if keep.nil? == false
      if keep == 1
        self.map{|x| if x >= bottom and x <= top then x = x.chr else x = x.to_s end}
      else
        raise "Invalid option #{keep} at argument position 3 in #{p params}, must be 1 or nil"
      end
    else
      self.map{|x| if x >= bottom and x <= top then x = x.chr end}.compact
    end
  end
end 
```

用不同的参数尝试我们的类方法：

```
array = [1, 2, 97, 98, 99]
p array.ascii_to_text([32, 126, 1]) # Convert all ASCII values of 32-126 to their chr value otherwise keep it the same (That's what the optional 1 is for) 
```

输出：`["1", "2", "a", "b", "c"]`

好的，很酷，按计划工作。现在让我们检查一下，如果我们不传入数组中的第三个参数选项 (1) 会发生什么。

```
array = [1, 2, 97, 98, 99]
p array.ascii_to_text([32, 126]) # Convert all ASCII values of 32-126 to their chr value else remove it (1 isn't a parameter option) 
```

输出：`["a", "b", "c"]`

如您所见，数组中的第三个选项已被删除，因此在方法中启动了不同的部分并删除了所有不在我们范围内的 ASCII 值 (32-126)

或者，我们可以在参数中将值设为 nil。这看起来类似于以下代码块：

```
def ascii_to_text(top, bottom, keep = nil)
  if keep.nil?
    self.map{|x| if x >= bottom and x <= top then x = x.chr end}.compact
  else
    self.map{|x| if x >= bottom and x <= top then x = x.chr else x = x.to_s end}
end 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-11-09T13:50:30.150

有可能:)只需更改定义

```
def ldap_get ( base_dn, filter, scope=LDAP::LDAP_SCOPE_SUBTREE, attrs=nil ) 
```

到

```
def ldap_get ( base_dn, filter, *param_array, attrs=nil )
scope = param_array.first || LDAP::LDAP_SCOPE_SUBTREE 
```

范围现在将排在首位。当您提供 3 个参数时，您将分配 base_dn、filter 和 attrs 并且 param_array 将是 [] 当 4 个或更多参数时，param_array 将是 [argument1, or_more, and_more]

缺点是......解决方案不清楚，真的很难看。这是为了回答可以在 ruby​​ 中的函数调用中间省略参数:)

您必须做的另一件事是重写范围的默认值。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-03-09T09:49:00.280

您可以使用部分应用程序来做到这一点，尽管使用命名变量肯定会导致更易读的代码。John Resig 在 2008 年写了一篇关于如何在 JavaScript 中做到这一点的博客文章：http: [//ejohn.org/blog/partial-functions-in-javascript/](http://ejohn.org/blog/partial-functions-in-javascript/)

```
Function.prototype.partial = function(){
  var fn = this, args = Array.prototype.slice.call(arguments);
  return function(){
    var arg = 0;
    for ( var i = 0; i < args.length && arg < arguments.length; i++ )
      if ( args[i] === undefined )
        args[i] = arguments[arg++];
    return fn.apply(this, args);
  };
}; 
```

可能在 Ruby 中应用相同的原则（原型继承除外）。

# wpf - 窗口高度 =“自动”未按预期工作

> ID：812079
> 
> 赞同：236
> 
> 时间：2009-05-01T16:22:17.707
> 
> 标签：wpf

我想要做的是显示一个窗口，它没有明确地具有高度/宽度（两个值都被省略或设置为`Auto`）。我猜测窗口会通过自动计算所有包含的用户控件大小来找出它的大小，但这实际上不起作用！

相反，我得到一个大窗口，`Actualwidth`并且`Actualheight`值都设置为 512 (?!?!)

窗口声明：

```
<Window x:Class="Window3"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  Title="Window3" 
  Height="Auto">
<StackPanel>
    <Label>Window</Label>
</StackPanel>
</Window> 
```

通过以下方式将此窗口显示为对话框：

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles Button2.Click
    Dim dlg As New Window3
    dlg.ShowDialog()
End Sub 
```

有解决方案吗？我不想明确设置窗口的大小，因为表单中的许多控件将根据构造函数参数折叠，并且试图找到表单的实际大小会很棘手（而且很难看）。

* * *

## 回答 #1

> 赞同：441
> 
> 时间：2009-05-01T16:27:37.210

设置窗口的属性`SizeToContent="WidthAndHeight"`。这应该会有所帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-07-01T17:43:47.630

老问题，但更新的答案：

正如@Muad'Dib 在他的回答中建议的那样：

你应该设置`SizeToContent="WidthAndHeight"`.

如果窗口内容的大小增加超过屏幕大小，窗口可能会从屏幕溢出。所以，你必须考虑：

```
MaxWidth="600"
MaxHeight="400" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-08T18:37:57.890

那么你不能将窗口高度设置为自动，为此你可以使用一个小技巧，命名主主网格容器，将其高度设置为自动然后将窗口高度绑定到主网格的高度

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-05T20:19:07.903

您可以执行以下操作：

```
MaxWidth = SystemParameters.MaximizedPrimaryScreenWidth;
MaxHeight = SystemParameters.MaximizedPrimaryScreenHeight;
SizeToContent = SizeToContent.WidthAndHeight; 
```

Please note that using `SizeToContent` alone will work. However, if your content size is bigger than the screen the window will overflow beyond your screen but combining this with setting the `MaxWidth` and `MaxHeight` of the window to be as your screen will basically fit the window to contents up to the maximum of your screen.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-11-30T17:20:56.990

在加载了事件窗口的当前屏幕中设置大小

# c# - 如何将此 PHP 脚本转换为 C#？

> ID：812083
> 
> 赞同：0
> 
> 时间：2009-05-01T16:24:32.303
> 
> 标签：c#, php, asp.net, seo

我从这个问题中得到了以下代码：[清理字符串以放置在 URL 中的最佳方法是什么，例如 SO 上的问题名称？](https://stackoverflow.com/questions/539920/what-is-the-best-way-to-clean-a-string-for-placement-in-a-url-like-the-question)

```
$str = strtolower( 
  preg_replace( array('/[^a-z0-9\- ]/i', '/[ \-]+/'), array('', '-'), 
  $urlPart ) ); 
```

这段代码适用于我的 PHP，它只在一行中制作干净和 SEO 的 url，但我想在我的 ASP.NET(C#) 应用程序中使用相同的脚本。但不知道 C# 中这一行的代码是什么。任何人都可以将此 PHP 代码转换为 C# 函数。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:35:41.670

为简单起见，使用两个正则表达式替换调用可能是最简单的，尽管您*可以*`Replace`使用重载 with将其重写为一个`MatchEvaluator`（这会有点 hacky）。

```
using System.Text.RegularExpressions;

// ...

var str = Regex.Replace(Regex.Replace(urlPart, @"[^a-z0-9\- ]/i", ""), @"[ \-]+", "-").ToLower(); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:53:19.723

由于睡眠不足，我可能会错过一些东西..但你不能简单地这样做：

```
var myUrl = HttpUtility.UrlEncode(UrlToEncode); 
```

要进行破折号编码...

```
var myUrl = HttpUtility.EncodeUrl(UrlToEncode.Replace(" ", "-")); 
```

# python - 您将哪个版本的 Python（2.4、2.5、2.6、3.0）标准化用于生产开发工作（以及为什么）？

> ID：812085
> 
> 赞同：5
> 
> 时间：2009-05-01T16:25:21.007
> 
> 标签：python, standards, production, supervisord

在我们的团队中，我们主要从事搜索引擎架构和内容集成工作，并且大部分代码库都使用 Python。我们所有的构建工具和 Python 模块依赖项都在源代码控制中，因此可以检查它们并加载环境以供使用，而不管操作系统/平台如何，有点类似于[virtualenv](http://lucumr.pocoo.org/2008/7/5/virtualenv-to-the-rescue "虚拟环境")使用的方法。

多年来，我们一直在维护与 Python 2.3 兼容的代码库，因为我们使用的商业产品之一依赖于 Python 2.3。多年来，这导致了越来越多的问题，因为自 2004 年 2.3 版以来，更新的工具和库需要更新版本的 Python。

我们最近将我们的构建环境与商业产品环境的依赖解耦，并且可以使用我们想要的任何版本的 Python（或 Java）。自从我们将 Python 2.6 标准化为与以前版本向后兼容的最新版本 Python 以来，已经过去了大约一个月左右的时间。

Python 3.0 不是一个选项（目前），因为我们必须迁移过多的代码库才能使我们的构建和集成工具再次正常工作。

我们喜欢 Python 2.6 的许多新特性，尤其是改进的模块和类装饰器之类的东西，但是我们依赖的许多模块会导致 Python 2.6 解释器发出各种贬值警告。另一个我们感兴趣的用于管理 EC2 云集群节点的工具，[Supervisor](http://supervisord.org/ "导师")甚至无法在 Python 2.6 中正常工作。

现在我想知道我们现在是否应该在 Python 2.5 上标准化，而不是在生产环境工具的开发中使用 Python 2.6。我们想要/需要的大多数工具似乎都可以在 Python 2.5 中正常工作。在对 Python 2.6 功能或模块有很多依赖之前，我们正在尝试解决这个问题。

非常感谢！

-迈克尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T16:41:50.983

我不会因为弃用警告而放弃 2.6；这些会随着时间的推移而消失。（您`-W ignore`至少可以使用 Python 解释器的选项来防止它们被打印出来）但是如果您需要使用的模块实际上不适用于 Python 2.6，那将是保留 2.5 的正当理由。Python 2.5 现在被广泛使用，并且可能会在很长一段时间内使用（考虑一下 2.3 已经持续了多长时间！），所以即使你使用 2.5，你也不会被迫升级一段时间。

我的所有开发工作都使用 Python 2.5，但这只是因为它恰好是 Gentoo (Linux) 的包存储库中可用的版本。当 Gentoo 维护者声明 Python 2.6 “稳定”`*`时，我将切换到它。当然，这种推理不一定适用于你。

`*`Python 2.6 实际上是稳定的，它在 Gentoo 中没有这样声明的原因是，Gentoo 依赖于其他程序，这些程序本身依赖于 Python，并且尚未升级到与 2.6 一起使用。同样，这种推理可能不适用于您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T16:44:25.470

我公司在2.5标准化。像你一样，我们不能切换到 3.0 有一百万个原因，但我非常希望我们可以升级到 2.6。

每天都在做编码，我会浏览文档，我会找到我想要的模块或函数，但是它会有一个小注释：2.6 版中的新功能

我会说使用最新版本，如果您弹出折旧警告（可能很少），那么只需寻找更好的方法来做到这一点。总体而言，您的代码使用 2.6 会更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T16:43:31.697

对我来说，坚持使用 python 2.5+ 最重要的是因为它正式支持`ctypes`，这改变了许多插件系统。

尽管您可以找到与 2.3/2.4 一起使用的 ctypes，但它们并未正式捆绑。

所以我的建议是2.5。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T16:46:51.610

我们现在坚持使用 2.5.2。我们的技术堆栈以 Django 为中心（但我们还有十几个其他零碎的东西。）所以我们与他们的工作保持密切联系。

我们必须回到 docutils 到 0.4，这样它才能与 epydoc 3.0.1 一起使用。到目前为止，这还不是一个大问题，但它可能——在某个时候——让我们重新考虑我们对 epydoc 的使用。

2.6 升级是我们开发计划的一部分。我们有预算，但现在没有固定的时间表。

同样，3.0 升级也是我提醒人们的事情。我们必须为此做预算。除非 Django 升级到 3.0，否则我们今年不会这样做。我们明年可能会这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T17:27:00.063

我认为最好的解决方案是放弃对完全统一的希望，尽管有一个共同的环境是需要争取的。您将始终面临版本问题，例如在升级到下一个最佳解释器版本时。

因此，您可以通过仔细查看发布管理来解决此问题，而不是根据每个问题来处理它。

与其发布源代码，不如选择依赖于平台的二进制文件（源代码分发除外）。

所以你要做的是定义一些受支持的 CPU，例如：x86-32、x86-64、sparc

那么哪些操作系统：Linux、Windows、Solaris、FreeBSD

对于每个操作系统，您都支持它们的许多主要版本。

下一步是为所有这些提供二进制文件。

是的，确实这将需要相当多的基础设施投资并从您的存储库设置自动构建（您确实拥有它们吗？）。

优点是您的用户只需安装“一个”东西，您可以轻松切换版本甚至混合版本。实际上，您甚至可以通过这种方法使用不同的编程语言，而不会过多地影响您的发布管理。

# xml - 如何在没有特定属性的所有元素上使用 XPath 进行过滤

> ID：812090
> 
> 赞同：21
> 
> 时间：2009-05-01T16:27:06.153
> 
> 标签：xml, xpath

我的 XPath 有点生疏了……假设我有这个简单的 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<States xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<States>
<StateProvince name="ALABAMA" abbrev="AL" />
....
<StateProvince name="AMERICAN SAMOA" abbrev="AS" territory="true"  />
</States>
</States> 
```

我想运行一个简单的 XPath 查询来解析所有真实的状态（所以不要拉入区域 = true 的状态）。我试过 \StateProvince[@territory!='true'] 但我得了零。其他变体似乎失败了。这似乎应该很简单，但找不到我想要的。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-01T16:49:20.343

**一个选择所需元素的 XPath 表达式**：

        **`/*/States/StateProvince[not(@territory='true')]`**

**请注意**，*必须**`//`**尽可能避免使用缩写，因为它会导致整个文档（以上下文节点为根的子树）被扫描*。

**上面的 XPath 表达式** 通过考虑最初提供的 XML 文档的结构来避免使用**缩写。****`//`**

 ***只有当 XML 文档的结构完全未知（并且 XPath 表达式旨在用于许多结构未知的 XML 文档）时，才应**`//`**考虑使用缩写*。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T16:33:01.240

你非常接近：

```
//StateProvince[not(@territory) or @territory != 'true'] 
```

应该得到你想要的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T16:34:53.480

这应该有效：

```
//StateProvince[not(@territory='true')] 
```

# sharepoint - 在导入/导出中包括 Sharepoint /pages/

> ID：812091
> 
> 赞同：0
> 
> 时间：2009-05-01T16:27:24.980
> 
> 标签：sharepoint, import, export

我和我的团队在我们的本地计算机上使用多个虚拟机来开发一个 Sharepoint 站点，由于这确实不受支持，我们遇到了问题：

我正在尝试通过以下命令使用内部导入/导出功能：

-- 导出 -- stsadm.exe -o 导出 -url [http://localhost/](http://localhost/) -nologfile -haltonwarning -haltonfatalerror -overwrite -filename ClintonAWAS.sharepoint

-- 导入 -- stsadm.exe -o 导入 -url [http://localhost/](http://localhost/) -nologfile -haltonwarning -haltonfatalerror -filename CoreyAWAS.sharepoint

除了一个重要的细节：/pages/ 虚拟目录中的 .aspx 文件外，一切似乎都已正确完成，包括 DB 连接。到目前为止，我们不得不在设计器中逐个文件手动导出/导入它们。

难道我做错了什么？还有另一种方法可以做到这一点吗？任何人都可以提出任何建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T03:21:04.750

我通常会避免在开发人员之间进行这种站点复制——带有源代码控制的解决方案包项目效果更好——但如果你被这种环境所困扰，你可能会发现内容部署向导非常有用。

要检查的另一件事是页面是否已发布 - 使用没有发布版本的页面复制站点可以获得有趣的结果。

# signal-processing - 重定时如何在脉动阵列中工作？

> ID：812097
> 
> 赞同：1
> 
> 时间：2009-05-01T16:27:52.453
> 
> 标签：signal-processing

重定时如何在脉动阵列（用于信号处理器）中工作？我读到有一些使用负延迟的概念，但是延迟怎么可能是负的，如果这只是一个抽象，那么它有什么帮助呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T22:57:16.480

重定时的基本模型是，寄存器的波阵面通过一堆组合逻辑互连，并且通过在电路中的不同点重新定位寄存器来改善结果电路的时序或面积，使得通过逻辑的每条路径仍然通过相同数量的寄存器。举个简单的例子，假设你有一个与门馈送寄存器，到寄存器输入的最长路径是 12ns，从寄存器输出的最长路径是 6ns，与门的延迟是 3ns，并且您需要将时钟周期时间降低到 10ns。您可以通过删除寄存器并用两个寄存器替换它来实现这一点，一个在与门的每个输入端，由与原始寄存器相同的时钟计时。现在您已将最长输入路径减少到 9ns，将输出路径扩展到 9ns，并满足您的时钟周期目标。实际上，您已将 -3ns 添加到寄存器的有效到达时间（并将 +3ns 添加到有效输出时间）。

Leiserson 和 Saxe 关于重定时的原始论文的修改版本可[在此处](http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-13.html)获得。 [维基百科](http://en.wikipedia.org/wiki/Retiming)有一篇关于这个主题的不错的文章，虽然很短，但有一些链接。如果您可以访问 IEEE Xplore 或 ACM 数字图书馆，搜索设计自动化会议或计算机辅助设计国际会议的论文集以寻找重定时应该会产生大量文章 - 这多年来一直是一个活跃的研究领域.

# asp.net - ASP.NET MVC：如何查看 SaveChanges 执行的查询（在 ADO.NET 实体数据模型上）

> ID：812099
> 
> 赞同：1
> 
> 时间：2009-05-01T16:28:11.687
> 
> 标签：asp.net, asp.net-mvc, ado.net-entity-data-model

尝试向数据库添加一些项目时，出现此错误：

> 用户代码未处理 UpdateException
> *更新条目时发生错误。有关详细信息，请参阅 InnerException。*

InnerException 包含以下内容：

> {“列数与第 1 行的值数不匹配”}

我看不到我要添加的对象有任何问题，所有必需的值都已填充。
有没有办法查看导致问题的查询？

方法的代码（如果需要）：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult LaadVerrichtingenIn() {
        int[] intArray = Array.ConvertAll<String, int>(Request.Form["selectedObjects"].Split(','), new Converter<String, int>(Convert.ToInt32));
        List<Verrichting> gekozenVerrichtingen = new List<Verrichting>();

        foreach(int i in intArray){
            base._entities.AddToVerrichtingSet(((Dictionary<int, Verrichting>)Session["ingelezenVerrichtingen"])[i]);
            gekozenVerrichtingen.Add(((Dictionary<int, Verrichting>)Session["ingelezenVerrichtingen"])[i]);
        }
        Session["ingelezenVerrichtingen"] = null;
        base._entities.SaveChanges(); //Exception occurs here

        return View("IngeladenVerrichtingen");
    } 
```

base._entities 是一个 ADO.NET 实体数据模型。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:36:53.243

我不确定是否有使用 Entity Framework 的“更简洁”的方法来执行此操作，但如果您使用的是 SQL Server，那么我通常会使用[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms187929.aspx)来读取针对服务器执行的查询。如果您使用的是不同的数据库，那么可能会有一个等价的数据库——无论如何，如果您让我们知道，它可能会有所帮助。

如果您使用的是 MySQL > 5.0.37，它具有新的[查询分析器](http://dev.mysql.com/tech-resources/articles/using-new-query-profiler.html)功能 - 这应该能够向您显示正在发送的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:29:13.193

如果您使用的是 SQL Server，SQL Server Profiler 将可以正常工作。在实体框架中，您可以使用[ToTraceString](http://msdn.microsoft.com/en-us/library/bb896348.aspx)方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-19T20:23:17.587

我刚刚在使用实体框架和 MySQL 插入数据时遇到了同样的问题。我的直觉是，因为我使用的是**双精度**值，所以小数点分隔符“，”被误解为字段分隔符。我升级到连接器版本 6.1.0，但仍然没有运气。也许这也发生在你的情况下。

查看[此](http://bugs.mysql.com/bug.php?id=44455)错误报告。

顺便说一句，我发现以下代码行可以解决该问题：

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US"); 
```

# java - 检查系统是否有 jre (windows) 的简单防弹技术

> ID：812100
> 
> 赞同：0
> 
> 时间：2009-05-01T16:28:21.203
> 
> 标签：java, windows, cmd

对不起，我的新手问题：P 如果我在 Windows 系统上的 cmd 中提示“java -version”，我是否*保证**如果我没有收到任何错误*，系统将能够运行 .jar 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T16:37:51.353

我想检查 JRE 的唯一保证方法是尝试运行一个小型 Java 程序。

或者甚至可能不是——我想可以想象一个系统可能只安装了 Java 标准库的一部分，在这种情况下，一个小的测试 JAR 可能工作正常，但一个完整的程序可能不行。虽然我无法想象为什么有人会费尽心思设置这样的系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:56:21.983

从命令行您应该能够调用“java --version”，如果未安装 java 或当前安装的版本信息将返回错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T16:32:19.290

好吧，显然不是。您可以在 PATH 中放置一个名为 java.bat anyware 的空文件，例如 C:\Windows\System32。调用“java”不会产生任何错误，但这并不意味着安装了 JRE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T19:52:33.333

为什么不运行一个小类文件，它将一个值写入一个文件然后检查？如果它失败了，它就不起作用。

一个好的值可能是 java.version 系统属性的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T19:54:14.483

在 Windows 上，您可以在 HKLM\SOFTWARE\JavaSoft\Java Plug-in 中检查注册表。从那里开始，每个子项都是一个已安装的 JRE。

**编辑**这是 C# 代码，它将返回一个包含已安装 JRE 的字符串数组

```
public string[] GetInstalledJavas() {
        // hold the registry subkeys that list the installed JRE's
        string[] jres = null;
        try {
            RegistryKey myKey = Registry.LocalMachine;
            myKey = myKey.OpenSubKey(@"SOFTWARE\JavaSoft\Java Plug-in"); // read-only
            jres = myKey.GetSubKeyNames();
        } catch (Exception myException) {
            Console.Writeline(myException.ToString());
        }
        return jres;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T19:25:36.660

我实际上建议，如果您只关心检查 Windows 机器，检查注册表以获取 JNLP 的处理程序......这应该保证存在相对较新的 JRE。

# batch-file - 批量目录名称

> ID：812102
> 
> 赞同：0
> 
> 时间：2009-05-01T16:29:50.343
> 
> 标签：batch-file

如何将目录名称存储在批处理文件内的变量中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T16:32:04.813

```
set dirname=c:/some/folder

echo %dirname%

REM retrieve the last letter of the folder 
REM and save it in another variable

set lastLetter=%dirname:~-1%

echo %lastLetter% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:43:23.553

要返回存储批处理文件的目录，请使用 %~dp0

%0 是批处理文件的完整路径，

```
set src= %~dp0
echo %src% 
```

当我期望某些文件与我的批处理文件相关时，我使用了这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T16:47:34.153

没有更多的精度，很难帮助你......

也许你想要当前目录？

```
set name=%CD%
echo %name% 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T16:49:04.650

使用**设置**命令。

例子：

```
rem Assign the folder "C:\Folder1\Folder2" to the variable "MySavedFolder"
set MySavedFolder=C:\Folder1\Folder2

rem Run the program "MyProgram.exe" that is located in Folder2
 %MySavedFolder%\MyProgram.exe
rem Run the program "My Second Program.exe" that is located in Folder 2 (note spaces in filename)
"%MySavedFolder%\My Second Program.exe"
rem Quotes are required to stop the spaces from being command-line delimiters, but the command interpreter (cmd.exe) will still substitute the value of the variable. 
```

要删除变量，请不为名称分配任何内容：

`set MySavedFolder=`

由于您位于批处理文件中，因此我建议您在文件末尾使用**setlocal**和**endlocal来围绕您的变量使用；**这使您的环境变量成为批处理文件的本地变量，并且不会污染全局环境命名空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-03T03:19:03.040

允许脚本确定其父文件夹目录名称：

```
@echo off
::setlocal enableextensions,enabledelayedexpansion
SET CDIR=%~p0
SET CDIR=%CDIR:\= %
FOR %%a IN (%CDIR%) DO (
  SET CNAME=%%a
)
echo %CDIR%
echo %CNAME%
pause 
```

或者，更好的是：

```
@echo off
::setlocal enableextensions,enabledelayedexpansion
SET CDIR=%~p0
SET CDIR=%CDIR:~1,-1%
SET CDIR=%CDIR:\=,%
SET CDIR=%CDIR: =_%
FOR %%a IN (%CDIR%) DO SET "CNAME=%%a"
echo %CDIR%
SET CNAME=%CNAME:_= %
echo %CNAME%
pause 
```

# c# - 以编程方式导入带有私钥的证书

> ID：812105
> 
> 赞同：12
> 
> 时间：2009-05-01T16:31:20.883
> 
> 标签：c#, .net, ssl, ssl-certificate

我正在尝试在 C# 应用程序中使用 HttpListener 类来让迷你网络服务器通过 SSL 提供内容。为此，我需要使用 httpcfg 工具。我有一个带有我的公钥和私钥对的 .pfx 文件。如果我使用 mmc 手动将此密钥对导入本地机器存储，则一切正常。但是，如果我使用 X509Store 类以编程方式导入此密钥对，我将无法连接到我的迷你网络服务器。请注意，在这两种方法中，证书都被导入到 LocalMachine 中的 MY 商店。奇怪的是，一旦我以编程方式导入它，我就可以在 mmc 中查看证书，当我查看它时，UI 表明私钥也可用于此证书。

再深入一点，我注意到当我手动导入密钥对时，我可以看到一个新文件出现在 中`C:\Documents and Settings\All Users\Application Data\Microsoft\Crypto\RSA\MachineKeys`，但是当我以编程方式导入时没有出现。在相关说明中，当我删除手动导入的证书时，它不会从前面提到的目录中删除相应的私钥文件。

最终，我的问题是：当我以编程方式将证书添加到商店时，私钥存储在哪里，为什么 HttpListener 类 (HttpApi) 无法访问它？

请注意，这个问题有点相关，但我认为权限不是问题，因为这一切都是作为同一个 Windows 用户完成的： [How to set read permission on the private key file of X.509 certificate from .NET](https://stackoverflow.com/questions/425688/how-to-set-read-permission-on-the-private-key-file-of-x-509-certificate-from-ne)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-01T17:24:19.667

好的，我想通了。它与证书对象的密钥存储参数有关。对于遇到此问题的其他任何人，请确保使用and标志构造`X509Certificate2`要添加到存储中的对象。这将强制私钥保留在( wraps this) 所需的机器密钥集位置。`X509KeyStorageFlags.PersistKeySet``X509KeyStorageFlags.MachineKeySet``HttpApi``HttpListener`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:07:52.310

这是 2 路 SSL 吗？如果是，那么您是否发送了在您的机器上生成的 SSL 证书请求文件？此证书请求文件将用于创建 SSL，它们一起形成一个公钥私钥对。

您是否还尝试为用于运行 Web 应用程序的用户帐户分配证书权限？您可以使用 Microsoft WSE 3.0 工具来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T18:00:06.927

不完全是您问题的答案，但在这里供其他人参考：

[这](http://msdn.microsoft.com/en-us/magazine/cc163531.aspx)是一个 MS 聊天的链接，它提供了示例 C# 代码来执行 httpcfg 所做的工作，从而消除了对部署工具的需要。

# visual-studio - 将 Visual Studio 中的数字与正则表达式匹配

> ID：812107
> 
> 赞同：4
> 
> 时间：2009-05-01T16:32:00.617
> 
> 标签：visual-studio, regex

如何在 Visual Studio 中匹配数字？

我的第一个猜测是`\d`，但它对我不起作用。

其次，Visual Studio 中是否有特殊字符列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T16:37:06.893

这是它识别的正则表达式。阅读Jeff Atwood关于[Visual Studio 正则表达式](http://www.codinghorror.com/blog/archives/000633.html)的这篇精彩文章。

[![替代文字](https://i.stack.imgur.com/R7R8Y.png)](https://i.stack.imgur.com/R7R8Y.png)
[（来源：[codinghorror.com](http://www.codinghorror.com/blog/images/visual-studio-2005-find-dialog-builder.png)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T16:35:43.963

根据[Visual Studio 正则表达式的 MSDN 文档](http://msdn.microsoft.com/en-us/library/2k3te2cs.aspx)，它是`:d`.

还有`:z`一个匹配一个或多个数字，即用于匹配一个整数。

是的，[VS 正则表达式很奇怪](http://www.codinghorror.com/blog/archives/000633.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T16:33:21.067

如果您尝试它可能会起作用`[0-9]`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T16:34:46.790

好吧，假设您只需要匹配字面上的数字，您可以使用**[0-9]+之类的范围**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T16:35:11.733

查找框右侧有一个小下拉菜单，显示 VS 查找实用程序中使用的正则表达式符号。这是指向右边的大箭头。

您可以将 :z 用于数字（并确保您选中了正则表达式复选框:)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T16:35:21.280

[*正则表达式 (Visual Studio)*，Visual Studio 2005](http://msdn.microsoft.com/en-us/library/2k3te2cs(VS.80).aspx) (MSDN) 声明它是`:d`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-27T12:36:06.273

如何匹配数字取决于 Visual Studio ¹的版本：

*   `\d`将在[Visual Studio 2012](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2012)及更高版本中工作。这些版本的 Visual Studio 使用与 .NET Framework 正则表达式相同的语法。

*   `:d`将在[Visual Studio 2010](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2010)及更早版本（Visual Studio .NET 2003、Visual Studio .NET (2002)、[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)、[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)和[Visual Studio 2010](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2010)）中工作

至于第二个问题，*[在 Visual Studio 中使用正则表达式中](http://msdn.microsoft.com/en-us/library/2k3te2cs.aspx)*有一个特殊字符列表（针对新语法和旧语法）。

^([1](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2012) 在 Visual Studio (MSDN)*[中使用正则表达式](http://msdn.microsoft.com/en-us/library/2k3te2cs.aspx)*)

# vb.net - 将 OpenNetCF GetSignatureEx 转换为桌面上的位图

> ID：812125
> 
> 赞同：0
> 
> 时间：2009-05-01T16:35:31.640
> 
> 标签：vb.net, compact-framework, opennetcf, smart-device-framework

我有一个 SQLite 数据库，它在手持设备上运行，它使用在 Windows Mobile 6.1 下运行的 OpenNetCF 的智能设备框架 2.1 来捕获签名。使用 GetSignatureEx 方法从 Signature 控件捕获签名并将其存储在数据库中。

我现在要做的是在桌面上重构签名，但是桌面没有类似的控件。我看了看数据，它看起来像一堆向量，这就解释了为什么数据如此紧凑。

有谁知道如何使用 VB.NET 将数据转换为桌面上的位图。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-03T20:58:59.127

在 OpenNetCF 论坛上找到了我想要的东西。该代码最初是用 C# 编写的，但很快就将其转换为 VB.NET。这段代码已经在 OpenNetCF 框架的 2.0 和 2.1 版本上进行了测试，但它显然可以与 1.4 版本一起使用。科林

```
Public Function GetSignature(ByVal arrsig As Byte(), ByVal backcolor As System.Drawing.Color)
    Dim pic As System.Windows.Forms.PictureBox
    Dim word As Integer
    Dim lngIndex As Integer
    Dim lngPointsToRead As Integer = 0
    Dim lngCurrX As Integer = -1
    Dim lngCurrY As Integer = -1
    Dim lngPrevX As Integer = -1
    Dim lngPrevY As Integer = -1
    Dim lngWidth As Integer = 1
    Dim lngHeight As Integer
    Dim bit As New System.Drawing.Bitmap(1, 1)
    Dim g As Graphics = Graphics.FromImage(bit)
    pic = New picturebox()
    Dim blackpen As New Pen(Color.Black)
    If arrsig.Length < 3 Then
        Return Nothing
    End If
    word = arrsig(0)
    word = word + System.Convert.ToInt32(arrsig(1)) * 256
    lngWidth = word
    word = arrsig(2)
    word = word + System.Convert.ToInt32(arrsig(3)) * 256
    lngHeight = word
    bit = New Bitmap(lngWidth, lngHeight)
    g = Graphics.FromImage(bit)
    g.Clear(backcolor)
    lngIndex = 4
    While (True)
        If (lngIndex >= arrsig.Length) Then
            Exit While
        End If
        If (lngPointsToRead = 0) Then
            word = arrsig(lngIndex)
            lngIndex = lngIndex + 1
            word = word + System.Convert.ToInt32(arrsig(lngIndex)) * 256
            lngPointsToRead = word
            lngPrevX = -1
            lngPrevY = -1
        Else
            If (lngCurrX = -1) Then
                word = arrsig(lngIndex)
                If (lngWidth > 255) Then
                    lngIndex = lngIndex + 1
                    word = word + System.Convert.ToInt32(arrsig(lngIndex)) * 256
                End If
                lngCurrX = word
            ElseIf (lngCurrY = -1) Then
                word = arrsig(lngIndex)
                If (lngHeight > 255) Then
                    lngIndex = lngIndex + 1
                    word = word + System.Convert.ToInt32(arrsig(lngIndex)) * 256
                End If
                lngCurrY = word
                lngPointsToRead = lngPointsToRead - 1
                If (lngPrevX <> -1) Then
                    g.DrawLine(blackpen, lngPrevX, lngPrevY, lngCurrX, lngCurrY)
                End If
                lngPrevX = lngCurrX
                lngPrevY = lngCurrY
                lngCurrX = -1
                lngCurrY = -1
            End If
        End If
        lngIndex = lngIndex + 1
    End While
    pic.Image = bit
    Return pic.Image
End Function 
```

# c# - 在 ASP.NET 中使用类的方法是什么？

> ID：812132
> 
> 赞同：0
> 
> 时间：2009-05-01T16:36:31.543
> 
> 标签：c#, .net, asp.net, class

在我的 asp.net 网络应用程序中。我在命名空间下有三个类（在 app_code 文件夹内）`WPP`，如下所示：

```
1\. wpp_Common
2\. wpp_SQL
3\. wpp_Admin 
```

所有这些类都包含不同的功能，我在我的应用程序中使用它们来完成不同的任务。例如，`wpp_common`包含一个使我的 URL 进行 SEO 的函数，并`wpp_SQL`具有一些我用来从数据库中获取详细信息的函数。

现在，我在不同的网页网页和网页控件中使用这些类。为了使用这些类，我正在使用它们的页面上创建所有三个类的实例。

```
protected WPP.wpp_Common ObjCommon = new WPP.wpp_Common();
protected WPP.wpp_SQL ObjSQL = new WPP.wpp_SQL();
protected WPP.wpp_Admin ObjAdmin = new WPP.wpp_Admin(); 
```

所以，我想知道，这是通过在每个页面上创建单独的实例来访问我的类的更好且唯一的方法，这种方法是否有任何性能限制。

或者是否有更好和更合乎逻辑的方式从 ASP.net 网页和 Web 控件访问我的类。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:42:25.507

如果这些类没有封装任何可变的东西，那么将关键方法设为静态可能是值得的。然后，您甚至不需要该类的实例。这似乎对您的 SEO 课程有意义。您可能需要共享实例的 SQL 类，因为它可能包含对某些 SQL 连接/类的引用，但这也可能是静态方法中的参数。

不过，在我看来，你正在做的事情还可以。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-01T16:49:09.797

真正的答案归结为课程的复杂性。如果您的类是轻量级的并且初始化开销较低，那么您可能每次都可以实例化对象。（哎呀，即使是 ASP.NET 运行时每次都会在经典 ASP.NET 中创建一个新的页面对象实例 - 不确定 MVC）。

但是，如果您的对象具有非平凡的初始化时间（在构造函数中或在第一次方法调用时进行密集处理），那么您可能需要查看两个选项：

一）在会话中存储对象 - 在这里要小心，因为您的对象可能会根据后端会话存储（内存，sql等）而表现不同。

```
MyHeavyObj obj = (MyHeaveyObj) Session["cachedObj"];

if (obj == null)
{
    obj = new MyHeavyObj();
    obj.Init();
    Session["cachedObj"] = obj;
}

obj.DoSomething(); 
```

二）编写您自己的 Windows 服务，通过远程处理为您的对象提供服务并在内部处理初始化。这里的缺点是您需要确保您的服务随着流量的增长而扩展。

```
MyHeavyObj obj = GetHeavyObjViaRemoting();

obj.DoSomething(); 
```

# apache-flex - Flash 与 Flex

> ID：812133
> 
> 赞同：40
> 
> 时间：2009-05-01T16:36:40.763
> 
> 标签：apache-flex, flash, flex3, comparison

我尝试到处寻找使用 Flex 与 Flash 的优缺点的简明列表。

来自编程背景，我非常喜欢 Flex。它很容易上手，而且既然它可以使用 flash 类，我为什么要使用没有 flex 的 Flash 呢？

**柔性：**

优点：

*   有利于 RIA 开发
*   提供许多开箱即用的用户输入选项
*   构建布局系统
*   MXML 对于非程序员来说更容易
*   您可以快速组合组件以创建小型应用程序
*   由于其模块化特性，组件可以在大型项目中提供优势。
*   可以用linux开发
*   有一个很好的组件生命周期用于验证等。

缺点：

*   增加 .swf 的大小
*   自定义组件的外观可能需要比预期更长的时间，具体取决于您正在寻找的视觉风格
*   当您发现您需要一个不存在的自定义组件时，您可能需要返回 Flash 进行真正的编程工作和组件的打包
*   Flex 的“灵活性”意味着您将阅读大量文档
*   Flex 框架中的错误
*   您最终将需要与 Flex 框架的架构妥协

**闪光**

优点：

*   适合制作电影/动画
*   时间线可以更容易让设计师/动画师概念化
*   从头开始工作时，提供了大量的控制。
*   对于有编程背景的人来说更容易
*   你可以编程任何你喜欢的东西；不妥协于现有框架

缺点：

*   仅提供开箱即用的基本用户输入（文本框）。
*   时间线对于程序员来说可能是令人生畏的（尽管你可以放心地忽略它）
*   某些类型的应用程序的开发将比使用 Flex 慢
*   不能用linux开发
*   用户输入验证必须全部在代码中处理。没有内置验证。
*   需要实现自己的布局系统

如果我错过了到目前为止所说的任何内容，请纠正我。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T16:39:40.520

Flash 和 Flex 都使用相同的底层渲染引擎，只是前端不同。Flash 更适合制作电影和动画。Flex 更适合应用程序开发。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-02T12:46:30.637

从程序员的角度来看，Flash 和 Flex 之间的最大区别不在于您使用哪种 IDE/应用​​程序进行编程，而在于您是仅使用 ActionScript (AS) 进行编程，还是使用 Flex 框架和 MXML 来编写您的应用程序。

我会说纯 ActionScript 更适合编程（您使用 Flash IDE 还是 Flex IDE 无关紧要），而 MXML 更适合非程序员组合在 AS 中编程的组件。

我会将这些优点/缺点添加到您的列表中：

**柔性：**

优点：

*   非程序员更容易进入应用程序开发
*   您可以快速组合组件以创建小型应用程序
*   组件可以在大型项目中提供优势

缺点：

*   自定义组件的外观可能需要**比**预期更长的时间，具体取决于您正在寻找的视觉风格
*   当您发现您需要一个不存在的自定义组件时，您可能需要返回 Flash 进行真正的编程工作和组件的打包
*   Flex 的“灵活性”意味着您将阅读*大量*文档
*   Flex 框架中的错误
*   您最终将需要与 Flex 框架的架构妥协

**Flash（或 ActionScript 项目模式下的 Flex IDE）：**

优点：

*   对于有编程背景的人来说更容易；）
*   你可以编程任何你喜欢的东西；不妥协于现有框架

缺点：

*   时间线对于程序员来说可能是令人生畏的（尽管你可以完全放心地忽略它）
*   某些类型的应用程序的开发将比使用 Flex 慢

简而言之：为正确的任务选择正确的工具。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T16:40:33.530

Flex 是一个用 ActionScript3 编写的代码库，因此它为 Flash 添加了许多功能和类似标准库的东西。缺点是它是包含在您的应用程序中的大量代码。如果您在应用程序中使用任何 Flex，SWF 的下载大小会增加 100 的 K。

如果您的应用程序有任何类型的用户界面小部件，那么您几乎必须使用 Flex，因为 Flash 本身只有文本框等最基本的东西。Flex 有一个完整的 XML GUI，包括布局、数据绑定和 XML 设置等。

在闪存中这样做，您最终不得不从头开始编写列表框之类的东西......

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-06T19:43:44.123

在我看来，Flex 框架最重要的特性是组件生命周期，它为属性、组件大小和分层渲染的验证/无效提供了一个非常优雅的模型。

对开发人员的好处是它为业务逻辑和渲染创建了离散的应用程序阶段，避免了昂贵的几何和渲染代码，直到绘制框架之前的最后一刻。

这是一个非常好的演示文稿，解释了它是如何工作的：

[http://tv.adobe.com/#vi+f15384v1002](http://tv.adobe.com/#vi+f15384v1002)

该模型设计得非常好，以至于在大多数 Flex 开发过程中，当您使用框架默认组件和容器时，组件生命周期几乎完全不可见。当您开始开发自己的组件时，您只需要了解内部工作原理。

在 Flash 环境或纯 Actionscript 中进行开发，您不会得到任何这些。任何开发纯 AS3 应用程序的人要么需要**非常**仔细地编码以将业务逻辑与渲染分开，要么会遭受性能严重下降的困扰。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-01T16:39:47.057

> [...] 为什么我要使用没有 flex 的 Flash？

Flex 是一种新产品，而 Flash 在 Macromedia 时代就已经存在。设计师、动画师和大多数没有受过编程教育的人可能会发现 Flash 比大多数其他此类解决方案更容易掌握。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-01T16:38:46.157

目标不同。Flex 更专注于程序员，而 Flash 对艺术家/网页设计师更友好。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-01T16:39:27.370

Flash 是（通常）用于创建动画和在时间轴上运行良好的东西的 IDE。

Flex 更适合创建交互更类似于桌面的 Internet 应用程序。

为什么要使用闪存？好吧，当然，如果您需要做一些更具体地附加到时间线的事情！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T16:43:31.213

我认为 Flex 更像是一种用于执行 RIA 应用程序的解决方案，您需要开发基于应用程序的解决方案。使用 Flex 可以获得很多开箱即用的东西，但在文件大小、粒度等方面也需要付出代价。

另一方面，如果您正在开发完全自定义的解决方案，例如游戏，那么 Flash 可能是您的最佳选择，因为您可以从空白画布重新开始。许多人仍然使用 Flash，因为他们不需要 Flex 平台的所有基于应用程序的花里胡哨。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-06T19:14:21.497

我喜欢 Flash 的自由，在 Flash 中嵌入资源非常简单，在 Flex 中做起来有点混乱。

我喜欢 flex 的一件事是能够以最小的努力制作流畅的应用程序。在 Flash 中这将永远持续下去。

您可以在 flex 中执行的任何操作都可以在 flash 中执行，但可能需要更长的时间才能完成。你不能在 flex 中做所有你可以在 flash 中做的事情。

Flex 为您处理所有 UI 编程，让您专注于业务逻辑，而使用 Flash，您将花费大部分时间来编程 UI。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-06T19:54:41.603

您可以在 Linux 下轻松开发 Flex 应用程序，但使用 Flash 则无法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-20T07:56:29.817

这里没有建议的另一个解决方案是同时使用它们。[您可以使用ContainerMovieClip](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/flash/ContainerMovieClip.html)将 flex 组件添加到 Flash 影片剪辑。[您可以使用SpriteVisualElement](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/flash/ContainerMovieClip.html)将 Flash 影片剪辑添加到 flex 组件。另一件没有提到的事情是布局你的应用程序。这将是 flex 的优点对抗 flash 的缺点，因为你构建了 flex 布局系统。但是，当您同时使用它们时，您可以使用 flex 布局系统来布局您的电影剪辑。

flex 也成为[Apache 的顶级项目](http://blogs.apache.org/foundation/entry/the_apache_software_foundation_announces39)。而且现在越来越被社区排除在外。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T16:48:10.330

Flash 和 Flex 是两个完全不同的东西，一个是支持动作脚本的设计工具，另一个是一个框架，也有动作脚本，但主要围绕 MXML 构建，MXML 是一种基于 XML 的 UI 定义“语言”。

# emacs - Emacs 模式：“命令尝试在 minibuffer 中使用 minibuffer”

> ID：812135
> 
> 赞同：14
> 
> 时间：2009-05-01T16:37:00.107
> 
> 标签：emacs, elisp, modal-dialog

设想：

*   我开始输入 Mx 来输入命令
*   我切换到另一个 emacs 窗口/缓冲区，因为我意识到我在错误的窗口中执行命令
*   我开始再次输入 Mx 以在正确的窗口中执行命令

结果：我得到可怕的“命令试图在 minibuffer 中使用 minibuffer”

这在我使用 emacs 时每天会发生多次，而不仅仅是在这种情况下。这种行为是高度用户敌对的（参考`The Humane Interface`Jef Raskin 的 Modes and Pseudo-modes）

有没有办法自定义 emacs 行为，而不是给出这个错误，它只是取消第一个 minibuffer 并用新的 minibuffer 替换它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T17:50:41.287

您可以设置变量`enable-recursive-minibuffers`，这将防止出现该错误消息。但它只是启用对 minibuffer 的多次调用 - 它不会将当前 minibuffer 的命令重定向到新缓冲区。您可以尝试一下，但我认为它会更加混乱，因为原始操作仍在等待中......

`M-x`绑定到`'execute-extended-command`，并且为该命令重新托管（更改原始缓冲区）有点像继续编程。即，您从位置 X 调用子例程，但完成后不是返回 X，而是返回 Y。我个人认为这会带来更多的混乱，而不是解决问题。但我理解这种挫败感（并且知道其他人也有同样的挫败感）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-25T21:28:44.150

确实，这个 emacs “功能”具有侵略性且令人讨厌。我发现这是问题的正确答案。很可能您失去了对 minibuffer 的关注，因为您使用鼠标而不是 minibuffer 命令切换窗口。因此，每当您使用鼠标失去焦点时，都会清除迷你缓冲区。检查这篇文章。它对我有用，而且比递归的 minibuffers 好得多，这会导致头痛

[http://trey-jackson.blogspot.com/2010/04/emacs-tip-36-abort-minibuffer-when.html](http://trey-jackson.blogspot.com/2010/04/emacs-tip-36-abort-minibuffer-when.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T16:41:18.037

我不确定是否有这样的自定义，但我避免这种情况的方法是取消我正在编写的迷你缓冲区中的命令`ctrl`。`g`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T18:39:05.163

由于我的第一个答案并没有直接给你你想要的，我想我会想出一个真正的解决方案。这就是我所拥有的：

```
(defvar my-execute-extended-command-source-buffer nil
  "var holding the buffer to which the extended-execute-command should apply")
(defvar in-my-execute-extended-command nil
  "internal use - indicates whether we're in a 'recursive edit' of sorts")
(defun my-execute-extended-command (command)
  "home-grown version of execute-extended-command that supports re-hosting the buffer"
  (interactive (list (if in-my-execute-extended-command
                   nil
                 (let ((in-my-execute-extended-command t))
                   (setq my-execute-extended-command-source-buffer (current-buffer))
                   (completing-read "My-x " obarray 'commandp t nil 'extended-command-history nil nil)))))
  (if in-my-execute-extended-command
      (progn (setq my-execute-extended-command-source-buffer (current-buffer))
             (select-window (minibuffer-window)))
    (switch-to-buffer my-execute-extended-command-source-buffer)
    (call-interactively (symbol-function (intern command))))) 
```

我用这种方式测试过。我将它绑定到一个键（`F10`在我的情况下，我不想丢失 b/c `M-x`）。然后，打开两个窗口，每个窗口显示不同的缓冲区（比如 A 和 B）：

1.  从显示缓冲区 A 的窗口：`F10 isearch-for`
2.  从 minibuffer 切换到显示 A 的窗口：`C-x o`
3.  从显示 A 的窗口切换到显示 B 的窗口：`C-x o`
4.  “重新托管”来自缓冲区 B 的命令：`F10`
5.  现在回到迷你缓冲区，完成命令`ward RET`

当我开始输入搜索词时，搜索应用到缓冲区 B。

这只会替换`M-x`功能，而不是从 调用的命令`M-x`。此外，此版本不支持前缀参数。

希望这是你想要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T13:30:57.143

任何人都可以改进以下内容吗？

我已经放弃了，只想设置 \Cw 在打开一个新的之前取消任何以前的 minibuffer（比如做 \Cg\Cw）

到目前为止，感谢 Trey，我得到了：

```
(defun cancel-completing-read ()
  (if (> (minibuffer-depth) 0) (exit-minibuffer))
   (completing-read "My-x " obarray 'commandp t nil 'extended-command-history nil nil))

(defun cancel-and-execute-command (command)
  (interactive (list (cancel-completing-read)))
  (call-interactively (symbol-function (intern command))))

(global-set-key "\M-x" 'cancel-and-execute-command) 
```

我应该使用什么命令代替`exit-minibuffer`上面的命令？

我试过了

```
keyboard-escape-quit
exit-minibuffer
keyboard-quit 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-24T03:36:30.763

干得好：

```
;; automatically cancel the minibuffer when you switch to it, to avoid
;; "attempted to use minibuffer" error.
;; cy was here

(provide 'cancel-minibuffer)

(defun cancel-minibuffer-first (sub-read &rest args)
    (let ((active (active-minibuffer-window)))
        (if active
                (progn
                    ;; we have to trampoline, since we're IN the minibuffer right now.
                    (apply 'run-at-time 0 nil sub-read args)
                    (abort-recursive-edit))
            (apply sub-read args))))

(advice-add 'read-from-minibuffer :around #'cancel-minibuffer-first) 
```

# sql - TSQL。获取一行中多列的按位总计

> ID：812142
> 
> 赞同：0
> 
> 时间：2009-05-01T16:38:43.380
> 
> 标签：sql, sql-server, tsql, bit-manipulation

我有一个表，在 BIT 概念中有 4 组 25 列。实际上字段是smallint，但它的数据是0或1。

这是我的代码，它试图获取第一组 25 列的总数。

```
Declare @rows int
, @ID uniqueidentifier
, @LocTotal bigint

select @rows =  ( select  count(*) from #t1 )

while @rows > 0
begin
print @rows
-- get that rowID
       select @ID = (select top 1 recid from #t1)
select @LocTotal =
(select top 1
case when cbHPILoc1 = 1 then 1 else 0 end +
case when cbHPILoc2 =  1 then 2 else 0 end +
case when cbHPILoc3 = 1 then  4 else 0 end +
< snip >
case when cbHPILoc25 = 1 then 16777216 else 0 end
as Total
 from  dbo.MyTest_BitMap
where RecKey = @ID
)
       print @ID
print  @LocTotal 
```

我的输出：

```
(5 row(s) affected)
5
67A16306-B27D-4882-88A2-1146CBAAA8D9

(1 row(s) affected)
4
F94929B9-3DA7-4AA3-96F6-728EF025B21C 
```

我没有得到总计`@LocTotal`

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:47:49.083

为什么这么复杂？

```
SELECT
  RecKey,
  cbHPILoc1
  + cbHPILoc2 * 2
  + cbHPILoc3 * 4
  + ...
  + cbHPILoc25 * 16777216
  AS Total
FROM
  dbo.MyTest_BitMap
WHERE 
  RecKey = @ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:00:01.597

我认为 Tomalak 拥有它，这就是我对他进行改装的原因，但如果你多次或一次这样做，因为所有这些混乱：

```
cbHPILoc1
  + cbHPILoc2 * 2
  + cbHPILoc3 * 4
  + ...
  + cbHPILoc25 * 16777216 
```

繁琐且容易出错，为什么不做一次作为视图并彻底测试呢？

那么就`select total from viewname where reckey = ?`.

# javascript - Javascript 不会使用正则表达式拆分

> ID：812144
> 
> 赞同：19
> 
> 时间：2009-05-01T16:38:49.197
> 
> 标签：javascript, regex, split, lookahead

自从我开始写这个问题以来，我想我已经找到了我遇到的每个问题的答案，但我想我还是会发布，因为它可能对其他人有用并且更多的澄清可能会有所帮助。

我试图将正则表达式与 javascript 函数拆分一起使用。由于某种原因，即使在我调用 match 时它找到了匹配项，它也没有拆分字符串。我最初认为问题出在我的正则表达式中使用前瞻。这是一个简化的示例：

不起作用：

```
"aaaaBaaaa".split("(?=B)."); 
```

作品：

```
"aaaaBaaaa".match("(?=B)."); 
```

看来问题是在拆分示例中，传递的字符串没有被解释为正则表达式。使用正斜杠而不是引号似乎可以解决问题。

```
"aaaaBaaaa".split(/(?=B)./); 
```

我用下面这个看起来很傻的例子证实了我的理论：

```
"aaaaaaaa(?=B).aaaaaaa".split("(?=B)."); 
```

有没有人认为 match 函数假设你有一个正则表达式而 split 函数没有这很奇怪？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-01T16:58:56.887

**`String.split`**接受字符串或正则表达式作为其第一个参数。该**`String.match`**方法只接受一个正则表达式。

我想这**`String.match`**将尝试处理通过的任何内容；因此，如果您传递一个字符串，它会将其解释为正则表达式。该**`String.split`**方法没有这样做的奢侈，因为它可以接受正则表达式和字符串；在这种情况下，事后猜测是愚蠢的。

* * *

**编辑**：（来自：“JavaScript：权威指南”）

**`String.match`**需要使用正则表达式。传递的参数需要是一个**`RegExp`**指定要匹配的模式的对象。如果此参数不是 a **`RegExp`**，则首先通过将其传递给**`RegExp()`**构造函数将其转换为 1。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T16:43:56.830

如果我没记错的话（我在这里可能是非常错误的），split 方法是在正则表达式引擎被广泛使用之前在 javascript 中实现的，所以它可能是为了向后兼容。

# html - 在指定 XHTML 元素的语言时，是否需要 `xml:lang` 属性（除了 HTML `lang` 属性）？

> ID：812146
> 
> 赞同：2
> 
> 时间：2009-05-01T16:39:18.760
> 
> 标签：html, xhtml, internationalization

我有一个 XHTML 1.0 过渡文档。大部分内容都是英文的，因此这是我最上面的内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
```

有些元素使用不同的语言，例如

```
<a href="#" lang="es">Español</a> 
```

我是否也需要添加`xml:lang="es"`到这些元素中，从而复制语言信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T18:58:04.713

如果您要发送`text/html`MIME 类型的文件，则应该这样做，因为您正在尝试同时使用 HTML 和 XHTML。（不过，浏览器只会查看`lang`.）

`application/xhtml+xml`另一方面，如果您使用正确的 MIME 类型 ( )，则只有`xml:lang=""`在（正确地）指出您使用的是 HTML 和 HTML doctype 时，您才需要`lang=""`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T16:39:52.410

[根据 XHTML 1.0 规范：是的，同时使用](http://www.w3.org/TR/xhtml1/#C_7).

虽然没有说为什么。

[Dive Into Accessibility 的语言页面](http://diveintoaccessibility.org/day_7_identifying_your_language.html)说了同样的话，正如[Rahul 对类似问题的回答](https://stackoverflow.com/questions/764028/xhtml-document-lang-options-question/764160#764160)中提到的那样。

# javascript - $ 未定义：这是什么意思？

> ID：812149
> 
> 赞同：3
> 
> 时间：2009-05-01T16:39:34.140
> 
> 标签：javascript, jquery

我收到一个 JS 错误，我不知道如何修复它。

当我的页面加载时，IE7 会通知我运行时错误。此外，我在 Firefox 上的 Firebug 警告我一个错误：

```
$ is not defined
(?)
[Break on this error] $(document).ready(function() { $("a#sin...Out': 300, 'overlayShow': false }); }); 
```

当我转到有问题的行时，它是这样的：

```
<script type="text/javascript" src="/templates/magazeen/js/jquery/jquery.dropdown.js"></script>
    <script type="text/javascript">
    $(document).ready(function() { $("a#single_image").fancybox(); $("a#inline").fancybox({ 'hideOnContentClick': false }); $("a.group").fancybox({ 'zoomSpeedIn': 300, 'zoomSpeedOut': 300, 'overlayShow': false }); });
    </script> 
```

请提供任何帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-01T16:42:11.793

您可能只包含了 jQuery 的下拉部分，而不是全部。尝试只包含 JQuery.js 文件，而不指定哪个部分。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-01T16:41:53.667

您在有问题的脚本块上方是否有对 jQuery 的脚本引用？您看到此错误的原因是因为您使用的是 jQuery 函数**`$`**而没有引用 jQuery 本身。

您需要像这样添加对 jQuery 的脚本引用：

```
<script type="text/javascript" src="/yourJsDir/jQuery.js"></script> 
```

如果您有 jQuery.js 的本地副本。否则，您可以像这样使用 Google 的托管版本：

```
<script type="text/javascript" 
    src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script> 
```

只需确保这些脚本引用位于相关脚本块上方，因为您的 jQuery 插件将为**`$`**它定义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-09T09:16:38.207

尝试在 html 上的自定义 Js 文件之前包含 JQuery js：

```
<script src="../../Scripts/jquery-1.8.2.min.js" type="text/javascript" ></script>
<script src="../../Scripts/___your js___ .js" type="text/javascript"></script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T16:43:16.800

您的代码似乎使用[JQuery](http://jquery.com/)。您确定已将 JQuery 库包含在正确的位置吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T16:42:52.230

您可能还需要包括正常的`jquery.js`或`jquery.min.js`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-07T16:39:47.113

这听起来像是权限问题。确保您的文件可以访问该 .js 文件。他们应该是777。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T13:59:37.323

我昨天遇到了这个确切的问题，这是因为我没有正确引用 jQuery 库。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-05T05:43:25.213

我正在本地处理 file:///Users/lo_fye/Desktop/jquery/index.html 的文件，其中包含以下脚本：

```
<script type="text/javascript" src="/jquery.js"></script> 
```

我得到了同样的错误：

```
$ is not defined 
```

修复是在脚本名称前加上句点，如下所示：

```
<script type="text/javascript" src="./jquery.js"></script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-24T07:05:26.827

这个问题也可能是安全问题。例如，如果您在网站上进行了身份验证

```
<authentication mode="Forms">   
<forms loginUrl="file1.aspx" defaultUrl="file2.aspx"/>
</authentication>
<authorization>
<deny users="?"/> 
</authorization> 
```

然后，您必须使用 web.config 中的以下内容从此安全设置中排除您的脚本文件夹。

```
<location path="Scripts">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-04T11:18:11.467

每次我得到这个错误，要么是因为 1- 对 jquery.js 的引用是错误的（错误的路径） 2- 错误的文件名......

所以更正路径或拼写或文件名/文件夹名等

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-07T09:37:19.407

尝试将其添加到您的 JS 文件中

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 
```

# .net - 在处理单个页面时，ViewState 是比 QueryString 维护状态更好的选择。为什么？

> ID：812164
> 
> 赞同：2
> 
> 时间：2009-05-01T16:42:17.880
> 
> 标签：.net, asp.net, asp.net-mvc

我正在阅读 Steven A. Smith 撰写的文章： [在 ASP.NET 应用程序中管理持久用户状态的九个选项](http://msdn.microsoft.com/en-us/magazine/cc300437.aspx) （他不是在 ESPN 上主持节目吗？）

在文章中，Steven 做了如下声明：“在处理单个 ASP.NET 页面时，ViewState 是比 QueryString 维护状态更好的选择”

不幸的是，他没有解释为什么会这样。为什么会这样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T16:44:04.770

我想是因为 QueryString 是页面 URI 的一部分——因此可以被用户篡改。更不用说 QueryString 中的空间有限 - 仅限于 URL 的最大大小（IE 中为 2048 字节，其他浏览器更适应）。

除了篡改之外，在 QueryString 中存储随机状态位会导致 URL 非常丑陋 - 因此 URL 对搜索引擎不友好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T17:02:53.647

它不是。

ViewState 存储在页面本身的隐藏表单字段中。这在状态实际上是瞬态的情况下很有用 - WebForms 默认情况下依赖它来控制状态 - 但它在页面加载中实际*持续存在*的唯一方法是每次向服务器发出请求时强制回发。

查询字符串是 URL 的一部分 - 更改查询字符串会更改 URL。请求将页面状态存储在 URL 中的 URL 将保留该状态。因此，即使跨会话或用户之间也有可能保留状态 - 可以为 URL 添加书签并稍后再次请求、通过电子邮件发送等。当然，此状态作为单个 URL 的一部分附加到单个页面 -如果另一个页面需要它，则必须手动传输（通过为该页面附加查询字符串）或通过其他方式（cookie、POST 数据、服务器端会话数据）。当然，如果您*不想*跨时间和空间保留状态......或者您的状态非常大......查询字符串不合适。

请注意，从逻辑上讲，存储在查询字符串中的 ViewState 和状态都是特定于页面的；尽管它们可以作为 GET（查询字符串）或 POST 请求（ViewState）的一部分被转发到另一个页面，但浏览器本身不会将它们与对单独页面的请求相关联，也不会在返回前一页时更新这些状态. 为 ViewState 提供的少量额外安全性（正如[Erik 指出](https://stackoverflow.com/questions/812164/when-dealing-with-a-single-page-viewstate-is-a-better-choice-than-querystring-fo/812180#812180)的那样） - 可能是 Smith 先生建议将*用户*特定状态存储在*单个上的原因*页。但是，除了让它们跨页面工作的技巧之外，这种每页附件通常使 cookie（或由客户端 cookie 索引的服务器端会话状态）更适合保存特定于给定用户或会话的状态，但不特定于任何单个页面。

就我个人而言，我从来没有发现 ViewState 特别有用——它很脆弱，并且对如何执行导航设置了严格的限制。但是，如果您坚持使用纯 WebForms 回发/重定向模型，它可以有效地工作（因为该框架将为您处理大部分丑陋的细节）。请注意，尝试在单个页面上做太多可能会导致大量 ViewState 并相应地减慢用户的加载/重新加载时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T17:27:18.113

我注意到你在这个问题的标签中包含了 ASP.NET MVC。您应该知道*ASP.NET MVC 没有 ViewState。*完全没有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T16:50:57.310

Erik 是正确的，但我还要补充一点，在 ASP.NET 中，ViewState 被序列化为一个隐藏的表单元素。这个想法是你可以在 ViewState 中存储任何东西（甚至是复杂的对象），并且它们将被*自动*序列化，而将这些对象存储在 QueryString 中通常意味着手动解构它们并编写某种解析器来重新构建它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T17:33:44.057

这一切都取决于。

QueryString 中的项目可以进行深度链接。您可能不希望这样，或者可能需要围绕它编写代码。

QueryString 的长度是有限的。并不是说有人应该在他们的视图状态中放置 10K，而是我在需要时在 ViewState 中的 QueryString 上放置了超过 2k 的限制*。使用 QyeryString 根本无法做到这一点。

在大多数情况下，您应该将两者结合使用。使用 MVC，您会失去 ViewState，但在某些情况下可能会开发自己的类似解决方案。

编辑：*不同的浏览器支持不同的最大长度，但仍然是一个问题。 [http://www.aspfaq.com/show.asp?id=2222](http://www.aspfaq.com/show.asp?id=2222)

# java - 自动转换 Spring Bean

> ID：812178
> 
> 赞同：7
> 
> 时间：2009-05-01T16:43:38.873
> 
> 标签：java, spring, casting, javabeans

有没有办法将 Spring bean 自动转换为应用程序上下文 XML 中定义的类？我想避免将有关 bean 的类型信息放在 2 个位置......在 xml 配置文件中以及作为强制转换的代码中。

例如，给定这个配置文件

```
<bean id="bean-name" class="SimpleSpringBean"  scope="prototype">
    <property name="myValue" value="simple value"></property>
</bean> 
```

我可以`ApplicationContext.getBean("bean-name")`通过避免将返回类型直接转换为`SimpleStringBean`. 我知道我也可以打电话`ApplicationContext.getBean("bean-name", SimpleSpringBean.class)`来避免演员表本身，但我仍然在两个地方有类型信息。

似乎 Spring 可以获取类信息 ( `ApplicationContext.getType`) 或通过从 bean 本身获取类型，但没有程序员干预无法自动转换类型。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T17:11:06.467

我同意 Sii，您应该尽可能避免调用 getBean。只需将您的 bean 连接到依赖它们的类。

尽管如此，如果您有一个包含应用程序上下文的类，您可以提供一个包装器泛型方法，如下所示：

```
class MyContextHolder{
    ApplicationContext appContext;
    ......
    @SuppressWarnings("unchecked")
    public static <T> T getBean(String beanName)
    {
        return (T)appContext.getBean(beanName);
    }
} 
```

然后你可以在不强制转换的情况下调用它

```
MyClass mc = MyContextHolder.getBean("myClassBean"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T16:55:15.960

答案是，如果可能的话，你根本不应该使用 ApplicationContext.getBean() ，并忍受你必须在引导代码中使用的一个地方。（通常，您永远不需要在应用程序的入口点之外使用 getBean()。）

此外，您所问的问题在 Java 语言中可能根本不可能。强制转换是一种编译时特性，结合了运行时检查。getBean() 的返回类型必须在编译时知道。即使 Spring 可以确定对象的类型，它也无法在运行时更改自己的方法签名。

另一件事是，即使这是可能的，该功能也不会那么有用。因为 Spring AOP 是使用动态代理实现的，所以您几乎总是希望 Spring 向您提供 bean 实现的接口的实例（可能是 AOP 代理），而不是实现类的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:58:32.903

我还使用的另一种方法是使用以下方法自动装配引导类：

```
public class Main {
    @Autowired FooFacade foo;
    @Autowired BarFacade bar;

    public static void main(String[] args) {
        ApplicationContext ctx = new ClassPathXmlApplicationContext("appCtx.xml");
        AutowireCapableBeanFactory bf = ctx.getAutowireCapableBeanFactory();
        Object main = bf.createBean(Main.class, 
                                    AutowireCapableBeanFactory.AUTOWIRE_AUTODETECT,
                                    false);
        ((Main) main).run();
    }

    private void run() {
        foo.doBootstrapStuff();
        bar.doMoreBootstrapStuff();
    }
} 
```

（代码从内存中完成。可能仅在您将 Spring 上下文配置为处理接线注释时才有效，在这种情况下，设置器`foo`应该`bar`可以工作。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T17:37:50.077

没有类型化的主要原因`getBean`是 Spring（直到 2.5.x 版本）与 Java 1.4 的兼容性。Spring 3.0 将放弃它，从而提供类型化的`getBean`方法。

尽管如此，您应该避免直接查找 bean 并尽可能减少它的使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-21T14:07:25.747

如果我使用 Spring 作为我的应用程序广泛使用的对象工厂会怎样。也就是说，与其编写一堆已经继承或包装已知 Java 类的类，我只是决定将所有这些移动到一个 xml 文件中以减少 Java 代码行。这将意味着很多行 xml，但我不需要制作我用 Spring 或 autowire 注入的骨架 Java 类。从而减少 Java 代码的行数。

出于这个原因，我仍然是 Spring 的新手，正如之前的帖子中所述，我使用了包含 getBeans() 的静态 Java 方法。

我曾与 Spring 合作过，但它对我来说仍然是新的，所以请原谅我的问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-08-11T20:16:57.683

“因为 Spring AOP 是使用动态代理实现的，所以您几乎总是希望 Spring 向您提供 bean 实现的接口的实例（可能是 AOP 代理），而不是实现类的实例”

所以没有办法使用 getBean() 获得动态代理，那么如果没有接口并且它是一个要执行的独立驱动程序类，那么最好的做法是什么？

# java - 比较 Filecontent Eclipse

> ID：812184
> 
> 赞同：0
> 
> 时间：2009-05-01T16:44:38.840
> 
> 标签：java, eclipse, file, compare

Apache Commons IO FileUtils.contentEquals() 比较 2 个文件。

这也可以使用 eclipse.org 的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T01:01:33.490

我不知道是否有等效的 eclipse 代码，但你可以只使用 apache 代码。

Eclipse的[Orbit 项目](http://www.eclipse.org/orbit/overview.php)提供了第三方库的捆绑版本以用于 Eclipse 项目。Apache Commons IO 版本[1.3.2](http://download.eclipse.org/tools/orbit/downloads/drops/S20090426201227/bundles/org.apache.commons.io_1.3.2.v20080604-1500.jar)和[1.4.0](http://download.eclipse.org/tools/orbit/downloads/drops/S20090426201227/bundles/org.apache.commons.io_1.4.0.v20081110-1000.jar)都在那里可用。

# iphone - 调用 self.myInstanceVariable 和直接调用 myInstanceVariable 有什么区别？

> ID：812185
> 
> 赞同：2
> 
> 时间：2009-05-01T16:44:45.190
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

一个月前，我正在读一篇关于此的文章。我不确定，但我认为如果我调用 self.myInstanceVariable 那么它会自动使用 getter/setter，但是如果我直接调用 myInstanceVariable = @"Foo" 例如，那么我会绕过任何真正的 getter/setter ，真的，非常糟糕。正确错误？

编辑：我在 XCode 中试过这个。

实现如下所示：

```
@implementation Test
@synthesize name;

+ (Test*)testWithName:(NSString*)name {
    Test* test = [self alloc];
    test.name = name;
    return [test autorelease];
}

- (void)setName:(NSString*)newName {
    NSLog(@"SETTER CALLED!!");
    if(name != newName) {
        [name release];
        name = [newName retain];
    }
}

- (NSString*)name {
    NSLog(@"GETTER CALLED!!");
    return name;
}

- (void)doWrongThing {
    NSString *x = name;
    NSLog(@"doWrongThing: %@", x);
}
- (void)doRightThing {
    NSString *x = self.name;
    NSLog(@"doRightThing: %@", x);
} 
```

测试代码如下所示：

```
Test *t = [Test testWithName:@"Swanzus Longus"];
//NSLog(@"%@", t.name);
[t doWrongThing];
[t doWrongThing];
[t doWrongThing];

[t doRightThing]; 
```

因此，在以另一种方法启动此代码后（我只是使用了现有项目；）），我在控制台中收到了以下输出：

```
2009-05-01 19:00:13.435 Demo[5909:20b] SETTER CALLED!!
2009-05-01 20:19:37.948 Demo[6167:20b] doWrongThing: Swanzus Longus
2009-05-01 20:19:37.949 Demo[6167:20b] doWrongThing: Swanzus Longus
2009-05-01 20:19:37.949 Demo[6167:20b] doWrongThing: Swanzus Longus
2009-05-01 20:19:37.950 Demo[6167:20b] GETTER CALLED!!
2009-05-01 20:19:37.965 Demo[6167:20b] doRightThing: Swanzus Longus 
```

如您所见，您必须使用 self.instanceVariableName 才能使用 getter 和 setter（或者您在括号中进行调用，也可以）。

混淆警报：只有在您想要访问实例变量的对象的方法中进行修改时，您才必须使用 self 。从外部看，当您调用 someObjectPointer.someInstanceVariable 时，它​​会自动访问 getter 和 setter（是的，我也尝试过）。

只是以为有人会对一个小案例研究感兴趣；）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T16:49:40.683

那是对的。如果您直接使用该变量，绕过 getter/setter，您可能会产生错误。getter/setter 可能负责保留和/或释放对象以及其他事情。这可能会导致崩溃/内存泄漏等。

如果您知道自己绕过了 getter/setter 并采取了正确的预防措施，那么直接访问变量就没有错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T17:03:18.420

杰西有一些很好的洞察力（+1 给你，先生）。

我会考虑直接显式调用底层成员变量（从而绕过 getter/setter）的唯一情况是我自己编写了 getter/setter，并且确切地知道它在做什么和不做什么，并且 99%那些时候是我刚刚在构造函数中初始化成员的时候。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T16:46:48.500

只需阅读文档

首先，这是不正确的

```
Test* test = [self alloc]; 
```

正确的是

```
Test* test = [[self alloc] init]; 
```

第二，如果你写

```
@synthesize name; 
```

方法

```
- (void)setName:(NSString*)newName
- (NSString*)name 
```

将自动生成（!! dot-syntax is just syntax-sugar !!）

三、写的时候

```
myvar.itInstanceVariable 
```

它转化为

```
[myvar itInstanceVariable] 
```

和

```
myvar.itInstanceVariable = newValue 
```

翻译成

```
[myvar setItInstanceVariable:newValue] 
```

关于您的评论，当您以这种方式声明您的财产时

```
@property(nonatomic, retain) MyType *myVar; 
```

并写在实现中

@synthesize myVar

它创建了两种方法

```
- (MyType*)myVar {
     return myVar;
}

- (void)setMyVar:(MyType*)newVar {
    if (myVar != newVar) {
       [myVar release];
       myVar = [newVar retain];
    }
} 
```

所以你不必担心重新租借/释放

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:49:00.290

是的，属性语法调用 setter。在几乎所有情况下，这都是您想要的，因为默认情况下它会正确处理大量内存管理。此外，属性名称、ivar 名称和 getter/setter 名称也可能不同，因此您可能会发现它看起来不像`self.myInstanceVar`.

另外，作为旁注，您可能已经知道也可能不知道，但是如果您只是要编写所有访问器方法，那么综合属性是没有意义的。

# c# - 使用 C# 更改 jpeg 图像的分辨率

> ID：812191
> 
> 赞同：2
> 
> 时间：2009-05-01T16:47:22.843
> 
> 标签：c#, jpeg, resolution

我需要在不改变图像尺寸的情况下修改垂直和水平分辨率。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:20:40.170

查看[Bitmap.SetResolution](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.setresolution.aspx)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:54:28.550

如果您只有 GDI，请查看此[链接](http://www.codeproject.com/KB/GDI-plus/imageresize.aspx)。

您可以使用以下代码段将[位图](http://msdn.microsoft.com/en-us/library/9t4syfhh.aspx)保存为 JPEG 文件：

```
bmp.Save("picture.jpg", System.Drawing.Imaging.ImageFormat.Jpeg); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T16:56:03.803

分辨率包含在 JPEG 文件的 EXIF 标记中。

这是一篇提供在 C# 中执行类似操作的源代码的文章：

[http://www.codeproject.com/KB/graphics/EXIF_tag_Editor.aspx](http://www.codeproject.com/KB/graphics/EXIF_tag_Editor.aspx)

# emacs - Emacs：防止 gud 和 pdb 控制窗口

> ID：812192
> 
> 赞同：7
> 
> 时间：2009-05-01T16:47:33.590
> 
> 标签：emacs, elisp

我正在使用 pdb 调试 Python 程序，但对它的行为不满意。

我将屏幕分成多个 emacs 窗口，当我执行 pdb 时，它（随机？）用 *gud* 调试器的输出替换其中一个窗口。

此外，当遇到断点时，即使调试缓冲区已经在一个窗口中可见，它通常也会将此缓冲区放入*另一个*窗口，并用源文件的内容替换我的另一个窗口。（顺便说一句，我喜欢它跳转到源文件中的正确行）

如何禁用 gud/pdb 为我管理我的窗口？在 emacs 中是否有可能阻止对窗口和屏幕布局的所有编程操作？

编辑：我在另一篇文章中找到了部分解决此问题的答案：[切换专用窗口](https://stackoverflow.com/questions/43765/pin-emacs-buffers-to-windows-for-cscope/65992#65992)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T21:17:27.147

我在 Emacs 24 上尝试了所有这些方法都没有成功。如果你仍然感兴趣，我使用 'gud-gdb' 恢复到旧的 gdb 行为，它实现了 gdb/emacs 交互的旧行为（没有专用窗口和没有 I/O 缓冲区）。如果你不想在使用的时候调用 Mx gud-gdb，可以给 Mx gdb 定义一个别名

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T16:52:08.243

查看[粘性窗口](http://www.emacswiki.org/emacs/StickyWindows)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-24T00:39:51.260

我有一个解决方案可以防止 gdb 窃取窗口。它适用于 Emacs 24.4（2014-07-18 快照）并且不需要专用缓冲区。与其他答案相比的好处是，每当您更改缓冲区时，您都不必费心使用专用和非专用缓冲区，这很快就会变得乏味。

将此建议放在您的 .emacs 中：

```
(defadvice gdb-inferior-filter
    (around gdb-inferior-filter-without-stealing)
  (with-current-buffer (gdb-get-buffer-create 'gdb-inferior-io)
    (comint-output-filter proc string)))
(ad-activate 'gdb-inferior-filter) 
```

这有效地替换了 gdb-mi.el 中定义的这个函数，并删除了调用 gdb-display-buffer 的分支，这是导致窗口盗窃的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-03T01:45:35.083

您应该使用[Sticky Windows](http://www.emacswiki.org/emacs/StickyWindows)使您的窗口和缓冲区固定在它们所在的位置，但 Sticky Windows 不会阻止 gud/pdb 试图窃取您的窗口。当 gud/pdb 不能窃取你的源代码窗口时，它会打开一个新的 Emacs 框架，即使当前框架上有另一个窗口。

这是因为试图跳转到 gud-pdb 缓冲区 ( [`py-pdbtrack-track-stack-file`](http://bazaar.launchpad.net/~python-mode-devs/python-mode/python-mode/view/head:/python-mode.el#L1649)) 的函数调用`pop-to-buffer`参数 OTHER-WINDOW 设置为 的函数`t`。

为了规避所有调用 pop-to-buffer 的库的这种行为，您可以通过在`pop-to-buffer`（在您的 .emacs 中）定义一个建议来取消 OTHER-WINDOW 的角色：

```
(defadvice pop-to-buffer (before cancel-other-window first)
  (ad-set-arg 1 nil))

(ad-activate 'pop-to-buffer) 
```

您还应该将变量自定义`pop-up-windows`为 nil 以强制`display-buffer`（用于在窗口和框架上显示特定缓冲区的低级例程）不创建新窗口。

# c# - 在 Intellisense 中使属性/功能加粗

> ID：812201
> 
> 赞同：2
> 
> 时间：2009-05-01T16:49:30.420
> 
> 标签：c#, .net

有没有办法在智能感知中突出显示自定义类的属性/功能？它在框架中被大量使用，它确实有助于展示一个类的主要特性。我试过寻找一个属性，因为我知道过时的属性会影响显示，但没有运气。

编辑

由于我对智能感知如何显示项目的误解，最初的问题是有缺陷的。正如答案中所解释的，粗体项是由子类创建的新属性/函数，换句话说，粗体是自动完成的。

如果有任何其他方法可以突出显示某些功能，我仍然很感兴趣，如果有帮助，我将使用 ReSharper。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T17:43:10.370

IntelliSense 中的粗体条目是直接在类上实现的成员，继承的属性和方法以常规字体显示。

如果有帮助，您可以使用[[EditorBrowsable] 属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.editorbrowsableattribute.aspx)从列表中隐藏“高级”条目。在这种情况下，“高级”表示“通过工具 | 启用隐藏高级成员设置时隐藏”。选项 | 文本编辑器 | C＃'。

# .net - 如何为最终用户自动升级部署的数据库

> ID：812210
> 
> 赞同：1
> 
> 时间：2009-05-01T16:52:24.017
> 
> 标签：.net, sql-server-ce, database-migration

我已经阅读了很多关于如何为开发人员升级数据库等的问题，并且我倾向于使用[migratordotnet](http://code.google.com/p/migratordotnet/)或类似的东西，但似乎升级需要使用 MSBuild 或 NAnt 之类的东西来运行。这些不是我期望最终用户安装的东西。

理想情况下，这个过程应该是用户安装新版本的应用程序，启动它，它会处理幕后的一切。根据这个过程需要多长时间，我可能会或可能不会显示进度条，然后它就完成了，使用该应用程序通常会幸福地不知道有诸如 sql、msbuild、关系数据库之类的东西，甚至是任何远程技术探测的东西。

其他杂项信息：

安装了 xcopy 的 SQLCE。

很可能不应该太大的单用户数据库。

随着程序通过用户对请求功能的输入而不断发展，发布将相当频繁。

初始版本尚未完成，因此无需担心任何当前数据，只需要初始和后续版本的无痛过程（对于最终用户，最好对我来说也是如此！）。

使用 LINQ to SQL 作为 ORM。（我是否先升级数据库然后
运行 ​​SQLMetal 来重新生成
类？）

做 TDD（第一次）并想知道如何自动化测试升级。

Visual C# Express 所以没有 VS 插件。

编辑：

我猜 MSBuild 附带 .NET Framework 而不仅仅是 VS，所以我想这不是问题，我可以使用 migratordotnet 并直接使用 msbuild。如果需要，我可能会重定向控制台输出并进行一些简单的字符串解析以获取进度信息，但如果它看起来需要足够长的时间来保证显示实际进度而不仅仅是一个选框进度条，我会诉诸于此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:09:16.970

**这是一个选项：**

1.  将数据库版本存储在数据库中的某处
2.  在启动时，通过将代码中的常量与数据库版本进行比较，确保数据库是最新的。
3.  如果不是当前运行一组脚本来创建/更改表、转换数据等。

如果您已经部署并且没有数据库版本，那么只需检查架构以了解您在最新数据库版本中所期望的内容。

**去测试：**

1.  从旧数据库开始
2.  创建一个 UpdateDatbaseIfNeeded() 的方法
3.  如果模式得到更新并且数据库版本得到设置，测试应该通过

您还可以预加载您的测试数据库，以测试需要由升级脚本处理的各种转换问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T05:51:13.967

The only thing I would add to the above comments is that you also need to be worried about a pack type operation.

To upgrade your apps from SQL CE 3.1 to 3.5 required you install the 3.5 libraries, and then issue a pack operation to upgrade the database format. You may want to keep this in mind as a part of your process. For SQL CE 3.5 just opening the database in 3.5 will make it no longer compatible with 3.1 - meaning if your user then later restored a backup of the application or something you can't load it. So you need to trap those errors at connection time and make sure you handle all the exceptions from MS for version incompatibility.

Another gotcha with 3.1 and 3.5 is that you can't have them both loaded to Visual Studio at the same time. So testing this process over and over means a VM that you can wipe and upgrade repeatedly. You can't really do it on your development machine. :(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T06:10:36.137

以下是您可以使用[Wizardby](http://code.google.com/p/octalforty-wizardby)执行的操作。

它有一个 API，允许您以编程方式执行数据库模式迁移任务。您将需要一个适当的`IDbPlatform`（`SqlCePlatform`也存在） a `IMigrationVersionInfoManager`，它有一个标准实现，将版本信息存储在`SchemaInfo`表中，a`IMigrationScriptExecutive`也有默认实现，以及`IMigrationService`它本身。接下来，您编写一个[迁移定义](http://code.google.com/p/octalforty-wizardby/wiki/MdlReference)，将其编译到您的程序集中并将其提供给`IMigrationService.Migrate(connectionString, null, yourMigrationDefinition)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T16:59:58.553

一般来说，这个东西通常的做法是在安装时完成数据库迁移；在安装期间，您有一大堆代码（通常是完全自定义的），它们检测数据库的现有版本，并执行将数据从现有数据库迁移到新数据库所涉及的所有操作（即创建临时表、复制数据）从现有表到临时表、删除现有表、创建新表、执行连接以将临时表中的数据添加到新表等）。根据定义，这个过程非常复杂。我不知道有任何工具可以专门针对最终用户生产环境自动执行转换过程。（在处理最终用户数据库时通常会涉及很多特殊情况。）

# assemblies - CLR 是否曾经从 GAC 释放程序集的绑定

> ID：812215
> 
> 赞同：0
> 
> 时间：2009-05-01T16:54:12.547
> 
> 标签：assemblies, clr, gac

我有多个服务正在从 GAC 中提取程序集。当我安装其中一项服务时，它会使用由各种服务共享的新程序集更新 GAC，并将新策略文件插入 GAC，以便所有以前的版本都查找新程序集。所有服务都在不重新启动服务的情况下采用该策略并完美地使用新程序集。问题和问题是当我回滚此版本并卸载程序集和策略并重新启动与安装新程序集相关的服务时。显然，重新启动的服务会在 GAC 中选择以前版本的程序集。但是，在使用此程序集的服务器上运行的其他服务仍绑定到策略文件中的新版本程序集。我的问题是：

绑定是否像缓存一样，最终会释放它并重新拾取旧程序集？还是会一直绑定直到服务重新启动？

如果它需要重新启动，除了找到所有使用此程序集的服务并重新启动这些服务，或者重新启动服务器本身以消除对已从 GAC 中删除的程序集的遮蔽之外，是否还有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:04:29.183

.NET 运行时在关闭应用程序域之前不会卸载程序集（通常在进程退出时，但可以在单个进程中创建多个应用程序域）。

我认为您需要关闭其他服务，删除策略文件和新程序集，然后重新启动所有相关服务。

# asp.net - 通过另一个 DLL 中的方法从我的 Web 应用程序中的文件加载 XmlTextReader

> ID：812219
> 
> 赞同：0
> 
> 时间：2009-05-01T16:54:58.223
> 
> 标签：asp.net, xmltextreader

我正在将要放入 Web 应用程序的 DLL 中创建一个方法。

Web 应用程序有一个文件夹，其中包含一个 XML 文件：

/files/myfile.xml

我的 dll 必须引用该 DLL，但显然我不能硬编码文件的路径。

如何引用该文件并使用该文件加载 XmlTextReader？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:01:17.707

最好的办法是将 XML 文件的路径存储在配置文件中。由于您的两个程序集都将在同一个 AppDomain 中运行，因此它们都可以访问配置文件中的设置，您不必担心对路径进行硬编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:59:28.663

想到的最简单的方法是将文件名参数从 Web 应用程序传递给 DLL 的方法。我确定您已经想到了这一点，但是您的问题并未说明该解决方案存在什么（如果有）问题。

# c# - C# - 组合框性能

> ID：812227
> 
> 赞同：1
> 
> 时间：2009-05-01T16:56:43.927
> 
> 标签：c#, .net, combobox

由于我只是在使用 .NET 学习 C#（我对 XNA 框架有更多经验），因此我可能不会以正确的方式使用它。

我的问题在我看来很奇怪。我使用设计器制作了一个带有 TabControl 的表单。在其中一个标签页中，我有一个 ListBox 和一个 ComboBox。ComboBox 具有静态数量的项目，这些项目都是在 ComboBox 初始化时声明的。

每当我单击 ComboBox 以查看其内容列表（大约 30 个）并向下或向上滚动时，我的整个应用程序的性能都会下降很多大约一秒钟。这使我的 ComboBox 像糖浆一样慢，最重要的是，这似乎击中了我的 ListBox，因为它在一秒钟内变成白色，就好像它正在等待重绘一样。

现在我**没有**用 ComboBox 为任何东西编写任何循环或其他繁重的处理，一切都是由 VisualStudio 2008 自动编写的，并且是标准模板代码 + 框中的项目。

**编辑：**正如我所说，唯一的代码是由 VS 2008 生成的，我没有附加到 ComboBox 的方法，（除了一个空的）。但是代码在这里：

```
// 
// comboBox1
// 
this.comboBox1.DropDownHeight = 200;
this.comboBox1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
this.comboBox1.FormattingEnabled = true;
this.comboBox1.IntegralHeight = false;
this.comboBox1.Items.AddRange(new object[] {
"0",
"1",
"2",
"3",
"4",
"5",
"6",
"7",
"8",
"9",
"A",
"B",
"C",
"D",
"E",
"F",
"G",
"H",
"I",
"J",
"K",
"L",
"M",
"N",
"O",
"P",
"Q",
"R",
"S",
"T",
"U",
"V",
"W",
"X",
"Y",
"Z"});
this.comboBox1.Location = new System.Drawing.Point(26, 362);
this.comboBox1.Name = "comboBox1";
this.comboBox1.Size = new System.Drawing.Size(101, 21);
this.comboBox1.TabIndex = 8;
this.comboBox1.SelectedIndexChanged += new System.EventHandler(this.comboBox1_SelectedIndexChanged); 
```

任何人都能够分享这里发生的事情的见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:48:55.923

看看这篇文章，它解决了类似的问题。

[ComboBox 中的慢速滚动](https://stackoverflow.com/questions/768489/slow-scrolling-in-combobox)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:31:20.723

好的，所以我发现了它是什么，实际上有点尴尬。我的应用程序正在使用挂钩，但挂钩始终启动并运行，即使不需要。那里进行了一些重组，问题**应该**得到解决。可能也需要看看钩子，因为它从一开始就不是我的来源。

不过欣赏答案:)

# c# - 如何使用 xmltextreader 从简单的 xml 文件中加载哈希表

> ID：812232
> 
> 赞同：1
> 
> 时间：2009-05-01T16:57:51.290
> 
> 标签：c#, asp.net, xml, xmltextreader

使用 xmltextreader，我将如何加载哈希表。

XML:

```
<base><user name="john">2342343</user><user name="mark">239099393</user></base> 
```

之前有人问过这个问题，但它使用了一些我还不太熟悉的时髦的 linq。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:05:26.107

好吧，LINQ to XML 解决方案真的很简单，所以我建议我们尽量让您适应它，而不是创建一个更复杂的解决方案。这是代码，有很多解释......

```
// Load the whole document into memory, as an element
XElement root = XElement.Load(xmlReader);

// Get a sequence of users
IEnumerable<XElement> users = root.Elements("user");

// Convert this sequence to a dictionary...
Dictionary<string, string> userMap = users.ToDictionary(
      element => element.Attribute("name").Value, // Key selector
      element => element.Value);                 // Value selector 
```

当然，您*可以*一次性完成所有这些 - 我可能会将第二个和第三个语句结合起来。但这在概念上很简单。诚然，如果您想围绕用户元素可能没有名称的可能性进行错误处理，这将变得更加复杂。（在这种情况下，此代码将引发 NullReferenceException。）

请注意，这假设您希望名称作为键，id 作为值。如果你想要哈希表反过来，只需切换 lambda 表达式的顺序。

# java - 从数据库中获取事件

> ID：812233
> 
> 赞同：33
> 
> 时间：2009-05-01T16:58:05.297
> 
> 标签：java, database, database-design, events, triggers

我对数据库以及它们在 CRUD 操作之外提供的功能不是很熟悉。

我的研究使我找到了**触发器**。基本上看起来触发器提供了这种类型的功能：

> （来自[维基百科](http://en.wikipedia.org/wiki/Database_trigger)）
> 
> 通常有三个触发事件会导致触发器“触发”：
> 
> *   INSERT 事件（因为新记录被插入到数据库中）。
> *   UPDATE 事件（因为正在更改记录）。
> *   DELETE 事件（因为正在删除记录）。

我的问题是：当使用某种触发器语义更新/删除/插入记录时，数据库是否可以通过某种方式在 Java 中通知我（最好包括更改的数据）？

这个问题的一些替代解决方案可能是什么？如何监听数据库事件？

**我想这样做的主要原因是这样的场景**：

我有 5 个客户端应用程序，它们都在不同的进程中/存在于不同的 PC 上。它们都共享一个公共数据库（在这种情况下为 Postgres）。

假设一个客户更改了所有 5 个客户都“感兴趣”的数据库中的记录。我试图想办法让客户“通知”更改（最好附上受影响的数据）而不是他们每隔一段时间查询数据。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T19:09:20.223

使用 Oracle，您可以在表上设置触发器，然后让触发器发送 JMS 消息。Oracle 有两种不同的 JMS 实现。然后，您可以拥有一个使用 JDBC 驱动程序“侦听”消息的进程。我已经使用这种方法将更改推送到我的应用程序与轮询。如果您使用的是 Java 数据库 (H2)，您还有其他选择。在我当前的应用程序 (SIEM) 中，我在 H2 中有使用 JMX 发布更改事件的触发器。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-06T15:48:41.287

不要混淆数据库（包含数据）和该数据上的事件。

触发器是一种方式，但通常您的应用程序中会有一个持久层。该层可以选择在某些事情发生时触发事件——比如 JMS 主题。

触发器是最后的事情，因为那时您正在对关系项目进行操作，而不是数据上的“事件”。（例如，“更新”实际上可以映射到“公司更改法定名称”事件）如果您依赖数据库，则必须将插入和更新映射回现实生活中的事件......你已经知道了！

然后，您可以在这些通知之上添加其他内容（例如事件流处理）以查找其他人感兴趣的事件。

詹姆士

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-06T17:49:23.290

唔。所以你正在使用 PostgreSQL 并且你想“监听”事件并在它们发生时得到“通知”？

[http://www.postgresql.org/docs/8.3/static/sql-listen.html](http://www.postgresql.org/docs/8.3/static/sql-listen.html) [http://www.postgresql.org/docs/8.3/static/sql-notify.html](http://www.postgresql.org/docs/8.3/static/sql-notify.html)

希望这可以帮助！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-01T17:04:41.820

从数据库调用外部进程是非常特定于供应商的。

就在我的脑海中：

*   SQLServer 可以从触发器调用 CLR 程序，

*   postgresql 可以调用动态加载的任意 C 函数，

*   MySQL 可以调用任意 C 函数，但它们必须编译成，

*   如果设置为 Sybase 可以进行系统调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T17:00:57.850

最简单的做法是让插入/更新/删除触发器在某个日志表中创建一个条目，并让您的 java 程序监视该表。日志表中的好列应该是 EVENT_CODE、LOG_DATETIME 和 LOG_MSG。

除非您需要非常高的性能或需要处理 100Ks 的记录，否则这可能就足够了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T17:26:54.730

我认为你混淆了两件事。它们都是高度特定于数据库供应商的。

第一个我称之为“触发器”。我确信至少有一个数据库供应商认为触发器与此不同，但请耐心等待。触发器是可以附加到表的服务器端代码。例如，您可以在表 X 中的每次更新时运行 PSQL 存储过程。有些数据库允许您用真正的编程语言编写这些，而另一些则只能使用它们的 SQL 变体。触发器通常相当快且可扩展。

另一个我称之为“事件”。这些是在数据库中触发的触发器，允许您在客户端程序中定义事件处理程序。IE，只要客户端数据库有更新，就会在程序中触发 updateClientsList。例如，使用 python 和 firebird 参见[http://www.firebirdsql.org/devel/python/docs/3.3.0/beyond-python-db-api.html#database-event-notification](http://www.firebirdsql.org/devel/python/docs/3.3.0/beyond-python-db-api.html#database-event-notification)

我相信之前使用监视器的建议是使用其他数据库实现此功能的等效方法。也许是甲骨文？另一个答案中提到的 MSSQL 通知服务也是另一个实现。

我什至会说您最好真正知道为什么要让数据库通知您的客户端程序，否则您应该坚持使用服务器端触发器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:02:04.540

您要问什么完全取决于您使用的数据库以及您用于与数据库通信的框架。

如果您使用 Hibernate 之类的东西作为持久层，它有一组侦听器和拦截器，您可以使用它们来监视进出数据库的记录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T17:03:06.720

根据您使用的数据库，这里有几种不同的技术。一种想法是轮询数据库（我确定您正在尝试避免）。基本上你可以每隔一段时间检查一次更改。

另一种解决方案（如果您使用的是 SQL Server 2005）是使用通知服务，尽管据说这种技术在 SQL 2008 中被替换（我们还没有看到完全的替换，但微软已经公开谈论过）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T17:05:06.123

如果您使用的是 Oracle，请查看[上一篇文章](https://stackoverflow.com/questions/337335/oracle-table-change-monitor)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T18:13:11.140

这通常是标准客户端/服务器应用程序的用途。如果所有插入/更新/删除都通过服务器应用程序，然后修改数据库，那么客户端应用程序可以更容易地找出所做的更改。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-07T08:57:33.807

如果您使用的是 postgresql，它可以侦听来自 JDBC 客户端的[通知。](http://jdbc.postgresql.org/documentation/91/listennotify.html)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-08T21:04:59.943

我建议使用最后更新的时间戳列，以及可能更新记录的用户，然后让客户端检查他们的本地记录时间戳与持久记录的时间戳。

在我看来，添加回调/触发功能所增加的复杂性是不值得的，除非得到数据库后端和使用的客户端库的支持，例如为 SQL Server 2005 提供的通知服务与 ADO.NET 一起使用。

# asp.net-mvc - ASP.NET MVC 中的错误处理

> ID：812235
> 
> 赞同：64
> 
> 时间：2009-05-01T16:58:43.283
> 
> 标签：asp.net-mvc, exception

如何正确处理 ASP.NET MVC 中的控制器抛出的异常？该`HandleError`属性似乎只处理 MVC 基础设施抛出的异常，而不是我自己的代码抛出的异常。

使用这个 web.config

```
<customErrors mode="On">
    <error statusCode="401" redirect="/Errors/Http401" />
</customErrors> 
```

使用以下代码

```
namespace MvcApplication1.Controllers
{
    [HandleError]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            // Force a 401 exception for testing
            throw new HttpException(401, "Unauthorized");
        }
    }
} 
```

不会导致我所希望的。相反，我得到了通用的 ASP.NET 错误页面，告诉我修改我的 web.config 以查看实际的错误信息。但是，如果不是抛出异常，而是返回无效视图，我会得到 /Shared/Views/Error.aspx 页面：

```
return View("DoesNotExist"); 
```

像我在上面所做的那样在控制器中抛出异常似乎绕过了所有`HandleError`功能，那么创建错误页面的正确方法是什么？我如何与 MVC 基础设施一起玩呢？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-01T17:32:15.263

`Controller.OnException(ExceptionContext context)`. 覆盖它。

```
protected override void OnException(ExceptionContext filterContext)
{
    // Bail if we can't do anything; app will crash.
    if (filterContext == null)
        return;
        // since we're handling this, log to elmah

    var ex = filterContext.Exception ?? new Exception("No further information exists.");
    LogException(ex);

    filterContext.ExceptionHandled = true;
    var data = new ErrorPresentation
        {
            ErrorMessage = HttpUtility.HtmlEncode(ex.Message),
            TheException = ex,
            ShowMessage = !(filterContext.Exception == null),
            ShowLink = false
        };
    filterContext.Result = View("ErrorPage", data);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-01T19:51:05.523

感谢 kazimanzurrashaid，这就是我最终在 Global.asax.cs 中所做的事情：

```
protected void Application_Error()
{
    Exception unhandledException = Server.GetLastError();
    HttpException httpException = unhandledException as HttpException;
    if (httpException == null)
    {
        Exception innerException = unhandledException.InnerException;
        httpException = innerException as HttpException;
    }

    if (httpException != null)
    {
        int httpCode = httpException.GetHttpCode();
        switch (httpCode)
        {
            case (int) HttpStatusCode.Unauthorized:
                Response.Redirect("/Http/Error401");
                break;
        }
    }
} 
```

我将能够根据我需要支持的任何其他 HTTP 错误代码向 HttpContoller 添加更多页面。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-01T17:24:41.927

> HandleError 属性似乎只处理 MVC 基础结构抛出的异常，而不是我自己的代码抛出的异常。

那是错误的。实际上，HandleError 只会“处理”在您自己的代码中或在您自己的代码调用的代码中抛出的异常。换句话说，只有您的操作在调用堆栈中的例外情况。

您所看到的行为的真正解释是您抛出的特定异常。HandleError 与 HttpException 的行为不同。从源代码：

```
 // If this is not an HTTP 500 (for example, if somebody throws an HTTP 404 from an action method),
        // ignore it.
        if (new HttpException(null, exception).GetHttpCode() != 500) {
            return;
        } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-01T18:52:15.290

我认为您无法根据带有 HandleError 属性的 HttpCode 显示特定的 ErrorPage，我更愿意为此目的使用 HttpModule。假设我有文件夹“ErrorPages”，其中每个特定错误都存在不同的页面，并且在 web.config 中指定了与常规 Web 表单应用程序相同的映射。以下是用于显示错误页面的代码：

```
public class ErrorHandler : BaseHttpModule{

public override void OnError(HttpContextBase context)
{
    Exception e = context.Server.GetLastError().GetBaseException();
    HttpException httpException = e as HttpException;
    int statusCode = (int) HttpStatusCode.InternalServerError;

    // Skip Page Not Found and Service not unavailable from logging
    if (httpException != null)
    {
        statusCode = httpException.GetHttpCode();

        if ((statusCode != (int) HttpStatusCode.NotFound) && (statusCode != (int) HttpStatusCode.ServiceUnavailable))
        {
            Log.Exception(e);
        }
    }

    string redirectUrl = null;

    if (context.IsCustomErrorEnabled)
    {
        CustomErrorsSection section = IoC.Resolve<IConfigurationManager>().GetSection<CustomErrorsSection>("system.web/customErrors");

        if (section != null)
        {
            redirectUrl = section.DefaultRedirect;

            if (httpException != null)
            {
                if (section.Errors.Count > 0)
                {
                    CustomError item = section.Errors[statusCode.ToString(Constants.CurrentCulture)];

                    if (item != null)
                    {
                        redirectUrl = item.Redirect;
                    }
                }
            }
        }
    }

    context.Response.Clear();
    context.Response.StatusCode = statusCode;
    context.Response.TrySkipIisCustomErrors = true;

    context.ClearError();

    if (!string.IsNullOrEmpty(redirectUrl))
    {
        context.Server.Transfer(redirectUrl);
    }
}
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-20T02:09:23.883

其他阅读本文的人可能遇到的另一种可能性（在您的情况下并非如此）是您的错误页面本身抛出错误，或者没有实现：

```
 System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo> 
```

如果是这种情况，那么您将获得默认错误页面（否则您将获得无限循环，因为它会不断尝试将自身发送到您的自定义错误页面）。这对我来说并不是很明显。

该模型是发送到错误页面的模型。如果您的错误页面使用与站点其余部分相同的母版页并且需要任何其他模型信息，那么您将需要创建自己`[HandleError]`的属性类型或覆盖`OnException`或其他东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-10T19:29:51.837

我选择了 Controller.OnException() 方法，这对我来说是合乎逻辑的选择 - 因为我选择了 ASP.NET MVC，所以我更喜欢留在框架级别，并尽可能避免弄乱底层机制。

我遇到了以下问题：

如果视图中发生异常，该视图的部分输出将与错误消息一起出现在屏幕上。

在设置 filterContext.Result 之前，我通过清除响应来解决此问题 - 如下所示：

```
 filterContext.HttpContext.Response.Clear(); // gets rid of any garbage
        filterContext.Result = View("ErrorPage", data); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-10-10T12:06:48.707

```
 protected override void OnException (ExceptionContext filterContext )
    {
        if (filterContext != null && filterContext.Exception != null)
        {
            filterContext.ExceptionHandled = true;
            this.View("Error").ViewData["Exception"] = filterContext.Exception.Message;
            this.View("Error").ExecuteResult(this.ControllerContext);
        }
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-23T19:35:33.880

Jeff Atwood 的[用户友好异常处理模块](http://www.codeproject.com/Articles/8049/User-Friendly-ASP-NET-Exception-Handling)非常适合 MVC。您可以在 web.config 中完全配置它，根本不需要更改 MVC 项目源代码。但是，它需要稍作修改才能返回原始 HTTP 状态而不是`200`状态。请参阅此相关[论坛帖子](http://www.codeproject.com/Articles/8049/User-Friendly-ASP-NET-Exception-Handling?msg=3971218#xx3971218xx)。

基本上，在 Handler.vb 中，您可以添加如下内容：

```
' In the header...
Private _exHttpEx As HttpException = Nothing

' At the top of Public Sub HandleException(ByVal ex As Exception)...
HttpContext.Current.Response.StatusCode = 500
If TypeOf ex Is HttpException Then
    _exHttpEx = CType(ex, HttpException)
    HttpContext.Current.Response.StatusCode = _exHttpEx.GetHttpCode()
End If 
```

# python - 如何让 setup.py 使用文件的相对路径？

> ID：812242
> 
> 赞同：14
> 
> 时间：2009-05-01T17:00:33.247
> 
> 标签：python, distutils

我正在尝试使用`distutils`. 不幸的是，我的目录结构如下所示：

```
/代码
    /我的包
        __init__.py
        文件1.py
        文件2.py
        /分包
            __init__.py
    /建造
        安装程序.py

```

这是我的`setup.py`文件：

```
from distutils.core import setup

setup(
    name = 'MyPackage',
    description = 'This is my package',
    packages = ['mypackage', 'mypackage.subpackage'], 
    package_dir = { 'mypackage' : '../mypackage' }, 
    version = '1',
    url = 'http://www.mypackage.org/',
    author = 'Me',
    author_email = 'me@here.com',
) 
```

当我`python setup.py sdist`正确运行它时，它会生成清单文件，但不会在分发中包含我的源文件。显然，它创建了一个目录来包含源文件（即`mypackage1`），然后将每个源文件复制到`mypackage1/../mypackage`其中，将它们*放在*分发之外。

我怎样才能纠正这个问题，而不强制我的目录结构符合`distutils`预期？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T04:08:59.380

您希望分发存档文件中的目录结构是什么？和你现有的结构一样吗？

`code`您可以使用此修改后的 setup.py将所有内容打包到更高的目录（在您的示例中）：

```
from distutils.core import setup

setup(
    name = 'MyPackage',
    description = 'This is my package',
    packages = ['mypackage', 'mypackage.subpackage'], 
    version = '1',
    url = 'http://www.mypackage.org/',
    author = 'Me',
    author_email = 'me@here.com',
    script_name = './build/setup.py',
    data_files = ['./build/setup.py']
) 
```

您将运行它（在`code`目录中）：

```
python build/setup.py sdist 
```

或者，如果您想保留`dist`在构建内部：

```
python build/setup.py sdist --dist-dir build/dist 
```

我喜欢你正在尝试的目录结构。我从没想过`setup.py`它足够特别，足以保证在根代码文件夹中。但不管你喜不喜欢，我认为这就是你的发行版的用户所期望的。因此，您必须欺骗 distutils 做其他事情也就不足为奇了。该`data_files`参数是一种将您的 setup.py 放入您所在位置的发行版的技巧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T03:46:00.910

是否先更改为父目录？

```
import os
os.chdir(os.pardir)

from distutils.core import setup 
```

等等

或者，如果您可能在任何地方运行它（这是矫枉过正，但是......）：

```
import os.path
my_path = os.path.abspath(__file__)
os.chdir(os.normpath(os.path.join(my_path, os.pardir))) 
```

等。不确定这是否有效，但应该很容易尝试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-15T04:14:33.183

**从项目的根文件夹运行 setup.py**

在您的情况下，将 setup.py 放在 code/

代码/还应包括：

*   许可证.txt
*   自述文件.txt
*   安装.txt
*   待办事项.txt
*   变更日志.txt

当您运行“setup.py sdist”时，它应该自动生成一个清单，包括： - py_modules 和/或包中指定的任何文件 - setup.py - README.txt

要添加更多文件，只需手动编辑 MANIFEST 文件以包含项目所需的任何其他文件。

对于这个有点体面的解释[阅读this](http://docs.python.org/release/1.6/dist/manifest.html)。

要查看工作示例，请查看[我的项目](http://code.google.com/p/pypreprocessor/source/browse/)。

*注意：我没有将 MANIFEST 置于版本控制之下，因此您不会在那里找到它。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T09:33:38.220

也是一个蹩脚的解决方法，但构建项目内的包目录的连接/链接应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T17:15:34.973

一个有点蹩脚的解决方法，但我可能只是使用一个将 ./mypackage 同步到 ./build/mypackage 的 Makefile，然后从 ./build 内部使用通常的 distutils 语法。事实上，distutils 期望将 setup.py 解压到 sdist 的根目录下，并在其中放置代码，因此您将花费大量时间说服它不这样做。

当你清理时，你总是可以对副本进行核对，这样你就不必弄乱你的 vcs。

# iphone - 使用 tel: URL 发起呼叫的问题

> ID：812243
> 
> 赞同：30
> 
> 时间：2009-05-01T17:00:57.647
> 
> 标签：iphone

我正在尝试从 iPhone 应用程序中发起呼叫。

此相关代码可以正常工作并按预期打开 Safari：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.apple.com"]]; 
```

但是，当我用 tel URL 替换 http URL 时，生成的代码不会调用电话应用程序：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:3035551212"]]; 
```

不会生成异常或警报（在模拟器中或设备上）。

知道我的调用可能有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-10-27T05:20:43.993

iphone 将使用下列任一格式拨打号码。 **但是，如果您在模拟器中，它将无济于事。** 我花了 30 分钟敲了敲脑袋才弄明白。

```
[[UIApplication sharedApplication] 
                    openURL:[NSURL URLWithString:@"tel://15415551234"]];

[[UIApplication sharedApplication] 
                    openURL:[NSURL URLWithString:@"tel:15415551234"]];

[[UIApplication sharedApplication] 
                    openURL:[NSURL URLWithString:@"tel:1-541-555-1234"]]; 
```

[tel 上的 Apple 文档链接：url 方案](https://developer.apple.com/library/ios/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html)

[openURL 文档链接](http://developer.apple.com/IPhone/library/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728-CH3-SW14)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-07-21T12:41:46.863

正如@bentford 所说，一个人可能会流产，因为当您尝试在联系人应用程序上单击手机时，模拟器确实会显示警报，这只是一个警报，因为该应用程序会检查`tel:`设备是否支持该协议或不。

添加到他所写的内容中，您可能还需要添加支持以转义任何特殊字符或空格，如下所示：

```
NSString *phoneStr = [NSString stringWithFormat:@"tel:%@",[self.contactDetails objectForKey:@"phone"]];
NSString *escaped = [phoneStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:escaped]]; 
```

希望能帮助到你。

干杯。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-06-29T21:26:08.073

`(`如果您按照 samiq 的建议使用，`)`实际上没有问题。,和空格也是`stringByAddingPercentEscapesUsingEncoding`如此。这是一个 URL，所以转义看起来很自然。`+``/`

如果我猜对了，如果您正确转义，Apple 的常规电话号码识别将在`tel:`方案处理程序中使用。

（缺少声誉使其成为评论）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-12-06T07:38:48.943

如果您的电话号码中有`(`或`)`在其中，电话应用程序将不会启动。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T04:34:37.763

`tel:{phone-number}`以与您相同的方式使用和调用它没有任何问题。不过，仅适用于 iPhone 设备。

我必须做的一件事是从电话字符串中去掉无关的字符（如所有括号、空格、破折号和点）。上面的一些例子（但不是原始帖子）有破折号。这可能是问题所在。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-07-23T14:18:04.950

我发现问题是由于 tel:// URI 不允许使用的字符造成的 - 以下代码解决了我的问题：

```
NSMutableCharacterSet *charSet = [NSMutableCharacterSet new];
[charSet formUnionWithCharacterSet:[NSCharacterSet whitespaceCharacterSet]];
[charSet formUnionWithCharacterSet:[NSCharacterSet punctuationCharacterSet]];
[charSet formUnionWithCharacterSet:[NSCharacterSet symbolCharacterSet]];
NSArray *arrayWithNumbers = [str componentsSeparatedByCharactersInSet:charSet];
NSString *numberStr = [arrayWithNumbers componentsJoinedByString:@""]; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-13T02:20:59.733

我在尝试将“呼叫”按钮添加到`UIAlertView`. 我有以下代码来处理呼叫：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex != 0)
    {
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:1-602-555-1212"]];
    }
} 
```

它不会打开任何东西，就像你一样。我什至尝试了一个常规的`http`URL。原来我忘记设置`delegate`to 了`self`。这可能也是你的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-04T11:41:37.517

我遇到了同样的问题，最后我发现原因是电话号码中有一个空格（为了更好地格式化）。删除空间后，它工作正常。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-23T10:37:15.270

有关通过 url 方案拨打电话的一些附加信息（我认为有人可能会觉得它有用）

[如何在 iOs 上使用 tel: with * (star, asterisk) 或 # (hash, pound)？](https://stackoverflow.com/questions/4660951/problem-using-tel-with-star-asterisk)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-11-12T08:56:50.833

以下是有关如何在 2018 年获取电话号码的更新（其中 iOS 11 和 12 最常见）：

```
NSString *phoneNumberURLString = [@"tel://" stringByAppendingString:[result.phoneNumber
                 stringByAddingPercentEncodingWithAllowedCharacters:
                                 [NSCharacterSet URLPathAllowedCharacterSet]]];
NSURL *phoneNumberURL = [NSURL URLWithString:phoneNumberURLString]; 
```

[samiq 的答案](https://stackoverflow.com/a/3299291/347339)是我最初使用的答案，直到我发现我的应用程序会由于`NSURL`无法正确转义格式如下的电话号码而创建 nil（后来被传递到集合对象）而崩溃`(###) ###-####`：上述代码解决了这个问题。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2009-05-01T17:47:32.357

URL 应该是 tel://3035551212 而不是 tel:3035551212... 添加 // 它应该可以工作。

# sql-server - 解释 SQL Server 语法错误

> ID：812248
> 
> 赞同：3
> 
> 时间：2009-05-01T17:01:54.197
> 
> 标签：sql-server, sql-server-2005, syntax-error

如果说我讨厌 SQL Server 的一件事，那就是非常无用的错误消息。我最喜欢的是“Incorrect syntax near...”，因为它几乎没有提供任何错误提示。

是否有任何工具可以更好地了解该声明的问题？或者有没有人有任何其他有用的提示来找出这些类型的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:15:00.997

嗯……可以在SQL Management Studio中双击报错信息，会跳转到出错的位置。

这至少有时会有所帮助，尽管它并非 100% 有效。有些错误绝对是太晦涩难懂了，但由于这是数据库引擎告诉外界的一切，我不知何故怀疑是否有工具可以提供更好的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T17:17:45.250

它对 SQL 2005 没有帮助，但 SQL 2008 在管理工作室中内置了智能感知和语法检查。那里的大多数语法错误都会出现我们在 Visual Studio 中熟悉的红色曲线。

缺点是它仅在连接到 SQL 2008 服务器时才有效。

# sharepoint - 允许匿名用户在共享点文档库中保存表单的内容

> ID：812258
> 
> 赞同：1
> 
> 时间：2009-05-01T17:03:16.283
> 
> 标签：sharepoint, permissions, save, sharepoint-2007, anonymous-users

我为匿名访问配置了 moss 2007。我还有一个在 infopath 中创建的可公开访问的表单，可以在网页中打开并填写和提交。但是，匿名用户在填写后无法提交表单。提交操作应该将表单保存在文档库中。

我检查了这个文档库的匿名权限（设置>权限>匿名访问），发现只有“查看项目”被启用，而“添加项目”或“编辑项目”的其他选项已被禁用并显示为灰色。

有没有办法让匿名用户填写表单并将其内容提交到 sharepoint 的文档库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-04T18:25:32.580

有一种解决方法。见 [http://blog.metrostarsystems.com/2009/06/04/anonymously-submit-infopath-form-to-sharepoint-library/](http://blog.metrostarsystems.com/2009/06/04/anonymously-submit-infopath-form-to-sharepoint-library/)

# c# - 我在哪里可以找到一个很好的适配器模式实现以及 C# 中的好例子？

> ID：812260
> 
> 赞同：4
> 
> 时间：2009-05-01T17:03:20.870
> 
> 标签：c#, design-patterns

我在哪里可以找到一个很好的[适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)实现以及C# 中的好例子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T17:36:11.307

（我将在这里加入类似于 Wikipedia 示例的内容......）

假设您需要`IDeque<T>`为某些库提供接口，具有以下签名：

```
public interface IDeque<T>
{
    void PushFront(T element);
    T PopFront();
    void PushBack(T element);
    T PopBack();
    int Count { get; }
} 
```

您可以使用 BCL 中的类轻松实现这一点 - LinkedList<T>，但此处所需的特定接口不匹配。为了实现这个接口，你必须提供一个适配器——一个实现所需接口的类，使用其他一些不兼容的接口。这看起来像：

```
public class Deque<T> : IDeque<T>
{
    LinkedList<T> list = new LinkedList<T>();
    public void PushFront(T element)
    {
        list.AddFirst(element);
    }

    public T PopFront()
    {
        T result = list.First.Value;
        list.RemoveFirst();
        return result;
    }
    // ... Fill in the rest... 
```

在这种情况下，您只是使用现有的类 (LinkedList<T>)，但您将其包装在 Adapter 中以使其实现不同的接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T17:07:08.567

DimeCasts.net 上有一个很棒的播客，关于[这里](http://www.dimecasts.net/Casts/CastDetails/106)

这是一个关于适配器模式的 10 分钟视频，他们还发布了源代码，因此您也可以查看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T17:09:24.210

这是一种接口转换模式。数据和对象工厂：[适配器模式](http://www.dofactory.com/Patterns/PatternAdapter.aspx)。Explanation、UML、示例源代码——你也可以购买他们关于他们模式的额外源代码。

# mfc - 在 MFC 中创建分页列表视图

> ID：812262
> 
> 赞同：0
> 
> 时间：2009-05-01T17:03:40.387
> 
> 标签：mfc, listview

如何使用分页创建列表视图（或列表 Ctrl）？这意味着每当 List Ctrl 中有太多项目时，这些项目都会被组织在不同的页面中。

希望你明白我的意思。

如果已经构建了这样的控件会更好（例如在 Codeproject 中）。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T17:29:03.617

你确定你需要分页吗？如果您试图解决加载许多项目花费太长时间的问题，最好的答案是所有者数据。这使您可以仅为显示的项目即时提供数据。它工作得很好。

[MSDN](http://msdn.microsoft.com/en-us/library/bb774735(VS.85).aspx)

# java - Java SSL 重新协商（从 SSL 到清除通道）

> ID：812275
> 
> 赞同：0
> 
> 时间：2009-05-01T17:05:49.087
> 
> 标签：java, ssl, interop

我正在 Java SE 中做一些需要我以不寻常的方式使用 SSL 的事情。
所需的步骤类似于：

*   建立 SSL 会话；
*   交换一些私人信息；
*   重新协商连接参数以停止使用加密操作。

我还没有在 Java API 中找到解决此问题的方法。我相信问题解决方案可以通过使用会话重新协商来解决，但使用没有加密操作的密码套件，但没有这样的选择；或访问底层套接字并绕过加密操作。

这些选项中的任何一个都可能吗？您是否认为其他语言和框架（C、PHP、Ruby、.NET、Perl、Python 等）也可以使用此类功能？

感谢您的帮助，
路易斯·M·科斯塔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T17:19:58.270

你可以在 Java 中做这样的事情，但这绝对不是标准的。我不能保证其他平台对此有必要的支持。

JSSE 通过[`SSLEngine`](http://java.sun.com/javase/6/docs/api/javax/net/ssl/SSLEngine.html). 您可以使用它来临时“装饰”带有 SSL 的套接字，然后在完成后将其关闭并直接使用原始套接字 IO。

我猜不出你为什么要在花费了协商 SSL 会话的费用后关闭 SSL。如果是为了性能，你可以重新协商密码套件以使用“NULL”机密性和完整性协议，只要双方允许。在 SSL 记录层中仍然会有一点开销。但是，会话参数协商后的 SSL 开销极低。如果您的应用程序对这种开销非常敏感，您可能需要考虑专用的 SSL 硬件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-12T14:20:25.967

关闭现有套接字上的 SSL 的一个原因是为了实现 FTP 清除控制通道 (CCC) 命令（基于 TLS 的 FTP）。这会将控制通道切换回明文，以便防火墙可以看到动态端口请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T06:52:44.357

为什么不直接断开连接并重新连接？与重新协商 SSL 相比，建立 TCP 连接的开销会更少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T17:58:42.073

要重新协商透明密码，我猜您至少必须启用它，因为默认情况下未启用它。但我认为没有好的“空”密码，最好将 SSL 套接字与底层套接字分离。

```
SSLEngine#setEnabledCipherSuites(new String(){"SSL_RSA_WITH_NULL_SHA"});
SSLEngine#beginHandshake(); 
```

# php - 将 Web 应用程序从 Zend Framework 1.7 更新到 1.8

> ID：812277
> 
> 赞同：1
> 
> 时间：2009-05-01T17:06:21.550
> 
> 标签：php, zend-framework

我正在尝试将我当前的项目从 1.7 更新到 1.8。我必须改变什么才能让它不会破裂？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:18:38.353

大多数功能仍然适用于遗留代码。在您的测试环境中试用并阅读 ZF 更改日志。一件重要的事情是加载器现在的工作方式不同了。特别是如果您使用自动加载。

直到 1.7

```
require_once 'Zend/Loader.php';
Zend_Loader::registerAutoload(); 
```

从 1.8 开始

```
require_once 'Zend/Loader/Autoloader.php';
$loader = Zend_Loader_Autoloader::getInstance();
$loader->registerNamespace('Namespace_'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:20:55.010

**简短回答：**
运行您的测试套件并检查结果；）

**长答案：**
我记得向后兼容性被破坏的两点：

1.  *如果您的引导程序没有正确设置 Zend_Locale，ZF >= 1.7.2 将抛出一个异常，如果您通过控制台*运行脚本，它将无法检测浏览器 Locale 。

2.  [Zend_View 在 1.7.5 中的变化](http://weierophinney.net/matthew/archives/206-Zend-Framework-1.7.5-Released-Important-Note-Regarding-Zend_View.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T12:59:38.263

在 Zend Framework 1.8 中， Zend_Controller_Action 的构造函数被修改了。

我必须提到这一点，因为它破坏了我的应用程序，直到我在调试数小时后发现了这个错误（出于某种原因，xDebug 和 PHP 本身向我展示了我的自定义 Controller_Action 类中的构造函数与 Zend_Controller_Action 中的构造函数不同了）。

所以必须改变你的构造函数

```
public function __construct(Zend_Controller_Request_Abstract $request, Zend_Controller_Response_Abstract $response, $invokeArgs = array()) 
```

到

```
public function __construct(Zend_Controller_Request_Abstract $request, Zend_Controller_Response_Abstract $response, array $invokeArgs = array()) 
```

# c# - wcf 数据成员属性大小写

> ID：812281
> 
> 赞同：0
> 
> 时间：2009-05-01T17:07:52.293
> 
> 标签：c#, wcf

在我的 WCF 服务中，我有一个这样声明的属性：

```
public string PropertyName
{
    get { return propertyName; }
    set { propertyName = value; }
} 
```

在我的客户端中，当我向服务添加服务引用时，导入的`.cs`文件具有相同的属性，只是它丢失了大小写，如下所示：

```
[System.Runtime.Serialization.DataMemberAttribute(IsRequired=true)]
public string propertyName
{
    get
    {
        return this.propertyNameField;
    }
    set
    {
        this.propertyNameField = value;
    }
} 
```

`p`（注意 .上的小写字母`propertyName`。）

我能做些什么让消费者真正获得带有预期外壳的财产，即：`PropertyName`，不是`propertyName`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T17:15:06.600

您是否尝试过在 DataMember 中明确设置名称？例如：

```
[DataMember(Name="PropertyName")]
public string PropertyName { get { ... } set { ... } } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:47:12.247

您是否正确设置了 DataContract 属性？还要确保将 DataMember 应用于属性而不是私有字符串。

```
[DataContract]
public class DataObject {

    string propertyName;

    [DataMember]
    public string PropertyName {
        get { return propertyName; }
        set { propertyName = value; }
    }
} 
```

该类的完整代码会有所帮助。

# windows - 将 ATL 类分解为 Win32 函数

> ID：812286
> 
> 赞同：1
> 
> 时间：2009-05-01T17:10:05.270
> 
> 标签：windows, winapi, atl

我正在尝试从 ATL 类中调用 Win32 版本的 SetWindowPos（我需要指定不同的第一个 hWnd，ATL 通常会处理该 hWnd），但我无法“突破”ATL 类并得到以下错误：

```
error C2661: 'ATL::CWindow::SetWindowPos' : no overloaded function
takes 7 arguments 
```

我怎么告诉它我不想在我的基类中使用那个？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:12:06.247

*愚蠢的回答......假设其他人可能有同样的问题。*

`::`访问全局命名空间的前缀。（由[CodeGuru](http://www.codeguru.com/forum/archive/index.php/t-256805.html)提供）。

# asp.net - 你能命名一个 w3wp.exe 的实例，让它显示在附加到进程中吗？

> ID：812287
> 
> 赞同：11
> 
> 时间：2009-05-01T17:10:20.573
> 
> 标签：asp.net, iis

我在 IIS 下运行多个进程，在调试时很难知道我想附加到哪个进程。您可以以编程方式设置进程的“标题”，以便可以在 Visual Studio 的“附加到进程”窗口中识别它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:11:51.787

更改进程的[标识](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/f05a7c2b-36b0-4b6e-ac7c-662700081f25.mspx?mfr=true)可能会更好，以便您知道要附加到哪个进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-25T16:36:53.240

您可以使用此 VS 宏根据应用程序名称附加到工作进程。唯一的技巧是您需要将 Microsoft.Web.Administration.dll 从 C:\Windows\System32\inetsrv 复制到 %PROGRAMFILES(x86)%\Microsoft Visual Studio 10.0\Common7\IDE\PublicAssemblies。

```
Private Sub AttachToWorkerProcess(ByVal appName As String)
    Dim targetPid = FindPoolPIDByName(appName)
    If targetPid = -1 Then
        MessageBox.Show("Unable to find a worker process hosting " + appName)
    End If

    Dim processes As EnvDTE.Processes = DTE.Debugger.LocalProcesses

    For Each proc As EnvDTE.Process In processes
        If proc.ProcessID = targetPid Then
            proc.Attach()
        End If
    Next

End Sub

Private Function FindPoolPIDByName(ByVal appName As String) As Integer
    Dim sm As New Microsoft.Web.Administration.ServerManager()

    Dim appPoolName As String = Nothing
    For Each site In sm.Sites
        For Each app In site.Applications
            If String.Equals(app.Path, "/" & appName, StringComparison.OrdinalIgnoreCase) Then
                appPoolName = app.ApplicationPoolName
            End If
        Next
    Next

    If appPoolName Is Nothing Then
        MessageBox.Show("Unable to find application " & appName)
    End If

    For Each wp In sm.WorkerProcesses
        If wp.AppPoolName = appPoolName Then
            Return wp.ProcessId
        End If
    Next
    Return -1
End Function 
```

然后：

```
Sub AttachToMyApp()
     AttachToWorkerProcess("MyApp")
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-23T07:52:11.787

在 IIS 7.5 中，您的 IIS 将使用应用程序池的名称自动为每个 appPool 创建帐户。

[http://learn.iis.net/page.aspx/624/application-pool-identities/](http://learn.iis.net/page.aspx/624/application-pool-identities/)

# c# - 如何在没有大内存分配的情况下显示快速更新的图像？

> ID：812288
> 
> 赞同：13
> 
> 时间：2009-05-01T17:10:22.210
> 
> 标签：c#, wpf, image-processing, managed-c++

我在超声波机器上有一个 WPF 应用程序，它以每秒 30 帧以上的速度显示用 C++ 生成的超声波图像。

据我了解，在 WPF 中显示图像的正常过程是为您的图像创建一个 BitmapSource 并为您的图像设置 Source，然后使其无效并显示。

由于 BitmapSources 没有实现 IDisposable，使用这种方法迫使我每秒创建 30 个 BitmapSources。对于具有 32bppArgb 格式的 640x480 图像，这大约是每秒分配 30MB 的内存，然后每 10 秒处理一次垃圾，从而导致明显的延迟。显然不是一个可接受的解决方案。

我目前的解决方案是：

**在 C++ 中：**我在托管 C++ 中创建 System.Drawing.Bitmap（WinForms 位图），从指针执行 memcpy 以填充图片，使用 Graphics 对象进行一些我需要的额外绘图，并将其传递到 C#/WPF在 ImageReceived 事件期间。

**在 C#** Image.Source 中设置为由 BitmapBuffer 生成的源，这是一种访问位图源的原始数据的黑客方式：请参阅[此链接。](http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/16/WPF-Hackery-Part-II.aspx)我执行 CopyMemory 的 P/Invoke 以将 Bitmap.Scan0 中的数据复制到 BitmapBuffer 中。然后我使 Image 无效以更新屏幕，并 Dispose() Drawing.Bitmap 对象以释放内存。

虽然这种方法已经奏效了一段时间，但它看起来很老套，我很难相信除了通过反射之外没有其他“合适的”方法可以做到这一点。

**问：**有没有更好的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-01T18:22:12.147

如果您使用最新的 WPF 位，请查看[WriteableBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.aspx)，您将不得不做更多的工作，但您将真正快速更新。

做一个快速的谷歌，你会得到一些样本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T17:16:29.217

这是我为 WPF BitmapSource 和 GDI 位图（用于我自己的项目）之间的别名（共享内存）编写的一些代码*

显然，您需要根据自己的需要对其进行调整，最终可能会产生一种不那么“hacky”的感觉。

```
class AliasedBitmapSource : BitmapSource {
    private Bitmap source;
    public AliasedBitmapSource(Bitmap source) {
        this.source = source;
        this.pixelHeight = source.Height;
        this.pixelWidth = source.Width;
        this.dpiX = source.HorizontalResolution;
        this.dpiY = source.VerticalResolution;
    }

    public override event EventHandler DownloadCompleted;
    public override event EventHandler<ExceptionEventArgs> DownloadFailed;
    public override event EventHandler<ExceptionEventArgs> DecodeFailed;

    protected override Freezable CreateInstanceCore() {
        throw new NotImplementedException();
    }

    private readonly double dpiX;
    public override double DpiX {
        get {
            return dpiX;
        }
    }

    private readonly double dpiY;
    public override double DpiY {
        get {
            return dpiY;
        }
    }

    private readonly int pixelHeight;
    public override int PixelHeight {
        get {
            return pixelHeight;
        }
    }

    private readonly int pixelWidth;
    public override int PixelWidth {
        get {
            return pixelWidth;
        }
    }

    public override System.Windows.Media.PixelFormat Format {
        get {
            return PixelFormats.Bgra32;
        }
    }

    public override BitmapPalette Palette {
        get {
            return null;
        }
    }

    public unsafe override void CopyPixels(Int32Rect sourceRect, Array pixels, int stride, int offset) {
        BitmapData sourceData = source.LockBits(
        sourceRect.ToRectangle(),
        ImageLockMode.ReadWrite,
        System.Drawing.Imaging.PixelFormat.Format32bppArgb);

        fixed (byte* _ptr = &((byte[])pixels)[0]) {
            byte* dstptr = _ptr;
            byte* srcptr = (byte*)sourceData.Scan0;

            for (int i = 0; i < pixels.Length; ++i) {
                *dstptr = *srcptr;
                ++dstptr;
                ++srcptr;
            }
        }

        source.UnlockBits(sourceData);
    }
}

public static class Extensions {
    public static Rectangle ToRectangle(this Int32Rect me) {
        return new Rectangle(
        me.X,
        me.Y,
        me.Width,
        me.Height);
    }

    public static Int32Rect ToInt32Rect(this Rectangle me) {
        return new Int32Rect(
        me.X,
        me.Y,
        me.Width,
        me.Height);
    }
} 
```

*“写”是指“10 分钟内拼凑在一起”

# xml - 构建具有多个重叠角色的菜单的策略

> ID：812293
> 
> 赞同：0
> 
> 时间：2009-05-01T17:11:12.410
> 
> 标签：xml, menu, roles, render

我有一个供学生、教师和管理员使用的系统。有时，讲师也可以是管理员。

我打算将菜单和子菜单存储在 XML 中。我应该将管理员和讲师菜单存储在单独的节点中，然后在渲染时将它们组合起来，还是应该有一个带有附加角色的主菜单，在确定角色时显示所有选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:14:57.533

绝对将角色附加到主菜单选项，然后根据用户的角色将它们包含在菜单实例中。IMO 更加灵活和易于维护。

# sql-server - sql 2005和sql 2008的优缺点？

> ID：812298
> 
> 赞同：2
> 
> 时间：2009-05-01T17:12:23.767
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

### 完全重复：

> [MS SQL Server 2008 相对于 MS SQL Server 2005 的优势？](https://stackoverflow.com/questions/198478)

* * *

我是 sql 开发人员，我使用 sql 2005。我现在想通过 2008 但我有点害怕。谁能给我一些建议。我应该继续使用 sql 2005 还是更好地将我的所有项目传递到 2008 年，因为性能更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:23:08.967

谁将使用您的项目；如果他们要使用现有 SQL 许可证的客户，那么 2005 年可能是要走的路；假设它们在 2005 年运行。SQL 2005 数据库将在 2008 年运行；虽然如果您使用 2008 年的一些新语言功能，那么 SQL2008 数据库将不会向后兼容 2005 年。

如果您要控制它们的部署位置；sql 2008 中的一些新特性可能会引起人们的兴趣；更好的全文搜索、改进的分析服务、报告服务和一些语言调整。如果您正在管理服务器；您的管理员可能会喜欢 2008 年的新管理功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:47:59.637

我搬到了 2008 年，因为我对 SSIS 很感兴趣并且拥有大型数据库，这意味着：2008 年 SSIS 中的备份压缩和增加的并发进程让我觉得值得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T17:40:10.127

我从 2005 年到 2008 年移动了 6 个项目，除了报告服务之外没有任何问题。对我而言，最大的好处是 SQL Management Studio 的增强功能，例如自动完成和更改历史记录。

我进行升级的唯一原因是因为我从事教育工作，而微软在许可方面非常慷慨。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:37:05.870

一般来说，除非你听说这是一场灾难，否则我认为你应该争取尽早使用最新版本。服务器功能和工具集的进步通常会抵消您学习新功能所花费的时间。所有软件的构建都考虑到了计划过时，因此您最终需要迁移到更新的技术。如果您养成将系统迁移到最新技术的习惯，您会发现迁移变得相对轻松。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T19:00:06.643

One of the benefits of SQLServer 2008 with respect to SSIS is that it includes very fast bulk connectors for Oracle and Teradata (well, the development and enterprise versions do).

So if you need to move data between SQLServer 2008 and those databases you get this for no additional cost.

See [Microsoft Connectors for Oracle and Teradata by Attunity](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=d9cb21fe-32e9-4d34-a381-6f9231d84f1e)

Another major benefit in SQLServer 2008 is the new Change Data Capture (CDC) functionality which means you can build your application in any way you like and then if at later time you are interested in starting some processing when table X changed, you can turn on CDC for that table and get a change table that contains all the changes to table X with minimal overhead. [Ben Hall did a useful post on this](http://blog.benhall.me.uk/2007/06/sql-server-2008-change-data-capture-cdc.html).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-16T11:09:50.833

I think SQL 2008 has somewhat advantage in compare to sql 2005

1.  New data types(date,time,files stream) 2.Backup compressin 3.Data compression 4.policy based management.

    If anyone know better answer kindly inform

# javascript - 圆角

> ID：812301
> 
> 赞同：5
> 
> 时间：2009-05-01T17:14:51.293
> 
> 标签：javascript, html, css

**重复：**
[创建圆角的最佳方法是什么](https://stackoverflow.com/questions/7089/what-is-the-best-way-to-create-rounded-corners-using-css)
[如何使跨浏览器、W3C 有效、语义、非 JavaScript 圆角？](https://stackoverflow.com/questions/746627/)

有哪些技术（符合标准）用于在 HTML 页面中的显示元素上放置圆角？

我将 HTML CSS 和 javascript 放在下面的标签列表中，因为我相信它们相当普遍，但是如果您有一种技术使用其他技术，这些技术可能会被使用，并且（相对）可靠地跨标准浏览器运行，但请把关于哪些浏览器失败的注释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:23:45.627

CSS3 有一个边框半径标签和盒子阴影标签，但我认为它们只在 Mozilla 和 Safari 中实现。您可以使用它来圆角并轻松创建阴影。

[http://www.css3.info/preview/rounded-border/](http://www.css3.info/preview/rounded-border/)

除此之外，我所做的是创建图像并使用 CSS 和 DIV 标签加载图像。这个链接是我用来开始的。

[http://www.cssjuice.com/25-rounded-corners-techniques-with-css/](http://www.cssjuice.com/25-rounded-corners-techniques-with-css/)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:19:28.053

在我以前工作过的一家公司，有大量的图形资源只是圆角来实现这一点。管理起来很笨拙，但它运作良好，看起来非常好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T17:20:33.060

使用带有图像的 3x3 HTML 表格的老式方式：角落的固定大小的图像、边缘的可拉伸图像以及中间的内容。请参阅[此](http://www.webdevelopersnotes.com/tips/html/html_table_tutorial_rounded_corners.php3)页面以获得更好的描述。

编辑：[这里](http://www.html.it/articoli/nifty/index.html)有一个页面描述了如何在没有图像的情况下使用 CSS。

# c# - 正则表达式用 C# 从 CDATA 中解析出 html

> ID：812303
> 
> 赞同：4
> 
> 时间：2009-05-01T17:14:58.300
> 
> 标签：c#, regex, cdata

我想解析出包装在 CDATA 中的任何 HTML 数据。

举个例子`<![CDATA[<table><tr><td>Approved</td></tr></table>]]>`

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T17:24:38.243

处理您的示例的表达式是

```
\<\!\[CDATA\[(?<text>[^\]]*)\]\]\> 
```

其中“文本”组将包含您的 HTML。

您需要的 C# 代码是：

```
using System.Text.RegularExpressions;
RegexOptions   options = RegexOptions.None;
Regex          regex = new Regex(@"\<\!\[CDATA\[(?<text>[^\]]*)\]\]\>", options);
string         input = @"<![CDATA[<table><tr><td>Approved</td></tr></table>]]>";

// Check for match
bool   isMatch = regex.IsMatch(input);
if( isMatch )
  Match   match = regex.Match(input);
  string   HTMLtext = match.Groups["text"].Value;
end if 
```

“输入”变量在那里只是为了使用您提供的示例输入

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T17:21:03.277

我知道这可能看起来非常简单，但是您尝试过 string.Replace() 吗？

```
string x = "<![CDATA[<table><tr><td>Approved</td></tr></table>]]>";
string y = x.Replace("<![CDATA[", string.Empty).Replace("]]>", string.Empty); 
```

可能有更有效的方法来处理这个问题，但可能是你想要一些简单的东西......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T17:22:12.493

没有太多细节，但如果没有您没有描述的复杂性，一个非常简单的正则表达式应该匹配它：

```
/<!\[CDATA\[(.*?)\]\]>/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T17:23:28.090

查找 CDATA 部分的正则表达式将是：

```
(?:<!\[CDATA\[)(.*?)(?:\]\]>) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T17:25:05.700

```
Regex r = new Regex("(?<=<!\[CDATA\[).*?(?=\]\])"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-09T15:47:47.713

为什么要使用 Regex 来完成如此简单的任务？试试这个：

```
str = str.Trim().Substring(9);
str = str.Substring(0, str.Length-3); 
```

# version-control - 你如何“签出”代码？

> ID：812308
> 
> 赞同：16
> 
> 时间：2009-05-01T17:16:17.547
> 
> 标签：version-control

我从来没有真正和很多人一起工作过，我们必须检查代码并拥有旧代码的存储库等。我不确定我什至不知道这些术语的含义。如果我想开始一个新项目，该项目涉及的不仅仅是我自己，还要跟踪所有代码更改，是否“签出”（再次，不知道这意味着什么），我该如何开始？这就是SVN的用途吗？还有什么？我要下载一个跟上代码的程序吗？

我该怎么办？

这一切都将在家里。没有互联网来存储代码。

我什至不知道我所要求的是否称为源代码控制。我看到了关于签出、SVN、源代码控制等的事情。我不知道这是否都是在谈论同一件事。我希望使用一些开源的东西。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-01T17:39:08.507

所以，很久以前，在过去的糟糕日子里，源代码控制使用了一个库隐喻。如果您想编辑文件，避免冲突的唯一方法是确保您是唯一编辑该文件的人。您要做的是要求源代码控制系统“签出”该文件，这表明您正在编辑它，并且在您进行更改并且文件被“签入”之前，不允许其他人编辑它。如果您需要对已签出的文件进行更改，您必须去找那个自上周二以来检查过所有重要文件的开发人员......

无论如何，源代码控制不再像那样工作了，但是语言一直困扰着我们。如今，“签出”代码意味着从代码存储库下载代码副本。这些文件将出现在本地目录中，允许您使用它们、编译代码，甚至对源代码进行更改，如果需要，您可以稍后将其上传回存储库。更好的是，只需一个命令，您就可以获取自上次下载代码以来其他开发人员所做的所有更改。好东西。

有几个主要的源代码控制库，其中 SVN（也称为 Subversion）是其中之一（CVS、Git、HG、Perforce、ClearCase 等是其他库）。我建议从 SVN、Git 或 HG 开始，因为它们都是免费的并且都有出色的文档。

即使您是唯一的开发人员，您也可能希望开始使用源代码管理。没有什么比昨晚意识到你删除的那一千行无用的代码实际上非常重要而且现在永远丢失了更糟糕的事情了。源代码控制允许您在文件历史记录中向前和向后缩放，让您轻松恢复不应该删除的内容，并让您更有信心删除无用的内容。另外，自己摆弄它是一种很好的做法。

熟悉源代码/修订控制软件是任何认真的软件工程师的一项关键工作技能。掌握它将有效地提升您作为专业开发人员的水平。进入一个项目并发现团队将所有源代码都保存在某个文件夹中是一种糟糕的经历。祝你好运！只要有兴趣，您就已经走在正确的道路上！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-01T17:19:19.567

查看 Eric Sink 的优秀系列文章：

[源代码控制 HOWTO](http://www.ericsink.com/scm/source_control.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T17:29:20.450

我推荐[Git](http://git-scm.com/ "吉特")和[Subversion (SVN)](http://subversion.tigris.org/ "颠覆 (SVN)")作为运行良好的免费、开源版本控制系统。Git 有一些很好的特性，因为它可以更容易地去中心化工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T17:40:45.617

签出意味着从源代码控制系统中检索文件。源代码控制系统是一个数据库（有些，如[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)，只使用特别标记的文本文件，但文件系统也是一个数据库），它包含您代码的所有版本（在您进行修改后签入）。

Microsoft [Visual SourceSafe](http://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe)使用一个非常专有的数据库，如果不定期维护它很容易损坏，并且只使用保留的结帐。出于所有这些原因，不要使用它。

预订结账和非预订结账之间的区别在于非预订结账；两个人可以同时修改同一个文件。第一个签入没有问题，第二个必须将他们的代码更新到最新版本并将更改合并到他们的（这通常会自动发生，但如果文件的同一区域被更改，那么就会有冲突，必须先解决才能签入）。

有关无保留结帐的一些论据，请参见[此处](http://www.cvsnt.org/manual/html/Choosing-a-model.html)。

在此之后，您将看到一个独立检查代码并构建源代码的构建过程，以便每个人的更改都被构建和分发在一起。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T17:23:42.490

您是否正在创建需要源代码控制的项目？如果是这样，请选择满足您需求的源代码控制系统，并阅读文档以了解如何设置它。如果您只是为现有项目使用以前设置的源代码控制系统，请询问一直在使用它的同事，或询问设置源代码控制系统的人。

为了选择满足您需求的源代码控制系统，大多数源代码控制系统在网上都有对其功能的广泛描述，许多提供评估甚至完全免费的产品，并且有很多很多关于每个单独的源代码控制系统工作的轶事描述喜欢，这可以提供帮助。

如果您重视自己的理智和代码，请不要使用 Microsoft [Visual SourceSafe 。](http://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe)

# .net - 如何在.NET中创建12个字符长的随机文件夹名称

> ID：812310
> 
> 赞同：4
> 
> 时间：2009-05-01T17:16:38.873
> 
> 标签：.net, guid, base64, auto-generate

我想在我的网站上创建随机文件夹名称来存储图像及其缩略图，但我没有使用生成的 guid 的完整版本，而是考虑只使用它的一部分，可能只是前 8 个字符，可能还有 base64 编码它。我担心可能发生的碰撞。

有人可以为我指出正确的方向，这是否是一个足够好的主意？如果我想将名称保留在一定数量的字符下，是否可以使用其他解决方案？

**更新**：我试图远离 path.GetRandomFileName ，因为它使用原始 guid 并且不是 12 个字符长......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-01T17:35:52.697

为什么不直接使用这样的东西，然后循环直到可以创建文件而不会发生冲突？

```
 const string ValidChars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";

 static string GenerateName(Random random, int length)
 {
     char[] chars = new char[length];
     for (int i=0; i < length; i++)
     {
         chars[i] = ValidChars[random.Next(ValidChars.Length)];
     }
     return new string(chars);
 } 
```

传入 RNG 的原因是避免在方法中创建新 RNG（快速连续调用时重复）而不使用静态 RNG（不是线程安全的）的典型问题。

另一种方法是使用单个静态只读 RNG，并`GenerateName`通过锁定在其中序列化调用。

要点是，您*以某种方式*生成了一个随机名称，并且您只是继续尝试创建具有随机名称的文件，直到您成功，这很可能会很快发生（12 个字符 [AZ 0-9] 给出了 4,738,381,338,321,616,896 种可能的组合）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T17:19:31.503

System.IO.Path.GetRandomFileName()

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T17:18:26.077

您可以使用 System.IO 中的 Path 类来生成随机文件和文件夹名称等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T17:33:34.980

如果您正在为您的网站使用数据库，那么您可以使用自动递增的数字或序列来为图像生成唯一的文件名。

使用 Oracle，您将创建一个序列，如下所示；

CREATE SEQUENCE sequence_name MINVALUE 值 MAXVALUE 值 START WITH value INCREMENT BY value CACHE 值；

要获取序列中的下一个值，请使用序列的 nextval。例如

创建序列 seq_user_id;

从双重选择 seq_user_id.NEXTVAL；

INSERT INTO test_bed (user_id, class_type, room_location) VALUES (seq_user_id.NEXTVAL, 'Underwater Basketweaving', 'RM1205');

# c# - 为 ASP.NET 编写月份和年份下拉列表的最佳方法是什么？

> ID：812330
> 
> 赞同：12
> 
> 时间：2009-05-01T17:21:54.820
> 
> 标签：c#, asp.net, vb.net, webforms

我有一个内部应用程序，我需要一个包含两个日期类型元素的下拉列表： **Month**和**Year**。这些值不在数据库或其他信息库中。

我知道我可以通过将所需的值添加到类似对象的字典中来设置一个列表（我需要将月份与数字表示相关联，一月 => 01）：

```
var months = new Dictionary<String,String>();
months.Add("01", "January");
... 
```

今年的下拉列表会更容易一些，因为我可以选择一个起始年份并在通用列表中迭代到当前或当前+1 年。

有没有更好的方法来处理这些数据元素？内置的东西，还是我应该实现的好的设计模式？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-01T17:28:38.190

您可以使用它来获取所有月份名称的列表并遍历它。

```
CultureInfo.CurrentCulture.DateTimeFormat.MonthNames 
```

您可以像这样使用它...使用月份的索引作为下拉列表的值

```
var months = CultureInfo.CurrentCulture.DateTimeFormat.MonthNames;
for (int i = 0; i < months.Length; i++)
{
     ddl.Items.Add(new ListItem(months[i], i.ToString()));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T17:55:40.963

扩展@Jesse Brown的答案......

使用**using System.Globalization**指令，我有以下代码：

```
for (int x = 0; x < 12; x++)
{
    cboMonth.Items.Add
    (
       (x+1).ToString("00") 
       + " " 
       + CultureInfo.CurrentCulture.DateTimeFormat.MonthNames.GetValue(x)
     );
} 
```

这会生成一个下拉列表，如下所示：

1 月 1 日 2 月 2 日 3 月 3 日 ... 12 月 12 日

进一步的改进可能是通过添加以下内容使显示的月份成为当前月份：

```
cboMonth.Text = DateTime.Now.Month.ToString("00") 
   + " " 
   + CultureInfo.CurrentCulture.DateTimeFormat.MonthNames.GetValue(DateTime.Now.Month); 
```

在 for 循环之后。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T18:11:44.683

这是我的解决方案，与@jesse-brown 的解决方案非常相似（已接受的答案）

VB.NET：

在全局函数类中：

```
Public Shared Function GetMonthList() As Generic.Dictionary(Of String, String)
    Dim months As New Generic.Dictionary(Of String, String)()
    For m As Int32 = 1 To 12
        months.Add(String.Format("{0:0#}", m), CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(m))
    Next

    Return months
End Function 
```

在 ASPX 页面上：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    ddMonth.DataSource = GlobalFunctions.GetMonthList()
    ddMonth.DataValueField = "Key"
    ddMonth.DataTextField = "Value"
    ddMonth.DataBind()

End Sub 
```

这个实现在 VB.NET 中，因为这恰好是这个 webapp 正在使用的（旧版），但是非常感谢 C#（我的首选语言）中的示例，我在这里发布 VB.NET 来帮助 VB .NET 社区也是如此。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-08T10:29:46.420

下面的代码是加载月份下拉菜单作为**选择**

```
 private void LoadMonth()
    {
        ddlmonth.Items.Add(new ListItem("Select", 0.ToString()));
        var months = CultureInfo.CurrentCulture.DateTimeFormat.MonthNames;
        for (int i = 0; i < months.Length-1; i++)
        {
            ddlmonth.Items.Add(new ListItem(months[i], (i+1).ToString()));
        }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-06T00:46:03.523

对于 ASP.NET MVC，这就是我正在做的。

注意[我更喜欢对这样的事情使用代码隐藏](https://stackoverflow.com/questions/108320/code-behind-in-asp-net-mvc/527189#527189)- 它仍然是视图的一部分，构造 SelectList 的视图没有任何问题。

**支付控制.ascx**

```
 <%= Html.DropDownList("ExpirationMonth", ExpirationMonthDropdown)%> / 
 <%= Html.DropDownList("ExpirationYear", ExpirationYearDropdown)%> 
```

**PaymentControl.ascx.cs**

```
public partial class PaymentControl : ViewUserControl<CheckoutModel>
    {
        public IEnumerable<SelectListItem> ExpirationMonthDropdown
        {
            get
            {
                return Enumerable.Range(1, 12).Select(x =>

                    new SelectListItem()
                    {
                        Text = CultureInfo.CurrentCulture.DateTimeFormat.AbbreviatedMonthNames[x - 1] + " (" + x + ")",
                        Value = x.ToString(),
                        Selected = (x == Model.ExpirationMonth)
                    });
            }
        }

        public IEnumerable<SelectListItem> ExpirationYearDropdown
        {
            get
            {
                return Enumerable.Range(DateTime.Today.Year, 20).Select(x =>

                new SelectListItem()
                {
                    Text = x.ToString(),
                    Value = x.ToString(),
                    Selected = (x == Model.ExpirationYear)
                });
            }
        }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-18T11:12:14.757

```
 public void bind_month()
    {
        var months = CultureInfo.CurrentCulture.DateTimeFormat.MonthNames;

        ddl_month.Items.Insert(0, new ListItem("--Select--", "0"));

        for (int i = 0; i < months.Length-1; i++)
        {
            ddl_month.Items.Add(new ListItem(months[i],(i+1).ToString()));
        }

    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-09T14:42:48.823

有人问他们想要月份的数字表示。这是我的代码隐藏：

```
// DOB MONTHS
dob_month1.Items.Insert(0, new ListItem("Select", "")); 
var months = CultureInfo.CurrentCulture.DateTimeFormat.MonthNames;
for (int i = 1; i < months.Length; i++)
{
    dob_month1.Items.Add(new ListItem(i.ToString(), i.ToString()));
} 
```

与答案代码基本相同，稍作调整。

结果：

[![在此处输入图像描述](https://i.stack.imgur.com/lc8Jf.png)](https://i.stack.imgur.com/lc8Jf.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-28T07:07:23.013

/*尝试使用此代码在不使用数据库的情况下在下拉列表中绑定所有月份*/

```
 public void GetMonthList(DropDownList ddl)
    {
        DateTime month = Convert.ToDateTime("1/1/2000");
        for (int i = 0; i < 12; i++)
        {
            DateTime NextMont = month.AddMonths(i);
            ListItem list = new ListItem();
            list.Text = NextMont.ToString("MMMM");
            list.Value = NextMont.Month.ToString();
            ddl.Items.Add(list);
        }
        //ddl.Items.Insert(0, "Select Month");
        ddl.Items.FindByValue(DateTime.Now.Month.ToString()).Selected = true;
    } 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-06-14T02:52:02.453

你可以试试这个......参考这里：

[http://allinworld99.blogspot.com/2015/01/bind-monthsyear-dropdownlist-c-aspnet.html](http://allinworld99.blogspot.com/2015/01/bind-monthsyear-dropdownlist-c-aspnet.html)

```
for (int i = 1; i <= 12; i++)
{
    drpBMonth.Items.Add(new System.Web.UI.WebControls.ListItem(DateTimeFormatInfo.CurrentInfo.GetMonthName(i), i.ToString()))}; 
```

# sharepoint-2007 - 从一个盒子完整备份 SharePoint 数据库并还原到另一个盒子的最简单方法

> ID：812338
> 
> 赞同：3
> 
> 时间：2009-05-01T17:23:43.723
> 
> 标签：sharepoint-2007, backup, restore

我需要将在生产服务器上运行的 SharePoint 应用程序完整备份到运行 SharePoint 的测试服务器。

我尝试使用 Central Admin 从 prod 服务器备份，压缩备份，然后恢复到测试服务器，但这不起作用。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T21:03:26.690

啊，SharePoint。未记录的功能比比皆是...

可悲的事实是，中央管理并不总是以与 stsadm 命令行实用程序相同的方式执行命令（而 stsadm 可以正确执行）。确保成功的最佳方法是使用 stsadm 工具进行备份/恢复。

我使用我随身携带的批处理文件在 SharePoint 中的备份/恢复操作方面取得了很大的成功（它每晚在计划任务上运行）。这是执行备份的批处理文件的内容：

```
Set Day=%date:~7,2%
Set Month=%date:~4,2%
Set Year=%date:~10,4%
Set DateStamp=%Year%_%Month%_%Day%

SET BackupFileName=BACKUP_FILE_NAME
SET SiteUrl=http://YOUR_PORTAL_URL

C: 
CD \Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\BIN 
stsadm.exe -o backup -overwrite -url %SiteUrl% -filename C:\ScheduledTasks\Backups\%BackupFileName%_%DateStamp%.dat 
```

该批处理文件会将整个站点备份的 .dat 文件保存在执行它的同一目录中。

来到我需要进行恢复的地方，这是我使用的命令：

```
C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\BIN 
    stsadm.exe -o restore -url http://YOUR_PORTAL_URL -filename "C:\PATH_TO_BACKUP\BACKUP_FILE_TO_RESTORE.dat" -overwrite 
```

您唯一要做的就是将 .dat 文件从一台服务器移动到另一台服务器并运行恢复命令。虽然此命令将覆盖整个门户的内容数据库，但它不会带来您的 SSP 或任何其他管理中心设置 - 它仅适用于位于您在备份批处理文件中指定的 URL 的网站集。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:26:51.493

Also of note, as of the April CU cross-farm backup/restores for publishing sites are now supported:

[http://blogs.technet.com/stefan_gossner/archive/2009/05/01/red-is-green-up-is-down-and-the-unsupported-suddenly-becomes-supported.aspx](http://blogs.technet.com/stefan_gossner/archive/2009/05/01/red-is-green-up-is-down-and-the-unsupported-suddenly-becomes-supported.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T17:32:22.780

stsadm 效果很好，这里有[一篇博客文章来介绍这些命令](http://blogs.msdn.com/gayanpeiris/archive/2008/03/16/back-up-and-restore-by-using-stsadm.aspx)

# java - How to interrupt a BlockingQueue which is blocking on take()?

> ID：812342
> 
> 赞同：89
> 
> 时间：2009-05-01T17:24:35.797
> 
> 标签：java, concurrency, blockingqueue

I have a class that takes objects from a `BlockingQueue` and processes them by calling `take()` in a continuous loop. At some point I know that no more objects will be added to the queue. How do I interrupt the `take()` method so that it stops blocking?

Here's the class that processes the objects:

```
public class MyObjHandler implements Runnable {

  private final BlockingQueue<MyObj> queue;

  public class MyObjHandler(BlockingQueue queue) {
    this.queue = queue;
  }

  public void run() {
    try {
      while (true) {
        MyObj obj = queue.take();
        // process obj here
        // ...
      }
    } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
    }
  }
} 
```

And here's the method that uses this class to process objects:

```
public void testHandler() {

  BlockingQueue<MyObj> queue = new ArrayBlockingQueue<MyObj>(100);  

  MyObjectHandler  handler = new MyObjectHandler(queue);
  new Thread(handler).start();

  // get objects for handler to process
  for (Iterator<MyObj> i = getMyObjIterator(); i.hasNext(); ) {
    queue.put(i.next());
  }

  // what code should go here to tell the handler
  // to stop waiting for more objects?
} 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-01T17:29:24.973

If interrupting the thread is not an option, another is to place a "marker" or "command" object on the queue that would be recognized as such by MyObjHandler and break out of the loop.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-01T17:27:09.783

```
BlockingQueue<MyObj> queue = new ArrayBlockingQueue<MyObj>(100);
MyObjectHandler handler = new MyObjectHandler(queue);
Thread thread = new Thread(handler);
thread.start();
for (Iterator<MyObj> i = getMyObjIterator(); i.hasNext(); ) {
  queue.put(i.next());
}
thread.interrupt(); 
```

However, if you do this, the thread might be interrupted while there are still items in the queue, waiting to be processed. You might want to consider using [`poll`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#poll(long,%20java.util.concurrent.TimeUnit)) instead of `take`, which will allow the processing thread to timeout and terminate when it has waited for a while with no new input.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-12-26T13:51:39.477

**Very late but Hope this helps other too as** I faced the similar problem and used the `poll` approach suggested by [erickson above](https://stackoverflow.com/questions/812342/how-to-interrupt-a-blockingqueue-which-is-blocking-on-take/812354#812354) with some minor changes,

```
class MyObjHandler implements Runnable 
{
    private final BlockingQueue<MyObj> queue;
    public volatile boolean Finished;  //VOLATILE GUARANTEES UPDATED VALUE VISIBLE TO ALL
    public MyObjHandler(BlockingQueue queue) 
    {
        this.queue = queue;
        Finished = false;
    }
    @Override
    public void run() 
    {        
        while (true) 
        {
            try 
            {
                MyObj obj = queue.poll(100, TimeUnit.MILLISECONDS);
                if(obj!= null)//Checking if job is to be processed then processing it first and then checking for return
                {
                    // process obj here
                    // ...
                }
                if(Finished && queue.isEmpty())
                    return;

            } 
            catch (InterruptedException e) 
            {                   
                return;
            }
        }
    }
}

public void testHandler() 
{
    BlockingQueue<MyObj> queue = new ArrayBlockingQueue<MyObj>(100); 

    MyObjHandler  handler = new MyObjHandler(queue);
    new Thread(handler).start();

    // get objects for handler to process
    for (Iterator<MyObj> i = getMyObjIterator(); i.hasNext(); )
    {
        queue.put(i.next());
    }

    // what code should go here to tell the handler to stop waiting for more objects?
    handler.Finished = true; //THIS TELLS HIM
    //If you need you can wait for the termination otherwise remove join
    myThread.join();
} 
```

**This solved both the problems**

1.  Flagged the `BlockingQueue` so that it knows it has not to wait more for elements
2.  Did not interrupted in between so that processing blocks terminates only when all the items in queue are processed and there are no items remaining to be added

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T17:28:00.203

Interrupt the thread:

```
thread.interrupt() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T02:32:01.603

Or don't interrupt, its nasty.

```
 public class MyQueue<T> extends ArrayBlockingQueue<T> {

        private static final long serialVersionUID = 1L;
        private boolean done = false;

        public ParserQueue(int capacity) {  super(capacity); }

        public void done() { done = true; }

        public boolean isDone() { return done; }

        /**
         * May return null if producer ends the production after consumer 
         * has entered the element-await state.
         */
        public T take() throws InterruptedException {
            T el;
            while ((el = super.poll()) == null && !done) {
                synchronized (this) {
                    wait();
                }
            }

            return el;
        }
    } 
```

1.  when producer puts object to the queue, call `queue.notify()`, if it ends, call `queue.done()`
2.  loop while (!queue.isDone() || !queue.isEmpty())
3.  test take() return value for null

# c# - 为什么 ObservableCollection 隐藏 INotifyPropertyChanged.PropertyChanged

> ID：812353
> 
> 赞同：3
> 
> 时间：2009-05-01T17:27:03.043
> 
> 标签：c#, wpf, xaml, observablecollection, data-binding

我有一个派生自 ObservableCollection 的类。我想向这个类添加一些属性（不是集合中的项目），但发现它的 PropertyChanged 实现是受保护的。由于它受到保护，我认为这就是我在 XAML 中绑定到这些新属性的尝试失败的原因。

如果没有创建一个挂起这个实现 INotifyPropertyChanged 并容纳这些新属性的类的对象，有没有一种我忽略的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T17:35:47.547

如果该类实际上实现了接口，但显式地这样做并在具体实现上放置了访问修饰符，那么您需要做的就是在接口本身的上下文中获取该对象，然后您就可以使用它了。例如..

```
ObservableCollection collection;

collection.PropertyChanged += ...; 
```

这可能会失败，因为它的实现`PropertyChanged`是受保护的。但是，您可以这样做：

```
ObservableCollection collection;

INotifyPropertyChanged iproperty = collection;

iproperty.PropertyChanged += ...; 
```

这应该可以工作，因为您将对象作为接口的实例来处理，而不仅仅是通过类定义访问接口成员。

我还没有做过任何 WPF，所以我不知道是否`ObservableCollection`真的实现`INotifyPropertyChanged`了，但如果确实如此，那么这应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:43:30.557

ObservableCollection 确实实现了 INotifyPropertyChanged， http: [//msdn.microsoft.com/en-us/library/bb460458.aspx](http://msdn.microsoft.com/en-us/library/bb460458.aspx)，但是......

我似乎过早地发布了这个问题，我的测试应用程序可以挑战我的假设。

# hibernate - 如何确定 Hibernate PostUpdateEventListener 中的集合更改？

> ID：812364
> 
> 赞同：4
> 
> 时间：2009-05-01T17:29:50.853
> 
> 标签：hibernate

在 Hibernate 中，实现**PostUpdateEventListener**允许您插入 Hibernate 的工作流程，并让您有机会在保存实体属性时检查和比较它的旧值和新值（**PostUpdateEvent**有方法**getOldState()**和**getState()**返回一个这些值的数组）。对于标准属性，这工作得很好。但是，如果其中一个属性是*内容*已更改的 Collection，这无济于事：“旧值”和“新值”都是对 Collection 的相同引用（因为 Collection 本身没有更改，只是其内容）。这意味着您只能看到该集合的最新即“新”内容。

任何人都知道是否有一种方法可以确定实体拥有的集合的元素在工作流程的这一点上是如何变化的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T11:59:26.817

我想出了一种方法来做到这一点，所以我会发布它以防其他人使用。此代码循环遍历所有“旧状态”属性，并且对于任何持久集合，获取先前的内容“快照”。然后它将它包装在一个不可修改的集合中以进行良好的测量：

```
public void onPostUpdate( PostUpdateEvent event )
{       
   for ( Object item: event.getOldState() )
   {
      Object previousContents = null;

      if ( item != null && item instanceof PersistentCollection )               
      {
         PersistentCollection pc = (PersistentCollection) item;
         PersistenceContext context = session.getPersistenceContext();            
         CollectionEntry entry = context.getCollectionEntry( pc );
         Object snapshot = entry.getSnapshot();

         if ( snapshot == null )
            continue;

         if ( pc instanceof List )
         {
            previousContents = Collections.unmodifiableList( (List) snapshot );
         }        
         else if ( pc instanceof Map )
         {
            previousContents = Collections.unmodifiableMap( (Map) snapshot );
         }
         else if ( pc instanceof Set )
         {  
            //Set snapshot is actually stored as a Map                
            Map snapshotMap = (Map) snapshot;
            previousContents = Collections.unmodifiableSet( new HashSet( snapshotMap.values() ) );          
         }
         else
           previousContents = pc;

      //Do something with previousContents here
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T02:51:50.163

似乎有一个专门用于捕获集合更改的接口。

[审计日志实施完整](http://taylor.sourceforge.net/taylor-audit/xref/net/taylor/audit/AuditListener.html)

```
 public void onPreUpdateCollection(PreCollectionUpdateEvent event) {
    if (bypass(event.getAffectedOwnerOrNull().getClass())) {
        return;
    }
    CollectionEntry collectionEntry = getCollectionEntry(event);    
 }

 protected CollectionEntry getCollectionEntry(AbstractCollectionEvent event) {
     return event.getSession().getPersistenceContext()
            .getCollectionEntry(event.getCollection());
 } 
```

# asp.net - ASP.NET 应用程序安装 - 需要策略

> ID：812366
> 
> 赞同：2
> 
> 时间：2009-05-01T17:30:33.503
> 
> 标签：asp.net, sql, iis

我已经构建了一个开源 ASP.NET Web 应用程序，现在我正朝着发布的方向前进。我热衷于为我的用户提供简单的安装，但我在提出解决方案时遇到了真正的问题。

该应用程序需要在 IIS 中设置站点并安装 SQL 数据库。您能想到的对我的用户来说最简单的部署过程是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:35:28.203

查看新的 Web 平台安装程序。

[http://www.microsoft.com/Web/downloads/platform.aspx](http://www.microsoft.com/Web/downloads/platform.aspx)

我没看过，但知道保罗：

[http://www.motusconnect.com/blog/2009/4/29/installing-umbraco-using-the-web-platform-installer](http://www.motusconnect.com/blog/2009/4/29/installing-umbraco-using-the-web-platform-installer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:34:22.980

您可以在 Visual Studio 中创建设置和部署项目，以帮助将应用程序正确放置在 IIS 中。至于数据库设置，您可能会考虑在您的网站中编写一个设置表单，该表单可以调用一次以根据用户输入初始化数据库（想想流行的开源项目（如 WordPress 或 phpBB）执行向导类型的设置过程功能）。

Scott Guthrie 还有一篇非常酷的博客文章，关于[在此处创建部署项目](http://weblogs.asp.net/scottgu/archive/2007/06/15/tip-trick-creating-packaged-asp-net-setup-programs-with-vs-2005.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T17:35:06.473

对您的用户来说最简单的是 MSI，它允许他们通过 GUI 选择任何相关选项。它还有一个优点是您可以使用 MSI 对其进行升级，并且想要自动化它的人可以使用 MsiExec 安装它。

开始使用 MSI 的一个好地方是[WiX](http://wix.sourceforge.net/)。

# javascript - 使用 ExtJS 的富互联网应用程序：我应该选择哪个方向？

> ID：812401
> 
> 赞同：2
> 
> 时间：2009-05-01T17:38:43.017
> 
> 标签：javascript, ria

我需要一些帮助来为我的 RIA 选择正确的方法。我确实想使用一个 javascript 小部件库 - 可能是 ExtJS。但是，我不确定我是否应该尝试通过[ExtGWT](http://extjs.com/products/gxt/)或其他解决方案（如[Rialto Python](http://rialto.improve-technologies.com/wiki/python) ）来绕过 Javascript 编程。您对不需要您使用 Javascript 编程的 Web 应用程序框架有何经验？例如，如果转向 GWT，放弃像 jQuery 这样的技术是不是一个很大的劣势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:18:04.950

您不会在 ext-gwt 中失去大量功能，但它也不是完美的 ext 导入。

对我决定“编译” JavaScript 影响最大的事情是：

*   您对在 ext 库和 Java 库之间添加层感到满意吗？自然，GWT 需要胶水将您的 JavaScript 代码连接到它的 Java 代码。他们的库需要配置，有时这很烦人。
*   我发现您通常会在本机库方面获得更好的帮助。一个大本尼。jQuery 问题很快就被击倒了。我没有看到很多 GWT 问题一刀切。（也许它只是有效！现在我听起来像苹果广告）
*   我有多喜欢在 JavaScript 中工作。我喜欢 JavaScript 代码。当我不得不在 Java 中处理严格的类型时，我发现它有点烦人，而我可以在 JavaScript 中飞奔。
*   JavaScript 中的调试/修补会如何减慢我的速度？您喜欢较短的工作代码/测试周期吗？GWT 风格的方法很漂亮，因为如果它编译，它通常会做你认为它会做的事情。（代价是你失去了即时性，但大多数开发人员已经习惯了这种情况）

哦，顺便说一句，[GWTQuery](http://code.google.com/p/gwtquery/)如果您愿意的话，但同样，jQuery 的插件中有一些功能，您必须为此编写胶水。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:57:11.770

编写 javascript 的主要缺点之一是它在不同浏览器上的工作方式通常不同。然而，对于像 jQuery 这样的东西，这已经从你那里抽象出来了。请注意，GWT 也是如此。

因此，我会说，如果您更喜欢编写 Swing 应用程序，请使用 GWT；如果您更喜欢编写 Web 应用程序，请使用 html 结合 jquery 或其他 javascript 框架。

# c++ - 如何设计我的课程以利用工厂并进行扩展？

> ID：812409
> 
> 赞同：0
> 
> 时间：2009-05-01T17:39:51.530
> 
> 标签：c++, oop, factory

我的 c++ SOA 应用程序有一个“会话”概念，用于在服务之间交换数据。例如，它用于在执行提交或回滚更改的会话 B 之前检查某些服务 A 操作的合法性。任何。

我有 2 种会话模式：正常和假设。更进一步，我有不同的会话，合法性会话，分配会话，提交会话等。这是一个主要问题。合法性会话可以是假设或真实等。

如何解决这个问题并避免代码重复？

我可以制作一个*ISessionFactory*接口并让*WhatIfFactory*和*RealFactory*实现它。然后我可以制作一个*ILegalitySession*并让*WhatIfLegalitySession*和*RealLegalitySession*实现它。然后我的工厂将返回适当的对象。

它有两个主要问题。如果新模式来了怎么办？我将不得不为所有会话实施新工厂和新课程！如果出现新的会话类型怎么办？我必须改变两个工厂...

也许从 2 个层次结构中辞职并让 whatIf 会话“装饰”真实会话？如何本地化更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:44:55.060

尝试使用装饰器实现您的 WhatIf。或者将一些“假设”特定部分提取到某种策略中。

另一种选择是使用状态模式。“WhatIf”状态和“Real”状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:03:39.190

我认为[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)在这里很有意义。您可能还想查看[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)及其编译时表亲，[基于策略的设计](http://en.wikipedia.org/wiki/Policy-based_design)。如果没有更多信息，很难说哪个最好。装饰器非常适合添加其他行为，另外两个用于更改现有行为。

# java - 为什么 Spring 的 ApplicationContext.getBean 被认为不好？

> ID：812415
> 
> 赞同：298
> 
> 时间：2009-05-01T17:41:25.147
> 
> 标签：java, spring

我问了一个一般的 Spring 问题：[Auto-cast Spring Beans](https://stackoverflow.com/questions/812178/auto-cast-spring-beans)并且有很多人回答说`ApplicationContext.getBean()`应该尽可能避免调用 Spring。这是为什么？

我还应该如何访问我配置 Spring 来创建的 bean？

我在非 Web 应用程序中使用 Spring，并计划访问[LiorH 所描述](https://stackoverflow.com/questions/812178/auto-cast-spring-beans/812291#812291)`ApplicationContext`的共享对象。

**修正案**

我接受下面的答案，但这是 Martin Fowler 的另一种观点，他[讨论了依赖注入与使用服务定位器的优点](http://martinfowler.com/articles/injection.html#ServiceLocatorVsDependencyInjection)（这与调用 Wrapped 基本相同`ApplicationContext.getBean()`）。

Fowler 部分指出，“*使用服务定位器，应用程序类通过给定位器的消息显式地请求它[服务]。通过注入没有显式请求，服务出现在应用程序类中 - 因此控制反转。控制反转是框架的一个常见特性，但它是有代价的。它往往难以理解并且在你尝试调试时会导致问题。所以总的来说我更愿意避免它[控制反转] 除非我需要它。这并不是说这是一件坏事，只是我认为它需要证明自己比更直接的选择更合理。* “

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2009-05-01T18:17:39.473

我在对另一个问题的评论中提到了这一点，但是控制反转的整个想法是让*你的任何一个类都不知道或关心他们如何获得他们所依赖的对象*。这使您可以轻松地随时更改您使用的给定依赖项的实现类型。它还使类易于测试，因为您可以提供依赖项的模拟实现。最后，它使类*更简单*，更专注于它们的核心职责。

调用`ApplicationContext.getBean()`不是控制反转！虽然更改为给定 bean 名称配置的实现仍然很容易，但该类现在直接依赖 Spring 来提供该依赖关系，并且无法以任何其他方式获得它。您不能只是在测试类中制作自己的模拟实现并自己将其传递给它。这基本上违背了 Spring 作为依赖注入容器的目的。

你想说的每一个地方：

```
MyClass myClass = applicationContext.getBean("myClass"); 
```

例如，您应该声明一个方法：

```
public void setMyClass(MyClass myClass) {
   this.myClass = myClass;
} 
```

然后在您的配置中：

```
<bean id="myClass" class="MyClass">...</bean>

<bean id="myOtherClass" class="MyOtherClass">
   <property name="myClass" ref="myClass"/>
</bean> 
```

然后 Spring 会自动`myClass`注入`myOtherClass`.

以这种方式声明所有内容，其根源在于：

```
<bean id="myApplication" class="MyApplication">
   <property name="myCentralClass" ref="myCentralClass"/>
   <property name="myOtherCentralClass" ref="myOtherCentralClass"/>
</bean> 
```

`MyApplication`是最核心的类，并且至少间接依赖于程序中的所有其他服务。引导时，在您的`main`方法中，您可以调用`applicationContext.getBean("myApplication")`但您不需要`getBean()`在其他任何地方调用！

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-11-12T21:55:51.513

选择服务定位器而不是控制反转 (IoC) 的原因是：

1.  其他人在您的代码中跟踪服务定位器要容易得多。IoC 是“神奇的”，但维护程序员必须了解您复杂的 Spring 配置和所有无数的位置，才能弄清楚您是如何连接对象的。

2.  IoC 对于调试配置问题很糟糕。在某些类别的应用程序中，如果配置错误，应用程序将无法启动，并且您可能没有机会逐步了解调试器正在发生的事情。

3.  IoC 主要是基于 XML 的（注解改进了一些东西，但仍然有很多 XML）。这意味着除非开发人员知道 Spring 定义的所有魔术标签，否则他们无法处理您的程序。再懂 Java 还不够好。这会阻碍经验不足的程序员（即，当更简单的解决方案（例如服务定位器）将满足相同的要求时，使用更复杂的解决方案实际上是糟糕的设计）。此外，对诊断 XML 问题的支持远弱于对 Java 问题的支持。

4.  依赖注入更适合大型程序。大多数时候，额外的复杂性是不值得的。

5.  通常使用 Spring 以防您“以后可能想更改实现”。还有其他方法可以在没有 Spring IoC 的复杂性的情况下实现这一点。

6.  对于 Web 应用程序（Java EE WAR），Spring 上下文在编译时有效绑定（除非您希望操作员在爆炸式战争中围绕上下文进行挖掘）。您可以让 Spring 使用属性文件，但使用 servlet 时，属性文件需要位于预先确定的位置，这意味着您不能在同一个盒子上同时部署多个 servlet。您可以使用带有 JNDI 的 Spring 在 servlet 启动时更改属性，但是如果您将 JNDI 用于管理员可修改的参数，则对 Spring 本身的需求会减少（因为 JNDI 实际上是一个服务定位器）。

7.  使用 Spring，如果 Spring 正在调度您的方法，您可能会失去程序控制。这很方便，适用于许多类型的应用程序，但不是全部。当您需要在初始化期间创建任务（线程等）或需要 Spring 不知道内容何时绑定到您的 WAR 的可修改资源时，您可能需要控制程序流。

Spring 非常适合事务管理，并且有一些优势。只是 IoC 在许多情况下可能会过度设计，并给维护者带来不必要的复杂性。不要在没有首先考虑不使用它的方法的情况下自动使用 IoC。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-09-07T11:35:09.270

确实，在 application-context.xml 中包含该类可以避免使用 getBean。然而，即使这样实际上也是不必要的。如果您正在编写一个独立的应用程序并且您不想在 application-context.xml 中包含您的驱动程序类，您可以使用以下代码让 Spring 自动装配驱动程序的依赖项：

```
public class AutowireThisDriver {

    private MySpringBean mySpringBean;    

    public static void main(String[] args) {
       AutowireThisDriver atd = new AutowireThisDriver(); //get instance

       ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(
                  "/WEB-INF/applicationContext.xml"); //get Spring context 

       //the magic: auto-wire the instance with all its dependencies:
       ctx.getAutowireCapableBeanFactory().autowireBeanProperties(atd,
                  AutowireCapableBeanFactory.AUTOWIRE_BY_TYPE, true);        

       // code that uses mySpringBean ...
       mySpringBean.doStuff() // no need to instantiate - thanks to Spring
    }

    public void setMySpringBean(MySpringBean bean) {
       this.mySpringBean = bean;    
    }
} 
```

当我有某种独立类需要使用我的应用程序的某些方面（例如用于测试）但我不想将它包含在应用程序上下文中时，我需要这样做几次，因为它不是实际上是应用程序的一部分。另请注意，这避免了使用字符串名称查找 bean 的需要，我一直认为这很丑陋。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-05-01T17:46:37.677

使用 Spring 之类的最酷的好处之一是您不必将对象连接在一起。Zeus 的脑袋裂开了，你的类出现了，它们的所有依赖项都已根据需要创建和连接。这是神奇而美妙的。

你说的越多`ClassINeed classINeed = (ClassINeed)ApplicationContext.getBean("classINeed");`，你得到的魔法就越少。更少的代码几乎总是更好。如果你的班级真的需要一个 ClassINeed bean，你为什么不直接把它连线呢？

也就是说，显然需要创建第一个对象。您的 main 方法通过 getBean() 获取一两个 bean 并没有错，但是您应该避免使用它，因为无论何时使用它，您并没有真正使用 Spring 的所有魔力。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-05-01T17:48:12.010

动机是编写不明确依赖于 Spring 的代码。这样，如果您选择切换容器，则无需重写任何代码。

将容器视为您的代码不可见的东西，神奇地满足其需求，无需被询问。

依赖注入是“服务定位器”模式的对立面。如果您要按名称查找依赖项，则最好摆脱 DI 容器并使用 JNDI 之类的东西。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-03-29T07:57:20.600

使用`@Autowired`or`ApplicationContext.getBean()`真的是一回事。在这两种方式中，您都可以获得在您的上下文中配置的 bean，并且在这两种方式中，您的代码都依赖于 spring。您应该避免的唯一一件事是实例化您的 ApplicationContext。只做一次！换句话说，像这样的一行

```
ApplicationContext context = new ClassPathXmlApplicationContext("AppContext.xml"); 
```

只能在您的应用程序中使用一次。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-01T23:09:14.767

Spring 的前提之一是避免[耦合](http://en.wikipedia.org/wiki/Coupling_(computer_science))。定义和使用接口、DI、AOP 并避免使用 ApplicationContext.getBean() :-)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-01-25T13:59:50.817

原因之一是可测试性。假设你有这个类：

```
interface HttpLoader {
    String load(String url);
}
interface StringOutput {
    void print(String txt);
}
@Component
class MyBean {
    @Autowired
    MyBean(HttpLoader loader, StringOutput out) {
        out.print(loader.load("http://stackoverflow.com"));
    }
} 
```

你怎么能测试这个bean？比如像这样：

```
class MyBeanTest {
    public void creatingMyBean_writesStackoverflowPageToOutput() {
        // setup
        String stackOverflowHtml = "dummy";
        StringBuilder result = new StringBuilder();

        // execution
        new MyBean(Collections.singletonMap("https://stackoverflow.com", stackOverflowHtml)::get, result::append);

        // evaluation
        assertEquals(result.toString(), stackOverflowHtml);
    }
} 
```

容易，对吧？

虽然您仍然依赖于 Spring（由于注释），但您可以在不更改任何代码（仅注释定义）的情况下删除对 Spring 的依赖，并且测试开发人员不需要了解 Spring 的工作原理（也许他无论如何都应该知道，但是它允许与 spring 分开审查和测试代码）。

使用 ApplicationContext 时仍然可以这样做。但是，您需要模拟`ApplicationContext`一个巨大的界面。您要么需要一个虚拟实现，要么可以使用 Mockito 等模拟框架：

```
@Component
class MyBean {
    @Autowired
    MyBean(ApplicationContext context) {
        HttpLoader loader = context.getBean(HttpLoader.class);
        StringOutput out = context.getBean(StringOutput.class);

        out.print(loader.load("http://stackoverflow.com"));
    }
}
class MyBeanTest {
    public void creatingMyBean_writesStackoverflowPageToOutput() {
        // setup
        String stackOverflowHtml = "dummy";
        StringBuilder result = new StringBuilder();
        ApplicationContext context = Mockito.mock(ApplicationContext.class);
        Mockito.when(context.getBean(HttpLoader.class))
            .thenReturn(Collections.singletonMap("https://stackoverflow.com", stackOverflowHtml)::get);
        Mockito.when(context.getBean(StringOutput.class)).thenReturn(result::append);

        // execution
        new MyBean(context);

        // evaluation
        assertEquals(result.toString(), stackOverflowHtml);
    }
} 
```

这是很有可能的，但我认为大多数人会同意第一个选项更优雅，并且使测试更简单。

唯一真正有问题的选择是这个：

```
@Component
class MyBean {
    @Autowired
    MyBean(StringOutput out) {
        out.print(new HttpLoader().load("http://stackoverflow.com"));
    }
} 
```

对此进行测试需要付出巨大的努力，否则您的 bean 将尝试在每个测试中连接到 stackoverflow。一旦你出现网络故障（或者stackoverflow的管理员由于访问率过高而阻止你），你将随机失败测试。

所以作为一个结论，我不会说`ApplicationContext`直接使用是自动错误的，应该不惜一切代价避免。但是，如果有更好的选择（并且在大多数情况下都有），那么请使用更好的选择。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-01T17:47:02.823

这个想法是您依赖依赖注入（[控制反转](http://en.wikipedia.org/wiki/Inversion_of_control)，或 IoC）。也就是说，您的组件配置了它们需要的组件。这些依赖项是*注入*的（通过构造函数或设置器） - 你自己不会得到。

`ApplicationContext.getBean()`要求您在组件中显式命名 bean。相反，通过使用 IoC，您的配置可以确定将使用哪个组件。

这使您可以轻松地使用不同的组件实现重新连接您的应用程序，或者通过提供模拟变体以简单的方式配置对象以进行测试（例如，模拟 DAO，这样您就不会在测试期间访问数据库）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-05-01T18:03:41.660

其他人已经指出了一般性问题（并且是有效的答案），但我只提供一个额外的评论：这并不是说你永远不应该这样做，而是尽可能少地这样做。

通常这意味着它只执行一次：在引导期间。然后只是访问“根”bean，通过它可以解决其他依赖关系。这可以是可重用的代码，例如基本 servlet（如果开发 Web 应用程序）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-01T18:24:38.583

我只发现了两种需要 getBean() 的情况：

其他人提到在 main() 中使用 getBean() 来获取独立程序的“主”bean。

我对 getBean() 的另一个用途是在交互式用户配置确定特定情况下的 bean 构成的情况下。因此，例如，引导系统的一部分使用带有 scope='prototype' bean 定义的 getBean() 循环通过数据库表，然后设置其他属性。据推测，有一个 UI 可以调整数据库表，这比尝试（重新）编写应用程序上下文 XML 更友好。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-04-27T20:18:40.630

还有一次使用 getBean 是有意义的。如果您正在重新配置一个已经存在的系统，其中依赖项没有在 spring 上下文文件中显式调用。您可以通过调用 getBean 来启动该过程，这样您就不必一次将其全部连接起来。通过这种方式，您可以慢慢地建立您的弹簧配置，随着时间的推移将每个部件放置到位，并让钻头正确排列。对 getBean 的调用最终将被替换，但是当您了解代码结构或缺少代码结构时，您可以开始连接越来越多的 bean 并使用越来越少的 getBean 调用的过程。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-09-27T09:45:45.757

但是，仍然存在需要服务定位器模式的情况。例如，我有一个控制器 bean，这个控制器可能有一些默认服务 bean，可以通过配置注入依赖项。虽然这个控制器现在或以后可以调用许多额外的或新的服务，但需要服务定位器来检索服务 bean。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-05-19T07:01:04.103

您应该使用： ConfigurableApplicationContext 而不是 for ApplicationContext

# python - 为什么 python 日志记录包不支持打印可变长度参数？

> ID：812422
> 
> 赞同：2
> 
> 时间：2009-05-01T17:44:04.143
> 
> 标签：python, logging

当我第一次学习 Python 时，我已经习惯了这样做：

```
 print "text", lineNumber, "some dictionary", my_dict 
```

当我编写自己的日志工具时，我自然希望能够将任意大小的项目列表交给它，所以我这样做了：

```
def error(*args):
   print ERR_PREFIX,
   for _x in args:
      print _x,
   print "\r\n",

error("text", lineNumber, "some dictionary", my_dict) 
```

现在我想开始使用 logging 包，因为它有很多好东西，而且我不想复制他们的努力。总的来说，它看起来像一个干净的设计，可以做很多事情。但是，您不能再将相同的项目列表呈现给它以供打印，这让我感到困扰。相反，我必须将所有调用更改为更像这样的内容：

```
error("text %d some dictionary %s" % (lineNumber, my_dict)) 
```

或者，我可以做一些非常愚蠢的事情：

```
error(' '.join(map, str(("text", lineNumber, "some dictionary", my_dict)))) 
```

问题是，为什么要省略这么明显的用例？如果您想从典型的“打印”语句直接转到新奇的日志记录工具，这不是更容易吗？

作为后续问题，您能想出一种方法来覆盖 Logger 类来执行此操作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T18:33:43.163

我建议最好将现有的日志消息更新为日志模块期望的样式，因为其他人查看您的代码会更容易，因为日志模块将不再按预期运行。

顺便说一句，以下代码将使日志记录模块按您的意愿运行。

```
import logging
import types

class ExtendedLogRecord(logging.LogRecord):

    def getMessage(self):
        """
        Return the message for this LogRecord.

        Return the message for this LogRecord after merging any user-supplied
        arguments with the message.
        """
        if not hasattr(types, "UnicodeType"): #if no unicode support...
            msg = str(self.msg)
        else:
            try:
                msg = str(self.msg)
            except UnicodeError:
                msg = self.msg      #Defer encoding till later
        if self.args:
            msg +=' '+' '.join(map(str,self.args))
        return msg

#Patch the logging default logging class
logging.RootLogger.makeRecord=lambda self,*args: ExtendedLogRecord(*args)

some_dict={'foo':14,'bar':15}
logging.error('text',15,'some dictionary',some_dict) 
```

输出：

```
ERROR:root:text 15 some dictionary {'foo': 14, 'bar': 15} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T23:59:57.407

修补日志记录包（作为建议的一个答案）实际上是一个坏主意，因为这意味着调用 logging.error() 的*其他*代码（您没有编写，例如标准库中的东西）将不再正常工作。

相反，您可以将现有的 error() 函数更改为调用 logging.error() 或打印：

```
def error(*args):
  logging.error('%s', ' '.join(map(str, args))) 
```

（如果可能有 unicode 对象，您必须更加小心，但您明白了。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:45:38.580

您关于日志记录的说法并不完全正确。

```
log= logging.getLogger( "some.logger" )
log.info( "%s %d", "test", value )
log.error("text %d some dictionary %s", lineNumber, my_dict) 
```

您不需要显式使用字符串格式化运算符，`%`

* * *

**编辑**

您可以利用您原来的“错误”功能。

```
def error( *args ):
    log.error( " ".join( map( str, args ) ) ) 
```

这可能会使过渡变得不那么复杂。

你也可以这样做。

```
class MyErrorMessageHandler( object ):
    def __init__( self, logger ):
        self.log= logger
    def __call__( self, *args ):
        self.log.error( " ".join( map( str, args ) ) )
error= MyErrorMessageHandler( logging.getLogger("some.name") ) 
```

这也可能是可口的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T17:50:47.323

好吧，打印和记录是两个非常不同的东西。理所当然地，它们的用法也可能完全不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:17:26.260

[动态地将方法添加到类中](http://www.daniel-lemire.com/blog/archives/2005/12/21/metaclass-programming-in-python/)相对容易。为什么不将您的方法添加到 Logging。

# iphone - UITableView 将某些单元格设置为“不可选择”

> ID：812426
> 
> 赞同：112
> 
> 时间：2009-05-01T17:45:40.940
> 
> 标签：iphone, cocoa-touch

如何将 UITableView 的单元格属性设置为不可选择？当用户点击单元格时，我不想看到那个蓝色选择框。

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-05-01T19:43:26.117

## 防止行选择

为彻底杜绝选择`UITableViewCell`，有你的`UITableViewDelegate`执行[`tableView:willSelectRowAtIndexPath:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/index.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:willSelectRowAtIndexPath:)。`nil`如果您不想选择该行，则可以从该方法返回。

```
- (NSIndexPath *)tableView:(UITableView *)tv willSelectRowAtIndexPath:(NSIndexPath *)path
{
    // Determine if row is selectable based on the NSIndexPath.

    if (rowIsSelectable) {
        return path;
    }
    return nil;
} 
```

这可以防止该行被选中和[`tableView:didSelectRowAtIndexPath:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/index.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:didSelectRowAtIndexPath:)被调用。但是请注意，这*不会*阻止该行被突出显示。

## 防止行突出显示

如果您想防止该行在触摸时被视觉突出显示，您可以确保将单元格[`selectionStyle`](https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UITableViewCell_Class/index.html#//apple_ref/occ/instp/UITableViewCell/selectionStyle)设置为`UITableViewCellSelectionStyleNone`，或者最好您可以按如下方式`UITableViewDelegate`实现：[`tableView:shouldHighlightRowAtIndexPath:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/index.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:shouldHighlightRowAtIndexPath:)

```
- (BOOL)tableView:(UITableView *)tv shouldHighlightRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Determine if row is selectable based on the NSIndexPath.

    return rowIsSelectable;
} 
```

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2009-05-01T19:54:54.093

将表格单元格的`selectionStyle`属性设置为`UITableViewCellSelectionStyleNone`。这应该会阻止它突出显示，您还可以在`tableView:didSelectRowAtIndexPath:`.

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-08-20T11:49:26.653

用这个：

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-08-06T17:44:52.140

仅适用于 iOS 6+。

`tableView:shouldHighlightRowAtIndexPath:`您可以在您的委托中实现该方法 。在这里阅读更多：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-12-29T16:13:44.153

也有这个问题，尝试了已经提到的一切。在选择表格单元格时摆脱“蓝色闪光”的最后一个技巧是添加以下行：

```
self.myTableView.allowsSelection = NO; 
```

不确定是这一行还是所有内容的组合，但作为总的结果，我没有更多的蓝色选择，甚至没有蓝色闪光。快乐的！

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2010-11-09T17:28:35.103

放`cell.userInteractionEnabled = NO;`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-03-05T06:31:03.157

使用 IB 也是一种优雅的方式：

![在此处输入图像描述](https://i.stack.imgur.com/9SdvT.png)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-01T17:49:09.137

Apple 表示您应该在 didSelectRowAtIndexPath 中做的第一件事是取消选择该行

```
[tableView deselectRowAtIndexPath:[tableView indexPathForSelectedRow] animated:NO]; 
```

然后您可以将 AccessoryType 更改为复选标记或无等。因此，当您输入 didSelectRowAtIndexPath 时，您可以取消选择该行，如果它不打算被选中，则根本不检查该行。

[表视图编程指南](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/ManageSelections/ManageSelections.html#//apple_ref/doc/uid/TP40007451-CH9)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-11-08T03:44:36.093

另一种方法是向`UITableViewCell`. 我比塞巴斯蒂安（也很好）的回答更喜欢这个，因为我建立桌子的方式。我认为这可能对其他人有帮助。

```
- (void)setSelectable:(BOOL)enabled {
    [self setSelectionStyle:UITableViewCellSelectionStyleNone];
    [self setUserInteractionEnabled:enabled];
}

- (BOOL)isSelectable {
    BOOL disabled = [self selectionStyle]==UITableViewCellSelectionStyleNone &&
                     [self isUserInteractionEnabled];
    return ! disabled;
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-03-26T23:55:10.263

**Swift 4：**
您可以使用 UITableViewDelegate 防止选择和突出显示：**shouldHighlightRowAt**

*此答案假设您创建了一个名为：**CustomTableViewCell**
的自定义单元格，并且您在该自定义单元格中创建了一个布尔值，名为：**isSelectable***

```
func tableView(_ tableView: UITableView, shouldHighlightRowAt indexPath: IndexPath) -> Bool {
    let cell = tableView.cellForRow(at: indexPath) as! CustomTableViewCell
    if cell.isSelectable == false {
        return false
    } else {
        return true
    }
} 
```

这是 Sebastian Celis 的 objc 答案的 Swift 版本。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-22T03:22:44.080

如果您在 Interface Builder 中设计了单元格，则可以通过从 ' **User Interaction Enabled** ' 中删除`tableViewCell`.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-02-06T04:54:39.143

斯威夫特 5

```
cell.isUserInteractionEnabled = false 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-02T00:40:39.497

还有另一种简单的方法可以避免选择显示为蓝色。

选择一个您不想显示为蓝色的单元格。

然后选择属性检查器（侧面属性视图上标尺图标旁边的盾牌图标）。

然后将“选择”字段从“蓝色”更改为“无”。

请注意，大概这仍在选择中，如果您只想避免 UI 效果，它将不会显示为已选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-09-27T20:58:43.657

要取消选中某些行，您必须对 UITableView 委托的两种方法进行一些更改。

在下面的方法中

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{ 
```

分配单元格后，编写以下代码

```
if(indexPath.row == someCellNumber) cell.selectionStyle =UITableViewCellSelectionStyleNone; 
```

如果用户以某种方式尝试选择，上面的代码将阻止突出显示单元格。

在下面的这个委托方法中

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
    if(indexPath.row == someCellNumber) return;

    //for other cells write the code below...
} 
```

如果你不写`if(indexPath.row == someCellNumber) return;`行仍然会被选中，并且有可能导致应用程序崩溃

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-03-25T12:51:10.750

使用 tableView: willDisplayCell: forRowAtIndexPath: 而不是 tableView: didSelectRowAtIndexPath: 摆脱第一次触摸单元格时出现的闪光。

```
- (void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-26T00:00:43.313

斯威夫特 4：

在单元格中：

```
selectionStyle = .none 
```

# sql-server - 如何安排 SSIS 包以 SQL 代理服务帐户以外的方式运行

> ID：812428
> 
> 赞同：13
> 
> 时间：2009-05-01T17:45:59.783
> 
> 标签：sql-server, sql-server-2005, ssis

在 SQL Server 2005 中，是否可以安排 SSIS 包运行 SQL 代理服务帐户以外的东西？

我有一个 SSIS 包，它可以连接到数据库并运行存储过程。我的标准是我不会在包或包配置中指定用户名/密码，所以我想使用集成身份验证。

问题是，默认情况下，作业中的一个步骤作为 SQL 代理服务帐户运行，并且我们的服务器组不想授予该帐户对我的包将执行的存储过程的执行权限。所以我们试图找到一种方法来在步骤中指定不同的帐户，以便包将在不同的上下文中运行。那可能吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2011-07-16T12:00:01.723

如果您可以`SQL Server Agent`通过 SQL Server Management Studio 访问，以下是使用图形用户界面创建作业的步骤。这些步骤展示了如何创建一个 SQL 作业以使用 SQL 代理服务帐户运行 SSIS，以及如何创建一个代理以使用不同的凭据在不同的环境下运行。

1.  转到 SQL Server 管理工作室。展开`SQL Server Agent`并右键单击 Jobs，然后如屏幕截图 # **1**`New Job...`所示选择。

***   提供名称，默认情况下所有者将是创建作业的帐户，但您可以根据您的要求进行更改。如果您愿意，请指定一个类别并提供描述。参考截图# **2**。

    *   在 Steps 部分，单击`New...`如屏幕截图 # **3**所示。

    *   在“新建作业步骤”对话框中，提供步骤名称。`SQL Server Inegration Services Package`从类型中选择。此步骤将`SQL Agent Service Account`默认运行。选择包源作为`File system`并通过单击省略号浏览到包路径。这将填充包路径。参考截图# **4**。如果您不希望在 下执行该步骤**`SQL Agent Service Account`**，请参阅步骤 # **8** - **9**以了解如何使用其他帐户。

    *   如果您有包的 SSIS 配置文件 (.dtsConfig)，请单击“**配置**”选项卡并添加配置文件，如屏幕截图 # **5**所示。

    *   单击“确定”，在步骤 1 中有包，如屏幕截图 # **6**所示。同样，您可以创建不同的步骤。

    *   创建作业后，您可以右键单击作业并选择`Script Job as --> CREATE To --> New Query Editor Window`生成脚本，如屏幕截图 # **7**所示。

    *   要在不同帐户下运行 SSIS 步骤，请在 Management Studio 上导航到`Security --> right-click on Cedentials --> select New Credential...`如屏幕截图 # **8**所示。

    *   在`New Credential`对话框中，提供您希望在 SQL 作业中执行 SSIS 步骤的凭据名称、Windows 帐户和密码。参考截图# **9**。将创建凭证，如屏幕截图 # **10**所示。

    *   接下来，我们需要创建一个代理。在 Management Studio 上，导航到`SQL Server Agent --> Proxies --> right-click on SSIS Package Execution --> select New Proxy...`如屏幕截图 # **11**所示。

    *   在 New Proxy Account 窗口中，提供代理名称，选择新创建的凭据，提供描述并选择 SQL Server Integration Services Package，如屏幕截图 # **12**所示。应该创建代理帐户，如屏幕截图 # **13**所示。

    *   现在，如果您返回 SQL 作业中的步骤，您应该会在**Run as**下拉菜单中看到新创建的代理帐户。参考截图# **14**。** 

 **希望有帮助。

**截图#1：**

![1](https://i.stack.imgur.com/XYVET.png)

**截图#2：**

![2](https://i.stack.imgur.com/UqeAZ.png)

**截图#3：**

![3](https://i.stack.imgur.com/6BjQL.png)

**截图#4：**

![4](https://i.stack.imgur.com/6TP6t.png)

**截图#5：**

![5](https://i.stack.imgur.com/jMjNQ.png)

**截图#6：**

![6](https://i.stack.imgur.com/jg6Fd.png)

**截图#7：**

![7](https://i.stack.imgur.com/3lpPY.png)

**截图#8：**

![8](https://i.stack.imgur.com/hgpaR.png)

**截图#9：**

![9](https://i.stack.imgur.com/rZ6z4.png)

**截图#10：**

![10](https://i.stack.imgur.com/8Z0mM.png)

**截图 #11：**

![11](https://i.stack.imgur.com/hWwds.png)

**截图#12：**

![12](https://i.stack.imgur.com/iQYyA.png)

**截图#13：**

![13](https://i.stack.imgur.com/pdK4j.png)

**截图#14：**

![14](https://i.stack.imgur.com/LrPs6.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T18:02:52.957

如果要从 SQL 代理作业执行 SSIS 包，则可以创建代理。[在这里](http://msdn.microsoft.com/en-us/library/ms190698.aspx "SQL Server 代理")查看更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-18T20:04:53.830

使用 SQL 2012 我收到一个错误，即不允许选择的用户帐户成为代理。使用以下查询解决了这个问题：

```
use msdb
GO
exec sp_grant_login_to_proxy @login_name = 'MyLoginName', @proxy_name= 'proxy_SSIS' 
```

# c# - 如何停止我的 while 循环？

> ID：812430
> 
> 赞同：3
> 
> 时间：2009-05-01T17:46:23.903
> 
> 标签：c#

我想在 C# 中使用以下代码，但我似乎无法摆脱它。如果用户按下键或移动啮齿动物（又名鼠标），我想终止应用程序。这是我的代码（不笑！）。

```
private void frmDots_KeyDown(object sender, KeyEventArgs e)
{
  bgNotClicked = false;
  Close();
}   

private void frmDots_Click(object sender, EventArgs e)
{
  bgNotClicked = false;
  Close();
}   

  while (bgNotClicked)
  {

    // Clear the first element in our XY position. This is the reverse of the way I   normally create the dots application
    System.Drawing.Rectangle clearDots = new System.Drawing.Rectangle(Dots.PositionX[iCounter], Dots.PositionY[iCounter], 8, 8);

    // Create the black color and brush to clear dots
    Color clearDotsColor = Color.Black;
    SolidBrush clearDotsBrush = new SolidBrush(clearDotsColor);

    // Finally clear the dot
    e.Graphics.FillEllipse(clearDotsBrush, clearDots);

    GetRandomPosition(iCounter);

    // Fill the elements to display colors on the displays canvas
    System.Drawing.Rectangle colorDots = new System.Drawing.Rectangle(Dots.PositionX[iCounter], Dots.PositionY[iCounter], 8, 8);

    // Create the color and brush to show dots
    Color colorRandom = GetRandomColor();
    SolidBrush colorBrush = new SolidBrush(colorRandom);

    // Finally show the dot
    e.Graphics.FillEllipse(colorBrush, colorDots);

    Thread.Sleep(5);

    iCounter++;
    if (iCounter == 399)
    {
      iCounter = 0;
    }

  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T17:49:36.937

您的“忙于等待”策略设计不佳。相反，您应该使用触发的事件处理程序：

*   按键时。
*   当鼠标移动时。

在任何一种情况下，您都可以通过终止应用程序来做出响应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T17:57:31.130

编辑：

看到您的编辑后，这绝对是您的问题。问题是您的 while 循环阻塞了主 UI 线程，因此它永远不会处理触发您的按键/鼠标/等处理程序的 Windows 消息。

您有几个选择 - 您可以将其中的一些移到单独的线程上，执行我在下面建议的操作，或者在您的 while 循环中添加对[Application.DoEvents的调用。](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents.aspx)这将允许您的事件处理程序运行，进而设置`bgNotClicked = false;`. 现在，这永远不会发生，因为您的 UI 完全被阻止了。

* * *

原帖：

如果您在 UI 线程中执行此循环，您将需要重新考虑设计。

在事件处理程序中设置`bgNotClicked = false;`某处将起作用，但前提是您的事件处理程序能够运行。如果您在 UI 线程中执行上述代码，它将无限期地阻塞您的 UI 线程，从而阻止事件处理程序触发。

我建议将其重新设计为基于计时器（因此它会定期重复运行），而不是锁定在 while 循环中。这将允许您的其他 UI 事件在运行之间触发，而不是设置`bgNotClicked = false;`，您的事件处理程序可以将计时器设置为不启用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T17:50:59.553

您的事件处理程序需要将您的**bgNotClicked变量设置为****false**以进行按键操作。

如果啮齿动物被您的鼠标移动，您将需要一个类似的鼠标事件处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T17:50:21.943

该[`break`](http://msdn.microsoft.com/en-us/library/adbctzc4(VS.80).aspx)关键字将终止一个循环。在这种情况下，当您遇到要停止循环的情况时，您只需使用`break;`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T18:16:58.667

如果您像这样循环，您需要给应用程序一点时间来处理您希望会导致中断的事件。这是 DoEvents 方法的工作。

```
private bool WeAreDone = false;

private void DoingIt()
{
    while (true)
    {
        Application.DoEvents();
        if (WeAreDone)
        {
            break;
        }
    }
}

private void InterruptButton_Click(object sender, EventArgs e)
{
    WeAreDone = true;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T18:33:04.243

我认为使用 Timer 比繁忙的等待循环更适合 Windows 事件驱动模型。你可以尝试这样的事情：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private int iCounter = 0;

    private void Draw()
    {
        // ....
    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        Draw();

        iCounter++;
        if(iCounter == 399)
        {
            iCounter = 0;
        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        timer1.Interval = 5;
        timer1.Enabled = true;
    }

    private void Form1_Click(object sender, EventArgs e)
    {
        timer1.Enabled = false;
        Close();
    }

    private void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        timer1.Enabled = false;
        Close();
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:48:39.263

**您可以使用break**语句退出循环。

编辑：好的，我收回旗帜！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T17:56:43.830

这似乎不是正确的方法。.Net Framework 为您提供了处理 KeyPress 和 MouseMove/Click 操作的事件。你为什么不使用它们？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T18:13:36.880

尝试将循环移动到 BackgroundWorker 的 DoWork 事件处理程序中。然后你的 GUI 仍然会响应，而不是那个讨厌的变量，你可以调用 CancelAsync 方法来停止循环。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-14T21:09:11.917

使用`Environment.Exit(2);`（或者`Environment.Exit(1)`它真的没有什么区别）退出应用程序。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-05-01T17:54:31.590

```
Exit While 
```

.....................

# php - MySQL - 忽略插入错误：重复条目

> ID：812437
> 
> 赞同：80
> 
> 时间：2009-05-01T17:48:05.973
> 
> 标签：php, mysql, insert

我在 PHP 中工作。

请向具有唯一字段的数据库中插入新记录的正确方法是什么。我正在批量插入大量记录，我只想插入新记录，并且我不希望重复条目出现任何错误。

是否有唯一的方法首先进行 SELECT 并查看该条目是否在 INSERT 之前已经存在 - 并且仅在 SELECT 没有返回记录时才插入？我希望不是。

我想以某种方式告诉 MySQL 忽略这些插入而不会出现任何错误。

谢谢

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-05-01T17:54:44.257

如果您不想在有重复记录时采取任何操作，您可以使用[INSERT... IGNORE语法。](http://dev.mysql.com/doc/refman/5.1/en/insert.html)

如果您想用具有相同键的新记录覆盖旧记录，可以使用[REPLACE INTO语法。](http://dev.mysql.com/doc/refman/5.0/en/replace.html)

或者，如果您想在遇到重复记录时对记录执行更新，则可以使用[INSERT... ON DUPLICATE KEY UPDATE语法。](http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html)

编辑：我想我会添加一些例子。

## 例子

假设您有一个以`tbl`两列命名的表，`id`并且`value`. 有一个条目，id=1 和 value=1。如果您运行以下语句：

```
REPLACE INTO tbl VALUES(1,50); 
```

你还有一条记录，id=1 value=50。请注意，整个记录首先被删除，然后重新插入。然后：

```
INSERT IGNORE INTO tbl VALUES (1,10); 
```

操作成功执行，但没有插入任何内容。你仍然有 id=1 和 value=50。最后：

```
INSERT INTO tbl VALUES (1,200) ON DUPLICATE KEY UPDATE value=200; 
```

您现在有一条 id=1 和 value=200 的记录。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-01T17:52:10.753

您可以使用 EXISTS 条件确保不插入重复信息。

例如，如果您有一个名为 clients 的表，其主键为 client_id，则可以使用以下语句：

```
INSERT INTO clients
(client_id, client_name, client_type)
SELECT supplier_id, supplier_name, 'advertising'
FROM suppliers
WHERE not exists (select * from clients
where clients.client_id = suppliers.supplier_id); 
```

此语句使用子选择插入多条记录。

如果要插入单个记录，可以使用以下语句：

```
INSERT INTO clients
(client_id, client_name, client_type)
SELECT 10345, 'IBM', 'advertising'
FROM dual
WHERE not exists (select * from clients
where clients.client_id = 10345); 
```

使用双表允许您在选择语句中输入值，即使这些值当前未存储在表中。

来自[http://www.techonthenet.com/sql/insert.php](http://www.techonthenet.com/sql/insert.php)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-01T17:50:18.603

您可以使用[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html "触发器")。

另请查看[触发器介绍指南](http://www.databasedesign-resource.com/mysql-triggers.html)。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-05-01T17:51:01.910

尝试创建一个没有唯一约束的重复表，最好是一个临时表，然后将批量加载到该表中。然后从临时表中只选择唯一的（DISTINCT）项并插入到目标表中。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-11-25T06:37:27.893

```
$duplicate_query=mysql_query("SELECT * FROM student") or die(mysql_error());
$duplicate=mysql_num_rows($duplicate_query);
if($duplicate==0)
{
    while($value=mysql_fetch_array($duplicate_query)
    {
        if(($value['name']==$name)&& ($value['email']==$email)&& ($value['mobile']==$mobile)&& ($value['resume']==$resume))
        {
            echo $query="INSERT INTO student(name,email,mobile,resume)VALUES('$name','$email','$mobile','$resume')";
            $res=mysql_query($query);
            if($query)
            {
                echo "Success";
            }
            else
            {
                echo "Error";
            }
            else
            {
                echo "Duplicate Entry";
            }
        }
    }
}
else
{
    echo "Records Already Exixts";
} 
```

# iphone - 为什么我的 UIToolBar 会随着我的 UITableView 滚动？

> ID：812445
> 
> 赞同：2
> 
> 时间：2009-05-01T17:50:01.787
> 
> 标签：iphone, cocoa-touch, objective-c

我在尝试建立自己的观点时遇到了一些困难。一切都很好，直到我需要将 UIToolBar 插入到我的视图中。tableView 放置在我希望放置的位置。另一方面， UIToolBar 会随着表格上下滚动，它不会保持应有的固定状态。放在屏幕上时看起来也很奇怪——我猜是因为放置它的计算不正确？附加到这个问题的是一个屏幕截图以及我用来构建它的代码。感谢您帮助发现我做错了什么。截图：[http ://dl-web.dropbox.com/u/57676/screenshots/broketoolbar.png](http://dl-web.dropbox.com/u/57676/screenshots/broketoolbar.png)

编码：

```
- (void)loadView
{
    [super loadView];
    // TableViews that wish to utilize tableView footers/headers should override this method.

    UITableView *aTableView = [[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame] style:UITableViewStylePlain];
    aTableView.autoresizingMask = (UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight);
    aTableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;

    aTableView.delegate = self;
    aTableView.dataSource = dataSource;

    self.tableView = aTableView;
    self.view = tableView;
    [aTableView release];

    UIToolbar *toolbar = [UIToolbar new];
    [toolbar setBarStyle:UIBarStyleBlackOpaque];
    [toolbar sizeToFit];
    CGFloat toolbarHeight = [toolbar frame].size.height;
    CGRect mainViewBounds = self.view.bounds;
    [toolbar setFrame:CGRectMake(CGRectGetMinX(mainViewBounds),
                                 CGRectGetMinY(mainViewBounds) + CGRectGetHeight(mainViewBounds) - (toolbarHeight * 2.0),
                                 CGRectGetWidth(mainViewBounds),
                                 toolbarHeight)];
    [self.view insertSubview:toolbar aboveSubview:self.tableView];
    [toolbar release];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T18:02:05.393

因为 self.view 是您在其上添加工具栏的 tableView。

# java - 在 MyEclipse 中开发 Maven 战争应用值得吗？

> ID：812448
> 
> 赞同：2
> 
> 时间：2009-05-01T17:50:37.480
> 
> 标签：java, maven-2, war, myeclipse

我的组织做出了上层决定，将 maven 作为 Java 项目的标准构建工具。我的任务是帮助我们的本地团队将项目迁移到 maven。

正在发挥作用的核心工具之一是 MyEclipse IDE。MyEclipse 似乎与 maven 团队有一段“有趣”的历史，这在[各个地方都得到了](http://www.myeclipseide.com/PNphpBB2-viewtopic-t-23178.html)[证明](http://www.sonatype.com/people/2008/09/how-did-myeclipse-get-their-maven-integration-so-wrong/)，尤其是在处理战争项目时。我还没有遇到简单的 jar 项目的问题……还没有。

在与 MyEclipse 斗争并且未能使其轻松识别战争项目之后，问题就变成了，MyEclipse 是否值得开发 maven 战争应用程序？

如果是这样，有没有办法让 MyEclipse 与我没有找到的战争项目很好地配合？或者，我是否只是建议将 Eclipse Java EE 版本与 m2eclipse 一起使用更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:16:07.090

不。MyEclipse 不支持在它之外创建的项目。它的设计仅适用于使用其向导创建的项目。

来自[在 MyEclipse 中使用 Maven 概述](http://www.myeclipseide.com/documentation/quickstarts/maven_overview/)

> 注意：Maven 仅支持新项目。目前不支持将现有项目迁移到支持 Maven 的项目，但可能会考虑在以后的版本中使用。目前，MyEclipse 团队专注于提供尽可能流畅的新 Maven 项目体验

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:52:42.483

麦克风，

很遗憾听到您在与 MyEclipse 和 Maven 作斗争，过去我见过的最常见的导致人们在这方面痛苦的问题是当他们没有正确设置 Web 根、Java 源目录或资源目录时。

使用[此网页](http://cvs.peopleware.be/training/maven/maven2/standardDirLayout.html)作为标准 Maven2 Web 项目布局的参考，您可以轻松创建启用 Maven 的 MyEclipse Web 项目。您要采取的步骤如下：

1.  文件 > 新建 > Web 项目
2.  为您的项目命名，使用“src/main/java”的 Java 源目录和“src/main/webapp”的 Web Root，检查所需的 Java EE 规范级别，选中“添加 Maven 支持”复选框并点击完成（除非您想设置工件/组 ID）。
3.  现在，如果这是第一次使用 Maven4MyEclipse，将进行大量初始化，准备本地存储库并获取所有 Java EE 资源来构建项目，但完成后，您应该已准备就绪。
4.  您可以从右键单击 Run As 或 Debug As 菜单执行 Maven 目标，甚至可以使用“Maven build...”快捷方式管理自定义目标执行——这都类似于 m2eclipse。
5.  如果您决定要完全使用 m2eclipse，您可以导航到 Window > Preferences > MyEclipse > Maven4MyEclipse 并选中“Enable all m2eclipse features”复选框。

开箱即用，我们只隐藏了可能使 Maven 对初学者感到困惑的位，如果您启用所有 m2 位，您可以使用 Maven 和 MyEclipse 做任何您想做的事情。如果您仍然遇到问题，请访问我们的论坛并告诉我们，我们将尽我们所能提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T02:30:09.873

我是一名技术主管，我们最近开始转向 Maven。我在让 maven 与 myeclipse 一起工作时遇到了一些问题。首先，即使我“启用所有 m2eclipse 功能”复选框，我仍然无法从 subversion 中将项目签出为 maven 项目。该选项（您从 m2eclipse 获得）只是不可用。

此外，您使用 m2eclipse 获得的某些首选项不适用于 maven4myeclipse。

最后，我不能只卸载 maven4eclipse 插件并安装 m2eclipse。那将是一个可以接受的解决方法。

我认为 Genutec 试图让 Maven 更容易被新手使用，但在实施中存在一些问题，我认为它们不会很快得到解决。对我们来说，这可能会让 MyEclipse 成为一个花哨的 jsp 编辑器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T13:20:55.317

麦克风，

> 认为问题在于该项目已经在 MyEclipse 之外创建并且 > 使用命令行通过 maven 工作。导入不成功。

我在寻找其他 Maven 资源时看到了这篇文章，所以我会插话。

为什么不使用 File > Import 导入现有项目并打开所有 m2eclipse 功能并像使用 maven 命令行工具之前一样继续开发它？我已经这样做了，它适用于遗留项目，一旦启用 m2eclipse 功能，如 Riyad 的 #5 中所述。

就个人而言，我一直认为 maven 战争格式已经失败，但我们仍然有一些旧项目在使用它。Maven 的格式只是一种默认（而且很差），而不是某种标准。然而，我们目前将这些旧项目“保持原样”（使用上述技术）只是因为它很容易。但是对于新工作，我们使用 MyEclipse Web 项目，然后在它们上启用 Maven 支持。好处是您获得了所有 Maven 支持，而且它非常易于使用和管理，但不再需要命令行（尽管它仍然有效），并且所有 MyEclipse 工具也可以在它们上完美运行。这是一种“两全其美”的方法，至少对我们来说是这样。YMMV。

希望有帮助，戴夫

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-08T15:43:51.650

麦克风，

> 有趣的是，当您的开发人员不使用 MyEclipse 时会发生什么？

这里不是问题；我为一家非常大的公司工作，该公司已经标准化了很长一段时间（幸运的是，我可能会补充一点，因为我们曾经是一家 WSAD 商店——不寒而栗。）

无论如何，如果您有一些使用 MyEclipse 和一些不使用，我会看到两个选项。首先，如果您创建 MyEclipse Web 项目，然后向它们“添加 Maven 功能”（或任何名称），它们将在 MyEclipse 和 Maven 命令行中工作。因此，即使您不使用 MyEclipse，您仍然可以使用命令行 Maven 工具。此外，由于 MyEclipse 结构是更标准的“爆炸式战争”布局，因此它也应该适用于您使用的其他任何东西。

要考虑的另一件事是 Maven 的 Web 布局只是一个默认设置，Maven 可以轻松支持任何项目结构，包括 MyEclipse 使用的那个，因此您应该能够在任何工具中使用带有 Maven 的 MyEclipse 项目，只需一点额外的配置。这很可能是 Maven 命令行工具仍然可以在 MyEclipse Web 项目上工作的原因——MyEclipse 人员只是自动配置 Maven 以识别格式。

正如我在上一篇文章中所说，您也可以只导入外部创建的 Maven Web 项目。我们不喜欢这样做，因为这种结构是 Maven 独有的，并且不能与除 Maven 之外的任何工具一起使用。结果，它基本上破坏了您在 MyEclipse、Eclipse Java EE 或几乎任何其他工具中自动获得的工具支持。这只是一个糟糕的默认值。MyEclipse、Eclipse Java EE、WSAD、RAD 和其他所有人使用的 Exploded WAR 格式只是一个更好的解决方案。尤其是当它仍然可以与 Maven 一起工作时。

Maven 可以灵活地适应项目结构。我们刚刚发现，通过使用这种灵活性，您可以获得 Maven 支持和强大的工具支持。

戴夫

# flowchart - 有没有办法自动生成数据流程图和流程图？

> ID：812458
> 
> 赞同：12
> 
> 时间：2009-05-01T17:51:47.523
> 
> 标签：flowchart, diagrams, dataflow-diagram

我最近正在研究由其他一些聪明人编写的一些冗长而晦涩的代码。我正在考虑生成数据流程图和流程图以方便我的工作。有没有什么软件可以自动完成这项工作？PS 大部分代码都是用 C 和 Fortran 编写的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T18:06:07.553

数据流图更难，因为它们需要大部分编译器前端来获取绘制它们所需的基本信息。但是您可以使用[Graphviz从](http://www.graphviz.org/)[Doxygen](http://www.doxygen.org/)中获取调用和调用者图以及某些类型的实体关系图。

此外，Graphviz 通常可用于从原始数据中绘制具有可读布局的各种图形。例如，很容易遍历树结构并以 DOT 语言输出描述以供 Graphviz 绘制。

使用正确的选项设置 Doxygen，并在遗留代码上放松它，您将获得内部文档的开头，以帮助您找到解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T16:06:08.283

FateSoftware 的“Code Visual to Flowchart”也可能需要帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-11T15:54:07.470

[Dia](http://dia-installer.de/)是一个类似于 Microsoft Visio 的程序。它不是那么顺利，但它完成了工作。当 Visio 不可用时，我总是专业地使用它。这主要用于 UML 和流程图，导出到 png 和矢量，我认为 PDF 也是如此。

# asp.net-mvc - 在双引号之间嵌入 ContentPlaceHolder

> ID：812470
> 
> 赞同：0
> 
> 时间：2009-05-01T17:58:26.290
> 
> 标签：asp.net-mvc, contentplaceholder

我正在使用 .NET MVC，并在视图页面中设置了一个 contentplaceholder，其中包含要在母版页上使用的 ID，如下所示：

查看页面：

```
<asp:Content ID="CDomBodyId" ContentPlaceHolderID="DomBodyId" runat="server">LmpDemoRequests</asp:Content> 
```

母版页：

```
<body id='<asp:ContentPlaceHolder ID="DomBodyId" runat="server"></asp:ContentPlaceHolder>'> 
```

所以在这种特殊情况下，body 标签会在最终的 HTML 页面上呈现如下：

```
<body id='LmpDemoRequests'> 
```

我想在body id标签周围加上双引号，但是像下面这样反转引号会使intellisense无法找到contentplaceholder，在编译时给我很多警告。

```
<body id="<asp:ContentPlaceHolder ID='DomBodyId' runat='server'></asp:ContentPlaceHolder>"> 
```

有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:06:24.493

这是 ASP.NET 编辑器的问题。它不是特定于 MVC 的。我认为解决方法非常好，我没有看到具体的缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T18:17:06.230

不确定我是否误解了您的问题，但您也可以添加：

```
<body id="site" runat="server"></body> 
```

然后在您的页面上访问它

```
HtmlControl body = (HtmlControl)Master.FindControl("site");
body.Attributes.Add("class", "LmpDemoRequests"); 
```

我希望我理解你的正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T18:22:03.490

尝试将 BodyID 声明为 MasterPage 的属性。在查看页面中设置其值。然后你可以做类似的事情 `<html> <body='<%= BodyID %>'> </body </html>`

# java - JVM/CLR 源兼容语言选项

> ID：812474
> 
> 赞同：8
> 
> 时间：2009-05-01T17:59:52.933
> 
> 标签：java, .net, programming-languages

我有一个开源 Java 数据库迁移工具 ( [http://www.liquibase.org](http://www.liquibase.org) )，我正在考虑将其移植到 .Net。

该工具的大部分（至少从复杂性方面）是围绕这样的逻辑“如果你要添加一个主键并且数据库是 Oracle 使用这个 SQL。如果数据库是 MySQL 使用这个 SQL。如果主键被命名并且数据库是 Postgres 使用这个 SQL”。

我可以分叉 Java 代码库并隐藏它（手动和/或自动），但是随着对上述逻辑的更新和错误修复的出现，我不想将它应用于两个版本。我想做的是将所有这些逻辑转移到一个可以被 Java 和 .Net 版本天真地编译和使用的形式中。

我要转换的代码不包含任何高级库使用（JDBC、System.out 等），这些使用从 Java 到 .Net 会有很大差异，所以我认为这不是问题（最坏的情况可能是周围设计）。

所以我要找的是：

*   一种语言，我可以在其中编写应用程序的公共部分并将其编译成目标平台上的“标准”语言可用的类
*   不向系统添加任何运行时要求
*   没有什么比它吓跑潜在贡献者更奇怪的*了*

我知道 Python 和 Ruby 都有针对 JVM 和 CLR 的实现。它们在多大程度上符合我的要求？是否有人成功（或不成功）将此技术用于跨平台应用程序？有什么我需要担心的问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T18:04:22.940

查看[Fantom 编程语言](http://fantom.org/)。它有自己的类似 Java/C# 的语法，但可以针对 Java VM 或 .NET CLR。

他们的[“Why Fantom”](http://fantom.org/doc/docIntro/WhyFantom.html)页面对他们的可移植性方法与在 VM 上运行的动态语言进行了高级概述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:07:25.770

[使用IKVM.NET](http://en.wikipedia.org/wiki/IKVM)可能会有一些运气。我不确定它的确切状态，但如果您坚持在 .NET Framework 上运行 Java 代码，那么值得一试。它包括 Java 基类库的 .NET 实现，因此看起来相当完整。

我可能建议的唯一其他选择是将代码移植到[J#](http://en.wikipedia.org/wiki/J_Sharp)语言，一种完整的 .NET 语言（尽管在 C# 或 VB.NET 的意义上不是一流的）。该语言的设计使与 Java 的差异最小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T15:44:38.390

如果你正在考虑一种嵌入式方法，你可以看看 Lua。

# input - 轻量级的跨平台输入库

> ID：812475
> 
> 赞同：16
> 
> 时间：2009-05-01T17:59:53.823
> 
> 标签：input

我正在尝试编写一个支持手柄和鼠标/键盘的游戏。我已经尝试查找有关该信息的信息，但它要么已过时，要么不够便携。

有没有人知道任何可以抽象手柄阅读的轻量级库？我想使用 360 控制器，但我想要的支持不止这些。

我主要是在 Windows 上编写，但我真的不想使用 DirectInput/XInput，以防我想移植我的代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T23:10:53.643

你试过[OIS](http://sourceforge.net/projects/wgois/)（[面向对象的输入系统](http://sourceforge.net/projects/wgois/)）吗？一个高效且轻量级的库。我对此非常满意。

我从未尝试过使用 360 控制器，但它应该可以正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-22T13:47:43.573

这可能是一个较老的问题，并且已经得到解答，但是..

tigsource 上的某个人制作了一个轻量级的跨平台游戏手柄库，您可能会发现它很有用。

你可以在[这里](http://forums.tigsource.com/index.php?topic=10675.0)查看关于它的帖子。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-22T14:14:17.087

[SDL](http://www.libsdl.org/cgi/docwiki.cgi/SDL_API)呢？

也许这不是你所说的轻量级（它也有图形和音频子系统），但它非常便携。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-13T11:15:55.783

我知道这个帖子很老了，现在你可能已经得到了你需要的东西，但我回答这个问题以防万一有人偶然发现它并需要帮助。

我偶然发现了这个库增益，它似乎很有意义。你可以试试看，如果有帮助的话。

Gainput 是一个轻量级的 c++ 库，让您可以在 Joypads、macs、pc、linux 以及手机上使用相同的界面，并且非常容易集成到您的项目中。

可以在此处找到增益输入的链接 ( [http://gainput.johanneskuhlmann.de/](http://gainput.johanneskuhlmann.de/) )

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-05-01T18:10:47.823

你看过 XNA 游戏框架吗？还有

Allero [http://www.talula.demon.co.uk/allegro/](http://www.talula.demon.co.uk/allegro/)

车库游戏 [http://www.garagegames.com/](http://www.garagegames.com/)

试试看

# python - logging.error() 调用了多少次？

> ID：812477
> 
> 赞同：14
> 
> 时间：2009-05-01T18:00:09.063
> 
> 标签：python, logging

也许它只是不存在，因为我找不到它。但是使用python的日志包，有没有办法查询一个记录器来找出一个特定函数被调用了多少次？例如，报告了多少错误/警告？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T18:51:37.723

日志记录模块似乎不支持这一点。从长远来看，您最好创建一个新模块，并通过对现有日志记录模块中的项目进行子类化来添加此功能以添加您需要的功能，但您也可以使用装饰器轻松实现此行为：

```
class CallCounted:
    """Decorator to determine number of calls for a method"""

    def __init__(self,method):
        self.method=method
        self.counter=0

    def __call__(self,*args,**kwargs):
        self.counter+=1
        return self.method(*args,**kwargs)

import logging
logging.error = CallCounted(logging.error)
logging.error('one')
logging.error('two')
print(logging.error.counter) 
```

输出：

```
ERROR:root:one
ERROR:root:two
2 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-06-30T15:11:41.907

您还可以向记录所有调用的记录器添加一个新的处理程序：

```
class MsgCounterHandler(logging.Handler):
    level2count = None

    def __init__(self, *args, **kwargs):
        super(MsgCounterHandler, self).__init__(*args, **kwargs)
        self.level2count = {}

    def emit(self, record):
        l = record.levelname
        if (l not in self.level2count):
            self.level2count[l] = 0
        self.level2count[l] += 1 
```

然后，您可以在之后使用 dict 输出调用次数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:50:01.317

有一个[`warnings`](https://docs.python.org/3/library/warnings.html)模块 - 在一定程度上 - 做了一些。

您可能希望将此计数功能添加到自定义的[Handler](http://www.python.org/doc/2.5.2/lib/node409.html)中。问题是有一百万个处理程序，您可能希望将其添加到多个类型中。

您可能希望将其添加到[Filter](http://www.python.org/doc/2.5.2/lib/node422.html)，因为它独立于正在使用的处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-19T16:28:54.267

基于[Rolf 的回答](https://stackoverflow.com/users/2923406/rolf)以及[如何将字典写入文件](https://stackoverflow.com/questions/19201290/how-to-save-a-dictionary-to-a-file/32216025)，这里是另一种将计数存储在 json 文件中的解决方案。如果 json 文件存在并且`continue_counts=True`，它会恢复初始化计数。

```
import json
import logging
import logging.handlers
import os

class MsgCounterHandler(logging.Handler):
    """
    A handler class which counts the logging records by level and periodically writes the counts to a json file.
    """

    level2count_dict = None

    def __init__(self, filename, continue_counts=True, *args, **kwargs):
        """
        Initialize the handler.

        PARAMETER
        ---------
        continue_counts: bool, optional
            defines if the counts should be loaded and restored if the json file exists already.
        """
        super(MsgCounterHandler, self).__init__(*args, **kwargs)

        filename = os.fspath(filename)
        self.baseFilename = os.path.abspath(filename)

        self.continue_counts = continue_counts

        # if another instance of this class is created, get the actual counts
        if self.level2count_dict is None:
            self.level2count_dict = self.load_counts_from_file()

    def emit(self, record):
        """
        Counts a record.
        In case, create add the level to the dict.
        If the time has come, update the json file.
        """
        level = record.levelname
        if level not in self.level2count_dict:
            self.level2count_dict[level] = 0
        self.level2count_dict[level] += 1

        self.flush()

    def flush(self):
        """
        Flushes the dictionary.
        """
        self.acquire()
        try:
            json.dump(self.level2count_dict, open(self.baseFilename, 'w'))
        finally:
            self.release()

    def load_counts_from_file(self):
        """
        Load the dictionary from a json file or create an empty dictionary
        """
        if os.path.exists(self.baseFilename) and self.continue_counts:
            try:
                level2count_dict = json.load(open(self.baseFilename))
            except Exception as a:
                logging.warning(f'Failed to load counts with: {a}')
                level2count_dict = {}
        else:
            level2count_dict = {}
        return level2count_dict 
```

# mysql - 优化 MySQL 聚合查询

> ID：812478
> 
> 赞同：4
> 
> 时间：2009-05-01T18:00:36.020
> 
> 标签：mysql, aggregate, large-data-volumes

我在 MySQL 中有一个非常大的表（约 1 亿条记录），其中包含有关文件的信息。其中一条信息是每个文件的修改日期。

我需要编写一个查询来计算适合指定日期范围的文件数。为此，我制作了一个小表，指定了这些范围（均以天为单位），如下所示：

```
DateRanges
range_id   range_name   range_start   range_end
1          0-90         0             90
2          91-180       91            180
3          181-365      181           365
4          366-1095     366           1095
5          1096+        1096          999999999 
```

并编写了一个如下所示的查询：

```
SELECT r.range_name, sum(IF((DATEDIFF(CURDATE(),t.file_last_access) > r.range_start and DATEDIFF(CURDATE(),t.file_last_access) < r.range_end),1,0)) as FileCount
FROM `DateRanges` r, `HugeFileTable` t
GROUP BY r.range_name 
```

然而，可以预见的是，这个查询需要永远运行。我认为这是因为我要求 MySQL 遍历 HugeFileTable 5 次，每次对每个文件执行 DATEDIFF() 计算。

相反，我想做的是只逐条记录一次 HugeFileTable 记录，并为每个文件增加相应 range_name 运行总数中的计数。我不知道该怎么做......

有人可以帮忙吗？

谢谢。

**编辑**：MySQL 版本：5.0.45，表是 MyISAM

**EDIT2**：这是评论中要求的描述

```
id  select_type  table  type  possible_keys  key  key_len  ref  rows      Extra  
1   SIMPLE       r      ALL   NULL           NULL NULL     NULL 5         Using temporary; Using filesort 
1   SIMPLE       t      ALL   NULL           NULL NULL     NULL 96506321 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T01:56:40.620

首先，在`HugeFileTable.file_last_access`.

然后尝试以下查询：

```
SELECT r.range_name, COUNT(t.file_last_access) as FileCount
FROM `DateRanges` r
 JOIN `HugeFileTable` t 
 ON (t.file_last_access BETWEEN 
   CURDATE() + INTERVAL r.range_start DAY AND 
   CURDATE() + INTERVAL r.range_end DAY)
GROUP BY r.range_name; 
```

这是`EXPLAIN`我在 MySQL 5.0.75 上尝试此查询时得到的计划（为简洁起见，已编辑）：

```
+-------+-------+------------------+----------------------------------------------+
| table | type  | key              | Extra                                        |
+-------+-------+------------------+----------------------------------------------+
| t     | index | file_last_access | Using index; Using temporary; Using filesort | 
| r     | ALL   | NULL             | Using where                                  | 
+-------+-------+------------------+----------------------------------------------+ 
```

它仍然不会表现得很好。通过使用`GROUP BY`，查询会产生一个临时表，这可能很昂贵。你对此无能为力。

但至少这个查询消除了您在原始查询中的笛卡尔积。

* * *

**更新：** 这是另一个使用相关子查询的查询，但我已经消除了`GROUP BY`.

```
SELECT r.range_name,
  (SELECT COUNT(*) 
   FROM `HugeFileTable` t 
   WHERE t.file_last_access BETWEEN 
     CURDATE() - INTERVAL r.range_end DAY AND 
     CURDATE() - INTERVAL r.range_start DAY
  ) as FileCount
FROM `DateRanges` r; 
```

该`EXPLAIN`计划没有显示临时表或文件排序（至少我的测试表中的行数很少）：

```
+----+--------------------+-------+-------+------------------+--------------------------+
| id | select_type        | table | type  | key              | Extra                    |
+----+--------------------+-------+-------+------------------+--------------------------+
|  1 | PRIMARY            | r     | ALL   | NULL             |                          | 
|  2 | DEPENDENT SUBQUERY | t     | index | file_last_access | Using where; Using index | 
+----+--------------------+-------+-------+------------------+--------------------------+ 
```

在您的数据集上尝试此查询，看看它是否表现更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:17:12.830

好吧，首先确保它`file_last_access`是table的**索引**`HugeFileTable`。

我不确定这是否可能\更好，但首先尝试计算日期限制（从日期**A**到日期**B**的文件），然后使用带有 >= 和 <= 的查询。至少从理论上讲，它会提高性能。

比较将类似于：

```
 t.file_last_access >= StartDate AND t.file_last_access <= EndDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:43:44.327

您可以通过删除 CURDATE() 并在查询中放置一个日期来获得一个小的改进，因为它将在您的 SQL 中为每一行运行此函数两​​次。

# jquery - jQuery中的通用json序列化器/反序列化器？

> ID：812479
> 
> 赞同：1
> 
> 时间：2009-05-01T18:01:03.993
> 
> 标签：jquery, json

**重复：** [在 jQuery 中序列化为 JSON](https://stackoverflow.com/questions/191881/serializing-to-json-in-jquery)

似乎 jQuery 内置了一个 JSON 序列化器/反序列化器，因为它能够实现 .getJSON 之类的东西。是否可以使用内置的 jQuery JSON 处理器本身作为通用 JSON 处理器（即调用 jQuery.something() 来序列化/反序列化我自己的数据），从而无需单独的 JSON 库？

更新：上面引用的问题中的回复说 jQuery 中没有 JSON 序列化代码。JSON反序列化怎么样？.getJSON 是如何实现的，为什么不公开反序列化功能以供一般使用？

Update2：我已经在使用来自 json.org 的 json2，我正在尝试摆脱它，因为我所做的只是简单的反序列化。听起来 jquery 真的只是在做 eval 吗？我的印象[对安全性不太好](http://www.json.org/js.html)：

> eval 函数非常快。但是，它可以编译和执行任何 JavaScript 程序，因此可能存在安全问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:17:37.930

听起来您需要的是[http://www.json.org/js.html](http://www.json.org/js.html)上提供的序列化/反序列化实现，它提供 JSON.parse() 和 JSON.stringify()，可以轻松（反）序列化和验证数据。

如果您只是想将 JSON 文本转换为对象，请使用 eval() 函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:13:55.413

我刚开始使用 jQuery，我发现从 JSON.org 中删除 JSON2.js 库是最简单的，然后扩展 jQuery 以使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-03T03:50:26.130

jQuery 现在只使用 eval() 。jQuery 1.4 将在支持它的浏览器中支持浏览器原生 JSON 反序列化。如果需要，您现在可以利用它，通过[使用 jQuery 的 dataFilter 回调来尽可能避免 eval()](http://encosia.com/2009/07/07/improving-jquery-json-performance-and-security/)（将其放入 $.ajaxSetup 以影响所有 $.ajax()、$.post()、$.getJSON( ) 自动调用)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:13:13.807

我相信反序列化传入的 json 数据 jQuery 只是 eval() 的它。我不知道任何内置的序列化。

# ruby - 如何生成 DSA 签名？

> ID：812483
> 
> 赞同：3
> 
> 时间：2009-05-01T18:02:18.327
> 
> 标签：ruby, cocoa

我在我的应用程序中使用 Sparkle 进行更新，但在文档中它说生成 DSA 签名并提供了一个工具（该工具是用 ruby​​ 编码的），但我不知道如何使用它。有人可以帮忙吗？

这是文档所在的位置（第 3 步）：[http ://sparkle.andymatuschak.org/documentation/pmwiki.php/Documentation/BasicSetup?from=Main.HomePage](http://sparkle.andymatuschak.org/documentation/pmwiki.php/Documentation/BasicSetup?from=Main.HomePage)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T18:27:53.850

谷歌搜索了命令字符串，并得到了一些点击。

最有用：

[https://answers.launchpad.net/sparkle/+question/50496](https://answers.launchpad.net/sparkle/+question/50496)

引用作者的话：

> 这是一个脚本；您需要从命令行运行它。
> 
> 打开终端。切换到 Sparkle 分发目录。类型：
> 
> 红宝石“附加/签名工具/generate_keys.rb”
> 
> 从那里按照 wiki 上的说明进行操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T00:09:28.083

此外，我强烈建议您查看[Feeder](http://reinventedsoftware.com/feeder/)以构建您的 Sparkle RSS 提要。一旦您将二进制文件拖入更新条目，它就可以自动为您生成 DSA 签名。它还可以为您上传您的二进制文件和提要到您的服务器。总的来说，它为我的 Sparkle 提要节省了大量时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T23:09:00.523

事实上，Sparkle Basic wiki 页面有点误导。对于每个人如何仍然对流程感到困惑，以下是必要的步骤：

1.  转到附加/签名工具子文件夹

2.  生成 dsa 私钥/公钥对：

    ruby generate_keys.rb

    请注意，此脚本在 Sparkle 1.56b 中存在错误，因此最好从此处获取它：[更新的 generate_keys.rb 脚本](https://raw.github.com/andymatuschak/Sparkle/55eed9efd84c4a2163a3e2b86c8d9b68a243fb6b/generate_keys.rb)

3.  使用 sign_update.rb 脚本（来自同一文件夹），您将生成 dsa 签名：

    红宝石sign_update.rb

# windows - 有没有办法在 Windows 中的脚本期间将 stderror 重定向到 stdout？

> ID：812492
> 
> 赞同：1
> 
> 时间：2009-05-01T18:04:35.310
> 
> 标签：windows, scripting, batch-file, build-automation

作为一名长期的 UNIX shell 脚本编写者/发布工程师，我在最近的工作中全职进入 Windows 环境，有些事情我不可避免地会错过。

其中之一是我可信赖的旧 'exec 2>&1'，它在 Bourne shell 中在脚本执行期间永久地将 stderr 和 stdout 结合在一起，以便日志记录将捕获所有好的和坏的。

我意识到您可以将 2>foo.log 附加到每个命令行调用的末尾，但我想知道是否有更好的方法。

在 Windows 环境中是否有任何等价物？我们在这里使用 .BAT 文件脚本和 Perl 脚本（主要用于构建自动化，但也用于其他一些事情），我非常想知道这是否可能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T18:15:14.940

在 Perl 你可以做

```
open STDERR, '>&STDOUT' or die "Can't dup STDOUT"; 
```

将脚本的 STDERR 输出重定向到 STDOUT。有关更多信息，请参阅[`open`](http://perldoc.perl.org/functions/open.html)文档。我不希望这会影响系统调用的输出，即`system`反引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:22:56.497

您可以将执行实际工作的 .BAT 嵌套在重定向流以进行日志记录的 .BAT 中。

就像是

```
远程日志.bat
cmd /c work.bat 1>>logfile.log 2>&1

```

```
远程工作.bat
做所有
perl cleanups.pl

```

可能会成功。您可能可以使用 CALL 而不是直接调用第二个 CMD.EXE，我还没有检查过。如果这确实有效，那么解决方案可以是自包含的：只需使用额外的参数调用您自己，以指示日志记录有效并且重定向流。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T20:55:56.183

您可以将重定向应用于命令块以及单个命令

```
(
echo 1
dir
echo 2
) >somefile.txt 
```

但请注意，在命令块内不可能使用标签和 goto。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:07:18.203

阅读 MS 的这篇[知识库文章](http://support.microsoft.com/kb/110930)。取自上述文章的样本：

> 您可以使用“&1”命令将 STDERR 的输出重定向到 STDOUT，然后将输出从 STDOUT 发送到文件，将错误和标准输出打印到单个文件：

```
 dir file.xxx 1> output.msg 2>&1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:28:03.007

对于脚本来说，这`2>&1`件事似乎对我有用：

```
testcmd.cmd > stdboth.txt 2>&1 
```

你到底在做什么，你在做什么时期待什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-02T22:16:50.993

```
:log_me
@if "%~1" NEQ "*" ("%~nx0" * >> "%~n0.log" 2>&1)

:script
echo this is success
echo this is error>&2 
```

而且，如果您的批处理脚本具有命令行参数：

```
:log_me
@call :script %* >> "%~n0.log" 2>&1
exit /b

:script
echo this is success
echo this is error>&2 
```

# c# - 远程代码库

> ID：812493
> 
> 赞同：2
> 
> 时间：2009-05-01T18:05:32.717
> 
> 标签：c#, app-config, codebase

我有一个dll。该dll被上传到服务器上。我希望每次应用程序开始从服务器获取“最新”dll，所以我在我的 app.config 中使用了以下代码。为什么它不起作用？

这是 app.config 文件：

```
<configuration>
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="ReflectionTest"
            publicKeyToken="f94c9b9f0707ee96"
                culture="neutral" />
            <codeBase version="1.0.0.0"                   
                href="http://127.0.0.1/ReflectionTest.dll"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:55:06.593

首先，你可能走错了路。即使您没有更改版本，您的应用程序最终也可能使用旧的程序集副本。

假设您的`<codebase>`元素中有一个有效的 URI，当您的应用程序第一次运行时，运行时将不会在其中找到程序集，直到它探测您的代码库。然后，它将程序集下载到 GAC。当您的应用程序再次运行时，运行时将在 GAC 中找到该程序集，因此它不需要探测它。

`<codebase>`考虑使用反射，而不是使用。具体来说，您可能希望`Assembly.LoadFrom(assemblyUri)`在您的应用程序中使用，从应用程序设置中获取 URI。从那里，您将使用反射 API 创建对象，尤其是使用`Activator.CreateInstance<T>()`.

至于从您的服务器获取该程序集，请确保您的 DLL 位于正确的位置，并且您的 Web 服务器正在运行并正确配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T18:34:07.720

您的 .dll 是否在该位置实际可用？您是否通过一些 Web 应用程序提供服务？

如果您在网络浏览器中键入该 URL，它是否允许您下载或打开该文件？

# c# - 是否存在不依赖 IDisposable 的 Using 模式？

> ID：812495
> 
> 赞同：3
> 
> 时间：2009-05-01T18:06:21.123
> 
> 标签：c#, idisposable, using, misuse

我想创建一个内部消息系统，可以告诉我调用某些代码的持续时间。我在考虑易于使用，使 SystemMessage 类实现 IDisposable。

我会在 SystemMessage 的构造函数期间设置一个时间戳，如果调用了 Dispose，我可以计算出持续时间。

问题是我不想让对象 GC'ed。我希望它作为 MessageCollection 的一部分保留。

**C# 中是否有另一个构造可以让我使用 Using 语句的可用性，而无需踩到 IDisposable 的预期功能。**

```
Using (message = Collection.CreateNewMessage("FileDownlading"))
{
    // I wonder how long it is taking me to download this file in production?
    // Lets log it in a message and store for later pondering.
    WebClass.DownloadAFile("You Know This File Is Great.XML");
}
// we fell out of the using statement, message will figure out how long
// it actually took to run.
// This was clean and easy to implement, but so wrong? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T18:47:52.023

> 问题是我不想让对象 GC'ed。我希望它作为 MessageCollection 的一部分保留。

调用 Dispose 不会导致对象被 GC'ed - 当 GC 进行扫描并且没有引用它时会发生这种情况。如果您仍然通过 MessageCollection 引用该对象，它会一直存在。

Dispose 可以防止它被 Finalized，但是由于您没有使用 Dispose 来清理资源，因此您将没有 Finalizer 并且您不会在意。

所以，真正唯一的问题是让你的 cals 实现 IDisposable 的语义令人困惑，即使没有要处理的资源。

就个人而言，我不认为这是一个问题。如果消费者调用 Dispose，那么很好 - 他们得到时间记录。如果他们不这样做，那么他们就不会获得 itme 邮票，最糟糕的是他们会违反 FxCop。

然而，它有点不直观 - 所以如果这是供公众使用，我建议提供一个更容易发现的替代方案，例如：

```
// C# 3+ lambda syntax
Collection.CreateNewMessage("FileDownlading", () => {
    // I wonder how long it is taking me to download this file in production?    
    // Lets log it in a message and store for later pondering.    
    WebClass.DownloadAFile("You Know This File Is Great.XML");
});

// C# 2 anonymous delegate syntax
Collection.CreateNewMessage("FileDownlading", delegate() {
    // I wonder how long it is taking me to download this file in production?    
    // Lets log it in a message and store for later pondering.    
    WebClass.DownloadAFile("You Know This File Is Great.XML");
});

// Method
void CreateNewMessage(string name, Action action) {
   StopWatch sw = StopWatch.StartNew();
   try {
      action();
   } finally {
      Log("{0} took {1}ms", name, sw.ElapsedMilliseconds);
   }
} 
```

它将运行并计时一个 Action 委托。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:35:50.930

你在寻找类似于闭包的东西吗？

[http://en.wikipedia.org/wiki/Closure_(computer_science)](http://en.wikipedia.org/wiki/Closure_(computer_science))

你可以伪造一些东西......像这样......

```
private TimeSpan GetDuration(Action a)
        {
            var start = DateTime.Now;
            a.Invoke();
            var end = DateTime.Now;
            return end.Subtract(start);
        }

        public void something()
        {
            string message;
            var timeSpan = GetDuration(() => { message = "Hello"; } );
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:13:57.003

我不认为 using 是你想要的。为什么不让构造函数记录时间，然后在调用 DownloadAFile 时记录时间增量？在您的示例中，如果有异常，它将记录异常的时间，就好像当时下载了文件一样。

如果您真的希望行为像您的示例一样，只需使用 try / finally 块，然后在 finally 中进行日志记录。`using`只是 try / finally 块和调用的语法糖`Dispose`。

您的示例的等效代码如下所示：

```
try 
{
    var message = Collection.CreateNewMessage("FileDownlading"); 
    //...
    WebClass.DownloadAFile("You Know This File Is Great.XML");
}
finally 
{
    //You can change this to do logging instead.
    message.Dispose(); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:16:11.867

您可以在 DownloadAFile() 中使用 System.Diagnostics.Stopwatch 来在每次调用时进行计时。

或者，只需在对 DownloadAFile() 的调用周围添加秒表代码（取决于您希望它如何工作）。

在这种情况下使用 IDisposable 不是一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T22:30:24.250

我最近一直在看这个，也许 PostSharp 可以帮助你。它允许您使用属性装饰方法，该属性将在您的方法启动和停止时调用。

[http://www.postsharp.org/](http://www.postsharp.org/)

我不确定它会做你喜欢的事，但它值得研究，它有你渴望的“句法糖”！

克里斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-06T07:37:51.970

好吧，这是一个老歌，但似乎没有其他人发布我认为最好的答案（根据我对您的要求的理解）：

```
using (MessageTimer timer = Collection.CreateNewTimedMessage("blabla"))
{
   // ...
} 
```

重要的一点是，它`CreateNewTimedMessage`可能会作为副作用创建和存储一个半永久性`Message`对象，但它会*返回*一个临时计时对象（使用`StopWatch`，或某种类似机制），该对象无法在`using`块的范围内生存。（`MessageTimer`可以引用`Message`，但不能反过来。）

因此，处理`MessageTimer`对象可能会产生在某处记录最后时间的副作用，但对象本身不会存活或复活；这不是对`using`构造的滥用，因为您确实在处理一个对象。

（实际的实现`MessageTimer`可能与乔的回答类似。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T19:02:34.810

The 'using' statement actually compiles down to a Try/Finally that expects the object to implement IDisposable--"using" is just a shortcut provided by the language.

For your purposes, especially since you want to recycle the object, I would consider writing your own interface. When you call a method to start timing just grab the value of datetime.now; and again when you stop the timer. Then subtract starttime from stoptime and you'll have the duration.

Avoid using a true Timer object on each class instance. Timer's use a ThreadPool thread, which means that each message will consume at least one thread--if too many messages are in the system your application will slow down as a result of the thread switching. Also, if the timer's aren't properly disposed they may not release their ThreadPool threads and you will essentially have a thread leak.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T18:16:13.830

并不真地。你能来的最接近的是这样的（这就是 using() 语句的底层发生的事情：）

```
var message = Collection.CreateNewMessage("FileDownloading")

try
{
    WebClass.DownloadAFile("You Know This File Is Great.XML");
}
finally
{
    message.HowLongHaveIBeenAlive();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T18:16:20.400

using 语句旨在在您完成对象后处理它们。在一个对象被丢弃后抓住它的想法并不完全是有意的。你可以尝试做一些简单的事情：

```
message = Collection.CreateNewMessage("FileDownlading");
DateTime dtStart = DateTime.Now;
WebClass.DownloadAFile("You Know This File Is Great.XML");
DateTime dtEnd = DateTime.Now;

// perform comparison here to see how long it took.

// dispose of DateTimes
dtStart = dtEnd = null; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T19:55:04.450

After reviewing your question again I don't see how the object in question is really a Message, unless it is more like a tracing message (for debugging assistance).

If you're looking for something more along those lines then here is a *very* rough approach using delegates. Essentially you create a delegate for each method you want to call and time, then pass the delegate and the method arguments off to a helper who is responsible for the actual calling of the method and timing its duration.

The obvious shortcoming in my example is that I sacrificed type-safe arguments since I wasn't sure if it was exactly what you're looking for or not. The other issue is that you would need to add a new delegate every time you want to call a method which has a method signature that you don't already have a delegate for:

```
using System;

namespace ConsoleApplication4
{
    class Program
    {
        static void Main(string[] args)
        {

            SomeCaller callerOne;
            YetAnotherCaller callerTwo;

            callerOne = new SomeCaller(SomeMethod);
            LogCallDuration(callerOne, new object[] { 15 });

            callerOne = new SomeCaller(SomeOtherMethod);
            LogCallDuration(callerOne, new object[] { 22 });

            callerTwo = new YetAnotherCaller(YetAnotherMethod);
            LogCallDuration(callerTwo, null);

            Console.ReadKey();
        }

        #region "Supporting Methods/Delegates"

        delegate void SomeCaller(int someArg);
        delegate void YetAnotherCaller();

        static void LogCallDuration(Delegate targetMethod, object[] args)
        {
            DateTime start = DateTime.UtcNow;
            targetMethod.DynamicInvoke(args);
            DateTime stop = DateTime.UtcNow;

            TimeSpan duration = stop - start;

            Console.WriteLine(string.Format("Method '{0}' took {1}ms to complete", targetMethod.Method.Name, duration.Milliseconds));

        }

        #endregion "Supporting Methods/Delegates"

        #region "Target methods, these don't have to be in your code"
        static void SomeMethod(int someArg)
        {
            // Do something that takes a little time
            System.Threading.Thread.Sleep(1 + someArg);
        }

        static void SomeOtherMethod(int someArg)
        {
            // Do something that takes a little time
            System.Threading.Thread.Sleep(320 - someArg);
        }

        static void YetAnotherMethod()
        {
            // Do something that takes a little time
            System.Threading.Thread.Sleep(150);
        }
        #endregion "Target methods"
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-01T18:38:00.220

最初`IDisposable`的目的是作为在 C# 中引入确定性清理的一种方式，但我已经看到[作者](https://rads.stackoverflow.com/amzn/click/com/0735623082)和[实现](http://www.typemock.com/index.php)使用`using`/`Dispose`功能来实现您所谈论的内容。

就个人而言，我对此不太满意，因为它破坏了背后的概念`IDisposable`，但由于没有其他选择，它归结为你想成为多正统的问题。我当然可以理解您为什么要这样做，但是这样做会使您更难以解释`IDisposable`界面的目的和重要性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-01T18:42:45.063

可以说这是对 using 构造的滥用，因此我可能不会在以这种方式使用 IDisposable 的共享类库中实现公共类。

但是我已经看到了这种事情，并且认为如果它保留在您的应用程序内部是可以的。

> 问题是我不想让对象 GC'ed。我希望它作为 MessageCollection 的一部分保留。

我完全不明白这一点。IDisposable 与 GC 无关，如果将其作为 MessageCollection 的元素引用，您的消息将保持活动状态。

您的消息类可能类似于下面的示例。调用 Dispose 后，它仍然存在并且运行良好。大多数实现 IDisposable 的类在调用 Dispose 后不可用，因此如果在调用 Dispose 后访问成员，它们的实现将引发 ObjectDisposedException。但这绝不是强制性的。

```
class Message : IDisposable
{
    private Stopwatch _stopwatch = Stopwatch.StartNew();
    private long _elapsedTicks;
    private string _message;

    public Message(string message)
    {
        _message = message;
    }

    public void Dispose()
    {
       _elapsedTicks = _stopwatch.ElapsedTicks;
       ... anything else including logging the message ...
    }

    ...
} 
```

# svn - 您的 SVN“项目”有多精细：一个包含多个相关应用程序的大项目或每个应用程序一个“项目”

> ID：812497
> 
> 赞同：7
> 
> 时间：2009-05-01T18:06:56.117
> 
> 标签：svn, projects, file-organization

我将项目定义为包含主干、分支、标签子目录的 SVN 目录。

**在确定何时将项目拆分为两个或将多个项目合并为一个时，您使用什么标准？** - 每个“项目”一个应用程序，具有用于公共源和资源的共享项目？- 一个包含应用程序所有源和资源的大“项目”？

单项目或多项目都有其优点和缺点。我们正朝着一个单一的项目迈进，我正试图弄清楚这是否是正确的方法。

拆分项目允许更好地控制套件的不同部分如何合并更改。公共库可以是版本，不同的应用程序可以选择使用特定版本（maven dep 管理方法）。

拆分项目还会创建多个类层次结构，使代码整体更难理解，并可能导致代码重复。我认为适当设计整体结构和组件之间的关系将是管理此成本的关键。

统一的项目方法将使开发人员在设置工作空间方面更容易，并提供单一的类层次结构。这是一把双刃剑，因为它还会向开发人员提供更多信息（太多类无法理解）。

所以，当你试图决定在哪里合并和在哪里拆分时，你使用什么经验法则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T18:21:33.850

我们将与单个应用程序相关的所有项目都放在一个 SVN Rep 中，只是为了便于维护，将应用程序的代码库仅集中在一个存储库中，并且还能够管理应用程序不同资源之间的相互依赖关系。

我们通常将我们的资源分类到主干内的不同文件夹中。该分类主要基于功能/模块化分组或分层分组[DAL、BLL、GUI等]。这完全取决于您如何构建代码。希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T18:18:33.700

[SVN Book](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.planning.html#svn.reposadmin.projects.chooselayout)对这两种方法都有很好的讨论。

最后，我会选择对存储库用户来说更自然的东西。

就个人而言，我更喜欢单一的 SVN 主干/标签/分支方法，我所有的实际代码项目都在它们自己的文件夹中。

但是，对于更大的代码库（我只管理了 3-4 个属于单个解决方案的小项目），我会高度考虑更改为拆分方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T18:21:49.043

我根据项目规模使用单独的项目和组合项目。对于我们的大型项目，每个项目都在一个单独的存储库中，并且具有独立的构建和部署过程。对于我们较小的项目，我们有一个“工具”存储库来包含它们，每个子项目都作为根的子目录。

我还维护一个“个人”存储库，人们可以在其中存储他们的测试程序一次性实用程序，或其他可以从源代码控制和集中备份中受益但不属于独立项目的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T18:18:00.690

我使用单独的项目并通过 svn:externals 将它们组合成一个解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T18:22:25.830

每个项目独立部署的一个应用程序/模块。如果你发现你需要一个依赖于其他模块的稳定实现的模块的 Maven 式依赖管理，那么使用单个项目就很难引入发布周期。它还可能导致人们直接使用来自其他应用程序的随机有用的代码，而不是将其分解以保持依赖关系图健全 (tm)。

您应该使用适当的测试套件和明确定义的 CI 实践进行集成测试，而不是依赖于一半的代码在某个部分中断时突然失败。

拥有单个超级项目的另一个问题是，对于仅在单个模块上工作的 git-svn 用户来说，它相当繁重。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-01T21:16:32.760

有机地成长。Dijkstra 曾经说过，预优化是万恶之源。还要记住 YANGI（你不需要它）。

每个应用程序都有自己的带有主干/标签/分支的文件夹。如果应用程序中的项目变得非常大，那么它会被推送到它自己的单独文件夹，并且可以在构建时链接到应用程序（甚至是 svn:externals）。

也就是说，如果您的项目要求是开发一个由 10 个开发人员编写的复杂应用程序，并且您是看门人或构建大师，那么您可以考虑更复杂的替代方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T18:24:38.693

为单独的项目保留单独的 SVN 存储库。你最不想要的就是有一个[合并日](http://thedailywtf.com/Articles/Happy_Merge_Day!.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T21:22:36.130

您可能想要[跨多个项目检查 Subversion 修订号](https://stackoverflow.com/questions/15674/subversion-revision-number-across-multiple-projects/230005#230005)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-04T13:12:27.093

感谢您的输入。我不会“选择”答案，因为我认为所有答案都具有价值。避免过早的优化似乎很关键，就像暂时保持布局尽可能简单一样。我们正在转向包含应用程序的单个项目，因为 90% 的时间我们一起发布所有应用程序。因此，让每个项目一个应用程序使事情复杂化似乎没有意义。即使我们使用 maven，给定版本的所有 maven 工件也可能来自同一个分支。如果需要使用 SVN 历史记录和鱼眼来保持我们的理智，我们可以随时更改它。

我们将重构源代码布局，就像我们重构源代码一样。当一个项目从周长和依赖情况开始“闻起来很糟糕”时，我们将把它分解，但不是在那之前。我可能会及时使用周长而不是空间周长：构建和测试的时间，结帐的时间。如果我有一个 1GB 的树，我可以在 10 分钟内结帐并在 30 分钟内构建/测试，除非我需要经常发布它的一部分，否则我真的不需要分解它。

所以，感谢您的输入。这对我为我的团队制定问题和评估选项非常有帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-04T13:50:56.470

这里没有“好”的答案，但我认为应该区分包含 1 或 2 个项目的 SVN 存储库和包含 100 个项目的其他存储库。

我维护了一个从 VSS 迁移的 SVN 存储库，其中有数百个“项目”，没有一个是按照主干/分支/标签结构组织的（事实上，我认为这种结构在我之后确实是不必要且无益的） SVN 已经使​​用了一段时间，当您必须将 2 或 3 个项目标记为单个更改时，它肯定无济于事）。

我们为所有维护的软件维护一个项目目录，在该目录下我们有用于配置的子目录和用于源的另一个目录。在那些我们有产品版本号的情况下——我们实际上抛弃了主干的概念，我们只有标签目录——最大的数字是主干（我们必须这样做，因为我们必须同时支持多个版本的项目）。合并根据需要进行，所以如果我更新项目 A 3.0 版中的错误；我会将这些更改合并到版本 4.0 和 v5.0。

如果我只用 1 或 2 个项目进行回购，我可能会想保留分支/标签结构，但另一方面 - 我可能会在主树中保持目录显式（假设我没有经常发布以定期标记）（我将修订号用作“标记”顺便说一句，并将二进制文件存储在其中。因此，如果我需要获取特定的旧修订版，我可以通过查看日志来获取正确的二进制文件）

考虑到我有一个 10Gb 的存储库，其 revnum 目前已超过 300,000，其中包含许多旧代码以及更新的代码，因此管理起来非常容易。我会向其他人推荐该结构并将再次使用它。

顺便说一句，标签 dir 对我们不起作用的另一个原因是因为每次有错误或更改请求时我们都会发布，无论多么微小。一段时间后，我们的标签目录将无法管理，这就是我们使用 revnum 作为标签的原因 - 我们可以将它与错误跟踪器相关联，以使其更具人类可读性。

所以粗略地总结一下，我们有一个这样的目录结构，其中 v1 和 v2 是产品版本：

```
maint/source/v1.0/projectA
maint/source/v1.0/projectB
maint/source/v2.0/projectA
maint/source/v2.0/projectB
etc 
```

显然，我们可以在“源”下放置一个分支目录，并在每个子项目下放置一个分支/标签，但是如果我们需要将 2 个子项目作为一个更改请求发布（就像我们经常做的那样），这将变得很棘手。在源目录下放置标签子目录意味着我们标记所有内容，当只有一个子项目被更改时（不符合我们单独跟踪每个子项目的要求）

# apache - 如何缓存 Apaches GZIP 压缩内容

> ID：812501
> 
> 赞同：6
> 
> 时间：2009-05-01T18:07:22.213
> 
> 标签：apache, module, gzip, compression

Apache 内置了 GZIP 内容（HTML、JPG.. 等）的功能，每次完成时它使用的 CPU 都会比正常情况稍多。

所以我的问题是，是否可以缓存最终压缩版本，而不是让您的机器每次都这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:11:24.467

是的，您将使用[mod_cache](http://httpd.apache.org/docs/2.2/mod/mod_cache.html)（可能与[mod_disk_cache](http://httpd.apache.org/docs/2.2/mod/mod_disk_cache.html)一起使用）。

# c# - C# 中的字符串连接与内部字符串

> ID：812503
> 
> 赞同：3
> 
> 时间：2009-05-01T18:07:40.683
> 
> 标签：c#, string, performance, stringbuilder

我知道这个问题[已经](https://stackoverflow.com/questions/21078/whats-the-best-string-concatenation-method-using-c)[完成](https://stackoverflow.com/questions/38010/c-string-concatenation-and-string-interning)，但我对此略有不同。一些人指出这是过早的优化，如果我只是为了实用性和实用性而要求，这是完全正确的。我的问题源于一个实际问题，但我仍然很好奇。

* * *

我正在创建一堆 SQL 语句来创建一个脚本（因为它将被保存到磁盘中）来重新创建一个数据库模式（很容易有数百个表、视图等）。这意味着我的字符串连接是仅附加的。根据 MSDN，StringBuilder 的工作原理是保留一个内部缓冲区（肯定是 char[]）并将**字符串字符复制**到其中并根据需要**重新分配**数组。

但是，我的代码有很多重复的字符串（“CREATE TABLE [”、“GO\n”等），这意味着我可以利用它们[被实习](https://stackoverflow.com/questions/38010/c-string-concatenation-and-string-interning)，但如果我使用 StringBuilder 则不能，因为它们每次都会被复制。唯一的变量本质上是表名​​，并且已经作为字符串存在于内存中的其他对象中。

据我所知，在读入我的数据并创建包含架构信息的对象之后，我的所有字符串信息都可以通过实习重用，是吗？

假设这样，那么字符串的 List 或 LinkedList 会不会更快，因为它们保留了指向实习字符串的指针？然后，只需调用一次 String.Concat() 即可对长度完全正确的整个字符串进行一次内存分配。

List 必须重新分配 string[] 的 interned 指针，而链表必须创建节点并修改指针，所以它们不是“免费”的，但如果我**连接数千个 interned 字符串，**那么它们看起来就像他们会更有效率一样。

现在我想我可以想出一些关于每个 SQL 语句的字符计数的启发式方法并计算每种类型并得到一个粗略的想法并预先设置我的 StringBuilder 容量以避免重新分配它的 char[] 但我必须以相当大的幅度过冲以减少重新分配的可能性。

因此，对于这种情况，获得单个连接字符串的速度最快：

*   字符串生成器
*   列表<string> 的实习字符串
*   LinkedList<string> 的实习字符串
*   具有容量启发式的 StringBuilder
*   还有什么？

作为一个**单独的问题**（我可能并不总是去磁盘）到上面：单个 StreamWriter 到输出文件会更快吗？或者，使用 List 或 LinkedList 然后将它们从列表中写入文件，而不是首先在内存中连接。

**编辑：** 根据要求，[参考](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)（.NET 3.5）到 MSDN。它说：*“如果有可用空间，则将新数据附加到缓冲区的末尾；否则，分配一个新的更大的缓冲区，将原始缓冲区中的数据复制到新缓冲区，然后将新数据附加到新缓冲区缓冲。”* 这对我来说意味着一个 char[] 被重新分配以使其更大（这需要将旧数据复制到调整大小的数组）然后追加。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T20:30:37.570

如果我正在实现这样的东西，我将永远不会构建 StringBuilder （或脚本的内存缓冲区中的任何其他内容）。我只是将其流式传输到您的文件中，并将所有字符串内联。

这是一个示例伪代码（语法不正确或其他任何内容）：

```
FileStream f = new FileStream("yourscript.sql");
foreach (Table t in myTables)
{
    f.write("CREATE TABLE [");
    f.write(t.ToString());
    f.write("]");
    ....
} 
```

然后，您将永远不需要脚本的内存表示，以及所有字符串的复制。

意见？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T23:47:14.103

对于您的**单独问题**，Win32 有一个**[WriteFileGather](http://msdn.microsoft.com/en-us/library/aa365749(VS.85).aspx)**函数，该函数可以有效地将（内部）字符串列表写入磁盘 - 但只有在异步调用时才会产生显着差异，因为磁盘写入会掩盖所有但非常大的串联。

对于您的**主要问题**：除非您达到兆字节的脚本或数万个脚本，否则不要担心。

您可以期望 StringBuilder 在每次重新分配时将分配大小加倍。这意味着将缓冲区从 256 字节增加到 1MB 只需 12 次重新分配 - 相当不错，因为您最初的估计与目标相差 3 个数量级。

纯粹作为一个练习，一些估计：构建一个 1MB 的缓冲区将扫描大约 3MB 内存（1MB 源，1MB 目标，1MB 由于重新分配期间的复制）。

链表实现将扫描大约 2MB，（并且忽略每个字符串引用的 8 字节/对象开销）。因此，与 10Gbit/s 的典型内存带宽和 1MB L2 缓存相比，您节省了 1 MB 的内存读取/写入。）

是的，列表实现可能更快，如果您的缓冲区大一个数量级，差异将很重要。

对于更常见的小字符串情况，算法增益可以忽略不计，并且很容易被其他因素抵消：StringBuilder 代码可能已经在代码缓存中，并且是微优化的可行目标。此外，如果最终字符串适合初始缓冲区，则在内部使用字符串意味着根本没有副本。

使用链表还将重新分配问题从 O（字符数）降低到 O（段数） - 您的字符串引用列表面临与字符串相同的问题！

* * *

因此，IMO StringBuilder 的实现是正确的选择，针对常见情况进行了优化，并且主要针对意外大的目标缓冲区而降级。我希望列表实现首先会针对非常多的小段进行降级，这实际上是 StringBuilder 试图优化的极端场景。

尽管如此，看看这两个想法的比较以及列表何时开始变得更快会很有趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T18:19:55.100

以我的经验，对于大量字符串数据，我正确分配的 StringBuilder 的性能优于大多数其他方法。浪费一些内存是值得的，甚至为了防止重新分配，将估计值超出 20% 或 30%。我目前没有使用我自己的数据来支持它的硬数字，但请查看[此页面了解更多信息](http://blog.briandicroce.com/2008/02/04/stringbuilder-vs-string-performance-in-net/)。

[然而，正如 Jeff 喜欢指出的那样，不要过早地优化！](http://www.codinghorror.com/blog/archives/001218.html)

编辑：正如@Colin Burnett 指出的那样，Jeff 进行的测试与 Brian 的测试不一致，但链接 Jeff 的帖子的重点是一般来说过早的优化。杰夫页面上的几位评论者指出了他的测试存在问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:28:29.450

实际上`StringBuilder`使用`String`内部的一个实例。`String`实际上在`System`程序集中是可变的，这就是为什么`StringBuilder`可以在它之上构建。您可以`StringBuilder`通过在创建实例时分配合理的长度来提高效率。这样，您将消除/减少调整大小操作的数量。

字符串实习适用于可以在编译时识别的字符串。因此，如果您在执行期间生成大量字符串，除非您自己通过调用 string 上的 interning 方法来执行此操作，否则它们将不会被实习。

只有当您的字符串相同时，实习才会使您受益。几乎相同的字符串不会从实习中受益，因此即使它们被实习也将是两个不同的字符串`"SOMESTRINGA"`。`"SOMESTRINGB"`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T18:46:33.947

如果连接的所有（或大部分）字符串都被保留，那么您的方案可能会给您带来性能提升，因为它可能会使用更少的内存，并且可以节省一些大字符串副本。

但是，它是否真的提高了性能取决于您正在处理的数据量，因为改进是在常数因素中，而不是在算法的数量级上。

唯一能真正分辨的方法是使用两种方式运行您的应用程序并测量结果。但是，除非您承受着巨大的内存压力，并且需要一种保存字节的方法，否则我不会打扰，只会使用字符串生成器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T18:52:52.510

A`StringBuilder`不使用 a`char[]`来存储数据，它使用内部可变字符串。这意味着没有额外的步骤来创建最终字符串，因为当您连接字符串列表时，`StringBuilder`只需将内部字符串缓冲区作为常规字符串返回。

`StringBuilder`为增加容量所做的重新分配意味着数据平均被复制了 1.33 次。如果您可以在创建时提供对大小的良好估计，则`StringBuilder`可以进一步减小该大小。

但是，为了获得一些观点，您应该查看您正在尝试优化的内容。在您的程序中花费的大部分时间是将数据实际写入磁盘，因此即使您可以将字符串处理优化为使用 a 的两倍`StringBuilder`（这不太可能），总体差异仍然只是百分之几。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T17:10:47.863

您是否为此考虑过 C++？是否有已经构建 T/SQL 表达式的库类，最好用 C++ 编写。

关于字符串最慢的事情是malloc。在 32 位平台上，每个字符串占用 4KB。考虑优化创建的字符串对象的数量。

如果你必须使用 C#，我会推荐这样的东西：

```
string varString1 = tableName;
string varString2 = tableName;

StringBuilder sb1 = new StringBuilder("const expression");
sb1.Append(varString1);

StringBuilder sb2 = new StringBuilder("const expression");
sb2.Append(varString2);

string resultingString = sb1.ToString() + sb2.ToString(); 
```

如果性能非常重要，我什至会让计算机评估使用依赖注入框架进行对象实例化的最佳路径。

# actionscript-3 - AS2 按钮到 AS3

> ID：812506
> 
> 赞同：2
> 
> 时间：2009-05-01T18:11:17.337
> 
> 标签：actionscript-3, actionscript-2, button

如何将这些 AS2 按钮转换为 AS3？

```
on (press) {
    nextFrame();
}
on (press) {
    prevFrame();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T18:34:40.307

```
import flash.events.MouseEvent;

this.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);

public function mouseDownHandler(event:MouseEvent):void{
    nextFrame();
} 
```

但是您可能还应该阅读本文以了解事件模型是如何变化的：

[http://www.flashvalley.com/fv_tutorials/mouse_events_in_actionscript_3.0/](http://www.flashvalley.com/fv_tutorials/mouse_events_in_actionscript_3.0/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:13:00.010

如果您习惯于“ **on(press)** ”按钮代码，AS3 会有相当大的变化。

这是适合您的完美视频教程：[AS3 入门 - 简单按钮](http://www.adobe.com/designcenter/video_workshop/?id=vid0130)。它为来自 AS2 的人解释了 AS3 中按钮的基础知识。这应该给你一个很好的概述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-09T00:09:03.240

```
import flash.events.MouseEvent; 
```

...

```
buttonA.addEventListener(MouseEvent.CLICK, onPressPrev);
buttonB.addEventListener(MouseEvent.CLICK, onPressNext);

private function onPressPrev(e:MouseEvent=null):void{
    prevFrame();
}
private function onPressNext(e:MouseEvent=null):void{
    nextFrame();
}

private function prevFrame():void{
    gotoAndStop(currentFrame-1)
}
private function nextFrame():void{
    gotoAndStop(currentFrame+1)
} 
```

希望这会有所帮助。就新的 MouseEvent 结构而言，似乎已经回答了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-15T05:00:48.063

//我看到你在做非 OOP 所以这样做，把它放在第二帧。根据您的喜好修改它。确保您在整个时间线上都有按钮，而不会在任何地方丢失。如果您有青少年，只需将其移出屏幕即可。

```
import flash.display.MovieClip;
import flash.events.MouseEvent;

urlbutton.addEventListener(MouseEvent.CLICK, urlfunc); 
urlbutton.useHandCursor = true; 

function urlfunc(myEvent:MouseEvent){ 
    var request:URLRequest = new URLRequest("siteurl");
    navigateToURL(request, "_blank");
    } 

continuebutton.addEventListener(MouseEvent.CLICK, continuefunc); 
continuebutton.useHandCursor = true; 

function continuefunc(myEvent:MouseEvent){ 
    gotoAndPlay('playgame');
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-05T16:52:19.593

编写按钮事件处理程序的最短方法是这样的

```
var btn:SimpleButton;

btn.addEventListener(MouseEvent.CLICK,function(e:MouseEvent):void{
    //do your code for the click here
    nextFrame();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-05T17:19:44.333

对于 AS2，我一直在使用此代码。

```
on(release){
    gotoAndStop(2);
{ 
```

对于 AS3

```
LIST.addEventListener(MouseEvent.CLICK, Button)

function (Button)(evt:MouseEvent){
    gotoAndStop(2)
} 
```

因此，对于它所说的（按钮），它是函数的名称和按钮的名称。

# c# - 如何从我的域逻辑生成 NHibernate 映射文件和 DB 构造？

> ID：812510
> 
> 赞同：2
> 
> 时间：2009-05-01T18:12:06.197
> 
> 标签：c#, database, nhibernate, nhibernate-mapping

我想在我的项目中的域对象上实现 NHibernate，但我不确定应该如何生成映射文件和数据库。

我在[这里](https://stackoverflow.com/questions/432118/generate-database-from-nhibernate-config-files)和[这里](https://stackoverflow.com/questions/183586/tool-for-generating-c-classes-from-nhibernate-mappings-files)发现了一些与此相关的问题，但是我从已经定义的类开始，并希望从它们开始并按我的方式工作，而不是相反。

有没有办法做到这一点？

我对多阶段过程非常满意，我只想知道其他人做了什么对他们来说是成功的。

仅供参考，我想在 SQL Server 2005 上部署数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T18:34:38.530

我喜欢[Fluent-NHibernate](http://code.google.com/p/fluent-nhibernate/)。请参阅下面的示例以映射用户类，当然您可以使用 XML。

lamda 表达式中的 x 值表示域类。

这非常像我非常喜欢的 RoR

```
public sealed class UserMap : ClassMap<User>, IMapGenerator
    {
        public UserMap()
        { 
            Id(x => x.Id)
                .WithUnsavedValue(0);
            Map(x => x.Username).TheColumnNameIs("UserName");
            Map(x => x.Password).TheColumnNameIs("Password");   
            Map(x => x.Salt).ReadOnly();

            Map(x => x.CreatedOn).ReadOnly();
            Map(x => x.CreatedBy).ReadOnly();
            Map(x => x.CreatedAt).ReadOnly();

            Map(x => x.ApprovalStatus)
                .TheColumnNameIs("ApprovalStatusId")
                .CustomTypeIs(typeof(ApprovalStatus));

            Map(x => x.DeletionStatus)
                .TheColumnNameIs("DeletionStatusId")
                .CustomTypeIs(typeof(DeletionStatus));

            References(x => x.Role).Not.Nullable();
            References(x => x.Contact);

        }

        #region IMapGenerator Members

        public System.Xml.XmlDocument Generate()
        {
            return CreateMapping(new MappingVisitor());
        }

        #endregion
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:53:49.497

关于映射：您可以像 Gary 一样使用 Fluent Mapping 创建映射。当您有一个非常简单的域模型时，您可以使用 Automapping，这是 FluentNhibernate 的基于约定的映射功能：

```
 var sessionFactory = Fluently.Configure()  
   .Database(MsSqlConfiguration.MsSql2005  
     .ConnectionString(c => c  
       .Is(ApplicationConnectionString)))  
   .Mappings(m =>  
     m.AutoMappings.Add(AutoPersistenceModel.MapEntitiesFromAssemblyOf<Product>())  
   )  
   .BuildSessionFactory(); 
```

这就是你所需要的。

您可以使用 schemaexport 构建数据库：

```
var schemaExport = new SchemaExport(configuration);
schemaExport.Create(false,true); 
```

# mysql - 删除匹配行的更快方法？

> ID：812512
> 
> 赞同：60
> 
> 时间：2009-05-01T18:12:09.083
> 
> 标签：mysql, performance, sql-delete, sql-execution-plan

在数据库方面，我是一个相对新手。我们正在使用 MySQL，我目前正在尝试加速似乎需要一段时间才能运行的 SQL 语句。我在 SO 上四处寻找类似的问题，但没有找到。

目标是删除表 A 中与表 B 中具有匹配 id 的所有行。

我目前正在执行以下操作：

```
DELETE FROM a WHERE EXISTS (SELECT b.id FROM b WHERE b.id = a.id); 
```

表 a 中大约有 100K 行，表 b 中大约有 22K 行。'id' 列是两个表的 PK。

这条语句在我的测试机上运行大约需要 3 分钟 - Pentium D, XP SP3, 2GB ram, MySQL 5.0.67。这对我来说似乎很慢。也许不是，但我希望加快速度。有没有更好/更快的方法来实现这一点？

* * *

编辑：

一些可能有用的附加信息。表 A 和 B 的结构与我为创建表 B 所做的以下操作相同：

```
CREATE TABLE b LIKE a; 
```

表 a（以及表 b）有一些索引来帮助加快对其进行的查询。同样，我是 DB 工作的相对新手，仍在学习。我不知道这对事物有多大影响，如果有的话。我认为它确实有效果，因为索引也必须清理，对吧？我还想知道是否有任何其他可能影响速度的数据库设置。

另外，我正在使用 INNO DB。

* * *

以下是一些可能对您有所帮助的附加信息。

表 A 的结构与此类似（我已经对此进行了一些清理）：

```
DROP TABLE IF EXISTS `frobozz`.`a`;
CREATE TABLE  `frobozz`.`a` (
  `id` bigint(20) unsigned NOT NULL auto_increment,
  `fk_g` varchar(30) NOT NULL,
  `h` int(10) unsigned default NULL,
  `i` longtext,
  `j` bigint(20) NOT NULL,
  `k` bigint(20) default NULL,
  `l` varchar(45) NOT NULL,
  `m` int(10) unsigned default NULL,
  `n` varchar(20) default NULL,
  `o` bigint(20) NOT NULL,
  `p` tinyint(1) NOT NULL,
  PRIMARY KEY  USING BTREE (`id`),
  KEY `idx_l` (`l`),
  KEY `idx_h` USING BTREE (`h`),
  KEY `idx_m` USING BTREE (`m`),
  KEY `idx_fk_g` USING BTREE (`fk_g`),
  KEY `fk_g_frobozz` (`id`,`fk_g`),
  CONSTRAINT `fk_g_frobozz` FOREIGN KEY (`fk_g`) REFERENCES `frotz` (`g`)
) ENGINE=InnoDB AUTO_INCREMENT=179369 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC; 
```

我怀疑部分问题是该表有许多索引。表 B 看起来与表 B 相似，但它只包含列`id`和`h`。

此外，分析结果如下：

```
starting 0.000018
checking query cache for query 0.000044
checking permissions 0.000005
Opening tables 0.000009
init 0.000019
optimizing 0.000004
executing 0.000043
end 0.000005
end 0.000002
query end 0.000003
freeing items 0.000007
logging slow query 0.000002
cleaning up 0.000002 
```

* * *

**解决了**

感谢所有的回复和评论。他们当然让我思考这个问题。**感谢 dotjoe**通过提出一个简单的问题“是否有其他表引用 a.id？”让我摆脱了这个问题。

问题是表 A 上有一个 DELETE TRIGGER，它调用存储过程来更新另外两个表 C 和 D。表 C 有一个返回到 a.id 的 FK，并且在存储过程中做了一些与该 id 相关的事情之后，它有声明，

```
DELETE FROM c WHERE c.id = theId; 
```

我查看了 EXPLAIN 语句并将其重写为，

```
EXPLAIN SELECT * FROM c WHERE c.other_id = 12345; 
```

所以，我可以看到这是在做什么，它给了我以下信息：

```
id            1
select_type   SIMPLE
table         c
type          ALL
possible_keys NULL
key           NULL
key_len       NULL
ref           NULL
rows          2633
Extra         using where 
```

这告诉我这是一个痛苦的操作，因为它会被调用 22500 次（对于被删除的给定数据集），这就是问题所在。一旦我在 other_id 列上创建了一个 INDEX 并重新运行 EXPLAIN，我得到：

```
id            1
select_type   SIMPLE
table         c
type          ref
possible_keys Index_1
key           Index_1
key_len       8
ref           const
rows          1
Extra 
```

好多了，事实上真的很棒。

我补充说 Index_1 和我的删除时间与**mattkemp**报告的时间一致。这对我来说是一个非常微妙的错误，因为在最后一分钟增加了一些额外的功能。事实证明，正如**Daniel**所说，大多数建议的替代 DELETE/SELECT 语句最终花费了基本相同的时间，并且正如**soulmerge**提到的那样，该语句几乎是我能够根据什么构建的最好的语句我需要做。一旦我为另一个表 C 提供了索引，我的 DELETE 很快。

**事后**分析：
从这个练习中学到了两个教训。首先，很明显，我没有利用 EXPLAIN 语句的强大功能来更好地了解我的 SQL 查询的影响。这是一个菜鸟的错误，所以我不会为此而自责。我会从那个错误中吸取教训。其次，有问题的代码是“快速完成”心态的结果，而设计/测试不足导致这个问题没有尽快出现。如果我生成了几个相当大的测试数据集作为这个新功能的测试输入，我不会浪费我和你的时间。我在数据库方面的测试缺乏我的应用程序方面的深度。现在我有机会改进它。

[参考：EXPLAIN 语句](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-05-06T16:51:57.923

从 InnoDB 中删除数据是您可以请求的最昂贵的操作。正如您已经发现的那样，查询本身并不是问题——无论如何，它们中的大多数都会被优化为相同的执行计划。

虽然可能很难理解为什么所有情况下的 DELETE 都是最慢的，但有一个相当简单的解释。InnoDB 是一个事务性存储引擎。这意味着，如果您的查询在中途中止，所有记录仍将保留，就好像什么都没发生一样。一旦完成，一切都会在同一瞬间消失。在 DELETE 期间，连接到服务器的其他客户端将看到记录，直到您的 DELETE 完成。

为了实现这一点，InnoDB 使用了一种称为 MVCC（多版本并发控制）的技术。它的基本作用是为每个连接提供整个数据库的快照视图，就像事务的第一条语句开始时一样。为了实现这一点，InnoDB 内部的每条记录都可以有多个值 - 每个快照一个。这也是为什么在 InnoDB 上进行 COUNTing 需要一些时间的原因——这取决于您当时看到的快照状态。

对于您的 DELETE 事务，根据您的查询条件识别的每条记录都被标记为删除。由于其他客户端可能同时访问数据，它不能立即将它们从表中删除，因为它们必须查看各自的快照以保证删除的原子性。

一旦所有记录都被标记为删除，事务就成功提交了。即便如此，它们也不能立即从实际数据页面中删除，在所有其他在您的 DELETE 事务之前使用快照值的事务也结束之前。

所以实际上你的 3 分钟并没有那么慢，考虑到所有记录都必须被修改以便准备以交易安全的方式删除它们。语句运行时，您可能会“听到”您的硬盘在工作。这是由访问所有行引起的。为了提高性能，您可以尝试增加服务器的 InnoDB 缓冲池大小，并尝试在 DELETE 时限制对数据库的其他访问，从而减少 InnoDB 必须为每条记录维护的历史版本数量。借助额外的内存，InnoDB 可能能够（大部分）将您的表读入内存并避免一些磁盘查找时间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T18:15:55.533

试试这个：

```
DELETE a
FROM a
INNER JOIN b
 on a.id = b.id 
```

使用子查询往往比连接慢，因为它们是针对外部查询中的每条记录运行的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-06T03:08:44.047

你这三分钟的时间似乎真的很慢。我的猜测是 id 列没有被正确索引。如果您可以提供您正在使用的确切表定义，那将会很有帮助。

我创建了一个简单的 python 脚本来生成测试数据并针对同一数据集运行多个不同版本的删除查询。这是我的表定义：

```
drop table if exists a;
create table a
 (id bigint unsigned  not null primary key,
  data varchar(255) not null) engine=InnoDB;

drop table if exists b;
create table b like a; 
```

然后我将 100k 行插入到 a 中，将 25k 行插入到 b 中（其中 22.5k 也在 a 中）。这是各种删除命令的结果。顺便说一句，我在运行之间放下并重新填充了表格。

```
mysql> DELETE FROM a WHERE EXISTS (SELECT b.id FROM b WHERE a.id=b.id);
Query OK, 22500 rows affected (1.14 sec)

mysql> DELETE FROM a USING a LEFT JOIN b ON a.id=b.id WHERE b.id IS NOT NULL;
Query OK, 22500 rows affected (0.81 sec)

mysql> DELETE a FROM a INNER JOIN b on a.id=b.id;
Query OK, 22500 rows affected (0.97 sec)

mysql> DELETE QUICK a.* FROM a,b WHERE a.id=b.id;
Query OK, 22500 rows affected (0.81 sec) 
```

所有测试均在配备 Ubuntu 8.10 和 MySQL 5.0 的 Intel Core2 四核 2.5GHz、2GB RAM 上运行。请注意，一条 sql 语句的执行仍然是单线程的。

* * *

更新：

我更新了我的测试以使用 itsmatt 的模式。我通过删除自动增量（我正在生成合成数据）和字符集编码（不起作用 - 没有深入研究它）稍微修改了它。

这是我的新表定义：

```
drop table if exists a;
drop table if exists b;
drop table if exists c;

create table c (id varchar(30) not null primary key) engine=InnoDB;

create table a (
  id bigint(20) unsigned not null primary key,
  c_id varchar(30) not null,
  h int(10) unsigned default null,
  i longtext,
  j bigint(20) not null,
  k bigint(20) default null,
  l varchar(45) not null,
  m int(10) unsigned default null,
  n varchar(20) default null,
  o bigint(20) not null,
  p tinyint(1) not null,
  key l_idx (l),
  key h_idx (h),
  key m_idx (m),
  key c_id_idx (id, c_id),
  key c_id_fk (c_id),
  constraint c_id_fk foreign key (c_id) references c(id)
) engine=InnoDB row_format=dynamic;

create table b like a; 
```

然后，我在 a 中使用 100k 行，在 b 中使用 25k 行重新运行相同的测试（并在运行之间重新填充）。

```
mysql> DELETE FROM a WHERE EXISTS (SELECT b.id FROM b WHERE a.id=b.id);
Query OK, 22500 rows affected (11.90 sec)

mysql> DELETE FROM a USING a LEFT JOIN b ON a.id=b.id WHERE b.id IS NOT NULL;
Query OK, 22500 rows affected (11.48 sec)

mysql> DELETE a FROM a INNER JOIN b on a.id=b.id;
Query OK, 22500 rows affected (12.21 sec)

mysql> DELETE QUICK a.* FROM a,b WHERE a.id=b.id;
Query OK, 22500 rows affected (12.33 sec) 
```

如您所见，这比以前慢了很多，可能是由于多个索引。但是，距离三分钟大关还差得很远。

您可能想要查看的其他内容是将 longtext 字段移动到模式的末尾。我似乎记得，如果所有大小受限的字段都在前，而文本、blob 等在最后，那么 mySQL 的性能会更好。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-07T11:52:57.587

当我必须处理超大数据时，这就是我经常做的事情（这里：一个包含 150000 行的示例测试表）：

```
drop table if exists employees_bak;
create table employees_bak like employees;
insert into employees_bak 
    select * from employees
    where emp_no > 100000;

rename table employees to employees_todelete;
rename table employees_bak to employees;
drop table employees_todelete; 
```

在这种情况下，sql 将 50000 行过滤到备份表中。查询级联在 5 秒内在我的慢速机器上执行。您可以通过自己的过滤查询替换插入到 select 中。

这就是在大型数据库上执行批量删除的技巧！;=)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T18:17:39.380

您正在为“a”中的每一行对“b”进行子查询。

尝试：

```
DELETE FROM a USING a LEFT JOIN b ON a.id = b.id WHERE b.id IS NOT NULL; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-01T19:27:58.993

试试这个：

```
DELETE QUICK A.* FROM A,B WHERE A.ID=B.ID 
```

它比普通查询快得多。

参考语法：[http ://dev.mysql.com/doc/refman/5.0/en/delete.html](http://dev.mysql.com/doc/refman/5.0/en/delete.html)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-10T17:28:45.830

我知道由于 OP 的索引遗漏，这个问题已经得到了很大的解决，但我想提供这个额外的建议，这对于这个问题的更一般的情况是有效的。

我亲自处理过必须从一个表中删除另一个表中存在的许多行的问题，根据我的经验，最好执行以下操作，特别是如果您希望删除很多行。这种技术最重要的是会改善复制从属延迟，因为每个单个 mutator 查询运行的时间越长，延迟就会越差（复制是单线程的）。

所以，这里是：**首先做一个 SELECT，作为一个单独的查询**，记住在你的脚本/应用程序中返回的 ID，然后继续批量删除（比如，一次 50,000 行）。这将实现以下目标：

*   *每个删除语句都不会锁定表太久，从而不会让复制滞后失控*。如果您依靠复制来为您提供相对最新的数据，这一点尤其重要。使用批处理的好处是，如果您发现每个 DELETE 查询仍然需要太长时间，您可以将其调整为更小，而无需触及任何 DB 结构。
*   使用单独的 SELECT 的另一个好处是*SELECT 本身可能需要很长时间才能运行*，特别是如果它由于某种原因不能使用最好的数据库索引。如果 SELECT 在 DELETE 的内部，则当整个语句迁移到从属设备时，它将不得不重新执行 SELECT，可能会落后于从属设备，因为它必须重新执行长选择。奴隶滞后再次受到严重影响。如果您使用单独的 SELECT 查询，这个问题就会消失，因为您传递的只是一个 ID 列表。

让我知道我的逻辑是否有问题。

有关复制延迟的更多讨论以及与此类似的解决方法，请参阅[MySQL Slave Lag (Delay) Explained And 7 Ways To Battle It](http://beerpla.net/2008/09/05/mysql-slave-delay-explained-and-7-ways-to-battle-it/)

PS 当然，要注意的一件事是，在 SELECT 完成和 DELETE 开始之间可能对表进行编辑。我将让您通过使用与您的应用程序相关的事务和/或逻辑来处理这些细节。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T18:20:20.047

```
DELETE FROM a WHERE id IN (SELECT id FROM b) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-06T10:09:44.737

也许你应该在运行这样一个休长的查询之前重建索引。好吧，您应该定期重建它们。

```
REPAIR TABLE a QUICK;
REPAIR TABLE b QUICK; 
```

然后运行上述任何查询（即）

```
DELETE FROM a WHERE id IN (SELECT id FROM b) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-06T10:31:06.183

查询本身已经处于最佳状态，更新索引会导致整个操作花费这么长时间。您可以在操作之前[禁用该](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)表上的键，这应该会加快速度。如果您不立即需要它们，您可以稍后重新打开它们。

另一种方法是`deleted`在您的表中添加一个标志列并调整其他查询，以便他们考虑该值。mysql 中最快的布尔类型是`CHAR(0) NULL`(true = '', false = NULL)。那将是一个快速的操作，您可以在之后删除这些值。

在sql语句中表达了同样的想法：

```
ALTER TABLE a ADD COLUMN deleted CHAR(0) NULL DEFAULT NULL;

-- The following query should be faster than the delete statement:
UPDATE a INNER JOIN b SET a.deleted = '';

-- This is the catch, you need to alter the rest
-- of your queries to take the new column into account:
SELECT * FROM a WHERE deleted IS NULL;

-- You can then issue the following queries in a cronjob
-- to clean up the tables:
DELETE FROM a WHERE deleted IS NOT NULL; 
```

如果这也不是您想要的，您可以查看 mysql 文档对[删除语句速度的](http://dev.mysql.com/doc/refman/5.1/en/delete-speed.html)看法。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-11T21:09:58.903

顺便说一句，在我的博客上发布了上述内容之后，来自 Percona 的[Baron Schwartz](http://www.xaprb.com/)让我注意到他的[maatkit](http://www.maatkit.org/)已经有一个专门用于此目的的工具 - mk-archiver。[http://www.maatkit.org/doc/mk-archiver.html](http://www.maatkit.org/doc/mk-archiver.html)。

它很可能是您完成这项工作的最佳工具。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-06T16:19:19.827

显然，`SELECT`为您的操作奠定基础的查询`DELETE`非常快，所以我认为外键约束或索引是您查询极慢的原因。

尝试

```
SET foreign_key_checks = 0;
/* ... your query ... */
SET foreign_key_checks = 1; 
```

这将禁用对外键的检查。不幸的是，您不能使用 InnoDB 表禁用（至少我不知道如何）键更新。使用 MyISAM 表，您可以执行类似的操作

```
ALTER TABLE a DISABLE KEYS
/* ... your query ... */
ALTER TABLE a ENABLE KEYS 
```

我实际上没有测试这些设置是否会影响查询持续时间。但值得一试。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-03-03T08:37:21.277

使用终端连接数据库并执行下面的命令，查看它们每个的结果时间，您会发现删除10、100、1000、10000、100000条记录的次数没有相乘。

```
 DELETE FROM #{$table_name} WHERE id < 10;
  DELETE FROM #{$table_name} WHERE id < 100;
  DELETE FROM #{$table_name} WHERE id < 1000;
  DELETE FROM #{$table_name} WHERE id < 10000;
  DELETE FROM #{$table_name} WHERE id < 100000; 
```

删除 1 万条记录的时间不是删除 10 万条记录的 10 倍。那么，除了想办法更快地删除记录外，还有一些间接的方法。

1、我们可以将table_name重命名为table_name_bak，然后从table_name_bak中选择记录为table_name。

2、要删除10000条记录，我们可以删除1000条记录10次。有一个示例 ruby​​ 脚本可以做到这一点。

```
#!/usr/bin/env ruby
require 'mysql2'

$client = Mysql2::Client.new(
  :as => :array,
  :host => '10.0.0.250',
  :username => 'mysql',
  :password => '123456',
  :database => 'test'
)

$ids = (1..1000000).to_a
$table_name = "test"

until $ids.empty?
  ids = $ids.shift(1000).join(", ")
  puts "delete =================="
  $client.query("
                DELETE FROM #{$table_name}
                WHERE id IN ( #{ids} )
                ")
end 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2016-12-12T04:28:07.253

MySQL通过id字段删除单表多Row表的基本技巧

`DELETE FROM tbl_name WHERE id <= 100 AND id >=200;` 此查询负责从某个表中删除 100 AND 200 之间的匹配条件

# sql-server - 如何查找导致 SQL Server 探查器跟踪中报告的错误的原因？

> ID：812522
> 
> 赞同：7
> 
> 时间：2009-05-01T18:15:35.440
> 
> 标签：sql-server, sql-server-2005, profiler

我正在使用分析器在 Sql Server 2005 上运行跟踪，需要找出导致报告错误的原因。

我使用了“空白”模板，并选择了以下事件的所有列：

*   例外
*   交易所溢出事件
*   执行警告
*   哈希警告
*   缺少列统计信息
*   缺少连接谓词

我注意到“TextData”列中有许多这样的错误：

*   错误：156，严重性：16，状态：0
*   错误：208，严重性：16，状态：0

我查找了错误（语法不正确，对象名称无效），但我如何知道是什么存储过程或查询导致了它们？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-03T19:12:10.700

不用担心 208 错误。208 是“找不到对象”。由于所谓的“延迟名称解析”，Profiler 会选择这些。

采取以下程序。

```
CREATE PROCEDURE Demo AS
  CREATE TABLE #Temp (ID int)
  INSERT INTO #Temp VALUES (1)
  SELECT ID FROM #Temp
GO 
```

该 proc 可以正常运行而不会出现任何错误，但是，如果您正在运行探查器跟踪，您将看到一两个错误 208 实例。这是因为表 #Temp 在 proc 启动时不存在，即代码被解析和绑定。绑定到底层对象的过程失败。

创建表运行后，其他语句将重新编译并绑定到正确的表并无错误地运行。

您会看到延迟解析错误的唯一地方是探查器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:20:31.817

在 sql 2005 中你不能。您必须运行 SQL:StmtStarting、SQL:StmtCompleted、用户错误消息和异常事件的分析器跟踪，其中包含您需要了解正在发生的事情的 text、transactionId、EventSequence 和 otehr 列。

# emacs - Ido 模式太聪明了，我可以让它不完成文件名吗？

> ID：812524
> 
> 赞同：90
> 
> 时间：2009-05-01T18:15:57.840
> 
> 标签：emacs, ido-mode

我的问题：我启用了 Ido 模式，我想编辑（例如）`.emacs`我的主目录中的一个文件。我那里没有`.emacs`文件，但我有一个.`.emacs.d``C-x C-f .emacs RET`

我已经尝试解决这个问题至少几周了，我有几个解决方法，但我真的不想做任何疯狂的事情。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-05-01T19:10:42.123

您可以按`C-j`以接受到目前为止输入的内容，或者`C-f`将您放入常规查找文件中

# sql - 将 SQL 结果分成范围

> ID：812529
> 
> 赞同：1
> 
> 时间：2009-05-01T18:16:36.747
> 
> 标签：sql, plsql, split, partitioning

我想对按数字索引的成员列表进行简单查询，并将它们分组到相同大小的“桶”中。所以基本查询是：

```
select my_members.member_index from my_members where my_members.active=1; 
```

假设我得到了 1000 个成员索引号，现在我想通过最大和最小成员索引将它们分成 10 个大小相等的组。就像是：

0 到 400 中的活跃成员：100 401 到 577 中的活跃成员：100 ... 1584 到 1765 中的活跃成员：100

我能想到的最好的办法是重复查询 max(my_members.member_index) 并增加 rownum 限制：

```
 for r in 1 .. 10 loop
  select max(my_members.member_index)
  into ranges(r)
  from my_members
   where  my_members.active = 1
   and rownum < top_row
   order by my_members.member_index asc;
   top_row    := top_row + 100;
  end loop; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T05:39:51.330

使用 NTILE 分析函数既简单又快得多：

```
SELECT member_index, NTILE(10) OVER (ORDER BY member_index) FROM my_members; 
```

Oracle 10g 文档：*“NTILE 是一个分析函数。它将有序数据集划分为由 expr 指示的多个存储桶，并为每一行分配适当的存储桶编号。存储桶编号为 1 到 expr。”*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:37:44.570

谢谢您的帮助。花了一段时间才把它全部写成一个声明（出于某些原因，这也是一个目标），所以这就是我想出的看起来对我有用的东西：

```
select max(member_index), ranger
  from (SELECT member_index,
                    CASE
                        WHEN rownum < sized THEN 1
                        WHEN rownum < sized*2 THEN 2
                        WHEN rownum < sized*3 THEN 3
                        WHEN rownum < sized*4 THEN 4
                        WHEN rownum < sized*5 THEN 5
                        WHEN rownum < sized*6 THEN 6
                        WHEN rownum < sized*7 THEN 7
                        WHEN rownum < sized*8 THEN 8
                        WHEN rownum < sized*9 THEN 9
                        ELSE 10
                     END ranger
             from my_members,
                    (select count(*) / 10 sized
                        from my_members
                      where active = 1)
            where active = 1
            order by member_index)
 group by ranger; 
```

给我这样的结果：

```
member_index    ranger
2297683     1
2307055     2
2325667     3
2334819     4
2343982     5
2353325     6
2362247     7
6229146     8
8189767     9
26347329        10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-30T13:45:14.270

NTILE 是要走的路——值得一读分析函数，因为它们可以极大地简化你的 SQL。

对原始代码的小评论 - 在ORDER BY*之前*进行 rownum 限制会产生不利的结果

```
for r in 1 .. 10 loop
   select max(my_members.member_index)
   into ranges(r)
   from my_members
   where  my_members.active = 1
   and rownum < top_row
   order by my_members.member_index asc;
   top_row    := top_row + 100; 
```

结束循环；

尝试以下操作：

```
create table example_nums (numval number)

begin
    for i in 1..100 loop
        insert into example_nums values (i);
   end loop;
end;

SELECT numval FROM example_nums 
WHERE rownum < 5 
ORDER BY numval DESC; 
```

为了得到你期望的结果，你需要做

```
SELECT numval FROM
   (SELECT numval FROM example_nums 
   ORDER BY numval DESC)
WHERE rownum < 5 
```

（注意——在幕后，Oracle 将把它转换为只保留“前 4 项”的有效排序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:47:05.973

查看 SQL 中的 CASE 语句并根据您想要的范围设置一个组字段。

# iphone - 为什么我的 UITableView 没有占据屏幕的边界？

> ID：812532
> 
> 赞同：1
> 
> 时间：2009-05-01T18:16:58.133
> 
> 标签：iphone, objective-c, cocoa-touch

我在这里以编程方式构建一个没有NIB文件的UITableView。然而，我正在做一些愚蠢的事情，因为我的导航栏显示得很好，我的 UITableView 也是如此。但是，UITableView 没有正确适应屏幕。您将看到大约 20 个像素将 UINavigationBar 和 UITableView 分开。我将窗口的 backgroundColor 设置为黑色，如您在此屏幕截图中所见：

![在此处输入图像描述](https://i.stack.imgur.com/wFfQW.png)

这是重现问题的代码：

```
- (void)loadView
{
    [super loadView];
    // TableViews that wish to utilize tableView footers/headers should override this method.

    UITableView *aTableView = [[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame] style:UITableViewStylePlain];
    aTableView.autoresizingMask = (UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight);
    aTableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;

    aTableView.delegate = self;
    aTableView.dataSource = dataSource;

    self.tableView = aTableView;
    [self.view addSubview:self.tableView];
    [aTableView release];

    // style navigation bar.
    //self.navigationController.navigationBar.barStyle = UIBarStyleBlackOpaque;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:19:29.500

使用边界而不是 applicationFrame

# ruby - 如何更改哈希值？

> ID：812541
> 
> 赞同：137
> 
> 时间：2009-05-01T18:17:45.637
> 
> 标签：ruby, syntax, hash

我想`value`用`value.some_method`.

例如，对于给定一个简单的哈希：

```
{"a" => "b", "c" => "d"}` 
```

每个值都应该是`.upcase`d，所以它看起来像：

```
{"a" => "B", "c" => "D"} 
```

我试过了`#collect`，`#map`但总是把数组拿回来。有没有一种优雅的方式来做到这一点？

**更新**

该死的，我忘记了：哈希在一个不应更改的实例变量中。我需要一个具有更改值的新哈希，但不希望显式定义该变量，然后遍历填充它的哈希。就像是：

```
new_hash = hash.magic{ ... } 
```

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2009-05-01T18:20:01.747

```
my_hash.each { |k, v| my_hash[k] = v.upcase } 
```

或者，如果您希望以非破坏性方式进行，并返回一个新的哈希而不是修改`my_hash`：

```
a_new_hash = my_hash.inject({}) { |h, (k, v)| h[k] = v.upcase; h } 
```

最后一个版本还有一个额外的好处，就是您也可以转换密钥。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2017-01-09T03:10:17.443

由于**`ruby 2.4.0`**您可以使用本机[`Hash#transform_values`](https://ruby-doc.org/core-2.4.0/Hash.html#method-i-transform_values)方法：

```
hash = {"a" => "b", "c" => "d"}
new_hash = hash.transform_values(&:upcase)
# => {"a" => "B", "c" => "D"} 
```

还有破坏性的[`Hash#transform_values!`](https://ruby-doc.org/core-2.4.0/Hash.html#method-i-transform_values-21)版本。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2011-09-09T18:25:15.870

您可以收集这些值，然后再次将其从 Array 转换为 Hash。

像这样：

```
config = Hash[ config.collect {|k,v| [k, v.upcase] } ] 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-10-10T01:16:55.873

这将做到：

```
my_hash.each_with_object({}) { |(key, value), hash| hash[key] = value.upcase } 
```

与此相反`inject`的优点是您无需在块内再次返回散列。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-07-15T09:30:54.547

*ActiveSupport* v4.2.0中有一种方法。它被调用[`transform_values`](https://github.com/rails/rails/blob/v4.2.0/activesupport/lib/active_support/core_ext/hash/transform_values.rb)并且基本上只是为每个键值对执行一个块。

因为他们是用 a 来做的，所以`each`我认为没有比循环更好的方法了。

```
hash = {sample: 'gach'}

result = {}
hash.each do |key, value|
  result[key] = do_stuff(value)
end 
```

**更新：**

从 Ruby 2.4.0 开始，您可以本机使用[`#transform_values`](https://ruby-doc.org/core-2.4.0/Hash.html#method-i-transform_values)和[`#transform_values!`](https://ruby-doc.org/core-2.4.0/Hash.html#method-i-transform_values-21).

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-01T18:21:54.940

试试这个功能：

```
h = {"a" => "b", "c" => "d"}
h.each{|i,j| j.upcase!} # now contains {"a" => "B", "c" => "D"}. 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-09-13T11:21:19.073

您可能想更进一步，在嵌套哈希上执行此操作。当然，这种情况在 Rails 项目中相当多。

这里有一些代码可以确保 params 哈希是 UTF-8 格式：

```
 def convert_hash hash
    hash.inject({}) do |h,(k,v)|
      if v.kind_of? String
        h[k] = to_utf8(v) 
      else
        h[k] = convert_hash(v)
      end
      h
    end      
  end    

  # Iconv UTF-8 helper
  # Converts strings into valid UTF-8
  #
  # @param [String] untrusted_string the string to convert to UTF-8
  # @return [String] your string in UTF-8
  def to_utf8 untrusted_string=""
    ic = Iconv.new('UTF-8//IGNORE', 'UTF-8')
    ic.iconv(untrusted_string + ' ')[0..-2]
  end 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T19:10:10.847

我做这样的事情：

> new_hash = Hash[*original_hash.collect{|key,value| [键，值 + 1]}.flatten]

这也为您提供了通过任何表达式转换键或值的工具（当然，它是非破坏性的）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-10T16:39:57.523

Ruby 的`tap`方法（[1.8.7](http://ruby-doc.org/core-1.8.7/Object.html#method-i-tap)、[1.9.3](http://ruby-doc.org/core-1.9.3/Object.html#method-i-tap)和[2.1.0](http://ruby-doc.org/core-2.1.0/Object.html#method-i-tap)）对这类东西非常有用。

```
original_hash = { :a => 'a', :b => 'b' }
original_hash.clone.tap{ |h| h.each{ |k,v| h[k] = v.upcase } }
# => {:a=>"A", :b=>"B"}
original_hash # => {:a=>"a", :b=>"b"} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-24T11:54:27.520

**特定于 Rails**

如果有人只需要对`to_s`每个值调用方法并且不使用 Rails 4.2（包括`transform_values`方法[链接](http://www.justinweiss.com/blog/2014/08/25/the-lesser-known-features-in-rails-4-dot-2/)），您可以执行以下操作：

```
original_hash = { :a => 'a', :b => BigDecimal('23.4') }
#=> {:a=>"a", :b=>#<BigDecimal:5c03a00,'0.234E2',18(18)>}
JSON(original_hash.to_json)
#=> {"a"=>"a", "b"=>"23.4"} 
```

*注意：需要使用“json”库。*

*注意 2：这也会将键转换为字符串*

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-09-18T14:45:13.453

如果您知道这些值是字符串，则可以在循环中调用它们的[replace](http://ruby-doc.org/core-2.2.3/String.html#method-i-replace)方法：这样您将更改值。

Altohugh 这仅限于值是字符串的情况，因此不能完全回答问题，我认为它对某人有用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-12-30T08:33:02.637

```
new_hash = old_hash.merge(old_hash) do |_key, value, _value|
             value.upcase
           end

# old_hash = {"a" => "b", "c" => "d"}
# new_hash = {"a" => "B", "c" => "D"} 
```

# javascript - IE7模态对话框滚动条重叠内容

> ID：812542
> 
> 赞同：3
> 
> 时间：2009-05-01T18:17:46.400
> 
> 标签：javascript, css, internet-explorer-7, scrollbar, modal-dialog

这是有问题的代码。要对其进行测试，请将其保存在名为“test.html”的文件中，然后单击左上角的按钮。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
 <head>
  <title>Blarg</title>
  <style type='text/css'>
    body { margin: 20px; }
    #test { background: red; height: 2000px; }      
  </style>    
 </head>

 <body>
  <div id="test"><input type='button' onclick="javascript:window.showModalDialog('test.html', window, 'dialogWidth: 300px; resizable: yes;');" /></div>  
 </body>
</html> 
```

如果我在普通的 IE7 窗口中打开页面，它工作正常。

但是，如果我在 IE7 模式对话框中打开它，它会在边距顶部绘制垂直滚动条。更糟糕的是，因为它在边距顶部绘制了滚动条，所以也会导致绘制水平滚动条。

我该如何解决这个问题？我绝对必须使用 IE 模式对话框，我无权更改它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-27T09:22:57.930

更改 window.showModalDialog 选项以使用 width: 300px 而不是 dialogWidth: 300px - 水平滚动条消失，垂直滚动条位于边距右侧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:35:46.700

在#test右侧添加20px的边距并增加对话框的宽度：

[http://jsbin.com/ujevu](http://jsbin.com/ujevu)

您仍然会有一个水平滚动条，但至少内容不会被遮挡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-19T23:47:07.637

正如您所提到的，IE 模式对话框不像普通浏览器窗口那样工作。通过尝试各种事情，您可以对它的工作原理进行逆向工程并采取一些补偿技巧。您说您可以控制 HTML，可以使用 Javascript，所以这就是我想出的。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
 <head>
  <title>Blarg 2</title>
  <style type='text/css'>
    body { margin: 20px; width:1px}
    #test { background: red; height: 500px; }          
  </style>

   <script>
     window.onload=windowResized;
     window.onresize=windowResized;

     function windowResized()
     {
       var cw = document.documentElement.clientWidth ;
       var margin = 20 ;
       document.getElementById("test").style.width=(cw-2*margin)+"px" ;
     }
   </script>
 </head>
 <body>
  <div id="test" >
    <input type='button' 
 onclick="javascript:window.showModalDialog('test.html', window, 'dialogWidth: 300px; resizable: yes;');" />
    There is a bit more than meets the eye here.
  </div>  
 </body>
</html> 
```

这段代码的关键是调整`<div>`包含内容的宽度。通常这个宽度是窗口的宽度（减去边距），但在 IE 模式对话框的情况下，我们应该使用窗口的宽度减去滚动条的宽度。这是由 给我们的`document.documentElement.clientWidth`。我们在加载对话框和调整大小时执行此调整大小。

正文的初始宽度（在加载时，但在我们调整大小之前`<div>`）似乎让 IE 感到困惑，所以我们将其设置为`1px`. 所以这是代码中的一个“幻数”，就像`var margin = 20 ;`，它必须匹配 CSS `margin`。我还将 设置`div height`为`500px`以便更容易看到垂直滚动条打开或关闭时会发生什么。

我已经在 Windows XP 上的 IE6/7/8 和 Chrome 以及 Mac 上的 FF3.6 和 Chrome 中对此进行了测试。我已经使这里的代码尽可能简单，所以如果您的内容`div`变得更复杂，希望您能够根据需要修改 Javascript。希望这对你有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T18:18:28.947

您可以通过执行 brianpeiris 建议的操作（为滚动条添加边距）并添加 overflow-x:hidden; 来解决此问题。css 到您的 html 元素。这将隐藏水平滚动条。

IE 似乎真的很奇怪地对待模态窗口，所以大多数正常的想法（javascript 窗口调整大小、css 固定像素宽度）在“IE 模态窗口”中不起作用

--

此外，您可以简单地在 showModalDialog 调用中添加一个标志，以完全删除滚动条，而无需更改任何 html / css。

MSDN 文档 [http://msdn.microsoft.com/en-us/library/ms536759(VS.85).aspx中提供了有关如何执行此操作的文档](http://msdn.microsoft.com/en-us/library/ms536759(VS.85).aspx)

在您的代码中，如果您想删除滚动条，它看起来像这样

```
onclick="javascript:window.showModalDialog('test.html', window, 'dialogWidth: 300px; resizable: yes; scroll:off;');" 
```

# javascript - 在 Javascript 中调整模态窗口的大小

> ID：812549
> 
> 赞同：4
> 
> 时间：2009-05-01T18:19:35.710
> 
> 标签：javascript, dialog, resize, modal-dialog

当某些项目被隐藏/显示时，我正在尝试调整模式对话框窗口的大小。

```
window.resizeTo(800, 600); 
```

我试过使用上面的代码，但它似乎不起作用。我认为因为它是一个模态对话框，而不是一个常规窗口。关于如何调整这个大小的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-07-13T13:33:39.930

如果您尝试从窗口本身调整模态对话框窗口的大小，您可能会想使用 javascript window.resizeTo() 或 window.resizeBy()。

但是，这些都行不通。相反，使用：

```
window.dialogWidth='640px';
window.dialogHeight='480px'; 
```

PS Rsolberg：海报确实说模态对话框窗口。这似乎是我描述它的方式。我不确定这是否可以解释为与 jQuery 相关。为了避免混淆，我会删除 jQuery 答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T18:27:37.563

您需要识别元素或容器 ID 并执行以下操作：

```
document.getElementById('MyModal').style.height = '500px';
document.getElementById('MyModal').style.width = '800px'; 
```

如果您为此使用 jQuery，它可能会更容易一些，因为您可以将它附加到实际的显示模式函数。

**编辑**
在上面的 javascript 函数中，MyModal 将是容器或模式的 ID。例如，如果您使用 DIV 作为模态的外部元素，您可以像这样设置 DIV：

```
<div id='MyModal' class="IFNEEDED">CONTENTS OF MODEL</div> 
```

**编辑#2**
由于这不是今天大多数人所描述的“模态”，它更像是一个新的窗口弹出窗口，这行代码应该适合你（在[这里](http://www.pageresource.com/jscript/jwinopen.htm)找到）：

```
window.open('http://www.pageresource.com/jscript/jex5.htm','mywindow','width=400,height=200') 
```

# linq-to-sql - LinqToSql：多个实体命名空间

> ID：812554
> 
> 赞同：0
> 
> 时间：2009-05-01T18:20:32.883
> 
> 标签：linq-to-sql

有没有人想出一种在单个 dbml 中拥有多个实体命名空间的方法？

我的数据库的不同部分与不同的事物相关，我将它们组织成不同的模式。如果模式将转换为生成的实体上的名称空间，那将很方便。

据我所知，没有办法做到这一点。我想出的最好的方法是拥有多个 dbml，但这对我来说有太多的重复。

Linq to Entity 可以做到这一点吗？如果是这样我会考虑切换。

我不想使用 NHibernate，直到它在 2.1 版中获得真正的 linq 支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-08T13:26:49.453

我没有得到任何答案，所以我会自己回答。

据我所知，没有任何方法可以在单个 linq2sql dbml 文件中拥有多个命名空间。

# svn - 为什么我不想要版本控制中的中央存储库？SVN 与 Git 的问题

> ID：812560
> 
> 赞同：12
> 
> 时间：2009-05-01T18:21:50.243
> 
> 标签：svn, git, version-control

**重复：**

*   [为什么我应该使用 git 而不是 svn？](https://stackoverflow.com/questions/740053/why-should-i-use-git-instead-of-svn)
*   [我应该使用 SVN 还是 Git？](https://stackoverflow.com/questions/161541/svn-vs-git)
*   [为什么 Git 比 Subversion 更好？](https://stackoverflow.com/questions/871/why-is-git-better-than-subversion)

我确定我问错了，但我读到 Git 不像 SVN 那样使用中央存储库。一，我不明白你怎么能有一个分散的版本控制系统。我确信它有效，因为有很多人使用它，但我不明白这个概念。

你怎么能拥有每个人都使用的东西，而不是一个集中的存储库来保存源代码？

我想这也更像是 git 与 svn，你使用哪个？我读到 git 更好，但不像 SVN 那样集成在大多数 IDE 工具中。

我还在学习。

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T18:34:26.470

在我开始使用 Git 之前，这也总是让我感到困惑。人们喜欢过分强调它的不同之处。

事实是，您可以并且很可能将您的 Git 系统设置为拥有一个“主”存储库。Git 的不同之处在于每个“工作目录”也有自己的客户端存储库。Git 的大量设计是用于在客户端存储库和父存储库之间来回合并代码。

If you want to go with a single master repository sitting on a server somewhere, and all users being direct clients of that repository, you can easily do that. What makes Git really different is that you don't *have* to do that. You could instead have a big tree of repositories from worker, to subgroup, to test group, to master if you want. You could instead set up a chain from worker to development master (updated frequently by developers) to remote customer site (updated rarely by the customer when they want a fix, and can get the private network up between them in Ethiopia and you in Toledo). The topology and workflow is up to *you*, not the tool.

我的建议是自己尝试一个小型（或假装）项目的 Git。一旦你看到它是如何工作的，你就会开始看到可能性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T18:32:48.050

DVCS 的重点不是“避免使用中央存储库”。我看到的大多数基于 DVCS 的项目都有一些通用 HEAD 的概念——人们将补丁推送到那个 HEAD，这就是发布的来源。

相反，DVCS 的主要优点是*每个工作副本都允许修订控制*。这具有三个主要优点。

1.  方便。如果我添加了一个新特性，我可以提交它——并且对代码的工作版本有一个很好的记录——既不需要手边的网络，也不需要将我可能损坏的代码推到其他人的手中。
2.  控制并行开发。完全独立，我可以处理一个功能集，并以我们知道的所有方式使用修订控制它可以使开发更好，而其他人可以向相同的代码提交补丁（因此他们可以利用修订控制）而不会干扰我的开发
3.  分支、合并等。DVCS 往往有更好的支持——因为它是分布式系统中的固有思想——用于分支。如果我不喜欢项目负责人所做的事情，那么将项目分支出来对我来说是**微不足道的。**我拉 HEAD，开始提交该 repo，并且可以将该 repo 发送给任何想要我的分支的人。同样，在#2 的上下文中，处理来自不同人的多个补丁集要容易得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T18:33:17.940

老实说，我更喜欢它`git`，`svn`主要是因为它速度快得离谱，而且它给了你更多（危险的）处理提交的能力，并且具有相当不错的合并。

分发它很酷，因为我可以在我的开源项目分支中拥有自己的提交。

github很棒。真的。惊人的。

因此，git 分布式存储库模型的直接优势是您可以将整个存储库保存在本地，这使事情变得非常快。而且你不必担心你的中途提交会为每个人搞砸。（或者，您不必经历在 svn 中分支的痛苦）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:26:31.403

使用分布式版本控制系统，每个工作副本都是一个自己的存储库（和一个自己的分支）。您可以随时将更改同步到其他存储库。使用这种版本控制的项目通常有一个或一些存储库，它们是“主”分支。但是每个人都可以维护一个替代存储库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T18:26:58.097

您仍然可以拥有一个集中式存储库。不同之处在于您在本地计算机上有一个功能齐全的存储库服务器，它允许您完全断开连接工作，同时仍然能够跟踪更改和签入。为了与其他人分享他们需要成为某个地方的中央存储库可以将更改合并到。但是，这不是必需的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T18:27:37.000

拥有分散的存储库意味着您可以提交到不同的地方。

例如，您为 Git 存储库上的应用程序进行开发。所以你所做的基本上是在本地克隆它。这样您就可以在本地提交更改，因此您不需要经常访问主存储库，并且您可以在本地完成更改时将其推送出去。

对于拥有大量用户的大型项目，这是一个很棒的功能。

使用 SVN，您拥有一个主服务器存储库。如果您想要增量提交并且只将它们提交到主要开发，您可以创建一个分支并处理它。但是，您仍然需要连接到远程存储库才能提交更改。

所以 Git 本质上让你拥有自己的本地分支，而无需连接到主存储库服务器。

如果您不需要这种类型的分发，确保每个人的本地存储库都正确同步的额外管理开销可能会变得很麻烦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T18:29:15.577

你经常有一个使用 Git 的代码“祝福”状态的中央存储库。只是您可以设置比使用 SVN 更多的存储库/贡献者布局。

例如，在“主”存储库下，您可以拥有完全独立的特定模块的存储库。因此，模块上的开发人员可以在工作时在他们之间共享更改，并且他们只有在完成开发周期后才会将更改推送到中央模块。

简而言之：SVN 可以做的所有事情，Git 可以，然后是一些。（提供或获取一些细节：例如，Git 没有 svn:externals 或文件锁定。）

我使用 IntelliJ IDEA，它的 Git 支持是一流的。此外，Git 已经内置了相当强大的交互式工具，包括图形和命令行。我发现我使用我的 IDE 更少。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T18:31:43.823

我看到 Git 优于 SVN 的两个主要好处：

1.  没有单点故障。GitHub 今天宕机了，很多人抱怨，但他们可以继续与他们的团队合作，因为每个签出的副本都是一个完整的存储库，可以进行差异、合并等。

2.  消除政治问题。随着组织的发展，内部项目的数量会增加，因此依赖项的数量也会增加。Git 使每个组织单位都可以轻松地“拥有”每个项目的副本，这可以减少创建新版本时的麻烦。这也意味着团队可以启动他们自己的分支，进行改进，然后将分支提供给项目的主要所有者版本——所有这些都无需经历在不同组的系统上获得许可的麻烦。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T18:28:41.680

我使用 Bazaar，所以这可能与 Git 用户给出的答案略有不同，但是：

仅仅因为 VCS 是去中心化的，并不*妨碍*您拥有一个单一的权威分支。所有分支都是平等的，但您仍然需要维护一个“官方主干”来标记发布。例如，尽管它们是 Linux 代码的数千个分支，但 Linus 的分支是作为“官方”版本发布的。

去中心化模型的优点是您不依赖于中央服务器和维护者的持续运营/合作。如果主服务器出现故障，您仍然可以处理完整版本的代码。如果维护者拒绝接受你的补丁，那么简单地维护你自己的分支就没有（技术上的）障碍。

# subsonic - 在哪里可以找到下载 SubStage 的链接？

> ID：812568
> 
> 赞同：0
> 
> 时间：2009-05-01T18:22:26.483
> 
> 标签：subsonic

在哪里可以找到下载 SubSonic SubStage 的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T18:26:51.030

它似乎是 SubSonic 下载的一部分：

[http://subsonicproject.googlecode.com/files/SubSonic_2.1_Final_Source.zip](http://subsonicproject.googlecode.com/files/SubSonic_2.1_Final_Source.zip)

如果没有，您可以从此处的源中提取它：

[http://subsonicproject.googlecode.com/svn/trunk/](http://subsonicproject.googlecode.com/svn/trunk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T04:34:46.360

我知道这个网站，但不要安装它

# php - 如何在 php 中创建友好的 URL？

> ID：812571
> 
> 赞同：73
> 
> 时间：2009-05-01T18:23:01.193
> 
> 标签：php, url, friendly-url

通常，显示某些个人资料页面的做法或非常古老的方式是这样的：

```
www.domain.com/profile.php?u=12345 
```

`u=12345`用户ID在哪里。

近年来，我发现一些网站的网址非常好，例如：

```
www.domain.com/profile/12345 
```

我如何在 PHP 中做到这一点？

就像一个疯狂的猜测，它与`.htaccess`文件有关吗？你能给我更多关于如何编写`.htaccess`文件的提示或一些示例代码吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-01T18:26:07.833

根据[这篇文章](https://web.archive.org/web/20140220075845/http://www.phpriot.com/articles/search-engine-urls)`.htaccess`，您需要一个看起来像这样的 mod_rewrite（放置在文件中）规则：

```
RewriteEngine on
RewriteRule ^/news/([0-9]+)\.html /news.php?news_id=$1 
```

这映射了来自的请求

```
/news.php?news_id=63 
```

至

```
/news/63.html 
```

**另一种可能性是使用`forcetype`**，它强制任何东西沿着特定的路径使用 php 来评估内容。因此，在您的`.htaccess`文件中，输入以下内容：

```
<Files news>
    ForceType application/x-httpd-php
</Files> 
```

然后 index.php 可以根据`$_SERVER['PATH_INFO']`变量采取行动：

```
<?php
    echo $_SERVER['PATH_INFO'];
    // outputs '/63.html'
?> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-01T18:31:04.403

我最近在一个可以很好地满足我的需求的应用程序中使用了以下内容。

.htaccess

```
<IfModule mod_rewrite.c>
# enable rewrite engine
RewriteEngine On

# if requested url does not exist pass it as path info to index.php
RewriteRule ^$ index.php?/ [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) index.php?/$1 [QSA,L]
</IfModule> 
```

索引.php

```
foreach (explode ("/", $_SERVER['REQUEST_URI']) as $part)
{
    // Figure out what you want to do with the URL parts.
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-04-19T05:05:02.913

I try to explain this problem step by step in following example.

**0) Question**

I try to ask you like this :

i want to open page like facebook profile www.facebook.com/kaila.piyush

it get id from url and parse it to profile.php file and return featch data from database and show user to his profile

normally when we develope any website its link look like www.website.com/profile.php?id=username example.com/weblog/index.php?y=2000&m=11&d=23&id=5678

now we update with new style not rewrite we use www.website.com/username or example.com/weblog/2000/11/23/5678 as permalink

```
http://example.com/profile/userid (get a profile by the ID) 
http://example.com/profile/username (get a profile by the username) 
http://example.com/myprofile (get the profile of the currently logged-in user) 
```

**1) .htaccess**

Create a .htaccess file in the root folder or update the existing one :

```
Options +FollowSymLinks
# Turn on the RewriteEngine
RewriteEngine On
#  Rules
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php 
```

What does that do ?

If the request is for a real directory or file (one that exists on the server), index.php isn't served, else every url is redirected to index.php.

**2) index.php**

Now, we want to know what action to trigger, so we need to read the URL :

In index.php :

```
// index.php    

// This is necessary when index.php is not in the root folder, but in some subfolder...
// We compare $requestURL and $scriptName to remove the inappropriate values
$requestURI = explode(‘/’, $_SERVER[‘REQUEST_URI’]);
$scriptName = explode(‘/’,$_SERVER[‘SCRIPT_NAME’]);

for ($i= 0; $i < sizeof($scriptName); $i++)
{
    if ($requestURI[$i] == $scriptName[$i])
    {
        unset($requestURI[$i]);
    }
}

$command = array_values($requestURI);
With the url http://example.com/profile/19837, $command would contain :

$command = array(
    [0] => 'profile',
    [1] => 19837,
    [2] => ,
)
Now, we have to dispatch the URLs. We add this in the index.php :

// index.php

require_once("profile.php"); // We need this file
switch($command[0])
{
    case ‘profile’ :
        // We run the profile function from the profile.php file.
        profile($command([1]);
        break;
    case ‘myprofile’ :
        // We run the myProfile function from the profile.php file.
        myProfile();
        break;
    default:
        // Wrong page ! You could also redirect to your custom 404 page.
        echo "404 Error : wrong page.";
        break;
} 
```

**2) profile.php**

Now in the profile.php file, we should have something like this :

```
// profile.php

function profile($chars)
{
    // We check if $chars is an Integer (ie. an ID) or a String (ie. a potential username)

    if (is_int($chars)) {
        $id = $chars;
        // Do the SQL to get the $user from his ID
        // ........
    } else {
        $username = mysqli_real_escape_string($char);
        // Do the SQL to get the $user from his username
        // ...........
    }

    // Render your view with the $user variable
    // .........
}

function myProfile()
{
    // Get the currently logged-in user ID from the session :
    $id = ....

    // Run the above function :
    profile($id);
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-04-18T11:42:39.283

简单的方法来做到这一点。试试这个代码。将代码放入您的`htaccess`文件中：

```
Options +FollowSymLinks

RewriteEngine on

RewriteRule profile/(.*)/ profile.php?u=$1

RewriteRule profile/(.*) profile.php?u=$1 
```

它将创建这种类型的漂亮 URL：

> [http://www.domain.com/profile/12345/](http://www.domain.com/profile/12345/)

更多 htaccess 漂亮网址：[http ://www.webconfs.com/url-rewriting-tool.php](http://www.webconfs.com/url-rewriting-tool.php)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-01T18:26:50.467

它实际上不是 PHP，它是使用 mod_rewrite 的 apache。发生的情况是该人请求链接 www.example.com/profile/12345 然后 apache 使用重写规则将其切碎，使其看起来像这样 www.example.com/profile.php?u=12345 到服务器。你可以在这里找到更多：[重写指南](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-01T19:55:47.133

There are lots of different ways to do this. One way is to use the RewriteRule techniques mentioned earlier to mask query string values.

One of the ways I really like is if you use the [front controller](http://martinfowler.com/eaaCatalog/frontController.html) pattern, you can also use urls like [http://yoursite.com/index.php/path/to/your/page/here](http://yoursite.com/index.php/path/to/your/page/here) and parse the value of $_SERVER['REQUEST_URI'].

You can easily extract the /path/to/your/page/here bit with the following bit of code:

```
$route = substr($_SERVER['REQUEST_URI'], strlen($_SERVER['SCRIPT_NAME'])); 
```

From there, you can parse it however you please, but for pete's sake make sure you sanitise it ;)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-01T18:32:32.637

ModRewrite 不是唯一的答案。您还可以在 .htaccess 中使用 Options +MultiViews，然后检查`$_SERVER REQUEST_URI`以查找 URL 中的所有内容。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-01T18:28:47.717

看起来您正在谈论 RESTful Web 服务。

[http://en.wikipedia.org/wiki/Representational_State_Transfer](http://en.wikipedia.org/wiki/Representational_State_Transfer)

.htaccess 文件确实重写了所有 URI 以指向一个控制器，但这比您现在想要的更详细。你可能想看看[Recess](http://www.recessframework.org/)

这是一个 RESTful 框架，全部使用 PHP

# c# - 从通过 ActiveSync 连接的 Windows Mobile 手机读取 SMS 消息？

> ID：812575
> 
> 赞同：0
> 
> 时间：2009-05-01T18:24:42.063
> 
> 标签：c#, windows-mobile, mobile, sms

我有一个正在处理的项目，它要求我们的 WPF 应用程序从用户连接的 Windows Mobile 手机中读取 SMS 消息，以便我们可以显示最近的消息等。

我对找到的任何库都没有运气。最有希望的似乎是 OpenNETCF.Desktop.Communications 但最终我似乎无法用它做我需要做的事情。

从已连接的手机上读取 SMS 消息的最佳方式是什么？为充当服务器的手机和作为客户端的 WPF 应用程序编写某种服务应用程序对我来说会更容易吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T19:53:46.793

没有什么开箱即用的东西可以做你想做的事。OpenNETCF 库封装的 RAPI 有一组通信 API，但没有用于 SMS。它确实具有嵌入自定义 API 的能力，因此您可以创建自定义 API 并使用它。这种策略的优点是您不需要任何用户干预即可将内容放到设备上（无需复制和运行服务应用程序内容）。缺点是设备的自定义 RAPI DLL 必须是本机代码。

如果您使用自己的机制，则可以在托管代码中使用 POOM API 来获取消息并发送它们。唯一的挑战是您必须在设备上运行某种形式的“服务”应用程序来监听呼叫，这意味着编写自己的协议，这意味着相当大的测试矩阵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T11:17:16.293

Jeyo 有一款产品可以将手机中的 SMS 消息提取到 Outlook PST 文件中。让我印象深刻的是，您可以使用该产品并在 PST 上搜索最近的消息（我知道有点杂乱无章，但如果您很绝望），或者与他们讨论他们是否会为您许可他们的某些代码？

# excel - 用excel跟踪outlook中的电子邮件

> ID：812576
> 
> 赞同：1
> 
> 时间：2009-05-01T18:24:49.567
> 
> 标签：excel, outlook

如何使用 Excel 跟踪 Outlook 中共享收件箱的进出电子邮件？我们收到大量电子邮件，我们需要跟踪回复以确保电子邮件不会丢失。

有没有办法将结果从高级查找到 Excel 工作表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T12:31:12.980

您在高级查找中设置了什么视图？因为您可以编写一个 VBA 宏来从收件箱中提取项目并将它们放入您的电子表格中。很多高级查找选项不在 Outlook 对象模型中，因此它取决于您尝试设置的视图。那么你能告诉我你在高级查找中在做什么吗..？76梅尔

好的，使用 Outlook 表，您可以将其作为宏放入 Excel
使用“sfilter”定义您的高级搜索条件。
您必须将数据泵入底部的 Excel 中。

```
Sub GetMail()

Dim oApp As Outlook.Application
Dim oFolder  As Outlook.Folder
Dim oNameSpace As Outlook.Namespace
Dim emailCount As Integer
Dim counter As Integer
Dim sfilter As String
Dim oRow As Outlook.Row
Dim oTable As Outlook.Table
Dim i As Outlook.MailItem

Set oApp = CreateObject("Outlook.Application")
Set oNameSpace = oApp.Session
Set oFolder = oNameSpace.GetDefaultFolder(olFolderInbox)

'Add what ever filter you want here using DASL
sfilter = "[LastModificationTime] > '5/1/2005'"
'Restrict with Filter
Set oTable = oFolder.GetTable(sfilter)

'Remove all columns in the default column set
oTable.Columns.RemoveAll
'Specify desired properties

With oTable.Columns

    .Add ("EntryID")
    .Add ("Subject")
    .Add ("ReceivedTime")

End With

'Enumerate the table using test for EndOfTable
'Pump it into your worksheet
Do Until (oTable.EndOfTable)
    Set oRow = oTable.GetNextRow()
    Debug.Print (oRow("EntryID"))
    Debug.Print (oRow("Subject"))
    Debug.Print (oRow("ReceivedTime"))
Loop

'Clean up
Set oTable = Nothing
Set oFolder = Nothing
Set oNameSpace = Nothing
Set oApp = Nothing 
```

结束子

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:34:06.753

也许你应该投资一个像[FogBugz](http://www.fogcreek.com/FogBUGZ/)这样的工具，它可以处理传入的电子邮件、过滤垃圾邮件和跟踪响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:47:53.750

我找到了一个权宜之计；只需突出显示您从高级查找中获得的所有结果，然后是 ctrl + A，然后是 ctrl + C，然后您可以将结果粘贴到 excel (ctrl + V) 中。

我仍然想听听任何其他解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T15:55:27.140

Excel 在这方面做得不好。在我的公司，我们只是将标志用于任何紧急的事情。当有人回复客户时，他们会将原始邮件拖到共享邮箱中的文件夹中。

# ruby - 如何在 Ruby CGI 中使用会话传递数据？

> ID：812587
> 
> 赞同：0
> 
> 时间：2009-05-01T18:27:47.530
> 
> 标签：ruby, session

我正在使用 Ruby 开发一个猜数字游戏，该游戏将上线。我知道我需要以某种方式通过 SESSION 以保持他们猜测的数字，但是我尝试了很多方法都没有运气。我的代码在[这里](http://pastie.org/461976)。

关于我可以做些什么来让这段代码工作的任何想法？我已经宣布了我的每个部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:08:12.827

会话通常是 cookie [（会话 cookie）](http://en.wikipedia.org/wiki/Session_cookie)或附加在 url 上的一些会话 id 的组合，它具有当前“会话”的一些唯一标识以及一种将数据保存在服务器上并在何时检索它的方法给定 cookie 中的 id。

所以我会设置一个基于例如的cookie `ip + Time.now.to_i`，然后将该ID和我想要设置的值保存到硬盘驱动器上的数据库或文本文件中。请注意，创建唯一 ID 可能有很多更好的方法，但首先要针对简单的东西。:)

我还建议您`CGI::Session`使用`require 'cgi/session'`.

# .net - 具有流畅配置的 .NET 日志记录类

> ID：812591
> 
> 赞同：2
> 
> 时间：2009-05-01T18:28:38.403
> 
> 标签：.net, logging, log4net

是否有不依赖 XML 配置文件的 .NET 日志记录类？我认为 log4net 是可能的，但找不到任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-21T09:46:49.547

[Serilog](http://serilog.net)在代码中配置。例如：

```
var log = new LoggerConfiguration()
  .WriteTo.RollingFile("logs\\myapp-{Date}.txt")
  .CreateLogger();

log.Information("Hello, world!"); 
```

# c# - 使用两个线程写入文本框

> ID：812595
> 
> 赞同：2
> 
> 时间：2009-05-01T18:29:13.720
> 
> 标签：c#, .net, multithreading, textbox

我有一些未解决的线程问题。这是我第一次这样做。我知道如何使用一个线程在文本框中写入，但我不知道如何使用其中两个来完成这项工作。任何人都知道我必须做什么才能使用两个线程写入同一个文本框，但不能同时写入。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:55:18.347

这是一个使用两个线程将随机数写入多行文本框的示例。正如 Brandon 和 Jon B 所指出的，您需要使用 Invoke() 来序列化对 GUI 线程的调用。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    Random m_random = new Random((int)DateTime.Now.Ticks);
    ManualResetEvent m_stopThreadsEvent = new ManualResetEvent(false);

    private void buttonStart_Click(object sender, EventArgs e)
    {
        Thread t1 = new Thread(new ThreadStart(ThreadOne));
        Thread t2 = new Thread(new ThreadStart(ThreadTwo));

        t1.Start();
        t2.Start();
    }

    private void ThreadOne()
    {
        for(;;)
        {
            int n = m_random.Next(1000);
            AppendText(String.Format("One: {0}\r\n", n));
            if(m_stopThreadsEvent.WaitOne(n))
            {
                break;
            }
        }
    }

    private void ThreadTwo()
    {
        for(;;)
        {
            int n = m_random.Next(1000);
            AppendText(String.Format("Two: {0}\r\n", n));
            if(m_stopThreadsEvent.WaitOne(n))
            {
                break;
            }
        }
    }

    delegate void AppendTextDelegate(string text);

    private void AppendText(string text)
    {
        if(textBoxLog.InvokeRequired)
        {
            textBoxLog.Invoke(new AppendTextDelegate(this.AppendText), new object[] { text });
        }
        else
        {
            textBoxLog.Text = textBoxLog.Text += text;
        }
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        m_stopThreadsEvent.Set();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:07:09.193

另一种选择是使用线程回调方法。这是一个存在于主线程上的方法，但是当创建一个新线程时，您将一个句柄/引用传递给该方法。这允许第二个线程调用主线程上的方法，并且更新/检查文本框的功能将坐在那里。

查看线程之间的传递委托。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T08:53:39.343

您可以做的一个选择是将消息推送到 Queue 对象上，并使用 Windows 窗体上的计时器从该队列中读取消息并写入文本框。

为了使一切变得更好和线程化，您可以在读取和写入 Queue 对象时锁定它。

例如：

```
 private Queue<string> messages = new Queue<string>();

    /// <summary>
    /// Add Message To The Queue
    /// </summary>
    /// <param name="text"></param>
    public void NewMessage(string text)
    {
        lock (messages)
        {
            messages.Enqueue(text);
        }
    }

    private void tmr_Tick(object sender, EventArgs e)
    {
        if (messages.Count == 0) return;
        lock (messages)
        {
            this.textBox.Text += Environment.NewLine + messages;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:34:47.407

最安全的方法是只有 1 个线程能够在文本框（或任何 gui 对象）上工作，让需要对文本框执行操作的任何其他线程将其需求传达给控制文本框的线程。

所以你的问题变成了如何在线程之间进行通信，这将是特定于语言/操作系统的，所以你需要提供更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:43:37.587

这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms171728.aspx)解释了如何对 Windows 窗体控件进行线程安全调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T19:07:32.257

您只能从主线程访问 GUI 组件。要从另一个线程写入文本框，您需要使用[BeginInvoke()](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke(VS.80).aspx)。

# visual-studio - 使用 Visual Studio 强制引用为绝对引用

> ID：812603
> 
> 赞同：20
> 
> 时间：2009-05-01T18:31:40.690
> 
> 标签：visual-studio, visual-studio-2008

在 VS（本例中为 2008）中添加对 Web 应用程序项目的引用时，正在创建 csproj 文件中的“提示路径”作为相对引用。有没有办法（使用 GUI，而不是手动编辑文件）使其成为绝对引用（即 C:\Temp\DllName.dll）？

我遇到的问题是当单独的构建机器有不同的项目工作目录时。当引用是相对的，并且引用的 dll 不在项目工作目录中时，相对引用可能不会指向两台机器上的相同位置。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T12:15:58.953

这是一个古老的问题，但它仍然是相关的。我在寻找如何从第三方软件的全球存储库中引用程序集的解决方案时偶然发现了它。

我目前的做法类似于 thinkOfaNumber 写的答案。我更喜欢将环境变量嵌入到 .csproj 文件中，而不是使用硬编码的绝对路径。然后环境变量保存绝对路径。例子：

```
<Reference Include="Foo">
  <HintPath>$(THIRDPARTY_ROOT)\foo\3.1.0\bin\foo.dll</HintPath>
</Reference> 
```

这种额外的间接级别提供了在不同构建机器上具有不同路径的灵活性（例如，开发人员系统与构建服务器）。

不过，我仍然需要手动编辑 .csproj 文件来执行此操作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-18T01:18:20.190

我发现这样做的唯一方法是在添加引用后手动编辑 csproj 文件。

```
<Reference Include="foo, Version=1.2.3.4, Culture=neutral, ...">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>C:\absolute\path\foo.dll</HintPath>
</Reference> 
```

是的，我讨厌绝对路径和它创建的所有自动部署的疯狂，但在这种情况下，我必须引用一个.NET 包装器，它使用一个必须“安装”的 COM dll 并对注册表做一些事情等等。所以绝对路径是唯一的方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-05T17:34:59.887

默认情况下，Visual Studio 在最初添加引用时使用相对引用，因为它假定引用是指向工作副本中其他位置的文件。

这曾经让我发疯，但我用三种不同的方式解决了它：

1.  通过将我的源代码保存在我的 D: 驱动器上，这意味着 C: 驱动器上引用的 DLL 不能使用相对路径存储。
2.  通过说服当权者为所有开发人员工作站使用单个图像/脚本。现在它们都一样了，这些文件都在 C: 驱动器上的同一个位置。
3.  通过意识到您可以将文件夹添加到[`AssemblyFolders`注册表项](https://stackoverflow.com/a/238445/1507899)，这意味着您不再需要使用任何类型的路径来引用已知程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:45:23.230

尝试右键单击项目的属性，然后转到参考路径，并在那里添加硬编码路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-08T10:27:44.857

现在，对于名为 PackageReference 的新 Visual Studio 包管理，大多数情况下不需要 Package 文件夹，但此解决方案尚未应用于 ASP.Net，并且每个解决方案的包目录占用每个解决方案的大量磁盘空间在公司的每台开发人员计算机中。

因此，我们决定在每台计算机上为所有解决方案设置一个包目录，并按以下方式进行操作：

1.  每个开发人员在其机器的一个驱动器中创建一个目录。
2.  使用以下注册表代码将虚拟驱动程序号指向该位置：

像这样：

```
REGEDIT4  
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\DOS Devices]
"Z:"="\\??\\D:\\PakcageSpace" 
```

（当然可以用cmd中的subset命令来完成，但是重启后不会持久化和删除。如果不够清楚，我在这里描述： [Cannot subst local drive as administrator](https://stackoverflow.com/questions/30586011/cannot-subst-local-drives-as-administrator/69880818#69880818)）

3.  在 %Appdata%\NuGet\NuGet.Config 中编辑 NuGet.Config 并在*配置*区域中添加选项

像这样：

```
<config>
    <add key="repositoryPath" value="Z:\NuGet" />
</config> 
```

4.  关闭并重新打开所有解决方案
5.  在 nuget 控制台中为每个解决方案重新安装所有软件包：Update-Packages -Reinstall

所以现在 .csproj 中的所有包路径都更改为新的绝对路径，并且对于所有开发人员机器都是一致的

6.  将更改推送到源代码控制

*注意：如果您不使用单独的驱动器号来执行此操作，则 NuGet 行为在每台机器中可能会有所不同，因为它更喜欢使用相对路径的设置。例如，假设两个不同的开发人员在他们的机器上使用相同的解决方案，并且两台机器上的*repositoryPath*都设置为*C:\PackageSpace*

现在，如果 Dev#1 将工作区放置在 C:\Workspace\CompanyCRM 并且 Dev#2 将工作区放置在 D:\Workspace\CompanyCRM

在 .csproj 文件 HintPath 中的 Update-Package 之后，NuGet 为包生成的路径将是这样的：

开发#1：

```
..\..\..\PackageSpace\packages\EntityFramework 
```

开发#2：

```
C:\PackageSpace\packages\EntityFramework 
```

现在每次拉取项目时，Visual Studio 都找不到路径，恢复到新路径，更改 .csproj 中的路径，并且由于 .csproj 文件的更改，他们总是在推拉中发生冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-04T16:01:28.410

我们也遇到了这个问题。我们想使用绝对路径，因为每个部署都在不同的位置创建了 Packages 文件夹（而且我们也有多个构建机器）。想法是将 NuGet 包放在一个地方，这样可以释放浪费的内存，避免拥有同一事物的多个副本。

*我们的具体问题是我们可以在 NuGet.Config 文件中设置绝对路径，NuGet 包会在部署期间恢复到该位置，但在同一部署*的 MSBuild 步骤中无法找到它们。

 *我写了一个 PowerShell 脚本来解决这个问题。它基本上用我想要使用的绝对路径替换了相对的 HintPath 引用。

```
#Get list of all csproj files in a solution
$dir = Get-ChildItem $pwd -Recurse
$list = $dir | Where {$_.extension -eq ".csproj"}

#Replace relative paths with absolute path
$absolutePath = 'C:\absolute\path\Packages'
function replaceRelativePath($line){
    if($line -match '<HintPath>[^C].+\\Packages')
    {
        $relative = $matches[0] -replace '\\','\\'
        return ($line -replace "$relative", "<HintPath>$absolutePath")
    }
    else
    {
        return $line
    }
}

#Updating files
Foreach($file in $List)
{
    (Get-Content $file.FullName)| ForEach-Object{replaceRelativePath($_)} | Set-Content $file.FullName
} 
```

我们将此脚本设置为在部署中的 MSBuild 步骤之前作为 PowerShell 构建步骤运行。结果是生成机器上的工作目录的 csproj 文件被更改，但在 Visual Studio 源代码管理中没有。（如果您希望他们更改源代码控制，您可以在 PowerShell 中运行它并检查更改。）

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-01T18:41:08.217

我想帮忙，但为什么有必要这样做？自从 vs.net beta 2003 以来，我从来没有这样做过。我认为这里还有另一个更深层次的问题。

如果必须，可以尝试项目属性中的参考路径页面

# tfs - 将工作项从一个项目移动到另一个项目的最简单方法是什么？

> ID：812619
> 
> 赞同：1
> 
> 时间：2009-05-01T18:33:54.960
> 
> 标签：tfs

将源代码控制文件移动到另一个项目很容易，但是将工作项（带有历史记录）移动到另一个 TeamSystem 项目的最佳方法是什么？

我有许多项目，我实际上希望将它们整合到一个 TeamSystem 项目中，这样我们就有了一个中央 Sharepoint 门户，并使报告变得更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T18:49:31.957

呃，我使用了excel，但失去了历史。我找到这个链接后

[http://blogs.msdn.com/granth/archive/2008/06/26/how-to-move-work-items-between-team-projects.aspx](http://blogs.msdn.com/granth/archive/2008/06/26/how-to-move-work-items-between-team-projects.aspx)

祝你好运

# sql - 如何重新排序sql数据库中的行

> ID：812630
> 
> 赞同：49
> 
> 时间：2009-05-01T18:34:54.177
> 
> 标签：sql

是否可以重新排序 SQL 数据库中的行？例如; 如何交换第二行和第三行值的顺序？

行的顺序对我来说很重要，因为我需要根据顺序显示值。

* * *

感谢所有的答案。但是“订购”对我不起作用。

例如，我在数据库中放置了一个书签列表。我想根据从查询中获得的结果进行显示。（不按字母顺序）。就在它们被插入时。

但是用户可以重新安排书签的位置（以他/她想要的任何方式）。所以我不能使用'order by'。

一个例子是书签如何在 Firefox 的书签中显示。用户可以轻松切换位置。我怎么能在数据库中提到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-01T19:30:45.913

It sounds like you need another column like "ListOrder". So your table might look like:

```
BookMark ListOrder
======== =========
  d        1
  g        2
  b        3
  f        4
  a        5 
```

Then you can "order by" ListOrder.

```
Select * from MyTable Order By ListOrder 
```

If the user can only move a bookmark one place at a time, you can use integers as the ListOrder, and swap them. For example, if the user wants to move "f" up one row:

```
Update MyTable
    Set ListOrder=ListOrder+1
        Where ListOrder=(Select ListOrder-1 From MyTable where BookMark='f')

Update MyTable
    Set ListOrder=ListOrder-1
        Where BookMark='f' 
```

If the user can move a bookmark up or down many rows at once, then you need to reorder a segment. For example, if the user wants to move "f" to the top of the list, you need to:

```
update MyTable
    Set ListOrder=ListOrder+1
        where ListOrder>=1 -- The New position
            and ListOrder <(Select ListOrder from MyTable where BookMark='f')

 update MyTable
     Set ListOrder=1 -- The New Position
         Where Bookmark='f' 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-01T18:52:51.573

As others have mentioned, it's not a good idea to depend on the physical order of the database table. Relational tables are conceptually more like unordered sets than ordered lists. Assuming a certain physical order may lead to unpredictable results.

Sounds like what you need is a separate column that stores the user's preferred sort order. But you'll still need to do something in your query to display the results in that order.

It is possible to specify the physical order of records in a database by creating a clustered index, but that is not something you'd want to do on an arbitrary user-specified basis. And it may still lead to unexpected results.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T18:37:06.060

`ORDER BY`在您的`SELECT`查询中使用。例如，要按用户的姓氏排序，请使用：

```
SELECT * FROM User ORDER BY LastName 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-01T18:52:45.710

Databases can store the data in any way they want. Using the "order by" clause is the **only** way to guarantee an ordering of the data. In your bookmark example, you could have an integer field that indicates the ordering, and then update that field as a user moves things around. Then ORDER BY that column to get things in the right order.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-01T18:38:29.813

实际数据库上的行顺序无关紧要。

您应该[`ORDER BY`](http://www.w3schools.com/sql/sql_orderby.asp)在查询中使用该子句根据需要对它们进行排序。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-08T14:38:00.270

我有一个我用过几次的解决方案。我在表中保留了一个额外的字段“sort_order”，并在重新排序时更新它。当我有某种带有物品的容器时，我会使用它，并且物品的顺序应该在容器内是可编辑的。重新排序时，我只更新当前容器中项目的 sort_order，这意味着不必更新很多（通常实际上只有少数）行。

简而言之，我执行以下操作：

1.  将 sort_order 字段添加到 items 表
2.  插入新行时，我设置 sort_order=id
3.  重新排序时（需要移动的项目 ID，以及要插入的项目 ID）：
    *   select id, sort_order from items where container = ID order by sort_order
    *   从两个数组中的行中拆分 id 和 sort_order
    *   从 id-list 中删除要移动的项目的 id
    *   将要移动的项目的 id 插入到要插入的项目的 id 之后
    *   将 id 列表和 sort_order 列表合并为一个二维数组，如`[[id, sort_order], [id2, sort_order], ...]`
    *   `update item set sort_order=SORT_ORDER where id=ID`使用合并列表运行（executemany）

（如果将项目移动到另一个容器，则在更新“容器外键”后根据应用程序首先或最后移动。）

（如果更新涉及到大量项目，我认为这种解决方案不是一个好方法。）

我在[http://wannapy.blogspot.com/2010/11/reorder-rows-in-sql-database.html](http://wannapy.blogspot.com/2010/11/reorder-rows-in-sql-database.html)上使用 python 和 mysql 做了一个示例（复制并尝试）以及一些额外的解释。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-18T14:57:41.277

Add a `position` column to your table and store as a simple integer.

If you need to support multiple users or lists, your best bet is to create a bookmarks table, an users table and a table to link them.

*   bookmarks: `id,url`
*   users: `id,name`
*   users_bookmarks: `user_id, bookmark_id, position, date_created`

Assuming `date_created` is populated when inserting rows you can get secondary list ordering based on date.

```
select bookmark_id from users_bookmarks where user_id = 1 order by position, date_created; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T21:54:44.820

首先，让我同意这里的每个人的观点，表中的顺序应该无关紧要。使用您更新并包含 Order By 子句的单独 [SortOrder] 列。

也就是说，SQL Server 数据库确实允许在表上使用单个“聚集索引”，这实际上会强制在基础表存储中的位置。如果你有一个大数据集并且总是通过特定的东西查询，这主要是有用的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-01T18:38:31.517

我想一个简单的`order by`会是你在找什么？

```
select my_column from my_table order by my_order_column; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-01T18:42:17.653

正如其他人所说，使用 order by。
永远不要依赖物理表中存在的订单数据，始终以您正在使用的数据为基础，无论是一个或多个关键字段。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-07-11T01:18:08.790

在这种时候，我想起了 Matrix 的一句话：“不要尝试对数据库进行排序。那是不可能的。相反，只有意识到真相......没有顺序。然后你会看到它是一张表自己点菜，是你自己点菜。”

通过 GUI 使用 MySQL 时，总是需要做出决定。如果你运行类似的东西`SELECT * FROM users`，MySql 总是会决定按某个字段排序。通常，这将是主键。

```
+----------------
| id | name     |
-----------------
| 1  | Brian    |
| 2  | Carl     |
| 3  | Albert   |
----------------- 
```

当您向查询添加`ORDER BY`命令时，它将决定按其他字段排序。

例如`Select * From users ORDER BY name`会产生：

```
+----------------
| id | name     |
-----------------
| 3  | Albert   |
| 1  | Brian    |
| 2  | Carl     |
----------------- 
```

因此，对于您的问题，您似乎想要更改表格显示此信息的默认顺序。为此，请检查您的主键字段是什么。对于大多数实际目的，拥有一个唯一的识别自然数往往可以解决问题。MySQL 对此有一个[AUTO_INCREMENT](https://dev.mysql.com/doc/refman/8.0/en/example-auto-increment.html)函数。创建表时，它看起来像`field_name int NOT NULL AUTO_INCREMENT`.

所有这一切都是说：如果您想更改“行顺序”，则需要更新此值。但是，由于标识符是其他表用来引用您的字段的东西，这似乎有点鲁莽。

例如，如果你 go: `UPDATE table Set id = 1 where id = 2;`，这最初会失败，因为 id 字段最终会成为相同的值并且无法通过 PrimaryKey 检查（坚持唯一性和设置值）。您可以通过连续运行三个更新语句来解决这个问题：

```
UPDATE users Set id = 100000000 where id = 1;
UPDATE users Set id = 1 where id = 2;
UPDATE users Set id = 2 where id = 100000000; 
```

这将导致该表的行如下所示：

```
+----------------
| id | name     |
-----------------
| 1  | Carl     |
| 2  | Brian    |
| 3  | Albert   |
----------------+ 
```

从技术上讲，这可以重新排序该表，但这是一个泡沫。MySQL 是一个关系数据库，这意味着任何依赖该数据来保持一致的表现在都将指向错误的数据。例如，我有一个存储生日的表，引用初始用户表。它的结构可能如下所示：

```
+----------------------------+
| id | user_id  | birthdate  |
+----------------------------+
| 1  | 1        | 1993-01-01 |
| 1  | 2        | 1980-02-03 |
| 1  | 3        | 1955-01-01 |
+----------------------------+ 
```

通过切换用户表上的 ID，您必须更新生日表上的 user_id 值。MySQL当然为此做好了准备：输入“[外键约束](https://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html)”。只要您将所有外键约束配置为级联更新，您就不需要手动更改对您更改的每个值的引用。

这些查询都是大量的手动工作，并且可能会削弱数据的完整性。如果您有想要定期排名和重新排序的字段，[Mike Lewis 用“表格顺序”就这个问题提出的答案](https://stackoverflow.com/a/812889/6495889)将是一个更明智的答案（如果是这样的话，那么他是最好的解决方案，而且只是忽略这个答案）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-01T19:20:17.703

In response to [your post here](https://stackoverflow.com/questions/812630/how-can-i-reorder-rows-in-sql-database/812684#812684), the answer you may be looking for is:

To order chronologically, add a `DateAdded` or similar column with a `datetime` or `smalldatetime` datatype.

On all methods that insert into the database, make sure you insert `CURRENT_TIMESTAMP` in the `DateAdded` column.

On methods that query the database, add `ORDER BY DateAdded` at the end of the query string.

NEVER rely on the physical position in the database system. It *may* work MOST of the time but definitely not ALL of the time.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-01T22:04:32.970

这个问题缺少任何可以让任何人给你正确答案的细节。显然，您可以将记录读入内存然后更新它们。但这在许多不同的层面上都是不好的。

问题是这样的。根据实际实现的模式，记录物理写入磁盘的方式是有逻辑的。有时它们是按插入顺序写入的，有时它们是在块之间插入空格（参见范围）。

因此，如果不交换列数据，就不可能更改物理顺序；这对各种指数都有很深的影响。你不得不改变逻辑顺序。

当我阅读您的更新时......我只知道您可能有多个用户，每个用户都有他们想要订购的书签。看起来您需要第二个表作为用户和书签之间的交集。那么你所需要的只是一个内部连接和一个 order by。

但是没有足够的信息来提供完整的解决方案。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-07-10T23:17:14.337

这是一个在 MySQL 中递增或递减（一次一个）的存储过程脚本。

请注意，MySQL 不允许您在要更新的同一查询中进行选择，因此上述答案不起作用。

如果您分别递增/递减，我还将它设置为在上方/下方没有项目时返回错误。

```
DELIMITER $$
CREATE PROCEDURE `spReorderSequenceItems` (
  IN _SequenceItemId INT,
  IN _SequenceId INT,
  IN IncrementUp TINYINT,
  OUT Error VARCHAR(255)
)

BEGIN
  DECLARE CurrentPosition INT;

  SELECT Position INTO CurrentPosition
  FROM tblSequenceItems
  WHERE SequenceItemId = _SequenceItemId;

  IF IncrementUp = 1 THEN
    IF (
      SELECT Position
      FROM tblSequenceItems 
      WHERE Position = CurrentPosition + 1 AND SequenceId = _SequenceId
    ) THEN
      UPDATE tblSequenceItems
        SET Position = Position - 1
        WHERE Position = CurrentPosition + 1 AND SequenceId = _SequenceId;
      UPDATE tblSequenceItems
        SET Position = Position + 1
        WHERE SequenceItemId = _SequenceItemId;
    ELSE 
      SELECT 'No Item Above' AS _Error INTO Error;
    END IF;
  ELSE
    IF (
      SELECT Position
      FROM tblSequenceItems 
      WHERE Position = CurrentPosition - 1 AND SequenceId = _SequenceId
    ) THEN
      UPDATE tblSequenceItems
        SET Position = Position + 1
        WHERE Position = CurrentPosition - 1 AND SequenceId = _SequenceId;
      UPDATE tblSequenceItems
        SET Position = Position - 1
        WHERE SequenceItemId = _SequenceItemId;
    ELSE
      SELECT 'No Item Below' AS _Error INTO Error;
    END IF;
  END IF;
END
$$
DELIMITER ; 
```

调用它

```
CALL spReorderSequenceItems(1, 1, 1, @Error);
SELECT @Error; 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-11-04T16:57:13.480

聚会有点晚了，但任何人仍在寻找这个问题的答案，你需要使用 Stern-Brocot 技术。

[这是一篇解释其背后理论的文章](https://begriffs.com/posts/2018-03-20-user-defined-order.html#approach-3-true-fractions)

对于每个项目，您需要存储一个分子和分母。然后，您还可以添加一个计算列，它是两者的除法。每次您在两个其他项目之间移动一个项目时，该项目的分子成为两个相邻分子的总和，该项目的分母成为两个相邻分母的总和。

这些数字不会像使用“平均”方法那样快速飙升，在 17 次交换后您会失去所有准确性。

我还创建了一个实现该方法[的演示。](https://github.com/PieterjanDeClippel/DragDropOrderingDatabase)

# sql - 在 SQL 中存储一天中的时间

> ID：812631
> 
> 赞同：7
> 
> 时间：2009-05-01T18:35:05.563
> 
> 标签：sql, sql-server, sql-server-2005, time, types

您将如何在 SQL 中存储时间或时间范围？它不会是日期时间，因为它只是假设下午 4:30（不是 1 月 3 日下午 4:30）。这些将是每周或每天的会议。我需要的查询类型当然是用于显示，但稍后也会包括复杂的查询，例如避免日程安排冲突。我现在宁愿为此选择最好的数据类型。

我正在使用 MS SQL Server Express 2005。

谢谢！

弥敦道

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T19:05:50.450

Personally I would find this a reason to upgrade to 2008 which has a separate time datatype.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T18:37:44.573

我建议仍然使用 DateTime 数据类型并忽略日期值——最好使用 SQL 的静态 MinDate（谷歌它）。这将为您提供使用强类型字段的好处，并且唯一的成本将是一些额外的字节。

至于范围，将它们存储在两个单独的列中。然后你可以从另一个中减去一个来确定差异。

编辑：做了一些谷歌搜索。

*   SQL Server 2008 添加了 Time 数据类型，因此您可能需要考虑这一点。
*   您可以使用 SQL 2005 的 DateTime 类型并将其与 CONVERT 函数结合以仅提取 HH:MM:SS.MMM
    *   SELECT CONVERT(VARCHAR(12), GETDATE(), 114) AS [HH:MI:SS(24H)] （[在这个方便的花花公子页面上找到](http://www.sql-server-helper.com/tips/date-formats.aspx)）
*   不同的 SQL 版本支持不同的最小日期。您可以使用所有人都支持的静态日期，例如 2000 年 1 月 1 日，或者您可以使用 SQL 2005 的最小值 1/1/1753 并将时间值附加到该开始日期

因此，如果您坚持使用 2005 年，请选择您的静态日期，例如 2000 年 1 月 1 日，并将您的时间存储在上面。所以 1m:30s 将是 2000-1-1 00:01:30.000，而 1h:15m 将是 2000-1-1 01:15:00.000

然后您可以执行 Date2 - Date1 并获得 (1h:15:m - 1m:30s) 2000-01-01 01:13:45.000 的结果。转换它，你会得到 1:13:45。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:38:49.783

您可以根据需要将其存储为 24 小时时间和格式的 int。

或者将其存储为具有某个固定日期的日期时间，并根据需要将其删除以进行显示：2000 年 1 月 1 日下午 4:30

我会使用 datetime 字段，因为它为您提供了所有与 datetime 相关的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T18:43:35.670

您可能需要考虑将其存储为表示自午夜以来的分钟数的 int 列。在您的实体中，您可以将其公开为代表同一事物的 TimeSpan（或 int）。您只需要在显示值（时间格式）和数据库值（分钟）之间进行转换即可执行查询，这可以在您的实体中轻松完成（例如 TimeSpan.TotalMinutes）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T19:13:49.083

对我来说，这听起来像是您正在开发一种会议安排程序或用于显示会议的东西。

我认为我会将它设置为 2 列 MeetingStart 和 MeetingEnd，两者都作为日期时间字段。这样，您可以确定会议的时长，并且由于您已经有了日期，您可以轻松地使用它在日历或其他东西上显示它。

# haskell - Haskell 解析工具 - yacc:lex :: happy:?

> ID：812632
> 
> 赞同：11
> 
> 时间：2009-05-01T18:35:34.750
> 
> 标签：haskell, yacc, parsing, lex

[因此， Happy](http://www.haskell.org/happy)似乎是 Haskell 中 yacc 的强大替代品。是否有一个同样强大的词法分析器生成器来代替 lex/flex？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T18:42:34.983

亚历克斯？[http://www.haskell.org/alex/](http://www.haskell.org/alex/)

> 在 Haskell 中生成词法分析器的工具，以正则表达式的形式给出要识别的标记的描述。它类似于用于 C/C++ 的工具 lex 或 flex...
> 
> Alex 是[Haskell Platform](http://www.haskell.org/haskellwiki/Haskell_Platform)的一部分，因此如果您安装该平台，您将自动拥有一个正常工作的 Alex。
> 
> Alex 也在 Hackage 上。如果你有[cabal-install](http://hackage.haskell.org/trac/hackage/wiki/CabalInstall)工具（它也随 Haskell 平台一起提供），那么你可以构建和安装最新版本的 Alex
> 
> ```
>  cabal install alex 
> ```
> 
> 要了解 Alex 的最新版本，并单独下载源代码，请访问 Alex 的[HackageDB 页面](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/alex)。
> 
> 亚历克斯也可能为您的操作系统预先打包...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-02T03:24:02.437

快乐 : Yacc :: Alex : Lex

或者使用一个庞大的解析器和词法分析器组合库之一。

# c# - C# 正则表达式单词匹配提取器

> ID：812635
> 
> 赞同：0
> 
> 时间：2009-05-01T18:36:28.103
> 
> 标签：c#, regex

好的，我有一个域列表

例如

```
dogstoday . com
catstoday . com
petstoday . com
dogsnow . org
dogsabc . net
catlitter . info 
```

我想要一个正则表达式，它会给我所有包含我指定的单词的域，例如狗或猫

如果我给狗它应该返回

```
dogstoday.com
dogsnow.org
dogsabc.net 
```

谁能告诉我如何在 c# 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T18:40:40.013

如果域总是以您在示例中提供的单词开头，您可以使用，`StartsWith`否则您可以简单地使用`Contains`. 对于这样简单的事情，您不需要正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:38:45.273

这需要用正则表达式完成吗？为什么不直接遍历所有域并检查它们是否包含您要查找的单词？

[String.Contains()](http://www.java2s.com/Tutorial/CSharp/0100__String/StringContainsastring.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T18:39:18.317

正则表达式是

/狗/我

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T20:23:36.333

像其他人一样，我认为[grep](http://gnuwin32.sourceforge.net/packages/grep.htm)会更好，但类似...

```
Regex.Match( yourBigString, @".*dogs*.*[.com|.net|.org]" ); 
```

您应该小心该域，因为您可能会得到一些像 .au 或 .jp 或其他的网站，但这会得到包含狗的任何内容，然后是 .com 或 .net 或 .org。您可以将“狗”替换为您要查找的任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:39:13.043

```
string line;
System.Text.RegularExpressions.Regex r = new System.Text.RegularExpressions.Regex("dogs", System.Text.RegularExpressions.RegexOptions.IgnoreCase);
using (System.IO.StreamReader reader = System.IO.File.OpenText("domains.txt"))
{
    while ((line = reader.ReadLine()) != null)
    {
        if (r.IsMatch(line))
        {
            Console.WriteLine(domain);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T18:40:37.797

看起来你只需要使用[StartsWith](http://msdn.microsoft.com/en-us/library/system.string.startswith(VS.80).aspx)方法。

# php - 我的 PHP 脚本中是否存在任何会话安全漏洞？

> ID：812639
> 
> 赞同：1
> 
> 时间：2009-05-01T18:37:09.303
> 
> 标签：php, security, url, session, authorization

在我验证用户登录信息后，我为他们创建了这个会话：

```
 $_SESSION['username']= $userName; 
```

然后，我像这样重定向它们：

```
header('Location:www.domain.com/profile/' . $_SESSION['username']; 
```

我希望我的网站有一个美容网址，例如：`www.domain.com/profile/userName`

因此，在我所有的重定向链接（HTML`<a>`标记或 PHP`header()`函数）中，我将使用：

```
"www.domain.com/album/" . $_SESSION['username']; 
```

是否存在安全漏洞？

### 编辑：

我需要先使用创建会话 ID`session_id()`吗？

所以，要检查：

```
if(!isset($_SESSION['id']){
   //redirect to login page
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:02:52.847

Normally while using Sessions we also need to be aware of -:

> **Session Hijacking , Session Fixation**

I suggest in your code after user logged in store the username in session variable also store one more unique value such as USER AGENT in a session variable. so that every page the user visit we can check for whether the same USER AGENT and SESSION ID exist this would make it much secure. To make it much more secure do the encryption like MD% on User AGENT so that hackers cant reproduce it.

> Quoted from PHP SECURITY GUIDE

```
<?php

session_start();

if (isset($_SESSION['HTTP_USER_AGENT']))
{
    if ($_SESSION['HTTP_USER_AGENT'] != md5($_SERVER['HTTP_USER_AGENT']))
    {
        /* Prompt for password */
        exit;
    }
}
else
{
    $_SESSION['HTTP_USER_AGENT'] = md5($_SERVER['HTTP_USER_AGENT']);
}

?> 
```

Refer :
[PHP Security Guide on Session](http://phpsec.org/projects/guide/4.html)
[Another Thread on Session security](https://stackoverflow.com/questions/328/php-session-security)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:01:02.007

You need authorization on the page that allows user to edit their profile. If they'll be editing on the `http://www.domain.com/profile/[username]` page then you need to check if their `$_SESSION['username']` is equal to the profile page they are on.

Otherwise anyone would be able to type in the URL (basically guess a profile number or name) and edit it.

But yes, you should first check if they've logged in AT ALL:

```
if (IsSet($_SESSION['username'])) {
// Logged in
} else {
// Not logged in
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T18:43:37.230

**你在保护什么？你在做什么来验证他们是否有授权？**您是否正在保护他们的个人资料并验证他们是否因为他们拥有会话密钥而获得授权？*你从来没有提到检查他们是否有一个会话变量*。

您甚至不需要知道会话 ID。这对于存储用户是否已获得身份验证无关紧要，这只是指示他们应该使用哪些会话信息的机制。

当用户登录时，您想要存储类似

```
$_SESSION['authed_user'] = true; 
```

然后，在您随后尝试编辑信息时：

```
if ($_SESSION['authed_user']) {
  // do something authed users can do
} 
```

当然，您可能真的需要某种级别的授权。我建议您考虑使用类似[SimpleAuth](http://simpleauth.munk.me.uk/) ...

# xml - 是否可以重新定义定义为 xsd:element 的东西？

> ID：812643
> 
> 赞同：1
> 
> 时间：2009-05-01T18:38:22.437
> 
> 标签：xml, xsd

我需要在 XSD 架构中扩展一个元素。在原始模式中，元素定义为：

```
 <xsd:element name="RemarkText">
      <xsd:complexType>
         <xsd:simpleContent>
            <xsd:extension base="C-Infinite">
               <xsd:attribute name="IdRef" type="IDREF" use="required"/>
            </xsd:extension>
         </xsd:simpleContent>
      </xsd:complexType>
   </xsd:element> 
```

我看到的所有关于扩展的例子似乎都处理扩展类型。如果这最初定义为：

```
 <xsd:complexType name="RemarkText_Type">
         <xsd:simpleContent>
            <xsd:extension base="C-Infinite">
               <xsd:attribute name="IdRef" type="IDREF" use="required"/>
            </xsd:extension>
         </xsd:simpleContent>
      </xsd:complexType>
      <xsd:element name="RemarkText" type="RemarkText_Type"/> 
```

然后，我想我会知道该怎么做。

但是是否可以扩展元素而不是类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T20:52:57.267

*redefine*标记只能与*group*、*attributeGroup*、*complexType*和*simpleType*一起使用。它不可能在*元素*上使用它。

也不可能扩展或限制*元素*。您可以扩展或限制它所基于的*complexType 。*然后，您可以在不修改原始元素定义的情况下使用新类型，方法是在 xml 中添加 **xs:type** *属性*以指示正在使用的类型*complexType*。

[![替代文字](https://i.stack.imgur.com/bQEqn.png)](https://i.stack.imgur.com/bQEqn.png)
[（来源：[liquid-technologies.com](http://www.liquid-technologies.com/images/blogs/stackoverflow/redefine.png)）]

```
<?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML Studio - Developer Pro Edition 7.1.1.1206 (http://www.liquid-technologies.com)-->
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:complexType name="NameType">
    <xs:sequence>
      <xs:element name="FirstName" type="xs:string" />
      <xs:element name="Surname" type="xs:string" />
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="NameExType">
    <xs:complexContent mixed="false">
      <xs:extension base="NameType">
        <xs:sequence>
          <xs:element name="MiddleName" type="xs:string" />
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:element name="MyName" type="NameType" />
</xs:schema> 
```

但是，如果要使用扩展的 NameExType，则 XML 需要使用 xsi:type="NameExType"。

```
<?xml version="1.0" encoding="utf-8"?>
<!-- Created with Liquid XML Studio - Developer Pro Edition 7.1.1.1206 (http://www.liquid-technologies.com) -->
<MyName xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:type="NameExType">
    <FirstName>string</FirstName>
    <Surname>string</Surname>
    <MiddleName></MiddleName>
</MyName> 
```

不过，使用[Liquid XML Studio](http://www.liquid-technologies.com/XmlStudio/Free-Xsd-Editor.aspx)之类的图形编辑器可以让事情变得容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T17:49:50.327

存在“任何”元素以帮助解决此类问题。可以在[此处](http://www.w3schools.com/schema/schema_complex_any.asp)找到有关如何执行此操作的一个很好的示例。

# python - 使用 Python 的资源 (resx)

> ID：812644
> 
> 赞同：2
> 
> 时间：2009-05-01T18:38:24.307
> 
> 标签：python, resources, module, resx

你知道任何用于资源（resx 文件）操作的 Python 模块吗？

PS：我知道我可以在可用的基本 XML 处理器之上编写一个自定义包装器，我只是在破解我自己的代码之前检查一下......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-23T21:00:52.943

这个问题[Resources (resx) maintenance in large projects](https://stackoverflow.com/questions/806305/resources-resx-maintenance-in-big-projects)有一个答案指向一些 .NET 源代码，用于管理 RESX 资源的工具。由于[IronPython](http://www.codeplex.com/IronPython)可以与用 C# 编写的任何现有 .NET 对象进行交互，因此您应该能够将该 RESX 工具源代码改编成一个对象，然后您可以在 IronPython 中使用该对象。

# c# - GetConstructor.invoke 错误

> ID：812662
> 
> 赞同：1
> 
> 时间：2009-05-01T18:42:19.447
> 
> 标签：c#, invoke, getconstructor

这是一个学习项目。我有三个数据库类 A、B、C。有一个工厂类通过其构造函数接收要创建的类的对象。三个类[A,B,C] 中的每一个都有一个带有参数的构造函数来提供数据库连接对象。这是我在工厂类的 createObject 方法中使用的代码：

```
Type classtyp = Type.GetType(className);

Type[] constrParam = new Type[1];
constrParam[0] = typeof(DBConnection);
ConstructorInfo constr = database.GetConstructor(constrParam);

return constr.Invoke(constrParam) as Database; 
```

上面的最后一行给出了这个错误。

“ ***'System.RuntimeType' 类型的对象无法转换为 'System.Data.Common.DbConnection' 类型。*** ”

“System.RuntimeType”是怎么来的？我正在尝试创建一个 A 类对象，该对象具有一个构造函数，该构造函数采用 DBconnection 类型的变量。

目前我正在传递给工厂类的指令以仅创建 A 类的实例。这是A类的代码：

```
public class SqlServerDB: Database
{
    string str = "";

    public SqlServerDB(DbConnection DBConn)
        : base(DBConn)
    {
        str = "SQLServer";
    }
} 
```

我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T18:46:29.577

Invoke 方法采用您需要传递给构造函数的**对象。**您正在传递**类型**DbConnection。您应该传入的是 DbConnection 的一个实例。

更清楚一点，如果您直接创建这些对象之一，您将执行以下操作：

```
DbConnection connection = GetConnection(); //some method that gives you back a connection object
SqlServerDB db = new SqlServerDB(connection); 
```

你正在做的和这样做是一样的：

```
Type type = typeof(DbConnection);
SqlServerDB db = new SqlServerDB(type); //This is obviously wrong. 
```

# windows - 如果我不在打开的密钥上调用 RegCloseKey 会发生什么？

> ID：812665
> 
> 赞同：5
> 
> 时间：2009-05-01T18:42:39.307
> 
> 标签：windows, registry

在 Windows 中，如果在 HKEY 超出范围之前不调用 RegCloseKey，打开的 HKEY 变量会发生什么情况？当应用程序关闭时，我没有看到任何错误或警告，也没有任何内存泄漏。 [MSDN 没有提供太多帮助](http://msdn.microsoft.com/en-us/library/ms724837%28VS.85%29.aspx)，但听起来好像它以某种方式占用了资源。有谁知道实际发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T18:50:57.087

你孤立了一个句柄，这是一个有限的（好的，这是一个相当大的限制）资源。但是，一旦您的应用程序终止，操作系统最终会释放句柄，因此浪费的资源最终会返回到池中。

但是，分配有限制的东西并且在使用完毕后不释放它是一种不好的编程习惯。

# web-applications - Web 应用程序：客户端域逻辑

> ID：812667
> 
> 赞同：1
> 
> 时间：2009-05-01T18:42:47.933
> 
> 标签：web-applications, dns, logic, client-side

我们看到越来越多的 Web 应用程序在客户端完成。UI 操作、输入预验证（当然不是作为验证的最后手段）、小部件、效果等。

如果一个人决定将域逻辑放在用 Javascript/GWT/其他任何东西编写的客户端怎么办？服务器只提供数据库基础设施。

这听起来可行吗？对这个想法有什么经验、建议或意见吗？

编辑：如果您四处寻找，您会意识到可以编写整个[应用程序](http://jchrisa.net/drl/_design/sofa/_show/post/my_couch_or_yours__shareable_ap)而无需一行 php/python/java/whatever。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T20:43:57.563

我恭敬地不同意这里的其他海报。事实上，我已经实现了这样一个[拼字游戏](http://aleembawany.com/yabble/)，几乎完全使用客户端逻辑。事实上，我想做很多事情来使它更加客户端密集。GMail 在客户端做了大量的工作。

但是，出于实际原因，有些事情需要在发球端进行管理。例如，服务器需要给用户一些瓦片，然后用户可以告诉服务器他把这些瓦片放在哪里，服务器需要验证这些槽是空的，因为服务器永远不能完全信任客户端（客户端总是可以被劫持，如果不是通过脚本，那么通过嗅探 HTTP 流量并对其进行修改）。

有很多技术，比如 ADO.NET 数据服务通过 RESTful 接口公开数据库中的 CRUD 操作，以及 CouchDB 直接通过 JavaScript 存储/管理数据对象。此外，像 jQuery 或 Moo Tools 这样的富客户端库确实在推动客户端做更多的事情。

如果你仔细想想，flash 主要是在客户端做所有的 UI 和交互的东西。一些 Adob​​e Flex 应用程序非常棒。我最近将一个用于谷歌分析，它在客户端呈现图形、旋转和所有这些。服务器只提供数据。即便如此，Google Gears 和 Firefox（我相信是 3.2？）现在也提供客户端存储，这使得断开连接的应用程序场景变得更加有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T15:47:17.930

对于任何公共（和非公共）Web 应用程序，有人尝试检查您的防御措施只是时间问题。JavaScript 验证将是第一个去的。因为您可以在浏览器中禁用它，甚至在使用应用程序时禁用/启用它以获得理想的效果。

实际上，您应该具有三个级别的验证。

1.  UI 验证（可选）：首次检查用户输入。无需服务器往返的快速响应-> 用户很高兴 + 您的服务器很高兴您可以将它们从一些无效请求中解放出来。

2.  服务器端验证（必需）。再次进行所有验证+业务逻辑规则。您可能必须访问一些标准或第三方库来检查/验证/做任何您必须做的事情。在这里，您可以实现 BL 级别的数据完整性。

3.  数据库级验证（非常可取）。最后一道防线。通过使用外键/唯一键/等来保证数据完整性。多个并行请求的约束 + 事务级保护突然破坏了您的 BL 级完整性。

如果你想做对，那就应该是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T08:32:04.913

取决于应用程序以及您希望如何使用它和重用代码。

客户端 javascript 确实特定于 Web 浏览器。

域对象和实体可以在其他应用程序（桌面、Web 服务等）中重用

更不用说何时以及如果您的应用程序变得越来越大，下载时间将会越来越长。

当然，任何人都可以立即复制粘贴您的代码并克隆您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:45:45.850

这些东西都很好，但请记住，如果有人禁用了 javascript，您需要能够处理它并在您的用户弄乱您的数据库之前验证服务器上的输入。所以你可以把你想要的任何东西放在客户端，但你还需要在服务器端验证它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:46:23.587

在我看来，这不是一个可行的想法。有许多的原因。

1.  如果用户因为浏览器较旧而没有这些客户端功能，会发生什么情况？该网站很可能无法正常工作。
2.  始终，始终在服务器上执行所有相同的检查，以验证输入和规则检查，就像在客户端上一样。否则，它会导致您的网站出现重大安全问题。用户可以绕过所有 javascript 检查并对您的数据库做任何他们想做的事情。

总而言之，虽然客户端代码非常适合为用户提供比网页感觉更像应用程序的感觉，但为了网站的安全性和可访问性，需要同时实现这两种技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T18:47:54.190

我认为这是不可行的，至少如果您的目标是一致性和速度。将大量逻辑放入说 Javascript 会导致浏览器的大量工作，这意味着一个缓慢的客户端。另外，不要忘记所有浏览器都有它们的小怪癖。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-22T12:52:43.883

您可以在此处找到有关 Web 应用程序性能分析的精彩摘要：[http ://www.websiteoptimization.com/speed/tweak/psychology-web-performance/](http://www.websiteoptimization.com/speed/tweak/psychology-web-performance/)

简而言之，现代 Web 应用程序为 100 毫秒的性能提升而奋斗。在如此短的时间跨度内，依赖 http 延迟已经是一个问题。因此，很多逻辑都转移到客户端，只是为了减少与用户交互时的 http 调用次数。

有许多可用和正在开发的框架有助于构建复杂的客户端代码。一开始：jQuery (UI)、Dojo、MooTools、Prototype 等——这些更像是一个通用框架，适用于任何类型的客户端逻辑。

更确切地说：

*   [Backbone.js](http://documentcloud.github.com/backbone/) - 纯 javascript 中的 MVC 核心实现。
*   [jQuery.templates、jsViews、jsRender](http://www.borismoore.com/2012/03/approaching-beta-whats-changing-in_06.html) - 客户端渲染和数据绑定
*   其他

这里有不同框架的全面概述[http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/](http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/)

# winforms - SSRS 报告不会以横向显示

> ID：812672
> 
> 赞同：1
> 
> 时间：2009-05-01T18:44:04.717
> 
> 标签：winforms, reporting-services, reportingservices-2005

我在 SQL 2005 报告服务中有一份报告。这是一个服务器端报告，宽度设置为 11 英寸，高度设置为 8 英寸。当我在 VS 设计器中运行时，它工作正常。但是，当我在 Windows 应用程序的报表查看器控件中显示它时，它以纵向模式显示，而不是应有的横向模式。我有另一个 14 x 8 英寸的报告，并且显示正确。我似乎无法弄清楚为什么一个有效而另一个无效。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:18:59.603

这个问题原来是链接报告的一个错误。我使用的报告是链接到另一个源报告的报告。显然，当您创建链接报表时，ReportServer 数据库中包含的源报表的属性（包括页面大小）不会复制到链接报表的记录中。

当服务器执行报表时，如果在链接报表上找不到属性，而不是从源报表中读取属性，它只是将属性留空。然后查看器使用页面大小等的默认值呈现报表。我只是对 ReportServer 数据库运行更新命令，以将属性从源报表记录复制到链接报表。

可以在此处找到此问题的另一种解决方案：

[http://blogs.msdn.com/bwelcker/archive/2005/09/07/461758.aspx](http://blogs.msdn.com/bwelcker/archive/2005/09/07/461758.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T18:46:48.657

我相信您可以在 RDL 上设置一个报告属性，允许您指定纵向或横向。我不再有 VS 2005，但在 VS 2008 中，只需选择“报告属性”，它就是第一个选项。我敢打赌它在 VS 2005 中是相似的。

# c# - 将 IEnumerable 转换/强制转换为 IEnumerable

> ID：812673
> 
> 赞同：59
> 
> 时间：2009-05-01T18:44:21.750
> 
> 标签：c#, linq

我有一个具有 IEnumerable 类型属性的类（A Web 控件），并且希望使用 LINQ 处理参数。

有没有办法通过反射转换/转换/调用 IEnumerable<T> 在编译时不知道类型？

```
Method void (IEnumerable source)
{
    var enumerator = source.GetEnumerator();

    if (enumerator.MoveNext())
    {
        var type = enumerator.Current.GetType();
        Method2<type>(source); // this doesn't work! I know!
    }
}

void Method2<T>(IEnumerable<T> source) {} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-01T18:48:27.030

你`Method2`真的在乎它是什么类型的吗？如果没有，您可以致电`Cast<object>()`：

```
void Method (IEnumerable source)
{
    Method2(source.Cast<object>());
} 
```

如果您确实需要获得正确的类型，则需要使用反射。

就像是：

```
MethodInfo method = typeof(MyType).GetMethod("Method2");
MethodInfo generic = method.MakeGenericMethod(type);
generic.Invoke(this, new object[] {source}); 
```

虽然这并不理想......特别是，如果 source 不*完全是*an`IEnumerable<type>`那么调用将失败。例如，如果第一个元素恰好是一个字符串，但 source 是 a `List<object>`，你就会遇到问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T18:47:03.210

您可能想重构代码以使用`IEnumerable.Cast<T>`

像这样使用它：

```
IEnumerable mySet = GetData();
var query = from x in mySet.Cast<int>()
            where x > 2
            select x; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-25T16:05:19.600

使用 .NET 4，您可以在将其传递`source`给`dynamic`方法之前进行转换。这将导致在运行时解决正确的泛型重载，而无需任何丑陋的反射代码：

```
void Method(IEnumerable source)
{
    var enumerator = source.GetEnumerator();

    if (enumerator.MoveNext())
    {
        Method2((dynamic)source);
    }
} 
```

与 Jon 的第二个解决方案一样，这仅在您的源实际上是`IEnumerable<T>`. 如果它是普通的`IEnumerable`，那么您需要创建另一个将其转换为正确`IEnumerable<T>`类型的方法，如以下解决方案所示：

```
IEnumerable<T> Convert<T>(IEnumerable source, T firstItem)
{
    // Note: firstItem parameter is unused and is just for resolving type of T
    foreach(var item in source)
    {
        yield return (T)item;
    }
}

void Method(IEnumerable source)
{
    var enumerator = source.GetEnumerator();

    if (enumerator.MoveNext())
    {
        dynamic firstItem = enumerator.Current;
        dynamic typedEnumerable = Convert(source, firstItem);
        Method2(typedEnumerable);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-14T14:42:53.840

这是几年后的事了，但我解决了这个`List<Object>`问题。

```
void Method(IEnumerable source)
{
    var enumerator = source.GetEnumerator();
    if (enumerator.MoveNext())
    {
        MethodInfo method = typeof(MyClass).GetMethod("Method2");
        MethodInfo generic;
        Type type = enumerator.Current.GetType();
        bool sameType = true;

        while (enumerator.MoveNext())
        {
            if (enumerator.Current.GetType() != type)
            {
                sameType = false;
                break;
            }
        }

        if (sameType)
            generic = method.MakeGenericMethod(type);
        else
            generic = method.MakeGenericMethod(typeof(object));

        generic.Invoke(this, new object[] { source });
    }
} 
```

# sql - 根据第二列值对列中的不同行求和

> ID：812675
> 
> 赞同：2
> 
> 时间：2009-05-01T18:44:34.323
> 
> 标签：sql, sql-server

我有一个订单表（简化）

```
OrderId,
SalesPersonId,
SaleAmount,
CurrencyId,
... 
```

我正在尝试在此表上创建一个报告，我希望得到类似的东西：

```
SalesPersonId   TotalCAD    TotalUSD
1               12,345.00   6,789.00
2               7,890.00    1,234.00 
```

我不想做一个自我加入（也许我过早地优化，但这似乎效率低下）IE：

```
SELECT SalesPersonId, SUM(OrdersCAD.SaleAmount), SUM(OrderUSD.SaleAmount)
FROM Orders
    LEFT JOIN Orders AS OrdersCAD ON Orders.OrderID AND Orders.CurrencyID = 1
    LEFT JOIN Orders AS OrdersUSD ON Orders.OrderID AND Orders.CurrencyID = 2 
```

但我想不出另一种方法来做到这一点，有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T18:52:22.497

使用 CASE 块：

```
SELECT
  SalesPersonId,
  SUM(
    CASE CurrencyID
      WHEN 1 THEN SaleAmount
      ELSE 0
    END
  ) AS TotalCAD,
  SUM(
    CASE CurrencyID
      WHEN 2 THEN SaleAmount
      ELSE 0
    END
  ) AS TotalUSD
FROM Orders
GROUP BY SalesPersonId 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:50:21.160

试试这个：

```
SELECT SalesPersonId, 
       SUM(CASE WHEN CurrencyID = 1 THEN SaleAmount ELSE 0 END) as CAD, 
       SUM(CASE WHEN CurrencyID = 2 THEN SaleAmount ELSE 0 END) as USD
FROM ORDERS 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T14:08:38.550

考虑尝试一个标量值函数（SQL Server 2000 或更高版本）。

```
CREATE FUNCTION dbo.GetOrdersSumByCurrency
(   
    @SalesPersonID INT, @CurrencyID INT 
)
RETURNS DECIMAL(10, 2) 
AS
BEGIN
    DECLARE @Sum DECIMAL(10, 2) 

    SELECT @Sum = ISNULL(SUM(SalesAmount), 0) FROM dbo.Orders 
    WHERE SalespersonID=@SalesPersonID AND CurrencyID = @CurrencyID

    RETURN @Sum

END 
```

然后执行这样的 SQL 以获得结果（假设您还有一个单独的 salespersons 表，或者使用 SELECT DISTINCT SalesPersonId.... FROM Orders 代替）：

```
 SELECT SalesPersonId, 
dbo.GetOrdersSumByCurrency(SalesPersonId, 1) AS SumUSD, dbo.GetOrdersSumByCurrency(SalesPersonId, 2) AS SumCAD 
    FROM SalesPersons 
```

请务必运行查询计划，看看它是否按照您的需要与此处建议的其他可能性进行比较，尤其是在您处理大量数据的情况下。

# sql - Access DB 在知道总数之前对一列的总数进行行项目计算

> ID：812681
> 
> 赞同：1
> 
> 时间：2009-05-01T18:46:27.440
> 
> 标签：sql, database, ms-access

**[ 编辑 ]**

作为记录，这是查询的问题部分，现在正在运行：

```
SELECT 
 m.groupNum, 
 t.ea,
 ( t.ea - ( t.ea * m.margin )) AS estCost,
 (( t.ea - ( t.ea * m.margin )) * t.quantity ) AS salesSub,
 ((( t.ea - ( t.ea * m.margin )) * t.quantity ) / 
   (
    SELECT SUM(( t2.ea - ( t2.ea * m.margin )) * t2.quantity )
    FROM temp as t2
    INNER JOIN masters as m2 
    ON t2.mod = m2.mod
    WHERE m2.groupNum = m.groupNum
    )
  ) AS salesPercent
etc... 
```

**[结束编辑]**

我想我需要一个查询，它可以在给定（groupNum）范围的所有其余记录上插入值后，根据列值的总和递归更新自身。

我已经有了 estCost 和 salesSub 字段。现在我需要对**salesPercent**字段进行计算，这涉及到知道给定集合 (groupNum) 中所有 salesSub 记录的总量。

```
salesPercent = 
  ( salesSub / [the sum total of all salesSub amounts for each groupNum] ) 
```

*（剪断）*

```
SELECT 
 m.id, 
 t.priceEach,
 ( t.priceEach - ( t.priceEach * m.margin )) AS estCost,
 (( t.priceEach - ( t.priceEach * m.margin )) * t.quantity ) AS salesSub
 -- is it possible to perform calculation on salesPercent here?
INTO output

FROM financeMasters AS m
INNER JOIN temp AS t ....... 
```

*（结束截图）*

我有这个...

```
------
output
---------------------------------------------------------------
id | groupNum | priceEach | estCost | salesSub | salesPercent |
---------------------------------------------------------------
1  | apple    | 150.00    |  90.00  | 90.00    |   
2  | apple    | 100.00    |  60.00  | 60.00    |   
3  | apple    |  50.00    |  30.00  | 30.00    | 
```

但是在知道总数之前，如何计算 salesSub 总数（在本例中为 180.00）的 salesPercent？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T18:50:33.513

您可能必须使用子选择对每一行进行数学运算，没有办法“返回”并更改前一行。

像这样的东西：

```
SELECT 
 m.id, 
 t.priceEach,
 ( t.priceEach - ( t.priceEach * m.margin )) AS estCost,
 (( t.priceEach - ( t.priceEach * m.margin )) * t.quantity ) AS salesSub,
 ((( t.priceEach - ( t.priceEach * m.margin )) * t.quantity )
     / (SELECT SUM(( t2.priceEach - ( t2.priceEach * m.margin )) * t2.quantity )
        FROM financeMasters AS m2
            INNER JOIN temp AS t2 .....
        WHERE m2.groupNum = m.groupNum))
     AS salesPercent
INTO output

FROM financeMasters AS m
INNER JOIN temp AS t ....... 
```

是的，它非常丑陋。由于不知道你是如何进行连接的，我不得不省略一些细节，而且我不确定 groupNum 来自哪个表，你没有在任何地方显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:08:10.570

就像 Chad Birch 所说，子选择可能是你最好的选择。您可以通过将子选择存储在单独的查询中来使其不那么难看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:10:53.467

您要做的是从另一个查询中调用该查询（并将其与原始查询连接）。假设您的查询被称为`salesCalc`. 它看起来像这样（我省略了连接）：

```
SELECT m.id, 
    t.priceEach,
    ( t.priceEach - ( t.priceEach * m.margin )) AS estCost,
    (( t.priceEach - ( t.priceEach * m.margin )) * t.quantity ) AS salesSub
INTO output

FROM financeMasters AS m
INNER JOIN temp AS t ....... 
```

您将创建另一个名为`salesSum`. 它使用第一个查询。它可能看起来完全像这样：

```
select sum(salesSub) as salesGroupTotal, groupNum
from salesCalc
group by groupNum; 
```

您将创建名为 的第三个查询`salesPercent`。它同时使用第一个和第二个。它看起来像这样（我在这里也省略了连接）：

```
select salesCalc.*,  salesCalc.SalesSub/salesSum.salesGroupTotal
from salesCalc, salesSum
inner join ... 
```

(YMMV)

# java - Web服务的端到端测试

> ID：812685
> 
> 赞同：1
> 
> 时间：2009-05-01T18:46:39.607
> 
> 标签：java, testing, service

第一次海报和 TDD 采用者。:-) 我会有点冗长，所以请多多包涵。

我最近开始使用 Apache CXF 框架、Spring 和 Commons Chain 开发基于 SOAP 的 Web 服务来实现业务流程。我在这里面临的问题是测试 Web 服务——在单元测试和功能测试中进行测试。

我对单元测试的第一次尝试完全失败了。为了保持单元测试的灵活性，我使用 Spring XML 文件来保存我的测试数据。此外，我没有创建要测试的“组件”实例，而是从我的 Spring 应用程序上下文中检索它们。包含数据的 XML 文件很快就失控了；在 XML 中创建对象图被证明是一场噩梦。由于要测试的“组件”是从 Spring 应用程序上下文中挑选出来的，因此每次测试运行都会加载我的应用程序中涉及的*所有*组件、使用的 DAO 对象等。此外，与单元测试用例集中或集中在的概念相反只测试组件，我的单元测试开始访问数据库，与邮件服务器通信等。糟糕，非常糟糕。

我知道我做错了什么，并开始想办法纠正它。根据这个板上的一个帖子的建议，我查找了 Mockito，这是一个 Java 模拟框架，这样我就可以不用使用真正的 DAO 类和邮件服务器，而只是模拟功能。

随着单元测试的控制，这给我带来了第二个问题；对数据的依赖。我一直在开发的 Web 服务几乎没有逻辑，但严重依赖数据。例如，考虑我的一个组件：

```
public class PaymentScheduleRetrievalComponent implements Command {
  public boolean execute(Context ctx) {
    Policy policy = (Policy)ctx.get("POLICY");
    List<PaymentSchedule> list = billingDAO.getPaymentStatementForPolicy(policy);
    ctx.put("PAYMENT_SCHEDULE_LIST", list);
    return false;
  }
} 
```

我的大部分组件都遵循相同的路线——从上下文中选择一个域对象，点击 DAO [我们在这里使用 iBatis 作为 SQL 映射器] 并检索结果。

所以，现在的问题是：
- DAO 类是如何测试的，尤其是当单个插入或更新可能使数据库处于“不稳定”状态时[假设 3 次插入不同表实际上形成一个事务]？
- 移动大量数据（即从数据存储中进行无意识的插入/检索）的功能测试 Web 服务的事实上的标准是什么？

您的个人经历/意见将不胜感激。如果我在解释手头的问题时遗漏了一些细节，请告诉我。

-佐助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:04:27.097

如果我是你，我会远离“作为全局哈希图的上下文”“模式”。

看起来你正在测试你的持久性映射......

你可能想看看：[testing persistent objects without spring](http://www.time4tea.net/wiki/display/MAIN/Testing+Persistent+Objects+Without+Spring)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:52:21.153

首先：您是否有理由必须从 Spring Application 上下文中检索被测主题 (SUT)？为了进行高效的单元测试，您应该能够在没有上下文的情况下创建 SUT。听起来您在某处有一些隐藏的依赖项。这可能是你头痛的根源。

> 当单个插入或更新可能使数据库处于“不稳定”状态时（假设 3 次插入不同表实际上形成单个事务），DAO 类如何测试？

运行测试后，您似乎担心数据库的一致性。如果可能的话，使用自己的数据库进行测试，您不需要关心它。如果您有这样的沙箱数据库，您可以根据需要删除数据。在这种情况下，我会执行以下操作：

1.  使用一些通用标识符标记所有虚假数据，例如在字段中添加特殊前缀。
2.  在运行测试之前删除一个删除语句，删除标记的数据。如果没有，那么就不会发生任何不好的事情。
3.  运行您的单个 DAO 测试。之后重复步骤 2\. 进行下一次测试。

> 移动大量数据（即从数据存储中进行无意识的插入/检索）的功能测试 Web 服务的事实上的标准是什么？

我不知道。根据您提出的问题，我可以推断您一方面拥有 Web 服务，另一方面拥有数据库。分清责任。每边都有单独的测试套件。一方面只是测试数据库访问（如上所述）。另一方面，只是测试 Web 服务请求和响应。在这种情况下，它支付存根/伪造/模拟与网络对话的层。或者考虑[https://wsunit.dev.java.net/](https://wsunit.dev.java.net/)。

如果程序只是将数据推入和推出，我认为没有太多行为。如果是这种情况，那么最难的工作就是对数据库端和 Web 服务端进行单元测试。关键是您可以在不需要“真实”数据的情况下进行单元测试。对于功能测试，您将需要接近现实的手动数据。这可能很麻烦，但是如果您已经对数据库和 Web 服务部分进行了密集的单元测试，那么这应该会大大减少对“现实”测试用例的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T15:23:45.567

我会推荐一个内存数据库来运行你的单元测试，比如 HSQL。您可以使用它来动态创建架构（例如，如果您使用 Hibernate，则可以使用 XML 映射文件），然后在单元测试结束时销毁数据库之前根据需要插入/更新/删除。您的测试绝不会干扰您的实际数据库。

对于第二个问题（Web 服务的端到端测试），我过去已经成功地对基于 CXF 的服务进行了单元测试。诀窍是在测试开始时使用轻量级 Web 服务器发布您的 Web 服务（Jetty 是理想的），然后使用 CXF 将客户端指向您的 Web 服务端点，运行您的调用，最后关闭 Jetty完成单元测试后托管您的 Web 服务的实例。

为了实现这一点，您可以使用 CXF 提供的 JaxWsServerFactoryBean（服务器端）和 JaxWsProxyFactoryBean（客户端）类，请参阅此页面以获取示例代码：

[http://cwiki.apache.org/CXF20DOC/a-simple-jax-ws-service.html#AsimpleJAX-WSservice-Publishingyourservice](http://cwiki.apache.org/CXF20DOC/a-simple-jax-ws-service.html#AsimpleJAX-WSservice-Publishingyourservice)

我也非常赞成 SOAP UI 对您的 Web 服务进行功能测试。JMeter 对 Web 服务的压力测试也非常有用，这对于那些进行数据库查找的服务来说尤其重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-28T23:46:52.293

首先，把事情说清楚。

在理想的世界中，您正在构建的软件的生命周期是这样的： - sy 与客户一起制作报告，因此您获得了一个用户故事，其中包含有关应用程序应该如何工作的示例 - 您概括了用户故事，所以您得到了规则，您将其称为用例-您开始编写一段功能（端到端）测试，但它失败了...-之后您构建了用户界面并模拟了服务，因此您获得了绿色功能测试以及关于你的服务应该如何工作的规范...... - 你的工作是保持功能测试绿色，并逐步实现服务编写集成测试，并用相同的方法模拟依赖关系，直到你达到单元测试的水平- 之后你对用例进行下一次迭代，编写下一个功能测试，依此类推，直到项目结束 - 之后您与接受产品并支付大量费用的客户进行验收测试

那么我们从中学到了什么：

*   有很多类型的测试（不要将它们相互混淆）
    *   功能测试 - 用于测试用例（什么都不做）
    *   集成测试 - 用于测试应用程序、组件、模块、类交互（模拟不相关的组件）
    *   单元测试 - 用于测试与环境隔离的单个类（模拟所有内容）
    *   用户验收测试 - 客户确保她接受产品（手动功能测试，或通过工作中的自动功能测试进行的演示）
*   您不需要通过功能测试和集成测试来测试所有内容，因为这是不可能的。通过功能和集成测试仅测试相关部分，并通过单元测试测试所有内容！熟悉[测试金字塔](http://martinfowler.com/bliki/TestPyramid.html)。
*   使用 TDD，让生活更轻松！

> *   当单个插入或更新可能使数据库处于“不稳定”状态时（假设 3 次插入不同表实际上形成单个事务），DAO 类如何测试？

您不必测试您的数据库事务。假设它们运行良好，因为数据库开发人员已经对它们进行了测试，并且我确定您不想编写并发测试…… Db 是一个外部组件，因此您不必自己进行测试。您可以编写数据访问层以使数据存储适应您的系统，并仅为这些适配器编写集成测试。在数据库迁移的情况下，这些测试也将由新数据库的适配器工作，因为您编写它们以实现特定接口......通过任何其他测试（功能测试除外），您可以模拟您的数据访问层。对所有其他外部组件也这样做，编写适配器并模拟它们。将这些类型的集成测试放在与其他测试不同的测试套件中，

> *   移动大量数据（即从数据存储中进行无意识的插入/检索）的功能测试 Web 服务的事实上的标准是什么？

您可以使用实现相同存储适配器的内存数据库模拟您的数据存储，直到您实现除数据库之外的所有其他内容。之后，您实现数据库的数据访问层并使用功能测试对其进行测试。它会很慢，但它只能运行一次，例如每个新版本...如果您需要通过开发进行功能测试，您可以再次使用内存解决方案对其进行模拟...另一种仅运行的方法通过开发受影响的功能测试，或修改测试数据库的设置以使事情变得更快，等等......我相信有很多测试优化解决方案......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T18:14:58.253

> 我必须说我真的不明白你的确切问题。运行测试后，您的数据库是否处于更改状态？

是的，这里实际上有两个问题。第一个是运行测试用例后数据库处于不一致状态的问题。第二个是我正在寻找一个优雅的解决方案，用于 Web 服务的端到端测试。

> 为了进行高效的单元测试，您应该能够在没有上下文的情况下创建 SUT。听起来您在某处有一些隐藏的依赖项。这可能是你头痛的根源。

这确实是我头痛的根本原因，我现在将借助一个模拟框架来消除它。

> 运行测试后，您似乎担心数据库的一致性。如果可能的话，使用自己的数据库进行测试，您不需要关心它。如果您有这样的沙箱数据库，您可以根据需要删除数据。

这确实是我在上一篇文章中提到的问题的解决方案之一，但这可能不适用于所有情况，尤其是在与数据库/数据不受您控制的遗留系统集成时以及某些 DAO 的情况下方法要求某些数据已经存在于给定的一组表中。我应该研究像 DBUnit 这样的数据库单元测试框架吗？

> 在这种情况下，它支付存根/伪造/模拟与网络对话的层。或者考虑 [https://wsunit.dev.java.net/](https://wsunit.dev.java.net/)。

啊，看起来很有趣。我还听说过诸如 SOAPUI 等可用于功能测试的工具。这里有人用这些工具取得过成功吗？

感谢所有答案和对模棱两可的解释表示歉意；英语不是我的第一语言。

-佐助

# windows - 一个窗口可以总是在另一个窗口之上吗？

> ID：812686
> 
> 赞同：16
> 
> 时间：2009-05-01T18:46:39.983
> 
> 标签：windows, winapi

在 Windows 中，是否可以将窗口 A 设置为始终位于窗口 B 的顶部，但允许其他窗口正常工作并在活动时出现在两者的顶部。

换句话说，我想要两个窗口之间的父子关系。这可以在不使窗口 A 成为窗口 B 的子窗口（MDI 样式）的情况下完成吗？窗口 B 不是我的（Internet Explorer），当我尝试使用`SetParent`.

我以为我已经从[MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/46a66fe3-194a-4e57-891e-4875ea8fcd00/)中用这个想法破解了它，但是唉，windows A 仍然总是在一切之上，而不仅仅是 window B。

```
// Place window A on top
SetWindowPos(hWndWindow, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE|SWP_NOSIZE);
// Place window B underneath it
SetWindowPos(hWndParent, HWND_NOTOPMOST, 0, 0, 0, 0, SWP_NOSIZE|SWP_NOMOVE); 
```

可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-07T12:58:27.210

建立所有权关系不会起到作用吗？

```
SetWindowLong(hwndChild, GWL_HWNDPARENT, hwndOwner) 
```

窗口可以在不同的进程中，您可以从任何进程中调用它。这将确保子窗口始终位于所有者窗口之上。这与实际创建父/子关系的 SetParent 不同。[通读这篇文章](http://msdn.microsoft.com/en-us/library/ms997562.aspx)（从 1993 年开始，但大部分内容仍然正确），了解所有权和养育子女之间的区别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T17:30:46.817

当窗口的 Z 顺序（或大小或位置）发生变化时，它应该收到[WM_WINDOWPOSCHANGING](http://msdn.microsoft.com/en-us/library/ms632653(VS.85).aspx)消息。如果您处理该消息，您就有机会修改窗口移动到的最终 Z 顺序（或大小或位置）。

为了说明，在 hWndA 的窗口过程中：

```
case WM_WINDOWPOSCHANGING:
    DefWindowProc(hWnd, msg, wParam, lParam);
    WINDOWPOS *p = (WINDOWPOS*)lParam;
    p->hwndInsertAfter = hWndB;
    p->flags &= ~SWP_NOZORDER;
    return 0; 
```

任何时候 hWndA 的位置发生变化时，都应在 Z 顺序中的 hWndB 之后插入 hWndA。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T19:06:44.807

在 Vista 之前，一种方法是使用`SetWindowsHookEx`, 并钩住`WH_CBT`or`WH_CALLWNDPROC`钩子，然后在检测到 Z 顺序发生变化时采取适当的措施。但是，这不适用于 Vista（据我从谷歌搜索可知）。

我能想到的唯一其他解决方案是设置一个计时器，每隔几秒触发一次，然后当您收到 时`WM_TIMER`，您会询问系统，`GetNextWindow`以找出您的窗口后面是哪个窗口。如果它不是 IE，则调用`SetWindowPos`将您的窗口定位在 IE 上方（我假设您有一个`HWND`您关心的 IE 窗口 - 请记住可以有多个 IE 窗口）。

如果人们试图将您的窗口放在前面，这将导致问题 - 它会翻转回 IE 上方。在这种情况下，在您的代码中，您可以处理`WM_ACTIVATE`并尝试更改 IE 窗口的 Z 顺序，使其位于您的窗口下方（调用`SetWindowPos`以移动 IE 窗口，使其位于当前窗口下方的窗口上方）。此解决方案可能充满问题，因为出于安全原因，Windows 可能会尝试阻止您弄乱另一个进程的窗口。另一方面，MSDN 文档`SetWindowPos`没有*明确*提到您不能操作另一个进程的窗口。不过可能有一些模糊的限制。

即使有了这个计时器黑客，你也会在你的应用程序中有效地有一个繁忙的等待循环（频繁的 WM_TIMER 消息），这通常是一件**坏事**，特别是对于笔记本电脑的电池寿命等（因为你防止CPU 进入睡眠状态等）。

我想说没有什么好的方法可以做到这一点，而且你可能会开始工作的任何东西都会变得脆弱并导致问题。**我强烈建议不要尝试这样做。** 是否可以将您的程序变成某种 IE 的插件或工具栏？

**NB**请特别注意，`SetWindowsHookEx`如果您沿着这条路线走，则会在系统范围内施加性能损失。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-19T22:05:09.133

莫里斯的答案是最好的答案，但缺少重要的一步。当您在希望作为覆盖的窗口上调用 show 时，您需要调用具有参数的 show 方法。您需要定义一个实现 IWin32Window 接口的类，然后创建一个新的实例。界面唯一关心的是句柄，所以只需将其设置为 IE 窗口的句柄，它应该可以很好地工作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-08T13:42:01.343

如果父子关系是自己用SetWindowPos()函数建立的，你的愿望就可以实现了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T19:42:40.783

Can you access the Z-order of the windows?

I cannot recall the default z-order of windows, but I think it is 1\. You might be able to set IE to a -1 and your app to 0.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T19:44:53.617

Try this:

```
// Place window A on top of window B
SetWindowPos(hWndA, hWndB, 0, 0, 0, 0, SWP_NOMOVE|SWP_NOSIZE); 
```

The second window handle parameter specifies the next window down in the Z order.

Note this doesn't actually change the window parent-child relationships - but you can simulate it.

# java - 如何从 Java 中获取空闲内存信息

> ID：812691
> 
> 赞同：1
> 
> 时间：2009-05-01T18:47:13.693
> 
> 标签：java, memory

我使用以下几行来获取 Java 的内存使用情况：

```
Free_Memory=Run_Time.freeMemory()/1048576;           // 1024 x 1024 = 1K x 1K = 1Meg
Total_Memory=Run_Time.totalMemory()/1048576;         // 992 Total on a 4 GB PC 
```

我得到的 Free_Memory 是：900，但它还差得很远，当 Free_Memory 下降到 600 左右时，我的程序内存不足并产生堆溢出消息。

所以我查看了 => Windows 任务管理器：性能：物理内存：空闲，它下降到 1、2 或 0，这更准确地反映了我的内存情况，据此，我的总内存是：4089，这是正确的，而 Java 的 Total_Memory=992 是不正确的。

所以，我现在的问题是：在我的 Java 程序中，如何获得反映在 Windows 任务管理器中的内存使用数字：性能：物理内存？我需要依赖这些数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:19:46.657

The JVM doesn't allow Java to consume all available system memory. Instead the JVM grabs a fixed chunk and allocates all of your objects within that chunk. If this area fills up, you're out of memory! There are commandline options to alternate the max/initial memory usage of the JVM.

The more important issue is that you should not be relying on tracking free/max memory. What are you doing that relies on tracking memory?

UPDATE:

Try 64bit if you need more memory than 1.5GB

If you're trying to track memory running out then consider figuring our WHY your program does this and if it can be prevented through different algorithms or better management of objects. When the memory reaches zero what do you expect to do? Popup a dialog and tell the user they're screwed and exit the program? I can understand a grateful shutdown but warning the user to run with a large -Xmx is not going to cut it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:20:03.583

If you want detailed Windows stats, you can use [WMI](http://en.wikipedia.org/wiki/Windows_Management_Instrumentation) and a .vbs script, executed via cscript.exe.

[This link](http://www.serverwatch.com/tutorials/article.php/1476631) details a script that pulls more detailed memory stats than you could possibly want.

Execute this via the usual Process/Runtime combination, and simply read back what figures you require. These are system level stats, and not for the VM (although WMI can pull back per-process stats as well).

# javascript - 无法在 IE 中动态添加行？ 我有一个 AJAX 应用程序，它下载一个 JSON 对象并使用该数据使用 Javascript DOM 函数向 HTML <table> 添加行。它完美地工作......除了在 Internet Explorer 中。IE 没有给出任何类型的错误，我已经尽我所能验证了代码正在由浏览器执行，但它根本没有任何效果。我创建了这个快速而肮脏的页面来演示这个问题： <!DOCTYPE html PUBL 问问题 问问题 2009-05-01T18:47:32.773 11976 次 This question shows research effort; it is useful and clear 21 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有一个 AJAX 应用程序，它下载一个 JSON 对象并使用该数据使用 Javascript DOM 函数向 HTML <table> 添加行。它完美地工作......除了在 Internet Explorer 中。IE 没有给出任何类型的错误，我已经尽我所能验证了代码正在由浏览器执行，但它根本没有任何效果。我创建了这个快速而肮脏的页面来演示这个问题： <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"><head><title></title></head><body> <table id="employeetable"> <tr> <th>Name</th> <th>Job</th> </tr> </table> <script type="text/javascript"> function addEmployee(employeeName, employeeJob) { var tableElement = document.getElementById("employeetable"); if (tableElement) { var newRow = document.createElement("tr"); var nameCell = document.createElement("td"); var jobCell = document.createElement("td"); nameCell.appendChild(document.createTextNode(employeeName)); jobCell.appendChild(document.createTextNode(employeeJob)); newRow.appendChild(nameCell); newRow.appendChild(jobCell); tableElement.appendChild(newRow); alert("code executed!"); } } setTimeout("addEmployee(\"Bob Smith\", \"CEO\");", 1000); setTimeout("addEmployee(\"John Franks\", \"Vice President\");", 2000); setTimeout("addEmployee(\"Jane Doe\", \"Director of Marketing\");", 3000); </script> </body></html> 我没有尝试过 IE 8，但 IE 7 和 IE 6 都没有显示应该添加的额外行。我无法理解为什么。有谁知道解决这个问题的好方法，还是我做错了什么？ 编辑：现在可以在 IE 中使用！insertSiblingNodesAfter 使用兄弟节点的 parentNode，恰好是 IE 中的一个 tbody 当您尝试操作 DOM 跨浏览器时，很难知道存在哪些怪癖。我建议您使用已在所有主要浏览器中经过全面测试的现有库，并考虑怪癖。 我个人使用 MochiKit，您可以在这里深入了解 DOM 操作：http: //mochikit.com/doc/html/MochiKit/DOM.html 您的最终功能可能如下所示： function addEmployee(employeeName, employeeJob) { var trs = getElementsByTagAndClassName("tr", null, "employeetable"); insertSiblingNodesAfter(trs[trs.length-1], TR({}, TD({}, employeeName), TD({}, employeeJob)); alert("code executed!"); } javascriptajaxinternet-explorercross-browserhtml-table 4 3 回答 3 This answer is useful 17 您需要创建一个 TBODY 元素来添加您的新 TR，然后将 TBODY 添加到您的表中，如下所示： <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"><head><title></title></head><body> <table id="employeetable"> <tr> <th>Name</th> <th>Job</th> </tr> </table> <script type="text/javascript"> function addEmployee(employeeName, employeeJob) { var tableElement = document.getElementById("employeetable"); if (tableElement) { var newTable = document.createElement('tbody'); // New var newRow = document.createElement("tr"); var nameCell = document.createElement("td"); var jobCell = document.createElement("td"); nameCell.appendChild(document.createTextNode(employeeName)); jobCell.appendChild(document.createTextNode(employeeJob)); newRow.appendChild(nameCell); newRow.appendChild(jobCell); newTable.appendChild(newRow); // New tableElement.appendChild(newTable); // New alert("code executed!"); } } setTimeout("addEmployee(\"Bob Smith\", \"CEO\");", 1000); setTimeout("addEmployee(\"John Franks\", \"Vice President\");", 2000); setTimeout("addEmployee(\"Jane Doe\", \"Director of Marketing\");", 3000); </script> </body></html> 于 2009-05-01T19:01:24.270 回答 This answer is useful 8 显然，在 IE 中，您需要将行附加到 TBody 元素，而不是 Table 元素......请参阅Ruby-Forum上的讨论。 扩展那里的讨论，<table> 标记通常在没有显式 <thead> 和 <tbody> 标记的情况下完成，但 <tbody> ELEMENT 是您实际需要添加新行的地方，因为 <table> 不包含 < tr> 元素直接。 于 2009-05-01T18:59:02.823 回答 This answer is useful 2 Edit: now works in IE! insertSiblingNodesAfter uses the parentNode of the sibling, which happens to be a tbody in IE It's hard to know what quirks are in store when you try to manipulate the DOM cross-browser. I'd recommend that you use an existing library that has been fully tested across all major browsers, and accounts for quirks. Personally I use MochiKit, you can dive into DOM manipulation here: http://mochikit.com/doc/html/MochiKit/DOM.html Your final function might look something like this: function addEmployee(employeeName, employeeJob) { var trs = getElementsByTagAndClassName("tr", null, "employeetable"); insertSiblingNodesAfter(trs[trs.length-1], TR({}, TD({}, employeeName), TD({}, employeeJob)); alert("code executed!"); } 于 2009-05-01T18:57:01.143 回答 Related 1 msbuild - 是否有必要用“.Test”命名 NUnit 测试 DLL 以与 MSBuild 一起使用 2 r - is.null 不适用于 R [可能的错误] 中的 null data.table？ 3 c - 从标准输入 c 传入文件时运行 gdb 0 javascript - JavaScript 按钮处理程序模式？ 1 servicestack - 如何从 ServiceStack RequestFilter 中找到服务 1 asp.net-mvc-3 - Ext.NET 多次使用 FormPanelFor 引发错误 3 sql-server - 零售数据库设计 1 c++ - extern "C" dllexport 产生奇怪的名字 1 hadoop - 我如何更改名称节点？ 1 inno-setup - Inno Setup 尝试为模块化 InnoSetup 依赖安装程序创建新的安装 DirectX 模板产品 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：812693
> 
> 赞同：21
> 
> 时间：
> 
> 标签：javascript, ajax, internet-explorer, cross-browser, html-table

我有一个 AJAX 应用程序，它下载一个 JSON 对象并使用该数据使用 Javascript DOM 函数向 HTML <table> 添加行。它完美地工作......除了在 Internet Explorer 中。IE 没有给出任何类型的错误，我已经尽我所能验证了代码正在由浏览器执行，但它根本没有任何效果。我创建了这个快速而肮脏的页面来演示这个问题：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title></head><body>

<table id="employeetable">
    <tr>
        <th>Name</th>
        <th>Job</th>
    </tr>
</table>

<script type="text/javascript">
    function addEmployee(employeeName, employeeJob) {
        var tableElement = document.getElementById("employeetable");
        if (tableElement) {
            var newRow = document.createElement("tr");
            var nameCell = document.createElement("td");
            var jobCell = document.createElement("td");
            nameCell.appendChild(document.createTextNode(employeeName));
            jobCell.appendChild(document.createTextNode(employeeJob));
            newRow.appendChild(nameCell);
            newRow.appendChild(jobCell);
            tableElement.appendChild(newRow);
            alert("code executed!");
        }
    }

    setTimeout("addEmployee(\"Bob Smith\", \"CEO\");", 1000);
    setTimeout("addEmployee(\"John Franks\", \"Vice President\");", 2000);
    setTimeout("addEmployee(\"Jane Doe\", \"Director of Marketing\");", 3000);
</script>

</body></html> 
```

我没有尝试过 IE 8，但 IE 7 和 IE 6 都没有显示应该添加的额外行。我无法理解为什么。有谁知道解决这个问题的好方法，还是我做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T19:01:24.270

您需要创建一个 TBODY 元素来添加您的新 TR，然后将 TBODY 添加到您的表中，如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title></head><body>

<table id="employeetable">
    <tr>
        <th>Name</th>
        <th>Job</th>
    </tr>
</table>

<script type="text/javascript">
    function addEmployee(employeeName, employeeJob) {
        var tableElement = document.getElementById("employeetable");
        if (tableElement) {
            var newTable = document.createElement('tbody');   // New
            var newRow = document.createElement("tr");
            var nameCell = document.createElement("td");
            var jobCell = document.createElement("td");
            nameCell.appendChild(document.createTextNode(employeeName));
            jobCell.appendChild(document.createTextNode(employeeJob));
            newRow.appendChild(nameCell);
            newRow.appendChild(jobCell);
            newTable.appendChild(newRow);   // New
            tableElement.appendChild(newTable);   // New
            alert("code executed!");
        }
    }

    setTimeout("addEmployee(\"Bob Smith\", \"CEO\");", 1000);
    setTimeout("addEmployee(\"John Franks\", \"Vice President\");", 2000);
    setTimeout("addEmployee(\"Jane Doe\", \"Director of Marketing\");", 3000);
</script>

</body></html> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T18:59:02.823

显然，在 IE 中，您需要将行附加到 TBody 元素，而不是 Table 元素......请参阅[Ruby-Forum](http://www.ruby-forum.com/topic/139836)上的讨论。

扩展那里的讨论，<table> 标记通常在没有显式 <thead> 和 <tbody> 标记的情况下完成，但 <tbody> ELEMENT 是您实际需要添加新行的地方，因为 <table> 不包含 < tr> 元素直接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T18:57:01.143

Edit: now works in IE! insertSiblingNodesAfter uses the parentNode of the sibling, which happens to be a tbody in IE

* * *

It's hard to know what quirks are in store when you try to manipulate the DOM cross-browser. I'd recommend that you use an existing library that has been fully tested across all major browsers, and accounts for quirks.

Personally I use MochiKit, you can dive into DOM manipulation here: [http://mochikit.com/doc/html/MochiKit/DOM.html](http://mochikit.com/doc/html/MochiKit/DOM.html)

Your final function might look something like this:

```
function addEmployee(employeeName, employeeJob) {
    var trs = getElementsByTagAndClassName("tr", null, "employeetable");
    insertSiblingNodesAfter(trs[trs.length-1], TR({}, TD({}, employeeName), TD({}, employeeJob));
    alert("code executed!");
} 
```

# asp.net - 现有网站在 Internet Explorer 8 中正确呈现的问题有哪些？

> ID：812694
> 
> 赞同：2
> 
> 时间：2009-05-01T18:47:46.157
> 
> 标签：asp.net, internet-explorer, web

现在 IE8 出来了，Web 开发人员在他们现有的网站中可能会遇到哪些问题？是否有“重大”更改列表？或者这个东西“只是要在现有网站上工作”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T14:50:17.717

www.quirksmode.org 上有一些很棒的参考页面。本站详细记录了所有主流浏览器支持的功能，包括IE8。

[http://www.quirksmode.org/compatibility.html](http://www.quirksmode.org/compatibility.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T18:51:45.947

我不确定“重大更改”列表，但我在使用 IE8 进行测试时注意到了一些事情。

1.  它确实打破了东西
2.  您必须在打开和关闭兼容模式的情况下测试您的网站。有趣的是，兼容模式与 IE7 的渲染方式不同，有时它会在 IE7 中工作，而在关闭兼容模式的 IE8 中，打开兼容模式的 IE8 将无法工作。b所以随着 IE8 的出现，你基本上有2个浏览器合二为一测试

# xml - 你如何做一个 HTTP Put？

> ID：812711
> 
> 赞同：68
> 
> 时间：2009-05-01T18:51:12.343
> 
> 标签：xml, web-services, http, rest, put

我们有这个具有 Web 服务组件的软件。

现在，这个系统的管理员来找我了，想通过webservices组件将数据导入系统。

所以，我去阅读文档试图弄清楚这件事，我看到了这样的事情：

* * *

~~~~[单击此处查看我在说什么（这在 firefox、chrome 和 safari 中看起来最好）](http://www.gtcc.edu/temp/spaces.xml.documentation.htm)

* * *~~ 

该文档提供了使用 HTTP 动词（例如 GET、POST、PUT、DELETE）与系统交互的示例。但在我有限的经验中，我从来不需要发送 HTTP PUT 或 DELETE。

你怎么做呢？我已经构建了具有 method="post" 或 method="get" 的 HTML 表单，并且请求被发送到 action 属性 (action="someResource") 中指定的任何内容。但我真的不知道如何处理这个 PUT 东西。

如果我不得不猜测，我将不得不构建一个应用程序来创建某种 HTTP 请求对象并设置它的所有属性，并以某种方式包含我想要 PUT 到 RESOURCE 的数据（

* * *

~~~~[我正在尝试使用 REST 术语，这对我来说是非常新的](http://tomayko.com/writings/rest-to-my-wife)

* * *~~ ）。然后我会使用我的编程语言和等等等等来发送请求。我只是在猜测这个。请提供一些帮助！

我以为我是一名 Web 开发人员，因为我知道 XHTML、CSS、JavaScript 等，但开始看起来我对 Web 的基础（HTTP）一无所知。

## 编辑

PS：我主要使用 .net 进行编程。因此，.net 中的任何示例都会非常棒。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-01T21:35:02.137

这是一个使用 HttpWebRequest 的 C# 示例：

```
using System;
using System.IO;
using System.Net;

class Test
{
        static void Main()
        {
                string xml = "<xml>...</xml>";
                byte[] arr = System.Text.Encoding.UTF8.GetBytes(xml);
                HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("http://localhost/");
                request.Method = "PUT";
                request.ContentType = "text/xml";
                request.ContentLength = arr.Length;
                Stream dataStream = request.GetRequestStream();
                dataStream.Write(arr, 0, arr.Length);
                dataStream.Close();
                HttpWebResponse response = (HttpWebResponse)request.GetResponse();
                string returnString = response.StatusCode.ToString();
                Console.WriteLine(returnString);
        }
} 
```

**更新**：System.Net.Http 中现在有一个 HttpClient 类（[可作为 NuGet 包提供](https://www.nuget.org/packages/Microsoft.Net.Http)），这使这更容易一些：

```
using System;
using System.Net.Http;

class Program
{
    static void Main()
    {
        var client = new HttpClient();
        var content = new StringContent("<xml>...</xml>");
        var response = client.PutAsync("http://localhost/", content).Result;
        Console.WriteLine(response.StatusCode);
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-01T19:07:48.030

PUT 和 DELETE 可能要求您使用 AJAX 并发出 XMLHttpRequest，因为 FORM 标记仅支持 GET 和 POST 动词，而链接仅发出 GET 请求。

使用 jQuery：

```
 $.ajax( {
       url: '/controller/action',
       type: 'PUT',
       data: function() { ...package some data as XML },
       dataType: 'xml',
       ... more options...
 ); 
```

[jQuery ajax 选项](http://docs.jquery.com/Ajax/jQuery.ajax#options)页面上的注释警告某些浏览器不支持请求类型的 PUT 和 DELETE。FWIW，我从未使用过 PUT，但在 IE 和 FF 中使用过 DELETE。尚未在 Safari 或 Opera 中测试。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T18:56:26.527

以下是在 CURL 中的操作方法：[如何使用 cURL 测试 RESTful Rails](http://inquirylabs.com/blog2009/2006/08/04/how-to-use-curl-to-test-restful-rails/)

或者...您绝对可以使用 HTML 表单。如果应用程序是真正的 RESTful，它将理解 REST 操作，并且只允许您根据您使用的方法执行某些操作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-01T19:07:39.043

您不能 PUT 使用 HTML 表单（规范[仅定义表单的 GET/POST](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.1)）。

但是，任何 HTTP API 都应该允许您进行 PUT，就像它允许您进行 GET 或 POST 一样。例如，[这里是 Java HTTPClient 文档](http://hc.apache.org/httpclient-3.x/methods.html)，其中详细介绍了 PUT 以及所有其他 HTTP 动词。

我不知道您使用的是哪种语言，但我认为编写一个应用程序来执行 HTTP PUT 将非常简单。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-04T19:13:52.077

我发现这个非常酷的免费软件叫做[RESTClient](http://code.google.com/p/rest-client/)。

它允许您使用各种动词与 HTTP 资源交互、手动设置标头和正文、设置身份验证信息、ssl、运行测试脚本等。

这将帮助我弄清楚如何与我们的“网络服务”软件进行交互，该软件实际上只是软件数据库的 RESTful API。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-17T10:58:25.850

将 api 测试为 chrome 扩展 [https://chrome.google.com/webstore/detail/fdmmgilgnpjigdojojpjoooidkmcomcm](https://chrome.google.com/webstore/detail/fdmmgilgnpjigdojojpjoooidkmcomcm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T19:02:40.740

[这](http://upload.thinfile.com/put/)是一个工具，可让您拖放到 PUT 文件

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T19:29:42.500

“现在，这个系统的管理员来找我了，想通过webservices组件将数据导入系统。”

Web 服务与 HTML 表单几乎没有关系。

Web 服务请求要么从 Javascript（例如，作为 Ajax）完成，要么从您的应用程序完成。

您将编写一个 C# 或 VB 程序，该程序使用 HTTP 使用给定的数据集对给定的 Web 服务 URL 执行 Put。

例如，这里是一些示例 VB 代码：http: [//developer.yahoo.com/dotnet/howto-rest_vb.html#post](http://developer.yahoo.com/dotnet/howto-rest_vb.html#post)

将“POST”的方法字符串替换为“PUT”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-02-10T07:01:23.033

试试 libcurl.NET 怎么样：http: [//sourceforge.net/projects/libcurl-net/](http://sourceforge.net/projects/libcurl-net/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T18:53:09.420

只是一些网络管理员出于各种原因阻止放置的提示。因此，您可能必须使用 POST 而不是 PUT。检查您的操作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-20T22:21:17.930

PUT 和 DELETE 不是 HTML4 的一部分，但包含在 HTML5 规范中。由于这个原因，大多数流行的浏览器都没有很好的支持它们，因为它们专注于 HTML4。但是，它们绝对是 HTTP 的一部分，而且一直都是。您使用一些非浏览器客户端或在支持 HTML5 的浏览器中使用表单来执行 PUT。

更新：PUT 和 DELETE 不再是 HTML5 表单的一部分。见：[http ://www.w3.org/TR/html5/association-of-controls-and-forms.html#attr-fs-method](http://www.w3.org/TR/html5/association-of-controls-and-forms.html#attr-fs-method)

# c# - 如何将 byte[] 转换为该文本格式？

> ID：812716
> 
> 赞同：1
> 
> 时间：2009-05-01T18:51:54.307
> 
> 标签：c#, text, formatting

我可以说我不知道​​我在寻求什么帮助，因为我不知道格式，但我有一张图片。

我有一个 byte[] 数组，如何将其转换为下面的格式（右）？

[替代文字 http://img512.imageshack.us/img512/3548/48667724.jpg](http://img512.imageshack.us/img512/3548/48667724.jpg)

它不是普通的ASCII。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T19:03:24.390

听起来您想获取一个字节数组，并将其转换为文本（用“ `.`”替换特定范围之外的字符）

```
static public string ConvertFromBytes(byte[] input)
{
    StringBuilder output = new StringBuilder(input.Length);

    foreach (byte b in input)
    {
        // Printable chars are from 0x20 (space) to 0x7E (~)
        if (b >= 0x20 && b <= 0x7E)
        {
            output.Append((char)b);
        }
        else
        {
            // This isn't a text char, so use a placehold char instead
            output.Append(".");
        }
    }

    return output.ToString();
} 
```

或作为 LINQy 扩展方法（在静态扩展类中）：

```
static public string ToPrintableString(this byte[] bytes)
{
    return Encoding.ASCII.GetString
           (
              bytes.Select(x => x < 0x20 || x > 0x7E ? (byte)'.' : x)
                   .ToArray()
           );
} 
```

（你可以这样称呼`string printable = byteArray.ToPrintableString();`）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T19:01:35.937

用于`b.ToString("x2")`将字节值格式化为两个字符的十六进制字符串。

对于 ASCII 显示，检查该值是否对应于常规可打印字符，如果是则将其转换：

```
if (b >= 32 && b <= 127) {
   c = (char)b;
} else {
   c = '.';
} 
```

或更短：

```
c = b >= 32 && b <= 127 ? (char)b : '.'; 
```

要在数组上执行此操作：

```
StringBuilder builder = new StringBuilder();
foreach (b in theArray) {
   builder.Append(b >= 32 && b <= 127 ? (char)b : '.');
}
string result = builder.ToString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:01:21.897

这可以是任意数量的编码......试试这个测试测试脚本，看看它们中的哪一个会打印出来：

```
Bl8s 
```

这是脚本：

```
byte[] b = new byte[] {0x42, 0x6C, 0x38, 0x73 };
foreach (EncodingInfo ei in Encoding.GetEncodings())
{
     Console.WriteLine("{0} - {1}", ei.GetEncoding().GetString(b), ei.Name);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-30T00:52:33.087

**[编辑 2018:]**从头开始​​重新编写函数，以提高代码效率并修复其他一些问题。您现在还可以选择指定要显示的起始偏移量和字节数（从那里开始）。

* * *

如果你想要整个内存显示，包括偏移量，左右显示，你可以这样做：（32字节宽度）

```
/// <summary> Returns a String where the specified bytes are formatted in a
/// 3-section debugger-style aligned memory display, 32-bytes per line </summary>
public static unsafe String MemoryDisplay(byte[] mem, int i_start = 0, int c = -1)
{
    if (mem == null)
        throw new ArgumentNullException();
    if (i_start < 0)
        throw new IndexOutOfRangeException();
    if (c == -1)
        c = mem.Length - i_start;
    else if (c < 0)
        throw new ArgumentException();
    if (c == 0)
        return String.Empty;

    char* pch = stackalloc Char[32];       // for building right side at the same time
    var sb = new StringBuilder((c / 32 + 1) * 140);            // exact pre-allocation

    c += i_start;
    for (int i = i_start & ~0x1F; i < c;)
    {
        sb.Append(i.ToString("x8"));
        sb.Append(' ');

        do
        {
            if (i < i_start || i >= c)          // non-requested area, or past the end
            {
                sb.Append("   ");   
                pch[i & 0x1F] = ' ';
            }
            else
            {
                var b = mem[i];
                sb.Append(b.ToString("x2") + " ");
                pch[i & 0x1F] = non_monospace(b) ? '.' : (Char)b;
            }
        }
        while ((++i & 0x1F) != 0);

        sb.Append(' ');
        sb.AppendLine(new String(pch, 0, 32));
    }
    return sb.ToString();
} 
```

该代码使用以下帮助程序来确定哪些字符应在右侧显示为“点”。

```
static readonly ulong[] _nmb =
{
    0x00000000ffffe7ffUL,
    0x8000000000000000UL,
    0x00002000ffffffffUL,
    0x0000000000000000UL,
};

static bool non_monospace(byte b) => (_nmb[b >> 6] & 1UL << b) != 0; 
```

上述函数的输出如下所示（字符宽度为 138 列，向右滚动可看到“人类可读”部分）：

```
00000000 47 49 46 38 39 61 0f 00 0f 00 91 ff 00 00 00 00 c0 c0 c0 ff ff 00 00 00 00 21 f9 04 01 00 00 01 GIF89a....... ……！……
00000020 00 2c 00 00 00 00 0f 00 0f 00 00 02 2c 8c 0d 99 c7 91 02 e1 62 20 5a 79 ea bd 00 6d 89 69 8a f8 .,........,.... ...b Zy...mi。
00000040 08 e5 a7 99 e9 17 9d ac 24 a2 21 68 89 1e ac b4 d9 db 51 ab da c8 8c 1a 05 00 3b ........$.!h......Q... .....;

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T19:01:41.023

尝试：Encoding.Default.GetBytes

如果这不起作用，您可以指定不同的类型（UTF-8、ASCII...）

# c++ - 是否有任何理由使用 C 而不是 C++ 进行嵌入式开发？

> ID：812717
> 
> 赞同：88
> 
> 时间：2009-05-01T18:51:58.893
> 
> 标签：c++, c, embedded, c89

## 问题

我的硬件 C++ 和 C89 上有两个编译器

我正在考虑将 C++ 与类一起使用但没有多态性（以避免 vtables）。我想使用 C++ 的主要原因是：

*   我更喜欢使用“内联”函数而不是宏定义。
*   我想使用名称空间，因为我的前缀会使代码混乱。
*   我认为 C++ 类型更安全，主要是因为模板和详细的转换。
*   我真的很喜欢重载的函数和构造函数（用于自动转换）。

在为非常有限的硬件（4kb 的 RAM）进行开发时，您是否认为有任何理由坚持使用 C89？

## 结论

谢谢你的回答，他们真的很有帮助！

我想通了这个主题，我会坚持使用 C，主要是因为：

1.  用 C 语言预测实际代码更容易，如果您只有 4kb 的内存，这一点非常重要。
2.  我的团队主要由 C 开发人员组成，因此不会经常使用高级 C++ 功能。
3.  我找到了一种在我的 C 编译器 (C89) 中内联函数的方法。

很难接受一个答案，因为您提供了这么多好的答案。不幸的是，我无法创建一个 wiki 并接受它，所以我会选择一个让我思考最多的答案。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-01T20:55:08.223

对于资源*非常*受限的目标（例如 4KB 的 RAM），我会先用一些样本进行测试，然后再投入大量无法轻易移植回纯 ANSI C 实现的工作。

Embedded C++ 工作组确实提出了该语言的标准子集和标准库的标准子集以与之配套。不幸的是，当 C User's Journal 死了时，我忘记了这项工作。看起来[Wikipedia](http://en.wikipedia.org/wiki/Embedded_C%2B%2B)上有一篇文章，并且该[委员会](http://www.caravan.net/ec2plus/)仍然存在。

在嵌入式环境中，您确实必须小心内存分配。为了强制执行这种关心，您可能需要将全局`operator new()`及其朋友定义为甚至无法链接的东西，以便您知道它没有被使用。`new`另一方面，当与稳定、线程安全和延迟保证的分配方案一起明智地使用时，布局可能是您的朋友。

内联函数不会引起太大问题，除非它们足够大以至于它们本来应该是真正的函数。当然，他们替换的宏也有同样的问题。

模板也可能不会导致问题，除非它们的实例化运行异常。对于您确实使用的任何模板，请审核您生成的代码（链接映射可能有足够的线索）以确保仅发生您打算使用的实例化。

可能出现的另一个问题是与调试器的兼容性。其他可用的硬件调试器对与原始源代码交互的支持非常有限，这并不罕见。如果您实际上必须在汇编中进行调试，那么有趣的 C++ 名称修饰可能会给任务增加额外的混乱。

RTTI、动态转换、多重继承、重度多态性和异常都伴随着一些运行时成本。如果使用这些功能，其中一些功能会花费整个程序的成本，其他功能只会增加需要它们的类的权重。了解差异，明智地选择高级功能，至少了解粗略的成本/收益分析。

在小型嵌入式环境中，您将直接链接到实时内核或直接在硬件上运行。无论哪种方式，您都需要确保您的运行时启动代码正确处理 C++ 特定的启动杂务。这可能就像确保使用正确的链接器选项一样简单，但是由于通常可以直接控制通电复位入口点的源，因此您可能需要对其进行审核以确保它可以完成所有操作。例如，在我工作的一个 ColdFire 平台上，开发工具附带了一个 CRT0.S 模块，该模块具有 C++ 初始化程序，但注释掉了。如果我直接从盒子里使用它，我会被其构造函数根本没有运行过的全局对象所迷惑。

此外，在嵌入式环境中，通常需要在使用硬件设备之前对其进行初始化，如果没有操作系统也没有引导加载程序，那么就是您的代码执行此操作。您需要记住，全局对象的构造函数在调用*之前* `main()`运行，因此您需要修改本地 CRT0.S（或其等效项）以在调用全局构造函数本身*之前完成硬件初始化。*显然，顶峰`main()`为时已晚。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-05-02T16:58:29.937

使用 C 而不是 C++ 的两个原因：

1.  对于很多嵌入式处理器，要么没有 C++ 编译器，要么你必须为此付出额外的代价。
2.  我的经验是，相当大比例的嵌入式软件工程师几乎没有或没有 C++ 经验——要么是因为（1），要么是因为它往往不会被教授电子工程学位——所以最好还是坚持他们知道什么。

此外，原始问题和一些评论都提到了 4 Kb of *RAM*。对于典型的嵌入式处理器，RAM 的数量（大部分）与代码大小无关，因为代码是从闪存​​存储和运行的。

当然，代码存储空间的数量是需要牢记的，但随着市场上出现新的、容量更大的处理器，除了对成本最敏感的项目之外，它不再像过去那样成为问题。

关于将 C++ 的子集用于嵌入式系统：现在有一个[MISRA C++](http://www.misra-cpp.com/)标准，可能值得一看。

**编辑：**另见[这个问题](https://stackoverflow.com/questions/1223710)，它引发了关于嵌入式系统的 C 与 C++ 的辩论。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-01T18:55:53.703

不会。在进行嵌入式开发时，可以避免任何可能导致问题的 C++ 语言特性（运行时多态性、RTTI 等）。有一个嵌入式 C++ 开发人员社区（我记得在旧的 C/C++ 用户日志中阅读了嵌入式开发人员使用 C++ 的专栏），如果选择那么糟糕，我无法想象他们会非常直言不讳。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-05-01T21:22:37.953

[C++ 性能技术报告](http://www.open-std.org/jtc1/sc22/wg21/docs/TR18015.pdf)是这类事情的一个很好的指南。请注意，它有一个关于嵌入式编程问题的部分！

此外，++ 在答案中提到了嵌入式 C++。该标准不是 100% 符合我的口味，但在决定可能放弃 C++ 的哪些部分时，它是一个很好的参考。

在为小型平台编程时，我们禁用异常和 RTTI，避免虚拟继承，并密切关注我们周围存在的虚拟函数的数量。

不过，您的朋友是链接器映射：经常检查它，您会很快发现代码源和静态内存膨胀。

之后，标准的动态内存使用注意事项适用：在您提到的受限环境中，您可能根本不想使用动态分配。有时您可以摆脱用于小型动态分配的内存池，或“基于帧”的分配，您可以在其中预先分配一个块并在以后丢弃整个事情。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-05-01T19:00:14.677

我建议使用 C++ 编译器，但限制您使用 C++ 特定功能。您可以在 C++ 中像 C 一样进行编程（在执行 C++ 时包含 C 运行时，尽管在大多数嵌入式应用程序中您无论如何都不会使用标准库）。

您可以继续使用 C++ 类等，只需

*   限制您对虚拟功能的使用（如您所说）
*   限制您对模板的使用
*   对于嵌入式平台，您需要覆盖 operator new 和/或使用placement new 进行内存分配。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-10-18T02:56:25.400

作为一名固件/嵌入式系统工程师，我可以告诉你们为什么 C 仍然是 C++ 的第一选择的一些原因，是的，我对它们都很流利。

1) 我们开发的一些目标有 64kB 的 RAM 用于代码和数据，所以你必须确保每个字节计数，是的，我已经处理了代码优化以节省 4 个字节，这花了我 2 小时，这就是2008 年。

2) 每个 C 库函数在我们将它们放入最终代码之前都经过审查，因为大小限制，所以我们不希望人们使用除法器（没有硬件除法器，所以需要一个大库），malloc（因为我们没有堆，所有内存都是从 512 字节块中的数据缓冲区分配的，并且必须进行代码审查），或者其他会带来巨大损失的面向对象的做法。请记住，您使用的每个库函数都会计数。

3) 听说过覆盖这个词吗？你的代码空间太小了，有时你不得不用另一组代码交换东西。如果调用库函数，则库函数必须是常驻的。如果只在覆盖函数中使用它，那么依赖于太多面向对象的方法会浪费大量空间。所以，不要假设任何 C 库函数，更不用说 C++ 被接受了。

4) 由于有限的硬件设计（即以某种方式连接的 ECC 引擎）或应对硬件错误，需要进行强制转换甚至打包（未对齐的数据结构跨越字边界）。您不能隐含地假设太多，那么为什么要过多地面向对象呢？

5) 最坏情况：消除一些面向对象的方法将迫使开发人员在使用可能爆炸的资源之前进行思考（即在堆栈上而不是从数据缓冲区中分配 512 字节），并防止一些潜在的最坏情况没有一起测试或消除整个代码路径。

6）我们确实使用了很多抽象来使硬件与软件隔离，并使代码尽可能可移植，并且模拟友好。硬件访问必须包装在宏或内联函数中，这些函数在不同平台之间有条件地编译，数据类型必须转换为字节大小而不是特定于目标，不允许直接使用指针（因为某些平台假设内存映射 I/O 是与数据存储器相同）等。

我可以想到更多，但你明白了。我们固件人员确实接受过面向对象的培训，但嵌入式系统的任务可能是如此面向硬件和低级，以至于它本质上不是高级或抽象的。

顺便说一句，我从事的每一项固件工作都使用源代码控制，我不知道你从哪里得到这个想法。

- 来自 SanDisk 的一些固件专家。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-05-01T18:55:26.187

我听说有些人更喜欢 C 用于嵌入式工作，因为它更简单，因此更容易预测将生成的实际代码。

我个人认为编写 C 风格的 C++（使用模板进行类型安全）会给你带来很多好处，但我看不出有什么真正的理由不这样做。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2010-03-15T12:07:03.037

> 我个人的偏好是 C，因为：
> 
> *   我知道每一行代码在做什么（和成本）
> *   我不太了解 C++，无法知道每一行代码在做什么（以及成本）

为什么人们会这样说？除非您检查 asm 输出，否则您*不*知道 C 的每一行都在做什么。C++ 也是如此。

例如，这个无害的语句会产生什么 asm：

```
a[i] = b[j] * c[k]; 
```

它看起来很无辜，但是基于 gcc 的编译器为 8 位微控制器生成了这个 asm

```
CLRF 0x1f, ACCESS
RLCF 0xfdb, W, ACCESS
ANDLW 0xfe
RLCF 0x1f, F, ACCESS
MOVWF 0x1e, ACCESS
MOVLW 0xf9
MOVF 0xfdb, W, ACCESS
ADDWF 0x1e, W, ACCESS
MOVWF 0xfe9, ACCESS
MOVLW 0xfa
MOVF 0xfdb, W, ACCESS
ADDWFC 0x1f, W, ACCESS
MOVWF 0xfea, ACCESS
MOVFF 0xfee, 0x1c
NOP
MOVFF 0xfef, 0x1d
NOP
MOVLW 0x1
CLRF 0x1b, ACCESS
RLCF 0xfdb, W, ACCESS
ANDLW 0xfe
RLCF 0x1b, F, ACCESS
MOVWF 0x1a, ACCESS
MOVLW 0xfb
MOVF 0xfdb, W, ACCESS
ADDWF 0x1a, W, ACCESS
MOVWF 0xfe9, ACCESS
MOVLW 0xfc
MOVF 0xfdb, W, ACCESS
ADDWFC 0x1b, W, ACCESS
MOVWF 0xfea, ACCESS
MOVFF 0xfee, 0x18
NOP
MOVFF 0xfef, 0x19
NOP
MOVFF 0x18, 0x8
NOP
MOVFF 0x19, 0x9
NOP
MOVFF 0x1c, 0xd
NOP
MOVFF 0x1d, 0xe
NOP
CALL 0x2142, 0
NOP
MOVFF 0x6, 0x16
NOP
MOVFF 0x7, 0x17
NOP
CLRF 0x15, ACCESS
RLCF 0xfdf, W, ACCESS
ANDLW 0xfe
RLCF 0x15, F, ACCESS
MOVWF 0x14, ACCESS
MOVLW 0xfd
MOVF 0xfdb, W, ACCESS
ADDWF 0x14, W, ACCESS
MOVWF 0xfe9, ACCESS
MOVLW 0xfe
MOVF 0xfdb, W, ACCESS
ADDWFC 0x15, W, ACCESS
MOVWF 0xfea, ACCESS
MOVFF 0x16, 0xfee
NOP
MOVFF 0x17, 0xfed
NOP 
```

产生的指令数量很大程度上取决于：

*   a、b 和 c 的大小。
*   这些指针是存储在堆栈上还是全局的
*   i、j 和 k 是在堆栈上还是全局的

在微型嵌入式世界中尤其如此，处理器没有设置为处理 C。所以我的答案是 C 和 C++ 彼此一样糟糕，除非你总是检查 asm 输出，在这种情况下它们彼此一样好。

雨果

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-05-01T18:57:56.647

我认为没有理由使用 C 而不是 C++。无论您在 C 中可以做什么，您也可以在 C++ 中完成。如果您想避免 VMT 的开销，请不要使用虚拟方法和多态性。

但是，C++ 可以提​​供一些非常有用的惯用语，而无需任何开销。我的最爱之一是 RAII。就内存或性能而言，类不一定很昂贵......

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-05-01T19:06:20.903

我在 IAR Workbench 上为 ARM7 嵌入式平台编写了一些代码。我强烈建议依靠模板进行编译时优化和路径预测。避免像瘟疫一样的动态投射。正如 Andrei Alexandrescu 的《[现代 C++ 设计](http://books.google.com/books?id=aJ1av7UFBPwC&dq=Alexandrescu&printsec=frontcover&source=bl&ots=YQeEYnSiaX&sig=LwiUJcfTbxjYOztpFVGIo5H2rTE&hl=en&ei=1Uf7SbSUBJX2MIbzobgE&sa=X&oi=book_result&ct=result&resnum=4)》一书中所述，使用特征/策略对您有利。

我知道，这可能很难学习，但我也确信您的产品将从这种方法中受益。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-05-01T18:58:13.153

一个很好的理由，有时是唯一的理由是仍然没有针对特定嵌入式系统的 C++ 编译器。例如，[Microchip PIC](http://www.microchip.com/)微控制器就是这种情况。它们很容易编写，并且有一个免费的 C 编译器（实际上是 C 的一个轻微变体），但看不到 C++ 编译器。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-05-01T20:23:22.463

对于受限于 4K 内存的系统，我会使用 C，而不是 C++，这样您就可以确保看到正在发生的一切。C++ 的问题在于，它使用更多的资源（CPU 和内存）比看代码要容易得多。（哦，我将创建另一个 BlerfObject 来执行此操作……哎呀！内存不足！）

如前所述，您可以在 C++ 中执行此操作（没有 RTTI、没有 vtables 等），但是您将花费尽可能多的时间来确保您的 C++ 使用不会像在 C 中执行等效操作那样远离您.

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2012-12-16T00:25:38.653

人类的大脑通过尽可能多地评估来处理复杂性，然后决定关注什么是重要的，然后丢弃或贬低其余的。这是营销中品牌化背后的全部基础，主要是图标。

为了对抗这种趋势，我更喜欢 C 而不是 C++，因为它迫使你思考你的代码，以及它如何更紧密地与硬件交互 - 无情地接近。

从长期的经验来看，我相信 C 会迫使你想出更好的问题解决方案，部分原因是不妨碍你，而不是强迫你浪费大量时间来满足一些编译器编写者认为是个好主意的约束，或弄清楚“幕后”发生了什么。

在这种情况下，像 C 这样的低级语言让你花大量时间专注于硬件和构建良好的数据结构/算法包，而高级语言让你花很多时间摸不着头脑想知道那里发生了什么，以及为什么你不能在你的特定上下文和环境中做一些完全合理的事情。打败你的编译器（强类型是最严重的违规者）并不是对时间的有效利用。

我可能很适合程序员的模具——我喜欢控制。在我看来，这不是程序员的人格缺陷。控制是我们得到报酬的事情。更具体地说，完美的控制。C 比 C++ 给你更多的控制权。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-05-01T20:59:26.153

就我个人而言，拥有 4kb 的内存，我会说你并没有从 C++ 中获得更多的里程，所以只需选择一个看起来最适合这项工作的编译器/运行时组合，因为语言可能并不重要。

请注意，这也不仅仅是关于语言，因为图书馆也很重要。通常 C 库的最小大小略小，但我可以想象针对嵌入式开发的 C++ 库被缩减了，所以一定要进行测试。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-05-01T19:18:49.670

> 在为非常有限的硬件（4kb 的 RAM）进行开发时，您是否认为有任何理由坚持使用 C89？

就个人而言，当谈到嵌入式应用程序时（当我说嵌入式时，我并不是指 winCE、iPhone 等。今天臃肿的嵌入式设备）。我的意思是资源有限的设备。我更喜欢 C，尽管我也使用过很多 C++。

例如，您正在谈论的设备具有**4kb**的 RAM，因此我不会考虑使用 C++。当然，您可以使用 C++ 设计一些小的东西，并像其他帖子所建议的那样限制您在应用程序中的使用，但 C++“可能”最终可能使您的应用程序在幕后变得复杂/臃肿。

你要静态链接吗？您可能想比较使用 c++ 与 c 的静态虚拟应用程序。这可能会导致您改为考虑 C。另一方面，如果您能够在内存需求范围内构建 C++ 应用程序，那就去做吧。

恕我直言，总的来说，在嵌入式应用程序中，我喜欢了解正在发生的一切。谁在使用内存/系统资源，多少以及为什么？他们什么时候释放他们？

在为具有 X 数量的资源、cpu、内存等的目标进行开发时。我尽量保持在使用这些资源的较低端，因为您永远不知道未来会出现什么需求，因此您需要向项目中添加更多代码“应该”是一个简单的小应用程序，但最终变得更大。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-05-01T19:56:09.317

C 在可移植性方面获胜——因为它在语言规范中不那么模棱两可；因此在不同的编译器等方面提供了更好的可移植性和灵活性（减少了麻烦）。

如果您不打算利用 C++ 功能来满足需求，那么请使用 C。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-05-02T17:25:08.017

我的选择通常由我们决定使用的 C 库决定，它是根据设备需要做什么来选择的。所以，9/10 次.. 它最终是 uclibc 或 newlib 和 C。我们使用的内核对此也有很大的影响，或者如果我们正在编写自己的内核。

它也是共同点的选择。大多数优秀的 C 程序员在使用 C++ 时都没有问题（尽管许多人在使用 C++ 的过程中一直抱怨）.. 但我还没有发现相反的情况（根据我的经验）。

在我们正在处理的一个项目中（涉及一个全新的内核），大多数事情都是用 C 完成的，但是一个小的网络堆栈是用 C++ 实现的，因为使用 C++ 实现网络更容易而且问题更少。

最终结果是，该设备要么工作并通过验收测试，要么不会。如果您可以使用语言 z 在 xx 堆栈和 yy 堆约束中实现 foo，那就去做吧，使用任何让您更有效率的东西。

我个人的偏好是 C，因为：

*   我知道每一行代码在做什么（和成本）
*   我不太了解 C++，无法知道每一行代码在做什么（以及成本）

是的，我对 C++ 很满意，但我对它的了解不如标准 C。

现在，如果您可以反过来说，那么，使用您所知道的 :) 如果它有效，通过测试等.. 有什么问题？

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-05-22T07:17:13.283

你有多少 ROM/FLASH？

4kB 的 RAM 仍然意味着有数百 KB 的 FLASH 来存储实际代码和静态数据。这种大小的 RAM 往往仅用于变量，如果您对这些变量小心，您可以将相当大的程序在代码行方面放入内存中。

然而，由于对象的运行时构造规则，C++ 倾向于使将代码和数据放入 FLASH 中更加困难。在 C 中，常量结构可以很容易地放入 FLASH 内存并作为硬件常量对象访问。在 C++ 中，常量对象需要编译器在编译时评估构造函数，我认为这仍然超出了 C++ 编译器的能力（理论上，你可以做到，但实际上很难做到） .

因此，在“小型 RAM”、“大型 FLASH”这种环境中，我随时都会使用 C。请注意，C99 是一个很好的中间选择，它具有非基于类的代码的大部分优秀 C++ 特性。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-01-27T17:40:29.690

只想说没有“无限”资源的系统。这个世界上的一切都是有限的，每个应用程序都应该考虑资源使用，无论是 ASM、C、JAVA 还是 JavaScript。分配几 Mbs “只是为了确定” 的假人使 iPhone 7、Pixel 和其他设备非常笨拙。无论您有 4kb 还是 40 Gb。

但从另一方面反对资源浪费——是需要时间来节省那些资源。如果用 C 语言编写一个简单的东西来节省几个滴答声和几个字节，而不是使用已经实现、测试和分发的 C++ 需要多花 1 周的时间。何苦？这就像购买一个 USB 集线器。是的，你可以自己做，但会更好吗？更可靠？如果你计算时间更便宜？

只是一个侧面的想法 - 即使您的插座的电源也不是无限的。尝试研究它的来源，你会发现它主要来自燃烧的东西。能量和物质定律仍然有效：没有物质或能量出现或消失，而是在变化。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-05-01T18:57:54.590

一般来说没有。C++ 是 C 的超级集合。对于新项目尤其如此。

您在避免 C++ 构造方面走在正确的轨道上，这些构造在 cpu 时间和内存占用方面可能很昂贵。

请注意，像多态这样的一些东西可能非常有价值——它们本质上是函数指针。如果您发现需要它们，请明智地使用它们。

此外，良好的（精心设计的）异常处理可以使您的嵌入式应用程序比处理带有传统错误代码的应用程序更可靠。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-05-01T19:08:57.790

对于内存分配问题，我可以推荐使用 Quantum Platform 及其状态机方法，因为它会在初始化时分配您需要的所有内容。它还有助于缓解争用问题。

该产品可在 C 和 C++ 上运行。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-05-01T19:09:23.000

有人说 C 编译器可以生成更高效的代码，因为它们不必支持高级 C++ 特性，因此可以更积极地进行优化。

当然，在这种情况下，您可能希望对两个特定的编译器进行测试。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-05-01T19:41:04.157

恕我直言，选择 C ​​的唯一原因是，如果您的平台的 C++ 编译器状态不佳（错误、优化不佳等）。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-05-01T20:53:12.643

您在 C99 中有内联。也许你喜欢 ctors，但让 dtors 正确的业务可能会很混乱。如果剩下的不使用 C 的唯一原因是命名空间，我真的会坚持使用 C89。这是因为您可能希望将其移植到稍微不同的嵌入式平台。您稍后可能会开始使用 C++ 编写相同的代码。但是请注意以下内容，其中 C++ 不是 C 的超集。我知道您说您有一个 C89 编译器，但是无论如何都要将 C++ 与 C99 进行比较，因为例如第一项对于自 K&R 以来的任何 C 都是正确的。

**sizeof 'a'** > 1 在 C 中，而不是在 C++ 中。在 C 中，您有 VLA 可变长度数组。示例：**func(int i){int a[i]**。在 C 中，您有 VAM 变量数组成员。示例：**struct{int b;int m[];}**。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-05-02T09:40:47.370

这取决于编译器。

并不是所有的嵌入式编译器都实现了所有的 C++，即使他们实现了，它们也可能不擅长避免代码膨胀（这对于模板来说总是一个风险）。使用一些较小的程序对其进行测试，看看是否遇到任何问题。

但是给定一个*好的*编译器，不，没有理由不使用 C++。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-22T07:21:52.853

针对问题的不同方面的不同答案帖子：

“malloc”

之前的一些回复对此进行了相当多的讨论。为什么你甚至认为这个电话存在？对于一个真正的小平台，malloc 往往不可用，或者绝对是可选的。当您的系统底部有一个 RTOS 时，实现动态内存分配往往是有意义的——但在那之前，这纯粹是危险的。

没有它你可以走得很远。想想那些甚至没有适当的局部变量堆栈的旧 FORTRAN 程序......

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-10-26T06:11:04.190

全球有许多不同的控制器制造商，当您查看他们的设计和需要用于配置的指令集时，您可能会遇到很多麻烦。汇编语言的主要缺点是依赖于机器/架构。对于开发人员来说，为了完成不同控制器的编码而将所有说明都牢记在心，这确实是一个巨大的要求。这就是为什么 C 在嵌入式开发中变得更受欢迎的原因，因为 C 足够高级，可以从依赖于硬件的细节中抽象出算法和数据结构，使源代码可跨各种目标硬件、体系结构独立的语言移植，并且非常容易转换和维护代码。但我们确实看到了一些高级语言（面向对象），如 C、C++、Python、Java 等。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-05-24T09:34:48.617

我推荐带有限制和注释的 C++。

1.  **上市时间和可维护性。**C++ 开发更加简单快捷。因此，如果您处于设计阶段，请选择一个足以使用 C++ 的控制器。（请注意，一些大批量市场需要尽可能低的成本，而您无法做出此选择。）

2.  **速度。**C 可以比 C++ 更快，但请确保速度增益不大。因此，您可以使用 C++。开发您的算法，测试它们，并仅在需要时使它们更快（！）。使用分析器，指出瓶颈并以*外部“C”*方式重写它们，以实现 C 速度。（如果在 ASM 中实现该部分仍然很慢）

3.  **二进制大小。**C ++代码更大，但这是一个[很好的答案](https://softwareengineering.stackexchange.com/a/246181/280606)，可以说明细节。无论是使用 C 编译器还是 C++ 编译器编译，给定 C 代码的编译二进制文件的大小都是相同的。*“可执行文件的大小几乎与语言无关，而与项目中包含的库有关。”* 使用 C++ 但避免使用高级功能，如`streams`, `string`, `new`,`virtual`函数等。由于大小限制（基于[此](https://stackoverflow.com/a/1583862/2506522)答案） ，请在将它们放入最终代码之前查看所有库函数

* * *

## 回答 #29

> 赞同：-6
> 
> 时间：2009-05-26T18:10:34.500

在这样一个有限的系统上。就去汇编吧。让您完全控制各个方面，并且不会产生任何开销。

可能也快得多，因为许多嵌入式编译器不是最好的优化器（特别是如果将它与最先进的编译器进行比较，比如我们的桌面编译器（英特尔、Visual Studio 等））

“是的，是的……但是 c 是可重复使用的并且……”。在这样一个有限的系统上，您可能不会在不同的系统上重用大部分代码。在同一系统上，汇编器同样可重用。

# javascript - Problem with calendar script

> ID：812725
> 
> 赞同：0
> 
> 时间：2009-05-01T18:53:06.287
> 
> 标签：javascript

Calendar displays some weird dates. Rhe month date is supposed to start at friday but starts on tuesday: [http://img515.imageshack.us/img515/2927/cal.jpg](http://img515.imageshack.us/img515/2927/cal.jpg).

```
<SCRIPT LANGUAGE="JavaScript"> 
            monthnames = new Array("January","Februrary","March","April","May","June","July","August","September","October","November","December"); 
            var linkcount=0; 
            function addlink(month, day, href) 

                { 
                var entry = new Array(3); 
                entry[0] = month; 
                entry[1] = day; 
                entry[2] = href; 
                this[linkcount++] = entry; 
                } 
                Array.prototype.addlink = addlink; 
                linkdays = new Array(); 
                monthdays = new Array(12);
                monthdays[0]=31; 
                monthdays[1]=28; 
                monthdays[2]=31; 
                monthdays[3]=30; 
                monthdays[4]=31; 
                monthdays[5]=30; 
                monthdays[6]=31; 
                monthdays[7]=31; 
                monthdays[8]=30;
                monthdays[9]=31; 
                monthdays[10]=30;
                monthdays[11]=31;
                todayDate=new Date(); 
                thisday=todayDate.getDay(); 
                thismonth=todayDate.getMonth(); 
                thisdate=todayDate.getDate(); 
                thisyear=todayDate.getYear(); 
                thisyear = thisyear % 100; 
        thisyear = ((thisyear < 50) ? (2000 + thisyear) : (1900 + thisyear)); 
    if (((thisyear % 4 == 0) && !(thisyear % 100 == 0)) || (thisyear % 400 == 0)) 
                { 
                monthdays[0]++; 
                } 
                startspaces=thisdate; 
                while (startspaces > 7) 
                { 
                startspaces-=7; 
                startspaces = thisday - startspaces + 1; 
                } 
                while (startspaces < 0) {
                startspaces += 7;

                } 

                document.write("<table border=1 bgcolor=white "); 
                document.write("bordercolor=black><font color=black>"); 
                document.write("<tr><td colspan=7><center><strong>" + monthnames[thismonth] + " " + thisyear + "</strong></center></font></td></tr>");                                  document.write("<tr>"); 
                document.write("<td align=center>Su</td>"); 
                document.write("<td align=center>M</td>"); 
                document.write("<td align=center>Tu</td>"); 
                document.write("<td align=center>W</td>"); 
                document.write("<td align=center>Th</td>"); 
                document.write("<td align=center>F</td>"); 
                document.write("<td align=center>Sa</td>"); 
                document.write("</tr>"); 
                document.write("<tr>"); 
                for (s=0;s<startspaces;s++) 
                {
                document.write("<td> </td>"); 
                }
                count=1; 
                while (count <= monthdays[thismonth]) 
                { 
                for (b = startspaces;b<7;b++) 

                { 
                linktrue=false; 
                document.write("<td>"); 
                for (c=0;c<linkdays.length;c++) 

                { 
                if (linkdays[c] != null) 

                { 
                if ((linkdays[c][0]==thismonth + 1) && (linkdays[c][2]==count)) 
                { 
                document.write("<a href=\"" + linkdays[c][2] + "\">"); linktrue=true; 
                } 
                } 
                } 
                if (count==thisdate) 
                { 
                document.write("<font color='FF0000'><strong>");
                } 
                if (count <= monthdays[thismonth]) 
                { document.write(count);
                } 
                else { document.write(" ");
                } 
                if (count==thisdate) 
                { document.write("</strong></font>"); 
                } 
                if (linktrue) { document.write("</a>"); 
                }
                document.write("</td>"); count++; 
                } 
                document.write("</tr>"); 
                document.write("<tr>"); 
                startspaces=0; 
                } 
                document.write("</table></p>"); 
</SCRIPT> 
```

I can't seem to follow the code because I'm just new with javascript and programming, got this code from here: [http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=2608&lngWId=2](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=2608&lngWId=2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:18:05.977

The calculations in this code are just plain **wrong**. I suggest you don't bother fixing it. Instead, use a reliable calendar that is widely used like the [jQuery UI datepicker](http://jqueryui.com/demos/datepicker/)

# javascript - （jQuery）滚动事件..如果用户滚动页面，我想将文档滚动到指定的点

> ID：812728
> 
> 赞同：3
> 
> 时间：2009-05-01T18:53:41.930
> 
> 标签：javascript, jquery

我想实现一个滚动功能。所以滚动的默认值是禁用的。如果用户使用滚动按钮，我希望将其设置为我想要的点。我该如何实现这个功能？window.scrollTop 不工作..我尝试了很多不同的方法，但都没有工作..

```
$(window).scroll(function () {
    $(body).scrollTop = 3000px;
}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T18:59:15.570

该`scrollTop`属性只接受一个整数（不是像素）。省略`px`应该没问题。

```
$(window).scroll(function() {
    $('body').get(0).scrollTop = 3000; // note that this does only work if body has overflow
    // if it hasn't, use window instead
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T18:58:42.730

有一个名为 ScrollTo 的 JQuery 插件可以完全满足您的需要。

在这里查看：http: [//plugins.jquery.com/project/ScrollTo](http://plugins.jquery.com/project/ScrollTo)

# linq-to-sql - 一个通用（edmx./.dbml）还是多个取决于域、功能等标准？

> ID：812731
> 
> 赞同：0
> 
> 时间：2009-05-01T18:55:07.077
> 
> 标签：linq-to-sql, orm, linq-to-entities

您是否有一个巨大的 linq to sql DBML 或 Linq to entity .EDMX 文件/命名空间或许多文件/命名空间在逻辑上分开？

例如，在 db 模式中，如果您有 3 个子模式，例如（Audit 和 UserMgmt）、Human Resource、Sales ..您会将它们分开吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:13:42.257

将表/实体保留在同一个 DBML 中的唯一充分理由是它们是否具有您需要能够导航的关系。

如果域不相关，保留单独的 DBML 将使事情变得更容易（设计者很快就会变得糟糕）。

更重要的是，两个域可能共享表，但这并不意味着您应该将它们都放在同一个模型中。如果它们的使用是分开的，请将它们分开（用户是一个表，可能仅在多个域中用作参考，并且仅在彼此中编辑，因此为每个域保留一个用户实体可能完全有意义以减少过载）。

# c# - 反序列化经过验证的 XML 时出现问题，无法与数组相互转换

> ID：812739
> 
> 赞同：2
> 
> 时间：2009-05-01T18:56:58.553
> 
> 标签：c#, xml, xsd, serialization, xsd.exe

我有点不合时宜。我使用 xsd.exe 从 xml 文件创建 xsd 架构，然后从该 xsd 创建 C# 类。这一切似乎都很好。

目前我只是想让 XML 反序列化。如果我最初用于构建类的文件与我正在反序列化的文件相同。这是我的代码：

```
String xsdPath=@"C:\Users\tol56881\Documents\dnd4e.xsd";
String xmlPath=@"C:\Users\tol56881\Documents\dnd4e.xml";
String xsdNamespace="";

//Validation stuff
XmlParserContext context = new XmlParserContext(null, null, "", XmlSpace.None);
XmlValidatingReader vr = new XmlValidatingReader(xmlPath, XmlNodeType.Element, context);
vr.ValidationType = ValidationType.Schema;
vr.Schemas.Add(xsdNamespace, xsdPath);
while (vr.Read()) ;

//Actually reading the file
TextReader tr = new StreamReader(xmlPath);
D20Character character = (D20Character)(new XmlSerializer(typeof(D20Character))).Deserialize(tr); 
```

它编译得很好，但是当我尝试运行它时，我得到了一个针对四个不同对象重复的错误。我在下面给出了一个示例，更改了对象的名称。

```
Unable to generate a temporary class (result=1).
error CS0030: Cannot convert type 'Namespace.ObjectName[]' to 'Namespace.ObjectName'
error CS0029: Cannot implicitly convert type 'Namespace.ObjectName' to 'Namespace.ObjectName[]' 
```

所以看起来程序正试图从数组到对象再回到数组，但我不太确定。自动生成的类代码是一团乱麻，很难通过。我希望这里可能缺少一些简单的东西。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T19:21:43.673

我设法解决了这个问题。所讨论的四个对象中的每一个都生成为双索引数组，例如：

```
 private loot[][] lootTallyField; 
```

和

```
 public loot[][] LootTally
    {
        get
        {
            return this.lootTallyField;
        }
        set
        {
            this.lootTallyField = value;
        }
    } 
```

我所做的只是删除了一组括号，这一切似乎都运行良好。反序列化没有问题，并且对反序列化对象的快速检查使其看起来数据已正确加载。

```
 private loot[] lootTallyField; 
```

和

```
 public loot[] LootTally
    {
        get
        {
            return this.lootTallyField;
        }
        set
        {
            this.lootTallyField = value;
        }
    } 
```

仍然不确定为什么 xsd.exe 如果它们不应该是双索引的话。我觉得我仍然缺少一些东西，因此为什么这个问题仍然存在。

特别是，如果我需要重新生成此代码，那么我需要重新应用修复程序，这首先违背了使用部分类的目的......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-05-23T22:13:58.333

xsd.exe工具有问题，我会尽力解释。

如果您有一个带有序列的 complexType，其中有一个带有序列的子 complexType，并且第一个没有任何其他元素/属性，那么生成的类将只有 1 个生成类型，而不是 2，它将是一个 double大批。

如果你将双数组变成一个数组，你将能够很好地反序列化你的 xml。但是，这将产生以下意外结果。如果您的 xml 如下所示。

```
<root>
    <loot>
        <tally>value1</tally>
        <tally>value2</tally>
    </loot>
    <loot>
        <tally>value3</tally>
        <tally>value4</tally>
    </loot>
</root> 
```

然后你的反序列化对象，在 lootTally 数组中将只包含 value3 和 value4 项目，而不是全部 4。

因此，您有 2 个选项可以正确解决此问题：

1.  通过在第一个序列中添加一个 dummy 来更改 xsd 文件，然后再次运行 xsd.exe，以便在生成类时不会创建双精度数组，然后您可以从类中删除 dummy 属性。
2.  更改生成的类，添加一个名为 loot 的新类，它将包含您已经拥有的一系列计数对象（并且只需要更改名称）。

请注意，在选项 2 中，如果您将 XmlArrayItemAttribute 更改为 XmlElementAttribute，您可能必须更改一些声明。

希望这可以帮助

# oracle - JSF Faces Bridge get java.lang.NullPointerException when deploying to oc4j container

> ID：812740
> 
> 赞同：4
> 
> 时间：2009-05-01T18:57:00.177
> 
> 标签：oracle, jsf, portlet, oracle-adf

I am running JDeveloper 10.1.3.4 with the webcenter pre-configured oc4j. I'm trying to portletize a vanilla JSF webcenter project.

1.  I create a application using the webcenter application template.
2.  Add a JSF JSP, simple called it index with all the default values.
3.  Add a deployment profile and deploy to local oc4j
4.  navigate to the jsf page and everything works.
5.  right click on ViewController and add the library Portlet Faces Bridge
6.  right click on ViewController and add a Portlet Deployment descriptor.
7.  Edit portlet.xml with the values from [link text](http://download.oracle.com/docs/cd/E12524_01/webcenter.1013/e12434/jpsdg_java_adv.htm#BABBFDHA)

8.  in portlet.xml i replace the Default page view with my /index.jspx

    when i try to deploy to local oc4j i get the follow

> ---- Deployment started. ---- May 1, 2009 2:29:37 PM Target platform is Standalone OC4J 10g 10.1.3 (localAppServer). Wrote WAR file to C:\jdevstudio10134\jdev\mywork\test\ViewController\deploy\webapp2.war Wrote EAR file to C:\jdevstudio10134\jdev\mywork\test\ViewController\deploy\webapp2.ear Backing up generic archive file :/C:/jdevstudio10134/jdev/mywork/test/ViewController/deploy/webapp2_generic.ear Creating WSDLs for the WSRP Application WSDLs for the WSRP Application have been created Uploading file webapp2.ear ... Uploading file webapp2.ear ... Application Deployer for webapp2 STARTS. Copy the archive to C:\jdevstudio10134\j2ee\home\applications\webapp2.ear Initialize C:\jdevstudio10134\j2ee\home\applications\webapp2.ear begins... Unpacking webapp2.ear Done unpacking webapp2.ear Unpacking webapp2.war Done unpacking webapp2.war Initialize C:\jdevstudio10134\j2ee\home\applications\webapp2.ear ends... Starting application : webapp2 Initializing ClassLoader(s) application : webapp2 is in failed state Operation failed with error: java.lang.NullPointerException
> 
> Deployment failed Elapsed time for deployment: 3 seconds
> 
> Deployment incomplete. #### May 1, 2009 2:29:40 PM

if i deploy the WAR file by hand and navigate to the page i get 500 internal server error.

> 09/05/01 14:49:21.984 webapp2: Servlet error java.lang.NullPointerException at com.sun.faces.context.ExternalContextImpl.dispatch(ExternalContextImpl.java:346) at com.sun.faces.application.ViewHandlerImpl.renderView(ViewHandlerImpl.java:152) at oracle.portlet.server.bridges.jsf.PortletViewHandlerImpl.renderView(PortletViewHandlerImpl.java:73) at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:107) at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:268) at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:137) at javax.faces.webapp.FacesServlet.service(FacesServlet.java:214) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.ServletRequestDispatcher.invoke(ServletRequestDispatcher .java:713) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.ServletRequestDispatcher.forwardInternal(ServletRequestDispatcher .java:370) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.HttpRequestHandler.doProcessRequest(HttpRequestHandler .java:871) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.HttpRequestHandler.processRequest(HttpRequestHandler .java:453) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.HttpRequestHandler.serveOneRequest(HttpRequestHandler .java:221) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.HttpRequestHandler.run(HttpRequestHandler.java:122) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].server.http.HttpRequestHandler.run(HttpRequestHandler.java:111) at oracle.oc4j.network.ServerSocketReadHandler$SafeRunnable.run(ServerSocketReadHandler.java:260) at com.evermind[Oracle Containers for J2EE 10g (10.1.3.4.0) ].util.ReleasableResourcePooledExecutor$MyWorker.run(ReleasableResourcePooledExecutor .java:303) at java.lang.Thread.run(Thread.java:595)

My portlet.xml file looks like

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<portlet-app version="1.0" xsi:schemaLocation="http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd">
 <portlet> 
     <description>myapp</description> 
     <portlet-name>test</portlet-name> 
     <display-name>myapp</display-name> 
     <portlet-class>oracle.portlet.server.bridges.jsf.FacesPortlet 
     </portlet-class> 
     <init-param> 
      <name>DefaultPage.view</name>
      <value>/index.jspx</value>
     </init-param> 
     <init-param> 
      <name>BridgeLifecycleListeners</name>
      <value>
       oracle.portlet.server.bridges.jsf.adf.ADFFacesBridgeLifecycleListener,
       oracle.portlet.server.bridges.jsf.adf.BindingFacesBridgeLifecycleListener
      </value>
     </init-param> 
    <supports> 
     <mime-type>text/html</mime-type> 
     <portlet-mode>VIEW</portlet-mode> 
     </supports> 
     <supported-locale>en</supported-locale> 
     <portlet-info> 
      <title>myapp</title> 
      <short-title>test</short-title> 
     </portlet-info> 
   </portlet> 
</portlet-app> 
```

...if i delete the file and redeploy the jspx page works fine.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-02T17:47:23.060

你应该转移到使用比 oc4j 好得多的 wls 的 jdev 11g

# c - c、使用struct的问题

> ID：812744
> 
> 赞同：2
> 
> 时间：2009-05-01T18:57:24.060
> 
> 标签：c, struct

我正在尝试编写一个从外部文件（字符串字符串 int，每行）读取文本的程序。结构在主函数之外定义：

```
typedef struct Person {
  char fname[15];
  char lname[20];
  unsigned long int birth;
} clovek; 
```

我不需要“clovek”作为数组，因为每一行数据都可以被覆盖。线为红色以缓冲：

```
fgets(buffer, 50, datafile); 
```

然后我想将它解析为结构，但这就是我的问题出现的地方：

```
int i = 0;
while (buffer[i] != ' ') {
  clovek.fname[i] = buffer[i];
  i++;
} 
```

这给了我一个错误：expected identifier or '(' before '.' token

我也想使用这段代码进行调试，但它也给出了另一个错误：

```
printf("fname, %s\n", clovek.fname); 
```

错误：“clovek”之前的预期表达式

我的猜测是我完全误解了结构的使用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T19:00:30.043

`clovek`是 的别名`struct Person`。要么删除关键字，要么在代码中的某处`typedef`创建一个类型的对象。`struct Person`使用当前代码，您可以执行以下操作：

```
clovek someone;

while (buffer[ i ] ) != ' ') {
    someone.fname[ i ] = buffer[ i ];
/* .. */ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T19:00:18.950

您的语句将 clovek 定义为结构 Person 的别名。

从声明中删除“typedef”。这样，clovek 就变成了 Person 类型的变量：

或者更好的是，将结构声明与变量声明分开：

```
struct Person {
  char fname[15];
  char lname[20];
  unsigned long int birth;
};

struct Person clovek; 
```

# visual-studio - Is there a Windows equivalent of EDQUOT?

> ID：812745
> 
> 赞同：2
> 
> 时间：2009-05-01T18:57:33.827
> 
> 标签：visual-studio, visual-studio-2005, msvcrt, errno

I'm porting some C++ code from UNIX to Windows which detects the occurrence of the EDQUOT error, which indicates that there was an unsuccessful attempt to exceed the current user's disk quota. Visual Studio's <errno.h> doesn't have an EDQUOT, although I know that Windows has disk quota functionality. Visual Studio's <errno.h> *does* have an ENOSPC, which might be how the CRT expresses what UNIX would express as EDQUOT. Can anybody confirm or deny this theory? And if this isn't the way to handle this, what is?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-07T11:10:18.590

C:\Program Files\Microsoft SDKs\Windows\v7.0A\Include\WinSock.h

C:\Program Files\Microsoft SDKs\Windows\v7.1\Include\WinSock.h

```
#if 0
#define EDQUOT                  WSAEDQUOT
#endif 
```

C:\Program Files\Microsoft SDKs\Windows\v7.0A\Include\WinError.h

C:\Program Files\Microsoft SDKs\Windows\v7.1\Include\WinError.h

```
//
// MessageId: WSAEDQUOT
//
// MessageText:
//
// Ran out of disk quota.
//
#define WSAEDQUOT                        10069L 
```

# c# - 带向导的 DataTable Select()

> ID：812748
> 
> 赞同：1
> 
> 时间：2009-05-01T18:57:59.440
> 
> 标签：c#, .net-3.5, datatable, guid

我试图在运行时从 LINQ 查询返回的 DataTable 中煮沸我的树视图。返回的字段是：

名称 = CaseNoteID | 联系日期 | ParentNote 类型 = 指导 | 日期时间 | 指导

ParentNote 字段与 CaseNoteID 列中的条目匹配。Select(filter) 给了我***找不到列 [ea8428e4] 的运行时错误。***该字母数字是其中一个指南的第一部分。当我通过我的代码过滤器=`"ParentNote=ea8428e4-1274-42e8-a31c-f57dc2f189a4"`

我错过了什么？

```
var tmpCNoteID = dr["CaseNoteID"].ToString();
                var filter = "ParentNote="+tmpCNoteID;

                DataRow[] childRows = cNoteDT.Select(filter); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T19:02:47.697

尝试用单引号将 GUID 括起来：

```
var filter = "ParentNote='"+tmpCNoteID+"'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:09:53.360

这应该工作：

```
 var tmpCNoteID = dr["CaseNoteID"].ToString();
                var filter = "ParentNote=\""+tmpCNoteID+"\"";

                DataRow[] childRows = cNoteDT.Select(filter); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-18T14:38:56.583

我知道这是一个旧线程，但我想添加一个附录。当使用带有 Guid 的 IN 运算符时（例如：ParentNote IN ( , , 等 ) ），不再接受单引号。在这种情况下，必须使用 CONVERT 方法（granadaCoder 建议）。（单引号引发了一个例外，即使用 '=' 运算符将 Guid 与字符串进行比较......我们实际上没有使用它。）

**详细信息：**我继承了一些遗留代码，这些代码构建了一个大的过滤器字符串，格式如下： `MyColumn = '11111111-2222-3333-4444-555555555555' OR MyColumn = '11111111-2222-3333-4444-555555555555' ....`

当 guid 的数量（以及 OR 子句的数量）变得太大时，这会导致堆栈溢出异常。通过用 IN 子句替换大量 OR 子句，我能够毫无例外地设置过滤器。但是使用 IN 子句意味着必须使用 CONVERT 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-21T20:56:08.070

这是我使用的一种方法：

```
 MyStrongDataSet ds = new MyStrongDataSet();
            Guid myUuid = new Guid("11111111-2222-3333-4444-555555555555");

            System.Data.DataRow[] rows = ds.MyStrongTable.Select("MyGuidProperty = (CONVERT('" + myUuid.ToString("N") + "', 'System.Guid'))");

            //Fish out a single row if need be and cast to a strong row
            if (null != rows)
            {
                if (rows.Length > 0)
                {
                    MyStrongDataSet.MyStrongTableRow returnRow = rows[0] as MyStrongDataSet.MyStrongTableRow;
                    return returnRow;

                }
            }
            return null; 
```

这是一个细微的变化：

```
 string filterSql = "MyGuidProperty ='{0}'";

  filterSql = string.Format(filterSql, Guid.NewGuid().ToString("D")); 
```

# ruby - How to get COM object for embedded IE browser?

> ID：812755
> 
> 赞同：1
> 
> 时间：2009-05-01T18:59:11.513
> 
> 标签：ruby, internet-explorer, winapi, watir, win32ole

How to translate this function from AutoIt's IE.au3 UDF to Ruby? Intention is to use Watir with an Internet Explorer browser (embedded in another application).

The AutoIt function works fine but I prefer Watir (which is Ruby). I can get the handle of the embedded browser using `ControlGetHandle()`, which is not available from the AutoIt dll.

Below is the function to translate (also 2 others which I don't need).

```
;===============================================================================
;
; Function Name:    __IEControlGetObjFromHWND()
; Description:      Returns a COM Object Window reference to an embebedded Webbrowser control
; Parameter(s):     $hWin       - HWND of a Internet Explorer_Server1 control obtained for example:
;                   $hwnd = ControlGetHandle("MyApp","","Internet Explorer_Server1")
; Requirement(s):   Windows XP, Windows 2003 or higher.
;                   Windows 2000; Windows 98; Windows ME; Windows NT may install the
;                   Microsoft Active Accessibility 2.0 Redistributable:
;                   http://www.microsoft.com/downloads/details.aspx?FamilyId=9B14F6E1-888A-4F1D-B1A1-DA08EE4077DF&displaylang=en
; Return Value(s):  On Success  - Returns DOM Window object
;                   On Failure  - 0  and sets @ERROR = 1
; Author(s):        Larry with thanks to Valik
;
;===============================================================================

Func __IEControlGetObjFromHWND(ByRef $hWin)
    DllCall("ole32.dll", "int", "CoInitialize", "ptr", 0)
    Local Const $WM_HTML_GETOBJECT = __IERegisterWindowMessage("WM_HTML_GETOBJECT")
    Local Const $SMTO_ABORTIFHUNG = 0x0002
    Local $lResult, $typUUID, $aRet, $oIE
MsgBox(0, "msg", $WM_HTML_GETOBJECT)

    __IESendMessageTimeout($hWin, $WM_HTML_GETOBJECT, 0, 0, $SMTO_ABORTIFHUNG, 1000, $lResult)

    $typUUID = DllStructCreate("int;short;short;byte[8]")
    DllStructSetData($typUUID, 1, 0x626FC520)
    DllStructSetData($typUUID, 2, 0xA41E)
    DllStructSetData($typUUID, 3, 0x11CF)
    DllStructSetData($typUUID, 4, 0xA7, 1)
    DllStructSetData($typUUID, 4, 0x31, 2)
    DllStructSetData($typUUID, 4, 0x0, 3)
    DllStructSetData($typUUID, 4, 0xA0, 4)
    DllStructSetData($typUUID, 4, 0xC9, 5)
    DllStructSetData($typUUID, 4, 0x8, 6)
    DllStructSetData($typUUID, 4, 0x26, 7)
    DllStructSetData($typUUID, 4, 0x37, 8)

    MsgBox(0, "lResult", $lResult)

    $aRet = DllCall("oleacc.dll", "long", "ObjectFromLresult", "lresult", $lResult, "ptr", DllStructGetPtr($typUUID), _
            "wparam", 0, "idispatch*", 0)
MsgBox(0, "aRet4", $aRet[4])
    If IsObj($aRet[4]) Then
        $oIE = $aRet[4] .Script()
        ; $oIE is now a valid IDispatch object
        Return $oIE.Document.parentwindow
    Else
        SetError(1)
        Return 0
    EndIf
EndFunc   ;==>__IEControlGetObjFromHWND
;===============================================================================
; Function Name:    __IERegisterWindowMessage()
; Description:      Required by __IEControlGetObjFromHWND()
; Author(s):        Larry with thanks to Valik
;===============================================================================
Func __IERegisterWindowMessage($sMsg)
    Local $aRet = DllCall("user32.dll", "int", "RegisterWindowMessage", "str", $sMsg)
    If @error Then Return SetError(@error, @extended, 0)
    Return $aRet[0]
EndFunc   ;==>__IERegisterWindowMessage

;===============================================================================
; Function Name:    __IESendMessageTimeout()
; Description:      Required by __IEControlGetObjFromHWND()
; Author(s):        Larry with thanks to Valik
;===============================================================================
Func __IESendMessageTimeout($hWnd, $msg, $wParam, $lParam, $nFlags, $nTimeout, ByRef $vOut, $r = 0, $t1 = "int", $t2 = "int")
    Local $aRet
    $aRet = DllCall("user32.dll", "long", "SendMessageTimeout", "hwnd", $hWnd, "int", $msg, $t1, $wParam, _
            $t2, $lParam, "int", $nFlags, "int", $nTimeout, "int*", "")
    If @error Then
        $vOut = 0
        Return SetError(@error, @extended, 0)
    EndIf
    $vOut = $aRet[7]    
    If $r >= 0 And $r <= 4 Then Return $aRet[$r]
    Return $aRet
EndFunc   ;==>__IESendMessageTimeout 
```

My code so far:

```
def get_control_from_hwnd(hnd)  
    Win32API.new("ole32", "CoInitialize", ['P'] , 'I').call(0)

    reg_msg = Win32API.new("user32", "RegisterWindowMessage", ['P'] ,'I').call("WM_HTML_GETOBJECT")
    puts "msg: " + reg_msg.to_s
    result=" "*16 
    aInt = [0xA7, 0x31, 0x0, 0xA0, 0xC9, 0x8, 0x26, 0x37].pack 'I*'
    a = [0x626FC520, 0xA41E, 0x11CF, aInt].pack 'IIIP'

    sendMessagetimeout = Win32API.new("user32", "SendMessageTimeout", ['L','I','I','I','I','I','P'] , 'L')
    sendMessagetimeout.call(hnd.hex, reg_msg, 0, 0, SMTO_ABORTIFHUNG, 1000, result)

    puts "result unpacked: " + result.unpack("L").to_s  #i can confirm this is the same as the lResult from the autoit functioin

    idisp=0 
    #the problem is likely either here or the next line afterwards
    oIE = Win32API.new("oleacc", "ObjectFromLresult", ['P','P','I','P'] , 'L')

    oIE.call(result, a, 0, idisp)
    puts "idisp: " + idisp.to_s
    # returning zero
    puts idisp.unpack("L")  

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-02T23:44:27.983

不敢相信我们也在做同样的事情，尽管我正在尝试在 Perl 中做这件事。我不知道 Ruby，但看看脚本，它几乎看起来与 Perl 相似。看看 autoIt 上的这个线程，我仍在尝试解决这个问题[http://www.autoitscript.com/forum/index.php?showtopic=104894](http://www.autoitscript.com/forum/index.php?showtopic=104894)。但我想我可能已经得到了 idisp。两个变化：

1）我打包结构的方式有点不同。我的 $iid 看起来像这样：pack('LSSC8',0x626FC520,0xA41E,0x11CF,0xA7,0x31,0x00,0xA0,0xC9,0x08,0x26,0x37)。所以在 Ruby 中我猜它会是 [0x626FC520,0xA41E,0x11CF,0xA7,0x31,0x00,0xA0,0xC9,0x08,0x26,0x37].pack 'LSSC8'？我不知道正确的语法，但你明白了。2）我从 SendMessageTimeout 解压“结果”，然后将其传递给 ObjectFromLresult。如果我直接传递结果，我会得到 0，就像你得到它一样。

但这就是我去过的地方。

# windows - Windows Shell 脚本 - 关闭命令提示符

> ID：812769
> 
> 赞同：1
> 
> 时间：2009-05-01T19:01:29.697
> 
> 标签：windows, batch-file

我认为这很容易，所以就到这里；我正在尝试执行这些命令，然后在 Firefox 打开后关闭命令提示符。我怎么做？在“ping 127.0.0.1 -n 4>null”（我在这里模拟睡眠）之后，我无法返回命令提示符。

```
@echo off
call tskill firefox
call ping 127.0.0.1 -n 4>nul
call C:\"Program Files"\"Mozilla Firefox 3"\firefox
call exit 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T19:56:11.627

实际上，如果您这样做：

```
@echo off
call ping 127.0.0.1
start http://www.stackoverflow.com 
```

该网址将在您的默认网络浏览器中打开。用引号包围 url 似乎把它搞砸了。

-大学教师

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:10:51.000

您可以使用“开始”单独启动该过程。例如：

```
@echo 关闭
平 127.0.0.1
启动 IEXPLORE.EXE “http://www.stackoverflow.com”

```

我使用 IEXPLORE 是因为我不想查找 Firefox 的路径。根据您的喜好进行调整。

# delphi - 在 Delphi 中，您是使用包含路径还是明确包含所有必需的文件？

> ID：812773
> 
> 赞同：5
> 
> 时间：2009-05-01T19:02:03.847
> 
> 标签：delphi

查看我们的代码库，一些代码明确包含在项目中，并从搜索路径中提取。有没有人对哪个是最佳实践以及为什么有意见？

更新：

我想我会澄清我的问题。我们所有的路径都是相对的，所以我们可以有多个分支，它们都引用它们分支中的代码。所以我不是在询问相对路径，而是单元是否应该在 .dpr 中或使用搜索路径拾取，这就是为什么之前提出的问题不能完全满足我的需求的原因。谢谢大家

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T19:05:38.923

我有一个非常基本的方法来确定这一点......如果代码特定于项目（未在其他地方使用），我会明确包含它。所有共享代码都从库路径中提取。

最好的问候，唐

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T20:26:22.130

我不认为我可以帮助那些发现编译器在他们的搜索路径上的某个地方找到一个单元的重复副本而他们没想到会找到它的人的次数。他们无法理解为什么要在编辑器中更改代码（在搜索路径中找不到的单元的副本上）并且没有看到应用程序行为的任何变化。明确包括单元而不设置搜索路径意味着编译器只能找到一个单元的副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T20:52:17.637

*   我的库在 SVN 中，我通常在 ../libraries 相对于该项目的项目中检查它们（将它们分支到）。这使包含目录的范围保持小而重要。

*   在真实源（.pas）中，路径是完全禁止的。

*   全局 delphi 搜索路径中没有与项目相关的路径（仅每个项目，或者它们是真正普遍共享的源/组件）

*   我讨厌用硬编码路径污染源，所以我通常在项目中只有几个单元，总是使用相对路径。请不要用 VSS w:\ 驱动器替代 hack！通常这些是拉入框架部分或由于视觉继承或表单初始化而需要的单元。

*   不幸的是，相对路径对Delphi 来说*可能*很危险，因为它们是相对于工作目录的，它可以根据Delphi 对话框（例如打开）而改变。解决方案很简单，在主项目中有一个具有唯一名称的包含文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T21:43:32.927

之前已在此处介绍过：

*   [在 Delphi 中，我应该将共享单元添加到我的项目、共享包中，还是都不添加？](https://stackoverflow.com/questions/543949/in-delphi-should-i-add-shared-units-to-my-projects-to-a-shared-package-or-neit)
*   [在项目之间共享 Delphi 源文件的最佳方式是什么？](https://stackoverflow.com/questions/259673/what-is-the-best-way-to-share-delphi-source-files-among-projects)

[我对第一个问题](https://stackoverflow.com/questions/543949/in-delphi-should-i-add-shared-units-to-my-projects-to-a-shared-package-or-neit/544188#544188)的回答也是我对你问题的回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T19:27:03.600

共享代码与特定代码是一个很好的规则。

我经常使用[VSSConnextion](http://www.epocalipse.com/vcx.htm)，所以我通常需要一起签出/签入的文件自然属于同一个项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T21:42:02.743

在两次升级 Delphi 并将我的项目移动到新计算机两次之后，我了解到硬编码路径是邪恶的，因为根目录往往会改变。如果您正在处理共享项目，那就更是如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T22:04:25.650

我有同样的问题。排水沟中没有出现的蓝点。

简单的解决方案（之一）：

Menu > Project > Compiler > Build Configuration... 设置为 DEBUG 而不是 release。

德尔福 2007

PS：好吧，我*以为*我已经完成了编码。有人要求提供新功能。:)

# php - mysql_real_escape_string() 完全删除字符串

> ID：812779
> 
> 赞同：6
> 
> 时间：2009-05-01T19:03:17.150
> 
> 标签：php, mysql, mysql-real-escape-string

我正在转义从这样的 php 表单收到的所有字符串参数：

```
$usr_name = mysql_real_escape_string($_REQUEST['usr_name']); 
```

以避免 SQL 注入的一些问题。但是当我从函数中返回字符串时，我什么都没有。

此外，我的 PHP 日志中不断收到这个奇怪的警告：

```
PHP Warning:  mysql_real_escape_string() [<a href='function.mysql-real-escape-string'>function.mysql-real-escape-string</a>]: A link to the server could not be established in /hermes/bosweb/web279/b2798/ipw.bankingforms/public_html/formAckResponse_controller.php on line 39 
```

主机使用：PHP 版本 4.4.7

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-01T19:07:23.753

来自[PHP.net：](http://us.php.net/mysql-real-escape-string)

> **注意：**使用前需要连接MySQL， `mysql_real_escape_string()`否则会产生level错误`E_WARNING`，并`FALSE`返回。如果 `link_identifier`未定义，则使用最后一个 MySQL 连接。

换句话说，您需要通过`mysql_connect()`或`mysql_pconnect()`在使用此功能之前连接到 MySQL 数据库。

# python - Python 的 bz2 模块默认不编译

> ID：812781
> 
> 赞同：28
> 
> 时间：2009-05-01T19:03:50.877
> 
> 标签：python, c, compiler-construction

似乎 Python 2.6.1 默认情况下不会从源代码编译 bz2 库。

我没有 lib-dynload/bz2.so

添加它的最快方法是什么（无需从头开始安装 Python）？

操作系统是 Linux 2.4.32-grsec+f6b+gr217+nfs+a32+fuse23+tg+++opt+c8+gr2b-v6.194 #1 SMP Tue Jun 6 15:52:09 PDT 2006 i686 GNU/Linux

IIRC 我只使用了 --prefix 标志。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-01T20:24:55.317

您需要首先正确安装 libbz2.so（通用 libbz2 库），以便 Python 能够构建自己的接口。这通常来自您的 Linux 发行版中的一个包，包名中可能包含“libbz2”和“dev”。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-01T23:52:30.997

使用供应商的包管理添加包含 bz2 开发文件的包。它通常是一个名为“libbz2-dev”的包。例如在 Ubuntu 上

`sudo apt-get install libbz2-dev`

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-06-10T22:37:21.737

这个问题有两种解决方案：

## 选项 1\. 安装 bzip2-devel

在 Debian 及其衍生版本上，您可以像这样轻松安装：

```
sudo apt-get install bzip2-devel 
```

## 选项 2\. 构建和安装 bzip2

在[bzip2 包](http://bzip.org)的 README 文件中，解释了在某些平台下，即那些使用 Linux-ELF 二进制文件的平台，您必须构建一个额外的共享对象文件，如下所示：

```
wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz
tar xpzf bzip2-1.0.6.tar.gz
cd bzip2-1.0.6
make
make -f Makefile-libbz2_so
make install PREFIX=/path/to/local # /usr/local by default 
```

这里的关键位是以下命令：

```
make -f Makefile-libbz2_so 
```

我已经这样做了，然后尝试再次构建 Python，如下所示：

```
cd Python-2.7.3
./configure --prefix=/path/to/local 
make install 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-07-27T16:38:23.067

如果您碰巧尝试在 RHEL5 上编译 Python，则该软件包称为**bzip2-devel**，并且如果您已设置 RHN，则可以使用以下命令安装它：

> 百胜安装 bzip2-devel

完成后，您不需要 --enable-bz2 或 --with-bz2 选项，但您可能需要 --enable-shared。

# c# - 使用 C# 进行图形导航

> ID：812787
> 
> 赞同：2
> 
> 时间：2009-05-01T19:06:00.047
> 
> 标签：c#, algorithm, graph-theory, traversal, directed-graph

我有点困惑，试图想出一个好的算法来导航下图。

[替代文字 http://www.archimedesinc.biz/images/StackOverflow/Tree.jpg](http://www.archimedesinc.biz/images/StackOverflow/Tree.jpg)

如果用户选择“表 21”作为起点，我需要能够从该起始表获取到任何其他表的路径。

EX：如果用户选择“表 21”作为开始，然后从“表 8”中添加一个值，我需要创建以下路径“**表 21** ->**表 12** ->**表 9** ->**表 6** ->**表 8** "，表之间的所有权重都是相同的。

我似乎忘记了自己处理有向图的技巧，想不出一个好的算法。我不是在寻求解决方案，而只是朝着正确的方向前进。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T19:07:20.213

广度优先搜索将找到最短路径：[http ://en.wikipedia.org/wiki/Breadth-first_search](http://en.wikipedia.org/wiki/Breadth-first_search)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T19:09:22.503

由于您说边缘的权重都相同，因此[Dijkstra 的算法](http://en.wikipedia.org/wiki/Dijkstra's_algorithm)（我通常首选此类事物）只会降级为[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)，因此我建议为简单起见使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:13:08.233

您可以从多种算法中进行选择，以确定最短路径。[QuickGraph](http://quickgraph.codeplex.com/Wiki/View.aspx?title=User%20Manual)擅长这种事情。

# regex - 限制 XML 模式中的单词列表

> ID：812790
> 
> 赞同：6
> 
> 时间：2009-05-01T19:07:14.830
> 
> 标签：regex, xsd

我正在编写一个 XML 模式，需要防止元素的文本匹配某些值。（例如，variableName 元素不能匹配 'int'、'byte'、'string' 等）

我尝试使用类似于“^(int|byte|string)”的模式元素的限制，但没有成功。

你知道格式化正则表达式的方法，或者任何其他的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T21:00:26.867

在三重检查 XML Schema (XSD) 正则表达式*确实*不支持使这项任务变得容易的任何特性（特别是前瞻和锚点）之后，我想出了一种似乎可行的方法。我使用自由间距模式使其更易于阅读，但这是 XSD 风格不支持的另一个功能。

```
 [^ibs].* |
  i(.{0,1} | [^n].* | n[^t].* | nt.+) |
  b(.{0,2} | [^y].* | y[^t].* | yt[^e].* | yte.+) |
  s(.{0,4} | [^t].* | t[^r].* | tr[^i].* | tri[^n].* | trin[^g].* | tring.+) 
```

第一个替代项匹配不以任何关键字的首字母开头的任何内容。其他每个顶级替代项都匹配一个以与关键字之一相同的字母开头的字符串，但是：

*   比关键字短，
*   有不同的第二个字母、不同的第三个字母等，或
*   比关键字长。

请注意，XSD 正则表达式不支持显式锚点（即 , `^`, `$`, ） `\A`，`\z`但所有匹配项都隐式锚定在两端。

我可以看到一个潜在的问题：如果关键字列表很长，您可能会遇到正则表达式的绝对长度限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T02:28:30.567

它必须是 W3C 模式（又名“xml 模式”）吗？或者像[RelaxNG](http://www.relaxng.org/)这样的标准替代品会起作用吗？我可能错了，但我认为它在组合限制方面有一些改进，包括交叉路口的能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T03:39:11.310

如果没有负前瞻，这是非常乏味的。附件是一个适用于某些单元测试的正则表达式。这是用 Perl 而不是 XSD 编写的，但它是非常基本的正则表达式，所以它应该可以工作......您应该在使用它之前从正则表达式中删除空格。我添加了空格只是为了使它更容易阅读。

注意：我不知道 XSD 中是否允许使用 "\A" 和 "\z"。如果不是，请分别替换为“^”和“$”。

```
use Test::More 'no_plan';

my $re = qr/\A(\z|[^ibs]                                                        
   |i(\z|[^n]|n(\z|[^t]|t.))                                                    
   |b(\z|[^y]|y(\z|[^t]|t(\z|[^e]|e.)))                                         
   |s(\z|[^t]|t(\z|[^r]|r(\z|[^i]|i(\z|[^n]|n(\z|[^g]|g.))))))/x;

for my $str ( qw(inter bytes ins str strings in sdgsdfger i b s by byt bite st \
str stri strin strink) ) {
   like($str, $re, $str);
}

for my $str ( qw(int byte string) ) {
   unlike($str, $re, $str);
} 
```

# c# - 属性为空，即使在代码中设置后也是如此

> ID：812793
> 
> 赞同：6
> 
> 时间：2009-05-01T19:07:30.790
> 
> 标签：c#, visual-studio, oop, console

我一直在尝试解决这个问题（3 天），但我就是想不通。我将尝试全面解释这个问题，因为它有点复杂。

我的学校任务是在 C# Visual Studio 2008 中使用 OOP 创建一个简单的文本游戏（应该建立在老师为我们提供的库上）。它应该只使用控制台。我在 PHP 和 C++ 的 OOP 方面有不错的经验，但我仍然无法弄清楚这一点。

80% 的文本游戏已经在运行，所以我不会用已经运行但与问题无关的课程和内容让您厌烦。好的，让我们开始吧：

游戏中的每个命令（您可以在控制台中键入并按回车键）都由一个类表示，该类既扩展了抽象类，又扩展了我应该构建游戏的库中的接口。Bellow 是一个 Use 类，它表示使用物品的命令（例如，您在控制台中输入“使用剑”，游戏将查找名为剑的物品并调用其使用方法）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Game.Commands
{
    class Use : TextGame.Commands.ACommand, TextGame.Commands.ICommand
    {
        private string name;
        public new string Name
        {
            set { this.name = value; }
            get { return this.name; }
        }

        private string description;
        public new string Description
        {
            set { this.description = value; }
            get { return this.description; }
        }

        private string parameters;
        public new string Params
        {
            set { this.parameters = value; }
            get { return this.parameters; }
        }

        public Use(string name, string description) : base(name, description)
        {
            this.name = name;
            this.description = description;
        }

        private TextGame.Core.GameState gameState;
        public TextGame.Core.GameState Execute(TextGame.Core.IGame game)
        {
            // This is just a test because it appears the problem is
            // with the parameters property. There should be a command
            // you have typed in the console but its always null
            // Note that I have not yet coded the body of this method.
            // I will do that once I solve the problem.
            if (this.parameters == null)
            {
                Console.WriteLine("is null");
            }
            else
            {
                Console.WriteLine(this.parameters);
            }
            return this.gameState;
        }
    }
} 
```

还有两个其他类被使用。Parser 类和 Game 类。有点长，所以我只会从他们那里发布相关内容的片段。解析器类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections; // ArrayList, Dictionary, Hashtable
using System.Text.RegularExpressions; // regex engine
using Game.Commands;

namespace Game
{
    class Parser
    {
        private ArrayList commands = new ArrayList();

        // All commands that are available in the game so far are
        // initialized here in the constructor (and added to the arraylist)...
        // skip to the other method this is not important
        public Parser()
        {
            this.commands.Add(new North("^north", "Go north"));
            this.commands.Add(new South("^south", "Go south"));
            this.commands.Add(new East("^east", "Go east"));
            this.commands.Add(new West("^west", "Go west"));
            this.commands.Add(new Use("^use\\s\\w+", "Try to use the selected item"));
            this.commands.Add(new Quit("^quit", "Quit the game"));
        }

        // This method takes as an argument a string representing
        // a command you type in the console. It then searches the arraylist
        // via the regex. If the command exists, it returns an the command object
        // from the arraylist
        // This works fine and returns right objects (tested)
        public TextGame.Commands.ACommand GetCommand(string command)
        {
            TextGame.Commands.ACommand ret = null;
            foreach (TextGame.Commands.ACommand c in this.commands)
            {
                Regex exp = new Regex(@c.Name, RegexOptions.IgnoreCase);
                MatchCollection MatchList = exp.Matches(command);
                if (MatchList.Count > 0)
                {
                    ret = c;
                }
            }
            return ret;
        }
    }
} 
```

现在是我使用上述两个类的 Game 类的一个片段：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using TextGame.Core;
using System.Collections;
using Game.Items;
using Game.Commands;

namespace Game
{
    class Game : TextGame.Core.IGame
    {

        public void Play()
        {   
            // Here I read commands from the console in a loop and
            // call the ProcessCommand() method. No problem here.
            while (true)
            {
                string command = Console.ReadLine();
                this.ProcessCommand(command);
            }
        }

        // This is the IMPORTANT method so take a closer look
        private TextGame.Core.GameState gameState;
        public TextGame.Core.GameState ProcessCommand(string command)
        {
            Parser parser = new Parser();
            TextGame.Commands.ACommand c = parser.GetCommand(command);
            if (c != null)
            {
                // HERE I ADD THE COMMAND FROM THE CONSOLE TO THE C OBJECT
                // I ADD IT VIA THE SETTER TO THE PARAMETERS PROPERTY
                // OF THE COMMAND
                c.Params = command;
                // AND I CALL THE COMMAND'S EXECUTE() METHOD - SEE THE FIRST CLASS -
                // USE - WHERE I TEST FOR THE PARAMS PROPERTY BUT IT IS STILL NULL
                this.gameState = ((TextGame.Commands.ICommand)c).Execute(this);
            }
        }
    }
} 
```

我在片段中添加了注释来描述问题出在哪里。我希望我已经解释清楚了。

有人有什么想法吗？我已经在这个项目上工作了大约 3 周，当 3 天前我遇到这个问题时，大部分工作进展顺利，从那时起我一直在努力解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T19:14:40.523

您的问题与“新”关键字有关。这是您在“使用”类中使用它的地方：

```
 private string parameters;
    public new string Params
    {
        set { this.parameters = value; }
        get { return this.parameters; }
    } 
```

您正在创建一个不同的属性，它恰好与您继承的类型上的属性具有相同的名称。'new' 关键字告诉编译器你打算这样做。

基本上，这意味着如果您执行以下操作：

```
var x = new Use();
x.Params = "abcd";
((ACommand)x).Params = "wxyz";
Console.Writeline("direct: " + x.Params);
Console.Writeline("ACommand: " + ((ACommand)x).Params); 
```

你会得到这个输出：

> 直接：abcd
> 
> A命令：wxyz

您可能希望完全从 Use 中删除“Params”的定义，而只从 ACommand 继承该定义。可能也来自名称和描述，但如果你愿意，你应该能够从这里弄清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T19:15:26.933

没有看到 ACommand 类的代码...尝试删除 Use 类的 Params 声明中的“new”运算符。当您设置属性 c.Params = command; 实际上是设置基类的属性，在 Execute 方法中检查 this.parameters 而不是 base.Params。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T19:15:06.047

> // 这只是一个测试，因为看起来问题出在
> // 与参数属性有关。应该有一个命令
> // 您在控制台中输入了但它始终为空
> // 请注意，我尚未编写此方法的主体。
> // 一旦我解决了问题，我就会这样做。

这是由于您在属性上声明了新的。如果您不需要更改 ACommand 的逻辑，这些应该被覆盖，或者根本不包括在内。

当您作为 ACommand 引用时：

```
TextGame.Commands.ACommand c = parser.GetCommand(command);            
c.Params = command; 
```

您将使用 ACommand 的参数或您的覆盖（如果您已定义一个）。

您的新参数会影响 ACommand 的参数，并且只有在您的引用是 UseCommand 时才能访问。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T19:19:13.710

你的问题在这里：

```
private string parameters;
public new string Params
{
    set { this.parameters = value; }
    get { return this.parameters; }
} 
```

在您的代码中：

```
c.Params = command; 
```

您正在引用类型`TextGame.Commands.ACommand`。因为您在子类中隐藏了 Param 属性，所以导致了非多态引用。去掉上面的定义，依赖Param的基类定义，就可以了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T19:16:28.990

自从我遇到这个问题以来已经有一段时间了，但是如果你在 Reflector 中打开它，我希望你会看到你将 Use.Params 属性隐藏在显式绑定到其基类型的 callvirt 后面......因为速度越快打字员指出。

# java - Java 1.5、Java EE 5、WAS 6.1：使用 ResourceBundle.getBundle(...) 加载资源包时出现异常

> ID：812802
> 
> 赞同：2
> 
> 时间：2009-05-01T19:09:00.100
> 
> 标签：java, jakarta-ee, websphere

这是我们在将应用程序从当前生产环境迁移到新数据中心环境时面临的另一个问题（请参阅下面的详细信息）

*   当前生产环境：Java 1.4、Java EE 3、WAS 5.1、JSF 2.1
*   新环境：Java 1.5、Java EE 5、WAS 6.1、JSF 2.1

这里我们有一个具有以下结构的第三方 jar 文件（检查图像 - 请原谅我隐藏了一些细节）
[![替代文字](https://i.stack.imgur.com/ueKJB.jpg)](https://i.stack.imgur.com/ueKJB.jpg)

此类具有从 ResourceBundle (db.properties) 加载数据库属性的代码。这是 Cavaj 渲染的代码：

```
    私有静态资源包 getDBProperties()
    {
        如果（dbProperties == null）
        {
            dbProperties = ResourceBundle.getBundle("db");
        }
        返回数据库属性；
    }

```

此应用程序在当前环境下运行良好。但不知何故，当我们将应用程序移动到新环境时，我们会得到一个“MissingResourceException”（见下文）：

```
引起：java.util.MissingResourceException：找不到捆绑包
基本名称 db，语言环境 en_US
在
java.util.ResourceBundle.throwMissingResourceException(ResourceBundle.java:863)
在 java.util.ResourceBundle.getBundleImpl(ResourceBundle.java:832)
在 java.util.ResourceBundle.getBundle(ResourceBundle.java:576)
在
com.myco.wo.vs.util.OrderLovUtilities.getDBProperties(OrderLovUtilities.java:195)

```

我们尝试了以下解决方法，但都没有奏效：

1.  将 db.properties 重命名为 db_en_US.properties
2.  将属性文件放入jar
3.  在 EAR 级别移动 jar 文件。

请建议这里可能有什么问题。我们能做些什么来让它工作:)

**注意：**文件 db.properties 位于 WEB-INF/classes 目录下。我们也尝试将其放在上述位置，但无济于事。

问候，
-阿什什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:23:13.663

尝试在您的 ent 设置中更改类加载器的顺序。EAR 和 WAR 级别的管理控制台中的应用程序（从`PARENT_FIRST`到`PARENT_LAST`）。

在我看来，第 3 方类 ( `com.myco.wo.vs.util.OrderLovUtilities`) 不是从 WEB-INF/lib 中的 jar 文件加载的，而是来自服务器上的其他位置。然后它的类加载器看不到属性文件。

如果这是问题所在，更改类加载器的顺序应该会导致加载预期的类副本。

此外，管理控制台中的类加载器查看器可以对此有所了解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T09:23:24.010

您是否尝试过将 db.properties 文件放在 WEB-INF/classes 目录下？

# wpf - 从不同进程更新 UI 失败

> ID：812813
> 
> 赞同：0
> 
> 时间：2009-05-01T19:11:12.590
> 
> 标签：wpf, user-interface, invoke

我正在尝试将来自 nmap 的标准输出放入 WPF 窗口应用程序（确切地说是文本框）。我正在尝试使用 Dispatcher.Invoke 但是当 nmap 进程启动时，一切都冻结了。当我在控制台应用程序（不带 Invoke）中尝试此操作时，一切正常，我认为这是 Invoke 方法的问题。Nmap 本身正在工作，并且正在完成它的工作，但我的窗口中没有任何响应。

这是我正在使用的代码：

```
 Process nmap = new Process();

 nmap.StartInfo.FileName = Properties.Settings.Default.NmapResidentialPath;
 nmap.StartInfo.Arguments = arguments.ToString();
 nmap.StartInfo.UseShellExecute = false;
 nmap.StartInfo.RedirectStandardOutput = true;
 nmap.OutputDataReceived += new DataReceivedEventHandler(nmap_OutputDataReceived);
 nmap.Start();
 nmap.BeginOutputReadLine();

 nmap.WaitForExit();
 nmap.Close(); 
```

和事件处理方法：

```
void nmap_OutputDataReceived(object sender, DataReceivedEventArgs e)
        {
            if (!String.IsNullOrEmpty(e.Data))
            {
                this.Dispatcher.Invoke(DispatcherPriority.Normal, (Action)(() => nmapOutput.Text += "\n" + e.Data));
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:52:58.683

这可能是由各种原因造成的。首先，确保在 UI 线程上创建了 nmapOutput 控件。其次， Dispatcher.Invoke 可能会导致 UI 线程死锁（这可能是您的情况）。

在调用 Invoke 之前始终调用 Dispatcher.CheckAccess()，或使用 BeginInvoke 以异步方式执行此操作。

# php - php intval() 和 floor() 返回值是否太低？

> ID：812815
> 
> 赞同：12
> 
> 时间：2009-05-01T19:12:55.753
> 
> 标签：php, floating-accuracy, rounding-error

因为 PHP 中的浮点数据类型不准确，并且 MySQL 中的 FLOAT 占用的空间比 INT 多（并且不准确），所以我总是将价格存储为 INT，在存储之前乘以 100 以确保我们有 2 个小数位的精度. 但是我相信 PHP 行为不端。示例代码：

```
echo "<pre>";

$price = "1.15";
echo "Price = ";
var_dump($price);

$price_corrected = $price*100;
echo "Corrected price = ";
var_dump($price_corrected);

$price_int = intval(floor($price_corrected));
echo "Integer price = ";
var_dump($price_int);

echo "</pre>"; 
```

产生的输出：

```
Price = string(4) "1.15"
Corrected price = float(115)
Integer price = int(114) 
```

我很惊讶。当最终结果比预期低 1 时，我希望测试的输出看起来更像：

```
Price = string(4) "1.15"
Corrected price = float(114.999999999)
Integer price = int(114) 
```

这将证明浮点类型的不准确性。但是为什么 floor(115) 返回 114？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-01T19:16:12.487

试试这个作为一个快速修复：

```
$price_int = intval(floor($price_corrected + 0.5)); 
```

您遇到的问题不是 PHP 的错，所有使用实数和浮点运算的编程语言都有类似的问题。

货币计算的一般经验法则是永远不要使用浮点数（无论是在数据库中还是在您的脚本中）。您可以通过始终存储美分而不是美元来避免各种问题。美分是整数，你可以自由地将它们加在一起，并乘以其他整数。每当您显示数字时，请确保在最后两位数字前插入一个点。

你得到 114 而不是 115 的原因是`floor`向下舍入，向最接近的整数，因此 floor(114.999999999) 变为 114。更有趣的问题是为什么 1.15 * 100 是 114.999999999 而不是 115。原因是 1.15不完全是 115/100，但它小了一点，所以如果你乘以 100，你会得到一个比 115 小一点的数字。

这是一个更详细的解释`echo 1.15 * 100;`：

*   它将 1.15 解析为二进制浮点数。这涉及舍入，它恰好向下舍入一点以获得最接近 1.15 的二进制浮点数。您无法获得精确数字（没有舍入误差）的原因是 1.15 以 2 为底有无限个数字。
*   它将 100 解析为二进制浮点数。这涉及到舍入，但由于 100 是一个小整数，舍入误差为零。
*   它计算前两个数字的乘积。这还涉及一点舍入，以找到最接近的二进制浮点数。在此操作中，舍入误差恰好为零。
*   它将二进制浮点数转换为带点的以 10 为底的十进制数，并打印此表示。这也涉及到一点四舍五入。

PHP 打印出令人惊讶的`Corrected price = float(115)`（而不是 114.999...）的原因是它`var_dump`不打印确切的数字（！），而是打印四舍五入到`n - 2`（或`n - 1`）位的数字，其中 n 位是计算的精度。您可以轻松地验证这一点：

```
echo 1.15 * 100;  # this prints 115
printf("%.30f", 1.15 * 100);  # you 114.999....
echo 1.15 * 100 == 115.0 ? "same" : "different";  # this prints `different'
echo 1.15 * 100 < 115.0 ? "less" : "not-less";    # this prints `less' 
```

如果要打印浮点数，请记住：打印浮点数*时并不总是看到所有数字*。

[另请参阅PHP 浮动](http://www.php.net/float)文档开头附近的大警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T19:20:58.807

我相信，其他答案已经涵盖了问题的原因和一个很好的解决方法。

为了从不同的角度解决问题：

为了在 MySQL 中存储价格值，您可能应该查看[DECIMAL 类型](http://dev.mysql.com/doc/refman/5.1/en/numeric-types.html)，它可以让您存储带小数位的精确值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-23T19:27:24.137

也许这是这个“问题”的另一种可能的解决方案：

```
intval(number_format($problematic_float, 0, '', '')); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T19:16:59.893

PHP 正在根据有效数字进行舍入。它隐藏了不准确性（在第 2 行）。当然，当地板出现时，它不会更好地了解并一路向下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-27T12:10:41.960

如前所述，这不是 PHP 本身的问题，更多的是处理无法表示为有限浮点值的分数的问题，因此在四舍五入时会导致字符丢失。

解决方案是确保在处理浮点值并且需要保持准确性时 - 使用 gmp 函数或 BC 数学函数 - bcpow、bcmul 等。并且问题将很容易解决。

例如，而不是 $price_corrected = $price*100;

使用 $price_corrected = bcmul($price,100);

# ruby-on-rails - Ruby on Rails - FCKEditor Absolute Image Path Ruby

> ID：812819
> 
> 赞同：0
> 
> 时间：2009-05-01T19:13:43.147
> 
> 标签：ruby-on-rails, fckeditor

I am using the FCKEditor wysiwyg editor, and was wondering if anyone figured out how to use the absolute path instead of relative path after you add an image in the editor? And if so, how.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-01T16:24:39.943

在 中搜索此代码`fckeditor\editor\filemanager\browser\default\connectors\php\basexml.php`：

```
echo '<CurrentFolder path="' . ConvertToXmlAttribute( $currentFolder ) . '" url="' . ConvertToXmlAttribute( GetUrlFromPath( $resourceType, $currentFolder ) ) . '" />' ; 
```

用这个替换它：

```
echo '<CurrentFolder path="' . ConvertToXmlAttribute( $currentFolder ) . '" url="'.'http://www.YOURDOMAINHERE.com' .ConvertToXmlAttribute( GetUrlFromPath( $resourceType, $currentFolder ) ) . '" />' ; 
```

# c# - n 层应用程序中的方法级文档

> ID：812820
> 
> 赞同：0
> 
> 时间：2009-05-01T19:13:50.930
> 
> 标签：c#, web-services, architecture, documentation, data-access-layer

我的情况：

我的应用程序的数据请求链如下所示：

```
(Client) -> (WebService) -> (SQL or OLAP Cube) 
```

客户端是一个 Silverlight 应用程序，它使用生成的代理与 WCF Web 服务进行通信。反过来，它使用 DAL 组件进行授权和访问 SQL DB 和 OLAP 多维数据集，**基本上它只是转发请求。因此，每种方法存在于四个不同的地方：**

```
// WCF Webservice interface and implementation (used by client)
public interface ICatalogService 
public class CatalogService : ICatalogService

// DAL interface and implementation (used by webservice)
public interface ICatalogDataAccessLayer
public class CatalogDataAccessLayer : ICatalogDataAccessLayer 
```

现在我的问题是，我应该在哪里放置文档以明确指定这些方法？在类或接口级别上，在 DAL 上还是在 Web 服务上？

到目前为止我的想法：

我会说在接口上编写方法规范最有意义，因为它是正在使用的合约。但是，在我的具体情况下，我看不到 webservice 和 DAL 之间的优势：

*   我是唯一的开发人员，没有单独的 webservice-guy 或 client-guy 需要文档
*   这是一个封闭的架构，webservice 不公开
*   将来从事此项目的每个人都可以访问它的所有组件（并且无论在哪里都可以找到文档）

那么，你怎么看呢？在这种情况下，我应该将方法级文档放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:22:49.700

我认为大多数人会期望 Web 服务的文档比 DAL 更多（特别是如果 DAL 主要是生成的代码：我猜是因为这些是传递方法）。我会在 DAL 注释中为将来使用它的人添加指向 Web 服务文档的指针。

原因是双重的。首先，Web 服务是真正的交互点（因此可能会添加更多客户端，这意味着记录服务是一个优势）。第二个是 DAL 听起来确实不像它在 Web 服务（在所描述的配置中）提供“附加价值”，所以回到交互和价值的真正点是有道理的。

如果 DAL 曾经受到另一个*没有*Web 服务层的客户端重用的威胁......显然这会改变事情以相反的方式（或自动重复评论）。

# wpf - 如果非空，则无法通过样式触发器设置 TextBlock 文本属性 - 为什么？

> ID：812822
> 
> 赞同：5
> 
> 时间：2009-05-01T19:14:10.900
> 
> 标签：wpf, xaml, triggers, textblock

下面的 XAML 不起作用（鼠标悬停时文本不会更改）：

```
<Window.Resources>
    <Style TargetType="TextBlock">
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="true">
                <Setter Property="Text" Value="hover"/>
            </Trigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<Grid>
    <TextBlock Text="original"/>
</Grid> 
```

但是，如果缺少 Text 属性：

```
 <Grid>
    <TextBlock/>
</Grid> 
```

鼠标悬停时文本会发生变化。有人知道这背后的理论吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T19:30:29.033

这是一个 DependencyProperty 优先级问题，当您实际设置属性时：

```
<TextBlock Text="original"/> 
```

优先于触发器中设置的值。

看

[http://msdn.microsoft.com/en-us/library/ms743230.aspx](http://msdn.microsoft.com/en-us/library/ms743230.aspx)

# javascript - Javascript 函数对象

> ID：812828
> 
> 赞同：0
> 
> 时间：2009-05-01T19:15:55.217
> 
> 标签：javascript, dhtml

我编辑了这个问题，所以它会更有意义。
我有一个需要几个参数的函数——我们称之为它`fc()`。我将该函数作为参数传递给其他函数（让我们调用它们`fa()`和`fb()`）。通过的每个函数都`fc()`向`fc()`. 如何传递`fc()`给每个函数而不必分别传递`fc()`'s 参数？下面是我希望它如何工作。

```
function fa(fc){
   fc.myvar=something
   fb(fc)
}

function fb(fc){
   fc.myothervar=something
   fc()
}

function fc(){
   doessomething with myvar and myothervar
} 
```

下面是我现在的做法。当我添加参数时，它变得令人困惑，因为我还必须将它们添加到前面的函数中。 `fb()`并`fc()`在其他地方使用，我失去了一些灵活性。

```
function fa(fc){
   myvar=something
   fb(fc,myvar)
}

function fb(fc,myvar){
   myothervar=something
   fc(myvar,myothervar)
}

function fc(myvar,myothervar){
   doessomething with myvar and myothervar
} 
```

谢谢你的帮助

* * *

**编辑 3 - 代码**

我使用 JimmyP 的解决方案更新了我的代码。我会对 Jason Bunting 的非黑客解决方案感兴趣。请记住，这些函数中的每一个也可以从其他函数和事件中调用。

从 HTML 页面

```
<input type="text" class="right" dynamicSelect="../selectLists/otherchargetype.aspx,null,calcSalesTax"/> 
```

加载部分时设置事件处理程序

```
function setDynamicSelectElements(oSet) {
    /**************************************************************************************
    * Sets the event handlers for inputs with dynamic selects
    **************************************************************************************/
    if (oSet.dynamicSelect) {
        var ySelectArgs = oSet.dynamicSelect.split(',');
        with (oSet) {
            onkeyup = function() { findListItem(this); };
            onclick = function() { selectList(ySelectArgs[0], ySelectArgs[1], ySelectArgs[2]) }
        }
    }
} 
```

`onclick`事件构建列表

```
function selectList(sListName, sQuery, fnFollowing) {
    /**************************************************************************************
    * Build a dynamic select list and set each of the events for the table elements
    **************************************************************************************/
    if (fnFollowing) {
        fnFollowing = eval(fnFollowing)//sent text function name, eval to a function
        configureSelectList.clickEvent = fnFollowing
    }
    var oDiv = setDiv(sListName, sQuery, 'dynamicSelect', configureSelectList); //create the div in the right place
    var oSelected = event.srcElement;
    if (oSelected.value) findListItem(oSelected)//highlight the selected item
} 
```

创建列表

```
function setDiv(sPageName, sQuery, sClassName, fnBeforeAppend) {
    /**************************************************************************************
    * Creates a div and places a page in it.
    **************************************************************************************/
    var oSelected = event.srcElement;
    var sCursor = oSelected.style.cursor; //remember this for later
    var coords = getElementCoords(oSelected);
    var iBorder = makeNumeric(getStyle(oSelected, 'border-width'))
    var oParent = oSelected.parentNode

    if (!oParent.id) oParent.id = sAutoGenIdPrefix + randomNumber()//create an ID
    var oDiv = document.getElementById(oParent.id + sWindowIdSuffix)//see if the div already exists
    if (!oDiv) {//if not create it and set an id we can use to find it later
        oDiv = document.createElement('DIV')
        oDiv.id = oParent.id + sWindowIdSuffix//give the child an id so we can reference it later    
        oSelected.style.cursor = 'wait'//until the thing is loaded
        oDiv.className = sClassName
        oDiv.style.pixelLeft = coords.x + (iBorder * 2)
        oDiv.style.pixelTop = (coords.y + coords.h + (iBorder * 2))
        XmlHttpPage(sPageName, oDiv, sQuery)
        if (fnBeforeAppend) {
            fnBeforeAppend(oDiv)
        }
        oParent.appendChild(oDiv)
        oSelected.style.cursor = ''//until the thing is loaded//once it's loaded, set the cursor back
        oDiv.style.cursor = ''
    }
    return oDiv;
} 
```

定位和调整列表大小

```
function configureSelectList(oDiv, fnOnClick) {
    /**************************************************************************************
    * Build a dynamic select list and set each of the events for the table elements
    * Created in one place and moved to another so that sizing based on the cell width can
    * occur without being affected by stylesheet cascades
    **************************************************************************************/
    if(!fnOnClick) fnOnClick=configureSelectList.clickEvent
    if (!oDiv) oDiv = configureSelectList.Container;
    var oTable = getDecendant('TABLE', oDiv)
    document.getElementsByTagName('TABLE')[0].rows[0].cells[0].appendChild(oDiv)//append to the doc so we are style free, then move it later
    if (oTable) {
        for (iRow = 0; iRow < oTable.rows.length; iRow++) {
            var oRow = oTable.rows[iRow]
            oRow.onmouseover = function() { highlightSelection(this) };
            oRow.onmouseout = function() { highlightSelection(this) };
            oRow.style.cursor = 'hand';
            oRow.onclick = function() { closeSelectList(0); fnOnClick ? fnOnClick() : null };
            oRow.cells[0].style.whiteSpace = 'nowrap'
        }
    } else {
        //show some kind of error
    }
    oDiv.style.width = (oTable.offsetWidth + 20) + "px"; //no horiz scroll bars please
    oTable.mouseout = function() { closeSelectList(500) };
    if (oDiv.firstChild.offsetHeight < oDiv.offsetHeight) oDiv.style.height = oDiv.firstChild.offsetHeight//make sure the list is not too big for a few of items
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T04:00:42.287

好的，所以 - 从哪里开始？:) 这是开始的部分函数，​​您将需要它（现在和将来，如果您花费大量时间破解 JavaScript）：

```
function partial(func /*, 0..n args */) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var allArguments = args.concat(Array.prototype.slice.call(arguments));
    return func.apply(this, allArguments);
  };
} 
```

我看到很多关于您的代码的事情让我感到畏缩，但是由于我没有时间真正批评它，而且您没有要求它，如果您想摆脱黑客攻击，我会建议以下内容您当前正在使用，以及其他一些东西：

## setDynamicSelectElements() 函数

在此函数中，您可以更改此行：

```
onclick = function() { selectList(ySelectArgs[0], ySelectArgs[1], ySelectArgs[2]) } 
```

对此：

```
onclick = function() { selectList.apply(null, ySelectArgs); } 
```

## selectList() 函数

在这个函数中，你可以在你使用 eval 的地方去掉这段代码——除非你有充分的理由这样做，否则不要使用 eval，这是非常危险的（去阅读它）：

```
if (fnFollowing) {
   fnFollowing = eval(fnFollowing)
   configureSelectList.clickEvent = fnFollowing
} 
```

并改用它：

```
if(fnFollowing) {
   fnFollowing = window[fnFollowing]; //this will find the function in the global scope
} 
```

然后，更改此行：

```
var oDiv = setDiv(sListName, sQuery, 'dynamicSelect', configureSelectList); 
```

对此：

```
var oDiv = setDiv(sListName, sQuery, 'dynamicSelect', partial(configureSelectListAlternate, fnFollowing)); 
```

现在，在我提供的代码中，我有“configureSelectListAlternate”——这是一个与“configureSelectList”相同但参数顺序相反的函数——如果您可以将参数的顺序反转为“configureSelectList”，这样做，否则这是我的版本：

```
function configureSelectListAlternate(fnOnClick, oDiv) {
   configureSelectList(oDiv, fnOnClick);
} 
```

## configureSelectList() 函数

在此函数中，您可以消除此行：

```
if(!fnOnClick) fnOnClick=configureSelectList.clickEvent 
```

这不再需要了。现在，我看到了一些我不明白的东西：

```
if (!oDiv) oDiv = configureSelectList.Container; 
```

我没有看到您在任何其他代码中挂钩该 Container 属性。除非你需要这条线，否则你应该可以摆脱它。

setDiv() 函数可以保持不变。

* * *

不太令人兴奋，但你明白了——你的代码真的可以使用一些清理——你是否有充分的理由避免使用像 jQuery 或[**MochiKit这样的库？**](http://www.mochikit.com)它会让你的生活更轻松......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T19:40:31.680

函数的属性不能作为局部范围内的变量使用。您必须将它们作为属性访问。因此，在“fc”中，您可以通过以下两种方式之一访问“myvar”：

```
// #1
arguments.callee.myvar;
// #2
fc.myvar; 
```

哪个都好...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T19:36:45.900

也许您正在寻找[**Partial Function Application**](https://stackoverflow.com/questions/321113/how-can-i-pre-set-arguments-in-javascript-function-call-partial-function-applic)，或者可能是currying？

[**这是一篇关于差异的博客文章**](http://www.uncarved.com/blog/not_currying.mrk)的引述：

> 在部分应用程序接受一个函数并从中构建一个接受较少参数的函数的情况下，currying 通过组合每个接受一个参数的函数来构建接受多个参数的函数。

如果可能的话，如果您可以简化示例和/或提供实际的 JS 代码而不是伪代码，这将对我们有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T23:19:19.327

尝试继承 - 通过将任何对象作为参数传递，您可以访问内部的任何变量，例如：

```
function Obj (iString) { // Base object
    this.string = iString;
}
var myObj = new Obj ("text");

function InheritedObj (objInstance) { // Object with Obj vars
    this.subObj = objInstance;
}
var myInheritedObj = new InheritedObj (myObj);

var myVar = myInheritedObj.subObj.string;
document.write (myVar); 
```

subObj 将采用 myObj 的形式，因此您可以访问其中的变量。

# iphone - 在 iPhone SDK 中创建自定义活动指示器？

> ID：812832
> 
> 赞同：5
> 
> 时间：2009-05-01T19:16:43.937
> 
> 标签：iphone

我没有找到任何使用自定义活动指示器的应用程序的引用——这将是一个动画 GIF 老式学校——代替 Apple 提供的纺车。是否有工具可以做到这一点（或子类 UIActivityIndi​​catorView），开发人员是否推出自己的 UIView，或者这是否违反 HIG？

谢谢，IPD

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-01T19:22:46.760

是的，正如 Ed Marty 提到的 UIImageView 支持图像的动画。因此，请查看此[自定义活动指示器](http://www.jademind.com/blog/posts/custom-activity-indicator)教程，以获取如何以非常简单的方式实现此目的的灵感。

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:34:57.490

UIImageView 类支持动画。试试看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T15:50:40.973

或者您可以使用动画来旋转图层。这是一篇关于如何做到这一点的有趣帖子：

[http://www.cimgf.com/2008/10/25/core-animation-tutorial-slider-based-layer-rotation/](http://www.cimgf.com/2008/10/25/core-animation-tutorial-slider-based-layer-rotation/)

希望这可以帮助。

蒂埃里

# cocoa - Creating a quick look style zooming effect

> ID：812834
> 
> 赞同：1
> 
> 时间：2009-05-01T19:17:32.327
> 
> 标签：cocoa, core-animation, core-graphics

I would like to create an effect than an image zooms up from a thumbnail size to full screen.

I am not sure what's the right steps to achieve this. Should I create a transparent full screen window and animate a layer on top of it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:52:35.283

Take a look at [this CoreGraphics example](http://lipidity.com/apple/the-ultimate-core-graphics-resource). Specifically, take a look at the "grow" and "shrink" animations. That's how Apple does it, and that's what you'll want to do too.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:53:25.820

您对内部带有 CALayer 的透明窗口的解决方案可能是最好的支持方式。

似乎它应该是一个很好的解决方案的一件事（至少这是我想这样做时想到的第一件事）但**不是**NSView 的`enterFullScreenMode:withOptions:`. 如果没记错的话，它原本是为了做你所说的，但是动画被取出了，现在它通常不能很好地工作。

# c# - C#中的枚举评估

> ID：812835
> 
> 赞同：1
> 
> 时间：2009-05-01T19:17:46.740
> 
> 标签：c#, enums, casting

假设我有如下枚举（取自 MSDN 示例）：

```
enum Days {Sat=1, Sun, Mon, Tue, Wed, Thu, Fri}; 
```

然后我可以在代码中使用如下：

```
int today = (int)Days.Sun; 
```

问题：

我可以评估枚举吗？假设我有一个变量 Day，其值为“Sun”。Days.Day 会评估为 Days.Sun 吗？

谢谢！

请不要挂断日期示例并告诉我我应该使用比较等...我希望用枚举替换数组的使用，因为它更紧凑。所以我正在寻找的本质上是一种从枚举中检索值的能力，类似于数组：

myArray[Day] 其中 day 将评估为数组键....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T19:22:01.223

我是否正确地说你有：

```
string day = "Sun"; 
```

你想拿回价值`Days.Sun`吗？

如果是这样，请使用：

```
string day = "Sun";
Day day = (Day) Enum.Parse(typeof(Days), day); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T19:18:20.547

是的，你可以这么做。`enum`您可以在 an及其基础类型之间自由转换。

```
using System;

class Program
{
    static void Main()
    {
        // prints "zero"
        Console.WriteLine((Foo)0);
        // prints "1"
        Console.WriteLine((int)Foo.one);
    }
}

enum Foo { zero, one, two }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:22:31.393

您也可以解析字符串值。使用`Enum.Parse`

```
[TestFixture]
public class EnumParsingSO
{
    public enum Days
    {
        Sat = 1,
        Sun,
        Mon,
        Tues
    }

    [Test]
    public void EnumFromString()
    {
        Days expected = Days.Mon;
        int expectedInt = 3;
        Days actual = (Days)Enum.Parse(typeof(Days), "Mon");

        Assert.AreEqual(expected, actual);
        Assert.AreEqual(expectedInt, (int)actual);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T19:23:49.083

正如安德鲁所说，您可以从枚举转换为其基础类型。您也可以在两者之间拆箱，并且存在从常量 0 到任何枚举类型的隐式转换：

```
using System;

enum Demo { Foo, Bar, Baz };

class Test
{
    static void Main()
    {
        int i = 2;
        object o = i;
        // Unboxing from int to Demo
        Demo d = (Demo) o;
        Console.WriteLine(d);

        o = Demo.Baz;
        // Unboxing from Demo to int
        i = (int) o;
        Console.WriteLine(i);

        // Implicit conversion of 0
        d = 0;
        Console.WriteLine(d);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T19:22:27.620

对于 int yes ，但是对于 string 你应该做这样的[事情](http://weblogs.asp.net/stefansedich/archive/2008/03/12/enum-with-string-values-in-c.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T19:25:40.293

是的，您可以，您只需要为每个枚举值提供本机整数值。从你的例子：

```
enum Days {
    Sat=1, 
    Sun=2, 
    Mon=3, 
    Tue=4, 
    Wed=5, 
    Thu=6, 
    Fri=7
}; 
```

（现在，为什么你会以这种方式订购一周中的几天，这超出了我的理解......）

# java - Java - 可编辑组合框验证

> ID：812847
> 
> 赞同：3
> 
> 时间：2009-05-01T19:21:22.457
> 
> 标签：java, validation, jcombobox

我正在研究验证可编辑 JComboBox 输入的各种方法。目前，我需要将输入限制为指定范围内的数字。到目前为止，我已经找到了 3 种不同的方法。对解决此问题的最佳方法有任何想法吗？

```
JComboBox comboBox = new JComboBox(
    new Object[] {"Donnie", "Danny", "Joey", "Jordan", "Jonathan"}
);

comboBox.setEditable(true); 
```

1.  通过实现覆盖方法 insertString 和 remove 的专用 Document 来控制用户输入。

    ```
    // get the combo boxes editor component
    JTextComponent editor =
            (JTextComponent) comboBox.getEditor().getEditorComponent();
    // change the editor's document
    editor.setDocument(new BadDocument()) 
    ```

2.  将 JComboBox 的 JTextField 替换为 JFormattedTextField。

3.  您可以使用输入验证器作为自定义格式化程序的替代方案

    ```
    // set the input verifier
    setInputVerifier(verifier);

    class MyVerifier extends InputVerifier implements ActionListener 
    {
        public boolean shouldYieldFocus(JComponent input) {}
    } 
    ```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:01:46.930

这就是 InputVerifier 的设计目的。我会从其中一个开始，但实际上这应该可以解决问题。您的要求中有什么特殊原因说明它为什么不起作用？

# html - html表中的下拉列表

> ID：812848
> 
> 赞同：0
> 
> 时间：2009-05-01T19:21:39.227
> 
> 标签：html, asp.net, drop-down-menu, html-table

我正在使用 asp.net，我想创建一个允许用户输入多行的表。一些行将成为下拉列表。我不知道该怎么做。

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:26:21.493

如果我理解您在寻找什么，这篇文章应该可以帮助您：

[将 DropDownList 添加到可编辑的 DataGrid](http://www.4guysfromrolla.com/webtech/050801-1.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:28:03.067

你用什么来存储数据？你在使用 SQL Server 吗？您的下拉列表是否由电子编号或参考数据提供支持？您使用的是哪个版本的 .NET？

您似乎想使用 ASP.NET 创建一个数据输入应用程序。如果您的数据库是 SQL 服务器并且您正在使用 .NET 3.5 版，我建议使用带有 LinqDataSource 的简单 GridView。查看[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)，了解一些很酷的示例。

# asp.net - 导入 Web 服务时出现问题

> ID：812849
> 
> 赞同：3
> 
> 时间：2009-05-01T19:21:40.133
> 
> 标签：asp.net, vb.net, web-services

我已经使用 VS 2008 在虚拟目录中创建了一个 Web 服务。我通过转到 .asmx 页面测试了该服务，一切正常。所以我选择了解决方案下的“添加网络引用”选项并输入了 .asmx URL。它成功找到了 Web 服务并添加了对项目的引用。但是，当我尝试使用与“App_WebReferences”文件夹下的目录相同的名称来导入服务命名空间时，它无法识别该名称，并且如果我尝试导入它会给我一个错误。我错过了这个过程中的任何步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:46:11.430

**更新**：尝试使用[wsdl](http://jlab.calumet.purdue.edu/theGateway/v2/0/doc/Instructions/ProxyClassInstructionsVS2005.htm)工具手动生成代理，并将代理类作为现有项目添加到客户端 Web 应用程序项目中，如链接中所述。

在您的 VS 中，代理生成发生了一些奇怪的事情。可能是访问问题。如果一切正常，您应该能够在 %windir%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ 的子文件夹之一下找到 VS 生成的代理类（对于 Asp.Net 2.0 ）。在临时文件夹中搜索以 App_WebReferences*.cs 开头的文件名。

* * *

添加 Web 服务时，您提供的 Web 参考名称是什么？在导入语句中使用相同的 Web 参考名称。

在这个[链接](http://digitalcolony.com/2007/08/consuming-web-service-in-aspnet.aspx)中，网络参考名称是`com.deepfitness`这样你就可以`import com.deepfitness`在你的 asp.net 应用程序中命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:34:01.023

要绝对确定单击查看您的 Web 项目中的所有文件并按照您在 App_WebReferences 中的引用向下直到您到达 reference.cs 打开它，您可以看到正确的命名空间。

# ruby - Sinatra 和 Ramaze 之间的主要区别是什么？

> ID：812856
> 
> 赞同：20
> 
> 时间：2009-05-01T19:24:05.273
> 
> 标签：ruby, sinatra, ramaze

我正在寻找一个轻量级的 Ruby Web 框架，并且遇到过[Sinatra](http://www.sinatrarb.com/intro.html)和[Ramaze](http://ramaze.net/documentation/index.html#Quick_Example)。两者看起来都非常轻巧、简洁和简单。但我对两者的了解都不够，无法说出主要区别是什么。也许对其中一种或两种都有经验的人可以发表评论？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-07-06T09:50:08.817

# 其他轻量级 Ruby 框架

我喜欢[_why 的 Camping](http://wiki.github.com/camping/camping)（现在[由社区](https://camping.github.io/camping.io/)维护），它必须是所有这些中最轻的（有关最新信息 [>= v1.9]，请参阅[Camping wiki](http://wiki.github.com/camping/camping)上的[Camping 链接](https://github.com/camping/camping/wiki/Miscellaneous-Camping-links)、Eleanor McHughe 的 ' [Going off the Rails](https://www.slideshare.net/feyeleanor/camping-going-off-the-rails-with-ruby) ' 或 [ v 1.5] Jeremy McAnally 的[Going Camping 幻灯片](http://slideshow.rubyforge.org/camping.html#1)或这些[Camping 截屏视频](http://www.techscreencast.com/web-development/ruby-on-rails/camping-a-microframework-for-ruby/326)、此[Camping 播客](http://podcast.rubyonrails.org/programs/1/episodes/the%5Fcamping%5Fepisode)和 Nathaniel Talbott 的[Why Camping Matters](https://www.youtube.com/watch?v=6rF2wJVRzio)，但请阅读[Camping 邮件列表](http://www.mail-archive.com/camping-list@rubyforge.org/info.html)以了解当前版本信息的更改和演变，并[尝试最新的博客示例](https://github.com/camping/camping/blob/master/examples/blog.rb)）。您现在还可以[阅读最新的 Camping api 文档](https://camping.github.io/camping.io/api/)。

但是我对所有我能找到的较轻的 Ruby 框架进行了为期 3 天的大规模搜索，这些框架看起来相当最新或完成（我正在尝试找到一个来教学生框架基础知识）所以，帮助你在您的脑海中，以下（带有露营）从一堆中脱颖而出（至少有一个开发人员名称，因此您也可以查看它们）...

对于初学者，那些优秀的 Ramaze 人曾经有一个[Ruby 框架列表，但是链接已经消失了](https://github.com/Ramaze/ramaze/wiki)，这里有一篇很好的文章，题为[10 Alternative Ruby web frameworks](http://accidentaltechnologist.com/ruby/10-alternative-ruby-web-frameworks/)。还有一个[关于 Camping 和 Merb 的 Ruby 论坛讨论](http://www.ruby-forum.com/topic/124360)，其中也涵盖了替代 ORM。请记住，以下一些是后 Merb 并扩展了该方法。

## [西纳特拉](http://www.sinatrarb.com/intro.html)（[布莱克·米泽拉尼](https://github.com/bmizerany)）

不是 MVC，没有默认的 ORM。好的文档。'一个完整的网络应用程序可以封装在一个单一的 Sinatra 文件中'

### Sinatra 评论和链接：

*   [GIT 上的 Sinatra](https://github.com/sinatra/sinatra/tree/master)
*   [Sinatra，一个 Ruby Web 框架，以及它的重要性](http://deadprogrammersociety.blogspot.com/2007/10/sinatra-ruby-web-framework-and-why-it.html)
*   [Slideshare 上的“Sinatra Ruby 框架”](http://www.slideshare.net/cpjolicoeur/sinatra-ruby-framework-presentation)
*   [不到 10 分钟的网络应用程序](https://vimeo.com/2374819)
*   [人们解释他们为什么选择 Sinatra](http://rubylearning.com/blog/2009/06/29/20-rubyists-using-sinatra-do-you/)

## [拉马兹](http://ramaze.net)（[曼韦鲁](https://github.com/manveru)）

Ramaze 在 Ruby 1.9 上运行良好。

### Ramaze 评论和链接：

*   [Ramaze 示例](http://blog.purepistos.net/index.php/2008/11/18/ramaze-by-example/)（使用 PostgreSQL）：
*   [在线 Ramaze 书](http://book.ramaze.net/)
*   [Ramaze：一个令人惊叹的 Ruby 框架](http://antoniocangiano.com/2008/01/08/ramaze-a-ruby-framework-that-will-amaze/)，作者 Antonio Cangiano

## [伍比](http://wuby.org)（[克里斯·马修](http://www.chrismatthieu.com/)饰）

来自评论：“运行 Wuby 应用程序不需要第三方应用程序或 gem，Wuby 库本身包含运行 HTTP 守护程序和开始服务请求所需的一切”，“[示例代码](http://wuby.org/examples.rhtml)有一点 PHP 的感觉”。

### Wuby 评论和链接：

*   [Wuby，另一个用于 Ruby 的轻量级 Web 框架](http://www.rubyinside.com/wuby-another-light-weight-web-framework-for-ruby-654.html)

## [爱荷华州](http://enigo.com/projects/iowa/)（[柯克·海恩斯](http://blog.rubybestpractices.com/about/wyhaines.html)）

在[Antonio Cangiano 的一篇关于 Ramaze](http://antoniocangiano.com/2008/01/08/ramaze-a-ruby-framework-that-will-amaze/)的文章中，他写道：“如果你的意思是‘切换’只是一般的‘从我当前的框架/编程语言/编程风格切换’，我没有真正的答案。一个例子就是非常未知的来自 Kirk Haines 的 IOWA 框架。它已经投入生产使用多年，非常稳定，速度非常快（甚至比 Ramaze 还要快），但它的文档和营销是不存在的。我不相信跟随炒作（即使它是 Ramaze）只是为了酷，我需要一个用例来切换到新的东西。”

[尽管Hal Fulton在](http://rubyhacker.com/)[The Ruby Way](https://books.google.com/books?id=ows9jTsyaaEC&dq=IOWA+the+Ruby+Way+Hal+Fulton&printsec=frontcover&source=bn&hl=en&ei=ma5xSpbMCOSTjAfIs7CJDA&sa=X&oi=book_result&ct=result&resnum=4)中涵盖了 IOWA，但文档很少，虽然下面的链接说事情已经转移到[Swiftcore](http://iowa.swiftcore.org/)，但反过来说它们即将出现在[GIT](https://github.com/wyhaines/iowa/tree/master)上，但截至 06 jul2009 仍然是空的。为了进一步模糊问题，RubyForge 上的 IOWA 日期是 2004 年，所以......？

### 爱荷华州评论和链接：

*   [旧网站 + 示例，教程](http://enigo.com/projects/iowa/)
*   [RubyForge 上的 IOWA 0.99.2.17](http://rubyforge.org/projects/iowa)
*   还可以查看他的 ORM [Kansas](http://www.ruby-forum.com/topic/124360#553213)和[Swiftiply](http://www.rubyinside.com/swiftiply-a-step-forward-in-rails-serving-489.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T20:31:21.090

Sinatra 不强制执行 MVC。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-11-04T14:04:20.330

我认为这是 Sinatra 和 Ramaze 之间真正的品味问题。都好，都轻。

最大的不同是 Ramaze 更像是 MVC。另一方面，Sinatra 像 DSL 一样工作，并且是 RESTful。

我建议您阅读它们的 GET_STARTED，这不会超过几分钟，您会看到有什么不同。

我个人都喜欢它们（偏爱 Ramaze），但可以帮助您做出决定的一件事是 Sinatra 更受欢迎（我认为），因此您可能会在网络上找到更多文档。

另一方面，您可以使用 Ramaze 并帮助使其更受欢迎。Ramaze 的 IRC 频道到处都是人（包括我），他们很乐意为您提供帮助并回答您的所有问题。

希望能帮助到你。米格

# django - Django Managers - 检索具有非空相关对象集的对象

> ID：812857
> 
> 赞同：3
> 
> 时间：2009-05-01T19:24:22.123
> 
> 标签：django, orm

我有两个类，Portfolio 和 PortfolioImage。

```
class PortfolioImage(models.Model):
    portfolio     = models.ForeignKey('Portfolio', related_name='images')
    ...

class Portfolio(models.Model):
    def num_images(self):
        return self.images.count() 
```

我想为 Portfolio 写一个“非空的投资组合”经理，这样我就可以做到：

```
queryset = Portfolio.nonempty.all() 
```

我试过做这样的事情，但我认为这还不是很接近：

```
class NonEmptyManager(models.Manager):
    def get_query_set(self):
        return super(NonEmptyManager, self).get_query_set().filter(num_images > 0) 
```

我真的不知道从哪里开始，而且我发现这方面的文档有点缺乏。

有任何想法吗？谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T20:13:29.697

首先，根据[文档](http://docs.djangoproject.com/en/dev/topics/db/queries/#field-lookups)，您不能使用模型方法使用`filter`/`exclude`子句进行查找。然后，您也不能将 python 运算符（`>`在您的情况下）与`filter`/一起使用`exclude`。

如果您使用的是 Django 1.1beta，要解决您的任务：

```
from django.db.models import Count

#...

def get_query_set(self):
    return super(NonEmptyManager,self).get_query_set()\
      .annotate(num_images=Count('images'))\
      .filter(num_images__gt=0) 
```

但是这个解决方案有一些限制。

Django >= 1.0 的另一种方式：

```
def get_query_set(self):
    return super(NonEmptyManager,self).get_query_set()\
      .filter(images__isnull=True) 
```

# iphone - USB and iPhone. In an iPhone app, USB is not connected to a computer?

> ID：812858
> 
> 赞同：0
> 
> 时间：2009-05-01T19:24:36.427
> 
> 标签：iphone, usb

I have this scenario where I have Windows Mobile smartphones that talk in low level to the USB port of a device that is not a computer. I now have to do this from an iPhone. Is that possible?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:26:55.097

It is not currently supported with Apple's SDK. However, in the 3.0 release (June 2009) it will be supported.

Learn more here: [http://www.apple.com/iphone/preview-iphone-os/](http://www.apple.com/iphone/preview-iphone-os/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:29:11.580

This is a feature that will be supported by the upcoming 3.0 software. There are some caveats however. You will have to use the 30-pin connector provided by Apple and the protocols that accompany it.

For more info, check out: [http://developer.apple.com/iphone/program/sdk.html](http://developer.apple.com/iphone/program/sdk.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T19:30:25.120

The iPhone 3.0 SDK supports this, through its [External Accessory](http://developer.apple.com/iPhone/program/sdk.html) API.

# cobol - RMKF Cobol 数据库文件的免费阅读器

> ID：812867
> 
> 赞同：1
> 
> 时间：2009-05-01T19:26:56.687
> 
> 标签：cobol

我有一些 powercobol 的 dat 文件，文件开头有一个 RMKF 标记，有人知道读取它们的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:39:10.760

你可以试试[http://www.cobolproducts.com/datafile/data-viewer.html](http://www.cobolproducts.com/datafile/data-viewer.html)

您可能至少了解记录布局是什么。

# python - Python中的线程完成事件

> ID：812870
> 
> 赞同：3
> 
> 时间：2009-05-01T19:27:20.523
> 
> 标签：python, delegates, multithreading

我有一个 PyQt 程序，在这个程序中我启动了一个新线程来绘制复杂的图像。我想知道线程何时完成，以便我可以在表单上打印图像。

我面临的唯一障碍是我需要从 GUI 线程内部调用绘图方法，所以我想要一种方法来告诉 GUI 线程从绘图线程内部做一些事情。

我可以使用一个线程来完成，但程序会停止。

我曾经在 C# 中使用具有完成事件的 BackgroundWorker 来执行此操作。

有没有办法在 Python 中做这样的事情？还是我应该侵入 PyQt 应用程序的主循环并对其进行一些更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:10:39.860

在[PyQt-Py2.6-gpl-4.4.4-2.exe 的示例](http://www.riverbankcomputing.co.uk/software/pyqt/download)中，有 Mandelbrot 应用程序。在我的安装中，源代码位于 C:\Python26\Lib\site-packages\PyQt4\examples\threads\mandelbrot.pyw。它使用一个线程来渲染像素图和一个信号（在代码中搜索 QtCore.SIGNAL）来告诉 GUI 线程它的绘制时间。看起来像你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:37:04.867

我的一个项目遇到了类似的问题，并使用信号告诉我的主 GUI 线程何时显示来自工作人员的结果并更新进度条。

[请注意， PyQt 参考指南](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/pyqt4ref.html#signal-and-slot-support)中有几个连接对象和信号的示例。并非所有这些都适用于 python（我花了一段时间才意识到这一点）。

以下是将 python 信号连接到 python 函数的示例。

```
QtCore.QObject.connect(a, QtCore.SIGNAL("PySig"), pyFunction)
a.emit(QtCore.SIGNAL("pySig"), "Hello", "World") 
```

另外，不要忘记添加`__pyqtSignals__ = ( "PySig", )`到您的工人阶级。

这是我所做的精简版：

```
class MyGui(QtGui.QMainWindow):

    def __init__(self, parent=None):
        QtGui.QMainWindow.__init__(self, parent)
        self.worker = None

    def makeWorker(self):
        #create new thread
        self.worker = Worker(work_to_do)
        #connect thread to GUI function
        QtCore.QObject.connect(self.worker, QtCore.SIGNAL('progressUpdated'), self.updateWorkerProgress)
        QtCore.QObject.connect(self.worker, QtCore.SIGNAL('resultsReady'), self.updateResults)
        #start thread
        self.worker.start()

    def updateResults(self):
        results = self.worker.results
        #display results in the GUI

    def updateWorkerProgress(self, msg)
        progress = self.worker.progress
        #update progress bar and display msg in status bar

class Worker(QtCore.QThread):

    __pyqtSignals__ = ( "resultsReady", 
                        "progressUpdated" )

    def __init__(self, work_queue):
        self.progress = 0  
        self.results = []
        self.work_queue = work_queue
        QtCore.QThread.__init__(self, None)

    def run(self):
        #do whatever work
        num_work_items = len(self.work_queue)
        for i, work_item in enumerate(self.work_queue):
            new_progress = int((float(i)/num_work_items)*100)
            #emit signal only if progress has changed
            if self.progress != new_progress:
                self.progress = new_progress
                self.emit(QtCore.SIGNAL("progressUpdated"), 'Working...')
            #process work item and update results
            result = processWorkItem(work_item)
            self.results.append(result)
        self.emit(QtCore.SIGNAL("resultsReady")) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:16:54.820

我相信您的绘图线程可以使用 QApplication.postEvent 向主线程发送事件。您只需要选择一些对象作为事件的接收者。[更多信息](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/qcoreapplication.html#postEvent)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T20:24:32.400

扩展 Jeff 的回答：[关于线程支持的 Qt 文档](http://doc.trolltech.com/4.5/threads.html#signals-and-slots-across-threads)指出，可以使事件处理程序（Qt 用语中的插槽）在“拥有”对象的线程中执行。

因此，在您的情况下，您将在表单上定义一个插槽 printImage(QImage)，并在创建图像的任何内容上定义一个 doneDrawing(QImage) 信号，然后使用排队或自动连接将它们连接起来。

# javascript - 使用 jQuery 生成无序列表

> ID：812875
> 
> 赞同：0
> 
> 时间：2009-05-01T19:28:25.763
> 
> 标签：javascript, jquery

**有无序列表**，在 IE6-7 中不能正常工作，我想**用 jQuery 函数替换它**。

所以，我们有：

*   带有特殊 #id (ul id="") 的简单列表
*   一些`<li>`标签
*   一些特殊的标签`<li>`来显示行数（或其他东西，如你所愿）。

我需要一个函数，它会为每一行提供一个唯一的数字，从无序列表的开头到结尾。(ul)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:39:05.037

```
<ul><li>test</li><li>test</li><li>test</li><li>test</li><li>test</li><li>test</li><li>test</li></ul>

$(document).ready(function(){   
    var increment=3;
    var start=8;
    $("ul").children().each(function(i) {
        $(this).prepend('<tag>'+(start+i*increment).toString()+'.</tag>');
    });
}); 
```

结果：

```
* 8\. test
* 11\. test
* 14\. test
* 17\. test
* 20\. test
* 23\. test
* 26\. test 
```

编辑：没有增量和更短：

```
$(document).ready(function(){   
    $("ul").children().each(function(i) {
        $(this).prepend('<b>'+(1+i).toString()+'.</b> ');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T19:31:50.920

我认为这应该有效，不是吗？

```
$(function() {
    $('#the_ul_ID li').each(function(i) { $(this).attr('rel',++i); });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-22T02:49:32.497

参考这篇文章[Generating an unordered list with jQuery](https://stackoverflow.com/questions/812875/generating-an-unordered-list-with-jquery/812908#812908)

有没有办法使用 ul 重新开始计算另一个列表？有了上面的代码，这就是我得到的！ `<ul> <li> test <li> test <li> test <ul/>`

输出
1\. 测试
2\. 测试
3\. 测试

第二个 ul 列表

`<ul> <li> test <li> test <li> test <ul/>`

输出
4\. 测试
5\. 测试
6\. 测试

而不是以 1\. 2\. 3\. 开始第二个 ul 标签，而是使用第一个 ul 5\. 6\. 7 继续计数。

那么是否可以重新设置计数并为另一个 ul 标签重新加注星标？

# jquery - 当 iframe 的父窗口滚动时，帮助我在 iframe 中重新居中 ModalPopup

> ID：812876
> 
> 赞同：2
> 
> 时间：2009-05-01T19:28:29.337
> 
> 标签：jquery, iframe, modalpopupextender, modalpopups, microsoft-ajax

我有一个带有 iframe 的网页（我不喜欢它，但它必须这样）。它不是跨域 iframe，因此无需担心。

我编写了一个 jQuery 扩展，它根据 iframe 父级的宽度和高度对 ModalPopup（从重写的**AjaxControlToolkit.ModalPopupBehavior._layout**方法调用）进行居中，因此即使 iframe 不在其中，它也看起来居中页面的中心。这是很多棘手的事情，特别是因为我添加了 iframe 以在 quirks 模式下运行的网页。

现在，我还覆盖了**AjaxControlToolkit.ModalPopupBehavior._attachPopup**，这样当父窗口调整大小或滚动时，iframe 中心器内部的 ModalPopup 本身相对于父窗口的新大小。但是，将弹出窗口附加到父窗口的*调整大小*事件的相同代码不适用于父窗口的*滚动*事件。请参阅下面的代码和注释：

```
AjaxControlToolkit.ModalPopupBehavior.prototype._attachPopup = function() {
    /// <summary>
    /// Attach the event handlers for the popup to the PARENT window
    /// </summary>
    if (this._DropShadow && !this._dropShadowBehavior) {
        this._dropShadowBehavior = $create(AjaxControlToolkit.DropShadowBehavior, {}, null, null, this._popupElement);
    }
    if (this._dragHandleElement && !this._dragBehavior) {
        this._dragBehavior = $create(AjaxControlToolkit.FloatingBehavior, {"handle" : this._dragHandleElement}, null, null, this._foregroundElement);
    }        
    $addHandler(parent.window, 'resize', this._resizeHandler); // <== This WORKS
    $addHandler(parent.window, 'scroll', this._scrollHandler); // <== This DOES NOT work
    this._windowHandlersAttached = true;
} 
```

谁能向我解释为什么调整大小事件有效而滚动事件无效？有什么建议或替代方案可以帮助我吗？我正在使用 jQuery，所以如果我可以使用除了 MS 的 $addHandler 方法之外的其他东西，那很好。请注意，我还必须重写 _detachPopup 函数以删除处理程序，因此我需要考虑到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T19:43:45.413

没关系，怪癖模式又咬我了。从父级获取 scrollTop 位置失败，因为它的 documentElement 不存在。我换了

```
$(top.window.document.documentElement).scrollTop(); 
```

到

```
$(top.window.document.body).scrollTop(); 
```

在我的 jQuery 扩展居中代码中，现在很高兴。

# ruby-on-rails - rails replace path in string

> ID：812880
> 
> 赞同：0
> 
> 时间：2009-05-01T19:29:35.917
> 
> 标签：ruby-on-rails, string, replace

I have a string that may have a path to a file. Example src="/folder/whatever". How do I replace that path with src="http://www.sitename.com/folder/whatever ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:35:43.610

If your string contains `src="/..."`, possibly many times, do this:

```
string.gsub!(/\bsrc="(\/[^"]*)"/, 'src="http://www.sitename.com\1"') 
```

If your string contains the URL only, do this:

```
src.replace('http://www.sitename.com' + src) 
```

More information about `String#gsub` and `String#gsub!` here: [http://www.ruby-doc.org/core/classes/String.html#M000832](http://www.ruby-doc.org/core/classes/String.html#M000832)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:55:07.550

[路线助手](http://api.rubyonrails.org/classes/ActionController/Resources.html)。使用 url 而不是路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T20:56:49.070

我喜欢pts的解决方案，但我可能会从正则表达式中删除斜线......所以它会是：

```
string.gsub!(/\bsrc="([^"]*)"/, 'src="replacement_text\1"') 
```

使用 \1 访问反向引用

# powershell - 如何在 PowerShell 中使用 @ 字符

> ID：812882
> 
> 赞同：3
> 
> 时间：2009-05-01T19:29:49.583
> 
> 标签：powershell

我正在尝试执行以下操作 - 对于当前目录中的每个 *.sql 文件运行

```
sqlplus username/password@connect_identifier_specified_in_argument @file_name 
```

这是我到目前为止所拥有的：

```
$scripts = dir *.sql
foreach($script in $scripts) {
    Write-Host sqlplus username/password"@"$args "@"$script.Name
} 
```

（我知道 Write-Host 将其输出到屏幕上；我现在只是尝试调试。）

然而，PowerShell 处理`@`角色的方式有些奇怪，当我运行它时，我总是得到类似的东西：

```
PS C:\code\scripts> C:\utils\run_sql_scripts_on.ps1 identifier
sqlplus username/password@identifier @ ALERTS.sql 
```

看到“@”后面的那个空格了吗？是什么赋予了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T19:34:05.750

`@`用反引号 (`)转义。

```
Write-Host sqlplus username/password`@$args `@$script.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:37:44.773

[PowerShell Community Extensions](http://pscx.codeplex.com)有一个方便的小工具（echoargs）来调试这类问题：

```
5>echoargs username/password"@"$args "@"$script.Name
Arg 0 is <username/password@>
Arg 1 is <@>
Arg 2 is <test.txt> 
```

尝试用反引号转义：

```
6>echoargs "username/password`@$args" "`@$($script.Name)"
Arg 0 is <username/password@>
Arg 1 is <@test.txt> 
```

# java - 为 Java jar 分配更多堆空间

> ID：812883
> 
> 赞同：9
> 
> 时间：2009-05-01T19:29:54.403
> 
> 标签：java, memory, jar, heap-memory

当您通过命令行运行程序时，您可以使用`java -Xms -Xmx`来指定堆大小。如果程序要通过双击 .jar 文件来运行，有没有办法使用比标准更多的堆？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T19:32:12.383

不，这就是为什么我经常使用这些参数制作一个 .bat 或 .sh 文件并指导用户运行它而不是 .jar。不幸的是，不得不弹出一个命令提示符窗口有点难看，但这无济于事。

附带的好处是，如果您的应用程序冻结，您可以指导用户放入`pause`批处理文件（或自己做），然后您可以看到发生的任何堆栈跟踪。

**编辑：**您还可以使用可执行包装器，例如[JSmooth](http://jsmooth.sourceforge.net/)或[Launch4J](http://launch4j.sourceforge.net/)，而不是批处理文件。但是，您会失去一些跨平台兼容性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T19:33:06.377

您可以使用运行 .jar 的批处理文件，而不是直接双击 .jar 文件`java -jar -Xms -Xmx your_file.jar`。从用户的角度来看，它是相同的，但它使您可以更好地控制实际运行的命令。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T20:53:43.860

您可以使用带有所需选项的 Runtime.getRuntime().exec() 让 jar 重新启动。jar 可以包含多个 main() 方法（在不同的类中），您可以通过 exec() 调用另一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T19:38:48.813

您可以使用[JSmooth](http://jsmooth.sourceforge.net/)或类似的包装器，它会创建一个 EXE 文件，该文件使用必要的参数启动 JVM。这样您就可以避免使用 .bat 文件及其控制台对话框。还有一种方法是使用 Runtime.exec 或 ProcessBuilder 在新进程中启动实际程序。

# sql - SQL Server 索引 哪些应该是集群的？

> ID：812891
> 
> 赞同：7
> 
> 时间：2009-05-01T19:32:07.673
> 
> 标签：sql, sql-server, sql-server-2005, indexing

我在一些表上有许多索引，它们都很相似，我想知道聚集索引是否在正确的列上。以下是两个最活跃指数的统计数据：

```
Nonclustered
I3_Identity (bigint)
rows: 193,781
pages: 3821
MB: 29.85
user seeks: 463,355
user_scans: 784
user_lookups: 0
updates: 256,516

Clustered Primary Key
I3_RowId (varchar(80))
rows: 193,781
pages: 24,289
MB: 189.76
user_seeks: 2,473,413
user_scans: 958
user_lookups: 463,693
updates: 2,669,261 
```

如您所见，PK 经常被搜索，但 i3_identity 列的所有搜索也在对该 PK 进行键查找，所以我真的从 I3_Identity 上的索引中受益很多吗？我应该改为使用 I3_Identity 作为集群吗？这可能会产生巨大的影响，因为这个表结构在我工作的地方重复了大约 10000 次，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T20:37:57.343

Frederik 总结得很好，这也是 Kimberly Tripp 所宣扬的：集群密钥应该是稳定的（永不改变）、不断增加的（IDENTITY INT）、小而独特。

在您的场景中，我宁愿将集群键放在 BIGINT 列上，而不是 VARCHAR(80) 列上。

首先，使用 BIGINT 列，强制执行唯一性相当容易（如果您自己不强制执行并保证唯一性，SQL Server 将为您的每一行添加一个 4 字节的“唯一性”）而且它非常平均小于 VARCHAR(80)。

为什么尺寸如此重要？集群键也将被添加到每个非集群索引和每个非集群索引中——所以如果你有很多行和很多非集群索引，40-80 字节与 8 字节可以很快产生巨大的影响不同之处。

另外，另一个性能提示：为了避免所谓的书签查找（从非聚集索引中的值通过聚集键进入实际的数据叶页），SQL Server 2005 引入了“包含列”的概念在您的非聚集索引中。这些非常有帮助，但经常被忽视。如果您的查询通常需要索引字段加上数据库中的一两个其他字段，请考虑包括这些字段以实现所谓的“覆盖索引”。再次 - 请参阅 Kimberly Tripp 的优秀文章 - 她是 SQL Server 索引女神！:-) 她可以比我更好地解释这些东西......

所以总结一下：把你的集群键放在一个小的、稳定的、独特的列上——你会做得很好！

马克

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T20:16:31.030

快速'n脏：

将聚集索引放在：

*   一个值（几乎）永远不会改变的列

*   新记录上的值按顺序增加/减少的列

*   您执行范围的列 - 搜索

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T20:13:40.630

这是我发现的关于该主题[的最佳讨论。](http://www.sqlskills.com/BLOGS/KIMBERLY/post/The-Clustered-Index-Debate-Continues.aspx)Kimberly Tripp 是一位关注辩论的 MS 博主。我可以为您解释，但您显然不了解基本的单词和概念，并且文章的可读性很高。所以享受吧！

提示：你会发现简短的答案几乎总是过于简单化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T20:07:22.393

从我过去读到的内容来看，关于索引表的两个最重要的衡量标准是针对索引执行的查询数量和索引密度。通过使用 DBCC_SHOWSTATISTICS([table],[index])，您可以检查索引密度。这个想法是您希望在为每个查询提供最大区别的列上使用聚簇索引。

简而言之，如果您查看来自 DBCC SHOW_STATISTICS 的“所有密度”度量并注意到该数字非常低，那么这是一个很好的集群索引。在提供更多唯一性的索引上进行集群是合乎逻辑的，但前提是它被主动查询。在很少使用的索引上进行聚类可能弊大于利。

最后，这是一个判断电话。您可能想与您的 DBA 交谈并分析您的代码，以了解您将获得最大收益的地方。在这个有限的示例中，如果您只考虑使用情况，您的索引似乎聚集在正确的区域（即使您考虑所有密度，因为主键提供了您可以召集的最大唯一性。）

编辑：MSDN 上有一篇很好的文章解释了 SHOW_STATISTICS 为您提供了什么。我当然不是超级 DBA，但我在这里提供的大部分信息都来自我们的 DBA 提供的指导 :)

这是文章：http: [//msdn.microsoft.com/en-us/library/ms174384.aspx](http://msdn.microsoft.com/en-us/library/ms174384.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T20:18:47.750

通常，当我看到对主键/聚集键的键查找时，这意味着我需要在非聚集键中包含（使用 INCLUDE 语句）更多列。查看您的查询并查看在这些语句中选择/使用了哪些列。如果将这些列包含在非聚集键中，则不再需要进行键查找。

# c# - 如何在 .Net 中与 PKCS #11 兼容的 HSM 设备交互？

> ID：812894
> 
> 赞同：2
> 
> 时间：2009-05-01T19:33:28.387
> 
> 标签：c#, security, encryption, pkcs#11, hsm

我应该用 C# 编写一个与[Thales WebSentry](http://www.thales-esecurity.com/productsservices/WebSentry.shtml)通信的客户端应用程序，我需要一些关于如何开始的提示。

设备附带 Java SDK，但我需要在 .NET 中进行编程。.NET 中是否有我可以使用的库，或者我必须全部在低级（直接到套接字）中完成。关于如何以及从哪里开始的任何提示或指示？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:38:49.167

如果模块符合 PKCS#11，则在开发工具包中的某处应该有一个 .dll 来实现 PKCS#11 API。谷歌搜索似乎表明它被称为`wspkcs11d.dll`.

您应该能够 P/Invoke 到 PKCS#11 库。如果 Thales 没有为该库提供文档，您可以在[此处](http://www.rsa.com/rsalabs/node.asp?id=2133)找到文档（但请注意，它们很可能仅支持完整标准的一个子集）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-31T10:31:20.317

PKCS#11 有一个 CAPI 提供程序，它被称为 csp11，尽管它不支持私有对象（您无法登录到令牌）。

最简单的方法是从 c# 调用 pkcs11 库，调用 C_GetFunctionList 以获取指向该库公开的其他函数的指针。然后调用 C_Initialize，您也可以将它与 thales-ncipher 的其他新 PKCS#11 内容一起使用，

# python - 如何调试 wxpython 应用程序？

> ID：812911
> 
> 赞同：19
> 
> 时间：2009-05-01T19:40:11.930
> 
> 标签：python, user-interface, wxpython

我是第一次尝试 wxpython。我已经为 python 程序编写了一个 GUI，当我运行它时，它会在 GUI 中产生一些错误，但是 GUI 很快就会消失，快到让我无法读取错误信息。

是否有任何日志可以检查错误消息？（我正在运行 Mac OS X）或任何其他方式？

提前感谢您的帮助。

更新：这是给我问题的代码......

```
#!/usr/bin/python

import wx

class MyApp (wx.Frame):
    def __init__(self, parent, id, title):
        wx.Frame.__init__(self, parent, id, title, size=(390, 350))
    menubar = wx.MenuBar()
    help = wx.Menu()
    help.Append(ID_ABOUT, '&About')
    self.Bind(wx.EVT_MENU, self.OnAboutBox, id=wx.ID_ABOUT)
    menubar.Append(help, '&Help')
    self.SetMenuBar(menubar)

    self.Centre()
    self.Show(True)

    panel = wx.Panel(self, -1)

    font = wx.SystemSettings_GetFont(wx.SYS_SYSTEM_FONT)
    font.SetPointSize(9)

    vbox = wx.BoxSizer(wx.VERTICAL)

    hbox1 = wx.BoxSizer(wx.HORIZONTAL)
    st1 = wx.StaticText(panel, -1, 'Class Name')
    st1.SetFont(font)
    hbox1.Add(st1, 0, wx.RIGHT, 8)
    tc = wx.TextCtrl(panel, -1)
    hbox1.Add(tc, 1)
    vbox.Add(hbox1, 0, wx.EXPAND | wx.LEFT | wx.RIGHT | wx.TOP, 10)

    vbox.Add((-1, 10))

    hbox2 = wx.BoxSizer(wx.HORIZONTAL)
    st2 = wx.StaticText(panel, -1, 'Matching Classes')
    st2.SetFont(font)
    hbox2.Add(st2, 0)
    vbox.Add(hbox2, 0, wx.LEFT | wx.TOP, 10)

    vbox.Add((-1, 10))

    hbox3 = wx.BoxSizer(wx.HORIZONTAL)
    tc2 = wx.TextCtrl(panel, -1, style=wx.TE_MULTILINE)
    hbox3.Add(tc2, 1, wx.EXPAND)
    vbox.Add(hbox3, 1, wx.LEFT | wx.RIGHT | wx.EXPAND, 10)

    vbox.Add((-1, 25))

    hbox4 = wx.BoxSizer(wx.HORIZONTAL)
    cb1 = wx.CheckBox(panel, -1, 'Case Sensitive')
    cb1.SetFont(font)
    hbox4.Add(cb1)
    cb2 = wx.CheckBox(panel, -1, 'Nested Classes')
    cb2.SetFont(font)
    hbox4.Add(cb2, 0, wx.LEFT, 10)
    cb3 = wx.CheckBox(panel, -1, 'Non-Project classes')
    cb3.SetFont(font)
    hbox4.Add(cb3, 0, wx.LEFT, 10)
    vbox.Add(hbox4, 0, wx.LEFT, 10)

    vbox.Add((-1, 25))

    hbox5 = wx.BoxSizer(wx.HORIZONTAL)
    btn1 = wx.Button(panel, -1, 'Ok', size=(70, 30))
    hbox5.Add(btn1, 0)
    btn2 = wx.Button(panel, -1, 'Close', size=(70, 30))
    hbox5.Add(btn2, 0, wx.LEFT | wx.BOTTOM , 5)
    vbox.Add(hbox5, 0, wx.ALIGN_RIGHT | wx.RIGHT, 10)

    panel.SetSizer(vbox)
    self.Centre()
    self.Show(True)

    def OnAboutBox(self, event):
        description = """ describe my app here """

        licence = """ blablabla """

        info = wx.AboutDialogInfo()

        info.SetIcon(wx.Icon('icons/icon.png', wx.BITMAP_TYPE_PNG))
        info.SetName('')
        info.SetVersion('1.0')
        info.SetDescription(description)
        info.SetCopyright('')
        info.SetWebSite('')
        info.SetLicence(licence)
        info.AddDeveloper('')
        info.AddDocWriter('')
        info.AddArtist('')
        info.AddTranslator('')

        wx.AboutBox(info) 

app = wx.App()
MyApp (None, -1, 'Go To Class')
app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-02T08:24:49.720

不确定 mac 版本，但是 wxPython 有一个内置的方法来将错误重定向到一个窗口（不幸的是，当你的应用程序崩溃时它会关闭，但它对于捕获静默失败的错误很有用）或日志文件（仅在你更新应用程序关闭）：

```
app = wx.App(redirect=True) 
app = wx.App(redirect=True,filename="mylogfile.txt") 
```

无论您如何启动应用程序，这些都将起作用。看[这里](http://xoomer.virgilio.it/infinity77/wxPython/Widgets/wx.App.html#methods)了解更多

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T20:23:01.373

这是一种通过 MessageDialog 在 GUI 而不是控制台中报告错误的方法。您可以在任何捕获到异常的地方使用 show_error() 方法，这里我只是让它在最顶层被捕获。如果可以处理错误，您可以更改它，以便应用程序在错误发生后继续运行。

```
import wx
import sys
import traceback

def show_error():
    message = ''.join(traceback.format_exception(*sys.exc_info()))
    dialog = wx.MessageDialog(None, message, 'Error!', wx.OK|wx.ICON_ERROR)
    dialog.ShowModal()

class Frame(wx.Frame):
    def __init__(self):
        super(Frame, self).__init__(None, -1, 'My Frame')
    def cause_error(self):
        raise Exception, 'This is a test.'

def main():
    app = wx.PySimpleApp()
    try:
        frame = Frame()
        frame.Show()
        frame.cause_error()
        app.MainLoop()
    except:
        show_error()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T20:37:24.757

从带有调试器的 Python IDE 启动。

在[WingIDE](http://www.wingware.com/products)中运行立即查明两个问题：

*   `ID_ABOUT`应该是`wx.ID_ABOUT`（第 4 行`__init__`）。
*   `OnAboutBox`（整个方法）缩进一步太多了。如所写，它是内部的一个本地函数`__init__`。将整个方法向左移动一步，使其成为 的方法`MyApp`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T19:45:16.800

从命令行启动应用程序（我相信它在 OS X 中称为“终端”），如下所述，而不是双击 python 文件。这样，当应用程序崩溃时，您将看到堆栈跟踪。

> python NameOfScript.py

或者，您可以将输出重定向到日志文件：

```
f=open('app.log','w')
import sys
sys.stdout=f
sys.stderr=f 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T20:03:31.560

将打印语句添加到您的程序中，这样您就可以知道它是如何启动的以及它最终在哪里死亡（通过从终端运行，就像您已经说过的那样）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T20:09:56.723

您还可以从 Python IDE 运行您的项目，例如[Eric IDE](http://eric-ide.python-projects.org/)。您可以获得额外的好处，即能够追踪、观察变量和大量其他很酷的东西！:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-04T19:04:06.703

如果您使用的是 Spyder，请按 F6，选中“执行后与 python 解释器交互”。窗口不会关闭，您可以看到错误消息。

# xslt - Retrieve page URL params or page URL in XSLT

> ID：812912
> 
> 赞同：2
> 
> 时间：2009-05-01T19:40:25.907
> 
> 标签：xslt

I have a page which has URL structure : [http://www.abc.com/xyz?parama=1&paramb=2](http://www.abc.com/xyz?parama=1&paramb=2)

*   Is is possible to create a generic method for getting the values of any additional params the URL maybe (parama=1&paramb=2)

*   Is is possible to get the URL of the page in XSL similar to javascript's location.href ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:47:33.920

> 是否可以在类似于 javascript 的 location.href 的 XSL 中获取页面的 URL？

**不完全相同的方式，但是是的，查询字符串可以作为参数传递**。

> 是否可以创建一个通用方法来获取 URL 可能的任何附加参数的值 (parama=1¶mb=2)

**是的，可以执行标记化（使用**[`tokenize()`](http://www.w3.org/TR/xpath-functions/#func-tokenize)****在 XSLT 2.0 或 XSLT 1.0 中使用**[`str-split-to-words`](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/strSplit-to-Words.xsl?view=markup)****[**FXSL 1.x](http://fxsl.sf.net)****的模板**或自写的递归标记化模板。）****

 ******XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>

   <xsl:import href="strSplit-to-Words.xsl"/>

   <xsl:output indent="yes" omit-xml-declaration="yes"/>
     <xsl:param name="pQString" select=
     "'?parama=1&amp;paramb=2&amp;anyParamName=AnyValue'"
     />

    <xsl:template match="/">
    <xsl:variable name="vwordNodes">
      <xsl:call-template name="str-split-to-words">
        <xsl:with-param name="pStr" select="$pQString"/>
        <xsl:with-param name="pDelimiters"
                  select="'?&amp;'"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:apply-templates select=
     "ext:node-set($vwordNodes)/*
     "/>
    </xsl:template>

    <xsl:template match="word">
      <xsl:value-of select="."/>
      <xsl:text>&#xA;</xsl:text>
    </xsl:template>
</xsl:stylesheet> 
```

**当上述转换应用于任何 XML 文档（将不使用）时，会产生所需的结果**：

```
parama=1
paramb=2
anyParamName=AnyValue 
```

**请注意** *FXSL 1.x`str-split-to-words`模板的使用和 EXSLT`ext:node-set()`扩展功能*的使用。

**XSLT 2.0 解决方案**：

```
 <xsl:param name="pQString" as="xs:string" select=
 "'?parama=1&amp;paramb=2&amp;anyParamName=AnyValue'"
 />

<xsl:template match="/">
  <xsl:value-of separator="&#xA;" select=
  "tokenize($pQString, '\?|&amp;')
  "/>
</xsl:template> 
```

**当执行上述 XSLT 2.0 转换时，它会产生正确的结果**：

```
parama=1
paramb=2
anyParamName=AnyValue 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:47:51.130

This might be possible using [EXSLT](http://www.exslt.org/), or registering a function callback with your particular xslt processor, but not with plain old XSLT, at least not to my knowledge. With plain XSLT, if it isn't in the XML, then it doesn't exist.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T19:48:31.380

If it is client side, there isn't any way of doing this. Unfortunately, xsl is very limited in the browser. I'm afraid you will need to move the functionality to the webapp or to javascript.

If the transform is server side, there might be something you can do.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-29T17:05:51.347

我通过在 mi XSLT 文件中使用 javascript 来解决这个问题。看一看。

在 XML 上，我有一个名为 tag 的标记元素！是的，非常原始...

```
<tag url="http://www.demo.net/share.php?u=param1 /> 
```

米样本变换

```
<div class="HelloDiv">
        <xsl:for-each select="tag">
          <a href="{@url}">
            This is my custom URL
          </a>
        </xsl:for-each>
</div> 
```

现在在转换的模板中，在这种情况下，我将在 Param1 中加载我的自定义值，我将使用 document.title.. 通过使用 jquery 函数。

```
 <script type="text/javascript">
      jQuery(function(){
        jQuery('div.HelloDiv a').each(function(){
          var parameter = jQuery(this).attr('href');
          parameter = currentUrl.replace('param1',escape(document.title));
          jQuery(this).attr('href',parameter);
        })
      });
  </script> 
```

# browser - 查询字符串的最大可能长度是多少？

> ID：812925
> 
> 赞同：625
> 
> 时间：2009-05-01T19:44:15.647
> 
> 标签：browser, max, query-string

它依赖于浏览器吗？此外，不同的 Web 堆栈对从请求中获取的数据量有不同的限制吗？

* * *

## 回答 #1

> 赞同：1080
> 
> 时间：2009-05-01T19:53:30.400

[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)（超文本传输​​协议 - HTTP/1.1）声明查询字符串的长度没有限制（第 3.2.1 节）。[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)（统一资源标识符 — URI）也声明没有限制，但指出由于 DNS 限制，主机名限制为 255 个字符（第 2.3.3 节）。

虽然规范没有指定任何最大长度，但实际限制是由网络浏览器和服务器软件强加的。基于研究，不幸的是其原始网站上不再提供（它导致一个看似可疑的贷款网站），但仍然可以[在 Boutell.com 的 Internet 档案中](https://web.archive.org/web/20170503192739/https://boutell.com/newfaq/misc/urllength.html)找到：

*   **Microsoft Edge（浏览器）**
    限制似乎约为 81578 个字符。请参阅[Microsoft Edge 的 URL 长度限制](https://stackoverflow.com/questions/32267442/url-length-limitation-of-microsoft-edge)

*   **Chrome**
    它在 64k 个字符后停止*显示*URL，但可以提供超过 100k 个字符。除此之外没有进行进一步的测试。

*   **Firefox（浏览器）**
    在 65,536 个字符之后，位置栏不再显示 Windows Firefox 1.5.x 中的 URL。但是，更长的 URL 也可以。100,000 个字符后没有进行进一步的测试。

*   **Safari（浏览器）**
    至少 80,000 个字符可以使用。除此之外没有尝试过测试。

*   **Opera（浏览器）**
    至少可以使用 190,000 个字符。在 190,000 个字符后停止测试。Opera 9 for Windows 继续在地址栏中显示完全可编辑、可复制和可粘贴的 URL，即使是 190,000 个字符。

*   **Microsoft Internet Explorer（浏览器）**
    Microsoft 声明 Internet Explorer 中 URL 的最大长度为 2,083 个字符，URL 的路径部分不超过 2,048 个字符。尝试使用比这更长的 URL 会在 Internet Explorer 中产生明确的错误消息。

*   **Apache（服务器）**
    早期尝试在 Web 浏览器中测量最大 URL 长度时遇到了服务器 URL 长度限制，大约为 4,000 个字符，之后 Apache 产生“413 Entity Too Large”错误。使用了 Red Hat Enterprise Linux 4 中最新的 Apache 构建。官方 Apache 文档仅提及请求中单个字段的 8,192 字节限制。

*   **Microsoft Internet Information Server (Server)**
    默认限制为 16,384 个字符（是的，Microsoft 的 Web 服务器接受比 Microsoft 的 Web 浏览器更长的 URL）。这是可配置的。

*   **Perl HTTP::Daemon (Server)**
    最多 8,000 字节可以工作。那些使用 Perl 的 HTTP::Daemon 模块构建 Web 应用程序服务器的人将遇到所有 HTTP 请求标头的总大小限制为 16,384 字节。这不包括 POST 方法的表单数据、文件上传等，但它确实包括 URL。实际上，当 URL 明显超过 8,000 个字符时，这会导致 413 错误。这个限制可以很容易地消除。在 Daemon.pm 中查找所有出现的 16x1024 并将它们替换为更大的值。当然，这确实会增加您遭受拒绝服务攻击的风险。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2018-01-12T16:37:00.433

**建议的安全性和性能最大值：2048 个字符**

尽管官方没有 RFC 2616 规定的限制，但许多安全协议和建议规定服务器上的 maxQueryStrings 应设置为最大字符限制 1024。而整个 URL（包括查询字符串）应设置为最大 2048人物。这是为了防止 Web 服务器上的慢速 HTTP 请求 DDOS/DOS 攻击漏洞。这通常显示为 Qualys Web 应用程序扫描程序和其他安全扫描程序上的漏洞。

请参阅以下带有 Web.config 的 Windows IIS 服务器的示例代码：

```
<system.webServer>
<security>
    <requestFiltering>
        <requestLimits maxQueryString="1024" maxUrl="2048">
           <headerLimits>
              <add header="Content-type" sizeLimit="100" />
           </headerLimits>
        </requestLimits>
     </requestFiltering>
</security>
</system.webServer> 
```

这也适用于使用 machine.config 的服务器级别。

这仅适用于基于 Windows 操作系统的服务器，我不确定 apache 或其他服务器上是否存在类似问题。

注意：限制查询字符串和 URL 长度可能无法完全阻止慢速 HTTP 请求 DDOS 攻击，但这是您可以采取的阻止它的一个步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:52:11.243

不同的 Web 堆栈确实支持不同长度的 http 请求。我从经验中知道，早期的 Safari 堆栈仅支持 4000 个字符，因此由于 USER-STATE 而难以处理 ASP.net 页面。这甚至适用于 POST，因此您必须检查浏览器并查看堆栈限制是多少。我认为即使在较新的浏览器上您也可能会达到限制。我不记得但其中一个（我认为是 IE6）有 16 位限制，32,768 或其他限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-05T14:16:47.833

## **2048 个字符**

> 虽然**官方没有****RFC 2616**指定限制，但许多安全协议和建议声明服务器上的**maxQueryStrings** 应设置为最大字符限制**1024**。而整个 URL（包括查询字符串）应设置为最多**2048**个字符。块引用
> 
> 如果 URL超过**100 个字符，则认为 URL****太长**。**过长的 URL 可能**会导致可用性和**搜索引擎：包含****关键字**可能带来的任何潜在好处都将被稀释，因为它在总**URL** 文本中所占的比例很小。

 ******# c - "Direction" of bidimensional arrays in C

> ID：812931
> 
> 赞同：2
> 
> 时间：2009-05-01T19:45:39.857
> 
> 标签：c, arrays

as a C newcomer I'm a bit confused about bidimensional arrays.

If I want to represent a matrix of 3 rows and 5 columns, I guess the correct declaration is:

```
char a[3][5]; 
```

So, is this an array of 3 pointers to 5 arrays of chars or what?

How come whenever I try to cycle through it like the following it seems to read the wrong results?

```
int x, y;
for( x=0; x<3; x++ ){
    for( y=0; y<3; y++ ){
        printf( "%c", a[x][y] );
    }
} 
```

Are the following equivalent and correct ways to initialize it?

```
char a[3][5] = {
               {1,0,0,0,1},
               {1,0,0,0,1},
               {1,0,0,0,1},
               };

char a[3][5] = {1,0,0,0,1,
                1,0,0,0,1,
                1,0,0,0,1}; 
```

Thanks for any eventual upcoming explanation.

* * *

EDIT

Sorry the typos, the code is not copied. By the way, I keep on having them read like they where read in a vertical way, not in a horizontal one.

Also in the example in this tutorial [http://www.cplusplus.com/doc/tutorial/arrays/](http://www.cplusplus.com/doc/tutorial/arrays/) it reads the array in a way that is not streight-forward to me as it seems to work on a 5x3, Height*Width, y*x, cols*rows structure instead of a 3x5, Width*Height, x*y. rows*cols one:

```
#define WIDTH 5
#define HEIGHT 3

int jimmy [HEIGHT][WIDTH];
int n,m;

int main ()
{
  for (n=0;n<HEIGHT;n++)
    for (m=0;m<WIDTH;m++)
    {
      jimmy[n][m]=(n+1)*(m+1);
    }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T20:17:32.730

只是为了它是什么，什么不是。

```
char a[3][5]; 
```

不涉及指针。像这样的多维数组是......数组的数组，依此类推。在您的情况下，您有一个由 3 个 5 个字符组成的数组。当您使用 typedef 时，它会变得更加清晰。

```
typedef char T[5];
T a[3]; 
```

不涉及任何指针。如果要访问这 3 个数组中的第一个数组，可以这样做：

```
a[0]; 
```

它会给你一个类型的对象`char[5]`。通常，您不会注意到这一点，因为通常您索引所有维度。所以返回的数组`a[0]`是下一个索引的下标，例如`a[0][1]`. 将`[1]`应用于由 返回的数组，`a[0]`正如我们之前发现的那样，它的类型为`char[5]`。

> 那么，这是一个指向 5 个字符数组的 3 个指针的数组还是什么？

让我们创建那个类型，看看它与上面的有什么不同。创建它很简单，一旦你获得了基本的声明符：

*   创建指针：`*D`
*   创建一个数组：`D[N]`

D 只是一个现有的另一个声明符。所以现在让我们继续吧。首先你说`array of 3 pointers to 5 arrays of chars...`。我想你的意思是`array of 3 pointers to arrays of 5 chars`。首先，`array of 5`创建像

```
D1[5] 
```

现在，让我们用声明符替换 D1 `pointer to`：

```
(*D2)[5] 
```

我们必须插入括号，因为下标操作符`[N]`比解引用操作符绑定得更好`*`，否则它会被认为`*(D2[5])`不是我们想要的。现在我们有了`pointer to array of 5`.

现在让我们做`array of 3`. 替换`D2`为`D3[3]`：

```
(*D3[3])[5] 
```

太好了，现在我们有一个`array of 3 pointer to array of 5`. 只需放置该声明符所属的基类型即可产生完整的声明：

```
char (*D3[3])[5]; 
```

这当然是完全不同的事情 :) 您可以使用它来存储指向您的其他类型数组的指针`array of 3 arrays of 5 char`。让我们存储一个指向`a`into的第一个子数组的指针`D3[0]`。我们之前发现`a[0]`有 type `char[5]`。我们可以将指向该数组的指针存储到 中`D3[0]`，因为`D3`是指向 的指针数组，真是`char[5]`巧合！

```
D3[0] = &a[0]; // works! 
```

我希望这个小练习已经向您展示了指针和数组之间的一些关系。干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:49:09.520

You've got wrong results because you're using `x` twice (looks like a copy/paste error). Try

```
int x, y;
for (x = 0; x < 3; x++) {
    for (y = 0; y < 5; y++) {
        printf("%c", a[x][y]); // Emil H says "%d" might be more useful
    }
} 
```

**Edit:** I'm not sure what's confusing about that tutorial. It's precisely equivalent to your code, except instead of printing the array, it's setting each element to (row*column) (where both row and column are one-based, hence the +1's).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T19:52:03.290

I see a couple of problems with your code. First (copied from above):

```
int x, y;
for( x=0; x<3; x++ ){
    for( x=0; x<3; x++ ){
        printf( a[x][y] );
    }
} 
```

In your inner-loop, it looks like you want to use `y` instead of `x`, and you want `y` to go from 0..5\. Currently, you are repeating the variable x. Also, you have a problem with your printf() statement. Here's some corrected code:

```
int x, y;
for( x=0; x<3; x++ ){
    for( y=0; y<5; y++ ){
        printf("%d\n", a[x][y] );
    }
} 
```

Second, when you initialize your array, your code is *almost* correct. Here's the corrected version:

```
char a[3][5] = {
               {1,0,0,0,1},
               {1,0,0,0,1},
               {1,0,0,0,1}
               }; 
```

(I removed the `,` after the very last "row" of data - that was a syntax error.)

The 2nd syntax you posted is incorrect (the one with no curly braces).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T19:49:39.957

```
int x, y;
for( x=0; x<3; x++ ){
    for( x=0; x<3; x++ ){
        printf( a[x][y] );
    }
} 
```

You need to change the 2nd for loop to refer to 'y' instead of 'x'.

hope that helps.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T20:10:25.490

教程中的图像很好地代表了数据： [alt text http://www.cplusplus.com/doc/tutorial/arrays/bidimensional_arrays3.gif](http://www.cplusplus.com/doc/tutorial/arrays/bidimensional_arrays3.gif)

从示例中，嵌套`for`循环逐行遍历（左 -> 右）数组，并为每一列填充一个值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T20:35:38.333

当你可能想要“%d”时使用“%c”这样的小错误并不是你真正想要得到的答案，我谦虚地认为。您说您对数组有些困惑，并且还提到您希望将指针视为包含数组的数组的数组元素。你

数组数组定义中的最后一个逗号不是语法错误。从 C99 开始允许。

真正能解决问题的是知道数组不是指针。确实，数组名可以用作常量指针（指向第一个元素），并且指针可以像数组一样被索引。然而，这并不意味着数组和指针是相同的。他们不是。

您询问程序中的符号“a”实际上是什么。它是一个数组数组。内存布局可以被可视化为一条长线，分成三部分，但仍然是一条连续的线。然后以相同的方式将这些中的每一个切成五个部分。寻址一个元素时，必须使用两个索引；首先是你想要的五元素数组，然后是你想要的这个元素的五分之一。

内存布局不像行和列的网格。内存由一个标量寻址，因此它是线性的。指针算术可能是您可以研究的下一件事，并了解指针上的增量是如何工作的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T19:49:18.163

You're using printf in the wrong way. Try:

```
printf("%d", a[x][y]); 
```

I'm not sure whether you'll want to use %c or %d. If you want to print the number, use %d. If you want to print an actual character, use %c.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T20:14:45.230

> 字符 [3][5];
> 
> 那么，这是一个指向 5 个字符数组的 3 个指针的数组还是什么？

是的，就是这样。尽管您也可以将其作为一组连续的 15 个字符来操作。

按照惯例，大多数人会认为它表示一个 3 行 5 列的矩阵（我认为），但数据结构本身并没有什么需要。您可以轻松地使用它来表示 5 行和 3 列。或者 3 个集合，每个集合包含 5 个元素，但彼此之间根本没有任何有意义的关系。

用于进行矩阵操作的特定库对此有一个约定。

# database - best practices for database + resultset concurrency (both UI and control issues)

> ID：812937
> 
> 赞同：2
> 
> 时间：2009-05-01T19:47:04.470
> 
> 标签：database, concurrency, user-interface

I'm working on a viewer program that formats the contents of a database. So far it's all been read-only, and I have a Refresh button that re-queries the database if I want to make sure to use current data.

Now I'm looking at changing the viewer to an editor (read-write) which involves writing back to the database, and am realizing there are potential concurrency issues: if more than one user is working on the database then there are the possibilities of stale data & other concurrency bugaboos.

What I'm wondering is, **what are appropriate design patterns both for the database and the application UI to avoid concurrency problems?**

To be bulletproof, I could force the user to use an explicit transaction (e.g. it's in read-only mode most of the time, then they have to push an Edit button to start a transaction, then Commit and Revert buttons to commit or revert the transaction) but that seems clunky and wouldn't work well with large sets of changes (Edit, then 1 hour's worth of changes yields an overly large transaction and may prevent other people from making changes). Also it would suck if someone's making a bunch of changes and then it fails -- then what should they do to avoid losing that work?

It seems like I'd want to notify the user when the relevant data is being changed so that the granularity to changes is small and they get cued to refresh from the database & get in the habit of doing so.

Also, if there are updates, should I automatically bring them into the application display? (assuming they don't clobber what the user is working on) Or should the user be forced to explicitly refresh?

A great example, which is sort of close to the situation I'm working on, is filesystem explorers (e.g. Windows Explorer) which show a hierarchy of folders/directories and a list of objects within them. Windows Explorer lets you refresh, but there's also some notification from the filesystem to the Explorer window, so that if a new file is created, it will just appear in the viewport without you having to hit F5 to refresh.

I found these StackOverflow posts, but they're not exactly the same question:

*   [Web services and database concurrency](https://stackoverflow.com/questions/193047/web-services-and-database-concurrency)
*   [Distributed Concurrency Control](https://stackoverflow.com/questions/92452/distributed-concurrency-control)
*   [C# Database Application](https://stackoverflow.com/questions/709823/c-database-application-concurrency)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:58:56.190

1.  Only display one record for editing at a time.

2.  Submit new values conditionally, after applying whatever domain-specific validation is appropriate. If the record has changed in the meantime (most DAL-type software will throw an exception so you don't need to check manually), display the current (changed) values, advise the user, and accept another try (or abandon). You may want to indicate the source and timestamp of the change you are displaying.

That's the simplest reliable standard pattern I know of. Trying to induce the user to explicitly choose "Display" vs. "Edit" mode is problematic. It locks the record for some indeterminate amount of time, and it's not always reliable that you know when the user (for instance) gives up, turns off their computer, and goes home.

If you have a case where you have a parent record with editable child records (e.g. the line items on a purchase order), it gets more complex but let's worry about that later? There are patterns for those too.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-30T09:43:07.780

我使用的一种很好的工作方式：在真正将更改应用到 db 之前不要打开 tran（在用户按下保存按钮之后）甚至不需要在开始用户的编辑对话框之前刷新记录。但在应用更改之前，请检查您的应用代码中的其他用户是否更改了记录。它是在更新语句之前通过 select 语句完成的。如果数据库中不存在具有旧字段值（在 DataSet 中）的记录，则提醒用户“记录已被另一个用户更改”并且用户必须关闭对话框，刷新记录并再次开始编辑。否则打开 tran 和其余的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:32:24.667

乐观锁定适用于大多数情况下您的记录由简短的简单字段（例如，每个字段的短字符串或单个数值）组成，为用户提供对数据的最大访问权限，而不是强迫他们担心锁和其他东西。只有在实际保存记录的过程中才应用写锁。当任何人只是在编辑时，没有记录被锁定。如果应用程序发现它尝试保存的记录已被锁定，则应用程序只需稍后（<500 毫秒）重试。没有必要提醒用户（如果持续时间超过 500 毫秒，则可能是沙漏/指针反馈），因为没有任何锁存在足够长的时间来对用户产生影响。当用户 A 保存记录时，数据库仅更新用户 A 已更改的字段（以及依赖于这些更改值的任何其他字段）。

隐含的假设是，最后编辑记录字段的人拥有最终决定权，这不是一种不合理的经营方式。例如，用户 A 检索一条记录并编辑一个字段，然后用户 B 检索一条记录并编辑同一字段。用户 B 保存，然后用户 A 保存。用户 A 的更改覆盖了用户 B。用户 B 的工作是“浪费”，但是当用户共享数据时，这种事情无论如何都会发生。只有当用户碰巧尝试在同一时间段内编辑同一条记录时，锁定才能防止浪费工作。但是，更可能的情况是用户 B 编辑记录的字段并保存，然后用户 A 编辑字段并保存，再次浪费用户 B 的工作。您无法使用锁来防止这种情况发生。如果用户交互真的很有可能浪费工作​​，

至于 UI，我推荐两种服务器样式：（1）实时，和（2）事务。

*   在实时风格中，用户的显示会自动与数据库中的内容尽可能接近。刷新是基于短时间（每五秒）自动进行的，或者在其他人进行更改时“推送”给用户。当用户输入字段并进行编辑时，应用程序会禁止刷新该字段，但会继续刷新其他字段和记录。没有保存按钮或菜单项。每当用户编辑字段然后离开或按 Enter 键时，该应用程序都会保存记录。当用户开始编辑字段时，应用程序会更改字段的外观以指示事情是暂定的（例如，将字段周围的边框更改为虚线）以鼓励用户在完成后按 Enter 或 Tab。

*   在 Transactional 中，用户的显示显示为数据库中内容的快照。用户必须使用按钮或菜单项显式保存和手动刷新数据，除非应用程序应在用户开始编辑记录时或用户保存记录后自动刷新记录。用户可以在保存之前编辑任意数量的字段或记录。但是，您可以通过更改已编辑字段的外观以指示其暂定状态来鼓励频繁保存，就像实时推荐的那样。您还可以显示上次刷新的时间戳或其他指示，以鼓励用户频繁刷新。

通常，实时是首选。用户不必担心数据过时或因忘记保存而丢失大量工作。但是，如果需要保持足够的数据库性能，请使用 Transactional。如果更新字段通常需要超过 1.0 秒的服务器响应时间，您可能不需要实时。如果用户的编辑触发了难以逆转或可能产生浪费工作的重大事件（例如，更改预算值触发通知上级批准），您还应该考虑事务性。一个明确的保存命令很适合说，“好的，我已经检查了我的工作，让'er rip。”</p>

# jquery - ASP.NET PageMethods 和 JQuery AJAX Post – 它到底有多安全？

> ID：812945
> 
> 赞同：4
> 
> 时间：2009-05-01T19:48:57.087
> 
> 标签：jquery, ajax, security, asp.net-3.5, pagemethods

我有以下场景——我真正期待的是来自真实人的真正帮助。建议/解决方案？请。

我有一个 ex 的外联网网站。www.foo.com (asp.net 3.5) 我正在使用 JQuery 1.3.2 在 default.aspx 页面 (www.foo.com/default.aspx) 中调用 ValidateLogin PageMethods

代码将如下所示

```
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    url: "Default.aspx/ValidateLogin",
    data: '{' + arg + '}',
    success: function (data) {
        if (data.d != 0) {
            window.location = "http://www.google.com";
        } else {
            alert("Invalid UserName/Password.");
            ResetLoginForm();
        }
    },
    error: function (xhr, status, error) {
        var strerror = xhr.status + error;
        alert("Error Communicating with Server:" + strerror);
        ResetLoginForm();
    }
}); 
```

代码存储在外部 js 文件中。对于前 default.js。

由于这个网站是公开的，任何人都可以下载 default.js，从而可以查看上面给出的代码。

我的问题是一旦这个人得到这个网址：“Default.aspx/ValidateLogin”，他可以向服务器发出请求，服务器将自豪地响应请求。

我在这里有什么选择？我如何验证请求？如何防止此类未经授权的请求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T20:19:36.203

Web 请求本质上是公开的。他们甚至不需要查看源文件。他们可以简单地监视 HTTP 请求并重播这些请求（例如，使用 fiddler 之类的工具非常容易）。

## 节流问题

节流解决方案确实不可行，尽管它们会降低攻击率。问题是对手可以编写一个运行几天的脚本。再说一次，他可以使用代理来发送并行请求。如果你限制每个用户名，对手可以通过尝试对合法用户名进行虚假登录来实现 DoS，而当实际用户尝试登录时，他将不知道他为什么被锁定。

## 解决方案

典型的方法是使用 nonce 键。这将需要一些额外的工作，但它会缓解问题，并且仅在您确实预计会发生攻击或其他情况时才建议使用它。一个简化的版本是客户端将 nonce 键作为 URI 查询参数传递。密钥首先由服务器颁发给客户端。发出请求后，服务器会验证数据库中是否存在 nonce 键并允许请求。它会立即删除 nonce 密钥，因此用户无法使用相同的 nonce 密钥发出另一个请求，但是服务器将需要向用户发出更多的 nonce 密钥。

简化的解决方案是只允许经过身份验证的用户发出 Web 服务请求，但由于您正在设计一个登录系统，这显然不成立。

除非你有一些讨厌的对手，否则我不会担心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T23:48:34.750

我假设您已经公开了 Page 方法加载了会话，所以我想您可以在页面加载时设置一个会话变量，然后在调用页面方法时检查它是否存在。这不是世界上最安全的事情，但它会有所帮助。

就我个人而言，我不会费心让它变得更安全——正如其他人所说，Web 服务本质上是公共的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T19:54:22.410

我会说没有问题；但是，您可能想要做一些[速率限制](http://www.codinghorror.com/blog/archives/001206.html)，这样人们就不能尝试暴力破解它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T19:57:11.497

您还可以在说 2-3 次登录失败后放置验证码，以避免暴力破解。

# javascript - Getters \ setters for dummies

> ID：812961
> 
> 赞同：141
> 
> 时间：2009-05-01T19:52:59.497
> 
> 标签：javascript, setter, getter

I've been trying to get my head around getters and setters and its not sinking in. I've read [JavaScript Getters and Setters](http://ejohn.org/blog/javascript-getters-and-setters/) and [Defining Getters and Setters](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide:Creating_New_Objects:Defining_Getters_and_Setters) and just not getting it.

Can someone clearly state:

1.  What a getter and setter are meant to do, and
2.  Give some VERY simple examples?

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-05-01T21:15:22.433

除了[@millimoose 的回答](https://stackoverflow.com/questions/812961/javascript-getters-and-setters-for-dummies-meaning-me/812985#812985)之外，setter 还可以用于更新其他值。

```
function Name(first, last) {
    this.first = first;
    this.last = last;
}

Name.prototype = {
    get fullName() {
        return this.first + " " + this.last;
    },

    set fullName(name) {
        var names = name.split(" ");
        this.first = names[0];
        this.last = names[1];
    }
}; 
```

现在，您可以设置`fullName`，`first`和`last`将被更新，反之亦然。

```
n = new Name('Claude', 'Monet')
n.first # "Claude"
n.last # "Monet"
n.fullName # "Claude Monet"
n.fullName = "Gustav Klimt"
n.first # "Gustav"
n.last # "Klimt" 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2016-01-18T01:31:09.457

# JavaScript 中的 Getter 和 Setter

## 概述

JavaScript 中的 getter 和 setter 用于定义*计算属性*或*访问器*。计算属性是使用函数获取或设置对象值的属性。基本理论是这样的：

```
var user = { /* ... object with getters and setters ... */ };
user.phone = '+1 (123) 456-7890'; // updates a database
console.log( user.areaCode ); // displays '123'
console.log( user.area ); // displays 'Anytown, USA' 
```

这对于在访问属性时自动执行幕后操作非常有用，例如保持数字在范围内、重新格式化字符串、触发值已更改事件、更新关系数据、提供对私有属性的访问等等。

下面的示例显示了基本语法，尽管它们只是获取和设置内部对象值而不做任何特殊操作。在实际情况下，您将修改输入和/或输出值以满足您的需要，如上所述。

## 获取/设置关键字

ECMAScript 5 支持定义计算属性`get`的`set`关键字。它们适用于除 IE 8 及以下版本之外的所有现代浏览器。

```
var foo = {
    bar : 123,
    get bar(){ return bar; },
    set bar( value ){ this.bar = value; }
};
foo.bar = 456;
var gaz = foo.bar; 
```

## 自定义 Getter 和 Setter

`get`并且`set`不是保留字，因此可以重载它们以创建您自己的自定义跨浏览器计算属性函数。这适用于任何浏览器。

```
var foo = {
    _bar : 123,
    get : function( name ){ return this[ '_' + name ]; },
    set : function( name, value ){ this[ '_' + name ] = value; }
};
foo.set( 'bar', 456 );
var gaz = foo.get( 'bar' ); 
```

或者对于更紧凑的方法，可以使用单个函数。

```
var foo = {
    _bar : 123,
    value : function( name /*, value */ ){
        if( arguments.length < 2 ){ return this[ '_' + name ]; }
        this[ '_' + name ] = value;
    }
};
foo.value( 'bar', 456 );
var gaz = foo.value( 'bar' ); 
```

避免做这样的事情，这会导致代码膨胀。

```
var foo = {
    _a : 123, _b : 456, _c : 789,
    getA : function(){ return this._a; },
    getB : ..., getC : ..., setA : ..., setB : ..., setC : ...
}; 
```

对于上面的示例，内部属性名称使用下划线进行抽象，以阻止用户简单地做`foo.bar`vs`foo.get( 'bar' )`并获得“未煮熟”的值。`name`您可以根据要访问的属性的名称（通过参数）使用条件代码来执行不同的操作。

## Object.defineProperty()

Using`Object.defineProperty()`是另一种添加 getter 和 setter 的方法，可以在对象被定义后使用。它还可以用于设置可配置和可枚举的行为。此语法也适用于 IE 8，但不幸的是仅适用于 DOM 对象。

```
var foo = { _bar : 123 };
Object.defineProperty( foo, 'bar', {
    get : function(){ return this._bar; },
    set : function( value ){ this._bar = value; }
} );
foo.bar = 456;
var gaz = foo.bar; 
```

## __defineGetter__()

最后，`__defineGetter__()`是另一种选择。它已被弃用，但仍在网络上广泛使用，因此不太可能很快消失。它适用于除 IE 10 及以下版本之外的所有浏览器。尽管其他选项在非 IE 上也能很好地工作，但这个选项并不是那么有用。

```
var foo = { _bar : 123; }
foo.__defineGetter__( 'bar', function(){ return this._bar; } );
foo.__defineSetter__( 'bar', function( value ){ this._bar = value; } ); 
```

另外值得注意的是，在后面的示例中，内部名称必须与访问器名称不同以避免递归（即，`foo.bar`调用`foo.get(bar)`调用`foo.bar`调用`foo.get(bar)`...）。

## 也可以看看

MDN [get](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get) , [set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/set) , [Object.defineProperty()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty) , [__defineGetter__()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__) , [__defineSetter__()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineSetter__)
MSDN [IE8 Getter 支持](https://msdn.microsoft.com/en-us/library/dd229916%28VS.85%29.aspx)

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2009-05-01T19:58:07.393

You'd use them for instance to implement computed properties.

For example:

```
function Circle(radius) {
    this.radius = radius;
}

Object.defineProperty(Circle.prototype, 'circumference', {
    get: function() { return 2*Math.PI*this.radius; }
});

Object.defineProperty(Circle.prototype, 'area', {
    get: function() { return Math.PI*this.radius*this.radius; }
});

c = new Circle(10);
console.log(c.area); // Should output 314.159
console.log(c.circumference); // Should output 62.832 
```

^([(CodePen)](http://codepen.io/anon/pen/HJigF?editors=101))

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-10-03T21:34:03.703

很抱歉重新提出一个老问题，但我想我可能会提供一些非常基本的示例和傻瓜式的解释。到目前为止发布的其他答案都没有像[MDN 指南](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects#Defining_getters_and_setters)的第一个示例那样说明语法，这几乎是人们所能获得的基本知识。

**吸气剂：**

```
var settings = {
    firstname: 'John',
    lastname: 'Smith',
    get fullname() { return this.firstname + ' ' + this.lastname; }
};

console.log(settings.fullname); 
```

...`John Smith`当然会记录。*getter*的行为类似于变量对象属性，但提供了函数的灵活性来动态计算其返回值。它基本上是一种创建调用时不需要 () 的函数的奇特方式。

**二传手：**

```
var address = {
    set raw(what) {
        var loc = what.split(/\s*;\s*/),
        area = loc[1].split(/,?\s+(\w{2})\s+(?=\d{5})/);

        this.street = loc[0];
        this.city = area[0];
        this.state = area[1];
        this.zip = area[2];
    }
};

address.raw = '123 Lexington Ave; New York NY  10001';
console.log(address.city); 
```

...将登录`New York`到控制台。与 getter 一样，*setter*的调用语法与设置对象属性的值相同，但它是另一种不带 () 调用函数的奇特方式。

请参阅[这个 jsfiddle](http://jsfiddle.net/calraith/dybsLm5L/)以获得更彻底、可能更实际的示例。将值传递给对象的*设置器*会触发其他对象项的创建或填充。具体来说，在 jsfiddle 示例中，传递一个数字数组会提示 setter 计算均值、中位数、众数和范围；然后为每个结果设置对象属性。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-01T20:53:34.827

只有当您拥有类的私有属性时，getter 和 setter 才真正有意义。由于 Javascript 并没有像您通常从面向对象语言中想到的那样真正具有私有类属性，因此可能很难理解。这是私有计数器对象的一个​​示例。这个对象的好处是不能从对象外部访问内部变量“count”。

```
var counter = function() {
    var count = 0;

    this.inc = function() {
        count++;
    };

    this.getCount = function() {
        return count;
    };
};

var i = new Counter();
i.inc();
i.inc();
// writes "2" to the document
document.write( i.getCount()); 
```

如果您仍然感到困惑，请查看 Crockford 的关于[Private Members in Javascript](http://javascript.crockford.com/private.html)的文章。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-01T19:57:12.043

I think the first article you link to states it pretty clearly:

> The obvious advantage to writing JavaScript in this manner is that you can use it obscure values that you don't want the user to directly access.

The goal here is to encapsulate and abstract away the fields by only allowing access to them thru a `get()` or `set()` method. This way, you can store the field/data internally in whichever way you want, but outside components are only away of your published interface. This allows you to make internal changes without changing external interfaces, to do some validation or error-checking within the `set()` method, etc.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-10-25T13:35:03.203

虽然我们经常习惯于看到没有任何访问控制的具有公共属性的对象，但 JavaScript 允许我们准确地描述属性。事实上，我们可以使用描述符来控制如何访问属性以及我们可以对其应用哪些逻辑。考虑以下示例：

```
var employee = {
    first: "Boris",
    last: "Sergeev",
    get fullName() {
        return this.first + " " + this.last;
    },
    set fullName(value) {
        var parts = value.toString().split(" ");
        this.first = parts[0] || "";
        this.last = parts[1] || "";
    },
    email: "boris.sergeev@example.com"
}; 
```

最终结果：

```
console.log(employee.fullName); //Boris Sergeev
employee.fullName = "Alex Makarenko";

console.log(employee.first);//Alex
console.log(employee.last);//Makarenko
console.log(employee.fullName);//Alex Makarenko 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-06-16T03:27:58.817

您可以通过构造函数的原型为 js 类定义实例方法。

以下是示例代码：

```
// BaseClass

var BaseClass = function(name) {
    // instance property
    this.name = name;
};

// instance method
BaseClass.prototype.getName = function() {
    return this.name;
};
BaseClass.prototype.setName = function(name) {
    return this.name = name;
};

// test - start
function test() {
    var b1 = new BaseClass("b1");
    var b2 = new BaseClass("b2");
    console.log(b1.getName());
    console.log(b2.getName());

    b1.setName("b1_new");
    console.log(b1.getName());
    console.log(b2.getName());
}

test();
// test - end 
```

而且，这应该适用于任何浏览器，您也可以简单地使用 nodejs 来运行此代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-04-28T11:19:14.777

有什么令人困惑的... getter 是在您获取属性时调用的函数，setter 是在您设置它时调用的函数。例如，如果你这样做

```
obj.prop = "abc"; 
```

您正在设置属性 prop，如果您使用的是 getter/setter，则将调用 setter 函数，并将“abc”作为参数。对象内部的 setter 函数定义理想情况下应该是这样的：

```
set prop(var) {
   // do stuff with var...
} 
```

我不确定跨浏览器实现的效果如何。似乎 Firefox 也有另一种语法，带有双下划线的特殊（“魔术”）方法。像往常一样，Internet Explorer 不支持任何这些。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-01T20:51:32.523

如果您指的是访问器的概念，那么简单的目标是隐藏底层存储以防止任意操作。最极端的机制是

```
function Foo(someValue) {
    this.getValue = function() { return someValue; }
    return this;
}

var myFoo = new Foo(5);
/* We can read someValue through getValue(), but there is no mechanism
 * to modify it -- hurrah, we have achieved encapsulation!
 */
myFoo.getValue(); 
```

如果您指的是实际的 JS getter/setter 功能，例如。`defineGetter`/`defineSetter`或`{ get Foo() { /* code */ } }`，那么值得注意的是，在大多数现代引擎中，这些属性的后续使用将比其他情况慢得多。例如。比较性能

```
var a = { getValue: function(){ return 5; }; }
for (var i = 0; i < 100000; i++)
    a.getValue(); 
```

对比

```
var a = { get value(){ return 5; }; }
for (var i = 0; i < 100000; i++)
    a.value; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-09-16T16:53:31.673

我也[对我阅读的解释](http://ejohn.org/blog/javascript-getters-and-setters/)感到有些困惑，因为我试图将一个属性添加到我没有编写的现有原型中，因此替换原型似乎是错误的方法。因此，为了后代，这是我将`last`属性添加到的方式`Array`：

```
Object.defineProperty(Array.prototype, "last", {
    get: function() { return this[this.length - 1] }
}); 
```

比添加功能恕我直言要好一些。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-02T05:54:38.880

这里没有 ES6 的例子`class`（现在甚至不是“新的”，这是常态）：

```
class Student {

    contructor(firstName, lastName){
        this.firstName = firstName
        this.lastName = lastName
        this.secretId = Math.random()    
    }

    get fullName() {
        return `${this.firstName} ${this.lastName}`; // this is backtick in js, u can check it out here: https://stackoverflow.com/a/27678299/12056841
    }

    set firstName(newFirstName) {
        // validate that newFirstName is a string (and maybe limit length)
        this.firstName = newFirstName
    }

    get studentId() { return this.secretId }
} 
```

并且**没有设置**secretId 的方法，因为我们不希望任何人更改它。

** 如果`secretId`根本不应该更改，一个不错的方法是通过向其添加“#”将其声明为此类的“私有”（例如：**，**`this.#secretId = Math.random()`和`return this.#secretId`

*更新：*关于支持字段您可能需要重命名您的字段 - 或您的 setter 函数，但更改您的字段名称对我来说更有意义。一个选项就像我上面提到的（使用 a`#`将字段声明为“私有”）。另一种方法是重命名它 ( `_firstName`, `firstName_`...)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-16T01:47:14.200

您还可以使用`__defineGetter__`：

```
function Vector2(x,y) {
    this.x = x;
    this.y = y;
}

Vector2.prototype.__defineGetter__("magnitude", function () {
   return Math.sqrt(this.x*this.x+this.y*this.y);
});

console.log(new Vector2(1,1).magnitude)
```

或者，如果您愿意：

```
function Vector2(x,y) {
    this.x = x;
    this.y = y;
    this.__defineGetter__("magnitude", function () {
       return Math.sqrt(this.x*this.x+this.y*this.y);
    });
}

console.log(new Vector2(1,1).magnitude)
```

但是这个功能最近被标记为“旧版”，被`Object.defineProperty()`.

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-07-09T14:15:03.100

我为你们准备了一个可能有点难看的东西，但它确实可以跨平台完成

```
function myFunc () {

var _myAttribute = "default";

this.myAttribute = function() {
    if (arguments.length > 0) _myAttribute = arguments[0];
    return _myAttribute;
}
} 
```

这样，当你打电话时

```
var test = new myFunc();
test.myAttribute(); //-> "default"
test.myAttribute("ok"); //-> "ok"
test.myAttribute(); //-> "ok" 
```

如果你真的想增加趣味.. 你可以插入一个 typeof 检查：

```
if (arguments.length > 0 && typeof arguments[0] == "boolean") _myAttribute = arguments[0];
if (arguments.length > 0 && typeof arguments[0] == "number") _myAttribute = arguments[0];
if (arguments.length > 0 && typeof arguments[0] == "string") _myAttribute = arguments[0]; 
```

或者更疯狂地使用高级 typeof 检查： codingforums.com 上的[type.of() 代码](http://www.codingforums.com/showthread.php?t=105653)

# linux - Linux vi 箭头键在插入模式下损坏

> ID：812973
> 
> 赞同：101
> 
> 时间：2009-05-01T19:55:50.097
> 
> 标签：linux, vim, vi

我的箭头键在家中的插入模式下无法在 vi 中使用，它们只是每个都插入一个换行符和一个大写字母，例如“A”。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-05-01T19:59:39.260

我假设您使用的是 vim，因为它被标记为 Linux。尝试：

```
:set nocompatible 
```

（你可能想通过添加这个命令来配置你的 .vimrc 。如果你的主目录中不存在一个新的 .vimrc 文件，请运行`echo $HOME`以检查主目录路径。）

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2009-06-19T20:27:22.453

Ubuntu 默认附带`vim-tiny`，它没有 vim 的所有花里胡哨。

快速`sudo apt-get install vim`了解每个人都在谈论的所有有趣的功能。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2013-08-16T15:33:04.650

`:set term=builtin_ansi`

为我修好了。您可以在转义模式下（哔声模式）将其粘贴到 vim 中，也可以将其添加到 ~/.vimrc 的末尾而不带前导“：”

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-05-01T19:58:19.733

vi 不支持插入模式下的箭头键。使用 vim。尽管您的 vi 可能只是到 vim 的链接，但它可能被配置为表现得像“原始”vi，从而禁用箭头键。直接调用 vim 就可以了。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-05-10T13:19:28.447

另一个变体：在一些 .vimrc 更改后，这个问题出现在我身上。一致的搜索最终表明，我在正常模式下巧妙地重新映射 ESC 并不是一个好主意。删除它解决了问题：

```
" this is NOT something you want in .vimrc:
" In normal mode, hitting Esc turns off search highlights:
nmap <ESC> :nohl<CR>  " Do NOT add this to .vimrc 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-03-05T15:51:23.423

唯一对我有用的是 ":set term=ansi"

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-08-26T20:03:30.263

我在使用箭头键时遇到了同样的问题，但是当我使用设置 nocp 或 nocompatible 时，我的退格键无法正常工作

出于某种原因，当我安装 vim 时 `sudo apt-get install vim`，vi 不再有箭头或退格的任何问题

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-09T13:51:55.973

切换到在 .vim 中使用 git 后，我​​只是遇到了箭头键的问题。

我已经安装了这个 repo - [https://github.com/sunaku/.vim](https://github.com/sunaku/.vim)

在挖了一个小时后，我发现 AutoClose 插件（无论如何都不喜欢）破坏了箭头键。

插件文档建议应该设置 set ttimeoutlen=100，但这对我不起作用！（使用 urxvt+screen 或 urxvt，甚至使用 xterm）

所以我最后删除了插件。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-27T05:27:37.053

在 VS Code 上的 WSL 集成终端中，更新包并安装为我工作的完整 vim 包。

```
sudo apt-get update
sudo apt-get install vim 
```

但是，要使箭头键在我使用 conemu 时起作用，我必须`:set term=builtin_ansi`添加`~/.vimrc`

```
echo ':set term=builtin_ansi' >> ~/.vimrc 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-05T07:58:56.343

您可能还想尝试“noesckeys”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-17T05:56:19.667

我在带有 Cygwin 的 Windows 8.1 中使用 vim 时遇到了同样的问题。

对我有用的解决方案是，只需在 Cygwin 终端中运行以下命令：

```
cp vimrc_example.vim ~/.vimrc 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2013-08-02T14:58:34.297

在命令行中写下：

```
EXINIT="set nocompatible"; export EXINIT 
```

# image - 如何使用 Core Graphics 读取二进制图像文件？

> ID：812976
> 
> 赞同：0
> 
> 时间：2009-05-01T19:56:12.810
> 
> 标签：image, matlab, core-graphics

我在 Matlab 中创建了一个图像并将其更改为二进制图像文件。我想使用 Core Graphics API 读取文件。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T20:03:15.057

查看带有原始数据的[ImageIO](http://developer.apple.com/graphicsimaging/workingwithimageio.html)框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:00:40.367

由于您没有说*二进制图像文件*的格式，我会推荐[ImageMagick](http://www.imagemagick.org/)。它是一个强大的图像处理库，具有多种语言的绑定。

您可以使用它将 *二进制图像文件*转换为 Core Graphics 可以理解的格式。

# c# - Structuremap Stackoverflow Exception

> ID：812980
> 
> 赞同：0
> 
> 时间：2009-05-01T19:57:09.097
> 
> 标签：c#, dependency-injection, inversion-of-control, structuremap, stack-overflow

I keep getting a stackoverflow exception when I call "GetInstance" (the last line). All, yes ALL of my types implement ITracker. MultiTracker has a constructor with a single parameter, which is an array of ITracker's.

It seems like StructureMap is ignoring the fact that I told it that MultiTracker is the default class I want when requesting the type ITracker.

I just can't get it to work. Any thoughts?

```
Container = new Container(x =>
 {
  //Multitracker takes ITracker[] in its constructor
  x.ForRequestedType<MultiTracker>().TheDefault.Is.OfConcreteType<MultiTracker>().TheArrayOf<ITracker>().Contains(z =>
   {
    z.OfConcreteType<ConcreteType1>(); //ConcreteType1 : ITracker
    z.OfConcreteType<ConcreteType2>(); //ConcreteType2 : ITracker
   });

  x.ForRequestedType<ITracker>().TheDefault.Is.OfConcreteType<MultiTracker>();
    });

//Run a test - this explodes
Container.GetInstance<ITracker>(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T04:27:35.513

我不确定我是否会这样做，但它确实有效......

```
 public void Initialize()
    {
        var container = new Container(x => 
            x.ForRequestedType<ITracker>()
            .TheDefaultIsConcreteType<MultiTracker>()
            .OnCreation(y => 
                ((MultiTracker)y).Trackers = new ITracker[]
                {
                    new ConcreteType1(), new ConcreteType2()
                }
            ));
        container.GetInstance<ITracker>();
    }

    public class MultiTracker : ITracker
    {
        public ITracker[] Trackers { get; set; }
    } 
```

# iphone - 在选项卡栏开关上弹出到根导航控制器的问题

> ID：812988
> 
> 赞同：4
> 
> 时间：2009-05-01T19:58:52.070
> 
> 标签：iphone

试图模仿/复制内置通讯录，特别是在编辑联系人或从电话应用程序内部查看现有联系人信息时的行为。当您导航到另一个选项卡时，编辑状态将被重置并弹出“新联系人”或“信息”视图，因此当您返回“联系人”选项卡时，您将返回根表视图。

我使用 setEditing: 和 popToViewController: 在 vi​​ewWillDisappear 中完成了大部分工作，但是当用户使用后退按钮从 Info 视图导航到 table 视图时，我得到了奇怪的行为。即使我弹出到根表视图控制器，它似乎使用的是默认的 UITableViewController 类而不是我的子类（例如，标准选择行为而不是我的覆盖来推送详细视图。）

有什么提示吗？工业发展署

这里有一些代码来说明：

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    // This is to clean up from the colored bar in detail view
    self.navigationController.navigationBar.tintColor = nil;

    // These are to match the behaviour of Contacts app
    [self setEditing:NO animated:NO];

    // This is the tricky part: works when switching tabs, but not when back button was going to pop anyway!!
    [self.navigationController popToViewController:rootViewControllerForTab animated:NO];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T03:11:45.110

-viewWillDisappear: 方法不是为您的 navigationController 修改视图控制器堆栈的最佳位置，因为它在您切换选项卡和将视图推送到其顶部时都会触发。

我玩了一下，发现最好的地方是 -[UITabBarControllerDelegate tabBarController:didSelectViewController:] 方法。因此，首先您需要指定一个对象作为标签栏的委托（我使用了应用委托）。将 UITabBarController 的委托属性绑定到在代码或 Interface Builder 中实现 UITabBarControllerDelegate 协议的对象。

然后，实现 -tabBarController:didSelectViewController: 方法。现在的诀窍是如何判断您的“通讯录”选项卡何时被切换到。我使用 UINavigationController 类型的属性（选项卡的根视图控制器）跟踪相关选项卡的视图控制器。使用 Interface Builder 将 tab1NavController 属性绑定到实际实例后，可以使用它与 viewController 参数进行比较，以查看刚刚选择了哪个选项卡。

```
@interface Pop2RootTabSwitchAppDelegate : NSObject 
    <UIApplicationDelegate, UITabBarControllerDelegate> {
  UINavigationController *tab1NavController;
}
@property (nonatomic, retain) IBOutlet UINavigationController *tab1NavController;
@end

@implementation Pop2RootTabSwitchAppDelegate

- (void)tabBarController:(UITabBarController *)tabBarController 
  didSelectViewController:(UIViewController *)viewController {
   NSLog(@"[%@ tabBarController:%@  didSelectViewController:%@]", [self class], 
       tabBarController, viewController);
   if (viewController == tab1NavController) {
       NSLog(@"viewController == tab1NavController");
       [tab1NavController popToRootViewControllerAnimated:NO];
   }
} 
```

# database - 什么是“不透明”键？

> ID：812990
> 
> 赞同：10
> 
> 时间：2009-05-01T19:59:32.117
> 
> 标签：database

我知道什么是键，我知道在其他上下文中什么是不透明的——但是在数据库上下文中什么是不透明的键？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-01T20:01:02.877

这意味着它除了用于查找记录之外没有任何实际意义——它应该被视为任意数据，除了键入之外没有其他目的。例如，这几乎总是适用于 GUID。将此与主键可能是社会安全号码的情况进行比较。

这些也称为代理（不透明）与自然键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:01:05.670

诸如 GUID 之类的东西不会告诉您有关不相关的行或外部信息的任何信息，而不是诸如串行 PK 和用户重要信息（例如电子邮件地址）之类的东西，它会告诉您“这是密钥”之外的信息。

# antlr - 编写模板语言/VewEngine

> ID：812991
> 
> 赞同：0
> 
> 时间：2009-05-01T19:59:33.037
> 
> 标签：antlr, abstract-syntax-tree, viewengine

除了完成任何真正的工作外，我还很痒。我的渴望是编写一个视图引擎，它可以从另一种语言（模板工具包/Perl）中紧密模仿模板系统。如果我有时间/做它来学习一些新的项目，这就是其中之一。

我花了一些时间研究 CoCo/R 和 ANTLR，老实说，这让我很头疼，但是一些 CoCo/R 正在陷入困境。不幸的是，大多数示例都是关于创建一个读取源代码的编译器，但没有一个似乎涵盖了如何为模板创建处理器。

是的，这些是相同的，但我无法理解如何为模板定义语言，其中大部分源代码是 html，而不是解析和运行的实际代码。

这种事情有没有好的初学者资源？我在 Spark 上做了一个 ganer，它似乎在 repo 中没有语法。

也许这太过分了，人们可以在文件中用 c# 测试替换模板语法并编译它。[http://msdn.microsoft.com/en-us/magazine/cc136756.aspx#S2](http://msdn.microsoft.com/en-us/magazine/cc136756.aspx#S2)

如果你在我的鞋子里并且不是语言创造专家，你会从哪里开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T08:44:41.090

Spark 语法是用一种流利的领域特定语言实现的。

它在几层中声明。识别 html 语法的规则在[MarkupGrammar.cs](http://github.com/loudej/spark/blob/master/src/Spark/Parser/Markup/MarkupGrammar.cs)中声明——这些规则基于直接从 xml 规范复制的语法规则。

标记规则是指[CodeGrammar.cs](http://github.com/loudej/spark/blob/master/src/Spark/Parser/Code/CodeGrammar.cs)中声明的 csharp 语法规则的有限子集- 这些是一个子集，因为 Spark 只需要识别足够的 csharp 即可将字符串周围的单引号调整为双引号、匹配花括号等。

各个规则本身属于[ParseAction<TValue> 委托](http://github.com/loudej/spark/blob/master/src/Spark/Parser/ParseAction.cs)类型，它接受一个[Position](http://github.com/loudej/spark/blob/master/src/Spark/Parser/Position.cs)并返回一个[ParseResult](http://github.com/loudej/spark/blob/master/src/Spark/Parser/ParseResult.cs)。ParseResult 是一个简单的类，它包含由操作解析的 TValue 数据项和一个新的 Position 实例，该实例已经超过了产生 TValue 的内容。

[在您引入少量运算符](http://github.com/loudej/spark/blob/master/src/Spark/Parser/Position.cs)之前，它本身并不是很有用，如[解析表达式语法](http://en.wikipedia.org/wiki/Parsing_expression_grammar)中所述，它可以组合单个解析动作来构建关于不同语法结构形状的非常详细和健壮的表达式。

使用委托作为解析操作的技术来自 Luke H 的博客文章[Monadic Parser Combinators using C# 3.0](http://blogs.msdn.com/lukeh/archive/2007/08/19/monadic-parser-combinators-using-c-3-0.aspx)。我还写了一篇关于[为解析创建域特定语言](http://whereslou.com/2008/05/15/creating-a-domain-specific-language-for-parsing)的帖子。

如果您愿意，也完全可以引用 Spark.dll 程序集并从基础 CharGrammar 继承一个类，从而为特定语法创建全新的语法。这可能是开始试验这种技术的最快方法，可以在[CharGrammarTester.cs](http://github.com/loudej/spark/blob/master/src/Spark.Tests/Parser/CharGrammarTester.cs)中找到一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:32:33.723

步骤 1\. 使用正则表达式（正则表达式替换）将您的输入模板字符串拆分为令牌列表，例如 split

```
hel<b>lo[if foo]bar is [bar].[else]baz[end]world</b>! 
```

到

```
write('hel<b>lo')
if('foo')
write('bar is')
substitute('bar')
write('.')
else()
write('baz')
end()
write('world</b>!') 
```

步骤 2\. 将您的标记列表转换为语法树：

```
* Sequence
** Write
*** ('hel<b>lo')
** If
*** ('foo')
*** Sequence
**** Write
***** ('bar is')
**** Substitute
***** ('bar')
**** Write
***** ('.')
*** Write
**** ('baz')
** Write
*** ('world</b>!')

class Instruction {
}
class Write : Instruction {
  string text;
}
class Substitute : Instruction {
  string varname;
}
class Sequence : Instruction {
  Instruction[] items;
}
class If : Instruction {
  string condition;
  Instruction then;
  Instruction else;
} 
```

步骤 3\. 编写一个递归函数（称为解释器），它可以遍历您的树并在那里执行指令。

如果您的语言支持 eval()（例如 Perl、Python、Ruby），另一种替代方法（而不是步骤 1--3）：使用正则表达式替换将模板转换为宿主语言中支持 eval() 的字符串，然后运行 ​​eval() 来实例化模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:32:10.493

有太多事情要做。但它确实适用于简单的 GET 语句和测试。这是一个开始。

[http://github.com/claco/tt.net/](http://github.com/claco/tt.net/)

最后，我在 ANTLR 中已经有太多时间来尝试 Loudejs 的方法了。我想在整个过程而不是解析器/词法分析器上多花一点时间。也许在第 2 版中，当我的大脑对事物了解更多时，我可以尝试使用 Spark 方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T13:42:35.730

[Vici Parser](http://viciproject.com/wiki/projects/parser/home)（以前称为 LazyParser.NET）是一个开源的分词器/模板解析器/表达式解析器，可以帮助您入门。

如果这不是您要查找的内容，那么您可能会通过查看源代码获得一些想法。

# load-balancing - 如何通过 mod_jk 将请求强制发送给特定的工作人员？

> ID：812994
> 
> 赞同：5
> 
> 时间：2009-05-01T19:59:44.520
> 
> 标签：load-balancing, mod-jk

如果我有几个工作人员和一个负载平衡器工作人员的 mod_jk 设置，是否有一个请求参数或其他东西可以让我将特定的 http 请求强制到特定的工作人员。例如，如果我有一个工人 worker1 是否有这样的东西：

[http://www.example.com?worker=worker1](http://www.example.com?worker=worker1)

通常我们需要对集群中特定服务器上的问题进行故障排除，并且能够将请求直接强制发送到该服务器是必不可少的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:10:06.350

我认为通常的做法是通过给主域起别名的子域来做到这一点。只要确保您不要让 Google 索引，因为您会遇到重复的内容问题。IP 过滤和限制性 robots.txt 将完成这项工作。

```
www1.example.com
www2.example.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T17:54:51.157

1.  调整 JSESSIONID cookie 的值。最后有你坚持的工人的名字（假设你正在做粘性会话）

2.  使用此处描述的 SetHandler [http://tomcat.apache.org/connectors-doc/reference/apache.html](http://tomcat.apache.org/connectors-doc/reference/apache.html)而不是 JKMount 指令

    像这样的东西：

    ```
     <Location />  
          SetHandler jakarta-servlet  
          SetEnvIf REQUEST_URI ^/.*\?.*worker=(\w+)&?$ JK_WORKER_NAME=$1  
       </Location> 
    ```

# objective-c - Select row After UIPickerView is loaded

> ID：812995
> 
> 赞同：78
> 
> 时间：2009-05-01T19:59:48.403
> 
> 标签：objective-c, iphone, cocoa-touch, uipickerview

I have an iPhone database app that loads a `UIPickerView` with data from a table. I want to set the selected row to a particular row from the data in another table.

For example: Let's say I have a `UIPickerView` that is loaded with X number of names of the iPhone users' friends (the number of names is variable; it could be 1 or 1000 and all are entered into the database by the user). The iPhone user has a preference set that their current best friend is *TED*. I want the `UIPickerView` to be position to *TED* when displayed.

Where do I call `selectRow`?

I tried in `viewDidAppear`, but it was never called, in `titleForRow` which caused all kinds of strange behavior. `viewDidLoad` and `viewWillAppear` are out of the question, because I don't know what's in the datasource to the picker yet.

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-05-01T20:07:16.607

检索数据后调用它。我不知道你在哪里加载数据，所以这只是应该工作的模型。如果这没有意义，请告诉我您在哪里加载数据，以便我可以在脑海中将其拼凑起来:)

```
-(void)viewDidLoad
{
    // load data from sql
    // self.someDataArray = DATAFROMSQL
    [picker reloadAllComponents];
    [picker selectRow:0 inComponent:0 animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-10-21T22:58:59.457

当最初显示 UIPickerView 时需要选择（默认）UIPickerView 项时，存在一个常见问题。问题与事件的顺序有关。从阅读以前的帖子，似乎 [pickerView selectRow:n] 通常在视图控制器 ViewDidLoad 事件中调用。但是，UiPickerView 数据只在 ViewDidLoad 事件之后加载，这意味着 ViewDidLoad 中的任何选择代码都将不起作用。要补救，请将选择代码放在 ViewDidAppear 中；

```
- (void) viewDidAppear:(BOOL)animated {
[m_pickerView selectRow:nSelectedItem inComponent:0 animated:YES]; } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-01T20:08:44.543

将其放置在您初始化`UIView`包含您`UIPickerView`的子视图的任何位置：

```
[myPickerView selectRow:rowWithTedsName inComponent:columnWithNames animated:NO]; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-25T16:55:41.923

我刚刚发现在 4.3 SDK 的组件加载行为在 iPhone 和 iPad 之间是不同的。在 iPhone 上，我正要在添加到子视图层次结构之前或之后初始化视图之后立即调用 selectRow:。然而，在 iPad 上， selectRow 调用没有产生任何结果。我最终使用了 performSelector:withObject:afterDelay: 调用来等待 0.1 秒，然后再触发 selectRow:inComponent:animated:。这在 iPhone 和 iPad 上产生了可预测的结果。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-07-04T11:30:07.793

对于 Swift，它很简单：

```
self.picker?.selectRow(0, inComponent: 0, animated: true) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-26T12:31:38.807

如果您希望所选行永久突出显示，请使用此

```
myPickerView.subviews[0].subviews[0].subviews[2].backgroundColor = myPickerView.tintColor; 
```

# sql-server-2005 - Connection Problems With Mirrored Database

> ID：812998
> 
> 赞同：1
> 
> 时间：2009-05-01T20:00:34.720
> 
> 标签：sql-server-2005, oledb

The setup is as follows:

A C++ client connects via OLEDB/SQL Native Client to a SQL Server 2005 database located on another machine. The server is setup with mirroring (automatic failover) with a synchronized server located on yet another server and a witness server on another server.

Occassionally (once every couple of days), our application seizes up in that it appears to attempt to establish a database connection to the database and rather than simply failing and OLEDB throwing a database connection failure it just gets "stuck" (we have a timeout for the connection but it's never timing out). 24 to 36 *hours* later we'll get an error:

```
TCP Provider: An existing connection was forcibly closed by the remote host. 
```

And things will continue you on with lots of these errors and our app will eventually need to be restarted. We can't really figure out what condition could be causing this behavior and what we can do about it?

In preliminary research, I've seen some related problems that were solved by setting the Connection Lifetime connection string property to something non-zero.

Does anyone have any thoughts on what might be going on here?**********~~~~**********